---
title: 剪貼簿格式
description: 視窗可以在剪貼簿上放置一個以上的物件，每個物件都代表不同剪貼簿格式的相同資訊。 使用者不需要留意剪貼簿上物件所使用的剪貼簿格式。
ms.assetid: fe42baec-6b00-4816-b379-7f335da8a197
keywords:
- 剪貼簿，格式
- 剪貼簿、windows
- 剪貼簿，標準格式
- 剪貼簿，已註冊的格式
- 剪貼簿，合成格式
- 標準剪貼簿格式
- 已註冊的剪貼簿格式
- 合成的剪貼簿格式
- 雲端剪貼簿格式
- 剪貼簿歷程記錄格式
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 193ee4cc10c17846d974e50b17a464207026280b
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/20/2020
ms.locfileid: "106968303"
---
# <a name="clipboard-formats"></a><span data-ttu-id="23fab-114">剪貼簿格式</span><span class="sxs-lookup"><span data-stu-id="23fab-114">Clipboard Formats</span></span>

<span data-ttu-id="23fab-115">視窗可以在剪貼簿上放置一個以上的物件，每個物件都代表不同剪貼簿格式的相同資訊。</span><span class="sxs-lookup"><span data-stu-id="23fab-115">A window can place more than one object on the clipboard, each representing the same information in a different clipboard format.</span></span> <span data-ttu-id="23fab-116">使用者不需要留意剪貼簿上物件所使用的剪貼簿格式。</span><span class="sxs-lookup"><span data-stu-id="23fab-116">Users need not be aware of the clipboard formats used for an object on the clipboard.</span></span>

<span data-ttu-id="23fab-117">下列主題描述剪貼簿格式。</span><span class="sxs-lookup"><span data-stu-id="23fab-117">The following topics describe the clipboard formats.</span></span>

-   [<span data-ttu-id="23fab-118">標準剪貼簿格式</span><span class="sxs-lookup"><span data-stu-id="23fab-118">Standard Clipboard Formats</span></span>](#standard-clipboard-formats)
-   [<span data-ttu-id="23fab-119">已註冊的剪貼簿格式</span><span class="sxs-lookup"><span data-stu-id="23fab-119">Registered Clipboard Formats</span></span>](#registered-clipboard-formats)
-   [<span data-ttu-id="23fab-120">私用剪貼簿格式</span><span class="sxs-lookup"><span data-stu-id="23fab-120">Private Clipboard Formats</span></span>](#private-clipboard-formats)
-   [<span data-ttu-id="23fab-121">多個剪貼簿格式</span><span class="sxs-lookup"><span data-stu-id="23fab-121">Multiple Clipboard Formats</span></span>](#multiple-clipboard-formats)
-   [<span data-ttu-id="23fab-122">合成的剪貼簿格式</span><span class="sxs-lookup"><span data-stu-id="23fab-122">Synthesized Clipboard Formats</span></span>](#synthesized-clipboard-formats)
-   [<span data-ttu-id="23fab-123">雲端剪貼簿和剪貼簿歷程記錄格式</span><span class="sxs-lookup"><span data-stu-id="23fab-123">Cloud Clipboard and Clipboard History Formats</span></span>](#cloud-clipboard-and-clipboard-history-formats)

## <a name="standard-clipboard-formats"></a><span data-ttu-id="23fab-124">標準剪貼簿格式</span><span class="sxs-lookup"><span data-stu-id="23fab-124">Standard Clipboard Formats</span></span>

<span data-ttu-id="23fab-125">系統定義的剪貼簿格式稱為 *標準剪貼簿格式*。</span><span class="sxs-lookup"><span data-stu-id="23fab-125">The clipboard formats defined by the system are called *standard clipboard formats*.</span></span> <span data-ttu-id="23fab-126">這些剪貼簿格式會以 [**標準剪貼簿格式**](standard-clipboard-formats.md)描述。</span><span class="sxs-lookup"><span data-stu-id="23fab-126">These clipboard formats are described in [**Standard Clipboard Formats**](standard-clipboard-formats.md).</span></span>

## <a name="registered-clipboard-formats"></a><span data-ttu-id="23fab-127">已註冊的剪貼簿格式</span><span class="sxs-lookup"><span data-stu-id="23fab-127">Registered Clipboard Formats</span></span>

<span data-ttu-id="23fab-128">許多應用程式會使用無法轉譯成標準剪貼簿格式的資料，而不會遺失資訊。</span><span class="sxs-lookup"><span data-stu-id="23fab-128">Many applications work with data that cannot be translated into a standard clipboard format without loss of information.</span></span> <span data-ttu-id="23fab-129">這些應用程式可以建立自己的剪貼簿格式。</span><span class="sxs-lookup"><span data-stu-id="23fab-129">These applications can create their own clipboard formats.</span></span> <span data-ttu-id="23fab-130">應用程式所定義的剪貼簿格式，稱為 [已註冊的剪貼簿格式](#registered-clipboard-formats)。</span><span class="sxs-lookup"><span data-stu-id="23fab-130">A clipboard format that is defined by an application, is called a [registered clipboard format](#registered-clipboard-formats).</span></span> <span data-ttu-id="23fab-131">例如，如果文字處理應用程式使用標準文字格式將格式化的文字複製到剪貼簿，則會遺失格式化資訊。</span><span class="sxs-lookup"><span data-stu-id="23fab-131">For example, if a word-processing application copied formatted text to the clipboard using a standard text format, the formatting information would be lost.</span></span> <span data-ttu-id="23fab-132">解決方案是註冊新的剪貼簿格式，例如 rtf)  (rtf 格式。</span><span class="sxs-lookup"><span data-stu-id="23fab-132">The solution would be to register a new clipboard format, such as Rich Text Format (RTF).</span></span>

<span data-ttu-id="23fab-133">若要註冊新的剪貼簿格式，請使用 [**RegisterClipboardFormat**](/windows/desktop/api/Winuser/nf-winuser-registerclipboardformata) 函數。</span><span class="sxs-lookup"><span data-stu-id="23fab-133">To register a new clipboard format, use the [**RegisterClipboardFormat**](/windows/desktop/api/Winuser/nf-winuser-registerclipboardformata) function.</span></span> <span data-ttu-id="23fab-134">此函式會採用格式的名稱，並傳回不帶正負號的整數值，表示已註冊的剪貼簿格式。</span><span class="sxs-lookup"><span data-stu-id="23fab-134">This function takes the name of the format and returns an unsigned integer value that represents the registered clipboard format.</span></span> <span data-ttu-id="23fab-135">若要取出已註冊之剪貼簿格式的名稱，請將不帶正負號的整數值傳遞給 [**GetClipboardFormatName**](/windows/desktop/api/Winuser/nf-winuser-getclipboardformatnamea) 函式。</span><span class="sxs-lookup"><span data-stu-id="23fab-135">To retrieve the name of the registered clipboard format, pass the unsigned integer value to the [**GetClipboardFormatName**](/windows/desktop/api/Winuser/nf-winuser-getclipboardformatnamea) function.</span></span>

<span data-ttu-id="23fab-136">如果有一個以上的應用程式使用完全相同的名稱來註冊剪貼簿格式，剪貼簿格式只會註冊一次。</span><span class="sxs-lookup"><span data-stu-id="23fab-136">If more than one application registers a clipboard format with exactly the same name, the clipboard format is registered only once.</span></span> <span data-ttu-id="23fab-137">對 [**RegisterClipboardFormat**](/windows/desktop/api/Winuser/nf-winuser-registerclipboardformata) 函數的兩個呼叫都會傳回相同的值。</span><span class="sxs-lookup"><span data-stu-id="23fab-137">Both calls to the [**RegisterClipboardFormat**](/windows/desktop/api/Winuser/nf-winuser-registerclipboardformata) function return the same value.</span></span> <span data-ttu-id="23fab-138">如此一來，兩個不同的應用程式就可以使用已註冊的剪貼簿格式來共用資料。</span><span class="sxs-lookup"><span data-stu-id="23fab-138">In this way, two different applications can share data by using a registered clipboard format.</span></span>

## <a name="private-clipboard-formats"></a><span data-ttu-id="23fab-139">私用剪貼簿格式</span><span class="sxs-lookup"><span data-stu-id="23fab-139">Private Clipboard Formats</span></span>

<span data-ttu-id="23fab-140">應用程式可以藉由定義範圍 **cf \_ PRI加值稅EFIRST** 到 **cf \_ PRI加值稅ELAST** 的值，來識別私用剪貼簿格式。</span><span class="sxs-lookup"><span data-stu-id="23fab-140">An application can identify a private clipboard format by defining a value in the range **CF\_PRIVATEFIRST** through **CF\_PRIVATELAST**.</span></span> <span data-ttu-id="23fab-141">應用程式可以針對不需要向系統註冊的應用程式定義資料格式，使用私用剪貼簿格式。</span><span class="sxs-lookup"><span data-stu-id="23fab-141">An application can use a private clipboard format for an application-defined data format that does not need to be registered with the system.</span></span>

<span data-ttu-id="23fab-142">系統不會自動釋放與私人剪貼簿格式相關聯的資料控制碼。</span><span class="sxs-lookup"><span data-stu-id="23fab-142">Data handles associated with private clipboard formats are not automatically freed by the system.</span></span> <span data-ttu-id="23fab-143">如果您的 windows 使用私用剪貼簿格式，您可以使用 [**WM \_ DESTROYCLIPBOARD**](wm-destroyclipboard.md) 訊息來釋放任何不再需要的相關資源。</span><span class="sxs-lookup"><span data-stu-id="23fab-143">If your windows use private clipboard formats, you can use the [**WM\_DESTROYCLIPBOARD**](wm-destroyclipboard.md) message to free any related resources that are no longer needed.</span></span>

<span data-ttu-id="23fab-144">如需有關 [**WM \_ DESTROYCLIPBOARD**](wm-destroyclipboard.md) 訊息的詳細資訊，請參閱 [剪貼簿擁有權](clipboard-operations.md)。</span><span class="sxs-lookup"><span data-stu-id="23fab-144">For more information about the [**WM\_DESTROYCLIPBOARD**](wm-destroyclipboard.md) message, see [Clipboard Ownership](clipboard-operations.md).</span></span>

<span data-ttu-id="23fab-145">應用程式可以藉由在 **cf \_ GDIOBJFIRST** 到 **cf \_ GDIOBJLAST** 的範圍中定義私用格式，將資料控點放置在剪貼簿上。</span><span class="sxs-lookup"><span data-stu-id="23fab-145">An application can place data handles on the clipboard by defining a private format in the range **CF\_GDIOBJFIRST** through **CF\_GDIOBJLAST**.</span></span> <span data-ttu-id="23fab-146">使用這個範圍中的值時，資料處理程式不是 Windows 圖形裝置介面的控制碼 (GDI) 物件，但是是 [**GlobalAlloc**](/windows/desktop/api/winbase/nf-winbase-globalalloc) 函式所配置的控制碼，並具有 GMEM \_ 可移動旗標。</span><span class="sxs-lookup"><span data-stu-id="23fab-146">When using values in this range, the data handle is not a handle to a Windows Graphics Device Interface (GDI) object, but is a handle allocated by the [**GlobalAlloc**](/windows/desktop/api/winbase/nf-winbase-globalalloc) function with the GMEM\_MOVEABLE flag.</span></span> <span data-ttu-id="23fab-147">當剪貼簿清空時，系統會使用 [**GlobalFree**](/windows/desktop/api/winbase/nf-winbase-globalfree) 函式自動刪除物件。</span><span class="sxs-lookup"><span data-stu-id="23fab-147">When the clipboard is emptied the system automatically deletes the object using the [**GlobalFree**](/windows/desktop/api/winbase/nf-winbase-globalfree) function.</span></span>

## <a name="multiple-clipboard-formats"></a><span data-ttu-id="23fab-148">多個剪貼簿格式</span><span class="sxs-lookup"><span data-stu-id="23fab-148">Multiple Clipboard Formats</span></span>

<span data-ttu-id="23fab-149">視窗可以在剪貼簿上放置一個以上的剪貼簿物件，每個物件都代表不同剪貼簿格式的相同資訊。</span><span class="sxs-lookup"><span data-stu-id="23fab-149">A window can place more than one clipboard object on the clipboard, each representing the same information in a different clipboard format.</span></span> <span data-ttu-id="23fab-150">將資訊放在剪貼簿上時，視窗應該盡可能提供最多格式的資料。</span><span class="sxs-lookup"><span data-stu-id="23fab-150">When placing information on the clipboard, the window should provide data in as many formats as possible.</span></span> <span data-ttu-id="23fab-151">若要瞭解目前在剪貼簿上使用多少種格式，請呼叫 [**CountClipboardFormats**](/windows/desktop/api/Winuser/nf-winuser-countclipboardformats) 函數。</span><span class="sxs-lookup"><span data-stu-id="23fab-151">To find out how many formats are currently used on the clipboard, call the [**CountClipboardFormats**](/windows/desktop/api/Winuser/nf-winuser-countclipboardformats) function.</span></span>

<span data-ttu-id="23fab-152">包含最多資訊的剪貼簿格式應先放在剪貼簿上，後面接著較不具描述性的格式。</span><span class="sxs-lookup"><span data-stu-id="23fab-152">Clipboard formats that contain the most information should be placed on the clipboard first, followed by less descriptive formats.</span></span> <span data-ttu-id="23fab-153">從剪貼簿貼上資訊的視窗，通常會以它所辨識的第一種格式抓取剪貼簿物件。</span><span class="sxs-lookup"><span data-stu-id="23fab-153">A window pasting information from the clipboard typically retrieves a clipboard object in the first format it recognizes.</span></span> <span data-ttu-id="23fab-154">由於剪貼簿格式是依放置在剪貼簿上的順序來列舉，因此第一次辨識的格式也是最具描述性的格式。</span><span class="sxs-lookup"><span data-stu-id="23fab-154">Because clipboard formats are enumerated in the order they are placed on the clipboard, the first recognized format is also the most descriptive.</span></span>

<span data-ttu-id="23fab-155">例如，假設使用者從文字處理檔案複製了樣式的文字。</span><span class="sxs-lookup"><span data-stu-id="23fab-155">For example, suppose a user copies styled text from a word-processing document.</span></span> <span data-ttu-id="23fab-156">包含檔的視窗可能會先以註冊的格式（例如 RTF）將資料放在剪貼簿上。</span><span class="sxs-lookup"><span data-stu-id="23fab-156">The window containing the document might first place data on the clipboard in a registered format, such as RTF.</span></span> <span data-ttu-id="23fab-157">接著，視窗會以較不描述性的格式將資料放在剪貼簿上，例如文字 (**CF \_ 文字**) 。</span><span class="sxs-lookup"><span data-stu-id="23fab-157">Subsequently, the window would place data on the clipboard in a less descriptive format, such as text (**CF\_TEXT**).</span></span>

<span data-ttu-id="23fab-158">當剪貼簿的內容貼到另一個視窗時，此視窗會以其辨識的最具描述性格式抓取資料。</span><span class="sxs-lookup"><span data-stu-id="23fab-158">When the content of the clipboard is pasted into another window, the window retrieves data in the most descriptive format it recognizes.</span></span> <span data-ttu-id="23fab-159">如果視窗辨識 RTF，對應的資料就會貼入檔中。</span><span class="sxs-lookup"><span data-stu-id="23fab-159">If the window recognizes RTF, the corresponding data is pasted into the document.</span></span> <span data-ttu-id="23fab-160">否則會將文字資料貼到檔中，並遺失格式化資訊。</span><span class="sxs-lookup"><span data-stu-id="23fab-160">Otherwise, the text data is pasted into the document and the formatting information is lost.</span></span>

## <a name="synthesized-clipboard-formats"></a><span data-ttu-id="23fab-161">合成的剪貼簿格式</span><span class="sxs-lookup"><span data-stu-id="23fab-161">Synthesized Clipboard Formats</span></span>

<span data-ttu-id="23fab-162">系統會以隱含方式在特定剪貼簿格式之間轉換資料：如果視窗要求非剪貼簿格式的資料，系統會將可用格式轉換成所要求的格式。</span><span class="sxs-lookup"><span data-stu-id="23fab-162">The system implicitly converts data between certain clipboard formats: if a window requests data in a format that is not on the clipboard, the system converts an available format to the requested format.</span></span> <span data-ttu-id="23fab-163">系統可以轉換如下表所示的資料。</span><span class="sxs-lookup"><span data-stu-id="23fab-163">The system can convert data as indicated in the following table.</span></span>



| <span data-ttu-id="23fab-164">剪貼簿格式</span><span class="sxs-lookup"><span data-stu-id="23fab-164">Clipboard Format</span></span>     | <span data-ttu-id="23fab-165">轉換格式</span><span class="sxs-lookup"><span data-stu-id="23fab-165">Conversion Format</span></span>    |
|----------------------|----------------------|
| <span data-ttu-id="23fab-166">**CF \_ 點陣圖**</span><span class="sxs-lookup"><span data-stu-id="23fab-166">**CF\_BITMAP**</span></span>       | <span data-ttu-id="23fab-167">**CF \_ DIB**</span><span class="sxs-lookup"><span data-stu-id="23fab-167">**CF\_DIB**</span></span>          |
| <span data-ttu-id="23fab-168">**CF \_ 點陣圖**</span><span class="sxs-lookup"><span data-stu-id="23fab-168">**CF\_BITMAP**</span></span>       | <span data-ttu-id="23fab-169">**CF \_ DIBV5**</span><span class="sxs-lookup"><span data-stu-id="23fab-169">**CF\_DIBV5**</span></span>        |
| <span data-ttu-id="23fab-170">**CF \_ DIB**</span><span class="sxs-lookup"><span data-stu-id="23fab-170">**CF\_DIB**</span></span>          | <span data-ttu-id="23fab-171">**CF \_ 點陣圖**</span><span class="sxs-lookup"><span data-stu-id="23fab-171">**CF\_BITMAP**</span></span>       |
| <span data-ttu-id="23fab-172">**CF \_ DIB**</span><span class="sxs-lookup"><span data-stu-id="23fab-172">**CF\_DIB**</span></span>          | <span data-ttu-id="23fab-173">**CF \_ 調色板**</span><span class="sxs-lookup"><span data-stu-id="23fab-173">**CF\_PALETTE**</span></span>      |
| <span data-ttu-id="23fab-174">**CF \_ DIB**</span><span class="sxs-lookup"><span data-stu-id="23fab-174">**CF\_DIB**</span></span>          | <span data-ttu-id="23fab-175">**CF \_ DIBV5**</span><span class="sxs-lookup"><span data-stu-id="23fab-175">**CF\_DIBV5**</span></span>        |
| <span data-ttu-id="23fab-176">**CF \_ DIBV5**</span><span class="sxs-lookup"><span data-stu-id="23fab-176">**CF\_DIBV5**</span></span>        | <span data-ttu-id="23fab-177">**CF \_ 點陣圖**</span><span class="sxs-lookup"><span data-stu-id="23fab-177">**CF\_BITMAP**</span></span>       |
| <span data-ttu-id="23fab-178">**CF \_ DIBV5**</span><span class="sxs-lookup"><span data-stu-id="23fab-178">**CF\_DIBV5**</span></span>        | <span data-ttu-id="23fab-179">**CF \_ DIB**</span><span class="sxs-lookup"><span data-stu-id="23fab-179">**CF\_DIB**</span></span>          |
| <span data-ttu-id="23fab-180">**CF \_ DIBV5**</span><span class="sxs-lookup"><span data-stu-id="23fab-180">**CF\_DIBV5**</span></span>        | <span data-ttu-id="23fab-181">**CF \_ 調色板**</span><span class="sxs-lookup"><span data-stu-id="23fab-181">**CF\_PALETTE**</span></span>      |
| <span data-ttu-id="23fab-182">**CF \_ ENHMETAFILE**</span><span class="sxs-lookup"><span data-stu-id="23fab-182">**CF\_ENHMETAFILE**</span></span>  | <span data-ttu-id="23fab-183">**CF \_ METAFILEPICT**</span><span class="sxs-lookup"><span data-stu-id="23fab-183">**CF\_METAFILEPICT**</span></span> |
| <span data-ttu-id="23fab-184">**CF \_ METAFILEPICT**</span><span class="sxs-lookup"><span data-stu-id="23fab-184">**CF\_METAFILEPICT**</span></span> | <span data-ttu-id="23fab-185">**CF \_ ENHMETAFILE**</span><span class="sxs-lookup"><span data-stu-id="23fab-185">**CF\_ENHMETAFILE**</span></span>  |
| <span data-ttu-id="23fab-186">**CF \_ OEMTEXT**</span><span class="sxs-lookup"><span data-stu-id="23fab-186">**CF\_OEMTEXT**</span></span>      | <span data-ttu-id="23fab-187">**CF \_ 文字**</span><span class="sxs-lookup"><span data-stu-id="23fab-187">**CF\_TEXT**</span></span>         |
| <span data-ttu-id="23fab-188">**CF \_ OEMTEXT**</span><span class="sxs-lookup"><span data-stu-id="23fab-188">**CF\_OEMTEXT**</span></span>      | <span data-ttu-id="23fab-189">**CF \_ UNICODETEXT**</span><span class="sxs-lookup"><span data-stu-id="23fab-189">**CF\_UNICODETEXT**</span></span>  |
| <span data-ttu-id="23fab-190">**CF \_ 文字**</span><span class="sxs-lookup"><span data-stu-id="23fab-190">**CF\_TEXT**</span></span>         | <span data-ttu-id="23fab-191">**CF \_ OEMTEXT**</span><span class="sxs-lookup"><span data-stu-id="23fab-191">**CF\_OEMTEXT**</span></span>      |
| <span data-ttu-id="23fab-192">**CF \_ 文字**</span><span class="sxs-lookup"><span data-stu-id="23fab-192">**CF\_TEXT**</span></span>         | <span data-ttu-id="23fab-193">**CF \_ UNICODETEXT**</span><span class="sxs-lookup"><span data-stu-id="23fab-193">**CF\_UNICODETEXT**</span></span>  |
| <span data-ttu-id="23fab-194">**CF \_ UNICODETEXT**</span><span class="sxs-lookup"><span data-stu-id="23fab-194">**CF\_UNICODETEXT**</span></span>  | <span data-ttu-id="23fab-195">**CF \_ OEMTEXT**</span><span class="sxs-lookup"><span data-stu-id="23fab-195">**CF\_OEMTEXT**</span></span>      |
| <span data-ttu-id="23fab-196">**CF \_ UNICODETEXT**</span><span class="sxs-lookup"><span data-stu-id="23fab-196">**CF\_UNICODETEXT**</span></span>  | <span data-ttu-id="23fab-197">**CF \_ 文字**</span><span class="sxs-lookup"><span data-stu-id="23fab-197">**CF\_TEXT**</span></span>         |



 

<span data-ttu-id="23fab-198">如果系統針對特定的剪貼簿格式提供自動類型轉換，則將轉換格式 (s) 在剪貼簿上沒有任何優點。</span><span class="sxs-lookup"><span data-stu-id="23fab-198">If the system provides an automatic type conversion for a particular clipboard format, there is no advantage to placing the conversion format(s) on the clipboard.</span></span>

<span data-ttu-id="23fab-199">如果系統針對特定的剪貼簿格式提供自動類型轉換，而且您呼叫 [**EnumClipboardFormats**](/windows/desktop/api/Winuser/nf-winuser-enumclipboardformats) 來列舉剪貼簿資料格式，系統會先列舉剪貼簿上的格式，後面接著可以轉換成的格式。</span><span class="sxs-lookup"><span data-stu-id="23fab-199">If the system provides an automatic type conversion for a particular clipboard format, and you call [**EnumClipboardFormats**](/windows/desktop/api/Winuser/nf-winuser-enumclipboardformats) to enumerate the clipboard data formats, the system first enumerates the format that is on the clipboard, followed by the formats to which it can be converted.</span></span>

<span data-ttu-id="23fab-200">複製點陣圖時，最好將 **cf \_ .Dib** 或 **cf \_ DIBV5** 格式放置在剪貼簿上。</span><span class="sxs-lookup"><span data-stu-id="23fab-200">When copying bitmaps, it is best to place the **CF\_DIB** or **CF\_DIBV5** format on the clipboard.</span></span> <span data-ttu-id="23fab-201">這是因為裝置相關點陣圖中的色彩 (**CF \_ 點陣圖**) 相對於系統選擇區（可能會在貼上點陣圖之前變更）。</span><span class="sxs-lookup"><span data-stu-id="23fab-201">This is because the colors in a device-dependent bitmap (**CF\_BITMAP**) are relative to the system palette, which may change before the bitmap is pasted.</span></span> <span data-ttu-id="23fab-202">如果 **CF \_ DIB** 或 **cf \_ DIBV5** 格式位於剪貼簿，而視窗要求 **CF \_ 點陣圖** 格式，則系統會在該時間使用目前的調色板，轉譯與裝置無關的點陣圖 (DIB) 。</span><span class="sxs-lookup"><span data-stu-id="23fab-202">If the **CF\_DIB** or **CF\_DIBV5** format is on the clipboard and a window requests the **CF\_BITMAP** format, the system renders the device-independent bitmap (DIB) using the current palette at that time.</span></span>

<span data-ttu-id="23fab-203">如果您將 **cf \_ 點陣圖** 格式放在剪貼簿上 (而不是 **cf \_ DIB**) ，則系統會在關閉剪貼簿時立即呈現 **cf \_ dib** 或 **cf \_ DIBV5** 剪貼簿格式。</span><span class="sxs-lookup"><span data-stu-id="23fab-203">If you place the **CF\_BITMAP** format on the clipboard (and not **CF\_DIB**), the system renders the **CF\_DIB** or **CF\_DIBV5** clipboard format as soon as the clipboard is closed.</span></span> <span data-ttu-id="23fab-204">這可確保使用正確的調色板來產生 DIB。</span><span class="sxs-lookup"><span data-stu-id="23fab-204">This ensures that the correct palette is used to generate the DIB.</span></span> <span data-ttu-id="23fab-205">如果您使用剪貼簿中的點陣圖色彩空間資訊來放置 **CF \_ DIBV5** 格式，則系統會在要求 **cf \_ DIB** 或 **cf \_ DIBV5** 時，將點陣圖的位從點陣圖色彩空間轉換成 sRGB 色彩空間。</span><span class="sxs-lookup"><span data-stu-id="23fab-205">If you place the **CF\_DIBV5** format with the bitmap color space information in the clipboard, the system will convert the bitmap bits from the bitmap color space to the sRGB color space when **CF\_DIB** or **CF\_DIBV5** is requested.</span></span> <span data-ttu-id="23fab-206">如果在剪貼簿中沒有色彩空間資訊時要求 **CF \_ DIBV5** ，系統會在 [**BITMAPV5HEADER**](/windows/desktop/api/wingdi/ns-wingdi-bitmapv5header) 結構中傳回 sRGB 色彩空間資訊。</span><span class="sxs-lookup"><span data-stu-id="23fab-206">If **CF\_DIBV5** is requested when there is no color space information in the clipboard, the system returns sRGB color space information in the [**BITMAPV5HEADER**](/windows/desktop/api/wingdi/ns-wingdi-bitmapv5header) structure.</span></span> <span data-ttu-id="23fab-207">在需要時，會在其他剪貼簿格式之間進行轉換。</span><span class="sxs-lookup"><span data-stu-id="23fab-207">Conversions between other clipboard formats occur upon demand.</span></span>

<span data-ttu-id="23fab-208">如果剪貼簿包含 **CF \_ 調色板** 格式的資料，應用程式應該使用 [**SelectPalette**](/windows/desktop/api/wingdi/nf-wingdi-selectpalette) 和 [**RealizePalette**](/windows/desktop/api/wingdi/nf-wingdi-realizepalette) 函式，以針對該邏輯元件來實現剪貼簿中的任何其他資料。</span><span class="sxs-lookup"><span data-stu-id="23fab-208">If the clipboard contains data in the **CF\_PALETTE** format, the application should use the [**SelectPalette**](/windows/desktop/api/wingdi/nf-wingdi-selectpalette) and [**RealizePalette**](/windows/desktop/api/wingdi/nf-wingdi-realizepalette) functions to realize any other data in the clipboard against that logical palette.</span></span>

<span data-ttu-id="23fab-209">中繼檔有兩種剪貼簿格式： **cf \_ ENHMETAFILE** 和 **cf \_ METAFILEPICT**。</span><span class="sxs-lookup"><span data-stu-id="23fab-209">There are two clipboard formats for metafiles: **CF\_ENHMETAFILE** and **CF\_METAFILEPICT**.</span></span> <span data-ttu-id="23fab-210">為 Windows 中繼檔指定適用于增強型中繼檔和 **cf \_ METAFILEPICT** 的 **CF \_ ENHMETAFILE** 。</span><span class="sxs-lookup"><span data-stu-id="23fab-210">Specify **CF\_ENHMETAFILE** for enhanced metafiles and **CF\_METAFILEPICT** for Windows metafiles.</span></span>

## <a name="cloud-clipboard-and-clipboard-history-formats"></a><span data-ttu-id="23fab-211">雲端剪貼簿和剪貼簿歷程記錄格式</span><span class="sxs-lookup"><span data-stu-id="23fab-211">Cloud Clipboard and Clipboard History Formats</span></span>

<span data-ttu-id="23fab-212">某些版本的 Windows 包含 [雲端剪貼](/windows/whats-new/whats-new-windows-10-version-1809#cloud-clipboard)簿，可保留最近剪貼簿資料項目的歷程記錄，並可在使用者的裝置之間進行同步處理。</span><span class="sxs-lookup"><span data-stu-id="23fab-212">Some versions of Windows include [Cloud Clipboard](/windows/whats-new/whats-new-windows-10-version-1809#cloud-clipboard), which keeps a history of recent clipboard data items and can synchronize it between the user's devices.</span></span>
<span data-ttu-id="23fab-213">如果您不想要將應用程式放在剪貼簿上的資料放在剪貼簿歷程記錄中，或與其他裝置同步處理，則您的應用程式可以藉由將資料放在 Windows 系統已知的特定 [已註冊剪貼簿格式](#registered-clipboard-formats) 中，來控制這項行為：</span><span class="sxs-lookup"><span data-stu-id="23fab-213">If you don't want the data your application places on the clipboard to be included in the clipboard history or synchronized with other devices, your application can control this behavior by placing data in certain [registered clipboard formats](#registered-clipboard-formats) whose names are known to the Windows system:</span></span>

- <span data-ttu-id="23fab-214">**ExcludeClipboardContentFromMonitorProcessing** ：將任何資料放在剪貼簿上的格式，以防止所有剪貼簿格式包含在剪貼簿歷程記錄中，或同步處理到使用者的其他裝置。</span><span class="sxs-lookup"><span data-stu-id="23fab-214">**ExcludeClipboardContentFromMonitorProcessing** : Place any data on the clipboard in this format to prevent all clipboard formats being included in the clipboard history or synchronized to the user's other devices.</span></span>
- <span data-ttu-id="23fab-215">**CanIncludeInClipboardHistory** ：使用此格式將序列化的 **[DWORD](../WinProg/windows-data-types.md)** 值設為零，以防止所有剪貼簿格式包含在剪貼簿歷程記錄中，或將值設為1，以明確要求剪貼簿專案包含在剪貼簿歷程記錄中。</span><span class="sxs-lookup"><span data-stu-id="23fab-215">**CanIncludeInClipboardHistory** : Place a serialized **[DWORD](../WinProg/windows-data-types.md)** value of zero on the clipboard in this format to prevent all clipboard formats being included in the clipboard history, or place a value of one instead to explicitly request that the clipboard item be included in the clipboard history.</span></span> <span data-ttu-id="23fab-216">這不會影響與使用者其他裝置的同步處理。</span><span class="sxs-lookup"><span data-stu-id="23fab-216">This does not affect synchronization to the user's other devices.</span></span>
- <span data-ttu-id="23fab-217">**CanUploadToCloudClipboard** ：使用此格式將序列化的 **[DWORD](../WinProg/windows-data-types.md)** 值設為零，以防止所有剪貼簿格式同步處理到使用者的其他裝置，或將剪貼簿的值改為明確要求將剪貼簿專案同步處理到其他裝置。</span><span class="sxs-lookup"><span data-stu-id="23fab-217">**CanUploadToCloudClipboard** : Place a serialized **[DWORD](../WinProg/windows-data-types.md)** value of zero on the clipboard in this format to prevent all clipboard formats being synchronized to the user's other devices, or place a value of one instead to explicitly request that the clipboard item be synchronized to other devices.</span></span> <span data-ttu-id="23fab-218">這不會影響本機裝置的剪貼簿歷程記錄。</span><span class="sxs-lookup"><span data-stu-id="23fab-218">This does not affect the local device's clipboard history.</span></span>

<span data-ttu-id="23fab-219">如同其他已註冊的剪貼簿格式，您將需要使用 [**RegisterClipboardFormat**](
/windows/win32/api/winuser/nf-winuser-registerclipboardformata) 函式來取得可識別上述3種格式的不帶正負號的整數值。</span><span class="sxs-lookup"><span data-stu-id="23fab-219">As with other registered clipboard formats, you will need to use the [**RegisterClipboardFormat**](
/windows/win32/api/winuser/nf-winuser-registerclipboardformata) function to obtain an unsigned integer value that identifies each of the above 3 formats.</span></span>