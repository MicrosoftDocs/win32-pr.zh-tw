---
title: 剪貼簿作業
description: 當您剪下、複製或貼上資料時，視窗應該使用剪貼簿。 視窗會將資料放在剪貼簿上，以進行剪下和複製作業，並從剪貼簿取得貼上作業的資料。
ms.assetid: 27f9142c-3154-4de5-aea6-3c53f7e940ec
keywords:
- Windows 消費者介面，剪貼簿
- 剪貼簿、windows
- 剪貼簿，資料剪下
- 剪貼簿，複製資料
- 剪貼簿，貼上資料
- 剪貼簿，擁有者視窗
- 剪貼簿，延遲轉譯
- 剪貼簿、記憶體
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 5cb2c3451cf562b35b976e137a974e19892acbb3
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/20/2020
ms.locfileid: "104316213"
---
# <a name="clipboard-operations"></a><span data-ttu-id="6058a-112">剪貼簿作業</span><span class="sxs-lookup"><span data-stu-id="6058a-112">Clipboard Operations</span></span>

<span data-ttu-id="6058a-113">當您剪下、複製或貼上資料時，視窗應該使用剪貼簿。</span><span class="sxs-lookup"><span data-stu-id="6058a-113">A window should use the clipboard when cutting, copying, or pasting data.</span></span> <span data-ttu-id="6058a-114">視窗會將資料放在剪貼簿上，以進行剪下和複製作業，並從剪貼簿取得貼上作業的資料。</span><span class="sxs-lookup"><span data-stu-id="6058a-114">A window places data on the clipboard for cut and copy operations and retrieves data from the clipboard for paste operations.</span></span> <span data-ttu-id="6058a-115">下列各節將說明這些作業和相關問題。</span><span class="sxs-lookup"><span data-stu-id="6058a-115">The following sections describe these operations and related issues.</span></span>

<span data-ttu-id="6058a-116">若要將資料放在剪貼簿中或從中取出資料，視窗必須先使用 [**OpenClipboard**](/windows/desktop/api/Winuser/nf-winuser-openclipboard) 函式來開啟剪貼簿。</span><span class="sxs-lookup"><span data-stu-id="6058a-116">To place data on or retrieve data from the clipboard, a window must first open the clipboard by using the [**OpenClipboard**](/windows/desktop/api/Winuser/nf-winuser-openclipboard) function.</span></span> <span data-ttu-id="6058a-117">一個視窗一次只能開啟一個 [剪貼簿]。</span><span class="sxs-lookup"><span data-stu-id="6058a-117">Only one window can have the clipboard open at a time.</span></span> <span data-ttu-id="6058a-118">若要找出開啟 [剪貼簿] 的視窗，請呼叫 [**GetOpenClipboardWindow**](/windows/desktop/api/Winuser/nf-winuser-getopenclipboardwindow) 函式。</span><span class="sxs-lookup"><span data-stu-id="6058a-118">To find out which window has the clipboard open, call the [**GetOpenClipboardWindow**](/windows/desktop/api/Winuser/nf-winuser-getopenclipboardwindow) function.</span></span> <span data-ttu-id="6058a-119">完成時，視窗必須藉由呼叫 [**CloseClipboard**](/windows/desktop/api/Winuser/nf-winuser-closeclipboard) 函數來關閉剪貼簿。</span><span class="sxs-lookup"><span data-stu-id="6058a-119">When it has finished, the window must close the clipboard by calling the [**CloseClipboard**](/windows/desktop/api/Winuser/nf-winuser-closeclipboard) function.</span></span>

<span data-ttu-id="6058a-120">本節將討論下列主題。</span><span class="sxs-lookup"><span data-stu-id="6058a-120">The following topics are discussed in this section.</span></span>

-   [<span data-ttu-id="6058a-121">剪下和複製作業</span><span class="sxs-lookup"><span data-stu-id="6058a-121">Cut and Copy Operations</span></span>](#cut-and-copy-operations)
-   [<span data-ttu-id="6058a-122">貼上作業</span><span class="sxs-lookup"><span data-stu-id="6058a-122">Paste Operations</span></span>](#paste-operations)
-   [<span data-ttu-id="6058a-123">剪貼簿擁有權</span><span class="sxs-lookup"><span data-stu-id="6058a-123">Clipboard Ownership</span></span>](#clipboard-ownership)
-   [<span data-ttu-id="6058a-124">延遲轉譯</span><span class="sxs-lookup"><span data-stu-id="6058a-124">Delayed Rendering</span></span>](#delayed-rendering)
-   [<span data-ttu-id="6058a-125">記憶體和剪貼簿</span><span class="sxs-lookup"><span data-stu-id="6058a-125">Memory and the Clipboard</span></span>](#memory-and-the-clipboard)

## <a name="cut-and-copy-operations"></a><span data-ttu-id="6058a-126">剪下和複製作業</span><span class="sxs-lookup"><span data-stu-id="6058a-126">Cut and Copy Operations</span></span>

<span data-ttu-id="6058a-127">為了將資訊放置在剪貼簿上，視窗會先使用 [**EmptyClipboard**](/windows/win32/api/winuser/nf-winuser-emptyclipboard) 函式來清除任何先前的剪貼簿內容。</span><span class="sxs-lookup"><span data-stu-id="6058a-127">To place information on the clipboard, a window first clears any previous clipboard content by using the [**EmptyClipboard**](/windows/win32/api/winuser/nf-winuser-emptyclipboard) function.</span></span> <span data-ttu-id="6058a-128">此函式會將 [**WM \_ DESTROYCLIPBOARD**](wm-destroyclipboard.md) 訊息傳送至先前的剪貼簿擁有者、釋出與剪貼簿上的資料相關聯的資源，以及將剪貼簿擁有權指派給開啟 [剪貼簿] 的視窗。</span><span class="sxs-lookup"><span data-stu-id="6058a-128">This function sends the [**WM\_DESTROYCLIPBOARD**](wm-destroyclipboard.md) message to the previous clipboard owner, frees resources associated with data on the clipboard, and assigns clipboard ownership to the window that has the clipboard open.</span></span> <span data-ttu-id="6058a-129">若要找出哪個視窗擁有剪貼簿，請呼叫 [**GetClipboardOwner**](/windows/win32/api/winuser/nf-winuser-getclipboardowner) 函數。</span><span class="sxs-lookup"><span data-stu-id="6058a-129">To find out which window owns the clipboard, call the [**GetClipboardOwner**](/windows/win32/api/winuser/nf-winuser-getclipboardowner) function.</span></span>

<span data-ttu-id="6058a-130">清除剪貼簿之後，視窗會盡可能將剪貼簿格式的資料放在剪貼簿中，並以最描述性的剪貼簿格式排序，以最不描述性的方式排序。</span><span class="sxs-lookup"><span data-stu-id="6058a-130">After emptying the clipboard, the window places data on the clipboard in as many clipboard formats as possible, ordered from the most descriptive clipboard format to the least descriptive.</span></span> <span data-ttu-id="6058a-131">針對每一種格式，視窗都會呼叫 [**SetClipboardData**](/windows/win32/api/winuser/nf-winuser-setclipboarddata) 函式，並指定格式識別碼和全域記憶體控制碼。</span><span class="sxs-lookup"><span data-stu-id="6058a-131">For each format, the window calls the [**SetClipboardData**](/windows/win32/api/winuser/nf-winuser-setclipboarddata) function, specifying the format identifier and a global memory handle.</span></span> <span data-ttu-id="6058a-132">記憶體控制碼可以是 Null，表示視窗會依要求呈現資料。</span><span class="sxs-lookup"><span data-stu-id="6058a-132">The memory handle can be NULL, indicating that the window renders the data on request.</span></span> <span data-ttu-id="6058a-133">如需詳細資訊，請參閱 [延遲](#delayed-rendering)轉譯。</span><span class="sxs-lookup"><span data-stu-id="6058a-133">For more information, see [Delayed Rendering](#delayed-rendering).</span></span>

## <a name="paste-operations"></a><span data-ttu-id="6058a-134">貼上作業</span><span class="sxs-lookup"><span data-stu-id="6058a-134">Paste Operations</span></span>

<span data-ttu-id="6058a-135">為了抓取剪貼簿中的貼上資訊，視窗會先決定要取出的剪貼簿格式。</span><span class="sxs-lookup"><span data-stu-id="6058a-135">To retrieve paste information from the clipboard, a window first determines the clipboard format to retrieve.</span></span> <span data-ttu-id="6058a-136">通常，視窗會使用 [**EnumClipboardFormats**](/windows/desktop/api/Winuser/nf-winuser-enumclipboardformats) 函式來列舉可用的剪貼簿格式，並使用它所辨識的第一種格式。</span><span class="sxs-lookup"><span data-stu-id="6058a-136">Typically, a window enumerates the available clipboard formats by using the [**EnumClipboardFormats**](/windows/desktop/api/Winuser/nf-winuser-enumclipboardformats) function and uses the first format it recognizes.</span></span> <span data-ttu-id="6058a-137">這個方法會根據將資料放在剪貼簿上時所設定的優先順序，來選取最佳的可用格式。</span><span class="sxs-lookup"><span data-stu-id="6058a-137">This method selects the best available format according to the priority set when the data was placed on the clipboard.</span></span>

<span data-ttu-id="6058a-138">或者，視窗也可以使用 [**GetPriorityClipboardFormat**](/windows/desktop/api/Winuser/nf-winuser-getpriorityclipboardformat) 函式。</span><span class="sxs-lookup"><span data-stu-id="6058a-138">Alternatively, a window can use the [**GetPriorityClipboardFormat**](/windows/desktop/api/Winuser/nf-winuser-getpriorityclipboardformat) function.</span></span> <span data-ttu-id="6058a-139">此函式會根據指定的優先順序，識別最佳的可用剪貼簿格式。</span><span class="sxs-lookup"><span data-stu-id="6058a-139">This function identifies the best available clipboard format according to a specified priority.</span></span> <span data-ttu-id="6058a-140">只能辨識一個剪貼簿格式的視窗，可以使用 [**IsClipboardFormatAvailable**](/windows/desktop/api/Winuser/nf-winuser-isclipboardformatavailable) 函式來判斷該格式是否可供使用。</span><span class="sxs-lookup"><span data-stu-id="6058a-140">A window that recognizes only one clipboard format can simply determine whether that format is available by using the [**IsClipboardFormatAvailable**](/windows/desktop/api/Winuser/nf-winuser-isclipboardformatavailable) function.</span></span>

<span data-ttu-id="6058a-141">判斷要使用的剪貼簿格式後，視窗會呼叫 [**GetClipboardData**](/windows/desktop/api/Winuser/nf-winuser-getclipboarddata) 函數。</span><span class="sxs-lookup"><span data-stu-id="6058a-141">After determining the clipboard format to use, a window calls the [**GetClipboardData**](/windows/desktop/api/Winuser/nf-winuser-getclipboarddata) function.</span></span> <span data-ttu-id="6058a-142">此函式會傳回全域記憶體物件的控制碼，該物件包含指定之格式的資料。</span><span class="sxs-lookup"><span data-stu-id="6058a-142">This function returns the handle to a global memory object containing data in the specified format.</span></span> <span data-ttu-id="6058a-143">視窗可以短暫地鎖定記憶體物件，以便檢查或複製資料。</span><span class="sxs-lookup"><span data-stu-id="6058a-143">A window can briefly lock the memory object in order to examine or copy the data.</span></span> <span data-ttu-id="6058a-144">不過，視窗不應該釋出物件或讓它保持鎖定一段很長的時間。</span><span class="sxs-lookup"><span data-stu-id="6058a-144">However, a window should not free the object or leave it locked for a long period of time.</span></span>

## <a name="clipboard-ownership"></a><span data-ttu-id="6058a-145">剪貼簿擁有權</span><span class="sxs-lookup"><span data-stu-id="6058a-145">Clipboard Ownership</span></span>

<span data-ttu-id="6058a-146">*剪貼簿擁有* 者是與剪貼簿資訊相關聯的視窗。</span><span class="sxs-lookup"><span data-stu-id="6058a-146">The *clipboard owner* is the window associated with the information on the clipboard.</span></span> <span data-ttu-id="6058a-147">當視窗將資料放在剪貼簿上時（特別是在呼叫 [**EmptyClipboard**](/windows/desktop/api/Winuser/nf-winuser-emptyclipboard) 函式時），視窗就會變成剪貼簿擁有者。</span><span class="sxs-lookup"><span data-stu-id="6058a-147">A window becomes the clipboard owner when it places data on the clipboard, specifically, when it calls the [**EmptyClipboard**](/windows/desktop/api/Winuser/nf-winuser-emptyclipboard) function.</span></span> <span data-ttu-id="6058a-148">視窗會維持剪貼簿擁有者，直到它關閉或另一個視窗清空剪貼簿。</span><span class="sxs-lookup"><span data-stu-id="6058a-148">The window remains the clipboard owner until it is closed or another window empties the clipboard.</span></span>

<span data-ttu-id="6058a-149">當剪貼簿清空時，剪貼簿擁有者會收到 [**WM \_ DESTROYCLIPBOARD**](wm-destroyclipboard.md) 訊息。</span><span class="sxs-lookup"><span data-stu-id="6058a-149">When the clipboard is emptied, the clipboard owner receives a [**WM\_DESTROYCLIPBOARD**](wm-destroyclipboard.md) message.</span></span> <span data-ttu-id="6058a-150">以下是視窗可能處理此訊息的一些原因：</span><span class="sxs-lookup"><span data-stu-id="6058a-150">Following are some reasons why a window might process this message:</span></span>

-   <span data-ttu-id="6058a-151">視窗延遲呈現一或多個剪貼簿格式。</span><span class="sxs-lookup"><span data-stu-id="6058a-151">The window delayed rendering of one or more clipboard formats.</span></span> <span data-ttu-id="6058a-152">為了回應 [**WM \_ DESTROYCLIPBOARD**](wm-destroyclipboard.md) 訊息，視窗可能會釋放已配置的資源，以便在要求時呈現資料。</span><span class="sxs-lookup"><span data-stu-id="6058a-152">In response to the [**WM\_DESTROYCLIPBOARD**](wm-destroyclipboard.md) message, the window might free resources it had allocated in order to render data on request.</span></span> <span data-ttu-id="6058a-153">如需資料呈現的詳細資訊，請參閱 [延遲](#delayed-rendering)轉譯。</span><span class="sxs-lookup"><span data-stu-id="6058a-153">For more information about the rendering of data, see [Delayed Rendering](#delayed-rendering).</span></span>
-   <span data-ttu-id="6058a-154">視窗會以私用剪貼簿格式將資料放在剪貼簿上。</span><span class="sxs-lookup"><span data-stu-id="6058a-154">The window placed data on the clipboard in a private clipboard format.</span></span> <span data-ttu-id="6058a-155">當剪貼簿清空時，系統不會釋放私人剪貼簿格式的資料。</span><span class="sxs-lookup"><span data-stu-id="6058a-155">The data for private clipboard formats is not freed by the system when the clipboard is emptied.</span></span> <span data-ttu-id="6058a-156">因此，剪貼簿擁有者應該在收到 [**WM \_ DESTROYCLIPBOARD**](wm-destroyclipboard.md) 訊息時釋出資料。</span><span class="sxs-lookup"><span data-stu-id="6058a-156">Therefore, the clipboard owner should free the data upon receiving the [**WM\_DESTROYCLIPBOARD**](wm-destroyclipboard.md) message.</span></span> <span data-ttu-id="6058a-157">如需私用剪貼簿格式的詳細資訊，請參閱 [剪貼簿格式](clipboard-formats.md)。</span><span class="sxs-lookup"><span data-stu-id="6058a-157">For more information about private clipboard formats, see [Clipboard Formats](clipboard-formats.md).</span></span>
-   <span data-ttu-id="6058a-158">視窗會使用 **CF \_ OWNERDISPLAY** 剪貼簿格式將資料放在剪貼簿上。</span><span class="sxs-lookup"><span data-stu-id="6058a-158">The window placed data on the clipboard using the **CF\_OWNERDISPLAY** clipboard format.</span></span> <span data-ttu-id="6058a-159">為了回應 [**WM \_ DESTROYCLIPBOARD**](wm-destroyclipboard.md) 訊息，視窗可能會在 [剪貼簿檢視器] 視窗中釋放用來顯示資訊的資源。</span><span class="sxs-lookup"><span data-stu-id="6058a-159">In response to the [**WM\_DESTROYCLIPBOARD**](wm-destroyclipboard.md) message, the window might free resources it had used to display information in the clipboard viewer window.</span></span> <span data-ttu-id="6058a-160">如需此替代格式的詳細資訊，請參閱 [擁有者顯示格式](about-the-clipboard.md)。</span><span class="sxs-lookup"><span data-stu-id="6058a-160">For more information about this alternative format, see [Owner Display Format](about-the-clipboard.md).</span></span>

## <a name="delayed-rendering"></a><span data-ttu-id="6058a-161">延遲轉譯</span><span class="sxs-lookup"><span data-stu-id="6058a-161">Delayed Rendering</span></span>

<span data-ttu-id="6058a-162">將剪貼簿格式放在剪貼簿上時，視窗可以延遲轉譯該格式的資料，直到需要資料為止。</span><span class="sxs-lookup"><span data-stu-id="6058a-162">When placing a clipboard format on the clipboard, a window can delay rendering the data in that format until the data is needed.</span></span> <span data-ttu-id="6058a-163">若要這樣做，應用程式可以針對 [**SetClipboardData**](/windows/win32/api/winuser/nf-winuser-setclipboarddata)函數的 *HData* 參數指定 **Null** 。</span><span class="sxs-lookup"><span data-stu-id="6058a-163">To do so, an application can specify **NULL** for the *hData* parameter of the [**SetClipboardData**](/windows/win32/api/winuser/nf-winuser-setclipboarddata) function.</span></span> <span data-ttu-id="6058a-164">如果應用程式支援數個剪貼簿格式，部分或全部都是需要花費的時間來轉譯，這會很有用。</span><span class="sxs-lookup"><span data-stu-id="6058a-164">This is useful if the application supports several clipboard formats, some or all of which are time-consuming to render.</span></span> <span data-ttu-id="6058a-165">藉由傳遞 **Null** 控制碼，視窗只會在需要時呈現複雜的剪貼簿格式。</span><span class="sxs-lookup"><span data-stu-id="6058a-165">By passing a **NULL** handle, a window renders complex clipboard formats only when and if they are needed.</span></span>

<span data-ttu-id="6058a-166">如果視窗延遲轉譯剪貼簿格式，只要是剪貼簿擁有者，就必須做好準備，以便在要求時呈現格式。</span><span class="sxs-lookup"><span data-stu-id="6058a-166">If a window delays rendering a clipboard format, it must be prepared to render the format upon request for as long as it is the clipboard owner.</span></span> <span data-ttu-id="6058a-167">當針對尚未轉譯的特定格式收到要求時，系統會傳送 [**WM \_ RENDERFORMAT**](wm-renderformat.md) 訊息給剪貼簿擁有者。</span><span class="sxs-lookup"><span data-stu-id="6058a-167">The system sends the clipboard owner a [**WM\_RENDERFORMAT**](wm-renderformat.md) message when a request is received for a specific format that has not been rendered.</span></span> <span data-ttu-id="6058a-168">收到此訊息時，視窗應該呼叫 [**SetClipboardData**](/windows/win32/api/winuser/nf-winuser-setclipboarddata) 函式，以要求的格式將全域記憶體控制碼放置在剪貼簿上。</span><span class="sxs-lookup"><span data-stu-id="6058a-168">Upon receiving this message, the window should call the [**SetClipboardData**](/windows/win32/api/winuser/nf-winuser-setclipboarddata) function to place a global memory handle on the clipboard in the requested format.</span></span>

<span data-ttu-id="6058a-169">應用程式必須在呼叫 [**SetClipboardData**](/windows/win32/api/winuser/nf-winuser-setclipboarddata) 之前開啟剪貼簿，以回應 [**WM \_ RENDERFORMAT**](wm-renderformat.md) 訊息。</span><span class="sxs-lookup"><span data-stu-id="6058a-169">An application must not open the clipboard before calling [**SetClipboardData**](/windows/win32/api/winuser/nf-winuser-setclipboarddata) in response to the [**WM\_RENDERFORMAT**](wm-renderformat.md) message.</span></span> <span data-ttu-id="6058a-170">開啟剪貼簿並不是必要的，而且嘗試這麼做會失敗，因為剪貼簿目前正由要求轉譯格式的應用程式開啟。</span><span class="sxs-lookup"><span data-stu-id="6058a-170">Opening the clipboard is not necessary, and any attempt to do so will fail because the clipboard is currently being held open by the application that requested the format to be rendered.</span></span>

<span data-ttu-id="6058a-171">如果剪貼簿擁有者即將終結，且延遲轉譯部分或所有剪貼簿格式，則會收到 [**WM \_ RENDERALLFORMATS**](wm-renderallformats.md) 訊息。</span><span class="sxs-lookup"><span data-stu-id="6058a-171">If the clipboard owner is about to be destroyed and has delayed rendering some or all clipboard formats, it receives the [**WM\_RENDERALLFORMATS**](wm-renderallformats.md) message.</span></span> <span data-ttu-id="6058a-172">收到這則訊息時，視窗應該會開啟剪貼簿，檢查它是否仍是具有 [**GetClipboardOwner**](/windows/win32/api/winuser/nf-winuser-getclipboardowner) 功能的剪貼簿擁有者，然後將有效的記憶體控制碼放置在剪貼簿上，以取得它所提供的所有剪貼簿格式。</span><span class="sxs-lookup"><span data-stu-id="6058a-172">Upon receiving this message, the window should open the clipboard, check that it is still the clipboard owner with the the [**GetClipboardOwner**](/windows/win32/api/winuser/nf-winuser-getclipboardowner) function, and then place valid memory handles on the clipboard for all clipboard formats that it provides.</span></span> <span data-ttu-id="6058a-173">這可確保這些格式在剪貼簿擁有者終結之後仍可供使用。</span><span class="sxs-lookup"><span data-stu-id="6058a-173">This ensures that these formats remain available after the clipboard owner is destroyed.</span></span>

<span data-ttu-id="6058a-174">不同于 [**wm \_ RENDERFORMAT**](wm-renderformat.md)，回應 [**WM \_ RENDERALLFORMATS**](wm-renderallformats.md) 的應用程式應該先開啟剪貼簿，然後再呼叫 [**SetClipboardData**](/windows/win32/api/winuser/nf-winuser-setclipboarddata) ，以將任何全域記憶體控點放置在剪貼簿上。</span><span class="sxs-lookup"><span data-stu-id="6058a-174">Unlike with [**WM\_RENDERFORMAT**](wm-renderformat.md), an application responding to [**WM\_RENDERALLFORMATS**](wm-renderallformats.md) should open the clipboard before calling [**SetClipboardData**](/windows/win32/api/winuser/nf-winuser-setclipboarddata) to place any global memory handles on the clipboard.</span></span>

<span data-ttu-id="6058a-175">未轉譯以回應 [**WM \_ RENDERALLFORMATS**](wm-renderallformats.md) 訊息的任何剪貼簿格式都會停止供其他應用程式使用，且不會再由剪貼簿功能列舉。</span><span class="sxs-lookup"><span data-stu-id="6058a-175">Any clipboard formats that are not rendered in response to the [**WM\_RENDERALLFORMATS**](wm-renderallformats.md) message cease to be available to other applications and are no longer enumerated by the clipboard functions.</span></span>

## <a name="memory-and-the-clipboard"></a><span data-ttu-id="6058a-176">記憶體和剪貼簿</span><span class="sxs-lookup"><span data-stu-id="6058a-176">Memory and the Clipboard</span></span>

<span data-ttu-id="6058a-177">要放置在剪貼簿上的記憶體物件，應該使用 [**GlobalAlloc**](/windows/desktop/api/winbase/nf-winbase-globalalloc) 函式搭配 **GMEM \_ 可移動** 旗標進行配置。</span><span class="sxs-lookup"><span data-stu-id="6058a-177">A memory object that is to be placed on the clipboard should be allocated by using the [**GlobalAlloc**](/windows/desktop/api/winbase/nf-winbase-globalalloc) function with the **GMEM\_MOVEABLE** flag.</span></span>

<span data-ttu-id="6058a-178">將記憶體物件放到剪貼簿之後，就會將該記憶體控制碼的擁有權傳送至系統。</span><span class="sxs-lookup"><span data-stu-id="6058a-178">After a memory object is placed on the clipboard, ownership of that memory handle is transferred to the system.</span></span> <span data-ttu-id="6058a-179">當剪貼簿已清空，且記憶體物件具有下列其中一種剪貼簿格式時，系統會藉由呼叫指定的函式來釋出記憶體物件：</span><span class="sxs-lookup"><span data-stu-id="6058a-179">When the clipboard is emptied and the memory object has one of the following clipboard formats, the system frees the memory object by calling the specified function:</span></span>



| <span data-ttu-id="6058a-180">釋放物件的函式</span><span class="sxs-lookup"><span data-stu-id="6058a-180">Function to free object</span></span>                             | <span data-ttu-id="6058a-181">剪貼簿格式</span><span class="sxs-lookup"><span data-stu-id="6058a-181">Clipboard format</span></span>                                                                                                                                               |
|-----------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="6058a-182">**DeleteMetaFile**</span><span class="sxs-lookup"><span data-stu-id="6058a-182">**DeleteMetaFile**</span></span>](/windows/desktop/api/wingdi/nf-wingdi-deletemetafile)<br/> | <span data-ttu-id="6058a-183">**CF \_ DSPENHMETAFILE**</span><span class="sxs-lookup"><span data-stu-id="6058a-183">**CF\_DSPENHMETAFILE**</span></span><br/> <span data-ttu-id="6058a-184">**CF \_ DSPMETAFILEPICT**</span><span class="sxs-lookup"><span data-stu-id="6058a-184">**CF\_DSPMETAFILEPICT**</span></span><br/> <span data-ttu-id="6058a-185">**CF \_ ENHMETAFILE**</span><span class="sxs-lookup"><span data-stu-id="6058a-185">**CF\_ENHMETAFILE**</span></span><br/> <span data-ttu-id="6058a-186">**CF \_ METAFILEPICT**</span><span class="sxs-lookup"><span data-stu-id="6058a-186">**CF\_METAFILEPICT**</span></span><br/>                            |
| [<span data-ttu-id="6058a-187">**DeleteObject**</span><span class="sxs-lookup"><span data-stu-id="6058a-187">**DeleteObject**</span></span>](/windows/desktop/api/wingdi/nf-wingdi-deleteobject)<br/>     | <span data-ttu-id="6058a-188">**CF \_ 點陣圖**</span><span class="sxs-lookup"><span data-stu-id="6058a-188">**CF\_BITMAP**</span></span><br/> <span data-ttu-id="6058a-189">**CF \_ DSPBITMAP**</span><span class="sxs-lookup"><span data-stu-id="6058a-189">**CF\_DSPBITMAP**</span></span><br/> <span data-ttu-id="6058a-190">**CF \_ 調色板**</span><span class="sxs-lookup"><span data-stu-id="6058a-190">**CF\_PALETTE**</span></span><br/>                                                                              |
| [<span data-ttu-id="6058a-191">**GlobalFree**</span><span class="sxs-lookup"><span data-stu-id="6058a-191">**GlobalFree**</span></span>](/windows/desktop/api/winbase/nf-winbase-globalfree)<br/>        | <span data-ttu-id="6058a-192">**CF \_ DIB**</span><span class="sxs-lookup"><span data-stu-id="6058a-192">**CF\_DIB**</span></span><br/> <span data-ttu-id="6058a-193">**CF \_ DIBV5**</span><span class="sxs-lookup"><span data-stu-id="6058a-193">**CF\_DIBV5**</span></span><br/> <span data-ttu-id="6058a-194">**CF \_ DSPTEXT**</span><span class="sxs-lookup"><span data-stu-id="6058a-194">**CF\_DSPTEXT**</span></span><br/> <span data-ttu-id="6058a-195">**CF \_ OEMTEXT**</span><span class="sxs-lookup"><span data-stu-id="6058a-195">**CF\_OEMTEXT**</span></span><br/> <span data-ttu-id="6058a-196">**CF \_ 文字**</span><span class="sxs-lookup"><span data-stu-id="6058a-196">**CF\_TEXT**</span></span><br/> <span data-ttu-id="6058a-197">**CF \_ UNICODETEXT**</span><span class="sxs-lookup"><span data-stu-id="6058a-197">**CF\_UNICODETEXT**</span></span><br/>   |
| <span data-ttu-id="6058a-198">無</span><span class="sxs-lookup"><span data-stu-id="6058a-198">none</span></span><br/>                                     | <span data-ttu-id="6058a-199">**CF \_ OWNERDISPLAY**</span><span class="sxs-lookup"><span data-stu-id="6058a-199">**CF\_OWNERDISPLAY**</span></span><br/> <span data-ttu-id="6058a-200">當剪貼簿清空 **CF \_ OWNERDISPLAY** 物件時，應用程式本身必須釋放記憶體物件。</span><span class="sxs-lookup"><span data-stu-id="6058a-200">When the clipboard is emptied of a **CF\_OWNERDISPLAY** object, the application itself must free the memory object.</span></span><br/> |



 

 

