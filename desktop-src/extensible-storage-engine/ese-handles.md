---
description: 深入瞭解： ESE 控制碼
title: ESE 控制碼
TOCTitle: ESE Handles
ms:assetid: 969ae14f-3548-431d-a19d-5df92891441d
ms:mtpsurl: https://msdn.microsoft.com/library/Gg269349(v=EXCHG.10)
ms:contentKeyID: 32765636
ms.date: 04/11/2016
ms.topic: article
ms.openlocfilehash: cc91a4586fc1619c55b5f45afbca39ce04c0c6cb
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/08/2021
ms.locfileid: "104194476"
---
# <a name="ese-handles"></a><span data-ttu-id="78da3-103">ESE 控制碼</span><span class="sxs-lookup"><span data-stu-id="78da3-103">ESE Handles</span></span>


<span data-ttu-id="78da3-104">_**適用于：** Windows |Windows Server_</span><span class="sxs-lookup"><span data-stu-id="78da3-104">_**Applies to:** Windows | Windows Server_</span></span>

## <a name="ese-handles"></a><span data-ttu-id="78da3-105">ESE 控制碼</span><span class="sxs-lookup"><span data-stu-id="78da3-105">ESE Handles</span></span>

<span data-ttu-id="78da3-106">ESE 控制碼可用來建立會話和 access 資料庫。</span><span class="sxs-lookup"><span data-stu-id="78da3-106">ESE handles are used to create sessions and access databases.</span></span> <span data-ttu-id="78da3-107">它們會在階層中維護，這表示某層級的輸出會用來存取下一個層級的資源。</span><span class="sxs-lookup"><span data-stu-id="78da3-107">They are maintained in a hierarchy, which means that the output from one level is used to access resources at the next level.</span></span>

<span data-ttu-id="78da3-108">這裡的圖顯示建立控制碼的控制碼階層和對應函數。</span><span class="sxs-lookup"><span data-stu-id="78da3-108">The diagram here shows the hierarchy of handles and the corresponding functions that create the handles.</span></span> <span data-ttu-id="78da3-109">此外，也指出函式是在呼叫中用來建立新控制碼的控制碼。</span><span class="sxs-lookup"><span data-stu-id="78da3-109">Also indicated along with the functions are the handles that are used in the call to create the new handle.</span></span>

<span data-ttu-id="78da3-110">![ESE_Documentation_handles2](images/Gg269349.ESE_Documentation_handles2(EXCHG.10).gif "ESE_Documentation_handles2")</span><span class="sxs-lookup"><span data-stu-id="78da3-110">![ESE_Documentation_handles2](images/Gg269349.ESE_Documentation_handles2(EXCHG.10).gif "ESE_Documentation_handles2")</span></span>

<span data-ttu-id="78da3-111">如圖所示，實例是根控制碼，以及資料庫在發生非預期的進程終止或系統關機時復原的層級。</span><span class="sxs-lookup"><span data-stu-id="78da3-111">As shown in the diagram, the instance is the root handle and the level at which the database is recovered in the event of an unexpected process termination or system shutdown.</span></span> <span data-ttu-id="78da3-112">實例控制碼（JET_INSTANCE）是由 [JetCreateInstance](./jetcreateinstance-function.md) 和 [JetCreateInstance2](./jetcreateinstance2-function.md)所建立。</span><span class="sxs-lookup"><span data-stu-id="78da3-112">The instance handle, JET_INSTANCE, is created by [JetCreateInstance](./jetcreateinstance-function.md) and [JetCreateInstance2](./jetcreateinstance2-function.md).</span></span> <span data-ttu-id="78da3-113">下一個層級（工作階段層級）是 database engine 的交易內容，以及執行所有資料庫作業的層級。</span><span class="sxs-lookup"><span data-stu-id="78da3-113">The next level, the session level, is the transaction context of the database engine and the level under which all database operations are performed.</span></span> <span data-ttu-id="78da3-114">在 [JetBeginSession](./jetbeginsession-function.md)的呼叫中，會在實例的內容中建立會話控制碼（JET_SESID）。</span><span class="sxs-lookup"><span data-stu-id="78da3-114">The session handle, JET_SESID, is created in the context of the instance in the call to [JetBeginSession](./jetbeginsession-function.md).</span></span> <span data-ttu-id="78da3-115">會話識別碼會用於所有後續呼叫，以存取資料表和資料庫。</span><span class="sxs-lookup"><span data-stu-id="78da3-115">The session ID is used in all subsequent calls to access tables and databases.</span></span> <span data-ttu-id="78da3-116">如果一次有一個以上的執行緒正在使用實例，則每個執行緒都必須使用自己的會話控制碼。</span><span class="sxs-lookup"><span data-stu-id="78da3-116">If the instance is being used by more than one thread at a time then each thread must use its own session handle.</span></span> <span data-ttu-id="78da3-117">資料庫控制碼是使用會話控制碼所建立，主要是用來管理資料庫的架構，但是也可以用來管理資料庫內的資料表。</span><span class="sxs-lookup"><span data-stu-id="78da3-117">The database handle is created using the session handle and primarily used to manage the schema of the database, but it can also be used to manage tables inside the database.</span></span> <span data-ttu-id="78da3-118">資料庫控制碼只能用在建立它們的會話中。</span><span class="sxs-lookup"><span data-stu-id="78da3-118">Database handles can only be used in the session under which they are created.</span></span> <span data-ttu-id="78da3-119">在呼叫 [JetCreateDatabase](./jetcreatedatabase-function.md) 或 [JetOpenDatabase](./jetopendatabase-function.md)時，會建立資料庫的控制碼。</span><span class="sxs-lookup"><span data-stu-id="78da3-119">The handle to the database is created in the call to [JetCreateDatabase](./jetcreatedatabase-function.md) or [JetOpenDatabase](./jetopendatabase-function.md).</span></span> <span data-ttu-id="78da3-120">資料表會與建立它們的資料庫識別碼相關聯。</span><span class="sxs-lookup"><span data-stu-id="78da3-120">Tables are associated with the database ID under which they are created.</span></span>

<span data-ttu-id="78da3-121">JET_TABLEID 資料類型包含資料庫資料指標的控制碼。</span><span class="sxs-lookup"><span data-stu-id="78da3-121">The JET_TABLEID data type contains a handle to a database cursor.</span></span> <span data-ttu-id="78da3-122">它是用來掃描記錄、搜尋記錄，或建立更新和刪除記錄。</span><span class="sxs-lookup"><span data-stu-id="78da3-122">It is used to scan records, search records or create update and delete records.</span></span> <span data-ttu-id="78da3-123">資料表控制碼是在 [JetOpenTable](./jetopentable-function.md)或 [JetCreateTable](./jetcreatetable-function.md)的呼叫中建立的。</span><span class="sxs-lookup"><span data-stu-id="78da3-123">The table handle is created in the call to [JetOpenTable](./jetopentable-function.md), or [JetCreateTable](./jetcreatetable-function.md).</span></span> <span data-ttu-id="78da3-124">[JetOpenTempTable](./jetopentemptable-function.md)、 [JetOpenTempTable2](./jetopentemptable2-function.md)和 [JetOpenTempTable3](./jetopentemptable3-function.md) 也會建立臨時表的資料表識別碼，而 [JetCreateTableColumnIndex](./jetcreatetablecolumnindex-function.md) 和 [JetCreateTableColumnIndex2](./jetcreatetablecolumnindex2-function.md) 會傳回 out 結構中的資料表識別碼。</span><span class="sxs-lookup"><span data-stu-id="78da3-124">[JetOpenTempTable](./jetopentemptable-function.md), [JetOpenTempTable2](./jetopentemptable2-function.md), and [JetOpenTempTable3](./jetopentemptable3-function.md) also create table IDs for temporary tables, and [JetCreateTableColumnIndex](./jetcreatetablecolumnindex-function.md) and [JetCreateTableColumnIndex2](./jetcreatetablecolumnindex2-function.md) return table IDs in the out structure.</span></span> <span data-ttu-id="78da3-125">資料表內建立的每個資料行都有唯一的資料行識別碼或 COLUMN_ID。</span><span class="sxs-lookup"><span data-stu-id="78da3-125">The columns created within the table each have a unique column identifier or COLUMN_ID.</span></span> <span data-ttu-id="78da3-126">在 [JetAddColumn](./jetaddcolumn-function.md)的呼叫中，或在對臨時表的 [JetOpenTempTable](./jetopentemptable-function.md)、 [JetOpenTempTable2](./jetopentemptable2-function.md)或 [JetOpenTempTable3](./jetopentemptable3-function.md) 呼叫中建立資料行識別碼。</span><span class="sxs-lookup"><span data-stu-id="78da3-126">The columns IDs are created in the calls to [JetAddColumn](./jetaddcolumn-function.md), or in calls to [JetOpenTempTable](./jetopentemptable-function.md), [JetOpenTempTable2](./jetopentemptable2-function.md), or [JetOpenTempTable3](./jetopentemptable3-function.md) for temporary tables.</span></span> <span data-ttu-id="78da3-127">您也可以使用 [JetGetTableColumnInfo](./jetgettablecolumninfo-function.md)之類的 api，依名稱針對指定的資料行取得資料行識別碼。</span><span class="sxs-lookup"><span data-stu-id="78da3-127">Column IDs may also be retrieved for a given column by name with APIs such as [JetGetTableColumnInfo](./jetgettablecolumninfo-function.md).</span></span>
