---
title: 比較 Direct2D 和 GDI 硬體加速
description: Direct2D 和 GDI 都是立即模式2D 轉譯 Api，兩者都提供某種程度的硬體加速。
ms.assetid: 0028a0c3-445d-46b7-b55b-46dff3bce9ae
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 5f05dce8719f4d07d3160c65b88570391c3eb736
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/20/2020
ms.locfileid: "104315259"
---
# <a name="comparing-direct2d-and-gdi-hardware-acceleration"></a><span data-ttu-id="c6ff1-103">比較 Direct2D 和 GDI 硬體加速</span><span class="sxs-lookup"><span data-stu-id="c6ff1-103">Comparing Direct2D and GDI Hardware Acceleration</span></span>

<span data-ttu-id="c6ff1-104">[Direct2D](./direct2d-portal.md) 和 [GDI](/windows/desktop/gdi/windows-gdi) 都是立即模式2d 轉譯 api，兩者都提供某種程度的硬體加速。</span><span class="sxs-lookup"><span data-stu-id="c6ff1-104">[Direct2D](./direct2d-portal.md) and [GDI](/windows/desktop/gdi/windows-gdi) are both immediate mode 2D rendering APIs and both offer some degree of hardware acceleration.</span></span> <span data-ttu-id="c6ff1-105">本主題探討 Direct2D 與 GDI 之間的差異，包括過去和目前這兩個 Api 的硬體加速功能差異。</span><span class="sxs-lookup"><span data-stu-id="c6ff1-105">This topic explores the differences between Direct2D and GDI, including past and present differences in the hardware acceleration features of both APIs.</span></span>

<span data-ttu-id="c6ff1-106">本主題包含下列部分：</span><span class="sxs-lookup"><span data-stu-id="c6ff1-106">This topic has the following parts:</span></span>

-   [<span data-ttu-id="c6ff1-107">Direct2D 和 GDI 之間的差異</span><span class="sxs-lookup"><span data-stu-id="c6ff1-107">Differences between Direct2D and GDI</span></span>](#differences-between-direct2d-and-gdi)
-   [<span data-ttu-id="c6ff1-108">GDI 和 Direct2D 硬體加速</span><span class="sxs-lookup"><span data-stu-id="c6ff1-108">GDI and Direct2D hardware acceleration</span></span>](#gdi-and-direct2d-hardware-acceleration)
    -   [<span data-ttu-id="c6ff1-109">增加顯示驅動程式的複雜度和大小</span><span class="sxs-lookup"><span data-stu-id="c6ff1-109">Increasing complexity and size of display drivers</span></span>](#increasing-complexity-and-size-of-display-drivers)
    -   [<span data-ttu-id="c6ff1-110">同步處理會話和全球核心位址空間時遇到困難</span><span class="sxs-lookup"><span data-stu-id="c6ff1-110">Difficulty in synchronizing session and global kernel address spaces</span></span>](#difficulty-in-synchronizing-session-and-global-kernel-address-spaces)
    -   [<span data-ttu-id="c6ff1-111">複合視窗管理</span><span class="sxs-lookup"><span data-stu-id="c6ff1-111">Composited window management</span></span>](#composited-window-management)
-   [<span data-ttu-id="c6ff1-112">Windows 7 中的 GDI 轉譯</span><span class="sxs-lookup"><span data-stu-id="c6ff1-112">GDI rendering in Windows 7</span></span>](#gdi-rendering-in-windows-7)
-   [<span data-ttu-id="c6ff1-113">Windows 7 中的對比 Direct2D 和 GDI 加速</span><span class="sxs-lookup"><span data-stu-id="c6ff1-113">Contrasting Direct2D and GDI acceleration in Windows 7</span></span>](#contrasting-direct2d-and-gdi-acceleration-in-windows-7)
    -   [<span data-ttu-id="c6ff1-114">資源的位置</span><span class="sxs-lookup"><span data-stu-id="c6ff1-114">Location of resources</span></span>](#location-of-resources)
    -   [<span data-ttu-id="c6ff1-115">轉譯方法</span><span class="sxs-lookup"><span data-stu-id="c6ff1-115">Rendering method</span></span>](#rendering-method)
    -   [<span data-ttu-id="c6ff1-116">延展性</span><span class="sxs-lookup"><span data-stu-id="c6ff1-116">Scalability</span></span>](#scalability)
    -   [<span data-ttu-id="c6ff1-117">位置</span><span class="sxs-lookup"><span data-stu-id="c6ff1-117">Location</span></span>](#location-of-resources)
    -   [<span data-ttu-id="c6ff1-118">硬體加速的可用性</span><span class="sxs-lookup"><span data-stu-id="c6ff1-118">Availability of Hardware Acceleration</span></span>](#availability-of-hardware-acceleration)
    -   [<span data-ttu-id="c6ff1-119">展示模型</span><span class="sxs-lookup"><span data-stu-id="c6ff1-119">Presentation Model</span></span>](#presentation-model)
-   [<span data-ttu-id="c6ff1-120">結論</span><span class="sxs-lookup"><span data-stu-id="c6ff1-120">Conclusion</span></span>](#conclusion)

## <a name="differences-between-direct2d-and-gdi"></a><span data-ttu-id="c6ff1-121">Direct2D 和 GDI 之間的差異</span><span class="sxs-lookup"><span data-stu-id="c6ff1-121">Differences between Direct2D and GDI</span></span>

<span data-ttu-id="c6ff1-122">[GDI](/windows/desktop/gdi/windows-gdi) 會轉譯不透明的別名幾何，例如多邊形、橢圓形和線條。</span><span class="sxs-lookup"><span data-stu-id="c6ff1-122">[GDI](/windows/desktop/gdi/windows-gdi) renders opaque, aliased geometries such as polygons, ellipses and lines.</span></span> <span data-ttu-id="c6ff1-123">它會轉譯別名和 ClearType 文字，並且可支援透過 AlphaBlend API 的透明混色。</span><span class="sxs-lookup"><span data-stu-id="c6ff1-123">It renders aliased and ClearType text, and it can support transparency blending through the AlphaBlend API.</span></span> <span data-ttu-id="c6ff1-124">不過，其透明度的處理不一致，大部分的 GDI Api 只會忽略 Alpha 色板。</span><span class="sxs-lookup"><span data-stu-id="c6ff1-124">However, its handling of transparency is inconsistent and most GDI APIs simply ignore the alpha channel.</span></span> <span data-ttu-id="c6ff1-125">少數 GDI Api 可保證 Alpha 通道在作業之後會包含哪些內容。</span><span class="sxs-lookup"><span data-stu-id="c6ff1-125">Few GDI APIs guarantee what the alpha channel will contain after an operation.</span></span> <span data-ttu-id="c6ff1-126">更重要的是，GDI 的轉譯不會輕易地對應至3D 作業，而且新式 GPU 最有效率地呈現在其轉譯引擎的3D 部分。</span><span class="sxs-lookup"><span data-stu-id="c6ff1-126">More importantly, GDI's rendering does not map easily to 3D operations, and a modern GPU renders most efficiently on the 3D portion of its rendering engine.</span></span> <span data-ttu-id="c6ff1-127">例如， [Direct2D](./direct2d-portal.md)的鋸齒線條是設計來實作為在 GPU 上轉譯的兩個三角形，而 GDI 則使用 Bresenham 的線條繪製演算法。</span><span class="sxs-lookup"><span data-stu-id="c6ff1-127">For example, [Direct2D](./direct2d-portal.md)'s aliased lines are designed to be implemented simply as two triangles rendered on the GPU, whereas GDI uses Bresenham's line drawing algorithm.</span></span>

<span data-ttu-id="c6ff1-128">[Direct2D](./direct2d-portal.md) 會轉譯不透明、透明、別名和消除鋸齒的基本專案。</span><span class="sxs-lookup"><span data-stu-id="c6ff1-128">[Direct2D](./direct2d-portal.md) renders opaque, transparent, aliased and anti-aliased primitives.</span></span> <span data-ttu-id="c6ff1-129">新式 Ui 通常會利用透明度和動畫。</span><span class="sxs-lookup"><span data-stu-id="c6ff1-129">Modern UIs often make use of transparency and animation.</span></span> <span data-ttu-id="c6ff1-130">Direct2D 可讓您更輕鬆地建立新式 UI，因為它對於它接受和轉譯透明內容的方式有嚴格的保證，而且其所有基本專案都是使用硬體加速來呈現。</span><span class="sxs-lookup"><span data-stu-id="c6ff1-130">Direct2D makes it easier to create a modern UI because it has strict guarantees on how it accepts and renders transparent content, and all of its primitives are rendered using hardware acceleration.</span></span> <span data-ttu-id="c6ff1-131">Direct2D 不是 [GDI](/windows/desktop/gdi/windows-gdi)的純超集合：在 GPU 上執行的 GPU 不存在於 Direct2D 時，可能會過長慢的基本專案。</span><span class="sxs-lookup"><span data-stu-id="c6ff1-131">Direct2D is not a pure superset of [GDI](/windows/desktop/gdi/windows-gdi): primitives that would have been unreasonably slow when implemented on a GPU aren't present in Direct2D.</span></span> <span data-ttu-id="c6ff1-132">因為 Direct2D 是以這種方式來強調3D 加速，所以也很容易與 Direct3D 搭配使用。</span><span class="sxs-lookup"><span data-stu-id="c6ff1-132">Because Direct2D is built with this emphasis on 3D acceleration it is also easy to use with Direct3D.</span></span>

<span data-ttu-id="c6ff1-133">自 Windows NT 4 起， [GDI](/windows/desktop/gdi/windows-gdi) 已在核心模式中執行。</span><span class="sxs-lookup"><span data-stu-id="c6ff1-133">Since Windows NT 4, [GDI](/windows/desktop/gdi/windows-gdi) has run in kernel mode.</span></span> <span data-ttu-id="c6ff1-134">應用程式會呼叫 GDI，然後呼叫其核心模式對應專案，其會將基本專案傳遞至其本身的驅動程式模型。</span><span class="sxs-lookup"><span data-stu-id="c6ff1-134">The application calls GDI which then calls its kernel mode counterpart which passes the primitives to its own driver model.</span></span> <span data-ttu-id="c6ff1-135">然後，此驅動程式會將結果傳送至全域核心模式顯示驅動程式。</span><span class="sxs-lookup"><span data-stu-id="c6ff1-135">This driver then sends the results to the global kernel mode display driver.</span></span>

<span data-ttu-id="c6ff1-136">從 Windows 2000 開始， [gdi](/windows/desktop/gdi/windows-gdi) 和 gdi 驅動程式已在核心的獨立空間中執行，稱為「會話空間」。</span><span class="sxs-lookup"><span data-stu-id="c6ff1-136">Starting with Windows 2000, [GDI](/windows/desktop/gdi/windows-gdi) and the GDI drivers have run in an independent space in the kernel called "session space."</span></span> <span data-ttu-id="c6ff1-137">每個登入會話都會建立一個會話位址空間，而每個 GDI 實例會在此相異核心模式位址空間中獨立執行。</span><span class="sxs-lookup"><span data-stu-id="c6ff1-137">A session address space is created for each logon session, and each instance of GDI runs independently in this distinct kernel mode address space.</span></span> <span data-ttu-id="c6ff1-138">不過，Direct2D 會在使用者模式中執行，並透過使用者模式 Direct3D 驅動程式，將繪製命令傳遞至核心模式驅動程式。</span><span class="sxs-lookup"><span data-stu-id="c6ff1-138">Direct2D, however, runs in user mode and passes drawing commands through the user mode Direct3D driver to the kernel mode driver.</span></span>

![圖 1-相較于 gdi 的 direct2d](images/direct2d-vs-gdi1.png)

## <a name="gdi-and-direct2d-hardware-acceleration"></a><span data-ttu-id="c6ff1-140">GDI 和 Direct2D 硬體加速</span><span class="sxs-lookup"><span data-stu-id="c6ff1-140">GDI and Direct2D hardware acceleration</span></span>

<span data-ttu-id="c6ff1-141">[Direct2D](./direct2d-portal.md)與[GDI](/windows/desktop/gdi/windows-gdi)硬體加速之間最重要的差異是驅動它們的基礎技術。</span><span class="sxs-lookup"><span data-stu-id="c6ff1-141">The most important difference between [Direct2D](./direct2d-portal.md) and [GDI](/windows/desktop/gdi/windows-gdi) hardware acceleration is the underlying technology that drives them.</span></span> <span data-ttu-id="c6ff1-142">Direct2D 在最上層的 Direct3D 上具有多層式，而且 GDI 具有自己的驅動程式模型， (的 DDI) 的 GDI 設備磁碟機介面，這會對應至 GDI 基本專案。</span><span class="sxs-lookup"><span data-stu-id="c6ff1-142">Direct2D is layered on top Direct3D and GDI has its own driver model, the GDI Device Driver Interface (DDI), which corresponds to the GDI primitives.</span></span> <span data-ttu-id="c6ff1-143">Direct3D 驅動程式模型會對應至 GPU 中的3D 轉譯硬體所呈現的內容。</span><span class="sxs-lookup"><span data-stu-id="c6ff1-143">The Direct3D driver model corresponds to what the 3D rendering hardware in a GPU renders.</span></span> <span data-ttu-id="c6ff1-144">當您第一次定義 GDI DDI 時，大部分的顯示器加速硬體以 GDI 基本專案為目標。</span><span class="sxs-lookup"><span data-stu-id="c6ff1-144">When the GDI DDI was first defined, most display acceleration hardware targeted the GDI primitives.</span></span> <span data-ttu-id="c6ff1-145">經過一段時間之後，就能更強調地強調3D 遊戲加速，並減少應用程式加速。</span><span class="sxs-lookup"><span data-stu-id="c6ff1-145">Over time, more and more emphasis was placed on 3D game acceleration and less on application acceleration.</span></span> <span data-ttu-id="c6ff1-146">因此，BitBlt API 是硬體加速的，而其他大部分的 GDI 作業則不會發生。</span><span class="sxs-lookup"><span data-stu-id="c6ff1-146">As a consequence the BitBlt API was hardware accelerated and most other GDI operations were not.</span></span>

<span data-ttu-id="c6ff1-147">這會將變更順序的階段設定為 [GDI](/windows/desktop/gdi/windows-gdi) 呈現給顯示器的方式。</span><span class="sxs-lookup"><span data-stu-id="c6ff1-147">This set the stage for a sequence of changes to how [GDI](/windows/desktop/gdi/windows-gdi) renders to the display.</span></span> <span data-ttu-id="c6ff1-148">下圖顯示 GDI 顯示器轉譯如何從 Windows XP 變更為 Windows 7。</span><span class="sxs-lookup"><span data-stu-id="c6ff1-148">The following illustration shows how GDI display rendering has changed from Windows XP to Windows 7.</span></span>

![圖 2-gdi 顯示呈現的演進](images/direct2d-vs-gdi2.png)

<span data-ttu-id="c6ff1-150">另外還有一些其他因素會導致 [GDI](/windows/desktop/gdi/windows-gdi) 驅動程式模型的變更，如下所述。</span><span class="sxs-lookup"><span data-stu-id="c6ff1-150">There were also a number of additional factors that caused changes to the [GDI](/windows/desktop/gdi/windows-gdi) driver model, as explained below.</span></span>

### <a name="increasing-complexity-and-size-of-display-drivers"></a><span data-ttu-id="c6ff1-151">增加顯示驅動程式的複雜度和大小</span><span class="sxs-lookup"><span data-stu-id="c6ff1-151">Increasing complexity and size of display drivers</span></span>

<span data-ttu-id="c6ff1-152">3D 驅動程式在一段時間後會變得更複雜。</span><span class="sxs-lookup"><span data-stu-id="c6ff1-152">3D drivers have become more complex over time.</span></span> <span data-ttu-id="c6ff1-153">更複雜的程式碼通常會有更多瑕疵，使驅動程式在驅動程式 bug 無法導致系統重新開機的使用者模式中存在。</span><span class="sxs-lookup"><span data-stu-id="c6ff1-153">More complex code tends to have more defects making it beneficial for the driver to exist in user-mode where a driver bug can't cause a system reboot.</span></span> <span data-ttu-id="c6ff1-154">如上圖所示，顯示驅動程式會分割成複雜的使用者模式元件和較簡單的核心模式元件。</span><span class="sxs-lookup"><span data-stu-id="c6ff1-154">As can be seen in the figure above, the display driver is divided into a complex user mode component and a simpler kernel mode component.</span></span>

### <a name="difficulty-in-synchronizing-session-and-global-kernel-address-spaces"></a><span data-ttu-id="c6ff1-155">同步處理會話和全球核心位址空間時遇到困難</span><span class="sxs-lookup"><span data-stu-id="c6ff1-155">Difficulty in synchronizing session and global kernel address spaces</span></span>

<span data-ttu-id="c6ff1-156">在 Windows XP 中，顯示驅動程式存在於兩個不同的位址空間中：會話空間和核心空間。</span><span class="sxs-lookup"><span data-stu-id="c6ff1-156">In Windows XP, a display driver exists in two different address spaces: session space and kernel space.</span></span> <span data-ttu-id="c6ff1-157">驅動程式的元件需要回應電源管理事件之類的事件。</span><span class="sxs-lookup"><span data-stu-id="c6ff1-157">Parts of the driver need to respond to events such as power management events.</span></span> <span data-ttu-id="c6ff1-158">這必須與會話位址空間中的驅動程式狀態同步處理。</span><span class="sxs-lookup"><span data-stu-id="c6ff1-158">This needs to be synchronized with the driver state in the session address space.</span></span> <span data-ttu-id="c6ff1-159">這是一項困難的工作，當顯示驅動程式嘗試處理這些相異的位址空間時，可能會導致瑕疵。</span><span class="sxs-lookup"><span data-stu-id="c6ff1-159">This is a difficult task and can lead to defects when display drivers attempt to deal with these distinct address spaces.</span></span>

### <a name="composited-window-management"></a><span data-ttu-id="c6ff1-160">複合視窗管理</span><span class="sxs-lookup"><span data-stu-id="c6ff1-160">Composited window management</span></span>

<span data-ttu-id="c6ff1-161">桌面視窗管理員 (DWM) （在 Windows 7 中引進的組合視窗管理員）會將所有視窗轉譯成非螢幕表面，然後將它們組合在一起，以顯示在畫面上。</span><span class="sxs-lookup"><span data-stu-id="c6ff1-161">The Desktop Window Manager (DWM), the compositing window manager introduced in Windows 7, renders all windows to off-screen surfaces and then composes them together to be displayed on screen.</span></span> <span data-ttu-id="c6ff1-162">這需要 [GDI](/windows/desktop/gdi/windows-gdi) 才能轉譯成介面，然後 Direct3D 會將其轉譯為顯示。</span><span class="sxs-lookup"><span data-stu-id="c6ff1-162">This requires [GDI](/windows/desktop/gdi/windows-gdi) to be able to render to a surface which will then be rendered by Direct3D to display.</span></span> <span data-ttu-id="c6ff1-163">這會造成 XP 驅動程式模型發生問題，因為 GDI 和 Direct3D 是平行驅動程式堆疊。</span><span class="sxs-lookup"><span data-stu-id="c6ff1-163">This posed a problem in the XP driver model, since GDI and Direct3D were parallel driver stacks.</span></span>

<span data-ttu-id="c6ff1-164">如此一來，在 Windows Vista 中， [GDI](/windows/desktop/gdi/windows-gdi) DDI 顯示驅動程式會實作為 Microsoft 提供的標準顯示驅動程式 (CDD) 將 GDI 內容轉譯成系統記憶體點陣圖以組成螢幕。</span><span class="sxs-lookup"><span data-stu-id="c6ff1-164">As a result, in Windows Vista, the [GDI](/windows/desktop/gdi/windows-gdi) DDI display driver was implemented as the Microsoft supplied Canonical Display Driver (CDD) which rendered GDI content to a system memory bitmap to be composed to the screen.</span></span>

## <a name="gdi-rendering-in-windows-7"></a><span data-ttu-id="c6ff1-165">Windows 7 中的 GDI 轉譯</span><span class="sxs-lookup"><span data-stu-id="c6ff1-165">GDI rendering in Windows 7</span></span>

<span data-ttu-id="c6ff1-166">在 Windows Vista 中使用的驅動程式模型需要影片記憶體介面和系統記憶體介面都支援每個 [GDI](/windows/desktop/gdi/windows-gdi) 視窗。</span><span class="sxs-lookup"><span data-stu-id="c6ff1-166">The driver model used in Windows Vista required that every [GDI](/windows/desktop/gdi/windows-gdi) window be backed by both a video memory surface and a system memory surface.</span></span> <span data-ttu-id="c6ff1-167">這會導致系統記憶體用於每個 GDI 視窗。</span><span class="sxs-lookup"><span data-stu-id="c6ff1-167">This resulted in system memory being used for every GDI window.</span></span>

<span data-ttu-id="c6ff1-168">因此，Windows 7 中的 [GDI](/windows/desktop/gdi/windows-gdi) 已再次變更。</span><span class="sxs-lookup"><span data-stu-id="c6ff1-168">For this reason, [GDI](/windows/desktop/gdi/windows-gdi) was changed again in Windows 7.</span></span> <span data-ttu-id="c6ff1-169">.</span><span class="sxs-lookup"><span data-stu-id="c6ff1-169">.</span></span> <span data-ttu-id="c6ff1-170">GDI 不會轉譯成系統記憶體介面，而是為了轉譯成光圈記憶體區段而不會呈現。</span><span class="sxs-lookup"><span data-stu-id="c6ff1-170">Instead of rendering to a system memory surface, GDI was modified to render to an aperture memory segment.</span></span> <span data-ttu-id="c6ff1-171">您可以從包含視窗內容的視訊記憶體介面更新口徑記憶體。</span><span class="sxs-lookup"><span data-stu-id="c6ff1-171">The aperture memory can be updated from the video memory surface holding the window contents.</span></span> <span data-ttu-id="c6ff1-172">GDI 可以轉譯回光圈記憶體，然後將結果傳回視窗介面。</span><span class="sxs-lookup"><span data-stu-id="c6ff1-172">GDI can render back to the aperture memory, and the result can then be sent back to the window surface.</span></span> <span data-ttu-id="c6ff1-173">由於記憶體區段是由 GPU 定址，因此 GPU 可以加速這些更新至視訊記憶體介面。</span><span class="sxs-lookup"><span data-stu-id="c6ff1-173">Since the aperture memory segment is addressable by the GPU, the GPU can accelerate these updates to the video memory surface.</span></span> <span data-ttu-id="c6ff1-174">例如，在這些情況下，文字轉譯、BitBlts、AlphaBlend、TransparentBlt 和 StretchBlt 全都加速。</span><span class="sxs-lookup"><span data-stu-id="c6ff1-174">For example, text rendering, BitBlts, AlphaBlend, TransparentBlt, and StretchBlt are all accelerated in these cases.</span></span>

## <a name="contrasting-direct2d-and-gdi-acceleration-in-windows-7"></a><span data-ttu-id="c6ff1-175">Windows 7 中的對比 Direct2D 和 GDI 加速</span><span class="sxs-lookup"><span data-stu-id="c6ff1-175">Contrasting Direct2D and GDI acceleration in Windows 7</span></span>

<span data-ttu-id="c6ff1-176">[Direct2D](./direct2d-portal.md) 和 [GDI](/windows/desktop/gdi/windows-gdi) 都是2D 立即模式轉譯 api，並為硬體加速。</span><span class="sxs-lookup"><span data-stu-id="c6ff1-176">[Direct2D](./direct2d-portal.md) and [GDI](/windows/desktop/gdi/windows-gdi) are both 2D immediate-mode rendering APIs and are hardware accelerated.</span></span> <span data-ttu-id="c6ff1-177">不過，這兩個 Api 中仍有一些差異。</span><span class="sxs-lookup"><span data-stu-id="c6ff1-177">However, there are a number of differences that remain in both APIs.</span></span>

### <a name="location-of-resources"></a><span data-ttu-id="c6ff1-178">資源的位置</span><span class="sxs-lookup"><span data-stu-id="c6ff1-178">Location of resources</span></span>

<span data-ttu-id="c6ff1-179">[GDI](/windows/desktop/gdi/windows-gdi) 預設會在系統記憶體中維護其資源（尤其是點陣圖）。</span><span class="sxs-lookup"><span data-stu-id="c6ff1-179">[GDI](/windows/desktop/gdi/windows-gdi) maintains its resources, in particular bitmaps, in system memory by default.</span></span> <span data-ttu-id="c6ff1-180">[Direct2D](./direct2d-portal.md) 會在顯示介面卡上的視訊記憶體中維護其資源。</span><span class="sxs-lookup"><span data-stu-id="c6ff1-180">[Direct2D](./direct2d-portal.md) maintains its resources in video memory on the display adapter.</span></span> <span data-ttu-id="c6ff1-181">當 GDI 需要更新視訊記憶體時，必須透過匯流排來完成這項作業，除非資源已在光圈記憶體區段中，或是可以直接表示作業。</span><span class="sxs-lookup"><span data-stu-id="c6ff1-181">When GDI needs to update video memory, this must be done over the bus, unless the resource is already in the aperture memory segment or if the operation can be expressed directly.</span></span> <span data-ttu-id="c6ff1-182">相反地，Direct2D 只會將其基本專案轉譯為 Direct3D 基本專案，因為這些資源已經在視訊記憶體中。</span><span class="sxs-lookup"><span data-stu-id="c6ff1-182">In contrast, Direct2D can simply translate its primitives to Direct3D primitives because the resources are already in video memory.</span></span>

### <a name="rendering-method"></a><span data-ttu-id="c6ff1-183">轉譯方法</span><span class="sxs-lookup"><span data-stu-id="c6ff1-183">Rendering method</span></span>

<span data-ttu-id="c6ff1-184">為了維持相容性， [GDI](/windows/desktop/gdi/windows-gdi) 會使用 CPU 來執行其轉譯的大型部分，以佔用記憶體。</span><span class="sxs-lookup"><span data-stu-id="c6ff1-184">In order to maintain compatibility, [GDI](/windows/desktop/gdi/windows-gdi) performs a large part of its rendering to aperture memory using the CPU.</span></span> <span data-ttu-id="c6ff1-185">相反地， [Direct2D](./direct2d-portal.md) 會將其 api 呼叫轉譯為 Direct3D 基本專案和繪圖作業。</span><span class="sxs-lookup"><span data-stu-id="c6ff1-185">In contrast, [Direct2D](./direct2d-portal.md) translates its APIs calls into Direct3D primitives and drawing operations.</span></span> <span data-ttu-id="c6ff1-186">然後，會在 GPU 上轉譯結果。</span><span class="sxs-lookup"><span data-stu-id="c6ff1-186">The result is then rendered on the GPU.</span></span> <span data-ttu-id="c6ff1-187">當將口徑記憶體複製到代表 GDI 視窗的視訊記憶體介面時，會在 GPU 上執行某些 GDI 轉譯。</span><span class="sxs-lookup"><span data-stu-id="c6ff1-187">Some of GDI?s rendering is performed on the GPU when the aperture memory is copied to the video memory surface representing the GDI window.</span></span>

### <a name="scalability"></a><span data-ttu-id="c6ff1-188">延展性</span><span class="sxs-lookup"><span data-stu-id="c6ff1-188">Scalability</span></span>

<span data-ttu-id="c6ff1-189">[Direct2D](./direct2d-portal.md)的轉譯呼叫是 GPU 的所有獨立命令資料流程。</span><span class="sxs-lookup"><span data-stu-id="c6ff1-189">[Direct2D](./direct2d-portal.md)'s rendering calls are all independent command streams to the GPU.</span></span> <span data-ttu-id="c6ff1-190">每個 Direct2D factory 都代表不同的 Direct3D 裝置。</span><span class="sxs-lookup"><span data-stu-id="c6ff1-190">Each Direct2D factory represents a different Direct3D device.</span></span> <span data-ttu-id="c6ff1-191">[GDI](/windows/desktop/gdi/windows-gdi) 會針對系統上的所有應用程式使用一個命令資料流程。</span><span class="sxs-lookup"><span data-stu-id="c6ff1-191">[GDI](/windows/desktop/gdi/windows-gdi) uses one command stream for all of the applications on the system.</span></span> <span data-ttu-id="c6ff1-192">GDI 的方法可能會產生 GPU 和 CPU 轉譯內容的額外負荷。</span><span class="sxs-lookup"><span data-stu-id="c6ff1-192">GDI's method can result in a buildup of GPU and CPU rendering context overhead.</span></span>

### <a name="location"></a><span data-ttu-id="c6ff1-193">Location</span><span class="sxs-lookup"><span data-stu-id="c6ff1-193">Location</span></span>

<span data-ttu-id="c6ff1-194">[Direct2D](./direct2d-portal.md) 完全以使用者模式運作，包括 direct3d 執行時間和使用者模式 Direct3D 驅動程式。</span><span class="sxs-lookup"><span data-stu-id="c6ff1-194">[Direct2D](./direct2d-portal.md) operates entirely in user mode, including the Direct3D run time and the user mode Direct3D driver.</span></span> <span data-ttu-id="c6ff1-195">這有助於防止核心中的程式碼缺失造成系統損毀。</span><span class="sxs-lookup"><span data-stu-id="c6ff1-195">This helps prevent system crashes caused by code defects in the kernel.</span></span> <span data-ttu-id="c6ff1-196">不過， [GDI](/windows/desktop/gdi/windows-gdi)在核心模式的會話空間中有大部分的功能，且其 API 介面在使用者模式中。</span><span class="sxs-lookup"><span data-stu-id="c6ff1-196">[GDI](/windows/desktop/gdi/windows-gdi), however, has most of its functionality in session space in kernel mode, with its API surface in user mode.</span></span>

### <a name="availability-of-hardware-acceleration"></a><span data-ttu-id="c6ff1-197">硬體加速的可用性</span><span class="sxs-lookup"><span data-stu-id="c6ff1-197">Availability of Hardware Acceleration</span></span>

<span data-ttu-id="c6ff1-198">[GDI](/windows/desktop/gdi/windows-gdi) 是 windows XP 上的硬體加速功能，當桌面視窗管理員正在執行，且有 WDDM 1.1 驅動程式正在使用中時，會在 windows 7 上加速。</span><span class="sxs-lookup"><span data-stu-id="c6ff1-198">[GDI](/windows/desktop/gdi/windows-gdi) is hardware accelerated on Windows XP, and accelerated on Windows 7 when the Desktop Window Manager is running and a WDDM 1.1 driver is in use.</span></span> <span data-ttu-id="c6ff1-199">[Direct2D](./direct2d-portal.md) 是幾乎任何 WDDM 驅動程式的硬體加速，以及 DWM 是否正在使用中。</span><span class="sxs-lookup"><span data-stu-id="c6ff1-199">[Direct2D](./direct2d-portal.md) is hardware accelerated on almost any WDDM driver and whether or not DWM is in use.</span></span> <span data-ttu-id="c6ff1-200">在 Vista 上，GDI 一律會在 CPU 上呈現。</span><span class="sxs-lookup"><span data-stu-id="c6ff1-200">On Vista, GDI will always render on the CPU.</span></span>

### <a name="presentation-model"></a><span data-ttu-id="c6ff1-201">展示模型</span><span class="sxs-lookup"><span data-stu-id="c6ff1-201">Presentation Model</span></span>

<span data-ttu-id="c6ff1-202">當您第一次設計 Windows 時，記憶體不足，無法讓每個視窗都儲存在自己的點陣圖中。</span><span class="sxs-lookup"><span data-stu-id="c6ff1-202">When Windows was first designed, there was insufficient memory to allow every window to be stored in its own bitmap.</span></span> <span data-ttu-id="c6ff1-203">如此一來， [GDI](/windows/desktop/gdi/windows-gdi) 一律會以邏輯方式直接轉譯至螢幕，並套用各種裁剪區域，以確保應用程式不會在其視窗之外轉譯。</span><span class="sxs-lookup"><span data-stu-id="c6ff1-203">As a result, [GDI](/windows/desktop/gdi/windows-gdi) always rendered logically directly to the screen, with various clipping regions applied to ensure that an application did not render outside of its window.</span></span> <span data-ttu-id="c6ff1-204">在 [Direct2D](./direct2d-portal.md) 模型中，應用程式會轉譯為背景緩衝區，並在應用程式完成繪製時顯示結果。</span><span class="sxs-lookup"><span data-stu-id="c6ff1-204">In the [Direct2D](./direct2d-portal.md) model, an application renders to a back-buffer, and the result is displayed when the application is done drawing.</span></span> <span data-ttu-id="c6ff1-205">如此一來，Direct2D 就可以處理動畫案例，比 GDI 更流暢地。</span><span class="sxs-lookup"><span data-stu-id="c6ff1-205">This allows Direct2D to handle animation scenarios much more fluidly than GDI can.</span></span>

## <a name="conclusion"></a><span data-ttu-id="c6ff1-206">結論</span><span class="sxs-lookup"><span data-stu-id="c6ff1-206">Conclusion</span></span>

<span data-ttu-id="c6ff1-207">現有的 [GDI](/windows/desktop/gdi/windows-gdi) 程式碼在 Windows 7 下將繼續正常運作。</span><span class="sxs-lookup"><span data-stu-id="c6ff1-207">Existing [GDI](/windows/desktop/gdi/windows-gdi) code will continue to work well under Windows 7.</span></span> <span data-ttu-id="c6ff1-208">不過，在撰寫新的圖形轉譯程式碼時，應該考慮 [Direct2D](./direct2d-portal.md) ，因為它會更充分利用新式 gpu。</span><span class="sxs-lookup"><span data-stu-id="c6ff1-208">However, when writing new graphics rendering code, [Direct2D](./direct2d-portal.md) should be considered, as it takes better advantage of modern GPUs.</span></span>

 

 