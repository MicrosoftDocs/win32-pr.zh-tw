---
title: 網域控制站和複寫管理功能
description: 本主題包含用於網域控制站和複寫管理的函數清單。
ms.assetid: a92783c2-ffb8-473e-8484-1c05ca5453ff
ms.tgt_platform: multiple
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 00660658874bad4e34a8f6917e08289007cec4d7
ms.sourcegitcommit: 803f3ccd65bdefe36bd851b9c6e7280be9489016
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/17/2020
ms.locfileid: "104023263"
---
# <a name="domain-controller-and-replication-management-functions"></a><span data-ttu-id="73a84-103">網域控制站和複寫管理功能</span><span class="sxs-lookup"><span data-stu-id="73a84-103">Domain Controller and Replication Management Functions</span></span>

<span data-ttu-id="73a84-104">網域控制站 (DC) 和複寫管理函式提供的工具可用來尋找 DC 的相關資料、轉換不同格式之間網路物件的名稱、操作服務主體名稱 (Spn) 和目錄服務代理程式 (Dsa) ，以及管理伺服器的複寫。</span><span class="sxs-lookup"><span data-stu-id="73a84-104">The domain controller (DC) and replication management functions provide tools for finding data about a DC, converting the names of network objects between different formats, manipulating service principal names (SPNs) and directory service agents (DSAs), and managing replication of servers.</span></span> <span data-ttu-id="73a84-105">下列功能可讓開發人員使用網域控制站、複寫和目錄服務：</span><span class="sxs-lookup"><span data-stu-id="73a84-105">The following functions enable developers to work with domain controllers, replication, and the directory service:</span></span>

-   [<span data-ttu-id="73a84-106">**DsAddSidHistory**</span><span class="sxs-lookup"><span data-stu-id="73a84-106">**DsAddSidHistory**</span></span>](/windows/desktop/api/Ntdsapi/nf-ntdsapi-dsaddsidhistorya)
-   [<span data-ttu-id="73a84-107">**DsBind**</span><span class="sxs-lookup"><span data-stu-id="73a84-107">**DsBind**</span></span>](/windows/desktop/api/Ntdsapi/nf-ntdsapi-dsbinda)
-   [<span data-ttu-id="73a84-108">**DsBindingSetTimeout**</span><span class="sxs-lookup"><span data-stu-id="73a84-108">**DsBindingSetTimeout**</span></span>](/windows/desktop/api/Ntdsapi/nf-ntdsapi-dsbindingsettimeout)
-   [<span data-ttu-id="73a84-109">**DsBindToISTG**</span><span class="sxs-lookup"><span data-stu-id="73a84-109">**DsBindToISTG**</span></span>](/windows/desktop/api/Ntdsapi/nf-ntdsapi-dsbindtoistga)
-   [<span data-ttu-id="73a84-110">**DsBindWithCred**</span><span class="sxs-lookup"><span data-stu-id="73a84-110">**DsBindWithCred**</span></span>](/windows/desktop/api/Ntdsapi/nf-ntdsapi-dsbindwithcreda)
-   [<span data-ttu-id="73a84-111">**DsBindWithSpn**</span><span class="sxs-lookup"><span data-stu-id="73a84-111">**DsBindWithSpn**</span></span>](/windows/desktop/api/Ntdsapi/nf-ntdsapi-dsbindwithspna)
-   [<span data-ttu-id="73a84-112">**DsBindWithSpnEx**</span><span class="sxs-lookup"><span data-stu-id="73a84-112">**DsBindWithSpnEx**</span></span>](/windows/desktop/api/Ntdsapi/nf-ntdsapi-dsbindwithspnexa)
-   [<span data-ttu-id="73a84-113">**DsClientMakeSpnForTargetServer**</span><span class="sxs-lookup"><span data-stu-id="73a84-113">**DsClientMakeSpnForTargetServer**</span></span>](/windows/desktop/api/Ntdsapi/nf-ntdsapi-dsclientmakespnfortargetservera)
-   [<span data-ttu-id="73a84-114">**DsCrackNames**</span><span class="sxs-lookup"><span data-stu-id="73a84-114">**DsCrackNames**</span></span>](/windows/desktop/api/Ntdsapi/nf-ntdsapi-dscracknamesa)
-   [<span data-ttu-id="73a84-115">**DsCrackSpn**</span><span class="sxs-lookup"><span data-stu-id="73a84-115">**DsCrackSpn**</span></span>](/windows/desktop/api/Dsparse/nf-dsparse-dscrackspna)
-   [<span data-ttu-id="73a84-116">**DsCrackUnquotedMangledRdn**</span><span class="sxs-lookup"><span data-stu-id="73a84-116">**DsCrackUnquotedMangledRdn**</span></span>](/windows/desktop/api/Dsparse/nf-dsparse-dscrackunquotedmangledrdna)
-   [<span data-ttu-id="73a84-117">**DsFreeDomainControllerInfo**</span><span class="sxs-lookup"><span data-stu-id="73a84-117">**DsFreeDomainControllerInfo**</span></span>](/windows/desktop/api/Ntdsapi/nf-ntdsapi-dsfreedomaincontrollerinfoa)
-   [<span data-ttu-id="73a84-118">**DsFreeNameResult**</span><span class="sxs-lookup"><span data-stu-id="73a84-118">**DsFreeNameResult**</span></span>](/windows/desktop/api/Ntdsapi/nf-ntdsapi-dsfreenameresulta)
-   [<span data-ttu-id="73a84-119">**DsFreePasswordCredentials**</span><span class="sxs-lookup"><span data-stu-id="73a84-119">**DsFreePasswordCredentials**</span></span>](/windows/desktop/api/Ntdsapi/nf-ntdsapi-dsfreepasswordcredentials)
-   [<span data-ttu-id="73a84-120">**DsFreeSchemaGuidMap**</span><span class="sxs-lookup"><span data-stu-id="73a84-120">**DsFreeSchemaGuidMap**</span></span>](/windows/desktop/api/Ntdsapi/nf-ntdsapi-dsfreeschemaguidmapa)
-   [<span data-ttu-id="73a84-121">**DsFreeSpnArray**</span><span class="sxs-lookup"><span data-stu-id="73a84-121">**DsFreeSpnArray**</span></span>](/windows/desktop/api/Ntdsapi/nf-ntdsapi-dsfreespnarraya)
-   [<span data-ttu-id="73a84-122">**DsGetDomainControllerInfo**</span><span class="sxs-lookup"><span data-stu-id="73a84-122">**DsGetDomainControllerInfo**</span></span>](/windows/desktop/api/Ntdsapi/nf-ntdsapi-dsgetdomaincontrollerinfoa)
-   [<span data-ttu-id="73a84-123">**DsGetRdnW**</span><span class="sxs-lookup"><span data-stu-id="73a84-123">**DsGetRdnW**</span></span>](/windows/desktop/api/Dsparse/nf-dsparse-dsgetrdnw)
-   [<span data-ttu-id="73a84-124">**DsGetSpn**</span><span class="sxs-lookup"><span data-stu-id="73a84-124">**DsGetSpn**</span></span>](/windows/desktop/api/Ntdsapi/nf-ntdsapi-dsgetspna)
-   [<span data-ttu-id="73a84-125">**DsInheritSecurityIdentity**</span><span class="sxs-lookup"><span data-stu-id="73a84-125">**DsInheritSecurityIdentity**</span></span>](/windows/desktop/api/Ntdsapi/nf-ntdsapi-dsinheritsecurityidentitya)
-   [<span data-ttu-id="73a84-126">**DsIsMangledDn**</span><span class="sxs-lookup"><span data-stu-id="73a84-126">**DsIsMangledDn**</span></span>](/windows/desktop/api/Dsparse/nf-dsparse-dsismangleddna)
-   [<span data-ttu-id="73a84-127">**DsIsMangledRdnValue**</span><span class="sxs-lookup"><span data-stu-id="73a84-127">**DsIsMangledRdnValue**</span></span>](/windows/desktop/api/Dsparse/nf-dsparse-dsismangledrdnvaluea)
-   [<span data-ttu-id="73a84-128">**DsListDomainsInSite**</span><span class="sxs-lookup"><span data-stu-id="73a84-128">**DsListDomainsInSite**</span></span>](/windows/desktop/api/Ntdsapi/nf-ntdsapi-dslistdomainsinsitea)
-   [<span data-ttu-id="73a84-129">**DsListInfoForServer**</span><span class="sxs-lookup"><span data-stu-id="73a84-129">**DsListInfoForServer**</span></span>](/windows/desktop/api/Ntdsapi/nf-ntdsapi-dslistinfoforservera)
-   [<span data-ttu-id="73a84-130">**DsListRoles**</span><span class="sxs-lookup"><span data-stu-id="73a84-130">**DsListRoles**</span></span>](/windows/desktop/api/Ntdsapi/nf-ntdsapi-dslistrolesa)
-   [<span data-ttu-id="73a84-131">**DsListServersForDomainInSite**</span><span class="sxs-lookup"><span data-stu-id="73a84-131">**DsListServersForDomainInSite**</span></span>](/windows/desktop/api/Ntdsapi/nf-ntdsapi-dslistserversfordomaininsitea)
-   [<span data-ttu-id="73a84-132">**DsListServersInSite**</span><span class="sxs-lookup"><span data-stu-id="73a84-132">**DsListServersInSite**</span></span>](/windows/desktop/api/Ntdsapi/nf-ntdsapi-dslistserversinsitea)
-   [<span data-ttu-id="73a84-133">**DsListSites**</span><span class="sxs-lookup"><span data-stu-id="73a84-133">**DsListSites**</span></span>](/windows/desktop/api/Ntdsapi/nf-ntdsapi-dslistsitesa)
-   [<span data-ttu-id="73a84-134">**DsMakePasswordCredentials**</span><span class="sxs-lookup"><span data-stu-id="73a84-134">**DsMakePasswordCredentials**</span></span>](/windows/desktop/api/Ntdsapi/nf-ntdsapi-dsmakepasswordcredentialsa)
-   [<span data-ttu-id="73a84-135">**DsMakeSpn**</span><span class="sxs-lookup"><span data-stu-id="73a84-135">**DsMakeSpn**</span></span>](/windows/desktop/api/Dsparse/nf-dsparse-dsmakespna)
-   [<span data-ttu-id="73a84-136">**DsMapSchemaGuids**</span><span class="sxs-lookup"><span data-stu-id="73a84-136">**DsMapSchemaGuids**</span></span>](/windows/desktop/api/Ntdsapi/nf-ntdsapi-dsmapschemaguidsa)
-   [<span data-ttu-id="73a84-137">**DsQuerySitesByCost**</span><span class="sxs-lookup"><span data-stu-id="73a84-137">**DsQuerySitesByCost**</span></span>](/windows/desktop/api/Ntdsapi/nf-ntdsapi-dsquerysitesbycosta)
-   [<span data-ttu-id="73a84-138">**DsQuerySitesFree**</span><span class="sxs-lookup"><span data-stu-id="73a84-138">**DsQuerySitesFree**</span></span>](/windows/desktop/api/Ntdsapi/nf-ntdsapi-dsquerysitesfree)
-   [<span data-ttu-id="73a84-139">**DsQuoteRdnValue**</span><span class="sxs-lookup"><span data-stu-id="73a84-139">**DsQuoteRdnValue**</span></span>](/windows/desktop/api/Dsparse/nf-dsparse-dsquoterdnvaluea)
-   [<span data-ttu-id="73a84-140">**DsRemoveDsDomain**</span><span class="sxs-lookup"><span data-stu-id="73a84-140">**DsRemoveDsDomain**</span></span>](/windows/desktop/api/Ntdsapi/nf-ntdsapi-dsremovedsdomaina)
-   [<span data-ttu-id="73a84-141">**DsRemoveDsServer**</span><span class="sxs-lookup"><span data-stu-id="73a84-141">**DsRemoveDsServer**</span></span>](/windows/desktop/api/Ntdsapi/nf-ntdsapi-dsremovedsservera)
-   [<span data-ttu-id="73a84-142">**DsReplicaAdd**</span><span class="sxs-lookup"><span data-stu-id="73a84-142">**DsReplicaAdd**</span></span>](/windows/desktop/api/Ntdsapi/nf-ntdsapi-dsreplicaadda)
-   [<span data-ttu-id="73a84-143">**DsReplicaConsistencyCheck**</span><span class="sxs-lookup"><span data-stu-id="73a84-143">**DsReplicaConsistencyCheck**</span></span>](/windows/desktop/api/Ntdsapi/nf-ntdsapi-dsreplicaconsistencycheck)
-   [<span data-ttu-id="73a84-144">**DsReplicaDel**</span><span class="sxs-lookup"><span data-stu-id="73a84-144">**DsReplicaDel**</span></span>](/windows/desktop/api/Ntdsapi/nf-ntdsapi-dsreplicadela)
-   [<span data-ttu-id="73a84-145">**DsReplicaFreeInfo**</span><span class="sxs-lookup"><span data-stu-id="73a84-145">**DsReplicaFreeInfo**</span></span>](/windows/desktop/api/Ntdsapi/nf-ntdsapi-dsreplicafreeinfo)
-   [<span data-ttu-id="73a84-146">**DsReplicaGetInfo**</span><span class="sxs-lookup"><span data-stu-id="73a84-146">**DsReplicaGetInfo**</span></span>](/windows/desktop/api/Ntdsapi/nf-ntdsapi-dsreplicagetinfow)
-   [<span data-ttu-id="73a84-147">**DsReplicaGetInfo2**</span><span class="sxs-lookup"><span data-stu-id="73a84-147">**DsReplicaGetInfo2**</span></span>](/windows/desktop/api/Ntdsapi/nf-ntdsapi-dsreplicagetinfo2w)
-   [<span data-ttu-id="73a84-148">**DsReplicaModify**</span><span class="sxs-lookup"><span data-stu-id="73a84-148">**DsReplicaModify**</span></span>](/windows/desktop/api/Ntdsapi/nf-ntdsapi-dsreplicamodifya)
-   [<span data-ttu-id="73a84-149">**DsReplicaSync**</span><span class="sxs-lookup"><span data-stu-id="73a84-149">**DsReplicaSync**</span></span>](/windows/desktop/api/Ntdsapi/nf-ntdsapi-dsreplicasynca)
-   [<span data-ttu-id="73a84-150">**DsReplicaSyncAll**</span><span class="sxs-lookup"><span data-stu-id="73a84-150">**DsReplicaSyncAll**</span></span>](/windows/desktop/api/Ntdsapi/nf-ntdsapi-dsreplicasyncalla)
-   [<span data-ttu-id="73a84-151">**DsReplicaUpdateRefs**</span><span class="sxs-lookup"><span data-stu-id="73a84-151">**DsReplicaUpdateRefs**</span></span>](/windows/desktop/api/Ntdsapi/nf-ntdsapi-dsreplicaupdaterefsa)
-   [<span data-ttu-id="73a84-152">**DsReplicaVerifyObjects**</span><span class="sxs-lookup"><span data-stu-id="73a84-152">**DsReplicaVerifyObjects**</span></span>](/windows/desktop/api/Ntdsapi/nf-ntdsapi-dsreplicaverifyobjectsa)
-   [<span data-ttu-id="73a84-153">**DsServerRegisterSpn**</span><span class="sxs-lookup"><span data-stu-id="73a84-153">**DsServerRegisterSpn**</span></span>](/windows/desktop/api/Ntdsapi/nf-ntdsapi-dsserverregisterspna)
-   [<span data-ttu-id="73a84-154">**DsUnBind**</span><span class="sxs-lookup"><span data-stu-id="73a84-154">**DsUnBind**</span></span>](/windows/desktop/api/Ntdsapi/nf-ntdsapi-dsunbinda)
-   [<span data-ttu-id="73a84-155">**DsUnquoteRdnValue**</span><span class="sxs-lookup"><span data-stu-id="73a84-155">**DsUnquoteRdnValue**</span></span>](/windows/desktop/api/Dsparse/nf-dsparse-dsunquoterdnvaluea)
-   [<span data-ttu-id="73a84-156">**DsWriteAccountSpn**</span><span class="sxs-lookup"><span data-stu-id="73a84-156">**DsWriteAccountSpn**</span></span>](/windows/desktop/api/Ntdsapi/nf-ntdsapi-dswriteaccountspna)
-   <span data-ttu-id="73a84-157">[**SyncUpdateProc**](/previous-versions/windows/desktop/legacy/ms677968(v=vs.85))</span><span class="sxs-lookup"><span data-stu-id="73a84-157">[**SyncUpdateProc**](/previous-versions/windows/desktop/legacy/ms677968(v=vs.85))</span></span>

<span data-ttu-id="73a84-158">這些函數大多需要系結至目錄服務的控制碼。</span><span class="sxs-lookup"><span data-stu-id="73a84-158">Most of these functions require a handle bound to the directory service.</span></span> <span data-ttu-id="73a84-159">[**DsBind**](/windows/desktop/api/Ntdsapi/nf-ntdsapi-dsbinda)和 [**DsBindWithCred**](/windows/desktop/api/Ntdsapi/nf-ntdsapi-dsbindwithcreda)函式會啟動具有特定網域控制站的 RPC 會話，然後將控制碼系結至目錄服務，並傳回控制碼。</span><span class="sxs-lookup"><span data-stu-id="73a84-159">The [**DsBind**](/windows/desktop/api/Ntdsapi/nf-ntdsapi-dsbinda) and [**DsBindWithCred**](/windows/desktop/api/Ntdsapi/nf-ntdsapi-dsbindwithcreda) functions start an RPC session with a particular domain controller, then they bind a handle to the directory service and return the handle.</span></span> <span data-ttu-id="73a84-160">當不再需要控制碼時，請使用 [**DsUnBind**](/windows/desktop/api/Ntdsapi/nf-ntdsapi-dsunbinda) 函式來結束 RPC 會話，並解除控制碼的系結。</span><span class="sxs-lookup"><span data-stu-id="73a84-160">When the handle is no longer required, use the [**DsUnBind**](/windows/desktop/api/Ntdsapi/nf-ntdsapi-dsunbinda) function to end the RPC session and unbind the handle.</span></span>

<span data-ttu-id="73a84-161">在來源伺服器與目的地伺服器之間進行複寫。</span><span class="sxs-lookup"><span data-stu-id="73a84-161">Replication occurs between a source server and a destination server.</span></span> <span data-ttu-id="73a84-162">來源伺服器會維護應該複寫的目的地伺服器清單，而目的地伺服器會維護從中接收復寫的來源伺服器清單。</span><span class="sxs-lookup"><span data-stu-id="73a84-162">A source server maintains a list of destination servers to which it should replicate, and a destination server maintains a list of source servers from which it receives replication.</span></span> <span data-ttu-id="73a84-163">您可以使用 [**DsReplicaAdd**](/windows/desktop/api/Ntdsapi/nf-ntdsapi-dsreplicaadda) 函式，將目的地伺服器上的來源伺服器清單新增到目的地伺服器上的來源伺服器清單中，並使用 [**DsReplicaDel**](/windows/desktop/api/Ntdsapi/nf-ntdsapi-dsreplicadela) 函數來移除目的地伺服器上來源伺服器清單的參考。</span><span class="sxs-lookup"><span data-stu-id="73a84-163">Use the [**DsReplicaAdd**](/windows/desktop/api/Ntdsapi/nf-ntdsapi-dsreplicaadda) function to add to the list of source servers on a destination server, and use the [**DsReplicaDel**](/windows/desktop/api/Ntdsapi/nf-ntdsapi-dsreplicadela) function to remove references from the source server list on a destination server.</span></span> <span data-ttu-id="73a84-164">[**DsReplicaModify**](/windows/desktop/api/Ntdsapi/nf-ntdsapi-dsreplicamodifya)函數可以用來變更目的地伺服器上的現有來源伺服器參考。</span><span class="sxs-lookup"><span data-stu-id="73a84-164">The [**DsReplicaModify**](/windows/desktop/api/Ntdsapi/nf-ntdsapi-dsreplicamodifya) function may be used to change an existing source server reference on a destination server.</span></span> <span data-ttu-id="73a84-165">若要變更來源伺服器上的目的地伺服器清單，請使用 [**DsReplicaUpdateRefs**](/windows/desktop/api/Ntdsapi/nf-ntdsapi-dsreplicaupdaterefsa) 函數。</span><span class="sxs-lookup"><span data-stu-id="73a84-165">To change the list of destination servers on a source server, use the [**DsReplicaUpdateRefs**](/windows/desktop/api/Ntdsapi/nf-ntdsapi-dsreplicaupdaterefsa) function.</span></span>

<span data-ttu-id="73a84-166">實際的複寫是由 [**DsReplicaSync**](/windows/desktop/api/Ntdsapi/nf-ntdsapi-dsreplicasynca) 和 [**DsReplicaSyncAll**](/windows/desktop/api/Ntdsapi/nf-ntdsapi-dsreplicasyncalla) 函數所執行。</span><span class="sxs-lookup"><span data-stu-id="73a84-166">Actual replication is performed by the [**DsReplicaSync**](/windows/desktop/api/Ntdsapi/nf-ntdsapi-dsreplicasynca) and [**DsReplicaSyncAll**](/windows/desktop/api/Ntdsapi/nf-ntdsapi-dsreplicasyncalla) functions.</span></span> <span data-ttu-id="73a84-167">**DsReplicaSync** 函式會將特定目的地伺服器與單一來源伺服器同步。</span><span class="sxs-lookup"><span data-stu-id="73a84-167">The **DsReplicaSync** function synchronizes a specific destination server with a single source server.</span></span> <span data-ttu-id="73a84-168">使用 **DsReplicaSyncAll** 函式，將目的地伺服器與網站中的所有其他伺服器同步。</span><span class="sxs-lookup"><span data-stu-id="73a84-168">Use the **DsReplicaSyncAll** function to synchronize a destination server with all other servers in the site.</span></span>

 

 