---
title: 設定物件的存取權限
description: 本主題說明如何建立存取權的 ACE，並在物件的 DACL 上設定該 ACE。
ms.assetid: c0b45709-4652-46c7-8d52-44076802d109
ms.tgt_platform: multiple
keywords:
- 設定物件 AD 的存取權限
- 物件 AD，設定物件的存取權限
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 2bcf54de381dab2af1dab4ea44654fb0a5682f06
ms.sourcegitcommit: 803f3ccd65bdefe36bd851b9c6e7280be9489016
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/17/2020
ms.locfileid: "104462820"
---
# <a name="setting-access-rights-on-an-object"></a><span data-ttu-id="42f40-105">設定物件的存取權限</span><span class="sxs-lookup"><span data-stu-id="42f40-105">Setting Access Rights on an Object</span></span>

<span data-ttu-id="42f40-106">當使用 ADSI COM 物件 [**IADsSecurityDescriptor**](/windows/desktop/api/iads/nn-iads-iadssecuritydescriptor) (安全描述項) 、 [**IADsAccessControlList**](/windows/desktop/api/iads/nn-iads-iadsaccesscontrollist) (dacl 和 Sacl) ，以及 [**IADSACCESSCONTROLENTRY**](/windows/desktop/api/iads/nn-iads-iadsaccesscontrolentry) (ACE) 將 ace 新增至 ACL 時，您要對屬性快取中指定物件的 **nTSecurityDescriptor** 屬性進行變更。</span><span class="sxs-lookup"><span data-stu-id="42f40-106">When using the ADSI COM objects [**IADsSecurityDescriptor**](/windows/desktop/api/iads/nn-iads-iadssecuritydescriptor) (security descriptor), [**IADsAccessControlList**](/windows/desktop/api/iads/nn-iads-iadsaccesscontrollist) (DACLs and SACLs), and [**IADsAccessControlEntry**](/windows/desktop/api/iads/nn-iads-iadsaccesscontrolentry) (ACE) to add an ACE to a ACL, you are making changes to the **nTSecurityDescriptor** property of the specified object in the property cache.</span></span> <span data-ttu-id="42f40-107">這表示將方法放在包含新 ACE 的物件上，而且必須呼叫 [**IADs SetInfo**](/windows/desktop/api/iads/nf-iads-iads-setinfo) 方法，以便將更新的安全描述項寫入至屬性快取中的目錄。</span><span class="sxs-lookup"><span data-stu-id="42f40-107">This means put methods on the objects that contain the new ACE and the [**IADs.SetInfo**](/windows/desktop/api/iads/nf-iads-iads-setinfo) method must be called in order to write the updated security descriptor to the directory from the property cache.</span></span>

<span data-ttu-id="42f40-108">如需在 Active Directory Domain Services 中為物件設定 ACE 的詳細資訊和程式碼範例，請參閱在 [目錄物件上設定 ace 的範例程式碼](example-code-for-setting-an-ace-on-a-directory-object.md)。</span><span class="sxs-lookup"><span data-stu-id="42f40-108">For more information and a code example that sets an ACE on an object in Active Directory Domain Services, see [Example Code for Setting an ACE on a Directory Object](example-code-for-setting-an-ace-on-a-directory-object.md).</span></span>

<span data-ttu-id="42f40-109">使用下列一般程式來建立存取權限的 ACE，並在物件的 DACL 上設定該 ACE。</span><span class="sxs-lookup"><span data-stu-id="42f40-109">Use the following general process to create an ACE for an access right and setting that ACE on the DACL of an object.</span></span>

1.  <span data-ttu-id="42f40-110">取得物件的 [**IADs**](/windows/desktop/api/iads/nn-iads-iads) 介面指標。</span><span class="sxs-lookup"><span data-stu-id="42f40-110">Get an [**IADs**](/windows/desktop/api/iads/nn-iads-iads) interface pointer to the object.</span></span>
2.  <span data-ttu-id="42f40-111">使用 [**IADs**](/windows/desktop/api/iads/nf-iads-iads-get) 取得物件的安全描述項。</span><span class="sxs-lookup"><span data-stu-id="42f40-111">Use the [**IADs.Get**](/windows/desktop/api/iads/nf-iads-iads-get) method to get the security descriptor of the object.</span></span> <span data-ttu-id="42f40-112">包含安全描述項的屬性名稱是 **nTSecurityDescriptor**。</span><span class="sxs-lookup"><span data-stu-id="42f40-112">The name of the property containing the security descriptor is **nTSecurityDescriptor**.</span></span> <span data-ttu-id="42f40-113">屬性將會以包含 [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch)指標的 [**VARIANT**](/windows/win32/api/oaidl/ns-oaidl-variant)傳回， (**vt** 成員是 **vt \_ 分派**) 。</span><span class="sxs-lookup"><span data-stu-id="42f40-113">The property will be returned as a [**VARIANT**](/windows/win32/api/oaidl/ns-oaidl-variant) containing an [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) pointer (the **vt** member is **VT\_DISPATCH**).</span></span> <span data-ttu-id="42f40-114">在該 **IDispatch** 指標上呼叫 **QueryInterface** 來取得 [**IADsSecurityDescriptor**](/windows/desktop/api/iads/nn-iads-iadssecuritydescriptor)介面，以便使用該介面上的方法來存取安全描述項的 ACL。</span><span class="sxs-lookup"><span data-stu-id="42f40-114">Call **QueryInterface** on that **IDispatch** pointer to get an [**IADsSecurityDescriptor**](/windows/desktop/api/iads/nn-iads-iadssecuritydescriptor) interface to use the methods on that interface to access the security descriptor's ACL.</span></span>
3.  <span data-ttu-id="42f40-115">使用 [**IADsSecurityDescriptor. objdescriptor.discretionaryacl**](/windows/desktop/ADSI/iadssecuritydescriptor-property-methods) 屬性來取得 DACL。</span><span class="sxs-lookup"><span data-stu-id="42f40-115">Use the [**IADsSecurityDescriptor.DiscretionaryAcl**](/windows/desktop/ADSI/iadssecuritydescriptor-property-methods) property to get the DACL.</span></span> <span data-ttu-id="42f40-116">方法會傳回 [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) 指標。</span><span class="sxs-lookup"><span data-stu-id="42f40-116">The method returns an [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) pointer.</span></span> <span data-ttu-id="42f40-117">在該 **IDispatch** 指標上呼叫 **QueryInterface** 來取得 [**IADsAccessControlList**](/windows/desktop/api/iads/nn-iads-iadsaccesscontrollist)介面，以便使用該介面上的方法來存取 ACL 中的個別 ace。</span><span class="sxs-lookup"><span data-stu-id="42f40-117">Call **QueryInterface** on that **IDispatch** pointer to get an [**IADsAccessControlList**](/windows/desktop/api/iads/nn-iads-iadsaccesscontrollist) interface to use the methods on that interface to access the individual ACEs in the ACL.</span></span>
4.  <span data-ttu-id="42f40-118">使用 [**CoCreateInstance**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance) 來建立新 ACE 的 ADSI COM 物件，並取得該物件的 [**IADsAccessControlEntry**](/windows/desktop/api/iads/nn-iads-iadsaccesscontrolentry) 介面指標。</span><span class="sxs-lookup"><span data-stu-id="42f40-118">Use [**CoCreateInstance**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance) to create the ADSI COM object for the new ACE and get an [**IADsAccessControlEntry**](/windows/desktop/api/iads/nn-iads-iadsaccesscontrolentry) interface pointer to that object.</span></span> <span data-ttu-id="42f40-119">請注意，類別識別碼是 CLSID \_ AccessControlEntry。</span><span class="sxs-lookup"><span data-stu-id="42f40-119">Be aware that the class ID is CLSID\_AccessControlEntry.</span></span>
5.  <span data-ttu-id="42f40-120">使用 [**IADsAccessControlEntry**](/windows/desktop/api/iads/nn-iads-iadsaccesscontrolentry) 方法來設定 ACE 的屬性：</span><span class="sxs-lookup"><span data-stu-id="42f40-120">Set the properties of the ACE using the [**IADsAccessControlEntry**](/windows/desktop/api/iads/nn-iads-iadsaccesscontrolentry) methods:</span></span>

    1.  <span data-ttu-id="42f40-121">使用 [**IADsAccessControlEntry：:p 的 ui \_ 信任者**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) ，設定要套用此 ACE 的信任者。</span><span class="sxs-lookup"><span data-stu-id="42f40-121">Use [**IADsAccessControlEntry::put\_Trustee**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) to set the trustee to whom this ACE applies.</span></span> <span data-ttu-id="42f40-122">信任者是使用者、群組或其他安全性主體。</span><span class="sxs-lookup"><span data-stu-id="42f40-122">The trustee is a user, group, or other security principal.</span></span> <span data-ttu-id="42f40-123">您的應用程式應該使用您想要套用 ACE 之信任者的使用者或群組物件中的適當屬性值。</span><span class="sxs-lookup"><span data-stu-id="42f40-123">Your application should use the value from the appropriate property from the user or group object of the trustee to which you want to apply the ACE.</span></span> <span data-ttu-id="42f40-124">信任者指定為 **BSTR** ，並且可以採用下列形式：</span><span class="sxs-lookup"><span data-stu-id="42f40-124">The trustee is specified as a **BSTR** and can take the following forms:</span></span>
        -   <span data-ttu-id="42f40-125">網域帳戶 (舊版 Windows NT) 的登入名稱，格式為 " <domain> \\ <user account> "，其中 " &lt; domain &gt; " 是包含使用者之 Windows NT 網域的名稱，而 " &lt; user account &gt; " 是指定使用者的 **sAMAccountName** 屬性。</span><span class="sxs-lookup"><span data-stu-id="42f40-125">Domain account (the logon name used in a previous version of Windows NT) of the form "<domain>\\<user account>" where "&lt;domain&gt;" is the name of the Windows NT domain that contains the user and "&lt;user account&gt;" is the **sAMAccountName** property of the specified user.</span></span> <span data-ttu-id="42f40-126">例如： "fabrikam \\ jeffsmith"。</span><span class="sxs-lookup"><span data-stu-id="42f40-126">For example: "fabrikam\\jeffsmith".</span></span>
        -   <span data-ttu-id="42f40-127">知名的安全性主體，代表 Windows NT 安全性系統所定義的特殊身分識別，例如 everyone、local system、principal self、已驗證的使用者、creator owner 等等。</span><span class="sxs-lookup"><span data-stu-id="42f40-127">Well-known security principal that represents special identities defined by the Windows NT security system, such as everyone, local system, principal self, authenticated user, creator owner, and so on.</span></span> <span data-ttu-id="42f40-128">代表知名安全性主體的物件會儲存在「設定」容器底下的知名安全性主體容器中。</span><span class="sxs-lookup"><span data-stu-id="42f40-128">The objects representing the well-known security principals are stored in the Well Known Security Principals container beneath the Configuration container.</span></span> <span data-ttu-id="42f40-129">例如，匿名登入。</span><span class="sxs-lookup"><span data-stu-id="42f40-129">For example, anonymous logon.</span></span>
        -   <span data-ttu-id="42f40-130">內建組，代表 Windows NT 安全性系統所定義的內建使用者群組。</span><span class="sxs-lookup"><span data-stu-id="42f40-130">Built-in group that represent the built-in user groups defined by the Windows NT security system.</span></span> <span data-ttu-id="42f40-131">它的形式是「內建」， \\ <group name> 其中「 &lt; 組名」 &gt; 是內建使用者群組的名稱。</span><span class="sxs-lookup"><span data-stu-id="42f40-131">It has the form "BUILTIN\\<group name>" where "&lt;group name&gt;" is the name of the built-in user group.</span></span> <span data-ttu-id="42f40-132">代表內建組的物件會儲存在網域容器底下的內建容器中。</span><span class="sxs-lookup"><span data-stu-id="42f40-132">The objects representing the built-in groups are stored in the Builtin container beneath the domain container.</span></span> <span data-ttu-id="42f40-133">例如，「內建系統 \\ 管理員」。</span><span class="sxs-lookup"><span data-stu-id="42f40-133">For example, "BUILTIN\\Administrators".</span></span>
        -   <span data-ttu-id="42f40-134">SID (字串格式) 指定的使用者，也就是指定使用者的 **objectSID** 屬性。</span><span class="sxs-lookup"><span data-stu-id="42f40-134">SID (string format) of the specified user, which is the **objectSID** property of the specified user.</span></span> <span data-ttu-id="42f40-135">您可以使用 Win32 安全性 API 中的 [**ConvertSidToStringSid**](/windows/desktop/api/sddl/nf-sddl-convertsidtostringsida) 函式，將轉換成字串形式。</span><span class="sxs-lookup"><span data-stu-id="42f40-135">You can convert to string form using the [**ConvertSidToStringSid**](/windows/desktop/api/sddl/nf-sddl-convertsidtostringsida) function in the Win32 Security API.</span></span> <span data-ttu-id="42f40-136">例如： "S-1-5-32-548"。</span><span class="sxs-lookup"><span data-stu-id="42f40-136">For example: "S-1-5-32-548".</span></span>
    2.  <span data-ttu-id="42f40-137">使用 [**IADsAccessControlEntry. AccessMask**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) 屬性來設定指定存取權限的遮罩。</span><span class="sxs-lookup"><span data-stu-id="42f40-137">Use the [**IADsAccessControlEntry.AccessMask**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) property to set the mask that specifies the access right.</span></span> <span data-ttu-id="42f40-138">[**ADS \_ 許可權 \_ 列舉**](/windows/win32/api/iads/ne-iads-ads_rights_enum)列舉會指定您可以在目錄物件上設定的存取權限。</span><span class="sxs-lookup"><span data-stu-id="42f40-138">The [**ADS\_RIGHTS\_ENUM**](/windows/win32/api/iads/ne-iads-ads_rights_enum) enumeration specifies the access rights you can set on a directory object.</span></span>
    3.  <span data-ttu-id="42f40-139">您可以使用 [**IADsAccessControlEntry AceType**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) 屬性來指定是要允許還是拒絕 **AccessMask** 所設定的存取權限。</span><span class="sxs-lookup"><span data-stu-id="42f40-139">Use the [**IADsAccessControlEntry.AceType**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) property to specify whether to allow or deny the access rights set by **AccessMask**.</span></span> <span data-ttu-id="42f40-140">針對標準許可權，這可以是 **廣告 \_ ACETYPE \_ 存取 \_ 允許** 的 **或 \_ ads \_ ACETYPE \_ 拒絕存取**。</span><span class="sxs-lookup"><span data-stu-id="42f40-140">For standard rights, this can be **ADS\_ACETYPE\_ACCESS\_ALLOWED** or **ADS\_ACETYPE\_ACCESS\_DENIED**.</span></span> <span data-ttu-id="42f40-141">針對特定物件使用權限 (套用至特定物件部分或特定物件類型) 的許可權，請使用 **ADS \_ ACETYPE \_ 存取 \_ 允許的 \_ 物件** 或 **ADS \_ ACETYPE \_ \_ 拒絕存取 \_ 物件**。</span><span class="sxs-lookup"><span data-stu-id="42f40-141">For object-specific rights (rights that apply to a specific part of an object or to a specific type of object), use **ADS\_ACETYPE\_ACCESS\_ALLOWED\_OBJECT** or **ADS\_ACETYPE\_ACCESS\_DENIED\_OBJECT**.</span></span> <span data-ttu-id="42f40-142">[**ADS \_ ACETYPE \_ ENUM**](/windows/win32/api/iads/ne-iads-ads_acetype_enum)列舉會指定您可以在 ACE 上設定的存取類型。</span><span class="sxs-lookup"><span data-stu-id="42f40-142">The [**ADS\_ACETYPE\_ENUM**](/windows/win32/api/iads/ne-iads-ads_acetype_enum) enumeration specifies the access types you can set on an ACE.</span></span>
    4.  <span data-ttu-id="42f40-143">使用 [**IADsAccessControlEntry. AceFlags**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) 屬性來指定指定物件下的其他容器或物件是否可以繼承 ACE。</span><span class="sxs-lookup"><span data-stu-id="42f40-143">Use the [**IADsAccessControlEntry.AceFlags**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) property to specify whether other containers or objects beneath the specified object can inherit the ACE.</span></span> <span data-ttu-id="42f40-144">[**ADS \_ ACEFLAG \_ ENUM**](/windows/win32/api/iads/ne-iads-ads_aceflag_enum)列舉會指定您可以在 ACE 上設定的繼承旗標。</span><span class="sxs-lookup"><span data-stu-id="42f40-144">The [**ADS\_ACEFLAG\_ENUM**](/windows/win32/api/iads/ne-iads-ads_aceflag_enum) enumeration specifies the inheritance flags you can set on an ACE.</span></span>
    5.  <span data-ttu-id="42f40-145">您可以使用 [ [**IADsAccessControlEntry**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) ] 屬性來指定是否要將許可權套用至物件的特定部分、繼承的物件類型，或兩者。</span><span class="sxs-lookup"><span data-stu-id="42f40-145">Use the [**IADsAccessControlEntry.Flags**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) property to specify whether the right applies to a specific part of the object, an inherited object type, or both.</span></span>
    6.  <span data-ttu-id="42f40-146">如果 [ **旗標** ] 設定為 [ **ads \_ 旗標 \_ 物件 \_ 類型 \_**]，請將 [ [**IADsAccessControlEntry**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) ] 屬性設為 [指定包含物件 (類別的 GUID 的字串]，以讓 **ads \_ right \_ ds \_ 建立 \_ 子** 系或 **ADS \_ right \_ ds \_ 刪除 \_ 子**) 、屬性、屬性集、驗證的寫入或套用 ACE 的擴充許可權。</span><span class="sxs-lookup"><span data-stu-id="42f40-146">If **Flags** is set to **ADS\_FLAG\_OBJECT\_TYPE\_PRESENT**, set the [**IADsAccessControlEntry.ObjectType**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) property o specify a string containing the GUID of the object class (for **ADS\_RIGHT\_DS\_CREATE\_CHILD** or **ADS\_RIGHT\_DS\_DELETE\_CHILD**), property, property set, validated write, or extended right that the ACE applies to.</span></span> <span data-ttu-id="42f40-147">GUID 必須指定為 COM 程式庫中 [**StringFromGUID2**](/windows/win32/api/combaseapi/nf-combaseapi-stringfromguid2) 函式所產生的格式字串。</span><span class="sxs-lookup"><span data-stu-id="42f40-147">The GUID must be specified as a string of the form produced by the [**StringFromGUID2**](/windows/win32/api/combaseapi/nf-combaseapi-stringfromguid2) function in the COM library.</span></span>
    7.  <span data-ttu-id="42f40-148">如果 [ **旗標** ] 設定為 [ **ADS \_ 旗標繼承的 \_ \_ 物件 \_ 類型 \_ 存在**]，請設定 [**IADsAccessControlEntry InheritedObjectType**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) 屬性，以指定包含套用 ACE 之繼承物件類別之 GUID 的字串。</span><span class="sxs-lookup"><span data-stu-id="42f40-148">If **Flags** is set to **ADS\_FLAG\_INHERITED\_OBJECT\_TYPE\_PRESENT**, set the [**IADsAccessControlEntry.InheritedObjectType**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) property to specify a string that contains the GUID of the inherited object class that the ACE applies to.</span></span> <span data-ttu-id="42f40-149">GUID 必須指定為 COM 程式庫中 [**StringFromGUID2**](/windows/win32/api/combaseapi/nf-combaseapi-stringfromguid2) 函式所產生的格式字串。</span><span class="sxs-lookup"><span data-stu-id="42f40-149">The GUID must be specified as a string of the form produced by the [**StringFromGUID2**](/windows/win32/api/combaseapi/nf-combaseapi-stringfromguid2) function in the COM library.</span></span>

6.  <span data-ttu-id="42f40-150">在 [**IADsAccessControlEntry**](/windows/desktop/api/iads/nn-iads-iadsaccesscontrolentry)物件上使用 **QueryInterface** 方法來取得 [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch)指標。</span><span class="sxs-lookup"><span data-stu-id="42f40-150">Use the **QueryInterface** method on the [**IADsAccessControlEntry**](/windows/desktop/api/iads/nn-iads-iadsaccesscontrolentry) object to get an [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) pointer.</span></span> <span data-ttu-id="42f40-151">[**IADsAccessControlList. AddAce**](/windows/desktop/api/iads/nf-iads-iadsaccesscontrollist-addace)方法需要對 ACE 的 **IDispatch** 介面指標。</span><span class="sxs-lookup"><span data-stu-id="42f40-151">The [**IADsAccessControlList.AddAce**](/windows/desktop/api/iads/nf-iads-iadsaccesscontrollist-addace) method requires an **IDispatch** interface pointer to the ACE.</span></span>
7.  <span data-ttu-id="42f40-152">使用 [**IADsAccessControlList. AddAce**](/windows/desktop/api/iads/nf-iads-iadsaccesscontrollist-addace) 將新的 ACE 新增至 DACL。</span><span class="sxs-lookup"><span data-stu-id="42f40-152">Use [**IADsAccessControlList.AddAce**](/windows/desktop/api/iads/nf-iads-iadsaccesscontrollist-addace) to add the new ACE to the DACL.</span></span> <span data-ttu-id="42f40-153">請注意，在 ACL 中的 Ace 順序可能會影響對物件的存取評估。</span><span class="sxs-lookup"><span data-stu-id="42f40-153">Be aware that the order of the ACEs within the ACL can affect the evaluation of access to the object.</span></span> <span data-ttu-id="42f40-154">對物件的正確存取權可能會要求您建立新的 ACL、從現有 ACL 將 Ace 以正確的順序新增至新的 ACL，然後將安全描述項中的現有 ACL 取代為新的 ACL。</span><span class="sxs-lookup"><span data-stu-id="42f40-154">The correct access to the object may require you to create an new ACL, add the ACEs from the existing ACL in the correct order to the new ACL, and then replace the existing ACL in the security descriptor with the new ACL.</span></span> <span data-ttu-id="42f40-155">如需詳細資訊，請參閱 [DACL 中的 Ace 順序](/windows/desktop/SecAuthZ/order-of-aces-in-a-dacl)。</span><span class="sxs-lookup"><span data-stu-id="42f40-155">For more information, see [Order of ACEs in a DACL](/windows/desktop/SecAuthZ/order-of-aces-in-a-dacl).</span></span>
8.  <span data-ttu-id="42f40-156">使用 [**IADsSecurityDescriptor. objdescriptor.discretionaryacl**](/windows/desktop/ADSI/iadssecuritydescriptor-property-methods) 屬性，將包含新 ACE 的 DACL 寫入安全描述項。</span><span class="sxs-lookup"><span data-stu-id="42f40-156">Use the [**IADsSecurityDescriptor.DiscretionaryAcl**](/windows/desktop/ADSI/iadssecuritydescriptor-property-methods) property to write the DACL containing the new ACE to the security descriptor.</span></span> <span data-ttu-id="42f40-157">如需 Dacl 的詳細資訊，請參閱 [Null dacl 和空白的 dacl](null-dacls-and-empty-dacls.md)。</span><span class="sxs-lookup"><span data-stu-id="42f40-157">For more information about DACLs, see [Null DACLs and Empty DACLs](null-dacls-and-empty-dacls.md).</span></span>
9.  <span data-ttu-id="42f40-158">使用 [**IADs**](/windows/desktop/api/iads/nf-iads-iads-put) 方法，將安全描述項寫入物件的 **nTSecurityDescriptor** 屬性至屬性快取。</span><span class="sxs-lookup"><span data-stu-id="42f40-158">Use the [**IADs.Put**](/windows/desktop/api/iads/nf-iads-iads-put) method to write the security descriptor to the object's **nTSecurityDescriptor** property to the property cache.</span></span>
10. <span data-ttu-id="42f40-159">使用 [**IADs. SetInfo**](/windows/desktop/api/iads/nf-iads-iads-setinfo) 方法來更新目錄中物件的屬性。</span><span class="sxs-lookup"><span data-stu-id="42f40-159">Use the [**IADs.SetInfo**](/windows/desktop/api/iads/nf-iads-iads-setinfo) method to update the property on the object in the directory.</span></span>

 

 