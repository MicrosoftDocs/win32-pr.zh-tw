---
title: 系結至架構的指導方針
description: 有兩種方式可系結至 Active Directory 架構系結直接系結至架構容器，或系結至架構容器中的 classSchema 或 attributeSchema 物件。
ms.assetid: 8c10415e-136c-476c-993c-b6dc459b5bf4
ms.tgt_platform: multiple
keywords:
- 系結至架構 AD 的指導方針
- 架構 AD，系結至
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 65bf246a4ea1ded5c7d80c52abb8ac9192182b3b
ms.sourcegitcommit: 803f3ccd65bdefe36bd851b9c6e7280be9489016
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/17/2020
ms.locfileid: "103842075"
---
# <a name="guidelines-for-binding-to-the-schema"></a><span data-ttu-id="93a64-105">系結至架構的指導方針</span><span class="sxs-lookup"><span data-stu-id="93a64-105">Guidelines for Binding to the Schema</span></span>

<span data-ttu-id="93a64-106">有兩種方式可以系結至 Active Directory 架構：</span><span class="sxs-lookup"><span data-stu-id="93a64-106">There are two ways to bind to the Active Directory schema:</span></span>

-   <span data-ttu-id="93a64-107">直接系結至架構容器，或系結至架構容器中的 **classSchema** 或 **attributeSchema** 物件。</span><span class="sxs-lookup"><span data-stu-id="93a64-107">Bind directly to the schema container or to a **classSchema** or **attributeSchema** object in the schema container.</span></span> <span data-ttu-id="93a64-108">**ClassSchema** 或 **attributeSchema** 物件包含可存在於 Active Directory 網域樹系中的每個類別和屬性的完整正式定義。</span><span class="sxs-lookup"><span data-stu-id="93a64-108">The **classSchema** or **attributeSchema** objects contain complete, formal definitions of every class and attribute that can exist in an Active Directory Domain forest.</span></span> <span data-ttu-id="93a64-109">如需詳細資訊，請參閱 [讀取 attributeSchema 和 ClassSchema 物件](reading-attributeschema-and-classschema-objects.md)。</span><span class="sxs-lookup"><span data-stu-id="93a64-109">For more information, see [Reading attributeSchema and classSchema Objects](reading-attributeschema-and-classschema-objects.md).</span></span>
-   <span data-ttu-id="93a64-110">系結至抽象架構或抽象架構中的類別或屬性專案。</span><span class="sxs-lookup"><span data-stu-id="93a64-110">Bind to the abstract schema or to a class or attribute entry in the abstract schema.</span></span> <span data-ttu-id="93a64-111">抽象架構只包含每個類別和屬性的資料子集，但是資料的格式很容易取得和使用。</span><span class="sxs-lookup"><span data-stu-id="93a64-111">The abstract schema contains only a subset of the data about each class and attribute, but the data is in a format that is easy to retrieve and use.</span></span> <span data-ttu-id="93a64-112">如需詳細資訊，請參閱 [抽象架構](the-abstract-schema.md) 和 [讀取抽象架構](reading-the-abstract-schema.md)。</span><span class="sxs-lookup"><span data-stu-id="93a64-112">For more information, see [The Abstract Schema](the-abstract-schema.md) and [Reading the Abstract Schema](reading-the-abstract-schema.md).</span></span>

<span data-ttu-id="93a64-113">若要修改或延伸架構，請直接系結至架構容器。</span><span class="sxs-lookup"><span data-stu-id="93a64-113">To modify or extend the schema, bind directly to the schema container.</span></span> <span data-ttu-id="93a64-114">若要讀取類別和屬性定義，通常可以更輕鬆地從抽象架構中讀取。</span><span class="sxs-lookup"><span data-stu-id="93a64-114">To read the class and attribute definitions, it is usually easier to read from the abstract schema.</span></span>

<span data-ttu-id="93a64-115">基於下列原因，您可以更輕鬆地讀取抽象架構：</span><span class="sxs-lookup"><span data-stu-id="93a64-115">It is easier to read from the abstract schema for the following reasons:</span></span>

-   <span data-ttu-id="93a64-116">ADSI 提供特殊的系結技巧，以及一組可讀取抽象架構的介面。</span><span class="sxs-lookup"><span data-stu-id="93a64-116">ADSI provides special binding techniques and a set of interfaces to read the abstract schema.</span></span>
-   <span data-ttu-id="93a64-117">使用抽象架構的 ADSI 介面會傳回適當格式的資料，以供其他 ADSI 介面使用。</span><span class="sxs-lookup"><span data-stu-id="93a64-117">The ADSI interfaces that work with the abstract schema return data in a format appropriate for use in other ADSI interfaces.</span></span> <span data-ttu-id="93a64-118">例如， [**得到 iadsclass**](/windows/desktop/api/iads/nn-iads-iadsclass) 和 [**IADsProperty**](/windows/desktop/api/iads/nn-iads-iadsproperty) 通常會使用 **lDAPDisplayName** 字串來報告屬性和類別名稱，即使這項資料是以物件識別碼形式儲存在目錄中， (oid) 也是一樣。</span><span class="sxs-lookup"><span data-stu-id="93a64-118">For example, [**IADsClass**](/windows/desktop/api/iads/nn-iads-iadsclass) and [**IADsProperty**](/windows/desktop/api/iads/nn-iads-iadsproperty) typically use **lDAPDisplayName** strings to report attribute and class names, even though this data is stored in the directory in the form of object identifiers (OIDs).</span></span> <span data-ttu-id="93a64-119">**LDAPDisplayName** 格式很方便，因為其他 ADSI 介面會使用它來參考搜尋篩選和其他位置中的類別和屬性。</span><span class="sxs-lookup"><span data-stu-id="93a64-119">The **lDAPDisplayName** format is convenient because other ADSI interfaces use it to refer to classes and attributes in search filters and elsewhere.</span></span>
-   <span data-ttu-id="93a64-120">物件類別的抽象架構專案包含從多個 **classSchema** 物件收集而來的資料。</span><span class="sxs-lookup"><span data-stu-id="93a64-120">The abstract schema entry for an object class contains data collected from multiple **classSchema** objects.</span></span> <span data-ttu-id="93a64-121">例如，物件類別的可能父系、強制屬性和選擇性屬性，是這些屬性與類別的超類和輔助類別的聯集。</span><span class="sxs-lookup"><span data-stu-id="93a64-121">For example, the possible parents, mandatory attributes, and optional attributes for an object class are the union of these attributes from the class's superclasses and auxiliary classes.</span></span> <span data-ttu-id="93a64-122">如果您從實際的架構容器讀取，則需要從衍生類別的各種 **classSchema** 物件中收集資料。</span><span class="sxs-lookup"><span data-stu-id="93a64-122">If you read from the actual schema container, you need to collect data from the various **classSchema** objects that the class was derived from.</span></span> <span data-ttu-id="93a64-123">如果您是從抽象架構讀取，資料就會在同一個位置。</span><span class="sxs-lookup"><span data-stu-id="93a64-123">If you read from the abstract schema, the data is in one place.</span></span>

<span data-ttu-id="93a64-124">在下列情況下，您應該直接系結至架構容器，而不是使用抽象架構：</span><span class="sxs-lookup"><span data-stu-id="93a64-124">You should bind directly to the schema container rather than using the abstract schema in the following cases:</span></span>

-   <span data-ttu-id="93a64-125">取得未在抽象架構中公開的特定屬性。</span><span class="sxs-lookup"><span data-stu-id="93a64-125">To get specific attributes not exposed in the abstract schema.</span></span> <span data-ttu-id="93a64-126">例如， **oMSyntax**、 **attributeSchema**、 **defaultSecurityDescriptor** 和其他屬性不會在抽象架構中公開。</span><span class="sxs-lookup"><span data-stu-id="93a64-126">For example, **oMSyntax**, **attributeSchema**, **defaultSecurityDescriptor**, and other attributes are not exposed in the abstract schema.</span></span>
-   <span data-ttu-id="93a64-127">查詢 **attributeSchema** 和 **classSchema** 物件。</span><span class="sxs-lookup"><span data-stu-id="93a64-127">To query for **attributeSchema** and **classSchema** objects.</span></span> <span data-ttu-id="93a64-128">若要搜尋符合指定之篩選準則的類別或屬性，請系結至架構容器並執行一層級的搜尋。</span><span class="sxs-lookup"><span data-stu-id="93a64-128">To search for classes or attributes that match a specified filter, bind to the schema container and perform a one-level search.</span></span>
-   <span data-ttu-id="93a64-129">加入或修改屬性或類別。</span><span class="sxs-lookup"><span data-stu-id="93a64-129">To add or modify attributes or classes.</span></span> <span data-ttu-id="93a64-130">抽象架構是唯讀的;您無法使用它來修改或擴充架構。</span><span class="sxs-lookup"><span data-stu-id="93a64-130">The abstract schema is read-only; you cannot use it to modify or extend the schema.</span></span> <span data-ttu-id="93a64-131">請注意，必須在架構主機的網域控制站上進行修改。</span><span class="sxs-lookup"><span data-stu-id="93a64-131">Be aware that modifications must be made at the domain controller that is the schema master.</span></span> <span data-ttu-id="93a64-132">如需詳細資訊，請參閱 [安裝架構延伸模組的必要條件](prerequisites-for-installing-a-schema-extension.md)。</span><span class="sxs-lookup"><span data-stu-id="93a64-132">For more information, see [Prerequisites for Installing a Schema Extension](prerequisites-for-installing-a-schema-extension.md).</span></span>

 

 