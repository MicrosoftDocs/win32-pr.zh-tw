---
title: 註冊靜態內容功能表項目
description: 本主題說明如何註冊針對 Active Directory 物件所顯示的靜態內容功能表項目。
ms.assetid: ed945812-3adb-4058-bdb6-8d9d34468265
ms.tgt_platform: multiple
keywords:
- 註冊靜態內容功能表項目廣告
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 89e3ee5336061ca296e2c94f8907ebd385610494
ms.sourcegitcommit: 803f3ccd65bdefe36bd851b9c6e7280be9489016
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/17/2020
ms.locfileid: "106968086"
---
# <a name="registering-a-static-context-menu-item"></a><span data-ttu-id="1dd1e-104">註冊靜態內容功能表項目</span><span class="sxs-lookup"><span data-stu-id="1dd1e-104">Registering a Static Context Menu Item</span></span>

<span data-ttu-id="1dd1e-105">Active Directory Domain Services 和 Windows shell 的管理 MMC 嵌入式管理單元，提供一種機制，可將專案新增至 Active Directory Domain Services 中的物件所顯示的內容功能表。</span><span class="sxs-lookup"><span data-stu-id="1dd1e-105">The administrative MMC snap-ins of Active Directory Domain Services and the Windows shell provide a mechanism to add an item to the context menu displayed for objects in Active Directory Domain Services.</span></span> <span data-ttu-id="1dd1e-106">內容功能表可以叫用任何可以使用 [**ShellExecute**](/windows/win32/api/shellapi/nf-shellapi-shellexecutea) API 啟動的檔案，例如應用程式或網頁 URL。</span><span class="sxs-lookup"><span data-stu-id="1dd1e-106">The context menu can invoke any file that can be started with the [**ShellExecute**](/windows/win32/api/shellapi/nf-shellapi-shellexecutea) API, such as an application or webpage URL.</span></span>

## <a name="registering-with-active-directory-domain-services"></a><span data-ttu-id="1dd1e-107">向 Active Directory Domain Services 註冊</span><span class="sxs-lookup"><span data-stu-id="1dd1e-107">Registering with Active Directory Domain Services</span></span>

<span data-ttu-id="1dd1e-108">操作功能表延伸模組註冊是特定于一個地區設定。</span><span class="sxs-lookup"><span data-stu-id="1dd1e-108">Context menu extension registration is specific to one locale.</span></span> <span data-ttu-id="1dd1e-109">如果內容功能表延伸模組套用至所有地區設定，則必須在 [顯示規範] 容器中所有地區設定子容器的物件類別 [**displaySpecifier**](/windows/desktop/ADSchema/c-displayspecifier) 物件中註冊。</span><span class="sxs-lookup"><span data-stu-id="1dd1e-109">If the context menu extension applies to all locales, it must be registered in the object class [**displaySpecifier**](/windows/desktop/ADSchema/c-displayspecifier) object in all of the locale subcontainers in the Display Specifiers container.</span></span> <span data-ttu-id="1dd1e-110">如果內容功能表延伸針對特定地區設定進行當地語系化，則必須在該地區設定 subcontainer 的 **displaySpecifier** 物件中註冊。</span><span class="sxs-lookup"><span data-stu-id="1dd1e-110">If the context menu extension is localized for a certain locale, it must be registered in the **displaySpecifier** object in that locale subcontainer.</span></span> <span data-ttu-id="1dd1e-111">如需顯示規範容器和地區設定的詳細資訊，請參閱 [顯示](display-specifiers.md) 規範和 [DisplaySpecifiers 容器](displayspecifiers-container.md)。</span><span class="sxs-lookup"><span data-stu-id="1dd1e-111">For more information about the Display Specifiers container and locales, see [Display Specifiers](display-specifiers.md) and [DisplaySpecifiers Container](displayspecifiers-container.md).</span></span>

<span data-ttu-id="1dd1e-112">有兩個顯示規範屬性，可以在 [**adminCoNtextMenu**](/windows/desktop/ADSchema/a-admincontextmenu) 和 [**shellCoNtextMenu**](/windows/desktop/ADSchema/a-shellcontextmenu)下註冊靜態內容功能表項目。</span><span class="sxs-lookup"><span data-stu-id="1dd1e-112">There are two display specifier attributes that a static context menu item can be registered under, [**adminContextMenu**](/windows/desktop/ADSchema/a-admincontextmenu) and [**shellContextMenu**](/windows/desktop/ADSchema/a-shellcontextmenu).</span></span>

<span data-ttu-id="1dd1e-113">[**AdminCoNtextMenu**](/windows/desktop/ADSchema/a-admincontextmenu)屬性會識別要在 Active Directory Domain Services 的系統管理嵌入式管理單元中顯示的系統管理內容功能表。</span><span class="sxs-lookup"><span data-stu-id="1dd1e-113">The [**adminContextMenu**](/windows/desktop/ADSchema/a-admincontextmenu) attribute identifies administrative context menus to display in the administrative snap-ins of Active Directory Domain Services.</span></span> <span data-ttu-id="1dd1e-114">當使用者在其中一個 [系統管理] MMC 嵌入式管理單元中顯示適當類別的物件內容功能表時，就會顯示內容功能表。</span><span class="sxs-lookup"><span data-stu-id="1dd1e-114">The context menu appears when the user displays the context menu for objects of the appropriate class in one of the administrative MMC snap-ins.</span></span>

<span data-ttu-id="1dd1e-115">[**ShellCoNtextMenu**](/windows/desktop/ADSchema/a-shellcontextmenu)屬性會識別要在 Windows shell 中顯示的使用者內容功能表。</span><span class="sxs-lookup"><span data-stu-id="1dd1e-115">The [**shellContextMenu**](/windows/desktop/ADSchema/a-shellcontextmenu) attribute identifies end-user context menus to display in the Windows shell.</span></span> <span data-ttu-id="1dd1e-116">當使用者在 Windows 檔案總管中，流覽適當類別的物件內容功能表時，就會顯示內容功能表。</span><span class="sxs-lookup"><span data-stu-id="1dd1e-116">The context menu appears when the user views the context menu for objects of the appropriate class in the Windows Explorer.</span></span> <span data-ttu-id="1dd1e-117">從 Windows Server 2003 開始，Windows shell 不再顯示來自 Active Directory Domain Services 的物件。</span><span class="sxs-lookup"><span data-stu-id="1dd1e-117">Beginning with Windows Server 2003, the Windows shell no longer displays objects that are from Active Directory Domain Services.</span></span>

<span data-ttu-id="1dd1e-118">所有這些屬性都是多重值。</span><span class="sxs-lookup"><span data-stu-id="1dd1e-118">All of these attributes are multi-valued.</span></span>

<span data-ttu-id="1dd1e-119">註冊靜態內容功能表項目時， [**adminCoNtextMenu**](/windows/desktop/ADSchema/a-admincontextmenu) 和 [**shellCoNtextMenu**](/windows/desktop/ADSchema/a-shellcontextmenu) 屬性的值需要下列格式。</span><span class="sxs-lookup"><span data-stu-id="1dd1e-119">When registering a static context menu item, the values for the [**adminContextMenu**](/windows/desktop/ADSchema/a-admincontextmenu) and [**shellContextMenu**](/windows/desktop/ADSchema/a-shellcontextmenu) attributes require the following format.</span></span>


```C++
<order number>,<menu text>,<command>
```



<span data-ttu-id="1dd1e-120">「 &lt; 訂單編號」 &gt; 是一種不帶正負號的數位，代表內容功能表中的專案位置。</span><span class="sxs-lookup"><span data-stu-id="1dd1e-120">The "&lt;order number&gt;" is an unsigned number that represents the item's position in the context menu.</span></span> <span data-ttu-id="1dd1e-121">顯示內容功能表時，會使用每個值的「訂單編號」比較來排序這些值 &lt; &gt; 。</span><span class="sxs-lookup"><span data-stu-id="1dd1e-121">When a context menu is displayed, the values are sorted using a comparison of each value's "&lt;order number&gt;".</span></span> <span data-ttu-id="1dd1e-122">如果有一個以上的值具有相同的「 &lt; 訂單編號」 &gt; ，則這些內容功能表延伸模組會以從 Active Directory 伺服器讀取的順序載入。</span><span class="sxs-lookup"><span data-stu-id="1dd1e-122">If more than one value has the same "&lt;order number&gt;", those context menu extensions are loaded in the order they are read from the Active Directory server.</span></span> <span data-ttu-id="1dd1e-123">可能的話，請使用非現有的「 &lt; 訂單編號」 &gt; ，也就是屬性中其他值尚未使用的「訂單編號」。</span><span class="sxs-lookup"><span data-stu-id="1dd1e-123">If possible, use a non-existing "&lt;order number&gt;", that is, one that has not been used by other values in the property.</span></span> <span data-ttu-id="1dd1e-124">沒有指定的開始位置，而且「訂單編號」序列中允許有間距 &lt; &gt; 。</span><span class="sxs-lookup"><span data-stu-id="1dd1e-124">There is no prescribed starting position, and gaps are allowed in the "&lt;order number&gt;" sequence.</span></span>

<span data-ttu-id="1dd1e-125">「 &lt; 功能表文字」 &gt; 是顯示在內容功能表中的字串。</span><span class="sxs-lookup"><span data-stu-id="1dd1e-125">The "&lt;menu text&gt;" is the string displayed in the context menu.</span></span> <span data-ttu-id="1dd1e-126">「 &lt; 功能表文字」 &gt; 可以在功能表項目的鍵盤快速鍵字元前面加上一個 "&" 字元。</span><span class="sxs-lookup"><span data-stu-id="1dd1e-126">The "&lt;menu text&gt;" can include one "&" character that precedes the keyboard shortcut character for the menu item.</span></span> <span data-ttu-id="1dd1e-127">這會導致前面的字元加上底線。</span><span class="sxs-lookup"><span data-stu-id="1dd1e-127">This will cause the preceded character to be underlined.</span></span> <span data-ttu-id="1dd1e-128">例如，如果「 &lt; 功能表文字」是「&檔案」 &gt; ，則功能表文字會顯示為「檔案」，"f" 將會加上底線，而 "f" 將是功能表項目的鍵盤快速鍵。</span><span class="sxs-lookup"><span data-stu-id="1dd1e-128">For example, if the "&lt;menu text&gt;" is "&File", the menu text will be displayed as "File", the "F" will be underlined and "F" will be the keyboard shortcut for the menu item.</span></span>

<span data-ttu-id="1dd1e-129">「 &lt; 命令」 &gt; 是嵌入式管理單元所執行的程式或檔案。</span><span class="sxs-lookup"><span data-stu-id="1dd1e-129">The "&lt;command&gt;" is the program or file executed by the snap-in.</span></span> <span data-ttu-id="1dd1e-130">必須指定完整路徑，或檔案必須存在於電腦路徑環境變數中。</span><span class="sxs-lookup"><span data-stu-id="1dd1e-130">Either the full path must be specified or the file must exist in the computer path environment variable.</span></span> <span data-ttu-id="1dd1e-131">使用 [**ShellExecute**](/windows/win32/api/shellapi/nf-shellapi-shellexecutea) 函式來叫用檔案。</span><span class="sxs-lookup"><span data-stu-id="1dd1e-131">The file is invoked using the [**ShellExecute**](/windows/win32/api/shellapi/nf-shellapi-shellexecutea) function.</span></span> <span data-ttu-id="1dd1e-132">" &lt; Command &gt; " 不能包含其他參數，例如 Notepad.exe Myfile.txt。</span><span class="sxs-lookup"><span data-stu-id="1dd1e-132">The "&lt;command&gt;" cannot contain additional parameters, for example, Notepad.exe Myfile.txt.</span></span> <span data-ttu-id="1dd1e-133">由於使用 **ShellExecute** ，任何可傳遞至 **ShellExecute** 的檔案或位址都可以用於 " &lt; command &gt; "。</span><span class="sxs-lookup"><span data-stu-id="1dd1e-133">Because **ShellExecute** is used, any file or address that can be passed to **ShellExecute** can be used for "&lt;command&gt;".</span></span> <span data-ttu-id="1dd1e-134">例如，如果 " &lt; command &gt; " 包含 "d： \\file.txt"，d： \\file.txt 將會使用與 .txt 副檔名相關聯的應用程式開啟。</span><span class="sxs-lookup"><span data-stu-id="1dd1e-134">For example, if "&lt;command&gt;" contains "d:\\file.txt", d:\\file.txt will be opened with the application associated with the .txt extension.</span></span> <span data-ttu-id="1dd1e-135">同樣地，如果 " &lt; command &gt; " 包含 " https://www.fabrikam.com "，就會開啟預設的網頁瀏覽器，並顯示指定的網頁。</span><span class="sxs-lookup"><span data-stu-id="1dd1e-135">Likewise, if "&lt;command&gt;" contains "https://www.fabrikam.com", the default web browser is opened and will display the specified webpage.</span></span> <span data-ttu-id="1dd1e-136">允許具有空格的路徑和應用程式名稱。</span><span class="sxs-lookup"><span data-stu-id="1dd1e-136">Paths and application names with spaces are allowed.</span></span> <span data-ttu-id="1dd1e-137">如果「 &lt; 命令」 &gt; 是應用程式，則會以命令列引數（以空格分隔）來傳遞所選物件的 ADsPath 和類別。</span><span class="sxs-lookup"><span data-stu-id="1dd1e-137">If "&lt;command&gt;" is an application, the selected object's ADsPath and class are passed as command line arguments, separated by a space.</span></span>

<span data-ttu-id="1dd1e-138">在 Windows shell 中，支援多重選取的內容功能表項目。</span><span class="sxs-lookup"><span data-stu-id="1dd1e-138">In the Windows shell, multiple-selection context menu items are supported.</span></span> <span data-ttu-id="1dd1e-139">在此情況下， &lt; &gt; 會針對每個選取的物件叫用「命令」。</span><span class="sxs-lookup"><span data-stu-id="1dd1e-139">In this case, the "&lt;command&gt;" is invoked for each selected object.</span></span> <span data-ttu-id="1dd1e-140">在 Active Directory Domain Services 的「系統管理」嵌入式管理單元中，不支援多重選取的靜態內容功能表項目。</span><span class="sxs-lookup"><span data-stu-id="1dd1e-140">In Active Directory Domain Services' administrative snap-ins, multiple-selection static context menu items are not supported.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="1dd1e-141">針對 Windows shell，會在使用者登入時抓取顯示規範資料，並為使用者的會話進行快取。</span><span class="sxs-lookup"><span data-stu-id="1dd1e-141">For the Windows shell, display specifier data is retrieved at user logon and cached for the user's session.</span></span> <span data-ttu-id="1dd1e-142">針對系統管理嵌入式管理單元，在載入嵌入式管理單元時，會抓取顯示規範資料，而且會在進程期間進行快取。</span><span class="sxs-lookup"><span data-stu-id="1dd1e-142">For the administrative snap-ins, the display specifier data is retrieved when the snap-in is loaded and is cached for the duration of the process.</span></span> <span data-ttu-id="1dd1e-143">針對 Windows shell，這表示在使用者登出後重新登入後，顯示規範的變更會生效。</span><span class="sxs-lookup"><span data-stu-id="1dd1e-143">For the Windows shell, this means changes to display specifiers take effect after a user logs off and back on again.</span></span> <span data-ttu-id="1dd1e-144">系統管理嵌入式管理單元的變更會在嵌入式管理單元或主控台檔案重載時生效;也就是說，如果您啟動新的主控台檔案實例或新的 Mmc.exe 實例，並加入嵌入式管理單元，則會抓取最新的顯示規範資料。</span><span class="sxs-lookup"><span data-stu-id="1dd1e-144">For the administrative snap-ins, changes take effect when the snap-in or console file is reloaded; that is, if you start a new instance of the console file or new Mmc.exe instance and add the snap-in, the latest display specifier data is retrieved.</span></span>

 

<span data-ttu-id="1dd1e-145">如需詳細資訊和程式碼範例，請參閱 [安裝靜態內容功能表項目的範例程式碼](example-code-for-installing-a-static-context-menu-item.md)。</span><span class="sxs-lookup"><span data-stu-id="1dd1e-145">For more information, and a code example, see [Example Code for Installing a Static Context Menu Item](example-code-for-installing-a-static-context-menu-item.md).</span></span>

 

 