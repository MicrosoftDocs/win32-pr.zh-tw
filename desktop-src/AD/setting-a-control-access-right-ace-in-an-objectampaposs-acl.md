---
title: 在物件的 ACL 中設定 Control 存取權限 ACE
description: 您可以使用 ADSI 來設定 control access right ACE，就像是屬性特定的 ACE 一樣，不同的是，IADsAccessControlEntry 屬性是控制項存取權的 rightsGUID。
ms.assetid: 454dc372-47b0-457d-8660-644fcfa59be8
ms.tgt_platform: multiple
keywords:
- 在物件的 ACL 中設定 Control 存取權限 ACE
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 0f41b870ad3ed5432060fb51fe14c29a81ce4665
ms.sourcegitcommit: 803f3ccd65bdefe36bd851b9c6e7280be9489016
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/17/2020
ms.locfileid: "103933045"
---
# <a name="setting-a-control-access-right-ace-in-an-objects-acl"></a><span data-ttu-id="e6569-104">在物件的 ACL 中設定 Control 存取權限 ACE</span><span class="sxs-lookup"><span data-stu-id="e6569-104">Setting a Control Access Right ACE in an Object's ACL</span></span>

<span data-ttu-id="e6569-105">您可以使用 ADSI 來設定 control access right ACE，就像是屬性特定的 ACE 一樣，不同的是， [**IADsAccessControlEntry**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) 屬性是控制項存取權的 **rightsGUID** 。</span><span class="sxs-lookup"><span data-stu-id="e6569-105">Using ADSI, you set a control access right ACE just as you would a property-specific ACE, except that the [**IADsAccessControlEntry.ObjectType**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) property is the **rightsGUID** of the control access right.</span></span> <span data-ttu-id="e6569-106">請注意，您也可以使用 Win32 安全性 Api 來設定目錄物件的 Acl。</span><span class="sxs-lookup"><span data-stu-id="e6569-106">Be aware that you can also use the Win32 security APIs to set ACLs on directory objects.</span></span>

<span data-ttu-id="e6569-107">下表列出可用來設定 ACE 屬性之控制項存取權限的 [**IADsAccessControlEntry**](/windows/desktop/api/iads/nn-iads-iadsaccesscontrolentry) 屬性。</span><span class="sxs-lookup"><span data-stu-id="e6569-107">The following table lists the [**IADsAccessControlEntry**](/windows/desktop/api/iads/nn-iads-iadsaccesscontrolentry) properties for control access rights that can be used to set properties for an ACE.</span></span>



| <span data-ttu-id="e6569-108">屬性</span><span class="sxs-lookup"><span data-stu-id="e6569-108">Property</span></span>                                                       | <span data-ttu-id="e6569-109">描述</span><span class="sxs-lookup"><span data-stu-id="e6569-109">Description</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|----------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="e6569-110">**AccessMask**</span><span class="sxs-lookup"><span data-stu-id="e6569-110">**AccessMask**</span></span>](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) | <span data-ttu-id="e6569-111">若要控制對特殊作業進行擴充許可權存取的控制存取權限，AccessMask 必須包含 **ADS \_ RIGHT \_ DS \_ control \_ 存取** 旗標。</span><span class="sxs-lookup"><span data-stu-id="e6569-111">For control access rights that control extended rights access to special operations, AccessMask must contain the **ADS\_RIGHT\_DS\_CONTROL\_ACCESS** flag.</span></span> <span data-ttu-id="e6569-112">針對定義屬性集的控制存取權限，AccessMask 包含 **ADS \_ 正確的 \_ ds \_ 讀取 \_** 屬性和/或 **ads 的 \_ 正確 \_ ds \_ 寫入 \_** 屬性。</span><span class="sxs-lookup"><span data-stu-id="e6569-112">For control access rights that define a property set, AccessMask contains **ADS\_RIGHT\_DS\_READ\_PROP** and/or **ADS\_RIGHT\_DS\_WRITE\_PROP**.</span></span><br/> <span data-ttu-id="e6569-113">若為控制已驗證之寫入的控制存取權限， [**AccessMask**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) 會包含 **正確的 \_ \_ DS \_ 本身的廣告**。</span><span class="sxs-lookup"><span data-stu-id="e6569-113">For control access rights that control validated writes, [**AccessMask**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) contains **ADS\_RIGHT\_DS\_SELF**.</span></span><br/> |
| [<span data-ttu-id="e6569-114">**標誌**</span><span class="sxs-lookup"><span data-stu-id="e6569-114">**Flags**</span></span>](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods)      | <span data-ttu-id="e6569-115">此值必須包含 **ADS \_ 旗標 \_ 物件 \_ 類型 \_ 目前** 的旗標。</span><span class="sxs-lookup"><span data-stu-id="e6569-115">This value must include the **ADS\_FLAG\_OBJECT\_TYPE\_PRESENT** flag.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                       |
| [<span data-ttu-id="e6569-116">**ObjectType**</span><span class="sxs-lookup"><span data-stu-id="e6569-116">**ObjectType**</span></span>](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) | <span data-ttu-id="e6569-117">這個值必須是 control 存取權限之 **rightsGUID** 屬性的 [**StringFromGUID2**](/windows/win32/api/combaseapi/nf-combaseapi-stringfromguid2)格式。</span><span class="sxs-lookup"><span data-stu-id="e6569-117">This value must be the [**StringFromGUID2**](/windows/win32/api/combaseapi/nf-combaseapi-stringfromguid2) format of the **rightsGUID** attribute of the control access right.</span></span> <span data-ttu-id="e6569-118">請注意，在 ACE 中，GUID 字串必須包含開始和終止大括弧，即使 **controlAccessRight** 物件的 **rightsGUID** 屬性不包含大括弧也一樣。</span><span class="sxs-lookup"><span data-stu-id="e6569-118">Be aware that, in an ACE, the GUID string must include the starting and terminating curly braces even though the **rightsGUID** attribute of the **controlAccessRight** object does not include the curly braces.</span></span>                                                                                                                                     |
| [<span data-ttu-id="e6569-119">**AceType**</span><span class="sxs-lookup"><span data-stu-id="e6569-119">**AceType**</span></span>](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods)    | <span data-ttu-id="e6569-120">這兩個 **ADS 都 \_ ACETYPE \_ 存取 \_ 允許的 \_ 物件** ，授與信任者存取控制許可權或 **ADS ACETYPE 拒絕 \_ \_ 存取 \_ \_ 物件** ，以拒絕受信任者控制存取權限。</span><span class="sxs-lookup"><span data-stu-id="e6569-120">Either **ADS\_ACETYPE\_ACCESS\_ALLOWED\_OBJECT** to grant the trustee the access control right or **ADS\_ACETYPE\_ACCESS\_DENIED\_OBJECT** to deny the trustee the control access right.</span></span>                                                                                                                                                                                                                                                                                                     |
| [<span data-ttu-id="e6569-121">**受託 人**</span><span class="sxs-lookup"><span data-stu-id="e6569-121">**Trustee**</span></span>](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods)    | <span data-ttu-id="e6569-122">套用 ACE 的安全性主體，例如使用者、群組、電腦等等。</span><span class="sxs-lookup"><span data-stu-id="e6569-122">The security principal, for example user, group, computer, and so on, to which the ACE applies.</span></span>                                                                                                                                                                                                                                                                                                                                                                                              |



 

<span data-ttu-id="e6569-123">如需建立 ACE 的詳細資訊，請參閱 [設定物件的存取權限](setting-access-rights-on-an-object.md)。</span><span class="sxs-lookup"><span data-stu-id="e6569-123">For more information about creating an ACE, see [Setting Access Rights on an Object](setting-access-rights-on-an-object.md).</span></span>

<span data-ttu-id="e6569-124">如需設定 ACE 的詳細資訊和程式碼範例，請參閱 [在目錄物件上設定 ace 的範例程式碼](example-code-for-setting-an-ace-on-a-directory-object.md)。</span><span class="sxs-lookup"><span data-stu-id="e6569-124">For more information and a code example for setting an ACE, see [Example Code for Setting an ACE on a Directory Object](example-code-for-setting-an-ace-on-a-directory-object.md).</span></span>

 

