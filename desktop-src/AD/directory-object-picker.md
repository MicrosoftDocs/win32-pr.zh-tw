---
title: 目錄物件選擇器
description: '[目錄物件選擇器] 對話方塊可讓使用者從通用類別目錄、網域或電腦或工作組中選取一個或多個物件。'
ms.assetid: 5b3e5d71-afd2-49db-b3a2-f9a49f0b2b3a
ms.tgt_platform: multiple
keywords:
- 目錄物件選擇器廣告
- 物件選擇器廣告
- 物件廣告，物件選擇器
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 24f6ba7fd053aa8ab3245bf72c693f0a887aa983
ms.sourcegitcommit: 803f3ccd65bdefe36bd851b9c6e7280be9489016
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/17/2020
ms.locfileid: "104023253"
---
# <a name="directory-object-picker"></a><span data-ttu-id="5456e-106">目錄物件選擇器</span><span class="sxs-lookup"><span data-stu-id="5456e-106">Directory Object Picker</span></span>

<span data-ttu-id="5456e-107">[目錄物件選擇器] 對話方塊可讓使用者從通用類別目錄、網域或電腦或工作組中選取一個或多個物件。</span><span class="sxs-lookup"><span data-stu-id="5456e-107">The directory object picker dialog box enables a user to select one or more objects from either the global catalog, a domain or computer, or a workgroup.</span></span> <span data-ttu-id="5456e-108">使用者可以選取的物件類型包括使用者、連絡人、群組和電腦物件。</span><span class="sxs-lookup"><span data-stu-id="5456e-108">The object types from which a user can select include user, contact, group, and computer objects.</span></span> <span data-ttu-id="5456e-109">如需 Active Directory Domain Services 的詳細資訊，請參閱 [Active Directory Domain Services](active-directory-domain-services.md)。</span><span class="sxs-lookup"><span data-stu-id="5456e-109">For more information about Active Directory Domain Services, see [Active Directory Domain Services](active-directory-domain-services.md).</span></span>

<span data-ttu-id="5456e-110">若要顯示 [物件選擇器] 對話方塊：</span><span class="sxs-lookup"><span data-stu-id="5456e-110">To display an object picker dialog box:</span></span>

1.  <span data-ttu-id="5456e-111">呼叫 [**CoCreateInstance**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance) 或 [**CoCreateInstanceEx**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstanceex) 函數來建立 [**IDsObjectPicker**](/windows/desktop/api/Objsel/nn-objsel-idsobjectpicker) 介面的實例。</span><span class="sxs-lookup"><span data-stu-id="5456e-111">Call the [**CoCreateInstance**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance) or [**CoCreateInstanceEx**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstanceex) function to create an instance of the [**IDsObjectPicker**](/windows/desktop/api/Objsel/nn-objsel-idsobjectpicker) interface.</span></span>
2.  <span data-ttu-id="5456e-112">呼叫 [**IDsObjectPicker：： initialize**](/windows/desktop/api/Objsel/nf-objsel-idsobjectpicker-initialize) 方法來初始化對話方塊。</span><span class="sxs-lookup"><span data-stu-id="5456e-112">Call the [**IDsObjectPicker::Initialize**](/windows/desktop/api/Objsel/nf-objsel-idsobjectpicker-initialize) method to initialize the dialog box.</span></span>
3.  <span data-ttu-id="5456e-113">呼叫 [**IDsObjectPicker：： InvokeDialog**](/windows/desktop/api/Objsel/nf-objsel-idsobjectpicker-invokedialog) 方法以顯示對話方塊。</span><span class="sxs-lookup"><span data-stu-id="5456e-113">Call the [**IDsObjectPicker::InvokeDialog**](/windows/desktop/api/Objsel/nf-objsel-idsobjectpicker-invokedialog) method to display the dialog box.</span></span>
4.  <span data-ttu-id="5456e-114">呼叫 [物件選擇器] 對話方塊所傳回之 [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject)實例的 [**IDataObject：：**](/windows/win32/api/objidl/nf-objidl-idataobject-getdata) DSOP 方法，以抓取 [**CFSTR \_ \_ DS \_ 選擇 \_ 清單**](cfstr-dsop-ds-selection-list.md)資料。</span><span class="sxs-lookup"><span data-stu-id="5456e-114">Call the [**IDataObject::GetData**](/windows/win32/api/objidl/nf-objidl-idataobject-getdata) method of the [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) instance returned by the object picker dialog box to retrieve the [**CFSTR\_DSOP\_DS\_SELECTION\_LIST**](cfstr-dsop-ds-selection-list.md) data.</span></span> <span data-ttu-id="5456e-115">**CFSTR \_ DSOP \_ ds \_ 挑選清單剪貼 \_ 簿** 格式會提供包含 [**DS \_ 選擇 \_ 清單**](/windows/desktop/api/Objsel/ns-objsel-ds_selection_list)結構的 **HGLOBAL** 。</span><span class="sxs-lookup"><span data-stu-id="5456e-115">The **CFSTR\_DSOP\_DS\_SELECTION\_LIST** clipboard format provides an **HGLOBAL** that contains a [**DS\_SELECTION\_LIST**](/windows/desktop/api/Objsel/ns-objsel-ds_selection_list) structure.</span></span> <span data-ttu-id="5456e-116">**DS \_ 選擇 \_ 清單** 結構包含在 [物件選擇器] 對話方塊中選取之專案的相關資料。</span><span class="sxs-lookup"><span data-stu-id="5456e-116">The **DS\_SELECTION\_LIST** structure contains data about the items selected in the object picker dialog box.</span></span>

<span data-ttu-id="5456e-117">如果物件需要 (SID) 的安全識別碼，則應該直接從物件選擇器要求這項功能，方法是將 **objectSID** 屬性新增至要針對所選物件取得的屬性清單。</span><span class="sxs-lookup"><span data-stu-id="5456e-117">If the Security Identifier (SID) is required for an object, this should be requested directly from the object picker by adding the **objectSID** attribute to the list of attributes to retrieve for the selected object.</span></span> <span data-ttu-id="5456e-118">不建議將傳回的物件名稱傳遞給 [**LsaLookupNames**](/windows/desktop/api/ntsecapi/nf-ntsecapi-lsalookupnames) 或 [**LookupAccountName**](/windows/desktop/api/winbase/nf-winbase-lookupaccountnamea) 函數，因為名稱查閱會是多餘的，而且在某些情況下可能會失敗。</span><span class="sxs-lookup"><span data-stu-id="5456e-118">Passing the returned object name to the [**LsaLookupNames**](/windows/desktop/api/ntsecapi/nf-ntsecapi-lsalookupnames) or [**LookupAccountName**](/windows/desktop/api/winbase/nf-winbase-lookupaccountnamea) function is not recommended because the name lookup will be redundant and may fail in some cases.</span></span>

<span data-ttu-id="5456e-119">如果將儲存任何所選物件的參考，則不應儲存分辨名稱，因為物件可能會移動、重新命名或可能因為地區設定差異而變更。</span><span class="sxs-lookup"><span data-stu-id="5456e-119">If a reference to any selected objects will be saved, the distinguished name should not be saved because the object may move, get renamed, or may change due to locale differences.</span></span> <span data-ttu-id="5456e-120">針對安全性主體，應該針對物件要求 **objectSID** 並安全地儲存。</span><span class="sxs-lookup"><span data-stu-id="5456e-120">For security principals, the **objectSID** should be requested for the object and securely saved.</span></span> <span data-ttu-id="5456e-121">如果稍後需要安全性主體的名稱，則可以使用 [**LookupAccountSid**](/windows/desktop/api/winbase/nf-winbase-lookupaccountsida) 函式來取出。</span><span class="sxs-lookup"><span data-stu-id="5456e-121">If the name of the security principal is needed later, it can be retrieved with the [**LookupAccountSid**](/windows/desktop/api/winbase/nf-winbase-lookupaccountsida) function.</span></span> <span data-ttu-id="5456e-122">若為所有其他物件，則應要求和儲存 **objectGUID** 。</span><span class="sxs-lookup"><span data-stu-id="5456e-122">For all other objects, the **objectGUID** should be requested and saved.</span></span>

## <a name="initialization"></a><span data-ttu-id="5456e-123">初始化</span><span class="sxs-lookup"><span data-stu-id="5456e-123">Initialization</span></span>

<span data-ttu-id="5456e-124">初始化 [物件選擇器] 對話方塊時，會指定一組範圍類型和篩選。</span><span class="sxs-lookup"><span data-stu-id="5456e-124">When the object picker dialog box is initialized, a set of scope types and filters is specified.</span></span> <span data-ttu-id="5456e-125">指定的範圍類型可決定使用者可以從中選取物件的位置、網域或電腦。</span><span class="sxs-lookup"><span data-stu-id="5456e-125">The specified scope types determine the locations, domains or computers for example, from which a user can select objects.</span></span> <span data-ttu-id="5456e-126">篩選準則會決定使用者可以從指定範圍類型中選取的物件類型。</span><span class="sxs-lookup"><span data-stu-id="5456e-126">The filters determine the types of objects that a user can select from a given scope type.</span></span> <span data-ttu-id="5456e-127">如需詳細資訊，請參閱下方的範圍和篩選一節。</span><span class="sxs-lookup"><span data-stu-id="5456e-127">For more information, see the Scopes and Filters section below.</span></span>

<span data-ttu-id="5456e-128">依預設，使用者可以在 [目錄物件選擇器] 對話方塊中選取單一物件。</span><span class="sxs-lookup"><span data-stu-id="5456e-128">By default, a user can select a single object in the directory object picker dialog box.</span></span> <span data-ttu-id="5456e-129">若要啟用多個選取專案，請在對話方塊初始化時，于 [**DSOP \_ INIT \_ 資訊**](/windows/desktop/api/Objsel/ns-objsel-dsop_init_info)結構的 **flOptions** 成員中設定 **DSOP \_ 旗 \_** 標。</span><span class="sxs-lookup"><span data-stu-id="5456e-129">To enable multiple selections, set the **DSOP\_FLAG\_MULTISELECT** flag in the **flOptions** member of the [**DSOP\_INIT\_INFO**](/windows/desktop/api/Objsel/ns-objsel-dsop_init_info) structure when the dialog box initialized.</span></span>

## <a name="scopes-and-filters"></a><span data-ttu-id="5456e-130">範圍和篩選器</span><span class="sxs-lookup"><span data-stu-id="5456e-130">Scopes and Filters</span></span>

<span data-ttu-id="5456e-131">[ **查詢** ] 下拉式清單包含使用者可以從中選取物件的範圍。</span><span class="sxs-lookup"><span data-stu-id="5456e-131">The **Look in** drop-down list contains the scopes from which a user can select objects.</span></span> <span data-ttu-id="5456e-132">範圍是儲存相關資料的網域、電腦、工作組或通用類別目錄，並可讓您存取一組可用的物件。</span><span class="sxs-lookup"><span data-stu-id="5456e-132">A scope is a domain, computer, workgroup, or global catalog that stores data about, and provides access to, a set of available objects.</span></span> <span data-ttu-id="5456e-133">範圍清單中的專案取決於 [**IDsObjectPicker：： initialize**](/windows/desktop/api/Objsel/nf-objsel-idsobjectpicker-initialize) 方法上次呼叫以初始化 [物件選擇器] 對話方塊時所指定的範圍類型和目的電腦。</span><span class="sxs-lookup"><span data-stu-id="5456e-133">The entries in the scope list depend on the scope types and the target computer specified when the [**IDsObjectPicker::Initialize**](/windows/desktop/api/Objsel/nf-objsel-idsobjectpicker-initialize) method was last called to initialize the object picker dialog box.</span></span>

<span data-ttu-id="5456e-134">範圍類型是範圍的一般分類，例如目的電腦所屬企業中的所有網域，或是目的電腦的企業的通用類別目錄或目的電腦本身。</span><span class="sxs-lookup"><span data-stu-id="5456e-134">A scope type is a generic category of scopes, such as all domains in the enterprise to which the target computer belongs, or the global catalog for the target computer's enterprise, or the target computer itself.</span></span> <span data-ttu-id="5456e-135">針對每個指定的範圍類型，此對話方塊會使用目的電腦的內容來判斷範圍清單專案。</span><span class="sxs-lookup"><span data-stu-id="5456e-135">For each specified scope type, the dialog box uses the context of the target computer to determine the scope list entries.</span></span>

<span data-ttu-id="5456e-136">[**IDsObjectPicker：： Initialize**](/windows/desktop/api/Objsel/nf-objsel-idsobjectpicker-initialize)方法會採用 [**DSOP \_ init \_ 資訊**](/windows/desktop/api/Objsel/ns-objsel-dsop_init_info)結構的指標，該結構包含 [**DSOP \_ 領域 \_ 初始 \_ 資訊**](/windows/desktop/api/Objsel/ns-objsel-dsop_scope_init_info)結構的陣列。</span><span class="sxs-lookup"><span data-stu-id="5456e-136">The [**IDsObjectPicker::Initialize**](/windows/desktop/api/Objsel/nf-objsel-idsobjectpicker-initialize) method takes a pointer to a [**DSOP\_INIT\_INFO**](/windows/desktop/api/Objsel/ns-objsel-dsop_init_info) structure that contains an array of [**DSOP\_SCOPE\_INIT\_INFO**](/windows/desktop/api/Objsel/ns-objsel-dsop_scope_init_info) structures.</span></span> <span data-ttu-id="5456e-137">**DSOP \_ 範圍 \_ INIT \_ INFO** 陣列中的每個專案會指定一或多個範圍類型，以及適用的篩選準則和其他屬性。</span><span class="sxs-lookup"><span data-stu-id="5456e-137">Each entry in the **DSOP\_SCOPE\_INIT\_INFO** array specifies one or more scope types as well as applicable filters and other attributes.</span></span> <span data-ttu-id="5456e-138">篩選準則會決定使用者可以從指定範圍類型中選取的物件類型，例如使用者、群組、連絡人和電腦。</span><span class="sxs-lookup"><span data-stu-id="5456e-138">The filters determine the types of objects, such as users, groups, contacts, and computers, that the user can select from a given scope type.</span></span> <span data-ttu-id="5456e-139">當使用者從清單中選取範圍時，對話方塊會套用該範圍類型的篩選器，以顯示可供使用者選取的物件清單。</span><span class="sxs-lookup"><span data-stu-id="5456e-139">When the user selects a scope from the list, the dialog box applies the filters for that scope type to display a list of objects from which the user can select.</span></span>

<span data-ttu-id="5456e-140">每個 [**DSOP \_ 範圍的 \_ 初始 \_ 資訊**](/windows/desktop/api/Objsel/ns-objsel-dsop_scope_init_info) 結構都包含 [**DSOP \_ 篩選 \_ 旗標**](/windows/desktop/api/Objsel/ns-objsel-dsop_filter_flags) 結構，以指定該範圍類型的篩選。</span><span class="sxs-lookup"><span data-stu-id="5456e-140">Each [**DSOP\_SCOPE\_INIT\_INFO**](/windows/desktop/api/Objsel/ns-objsel-dsop_scope_init_info) structure contains a [**DSOP\_FILTER\_FLAGS**](/windows/desktop/api/Objsel/ns-objsel-dsop_filter_flags) structure that specifies the filters for that scope type.</span></span> <span data-ttu-id="5456e-141">**DSOP \_ 篩選 \_ 旗標** 結構可區分上層層級和下層範圍：</span><span class="sxs-lookup"><span data-stu-id="5456e-141">The **DSOP\_FILTER\_FLAGS** structure distinguishes between up-level and down-level scopes:</span></span>

-   <span data-ttu-id="5456e-142">高層級範圍是通用類別目錄或支援 ADSI [LDAP 提供者](/windows/desktop/ADSI/adsi-ldap-provider)的網域。</span><span class="sxs-lookup"><span data-stu-id="5456e-142">An up-level scope is a global catalog or a domain that supports the ADSI [LDAP provider](/windows/desktop/ADSI/adsi-ldap-provider).</span></span>
-   <span data-ttu-id="5456e-143">下層範圍包含工作組和所有個別的電腦。</span><span class="sxs-lookup"><span data-stu-id="5456e-143">A down-level scope includes workgroups and all individual computers.</span></span> <span data-ttu-id="5456e-144">此對話方塊會使用 ADSI WinNT 提供者來存取舊版的範圍。</span><span class="sxs-lookup"><span data-stu-id="5456e-144">The dialog box uses the ADSI WinNT provider to access a down-level scope.</span></span>

<span data-ttu-id="5456e-145">[**DSOP \_ 篩選 \_ 旗標**](/windows/desktop/api/Objsel/ns-objsel-dsop_filter_flags)結構中定義了兩組篩選準則旗標：一個用於上層範圍，另一個用於下層範圍。</span><span class="sxs-lookup"><span data-stu-id="5456e-145">There are two sets of filter flags defined for use in the [**DSOP\_FILTER\_FLAGS**](/windows/desktop/api/Objsel/ns-objsel-dsop_filter_flags) structure: one for up-level scopes and one for down-level scopes.</span></span> <span data-ttu-id="5456e-146">**DSOP \_ 篩選 \_ 旗標** 結構的 **上層** 成員是 [**DSOP \_ 上層 \_ 篩選 \_ 旗標**](/windows/desktop/api/Objsel/ns-objsel-dsop_uplevel_filter_flags)結構，可指定高層級範圍的篩選準則。</span><span class="sxs-lookup"><span data-stu-id="5456e-146">The **Uplevel** member of the **DSOP\_FILTER\_FLAGS** structure is a [**DSOP\_UPLEVEL\_FILTER\_FLAGS**](/windows/desktop/api/Objsel/ns-objsel-dsop_uplevel_filter_flags) structure that specifies the filters for up-level scopes.</span></span> <span data-ttu-id="5456e-147">**DSOP \_ 篩選 \_ 旗標** 結構的 **flDownlevel** 成員是一組旗標，用來指定下層範圍的篩選準則。</span><span class="sxs-lookup"><span data-stu-id="5456e-147">The **flDownlevel** member of the **DSOP\_FILTER\_FLAGS** structure is a set of flags that specify the filters for down-level scopes.</span></span>

 

 