---
title: 物件建立的嚮導
description: 在 Active Directory Domain Services 的管理 MMC 嵌入式管理單元中，使用者可以開啟建立新物件之容器的內容功能表，選擇 [新增]，然後選擇要建立之物件的類別，藉以在目錄中建立新的物件。 建立物件的新實例時，會啟始物件建立 wizard。 每個物件類別都可以指定使用特定的建立嚮導，也可以使用一般建立 wizard。 針對一般類別（例如 user 和 organizationalUnit），Active Directory 消費者和電腦嵌入式管理單元提供一組標準的建立嚮導。有兩種方式可以擴充建立嚮導取代現有的 wizard，或是如果類別不存在，則會藉由建立主要物件建立延伸模組來取代現有的 wizard。 主要建立延伸模組會提供第一組頁面，並以與原生頁面相同的方式來主控。 主要建立延伸模組也支援擴充性機制，因此可以叫用其他建立嚮導擴充功能。 如需主要延伸模組的範例，請參閱平臺軟體發展工具組中的 scpwizard 範例 (SDK) 。擴充現有的 wizard：您可以使用次要物件建立延伸模組來擴充現有的 wizard。 次要建立延伸模組會將 wizard 頁面新增至原生頁面或主要延伸模組。 如需次要建立延伸模組的詳細資訊和範例，請參閱 Platform SDK 中的 userwizard 範例。
ms.assetid: 7ac7ec21-72a9-4d1f-80f1-1eb5bfa2b296
ms.tgt_platform: multiple
keywords:
- 物件廣告，建立嚮導
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 3bc3dbacaf6eee5670fdacd9a587a497397c4d1b
ms.sourcegitcommit: 803f3ccd65bdefe36bd851b9c6e7280be9489016
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/17/2020
ms.locfileid: "104092632"
---
# <a name="object-creation-wizards"></a><span data-ttu-id="f312e-112">物件建立的嚮導</span><span class="sxs-lookup"><span data-stu-id="f312e-112">Object Creation Wizards</span></span>

<span data-ttu-id="f312e-113">在 Active Directory Domain Services 的管理 MMC 嵌入式管理單元中，使用者可以開啟建立新物件之容器的內容功能表，選擇 [ **新增**]，然後選擇要建立之物件的類別，藉以在目錄中建立新的物件。</span><span class="sxs-lookup"><span data-stu-id="f312e-113">In the administrative MMC snap-ins of Active Directory Domain Services, the user can create new objects in a directory by opening the context menu for the container where the new object will be created, choosing **New**, and choosing the class of object to create.</span></span> <span data-ttu-id="f312e-114">建立物件的新實例時，會啟始物件建立 wizard。</span><span class="sxs-lookup"><span data-stu-id="f312e-114">Creating new instances of an object starts the object creation wizard.</span></span> <span data-ttu-id="f312e-115">每個物件類別都可以指定使用特定的建立嚮導，也可以使用一般建立 wizard。</span><span class="sxs-lookup"><span data-stu-id="f312e-115">Each object class may specify the use of a specific creation wizard, or it may use a generic creation wizard.</span></span> <span data-ttu-id="f312e-116">針對一般類別（例如 [**user**](/windows/desktop/ADSchema/c-user) 和 [**organizationalUnit**](/windows/desktop/ADSchema/c-organizationalunit)），Active Directory 消費者和電腦嵌入式管理單元提供一組標準的建立嚮導。</span><span class="sxs-lookup"><span data-stu-id="f312e-116">For common classes, such as [**user**](/windows/desktop/ADSchema/c-user) and [**organizationalUnit**](/windows/desktop/ADSchema/c-organizationalunit), the Active Directory Users and Computers snap-in provides a standard set of creation wizards.</span></span>

<span data-ttu-id="f312e-117">有兩種方式可以擴充建立嚮導：</span><span class="sxs-lookup"><span data-stu-id="f312e-117">There are two ways to extend a creation wizard:</span></span>

-   <span data-ttu-id="f312e-118">取代現有的 wizard，或如果類別不存在，請提供一個：現有的 wizard 會藉由建立 *主要物件建立延伸* 模組來取代。</span><span class="sxs-lookup"><span data-stu-id="f312e-118">Replace an existing wizard, or provide one if one does not exist for the class: The existing wizard is replaced by creating a *primary object creation extension*.</span></span> <span data-ttu-id="f312e-119">主要建立延伸模組會提供第一組頁面，並以與原生頁面相同的方式來主控。</span><span class="sxs-lookup"><span data-stu-id="f312e-119">A primary creation extension provides the first set of pages and is hosted in the same way as native pages.</span></span> <span data-ttu-id="f312e-120">主要建立延伸模組也支援擴充性機制，因此可以叫用其他建立嚮導擴充功能。</span><span class="sxs-lookup"><span data-stu-id="f312e-120">A primary creation extension also supports the extensibility mechanism so that other creation wizard extensions can be invoked.</span></span> <span data-ttu-id="f312e-121">如需主要延伸模組的範例，請參閱平臺軟體發展工具組中的 scpwizard 範例 (SDK) 。</span><span class="sxs-lookup"><span data-stu-id="f312e-121">For an example of a primary extension, see the scpwizard sample in the Platform Software Development Kit (SDK).</span></span>
-   <span data-ttu-id="f312e-122">擴充現有的 wizard：您可以使用 *次要物件建立延伸* 模組來擴充現有的 wizard。</span><span class="sxs-lookup"><span data-stu-id="f312e-122">Extend an existing wizard: An existing wizard can be extended with an *secondary object creation extension*.</span></span> <span data-ttu-id="f312e-123">次要建立延伸模組會將 wizard 頁面新增至原生頁面或主要延伸模組。</span><span class="sxs-lookup"><span data-stu-id="f312e-123">A secondary creation extension adds wizard pages to the native pages or primary extension.</span></span> <span data-ttu-id="f312e-124">如需次要建立延伸模組的詳細資訊和範例，請參閱 Platform SDK 中的 userwizard 範例。</span><span class="sxs-lookup"><span data-stu-id="f312e-124">For more information and an example of a secondary creation extension, see the userwizard sample in the Platform SDK.</span></span>

## <a name="developer-audience"></a><span data-ttu-id="f312e-125">開發人員讀者</span><span class="sxs-lookup"><span data-stu-id="f312e-125">Developer Audience</span></span>

<span data-ttu-id="f312e-126">本檔假設讀者已熟悉使用 c + + 的 COM 作業和元件開發。</span><span class="sxs-lookup"><span data-stu-id="f312e-126">This documentation assumes that the reader is familiar with COM operation and component development using C++.</span></span> <span data-ttu-id="f312e-127">目前無法使用 Visual Basic 建立 Active Directory 物件建立嚮導的擴充功能。</span><span class="sxs-lookup"><span data-stu-id="f312e-127">It is not currently possible to create an extension to the Active Directory object creation wizard using Visual Basic.</span></span>

## <a name="creating-an-active-directory-object-creation-extension"></a><span data-ttu-id="f312e-128">建立 Active Directory 物件建立延伸模組</span><span class="sxs-lookup"><span data-stu-id="f312e-128">Creating an Active Directory Object Creation Extension</span></span>

<span data-ttu-id="f312e-129">主要和次要物件建立延伸模組都是 COM 的內部進程伺服器，這些伺服器會執行特定介面並向 Active Directory Domain Services 註冊。</span><span class="sxs-lookup"><span data-stu-id="f312e-129">Both primary and secondary object creation extensions are COM in-proc servers that implement certain interfaces and are registered with Active Directory Domain Services.</span></span>

<span data-ttu-id="f312e-130">**建立和安裝物件建立延伸模組**</span><span class="sxs-lookup"><span data-stu-id="f312e-130">**To create and install an object creation extension**</span></span>

1.  <span data-ttu-id="f312e-131">建立物件建立延伸模組 DLL。</span><span class="sxs-lookup"><span data-stu-id="f312e-131">Create the object creation extension DLL.</span></span> <span data-ttu-id="f312e-132">物件建立延伸模組是 COM 的內部伺服器伺服器，至少會執行 [**IDsAdminNewObjExt**](/windows/desktop/api/DSAdmin/nn-dsadmin-idsadminnewobjext) 介面。</span><span class="sxs-lookup"><span data-stu-id="f312e-132">An object creation extension is a COM in-proc server that, at a minimum, implements the [**IDsAdminNewObjExt**](/windows/desktop/api/DSAdmin/nn-dsadmin-idsadminnewobjext) interface.</span></span> <span data-ttu-id="f312e-133">如需詳細資訊，請參閱 [執行物件建立延伸模組 COM 物件](implementing-the-object-creation-extension-com-object.md)。</span><span class="sxs-lookup"><span data-stu-id="f312e-133">For more information, see [Implementing the Object Creation Extension COM Object](implementing-the-object-creation-extension-com-object.md).</span></span>
2.  <span data-ttu-id="f312e-134">在要使用建立延伸模組的電腦上安裝建立延伸模組。</span><span class="sxs-lookup"><span data-stu-id="f312e-134">Install the creation extension on computers where the creation extension is to be used.</span></span> <span data-ttu-id="f312e-135">若要這樣做，請建立建立延伸模組 DLL 的 Microsoft Windows Installer 套件，並使用群組原則適當地部署套件。</span><span class="sxs-lookup"><span data-stu-id="f312e-135">To do this, create a Microsoft Windows Installer package for the creation extension DLL and deploy the package appropriately using the group policy.</span></span> <span data-ttu-id="f312e-136">如需詳細資訊，請參閱散發 [消費者介面元件](distributing-user-interface-components.md)。</span><span class="sxs-lookup"><span data-stu-id="f312e-136">For more information, see [Distributing User Interface Components](distributing-user-interface-components.md).</span></span>
3.  <span data-ttu-id="f312e-137">在 Windows 登錄和 Active Directory Domain Services 中註冊建立延伸模組。</span><span class="sxs-lookup"><span data-stu-id="f312e-137">Register the creation extension in the Windows registry and with Active Directory Domain Services.</span></span> <span data-ttu-id="f312e-138">如需詳細資訊，請參閱 [註冊物件建立延伸](registering-the-object-creation-extension.md)模組。</span><span class="sxs-lookup"><span data-stu-id="f312e-138">For more information, see [Registering the Object Creation Extension](registering-the-object-creation-extension.md).</span></span>

## <a name="using-an-object-creation-wizard"></a><span data-ttu-id="f312e-139">使用物件建立嚮導</span><span class="sxs-lookup"><span data-stu-id="f312e-139">Using an Object Creation Wizard</span></span>

<span data-ttu-id="f312e-140">物件建立 wizard 也可以從 Active Directory Domain Services 的管理 MMC 嵌入式管理單元以外的應用程式叫用。</span><span class="sxs-lookup"><span data-stu-id="f312e-140">An object creation wizard can also be invoked from an application other than the administrative MMC snap-ins of Active Directory Domain Services.</span></span> <span data-ttu-id="f312e-141">如需詳細資訊，請參閱 [從您的應用程式叫用建立嚮導](invoking-creation-wizards-from-your-application.md)。</span><span class="sxs-lookup"><span data-stu-id="f312e-141">For more information, see [Invoking Creation Wizards from Your Application](invoking-creation-wizards-from-your-application.md).</span></span>

<span data-ttu-id="f312e-142">如果未針對物件類別註冊建立嚮導，則系統管理嵌入式管理單元會提供一般建立嚮導。</span><span class="sxs-lookup"><span data-stu-id="f312e-142">If a creation wizard is not registered for an object class, the administrative snap-ins provide a generic creation wizard.</span></span> <span data-ttu-id="f312e-143">一般建立嚮導是在執行時間根據所建立物件之類別的強制屬性清單所建立。</span><span class="sxs-lookup"><span data-stu-id="f312e-143">The generic creation wizard is built at run time from the list of mandatory properties for the class of object created.</span></span> <span data-ttu-id="f312e-144">針對每個必要的屬性，會將頁面加入至 UI。</span><span class="sxs-lookup"><span data-stu-id="f312e-144">For each mandatory property, a page is added to the UI.</span></span> <span data-ttu-id="f312e-145">一般建立嚮導是不可延伸的。</span><span class="sxs-lookup"><span data-stu-id="f312e-145">The generic creation wizard is not extensible.</span></span> <span data-ttu-id="f312e-146">如果需要擴充性，必須將它取代為主要物件建立延伸模組。</span><span class="sxs-lookup"><span data-stu-id="f312e-146">If extensibility is required, it must be replaced with a primary object creation extension.</span></span>

 

 