---
title: 建立有效率的查詢
description: 下表指出建立有效率查詢時要考慮的重要概念。
ms.assetid: 1eb92d74-0a17-43f9-b5bf-eed731a52551
ms.tgt_platform: multiple
keywords:
- Active Directory 範例 Active Directory，建立有效率的查詢
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: fbcbda512d93a6567f5dc182b92409743368d10b8f328c1046034d94c7449712
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/11/2021
ms.locfileid: "118020355"
---
# <a name="creating-efficient-queries"></a>建立有效率的查詢

下表指出建立有效率查詢時要考慮的重要概念。



| 區域                  | 描述                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
|-----------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 編製索引              | 確定查詢篩選至少包含一個索引屬性。<br/> 如需詳細資訊，請參閱 [索引屬性](indexed-attributes.md)。<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| 類別與類別的比較    | 「ObjectClass = xyz」語句指的是「xyz」代表物件類別階層中任何類別的目錄物件，而「objectCategory = xyz」則是指「xyz」在物件類別階層中識別特定類別的目錄物件。 [**ObjectClass**](/windows/desktop/ADSchema/a-objectclass)屬性可以接受多個值，而 [**objectCategory**](/windows/desktop/ADSchema/a-objectcategory)會採用單一值，因此更適合用來比對目錄搜尋中的物件類型。<br/>                                                                                                                                                                                          |
| 文字搜尋        | 避免搜尋字串中間和結尾的文字。<br/> 例如，"cn = \* hille \* " 或 "cn = \* larouse"。<br/> 使用更明確的比對準則通常會增加搜尋效能。 這是因為 Active Directory Domain Services 會評估所有述詞、識別索引，然後選擇最可能產生一組最小傳回值的索引。 這項技術無法與 mid 和結尾字串搜尋搭配使用。 如果您沒有使用這些搜尋以外的其他選項，可以定義屬性的元組索引。<br/> 如需元組索引的詳細資訊，請參閱 [元組索引的運作方式](how-tuple-indexing-works.md)。<br/> |
| 子樹搜尋     | 如果您考慮使用子樹搜尋，請使用通用類別目錄。 追蹤參考需要大量資源。<br/> 如需詳細資訊，請參閱 [指定其他搜尋選項](specifying-other-search-options.md)。<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| 使用分頁         | 假設子樹搜尋將傳回大型結果集。 執行子樹搜尋時，請使用分頁。 伺服器會以區塊來串流大型結果集，以減少伺服器端記憶體資源。 這可將網路使用量降至最低，並減少透過網路傳送大量資料的需求。<br/> 如需詳細資訊，請參閱 [指定其他搜尋選項](specifying-other-search-options.md)。<br/>                                                                                                                                                                                                                                                                                        |
| 合併搜尋      | 使用多個屬性來進行搜尋。 搜尋兩個屬性的物件，會比兩個相同物件的搜尋更有效率，每個都會傳回一個屬性。<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| 有效率地使用 bind | 一次系結至物件，並保存會話其餘部分的系結控制碼。 請勿系結和解除系結每個呼叫。 如果您使用 ADO 或 OLE DB，請勿建立許多連線物件。<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| RoodDSE 快取       | 讀取 rootDSE 一次，並記住其內容以供會話的其餘部分之用。<br/> 如需詳細資訊，請參閱 [無伺服器系結和 RootDSE](serverless-binding-and-rootdse.md)。<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| 參考持續性 | 將物件的參考保存為 Guid，而不是辨別名稱，以便重新命名及刪除安全。<br/> 如需詳細資訊，請參閱 [使用 objectGUID 系結至物件](using-objectguid-to-bind-to-an-object.md)。<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |



 

 

