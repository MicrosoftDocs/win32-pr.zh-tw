---
title: 建立有效率的查詢
description: 下表指出建立有效率查詢時要考慮的重要概念。
ms.assetid: 1eb92d74-0a17-43f9-b5bf-eed731a52551
ms.tgt_platform: multiple
keywords:
- Active Directory 範例 Active Directory，建立有效率的查詢
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c8902fd3d512b940890ebdfd4c2640786c88c82a
ms.sourcegitcommit: 803f3ccd65bdefe36bd851b9c6e7280be9489016
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/17/2020
ms.locfileid: "103681677"
---
# <a name="creating-efficient-queries"></a><span data-ttu-id="bc714-104">建立有效率的查詢</span><span class="sxs-lookup"><span data-stu-id="bc714-104">Creating Efficient Queries</span></span>

<span data-ttu-id="bc714-105">下表指出建立有效率查詢時要考慮的重要概念。</span><span class="sxs-lookup"><span data-stu-id="bc714-105">The following table identifies important concepts to consider when creating an efficient query.</span></span>



| <span data-ttu-id="bc714-106">區域</span><span class="sxs-lookup"><span data-stu-id="bc714-106">Area</span></span>                  | <span data-ttu-id="bc714-107">描述</span><span class="sxs-lookup"><span data-stu-id="bc714-107">Description</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
|-----------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="bc714-108">編製索引</span><span class="sxs-lookup"><span data-stu-id="bc714-108">Indexing</span></span>              | <span data-ttu-id="bc714-109">確定查詢篩選至少包含一個索引屬性。</span><span class="sxs-lookup"><span data-stu-id="bc714-109">Ensure that the query filter contains at least one indexed attribute.</span></span><br/> <span data-ttu-id="bc714-110">如需詳細資訊，請參閱 [索引屬性](indexed-attributes.md)。</span><span class="sxs-lookup"><span data-stu-id="bc714-110">For more information, see [Indexed Attributes](indexed-attributes.md).</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| <span data-ttu-id="bc714-111">類別與類別的比較</span><span class="sxs-lookup"><span data-stu-id="bc714-111">Class vs. Category</span></span>    | <span data-ttu-id="bc714-112">「ObjectClass = xyz」語句指的是「xyz」代表物件類別階層中任何類別的目錄物件，而「objectCategory = xyz」則是指「xyz」在物件類別階層中識別特定類別的目錄物件。</span><span class="sxs-lookup"><span data-stu-id="bc714-112">The statement "objectClass=xyz" refers to directory objects in which "xyz" represents any class in the object class hierarchy, whereas "objectCategory=xyz", refers to those directory objects in which "xyz" identifies a specific class in the object class hierarchy.</span></span> <span data-ttu-id="bc714-113">[**ObjectClass**](/windows/desktop/ADSchema/a-objectclass)屬性可以接受多個值，而 [**objectCategory**](/windows/desktop/ADSchema/a-objectcategory)會採用單一值，因此更適合用來比對目錄搜尋中的物件類型。</span><span class="sxs-lookup"><span data-stu-id="bc714-113">The [**objectClass**](/windows/desktop/ADSchema/a-objectclass) property can take multiple values, whereas [**objectCategory**](/windows/desktop/ADSchema/a-objectcategory) takes a single value and is, thus, better suited for type matching of objects in a directory search.</span></span><br/>                                                                                                                                                                                          |
| <span data-ttu-id="bc714-114">文字搜尋</span><span class="sxs-lookup"><span data-stu-id="bc714-114">Text searching</span></span>        | <span data-ttu-id="bc714-115">避免搜尋字串中間和結尾的文字。</span><span class="sxs-lookup"><span data-stu-id="bc714-115">Avoid searching for text in the middle and on the end of a string.</span></span><br/> <span data-ttu-id="bc714-116">例如，"cn = \* hille \* " 或 "cn = \* larouse"。</span><span class="sxs-lookup"><span data-stu-id="bc714-116">For example, "cn=\*hille\*" or "cn=\*larouse".</span></span><br/> <span data-ttu-id="bc714-117">使用更明確的比對準則通常會增加搜尋效能。</span><span class="sxs-lookup"><span data-stu-id="bc714-117">Using more specific matching criteria tends to increase search performance.</span></span> <span data-ttu-id="bc714-118">這是因為 Active Directory Domain Services 會評估所有述詞、識別索引，然後選擇最可能產生一組最小傳回值的索引。</span><span class="sxs-lookup"><span data-stu-id="bc714-118">This is because Active Directory Domain Services will evaluate all predicates, identifies the indices, and then chooses one index most likely to yield the smallest set of returned values.</span></span> <span data-ttu-id="bc714-119">這項技術無法與 mid 和結尾字串搜尋搭配使用。</span><span class="sxs-lookup"><span data-stu-id="bc714-119">This technique does not work well with mid- and end-string searches.</span></span> <span data-ttu-id="bc714-120">如果您沒有使用這些搜尋以外的其他選項，可以定義屬性的元組索引。</span><span class="sxs-lookup"><span data-stu-id="bc714-120">If you have no other option other than using these searches, you can define a tuple index for the attribute.</span></span><br/> <span data-ttu-id="bc714-121">如需元組索引的詳細資訊，請參閱 [元組索引的運作方式](how-tuple-indexing-works.md)。</span><span class="sxs-lookup"><span data-stu-id="bc714-121">For more details about tuple indexes see [How Tuple Indexing Works](how-tuple-indexing-works.md).</span></span><br/> |
| <span data-ttu-id="bc714-122">子樹搜尋</span><span class="sxs-lookup"><span data-stu-id="bc714-122">Subtree searching</span></span>     | <span data-ttu-id="bc714-123">如果您考慮使用子樹搜尋，請使用通用類別目錄。</span><span class="sxs-lookup"><span data-stu-id="bc714-123">Use the global catalog if you are considering subtree searches.</span></span> <span data-ttu-id="bc714-124">追蹤參考需要大量資源。</span><span class="sxs-lookup"><span data-stu-id="bc714-124">Chasing referrals requires extensive resources.</span></span><br/> <span data-ttu-id="bc714-125">如需詳細資訊，請參閱 [指定其他搜尋選項](specifying-other-search-options.md)。</span><span class="sxs-lookup"><span data-stu-id="bc714-125">For more information, see [Specifying Other Search Options](specifying-other-search-options.md).</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| <span data-ttu-id="bc714-126">使用分頁</span><span class="sxs-lookup"><span data-stu-id="bc714-126">Use of paging</span></span>         | <span data-ttu-id="bc714-127">假設子樹搜尋將傳回大型結果集。</span><span class="sxs-lookup"><span data-stu-id="bc714-127">Assume that a subtree search will return a large result set.</span></span> <span data-ttu-id="bc714-128">執行子樹搜尋時，請使用分頁。</span><span class="sxs-lookup"><span data-stu-id="bc714-128">Use paging when performing subtree searches.</span></span> <span data-ttu-id="bc714-129">伺服器會以區塊來串流大型結果集，以減少伺服器端記憶體資源。</span><span class="sxs-lookup"><span data-stu-id="bc714-129">The server will stream a large result set in chunks reducing the server side memory resources.</span></span> <span data-ttu-id="bc714-130">這可將網路使用量降至最低，並減少透過網路傳送大量資料的需求。</span><span class="sxs-lookup"><span data-stu-id="bc714-130">This minimizes network usage and reduces the need for sending large chunks of data over a network.</span></span><br/> <span data-ttu-id="bc714-131">如需詳細資訊，請參閱 [指定其他搜尋選項](specifying-other-search-options.md)。</span><span class="sxs-lookup"><span data-stu-id="bc714-131">For more information, see [Specifying Other Search Options](specifying-other-search-options.md).</span></span><br/>                                                                                                                                                                                                                                                                                        |
| <span data-ttu-id="bc714-132">合併搜尋</span><span class="sxs-lookup"><span data-stu-id="bc714-132">Combine searches</span></span>      | <span data-ttu-id="bc714-133">使用多個屬性來進行搜尋。</span><span class="sxs-lookup"><span data-stu-id="bc714-133">Use multiple attributes for a search.</span></span> <span data-ttu-id="bc714-134">搜尋兩個屬性的物件，會比兩個相同物件的搜尋更有效率，每個都會傳回一個屬性。</span><span class="sxs-lookup"><span data-stu-id="bc714-134">One search of an object that reads two attributes is more efficient than two searches of the same object, each returning one attribute.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| <span data-ttu-id="bc714-135">有效率地使用 bind</span><span class="sxs-lookup"><span data-stu-id="bc714-135">Efficient use of bind</span></span> | <span data-ttu-id="bc714-136">一次系結至物件，並保存會話其餘部分的系結控制碼。</span><span class="sxs-lookup"><span data-stu-id="bc714-136">Bind to an object one time and hold the binding handle for the rest of the session.</span></span> <span data-ttu-id="bc714-137">請勿系結和解除系結每個呼叫。</span><span class="sxs-lookup"><span data-stu-id="bc714-137">Do not bind and unbind for each call.</span></span> <span data-ttu-id="bc714-138">如果您使用 ADO 或 OLE DB，請勿建立許多連線物件。</span><span class="sxs-lookup"><span data-stu-id="bc714-138">If you use ADO or OLE DB, do not create many connection objects.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| <span data-ttu-id="bc714-139">RoodDSE 快取</span><span class="sxs-lookup"><span data-stu-id="bc714-139">RoodDSE caching</span></span>       | <span data-ttu-id="bc714-140">讀取 rootDSE 一次，並記住其內容以供會話的其餘部分之用。</span><span class="sxs-lookup"><span data-stu-id="bc714-140">Read the rootDSE one time and remember its contents for the rest of your session.</span></span><br/> <span data-ttu-id="bc714-141">如需詳細資訊，請參閱 [無伺服器系結和 RootDSE](serverless-binding-and-rootdse.md)。</span><span class="sxs-lookup"><span data-stu-id="bc714-141">For more information, see [Serverless Binding and RootDSE](serverless-binding-and-rootdse.md).</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| <span data-ttu-id="bc714-142">參考持續性</span><span class="sxs-lookup"><span data-stu-id="bc714-142">Reference persistance</span></span> | <span data-ttu-id="bc714-143">將物件的參考保存為 Guid，而不是辨別名稱，以便重新命名及刪除安全。</span><span class="sxs-lookup"><span data-stu-id="bc714-143">Persist references to objects as GUIDs, not distinguished names, in order to be rename and delete safe.</span></span><br/> <span data-ttu-id="bc714-144">如需詳細資訊，請參閱 [使用 objectGUID 系結至物件](using-objectguid-to-bind-to-an-object.md)。</span><span class="sxs-lookup"><span data-stu-id="bc714-144">For more information, see [Using objectGUID to Bind to an Object](using-objectguid-to-bind-to-an-object.md).</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |



 

 

