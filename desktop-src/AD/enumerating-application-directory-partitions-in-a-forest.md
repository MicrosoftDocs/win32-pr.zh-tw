---
title: 列舉樹系中的應用程式目錄分割
description: 如同網域分割區，每個應用程式目錄分割都會以設定分割區之分割區容器中的交互參照物件來表示。
ms.assetid: dd1ff72d-ed19-4e8c-a401-a5b1b3d577e8
ms.tgt_platform: multiple
keywords:
- 列舉樹系 AD 中的應用程式目錄分割
- 應用程式目錄分割廣告，在樹系中列舉
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 8d42bbe28ef37932394721d0c234ba3970ac263b
ms.sourcegitcommit: 803f3ccd65bdefe36bd851b9c6e7280be9489016
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/17/2020
ms.locfileid: "104023247"
---
# <a name="enumerating-application-directory-partitions-in-a-forest"></a><span data-ttu-id="4313a-105">列舉樹系中的應用程式目錄分割</span><span class="sxs-lookup"><span data-stu-id="4313a-105">Enumerating Application Directory Partitions in a Forest</span></span>

<span data-ttu-id="4313a-106">如同網域分割區，每個應用程式目錄分割都會以設定分割區之分割區容器中的 [**交叉引用**](/windows/desktop/ADSchema/c-crossref) 物件來表示。</span><span class="sxs-lookup"><span data-stu-id="4313a-106">Like domain partitions, every application directory partition is represented by a [**crossRef**](/windows/desktop/ADSchema/c-crossref) object in the Partitions container of the configuration partition.</span></span> <span data-ttu-id="4313a-107">每個 **交叉引用** 物件都會儲存與其對應之資料分割相關的資料。</span><span class="sxs-lookup"><span data-stu-id="4313a-107">Each **crossRef** object stores data about its corresponding partition.</span></span>

<span data-ttu-id="4313a-108">表示網域分割區的 [**交叉引用**](/windows/desktop/ADSchema/c-crossref)物件，可區別于以 [**systemFlags**](/windows/desktop/ADSchema/a-systemflags)屬性內容表示應用程式目錄分割的 **交叉引用** 物件。</span><span class="sxs-lookup"><span data-stu-id="4313a-108">A [**crossRef**](/windows/desktop/ADSchema/c-crossref) object that represents a domain partition is distinguished from a **crossRef** object that represents an application directory partition by the contents of the [**systemFlags**](/windows/desktop/ADSchema/a-systemflags) attribute.</span></span> <span data-ttu-id="4313a-109">代表網域分割區的 **交叉引用** 物件，會在 **systemFlags** 屬性中同時設定 [**ads \_ SYSTEMFLAG \_ cr \_ ntds \_ NC**](/windows/win32/api/iads/ne-iads-ads_systemflag_enum)和 **ads \_ SYSTEMFLAG \_ cr \_ ntds \_ 網域** 旗標。</span><span class="sxs-lookup"><span data-stu-id="4313a-109">The **crossRef** object that represents a domain partition will have both the [**ADS\_SYSTEMFLAG\_CR\_NTDS\_NC**](/windows/win32/api/iads/ne-iads-ads_systemflag_enum) and **ADS\_SYSTEMFLAG\_CR\_NTDS\_DOMAIN** flags set in the **systemFlags** attribute.</span></span> <span data-ttu-id="4313a-110">代表應用程式目錄分割的 **交叉引用** 物件將會設定 **ADS \_ SYSTEMFLAG \_ CR \_ ntds \_ NC** 旗標，且不會在 **systemFlags** 屬性中設定 **ads \_ SYSTEMFLAG \_ CR \_ ntds \_ 網域** 旗標。</span><span class="sxs-lookup"><span data-stu-id="4313a-110">The **crossRef** object that represents an application directory partition will have the **ADS\_SYSTEMFLAG\_CR\_NTDS\_NC** flag set and the **ADS\_SYSTEMFLAG\_CR\_NTDS\_DOMAIN** flag will not be set in the **systemFlags** attribute.</span></span>

<span data-ttu-id="4313a-111">表示架構和設定分割區的 [**交叉引用**](/windows/desktop/ADSchema/c-crossref)物件也會設定 [**ads \_ SYSTEMFLAG \_ CR \_ ntds \_ NC**](/windows/win32/api/iads/ne-iads-ads_systemflag_enum)旗標，且不會在 [**systemFlags**](/windows/desktop/ADSchema/a-systemflags)屬性中設定 **ads \_ SYSTEMFLAG \_ CR \_ ntds \_ 網域** 旗標。</span><span class="sxs-lookup"><span data-stu-id="4313a-111">The [**crossRef**](/windows/desktop/ADSchema/c-crossref) objects that represent the Schema and Configuration partitions will also have the have [**ADS\_SYSTEMFLAG\_CR\_NTDS\_NC**](/windows/win32/api/iads/ne-iads-ads_systemflag_enum) flag set and the **ADS\_SYSTEMFLAG\_CR\_NTDS\_DOMAIN** flag will not be set in the [**systemFlags**](/windows/desktop/ADSchema/a-systemflags) attribute.</span></span> <span data-ttu-id="4313a-112">這需要將這兩個 **交叉引用** 物件區分成 [**nCName**](/windows/desktop/ADSchema/a-ncname) 屬性的內容。</span><span class="sxs-lookup"><span data-stu-id="4313a-112">This requires that these two **crossRef** objects be distinguished by the contents of the [**nCName**](/windows/desktop/ADSchema/a-ncname) attribute.</span></span> <span data-ttu-id="4313a-113">代表架構容器的 **交叉引用** 物件的 **nCName** 屬性將與 RootDSE 物件的 **schemaNamingCoNtext** 屬性相同。</span><span class="sxs-lookup"><span data-stu-id="4313a-113">The **nCName** attribute for the **crossRef** object that represents the Schema container will be identical to the **schemaNamingContext** attribute of the RootDSE object.</span></span> <span data-ttu-id="4313a-114">同樣地，代表設定容器的 **交叉引用** 物件的 **nCName** 屬性將與 RootDSE 物件的 **configurationNamingCoNtext** 屬性相同。</span><span class="sxs-lookup"><span data-stu-id="4313a-114">Similarly, the **nCName** attribute for the **crossRef** object that represents the Configuration container will be identical to the **configurationNamingContext** attribute of the RootDSE object.</span></span>

<span data-ttu-id="4313a-115">**若要識別樹系中的所有應用程式目錄分割，請執行下列步驟**</span><span class="sxs-lookup"><span data-stu-id="4313a-115">**To identify all application directory partitions in a forest, perform the following steps**</span></span>

1.  <span data-ttu-id="4313a-116">在設定分割區的資料分割容器中，搜尋或列舉所有的 [**交叉引用**](/windows/desktop/ADSchema/c-crossref) 物件。</span><span class="sxs-lookup"><span data-stu-id="4313a-116">In the Partitions container of the configuration partition, search for or enumerate all [**crossRef**](/windows/desktop/ADSchema/c-crossref) objects.</span></span>
2.  <span data-ttu-id="4313a-117">如果 [**交叉引用**](/windows/desktop/ADSchema/c-crossref)物件未設定 [**ads \_ SYSTEMFLAG \_ CR \_ ntds \_ NC**](/windows/win32/api/iads/ne-iads-ads_systemflag_enum)旗標，或在 [**systemFlags**](/windows/desktop/ADSchema/a-systemflags)屬性值中設定 **ads \_ SYSTEMFLAG \_ CR \_ ntds \_ 網域** 旗標，請將物件從結果集中排除。</span><span class="sxs-lookup"><span data-stu-id="4313a-117">If a [**crossRef**](/windows/desktop/ADSchema/c-crossref) object does not have the [**ADS\_SYSTEMFLAG\_CR\_NTDS\_NC**](/windows/win32/api/iads/ne-iads-ads_systemflag_enum) flag set or has the **ADS\_SYSTEMFLAG\_CR\_NTDS\_DOMAIN** flag set in the [**systemFlags**](/windows/desktop/ADSchema/a-systemflags) attribute value, exclude the object from the result set.</span></span>
3.  <span data-ttu-id="4313a-118">藉由比較 [**交叉引用**](/windows/desktop/ADSchema/c-crossref)物件的 [**NCName**](/windows/desktop/ADSchema/a-ncname)屬性與 RootDSE 物件的 **schemaNamingCoNtext** 屬性，從結果集中排除架構資料分割。</span><span class="sxs-lookup"><span data-stu-id="4313a-118">Exclude the Schema partition from the result set by comparing the [**nCName**](/windows/desktop/ADSchema/a-ncname) attribute of the [**crossRef**](/windows/desktop/ADSchema/c-crossref) object to the **schemaNamingContext** attribute of the RootDSE object.</span></span>
4.  <span data-ttu-id="4313a-119">藉由比較 [**交叉引用**](/windows/desktop/ADSchema/c-crossref)物件的 [**NCName**](/windows/desktop/ADSchema/a-ncname)屬性與 RootDSE 物件的 **configurationNamingCoNtext** 屬性，從結果集中排除設定磁碟分割。</span><span class="sxs-lookup"><span data-stu-id="4313a-119">Exclude the Configuration partition from the result set by comparing the [**nCName**](/windows/desktop/ADSchema/a-ncname) attribute of the [**crossRef**](/windows/desktop/ADSchema/c-crossref) object to the **configurationNamingContext** attribute of the RootDSE object.</span></span>
5.  <span data-ttu-id="4313a-120">結果集中其餘的 [**交叉引用**](/windows/desktop/ADSchema/c-crossref) 物件全都代表應用程式目錄分割。</span><span class="sxs-lookup"><span data-stu-id="4313a-120">The remaining [**crossRef**](/windows/desktop/ADSchema/c-crossref) objects in the result set all represent application directory partitions.</span></span>

 

 