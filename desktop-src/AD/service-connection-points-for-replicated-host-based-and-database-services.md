---
title: 複寫、主機和資料庫服務的服務連接點
description: 當您使用服務連接點發佈服務時 (SCP) ，請考慮用戶端如何找到服務的 SCP。
ms.assetid: 944e8ecd-f8ea-4506-992c-bbbfc82d11f3
ms.tgt_platform: multiple
keywords:
- 複寫、主機型和資料庫服務 AD 的服務連接點
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 63b69491dd84a9367f8fd05e9d23ca771551dfbb
ms.sourcegitcommit: 803f3ccd65bdefe36bd851b9c6e7280be9489016
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/17/2020
ms.locfileid: "104023217"
---
# <a name="service-connection-points-for-replicated-host-based-and-database-services"></a><span data-ttu-id="948b6-104">複寫、主機和資料庫服務的服務連接點</span><span class="sxs-lookup"><span data-stu-id="948b6-104">Service Connection Points for Replicated, Host-based, and Database Services</span></span>

<span data-ttu-id="948b6-105">當您使用服務連接點發佈服務時 (SCP) ，請考慮用戶端如何找到服務的 SCP。</span><span class="sxs-lookup"><span data-stu-id="948b6-105">When you publish a service using a service connection point (SCP), consider how clients will locate the SCP for your service.</span></span> <span data-ttu-id="948b6-106">如果有多個服務實例存在，請考慮用戶端如何使用具有不同功能的類似服務來區別服務與所需的功能。</span><span class="sxs-lookup"><span data-stu-id="948b6-106">If multiple instances of the service exist, consider how clients will distinguish the service with the desired features from similar services with different features.</span></span> <span data-ttu-id="948b6-107">如果您發行複寫的服務，請考慮用戶端將如何選擇複本。</span><span class="sxs-lookup"><span data-stu-id="948b6-107">If you publish a replicated service, consider how a client will choose a replica.</span></span> <span data-ttu-id="948b6-108">本主題討論各種服務類型的這些問題。</span><span class="sxs-lookup"><span data-stu-id="948b6-108">This topic discusses these issues for various types of services.</span></span>

## <a name="replicable-services"></a><span data-ttu-id="948b6-109">可複製服務</span><span class="sxs-lookup"><span data-stu-id="948b6-109">Replicable services</span></span>

<span data-ttu-id="948b6-110">針對可複製服務，服務可以有一或多個實例（或複本），而用戶端不在意它們所連接的複本，因為每一個都提供相同的服務。</span><span class="sxs-lookup"><span data-stu-id="948b6-110">For a replicable service there can be one or many instances, or replicas, of the service, and clients do not care which replica they connect to because each provides the same service.</span></span> <span data-ttu-id="948b6-111">Active Directory Domain Services 是複寫服務的範例：指定網域的所有網域控制站都會保存相同的資料、受限於複寫延遲，並提供相同的服務。</span><span class="sxs-lookup"><span data-stu-id="948b6-111">Active Directory Domain Services are examples of replicated services: all domain controllers for a given domain hold identical data, subject to replication latency, and provide identical services.</span></span>

<span data-ttu-id="948b6-112">可複寫的服務可以將多個複本的 Scp 和其他服務特定物件儲存在單一容器中。</span><span class="sxs-lookup"><span data-stu-id="948b6-112">Replicable services can store the SCPs and other service-specific objects for multiple replicas in a single container.</span></span> <span data-ttu-id="948b6-113">第一個複本的設定應用程式可以建立容器做為本機網域系統容器的子系。</span><span class="sxs-lookup"><span data-stu-id="948b6-113">The setup application for the first replica can create the container as a child of the local domain's System container.</span></span> <span data-ttu-id="948b6-114">如需詳細資訊，請參閱 [在網域系統容器中發行](publishing-in-a-domain-system-container.md)。</span><span class="sxs-lookup"><span data-stu-id="948b6-114">For more information, see [Publishing in a Domain System Container](publishing-in-a-domain-system-container.md).</span></span> <span data-ttu-id="948b6-115">確定容器的安全描述項允許後續複本的安裝程式在相同的容器中建立其物件。</span><span class="sxs-lookup"><span data-stu-id="948b6-115">Ensure that the security descriptor for your container allows the setup programs for subsequent replicas to create their objects in the same container.</span></span> <span data-ttu-id="948b6-116">授與安裝系統管理員的許可權，以指定可建立或修改容器中物件的使用者或群組。</span><span class="sxs-lookup"><span data-stu-id="948b6-116">Grant permissions for the installing administrator to specify the users or groups that can create or modify objects in the container.</span></span>

<span data-ttu-id="948b6-117">可複製服務的其中一個策略是為每個複本建立 SCP。</span><span class="sxs-lookup"><span data-stu-id="948b6-117">One strategy for a replicable service is to create an SCP for each replica.</span></span> <span data-ttu-id="948b6-118">當用戶端查詢服務的產品 GUID 或其他標識關鍵字時，它會尋找所有複本的 SCP 物件，並隨機選取一個或使用某些負載平衡演算法。</span><span class="sxs-lookup"><span data-stu-id="948b6-118">When a client queries for the service's product GUID or other identifying keyword, it finds the SCP objects for all replicas and selects one at random or using some load-balancing algorithm.</span></span> <span data-ttu-id="948b6-119">例如，系統管理員可以指定每個複本的優先順序和負載平衡資料，類似于 DNS SRV 記錄的優先順序和權數位段。</span><span class="sxs-lookup"><span data-stu-id="948b6-119">For example, an administrator could specify priority and load-balancing data for each replica, similar to the priority and weight fields of a DNS SRV record.</span></span> <span data-ttu-id="948b6-120">服務的安裝應用程式可以將此資料儲存在每個複本 SCP 的 **serviceBindingInformation** 屬性中。</span><span class="sxs-lookup"><span data-stu-id="948b6-120">The service's setup application can store this data in the **serviceBindingInformation** attribute of each replica's SCP.</span></span> <span data-ttu-id="948b6-121">用戶端會從每個 SCP 取出資料，並使用它來選取複本。</span><span class="sxs-lookup"><span data-stu-id="948b6-121">Clients retrieve the data from each SCP and use it to select a replica.</span></span>

<span data-ttu-id="948b6-122">另一種策略是為所有複本建立單一 SCP，並將 SCP **serviceDNSName** 屬性設定為 DNS SRV 記錄的名稱。</span><span class="sxs-lookup"><span data-stu-id="948b6-122">Another strategy is to create a single SCP for all replicas and set the SCP **serviceDNSName** attribute to the name of a DNS SRV record.</span></span> <span data-ttu-id="948b6-123">接著，每個複本的設定應用程式會使用該名稱註冊 SRV 記錄。</span><span class="sxs-lookup"><span data-stu-id="948b6-123">Then the setup application for each replica registers a SRV record with that name.</span></span> <span data-ttu-id="948b6-124">當用戶端識別服務的獨立 SCP 時，用戶端會抓取 SRV 記錄的名稱，並使用 [**DnsQuery**](/windows/desktop/api/windns/nf-windns-dnsquery_a) 函式來取得複本的 srv 記錄陣列。</span><span class="sxs-lookup"><span data-stu-id="948b6-124">When a client identifies the service's lone SCP, the client retrieves the name of the SRV record and uses the [**DnsQuery**](/windows/desktop/api/windns/nf-windns-dnsquery_a) function to retrieve the array of SRV records for the replicas.</span></span> <span data-ttu-id="948b6-125">每個 SRV 記錄包含主機電腦的名稱，以及用戶端可用來選取複本的其他資料。</span><span class="sxs-lookup"><span data-stu-id="948b6-125">Each SRV record contains the name of a host computer and additional data that the client can use to select a replica.</span></span>

## <a name="database-services"></a><span data-ttu-id="948b6-126">資料庫服務</span><span class="sxs-lookup"><span data-stu-id="948b6-126">Database services</span></span>

<span data-ttu-id="948b6-127">資料庫服務的不同實例可能包含完全不同的資料，即使它們都是相同類型的服務，通常稱為服務類別。</span><span class="sxs-lookup"><span data-stu-id="948b6-127">Different instances of a database service may contain entirely different data, even though they are all the same kind of service, usually called service class.</span></span> <span data-ttu-id="948b6-128">若要發行這類服務，SCP 的 **關鍵字** 屬性可以識別服務類別和特定的資料庫。</span><span class="sxs-lookup"><span data-stu-id="948b6-128">To publish this kind of service, the **keywords** attribute of the SCP can identify both the service class and the specific database.</span></span> <span data-ttu-id="948b6-129">一般用途的用戶端只知道服務類別的 GUID 可以查詢該服務類別所發行的所有資料庫，然後呈現使用者介面，讓使用者可以選取其中一個。</span><span class="sxs-lookup"><span data-stu-id="948b6-129">A general-purpose client that knows only the GUID of the service class can query for all databases published by that service class, and then present a user interface to allow the user to select one.</span></span> <span data-ttu-id="948b6-130">對於專門針對目標資料庫所設計的用戶端，您可以在用戶端程式代碼中將資料庫 GUID 硬式編碼。</span><span class="sxs-lookup"><span data-stu-id="948b6-130">For a client that is designed specifically for the target database, you can hard-code the database GUID into the client code.</span></span>

## <a name="host-based-services"></a><span data-ttu-id="948b6-131">以主機為基礎的服務</span><span class="sxs-lookup"><span data-stu-id="948b6-131">Host-based services</span></span>

<span data-ttu-id="948b6-132">以主機為基礎的服務是與單一主機電腦緊密系結的服務。</span><span class="sxs-lookup"><span data-stu-id="948b6-132">Host-based services are services that are closely tied to a single host computer.</span></span> <span data-ttu-id="948b6-133">您可以在多部電腦上安裝服務類別的實例，而且每個實例都會提供使用其主機電腦識別的服務。</span><span class="sxs-lookup"><span data-stu-id="948b6-133">You can install instances of the service class on many computers and each instance provides services that are identified with its host computer.</span></span>

<span data-ttu-id="948b6-134">以主機為基礎的服務的每個實例都應該在其主機的電腦物件下建立自己的 SCP。</span><span class="sxs-lookup"><span data-stu-id="948b6-134">Each instance of a host-based service should create its own SCP under the computer object of its host.</span></span> <span data-ttu-id="948b6-135">使用產品 GUID 來搜尋主機服務之 SCP 的用戶端，通常會在整個企業樹系中尋找服務類別的許多實例。</span><span class="sxs-lookup"><span data-stu-id="948b6-135">Clients who use a product GUID to search for the SCP of a host-based service typically find many instances of the service class throughout the enterprise forest.</span></span> <span data-ttu-id="948b6-136">然後，用戶端可以使用 Scp 的 **serviceDNSName** 屬性，在所需的主機電腦上尋找服務實例的 SCP。</span><span class="sxs-lookup"><span data-stu-id="948b6-136">Clients can then use the **serviceDNSName** attribute of the SCPs to find the SCP for the service instance on the desired host computer.</span></span>

 

 