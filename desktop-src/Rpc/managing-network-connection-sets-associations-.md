---
title: 管理 (關聯) 的網路連接集
description: 從 Windows 2000 開始，RPC 執行時間可能會在用戶端與伺服器之間維護一個以上的連線。
ms.assetid: 9b9c42e9-8ed5-46a6-b6ec-4093ce0128bb
keywords:
- 管理網路連接集
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 81e99afe23d90e44d85dc7a2ec9301b45e1f20b1
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 09/16/2019
ms.locfileid: "104183860"
---
# <a name="managing-network-connection-sets-associations"></a>管理 (關聯) 的網路連接集

從 Windows 2000 開始，RPC 執行時間可能會在用戶端與伺服器之間維護一個以上的連線。 這有助於在不需要重新建立連線、多執行緒用戶端和非同步用戶端的情況下，于不支援變更用戶端身分識別的傳輸上進行操作。 用戶端進程與伺服器端點之間的連接集合稱為 RPC 術語中的 *關聯* 。 瞭解關聯可以改善 RPC 的實作為。

在單一線程的單一用戶端身分識別案例中，RPC 會開啟用戶端進程與伺服器端點之間的一個連接，以進行 RPC 呼叫。 進行同步 RPC 呼叫時，用戶端會在此連線上將要求傳送至伺服器，並在其上接收回複。 當用戶端進程中進行 RPC 呼叫的執行緒數目增加時，用戶端的安全性識別可以變更。 當非同步/管道呼叫與用戶端上的同步呼叫混合時，RPC 可能需要一個以上的網路連接。 集合中的所有連接都會放在名為關聯的連接集區中。

同步遠端程序呼叫會以獨佔方式使用指定的連接來符合 RPC 標準。 如果傳送了要求，但尚未收到回應，則同步 RPC 呼叫所使用的連接會被視為忙碌。 在收到回應之前，該連接上不允許任何其他流量。 RPC 執行時間會嘗試在相同連接上多工的非同步和管線 RPC 呼叫。 同步和非同步/管道呼叫無法在相同的連接上混用，這表示指定的連接可用於同步 RPC 呼叫或非同步/管道 RPC 呼叫。

RPC 積極地嘗試重複使用來自集區的連接。 進行新的 RPC 呼叫時，RPC 會嘗試從集區尋找適當的連接，而且只有在找不到適合的連接時，才會建立新的連接。 若要將連線視為適當，則必須：

-    (同步或非同步/管道) 的適當類型。
-   免費。
-   具有與進行呼叫的系結控制碼相同的安全性識別。 如果使用動態身分識別追蹤，系結控制碼的識別會從呼叫開頭的執行緒 token 重新整理。 如果使用靜態身分識別追蹤，則會使用系結控制碼上戳記的用戶端身分識別。

當呼叫完成時，一旦收到回應，就會將連接標示為可用，並可用於其他 RPC 呼叫。

連接上的安全性識別無法變更。 例如，如果在不同的安全性識別下對相同的伺服器進行大量呼叫，執行緒集區中的連接數目就會增加。 關聯本身為參考計數，而且當所有參考都消失時，就會停止並關閉所有連接。 每個系結控制碼和每個內容控制碼都會保留關聯的參考。 當全部關閉時，關聯就會消失。 在 Windows XP 上，關聯不一定會立即消失;它們可能會保留一小段時間， (目標期間為20秒，但是如果沒有可用的執行緒可執行工作) ，則 RPC 執行時間可能會選擇延遲終結關聯。 如果您不希望在最後一個內容控制碼/系結控制碼關閉之後讓關聯保持運作，請使用 RPC \_ C \_ OPT 未 \_ \_ 逗留選項強制 rpc 執行時間立即關閉連接。

 

 




