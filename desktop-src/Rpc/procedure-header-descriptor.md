---
title: 程式標頭描述元
description: 在 NDR 引擎的存留期內，標頭已延伸數次。 根據編譯器的模式，目前的編譯器仍會產生不同的標頭。 不過，較新的標頭是較舊的標頭的超集合。
ms.assetid: 05b152b9-bd6d-49d1-8484-d104949c67b1
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: fd9572c9a29ea8477f1d06d8786d50f6abf920de140b6d1663c2431b2ad0c76f
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/11/2021
ms.locfileid: "118927129"
---
# <a name="procedure-header-descriptor"></a>程式標頭描述元

在 NDR 引擎的存留期內，標頭已延伸數次。 根據編譯器的模式，目前的編譯器仍會產生不同的標頭。 不過，較新的標頭是較舊的標頭的超集合。

## <a name="the-old-oi-header"></a>舊的– Oi 標頭

標頭的格式如下：

``` syntax
handle_type<1> 
Oi_flags<1>
[rpc_flags<4>]
proc_num<2>  
stack_size<2>
[explicit_handle_description<>]
```

其中 \_<1> 的控制碼類型可以是下表所示的其中一個值。



| Hex | Handle               |
|-----|----------------------|
| 31  | FC \_ BIND \_ 泛型    |
| 32  | FC 系結 \_ \_ 基本  |
| 33  | FC \_ 自動 \_ 處理     |
| 34  | FC \_ 回呼 \_ 控制碼 |
| 0   |  (明確的控制碼)     |



 

如果控制碼 \_ 類型<1> 欄位為非零值，則程式會使用指定種類的隱含控制碼。 如需詳細資訊，請參閱「 [控制碼](handles.md) 」主題。 如果控制碼 \_ 類型<1> 欄位為零，則用於系結的控制碼就是該程式的其中一個參數。

明確控制碼可以是基本、泛型和內容;最後一個具有下列 FC 權杖。



| Hex | Handle            |
|-----|-------------------|
| 30  | FC 系結 \_ \_ 內容 |



 

依照慣例，DCOM 介面的控制碼類型為 FC \_ 自動 \_ 處理。

Oi \_ 旗標<1> 欄位是下列旗標的8位遮罩。



| Hex | 旗標                         | 意義                                  |
|-----|------------------------------|------------------------------------------|
| 01  | 已 \_ 使用的 Oi 完整 \_ PTR \_          | 使用完整的指標封裝。           |
| 02  | 使用的 Oi \_ RPCSS 配置 \_ \_       | 使用「RpcSs 記憶體」套件。           |
| 04  | Oi \_ 物件 \_ 進程             | 物件介面中的程式。      |
| 08  | Oi \_ 有 \_ RPCFLAGS            | 此程式有非零的 Rpc 旗標。     |
| 10  | Oi\_\*                       | 多載。                              |
| 20  | Oi\_\*                       | 多載。                              |
| 40  | Oi \_ 使用 \_ 新的 \_ INIT \_ 常式 | 使用 Windows NT 3.5 Beta2 + init 常式。 |
| 80  |                              | 未使用的。                                  |



 

以下是多載的旗標。



| Hex | 旗標                                    | 意義                                             |
|-----|-----------------------------------------|-----------------------------------------------------|
| 10  | \_使用編碼 \_                        | 只能在 pickling 中使用。                              |
| 20  | \_使用解碼 \_                        | 只能在 pickling 中使用。                              |
| 10  | Oi \_ 忽略 \_ 物件 \_ 例外狀況 \_ 處理 | 不再使用 (舊的 OLE) 。                         |
| 20  | Oi \_ 有 \_ 通訊 \_ 或 \_ 錯誤                | 僅限原始 RPC、 \[ 通訊 \_ 、錯誤 \_ 狀態 \] 。        |
| 20  | Oi \_ OBJ \_ 使用 \_ V2 \_ 解譯器           | 在僅限 DCOM 中，請使用 [**– Oif**](/windows/desktop/Midl/-oi) 解譯器。 |



 

Rpc \_ 旗標<4> 欄位說明如何設定 [**rpc \_ 訊息**](/windows/desktop/api/RpcdceP/ns-rpcdcep-rpc_message)結構的 **RpcFlags** 欄位。 只有當 Oi \_ 旗標<1> 欄位有 oi 已 \_ 設定 RPCFLAGS 時，才會出現此欄位 \_ 。 如果這個欄位不存在，則遠端程式的 RPC 旗標為零。

> [!Note]  
> 針對效能，非同步解譯器一律會有 \_<4> 欄位的 rpc 旗標。

 

[Proc \_ num<2>] 欄位提供程式的程式編號。

堆疊 \_ 大小<2> 提供堆疊上所有參數的總大小，包括此指標和/或傳回值。

\_ \_ 本檔稍後會說明<> 欄位的明確控制碼描述。 如果程式使用隱含控制碼，就不會出現這個欄位。

 

 