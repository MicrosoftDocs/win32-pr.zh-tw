---
title: 長度、大小和方向屬性
description: 在用戶端和伺服器之間傳遞陣列時，與大小相關的屬性 \ max \_ 是 \，而 \ 大小 \_ 是 \ 判斷伺服器 stub 配置多少陣列元素。
ms.assetid: 2c95cf47-6fc0-4ccd-bb4f-acf356596e56
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 98ffbf1ac75ad82a89e258ab595590fce2190b9e
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/20/2020
ms.locfileid: "103682859"
---
# <a name="length-size-and-directional-attributes"></a><span data-ttu-id="ec9af-103">長度、大小和方向屬性</span><span class="sxs-lookup"><span data-stu-id="ec9af-103">Length, Size, and Directional Attributes</span></span>

<span data-ttu-id="ec9af-104">在用戶端和伺服器之間傳遞陣列時，大小相關屬性 \[ [**最大值 \_ 為**](/windows/desktop/Midl/max-is) \] ，而 \[ [**大小 \_ 則是**](/windows/desktop/Midl/size-is) \] 決定伺服器 stub 配置多少陣列元素。</span><span class="sxs-lookup"><span data-stu-id="ec9af-104">In passing arrays between the client and the server, the size-related attributes \[[**max\_is**](/windows/desktop/Midl/max-is)\] and \[[**size\_is**](/windows/desktop/Midl/size-is)\] determine how many array elements the server stub allocates.</span></span> <span data-ttu-id="ec9af-105">長度相關的屬性 \[ [**長度 \_ 為**](/windows/desktop/Midl/length-is) \] ， \[ [**第一個 \_ 是**](/windows/desktop/Midl/first-is) \] ，而 \[ [**最後一個則 \_ 是**](/windows/desktop/Midl/last-is) \] 決定要將多少專案傳送至伺服器和用戶端。</span><span class="sxs-lookup"><span data-stu-id="ec9af-105">The length-related attributes \[[**length\_is**](/windows/desktop/Midl/length-is)\], \[[**first\_is**](/windows/desktop/Midl/first-is)\], and \[[**last\_is**](/windows/desktop/Midl/last-is)\] determine how many elements are transmitted to both the server and the client.</span></span>

<span data-ttu-id="ec9af-106">不同的方向屬性可以套用至參數。</span><span class="sxs-lookup"><span data-stu-id="ec9af-106">Different directional attributes can be applied to parameters.</span></span> <span data-ttu-id="ec9af-107">不過，某些方向屬性組合可能會造成錯誤。</span><span class="sxs-lookup"><span data-stu-id="ec9af-107">However, some combinations of directional attributes can cause errors.</span></span> <span data-ttu-id="ec9af-108">例如，假設您要撰寫的介面指定具有兩個參數的程式、陣列，以及陣列的傳輸長度。</span><span class="sxs-lookup"><span data-stu-id="ec9af-108">As an example, suppose you are writing an interface that specifies a procedure with two parameters, an array, and the transmitted length of the array.</span></span> <span data-ttu-id="ec9af-109">*Dir \_ attr* 一詞是指套用至參數的方向屬性，如下所示：</span><span class="sxs-lookup"><span data-stu-id="ec9af-109">The term *dir\_attr* refers to the directional attribute applied to the parameter as:</span></span>

``` syntax
Proc1(
    [dir_attr] short *plength;
    [dir_attr, length_is(pLength)] short array[MAX_SIZE]);
```

<span data-ttu-id="ec9af-110">下表說明每個方向屬性組合的 MIDL 編譯器行為。</span><span class="sxs-lookup"><span data-stu-id="ec9af-110">The MIDL compiler behavior for each combination of directional attributes is described in the following table.</span></span>



| <span data-ttu-id="ec9af-111">Array</span><span class="sxs-lookup"><span data-stu-id="ec9af-111">Array</span></span>                                          | <span data-ttu-id="ec9af-112">Length 參數</span><span class="sxs-lookup"><span data-stu-id="ec9af-112">Length parameter</span></span>                               | <span data-ttu-id="ec9af-113">從用戶端到伺服器的呼叫期間的存根動作</span><span class="sxs-lookup"><span data-stu-id="ec9af-113">Stub actions during call from client to server</span></span>                                                                                                                                                                                                                          | <span data-ttu-id="ec9af-114">從伺服器回到用戶端時的存根動作</span><span class="sxs-lookup"><span data-stu-id="ec9af-114">Stub actions on return from server to client</span></span>                                                                                                                                                                         |
|------------------------------------------------|------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="ec9af-115">\[[**在**](/windows/desktop/Midl/in)\]</span><span class="sxs-lookup"><span data-stu-id="ec9af-115">\[[**in**](/windows/desktop/Midl/in)\]</span></span>                          | <span data-ttu-id="ec9af-116">\[[**在**](/windows/desktop/Midl/in)\]</span><span class="sxs-lookup"><span data-stu-id="ec9af-116">\[[**in**](/windows/desktop/Midl/in)\]</span></span>                          | <span data-ttu-id="ec9af-117">傳輸參數所指示的長度和元素數目。</span><span class="sxs-lookup"><span data-stu-id="ec9af-117">Transmit the length and the number of elements indicated by the parameter.</span></span>                                                                                                                                                                                              | <span data-ttu-id="ec9af-118">未傳送任何資料。</span><span class="sxs-lookup"><span data-stu-id="ec9af-118">No data transmitted.</span></span>                                                                                                                                                                                                 |
| <span data-ttu-id="ec9af-119">\[[**在**](/windows/desktop/Midl/in)\]</span><span class="sxs-lookup"><span data-stu-id="ec9af-119">\[[**in**](/windows/desktop/Midl/in)\]</span></span>                          | <span data-ttu-id="ec9af-120">\[[**擴展**](/windows/desktop/Midl/out-idl)\]</span><span class="sxs-lookup"><span data-stu-id="ec9af-120">\[[**out**](/windows/desktop/Midl/out-idl)\]</span></span>                    | <span data-ttu-id="ec9af-121">不合法;MIDL 編譯器錯誤。</span><span class="sxs-lookup"><span data-stu-id="ec9af-121">Not legal; MIDL compiler error.</span></span>                                                                                                                                                                                                                                         | <span data-ttu-id="ec9af-122">不合法;MIDL 編譯器錯誤。</span><span class="sxs-lookup"><span data-stu-id="ec9af-122">Not legal; MIDL compiler error.</span></span>                                                                                                                                                                                      |
| <span data-ttu-id="ec9af-123">\[[**在**](/windows/desktop/Midl/in)\]</span><span class="sxs-lookup"><span data-stu-id="ec9af-123">\[[**in**](/windows/desktop/Midl/in)\]</span></span>                          | <span data-ttu-id="ec9af-124">\[[**in**](/windows/desktop/Midl/in)、 [ **out**](/windows/desktop/Midl/out-idl)\]</span><span class="sxs-lookup"><span data-stu-id="ec9af-124">\[[**in**](/windows/desktop/Midl/in), [**out**](/windows/desktop/Midl/out-idl)\]</span></span> | <span data-ttu-id="ec9af-125">傳送 length 參數所指示的長度和元素數。</span><span class="sxs-lookup"><span data-stu-id="ec9af-125">Transmit the length and the number of elements indicated by the length parameter.</span></span>                                                                                                                                                                                       | <span data-ttu-id="ec9af-126">只傳輸長度。</span><span class="sxs-lookup"><span data-stu-id="ec9af-126">Transmit the length only.</span></span>                                                                                                                                                                                            |
| <span data-ttu-id="ec9af-127">\[[**擴展**](/windows/desktop/Midl/out-idl)\]</span><span class="sxs-lookup"><span data-stu-id="ec9af-127">\[[**out**](/windows/desktop/Midl/out-idl)\]</span></span>                    | <span data-ttu-id="ec9af-128">\[[**在**](/windows/desktop/Midl/in)\]</span><span class="sxs-lookup"><span data-stu-id="ec9af-128">\[[**in**](/windows/desktop/Midl/in)\]</span></span>                          | <span data-ttu-id="ec9af-129">傳輸長度。</span><span class="sxs-lookup"><span data-stu-id="ec9af-129">Transmit the length.</span></span><br/> <span data-ttu-id="ec9af-130">如果陣列大小是固定的，請在伺服器上配置陣列大小，但不傳輸任何元素。</span><span class="sxs-lookup"><span data-stu-id="ec9af-130">If array size is fixed, allocate the array size on the server, but transmit no elements.</span></span><br/> <span data-ttu-id="ec9af-131">如果陣列大小未系結，則不是合法： MIDL 編譯器錯誤。</span><span class="sxs-lookup"><span data-stu-id="ec9af-131">If array size is not bound, not legal: MIDL compiler error.</span></span><br/>                                                              | <span data-ttu-id="ec9af-132">傳輸長度所指出的元素數目。</span><span class="sxs-lookup"><span data-stu-id="ec9af-132">Transmit the number of elements indicated by the length.</span></span><br/> <span data-ttu-id="ec9af-133">請注意，您可以變更長度，而且在用戶端上的值可以有不同的值。</span><span class="sxs-lookup"><span data-stu-id="ec9af-133">Note that the length can be changed and can have a different value from the value on the client.</span></span> <span data-ttu-id="ec9af-134">請勿傳輸長度。</span><span class="sxs-lookup"><span data-stu-id="ec9af-134">Do not transmit the length.</span></span><br/>          |
| <span data-ttu-id="ec9af-135">\[[**擴展**](/windows/desktop/Midl/out-idl)\]</span><span class="sxs-lookup"><span data-stu-id="ec9af-135">\[[**out**](/windows/desktop/Midl/out-idl)\]</span></span>                    | <span data-ttu-id="ec9af-136">\[[**擴展**](/windows/desktop/Midl/out-idl)\]</span><span class="sxs-lookup"><span data-stu-id="ec9af-136">\[[**out**](/windows/desktop/Midl/out-idl)\]</span></span>                    | <span data-ttu-id="ec9af-137">在伺服器上配置長度參數的空間，但不傳輸參數。</span><span class="sxs-lookup"><span data-stu-id="ec9af-137">Allocate space for the length parameter on the server but do not transmit the parameter.</span></span> <span data-ttu-id="ec9af-138">如果陣列大小是固定的，請在伺服器上配置陣列大小，但不傳輸任何專案。</span><span class="sxs-lookup"><span data-stu-id="ec9af-138">If the array size is fixed, allocate the array size on the server, but transmit no elements.</span></span><br/> <span data-ttu-id="ec9af-139">如果陣列大小不是固定的，則不是合法： MIDL 編譯器錯誤。</span><span class="sxs-lookup"><span data-stu-id="ec9af-139">If array size is not fixed, not legal: MIDL compiler error.</span></span><br/> | <span data-ttu-id="ec9af-140">傳輸由伺服器應用程式所設定的長度所指定的專案長度和元素數目。</span><span class="sxs-lookup"><span data-stu-id="ec9af-140">Transmit the length and the number of elements indicated by the length as set by the server application.</span></span>                                                                                                             |
| <span data-ttu-id="ec9af-141">\[[**擴展**](/windows/desktop/Midl/out-idl)\]</span><span class="sxs-lookup"><span data-stu-id="ec9af-141">\[[**out**](/windows/desktop/Midl/out-idl)\]</span></span>                    | <span data-ttu-id="ec9af-142">\[[**in**](/windows/desktop/Midl/in)、 [ **out**](/windows/desktop/Midl/out-idl)\]</span><span class="sxs-lookup"><span data-stu-id="ec9af-142">\[[**in**](/windows/desktop/Midl/in), [**out**](/windows/desktop/Midl/out-idl)\]</span></span> | <span data-ttu-id="ec9af-143">傳輸長度參數。</span><span class="sxs-lookup"><span data-stu-id="ec9af-143">Transmit the length parameter.</span></span> <span data-ttu-id="ec9af-144">如果陣列大小已系結，請在伺服器上配置陣列大小，但不傳輸任何元素。</span><span class="sxs-lookup"><span data-stu-id="ec9af-144">If the array size is bound, allocate the array size on the server, but transmit no elements.</span></span><br/> <span data-ttu-id="ec9af-145">如果陣列大小未系結，則不是合法： MIDL 編譯器錯誤。</span><span class="sxs-lookup"><span data-stu-id="ec9af-145">If array size is not bound, not legal: MIDL compiler error.</span></span><br/>                                                           | <span data-ttu-id="ec9af-146">傳輸長度。</span><span class="sxs-lookup"><span data-stu-id="ec9af-146">Transmit the length.</span></span> <span data-ttu-id="ec9af-147">傳輸長度所指出的陣列元素數目。</span><span class="sxs-lookup"><span data-stu-id="ec9af-147">Transmit the number of array elements indicated by the length.</span></span><br/>                                                                                                                       |
| <span data-ttu-id="ec9af-148">\[[**in**](/windows/desktop/Midl/in)、 [ **out**](/windows/desktop/Midl/out-idl)\]</span><span class="sxs-lookup"><span data-stu-id="ec9af-148">\[[**in**](/windows/desktop/Midl/in), [**out**](/windows/desktop/Midl/out-idl)\]</span></span> | <span data-ttu-id="ec9af-149">\[[**在**](/windows/desktop/Midl/in)\]</span><span class="sxs-lookup"><span data-stu-id="ec9af-149">\[[**in**](/windows/desktop/Midl/in)\]</span></span>                          | <span data-ttu-id="ec9af-150">傳輸參數所指示的長度和元素數目。</span><span class="sxs-lookup"><span data-stu-id="ec9af-150">Transmit the length and the number of elements indicated by the parameter.</span></span>                                                                                                                                                                                              | <span data-ttu-id="ec9af-151">請勿傳輸長度。</span><span class="sxs-lookup"><span data-stu-id="ec9af-151">Do not transmit the length.</span></span> <span data-ttu-id="ec9af-152">傳輸長度所指出的元素數目。</span><span class="sxs-lookup"><span data-stu-id="ec9af-152">Transmit the number of elements indicated by the length.</span></span><br/> <span data-ttu-id="ec9af-153">請注意，長度可以變更，而且在用戶端上的原始值可以有不同的值。</span><span class="sxs-lookup"><span data-stu-id="ec9af-153">Note that the length can be changed and can have a different value from the original value on the client.</span></span><br/> |
| <span data-ttu-id="ec9af-154">\[[**in**](/windows/desktop/Midl/in)、 [ **out**](/windows/desktop/Midl/out-idl)\]</span><span class="sxs-lookup"><span data-stu-id="ec9af-154">\[[**in**](/windows/desktop/Midl/in), [**out**](/windows/desktop/Midl/out-idl)\]</span></span> | <span data-ttu-id="ec9af-155">\[[**擴展**](/windows/desktop/Midl/out-idl)\]</span><span class="sxs-lookup"><span data-stu-id="ec9af-155">\[[**out**](/windows/desktop/Midl/out-idl)\]</span></span>                    | <span data-ttu-id="ec9af-156">不合法;MIDL 編譯器錯誤。</span><span class="sxs-lookup"><span data-stu-id="ec9af-156">Not legal; MIDL compiler error.</span></span>                                                                                                                                                                                                                                         | <span data-ttu-id="ec9af-157">不合法;MIDL 編譯器錯誤。</span><span class="sxs-lookup"><span data-stu-id="ec9af-157">Not legal; MIDL compiler error.</span></span>                                                                                                                                                                                      |
| <span data-ttu-id="ec9af-158">\[[**in**](/windows/desktop/Midl/in)、 [ **out**](/windows/desktop/Midl/out-idl)\]</span><span class="sxs-lookup"><span data-stu-id="ec9af-158">\[[**in**](/windows/desktop/Midl/in), [**out**](/windows/desktop/Midl/out-idl)\]</span></span> | <span data-ttu-id="ec9af-159">\[[**in**](/windows/desktop/Midl/in)、 [ **out**](/windows/desktop/Midl/out-idl)\]</span><span class="sxs-lookup"><span data-stu-id="ec9af-159">\[[**in**](/windows/desktop/Midl/in), [**out**](/windows/desktop/Midl/out-idl)\]</span></span> | <span data-ttu-id="ec9af-160">傳輸參數所指示的長度和元素數目。</span><span class="sxs-lookup"><span data-stu-id="ec9af-160">Transmit the length and the number of elements indicated by the parameter.</span></span>                                                                                                                                                                                              | <span data-ttu-id="ec9af-161">傳輸參數所指示的長度和元素數目。</span><span class="sxs-lookup"><span data-stu-id="ec9af-161">Transmit the length and the number of elements indicated by the parameter.</span></span>                                                                                                                                           |



 

<span data-ttu-id="ec9af-162">一般而言，您不應該在伺服器端修改長度或大小參數。</span><span class="sxs-lookup"><span data-stu-id="ec9af-162">In general, you should not modify the length or size parameters on the server side.</span></span> <span data-ttu-id="ec9af-163">如果您變更長度參數，則可以是孤立的記憶體。</span><span class="sxs-lookup"><span data-stu-id="ec9af-163">If you change the length parameter, you can orphan memory.</span></span> <span data-ttu-id="ec9af-164">如需詳細資訊，請參閱 [記憶體損壞](memory-orphaning.md)。</span><span class="sxs-lookup"><span data-stu-id="ec9af-164">For more information, see [Memory Orphaning](memory-orphaning.md).</span></span>

 

