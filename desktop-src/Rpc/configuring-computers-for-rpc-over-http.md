---
title: 設定 RPC over HTTP 的電腦
description: 若要使用 HTTP 做為 RPC 的傳輸通訊協定，在 Internet Information Server 內執行的 RPC Proxy (IIS) 必須在伺服器程式的網路上設定。
ms.assetid: 5a67af51-924a-4f2b-b013-a4fd1bfaeddd
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 62d1b39276633f3b827f778deef77edd5630c599
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 09/16/2019
ms.locfileid: "106966194"
---
# <a name="configuring-computers-for-rpc-over-http"></a><span data-ttu-id="dfaad-103">設定 RPC over HTTP 的電腦</span><span class="sxs-lookup"><span data-stu-id="dfaad-103">Configuring Computers for RPC over HTTP</span></span>

<span data-ttu-id="dfaad-104">若要使用 HTTP 做為 RPC 的傳輸通訊協定，在 Internet Information Server 內執行的 RPC Proxy (IIS) 必須在伺服器程式的網路上設定。</span><span class="sxs-lookup"><span data-stu-id="dfaad-104">To use HTTP as a transport protocol for RPC, RPC Proxy running within Internet Information Server (IIS) must be configured on the server program's network.</span></span> <span data-ttu-id="dfaad-105">本節說明設定選項。</span><span class="sxs-lookup"><span data-stu-id="dfaad-105">This section describes configuration options.</span></span> <span data-ttu-id="dfaad-106">如需使用 RPC over HTTP 時最佳程式設計和設定作法的建議，請參閱 [RPC OVER Http 部署建議](rpc-over-http-deployment-recommendations.md)。</span><span class="sxs-lookup"><span data-stu-id="dfaad-106">For recommendations on best programming and configuration practices when using RPC over HTTP, see [RPC over HTTP Deployment Recommendations](rpc-over-http-deployment-recommendations.md).</span></span> <span data-ttu-id="dfaad-107">主要工作是設定 RPC Proxy，以接受 rpc over HTTP 連線，並將其轉送至 RPC over HTTP 伺服器程式。</span><span class="sxs-lookup"><span data-stu-id="dfaad-107">The primary task is configuring the RPC Proxy to accept and forward RPC over HTTP connections to an RPC over HTTP server program.</span></span>

<span data-ttu-id="dfaad-108">IIS 必須先安裝在執行 RPC Proxy 的電腦上。</span><span class="sxs-lookup"><span data-stu-id="dfaad-108">IIS must first be installed on the machine running the RPC Proxy.</span></span> <span data-ttu-id="dfaad-109">安裝 IIS 之後，會安裝 RPC Proxy。</span><span class="sxs-lookup"><span data-stu-id="dfaad-109">Once IIS is installed, the RPC Proxy is installed.</span></span> <span data-ttu-id="dfaad-110">您可以同時從主控台中的 [ **新增/移除 Windows 元件** ] 安裝 IIS 和 RPC Proxy。</span><span class="sxs-lookup"><span data-stu-id="dfaad-110">Both IIS and the RPC Proxy can be installed simultaneously from **Add/Remove Windows Components** in the Control Panel.</span></span> <span data-ttu-id="dfaad-111">RPC Proxy 是從 **網路服務** 安裝，在 Windows 安裝程式中則是透過 **HTTP proxy 呼叫 rpc** proxy。</span><span class="sxs-lookup"><span data-stu-id="dfaad-111">RPC Proxy is installed from **Networking Services**, and is called **RPC over HTTP Proxy** in Windows setup.</span></span> <span data-ttu-id="dfaad-112">如果同時安裝 IIS 和 RPC Proxy，Windows 會確保以正確的順序安裝它們。</span><span class="sxs-lookup"><span data-stu-id="dfaad-112">If both IIS and RPC Proxy are installed at the same time, Windows ensures they are installed in the proper order.</span></span>

> [!Note]  
> <span data-ttu-id="dfaad-113">安裝完成之後，如果 IIS 是在安裝過程中執行，則必須重新開機。</span><span class="sxs-lookup"><span data-stu-id="dfaad-113">After installation is complete, IIS must be restarted if it was running during the installation process.</span></span>

 

<span data-ttu-id="dfaad-114">在安裝 RPC Proxy 之後，必須執行一些額外的設定工作：</span><span class="sxs-lookup"><span data-stu-id="dfaad-114">After installed of the RPC Proxy, some additional configuration tasks must be performed:</span></span>

1.  <span data-ttu-id="dfaad-115">開啟 IIS MMC 嵌入式管理單元，並將 RPC Proxy 虛擬目錄設定為需要安全性，如 [RPC OVER HTTP 安全性](rpc-over-http-security.md)所述。</span><span class="sxs-lookup"><span data-stu-id="dfaad-115">Open the IIS MMC snap-in and configure the RPC Proxy virtual directory to require security, as explained in [RPC over HTTP Security](rpc-over-http-security.md).</span></span> <span data-ttu-id="dfaad-116">只有當您打算使用 RPC over HTTP v2 時，才需要執行此步驟。</span><span class="sxs-lookup"><span data-stu-id="dfaad-116">This step is required only if you plan to use RPC over HTTP v2.</span></span>
2.  <span data-ttu-id="dfaad-117">如果 IIS 未安裝憑證，則必須取得並安裝該電腦的有效憑證，才能在與 RPC Proxy 通訊時使用 SSL。</span><span class="sxs-lookup"><span data-stu-id="dfaad-117">If IIS does not have a certificate installed, a valid certificate must be obtained and installed for that computer in order to use SSL when communicating with the RPC Proxy.</span></span> <span data-ttu-id="dfaad-118">此步驟僅與 RPC over HTTP v2 相關。</span><span class="sxs-lookup"><span data-stu-id="dfaad-118">This step is relevant only for RPC over HTTP v2.</span></span> <span data-ttu-id="dfaad-119">由於 RPC over HTTP v1 不支援 SSL，因此 RPC over HTTP v1 可以省略此步驟。</span><span class="sxs-lookup"><span data-stu-id="dfaad-119">Since RPC over HTTP v1 does not support SSL, this step can be omitted for RPC over HTTP v1.</span></span>
3.  <span data-ttu-id="dfaad-120">設定 **ValidPorts** 索引鍵，如 [RPC over HTTP 安全性](rpc-over-http-security.md)所述。</span><span class="sxs-lookup"><span data-stu-id="dfaad-120">Set the **ValidPorts** key as described in [RPC over HTTP Security](rpc-over-http-security.md).</span></span>

<span data-ttu-id="dfaad-121">當這些設定工作完成時，RPC over HTTP proxy 就可以將來自 RPC over HTTP 用戶端的要求轉寄至 RPC over HTTP 伺服器。</span><span class="sxs-lookup"><span data-stu-id="dfaad-121">When these configuration tasks are completed, the RPC over HTTP proxy is ready to forward requests from the RPC over HTTP client to the RPC over HTTP server.</span></span>

## <a name="rpc-over-http-registry-keys"></a><span data-ttu-id="dfaad-122">RPC over HTTP 登錄機碼</span><span class="sxs-lookup"><span data-stu-id="dfaad-122">RPC over HTTP Registry Keys</span></span>

<span data-ttu-id="dfaad-123">本節說明在 RPC over HTTP 連線中用來設定用戶端、伺服器或 RPC Proxy 的額外登錄機碼。</span><span class="sxs-lookup"><span data-stu-id="dfaad-123">This section explains additional registry keys used to configure the client, server or RPC Proxy in an RPC over HTTP connection.</span></span> <span data-ttu-id="dfaad-124">通常不需要這些金鑰;這些都是為了完整性而提供。</span><span class="sxs-lookup"><span data-stu-id="dfaad-124">These keys are generally not required; they are provided here for completeness.</span></span>

<span data-ttu-id="dfaad-125">**HKLM \\ Software \\ Microsoft \\ Rpc \\ DefaultChannelLifetime**</span><span class="sxs-lookup"><span data-stu-id="dfaad-125">**HKLM\\Software\\Microsoft\\Rpc\\DefaultChannelLifetime**</span></span>

<span data-ttu-id="dfaad-126">DWORD。</span><span class="sxs-lookup"><span data-stu-id="dfaad-126">DWORD.</span></span> <span data-ttu-id="dfaad-127">覆寫預設通道存留期。</span><span class="sxs-lookup"><span data-stu-id="dfaad-127">Overrides the default channel lifetime.</span></span> <span data-ttu-id="dfaad-128">用於用戶端和 RPC Proxy。</span><span class="sxs-lookup"><span data-stu-id="dfaad-128">Used on the client and the RPC Proxy.</span></span> <span data-ttu-id="dfaad-129">通道存留期是以位元組表示。</span><span class="sxs-lookup"><span data-stu-id="dfaad-129">The channel lifetime is expressed in bytes.</span></span> <span data-ttu-id="dfaad-130">如果未指定，則會使用1GB。</span><span class="sxs-lookup"><span data-stu-id="dfaad-130">If not specified, 1GB is used.</span></span> <span data-ttu-id="dfaad-131">僅用於 RPC over HTTP v2。</span><span class="sxs-lookup"><span data-stu-id="dfaad-131">Used only in RPC over HTTP v2.</span></span> <span data-ttu-id="dfaad-132">在 RPC Proxy 上變更時，必須重新開機 IIS，變更才會生效。</span><span class="sxs-lookup"><span data-stu-id="dfaad-132">When changed on RPC Proxy, IIS must be restarted for the change to take effect.</span></span>

\-

<span data-ttu-id="dfaad-133">**HKLM \\ Software \\ Microsoft \\ Rpc \\ ClientReceiveWindow**</span><span class="sxs-lookup"><span data-stu-id="dfaad-133">**HKLM\\Software\\Microsoft\\Rpc\\ClientReceiveWindow**</span></span>

<span data-ttu-id="dfaad-134">DWORD。</span><span class="sxs-lookup"><span data-stu-id="dfaad-134">DWORD.</span></span> <span data-ttu-id="dfaad-135">如果有的話，會指定用戶端用於從 RPC Proxy 接收之資料的接收視窗。</span><span class="sxs-lookup"><span data-stu-id="dfaad-135">When present, specifies the receive window used by the client for data received from the RPC Proxy.</span></span> <span data-ttu-id="dfaad-136">有效的最小值為8K。</span><span class="sxs-lookup"><span data-stu-id="dfaad-136">The minimum valid value is 8K.</span></span> <span data-ttu-id="dfaad-137">最大值為1GB。</span><span class="sxs-lookup"><span data-stu-id="dfaad-137">The maximum is 1GB.</span></span> <span data-ttu-id="dfaad-138">如果值不存在，則會使用64K。</span><span class="sxs-lookup"><span data-stu-id="dfaad-138">If the value is not present, 64K is used.</span></span> <span data-ttu-id="dfaad-139">僅用於 RPC over HTTP v2。</span><span class="sxs-lookup"><span data-stu-id="dfaad-139">Used only in RPC over HTTP v2.</span></span>

\-

<span data-ttu-id="dfaad-140">**HKLM \\ Software \\ Microsoft \\ Rpc \\ InProxyReceiveWindow**</span><span class="sxs-lookup"><span data-stu-id="dfaad-140">**HKLM\\Software\\Microsoft\\Rpc\\InProxyReceiveWindow**</span></span>

<span data-ttu-id="dfaad-141">DWORD。</span><span class="sxs-lookup"><span data-stu-id="dfaad-141">DWORD.</span></span> <span data-ttu-id="dfaad-142">如果存在，則指定 RPC Proxy 用於從用戶端接收之資料的接收視窗。</span><span class="sxs-lookup"><span data-stu-id="dfaad-142">When present, specifies the receive window used by the RPC Proxy for data received from the client.</span></span> <span data-ttu-id="dfaad-143">有效的最小值為8K。</span><span class="sxs-lookup"><span data-stu-id="dfaad-143">The minimum valid value is 8K.</span></span> <span data-ttu-id="dfaad-144">最大值為1GB。</span><span class="sxs-lookup"><span data-stu-id="dfaad-144">The maximum is 1GB.</span></span> <span data-ttu-id="dfaad-145">如果值不存在，則會使用64K。</span><span class="sxs-lookup"><span data-stu-id="dfaad-145">If the value is not present, 64K is used.</span></span> <span data-ttu-id="dfaad-146">僅用於 RPC over HTTP v2。</span><span class="sxs-lookup"><span data-stu-id="dfaad-146">Used only in RPC over HTTP v2.</span></span> <span data-ttu-id="dfaad-147">變更此值時，必須重新開機 IIS，變更才會生效。</span><span class="sxs-lookup"><span data-stu-id="dfaad-147">When changes are made to this value, IIS must be restarted for the change to take effect.</span></span>

\-

<span data-ttu-id="dfaad-148">**HKLM \\ Software \\ Microsoft \\ Rpc \\ OutProxyReceiveWindow**</span><span class="sxs-lookup"><span data-stu-id="dfaad-148">**HKLM\\Software\\Microsoft\\Rpc\\OutProxyReceiveWindow**</span></span>

<span data-ttu-id="dfaad-149">DWORD。</span><span class="sxs-lookup"><span data-stu-id="dfaad-149">DWORD.</span></span> <span data-ttu-id="dfaad-150">如果有的話，會為從伺服器接收的資料指定 RPC Proxy 所使用的接收視窗。</span><span class="sxs-lookup"><span data-stu-id="dfaad-150">When present, specifies the receive window used by the RPC Proxy for data received from the server.</span></span> <span data-ttu-id="dfaad-151">有效的最小值為8K。</span><span class="sxs-lookup"><span data-stu-id="dfaad-151">The minimum valid value is 8K.</span></span> <span data-ttu-id="dfaad-152">最大值為1GB。</span><span class="sxs-lookup"><span data-stu-id="dfaad-152">The maximum is 1GB.</span></span> <span data-ttu-id="dfaad-153">如果值不存在，則會使用64K。</span><span class="sxs-lookup"><span data-stu-id="dfaad-153">If the value is not present, 64K is used.</span></span> <span data-ttu-id="dfaad-154">僅用於 RPC over HTTP v2。</span><span class="sxs-lookup"><span data-stu-id="dfaad-154">Used only in RPC over HTTP v2.</span></span> <span data-ttu-id="dfaad-155">變更此值時，必須重新開機 IIS，變更才會生效。</span><span class="sxs-lookup"><span data-stu-id="dfaad-155">When changes are made to this value, IIS must be restarted for the change to take effect.</span></span>

\-

<span data-ttu-id="dfaad-156">**HKLM \\ Software \\ Microsoft \\ Rpc \\ ServerReceiveWindow**</span><span class="sxs-lookup"><span data-stu-id="dfaad-156">**HKLM\\Software\\Microsoft\\Rpc\\ServerReceiveWindow**</span></span>

<span data-ttu-id="dfaad-157">DWORD。</span><span class="sxs-lookup"><span data-stu-id="dfaad-157">DWORD.</span></span> <span data-ttu-id="dfaad-158">如果存在，則指定伺服器用於從 RPC Proxy 接收之資料的接收視窗。</span><span class="sxs-lookup"><span data-stu-id="dfaad-158">When present, specifies the receive window used by the server for data received from the RPC Proxy.</span></span> <span data-ttu-id="dfaad-159">有效的最小值為8K。</span><span class="sxs-lookup"><span data-stu-id="dfaad-159">The minimum valid value is 8K.</span></span> <span data-ttu-id="dfaad-160">最大值為1GB。</span><span class="sxs-lookup"><span data-stu-id="dfaad-160">The maximum is 1GB.</span></span> <span data-ttu-id="dfaad-161">如果值不存在，則會使用64K。</span><span class="sxs-lookup"><span data-stu-id="dfaad-161">If the value is not present, 64K is used.</span></span> <span data-ttu-id="dfaad-162">僅用於 RPC over HTTP v2。</span><span class="sxs-lookup"><span data-stu-id="dfaad-162">Used only in RPC over HTTP v2.</span></span> <span data-ttu-id="dfaad-163">變更此值時，必須重新開機 IIS，變更才會生效。</span><span class="sxs-lookup"><span data-stu-id="dfaad-163">When changes are made to this value, IIS must be restarted for the change to take effect.</span></span>

\-

<span data-ttu-id="dfaad-164">**HKLM \\ 軟體 \\ 原則 \\ Microsoft \\ Windows NT \\ Rpc \\ MinimumConnectionTimeout**</span><span class="sxs-lookup"><span data-stu-id="dfaad-164">**HKLM\\Software\\Policies\\Microsoft\\Windows NT\\Rpc\\MinimumConnectionTimeout**</span></span>

<span data-ttu-id="dfaad-165">DWORD。</span><span class="sxs-lookup"><span data-stu-id="dfaad-165">DWORD.</span></span> <span data-ttu-id="dfaad-166">如果存在，則指定用戶端和 RPC Proxy 所使用的最小連接逾時（以秒為單位）。</span><span class="sxs-lookup"><span data-stu-id="dfaad-166">When present, specifies the minimum connection timeout used by the client and RPC Proxy, in seconds.</span></span> <span data-ttu-id="dfaad-167">使用的實際時間是此值的下限，以及 IIS 閒置連接逾時時間。</span><span class="sxs-lookup"><span data-stu-id="dfaad-167">The actual timeout used is the lower of this value and the IIS idle connection timeout.</span></span> <span data-ttu-id="dfaad-168">如果為零，或索引鍵不存在，則會使用 IIS 閒置連接逾時。</span><span class="sxs-lookup"><span data-stu-id="dfaad-168">If zero, or the key is not present, the IIS idle connection timeout is used.</span></span> <span data-ttu-id="dfaad-169">僅用於 RPC over HTTP v2。</span><span class="sxs-lookup"><span data-stu-id="dfaad-169">Used only in RPC over HTTP v2.</span></span> <span data-ttu-id="dfaad-170">在 RPC Proxy 上對這個值進行變更時，必須重新開機 IIS，變更才會生效。</span><span class="sxs-lookup"><span data-stu-id="dfaad-170">When changes are made to this value on the RPC Proxy, IIS must be restarted for the change to take effect.</span></span>

\-

<span data-ttu-id="dfaad-171">**HKLM \\ Software \\ Microsoft \\ Rpc \\ UseProxyForIPAddrIfRDNSFails**</span><span class="sxs-lookup"><span data-stu-id="dfaad-171">**HKLM\\Software\\Microsoft\\Rpc\\UseProxyForIPAddrIfRDNSFails**</span></span>

<span data-ttu-id="dfaad-172">當出現並設定為非零，且以 RPC Proxy 位址提供數值 IP 位址時，RPC over HTTP 用戶端會嘗試反向名稱解析，如果失敗，則會嘗試透過 HTTP proxy 連接到 RPC Proxy。</span><span class="sxs-lookup"><span data-stu-id="dfaad-172">When present and set to non-zero, and a numeric IP address is provided as the RPC Proxy address, an RPC over HTTP client will attempt reverse name resolution and, if that fails, will attempt connection to the RPC Proxy through an HTTP proxy.</span></span> <span data-ttu-id="dfaad-173">可以用來模擬需要這類行為之安裝的 Windows NT 行為。</span><span class="sxs-lookup"><span data-stu-id="dfaad-173">Can be used to emulate Windows NT behavior on installations that require such behavior.</span></span> <span data-ttu-id="dfaad-174">針對 RPC over HTTP v2 略過。</span><span class="sxs-lookup"><span data-stu-id="dfaad-174">Ignored for RPC over HTTP v2.</span></span> <span data-ttu-id="dfaad-175">只有在使用 RPC over HTTP v1 時才會使用。</span><span class="sxs-lookup"><span data-stu-id="dfaad-175">Used only when RPC over HTTP v1 is used.</span></span> <span data-ttu-id="dfaad-176">只有在 Windows 2000 Service Pack 3 (SP3) 和更新版本才支援。</span><span class="sxs-lookup"><span data-stu-id="dfaad-176">Supported only on Windows 2000 with Service Pack 3 (SP3) and later.</span></span>

\-

<span data-ttu-id="dfaad-177">**HKLM \\ Software \\ Microsoft \\ Rpc \\ RpcProxy \\ AllowAnonymous**</span><span class="sxs-lookup"><span data-stu-id="dfaad-177">**HKLM\\Software\\Microsoft\\Rpc\\RpcProxy\\AllowAnonymous**</span></span>

<span data-ttu-id="dfaad-178">DWORD。</span><span class="sxs-lookup"><span data-stu-id="dfaad-178">DWORD.</span></span> <span data-ttu-id="dfaad-179">如果不存在或設為零，RPC Proxy 會檢查連線是否已通過驗證，以及是否有安全 (SSL 或其他形式的加密) 。</span><span class="sxs-lookup"><span data-stu-id="dfaad-179">When not present or set to zero, the RPC Proxy checks whether the connection is authenticated, and whether it is secure (SSL or other form of encryption is used).</span></span> <span data-ttu-id="dfaad-180">如果任一個為 false，則會拒絕連接。</span><span class="sxs-lookup"><span data-stu-id="dfaad-180">If either is false, the connection is rejected.</span></span> <span data-ttu-id="dfaad-181">如果這個值包含非零的，則會允許匿名和非加密的連接。</span><span class="sxs-lookup"><span data-stu-id="dfaad-181">If this value contains non-zero, anonymous and non-encrypted connections are allowed.</span></span> <span data-ttu-id="dfaad-182">這項設定是任何虛擬目錄設定的新增功能。</span><span class="sxs-lookup"><span data-stu-id="dfaad-182">This setting is an addition to any virtual directory settings.</span></span> <span data-ttu-id="dfaad-183">例如，如果虛擬目錄層級上已停用匿名存取，但 **AllowAnonymous** 不是零，則在 IIS 層級仍會封鎖匿名存取。</span><span class="sxs-lookup"><span data-stu-id="dfaad-183">For example, if anonymous access is disabled on the virtual directory level, but **AllowAnonymous** is non-zero, anonymous access will still be blocked at the IIS level.</span></span> <span data-ttu-id="dfaad-184">僅用於 rpc over HTTP v2 中的 RPC Proxy。</span><span class="sxs-lookup"><span data-stu-id="dfaad-184">Used on the RPC Proxy only in RPC over HTTP v2.</span></span> <span data-ttu-id="dfaad-185">在 RPC Proxy 上對這個值進行變更時，必須重新開機 IIS，變更才會生效。</span><span class="sxs-lookup"><span data-stu-id="dfaad-185">When changes are made to this value on the RPC Proxy, IIS must be restarted for the change to take effect.</span></span>

> [!WARNING]
> <span data-ttu-id="dfaad-186">基於安全性考慮，Microsoft 強烈建議您不要在生產系統上設定 **AllowAnonymous** 值。</span><span class="sxs-lookup"><span data-stu-id="dfaad-186">Microsoft strongly recommends against setting the **AllowAnonymous** value on production systems for security considerations.</span></span> <span data-ttu-id="dfaad-187">應設定此金鑰的唯一原因是要在沒有外部存取的封閉網路上進行測試。</span><span class="sxs-lookup"><span data-stu-id="dfaad-187">The only reason this key should be set is for testing on closed networks without outside access.</span></span> <span data-ttu-id="dfaad-188">任何連線到網際網路的系統，以及將 **AllowAnonymous** 機碼設定為非零值的 RPC Proxy，都很容易受到攻擊。</span><span class="sxs-lookup"><span data-stu-id="dfaad-188">Any system connected to the Internet and running the RPC Proxy with the **AllowAnonymous** key set to a nonzero value may be vulnerable to attacks.</span></span>

 

 

 




