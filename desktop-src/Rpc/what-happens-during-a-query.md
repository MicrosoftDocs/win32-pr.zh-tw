---
title: 查詢期間發生的情況
description: 本節說明當32位用戶端在其自己的網域中搜尋名稱時，網路如何處理查詢。
ms.assetid: a8a88743-a245-4258-af05-9261c214ab50
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: d6e26fb9aaef0aac2ff66260d51f756725566dee
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 09/16/2019
ms.locfileid: "104183562"
---
# <a name="what-happens-during-a-query"></a>查詢期間發生的情況

本節說明當32位用戶端在其自己的網域中搜尋名稱時，網路如何處理查詢。

當您的用戶端應用程式呼叫 [**RpcNsBindingImportBegin**](/windows/desktop/api/Rpcnsi/nf-rpcnsi-rpcnsbindingimportbegina)時，位於用戶端電腦上的定位器將會嘗試滿足此要求。 如果快取中沒有任何專案，則會將 RPC 的要求轉寄至主要定位器。 如果主要定位器在其快取中找不到任何專案，則會使用郵件位置廣播將要求傳送至網域中的所有電腦。 如果有相符的，每台電腦上的定位器都會以導向的郵件位置回應。  (例如，如果該電腦上的進程已匯出介面。 ) 回應會進行定序，而且 RPC 會從用戶端的進程定位器完成，而這將會回復用戶端進程本身。

在網域中，用戶端定位器會在下列位置中搜尋主要定位器：

-   在網域主控站上
-   在每個備份網域控制站上

如果找不到相符項，用戶端定位器會將本身宣告為主要定位器。 因此，如果無法在本機滿足查詢，它就會廣播查詢。

在工作組中，用戶端定位器會維護其定位器已廣播之電腦的快取。 它會使用已執行最長的主機定位器。 如果該電腦無法使用，則會使用下一個、最長的廣播電腦等等。 如果用戶端需要主要定位器，且快取是空的，則會傳送要求主要定位器回應的特殊郵件位置廣播來 replenishes 快取。 如果沒有回應，用戶端定位器會將本身宣告為主要定位器，並在無法在本機滿足查詢時廣播查詢。

如果您的用戶端應用程式是16位或 MS-DOS 型程式，則這會有所變更。 在此情況下，用戶端電腦上沒有執行定位器，Rpcns1.dll 或 Rpcnslm 包含用來尋找主要定位器的程式碼。 所有要求都會直接轉送至主要定位器。

這些指導方針適用于用戶端網域中的名稱，例如 "/.：/" 的名稱。entryname". 如果用戶端透過使用 "/.../DOMAIN/entryname;" 從另一個網域要求名稱，則用戶端定位器會將要求轉送到指定的網域，如果沒有回應，就會廣播該要求。 如果網域已關閉或實際上是工作組，則要求將會失敗。

> [!Note]  
> 使用名稱服務中的專案時，請記住下列事項：

 

-   用戶端無法使用 "/.../DOMAIN/entryname" 語法在它自己的網域中尋找專案。 使用語法 "/.：/entryname". 不過，您可以使用 "/.../DOMAIN/entryname" 來尋找另一個網域中的專案。
-   "/.../DOMAIN/entryname" 中的功能變數名稱必須為大寫。 尋找相符項時，定位器會區分大小寫。
-   定位器專案名稱也會區分大小寫，但不需要為大寫。
-   當用戶端使用 "/.：/entryname "語法，定位器將不會搜尋其他網域中的專案，即使它們與登入網域具有信任關係也一樣。
-   廣播不會跨區域網路區段 (例如，子網) 。 因此，定位器的實用性在具有多個子網的組織中有所限制。

 

 




