---
title: 使用 HTTP 做為 RPC 傳輸
description: RPC over HTTP 可讓用戶端程式使用網際網路，在遠端網路上執行伺服器程式所提供的程式。
ms.assetid: b5062d70-7625-4a9f-a8c1-025ef8342fcb
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 5860757a6c5df9937e77fc078df2526affb967fa
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 09/16/2019
ms.locfileid: "104462269"
---
# <a name="using-http-as-an-rpc-transport"></a><span data-ttu-id="bd9e5-103">使用 HTTP 做為 RPC 傳輸</span><span class="sxs-lookup"><span data-stu-id="bd9e5-103">Using HTTP as an RPC Transport</span></span>

<span data-ttu-id="bd9e5-104">RPC over HTTP 可讓用戶端程式使用網際網路，在遠端網路上執行伺服器程式所提供的程式。</span><span class="sxs-lookup"><span data-stu-id="bd9e5-104">RPC-over-HTTP enables client programs to use the Internet to execute procedures provided by server programs on distant networks.</span></span> <span data-ttu-id="bd9e5-105">RPC over HTTP 會透過已建立的 HTTP 埠對其呼叫進行通道處理。</span><span class="sxs-lookup"><span data-stu-id="bd9e5-105">RPC over HTTP tunnels its calls through an established HTTP port.</span></span> <span data-ttu-id="bd9e5-106">因此，其呼叫可以跨用戶端和伺服器網路上的網路防火牆。</span><span class="sxs-lookup"><span data-stu-id="bd9e5-106">Thus, its calls can cross network firewalls on both the client and server networks.</span></span>

<span data-ttu-id="bd9e5-107">RPC over HTTP 會將其呼叫路由傳送至位於 RPC 伺服器網路上的 RPC proxy。</span><span class="sxs-lookup"><span data-stu-id="bd9e5-107">RPC over HTTP routes its calls to the RPC proxy located on the RPC server's network.</span></span> <span data-ttu-id="bd9e5-108">RPC Proxy 會建立和維護與 RPC 伺服器的連線。</span><span class="sxs-lookup"><span data-stu-id="bd9e5-108">The RPC Proxy establishes and maintains a connection to the RPC server.</span></span> <span data-ttu-id="bd9e5-109">它可做為 proxy、將遠端程序呼叫發送至 RPC 伺服器，並將伺服器的回復傳送回用戶端應用程式。</span><span class="sxs-lookup"><span data-stu-id="bd9e5-109">It serves as a proxy, dispatching remote procedure calls to the RPC server and sending the server's replies back across the Internet to the client application.</span></span> <span data-ttu-id="bd9e5-110">下圖說明此程式。</span><span class="sxs-lookup"><span data-stu-id="bd9e5-110">This process is illustrated in the following diagram.</span></span>

![rpc 伺服器與適用于 rpc HTTP 的網際網路資訊伺服器之間的互動](images/httprpc1.png)

<span data-ttu-id="bd9e5-112">此圖表顯示用戶端應用程式網路上的防火牆。</span><span class="sxs-lookup"><span data-stu-id="bd9e5-112">The diagram shows a firewall on the client application's network.</span></span> <span data-ttu-id="bd9e5-113">RPC over HTTP 不需要這麼做就能運作。</span><span class="sxs-lookup"><span data-stu-id="bd9e5-113">This is not required for RPC over HTTP to operate.</span></span> <span data-ttu-id="bd9e5-114">但是，如果用戶端網路有防火牆，則也需要 proxy 伺服器程式，例如 Microsoft Proxy 伺服器。</span><span class="sxs-lookup"><span data-stu-id="bd9e5-114">However, if the client network does have a firewall, it will also need a proxy server program such as Microsoft Proxy Server.</span></span>

<span data-ttu-id="bd9e5-115">當用戶端程式發出使用 HTTP 做為傳輸的遠端程序呼叫時，用戶端上的 RPC 執行時間程式庫會聯繫 RPC proxy。</span><span class="sxs-lookup"><span data-stu-id="bd9e5-115">When the client program issues a remote procedure call using HTTP as the transport, the RPC run-time library on the client contacts the RPC proxy.</span></span> <span data-ttu-id="bd9e5-116">根據 RPC 用戶端是否要求使用 HTTP 或 HTTPS (使用 SSL 的 HTTP) 埠80或埠443。</span><span class="sxs-lookup"><span data-stu-id="bd9e5-116">Depending on whether the RPC client was asked to use HTTP or HTTPS (HTTP with SSL) port 80 or port 443 is used, respectively.</span></span> <span data-ttu-id="bd9e5-117">RPC proxy 會聯繫 RPC 伺服器程式，並建立 TCP/IP 連接。</span><span class="sxs-lookup"><span data-stu-id="bd9e5-117">The RPC proxy contacts the RPC server program and establishes a TCP/IP connection.</span></span> <span data-ttu-id="bd9e5-118">用戶端和 RPC proxy 會維護其在網際網路上的 HTTP 或 HTTPS 連線。</span><span class="sxs-lookup"><span data-stu-id="bd9e5-118">The client and the RPC proxy maintain their HTTP or HTTPS connection across the Internet.</span></span> <span data-ttu-id="bd9e5-119">用戶端對 RPC proxy 的 HTTP 或 HTTPS 連線可以通過防火牆 (受限於適當存取權限) 如果有的話）。</span><span class="sxs-lookup"><span data-stu-id="bd9e5-119">The client's HTTP or HTTPS connection to the RPC proxy can pass through a firewall (subject to appropriate access permissions) if one is present.</span></span> <span data-ttu-id="bd9e5-120">然後伺服器可以執行遠端程序呼叫，並透過 RPC proxy 使用連接來回複用戶端。</span><span class="sxs-lookup"><span data-stu-id="bd9e5-120">The server can then execute the remote procedure call and use the connection through the RPC proxy to reply to the client.</span></span> <span data-ttu-id="bd9e5-121">RPC proxy 是在 IIS 內容中執行的 ISAPI 延伸模組。</span><span class="sxs-lookup"><span data-stu-id="bd9e5-121">The RPC proxy is an ISAPI extension running in the context of IIS.</span></span>

<span data-ttu-id="bd9e5-122">如果用戶端或伺服器因為任何原因而中斷連線，RPC proxy 將會偵測到它並結束 RPC 會話。</span><span class="sxs-lookup"><span data-stu-id="bd9e5-122">If either the client or the server disconnects for any reason, the RPC proxy will detect it and end the RPC session.</span></span> <span data-ttu-id="bd9e5-123">只要會話繼續，RPC proxy 就會維持與用戶端和伺服器的連接。</span><span class="sxs-lookup"><span data-stu-id="bd9e5-123">As long as the session continues, the RPC proxy will maintain its connections to the client and the server.</span></span> <span data-ttu-id="bd9e5-124">它會將遠端程序呼叫從用戶端轉送到伺服器，並將回復從伺服器傳送到用戶端。</span><span class="sxs-lookup"><span data-stu-id="bd9e5-124">It will forward remote procedure calls from the client to the server, and send replies from the server to the client.</span></span>

<span data-ttu-id="bd9e5-125">RPC 用戶端程式可以建立表單的字串系結，藉以透過網際網路將 RPC 呼叫通道：</span><span class="sxs-lookup"><span data-stu-id="bd9e5-125">The RPC client program can tunnel its RPC calls through the Internet by creating a string binding of the form:</span></span>

``` syntax
[object_uuid@]ncacn_http:rpc_server[endpoint,HttpProxy=proxy_server:http_port,RpcProxy=rpc_proxy:rpc_port,HttpConnectionOption=UseHttpProxy]
```

<span data-ttu-id="bd9e5-126">其中：</span><span class="sxs-lookup"><span data-stu-id="bd9e5-126">Where:</span></span>

-   <span data-ttu-id="bd9e5-127">*物件 \_ UUID* 指定 RPC 物件 uuid。</span><span class="sxs-lookup"><span data-stu-id="bd9e5-127">*object\_uuid* specifies an RPC object UUID.</span></span> <span data-ttu-id="bd9e5-128">如需詳細資訊，請參閱 [產生介面 uuid](generating-interface-uuids.md) 和 [字串 UUID](string-uuid.md)。</span><span class="sxs-lookup"><span data-stu-id="bd9e5-128">For more information, see [Generating Interface UUIDs](generating-interface-uuids.md) and [String UUID](string-uuid.md).</span></span>
-   <span data-ttu-id="bd9e5-129">**ncacn \_ HTTP** 會選取 RPC over HTTP 的通訊協定順序規格。</span><span class="sxs-lookup"><span data-stu-id="bd9e5-129">**ncacn\_http** selects the protocol sequence specification for RPC over HTTP.</span></span> <span data-ttu-id="bd9e5-130">如需詳細資訊，請參閱 [通訊協定順序常數](protocol-sequence-constants.md) 和 [字串](string-binding.md)系結。</span><span class="sxs-lookup"><span data-stu-id="bd9e5-130">For more information, see [Protocol Sequence Constants](protocol-sequence-constants.md) and [String Binding](string-binding.md).</span></span>
-   <span data-ttu-id="bd9e5-131">*rpc \_ 伺服器* 是執行 rpc 伺服器進程之電腦的網路位址。</span><span class="sxs-lookup"><span data-stu-id="bd9e5-131">*rpc\_server* is the network address of the computer that is executing the RPC server process.</span></span> <span data-ttu-id="bd9e5-132">伺服器位址必須以可由 RPC proxy 電腦看見且可理解的形式指定，而不是由用戶端來指定。</span><span class="sxs-lookup"><span data-stu-id="bd9e5-132">The server address must be specified in a form visible and understandable by the RPC proxy computer, not by the client.</span></span> <span data-ttu-id="bd9e5-133">由於用戶端不會直接連線到伺服器，因此不需要能夠解析伺服器的名稱，也不需要建立與伺服器的連接。</span><span class="sxs-lookup"><span data-stu-id="bd9e5-133">Since the client does not connect directly to the server, it does not need to be able to resolve the name of the server, or establish a connection to it.</span></span> <span data-ttu-id="bd9e5-134">RPC proxy 會代表用戶端建立連線，因此 *rpc \_ 伺服器* 必須是 rpc proxy 可辨識的名稱。</span><span class="sxs-lookup"><span data-stu-id="bd9e5-134">The RPC proxy will establish the connection on the client's behalf, and therefore, *rpc\_server* must be a name recognizable by the RPC proxy.</span></span>
-   <span data-ttu-id="bd9e5-135">*端點* 會指定 RPC 伺服器進程接聽遠端程序呼叫的 tcp/ip 通訊埠。</span><span class="sxs-lookup"><span data-stu-id="bd9e5-135">*endpoint* specifies the TCP/IP port that the RPC server process listens to for remote procedure calls.</span></span> <span data-ttu-id="bd9e5-136">如需詳細資訊，請參閱 [尋找端點](finding-endpoints.md)。</span><span class="sxs-lookup"><span data-stu-id="bd9e5-136">For more information, see [Finding Endpoints](finding-endpoints.md).</span></span>
-   <span data-ttu-id="bd9e5-137">**HttpProxy** 選擇性地指定 RPC 用戶端網路上的 HTTP proxy 伺服器，例如 Microsoft proxy 伺服器。</span><span class="sxs-lookup"><span data-stu-id="bd9e5-137">**HttpProxy** optionally specifies an HTTP proxy server on the RPC client's network, such as Microsoft Proxy Server.</span></span> <span data-ttu-id="bd9e5-138">如果選取 proxy 伺服器，則不會指定埠號碼，如果未要求 SSL，RPC 存根預設會使用埠80，而如果指定了 SSL，則會使用埠443。</span><span class="sxs-lookup"><span data-stu-id="bd9e5-138">If a proxy server is selected, no port number is specified, the RPC stub uses port 80 by default if SSL is not requested, and port 443 if SSL is specified.</span></span>
-   <span data-ttu-id="bd9e5-139">**RpcProxy** 指定作為 RPC 伺服器之 PROXY 的 IIS 電腦的位址和埠號碼。</span><span class="sxs-lookup"><span data-stu-id="bd9e5-139">**RpcProxy** specifies the address and port number of the IIS computer that acts as a proxy to the RPC server.</span></span> <span data-ttu-id="bd9e5-140">如果 RPC 伺服器進程位於與 RPC proxy 不同的電腦上，您只需要指定此程式。</span><span class="sxs-lookup"><span data-stu-id="bd9e5-140">You only need to specify this if the RPC server process resides on a different computer than the RPC proxy.</span></span> <span data-ttu-id="bd9e5-141">如果未指定埠號碼，則如果未指定 SSL，RPC 用戶端存根預設會使用埠80，如果指定 SSL (HTTPS) ，則會使用埠443。</span><span class="sxs-lookup"><span data-stu-id="bd9e5-141">If you do not specify a port number, the RPC client stub by default uses port 80 if SSL is not specified, and uses port 443 if SSL (HTTPS) is specified.</span></span>
-   <span data-ttu-id="bd9e5-142">**HttpConnectionOption** 可選擇性地讓您在進行 HTTP 連線時，指示 RPC 的行為。</span><span class="sxs-lookup"><span data-stu-id="bd9e5-142">**HttpConnectionOption** optionally allows you to direct RPC’s behavior when making HTTP connections.</span></span> <span data-ttu-id="bd9e5-143">**UseHttpProxy** 值會指示 RPC 隨時透過 Http proxy 路由傳送流量，包括當用戶端的網際網路選項設定在 Internet Explorer 為「針對本機位址略過 proxy 伺服器」的時候。</span><span class="sxs-lookup"><span data-stu-id="bd9e5-143">The **UseHttpProxy** value instructs RPC to route its traffic through the Http proxy at all times, including when the client has their Internet Options set in Internet Explorer to “Bypass proxy server for local addresses.”</span></span>

    <span data-ttu-id="bd9e5-144">已安裝 KB2916915 的 Windows 7、Windows Server 2008 R2、Windows 8.1 和 Windows Server 2012 R2 支援此選項。</span><span class="sxs-lookup"><span data-stu-id="bd9e5-144">This option is supported on Windows 7, Windows Server 2008 R2, Windows 8.1, and Windows Server 2012 R2 with KB2916915 installed.</span></span> <span data-ttu-id="bd9e5-145">Windows 8 和 Windows Server 2012 上不支援此選項。</span><span class="sxs-lookup"><span data-stu-id="bd9e5-145">This option is not supported on Windows 8 and Windows Server 2012.</span></span> <span data-ttu-id="bd9e5-146">應用程式可以藉由檢查位於下列登錄機碼底下的 **ConnectionOptionsFlag** 登錄值，來判斷 RPC 執行時間是否支援此選項：</span><span class="sxs-lookup"><span data-stu-id="bd9e5-146">Applications can determine if this option is supported by the RPC runtime by checking the **ConnectionOptionsFlag** registry value located under the following registry key:</span></span>

    <span data-ttu-id="bd9e5-147">**HKEY \_ 本機 \_ 電腦 \\ 軟體 \\ Microsoft \\ Rpc**</span><span class="sxs-lookup"><span data-stu-id="bd9e5-147">**HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Rpc**</span></span>

    <span data-ttu-id="bd9e5-148">如果設定此登錄值的位 0 (LSB) ，則支援此特定選項。否則，系統中的 RPC 執行時間不支援此選項。</span><span class="sxs-lookup"><span data-stu-id="bd9e5-148">If the bit 0 (LSB) of this registry value is set, then this specific option is supported; otherwise, this option is not supported by the RPC runtime in the system.</span></span>

<span data-ttu-id="bd9e5-149">如需有關建立字串系結的詳細資訊，請參閱系結 [和控制碼](binding-and-handles.md)。</span><span class="sxs-lookup"><span data-stu-id="bd9e5-149">For more information on creating string bindings, see [Binding and Handles](binding-and-handles.md).</span></span>

<span data-ttu-id="bd9e5-150">RPC 伺服器程式可以接聽 ncacn \_ HTTP 通訊協定順序，接受通道的 rpc 呼叫。</span><span class="sxs-lookup"><span data-stu-id="bd9e5-150">The RPC server program can accept tunneled RPC calls by listening on the ncacn\_http protocol sequence.</span></span>

<span data-ttu-id="bd9e5-151">Microsoft 有兩個主要的 RPC over HTTP 執行：第1版和第2版。</span><span class="sxs-lookup"><span data-stu-id="bd9e5-151">Microsoft has two major implementations of RPC over HTTP: Version 1 and Version 2.</span></span>

<span data-ttu-id="bd9e5-152">第1版 (透過 Windows XP 支援稱為 RPC over HTTP v1) 。</span><span class="sxs-lookup"><span data-stu-id="bd9e5-152">Version 1 (called RPC over HTTP v1) is supported through Windows XP.</span></span> <span data-ttu-id="bd9e5-153">Windows 2000 支援 RPC proxy 的第1版。</span><span class="sxs-lookup"><span data-stu-id="bd9e5-153">Version 1 of the RPC proxy is supported through Windows 2000.</span></span>

<span data-ttu-id="bd9e5-154">第2版 (稱為 RPC over HTTP v2) 是目前的版本。</span><span class="sxs-lookup"><span data-stu-id="bd9e5-154">Version 2 (called RPC over HTTP v2) is the current version.</span></span>

<span data-ttu-id="bd9e5-155">這兩個版本具有不同的功能和有限的互通性。</span><span class="sxs-lookup"><span data-stu-id="bd9e5-155">The two versions have different capabilities and limited interoperability.</span></span> <span data-ttu-id="bd9e5-156">此處提供差異摘要。</span><span class="sxs-lookup"><span data-stu-id="bd9e5-156">A summary of the differences is provided here.</span></span> <span data-ttu-id="bd9e5-157">如需互通性考慮，請參閱 [RPC OVER HTTP 的系統需求和互通性](system-requirements-and-interoperability-for-rpc-over-http.md)。</span><span class="sxs-lookup"><span data-stu-id="bd9e5-157">For interoperability considerations, see [System Requirements and Interoperability for RPC over HTTP](system-requirements-and-interoperability-for-rpc-over-http.md).</span></span>

-   <span data-ttu-id="bd9e5-158">RPC over HTTP v1 需要在 RPC over HTTP 用戶端與 RPC proxy 之間的所有 HTTP proxy/防火牆上啟用 SSL 通道。</span><span class="sxs-lookup"><span data-stu-id="bd9e5-158">RPC over HTTP v1 requires SSL Tunneling to be enabled on all HTTP proxies/firewalls between the RPC over HTTP client and the RPC proxy.</span></span> <span data-ttu-id="bd9e5-159">RPC over HTTP v1 嘗試透過埠80建立 SSL 通道，雖然它所傳送的資料實際上不是 SSL 加密。</span><span class="sxs-lookup"><span data-stu-id="bd9e5-159">RPC over HTTP v1 attempts to build an SSL Tunnel over port 80 even though the data it sends is not actually SSL-encrypted.</span></span> <span data-ttu-id="bd9e5-160">Proxy 和防火牆通常會拒絕這類要求，除非明確設定為允許這些要求。</span><span class="sxs-lookup"><span data-stu-id="bd9e5-160">Proxies and firewalls usually reject such requests unless explicitly configured to allow them.</span></span> <span data-ttu-id="bd9e5-161">RPC over HTTP v2 沒有這類需求。</span><span class="sxs-lookup"><span data-stu-id="bd9e5-161">RPC over HTTP v2 has no such requirement.</span></span>
-   <span data-ttu-id="bd9e5-162">RPC over HTTP v1 無法與 RPC proxy 建立 SSL 會話。</span><span class="sxs-lookup"><span data-stu-id="bd9e5-162">RPC over HTTP v1 cannot establish an SSL session to the RPC proxy.</span></span> <span data-ttu-id="bd9e5-163">RPC over HTTP v2 可以在 SSL 會話內傳送所有 RPC over HTTP 流量;依預設，v2 需要在 SSL 會話內傳送資料。</span><span class="sxs-lookup"><span data-stu-id="bd9e5-163">The RPC over HTTP v2 can send all RPC over HTTP traffic within an SSL session; by default v2 requires the data be sent within an SSL session.</span></span>
-   <span data-ttu-id="bd9e5-164">RPC over HTTP v1 無法向 RPC proxy 驗證。</span><span class="sxs-lookup"><span data-stu-id="bd9e5-164">RPC over HTTP v1 cannot authenticate to the RPC proxy.</span></span> <span data-ttu-id="bd9e5-165">RPC over HTTP v2 可以進行驗證;依預設，v2 需要驗證 RPC proxy。</span><span class="sxs-lookup"><span data-stu-id="bd9e5-165">RPC over HTTP v2 can authenticate; by default v2 requires authentication to the RPC proxy.</span></span>
-   <span data-ttu-id="bd9e5-166">當安裝的 IIS 電腦是 web 伺服陣列的一部分時，RPC proxy v1 無法正常運作。</span><span class="sxs-lookup"><span data-stu-id="bd9e5-166">RPC proxy v1 does not operate correctly when the IIS machine on which it is installed is part of a web farm.</span></span> <span data-ttu-id="bd9e5-167">當安裝的 IIS 電腦是 web 伺服陣列的一部分時，RPC proxy v2 會正常運作。</span><span class="sxs-lookup"><span data-stu-id="bd9e5-167">RPC proxy v2 operates properly when the IIS machine on which it is installed is part of a web farm.</span></span>

> [!Note]  
> <span data-ttu-id="bd9e5-168">如果用戶端程式的電腦上已安裝 Microsoft Internet Explorer，而您的用戶端未在其字串系結中指定 **HttpProxy** ，則 RPC 用戶端 stub 會在用戶端電腦上搜尋登錄中的 **HttpProxy** 專案。</span><span class="sxs-lookup"><span data-stu-id="bd9e5-168">If Microsoft Internet Explorer is installed on the client program's computer and your client does not specify an **HttpProxy** in its string binding, the RPC client stub will search the registry on the client computer for an **HttpProxy** entry.</span></span> <span data-ttu-id="bd9e5-169">如果找到一個，就會使用登錄專案中指定的 proxy。</span><span class="sxs-lookup"><span data-stu-id="bd9e5-169">If it finds one, it will use the proxy specified in the registry entry.</span></span>

 

<span data-ttu-id="bd9e5-170">比方說，假設您的用戶端程式需要在電腦之間連線到名為 Server7.microsoft.com 的電腦上的 RPC 伺服器。</span><span class="sxs-lookup"><span data-stu-id="bd9e5-170">Suppose, for instance, your client program needs to connect across the Internet to an RPC server on a computer called Server7.microsoft.com.</span></span> <span data-ttu-id="bd9e5-171">此外，假設 RPC proxy 是在 Major7.microsoft.com 上執行。</span><span class="sxs-lookup"><span data-stu-id="bd9e5-171">Further, suppose that the RPC proxy runs on Major7.microsoft.com.</span></span> <span data-ttu-id="bd9e5-172">RPC 伺服器程式會接聽埠2225。</span><span class="sxs-lookup"><span data-stu-id="bd9e5-172">The RPC server program listens to port 2225.</span></span> <span data-ttu-id="bd9e5-173">您的用戶端會使用字串系結：</span><span class="sxs-lookup"><span data-stu-id="bd9e5-173">Your client would use the string binding:</span></span>

``` syntax
ncacn_http:Server7.microsoft.com[2225, RpcProxy=Major7.microsoft.com]
```

<span data-ttu-id="bd9e5-174">如果 RPC proxy 可以將伺服器名稱解析為 Server7，而不需要完整的功能變數名稱，您也可以指定：</span><span class="sxs-lookup"><span data-stu-id="bd9e5-174">If the RPC proxy can resolve the server name as Server7, without requiring a fully qualified domain name, you can also specify:</span></span>

``` syntax
ncacn_http:Server7 [2225, RpcProxy=Major7.microsoft.com]
```

<span data-ttu-id="bd9e5-175">如果用戶端網路使用名為 myproxy 的防火牆和網際網路 proxy 伺服器，而且用戶端上的 Internet Explorer 未設定為使用該 proxy，您就必須修改用戶端的字串系結至：</span><span class="sxs-lookup"><span data-stu-id="bd9e5-175">If the client network uses a firewall and an Internet proxy server called myproxy, and Internet Explorer on the client is not configured to use that proxy, you would need to modify the client's string binding to:</span></span>

``` syntax
ncacn_http:Server7.microsoft.com[,HttpProxy=myproxy:80,RpcProxy=Major7.microsoft.com:80]
```

<span data-ttu-id="bd9e5-176">這會指示用戶端連接到 Server7.microsoft.com 上的 RPC 伺服器程式。</span><span class="sxs-lookup"><span data-stu-id="bd9e5-176">This directs the client to connect to the RPC server program on Server7.microsoft.com.</span></span> <span data-ttu-id="bd9e5-177">若要這樣做，用戶端會先使用埠 80 (或埠443（如果使用 SSL) 連接到 myproxy）。</span><span class="sxs-lookup"><span data-stu-id="bd9e5-177">To do this, the client will first use port 80 (or port 443 if SSL is used) to connect to myproxy.</span></span> <span data-ttu-id="bd9e5-178">這會讓用戶端程式存取網際網路。</span><span class="sxs-lookup"><span data-stu-id="bd9e5-178">This will give the client program access to the Internet.</span></span> <span data-ttu-id="bd9e5-179">使用網際網路時，用戶端程式會接著連接到 Major7.microsoft.com 上的 RPC proxy。</span><span class="sxs-lookup"><span data-stu-id="bd9e5-179">Using the Internet, the client program next connects to the RPC proxy on Major7.microsoft.com.</span></span> <span data-ttu-id="bd9e5-180">RPC proxy 將會建立與在 Server7.microsoft.com 上執行之 RPC 伺服器程式的連接。</span><span class="sxs-lookup"><span data-stu-id="bd9e5-180">The RPC proxy will establish a connection to the RPC server program running on Server7.microsoft.com.</span></span>

<span data-ttu-id="bd9e5-181">如果用戶端網路使用防火牆，而且如果無法直接連線到 RPC proxy，則可以將用戶端字串系結修改為：</span><span class="sxs-lookup"><span data-stu-id="bd9e5-181">If the client network uses a firewall and if the RPC proxy cannot be reached directly, in order to get a connection established faster, the client string binding can be modified to:</span></span>

``` syntax
ncacn_http:Server7.microsoft.com[RpcProxy=Major7.microsoft.com:80,HttpConnectionOption=UseHttpProxy]
```

<span data-ttu-id="bd9e5-182">**HttpConnectionOption** 可讓您在進行 HTTP 連線時，指示 RPC 的行為。</span><span class="sxs-lookup"><span data-stu-id="bd9e5-182">The **HttpConnectionOption** allows you to direct RPC’s behavior when making HTTP connections.</span></span> <span data-ttu-id="bd9e5-183">**UseHttpProxy** 值會指示 RPC 隨時透過 Http proxy 路由傳送流量，包括當用戶端的網際網路選項設定在 Internet Explorer 為「針對本機位址略過 proxy 伺服器」的時候。</span><span class="sxs-lookup"><span data-stu-id="bd9e5-183">The **UseHttpProxy** value instructs RPC to route its traffic through the Http proxy at all times, including when the client has their Internet Options set in Internet Explorer to “Bypass proxy server for local addresses.”</span></span> <span data-ttu-id="bd9e5-184">這會指示用戶端透過 Http proxy 強制連接至 RPC proxy。</span><span class="sxs-lookup"><span data-stu-id="bd9e5-184">This directs the client to forcefully connect to the RPC proxy through the Http proxy.</span></span> <span data-ttu-id="bd9e5-185">這可加速建立連接的時間，因為它會略過在使用 HTTP proxy 之前，直接搜尋 RPC 伺服器的任何延遲。</span><span class="sxs-lookup"><span data-stu-id="bd9e5-185">This speeds up the time to establish a connection since it bypasses any delay searching for the RPC server directly prior to using the HTTP proxy.</span></span>

<span data-ttu-id="bd9e5-186">如果使用 **HttpConnectionOption** 選項，且用戶端上的 Internet Explorer 未設定為使用該 Http proxy，則連線可能會失敗，並出現 **RPC \_ S \_ 不正確 \_ 網路 \_ 選項**。</span><span class="sxs-lookup"><span data-stu-id="bd9e5-186">If the **HttpConnectionOption** option is used and Internet Explorer on the client is not configured to use that Http proxy, connections may fail with **RPC\_S\_INVALID\_NETWORK\_OPTIONS**.</span></span>

<span data-ttu-id="bd9e5-187">現今大部分的電腦都是針對網頁瀏覽進行設定。</span><span class="sxs-lookup"><span data-stu-id="bd9e5-187">The vast majority of computers today are configured for Web browsing.</span></span> <span data-ttu-id="bd9e5-188">因此，大部分的用戶端不需要指定 **HttpProxy**，因為它會從網際網路連線設定中取出。</span><span class="sxs-lookup"><span data-stu-id="bd9e5-188">Therefore, most clients do not need to specify the **HttpProxy**, because it will be retrieved from Internet connectivity settings.</span></span>

 

 




