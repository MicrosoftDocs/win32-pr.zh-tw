---
title: 三種指標類型
description: MIDL 支援三種類型的指標以容納各種應用程式。
ms.assetid: 6684c252-6fbe-49ca-9967-6d4baf5dc298
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 9627c71b07c86ab2deb7e28bddcf6d30b1747cf7d44874620f4053383a5a948a
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/11/2021
ms.locfileid: "118923457"
---
# <a name="three-pointer-types"></a>三種指標類型

MIDL 支援三種類型的指標以容納各種應用程式。 三個不同的層級稱為參考、唯一和完整指標，分別由屬性 **\[** [**ref**](/windows/desktop/Midl/ref) **\]** 、 **\[** [**unique**](/windows/desktop/Midl/unique)和 **\]** **\[** [**ptr**](/windows/desktop/Midl/ptr)表示 **\]** 。 這些屬性所描述的指標類別都是互斥的。 指標屬性可以套用至類型定義、函數傳回類型、函式參數、結構或等位成員或陣列元素的指標。

內嵌指標是結構或等位成員的指標。 它們也可以是陣列的元素。 在 **\[** [**中**](/windows/desktop/Midl/in) **\]** ，會假設內嵌 **\[ ref \]** 指標指向有效的儲存區，而且不得為 null。 這種情況會以遞迴方式適用于它們所指向的所有 **\[ ref \]** 指標。 在 **\[ 中 \]** ，內嵌的 **\[ unique \]** 和 full 指標 (具有 **\[ ptr \]** 屬性的指標) 不一定是 null。

在函式宣告的語法中放置於參數上的任何指標屬性，只會影響該參數最右邊的指標宣告子。 若要影響其他指標宣告子，必須使用中繼命名類型。

傳回指標的函式可以將指標屬性作為函式屬性。 **\[ Unique \]** 和 **\[ ptr \]** 屬性必須套用至函數傳回型別。 指標成員宣告可將指標屬性指定為欄位屬性。 指標屬性也可以套用為 [**typedef**](/windows/desktop/Midl/typedef) 結構中的型別屬性。

當沒有將指標屬性指定為欄位或類型屬性時，會根據未歸屬指標宣告的規則來套用指標屬性，如下所示。

在 DCE 相容性模式中，指標屬性是在定義 IDL 檔案中決定。 如果 **\[** 定義介面中指定了 [**指標 \_ 預設**](/windows/desktop/Midl/pointer-default) **\]** 屬性，則會使用該屬性。 如果沒有 **\[ 指標 \_ 預設 \]** 屬性，所有未歸屬指標都會是完整指標。

在 Microsoft 擴充模式中，指標屬性可以藉由匯入 IDL 檔案來判斷，並依下列順序套用：

1.  在 use 網站套用的明確指標屬性。
2.  當未歸屬指標為最上層指標參數時，即為 **\[ ref \]** 屬性。
3.  在定義介面中指定的 **\[ 指標 \_ 預設 \]** 屬性。
4.  基底介面中指定的 **\[ 指標 \_ 預設 \]** 屬性。
5.  **\[ 唯一 \]** 屬性。

**\[** 當宣告未套用明確的指標屬性時，[**指標 \_ 預設**](/windows/desktop/Midl/pointer-default) **\]** 介面屬性會指定要套用至類型、參數或傳回類型宣告中指標宣告子的預設指標屬性。 **\[ 指標 \_ 預設 \]** 介面屬性不會套用到參數的未歸屬最上層指標，而是假設為 **\[ ref \]**。

 

 