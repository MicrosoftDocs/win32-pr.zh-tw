---
title: 用戶端系結
description: 系結控制碼是由通訊協定序列、伺服器程式主機電腦的名稱或位址，以及伺服器程式端點所組成。 因此，您的用戶端程式必須取得或提供此資訊，以建立系結。
ms.assetid: 0a3bed37-95c7-4f4a-9ed3-9d57f69db523
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f42ed5d2af21eff1091e0ba48718426bf17501e3
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 09/16/2019
ms.locfileid: "106969666"
---
# <a name="client-side-binding"></a>用戶端系結

系結控制碼是由通訊協定序列、伺服器程式主機電腦的名稱或位址，以及伺服器程式端點所組成。 因此，您的用戶端程式必須取得或提供此資訊，以建立系結。

如果您的用戶端程式使用自動系結控制碼，您就不需要撰寫特殊的原始程式碼來建立或管理系結。 用戶端 stub 會呼叫建立和維護系結所需的 RPC 函數。 您只需指定用戶端會在應用程式佈建檔案中使用自動系結控制碼 (ACF) ，然後據以設計介面。 如需詳細資訊，請參閱自動系結 [控制碼](automatic-binding-handles.md)。

例如，假設您正在開發名為遠端時間戳記函數的用戶端程式。 在這裡，存根會執行所有工作，而用戶端只需要包含產生的標頭檔 Auto，以取得遠端程式的函式原型。 用戶端應用程式對遠端程式的呼叫會像呼叫本機程式一樣出現，如下列範例所示：


```C++
/* auto handle client application (fragment) */
#include <windows.h>
#include <stdio.h>
#include <time.h>
#include "auto.h"    // header file generated by the MIDL compiler
 
 
void main(int argc, char **argv)
{
    time_t t1;
    time_t t2;
    char * pszTime;
    ...
 
    GetTime(&t1);  // GetTime is a remote procedure
    GetTime(&t2);
 
    pszTime = ctime(&t1);
    printf("time 1= %s\n", pszTime);
 
    pszTime = ctime(&t2);
    printf("time 2= %s\n", pszTime);
 
    Shutdown();    // Shutdown is a remote procedure
    exit(0);
}
```



如您在上述範例中所見，用戶端應用程式不需要對 RPC 執行時間程式庫函式進行任何明確的呼叫。 用戶端 stub 會管理它們。

如果您的應用程式使用隱含或明確的系結控制碼，用戶端必須取得系結資訊，並呼叫 RPC 函數來建立控制碼。 用戶端從中取得系結資訊的位置，取決於您的應用程式需求。 安裝您用戶端應用程式的安裝程式可以將系結資訊儲存在其所建立的環境變數中。 它也可以將系結資訊儲存在應用程式特定的設定檔中。 由於環境變數或設定檔中的系結資訊通常會儲存為字串，因此您的用戶端應用程式必須將字串轉換成系結。 在 Windows XP/2000 環境中，您可以從 Active Directory 取出系結資訊。 如需詳細資訊，請參閱 [使用字串](finding-server-host-systems.md)系結。

大部分的網路都有名稱服務。 伺服器程式可以在名稱服務資料庫中通告自己。 當用戶端開始執行時，它可以從名稱服務資料庫取得其系結資訊。 如需詳細資訊，請參閱 [從名稱服務資料庫匯入](finding-server-host-systems.md)。

下列主題將討論使用隱含和明確控制碼進行系結所需的步驟：

-   [選取通訊協定順序](selecting-a-protocol-sequence.md)
-   [尋找伺服器主機系統](finding-server-host-systems.md)
-   [尋找端點](finding-endpoints.md)

如需這些主題的簡短總覽，請參閱 [連接用戶端和伺服器](connecting-the-client-and-the-server.md)。

 

 




