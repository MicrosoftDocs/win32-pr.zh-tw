---
title: 用戶端系結
description: 系結控制碼是由通訊協定序列、伺服器程式主機電腦的名稱或位址，以及伺服器程式端點所組成。 因此，您的用戶端程式必須取得或提供此資訊，以建立系結。
ms.assetid: 0a3bed37-95c7-4f4a-9ed3-9d57f69db523
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f42ed5d2af21eff1091e0ba48718426bf17501e3
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 09/16/2019
ms.locfileid: "106969666"
---
# <a name="client-side-binding"></a><span data-ttu-id="443ce-104">用戶端系結</span><span class="sxs-lookup"><span data-stu-id="443ce-104">Client-side Binding</span></span>

<span data-ttu-id="443ce-105">系結控制碼是由通訊協定序列、伺服器程式主機電腦的名稱或位址，以及伺服器程式端點所組成。</span><span class="sxs-lookup"><span data-stu-id="443ce-105">Binding handles are composed of a protocol sequence, the name or address of a server program host computer, and a server program endpoint.</span></span> <span data-ttu-id="443ce-106">因此，您的用戶端程式必須取得或提供此資訊，以建立系結。</span><span class="sxs-lookup"><span data-stu-id="443ce-106">Therefore, your client program must obtain or provide this information to create a binding.</span></span>

<span data-ttu-id="443ce-107">如果您的用戶端程式使用自動系結控制碼，您就不需要撰寫特殊的原始程式碼來建立或管理系結。</span><span class="sxs-lookup"><span data-stu-id="443ce-107">If your client program uses automatic binding handles, you do not need to write special source code to create or manage the binding.</span></span> <span data-ttu-id="443ce-108">用戶端 stub 會呼叫建立和維護系結所需的 RPC 函數。</span><span class="sxs-lookup"><span data-stu-id="443ce-108">The client stub calls RPC functions required to establish and maintain the binding.</span></span> <span data-ttu-id="443ce-109">您只需指定用戶端會在應用程式佈建檔案中使用自動系結控制碼 (ACF) ，然後據以設計介面。</span><span class="sxs-lookup"><span data-stu-id="443ce-109">All you have to do is specify that your client uses automatic binding handles in the application configuration file (ACF), and design the interface accordingly.</span></span> <span data-ttu-id="443ce-110">如需詳細資訊，請參閱自動系結 [控制碼](automatic-binding-handles.md)。</span><span class="sxs-lookup"><span data-stu-id="443ce-110">For details, see [Automatic Binding Handles](automatic-binding-handles.md).</span></span>

<span data-ttu-id="443ce-111">例如，假設您正在開發名為遠端時間戳記函數的用戶端程式。</span><span class="sxs-lookup"><span data-stu-id="443ce-111">Suppose, for example, that you were developing a client program that called remote time-stamping functions.</span></span> <span data-ttu-id="443ce-112">在這裡，存根會執行所有工作，而用戶端只需要包含產生的標頭檔 Auto，以取得遠端程式的函式原型。</span><span class="sxs-lookup"><span data-stu-id="443ce-112">Here, the stubs do all the work and the client only needs to include the generated header file Auto.h to obtain the function prototypes for the remote procedures.</span></span> <span data-ttu-id="443ce-113">用戶端應用程式對遠端程式的呼叫會像呼叫本機程式一樣出現，如下列範例所示：</span><span class="sxs-lookup"><span data-stu-id="443ce-113">The client application calls to the remote procedures appear just as if they were calls to local procedures, as shown in the following example:</span></span>


```C++
/* auto handle client application (fragment) */
#include <windows.h>
#include <stdio.h>
#include <time.h>
#include "auto.h"    // header file generated by the MIDL compiler
 
 
void main(int argc, char **argv)
{
    time_t t1;
    time_t t2;
    char * pszTime;
    ...
 
    GetTime(&t1);  // GetTime is a remote procedure
    GetTime(&t2);
 
    pszTime = ctime(&t1);
    printf("time 1= %s\n", pszTime);
 
    pszTime = ctime(&t2);
    printf("time 2= %s\n", pszTime);
 
    Shutdown();    // Shutdown is a remote procedure
    exit(0);
}
```



<span data-ttu-id="443ce-114">如您在上述範例中所見，用戶端應用程式不需要對 RPC 執行時間程式庫函式進行任何明確的呼叫。</span><span class="sxs-lookup"><span data-stu-id="443ce-114">As you can see in the preceding example, the client application does not have to make any explicit calls to the RPC run-time library functions.</span></span> <span data-ttu-id="443ce-115">用戶端 stub 會管理它們。</span><span class="sxs-lookup"><span data-stu-id="443ce-115">The client stub manages them.</span></span>

<span data-ttu-id="443ce-116">如果您的應用程式使用隱含或明確的系結控制碼，用戶端必須取得系結資訊，並呼叫 RPC 函數來建立控制碼。</span><span class="sxs-lookup"><span data-stu-id="443ce-116">If your application uses implicit or explicit binding handles, the client must obtain the binding information and call the RPC functions to create the handles.</span></span> <span data-ttu-id="443ce-117">用戶端從中取得系結資訊的位置，取決於您的應用程式需求。</span><span class="sxs-lookup"><span data-stu-id="443ce-117">Where the client obtains the binding information from depends on the requirements of your application.</span></span> <span data-ttu-id="443ce-118">安裝您用戶端應用程式的安裝程式可以將系結資訊儲存在其所建立的環境變數中。</span><span class="sxs-lookup"><span data-stu-id="443ce-118">The setup program that installs your client application can store binding information in environment variables that it creates.</span></span> <span data-ttu-id="443ce-119">它也可以將系結資訊儲存在應用程式特定的設定檔中。</span><span class="sxs-lookup"><span data-stu-id="443ce-119">It can also save binding information in an application-specific configuration file.</span></span> <span data-ttu-id="443ce-120">由於環境變數或設定檔中的系結資訊通常會儲存為字串，因此您的用戶端應用程式必須將字串轉換成系結。</span><span class="sxs-lookup"><span data-stu-id="443ce-120">Since binding information in environment variables or configuration files is usually stored as strings, your client application will need to convert the string to a binding.</span></span> <span data-ttu-id="443ce-121">在 Windows XP/2000 環境中，您可以從 Active Directory 取出系結資訊。</span><span class="sxs-lookup"><span data-stu-id="443ce-121">In Windows XP/2000 environments, binding information can be retrieved from Active Directory.</span></span> <span data-ttu-id="443ce-122">如需詳細資訊，請參閱 [使用字串](finding-server-host-systems.md)系結。</span><span class="sxs-lookup"><span data-stu-id="443ce-122">For more information, see [Using String Bindings](finding-server-host-systems.md).</span></span>

<span data-ttu-id="443ce-123">大部分的網路都有名稱服務。</span><span class="sxs-lookup"><span data-stu-id="443ce-123">Most networks have a name service.</span></span> <span data-ttu-id="443ce-124">伺服器程式可以在名稱服務資料庫中通告自己。</span><span class="sxs-lookup"><span data-stu-id="443ce-124">Server programs can advertise themselves in the name service database.</span></span> <span data-ttu-id="443ce-125">當用戶端開始執行時，它可以從名稱服務資料庫取得其系結資訊。</span><span class="sxs-lookup"><span data-stu-id="443ce-125">When a client begins execution, it can obtain its binding information from the name service database.</span></span> <span data-ttu-id="443ce-126">如需詳細資訊，請參閱 [從名稱服務資料庫匯入](finding-server-host-systems.md)。</span><span class="sxs-lookup"><span data-stu-id="443ce-126">For details, see [Importing from Name Service Databases](finding-server-host-systems.md).</span></span>

<span data-ttu-id="443ce-127">下列主題將討論使用隱含和明確控制碼進行系結所需的步驟：</span><span class="sxs-lookup"><span data-stu-id="443ce-127">The steps required for binding with implicit and explicit handles are discussed in the following topics:</span></span>

-   [<span data-ttu-id="443ce-128">選取通訊協定順序</span><span class="sxs-lookup"><span data-stu-id="443ce-128">Selecting a Protocol Sequence</span></span>](selecting-a-protocol-sequence.md)
-   [<span data-ttu-id="443ce-129">尋找伺服器主機系統</span><span class="sxs-lookup"><span data-stu-id="443ce-129">Finding Server Host Systems</span></span>](finding-server-host-systems.md)
-   [<span data-ttu-id="443ce-130">尋找端點</span><span class="sxs-lookup"><span data-stu-id="443ce-130">Finding Endpoints</span></span>](finding-endpoints.md)

<span data-ttu-id="443ce-131">如需這些主題的簡短總覽，請參閱 [連接用戶端和伺服器](connecting-the-client-and-the-server.md)。</span><span class="sxs-lookup"><span data-stu-id="443ce-131">For a brief overview of these topics, see [Connecting the Client and the Server](connecting-the-client-and-the-server.md).</span></span>

 

 




