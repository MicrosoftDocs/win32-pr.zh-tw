---
title: 內容控制碼
description: 有時，分散式應用程式需要伺服器程式來維護用戶端呼叫之間的狀態資訊。
ms.assetid: 91732a75-0a3a-44bd-9db9-c11be6fd2d70
keywords:
- 遠端程序呼叫 RPC、描述、內容控制碼
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e73fb49a2e4c09ec818777389194df98e0d7b8bcac618d05ff7b519aefe5eb28
ms.sourcegitcommit: e6600f550f79bddfe58bd4696ac50dd52cb03d7e
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/11/2021
ms.locfileid: "120073418"
---
# <a name="context-handles"></a>內容控制碼

有時，分散式應用程式需要伺服器程式來維護用戶端呼叫之間的狀態資訊。 一次服務多個用戶端的伺服器程式必須保留每個用戶端的狀態資訊。 由於用戶端和伺服器在不同的電腦上使用不同的位址空間，而且它們不一定互相信任，通常資料共用的常見方法無法運作。 例如，用戶端和伺服器無法在其全域變數的遠端會話上維護狀態資訊，因為它們不會共用相同的全域位址空間。 因為它們是在不同的電腦上執行，所以很難將資訊保存在共用的檔案中。 簡單的方法可能是將所有狀態傳送給用戶端，並讓用戶端在下一次呼叫時傳回它，但是這個方法有個缺點：伺服器不一定會信任用戶端傳回正確的狀態，而且狀態可能會隱含地系結至伺服器上的其他狀態，例如，檔案控制代碼或開啟的通訊端。

Microsoft RPC 提供一個功能強大又安全的機制，稱為內容控制碼，可保持與伺服器上指定用戶端相關聯的狀態。 狀態資訊稱為伺服器的內容。 用戶端可以取得內容控制碼，以識別其個別 RPC 會話的伺服器內容。

例如，分散式應用程式中的每個用戶端都可以讓伺服器程式建立並更新其 RPC 會話的資料檔案。 伺服器可以使用其檔案控制代碼，將每個用戶端的資料檔案當作內容控制碼。 每次用戶端對伺服器為其建立的資料檔案要求作業時，用戶端會將內容控制碼傳遞至伺服器。 用戶端不會實際取得檔案控制代碼;它會取得不透明的 token，讓伺服器的 RPC 執行時間可以與檔案控制代碼唯一相關聯。 因為內容控制碼其實是一個檔案控制代碼，所以內容控制碼只有在伺服器的位址空間中才有意義。 不過，用戶端程式可以使用內容控制碼來告訴伺服器要執行更新的檔案。

其他資料也可以是內容控制碼。 例如，用戶端和伺服器可以使用資料庫記錄的記錄號碼做為檔案控制代碼。 如果用戶端需要在特定記錄上執行一些更新，它可以取得記錄號碼作為內容控制碼。 它會在每次叫用遠端程式來更新資料庫記錄時，將記錄號碼傳遞給伺服器。

內容控制碼通常會指向伺服器上的記憶體區塊，伺服器會在伺服器上保留各種管理資訊。

本節提供定義和使用內容控制碼的相關資訊。 以下主題會提供討論：

-   [使用內容控制碼進行介面開發](interface-development-using-context-handles.md)
-   [使用內容控制碼進行伺服器開發](server-development-using-context-handles.md)
-   [使用內容控制碼的用戶端開發](client-development-using-context-handles.md)
-   [伺服器內容執行例行常式](server-context-run-down-routine.md)
-   [用戶端內容重設](client-context-reset.md)
-   [多執行緒用戶端和內容控制碼](multithreaded-clients-and-context-handles.md)

 

 




