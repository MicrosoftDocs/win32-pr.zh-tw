---
title: 使用 IADs 介面
description: ADSI 中，目錄服務的每個專案都是以 ADSI 物件來表示，它是一種元件物件模型， (COM) 物件，此物件支援標準 COM IUnknown 介面以及 IDispatch 和 IADs 介面。
ms.assetid: bdbf2012-6863-4611-8173-6a3cd9c4960f
ms.tgt_platform: multiple
keywords:
- 使用 IADs ADSI
- ADSI ADSI，使用 IADs 介面
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 878afa9350a45f18238bebb69df1a96eba52715e
ms.sourcegitcommit: b0ebdefc3dcd5c04bede94091833aa1015a2f95c
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/21/2020
ms.locfileid: "104382873"
---
# <a name="using-the-iads-interfaces"></a><span data-ttu-id="449e5-105">使用 IADs 介面</span><span class="sxs-lookup"><span data-stu-id="449e5-105">Using the IADs Interfaces</span></span>

<span data-ttu-id="449e5-106">ADSI 中，目錄服務的每個專案都是以 ADSI 物件來表示，它是一種元件物件模型， (COM) 物件，此物件支援標準 COM [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown) 介面以及 [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) 和 [**IADs**](/windows/desktop/api/Iads/nn-iads-iads) 介面。</span><span class="sxs-lookup"><span data-stu-id="449e5-106">ADSI, each element of a directory service is represented by an ADSI object, which is a Component Object Model (COM) object that supports the standard COM [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown) interface as well as the [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) and [**IADs**](/windows/desktop/api/Iads/nn-iads-iads) interfaces.</span></span> <span data-ttu-id="449e5-107">**IADs** 提供 ADSI 物件的基本維護功能。</span><span class="sxs-lookup"><span data-stu-id="449e5-107">**IADs** supplies the basic maintenance functions for ADSI objects.</span></span>

<span data-ttu-id="449e5-108">每個 ADSI 物件都必須支援這個介面，此介面可用於：</span><span class="sxs-lookup"><span data-stu-id="449e5-108">Each ADSI object must support this interface, which serves to:</span></span>

-   <span data-ttu-id="449e5-109">依名稱、類別或 ADsPath 提供物件識別。</span><span class="sxs-lookup"><span data-stu-id="449e5-109">Provide object identification by name, class, or ADsPath.</span></span>
-   <span data-ttu-id="449e5-110">識別管理建立和刪除物件的物件容器。</span><span class="sxs-lookup"><span data-stu-id="449e5-110">Identify the object container that manages creating and deleting objects.</span></span>
-   <span data-ttu-id="449e5-111">取得物件架構定義。</span><span class="sxs-lookup"><span data-stu-id="449e5-111">Obtain the object schema definition.</span></span>
-   <span data-ttu-id="449e5-112">將物件屬性載入至屬性快取，並將變更認可至持續性目錄存放區。</span><span class="sxs-lookup"><span data-stu-id="449e5-112">Load the object attributes to the property cache and commit changes to the persistent directory store.</span></span>
-   <span data-ttu-id="449e5-113">存取和修改屬性快取中的物件屬性值。</span><span class="sxs-lookup"><span data-stu-id="449e5-113">Access and modify the object attribute values in the property cache.</span></span>

<span data-ttu-id="449e5-114">[**IADs**](/windows/desktop/api/Iads/nn-iads-iads)介面的設計目的，是要確保 ADSI 物件能以有效率且一致的方式來呈現各種基礎目錄服務，以提供網路系統管理員和目錄服務提供者。</span><span class="sxs-lookup"><span data-stu-id="449e5-114">The [**IADs**](/windows/desktop/api/Iads/nn-iads-iads) interface is designed to ensure that ADSI objects provide network administrators and directory service providers with an efficient and consistent representation of various underlying directory services.</span></span>

![支援 iads 介面的 adsi 物件](images/ds2iads.png)

<span data-ttu-id="449e5-116">上圖顯示一般的 ADSI 物件，它支援基本介面 [**IADs**](/windows/desktop/api/Iads/nn-iads-iads)、 [**IADsPropertyList**](/windows/desktop/api/Iads/nn-iads-iadspropertylist)、 [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown)、 [**IDirectoryObject**](/windows/desktop/api/Iads/nn-iads-idirectoryobject)和 [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch)。</span><span class="sxs-lookup"><span data-stu-id="449e5-116">The preceding figure shows a generic ADSI object that support the fundamental interfaces [**IADs**](/windows/desktop/api/Iads/nn-iads-iads), [**IADsPropertyList**](/windows/desktop/api/Iads/nn-iads-iadspropertylist), [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown), [**IDirectoryObject**](/windows/desktop/api/Iads/nn-iads-idirectoryobject), and [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch).</span></span> <span data-ttu-id="449e5-117">這類 ADSI 物件可透過支援的介面，管理來自基礎目錄服務之資料存放區的資料。</span><span class="sxs-lookup"><span data-stu-id="449e5-117">An ADSI object such as this manages data from the data store of the underlying directory service through the interfaces it supports.</span></span> <span data-ttu-id="449e5-118">這項資料稱為物件的屬性，而取得和設定這些屬性的常式則稱為屬性方法。</span><span class="sxs-lookup"><span data-stu-id="449e5-118">This data is known as the properties of the object, and the routines that obtain and set these properties are known as property methods.</span></span> <span data-ttu-id="449e5-119">唯讀屬性有一個可取得屬性值的屬性方法。</span><span class="sxs-lookup"><span data-stu-id="449e5-119">Read-only properties have one property method that obtains the property value.</span></span> <span data-ttu-id="449e5-120">讀取/寫入屬性有兩種方法：設定值的方法，以及可取得值的方法。</span><span class="sxs-lookup"><span data-stu-id="449e5-120">Read/write properties have two methods; a method that sets the value and one that obtains the value.</span></span> <span data-ttu-id="449e5-121">屬性會在每個使用 [屬性](the-adsi-attribute-cache.md)快取的 ADSI 物件上執行。</span><span class="sxs-lookup"><span data-stu-id="449e5-121">Properties are implemented on each ADSI object using a [property cache](the-adsi-attribute-cache.md).</span></span> <span data-ttu-id="449e5-122">[**IADs：： get \_ADsPath**](iads-property-methods.md) 和 **IADs：:p 的 ui \_ ADsPath** 是屬性方法的範例。</span><span class="sxs-lookup"><span data-stu-id="449e5-122">[**IADs::get\_ADsPath**](iads-property-methods.md) and **IADs::put\_ADsPath** are examples of property methods.</span></span> <span data-ttu-id="449e5-123">屬性方法對 Visual Basic 以及啟用屬性之直接參考的其他 Automation 用戶端來說並不明顯。</span><span class="sxs-lookup"><span data-stu-id="449e5-123">Property methods are not apparent to Visual Basic and other Automation clients that enable direct references to the property.</span></span> <span data-ttu-id="449e5-124">例如，Visual Basic 使用 **物件. adspath** 語法直接參考 **IADs：： adspath** 。</span><span class="sxs-lookup"><span data-stu-id="449e5-124">For example, Visual Basic refers to **IADs::ADsPath** directly using the **Object.ADsPath** syntax.</span></span> <span data-ttu-id="449e5-125">如需詳細資訊，請參閱 [介面屬性方法](interface-property-methods.md)。</span><span class="sxs-lookup"><span data-stu-id="449e5-125">For more information, see [Interface Property Methods](interface-property-methods.md).</span></span>

<span data-ttu-id="449e5-126">此外，ADSI 物件也會與其他 ADSI 物件互動，並透過方法直接與命名空間進行互動。</span><span class="sxs-lookup"><span data-stu-id="449e5-126">In addition, an ADSI object interacts with other ADSI objects and directly to a namespace through methods.</span></span> <span data-ttu-id="449e5-127">方法會立即執行。</span><span class="sxs-lookup"><span data-stu-id="449e5-127">Methods execute immediately.</span></span> <span data-ttu-id="449e5-128">方法的範例包括 [**IADs：： SetInfo**](/windows/desktop/api/Iads/nf-iads-iads-setinfo) 和 [**IADs：： GetInfo**](/windows/desktop/api/Iads/nf-iads-iads-getinfo)。</span><span class="sxs-lookup"><span data-stu-id="449e5-128">Examples of methods include [**IADs::SetInfo**](/windows/desktop/api/Iads/nf-iads-iads-setinfo) and [**IADs::GetInfo**](/windows/desktop/api/Iads/nf-iads-iads-getinfo).</span></span>

<span data-ttu-id="449e5-129">屬性（property）、屬性（property）方法和方法都可透過標準 COM 介面存取。</span><span class="sxs-lookup"><span data-stu-id="449e5-129">Properties, property methods, and methods are all accessed through standard COM interfaces.</span></span>

<span data-ttu-id="449e5-130">ADSI 物件是由其 ADsPath 唯一識別。</span><span class="sxs-lookup"><span data-stu-id="449e5-130">An ADSI object is uniquely identified by its ADsPath.</span></span> <span data-ttu-id="449e5-131">例如，LDAP 命名空間的 ADsPath 是 "LDAP://MyServer/DC=Fabrikam,DC=COM"。</span><span class="sxs-lookup"><span data-stu-id="449e5-131">For example, an ADsPath for the LDAP namespace is "LDAP://MyServer/DC=Fabrikam,DC=COM".</span></span> <span data-ttu-id="449e5-132">如需 ADsPaths 的詳細資訊，請參閱 [ADSI](binding-to-an-adsi-object.md)系結。</span><span class="sxs-lookup"><span data-stu-id="449e5-132">For more information about ADsPaths, see [ADSI Binding](binding-to-an-adsi-object.md).</span></span> <span data-ttu-id="449e5-133">針對熟悉 COM 名字標記的程式設計人員，這在概念上類似于 COM 的標記顯示名稱。</span><span class="sxs-lookup"><span data-stu-id="449e5-133">For programmers familiar with COM monikers, this is conceptually similar to the COM moniker display name.</span></span>

<span data-ttu-id="449e5-134">包含其他 ADSI 物件的 ADSI 物件（稱為 ADSI 容器物件）也支援 [**IADsContainer**](/windows/desktop/api/Iads/nn-iads-iadscontainer) 介面，這個介面會提供方法和屬性，以管理物件所包含的 ADSI 物件的建立、刪除和列舉。</span><span class="sxs-lookup"><span data-stu-id="449e5-134">Any ADSI object that contains other ADSI objects, called an ADSI container object, also supports the [**IADsContainer**](/windows/desktop/api/Iads/nn-iads-iadscontainer) interface, which provides methods and properties that manage the creation, deletion, and enumeration of ADSI objects contained by the object.</span></span> <span data-ttu-id="449e5-135">下圖顯示 ADSI 容器物件。</span><span class="sxs-lookup"><span data-stu-id="449e5-135">The following figure shows an ADSI container object.</span></span>

![adsi 容器物件](images/dsiadsc.png)

<span data-ttu-id="449e5-137">大部分的 ADSI 物件都是由其他物件所包含。</span><span class="sxs-lookup"><span data-stu-id="449e5-137">Most ADSI objects are contained by other objects.</span></span> <span data-ttu-id="449e5-138">唯一沒有父容器的 ADSI 物件是最上層的 ADSI **命名空間** 物件 ( 「ADS：」 ) 。</span><span class="sxs-lookup"><span data-stu-id="449e5-138">The only ADSI object with no parent container is the top-level ADSI **Namespaces** object ("ADS:").</span></span>

<span data-ttu-id="449e5-139">容器物件的 [**IADs：： SetInfo**](/windows/desktop/api/Iads/nf-iads-iads-setinfo) 方法會持續將 ADSI 容器物件的快取屬性儲存至儲存體，以及使用 [**IADsContainer：： Create**](/windows/desktop/api/Iads/nf-iads-iadscontainer-create) 方法建立的任何物件。</span><span class="sxs-lookup"><span data-stu-id="449e5-139">The [**IADs::SetInfo**](/windows/desktop/api/Iads/nf-iads-iads-setinfo) method on a container object persistently stores the cached properties of the ADSI container object to storage in addition to any objects created with the [**IADsContainer::Create**](/windows/desktop/api/Iads/nf-iads-iadscontainer-create) method.</span></span> <span data-ttu-id="449e5-140">[**IADsContainer：:D elete**](/windows/desktop/api/Iads/nf-iads-iadscontainer-delete) 不會影響屬性快取，但會刪除這個物件所代表的基礎命名空間目錄元素。</span><span class="sxs-lookup"><span data-stu-id="449e5-140">[**IADsContainer::Delete**](/windows/desktop/api/Iads/nf-iads-iadscontainer-delete) does not affect the property cache but deletes the underlying namespace directory element represented by this object.</span></span>

 

 