---
title: 建立和刪除物件
description: 使用 ADSI 時，會使用 IADsContainer 或 IDirectoryObject 介面來建立和刪除物件。
ms.assetid: 4d1f7ac5-48d3-4ea9-91e4-0cd4bb2ec9f8
ms.tgt_platform: multiple
keywords:
- 建立和刪除物件 ADSI
- ADSI、建立及刪除物件
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 4730c4cc6a95ad37bfd3953474d3d488fcf05abb
ms.sourcegitcommit: b0ebdefc3dcd5c04bede94091833aa1015a2f95c
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/21/2020
ms.locfileid: "104463704"
---
# <a name="creating-and-deleting-objects"></a><span data-ttu-id="15c1c-105">建立和刪除物件</span><span class="sxs-lookup"><span data-stu-id="15c1c-105">Creating and Deleting Objects</span></span>

<span data-ttu-id="15c1c-106">使用 ADSI 時，會使用 [**IADsContainer**](/windows/desktop/api/Iads/nn-iads-iadscontainer) 或 [**IDirectoryObject**](/windows/desktop/api/Iads/nn-iads-idirectoryobject) 介面來建立和刪除物件。</span><span class="sxs-lookup"><span data-stu-id="15c1c-106">With ADSI, objects are created and deleted using either the [**IADsContainer**](/windows/desktop/api/Iads/nn-iads-iadscontainer) or [**IDirectoryObject**](/windows/desktop/api/Iads/nn-iads-idirectoryobject) interface.</span></span>

## <a name="creating-an-object-with-iadscontainer"></a><span data-ttu-id="15c1c-107">使用 IADsContainer 建立物件</span><span class="sxs-lookup"><span data-stu-id="15c1c-107">Creating an Object with IADsContainer</span></span>

<span data-ttu-id="15c1c-108">**使用 IADsContainer 介面建立物件**</span><span class="sxs-lookup"><span data-stu-id="15c1c-108">**To create an object with the IADsContainer interface**</span></span>

1.  <span data-ttu-id="15c1c-109">系結至將包含要建立之物件的容器，並取得 [**IADsContainer**](/windows/desktop/api/Iads/nn-iads-iadscontainer) 介面。</span><span class="sxs-lookup"><span data-stu-id="15c1c-109">Bind to the container that will contain the object to be created and obtain the [**IADsContainer**](/windows/desktop/api/Iads/nn-iads-iadscontainer) interface.</span></span>
2.  <span data-ttu-id="15c1c-110">使用 [**IADsContainer**](/windows/desktop/api/Iads/nf-iads-iadscontainer-create) 建立方法，在容器中建立新的物件。</span><span class="sxs-lookup"><span data-stu-id="15c1c-110">Use the [**IADsContainer.Create**](/windows/desktop/api/Iads/nf-iads-iadscontainer-create) method to create a new object in the container.</span></span>
3.  <span data-ttu-id="15c1c-111">使用 [**IADs. Put**](/windows/desktop/api/Iads/nf-iads-iads-put) 或 [**IADs. PutEx**](/windows/desktop/api/Iads/nf-iads-iads-putex) 方法，為物件設定所有必要屬性的值。</span><span class="sxs-lookup"><span data-stu-id="15c1c-111">Set the values for all of the required attributes for the object using the [**IADs.Put**](/windows/desktop/api/Iads/nf-iads-iads-put) or [**IADs.PutEx**](/windows/desktop/api/Iads/nf-iads-iads-putex) method.</span></span> <span data-ttu-id="15c1c-112">建立物件所需的屬性將取決於目錄服務和建立的物件類型。</span><span class="sxs-lookup"><span data-stu-id="15c1c-112">The attributes required to create an object will depend on the directory service and the type of object created.</span></span> <span data-ttu-id="15c1c-113">如需建立 Active Directory 物件的詳細資訊，請參閱 [建立和刪除 Active Directory 物件](/windows/desktop/AD/creating-and-deleting-objects-in-active-directory-domain-services)。</span><span class="sxs-lookup"><span data-stu-id="15c1c-113">For more information about creating Active Directory objects, see [Creating and Deleting Active Directory Objects](/windows/desktop/AD/creating-and-deleting-objects-in-active-directory-domain-services).</span></span>
4.  <span data-ttu-id="15c1c-114">使用 [**IADs. Put**](/windows/desktop/api/Iads/nf-iads-iads-put) 或 [**IADs. PutEx**](/windows/desktop/api/Iads/nf-iads-iads-putex) 方法，為物件設定所有所需的選擇性屬性值。</span><span class="sxs-lookup"><span data-stu-id="15c1c-114">Set the values for all of the desired optional attributes for the object using the [**IADs.Put**](/windows/desktop/api/Iads/nf-iads-iads-put) or [**IADs.PutEx**](/windows/desktop/api/Iads/nf-iads-iads-putex) method.</span></span>
5.  <span data-ttu-id="15c1c-115">呼叫 [**IADs. SetInfo**](/windows/desktop/api/Iads/nf-iads-iads-setinfo) 方法來認可物件和其屬性。</span><span class="sxs-lookup"><span data-stu-id="15c1c-115">Call the [**IADs.SetInfo**](/windows/desktop/api/Iads/nf-iads-iads-setinfo) method to commit the object and its attributes.</span></span> <span data-ttu-id="15c1c-116">在呼叫 **IADs. SetInfo** 方法來認可屬性之前，不會實際在基礎目錄服務中建立新的物件。</span><span class="sxs-lookup"><span data-stu-id="15c1c-116">The new object is not actually created in the underlying directory service until the **IADs.SetInfo** method is called to commit the attributes.</span></span>

## <a name="creating-an-object-with-idirectoryobject"></a><span data-ttu-id="15c1c-117">使用 IDirectoryObject 建立物件</span><span class="sxs-lookup"><span data-stu-id="15c1c-117">Creating an Object with IDirectoryObject</span></span>

<span data-ttu-id="15c1c-118">**使用 IDirectoryObject 介面建立物件**</span><span class="sxs-lookup"><span data-stu-id="15c1c-118">**To create an object with the IDirectoryObject interface**</span></span>

1.  <span data-ttu-id="15c1c-119">系結至將包含要建立之物件的容器，並取得 [**IDirectoryObject**](/windows/desktop/api/Iads/nn-iads-idirectoryobject) 介面。</span><span class="sxs-lookup"><span data-stu-id="15c1c-119">Bind to the container that will contain the object to be created and obtain the [**IDirectoryObject**](/windows/desktop/api/Iads/nn-iads-idirectoryobject) interface.</span></span>
2.  <span data-ttu-id="15c1c-120">配置 [**ADS \_ ATTR \_ 資訊**](/windows/desktop/api/Iads/ns-iads-ads_attr_info) 結構的陣列，其中包含建立物件時要設定之每個屬性的一個結構。</span><span class="sxs-lookup"><span data-stu-id="15c1c-120">Allocate an array of [**ADS\_ATTR\_INFO**](/windows/desktop/api/Iads/ns-iads-ads_attr_info) structures that contains one structure for each attribute to be set when the object is created.</span></span>
3.  <span data-ttu-id="15c1c-121">針對物件的每個必要屬性填入 [**ADS \_ ATTR \_ 資訊**](/windows/desktop/api/Iads/ns-iads-ads_attr_info) 結構。</span><span class="sxs-lookup"><span data-stu-id="15c1c-121">Fill in an [**ADS\_ATTR\_INFO**](/windows/desktop/api/Iads/ns-iads-ads_attr_info) structure for each required attribute for the object.</span></span> <span data-ttu-id="15c1c-122">建立物件所需的屬性將取決於目錄服務和建立的物件類型。</span><span class="sxs-lookup"><span data-stu-id="15c1c-122">The attributes required to create an object will depend on the directory service and the type of object created.</span></span> <span data-ttu-id="15c1c-123">如需建立 Active Directory 物件的詳細資訊，請參閱 [建立和刪除 Active Directory 物件](/windows/desktop/AD/creating-and-deleting-objects-in-active-directory-domain-services)。</span><span class="sxs-lookup"><span data-stu-id="15c1c-123">For more information about creating Active Directory objects, see [Creating and Deleting Active Directory Objects](/windows/desktop/AD/creating-and-deleting-objects-in-active-directory-domain-services).</span></span>
4.  <span data-ttu-id="15c1c-124">針對物件的每個選擇性屬性，填入 [**ADS \_ ATTR \_ 資訊**](/windows/desktop/api/Iads/ns-iads-ads_attr_info) 結構。</span><span class="sxs-lookup"><span data-stu-id="15c1c-124">Fill in an [**ADS\_ATTR\_INFO**](/windows/desktop/api/Iads/ns-iads-ads_attr_info) structure for each optional attribute for the object.</span></span>
5.  <span data-ttu-id="15c1c-125">使用 [**IDirectoryObject：： CreateDSObject**](/windows/desktop/api/Iads/nf-iads-idirectoryobject-createdsobject) 方法，在容器中建立物件。</span><span class="sxs-lookup"><span data-stu-id="15c1c-125">Use the [**IDirectoryObject::CreateDSObject**](/windows/desktop/api/Iads/nf-iads-idirectoryobject-createdsobject) method to create the object in the container.</span></span> <span data-ttu-id="15c1c-126">這個方法也會將物件認可至基礎目錄服務。</span><span class="sxs-lookup"><span data-stu-id="15c1c-126">This method also commits the object to the underlying directory service.</span></span> <span data-ttu-id="15c1c-127">如果 [**ADS \_ ATTR \_ INFO**](/windows/desktop/api/Iads/ns-iads-ads_attr_info) 陣列未包含物件的所有必要屬性， **IDirectoryObject：： CreateDSObject** 將會失敗。</span><span class="sxs-lookup"><span data-stu-id="15c1c-127">If the [**ADS\_ATTR\_INFO**](/windows/desktop/api/Iads/ns-iads-ads_attr_info) array does not contain all of the required attributes for the object, **IDirectoryObject::CreateDSObject** will fail.</span></span>

## <a name="deleting-an-object"></a><span data-ttu-id="15c1c-128">刪除物件</span><span class="sxs-lookup"><span data-stu-id="15c1c-128">Deleting an Object</span></span>

<span data-ttu-id="15c1c-129">若要刪除物件，請使用 [**IADsContainer：:D elete**](/windows/desktop/api/Iads/nf-iads-iadscontainer-delete) 或 [**IDirectoryObject：:D eletedsobject**](/windows/desktop/api/Iads/nf-iads-idirectoryobject-deletedsobject) 方法。</span><span class="sxs-lookup"><span data-stu-id="15c1c-129">To delete an object use the [**IADsContainer::Delete**](/windows/desktop/api/Iads/nf-iads-iadscontainer-delete) or the [**IDirectoryObject::DeleteDSObject**](/windows/desktop/api/Iads/nf-iads-idirectoryobject-deletedsobject) method.</span></span> <span data-ttu-id="15c1c-130">如果已刪除的物件包含任何子物件，這些方法將會失敗。</span><span class="sxs-lookup"><span data-stu-id="15c1c-130">These methods will fail if the deleted object contains any child objects.</span></span> <span data-ttu-id="15c1c-131">使用 [**IADsDeleteOps：:D eleteobject**](/windows/desktop/api/Iads/nf-iads-iadsdeleteops-deleteobject) 方法來刪除容器以及容器的所有子物件。</span><span class="sxs-lookup"><span data-stu-id="15c1c-131">Use the [**IADsDeleteOps::DeleteObject**](/windows/desktop/api/Iads/nf-iads-iadsdeleteops-deleteobject) method to delete a container and all of the container's child objects.</span></span>

<span data-ttu-id="15c1c-132">刪除的物件會發生什麼事取決於基礎目錄服務。</span><span class="sxs-lookup"><span data-stu-id="15c1c-132">What happens to a deleted object depends on the underlying directory service.</span></span> <span data-ttu-id="15c1c-133">如需刪除 Active Directory 物件的詳細資訊，請參閱 [建立和刪除 Active Directory 物件](/windows/desktop/AD/creating-and-deleting-objects-in-active-directory-domain-services)。</span><span class="sxs-lookup"><span data-stu-id="15c1c-133">For more information about deleting Active Directory objects, see [Creating and Deleting Active Directory Objects](/windows/desktop/AD/creating-and-deleting-objects-in-active-directory-domain-services).</span></span>

 

 