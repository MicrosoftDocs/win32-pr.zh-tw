---
title: 核心執行
description: ADSI 提供者支援下列功能
ms.assetid: 39798237-a181-43b4-8441-ac711f923d4d
ms.tgt_platform: multiple
keywords:
- core 實行 ADSI
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f62068bd77553f89e222422431811da1ef251ccd
ms.sourcegitcommit: b0ebdefc3dcd5c04bede94091833aa1015a2f95c
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/21/2020
ms.locfileid: "104024095"
---
# <a name="core-implementation"></a><span data-ttu-id="12c76-104">核心執行</span><span class="sxs-lookup"><span data-stu-id="12c76-104">Core Implementation</span></span>

<span data-ttu-id="12c76-105">ADSI 提供者支援下列功能：</span><span class="sxs-lookup"><span data-stu-id="12c76-105">An ADSI provider supports the following features:</span></span>

-   <span data-ttu-id="12c76-106">COM 和 URL 格式的 ADsPath 字串。</span><span class="sxs-lookup"><span data-stu-id="12c76-106">ADsPath strings in both COM and URL format.</span></span> <span data-ttu-id="12c76-107">根據定義，您可以使用 ADsPath 取出 Active Directory 物件。</span><span class="sxs-lookup"><span data-stu-id="12c76-107">By definition, you can retrieve an Active Directory object using an ADsPath.</span></span> <span data-ttu-id="12c76-108">提供者支援其目錄服務使用 **ParseDisplayName** 執行所需的語法。</span><span class="sxs-lookup"><span data-stu-id="12c76-108">Providers support the syntax that their directory service requires using the **ParseDisplayName** implementation.</span></span>
-   <span data-ttu-id="12c76-109">最上層命名空間物件，支援 [**IParseDisplayName：:P arsedisplayname**](/windows/win32/api/oleidl/nf-oleidl-iparsedisplayname-parsedisplayname) 和 [**IADsOpenDSObject**](/windows/desktop/api/Iads/nn-iads-iadsopendsobject)。</span><span class="sxs-lookup"><span data-stu-id="12c76-109">A top-level Namespace object that supports [**IParseDisplayName::ParseDisplayName**](/windows/win32/api/oleidl/nf-oleidl-iparsedisplayname-parsedisplayname) and [**IADsOpenDSObject**](/windows/desktop/api/Iads/nn-iads-iadsopendsobject).</span></span> <span data-ttu-id="12c76-110">此物件包含此命名空間的根節點。</span><span class="sxs-lookup"><span data-stu-id="12c76-110">This object contains the root nodes for this namespace.</span></span> <span data-ttu-id="12c76-111">**ParseDisplayName** 實作為的一部分必須包含剖析器，以檢查它自己的命名空間是否有語法錯誤。</span><span class="sxs-lookup"><span data-stu-id="12c76-111">Part of the **ParseDisplayName** implementation must include a parser that checks for syntax errors for its own namespace.</span></span> <span data-ttu-id="12c76-112">此物件也必須支援 [**IADs**](/windows/desktop/api/Iads/nn-iads-iads) 和 **IADsOpenDSObject**。</span><span class="sxs-lookup"><span data-stu-id="12c76-112">This object must also support [**IADs**](/windows/desktop/api/Iads/nn-iads-iads) and **IADsOpenDSObject**.</span></span>
-   <span data-ttu-id="12c76-113">[**IADs**](/windows/desktop/api/Iads/nn-iads-iads)介面。</span><span class="sxs-lookup"><span data-stu-id="12c76-113">The [**IADs**](/windows/desktop/api/Iads/nn-iads-iads) interface.</span></span> <span data-ttu-id="12c76-114">這包括透過 [**IADs：： GetInfo**](/windows/desktop/api/Iads/nf-iads-iads-getinfo) 和 [**IADs：： SetInfo**](/windows/desktop/api/Iads/nf-iads-iads-setinfo)的簡單屬性快取執行。</span><span class="sxs-lookup"><span data-stu-id="12c76-114">This includes a simple property cache implementation through [**IADs::GetInfo**](/windows/desktop/api/Iads/nf-iads-iads-getinfo) and [**IADs::SetInfo**](/windows/desktop/api/Iads/nf-iads-iads-setinfo).</span></span> <span data-ttu-id="12c76-115">取得或設定物件屬性的作業會在快取模式下發生。</span><span class="sxs-lookup"><span data-stu-id="12c76-115">Operations that get or set object properties occur in cached mode.</span></span> <span data-ttu-id="12c76-116">快取值會在 **IADs：： SetInfo** 期間寫入基礎目錄存放區。</span><span class="sxs-lookup"><span data-stu-id="12c76-116">Cache values are written to the underlying directory store during **IADs::SetInfo**.</span></span> <span data-ttu-id="12c76-117">不過，ADSI 方法不會被快取，但會立即執行。</span><span class="sxs-lookup"><span data-stu-id="12c76-117">An ADSI method, however, is not cached, but executes immediately.</span></span>
-   <span data-ttu-id="12c76-118">[**IADsPropertyList**](/windows/desktop/api/Iads/nn-iads-iadspropertylist)、 [**IADsPropertyEntry**](/windows/desktop/api/Iads/nn-iads-iadspropertyentry)和 [**IADsPropertyValue**](/windows/desktop/api/Iads/nn-iads-iadspropertyvalue)介面，可直接存取和列舉屬性快取中的屬性。</span><span class="sxs-lookup"><span data-stu-id="12c76-118">The [**IADsPropertyList**](/windows/desktop/api/Iads/nn-iads-iadspropertylist), [**IADsPropertyEntry**](/windows/desktop/api/Iads/nn-iads-iadspropertyentry) and [**IADsPropertyValue**](/windows/desktop/api/Iads/nn-iads-iadspropertyvalue) interfaces for directly accessing and enumerating the properties in the property cache.</span></span> <span data-ttu-id="12c76-119">對於不公開架構的目錄服務，此介面可讓您操作物件的屬性。</span><span class="sxs-lookup"><span data-stu-id="12c76-119">For directory services that do not expose a schema, this interface allows you to manipulate the properties of an object.</span></span>
-   <span data-ttu-id="12c76-120">非自動化用戶端的 [**IDirectoryObject**](/windows/desktop/api/Iads/nn-iads-idirectoryobject) 介面。</span><span class="sxs-lookup"><span data-stu-id="12c76-120">The [**IDirectoryObject**](/windows/desktop/api/Iads/nn-iads-idirectoryobject) interface for non-Automation clients.</span></span> <span data-ttu-id="12c76-121">這會使用無線通訊協定來取得最大效能，並略過屬性快取。</span><span class="sxs-lookup"><span data-stu-id="12c76-121">This uses over-the-wire protocol for maximum performance and bypasses the property cache.</span></span>
-   <span data-ttu-id="12c76-122">[**IADsContainer**](/windows/desktop/api/Iads/nn-iads-iadscontainer)介面。</span><span class="sxs-lookup"><span data-stu-id="12c76-122">The [**IADsContainer**](/windows/desktop/api/Iads/nn-iads-iadscontainer) interface.</span></span> <span data-ttu-id="12c76-123">每個 Active Directory 物件都有控制其存留期的父容器。</span><span class="sxs-lookup"><span data-stu-id="12c76-123">Every Active Directory object has a parent container that controls its lifetime.</span></span> <span data-ttu-id="12c76-124">請注意，針對 ADs 容器物件， [**IADs：： GetInfo**](/windows/desktop/api/Iads/nf-iads-iads-getinfo) 只會影響容器屬性，而不會影響其內容。</span><span class="sxs-lookup"><span data-stu-id="12c76-124">Be aware that for ADs container objects, [**IADs::GetInfo**](/windows/desktop/api/Iads/nf-iads-iads-getinfo) affects only the container properties and not its contents.</span></span> <span data-ttu-id="12c76-125">SetInfo on ADs 容器物件只會影響容器屬性，而不會影響容器內已存在的新建立物件或物件。</span><span class="sxs-lookup"><span data-stu-id="12c76-125">SetInfo on ADs container objects affects only the container properties and does not affect newly created objects or objects that already exist within the container.</span></span>
-   <span data-ttu-id="12c76-126">[**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch)介面。</span><span class="sxs-lookup"><span data-stu-id="12c76-126">The [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) interface.</span></span> <span data-ttu-id="12c76-127">這是不使用編譯時間系結之語言（例如 Visual Basic Scripting Edition）的自動化介面。</span><span class="sxs-lookup"><span data-stu-id="12c76-127">This is the Automation interface for languages like Visual Basic Scripting Edition, that do not use compile-time binding.</span></span> <span data-ttu-id="12c76-128">與此相關的是提供者必須提供的類型程式庫資料。</span><span class="sxs-lookup"><span data-stu-id="12c76-128">Related to this is the type library data that a provider must supply.</span></span> <span data-ttu-id="12c76-129">如需詳細資訊，請參閱 [ADSI 提供者的執行問題](implementation-issues-for-adsi-providers.md)。</span><span class="sxs-lookup"><span data-stu-id="12c76-129">For more information, see [Implementation Issues for ADSI Providers](implementation-issues-for-adsi-providers.md).</span></span>
-   <span data-ttu-id="12c76-130">架構類別容器物件和適當的語法、屬性和架構類別物件，分別支援 [**IADsSyntax**](/windows/desktop/api/Iads/nn-iads-iadssyntax)、 [**IADsProperty**](/windows/desktop/api/Iads/nn-iads-iadsproperty)和 [**得到 iadsclass**](/windows/desktop/api/Iads/nn-iads-iadsclass) 。</span><span class="sxs-lookup"><span data-stu-id="12c76-130">A schema class container object and the appropriate syntax, property, and schema class objects that support [**IADsSyntax**](/windows/desktop/api/Iads/nn-iads-iadssyntax), [**IADsProperty**](/windows/desktop/api/Iads/nn-iads-iadsproperty), and [**IADsClass**](/windows/desktop/api/Iads/nn-iads-iadsclass) respectively.</span></span> <span data-ttu-id="12c76-131">每個根節點至少必須包含自己的架構類別容器物件。</span><span class="sxs-lookup"><span data-stu-id="12c76-131">At a minimum, each root node must contain its own schema class container object.</span></span>
-   <span data-ttu-id="12c76-132">[**IADsMembers**](/windows/desktop/api/Iads/nn-iads-iadsmembers)介面（如果任何支援的屬性是 ADSI 物件的集合，例如安全性群組）。</span><span class="sxs-lookup"><span data-stu-id="12c76-132">The [**IADsMembers**](/windows/desktop/api/Iads/nn-iads-iadsmembers) interface, if any supported attributes are collections of ADSI objects, such as security groups.</span></span>
-   <span data-ttu-id="12c76-133">[**IADsCollection**](/windows/desktop/api/Iads/nn-iads-iadscollection)介面，如果任何支援的屬性是具有 [**IADsCollection：： Add**](/windows/desktop/api/Iads/nf-iads-iadscollection-add)和 [**IADsCollection：： Remove**](/windows/desktop/api/Iads/nf-iads-iadscollection-remove)功能的相同目錄元素類型集合。</span><span class="sxs-lookup"><span data-stu-id="12c76-133">The [**IADsCollection**](/windows/desktop/api/Iads/nn-iads-iadscollection) interface, if any supported attributes are collections of the same directory element type with [**IADsCollection::Add**](/windows/desktop/api/Iads/nf-iads-iadscollection-add) and [**IADsCollection::Remove**](/windows/desktop/api/Iads/nf-iads-iadscollection-remove) capability.</span></span>
-   <span data-ttu-id="12c76-134">**IEnumXXXX** 列舉支援所有特定的列舉值物件。</span><span class="sxs-lookup"><span data-stu-id="12c76-134">The **IEnumXXXX** enumeration supports all specific enumerator objects.</span></span>
-   <span data-ttu-id="12c76-135">對應語法的常式，並將原生資料轉換成 [**VARIANT**](/windows/win32/api/oaidl/ns-oaidl-variant) 資料類型。</span><span class="sxs-lookup"><span data-stu-id="12c76-135">Routines to map syntax and convert native data to the [**VARIANT**](/windows/win32/api/oaidl/ns-oaidl-variant) data type.</span></span>
-   <span data-ttu-id="12c76-136">遵循提供者提供的 ADSI 物件的 ADSI 慣例。</span><span class="sxs-lookup"><span data-stu-id="12c76-136">Follow ADSI conventions for provider-supplied ADSI objects.</span></span> <span data-ttu-id="12c76-137">包含說明檔和型別程式庫，可記錄介面屬性和方法。</span><span class="sxs-lookup"><span data-stu-id="12c76-137">Include help files and type libraries documenting the interface properties and methods.</span></span>

<span data-ttu-id="12c76-138">如同任何 COM 執行，對 [**QueryInterface**](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(q))的呼叫必須針對未提供的介面傳回 **e \_ NOINTERFACE** 、針對未完成的介面傳回 e **\_ >notimpl** ，否則會實作為未執行的介面不支援的方法，並傳回未完成屬性 **\_ \_ \_ 不 \_ 支援的 e ADS 屬性**</span><span class="sxs-lookup"><span data-stu-id="12c76-138">As with any COM implementation, calls to [**QueryInterface**](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) must return **E\_NOINTERFACE** for unimplemented interfaces, **E\_NOTIMPL** for unimplemented methods of interfaces that are otherwise implemented and return **E\_ADS\_PROPERTY\_NOT\_SUPPORTED** for unimplemented properties.</span></span> <span data-ttu-id="12c76-139">如需雙重介面以及它們如何影響屬性執行的詳細資訊，請參閱 [雙重介面](dual-interfaces.md)。</span><span class="sxs-lookup"><span data-stu-id="12c76-139">For more information about dual interfaces and how they affect property implementation, see [Dual Interfaces](dual-interfaces.md).</span></span>

 

 