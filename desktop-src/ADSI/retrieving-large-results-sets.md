---
title: 正在抓取大型結果集
description: 有可能傳回的結果集將包含超過1000個專案時，您必須使用分頁搜尋。
ms.assetid: 1439d6b8-50dd-4d37-bcc9-dd0f63af865f
ms.tgt_platform: multiple
keywords:
- 正在抓取大型結果集 ADSI
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 7d5a8f920da20de70538a57674b00de33ac6df3a6f4b12e6027134557fd9ee28
ms.sourcegitcommit: e6600f550f79bddfe58bd4696ac50dd52cb03d7e
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/11/2021
ms.locfileid: "119391798"
---
# <a name="retrieving-large-results-sets"></a>正在抓取大型結果集

有可能傳回的結果集將包含超過1000個專案時，您必須使用分頁搜尋。 在不使用分頁的情況下搜尋 Active Directory，只會傳回最多前1000筆記錄。 使用分頁搜尋時，結果集會顯示為個別頁面，每個頁面都包含預定數量的結果專案。 使用這種搜尋時，會傳回結果專案的新頁面，直到到達結果集的結尾為止。

根據預設，回應查詢要求的伺服器會完全計算結果集，然後才傳回資料。 在大型結果集中，這會在取得結果集時需要伺服器記憶體，並在傳回大型結果時使用網路頻寬。 設定頁面大小可讓伺服器在建立頁面時傳送頁面中的資料。 然後，用戶端會快取此資料，並將資料指標提供至應用程式層級程式碼。 分頁的設定方式是定義伺服器在透過網路將資料傳回給用戶端之前所計算的資料列數目。

分頁搜尋提供用戶端和伺服器的優點。 例如，將結果呈現給使用者時，用戶端可能會更有回應。 這特別適用于可顯示資料的圖形化使用者介面工具，而另一個執行緒同時從伺服器接收更多資料。

當您設定查詢時，如果您指定結果集的排序次序，則伺服器必須在將資料傳回給用戶端之前，先完整計算結果集，這會影響查詢的回應時間。

在伺服器端，分頁搜尋可調整作業。 例如，如果100用戶端同時發出搜尋要求，且平均每個用戶端傳回200個物件，則如果未指定頁面大小，伺服器必須有足夠的記憶體來保存完整的20000專案結果集。 或者，如果每個用戶端都指定了10個物件的頁面大小，伺服器上的記憶體需求將會以20倍來減少。

> [!Note]  
> 並非所有目錄服務都支援分頁搜尋。 Active Directory 實行頁面大小架構。

 

如果用戶端未指定頁面大小，許多目錄伺服器會指定可傳回的最大物件數目的管理限制。 當達到系統管理限制時，ADSI 會產生 **錯誤 \_ DS 系統 \_ 管理員 \_ 限制 \_ 超過** Win32 錯誤。

在用戶端上，分頁搜尋可讓用戶端在作業仍在進行時停止作業。 相反地，在非分頁的搜尋中，用戶端會被封鎖，直到資料完全傳回，否則會發生錯誤。 如果結果集變得較大且花費的時間超出預期，這可能會影響網路效能。

ADSI 會代表用戶端以透明的方式處理頁面大小。 用戶端不需要計算正在進行中的物件數目。 ADSI 會封裝用戶端的伺服器互動。 從用戶端的觀點來看，搜尋會傳回完整的結果集。

如需搭配特定搜尋介面使用 [搜尋超時] 選項的詳細資訊，請參閱：

-   [使用 >idirectorysearch 進行分頁](paging-with-idirectorysearch.md)
-   [使用 ActiveX Data Objects 搜尋](searching-with-activex-data-objects-ado.md)
-   [使用 OLE DB 搜尋](searching-with-ole-db.md)

分頁搜尋對您的應用程式而言是透明的，因為 ADSI 會自動繼續抓取其他頁面的結果，直到到達結果集的結尾或您設定的時間限制結束為止。 當您使用分頁搜尋時，大小限制不會覆寫頁面大小。 只有在您抓取包含少於1000個專案的結果集時，才能使用大小限制。

 

 




