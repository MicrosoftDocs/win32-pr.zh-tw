---
title: REGDSAPI.Cpp
description: 在範例提供者元件中，代表直接存取原生作業系統之 API 的函式位於 Regdsapi .cpp 中。
ms.assetid: dc5ab286-5c70-43a3-90a1-f3f8a1c61c43
ms.tgt_platform: multiple
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e160ab212960753c6f793f734ebd96dffdd0f9e1
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 09/16/2019
ms.locfileid: "104300067"
---
# <a name="regdsapicpp"></a><span data-ttu-id="fda46-103">REGDSAPI.Cpp</span><span class="sxs-lookup"><span data-stu-id="fda46-103">REGDSAPI.CPP</span></span>

<span data-ttu-id="fda46-104">在範例提供者元件中，代表直接存取原生作業系統之 API 的函式位於 Regdsapi .cpp 中。</span><span class="sxs-lookup"><span data-stu-id="fda46-104">In the example provider component, functions that represent an API that directly accesses the native operating system are in Regdsapi.cpp.</span></span> <span data-ttu-id="fda46-105">範例提供者元件會在登錄中執行其目錄服務。</span><span class="sxs-lookup"><span data-stu-id="fda46-105">The example provider component implements its directory service in the registry.</span></span> <span data-ttu-id="fda46-106">若要撰寫可存取您自己目錄服務的提供者，請建立您自己的此 API 的實作為。</span><span class="sxs-lookup"><span data-stu-id="fda46-106">To write a provider that accesses your own directory service, create your own implementations of this API.</span></span> <span data-ttu-id="fda46-107">下表列出支援的功能。</span><span class="sxs-lookup"><span data-stu-id="fda46-107">Supported functions are listed in the following table.</span></span>



| <span data-ttu-id="fda46-108">方法</span><span class="sxs-lookup"><span data-stu-id="fda46-108">Method</span></span>                             | <span data-ttu-id="fda46-109">描述</span><span class="sxs-lookup"><span data-stu-id="fda46-109">Description</span></span>                                                                                                                                                                                    |
|------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="fda46-110">**SampleDSOpenObject**</span><span class="sxs-lookup"><span data-stu-id="fda46-110">**SampleDSOpenObject**</span></span>             | <span data-ttu-id="fda46-111">依名稱開啟此物件。</span><span class="sxs-lookup"><span data-stu-id="fda46-111">Open this object by name.</span></span> <span data-ttu-id="fda46-112">如果架構類別型別參數為 **Null**，請填入找到的類型。</span><span class="sxs-lookup"><span data-stu-id="fda46-112">If the schema class type parameter is **NULL**, fill in the type found.</span></span> <span data-ttu-id="fda46-113">取得物件的控制碼。</span><span class="sxs-lookup"><span data-stu-id="fda46-113">Retrieve a handle on the object.</span></span>                                                             |
| <span data-ttu-id="fda46-114">**SampleDSCloseObject**</span><span class="sxs-lookup"><span data-stu-id="fda46-114">**SampleDSCloseObject**</span></span>            | <span data-ttu-id="fda46-115">使用 **SampleDSOpenObject** 取出的控制碼。</span><span class="sxs-lookup"><span data-stu-id="fda46-115">Use the handle retrieved by **SampleDSOpenObject**.</span></span>                                                                                                                                            |
| <span data-ttu-id="fda46-116">**SampleDSRDNEnum**</span><span class="sxs-lookup"><span data-stu-id="fda46-116">**SampleDSRDNEnum**</span></span>                | <span data-ttu-id="fda46-117">取得列舉值物件的控制碼，以管理從容器物件 (RDNs) 的相對辨別名稱列舉。</span><span class="sxs-lookup"><span data-stu-id="fda46-117">Retrieve the handle on an enumerator object to manage the enumeration of relative distinguished names (RDNs) from a container object.</span></span>                                                          |
| <span data-ttu-id="fda46-118">**SampleDSNextRDN**</span><span class="sxs-lookup"><span data-stu-id="fda46-118">**SampleDSNextRDN**</span></span>                | <span data-ttu-id="fda46-119">使用 **SampleDSRDNEnum** 抓取的控制碼，從這個容器物件取得下一個相對分辨名稱。</span><span class="sxs-lookup"><span data-stu-id="fda46-119">Using the handle retrieved by **SampleDSRDNEnum**, get the next relative distinguished name from this container object.</span></span>                                                                        |
| <span data-ttu-id="fda46-120">**SampleDSFreeEnum**</span><span class="sxs-lookup"><span data-stu-id="fda46-120">**SampleDSFreeEnum**</span></span>               | <span data-ttu-id="fda46-121">釋放在 **SampleDSRDNEnum** 中配置的列舉值物件。</span><span class="sxs-lookup"><span data-stu-id="fda46-121">Free the enumerator object allocated in **SampleDSRDNEnum**.</span></span>                                                                                                                                   |
| <span data-ttu-id="fda46-122">**SampleDSModifyObject**</span><span class="sxs-lookup"><span data-stu-id="fda46-122">**SampleDSModifyObject**</span></span>           | <span data-ttu-id="fda46-123">修改目錄服務中物件的屬性，並指定物件的控制碼，以及屬性及其值的清單。</span><span class="sxs-lookup"><span data-stu-id="fda46-123">Modify properties of an object in the directory service given the handle of the object and a list of attributes and their values.</span></span>                                                              |
| <span data-ttu-id="fda46-124">**SampleDSReadObject**</span><span class="sxs-lookup"><span data-stu-id="fda46-124">**SampleDSReadObject**</span></span>             | <span data-ttu-id="fda46-125">從目錄服務讀取物件的屬性。</span><span class="sxs-lookup"><span data-stu-id="fda46-125">Read the properties of the object from the directory service.</span></span> <span data-ttu-id="fda46-126">將原生儲存的語法對應至適當的 ADS 語法值。</span><span class="sxs-lookup"><span data-stu-id="fda46-126">Map the syntax from the native storage to the appropriate ADS syntax values.</span></span> <span data-ttu-id="fda46-127">據以處理多個值的屬性。</span><span class="sxs-lookup"><span data-stu-id="fda46-127">Handle properties with multiple values accordingly.</span></span> |
| <span data-ttu-id="fda46-128">**SampleDSGetPropertyDefinition**</span><span class="sxs-lookup"><span data-stu-id="fda46-128">**SampleDSGetPropertyDefinition**</span></span>  | <span data-ttu-id="fda46-129">在架構中，針對此類型的架構類別物件，查閱所有屬性定義和其屬性。</span><span class="sxs-lookup"><span data-stu-id="fda46-129">In the schema, look up all property definitions and their attributes for this type of schema class object.</span></span>                                                                                     |
| <span data-ttu-id="fda46-130">**SampleDSGetPropertyDefinition**</span><span class="sxs-lookup"><span data-stu-id="fda46-130">**SampleDSGetPropertyDefinition**</span></span>  | <span data-ttu-id="fda46-131">在架構中，依名稱查閱此屬性和其屬性。</span><span class="sxs-lookup"><span data-stu-id="fda46-131">In the schema, look up this property and its attributes by name.</span></span>                                                                                                                               |
| <span data-ttu-id="fda46-132">**SampleDSFreePropertyDefinition**</span><span class="sxs-lookup"><span data-stu-id="fda46-132">**SampleDSFreePropertyDefinition**</span></span> | <span data-ttu-id="fda46-133">**GetPropertyDefinition** 所配置的可用記憶體。</span><span class="sxs-lookup"><span data-stu-id="fda46-133">Free memory allocated by **GetPropertyDefinition**.</span></span>                                                                                                                                            |
| <span data-ttu-id="fda46-134">**SampleDSGetTypeText**</span><span class="sxs-lookup"><span data-stu-id="fda46-134">**SampleDSGetTypeText**</span></span>            | <span data-ttu-id="fda46-135">以文字格式取得物件的架構類別類型。</span><span class="sxs-lookup"><span data-stu-id="fda46-135">Get the schema class type of an object in text format.</span></span>                                                                                                                                         |
| <span data-ttu-id="fda46-136">**SampleDSGetType**</span><span class="sxs-lookup"><span data-stu-id="fda46-136">**SampleDSGetType**</span></span>                | <span data-ttu-id="fda46-137">取得物件的架構類別型別。</span><span class="sxs-lookup"><span data-stu-id="fda46-137">Get the schema class type of an object.</span></span>                                                                                                                                                        |
| <span data-ttu-id="fda46-138">**SampleDSGetPropertyInfo**</span><span class="sxs-lookup"><span data-stu-id="fda46-138">**SampleDSGetPropertyInfo**</span></span>        | <span data-ttu-id="fda46-139">在架構類別物件和屬性名稱上提供控制碼，以抓取屬性資訊，例如語法等等。</span><span class="sxs-lookup"><span data-stu-id="fda46-139">Given a handle on the schema class object and a property name, retrieve the property information, like syntax, and so on.</span></span>                                                                      |
| <span data-ttu-id="fda46-140">**FreeList**</span><span class="sxs-lookup"><span data-stu-id="fda46-140">**FreeList**</span></span>                       | <span data-ttu-id="fda46-141">釋放 LPWSTR 清單所使用的記憶體 \_ 。</span><span class="sxs-lookup"><span data-stu-id="fda46-141">Free the memory used by a LPWSTR\_LIST.</span></span>                                                                                                                                                        |
| <span data-ttu-id="fda46-142">**SampleDSGetClassDefinition**</span><span class="sxs-lookup"><span data-stu-id="fda46-142">**SampleDSGetClassDefinition**</span></span>     | <span data-ttu-id="fda46-143">從架構中取出所有架構類別定義和其相關資料的集合。</span><span class="sxs-lookup"><span data-stu-id="fda46-143">Retrieve the set of all schema class definitions and their associated data from the schema.</span></span>                                                                                                    |
| <span data-ttu-id="fda46-144">**SampleDSGetClassDefinition**</span><span class="sxs-lookup"><span data-stu-id="fda46-144">**SampleDSGetClassDefinition**</span></span>     | <span data-ttu-id="fda46-145">取得架構中特定架構類別的相關資料。</span><span class="sxs-lookup"><span data-stu-id="fda46-145">Retrieve data about a particular schema class in the schema.</span></span>                                                                                                                                   |
| <span data-ttu-id="fda46-146">**SampleDSGetClassInfo**</span><span class="sxs-lookup"><span data-stu-id="fda46-146">**SampleDSGetClassInfo**</span></span>           | <span data-ttu-id="fda46-147">指定架構類別的名稱，查詢其相關聯的資料，例如強制屬性。</span><span class="sxs-lookup"><span data-stu-id="fda46-147">Given the name of a schema class, look up its associated data, like mandatory properties.</span></span>                                                                                                      |
| <span data-ttu-id="fda46-148">**SampleDSAddObject**</span><span class="sxs-lookup"><span data-stu-id="fda46-148">**SampleDSAddObject**</span></span>              | <span data-ttu-id="fda46-149">在目錄服務中新增物件。</span><span class="sxs-lookup"><span data-stu-id="fda46-149">Add an object in the directory service.</span></span>                                                                                                                                                        |
| <span data-ttu-id="fda46-150">**SampleDSRemoveObject**</span><span class="sxs-lookup"><span data-stu-id="fda46-150">**SampleDSRemoveObject**</span></span>           | <span data-ttu-id="fda46-151">從目錄服務移除物件。</span><span class="sxs-lookup"><span data-stu-id="fda46-151">Remove an object from the directory service.</span></span>                                                                                                                                                   |
| <span data-ttu-id="fda46-152">**SampleDSCreateBuffer**</span><span class="sxs-lookup"><span data-stu-id="fda46-152">**SampleDSCreateBuffer**</span></span>           | <span data-ttu-id="fda46-153">建立屬性資料和作業資料的記憶體緩衝區。</span><span class="sxs-lookup"><span data-stu-id="fda46-153">Create a memory buffer for attribute data and operation data.</span></span>                                                                                                                                  |
| <span data-ttu-id="fda46-154">**SampleDSFreeBuffer**</span><span class="sxs-lookup"><span data-stu-id="fda46-154">**SampleDSFreeBuffer**</span></span>             | <span data-ttu-id="fda46-155">釋放在 **SampleDSCreateBuffer** 中建立的緩衝區。</span><span class="sxs-lookup"><span data-stu-id="fda46-155">Free the buffer created in **SampleDSCreateBuffer**.</span></span>                                                                                                                                           |



 

 

 




