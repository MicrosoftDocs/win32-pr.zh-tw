---
title: 使用 LDAP 提供者來設定和變更使用者密碼
description: 若要設定使用者密碼，請使用 IADsUser. SetPassword 方法。
ms.assetid: da3d9861-dd04-406c-9356-db1e4ff0eebc
ms.tgt_platform: multiple
keywords:
- LDAP 提供者 ADSI、使用者物件、設定密碼
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 5488146de271ac1108a904cd85163fad9d7dd205
ms.sourcegitcommit: b0ebdefc3dcd5c04bede94091833aa1015a2f95c
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/21/2020
ms.locfileid: "104316444"
---
# <a name="setting-and-changing-user-passwords-with-the-ldap-provider"></a><span data-ttu-id="59b29-104">使用 LDAP 提供者來設定和變更使用者密碼</span><span class="sxs-lookup"><span data-stu-id="59b29-104">Setting and Changing User Passwords with the LDAP Provider</span></span>

<span data-ttu-id="59b29-105">若要設定使用者密碼，請使用 [**IADsUser. SetPassword**](/windows/desktop/api/Iads/nf-iads-iadsuser-setpassword) 方法。</span><span class="sxs-lookup"><span data-stu-id="59b29-105">To a set a user password, use the [**IADsUser.SetPassword**](/windows/desktop/api/Iads/nf-iads-iadsuser-setpassword) method.</span></span>

<span data-ttu-id="59b29-106">Active Directory 的 LDAP 提供者會使用三個處理常式的其中一個來設定密碼 (協力廠商 LDAP 目錄，例如 iPlanet 不使用此密碼驗證程式) 。</span><span class="sxs-lookup"><span data-stu-id="59b29-106">The LDAP provider for Active Directory uses one of three processes to set the password (third-party LDAP directories such as iPlanet do not use this password authentication process).</span></span> <span data-ttu-id="59b29-107">此方法可能會根據網路設定而有所不同。</span><span class="sxs-lookup"><span data-stu-id="59b29-107">The method may vary according to the network configuration.</span></span> <span data-ttu-id="59b29-108">設定密碼方法會依下列順序發生：</span><span class="sxs-lookup"><span data-stu-id="59b29-108">The set password methods occur in the following order:</span></span>

-   <span data-ttu-id="59b29-109">首先，LDAP 提供者會嘗試在128位 SSL 連線上使用 LDAP。</span><span class="sxs-lookup"><span data-stu-id="59b29-109">First, the LDAP provider attempts to use LDAP over a 128-bit SSL connection.</span></span> <span data-ttu-id="59b29-110">Ldap 伺服器必須已安裝適當的伺服器驗證憑證，而且執行 ADSI 程式碼的用戶端必須信任發行這些憑證的授權單位，ldap SSL 才能順利運作。</span><span class="sxs-lookup"><span data-stu-id="59b29-110">For LDAP SSL to operate successfully, the LDAP server must have the appropriate server authentication certificate installed and the clients running the ADSI code must trust the authority that issued those certificates.</span></span> <span data-ttu-id="59b29-111">伺服器和用戶端都必須支援128位加密。</span><span class="sxs-lookup"><span data-stu-id="59b29-111">Both the server and the client must support 128-bit encryption.</span></span>
-   <span data-ttu-id="59b29-112">其次，如果 SSL 連線失敗，LDAP 提供者會嘗試使用 Kerberos。</span><span class="sxs-lookup"><span data-stu-id="59b29-112">Second, if the SSL connection is unsuccessful, the LDAP provider attempts to use Kerberos.</span></span> <span data-ttu-id="59b29-113">在 Windows 2000 上，Kerberos 可能不支援跨樹系驗證。</span><span class="sxs-lookup"><span data-stu-id="59b29-113">On Windows 2000, Kerberos may not support cross-forest authentication.</span></span> <span data-ttu-id="59b29-114">Kerberos 的後續增強功能支援跨樹系驗證。</span><span class="sxs-lookup"><span data-stu-id="59b29-114">Later enhancements to Kerberos support cross-forest authentication.</span></span>
-   <span data-ttu-id="59b29-115">第三，如果 Kerberos 失敗，LDAP 提供者會嘗試 [**NetUserSetInfo**](/windows/desktop/api/lmaccess/nf-lmaccess-netusersetinfo) API 呼叫。</span><span class="sxs-lookup"><span data-stu-id="59b29-115">Third, if Kerberos is unsuccessful, the LDAP provider attempts a [**NetUserSetInfo**](/windows/desktop/api/lmaccess/nf-lmaccess-netusersetinfo) API call.</span></span> <span data-ttu-id="59b29-116">在舊版中，ADSI 會在執行執行緒的安全性內容中呼叫 **NetUserSetInfo** ，而不是在 [**IADsOpenDSObject. objdso.opendsobject**](/windows/desktop/api/Iads/nf-iads-iadsopendsobject-opendsobject) 或 [**ADsOpenObject**](/windows/desktop/api/Adshlp/nf-adshlp-adsopenobject)的呼叫中指定的安全性內容。</span><span class="sxs-lookup"><span data-stu-id="59b29-116">In previous releases, ADSI called **NetUserSetInfo** in the security context in which the thread was running, and not the security context specified in the call to [**IADsOpenDSObject.OpenDSObject**](/windows/desktop/api/Iads/nf-iads-iadsopendsobject-opendsobject) or [**ADsOpenObject**](/windows/desktop/api/Adshlp/nf-adshlp-adsopenobject).</span></span> <span data-ttu-id="59b29-117">在之後的版本中，這已變更，讓 ADSI LDAP 提供者在呼叫 **NetUserSetInfo** 時模擬 **objdso.opendsobject** 呼叫中指定的使用者。</span><span class="sxs-lookup"><span data-stu-id="59b29-117">In later releases, this was changed so that the ADSI LDAP provider would impersonate the user specified in the **OpenDSObject** call when it calls **NetUserSetInfo**.</span></span>

<span data-ttu-id="59b29-118">若要變更使用者密碼，請使用 [**IADsUser**](/windows/desktop/api/Iads/nf-iads-iadsuser-changepassword) 方法。</span><span class="sxs-lookup"><span data-stu-id="59b29-118">To change a user password, use the [**IADsUser.ChangePassword**](/windows/desktop/api/Iads/nf-iads-iadsuser-changepassword) method.</span></span> <span data-ttu-id="59b29-119">如同 [**SetPassword**](/windows/desktop/api/Iads/nf-iads-iadsuser-setpassword)，此方法可以使用多個進程來變更密碼。</span><span class="sxs-lookup"><span data-stu-id="59b29-119">Like [**SetPassword**](/windows/desktop/api/Iads/nf-iads-iadsuser-setpassword), this method can use multiple processes to change the password.</span></span> <span data-ttu-id="59b29-120">變更密碼方法會以下列順序發生：</span><span class="sxs-lookup"><span data-stu-id="59b29-120">The change password methods occur in the following order:</span></span>

-   <span data-ttu-id="59b29-121">首先，LDAP 提供者會嘗試在128位 SSL 連線上使用 LDAP。</span><span class="sxs-lookup"><span data-stu-id="59b29-121">First, the LDAP provider tries to use LDAP over a 128-bit SSL connection.</span></span>
-   <span data-ttu-id="59b29-122">其次，如果 128-SSL 連線失敗，LDAP 提供者會嘗試 [**NetUserChangePassword**](/windows/desktop/api/lmaccess/nf-lmaccess-netuserchangepassword) API 呼叫。</span><span class="sxs-lookup"><span data-stu-id="59b29-122">Second, if the 128-SSL connection is unsuccessful, the LDAP provider tries a [**NetUserChangePassword**](/windows/desktop/api/lmaccess/nf-lmaccess-netuserchangepassword) API call.</span></span> <span data-ttu-id="59b29-123">如同 [**SetPassword**](/windows/desktop/api/Iads/nf-iads-iadsuser-setpassword)，在舊版中，ADSI LDAP 提供者會模擬使用 [**IADsOpenDSObject. Objdso.opendsobject**](/windows/desktop/api/Iads/nf-iads-iadsopendsobject-opendsobject) 方法或 [**ADsOpenObject**](/windows/desktop/api/Adshlp/nf-adshlp-adsopenobject) 函數傳遞的使用者認證。</span><span class="sxs-lookup"><span data-stu-id="59b29-123">Like [**SetPassword**](/windows/desktop/api/Iads/nf-iads-iadsuser-setpassword), in earlier releases, the ADSI LDAP provider impersonates the user credentials passed using the [**IADsOpenDSObject.OpenDSObject**](/windows/desktop/api/Iads/nf-iads-iadsopendsobject-opendsobject) method or the [**ADsOpenObject**](/windows/desktop/api/Adshlp/nf-adshlp-adsopenobject) function.</span></span>

 

 