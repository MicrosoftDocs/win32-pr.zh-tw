---
title: 查詢的範圍
description: 查詢的範圍取決於您系結至的物件。
ms.assetid: 7ece8599-8a4b-45a1-95f4-a4180052f245
ms.tgt_platform: multiple
keywords:
- ADSI 的查詢範圍
- 查詢 ADSI、範圍
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: dac51fc261cb418db0018acd996c248766896a25
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 09/16/2019
ms.locfileid: "103671124"
---
# <a name="scope-of-query"></a>查詢的範圍

查詢的範圍取決於您系結至的物件。 如果您不確定物件在企業內的位置，您需要盡可能以最寬的方式進行搜尋。 但是，如果您知道物件將包含在特定網域內（例如，使用者所連接的網域，或特定群組（例如「經理」群組），則您應該設定搜尋範圍以反映此情況。 為了達到最佳效能，您應該嘗試將範圍設為目標，以搜尋可能的最小物件數目。

當您不確定物件位於企業中的位置時，您可以系結至通用類別目錄服務。 通用類別目錄服務包含目錄中每個物件的清單，以及每個物件屬性的一小部分。 在通用類別目錄中找到物件之後，您可以從通用類別目錄中取出它的辨別名稱，並使用它來系結至物件，以執行其他作業。

決定要系結的物件之後，您可以進一步將查詢限制為下列其中一個範圍：基底查詢、單一層級查詢或子樹搜尋，如下圖所示。

![在基底、一層或子樹搜尋的根目錄中的物件](images/netds6.png)

## <a name="base"></a>基本

基底查詢會將搜尋限制為僅限基底物件。 傳回的物件數目上限一律為一個。 您可以使用此搜尋來確認物件是否存在。 例如，如果您有物件的辨別名稱，而且必須根據路徑確認物件是否存在，您可以使用一層級的搜尋。 如果搜尋失敗，您可以假設物件可能已重新命名或移至不同的位置，或您已獲得物件的不正確資料。 請注意，如果您想要重新流覽物件，您應該儲存 GUID，而不是分辨名稱。 這允許在目錄階層中重新命名或移動物件，而不會中斷保存的連結。

## <a name="one-level"></a>一層

單一層級的搜尋僅限於基底物件的直屬子系，但會排除基底物件本身。 這項設定可以針對父物件的直屬子物件，執行目標搜尋。 例如，如果您有一個名為 P1 的父物件，且其直屬子系為： C1、C2、C3，則在單一層級搜尋中，評估準則時應包含 C1、C2 和 C3，但 P1 不是搜尋的一部分。 您可以使用一層級的搜尋來列舉物件的所有子系。 事實上，在某些 ADSI 提供者中， [**IADsContainer**](/windows/desktop/api/Iads/nn-iads-iadscontainer) 列舉會轉譯為一層級的搜尋。

## <a name="subtree"></a>樹狀子目錄

子樹搜尋（也稱為深層搜尋）包含基底物件下的所有物件，但基底物件本身除外。 此搜尋可能會產生其他伺服器的參考。 此搜尋具有最大的範圍，而且可能會傳回大型結果集。 可能的話，請搜尋至少一個索引屬性，並設定 (的 [參考] 設定。如需詳細資訊，請參閱 [效能和處理大型結果集](performance-and-handling-large-result-sets.md)) 符合您的搜尋需求。 此外，也建議您以非同步方式執行子樹搜尋的結果，並將其分頁，以降低伺服器額外負荷和網路效能。 子樹搜尋通常用來搜尋指定範圍的物件。 例如，搜尋帳戶將于30天內到期的所有使用者。

 

 




