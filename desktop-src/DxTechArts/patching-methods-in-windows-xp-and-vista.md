---
title: 在 Windows XP、Windows Vista 和 Windows 7 中修補遊戲軟體
description: 本文將探討一些可在 Windows Vista 和 Windows 7 以及 Windows XP 中正常運作的修補方法。
ms.assetid: 27be805a-bffd-a9f8-2207-2a9a4822ba48
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 95ae0b1455cae61b8372f81e6928977743084c9e
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/20/2020
ms.locfileid: "106984939"
---
# <a name="patching-game-software-in-windows-xp-windows-vista-and-windows-7"></a><span data-ttu-id="95114-103">在 Windows XP、Windows Vista 和 Windows 7 中修補遊戲軟體</span><span class="sxs-lookup"><span data-stu-id="95114-103">Patching Game Software in Windows XP, Windows Vista, and Windows 7</span></span>

<span data-ttu-id="95114-104">Windows Vista 和 Windows 7 有許多功能可讓作業系統更安全。</span><span class="sxs-lookup"><span data-stu-id="95114-104">Windows Vista and Windows 7 have a number of features to make the operating system more secure.</span></span> <span data-ttu-id="95114-105">新增安全性表示將修補程式套用到軟體並不像過去一樣簡單。</span><span class="sxs-lookup"><span data-stu-id="95114-105">Added security means that applying patches to software is not as simple as it was in the past.</span></span> <span data-ttu-id="95114-106">本文將探討一些可在 Windows Vista 和 Windows 7 以及 Windows XP 中正常運作的修補方法。</span><span class="sxs-lookup"><span data-stu-id="95114-106">This article examines some methods of patching that will work well in Windows Vista and Windows 7, as well as Windows XP.</span></span>

<span data-ttu-id="95114-107">有兩個主要的遊戲類別需要修補程式：</span><span class="sxs-lookup"><span data-stu-id="95114-107">There are two main categories of games that require patches:</span></span>

-   <span data-ttu-id="95114-108">只需要偶爾修補程式的遊戲，例如大部分的離線遊戲。</span><span class="sxs-lookup"><span data-stu-id="95114-108">Games that require only occasional patches, such as most offline games.</span></span>
-   <span data-ttu-id="95114-109">需要經常修補的遊戲，例如大部分的線上遊戲。</span><span class="sxs-lookup"><span data-stu-id="95114-109">Games that require frequent patches, such as most online games.</span></span>

<span data-ttu-id="95114-110">本文也提供「使用者帳戶控制」 (UAC) 的簡介，以作為開發人員可預期使用者在 Windows Vista 和 Windows 7 中擁有之許可權的背景。</span><span class="sxs-lookup"><span data-stu-id="95114-110">This article also offers a brief introduction to the User Account Control (UAC) to serve as background about the rights that developers can expect users to have in Windows Vista and Windows 7.</span></span>

-   [<span data-ttu-id="95114-111">使用者帳戶控制</span><span class="sxs-lookup"><span data-stu-id="95114-111">User Account Control</span></span>](#user-account-control)
-   [<span data-ttu-id="95114-112">只需要偶爾修補程式的遊戲</span><span class="sxs-lookup"><span data-stu-id="95114-112">Games that Require Only Occasional Patches</span></span>](#games-that-require-only-occasional-patches)
    -   [<span data-ttu-id="95114-113">方法1：針對偶爾的修補程式使用 Windows Installer</span><span class="sxs-lookup"><span data-stu-id="95114-113">Method 1: Use Windows Installer for Occasional Patches</span></span>](#method-1-use-windows-installer-for-occasional-patches)
    -   [<span data-ttu-id="95114-114">方法2：需要系統管理員許可權才能套用修補程式</span><span class="sxs-lookup"><span data-stu-id="95114-114">Method 2: Require Administrator Rights to Apply Patches</span></span>](#method-2-require-administrator-rights-to-apply-patches)
-   [<span data-ttu-id="95114-115">需要經常修補的遊戲</span><span class="sxs-lookup"><span data-stu-id="95114-115">Games that Require Frequent Patches</span></span>](#games-that-require-frequent-patches)
    -   [<span data-ttu-id="95114-116">方法3：安裝每位使用者</span><span class="sxs-lookup"><span data-stu-id="95114-116">Method 3: Install Per-User</span></span>](#method-3-install-per-user)
    -   [<span data-ttu-id="95114-117">方法4：安裝到常見的 Per-Computer 位置</span><span class="sxs-lookup"><span data-stu-id="95114-117">Method 4: Install to a Common Per-Computer Location</span></span>](#method-4-install-to-a-common-per-computer-location)
    -   [<span data-ttu-id="95114-118">其他可能性</span><span class="sxs-lookup"><span data-stu-id="95114-118">Other Possibilities</span></span>](#other-possibilities)
-   [<span data-ttu-id="95114-119">總結</span><span class="sxs-lookup"><span data-stu-id="95114-119">Summary</span></span>](#summary)

## <a name="user-account-control"></a><span data-ttu-id="95114-120">使用者帳戶控制</span><span class="sxs-lookup"><span data-stu-id="95114-120">User Account Control</span></span>

<span data-ttu-id="95114-121">Windows Vista 和 Windows 7 有兩種主要類型的使用者帳戶：標準使用者和系統管理員。</span><span class="sxs-lookup"><span data-stu-id="95114-121">Windows Vista and Windows 7 have two primary types of user accounts: Standard User and Administrator.</span></span> <span data-ttu-id="95114-122">標準使用者帳戶有數個存取限制;例如，它無法將資料寫入% SystemDrive% 程式檔中的檔案系統 \\ 或 HKEY 本機電腦中的登錄 \_ \_ 。</span><span class="sxs-lookup"><span data-stu-id="95114-122">A Standard User account has several access restrictions; for example, it cannot write data to the file system in %SystemDrive%\\Program Files or to the registry in the HKEY\_LOCAL\_MACHINE.</span></span> <span data-ttu-id="95114-123">如果將修補程式安裝在唯讀的位置，這會對套用修補程式造成影響。</span><span class="sxs-lookup"><span data-stu-id="95114-123">This has implications for applying patches to a game if it is installed in a read-only location.</span></span> <span data-ttu-id="95114-124">不同于 Windows XP，Windows Vista 和 Windows 7 中的標準使用者帳戶更為普遍。</span><span class="sxs-lookup"><span data-stu-id="95114-124">Unlike in Windows XP, the Standard User account is much more common in Windows Vista and Windows 7.</span></span> <span data-ttu-id="95114-125">作業系統的重要功能（例如家長監護）也需要標準使用者帳戶。</span><span class="sxs-lookup"><span data-stu-id="95114-125">Standard User accounts are also required for important features of the operating system, like parental controls.</span></span> <span data-ttu-id="95114-126">家長監護要求子帳戶必須是標準使用者，而將這類帳戶提升為系統管理員甚至是一項遊戲，以防止家長監護與其他所有遊戲合作。</span><span class="sxs-lookup"><span data-stu-id="95114-126">Parental controls require that the child account be Standard User, and elevating such an account to Administrator for even one game prevents parental controls from working with all other games.</span></span> <span data-ttu-id="95114-127">因此，針對標準使用者設計遊戲相當重要。</span><span class="sxs-lookup"><span data-stu-id="95114-127">So, it important for games to be designed for Standard User.</span></span>

<span data-ttu-id="95114-128">Windows Vista 和 Windows 7 有較新的使用者權限模型，可協助防止使用者執行嘗試執行使用者不打算或授權之作業的程式。</span><span class="sxs-lookup"><span data-stu-id="95114-128">Windows Vista and Windows 7 have a newer model for user rights, to help prevent users from running programs that attempt to perform operations that the user doesn't intend or authorize.</span></span> <span data-ttu-id="95114-129">為了達成此目的，使用者帳戶控制 (先前稱為最低許可權的使用者帳戶或 LUA) 可讓使用者在大部分的情況下，使用低層級的許可權來操作電腦，同時也能夠在必要時輕鬆地執行需要更高許可權的應用程式。</span><span class="sxs-lookup"><span data-stu-id="95114-129">To that end, User Account Control (formerly called Least-privileged User Account or LUA) enables users to operate the computer with low-level rights most of the time, while being able to easily run applications that require higher-level rights, when necessary.</span></span> <span data-ttu-id="95114-130">這表示標準使用者帳戶和系統管理員帳戶都是使用標準使用者權限來執行應用程式，但只有系統管理員帳戶能夠將更高的許可權授與應用程式。</span><span class="sxs-lookup"><span data-stu-id="95114-130">This means that Standard User accounts and Administrator accounts both run applications with Standard User rights, but only Administrator accounts have the ability to grant elevated rights to applications.</span></span> <span data-ttu-id="95114-131">作業系統會在以較高的許可權執行應用程式之前，要求具有系統管理員帳戶的使用者進行明確同意，如果需要系統管理員許可權的程式是在標準使用者帳戶上執行，系統會提示系統管理員核准。</span><span class="sxs-lookup"><span data-stu-id="95114-131">The operating system asks users with Administrator accounts for explicit consent before running an application with elevated rights, and if a program that requires Administrator rights is run on a Standard User account, the system prompts for Administrator approval.</span></span>

## <a name="games-that-require-only-occasional-patches"></a><span data-ttu-id="95114-132">只需要偶爾修補程式的遊戲</span><span class="sxs-lookup"><span data-stu-id="95114-132">Games that Require Only Occasional Patches</span></span>

<span data-ttu-id="95114-133">有些遊戲在整個生命週期中只需要一些修補程式。</span><span class="sxs-lookup"><span data-stu-id="95114-133">Some games only require a few patches throughout their lifecycle.</span></span> <span data-ttu-id="95114-134">您可以針對此修補頻率採用的兩種方法，就是將修補程式散發為 Windows Installer 套件，這通常不需要系統管理員許可權，也不需要使用其他直接修改遊戲檔案的散發類型。</span><span class="sxs-lookup"><span data-stu-id="95114-134">Two methods that you can employ for this frequency of patching are to distribute patches as Windows Installer packages, which does not generally require Administrator rights, or to use some other type of distribution that directly modifies game files.</span></span>

> [!Note]  
> <span data-ttu-id="95114-135">無論遊戲是否需要經常修補，應用程式通常都需要安裝或移除系統管理員許可權。</span><span class="sxs-lookup"><span data-stu-id="95114-135">Regardless of whether a game requires frequent patching, applications typically require Administrator rights to be installed or removed.</span></span>

 

### <a name="method-1-use-windows-installer-for-occasional-patches"></a><span data-ttu-id="95114-136">方法1：針對偶爾的修補程式使用 Windows Installer</span><span class="sxs-lookup"><span data-stu-id="95114-136">Method 1: Use Windows Installer for Occasional Patches</span></span>

<span data-ttu-id="95114-137">在這個方法中，Windows Installer 是用來將封裝安裝 ( .msi 檔案) 和 Windows Installer 修補程式 ( .msp 檔) 發佈以安裝修補程式。</span><span class="sxs-lookup"><span data-stu-id="95114-137">In this method, a Windows Installer is used to install a package (.msi file) and a Windows Installer patch (.msp file) is distributed to install patches.</span></span> <span data-ttu-id="95114-138">封裝必須有 MsiPatchCertificate 資料表，而修補程式必須由資料表中的憑證以數位方式簽署。</span><span class="sxs-lookup"><span data-stu-id="95114-138">The package must have an MsiPatchCertificate table, and the patch must be digitally signed by a certificate in the table.</span></span> <span data-ttu-id="95114-139">如需有關數位簽章的詳細資訊，請參閱 [遊戲開發人員的 Authenticode 簽署](/windows/desktop/DxTechArts/authenticode-signing-for-game-developers)。</span><span class="sxs-lookup"><span data-stu-id="95114-139">More information about digital signing can be found at [Authenticode Signing for Game Developers](/windows/desktop/DxTechArts/authenticode-signing-for-game-developers).</span></span>

<span data-ttu-id="95114-140">如需使用此修補方法的詳細資訊和需求，請參閱 Windows Installer 檔：</span><span class="sxs-lookup"><span data-stu-id="95114-140">More details and requirements to use this patching method can be found in the Windows Installer documentation:</span></span>

-   [<span data-ttu-id="95114-141">修補和升級</span><span class="sxs-lookup"><span data-stu-id="95114-141">Patching and Upgrades</span></span>](/windows/desktop/Msi/patching-and-upgrades)
-   [<span data-ttu-id="95114-142"> (UAC) 修補的使用者帳戶控制</span><span class="sxs-lookup"><span data-stu-id="95114-142">User Account Control (UAC) Patching</span></span>](/windows/desktop/Msi/user-account-control--uac--patching)

<span data-ttu-id="95114-143">這種方法的缺點是，如果遊戲不是從 Windows XP 上的卸載式媒體安裝，則修補需要系統管理員許可權。</span><span class="sxs-lookup"><span data-stu-id="95114-143">The disadvantage to this method is that if the game was not installed from removable media on Windows XP, then patching requires Administrator rights.</span></span> <span data-ttu-id="95114-144">不過，這不太可能太過嚴格，因為 Windows XP 上的大部分使用者系統管理員，以及從卸載式媒體安裝的軟體限制不會出現在 Windows Vista 中。</span><span class="sxs-lookup"><span data-stu-id="95114-144">However, this not likely to be too restrictive, because most users administrators on Windows XP, and the restriction to software installed from removable media is not present on Windows Vista.</span></span>

<span data-ttu-id="95114-145">這種方法的主要優點是可以由標準使用者帳戶套用修補程式，而不需要提示和驗證更高的許可權。</span><span class="sxs-lookup"><span data-stu-id="95114-145">The main advantage of this method is that patches can be applied by a Standard User account without requiring a prompt and authentication for elevated rights.</span></span> <span data-ttu-id="95114-146">這可提供更好的使用者體驗，因為若要玩遊戲，具有標準使用者帳戶的使用者不需要要求具有系統管理員帳戶的使用者安裝修補程式，或提供具有永久系統管理員許可權的標準使用者帳戶。</span><span class="sxs-lookup"><span data-stu-id="95114-146">This provides a better user experience, because to play a game, a user with a Standard User account doesn't need to ask someone with an Administrator account to install the patch or to provide the Standard User account with permanent Administrator rights.</span></span>

<span data-ttu-id="95114-147">這種方法可能適用于需要頻繁修補程式的遊戲，但使用 Windows Installer 套件的額外負荷（例如組建整合和支援大量檔案）可能會讓這個方法比其他方法更不理想。</span><span class="sxs-lookup"><span data-stu-id="95114-147">It is possible that this method might work for games that require frequent patches, but the overhead of using Windows Installer packages, in terms of build integration and supporting large numbers of files, might make this method less desirable than others.</span></span>

### <a name="method-2-require-administrator-rights-to-apply-patches"></a><span data-ttu-id="95114-148">方法2：需要系統管理員許可權才能套用修補程式</span><span class="sxs-lookup"><span data-stu-id="95114-148">Method 2: Require Administrator Rights to Apply Patches</span></span>

<span data-ttu-id="95114-149">在這個方法中，套用修補程式的可執行檔需要系統管理員許可權才能執行。</span><span class="sxs-lookup"><span data-stu-id="95114-149">In this method, the executable file that applies the patch requires Administrator rights to run.</span></span> <span data-ttu-id="95114-150">使用系統管理員許可權，修補可執行檔可以直接修改位於% SystemDrive% Program Files 的遊戲檔案 \\ 。</span><span class="sxs-lookup"><span data-stu-id="95114-150">With Administrator rights, the patching executable can directly modify the game files located in %SystemDrive%\\Program Files.</span></span>

<span data-ttu-id="95114-151">這種方法的優點是它的簡化方式。</span><span class="sxs-lookup"><span data-stu-id="95114-151">The advantage of this method is its simplicity.</span></span> <span data-ttu-id="95114-152">但是，如果遊戲需要經常修補程式，這個方法並不適合，因為如果使用者的標準使用者帳戶想要播放需要經常修補的遊戲，例如大量的多玩家線上遊戲，那麼該使用者就有兩個選擇：</span><span class="sxs-lookup"><span data-stu-id="95114-152">However, this method is unsuitable if the game needs frequent patches, because if a user with a Standard User account wants to play a game that requires frequent patches, like a massively multi-player online game, then that user has two choices:</span></span>

-   <span data-ttu-id="95114-153">讓系統管理員登入並修補遊戲，這對雙方來說可能不方便。</span><span class="sxs-lookup"><span data-stu-id="95114-153">Get an Administrator to log on and patch the game, which might be inconvenient for both parties.</span></span>
-   <span data-ttu-id="95114-154">以系統管理員許可權永久提高其帳戶的許可權。</span><span class="sxs-lookup"><span data-stu-id="95114-154">Have his or her account permanently elevated with Administrator rights.</span></span>

> [!Note]  
> <span data-ttu-id="95114-155">後者的解決方案不僅會削弱整體系統的安全性，還能防止重要功能（例如家長監護）運作。</span><span class="sxs-lookup"><span data-stu-id="95114-155">The latter solution not only weakens the security of the system as a whole, but it prevents important features, like parental controls, from working.</span></span>

 

<span data-ttu-id="95114-156">在執行此方法時，套用修補程式的可執行檔必須與遊戲可執行檔不同。</span><span class="sxs-lookup"><span data-stu-id="95114-156">When implementing this method, the executable file that applies the patch must be different from the game executable.</span></span> <span data-ttu-id="95114-157">修補可執行檔的資訊清單應指定 requireAdministrator for 並無 requestedexecutionlevel，以將它表示為需要系統管理員許可權的應用程式。</span><span class="sxs-lookup"><span data-stu-id="95114-157">The manifest of the patching executable should specify requireAdministrator for requestedExecutionLevel to denote it as an application that requires Administrator rights.</span></span> <span data-ttu-id="95114-158">如需如何進行這項作業的詳細資訊，請參閱「應用程式資訊清單架構」中 [最低許可權環境中應用程式的開發人員最佳做法和指導方針](/previous-versions/dotnet/articles/aa480150(v=msdn.10))。</span><span class="sxs-lookup"><span data-stu-id="95114-158">More information about how to do this can be found at [Developer Best Practices and Guidelines for Applications in a Least Privileged Environment](/previous-versions/dotnet/articles/aa480150(v=msdn.10)), in "Application Manifest Schema."</span></span>

<span data-ttu-id="95114-159">使用這個方法時，即使是資訊清單中的設定，在兩種情況下，可執行檔可能仍不會以系統管理員許可權啟動：</span><span class="sxs-lookup"><span data-stu-id="95114-159">When this method is used, even with the settings in the manifest, the executable file might still be launched without Administrator rights in two cases:</span></span>

-   <span data-ttu-id="95114-160">如果作業系統是 Windows XP，而且使用者的帳戶是受限制的使用者。</span><span class="sxs-lookup"><span data-stu-id="95114-160">If the operating system is Windows XP, and the user's account is a Restricted User.</span></span>
-   <span data-ttu-id="95114-161">如果作業系統是 Windows Vista 或 Windows 7，則使用者的帳戶是標準使用者，且 UAC 已停用。</span><span class="sxs-lookup"><span data-stu-id="95114-161">If the operating system is Windows Vista or Windows 7, the user's account is a Standard User, and UAC is disabled.</span></span>

<span data-ttu-id="95114-162">這兩個都是罕見的取用者案例。</span><span class="sxs-lookup"><span data-stu-id="95114-162">Both of these are rare consumer scenarios.</span></span> <span data-ttu-id="95114-163">不過，patcher 應該要有資訊清單需要系統管理員許可權，而且應該呼叫 [**IsUserAnAdmin**](/windows/desktop/api/shlobj_core/nf-shlobj_core-isuseranadmin);如果此函數傳回 FALSE，則會顯示錯誤訊息「需要系統管理員許可權」。</span><span class="sxs-lookup"><span data-stu-id="95114-163">However, the patcher should have the manifest require Administrator rights, and it should call [**IsUserAnAdmin**](/windows/desktop/api/shlobj_core/nf-shlobj_core-isuseranadmin); if this function returns FALSE, the error message "Administrator rights are required" is displayed.</span></span>

<span data-ttu-id="95114-164">整體來說，方法1適用于只需要一些修補程式存留期的遊戲。</span><span class="sxs-lookup"><span data-stu-id="95114-164">Overall, method 1 is preferable for games that need just a few patches over their lifetimes.</span></span>

## <a name="games-that-require-frequent-patches"></a><span data-ttu-id="95114-165">需要經常修補的遊戲</span><span class="sxs-lookup"><span data-stu-id="95114-165">Games that Require Frequent Patches</span></span>

<span data-ttu-id="95114-166">許多以網際網路為基礎的遊戲不斷改進，通常需要定期修補。</span><span class="sxs-lookup"><span data-stu-id="95114-166">Many Internet-based games are being improved continuously, and they usually require regular patches.</span></span> <span data-ttu-id="95114-167">針對這些遊戲，可以依使用者或每部電腦套用修補程式，如下列主題所述。</span><span class="sxs-lookup"><span data-stu-id="95114-167">For these games, patches could be applied per-user or per-computer, as discussed in the follow topics.</span></span> <span data-ttu-id="95114-168">其他可能的解決方案包括改變保護% SystemDrive% 程式檔案 \\ 或建立自訂服務的 ACL。</span><span class="sxs-lookup"><span data-stu-id="95114-168">Other possible solutions include altering the ACL that protects %SystemDrive%\\Program Files or creating a custom service.</span></span>

### <a name="method-3-install-per-user"></a><span data-ttu-id="95114-169">方法3：安裝 Per-User</span><span class="sxs-lookup"><span data-stu-id="95114-169">Method 3: Install Per-User</span></span>

<span data-ttu-id="95114-170">其中一個建議和簡單的方法是將整個遊戲安裝至本機應用程式 data 資料夾的每個使用者子資料夾，您可以藉由呼叫 [**SHGetFolderPath**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetfolderpatha) with CSIDL \_ local APPDATA 找到這個資料夾 \_ 。</span><span class="sxs-lookup"><span data-stu-id="95114-170">One recommended and easy approach is to install the entire game to a per-user subfolder of the local application data folder, which you can find by calling [**SHGetFolderPath**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetfolderpatha) with CSIDL\_LOCAL\_APPDATA.</span></span> <span data-ttu-id="95114-171">範例路徑為 C： \\ Documents And Settings \\ user Name \\ Local Settings \\ Application Data \\ ExampleGame。</span><span class="sxs-lookup"><span data-stu-id="95114-171">An example path is C:\\Documents and Settings\\user name\\Local Settings\\Application Data\\ExampleGame.</span></span> <span data-ttu-id="95114-172">這類位置可讓使用標準使用者權限執行的應用程式直接修改遊戲檔案。</span><span class="sxs-lookup"><span data-stu-id="95114-172">Such a location allows an application running with Standard User rights to directly modify game files.</span></span>

<span data-ttu-id="95114-173">但是，當電腦有多個使用者時，這個方法會有一個缺點：每個使用者都安裝了一份遊戲，而且每個使用者都必須下載並套用修補程式。</span><span class="sxs-lookup"><span data-stu-id="95114-173">However, there is a disadvantage to this approach when a computer has multiple users: each user has a copy of the game installed, and patches must be downloaded and applied by each user.</span></span> <span data-ttu-id="95114-174">這不僅浪費使用者的時間和磁碟空間，還會增加使用網路頻寬給提供修補程式的伺服器。</span><span class="sxs-lookup"><span data-stu-id="95114-174">This wastes not only users' time and disk space, but it also increases use of network bandwidth to the server that provides patches.</span></span> <span data-ttu-id="95114-175">此外，因為任何具有標準使用者權限的應用程式都可以修改遊戲，所以遊戲可執行檔會受到較低的保護;由遊戲製造商決定是否可接受這項功能。</span><span class="sxs-lookup"><span data-stu-id="95114-175">Also, because any application with standard user rights can modify the game, game executables are less protected; it is up to the game manufacturer to decide if this is acceptable or not.</span></span>

### <a name="method-4-install-to-a-common-per-computer-location"></a><span data-ttu-id="95114-176">方法4：安裝到常見的 Per-Computer 位置</span><span class="sxs-lookup"><span data-stu-id="95114-176">Method 4: Install to a Common Per-Computer Location</span></span>

<span data-ttu-id="95114-177">另一種方法是將無法執行的遊戲資料安裝到 [**SHGetFolderPath**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetfolderpatha) CSIDL COMMON APPDATA 所指定路徑的 \_ 子目錄 \_ ; 範例路徑為 C： \\ Documents And Settings \\ All Users \\ Application data \\ ExampleGame。</span><span class="sxs-lookup"><span data-stu-id="95114-177">Another method is to install the non-executable game data to a subdirectory of the path specified by [**SHGetFolderPath**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetfolderpatha) CSIDL\_COMMON\_APPDATA; an example path is C:\\Documents and Settings\\All Users\\Application Data\\ExampleGame.</span></span> <span data-ttu-id="95114-178">這是所有使用者的共用位置，可由以標準使用者權限執行的應用程式進行修改。</span><span class="sxs-lookup"><span data-stu-id="95114-178">This is a shared location for all users, and it can be modified by applications that run with Standard User rights.</span></span> <span data-ttu-id="95114-179">當遊戲從一個以上的帳戶播放時，此方法會將重新套用大型修補程式的需求降到最低。</span><span class="sxs-lookup"><span data-stu-id="95114-179">This method minimizes the need to reapply large patches when the game is played from more than one account.</span></span> <span data-ttu-id="95114-180">遊戲的可執行檔應該保留在% SystemDrive% 的程式檔中， \\ 以將系統上其他帳戶的風險降至最低。</span><span class="sxs-lookup"><span data-stu-id="95114-180">Executable files for the game should be kept in %SystemDrive%\\Programs Files to minimize the risk to other accounts on the system.</span></span> <span data-ttu-id="95114-181">可執行檔應確認共用目錄中新內容的完整性，因為該位置可以由具有標準使用者權限的程式或人員修改;請考慮使用 [**MapFileAndCheckSum**](/windows/desktop/api/imagehlp/nf-imagehlp-mapfileandchecksuma) 來計算檔案的總和檢查碼。</span><span class="sxs-lookup"><span data-stu-id="95114-181">The executable files should verify the integrity of the new content in the shared directory, since that location can be modified by a program or person with Standard User rights; consider using [**MapFileAndCheckSum**](/windows/desktop/api/imagehlp/nf-imagehlp-mapfileandchecksuma) to compute a checksum of the files.</span></span>

<span data-ttu-id="95114-182">這個方法的優點是在 Windows XP 和 Windows Vista 上都能正常運作，而且不需要系統管理員許可權。</span><span class="sxs-lookup"><span data-stu-id="95114-182">This method has the advantage of working equally well on both Windows XP and Windows Vista, and it doesn't require Administrator rights.</span></span>

### <a name="other-possibilities"></a><span data-ttu-id="95114-183">其他可能性</span><span class="sxs-lookup"><span data-stu-id="95114-183">Other Possibilities</span></span>

<span data-ttu-id="95114-184">在已經討論過的方法之外，另一個可能的原因是， \\ 在安裝遊戲時改變% SystemDrive% Program files 遊戲資料夾的 ACL， \\ \\ 讓修補工具可以直接寫入遊戲的檔案，即使以標準使用者權限執行也一樣。</span><span class="sxs-lookup"><span data-stu-id="95114-184">Outside of the methods already discussed, another possibility is to alter the ACL of %SystemDrive%\\Program Files\\Game Folder\\ when installing the game so that a patching tool can write directly to the game's files even when run with Standard User rights.</span></span> <span data-ttu-id="95114-185">雖然這並不困難，但它會略過系統提供給遊戲檔案的安全性保護，並讓惡意程式有機會改變目錄的內容。</span><span class="sxs-lookup"><span data-stu-id="95114-185">While this is not difficult, it does bypass the security protection that the system offers to the game's files and provides an opportunity for malicious programs to alter the contents of the directory.</span></span> <span data-ttu-id="95114-186">這不是建議的作法，強烈建議您改為使用替代方法。</span><span class="sxs-lookup"><span data-stu-id="95114-186">This is not advisable, and it is strongly recommended that an alternative be used instead.</span></span>

<span data-ttu-id="95114-187">最後一個可能的原因是撰寫自訂服務。</span><span class="sxs-lookup"><span data-stu-id="95114-187">One final possibility is to write a custom service.</span></span> <span data-ttu-id="95114-188">一般情況下，撰寫自訂服務來修補遊戲並不是個好主意，因為這樣做會很複雜而且容易出錯。</span><span class="sxs-lookup"><span data-stu-id="95114-188">In general, writing a custom service to patch games is not a good idea, because doing so is complicated and error-prone.</span></span> <span data-ttu-id="95114-189">建議您使用本文中討論的其他方法來進行修補。</span><span class="sxs-lookup"><span data-stu-id="95114-189">It is recommended that patching be done by use of other methods discussed in this article.</span></span> <span data-ttu-id="95114-190">不過，當自訂服務與反或反盜版解決方案結合時，可能是必要的。</span><span class="sxs-lookup"><span data-stu-id="95114-190">However, a custom service might be necessary when combined with anti-cheat or anti-piracy solutions.</span></span> <span data-ttu-id="95114-191">這類服務應該支援大量的遊戲，並將其設計為只能下載修補檔，並只寫入目標遊戲的安裝目錄。</span><span class="sxs-lookup"><span data-stu-id="95114-191">Such a service should support a large number of games and be designed so that it can only download the patch files and write only to the installation directory for the target game.</span></span> <span data-ttu-id="95114-192">很重要的是，這項服務很重要，有一個很小的介面區很容易受到攻擊，而且當遊戲未執行時，盡可能地使用最少的系統資源。</span><span class="sxs-lookup"><span data-stu-id="95114-192">It is important that the service be small, have a minimal surface area that is vulnerable to attack, and use as few system resources as possible when the game is not running.</span></span>

## <a name="summary"></a><span data-ttu-id="95114-193">總結</span><span class="sxs-lookup"><span data-stu-id="95114-193">Summary</span></span>

<span data-ttu-id="95114-194">最後，您必須決定要執行的方法。</span><span class="sxs-lookup"><span data-stu-id="95114-194">Ultimately, it is up to you to decide which method to implement.</span></span> <span data-ttu-id="95114-195">您必須權衡這些因素對您很重要。</span><span class="sxs-lookup"><span data-stu-id="95114-195">You need to weigh the factors are that are important to you.</span></span> <span data-ttu-id="95114-196">安全性、修補頻率、客戶容易使用、執行所需的工作負載、解決方案的複雜度，以及平臺功能合規性，是每位開發人員在決定特定方法之前必須考慮的因素。</span><span class="sxs-lookup"><span data-stu-id="95114-196">Security, frequency of patching, ease of use by customer, workload required to implement, complexity of solution, and platform feature compliance are the factors that each developer must consider before deciding on a particular method.</span></span>

<span data-ttu-id="95114-197">您可以在 [Windows Vista 應用程式開發需求中找到使用者帳戶保護的詳細資訊， (UAC) 的使用者帳戶控制 ](/previous-versions/aa905330(v=msdn.10))。</span><span class="sxs-lookup"><span data-stu-id="95114-197">You can find more information about user account protection in [Windows Vista Application Development Requirements for User Account Control (UAC)](/previous-versions/aa905330(v=msdn.10)).</span></span>

 

 