---
title: 適用于遊戲的隨選安裝
description: 本技術文章討論使用 Windows Installer 的兩個技術：隨選安裝和背景安裝。
ms.assetid: abaaa7bf-8ed8-0425-6845-3671a56fe7fc
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 064dc58c563c372d1320a21040920e492e4e65e4
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/20/2020
ms.locfileid: "106969914"
---
# <a name="install-on-demand-for-games"></a><span data-ttu-id="1ed3f-103">適用于遊戲的隨選安裝</span><span class="sxs-lookup"><span data-stu-id="1ed3f-103">Install-on-Demand for Games</span></span>

<span data-ttu-id="1ed3f-104">本技術文章討論使用 [Windows Installer](/windows/desktop/Msi/windows-installer-portal)的兩個技術：隨選安裝和背景安裝。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-104">This technical article discusses two techniques, install-on-demand and background install, using [Windows Installer](/windows/desktop/Msi/windows-installer-portal).</span></span> <span data-ttu-id="1ed3f-105">遊戲可以利用這些安裝技術，藉由減少安裝時間來為玩家提供更好且更愉快的遊戲體驗。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-105">Games can utilize these installation techniques to provide a better and more pleasant gaming experience for players by reducing the installation time.</span></span>

-   [<span data-ttu-id="1ed3f-106">概觀</span><span class="sxs-lookup"><span data-stu-id="1ed3f-106">Overview</span></span>](#overview)
-   [<span data-ttu-id="1ed3f-107">修補支援</span><span class="sxs-lookup"><span data-stu-id="1ed3f-107">Patching Support</span></span>](#patching-support)
-   [<span data-ttu-id="1ed3f-108">InstallOnDemand SDK 範例</span><span class="sxs-lookup"><span data-stu-id="1ed3f-108">The InstallOnDemand SDK Sample</span></span>](#the-installondemand-sdk-sample)
-   [<span data-ttu-id="1ed3f-109">範例的功能和元件</span><span class="sxs-lookup"><span data-stu-id="1ed3f-109">The Sample's Features and Components</span></span>](#the-samples-features-and-components)
-   [<span data-ttu-id="1ed3f-110">安裝</span><span class="sxs-lookup"><span data-stu-id="1ed3f-110">Installation</span></span>](#installation)
-   [<span data-ttu-id="1ed3f-111">限制</span><span class="sxs-lookup"><span data-stu-id="1ed3f-111">Limitation</span></span>](#limitation)

## <a name="overview"></a><span data-ttu-id="1ed3f-112">概觀</span><span class="sxs-lookup"><span data-stu-id="1ed3f-112">Overview</span></span>

<span data-ttu-id="1ed3f-113">安裝是一段長時間的電腦應用程式的元素。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-113">Installation has been an element of computer-based applications for a long time.</span></span> <span data-ttu-id="1ed3f-114">現今大部分的應用程式都需要先將這些應用程式安裝在使用者的本機硬碟上，然後才能使用。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-114">Most applications today require that they be installed on the user's local hard drive first before they can be used.</span></span> <span data-ttu-id="1ed3f-115">電腦遊戲沒有例外;當取用者購買 Microsoft Windows 遊戲並嘗試執行它時，他必須先完成安裝程式，將必要的檔案從遊戲光碟複製到硬碟。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-115">Computer games are no exception; when a consumer buys a Microsoft Windows game and tries to run it, he must first go through an installation process that copies necessary files from the game disc to the hard drive.</span></span> <span data-ttu-id="1ed3f-116">此安裝程式通常很冗長，而且可能需要最多一小時的時間才能完成。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-116">This installation process is usually lengthy and can take as much as an hour to complete.</span></span> <span data-ttu-id="1ed3f-117">安裝時間是讓主控台遊戲更適合某些玩家的電腦遊戲的因素，因為它們可以在插入遊戲光碟之後立即播放主控台遊戲。本文討論的技術會大幅減少安裝時間，以嘗試解決此情況。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-117">The installation time is a factor that makes console games more desirable than computer-based games for some players, as they are able to immediately play a console game after inserting the game disc. The technology discussed in this article will attempt to remedy this by drastically reducing the installation time.</span></span>

<span data-ttu-id="1ed3f-118">傳統上，遊戲需要在啟動之前安裝所有或大部分的檔案。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-118">Traditionally, games require that all or most of the files be installed prior to launching.</span></span> <span data-ttu-id="1ed3f-119">為了達成隨選安裝，遊戲資源必須是模組化;也就是說，開發人員必須將應用程式的資源分割 (圖形、音訊等等) 至元件。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-119">In order to achieve install-on-demand, the game resources need to be modular; that is, the developer must divide the application's resources (graphics, audio, and so on) into components.</span></span> <span data-ttu-id="1ed3f-120">每個元件都是一組資源，可以安裝或移除為一個單位。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-120">Each component is a set of resources that can be installed or removed as a unit.</span></span> <span data-ttu-id="1ed3f-121">完成此操作後，遊戲開發人員會定義一或多個功能，通常是每個層級或區域一或多個。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-121">Once this is done, the game developer defines one or more features, typically one or more per level or zone.</span></span> <span data-ttu-id="1ed3f-122">應用程式的每個功能都會指定一組執行該特定功能所需的元件。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-122">Each feature of an application specifies a set of components necessary for running that particular feature.</span></span> <span data-ttu-id="1ed3f-123">安裝應用程式時，可以在安裝期間將其功能標示為「安裝」 (元件複製到本機硬碟) 或「已通告」 (元件在應用程式使用該功能) 時複製到本機硬碟。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-123">When an application is installed, its features can be marked as "install" (components copied to the local hard drive at installation time) or "advertised" (components copied to the local hard drive after the initial install when the application uses that feature).</span></span> <span data-ttu-id="1ed3f-124">遊戲開發人員可以藉由使用一組最基本的功能來啟動和執行遊戲，來縮短安裝時間。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-124">A game developer can reduce the installation time by designing the game to launch and run with a minimal set of features installed.</span></span> <span data-ttu-id="1ed3f-125">當應用程式實際需要使用這些功能所提供的功能時，它的其餘功能可以標示為已公告並隨選安裝。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-125">The rest of its features can be marked as advertised and installed on demand when the application actually needs to use functionalities that those features provide.</span></span>

<span data-ttu-id="1ed3f-126">遊戲可以呼叫 [Windows Installer](/windows/desktop/Msi/windows-installer-portal) 安裝可能尚未安裝的特定功能。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-126">Games can call [Windows Installer](/windows/desktop/Msi/windows-installer-portal) to install a particular feature that may not have been installed.</span></span> <span data-ttu-id="1ed3f-127">若要讓安裝出現在背景，可以使用背景工作執行緒來呼叫安裝程式，同時讓主要執行緒繼續處理遊戲邏輯和轉譯螢幕。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-127">To make the installation appear in the background, a worker thread can be used to make the calls to the installer while the primary thread continues to handle game logic and to render the screen.</span></span> <span data-ttu-id="1ed3f-128">這可將安裝所造成的遊戲中斷降到最低。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-128">This minimizes the disruption of gameplay caused by the installation.</span></span> <span data-ttu-id="1ed3f-129">遊戲可以隨時起始安裝。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-129">The game can initiate the installation at any time.</span></span> <span data-ttu-id="1ed3f-130">不過，因為安裝會耗用處理器週期，所以在主要執行緒需要處理能力時（例如使用者在動作的中間），通常不是最好的做法。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-130">However, because the installation consumes processor cycles, it is generally not a good idea to perform the installation when the primary thread is in critical need of processing power, such as when the user is in the middle of the action.</span></span> <span data-ttu-id="1ed3f-131">例如，執行安裝的好時機可能是在使用者于遊戲功能表、遊戲暫停或最小化，或是使用者觀賞簡介電影或 cutscenes 時。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-131">For example, a good time to perform the installation may be during the time the user is in the game menu, when the game is paused or minimized, or when the user is watching the introduction movie or cutscenes.</span></span>

## <a name="patching-support"></a><span data-ttu-id="1ed3f-132">修補支援</span><span class="sxs-lookup"><span data-stu-id="1ed3f-132">Patching Support</span></span>

<span data-ttu-id="1ed3f-133">現今大部分的遊戲都需要更新，即使在發行時，也會修正問題，並新增新功能。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-133">Most games today need to be updated even after they ship as bugs get fixed and new features get added.</span></span> <span data-ttu-id="1ed3f-134">更新通常需要修補，這通常是遊戲的簡單程式。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-134">Updating often requires patching, which is traditionally a straightforward procedure for games.</span></span> <span data-ttu-id="1ed3f-135">由於所有必要的檔案都安裝在使用者的硬碟上，因此修補遊戲牽涉到將修改過的檔案複製到硬碟上，以覆寫現有的檔案。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-135">Because all of the necessary files are installed onto the user's hard drive, patching a game involves copying revised files onto the hard drive, overwriting existing files.</span></span> <span data-ttu-id="1ed3f-136">採用隨選安裝時，不會在修補時安裝和複製所有檔案。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-136">When install-on-demand is employed, not all files are installed and copied at the time of patching.</span></span> <span data-ttu-id="1ed3f-137">因此，patcher 無法直接將更新的檔案寫入遊戲資料夾。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-137">Therefore, the patcher cannot simply write updated files onto the game folder.</span></span>

<span data-ttu-id="1ed3f-138">[Windows Installer](/windows/desktop/Msi/windows-installer-portal) 具有修補使用隨選安裝之應用程式的功能。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-138">[Windows Installer](/windows/desktop/Msi/windows-installer-portal) has features for patching applications that use install-on-demand.</span></span> <span data-ttu-id="1ed3f-139">套用修補程式時，安裝程式會將修補程式快取到系統上。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-139">When applying a patch, the installer caches the patch onto the system.</span></span> <span data-ttu-id="1ed3f-140">這項功能適用于差異很小的修補程式。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-140">This feature works well for patches with small deltas.</span></span> <span data-ttu-id="1ed3f-141">在修補時，原始發行的檔案不再需要在磁片上，因此可以公告這些檔案。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-141">The originally released files no longer need to be on the disk at the time of patching, so those files can be advertised.</span></span> <span data-ttu-id="1ed3f-142">稍後，當應用程式執行並需要存取檔案時，安裝程式會從媒體複製原始發行的版本，以安裝這些檔案的最新版本 (例如，Cd) ，並在讀取已儲存的修補資料之後套用修補程式。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-142">Later, when the application runs and needs to access the files, the installer installs the most recent version of those files by copying the originally released version from the media (for example, CDs) and applying the patch after reading the saved patch data.</span></span>

## <a name="the-installondemand-sdk-sample"></a><span data-ttu-id="1ed3f-143">InstallOnDemand SDK 範例</span><span class="sxs-lookup"><span data-stu-id="1ed3f-143">The InstallOnDemand SDK Sample</span></span>

<span data-ttu-id="1ed3f-144">適用于遊戲的隨選安裝範例會示範本文中討論的隨選安裝技術。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-144">The Install-on-Demand for Games sample demonstrates the install-on-demand techniques discussed in this article.</span></span> <span data-ttu-id="1ed3f-145">不同于其他範例，您無法直接從範例瀏覽器執行遊戲的隨選安裝。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-145">Unlike other samples, Install-on-Demand for Games cannot be run directly from the sample browser.</span></span> <span data-ttu-id="1ed3f-146">因為此範例會使用 [Windows Installer](/windows/desktop/Msi/windows-installer-portal) 來管理其安裝，所以必須將它包含在安裝之應用程式的安裝程式資料庫中。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-146">Because the sample uses the [Windows Installer](/windows/desktop/Msi/windows-installer-portal) to manage its installation, it needs to be included in the installer's database of installed applications.</span></span>

<span data-ttu-id="1ed3f-147">**若要啟動範例**</span><span class="sxs-lookup"><span data-stu-id="1ed3f-147">**To launch the sample**</span></span>

1.  <span data-ttu-id="1ed3f-148">使用範例瀏覽器中的 [安裝專案] 連結，將範例的檔案複製到資料夾。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-148">Use the Install Project link in the sample browser to copy the sample's files to a folder.</span></span>
2.  <span data-ttu-id="1ed3f-149">按兩下 InstallOnDemand.msi 安裝範例。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-149">Double click InstallOnDemand.msi to install the sample.</span></span>
3.  <span data-ttu-id="1ed3f-150">選取 [一般安裝]。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-150">Select Typical Install.</span></span>
4.  <span data-ttu-id="1ed3f-151">啟動範例，方法是在已安裝的資料夾中啟動 InstallOnDemand.exe， (一般程式檔 \\ InstallOnDemand) 或從 [開始] 功能表 \\ 程式啟動。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-151">Start the sample by launching the InstallOnDemand.exe in the installed folder (typically Program Files\\InstallOnDemand) or by launching from Start Menu\\Programs.</span></span>

<span data-ttu-id="1ed3f-152">InstallOnDemand.msi 是安裝程式所能辨識的資料庫。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-152">InstallOnDemand.msi is a database recognized by the installer.</span></span> <span data-ttu-id="1ed3f-153">它會定義整個安裝程式：目錄結構、將不會複製的內容、要複製的資源、要寫入的登錄值、要建立的快捷方式等等。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-153">It defines the entire installation process: the directory structure, what will and will not be copied, what resources will be copied together, what registry values to write, what shortcuts to create, and so forth.</span></span>

<span data-ttu-id="1ed3f-154">當啟動時，範例會播放簡介順序。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-154">When launched, the sample plays an introduction sequence.</span></span> <span data-ttu-id="1ed3f-155">播放程式可以結束它，然後按下 ESC 鍵來輸入主功能表。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-155">The player can end it and enter the main menu by pressing the ESC key.</span></span> <span data-ttu-id="1ed3f-156">在簡介之後，播放程式就可以藉由輸入字元名稱並在統計資料中滾動，來啟動新遊戲。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-156">Following the introduction, the player can start a new game by entering a character name and scrolling through the statistics.</span></span> <span data-ttu-id="1ed3f-157">在範例開始播放簡介順序之前，此範例會呼叫安裝程式函數來檢查是否已安裝層級1的功能。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-157">Before the sample begins to play the introduction sequence, the sample calls an installer function to check if the feature for level 1 is installed.</span></span> <span data-ttu-id="1ed3f-158">如果未安裝層級1功能，此範例會使用背景執行緒來要求安裝程式安裝遊戲，而主要執行緒會執行 (其他工作，例如播放簡介順序、轉譯功能表，或在建立字元時與播放程式互動) 。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-158">If the level 1 feature has not been installed, the sample uses a background thread to ask the installer to install the game, while the primary thread is doing something else (such as playing the introduction sequence, rendering the menu, or interacting with the player on character creation).</span></span> <span data-ttu-id="1ed3f-159">此體驗與傳統的遊戲安裝不同之處是，使用者在遊戲中 (觀看簡介，或在安裝過程中建立新的字元) 。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-159">The experience is different from traditional game installation in that the user is occupied in the game (watching the introduction or creating a new character) while installation is in progress.</span></span> <span data-ttu-id="1ed3f-160">當播放程式完成建立字元之後，此範例會載入層級1的資源。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-160">After the player has finished creating a character, the sample loads the resources for level 1.</span></span>

<span data-ttu-id="1ed3f-161">範例畫面右側有五個標示為「Play 等級1」到「Play 等級5」的按鈕。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-161">On the right side of the sample screen are five buttons marked "Play Level 1" through "Play Level 5."</span></span> <span data-ttu-id="1ed3f-162">這些按鈕會模擬播放程式完成目前層級的作業，並前進到下一個層級。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-162">These buttons simulate the player's completion of the current level and advancement to the next.</span></span> <span data-ttu-id="1ed3f-163">按一下其中一個按鈕時，[統計資料] 畫面隨即出現，顯示他剛剛完成之層級的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-163">When one of these buttons is clicked, a statistics screen appears showing information about the level that he has just finished.</span></span> <span data-ttu-id="1ed3f-164">此範例也會要求安裝程式檢查並安裝下一個層級（如果尚未安裝）。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-164">The sample also takes this time to ask the installer to check and install the next level, if it is not already installed.</span></span> <span data-ttu-id="1ed3f-165">當播放程式讀取統計資料畫面時，就會進行安裝，如此一來，當使用者按一下 [確定] 進入下一個層級時，就會安裝層級的資源，並準備載入。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-165">The installation occurs while the player is reading the statistics screen, so that when the user clicks OK to enter the next level, the level's resources are all installed and ready to be loaded.</span></span>

## <a name="the-samples-features-and-components"></a><span data-ttu-id="1ed3f-166">範例的功能和元件</span><span class="sxs-lookup"><span data-stu-id="1ed3f-166">The Sample's Features and Components</span></span>

<span data-ttu-id="1ed3f-167">傳統上，遊戲需要在啟動之前安裝所有或大部分的檔案。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-167">Traditionally, games require that all or most of the files be installed prior to launching.</span></span> <span data-ttu-id="1ed3f-168">為了達成隨選安裝，遊戲資源必須是模組化;也就是說，開發人員必須將應用程式的資源分割 (圖形、音訊等等) 至元件。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-168">In order to achieve install-on-demand, the game resources need to be modular; that is, the developer must divide the application's resources (graphics, audio, and so on) into components.</span></span> <span data-ttu-id="1ed3f-169">每個元件都是一組資源，可以安裝或移除為一個單位。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-169">Each component is a set of resources that can be installed or removed as a unit.</span></span> <span data-ttu-id="1ed3f-170">完成此操作後，遊戲開發人員會定義一或多個功能，通常是每個層級或區域一或多個。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-170">Once this is done, the game developer defines one or more features, typically one or more per level or zone.</span></span> <span data-ttu-id="1ed3f-171">應用程式的每個功能都會指定一組執行該特定功能所需的元件。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-171">Each feature of an application specifies a set of components necessary for running that particular feature.</span></span> <span data-ttu-id="1ed3f-172">安裝應用程式時，可以在安裝時將其功能標示為「安裝」 (複製到本機硬碟的元件) 或「已公告」 (元件，以便在應用程式稍後使用該功能) 時複製到本機硬碟。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-172">When an application is installed, its features can be marked as "install" (components copied to the local hard drive at installation time) or "advertised" (components copied to the local hard drive when the application later uses that feature).</span></span> <span data-ttu-id="1ed3f-173">遊戲開發人員可以藉由使用一組最基本的功能來啟動並開始執行遊戲，來縮短安裝時間。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-173">A game developer can reduce the installation time by designing the game to launch and start running with a minimal set of features installed.</span></span> <span data-ttu-id="1ed3f-174">當應用程式實際需要使用這些功能所提供的功能時，它的其餘功能可以標示為已公告並隨選安裝。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-174">The rest of its features can be marked as advertised and installed on-demand when the application actually needs to use functionalities that those features provide.</span></span>

<span data-ttu-id="1ed3f-175">下表列出此範例所定義的六個最上層功能。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-175">The following table lists the six top-level features that the sample defines.</span></span>



| <span data-ttu-id="1ed3f-176">功能名稱</span><span class="sxs-lookup"><span data-stu-id="1ed3f-176">Feature Name</span></span> | <span data-ttu-id="1ed3f-177">功能</span><span class="sxs-lookup"><span data-stu-id="1ed3f-177">Functionality</span></span>                                                                                                                                                                                                             | <span data-ttu-id="1ed3f-178">單元</span><span class="sxs-lookup"><span data-stu-id="1ed3f-178">Components</span></span>  | <span data-ttu-id="1ed3f-179">檔案</span><span class="sxs-lookup"><span data-stu-id="1ed3f-179">Files</span></span>                                                                     |
|--------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------|---------------------------------------------------------------------------|
| <span data-ttu-id="1ed3f-180">核心</span><span class="sxs-lookup"><span data-stu-id="1ed3f-180">Core</span></span>         | <span data-ttu-id="1ed3f-181">無論層級為何，都包含所有時候都需要的資源。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-181">Includes resources required at all times, regardless of level.</span></span> <span data-ttu-id="1ed3f-182">這些資源包括：範例可執行檔、簡介順序和載入畫面所需的媒體，以及處理範例中所有轉譯的 fx 檔案。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-182">These resources are: sample executable, media required by introduction sequence and loading screen, and .fx file that handles all rendering in the sample.</span></span> | <span data-ttu-id="1ed3f-183">核心</span><span class="sxs-lookup"><span data-stu-id="1ed3f-183">Core</span></span>        | <span data-ttu-id="1ed3f-184">InstallOnDemand.exe、InstallOnDemand、Loading.bmp、Level. x</span><span class="sxs-lookup"><span data-stu-id="1ed3f-184">InstallOnDemand.exe, InstallOnDemand.fx, Loading.bmp, Level.x</span></span>             |
| <span data-ttu-id="1ed3f-185">核心</span><span class="sxs-lookup"><span data-stu-id="1ed3f-185">Core</span></span>         | <span data-ttu-id="1ed3f-186"> (與上述相同) </span><span class="sxs-lookup"><span data-stu-id="1ed3f-186">(same as above)</span></span>                                                                                                                                                                                                           | <span data-ttu-id="1ed3f-187">CoreUI</span><span class="sxs-lookup"><span data-stu-id="1ed3f-187">CoreUI</span></span>      | <span data-ttu-id="1ed3f-188">媒體 \\ ui \\ Dxutcontrols，媒體 \\ ui \\ DXUTShared fx，媒體 \\ ui \\ 箭號. x</span><span class="sxs-lookup"><span data-stu-id="1ed3f-188">Media\\UI\\dxutcontrols.dds, Media\\UI\\DXUTShared.fx, Media\\UI\\arrow.x</span></span> |
| <span data-ttu-id="1ed3f-189">核心</span><span class="sxs-lookup"><span data-stu-id="1ed3f-189">Core</span></span>         | <span data-ttu-id="1ed3f-190"> (與上述相同) </span><span class="sxs-lookup"><span data-stu-id="1ed3f-190">(same as above)</span></span>                                                                                                                                                                                                           | <span data-ttu-id="1ed3f-191">CoreMisc</span><span class="sxs-lookup"><span data-stu-id="1ed3f-191">CoreMisc</span></span>    | <span data-ttu-id="1ed3f-192">媒體 \\ 其他 \\ Seafloor、媒體 \\ 其他 \\seafloor.bmp</span><span class="sxs-lookup"><span data-stu-id="1ed3f-192">Media\\Misc\\seafloor.x, Media\\Misc\\seafloor.bmp</span></span>                        |
| <span data-ttu-id="1ed3f-193">核心</span><span class="sxs-lookup"><span data-stu-id="1ed3f-193">Core</span></span>         | <span data-ttu-id="1ed3f-194"> (與上述相同) </span><span class="sxs-lookup"><span data-stu-id="1ed3f-194">(same as above)</span></span>                                                                                                                                                                                                           | <span data-ttu-id="1ed3f-195">CoreSpeeder</span><span class="sxs-lookup"><span data-stu-id="1ed3f-195">CoreSpeeder</span></span> | <span data-ttu-id="1ed3f-196">Media \\ PRT 示範 \\ LandShark，Media \\ PRT demo \\ speeder \_diff.jpg</span><span class="sxs-lookup"><span data-stu-id="1ed3f-196">Media\\PRT Demo\\LandShark.x, Media\\PRT Demo\\speeder\_diff.jpg</span></span>          |
| <span data-ttu-id="1ed3f-197">核心</span><span class="sxs-lookup"><span data-stu-id="1ed3f-197">Core</span></span>         | <span data-ttu-id="1ed3f-198"> (與上述相同) </span><span class="sxs-lookup"><span data-stu-id="1ed3f-198">(same as above)</span></span>                                                                                                                                                                                                           | <span data-ttu-id="1ed3f-199">CoreReg</span><span class="sxs-lookup"><span data-stu-id="1ed3f-199">CoreReg</span></span>     | <span data-ttu-id="1ed3f-200">N/A (登錄值) </span><span class="sxs-lookup"><span data-stu-id="1ed3f-200">N/A (registry value)</span></span>                                                      |
| <span data-ttu-id="1ed3f-201">Level1</span><span class="sxs-lookup"><span data-stu-id="1ed3f-201">Level1</span></span>       | <span data-ttu-id="1ed3f-202">提供層級1所使用的資源。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-202">Provides resources used by level 1.</span></span>                                                                                                                                                                                       | <span data-ttu-id="1ed3f-203">Level1</span><span class="sxs-lookup"><span data-stu-id="1ed3f-203">Level1</span></span>      | <span data-ttu-id="1ed3f-204">Level1.jpg</span><span class="sxs-lookup"><span data-stu-id="1ed3f-204">Level1.jpg</span></span>                                                                |
| <span data-ttu-id="1ed3f-205">Level1</span><span class="sxs-lookup"><span data-stu-id="1ed3f-205">Level1</span></span>       | <span data-ttu-id="1ed3f-206"> (與先前的) 相同</span><span class="sxs-lookup"><span data-stu-id="1ed3f-206">(same as previous)</span></span>                                                                                                                                                                                                        | <span data-ttu-id="1ed3f-207">L1Skybox</span><span class="sxs-lookup"><span data-stu-id="1ed3f-207">L1Skybox</span></span>    | <span data-ttu-id="1ed3f-208">Media \\ Light 探查 \\ galileo \_</span><span class="sxs-lookup"><span data-stu-id="1ed3f-208">Media\\Light Probes\\galileo\_cross.dds</span></span>                                   |
| <span data-ttu-id="1ed3f-209">Level2</span><span class="sxs-lookup"><span data-stu-id="1ed3f-209">Level2</span></span>       | <span data-ttu-id="1ed3f-210">提供層級2所使用的資源。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-210">Provides resources used by level 2.</span></span>                                                                                                                                                                                       | <span data-ttu-id="1ed3f-211">Level2</span><span class="sxs-lookup"><span data-stu-id="1ed3f-211">Level2</span></span>      | <span data-ttu-id="1ed3f-212">Level2.jpg</span><span class="sxs-lookup"><span data-stu-id="1ed3f-212">Level2.jpg</span></span>                                                                |
| <span data-ttu-id="1ed3f-213">Level2</span><span class="sxs-lookup"><span data-stu-id="1ed3f-213">Level2</span></span>       | <span data-ttu-id="1ed3f-214"> (與先前的) 相同</span><span class="sxs-lookup"><span data-stu-id="1ed3f-214">(same as previous)</span></span>                                                                                                                                                                                                        | <span data-ttu-id="1ed3f-215">L2Skybox</span><span class="sxs-lookup"><span data-stu-id="1ed3f-215">L2Skybox</span></span>    | <span data-ttu-id="1ed3f-216">媒體 \\ 光線探查 \\ \_ 跨的寬限期</span><span class="sxs-lookup"><span data-stu-id="1ed3f-216">Media\\Light Probes\\grace\_cross.dds</span></span>                                     |
| <span data-ttu-id="1ed3f-217">Level3</span><span class="sxs-lookup"><span data-stu-id="1ed3f-217">Level3</span></span>       | <span data-ttu-id="1ed3f-218">提供層級3所使用的資源。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-218">Provides resources used by level 3.</span></span>                                                                                                                                                                                       | <span data-ttu-id="1ed3f-219">Level3</span><span class="sxs-lookup"><span data-stu-id="1ed3f-219">Level3</span></span>      | <span data-ttu-id="1ed3f-220">Level3.jpg</span><span class="sxs-lookup"><span data-stu-id="1ed3f-220">Level3.jpg</span></span>                                                                |
| <span data-ttu-id="1ed3f-221">Level3</span><span class="sxs-lookup"><span data-stu-id="1ed3f-221">Level3</span></span>       | <span data-ttu-id="1ed3f-222"> (與先前的) 相同</span><span class="sxs-lookup"><span data-stu-id="1ed3f-222">(same as previous)</span></span>                                                                                                                                                                                                        | <span data-ttu-id="1ed3f-223">L3Skybox</span><span class="sxs-lookup"><span data-stu-id="1ed3f-223">L3Skybox</span></span>    | <span data-ttu-id="1ed3f-224">Media \\ Light 探查 \\ rnl \_</span><span class="sxs-lookup"><span data-stu-id="1ed3f-224">Media\\Light Probes\\rnl\_cross.dds</span></span>                                       |
| <span data-ttu-id="1ed3f-225">Level4</span><span class="sxs-lookup"><span data-stu-id="1ed3f-225">Level4</span></span>       | <span data-ttu-id="1ed3f-226">提供層級4所使用的資源。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-226">Provides resources used by level 4.</span></span>                                                                                                                                                                                       | <span data-ttu-id="1ed3f-227">Level4</span><span class="sxs-lookup"><span data-stu-id="1ed3f-227">Level4</span></span>      | <span data-ttu-id="1ed3f-228">Level4.jpg</span><span class="sxs-lookup"><span data-stu-id="1ed3f-228">Level4.jpg</span></span>                                                                |
| <span data-ttu-id="1ed3f-229">Level4</span><span class="sxs-lookup"><span data-stu-id="1ed3f-229">Level4</span></span>       | <span data-ttu-id="1ed3f-230"> (與先前的) 相同</span><span class="sxs-lookup"><span data-stu-id="1ed3f-230">(same as previous)</span></span>                                                                                                                                                                                                        | <span data-ttu-id="1ed3f-231">L4Skybox</span><span class="sxs-lookup"><span data-stu-id="1ed3f-231">L4Skybox</span></span>    | <span data-ttu-id="1ed3f-232">Media \\ Light 探查 \\ stpeters \_</span><span class="sxs-lookup"><span data-stu-id="1ed3f-232">Media\\Light Probes\\stpeters\_cross.dds</span></span>                                  |
| <span data-ttu-id="1ed3f-233">Level5</span><span class="sxs-lookup"><span data-stu-id="1ed3f-233">Level5</span></span>       | <span data-ttu-id="1ed3f-234">提供層級5所使用的資源。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-234">Provides resources used by level 5.</span></span>                                                                                                                                                                                       | <span data-ttu-id="1ed3f-235">Level5</span><span class="sxs-lookup"><span data-stu-id="1ed3f-235">Level5</span></span>      | <span data-ttu-id="1ed3f-236">Level5.jpg</span><span class="sxs-lookup"><span data-stu-id="1ed3f-236">Level5.jpg</span></span>                                                                |
| <span data-ttu-id="1ed3f-237">Level5</span><span class="sxs-lookup"><span data-stu-id="1ed3f-237">Level5</span></span>       | <span data-ttu-id="1ed3f-238"> (與先前的) 相同</span><span class="sxs-lookup"><span data-stu-id="1ed3f-238">(same as previous)</span></span>                                                                                                                                                                                                        | <span data-ttu-id="1ed3f-239">L5Skybox</span><span class="sxs-lookup"><span data-stu-id="1ed3f-239">L5Skybox</span></span>    | <span data-ttu-id="1ed3f-240">Media \\ Light 探查 \\ uffizi \_</span><span class="sxs-lookup"><span data-stu-id="1ed3f-240">Media\\Light Probes\\uffizi\_cross.dds</span></span>                                    |



 

<span data-ttu-id="1ed3f-241">具有層級的 >level5 功能具有其他子功能，其包含範例未直接使用的檔案。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-241">The Level1 through Level5 features have additional sub-features that contain files not directly used by the sample.</span></span> <span data-ttu-id="1ed3f-242">已新增這些子功能檔案，讓安裝變得更長。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-242">These sub-features files have been added to make the installation take longer.</span></span> <span data-ttu-id="1ed3f-243">這是為了說明執行範例時，在背景中執行的進行中安裝作業。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-243">This is done to illustrate the ongoing installation operation that is running in the background while the sample is running.</span></span>

<span data-ttu-id="1ed3f-244">下表列出子功能。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-244">The following table lists the sub-features.</span></span>



| <span data-ttu-id="1ed3f-245">功能</span><span class="sxs-lookup"><span data-stu-id="1ed3f-245">Feature</span></span> | <span data-ttu-id="1ed3f-246">子功能</span><span class="sxs-lookup"><span data-stu-id="1ed3f-246">Sub-features</span></span>                      | <span data-ttu-id="1ed3f-247">檔案</span><span class="sxs-lookup"><span data-stu-id="1ed3f-247">Files</span></span>                                                                                                                                                                          |
|---------|-----------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="1ed3f-248">Level1</span><span class="sxs-lookup"><span data-stu-id="1ed3f-248">Level1</span></span>  | <span data-ttu-id="1ed3f-249">L1PH1, L1PH2, L1PH3, L1PH4, L1PH5</span><span class="sxs-lookup"><span data-stu-id="1ed3f-249">L1PH1, L1PH2, L1PH3, L1PH4, L1PH5</span></span> | <span data-ttu-id="1ed3f-250">1-1 預留位置資料 L1PH1。 .dat 1-1 的預留位置資料 L1PH2。 .dat 1-1 的預留位置資料 L1PH3。 dat 1-1 預留位置資料 \\ \\ \\ \\ L1PH4 \\</span><span class="sxs-lookup"><span data-stu-id="1ed3f-250">Level1 Placeholder Data\\L1PH1.dat Level1 Placeholder Data\\L1PH2.dat Level1 Placeholder Data\\L1PH3.dat Level1 Placeholder Data\\L1PH4.dat Level1 Placeholder Data\\L1PH5.dat</span></span> |
| <span data-ttu-id="1ed3f-251">Level2</span><span class="sxs-lookup"><span data-stu-id="1ed3f-251">Level2</span></span>  | <span data-ttu-id="1ed3f-252">L2PH1, L2PH2, L2PH3, L2PH4, L2PH5</span><span class="sxs-lookup"><span data-stu-id="1ed3f-252">L2PH1, L2PH2, L2PH3, L2PH4, L2PH5</span></span> | <span data-ttu-id="1ed3f-253">2-////////////L2PH1 的預留位置資料 L2PH2。 dat 2-2-2-2-2-2 的預留位置資料 \\ \\ \\ \\ L2PH4。 \\</span><span class="sxs-lookup"><span data-stu-id="1ed3f-253">Level2 Placeholder Data\\L2PH1.dat Level2 Placeholder Data\\L2PH2.dat Level2 Placeholder Data\\L2PH3.dat Level2 Placeholder Data\\L2PH4.dat Level2 Placeholder Data\\L2PH5.dat</span></span> |
| <span data-ttu-id="1ed3f-254">Level3</span><span class="sxs-lookup"><span data-stu-id="1ed3f-254">Level3</span></span>  | <span data-ttu-id="1ed3f-255">L3PH1, L3PH2, L3PH3, L3PH4, L3PH5</span><span class="sxs-lookup"><span data-stu-id="1ed3f-255">L3PH1, L3PH2, L3PH3, L3PH4, L3PH5</span></span> | <span data-ttu-id="1ed3f-256">3-3 預留位置資料 \\ L3PH1。 Dat 3-3 預留位置資料 L3PH2。 dat 3-3 預留位置資料 \\ \\ L3PH3。 dat \\ 3-L3PH4 \\</span><span class="sxs-lookup"><span data-stu-id="1ed3f-256">Level3 Placeholder Data\\L3PH1.dat Level3 Placeholder Data\\L3PH2.dat Level3 Placeholder Data\\L3PH3.dat Level3 Placeholder Data\\L3PH4.dat Level3 Placeholder Data\\L3PH5.dat</span></span> |
| <span data-ttu-id="1ed3f-257">Level4</span><span class="sxs-lookup"><span data-stu-id="1ed3f-257">Level4</span></span>  | <span data-ttu-id="1ed3f-258">L4PH1, L4PH2, L4PH3, L4PH4, L4PH5</span><span class="sxs-lookup"><span data-stu-id="1ed3f-258">L4PH1, L4PH2, L4PH3, L4PH4, L4PH5</span></span> | <span data-ttu-id="1ed3f-259">Level4 預留位置資料 \\ L4PH1 .Dat Level4 預留位置資料 \\ L4PH2. Dat Level4 預留位置資料 \\ L4PH3。 Dat Level4 預留位置資料 \\ L4PH4. dat Level4 預留位置資料 \\ L4PH5 .dat</span><span class="sxs-lookup"><span data-stu-id="1ed3f-259">Level4 Placeholder Data\\L4PH1.dat Level4 Placeholder Data\\L4PH2.dat Level4 Placeholder Data\\L4PH3.dat Level4 Placeholder Data\\L4PH4.dat Level4 Placeholder Data\\L4PH5.dat</span></span> |
| <span data-ttu-id="1ed3f-260">Level5</span><span class="sxs-lookup"><span data-stu-id="1ed3f-260">Level5</span></span>  | <span data-ttu-id="1ed3f-261">L5PH1, L5PH2, L5PH3, L5PH4, L5PH5</span><span class="sxs-lookup"><span data-stu-id="1ed3f-261">L5PH1, L5PH2, L5PH3, L5PH4, L5PH5</span></span> | <span data-ttu-id="1ed3f-262">>level5 預留位置資料 \\ L5PH1 .Dat >level5 預留位置資料 \\ L5PH2. Dat >level5 預留位置資料 \\ L5PH3。 Dat >level5 預留位置資料 \\ L5PH4. dat >level5 預留位置資料 \\ L5PH5 .dat</span><span class="sxs-lookup"><span data-stu-id="1ed3f-262">Level5 Placeholder Data\\L5PH1.dat Level5 Placeholder Data\\L5PH2.dat Level5 Placeholder Data\\L5PH3.dat Level5 Placeholder Data\\L5PH4.dat Level5 Placeholder Data\\L5PH5.dat</span></span> |



 

<span data-ttu-id="1ed3f-263">在安裝期間，核心功能應標示為「安裝」，而且所有其他功能都應標示為「已公告」。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-263">During installation, the core feature should be marked "install" and all other features should be marked "advertised."</span></span> <span data-ttu-id="1ed3f-264">只要安裝一項功能，而不是使用六個功能，播放程式必須等到遊戲啟動的時間才會大幅降低。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-264">By only installing one feature instead of six, the time that the player must wait until the game launches is significantly reduced.</span></span>

## <a name="installation"></a><span data-ttu-id="1ed3f-265">安裝</span><span class="sxs-lookup"><span data-stu-id="1ed3f-265">Installation</span></span>

<span data-ttu-id="1ed3f-266">[Windows Installer](/windows/desktop/Msi/windows-installer-portal)提供一種機制，讓應用程式要求安裝已公告的功能。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-266">The [Windows Installer](/windows/desktop/Msi/windows-installer-portal) provides a mechanism for an application to request that an advertised feature be installed.</span></span> <span data-ttu-id="1ed3f-267">不過，此機制是 (API) 呼叫的同步應用程式開發介面，這表示應用程式必須在呼叫中等候，直到安裝完成為止。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-267">However, the mechanism is a synchronous application programming interface (API) call, which means that the application has to wait inside the call until the installation is complete.</span></span> <span data-ttu-id="1ed3f-268">若要達到背景安裝，需要工作者執行緒，才能讓主應用程式執行緒自由執行其他重要工作，例如在螢幕上轉譯，以繼續提供玩家視覺效果的意見反應。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-268">To achieve background installation, a worker thread is required so that the main application thread is free to perform other important tasks, such as rendering on the screen to continue giving the player visual feedback.</span></span>

<span data-ttu-id="1ed3f-269">在此範例中，執行範例時有三種安裝狀態：主動式安裝、被動安裝和無安裝。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-269">In the sample, there are three states of installation that happen during the sample execution: active installation, passive installation, and no installation.</span></span>

-   <span data-ttu-id="1ed3f-270">主動安裝是範例在需要存取或載入一或多個功能所提供的資源時，所起始的要求。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-270">Active installation is a request initiated by the sample when it needs to access or load resources provided by one or more features.</span></span> <span data-ttu-id="1ed3f-271">此範例會在安裝資源之前無法繼續進行。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-271">The sample does this when it can not continue until the resource is installed.</span></span>
-   <span data-ttu-id="1ed3f-272">當範例未執行重要工作（例如播放程式在功能表上或觀賞剪下場景）時，就會起始被動安裝。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-272">Passive installation is initiated when the sample is not performing a critical task such as when the player is at a menu or watching a cut scene.</span></span> <span data-ttu-id="1ed3f-273">當發生這種情況時，背景工作執行緒會檢查是否仍會公告範例的任何功能。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-273">When this is the case, the worker thread checks if any feature of the sample is still advertised.</span></span> <span data-ttu-id="1ed3f-274">如果找到一個，就會呼叫安裝程式來安裝該功能。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-274">If it can find one, it calls the installer to install that feature.</span></span> <span data-ttu-id="1ed3f-275">此程式會重複執行，直到安裝範例的每個功能為止。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-275">This process repeats until every feature of the sample is installed.</span></span> <span data-ttu-id="1ed3f-276">基本上，被動安裝會利用額外的處理器迴圈，在最不幹擾主要範例的情況下在背景中執行安裝。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-276">Essentially, passive installation utilizes extra processor cycles to perform installation in the background when it is least intrusive to the main sample.</span></span>
-   <span data-ttu-id="1ed3f-277">當玩家主動參與遊戲時，不會進行任何安裝;這可防止畫面播放速率下降，進而中斷使用者體驗。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-277">No installation happens when the player is actively engaged in the game; this prevents a framerate drop which would disrupt the user experience.</span></span>

<span data-ttu-id="1ed3f-278">在此範例中，定義了類別 CMsiUtil 來處理所有與安裝相關的工作。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-278">In the sample, a class CMsiUtil is defined to handle all installation-related tasks.</span></span> <span data-ttu-id="1ed3f-279">基本上，CMsiUtil 會使用可叫用安裝程式的背景工作執行緒，在迴圈中安裝範例的功能。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-279">Essentially, CMsiUtil uses a worker thread that invokes the installer to install the sample's features in a loop.</span></span> <span data-ttu-id="1ed3f-280">類別有兩個可儲存安裝要求的佇列：一個高優先順序佇列用於主動安裝，一個低優先順序佇列用於被動安裝。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-280">The class has two queues that store installation requests: one high priority queue for active installation and one low priority queue for passive installation.</span></span> <span data-ttu-id="1ed3f-281">在初始化期間，類別會列舉產品的所有功能，並將其新增至被動安裝佇列。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-281">During initialization, the class enumerates all features of the product and adds them to the passive installation queue.</span></span> <span data-ttu-id="1ed3f-282">因為整個產品會以這種方式排入佇列，所以如果範例有足夠的可用處理器週期，則整個產品最終會安裝。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-282">Because the entire product is queued this way, the entire product will eventually be installed if the sample has enough free processor cycles.</span></span>

<span data-ttu-id="1ed3f-283">當範例需要要求主動安裝時，範例可以呼叫 CMsiUtil：： UseFeatureSet () 並傳遞最上層功能的名稱。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-283">When the sample needs to request an active installation, the sample can call CMsiUtil::UseFeatureSet() and pass the name of the top-level feature.</span></span> <span data-ttu-id="1ed3f-284">UseFeatureSet () 會將要求的功能及其所有子功能排入作用中安裝佇列，讓工作者執行緒可以安裝它們。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-284">UseFeatureSet() will queue the requested feature and all of its sub-features in the active installation queue so that the worker thread can install them.</span></span>

<span data-ttu-id="1ed3f-285">執行安裝要求時，背景工作執行緒會檢查使用中的安裝佇列以及被動安裝佇列，以查看其中一個佇列是否有任何其他要求。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-285">While executing an install request, the worker thread will check the active installation queue as well as the passive installation queue to see if either queue has any additional requests.</span></span> <span data-ttu-id="1ed3f-286">每次執行緒找到要求時，就會呼叫安裝程式 API 來執行實際安裝。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-286">Each time the thread finds a request, it will call the installer API to perform the actual installation.</span></span> <span data-ttu-id="1ed3f-287">一旦這兩個佇列都是空的，背景工作執行緒就會透過呼叫 [**WaitForSingleObject**](/windows/desktop/api/synchapi/nf-synchapi-waitforsingleobject)來進入睡眠狀態。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-287">Once both queues are empty, the worker thread will go to sleep with a call to [**WaitForSingleObject**](/windows/desktop/api/synchapi/nf-synchapi-waitforsingleobject).</span></span> <span data-ttu-id="1ed3f-288">由於整個產品會在初始化期間放置於被動安裝佇列中，因此空白佇列表示已安裝整個產品。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-288">Because the entire product is placed in the passive installation queue during initialization, an empty queue implies that the entire product has been installed.</span></span>

<span data-ttu-id="1ed3f-289">此範例會呼叫 CMsiUtil：： EnablePassiveInstall () 來啟用或停用被動安裝。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-289">The sample calls CMsiUtil::EnablePassiveInstall() to enable or disable passive installation.</span></span> <span data-ttu-id="1ed3f-290">EnablePassiveInstall (true) 會遞增被動安裝的啟用計數，而 EnablePassiveInstall (false) 會遞減。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-290">EnablePassiveInstall(true) increments the enable count for passive installation, and EnablePassiveInstall(false) decrements it.</span></span> <span data-ttu-id="1ed3f-291">如果 enable count 大於0，則類別將會處理被動安裝佇列。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-291">If the enable count is greater than 0, the class will process the passive installation queue.</span></span> <span data-ttu-id="1ed3f-292">當下列任何條件成立時，此範例會允許被動安裝：</span><span class="sxs-lookup"><span data-stu-id="1ed3f-292">The sample allows passive installation when any of the following is true:</span></span>

-   <span data-ttu-id="1ed3f-293">使用者正在流覽初始簡介順序。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-293">The user is viewing the initial introduction sequence.</span></span>
-   <span data-ttu-id="1ed3f-294">使用者正在流覽範例功能表中。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-294">The user is navigating in the sample menu.</span></span>
-   <span data-ttu-id="1ed3f-295">使用者正在查看層級結尾的統計資料。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-295">The user is viewing the statistics at the end of a level.</span></span>
-   <span data-ttu-id="1ed3f-296">範例應用程式會失去其焦點，並移至背景。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-296">The sample application loses its focus and goes to the background.</span></span>

<span data-ttu-id="1ed3f-297">CMsiUtil 的方法如下所示：</span><span class="sxs-lookup"><span data-stu-id="1ed3f-297">The methods of CMsiUtil are listed below:</span></span>



| <span data-ttu-id="1ed3f-298">方法</span><span class="sxs-lookup"><span data-stu-id="1ed3f-298">Method</span></span>                | <span data-ttu-id="1ed3f-299">描述</span><span class="sxs-lookup"><span data-stu-id="1ed3f-299">Description</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|-----------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="1ed3f-300">AbortAllRequests</span><span class="sxs-lookup"><span data-stu-id="1ed3f-300">AbortAllRequests</span></span>      | <span data-ttu-id="1ed3f-301">導致目前的安裝中止並清空主動安裝要求佇列。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-301">Causes the current installation to abort and empties the active installation request queue.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| <span data-ttu-id="1ed3f-302">AbortCurrentRequest</span><span class="sxs-lookup"><span data-stu-id="1ed3f-302">AbortCurrentRequest</span></span>   | <span data-ttu-id="1ed3f-303">導致安裝進行中止。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-303">Causes the installation in progress to abort.</span></span> <span data-ttu-id="1ed3f-304">然後，背景工作執行緒會處理佇列中的下一個要求（如果有的話）。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-304">The worker thread then processes the next request in the queue, if one exists.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| <span data-ttu-id="1ed3f-305">EnablePassiveInstall</span><span class="sxs-lookup"><span data-stu-id="1ed3f-305">EnablePassiveInstall</span></span>  | <span data-ttu-id="1ed3f-306">遞增或遞減被動安裝啟用計數。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-306">Increments or decrements passive installation enable count.</span></span> <span data-ttu-id="1ed3f-307">此範例會使用此呼叫來控制何時可以且無法進行被動安裝。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-307">The sample uses this call to control when passive installation can and cannot happen.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| <span data-ttu-id="1ed3f-308">GetCurrentFeatureName</span><span class="sxs-lookup"><span data-stu-id="1ed3f-308">GetCurrentFeatureName</span></span> | <span data-ttu-id="1ed3f-309">傳回主動安裝的功能名稱。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-309">Returns the name of the feature that is actively being installed.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| <span data-ttu-id="1ed3f-310">GetFeatureProgress</span><span class="sxs-lookup"><span data-stu-id="1ed3f-310">GetFeatureProgress</span></span>    | <span data-ttu-id="1ed3f-311">傳回目前正在安裝之功能的刻度位置。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-311">Returns the current tick position for the feature that is being installed.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| <span data-ttu-id="1ed3f-312">GetFeatureProgressMax</span><span class="sxs-lookup"><span data-stu-id="1ed3f-312">GetFeatureProgressMax</span></span> | <span data-ttu-id="1ed3f-313">傳回所安裝之功能的進度刻度最大數目。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-313">Returns the maximum number of progress tick for the feature that is being installed.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| <span data-ttu-id="1ed3f-314">GetLastError</span><span class="sxs-lookup"><span data-stu-id="1ed3f-314">GetLastError</span></span>          | <span data-ttu-id="1ed3f-315">使用這個方法可從先前的安裝要求中取出傳回碼。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-315">Use this method to retrieve the return code from the previous installation request.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| <span data-ttu-id="1ed3f-316">GetPassiveProgress</span><span class="sxs-lookup"><span data-stu-id="1ed3f-316">GetPassiveProgress</span></span>    | <span data-ttu-id="1ed3f-317">傳回被動安裝的進度列刻度位置。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-317">Returns the progress bar tick position for passive installation.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| <span data-ttu-id="1ed3f-318">GetPassiveProgressMax</span><span class="sxs-lookup"><span data-stu-id="1ed3f-318">GetPassiveProgressMax</span></span> | <span data-ttu-id="1ed3f-319">傳回目前的刻度位置，以及被動安裝的最大刻度數。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-319">Returns the current tick position and the maximum number of ticks for passive installation.</span></span> <span data-ttu-id="1ed3f-320">範例可以搭配使用，以顯示被動安裝的整體進度。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-320">Together, the sample can use them to show the overall progress of the passive installation.</span></span>                                                                                                                                                                                                                                                                                                                                                                                               |
| <span data-ttu-id="1ed3f-321">GetProgress</span><span class="sxs-lookup"><span data-stu-id="1ed3f-321">GetProgress</span></span>           | <span data-ttu-id="1ed3f-322">傳回作用中功能集安裝的進度列刻度位置。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-322">Returns the progress bar tick position for the active feature set installation.</span></span> <span data-ttu-id="1ed3f-323">當範例轉譯安裝進度列時，會使用這個。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-323">This is used when the sample renders the installation progress bar.</span></span> <span data-ttu-id="1ed3f-324">由於 Windows Installer 只會提供所要安裝之某項功能的進度資訊，方法會將進度列分割成要求的功能，讓使用者仍可看到整個安裝程式做為一個工作。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-324">Because the Windows Installer only provides progress information for the one feature being installed, the method divides the progress bar among the requested features so that the user still sees the entire installation as one task.</span></span>                                                                                                                                                                                           |
| <span data-ttu-id="1ed3f-325">GetProgressMax</span><span class="sxs-lookup"><span data-stu-id="1ed3f-325">GetProgressMax</span></span>        | <span data-ttu-id="1ed3f-326">傳回作用中功能集安裝的最大進度列滴答計數。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-326">Returns the maximum progress bar tick count for the active feature set installation.</span></span> <span data-ttu-id="1ed3f-327">當範例轉譯安裝進度列時，會使用這個。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-327">This is used when the sample renders the installation progress bar.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                              |
| <span data-ttu-id="1ed3f-328">初始化</span><span class="sxs-lookup"><span data-stu-id="1ed3f-328">Initialize</span></span>            | <span data-ttu-id="1ed3f-329">使用產品全域唯一識別碼 (GUID) 來初始化類別。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-329">Initializes the class with the product globally unique identifier (GUID).</span></span> <span data-ttu-id="1ed3f-330">此方法也會列舉應用程式中已公告但尚未安裝的每項功能，並將它放在被動安裝佇列中，以設定被動安裝。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-330">This method also enumerates every feature of the application which has been advertised but not yet installed, and places it in the passive installation queue to set up the passive installation.</span></span>                                                                                                                                                                                                                                                                                                           |
| <span data-ttu-id="1ed3f-331">IsInstallInProgress</span><span class="sxs-lookup"><span data-stu-id="1ed3f-331">IsInstallInProgress</span></span>   | <span data-ttu-id="1ed3f-332">您可以使用這個方法來瞭解是否正在處理正在進行中的安裝。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-332">Use this method to find out whether an active installation is being processed.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| <span data-ttu-id="1ed3f-333">UseFeature</span><span class="sxs-lookup"><span data-stu-id="1ed3f-333">UseFeature</span></span>            | <span data-ttu-id="1ed3f-334">UseFeatureSet 呼叫的私用方法。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-334">Private method called by UseFeatureSet.</span></span> <span data-ttu-id="1ed3f-335">檢查是否已安裝功能。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-335">Checks if a feature is installed.</span></span> <span data-ttu-id="1ed3f-336">如果已安裝要求的功能，方法會傳回。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-336">If the requested feature is installed the method returns.</span></span> <span data-ttu-id="1ed3f-337">如果尚未安裝此功能 () 公告，則方法會將背景工作執行緒的新使用中安裝要求排到佇列，然後再傳回。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-337">If the feature is not yet installed (advertised), the method queues a new active installation request for the worker thread and then returns.</span></span> <span data-ttu-id="1ed3f-338">當要求的安裝完成時，將會發出信號的選擇性事件控制碼。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-338">The optional event handle that will be signaled when the requested installation is complete.</span></span>                                                                                                                                                                                                        |
| <span data-ttu-id="1ed3f-339">UseFeatureSet</span><span class="sxs-lookup"><span data-stu-id="1ed3f-339">UseFeatureSet</span></span>         | <span data-ttu-id="1ed3f-340">當範例需要存取特定功能或其任何子功能所提供的功能時，就會呼叫此範例。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-340">Called by the sample when it needs to access functionalities provided by a particular feature or any of its sub-features.</span></span> <span data-ttu-id="1ed3f-341">方法會列舉範例的所有功能，並針對指定根功能的子功能呼叫 UseFeature () 。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-341">The method enumerates all features of the sample and calls UseFeature() for sub-features of the specified root feature.</span></span> <span data-ttu-id="1ed3f-342">此範例可以傳入事件控制碼，此控制碼會在安裝整個功能集時收到信號。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-342">The sample can pass in an event handle that will be signaled when the entire feature set is installed.</span></span> <span data-ttu-id="1ed3f-343">由於所有功能都是安裝為集合，因此會針對 UseFeature () （而不是每個功能）佇列的最後一個功能指定控制碼，如此一來，在安裝所有要求的功能之後，範例就會收到通知。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-343">Because the features all installed as a set, The handle is specified for the last feature queued by UseFeature() instead of every feature, so that the sample gets notified once after all requested features are installed.</span></span> |
| <span data-ttu-id="1ed3f-344">UseProduct</span><span class="sxs-lookup"><span data-stu-id="1ed3f-344">UseProduct</span></span>            | <span data-ttu-id="1ed3f-345">將作用中的安裝要求排入佇列，以呼叫安裝程式來執行完整的產品安裝。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-345">Queues an active installation request for the worker thread to call the installer to perform a full product installation.</span></span> <span data-ttu-id="1ed3f-346">當要求的安裝完成時，將會發出信號的選擇性事件控制碼。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-346">The optional event handle that will be signaled when the requested installation is complete.</span></span>                                                                                                                                                                                                                                                                                                                                                                |



 

## <a name="limitation"></a><span data-ttu-id="1ed3f-347">限制</span><span class="sxs-lookup"><span data-stu-id="1ed3f-347">Limitation</span></span>

<span data-ttu-id="1ed3f-348">目前的安裝程式版本並非設計成可同時由多個執行緒存取。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-348">The current version of installer is not designed for simultaneous access by multiple threads.</span></span> <span data-ttu-id="1ed3f-349">因此，當背景工作執行緒呼叫安裝程式時，主執行緒不應呼叫安裝程式。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-349">Therefore, when the worker thread is calling into the installer, the main thread should not call the installer.</span></span> <span data-ttu-id="1ed3f-350">當主執行緒要求某項功能時，範例中會發生這項限制的範例，然後在背景工作執行緒完成安裝之前，再次要求相同的功能。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-350">An example of this limitation occurs in the sample when the main thread requests a feature, then requests the same feature again before the worker thread completes the installation.</span></span> <span data-ttu-id="1ed3f-351">第二個要求會呼叫 MsiQueryFeatureState () 以找出要求的功能是否已安裝，因為安裝程式有時可能會指出當背景工作執行緒仍在複製檔案時，已完整安裝該功能。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-351">The second request calls MsiQueryFeatureState() to find out whether the requested feature is already installed, since the installer may sometimes indicate that the feature is completely installed when the worker thread is still copying the files.</span></span>

<span data-ttu-id="1ed3f-352">幸運的是，有一個簡單的解決辦法。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-352">Fortunately, there is an easy work-around for this.</span></span> <span data-ttu-id="1ed3f-353">CMsiUtil 會先檢查工作者執行緒是否正在安裝功能，然後再呼叫 MsiQueryFeatureState () 或 MsiUseFeature () 之類的函式，要求有問題之功能的安裝狀態。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-353">CMsiUtil will check whether a feature is being installed by the worker thread before it calls functions such as MsiQueryFeatureState() or MsiUseFeature() to ask for the install state of the feature in question.</span></span> <span data-ttu-id="1ed3f-354">請注意，這項限制也會在其他地方變成問題。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-354">Be aware that this limitation can also become an issue elsewhere.</span></span>

<span data-ttu-id="1ed3f-355">修補可能會影響隨選安裝在終端使用者電腦上的運作方式。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-355">Patching can affect how well install-on-demand works on an end-user's computer.</span></span> <span data-ttu-id="1ed3f-356">套用只包含已從舊版變更之資料的修補程式，可能需要安裝先前版本的已更新檔案才能套用差異。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-356">Applying a patch that only contains data that has changed from the previous version may require that the previous version of the updated file be installed in order to apply the delta.</span></span> <span data-ttu-id="1ed3f-357">在此情況下，修補程式必須要求安裝程式在將修補程式套用至遊戲之前，先安裝受影響的已公告功能。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-357">In this situation, the patch must request that the installer install affected advertised features before applying the patch to the game.</span></span>

<span data-ttu-id="1ed3f-358">此範例是藉由啟動 InstallOnDemand.msi 來安裝，因為它會假設電腦上有 [Windows Installer](/windows/desktop/Msi/windows-installer-portal) 。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-358">The sample is installed by launching InstallOnDemand.msi because it assumes that the [Windows Installer](/windows/desktop/Msi/windows-installer-portal) is present on the computer.</span></span> <span data-ttu-id="1ed3f-359">如果安裝程式不存在，就無法辨識 .msi 檔案，而且啟動這些檔案將無法運作。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-359">If the installer is absent, .msi files are not recognized and launching them will not work.</span></span> <span data-ttu-id="1ed3f-360">若要解決這個問題，應用程式應該使用安裝程式來執行工作。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-360">To overcome this problem, an application should use an installation program to perform the task.</span></span> <span data-ttu-id="1ed3f-361">此程式應先檢查安裝程式是否存在，如果有的話，則為其版本。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-361">This program should first check to see if the installer is present, and if so, its version.</span></span> <span data-ttu-id="1ed3f-362">如果版本不符合應用程式的需求，安裝程式應該安裝 Windows Installer，然後啟動 .msi 檔案。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-362">If the version does not meet the application's requirement, the installation program should install the Windows Installer, then launch the .msi file.</span></span> <span data-ttu-id="1ed3f-363">此程式稱為啟動程式。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-363">This process is known as bootstrapping.</span></span> <span data-ttu-id="1ed3f-364">應用程式通常會將其啟動載入安裝程式命名為 Setup.exe。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-364">Applications typically name their bootstrapping installation program Setup.exe.</span></span> <span data-ttu-id="1ed3f-365">此範例不會處理啟動載入。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-365">The sample does not handle bootstrapping.</span></span> <span data-ttu-id="1ed3f-366">不過，您可以在 Windows Installer 中找到有關啟動載入的完整詳細資料。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-366">However, complete details on bootstrapping can be found in the Windows Installer.</span></span>

<span data-ttu-id="1ed3f-367">開發人員也應該留意遊戲中各項功能的大小。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-367">Developers should also pay attention to the size of each feature in their games.</span></span> <span data-ttu-id="1ed3f-368">當您取消正在進行的安裝時，安裝程式會將電腦還原為安裝之前的狀態。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-368">When canceling an installation in progress, the installer restores the computer to the state before the installation.</span></span> <span data-ttu-id="1ed3f-369">這表示此功能的安裝已完全復原，而且沒有部分功能安裝。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-369">This means that the installation of the feature is completely undone, and there is no partial feature installation.</span></span> <span data-ttu-id="1ed3f-370">大型功能需要較長的時間來安裝，這可能會增加安裝中斷和取消的可能性，或安裝會干擾主要應用程式。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-370">A large feature requires longer time to install, which either increases the likelihood that the install will be interrupted and cancelled or the install will interfere with the main application.</span></span> <span data-ttu-id="1ed3f-371">例如，當使用者在玩遊戲的過程中顯示遊戲功能表時，會啟用被動安裝。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-371">An example would be enabling passive installation when the user brings up the game menu in the middle of game play.</span></span> <span data-ttu-id="1ed3f-372">如果功能正在安裝，且使用者回到播放中，則遊戲可以進行下列兩項作業：讓被動安裝完成，或取消被動安裝。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-372">If a feature is installing and the user goes back to playing, the game can do one of two things: it can let the passive installation complete, or it can cancel the passive installation.</span></span> <span data-ttu-id="1ed3f-373">這兩種模型都有很大的功能。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-373">A large feature would fit poorly with either model.</span></span> <span data-ttu-id="1ed3f-374">如果遊戲讓大型安裝完成，安裝可能會妨礙遊戲的轉譯效能長時間。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-374">If the game lets the large installation complete, the installation may hinder the game's rendering performance for a long time.</span></span> <span data-ttu-id="1ed3f-375">相反地，如果遊戲取消安裝，則使用者必須長時間停留在功能表中，才能返回遊戲。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-375">Conversely, if the game cancels the installation, then the user must stay in the menu for a long time before returning to the game.</span></span> <span data-ttu-id="1ed3f-376">開發人員應該會發現最適合其個別遊戲的平衡功能大小。</span><span class="sxs-lookup"><span data-stu-id="1ed3f-376">Developers should find a balanced feature size that works best for their individual games.</span></span>

 

 