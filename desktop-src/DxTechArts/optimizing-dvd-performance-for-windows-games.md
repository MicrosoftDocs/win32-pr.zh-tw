---
title: 優化 Windows 遊戲的 DVD 效能
description: 本文討論如何將 Windows 遊戲的 DVD 效能優化。
ms.assetid: 01e8dc7d-4ba7-40dd-d845-a20000201ae1
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: fe08ba6188df9b8bbc25a73595bf1509b257696955c1fcbd1ae98091b3c8aecf
ms.sourcegitcommit: e6600f550f79bddfe58bd4696ac50dd52cb03d7e
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/11/2021
ms.locfileid: "120042531"
---
# <a name="optimizing-dvd-performance-for-windows-games"></a>優化 Windows 遊戲的 DVD 效能

執行 Windows 具有 dvd 光碟機的電腦數量過高，而許多遊戲都是在 dvd 上寄出。 如此一來，我們建議您確保遊戲使用 DVD 光碟機來享有充分優勢。 藉由瞭解如何從 DVD 讀取資料，以及資料的位置如何影響其讀取時間，您可以縮短載入時間，並改善遊戲播放期間的整體效能。 本文討論如何將 Windows 遊戲的 DVD 效能優化。

-   [DVD 的基本版面配置](#basic-layout-of-a-dvd)
-   [從 DVD 讀取](#reading-from-a-dvd)
-   [讀取錯誤](#reading-errors)
-   [資料輸送量](#data-throughput)
-   [浪費的輸送量範例](#examples-of-wasted-throughput)
-   [同步讀取與非同步讀取](#reading-synchronously-vs-asynchronously)
-   [以最佳方式讀取](#reading-optimally)
-   [DVD 相容性](#dvd-compatibility)
-   [總結](#summary)

## <a name="basic-layout-of-a-dvd"></a>DVD 的基本版面配置

下圖顯示 DVD 的基本版面配置。

![dvd 版面配置](images/dvdsector.png)

DVD 上的資料會儲存為連續的螺旋（例如 CD）;不過，這些檔案會分成區塊和磁區。 檔案會散佈在錯誤修正程式碼 (ECC) 區塊，且每個區塊會分成 16 2 KB 的磁區 (也就是每個區塊中的 32 KB 資料) 。 檔案會沿著磁區界限對齊，而磁區中任何未使用的空間則會保留空白。 如果檔案只有10個位元組，則該 2 KB 磁區中剩餘的空間將會浪費。因此，可能的話，將檔案組合成 2 KB 的增量，以取得最佳的資料密度。 請注意，這些規格僅適用于 DVD，而 CD 和 HD DVD 具有不同的規格。

## <a name="reading-from-a-dvd"></a>從 DVD 讀取

以下是 DVD 光碟機在收到從 DVD 讀取的要求時，所執行的順序：

1.  視需要變更圖層
2.  Seek
3.  將「光學取貨單位」 (OPU) 讀取資料
4.  檢查實際位置
5.  調整並重複，直到找到正確的資料

磁片磁碟機讀取作業的量化方式不同，視它們是否為邏輯磁片磁碟機讀取或實體磁片磁碟機讀取而定。 邏輯磁片磁碟機讀取只能讀取整數數量的 DVD 磁區，而實體磁片磁碟機讀取要求只能讀取整數數量的 ECC 區塊。 實體磁片磁碟機通常會收到讀取要求;它會嘗試填滿其快取。 DVD 磁片磁碟機的快取大小取決於個別磁片磁碟機的規格。

當 DVD 光碟機取得超過快取大小的讀取要求時，要求會細分為快取大小的要求。 磁片磁碟機搜尋的 ECC 區塊包含要求的第一個磁區，並讀取整個 ECC 區塊。 磁片磁碟機固件會將 ECC 區塊解碼，然後讀取下一個 ECC 區塊。 此程式會重複，直到磁片磁碟機快取填滿或完成所有要求為止。 核心接著會從磁片磁碟機快取讀取已解碼的資料。 然後，它會清除快取，並開始進行下一個讀取作業（如果有任何讀取要求）。

> [!Note]  
> 每個未快取的讀取都會清空磁片磁碟機快取。

 

## <a name="reading-errors"></a>讀取錯誤

Dvd 和 DVD 光碟機並不完美，而且可能會在閱讀期間發生錯誤。 就像 Cd 一樣，DVD 的某些部分可能會變成無法辨認的灰塵或劃痕。 如果區塊有任何部分無法讀取，則整個區塊會被視為無法讀取。 如果發生讀取錯誤，磁片磁碟機會嘗試重新讀取 ECC 區塊。 如果區塊仍無法讀取，則磁片磁碟機會中止讀取作業，並將值傳回至表示無法讀取區塊的核心。 核心接著會決定接下來要採取的步驟。 核心可以重新發出要求、完全中止讀取，或微調磁片磁碟機，然後重新發出要求。

## <a name="data-throughput"></a>資料輸送量

DVD 光碟機的資料輸送量取決於多個因素：要求的資料的位置、磁片的清除或有劃痕的位置、從磁片讀取的資料流程數目、與這些資料流程相關聯的緩衝區大小，以及個別磁片磁碟機的規格。 輸送量也取決於磁片磁碟機是否有恆定的角度速度 (CAV) 或常數線性速度 (CLV) 。 如果磁片磁碟機使用 CAV 來旋轉，則會以相同的速度旋轉光碟，而不論) 的「光學取貨單位」 (的位置。 這表示當 OPU 接近光碟的外部邊緣時，資料軌會更快地移動超過 OPU。有了 CLV，當 OPU 往外移動時，光碟的旋轉速度會變慢，因此資料軌會以持續的速度移動超過 OPU。 大部分電腦的 DVD 光碟機使用 CLV。

雖然磁片磁碟機正在搜尋和變更圖層，但無法從光碟讀取資料。最好將這些作業降至最低，特別是在讀取初始載入畫面的資料時。

## <a name="examples-of-wasted-throughput"></a>浪費的輸送量範例

若要瞭解資料輸送量可能會如何浪費，請考慮假設磁片磁碟機和 DVD。 讓我們假設必須讀取光碟中間的檔案。 光碟區的輸送量大約是 8.25 MB/秒。如果搜尋筆劃是半或三分之一的 full，則平均搜尋時間為150毫秒。 在此範例中，1.2 MB (150 ms × 8.25 MB/sec) 可能已在取得 OPU 至其可讀取的位置時讀取。 新增圖層變更會引發每秒 1.8 MB 的浪費輸送量 (225 ms × 8.25 MB/sec) 。

示範浪費的輸送量的另一個範例是從 CAV 磁片磁碟機載入20個不正確的檔案，而不會有任何層級變更。 如果每個檔案的搜尋時間加上資料可讀取之前的延遲時間大約是200毫秒，則4秒 (20 個檔案× 200 ms) 只會花在搜尋資料。 如果檔案位於外部直徑上，並以11×速度讀取，則輸送量平均每秒 15.2 MB (11 速度/12 速度× 16 MB/秒) 。 此範例中的浪費輸送量大約是 60.8 MB (15.2 MB/sec ×4秒) 。

## <a name="reading-synchronously-vs-asynchronously"></a>同步讀取與非同步讀取

非同步讀取比同步讀取更有效率。 以同步方式讀取時，系統會先將一或多個 ECC 資料區塊讀入系統記憶體中，再將其複製到應用程式記憶體中。 相反地，非同步讀取會將解碼的 ECC 區塊直接複製到應用程式記憶體，這可避免 L2 快取並產生較少的 CPU 額外負荷。 若要以非同步方式讀取， \_ \_ 使用 [**CreateFile**](/windows/desktop/api/fileapi/nf-fileapi-createfilea) 函式來開啟檔案時，請使用檔案旗標重迭旗標。 [**ReadFile**](/windows/desktop/api/fileapi/nf-fileapi-readfile)函式也需要傳入有效的重迭結構，以執行非同步 i/o。

非同步 i/o 的詳細資訊可在 [同步和非同步 i/o](/windows/desktop/FileIO/synchronous-and-asynchronous-i-o)中找到。

## <a name="reading-optimally"></a>以最佳方式讀取

從 DVD 讀取的最佳原則是避免搜尋和讀取少量的資料。 當讀取的資料量小於 ECC 區塊的容量時（小於 32 KB），區塊的其餘部分將會浪費。 由於快取大小因磁片磁碟機而異，因此開發人員必須決定讀取要求的最少資料量，而不是小於。 最小大小應為 ECC 區塊的整數倍數，以避免浪費時間來讀取和解碼未使用的資料。 也請務必避免尋求所有成本，因為任何花費在搜尋的時間是花費在不讀取資料的時間。

## <a name="dvd-compatibility"></a>DVD 相容性

在 DVD 上放開時，有一些重要的相容性問題需要注意。 首先，以 Windows 為基礎的電腦上的 dvd 光碟機可能會有不同的效能，因此，如果您的 dvd 具有特定的輸送量需求，請務必確定您的使用者硬體符合這些需求。 此外，多層 Dvd 可能會導致某些 DVD 磁片磁碟機上的相容性問題。 為了避免這些問題，建議您在發行之前，先提供一層 DVD 或徹底測試多數磁片磁碟機上的多層 DVD。

## <a name="summary"></a>摘要

若要改善 DVD 效能，可以套用一些一般規則。 下列技巧可協助您將輸送量最大化，並減少浪費的資料：

-   避免小於 32 KB 的讀取
-   配置資料以減少或消除搜尋
-   在 ECC 區塊界限上配置資料
-   將小型檔案組合成 2 KB 的區塊，並減少 DVD 磁區中的填補空間，以將容量最大化
-   以非同步方式讀取，以減少 CPU 負載和過多的記憶體使用量
-   避免釋出多層 Dvd

 

 