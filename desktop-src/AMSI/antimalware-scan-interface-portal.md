---
title: 反惡意程式碼掃描介面 (AMSI)
description: 反惡意程式碼掃描介面 (AMSI) 是一種多功能介面標準，可讓您的應用程式和服務與任何存在於電腦上的反惡意程式碼產品整合。
ms.assetid: 3b7473eb-e4a8-4280-87b7-926bd68fd645
ms.custom: 19H1
ms.topic: article
ms.date: 04/19/2019
ms.openlocfilehash: 75c29453c8f3ad54f7d1e02531827f13e6f27ff7
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 09/16/2019
ms.locfileid: "104462097"
---
# <a name="antimalware-scan-interface-amsi"></a><span data-ttu-id="f3c10-103">反惡意程式碼掃描介面 (AMSI)</span><span class="sxs-lookup"><span data-stu-id="f3c10-103">Antimalware Scan Interface (AMSI)</span></span>

## <a name="purpose"></a><span data-ttu-id="f3c10-104">目的</span><span class="sxs-lookup"><span data-stu-id="f3c10-104">Purpose</span></span>

<span data-ttu-id="f3c10-105">Windows 反惡意程式碼掃描介面 (AMSI) 是一種多功能介面標準，可讓您的應用程式和服務與任何存在於電腦上的反惡意程式碼產品整合。</span><span class="sxs-lookup"><span data-stu-id="f3c10-105">The Windows Antimalware Scan Interface (AMSI) is a versatile interface standard that allows your applications and services to integrate with any antimalware product that's present on a machine.</span></span> <span data-ttu-id="f3c10-106">AMSI 為您的終端使用者及其資料、應用程式和工作負載提供增強的惡意程式碼防護。</span><span class="sxs-lookup"><span data-stu-id="f3c10-106">AMSI provides enhanced malware protection for your end-users and their data, applications, and workloads.</span></span>

<span data-ttu-id="f3c10-107">AMSI 與反惡意程式碼廠商無關;其設計目的是為了允許現今可整合至應用程式之反惡意程式碼產品所提供的最常見惡意程式碼掃描和保護技術。</span><span class="sxs-lookup"><span data-stu-id="f3c10-107">AMSI is agnostic of antimalware vendor; it's designed to allow for the most common malware scanning and protection techniques provided by today's antimalware products that can be integrated into applications.</span></span> <span data-ttu-id="f3c10-108">它支援可進行檔案和記憶體或串流掃描、內容來源 URL/IP 信譽檢查和其他技術的呼叫結構。</span><span class="sxs-lookup"><span data-stu-id="f3c10-108">It supports a calling structure allowing for file and memory or stream scanning, content source URL/IP reputation checks, and other techniques.</span></span>

<span data-ttu-id="f3c10-109">AMSI 也支援會話的概念，讓反惡意程式碼廠商可以相互關聯不同的掃描要求。</span><span class="sxs-lookup"><span data-stu-id="f3c10-109">AMSI also supports the notion of a session so that antimalware vendors can correlate different scan requests.</span></span> <span data-ttu-id="f3c10-110">比方說，惡意承載的不同片段可以建立關聯，以達成更明智的決策，只要以隔離的方式查看這些片段，就會變得更困難。</span><span class="sxs-lookup"><span data-stu-id="f3c10-110">For instance, the different fragments of a malicious payload can be associated to reach a more informed decision, which would be much harder to reach just by looking at those fragments in isolation.</span></span>

## <a name="windows-components-that-integrate-with-amsi"></a><span data-ttu-id="f3c10-111">與 AMSI 整合的 Windows 元件</span><span class="sxs-lookup"><span data-stu-id="f3c10-111">Windows components that integrate with AMSI</span></span>

<span data-ttu-id="f3c10-112">AMSI 功能已整合至 Windows 10 的這些元件中。</span><span class="sxs-lookup"><span data-stu-id="f3c10-112">The AMSI feature is integrated into these components of Windows 10.</span></span>

- <span data-ttu-id="f3c10-113">[使用者帳戶控制] 或 [UAC (提升 EXE、COM、MSI 或 ActiveX 安裝) </span><span class="sxs-lookup"><span data-stu-id="f3c10-113">User Account Control, or UAC (elevation of EXE, COM, MSI, or ActiveX installation)</span></span>
- <span data-ttu-id="f3c10-114">PowerShell (腳本、互動式使用和動態程式碼評估) </span><span class="sxs-lookup"><span data-stu-id="f3c10-114">PowerShell (scripts, interactive use, and dynamic code evaluation)</span></span>
- <span data-ttu-id="f3c10-115">Windows Script Host (wscript.exe 和 cscript.exe) </span><span class="sxs-lookup"><span data-stu-id="f3c10-115">Windows Script Host (wscript.exe and cscript.exe)</span></span>
- <span data-ttu-id="f3c10-116">JavaScript 和 VBScript</span><span class="sxs-lookup"><span data-stu-id="f3c10-116">JavaScript and VBScript</span></span>
- <span data-ttu-id="f3c10-117">Office VBA 宏</span><span class="sxs-lookup"><span data-stu-id="f3c10-117">Office VBA macros</span></span>

## <a name="developer-audience-and-sample-code"></a><span data-ttu-id="f3c10-118">開發人員物件與範例程式碼</span><span class="sxs-lookup"><span data-stu-id="f3c10-118">Developer audience, and sample code</span></span>

<span data-ttu-id="f3c10-119">反惡意程式碼掃描介面是設計來供兩組開發人員使用。</span><span class="sxs-lookup"><span data-stu-id="f3c10-119">The Antimalware Scan Interface is designed for use by two groups of developers.</span></span>

- <span data-ttu-id="f3c10-120">想要在應用程式內對反惡意程式碼產品提出要求的應用程式開發人員。</span><span class="sxs-lookup"><span data-stu-id="f3c10-120">Application developers who want to make requests to antimalware products from within their apps.</span></span>
- <span data-ttu-id="f3c10-121">想要其產品為應用程式提供最佳功能之反惡意程式碼產品的協力廠商作者。</span><span class="sxs-lookup"><span data-stu-id="f3c10-121">Third-party creators of antimalware products who want their products to offer the best features to applications.</span></span>

<span data-ttu-id="f3c10-122">如需詳細資訊，請參閱 [開發人員物件與範例程式碼](dev-audience.md)。</span><span class="sxs-lookup"><span data-stu-id="f3c10-122">For more info, see [Developer audience, and sample code](dev-audience.md).</span></span>

> [!NOTE]
> <span data-ttu-id="f3c10-123">從 Windows 10 1903 版開始，如果您的 AMSI 提供者 DLL 不是 Authenticode 簽署的，則它可能不會根據主機電腦設定) 的方式 (載入。</span><span class="sxs-lookup"><span data-stu-id="f3c10-123">Starting in Windows 10, version 1903, if your AMSI provider DLL is not Authenticode-signed, then it may not be loaded (depending on how the host machine is configured).</span></span> <span data-ttu-id="f3c10-124">如需完整的詳細資訊，請參閱 [ **IAntimalwareProvider** 介面](/windows/desktop/api/amsi/nn-amsi-iantimalwareprovider)。</span><span class="sxs-lookup"><span data-stu-id="f3c10-124">For full details, see [**IAntimalwareProvider** interface](/windows/desktop/api/amsi/nn-amsi-iantimalwareprovider).</span></span>

## <a name="in-this-section"></a><span data-ttu-id="f3c10-125">本節內容</span><span class="sxs-lookup"><span data-stu-id="f3c10-125">In this section</span></span>

| <span data-ttu-id="f3c10-126">主題</span><span class="sxs-lookup"><span data-stu-id="f3c10-126">Topic</span></span> | <span data-ttu-id="f3c10-127">描述</span><span class="sxs-lookup"><span data-stu-id="f3c10-127">Description</span></span> |
|-|-|
| [<span data-ttu-id="f3c10-128">AMSI 如何協助您抵禦惡意軟體</span><span class="sxs-lookup"><span data-stu-id="f3c10-128">How AMSI helps you defend against malware</span></span>](how-amsi-helps.md) | <span data-ttu-id="f3c10-129">作為應用程式開發人員，您可以主動參與惡意程式碼防護。</span><span class="sxs-lookup"><span data-stu-id="f3c10-129">As an application developer, you can actively participate in malware defense.</span></span> <span data-ttu-id="f3c10-130">具體來說，您可以協助保護您的客戶免于動態的腳本式惡意程式碼，以及從網路攻擊的非傳統途徑。</span><span class="sxs-lookup"><span data-stu-id="f3c10-130">Specifically, you can help protect your customers from dynamic script-based malware, and from non-traditional avenues of cyberattack.</span></span> |
| [<span data-ttu-id="f3c10-131">開發人員物件，範例</span><span class="sxs-lookup"><span data-stu-id="f3c10-131">Developer audience, samples</span></span>](dev-audience.md) | <span data-ttu-id="f3c10-132">本主題說明為其設計反惡意程式碼掃描介面的開發人員群組。</span><span class="sxs-lookup"><span data-stu-id="f3c10-132">This topic describes the groups of developers for whom the Antimalware Scan Interface is designed.</span></span> |
| [<span data-ttu-id="f3c10-133">反惡意程式碼掃描介面參考</span><span class="sxs-lookup"><span data-stu-id="f3c10-133">Antimalware Scan Interface Reference</span></span>](antimalware-scan-interface-reference.md) | <span data-ttu-id="f3c10-134">AMSI API 的列舉、COM 介面和其他程式設計項目。</span><span class="sxs-lookup"><span data-stu-id="f3c10-134">Enumerations, COM interfaces, and other programming elements of the AMSI API.</span></span> |
