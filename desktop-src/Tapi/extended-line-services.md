---
description: 擴充行服務 (或裝置專屬的行服務) 包含 TSPI 的所有服務提供者定義延伸模組。
ms.assetid: 23519d23-27bd-422e-b3c4-00e0d0d93f9e
title: 擴充行服務
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: dbc1ce08d25633d33fd518d8686271c198ca5034
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/07/2021
ms.locfileid: "106981571"
---
# <a name="extended-line-services"></a><span data-ttu-id="d0aac-103">擴充行服務</span><span class="sxs-lookup"><span data-stu-id="d0aac-103">Extended Line Services</span></span>

<span data-ttu-id="d0aac-104">擴充行服務 (或裝置專屬的行服務) 包含 TSPI 的所有服務提供者定義延伸模組。</span><span class="sxs-lookup"><span data-stu-id="d0aac-104">Extended line services (or device-specific line services) include all service-provider defined extensions to TSPI.</span></span> <span data-ttu-id="d0aac-105">TSPI 定義了一種機制，可讓服務提供者廠商使用裝置特定的擴充功能來擴充電話語音 SPI。</span><span class="sxs-lookup"><span data-stu-id="d0aac-105">TSPI defines a mechanism that enables service-provider vendors to extend the Telephony SPI using device-specific extensions.</span></span> <span data-ttu-id="d0aac-106">TSPI 只會定義擴充機制，藉由這樣做，可存取裝置專屬的延伸模組，但是 TSPI 不會定義其行為。</span><span class="sxs-lookup"><span data-stu-id="d0aac-106">TSPI only defines the extension mechanism, and by doing so provides access to device-specific extensions, but TSPI does not define their behavior.</span></span> <span data-ttu-id="d0aac-107">行為完全由服務提供者定義。</span><span class="sxs-lookup"><span data-stu-id="d0aac-107">Behavior is completely defined by the service provider.</span></span>

<span data-ttu-id="d0aac-108">電話語音 SPI 包含純量和位旗標常數定義、資料結構、函數和回呼訊息。</span><span class="sxs-lookup"><span data-stu-id="d0aac-108">The Telephony SPI consists of scalar and bit flag constant definitions, data structures, functions, and callback messages.</span></span> <span data-ttu-id="d0aac-109">定義的程式可讓廠商擴充大部分的程式，如下所示。</span><span class="sxs-lookup"><span data-stu-id="d0aac-109">Procedures are defined that enable a vendor to extend most of these as follows.</span></span>

<span data-ttu-id="d0aac-110">針對可延伸的純量資料常數，服務提供者廠商可以在指定的範圍內定義新值。</span><span class="sxs-lookup"><span data-stu-id="d0aac-110">For extensible scalar data constants, a service-provider vendor can define new values in a specified range.</span></span> <span data-ttu-id="d0aac-111">因為大部分的資料常數都是 **DWORD**，所以通常會將0X00000000 到0x7fffffff 的範圍保留給一般未來的延伸模組，而透過0xffffffff 的0x80000000 則適用于供應商專屬的延伸模組。</span><span class="sxs-lookup"><span data-stu-id="d0aac-111">As most data constants are **DWORD** s, typically the range 0x00000000 through 0x7FFFFFFF is reserved for common future extensions, while 0x80000000 through 0xFFFFFFFF are available for vendor-specific extensions.</span></span> <span data-ttu-id="d0aac-112">假設廠商會定義值，這些值是 TSPI 所定義之資料類型的自然延伸。</span><span class="sxs-lookup"><span data-stu-id="d0aac-112">The assumption is that a vendor would define values that are natural extensions of the datatypes defined by TSPI.</span></span>

<span data-ttu-id="d0aac-113">針對可延伸位旗標資料常數，服務提供者廠商可以定義指定位的新值。</span><span class="sxs-lookup"><span data-stu-id="d0aac-113">For extensible bit flag data constants, a service-provider vendor can define new values for specified bits.</span></span> <span data-ttu-id="d0aac-114">因為大部分的位旗標常數都是 **DWORD**，所以通常會保留較低的特定數目給通用副檔名，而其餘的位則適用于供應商專屬的延伸模組。</span><span class="sxs-lookup"><span data-stu-id="d0aac-114">As most bit flag constants are **DWORD** s, typically a specific number of the lower bits are reserved for common extensions while the remaining upper bits are available for vendor-specific extensions.</span></span> <span data-ttu-id="d0aac-115">一般位旗標是從位零向上指派;廠商專屬的延伸模組應從位31下指派。</span><span class="sxs-lookup"><span data-stu-id="d0aac-115">Common bit flags are assigned from bit zero up; vendor-specific extensions should be assigned from bit 31 down.</span></span> <span data-ttu-id="d0aac-116">這可提供最大的彈性，可將位位置指派給一般擴充功能與特定廠商的延伸模組。</span><span class="sxs-lookup"><span data-stu-id="d0aac-116">This provides maximum flexibility in assigning bit positions to common extensions versus vendor-specific extensions.</span></span> <span data-ttu-id="d0aac-117">廠商預期會定義新的值，這些值是 TSPI 所定義之位旗標的自然延伸。</span><span class="sxs-lookup"><span data-stu-id="d0aac-117">A vendor is expected to define new values that are natural extensions of the bit flags defined by TSPI.</span></span>

<span data-ttu-id="d0aac-118">可擴充的資料結構具有大小可變大小的欄位，保留給裝置特定用途。</span><span class="sxs-lookup"><span data-stu-id="d0aac-118">Extensible data structures have a variably sized field that is reserved for device-specific use.</span></span> <span data-ttu-id="d0aac-119">在大小可變調整大小的情況下，服務提供者會決定資訊數量和轉譯。</span><span class="sxs-lookup"><span data-stu-id="d0aac-119">Being variably sized, the service provider decides the amount of information and the interpretation.</span></span> <span data-ttu-id="d0aac-120">定義裝置特定欄位的廠商預期會讓 TSPI 所定義之原始資料結構的自然延伸。</span><span class="sxs-lookup"><span data-stu-id="d0aac-120">A vendor that defines a device-specific field is expected to make these natural extensions of the original data structure defined by TSPI.</span></span>

<span data-ttu-id="d0aac-121">有兩個函式 [**TSPI \_ LineDevSpecific**](/windows/win32/api/tspi/nf-tspi-tspi_linedevspecific) 和 [**TSPI \_ lineDevSpecificFeature**](/windows/win32/api/tspi/nf-tspi-tspi_linedevspecificfeature)，以及四個相關的訊息、 [**行 \_ DEVSPECIFIC**](/previous-versions/windows/desktop/legacy/ms725225(v=vs.85))、 [**行 \_ CALLDEVSPECIFIC**](line-calldevspecific.md)、 [**行 \_ DEVSPECIFICFEATURE**](/previous-versions/windows/desktop/legacy/ms725227(v=vs.85))和 [**行 \_ CALLDEVSPECIFICFEATURE**](line-calldevspecificfeature.md)，提供廠商專屬的擴充機制。</span><span class="sxs-lookup"><span data-stu-id="d0aac-121">Two functions, [**TSPI\_lineDevSpecific**](/windows/win32/api/tspi/nf-tspi-tspi_linedevspecific) and [**TSPI\_lineDevSpecificFeature**](/windows/win32/api/tspi/nf-tspi-tspi_linedevspecificfeature), and four related messages, [**LINE\_DEVSPECIFIC**](/previous-versions/windows/desktop/legacy/ms725225(v=vs.85)), [**LINE\_CALLDEVSPECIFIC**](line-calldevspecific.md), [**LINE\_DEVSPECIFICFEATURE**](/previous-versions/windows/desktop/legacy/ms725227(v=vs.85)), and [**LINE\_CALLDEVSPECIFICFEATURE**](line-calldevspecificfeature.md), offer a vendor-specific extension mechanism.</span></span> <span data-ttu-id="d0aac-122">**TSPI \_ lineDevSpecific** 作業和相關行 \_ DEVSPECIFIC 和行 \_ CALLDEVSPECIFIC 訊息可讓 Tapi32.dll 用戶端應用程式存取基本或補充電話語音服務中無法使用的裝置專屬行、位址或呼叫功能。</span><span class="sxs-lookup"><span data-stu-id="d0aac-122">The **TSPI\_lineDevSpecific** operation and associated LINE\_DEVSPECIFIC and LINE\_CALLDEVSPECIFIC messages allow the Tapi32.dll client application to access device-specific line, address, or call features that are unavailable in the Basic or Supplementary Telephony services.</span></span> <span data-ttu-id="d0aac-123">[**TSPI \_ lineDevSpecific**](/windows/win32/api/tspi/nf-tspi-tspi_linedevspecific)函式的參數設定檔是泛型，因為參數的微小解釋是由 TSPI 所建立。</span><span class="sxs-lookup"><span data-stu-id="d0aac-123">The parameter profile of the [**TSPI\_lineDevSpecific**](/windows/win32/api/tspi/nf-tspi-tspi_linedevspecific) function is generic in that little interpretation of the parameters is made by TSPI.</span></span> <span data-ttu-id="d0aac-124">裝置控制碼參數具有 TSPI 定義的意義，並會在應用程式與服務提供者之間妥善轉譯。</span><span class="sxs-lookup"><span data-stu-id="d0aac-124">Device-handle parameters have TSPI-defined meanings and are translated appropriately between the application and the service provider.</span></span> <span data-ttu-id="d0aac-125">泛型參數只會透過未修改的傳遞。</span><span class="sxs-lookup"><span data-stu-id="d0aac-125">Generic parameters are simply passed through unmodified.</span></span> <span data-ttu-id="d0aac-126">泛型參數的解讀是由服務提供者所定義，而且必須由使用這些參數的任何應用程式加以瞭解。</span><span class="sxs-lookup"><span data-stu-id="d0aac-126">The interpretation of the generic parameters is defined by the service provider and must be understood by any applications that use them.</span></span> <span data-ttu-id="d0aac-127">依賴裝置專屬延伸模組的應用程式通常不會與其他服務提供者一起使用。</span><span class="sxs-lookup"><span data-stu-id="d0aac-127">An application that relies on device-specific extensions generally does not work with other service providers.</span></span> <span data-ttu-id="d0aac-128">不過，完全寫入基本和補充的電話語音服務的應用程式，應該與延伸的服務提供者一起使用。</span><span class="sxs-lookup"><span data-stu-id="d0aac-128">However, applications written entirely to the Basic and Supplementary Telephony services should work with the extended service provider.</span></span>

<span data-ttu-id="d0aac-129">裝置特定函式和訊息的 TAPI 實作為「傳遞」。</span><span class="sxs-lookup"><span data-stu-id="d0aac-129">The TAPI implementation of the device-specific functions and messages is "pass-through."</span></span> <span data-ttu-id="d0aac-130">TAPI 不會檢查或修改一般裝置特定的參數和緩衝區，但它會將應用層級的不透明控制碼值對應 (用於 TAPI 層級的) 服務提供者層級的不透明控制碼值 (用於 TSPI 層級) 。</span><span class="sxs-lookup"><span data-stu-id="d0aac-130">TAPI does not examine or modify the generic device-specific parameters and buffers, but it does map application-level opaque handle values (used at the TAPI level) to service-provider-level opaque handle values (used at the TSPI level).</span></span>

<span data-ttu-id="d0aac-131">關於控制碼轉譯，裝置專屬延伸模組的一般部分的傳遞本質有很大的結果。</span><span class="sxs-lookup"><span data-stu-id="d0aac-131">Regarding handle translation, the passthrough nature of the generic parts of device-specific extensions has an important consequence.</span></span> <span data-ttu-id="d0aac-132">服務提供者無法將 TSPI 層級所使用的控制碼與 TAPI 層級的控制碼建立關聯，除了透過預先定義的控制碼參數和欄位傳遞它們之外。</span><span class="sxs-lookup"><span data-stu-id="d0aac-132">A service provider has no way to relate the handles used at the TSPI level to those at the TAPI level except by passing them through the predefined handle parameters and fields.</span></span> <span data-ttu-id="d0aac-133">因為 TAPI 會在應用程式與服務提供者之間傳遞，所以任何放入泛型延伸區域的控制碼都會由 TAPI 轉譯。</span><span class="sxs-lookup"><span data-stu-id="d0aac-133">Any handle put into the generic extension area is untranslated by TAPI as it is passed between application and service provider.</span></span> <span data-ttu-id="d0aac-134">服務提供者延伸模組的設計工具通常應該不會定義以這種方式傳遞控制碼的延伸模組。</span><span class="sxs-lookup"><span data-stu-id="d0aac-134">The designer of a service-provider extension should generally not define extensions that pass handles in this way.</span></span>

<span data-ttu-id="d0aac-135">在定義裝置專屬的延伸模組時，若未使用控制碼而必須參考特定裝置，則適當的方法是使用其絕對裝置識別來參考這些裝置。</span><span class="sxs-lookup"><span data-stu-id="d0aac-135">The appropriate approach when defining a device-specific extension that must refer to specific devices without using handles is to refer to them using their absolute device identification.</span></span> <span data-ttu-id="d0aac-136">例如，用來在 TAPI 層級開啟線路的裝置識別碼，與 TSPI 層級上用來開啟該行的值完全相同。</span><span class="sxs-lookup"><span data-stu-id="d0aac-136">The device identifier used in opening a line at the TAPI level, for example, is strictly the same value that is used at the TSPI level to open the line.</span></span> <span data-ttu-id="d0aac-137">同樣地， (行裝置識別碼、位址識別碼) 可唯一識別 TAPI 層級位址的元組，會使用相同的值來識別 TSPI 層級的相同內容。</span><span class="sxs-lookup"><span data-stu-id="d0aac-137">Similarly, a (line device identifier, address identifier) tuple that uniquely identifies an address at the TAPI level uses the same values to identify the same thing at the TSPI level.</span></span>

<span data-ttu-id="d0aac-138">為了方便起見，也提供更特製化的 escape 函數。</span><span class="sxs-lookup"><span data-stu-id="d0aac-138">For convenience, a more specialized escape function is also provided.</span></span> <span data-ttu-id="d0aac-139">它類似于 [**TSPI \_ lineDevSpecific**](/windows/win32/api/tspi/nf-tspi-tspi_linedevspecific)，但會對某些參數進行轉譯。</span><span class="sxs-lookup"><span data-stu-id="d0aac-139">It is similar to [**TSPI\_lineDevSpecific**](/windows/win32/api/tspi/nf-tspi-tspi_linedevspecific), but places interpretation on some of the parameters.</span></span> <span data-ttu-id="d0aac-140">[**TSPI \_ lineDevSpecificFeature**](/windows/win32/api/tspi/nf-tspi-tspi_linedevspecificfeature)函式和相關 [**行 \_ DEVSPECIFICFEATURE**](/previous-versions/windows/desktop/legacy/ms725227(v=vs.85))和 [**行 \_ CALLDEVSPECIFICFEATURE**](line-calldevspecificfeature.md)訊息可讓 TAPI 在行的功能電話上模擬按鈕按下。</span><span class="sxs-lookup"><span data-stu-id="d0aac-140">The [**TSPI\_lineDevSpecificFeature**](/windows/win32/api/tspi/nf-tspi-tspi_linedevspecificfeature) function and associated [**LINE\_DEVSPECIFICFEATURE**](/previous-versions/windows/desktop/legacy/ms725227(v=vs.85)) and [**LINE\_CALLDEVSPECIFICFEATURE**](line-calldevspecificfeature.md) messages allow TAPI to emulate button presses at the line's feature phone.</span></span> <span data-ttu-id="d0aac-141">因為功能電話和其按鈕的意義是廠商專屬的，使用 **TSPI \_ lineDevSpecificFeature** 的功能叫用也是特定廠商。</span><span class="sxs-lookup"><span data-stu-id="d0aac-141">As feature phones and the meanings of their buttons are vendor-specific, feature invocation using **TSPI\_lineDevSpecificFeature** is also vendor specific.</span></span>

<span data-ttu-id="d0aac-142">總而言之， [**TSPI \_ lineDevSpecificFeature**](/windows/win32/api/tspi/nf-tspi-tspi_linedevspecificfeature) 函式是裝置專屬的 escape 函式，可讓您將交換器功能傳送至交換器。</span><span class="sxs-lookup"><span data-stu-id="d0aac-142">To summarize, the [**TSPI\_lineDevSpecificFeature**](/windows/win32/api/tspi/nf-tspi-tspi_linedevspecificfeature) function is a device-specific escape function to allow sending switch features to the switch.</span></span> <span data-ttu-id="d0aac-143">[**\_ CALLDEVSPECIFICFEATURE**](line-calldevspecificfeature.md)訊息是傳送至應用程式回呼的裝置特定訊息，以指出傳送至交換器的呼叫相關功能。</span><span class="sxs-lookup"><span data-stu-id="d0aac-143">The [**LINE\_CALLDEVSPECIFICFEATURE**](line-calldevspecificfeature.md) message is a device-specific message sent to the application's callback as an indication of call-related features sent to the switch.</span></span> <span data-ttu-id="d0aac-144">[**行 \_DEVSPECIFICFEATURE**](/previous-versions/windows/desktop/legacy/ms725227(v=vs.85)) 是傳送至應用程式回呼的裝置特定訊息，表示傳送至參數的行相關功能。</span><span class="sxs-lookup"><span data-stu-id="d0aac-144">[**LINE\_DEVSPECIFICFEATURE**](/previous-versions/windows/desktop/legacy/ms725227(v=vs.85)) is a device-specific message sent to the application's callback as an indication of line-related features sent to the switch.</span></span>

<span data-ttu-id="d0aac-145">沒有適用于製造商識別碼的中央登錄。</span><span class="sxs-lookup"><span data-stu-id="d0aac-145">There is no central registry for manufacturer identifiers.</span></span> <span data-ttu-id="d0aac-146">相反地，稱為 Extidgen.exe 的唯一識別碼產生器會在 TSPI 中提供。</span><span class="sxs-lookup"><span data-stu-id="d0aac-146">Instead a unique identifier generator called Extidgen.exe is made available as part of TSPI.</span></span> <span data-ttu-id="d0aac-147">設計一組裝置專屬延伸模組的廠商會使用此公用程式來取得這些擴充功能的唯一識別碼。</span><span class="sxs-lookup"><span data-stu-id="d0aac-147">The vendor that designs a set of device-specific extensions uses this utility to obtain a unique identifier for those extensions.</span></span>

 

 
