---
description: TSPI 規格與 TAPI 2.2 (TAPI/C) 的規格密切相關。
ms.assetid: 2c51f7e3-c741-4736-9611-2327d65b427e
title: 與 TAPI 的整體比較
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: fce81d569d042cdd3eeb87088b1b7027858ca806
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/08/2021
ms.locfileid: "106989434"
---
# <a name="overall-comparison-with-tapi"></a><span data-ttu-id="605ac-103">與 TAPI 的整體比較</span><span class="sxs-lookup"><span data-stu-id="605ac-103">Overall Comparison with TAPI</span></span>

<span data-ttu-id="605ac-104">TSPI 規格與 TAPI 2.2 (TAPI/C) 的規格密切相關。</span><span class="sxs-lookup"><span data-stu-id="605ac-104">The TSPI specification is very closely related to the specifications for TAPI 2.2 (TAPI/C).</span></span> <span data-ttu-id="605ac-105">其中一個函式中的大部分函式都有相對應的函式。</span><span class="sxs-lookup"><span data-stu-id="605ac-105">Most of the functions in one have a corresponding function in the other.</span></span> <span data-ttu-id="605ac-106">一般的對應如下所示：</span><span class="sxs-lookup"><span data-stu-id="605ac-106">The usual correspondence is as follows:</span></span>

-   <span data-ttu-id="605ac-107">TSPI 函式與 TAPI 函式的名稱相同，不同之處在于它們前面加上 "**TSPI \_**"。</span><span class="sxs-lookup"><span data-stu-id="605ac-107">TSPI functions have the same names as TAPI functions except that they are prepended with "**TSPI\_**".</span></span> <span data-ttu-id="605ac-108">例如，TAPI 函式 [**lineAccept**](/windows/win32/api/tapi/nf-tapi-lineaccept) 對應至 TSPI 函數 [**TSPI \_ lineAccept**](/windows/win32/api/tspi/nf-tspi-tspi_lineaccept)。</span><span class="sxs-lookup"><span data-stu-id="605ac-108">For example, the TAPI function [**lineAccept**](/windows/win32/api/tapi/nf-tapi-lineaccept) corresponds to the TSPI function [**TSPI\_lineAccept**](/windows/win32/api/tspi/nf-tspi-tspi_lineaccept).</span></span>
-   <span data-ttu-id="605ac-109">允許非同步作業的程式會將類型 [Winspool.drv \_ REQUESTID](drv-requestid.md)的 *dwRequestID* 參數插入其第一個參數。</span><span class="sxs-lookup"><span data-stu-id="605ac-109">Procedures that allow asynchronous operation insert a *dwRequestID* parameter of type [DRV\_REQUESTID](drv-requestid.md) as their first parameter.</span></span> <span data-ttu-id="605ac-110">此參數會指定要傳回的值以表示非同步作業，並報告非同步完成。</span><span class="sxs-lookup"><span data-stu-id="605ac-110">This parameter specifies the value to be returned to indicate asynchronous operation and to report asynchronous completion.</span></span>
-   <span data-ttu-id="605ac-111">HCALL 類型的 *hCall* 參數會取代為類型 [HDRVCALL](hdrvline.md)的 *hdCall* 參數，表示服務提供者的呼叫控制碼。</span><span class="sxs-lookup"><span data-stu-id="605ac-111">*hCall* parameters of type HCALL are replaced with *hdCall* parameters of type [HDRVCALL](hdrvline.md), indicating the service provider's handle for the call.</span></span>
-   <span data-ttu-id="605ac-112">HLINE 類型的 *hLine* 參數會以-類型 [HDRVLINE](hdrvline.md)的 *hdLine* 參數取代，表示服務提供者的行控制碼。</span><span class="sxs-lookup"><span data-stu-id="605ac-112">*hLine* parameters of type HLINE are replaced with *hdLine* parameters of -type [HDRVLINE](hdrvline.md), indicating the service provider's handle for the line.</span></span>
-   <span data-ttu-id="605ac-113">HPHONE 類型的 *hPhone* 參數會取代為類型 [HDRVPHONE](hdrvphone.md)的 *hdPhone* 參數，表示服務提供者的電話控點。</span><span class="sxs-lookup"><span data-stu-id="605ac-113">*hPhone* parameters of type HPHONE are replaced with *hdPhone* parameters of type [HDRVPHONE](hdrvphone.md), indicating the service provider's handle for the phone.</span></span>
-   <span data-ttu-id="605ac-114">建立新呼叫的程式（例如 [**TSPI \_ lineMakeCall**](/windows/win32/api/tspi/nf-tspi-tspi_linemakecall)）會使用兩個參數來取代單一 *lphCall* 參數： [HTAPICALL](htapicall.md)參數的 *HTCALL* ，它會傳入用於呼叫的 TAPI 控制碼，以及 lphdCall 類型 *的 LPHDRVCALL* ，指出服務提供者必須為其撰寫其新控制碼的位置。</span><span class="sxs-lookup"><span data-stu-id="605ac-114">Procedures that create a new call, such as [**TSPI\_lineMakeCall**](/windows/win32/api/tspi/nf-tspi-tspi_linemakecall), replace a single *lphCall* parameter with two parameters: an *htCall* of type [HTAPICALL](htapicall.md) parameter that passes in the TAPI handle for the call, and an *lphdCall* of type LPHDRVCALL that indicates the location to which the service provider must write its new handle for the call.</span></span> <span data-ttu-id="605ac-115">[**TSPI \_ LineOpen**](/windows/win32/api/tspi/nf-tspi-tspi_lineopen)和 [**TSPI \_ phoneOpen**](/windows/win32/api/tspi/nf-tspi-tspi_phoneopen)中會出現類似的參數分割。</span><span class="sxs-lookup"><span data-stu-id="605ac-115">A similar split of parameters occurs in [**TSPI\_lineOpen**](/windows/win32/api/tspi/nf-tspi-tspi_lineopen) and [**TSPI\_phoneOpen**](/windows/win32/api/tspi/nf-tspi-tspi_phoneopen).</span></span>
-   <span data-ttu-id="605ac-116">在 TSPI 層級中，不會有與裝置控制碼相關聯的「許可權」概念。</span><span class="sxs-lookup"><span data-stu-id="605ac-116">At the TSPI level, there is no notion of "privilege" associated with device handles.</span></span> <span data-ttu-id="605ac-117">此外，在 API 層級，具有裝置或呼叫控制碼的每個應用程式都有不同的控制碼，但 TAPI 會將這些應用程式合併到服務提供者端的單一控制碼中。</span><span class="sxs-lookup"><span data-stu-id="605ac-117">Furthermore, at the API level, each application that has a device or call handle has a different handle, but TAPI merges these into a single handle in the service provider side.</span></span> <span data-ttu-id="605ac-118">因此，與許可權相關的錯誤碼和狀態訊息以及使用裝置的用戶端數目，都不會出現在 TSPI 層級。</span><span class="sxs-lookup"><span data-stu-id="605ac-118">As a consequence, the error codes and status messages relating to privilege and number of clients using a device do not appear at the TSPI level.</span></span>

<span data-ttu-id="605ac-119">這組 TAPI 函式不會在一組 TSPI 函式上對應到一個。</span><span class="sxs-lookup"><span data-stu-id="605ac-119">The set of TAPI functions do not map one to one onto the set of TSPI functions.</span></span> <span data-ttu-id="605ac-120">尤其是，與許可權、電話號碼轉譯和應用程式間通訊相關的函式是由 TAPI 處理，而且在 TSPI 中沒有對應的功能。</span><span class="sxs-lookup"><span data-stu-id="605ac-120">In particular, functions related to privilege, phone number translation, and interapplication communication are handled by TAPI and have no corresponding function in TSPI.</span></span> <span data-ttu-id="605ac-121">其他功能（例如用於服務提供者設定和初始化的函式）在 TAPI 中沒有對應的函式。</span><span class="sxs-lookup"><span data-stu-id="605ac-121">Other functions, such as those used for service-provider configuration and initialization, have no corresponding functions in TAPI.</span></span>

 

 
