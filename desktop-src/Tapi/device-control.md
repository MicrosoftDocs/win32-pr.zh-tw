---
description: 終端使用者或伺服器應用層級的裝置控制需要一組相當小的基本資訊。
ms.assetid: 9c787656-93ef-4e0b-9516-8822ae49a83a
title: '裝置控制 (電話語音 API) '
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 83b17336941a55a529c6b436270f7b225a1cada3
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/07/2021
ms.locfileid: "106972043"
---
# <a name="device-control-telephony-api"></a><span data-ttu-id="a7cd1-103">裝置控制 (電話語音 API) </span><span class="sxs-lookup"><span data-stu-id="a7cd1-103">Device Control (Telephony API)</span></span>

<span data-ttu-id="a7cd1-104">終端使用者或伺服器應用層級的裝置控制需要一組相當小的基本資訊。</span><span class="sxs-lookup"><span data-stu-id="a7cd1-104">Device control at the end-user or server application level requires a relatively small set of basic information.</span></span> <span data-ttu-id="a7cd1-105">服務提供者抽象層會執行詳細的裝置控制項。</span><span class="sxs-lookup"><span data-stu-id="a7cd1-105">The service provider abstraction layer performs detailed device control.</span></span> <span data-ttu-id="a7cd1-106">服務提供者會透過 TAPI 向應用程式報告所需的裝置資訊。</span><span class="sxs-lookup"><span data-stu-id="a7cd1-106">The service providers report required device information to an application through TAPI.</span></span>

<span data-ttu-id="a7cd1-107">主要裝置類別包括：</span><span class="sxs-lookup"><span data-stu-id="a7cd1-107">Key device categories include:</span></span>

-   <span data-ttu-id="a7cd1-108">[網路](network-ovr.md)：通訊的傳輸層。</span><span class="sxs-lookup"><span data-stu-id="a7cd1-108">[Network](network-ovr.md): The transport layer for communications.</span></span> <span data-ttu-id="a7cd1-109">從應用程式的觀點來看，網路的相關資訊通常內嵌于網址類別型，例如 LINEADDRESSTYPE \_ PHONENUMBER。</span><span class="sxs-lookup"><span data-stu-id="a7cd1-109">From an application's point of view, information about the network is typically embedded in the address type, such as LINEADDRESSTYPE\_PHONENUMBER.</span></span>
-   <span data-ttu-id="a7cd1-110">[Line](line-ovr.md)：與網路的連接。</span><span class="sxs-lookup"><span data-stu-id="a7cd1-110">[Line](line-ovr.md): A connection to a network.</span></span> <span data-ttu-id="a7cd1-111">此概念大量用於 TAPI 2.2 (TAPI/C) 內。</span><span class="sxs-lookup"><span data-stu-id="a7cd1-111">This concept is heavily used within TAPI 2.2 (TAPI/C).</span></span>
-   <span data-ttu-id="a7cd1-112">[Channel](channel-ovr.md)：線條的細分。</span><span class="sxs-lookup"><span data-stu-id="a7cd1-112">[Channel](channel-ovr.md): A subdivision of a line.</span></span> <span data-ttu-id="a7cd1-113">應用程式通常不需要使用通道的知識，因為服務提供者會設定其顯示為位址的方式。</span><span class="sxs-lookup"><span data-stu-id="a7cd1-113">Knowledge of channels is normally not required of an application because the service provider configures how they will appear as addresses.</span></span>
-   <span data-ttu-id="a7cd1-114">[位址](address-ovr.md)：網路上的網路位置。</span><span class="sxs-lookup"><span data-stu-id="a7cd1-114">[Address](address-ovr.md): A network location on a network.</span></span> <span data-ttu-id="a7cd1-115">每一行或通道都有一個或多個相關聯的位址。</span><span class="sxs-lookup"><span data-stu-id="a7cd1-115">Each line or channel has one or more associated addresses.</span></span> <span data-ttu-id="a7cd1-116">此位址是 TAPI 3.1 (TAPI/COM) 和 TAPI 2.2 (TAPI/C) 的主要概念。</span><span class="sxs-lookup"><span data-stu-id="a7cd1-116">The address is a key concept in both TAPI 3.1 (TAPI/COM) and TAPI 2.2 (TAPI/C).</span></span>
-   <span data-ttu-id="a7cd1-117">[終端](terminal-ovr.md)機：特定位址和媒體類型的來源或轉譯器。</span><span class="sxs-lookup"><span data-stu-id="a7cd1-117">[Terminal](terminal-ovr.md): A source or renderer for a particular address and media type.</span></span>

<span data-ttu-id="a7cd1-118">服務提供者會將裝置特性回報給 TAPI，以回應應用程式查詢。</span><span class="sxs-lookup"><span data-stu-id="a7cd1-118">The service providers report device characteristics to TAPI in response to application queries.</span></span> <span data-ttu-id="a7cd1-119">服務提供者也會起始裝置狀態變更的報告。</span><span class="sxs-lookup"><span data-stu-id="a7cd1-119">Service providers also initiate reports on changes in device state.</span></span> <span data-ttu-id="a7cd1-120">然後，系統會根據初始化期間要求的通知，將這些變更回報給應用程式。</span><span class="sxs-lookup"><span data-stu-id="a7cd1-120">These changes are then reported to an application based on the notifications requested during initialization.</span></span>

<span data-ttu-id="a7cd1-121">基本裝置特性為：</span><span class="sxs-lookup"><span data-stu-id="a7cd1-121">Basic device characteristics are:</span></span>

-   [<span data-ttu-id="a7cd1-122">Device 類別</span><span class="sxs-lookup"><span data-stu-id="a7cd1-122">Device Class</span></span>](device-class-ovr.md)
-   [<span data-ttu-id="a7cd1-123">裝置識別碼</span><span class="sxs-lookup"><span data-stu-id="a7cd1-123">Device Identifier</span></span>](device-identifier-ovr.md)
-   [<span data-ttu-id="a7cd1-124">地址類型</span><span class="sxs-lookup"><span data-stu-id="a7cd1-124">Address Type</span></span>](address-type-ovr.md)
-   [<span data-ttu-id="a7cd1-125">位址識別碼</span><span class="sxs-lookup"><span data-stu-id="a7cd1-125">Address Identifier</span></span>](address-identifier-ovr.md)
-   [<span data-ttu-id="a7cd1-126">裝置事件</span><span class="sxs-lookup"><span data-stu-id="a7cd1-126">Device Events</span></span>](device-events-ovr.md)
-   [<span data-ttu-id="a7cd1-127">媒體類型</span><span class="sxs-lookup"><span data-stu-id="a7cd1-127">Media Type</span></span>](media-type-ovr.md)
-   [<span data-ttu-id="a7cd1-128">終端機類型</span><span class="sxs-lookup"><span data-stu-id="a7cd1-128">Terminal Type</span></span>](terminal-type-ovr.md)

<span data-ttu-id="a7cd1-129">此外，服務提供者會提供有關特定位址的容量資訊，以執行各種會話作業。</span><span class="sxs-lookup"><span data-stu-id="a7cd1-129">In addition, the service providers supply information concerning the capacity of a given address to perform various session operations.</span></span>

<span data-ttu-id="a7cd1-130">如果服務提供者支援，補充特性可能會與特定裝置產生關聯。</span><span class="sxs-lookup"><span data-stu-id="a7cd1-130">Supplemental characteristics may be associated with certain devices, if the service providers support them.</span></span> <span data-ttu-id="a7cd1-131">TAPI 2.x 應用程式會使用 [**lineGetDevCaps**](/windows/win32/api/tapi/nf-tapi-linegetdevcaps) 和 [**lineGetAddressCaps**](/windows/win32/api/tapi/nf-tapi-linegetaddresscaps) 功能來探索功能。</span><span class="sxs-lookup"><span data-stu-id="a7cd1-131">A TAPI 2.x application discovers capabilities by using the [**lineGetDevCaps**](/windows/win32/api/tapi/nf-tapi-linegetdevcaps) and [**lineGetAddressCaps**](/windows/win32/api/tapi/nf-tapi-linegetaddresscaps) functions.</span></span> <span data-ttu-id="a7cd1-132">TAPI 3.x 應用程式會針對此用途使用 [**ITAddressCapabilities**](/windows/desktop/api/tapi3if/nn-tapi3if-itaddresscapabilities) 介面。</span><span class="sxs-lookup"><span data-stu-id="a7cd1-132">TAPI 3.x applications use the [**ITAddressCapabilities**](/windows/desktop/api/tapi3if/nn-tapi3if-itaddresscapabilities) interface for this purpose.</span></span>

<span data-ttu-id="a7cd1-133">TAPI 2.x 提供一組特殊的補充作業，服務提供者可能會執行這些作業，以與手機裝置搭配使用。</span><span class="sxs-lookup"><span data-stu-id="a7cd1-133">TAPI 2.x provides a special set of supplemental operations that the service provider may implement for use with phone devices.</span></span> <span data-ttu-id="a7cd1-134">請參閱 [電話裝置](./opening-and-closing-phone-devices.md)。</span><span class="sxs-lookup"><span data-stu-id="a7cd1-134">See [Phone Devices](./opening-and-closing-phone-devices.md).</span></span>

<span data-ttu-id="a7cd1-135">擴充功能是提供者專屬的，而且不會直接由 Microsoft 電話語音 API 所涵蓋。</span><span class="sxs-lookup"><span data-stu-id="a7cd1-135">Extended capabilities are provider-specific and not directly covered by the Microsoft Telephony API.</span></span> <span data-ttu-id="a7cd1-136">請參閱 [擴充的行](./extended-line-functions.md)函式、擴充的 [電話語音功能](./extended-telephony-phone-functions.md)，或 [提供者特定的介面](provider-specific-interfaces.md)。</span><span class="sxs-lookup"><span data-stu-id="a7cd1-136">See [Extended Line Functions](./extended-line-functions.md), [Extended Telephony Phone Functions](./extended-telephony-phone-functions.md), or [Provider-Specific Interfaces](provider-specific-interfaces.md).</span></span>

<span data-ttu-id="a7cd1-137">以下是 TAPI 作業的摘要，可查詢裝置特性上的服務提供者，並提供目前狀態的資料。</span><span class="sxs-lookup"><span data-stu-id="a7cd1-137">Below is a summary of TAPI operations that query service providers on device characteristics and provide data on current state.</span></span>



| <span data-ttu-id="a7cd1-138">TAPI 2.x 函數</span><span class="sxs-lookup"><span data-stu-id="a7cd1-138">TAPI 2.x functions</span></span>                                                  | <span data-ttu-id="a7cd1-139">Description</span><span class="sxs-lookup"><span data-stu-id="a7cd1-139">Description</span></span>                                                                                                    |
|---------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="a7cd1-140">**lineGetDevCaps**</span><span class="sxs-lookup"><span data-stu-id="a7cd1-140">**lineGetDevCaps**</span></span>](/windows/win32/api/tapi/nf-tapi-linegetdevcaps)                   | <span data-ttu-id="a7cd1-141">查詢指定的線路裝置，以判斷相關位址的電話語音功能。</span><span class="sxs-lookup"><span data-stu-id="a7cd1-141">Queries a specified line device to determine the telephony capabilities of associated addresses.</span></span>               |
| [<span data-ttu-id="a7cd1-142">**lineGetAddressCaps**</span><span class="sxs-lookup"><span data-stu-id="a7cd1-142">**lineGetAddressCaps**</span></span>](/windows/win32/api/tapi/nf-tapi-linegetaddresscaps)           | <span data-ttu-id="a7cd1-143">查詢指定的線路裝置，以判斷特定位址的電話語音功能。</span><span class="sxs-lookup"><span data-stu-id="a7cd1-143">Queries a specified line device to determine the telephony capabilities of specific address.</span></span>                   |
| [<span data-ttu-id="a7cd1-144">**lineGetDevConfig**</span><span class="sxs-lookup"><span data-stu-id="a7cd1-144">**lineGetDevConfig**</span></span>](/windows/win32/api/tapi/nf-tapi-linegetdevconfig)               | <span data-ttu-id="a7cd1-145">傳回「不透明」的資料結構，此結構會儲存裝置目前的設定。</span><span class="sxs-lookup"><span data-stu-id="a7cd1-145">Returns an "opaque" data structure that stores the current configuration of a device.</span></span>                          |
| [<span data-ttu-id="a7cd1-146">**lineSetDevConfig**</span><span class="sxs-lookup"><span data-stu-id="a7cd1-146">**lineSetDevConfig**</span></span>](/windows/win32/api/tapi/nf-tapi-linesetdevconfig)               | <span data-ttu-id="a7cd1-147">還原裝置設定。</span><span class="sxs-lookup"><span data-stu-id="a7cd1-147">Restores device configuration.</span></span>                                                                                 |
| [<span data-ttu-id="a7cd1-148">**lineConfigDialog**</span><span class="sxs-lookup"><span data-stu-id="a7cd1-148">**lineConfigDialog**</span></span>](/windows/win32/api/tapi/nf-tapi-lineconfigdialog)               | <span data-ttu-id="a7cd1-149">顯示對話方塊，讓使用者能夠設定與裝置相關的參數。</span><span class="sxs-lookup"><span data-stu-id="a7cd1-149">Display a dialog box that allows the user to configure parameters related to the device.</span></span>                       |
| [<span data-ttu-id="a7cd1-150">**lineGetID**</span><span class="sxs-lookup"><span data-stu-id="a7cd1-150">**lineGetID**</span></span>](/windows/win32/api/tapi/nf-tapi-linegetid)                             | <span data-ttu-id="a7cd1-151">抓取可用於進一步 TAPI 函式呼叫或使用不同 API 的穩定裝置識別碼。</span><span class="sxs-lookup"><span data-stu-id="a7cd1-151">Retrieves a stable device identifier that can be used in further TAPI function calls, or with a different API.</span></span> |
| [<span data-ttu-id="a7cd1-152">**lineGetLineDevStatus**</span><span class="sxs-lookup"><span data-stu-id="a7cd1-152">**lineGetLineDevStatus**</span></span>](/windows/win32/api/tapi/nf-tapi-linegetlinedevstatus)       | <span data-ttu-id="a7cd1-153">查詢裝置的目前狀態，例如使用中通話的數目。</span><span class="sxs-lookup"><span data-stu-id="a7cd1-153">Queries device for current status, such as number of active calls.</span></span>                                             |
| [<span data-ttu-id="a7cd1-154">**lineSetLineDevStatus**</span><span class="sxs-lookup"><span data-stu-id="a7cd1-154">**lineSetLineDevStatus**</span></span>](/windows/win32/api/tapi/nf-tapi-linesetlinedevstatus)       | <span data-ttu-id="a7cd1-155">設定裝置狀態，例如將裝置設定為不在服務中。</span><span class="sxs-lookup"><span data-stu-id="a7cd1-155">Sets device status, such as setting a device as not in service.</span></span>                                                |
| [<span data-ttu-id="a7cd1-156">**lineGetIcon**</span><span class="sxs-lookup"><span data-stu-id="a7cd1-156">**lineGetIcon**</span></span>](/windows/win32/api/tapi/nf-tapi-linegeticon)                         | <span data-ttu-id="a7cd1-157">抓取要顯示給使用者的提供者特定圖示。</span><span class="sxs-lookup"><span data-stu-id="a7cd1-157">Retrieves provider-specific icon for display to the user.</span></span>                                                      |
| [<span data-ttu-id="a7cd1-158">**lineNegotiateExtVersion**</span><span class="sxs-lookup"><span data-stu-id="a7cd1-158">**lineNegotiateExtVersion**</span></span>](/windows/win32/api/tapi/nf-tapi-linenegotiateextversion) | <span data-ttu-id="a7cd1-159">允許應用程式與指定的線路裝置協調使用延伸模組版本。</span><span class="sxs-lookup"><span data-stu-id="a7cd1-159">Allows an application to negotiate an extension version to use with the specified line device.</span></span>                 |
| [<span data-ttu-id="a7cd1-160">**lineDevSpecific**</span><span class="sxs-lookup"><span data-stu-id="a7cd1-160">**lineDevSpecific**</span></span>](/windows/win32/api/tapi/nf-tapi-linedevspecific)                 | <span data-ttu-id="a7cd1-161">提供裝置特定功能的存取權。</span><span class="sxs-lookup"><span data-stu-id="a7cd1-161">Gives access to device-specific features.</span></span>                                                                      |
| [<span data-ttu-id="a7cd1-162">**lineDevSpecificFeature**</span><span class="sxs-lookup"><span data-stu-id="a7cd1-162">**lineDevSpecificFeature**</span></span>](/windows/win32/api/tapi/nf-tapi-linedevspecificfeature)   | <span data-ttu-id="a7cd1-163">將裝置特有的功能傳送給服務提供者。</span><span class="sxs-lookup"><span data-stu-id="a7cd1-163">Sends device-specific features to the service provider.</span></span>                                                        |



 



| <span data-ttu-id="a7cd1-164">TAPI 3.x 介面或方法</span><span class="sxs-lookup"><span data-stu-id="a7cd1-164">TAPI 3.x interfaces or methods</span></span>                                   | <span data-ttu-id="a7cd1-165">Description</span><span class="sxs-lookup"><span data-stu-id="a7cd1-165">Description</span></span>                                                                                             |
|------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="a7cd1-166">**ITAddressCapabilities**</span><span class="sxs-lookup"><span data-stu-id="a7cd1-166">**ITAddressCapabilities**</span></span>](/windows/desktop/api/tapi3if/nn-tapi3if-itaddresscapabilities)           | <span data-ttu-id="a7cd1-167">取得位址功能的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="a7cd1-167">Gets information concerning an address's capabilities.</span></span>                                                  |
| [<span data-ttu-id="a7cd1-168">**ITAMMediaFormat**</span><span class="sxs-lookup"><span data-stu-id="a7cd1-168">**ITAMMediaFormat**</span></span>](/windows/win32/api/tapi3/nn-tapi3-itammediaformat)                       | <span data-ttu-id="a7cd1-169">設定和取得 DirectShow™媒體格式。</span><span class="sxs-lookup"><span data-stu-id="a7cd1-169">Sets and gets DirectShow™ media format.</span></span>                                                                 |
| [<span data-ttu-id="a7cd1-170">**ITBasicAudioTerminal**</span><span class="sxs-lookup"><span data-stu-id="a7cd1-170">**ITBasicAudioTerminal**</span></span>](/windows/desktop/api/tapi3if/nn-tapi3if-itbasicaudioterminal)             | <span data-ttu-id="a7cd1-171">設定並取得標準音頻終端機特性，例如 volume。</span><span class="sxs-lookup"><span data-stu-id="a7cd1-171">Sets and gets standard audio terminal characteristics, such as volume.</span></span>                                  |
| [<span data-ttu-id="a7cd1-172">**ITMediaSupport**</span><span class="sxs-lookup"><span data-stu-id="a7cd1-172">**ITMediaSupport**</span></span>](/windows/desktop/api/tapi3if/nn-tapi3if-itmediasupport)                         | <span data-ttu-id="a7cd1-173">取得位址媒體支援功能的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="a7cd1-173">Gets information concerning an address's media support capabilities.</span></span>                                    |
| [<span data-ttu-id="a7cd1-174">**ITTerminal**</span><span class="sxs-lookup"><span data-stu-id="a7cd1-174">**ITTerminal**</span></span>](/windows/win32/api/tapi3if/nn-tapi3if-itterminal)                                 | <span data-ttu-id="a7cd1-175">終端物件的基底介面。</span><span class="sxs-lookup"><span data-stu-id="a7cd1-175">Base interface for the Terminal object.</span></span> <span data-ttu-id="a7cd1-176">取得支援終端機類別和媒體等資訊。</span><span class="sxs-lookup"><span data-stu-id="a7cd1-176">Obtains information such as terminal class and media supported.</span></span> |
| [<span data-ttu-id="a7cd1-177">**ITTerminalSupport**</span><span class="sxs-lookup"><span data-stu-id="a7cd1-177">**ITTerminalSupport**</span></span>](/windows/win32/api/tapi3if/nn-tapi3if-itterminalsupport)                   | <span data-ttu-id="a7cd1-178">取得可用終端機的相關資訊，並建立額外的終端機。</span><span class="sxs-lookup"><span data-stu-id="a7cd1-178">Gets information on available terminals and creates additional terminals.</span></span>                               |
| [<span data-ttu-id="a7cd1-179">提供者特定的介面</span><span class="sxs-lookup"><span data-stu-id="a7cd1-179">Provider-Specific Interfaces</span></span>](provider-specific-interfaces.md) | <span data-ttu-id="a7cd1-180">服務提供者相依。</span><span class="sxs-lookup"><span data-stu-id="a7cd1-180">Service provider dependent.</span></span>                                                                             |



 

 

 
