---
description: 當呼叫處於連接狀態時，可以透過呼叫來傳輸資料。 呼叫媒體類型會指出資料類型 (例如，其資料類型或此媒體資料流程的較高層級通訊協定) 。
ms.assetid: 3281387e-3f72-4fda-8199-b3ce6e45e910
title: 媒體監視
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: fb54989306fd80c48c0b99c9f8285a83b40bed25
ms.sourcegitcommit: c16214e53680dc71d1c07111b51f72b82a4512d8
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 03/03/2021
ms.locfileid: "106985813"
---
# <a name="media-monitoring"></a>媒體監視

當呼叫處於 *連接* 狀態時，可以透過呼叫來傳輸資料。 呼叫媒體類型會指出資料類型 (例如，其資料類型或此媒體資料流程的較高層級通訊協定) 。

TAPI 可讓應用程式提供有關通話媒體類型變更的通知。 通知會提供呼叫的新媒體類型的指示。 服務提供者會決定它要如何進行這項判斷。 例如，服務提供者可以使用媒體資料流程的信號處理來決定媒體類型，也可以依賴指派給不同媒體串流的特殊響鈴模式，或是在頻外信號通訊協定中傳遞的資訊元素上。 與媒體類型判斷的達成方式無關，應用程式只會收到關於現有呼叫的媒體類型變更。

如需詳細資訊以及目前定義之 TAPI 媒體類型或模式的清單，請參閱 [LINEMEDIAMODE \_ 常數](linemediamode--constants.md)。 服務提供者可能會針對高度特製化的裝置，執行提供者特定的媒體類型。 這些資訊會在裝置檔中找到。

TAPI 定義的媒體類型包括：

-   不明。 呼叫的媒體類型目前不是已知的，此呼叫不會分類。
-   互動式語音。 在通話上偵測到語音能源，並以應用程式端的人的互動語音通話來處理通話。
-   自動語音。 在通話中偵測到語音能源，呼叫會以語音通話的方式處理，但不會有任何人在應用程式結束時，例如透過回應機器應用程式。
-   資料數據機。 呼叫上的數據機會話。 目前的數據機通訊協定需要被呼叫的工作站起始交握。 針對傳入的資料數據機呼叫，應用程式通常不會進行正面的偵測。 服務提供者如何做出這項決定。 例如，在接聽撥入電話之後的一段時間，就可以用來做為判斷這可能是資料數據機呼叫的啟發式。
-   G3 傳真。 通話上的群組3傳真會話。
-   4代傳真。 通話上的群組4傳真會話。
-   Tdd。 通話的媒體串流會針對失聰通訊協定使用電話語音裝置。
-   數位資料。 未指定格式的數位資料流程。
-   Teletex、Videotex、電傳、Mixed。 這些會對應至相同名稱的 telematic 服務。
-   編輯器. 呼叫上的類比顯示服務介面會話。 ADSI 會使用下載至手機的英數位元資訊，以及在手機上使用軟按鈕的方式來增強語音通話。

應用程式可以使用 [**lineMonitorMedia**](/windows/desktop/api/Tapi/nf-tapi-linemonitormedia)來啟用或停用指定之呼叫的媒體監視。 應用程式會指定其有興趣監視的媒體類型，以及啟用媒體監視時，媒體類型變更的偵測會導致應用程式收到 [**行 \_ MONITORMEDIA**](line-monitormedia.md) 訊息的通知。 此訊息提供偵測到媒體類型變更的呼叫控制碼，以及新的媒體類型。

[**LineGetCallInfo**](/windows/desktop/api/Tapi/nf-tapi-linegetcallinfo)所報告之通話的媒體類型與媒體類型附隨報告是依行 \_ MONITORMEDIA 訊息來區分。 呼叫的媒體類型是由呼叫的擁有者應用程式專用的，且不會由媒體監視事件自動變更。 唯一的例外是可由 TAPI 動態連結程式庫執行的初始媒體類型判斷，以選取第一個呼叫的擁有者。 在此情況下，您可能會認為程式庫是呼叫的擁有者。

針對已開啟線路裝置的媒體類型，會執行預設媒體類型監視。 這可在根據應用程式所要求的內容將呼叫遞交給應用程式之前，先判斷撥入電話的媒體類型。 呼叫的媒體監視範圍是由呼叫的存留期所系結。 呼叫 *中斷* 連線或 *閒置* 時，呼叫上的媒體監視就會結束。

應用程式可以藉由呼叫 [**lineGetID**](/windows/desktop/api/Tapi/nf-tapi-linegetid)，取得與已開啟行相關聯之各種裝置類別的裝置識別碼。 此函式會採用行控制碼、位址或呼叫控制碼和裝置類別描述。 它會傳回與開放線路裝置、位址或呼叫相關聯之指定裝置類別之裝置的裝置識別碼。 如果裝置類別是「tapi/線路」，則會傳回線路裝置的裝置識別碼。 如果裝置類別為「mci/wave」，則會在支援的)  (傳回 mci waveaudio 裝置的裝置識別碼，以允許錄製或播放音訊的程式列上的電話。

應用程式可以使用傳回的裝置識別碼搭配對應的媒體 API 來查詢裝置的功能，並隨後開啟媒體裝置。 例如，如果您的應用程式需要使用這一行做為波形裝置，則必須先呼叫 [**waveInGetDevCaps**](/windows/win32/api/mmeapi/nf-mmeapi-waveingetdevcaps) 和/或 [**waveOutGetDevCaps**](/windows/win32/api/mmeapi/nf-mmeapi-waveoutgetdevcaps) 來判斷裝置的波形功能。 北美洲中的電話語音所支援的一般波形資料格式為8位 m-每秒8000個樣本的定律，不過 wave 設備磁碟機可以將此取樣率和 companding 轉換成其他更常見的多媒體音訊格式。

若要接著使用波形 API 來開啟音訊播放的線路裝置，應用程式會呼叫 [**waveOutOpen**](/windows/win32/api/mmeapi/nf-mmeapi-waveoutopen)。 **WaveOutOpen** 的執行是裝置專屬的，而且有各種不同的選項可供您用來執行此功能。

 

 
