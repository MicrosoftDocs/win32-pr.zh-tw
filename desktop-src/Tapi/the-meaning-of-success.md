---
description: 當者傳回成功時，函式已成功地往上以函式為基礎的 API 所定義的點。
ms.assetid: e4077d77-dee1-4f1a-a6ee-20ca2f92a1ec
title: SUCCESS 的意義
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: d183695e9dce9df88dea5fe9464f16163130cd0f
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/08/2021
ms.locfileid: "106978257"
---
# <a name="the-meaning-of-success"></a><span data-ttu-id="3f746-103">SUCCESS 的意義</span><span class="sxs-lookup"><span data-stu-id="3f746-103">The Meaning of SUCCESS</span></span>

## <a name="tapi-2x"></a><span data-ttu-id="3f746-104">TAPI 2。x</span><span class="sxs-lookup"><span data-stu-id="3f746-104">TAPI 2.x</span></span>

<span data-ttu-id="3f746-105">當作業傳回成功指示時 (同步作業的函式傳回時，或非同步地透過 [**行 \_ 回復**](./line-reply.md) 或 [**電話 \_ 回復**](./phone-reply.md) 訊息進行非同步作業) ，則會假設下列條件成立：</span><span class="sxs-lookup"><span data-stu-id="3f746-105">When an operation returns a SUCCESS indication (either synchronously upon function return for synchronous operations, or asynchronously through a [**LINE\_REPLY**](./line-reply.md) or [**PHONE\_REPLY**](./phone-reply.md) message for asynchronous operations), the following is assumed to be true:</span></span>

-   <span data-ttu-id="3f746-106">函式已成功地以函式為基礎，逐步執行 API 所定義的點。</span><span class="sxs-lookup"><span data-stu-id="3f746-106">The function has successfully progressed to a point that is defined by the API on a function-by-function basis.</span></span> <span data-ttu-id="3f746-107">到達該點之後，表示作業已完成，或處於狀態，讓獨立的狀態訊息會通知應用程式有關後續進度。</span><span class="sxs-lookup"><span data-stu-id="3f746-107">After that point has been reached, either the operation is completely finished, or it will be in a state such that independent state messages will inform the application about subsequent progress.</span></span>

    <span data-ttu-id="3f746-108">例如，服務提供者的 [**lineMakeCall**](/windows/win32/api/tapi/nf-tapi-linemakecall) 執行不會在此呼叫進入繼續通話狀態時傳回成功。</span><span class="sxs-lookup"><span data-stu-id="3f746-108">For example, a service provider's implementation of [**lineMakeCall**](/windows/win32/api/tapi/nf-tapi-linemakecall) should return SUCCESS no later than when the call enters the proceeding call state.</span></span> <span data-ttu-id="3f746-109">在理想的情況下，提供者應該儘快指出成功，例如，當通話進入撥號音通話狀態時 (是否適用) 。</span><span class="sxs-lookup"><span data-stu-id="3f746-109">Ideally, the provider should indicate SUCCESS as soon as possible, such as when the call enters the dial tone call state (if applicable).</span></span> <span data-ttu-id="3f746-110">一旦成功返回應用程式，LINE \_ CALLSTATE 訊息會通知應用程式呼叫的進度。</span><span class="sxs-lookup"><span data-stu-id="3f746-110">Once SUCCESS has been returned to the application, LINE\_CALLSTATE messages will inform the application about the progress of the call.</span></span> <span data-ttu-id="3f746-111">延遲傳回 **lineMakeCall** 成功指示的服務提供者（例如，在撥接完成之前），必須注意這會造成該提供者的缺點，因為應用層級的可用性可能會受到嚴格限制。</span><span class="sxs-lookup"><span data-stu-id="3f746-111">Service providers that delay returning the **lineMakeCall** SUCCESS indication, for example, until after dialing is complete, must be aware that this places that provider at a disadvantage because the usability at the application level may be severely limited.</span></span> <span data-ttu-id="3f746-112">例如，在撥號完成且所有數位都傳送至交換器之後，使用者將無法取消通話設定要求進行中。</span><span class="sxs-lookup"><span data-stu-id="3f746-112">For example, it would not be possible for a user to cancel the call setup request in progress until after dialing is complete and all digits had been sent to the switch.</span></span>

-   <span data-ttu-id="3f746-113">傳回信息 (的函式（例如) [**lineGetCallInfo**](/windows/win32/api/tapi/nf-tapi-linegetcallinfo) ）只有在要求的資訊可供應用程式使用時，才會傳回成功。</span><span class="sxs-lookup"><span data-stu-id="3f746-113">Functions that return information (such as [**lineGetCallInfo**](/windows/win32/api/tapi/nf-tapi-linegetcallinfo)) return SUCCESS only when the requested information is available to the application.</span></span> <span data-ttu-id="3f746-114">如果函式傳回 (行或呼叫) 的控制碼，則只有在控制碼有效之後，才能傳回 SUCCESS。</span><span class="sxs-lookup"><span data-stu-id="3f746-114">Functions that return handles (to lines or calls), can return SUCCESS only after the handle is valid.</span></span> <span data-ttu-id="3f746-115">在造成建立的函式成功指示之前，不應該傳送有關該行或呼叫的訊息。</span><span class="sxs-lookup"><span data-stu-id="3f746-115">No messages should be sent about that line or call prior to the SUCCESS indication of the function that caused its creation.</span></span> <span data-ttu-id="3f746-116">服務提供者負責隱藏這類訊息。</span><span class="sxs-lookup"><span data-stu-id="3f746-116">The service provider is responsible for suppressing such messages.</span></span>
-   <span data-ttu-id="3f746-117">啟用特定永久性條件 (例如 [**lineMonitorDigits**](/windows/win32/api/tapi/nf-tapi-linemonitordigits)) 的函式只會在啟用條件之後傳回成功，而不是在條件再次移除時 (例如，當所有數位監視都已完成) 時，不會傳回成功。</span><span class="sxs-lookup"><span data-stu-id="3f746-117">Functions that enable certain permanent conditions (such as [**lineMonitorDigits**](/windows/win32/api/tapi/nf-tapi-linemonitordigits)) return SUCCESS only after the condition is enabled, not when the condition is removed again (for example, not when all digit monitoring has completed).</span></span>
-   <span data-ttu-id="3f746-118">呼叫控制函式 (例如 [**lineHold**](/windows/win32/api/tapi/nf-tapi-linehold) 或 [**lineSetupTransfer**](/windows/win32/api/tapi/nf-tapi-linesetuptransfer)，但不是 [**lineMakeCall**](/windows/win32/api/tapi/nf-tapi-linemakecall)) 在作業完成時傳回成功。</span><span class="sxs-lookup"><span data-stu-id="3f746-118">Call-control functions (such as [**lineHold**](/windows/win32/api/tapi/nf-tapi-linehold) or [**lineSetupTransfer**](/windows/win32/api/tapi/nf-tapi-linesetuptransfer), but not [**lineMakeCall**](/windows/win32/api/tapi/nf-tapi-linemakecall)) return SUCCESS when the operation is completed.</span></span> <span data-ttu-id="3f746-119">某些電話網絡不會提供通知 (正面或負面) 有關服務提供者提出的特定要求是否完成。</span><span class="sxs-lookup"><span data-stu-id="3f746-119">Some telephone networks do not provide acknowledgment (positive or negative) about the completion of certain requests made by service providers.</span></span> <span data-ttu-id="3f746-120">在這種情況下，服務提供者必須在要求成功或失敗時決定。</span><span class="sxs-lookup"><span data-stu-id="3f746-120">In such situations, the service provider must decide upon success or failure of the request.</span></span> <span data-ttu-id="3f746-121">因此，「成功」可能表示服務提供者已起始動作來滿足要求，但不一定需要其他任何動作。</span><span class="sxs-lookup"><span data-stu-id="3f746-121">Therefore, SUCCESS may indicate that the service provider has initiated actions to fulfill the request, but not necessarily anything more.</span></span> <span data-ttu-id="3f746-122">例如，提供者可能不會收到來自交換器之要求的肯定通知，雖然它已將成功訊息傳送至應用程式。</span><span class="sxs-lookup"><span data-stu-id="3f746-122">For example, the provider may receive no affirmative acknowledgment to its request from the switch, although it has already sent a success message to the application.</span></span>

## <a name="tapi-3x"></a><span data-ttu-id="3f746-123">TAPI 3。x</span><span class="sxs-lookup"><span data-stu-id="3f746-123">TAPI 3.x</span></span>

<span data-ttu-id="3f746-124">當作業傳回成功指示時 (同步作業的函式傳回時，或使用非同步作業的非同步完成回呼程式 [**非同步 \_ 完成**](/windows/win32/api/tspi/nc-tspi-async_completion) 回檔程式非同步作業) ，則會假設下列條件成立：</span><span class="sxs-lookup"><span data-stu-id="3f746-124">When an operation returns a SUCCESS indication (either synchronously upon function return for synchronous operations, or asynchronously with a call to the [**ASYNC\_COMPLETION**](/windows/win32/api/tspi/nc-tspi-async_completion) callback procedure for asynchronous operations), then the following are assumed to be true:</span></span>

-   <span data-ttu-id="3f746-125">函式已成功完成至服務提供者定義的點。</span><span class="sxs-lookup"><span data-stu-id="3f746-125">The function has successfully progressed up to a service-provider-defined point.</span></span> <span data-ttu-id="3f746-126">服務提供者會以函式為基礎來定義點。</span><span class="sxs-lookup"><span data-stu-id="3f746-126">The service provider defines the point on a function-by-function basis.</span></span> <span data-ttu-id="3f746-127">到達該點之後，表示作業已完成，或處於狀態，因此後續的獨立狀態訊息會通知應用程式進度。</span><span class="sxs-lookup"><span data-stu-id="3f746-127">After reaching that point, either the operation is completely finished, or it is in a state such that subsequent independent state messages will inform the application about progress.</span></span>
-   <span data-ttu-id="3f746-128">傳回信息 (例如 [**TSPI \_ LinePark**](/windows/win32/api/tspi/nf-tspi-tspi_linepark) 或 [**TSPI) \_ lineDevSpecific**](/windows/win32/api/tspi/nf-tspi-tspi_linedevspecific) 的函式，只有在要求的資訊可供呼叫端使用時，才會傳回成功。</span><span class="sxs-lookup"><span data-stu-id="3f746-128">Functions that return information (such as [**TSPI\_linePark**](/windows/win32/api/tspi/nf-tspi-tspi_linepark) or [**TSPI\_lineDevSpecific**](/windows/win32/api/tspi/nf-tspi-tspi_linedevspecific)) return SUCCESS only when the requested information is available to the caller.</span></span> <span data-ttu-id="3f746-129">傳回控制碼 (至開啟的行、開啟的電話或呼叫的函式，) 在函式傳回時立即傳回控制碼。</span><span class="sxs-lookup"><span data-stu-id="3f746-129">Functions that return handles (to opened lines, opened phones, or calls) return the handles immediately on function return.</span></span> <span data-ttu-id="3f746-130">服務提供者和呼叫端都必須將控制碼視為「尚未生效」，直到最終成功指示為止。</span><span class="sxs-lookup"><span data-stu-id="3f746-130">Both the service provider and the caller must treat the handles as "not yet valid" until the eventual SUCCESS indication.</span></span> <span data-ttu-id="3f746-131">服務提供者負責防止任何回呼訊息 [**LINEEVENT**](/windows/win32/api/tspi/nc-tspi-lineevent) 或 [**PHONEEVENT**](/windows/desktop/api/tspi/nc-tspi-phoneevent) 程式相關的開啟行、開啟的電話，或在成功指示之後進行呼叫。</span><span class="sxs-lookup"><span data-stu-id="3f746-131">The service provider is responsible for preventing any callback messages to the [**LINEEVENT**](/windows/win32/api/tspi/nc-tspi-lineevent) or [**PHONEEVENT**](/windows/desktop/api/tspi/nc-tspi-phoneevent) procedure about that opened line, opened phone, or call until after the SUCCESS indication.</span></span> <span data-ttu-id="3f746-132">如果最終結果為錯誤，則任何立即傳回的控制碼都會變成無效，而不會採取任何進一步的動作。</span><span class="sxs-lookup"><span data-stu-id="3f746-132">If the eventual result is an error, any handle returned immediately becomes invalid without any further action.</span></span>
-   <span data-ttu-id="3f746-133">啟用特定永久性條件的函式 (例如 [**TSPI \_ lineMonitorDigits**](/windows/win32/api/tspi/nf-tspi-tspi_linemonitordigits)) 只會在啟用條件之後傳回成功，而不是在條件再次移除時 (例如，當數位監視完成) 時，不會傳回成功。</span><span class="sxs-lookup"><span data-stu-id="3f746-133">Functions that enable certain permanent conditions (like [**TSPI\_lineMonitorDigits**](/windows/win32/api/tspi/nf-tspi-tspi_linemonitordigits)) return SUCCESS only after the condition is enabled, not when the condition is removed again (for example, not when digit monitoring is complete).</span></span>
-   <span data-ttu-id="3f746-134">呼叫控制函式 (例如 [**TSPI \_ LineHold**](/windows/win32/api/tspi/nf-tspi-tspi_linehold) 和 [**TSPI \_ lineSetupTransfer**](/windows/win32/api/tspi/nf-tspi-tspi_linesetuptransfer)，但無法 [**TSPI \_ lineMakeCall**](/windows/win32/api/tspi/nf-tspi-tspi_linemakecall)) 在作業完成時傳回成功。</span><span class="sxs-lookup"><span data-stu-id="3f746-134">Call control functions (such as [**TSPI\_lineHold**](/windows/win32/api/tspi/nf-tspi-tspi_linehold) and [**TSPI\_lineSetupTransfer**](/windows/win32/api/tspi/nf-tspi-tspi_linesetuptransfer), but not [**TSPI\_lineMakeCall**](/windows/win32/api/tspi/nf-tspi-tspi_linemakecall)) return SUCCESS when the operation is completed.</span></span> <span data-ttu-id="3f746-135">在不提供這些函式之正面通知的電話語音環境中，服務提供者會強制對函式成功或失敗做出最佳決策。</span><span class="sxs-lookup"><span data-stu-id="3f746-135">In telephony environments that do not provide positive acknowledgment of these functions, the service provider is forced to make a best-effort decision as to the success or failure of the function.</span></span>
-   <span data-ttu-id="3f746-136">服務提供者的 [**TSPI \_ lineMakeCall**](/windows/win32/api/tspi/nf-tspi-tspi_linemakecall) 執行，必須晚于呼叫進入 *繼續* 通話狀態時才會傳回成功。</span><span class="sxs-lookup"><span data-stu-id="3f746-136">A service provider's implementation of [**TSPI\_lineMakeCall**](/windows/win32/api/tspi/nf-tspi-tspi_linemakecall) must return SUCCESS no later than when the call enters the *proceeding* call state.</span></span> <span data-ttu-id="3f746-137">在理想的情況下，提供者會儘快指出成功，例如，當呼叫進入 *撥號* 程式通話狀態時 (如適用) 。</span><span class="sxs-lookup"><span data-stu-id="3f746-137">Ideally, the provider indicates SUCCESS as soon as possible, such as when the call enters the *dialtone* call state (if applicable).</span></span> <span data-ttu-id="3f746-138">當成功傳回到應用程式時， [**LINE \_ CALLSTATE**](/previous-versions/windows/desktop/legacy/ms725219(v=vs.85)) 訊息會通知呼叫端有關呼叫的進度。</span><span class="sxs-lookup"><span data-stu-id="3f746-138">When SUCCESS is returned to the application, [**LINE\_CALLSTATE**](/previous-versions/windows/desktop/legacy/ms725219(v=vs.85)) messages inform the caller about the progress of the call.</span></span> <span data-ttu-id="3f746-139">延遲傳回 **TSPI \_ lineMakeCall** 成功指示的服務提供者（例如，在撥接完成之前）會嚴重限制應用層級的彈性。</span><span class="sxs-lookup"><span data-stu-id="3f746-139">Service providers that delay returning the **TSPI\_lineMakeCall** SUCCESS indication, for example, until after dialing is complete, severely limit flexibility at the application level.</span></span> <span data-ttu-id="3f746-140">在 **TSPI \_ lineMakeCall** 中傳回成功的延遲會防止使用者取消進行中的通話設定要求，直到撥號完成，而且所有數位都會傳送至交換器。</span><span class="sxs-lookup"><span data-stu-id="3f746-140">Delay in returning SUCCESS in **TSPI\_lineMakeCall** prevents a user from canceling the call setup request in progress until after dialing is complete, and all digits are sent to the switch.</span></span>

 

 
