---
description: 媒體功能與 tapi 2.2 (TAPI/C) （而不是 TAPI 3 (COM) ）不同，主要是因為 COM API 可存取媒體服務提供者 (Msp) 。
ms.assetid: 73042eb1-b2d6-4dcb-b40e-f8f3933dcdb0
title: 媒體存取
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 5bb3fe361aab9d5b5c9897deb5ea36d6e85adcfd
ms.sourcegitcommit: c16214e53680dc71d1c07111b51f72b82a4512d8
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 03/03/2021
ms.locfileid: "104195752"
---
# <a name="media-access"></a><span data-ttu-id="7c529-103">媒體存取</span><span class="sxs-lookup"><span data-stu-id="7c529-103">Media Access</span></span>

<span data-ttu-id="7c529-104">媒體功能與 tapi 2.2 (TAPI/C) （而不是 TAPI 3 (COM) ）不同，主要是因為 COM API 可存取媒體服務提供者 (Msp) 。</span><span class="sxs-lookup"><span data-stu-id="7c529-104">Media features are different with TAPI 2.2 (TAPI/C) as opposed to TAPI 3 (COM), largely because the COM API has access to media service providers (MSPs).</span></span> <span data-ttu-id="7c529-105">如需有關 Msp 的詳細資訊，請參閱 [關於 (MSP) 的媒體服務提供者 ](./about-the-media-service-provider-msp-.md)。</span><span class="sxs-lookup"><span data-stu-id="7c529-105">For more information about MSPs, see [About The Media Service Provider (MSP)](./about-the-media-service-provider-msp-.md).</span></span> <span data-ttu-id="7c529-106">如需媒體串流作業的詳細資訊，請參閱 [媒體控制項](./device-control.md)。</span><span class="sxs-lookup"><span data-stu-id="7c529-106">For more information about media stream operations, see [Media Control](./device-control.md).</span></span>

<span data-ttu-id="7c529-107">應用程式的兩個最重要的概念是媒體類型 (或模式) 和串流。</span><span class="sxs-lookup"><span data-stu-id="7c529-107">The two most important concepts for an application are the media type (or mode) and the stream.</span></span> <span data-ttu-id="7c529-108">此類型是傳輸資料的形式。</span><span class="sxs-lookup"><span data-stu-id="7c529-108">The type is the form in which data is transmitted.</span></span> <span data-ttu-id="7c529-109">如需詳細資訊和 TAPI 定義類型的清單，請參閱 [LINEMEDIAMODE \_ 常數](linemediamode--constants.md)。</span><span class="sxs-lookup"><span data-stu-id="7c529-109">For more information and a list of TAPI-defined types, see [LINEMEDIAMODE\_ Constants](linemediamode--constants.md).</span></span> <span data-ttu-id="7c529-110">媒體資料流程是實際的資料串流。</span><span class="sxs-lookup"><span data-stu-id="7c529-110">The media stream is the actual stream of data.</span></span> <span data-ttu-id="7c529-111">MSP 可以提供直接的資料流程存取。</span><span class="sxs-lookup"><span data-stu-id="7c529-111">An MSP can provide direct access to the stream.</span></span> <span data-ttu-id="7c529-112">TAPI 2.2 應用程式有一些存取權，但主要是參考其他 Api 來執行這類控制項。</span><span class="sxs-lookup"><span data-stu-id="7c529-112">TAPI 2.2 applications have some access, but primarily reference other APIs to implement such controls.</span></span>

<span data-ttu-id="7c529-113">這些 Api 包括波形 API、通訊 API 和 Media Control 介面 (MCI) 。</span><span class="sxs-lookup"><span data-stu-id="7c529-113">These APIs include the Waveform API, the Comm API, and the Media Control Interface (MCI).</span></span> <span data-ttu-id="7c529-114">波形 API 用於多媒體程式設計，而通訊 API 是平臺軟體發展工具組 (SDK) 所提供的一組通訊功能，而 MCI 則提供用來控制媒體裝置的高階一般化介面。</span><span class="sxs-lookup"><span data-stu-id="7c529-114">The Waveform API is used for multimedia programming, the Comm API is the set of communications functions provided by the Platform Software Development Kit (SDK), and the MCI provides a high-level generalized interface for controlling media devices.</span></span>

<span data-ttu-id="7c529-115">例如，針對線路裝置，應用程式可以使用 TAPI 2.2 來建立與另一個工作站的連線。</span><span class="sxs-lookup"><span data-stu-id="7c529-115">For example, for line devices, an application can use TAPI 2.2 to establish a connection to another station.</span></span> <span data-ttu-id="7c529-116">一旦建立連線之後，應用程式就可以在相關聯的裝置上使用波形 API (或 MCI Waveaudio API) 來播放 (傳送) 和記錄 (透過連接接收) 音訊資料。</span><span class="sxs-lookup"><span data-stu-id="7c529-116">Once the connection is established, the application can then use the Waveform API (or the MCI Waveaudio API) on the associated device to play back (send) and record (receive) audio data over the connection.</span></span> <span data-ttu-id="7c529-117">同樣地，如果連線媒體資料流程來自數據機，則應用程式會使用通訊 API 的數據機設定延伸來控制媒體串流。</span><span class="sxs-lookup"><span data-stu-id="7c529-117">Similarly, if the connection media stream is from a modem, an application would use the modem configuration extensions of the Communications API to control the media stream.</span></span>

<span data-ttu-id="7c529-118">若要使用媒體串流存取線路裝置上的電話或電話來提供 TAPI 2.2，服務提供者必須同時執行電話語音 SPI 和適當的媒體串流 SPI 或裝置驅動程式介面， (的 DDI) 。</span><span class="sxs-lookup"><span data-stu-id="7c529-118">To provide TAPI 2.2 with media-stream access to either a phone or a call on a line device, the service provider must implement both the Telephony SPI and the appropriate media stream SPI or device-driver interface (DDI).</span></span> <span data-ttu-id="7c529-119">服務提供者可同時支援線路和電話。</span><span class="sxs-lookup"><span data-stu-id="7c529-119">The service provider can support lines and phones simultaneously.</span></span>

<span data-ttu-id="7c529-120">因為這些裝置類別和媒體串流作業彼此獨立運作，所以其使用方式必須在應用層級進行協調。</span><span class="sxs-lookup"><span data-stu-id="7c529-120">Because these device classes and media stream operations function independently of one another, coordination of their usage must occur at the application level.</span></span> <span data-ttu-id="7c529-121">共用呼叫和媒體串流的多個應用程式，可能需要在應用層級協調其活動，以防止 TAPI 和媒體串流 API 的使用狀況發生衝突。</span><span class="sxs-lookup"><span data-stu-id="7c529-121">Multiple applications that share calls and media streams will likely require coordination of their activities at the application level to prevent conflicting usage of TAPI and the media stream API.</span></span>

<span data-ttu-id="7c529-122">TAPI 會報告媒體資料流程類型的變更， (語音、傳真、資料數據機等) 至參與的應用程式。</span><span class="sxs-lookup"><span data-stu-id="7c529-122">TAPI reports changes in the type of media stream (voice, fax, data modem, and so on) to participating applications.</span></span> <span data-ttu-id="7c529-123">此程式有時稱為「 [*呼叫分類*](c-tapgloss.md)」。</span><span class="sxs-lookup"><span data-stu-id="7c529-123">This process is sometimes referred to as [*call classification*](c-tapgloss.md).</span></span> <span data-ttu-id="7c529-124">用來決定媒體資料流程類型的機制是服務提供者的特定機制。</span><span class="sxs-lookup"><span data-stu-id="7c529-124">The mechanism used to determine the type of media stream is specific to the service provider.</span></span> <span data-ttu-id="7c529-125">例如，服務提供者可以篩選媒體媒體類型的能源或色調的媒體串流，也可以使用特殊的鈴聲、透過網路在訊息中交換的資料，或是關於呼叫端或呼叫識別碼的知識，以做出這項決定。</span><span class="sxs-lookup"><span data-stu-id="7c529-125">For example, a service provider may filter the media stream for energy or tones that characterize the media type, or it may use distinctive ringing, data exchanged in messages over the network, or knowledge about the caller or called ID to make this determination.</span></span>

-   [<span data-ttu-id="7c529-126">呼叫監視</span><span class="sxs-lookup"><span data-stu-id="7c529-126">Call Monitoring</span></span>](call-monitoring.md)
-   <span data-ttu-id="7c529-127">[媒體控制項](/previous-versions/windows/desktop/legacy/ms736578(v=vs.85))</span><span class="sxs-lookup"><span data-stu-id="7c529-127">[Media Control](/previous-versions/windows/desktop/legacy/ms736578(v=vs.85))</span></span>
-   [<span data-ttu-id="7c529-128">數位收集</span><span class="sxs-lookup"><span data-stu-id="7c529-128">Digit Gathering</span></span>](digit-gathering.md)
-   [<span data-ttu-id="7c529-129">產生 Inband 數位和音調</span><span class="sxs-lookup"><span data-stu-id="7c529-129">Generating Inband Digits and Tones</span></span>](generating-inband-digits-and-tones.md)

 

 
