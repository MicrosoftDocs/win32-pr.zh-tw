---
description: 傳送作業可讓應用程式將目前連線的通訊會話傳送至不同的位址。
ms.assetid: b1027f09-74e1-4da8-b718-bb55a56dda1d
title: 傳送
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 724b9ade43e41ab95a5baa6dfe7d3269f4e4a174
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/08/2021
ms.locfileid: "104026795"
---
# <a name="transfer"></a><span data-ttu-id="bf392-103">傳送</span><span class="sxs-lookup"><span data-stu-id="bf392-103">Transfer</span></span>

<span data-ttu-id="bf392-104">傳送作業可讓應用程式將目前連線的通訊會話傳送至不同的位址。</span><span class="sxs-lookup"><span data-stu-id="bf392-104">The transfer operation allows an application to send a currently connected communications session to a different address.</span></span>

<span data-ttu-id="bf392-105">TAPI 提供兩種機制，可將目前的會話傳送至不同的位址。</span><span class="sxs-lookup"><span data-stu-id="bf392-105">TAPI provides two mechanisms for transferring a current session to a different address.</span></span> <span data-ttu-id="bf392-106">*密件轉移* 可讓現有的會話在一個階段傳送至指定的目的地位址。</span><span class="sxs-lookup"><span data-stu-id="bf392-106">*Blind transfer* allows an existing session to be transferred to a specified destination address in one phase.</span></span> <span data-ttu-id="bf392-107">*諮詢轉移* 除了要設定傳送的目前會話之外，還需要存在諮詢會話，然後完成轉移。</span><span class="sxs-lookup"><span data-stu-id="bf392-107">*Consultation transfer* requires the existence of a consultation session in addition to the current session to set up for the transfer, and then completion of the transfer.</span></span> <span data-ttu-id="bf392-108">這兩種類型的選擇通常是以服務提供者的功能為基礎，因為有些服務提供者不支援盲目轉移。</span><span class="sxs-lookup"><span data-stu-id="bf392-108">The choice between these two types is frequently based on service provider capabilities because some service providers do not support blind transfer.</span></span> <span data-ttu-id="bf392-109">在某些情況下，應用程式的需求可能會讓諮詢轉移成為慣用的方法，即使在可能的情況下，也可以進行轉換。</span><span class="sxs-lookup"><span data-stu-id="bf392-109">In some cases, application needs may make the consultative transfer the preferred method even where blind transfer is possible.</span></span>

<span data-ttu-id="bf392-110">在 TAPI 2 和 TAPI 3 下，轉傳送作業基本上是相同的，但諮詢轉移的模式會稍有不同。</span><span class="sxs-lookup"><span data-stu-id="bf392-110">The blind transfer operation is basically the same under TAPI 2 and TAPI 3, but consultative transfer follows slightly different patterns.</span></span>

<span data-ttu-id="bf392-111">**TAPI 2.x：** 諮詢轉移一開始會叫用 [**lineSetupTransfer**](/windows/win32/api/tapi/nf-tapi-linesetuptransfer)，這會將現有的呼叫放置在諮詢上，並將此呼叫識別為下一個傳輸完成要求的目標。</span><span class="sxs-lookup"><span data-stu-id="bf392-111">**TAPI 2.x:** Consultative transfer starts with invoking [**lineSetupTransfer**](/windows/win32/api/tapi/nf-tapi-linesetuptransfer), which places the existing call on consultation hold, and identifies this call as the target for the next transfer-completion request.</span></span> <span data-ttu-id="bf392-112">**LineSetupTransfer** 函式也會配置諮詢通話，以用來與將傳送通話的合作物件建立諮詢通話。</span><span class="sxs-lookup"><span data-stu-id="bf392-112">The **lineSetupTransfer** function also allocates a consultation call that can be used to establish the consultation call with the party to which the call will be transferred.</span></span> <span data-ttu-id="bf392-113">應用程式可以使用 [**lineDial**](/windows/win32/api/tapi/nf-tapi-linedial)) ，在諮詢 (電話上撥接目的地合作物件的延伸模組，或者可以卸載和解除配置諮詢通話，並改為使用 [**lineUnhold**](/windows/win32/api/tapi/nf-tapi-lineunhold)) 啟用現有的保留呼叫 (（如果交換器支援的話）。</span><span class="sxs-lookup"><span data-stu-id="bf392-113">The application can dial the extension of the destination party on the consultation call (using [**lineDial**](/windows/win32/api/tapi/nf-tapi-linedial)), or it can drop and deallocate the consultation call and instead activate an existing held call (using [**lineUnhold**](/windows/win32/api/tapi/nf-tapi-lineunhold)), if supported by the switch.</span></span> <span data-ttu-id="bf392-114">當初始呼叫是在諮詢上，且諮詢通話為作用中時，應用程式可以使用 [**lineSwapHold**](/windows/win32/api/tapi/nf-tapi-lineswaphold)在這些呼叫之間切換。</span><span class="sxs-lookup"><span data-stu-id="bf392-114">While the initial call is on consultation hold and the consultation call is active, the application can toggle between these calls using [**lineSwapHold**](/windows/win32/api/tapi/nf-tapi-lineswaphold).</span></span>

<span data-ttu-id="bf392-115">**TAPI 2.x：** 應用程式使用 [**lineCompleteTransfer**](/windows/win32/api/tapi/nf-tapi-linecompletetransfer)完成諮詢轉移。</span><span class="sxs-lookup"><span data-stu-id="bf392-115">**TAPI 2.x:** Applications complete the consultative transfer using [**lineCompleteTransfer**](/windows/win32/api/tapi/nf-tapi-linecompletetransfer).</span></span> <span data-ttu-id="bf392-116">這兩個呼叫都會還原為 *閒置* 狀態。</span><span class="sxs-lookup"><span data-stu-id="bf392-116">Both calls will revert to the *idle* state.</span></span>

<span data-ttu-id="bf392-117">應用程式可以使用多個 Pbx 的「單一步驟傳輸」功能 (按下按鈕來建立諮詢轉移) ，方法是在呼叫 [**lineSetupTransfer**](/windows/win32/api/tapi/nf-tapi-linesetuptransfer)時，將 *lpCallParams* 參數設定為 [LINECALLPARAMFLAGS \_ 常數](./linecallparamflags--constants.md)的 **LINECALLPARAMFLAGS \_ ONESTEPTRANSFER** 成員。</span><span class="sxs-lookup"><span data-stu-id="bf392-117">Applications can use the "one-step transfer" feature of many PBXs (a single button press to establish a consultation transfer) by setting the *lpCallParams* parameter to the **LINECALLPARAMFLAGS\_ONESTEPTRANSFER** member of the [LINECALLPARAMFLAGS\_ constants](./linecallparamflags--constants.md) when calling [**lineSetupTransfer**](/windows/win32/api/tapi/nf-tapi-linesetuptransfer).</span></span>

<span data-ttu-id="bf392-118">**TAPI 3.x：** 諮詢轉移一開始會使用 [**ITAddress：： CreateCall**](/windows/desktop/api/tapi3if/nf-tapi3if-itaddress-createcall) 來建立新目的地位址的諮詢通話。</span><span class="sxs-lookup"><span data-stu-id="bf392-118">**TAPI 3.x:** Consultative transfer starts with using [**ITAddress::CreateCall**](/windows/desktop/api/tapi3if/nf-tapi3if-itaddress-createcall) to create a consultation call to the new destination address.</span></span> <span data-ttu-id="bf392-119">接著，會使用新的諮詢呼叫物件的指標作為參數，對原始呼叫物件呼叫 [**ITBasicCallControl：： Transfer**](/windows/desktop/api/tapi3if/nf-tapi3if-itbasiccallcontrol-transfer) 。</span><span class="sxs-lookup"><span data-stu-id="bf392-119">[**ITBasicCallControl::Transfer**](/windows/desktop/api/tapi3if/nf-tapi3if-itbasiccallcontrol-transfer) is then called on the original call object using a pointer to the new consultation call object as a parameter.</span></span> <span data-ttu-id="bf392-120">在諮詢呼叫物件上呼叫 [**ITBasicCallControl：： Finish**](/windows/desktop/api/tapi3if/nf-tapi3if-itbasiccallcontrol-finish) ，然後完成轉移。</span><span class="sxs-lookup"><span data-stu-id="bf392-120">Calling [**ITBasicCallControl::Finish**](/windows/desktop/api/tapi3if/nf-tapi3if-itbasiccallcontrol-finish) on the consultation call object then completes the transfer.</span></span>

<span data-ttu-id="bf392-121">應用程式必須在成功完成傳送作業之後釋放會話資源。</span><span class="sxs-lookup"><span data-stu-id="bf392-121">The application must release session resources following the successful completion of a transfer operation.</span></span>

<span data-ttu-id="bf392-122">並非所有服務提供者都支援使用這項作業。</span><span class="sxs-lookup"><span data-stu-id="bf392-122">Not all service providers support use of this operation.</span></span>

<span data-ttu-id="bf392-123">**TAPI 2.x：** 請參閱 [**lineBlindTransfer**](/windows/win32/api/tapi/nf-tapi-lineblindtransfer)、 [**lineSetupTransfer**](/windows/win32/api/tapi/nf-tapi-linesetuptransfer)、 [**lineCompleteTransfer**](/windows/win32/api/tapi/nf-tapi-linecompletetransfer)。</span><span class="sxs-lookup"><span data-stu-id="bf392-123">**TAPI 2.x:** See [**lineBlindTransfer**](/windows/win32/api/tapi/nf-tapi-lineblindtransfer), [**lineSetupTransfer**](/windows/win32/api/tapi/nf-tapi-linesetuptransfer), [**lineCompleteTransfer**](/windows/win32/api/tapi/nf-tapi-linecompletetransfer).</span></span>

<span data-ttu-id="bf392-124">**TAPI 3.x：** 請參閱 [**ITBasicCallControl：： BlindTransfer**](/windows/desktop/api/tapi3if/nf-tapi3if-itbasiccallcontrol-blindtransfer)、 [**ITAddress：： CreateCall**](/windows/desktop/api/tapi3if/nf-tapi3if-itaddress-createcall)、 [**ITBasicCallControl：： Transfer**](/windows/desktop/api/tapi3if/nf-tapi3if-itbasiccallcontrol-transfer)、 [**ITBasicCallControl：： Finish**](/windows/desktop/api/tapi3if/nf-tapi3if-itbasiccallcontrol-finish)。</span><span class="sxs-lookup"><span data-stu-id="bf392-124">**TAPI 3.x:** See [**ITBasicCallControl::BlindTransfer**](/windows/desktop/api/tapi3if/nf-tapi3if-itbasiccallcontrol-blindtransfer), [**ITAddress::CreateCall**](/windows/desktop/api/tapi3if/nf-tapi3if-itaddress-createcall), [**ITBasicCallControl::Transfer**](/windows/desktop/api/tapi3if/nf-tapi3if-itbasiccallcontrol-transfer), [**ITBasicCallControl::Finish**](/windows/desktop/api/tapi3if/nf-tapi3if-itbasiccallcontrol-finish).</span></span>

 

 
