---
description: 服務提供者會執行詳細的電話語音裝置控制項。 電話語音服務提供者 (TSP) 提供呼叫控制和媒體服務提供者（如果有的話）提供媒體資料流程的控制權。
ms.assetid: eb63d55e-4a2b-4bc0-8001-99772f418d72
title: 服務提供者
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 424c11d5b99af7440835e8822a5631e1b36f48cb
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/08/2021
ms.locfileid: "103945489"
---
# <a name="service-providers"></a><span data-ttu-id="97460-104">服務提供者</span><span class="sxs-lookup"><span data-stu-id="97460-104">Service Providers</span></span>

<span data-ttu-id="97460-105">服務提供者會執行詳細的電話語音裝置控制項。</span><span class="sxs-lookup"><span data-stu-id="97460-105">Service providers implement detailed telephony device controls.</span></span> <span data-ttu-id="97460-106">電話語音服務提供者 (TSP) 提供呼叫控制和媒體服務提供者（如果有的話）提供媒體資料流程的控制權。</span><span class="sxs-lookup"><span data-stu-id="97460-106">A telephony service provider (TSP) provides call controls and a media service provider, if it exists, provides control over the media stream.</span></span>

<span data-ttu-id="97460-107">所有電話語音服務提供者會在 TAPISRV 程式中執行。</span><span class="sxs-lookup"><span data-stu-id="97460-107">All telephony service providers execute in the TAPISRV process.</span></span> <span data-ttu-id="97460-108">服務提供者可以視需要在 TAPISRV 內容中建立執行緒，以執行其工作，並確信任何個別應用程式的結束都不會終結其所建立的任何資源。</span><span class="sxs-lookup"><span data-stu-id="97460-108">Service providers can create threads in the TAPISRV context as needed to do their work, and be confident that none of the resources they create will be destroyed by the exit of any individual application.</span></span> <span data-ttu-id="97460-109">TAPI 伺服器會視需要將應用程式命令轉譯為一組一致的命令，稱為電話語音服務提供者介面 (TSPI) 。</span><span class="sxs-lookup"><span data-stu-id="97460-109">The TAPI Server translates application commands as needed into a consistent set of commands known as the Telephony Service Provider Interface (TSPI).</span></span>

<span data-ttu-id="97460-110">媒體服務提供者會在應用程式的進程空間中執行，讓媒體控制項有時候需要快速回應。</span><span class="sxs-lookup"><span data-stu-id="97460-110">Media service providers execute in the process space of the application, allowing for the fast response sometimes required in media controls.</span></span> <span data-ttu-id="97460-111">TAPI DLL 提供一致的遵循媒體服務提供者介面 (MSPI) 。</span><span class="sxs-lookup"><span data-stu-id="97460-111">The TAPI DLL provides for consistent adherence to the Media Service Provider Interface (MSPI).</span></span>

<span data-ttu-id="97460-112">如需服務提供者的詳細資訊，請參閱 [TAPI 服務提供者總覽](./tapi-service-provider-overview.md)。</span><span class="sxs-lookup"><span data-stu-id="97460-112">For more detailed coverage of the service providers, please see [TAPI Service Provider Overview](./tapi-service-provider-overview.md).</span></span>

<span data-ttu-id="97460-113">在電話語音服務提供者 DLL 底下，服務提供者可以使用任何系統函數或其他必要元件。</span><span class="sxs-lookup"><span data-stu-id="97460-113">Underneath the telephony service provider DLL, the service provider can use any system functions or other components necessary.</span></span> <span data-ttu-id="97460-114">這些函式包含 [**CreateFile**](/windows/desktop/api/fileapi/nf-fileapi-createfilea) 和 [**DeviceIoControl**](/windows/desktop/api/ioapiset/nf-ioapiset-deviceiocontrol)，可搭配獨立硬體廠商設計的核心模式元件和服務，以及標準裝置（例如串列和平行埠）來控制外部、本機連接的裝置。</span><span class="sxs-lookup"><span data-stu-id="97460-114">These functions include [**CreateFile**](/windows/desktop/api/fileapi/nf-fileapi-createfilea) and [**DeviceIoControl**](/windows/desktop/api/ioapiset/nf-ioapiset-deviceiocontrol), which work with independent hardware vendor-designed kernel mode components and services, as well as standard devices such as serial and parallel ports to control external, locally attached devices.</span></span> <span data-ttu-id="97460-115">它們也可以存取 (的網路服務，例如 RPC、Windows 通訊端，以及用戶端/伺服器電話語音的具名管道) 。</span><span class="sxs-lookup"><span data-stu-id="97460-115">They can also access network services (such as RPC, Windows Sockets, and Named Pipes) for client/server telephony.</span></span>

<span data-ttu-id="97460-116">TAPI 會將電話語音服務提供者的使用者介面 DLL 載入至應用程式的程式，此應用程式會叫用可顯示對話方塊 (的任何服務提供者函式，例如 [**TSPI \_ lineConfigDialog**](/windows/win32/api/tspi/nf-tspi-tspi_lineconfigdialog)) 。</span><span class="sxs-lookup"><span data-stu-id="97460-116">The Telephony service provider user interface DLL is loaded by TAPI into the process of an application that invokes any of the service provider functions that can display a dialog box (for example, [**TSPI\_lineConfigDialog**](/windows/win32/api/tspi/nf-tspi-tspi_lineconfigdialog)).</span></span> <span data-ttu-id="97460-117">如果服務提供者需要在非預期的時間顯示 UI，服務提供者也會在應用程式的進程中載入和執行其相關聯的 UI DLL。例如，若要顯示通用數據機驅動程式所顯示的 [ **交談]/[掛斷** ] 對話方塊 (UNIMODEM) 當使用 [**TSPI \_ lineMakeCall**](/windows/win32/api/tspi/nf-tspi-tspi_linemakecall) 來撥打互動式語音通話時， (通常不會被視為 UI 產生的函數) 。</span><span class="sxs-lookup"><span data-stu-id="97460-117">The service provider can also cause its associated UI DLL to be loaded and executed in the process of an application if the service provider needs to display UI at unexpected times, such as to display the **Talk/Hang-up** dialog box displayed by the Universal Modem Driver (UNIMODEM) when a data modem is used to dial an interactive voice call using [**TSPI\_lineMakeCall**](/windows/win32/api/tspi/nf-tspi-tspi_linemakecall) (not normally considered to be a UI-generating function).</span></span>

<span data-ttu-id="97460-118">Proxy 要求處理常式是一種完整的電話語音應用程式，通常會在電話語音伺服器上執行， (與電話語音服務提供者針對相關線路裝置) 執行的同一部伺服器。</span><span class="sxs-lookup"><span data-stu-id="97460-118">The proxy request handler is a full telephony application that normally executes on a telephony server (the same server on which the telephony service provider is executing for the associated line devices).</span></span> <span data-ttu-id="97460-119">此架構（而不是 WOSA 服務提供者架構）是在應用程式中比伺服器上的驅動程式更適當地執行特定服務時使用。</span><span class="sxs-lookup"><span data-stu-id="97460-119">This architecture, rather than the WOSA service provider architecture, is used when a particular service is more appropriately implemented in an application than in a driver on the server.</span></span> <span data-ttu-id="97460-120">例如，ACD 代理程式管理函數是在 proxy 要求處理常式中執行，而不是在服務提供者中。</span><span class="sxs-lookup"><span data-stu-id="97460-120">For example, the ACD Agent management functions are implemented in a proxy request handler rather than in a service provider.</span></span>

<span data-ttu-id="97460-121">適用于數據機的 UNIMODEM 驅動程式服務提供者可在 Windows Server 2003 作業系統、Windows XP、Windows 2000 和 Windows NT 上取得。</span><span class="sxs-lookup"><span data-stu-id="97460-121">The UNIMODEM driver service provider for modem control is available on Windows Server 2003 operating systems, Windows XP, Windows 2000, and Windows NT.</span></span> <span data-ttu-id="97460-122">Windows 電話語音也包含一般核心模式的電話語音服務提供者介面 (TSPI) 對應程式 KMDDSP，可讓服務提供者實作為核心模式設備磁碟機。</span><span class="sxs-lookup"><span data-stu-id="97460-122">Windows Telephony also includes a generic kernel-mode Telephony Service Provider Interface (TSPI) mapper, KMDDSP, that allows service providers to be implemented as kernel-mode device drivers.</span></span>

 

 
