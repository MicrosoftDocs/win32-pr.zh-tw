---
description: 下列清單包含所執行的 CMSPStream 方法。
ms.assetid: 184d74c7-a36e-47f5-8f11-9161cc03b627
title: CMSPStream MSPI 方法實作為
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 7f9b8e124bee945cc03f5b9dc773425c5aeff6bf
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/08/2021
ms.locfileid: "104194164"
---
# <a name="cmspstream-mspi-methods-implemented"></a><span data-ttu-id="5f59c-103">CMSPStream MSPI 方法實作為</span><span class="sxs-lookup"><span data-stu-id="5f59c-103">CMSPStream MSPI Methods Implemented</span></span>



| <span data-ttu-id="5f59c-104">CMSPStream MSPI 方法</span><span class="sxs-lookup"><span data-stu-id="5f59c-104">CMSPStream MSPI methods</span></span>                                   | <span data-ttu-id="5f59c-105">Description</span><span class="sxs-lookup"><span data-stu-id="5f59c-105">Description</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|-----------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="5f59c-106">**取得 \_ 媒體媒體**</span><span class="sxs-lookup"><span data-stu-id="5f59c-106">**get\_MediaType**</span></span>](/windows/win32/api/tapi3if/nf-tapi3if-itstream-get_mediatype)          | <span data-ttu-id="5f59c-107">取得資料流程的 [**媒體類型**](tapimediatype--constants.md)。</span><span class="sxs-lookup"><span data-stu-id="5f59c-107">Gets the stream's [**media type**](tapimediatype--constants.md).</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| [<span data-ttu-id="5f59c-108">**取得 \_ 方向**</span><span class="sxs-lookup"><span data-stu-id="5f59c-108">**get\_Direction**</span></span>](/windows/win32/api/tapi3if/nf-tapi3if-itstream-get_direction)          | <span data-ttu-id="5f59c-109">取得資料流程的 [**終端方向**](/windows/desktop/api/Tapi3if/ne-tapi3if-terminal_direction)。</span><span class="sxs-lookup"><span data-stu-id="5f59c-109">Gets the stream's [**terminal direction**](/windows/desktop/api/Tapi3if/ne-tapi3if-terminal_direction).</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| [<span data-ttu-id="5f59c-110">**SelectTerminal**</span><span class="sxs-lookup"><span data-stu-id="5f59c-110">**SelectTerminal**</span></span>](/windows/win32/api/tapi3if/nf-tapi3if-itstream-selectterminal)         | <span data-ttu-id="5f59c-111">選取 [**ITTerminal**](/windows/win32/api/tapi3if/nn-tapi3if-itterminal) 物件至資料流程。</span><span class="sxs-lookup"><span data-stu-id="5f59c-111">Selects an [**ITTerminal**](/windows/win32/api/tapi3if/nn-tapi3if-itterminal) object onto the stream.</span></span> <span data-ttu-id="5f59c-112">取得函數中的鎖定。</span><span class="sxs-lookup"><span data-stu-id="5f59c-112">Acquires the lock in the function.</span></span> <span data-ttu-id="5f59c-113">這個基類方法只知道如何維護終端機清單;衍生的類別必須覆寫這個方法，以提供額外的功能 (例如，如果在資料流程執行時選取了終端機，就會停止並重新啟動資料流程) 。</span><span class="sxs-lookup"><span data-stu-id="5f59c-113">This base class method only knows about maintaining the list of terminals; it is expected that the derived class will override this method to provide additional functionality (such as stopping and restarting the stream if a terminal is selected while the stream is running).</span></span> <span data-ttu-id="5f59c-114">基類的執行會檢查終端指標是否指向有效的記憶體、從終端機取得 [**ITTerminalControl**](/windows/desktop/api/Termmgr/nn-termmgr-itterminalcontrol) 介面、從終端機取得位址控制碼，並檢查它是否符合 MSP 的位址控制碼、檢查終端機是否已存在於資料流程的清單中、將終端機新增至串流的終端機清單，以及 AddRefs 它。</span><span class="sxs-lookup"><span data-stu-id="5f59c-114">The base class implementation checks if the terminal pointer points to valid memory, gets the [**ITTerminalControl**](/windows/desktop/api/Termmgr/nn-termmgr-itterminalcontrol) interface from the terminal, retrieves the address handle from the terminal and checks if it matches the MSP's address handle, checks if the terminal already exists in the stream's list, adds the terminal to the stream's list of terminals, and AddRefs it.</span></span> <span data-ttu-id="5f59c-115">如果有任何測試失敗，則會傳回 TAPI \_ E \_ INVALIDTERMINAL。</span><span class="sxs-lookup"><span data-stu-id="5f59c-115">If any of the tests fail, it returns TAPI\_E\_INVALIDTERMINAL.</span></span> |
| [<span data-ttu-id="5f59c-116">**UnselectTerminal**</span><span class="sxs-lookup"><span data-stu-id="5f59c-116">**UnselectTerminal**</span></span>](/windows/win32/api/tapi3if/nf-tapi3if-itstream-unselectterminal)     | <span data-ttu-id="5f59c-117">從資料流程取消將終端機取消。</span><span class="sxs-lookup"><span data-stu-id="5f59c-117">Unselects the terminal from the stream.</span></span> <span data-ttu-id="5f59c-118">取得函數中的鎖定。</span><span class="sxs-lookup"><span data-stu-id="5f59c-118">Acquires the lock in the function.</span></span> <span data-ttu-id="5f59c-119">在串流的終端機清單中尋找終端機，並將它從清單中移除，並加以釋放。</span><span class="sxs-lookup"><span data-stu-id="5f59c-119">Finds the terminal in the stream's list of terminals, removes it from the list, and releases it.</span></span> <span data-ttu-id="5f59c-120">如果找不到終端機，它會傳回 TAPI \_ E \_ INVALIDTERMINAL。</span><span class="sxs-lookup"><span data-stu-id="5f59c-120">If the terminal is not found, it returns TAPI\_E\_INVALIDTERMINAL.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| [<span data-ttu-id="5f59c-121">**EnumerateTerminals**</span><span class="sxs-lookup"><span data-stu-id="5f59c-121">**EnumerateTerminals**</span></span>](/windows/win32/api/tapi3if/nf-tapi3if-itstream-enumerateterminals) | <span data-ttu-id="5f59c-122">列舉在資料流程上選取的終端機。</span><span class="sxs-lookup"><span data-stu-id="5f59c-122">Enumerates terminals selected on the stream.</span></span> <span data-ttu-id="5f59c-123">它是終端機的快照集。</span><span class="sxs-lookup"><span data-stu-id="5f59c-123">It is a snapshot of the terminals at this point.</span></span> <span data-ttu-id="5f59c-124">取得函數中的鎖定。</span><span class="sxs-lookup"><span data-stu-id="5f59c-124">Acquires the lock in the function.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| [<span data-ttu-id="5f59c-125">**取得 \_ 終端機**</span><span class="sxs-lookup"><span data-stu-id="5f59c-125">**get\_Terminals**</span></span>](/windows/win32/api/tapi3if/nf-tapi3if-itstream-get_terminals)          | <span data-ttu-id="5f59c-126">建立與目前資料流程相關聯的終端機集合。</span><span class="sxs-lookup"><span data-stu-id="5f59c-126">Creates a collection of terminals associated with the current stream.</span></span> <span data-ttu-id="5f59c-127">提供給 Automation 用戶端應用程式，例如以 Microsoft Visual Basic 撰寫的應用程式。</span><span class="sxs-lookup"><span data-stu-id="5f59c-127">Provided for Automation client applications, such as those written in Microsoft Visual Basic.</span></span> <span data-ttu-id="5f59c-128">它是終端機的快照集。</span><span class="sxs-lookup"><span data-stu-id="5f59c-128">It is a snapshot of the terminals at this point.</span></span> <span data-ttu-id="5f59c-129">取得函數中的鎖定。</span><span class="sxs-lookup"><span data-stu-id="5f59c-129">Acquires the lock in the function.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| [<span data-ttu-id="5f59c-130">**StartStream**</span><span class="sxs-lookup"><span data-stu-id="5f59c-130">**StartStream**</span></span>](/windows/win32/api/tapi3if/nf-tapi3if-itstream-startstream)               | <span data-ttu-id="5f59c-131">啟動資料流程。</span><span class="sxs-lookup"><span data-stu-id="5f59c-131">Starts the stream.</span></span> <span data-ttu-id="5f59c-132">呼叫篩選圖形上的 **IMediaControl：： Run** 。</span><span class="sxs-lookup"><span data-stu-id="5f59c-132">Calls **IMediaControl::Run** on the filter graph.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| [<span data-ttu-id="5f59c-133">**PauseStream**</span><span class="sxs-lookup"><span data-stu-id="5f59c-133">**PauseStream**</span></span>](/windows/win32/api/tapi3if/nf-tapi3if-itstream-pausestream)               | <span data-ttu-id="5f59c-134">暫停資料流程。</span><span class="sxs-lookup"><span data-stu-id="5f59c-134">Pauses the stream.</span></span> <span data-ttu-id="5f59c-135">在篩選圖形上呼叫 **IMediaControl：:P ause** 。</span><span class="sxs-lookup"><span data-stu-id="5f59c-135">Calls **IMediaControl::Pause** on the filter graph.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| [<span data-ttu-id="5f59c-136">**StopStream**</span><span class="sxs-lookup"><span data-stu-id="5f59c-136">**StopStream**</span></span>](/windows/win32/api/tapi3if/nf-tapi3if-itstream-stopstream)                 | <span data-ttu-id="5f59c-137">停止資料流程。</span><span class="sxs-lookup"><span data-stu-id="5f59c-137">Stops the stream.</span></span> <span data-ttu-id="5f59c-138">呼叫篩選圖形上的 **IMediaControl：： Stop** 。</span><span class="sxs-lookup"><span data-stu-id="5f59c-138">Calls **IMediaControl::Stop** on the filter graph.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |



 

## <a name="related-topics"></a><span data-ttu-id="5f59c-139">相關主題</span><span class="sxs-lookup"><span data-stu-id="5f59c-139">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="5f59c-140">**CMSPStream**</span><span class="sxs-lookup"><span data-stu-id="5f59c-140">**CMSPStream**</span></span>](/windows/desktop/api/Mspstrm/nl-mspstrm-cmspstream)
</dt> </dl>

 

 
