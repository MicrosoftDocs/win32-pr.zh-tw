---
description: 事件通知是應用程式從 TAPI 和服務提供者取得資訊的主要方式。
ms.assetid: 02160f10-dc3f-484c-9cd3-bcfb07ded822
title: 事件通知
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 63aa232b0e712a76442c298ea04e24ec7671cb4a
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/07/2021
ms.locfileid: "106969353"
---
# <a name="event-notification"></a><span data-ttu-id="a2f34-103">事件通知</span><span class="sxs-lookup"><span data-stu-id="a2f34-103">Event Notification</span></span>

<span data-ttu-id="a2f34-104">事件通知是應用程式從 TAPI 和服務提供者取得資訊的主要方式。</span><span class="sxs-lookup"><span data-stu-id="a2f34-104">Event notification is the primary means by which an application gets information from TAPI and the service providers.</span></span> <span data-ttu-id="a2f34-105">這項資訊可能是應用程式所啟動之非同步作業的狀態，或可能涉及在應用程式外部啟動的進程，例如新的連入呼叫的通知。</span><span class="sxs-lookup"><span data-stu-id="a2f34-105">This information may be the status of an asynchronous operation instigated by the application or may concern a process that started outside of the application, such as notifications of new incoming calls.</span></span>

<span data-ttu-id="a2f34-106">**TAPI 2.x：** 應用程式會以下列三種方式之一來處理通知：隱藏視窗、事件控制碼或完成埠。</span><span class="sxs-lookup"><span data-stu-id="a2f34-106">**TAPI 2.x:** Applications handle notification in one of three ways: Hidden Window, Event Handle, or Completion Port.</span></span> <span data-ttu-id="a2f34-107">如需這些通知機制的詳細資訊，請參閱 [**lineInitializeEx**](/windows/win32/api/tapi/nf-tapi-lineinitializeexa)的備註一節。</span><span class="sxs-lookup"><span data-stu-id="a2f34-107">For additional information on these notification mechanisms, please see the Remarks section for [**lineInitializeEx**](/windows/win32/api/tapi/nf-tapi-lineinitializeexa).</span></span> <span data-ttu-id="a2f34-108">應用程式會在呼叫 [**lineInitializeEx**](/windows/win32/api/tapi/nf-tapi-lineinitializeexa)之前設定 [**LINEINITIALIZEEXPARAMS**](/windows/win32/api/tapi/ns-tapi-lineinitializeexparams)結構的 **>dwoptions** 成員，藉以指定機制。</span><span class="sxs-lookup"><span data-stu-id="a2f34-108">An application specifies the mechanism by setting the **dwOptions** member of the [**LINEINITIALIZEEXPARAMS**](/windows/win32/api/tapi/ns-tapi-lineinitializeexparams) structure prior to calling [**lineInitializeEx**](/windows/win32/api/tapi/nf-tapi-lineinitializeexa).</span></span>

<span data-ttu-id="a2f34-109">[**LineSetStatusMessages**](/windows/win32/api/tapi/nf-tapi-linesetstatusmessages)函式可讓應用程式指定要接收的通知訊息，以取得與指定行或其任何位址的狀態變更相關的事件。</span><span class="sxs-lookup"><span data-stu-id="a2f34-109">The [**lineSetStatusMessages**](/windows/win32/api/tapi/nf-tapi-linesetstatusmessages) function enables an application to specify which notification messages to receive for events related to status changes for the specified line or any of its addresses.</span></span>

<span data-ttu-id="a2f34-110">**TAPI 3.x：** 應用程式會使用 COM 標準可連接 [物件](../com/events-in-com-and-connectable-objects.md)來處理一般通知。</span><span class="sxs-lookup"><span data-stu-id="a2f34-110">**TAPI 3.x:** Applications handle general notification using COM standard [connectable objects](../com/events-in-com-and-connectable-objects.md).</span></span> <span data-ttu-id="a2f34-111">[**ITTAPIEventNotification**](/windows/desktop/api/Tapi3if/nn-tapi3if-ittapieventnotification) 是必須向 tapi 的容器物件註冊的輸出介面，而 [**ITTAPIEventNotification：： Event**](/windows/desktop/api/Tapi3if/nf-tapi3if-ittapieventnotification-event) 是 TAPI 呼叫來判斷應用程式回應的方法。</span><span class="sxs-lookup"><span data-stu-id="a2f34-111">[**ITTAPIEventNotification**](/windows/desktop/api/Tapi3if/nn-tapi3if-ittapieventnotification) is the outgoing interface that must be registered with TAPI's container object, and [**ITTAPIEventNotification::Event**](/windows/desktop/api/Tapi3if/nf-tapi3if-ittapieventnotification-event) is the method TAPI calls to determine the application's response.</span></span> <span data-ttu-id="a2f34-112">[**ITTAPI：:p \_ >eventfilter**](/windows/desktop/api/tapi3if/nf-tapi3if-ittapi-put_eventfilter)方法會告知 TAPI 哪些事件對應用程式感興趣。</span><span class="sxs-lookup"><span data-stu-id="a2f34-112">The [**ITTAPI::put\_EventFilter**](/windows/desktop/api/tapi3if/nf-tapi3if-ittapi-put_eventfilter) method tells TAPI which events are of interest to the application.</span></span> <span data-ttu-id="a2f34-113">如果未輸入事件篩選器，應用程式將不會收到任何事件的通知。</span><span class="sxs-lookup"><span data-stu-id="a2f34-113">If an event filter is not entered, the application will not receive notification of any events.</span></span> <span data-ttu-id="a2f34-114">[**ITTAPI：： RegisterCallNotifications**](/windows/desktop/api/tapi3if/nf-tapi3if-ittapi-registercallnotifications)方法會告知 TAPI 應用程式將處理傳入會話的媒體類型和位址。</span><span class="sxs-lookup"><span data-stu-id="a2f34-114">The [**ITTAPI::RegisterCallNotifications**](/windows/desktop/api/tapi3if/nf-tapi3if-ittapi-registercallnotifications) method tells TAPI the media types and addresses for which the application will handle incoming sessions.</span></span> <span data-ttu-id="a2f34-115">如需 TAPI 3 事件處理的詳細資訊，請參閱 [事件](events.md) 總覽或 [註冊事件](register-events.md) 程式碼範例。</span><span class="sxs-lookup"><span data-stu-id="a2f34-115">For additional information on TAPI 3 event handling, see the [Events](events.md) overview or the [Register Events](register-events.md) code example.</span></span>

<span data-ttu-id="a2f34-116">電話語音服務提供者會執行 [**TSPI \_ LineSetDefaultMediaDetection**](/windows/win32/api/tspi/nf-tspi-tspi_linesetdefaultmediadetection) 和 [**TSPI \_ lineSetStatusMessages**](/windows/win32/api/tspi/nf-tspi-tspi_linesetstatusmessages)。</span><span class="sxs-lookup"><span data-stu-id="a2f34-116">Telephony service providers implement [**TSPI\_lineSetDefaultMediaDetection**](/windows/win32/api/tspi/nf-tspi-tspi_linesetdefaultmediadetection) and [**TSPI\_lineSetStatusMessages**](/windows/win32/api/tspi/nf-tspi-tspi_linesetstatusmessages).</span></span> <span data-ttu-id="a2f34-117">TAPI 會呼叫這些函式，以指出應用程式所要求的所有線路、位址和媒體類型事件的集合。</span><span class="sxs-lookup"><span data-stu-id="a2f34-117">TAPI calls these functions to indicate the set of all line, address, and media type events requested by applications.</span></span>

 

 
