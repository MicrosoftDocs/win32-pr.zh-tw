---
description: 本節包含電話語音服務提供者介面 (TSPI) 中的訊息清單。
ms.assetid: 3d8bf980-81d6-49db-954f-af72458365dc
title: TSPI 訊息
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 5f5772a1ccb0c07f03b2a17348ecf5e4834bb97a
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/08/2021
ms.locfileid: "106978359"
---
# <a name="tspi-messages"></a><span data-ttu-id="05f64-103">TSPI 訊息</span><span class="sxs-lookup"><span data-stu-id="05f64-103">TSPI Messages</span></span>

<span data-ttu-id="05f64-104">本節包含電話語音服務提供者介面 (TSPI) 中的訊息清單。</span><span class="sxs-lookup"><span data-stu-id="05f64-104">This section contains a list of the messages in the Telephony Service Provider Interface (TSPI).</span></span> <span data-ttu-id="05f64-105">這些訊息是用來通知 TAPI 出現在服務提供者內出現的非同步事件。</span><span class="sxs-lookup"><span data-stu-id="05f64-105">These messages are used to notify TAPI of the occurrence of asynchronous events that spontaneously occur within the service provider.</span></span> <span data-ttu-id="05f64-106">服務提供者會藉由呼叫 [**LINEEVENT**](/windows/win32/api/tspi/nc-tspi-lineevent) 或 [**PHONEEVENT**](/windows/desktop/api/tspi/nc-tspi-phoneevent) 回呼函式，將這些事件傳遞至 TAPI，視服務提供者是否線上路、電話或電話裝置上報告事件而定。</span><span class="sxs-lookup"><span data-stu-id="05f64-106">The service provider passes these events to TAPI by calling a [**LINEEVENT**](/windows/win32/api/tspi/nc-tspi-lineevent) or [**PHONEEVENT**](/windows/desktop/api/tspi/nc-tspi-phoneevent) callback function, depending on whether the service provider is reporting an event on a line, call, or phone device.</span></span> <span data-ttu-id="05f64-107">使用 [**TSPI \_ lineOpen**](/windows/win32/api/tspi/nf-tspi-tspi_lineopen)函式開啟行時，會提供服務提供者給服務提供者的報告事件所發生的 **LINEEVENT** 程式。</span><span class="sxs-lookup"><span data-stu-id="05f64-107">The **LINEEVENT** procedure for reporting events occurring on a line or call is supplied to the service provider at the time the line is opened with the [**TSPI\_lineOpen**](/windows/win32/api/tspi/nf-tspi-tspi_lineopen) function.</span></span> <span data-ttu-id="05f64-108">在手機上進行報告事件的 **PHONEEVENT** 程式是由 [**TSPI \_ phoneOpen**](/windows/win32/api/tspi/nf-tspi-tspi_phoneopen) 函式提供。</span><span class="sxs-lookup"><span data-stu-id="05f64-108">The **PHONEEVENT** procedure for reporting events occurring on a phone is supplied with the [**TSPI\_phoneOpen**](/windows/win32/api/tspi/nf-tspi-tspi_phoneopen) function.</span></span>

<span data-ttu-id="05f64-109">這些自發事件是由 TAPI 要求，因為它們不是直接回應任何要求。</span><span class="sxs-lookup"><span data-stu-id="05f64-109">These spontaneous events are unsolicited by TAPI in the sense that they are not a direct response to any request.</span></span> <span data-ttu-id="05f64-110">這些事件會與報告完成 TAPI 發出要求的事件相對比。</span><span class="sxs-lookup"><span data-stu-id="05f64-110">These events contrast with those reporting completion of requests made by TAPI.</span></span> <span data-ttu-id="05f64-111">這類完成事件會透過 [**非同步 \_ 完成**](/windows/win32/api/tspi/nc-tspi-async_completion) 回呼函數報告。</span><span class="sxs-lookup"><span data-stu-id="05f64-111">Such completion events are reported through the [**ASYNC\_COMPLETION**](/windows/win32/api/tspi/nc-tspi-async_completion) callback function.</span></span>

<span data-ttu-id="05f64-112">自發事件程式的參數設定檔包含參數，這些參數會識別要向其報告事件的相關物件， (電話、行或呼叫) 。</span><span class="sxs-lookup"><span data-stu-id="05f64-112">The parameter profiles for the spontaneous event procedures include parameters that identify the relevant object for which the event is being reported (phone, line, or call).</span></span> <span data-ttu-id="05f64-113">識別的形式為不透明的控制碼，其確切的轉譯不是由 TSPI 所發行。</span><span class="sxs-lookup"><span data-stu-id="05f64-113">The identification is in the form of an opaque handle whose exact interpretation is not published by TSPI.</span></span> <span data-ttu-id="05f64-114">TAPI 會在內部判斷這些不透明的控制碼，以及它用來代表裝置的任何資料結構之間的關聯性。</span><span class="sxs-lookup"><span data-stu-id="05f64-114">TAPI internally determines the relationship between these opaque handles and whatever data structures it used to represent the devices.</span></span>

<span data-ttu-id="05f64-115">自發事件程式的參數設定檔也包含可識別訊息型別的訊息參數。</span><span class="sxs-lookup"><span data-stu-id="05f64-115">The parameter profile for spontaneous event procedures also includes a message parameter identifying the type of the message.</span></span> <span data-ttu-id="05f64-116">每個訊息類型都有對應的定義，可決定所包含的控制碼，以及其他參數和其意義。</span><span class="sxs-lookup"><span data-stu-id="05f64-116">Each message type has a corresponding definition that determines the handles that are included, along with other parameters and their meanings.</span></span> <span data-ttu-id="05f64-117">出現在 TSPI 層級的訊息與出現在 TAPI 層級的訊息之間有很強的對應關係。</span><span class="sxs-lookup"><span data-stu-id="05f64-117">There is a very strong correspondence between the messages appearing at the TSPI level and those that appear at the TAPI level.</span></span> <span data-ttu-id="05f64-118">以下是對應的一般規則：</span><span class="sxs-lookup"><span data-stu-id="05f64-118">These are the general rules of correspondence:</span></span>

-   <span data-ttu-id="05f64-119">這組訊息幾乎完全相同。</span><span class="sxs-lookup"><span data-stu-id="05f64-119">The set of messages is nearly identical.</span></span> <span data-ttu-id="05f64-120">訊息對應的位置，會在 TSPI 層級使用相同的訊息名稱和值。</span><span class="sxs-lookup"><span data-stu-id="05f64-120">Where messages correspond, the same message name and value is used at the TSPI level.</span></span>
-   <span data-ttu-id="05f64-121">在 TSPI 層級顯示的控制碼是 TSPI 規格所定義的不透明類型。</span><span class="sxs-lookup"><span data-stu-id="05f64-121">Handles appearing at the TSPI level are the opaque types defined by the TSPI specification.</span></span> <span data-ttu-id="05f64-122">這些類型 (與其轉譯) 與 TAPI 層級不同，但它們參考的裝置類別相同。</span><span class="sxs-lookup"><span data-stu-id="05f64-122">These types (and their interpretation) differ from those at the TAPI level, although they refer to the same class of device.</span></span> <span data-ttu-id="05f64-123">例如，在 TAPI 訊息包含 HLINE 控制碼的情況下，對應的 TSPI 訊息通常會包含 [**HTAPILINE**](htapiline.md) 控制碼。</span><span class="sxs-lookup"><span data-stu-id="05f64-123">For example, where a TAPI message includes an HLINE handle, the corresponding TSPI message would typically include an [**HTAPILINE**](htapiline.md) handle.</span></span>
-   <span data-ttu-id="05f64-124">沒有任何 *dwCallbackInstance* 資料會傳遞至回呼。</span><span class="sxs-lookup"><span data-stu-id="05f64-124">There is no *dwCallbackInstance* data passed to the callback.</span></span>
-   <span data-ttu-id="05f64-125">*DwParam1*、 *dwParam2* 和 *dwParam3* 參數通常與 TAPI 訊息的對應參數相同。</span><span class="sxs-lookup"><span data-stu-id="05f64-125">The *dwParam1*, *dwParam2*, and *dwParam3* parameters are usually identical to the corresponding parameters for the TAPI message.</span></span>
-   <span data-ttu-id="05f64-126">行導向和呼叫導向的訊息會傳遞至與電話導向訊息不同的回呼程式。</span><span class="sxs-lookup"><span data-stu-id="05f64-126">Line-oriented and call-oriented messages are passed to a different callback procedure than phone-oriented messages.</span></span>

<span data-ttu-id="05f64-127">針對每個訊息，此區段會列出下列專案：</span><span class="sxs-lookup"><span data-stu-id="05f64-127">For each message, this section lists the following items:</span></span>

-   <span data-ttu-id="05f64-128">訊息的用途</span><span class="sxs-lookup"><span data-stu-id="05f64-128">The purpose of the message</span></span>
-   <span data-ttu-id="05f64-129">傳遞此訊息的回呼程式</span><span class="sxs-lookup"><span data-stu-id="05f64-129">The callback procedure to which this message is passed</span></span>
-   <span data-ttu-id="05f64-130">訊息參數的描述</span><span class="sxs-lookup"><span data-stu-id="05f64-130">A description of the message parameters</span></span>
-   <span data-ttu-id="05f64-131">使用訊息的選擇性批註</span><span class="sxs-lookup"><span data-stu-id="05f64-131">Optional comments about using the message</span></span>
-   <span data-ttu-id="05f64-132">其他函式、訊息和資料結構的選擇性參考</span><span class="sxs-lookup"><span data-stu-id="05f64-132">Optional references to other functions, messages, and data structures</span></span>
-   <span data-ttu-id="05f64-133">將此訊息與 TAPI 介面比較的選擇性批註</span><span class="sxs-lookup"><span data-stu-id="05f64-133">Optional comments comparing this message to the TAPI interface</span></span>

<span data-ttu-id="05f64-134">某些訊息是用來通知 TAPI 有關物件狀態的變更。</span><span class="sxs-lookup"><span data-stu-id="05f64-134">Certain messages are used to notify TAPI about a change in an object's status.</span></span> <span data-ttu-id="05f64-135">這些訊息提供 TAPI 不透明的物件控制碼，以及指出哪些狀態專案已變更。</span><span class="sxs-lookup"><span data-stu-id="05f64-135">These messages provide the TAPI opaque object handle and an indication of which status item has changed.</span></span> <span data-ttu-id="05f64-136">TAPI 接著可以呼叫物件的適當「取得狀態」功能，以取得物件的完整狀態。</span><span class="sxs-lookup"><span data-stu-id="05f64-136">TAPI can subsequently call an appropriate "get status" function of the object to obtain the object's full status.</span></span>

<span data-ttu-id="05f64-137">當事件發生時，訊息可能會或可能不會傳送至 TAPI。</span><span class="sxs-lookup"><span data-stu-id="05f64-137">When an event occurs, a message may or may not be sent to TAPI.</span></span> <span data-ttu-id="05f64-138">針對某些事件種類（例如狀態變更），TAPI 會指定一組感興趣的狀態變更。</span><span class="sxs-lookup"><span data-stu-id="05f64-138">For some event types, such as status changes, TAPI specifies a set of status changes in which it is interested.</span></span> <span data-ttu-id="05f64-139">建議服務提供者將它報告的狀態變更訊息事件限制為包含在此集合中的事件。</span><span class="sxs-lookup"><span data-stu-id="05f64-139">The service provider is advised to limit the status-change message events it reports to those included in this set.</span></span> <span data-ttu-id="05f64-140">服務提供者不需要遵守此限制。</span><span class="sxs-lookup"><span data-stu-id="05f64-140">The service provider is not required to adhere to this limit.</span></span> <span data-ttu-id="05f64-141">換句話說，它可能會報告比絕對必要更多的變更。</span><span class="sxs-lookup"><span data-stu-id="05f64-141">In other words, it may report more changes than are strictly necessary.</span></span> <span data-ttu-id="05f64-142">不過，它應該會基於效能考慮而嘗試觀察限制。</span><span class="sxs-lookup"><span data-stu-id="05f64-142">However, it should try to observe the limit for performance reasons.</span></span>

<span data-ttu-id="05f64-143">行 \_ 回復訊息不會在 TSPI 層級使用。</span><span class="sxs-lookup"><span data-stu-id="05f64-143">The LINE\_REPLY message is not used at the TSPI level.</span></span> <span data-ttu-id="05f64-144">非同步要求的完成會使用 [**非同步 \_ 完成**](/windows/win32/api/tspi/nc-tspi-async_completion) 回呼來回報。</span><span class="sxs-lookup"><span data-stu-id="05f64-144">Completion of an asynchronous request is reported using the [**ASYNC\_COMPLETION**](/windows/win32/api/tspi/nc-tspi-async_completion) callback.</span></span>

<span data-ttu-id="05f64-145">電話 \_ 回復訊息不會在 TSPI 層級使用。</span><span class="sxs-lookup"><span data-stu-id="05f64-145">The PHONE\_REPLY message is not used at the TSPI level.</span></span> <span data-ttu-id="05f64-146">非同步要求的完成會使用 [**非同步 \_ 完成**](/windows/win32/api/tspi/nc-tspi-async_completion) 回呼來回報。</span><span class="sxs-lookup"><span data-stu-id="05f64-146">Completion of an asynchronous request is reported using the [**ASYNC\_COMPLETION**](/windows/win32/api/tspi/nc-tspi-async_completion) callback.</span></span>

<span data-ttu-id="05f64-147">如需詳細資訊，請參閱下列主題：</span><span class="sxs-lookup"><span data-stu-id="05f64-147">For more information see the following topics:</span></span>

-   [<span data-ttu-id="05f64-148">TSPI 線路裝置訊息</span><span class="sxs-lookup"><span data-stu-id="05f64-148">TSPI Line Device Messages</span></span>](tspi-line-device-messages.md)
-   [<span data-ttu-id="05f64-149">TSPI Phone 裝置訊息</span><span class="sxs-lookup"><span data-stu-id="05f64-149">TSPI Phone Device Messages</span></span>](tspi-phone-device-messages.md)

 

 
