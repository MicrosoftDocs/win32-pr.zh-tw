---
description: 應用程式可以使用六個函式來設定裝置內容的文字格式屬性： SetBkColor、SetBkMode、SetTextAlign、SetTextCharacterExtra、SetTextColor 和 SetTextJustification。
ms.assetid: fd4d81ee-7f8f-41e8-88a5-d3ed89f4c7bd
title: Text-Formatting 屬性
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 58d345bfcfe1693a7ff0b25bb323615dffe221ab
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/07/2021
ms.locfileid: "104569991"
---
# <a name="text-formatting-attributes"></a><span data-ttu-id="9545f-103">Text-Formatting 屬性</span><span class="sxs-lookup"><span data-stu-id="9545f-103">Text-Formatting Attributes</span></span>

<span data-ttu-id="9545f-104">應用程式可以使用六個函式來設定裝置內容的文字格式屬性： [SetBkColor](/windows/desktop/api/Wingdi/nf-wingdi-setbkcolor)、 [SetBkMode](/windows/desktop/api/Wingdi/nf-wingdi-setbkmode)、 [SetTextAlign](/windows/desktop/api/Wingdi/nf-wingdi-settextalign)、 [SetTextCharacterExtra](/windows/desktop/api/Wingdi/nf-wingdi-settextcharacterextra)、 [SetTextColor](/windows/desktop/api/Wingdi/nf-wingdi-settextcolor)和 [SetTextJustification](/windows/desktop/api/Wingdi/nf-wingdi-settextjustification)。</span><span class="sxs-lookup"><span data-stu-id="9545f-104">An application can use six functions to set the text-formatting attributes for a device context: [SetBkColor](/windows/desktop/api/Wingdi/nf-wingdi-setbkcolor), [SetBkMode](/windows/desktop/api/Wingdi/nf-wingdi-setbkmode), [SetTextAlign](/windows/desktop/api/Wingdi/nf-wingdi-settextalign), [SetTextCharacterExtra](/windows/desktop/api/Wingdi/nf-wingdi-settextcharacterextra), [SetTextColor](/windows/desktop/api/Wingdi/nf-wingdi-settextcolor), and [SetTextJustification](/windows/desktop/api/Wingdi/nf-wingdi-settextjustification).</span></span> <span data-ttu-id="9545f-105">這些函式會影響文字對齊、intercharacter 間距、文字對齊方式，以及文字和背景色彩。</span><span class="sxs-lookup"><span data-stu-id="9545f-105">These functions affect the text alignment, the intercharacter spacing, the text justification, and text and background colors.</span></span> <span data-ttu-id="9545f-106">此外，還有其他六個函式可用來取出任何裝置內容的目前文字格式屬性： [GetBkColor](/windows/desktop/api/Wingdi/nf-wingdi-getbkcolor)、 [GetBkMode](/windows/desktop/api/Wingdi/nf-wingdi-getbkmode)、 [GetTextAlign](/windows/desktop/api/Wingdi/nf-wingdi-gettextalign)、 [GetTextCharacterExtra](/windows/desktop/api/Wingdi/nf-wingdi-gettextcharacterextra)、 [GetTextColor](/windows/desktop/api/Wingdi/nf-wingdi-gettextcolor)和 [GetTextExtentPoint32](/windows/desktop/api/Wingdi/nf-wingdi-gettextextentpoint32a)。</span><span class="sxs-lookup"><span data-stu-id="9545f-106">In addition, six other functions can be used to retrieve the current text formatting attributes for any device context: [GetBkColor](/windows/desktop/api/Wingdi/nf-wingdi-getbkcolor), [GetBkMode](/windows/desktop/api/Wingdi/nf-wingdi-getbkmode), [GetTextAlign](/windows/desktop/api/Wingdi/nf-wingdi-gettextalign), [GetTextCharacterExtra](/windows/desktop/api/Wingdi/nf-wingdi-gettextcharacterextra), [GetTextColor](/windows/desktop/api/Wingdi/nf-wingdi-gettextcolor), and [GetTextExtentPoint32](/windows/desktop/api/Wingdi/nf-wingdi-gettextextentpoint32a).</span></span>

## <a name="text-alignment"></a><span data-ttu-id="9545f-107">文字對齊</span><span class="sxs-lookup"><span data-stu-id="9545f-107">Text Alignment</span></span>

<span data-ttu-id="9545f-108">應用程式可以使用 [SetTextAlign](/windows/desktop/api/Wingdi/nf-wingdi-settextalign) 函式來指定系統在呼叫其中一個繪圖函式時，如何將字元放在文字字串中。</span><span class="sxs-lookup"><span data-stu-id="9545f-108">Applications can use the [SetTextAlign](/windows/desktop/api/Wingdi/nf-wingdi-settextalign) function to specify how the system should position the characters in a string of text when they call one of the drawing functions.</span></span> <span data-ttu-id="9545f-109">您可以使用此函式來定位標題、頁碼、標注等等。</span><span class="sxs-lookup"><span data-stu-id="9545f-109">This function can be used to position headings, page numbers, callouts, and so on.</span></span> <span data-ttu-id="9545f-110">系統會在圍繞字串的虛數矩形上對齊參考點，並以目前的游標位置或將某個點當作引數傳遞至其中一個文字繪圖函式的點，來放置文字字串。</span><span class="sxs-lookup"><span data-stu-id="9545f-110">The system positions a string of text by aligning a reference point on an imaginary rectangle that surrounds the string, with the current cursor position or with a point passed as an argument to one of the text drawing functions.</span></span> <span data-ttu-id="9545f-111">[**SetTextAlign**](/windows/win32/api/wingdi/nf-wingdi-settextalign)函數可讓應用程式指定此參考點的位置。</span><span class="sxs-lookup"><span data-stu-id="9545f-111">The [**SetTextAlign**](/windows/win32/api/wingdi/nf-wingdi-settextalign) function lets the application specify the location of this reference point.</span></span> <span data-ttu-id="9545f-112">以下是可能的參考點位置清單。</span><span class="sxs-lookup"><span data-stu-id="9545f-112">The following is a list of the possible reference point locations.</span></span>



| <span data-ttu-id="9545f-113">Location</span><span class="sxs-lookup"><span data-stu-id="9545f-113">Location</span></span>         | <span data-ttu-id="9545f-114">描述</span><span class="sxs-lookup"><span data-stu-id="9545f-114">Description</span></span>                                                                                                             |
|------------------|-------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="9545f-115">靠左/靠下</span><span class="sxs-lookup"><span data-stu-id="9545f-115">left/bottom</span></span>      | <span data-ttu-id="9545f-116">參考點位於矩形的左下角。</span><span class="sxs-lookup"><span data-stu-id="9545f-116">The reference point is located at the lower-left corner of the rectangle.</span></span>                                               |
| <span data-ttu-id="9545f-117">左/基底行</span><span class="sxs-lookup"><span data-stu-id="9545f-117">left/base line</span></span>   | <span data-ttu-id="9545f-118">參考點位於字元儲存格基底線和矩形左邊緣的交集處。</span><span class="sxs-lookup"><span data-stu-id="9545f-118">The reference point is located at the intersection of the character-cell base line and the left edge of the rectangle.</span></span>  |
| <span data-ttu-id="9545f-119">左/上</span><span class="sxs-lookup"><span data-stu-id="9545f-119">left/top</span></span>         | <span data-ttu-id="9545f-120">參考點位於矩形的左上角。</span><span class="sxs-lookup"><span data-stu-id="9545f-120">The reference point is located at the top-left corner of the rectangle.</span></span>                                                 |
| <span data-ttu-id="9545f-121">中間/底部</span><span class="sxs-lookup"><span data-stu-id="9545f-121">center/bottom</span></span>    | <span data-ttu-id="9545f-122">參考點位於矩形底部的中央。</span><span class="sxs-lookup"><span data-stu-id="9545f-122">The reference point is located at the center of the bottom of the rectangle.</span></span>                                            |
| <span data-ttu-id="9545f-123">中心/基底線</span><span class="sxs-lookup"><span data-stu-id="9545f-123">center/base line</span></span> | <span data-ttu-id="9545f-124">參考點位於字元儲存格基底線和矩形中央的交集處。</span><span class="sxs-lookup"><span data-stu-id="9545f-124">The reference point is located at the intersection of the character-cell base line and the center of the rectangle.</span></span>     |
| <span data-ttu-id="9545f-125">置中/靠上</span><span class="sxs-lookup"><span data-stu-id="9545f-125">center/top</span></span>       | <span data-ttu-id="9545f-126">參考點位於矩形頂端的中央。</span><span class="sxs-lookup"><span data-stu-id="9545f-126">The reference point is located at the center of the top of the rectangle.</span></span>                                               |
| <span data-ttu-id="9545f-127">右/下</span><span class="sxs-lookup"><span data-stu-id="9545f-127">right/bottom</span></span>     | <span data-ttu-id="9545f-128">參考點位於矩形的右下角。</span><span class="sxs-lookup"><span data-stu-id="9545f-128">The reference point is located at the lower-right corner of the rectangle.</span></span>                                              |
| <span data-ttu-id="9545f-129">右/基底線</span><span class="sxs-lookup"><span data-stu-id="9545f-129">right/base line</span></span>  | <span data-ttu-id="9545f-130">參考點位於字元儲存格基底線和矩形右邊緣的交集處。</span><span class="sxs-lookup"><span data-stu-id="9545f-130">The reference point is located at the intersection of the character-cell base line and the right edge of the rectangle.</span></span> |
| <span data-ttu-id="9545f-131">靠右/靠上</span><span class="sxs-lookup"><span data-stu-id="9545f-131">right/top</span></span>        | <span data-ttu-id="9545f-132">參考點位於矩形的右上角。</span><span class="sxs-lookup"><span data-stu-id="9545f-132">The reference point is located at the top-right corner of the rectangle.</span></span>                                                |



 

<span data-ttu-id="9545f-133">下圖顯示藉由呼叫 [TextOut](/windows/desktop/api/Wingdi/nf-wingdi-textouta) 函數繪製的文字字串。</span><span class="sxs-lookup"><span data-stu-id="9545f-133">The following illustration shows a string of text drawn by calling the [TextOut](/windows/desktop/api/Wingdi/nf-wingdi-textouta) function.</span></span> <span data-ttu-id="9545f-134">在繪製文字之前，會呼叫 [SetTextAlign](/windows/desktop/api/Wingdi/nf-wingdi-settextalign) 函式，將參考點重新放置在九個可能位置的每一個位置。</span><span class="sxs-lookup"><span data-stu-id="9545f-134">Before drawing the text, the [SetTextAlign](/windows/desktop/api/Wingdi/nf-wingdi-settextalign) function was called to relocate the reference point at each one of the nine possible locations.</span></span>

![顯示相同文字九次的圖，每個可能的參考點位置各一個](images/csftx-04.png)

<span data-ttu-id="9545f-136">裝置內容的預設文字對齊方式是圍繞文字之虛數矩形的左上角。</span><span class="sxs-lookup"><span data-stu-id="9545f-136">The default text alignment for a device context is the upper-left corner of the imaginary rectangle that surrounds the text.</span></span> <span data-ttu-id="9545f-137">應用程式可以藉由呼叫 [GetTextAlign](/windows/desktop/api/Wingdi/nf-wingdi-gettextalign) 函式，來取得任何裝置內容的目前文字對齊設定。</span><span class="sxs-lookup"><span data-stu-id="9545f-137">An application can retrieve the current text-alignment setting for any device context by calling the [GetTextAlign](/windows/desktop/api/Wingdi/nf-wingdi-gettextalign) function.</span></span>

## <a name="intercharacter-spacing"></a><span data-ttu-id="9545f-138">Intercharacter 間距</span><span class="sxs-lookup"><span data-stu-id="9545f-138">Intercharacter Spacing</span></span>

<span data-ttu-id="9545f-139">應用程式可以使用 [SetTextCharacterExtra](/windows/desktop/api/Wingdi/nf-wingdi-settextcharacterextra) 函式來改變指定裝置內容中所有文字輸出作業的 intercharacter 間距。</span><span class="sxs-lookup"><span data-stu-id="9545f-139">Applications can use the [SetTextCharacterExtra](/windows/desktop/api/Wingdi/nf-wingdi-settextcharacterextra) function to alter the intercharacter spacing for all text output operations in a specified device context.</span></span> <span data-ttu-id="9545f-140">下圖顯示透過呼叫 [TextOut](/windows/desktop/api/Wingdi/nf-wingdi-textouta) 函式繪製兩次的文字字串。</span><span class="sxs-lookup"><span data-stu-id="9545f-140">The following illustration shows a string of text drawn twice by calling the [TextOut](/windows/desktop/api/Wingdi/nf-wingdi-textouta) function.</span></span> <span data-ttu-id="9545f-141">第二次繪製文字之前，會呼叫 [**SetTextCharacterExtra**](/windows/win32/api/wingdi/nf-wingdi-settextcharacterextra) 函數來遞增 intercharacter 間距。</span><span class="sxs-lookup"><span data-stu-id="9545f-141">Before drawing the text the second time, the [**SetTextCharacterExtra**](/windows/win32/api/wingdi/nf-wingdi-settextcharacterextra) function was called to increment the intercharacter spacing.</span></span>

![圖例 shoing 相同的文字兩次：先具有一般 intercharacter 間距，然後以較寬的間距表示](images/csftx-06.png)

<span data-ttu-id="9545f-143">任何裝置內容的預設 intercharacter 間距值為零。</span><span class="sxs-lookup"><span data-stu-id="9545f-143">The default intercharacter spacing value for any device context is zero.</span></span> <span data-ttu-id="9545f-144">應用程式可以藉由呼叫 [GetTextCharacterExtra](/windows/desktop/api/Wingdi/nf-wingdi-gettextcharacterextra) 函式，來取得裝置內容的目前 intercharacter 間距值。</span><span class="sxs-lookup"><span data-stu-id="9545f-144">An application can retrieve the current intercharacter spacing value for a device context by calling the [GetTextCharacterExtra](/windows/desktop/api/Wingdi/nf-wingdi-gettextcharacterextra) function.</span></span>

## <a name="text-justification"></a><span data-ttu-id="9545f-145">文字對齊方式</span><span class="sxs-lookup"><span data-stu-id="9545f-145">Text Justification</span></span>

<span data-ttu-id="9545f-146">應用程式可以使用 [GetTextExtentPoint32](/windows/desktop/api/Wingdi/nf-wingdi-gettextextentpoint32a) 和 [SetTextJustification](/windows/desktop/api/Wingdi/nf-wingdi-settextjustification) 函式來調整一行文字。</span><span class="sxs-lookup"><span data-stu-id="9545f-146">Applications can use the [GetTextExtentPoint32](/windows/desktop/api/Wingdi/nf-wingdi-gettextextentpoint32a) and [SetTextJustification](/windows/desktop/api/Wingdi/nf-wingdi-settextjustification) functions to justify a line of text.</span></span> <span data-ttu-id="9545f-147">文字對齊是在任何桌上型電腦和大部分文書處理應用程式中常見的操作。</span><span class="sxs-lookup"><span data-stu-id="9545f-147">Text justification is a common operation in any desktop publishing and in most word processing applications.</span></span> <span data-ttu-id="9545f-148">[**GetTextExtentPoint32**](/windows/win32/api/wingdi/nf-wingdi-gettextextentpoint32a)函數會計算文字字串的寬度和高度。</span><span class="sxs-lookup"><span data-stu-id="9545f-148">The [**GetTextExtentPoint32**](/windows/win32/api/wingdi/nf-wingdi-gettextextentpoint32a) function computes the width and height of a string of text.</span></span> <span data-ttu-id="9545f-149">計算寬度之後，應用程式可以呼叫 [**SetTextJustification**](/windows/win32/api/wingdi/nf-wingdi-settextjustification) 函式，以在文字行中的每個單字之間分佈額外的間距。</span><span class="sxs-lookup"><span data-stu-id="9545f-149">After the width is computed, the application can call the [**SetTextJustification**](/windows/win32/api/wingdi/nf-wingdi-settextjustification) function to distribute extra spacing between each of the words in a line of text.</span></span> <span data-ttu-id="9545f-150">下圖顯示一段文字列印兩次：在第一個段落中，未對齊文字;在第二個段落中，藉由呼叫 **GetTextExtentPoint32** 和 **SetTextJustification** 函式來對齊文字。</span><span class="sxs-lookup"><span data-stu-id="9545f-150">The following illustration shows a paragraph of text printed twice: in the first paragraph, the text was not justified; in the second paragraph, the text was justified by calling the **GetTextExtentPoint32** and **SetTextJustification** functions.</span></span>

![圖例顯示只靠左對齊的段落，然後靠左和靠右對齊相同段落](images/csftx-05.png)

## <a name="text-and-background-color"></a><span data-ttu-id="9545f-152">文字和背景色彩</span><span class="sxs-lookup"><span data-stu-id="9545f-152">Text and Background Color</span></span>

<span data-ttu-id="9545f-153">應用程式可以使用 [SetTextColor](/windows/desktop/api/Wingdi/nf-wingdi-settextcolor) 函式來設定在其視窗的工作區中繪製的文字色彩，以及彩色印表機上繪製的文字色彩。</span><span class="sxs-lookup"><span data-stu-id="9545f-153">Applications can use the [SetTextColor](/windows/desktop/api/Wingdi/nf-wingdi-settextcolor) function to set the color of text drawn in the client-area of their windows, as well as the color of text drawn on a color printer.</span></span> <span data-ttu-id="9545f-154">應用程式可以使用 [SetBkColor](/windows/desktop/api/Wingdi/nf-wingdi-setbkcolor) 函式來設定出現在每個字元後面的色彩，並使用 [SetBkMode](/windows/desktop/api/Wingdi/nf-wingdi-setbkmode) 函式來指定系統應該如何將選取的背景色彩與影片顯示器上目前的色彩或色彩混合。</span><span class="sxs-lookup"><span data-stu-id="9545f-154">An application can use the [SetBkColor](/windows/desktop/api/Wingdi/nf-wingdi-setbkcolor) function to set the color that appears behind each character and the [SetBkMode](/windows/desktop/api/Wingdi/nf-wingdi-setbkmode) function to specify how the system should blend the selected background color with the current color or colors on the video display.</span></span>

<span data-ttu-id="9545f-155">顯示裝置內容的預設文字色彩為黑色;預設的背景色彩為白色;而且預設的背景模式是不透明的。</span><span class="sxs-lookup"><span data-stu-id="9545f-155">The default text color for a display device context is black; the default background color is white; and the default background mode is OPAQUE.</span></span> <span data-ttu-id="9545f-156">應用程式可以藉由呼叫 [GetTextColor](/windows/desktop/api/Wingdi/nf-wingdi-gettextcolor) 函式，來取得裝置內容的目前文字色彩。</span><span class="sxs-lookup"><span data-stu-id="9545f-156">An application can retrieve the current text color for a device context by calling the [GetTextColor](/windows/desktop/api/Wingdi/nf-wingdi-gettextcolor) function.</span></span> <span data-ttu-id="9545f-157">應用程式可以藉由呼叫 [GetBkColor](/windows/desktop/api/Wingdi/nf-wingdi-getbkcolor) 函式和目前的背景模式來取得裝置內容目前的背景色彩，方法是呼叫 [GetBkMode](/windows/desktop/api/Wingdi/nf-wingdi-getbkmode) 函數。</span><span class="sxs-lookup"><span data-stu-id="9545f-157">An application can retrieve the current background color for a device context by calling the [GetBkColor](/windows/desktop/api/Wingdi/nf-wingdi-getbkcolor) function and the current background mode by calling the [GetBkMode](/windows/desktop/api/Wingdi/nf-wingdi-getbkmode) function.</span></span>

 

 
