---
description: 所有驗證設定都是透過網際網路服務管理員進行。
ms.assetid: 9b118120-f0cb-4973-b537-dd3d12a7a6d5
ms.tgt_platform: multiple
title: 針對 WMI ASP 腳本設定 IIS 5.0 和更新版本
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: ff4b5ddde139b3eef32fd7c80f4cca4e10fd816a
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/07/2021
ms.locfileid: "106992023"
---
# <a name="configuring-iis-50-and-later-for-wmi-asp-scripting"></a>針對 WMI ASP 腳本設定 IIS 5.0 和更新版本

所有驗證設定都是透過網際網路服務管理員進行。

設定 Internet Information Server 時 (IIS) 5.0 和 IIS 6.0 security （適用于 WMI ASP 腳本），請考慮下列問題：

-   [驗證等級](#authentication-level)

    您可以在伺服器、目錄或檔案層級進行設定。

-   [驗證設定](#authentication-setting)

    您可以將驗證設定為匿名、整合式 Windows 或兩者。

-   [保護](#protection)

    您可以將 ASP 設定為以同進程方式執行 (低保護) ，或使用 Dllhost.exe (中或高保護) 來執行跨進程。

## <a name="authentication-level"></a>驗證等級

為了增加安全性，您可以在目錄或檔案層級設定驗證。

如果驗證是在伺服器層級設定，除非在目錄或檔案層級明確改變，否則所有後續的目錄和檔案都會遵守伺服器驗證。 您可以建立一個目錄結構，以包含 wmi ASP 腳本，其中 WMI 專用的 HTML 網頁和 Asp 可以與伺服器的其餘部分分開設定。 執行下列程式，以變更伺服器、目錄或檔案的驗證層級。

**設定任何層級的驗證**

1.  在主控台中，按兩下 [系統 **管理工具**]，然後按兩下 [IIS] 嵌入式管理單元。

2.  找出 ASP 頁面圖示，然後開啟要設定之層級的屬性，可以是 [伺服器]、[目錄] 或 [檔案]。

    > [!Note]  
    > 驗證設定 **位於 [內容] 工作表的**[**目錄安全性**] 或 [檔案 **安全性**] 索引標籤上。

     

## <a name="authentication-setting"></a>驗證設定

若為 WMI ASP 腳本，則會關閉 [匿名驗證] 的組合 (未核取的) ，並開啟 (檢查) 的整合 Windows 驗證，可提供更高的安全性設定機會。 若要使用 NT LAN Manager (NTLM) 、Passport 或 Digest IIS 驗證設定，您必須開啟遠端啟用許可權，因為系統會將使用者視為網路身分識別，並從遠端登入。 匿名和基本驗證不需要遠端啟用設定。 但是，當您使用匿名和基本驗證時，系統會比較不安全。

如果匿名驗證搭配使用或未整合 Windows 驗證，最安全的方法是使用需要使用者輸入使用者名稱和密碼的登入。 預設登入是 IIS 身分識別，但您可以使用適用于 WMI ASP 腳本的特定許可權來建立登入，這些腳本可作為匿名或來賓連接的帳戶使用。

如果您選擇不是 IIS 身分識別的登入識別碼，請清除 [ **允許 IIS 控制密碼** ] 核取方塊，然後輸入正確的密碼。 這會強制所有匿名或來賓連接使用登入識別碼。 藉由建立與 IIS 身分識別分開的登入，就可以控制存取 WMI 的帳戶許可權，而不會影響 IIS 伺服器上的其他目錄或檔案，除非驗證是在伺服器層級設定。

執行下列程式，使用主控台中的 IIS 嵌入式管理單元來設定 ASP 頁面的驗證需求。

**若要取得帳戶設定**

1.  在主控台中，按兩下 [系統 **管理工具** ] 圖示、開啟 IIS 嵌入式管理單元、找出 ASP 頁面，然後開啟要設定之層級的屬性，可以是 [伺服器]、[目錄] 或 [檔案]。

    您可以在 [內容]**工作表的**[**目錄安全性**] 或 [檔案 **安全性**] 索引標籤上找到驗證設定。

2.  在 [匿名驗證] 區域中，按一下 [ **編輯**]。

3.  如果已選取 [IIS 身分識別] 以外的登入識別碼，請清除 [ **允許 IIS 控制密碼**] 核取方塊，然後輸入正確的密碼。 這會強制所有匿名或來賓連接使用登入識別碼。

使用與 IIS 身分識別不同的登入，就可以控制存取 WMI 的帳戶許可權，而不會影響 IIS 伺服器上的其他目錄或檔案，除非驗證是在伺服器層級設定。

先前的設定可讓 IIS 伺服器在某些區域中使用匿名驗證，以及在其他區域中使用整合式 Windows 或混合式驗證。

## <a name="protection"></a>保護

設定 IIS 伺服器時的最後一個考慮是執行 ASP 時要使用的保護。

您可以設定 ASP 來執行下列程式：

-   IIS 的同進程 (低保護) 。

-   以 Dllhost.exe 為集區或跨進程的 IIS 外部， (集區中保護) 。

-   跨進程自我裝載 (高保護) 。

> [!Note]  
> 為了獲得最佳的安全性和效能平衡，請使用集區主機。

 

 

 



