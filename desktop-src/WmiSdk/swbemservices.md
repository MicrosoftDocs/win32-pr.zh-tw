---
description: 您可以使用 SWbemServices 物件的方法，對本機主機或遠端主機上的命名空間執行作業。 VBScript CreateObject 呼叫無法建立這個物件。
ms.assetid: 7fcfa404-2fe6-42e5-85ac-64536f6d2a44
ms.tgt_platform: multiple
title: 'SWbemServices 物件 (>wbemdisp.tlb) '
ms.topic: reference
ms.date: 05/31/2018
topic_type:
- APIRef
- kbSyntax
api_name:
- SWbemServices
- ISWbemServices
api_type:
- COM
api_location:
- Wbemdisp.dll
ms.openlocfilehash: 4303b3226acc6d773ed35e77176e05e3a58c567d
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/07/2021
ms.locfileid: "106983550"
---
# <a name="swbemservices-object"></a><span data-ttu-id="f4e56-104">SWbemServices 物件</span><span class="sxs-lookup"><span data-stu-id="f4e56-104">SWbemServices object</span></span>

<span data-ttu-id="f4e56-105">您可以使用 **SWbemServices** 物件的方法，對本機主機或遠端主機上的命名空間執行作業。</span><span class="sxs-lookup"><span data-stu-id="f4e56-105">You can use the methods of an **SWbemServices** object to perform operations against a namespace on either a local host or a remote host.</span></span> <span data-ttu-id="f4e56-106">VBScript **CreateObject** 呼叫無法建立這個物件。</span><span class="sxs-lookup"><span data-stu-id="f4e56-106">This object cannot be created by the VBScript **CreateObject** call.</span></span>

## <a name="members"></a><span data-ttu-id="f4e56-107">成員</span><span class="sxs-lookup"><span data-stu-id="f4e56-107">Members</span></span>

<span data-ttu-id="f4e56-108">**SWbemServices** 物件具有下列類型的成員：</span><span class="sxs-lookup"><span data-stu-id="f4e56-108">The **SWbemServices** object has these types of members:</span></span>

-   [<span data-ttu-id="f4e56-109">方法</span><span class="sxs-lookup"><span data-stu-id="f4e56-109">Methods</span></span>](#methods)
-   [<span data-ttu-id="f4e56-110">屬性</span><span class="sxs-lookup"><span data-stu-id="f4e56-110">Properties</span></span>](#properties)

### <a name="methods"></a><span data-ttu-id="f4e56-111">方法</span><span class="sxs-lookup"><span data-stu-id="f4e56-111">Methods</span></span>

<span data-ttu-id="f4e56-112">**SWbemServices** 物件有這些方法。</span><span class="sxs-lookup"><span data-stu-id="f4e56-112">The **SWbemServices** object has these methods.</span></span>



| <span data-ttu-id="f4e56-113">方法</span><span class="sxs-lookup"><span data-stu-id="f4e56-113">Method</span></span>                                                                         | <span data-ttu-id="f4e56-114">描述</span><span class="sxs-lookup"><span data-stu-id="f4e56-114">Description</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|:-------------------------------------------------------------------------------|:----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="f4e56-115">**AssociatorsOf**</span><span class="sxs-lookup"><span data-stu-id="f4e56-115">**AssociatorsOf**</span></span>](swbemservices-associatorsof.md)                           | <span data-ttu-id="f4e56-116">透過一或多個關聯類別，取得與指定之資源相關聯之 managed 資源的實例。</span><span class="sxs-lookup"><span data-stu-id="f4e56-116">Retrieves the instances of managed resources that are associated with a specified resource through one or more association classes.</span></span> <span data-ttu-id="f4e56-117">您會提供原始端點的物件路徑，而 [**AssociatorsOf**](swbemservices-associatorsof.md) 會傳回相對端點的 managed 資源。</span><span class="sxs-lookup"><span data-stu-id="f4e56-117">You provide the object path for the originating endpoint, and [**AssociatorsOf**](swbemservices-associatorsof.md) returns the managed resources at the opposite endpoint.</span></span> <span data-ttu-id="f4e56-118">**AssociatorsOf** 方法會執行「ASSOCIATORS OF」 WQL 查詢所執行的相同函數。</span><span class="sxs-lookup"><span data-stu-id="f4e56-118">The **AssociatorsOf** method performs the same function that the "ASSOCIATORS OF" WQL query performs.</span></span><br/>                                                                           |
| [<span data-ttu-id="f4e56-119">**AssociatorsOfAsync**</span><span class="sxs-lookup"><span data-stu-id="f4e56-119">**AssociatorsOfAsync**</span></span>](swbemservices-associatorsofasync.md)                 | <span data-ttu-id="f4e56-120">以非同步方式傳回與指定物件相關聯)  (類別或實例的集合。</span><span class="sxs-lookup"><span data-stu-id="f4e56-120">Asynchronously returns a collection of objects (classes or instances) that are associated with a specified object.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                             |
| [<span data-ttu-id="f4e56-121">**刪除**</span><span class="sxs-lookup"><span data-stu-id="f4e56-121">**Delete**</span></span>](swbemservices-delete.md)                                         | <span data-ttu-id="f4e56-122">刪除 managed 資源 (的實例，或從 CIM 存放庫) 的類別定義。</span><span class="sxs-lookup"><span data-stu-id="f4e56-122">Deletes an instance of a managed resource (or a class definition from the CIM repository).</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                     |
| [<span data-ttu-id="f4e56-123">**DeleteAsync**</span><span class="sxs-lookup"><span data-stu-id="f4e56-123">**DeleteAsync**</span></span>](swbemservices-deleteasync.md)                               | <span data-ttu-id="f4e56-124">以非同步方式刪除物件路徑中指定的類別或實例。</span><span class="sxs-lookup"><span data-stu-id="f4e56-124">Asynchronously deletes the class or instance that is specified in the object path.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                             |
| [<span data-ttu-id="f4e56-125">**ExecMethod**</span><span class="sxs-lookup"><span data-stu-id="f4e56-125">**ExecMethod**</span></span>](swbemservices-execmethod.md)                                 | <span data-ttu-id="f4e56-126">提供另一種方法來執行 managed 資源類別定義所定義的方法。</span><span class="sxs-lookup"><span data-stu-id="f4e56-126">Provides an alternative way to execute a method defined by a managed resource class definition.</span></span> <span data-ttu-id="f4e56-127">主要是在指令碼語言不支援 out 參數的情況下使用。</span><span class="sxs-lookup"><span data-stu-id="f4e56-127">Primarily used in situations in which the scripting language does not support out parameters.</span></span> <span data-ttu-id="f4e56-128">例如，JScript 不支援 out 參數。</span><span class="sxs-lookup"><span data-stu-id="f4e56-128">For example, JScript does not support out parameters.</span></span><br/>                                                                                                                                                                                                                                            |
| [<span data-ttu-id="f4e56-129">**ExecMethodAsync**</span><span class="sxs-lookup"><span data-stu-id="f4e56-129">**ExecMethodAsync**</span></span>](swbemservices-execmethodasync.md)                       | <span data-ttu-id="f4e56-130">以非同步方式執行方法提供者所匯出的方法。</span><span class="sxs-lookup"><span data-stu-id="f4e56-130">Asynchronously executes a method that is exported by a method provider.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                        |
| [<span data-ttu-id="f4e56-131">**ExecNotificationQuery**</span><span class="sxs-lookup"><span data-stu-id="f4e56-131">**ExecNotificationQuery**</span></span>](swbemservices-execnotificationquery.md)           | <span data-ttu-id="f4e56-132">執行事件訂閱查詢以接收事件。</span><span class="sxs-lookup"><span data-stu-id="f4e56-132">Executes an event subscription query to receive events.</span></span> <span data-ttu-id="f4e56-133">事件訂閱查詢是定義您想要監視的受管理環境變更的查詢。</span><span class="sxs-lookup"><span data-stu-id="f4e56-133">An event subscription query is a query that defines a change to the managed environment that you want to monitor.</span></span> <span data-ttu-id="f4e56-134">發生變更時，WMI 基礎結構會提供事件，描述呼叫腳本的變更。</span><span class="sxs-lookup"><span data-stu-id="f4e56-134">When the change occurs, the WMI infrastructure delivers an event describing the change to the calling script.</span></span><br/>                                                                                                                                                                                                        |
| [<span data-ttu-id="f4e56-135">**ExecNotificationQueryAsync**</span><span class="sxs-lookup"><span data-stu-id="f4e56-135">**ExecNotificationQueryAsync**</span></span>](swbemservices-execnotificationqueryasync.md) | <span data-ttu-id="f4e56-136">以非同步方式執行查詢以接收事件。</span><span class="sxs-lookup"><span data-stu-id="f4e56-136">Asynchronously executes a query to receive events.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| [<span data-ttu-id="f4e56-137">**ExecQuery**</span><span class="sxs-lookup"><span data-stu-id="f4e56-137">**ExecQuery**</span></span>](swbemservices-execquery.md)                                   | <span data-ttu-id="f4e56-138">執行查詢，以抓取受 WMI 管理之資源的實例集合 (或) 的類別定義。</span><span class="sxs-lookup"><span data-stu-id="f4e56-138">Executes a query to retrieve a collection of instances of WMI-managed resources (or class definitions).</span></span> <span data-ttu-id="f4e56-139">[**ExecQuery**](swbemservices-execquery.md) 可以用來抓取已篩選的實例集合，這些實例符合您在傳遞至 **ExecQuery** 的查詢中定義的條件。</span><span class="sxs-lookup"><span data-stu-id="f4e56-139">[**ExecQuery**](swbemservices-execquery.md) can be used to retrieve a filtered collection of instances that match criteria you define in the query passed to **ExecQuery**.</span></span><br/>                                                                                                                                                                                                           |
| [<span data-ttu-id="f4e56-140">**ExecQueryAsync**</span><span class="sxs-lookup"><span data-stu-id="f4e56-140">**ExecQueryAsync**</span></span>](swbemservices-execqueryasync.md)                         | <span data-ttu-id="f4e56-141">以非同步方式執行查詢來取出物件。</span><span class="sxs-lookup"><span data-stu-id="f4e56-141">Asynchronously executes a query to retrieve objects.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| [<span data-ttu-id="f4e56-142">**Get**</span><span class="sxs-lookup"><span data-stu-id="f4e56-142">**Get**</span></span>](swbemservices-get.md)                                               | <span data-ttu-id="f4e56-143">根據物件路徑，抓取 managed 資源 (或類別定義) 的單一實例。</span><span class="sxs-lookup"><span data-stu-id="f4e56-143">Retrieves a single instance of a managed resource (or class definition) based on an object path.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                               |
| [<span data-ttu-id="f4e56-144">**GetAsync**</span><span class="sxs-lookup"><span data-stu-id="f4e56-144">**GetAsync**</span></span>](swbemservices-getasync.md)                                     | <span data-ttu-id="f4e56-145">以物件路徑為基礎，以非同步方式抓取物件，也就是類別定義或實例。</span><span class="sxs-lookup"><span data-stu-id="f4e56-145">Asynchronously retrieves an object, that is either a class definition or an instance, based on the object path.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                |
| [<span data-ttu-id="f4e56-146">**InstancesOf**</span><span class="sxs-lookup"><span data-stu-id="f4e56-146">**InstancesOf**</span></span>](swbemservices-instancesof.md)                               | <span data-ttu-id="f4e56-147">根據類別名稱，抓取 managed 資源的所有實例。</span><span class="sxs-lookup"><span data-stu-id="f4e56-147">Retrieves all the instances of a managed resource based on a class name.</span></span> <span data-ttu-id="f4e56-148">根據預設， [**InstancesOf**](swbemservices-instancesof.md) 會執行深度抓取。</span><span class="sxs-lookup"><span data-stu-id="f4e56-148">By default, [**InstancesOf**](swbemservices-instancesof.md) performs a deep retrieval.</span></span> <span data-ttu-id="f4e56-149">也就是說， **InstancesOf** 會抓取傳遞給方法之類別名稱所識別的資源實例，也會抓取所有子類別的所有實例， (在目標類別) 下定義。</span><span class="sxs-lookup"><span data-stu-id="f4e56-149">That is, **InstancesOf** retrieves the instances of the resource identified by the class name passed to the method and also retrieves all the instances of all the resources that are subclasses (defined beneath) of the target class.</span></span><br/>                                                                                       |
| [<span data-ttu-id="f4e56-150">**InstancesOfAsync**</span><span class="sxs-lookup"><span data-stu-id="f4e56-150">**InstancesOfAsync**</span></span>](swbemservices-instancesofasync.md)                     | <span data-ttu-id="f4e56-151">根據使用者指定的選取準則，以非同步方式傳回指定之類別的實例。</span><span class="sxs-lookup"><span data-stu-id="f4e56-151">Asynchronously returns the instances of a specified class according to the user-specified selection criteria.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                  |
| [<span data-ttu-id="f4e56-152">**ReferencesTo**</span><span class="sxs-lookup"><span data-stu-id="f4e56-152">**ReferencesTo**</span></span>](swbemservices-referencesto.md)                             | <span data-ttu-id="f4e56-153">傳回參考指定資源的所有關聯。</span><span class="sxs-lookup"><span data-stu-id="f4e56-153">Returns all of the associations that reference a specified resource.</span></span> <span data-ttu-id="f4e56-154">瞭解 [**ReferencesTo**](swbemservices-referencesto.md) 的最佳方式是將它與 [**AssociatorsOf**](swbemservices-associatorsof.md) 方法進行比較。</span><span class="sxs-lookup"><span data-stu-id="f4e56-154">The best way to understand [**ReferencesTo**](swbemservices-referencesto.md) is to compare it with the [**AssociatorsOf**](swbemservices-associatorsof.md) method.</span></span> <span data-ttu-id="f4e56-155">**AssociatorsOf** 會傳回位於關聯另一端的動態資源。</span><span class="sxs-lookup"><span data-stu-id="f4e56-155">**AssociatorsOf** returns the dynamic resources that are at the opposite end of an association.</span></span> <span data-ttu-id="f4e56-156">**ReferencesTo** 會傳回關聯本身。</span><span class="sxs-lookup"><span data-stu-id="f4e56-156">**ReferencesTo** returns the association itself.</span></span> <span data-ttu-id="f4e56-157">**ReferencesTo** 方法會執行「WQL 查詢」所執行的相同函數。</span><span class="sxs-lookup"><span data-stu-id="f4e56-157">The **ReferencesTo** method performs the same function that the "REFERENCES OF" WQL query performs.</span></span><br/> |
| [<span data-ttu-id="f4e56-158">**ReferencesToAsync**</span><span class="sxs-lookup"><span data-stu-id="f4e56-158">**ReferencesToAsync**</span></span>](swbemservices-referencesto.md)                        | <span data-ttu-id="f4e56-159">以非同步方式傳回參考特定類別或實例的所有關聯類別或實例的集合。</span><span class="sxs-lookup"><span data-stu-id="f4e56-159">Asynchronously returns a collection of all association classes or instances that refer to a specific class or instance.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                        |
| [<span data-ttu-id="f4e56-160">**SubclassesOf**</span><span class="sxs-lookup"><span data-stu-id="f4e56-160">**SubclassesOf**</span></span>](swbemservices-subclassesof.md)                             | <span data-ttu-id="f4e56-161">從 CIM 儲存機制抓取指定類別的所有子類別。</span><span class="sxs-lookup"><span data-stu-id="f4e56-161">Retrieves all the subclasses of a specified class from the CIM repository.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                     |
| [<span data-ttu-id="f4e56-162">**SubclassesOfAsync**</span><span class="sxs-lookup"><span data-stu-id="f4e56-162">**SubclassesOfAsync**</span></span>](swbemservices-subclassesofasync.md)                   | <span data-ttu-id="f4e56-163">以非同步方式傳回指定類別的子類別集合。</span><span class="sxs-lookup"><span data-stu-id="f4e56-163">Asynchronously returns a collection of subclasses for a specified class.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                       |



 

### <a name="properties"></a><span data-ttu-id="f4e56-164">屬性</span><span class="sxs-lookup"><span data-stu-id="f4e56-164">Properties</span></span>

<span data-ttu-id="f4e56-165">**SWbemServices** 物件具有這些屬性。</span><span class="sxs-lookup"><span data-stu-id="f4e56-165">The **SWbemServices** object has these properties.</span></span>



| <span data-ttu-id="f4e56-166">屬性</span><span class="sxs-lookup"><span data-stu-id="f4e56-166">Property</span></span>                                                 | <span data-ttu-id="f4e56-167">存取類型</span><span class="sxs-lookup"><span data-stu-id="f4e56-167">Access type</span></span>          | <span data-ttu-id="f4e56-168">Description</span><span class="sxs-lookup"><span data-stu-id="f4e56-168">Description</span></span>                                                                          |
|:---------------------------------------------------------|:---------------------|:-------------------------------------------------------------------------------------|
| [<span data-ttu-id="f4e56-169">**安全性\_**</span><span class="sxs-lookup"><span data-stu-id="f4e56-169">**Security\_**</span></span>](swbemservices-security-.md)<br/> | <span data-ttu-id="f4e56-170">唯讀</span><span class="sxs-lookup"><span data-stu-id="f4e56-170">Read-only</span></span><br/> | <span data-ttu-id="f4e56-171">用來取得或設定 **SWbemServices** 物件的安全性設定。</span><span class="sxs-lookup"><span data-stu-id="f4e56-171">Used to get or set the security settings for an **SWbemServices** object.</span></span><br/> |



 

## <a name="remarks"></a><span data-ttu-id="f4e56-172">備註</span><span class="sxs-lookup"><span data-stu-id="f4e56-172">Remarks</span></span>

<span data-ttu-id="f4e56-173">可以在同步模式、非同步模式或半同步模式中呼叫方法。</span><span class="sxs-lookup"><span data-stu-id="f4e56-173">The methods can be called in either the synchronous mode, the asynchronous mode, or the semisynchronous mode.</span></span> <span data-ttu-id="f4e56-174">如需詳細資訊，請參閱 [呼叫方法](calling-a-method.md)。</span><span class="sxs-lookup"><span data-stu-id="f4e56-174">For more information see [Calling a Method](calling-a-method.md).</span></span>

<span data-ttu-id="f4e56-175">**概觀**</span><span class="sxs-lookup"><span data-stu-id="f4e56-175">**Overview**</span></span>

<span data-ttu-id="f4e56-176">**SWbemServices** 有兩個主要角色。</span><span class="sxs-lookup"><span data-stu-id="f4e56-176">**SWbemServices** serves two primary roles.</span></span> <span data-ttu-id="f4e56-177">首先， **SWbemServices** 物件代表與目的電腦上的 WMI 命名空間進行驗證的連接。</span><span class="sxs-lookup"><span data-stu-id="f4e56-177">First, the **SWbemServices** object represents an authenticated connection to a WMI namespace on a target computer.</span></span> <span data-ttu-id="f4e56-178">其次， **SWbemServices** 是您用來捕獲 WMI 管理資源的自動化物件。</span><span class="sxs-lookup"><span data-stu-id="f4e56-178">Second, **SWbemServices** is the Automation object you use to retrieve WMI-managed resources.</span></span> <span data-ttu-id="f4e56-179">您可以使用下列兩種方式之一取得 **SWbemServices** 物件的參考：</span><span class="sxs-lookup"><span data-stu-id="f4e56-179">You can obtain a reference to an **SWbemServices** object in either of two ways:</span></span>

-   <span data-ttu-id="f4e56-180">如同目前為止所呈現的大部分 WMI 腳本中所示範，您可以搭配使用 VBScript [**GetObject**](https://msdn.microsoft.com/library/e9waz863(v=VS.71).aspx) 函數與 WMI 標記 "winmgmts："。</span><span class="sxs-lookup"><span data-stu-id="f4e56-180">As demonstrated in most of the WMI scripts presented thus far, you can use the VBScript [**GetObject**](https://msdn.microsoft.com/library/e9waz863(v=VS.71).aspx) function in combination with the WMI moniker "winmgmts:".</span></span> <span data-ttu-id="f4e56-181">下列範例是最簡單的 WMI 連接形式。</span><span class="sxs-lookup"><span data-stu-id="f4e56-181">The following example is the simplest form of a WMI connection.</span></span> <span data-ttu-id="f4e56-182">此範例會連接到本機電腦上的預設命名空間 (通常是 "Root \\ CIMv2" ) ：</span><span class="sxs-lookup"><span data-stu-id="f4e56-182">The example connects to the default namespace (typically "Root\\CIMv2") on the local computer:</span></span>

    `Set objSWbemServices = GetObject("winmgmts:")`

-   <span data-ttu-id="f4e56-183">您也可以使用 [**wbemscripting.swbemlocator**](swbemlocator.md) 物件 [**ConnectServer**](/windows/desktop/api/Wbemcli/nf-wbemcli-iwbemlocator-connectserver) 方法來取得 **SWbemServices** 物件的參考。</span><span class="sxs-lookup"><span data-stu-id="f4e56-183">You can also use the [**SWbemLocator**](swbemlocator.md) object [**ConnectServer**](/windows/desktop/api/Wbemcli/nf-wbemcli-iwbemlocator-connectserver) method to obtain a reference to an **SWbemServices** object.</span></span>

<span data-ttu-id="f4e56-184">取得 **SWbemServices** 物件的參考之後，您可以使用物件參考，以使用 **SWbemServices** 呼叫18個方法中的1個。</span><span class="sxs-lookup"><span data-stu-id="f4e56-184">After you obtain a reference to an **SWbemServices** object, you use the object reference to call 1 of 18 methods available using **SWbemServices**.</span></span> <span data-ttu-id="f4e56-185">根據您呼叫的方法， **SWbemServices** 可以傳回三個不同的 WMI 腳本庫物件之一 ([**swbemobjectset 搭配使用**](swbemobjectset.md)、 [**SWbemObject**](swbemobject.md)或 [**SWbemEventSource**](swbemeventsource.md)) 。</span><span class="sxs-lookup"><span data-stu-id="f4e56-185">**SWbemServices** can return one of three different WMI scripting library objects ([**SWbemObjectSet**](swbemobjectset.md), [**SWbemObject**](swbemobject.md), or [**SWbemEventSource**](swbemeventsource.md)), depending on the method you call.</span></span> <span data-ttu-id="f4e56-186">知道每個方法所傳回的物件類型，將有助於您判斷腳本必須採取的下一個步驟。</span><span class="sxs-lookup"><span data-stu-id="f4e56-186">Knowing the type of object each method returns will help you determine the next step your script must take.</span></span> <span data-ttu-id="f4e56-187">例如，如果您取回 **swbemobjectset 搭配使用**，則必須列舉集合以存取集合中的每個 **SWbemObject** 。</span><span class="sxs-lookup"><span data-stu-id="f4e56-187">For example, if you get back an **SWbemObjectSet**, you must enumerate the collection to access each **SWbemObject** in the collection.</span></span> <span data-ttu-id="f4e56-188">如果您取回 **SWbemObject**，您可以立即存取物件方法和屬性，而不需要先列舉集合。</span><span class="sxs-lookup"><span data-stu-id="f4e56-188">If you get back an **SWbemObject**, you can immediately access the object methods and properties without enumerating the collection first.</span></span>

<span data-ttu-id="f4e56-189">**作業模式**</span><span class="sxs-lookup"><span data-stu-id="f4e56-189">**Modes of Operation**</span></span>

<span data-ttu-id="f4e56-190">**SWbemServices** 支援三種作業模式：同步、非同步和同步。</span><span class="sxs-lookup"><span data-stu-id="f4e56-190">**SWbemServices** supports three modes of operation: synchronous, asynchronous, and semisynchronous.</span></span>

-   <span data-ttu-id="f4e56-191">**同步**。</span><span class="sxs-lookup"><span data-stu-id="f4e56-191">**Synchronous**.</span></span> <span data-ttu-id="f4e56-192">在同步模式中，除非 **SWbemServices** 方法完成，否則腳本會封鎖 (暫停) 。</span><span class="sxs-lookup"><span data-stu-id="f4e56-192">In synchronous mode, your script blocks (pauses) until the **SWbemServices** method completes.</span></span> <span data-ttu-id="f4e56-193">您的腳本不只會等待，但在 WMI 抓取 managed 資源實例的情況下，WMI 會先在記憶體中建立整個 [**swbemobjectset 搭配使用**](swbemobjectset.md) ，然後再將第一個位元組的資料傳回給呼叫腳本。</span><span class="sxs-lookup"><span data-stu-id="f4e56-193">Not only does your script wait, but in cases in which WMI retrieves instances of managed resources, WMI builds the entire [**SWbemObjectSet**](swbemobjectset.md) in memory before the first byte of data is returned to the calling script.</span></span> <span data-ttu-id="f4e56-194">這可能會對腳本效能以及執行腳本的電腦造成負面影響。</span><span class="sxs-lookup"><span data-stu-id="f4e56-194">This can have an adverse effect on the script performance and on the computer running the script.</span></span> <span data-ttu-id="f4e56-195">例如，以同步方式從 Windows 事件記錄檔中取出上千個事件可能需要很長的時間，而且會使用大量的記憶體。</span><span class="sxs-lookup"><span data-stu-id="f4e56-195">For example, synchronously retrieving thousands of events from the Windows Event Logs can take a long time and use a lot of memory.</span></span> <span data-ttu-id="f4e56-196">基於這些理由，不建議使用同步作業，除非三個方法 ([**Delete**](swbemservices-delete.md)、 [**ExecMethod**](swbemservices-execmethod.md)和 [**Get**](swbemservices-get.md)) 預設為同步。</span><span class="sxs-lookup"><span data-stu-id="f4e56-196">For these reasons, synchronous operations are not recommended except for the three methods ([**Delete**](swbemservices-delete.md), [**ExecMethod**](swbemservices-execmethod.md), and [**Get**](swbemservices-get.md)) that are synchronous by default.</span></span> <span data-ttu-id="f4e56-197">這些方法不會傳回大型資料集，因此不需要進行非半運算作業。</span><span class="sxs-lookup"><span data-stu-id="f4e56-197">These methods do not return large data sets, so semisynchronous operation is not required.</span></span>
-   <span data-ttu-id="f4e56-198">**非同步**。</span><span class="sxs-lookup"><span data-stu-id="f4e56-198">**Asynchronous**.</span></span> <span data-ttu-id="f4e56-199">在非同步模式中，您的腳本會呼叫其中九個非同步方法的其中一個，並立即傳回。</span><span class="sxs-lookup"><span data-stu-id="f4e56-199">In asynchronous mode, your script calls one of the nine asynchronous methods and returns immediately.</span></span> <span data-ttu-id="f4e56-200">也就是說，只要呼叫非同步方法，您的腳本就會繼續執行下一行程式碼。</span><span class="sxs-lookup"><span data-stu-id="f4e56-200">That is, as soon as the asynchronous method is called, your script resumes running the next line of code.</span></span> <span data-ttu-id="f4e56-201">若要使用非同步方法，您的腳本必須先建立 [**SWbemSink**](swbemsink.md) 物件和特殊的副程式，稱為事件處理常式。</span><span class="sxs-lookup"><span data-stu-id="f4e56-201">To use an asynchronous method, your script must first create an [**SWbemSink**](swbemsink.md) object and a special subroutine called an event handler.</span></span> <span data-ttu-id="f4e56-202">WMI 會執行非同步作業，並在作業完成時呼叫事件處理常式副程式來通知腳本。</span><span class="sxs-lookup"><span data-stu-id="f4e56-202">WMI performs the asynchronous operation and notifies the script by calling the event handler subroutine when the operation is complete.</span></span>
-   <span data-ttu-id="f4e56-203">**半同步**。</span><span class="sxs-lookup"><span data-stu-id="f4e56-203">**Semisynchronous**.</span></span> <span data-ttu-id="f4e56-204">半同步模式是同步與非同步之間的折衷。</span><span class="sxs-lookup"><span data-stu-id="f4e56-204">Semisynchronous mode is a compromise between synchronous and asynchronous.</span></span> <span data-ttu-id="f4e56-205">多工作業提供比同步作業更佳的效能，但不需要額外的知識和腳本步驟來處理非同步作業。</span><span class="sxs-lookup"><span data-stu-id="f4e56-205">Semisynchronous operations offer better performance than synchronous operations, yet they do not require the extra knowledge and scripting steps necessary to handle asynchronous operations.</span></span> <span data-ttu-id="f4e56-206">這是大部分 WMI 查詢的預設操作類型。</span><span class="sxs-lookup"><span data-stu-id="f4e56-206">This is the default operation type for most WMI queries.</span></span>

    <span data-ttu-id="f4e56-207">在半同步模式中，您的腳本會呼叫六個數據抓取方法的其中一個，並立即傳回。</span><span class="sxs-lookup"><span data-stu-id="f4e56-207">In semisynchronous mode, your script calls one of the six data retrieval methods and returns immediately.</span></span> <span data-ttu-id="f4e56-208">當您的腳本繼續執行時，WMI 會在背景中抓取受控資源。</span><span class="sxs-lookup"><span data-stu-id="f4e56-208">WMI retrieves the managed resources in the background as your script continues to run.</span></span> <span data-ttu-id="f4e56-209">當資源被抓取時，它們會透過 Swbemobjectset 搭配使用立即傳回到您的腳本。</span><span class="sxs-lookup"><span data-stu-id="f4e56-209">As the resources are retrieved, they are immediately returned to your script by way of an SWbemObjectSet.</span></span> <span data-ttu-id="f4e56-210">您可以開始存取受管理的資源，而不需等候整個集合組合。</span><span class="sxs-lookup"><span data-stu-id="f4e56-210">You can begin to access the managed resources without waiting for the entire collection to be assembled.</span></span>

    <span data-ttu-id="f4e56-211">當您使用的受控資源具有許多實例 (許多意義大於 1000) （例如 [**CIM \_ 資料檔案**](/windows/desktop/CIMWin32Prov/cim-datafile) 和 [**Win32 \_ NTLogEvent**](/previous-versions/windows/desktop/eventlogprov/win32-ntlogevent)）時，會對這項作業有一點注意。</span><span class="sxs-lookup"><span data-stu-id="f4e56-211">There is a caveat to semisynchronous operations when you are working with managed resources that have many instances (many meaning greater than 1,000), such as [**CIM\_DataFile**](/windows/desktop/CIMWin32Prov/cim-datafile) and [**Win32\_NTLogEvent**](/previous-versions/windows/desktop/eventlogprov/win32-ntlogevent).</span></span> <span data-ttu-id="f4e56-212">警告是 WMI 處理 managed 資源實例的結果。</span><span class="sxs-lookup"><span data-stu-id="f4e56-212">The caveat is a result of how WMI handles instances of managed resources.</span></span> <span data-ttu-id="f4e56-213">針對 managed 資源的每個實例，WMI 會建立並快取 [**SWbemObject**](swbemobject.md) 物件。</span><span class="sxs-lookup"><span data-stu-id="f4e56-213">For each instance of a managed resource, WMI creates and caches an [**SWbemObject**](swbemobject.md) object.</span></span> <span data-ttu-id="f4e56-214">當受控資源有大量的實例時，實例抓取可以獨佔可用的資源，同時降低腳本和電腦的效能。</span><span class="sxs-lookup"><span data-stu-id="f4e56-214">When a large number of instances exist for a managed resource, instance retrieval can monopolize available resources, reducing the performance of both the script and the computer.</span></span>

    <span data-ttu-id="f4e56-215">若要解決此問題，您可以使用 **wbemFlagForwardOnly** 旗標來優化最半執行的方法呼叫。</span><span class="sxs-lookup"><span data-stu-id="f4e56-215">To work around the problem, you can optimize semisynchronous method calls using the **wbemFlagForwardOnly** flag.</span></span> <span data-ttu-id="f4e56-216">**WbemFlagForwardOnly** 旗標（結合 **wbemFlagReturnImmediately** 旗標 (預設的最高值旗標) ）會告知 WMI 傳回順向 [**swbemobjectset 搭配使用**](swbemobjectset.md)，以消除大型資料集效能問題。</span><span class="sxs-lookup"><span data-stu-id="f4e56-216">The **wbemFlagForwardOnly** flag, combined with the **wbemFlagReturnImmediately** flag (the default semisynchronous flag), tells WMI to return a forward-only [**SWbemObjectSet**](swbemobjectset.md), which eliminates the large data set performance problem.</span></span> <span data-ttu-id="f4e56-217">不過，使用 **wbemFlagForwardOnly** 旗標會產生成本。</span><span class="sxs-lookup"><span data-stu-id="f4e56-217">However, using the **wbemFlagForwardOnly** flag comes with a cost.</span></span> <span data-ttu-id="f4e56-218">只能列舉順向 **swbemobjectset 搭配使用** 一次。</span><span class="sxs-lookup"><span data-stu-id="f4e56-218">A forward-only **SWbemObjectSet** can be enumerated only once.</span></span> <span data-ttu-id="f4e56-219">存取順向 **swbemobjectset 搭配使用** 中的每個 [**SWbemObject**](swbemobject.md)之後，就會釋放配置給實例的記憶體。</span><span class="sxs-lookup"><span data-stu-id="f4e56-219">After each [**SWbemObject**](swbemobject.md) in a forward-only **SWbemObjectSet** is accessed, the memory allocated to the instance is released.</span></span>

<span data-ttu-id="f4e56-220">除了 [**Delete**](swbemservices-delete.md)、 [**ExecMethod**](swbemservices-execmethod.md)、 [**Get**](swbemservices-get.md)和九個非同步方法之外，最半處理是預設和建議的作業模式。</span><span class="sxs-lookup"><span data-stu-id="f4e56-220">With the exception of the [**Delete**](swbemservices-delete.md), [**ExecMethod**](swbemservices-execmethod.md), [**Get**](swbemservices-get.md), and nine asynchronous methods, semisynchronous is the default and recommended mode of operation.</span></span>

<span data-ttu-id="f4e56-221">**常用的方法**</span><span class="sxs-lookup"><span data-stu-id="f4e56-221">**Commonly-used Methods**</span></span>

<span data-ttu-id="f4e56-222">系統管理腳本中最常用的方法是 [**InstancesOf**](swbemservices-instancesof.md)、 [**ExecQuery**](swbemservices-execquery.md)、 [**Get**](swbemservices-get.md)和 [**ExecNotificationQuery**](swbemservices-execnotificationquery.md)。</span><span class="sxs-lookup"><span data-stu-id="f4e56-222">The methods most often used in system administration scripts are [**InstancesOf**](swbemservices-instancesof.md), [**ExecQuery**](swbemservices-execquery.md), [**Get**](swbemservices-get.md), and [**ExecNotificationQuery**](swbemservices-execnotificationquery.md).</span></span> <span data-ttu-id="f4e56-223">雖然通常會使用 **InstancesOf** ，但不一定是取得資訊 (的建議方式，雖然這是) 的最簡單方式。</span><span class="sxs-lookup"><span data-stu-id="f4e56-223">Although often used, **InstancesOf** is not necessarily the recommended way to retrieve information (although it is arguably the easiest way).</span></span>

## <a name="requirements"></a><span data-ttu-id="f4e56-224">規格需求</span><span class="sxs-lookup"><span data-stu-id="f4e56-224">Requirements</span></span>



| <span data-ttu-id="f4e56-225">需求</span><span class="sxs-lookup"><span data-stu-id="f4e56-225">Requirement</span></span> | <span data-ttu-id="f4e56-226">值</span><span class="sxs-lookup"><span data-stu-id="f4e56-226">Value</span></span> |
|-------------------------------------|-----------------------------------------------------------------------------------------|
| <span data-ttu-id="f4e56-227">最低支援的用戶端</span><span class="sxs-lookup"><span data-stu-id="f4e56-227">Minimum supported client</span></span><br/> | <span data-ttu-id="f4e56-228">Windows Vista</span><span class="sxs-lookup"><span data-stu-id="f4e56-228">Windows Vista</span></span><br/>                                                                |
| <span data-ttu-id="f4e56-229">最低支援的伺服器</span><span class="sxs-lookup"><span data-stu-id="f4e56-229">Minimum supported server</span></span><br/> | <span data-ttu-id="f4e56-230">Windows Server 2008</span><span class="sxs-lookup"><span data-stu-id="f4e56-230">Windows Server 2008</span></span><br/>                                                          |
| <span data-ttu-id="f4e56-231">標頭</span><span class="sxs-lookup"><span data-stu-id="f4e56-231">Header</span></span><br/>                   | <dl> <span data-ttu-id="f4e56-232"><dt>>wbemdisp.tlb。h</dt></span><span class="sxs-lookup"><span data-stu-id="f4e56-232"><dt>Wbemdisp.h</dt></span></span> </dl>   |
| <span data-ttu-id="f4e56-233">類型程式庫</span><span class="sxs-lookup"><span data-stu-id="f4e56-233">Type library</span></span><br/>             | <dl> <span data-ttu-id="f4e56-234"><dt>>wbemdisp.tlb .tlb</dt></span><span class="sxs-lookup"><span data-stu-id="f4e56-234"><dt>Wbemdisp.tlb</dt></span></span> </dl> |
| <span data-ttu-id="f4e56-235">DLL</span><span class="sxs-lookup"><span data-stu-id="f4e56-235">DLL</span></span><br/>                      | <dl> <span data-ttu-id="f4e56-236"><dt>Wbemdisp.dll</dt></span><span class="sxs-lookup"><span data-stu-id="f4e56-236"><dt>Wbemdisp.dll</dt></span></span> </dl> |
| <span data-ttu-id="f4e56-237">CLSID</span><span class="sxs-lookup"><span data-stu-id="f4e56-237">CLSID</span></span><br/>                    | <span data-ttu-id="f4e56-238">CLSID \_ SWbemServices</span><span class="sxs-lookup"><span data-stu-id="f4e56-238">CLSID\_SWbemServices</span></span><br/>                                                         |
| <span data-ttu-id="f4e56-239">IID</span><span class="sxs-lookup"><span data-stu-id="f4e56-239">IID</span></span><br/>                      | <span data-ttu-id="f4e56-240">IID \_ ISWbemServices</span><span class="sxs-lookup"><span data-stu-id="f4e56-240">IID\_ISWbemServices</span></span><br/>                                                          |



## <a name="see-also"></a><span data-ttu-id="f4e56-241">另請參閱</span><span class="sxs-lookup"><span data-stu-id="f4e56-241">See also</span></span>

<dl> <dt>

[<span data-ttu-id="f4e56-242">腳本 API 物件</span><span class="sxs-lookup"><span data-stu-id="f4e56-242">Scripting API Objects</span></span>](scripting-api-objects.md)
</dt> <dt>

[<span data-ttu-id="f4e56-243">呼叫方法</span><span class="sxs-lookup"><span data-stu-id="f4e56-243">Calling a Method</span></span>](calling-a-method.md)
</dt> </dl>

 

