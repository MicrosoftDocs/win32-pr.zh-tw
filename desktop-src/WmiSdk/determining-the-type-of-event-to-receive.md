---
description: 在您註冊以接收事件之前，您必須決定要接收的事件種類：內部或外部。
ms.assetid: 46cdfcfa-42c6-4169-bc4d-725867224889
ms.tgt_platform: multiple
title: 判斷要接收的事件種類
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 477f3d10536e5b0622e1e64b6cec9abdf4183c7d
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/08/2021
ms.locfileid: "103693987"
---
# <a name="determining-the-type-of-event-to-receive"></a><span data-ttu-id="35719-103">判斷要接收的事件種類</span><span class="sxs-lookup"><span data-stu-id="35719-103">Determining the Type of Event to Receive</span></span>

<span data-ttu-id="35719-104">在您註冊以接收事件之前，您必須決定要接收的事件種類： [內部](#intrinsic-events) 或 [外部](#extrinsic-events)。</span><span class="sxs-lookup"><span data-stu-id="35719-104">Before you register to receive an event, you must determine the types of events to receive: [intrinsic](#intrinsic-events) or [extrinsic](#extrinsic-events).</span></span> <span data-ttu-id="35719-105">如需如何接收事件的詳細資訊，請參閱 [接收 WMI 事件](receiving-a-wmi-event.md)。</span><span class="sxs-lookup"><span data-stu-id="35719-105">For more information about how to receive events, see [Receiving a WMI Event](receiving-a-wmi-event.md).</span></span> <span data-ttu-id="35719-106">如需有關提供事件的詳細資訊，請參閱 [開發 WMI 提供者](developing-a-wmi-provider.md) 和 [撰寫事件提供者](writing-an-event-provider.md)。</span><span class="sxs-lookup"><span data-stu-id="35719-106">For more information about providing events, see [Developing a WMI Provider](developing-a-wmi-provider.md) and [Writing an Event Provider](writing-an-event-provider.md).</span></span> <span data-ttu-id="35719-107">如需有關接收和提供事件之安全性考慮的詳細資訊，請參閱 [保護 WMI 事件。](securing-wmi-events.md)</span><span class="sxs-lookup"><span data-stu-id="35719-107">For more information about the security concerns for receiving and providing events, see [Securing WMI Events.](securing-wmi-events.md)</span></span>

## <a name="intrinsic-events"></a><span data-ttu-id="35719-108">內建事件</span><span class="sxs-lookup"><span data-stu-id="35719-108">Intrinsic Events</span></span>

<span data-ttu-id="35719-109">內建事件是回應標準 WMI 資料模型變更時所發生的事件。</span><span class="sxs-lookup"><span data-stu-id="35719-109">An intrinsic event is an event that occurs in response to a change in the standard WMI data model.</span></span> <span data-ttu-id="35719-110">每個內建事件類別都表示特定的變更類型，並且會在 WMI 或提供者建立、刪除或修改命名空間、類別或類別執行個體時發生。</span><span class="sxs-lookup"><span data-stu-id="35719-110">Each intrinsic event class represents a specific type of change and occurs when WMI or a provider creates, deletes, or modifies a namespace, class, or class instance.</span></span> <span data-ttu-id="35719-111">例如，建立 [**Win32 \_ LogicalDisk**](/windows/desktop/CIMWin32Prov/win32-logicaldisk)實例會導致 [**\_ \_ InstanceCreationEvent**](--instancecreationevent.md)實例。</span><span class="sxs-lookup"><span data-stu-id="35719-111">For example, the creation of a [**Win32\_LogicalDisk**](/windows/desktop/CIMWin32Prov/win32-logicaldisk) instance would result in an [**\_\_InstanceCreationEvent**](--instancecreationevent.md) instance.</span></span>

<span data-ttu-id="35719-112">WMI 會針對儲存在 WMI 儲存機制中的物件建立內部事件。</span><span class="sxs-lookup"><span data-stu-id="35719-112">WMI creates intrinsic events for objects stored in the WMI repository.</span></span> <span data-ttu-id="35719-113">提供者會為動態類別產生內建事件，但如果沒有可用的提供者，WMI 可以建立動態類別的實例。</span><span class="sxs-lookup"><span data-stu-id="35719-113">A provider generates intrinsic events for dynamic classes, but WMI can create an instance for a dynamic class if no provider is available.</span></span> <span data-ttu-id="35719-114">WMI 會使用輪詢來偵測變更。</span><span class="sxs-lookup"><span data-stu-id="35719-114">WMI uses polling to detect the changes.</span></span> <span data-ttu-id="35719-115">下表列出 WMI 用來報告內部事件的系統類別。</span><span class="sxs-lookup"><span data-stu-id="35719-115">The following table lists the system classes that WMI uses to report intrinsic events.</span></span>



| <span data-ttu-id="35719-116">System 類別</span><span class="sxs-lookup"><span data-stu-id="35719-116">System class</span></span>                                                           | <span data-ttu-id="35719-117">Description</span><span class="sxs-lookup"><span data-stu-id="35719-117">Description</span></span>                                                                                                                                                                                             |
|------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="35719-118">**\_\_ClassCreationEvent**</span><span class="sxs-lookup"><span data-stu-id="35719-118">**\_\_ClassCreationEvent**</span></span>](--classcreationevent.md)                 | <span data-ttu-id="35719-119">在建立類別時通知取用者。</span><span class="sxs-lookup"><span data-stu-id="35719-119">Notifies a consumer when a class is created.</span></span>                                                                                                                                                            |
| [<span data-ttu-id="35719-120">**\_\_ClassDeletionEvent**</span><span class="sxs-lookup"><span data-stu-id="35719-120">**\_\_ClassDeletionEvent**</span></span>](--classdeletionevent.md)                 | <span data-ttu-id="35719-121">在類別刪除時通知取用者。</span><span class="sxs-lookup"><span data-stu-id="35719-121">Notifies a consumer when a class is deleted.</span></span>                                                                                                                                                            |
| [<span data-ttu-id="35719-122">**\_\_ClassModificationEvent**</span><span class="sxs-lookup"><span data-stu-id="35719-122">**\_\_ClassModificationEvent**</span></span>](--classmodificationevent.md)         | <span data-ttu-id="35719-123">在類別修改時通知取用者。</span><span class="sxs-lookup"><span data-stu-id="35719-123">Notifies a consumer when a class is modified.</span></span>                                                                                                                                                           |
| [<span data-ttu-id="35719-124">**\_\_InstanceCreationEvent**</span><span class="sxs-lookup"><span data-stu-id="35719-124">**\_\_InstanceCreationEvent**</span></span>](--instancecreationevent.md)           | <span data-ttu-id="35719-125">建立類別實例時通知取用者。</span><span class="sxs-lookup"><span data-stu-id="35719-125">Notifies a consumer when a class instance is created.</span></span>                                                                                                                                                   |
| [<span data-ttu-id="35719-126">**\_\_InstanceOperationEvent**</span><span class="sxs-lookup"><span data-stu-id="35719-126">**\_\_InstanceOperationEvent**</span></span>](--instanceoperationevent.md)         | <span data-ttu-id="35719-127">當發生任何實例事件時（例如建立、刪除或修改實例），通知取用者。</span><span class="sxs-lookup"><span data-stu-id="35719-127">Notifies a consumer when any instance event occurs, such as creation, deletion, or modification of the instance.</span></span> <span data-ttu-id="35719-128">您可以在查詢中使用這個類別，以取得與實例相關聯的所有類型事件。</span><span class="sxs-lookup"><span data-stu-id="35719-128">You can use this class in queries to get all types events associated with an instance.</span></span> |
| [<span data-ttu-id="35719-129">**\_\_InstanceDeletionEvent**</span><span class="sxs-lookup"><span data-stu-id="35719-129">**\_\_InstanceDeletionEvent**</span></span>](--instancedeletionevent.md)           | <span data-ttu-id="35719-130">刪除實例時通知取用者。</span><span class="sxs-lookup"><span data-stu-id="35719-130">Notifies a consumer when an instance is deleted.</span></span>                                                                                                                                                        |
| [<span data-ttu-id="35719-131">**\_\_InstanceModificationEvent**</span><span class="sxs-lookup"><span data-stu-id="35719-131">**\_\_InstanceModificationEvent**</span></span>](--instancemodificationevent.md)   | <span data-ttu-id="35719-132">在修改實例時通知取用者。</span><span class="sxs-lookup"><span data-stu-id="35719-132">Notifies a consumer when an instance is modified.</span></span>                                                                                                                                                       |
| [<span data-ttu-id="35719-133">**\_\_NamespaceCreationEvent**</span><span class="sxs-lookup"><span data-stu-id="35719-133">**\_\_NamespaceCreationEvent**</span></span>](--namespacecreationevent.md)         | <span data-ttu-id="35719-134">建立命名空間時通知取用者。</span><span class="sxs-lookup"><span data-stu-id="35719-134">Notifies a consumer when a namespace is created.</span></span>                                                                                                                                                        |
| [<span data-ttu-id="35719-135">**\_\_NamespaceDeletionEvent**</span><span class="sxs-lookup"><span data-stu-id="35719-135">**\_\_NamespaceDeletionEvent**</span></span>](--namespacedeletionevent.md)         | <span data-ttu-id="35719-136">刪除命名空間時通知取用者。</span><span class="sxs-lookup"><span data-stu-id="35719-136">Notifies a consumer when a namespace is deleted.</span></span>                                                                                                                                                        |
| [<span data-ttu-id="35719-137">**\_\_NamespaceModificationEvent**</span><span class="sxs-lookup"><span data-stu-id="35719-137">**\_\_NamespaceModificationEvent**</span></span>](--namespacemodificationevent.md) | <span data-ttu-id="35719-138">在命名空間遭到修改時通知取用者。</span><span class="sxs-lookup"><span data-stu-id="35719-138">Notifies a consumer when a namespace is modified.</span></span>                                                                                                                                                       |
| [<span data-ttu-id="35719-139">**\_\_ConsumerFailureEvent**</span><span class="sxs-lookup"><span data-stu-id="35719-139">**\_\_ConsumerFailureEvent**</span></span>](--consumerfailureevent.md)             | <span data-ttu-id="35719-140">當某些其他事件因為事件取用者的一部分而發生失敗時，通知取用者。</span><span class="sxs-lookup"><span data-stu-id="35719-140">Notifies a consumer when some other event is dropped due to a failure on the part of an event consumer.</span></span>                                                                                                 |
| [<span data-ttu-id="35719-141">**\_\_EventDroppedEvent**</span><span class="sxs-lookup"><span data-stu-id="35719-141">**\_\_EventDroppedEvent**</span></span>](--eventdroppedevent.md)                   | <span data-ttu-id="35719-142">當某些其他事件遭到捨棄而不是傳遞給提出要求的事件取用者時，通知取用者。</span><span class="sxs-lookup"><span data-stu-id="35719-142">Notifies a consumer when some other event is dropped instead of being delivered to the requesting event consumer.</span></span>                                                                                       |
| [<span data-ttu-id="35719-143">**\_\_EventQueueOverflowEvent**</span><span class="sxs-lookup"><span data-stu-id="35719-143">**\_\_EventQueueOverflowEvent**</span></span>](--eventqueueoverflowevent.md)       | <span data-ttu-id="35719-144">當傳遞佇列溢位的結果卸載事件時，通知取用者。</span><span class="sxs-lookup"><span data-stu-id="35719-144">Notifies a consumer when an event is dropped as a result of a delivery queue overflow.</span></span>                                                                                                                  |
| [<span data-ttu-id="35719-145">**\_\_MethodInvocationEvent**</span><span class="sxs-lookup"><span data-stu-id="35719-145">**\_\_MethodInvocationEvent**</span></span>](--methodinvocationevent.md)           | <span data-ttu-id="35719-146">在方法呼叫事件發生時通知取用者。</span><span class="sxs-lookup"><span data-stu-id="35719-146">Notifies a consumer when a method call event occurs.</span></span>                                                                                                                                                    |



 

## <a name="extrinsic-events"></a><span data-ttu-id="35719-147">外來事件</span><span class="sxs-lookup"><span data-stu-id="35719-147">Extrinsic Events</span></span>

<span data-ttu-id="35719-148">外建事件是預先定義的出現專案，無法直接連結至 WMI 資料模型中的變更。</span><span class="sxs-lookup"><span data-stu-id="35719-148">An extrinsic event is a predefined occurrence that cannot be linked directly to changes in the WMI data model.</span></span> <span data-ttu-id="35719-149">因此，WMI 會讓事件提供者定義描述事件的事件類別。</span><span class="sxs-lookup"><span data-stu-id="35719-149">Therefore, WMI enables an event provider to define an event class that describes the event.</span></span> <span data-ttu-id="35719-150">例如，描述切換至「待命」模式之電腦的事件是外來事件。</span><span class="sxs-lookup"><span data-stu-id="35719-150">For example, an event that describes a computer switching to stand-by mode is an extrinsic event.</span></span> <span data-ttu-id="35719-151">提供者衍生自 [**\_ \_ ExtrinsicEvent**](--extrinsicevent.md)系統類別的外建事件，這是 [**\_ \_ 事件**](--event.md)系統類別的子類別。</span><span class="sxs-lookup"><span data-stu-id="35719-151">A provider derives an extrinsic event from the [**\_\_ExtrinsicEvent**](--extrinsicevent.md) system class, which is a subclass of the [**\_\_Event**](--event.md) system class.</span></span> <span data-ttu-id="35719-152">[系統登錄](/previous-versions/windows/desktop/regprov/system-registry-provider)和 [SNMP](snmp-provider.md)提供者會定義外建事件類別，例如 **RegistryKeyChangeEvent**，這會在登錄機碼變更時通知取用者。</span><span class="sxs-lookup"><span data-stu-id="35719-152">The [System Registry](/previous-versions/windows/desktop/regprov/system-registry-provider) and [SNMP](snmp-provider.md) providers define extrinsic event classes, such as **RegistryKeyChangeEvent**, which notifies a consumer when a registry key is changed.</span></span> <span data-ttu-id="35719-153">如需詳細資訊，請參閱 [註冊系統登錄事件](registering-for-system-registry-events.md) 和 [寫入事件提供者](writing-an-event-provider.md)。</span><span class="sxs-lookup"><span data-stu-id="35719-153">For more information, see [Registering for System Registry Events](registering-for-system-registry-events.md) and [Writing an Event Provider](writing-an-event-provider.md).</span></span>

<span data-ttu-id="35719-154">在下列範例中，事件提供者會向一或多個大樓報告安全性違規。</span><span class="sxs-lookup"><span data-stu-id="35719-154">In the following example, an event provider is reporting security violations to one or more buildings.</span></span> <span data-ttu-id="35719-155">您可以針對代表安全性違規的外來事件定義下列類別。</span><span class="sxs-lookup"><span data-stu-id="35719-155">The following class might be defined for the extrinsic event representing a security violation.</span></span>

``` syntax
class SecurityViolationEvent : __ExtrinsicEvent
{
   string Building;           // building where violation occurred
   sint32 EntranceNumber;     // entrance where violation occurred
   datetime TimeOfDetection;  // date and time of violation
}
```

<span data-ttu-id="35719-156">若要接收安全性違規通知，取用者會註冊 SecurityViolationEvent 事件種類。</span><span class="sxs-lookup"><span data-stu-id="35719-156">To receive the security violation notifications, a consumer registers for the SecurityViolationEvent event type.</span></span> <span data-ttu-id="35719-157">除非另有指定，否則取用者會收到所有時間週期和所有大樓中所有安全性違規的通知。</span><span class="sxs-lookup"><span data-stu-id="35719-157">Unless otherwise specified, a consumer receives notification of all security violations during all time periods and in all buildings.</span></span> <span data-ttu-id="35719-158">事件類別也包含取用者可用來要求更多特定事件的資訊。</span><span class="sxs-lookup"><span data-stu-id="35719-158">The event class also contains information that consumers can use to ask for more specific events.</span></span>

<span data-ttu-id="35719-159">在下列範例中，查詢只會在建立24中註冊安全性違規事件的取用者。</span><span class="sxs-lookup"><span data-stu-id="35719-159">In the following example, the query registers the consumer for security violation events in building 24 only.</span></span>

`SELECT * FROM SecurityViolationEvent WHERE Building = 24;`

 

 
