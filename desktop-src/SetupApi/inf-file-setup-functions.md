---
description: 下列安裝程式 API 函式會搭配 INF 檔案使用。
ms.assetid: fb4263fc-5f59-460a-a7d9-93f10729c02a
title: INF 檔案設定函數
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 24944f19938217d40ff4a7eaebbfb638c26e4afb
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/08/2021
ms.locfileid: "106984622"
---
# <a name="inf-file-setup-functions"></a><span data-ttu-id="5ecff-103">INF 檔案設定函數</span><span class="sxs-lookup"><span data-stu-id="5ecff-103">INF File Setup Functions</span></span>

<span data-ttu-id="5ecff-104">下列安裝程式 API 函式會搭配 INF 檔案使用。</span><span class="sxs-lookup"><span data-stu-id="5ecff-104">The following Setup API functions are used with INF Files.</span></span>



| <span data-ttu-id="5ecff-105">函式</span><span class="sxs-lookup"><span data-stu-id="5ecff-105">Function</span></span>                                                                         | <span data-ttu-id="5ecff-106">描述</span><span class="sxs-lookup"><span data-stu-id="5ecff-106">Description</span></span>                                                                                                                                                                                            |
|----------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="5ecff-107">**SetupCloseInfFile**</span><span class="sxs-lookup"><span data-stu-id="5ecff-107">**SetupCloseInfFile**</span></span>](/windows/desktop/api/Setupapi/nf-setupapi-setupcloseinffile)                                   | <span data-ttu-id="5ecff-108">釋出資源並關閉 INF 控制碼。</span><span class="sxs-lookup"><span data-stu-id="5ecff-108">Frees resources and closes the INF handle.</span></span>                                                                                                                                                             |
| [<span data-ttu-id="5ecff-109">**SetupDecompressOrCopyFile**</span><span class="sxs-lookup"><span data-stu-id="5ecff-109">**SetupDecompressOrCopyFile**</span></span>](/windows/desktop/api/Setupapi/nf-setupapi-setupdecompressorcopyfilea)                   | <span data-ttu-id="5ecff-110">複製檔案，並視需要將它解壓縮。</span><span class="sxs-lookup"><span data-stu-id="5ecff-110">Copies a file and, if necessary, decompresses it.</span></span>                                                                                                                                                      |
| [<span data-ttu-id="5ecff-111">**SetupFindFirstLine**</span><span class="sxs-lookup"><span data-stu-id="5ecff-111">**SetupFindFirstLine**</span></span>](/windows/desktop/api/Setupapi/nf-setupapi-setupfindfirstlinea)                                 | <span data-ttu-id="5ecff-112">尋找 INF 檔案區段中的第一行，如果指定了金鑰，就會找到符合該金鑰的第一行。</span><span class="sxs-lookup"><span data-stu-id="5ecff-112">Finds the first line in a section of an INF file or, if a key is specified, the first line that matches that key.</span></span> <span data-ttu-id="5ecff-113">它會更新 [**INFCONTEXT**](/windows/desktop/api/Setupapi/ns-setupapi-infcontext)結構的 **行** 成員。</span><span class="sxs-lookup"><span data-stu-id="5ecff-113">It updates the **Line** member of an [**INFCONTEXT**](/windows/desktop/api/Setupapi/ns-setupapi-infcontext) structure.</span></span> |
| [<span data-ttu-id="5ecff-114">**SetupFindNextLine**</span><span class="sxs-lookup"><span data-stu-id="5ecff-114">**SetupFindNextLine**</span></span>](/windows/desktop/api/Setupapi/nf-setupapi-setupfindnextline)                                   | <span data-ttu-id="5ecff-115">傳回區段中相對於指定 [**INFCONTEXT**](/windows/desktop/api/Setupapi/ns-setupapi-infcontext)結構的 **行** 成員的下一行。</span><span class="sxs-lookup"><span data-stu-id="5ecff-115">Returns the next line in a section relative to the **Line** member of the specified [**INFCONTEXT**](/windows/desktop/api/Setupapi/ns-setupapi-infcontext) structure.</span></span>                                                                    |
| [<span data-ttu-id="5ecff-116">**SetupFindNextMatchLine**</span><span class="sxs-lookup"><span data-stu-id="5ecff-116">**SetupFindNextMatchLine**</span></span>](/windows/desktop/api/Setupapi/nf-setupapi-setupfindnextmatchlinea)                         | <span data-ttu-id="5ecff-117">傳回區段中相對於符合指定索引鍵之指定 [**INFCONTEXT**](/windows/desktop/api/Setupapi/ns-setupapi-infcontext)的 **行** 成員的下一行。</span><span class="sxs-lookup"><span data-stu-id="5ecff-117">Returns the next line in a section relative to the **Line** member of the specified [**INFCONTEXT**](/windows/desktop/api/Setupapi/ns-setupapi-infcontext) that matches a specified key.</span></span>                                                 |
| [<span data-ttu-id="5ecff-118">**SetupGetBinaryField**</span><span class="sxs-lookup"><span data-stu-id="5ecff-118">**SetupGetBinaryField**</span></span>](/windows/desktop/api/Setupapi/nf-setupapi-setupgetbinaryfield)                               | <span data-ttu-id="5ecff-119">從其欄位為二進位格式的行中取出資料。</span><span class="sxs-lookup"><span data-stu-id="5ecff-119">Retrieves data from a line whose fields are in binary format.</span></span>                                                                                                                                          |
| [<span data-ttu-id="5ecff-120">**SetupGetFieldCount**</span><span class="sxs-lookup"><span data-stu-id="5ecff-120">**SetupGetFieldCount**</span></span>](/windows/desktop/api/Setupapi/nf-setupapi-setupgetfieldcount)                                 | <span data-ttu-id="5ecff-121">傳回線條中的欄位數目。</span><span class="sxs-lookup"><span data-stu-id="5ecff-121">Returns the number of fields in a line.</span></span>                                                                                                                                                                |
| [<span data-ttu-id="5ecff-122">**SetupGetFileCompressionInfo**</span><span class="sxs-lookup"><span data-stu-id="5ecff-122">**SetupGetFileCompressionInfo**</span></span>](/windows/desktop/api/Setupapi/nf-setupapi-setupgetfilecompressioninfoa)               | <span data-ttu-id="5ecff-123">從 INF 檔案抓取檔案壓縮資訊。</span><span class="sxs-lookup"><span data-stu-id="5ecff-123">Retrieves file compression information from an INF file.</span></span>                                                                                                                                               |
| [<span data-ttu-id="5ecff-124">**SetupGetInfFileList**</span><span class="sxs-lookup"><span data-stu-id="5ecff-124">**SetupGetInfFileList**</span></span>](/windows/desktop/api/Setupapi/nf-setupapi-setupgetinffilelista)                               | <span data-ttu-id="5ecff-125">取得指定目錄中的 INF 檔案類型清單。</span><span class="sxs-lookup"><span data-stu-id="5ecff-125">Gets a list of the types of INF files in a specified directory.</span></span>                                                                                                                                        |
| [<span data-ttu-id="5ecff-126">**SetupGetInfInformation**</span><span class="sxs-lookup"><span data-stu-id="5ecff-126">**SetupGetInfInformation**</span></span>](/windows/desktop/api/Setupapi/nf-setupapi-setupgetinfinformationa)                         | <span data-ttu-id="5ecff-127">傳回 [**INFCONTEXT**](/windows/desktop/api/Setupapi/ns-setupapi-infcontext)或檔案名) 的 **行** 成員 (之 INF 檔案的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="5ecff-127">Returns information about an INF file (by **Line** member of an [**INFCONTEXT**](/windows/desktop/api/Setupapi/ns-setupapi-infcontext) or filename).</span></span>                                                                                     |
| [<span data-ttu-id="5ecff-128">**SetupGetIntField**</span><span class="sxs-lookup"><span data-stu-id="5ecff-128">**SetupGetIntField**</span></span>](/windows/desktop/api/Setupapi/nf-setupapi-setupgetintfield)                                     | <span data-ttu-id="5ecff-129">傳回 INF 檔案中某一行的指定整數位段。</span><span class="sxs-lookup"><span data-stu-id="5ecff-129">Returns the specified integer field of a line in an INF file.</span></span>                                                                                                                                          |
| [<span data-ttu-id="5ecff-130">**SetupGetLineByIndex**</span><span class="sxs-lookup"><span data-stu-id="5ecff-130">**SetupGetLineByIndex**</span></span>](/windows/desktop/api/Setupapi/nf-setupapi-setupgetlinebyindexa)                               | <span data-ttu-id="5ecff-131">針對指定之區段中指定索引處的行，更新 [**INFCONTEXT**](/windows/desktop/api/Setupapi/ns-setupapi-infcontext)的 **行** 成員。</span><span class="sxs-lookup"><span data-stu-id="5ecff-131">Updates the **Line** member of an [**INFCONTEXT**](/windows/desktop/api/Setupapi/ns-setupapi-infcontext) for the line at a specified index in the specified section.</span></span>                                                                     |
| [<span data-ttu-id="5ecff-132">**SetupGetLineCount**</span><span class="sxs-lookup"><span data-stu-id="5ecff-132">**SetupGetLineCount**</span></span>](/windows/desktop/api/Setupapi/nf-setupapi-setupgetlinecounta)                                   | <span data-ttu-id="5ecff-133">傳回指定區段中的行數。</span><span class="sxs-lookup"><span data-stu-id="5ecff-133">Returns the number of lines in the specified section.</span></span>                                                                                                                                                  |
| [<span data-ttu-id="5ecff-134">**SetupGetLineText**</span><span class="sxs-lookup"><span data-stu-id="5ecff-134">**SetupGetLineText**</span></span>](/windows/desktop/api/Setupapi/nf-setupapi-setupgetlinetexta)                                     | <span data-ttu-id="5ecff-135">從 INF 檔案抓取指定行的內容。</span><span class="sxs-lookup"><span data-stu-id="5ecff-135">Retrieves the content of a specified line from an INF file.</span></span>                                                                                                                                            |
| [<span data-ttu-id="5ecff-136">**SetupGetMultiSzField**</span><span class="sxs-lookup"><span data-stu-id="5ecff-136">**SetupGetMultiSzField**</span></span>](/windows/desktop/api/Setupapi/nf-setupapi-setupgetmultiszfielda)                             | <span data-ttu-id="5ecff-137">從 INF 檔案中的行指定欄位開始，傳回字串清單。</span><span class="sxs-lookup"><span data-stu-id="5ecff-137">Returns a list of strings, starting at the specified field of a line in an INF file.</span></span>                                                                                                                   |
| [<span data-ttu-id="5ecff-138">**SetupGetSourceFileLocation**</span><span class="sxs-lookup"><span data-stu-id="5ecff-138">**SetupGetSourceFileLocation**</span></span>](/windows/desktop/api/Setupapi/nf-setupapi-setupgetsourcefilelocationa)                 | <span data-ttu-id="5ecff-139">取得來源磁片序數和路徑 (相對於來源檔案所在的來源根目錄) </span><span class="sxs-lookup"><span data-stu-id="5ecff-139">Gets the source disk ordinal and path (relative to source root) where the source file is located</span></span>                                                                                                       |
| [<span data-ttu-id="5ecff-140">**SetupGetSourceFileSize**</span><span class="sxs-lookup"><span data-stu-id="5ecff-140">**SetupGetSourceFileSize**</span></span>](/windows/desktop/api/Setupapi/nf-setupapi-setupgetsourcefilesizea)                         | <span data-ttu-id="5ecff-141">取得 INF 檔案中個別原始程式檔或 **複製** 檔案區段的檔案大小。</span><span class="sxs-lookup"><span data-stu-id="5ecff-141">Gets the file size for an individual source file or a **Copy Files** section of an INF file.</span></span>                                                                                                           |
| [<span data-ttu-id="5ecff-142">**SetupGetSourceInfo**</span><span class="sxs-lookup"><span data-stu-id="5ecff-142">**SetupGetSourceInfo**</span></span>](/windows/desktop/api/Setupapi/nf-setupapi-setupgetsourceinfoa)                                 | <span data-ttu-id="5ecff-143">抓取來源的路徑、標記檔案或描述。</span><span class="sxs-lookup"><span data-stu-id="5ecff-143">Retrieves the path, tag file, or description for a source.</span></span>                                                                                                                                             |
| [<span data-ttu-id="5ecff-144">**SetupGetStringField**</span><span class="sxs-lookup"><span data-stu-id="5ecff-144">**SetupGetStringField**</span></span>](/windows/desktop/api/Setupapi/nf-setupapi-setupgetstringfielda)                               | <span data-ttu-id="5ecff-145">傳回 INF 檔案中某一行的指定字串欄位。</span><span class="sxs-lookup"><span data-stu-id="5ecff-145">Returns the specified string field of a line in an INF file.</span></span>                                                                                                                                           |
| [<span data-ttu-id="5ecff-146">**SetupGetTargetPath**</span><span class="sxs-lookup"><span data-stu-id="5ecff-146">**SetupGetTargetPath**</span></span>](/windows/desktop/api/Setupapi/nf-setupapi-setupgettargetpatha)                                 | <span data-ttu-id="5ecff-147">取得 INF 檔案中 **複製** 檔案區段的目標路徑。</span><span class="sxs-lookup"><span data-stu-id="5ecff-147">Gets the target path for a **Copy Files** section in an INF file.</span></span>                                                                                                                                      |
| [<span data-ttu-id="5ecff-148">**SetupInstallFile**</span><span class="sxs-lookup"><span data-stu-id="5ecff-148">**SetupInstallFile**</span></span>](/windows/desktop/api/Setupapi/nf-setupapi-setupinstallfilea)                                     | <span data-ttu-id="5ecff-149">安裝檔案。</span><span class="sxs-lookup"><span data-stu-id="5ecff-149">Installs a file.</span></span>                                                                                                                                                                                       |
| [<span data-ttu-id="5ecff-150">**SetupInstallFileEx**</span><span class="sxs-lookup"><span data-stu-id="5ecff-150">**SetupInstallFileEx**</span></span>](/windows/desktop/api/Setupapi/nf-setupapi-setupinstallfileexa)                                 | <span data-ttu-id="5ecff-151">安裝檔案並傳回變數，指出檔案是否正在使用中。</span><span class="sxs-lookup"><span data-stu-id="5ecff-151">Installs a file and returns a variable indicating whether or not the file was in use.</span></span>                                                                                                                  |
| [<span data-ttu-id="5ecff-152">**SetupInstallFilesFromInfSection**</span><span class="sxs-lookup"><span data-stu-id="5ecff-152">**SetupInstallFilesFromInfSection**</span></span>](/windows/desktop/api/Setupapi/nf-setupapi-setupinstallfilesfrominfsectiona)       | <span data-ttu-id="5ecff-153">將 [ **複製** 檔案]、[ **刪除** 檔案] 和 [ **重新命名** 檔案] 區段中指定的所有檔案排入佇列，以供 **安裝** 區段所列出。</span><span class="sxs-lookup"><span data-stu-id="5ecff-153">Queues all the files specified in the **Copy Files**, **Delete Files**, and **Rename Files** sections that are listed by an **Install** section.</span></span>                                                       |
| [<span data-ttu-id="5ecff-154">**SetupInstallFromInfSection**</span><span class="sxs-lookup"><span data-stu-id="5ecff-154">**SetupInstallFromInfSection**</span></span>](/windows/desktop/api/Setupapi/nf-setupapi-setupinstallfrominfsectiona)                 | <span data-ttu-id="5ecff-155">執行 INF 檔案 **安裝** 區段中指定的指示詞。</span><span class="sxs-lookup"><span data-stu-id="5ecff-155">Performs the directives specified in an INF file **Install** section.</span></span>                                                                                                                                  |
| [<span data-ttu-id="5ecff-156">**SetupInstallServicesFromInfSection**</span><span class="sxs-lookup"><span data-stu-id="5ecff-156">**SetupInstallServicesFromInfSection**</span></span>](/windows/desktop/api/Setupapi/nf-setupapi-setupinstallservicesfrominfsectiona) | <span data-ttu-id="5ecff-157">執行服務安裝和刪除作業，如 INF 檔案的 **服務** 區段中所指定。</span><span class="sxs-lookup"><span data-stu-id="5ecff-157">Performs service installation and deletion operations as specified in a **Service** section of an INF file.</span></span>                                                                                            |
| [<span data-ttu-id="5ecff-158">**SetupOpenAppendInfFile**</span><span class="sxs-lookup"><span data-stu-id="5ecff-158">**SetupOpenAppendInfFile**</span></span>](/windows/desktop/api/Setupapi/nf-setupapi-setupopenappendinffilea)                         | <span data-ttu-id="5ecff-159">開啟 INF 檔案，並將它附加到現有的 INF 控制碼。</span><span class="sxs-lookup"><span data-stu-id="5ecff-159">Opens an INF file and append it to an existing INF handle.</span></span>                                                                                                                                             |
| [<span data-ttu-id="5ecff-160">**SetupOpenInfFile**</span><span class="sxs-lookup"><span data-stu-id="5ecff-160">**SetupOpenInfFile**</span></span>](/windows/desktop/api/Setupapi/nf-setupapi-setupopeninffilea)                                     | <span data-ttu-id="5ecff-161">開啟 INF 檔案，並傳回其控制碼。</span><span class="sxs-lookup"><span data-stu-id="5ecff-161">Opens an INF file and returns a handle to it.</span></span>                                                                                                                                                          |
| [<span data-ttu-id="5ecff-162">**SetupOpenMasterInf**</span><span class="sxs-lookup"><span data-stu-id="5ecff-162">**SetupOpenMasterInf**</span></span>](/windows/desktop/api/Setupapi/nf-setupapi-setupopenmasterinf)                                 | <span data-ttu-id="5ecff-163">開啟 INF 檔案，其中包含系統隨附之檔案的檔案和配置資訊。</span><span class="sxs-lookup"><span data-stu-id="5ecff-163">Opens the INF file that contains file and layout information for files shipped with the system.</span></span>                                                                                                        |
| [<span data-ttu-id="5ecff-164">**SetupQueryInfFileInformation**</span><span class="sxs-lookup"><span data-stu-id="5ecff-164">**SetupQueryInfFileInformation**</span></span>](/windows/desktop/api/Setupapi/nf-setupapi-setupqueryinffileinformationa)             | <span data-ttu-id="5ecff-165">查詢 INF 資訊結構相關的 INF 檔案名。</span><span class="sxs-lookup"><span data-stu-id="5ecff-165">Queries an INF information structure about its associated INF filenames.</span></span>                                                                                                                               |
| [<span data-ttu-id="5ecff-166">**SetupQueryInfVersionInformation**</span><span class="sxs-lookup"><span data-stu-id="5ecff-166">**SetupQueryInfVersionInformation**</span></span>](/windows/desktop/api/Setupapi/nf-setupapi-setupqueryinfversioninformationa)       | <span data-ttu-id="5ecff-167">查詢 INF 資訊結構以取得其中一個構成 INF 檔案的版本資訊。</span><span class="sxs-lookup"><span data-stu-id="5ecff-167">Queries an INF information structure for version information on one of its constituent INF files.</span></span>                                                                                                      |
| [<span data-ttu-id="5ecff-168">**SetupSetDirectoryId**</span><span class="sxs-lookup"><span data-stu-id="5ecff-168">**SetupSetDirectoryId**</span></span>](/windows/desktop/api/Setupapi/nf-setupapi-setupsetdirectoryida)                               | <span data-ttu-id="5ecff-169">將新的目錄識別碼與特定目錄產生關聯。</span><span class="sxs-lookup"><span data-stu-id="5ecff-169">Associates a new directory identifier with a particular directory.</span></span>                                                                                                                                     |



 

 

 



