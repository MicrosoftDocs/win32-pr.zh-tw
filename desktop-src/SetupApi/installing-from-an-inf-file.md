---
description: 從 INF 檔案取出安裝資訊之後，您可以使用數個檔案處理功能來安裝 INF 區段中所列的檔案。
ms.assetid: 4e6042a0-36a9-4f74-b6cc-554e7f7aa2d9
title: 從 INF 檔案安裝
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 6bc3642edfb7abc2864c2c0784c79fbb21612fb9
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/08/2021
ms.locfileid: "103850820"
---
# <a name="installing-from-an-inf-file"></a><span data-ttu-id="b7e06-103">從 INF 檔案安裝</span><span class="sxs-lookup"><span data-stu-id="b7e06-103">Installing From an INF File</span></span>

<span data-ttu-id="b7e06-104">從 INF 檔案取出安裝資訊之後，您可以使用數個檔案處理功能來安裝 INF 區段中所列的檔案。</span><span class="sxs-lookup"><span data-stu-id="b7e06-104">After you retrieve installation information from an INF file, there are several file-handling functions that you can use to install the files listed in an INF section.</span></span> <span data-ttu-id="b7e06-105">低層級的功能（例如 [**SetupInstallFile**](/windows/desktop/api/Setupapi/nf-setupapi-setupinstallfilea) 和 [**SetupInstallFileEx**](/windows/desktop/api/Setupapi/nf-setupapi-setupinstallfileexa) ）會安裝單一檔案。</span><span class="sxs-lookup"><span data-stu-id="b7e06-105">Low-level functions such as [**SetupInstallFile**](/windows/desktop/api/Setupapi/nf-setupapi-setupinstallfilea) and [**SetupInstallFileEx**](/windows/desktop/api/Setupapi/nf-setupapi-setupinstallfileexa) install a single file.</span></span>

<span data-ttu-id="b7e06-106">另外還有一些函數可以處理壓縮檔案。</span><span class="sxs-lookup"><span data-stu-id="b7e06-106">There are also functions to handle compressed files.</span></span> <span data-ttu-id="b7e06-107">[**SetupGetFileCompressionInfo**](/windows/desktop/api/Setupapi/nf-setupapi-setupgetfilecompressioninfoa)函數會傳回壓縮檔案的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="b7e06-107">The [**SetupGetFileCompressionInfo**](/windows/desktop/api/Setupapi/nf-setupapi-setupgetfilecompressioninfoa) function returns information about compressed files.</span></span> <span data-ttu-id="b7e06-108">這項資訊接著可供 [**SetupDecompressOrCopyFile**](/windows/desktop/api/Setupapi/nf-setupapi-setupdecompressorcopyfilea) 用來複製，並在必要時展開檔案。</span><span class="sxs-lookup"><span data-stu-id="b7e06-108">This information can then be used by [**SetupDecompressOrCopyFile**](/windows/desktop/api/Setupapi/nf-setupapi-setupdecompressorcopyfilea) to copy and, if necessary, expand the file.</span></span>

<span data-ttu-id="b7e06-109">高階功能（例如 [**SetupInstallFromInfSection**](/windows/desktop/api/Setupapi/nf-setupapi-setupinstallfrominfsectiona)、 [**SetupInstallFilesFromInfSection**](/windows/desktop/api/Setupapi/nf-setupapi-setupinstallfilesfrominfsectiona)和 [**SetupInstallServicesFromInfSection**](/windows/desktop/api/Setupapi/nf-setupapi-setupinstallservicesfrominfsectiona) ）會在 **安裝** 或 **服務** 區段中處理安裝作業。</span><span class="sxs-lookup"><span data-stu-id="b7e06-109">High-level functions such as [**SetupInstallFromInfSection**](/windows/desktop/api/Setupapi/nf-setupapi-setupinstallfrominfsectiona), [**SetupInstallFilesFromInfSection**](/windows/desktop/api/Setupapi/nf-setupapi-setupinstallfilesfrominfsectiona), and [**SetupInstallServicesFromInfSection**](/windows/desktop/api/Setupapi/nf-setupapi-setupinstallservicesfrominfsectiona) process the installation operations in an **Install** or **Service** section.</span></span> <span data-ttu-id="b7e06-110">其中， **SetupInstallFromInfSection** 是最具彈性的，因為它可以執行在 INF 檔案的 [ **安裝** ] 區段中所列的任何類型的安裝操作。</span><span class="sxs-lookup"><span data-stu-id="b7e06-110">Of these, **SetupInstallFromInfSection** is the most versatile because it can perform any type of installation operation listed in the **Install** section of an INF file.</span></span> <span data-ttu-id="b7e06-111">這包括 **安裝** 區段的 **AddReg**、 **DelReg**、 **UpdateInis** 或 **UpdateIniField** 行中所列的登錄和 INI 作業。</span><span class="sxs-lookup"><span data-stu-id="b7e06-111">This includes the registry and INI operations listed in the **AddReg**, **DelReg**, **UpdateInis**, or **UpdateIniField** lines of an **Install** section.</span></span>

<span data-ttu-id="b7e06-112">[**SetupInstallFilesFromInfSection**](/windows/desktop/api/Setupapi/nf-setupapi-setupinstallfilesfrominfsectiona)和 [**SetupInstallServicesFromInfSection**](/windows/desktop/api/Setupapi/nf-setupapi-setupinstallservicesfrominfsectiona)函式會將 [**安裝** 或 **服務**] 區段中的作業分別排入至現有的檔案佇列。</span><span class="sxs-lookup"><span data-stu-id="b7e06-112">The [**SetupInstallFilesFromInfSection**](/windows/desktop/api/Setupapi/nf-setupapi-setupinstallfilesfrominfsectiona) and [**SetupInstallServicesFromInfSection**](/windows/desktop/api/Setupapi/nf-setupapi-setupinstallservicesfrominfsectiona) functions queue operations from an **Install** or **Service** section, respectively, to an existing file queue.</span></span> <span data-ttu-id="b7e06-113">請注意，您必須分別呼叫 SetupInstallFromInfSection 和 SetupInstallServicesFromInfSection，以佇列作業和服務。</span><span class="sxs-lookup"><span data-stu-id="b7e06-113">Note that you must call SetupInstallFromInfSection and SetupInstallServicesFromInfSection separately to queue operations and services.</span></span> <span data-ttu-id="b7e06-114">如需詳細資訊，請參閱檔案 [佇列](file-queues.md)。</span><span class="sxs-lookup"><span data-stu-id="b7e06-114">For more information, see [File Queues](file-queues.md).</span></span>

<span data-ttu-id="b7e06-115">相反地， [**SetupInstallFromInfSection**](/windows/desktop/api/Setupapi/nf-setupapi-setupinstallfrominfsectiona) 函式會建立並終結其本身的內部佇列。</span><span class="sxs-lookup"><span data-stu-id="b7e06-115">In contrast, the [**SetupInstallFromInfSection**](/windows/desktop/api/Setupapi/nf-setupapi-setupinstallfrominfsectiona) function creates and destroys its own internal queue.</span></span> <span data-ttu-id="b7e06-116">**SetupInstallFromInfSection** 的常見用途是在所有檔案都成功複製之後呼叫它，以執行登錄和 INI 交易。</span><span class="sxs-lookup"><span data-stu-id="b7e06-116">A common use for **SetupInstallFromInfSection** is to call it after all files have been successfully copied to perform the registry and INI transactions.</span></span>

<span data-ttu-id="b7e06-117">在 Windows 2000 上，DLL 檔案可以自行註冊，方法是在其 **安裝** 區段中包含 **RegisterDlls** 指示詞的 INF 檔案上呼叫 [**SetupInstallFromInfSection**](/windows/desktop/api/Setupapi/nf-setupapi-setupinstallfrominfsectiona) 。</span><span class="sxs-lookup"><span data-stu-id="b7e06-117">On Windows 2000, DLL files may be self-registered by calling [**SetupInstallFromInfSection**](/windows/desktop/api/Setupapi/nf-setupapi-setupinstallfrominfsectiona) on an INF file that includes the **RegisterDlls** directive in its **Install** section.</span></span> <span data-ttu-id="b7e06-118">**SetupInstallFromInfSection** 也可以從64位進程自行註冊32位 dll。</span><span class="sxs-lookup"><span data-stu-id="b7e06-118">**SetupInstallFromInfSection** can also self-register 32-bit DLLs from a 64-bit process.</span></span>

<span data-ttu-id="b7e06-119">在64位作業系統上，您可以呼叫 [**SetupInstallFromInfSection**](/windows/desktop/api/Setupapi/nf-setupapi-setupinstallfrominfsectiona) ，以在登錄的32位部分執行作業。</span><span class="sxs-lookup"><span data-stu-id="b7e06-119">On 64-bit operating systems, [**SetupInstallFromInfSection**](/windows/desktop/api/Setupapi/nf-setupapi-setupinstallfrominfsectiona) may be called to perform operations on the 32-bit portion of the registry.</span></span> <span data-ttu-id="b7e06-120">若要將登錄機碼新增至登錄的32位部分，請 \_ \_ 在 INF 的 **ADDREG** 行中包含 FLG ADDREG 32BITKEY 旗標。</span><span class="sxs-lookup"><span data-stu-id="b7e06-120">To add a registry key to the 32-bit portion of the registry, include the FLG\_ADDREG\_32BITKEY flag in the **AddReg** line of the INF.</span></span> <span data-ttu-id="b7e06-121">若只要在登錄的32位部分中刪除登錄機碼，請 \_ \_ 在 **DELREG** 行中包含 FLG DELREG 32BITKEY 機碼。</span><span class="sxs-lookup"><span data-stu-id="b7e06-121">To delete a registry key only in the 32-bit portion of the registry, include the FLG\_DELREG\_32BITKEY key in the **DelReg** line.</span></span> <span data-ttu-id="b7e06-122">若只要在登錄的32位部分中設定或清除二進位值，請 \_ \_ 在 **BITREG** 行中包含 FLG BITREG 32BITKEY。</span><span class="sxs-lookup"><span data-stu-id="b7e06-122">To set or clear a binary value only in the 32-bit portion of the registry, include the FLG\_BITREG\_32BITKEY in the **BitReg** line.</span></span>

<span data-ttu-id="b7e06-123">除了先前所列的函式，安裝程式 API 還包含可將檔案安裝作業（依檔案或 INF 區段）進行佇列的功能。</span><span class="sxs-lookup"><span data-stu-id="b7e06-123">In addition to the functions previously listed, the Setup API includes functions that queue file installation operations, either by file, or by INF section.</span></span> <span data-ttu-id="b7e06-124">如需詳細資訊，請參閱檔案 [佇列](file-queues.md)。</span><span class="sxs-lookup"><span data-stu-id="b7e06-124">For more information, see [File Queues](file-queues.md).</span></span>

 

 



