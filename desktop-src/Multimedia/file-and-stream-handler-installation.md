---
title: 檔案和資料流程處理常式安裝
description: 檔案和資料流程處理常式安裝
ms.assetid: 8d007ea4-b75a-4b3f-965f-8091fcd4cb2f
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: be94137df69ed35b57b1b8fbeb5c9640dd7636d6
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 09/16/2019
ms.locfileid: "103675264"
---
# <a name="file-and-stream-handler-installation"></a>檔案和資料流程處理常式安裝

AVIFile 程式庫會使用已安裝的資料流程和檔案處理常式，來讀取和寫入 AVI 檔案和資料流程。 當處理常式位於 Windows 系統目錄中，且登錄包含描述和識別處理常式所需的下列資訊時，便會安裝處理常式：

-   處理常式的16位元組類別識別碼
-   處理常式的簡短描述
-   包含處理常式的檔案名
-   檔處理常式可以處理的副檔名
-   檔案存取以及與檔案處理常式相關聯的其他屬性
-   四個字元的代碼，可識別串流處理常式可以處理的資料流程類型

AVIFile 程式庫會在開啟檔案和存取資料流程時，查詢應用程式外部的處理常式。 成功查詢的結果會傳回可處理查詢中所指定之檔案或資料流程類型的處理常式檔案名。 登錄會建立具有下列格式的三個專案，以列出每個處理常式：


```C++
[HKEY_CLASSES_ROOT\Clsid\{00010023-0000-0000-C000-000000000046}] 
@="Wave File reader/writer" 
[HKEY_CLASSES_ROOT\Clsid\{00010023-0000-0000-C000- 
000000000046}\InprocServer32] 
@="wavefile.dll" 
"ThreadingModel"="Apartment" 
[HKEY_CLASSES_ROOT\Clsid\{00010023-0000-0000-C000- 
000000000046}\AVIFile] 
@="3" 
 
```



這些專案是由下列部分所組成。



| 部分                                   | 描述                                                                                                                                                                              |
|----------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| HKEY \_ 類別 \_ 根目錄                    | 識別登錄的根專案。                                                                                                                                               |
| Clsid                                  | 將此專案識別為類別識別碼。                                                                                                                                             |
| {00010023-0000-0000-C000-000000000046} | 指定 (IID) 或類別識別碼的介面識別碼。 此值是唯一的16位元組識別碼。  (識別碼也可能在其他手冊中稱為 GUID 或 UUID。 )  |
| Wave 檔案讀取器/寫入器                | 指定描述處理常式的字串。 您可以在對話方塊中顯示此字串，以選取資料流程和檔案處理常式。                                                         |
| InProcServer32                         | 指定此範例中的檔案 (，WAVEFILE.DLL 可載入以處理這個類別的) 。                                                                                              |
| AVIFile                                | 指定檔案處理常式的屬性。 在此範例中，處理常式可以讀取和寫入 AVI 檔。                                                                              |



 

檔案處理常式可以將其一或多個屬性儲存在登錄中。 下列常數會識別目前與檔案相關聯的屬性。



| 常數                        | 描述                                                          |
|---------------------------------|----------------------------------------------------------------------|
| AVIFILEHANDLER \_ CANACCEPTNONRGB | 指出檔案處理常式可以處理 RGB 以外的影像資料。 |
| AVIFILEHANDLER \_ CANREAD         | 指出檔案處理常式可以開啟具有讀取權限的檔案。      |
| AVIFILEHANDLER \_ CANWRITE        | 指出檔案處理常式可以開啟具有寫入權限的檔案。     |



 

建立檔案或資料流程處理常式時，您可以藉由執行 UUIDGEN.EXE 來取得新的識別碼。 請一律使用 UUIDGEN.EXE 來建立新的識別碼。 這個可執行檔所建立的16位元組十六進位數位將會唯一識別您的處理常式。

AVIFile 程式庫會使用登錄中的其他專案，根據檔案處理常式可以處理的副檔名，或是檔案或資料流程處理常式可以處理的四字元程式碼來識別類別識別碼。 例如，下列專案會將類別識別碼與副檔名產生關聯。WAV 和四個字元的代碼「WAVE」：


```C++
[HKEY_CLASSES_ROOT\AVIFile\Extensions\WAV] 
@="{00010023-0000-0000-C000-000000000046}" 
[HKEY_CLASSES_ROOT\AVIFile\RIFFHandlers\WAVE] 
@="{00010023-0000-0000-C000-000000000046}" 
 
```



這些專案是由下列部分所組成。



| 部分                                   | 描述                                                                                       |
|----------------------------------------|---------------------------------------------------------------------------------------------------|
| HKEY \_ 類別 \_ 根目錄                    | 識別登錄的根專案。                                                        |
| AVIFile                                | 將此專案識別為 AVIFile 所使用的專案。                                                |
| 延伸模組                             | 指定在此範例中 (的副檔名。檔案處理常式可以處理的 WAV) 。             |
| RIFFHandlers                           | 指定此範例中的四個字元的程式碼 ("WAVE" ) 檔案或資料流程處理常式可以處理。 |
| {00010023-0000-0000-C000-000000000046} | 指定 (IID) 或類別識別碼的介面識別碼。                                      |



 

如果您在沒有安裝程式的情況下散發資料流程或檔案處理常式，以便將它安裝在使用者的系統中，則必須包含。REG 檔案，讓使用者可以安裝處理常式。 使用者將使用登錄編輯程式來建立您的資料流程或檔案處理常式的登錄專案。

下列範例顯示一般的內容。REG 檔。 下列範例中的第一個專案是處理常式的描述字串。 第二個專案會識別包含處理常式的檔案。 第三個專案會識別檔案處理常式的屬性 (在此案例中為檔案) 的唯讀存取權。 第四個專案會將處理常式所處理的檔案類型與在此案例中的檔案產生關聯 (。JPG 檔案名延伸) 具有類別識別碼。


```C++
[HKEY_CLASSES_ROOT\Clsid\{5C2B8200-E2C8-1068-B1CA-6066188C6002}] 
@="JFIF (JPEG) Files" 
[HKEY_CLASSES_ROOT\Clsid\{5C2B8200-E2C8-1068-B1CA-6066188C6002}]\InprocServer32] 
@="jfiffile.dll" 
[HKEY_CLASSES_ROOT\AVIFile\Extensions\JPG] 
@="{5C2B8200-E2C8-1068-B1CA-6066188C6002}" 
 
```



建立此檔案時，請將它儲存為。登錄延伸模組，用來將它識別為登錄的更新檔案。 此外，請以唯一的 IID 取代範例中所用的16位元組程式碼。

 

 




