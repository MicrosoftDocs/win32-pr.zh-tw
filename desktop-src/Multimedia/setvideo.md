---
title: setvideo 命令
description: Setvideo 命令會設定與影片播放和捕捉相關聯的值。 數位影片和 VCR 裝置會辨識此命令。
ms.assetid: a6851b9b-e09a-4251-bd1c-19b1e4b6f871
keywords:
- setvideo 命令 Windows 多媒體
topic_type:
- apiref
api_name:
- setvideo
api_type:
- NA
ms.topic: reference
ms.date: 05/31/2018
ms.openlocfilehash: 3fa4c3d1e3b90b9ab0c5bf5791dacd541c8a8bc0
ms.sourcegitcommit: a1494c819bc5200050696e66057f1020f5b142cb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 12/12/2020
ms.locfileid: "104384841"
---
# <a name="setvideo-command"></a>setvideo 命令

Setvideo 命令會設定與影片播放和捕捉相關聯的值。 數位影片和 VCR 裝置會辨識此命令。

若要傳送此命令，請使用 *lpszCommand* 參數設定來呼叫 [**mciSendString**](/previous-versions//dd757161(v=vs.85))函式，如下所示。

``` syntax
_stprintf_s(
  lpszCommand, 
  TEXT("setvideo %s %s %s"), 
  lpszDeviceID, 
  lpszVideo, 
  lpszFlags
); 
```

## <a name="parameters"></a>參數

<dl> <dt>

<span id="lpszDeviceID"></span><span id="lpszdeviceid"></span><span id="LPSZDEVICEID"></span>*lpszDeviceID*
</dt> <dd>

MCI 裝置的識別碼。 開啟裝置時，會指派此識別碼或別名。

</dd> <dt>

<span id="lpszVideo"></span><span id="lpszvideo"></span><span id="LPSZVIDEO"></span>*lpszVideo*
</dt> <dd>

影片播放和捕捉的旗標。 下表列出可辨識 **setvideo** 命令的裝置類型，以及每種類型所使用的旗標。



| 值        | 意義                                                                                                                                                                                        | 意義                                                                                                                                                                                                                                                                                                |
|--------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| digitalvideo | 演算法 *演算法* bitsperpel 以將亮度計 *為因數 clocktimecolor，**以將**值* halftoneinputkey 色彩的 *因數 gamma 重設為* *r:g： b* 索引 offonoutput 的 *索引* 鍵索引 | 超過 *持續期間* 調色板色彩 *色彩* 的 *索引* 至 *newrgb* 調色板控制碼，以 *處理* 品質 *描述* 項記錄畫面播放速率，以將記錄 onrecord offsharpness 至將記錄 *至**來源**編號**值*   |
| 錄影機          | offonmonitor 至 *輸入* number *number* record offrecord track *track \_ number* off                                                                                                               | 記錄 onrecord track *track \_ number* *onsource to number* *number* track track *\_ number* offtrack *track number \_* on                                                                                                                                                                             |



 

下表列出可在 **lpszVideo** 參數中指定的旗標，以及它們的意義。



| 值                                          | 意義                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
|------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 演算法 *演算法*                          | 指定用於後續的 [reserve](reserve.md) 或 [記錄](record.md) 命令的影片壓縮演算法。 裝置支援的演算法是裝置特定的。 MCI 定義 *演算法* 的常數 "mpeg" 和 "h261"。如果指定的演算法與目前的檔案格式衝突，檔案格式就會變更為演算法的預設格式。<br/>                                                                                                                                     |
| bitsperpel 至 *計數*                          | 設定使用 [capture](capture.md) 或 [record](record.md) 命令儲存資料時，每圖元的位數。                                                                                                                                                                                                                                                                                                                                                                                                              |
| 要 *考慮* 的亮度                         | 設定影片亮度等級。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| clocktime                                      | 指出 "over" 旗標中指定的時間（以毫秒為單位）。 時間是絕對的，而不是在執行工作區的步驟。                                                                                                                                                                                                                                                                                                                                                                                |
| 要 *考慮* 的色彩                              | 設定色彩飽和度層級。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| 對比 *因素*                           | 設定影片對比層級。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| 以 gamma 為 *值*                               | 指定 gamma 更正指數乘以1000。 例如，若要指定2.2 的指數，請使用2200作為 *值*。 1.0 (1000) 的 gamma 值表示不會套用 gamma 修正。 Gamma 修正會調整在展示來源中編碼的強度與顯示的亮度之間的對應。                                                                                                                                                                                                 |
| 半 色調                                       | 導致使用半色調調色板，而不是預設的調色板。 只有 MCIAVI 數位視訊驅動程式能辨識此旗標。                                                                                                                                                                                                                                                                                                                                                                                         |
| input                                          | 修改「亮度」、「色彩」、「對比」、「gamma」、「清晰度」或「色調」旗標，使其影響輸入信號，並修改所記錄的內容。 可能的話，這是監視輸入時的預設值。                                                                                                                                                                                                                                                                                                             |
| r:g 的按鍵色彩 *： b*                           | 設定索引鍵色彩。 *R:g： b* 變數是 RGB 值。 冒號 (： ) 分隔個別的紅色、綠色和藍色值。                                                                                                                                                                                                                                                                                                                                                                                                       |
| *索引* 鍵索引                           | 設定索引鍵索引。 *索引* 變數是實體的調色板索引。                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| *輸入* 數位 *數位* 的監視器              | 控制哪些來源輸入會傳遞至 VCR 輸出，而不會變更錄製來源輸入選項。 類型可以是 "output" 或其中一個有效的輸入來源。 如果未指定 "number"，則會選擇該類型的第一個輸入。                                                                                                                                                                                                                                                                        |
| offon                                          | 啟用或停用影片的顯示。 停用 video 會將 [放置](put.md) 「目的地」矩形的圖元 (或其預設值（目前視窗的用戶端區域）) 為純色。 它不會影響框架緩衝區。影片來源（不論是工作區或外部輸入）可能會繼續將新的影像儲存在框架緩衝區中。 在啟用影片之前，不會顯示它們。 您可以使用 [視窗](window.md) 的 "state" 命令來隱藏視窗。 預設值為 **setvideo** "on"。<br/> |
| output                                         | 修改「亮度」、「色彩」、「對比」、「gamma」、「清晰度」或「淡色」旗標，讓它只會修改所顯示的信號，而不會修改所錄製的信號。 可能的話，這是監視檔案時的預設值。                                                                                                                                                                                                                                                                                                           |
| *持續期間*                                | 指定使用 *因素* 變數進行變更所需的時間長度。 *持續時間* 的單位為目前的時間格式。 執行工作區時，會發生變更。 當播放暫停時，變更也會暫止，直到播放繼續為止。 如果未使用或不支援 "over"，則會立即進行變更。                                                                                                                                                                    |
| *newrgb* *索引* 的調色板色彩 *色彩* | 設定新的調色板色彩。 要變更的色彩和調色板索引是由 *color* 和 *index* 參數指定;新的色彩是由 *newrgb* 所指定。 只有 MCIAVI 數位視訊驅動程式能辨識此旗標。                                                                                                                                                                                                                                                                                               |
| 要 *處理* 的調色板控制碼                     | 指定裝置必須用於轉譯之調色板的控制碼。 只有使用調色板的裝置才支援此專案。 如果 *控制碼* 為零，則會使用預設的調色板。數位影片裝置不應該釋出使用此命令傳遞的調色板。 應用程式應該在關閉裝置之後釋放。<br/>                                                                                                                                                                                                 |
| 品質 *描述* 項                           | 指定將影片記錄到檔案時所執行的影片壓縮特性。 所有裝置都支援三個描述項：「低」、「中」和「高」。 預設值是裝置特定的。 這些名稱的重要性取決於演算法和裝置。 裝置可能會定義其他描述項名稱。 [Quality](quality.md)命令可以用來定義其他描述項名稱。如果未使用「演算法」旗標，則 *描述* 項會套用至目前的演算法。<br/>   |
| 記錄畫面播放速率至 *費率*                    | 設定運動影片的錄製。 錄製 *速率* 是以每秒的畫面格單位乘以1000來指定。 例如，每秒29.97 個畫面格的 NTSC 畫面播放速率會以29970表示。                                                                                                                                                                                                                                                                                                                   |
| 記錄 onrecord 關閉                            | 啟用或停用錄影資料的錄製。 記錄影片資料是預設值。                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| 記錄追蹤 *追蹤 \_ 編號* 關閉               | 清除影片來源選取專案，讓下一個 [記錄](record.md) 命令不會錄製任何影片。 「追蹤」可讓您選取獨立的曲目。 如果未指定 "track"，則會假設為預設值1。 您可能必須先發出「組合錄製」命令 [集](set.md) ，然後才能關閉影片錄製。                                                                                                                                                                     |
| 記錄追蹤 *追蹤 \_ 號碼* 開啟                | 選取要以下一個 **記錄** 命令錄製的影片來源。 「追蹤」可讓您選取獨立的曲目。 曲目2對應于 Hi8 中的 PCM 曲目。 如果未指定 "track"，則會假設為預設值1。                                                                                                                                                                                                                                                                                                      |
| 要 *考慮* 的清晰度                          | 設定影片清晰度層級。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| 來源至 *來源* 編號 *值*              | 設定影片輸入的來源。 這通常對應于外部連接器。 為 *來源* 定義的常數包括 "rgb"、"pal"、"ntsc"、"svideo" 和 "secam"。 如果有多個指定類型的輸入存在，選擇性的 "number" *值* 會指出所需的輸入。 例如， **setvideo** "source to ntsc number 2" 會指定第二個 ntsc 輸入。如果省略「到」 *來源* ，則會使用絕對來源，如「影片來源」命令 [清單](list.md) 所定義。<br/>            |
| 來源到 *類型* 編號               | 選取要在磁帶上錄製的影片來源。 *類型* 必須是「調諧器」、「行」、「svideo」、「aux」、「泛型」、「靜音」或「rgb」。                                                                                                                                                                                                                                                                                                                                                                                              |
| 仍為演算法 *演算法*                    | 指定 [capture](capture.md) 命令所使用的靜止影像壓縮演算法。 每個裝置都必須支援 "none" *演算法* ，這表示沒有壓縮。 此為預設值。 在此情況下，數位影片裝置會將影像另存為 RGB 裝置獨立點陣圖。 裝置也可能支援其他演算法的裝置特定清單。                                                                                                                                                           |
| 仍然是品質 *描述* 項                     | 指定在捕捉靜止映射時，所執行之靜止影像壓縮的特性。 所有裝置都支援描述項「低」、「中」和「高」。 預設值是裝置特定的。如果未使用「演算法」旗標，則 *描述* 項會套用至目前的演算法。<br/> [Quality](quality.md)命令可以用來定義其他描述項名稱。<br/>                                                                                                                            |
| 串流至 *數位*                             | 指定從工作區播放的影片串流。 如果未指定資料流程，且檔案格式未定義預設資料流程，則會播放實際的第一次交錯影片串流。                                                                                                                                                                                                                                                                                                                 |
| 要 *考慮* 的色調                               | 設定影像色調。 一般而言，這項調整會在許多彩色電視集的淡色控制項之後進行模型化，而250表示綠色、750表示紅色，0 (或                                                                                                                                                                                                                                                                                                                                                             |



 

</dd> <dt>

<span id="lpszFlags"></span><span id="lpszflags"></span><span id="LPSZFLAGS"></span>*lpszFlags*
</dt> <dd>

可以是「等候」、「通知」、「測試」或它們的組合。 如需這些旗標的詳細資訊，請參閱 [Wait、Notify 和 Test 旗標](the-wait-notify-and-test-flags.md)。

</dd> </dl>

## <a name="return-value"></a>傳回值

如果成功則傳回零，否則會傳回錯誤。

## <a name="remarks"></a>備註

若為 VCR 裝置，使用 setvideo 搭配旗標來關閉個別曲目 ( 「追蹤 *追蹤 \_ 編號* 關閉」 ) 可能會導致您的應用程式收到狀態訊息，指出無法執行此命令。有些 Vcr 只能關閉曲目的組合，而不是個別曲目;例如，第一個音訊曲目和影片的影片播放軌。 在這種情況下，只要使用 [setaudio](setaudio.md) 和 setvideo，就能繼續關閉組成組合的其他追蹤。 驅動程式會在收到命令時關閉追蹤，以關閉組合中的最後一個曲目。

## <a name="requirements"></a>規格需求



| 需求 | 值 |
|-------------------------------------|------------------------------------------------------------|
| 最低支援的用戶端<br/> | Windows 2000 Professional \[僅限傳統型應用程式\]<br/> |
| 最低支援的伺服器<br/> | Windows 2000 Server \[僅限傳統型應用程式\]<br/>       |



## <a name="see-also"></a>另請參閱

<dl> <dt>

[Mci](mci.md)
</dt> <dt>

[MCI 命令字串](mci-command-strings.md)
</dt> <dt>

[捕獲](capture.md)
</dt> <dt>

[list](list.md)
</dt> <dt>

[把](put.md)
</dt> <dt>

[記錄](record.md)
</dt> <dt>

[儲備](reserve.md)
</dt> <dt>

[set](set.md)
</dt> <dt>

[setaudio](setaudio.md)
</dt> <dt>

[視窗](window.md)
</dt> </dl>

 

