---
title: setaudio 命令
description: Setaudio 命令會設定與音訊播放和捕捉相關聯的值。 數位影片和 VCR 裝置會辨識此命令。
ms.assetid: 78f6e365-fb51-4b1a-8dd7-0a2d5a047750
keywords:
- setaudio 命令 Windows 多媒體
topic_type:
- apiref
api_name:
- setaudio
api_type:
- NA
ms.topic: reference
ms.date: 05/31/2018
ms.openlocfilehash: f4c022a03834a14995f19815ef8f52c0955dc449
ms.sourcegitcommit: a1494c819bc5200050696e66057f1020f5b142cb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 12/12/2020
ms.locfileid: "106990901"
---
# <a name="setaudio-command"></a>setaudio 命令

Setaudio 命令會設定與音訊播放和捕捉相關聯的值。 數位影片和 VCR 裝置會辨識此命令。

若要傳送此命令，請使用 *lpszCommand* 參數設定來呼叫 [**mciSendString**](/previous-versions//dd757161(v=vs.85))函式，如下所示。

``` syntax
_stprintf_s(
  lpszCommand, 
  TEXT("setaudio %s %s %s"), 
  lpszDeviceID, 
  lpszAudio, 
  lpszFlags
); 
```

## <a name="parameters"></a>參數

<dl> <dt>

<span id="lpszDeviceID"></span><span id="lpszdeviceid"></span><span id="LPSZDEVICEID"></span>*lpszDeviceID*
</dt> <dd>

MCI 裝置的識別碼。 開啟裝置時，會指派此識別碼或別名。

</dd> <dt>

<span id="lpszAudio"></span><span id="lpszaudio"></span><span id="LPSZAUDIO"></span>*lpszAudio*
</dt> <dd>

音訊播放和捕捉的旗標。 下表列出可辨識 **setaudio** 命令的裝置類型，以及每種類型所使用的旗標。



| 值        | 意義                                                                                                                                                                                | 意義                                                                                                                                                                                                   |
|--------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| digitalvideo | 演算法 *演算法* 與 *整數* 低音的比較 *，以將 bitspersample 從* 左側磁片區左邊的整數 clocktime *輸入 bytespersec 到 \_* *整數* 輸入，以關閉輸出的 *因素* | 在適當的磁片區上，超出 *持續時間* 品質 *描述* 項記錄在右側的磁片區上，以 *將 samplespersec 重新* 計入 *整數**來源，以將磁片**磁碟機的**數量* 帶 *到係數* |
| 錄影機          | 關閉監視器，以 *輸入* number *number* record off record track *track \_ number* off                                                                                                    | 記錄在來源上的記錄追蹤 *追蹤 \_ 號碼**輸入* 數位 *數目* 的 *追蹤 \_ 追蹤編號* 追蹤 *編號 \_* 開啟                                                                              |



 

下表列出可在 **lpszAudio** 參數中指定的旗標，以及它們的意義。



| 值                             | 意義                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
|-----------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 演算法 *演算法*             | 選取特定的音訊壓縮演算法以供後續的 [reserve](reserve.md) 或 [record](record.md) 命令使用。 支援的演算法是裝置特定的。 MCI 會定義 *演算法* 的值 "g711"、"g721"、"g722"、"g728"、"pcm"、"cdxa"、"adpcm" 和 "adpcm4e"。 如果裝置支援「pcm」、「cdxa」和「adpcm4e」的演算法名稱，則會遵守標準定義。 "Cdxa" 演算法已由索尼 Corporation 定義。 "Adpcm4e" 演算法已由 Intel Corporation 定義。 "G711"、"g721"、"g722" 和 "g728" 值代表國際電報與電話諮詢委員會建議的音訊演算法 (CCITT) 。<br/> 如果指定的演算法與目前的檔案格式衝突，檔案格式就會變更為演算法的預設格式。<br/> |
| 對齊 *整數*            | 設定資料區塊相對於輸入波形-音訊資料開頭的對齊方式。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| 低音至 *因素*                  | 設定音訊低頻率層級。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| bitspersample 至 *位 \_ 計數*     | 設定每個記錄樣本的位數。 檔案會以這種格式儲存。 此旗標只適用于支援「pcm」演算法的裝置。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| bytespersec 至 *整數*          | 設定以 "pcm" 和 "adpcm" 演算法錄製的平均每秒位元組數目。 檔案會以這種格式儲存。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| clocktime                         | 表示「over」旗標中指定的時間（以毫秒為單位）。 這次是絕對的，而不是在執行工作區的步驟。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| input                             | 修改「低音」、「高音」或「音量」旗標，使其影響輸入信號並修改所記錄的內容。 可能的話，這是監視輸入時的預設值。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| 左邊                  | 啟用或停用左側通道上的音訊輸出。 音訊簡報來源可以是外部輸入或工作區。 預設值為「剩下」。 如果只有一個通道，則會將該通道設定為開啟或關閉。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| 將磁片區移至 *因素*           | 設定左邊音訊頻道的音訊音量。 如果只有一個通道，它會設定其磁片區。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| *輸入* 數位 *數位* 的監視器 | 控制哪些來源輸入會傳遞至 VCR 輸出，而不會變更錄製來源輸入選取專案。 *類型* 可以是 "output" 或其中一個有效的輸入來源。 如果未指定 *數位* ，則會選擇該類型的第一個輸入。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| 關閉于                            | 啟用或停用音訊。 音訊簡報來源可以是外部輸入或工作區。 此命令會同時影響左右音訊頻道。 預設值為 **setaudio** "on"。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| output                            | 修改「低音」、「高音」或「音量」旗標，讓它只修改播放的信號，而不是記錄的內容。 可能的話，這是監視檔案時的預設值。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| *持續期間*                   | 指定使用 *因素* 變數進行變更所需的時間長度。 *持續時間* 的單位為目前的時間格式。 執行工作區時，會發生變更。 當播放暫停時，變更也會暫止，直到播放繼續為止。 如果未指定或不支援 "over"，則會立即進行變更。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| 品質 *描述* 項              | 指定將音訊錄製至檔案時所執行之音訊壓縮的特性。 所有裝置都支援三個描述項「低」、「中」和「高」。 預設值是裝置特定的。如果未指定「演算法」旗標，則「品質」調整會套用至目前的演算法。<br/> [Quality](quality.md)命令可以用來定義其他描述項名稱。<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| 關閉記錄                        | 清除音訊來源選取專案，讓下一個 [記錄](record.md) 命令不會錄製音訊。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| 記錄于                         | 可記錄音訊資料。 預設值是記錄音訊資料。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| 記錄追蹤 *追蹤 \_ 編號* 關閉  | 清除音訊來源選取專案，讓下一個 [記錄](record.md) 命令不會錄製音訊。 「追蹤」可讓您選取獨立的曲目。 曲目2對應于 Hi8 中的 PCM 曲目。 如果未指定 "track"，則會假設為預設值1。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| 記錄追蹤 *追蹤 \_ 號碼* 開啟   | 選取要以下一個 **記錄** 命令錄製的音訊來源。 「追蹤」可讓您選取獨立的曲目。 曲目2對應于 Hi8 中的 PCM 曲目。 如果未指定 "track"，則會假設為預設值1。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| 右邊                | 啟用或停用右側通道上的音訊輸出。 音訊簡報來源可以是外部輸入或工作區。 預設值為「右側」。 如果只有一個通道，此旗標不會有任何作用。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| 將磁片區設為最適合 *因素*          | 將音訊音量設定為右邊的音訊頻道。 如果只有一個通道，則不會有任何作用。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| samplespersec 至 *整數*        | 設定以 "pcm" 和 "adpcm" 演算法錄製的取樣率。 檔案會以這種格式儲存。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| *要進行* 的來源            | 指定音訊輸入數位板的來源。 *針對用* 來定義的常數包括：「左」、「右」、「平均」和「身歷聲」。 前三個使用左側輸入來指定單聲道錄製、僅使用右邊輸入，以及兩個輸入的平均值。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| 來源到 *類型* 編號  | 選取要記錄在磁帶上的音訊來源。 *類型* 必須是「調諧器」、「行」、「svideo」、「aux」、「泛型」或「靜音」。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| 串流至 *數位*                | 指定從工作區播放的音訊串流。 如果未指定資料流程，且檔案格式未定義預設值，則會播放實際優先的交錯音訊串流。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| 追蹤 *追蹤 \_ 編號* 關閉         | 停用個別的播放軌。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| 追蹤 *追蹤 \_ 編號* 開啟          | 啟用個別的軌跡。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| 高音至 *因素*                | 設定音訊高頻率層級。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| 要 *考慮* 的磁片區                | 設定兩個音訊頻道的平均音訊音量。 如果左方和右邊的磁片區已設定為不同的值，則從左至右磁片區的比率大約是未變更。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |



 

</dd> <dt>

<span id="lpszFlags"></span><span id="lpszflags"></span><span id="LPSZFLAGS"></span>*lpszFlags*
</dt> <dd>

可以是「等候」、「通知」、「測試」或它們的組合。 如需這些旗標的詳細資訊，請參閱 [Wait、Notify 和 Test 旗標](the-wait-notify-and-test-flags.md)。

</dd> </dl>

## <a name="return-value"></a>傳回值

如果成功則傳回零，否則會傳回錯誤。

## <a name="remarks"></a>備註

若為 VCR 裝置，使用 setaudio 搭配旗標來關閉個別曲目 ( 「追蹤 *追蹤 \_ 編號* 關閉」 ) 可能會導致您的應用程式收到狀態訊息，指出無法執行此命令。有些 Vcr 只能關閉曲目的組合，而不是個別曲目;例如，第一個音訊曲目和影片的影片播放軌。 在這種情況下，只要使用 setaudio 和 [setvideo](setvideo.md) ，就能繼續關閉組成組合的其他追蹤。 驅動程式會在收到命令時關閉追蹤，以關閉組合中的最後一個曲目。

## <a name="requirements"></a>規格需求



| 需求 | 值 |
|-------------------------------------|------------------------------------------------------------|
| 最低支援的用戶端<br/> | Windows 2000 Professional \[僅限傳統型應用程式\]<br/> |
| 最低支援的伺服器<br/> | Windows 2000 Server \[僅限傳統型應用程式\]<br/>       |



## <a name="see-also"></a>另請參閱

<dl> <dt>

[Mci](mci.md)
</dt> <dt>

[MCI 命令字串](mci-command-strings.md)
</dt> <dt>

[記錄](record.md)
</dt> <dt>

[儲備](reserve.md)
</dt> <dt>

[setvideo](setvideo.md)
</dt> </dl>

 

