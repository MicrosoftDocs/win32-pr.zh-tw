---
title: VCR 服務
description: VCR 服務
ms.assetid: 140220f7-df7b-46e2-8374-e1200d873f3b
keywords:
- " (VISCA) 的影片系統控制項架構"
- 'VISCA (Video System Control 架構) '
- MCI VISCA 驅動程式
- VISCA 驅動程式
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 77d884c38d224182db7eef8db0f0cd80b14e3a08
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 09/16/2019
ms.locfileid: "103840435"
---
# <a name="vcr-services"></a>VCR 服務

Windows 會透過設備磁碟機提供 VCR 服務，該驅動程式是以針對 Vcr 設定的 MCI 命令為基礎。 本節說明 (VISCA) 驅動程式的 MCI 影片系統控制項架構，並說明如何使用它來控制 VCR。

*Vcr* 裝置類型會控制 vcr。 如需由 VCR 裝置辨識的 MCI 命令清單，請參閱 [Vcr 命令集](vcr-command-set.md)。

## <a name="the-mci-visca-driver"></a>MCI VISCA 驅動程式

MCI VISCA 驅動程式會控制索尼 VISCA 相容的 Vcr，例如 CVD-1000 VDeck。 VISCA 驅動程式會控制磁帶傳輸、通道調諧器和 VCR 輸入和輸出通道。

## <a name="searching-and-positioning-with-a-vcr"></a>使用 VCR 搜尋和定位

VISCA 驅動程式會使用兩種方法來追蹤 VCR 磁帶傳輸中的磁帶移動：時間 *碼資訊* 和 *磁帶計數器*。 時間碼資訊是已記錄在磁帶上的時間資訊。 大部分的 Vcr 都可記錄時間碼，而不會損毀音訊和影片播放軌。 磁帶計數器會估計移動超過磁帶前端以取得位置的磁帶數量。

當磁帶從一開始移至結尾時，會增加時間碼資訊和磁帶計數器。 基於其精確度，使用時間資訊資訊來放置磁帶，幾乎最好是使用磁帶計數器。

指定位置資訊的 MCI 命令旗標會以時間相依性表示：「時間格式」、「持續時間」、「來源」、「到」和「搜尋」。  (， [**狀態**](status.md) "position" 命令會以目前時間格式傳回其時間值。 ) 

VISCA 驅動程式會使用 [**設定**](set.md) 的「時間模式」命令來選取要與磁帶搭配使用的位置類型。 當時間模式設定為「時間碼」時， **狀態** 「位置」和 **設定** 「時間格式」命令會使用磁帶上的時間碼。 當時間模式設定為 "counter" 時， **狀態** 「位置」和 **設定** 「時間格式」命令會使用計數器。

如果應用程式可能會有兩個位置資訊來源，則可以將時間模式設定為「偵測」。 處於偵測模式時，VISCA 驅動程式會在發生下列任何狀況時，使用時間碼資訊進行定位：

-   開啟驅動程式時，會出現時間碼資訊。
-   您可以使用 **設定** 的「門開啟」命令來變更磁帶，並在磁帶上顯示時間碼資訊。
-   重新發出「時間模式」命令 [**集**](set.md) 。

如果找不到時間碼資訊，驅動程式會使用磁帶計數器。

若要判斷目前的定位方法，請發出 [**狀態**](status.md) 「時間類型」命令，其會傳回「時間碼」或「計數器」。 您也可以使用 **狀態** 「時間模式」命令（傳回「時間碼」、「計數器」或「偵測」）來識別目前的定位模式。

**狀態**"counter" 命令會抓取目前的磁帶計數器值，而不論目前的定位方法為何;不過，您只能使用此計數器來讀取 [**set**](set.md) "counter" 命令。

VISCA 驅動程式可以使用 **狀態** 「時間碼類型 **」和「** 畫面播放速率」命令一起取得錄製在磁帶上的原生時間碼格式。 例如，如果時間碼型別為 "smpte" 且畫面播放速率為25，則在磁帶上記錄的原生時間碼格式為 SMPTE 25。

VISCA 驅動程式也可以使用「計數器解析」命令（ 傳回「秒」或「框架」）來取得計數器解析。 計數器格式仍然可能設定為 SMPTE 30，但傳回值只會傳回0的畫面格。 如果目前的時間類型為 counter，則此解析也會套用至 **狀態** 「位置」所傳回的值。

## <a name="capturing-frames"></a>捕獲框架

框架捕獲命令可為 *框架捕獲裝置* 提供靜止的影像。 畫面格捕獲裝置是一種可讀取和儲存影片影像的個別硬體。 VISCA 驅動程式支援 ([**MCI \_ 凍結**](mci-freeze.md)) 命令的 [**凍結**](freeze.md)，以穩定仍可進行捕捉的映射。 此外， [**解除**](unfreeze.md) 凍結 ([**MCI \_ 解除凍結**](mci-unfreeze.md)) 命令可在 **凍結** 命令之後用來重新開機磁帶傳輸。

**凍結** 命令可為框架捕獲裝置提供高品質、穩定、以時間為基礎的已更正映射。 這個命令存在的原因是，裝置在播放或暫停時，不一定會傳遞其最高品質的輸出影像;這類影片影像不適合用于捕捉。

**解除凍結** 命令會解除鎖定磁帶傳輸，並在 **凍結** 命令之前繼續作用中的傳輸模式。

當您的應用程式需要在 VCR 上錄製影片影像時，請使用 [ **凍結** "輸入" 命令或 [**提示**](cue.md) ([**MCI \_ 提示**](mci-cue.md)) 命令來錄製映射。

## <a name="selecting-inputs"></a>選取輸入

VISCA 驅動程式支援三種輸入類型：影片、音訊和時間碼。 影片輸入包括兩個標準頻道 (行1和 2) 、SVideo 通道、輔助通道，以及來自內部調諧器的通道。 音訊輸入包括兩個標準頻道 (行1和 2) ，以及來自內部調諧器的通道。 時間碼輸入是 VCR 的內部。

當錄影機正在錄製或磁帶傳輸停止時，一般輸出會包含目前所選取的輸入，當磁帶傳輸現正播放或暫停時，則會攜帶磁帶的內容。 受監視的輸出會包含與一般輸出相同的資訊，以及目前的時間碼和通道資訊。

假設適當的外部輸入已連線到您的 VCR，而您已決定要記錄的內容，您可以選取要錄製的輸入。 例如，若要從 "svideo" 影片和「行1」音訊輸入錄製或查看，您可以使用 [**setvideo**](setvideo.md) ([**mci \_ setvideo**](mci-setvideo.md)) 和 [**setaudio**](setaudio.md) ([**mci \_ setaudio**](mci-setaudio.md)) 命令來選取這些輸入來源。 您可以使用 [**狀態**](status.md) ([**MCI \_ 狀態**](mci-status.md)) 命令來確認這些選項。

依預設，監視器會顯示顯示為輸出的內容。 不過，有時候您可能會想要在記錄另一個來源時查看其中一個來源。 這是使用調諧器的常見作法。 例如，您可能想要在錄製 channel 7 時觀賞 channel 4。 在此情況下，您會有兩個邏輯調諧器輸入。 您可以使用下列命令來設定 VCR：

## <a name="to-review-one-source-while-recording-from-another"></a>若要在記錄另一個來源時檢查它

1.  使用 [**settuner**](settuner.md) ([**MCI \_ settuner**](mci-settuner.md)) 命令來選取要監看及錄製的通道。
2.  使用 **setvideo** 命令來選取影片錄製來源。
3.  使用 [**setaudio**](setaudio.md) 命令來選取音訊錄製來源。
4.  使用 [**setvideo**](setvideo.md) 命令將 channel 4 影片輸入路由傳送至受監視的輸出，以顯示在畫面上。
5.  使用 [**setaudio**](setaudio.md) 命令將 channel 4 音訊輸入路由傳送至受監視的輸出，以播放音訊。
6.  使用 [**status**](status.md) 命令驗證您的選擇。

VISCA 驅動程式也支援音訊和影片的特殊輸入類型，稱為「 *靜音*」。 靜音允許選取 [沒有輸入]，這在錄製空白信號時會很有用。

## <a name="selecting-recording-tracks"></a>選取錄製曲目

磁帶上有三種類型的錄製播放軌：影片、音訊和時間碼。 您只有一個影片或時間碼播放軌，但您可以使用多個曲目。當您這樣做時，請追蹤主要的音訊播放軌。

VISCA 驅動程式支援兩種作業模式：組合和插入。 在 *組合模式* 中，會選取要錄製的所有曲目。 在 *插入模式* 中，可以針對錄製個別選取追蹤。 大部分的 Vcr 預設為組合模式。 使用 [**set**](set.md) ([**MCI \_ set**](mci-set.md)) 命令變更這些模式。

## <a name="recording-and-editing"></a>錄製和編輯

[**記錄**](record.md) ([**MCI \_ 記錄**](mci-record.md)) 命令提供簡單的記錄，且精確度大約為1秒的開始位置。 若要更精確地錄製，或您想要在同時操作多個投影片時編輯影片內容，您應該使用 [**提示**](cue.md) ([**MCI \_ 提示**](mci-cue.md)) 命令。

**提示** 命令會準備裝置以進行錄製或播放。 使用 **提示** 「輸入」命令來準備裝置以進行錄製。 **提示** 命令是必要的，因為應用程式必須知道裝置是否已準備好執行命令 (，以及因為可能需要幾分鐘的時間來準備 [**play**](play.md) ([**MCI \_ play**](mci-play.md)) 或 **記錄** 命令) 。

VCR 會藉由搜尋點對點（也就是目前的位置或使用 **提示**"from" 命令所指定的 *位置）來* 準備自己進行錄製或播放。 但是，如果以 **提示** 命令指定了「預先處理」旗標，則 VCR 的位置本身會是從點開始算起的距離。 「預先執行」旗標也會指出 VCR 使用任何適用的編輯模式，因此請務必使用「預先進行」，特別是當您想要進行最精確的錄製時。  (使用具有「可預先處理」旗標的 ([**MCI \_ GETDEVCAPS**](mci-getdevcaps.md)) 命令 [**功能**](capability.md)，來檢查是否支援預先處理模式。 ) 

> [!Note]  
> 當您使用 "from" 和 "to" 位置記錄時，"from" 位置會包含在編輯中，而 "to" 位置則不會。

 

如需錄製的詳細資訊，請參閱 [錄製](recording.md)。

## <a name="using-the-clock-while-editing"></a>在編輯時使用時鐘

編輯時，您可能會想要將區段從一個 VCR 記錄到另一個。 您可以在特定時間開始記錄，並在另一個 VCR 開始播放，並指定動作 (播放或記錄) 、位置和每個 VCR 的時間。

這兩個 Vcr 都必須使用相同的時鐘來進行這種類型的編輯;時鐘可協助同步處理這兩個裝置。 您可以使用 [**狀態**](status.md) ([**MCI \_ 狀態**](mci-status.md)) 命令，並使用「時鐘識別碼」旗標來查詢每個 vcr，以判斷兩個 vcr 是否共用相同的時鐘。 如果 **status** 命令傳回的識別碼相同，則裝置會使用相同的時鐘。 作為共用資源，時鐘可以連接至多個 Vcr。 VISCA 驅動程式只支援一個共用時鐘。

您也可以使用「時鐘遞增率」 命令來判斷時鐘解析。 此命令會傳回時鐘每秒支援的遞增數目。 例如，如果時鐘每毫秒更新一次，則命令會以頻率遞增率傳回1000。 使用遞增率的優點是以整數表示速率;否則，增量會是 (單或雙精確度) 浮點值。 以整數為單位，操作遞增率是簡單的作業，而且不容易舍入錯誤。 您可以使用 [**set**](set.md) ([**MCI \_ set**](mci-set.md)) 命令搭配 "clock 0" (零) 旗標來重設時鐘。

發出 [**play**](play.md) ([**MCI \_ play**](mci-play.md)) 、 [**記錄**](record.md) ([**MCI \_ 記錄**](mci-record.md)) 或 [**搜尋**](seek.md) ([**mci \_ 搜尋**](mci-seek.md)) 命令時，您可以指定要執行命令的時間。 所使用的 Vcr 特性會決定每個 VCR 的啟動時機。 時間必須考慮每個裝置所需的預先執行數量，以及完成用來設定編輯會話的 MCI 命令所需的時間量。 若要這樣做，請取出時鐘時間，並將等待間隔新增為5到10秒。  (等候間隔必須夠長，才能讓預先處理和任何未完成的 MCI 命令完成執行。 ) 

若要確保等待期間夠長，請將 [ **記錄** ] 命令最後放在應用程式中，然後檢查它之前的時間。 如果間隔太短，請重新開機 **播放** 命令。 或者，您可以檢查腳本最後一個命令之後的時間，以確認有足夠的時間來傳送和完成所有命令。

 

 




