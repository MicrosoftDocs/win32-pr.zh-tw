---
title: VCR 服務
description: VCR 服務
ms.assetid: 140220f7-df7b-46e2-8374-e1200d873f3b
keywords:
- " (VISCA) 的影片系統控制項架構"
- 'VISCA (Video System Control 架構) '
- MCI VISCA 驅動程式
- VISCA 驅動程式
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 77d884c38d224182db7eef8db0f0cd80b14e3a08
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 09/16/2019
ms.locfileid: "103840435"
---
# <a name="vcr-services"></a><span data-ttu-id="6dad9-107">VCR 服務</span><span class="sxs-lookup"><span data-stu-id="6dad9-107">VCR Services</span></span>

<span data-ttu-id="6dad9-108">Windows 會透過設備磁碟機提供 VCR 服務，該驅動程式是以針對 Vcr 設定的 MCI 命令為基礎。</span><span class="sxs-lookup"><span data-stu-id="6dad9-108">Windows provides VCR services through a device driver that is based on the MCI command set for VCRs.</span></span> <span data-ttu-id="6dad9-109">本節說明 (VISCA) 驅動程式的 MCI 影片系統控制項架構，並說明如何使用它來控制 VCR。</span><span class="sxs-lookup"><span data-stu-id="6dad9-109">This section describes the MCI Video System Control Architecture (VISCA) driver and explains how to use it to control a VCR.</span></span>

<span data-ttu-id="6dad9-110">*Vcr* 裝置類型會控制 vcr。</span><span class="sxs-lookup"><span data-stu-id="6dad9-110">The *vcr* device type controls VCRs.</span></span> <span data-ttu-id="6dad9-111">如需由 VCR 裝置辨識的 MCI 命令清單，請參閱 [Vcr 命令集](vcr-command-set.md)。</span><span class="sxs-lookup"><span data-stu-id="6dad9-111">For a list of the MCI commands recognized by VCR devices, see [VCR Command Set](vcr-command-set.md).</span></span>

## <a name="the-mci-visca-driver"></a><span data-ttu-id="6dad9-112">MCI VISCA 驅動程式</span><span class="sxs-lookup"><span data-stu-id="6dad9-112">The MCI VISCA Driver</span></span>

<span data-ttu-id="6dad9-113">MCI VISCA 驅動程式會控制索尼 VISCA 相容的 Vcr，例如 CVD-1000 VDeck。</span><span class="sxs-lookup"><span data-stu-id="6dad9-113">The MCI VISCA driver controls Sony VISCA-compatible VCRs, such as the CVD-1000 VDeck.</span></span> <span data-ttu-id="6dad9-114">VISCA 驅動程式會控制磁帶傳輸、通道調諧器和 VCR 輸入和輸出通道。</span><span class="sxs-lookup"><span data-stu-id="6dad9-114">The VISCA driver controls the tape transport, channel tuners, and VCR input and output channels.</span></span>

## <a name="searching-and-positioning-with-a-vcr"></a><span data-ttu-id="6dad9-115">使用 VCR 搜尋和定位</span><span class="sxs-lookup"><span data-stu-id="6dad9-115">Searching and Positioning with a VCR</span></span>

<span data-ttu-id="6dad9-116">VISCA 驅動程式會使用兩種方法來追蹤 VCR 磁帶傳輸中的磁帶移動：時間 *碼資訊* 和 *磁帶計數器*。</span><span class="sxs-lookup"><span data-stu-id="6dad9-116">The VISCA driver uses two methods to track videotape movement within the VCR tape transport: *timecode information* and *tape counters*.</span></span> <span data-ttu-id="6dad9-117">時間碼資訊是已記錄在磁帶上的時間資訊。</span><span class="sxs-lookup"><span data-stu-id="6dad9-117">Timecode information is timing information that has been recorded on the videotape.</span></span> <span data-ttu-id="6dad9-118">大部分的 Vcr 都可記錄時間碼，而不會損毀音訊和影片播放軌。</span><span class="sxs-lookup"><span data-stu-id="6dad9-118">Most VCRs allow timecodes to be recorded without destroying audio and video tracks.</span></span> <span data-ttu-id="6dad9-119">磁帶計數器會估計移動超過磁帶前端以取得位置的磁帶數量。</span><span class="sxs-lookup"><span data-stu-id="6dad9-119">Tape counters estimate the amount of videotape that travels past the videotape head to obtain a position.</span></span>

<span data-ttu-id="6dad9-120">當磁帶從一開始移至結尾時，會增加時間碼資訊和磁帶計數器。</span><span class="sxs-lookup"><span data-stu-id="6dad9-120">Both timecode information and tape counters increase as the videotape moves from beginning to end.</span></span> <span data-ttu-id="6dad9-121">基於其精確度，使用時間資訊資訊來放置磁帶，幾乎最好是使用磁帶計數器。</span><span class="sxs-lookup"><span data-stu-id="6dad9-121">Because of its accuracy, using timecode information to position a videotape is almost always preferable to using tape counters.</span></span>

<span data-ttu-id="6dad9-122">指定位置資訊的 MCI 命令旗標會以時間相依性表示：「時間格式」、「持續時間」、「來源」、「到」和「搜尋」。</span><span class="sxs-lookup"><span data-stu-id="6dad9-122">The MCI command flags for specifying positioning information are expressed as time dependencies: "time format", "duration", "from", "to", and "seek".</span></span> <span data-ttu-id="6dad9-123"> (， [**狀態**](status.md) "position" 命令會以目前時間格式傳回其時間值。 ) </span><span class="sxs-lookup"><span data-stu-id="6dad9-123">(Also, the [**status**](status.md) "position" command returns its time value in the current time format.)</span></span>

<span data-ttu-id="6dad9-124">VISCA 驅動程式會使用 [**設定**](set.md) 的「時間模式」命令來選取要與磁帶搭配使用的位置類型。</span><span class="sxs-lookup"><span data-stu-id="6dad9-124">The VISCA driver uses the [**set**](set.md) "time mode" command to select the type of positioning to use with a videotape.</span></span> <span data-ttu-id="6dad9-125">當時間模式設定為「時間碼」時， **狀態** 「位置」和 **設定** 「時間格式」命令會使用磁帶上的時間碼。</span><span class="sxs-lookup"><span data-stu-id="6dad9-125">When the time mode is set to "timecode", the **status** "position" and **set** "time format" commands use the timecode on the videotape.</span></span> <span data-ttu-id="6dad9-126">當時間模式設定為 "counter" 時， **狀態** 「位置」和 **設定** 「時間格式」命令會使用計數器。</span><span class="sxs-lookup"><span data-stu-id="6dad9-126">When the time mode is set to "counter", the **status** "position" and **set** "time format" commands use counters.</span></span>

<span data-ttu-id="6dad9-127">如果應用程式可能會有兩個位置資訊來源，則可以將時間模式設定為「偵測」。</span><span class="sxs-lookup"><span data-stu-id="6dad9-127">An application can set the time mode to "detect" if it doesn't matter that there might be two sources of position information.</span></span> <span data-ttu-id="6dad9-128">處於偵測模式時，VISCA 驅動程式會在發生下列任何狀況時，使用時間碼資訊進行定位：</span><span class="sxs-lookup"><span data-stu-id="6dad9-128">When in detect mode, the VISCA driver uses timecode information for positioning when any of the following conditions occur:</span></span>

-   <span data-ttu-id="6dad9-129">開啟驅動程式時，會出現時間碼資訊。</span><span class="sxs-lookup"><span data-stu-id="6dad9-129">The timecode information is present when the driver is opened.</span></span>
-   <span data-ttu-id="6dad9-130">您可以使用 **設定** 的「門開啟」命令來變更磁帶，並在磁帶上顯示時間碼資訊。</span><span class="sxs-lookup"><span data-stu-id="6dad9-130">You change a videotape with the **set** "door open" command and timecode information is present on the videotape.</span></span>
-   <span data-ttu-id="6dad9-131">重新發出「時間模式」命令 [**集**](set.md) 。</span><span class="sxs-lookup"><span data-stu-id="6dad9-131">The [**set**](set.md) "time mode" command is reissued.</span></span>

<span data-ttu-id="6dad9-132">如果找不到時間碼資訊，驅動程式會使用磁帶計數器。</span><span class="sxs-lookup"><span data-stu-id="6dad9-132">If timecode information cannot be found, the driver uses the tape counters.</span></span>

<span data-ttu-id="6dad9-133">若要判斷目前的定位方法，請發出 [**狀態**](status.md) 「時間類型」命令，其會傳回「時間碼」或「計數器」。</span><span class="sxs-lookup"><span data-stu-id="6dad9-133">To determine the current positioning method, issue the [**status**](status.md) "time type" command, which returns either "timecode" or "counter".</span></span> <span data-ttu-id="6dad9-134">您也可以使用 **狀態** 「時間模式」命令（傳回「時間碼」、「計數器」或「偵測」）來識別目前的定位模式。</span><span class="sxs-lookup"><span data-stu-id="6dad9-134">You can also identify the current positioning mode by using the **status** "time mode" command, which returns "timecode", "counter", or "detect".</span></span>

<span data-ttu-id="6dad9-135">**狀態**"counter" 命令會抓取目前的磁帶計數器值，而不論目前的定位方法為何;不過，您只能使用此計數器來讀取 [**set**](set.md) "counter" 命令。</span><span class="sxs-lookup"><span data-stu-id="6dad9-135">The **status** "counter" command retrieves the current tape counter value, regardless of the current positioning method; however, you can use this counter reading only with the [**set**](set.md) "counter" command.</span></span>

<span data-ttu-id="6dad9-136">VISCA 驅動程式可以使用 **狀態** 「時間碼類型 **」和「** 畫面播放速率」命令一起取得錄製在磁帶上的原生時間碼格式。</span><span class="sxs-lookup"><span data-stu-id="6dad9-136">The VISCA driver can retrieve the native timecode format recorded on a videotape by using the **status** "timecode type" and **status** "frame rate" commands together.</span></span> <span data-ttu-id="6dad9-137">例如，如果時間碼型別為 "smpte" 且畫面播放速率為25，則在磁帶上記錄的原生時間碼格式為 SMPTE 25。</span><span class="sxs-lookup"><span data-stu-id="6dad9-137">For example, if timecode type is "smpte" and frame rate is 25, the native timecode format recorded on the videotape is SMPTE 25.</span></span>

<span data-ttu-id="6dad9-138">VISCA 驅動程式也可以使用「計數器解析」命令（ 傳回「秒」或「框架」）來取得計數器解析。</span><span class="sxs-lookup"><span data-stu-id="6dad9-138">The VISCA driver can also retrieve the counter resolution by using the **status** "counter resolution" command, which returns "seconds" or "frames".</span></span> <span data-ttu-id="6dad9-139">計數器格式仍然可能設定為 SMPTE 30，但傳回值只會傳回0的畫面格。</span><span class="sxs-lookup"><span data-stu-id="6dad9-139">The counter format might still be set to SMPTE 30, but the return value returns only a frame of 0.</span></span> <span data-ttu-id="6dad9-140">如果目前的時間類型為 counter，則此解析也會套用至 **狀態** 「位置」所傳回的值。</span><span class="sxs-lookup"><span data-stu-id="6dad9-140">If the current time type is counter, then this resolution applies also to the value returned by **status** "position".</span></span>

## <a name="capturing-frames"></a><span data-ttu-id="6dad9-141">捕獲框架</span><span class="sxs-lookup"><span data-stu-id="6dad9-141">Capturing Frames</span></span>

<span data-ttu-id="6dad9-142">框架捕獲命令可為 *框架捕獲裝置* 提供靜止的影像。</span><span class="sxs-lookup"><span data-stu-id="6dad9-142">Frame-capturing commands provide still images for a *frame-capture device*.</span></span> <span data-ttu-id="6dad9-143">畫面格捕獲裝置是一種可讀取和儲存影片影像的個別硬體。</span><span class="sxs-lookup"><span data-stu-id="6dad9-143">A frame-capture device is a separate piece of hardware capable of reading and storing the video image.</span></span> <span data-ttu-id="6dad9-144">VISCA 驅動程式支援 ([**MCI \_ 凍結**](mci-freeze.md)) 命令的 [**凍結**](freeze.md)，以穩定仍可進行捕捉的映射。</span><span class="sxs-lookup"><span data-stu-id="6dad9-144">The VISCA driver supports the [**freeze**](freeze.md) ([**MCI\_FREEZE**](mci-freeze.md)) command to stabilize a still image for capturing.</span></span> <span data-ttu-id="6dad9-145">此外， [**解除**](unfreeze.md) 凍結 ([**MCI \_ 解除凍結**](mci-unfreeze.md)) 命令可在 **凍結** 命令之後用來重新開機磁帶傳輸。</span><span class="sxs-lookup"><span data-stu-id="6dad9-145">Also, the [**unfreeze**](unfreeze.md) ([**MCI\_UNFREEZE**](mci-unfreeze.md)) command can be used to restart the tape transport following a **freeze** command.</span></span>

<span data-ttu-id="6dad9-146">**凍結** 命令可為框架捕獲裝置提供高品質、穩定、以時間為基礎的已更正映射。</span><span class="sxs-lookup"><span data-stu-id="6dad9-146">The **freeze** command provides a high-quality, stabilized, time-base – corrected image for a frame-capture device.</span></span> <span data-ttu-id="6dad9-147">這個命令存在的原因是，裝置在播放或暫停時，不一定會傳遞其最高品質的輸出影像;這類影片影像不適合用于捕捉。</span><span class="sxs-lookup"><span data-stu-id="6dad9-147">This command exists because a device might not always deliver its maximum-quality output image during playback or while paused; such a video image is not suitable for capturing.</span></span>

<span data-ttu-id="6dad9-148">**解除凍結** 命令會解除鎖定磁帶傳輸，並在 **凍結** 命令之前繼續作用中的傳輸模式。</span><span class="sxs-lookup"><span data-stu-id="6dad9-148">The **unfreeze** command unlocks the tape transport and resumes the transport mode in effect before the **freeze** command.</span></span>

<span data-ttu-id="6dad9-149">當您的應用程式需要在 VCR 上錄製影片影像時，請使用 [ **凍結** "輸入" 命令或 [**提示**](cue.md) ([**MCI \_ 提示**](mci-cue.md)) 命令來錄製映射。</span><span class="sxs-lookup"><span data-stu-id="6dad9-149">When your application needs to record a video image on the VCR, use the **freeze** "input" command or the [**cue**](cue.md) ([**MCI\_CUE**](mci-cue.md)) command to record the image.</span></span>

## <a name="selecting-inputs"></a><span data-ttu-id="6dad9-150">選取輸入</span><span class="sxs-lookup"><span data-stu-id="6dad9-150">Selecting Inputs</span></span>

<span data-ttu-id="6dad9-151">VISCA 驅動程式支援三種輸入類型：影片、音訊和時間碼。</span><span class="sxs-lookup"><span data-stu-id="6dad9-151">The VISCA driver supports three input types: video, audio, and timecode.</span></span> <span data-ttu-id="6dad9-152">影片輸入包括兩個標準頻道 (行1和 2) 、SVideo 通道、輔助通道，以及來自內部調諧器的通道。</span><span class="sxs-lookup"><span data-stu-id="6dad9-152">The video inputs include two standard channels (lines 1 and 2), an SVideo channel, an auxiliary channel, and a channel from an internal tuner.</span></span> <span data-ttu-id="6dad9-153">音訊輸入包括兩個標準頻道 (行1和 2) ，以及來自內部調諧器的通道。</span><span class="sxs-lookup"><span data-stu-id="6dad9-153">The audio inputs include two standard channels (lines 1 and 2) and a channel from an internal tuner.</span></span> <span data-ttu-id="6dad9-154">時間碼輸入是 VCR 的內部。</span><span class="sxs-lookup"><span data-stu-id="6dad9-154">The timecode input is internal to the VCR.</span></span>

<span data-ttu-id="6dad9-155">當錄影機正在錄製或磁帶傳輸停止時，一般輸出會包含目前所選取的輸入，當磁帶傳輸現正播放或暫停時，則會攜帶磁帶的內容。</span><span class="sxs-lookup"><span data-stu-id="6dad9-155">The normal outputs carry the currently selected inputs when the VCR is recording or when the tape transport is stopped, and they carry the contents of the videotape when the tape transport is playing or paused.</span></span> <span data-ttu-id="6dad9-156">受監視的輸出會包含與一般輸出相同的資訊，以及目前的時間碼和通道資訊。</span><span class="sxs-lookup"><span data-stu-id="6dad9-156">The monitored outputs carry the same information as the normal outputs plus current timecode and channel information.</span></span>

<span data-ttu-id="6dad9-157">假設適當的外部輸入已連線到您的 VCR，而您已決定要記錄的內容，您可以選取要錄製的輸入。</span><span class="sxs-lookup"><span data-stu-id="6dad9-157">Assuming the appropriate external inputs are connected to your VCR and you have decided what you want to record, you can select the inputs to be recorded.</span></span> <span data-ttu-id="6dad9-158">例如，若要從 "svideo" 影片和「行1」音訊輸入錄製或查看，您可以使用 [**setvideo**](setvideo.md) ([**mci \_ setvideo**](mci-setvideo.md)) 和 [**setaudio**](setaudio.md) ([**mci \_ setaudio**](mci-setaudio.md)) 命令來選取這些輸入來源。</span><span class="sxs-lookup"><span data-stu-id="6dad9-158">For example, to record or view from the "svideo" video and the "line 1" audio inputs, you would use the [**setvideo**](setvideo.md) ([**MCI\_SETVIDEO**](mci-setvideo.md)) and [**setaudio**](setaudio.md) ([**MCI\_SETAUDIO**](mci-setaudio.md)) commands to select these input sources.</span></span> <span data-ttu-id="6dad9-159">您可以使用 [**狀態**](status.md) ([**MCI \_ 狀態**](mci-status.md)) 命令來確認這些選項。</span><span class="sxs-lookup"><span data-stu-id="6dad9-159">You can verify these selections by using the [**status**](status.md) ([**MCI\_STATUS**](mci-status.md)) command.</span></span>

<span data-ttu-id="6dad9-160">依預設，監視器會顯示顯示為輸出的內容。</span><span class="sxs-lookup"><span data-stu-id="6dad9-160">By default, the monitor shows exactly what appears as the output.</span></span> <span data-ttu-id="6dad9-161">不過，有時候您可能會想要在記錄另一個來源時查看其中一個來源。</span><span class="sxs-lookup"><span data-stu-id="6dad9-161">Sometimes, however, you might want to view one source while recording from another.</span></span> <span data-ttu-id="6dad9-162">這是使用調諧器的常見作法。</span><span class="sxs-lookup"><span data-stu-id="6dad9-162">This is a common practice using the tuner.</span></span> <span data-ttu-id="6dad9-163">例如，您可能想要在錄製 channel 7 時觀賞 channel 4。</span><span class="sxs-lookup"><span data-stu-id="6dad9-163">For example, you might want to watch channel 4 while you record channel 7.</span></span> <span data-ttu-id="6dad9-164">在此情況下，您會有兩個邏輯調諧器輸入。</span><span class="sxs-lookup"><span data-stu-id="6dad9-164">In this case, you have two logical tuner inputs.</span></span> <span data-ttu-id="6dad9-165">您可以使用下列命令來設定 VCR：</span><span class="sxs-lookup"><span data-stu-id="6dad9-165">You could set up the VCR by using the following commands:</span></span>

## <a name="to-review-one-source-while-recording-from-another"></a><span data-ttu-id="6dad9-166">若要在記錄另一個來源時檢查它</span><span class="sxs-lookup"><span data-stu-id="6dad9-166">To review one source while recording from another</span></span>

1.  <span data-ttu-id="6dad9-167">使用 [**settuner**](settuner.md) ([**MCI \_ settuner**](mci-settuner.md)) 命令來選取要監看及錄製的通道。</span><span class="sxs-lookup"><span data-stu-id="6dad9-167">Use the [**settuner**](settuner.md) ([**MCI\_SETTUNER**](mci-settuner.md)) command to select the channels to watch and record.</span></span>
2.  <span data-ttu-id="6dad9-168">使用 **setvideo** 命令來選取影片錄製來源。</span><span class="sxs-lookup"><span data-stu-id="6dad9-168">Use the **setvideo** command to select the video-recording source.</span></span>
3.  <span data-ttu-id="6dad9-169">使用 [**setaudio**](setaudio.md) 命令來選取音訊錄製來源。</span><span class="sxs-lookup"><span data-stu-id="6dad9-169">Use the [**setaudio**](setaudio.md) command to select the audio-recording source.</span></span>
4.  <span data-ttu-id="6dad9-170">使用 [**setvideo**](setvideo.md) 命令將 channel 4 影片輸入路由傳送至受監視的輸出，以顯示在畫面上。</span><span class="sxs-lookup"><span data-stu-id="6dad9-170">Use the [**setvideo**](setvideo.md) command to route the channel 4 video input to the monitored output to display it on-screen.</span></span>
5.  <span data-ttu-id="6dad9-171">使用 [**setaudio**](setaudio.md) 命令將 channel 4 音訊輸入路由傳送至受監視的輸出，以播放音訊。</span><span class="sxs-lookup"><span data-stu-id="6dad9-171">Use the [**setaudio**](setaudio.md) command to route the channel 4 audio input to the monitored output to play the audio.</span></span>
6.  <span data-ttu-id="6dad9-172">使用 [**status**](status.md) 命令驗證您的選擇。</span><span class="sxs-lookup"><span data-stu-id="6dad9-172">Verify your selections by using the [**status**](status.md) command.</span></span>

<span data-ttu-id="6dad9-173">VISCA 驅動程式也支援音訊和影片的特殊輸入類型，稱為「 *靜音*」。</span><span class="sxs-lookup"><span data-stu-id="6dad9-173">The VISCA driver also supports a special input type for audio and video called *mute*.</span></span> <span data-ttu-id="6dad9-174">靜音允許選取 [沒有輸入]，這在錄製空白信號時會很有用。</span><span class="sxs-lookup"><span data-stu-id="6dad9-174">Mute allows the selection of "no input," which is useful when recording a blank signal.</span></span>

## <a name="selecting-recording-tracks"></a><span data-ttu-id="6dad9-175">選取錄製曲目</span><span class="sxs-lookup"><span data-stu-id="6dad9-175">Selecting Recording Tracks</span></span>

<span data-ttu-id="6dad9-176">磁帶上有三種類型的錄製播放軌：影片、音訊和時間碼。</span><span class="sxs-lookup"><span data-stu-id="6dad9-176">Three types of recording tracks exist on a videotape: video, audio, and timecode.</span></span> <span data-ttu-id="6dad9-177">您只有一個影片或時間碼播放軌，但您可以使用多個曲目。當您這樣做時，請追蹤主要的音訊播放軌。</span><span class="sxs-lookup"><span data-stu-id="6dad9-177">You have only one video or timecode track, but you can use more than one audio track. When you do so, make track 1 the main audio track.</span></span>

<span data-ttu-id="6dad9-178">VISCA 驅動程式支援兩種作業模式：組合和插入。</span><span class="sxs-lookup"><span data-stu-id="6dad9-178">The VISCA driver supports two operating modes: assemble and insert.</span></span> <span data-ttu-id="6dad9-179">在 *組合模式* 中，會選取要錄製的所有曲目。</span><span class="sxs-lookup"><span data-stu-id="6dad9-179">In *assemble mode*, all tracks are selected to be recorded.</span></span> <span data-ttu-id="6dad9-180">在 *插入模式* 中，可以針對錄製個別選取追蹤。</span><span class="sxs-lookup"><span data-stu-id="6dad9-180">In *insert mode*, tracks can be independently selected for recording.</span></span> <span data-ttu-id="6dad9-181">大部分的 Vcr 預設為組合模式。</span><span class="sxs-lookup"><span data-stu-id="6dad9-181">Most VCRs are in assemble mode by default.</span></span> <span data-ttu-id="6dad9-182">使用 [**set**](set.md) ([**MCI \_ set**](mci-set.md)) 命令變更這些模式。</span><span class="sxs-lookup"><span data-stu-id="6dad9-182">Use the [**set**](set.md) ([**MCI\_SET**](mci-set.md)) command to change these modes.</span></span>

## <a name="recording-and-editing"></a><span data-ttu-id="6dad9-183">錄製和編輯</span><span class="sxs-lookup"><span data-stu-id="6dad9-183">Recording and Editing</span></span>

<span data-ttu-id="6dad9-184">[**記錄**](record.md) ([**MCI \_ 記錄**](mci-record.md)) 命令提供簡單的記錄，且精確度大約為1秒的開始位置。</span><span class="sxs-lookup"><span data-stu-id="6dad9-184">The [**record**](record.md) ([**MCI\_RECORD**](mci-record.md)) command provides simple recording and is accurate to approximately 1 second of the starting position.</span></span> <span data-ttu-id="6dad9-185">若要更精確地錄製，或您想要在同時操作多個投影片時編輯影片內容，您應該使用 [**提示**](cue.md) ([**MCI \_ 提示**](mci-cue.md)) 命令。</span><span class="sxs-lookup"><span data-stu-id="6dad9-185">To record more accurately, or if you expect to edit the video content while simultaneously operating multiple decks, you should use the [**cue**](cue.md) ([**MCI\_CUE**](mci-cue.md)) command.</span></span>

<span data-ttu-id="6dad9-186">**提示** 命令會準備裝置以進行錄製或播放。</span><span class="sxs-lookup"><span data-stu-id="6dad9-186">The **cue** command prepares the device for recording or playing.</span></span> <span data-ttu-id="6dad9-187">使用 **提示** 「輸入」命令來準備裝置以進行錄製。</span><span class="sxs-lookup"><span data-stu-id="6dad9-187">Use the **cue** "input" command to prepare the device for recording.</span></span> <span data-ttu-id="6dad9-188">**提示** 命令是必要的，因為應用程式必須知道裝置是否已準備好執行命令 (，以及因為可能需要幾分鐘的時間來準備 [**play**](play.md) ([**MCI \_ play**](mci-play.md)) 或 **記錄** 命令) 。</span><span class="sxs-lookup"><span data-stu-id="6dad9-188">The **cue** command is required because an application must know when the device is ready to perform the command (and because it can take several minutes to prepare for a [**play**](play.md) ([**MCI\_PLAY**](mci-play.md)) or **record** command).</span></span>

<span data-ttu-id="6dad9-189">VCR 會藉由搜尋點對點（也就是目前的位置或使用 **提示**"from" 命令所指定的 *位置）來* 準備自己進行錄製或播放。</span><span class="sxs-lookup"><span data-stu-id="6dad9-189">The VCR prepares itself for recording or playing by seeking to the *in-point*, which is the current position or the position specified by using the **cue** "from" command.</span></span> <span data-ttu-id="6dad9-190">但是，如果以 **提示** 命令指定了「預先處理」旗標，則 VCR 的位置本身會是從點開始算起的距離。</span><span class="sxs-lookup"><span data-stu-id="6dad9-190">If the "preroll" flag is specified with the **cue** command, however, the VCR positions itself the preroll distance from the in-point.</span></span> <span data-ttu-id="6dad9-191">「預先執行」旗標也會指出 VCR 使用任何適用的編輯模式，因此請務必使用「預先進行」，特別是當您想要進行最精確的錄製時。</span><span class="sxs-lookup"><span data-stu-id="6dad9-191">The "preroll" flag also indicates that the VCR uses any applicable editing mode, so it's important that you use "preroll", especially when you want the most accurate recording.</span></span> <span data-ttu-id="6dad9-192"> (使用具有「可預先處理」旗標的 ([**MCI \_ GETDEVCAPS**](mci-getdevcaps.md)) 命令 [**功能**](capability.md)，來檢查是否支援預先處理模式。 ) </span><span class="sxs-lookup"><span data-stu-id="6dad9-192">(Use the [**capability**](capability.md) ([**MCI\_GETDEVCAPS**](mci-getdevcaps.md)) command with the "can preroll" flag to check whether the preroll mode is supported.)</span></span>

> [!Note]  
> <span data-ttu-id="6dad9-193">當您使用 "from" 和 "to" 位置記錄時，"from" 位置會包含在編輯中，而 "to" 位置則不會。</span><span class="sxs-lookup"><span data-stu-id="6dad9-193">When you record using "from" and "to" positions, the "from" position is included in the edit, and the "to" position is not.</span></span>

 

<span data-ttu-id="6dad9-194">如需錄製的詳細資訊，請參閱 [錄製](recording.md)。</span><span class="sxs-lookup"><span data-stu-id="6dad9-194">For more information about recording, see [Recording](recording.md).</span></span>

## <a name="using-the-clock-while-editing"></a><span data-ttu-id="6dad9-195">在編輯時使用時鐘</span><span class="sxs-lookup"><span data-stu-id="6dad9-195">Using the Clock While Editing</span></span>

<span data-ttu-id="6dad9-196">編輯時，您可能會想要將區段從一個 VCR 記錄到另一個。</span><span class="sxs-lookup"><span data-stu-id="6dad9-196">When editing, you might want to record segments from one VCR to another.</span></span> <span data-ttu-id="6dad9-197">您可以在特定時間開始記錄，並在另一個 VCR 開始播放，並指定動作 (播放或記錄) 、位置和每個 VCR 的時間。</span><span class="sxs-lookup"><span data-stu-id="6dad9-197">You can begin recording at a specific time and position on one VCR while another begins playing at the same time and position by specifying an action (play or record), a position, and a time for each VCR.</span></span>

<span data-ttu-id="6dad9-198">這兩個 Vcr 都必須使用相同的時鐘來進行這種類型的編輯;時鐘可協助同步處理這兩個裝置。</span><span class="sxs-lookup"><span data-stu-id="6dad9-198">Both VCRs must use the same clock for this type of editing; the clock helps synchronize both devices.</span></span> <span data-ttu-id="6dad9-199">您可以使用 [**狀態**](status.md) ([**MCI \_ 狀態**](mci-status.md)) 命令，並使用「時鐘識別碼」旗標來查詢每個 vcr，以判斷兩個 vcr 是否共用相同的時鐘。</span><span class="sxs-lookup"><span data-stu-id="6dad9-199">You can determine if two VCRs share the same clock by using the [**status**](status.md) ([**MCI\_STATUS**](mci-status.md)) command with the "clock id" flag to query each VCR.</span></span> <span data-ttu-id="6dad9-200">如果 **status** 命令傳回的識別碼相同，則裝置會使用相同的時鐘。</span><span class="sxs-lookup"><span data-stu-id="6dad9-200">If the identification numbers returned by the **status** command are the same, the devices use the same clock.</span></span> <span data-ttu-id="6dad9-201">作為共用資源，時鐘可以連接至多個 Vcr。</span><span class="sxs-lookup"><span data-stu-id="6dad9-201">As a shared resource, the clock can be connected to multiple VCRs.</span></span> <span data-ttu-id="6dad9-202">VISCA 驅動程式只支援一個共用時鐘。</span><span class="sxs-lookup"><span data-stu-id="6dad9-202">The VISCA driver supports only one shared clock.</span></span>

<span data-ttu-id="6dad9-203">您也可以使用「時鐘遞增率」 命令來判斷時鐘解析。</span><span class="sxs-lookup"><span data-stu-id="6dad9-203">You can also determine clock resolution by using the **status** "clock increment rate" command.</span></span> <span data-ttu-id="6dad9-204">此命令會傳回時鐘每秒支援的遞增數目。</span><span class="sxs-lookup"><span data-stu-id="6dad9-204">This command returns the number of increments the clock supports per second.</span></span> <span data-ttu-id="6dad9-205">例如，如果時鐘每毫秒更新一次，則命令會以頻率遞增率傳回1000。</span><span class="sxs-lookup"><span data-stu-id="6dad9-205">For example, if the clock is updated every millisecond, the command returns 1000 as the clock increment rate.</span></span> <span data-ttu-id="6dad9-206">使用遞增率的優點是以整數表示速率;否則，增量會是 (單或雙精確度) 浮點值。</span><span class="sxs-lookup"><span data-stu-id="6dad9-206">The advantage of using the increment rate is that the rate is expressed as an integer; otherwise, the increment would be a (single- or double-precision) floating-point value.</span></span> <span data-ttu-id="6dad9-207">以整數為單位，操作遞增率是簡單的作業，而且不容易舍入錯誤。</span><span class="sxs-lookup"><span data-stu-id="6dad9-207">As an integer, manipulating the increment rate is a simple operation and is not susceptible to rounding errors.</span></span> <span data-ttu-id="6dad9-208">您可以使用 [**set**](set.md) ([**MCI \_ set**](mci-set.md)) 命令搭配 "clock 0" (零) 旗標來重設時鐘。</span><span class="sxs-lookup"><span data-stu-id="6dad9-208">You can reset the clock by using the [**set**](set.md) ([**MCI\_SET**](mci-set.md)) command with the "clock 0" (zero) flag.</span></span>

<span data-ttu-id="6dad9-209">發出 [**play**](play.md) ([**MCI \_ play**](mci-play.md)) 、 [**記錄**](record.md) ([**MCI \_ 記錄**](mci-record.md)) 或 [**搜尋**](seek.md) ([**mci \_ 搜尋**](mci-seek.md)) 命令時，您可以指定要執行命令的時間。</span><span class="sxs-lookup"><span data-stu-id="6dad9-209">When issuing a [**play**](play.md) ([**MCI\_PLAY**](mci-play.md)), [**record**](record.md) ([**MCI\_RECORD**](mci-record.md)), or [**seek**](seek.md) ([**MCI\_SEEK**](mci-seek.md)) command, you can specify when the command is to be executed.</span></span> <span data-ttu-id="6dad9-210">所使用的 Vcr 特性會決定每個 VCR 的啟動時機。</span><span class="sxs-lookup"><span data-stu-id="6dad9-210">The characteristics of the VCRs being used determine when to start each VCR.</span></span> <span data-ttu-id="6dad9-211">時間必須考慮每個裝置所需的預先執行數量，以及完成用來設定編輯會話的 MCI 命令所需的時間量。</span><span class="sxs-lookup"><span data-stu-id="6dad9-211">The timing must account for the amount of preroll each device requires and the amount of time needed to complete the MCI commands used to set up the edit session.</span></span> <span data-ttu-id="6dad9-212">若要這樣做，請取出時鐘時間，並將等待間隔新增為5到10秒。</span><span class="sxs-lookup"><span data-stu-id="6dad9-212">To do this, retrieve the clock time and add a waiting interval of 5 to 10 seconds.</span></span> <span data-ttu-id="6dad9-213"> (等候間隔必須夠長，才能讓預先處理和任何未完成的 MCI 命令完成執行。 ) </span><span class="sxs-lookup"><span data-stu-id="6dad9-213">(The waiting interval must be long enough to let the preroll and any outstanding MCI commands finish executing.)</span></span>

<span data-ttu-id="6dad9-214">若要確保等待期間夠長，請將 [ **記錄** ] 命令最後放在應用程式中，然後檢查它之前的時間。</span><span class="sxs-lookup"><span data-stu-id="6dad9-214">To ensure that the waiting period is long enough, place the **record** command last in your application and check the time immediately before it.</span></span> <span data-ttu-id="6dad9-215">如果間隔太短，請重新開機 **播放** 命令。</span><span class="sxs-lookup"><span data-stu-id="6dad9-215">If the interval is too short, restart the **play** command.</span></span> <span data-ttu-id="6dad9-216">或者，您可以檢查腳本最後一個命令之後的時間，以確認有足夠的時間來傳送和完成所有命令。</span><span class="sxs-lookup"><span data-stu-id="6dad9-216">Alternatively, you could check the time immediately after the last command of the script to verify that there is enough time to send and complete all the commands.</span></span>

 

 




