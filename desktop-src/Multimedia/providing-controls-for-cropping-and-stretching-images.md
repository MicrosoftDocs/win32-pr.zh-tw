---
title: 提供用於裁剪和延展影像的控制項
description: 提供用於裁剪和延展影像的控制項
ms.assetid: cc62d70d-3f5f-477c-bc09-ab8ab0a9dce3
keywords:
- MCIWndGetSource 宏
- MCIWndPutSource 宏
- MCIWndGetDest 宏
- MCIWndPutDest 宏
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 9cd0889b40204e7c99ec782e454dba2cdeebfe79
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/19/2020
ms.locfileid: "103681735"
---
# <a name="providing-controls-for-cropping-and-stretching-images"></a><span data-ttu-id="811d9-107">提供用於裁剪和延展影像的控制項</span><span class="sxs-lookup"><span data-stu-id="811d9-107">Providing Controls for Cropping and Stretching Images</span></span>

<span data-ttu-id="811d9-108">MCIWnd 可讓您裁剪和延展影片剪輯的影像。</span><span class="sxs-lookup"><span data-stu-id="811d9-108">MCIWnd allows you to crop and stretch images of a video clip.</span></span> <span data-ttu-id="811d9-109">若要瞭解這些功能，您必須瞭解 *框架大小*、 *來源矩形*、 *目的地矩形* 和 *播放區域* 之間的關聯性。</span><span class="sxs-lookup"><span data-stu-id="811d9-109">To understand these features, you need to understand the relationships between *frame size*, *source rectangle*, *destination rectangle*, and *playback area*.</span></span>

<span data-ttu-id="811d9-110">影片剪輯由數個框架組成，每個都包含一個影像。</span><span class="sxs-lookup"><span data-stu-id="811d9-110">A video clip consists of several frames, each containing one image.</span></span> <span data-ttu-id="811d9-111">影片剪輯的框架大小是目前畫面格的影像大小。</span><span class="sxs-lookup"><span data-stu-id="811d9-111">The frame size of a video clip is the size of the image in the current frame.</span></span> <span data-ttu-id="811d9-112">影片剪輯通常有一個畫面格大小，因為剪輯中的所有影像大小都相同。</span><span class="sxs-lookup"><span data-stu-id="811d9-112">Typically, a video clip has one frame size because all the images in the clip are the same size.</span></span>

<span data-ttu-id="811d9-113">來源矩形是重迭影片剪輯框架的矩形區域。</span><span class="sxs-lookup"><span data-stu-id="811d9-113">The source rectangle is a rectangular area that overlays the frames of a video clip.</span></span> <span data-ttu-id="811d9-114">來源矩形會定義播放期間顯示之每個畫面格的部分。</span><span class="sxs-lookup"><span data-stu-id="811d9-114">The source rectangle defines the portion of each frame that is displayed during playback.</span></span> <span data-ttu-id="811d9-115">使用 MCIWnd 載入影片剪輯時，來源矩形會使用與影片剪輯的初始框架相同的維度和位置進行初始化。</span><span class="sxs-lookup"><span data-stu-id="811d9-115">When a video clip is loaded with MCIWnd, the source rectangle is initialized with the same dimensions and position as the initial frame of the video clip.</span></span>

<span data-ttu-id="811d9-116">目的地矩形是定義虛擬播放視窗的矩形區域。</span><span class="sxs-lookup"><span data-stu-id="811d9-116">The destination rectangle is a rectangular area that defines a virtual playback window.</span></span> <span data-ttu-id="811d9-117">目的地矩形會從影片剪輯的每個畫面格接收來源矩形的影像資料。</span><span class="sxs-lookup"><span data-stu-id="811d9-117">The destination rectangle receives the image data from the source rectangle for each frame of the video clip.</span></span> <span data-ttu-id="811d9-118">當來源和目的地矩形維度不同時，MCIWnd 會視需要以水準和垂直方式調整影像資料以填滿目的地矩形。</span><span class="sxs-lookup"><span data-stu-id="811d9-118">When the source and destination rectangle dimensions are different, MCIWnd adjusts the image data horizontally and vertically as needed to fill the destination rectangle.</span></span> <span data-ttu-id="811d9-119">使用 MCIWnd 載入影片剪輯時，會使用與影片剪輯的初始框架相同的維度和位置來初始化目的地矩形。</span><span class="sxs-lookup"><span data-stu-id="811d9-119">When a video clip is loaded with MCIWnd, the destination rectangle is initialized with the same dimensions and position as the initial frame of the video clip.</span></span>

<span data-ttu-id="811d9-120">播放區域是 MCIWnd 視窗中應用程式用來顯示影片剪輯的部分。</span><span class="sxs-lookup"><span data-stu-id="811d9-120">The playback area is the portion of an MCIWnd window an application uses to display the video clip.</span></span> <span data-ttu-id="811d9-121">播放區域是 MCIWnd 視窗的工作區，或工作區中排除 MCIWnd 工具列的部分。</span><span class="sxs-lookup"><span data-stu-id="811d9-121">The playback area is the client area of an MCIWnd window or the portion of the client area that excludes the MCIWnd toolbar.</span></span> <span data-ttu-id="811d9-122">使用 MCIWnd 載入影片剪輯時，會使用與影片剪輯的初始框架相同的維度和位置來初始化播放區域。</span><span class="sxs-lookup"><span data-stu-id="811d9-122">When a video clip is loaded with MCIWnd, the playback area is initialized with the same dimensions and position as the initial frame of the video clip.</span></span>

<span data-ttu-id="811d9-123">您可以使用 [**MCIWndGetSource**](/windows/desktop/api/Vfw/nf-vfw-mciwndgetsource) 和 [**MCIWndPutSource**](/windows/desktop/api/Vfw/nf-vfw-mciwndputsource) 宏來改變來源矩形，以裁剪影片剪輯。</span><span class="sxs-lookup"><span data-stu-id="811d9-123">You can crop a video clip by using the [**MCIWndGetSource**](/windows/desktop/api/Vfw/nf-vfw-mciwndgetsource) and [**MCIWndPutSource**](/windows/desktop/api/Vfw/nf-vfw-mciwndputsource) macros to alter the source rectangle.</span></span> <span data-ttu-id="811d9-124">裁剪影像只會決定播放期間顯示的畫面格部分;它不會改變所播放檔案的內容。</span><span class="sxs-lookup"><span data-stu-id="811d9-124">Cropping an image determines only which portion of the frames are displayed during playback; it does not alter the content of the file being played.</span></span> <span data-ttu-id="811d9-125">裁剪影像之前，您可以使用 **MCIWndGetSource** 來取出來源矩形的目前大小。</span><span class="sxs-lookup"><span data-stu-id="811d9-125">Before you crop an image, you can retrieve the current size of the source rectangle by using **MCIWndGetSource**.</span></span> <span data-ttu-id="811d9-126">計算來源矩形的新大小和位置之後，您可以使用 **MCIWndPutSource** 來設定來源矩形的裁剪界限。</span><span class="sxs-lookup"><span data-stu-id="811d9-126">After the new size and location of the source rectangle are calculated, you can set the cropping boundaries of the source rectangle by using **MCIWndPutSource**.</span></span>

<span data-ttu-id="811d9-127">您可以使用 [**MCIWndGetDest**](/windows/desktop/api/Vfw/nf-vfw-mciwndgetdest) 和 [**MCIWndPutDest**](/windows/desktop/api/Vfw/nf-vfw-mciwndputdest) 宏來改變目的地矩形，以延展影片剪輯。</span><span class="sxs-lookup"><span data-stu-id="811d9-127">You can stretch a video clip by using the [**MCIWndGetDest**](/windows/desktop/api/Vfw/nf-vfw-mciwndgetdest) and [**MCIWndPutDest**](/windows/desktop/api/Vfw/nf-vfw-mciwndputdest) macros to alter the destination rectangle.</span></span> <span data-ttu-id="811d9-128">當您延展影片剪輯時，您會以垂直、水準或雙向方式加長或縮短影片剪輯的框架大小。</span><span class="sxs-lookup"><span data-stu-id="811d9-128">When you stretch a video clip, you lengthen or shorten the frame size of a video clip vertically, horizontally, or in both directions.</span></span> <span data-ttu-id="811d9-129">在延展影像之前，您可以使用 **MCIWndGetDest** 來取出目的地矩形目前的大小和位置。</span><span class="sxs-lookup"><span data-stu-id="811d9-129">Before you stretch an image, you can retrieve the current size and location of the destination rectangle by using **MCIWndGetDest**.</span></span> <span data-ttu-id="811d9-130">**MCIWndPutDest** 宏可讓您重新定義目的地矩形。</span><span class="sxs-lookup"><span data-stu-id="811d9-130">The **MCIWndPutDest** macro allows you to redefine the destination rectangle.</span></span> <span data-ttu-id="811d9-131">延展可能會在播放期間扭曲影像，但不會改變所播放檔案的內容。</span><span class="sxs-lookup"><span data-stu-id="811d9-131">Stretching can distort the image during playback, but it does not alter the content of the file being played.</span></span>

<span data-ttu-id="811d9-132">如果目的地矩形的大小變得大於播放區域，您可以使用 **MCIWndPutDest** 來指定播放區域的哪個部分會顯示影片剪輯。</span><span class="sxs-lookup"><span data-stu-id="811d9-132">If the size of the destination rectangle becomes larger than the playback area, you can specify which portion of the playback area will display the video clip by using **MCIWndPutDest**.</span></span>

> [!Note]  
> <span data-ttu-id="811d9-133">[**MCIWndPutDest**](/windows/desktop/api/Vfw/nf-vfw-mciwndputdest)宏不會變更播放區域的大小。</span><span class="sxs-lookup"><span data-stu-id="811d9-133">The [**MCIWndPutDest**](/windows/desktop/api/Vfw/nf-vfw-mciwndputdest) macro does not change the size of the playback area.</span></span> <span data-ttu-id="811d9-134">若要將 MCIWnd 視窗和目的地矩形伸展，您需要知道 [MCIWnd] 視窗的目前大小，並根據目的地矩形來發出新的視窗尺寸。</span><span class="sxs-lookup"><span data-stu-id="811d9-134">To stretch the MCIWnd window along with the destination rectangle, you need to know the current size of the MCIWnd window and issue new window dimensions based on the destination rectangle.</span></span> <span data-ttu-id="811d9-135">您可以使用 [GetWindowRect](/windows/win32/api/winuser/nf-winuser-getwindowrect) 函數，並使用 [SetWindowPos](/windows/win32/api/winuser/nf-winuser-setwindowpos) 函數來調整 MCIWnd 視窗的大小，以抓取 MCIWnd 視窗維度。</span><span class="sxs-lookup"><span data-stu-id="811d9-135">You can retrieve the MCIWnd window dimensions by using the [GetWindowRect](/windows/win32/api/winuser/nf-winuser-getwindowrect) function and resize the MCIWnd window by using the [SetWindowPos](/windows/win32/api/winuser/nf-winuser-setwindowpos) function.</span></span>

 

 

 