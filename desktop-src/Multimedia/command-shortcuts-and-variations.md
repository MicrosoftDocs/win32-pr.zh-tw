---
title: 命令快捷方式和變化
description: 命令快捷方式和變化
ms.assetid: 4f854c78-435c-4a10-8938-645ad605fff3
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: a82ce41aaa9cc5744a2f199a7f7761111734e848
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 09/16/2019
ms.locfileid: "103674552"
---
# <a name="command-shortcuts-and-variations"></a>命令快捷方式和變化

使用 MCI 命令時，您可以使用數個快捷方式。 這些快捷方式可讓您使用單一識別碼來參考您的應用程式已開啟的所有裝置，或在未明確發出 [**開啟**](open.md) 的 ([**MCI \_ 開啟**](mci-open.md)) 命令的情況下開啟裝置。

您可以指定 "all" (MCI \_ 所有 \_ 裝置 \_ 識別碼) 作為任何未傳回信息之命令的裝置識別碼。 當您指定 "all" 時，MCI 會依序將命令傳送至目前應用程式所開啟的所有裝置。

例如， [**close**](close.md) "all" 命令會關閉所有開啟的裝置，而 [**play**](play.md) "all" 命令會開始播放應用程式所開啟的所有裝置。 由於 MCI 會依序將命令傳送至 MCI 裝置，因此第一個和最後一個裝置收到命令的間隔會有一段時間。

使用「全部」是將命令廣播到所有裝置的便利方法，但您不應該依賴它來同步處理裝置;訊息之間的時間可能會有所不同。

當您發出命令並指定未開啟的裝置時，MCI 會嘗試在執行命令之前先開啟裝置。 下列規則適用于自動開啟裝置：

-   自動開啟功能只適用于命令字串介面。
-   針對自訂設備磁碟機特定的命令，自動開啟功能會失敗。
-   自動開啟的裝置不會回應使用 "all" 作為裝置名稱的命令。
-   自動開啟功能不會讓您的應用程式指定「類型」旗標。 如果沒有裝置名稱，MCI 會從登錄中的專案決定裝置名稱。 若要使用特定的裝置，您可以使用 [ [**開啟**](open.md) ] 命令的參考資料中所述的驚嘆號來結合裝置名稱與檔案名。

如果應用程式使用自動開啟功能來開啟裝置，應用程式應該檢查每個後續開啟命令的傳回值，以確認裝置仍處於開啟狀態。 MCI 也會自動關閉自動開啟的任何裝置。 在下列情況下，MCI 通常會關閉裝置：

-   此命令已完成。
-   您會中止命令。
-   您會在後續命令中要求通知。
-   MCI 偵測到失敗。

 

 




