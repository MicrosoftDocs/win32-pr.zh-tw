---
description: " (Direct3D 10) 的 API 層"
ms.assetid: 19c81383-6ac7-49ea-98a3-bf761a32ab40
title: " (Direct3D 10) 的 API 層"
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 4427083bdcaf389c4b01b590a1bc3fef7eb878b4
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/07/2021
ms.locfileid: "104385892"
---
# <a name="api-layers-direct3d-10"></a><span data-ttu-id="1ae68-103"> (Direct3D 10) 的 API 層</span><span class="sxs-lookup"><span data-stu-id="1ae68-103">API Layers (Direct3D 10)</span></span>

<span data-ttu-id="1ae68-104">Direct3D 10 執行時間是以核心的基本功能為基礎，並在外部層建立選擇性和開發人員輔助的功能，並以層級進行。</span><span class="sxs-lookup"><span data-stu-id="1ae68-104">The Direct3D 10 runtime is constructed with layers, starting with the basic functionality at the core and building optional and developer-assist functionality in outer layers.</span></span>

## <a name="core-layer"></a><span data-ttu-id="1ae68-105">核心層</span><span class="sxs-lookup"><span data-stu-id="1ae68-105">Core Layer</span></span>

<span data-ttu-id="1ae68-106">核心層預設為存在;在 API 和設備磁碟機之間提供非常精簡的對應，將高頻率呼叫的額外負荷降至最低。</span><span class="sxs-lookup"><span data-stu-id="1ae68-106">The core layer exists by default; providing a very thin mapping between the API and the device driver, minimizing overhead for high-frequency calls.</span></span> <span data-ttu-id="1ae68-107">因為核心層是效能不可或缺的，所以它只會執行重大驗證。</span><span class="sxs-lookup"><span data-stu-id="1ae68-107">As the core layer is essential for performance, it only performs critical validation.</span></span>

<span data-ttu-id="1ae68-108">其餘層是選擇性的。</span><span class="sxs-lookup"><span data-stu-id="1ae68-108">The remaining layers are optional.</span></span> <span data-ttu-id="1ae68-109">一般來說，圖層會加入功能，但不會修改現有的行為。</span><span class="sxs-lookup"><span data-stu-id="1ae68-109">As a general rule, layers add functionality, but do not modify existing behavior.</span></span> <span data-ttu-id="1ae68-110">例如，除了要具現化的調試層之外，核心函式的傳回值也會與所具現化的調試層有相同的傳回值。</span><span class="sxs-lookup"><span data-stu-id="1ae68-110">For example, core functions will have the same return values independent of the debug layer being instantiated, although additional debug output may be provided if the debug layer is instantiated.</span></span>

<span data-ttu-id="1ae68-111">藉由呼叫 [**D3D10CreateDevice**](/windows/desktop/api/D3D10Misc/nf-d3d10misc-d3d10createdevice) 並提供一或多個 [**D3D10 \_ 建立 \_ 裝置 \_ 旗**](/windows/desktop/api/D3D10/ne-d3d10-d3d10_create_device_flag) 標值來建立裝置時，請建立圖層。</span><span class="sxs-lookup"><span data-stu-id="1ae68-111">Create layers when a device is created by calling [**D3D10CreateDevice**](/windows/desktop/api/D3D10Misc/nf-d3d10misc-d3d10createdevice) and supplying one or more [**D3D10\_CREATE\_DEVICE\_FLAG**](/windows/desktop/api/D3D10/ne-d3d10-d3d10_create_device_flag) values.</span></span>

## <a name="debug-layer"></a><span data-ttu-id="1ae68-112">Debug 圖層</span><span class="sxs-lookup"><span data-stu-id="1ae68-112">Debug Layer</span></span>

<span data-ttu-id="1ae68-113">Debug 層提供大量的額外參數和一致性驗證 (例如驗證著色器連結和資源系結、驗證參數一致性，以及報告錯誤描述) 。</span><span class="sxs-lookup"><span data-stu-id="1ae68-113">The debug layer provides extensive additional parameter and consistency validation (such as validating shader linkage and resource binding, validating parameter consistency, and reporting error descriptions).</span></span> <span data-ttu-id="1ae68-114">Debug 層所產生的輸出包含可使用 [**ID3D10InfoQueue 介面**](/windows/desktop/api/D3D10SDKLayers/nn-d3d10sdklayers-id3d10infoqueue) 存取的字串佇列 (請參閱 [使用 ID3D10InfoQueue (Direct3D 10) ) 自訂偵錯工具輸出](d3d10-graphics-programming-guide-api-features-layers-info-queue.md) 。</span><span class="sxs-lookup"><span data-stu-id="1ae68-114">The output generated by the debug layer consists of a queue of strings which are accessible using the [**ID3D10InfoQueue Interface**](/windows/desktop/api/D3D10SDKLayers/nn-d3d10sdklayers-id3d10infoqueue) (see [Customize Debug Output with ID3D10InfoQueue (Direct3D 10)](d3d10-graphics-programming-guide-api-features-layers-info-queue.md)).</span></span> <span data-ttu-id="1ae68-115">核心層產生的錯誤會以調試層的警告反白顯示。</span><span class="sxs-lookup"><span data-stu-id="1ae68-115">Errors generated by the core layer are highlighted with warnings by the debug layer.</span></span>

<span data-ttu-id="1ae68-116">若要建立支援 debug 層的裝置，您必須安裝 DirectX SDK (才能取得 D3D10SDKLayers.DLL) ，然後在 \_ \_ \_ 呼叫 [**D3D10CreateDevice**](/windows/desktop/api/D3D10Misc/nf-d3d10misc-d3d10createdevice)時指定 D3D10 建立裝置的偵錯工具旗標。</span><span class="sxs-lookup"><span data-stu-id="1ae68-116">To create a device that supports the debug layer, you must install the DirectX SDK (to get D3D10SDKLayers.DLL), and then specify the D3D10\_CREATE\_DEVICE\_DEBUG flag when calling [**D3D10CreateDevice**](/windows/desktop/api/D3D10Misc/nf-d3d10misc-d3d10createdevice).</span></span> <span data-ttu-id="1ae68-117">當然，使用 debug 層執行應用程式的速度將會大幅降低。</span><span class="sxs-lookup"><span data-stu-id="1ae68-117">Of course, running an application with the debug layer will be substantially slower.</span></span> <span data-ttu-id="1ae68-118">若要啟用/停用 D3DX10 Api 的偵錯工具訊息，請呼叫 [**D3DX10DebugMute**](d3dx10debugmute.md)。</span><span class="sxs-lookup"><span data-stu-id="1ae68-118">To enable/disable debug messages for D3DX10 APIs, call [**D3DX10DebugMute**](d3dx10debugmute.md).</span></span>

<span data-ttu-id="1ae68-119">當 debug 圖層列出記憶體流失時，它會輸出物件介面指標清單及其易記名稱。</span><span class="sxs-lookup"><span data-stu-id="1ae68-119">When the debug layer lists memory leaks, it outputs a list of object interface pointers along with their friendly names.</span></span> <span data-ttu-id="1ae68-120">預設的易記名稱是「 &lt; 未命名」 &gt; 。</span><span class="sxs-lookup"><span data-stu-id="1ae68-120">The default friendly name is "&lt;unnamed&gt;".</span></span> <span data-ttu-id="1ae68-121">您可以使用 [**ID3D10DeviceChild：： SetPrivateData**](/windows/desktop/api/D3D10/nf-d3d10-id3d10devicechild-setprivatedata) 方法以及 D3Dcommon 中的 **WKPDID \_ D3DDebugObjectName** GUID 來設定易記名稱。</span><span class="sxs-lookup"><span data-stu-id="1ae68-121">You can set the friendly name by using the [**ID3D10DeviceChild::SetPrivateData**](/windows/desktop/api/D3D10/nf-d3d10-id3d10devicechild-setprivatedata) method and the **WKPDID\_D3DDebugObjectName** GUID that is in D3Dcommon.h.</span></span> <span data-ttu-id="1ae68-122">例如，若要以 SDKLayer 名稱 mytexture.jpg 命名 pTexture，請使用下列程式碼：</span><span class="sxs-lookup"><span data-stu-id="1ae68-122">For example, to name pTexture with a SDKLayer name of mytexture.jpg, use the following code:</span></span>


```
const char c_szName[] = "mytexture.jpg";
pTexture->SetPrivateData( WKPDID_D3DDebugObjectName, sizeof( c_szName ) - 1, c_szName );
```



<span data-ttu-id="1ae68-123">一般而言，您應該從生產版本編譯這些呼叫。</span><span class="sxs-lookup"><span data-stu-id="1ae68-123">Typically, you should compile these calls out of your production version.</span></span>

## <a name="switch-to-reference-layer"></a><span data-ttu-id="1ae68-124">切換至參考圖層</span><span class="sxs-lookup"><span data-stu-id="1ae68-124">Switch-to-Reference Layer</span></span>

<span data-ttu-id="1ae68-125">這一層可讓應用程式在硬體裝置 (HAL) 和參照或軟體裝置 (REF) 之間進行轉換。</span><span class="sxs-lookup"><span data-stu-id="1ae68-125">This layer enables an application to transition between a hardware device (HAL) and a reference or software device (REF).</span></span> <span data-ttu-id="1ae68-126">若要切換裝置，您必須先建立支援切換至參考層的裝置 (請參閱 [**D3D10CreateDevice**](/windows/desktop/api/D3D10Misc/nf-d3d10misc-d3d10createdevice)) ，然後呼叫 [**ID3D10SwitchToRef：： SetUseRef**](/windows/desktop/api/D3D10SDKLayers/nf-d3d10sdklayers-id3d10switchtoref-setuseref)。</span><span class="sxs-lookup"><span data-stu-id="1ae68-126">To switch a device, you must first create a device that supports the switch-to-reference layer (see [**D3D10CreateDevice**](/windows/desktop/api/D3D10Misc/nf-d3d10misc-d3d10createdevice)) and then call [**ID3D10SwitchToRef::SetUseRef**](/windows/desktop/api/D3D10SDKLayers/nf-d3d10sdklayers-id3d10switchtoref-setuseref).</span></span>

<span data-ttu-id="1ae68-127">所有裝置狀態、資源和物件都會透過此裝置轉換進行維護。</span><span class="sxs-lookup"><span data-stu-id="1ae68-127">All device states, resources and objects are maintained through this device transition.</span></span> <span data-ttu-id="1ae68-128">不過，有時不可能完全符合資源資料。</span><span class="sxs-lookup"><span data-stu-id="1ae68-128">However, it is sometimes not possible to exactly match resource data.</span></span> <span data-ttu-id="1ae68-129">這是因為某些資訊可供參考裝置無法使用的硬體裝置使用。</span><span class="sxs-lookup"><span data-stu-id="1ae68-129">This is due to the fact that some information is available to a hardware device that is not available to a reference device.</span></span>

<span data-ttu-id="1ae68-130">幾乎所有的即時應用程式都會使用管線的 HAL 實作為。</span><span class="sxs-lookup"><span data-stu-id="1ae68-130">Virtually all real-time applications use the HAL implementation of the pipeline.</span></span> <span data-ttu-id="1ae68-131">當管線從硬體裝置切換至參照裝置時，轉譯作業會同時在硬體和軟體中完成。</span><span class="sxs-lookup"><span data-stu-id="1ae68-131">When the pipeline is switched from a hardware device to a reference device, rendering operations are done simultaneously in both hardware and software.</span></span> <span data-ttu-id="1ae68-132">當軟體裝置呈現時，會要求將資源下載至系統記憶體。</span><span class="sxs-lookup"><span data-stu-id="1ae68-132">As the software device is rendering, it will require that resources are downloaded to system memory.</span></span> <span data-ttu-id="1ae68-133">這可能需要在系統記憶體中快取的其他資源被收回，以騰出空間。</span><span class="sxs-lookup"><span data-stu-id="1ae68-133">This may require other resources cached in system memory to be evicted to make room.</span></span>

> [!Note]  
> <span data-ttu-id="1ae68-134">只有 Direct3D 10 和 Direct3D 10.1 才支援這個切換至參考層功能，而且在 Direct3D 11 和更新版本中已不再支援。</span><span class="sxs-lookup"><span data-stu-id="1ae68-134">This switch-to-reference-layer feature is supported only in Direct3D 10 and Direct3D 10.1, and is no longer supported in Direct3D 11 and later versions.</span></span>

 

## <a name="thread-safe-layer"></a><span data-ttu-id="1ae68-135">Thread-Safe 層</span><span class="sxs-lookup"><span data-stu-id="1ae68-135">Thread-Safe Layer</span></span>

<span data-ttu-id="1ae68-136">這一層的設計目的是讓多執行緒應用程式從多個執行緒存取裝置。</span><span class="sxs-lookup"><span data-stu-id="1ae68-136">This layer is designed to allow multi-threaded applications to access the device from multiple threads.</span></span>

<span data-ttu-id="1ae68-137">Direct3D 10 應用程式可以使用裝置功能來控制裝置同步處理。</span><span class="sxs-lookup"><span data-stu-id="1ae68-137">A Direct3D 10 application can control a device synchronization using device functions.</span></span> <span data-ttu-id="1ae68-138">這可讓應用程式啟用/停用重要區段 (暫時啟用/停用多執行緒保護) ，以及在多個 Direct3D 10 API 進入點上取得/釋放重要區段鎖定。</span><span class="sxs-lookup"><span data-stu-id="1ae68-138">This enables an application to enable/disable critical sections (temporarily enabling/disabling multithreading protection), and take/release a critical-section lock over multiple Direct3D 10 API entry points.</span></span> <span data-ttu-id="1ae68-139">預設會啟用執行緒安全層。</span><span class="sxs-lookup"><span data-stu-id="1ae68-139">The thread-safe layer is enabled by default.</span></span> <span data-ttu-id="1ae68-140">針對單一執行緒應用程式，執行緒安全層不會影響效能。</span><span class="sxs-lookup"><span data-stu-id="1ae68-140">For single-threaded applications, the thread-safe layer has no impact on performance.</span></span>



|                                                                                                                                             |
|---------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="1ae68-141">Direct3D 9 與 Direct3D 10 之間的差異：</span><span class="sxs-lookup"><span data-stu-id="1ae68-141">Differences between Direct3D 9 and Direct3D 10:</span></span><br/> <span data-ttu-id="1ae68-142">與 Direct3D 9 不同的是，Direct3D 10 API 預設為完全安全線程。</span><span class="sxs-lookup"><span data-stu-id="1ae68-142">Unlike Direct3D 9, the Direct3D 10 API defaults to fully thread-safe.</span></span><br/> |



 

## <a name="related-topics"></a><span data-ttu-id="1ae68-143">相關主題</span><span class="sxs-lookup"><span data-stu-id="1ae68-143">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="1ae68-144"> (Direct3D 10) 的 API 功能 </span><span class="sxs-lookup"><span data-stu-id="1ae68-144">API Features (Direct3D 10)</span></span>](d3d10-graphics-programming-guide-api-features.md)
</dt> </dl>

 

 




