---
title: WM_POINTERDOWN 訊息
description: 當指標在視窗的工作區上進行接觸時張貼。
ms.assetid: 3bdc37da-227c-4be1-bf0b-99704b8ac000
keywords:
- WM_POINTERDOWN 訊息輸入訊息和通知
topic_type:
- apiref
api_name:
- WM_POINTERDOWN
api_location:
- Winuser.h
api_type:
- HeaderDef
ms.topic: article
ms.date: 02/03/2020
ms.openlocfilehash: 9f94bf4474e208d0b1d29df7a5e2939d7826ca77
ms.sourcegitcommit: 1f917afc149b5cc449a4a25a87de311e4842734b
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 07/13/2021
ms.locfileid: "113689201"
---
# <a name="wm_pointerdown-message"></a><span data-ttu-id="183f8-104">WM_POINTERDOWN 訊息</span><span class="sxs-lookup"><span data-stu-id="183f8-104">WM_POINTERDOWN message</span></span>

<span data-ttu-id="183f8-105">當指標在視窗的工作區上進行接觸時張貼。</span><span class="sxs-lookup"><span data-stu-id="183f8-105">Posted when a pointer makes contact over the client area of a window.</span></span> <span data-ttu-id="183f8-106">此輸入訊息會以指標所用的視窗為目標，並以隱含方式將指標捕捉至視窗，讓視窗繼續接收指標的輸入，直到中斷連絡人為止。</span><span class="sxs-lookup"><span data-stu-id="183f8-106">This input message targets the window over which the pointer makes contact, and the pointer is implicitly captured to the window so that the window continues to receive input for the pointer until it breaks contact.</span></span>

<span data-ttu-id="183f8-107">視窗會透過其 [**WindowProc**](/previous-versions/windows/desktop/legacy/ms633573(v=vs.85)) 函數接收此訊息。</span><span class="sxs-lookup"><span data-stu-id="183f8-107">A window receives this message through its [**WindowProc**](/previous-versions/windows/desktop/legacy/ms633573(v=vs.85)) function.</span></span>

> <span data-ttu-id="183f8-108">\[!重要\]</span><span class="sxs-lookup"><span data-stu-id="183f8-108">\[!Important\]</span></span>  
> <span data-ttu-id="183f8-109">桌面應用程式應該要感知 DPI。</span><span class="sxs-lookup"><span data-stu-id="183f8-109">Desktop apps should be DPI aware.</span></span> <span data-ttu-id="183f8-110">如果您的應用程式不是 DPI 感知，指標訊息和相關結構中所包含的螢幕座標可能會因為 DPI 虛擬化而出現不正確的情況。</span><span class="sxs-lookup"><span data-stu-id="183f8-110">If your app is not DPI aware, screen coordinates contained in pointer messages and related structures might appear inaccurate due to DPI virtualization.</span></span> <span data-ttu-id="183f8-111">DPI 虛擬化提供自動調整支援給非 DPI 感知的應用程式，而且預設為使用中 (使用者可以關閉) 。</span><span class="sxs-lookup"><span data-stu-id="183f8-111">DPI virtualization provides automatic scaling support to applications that are not DPI aware and is active by default (users can turn it off).</span></span> <span data-ttu-id="183f8-112">如需詳細資訊，請參閱 [撰寫高 DPI 的 Win32 應用程式](/previous-versions//dd464660(v=vs.85))。</span><span class="sxs-lookup"><span data-stu-id="183f8-112">For more information, see [Writing High-DPI Win32 Applications](/previous-versions//dd464660(v=vs.85)).</span></span>

 


```C++
#define WM_POINTERDOWN                   0x0246
```



## <a name="parameters"></a><span data-ttu-id="183f8-113">參數</span><span class="sxs-lookup"><span data-stu-id="183f8-113">Parameters</span></span>

<dl> <dt>

<span data-ttu-id="183f8-114">*wParam*</span><span class="sxs-lookup"><span data-stu-id="183f8-114">*wParam*</span></span> 
</dt> <dd>

<span data-ttu-id="183f8-115">包含指標的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="183f8-115">Contains information about the pointer.</span></span> <span data-ttu-id="183f8-116">使用下列宏從 wParam 參數取出資訊。</span><span class="sxs-lookup"><span data-stu-id="183f8-116">Use the following macros to retrieve information from the wParam parameter.</span></span>

-   <span data-ttu-id="183f8-117">[**GET_POINTERID_WPARAM**](/previous-versions/windows/desktop/api) (WPARAM) ：指標識別碼。</span><span class="sxs-lookup"><span data-stu-id="183f8-117">[**GET_POINTERID_WPARAM**](/previous-versions/windows/desktop/api)(wParam): the pointer identifier.</span></span>
-   <span data-ttu-id="183f8-118">[**IS_POINTER_NEW_WPARAM**](/previous-versions/windows/desktop/api) (WPARAM) ：指出此訊息是否代表新指標所產生之第一個輸入的旗標。</span><span class="sxs-lookup"><span data-stu-id="183f8-118">[**IS_POINTER_NEW_WPARAM**](/previous-versions/windows/desktop/api)(wParam): a flag that indicates whether this message represents the first input generated by a new pointer.</span></span>
-   <span data-ttu-id="183f8-119">[**IS_POINTER_INRANGE_WPARAM**](/previous-versions/windows/desktop/api) (WPARAM) ：此旗標會指出此訊息是否會在其存留期間由指標產生。</span><span class="sxs-lookup"><span data-stu-id="183f8-119">[**IS_POINTER_INRANGE_WPARAM**](/previous-versions/windows/desktop/api)(wParam): a flag that indicates whether this message was generated by a pointer during its lifetime.</span></span> <span data-ttu-id="183f8-120">未在指出指標具有左方偵測範圍的訊息上設定此旗標</span><span class="sxs-lookup"><span data-stu-id="183f8-120">This flag is not set on messages that indicate that the pointer has left detection range</span></span>
-   <span data-ttu-id="183f8-121">[**IS_POINTER_INCONTACT_WPARAM**](/previous-versions/windows/desktop/api) (WPARAM) ：此旗標會指出此訊息是否由與視窗介面聯繫的指標所產生。</span><span class="sxs-lookup"><span data-stu-id="183f8-121">[**IS_POINTER_INCONTACT_WPARAM**](/previous-versions/windows/desktop/api)(wParam): a flag that indicates whether this message was generated by a pointer that is in contact with the window surface.</span></span> <span data-ttu-id="183f8-122">此旗標不會設定在指出暫留指標的訊息上。</span><span class="sxs-lookup"><span data-stu-id="183f8-122">This flag is not set on messages that indicate a hovering pointer.</span></span>
-   <span data-ttu-id="183f8-123">[**IS_POINTER_PRIMARY_WPARAM**](/previous-versions/windows/desktop/api) (WPARAM) ：表示此指標已指定為主要指標。</span><span class="sxs-lookup"><span data-stu-id="183f8-123">[**IS_POINTER_PRIMARY_WPARAM**](/previous-versions/windows/desktop/api)(wParam): indicates that this pointer has been designated as primary.</span></span>
-   <span data-ttu-id="183f8-124">[**IS_POINTER_FIRSTBUTTON_WPARAM**](/previous-versions/windows/desktop/api) (WPARAM) ：指出是否有主要動作的旗標。</span><span class="sxs-lookup"><span data-stu-id="183f8-124">[**IS_POINTER_FIRSTBUTTON_WPARAM**](/previous-versions/windows/desktop/api)(wParam): a flag that indicates whether there is a primary action.</span></span>
    -   <span data-ttu-id="183f8-125">這類似于按下滑鼠左鍵。</span><span class="sxs-lookup"><span data-stu-id="183f8-125">This is analogous to a mouse left button down.</span></span>
    -   <span data-ttu-id="183f8-126">當觸控指標與數位板介面聯繫時，會有此設定。</span><span class="sxs-lookup"><span data-stu-id="183f8-126">A touch pointer will have this set when it is in contact with the digitizer surface.</span></span>
    -   <span data-ttu-id="183f8-127">當畫筆指標與數位板介面聯繫時，如果未按下任何按鈕，就會有此設定。</span><span class="sxs-lookup"><span data-stu-id="183f8-127">A pen pointer will have this set when it is in contact with the digitizer surface with no buttons pressed.</span></span>
-   <span data-ttu-id="183f8-128">[**IS_POINTER_SECONDBUTTON_WPARAM**](/previous-versions/windows/desktop/api) (WPARAM) ：指出是否有次要動作的旗標。</span><span class="sxs-lookup"><span data-stu-id="183f8-128">[**IS_POINTER_SECONDBUTTON_WPARAM**](/previous-versions/windows/desktop/api)(wParam): a flag that indicates whether there is a secondary action.</span></span>
    -   <span data-ttu-id="183f8-129">這類似于滑鼠右鍵向下按鈕。</span><span class="sxs-lookup"><span data-stu-id="183f8-129">This is analogous to a mouse right button down.</span></span>
    -   <span data-ttu-id="183f8-130">當畫筆指標與數位板介面聯繫時，如果已按下畫筆圓筒按鈕，就會有此設定。</span><span class="sxs-lookup"><span data-stu-id="183f8-130">A pen pointer will have this set when it is in contact with the digitizer surface with the pen barrel button pressed.</span></span>
-   <span data-ttu-id="183f8-131">[**IS_POINTER_THIRDBUTTON_WPARAM**](/previous-versions/windows/desktop/api) (WPARAM) ：旗標，指出是否有一或多個以指標類型為基礎的三個動作;想要回應第三個動作的應用程式必須抓取指標類型的特定資訊，以判斷要按下的第三個按鈕。</span><span class="sxs-lookup"><span data-stu-id="183f8-131">[**IS_POINTER_THIRDBUTTON_WPARAM**](/previous-versions/windows/desktop/api)(wParam): a flag that indicates whether there are one or more tertiary actions based on the pointer type; applications that wish to respond to tertiary actions must retrieve information specific to the pointer type to determine which tertiary buttons are pressed.</span></span> <span data-ttu-id="183f8-132">例如，應用程式可以藉由呼叫 [**GetPointerPenInfo**](/previous-versions/windows/desktop/api) 和檢查指定按鈕狀態的旗標，判斷畫筆的按鈕狀態。</span><span class="sxs-lookup"><span data-stu-id="183f8-132">For example, an application can determine the buttons states of a pen by calling [**GetPointerPenInfo**](/previous-versions/windows/desktop/api) and examining the flags that specify button states.</span></span>
-   <span data-ttu-id="183f8-133">[**IS_POINTER_FOURTHBUTTON_WPARAM**](/previous-versions/windows/desktop/api) (WPARAM) ：指出指定的指標是否採取第四個動作的旗標。</span><span class="sxs-lookup"><span data-stu-id="183f8-133">[**IS_POINTER_FOURTHBUTTON_WPARAM**](/previous-versions/windows/desktop/api)(wParam): a flag that indicates whether the specified pointer took fourth action.</span></span> <span data-ttu-id="183f8-134">想要回應第四個動作的應用程式必須抓取指標類型的特定資訊，以判斷是否按下第一個擴充滑鼠 (XButton1) 按鈕。</span><span class="sxs-lookup"><span data-stu-id="183f8-134">Applications that wish to respond to fourth actions must retrieve information specific to the pointer type to determine if the first extended mouse (XButton1) button is pressed.</span></span>
-   <span data-ttu-id="183f8-135">[**IS_POINTER_FIFTHBUTTON_WPARAM**](/previous-versions/windows/desktop/api) (WPARAM) ： [**旗**](pointer-flags-contants.md) 標，指出指定的指標是否花費第五個動作。</span><span class="sxs-lookup"><span data-stu-id="183f8-135">[**IS_POINTER_FIFTHBUTTON_WPARAM**](/previous-versions/windows/desktop/api)(wParam): a [**flag**](pointer-flags-contants.md) that indicates whether the specified pointer took fifth action.</span></span> <span data-ttu-id="183f8-136">想要回應第五個動作的應用程式必須抓取指標類型的特定資訊，以判斷是否按下第二個擴充滑鼠 (XButton2) 按鈕。</span><span class="sxs-lookup"><span data-stu-id="183f8-136">Applications that wish to respond to fifth actions must retrieve information specific to the pointer type to determine if the second extended mouse (XButton2) button is pressed.</span></span>

    <span data-ttu-id="183f8-137">如需詳細資訊，請參閱 [**指標旗標**](pointer-flags-contants.md) 。</span><span class="sxs-lookup"><span data-stu-id="183f8-137">See [**Pointer Flags**](pointer-flags-contants.md) for more details.</span></span>

    > [!Note]  
    > <span data-ttu-id="183f8-138">停留指標沒有設定按鈕旗標。</span><span class="sxs-lookup"><span data-stu-id="183f8-138">A hovering pointer has none of the button flags set.</span></span> <span data-ttu-id="183f8-139">這類似于未按下滑鼠按鍵的滑鼠移動。</span><span class="sxs-lookup"><span data-stu-id="183f8-139">This is analogous to a mouse move with no mouse buttons down.</span></span> <span data-ttu-id="183f8-140">應用程式可以藉由呼叫 [**GetPointerPenInfo**](/previous-versions/windows/desktop/api) 和檢查指定按鈕狀態的旗標，來決定暫留畫筆的按鈕狀態。</span><span class="sxs-lookup"><span data-stu-id="183f8-140">An application can determine the buttons states of a hovering pen, for example, by calling [**GetPointerPenInfo**](/previous-versions/windows/desktop/api) and examining the flags that specify button states.</span></span>

     

</dd> <dt>

<span data-ttu-id="183f8-141">*lParam*</span><span class="sxs-lookup"><span data-stu-id="183f8-141">*lParam*</span></span> 
</dt> <dd>

<span data-ttu-id="183f8-142">包含指標的點位置。</span><span class="sxs-lookup"><span data-stu-id="183f8-142">Contains the point location of the pointer.</span></span>

> [!Note]  
> <span data-ttu-id="183f8-143">因為指標可能會透過非一般區域與裝置聯繫，所以這個點位置可以簡化更複雜的指標區域。</span><span class="sxs-lookup"><span data-stu-id="183f8-143">Because the pointer may make contact with the device over a non-trivial area, this point location may be a simplification of a more complex pointer area.</span></span> <span data-ttu-id="183f8-144">如果可能的話，應用程式應該使用完整的指標區域資訊，而不是點位置。</span><span class="sxs-lookup"><span data-stu-id="183f8-144">Whenever possible, an application should use the complete pointer area information instead of the point location.</span></span>

 

<span data-ttu-id="183f8-145">您可以使用下列宏來取出點的實際螢幕座標。</span><span class="sxs-lookup"><span data-stu-id="183f8-145">Use the following macros to retrieve the physical screen coordinates of the point.</span></span>

-   <span data-ttu-id="183f8-146">[**GET_X_LPARAM**](/windows/win32/api/windowsx/nf-windowsx-get_x_lparam) (LPARAM) ： X (水準點) 座標。</span><span class="sxs-lookup"><span data-stu-id="183f8-146">[**GET_X_LPARAM**](/windows/win32/api/windowsx/nf-windowsx-get_x_lparam)(lParam): the x (horizontal point) coordinate.</span></span>
-   <span data-ttu-id="183f8-147">[**GET_Y_LPARAM**](/windows/win32/api/windowsx/nf-windowsx-get_y_lparam) (LPARAM) ： Y (垂直點) 座標。</span><span class="sxs-lookup"><span data-stu-id="183f8-147">[**GET_Y_LPARAM**](/windows/win32/api/windowsx/nf-windowsx-get_y_lparam)(lParam): the y (vertical point) coordinate.</span></span>

</dd> </dl>

## <a name="return-value"></a><span data-ttu-id="183f8-148">傳回值</span><span class="sxs-lookup"><span data-stu-id="183f8-148">Return value</span></span>

<span data-ttu-id="183f8-149">如果應用程式處理此訊息，它應該會傳回零。</span><span class="sxs-lookup"><span data-stu-id="183f8-149">If an application processes this message, it should return zero.</span></span>

<span data-ttu-id="183f8-150">如果應用程式未處理此訊息，則應該呼叫 [**DefWindowProc**](/windows/win32/api/winuser/nf-winuser-defwindowproca)。</span><span class="sxs-lookup"><span data-stu-id="183f8-150">If the application does not process this message, it should call [**DefWindowProc**](/windows/win32/api/winuser/nf-winuser-defwindowproca).</span></span>

## <a name="remarks"></a><span data-ttu-id="183f8-151">備註</span><span class="sxs-lookup"><span data-stu-id="183f8-151">Remarks</span></span>

> <span data-ttu-id="183f8-152">\[!重要\]</span><span class="sxs-lookup"><span data-stu-id="183f8-152">\[!Important\]</span></span>  
> <span data-ttu-id="183f8-153">當視窗失去指標的捕獲，且收到 [**WM_POINTERCAPTURECHANGED**](wm-pointercapturechanged.md) 通知時，通常不會收到任何進一步的通知。</span><span class="sxs-lookup"><span data-stu-id="183f8-153">When a window loses capture of a pointer and it receives the [**WM_POINTERCAPTURECHANGED**](wm-pointercapturechanged.md) notification, it typically will not receive any further notifications.</span></span> <span data-ttu-id="183f8-154">基於這個理由，請務必不要根據平均配對的 **WM_POINTERDOWN** / [**WM_POINTERUP**](wm-pointerup.md)或 [**WM_POINTERENTER**](wm-pointerenter.md) / [**WM_POINTERLEAVE**](wm-pointerleave.md)通知來做出任何假設。</span><span class="sxs-lookup"><span data-stu-id="183f8-154">For this reason, it is important that you not make any assumptions based on evenly paired **WM_POINTERDOWN**/[**WM_POINTERUP**](wm-pointerup.md) or [**WM_POINTERENTER**](wm-pointerenter.md)/[**WM_POINTERLEAVE**](wm-pointerleave.md) notifications.</span></span>

 

<span data-ttu-id="183f8-155">每個指標在其存留期內都有唯一的指標識別碼。</span><span class="sxs-lookup"><span data-stu-id="183f8-155">Each pointer has a unique pointer identifier during its lifetime.</span></span> <span data-ttu-id="183f8-156">指標的存留期會在第一次偵測到時開始。</span><span class="sxs-lookup"><span data-stu-id="183f8-156">The lifetime of a pointer begins when it is first detected.</span></span>

<span data-ttu-id="183f8-157">如果偵測到停留指標，就會產生 [**WM_POINTERENTER**](wm-pointerenter.md) 訊息。</span><span class="sxs-lookup"><span data-stu-id="183f8-157">A [**WM_POINTERENTER**](wm-pointerenter.md) message is generated if a hovering pointer is detected.</span></span> <span data-ttu-id="183f8-158">如果偵測不到停留指標，則會產生 **WM_POINTERDOWN** 訊息，後面接著 **WM_POINTERENTER** 訊息。</span><span class="sxs-lookup"><span data-stu-id="183f8-158">A **WM_POINTERDOWN** message followed by a **WM_POINTERENTER** message is generated if a non-hovering pointer is detected.</span></span>

<span data-ttu-id="183f8-159">在其存留期內，指標可能會在其停留或聯繫時產生一系列的 [**WM_POINTERUPDATE**](wm-pointerupdate.md) 訊息。</span><span class="sxs-lookup"><span data-stu-id="183f8-159">During its lifetime, a pointer may generate a series of [**WM_POINTERUPDATE**](wm-pointerupdate.md) messages while it is hovering or in contact.</span></span>

<span data-ttu-id="183f8-160">指標的存留期會在不再偵測到它時結束。</span><span class="sxs-lookup"><span data-stu-id="183f8-160">The lifetime of a pointer ends when it is no longer detected.</span></span> <span data-ttu-id="183f8-161">這會產生 [**WM_POINTERLEAVE**](wm-pointerleave.md) 的訊息。</span><span class="sxs-lookup"><span data-stu-id="183f8-161">This generates a [**WM_POINTERLEAVE**](wm-pointerleave.md) message.</span></span>

<span data-ttu-id="183f8-162">當指標中止時，會設定 [**POINTER_FLAG_CANCELED**](pointer-flags-contants.md) 。</span><span class="sxs-lookup"><span data-stu-id="183f8-162">When a pointer is aborted, [**POINTER_FLAG_CANCELED**](pointer-flags-contants.md) is set.</span></span>

<span data-ttu-id="183f8-163">當非捕捉的指標移至視窗的範圍之外時，也可能會產生 [**WM_POINTERLEAVE**](wm-pointerleave.md) 訊息。</span><span class="sxs-lookup"><span data-stu-id="183f8-163">A [**WM_POINTERLEAVE**](wm-pointerleave.md) message may also be generated when a non-captured pointer moves outside the bounds of a window.</span></span>

<span data-ttu-id="183f8-164">若要取得指標的水準和垂直位置，請使用下列程式：</span><span class="sxs-lookup"><span data-stu-id="183f8-164">To obtain the horizontal and vertical position of a pointer, use the following:</span></span>


```
xPos = GET_X_LPARAM(lParam); 
yPos = GET_Y_LPARAM(lParam);
```



<span data-ttu-id="183f8-165">若要將 lParam 參數轉換成 [**點**](/previous-versions//dd162808(v=vs.85)) 結構，請使用 [**MAKEPOINTS**](/windows/win32/api/wingdi/nf-wingdi-makepoints) 宏。</span><span class="sxs-lookup"><span data-stu-id="183f8-165">To convert the lParam parameter to a [**POINTS**](/previous-versions//dd162808(v=vs.85)) structure, use the [**MAKEPOINTS**](/windows/win32/api/wingdi/nf-wingdi-makepoints) macro.</span></span>

<span data-ttu-id="183f8-166">若要取得與訊息相關聯的進一步資訊，請使用 [**GetPointerInfo**](/previous-versions/windows/desktop/api) 函式。</span><span class="sxs-lookup"><span data-stu-id="183f8-166">To retrieve further information associated with the message, use the [**GetPointerInfo**](/previous-versions/windows/desktop/api) function.</span></span>

<span data-ttu-id="183f8-167">若要判斷與此訊息相關聯的鍵盤輔助按鍵狀態，請使用 [**GetKeyState**](/windows/win32/api/winuser/nf-winuser-getkeystate) 函數。</span><span class="sxs-lookup"><span data-stu-id="183f8-167">To determine the keyboard modifier key states associated with this message, use the [**GetKeyState**](/windows/win32/api/winuser/nf-winuser-getkeystate) function.</span></span> <span data-ttu-id="183f8-168">例如，若要偵測是否已按下 ALT 鍵，請檢查 GetKeyState (VK_MENU) &lt; 0。</span><span class="sxs-lookup"><span data-stu-id="183f8-168">For example, to detect that the ALT key was pressed, check whether GetKeyState(VK_MENU) &lt; 0.</span></span>

<span data-ttu-id="183f8-169">請注意，如果應用程式不會處理此訊息， [**DefWindowProc**](/windows/win32/api/winuser/nf-winuser-defwindowproca) 可能會產生一或多個 [**WM_GESTURE**](../wintouch/wm-gesture.md) 訊息（如果此和中的輸入順序可能會被辨識為手勢）。</span><span class="sxs-lookup"><span data-stu-id="183f8-169">Note that if the application does not process this message, [**DefWindowProc**](/windows/win32/api/winuser/nf-winuser-defwindowproca) may generate one or more [**WM_GESTURE**](../wintouch/wm-gesture.md) messages if the sequence of input from this and, possibly, other pointers is recognized as a gesture.</span></span> <span data-ttu-id="183f8-170">如果無法辨識手勢， **DefWindowProc** 可能會產生滑鼠輸入。</span><span class="sxs-lookup"><span data-stu-id="183f8-170">If a gesture is not recognized, **DefWindowProc** may generate mouse input.</span></span>

<span data-ttu-id="183f8-171">如果應用程式選擇性地取用一些指標輸入，並將 rest 傳遞給 [**DefWindowProc**](/windows/win32/api/winuser/nf-winuser-defwindowproca)，則產生的行為是未定義的。</span><span class="sxs-lookup"><span data-stu-id="183f8-171">If an application selectively consumes some pointer input and passes the rest to [**DefWindowProc**](/windows/win32/api/winuser/nf-winuser-defwindowproca), the resulting behavior is undefined.</span></span>

<span data-ttu-id="183f8-172">當視窗失去指標的捕捉並收到 [**WM_POINTERCAPTURECHANGED**](wm-pointercapturechanged.md) 通知時，通常不會收到任何進一步的通知。</span><span class="sxs-lookup"><span data-stu-id="183f8-172">When a window loses capture of a pointer and receives the [**WM_POINTERCAPTURECHANGED**](wm-pointercapturechanged.md) notification, it will typically not receive any further notifications.</span></span> <span data-ttu-id="183f8-173">因此，視窗不會對其指標狀態做任何假設，不論它是否平均地向下/向上或進入/離開通知都是很重要的。</span><span class="sxs-lookup"><span data-stu-id="183f8-173">Therefore, it is important that a window does not make any assumptions of its pointer status, regardless of whether it receives evenly paired DOWN / UP or ENTER / LEAVE notifications.</span></span>

## <a name="examples"></a><span data-ttu-id="183f8-174">範例</span><span class="sxs-lookup"><span data-stu-id="183f8-174">Examples</span></span>

<span data-ttu-id="183f8-175">下列程式碼範例示範如何使用 [**IS_POINTER_FIRSTBUTTON_WPARAM**](/previous-versions/windows/desktop/api)、 [**GET_X_LPARAM**](/windows/win32/api/windowsx/nf-windowsx-get_x_lparam)、 [**GET_Y_LPARAM**](/windows/win32/api/windowsx/nf-windowsx-get_y_lparam)和 [**IS_POINTER_SECONDBUTTON_WPARAM**](/previous-versions/windows/desktop/api)來取得與 **WM_POINTERDOWN** 訊息相關聯的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="183f8-175">The following code example shows how to use [**IS_POINTER_FIRSTBUTTON_WPARAM**](/previous-versions/windows/desktop/api), [**GET_X_LPARAM**](/windows/win32/api/windowsx/nf-windowsx-get_x_lparam), [**GET_Y_LPARAM**](/windows/win32/api/windowsx/nf-windowsx-get_y_lparam), and [**IS_POINTER_SECONDBUTTON_WPARAM**](/previous-versions/windows/desktop/api)to retrieve the relevant information associated with the **WM_POINTERDOWN** message.</span></span>


```
int xPos = GET_X_LPARAM(lParam);
int yPos = GET_Y_LPARAM(lParam);

if (IS_POINTER_PRIMARYBUTTON_WPARAM(wParam))
{
    // process pointer down, similar to mouse left button down
}
else if (IS_POINTER_SECONDARYBUTTON_WPARAM(wParam))
{
    // process pointer down, similar to mouse right button down
}
```



<span data-ttu-id="183f8-176">下列程式碼範例示範如何使用 [**GET_POINTERID_WPARAM**](/previous-versions/windows/desktop/api) 從 **WM_POINTERDOWN** 訊息取出指標識別碼。</span><span class="sxs-lookup"><span data-stu-id="183f8-176">The following code example shows how to use [**GET_POINTERID_WPARAM**](/previous-versions/windows/desktop/api) to retrieve the pointer id from the **WM_POINTERDOWN** message.</span></span>


```
POINTER_INFO pointerInfo;
UINT32       pointerId = GET_POINTERID_WPARAM(wParam);

// Retrieve common pointer information
if (!GetPointerInfo(pointerId, &pointerInfo))
{
    // failure, call GetLastError()
}
else
{
    // success, process pointerInfo
}
```



<span data-ttu-id="183f8-177">下列程式碼範例示範如何處理不同的指標類型，例如觸控、畫筆或預設指標裝置。</span><span class="sxs-lookup"><span data-stu-id="183f8-177">The following code example shows how to handle different pointer type such as touch, pen, or default pointing devices.</span></span>


```
POINTER_TOUCH_INFO   touchInfo;
POINTER_PEN_INFO     penInfo;
POINTER_INFO         pointerInfo;
UINT32               pointerId = GET_POINTERID_WPARAM(wParam);
POINTER_TYPE         pointerType = PT_POINTER;

// default to unhandled to enable call to DefWindowProc
fHandled = FALSE;

if (!GetPointerType(pointerId, &pointerType))
{
    // failure, call GetLastError()
    // set PT_POINTER to fall to default case below
    pointerType = PT_POINTER;
}

switch (pointerType)
{
case PT_TOUCH:
    // Retrieve touch information
    if (!GetPointerTouchInfo(pointerId, &touchInfo))
    {
        // failure, call GetLastError()
    }
    else
    {
        // success, process touchInfo
        // mark as handled to skip call to DefWindowProc
        fHandled = TRUE;
    }
    break;
case PT_PEN:
    // Retrieve pen information
    if (!GetPointerPenInfo(pointerId, &penInfo))
    {
        // failure, call GetLastError()
    }
    else
    {
        // success, process penInfo
        // mark as handled to skip call to DefWindowProc
        fHandled = TRUE;
    }
    break;
default:
    if (!GetPointerInfo(pointerId, &pointerInfo)) 
    {
        // failure.
    } 
    else 
    {
        // success, proceed with pointerInfo.
        fHandled = HandleGenericPointerMessage(&pointerInfo);
    }
    break;
}

```



## <a name="requirements"></a><span data-ttu-id="183f8-178">規格需求</span><span class="sxs-lookup"><span data-stu-id="183f8-178">Requirements</span></span>



| <span data-ttu-id="183f8-179">需求</span><span class="sxs-lookup"><span data-stu-id="183f8-179">Requirement</span></span> | <span data-ttu-id="183f8-180">值</span><span class="sxs-lookup"><span data-stu-id="183f8-180">Value</span></span> |
|-------------------------------------|----------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="183f8-181">最低支援的用戶端</span><span class="sxs-lookup"><span data-stu-id="183f8-181">Minimum supported client</span></span><br/> | <span data-ttu-id="183f8-182">Windows 8 \[僅限桌面應用程式\]</span><span class="sxs-lookup"><span data-stu-id="183f8-182">Windows 8 \[desktop apps only\]</span></span><br/>                                                               |
| <span data-ttu-id="183f8-183">最低支援的伺服器</span><span class="sxs-lookup"><span data-stu-id="183f8-183">Minimum supported server</span></span><br/> | <span data-ttu-id="183f8-184">Windows Server 2012 \[僅限桌面應用程式\]</span><span class="sxs-lookup"><span data-stu-id="183f8-184">Windows Server 2012 \[desktop apps only\]</span></span><br/>                                                     |
| <span data-ttu-id="183f8-185">標頭</span><span class="sxs-lookup"><span data-stu-id="183f8-185">Header</span></span><br/>                   | <dl> <span data-ttu-id="183f8-186"><dt>Winuser (包含 Windows .h) </dt></span><span class="sxs-lookup"><span data-stu-id="183f8-186"><dt>Winuser.h (include Windows.h)</dt></span></span> </dl> |



## <a name="see-also"></a><span data-ttu-id="183f8-187">另請參閱</span><span class="sxs-lookup"><span data-stu-id="183f8-187">See also</span></span>

<dl> <dt>

[<span data-ttu-id="183f8-188">訊息</span><span class="sxs-lookup"><span data-stu-id="183f8-188">Messages</span></span>](messages.md)
</dt> <dt>

<span data-ttu-id="183f8-189">**參考**</span><span class="sxs-lookup"><span data-stu-id="183f8-189">**Reference**</span></span>
</dt> <dt>

[<span data-ttu-id="183f8-190">**指標旗標**</span><span class="sxs-lookup"><span data-stu-id="183f8-190">**Pointer Flags**</span></span>](pointer-flags-contants.md)
</dt> <dt>

[<span data-ttu-id="183f8-191">**GET_POINTERID_WPARAM**</span><span class="sxs-lookup"><span data-stu-id="183f8-191">**GET_POINTERID_WPARAM**</span></span>](/previous-versions/windows/desktop/api)
</dt> <dt>

[<span data-ttu-id="183f8-192">**IS_POINTER_NEW_WPARAM**</span><span class="sxs-lookup"><span data-stu-id="183f8-192">**IS_POINTER_NEW_WPARAM**</span></span>](/previous-versions/windows/desktop/api)
</dt> <dt>

[<span data-ttu-id="183f8-193">**IS_POINTER_INRANGE_WPARAM**</span><span class="sxs-lookup"><span data-stu-id="183f8-193">**IS_POINTER_INRANGE_WPARAM**</span></span>](/previous-versions/windows/desktop/api)
</dt> <dt>

[<span data-ttu-id="183f8-194">**IS_POINTER_INCONTACT_WPARAM**</span><span class="sxs-lookup"><span data-stu-id="183f8-194">**IS_POINTER_INCONTACT_WPARAM**</span></span>](/previous-versions/windows/desktop/api)
</dt> <dt>

[<span data-ttu-id="183f8-195">**IS_POINTER_PRIMARY_WPARAM**</span><span class="sxs-lookup"><span data-stu-id="183f8-195">**IS_POINTER_PRIMARY_WPARAM**</span></span>](/previous-versions/windows/desktop/api)
</dt> <dt>

[<span data-ttu-id="183f8-196">**IS_POINTER_FIRSTBUTTON_WPARAM**</span><span class="sxs-lookup"><span data-stu-id="183f8-196">**IS_POINTER_FIRSTBUTTON_WPARAM**</span></span>](/previous-versions/windows/desktop/api)
</dt> <dt>

[<span data-ttu-id="183f8-197">**IS_POINTER_SECONDBUTTON_WPARAM**</span><span class="sxs-lookup"><span data-stu-id="183f8-197">**IS_POINTER_SECONDBUTTON_WPARAM**</span></span>](/previous-versions/windows/desktop/api)
</dt> <dt>

[<span data-ttu-id="183f8-198">**IS_POINTER_THIRDBUTTON_WPARAM**</span><span class="sxs-lookup"><span data-stu-id="183f8-198">**IS_POINTER_THIRDBUTTON_WPARAM**</span></span>](/previous-versions/windows/desktop/api)
</dt> <dt>

[<span data-ttu-id="183f8-199">**IS_POINTER_FOURTHBUTTON_WPARAM**</span><span class="sxs-lookup"><span data-stu-id="183f8-199">**IS_POINTER_FOURTHBUTTON_WPARAM**</span></span>](/previous-versions/windows/desktop/api)
</dt> <dt>

[<span data-ttu-id="183f8-200">**IS_POINTER_FIFTHBUTTON_WPARAM**</span><span class="sxs-lookup"><span data-stu-id="183f8-200">**IS_POINTER_FIFTHBUTTON_WPARAM**</span></span>](/previous-versions/windows/desktop/api)
</dt> </dl>
