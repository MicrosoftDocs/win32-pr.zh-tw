---
title: Windows 事件
description: 事件通常用來疑難排解應用程式和驅動程式軟體。在 Windows Vista 之前，您可以使用 Windows 事件追蹤 (ETW) 或事件記錄來記錄事件。Windows Vista 引進了一種新的事件模型，同時統一 Windows (ETW) 和 Windows 事件記錄檔 API 的事件追蹤。Windows 10 引進了以 ETW 為基礎的 TraceLogging，並提供簡單的方式來檢測原生、.NET 和 WinRT 開發人員的程式碼。
ms.assetid: c10baa8d-50b9-4fda-89d0-d00b1d9f5404
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 2c3d22580c38e45d06f5362e99626642eebdfe20
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/19/2020
ms.locfileid: "104023425"
---
# <a name="windows-events"></a><span data-ttu-id="e0e27-103">Windows 事件</span><span class="sxs-lookup"><span data-stu-id="e0e27-103">Windows Events</span></span>

<span data-ttu-id="e0e27-104">事件通常用來疑難排解應用程式和驅動程式軟體。</span><span class="sxs-lookup"><span data-stu-id="e0e27-104">Events are typically used for troubleshooting application and driver software.</span></span>

-   <span data-ttu-id="e0e27-105">在 Windows Vista 之前，您可以使用 [Windows 事件追蹤](/windows/desktop/ETW/event-tracing-portal) (ETW) 或 [事件記錄](/windows/desktop/EventLog/event-logging) 來記錄事件。</span><span class="sxs-lookup"><span data-stu-id="e0e27-105">Prior to Windows Vista, you would use either [Event Tracing for Windows](/windows/desktop/ETW/event-tracing-portal) (ETW) or [Event Logging](/windows/desktop/EventLog/event-logging) to log events.</span></span>
-   <span data-ttu-id="e0e27-106">Windows Vista 引進了一種新的事件模型，同時統一 Windows (ETW) 和[Windows 事件記錄](/windows/desktop/WES/windows-event-log)檔 API 的[事件追蹤](/windows/desktop/ETW/event-tracing-portal)。</span><span class="sxs-lookup"><span data-stu-id="e0e27-106">Windows Vista introduced a new event model that unified both the [Event Tracing for Windows](/windows/desktop/ETW/event-tracing-portal) (ETW) and [Windows Event Log](/windows/desktop/WES/windows-event-log) API.</span></span>
-   <span data-ttu-id="e0e27-107">Windows 10 引進了以 ETW 為基礎的 [TraceLogging](/windows/desktop/tracelogging/trace-logging-portal) ，並提供簡單的方式來檢測原生、.Net 和 WinRT 開發人員的程式碼。</span><span class="sxs-lookup"><span data-stu-id="e0e27-107">Windows 10 introduces [TraceLogging](/windows/desktop/tracelogging/trace-logging-portal) which builds on ETW and provides a simplified way to instrument code for native, .NET and WinRT developers.</span></span>

<span data-ttu-id="e0e27-108">新的 [TraceLogging](/windows/desktop/tracelogging/trace-logging-portal) 模型可讓您包含事件的結構化資料、使事件相互關聯，而且不需要個別的檢測資訊清單 XML 檔案。</span><span class="sxs-lookup"><span data-stu-id="e0e27-108">The new [TraceLogging](/windows/desktop/tracelogging/trace-logging-portal) model allows you to include structured data with events, correlate events, and does not require a separate instrumentation manifest XML file.</span></span>

<span data-ttu-id="e0e27-109">Windows Vista 模型會使用 XML 資訊清單來定義您想要發佈的事件。</span><span class="sxs-lookup"><span data-stu-id="e0e27-109">The Windows Vista model uses an XML manifest to define the events that you want to publish.</span></span> <span data-ttu-id="e0e27-110">事件可以發佈至通道或 ETW 會話。</span><span class="sxs-lookup"><span data-stu-id="e0e27-110">Events can be published to a channel or an ETW session.</span></span> <span data-ttu-id="e0e27-111">您可以將事件發佈至下列類型的通道：系統管理員、操作、分析和偵錯工具。</span><span class="sxs-lookup"><span data-stu-id="e0e27-111">You can publish the events to the following types of channels: Admin, Operational, Analytic and Debug.</span></span> <span data-ttu-id="e0e27-112">如果您只使用 ETW 來啟用發行者，則不需要在資訊清單中指定通道。</span><span class="sxs-lookup"><span data-stu-id="e0e27-112">If you use only ETW to enable the publisher, you do not need to specify channels in your manifest.</span></span> <span data-ttu-id="e0e27-113">如需撰寫資訊清單的完整詳細資訊，請參閱 [撰寫檢測資訊清單](/windows/desktop/WES/writing-an-instrumentation-manifest)，以及有關通道的詳細資訊，請參閱 [定義通道](/windows/desktop/WES/defining-channels)。</span><span class="sxs-lookup"><span data-stu-id="e0e27-113">For complete details on writing a manifest, see [Writing an Instrumentation Manifest](/windows/desktop/WES/writing-an-instrumentation-manifest), and for information on channels, see [Defining Channels](/windows/desktop/WES/defining-channels).</span></span>

<span data-ttu-id="e0e27-114">若要註冊您的事件發行者併發布事件，請使用 ETW API。</span><span class="sxs-lookup"><span data-stu-id="e0e27-114">To register your event publisher and to publish events, you use the ETW API.</span></span> <span data-ttu-id="e0e27-115">如需詳細資訊，請參閱 [提供事件](/windows/desktop/ETW/providing-events) 和 [開發提供者](/windows/desktop/WES/developing-a-provider)。</span><span class="sxs-lookup"><span data-stu-id="e0e27-115">For details, see [Providing Events](/windows/desktop/ETW/providing-events) and [Developing a Provider](/windows/desktop/WES/developing-a-provider).</span></span> <span data-ttu-id="e0e27-116">事件發行者會自動將事件寫入資訊清單中指定的通道（如果已啟用）。</span><span class="sxs-lookup"><span data-stu-id="e0e27-116">The event publisher will automatically write the events to the channels specified in the manifest if they are enabled.</span></span>

<span data-ttu-id="e0e27-117">如果您想要控制事件發行者以較精細的細微性層級發佈的事件，請使用 ETW API。</span><span class="sxs-lookup"><span data-stu-id="e0e27-117">If you want to control the events that an event publisher publishes at a finer level of granularity, use the ETW API.</span></span> <span data-ttu-id="e0e27-118">例如，如果資訊清單同時定義寫入和讀取事件，則您只能啟用寫入事件。</span><span class="sxs-lookup"><span data-stu-id="e0e27-118">For example, if the manifest defines both write and read events, you can enable only the write events.</span></span> <span data-ttu-id="e0e27-119">事件也可以指定層級值（例如警告或錯誤），讓您可以限制寫入至指定錯誤層級的事件。</span><span class="sxs-lookup"><span data-stu-id="e0e27-119">An event can also specify a level value such as warning or error, so you can limit the events that are written to those that specify the error level.</span></span> <span data-ttu-id="e0e27-120">如需詳細資訊，請參閱 [控制事件追蹤會話](/windows/desktop/ETW/controlling-event-tracing-sessions)。</span><span class="sxs-lookup"><span data-stu-id="e0e27-120">For details, see [Controlling Event Tracing Sessions](/windows/desktop/ETW/controlling-event-tracing-sessions).</span></span> <span data-ttu-id="e0e27-121">事件會寫入會話的記錄檔。</span><span class="sxs-lookup"><span data-stu-id="e0e27-121">The events are written to the session's log file.</span></span>

<span data-ttu-id="e0e27-122">取用事件牽涉到從事件通道、事件記錄檔 ( .evtx 或 .evt 檔案) 、) 的 ( 追蹤檔案，或即時 ETW 會話的事件記錄檔。</span><span class="sxs-lookup"><span data-stu-id="e0e27-122">Consuming events involves retrieving the events from an event channel, an event log file (.evtx or .evt files), a trace file (.etl files), or a real-time ETW session.</span></span> <span data-ttu-id="e0e27-123">若要使用 ETW 追蹤檔或即時 ETW 會話中的事件，請在 ETW 中使用追蹤資料協助程式 (TDH) 函數來取用事件。</span><span class="sxs-lookup"><span data-stu-id="e0e27-123">To consume events from an ETW trace file or a real-time ETW session, use the trace data helper (TDH) functions in ETW to consume the events.</span></span> <span data-ttu-id="e0e27-124">您也可以使用 TDH 來讀取事件中繼資料。</span><span class="sxs-lookup"><span data-stu-id="e0e27-124">You can also use TDH to read the event metadata.</span></span> <span data-ttu-id="e0e27-125">如需詳細資訊，請參閱 [使用事件](/windows/desktop/ETW/consuming-events)。</span><span class="sxs-lookup"><span data-stu-id="e0e27-125">For details, see [Consuming Events](/windows/desktop/ETW/consuming-events).</span></span> <span data-ttu-id="e0e27-126">若要使用事件通道或事件記錄檔中的事件，請使用 Windows 事件記錄檔函數來查詢或訂閱事件。</span><span class="sxs-lookup"><span data-stu-id="e0e27-126">To consume events from an event channel or an event log file, use the Windows Event Log functions to query or subscribe to events.</span></span> <span data-ttu-id="e0e27-127">如需詳細資訊，請參閱 [查詢事件](/windows/desktop/WES/querying-for-events) 或 [訂閱事件](/windows/desktop/WES/subscribing-to-events)。</span><span class="sxs-lookup"><span data-stu-id="e0e27-127">For more information, see [Querying for Events](/windows/desktop/WES/querying-for-events) or [Subscribing to Events](/windows/desktop/WES/subscribing-to-events).</span></span>

<span data-ttu-id="e0e27-128">在 Windows Vista 之前，您必須使用 [Windows 事件追蹤](/windows/desktop/ETW/event-tracing-portal) 或 [事件記錄](/windows/desktop/EventLog/event-logging) 來發行和取用事件。</span><span class="sxs-lookup"><span data-stu-id="e0e27-128">Prior to Windows Vista, you must use [Event Tracing for Windows](/windows/desktop/ETW/event-tracing-portal) or [Event Logging](/windows/desktop/EventLog/event-logging) to publish and consume events.</span></span>

 

 