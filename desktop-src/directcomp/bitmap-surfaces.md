---
title: 點陣圖物件
description: 本主題說明 DirectComposition 支援的點陣圖內容類型。
ms.assetid: BC32CF76-D5E4-4B25-AFD5-42E8DABFA0D0
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c390778fef1ee7ad96c90a8b7706fa635f3615ff
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/20/2020
ms.locfileid: "104382722"
---
# <a name="bitmap-objects"></a><span data-ttu-id="2aa36-103">點陣圖物件</span><span class="sxs-lookup"><span data-stu-id="2aa36-103">Bitmap objects</span></span>

> [!NOTE]
> <span data-ttu-id="2aa36-104">針對 Windows 10 上的應用程式，我們建議使用 DirectComposition，而不是使用。</span><span class="sxs-lookup"><span data-stu-id="2aa36-104">For apps on Windows 10, we recommend using Windows.UI.Composition APIs instead of DirectComposition.</span></span> <span data-ttu-id="2aa36-105">如需詳細資訊，請參閱 [使用視覺分層將您的桌面應用程式現代化](/windows/uwp/composition/visual-layer-in-desktop-apps)。</span><span class="sxs-lookup"><span data-stu-id="2aa36-105">For more info, see [Modernize your desktop app using the Visual layer](/windows/uwp/composition/visual-layer-in-desktop-apps).</span></span>

<span data-ttu-id="2aa36-106">Microsoft DirectComposition 是點陣圖組合引擎。</span><span class="sxs-lookup"><span data-stu-id="2aa36-106">Microsoft DirectComposition is a bitmap compositing engine.</span></span> <span data-ttu-id="2aa36-107">它可讓應用程式開發人員結合多個點陣圖，並以各種方式操作它們，以在應用程式 UI 中達成有趣的視覺效果和動畫。</span><span class="sxs-lookup"><span data-stu-id="2aa36-107">It enables application developers to combine multiple bitmaps and manipulate them in various ways to achieve interesting visual effects and animations in an application UI.</span></span> <span data-ttu-id="2aa36-108">本主題說明 DirectComposition 支援的點陣圖內容類型。</span><span class="sxs-lookup"><span data-stu-id="2aa36-108">This topic describes the types of bitmap content that DirectComposition supports.</span></span>

-   [<span data-ttu-id="2aa36-109">點陣圖內容</span><span class="sxs-lookup"><span data-stu-id="2aa36-109">Bitmap content</span></span>](#bitmap-content)
    -   [<span data-ttu-id="2aa36-110">影片記憶體點陣圖</span><span class="sxs-lookup"><span data-stu-id="2aa36-110">Video memory bitmaps</span></span>](#video-memory-bitmaps)
    -   [<span data-ttu-id="2aa36-111">視窗點陣圖</span><span class="sxs-lookup"><span data-stu-id="2aa36-111">Window bitmaps</span></span>](#window-bitmaps)
    -   [<span data-ttu-id="2aa36-112">建立點陣圖內容與視覺效果的關聯</span><span class="sxs-lookup"><span data-stu-id="2aa36-112">Associating bitmap content with a visual</span></span>](#associating-bitmap-content-with-a-visual)
    -   [<span data-ttu-id="2aa36-113">Alpha 色板</span><span class="sxs-lookup"><span data-stu-id="2aa36-113">Alpha channel</span></span>](#alpha-channel)
-   [<span data-ttu-id="2aa36-114">相關主題</span><span class="sxs-lookup"><span data-stu-id="2aa36-114">Related topics</span></span>](#related-topics)

## <a name="bitmap-content"></a><span data-ttu-id="2aa36-115">點陣圖內容</span><span class="sxs-lookup"><span data-stu-id="2aa36-115">Bitmap content</span></span>

<span data-ttu-id="2aa36-116">應用程式會藉由建立視覺物件，然後設定這些物件的 [content 屬性](basic-concepts.md) ，提供 DirectComposition 和點陣圖內容以供撰寫和建立動畫。</span><span class="sxs-lookup"><span data-stu-id="2aa36-116">Applications provide DirectComposition with the bitmap content to compose and animate by creating visual objects and then setting the [Content property](basic-concepts.md) of those objects.</span></span> <span data-ttu-id="2aa36-117">DirectComposition 不提供任何的點陣化服務。</span><span class="sxs-lookup"><span data-stu-id="2aa36-117">DirectComposition does not offer any rasterization services.</span></span> <span data-ttu-id="2aa36-118">應用程式必須使用其他以軟體為基礎或硬體加速的點陣化程式庫（例如 [Direct2D](../direct2d/direct2d-portal.md) 或 [Direct3D](/windows/desktop/direct3d11/atoc-dx-graphics-direct3d-11) ）來填入要組成的點陣圖。</span><span class="sxs-lookup"><span data-stu-id="2aa36-118">An application must use some other software-based or hardware-accelerated rasterization library such as [Direct2D](../direct2d/direct2d-portal.md) or [Direct3D](/windows/desktop/direct3d11/atoc-dx-graphics-direct3d-11) to populate the bitmaps that are to be composed.</span></span> <span data-ttu-id="2aa36-119">撰寫之後，DirectComposition 會將構成點陣圖內容的傳遞至 [桌面視窗管理員 (DWM) ](/windows/desktop/dwm/dwm-overview) 以轉譯至螢幕。</span><span class="sxs-lookup"><span data-stu-id="2aa36-119">After composing, DirectComposition passes composed bitmap content to [Desktop Window Manager (DWM)](/windows/desktop/dwm/dwm-overview) for rendering to the screen.</span></span>

<span data-ttu-id="2aa36-120">**支援的點陣圖內容類型**  Microsoft DirectComposition 支援下列幾種點陣圖：</span><span class="sxs-lookup"><span data-stu-id="2aa36-120">**Supported types of bitmap content** Microsoft DirectComposition supports the following kinds of bitmaps:</span></span>

-   [<span data-ttu-id="2aa36-121">影片記憶體點陣圖</span><span class="sxs-lookup"><span data-stu-id="2aa36-121">Video memory bitmaps</span></span>](#video-memory-bitmaps)
-   [<span data-ttu-id="2aa36-122">視窗點陣圖</span><span class="sxs-lookup"><span data-stu-id="2aa36-122">Window bitmaps</span></span>](#window-bitmaps)

### <a name="video-memory-bitmaps"></a><span data-ttu-id="2aa36-123">影片記憶體點陣圖</span><span class="sxs-lookup"><span data-stu-id="2aa36-123">Video memory bitmaps</span></span>

<span data-ttu-id="2aa36-124">影片記憶體點陣圖會使用 Microsoft DirectX 方法在硬體中進行柵格化， (包括 DX 對 GDI interop 模型) 。</span><span class="sxs-lookup"><span data-stu-id="2aa36-124">A video memory bitmap is rasterized in hardware by using Microsoft DirectX methods (including the DX-to-GDI interop model).</span></span> <span data-ttu-id="2aa36-125">它是由呼叫應用程式和 DirectComposition 可看見的跨進程共用表面所支援。</span><span class="sxs-lookup"><span data-stu-id="2aa36-125">It is backed by cross-process shared surfaces that are visible to the calling application and to DirectComposition.</span></span> <span data-ttu-id="2aa36-126">因為應用程式只能從 DirectComposition 材質的介面讀取，所以影片記憶體點陣圖不會遭到破壞。</span><span class="sxs-lookup"><span data-stu-id="2aa36-126">A video memory bitmap is not subject to tearing because the application can only read from the surfaces that DirectComposition textures from.</span></span>

### <a name="video-content"></a><span data-ttu-id="2aa36-127">影片內容</span><span class="sxs-lookup"><span data-stu-id="2aa36-127">Video content</span></span>

<span data-ttu-id="2aa36-128">應用程式可以使用 DirectComposition 來撰寫影片畫面，以使用系結至 DirectComposition 介面的 DirectX 無視窗交換鏈。</span><span class="sxs-lookup"><span data-stu-id="2aa36-128">Applications can use DirectComposition to compose video frames that use DirectX windowless swap chains that are bound to a DirectComposition surface.</span></span> <span data-ttu-id="2aa36-129">就概念而言，DirectComposition 會將影片內容視為一系列的點陣圖。</span><span class="sxs-lookup"><span data-stu-id="2aa36-129">Conceptually, DirectComposition treats video content as a sequence of bitmaps.</span></span> <span data-ttu-id="2aa36-130">DirectComposition 並不提供呈現影片畫面的方法。</span><span class="sxs-lookup"><span data-stu-id="2aa36-130">DirectComposition does not provide a means of presenting video frames.</span></span>

<span data-ttu-id="2aa36-131">DirectComposition 支援 DirectX 無視窗交換鏈（也就是未系結至特定視窗的交換鏈），並可讓兩個不同的應用程式跨進程界限共用無視窗的交換鏈。</span><span class="sxs-lookup"><span data-stu-id="2aa36-131">DirectComposition supports DirectX windowless swap chains—that is, swap chains that are not bound to a particular window—and enables two different applications to share windowless swap chains across process boundaries.</span></span> <span data-ttu-id="2aa36-132">共用無視窗交換鏈可啟用在一個進程中建立交換鏈的影片案例，並在第二個進程中搭配 DirectComposition 使用。</span><span class="sxs-lookup"><span data-stu-id="2aa36-132">Sharing windowless swap chains enables video scenarios where the swap chain is created in one process and is used with DirectComposition in a second process.</span></span> <span data-ttu-id="2aa36-133">無視窗的交換鏈是使用 [**IDXGIFactory2：： CreateSwapChainForCompositionSurface**](/windows/desktop/api/dxgi1_2/nf-dxgi1_2-idxgifactory2-createswapchainforcomposition) 方法建立的。</span><span class="sxs-lookup"><span data-stu-id="2aa36-133">Windowless swap chains are created using the [**IDXGIFactory2::CreateSwapChainForCompositionSurface**](/windows/desktop/api/dxgi1_2/nf-dxgi1_2-idxgifactory2-createswapchainforcomposition) method.</span></span>

<span data-ttu-id="2aa36-134">如需有關 DirectX 交換鏈的詳細資訊，請參閱 [DXGI 總覽](/windows/desktop/direct3ddxgi/d3d10-graphics-programming-guide-dxgi)。</span><span class="sxs-lookup"><span data-stu-id="2aa36-134">For more information about DirectX swap chains, see [DXGI Overview](/windows/desktop/direct3ddxgi/d3d10-graphics-programming-guide-dxgi).</span></span>

### <a name="stereo-content"></a><span data-ttu-id="2aa36-135">身歷聲內容</span><span class="sxs-lookup"><span data-stu-id="2aa36-135">Stereo content</span></span>

<span data-ttu-id="2aa36-136">就概念而言，身歷聲交換鏈是由 Microsoft DirectX Graphic Infrastructure (DXGI) 表面，代表身歷聲3D 內容的左右聲道。</span><span class="sxs-lookup"><span data-stu-id="2aa36-136">Conceptually, a stereo swap chain consists of Microsoft DirectX Graphics Infrastructure (DXGI) surfaces that represent the left and right channels for stereo 3D content.</span></span> <span data-ttu-id="2aa36-137">當使用身歷聲交換鏈作為視覺效果的點陣圖資源時，DirectComposition 會以身歷聲撰寫。</span><span class="sxs-lookup"><span data-stu-id="2aa36-137">When a stereo swap chain is used as the bitmap resource for a visual, DirectComposition composes in stereo.</span></span> <span data-ttu-id="2aa36-138">所有非身歷聲內容 (mono 內容) 都會被視為具有相同的左和右通道內容;也就是說，這兩個通道都使用相同的點陣圖內容。</span><span class="sxs-lookup"><span data-stu-id="2aa36-138">All non-stereo content (mono content) is considered to have identical left and right channel content; that is, the same bitmap content is used for both channels.</span></span> <span data-ttu-id="2aa36-139">DirectComposition 會個別撰寫所有的左邊內容和所有正確的內容。</span><span class="sxs-lookup"><span data-stu-id="2aa36-139">DirectComposition composes all left content and all right content separately.</span></span> <span data-ttu-id="2aa36-140">如果顯示裝置的功能不是身歷聲，DirectComposition 會根據應用程式) 作為 mono 內容，並只使用點陣圖資源的資料來撰寫，來處理左邊或右邊的身歷聲通道 (。</span><span class="sxs-lookup"><span data-stu-id="2aa36-140">If the display device is not stereo capable, DirectComposition treats the left or right stereo channel (depending on the application) as mono content and composes using only that data for the bitmap resource.</span></span>

<span data-ttu-id="2aa36-141">DirectComposition 不支援建立或操作身歷聲內容，也無法將 mono 交換鏈升階為身歷聲配對。</span><span class="sxs-lookup"><span data-stu-id="2aa36-141">DirectComposition does not support creating or manipulating stereo content, and cannot promote a mono swap chain to a stereo pair.</span></span> <span data-ttu-id="2aa36-142">應用程式必須先執行這些工作，才能將 DirectX 身歷聲內容呈現給 DirectComposition。</span><span class="sxs-lookup"><span data-stu-id="2aa36-142">An application must perform these tasks before presenting DirectX stereo content to DirectComposition.</span></span> <span data-ttu-id="2aa36-143">此外，應用程式必須提供深度感知的左邊和右邊通道位移;DirectComposition 無法調整左右通道位移，以修改已知的 DirectX 身歷聲內容深度。</span><span class="sxs-lookup"><span data-stu-id="2aa36-143">Also, an application must provide the left and right channel offsets for depth perception; DirectComposition cannot adjust the left and right channel offsets to modify the perceived depth of DirectX stereo content.</span></span>

<span data-ttu-id="2aa36-144">當有支援身歷聲的硬體可用時，就會將 DirectX 身歷聲內容撰寫並保存到 DWM。</span><span class="sxs-lookup"><span data-stu-id="2aa36-144">DirectX stereo content is composed and persisted to DWM when stereo-capable hardware is available.</span></span>

### <a name="window-bitmaps"></a><span data-ttu-id="2aa36-145">視窗點陣圖</span><span class="sxs-lookup"><span data-stu-id="2aa36-145">Window bitmaps</span></span>

<span data-ttu-id="2aa36-146">「視窗點陣圖」不是真正的點陣圖，而是 DirectComposition 以分層最上層或子視窗的 rasterizations 即時取代的預留位置。</span><span class="sxs-lookup"><span data-stu-id="2aa36-146">A "window bitmap" is not a real bitmap, but is a placeholder that DirectComposition replaces in real time with rasterizations of layered top-level or child windows.</span></span> <span data-ttu-id="2aa36-147">視窗點陣圖類似于 DWM 縮圖，不同之處在于縮圖可能包含許多視窗的投稿，例如擁有的非子視窗，而 DirectComposition 視窗點陣圖一律只是一個視窗和其子系的標記法。</span><span class="sxs-lookup"><span data-stu-id="2aa36-147">A window bitmap is similar to a DWM thumbnail, except that a thumbnail can contain contributions from many windows, such as owned non-child windows, whereas a DirectComposition window bitmap is always a representation of just one window and its children.</span></span>

<span data-ttu-id="2aa36-148">由於 DirectComposition 可以存取所有視窗和所有視覺化樹狀結構的重新導向介面，因此它可以在多個視覺化樹狀結構中重複使用某個視窗的內容。</span><span class="sxs-lookup"><span data-stu-id="2aa36-148">Because DirectComposition has access to the redirection surfaces of all windows and all visual trees, it can reuse the content from one window in multiple visual trees.</span></span> <span data-ttu-id="2aa36-149">視窗必須分層，因為非分層視窗沒有專用的重新導向介面，因此它的點陣化不一定可供 DirectComposition。</span><span class="sxs-lookup"><span data-stu-id="2aa36-149">The window must be layered because a non-layered window does not have a dedicated redirection surface and, therefore, its rasterization is not always available to DirectComposition.</span></span>

<span data-ttu-id="2aa36-150">若要使用視窗點陣圖，應用程式會將視覺效果與視窗控制碼產生關聯 (HWND) 。</span><span class="sxs-lookup"><span data-stu-id="2aa36-150">To use a window bitmap, an application associates a visual with a window handle (HWND).</span></span> <span data-ttu-id="2aa36-151">之後，當視窗的內容變更時，DirectComposition 會重新撰寫視覺效果，包括當內容變更為與視窗相關聯的視覺化樹狀結構的結果時。</span><span class="sxs-lookup"><span data-stu-id="2aa36-151">Afterward, DirectComposition re-composes the visual whenever the contents of the window change, including when the contents change as a result of changes to the visual trees associated with the window.</span></span> <span data-ttu-id="2aa36-152">換句話說，如同 DWM 縮圖，DirectComposition 視窗點陣圖也是「即時」。</span><span class="sxs-lookup"><span data-stu-id="2aa36-152">In other words, like DWM thumbnails, DirectComposition window bitmaps are "live".</span></span>

### <a name="associating-bitmap-content-with-a-visual"></a><span data-ttu-id="2aa36-153">建立點陣圖內容與視覺效果的關聯</span><span class="sxs-lookup"><span data-stu-id="2aa36-153">Associating bitmap content with a visual</span></span>

<span data-ttu-id="2aa36-154">針對這三種點陣圖，應用程式可以將相同點陣圖與多個視覺效果產生關聯，這表示單一記憶體配置可以用來顯示相同的內容數次。</span><span class="sxs-lookup"><span data-stu-id="2aa36-154">For all three kinds of bitmaps, an application can associate the same bitmap with multiple visuals, which means that a single memory allocation can be used to display the same content several times.</span></span>

### <a name="alpha-channel"></a><span data-ttu-id="2aa36-155">Alpha 色板</span><span class="sxs-lookup"><span data-stu-id="2aa36-155">Alpha channel</span></span>

<span data-ttu-id="2aa36-156">所有點陣圖都有32位的每個圖元 (BPP) 格式，其中包含8個位的每圖元透明度。</span><span class="sxs-lookup"><span data-stu-id="2aa36-156">All bitmaps have a 32 bits per pixel (BPP) format, which includes eight bits for per-pixel transparency.</span></span> <span data-ttu-id="2aa36-157">但是，應用程式可以指定 DirectComposition 應該如何使用 Alpha 色板。</span><span class="sxs-lookup"><span data-stu-id="2aa36-157">However, an application can specify how DirectComposition should consume the alpha channel.</span></span> <span data-ttu-id="2aa36-158">尤其是，DirectComposition 可以採用 Alpha 色板，也可以完全忽略 Alpha，在這種情況下，點陣圖會被視為完全不透明。</span><span class="sxs-lookup"><span data-stu-id="2aa36-158">In particular, DirectComposition can respect the alpha channel, or it can ignore alpha altogether, in which case the bitmap is considered to be fully opaque.</span></span>

<span data-ttu-id="2aa36-159">額外的 Alpha 模式會忽略 Alpha 色板，但是會將紅色、綠色和藍色值視為每個通道的 Alpha 值，而不是將這些通道的一般轉譯視為色彩濃度。</span><span class="sxs-lookup"><span data-stu-id="2aa36-159">An additional alpha mode ignores the alpha channel, but treats the red, green, and blue values as per-channel alpha values instead of the normal interpretation of those channels as color intensities.</span></span> <span data-ttu-id="2aa36-160">這種模式適用于 ClearType 轉譯，需要有子圖元的涵蓋範圍資訊。</span><span class="sxs-lookup"><span data-stu-id="2aa36-160">This mode is useful for ClearType rendering, which requires sub-pixel coverage information.</span></span> <span data-ttu-id="2aa36-161">若要使用每個通道的 Alpha 模式，應用程式必須先使用 [Direct2D](../direct2d/direct2d-portal.md) 和 [DirectWrite](/windows/desktop/DirectWrite/direct-write-portal) 將子圖元涵蓋範圍資料寫入點陣圖。</span><span class="sxs-lookup"><span data-stu-id="2aa36-161">To use the per-channel alpha mode, an application must first use [Direct2D](../direct2d/direct2d-portal.md) and [DirectWrite](/windows/desktop/DirectWrite/direct-write-portal) to write sub-pixel coverage data to a bitmap.</span></span> <span data-ttu-id="2aa36-162">接下來，應用程式必須設定正確的 Alpha 模式，並在將點陣圖與視覺效果關聯時指定文字色彩。</span><span class="sxs-lookup"><span data-stu-id="2aa36-162">Next the application must set the correct alpha mode and specify a text color when it associates the bitmap with a visual.</span></span> <span data-ttu-id="2aa36-163">DirectComposition 會將文字色彩與涵蓋範圍資料混合，以針對背景產生 ClearType 混色。</span><span class="sxs-lookup"><span data-stu-id="2aa36-163">DirectComposition blends the text color with the coverage data, which produces ClearType blending against the background.</span></span>

<span data-ttu-id="2aa36-164">在 ClearType 演算法不適用的情況下（例如，如果點陣圖不是圖元對齊且軸對齊），或者如果需要繪製到中繼介面，DirectComposition 可以使用點陣圖中的子圖元涵蓋範圍資料，自動產生灰階的點陣化，而不會產生額外的費用。</span><span class="sxs-lookup"><span data-stu-id="2aa36-164">In situations where the ClearType algorithm is not applicable, such as if the bitmap is not pixel-aligned and axis-aligned, or if it needs to be drawn to an intermediate surface, DirectComposition can use the subpixel coverage data in the bitmap to produce a grayscale rasterization instead, automatically and at no additional cost.</span></span>

<span data-ttu-id="2aa36-165">如需詳細資訊，請參閱 [**IDCompositionDevice：： CreateSurface**](/windows/win32/api/dcomp/nf-dcomp-idcompositiondevice-createsurface)或 [**IDCompositionDevice：： CreateVirtualSurface**](/windows/win32/api/dcomp/nf-dcomp-idcompositiondevice-createvirtualsurface)函數之 *AlphaMode* 參數的描述。</span><span class="sxs-lookup"><span data-stu-id="2aa36-165">For more information, see the description of the *alphaMode* parameter of the [**IDCompositionDevice::CreateSurface**](/windows/win32/api/dcomp/nf-dcomp-idcompositiondevice-createsurface) or [**IDCompositionDevice::CreateVirtualSurface**](/windows/win32/api/dcomp/nf-dcomp-idcompositiondevice-createvirtualsurface) function.</span></span>

## <a name="related-topics"></a><span data-ttu-id="2aa36-166">相關主題</span><span class="sxs-lookup"><span data-stu-id="2aa36-166">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="2aa36-167">DirectComposition 概念</span><span class="sxs-lookup"><span data-stu-id="2aa36-167">DirectComposition Concepts</span></span>](directcomposition-concepts.md)
</dt> </dl>

 

 