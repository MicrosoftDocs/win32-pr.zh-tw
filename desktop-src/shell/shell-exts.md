---
description: 這組主題會討論如何執行延伸模組處理常式，讓您修改各種 Shell 動作。
ms.assetid: 794b6369-665f-49a9-a263-7c736c5ce8ac
title: 使用 Shell 擴充功能
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: dbb696f4536cdb0fb6869be073771d431bd8d2de
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: HT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/08/2021
ms.locfileid: "104973697"
---
# <a name="working-with-shell-extensions"></a>使用 Shell 擴充功能

您可以使用登錄專案和 .ini 檔案來擴充 Shell 的功能。 雖然這種擴充 Shell 的方法很簡單，且適用于許多用途，但有限。 例如，如果您使用登錄來指定檔案類型的自訂圖示，就會針對該類型的每個檔案顯示相同的圖示。 使用登錄延伸 Shell 不允許您變更檔案類型之不同成員的圖示。 Shell 的其他層面（例如，在檔案以滑鼠右鍵按一下時可顯示的 [ **屬性** ] 屬性工作表），無法透過登錄來修改。

擴充 Shell 的一個更強大且靈活的方法，就是執行 *shell 擴充處理常式*。 您可以針對 Shell 可採用的各種動作，執行這些處理常式。 在採取動作之前，Shell 會查詢延伸模組處理常式，讓它有機會修改動作。 常見的範例是快捷方式功能表延伸模組處理常式。 如果是針對檔案類型所執行，則會在每次以滑鼠右鍵按一下其中一個檔案時進行查詢。 然後，處理常式可以依檔案逐一指定其他功能表項目，而不是針對該檔案類型的所有檔案設定相同的集合。

這組主題會討論如何執行延伸模組處理常式，讓您修改各種 Shell 動作。 下列處理常式會與特定檔案類型相關聯，並可讓您以檔案為基礎來指定。



| 處理常式                                               | 描述                                                                                                                                                                |
|-------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [快速鍵功能表處理常式](context-menu-handlers.md)    | 在顯示檔案的快捷方式功能表之前呼叫。 它可讓您依檔案逐一將專案新增至快捷方式功能表。                                               |
| [資料處理程式](how-to-create-data-handlers.md)       | 在 Shell 物件上執行拖放作業時呼叫。 它可讓您提供其他剪貼簿格式給放置目標。                            |
| [捨棄處理常式](how-to-create-drop-handlers.md)       | 當資料物件在檔案上拖放或卸載時呼叫。 它可讓您將檔案放入放置目標。                                                          |
| [圖示處理常式](how-to-create-icon-handlers.md)       | 在顯示檔案的圖示之前呼叫。 它可讓您以檔案為基礎，以自訂圖示取代檔案的預設圖示。                                    |
| [屬性工作表處理常式](propsheet-handlers.md)      | 在顯示物件的 [ **屬性** ] 屬性工作表之前呼叫。 它可讓您新增或取代頁面。                                                              |
| [**縮圖影像處理常式**](/windows/desktop/api/Thumbcache/nn-thumbcache-ithumbnailprovider) | 提供表示專案的影像。                                                                                                                                   |
| [**資訊提示處理常式**](/windows/win32/api/shlobj_core/nn-shlobj_core-iqueryinfo)                 | 當使用者將滑鼠指標移至物件上方時，提供快顯視窗。                                                                                               |
| [**元資料處理程式**](/windows/win32/api/propidl/nn-propidl-ipropertysetstorage)       | 提供中繼資料的讀取和寫入存取 (屬性) 儲存在檔案中。 這可以用來擴充詳細資料檢視、提示、屬性頁和群組功能。 |



 

有些則不會與特定檔案類型相關聯，而是在某些 Shell 作業之前呼叫。



| 處理常式                                                            | 描述                                                                                                                                  |
|--------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------|
| [資料行處理常式](../lwef/column-handlers.md)                             | 由 Windows 檔案總管呼叫，然後才會顯示資料夾的詳細資料檢視。 它可讓您將自訂資料行新增至詳細資料檢視。        |
| [複製勾點處理常式](how-to-create-copy-hook-handlers.md)          | 當資料夾或印表機物件即將移動、複製、刪除或重新命名時呼叫。 它可讓您核准或拒絕此作業。   |
| [拖放功能處理常式](context-menu-handlers.md)                 | 在使用滑鼠右鍵拖曳檔案時呼叫。 它可讓您修改所顯示的快捷方式功能表。                     |
| [圖示重迭處理常式](how-to-implement-icon-overlay-handlers.md) | 在顯示檔案的圖示之前呼叫。 它可讓您指定檔案圖示的覆迭。                                          |
| [搜尋處理常式](../lwef/search-handlers.md)                             | 呼叫以啟動搜尋引擎。 它可讓您執行可從 [ **開始** ] 功能表或 Windows 檔案總管存取的自訂搜尋引擎。 |



 

上述各節將說明如何執行特定延伸模組處理常式的詳細資料。 如需所有 Shell 延伸模組處理常式通用之執行問題的討論，請參閱下列主題：

-   [初始化 Shell 擴充處理常式](int-shell-exts.md)
-   [註冊 Shell 延伸模組處理常式](reg-shell-exts.md)

 

 
