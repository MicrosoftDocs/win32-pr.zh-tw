---
description: 服務 (或在不同的安全性內容中執行的任何進程) 必須存取遠端資源，則應該使用通用命名慣例 (UNC) 名稱來存取資源。
ms.assetid: 2582259d-077c-4089-9a87-1a377994f0bd
title: 服務和重新導向的磁片磁碟機
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 09073dd4ce1e98c72d027038638428d9b9ff67ae3697663661404464419341a3
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/11/2021
ms.locfileid: "117967105"
---
# <a name="services-and-redirected-drives"></a>服務和重新導向的磁片磁碟機

服務 (或在不同的安全性內容中執行的任何進程) 必須存取遠端資源，則應該使用通用命名慣例 (UNC) 名稱來存取資源。 服務必須具有適當的許可權才能存取資源。 如果伺服器端服務使用 RPC 連接，則必須在遠端伺服器上啟用委派。

磁碟機號對系統而言不是全域的。 每個登入會話都會收到一組來自 A 至 Z 的磁碟機號。因此，在不同的使用者帳戶下執行的進程之間無法共用重新導向的磁片磁碟機。 此外，服務 (或在自己的登入會話中執行的任何進程) 無法存取在不同登入會話中建立的磁碟機號。

服務不應該透過對應的磁碟機號直接存取本機或網路資源，也不應該在執行時間呼叫 **net use** 命令來對應磁碟機號。 基於下列原因，不建議 **使用 net use** 命令：

-   磁片磁碟機對應存在於所有登入內容中，因此，如果應用程式是在 [LocalService 帳戶](localservice-account.md)的內容中執行，則在該內容中執行的任何其他服務都可以存取對應的磁片磁碟機。
-   如果服務將明確的認證提供給 **net use** 命令，這些認證可能不會在服務界限之外不慎共用。 相反地，服務應該使用 [用戶端](/windows/desktop/SecAuthZ/client-impersonation) 模擬來模擬使用者。
-   在相同內容中執行的多個服務可能會互相干擾。 如果這兩個服務都執行明確的 **網路使用** ，並同時提供相同的認證，則其中一個服務會失敗，並出現「已連線」錯誤。

此外，服務不應該使用 Windows 的[網路功能](/windows/desktop/WNet/windows-networking-functions)來管理對應的磁碟機號。 雖然 WNet 函式可能會傳回成功，但產生的行為並不是預期的行為。 當系統建立重新導向的磁片磁碟機時，它會以每個使用者為基礎來儲存。 只有使用者能夠管理重新導向的磁片磁碟機。 系統會根據使用者的登入安全識別碼 (SID) 來追蹤重新導向的磁片磁碟機。 登入 SID 是使用者登入會話的唯一識別碼。 單一使用者在系統上可以有多個同時登入會話。

如果服務設定為在使用者帳戶下執行，系統一律會為使用者建立新的登入會話，並在該新的登入會話中啟動該服務。 因此，服務無法管理在使用者的其他會話中建立的磁片磁碟機對應。

**Windows Server 2003：** 在具有多個網路介面 (也就是) 的多重主機電腦上的電腦上，使用 UNC 路徑來存取儲存在遠端伺服器訊息區 (SMB) 伺服器上的檔案時，可能會延遲最多60秒。 如需詳細資訊，請參閱說明及支援知識庫中的 [文章 890553](https://support.microsoft.com/kb/890553) 。

 

 
