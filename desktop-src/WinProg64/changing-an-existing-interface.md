---
title: 變更現有介面
description: 盡可能針對您的應用程式執行新的介面，而不是對現有的應用程式進行變更。
ms.assetid: 29845cf5-445c-403d-b298-d4e07c3536b7
keywords:
- 變更現有介面64位 Windows 程式設計
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 782587471de5616750501552445599a94571ff2275d080347937c595e2cd7668
ms.sourcegitcommit: e6600f550f79bddfe58bd4696ac50dd52cb03d7e
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/11/2021
ms.locfileid: "119899068"
---
# <a name="changing-an-existing-interface"></a>變更現有介面

盡可能針對您的應用程式執行新的介面，而不是對現有的應用程式進行變更。 如果您無法避免變更現有的介面，請只在新的方法中使用新的資料類型。 引進新的資料類型或修改現有的類型是最常見的不相容問題來源。 RPC 執行時間模型假設接收應用程式知道其所接收的資料類型，因此資料會放在不含一般資料描述的網路上。 當收件者所預期的資料類型不同于傳送者放置於網路上的資料類型時，存根會引發例外狀況 (或傳輸會以較不正常的方式) 。

RPC 介面是由其 UUID 及其主要和次要版本號碼所定義。 當您變更現有的介面時，您應該在介面結尾新增方法，並變更次要版本號碼。 如果您在其他任何地方新增方法，或對介面進行任何其他變更，您也必須變更主要版本號碼。

實際上，有時候您無法變更次要版本號碼，因為新的用戶端將無法與舊的伺服器通訊，而且您無法補救伺服器。 \_ \_ \_ \_ \_ 當用戶端呼叫的方法超過與伺服器的介面所指定的方法時，rpc 執行時間會引發 PROCNUM 超出範圍的例外狀況。 因應措施是讓版本號碼保持不變，並撰寫用戶端程式代碼以正常方式處理此例外狀況，因為用戶端會降低其效能，例如，或任何適合您應用程式的方式。

在現有方法中變更資料類型的特殊案例有類似的因應措施。 如果 [**您的等**](/windows/desktop/Midl/union) 位的分支是指標，而且沒有無法辨識之類型的預設分支，您可以加入新的分支，以使用新的資料類型。 這不會變更資料結構的大小。 當您的用戶端與新的伺服器交談時，可以使用新的資料類型。 不過，當您的用戶端與舊伺服器交談時，執行時間會引發例外狀況 RPC \_ S \_ 無效 \_ 標記。 同樣地，您必須撰寫用戶端程式代碼，以適當地處理此例外狀況。

DCOM 介面是由其 GUID 識別。 在 DCOM 中，系統會將介面視為不可變，而且您只能藉由建立繼承自舊介面的新介面來進行變更。 這些規則可確保用戶端和伺服器保持相容。

 

 