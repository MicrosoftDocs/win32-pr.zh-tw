---
title: Windows 傳統型應用程式
description: 您可以取得詳細的遙測資料和分析報告，讓您瞭解 Windows 桌面應用程式如何透過新的 Windows 傳統型應用程式計畫進行。
ms.assetid: F1ED72A5-E1CD-4924-A81B-ED6FAF5E2AA3
ms.topic: article
ms.date: 11/02/2018
ms.openlocfilehash: 90483194654d5656060c57e3ad7593410a08660c2b8fc71bbbe9e42f08f17c45
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/11/2021
ms.locfileid: "118105718"
---
# <a name="windows-desktop-application-program"></a>Windows 傳統型應用程式

您可以取得詳細的遙測資料和分析報告，讓您瞭解 Windows 桌面應用程式如何透過新的 Windows 傳統型應用程式計畫進行。

存取這項資料並不需要付費，只要[註冊](https://login.microsoftonline.com/common/oauth2/authorize?client_id=4990cffe-04e8-4e8b-808a-1175604b879f&response_mode=form_post&response_type=code+id_token&scope=openid+profile&state=OpenIdConnect.AuthenticationProperties%3deJsPaLaK4fU55nKvN21CjU6FsdJ0aPGfhsjGAZ0HR9bE6rgwHHX4izvRt_w-0VUlIF0ClCya4cVY6Uv4qTAqDrH8LTwFpjFGWVW2BAIJmAAuxBLZGTPS_DYy0wwgvTh1orWTCMvBdlOu_kF8vwNe4mjtk9JRMvYaETyspKrJi-s5Z2K7lKIPqnlFkwSU-aoot-3NxTeQ0wu6_RJ1nf_kLFatEkVAqokDSYTKkpv7zF6gA3YYriMFoC9_f2uxuXpI-STckg&nonce=637177463062493881.YjhiOTZjYTMtOTVhZS00OGM1LWI4MDItNWE5MThjMjA1ZjZmMTAyZDRiMGQtMDJhNC00ZDJmLWFkM2QtM2FjZDJkNjcxYWQy&redirect_uri=https%3a%2f%2fpartner.microsoft.com%2faad%2fauthPostGateway&resource=797f4846-ba00-4fd7-ba43-dac1f8f63013&mkt=en-US)並接受[Windows 傳統型應用程式計畫合約](https://go.microsoft.com/fwlink/?linkid=853677)，然後使用您用來簽署應用程式可執行檔的相同憑證上傳已簽署的檔案即可。

## <a name="join-the-windows-desktop-application-program"></a>加入 Windows 傳統型應用程式計畫

**如果您的公司已經有合作夥伴中心帳戶**：請使用與帳戶擁有者) 相關聯的 Microsoft 帳戶來登入您的合作夥伴中心帳戶 (，然後流覽至 [ **程式** ] 頁面 ([ **帳戶設定** ] 或在左側導覽功能表中選取 [ **全部** ]) 。 在 [ **Windows 傳統型應用程式計畫**] 下，按一下 [**入門**] 來加入程式，而不需額外費用。 如果您有與合作夥伴中心帳戶相關聯的 Azure AD 租使用者，您新增的使用者將能夠存取 Windows 傳統型應用程式計畫。 即將推出，我們可以讓您為此程式設定更細微的存取權。

> [!Tip]  
> 如果您的公司有合作夥伴中心帳戶，但您沒有其存取權，請要求系統管理員 [將您新增為使用者](/windows/uwp/publish/add-users-groups-and-azure-ad-applications)。 請注意，只有帳戶擁有者可以聯結 Windows 傳統型應用程式計畫。

 

**如果您的公司沒有合作夥伴中心帳戶**：您可以 [直接註冊 Windows 傳統型應用程式計畫](https://login.microsoftonline.com/common/oauth2/authorize?client_id=4990cffe-04e8-4e8b-808a-1175604b879f&response_mode=form_post&response_type=code+id_token&scope=openid+profile&state=OpenIdConnect.AuthenticationProperties%3dWc5R_wIKVD0EbOy2UUxS0_0GQJnIAbD-eisMn7Gb4cJL18fRdelvbtj5_R0zoGlsebcnAxIvwKS5kx4Ma4mLMbU4l9ULsE9ajiZU4wtchLJXyJGsPCjCBUNV7TY1SzwXAI-LepSoXkqa8xSywVb7JZ3Xed-Lcw-kwEShFOwt0SdSdc1nNevHbPOhotOeFQcqbo0HESVYXk6pZORJ_OYimG99onp_zSTyludOvvaTd9GYKUgX9exCU5IHReP7MzJDHOgqTg&nonce=637177463071243612.NDU4MjE2ZTMtNmVkMi00YWNiLWEzZGEtMjYyNDRkODI0M2FmOTM3MmE1NzgtMzQ1OC00M2ZkLWJhMDktYzI4YTNhNzdiYTk0&redirect_uri=https%3a%2f%2fpartner.microsoft.com%2faad%2fauthPostGateway&resource=797f4846-ba00-4fd7-ba43-dac1f8f63013&mkt=en-US)的免費帳戶。 即將推出，我們會提供選項，讓 [Azure AD 租使用者與您的帳戶產生關聯](/windows/uwp/publish/add-users-groups-and-azure-ad-applications) ，讓公司中的其他人員也可以登入。

## <a name="add-your-desktop-applications"></a>新增您的桌面應用程式

加入程式之後，您必須將 Windows desktop 應用程式新增至儀表板，讓我們可以開始顯示您的分析報告。

我們會使用程式碼簽署來建立您公司的身分識別，並取得您所發佈之應用程式的分析。

我們會為您提供檔案，並要求您使用相同、未過期、未撤銷的程式碼簽署憑證簽署憑證，以用來簽署您的桌面應用程式。 之後，您會將該簽署的檔案上傳至您的儀表板。 這可讓我們知道任何使用相同憑證簽署的桌面應用程式都屬於您的帳戶。 我們不會將您的憑證資訊用於任何其他用途。

> [!Important]  
> 如果您發行新的桌面應用程式，就不需要重複此程式。 當您上傳已簽署的檔案時，我們會自動識別使用相同憑證簽署的任何新應用程式，而且我們會自動取得這些產品的分析。 您也不需要在應用程式內散發提供的檔案，或為您的產品提交任何種類的對應

 

**新增一或多個桌面應用程式**

1.  從儀表板選取 [ **新增桌面應用程式**]。
2.  在下一個頁面上，選取 [ **下載檔案**] 以下載可簽署的檔案，然後將檔案儲存到您的電腦。
3.  使用您用來驗證桌面應用程式 () 的相同程式碼簽署憑證來簽署您剛剛下載的檔案。 您可以使用 Microsoft Visual Studio 所提供的 SignTool.exe (，以及做為[Windows SDK](https://developer.microsoft.com/windows/downloads/windows-10-sdk)) 的一部分來簽署此檔案。 有關此程式的詳細資料如下所述。
4.  Upload 您剛剛簽署的檔案，方法是將它拖曳到欄位 (或按一下以流覽您的檔案) 。
5.  選取 [ **提交** ] 以完成流程。

![新增桌面應用程式的步驟](images/uploadcert.png)

如果您使用一個以上的程式碼簽署憑證，您可以針對每個憑證重複上述步驟。 您可以針對用來簽署應用程式的每個目前憑證下載、簽署及上傳檔案。 不過，每個下載的檔案只能使用一個憑證。

完成這些步驟之後，我們會找出哪些 Windows 的桌面應用程式是使用您用來簽署檔案的相同憑證來簽署。 在大部分情況下，我們會在48小時內開始顯示分析報表，但有時可能需要更長的時間。

## <a name="use-signtoolexe-to-sign-the-downloaded-file"></a>使用 signtool.exe 來簽署下載的檔案

Microsoft 提供的工具可用來簽署檔案，SignTool.exe，Visual Studio 和[Windows SDK](https://developer.microsoft.com/windows/downloads/windows-10-sdk)。 您可以使用此工具來執行和驗證程式代碼簽署程式。 您可以 [在這裡](/dotnet/framework/tools/signtool-exe)找到 SignTool.exe 的詳細資訊。

以下是使用此工具簽署可簽署之檔案的兩個最常見方式。

-   如果您可以存取程式碼簽署憑證作為[個人資訊 Exchange (PFX) ](/windows-hardware/drivers/install/personal-information-exchange---pfx--files)檔：

    ``` syntax
    signtool sign /f MyCert.pfx /p MyCertPassword /v SignableFile.bin
    ```

    ![顯示命令提示字元視窗的螢幕擷取畫面，其中顯示 ' signtool sign/f Mycert.cer .pfx/p MyCertPassword/v SignableFile. bin ' 命令。](images/signtool2.png)

-   如果您的本機憑證存放區中有可用的程式碼簽署憑證：

    ``` syntax
    Signtool sign /v /s MY /n CertSubjectName SignableFile.bin
    ```

    ![顯示此命令的命令提示字元視窗](images/signtool.png)

簽署檔案之後，您可以使用有效的憑證確認是否已成功簽署檔案，如下所示：

``` syntax
signtool verify /a SignableFile.bin
```

## <a name="viewing-your-analytic-data"></a>查看分析資料

上傳您的已簽署檔案並識別您的桌面應用程式之後，您的儀表板會顯示應用程式的總覽以及重要的計量。

我們的遙測資料會顯示每個與您的憑證相關聯之應用程式的健康情況資訊，例如當機。 您的儀表板會顯示應用程式的總覽，以及重要的計量。 您可以選取任何應用程式，以在儀表板中查看其 [健康情況報告](#health-report)、 [安裝報表](#installs-report)和 [封鎖報表](#application-blocks-report) 。 您也可以[使用 Microsoft Store 分析 API，以程式設計方式取得分析資料](#retrieve-analytic-data-using-the-microsoft-store-analytics-api)。

> [!Note]  
> 如果我們偵測到應用程式的中繼資料已更新為使用新的名稱，我們會開始以新的名稱報告新的資料。 與舊名稱相關聯的歷程記錄資料會保留30天。
> 
> 應用程式必須至少安裝在100裝置上，才能流量分析。


### <a name="health-report"></a>健康情況報告

**健康** 情況報告可讓您取得應用程式效能和品質的相關資料，包括損毀和沒有回應的事件。 如果適用，您可以檢視堆疊追蹤和/或 CAB 檔案以進一步偵錯。

![健康情況報告-windows 桌面應用程式](images/health.png)

您可以透過數種方式來篩選資料，讓您能夠：

-   查看所有失敗類型的摘要（依點擊次數排序）
-   向下切入到特定的失敗，並下載堆疊追蹤，以更快速地將問題進行分析
-   將您應用程式的新版本與舊版進行比較
-   查看匯總或依區域的健康情況資料，讓您能夠隔離特定區域的問題
-   比較您的桌面應用程式在 Windows 版本或特定版本（例如最新的 Windows 10 版本）的效能
-   查看應用程式中包含的一個特定可執行檔的健全狀況資訊

選取 [**失敗**] 資料表上方 **Upload 符號**，以上傳包含應用程式 [符號](/windows-hardware/drivers/debugger/symbols-and-symbol-files)檔的 .zip 檔案。 這些符號檔將會編制索引，用來產生更精確的堆疊追蹤。 .zip 內的符號檔案類型應該是 .pdb、.dll 或 .exe。 順利上傳 .zip 檔案之後，您應該會看到較少的 **！** 在大約5天內，應用程式的失敗清單中有未知的新錯誤值。

### <a name="installs-report"></a>安裝報告

**安裝** 報表可讓您查看應用程式在一天內安裝的裝置數目，以及過去30天內安裝每個應用程式版本的平均裝置數目。

您可以透過數種方式來篩選資料，讓您能夠：

-   查看安裝的摘要（依熱門程度排序）
-   將您應用程式的新版本與舊版進行比較
-   查看匯總或依區域的安裝資料
-   比較您的桌面應用程式在 Windows 版本或特定版本的效能，例如最新的 Windows 10 版本，或 Windows 測試人員快速和緩慢的版本

### <a name="application-blocks-report"></a>應用程式區塊報表

[**應用程式封鎖**] 報告可讓您查看應用程式影響 Windows 10 升級 Windows 10 裝置的相關資訊。 您可以查看在指定的一天內有多少裝置受到影響，以及過去30天內裝置的平均數目。

包含的升級區塊類型如下所示： 

<table>
<tr><th>類別</th><th>問題</th><th>描述</th><th>提供給使用者的指引</th></tr>
<tr><td>可能的 sediment</td><td>將封鎖升級</td><td>應用程式將無法在新的 OS 發行版本上運作。 在安裝期間需要使用者動作，才能繼續進行升級。</td><td>升級前請先移除應用程式，並與開發人員確認應用程式的相容版本。</td></tr>
<tr><td>暫存 sediment</td><td>可能會封鎖升級。 需要測試應用程式。</td><td>Microsoft 正在調查與此應用程式相關的升級問題。 升級將不會對可能受影響的使用者推出。</td><td>升級前請先移除應用程式，並與開發人員確認應用程式的相容版本。</td></tr>
<tr><td>執行時間通知</td><td>可能無法在新的 OS 發行版本中正確運作，但不會封鎖升級</td><td>應用程式不會防止升級，但偵測到的問題可能會導致新的 OS 發行版本無法正常運作。</td><td>升級不需要採取任何動作，但請務必在新的 OS 發行版本上測試應用程式，並視需要向開發人員確認相容的版本。</td></tr>
</table>

### <a name="retrieve-analytic-data-using-the-microsoft-store-analytics-api"></a>使用 Microsoft Store 分析 API 取得分析資料

Microsoft Store 分析 API 可讓您以程式設計方式，為您已新增至帳戶的應用程式取出分析資料。

此 API 提供下列 Windows 傳統型應用程式計畫特定的方法：

-   [安裝](/windows/uwp/monetize/get-desktop-app-installs)
-   [失敗點擊數](/windows/uwp/monetize/get-desktop-application-error-reporting-data)
-   [失敗詳細資料](/windows/uwp/monetize/get-details-for-an-error-in-your-desktop-application)
-   [堆疊追蹤](/windows/uwp/monetize/get-the-stack-trace-for-an-error-in-your-desktop-application)
-   [CAB 檔](/windows/uwp/monetize/download-the-cab-file-for-an-error-in-your-desktop-application)
-   [升級區塊](/windows/uwp/monetize/get-desktop-block-data)
-   [升級區塊詳細資料](/windows/uwp/monetize/get-desktop-block-data-details)


如需使用此 API 的詳細資訊，請參閱 [使用 Store Service 存取分析資料](/windows/uwp/monetize/access-analytics-data-using-windows-store-services)。

## <a name="managing-your-desktop-application-metadata"></a>管理您的桌面應用程式中繼資料

我們會使用您的可執行檔中的檔案名、檔案版本、產品名稱和產品版本中繼資料，將可執行檔的邏輯群組推斷為應用程式。 如果可執行檔沒有正確的中繼資料，這些檔案可能會在 **未知** 的應用程式名稱底下出現，或應用程式名稱會預設為個別的可執行檔名稱。

將您的應用程式和檔案的中繼資料保持在最新狀態，有助於確保它們在您的儀表板中正確呈現。 以下是一些建議：

-   使用您的憑證來簽署您要在分析報告中看到的每個可執行檔，而不只是您的設定可執行檔。
-   針對屬於相同應用程式的所有可執行檔，提供一致的產品名稱和產品版本資訊 (也就是 *我的應用程式*) 。 如果您的一些可執行檔會與多個應用程式一起散發，請提供它們唯一的名稱 (例如 *共用的元件*) ，以便您可以看到這些可執行檔的分析，與它們所散發的應用程式分開。
-   每次變更您的中繼資料時，您可能會在儀表板中看到新的應用程式專案。 如果您進行變更，新的傳入遙測資料將會反映您的變更，但舊的遙測資料仍會顯示為 **未知** 的應用程式。
-   當您修訂檔案時，請務必更新應用程式版本和產品版本號碼。
    > [!Tip]  
    > 使用 [**VERSIONINFO**](/windows/desktop/menurc/versioninfo-resource) 資源為您的檔案和應用程式設定 **FileDescription**、 **FileVersion**、 **ProductName** 和 **ProductVersion** 。 下列範例會定義 **VERSIONINFO** 資源：
    >
    > ``` syntax
    > #define VER_PRODUCTNAME_STR      "Sample App"
    > #define VER_PRODUCTVERSION       3,10,349,0
    > #define VER_PRODUCTVERSION_STR   "3.10.349.0\0"
    > #define VER_FILEDESCRIPTION_STR  "Sample File"
    > #define VER_FILEVERSION          3,10,349,0
    > #define VER_FILEVERSION_STR      "3.10.349.0\0"
    > #define VER_COMPANYNAME_STR     "XYZ Corp."
    > #define VER_LEGALCOPYRIGHT_STR   "Copyright \251 XYZ Corp." 
    >  
    > VS_VERSION_INFO VERSIONINFO
    > FILEVERSION VER_FILEVERSION
    > PRODUCTVERSION VER_PRODUCTVERSION
    > FILEFLAGSMASK VER_FILEFLAGSMASK
    > FILEFLAGS VER_FILEFLAGS
    > FILEOS VER_FILEOS
    > FILETYPE VER_FILETYPE
    > FILESUBTYPE VER_FILESUBTYPE
    > BEGIN
    >     BLOCK "StringFileInfo"
    >     BEGIN
    >         BLOCK "040904E4"
    >         BEGIN
    >             VALUE "ProductName",      VER_PRODUCTNAME_STR
    >             VALUE "ProductVersion",   VER_PRODUCTVERSION_STR
    >             VALUE "FileDescription",  VER_FILEDESCRIPTION_STR
    >             VALUE "FileVersion",      VER_FILEVERSION_STR
    >             VALUE "CompanyName",      VER_COMPANYNAME_STR
    >             VALUE "LegalCopyright",   VER_LEGALCOPYRIGHT_STR
    >         END
    >     END
    >      
    > END 
    > ```

     

## <a name="add-and-manage-account-users"></a>新增和管理帳戶使用者

您可以使用 Azure Active Directory 來新增和管理 Windows 傳統型應用程式計畫帳戶中的其他使用者。 您可以新增個別使用者、使用者群組或 Azure AD 應用程式，為每個使用者提供預先定義的角色 (管理員或開發人員) 。

### <a name="associate-azure-active-directory-with-your-account"></a>將 Azure Active Directory 與您的帳戶建立關聯

為了新增和管理帳戶使用者，您必須先將您的帳戶與組織的 Azure Active Directory 建立關聯。 如果您的組織已經使用 Office 365 或其他 Microsoft 所提供的商務服務，您就已經具備 Azure AD。 否則，您可以建立新的 Azure AD 租使用者，而不需額外付費。

如需詳細資訊，請參閱[將 Azure Active Directory 與您的合作夥伴中心帳戶建立關聯](/windows/uwp/publish/associate-azure-ad-with-dev-center)。 雖然本主題著重于 Windows apps 開發人員計畫，但讓租使用者與 Windows 傳統型應用程式計畫的運作方式相同。

### <a name="add-users-groups-and-azure-ad-applications-to-your-account"></a>將使用者、群組和 Azure AD 應用程式新增至您的帳戶

設定 Azure AD 關聯之後，您可以移至 [帳戶設定] 下的 [使用者] 區段來新增使用者。 每位使用者都會被指派一個角色來定義帳戶的存取權。 您也可以新增使用者群組和 Azure AD 應用程式，以授與他們合作夥伴中心帳戶的存取權。 如需新增使用者的詳細資訊，請參閱 [新增使用者、群組和 Azure AD 應用程式](/windows/uwp/publish/add-users-groups-and-azure-ad-applications)。

您新增到帳戶的每個使用者、群組或 Azure AD 應用程式都必須被指派一個角色。 這項程式會在 [設定角色或帳戶使用者的自訂許可權](/windows/uwp/publish/set-custom-permissions-for-account-users)中描述。 不過請注意，在 Windows 傳統型應用程式計畫中，無法指派自訂許可權或限制依產品的存取。 相反地，每個使用者都必須獲指派下列其中一個標準角色。



| 角色      | 描述                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|-----------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Manager   | 可以上傳和移除憑證，並可查看所有分析資料。 具有帳戶的完整存取權，但變更財務資訊除外。 這包括管理使用者，但請注意，在 Azure AD 租使用者中建立和刪除使用者的能力，取決於 Azure AD 的帳戶許可權。 也就是說，如果使用者被指派管理員角色，但沒有組織 Azure AD 中的全域管理員許可權，他們將無法建立新的使用者，也無法從目錄中刪除使用者 (但他們可以變更使用者的帳戶角色) 。<br/> 請注意，如果您的帳戶與多個 Azure AD 租使用者相關聯，則管理員將無法查看使用者 (的完整詳細資料，包括名字、姓氏、密碼復原電子郵件，以及它們是否為 Azure AD 全域管理員) ，除非他們已使用具有該租使用者全域管理員許可權的帳戶登入相同的租使用者。 不過，他們可以新增和移除任何與該帳戶相關聯之租使用者中的使用者。 <br/> |
| 開發人員 | 可以查看與帳戶相關聯的應用程式和憑證詳細資料，並可查看 **健康** 情況並 **安裝** 報表。 無法查看財務資訊或帳戶設定。<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |



 

## <a name="faq"></a>常見問題集

-   **為什麼看不到應用程式的任何資料？** 在偵測到足夠的使用者來收集有意義的資訊之前，不會顯示資料。 如果您剛發行您的應用程式，可能需要一些時間才能達到此最小採用閾值。 您可能不會看到資料的另一個原因是您尚未使用特定應用程式的憑證來簽署檔案。 請務必上傳以您用來簽署應用程式的每個憑證簽署的檔案。
-   **我可以透過 API 存取此資料嗎？** 是的，當所有開發人員都可以使用此程式時，就可以透過公用 API 取得資料。
-   **使用較舊憑證的應用程式呢？** 可惜的是，即使您使用相同的金鑰來更新憑證，也不支援提交過期或撤銷的憑證。
-   **為什麼我會看到無法辨識的應用程式？** 如果您在應用程式中用來簽署檔案的憑證也會由公司中的其他人用來簽署另一個應用程式，您也會看到該應用程式的遙測。 未來，我們將提供可讓您從儀表板隱藏應用程式的選項。 如果您的公司帳戶已附加至 Azure AD 租使用者，您可以要求系統管理員修改使用者權限，如此就只會顯示特定的應用程式。
-   **如何提供有關體驗或取得支援的意見反應？** 如果您需要協助，您可以在 [此](https://developer.microsoft.com/windows/support/)建立支援要求。 若要分享您的意見反應，請使用 [**帳戶設定**]) 下的 **意見** 反應連結 (，然後選取 [**分析**] 區域，讓我們知道您的想法。 
 

