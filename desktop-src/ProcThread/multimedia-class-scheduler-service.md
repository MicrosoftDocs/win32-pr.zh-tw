---
description: 多媒體類別排程器服務 (MMCSS) 可讓多媒體應用程式確保其時間緊迫的處理會獲得 CPU 資源的優先存取權。
ms.assetid: a7169938-1c72-4c4c-881a-cb08ad6182c7
title: 多媒體類別排程器服務
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 80656276af30495c084d0964534a04e11896bcd2
ms.sourcegitcommit: c16214e53680dc71d1c07111b51f72b82a4512d8
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 03/03/2021
ms.locfileid: "103945630"
---
# <a name="multimedia-class-scheduler-service"></a><span data-ttu-id="216fa-103">多媒體類別排程器服務</span><span class="sxs-lookup"><span data-stu-id="216fa-103">Multimedia Class Scheduler Service</span></span>

<span data-ttu-id="216fa-104">多媒體類別排程器服務 (MMCSS) 可讓多媒體應用程式確保其時間緊迫的處理會獲得 CPU 資源的優先存取權。</span><span class="sxs-lookup"><span data-stu-id="216fa-104">The Multimedia Class Scheduler service (MMCSS) enables multimedia applications to ensure that their time-sensitive processing receives prioritized access to CPU resources.</span></span> <span data-ttu-id="216fa-105">這項服務可讓多媒體應用程式盡可能充分利用 CPU，而不會拒絕 CPU 資源給較低優先順序的應用程式。</span><span class="sxs-lookup"><span data-stu-id="216fa-105">This service enables multimedia applications to utilize as much of the CPU as possible without denying CPU resources to lower-priority applications.</span></span>

<span data-ttu-id="216fa-106">MMCSS 會使用儲存在登錄中的資訊來識別支援的工作，並判斷執行這些工作之執行緒的相對優先權。</span><span class="sxs-lookup"><span data-stu-id="216fa-106">MMCSS uses information stored in the registry to identify supported tasks and determine the relative priority of threads performing these tasks.</span></span> <span data-ttu-id="216fa-107">執行與特定工作相關之工作的每個執行緒都會呼叫 [**AvSetMmMaxThreadCharacteristics**](/windows/desktop/api/Avrt/nf-avrt-avsetmmmaxthreadcharacteristicsa) 或 [**AvSetMmThreadCharacteristics**](/windows/desktop/api/Avrt/nf-avrt-avsetmmthreadcharacteristicsa) 函式，以通知 MMCSS 它正在處理該工作。</span><span class="sxs-lookup"><span data-stu-id="216fa-107">Each thread that is performing work related to a particular task calls the [**AvSetMmMaxThreadCharacteristics**](/windows/desktop/api/Avrt/nf-avrt-avsetmmmaxthreadcharacteristicsa) or [**AvSetMmThreadCharacteristics**](/windows/desktop/api/Avrt/nf-avrt-avsetmmthreadcharacteristicsa) function to inform MMCSS that it is working on that task.</span></span>

<span data-ttu-id="216fa-108">如需使用 MMCSS 的程式範例，請參閱 [獨佔模式資料流程](/previous-versions//bb614507(v=vs.85))。</span><span class="sxs-lookup"><span data-stu-id="216fa-108">For an example of a program that uses MMCSS, see [Exclusive-Mode Streams](/previous-versions//bb614507(v=vs.85)).</span></span>

<span data-ttu-id="216fa-109">**Windows Server 2003 和 WINDOWS XP：** MMCSS 無法使用。</span><span class="sxs-lookup"><span data-stu-id="216fa-109">**Windows Server 2003 and Windows XP:** MMCSS is not available.</span></span>

## <a name="registry-settings"></a><span data-ttu-id="216fa-110">登錄設定</span><span class="sxs-lookup"><span data-stu-id="216fa-110">Registry Settings</span></span>

<span data-ttu-id="216fa-111">MMCSS 設定會儲存在下列登錄機碼中：</span><span class="sxs-lookup"><span data-stu-id="216fa-111">The MMCSS settings are stored in the following registry key:</span></span>

<span data-ttu-id="216fa-112">**HKEY \_ LOCAL \_ MACHINE \\ SOFTWARE \\ Microsoft \\ Windows NT \\ CurrentVersion \\ 多媒體 \\ SystemProfile**</span><span class="sxs-lookup"><span data-stu-id="216fa-112">**HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Multimedia\\SystemProfile**</span></span>

<span data-ttu-id="216fa-113">此機碼包含名為 **SystemResponsiveness** 的 **REG \_ DWORD** 值，可決定應保證低優先順序工作的 CPU 資源百分比。</span><span class="sxs-lookup"><span data-stu-id="216fa-113">This key contains a **REG\_DWORD** value named **SystemResponsiveness** that determines the percentage of CPU resources that should be guaranteed to low-priority tasks.</span></span> <span data-ttu-id="216fa-114">例如，如果此值為20，則會為低優先順序工作保留20% 的 CPU 資源。</span><span class="sxs-lookup"><span data-stu-id="216fa-114">For example, if this value is 20, then 20% of CPU resources are reserved for low-priority tasks.</span></span> <span data-ttu-id="216fa-115">請注意，未平均整除的值會無條件進位到最接近10的倍數。</span><span class="sxs-lookup"><span data-stu-id="216fa-115">Note that values that are not evenly divisible by 10 are rounded up to the nearest multiple of 10.</span></span> <span data-ttu-id="216fa-116">0值也會被視為10。</span><span class="sxs-lookup"><span data-stu-id="216fa-116">A value of 0 is also treated as 10.</span></span>

<span data-ttu-id="216fa-117">金鑰也包含名為 **tasks** 的子機碼，其中包含工作清單。</span><span class="sxs-lookup"><span data-stu-id="216fa-117">The key also contains a subkey named **Tasks** that contains the list of tasks.</span></span> <span data-ttu-id="216fa-118">依預設，Windows 支援下列工作：</span><span class="sxs-lookup"><span data-stu-id="216fa-118">By default, Windows supports the following tasks:</span></span>

-   <span data-ttu-id="216fa-119">**音訊**</span><span class="sxs-lookup"><span data-stu-id="216fa-119">**Audio**</span></span>
-   <span data-ttu-id="216fa-120">**擷取**</span><span class="sxs-lookup"><span data-stu-id="216fa-120">**Capture**</span></span>
-   <span data-ttu-id="216fa-121">**Distribution**</span><span class="sxs-lookup"><span data-stu-id="216fa-121">**Distribution**</span></span>
-   <span data-ttu-id="216fa-122">**遊戲**</span><span class="sxs-lookup"><span data-stu-id="216fa-122">**Games**</span></span>
-   <span data-ttu-id="216fa-123">**播放**</span><span class="sxs-lookup"><span data-stu-id="216fa-123">**Playback**</span></span>
-   <span data-ttu-id="216fa-124">**Pro 音訊**</span><span class="sxs-lookup"><span data-stu-id="216fa-124">**Pro Audio**</span></span>
-   <span data-ttu-id="216fa-125">**視窗管理員**</span><span class="sxs-lookup"><span data-stu-id="216fa-125">**Window Manager**</span></span>

<span data-ttu-id="216fa-126">Oem 可以視需要新增其他工作。</span><span class="sxs-lookup"><span data-stu-id="216fa-126">OEMs can add additional tasks as required.</span></span>

<span data-ttu-id="216fa-127">每個工作機碼都包含下列一組值，這些值表示要套用至與工作相關聯之執行緒的特性。</span><span class="sxs-lookup"><span data-stu-id="216fa-127">Each task key contains the following set of values that represent characteristics to be applied to threads that are associated with the task.</span></span>

| <span data-ttu-id="216fa-128">值</span><span class="sxs-lookup"><span data-stu-id="216fa-128">Value</span></span>                   | <span data-ttu-id="216fa-129">格式</span><span class="sxs-lookup"><span data-stu-id="216fa-129">Format</span></span>         | <span data-ttu-id="216fa-130">可能值</span><span class="sxs-lookup"><span data-stu-id="216fa-130">Possible values</span></span>                                                                                                                                                                                                                                                                                                                                                         |
|-------------------------|----------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="216fa-131">**親和力**</span><span class="sxs-lookup"><span data-stu-id="216fa-131">**Affinity**</span></span>            | <span data-ttu-id="216fa-132">**REG \_ DWORD**</span><span class="sxs-lookup"><span data-stu-id="216fa-132">**REG\_DWORD**</span></span> | <span data-ttu-id="216fa-133">表示處理器親和性的位元遮罩。</span><span class="sxs-lookup"><span data-stu-id="216fa-133">A bitmask that indicates the processor affinity.</span></span> <span data-ttu-id="216fa-134">0x00 和0xFFFFFFFF 都表示未使用處理器親和性。</span><span class="sxs-lookup"><span data-stu-id="216fa-134">Both 0x00 and 0xFFFFFFFF indicate that processor affinity is not used.</span></span>                                                                                                                                                                                                                                                 |
| <span data-ttu-id="216fa-135">**僅限背景**</span><span class="sxs-lookup"><span data-stu-id="216fa-135">**Background Only**</span></span>     | <span data-ttu-id="216fa-136">**REG \_ SZ**</span><span class="sxs-lookup"><span data-stu-id="216fa-136">**REG\_SZ**</span></span>    | <span data-ttu-id="216fa-137">指出這是否為背景工作 (沒有任何使用者介面) 。</span><span class="sxs-lookup"><span data-stu-id="216fa-137">Indicates whether this is a background task (no user interface).</span></span> <span data-ttu-id="216fa-138">背景工作的執行緒不會因為視窗焦點的變更而變更。</span><span class="sxs-lookup"><span data-stu-id="216fa-138">The threads of a background task do not change because of a change in window focus.</span></span> <span data-ttu-id="216fa-139">這個值可以設定為 True 或 False。</span><span class="sxs-lookup"><span data-stu-id="216fa-139">This value can be set to True or False.</span></span>                                                                                                                                                                            |
| <span data-ttu-id="216fa-140">**BackgroundPriority**</span><span class="sxs-lookup"><span data-stu-id="216fa-140">**BackgroundPriority**</span></span>  | <span data-ttu-id="216fa-141">**REG \_ DWORD**</span><span class="sxs-lookup"><span data-stu-id="216fa-141">**REG\_DWORD**</span></span> | <span data-ttu-id="216fa-142">背景優先權。</span><span class="sxs-lookup"><span data-stu-id="216fa-142">The background priority.</span></span> <span data-ttu-id="216fa-143">值的範圍是1-8。</span><span class="sxs-lookup"><span data-stu-id="216fa-143">The range of values is 1-8.</span></span>                                                                                                                                                                                                                                                                                                                    |
| <span data-ttu-id="216fa-144">**時脈速率**</span><span class="sxs-lookup"><span data-stu-id="216fa-144">**Clock Rate**</span></span>          | <span data-ttu-id="216fa-145">**REG \_ DWORD**</span><span class="sxs-lookup"><span data-stu-id="216fa-145">**REG\_DWORD**</span></span> | <span data-ttu-id="216fa-146">MMCSS 用來判斷處理器資源排程之資料細微性的提示。**Windows Server 2008 和 Windows Vista：** 當執行緒加入此工作時，系統所使用的保證最大頻率（以 100-毫微秒間隔）。</span><span class="sxs-lookup"><span data-stu-id="216fa-146">A hint used by MMCSS to determine the granularity of processor resource scheduling.**Windows Server 2008 and Windows Vista:** The maximum guaranteed clock rate the system uses if a thread joins this task, in 100-nanosecond intervals.</span></span> <span data-ttu-id="216fa-147">從 Windows 7 和 Windows Server 2008 R2 開始，這種保證已移除，以減少系統電源耗用量。</span><span class="sxs-lookup"><span data-stu-id="216fa-147">Starting with Windows 7 and Windows Server 2008 R2, this guarantee was removed to reduce system power consumption.</span></span><br/> |
| <span data-ttu-id="216fa-148">**GPU 優先順序**</span><span class="sxs-lookup"><span data-stu-id="216fa-148">**GPU Priority**</span></span>        | <span data-ttu-id="216fa-149">**REG \_ DWORD**</span><span class="sxs-lookup"><span data-stu-id="216fa-149">**REG\_DWORD**</span></span> | <span data-ttu-id="216fa-150">GPU 優先權。</span><span class="sxs-lookup"><span data-stu-id="216fa-150">The GPU priority.</span></span> <span data-ttu-id="216fa-151">值的範圍是0-31。</span><span class="sxs-lookup"><span data-stu-id="216fa-151">The range of values is 0-31.</span></span> <span data-ttu-id="216fa-152">尚未使用此優先順序。</span><span class="sxs-lookup"><span data-stu-id="216fa-152">This priority is not yet used.</span></span>                                                                                                                                                                                                                                                                                           |
| <span data-ttu-id="216fa-153">**優先順序**</span><span class="sxs-lookup"><span data-stu-id="216fa-153">**Priority**</span></span>            | <span data-ttu-id="216fa-154">**REG \_ DWORD**</span><span class="sxs-lookup"><span data-stu-id="216fa-154">**REG\_DWORD**</span></span> | <span data-ttu-id="216fa-155">工作優先權。</span><span class="sxs-lookup"><span data-stu-id="216fa-155">The task priority.</span></span> <span data-ttu-id="216fa-156">值的範圍是 1 (低) 至 8 (高) 。針對 **排程類別** 為 High 的工作，此值一律會被視為2。</span><span class="sxs-lookup"><span data-stu-id="216fa-156">The range of values is 1 (low) to 8 (high).For tasks with a **Scheduling Category** of High, this value is always treated as 2.</span></span><br/>                                                                                                                                                                                                           |
| <span data-ttu-id="216fa-157">**排程分類**</span><span class="sxs-lookup"><span data-stu-id="216fa-157">**Scheduling Category**</span></span> | <span data-ttu-id="216fa-158">**REG \_ SZ**</span><span class="sxs-lookup"><span data-stu-id="216fa-158">**REG\_SZ**</span></span>    | <span data-ttu-id="216fa-159">排程分類。</span><span class="sxs-lookup"><span data-stu-id="216fa-159">The scheduling category.</span></span> <span data-ttu-id="216fa-160">這個值可以設定為 [高]、[中] 或 [低]。</span><span class="sxs-lookup"><span data-stu-id="216fa-160">This value can be set to High, Medium, or Low.</span></span>                                                                                                                                                                                                                                                                                                 |
| <span data-ttu-id="216fa-161">**SFIO 優先順序**</span><span class="sxs-lookup"><span data-stu-id="216fa-161">**SFIO Priority**</span></span>       | <span data-ttu-id="216fa-162">**REG \_ SZ**</span><span class="sxs-lookup"><span data-stu-id="216fa-162">**REG\_SZ**</span></span>    | <span data-ttu-id="216fa-163">排程的 i/o 優先順序。</span><span class="sxs-lookup"><span data-stu-id="216fa-163">The scheduled I/O priority.</span></span> <span data-ttu-id="216fa-164">這個值可以設定為 [閒置]、[低]、[一般] 或 [高]。</span><span class="sxs-lookup"><span data-stu-id="216fa-164">This value can be set to Idle, Low, Normal, or High.</span></span> <span data-ttu-id="216fa-165">不使用這個值。</span><span class="sxs-lookup"><span data-stu-id="216fa-165">This value is not used.</span></span>                                                                                                                                                                                                                                                                |



 

> [!Note]  
> <span data-ttu-id="216fa-166">為了節省電力，除非絕對必要，否則應用程式不應該將全系統計時器的解析度設定為較小的值。</span><span class="sxs-lookup"><span data-stu-id="216fa-166">To conserve power, applications should not set the resolution of the system-wide timer to a small value unless absolutely necessary.</span></span> <span data-ttu-id="216fa-167">如需詳細資訊，請參閱《 [Windows 7 開發人員指南》](../win7devguide/windows-7-developer-guide.md)中的[效能](../win7devguide/performance.md)。</span><span class="sxs-lookup"><span data-stu-id="216fa-167">For more information, see [Performance](../win7devguide/performance.md) in the [Windows 7 Developers Guide](../win7devguide/windows-7-developer-guide.md).</span></span>

 

## <a name="thread-priorities"></a><span data-ttu-id="216fa-168">執行緒優先順序</span><span class="sxs-lookup"><span data-stu-id="216fa-168">Thread Priorities</span></span>

<span data-ttu-id="216fa-169">MMCSS 可提升處理高優先順序多媒體工作之執行緒的優先順序。</span><span class="sxs-lookup"><span data-stu-id="216fa-169">The MMCSS boosts the priority of threads that are working on high-priority multimedia tasks.</span></span>

<span data-ttu-id="216fa-170">MMCSS 會使用下列因素來判斷線程的優先順序：</span><span class="sxs-lookup"><span data-stu-id="216fa-170">MMCSS determines the priority of a thread using the following factors:</span></span>

-   <span data-ttu-id="216fa-171">工作的基本優先權。</span><span class="sxs-lookup"><span data-stu-id="216fa-171">The base priority of the task.</span></span>
-   <span data-ttu-id="216fa-172">[**AvSetMmThreadPriority**](/windows/desktop/api/Avrt/nf-avrt-avsetmmthreadpriority)函數的 *Priority* 參數。</span><span class="sxs-lookup"><span data-stu-id="216fa-172">The *Priority* parameter of the [**AvSetMmThreadPriority**](/windows/desktop/api/Avrt/nf-avrt-avsetmmthreadpriority) function.</span></span>
-   <span data-ttu-id="216fa-173">應用程式是否在前景。</span><span class="sxs-lookup"><span data-stu-id="216fa-173">Whether the application is in the foreground.</span></span>
-   <span data-ttu-id="216fa-174">每個類別中的執行緒所耗用的 CPU 時間量。</span><span class="sxs-lookup"><span data-stu-id="216fa-174">How much CPU time is being consumed by the threads in each category.</span></span>

<span data-ttu-id="216fa-175">MMCSS 會根據其排程分類來設定用戶端執行緒的優先順序。</span><span class="sxs-lookup"><span data-stu-id="216fa-175">MMCSS sets the priority of client threads depending on their scheduling category.</span></span>

| <span data-ttu-id="216fa-176">類別</span><span class="sxs-lookup"><span data-stu-id="216fa-176">Category</span></span> | <span data-ttu-id="216fa-177">優先順序</span><span class="sxs-lookup"><span data-stu-id="216fa-177">Priority</span></span> | <span data-ttu-id="216fa-178">Description</span><span class="sxs-lookup"><span data-stu-id="216fa-178">Description</span></span>                                                                                                                               |
|----------|----------|-------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="216fa-179">高</span><span class="sxs-lookup"><span data-stu-id="216fa-179">High</span></span>     | <span data-ttu-id="216fa-180">23-26</span><span class="sxs-lookup"><span data-stu-id="216fa-180">23-26</span></span>    | <span data-ttu-id="216fa-181">這些執行緒執行的執行緒優先順序低於特定的系統層級工作。</span><span class="sxs-lookup"><span data-stu-id="216fa-181">These threads run at a thread priority that is lower than only certain system-level tasks.</span></span> <span data-ttu-id="216fa-182">此類別是針對 Pro 音訊工作所設計。</span><span class="sxs-lookup"><span data-stu-id="216fa-182">This category is designed for Pro Audio tasks.</span></span> |
| <span data-ttu-id="216fa-183">中</span><span class="sxs-lookup"><span data-stu-id="216fa-183">Medium</span></span>   | <span data-ttu-id="216fa-184">16-22</span><span class="sxs-lookup"><span data-stu-id="216fa-184">16-22</span></span>    | <span data-ttu-id="216fa-185">這些執行緒是前景中的應用程式的一部分。</span><span class="sxs-lookup"><span data-stu-id="216fa-185">These threads are part of the application that is in the foreground.</span></span>                                                                      |
| <span data-ttu-id="216fa-186">低</span><span class="sxs-lookup"><span data-stu-id="216fa-186">Low</span></span>      | <span data-ttu-id="216fa-187">8-15</span><span class="sxs-lookup"><span data-stu-id="216fa-187">8-15</span></span>     | <span data-ttu-id="216fa-188">此類別包含其餘的執行緒。</span><span class="sxs-lookup"><span data-stu-id="216fa-188">This category contains the remainder of the threads.</span></span> <span data-ttu-id="216fa-189">必要時，系統會保證 CPU 資源的最小百分比。</span><span class="sxs-lookup"><span data-stu-id="216fa-189">They are guaranteed a minimum percentage of the CPU resources if required.</span></span>           |
|          | <span data-ttu-id="216fa-190">1-7</span><span class="sxs-lookup"><span data-stu-id="216fa-190">1-7</span></span>      | <span data-ttu-id="216fa-191">這些執行緒已使用其 CPU 資源的配額。</span><span class="sxs-lookup"><span data-stu-id="216fa-191">These threads have used their quota of CPU resource.</span></span> <span data-ttu-id="216fa-192">如果沒有可用的低優先順序執行緒可供執行，則可以繼續執行。</span><span class="sxs-lookup"><span data-stu-id="216fa-192">They can continue to run if no low-priority threads are ready to run.</span></span>                |



 

 

 
