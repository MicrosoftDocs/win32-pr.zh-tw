---
description: 當有兩個或多個具有不同優先順序的執行緒在競爭中進行排程時，就會發生優先權反轉。
ms.assetid: 1cb2f3c9-4641-40d8-892c-768abaf6affb
title: 優先權反轉
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 09a891655196b8f7e81c118d39fb8516a244411f1f4f6d9505e2fb40818d71f7
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/11/2021
ms.locfileid: "120031928"
---
# <a name="priority-inversion"></a>優先權反轉

當有兩個或多個具有不同優先順序的執行緒在競爭中進行排程時，就會發生優先權反轉。 請考慮使用三個執行緒的簡單案例：執行緒1、執行緒2和執行緒3。 執行緒1是高優先順序，可做好排程。 執行緒2（低優先順序執行緒）正在執行重要區段中的程式碼。 執行緒1（高優先順序執行緒）開始等待中的執行緒2的共用資源。 執行緒3有中優先順序。 執行緒3會收到所有處理器時間，因為高優先順序的執行緒 (執行緒 1) 正在等候低優先順序執行緒 (執行緒 2) 的共用資源。 執行緒2不會離開重要區段，因為它沒有最高的優先順序，因此不會進行排程。

排程器會藉由隨機提升就緒執行緒的優先順序來解決這個問題 (在此案例中，低優先順序鎖定持有人) 。 低優先順序執行緒執行的時間夠長，無法結束重要區段，而高優先順序執行緒可以進入重要區段。 如果低優先順序執行緒在第一次沒有足夠的 CPU 時間來結束重要區段，則會在下一次排程期間得到另一個機會。

 

 



