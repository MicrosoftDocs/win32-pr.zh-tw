---
description: Microsoft Windows 安全性模型可讓您控制處理物件的存取。 如需安全性的詳細資訊，請參閱 Access-Control 模型。
ms.assetid: 508a17c4-88cd-431a-a102-00180a7f7ab5
title: 流程安全性和存取權限
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 93a5fb29599c5a769b9a7b63d653d24ec543e408
ms.sourcegitcommit: b01ad017c152c6756f3638623fe335877644d414
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 06/06/2021
ms.locfileid: "111549970"
---
# <a name="process-security-and-access-rights"></a><span data-ttu-id="b3b78-104">流程安全性和存取權限</span><span class="sxs-lookup"><span data-stu-id="b3b78-104">Process Security and Access Rights</span></span>

<span data-ttu-id="b3b78-105">Microsoft Windows 安全性模型可讓您控制處理物件的存取。</span><span class="sxs-lookup"><span data-stu-id="b3b78-105">The Microsoft Windows security model enables you to control access to process objects.</span></span> <span data-ttu-id="b3b78-106">如需安全性的詳細資訊，請參閱 [存取控制模型](../secauthz/access-control-model.md)。</span><span class="sxs-lookup"><span data-stu-id="b3b78-106">For more information about security, see [Access-Control Model](../secauthz/access-control-model.md).</span></span>

<span data-ttu-id="b3b78-107">當使用者登入時，系統會收集在驗證程式期間可唯一識別使用者的一組資料，並將其儲存在 [存取權杖](../secauthz/access-tokens.md)中。</span><span class="sxs-lookup"><span data-stu-id="b3b78-107">When a user logs in, the system collects a set of data that uniquely identifies the user during the authentication process, and stores it in an [access token](../secauthz/access-tokens.md).</span></span> <span data-ttu-id="b3b78-108">此存取權杖描述與使用者相關聯之所有進程的安全性內容。</span><span class="sxs-lookup"><span data-stu-id="b3b78-108">This access token describes the security context of all processes associated with the user.</span></span> <span data-ttu-id="b3b78-109">進程的安全性內容是一組提供給處理常式的認證，或建立進程的使用者帳戶。</span><span class="sxs-lookup"><span data-stu-id="b3b78-109">The security context of a process is the set of credentials given to the process or the user account that created the process.</span></span>

<span data-ttu-id="b3b78-110">您可以使用權杖，以使用 [**CreateProcessWithTokenW**](/windows/desktop/api/WinBase/nf-winbase-createprocesswithtokenw) 函式來指定進程的目前安全性內容。</span><span class="sxs-lookup"><span data-stu-id="b3b78-110">You can use a token to specify the current security context for a process using the [**CreateProcessWithTokenW**](/windows/desktop/api/WinBase/nf-winbase-createprocesswithtokenw) function.</span></span> <span data-ttu-id="b3b78-111">當您呼叫 [**CreateProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-createprocessa)、 [**CreateProcessAsUser**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-createprocessasusera)或 [**CreateProcessWithLogonW**](/windows/desktop/api/WinBase/nf-winbase-createprocesswithlogonw)函式時，可以指定進程的 [安全描述項](../secauthz/security-descriptors.md)。</span><span class="sxs-lookup"><span data-stu-id="b3b78-111">You can specify a [security descriptor](../secauthz/security-descriptors.md) for a process when you call the [**CreateProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-createprocessa), [**CreateProcessAsUser**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-createprocessasusera), or [**CreateProcessWithLogonW**](/windows/desktop/api/WinBase/nf-winbase-createprocesswithlogonw) function.</span></span> <span data-ttu-id="b3b78-112">如果您指定 **Null**，進程會取得預設安全描述項。</span><span class="sxs-lookup"><span data-stu-id="b3b78-112">If you specify **NULL**, the process gets a default security descriptor.</span></span> <span data-ttu-id="b3b78-113">進程之預設安全描述項中的 Acl 來自于建立者的主要或模擬權杖。</span><span class="sxs-lookup"><span data-stu-id="b3b78-113">The ACLs in the default security descriptor for a process come from the primary or impersonation token of the creator.</span></span>

<span data-ttu-id="b3b78-114">若要取出進程的安全描述項，請呼叫 [**GetSecurityInfo**](/windows/win32/api/aclapi/nf-aclapi-getsecurityinfo) 函數。</span><span class="sxs-lookup"><span data-stu-id="b3b78-114">To retrieve a process's security descriptor, call the [**GetSecurityInfo**](/windows/win32/api/aclapi/nf-aclapi-getsecurityinfo) function.</span></span> <span data-ttu-id="b3b78-115">若要變更進程的安全描述項，請呼叫 [**SetSecurityInfo**](/windows/win32/api/aclapi/nf-aclapi-setsecurityinfo) 函數。</span><span class="sxs-lookup"><span data-stu-id="b3b78-115">To change a process's security descriptor, call the [**SetSecurityInfo**](/windows/win32/api/aclapi/nf-aclapi-setsecurityinfo) function.</span></span>

<span data-ttu-id="b3b78-116">處理常式物件的有效存取權限包括 [標準存取權限](../secauthz/standard-access-rights.md) ，以及某些特定進程的存取權限。</span><span class="sxs-lookup"><span data-stu-id="b3b78-116">The valid access rights for process objects include the [standard access rights](../secauthz/standard-access-rights.md) and some process-specific access rights.</span></span> <span data-ttu-id="b3b78-117">下表列出所有物件使用的標準存取權限。</span><span class="sxs-lookup"><span data-stu-id="b3b78-117">The following table lists the standard access rights used by all objects.</span></span>

| <span data-ttu-id="b3b78-118">值</span><span class="sxs-lookup"><span data-stu-id="b3b78-118">Value</span></span>                           | <span data-ttu-id="b3b78-119">意義</span><span class="sxs-lookup"><span data-stu-id="b3b78-119">Meaning</span></span>                                                                                                                                                                                                                                                                                  |
|---------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="b3b78-120">**刪除** (0x00010000L) </span><span class="sxs-lookup"><span data-stu-id="b3b78-120">**DELETE** (0x00010000L)</span></span>        | <span data-ttu-id="b3b78-121">刪除物件的必要參數。</span><span class="sxs-lookup"><span data-stu-id="b3b78-121">Required to delete the object.</span></span>                                                                                                                                                                                                                                                           |
| <span data-ttu-id="b3b78-122">**讀取 \_控制** (0x00020000L) </span><span class="sxs-lookup"><span data-stu-id="b3b78-122">**READ\_CONTROL** (0x00020000L)</span></span> | <span data-ttu-id="b3b78-123">需要讀取物件安全描述項中的資訊，而不包含 SACL 中的資訊。</span><span class="sxs-lookup"><span data-stu-id="b3b78-123">Required to read information in the security descriptor for the object, not including the information in the SACL.</span></span> <span data-ttu-id="b3b78-124">若要讀取或寫入 SACL，您必須要求 **存取 \_ 系統 \_ 安全性** 存取權限。</span><span class="sxs-lookup"><span data-stu-id="b3b78-124">To read or write the SACL, you must request the **ACCESS\_SYSTEM\_SECURITY** access right.</span></span> <span data-ttu-id="b3b78-125">如需詳細資訊，請參閱 [SACL 訪問](../secauthz/sacl-access-right.md)許可權。</span><span class="sxs-lookup"><span data-stu-id="b3b78-125">For more information, see [SACL Access Right](../secauthz/sacl-access-right.md).</span></span> |
| <span data-ttu-id="b3b78-126">**同步處理** (0x00100000L) </span><span class="sxs-lookup"><span data-stu-id="b3b78-126">**SYNCHRONIZE** (0x00100000L)</span></span>   | <span data-ttu-id="b3b78-127">使用同步物件的權限。</span><span class="sxs-lookup"><span data-stu-id="b3b78-127">The right to use the object for synchronization.</span></span> <span data-ttu-id="b3b78-128">這可讓執行緒等候，直到物件處於已發出信號的狀態。</span><span class="sxs-lookup"><span data-stu-id="b3b78-128">This enables a thread to wait until the object is in the signaled state.</span></span>                                                                                                                                                                |
| <span data-ttu-id="b3b78-129">**寫入 \_DAC** (0x00040000L) </span><span class="sxs-lookup"><span data-stu-id="b3b78-129">**WRITE\_DAC** (0x00040000L)</span></span>    | <span data-ttu-id="b3b78-130">修改物件安全描述項中的 DACL 時需要。</span><span class="sxs-lookup"><span data-stu-id="b3b78-130">Required to modify the DACL in the security descriptor for the object.</span></span>                                                                                                                                                                                                                   |
| <span data-ttu-id="b3b78-131">**寫入 \_擁有** 者 (0x00080000L) </span><span class="sxs-lookup"><span data-stu-id="b3b78-131">**WRITE\_OWNER** (0x00080000L)</span></span>  | <span data-ttu-id="b3b78-132">需要變更物件之安全描述項中的擁有者。</span><span class="sxs-lookup"><span data-stu-id="b3b78-132">Required to change the owner in the security descriptor for the object.</span></span>                                                                                                                                                                                                                  |



 

<span data-ttu-id="b3b78-133">下表列出特定進程的存取權限。</span><span class="sxs-lookup"><span data-stu-id="b3b78-133">The following table lists the process-specific access rights.</span></span>



| <span data-ttu-id="b3b78-134">值</span><span class="sxs-lookup"><span data-stu-id="b3b78-134">Value</span></span>                                             | <span data-ttu-id="b3b78-135">意義</span><span class="sxs-lookup"><span data-stu-id="b3b78-135">Meaning</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|---------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="b3b78-136">**處理 \_ 所有 \_ 存取**</span><span class="sxs-lookup"><span data-stu-id="b3b78-136">**PROCESS\_ALL\_ACCESS**</span></span>                          | <span data-ttu-id="b3b78-137">處理常式物件的所有可能存取權限。**Windows Server 2003 和 WINDOWS XP：** Windows Server 2008 和 Windows Vista 上的 **進程 \_ 所有 \_ 存取** 旗標增加的大小。</span><span class="sxs-lookup"><span data-stu-id="b3b78-137">All possible access rights for a process object.**Windows Server 2003 and Windows XP:** The size of the **PROCESS\_ALL\_ACCESS** flag increased on Windows Server 2008 and Windows Vista.</span></span> <span data-ttu-id="b3b78-138">如果針對 Windows Server 2008 和 Windows Vista 編譯的應用程式是在 Windows Server 2003 或 Windows XP 上執行，則「 **處理 \_ 所有 \_ 存取** 」旗標會太大，而指定此旗標的函式會失敗，並出現「 **\_ \_ 拒絕存取」錯誤**。</span><span class="sxs-lookup"><span data-stu-id="b3b78-138">If an application compiled for Windows Server 2008 and Windows Vista is run on Windows Server 2003 or Windows XP, the **PROCESS\_ALL\_ACCESS** flag is too large and the function specifying this flag fails with **ERROR\_ACCESS\_DENIED**.</span></span> <span data-ttu-id="b3b78-139">若要避免這個問題，請指定作業所需的最小存取權限集合。</span><span class="sxs-lookup"><span data-stu-id="b3b78-139">To avoid this problem, specify the minimum set of access rights required for the operation.</span></span> <span data-ttu-id="b3b78-140">如果必須使用 [ **處理 \_ 所有 \_ 存取** ]，請將 \_ WIN32 \_ WINNT 設定為您的應用程式設為目標的最小作業系統 (例如 `#define _WIN32_WINNT _WIN32_WINNT_WINXP`) 。</span><span class="sxs-lookup"><span data-stu-id="b3b78-140">If **PROCESS\_ALL\_ACCESS** must be used, set \_WIN32\_WINNT to the minimum operating system targeted by your application (for example, `#define _WIN32_WINNT _WIN32_WINNT_WINXP`).</span></span> <span data-ttu-id="b3b78-141">如需詳細資訊，請參閱 [使用 Windows 標頭](../winprog/using-the-windows-headers.md)。</span><span class="sxs-lookup"><span data-stu-id="b3b78-141">For more information, see [Using the Windows Headers](../winprog/using-the-windows-headers.md).</span></span> <br/> |
| <span data-ttu-id="b3b78-142">**進程 \_建立 \_ 進程** (0x0080) </span><span class="sxs-lookup"><span data-stu-id="b3b78-142">**PROCESS\_CREATE\_PROCESS** (0x0080)</span></span>             | <span data-ttu-id="b3b78-143">建立處理常式所需。</span><span class="sxs-lookup"><span data-stu-id="b3b78-143">Required to create a process.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| <span data-ttu-id="b3b78-144">**進程 \_建立 \_ 執行緒** (0x0002) </span><span class="sxs-lookup"><span data-stu-id="b3b78-144">**PROCESS\_CREATE\_THREAD** (0x0002)</span></span>              | <span data-ttu-id="b3b78-145">建立執行緒所需。</span><span class="sxs-lookup"><span data-stu-id="b3b78-145">Required to create a thread.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| <span data-ttu-id="b3b78-146">**進程 \_ (\_** 0x0040) 的 DUP 處理</span><span class="sxs-lookup"><span data-stu-id="b3b78-146">**PROCESS\_DUP\_HANDLE** (0x0040)</span></span>                 | <span data-ttu-id="b3b78-147">使用 [**DuplicateHandle**](/windows/win32/api/handleapi/nf-handleapi-duplicatehandle)複製控制碼所需。</span><span class="sxs-lookup"><span data-stu-id="b3b78-147">Required to duplicate a handle using [**DuplicateHandle**](/windows/win32/api/handleapi/nf-handleapi-duplicatehandle).</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| <span data-ttu-id="b3b78-148">**進程 \_ (\_** 0x0400) 的查詢資訊</span><span class="sxs-lookup"><span data-stu-id="b3b78-148">**PROCESS\_QUERY\_INFORMATION** (0x0400)</span></span>          | <span data-ttu-id="b3b78-149">若要取得處理常式的特定資訊（例如其權杖、結束代碼和優先順序類別 (），請參閱 [**OpenProcessToken**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-openprocesstoken)) 。</span><span class="sxs-lookup"><span data-stu-id="b3b78-149">Required to retrieve certain information about a process, such as its token, exit code, and priority class (see [**OpenProcessToken**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-openprocesstoken)).</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| <span data-ttu-id="b3b78-150">**進程 \_查詢 \_ 有限 \_ 資訊** (0x1000) </span><span class="sxs-lookup"><span data-stu-id="b3b78-150">**PROCESS\_QUERY\_LIMITED\_INFORMATION** (0x1000)</span></span> | <span data-ttu-id="b3b78-151">取得處理常式的特定資訊時需要 (參閱 [**>getexitcodeprocess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-getexitcodeprocess)、 [**GetPriorityClass**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-getpriorityclass)、 [**IsProcessInJob**](/windows/win32/api/jobapi/nf-jobapi-isprocessinjob)、 [**QueryFullProcessImageName**](/windows/desktop/api/WinBase/nf-winbase-queryfullprocessimagenamea)) 。</span><span class="sxs-lookup"><span data-stu-id="b3b78-151">Required to retrieve certain information about a process (see [**GetExitCodeProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-getexitcodeprocess), [**GetPriorityClass**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-getpriorityclass), [**IsProcessInJob**](/windows/win32/api/jobapi/nf-jobapi-isprocessinjob), [**QueryFullProcessImageName**](/windows/desktop/api/WinBase/nf-winbase-queryfullprocessimagenamea)).</span></span> <span data-ttu-id="b3b78-152">具有 [ **處理 \_ 查詢 \_ 資訊** ] 許可權的控制碼會自動被授與 **進程 \_ 查詢 \_ 限制 \_ 資訊**。**Windows Server 2003 和 Windows XP：** 不支援此存取權。</span><span class="sxs-lookup"><span data-stu-id="b3b78-152">A handle that has the **PROCESS\_QUERY\_INFORMATION** access right is automatically granted **PROCESS\_QUERY\_LIMITED\_INFORMATION**.**Windows Server 2003 and Windows XP:** This access right is not supported.</span></span><br/>                                                                                                                                                                                                                                                                                                                         |
| <span data-ttu-id="b3b78-153">**進程 \_將 \_ 資訊設定** (0x0200) </span><span class="sxs-lookup"><span data-stu-id="b3b78-153">**PROCESS\_SET\_INFORMATION** (0x0200)</span></span>            | <span data-ttu-id="b3b78-154">若要設定處理常式的特定資訊（例如其優先順序類別 (請參閱 [**SetPriorityClass**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-setpriorityclass)) ）。</span><span class="sxs-lookup"><span data-stu-id="b3b78-154">Required to set certain information about a process, such as its priority class (see [**SetPriorityClass**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-setpriorityclass)).</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| <span data-ttu-id="b3b78-155">**進程 \_設定 \_ 配額** (0x0100) </span><span class="sxs-lookup"><span data-stu-id="b3b78-155">**PROCESS\_SET\_QUOTA** (0x0100)</span></span>                  | <span data-ttu-id="b3b78-156">使用 [**SetProcessWorkingSetSize**](/windows/desktop/api/memoryapi/nf-memoryapi-setprocessworkingsetsize)設定記憶體限制所需。</span><span class="sxs-lookup"><span data-stu-id="b3b78-156">Required to set memory limits using [**SetProcessWorkingSetSize**](/windows/desktop/api/memoryapi/nf-memoryapi-setprocessworkingsetsize).</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| <span data-ttu-id="b3b78-157">**進程 \_暫停 \_ 繼續** (0x0800) </span><span class="sxs-lookup"><span data-stu-id="b3b78-157">**PROCESS\_SUSPEND\_RESUME** (0x0800)</span></span>             | <span data-ttu-id="b3b78-158">暫停或繼續進程的必要。</span><span class="sxs-lookup"><span data-stu-id="b3b78-158">Required to suspend or resume a process.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| <span data-ttu-id="b3b78-159">**進程 \_終止** (0x0001) </span><span class="sxs-lookup"><span data-stu-id="b3b78-159">**PROCESS\_TERMINATE** (0x0001)</span></span>                   | <span data-ttu-id="b3b78-160">使用 [**TerminateProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-terminateprocess)終止進程的必要參數。</span><span class="sxs-lookup"><span data-stu-id="b3b78-160">Required to terminate a process using [**TerminateProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-terminateprocess).</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| <span data-ttu-id="b3b78-161">**進程 \_VM \_ 操作** (0x0008) </span><span class="sxs-lookup"><span data-stu-id="b3b78-161">**PROCESS\_VM\_OPERATION** (0x0008)</span></span>               | <span data-ttu-id="b3b78-162">在處理常式的位址空間上執行作業時需要 (參閱 [**VirtualProtectEx**](/windows/win32/api/memoryapi/nf-memoryapi-virtualprotectex) 和 [**WriteProcessMemory**](/windows/win32/api/memoryapi/nf-memoryapi-writeprocessmemory)) 。</span><span class="sxs-lookup"><span data-stu-id="b3b78-162">Required to perform an operation on the address space of a process (see [**VirtualProtectEx**](/windows/win32/api/memoryapi/nf-memoryapi-virtualprotectex) and [**WriteProcessMemory**](/windows/win32/api/memoryapi/nf-memoryapi-writeprocessmemory)).</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| <span data-ttu-id="b3b78-163">**進程 \_VM \_ READ** (0x0010) </span><span class="sxs-lookup"><span data-stu-id="b3b78-163">**PROCESS\_VM\_READ** (0x0010)</span></span>                    | <span data-ttu-id="b3b78-164">需要使用 [**ReadProcessMemory**](/windows/win32/api/memoryapi/nf-memoryapi-readprocessmemory)讀取進程中的記憶體。</span><span class="sxs-lookup"><span data-stu-id="b3b78-164">Required to read memory in a process using [**ReadProcessMemory**](/windows/win32/api/memoryapi/nf-memoryapi-readprocessmemory).</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| <span data-ttu-id="b3b78-165">**進程 \_VM \_ 寫入** (0x0020) </span><span class="sxs-lookup"><span data-stu-id="b3b78-165">**PROCESS\_VM\_WRITE** (0x0020)</span></span>                   | <span data-ttu-id="b3b78-166">需要使用 [**WriteProcessMemory**](/windows/win32/api/memoryapi/nf-memoryapi-writeprocessmemory)寫入進程中的記憶體。</span><span class="sxs-lookup"><span data-stu-id="b3b78-166">Required to write to memory in a process using [**WriteProcessMemory**](/windows/win32/api/memoryapi/nf-memoryapi-writeprocessmemory).</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| <span data-ttu-id="b3b78-167">**同步處理** (0x00100000L) </span><span class="sxs-lookup"><span data-stu-id="b3b78-167">**SYNCHRONIZE** (0x00100000L)</span></span>                     | <span data-ttu-id="b3b78-168">需要使用 [wait](../sync/wait-functions.md)函式來等候進程終止。</span><span class="sxs-lookup"><span data-stu-id="b3b78-168">Required to wait for the process to terminate using the [wait functions](../sync/wait-functions.md).</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |



 

<span data-ttu-id="b3b78-169">若要開啟另一個進程的控制碼並取得完整存取權限，您必須啟用 **SeDebugPrivilege** 許可權。</span><span class="sxs-lookup"><span data-stu-id="b3b78-169">To open a handle to another process and obtain full access rights, you must enable the **SeDebugPrivilege** privilege.</span></span> <span data-ttu-id="b3b78-170">如需詳細資訊，請參閱 [變更權杖中的許可權](../secbp/changing-privileges-in-a-token.md)。</span><span class="sxs-lookup"><span data-stu-id="b3b78-170">For more information, see [Changing Privileges in a Token](../secbp/changing-privileges-in-a-token.md).</span></span>

<span data-ttu-id="b3b78-171">[**CreateProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-createprocessa)函數所傳回的控制碼具有處理常式物件的 **\_ 所有 \_ 存取** 權。</span><span class="sxs-lookup"><span data-stu-id="b3b78-171">The handle returned by the [**CreateProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-createprocessa) function has **PROCESS\_ALL\_ACCESS** access to the process object.</span></span> <span data-ttu-id="b3b78-172">當您呼叫 [**OpenProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-openprocess) 函式時，系統會針對進程安全描述項中的 DACL 檢查要求的 [存取權限](../secauthz/access-rights-and-access-masks.md) 。</span><span class="sxs-lookup"><span data-stu-id="b3b78-172">When you call the [**OpenProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-openprocess) function, the system checks the requested [access rights](../secauthz/access-rights-and-access-masks.md) against the DACL in the process's security descriptor.</span></span> <span data-ttu-id="b3b78-173">當您呼叫 [**GetCurrentProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-getcurrentprocess) 函式時，系統會傳回具有 DACL 允許呼叫端之最大存取權的 pseudohandle。</span><span class="sxs-lookup"><span data-stu-id="b3b78-173">When you call the [**GetCurrentProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-getcurrentprocess) function, the system returns a pseudohandle with the maximum access that the DACL allows to the caller.</span></span>

<span data-ttu-id="b3b78-174">如果您想要讀取或寫入物件的 SACL，您可以向進程物件要求 **存取 \_ 系統 \_ 安全性** 存取權。</span><span class="sxs-lookup"><span data-stu-id="b3b78-174">You can request the **ACCESS\_SYSTEM\_SECURITY** access right to a process object if you want to read or write the object's SACL.</span></span> <span data-ttu-id="b3b78-175">如需詳細資訊，請參閱 (Acl) 和[SACL 訪問](../secauthz/sacl-access-right.md)許可權[的存取控制清單](../secauthz/access-control-lists.md)。</span><span class="sxs-lookup"><span data-stu-id="b3b78-175">For more information, see [Access-Control Lists (ACLs)](../secauthz/access-control-lists.md) and [SACL Access Right](../secauthz/sacl-access-right.md).</span></span>

> [!WARNING]
> <span data-ttu-id="b3b78-176">具有此處所述之一些存取權限的程式可以使用它們來取得其他存取權限。</span><span class="sxs-lookup"><span data-stu-id="b3b78-176">A process that has some of the access rights noted here can use them to gain other access rights.</span></span> <span data-ttu-id="b3b78-177">例如，如果進程 A 具有處理常式 B 的控制碼，且進程會重複 **\_ \_ 處理** 存取，它可以複製進程 b 的虛擬控制碼。這會建立一個控制碼，該控制碼具有進程 B 的最大存取權。如需虛擬控制碼的詳細資訊，請參閱 [**GetCurrentProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-getcurrentprocess)。</span><span class="sxs-lookup"><span data-stu-id="b3b78-177">For example, if process A has a handle to process B with **PROCESS\_DUP\_HANDLE** access, it can duplicate the pseudo handle for process B. This creates a handle that has maximum access to process B. For more information on pseudo handles, see [**GetCurrentProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-getcurrentprocess).</span></span>

 

## <a name="protected-processes"></a><span data-ttu-id="b3b78-178">受保護的處理程序</span><span class="sxs-lookup"><span data-stu-id="b3b78-178">Protected Processes</span></span>

<span data-ttu-id="b3b78-179">Windows Vista 引進了 *受保護的進程* ，以增強對數位 Rights Management 的支援。</span><span class="sxs-lookup"><span data-stu-id="b3b78-179">Windows Vista introduces *protected processes* to enhance support for Digital Rights Management.</span></span> <span data-ttu-id="b3b78-180">系統會限制受保護進程的存取，以及受保護進程的執行緒。</span><span class="sxs-lookup"><span data-stu-id="b3b78-180">The system restricts access to protected processes and the threads of protected processes.</span></span>

<span data-ttu-id="b3b78-181">下列標準存取權限不允許從進程到受保護的進程：</span><span class="sxs-lookup"><span data-stu-id="b3b78-181">The following standard access rights are not allowed from a process to a protected process:</span></span>

- <span data-ttu-id="b3b78-182">**DELETE**</span><span class="sxs-lookup"><span data-stu-id="b3b78-182">**DELETE**</span></span>  
- <span data-ttu-id="b3b78-183">**讀取 \_ 控制**</span><span class="sxs-lookup"><span data-stu-id="b3b78-183">**READ\_CONTROL**</span></span>  
- <span data-ttu-id="b3b78-184">**寫入 \_ DAC**</span><span class="sxs-lookup"><span data-stu-id="b3b78-184">**WRITE\_DAC**</span></span>  
- <span data-ttu-id="b3b78-185">**寫入 \_ 擁有者**</span><span class="sxs-lookup"><span data-stu-id="b3b78-185">**WRITE\_OWNER**</span></span>  

<span data-ttu-id="b3b78-186">下列特定存取權限不允許從進程到受保護的進程：</span><span class="sxs-lookup"><span data-stu-id="b3b78-186">The following specific access rights are not allowed from a process to a protected process:</span></span>

- <span data-ttu-id="b3b78-187">**處理 \_ 所有 \_ 存取**</span><span class="sxs-lookup"><span data-stu-id="b3b78-187">**PROCESS\_ALL\_ACCESS**</span></span>  
- <span data-ttu-id="b3b78-188">**進程 \_ 建立 \_ 流程**</span><span class="sxs-lookup"><span data-stu-id="b3b78-188">**PROCESS\_CREATE\_PROCESS**</span></span>  
- <span data-ttu-id="b3b78-189">**進程 \_ 建立 \_ 執行緒**</span><span class="sxs-lookup"><span data-stu-id="b3b78-189">**PROCESS\_CREATE\_THREAD**</span></span>  
- <span data-ttu-id="b3b78-190">**進程 \_ DUP \_ 控制碼**</span><span class="sxs-lookup"><span data-stu-id="b3b78-190">**PROCESS\_DUP\_HANDLE**</span></span>  
- <span data-ttu-id="b3b78-191">**處理 \_ 查詢 \_ 資訊**</span><span class="sxs-lookup"><span data-stu-id="b3b78-191">**PROCESS\_QUERY\_INFORMATION**</span></span>  
- <span data-ttu-id="b3b78-192">**進程 \_ 集 \_ 資訊**</span><span class="sxs-lookup"><span data-stu-id="b3b78-192">**PROCESS\_SET\_INFORMATION**</span></span>  
- <span data-ttu-id="b3b78-193">**進程 \_ 集 \_ 配額**</span><span class="sxs-lookup"><span data-stu-id="b3b78-193">**PROCESS\_SET\_QUOTA**</span></span>  
- <span data-ttu-id="b3b78-194">**進程 \_ VM \_ 操作**</span><span class="sxs-lookup"><span data-stu-id="b3b78-194">**PROCESS\_VM\_OPERATION**</span></span>  
- <span data-ttu-id="b3b78-195">**進程 \_ VM \_ 讀取**</span><span class="sxs-lookup"><span data-stu-id="b3b78-195">**PROCESS\_VM\_READ**</span></span>  
- <span data-ttu-id="b3b78-196">**進程 \_ VM \_ 寫入**</span><span class="sxs-lookup"><span data-stu-id="b3b78-196">**PROCESS\_VM\_WRITE**</span></span>  

<span data-ttu-id="b3b78-197">我們引進了「程式 **\_ 查詢 \_ 限制的 \_ 資訊** 」許可權，以提供透過 **流程 \_ 查詢 \_ 資訊** 提供之資訊子集的存取權。</span><span class="sxs-lookup"><span data-stu-id="b3b78-197">The **PROCESS\_QUERY\_LIMITED\_INFORMATION** right was introduced to provide access to a subset of the information available through **PROCESS\_QUERY\_INFORMATION**.</span></span>
