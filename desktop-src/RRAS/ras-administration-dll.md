---
title: 關於 RAS 管理 Dll
description: 每次使用者嘗試連線或中斷連線時，RAS 管理 DLL 都會匯出 RAS 伺服器所呼叫的功能。
ms.assetid: c15c6e2d-3bb6-4583-9ac3-19528feb863f
keywords:
- RAS 系統管理 RRAS、RAS 管理 DLL
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 1cb170e8cfa331ab9591aa509772c6f6a743fa49
ms.sourcegitcommit: cba7f424a292fd7f3a8518947b9466439b455419
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 11/23/2019
ms.locfileid: "104507744"
---
# <a name="about-ras-administration-dlls"></a><span data-ttu-id="bd6a1-104">關於 RAS 管理 Dll</span><span class="sxs-lookup"><span data-stu-id="bd6a1-104">About RAS administration DLLs</span></span>

<span data-ttu-id="bd6a1-105">每次使用者嘗試連線或中斷連線時，RAS 管理 DLL 都會匯出 RAS 伺服器所呼叫的功能。</span><span class="sxs-lookup"><span data-stu-id="bd6a1-105">The RAS Administration DLL exports functions that the RAS server calls whenever a user tries to connect or disconnect.</span></span> <span data-ttu-id="bd6a1-106">以下是 RAS 管理 DLL 的一些可能用途：</span><span class="sxs-lookup"><span data-stu-id="bd6a1-106">Here are some of the possible uses for a RAS administration DLL:</span></span>

-   <span data-ttu-id="bd6a1-107">決定是否允許使用者連接到伺服器。</span><span class="sxs-lookup"><span data-stu-id="bd6a1-107">Decide whether to allow a user to connect to the server.</span></span> <span data-ttu-id="bd6a1-108">除了標準的 RAS 使用者驗證之外，管理 DLL 還可以提供安全性檢查。</span><span class="sxs-lookup"><span data-stu-id="bd6a1-108">The administration DLL can provide a security check in addition to the standard RAS user authentication.</span></span>
-   <span data-ttu-id="bd6a1-109">記錄每個使用者連接的時間，並中斷與伺服器的連線。</span><span class="sxs-lookup"><span data-stu-id="bd6a1-109">Record the time that each user connects to and disconnects from the server.</span></span> <span data-ttu-id="bd6a1-110">這可能適用于計費或審核用途。</span><span class="sxs-lookup"><span data-stu-id="bd6a1-110">This can be useful for billing or auditing purposes.</span></span>
-   <span data-ttu-id="bd6a1-111">將 IP 位址指派給每個使用者。</span><span class="sxs-lookup"><span data-stu-id="bd6a1-111">Assign an IP address to each user.</span></span> <span data-ttu-id="bd6a1-112">這對安全性很有説明，因為這項功能是用來將使用者的連接對應至特定電腦。</span><span class="sxs-lookup"><span data-stu-id="bd6a1-112">This is useful for security, because this feature is used to map a user's connection to a specific computer.</span></span>

<span data-ttu-id="bd6a1-113">RAS 系統管理 DLL 的位置是在登錄中指定;請參閱 [RAS 管理 DLL 登錄設定](ras-administration-dll-registry-setup.md)。</span><span class="sxs-lookup"><span data-stu-id="bd6a1-113">The location of the RAS Administration DLL is specified in the registry; see [RAS Administration DLL Registry Setup](ras-administration-dll-registry-setup.md).</span></span>

<span data-ttu-id="bd6a1-114">RAS 支援多個管理 Dll。</span><span class="sxs-lookup"><span data-stu-id="bd6a1-114">RAS supports multiple Administration DLLs.</span></span> <span data-ttu-id="bd6a1-115">登錄支援多個 DLL 位置。</span><span class="sxs-lookup"><span data-stu-id="bd6a1-115">The registry supports multiple DLL locations.</span></span> <span data-ttu-id="bd6a1-116">RAS 會以 Dll 在登錄中列出的順序來呼叫 Dll 中的函式，請參閱 [RAS 管理 DLL 登錄設定](ras-administration-dll-registry-setup.md)。</span><span class="sxs-lookup"><span data-stu-id="bd6a1-116">RAS calls the functions in the DLLs in the order in which the DLLs are listed in the registry; see [RAS Administration DLL Registry Setup](ras-administration-dll-registry-setup.md).</span></span>

<span data-ttu-id="bd6a1-117">**Windows 2000 伺服器：** RAS 不支援多個 Dll。</span><span class="sxs-lookup"><span data-stu-id="bd6a1-117">**Windows 2000 Server:** RAS does not support multiple DLLs.</span></span>

<span data-ttu-id="bd6a1-118">RAS 系統管理 DLL 必須執行並匯出下列所有功能：</span><span class="sxs-lookup"><span data-stu-id="bd6a1-118">A RAS administration DLL must implement and export all of the following functions:</span></span>

[<span data-ttu-id="bd6a1-119">**MprAdminAcceptNewLink**</span><span class="sxs-lookup"><span data-stu-id="bd6a1-119">**MprAdminAcceptNewLink**</span></span>](/windows/desktop/api/Mprapi/nf-mprapi-mpradminacceptnewlink)

[<span data-ttu-id="bd6a1-120">**MprAdminInitializeDll**</span><span class="sxs-lookup"><span data-stu-id="bd6a1-120">**MprAdminInitializeDll**</span></span>](/windows/desktop/api/Mprapi/nf-mprapi-mpradmininitializedll)

[<span data-ttu-id="bd6a1-121">**MprAdminLinkHangupNotification**</span><span class="sxs-lookup"><span data-stu-id="bd6a1-121">**MprAdminLinkHangupNotification**</span></span>](/windows/desktop/api/Mprapi/nf-mprapi-mpradminlinkhangupnotification)

[<span data-ttu-id="bd6a1-122">**MprAdminTerminateDll**</span><span class="sxs-lookup"><span data-stu-id="bd6a1-122">**MprAdminTerminateDll**</span></span>](/windows/desktop/api/Mprapi/nf-mprapi-mpradminterminatedll)

<span data-ttu-id="bd6a1-123">此外，RAS 管理 DLL 也必須執行和匯出</span><span class="sxs-lookup"><span data-stu-id="bd6a1-123">In addition, the RAS administration DLL must implement and export either</span></span>

<span data-ttu-id="bd6a1-124">[**MprAdminAcceptNewConnection**](/windows/desktop/api/Mprapi/nf-mprapi-mpradminacceptnewconnection) 和</span><span class="sxs-lookup"><span data-stu-id="bd6a1-124">[**MprAdminAcceptNewConnection**](/windows/desktop/api/Mprapi/nf-mprapi-mpradminacceptnewconnection) and</span></span>

[<span data-ttu-id="bd6a1-125">**MprAdminConnectionHangupNotification**</span><span class="sxs-lookup"><span data-stu-id="bd6a1-125">**MprAdminConnectionHangupNotification**</span></span>](/windows/desktop/api/Mprapi/nf-mprapi-mpradminconnectionhangupnotification)

<span data-ttu-id="bd6a1-126">或</span><span class="sxs-lookup"><span data-stu-id="bd6a1-126">or</span></span>

<span data-ttu-id="bd6a1-127">[**MprAdminAcceptNewConnection2**](/windows/desktop/api/Mprapi/nf-mprapi-mpradminacceptnewconnection2) 和</span><span class="sxs-lookup"><span data-stu-id="bd6a1-127">[**MprAdminAcceptNewConnection2**](/windows/desktop/api/Mprapi/nf-mprapi-mpradminacceptnewconnection2) and</span></span>

[<span data-ttu-id="bd6a1-128">**MprAdminConnectionHangupNotification2**</span><span class="sxs-lookup"><span data-stu-id="bd6a1-128">**MprAdminConnectionHangupNotification2**</span></span>](/windows/desktop/api/Mprapi/nf-mprapi-mpradminconnectionhangupnotification2)

<span data-ttu-id="bd6a1-129">如果未執行所有必要的函式，則無法啟動 RAS。</span><span class="sxs-lookup"><span data-stu-id="bd6a1-129">If all of the required functions are not implemented, RAS fails to start.</span></span>

<span data-ttu-id="bd6a1-130">**Windows 2000 伺服器：** 管理 DLL 必須執行 [**MprAdminGetIpAddressForUser**](/windows/desktop/api/Mprapi/nf-mprapi-mpradmingetipaddressforuser) 和 [**MprAdminReleaseIpAddress**](/windows/desktop/api/Mprapi/nf-mprapi-mpradminreleaseipaddress) 函數。</span><span class="sxs-lookup"><span data-stu-id="bd6a1-130">**Windows 2000 Server:** An administration DLL must implement the [**MprAdminGetIpAddressForUser**](/windows/desktop/api/Mprapi/nf-mprapi-mpradmingetipaddressforuser) and [**MprAdminReleaseIpAddress**](/windows/desktop/api/Mprapi/nf-mprapi-mpradminreleaseipaddress) functions.</span></span> <span data-ttu-id="bd6a1-131">如果 DLL 實作為這些函式的其中之一，它也必須執行另一個函數。</span><span class="sxs-lookup"><span data-stu-id="bd6a1-131">If the DLL implements one of these functions it must implement the other as well.</span></span>

<span data-ttu-id="bd6a1-132">「路由及遠端存取」服務第一次啟動時，RAS 會呼叫 [**MprAdminInitializeDll**](/windows/desktop/api/Mprapi/nf-mprapi-mpradmininitializedll) 函數。</span><span class="sxs-lookup"><span data-stu-id="bd6a1-132">RAS calls the [**MprAdminInitializeDll**](/windows/desktop/api/Mprapi/nf-mprapi-mpradmininitializedll) function when the Routing and Remote Access Service first starts up.</span></span> <span data-ttu-id="bd6a1-133">**MprAdminInitializeDll** 函式提供管理 DLL 執行任何必要初始化的機會。</span><span class="sxs-lookup"><span data-stu-id="bd6a1-133">The **MprAdminInitializeDll** function provides an opportunity for the administration DLL to do any necessary initialization.</span></span> <span data-ttu-id="bd6a1-134">同樣地，當「路由及遠端存取」服務關閉時，RAS 會呼叫 [**MprAdminTerminateDll**](/windows/desktop/api/Mprapi/nf-mprapi-mpradminterminatedll) 服務。</span><span class="sxs-lookup"><span data-stu-id="bd6a1-134">Similarly, RAS calls the [**MprAdminTerminateDll**](/windows/desktop/api/Mprapi/nf-mprapi-mpradminterminatedll) service when the Routing and Remote Access Service shuts down.</span></span> <span data-ttu-id="bd6a1-135">此函數可讓系統管理 DLL 在結束之前執行任何必要的清除。</span><span class="sxs-lookup"><span data-stu-id="bd6a1-135">This function allows the administration DLL to perform any necessary cleanup before exiting.</span></span>

<span data-ttu-id="bd6a1-136">[**MprAdminAcceptNewConnection**](/windows/desktop/api/Mprapi/nf-mprapi-mpradminacceptnewconnection)和 [**MprAdminConnectionHangupNotification**](/windows/desktop/api/Mprapi/nf-mprapi-mpradminconnectionhangupnotification)函式可讓 DLL 審核伺服器的使用者連接。</span><span class="sxs-lookup"><span data-stu-id="bd6a1-136">The [**MprAdminAcceptNewConnection**](/windows/desktop/api/Mprapi/nf-mprapi-mpradminacceptnewconnection) and [**MprAdminConnectionHangupNotification**](/windows/desktop/api/Mprapi/nf-mprapi-mpradminconnectionhangupnotification) functions enable the DLL to audit user connections to the server.</span></span> <span data-ttu-id="bd6a1-137">當使用者嘗試連接時，RAS 伺服器會呼叫 **MprAdminAcceptNewConnection** 函式。</span><span class="sxs-lookup"><span data-stu-id="bd6a1-137">A RAS server calls the **MprAdminAcceptNewConnection** function whenever a user tries to connect.</span></span> <span data-ttu-id="bd6a1-138">此函式可讓使用者無法連接。</span><span class="sxs-lookup"><span data-stu-id="bd6a1-138">This function makes it possible to prevent the user from connecting.</span></span> <span data-ttu-id="bd6a1-139">**MprAdminAcceptNewConnection** 函式也可以產生帳單或審核的記錄專案。</span><span class="sxs-lookup"><span data-stu-id="bd6a1-139">The **MprAdminAcceptNewConnection** function could also generate log entries for billing or auditing.</span></span> <span data-ttu-id="bd6a1-140">當使用者中斷連線時，RAS 伺服器會呼叫 **MprAdminConnectionHangupNotification** 函式，以記錄使用者中斷連線的時間。</span><span class="sxs-lookup"><span data-stu-id="bd6a1-140">When the user disconnects, the RAS server calls the **MprAdminConnectionHangupNotification** function, which can log the time at which the user disconnected.</span></span>

<span data-ttu-id="bd6a1-141">[**MprAdminAcceptNewConnection2**](/windows/desktop/api/Mprapi/nf-mprapi-mpradminacceptnewconnection2)和 [**MprAdminConnectionHangupNotification2**](/windows/desktop/api/Mprapi/nf-mprapi-mpradminconnectionhangupnotification2)函數類似于 **MprAdminAcceptNewConnection** 和 [**MprAdminConnectionHangupNotification**](/windows/desktop/api/Mprapi/nf-mprapi-mpradminconnectionhangupnotification)。</span><span class="sxs-lookup"><span data-stu-id="bd6a1-141">The [**MprAdminAcceptNewConnection2**](/windows/desktop/api/Mprapi/nf-mprapi-mpradminacceptnewconnection2) and [**MprAdminConnectionHangupNotification2**](/windows/desktop/api/Mprapi/nf-mprapi-mpradminconnectionhangupnotification2) functions are similar to **MprAdminAcceptNewConnection** and [**MprAdminConnectionHangupNotification**](/windows/desktop/api/Mprapi/nf-mprapi-mpradminconnectionhangupnotification).</span></span> <span data-ttu-id="bd6a1-142">不過，當 RAS 呼叫 **MprAdminAcceptNewConnection2** 和 **MprAdminConnectionHangupNotification2** 函式時，ras 會傳入 [**ras \_ CONNECTION \_ 2**](/windows/desktop/api/Mprapi/ns-mprapi-ras_connection_2)類型的其他參數。</span><span class="sxs-lookup"><span data-stu-id="bd6a1-142">However, when RAS calls the **MprAdminAcceptNewConnection2** and **MprAdminConnectionHangupNotification2** functions, RAS passes in an additional parameter of type [**RAS\_CONNECTION\_2**](/windows/desktop/api/Mprapi/ns-mprapi-ras_connection_2).</span></span>

<span data-ttu-id="bd6a1-143">RAS 支援多個管理 Dll。</span><span class="sxs-lookup"><span data-stu-id="bd6a1-143">RAS supports multiple Administration DLLs.</span></span> <span data-ttu-id="bd6a1-144">只有在每個 Dll 中的 [**MprAdminAcceptNewConnection**](/windows/desktop/api/Mprapi/nf-mprapi-mpradminacceptnewconnection) 或 [**MprAdminAcceptNewConnection2**](/windows/desktop/api/Mprapi/nf-mprapi-mpradminacceptnewconnection2) 函數執行都接受連接時，才允許遠端存取使用者進行連線。</span><span class="sxs-lookup"><span data-stu-id="bd6a1-144">The remote-access user is allowed to connect only if the implementation of the [**MprAdminAcceptNewConnection**](/windows/desktop/api/Mprapi/nf-mprapi-mpradminacceptnewconnection) or [**MprAdminAcceptNewConnection2**](/windows/desktop/api/Mprapi/nf-mprapi-mpradminacceptnewconnection2) function in each of the DLLs accepts the connection.</span></span> <span data-ttu-id="bd6a1-145">換句話說，每個 DLL 都必須接受連接，使用者才能連接。</span><span class="sxs-lookup"><span data-stu-id="bd6a1-145">In other words, every DLL must accept the connection in order for the user to be allowed to connect.</span></span>

<span data-ttu-id="bd6a1-146">當單一 RAS 連線連接到 RAS 伺服器時，可能會使用多個連結。</span><span class="sxs-lookup"><span data-stu-id="bd6a1-146">It is possible for a single RAS connection to use multiple links when connecting to a RAS server.</span></span> <span data-ttu-id="bd6a1-147">[**MprAdminAcceptNewLink**](/windows/desktop/api/Mprapi/nf-mprapi-mpradminacceptnewlink)和 [**MprAdminLinkHangupNotification**](/windows/desktop/api/Mprapi/nf-mprapi-mpradminlinkhangupnotification)函式可讓管理 DLL 管理連接中的個別連結。</span><span class="sxs-lookup"><span data-stu-id="bd6a1-147">The [**MprAdminAcceptNewLink**](/windows/desktop/api/Mprapi/nf-mprapi-mpradminacceptnewlink) and [**MprAdminLinkHangupNotification**](/windows/desktop/api/Mprapi/nf-mprapi-mpradminlinkhangupnotification) functions make it possible for the Administration DLL to manage individual links in a connection.</span></span> <span data-ttu-id="bd6a1-148">每當建立連線的新連結時，RAS 就會呼叫 **MprAdminAcceptNewLink** 。</span><span class="sxs-lookup"><span data-stu-id="bd6a1-148">RAS calls **MprAdminAcceptNewLink** whenever a new link is established for a connection.</span></span> <span data-ttu-id="bd6a1-149">因為所有連接都至少需要一個連結，所以在 [**MprAdminAcceptNewConnection**](/windows/desktop/api/Mprapi/nf-mprapi-mpradminacceptnewconnection)或 [**MprAdminAcceptNewConnection2**](/windows/desktop/api/Mprapi/nf-mprapi-mpradminacceptnewconnection2)傳回之後，RAS 一律會立即呼叫 **MprAdminAcceptNewLink** 一次，前提是 [**MprAdminAcceptNewConnection**](/windows/desktop/api/Mprapi/nf-mprapi-mpradminacceptnewconnection)或 [**MprAdminAcceptNewConnection2**](/windows/desktop/api/Mprapi/nf-mprapi-mpradminacceptnewconnection2)已接受連線。</span><span class="sxs-lookup"><span data-stu-id="bd6a1-149">Because all connections involve at least one link, RAS always calls **MprAdminAcceptNewLink** once immediately after [**MprAdminAcceptNewConnection**](/windows/desktop/api/Mprapi/nf-mprapi-mpradminacceptnewconnection) or [**MprAdminAcceptNewConnection2**](/windows/desktop/api/Mprapi/nf-mprapi-mpradminacceptnewconnection2) returns, provided that [**MprAdminAcceptNewConnection**](/windows/desktop/api/Mprapi/nf-mprapi-mpradminacceptnewconnection) or [**MprAdminAcceptNewConnection2**](/windows/desktop/api/Mprapi/nf-mprapi-mpradminacceptnewconnection2) accepted the connection.</span></span> <span data-ttu-id="bd6a1-150">只要關閉連接的連結，RAS 就會呼叫 **MprAdminLinkHangupNotification** 。</span><span class="sxs-lookup"><span data-stu-id="bd6a1-150">RAS calls **MprAdminLinkHangupNotification** whenever a link for a connection is shutdown.</span></span>

<span data-ttu-id="bd6a1-151">由於 RAS 支援多個系統管理 Dll，因此只有在每個 Dll 中的 [**MprAdminAcceptNewLink**](/windows/desktop/api/Mprapi/nf-mprapi-mpradminacceptnewlink) 函式都接受連接時，才允許遠端存取使用者進行連線。</span><span class="sxs-lookup"><span data-stu-id="bd6a1-151">Because RAS supports multiple Administration DLLs, the remote-access user is allowed to connect only if the implementation of the [**MprAdminAcceptNewLink**](/windows/desktop/api/Mprapi/nf-mprapi-mpradminacceptnewlink) function in each of the DLLs accepts the connection.</span></span> <span data-ttu-id="bd6a1-152">換句話說，每個 DLL 都必須接受連結，才能建立連結。</span><span class="sxs-lookup"><span data-stu-id="bd6a1-152">In other words, every DLL must accept the link in order for the link to be established.</span></span>

<span data-ttu-id="bd6a1-153">在 RAS 伺服器驗證使用者之後，它會呼叫 [**MprAdminGetIpAddressForUser**](/windows/desktop/api/Mprapi/nf-mprapi-mpradmingetipaddressforuser) 函數來取得遠端用戶端的 IP 位址。</span><span class="sxs-lookup"><span data-stu-id="bd6a1-153">After the RAS server has authenticated a user, it calls the [**MprAdminGetIpAddressForUser**](/windows/desktop/api/Mprapi/nf-mprapi-mpradmingetipaddressforuser) function to get an IP address for the remote client.</span></span> <span data-ttu-id="bd6a1-154">此函數提供將 IP 位址對應至撥入使用者的替代配置。</span><span class="sxs-lookup"><span data-stu-id="bd6a1-154">This function provides an alternate scheme for mapping an IP address to a dial-in user.</span></span> <span data-ttu-id="bd6a1-155">如果未執行 **MprAdminGetIpAddressForUser** ，RAS 伺服器會將遠端使用者與從 ip 位址的靜態集區中選取的 ip 位址建立關聯，或由動態主機設定通訊協定 (DHCP) 伺服器所選取的 ip 位址建立關聯。</span><span class="sxs-lookup"><span data-stu-id="bd6a1-155">If **MprAdminGetIpAddressForUser** is not implemented, a RAS server associates the remote user with an IP address that is selected from a static pool of IP addresses, or one selected by a Dynamic Host Configuration Protocol (DHCP) server.</span></span> <span data-ttu-id="bd6a1-156">**MprAdminGetIpAddressForUser** 函式可讓 DLL 覆寫此預設 ip 位址，並為每個使用者指定特定的 ip 位址。</span><span class="sxs-lookup"><span data-stu-id="bd6a1-156">The **MprAdminGetIpAddressForUser** function allows the DLL to override this default IP address and specify a particular IP address for each user.</span></span> <span data-ttu-id="bd6a1-157">**MprAdminGetIpAddressForUser** 函式可以設定旗標，讓 RAS 在使用者中斷連線時呼叫 [**MprAdminReleaseIpAddress**](/windows/desktop/api/Mprapi/nf-mprapi-mpradminreleaseipaddress)功能。</span><span class="sxs-lookup"><span data-stu-id="bd6a1-157">The **MprAdminGetIpAddressForUser** function can set a flag that causes RAS to call the [**MprAdminReleaseIpAddress**](/windows/desktop/api/Mprapi/nf-mprapi-mpradminreleaseipaddress) function when the user disconnects.</span></span> <span data-ttu-id="bd6a1-158">然後，DLL 可以使用 **MprAdminReleaseIpAddress** 來更新其使用者與 IP 位址的對應。</span><span class="sxs-lookup"><span data-stu-id="bd6a1-158">The DLL can then use **MprAdminReleaseIpAddress** to update its user-to-IP-address mapping.</span></span>

<span data-ttu-id="bd6a1-159">RAS 支援多個系統管理 Dll，但它只會在第一個執行和匯出的 DLL 中呼叫 [**MprAdminGetIpAddressForUser**](/windows/desktop/api/Mprapi/nf-mprapi-mpradmingetipaddressforuser) 和 [**MprAdminReleaseIpAddress**](/windows/desktop/api/Mprapi/nf-mprapi-mpradminreleaseipaddress) 函式。</span><span class="sxs-lookup"><span data-stu-id="bd6a1-159">RAS supports multiple Administration DLLs, but it calls the [**MprAdminGetIpAddressForUser**](/windows/desktop/api/Mprapi/nf-mprapi-mpradmingetipaddressforuser) and [**MprAdminReleaseIpAddress**](/windows/desktop/api/Mprapi/nf-mprapi-mpradminreleaseipaddress) functions only in the first DLL that implements and export them.</span></span> <span data-ttu-id="bd6a1-160">RAS 會忽略其他 Dll 中這些函式的實作為。</span><span class="sxs-lookup"><span data-stu-id="bd6a1-160">RAS ignores implementations of these functions in the other DLLs.</span></span> <span data-ttu-id="bd6a1-161">RAS 會依照這些函式在登錄中列出的順序來檢查這些函式的[dll。](ras-administration-dll-registry-setup.md)</span><span class="sxs-lookup"><span data-stu-id="bd6a1-161">RAS checks the DLLs for these functions in the order in which they are listed in the [registry](ras-administration-dll-registry-setup.md).</span></span>

<span data-ttu-id="bd6a1-162">RAS 會將呼叫序列化至管理 DLL。</span><span class="sxs-lookup"><span data-stu-id="bd6a1-162">RAS serializes calls into the administration DLL.</span></span> <span data-ttu-id="bd6a1-163">針對指定的 RAS 用戶端呼叫其中一個 DLL 的函式，並不會針對不同的 RAS 用戶端優先呼叫該函式;RAS 在初始呼叫完成之前，不會呼叫其他用戶端的函式。</span><span class="sxs-lookup"><span data-stu-id="bd6a1-163">A call into one of the DLL's functions for a given RAS client does not preempt a call to that function for a different RAS client; RAS does not call the function for the other client until the initial call is complete.</span></span> <span data-ttu-id="bd6a1-164">此外，序列化會延伸至特定的函數群組。</span><span class="sxs-lookup"><span data-stu-id="bd6a1-164">Furthermore, serialization extends to certain groups of functions.</span></span> <span data-ttu-id="bd6a1-165">IP 位址函數會序列化為群組;對 [**MprAdminGetIpAddressForUser**](/windows/desktop/api/Mprapi/nf-mprapi-mpradmingetipaddressforuser) 或 [**MprAdminReleaseIpAddress**](/windows/desktop/api/Mprapi/nf-mprapi-mpradminreleaseipaddress) 的呼叫會封鎖對兩個函式的呼叫，直到初始呼叫傳回為止。</span><span class="sxs-lookup"><span data-stu-id="bd6a1-165">The IP address functions are serialized as a group; a call into either [**MprAdminGetIpAddressForUser**](/windows/desktop/api/Mprapi/nf-mprapi-mpradmingetipaddressforuser) or [**MprAdminReleaseIpAddress**](/windows/desktop/api/Mprapi/nf-mprapi-mpradminreleaseipaddress) blocks calls into both functions until the initial call has returned.</span></span> <span data-ttu-id="bd6a1-166">[**MprAdminAcceptNewConnection**](/windows/desktop/api/Mprapi/nf-mprapi-mpradminacceptnewconnection) 和 [**MprAdminConnectionHangupNotification**](/windows/desktop/api/Mprapi/nf-mprapi-mpradminconnectionhangupnotification) 也會序列化為群組。</span><span class="sxs-lookup"><span data-stu-id="bd6a1-166">[**MprAdminAcceptNewConnection**](/windows/desktop/api/Mprapi/nf-mprapi-mpradminacceptnewconnection) and [**MprAdminConnectionHangupNotification**](/windows/desktop/api/Mprapi/nf-mprapi-mpradminconnectionhangupnotification) are also serialized as a group.</span></span>

<span data-ttu-id="bd6a1-167">RAS 會在一個進程中執行指派 IP 位址的函式;連接和中斷連接通知的功能是在另一個進程中執行。</span><span class="sxs-lookup"><span data-stu-id="bd6a1-167">RAS executes the functions that assign IP addresses in one process; the functions for connection and disconnection notifications are executed in another process.</span></span> <span data-ttu-id="bd6a1-168">因此，DLL 不會相依于這兩組函數之間的共用資料。</span><span class="sxs-lookup"><span data-stu-id="bd6a1-168">Consequently, the DLL does not depend on shared data between these two sets of functions.</span></span>

<span data-ttu-id="bd6a1-169">請勿從 callout 函式內呼叫任何 [Ras 管理功能](ras-administration-functions.md) 或 [Ras 使用者管理功能](ras-user-administration-functions.md) 。</span><span class="sxs-lookup"><span data-stu-id="bd6a1-169">Do not call any of the [RAS Administration Functions](ras-administration-functions.md) or [RAS User Administration Functions](ras-user-administration-functions.md) from inside a callout function.</span></span> <span data-ttu-id="bd6a1-170">從標注函式內進行呼叫時，不會傳回這些函數的呼叫。</span><span class="sxs-lookup"><span data-stu-id="bd6a1-170">Calls to these functions will not return when made from within a callout function.</span></span>

<span data-ttu-id="bd6a1-171">如果嘗試載入 RAS 管理 DLL 或呼叫其中一個 DLL 的函式時，RAS 伺服器會在系統事件記錄檔中記錄錯誤。</span><span class="sxs-lookup"><span data-stu-id="bd6a1-171">The RAS server logs an error in the system event log if an error occurs when it tries to load a RAS administration DLL or when calling one of the DLL's functions.</span></span> <span data-ttu-id="bd6a1-172">例如，如果 DLL 為匯出的函式指定了錯誤的名稱，或如果未在 DEF 檔案中包含函式名稱，就會發生這種情況。</span><span class="sxs-lookup"><span data-stu-id="bd6a1-172">This can happen, for example, if the DLL specified the wrong name for an exported function, or if it did not include the function name in the DEF file.</span></span> <span data-ttu-id="bd6a1-173">事件記錄檔中的專案會指出失敗的原因。</span><span class="sxs-lookup"><span data-stu-id="bd6a1-173">The entry in the event log indicates the reason for the failure.</span></span>

<span data-ttu-id="bd6a1-174">**Windows 2000/NT：** 不支援多個系統管理 Dll。</span><span class="sxs-lookup"><span data-stu-id="bd6a1-174">**Windows 2000/NT:** Multiple administration DLLs are not supported.</span></span>

 

 




