---
title: 瞭解路由器管理功能
description: 下列各節將討論不同類型的路由器管理功能，以及有效使用這些功能的須知。
ms.assetid: 2f6831f2-39be-43b1-80bd-9a36c0f8a2af
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: be4b1891bc55b80a18a6d0dd928044da1e0e9709
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/20/2020
ms.locfileid: "106969924"
---
# <a name="understanding-router-management-functions"></a><span data-ttu-id="5a731-103">瞭解路由器管理功能</span><span class="sxs-lookup"><span data-stu-id="5a731-103">Understanding Router Management Functions</span></span>

<span data-ttu-id="5a731-104">下列各節將討論不同類型的路由器管理功能，以及有效使用這些功能的須知。</span><span class="sxs-lookup"><span data-stu-id="5a731-104">The following sections discuss the different types of router management functions and what you should know to use them effectively.</span></span>

<span data-ttu-id="5a731-105">所有的路由器管理功能都需要系統管理員許可權。</span><span class="sxs-lookup"><span data-stu-id="5a731-105">All router management functions require administrator privileges.</span></span> <span data-ttu-id="5a731-106">Power User 群組中的使用者沒有足夠的許可權可以使用路由器管理功能。</span><span class="sxs-lookup"><span data-stu-id="5a731-106">A user in the Power User group does not have sufficient privileges to use the router management functions.</span></span>

## <a name="the-different-classes-of-router-management-functions"></a><span data-ttu-id="5a731-107">不同類別的路由器管理功能</span><span class="sxs-lookup"><span data-stu-id="5a731-107">The Different Classes of Router Management Functions</span></span>

<span data-ttu-id="5a731-108">路由器管理功能可以分為管理功能和設定功能。</span><span class="sxs-lookup"><span data-stu-id="5a731-108">The router management functions can be divided up into the administration functions and the configuration functions.</span></span> <span data-ttu-id="5a731-109">[管理](router-administration-functions.md)函式的前置詞為 MprAdmin，而設定[函數](router-configuration-functions.md)的前置詞為 MprConfig。</span><span class="sxs-lookup"><span data-stu-id="5a731-109">The [administration functions](router-administration-functions.md) have a prefix of MprAdmin and the [configuration functions](router-configuration-functions.md) have a prefix of MprConfig.</span></span> <span data-ttu-id="5a731-110">儘管有命名，也會使用這兩組函數來進行路由器管理。</span><span class="sxs-lookup"><span data-stu-id="5a731-110">Despite the naming, both sets of functions are used for router management.</span></span> <span data-ttu-id="5a731-111">MprAdmin 函式會直接在執行中的路由器上運作。</span><span class="sxs-lookup"><span data-stu-id="5a731-111">The MprAdmin functions operate directly on the running router.</span></span> <span data-ttu-id="5a731-112">MprConfig 函式具有類似的功能，但會在登錄中儲存的路由器設定上運作。</span><span class="sxs-lookup"><span data-stu-id="5a731-112">The MprConfig functions have similar functionality, but operate on the router configuration stored in the registry.</span></span> <span data-ttu-id="5a731-113">這兩種類型的函數都會傳遞 [資訊區塊](router-information-functions.md)。</span><span class="sxs-lookup"><span data-stu-id="5a731-113">Both types of functions pass [information blocks](router-information-functions.md).</span></span>

<span data-ttu-id="5a731-114">路由器管理函式也可以根據其所管理的路由器元件來分割：介面、路由器管理員或路由器管理員用戶端。</span><span class="sxs-lookup"><span data-stu-id="5a731-114">The router management functions can also be divided up based on what components of the router they manage: interfaces, router managers, or router manager clients.</span></span>

<span data-ttu-id="5a731-115">[路由器介面](router-interface-functions.md)函式的前置詞是 MprAdminInterface 或 MprConfigInterface。</span><span class="sxs-lookup"><span data-stu-id="5a731-115">The [router interface functions](router-interface-functions.md) have a prefix of either MprAdminInterface or MprConfigInterface.</span></span> <span data-ttu-id="5a731-116">使用這些函數來存取介面。</span><span class="sxs-lookup"><span data-stu-id="5a731-116">Use these functions to access interfaces.</span></span> <span data-ttu-id="5a731-117">[路由器管理員](router-manager-transport-functions.md)函式的前置詞為 MprAdminTransport 或 MprConfigTransport。</span><span class="sxs-lookup"><span data-stu-id="5a731-117">The [router manager functions](router-manager-transport-functions.md) have a prefix of MprAdminTransport or MprConfigTransport.</span></span> <span data-ttu-id="5a731-118">使用這些功能來存取路由器管理員。</span><span class="sxs-lookup"><span data-stu-id="5a731-118">Use these functions to access the router managers.</span></span> <span data-ttu-id="5a731-119">最後， [路由器管理員用戶端](router-manager-client-interfacetransport-functions.md) 函式的前置詞為 MprAdminInterfaceTransport 或 MprConfigInterfaceTransport。</span><span class="sxs-lookup"><span data-stu-id="5a731-119">Lastly, the [router manager client functions](router-manager-client-interfacetransport-functions.md) have a prefix of MprAdminInterfaceTransport or MprConfigInterfaceTransport.</span></span> <span data-ttu-id="5a731-120">使用這些功能來存取在路由器上執行的用戶端。</span><span class="sxs-lookup"><span data-stu-id="5a731-120">Use these functions to access the clients running on the router.</span></span>

<span data-ttu-id="5a731-121">MprAdmin 函式的子集是 [MprAdminMib 函數](/windows/desktop/RRAS/about-router-management-with-mib)。</span><span class="sxs-lookup"><span data-stu-id="5a731-121">A subset of MprAdmin functions are the [MprAdminMib functions](/windows/desktop/RRAS/about-router-management-with-mib).</span></span> <span data-ttu-id="5a731-122">這些也會單獨操作執行中的路由。</span><span class="sxs-lookup"><span data-stu-id="5a731-122">These also operate on the running route alone.</span></span> <span data-ttu-id="5a731-123">不過，這些函式不會傳遞資訊區塊。</span><span class="sxs-lookup"><span data-stu-id="5a731-123">However, these functions do not pass information blocks.</span></span> <span data-ttu-id="5a731-124">這些函式會為通訊協定設計工具提供額外的彈性，特別是用來抓取非設定資訊，例如統計資料。</span><span class="sxs-lookup"><span data-stu-id="5a731-124">These functions provide additional flexibility to the protocol designer, especially for retrieving non-configuration information, such as statistics.</span></span>

## <a name="ensuring-that-changes-occur-immediately-and-are-persistent"></a><span data-ttu-id="5a731-125">確保變更會立即發生且持續存在</span><span class="sxs-lookup"><span data-stu-id="5a731-125">Ensuring that Changes Occur Immediately and are Persistent</span></span>

<span data-ttu-id="5a731-126">開發人員可以使用 [路由器設定功能](router-configuration-functions.md)直接變更路由器設定。</span><span class="sxs-lookup"><span data-stu-id="5a731-126">A developer can make changes to the router configuration directly using the [router configuration functions](router-configuration-functions.md).</span></span> <span data-ttu-id="5a731-127">不過，在重新開機路由器之前，對設定所做的任何變更都不會生效，因為這是維度從登錄讀取設定的唯一時間。</span><span class="sxs-lookup"><span data-stu-id="5a731-127">However, any changes made to the configuration do not take effect until the router is restarted, since this is the only time that DIM reads the configuration from the registry.</span></span>

<span data-ttu-id="5a731-128">開發人員可以使用 [路由器管理功能](router-administration-functions.md)來變更正在執行的路由器。</span><span class="sxs-lookup"><span data-stu-id="5a731-128">A developer can make changes to the running router by using the [router administration functions](router-administration-functions.md).</span></span> <span data-ttu-id="5a731-129">不過，這些變更不是持續性的：因為它們尚未寫入登錄中，所以如果重新開機路由器，就會遺失這些變更。</span><span class="sxs-lookup"><span data-stu-id="5a731-129">However, these changes are not persistent: since they have not been written to the registry, they are lost if the router is restarted.</span></span>

<span data-ttu-id="5a731-130">為了進行立即和持續性的變更，開發人員必須同時使用路由器管理與路由器設定功能。</span><span class="sxs-lookup"><span data-stu-id="5a731-130">In order to make changes that are both immediate and persistent, a developer needs to use both the router administration and the router configuration functions.</span></span> <span data-ttu-id="5a731-131">如果路由器未執行，開發人員只需要呼叫適當的路由器設定功能。</span><span class="sxs-lookup"><span data-stu-id="5a731-131">If the router is not running, the developer need only call the appropriate router configuration functions.</span></span>

<span data-ttu-id="5a731-132">若要從執行中的路由器查詢資訊，請使用路由器管理功能。</span><span class="sxs-lookup"><span data-stu-id="5a731-132">For querying information from the running router, use the router administration functions.</span></span> <span data-ttu-id="5a731-133">如果路由器未執行，請使用路由器設定函數來查詢資訊。</span><span class="sxs-lookup"><span data-stu-id="5a731-133">If the router is not running, query information using the router configuration functions.</span></span>

<span data-ttu-id="5a731-134">[**MprAdminInterfaceCreate**](/windows/desktop/api/Mprapi/nf-mprapi-mpradmininterfacecreate)和 [**MprAdminInterfaceSetInfo**](/windows/desktop/api/Mprapi/nf-mprapi-mpradmininterfacesetinfo)函數支援 [**MPR \_ 介面 \_ 2**](/windows/desktop/api/Mprapi/ns-mprapi-mpr_interface_2)結構。</span><span class="sxs-lookup"><span data-stu-id="5a731-134">The [**MprAdminInterfaceCreate**](/windows/desktop/api/Mprapi/nf-mprapi-mpradmininterfacecreate) and [**MprAdminInterfaceSetInfo**](/windows/desktop/api/Mprapi/nf-mprapi-mpradmininterfacesetinfo) functions support the [**MPR\_INTERFACE\_2**](/windows/desktop/api/Mprapi/ns-mprapi-mpr_interface_2) structure.</span></span> <span data-ttu-id="5a731-135">不過， [**MprConfigInterfaceCreate**](/windows/desktop/api/Mprapi/nf-mprapi-mprconfiginterfacecreate) 和 [**MprConfigInterfaceSetInfo**](/windows/desktop/api/Mprapi/nf-mprapi-mprconfiginterfacesetinfo) 則否。</span><span class="sxs-lookup"><span data-stu-id="5a731-135">However, [**MprConfigInterfaceCreate**](/windows/desktop/api/Mprapi/nf-mprapi-mprconfiginterfacecreate) and [**MprConfigInterfaceSetInfo**](/windows/desktop/api/Mprapi/nf-mprapi-mprconfiginterfacesetinfo) do not.</span></span> <span data-ttu-id="5a731-136">若要建立在重新開機後持續的指定撥號介面，請使用 **MPR \_ interface \_ 2** 呼叫 **MprAdminInterfaceCreate** ，然後使用 [**MPR \_ interface \_ 0**](/windows/desktop/api/Mprapi/ns-mprapi-mpr_interface_0)或 [**MPR \_ interface \_ 1**](/windows/desktop/api/Mprapi/ns-mprapi-mpr_interface_1)呼叫 **MprConfigInterfaceCreate** 。</span><span class="sxs-lookup"><span data-stu-id="5a731-136">In order to create a demand-dial interface that is persistent after a reboot, call **MprAdminInterfaceCreate** with **MPR\_INTERFACE\_2**, then call **MprConfigInterfaceCreate** with [**MPR\_INTERFACE\_0**](/windows/desktop/api/Mprapi/ns-mprapi-mpr_interface_0) or [**MPR\_INTERFACE\_1**](/windows/desktop/api/Mprapi/ns-mprapi-mpr_interface_1).</span></span> <span data-ttu-id="5a731-137">同樣地，若要對指定撥號介面進行持續變更，請使用 **MPR \_ interface \_ 2** 呼叫 **MprAdminInterfaceSetInfo** ，然後使用 **MPR \_ interface \_ 0** 或 **MPR \_ interface \_ 1** 呼叫 **MprConfigInterfaceSetInfo** 。</span><span class="sxs-lookup"><span data-stu-id="5a731-137">Similarly, to make persistent changes to a demand-dial interface, call **MprAdminInterfaceSetInfo** with **MPR\_INTERFACE\_2**, then call **MprConfigInterfaceSetInfo** with **MPR\_INTERFACE\_0** or **MPR\_INTERFACE\_1**.</span></span>

## <a name="using-router-administration-and-configuration-functions-remotely"></a><span data-ttu-id="5a731-138">從遠端使用路由器管理和設定功能</span><span class="sxs-lookup"><span data-stu-id="5a731-138">Using Router Administration and Configuration Functions Remotely</span></span>

<span data-ttu-id="5a731-139">大部分的路由器管理和設定功能都可以在不受管理的電腦上呼叫。</span><span class="sxs-lookup"><span data-stu-id="5a731-139">Most of the router administration and configuration functions can be called on a computer other than the one being administered.</span></span> <span data-ttu-id="5a731-140">這些函式會採用作為參數、路由器服務的控制碼或要管理的設定。</span><span class="sxs-lookup"><span data-stu-id="5a731-140">These functions take as a parameter, a handle to the router service or configuration to administer.</span></span> <span data-ttu-id="5a731-141">管理函數會使用 RPC (遠端程序呼叫) 來與控制碼所指定的路由服務進行通訊。</span><span class="sxs-lookup"><span data-stu-id="5a731-141">The administration functions use RPC (Remote Procedure Call) to communicate with the routing service specified by the handle.</span></span> <span data-ttu-id="5a731-142">設定函式會寫入至控制碼所指定之電腦的登錄，並從中讀取。</span><span class="sxs-lookup"><span data-stu-id="5a731-142">The configuration functions write to and read from the registry of the computer specified by the handle.</span></span>

<span data-ttu-id="5a731-143">若要管理遠端電腦上的路由服務，請先呼叫 [**MprAdminIsServiceRunning**](/windows/desktop/api/Mprapi/nf-mprapi-mpradminisservicerunning) 確認服務正在執行。</span><span class="sxs-lookup"><span data-stu-id="5a731-143">To administer the routing service on a remote machine first call [**MprAdminIsServiceRunning**](/windows/desktop/api/Mprapi/nf-mprapi-mpradminisservicerunning) to verify that the service is running.</span></span> <span data-ttu-id="5a731-144">然後呼叫 [**MprAdminServerConnect**](/windows/desktop/api/Mprapi/nf-mprapi-mpradminserverconnect) 來取得控制碼。</span><span class="sxs-lookup"><span data-stu-id="5a731-144">Then call [**MprAdminServerConnect**](/windows/desktop/api/Mprapi/nf-mprapi-mpradminserverconnect) to obtain the handle.</span></span> <span data-ttu-id="5a731-145">如果路由器服務未在遠端電腦上執行，則所有的路由器管理 (MprAdmin) 呼叫都將會失敗。</span><span class="sxs-lookup"><span data-stu-id="5a731-145">If the router service is not running on the remote machine, all router administration (MprAdmin) calls fail.</span></span>

<span data-ttu-id="5a731-146">若要對遠端電腦上的路由器設定進行變更，請呼叫 [**MprConfigServerConnect**](/windows/desktop/api/Mprapi/nf-mprapi-mprconfigserverconnect) 函式來取得控制碼。</span><span class="sxs-lookup"><span data-stu-id="5a731-146">To make changes to the router configuration on a remote machine obtain a handle by calling the [**MprConfigServerConnect**](/windows/desktop/api/Mprapi/nf-mprapi-mprconfigserverconnect) function.</span></span>

 

 