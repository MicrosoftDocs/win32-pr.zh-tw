---
title: 關於使用 MIB 的路由器管理
description: 適用于路由器管理的管理資訊基礎 (MIB) Api，可讓您查詢和設定由其中一個路由器管理員或路由器管理員服務之任何路由通訊協定所匯出的 MIB 變數值。
ms.assetid: d0fafd82-e7cb-4524-a499-d14830f02b21
keywords:
- 路由，管理資訊基礎
- 路由，管理資訊基礎，描述
- 管理資訊基礎 RRAS
- MIB
- MIB，請參閱管理資訊基礎
- 管理資訊基礎 RRAS
- 管理資訊基礎 RRAS，說明
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e015dacc0b36a00ab62d42c710551aa368aa59e0
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 09/16/2019
ms.locfileid: "103673671"
---
# <a name="about-router-management-with-mib"></a><span data-ttu-id="1c40f-110">關於使用 MIB 的路由器管理</span><span class="sxs-lookup"><span data-stu-id="1c40f-110">About Router Management with MIB</span></span>

<span data-ttu-id="1c40f-111">適用于路由器管理的管理資訊基礎 (MIB) Api，可讓您查詢和設定由其中一個路由器管理員或路由器管理員服務之任何路由通訊協定所匯出的 MIB 變數值。</span><span class="sxs-lookup"><span data-stu-id="1c40f-111">The Management Information Base (MIB) APIs for router management makes it possible to query and set the values of MIB variables exported by one of the router managers or any of the routing protocols that the router managers service.</span></span> <span data-ttu-id="1c40f-112">藉由使用此 API，路由器可支援 (SNMP) 的簡易網路管理通訊協定。</span><span class="sxs-lookup"><span data-stu-id="1c40f-112">By using this API, the router supports the Simple Network Management Protocol (SNMP).</span></span>

<span data-ttu-id="1c40f-113">在 SNMP 架構中，路由器中每個可管理的物件都會以具有唯一物件識別碼 (OID) 的變數來表示。</span><span class="sxs-lookup"><span data-stu-id="1c40f-113">In the SNMP framework, each of the manageable objects in the router is represented by a variable that has a unique Object Identifier (OID).</span></span> <span data-ttu-id="1c40f-114">對應至每個 OID 的值，代表物件的目前狀態。</span><span class="sxs-lookup"><span data-stu-id="1c40f-114">Corresponding to each OID is a value that represents the current state of the object.</span></span> <span data-ttu-id="1c40f-115">Oid 和值的集合稱為管理資訊基底 (MIB) 。</span><span class="sxs-lookup"><span data-stu-id="1c40f-115">The collection of OIDs and values is referred to as a Management Information Base (MIB).</span></span> <span data-ttu-id="1c40f-116">MprAdminMib 呼叫可讓開發人員透過其 OID 指定物件，並查詢或寫入 ( "Set" ) 物件的值。</span><span class="sxs-lookup"><span data-stu-id="1c40f-116">The MprAdminMib calls allow a developer to specify an object by its OID and either query or write ("Set") the object's value.</span></span>

<span data-ttu-id="1c40f-117">若要查詢及設定 MIB 變數，服務呼叫的模組必須定義一組資料結構。</span><span class="sxs-lookup"><span data-stu-id="1c40f-117">To query and set MIB variables, the module that services the calls must define a set of data structures.</span></span> <span data-ttu-id="1c40f-118">這些資料結構包括用來作為物件識別碼的結構，以及用來保存所要存取之 MIB 變數值的結構。</span><span class="sxs-lookup"><span data-stu-id="1c40f-118">These data structures include structures to use as Object Identifiers and structures that hold the values of the MIB variables being accessed.</span></span> <span data-ttu-id="1c40f-119">這些資料結構對除了 MIB 函式的呼叫者和服務呼叫的模組之外，都不是透明的。</span><span class="sxs-lookup"><span data-stu-id="1c40f-119">These data structures are opaque to all but the caller of the MIB function and the module servicing the call.</span></span>

<span data-ttu-id="1c40f-120">服務 MIB 通話的模組是路由器管理員或其中一個路由通訊協定。</span><span class="sxs-lookup"><span data-stu-id="1c40f-120">The module servicing the MIB call is a router manager or one of the routing protocols.</span></span> <span data-ttu-id="1c40f-121">呼叫端必須指定路由器管理員，即使呼叫是由其中一個路由通訊協定處理。</span><span class="sxs-lookup"><span data-stu-id="1c40f-121">The caller must specify a router manager even if the call is handled by one of the routing protocols.</span></span> <span data-ttu-id="1c40f-122">在這種情況下，呼叫端應該指定對應至該路由通訊協定之通訊協定系列的路由器管理員。</span><span class="sxs-lookup"><span data-stu-id="1c40f-122">In such a case, the caller should specify the router manager that corresponds to the protocol family for that routing protocol.</span></span> <span data-ttu-id="1c40f-123">例如，如果開放式最短路徑先 (OSPF) 路由通訊協定正在處理 MIB 呼叫，則呼叫端必須指定 IP 路由器管理員，因為 OSPF 屬於 IP 通訊協定系列。</span><span class="sxs-lookup"><span data-stu-id="1c40f-123">For example, if the Open Shortest Path First (OSPF) routing protocol were handling the MIB call, the caller would need to specify the IP Router Manager, since OSPF belongs to the IP protocol family.</span></span> <span data-ttu-id="1c40f-124">在每個 MIB 函式中， *dwTransportId* 參數會指定路由器管理員，而 *RoutingPid* 參數會指定路由通訊協定。</span><span class="sxs-lookup"><span data-stu-id="1c40f-124">In each of the MIB functions, the *dwTransportId* parameter specifies a router manager, and the *RoutingPid* parameter specifies the routing protocol.</span></span> <span data-ttu-id="1c40f-125">路由器管理員也有獨特的 *RoutingPid*，因為某些 MIB 變數可能由路由器管理員本身處理。</span><span class="sxs-lookup"><span data-stu-id="1c40f-125">The router manager also has a unique *RoutingPid*, since some of the MIB variables may be handled by the router manager itself.</span></span>

<span data-ttu-id="1c40f-126">您可以在不受管理的電腦上呼叫 MprAdminMib 函數。</span><span class="sxs-lookup"><span data-stu-id="1c40f-126">The MprAdminMib functions can be called on a computer other than the one being administered.</span></span> <span data-ttu-id="1c40f-127">查詢或寫入值的 MprAdminMIB 函式會以參數做為參數，以處理要管理的電腦。</span><span class="sxs-lookup"><span data-stu-id="1c40f-127">The MprAdminMIB functions that query or write values, take as a parameter a handle to the computer to administer.</span></span> <span data-ttu-id="1c40f-128">使用 [**MprAdminMIBServerConnect**](/windows/desktop/api/Mprapi/nf-mprapi-mpradminmibserverconnect) 函式來建立與遠端電腦的連線，並取得此控制碼。</span><span class="sxs-lookup"><span data-stu-id="1c40f-128">Use the [**MprAdminMIBServerConnect**](/windows/desktop/api/Mprapi/nf-mprapi-mpradminmibserverconnect) function to establish the connection to the remote computer and obtain this handle.</span></span> <span data-ttu-id="1c40f-129">在呼叫所需的 MprAdminMIB 函式來完成特定的系統管理工作之後，請呼叫 [**MprAdminMIBServerDisconnect**](/windows/desktop/api/Mprapi/nf-mprapi-mpradminmibserverdisconnect) 函數來終止遠端電腦的連接。</span><span class="sxs-lookup"><span data-stu-id="1c40f-129">After calling the necessary MprAdminMIB functions to accomplish a particular administrative task, call the [**MprAdminMIBServerDisconnect**](/windows/desktop/api/Mprapi/nf-mprapi-mpradminmibserverdisconnect) function to terminate the connection to the remote computer.</span></span>

<span data-ttu-id="1c40f-130">[**MprAdminMIBEntryCreate**](/windows/desktop/api/Mprapi/nf-mprapi-mpradminmibentrycreate)和 [**MprAdminMIBEntrySet**](/windows/desktop/api/Mprapi/nf-mprapi-mpradminmibentryset)函式會以 OID 和包含物件新值的緩衝區作為參數。</span><span class="sxs-lookup"><span data-stu-id="1c40f-130">The [**MprAdminMIBEntryCreate**](/windows/desktop/api/Mprapi/nf-mprapi-mpradminmibentrycreate) and [**MprAdminMIBEntrySet**](/windows/desktop/api/Mprapi/nf-mprapi-mpradminmibentryset) functions take as parameters an OID and a buffer which contains the new value for the object.</span></span>

<span data-ttu-id="1c40f-131">[**MprAdminMIBEntryGet**](/windows/desktop/api/Mprapi/nf-mprapi-mpradminmibentryget)、 [**MprAdminMIBEntryGetFirst**](/windows/desktop/api/Mprapi/nf-mprapi-mpradminmibentrygetfirst)和 [**MPRADMINMIBENTRYGETNEXT**](/windows/desktop/api/Mprapi/nf-mprapi-mpradminmibentrygetnext)函式會以 OID 和指標變數的位址做為參數。</span><span class="sxs-lookup"><span data-stu-id="1c40f-131">The [**MprAdminMIBEntryGet**](/windows/desktop/api/Mprapi/nf-mprapi-mpradminmibentryget), [**MprAdminMIBEntryGetFirst**](/windows/desktop/api/Mprapi/nf-mprapi-mpradminmibentrygetfirst) and [**MprAdminMIBEntryGetNext**](/windows/desktop/api/Mprapi/nf-mprapi-mpradminmibentrygetnext) functions take as parameters an OID and the address of a pointer variable.</span></span> <span data-ttu-id="1c40f-132">在成功傳回時，指標變數會指向包含物件值的緩衝區。</span><span class="sxs-lookup"><span data-stu-id="1c40f-132">On successful return, the pointer variable points to a buffer that contains the value for the object.</span></span> <span data-ttu-id="1c40f-133">呼叫端應該藉由呼叫 [**MprAdminMIBBufferFree**](/windows/desktop/api/Mprapi/nf-mprapi-mpradminmibbufferfree) 函式釋放這個緩衝區的記憶體。</span><span class="sxs-lookup"><span data-stu-id="1c40f-133">The caller should free the memory for this buffer by calling the [**MprAdminMIBBufferFree**](/windows/desktop/api/Mprapi/nf-mprapi-mpradminmibbufferfree) function.</span></span>

<span data-ttu-id="1c40f-134">[**MprAdminMIBEntryGetFirst**](/windows/desktop/api/Mprapi/nf-mprapi-mpradminmibentrygetfirst)和 [**MprAdminMIBEntryGetNext**](/windows/desktop/api/Mprapi/nf-mprapi-mpradminmibentrygetnext)函數可讓開發人員執行 *SNMP 逐步* 解說。</span><span class="sxs-lookup"><span data-stu-id="1c40f-134">The [**MprAdminMIBEntryGetFirst**](/windows/desktop/api/Mprapi/nf-mprapi-mpradminmibentrygetfirst) and [**MprAdminMIBEntryGetNext**](/windows/desktop/api/Mprapi/nf-mprapi-mpradminmibentrygetnext) functions enable a developer to perform an *SNMP walk*.</span></span> <span data-ttu-id="1c40f-135">因為 Oid 經過排序，所以每個 OID，因此每個可管理的物件都有 *下* 一個 oid。</span><span class="sxs-lookup"><span data-stu-id="1c40f-135">Because the OIDs are ordered, each OID and therefore each manageable object has a *next* OID.</span></span> <span data-ttu-id="1c40f-136">SNMP 逐步解說指的是藉由讀取或寫入一連串的 Oid 來往返 MIB 的某個部分。</span><span class="sxs-lookup"><span data-stu-id="1c40f-136">An SNMP walk refers to traversing a portion of the MIB by reading or writing a sequence of OIDs.</span></span>

<span data-ttu-id="1c40f-137">所有的 MprAdminMib 呼叫會通過動態介面管理員 (維度) 。</span><span class="sxs-lookup"><span data-stu-id="1c40f-137">All MprAdminMib calls pass through the Dynamic Interface Manager (DIM).</span></span> <span data-ttu-id="1c40f-138">根據 OID，DIM 會將呼叫傳遞給其中一個路由器管理員。</span><span class="sxs-lookup"><span data-stu-id="1c40f-138">Depending on the OID, DIM passes the call to one of the router managers.</span></span> <span data-ttu-id="1c40f-139"> (IP 和 IPX 都支援 SNMP) 。</span><span class="sxs-lookup"><span data-stu-id="1c40f-139">(Both IP and IPX support SNMP).</span></span> <span data-ttu-id="1c40f-140">同樣地，根據 OID，路由器管理員可能會處理呼叫本身，或將呼叫傳遞給其中一個用戶端。</span><span class="sxs-lookup"><span data-stu-id="1c40f-140">Again, depending on the OID, the router manager may handle the call itself, or pass the call to one of its clients.</span></span> <span data-ttu-id="1c40f-141">所有的路由器用戶端都必須執行和匯出下列函式，這些函式會對應至類似名稱的 MprAdminMIB 函式：</span><span class="sxs-lookup"><span data-stu-id="1c40f-141">All router clients are required to implement and export the following functions which correspond to the similarly named MprAdminMIB functions:</span></span>

-   [<span data-ttu-id="1c40f-142">**MibCreate**</span><span class="sxs-lookup"><span data-stu-id="1c40f-142">**MibCreate**</span></span>](/windows/desktop/api/Routprot/nc-routprot-pmib_create)
-   [<span data-ttu-id="1c40f-143">**MibDelete**</span><span class="sxs-lookup"><span data-stu-id="1c40f-143">**MibDelete**</span></span>](/windows/desktop/api/Routprot/nc-routprot-pmib_delete)
-   [<span data-ttu-id="1c40f-144">**MibSet**</span><span class="sxs-lookup"><span data-stu-id="1c40f-144">**MibSet**</span></span>](/windows/desktop/api/Routprot/nc-routprot-pmib_set)
-   [<span data-ttu-id="1c40f-145">**MibGet**</span><span class="sxs-lookup"><span data-stu-id="1c40f-145">**MibGet**</span></span>](/windows/desktop/api/Routprot/nc-routprot-pmib_get)
-   [<span data-ttu-id="1c40f-146">**MibGetFirst**</span><span class="sxs-lookup"><span data-stu-id="1c40f-146">**MibGetFirst**</span></span>](/windows/desktop/api/Routprot/nc-routprot-pmib_get_first)
-   [<span data-ttu-id="1c40f-147">**MibGetNext**</span><span class="sxs-lookup"><span data-stu-id="1c40f-147">**MibGetNext**</span></span>](/windows/desktop/api/Routprot/nc-routprot-pmib_get_next)
-   [<span data-ttu-id="1c40f-148">**MibGetTrapInfo**</span><span class="sxs-lookup"><span data-stu-id="1c40f-148">**MibGetTrapInfo**</span></span>](/windows/desktop/api/Routprot/nc-routprot-pmib_get_trap_info)
-   [<span data-ttu-id="1c40f-149">**MibSetTrapInfo**</span><span class="sxs-lookup"><span data-stu-id="1c40f-149">**MibSetTrapInfo**</span></span>](/windows/desktop/api/Routprot/nc-routprot-pmib_set_trap_info)

 

 




