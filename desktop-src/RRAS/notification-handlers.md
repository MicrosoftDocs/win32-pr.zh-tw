---
title: 通知處理常式
description: 非同步 RasDial 呼叫必須指定通知處理常式。
ms.assetid: 6d23d6ac-08ad-4fe2-a4af-021e4d384079
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: efe735a17de4386bc48648cd20decd218ab102d2
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 09/16/2019
ms.locfileid: "103932528"
---
# <a name="notification-handlers"></a><span data-ttu-id="bd140-103">通知處理常式</span><span class="sxs-lookup"><span data-stu-id="bd140-103">Notification Handlers</span></span>

<span data-ttu-id="bd140-104">非同步 [**RasDial**](/windows/desktop/api/Ras/nf-ras-rasdiala) 呼叫必須指定通知處理常式。</span><span class="sxs-lookup"><span data-stu-id="bd140-104">An asynchronous [**RasDial**](/windows/desktop/api/Ras/nf-ras-rasdiala) call must specify a notification handler.</span></span> <span data-ttu-id="bd140-105">在非同步連接作業期間，「遠端存取」連線管理員會在連線 [狀態](connection-states.md) 變更或發生錯誤時，使用通知處理常式來通知 RAS 用戶端。</span><span class="sxs-lookup"><span data-stu-id="bd140-105">During an asynchronous connection operation, the Remote Access Connection Manager uses the notification handler to inform the RAS client whenever the [connection state](connection-states.md) changes or an error occurs.</span></span>

<span data-ttu-id="bd140-106">通知處理常式所執行的動作可以分為下列類別：</span><span class="sxs-lookup"><span data-stu-id="bd140-106">The actions performed by a notification handler can be divided into the following categories:</span></span>

-   <span data-ttu-id="bd140-107">[處理錯誤](handling-ras-errors.md)。</span><span class="sxs-lookup"><span data-stu-id="bd140-107">[Handling errors](handling-ras-errors.md).</span></span>
-   <span data-ttu-id="bd140-108">為使用者提供意見反應，因為連接作業會繼續進行各種連接狀態。</span><span class="sxs-lookup"><span data-stu-id="bd140-108">Providing feedback to the user as the connection operation proceeds through the various connection states.</span></span> <span data-ttu-id="bd140-109">請參閱 [語音總機](informational-notifications.md)。</span><span class="sxs-lookup"><span data-stu-id="bd140-109">See [Informational Notifications](informational-notifications.md).</span></span>
-   <span data-ttu-id="bd140-110">處理 [暫停狀態](paused-states.md)。</span><span class="sxs-lookup"><span data-stu-id="bd140-110">Handling [paused states](paused-states.md).</span></span>
-   <span data-ttu-id="bd140-111">連接作業完成時，通知 RAS 用戶端應用程式。</span><span class="sxs-lookup"><span data-stu-id="bd140-111">Signaling the RAS client application when the connection operation has been completed.</span></span> <span data-ttu-id="bd140-112">查看 [完成通知](completion-notifications.md)。</span><span class="sxs-lookup"><span data-stu-id="bd140-112">See [Completion Notifications](completion-notifications.md).</span></span>

<span data-ttu-id="bd140-113">有三種類型的通知處理常式，每一個都會收到相同的基本資訊：目前的連接狀態，以及只有在發生錯誤時為非零的錯誤碼。</span><span class="sxs-lookup"><span data-stu-id="bd140-113">There are three types of notification handlers, each of which receives the same basic information: the current connection state and an error code that is nonzero only if an error has occurred.</span></span>



| <span data-ttu-id="bd140-114">值</span><span class="sxs-lookup"><span data-stu-id="bd140-114">Value</span></span>                                | <span data-ttu-id="bd140-115">定義</span><span class="sxs-lookup"><span data-stu-id="bd140-115">Definition</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|--------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="bd140-116">**RasDialFunc**</span><span class="sxs-lookup"><span data-stu-id="bd140-116">**RasDialFunc**</span></span>](/windows/desktop/api/Ras/nc-ras-rasdialfunc)   | <span data-ttu-id="bd140-117">回呼函式原型，它只會接收目前的連接狀態和錯誤碼資訊。</span><span class="sxs-lookup"><span data-stu-id="bd140-117">A callback function prototype that receives only the current connection state and error code information.</span></span>                                                                                                                                                                                                                                                                                                                                                                                    |
| [<span data-ttu-id="bd140-118">**RasDialFunc1**</span><span class="sxs-lookup"><span data-stu-id="bd140-118">**RasDialFunc1**</span></span>](/windows/desktop/api/Ras/nc-ras-rasdialfunc1) | <span data-ttu-id="bd140-119">除了基本資訊之外，還會收到 **HRASCONN** 連接控制碼和延伸錯誤資訊的回呼函式原型。</span><span class="sxs-lookup"><span data-stu-id="bd140-119">A callback function prototype that receives the **HRASCONN** connection handle and extended error information in addition to the basic information.</span></span> <span data-ttu-id="bd140-120">連接控制碼參數讓 [**RasDialFunc1**](/windows/desktop/api/Ras/nc-ras-rasdialfunc1) 適用于支援多個同時連接作業的用戶端應用程式。</span><span class="sxs-lookup"><span data-stu-id="bd140-120">The connection handle parameter makes [**RasDialFunc1**](/windows/desktop/api/Ras/nc-ras-rasdialfunc1) useful for client applications that support multiple simultaneous connection operations.</span></span> <span data-ttu-id="bd140-121">這可讓用戶端為所有作業指定相同的回呼函式，並啟用回呼函式來判斷哪個連接正在變更狀態。</span><span class="sxs-lookup"><span data-stu-id="bd140-121">This allows the client to specify the same callback function for all operations, and enables the callback function to determine which connection is changing states.</span></span> |
| [<span data-ttu-id="bd140-122">**RasDialFunc2**</span><span class="sxs-lookup"><span data-stu-id="bd140-122">**RasDialFunc2**</span></span>](/windows/desktop/api/Ras/nc-ras-rasdialfunc2) | <span data-ttu-id="bd140-123">類似于 [**RasDialFunc1**](/windows/desktop/api/Ras/nc-ras-rasdialfunc1)的回呼函數。</span><span class="sxs-lookup"><span data-stu-id="bd140-123">A callback function similar to [**RasDialFunc1**](/windows/desktop/api/Ras/nc-ras-rasdialfunc1).</span></span> <span data-ttu-id="bd140-124">不過， [**RasDialFunc2**](/windows/desktop/api/Ras/nc-ras-rasdialfunc2) 已增強，可支援多重連接連線。</span><span class="sxs-lookup"><span data-stu-id="bd140-124">However, [**RasDialFunc2**](/windows/desktop/api/Ras/nc-ras-rasdialfunc2) is enhanced to support multilink connections.</span></span>                                                                                                                                                                                                                                                                                                                             |
| <span data-ttu-id="bd140-125">視窗控制碼</span><span class="sxs-lookup"><span data-stu-id="bd140-125">Window handle</span></span>                        | <span data-ttu-id="bd140-126">RAS 傳送包含目前連接狀態和錯誤碼資訊之 [**WM \_ RASDIALEVENT**](wm-rasdialevent.md) 訊息的視窗控制碼。</span><span class="sxs-lookup"><span data-stu-id="bd140-126">A window handle to which RAS sends [**WM\_RASDIALEVENT**](wm-rasdialevent.md) messages containing the current connection state and error code information.</span></span> <span data-ttu-id="bd140-127">如果您的原始程式碼必須與16位的 Windows 相容，請使用這個方法，因為16位 Windows 不支援其中一個回呼函式。</span><span class="sxs-lookup"><span data-stu-id="bd140-127">Use this method if your source code must be compatible with 16-bit Windows, because 16-bit Windows does not support either of the callback functions.</span></span>                                                                                                                                                                            |



 

<span data-ttu-id="bd140-128">遠端存取連線管理員會暫停連接作業，直到通知處理常式傳回為止。</span><span class="sxs-lookup"><span data-stu-id="bd140-128">The Remote Access Connection Manager suspends the connection operation until the notification handler returns.</span></span> <span data-ttu-id="bd140-129">基於這個理由，除非發生錯誤，否則處理常式應該儘快傳回。</span><span class="sxs-lookup"><span data-stu-id="bd140-129">For this reason, the handler should return as soon as possible unless an error has occurred.</span></span>

<span data-ttu-id="bd140-130">[**RasDial**](/windows/desktop/api/Ras/nf-ras-rasdiala)函式不應該從通知處理常式內呼叫。</span><span class="sxs-lookup"><span data-stu-id="bd140-130">The [**RasDial**](/windows/desktop/api/Ras/nf-ras-rasdiala) function should not be called from within a notification handler.</span></span> <span data-ttu-id="bd140-131">另一個遠端存取函式 ( [**RasGetConnectStatus**](/windows/desktop/api/Ras/nf-ras-rasgetconnectstatusa)、 [**RasEnumEntries**](/windows/desktop/api/Ras/nf-ras-rasenumentriesa)、 [**RasEnumConnections**](/windows/desktop/api/Ras/nf-ras-rasenumconnectionsa)、 [**RasGetErrorString**](/windows/desktop/api/Ras/nf-ras-rasgeterrorstringa)和 [**RasHangUp**](/windows/desktop/api/Ras/nf-ras-rashangupa)) 可從處理常式內呼叫。</span><span class="sxs-lookup"><span data-stu-id="bd140-131">The other remote access functions ( [**RasGetConnectStatus**](/windows/desktop/api/Ras/nf-ras-rasgetconnectstatusa), [**RasEnumEntries**](/windows/desktop/api/Ras/nf-ras-rasenumentriesa), [**RasEnumConnections**](/windows/desktop/api/Ras/nf-ras-rasenumconnectionsa), [**RasGetErrorString**](/windows/desktop/api/Ras/nf-ras-rasgeterrorstringa), and [**RasHangUp**](/windows/desktop/api/Ras/nf-ras-rashangupa)) can be called from within a handler.</span></span>

 

 




