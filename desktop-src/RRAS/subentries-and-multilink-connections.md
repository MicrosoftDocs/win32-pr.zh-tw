---
title: 子機和多重連結連接
description: Windows NT Server 4.0 支援電話簿子機，可啟用多重連接連線。 多重連接連接會結合多個連線的頻寬，以提供具有更高頻寬的單一連線。
ms.assetid: 19cf6e1a-cdba-47e4-8d8f-d6030ed6f9e3
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c1970e2e2ad668b376b1097aa20cd18986fb605a
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/20/2020
ms.locfileid: "104316078"
---
# <a name="subentries-and-multilink-connections"></a><span data-ttu-id="457cd-104">子機和多重連結連接</span><span class="sxs-lookup"><span data-stu-id="457cd-104">Subentries and Multilink Connections</span></span>

<span data-ttu-id="457cd-105">Windows NT Server 4.0 支援電話簿子機，可啟用多重連接連線。</span><span class="sxs-lookup"><span data-stu-id="457cd-105">Windows NT Server 4.0 provides support for phone-book subentries, which enable multilink connections.</span></span> <span data-ttu-id="457cd-106">多重連接連接會結合多個連線的頻寬，以提供具有更高頻寬的單一連線。</span><span class="sxs-lookup"><span data-stu-id="457cd-106">A multilink connection combines the bandwidth of multiple connections to provide a single connection with higher bandwidth.</span></span>

<span data-ttu-id="457cd-107">RAS 電話簿專案可以有零或多個子專案。</span><span class="sxs-lookup"><span data-stu-id="457cd-107">A RAS phone-book entry can have zero or more subentries.</span></span> <span data-ttu-id="457cd-108">[**RasGetEntryProperties**](/windows/desktop/api/Ras/nf-ras-rasgetentrypropertiesa)函式會抓取 [**RASENTRY**](/previous-versions/windows/desktop/legacy/aa377274(v=vs.85))結構，其中包含有關電話簿專案之子專案的資訊。</span><span class="sxs-lookup"><span data-stu-id="457cd-108">The [**RasGetEntryProperties**](/windows/desktop/api/Ras/nf-ras-rasgetentrypropertiesa) function retrieves a [**RASENTRY**](/previous-versions/windows/desktop/legacy/aa377274(v=vs.85)) structure that includes information about the subentries of a phone-book entry.</span></span> <span data-ttu-id="457cd-109">**RASENTRY** 結構的 **dwSubEntries** 成員會指出子值的數目。</span><span class="sxs-lookup"><span data-stu-id="457cd-109">The **dwSubEntries** member of the **RASENTRY** structure indicates the number of subentries.</span></span> <span data-ttu-id="457cd-110">電話簿一開始沒有任何子專案。</span><span class="sxs-lookup"><span data-stu-id="457cd-110">Phone-book entries initially have no subentries.</span></span> <span data-ttu-id="457cd-111">若要將子專案新增至電話簿專案，請使用 [**RasSetSubEntryProperties**](/windows/desktop/api/Ras/nf-ras-rassetsubentrypropertiesa) 函數。</span><span class="sxs-lookup"><span data-stu-id="457cd-111">To add subentries to a phone-book entry, use the [**RasSetSubEntryProperties**](/windows/desktop/api/Ras/nf-ras-rassetsubentrypropertiesa) function.</span></span>

<span data-ttu-id="457cd-112">每個子索引的屬性都包含電話號碼，以及撥號裝置的撥號時所要使用之 TAPI 裝置的名稱和類型。</span><span class="sxs-lookup"><span data-stu-id="457cd-112">The properties for each subentry include a phone number and the name and type of the TAPI device to use when dialing the subentry.</span></span> <span data-ttu-id="457cd-113">此外，如果 RAS 無法使用主要號碼進行連線，則子索引可包含備用電話號碼清單來撥打電話。</span><span class="sxs-lookup"><span data-stu-id="457cd-113">In addition, a subentry can include a list of alternate phone numbers to dial if RAS cannot make a connection using the primary number.</span></span> <span data-ttu-id="457cd-114">[**RasSetSubEntryProperties**](/windows/desktop/api/Ras/nf-ras-rassetsubentrypropertiesa)和 [**RasGetSubEntryProperties**](/windows/desktop/api/Ras/nf-ras-rasgetsubentrypropertiesa)函式會使用 [**RASSUBENTRY**](/previous-versions/windows/desktop/legacy/aa377839(v=vs.85))結構來設定和取出指定的電話通訊錄子索引項目的屬性。</span><span class="sxs-lookup"><span data-stu-id="457cd-114">The [**RasSetSubEntryProperties**](/windows/desktop/api/Ras/nf-ras-rassetsubentrypropertiesa) and [**RasGetSubEntryProperties**](/windows/desktop/api/Ras/nf-ras-rasgetsubentrypropertiesa) functions use the [**RASSUBENTRY**](/previous-versions/windows/desktop/legacy/aa377839(v=vs.85)) structure to set and retrieve the properties of a specified phone-book subentry.</span></span> <span data-ttu-id="457cd-115">子索引是以以一個為基礎的索引來識別。</span><span class="sxs-lookup"><span data-stu-id="457cd-115">Subentries are identified by a one-based index.</span></span>

<span data-ttu-id="457cd-116">您可以呼叫 [**RasSetEntryProperties**](/windows/desktop/api/Ras/nf-ras-rassetentrypropertiesa) 函式來設定多重連結 RAS 專案，以在第一次撥號時連接所有的子機。</span><span class="sxs-lookup"><span data-stu-id="457cd-116">You can call the [**RasSetEntryProperties**](/windows/desktop/api/Ras/nf-ras-rassetentrypropertiesa) function to configure a multilink RAS entry to connect all subentries when it is first dialed.</span></span> <span data-ttu-id="457cd-117">或者，您可以設定專案以提供可變頻寬。</span><span class="sxs-lookup"><span data-stu-id="457cd-117">Alternatively, you can configure an entry to provide variable bandwidth.</span></span> <span data-ttu-id="457cd-118">在此情況下，RAS 一開始會連接單一子索引，然後視需要連接或中斷連接其他子服務。</span><span class="sxs-lookup"><span data-stu-id="457cd-118">In this case, RAS connects a single subentry initially, and then connects or disconnects additional subentries as needed.</span></span> <span data-ttu-id="457cd-119">若為可變頻寬的多重連結連接，您可以使用 [**RASDIALPARAMS**](/previous-versions/windows/desktop/legacy/aa377238(v=vs.85)) 結構來指定當您呼叫 [**RasDial**](/windows/desktop/api/Ras/nf-ras-rasdiala) 函式時要連接的初始子索引。</span><span class="sxs-lookup"><span data-stu-id="457cd-119">For a variable-bandwidth multilink connection, you can use the [**RASDIALPARAMS**](/previous-versions/windows/desktop/legacy/aa377238(v=vs.85)) structure to specify the initial subentry to connect when you call the [**RasDial**](/windows/desktop/api/Ras/nf-ras-rasdiala) function.</span></span> <span data-ttu-id="457cd-120">使用 [**RasDialDlg**](/windows/desktop/api/Rasdlg/nf-rasdlg-rasdialdlga) 函式來連接多重連結專案時，您可以使用 [**RasDialDlg**](/previous-versions/windows/desktop/legacy/aa377023(v=vs.85)) 結構來指定要連接的初始子索引。</span><span class="sxs-lookup"><span data-stu-id="457cd-120">When using the [**RasDialDlg**](/windows/desktop/api/Rasdlg/nf-rasdlg-rasdialdlga) function to connect a multilink entry, you can use the [**RASDIALDLG**](/previous-versions/windows/desktop/legacy/aa377023(v=vs.85)) structure to specify the initial subentry to connect.</span></span>

<span data-ttu-id="457cd-121">若為可變頻寬的多重連結連接，請使用 [**RASENTRY**](/previous-versions/windows/desktop/legacy/aa377274(v=vs.85)) 結構搭配 [**RasSetEntryProperties**](/windows/desktop/api/Ras/nf-ras-rassetentrypropertiesa) 函式來指定連接和中斷個別子機的參數。</span><span class="sxs-lookup"><span data-stu-id="457cd-121">For a variable-bandwidth multilink connection, use the [**RASENTRY**](/previous-versions/windows/desktop/legacy/aa377274(v=vs.85)) structure with the [**RasSetEntryProperties**](/windows/desktop/api/Ras/nf-ras-rassetentrypropertiesa) function to specify the parameters for connecting and disconnecting the individual subentries.</span></span> <span data-ttu-id="457cd-122">當使用的頻寬超過指定間隔的可用頻寬指定百分比時，RAS 會連接額外的子索引。</span><span class="sxs-lookup"><span data-stu-id="457cd-122">RAS connects an additional subentry when the bandwidth being used exceeds a specified percentage of the available bandwidth for a specified interval.</span></span>

<span data-ttu-id="457cd-123">如果您呼叫 [**RasDial**](/windows/desktop/api/Ras/nf-ras-rasdiala) 函式來建立多重連結連接，您可以指定 [**RasDialFunc2**](/windows/desktop/api/Ras/nc-ras-rasdialfunc2) 回呼函式來接收有關連接的通知。</span><span class="sxs-lookup"><span data-stu-id="457cd-123">If you call the [**RasDial**](/windows/desktop/api/Ras/nf-ras-rasdiala) function to establish a multilink connection, you can specify a [**RasDialFunc2**](/windows/desktop/api/Ras/nc-ras-rasdialfunc2) callback function to receive notifications about the connection.</span></span> <span data-ttu-id="457cd-124">**RasDialFunc2** 類似于 [**RasDialFunc1**](/windows/desktop/api/Ras/nc-ras-rasdialfunc1) 回呼函式，不同之處在于它會提供多重連結連接的額外資訊，例如造成通知的子索引。</span><span class="sxs-lookup"><span data-stu-id="457cd-124">**RasDialFunc2** is similar to the [**RasDialFunc1**](/windows/desktop/api/Ras/nc-ras-rasdialfunc1) callback function, except that it provides additional information for a multilink connection, such as the index of the subentry that caused the notification.</span></span> <span data-ttu-id="457cd-125">當 RAS 連線或中斷連接子索引的連線時，會呼叫您的 **RasDialFunc2** 函式。</span><span class="sxs-lookup"><span data-stu-id="457cd-125">RAS calls your **RasDialFunc2** function when it connects or disconnects a subentry.</span></span>

<span data-ttu-id="457cd-126">您可以使用 **HRASCONN** 連接控制碼來掛上或取得多重連結連接的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="457cd-126">You can use an **HRASCONN** connection handle to hang up or retrieve information about a multilink connection.</span></span> <span data-ttu-id="457cd-127">您可以針對組成多重連結的每個子索引連接，以及合併的多重連結連接，取得連接控制碼。</span><span class="sxs-lookup"><span data-stu-id="457cd-127">You can get a connection handle for each of the subentry connections that make up the multilink, as well as for the combined multilink connection.</span></span> <span data-ttu-id="457cd-128">當您呼叫 [**RasDial**](/windows/desktop/api/Ras/nf-ras-rasdiala) 函式來建立多重連結連接時， **RasDial** 會將控制碼傳回至合併的多重連結連接。</span><span class="sxs-lookup"><span data-stu-id="457cd-128">When you call the [**RasDial**](/windows/desktop/api/Ras/nf-ras-rasdiala) function to establish a multilink connection, **RasDial** returns a handle to the combined multilink connection.</span></span> <span data-ttu-id="457cd-129">同樣地，當您列舉連接時， [**RasEnumConnections**](/windows/desktop/api/Ras/nf-ras-rasenumconnectionsa) 會傳回合並的多重連結控制碼。</span><span class="sxs-lookup"><span data-stu-id="457cd-129">Similarly, [**RasEnumConnections**](/windows/desktop/api/Ras/nf-ras-rasenumconnectionsa) returns the combined multilink handle when you enumerate connections.</span></span> <span data-ttu-id="457cd-130">若要取得多重連結連接中其中一個子索引連接的控制碼，請呼叫 [**RasGetSubEntryHandle**](/windows/desktop/api/Ras/nf-ras-rasgetsubentryhandlea) 函數。</span><span class="sxs-lookup"><span data-stu-id="457cd-130">To get a handle to one of the subentry connections in a multilink connection, call the [**RasGetSubEntryHandle**](/windows/desktop/api/Ras/nf-ras-rasgetsubentryhandlea) function.</span></span>

<span data-ttu-id="457cd-131">您可以在 [**RasHangUp**](/windows/desktop/api/Ras/nf-ras-rashangupa)、 [**RasGetConnectStatus**](/windows/desktop/api/Ras/nf-ras-rasgetconnectstatusa)和 [**RasGetProjectionInfo**](/previous-versions/windows/embedded/ms897107(v=msdn.10)) 函式中使用合併的多重連結連接控制碼和子索引連接控制碼。</span><span class="sxs-lookup"><span data-stu-id="457cd-131">You can use the combined multilink connection handle and the subentry connection handles in the [**RasHangUp**](/windows/desktop/api/Ras/nf-ras-rashangupa), [**RasGetConnectStatus**](/windows/desktop/api/Ras/nf-ras-rasgetconnectstatusa), and [**RasGetProjectionInfo**](/previous-versions/windows/embedded/ms897107(v=msdn.10)) functions.</span></span> <span data-ttu-id="457cd-132">使用合併的多重連結控制碼呼叫 **RasHangUp** 會終止整個連接;使用子索引介面進行呼叫，只會使該子索引的連線停止回應。</span><span class="sxs-lookup"><span data-stu-id="457cd-132">Calling **RasHangUp** with a combined multilink handle terminates the entire connection; calling it with a subentry handle hangs up only that subentry connection.</span></span> <span data-ttu-id="457cd-133">同樣地， **RasGetConnectStatus** 會根據指定的控制碼，傳回合並或個別連接的資訊。</span><span class="sxs-lookup"><span data-stu-id="457cd-133">Similarly, **RasGetConnectStatus** returns information for the combined or individual connection, depending on the handle specified.</span></span> <span data-ttu-id="457cd-134">**RasGetProjectionInfo** 針對多重連接專案所傳回的投射資訊，對於主要連接控制碼而言是相同的。</span><span class="sxs-lookup"><span data-stu-id="457cd-134">The projection information returned by **RasGetProjectionInfo** for a multilink entry is the same for each of the subentry connection handles as it is for the main connection handle.</span></span>

 

 