---
description: 大部分的計數器都需要兩個範例值，才能計算可顯示的值。
ms.assetid: 75e45baf-51c5-400c-a31f-92bdab4ee492
title: 顯示效能資料
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 22d913474b794585dd557fae2b1fc232336b637d
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/07/2021
ms.locfileid: "106977915"
---
# <a name="displaying-performance-data"></a><span data-ttu-id="4ae05-103">顯示效能資料</span><span class="sxs-lookup"><span data-stu-id="4ae05-103">Displaying Performance Data</span></span>

<span data-ttu-id="4ae05-104">大部分的計數器都需要兩個範例值，才能計算可顯示的值。</span><span class="sxs-lookup"><span data-stu-id="4ae05-104">Most counters require two sample values in order to compute a displayable value.</span></span> <span data-ttu-id="4ae05-105">每個計數器的公式會決定計數器是否需要兩個樣本。</span><span class="sxs-lookup"><span data-stu-id="4ae05-105">The formula for each counter determines if the counter requires two samples.</span></span> <span data-ttu-id="4ae05-106">如需計數器及其公式的清單，請參閱 [Windows Server 2003 部署套件](/previous-versions/windows/it-pro/windows-server-2003/cc776490(v=ws.10))的「計數器類型」一節。</span><span class="sxs-lookup"><span data-stu-id="4ae05-106">For a list of counters and their formulas, see the Counter Types section of the [Windows Server 2003 Deployment Kit](/previous-versions/windows/it-pro/windows-server-2003/cc776490(v=ws.10)).</span></span>

<span data-ttu-id="4ae05-107">[收集效能資料](collecting-performance-data.md) 會顯示如何取出範例資料。</span><span class="sxs-lookup"><span data-stu-id="4ae05-107">[Collecting Performance Data](collecting-performance-data.md) shows how to retrieve sample data.</span></span> <span data-ttu-id="4ae05-108">擁有範例之後，您通常會呼叫 [**PdhGetFormattedCounterValue**](/windows/desktop/api/Pdh/nf-pdh-pdhgetformattedcountervalue) 來計算可顯示的值。</span><span class="sxs-lookup"><span data-stu-id="4ae05-108">Once you have the samples, you typically call [**PdhGetFormattedCounterValue**](/windows/desktop/api/Pdh/nf-pdh-pdhgetformattedcountervalue) to calculate a displayable value.</span></span>

<span data-ttu-id="4ae05-109">如果您需要向上或向下調整計數器值以顯示值，請在呼叫 [**PdhGetFormattedCounterValue**](/windows/desktop/api/Pdh/nf-pdh-pdhgetformattedcountervalue)之前呼叫 [**PdhSetCounterScaleFactor**](/windows/desktop/api/Pdh/nf-pdh-pdhsetcounterscalefactor)函數。</span><span class="sxs-lookup"><span data-stu-id="4ae05-109">If you need to scale the counter value up or down in order to display the value, call the [**PdhSetCounterScaleFactor**](/windows/desktop/api/Pdh/nf-pdh-pdhsetcounterscalefactor) function before calling [**PdhGetFormattedCounterValue**](/windows/desktop/api/Pdh/nf-pdh-pdhgetformattedcountervalue).</span></span> <span data-ttu-id="4ae05-110">計數器值可以使用從-7 到7的10倍的乘冪來調整。</span><span class="sxs-lookup"><span data-stu-id="4ae05-110">Counter values can be scaled by a power of ten from a factor of -7 to 7.</span></span>

<span data-ttu-id="4ae05-111">如果計數器路徑包含實例名稱的萬用字元，請呼叫 [**PdhGetFormattedCounterArray**](/windows/desktop/api/Pdh/nf-pdh-pdhgetformattedcounterarraya) ，以抓取每個所收集實例的格式化計數器值陣列。</span><span class="sxs-lookup"><span data-stu-id="4ae05-111">If the counter path contains a wildcard character for the instance name, call [**PdhGetFormattedCounterArray**](/windows/desktop/api/Pdh/nf-pdh-pdhgetformattedcounterarraya) to retrieve an array of formatted counter values for each instance collected.</span></span>

<span data-ttu-id="4ae05-112">您也可以使用 [**PdhCalculateCounterFromRawValue**](/windows/desktop/api/Pdh/nf-pdh-pdhcalculatecounterfromrawvalue) 和 [**PdhFormatFromRawValue**](/windows/desktop/api/Pdh/nf-pdh-pdhformatfromrawvalue) 函數來計算可顯示的值。</span><span class="sxs-lookup"><span data-stu-id="4ae05-112">You can also use the [**PdhCalculateCounterFromRawValue**](/windows/desktop/api/Pdh/nf-pdh-pdhcalculatecounterfromrawvalue) and [**PdhFormatFromRawValue**](/windows/desktop/api/Pdh/nf-pdh-pdhformatfromrawvalue) functions to compute a displayable value.</span></span> <span data-ttu-id="4ae05-113">若要使用這些函式，您必須在每個 [**PdhCollectQueryData**](/windows/desktop/api/Pdh/nf-pdh-pdhcollectquerydata) 呼叫之後取得收集的範例，並自行儲存範例。</span><span class="sxs-lookup"><span data-stu-id="4ae05-113">To use these functions, you must retrieve the collected sample after each [**PdhCollectQueryData**](/windows/desktop/api/Pdh/nf-pdh-pdhcollectquerydata) call and store the sample yourself.</span></span> <span data-ttu-id="4ae05-114">若要取得範例，請呼叫 [**PdhGetRawCounterValue**](/windows/desktop/api/Pdh/nf-pdh-pdhgetrawcountervalue) 或 [**PdhGetRawCounterArray**](/windows/desktop/api/Pdh/nf-pdh-pdhgetrawcounterarraya) 函數。</span><span class="sxs-lookup"><span data-stu-id="4ae05-114">To retrieve the sample, call the [**PdhGetRawCounterValue**](/windows/desktop/api/Pdh/nf-pdh-pdhgetrawcountervalue) or [**PdhGetRawCounterArray**](/windows/desktop/api/Pdh/nf-pdh-pdhgetrawcounterarraya) function.</span></span> <span data-ttu-id="4ae05-115">針對以時間為基礎的計數器值，請在 **PdhFormatFromRawValue** 之前呼叫 [**PdhGetCounterTimeBase**](/windows/desktop/api/Pdh/nf-pdh-pdhgetcountertimebase) ，以取得計數器的時間基底。</span><span class="sxs-lookup"><span data-stu-id="4ae05-115">For time-based counter values, call [**PdhGetCounterTimeBase**](/windows/desktop/api/Pdh/nf-pdh-pdhgetcountertimebase) before **PdhFormatFromRawValue** to retrieve the counter's time base.</span></span>

<span data-ttu-id="4ae05-116">如果您使用原始資料執行計算，請務必先檢查 [**PDH \_ 原始 \_ 計數器**](/windows/desktop/api/Pdh/ns-pdh-pdh_raw_counter)結構的 **CStatus** 成員，再使用範例。</span><span class="sxs-lookup"><span data-stu-id="4ae05-116">If you perform calculations using the raw data, always check the **CStatus** member of the [**PDH\_RAW\_COUNTER**](/windows/desktop/api/Pdh/ns-pdh-pdh_raw_counter) structure before using the sample.</span></span> <span data-ttu-id="4ae05-117">如果 **CStatus** 的值不是 pdh \_ CStatus \_ 新 \_ 資料或 pdh \_ CStatus \_ 有效 \_ 的資料，此範例就無效。</span><span class="sxs-lookup"><span data-stu-id="4ae05-117">The sample is not valid if the value of **CStatus** is not PDH\_CSTATUS\_NEW\_DATA or PDH\_CSTATUS\_VALID\_DATA.</span></span>

## <a name="displaying-statistics-for-a-counter"></a><span data-ttu-id="4ae05-118">顯示計數器的統計資料</span><span class="sxs-lookup"><span data-stu-id="4ae05-118">Displaying statistics for a counter</span></span>

<span data-ttu-id="4ae05-119">如果您想要計算計數器的最小值、最大值和平均值，請呼叫 [**PdhComputeCounterStatistics**](/windows/desktop/api/Pdh/nf-pdh-pdhcomputecounterstatistics) 函數。</span><span class="sxs-lookup"><span data-stu-id="4ae05-119">If you want to compute the minimum, maximum, and mean values of a counter, call the [**PdhComputeCounterStatistics**](/windows/desktop/api/Pdh/nf-pdh-pdhcomputecounterstatistics) function.</span></span> <span data-ttu-id="4ae05-120">當您收集範例時，請將 [**PDH \_ 原始 \_ 計數器**](/windows/desktop/api/Pdh/ns-pdh-pdh_raw_counter) 結構儲存在您傳遞至 **PdhComputeCounterStatistics** 的陣列中。</span><span class="sxs-lookup"><span data-stu-id="4ae05-120">When you collect samples, store the [**PDH\_RAW\_COUNTER**](/windows/desktop/api/Pdh/ns-pdh-pdh_raw_counter) structures in an array that you pass to **PdhComputeCounterStatistics**.</span></span> <span data-ttu-id="4ae05-121">函數會傳回 [**PDH \_ 統計資料**](/windows/desktop/api/Pdh/ns-pdh-pdh_statistics) 結構中的統計值。</span><span class="sxs-lookup"><span data-stu-id="4ae05-121">The function returns the statistical values in a [**PDH\_STATISTICS**](/windows/desktop/api/Pdh/ns-pdh-pdh_statistics) structure.</span></span>

<span data-ttu-id="4ae05-122">您也可以使用此函數來壓縮記錄檔。</span><span class="sxs-lookup"><span data-stu-id="4ae05-122">You can also use this function to compress a log file.</span></span> <span data-ttu-id="4ae05-123">例如，從記錄檔讀取十筆記錄、呼叫 [**PdhComputeCounterStatistics**](/windows/desktop/api/Pdh/nf-pdh-pdhcomputecounterstatistics) 來計算平均值，然後將 mean 值寫入輸出記錄檔。</span><span class="sxs-lookup"><span data-stu-id="4ae05-123">For example, read ten records from a log file, call [**PdhComputeCounterStatistics**](/windows/desktop/api/Pdh/nf-pdh-pdhcomputecounterstatistics) to compute the mean value and then write the mean value to an output log file.</span></span>

 

 
