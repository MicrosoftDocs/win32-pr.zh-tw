---
description: PDH 函式的傳回值表示函式呼叫成功或失敗，這與計數器資料的狀態不同。
ms.assetid: 00ea5521-bc28-4a87-aba9-46c911631503
title: 檢查計數器資料狀態碼
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 7daed51ba6e8df385170b9a23b419267409ef497
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/07/2021
ms.locfileid: "106982426"
---
# <a name="checking-counter-data-status-codes"></a><span data-ttu-id="ebf85-103">檢查計數器資料狀態碼</span><span class="sxs-lookup"><span data-stu-id="ebf85-103">Checking Counter Data Status Codes</span></span>

<span data-ttu-id="ebf85-104">PDH 函式的傳回值表示函式呼叫成功或失敗，這與計數器資料的狀態不同。</span><span class="sxs-lookup"><span data-stu-id="ebf85-104">The return value of PDH functions indicates the success or failure of the function call, which is different from the status of the counter data.</span></span> <span data-ttu-id="ebf85-105">請一律檢查 PDH 結構中所傳回之計數器值的 **CStatus** 成員，以確保傳回的資料在使用之前都是有效的。</span><span class="sxs-lookup"><span data-stu-id="ebf85-105">Always check the **CStatus** member of a counter value returned in the PDH structures to ensure that the data returned is valid before you use it.</span></span> <span data-ttu-id="ebf85-106">如果 **CStatus** 成員的值未表示成功，請不要使用資料。</span><span class="sxs-lookup"><span data-stu-id="ebf85-106">If the value of the **CStatus** member does not indicate success, do not use the data.</span></span> <span data-ttu-id="ebf85-107">以下是計數器的可能狀態值：</span><span class="sxs-lookup"><span data-stu-id="ebf85-107">The following are the possible status values for counters:</span></span>



| <span data-ttu-id="ebf85-108">值</span><span class="sxs-lookup"><span data-stu-id="ebf85-108">Value</span></span>                              | <span data-ttu-id="ebf85-109">意義</span><span class="sxs-lookup"><span data-stu-id="ebf85-109">Meaning</span></span>                                                                                                                                                                                                                                                                                                                                                                          |
|------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="ebf85-110">PDH \_ CSTATUS \_ 沒有 \_ 電腦</span><span class="sxs-lookup"><span data-stu-id="ebf85-110">PDH\_CSTATUS\_NO\_MACHINE</span></span>          | <span data-ttu-id="ebf85-111">PDH 無法連接到計數器路徑中指定的電腦。</span><span class="sxs-lookup"><span data-stu-id="ebf85-111">PDH was unable to connect to the computer specified in the counter path.</span></span> <span data-ttu-id="ebf85-112">如果在加入計數器時傳回此狀態，則不會完全初始化計數器。</span><span class="sxs-lookup"><span data-stu-id="ebf85-112">If this status is returned when the counter is being added, the counter is not completely initialized.</span></span> <span data-ttu-id="ebf85-113">每次更新查詢時，PDH 會重試連接。</span><span class="sxs-lookup"><span data-stu-id="ebf85-113">Each time the query is updated, PDH retries the connection.</span></span> <span data-ttu-id="ebf85-114">建立連線時，會繼續正常的資料收集。</span><span class="sxs-lookup"><span data-stu-id="ebf85-114">When the connection is established, normal data collection resumes.</span></span>                                                                  |
| <span data-ttu-id="ebf85-115">PDH \_ CSTATUS \_ 沒有 \_ 物件</span><span class="sxs-lookup"><span data-stu-id="ebf85-115">PDH\_CSTATUS\_NO\_OBJECT</span></span>           | <span data-ttu-id="ebf85-116">找到指定的電腦，但在電腦上找到指定的效能物件。</span><span class="sxs-lookup"><span data-stu-id="ebf85-116">The specified computer was found, but the specified performance object was found on the computer.</span></span> <span data-ttu-id="ebf85-117">如果在加入計數器時傳回此狀態，指定的計數器就不會包含在查詢中。</span><span class="sxs-lookup"><span data-stu-id="ebf85-117">If this status is returned when the counter is being added, the specified counter is not included in the query.</span></span> <span data-ttu-id="ebf85-118">如果作用中的計數器傳回此狀態，則該計數器的資料無效。</span><span class="sxs-lookup"><span data-stu-id="ebf85-118">If this status is returned by an active counter, the data for that counter is invalid.</span></span> <span data-ttu-id="ebf85-119">每次要求資料時，PDH 都會嘗試取得此計數器資料。</span><span class="sxs-lookup"><span data-stu-id="ebf85-119">Each time the data is requested, PDH tries to obtain this counter data.</span></span> |
| <span data-ttu-id="ebf85-120">PDH \_ CSTATUS \_ 沒有 \_ 實例</span><span class="sxs-lookup"><span data-stu-id="ebf85-120">PDH\_CSTATUS\_NO\_INSTANCE</span></span>         | <span data-ttu-id="ebf85-121">在物件中找不到指定的實例。</span><span class="sxs-lookup"><span data-stu-id="ebf85-121">The specified instance was not found in the object.</span></span> <span data-ttu-id="ebf85-122">如果在將計數器新增至查詢時傳回此狀態，則會成功將計數器新增至查詢，但在特定實例出現並傳回成功狀態之前，不會有任何可用的資料。</span><span class="sxs-lookup"><span data-stu-id="ebf85-122">If this status is returned while the counter is being added to the query, the counter is successfully added to the query, but no data is available until the specific instance appears and a successful status is returned.</span></span>                                                                                                  |
| <span data-ttu-id="ebf85-123">PDH \_ CSTATUS \_ 沒有 \_ 計數器</span><span class="sxs-lookup"><span data-stu-id="ebf85-123">PDH\_CSTATUS\_NO\_COUNTER</span></span>          | <span data-ttu-id="ebf85-124">在指定的物件中找不到指定的計數器。</span><span class="sxs-lookup"><span data-stu-id="ebf85-124">The specified counter was not found in the specified object.</span></span> <span data-ttu-id="ebf85-125">如果在加入計數器時傳回此狀態，則不會將計數器新增至查詢。</span><span class="sxs-lookup"><span data-stu-id="ebf85-125">If this status is returned when the counter is being added, then the counter is not added to the query.</span></span> <span data-ttu-id="ebf85-126">如果在資料收集之後傳回此狀態，則該計數器的資料無效。</span><span class="sxs-lookup"><span data-stu-id="ebf85-126">If this status is returned after data collection, the data for that counter is invalid.</span></span> <span data-ttu-id="ebf85-127">每次要求資料時，PDH 都會嘗試取得此計數器資料。</span><span class="sxs-lookup"><span data-stu-id="ebf85-127">Each time the data is requested, PDH tries to obtain this counter data.</span></span>                                             |
| <span data-ttu-id="ebf85-128">PDH \_ CSTATUS \_ 不正確 \_ 資料</span><span class="sxs-lookup"><span data-stu-id="ebf85-128">PDH\_CSTATUS\_INVALID\_DATA</span></span>        | <span data-ttu-id="ebf85-129">已成功找到計數器，但傳回的資料無效。</span><span class="sxs-lookup"><span data-stu-id="ebf85-129">The counter was successfully found, but the data returned is not valid.</span></span> <span data-ttu-id="ebf85-130">如果計數器值小於先前的值，就會發生這個錯誤。</span><span class="sxs-lookup"><span data-stu-id="ebf85-130">This error can occur if the counter value is less than the previous value.</span></span> <span data-ttu-id="ebf85-131"> (因為計數器值一律會遞增，所以計數器值會在達到其最大值時，變換為零。 ) 另一個可能的原因是不正確的系統計時器。</span><span class="sxs-lookup"><span data-stu-id="ebf85-131">(Because counter values always increment, the counter value rolls over to zero when it reaches its maximum value.) Another possible cause is a system timer that is not correct.</span></span>                                              |
| <span data-ttu-id="ebf85-132">PDH \_ CSTATUS \_ 有效 \_ 資料</span><span class="sxs-lookup"><span data-stu-id="ebf85-132">PDH\_CSTATUS\_VALID\_DATA</span></span>          | <span data-ttu-id="ebf85-133">已成功傳回計數器的資料，但自上次讀取計數器時並未變更。</span><span class="sxs-lookup"><span data-stu-id="ebf85-133">The data for the counter was returned successfully, but is unchanged from the last time the counter was read.</span></span>                                                                                                                                                                                                                                                                    |
| <span data-ttu-id="ebf85-134">PDH \_ CSTATUS \_ 新 \_ 資料</span><span class="sxs-lookup"><span data-stu-id="ebf85-134">PDH\_CSTATUS\_NEW\_DATA</span></span>            | <span data-ttu-id="ebf85-135">計數器的資料已成功傳回，與上次讀取計數器的時間不同。</span><span class="sxs-lookup"><span data-stu-id="ebf85-135">The data for the counter was returned successfully and is different from the last time the counter was read.</span></span> <span data-ttu-id="ebf85-136">\_ \_ \_ 即使產生的速率與上一個範例相同，也可以在速率計數器上傳回 PDH CSTATUS 的新資料。</span><span class="sxs-lookup"><span data-stu-id="ebf85-136">PDH\_CSTATUS\_NEW\_DATA can be returned on a rate counter even if the resulting rate is the same as the last sample.</span></span> <span data-ttu-id="ebf85-137">這是因為用來判斷此狀態值的原始資料值已變更，而不是計算的速率。</span><span class="sxs-lookup"><span data-stu-id="ebf85-137">This is because the raw data value that is used in the determination of this status value has changed, not the computed rate.</span></span>                  |
| <span data-ttu-id="ebf85-138">PDH \_ 更多 \_ 資料</span><span class="sxs-lookup"><span data-stu-id="ebf85-138">PDH\_MORE\_DATA</span></span>                    | <span data-ttu-id="ebf85-139">提供的緩衝區不夠大，無法儲存所有計數器資料。</span><span class="sxs-lookup"><span data-stu-id="ebf85-139">The supplied buffer was not large enough to store all of the counter data.</span></span> <span data-ttu-id="ebf85-140">配置較大的緩衝區，然後再次執行函數。</span><span class="sxs-lookup"><span data-stu-id="ebf85-140">Allocate a larger buffer and execute the function again.</span></span>                                                                                                                                                                                                                                              |
| <span data-ttu-id="ebf85-141">PDH \_ CSTATUS \_ 專案 \_ 未 \_ 通過驗證</span><span class="sxs-lookup"><span data-stu-id="ebf85-141">PDH\_CSTATUS\_ITEM\_NOT\_VALIDATED</span></span> | <span data-ttu-id="ebf85-142">計數器已新增至查詢，但尚未經過驗證或存取。</span><span class="sxs-lookup"><span data-stu-id="ebf85-142">The counter has been added to the query, but has not been validated nor accessed.</span></span> <span data-ttu-id="ebf85-143">沒有此計數器的其他狀態資訊可供使用。</span><span class="sxs-lookup"><span data-stu-id="ebf85-143">No additional status information on this counter is available.</span></span>                                                                                                                                                                                                                                 |
| <span data-ttu-id="ebf85-144">PDH \_ CSTATUS \_ 沒有 \_ COUNTERNAME</span><span class="sxs-lookup"><span data-stu-id="ebf85-144">PDH\_CSTATUS\_NO\_COUNTERNAME</span></span>      | <span data-ttu-id="ebf85-145">未在查詢中指定任何計數器名稱。</span><span class="sxs-lookup"><span data-stu-id="ebf85-145">No counter name was specified in the query.</span></span>                                                                                                                                                                                                                                                                                                                                      |
| <span data-ttu-id="ebf85-146">PDH \_ CSTATUS \_ 沒有 \_ 計數器</span><span class="sxs-lookup"><span data-stu-id="ebf85-146">PDH\_CSTATUS\_NO\_COUNTER</span></span>          | <span data-ttu-id="ebf85-147">找不到指定的計數器名稱。</span><span class="sxs-lookup"><span data-stu-id="ebf85-147">The specified counter name could not be found.</span></span>                                                                                                                                                                                                                                                                                                                                   |
| <span data-ttu-id="ebf85-148">PDH \_ CSTATUS \_ 沒有 \_ 物件</span><span class="sxs-lookup"><span data-stu-id="ebf85-148">PDH\_CSTATUS\_NO\_OBJECT</span></span>           | <span data-ttu-id="ebf85-149">找不到指定的效能物件。</span><span class="sxs-lookup"><span data-stu-id="ebf85-149">The specified performance object could not be found.</span></span>                                                                                                                                                                                                                                                                                                                             |
| <span data-ttu-id="ebf85-150">PDH \_ 計算 \_ 負 \_ 分母</span><span class="sxs-lookup"><span data-stu-id="ebf85-150">PDH\_CALC\_NEGATIVE\_DENOMINATOR</span></span>   | <span data-ttu-id="ebf85-151">計數器的分母值是負的。</span><span class="sxs-lookup"><span data-stu-id="ebf85-151">A counter has a negative denominator value.</span></span>                                                                                                                                                                                                                                                                                                                                      |
| <span data-ttu-id="ebf85-152">PDH 計算負的時間 \_ \_ \_ 基數</span><span class="sxs-lookup"><span data-stu-id="ebf85-152">PDH\_CALC\_NEGATIVE\_TIMEBASE</span></span>      | <span data-ttu-id="ebf85-153">計數器的時間基數值為負數。</span><span class="sxs-lookup"><span data-stu-id="ebf85-153">A counter has a negative timebase value.</span></span>                                                                                                                                                                                                                                                                                                                                         |
| <span data-ttu-id="ebf85-154">PDH \_ 計算 \_ 負 \_ 數值</span><span class="sxs-lookup"><span data-stu-id="ebf85-154">PDH\_CALC\_NEGATIVE\_VALUE</span></span>         | <span data-ttu-id="ebf85-155">計數器的值為負值。</span><span class="sxs-lookup"><span data-stu-id="ebf85-155">A counter has a negative value.</span></span>                                                                                                                                                                                                                                                                                                                                                  |
| <span data-ttu-id="ebf85-156">PDH \_ CSTATUS \_ 沒有 \_ COUNTERNAME</span><span class="sxs-lookup"><span data-stu-id="ebf85-156">PDH\_CSTATUS\_NO\_COUNTERNAME</span></span>      | <span data-ttu-id="ebf85-157">未指定任何計數器路徑。</span><span class="sxs-lookup"><span data-stu-id="ebf85-157">No counter path was specified.</span></span>                                                                                                                                                                                                                                                                                                                                                   |
| <span data-ttu-id="ebf85-158">PDH \_ CSTATUS \_ 不良 \_ COUNTERNAME</span><span class="sxs-lookup"><span data-stu-id="ebf85-158">PDH\_CSTATUS\_BAD\_COUNTERNAME</span></span>     | <span data-ttu-id="ebf85-159">計數器路徑格式不正確。</span><span class="sxs-lookup"><span data-stu-id="ebf85-159">The counter path format is incorrect.</span></span>                                                                                                                                                                                                                                                                                                                                            |



 

 

 



