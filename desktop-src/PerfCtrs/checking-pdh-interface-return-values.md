---
description: PDH 函式的傳回值表示函式呼叫成功或失敗，這與計數器資料的狀態不同。
ms.assetid: 00ea5521-bc28-4a87-aba9-46c911631503
title: 檢查計數器資料狀態碼
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: a34c433e1c45badd3a2211a0e53051ad40d495f63a67b0ca509ae74a5cd99972
ms.sourcegitcommit: e6600f550f79bddfe58bd4696ac50dd52cb03d7e
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/11/2021
ms.locfileid: "119978878"
---
# <a name="checking-counter-data-status-codes"></a>檢查計數器資料狀態碼

PDH 函式的傳回值表示函式呼叫成功或失敗，這與計數器資料的狀態不同。 請一律檢查 PDH 結構中所傳回之計數器值的 **CStatus** 成員，以確保傳回的資料在使用之前都是有效的。 如果 **CStatus** 成員的值未表示成功，請不要使用資料。 以下是計數器的可能狀態值：



| 值                              | 意義                                                                                                                                                                                                                                                                                                                                                                          |
|------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| PDH \_ CSTATUS \_ 沒有 \_ 電腦          | PDH 無法連接到計數器路徑中指定的電腦。 如果在加入計數器時傳回此狀態，則不會完全初始化計數器。 每次更新查詢時，PDH 會重試連接。 建立連線時，會繼續正常的資料收集。                                                                  |
| PDH \_ CSTATUS \_ 沒有 \_ 物件           | 找到指定的電腦，但在電腦上找到指定的效能物件。 如果在加入計數器時傳回此狀態，指定的計數器就不會包含在查詢中。 如果作用中的計數器傳回此狀態，則該計數器的資料無效。 每次要求資料時，PDH 都會嘗試取得此計數器資料。 |
| PDH \_ CSTATUS \_ 沒有 \_ 實例         | 在物件中找不到指定的實例。 如果在將計數器新增至查詢時傳回此狀態，則會成功將計數器新增至查詢，但在特定實例出現並傳回成功狀態之前，不會有任何可用的資料。                                                                                                  |
| PDH \_ CSTATUS \_ 沒有 \_ 計數器          | 在指定的物件中找不到指定的計數器。 如果在加入計數器時傳回此狀態，則不會將計數器新增至查詢。 如果在資料收集之後傳回此狀態，則該計數器的資料無效。 每次要求資料時，PDH 都會嘗試取得此計數器資料。                                             |
| PDH \_ CSTATUS \_ 不正確 \_ 資料        | 已成功找到計數器，但傳回的資料無效。 如果計數器值小於先前的值，就會發生這個錯誤。  (因為計數器值一律會遞增，所以計數器值會在達到其最大值時，變換為零。 ) 另一個可能的原因是不正確的系統計時器。                                              |
| PDH \_ CSTATUS \_ 有效 \_ 資料          | 已成功傳回計數器的資料，但自上次讀取計數器時並未變更。                                                                                                                                                                                                                                                                    |
| PDH \_ CSTATUS \_ 新 \_ 資料            | 計數器的資料已成功傳回，與上次讀取計數器的時間不同。 \_ \_ \_ 即使產生的速率與上一個範例相同，也可以在速率計數器上傳回 PDH CSTATUS 的新資料。 這是因為用來判斷此狀態值的原始資料值已變更，而不是計算的速率。                  |
| PDH \_ 更多 \_ 資料                    | 提供的緩衝區不夠大，無法儲存所有計數器資料。 配置較大的緩衝區，然後再次執行函數。                                                                                                                                                                                                                                              |
| PDH \_ CSTATUS \_ 專案 \_ 未 \_ 通過驗證 | 計數器已新增至查詢，但尚未經過驗證或存取。 沒有此計數器的其他狀態資訊可供使用。                                                                                                                                                                                                                                 |
| PDH \_ CSTATUS \_ 沒有 \_ COUNTERNAME      | 未在查詢中指定任何計數器名稱。                                                                                                                                                                                                                                                                                                                                      |
| PDH \_ CSTATUS \_ 沒有 \_ 計數器          | 找不到指定的計數器名稱。                                                                                                                                                                                                                                                                                                                                   |
| PDH \_ CSTATUS \_ 沒有 \_ 物件           | 找不到指定的效能物件。                                                                                                                                                                                                                                                                                                                             |
| PDH \_ 計算 \_ 負 \_ 分母   | 計數器的分母值是負的。                                                                                                                                                                                                                                                                                                                                      |
| PDH 計算負的時間 \_ \_ \_ 基數      | 計數器的時間基數值為負數。                                                                                                                                                                                                                                                                                                                                         |
| PDH \_ 計算 \_ 負 \_ 數值         | 計數器的值為負值。                                                                                                                                                                                                                                                                                                                                                  |
| PDH \_ CSTATUS \_ 沒有 \_ COUNTERNAME      | 未指定任何計數器路徑。                                                                                                                                                                                                                                                                                                                                                   |
| PDH \_ CSTATUS \_ 不良 \_ COUNTERNAME     | 計數器路徑格式不正確。                                                                                                                                                                                                                                                                                                                                            |



 

 

 



