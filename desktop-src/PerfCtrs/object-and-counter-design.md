---
description: 效能物件是可使用效能資料的實體。
ms.assetid: 97b9c9ec-e758-4928-b3fa-90d220bca5fb
title: 物件和計數器設計
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 9556882f5dd6c323697d9d41fa80727895550a5d
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/07/2021
ms.locfileid: "103944258"
---
# <a name="object-and-counter-design"></a><span data-ttu-id="94660-103">物件和計數器設計</span><span class="sxs-lookup"><span data-stu-id="94660-103">Object and Counter Design</span></span>

<span data-ttu-id="94660-104">效能物件是可使用效能資料的實體。</span><span class="sxs-lookup"><span data-stu-id="94660-104">A performance object is an entity for which performance data is available.</span></span> <span data-ttu-id="94660-105">效能計數器會定義效能物件可用的資料類型。</span><span class="sxs-lookup"><span data-stu-id="94660-105">Performance counters define the type of data that is available for a performance object.</span></span> <span data-ttu-id="94660-106">應用程式可提供多個效能物件的資訊。</span><span class="sxs-lookup"><span data-stu-id="94660-106">An application can provide information for multiple performance objects.</span></span> <span data-ttu-id="94660-107">效能物件可以包含單一實例計數器或多個實例計數器。</span><span class="sxs-lookup"><span data-stu-id="94660-107">Performance objects can contain either single instance counters or multiple instance counters.</span></span> <span data-ttu-id="94660-108">單一實例物件會傳回一組計數器值。</span><span class="sxs-lookup"><span data-stu-id="94660-108">A single instance object returns a single set of counter values.</span></span>

<span data-ttu-id="94660-109">多個實例物件會針對每個應用程式所控制的物件，傳回物件的實例。</span><span class="sxs-lookup"><span data-stu-id="94660-109">A multiple instance object returns an instance of the object for each occurrence of the object that the application controls.</span></span> <span data-ttu-id="94660-110">例如，SCSI 應用程式可以定義具有兩個計數器的磁片磁碟機物件，例如讀取的位元組和寫入位元組。</span><span class="sxs-lookup"><span data-stu-id="94660-110">For example, a SCSI application could define a drive object with two counters, such as Bytes Read and Bytes Written.</span></span> <span data-ttu-id="94660-111">當取用者查詢物件時，效能 DLL 會針對應用程式所控制的每個磁片磁碟機，傳回物件的實例。</span><span class="sxs-lookup"><span data-stu-id="94660-111">When the consumer queries the object, the performance DLL returns an instance of the object for each drive that the application controls.</span></span>

<span data-ttu-id="94660-112">決定您的物件是否支援單一實例或多個實例之後，您必須決定要讓物件提供的計數器類型。</span><span class="sxs-lookup"><span data-stu-id="94660-112">After deciding if your object supports a single instance or multiple instances, you need to decide on the type of counters that you want the object to provide.</span></span> <span data-ttu-id="94660-113">例如，您可以提供顯示為原始值、費率或百分比的計數器值。</span><span class="sxs-lookup"><span data-stu-id="94660-113">For example, you can provide counter values that are displayed as raw values, as rates, or as percentages.</span></span>

<span data-ttu-id="94660-114">如需您應從中選擇之預先定義計數器類型的清單，請參閱 [Windows Server 2003 部署套件](/previous-versions/windows/it-pro/windows-server-2003/cc776490(v=ws.10))的「計數器類型」一節。</span><span class="sxs-lookup"><span data-stu-id="94660-114">For a list of predefined counter types that you should choose from, see the Counter Types section of the [Windows Server 2003 Deployment Kit](/previous-versions/windows/it-pro/windows-server-2003/cc776490(v=ws.10)).</span></span> <span data-ttu-id="94660-115">視計數器類型而定，您可以直接提供原始資料，也可能必須提供時間和頻率資訊，以及取用者用來計算可顯示值的額外計數器資料。</span><span class="sxs-lookup"><span data-stu-id="94660-115">Depending on the counter type, you may simply provide the raw data, or you may also have to provide time and frequency information and additional counter data used by the consumer to calculate a displayable value.</span></span>

<span data-ttu-id="94660-116">您用來收集資料的方法可以像在每次呼叫應用程式中的特定常式時遞增計數器一樣簡單，也可能牽涉到耗時的計算。</span><span class="sxs-lookup"><span data-stu-id="94660-116">The method you use to collect the data can be as simple as incrementing a counter each time a particular routine in the application is called, or it can involve time-consuming calculations.</span></span> <span data-ttu-id="94660-117">計數器和計時器應該遞增，而且永遠不會清除。</span><span class="sxs-lookup"><span data-stu-id="94660-117">Counters and timers should increment and never be cleared.</span></span> <span data-ttu-id="94660-118">計數器可以換行，只要它們不會在取用者取樣之間進行兩次。</span><span class="sxs-lookup"><span data-stu-id="94660-118">Counters can wrap, as long as they do not wrap twice between being sampled by the consumer.</span></span> <span data-ttu-id="94660-119">只要應用程式不會影響其效能，您的應用程式就可以在其正常執行期間收集和儲存資料。</span><span class="sxs-lookup"><span data-stu-id="94660-119">Your application can collect and store data during its normal execution, as long as it does not affect its performance.</span></span>

<span data-ttu-id="94660-120">針對某些類型的資料，視需要收集資料可能更有效率或更適當。</span><span class="sxs-lookup"><span data-stu-id="94660-120">For some types of data, it may be more efficient or appropriate to collect the data on demand.</span></span> <span data-ttu-id="94660-121">在這種情況下，效能 DLL 必須與已要求資料的應用程式進行通訊。</span><span class="sxs-lookup"><span data-stu-id="94660-121">In this situation, the performance DLL must communicate to the application that the data has been requested.</span></span> <span data-ttu-id="94660-122">針對 () 處理器時間或記憶體使用量來收集的資料，請考慮只在取用者要求 **昂貴** 的資料時收集資料。</span><span class="sxs-lookup"><span data-stu-id="94660-122">For data that is expensive to collect (in terms of processor time or memory usage), consider collecting data only when the consumer requests **Costly** data.</span></span> <span data-ttu-id="94660-123">這可讓取用者定期要求所有不昂貴的計數器資料。</span><span class="sxs-lookup"><span data-stu-id="94660-123">This allows a consumer to routinely request data for all counters that are not costly.</span></span> <span data-ttu-id="94660-124">只有在需要時，才可以要求資料。</span><span class="sxs-lookup"><span data-stu-id="94660-124">The data can be requested only when needed.</span></span> <span data-ttu-id="94660-125">效能工具不會收集 **成本高昂** 的資料。</span><span class="sxs-lookup"><span data-stu-id="94660-125">The Performance tool does not collect **Costly** data.</span></span>

 

 
