---
description: 說明的 MUI 基本概念
ms.assetid: 9ab19a56-4d31-471d-949e-a539751b62e3
title: 說明的 MUI 基本概念
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 82dbeedb246944bef6c23c739eafddff86423b35
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/07/2021
ms.locfileid: "103943676"
---
# <a name="mui-fundamental-concepts-explained"></a>說明的 MUI 基本概念

-   [MUI 的先決條件](#prerequisite-for-mui)
-   [分隔原始程式碼與特定語言的資源](#separation-of-source-code-from-language-specific-resources)
    -   [早期的程式碼和資源會一起運作](#the-early-days-code-and-resources-live-together)
    -   [以邏輯方式分隔程式碼和可當地語系化的資源](#logically-separating-code-and-localizable-resources)
    -   [實際分隔程式碼和資源](#physically-separating-code-and-resources)
-   [以動態方式載入特定語言的資源](#dynamically-loading-language-specific-resources)
-   [建立 MUI 應用程式](#building-mui-applications)

## <a name="prerequisite-for-mui"></a>MUI 的先決條件

建立適用于 Windows Vista 和以上的 MUI 相容應用程式的基本必要條件是根據 Windows [全球化指導方針](https://msdn.microsoft.com/goglobal/bb688110.aspx)來設計應用程式。

## <a name="separation-of-source-code-from-language-specific-resources"></a>分隔原始程式碼與特定語言的資源

MUI 技術的其中一個基本部署是將應用程式原始程式碼與特定語言的資源分開，以便更有效率地在應用程式中啟用多語言案例。 程式碼和資源的分隔是透過不同的機制，以及一段時間內的不同角度來達成，如下列各節所述。 每個方法都提供了不同程度的彈性來建立、部署及服務應用程式。

適用于 MUI 規範之應用程式的建議解決方案是此處所述的最後一種方法，也就是應用程式原始程式碼和資源的實體分隔，其資源本身會進一步細分為每個支援的語言，以獲得最大的建立、部署和服務彈性。

### <a name="the-early-days-code-and-resources-live-together"></a>早期的程式碼和資源會一起運作

一開始，當地語系化的應用程式是透過編輯原始程式碼和變更資源來建立， (通常是程式碼中) 的字串，然後重新編譯應用程式。 這表示若要產生當地語系化的版本，您必須複製原始原始程式碼、將文字 (資源轉譯為原始程式碼中的) 元素，然後重新編譯程式碼。 下圖顯示需要當地語系化之文字的應用程式程式碼。

![顯示應用程式的概念圖表，其中包含內嵌文字資源的單位](images/mui-fundamental-concepts-explained-fig3.gif)

雖然這種方法可讓您建立當地語系化的應用程式，但它也有很大的缺點：

-   它需要多個版本的原始程式碼，至少一個用於來源語言，另一個適用于每個目的語言。 這會造成將應用程式的不同語言版本同步處理的重大問題。 尤其是，在程式碼中需要修正瑕疵時，每個程式碼的每個複本都需要修正瑕疵 (每一個語言) 。
-   它也很容易發生錯誤，因為它需要當地語系化人員（非開發人員）在原始程式碼中進行修改，因此在程式碼完整性方面創造相當大的風險。

這些缺點的組合使得這項功能極為沒有效率，並且需要更好的模型。

### <a name="logically-separating-code-and-localizable-resources"></a>以邏輯方式分隔程式碼和可當地語系化的資源

上述模型的重大改進，是應用程式程式碼和可當地語系化資源的邏輯分隔。 這會將程式碼與資源隔離，並確保當資源受到當地語系化的變更時，程式碼保持不變。 從執行的觀點來看，字串和其他使用者介面專案會儲存在資源檔中，這種方式相當容易轉譯，而且會以邏輯方式與程式碼區段分開。

在理想的情況下，新增任何特定語言的支援可以像將可當地語系化的資源轉譯成這種新的語言，並使用這些轉譯的資源來建立新的當地語系化版本的應用程式一樣簡單，而不需要修改任何程式碼。 下圖說明如何在應用程式中以邏輯方式分隔程式碼和可當地語系化的資源。

![顯示應用程式的概念圖表，其中包含與程式碼分開的可當地語系化資源](images/mui-fundamental-concepts-explained-fig4.gif)

此模型可讓您更輕鬆地建立當地語系化的應用程式版本，並大幅改善了先前的模型。 此模型是透過使用資源管理工具來實行，多年以來都有很多的經驗，現在許多應用程式也經常使用。 不過，它的確有很大的缺點：

-   在邏輯上分隔的情況下，程式碼和當地語系化的資源仍會實際聯結在一個可執行檔中。 尤其是，因為相同的程式碼缺失 (在所有語言版本中都相同，所以仍有問題，) 需要每種語言的修補程式。 因此，如果某個應用程式是以20種語言傳送應用程式，則必須發出20次的服務修補程式 (每個語言) 一次，即使程式碼只是固定的一次也是一樣。
-   此模型不會適當地支援散發和使用多語言應用程式。 這可能是 OEM 和企業案例中的重大問題。 比方說，如果在兩個使用不同語言的使用者之間共用電腦，則必須使用此模型來安裝應用程式兩次，然後必須啟用某些機制，才能在兩個安裝之間替代。 這假設沒有其他相依性可防止這種情況執行。 下圖顯示需要兩個修補程式的單一程式碼缺失範例。

![顯示兩個具有相同程式碼瑕疵之當地語系化應用程式的概念圖表](images/mui-fundamental-concepts-explained-fig5.gif)

很明顯地，雖然此模型在某些情況下可正常運作，但對於多語言應用程式及其部署的限制可能會有很大的問題。

此模型的變化可緩和某些多語言應用程式問題，這是可當地語系化的資源包含一組不同語言資源的模型。 此模型在相同的應用程式中有通用的程式碼基底和數種不同語言的資源。 例如，應用程式可以在同一個套件中隨附英文、德文、法文、西班牙文、荷蘭文和義大利文。 下圖顯示包含多個語言資源的應用程式。

![顯示應用程式與兩個地區設定專屬資源不同的程式碼的概念圖表](images/mui-fundamental-concepts-explained-fig6.gif)

這種模型可讓您在程式碼缺失需要修正時更輕鬆地為應用程式提供服務（這是一項改善的功能），但在支援其他語言時，不會改善先前的模型。 在此情況下，您仍然需要釋出新版本的應用程式 (而且該版本可能會很複雜，因為必須確保所有語言資源都在相同的散發) 內進行同步處理。

### <a name="physically-separating-code-and-resources"></a>實際分隔程式碼和資源

下一個進化步驟是實際分隔程式碼和資源。 在此模型中，資源會從程式碼抽象化，並實際分隔不同的實檔案。 特別是，這表示程式碼可能會變成與語言無關的真正語言;應用程式的所有當地語系化版本實際上都會隨附相同的實體程式碼。 下圖說明程式碼和可當地語系化的資源必須實體分隔。

![顯示應用程式與可當地語系化資源分開的概念圖表](images/mui-fundamental-concepts-explained-fig7.gif)

這種方法有幾個優點，而不是先前的方法：

-   多語言解決方案的部署大幅簡化。 新增任何指定語言的支援只需要為此特定語言傳送和安裝一組新的語言資源。 當語言資源並非全部都能同時使用時，這一點特別重要。 使用此模型，您可以使用一組核心語言來部署應用程式，並在一段時間後增加支援的語言數目，而不需要修改或重新部署實際的程式碼。 這項優點更進一步延伸，可讓您藉由確保在此慣用語言中找不到的資源「切換回」至使用者也瞭解的另一種語言，以提供指定語言的部分當地語系化應用程式和系統元件。 整體來說，此模型有助於減輕全球公司在部署多個語言的應用程式時所面臨的沉重負擔，因為這可讓您以更有效率的方式來部署單一映射。
-   改良功能已獲得改善。 由於程式碼完全與當地語系化無關，因此只需要修正並部署程式碼缺失。 在此模型中，如果變更與 UI 無關，就會發出程式碼缺失的更正，比先前的任何模型更簡單且符合成本效益。

## <a name="dynamically-loading-language-specific-resources"></a>以動態方式載入特定語言的資源

[從特定語言的資源中實際分隔原始程式碼](#physically-separating-code-and-resources)，以及為應用程式建立非語言相關核心二進位檔的 MUI 基本概念，基本上會設定採用遭利用的架構，以根據使用者和系統語言設定來執行特定語言資源的動態載入。

內建在非語言相關核心二進位檔中的應用程式原始程式碼，可以利用 Windows 平臺中的 MUI Api，針對指定的內容，對適當的顯示使用者介面語言進行抽象化。 MUI 支援這種方式：

-   根據系統、使用者、應用層級、使用者層級和系統層級設定，來建立顯示使用者介面語言的優先順序清單。
-   根據當地語系化資源的可用性，執行可根據已設定優先順序的語言清單選擇適當候選項的回溯機制。

使用優先回復動態載入使用者介面資源的優點如下：

-   它可讓您以指定的語言進行應用程式和系統元件的部分當地語系化，因為在此慣用語言中找不到的資源會自動切換回優先順序清單上的下一個語言。
-   它可讓您從一種語言動態切換到另一種語言。
-   它可讓您建立區域或全球單一部署映射，其中涵蓋一組適用于 Oem 和企業的語言。

## <a name="building-mui-applications"></a>建立 MUI 應用程式

上述各節概述將原始程式碼與特定語言的資源分開的選項，以及能夠利用核心 Windows 平臺 Api 動態載入當地語系化資源的結果優點。 雖然這些都是指導方針，但也應該指出，沒有任何特定的規範方法可開發 Windows 平臺的 MUI 應用程式。

應用程式開發人員可以完整選擇如何處理各種使用者介面語言設定、資源建立選項和資源載入方法。 開發人員可以評估這份檔中所提供的指導方針，並選擇符合其需求和開發環境的組合。

下表摘要說明要為 Windows 平臺建立 MUI 應用程式的應用程式開發人員可使用的各種設計選項。



<table>
<thead>
<tr class="header">
<th>使用者介面語言設定</th>
<th>資源建立</th>
<th>資源載入</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td rowspan="2">遵循作業系統 $ {REMOVE} $ 中的 UI 語言設定<br />
</td>
<td>分割資源二進位檔中的單一語言 (MUI 資源技術) <br/> -或-<br/> 非分割資源二進位檔中的多個語言<br/></td>
<td>應用程式會呼叫標準資源載入功能。 系統會以符合作業系統設定的語言傳回資源。<br/></td>
</tr>
<tr class="even">
<td>應用程式特定的資源機制<br/></td>
<td>應用程式會呼叫 MUI API，從作業系統取出執行緒慣用的 UI 語言或處理常式慣用的 UI 語言，並使用這些設定來載入本身的資源。<br/></td>

</tr>
<tr class="odd">
<td rowspan="2">應用程式特定的 UI 語言設定 $ {REMOVE} $<br />
</td>
<td>分割資源二進位檔中的單一語言<br/> -或-<br/> 非分割資源二進位檔中的多個語言<br/></td>
<td>應用程式會呼叫 MUI API 來設定應用程式特定的 UI 語言或處理常式慣用的 UI 語言，然後呼叫標準資源載入功能。 資源會以應用程式或系統語言所設定的語言傳回。<br/> -或-<br/> 應用程式會探查特定語言的資源，並從抓取的二進位資料處理自己的資源解壓縮。<br/></td>
</tr>
<tr class="even">
<td>應用程式特定的資源機制<br/></td>
<td>應用程式會管理本身的資源載入。<br/></td>

</tr>
</tbody>
</table>



 

 

 




