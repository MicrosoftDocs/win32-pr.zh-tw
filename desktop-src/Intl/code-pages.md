---
description: 現今撰寫的大部分應用程式都是使用 UTF-16 編碼，以 Unicode 來處理字元資料。
ms.assetid: 866f09f4-629e-4097-a974-fbda9389d077
title: 字碼頁
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c28528ba13e3db3f0c72dd7c071eb8b7886ab003
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/08/2021
ms.locfileid: "106983670"
---
# <a name="code-pages"></a><span data-ttu-id="ae94b-103">字碼頁</span><span class="sxs-lookup"><span data-stu-id="ae94b-103">Code Pages</span></span>

<span data-ttu-id="ae94b-104">現今撰寫的大部分應用程式都是使用 UTF-16 編碼，以 [Unicode](unicode.md)來處理字元資料。</span><span class="sxs-lookup"><span data-stu-id="ae94b-104">Most applications written today handle character data primarily as [Unicode](unicode.md), using the UTF-16 encoding.</span></span> <span data-ttu-id="ae94b-105">不過，許多繼承應用程式會根據字碼頁繼續使用字元集。</span><span class="sxs-lookup"><span data-stu-id="ae94b-105">However, many legacy applications continue to use character sets based on code pages.</span></span> <span data-ttu-id="ae94b-106">即使是新的應用程式有時也需要使用字碼頁，但通常是下列其中一個原因：</span><span class="sxs-lookup"><span data-stu-id="ae94b-106">Even new applications sometimes have to work with code pages, often for one of the following reasons:</span></span>

-   <span data-ttu-id="ae94b-107">與繼承應用程式進行通訊。</span><span class="sxs-lookup"><span data-stu-id="ae94b-107">To communicate with legacy applications.</span></span>
-   <span data-ttu-id="ae94b-108">若要與較舊的郵件和新聞伺服器通訊，可能不一定會支援 Unicode。</span><span class="sxs-lookup"><span data-stu-id="ae94b-108">To communicate with older mail and news servers, which might not always support Unicode.</span></span>
-   <span data-ttu-id="ae94b-109">與 Windows 主控台進行通訊。</span><span class="sxs-lookup"><span data-stu-id="ae94b-109">To communicate with the Windows Console.</span></span>

> [!Note]  
> <span data-ttu-id="ae94b-110">新的 Windows 應用程式應該使用 [Unicode](unicode.md) 來避免不同的程式字碼頁不一致，並方便當地語系化。</span><span class="sxs-lookup"><span data-stu-id="ae94b-110">New Windows applications should use [Unicode](unicode.md) to avoid the inconsistencies of varied code pages and for ease of localization.</span></span>

 

<span data-ttu-id="ae94b-111">每個字碼頁都會以字碼頁識別碼表示，例如1252，並由 Unicode 和字元集 API 函式處理。</span><span class="sxs-lookup"><span data-stu-id="ae94b-111">Each code page is represented by a code page identifier, for example, 1252, and is handled by the Unicode and character set API functions.</span></span> <span data-ttu-id="ae94b-112">如需支援的字碼頁識別碼清單，請參閱 [字碼頁識別碼](code-page-identifiers.md)。</span><span class="sxs-lookup"><span data-stu-id="ae94b-112">For a list of supported code page identifiers, see [Code Page Identifiers](code-page-identifiers.md).</span></span> <span data-ttu-id="ae94b-113">Microsoft [Go 全球開發人員中心](https://msdn.microsoft.com/goglobal) 的「字碼頁」參考提供許多字碼頁的完整說明。</span><span class="sxs-lookup"><span data-stu-id="ae94b-113">The "Code Pages" reference on the Microsoft [Go Global Developer Center](https://msdn.microsoft.com/goglobal) gives full descriptions of many code pages.</span></span>

<span data-ttu-id="ae94b-114">Windows 字碼頁（通常稱為「ANSI 字碼頁」）是不是 (值大於 127) 代表國際字元之非 ASCII 值的字碼頁。</span><span class="sxs-lookup"><span data-stu-id="ae94b-114">Windows code pages, commonly called "ANSI code pages", are code pages for which non-ASCII values (values greater than 127) represent international characters.</span></span> <span data-ttu-id="ae94b-115">這些字碼頁在 Windows Me 中是以原生方式使用，也可以在 Windows NT 和更新版本上取得。</span><span class="sxs-lookup"><span data-stu-id="ae94b-115">These code pages are used natively in Windows Me, and are also available on Windows NT and later.</span></span>

> [!Note]  
> <span data-ttu-id="ae94b-116">最初，Windows 字碼頁1252（一般用於英文和其他西歐語言的字碼頁）是以美國國家標準局 (ANSI) draft 為基礎。</span><span class="sxs-lookup"><span data-stu-id="ae94b-116">Originally, Windows code page 1252, the code page commonly used for English and other Western European languages, was based on an American National Standards Institute (ANSI) draft.</span></span> <span data-ttu-id="ae94b-117">該草稿最終變成 ISO 8859-1，但是 Windows 字碼頁1252是在標準變成最終之前實，而且與 ISO 8859-1 不完全相同。</span><span class="sxs-lookup"><span data-stu-id="ae94b-117">That draft eventually became ISO 8859-1, but Windows code page 1252 was implemented before the standard became final, and is not exactly the same as ISO 8859-1.</span></span>

 

<span data-ttu-id="ae94b-118">許多 Windows API 函數都有 "A" (ANSI) 和 "W" (寬 Unicode) 版本。</span><span class="sxs-lookup"><span data-stu-id="ae94b-118">Many Windows API functions have "A" (ANSI) and "W" (wide, Unicode) versions.</span></span> <span data-ttu-id="ae94b-119">"A" 版本會根據 Windows 字碼頁處理文字，而 "W" 版本則會處理 Unicode 文字。</span><span class="sxs-lookup"><span data-stu-id="ae94b-119">The "A" version handles text based on Windows code pages, while the "W" version handles Unicode text.</span></span> <span data-ttu-id="ae94b-120">請參閱[Windows 資料類型，以取得](windows-data-types-for-strings.md)[函數原型的](conventions-for-function-prototypes.md)字串和慣例。</span><span class="sxs-lookup"><span data-stu-id="ae94b-120">See [Windows Data Types for Strings](windows-data-types-for-strings.md) and [Conventions for Function Prototypes](conventions-for-function-prototypes.md).</span></span>

<span data-ttu-id="ae94b-121">Windows 字碼頁有時也稱為「使用中的字碼頁」或「系統使用中的字碼頁」。</span><span class="sxs-lookup"><span data-stu-id="ae94b-121">Windows code pages are also sometimes referred to as "active code pages" or "system active code pages".</span></span> <span data-ttu-id="ae94b-122">Windows 作業系統一律會有一個目前作用中的 Windows 字碼頁。</span><span class="sxs-lookup"><span data-stu-id="ae94b-122">A Windows operating system always has one currently active Windows code page.</span></span> <span data-ttu-id="ae94b-123">所有 [ANSI 版本的 API](conventions-for-function-prototypes.md) 函式都會使用目前作用中的字碼頁。</span><span class="sxs-lookup"><span data-stu-id="ae94b-123">All [ANSI versions of API functions](conventions-for-function-prototypes.md) use the currently active code page.</span></span>

<span data-ttu-id="ae94b-124">原始設備製造商 (OEM) 字碼頁為非 ASCII 值代表線條繪圖和標點符號字元的字碼頁。</span><span class="sxs-lookup"><span data-stu-id="ae94b-124">Original equipment manufacturer (OEM) code pages are code pages for which non-ASCII values represent line drawing and punctuation characters.</span></span> <span data-ttu-id="ae94b-125">這些字碼頁原本是用於 MS-DOS，仍用於主控台應用程式。</span><span class="sxs-lookup"><span data-stu-id="ae94b-125">These code pages were originally used for MS-DOS and are still used for console applications.</span></span> <span data-ttu-id="ae94b-126">它們也可用於 FAT12、FAT16 和 FAT32 檔案系統中的非延伸檔案名，如 [檔案名中使用的字元集](character-sets-used-in-file-names.md)所述。</span><span class="sxs-lookup"><span data-stu-id="ae94b-126">They are also used for the non-extended file names in the FAT12, FAT16, and FAT32 file systems, as described in [Character Sets Used in File Names](character-sets-used-in-file-names.md).</span></span> <span data-ttu-id="ae94b-127">英文版的一般 OEM 字碼頁是字碼頁437。</span><span class="sxs-lookup"><span data-stu-id="ae94b-127">The usual OEM code page for English is code page 437.</span></span>

<span data-ttu-id="ae94b-128">針對 Windows 字碼頁和 OEM 字碼頁，0x00 至0x7F 的代碼值會對應至7位 ASCII 字元集。</span><span class="sxs-lookup"><span data-stu-id="ae94b-128">For both Windows code pages and OEM code pages, the code values 0x00 through 0x7F correspond to the 7-bit ASCII character set.</span></span> <span data-ttu-id="ae94b-129">透過0x19 和0x7F 的代碼值0x00 一律代表標準化的控制字元，而0x20 到0x7E 則代表標準化的可顯示字元。</span><span class="sxs-lookup"><span data-stu-id="ae94b-129">Code values 0x00 through 0x19 and 0x7F always represent standardized control characters and 0x20 through 0x7E represent standardized displayable characters.</span></span> <span data-ttu-id="ae94b-130">其餘程式碼所代表的字元（0x80 到0xff）會因字元集而異。</span><span class="sxs-lookup"><span data-stu-id="ae94b-130">Characters represented by the remaining codes, 0x80 through 0xff, vary among character sets.</span></span> <span data-ttu-id="ae94b-131">每個字元集都包含不同的特殊字元，通常會針對語言或語言群組進行自訂。</span><span class="sxs-lookup"><span data-stu-id="ae94b-131">Each character set includes different special characters, typically customized for a language or group of languages.</span></span> <span data-ttu-id="ae94b-132">Windows 字碼頁1252和 OEM 字碼頁437通常用於美國。</span><span class="sxs-lookup"><span data-stu-id="ae94b-132">Windows code page 1252 and OEM code page 437 are generally used in the United States.</span></span>

<span data-ttu-id="ae94b-133">除了 Windows 和 OEM 字碼頁之外，您的應用程式也可以使用非原生字碼頁。</span><span class="sxs-lookup"><span data-stu-id="ae94b-133">In addition to Windows and OEM code pages, your applications can use non-native code pages.</span></span> <span data-ttu-id="ae94b-134">範例包括 EBCDIC 和 Macintosh 字碼頁。</span><span class="sxs-lookup"><span data-stu-id="ae94b-134">Examples are EBCDIC and Macintosh code pages.</span></span>

<span data-ttu-id="ae94b-135">Unicode (UTF-8 和 UTF-8) 的兩種編碼會實作為字碼頁。</span><span class="sxs-lookup"><span data-stu-id="ae94b-135">Two encodings of Unicode (UTF-7 and UTF-8) are implemented as code pages.</span></span> <span data-ttu-id="ae94b-136">如同其他字碼頁，每個頁面都是由數值識別碼所知道，而且可以使用許多相同的 Unicode 和字元集 API 函式來處理。</span><span class="sxs-lookup"><span data-stu-id="ae94b-136">Like other code pages, each page is known by a numeric identifier and can be handled with many of the same Unicode and character set API functions.</span></span>

<span data-ttu-id="ae94b-137">字碼頁可以是 [單一位元組字元集](single-byte-character-sets.md) (SBCS) 頁或 [雙位元組字集](double-byte-character-sets.md) (DBCS) 頁面。</span><span class="sxs-lookup"><span data-stu-id="ae94b-137">Code pages can be either [single-byte character set](single-byte-character-sets.md) (SBCS) pages or [double-byte character set](double-byte-character-sets.md) (DBCS) pages.</span></span> <span data-ttu-id="ae94b-138">在 SBCS 頁面中，每個位元組都會直接將單一字元編碼，如此一來，就可以精確呈現256的相異字元 (包括控制字元、字母、數位、標點符號、符號和 like) 。</span><span class="sxs-lookup"><span data-stu-id="ae94b-138">In SBCS pages, each byte directly encodes a single character, so that it is possible to represent exactly 256 distinct characters (including control characters, letters, digits, punctuation, symbols, and the like).</span></span> <span data-ttu-id="ae94b-139">DBCS 字碼頁用於日文和中文等語言。</span><span class="sxs-lookup"><span data-stu-id="ae94b-139">DBCS code pages are used for languages such as Japanese and Chinese.</span></span> <span data-ttu-id="ae94b-140">在這類字碼頁中，某些字元具有具有特定位元組值的兩位元組編碼 (永遠值大於 127) 做為「前置位元組」。</span><span class="sxs-lookup"><span data-stu-id="ae94b-140">In such a code page, some characters have two-byte encodings with certain byte values (always values greater than 127) serving as "lead bytes".</span></span> <span data-ttu-id="ae94b-141">前導位元組只能與 "軌跡 byte" 一起對應到一個字元，而不是在自己的許可權中編碼字元。</span><span class="sxs-lookup"><span data-stu-id="ae94b-141">Instead of encoding characters in their own right, lead bytes can be mapped to a character only in conjunction with a "trail byte".</span></span>

<span data-ttu-id="ae94b-142">有些舊版通訊協定需要使用 SBCS 和 DBCS 字碼頁。</span><span class="sxs-lookup"><span data-stu-id="ae94b-142">Some legacy protocols require the use of SBCS and DBCS code pages.</span></span> <span data-ttu-id="ae94b-143">每個 SBCS/DBCS 字碼頁支援不同的字元，但沒有任何字碼頁支援 Unicode 提供的完整字元範圍。</span><span class="sxs-lookup"><span data-stu-id="ae94b-143">Each SBCS/DBCS code page supports different characters, but no code page supports the full breadth of characters provided by Unicode.</span></span> <span data-ttu-id="ae94b-144">每個 SBCS/DBCS 字碼頁支援不同的子集，以不同方式編碼。</span><span class="sxs-lookup"><span data-stu-id="ae94b-144">Each SBCS/DBCS code page supports a different subset, differently encoded.</span></span>

> [!Note]  
> <span data-ttu-id="ae94b-145">從一個 SBCS 或 DBCS 字碼頁轉換成另一個資料頁的資料可能會損毀，因為不同字碼頁上的相同資料值可以編碼不同的字元。</span><span class="sxs-lookup"><span data-stu-id="ae94b-145">Data converted from one SBCS or DBCS code page to another is subject to corruption, because the same data value on different code pages can encode a different character.</span></span> <span data-ttu-id="ae94b-146">從 Unicode 轉換成 SBCS 或 DBCS 的資料會受到資料遺失的影響，因為指定的字碼頁可能無法表示該特定 Unicode 資料中使用的每個字元。</span><span class="sxs-lookup"><span data-stu-id="ae94b-146">Data converted from Unicode to SBCS or DBCS is subject to data loss, because a given code page might not be able to represent every character used in that particular Unicode data.</span></span>

 

<span data-ttu-id="ae94b-147">除了 SBCS 和 DBCS 字碼頁，您的應用程式還可以使用多位元組字元集字碼頁52936、54936、51949和5022x，其使用的方法類似于 DBCS。</span><span class="sxs-lookup"><span data-stu-id="ae94b-147">In addition to SBCS and DBCS code pages, your applications have available the multibyte character set code pages 52936, 54936, 51949, and 5022x, which use an approach similar to that for a DBCS.</span></span> <span data-ttu-id="ae94b-148">但是，多位元組字元集字碼頁超過了兩位元組編碼的部分字元。</span><span class="sxs-lookup"><span data-stu-id="ae94b-148">A multibyte character set code page goes beyond two-byte encodings of some characters, however.</span></span> <span data-ttu-id="ae94b-149">UTF-7 和 UTF-8 使用類似的方法，分別以7位和8位位元組為基礎來編碼 Unicode。</span><span class="sxs-lookup"><span data-stu-id="ae94b-149">UTF-7 and UTF-8 use a similar approach to encode Unicode based on a 7-bit and 8-bit bytes, respectively.</span></span> <span data-ttu-id="ae94b-150">如需詳細資訊，請參閱 [Unicode](unicode.md)。</span><span class="sxs-lookup"><span data-stu-id="ae94b-150">For more information, see [Unicode](unicode.md).</span></span>

<span data-ttu-id="ae94b-151">數個 Unicode 和字元集函數可讓您的應用程式處理字碼頁。</span><span class="sxs-lookup"><span data-stu-id="ae94b-151">Several Unicode and character set functions allow your applications to handle code pages.</span></span> <span data-ttu-id="ae94b-152">應用程式可以使用 [**GetCPInfo**](/windows/desktop/api/Winnls/nf-winnls-getcpinfo) 和 [**GetCPInfoEx**](/windows/desktop/api/Winnls/nf-winnls-getcpinfoexa) 函數來取得字碼頁的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="ae94b-152">An application can use the [**GetCPInfo**](/windows/desktop/api/Winnls/nf-winnls-getcpinfo) and [**GetCPInfoEx**](/windows/desktop/api/Winnls/nf-winnls-getcpinfoexa) functions to obtain information about a code page.</span></span> <span data-ttu-id="ae94b-153">這項資訊包括在轉換的字串中的字元沒有對應的字碼頁專案時，所使用的預設字元。</span><span class="sxs-lookup"><span data-stu-id="ae94b-153">This information includes the default character used when a character in a converted string has no corresponding entry in the code page.</span></span>

<span data-ttu-id="ae94b-154">應用程式可以使用 [**MultiByteToWideChar**](/windows/desktop/api/Stringapiset/nf-stringapiset-multibytetowidechar) 和 [**WideCharToMultiByte**](/windows/desktop/api/Stringapiset/nf-stringapiset-widechartomultibyte) 函式，根據 Windows 字碼頁和 Unicode 字串在字串之間進行轉換。</span><span class="sxs-lookup"><span data-stu-id="ae94b-154">An application can use the [**MultiByteToWideChar**](/windows/desktop/api/Stringapiset/nf-stringapiset-multibytetowidechar) and [**WideCharToMultiByte**](/windows/desktop/api/Stringapiset/nf-stringapiset-widechartomultibyte) functions to convert between strings based on Windows code pages and Unicode strings.</span></span> <span data-ttu-id="ae94b-155">雖然它們的名稱是指「多位元組」，但這些函式同樣適用于 SBCS、DBCS 和多位元組字元集字碼頁。</span><span class="sxs-lookup"><span data-stu-id="ae94b-155">Although their names refer to "MultiByte", these functions work equally well with SBCS, DBCS, and multibyte character set code pages.</span></span>

> [!Note]  
> <span data-ttu-id="ae94b-156">如果提供的字碼頁無法代表 Unicode 字串中的所有字元， [**WideCharToMultiByte**](/windows/desktop/api/Stringapiset/nf-stringapiset-widechartomultibyte)可能會遺失部分資料。</span><span class="sxs-lookup"><span data-stu-id="ae94b-156">[**WideCharToMultiByte**](/windows/desktop/api/Stringapiset/nf-stringapiset-widechartomultibyte) can lose some data if the supplied code page cannot represent all characters in a Unicode string.</span></span>

 

<span data-ttu-id="ae94b-157">您的應用程式可以使用標準 C 執行時間程式庫函式，在 Windows 字碼頁和 OEM 字碼頁之間進行轉換。</span><span class="sxs-lookup"><span data-stu-id="ae94b-157">Your application can convert between Windows code pages and OEM code pages using the standard C runtime library functions.</span></span> <span data-ttu-id="ae94b-158">不過，使用這些函式會造成資料遺失的風險，因為每個字碼頁可以表示的字元不完全相符。</span><span class="sxs-lookup"><span data-stu-id="ae94b-158">However, use of these functions presents a risk of data loss because the characters that can be represented by each code page do not match exactly.</span></span>

<span data-ttu-id="ae94b-159">您的應用程式也可以呼叫 [**GetACP**](/windows/desktop/api/Winnls/nf-winnls-getacp) 函數。</span><span class="sxs-lookup"><span data-stu-id="ae94b-159">Your applications can also call the [**GetACP**](/windows/desktop/api/Winnls/nf-winnls-getacp) function.</span></span> <span data-ttu-id="ae94b-160">此函式會抓取目前 Windows (ANSI) 字碼頁的識別碼。</span><span class="sxs-lookup"><span data-stu-id="ae94b-160">This function retrieves the identifier of the current Windows (ANSI) code page.</span></span>

## <a name="related-topics"></a><span data-ttu-id="ae94b-161">相關主題</span><span class="sxs-lookup"><span data-stu-id="ae94b-161">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="ae94b-162">字元集</span><span class="sxs-lookup"><span data-stu-id="ae94b-162">Character Sets</span></span>](character-sets.md)
</dt> </dl>

 

 



