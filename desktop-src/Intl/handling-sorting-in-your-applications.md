---
description: 某些應用程式（例如 Microsoft Active Directory、Microsoft Exchange 和 Microsoft Access）會維護依 (名稱編制索引的地區設定和語言字串的可排序資料庫) 以及其相關聯的排序加權。
ms.assetid: c8fc32bd-02bd-4a40-a836-d9ad9f69c209
title: 處理應用程式中的排序
ms.topic: article
ms.date: 03/04/2020
ms.openlocfilehash: c0bba3d78a5219781226ecf58292ed461c902090
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/08/2021
ms.locfileid: "103852964"
---
# <a name="handling-sorting-in-your-applications"></a><span data-ttu-id="4a1db-103">處理應用程式中的排序</span><span class="sxs-lookup"><span data-stu-id="4a1db-103">Handling Sorting in Your Applications</span></span>

<span data-ttu-id="4a1db-104">某些應用程式（例如 Microsoft Active Directory、Microsoft Exchange 和 Microsoft Access）會維護依 (名稱編制索引的地區設定和語言字串的可排序資料庫) 以及其相關聯的排序加權。</span><span class="sxs-lookup"><span data-stu-id="4a1db-104">Some applications, such as Microsoft Active Directory, Microsoft Exchange, and Microsoft Access, maintain a sortable database of locale and language strings indexed by name (UTF-16 string), and their associated sorting weights.</span></span>

<span data-ttu-id="4a1db-105">[排序](sorting.md) 對於自己的地區設定中的使用者來說通常是直覺的。</span><span class="sxs-lookup"><span data-stu-id="4a1db-105">[Sorting](sorting.md) is usually intuitive for users in their own locales.</span></span> <span data-ttu-id="4a1db-106">但是，應用程式開發人員可能不太直覺化。</span><span class="sxs-lookup"><span data-stu-id="4a1db-106">However, it can be non-intuitive for application developers.</span></span> <span data-ttu-id="4a1db-107">本主題討論在應用程式中處理排序的考慮。</span><span class="sxs-lookup"><span data-stu-id="4a1db-107">This topic discusses considerations for handling sorting in your applications.</span></span> <span data-ttu-id="4a1db-108">排序可以是語言或序數 (非語言) 。</span><span class="sxs-lookup"><span data-stu-id="4a1db-108">Sorting can be either linguistic or ordinal (non-linguistic).</span></span>

## <a name="sorting-functions"></a><span data-ttu-id="4a1db-109">排序函數</span><span class="sxs-lookup"><span data-stu-id="4a1db-109">Sorting Functions</span></span>

<span data-ttu-id="4a1db-110">您可以在應用程式中使用各種排序功能：</span><span class="sxs-lookup"><span data-stu-id="4a1db-110">You can use a variety of sorting functions in your applications:</span></span>

-   <span data-ttu-id="4a1db-111">NLS 字串比較函數。</span><span class="sxs-lookup"><span data-stu-id="4a1db-111">NLS string comparison functions.</span></span> <span data-ttu-id="4a1db-112">範例包括 [**CompareString**](/windows/win32/api/stringapiset/nf-stringapiset-comparestringw) 和 [**CompareStringEx**](/windows/desktop/api/Stringapiset/nf-stringapiset-comparestringex)、 [**CompareStringOrdinal**](/windows/desktop/api/Stringapiset/nf-stringapiset-comparestringordinal)、 [**LCMapString**](/windows/desktop/api/Winnls/nf-winnls-lcmapstringa)、 [**LCMapStringEx**](/windows/desktop/api/Winnls/nf-winnls-lcmapstringex)、 [**FindNLSString**](/windows/desktop/api/Winnls/nf-winnls-findnlsstring)、 [**FindNLSStringEx**](/windows/desktop/api/Winnls/nf-winnls-findnlsstringex)和 [**FindStringOrdinal**](/windows/desktop/api/Libloaderapi/nf-libloaderapi-findstringordinal)。</span><span class="sxs-lookup"><span data-stu-id="4a1db-112">Examples are [**CompareString**](/windows/win32/api/stringapiset/nf-stringapiset-comparestringw) and [**CompareStringEx**](/windows/desktop/api/Stringapiset/nf-stringapiset-comparestringex), [**CompareStringOrdinal**](/windows/desktop/api/Stringapiset/nf-stringapiset-comparestringordinal), [**LCMapString**](/windows/desktop/api/Winnls/nf-winnls-lcmapstringa), [**LCMapStringEx**](/windows/desktop/api/Winnls/nf-winnls-lcmapstringex), [**FindNLSString**](/windows/desktop/api/Winnls/nf-winnls-findnlsstring), [**FindNLSStringEx**](/windows/desktop/api/Winnls/nf-winnls-findnlsstringex), and [**FindStringOrdinal**](/windows/desktop/api/Libloaderapi/nf-libloaderapi-findstringordinal).</span></span> <span data-ttu-id="4a1db-113">請參閱 [安全性考慮：](security-considerations--international-features.md) 與字串比較函式相關之安全性問題討論的國際功能。</span><span class="sxs-lookup"><span data-stu-id="4a1db-113">See [Security Considerations: International Features](security-considerations--international-features.md) for a discussion of security issues related to the string comparison functions.</span></span>
-   <span data-ttu-id="4a1db-114">在內部呼叫字串比較函數的包裝函式。</span><span class="sxs-lookup"><span data-stu-id="4a1db-114">Wrapper functions that internally call the string comparison functions.</span></span> <span data-ttu-id="4a1db-115">最常見的函式為 [**lstrcmp**](/windows/win32/api/winbase/nf-winbase-lstrcmpa) 和 [**lstrcmpi**](/windows/win32/api/winbase/nf-winbase-lstrcmpia)，其會呼叫 [**CompareString**](/windows/win32/api/stringapiset/nf-stringapiset-comparestringw)。</span><span class="sxs-lookup"><span data-stu-id="4a1db-115">The most common functions are [**lstrcmp**](/windows/win32/api/winbase/nf-winbase-lstrcmpa) and [**lstrcmpi**](/windows/win32/api/winbase/nf-winbase-lstrcmpia), which call [**CompareString**](/windows/win32/api/stringapiset/nf-stringapiset-comparestringw).</span></span>

<span data-ttu-id="4a1db-116">排序函式通常會依字元評估字串字元。</span><span class="sxs-lookup"><span data-stu-id="4a1db-116">Usually the sorting functions evaluate strings character by character.</span></span> <span data-ttu-id="4a1db-117">不過，許多語言都有多個字元的元素，例如傳統西班牙文中的兩個字元組 "CH"。</span><span class="sxs-lookup"><span data-stu-id="4a1db-117">However, many languages have multiple-character elements, such as the two-character pair "CH" in traditional Spanish.</span></span> <span data-ttu-id="4a1db-118">[**CompareString**](/windows/win32/api/stringapiset/nf-stringapiset-comparestringw) 和 [**CompareStringEx**](/windows/desktop/api/Stringapiset/nf-stringapiset-comparestringex) 會使用應用程式提供的地區設定識別碼或名稱來識別多字元元素。</span><span class="sxs-lookup"><span data-stu-id="4a1db-118">[**CompareString**](/windows/win32/api/stringapiset/nf-stringapiset-comparestringw) and [**CompareStringEx**](/windows/desktop/api/Stringapiset/nf-stringapiset-comparestringex) use the application-supplied locale identifier or name to identify multiple-character elements.</span></span> <span data-ttu-id="4a1db-119">相反地， [**lstrcmp**](/windows/win32/api/winbase/nf-winbase-lstrcmpa)和 [**lstrcmpi**](/windows/win32/api/winbase/nf-winbase-lstrcmpia) 會使用使用者的地區設定。</span><span class="sxs-lookup"><span data-stu-id="4a1db-119">In contrast, [**lstrcmp**](/windows/win32/api/winbase/nf-winbase-lstrcmpa), and [**lstrcmpi**](/windows/win32/api/winbase/nf-winbase-lstrcmpia) use the user's locale.</span></span>

<span data-ttu-id="4a1db-120">另一個範例是越南文，其中包含多個兩個字元的元素，例如有效的大寫字母、標題案例和小寫形式的 "GI" （分別為 "GI、" Gi "和" gi "）。</span><span class="sxs-lookup"><span data-stu-id="4a1db-120">Another example is Vietnamese, which contains many two-character elements, such as the valid uppercase, title case, and lowercase forms of "GI", which are "GI, "Gi", and "gi", respectively.</span></span> <span data-ttu-id="4a1db-121">其中任何一種形式都會視為單一排序專案，而且如果忽略大小寫，則會比較為相等。</span><span class="sxs-lookup"><span data-stu-id="4a1db-121">Any of these forms is treated as a as a single sorting element and, if casing is ignored, compares as equal.</span></span> <span data-ttu-id="4a1db-122">不過，由於 "gI" 不是有效的單一元素，因此 [**CompareString**](/windows/win32/api/stringapiset/nf-stringapiset-comparestringw)、 [**CompareStringEx**](/windows/desktop/api/Stringapiset/nf-stringapiset-comparestringex)、 [**lstrcmp**](/windows/win32/api/winbase/nf-winbase-lstrcmpa)和 [**lstrcmpi**](/windows/win32/api/winbase/nf-winbase-lstrcmpia) 會將 "gi" 視為兩個不同的元素。</span><span class="sxs-lookup"><span data-stu-id="4a1db-122">However, because "gI" is not valid as a single element, [**CompareString**](/windows/win32/api/stringapiset/nf-stringapiset-comparestringw), [**CompareStringEx**](/windows/desktop/api/Stringapiset/nf-stringapiset-comparestringex), [**lstrcmp**](/windows/win32/api/winbase/nf-winbase-lstrcmpa), and [**lstrcmpi**](/windows/win32/api/winbase/nf-winbase-lstrcmpia) treat "gI" as two separate elements.</span></span>

<span data-ttu-id="4a1db-123">[**CompareString**](/windows/win32/api/stringapiset/nf-stringapiset-comparestringw)、 [**CompareStringEx**](/windows/desktop/api/Stringapiset/nf-stringapiset-comparestringex)、 [**lstrcmp**](/windows/win32/api/winbase/nf-winbase-lstrcmpa)、 [**lstrcmpi**](/windows/win32/api/winbase/nf-winbase-lstrcmpia)、 [**LCMapString**](/windows/desktop/api/Winnls/nf-winnls-lcmapstringa)、 [**LCMapStringEx**](/windows/desktop/api/Winnls/nf-winnls-lcmapstringex)、 [**FindNLSString**](/windows/desktop/api/Winnls/nf-winnls-findnlsstring)和 [**FindNLSStringEx**](/windows/desktop/api/Winnls/nf-winnls-findnlsstringex)等函數全都預設為使用「文字排序」技術。</span><span class="sxs-lookup"><span data-stu-id="4a1db-123">The functions [**CompareString**](/windows/win32/api/stringapiset/nf-stringapiset-comparestringw), [**CompareStringEx**](/windows/desktop/api/Stringapiset/nf-stringapiset-comparestringex), [**lstrcmp**](/windows/win32/api/winbase/nf-winbase-lstrcmpa), [**lstrcmpi**](/windows/win32/api/winbase/nf-winbase-lstrcmpia), [**LCMapString**](/windows/desktop/api/Winnls/nf-winnls-lcmapstringa), [**LCMapStringEx**](/windows/desktop/api/Winnls/nf-winnls-lcmapstringex), [**FindNLSString**](/windows/desktop/api/Winnls/nf-winnls-findnlsstring), and [**FindNLSStringEx**](/windows/desktop/api/Winnls/nf-winnls-findnlsstringex) all default to use of a "word sort" technique.</span></span> <span data-ttu-id="4a1db-124">對於這種類型的排序，除了連字號和單引號以外的所有標點符號和其他非英數位元，都在任何英數位元之前。</span><span class="sxs-lookup"><span data-stu-id="4a1db-124">For this type of sort, all punctuation marks and other nonalphanumeric characters, except for the hyphen and the apostrophe, come before any alphanumeric character.</span></span> <span data-ttu-id="4a1db-125">連字號和單引號的處理方式與其他非英數位元不同，以確保文字（例如「共同作業」和「共同作業」）在已排序的清單中保持在一起。</span><span class="sxs-lookup"><span data-stu-id="4a1db-125">The hyphen and the apostrophe are treated differently from the other nonalphanumeric characters to ensure that words such as "coop" and "co-op" stay together in a sorted list.</span></span>

<span data-ttu-id="4a1db-126">應用程式可以藉由指定 SORT STRINGSORT 旗標，從排序函數要求「字串排序」技術，而不是文字排序 \_ 。</span><span class="sxs-lookup"><span data-stu-id="4a1db-126">Instead of a word sort, the application can request a "string sort" technique from the sorting functions by specifying the SORT\_STRINGSORT flag.</span></span> <span data-ttu-id="4a1db-127">字串排序會將連字號和單引號視為與任何其他非英數位元一樣。</span><span class="sxs-lookup"><span data-stu-id="4a1db-127">A string sort treats the hyphen and apostrophe just like any other nonalphanumeric character.</span></span> <span data-ttu-id="4a1db-128">它們在排序次序中的位置是在英數位元之前。</span><span class="sxs-lookup"><span data-stu-id="4a1db-128">Their positions in the sorting sequence are before the alphanumeric characters.</span></span>

<span data-ttu-id="4a1db-129">下表比較文字排序的結果與字串排序的結果。</span><span class="sxs-lookup"><span data-stu-id="4a1db-129">The following table compares the results of a word sort with the results of a string sort.</span></span> 

| <span data-ttu-id="4a1db-130">文字排序</span><span class="sxs-lookup"><span data-stu-id="4a1db-130">Word Sort</span></span> | <span data-ttu-id="4a1db-131">字串排序</span><span class="sxs-lookup"><span data-stu-id="4a1db-131">String Sort</span></span> |
|-----------|-------------|
| <span data-ttu-id="4a1db-132">坯</span><span class="sxs-lookup"><span data-stu-id="4a1db-132">billet</span></span>    | <span data-ttu-id="4a1db-133">帳單</span><span class="sxs-lookup"><span data-stu-id="4a1db-133">bill's</span></span>      |
| <span data-ttu-id="4a1db-134">條例 草案</span><span class="sxs-lookup"><span data-stu-id="4a1db-134">bills</span></span>     | <span data-ttu-id="4a1db-135">坯</span><span class="sxs-lookup"><span data-stu-id="4a1db-135">billet</span></span>      |
| <span data-ttu-id="4a1db-136">帳單</span><span class="sxs-lookup"><span data-stu-id="4a1db-136">bill's</span></span>    | <span data-ttu-id="4a1db-137">條例 草案</span><span class="sxs-lookup"><span data-stu-id="4a1db-137">bills</span></span>       |
| <span data-ttu-id="4a1db-138">無法</span><span class="sxs-lookup"><span data-stu-id="4a1db-138">cannot</span></span>    | <span data-ttu-id="4a1db-139">不能</span><span class="sxs-lookup"><span data-stu-id="4a1db-139">can't</span></span>       |
| <span data-ttu-id="4a1db-140">不能</span><span class="sxs-lookup"><span data-stu-id="4a1db-140">cant</span></span>      | <span data-ttu-id="4a1db-141">無法</span><span class="sxs-lookup"><span data-stu-id="4a1db-141">cannot</span></span>      |
| <span data-ttu-id="4a1db-142">不能</span><span class="sxs-lookup"><span data-stu-id="4a1db-142">can't</span></span>     | <span data-ttu-id="4a1db-143">不能</span><span class="sxs-lookup"><span data-stu-id="4a1db-143">cant</span></span>        |
| <span data-ttu-id="4a1db-144">con</span><span class="sxs-lookup"><span data-stu-id="4a1db-144">con</span></span>       | <span data-ttu-id="4a1db-145">共同作業</span><span class="sxs-lookup"><span data-stu-id="4a1db-145">co-op</span></span>       |
| <span data-ttu-id="4a1db-146">庫 珀</span><span class="sxs-lookup"><span data-stu-id="4a1db-146">coop</span></span>      | <span data-ttu-id="4a1db-147">con</span><span class="sxs-lookup"><span data-stu-id="4a1db-147">con</span></span>         |
| <span data-ttu-id="4a1db-148">共同作業</span><span class="sxs-lookup"><span data-stu-id="4a1db-148">co-op</span></span>     | <span data-ttu-id="4a1db-149">庫 珀</span><span class="sxs-lookup"><span data-stu-id="4a1db-149">coop</span></span>        |



 

## <a name="sort-strings-linguistically"></a><span data-ttu-id="4a1db-150">以語言排序字串</span><span class="sxs-lookup"><span data-stu-id="4a1db-150">Sort Strings Linguistically</span></span>

<span data-ttu-id="4a1db-151">[**CompareString**](/windows/win32/api/stringapiset/nf-stringapiset-comparestringw)和 [**CompareStringEx**](/windows/desktop/api/Stringapiset/nf-stringapiset-comparestringex)函數會針對語言相等進行測試。</span><span class="sxs-lookup"><span data-stu-id="4a1db-151">The [**CompareString**](/windows/win32/api/stringapiset/nf-stringapiset-comparestringw) and [**CompareStringEx**](/windows/desktop/api/Stringapiset/nf-stringapiset-comparestringex) functions test for linguistic equality.</span></span> <span data-ttu-id="4a1db-152">您的應用程式應該使用這些函式搭配正確的地區設定，以進行語言排序字串。</span><span class="sxs-lookup"><span data-stu-id="4a1db-152">Your applications should use these functions with the correct locale for sorting strings linguistically.</span></span>

> [!Note]  
> <span data-ttu-id="4a1db-153">為了與 Unicode 相容，應用程式應該偏好 [**CompareStringEx**](/windows/desktop/api/Stringapiset/nf-stringapiset-comparestringex) 或 unicode 版本的 [**CompareString**](/windows/win32/api/stringapiset/nf-stringapiset-comparestringw)。</span><span class="sxs-lookup"><span data-stu-id="4a1db-153">For compatibility with Unicode, an application should prefer [**CompareStringEx**](/windows/desktop/api/Stringapiset/nf-stringapiset-comparestringex) or the Unicode version of [**CompareString**](/windows/win32/api/stringapiset/nf-stringapiset-comparestringw).</span></span> <span data-ttu-id="4a1db-154">偏好 [**CompareStringEx**](/windows/desktop/api/Stringapiset/nf-stringapiset-comparestringex) 的另一個原因是，因為互通性的緣故，Microsoft 正針對新地區設定使用地區設定名稱，而非地區設定識別碼。</span><span class="sxs-lookup"><span data-stu-id="4a1db-154">Another reason for preferring [**CompareStringEx**](/windows/desktop/api/Stringapiset/nf-stringapiset-comparestringex) is that Microsoft is migrating toward the use of locale names instead of locale identifiers for new locales, for interoperability reasons.</span></span> <span data-ttu-id="4a1db-155">只有在 Windows Vista 和更新版本上執行的任何應用程式，都應該使用 [**CompareStringEx**](/windows/desktop/api/Stringapiset/nf-stringapiset-comparestringex)。</span><span class="sxs-lookup"><span data-stu-id="4a1db-155">Any application that runs only on Windows Vista and later should use [**CompareStringEx**](/windows/desktop/api/Stringapiset/nf-stringapiset-comparestringex).</span></span>

 

<span data-ttu-id="4a1db-156">測試語言是否相等的另一種方式是使用 [**lstrcmp**](/windows/win32/api/winbase/nf-winbase-lstrcmpa) 或 [**lstrcmpi**](/windows/win32/api/winbase/nf-winbase-lstrcmpia)，一律使用文字排序。</span><span class="sxs-lookup"><span data-stu-id="4a1db-156">Another way of testing for linguistic equality is to use [**lstrcmp**](/windows/win32/api/winbase/nf-winbase-lstrcmpa) or [**lstrcmpi**](/windows/win32/api/winbase/nf-winbase-lstrcmpia), which always use a word sort.</span></span> <span data-ttu-id="4a1db-157">[**Lstrcmpi**](/windows/win32/api/winbase/nf-winbase-lstrcmpia)函式會使用標準 IGNORECASE 旗標來呼叫 [**CompareString**](/windows/win32/api/stringapiset/nf-stringapiset-comparestringw) \_ ，而 [**lstrcmp**](/windows/win32/api/winbase/nf-winbase-lstrcmpa)則會在沒有該旗標的情況下呼叫。</span><span class="sxs-lookup"><span data-stu-id="4a1db-157">The [**lstrcmpi**](/windows/win32/api/winbase/nf-winbase-lstrcmpia) function calls [**CompareString**](/windows/win32/api/stringapiset/nf-stringapiset-comparestringw) with the NORM\_IGNORECASE flag, while [**lstrcmp**](/windows/win32/api/winbase/nf-winbase-lstrcmpa) calls it without that flag.</span></span> <span data-ttu-id="4a1db-158">如需使用包裝函式的總覽，請參閱 [**字串**](../menurc/strings.md)。</span><span class="sxs-lookup"><span data-stu-id="4a1db-158">For an overview of the use of the wrapper functions, see [**Strings**](../menurc/strings.md).</span></span>

<span data-ttu-id="4a1db-159">這些函式會針對所有地區設定取得語言適當的結果。</span><span class="sxs-lookup"><span data-stu-id="4a1db-159">The functions retrieve linguistically appropriate results for all locales.</span></span> <span data-ttu-id="4a1db-160">不同地區設定的使用者期望在排序行為上可能會有顯著的差異，如下列範例所示。</span><span class="sxs-lookup"><span data-stu-id="4a1db-160">User expectations for different locales can differ significantly in sorting behavior, as shown in the following examples.</span></span>

-   <span data-ttu-id="4a1db-161">許多地區設定會將 ae 連字號 (æ) 與字母 ae 相同。</span><span class="sxs-lookup"><span data-stu-id="4a1db-161">Many locales equate the ae ligature (æ) with the letters ae.</span></span> <span data-ttu-id="4a1db-162">不過，冰島文 (冰島) 將它視為個別的字母，並將它放在排序次序中的 Z 之後。</span><span class="sxs-lookup"><span data-stu-id="4a1db-162">However, Icelandic (Iceland) considers it a separate letter and places it after Z in the sorting sequence.</span></span>
-   <span data-ttu-id="4a1db-163">Å) 的環形 (通常只會針對與之間的變音符號的差異進行排序。不過，瑞典文 (瑞典) 會在排序次序中的 Z 之後放置環形。</span><span class="sxs-lookup"><span data-stu-id="4a1db-163">The A Ring (Å) normally sorts with merely a diacritic difference from A. However, Swedish (Sweden) places the A Ring after Z in the sorting sequence.</span></span>

<span data-ttu-id="4a1db-164">函式會嘗試嚴格驗證 Unicode 標準中定義的程式碼點是否標準方式等於相等的程式碼點字串。</span><span class="sxs-lookup"><span data-stu-id="4a1db-164">The functions attempt to verify rigorously that code points defined in the Unicode standard are canonically equal to a string of equivalent code points.</span></span> <span data-ttu-id="4a1db-165">例如，代表小寫 "u" 的程式碼點， (ü) ，其標準方式等於小寫 "u"，並結合了分字元 (▆) 。</span><span class="sxs-lookup"><span data-stu-id="4a1db-165">For example, the code point that represents a lowercase "u" with a dieresis (ü) is canonically equal to a lowercase "u" combined with the dieresis (¨).</span></span> <span data-ttu-id="4a1db-166">不過請注意，這種標準的等價不一定可行。</span><span class="sxs-lookup"><span data-stu-id="4a1db-166">Note, however, that canonical equivalence is not always possible.</span></span>

<span data-ttu-id="4a1db-167">幾乎所有使用 Windows 鍵盤和輸入方法編輯器輸入的資料都 (Ime) 符合 Unicode 標準中所定義的 C 格式，使用 NLS Unicode 正規化函式從其他平臺轉換傳入資料會提供最一致的結果，特別是針對使用藏文腳本的地區設定或新式韓文的韓文腳本。</span><span class="sxs-lookup"><span data-stu-id="4a1db-167">As almost all data entered using Windows keyboards and input method editors (IMEs) conforms to the form C normalization defined in the Unicode standard, converting incoming data from other platforms using the NLS Unicode normalization functions provides most consistent results, especially for locales that use the Tibetan script or the Hangul script for modern Hangul.</span></span> <span data-ttu-id="4a1db-168">如需 Windows Vista 和更新版本中 Unicode 正規化支援的詳細資訊，請參閱 [使用 unicode 正規化來代表字串](using-unicode-normalization-to-represent-strings.md)。</span><span class="sxs-lookup"><span data-stu-id="4a1db-168">For more information on Unicode normalization support in Windows Vista and later, see [Using Unicode Normalization to Represent Strings](using-unicode-normalization-to-represent-strings.md).</span></span>

<span data-ttu-id="4a1db-169">當字串比較遵循使用者的語言喜好設定時，例如，當排序的 ListView 控制項的專案排序時，應用程式可以執行下列其中一項動作：</span><span class="sxs-lookup"><span data-stu-id="4a1db-169">When string comparison follows the user's language preference, for example, when sorting items for an ordered ListView control, the application can do one of the following:</span></span>

-   <span data-ttu-id="4a1db-170">以使用者的地區設定呼叫 [**lstrcmp**](/windows/win32/api/winbase/nf-winbase-lstrcmpa) 或 [**lstrcmpi**](/windows/win32/api/winbase/nf-winbase-lstrcmpia) 。</span><span class="sxs-lookup"><span data-stu-id="4a1db-170">Call [**lstrcmp**](/windows/win32/api/winbase/nf-winbase-lstrcmpa) or [**lstrcmpi**](/windows/win32/api/winbase/nf-winbase-lstrcmpia) with the user's locale.</span></span>
-   <span data-ttu-id="4a1db-171">呼叫 [**CompareString**](/windows/win32/api/stringapiset/nf-stringapiset-comparestringw) 或 [**CompareStringEx**](/windows/desktop/api/Stringapiset/nf-stringapiset-comparestringex) 來定義比較的地區設定、傳遞額外的旗標、內嵌 null 字元，或傳遞明確長度以符合字串的部分。</span><span class="sxs-lookup"><span data-stu-id="4a1db-171">Call [**CompareString**](/windows/win32/api/stringapiset/nf-stringapiset-comparestringw) or [**CompareStringEx**](/windows/desktop/api/Stringapiset/nf-stringapiset-comparestringex) to define a locale for the comparison, to pass additional flags, to embed null characters, or to pass explicit lengths to match parts of a string.</span></span>

<span data-ttu-id="4a1db-172">不論地區設定的比較結果應該一致，例如，在比較抓取的資料與預先定義的清單或內部值時，應用程式應該使用 [**CompareString**](/windows/win32/api/stringapiset/nf-stringapiset-comparestringw) 或 [**CompareStringEx**](/windows/desktop/api/Stringapiset/nf-stringapiset-comparestringex) ，並將 *locale* 參數設定為地區設定不 \_ 變。</span><span class="sxs-lookup"><span data-stu-id="4a1db-172">When the results of the comparison should be consistent regardless of locale, for example, when comparing retrieved data against a predefined list or an internal value, the application should use [**CompareString**](/windows/win32/api/stringapiset/nf-stringapiset-comparestringw) or [**CompareStringEx**](/windows/desktop/api/Stringapiset/nf-stringapiset-comparestringex) with the *Locale* parameter set to LOCALE\_INVARIANT.</span></span> <span data-ttu-id="4a1db-173">若為 [**CompareString**](/windows/win32/api/stringapiset/nf-stringapiset-comparestringw)，即使 mystr 為 "INLAP"，下列任一呼叫都將會相符。</span><span class="sxs-lookup"><span data-stu-id="4a1db-173">For [**CompareString**](/windows/win32/api/stringapiset/nf-stringapiset-comparestringw), either of the following calls will match even if mystr is "INLAP".</span></span> <span data-ttu-id="4a1db-174">在此情況下，如果目前的地區設定是越南文，則區分地區設定的 [**lstrcmpi**](/windows/win32/api/winbase/nf-winbase-lstrcmpia) 呼叫會失敗。</span><span class="sxs-lookup"><span data-stu-id="4a1db-174">In this case, a locale-sensitive call to [**lstrcmpi**](/windows/win32/api/winbase/nf-winbase-lstrcmpia) will fail if the current locale is Vietnamese.</span></span>

<span data-ttu-id="4a1db-175">在 Windows XP 上：</span><span class="sxs-lookup"><span data-stu-id="4a1db-175">On Windows XP:</span></span>


```C++
int iReturn = CompareString(LOCALE_INVARIANT, NORM_IGNORECASE, mystr, -1, _T("InLap"), -1);
```



<span data-ttu-id="4a1db-176">在舊版作業系統上：</span><span class="sxs-lookup"><span data-stu-id="4a1db-176">On earlier operating systems:</span></span>


```C++
DWORD lcid = MAKELCID(MAKELANGID(LANG_ENGLISH, SUBLANG_ENGLISH_US), SORT_DEFAULT);
int iReturn = CompareString(lcid, NORM_IGNORECASE, mystr, -1, _T("InLap"), -1);
```



## <a name="sort-strings-ordinally"></a><span data-ttu-id="4a1db-177">排序字串序數</span><span class="sxs-lookup"><span data-stu-id="4a1db-177">Sort Strings Ordinally</span></span>

<span data-ttu-id="4a1db-178">針對序數 (非語言) 排序，您的應用程式應該一律使用 [**CompareStringOrdinal**](/windows/desktop/api/Stringapiset/nf-stringapiset-comparestringordinal) 函數。</span><span class="sxs-lookup"><span data-stu-id="4a1db-178">For ordinal (non-linguistic) sorting, your applications should always use the [**CompareStringOrdinal**](/windows/desktop/api/Stringapiset/nf-stringapiset-comparestringordinal) function.</span></span>

> [!Note]  
> <span data-ttu-id="4a1db-179">這項功能僅適用于 Windows Vista 和更新版本。</span><span class="sxs-lookup"><span data-stu-id="4a1db-179">This function is only available for Windows Vista and later.</span></span>

 

<span data-ttu-id="4a1db-180">[**CompareStringOrdinal**](/windows/desktop/api/Stringapiset/nf-stringapiset-comparestringordinal) 會比較兩個 [Unicode](unicode.md) 字串來測試二進位相等，而不是語言相等。</span><span class="sxs-lookup"><span data-stu-id="4a1db-180">[**CompareStringOrdinal**](/windows/desktop/api/Stringapiset/nf-stringapiset-comparestringordinal) compares two [Unicode](unicode.md) strings to test for binary equality, as opposed to linguistic equality.</span></span> <span data-ttu-id="4a1db-181">這類非語言字串的範例包括 NTFS 檔案名、環境變數，以及 mutex、具名管道或 mailslots 的名稱。</span><span class="sxs-lookup"><span data-stu-id="4a1db-181">Examples of such non-linguistic strings are NTFS file names, environment variables, and the names of mutexes, named pipes, or mailslots.</span></span> <span data-ttu-id="4a1db-182">除了不區分大小寫的選項之外，此函式會忽略所有非二進位 equivalences。</span><span class="sxs-lookup"><span data-stu-id="4a1db-182">Except for the option of case-insensitivity, this function disregards all non-binary equivalences.</span></span> <span data-ttu-id="4a1db-183">不同于其他某些排序函式，它會測試所有的程式碼點是否相等，包括未在語言排序配置中提供任何權數的程式碼點。</span><span class="sxs-lookup"><span data-stu-id="4a1db-183">Unlike some other sorting functions, it tests all code points for equality, including those that are not given any weight in linguistic sorting schemes.</span></span>

<span data-ttu-id="4a1db-184">下列所有語句都適用于二進位比較中的 [**CompareStringOrdinal**](/windows/desktop/api/Stringapiset/nf-stringapiset-comparestringordinal) ，但不適用於 [**CompareString**](/windows/win32/api/stringapiset/nf-stringapiset-comparestringw)、 [**CompareStringEx**](/windows/desktop/api/Stringapiset/nf-stringapiset-comparestringex)、 [**lstrcmp**](/windows/win32/api/winbase/nf-winbase-lstrcmpa)或 [**lstrcmpi**](/windows/win32/api/winbase/nf-winbase-lstrcmpia)。</span><span class="sxs-lookup"><span data-stu-id="4a1db-184">All of the following statements apply to [**CompareStringOrdinal**](/windows/desktop/api/Stringapiset/nf-stringapiset-comparestringordinal) in binary comparisons, but not to [**CompareString**](/windows/win32/api/stringapiset/nf-stringapiset-comparestringw), [**CompareStringEx**](/windows/desktop/api/Stringapiset/nf-stringapiset-comparestringex), [**lstrcmp**](/windows/win32/api/winbase/nf-winbase-lstrcmpa), or [**lstrcmpi**](/windows/win32/api/winbase/nf-winbase-lstrcmpia).</span></span>

-   <span data-ttu-id="4a1db-185">標準方式 Unicode 中的對等序列（例如，在上述 (U +) 00e5 的拉丁小寫字母 A）和上面 (U + 0061 U + 030a) 的拉丁小寫字母 A + 組合環形之間，不相等，即使它們顯示的 ( "å" ) 相同也一樣。</span><span class="sxs-lookup"><span data-stu-id="4a1db-185">Canonically equivalent sequences in Unicode, such as LATIN SMALL LETTER A WITH RING ABOVE (U+00e5) and LATIN SMALL LETTER A + COMBINING RING ABOVE (U+0061 U+030a), are not equal even though they appear identical ("å").</span></span>
-   <span data-ttu-id="4a1db-186">以 Unicode 標準方式類似的字串，例如拉丁字母 SMALL 大寫字母 Y (U + 028f) 和拉丁大寫字母 Y (U + 0059) ，看起來非常類似 ( "ʏ" 和 "Y" ) 而且只有在語言資料表中有一些特殊的案例權數，才會被視為完全不同的字元。</span><span class="sxs-lookup"><span data-stu-id="4a1db-186">Canonically similar strings in Unicode, such as LATIN LETTER SMALL CAPITAL Y (U+028f) and LATIN CAPITAL LETTER Y (U+0059), which look very similar ("ʏ" and "Y") and vary only by some special case weights in the linguistic tables, are considered to be entirely dissimilar characters.</span></span> <span data-ttu-id="4a1db-187">即使應用程式將 *bIgnoreCase* 設為 **TRUE**，這些字串仍會比較不同。</span><span class="sxs-lookup"><span data-stu-id="4a1db-187">Even if the application sets *bIgnoreCase* to **TRUE**, these strings compare as different.</span></span>
-   <span data-ttu-id="4a1db-188">已定義但沒有語言排序權數的程式碼點（例如零寬度的連接子 (U + 200d) ）會被視為具有其程式碼點加權。</span><span class="sxs-lookup"><span data-stu-id="4a1db-188">Code points that are defined but have no linguistic sorting weight, such as ZERO WIDTH JOINER (U+200d), are treated as having their code point weights.</span></span>
-   <span data-ttu-id="4a1db-189">在較新版本的 Unicode 中定義的程式碼片段，但目前的語言資料表中沒有權數，會被視為具有其程式碼點加權。</span><span class="sxs-lookup"><span data-stu-id="4a1db-189">Code points that are defined in later versions of Unicode but have no weight in current linguistic tables are treated as having their code point weights.</span></span>
-   <span data-ttu-id="4a1db-190">Unicode 未定義的程式碼點會被視為具有其程式碼點加權。</span><span class="sxs-lookup"><span data-stu-id="4a1db-190">Code points that are undefined by Unicode are treated as having their code point weights.</span></span>
-   <span data-ttu-id="4a1db-191">當應用程式將 *bIgnoreCase* 設為 **TRUE** 時，函式會使用作業系統 uppercasing 資料表來對應案例，而不是語言排序表中的資訊。</span><span class="sxs-lookup"><span data-stu-id="4a1db-191">When the application sets *bIgnoreCase* to **TRUE**, the function maps case using the operating system uppercasing table, instead of the information in the linguistic sorting tables.</span></span> <span data-ttu-id="4a1db-192">因此，對應與地區設定無關。</span><span class="sxs-lookup"><span data-stu-id="4a1db-192">Thus the mapping is independent of locale.</span></span>

<span data-ttu-id="4a1db-193">如需以 Unicode 標準方式對等序列以及 Unicode 中標準方式類似字串的詳細資訊，請參閱 [使用 unicode 正規化來代表字串](using-unicode-normalization-to-represent-strings.md)。</span><span class="sxs-lookup"><span data-stu-id="4a1db-193">For more information about canonically equivalent sequences in Unicode and canonically similar strings in Unicode, see [Using Unicode Normalization to Represent Strings](using-unicode-normalization-to-represent-strings.md).</span></span>

## <a name="sort-code-points"></a><span data-ttu-id="4a1db-194">排序程式代碼點</span><span class="sxs-lookup"><span data-stu-id="4a1db-194">Sort Code Points</span></span>

<span data-ttu-id="4a1db-195">某些 Unicode 程式碼點沒有權數，例如零寬度的非加入點、U + 200c。</span><span class="sxs-lookup"><span data-stu-id="4a1db-195">Some Unicode code points have no weight, for example, ZERO WIDTH NON JOINER, U+200c.</span></span> <span data-ttu-id="4a1db-196">排序函式會刻意將不加權的程式碼點評估為相等，因為它們沒有任何權數可進行排序。</span><span class="sxs-lookup"><span data-stu-id="4a1db-196">The sorting functions intentionally evaluate the no-weight code points as equivalent because they have no weight in sorting.</span></span> <span data-ttu-id="4a1db-197">在 Windows Vista 和更新版本中，應用程式可以藉由呼叫 NLS 字串比較函式（特別是 [**CompareStringOrdinal**](/windows/desktop/api/Stringapiset/nf-stringapiset-comparestringordinal)），以評估常值中的所有程式碼點（例如，在密碼驗證中），來排序這些程式碼點。</span><span class="sxs-lookup"><span data-stu-id="4a1db-197">On Windows Vista and later, the application can sort these code points by calling the NLS string comparison functions, particularly [**CompareStringOrdinal**](/windows/desktop/api/Stringapiset/nf-stringapiset-comparestringordinal), for evaluation of all code points in a literal, binary sense, for example, in password validation.</span></span> <span data-ttu-id="4a1db-198">在 Windows Vista 之前的作業系統上，應用程式應該使用 C 執行時間函數 **strcmp** 或 **wcscmp**。</span><span class="sxs-lookup"><span data-stu-id="4a1db-198">On pre-Windows Vista operating systems, the application should use the C runtime function **strcmp** or **wcscmp**.</span></span>

<span data-ttu-id="4a1db-199">當應用程式指定 hlink NONSPACE 旗標時，排序函式會忽略變音符號，例如非間距的短音符號、U + 0306 \_ 。</span><span class="sxs-lookup"><span data-stu-id="4a1db-199">Sorting functions ignore diacritics, such as NON SPACING BREVE, U+0306, when the application specifies the hlink\_NONSPACE flag.</span></span> <span data-ttu-id="4a1db-200">同樣地，當指定 hlink 符號旗標時，這些函式會忽略符號，例如等號、U + 003d \_ 。</span><span class="sxs-lookup"><span data-stu-id="4a1db-200">Similarly, these functions ignore symbols, for example, EQUALS SIGN, U+003d , when the hlink\_SYMBOLS flag is specified.</span></span> <span data-ttu-id="4a1db-201">在 Windows Vista 和更新版本中，應用程式會呼叫 [**CompareStringOrdinal**](/windows/desktop/api/Stringapiset/nf-stringapiset-comparestringordinal) 來評估常值（二元）中的變音符號和符號代碼點。</span><span class="sxs-lookup"><span data-stu-id="4a1db-201">On Windows Vista and later, the application calls [**CompareStringOrdinal**](/windows/desktop/api/Stringapiset/nf-stringapiset-comparestringordinal) for evaluation of diacritics and symbol code points in a literal, binary sense.</span></span> <span data-ttu-id="4a1db-202">在 Windows Vista 之前的作業系統上，應用程式應該使用 **strcmp** 或 **wcscmp**。</span><span class="sxs-lookup"><span data-stu-id="4a1db-202">On pre-Windows Vista operating systems, the application should use **strcmp** or **wcscmp**.</span></span>

<span data-ttu-id="4a1db-203">某些程式碼點（例如0xFFFF 和0x058b）目前不會以 Unicode 指派。</span><span class="sxs-lookup"><span data-stu-id="4a1db-203">Some code points, such as 0xFFFF and 0x058b, are currently not assigned in Unicode.</span></span> <span data-ttu-id="4a1db-204">這些程式碼點不會在排序中收到任何權數，而且永遠不會傳遞至排序函數。</span><span class="sxs-lookup"><span data-stu-id="4a1db-204">These code points do not receive any weight in sorting, and should never be passed to the sorting functions.</span></span> <span data-ttu-id="4a1db-205">應用程式應該使用 [**IsNLSDefinedString**](/windows/desktop/api/Winnls/nf-winnls-isnlsdefinedstring) 來偵測資料流程中的非 Unicode 程式碼點。</span><span class="sxs-lookup"><span data-stu-id="4a1db-205">The application should use [**IsNLSDefinedString**](/windows/desktop/api/Winnls/nf-winnls-isnlsdefinedstring) to detect non-Unicode code points in a data stream.</span></span>

> [!Note]  
> <span data-ttu-id="4a1db-206">[**IsNLSDefinedString**](/windows/desktop/api/Winnls/nf-winnls-isnlsdefinedstring)的結果可能會根據 unicode 版本而有所不同，如果在較新版本中將字元加入至 unicode，然後再將它加入 Windows 排序表中。</span><span class="sxs-lookup"><span data-stu-id="4a1db-206">Results of [**IsNLSDefinedString**](/windows/desktop/api/Winnls/nf-winnls-isnlsdefinedstring) might vary depending on the Unicode version passed if a character is added to Unicode in a later version and it is subsequently added to the Windows sorting tables.</span></span> <span data-ttu-id="4a1db-207">如需詳細資訊，請參閱 [使用排序版本](#use-sort-versioning)設定。</span><span class="sxs-lookup"><span data-stu-id="4a1db-207">For more information, see [Use Sort Versioning](#use-sort-versioning).</span></span>

 

## <a name="sort-digits-as-numbers"></a><span data-ttu-id="4a1db-208">以數位排序數位</span><span class="sxs-lookup"><span data-stu-id="4a1db-208">Sort Digits as Numbers</span></span>

<span data-ttu-id="4a1db-209">在 Windows 7 和更新版本中，應用程式可以使用 SORT DIGITSASNUMBERS 旗標來呼叫 [**CompareString**](/windows/win32/api/stringapiset/nf-stringapiset-comparestringw)、 [**CompareStringEx**](/windows/desktop/api/Stringapiset/nf-stringapiset-comparestringex)、 [**LCMapString**](/windows/desktop/api/Winnls/nf-winnls-lcmapstringa)或 [**LCMapStringEx**](/windows/desktop/api/Winnls/nf-winnls-lcmapstringex) \_ 。</span><span class="sxs-lookup"><span data-stu-id="4a1db-209">On Windows 7 and later, the application can call [**CompareString**](/windows/win32/api/stringapiset/nf-stringapiset-comparestringw), [**CompareStringEx**](/windows/desktop/api/Stringapiset/nf-stringapiset-comparestringex), [**LCMapString**](/windows/desktop/api/Winnls/nf-winnls-lcmapstringa), or [**LCMapStringEx**](/windows/desktop/api/Winnls/nf-winnls-lcmapstringex) using the SORT\_DIGITSASNUMBERS flag.</span></span> <span data-ttu-id="4a1db-210">此旗標支援將數位視為數位的排序，例如，"2" 之前的排序 "10"。</span><span class="sxs-lookup"><span data-stu-id="4a1db-210">This flag supports sorting that treats digits as numbers, for example, sorting of "2" before "10".</span></span>

<span data-ttu-id="4a1db-211">請注意，使用此旗標不適用於下列的十六進位數位。</span><span class="sxs-lookup"><span data-stu-id="4a1db-211">Note that the use of this flag is not appropriate for hexadecimal digits such as the following.</span></span> <dl> <span data-ttu-id="4a1db-212">01AF</span><span class="sxs-lookup"><span data-stu-id="4a1db-212">01AF</span></span>  
<span data-ttu-id="4a1db-213">1BCD</span><span class="sxs-lookup"><span data-stu-id="4a1db-213">1BCD</span></span>  
<span data-ttu-id="4a1db-214">002A</span><span class="sxs-lookup"><span data-stu-id="4a1db-214">002A</span></span>  
<span data-ttu-id="4a1db-215">12FA</span><span class="sxs-lookup"><span data-stu-id="4a1db-215">12FA</span></span>  
<span data-ttu-id="4a1db-216">AB1C</span><span class="sxs-lookup"><span data-stu-id="4a1db-216">AB1C</span></span>  
<span data-ttu-id="4a1db-217">AB02</span><span class="sxs-lookup"><span data-stu-id="4a1db-217">AB02</span></span>  
<span data-ttu-id="4a1db-218">AB12</span><span class="sxs-lookup"><span data-stu-id="4a1db-218">AB12</span></span>  
</dl>

<span data-ttu-id="4a1db-219">在此情況下，「數位」會依序排序，但使用者會感覺出不正確的十六進位清單。</span><span class="sxs-lookup"><span data-stu-id="4a1db-219">In this case the "numbers" are sorted in order, but the user perceives a poorly sorted hexadecimal list.</span></span>

## <a name="map-strings"></a><span data-ttu-id="4a1db-220">對應字串</span><span class="sxs-lookup"><span data-stu-id="4a1db-220">Map Strings</span></span>

<span data-ttu-id="4a1db-221">如果未指定 LCMAP 的 SORTKEY，則應用程式會使用 [**LCMapString**](/windows/desktop/api/Winnls/nf-winnls-lcmapstringa) 或 [**LCMapStringEx**](/windows/desktop/api/Winnls/nf-winnls-lcmapstringex) 函數來對應字串 \_ 。</span><span class="sxs-lookup"><span data-stu-id="4a1db-221">The application uses the [**LCMapString**](/windows/desktop/api/Winnls/nf-winnls-lcmapstringa) or [**LCMapStringEx**](/windows/desktop/api/Winnls/nf-winnls-lcmapstringex) function to map strings, if LCMAP\_SORTKEY is not specified.</span></span> <span data-ttu-id="4a1db-222">如果來源字串以 null 結束，則對應的字串會以 null 終止。</span><span class="sxs-lookup"><span data-stu-id="4a1db-222">A mapped string is null-terminated if the source string is null-terminated.</span></span>

<span data-ttu-id="4a1db-223">在大寫和小寫之間轉換時，此函式不保證單一字元將對應至單一字元。</span><span class="sxs-lookup"><span data-stu-id="4a1db-223">When transforming between uppercase and lowercase, the function does not guarantee that a single character will map to a single character.</span></span> <span data-ttu-id="4a1db-224">例如，LCMAP \_ 小寫和 LCMAP \_ 大寫字母旗標可能會將德文 ( "ß" ) 對應至本身。</span><span class="sxs-lookup"><span data-stu-id="4a1db-224">For example, the LCMAP\_LOWERCASE and LCMAP\_UPPERCASE flags may map the German Sharp S ("ß") to itself.</span></span> <span data-ttu-id="4a1db-225">或者，LCMAP \_ 大寫旗標可能會將 "ß" 對應至 "ss"，而 LCMAP \_ 小寫旗標可能會將 "ss" 對應至 "ß"。</span><span class="sxs-lookup"><span data-stu-id="4a1db-225">Alternatively, the LCMAP\_UPPERCASE flag may map "ß" to "SS" and the LCMAP\_LOWERCASE flag may map "SS" to "ß".</span></span> <span data-ttu-id="4a1db-226">此行為取決於 NLS 版本。</span><span class="sxs-lookup"><span data-stu-id="4a1db-226">The behavior depends on the NLS version.</span></span>

<span data-ttu-id="4a1db-227">在大寫和小寫之間轉換時，此函式對內容並不敏感。</span><span class="sxs-lookup"><span data-stu-id="4a1db-227">When transforming between uppercase and lowercase, the function is not sensitive to context.</span></span> <span data-ttu-id="4a1db-228">例如，雖然 LCMAP \_ 大寫旗標正確地將希臘文小寫的 sigma ( "σ" ) 和希臘文小寫的最終 sigma ( "σ" ) 到希臘文大寫 sigma ( "σ" ) ，LCMAP \_ 小寫旗標一律會將 "σ" 對應至 "σ"，絕不會將 "σ" 對應至 ""。</span><span class="sxs-lookup"><span data-stu-id="4a1db-228">For example, while the LCMAP\_UPPERCASE flag correctly maps both Greek lowercase sigma ("σ") and Greek lowercase final sigma ("ς") to Greek uppercase sigma ("Σ"), the LCMAP\_LOWERCASE flag always maps "Σ" to "σ", never to "ς".</span></span>

<span data-ttu-id="4a1db-229">根據預設，函式會將小寫 "i" 對應至大寫 "I"，即使 *Locale* 參數指定土耳其文或亞塞拜然。</span><span class="sxs-lookup"><span data-stu-id="4a1db-229">By default, the function maps the lowercase "i" to the uppercase "I", even when the *Locale* parameter specifies Turkish or Azerbaijani.</span></span> <span data-ttu-id="4a1db-230">若要覆寫土耳其文或亞塞拜然的這種行為，應用程式應指定 LCMAP \_ 語言 \_ 大小寫。</span><span class="sxs-lookup"><span data-stu-id="4a1db-230">To override this behavior for Turkish or Azerbaijani, the application should specify LCMAP\_LINGUISTIC\_CASING.</span></span> <span data-ttu-id="4a1db-231">如果使用適當的地區設定來指定此旗標，則 "ı" (小寫的非點按 I) 是小寫形式的 "I" (大寫的非點按 I) 和 "i" (小寫的點) 是小寫形式的 "i" (大寫的點) 。</span><span class="sxs-lookup"><span data-stu-id="4a1db-231">If this flag is specified with the appropriate locale, "ı" (lowercase dotless I) is the lowercase form of "I" (uppercase dotless I) and "i" (lowercase dotted I) is the lowercase form of "İ" (uppercase dotted I).</span></span>

<span data-ttu-id="4a1db-232">如果指定 LCMAP \_ 平假名旗標以將片假名字元對應到平假名字元，而且 \_ 未指定 LCMAP 全形字元，則 [**LCMapString**](/windows/desktop/api/Winnls/nf-winnls-lcmapstringa) 或 [**LCMapStringEx**](/windows/desktop/api/Winnls/nf-winnls-lcmapstringex) 只會將全形字元對應至平假名。</span><span class="sxs-lookup"><span data-stu-id="4a1db-232">If the LCMAP\_HIRAGANA flag is specified to map katakana characters to hiragana characters, and LCMAP\_FULLWIDTH is not specified, [**LCMapString**](/windows/desktop/api/Winnls/nf-winnls-lcmapstringa) or [**LCMapStringEx**](/windows/desktop/api/Winnls/nf-winnls-lcmapstringex) only maps full-width characters to hiragana.</span></span> <span data-ttu-id="4a1db-233">在此情況下，任何半形片假名字元都會放在目的字串中，且不會對應至平假名。</span><span class="sxs-lookup"><span data-stu-id="4a1db-233">In this case, any half-width katakana characters are placed as in the destination string, with no mapping to hiragana.</span></span> <span data-ttu-id="4a1db-234">應用程式必須指定 LCMAP \_ 全半形，將半形片假名字元對應至平假名。</span><span class="sxs-lookup"><span data-stu-id="4a1db-234">The application must specify LCMAP\_FULLWIDTH to map half-width katakana characters to hiragana.</span></span> <span data-ttu-id="4a1db-235">這項限制的原因是所有平假名字元都是全形字元。</span><span class="sxs-lookup"><span data-stu-id="4a1db-235">The reason for this restriction is that all hiragana characters are full-width characters.</span></span>

<span data-ttu-id="4a1db-236">如果應用程式需要從來源字串中去除字元，則可以使用標準 \_ IGNORESYMBOLS 和標準 IGNORENONSPACE 旗標集合來呼叫對應函式 \_ ，並清除所有其他旗標。</span><span class="sxs-lookup"><span data-stu-id="4a1db-236">If the application needs to strip characters from the source string, it can call the mapping function with the NORM\_IGNORESYMBOLS and NORM\_IGNORENONSPACE flags set, and all other flags cleared.</span></span> <span data-ttu-id="4a1db-237">如果應用程式使用不是以 null 結束的來源字串來執行這項工作，則函式可能會傳回空字串，而不會傳回錯誤。</span><span class="sxs-lookup"><span data-stu-id="4a1db-237">If the application does this with a source string that is not null-terminated, it is possible for the function to return an empty string and not return an error.</span></span>

## <a name="create-sort-keys"></a><span data-ttu-id="4a1db-238">建立排序關鍵字</span><span class="sxs-lookup"><span data-stu-id="4a1db-238">Create Sort Keys</span></span>

<span data-ttu-id="4a1db-239">當應用程式指定 LCMAP \_ 排序程式時， [**LCMapString**](/windows/desktop/api/Winnls/nf-winnls-lcmapstringa) 或 [**LCMapStringEx**](/windows/desktop/api/Winnls/nf-winnls-lcmapstringex) 會產生排序索引鍵，也就是位元組值的二進位陣列。</span><span class="sxs-lookup"><span data-stu-id="4a1db-239">When the application specifies LCMAP\_SORTKEY, [**LCMapString**](/windows/desktop/api/Winnls/nf-winnls-lcmapstringa) or [**LCMapStringEx**](/windows/desktop/api/Winnls/nf-winnls-lcmapstringex) generates a sort key, a binary array of byte values.</span></span> <span data-ttu-id="4a1db-240">排序索引鍵不是真正的字串，其值代表來源字串的排序行為，但不是有意義的顯示值。</span><span class="sxs-lookup"><span data-stu-id="4a1db-240">The sort key is not a true string and its values represent the sorting behavior of the source string, but are not meaningful display values.</span></span>

> [!Note]  
> <span data-ttu-id="4a1db-241">函數會在產生排序索引鍵期間忽略阿拉伯文 kashida。</span><span class="sxs-lookup"><span data-stu-id="4a1db-241">The function ignores the Arabic kashida during generation of a sort key.</span></span> <span data-ttu-id="4a1db-242">如果應用程式呼叫函式來建立包含阿拉伯文 kashida 之字串的排序關鍵字，此函數不會建立排序索引鍵值。</span><span class="sxs-lookup"><span data-stu-id="4a1db-242">If an application calls the function to create a sort key for a string containing an Arabic kashida, the function creates no sort key value.</span></span>

 

<span data-ttu-id="4a1db-243">排序索引鍵可以包含奇數位節數目。</span><span class="sxs-lookup"><span data-stu-id="4a1db-243">The sort key can contain an odd number of bytes.</span></span> <span data-ttu-id="4a1db-244">LCMAP \_ BYTEREV 旗標只會反轉偶數的位元組數目。</span><span class="sxs-lookup"><span data-stu-id="4a1db-244">The LCMAP\_BYTEREV flag only reverses an even number of bytes.</span></span> <span data-ttu-id="4a1db-245">排序索引鍵中的最後一個位元組 (奇數位置) 不會反轉。</span><span class="sxs-lookup"><span data-stu-id="4a1db-245">The last byte (odd-positioned) in the sort key is not reversed.</span></span> <span data-ttu-id="4a1db-246">如果終止的0x00 位元組是奇數位置的位元組，它會保留在排序索引鍵中的最後一個位元組。</span><span class="sxs-lookup"><span data-stu-id="4a1db-246">If the terminating 0x00 byte is an odd-positioned byte, it remains the last byte in the sort key.</span></span> <span data-ttu-id="4a1db-247">如果終止的0x00 位元組是一個偶數位置的位元組，它會與之前的位元組交換位置。</span><span class="sxs-lookup"><span data-stu-id="4a1db-247">If the terminating 0x00 byte is an even-positioned byte, it exchanges positions with the byte that precedes it.</span></span>

<span data-ttu-id="4a1db-248">產生排序索引鍵時，函式會以不同于其他標點符號的方式來處理連字號和單引號，如此一來，「共同作業」和「共同作業」這類單字會在清單中保持在一起。</span><span class="sxs-lookup"><span data-stu-id="4a1db-248">When generating the sort key, the function treats the hyphen and apostrophe differently from other punctuation symbols, so that words such as "coop" and "co-op" stay together in a list.</span></span> <span data-ttu-id="4a1db-249">在英數位元之前的連字號和單引號字元以外的所有標點符號符號。</span><span class="sxs-lookup"><span data-stu-id="4a1db-249">All punctuation symbols other than the hyphen and apostrophe sort before alphanumeric characters.</span></span> <span data-ttu-id="4a1db-250">應用程式可以藉由設定 SORT STRINGSORT 旗標來變更此行為 \_ ，如 [排序函數](#sorting-functions)中所述。</span><span class="sxs-lookup"><span data-stu-id="4a1db-250">The application can change this behavior by setting the SORT\_STRINGSORT flag, as described in [Sorting Functions](#sorting-functions).</span></span>

<span data-ttu-id="4a1db-251">在 [memcmp](/cpp/c-runtime-library/reference/memcmp-wmemcmp)中使用時，排序索引鍵會產生與在 [**CompareString**](/windows/win32/api/stringapiset/nf-stringapiset-comparestringw) 或 [**CompareStringEx**](/windows/desktop/api/Stringapiset/nf-stringapiset-comparestringex)中使用來源字串時相同的順序。</span><span class="sxs-lookup"><span data-stu-id="4a1db-251">When used in [memcmp](/cpp/c-runtime-library/reference/memcmp-wmemcmp), the sort key produces the same order as when the source string is used in [**CompareString**](/windows/win32/api/stringapiset/nf-stringapiset-comparestringw) or [**CompareStringEx**](/windows/desktop/api/Stringapiset/nf-stringapiset-comparestringex).</span></span> <span data-ttu-id="4a1db-252">應該使用 [memcmp](/cpp/c-runtime-library/reference/memcmp-wmemcmp) 函式，而不是 [strcmp](/cpp/c-runtime-library/reference/strcmp-wcscmp-mbscmp)，因為排序索引鍵可以有內嵌的 null 位元組。</span><span class="sxs-lookup"><span data-stu-id="4a1db-252">The [memcmp](/cpp/c-runtime-library/reference/memcmp-wmemcmp) function should be used instead of [strcmp](/cpp/c-runtime-library/reference/strcmp-wcscmp-mbscmp), because the sort key can have embedded null bytes.</span></span>

## <a name="use-sort-versioning"></a><span data-ttu-id="4a1db-253">使用排序版本設定</span><span class="sxs-lookup"><span data-stu-id="4a1db-253">Use Sort Versioning</span></span>

<span data-ttu-id="4a1db-254">[排序](sorting.md)資料表有兩個識別其版本的數位：已定義的版本和 NLS 版本。</span><span class="sxs-lookup"><span data-stu-id="4a1db-254">A [sorting](sorting.md) table has two numbers that identify its version: the defined version and the NLS version.</span></span> <span data-ttu-id="4a1db-255">這兩個數字都是 DWORD 值，由主要值和次要值組成。</span><span class="sxs-lookup"><span data-stu-id="4a1db-255">Both numbers are DWORD values, composed of a major value and a minor value.</span></span> <span data-ttu-id="4a1db-256">值的第一個位元組是保留的，接下來的兩個位元組代表主要版本，而最後一個位元組代表次要版本。</span><span class="sxs-lookup"><span data-stu-id="4a1db-256">The first byte of a value is reserved, the next two bytes represent the major version, and the last byte represents the minor version.</span></span> <span data-ttu-id="4a1db-257">以十六進位詞彙來說，此模式為0xRRMMMMmm，其中 R 等於 Reserved、M 等於主要，而 m 等於次要。</span><span class="sxs-lookup"><span data-stu-id="4a1db-257">In hexadecimal terms, the pattern is 0xRRMMMMmm, where R equals Reserved, M equals major, and m equals minor.</span></span> <span data-ttu-id="4a1db-258">例如，次要版本為4的主要版本3會以0x304 表示。</span><span class="sxs-lookup"><span data-stu-id="4a1db-258">For example, a major version of 3 with a minor version of 4 is represented as 0x304.</span></span>

<span data-ttu-id="4a1db-259">定義的版本會識別程式碼點的所有產品，而且所有地區設定都相同。</span><span class="sxs-lookup"><span data-stu-id="4a1db-259">The defined version identifies the repertoire of code points and is the same for all locales.</span></span> <span data-ttu-id="4a1db-260">主要版本會遞增以表示現有程式碼點的變更。</span><span class="sxs-lookup"><span data-stu-id="4a1db-260">The major version increments to indicate changes to existing code points.</span></span> <span data-ttu-id="4a1db-261">次要版本會遞增，以表示已加入程式碼點，但先前尚未變更任何現有的程式碼點。</span><span class="sxs-lookup"><span data-stu-id="4a1db-261">The minor version increments to indicate that code points have been added, but that no previously existing code points have been changed.</span></span>

<span data-ttu-id="4a1db-262">NLS 版本是 [地區設定識別碼](locale-identifiers.md) 或 [地區設定名稱](locale-names.md)的特定版本，並且會追蹤受影響地區設定的程式碼點加權變更。</span><span class="sxs-lookup"><span data-stu-id="4a1db-262">The NLS version is specific to a [locale identifier](locale-identifiers.md) or [locale name](locale-names.md), and tracks changes to code point weights for the affected locale.</span></span> <span data-ttu-id="4a1db-263">當已針對已排序的程式碼點變更加權時，主要版本會遞增。</span><span class="sxs-lookup"><span data-stu-id="4a1db-263">The major version increments when weights are changed for code points that were already sortable.</span></span> <span data-ttu-id="4a1db-264">當新的程式碼點指派權數時，次要版本會遞增，但所有其他先前可排序的程式碼點加權都會保持不變。</span><span class="sxs-lookup"><span data-stu-id="4a1db-264">The minor version increments when new code points are assigned weights, but all other previously sortable code point weights remain unchanged.</span></span>

> [!Note]  
> <span data-ttu-id="4a1db-265">針對主要版本，會變更一或多個程式碼點，讓應用程式必須重新為所有資料重新建立索引，以便讓比較有效。</span><span class="sxs-lookup"><span data-stu-id="4a1db-265">For a major version, one or more code points are changed so that the application must re-index all data for comparisons to be valid.</span></span> <span data-ttu-id="4a1db-266">如果是次要版本，則不會移動任何專案，但會新增程式碼點。</span><span class="sxs-lookup"><span data-stu-id="4a1db-266">For a minor version, nothing is moved but code points are added.</span></span> <span data-ttu-id="4a1db-267">針對此類型的版本，應用程式只需要使用先前不可排序的值來重新編制字串的索引。</span><span class="sxs-lookup"><span data-stu-id="4a1db-267">For this type of version, the application only has to re-index strings with previously unsortable values.</span></span>

 

> [!IMPORTANT]
> <span data-ttu-id="4a1db-268">Windows 8 中的主要版本已變更。</span><span class="sxs-lookup"><span data-stu-id="4a1db-268">The major version has been changed in Windows 8.</span></span> <span data-ttu-id="4a1db-269">在舊版 Windows 下建立的資料必須重新建立索引。</span><span class="sxs-lookup"><span data-stu-id="4a1db-269">Data created under earlier versions of Windows must be re-indexed.</span></span>

 

<span data-ttu-id="4a1db-270">已定義和 NLS 版本都適用于使用 [**LCMapString**](/windows/desktop/api/Winnls/nf-winnls-lcmapstringa) 或 [**LCMAPSTRINGEX**](/windows/desktop/api/Winnls/nf-winnls-lcmapstringex) 函數搭配 LCMAP 分類旗標所抓取的可排序程式代碼點 \_ ，而且 [**CompareString**](/windows/win32/api/stringapiset/nf-stringapiset-comparestringw)、 [**CompareStringEx**](/windows/desktop/api/Stringapiset/nf-stringapiset-comparestringex)、 [**FindNLSString**](/windows/desktop/api/Winnls/nf-winnls-findnlsstring)和 [**FindNLSStringEx**](/windows/desktop/api/Winnls/nf-winnls-findnlsstringex) 函式也會使用此旗標。</span><span class="sxs-lookup"><span data-stu-id="4a1db-270">Both the defined and NLS versions apply to sortable code points retrieved using the [**LCMapString**](/windows/desktop/api/Winnls/nf-winnls-lcmapstringa) or [**LCMapStringEx**](/windows/desktop/api/Winnls/nf-winnls-lcmapstringex) function with the LCMAP\_SORTKEY flag, and also used by the [**CompareString**](/windows/win32/api/stringapiset/nf-stringapiset-comparestringw), [**CompareStringEx**](/windows/desktop/api/Stringapiset/nf-stringapiset-comparestringex), [**FindNLSString**](/windows/desktop/api/Winnls/nf-winnls-findnlsstring), and [**FindNLSStringEx**](/windows/desktop/api/Winnls/nf-winnls-findnlsstringex) functions.</span></span> <span data-ttu-id="4a1db-271">如果字串中的一個或多個程式碼點是不可排序，則當該字串以參數形式傳遞給它時， [**IsNLSDefinedString**](/windows/desktop/api/Winnls/nf-winnls-isnlsdefinedstring) 函數會傳回 **FALSE** 。</span><span class="sxs-lookup"><span data-stu-id="4a1db-271">If one or more code points in a string are unsortable, then the [**IsNLSDefinedString**](/windows/desktop/api/Winnls/nf-winnls-isnlsdefinedstring) function returns **FALSE** when that string is passed to it as a parameter.</span></span>

<span data-ttu-id="4a1db-272">應用程式可以呼叫 [**GetNLSVersion**](/windows/desktop/api/Winnls/nf-winnls-getnlsversion) 或 [**GetNLSVersionEx**](/windows/desktop/api/Winnls/nf-winnls-getnlsversionex) ，以取得排序資料表的已定義版本和 NLS 版本。</span><span class="sxs-lookup"><span data-stu-id="4a1db-272">The application can call either [**GetNLSVersion**](/windows/desktop/api/Winnls/nf-winnls-getnlsversion) or [**GetNLSVersionEx**](/windows/desktop/api/Winnls/nf-winnls-getnlsversionex) to retrieve both the defined version and the NLS version for a sorting table.</span></span>

## <a name="index-the-database"></a><span data-ttu-id="4a1db-273">為資料庫編制索引</span><span class="sxs-lookup"><span data-stu-id="4a1db-273">Index the Database</span></span>

<span data-ttu-id="4a1db-274">基於效能考慮，當編制資料庫的索引時，應用程式應該遵循此程式。</span><span class="sxs-lookup"><span data-stu-id="4a1db-274">For performance reasons, the application should follow this procedure when indexing the database.</span></span>

<span data-ttu-id="4a1db-275">**適當地為資料庫編制索引**</span><span class="sxs-lookup"><span data-stu-id="4a1db-275">**To properly index the database**</span></span>

1.  <span data-ttu-id="4a1db-276">針對每個函式，儲存 NLS 版本、該版本的排序索引鍵，以及每個索引字串的 sortability 指示。</span><span class="sxs-lookup"><span data-stu-id="4a1db-276">For each function, store the NLS version, the sort keys of that version, and an indication of sortability for each indexed string.</span></span>
2.  <span data-ttu-id="4a1db-277">當次要版本遞增時，會重新編制先前不可排序字串的索引。</span><span class="sxs-lookup"><span data-stu-id="4a1db-277">When the minor version increments, re-index previously unsortable strings.</span></span> <span data-ttu-id="4a1db-278">此更新中受影響的字串應該限制為先前已傳回 **FALSE** 的 [**IsNLSDefinedString**](/windows/desktop/api/Winnls/nf-winnls-isnlsdefinedstring) 。</span><span class="sxs-lookup"><span data-stu-id="4a1db-278">The strings affected in this update should be confined to the ones for which [**IsNLSDefinedString**](/windows/desktop/api/Winnls/nf-winnls-isnlsdefinedstring) has previously returned **FALSE**.</span></span>
3.  <span data-ttu-id="4a1db-279">當主要版本遞增時，會重新建立所有字串的索引，因為更新的加權可能會變更任何字串的行為。</span><span class="sxs-lookup"><span data-stu-id="4a1db-279">When the major version increments, re-index all strings because the updated weights might change the behavior of any string.</span></span> <span data-ttu-id="4a1db-280">主要版本版本非常罕見。</span><span class="sxs-lookup"><span data-stu-id="4a1db-280">Major version releases are very infrequent.</span></span>

<span data-ttu-id="4a1db-281">資料庫索引問題可能會因下列原因而發生：</span><span class="sxs-lookup"><span data-stu-id="4a1db-281">Database indexing problems can arise for the following reasons:</span></span>

-   <span data-ttu-id="4a1db-282">較新的作業系統可以定義針對舊版作業系統未定義的程式碼點，進而變更排序。</span><span class="sxs-lookup"><span data-stu-id="4a1db-282">A later operating system can define code points that are undefined for an earlier operating system, thus changing the sort.</span></span>
-   <span data-ttu-id="4a1db-283">由於語言支援中的修正，程式碼點在不同的作業系統中可能會有不同的排序加權。</span><span class="sxs-lookup"><span data-stu-id="4a1db-283">Code points can have different sorting weights in different operating systems, due to corrections in language support.</span></span>

<span data-ttu-id="4a1db-284">為了盡可能減少在這些情況下重新編制資料庫索引的需要，應用程式可以使用 [**IsNLSDefinedString**](/windows/desktop/api/Winnls/nf-winnls-isnlsdefinedstring) 來區別定義自訂的字串，讓應用程式可以使用未定義的程式碼點來拒絕字串。</span><span class="sxs-lookup"><span data-stu-id="4a1db-284">To minimize the necessity to re-index the database in these circumstances, the application can use [**IsNLSDefinedString**](/windows/desktop/api/Winnls/nf-winnls-isnlsdefinedstring) to differentiate defined from undefined strings so that the application can reject strings with undefined code points.</span></span> <span data-ttu-id="4a1db-285">使用 [**GetNLSVersion**](/windows/desktop/api/Winnls/nf-winnls-getnlsversion) 或 [**GetNLSVersionEx**](/windows/desktop/api/Winnls/nf-winnls-getnlsversionex) ，可讓應用程式判斷 NLS 變更是否會影響特定索引資料表所使用的地區設定。</span><span class="sxs-lookup"><span data-stu-id="4a1db-285">Use of [**GetNLSVersion**](/windows/desktop/api/Winnls/nf-winnls-getnlsversion) or [**GetNLSVersionEx**](/windows/desktop/api/Winnls/nf-winnls-getnlsversionex) allows the application to determine if an NLS change affects the locale used for a particular index table.</span></span> <span data-ttu-id="4a1db-286">如果變更對地區設定沒有任何影響，則應用程式不需要重新建立資料表的索引。</span><span class="sxs-lookup"><span data-stu-id="4a1db-286">If the change has no effect on the locale, the application has no need to re-index the table.</span></span>

## <a name="examples"></a><span data-ttu-id="4a1db-287">範例</span><span class="sxs-lookup"><span data-stu-id="4a1db-287">Examples</span></span>

<span data-ttu-id="4a1db-288">下表說明某些旗標搭配排序函數使用的效果。</span><span class="sxs-lookup"><span data-stu-id="4a1db-288">The following table illustrates the effects of certain flags used with the sorting functions.</span></span> <span data-ttu-id="4a1db-289">在每個案例中，旗標的選取範圍會決定兩個不同的字元是否視為相等，以供排序之用。</span><span class="sxs-lookup"><span data-stu-id="4a1db-289">In each case, the selection of flags determines whether two different characters are considered equal for sorting purposes.</span></span>



| <span data-ttu-id="4a1db-290">字元1</span><span class="sxs-lookup"><span data-stu-id="4a1db-290">Character 1</span></span>                                                        | <span data-ttu-id="4a1db-291">字元2</span><span class="sxs-lookup"><span data-stu-id="4a1db-291">Character 2</span></span>                                             | <span data-ttu-id="4a1db-292">預設</span><span class="sxs-lookup"><span data-stu-id="4a1db-292">Default</span></span> | <span data-ttu-id="4a1db-293">標準 \_ IGNOREWIDTH</span><span class="sxs-lookup"><span data-stu-id="4a1db-293">NORM\_IGNOREWIDTH</span></span> | <span data-ttu-id="4a1db-294">標準 \_ IGNOREKANA</span><span class="sxs-lookup"><span data-stu-id="4a1db-294">NORM\_IGNOREKANA</span></span> | <span data-ttu-id="4a1db-295">標準 \_ IGNOREWIDTH </span><span class="sxs-lookup"><span data-stu-id="4a1db-295">NORM\_IGNOREWIDTH</span></span>\| <span data-ttu-id="4a1db-296">NORMIGNOREKANA</span><span class="sxs-lookup"><span data-stu-id="4a1db-296">NORMIGNOREKANA</span></span> |
|--------------------------------------------------------------------|---------------------------------------------------------|---------|-------------------|------------------|------------------------------------|
| <span data-ttu-id="4a1db-297">"あ"</span><span class="sxs-lookup"><span data-stu-id="4a1db-297">"あ"</span></span><br/> <span data-ttu-id="4a1db-298">U + 3042 平假名字母 A</span><span class="sxs-lookup"><span data-stu-id="4a1db-298">U+3042 HIRAGANA LETTER A</span></span><br/>                | <span data-ttu-id="4a1db-299">"ガ"</span><span class="sxs-lookup"><span data-stu-id="4a1db-299">"ガ"</span></span><br/> <span data-ttu-id="4a1db-300">U + 30A2 片假名字母 A</span><span class="sxs-lookup"><span data-stu-id="4a1db-300">U+30A2 KATAKANA LETTER A</span></span><br/>     | <span data-ttu-id="4a1db-301">不等</span><span class="sxs-lookup"><span data-stu-id="4a1db-301">Unequal</span></span> | <span data-ttu-id="4a1db-302">不等</span><span class="sxs-lookup"><span data-stu-id="4a1db-302">Unequal</span></span>           | <span data-ttu-id="4a1db-303">等於</span><span class="sxs-lookup"><span data-stu-id="4a1db-303">Equal</span></span>            | <span data-ttu-id="4a1db-304">等於</span><span class="sxs-lookup"><span data-stu-id="4a1db-304">Equal</span></span>                              |
| <span data-ttu-id="4a1db-305">"ｵ"</span><span class="sxs-lookup"><span data-stu-id="4a1db-305">"ｵ"</span></span><br/> <span data-ttu-id="4a1db-306">U + FF75 半形片假名字母 O</span><span class="sxs-lookup"><span data-stu-id="4a1db-306">U+FF75 HALFWIDTH KATAKANA LETTER O</span></span><br/>       | <span data-ttu-id="4a1db-307">"オ"</span><span class="sxs-lookup"><span data-stu-id="4a1db-307">"オ"</span></span><br/> <span data-ttu-id="4a1db-308">U + 30AA 片假名字母 O</span><span class="sxs-lookup"><span data-stu-id="4a1db-308">U+30AA KATAKANA LETTER O</span></span><br/>     | <span data-ttu-id="4a1db-309">不等</span><span class="sxs-lookup"><span data-stu-id="4a1db-309">Unequal</span></span> | <span data-ttu-id="4a1db-310">等於</span><span class="sxs-lookup"><span data-stu-id="4a1db-310">Equal</span></span>             | <span data-ttu-id="4a1db-311">不等</span><span class="sxs-lookup"><span data-stu-id="4a1db-311">Unequal</span></span>          | <span data-ttu-id="4a1db-312">等於</span><span class="sxs-lookup"><span data-stu-id="4a1db-312">Equal</span></span>                              |
| <span data-ttu-id="4a1db-313">B</span><span class="sxs-lookup"><span data-stu-id="4a1db-313">"Ｂ"</span></span><br/> <span data-ttu-id="4a1db-314">U + FF22 全形拉丁大寫字母 B</span><span class="sxs-lookup"><span data-stu-id="4a1db-314">U+FF22 FULLWIDTH LATIN CAPITAL LETTER B</span></span><br/> | <span data-ttu-id="4a1db-315">"B"</span><span class="sxs-lookup"><span data-stu-id="4a1db-315">"B"</span></span><br/> <span data-ttu-id="4a1db-316">U + 0042 拉丁大寫字母 B</span><span class="sxs-lookup"><span data-stu-id="4a1db-316">U+0042 LATIN CAPITAL LETTER B</span></span><br/> | <span data-ttu-id="4a1db-317">不等</span><span class="sxs-lookup"><span data-stu-id="4a1db-317">Unequal</span></span> | <span data-ttu-id="4a1db-318">等於</span><span class="sxs-lookup"><span data-stu-id="4a1db-318">Equal</span></span>             | <span data-ttu-id="4a1db-319">不等</span><span class="sxs-lookup"><span data-stu-id="4a1db-319">Unequal</span></span>          | <span data-ttu-id="4a1db-320">等於</span><span class="sxs-lookup"><span data-stu-id="4a1db-320">Equal</span></span>                              |



 

## <a name="related-topics"></a><span data-ttu-id="4a1db-321">相關主題</span><span class="sxs-lookup"><span data-stu-id="4a1db-321">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="4a1db-322">使用國家語言支援</span><span class="sxs-lookup"><span data-stu-id="4a1db-322">Using National Language Support</span></span>](using-national-language-support.md)
</dt> <dt>

[<span data-ttu-id="4a1db-323">排序</span><span class="sxs-lookup"><span data-stu-id="4a1db-323">Sorting</span></span>](sorting.md)
</dt> <dt>

[<span data-ttu-id="4a1db-324">正在抓取和設定地區設定資訊</span><span class="sxs-lookup"><span data-stu-id="4a1db-324">Retrieving and Setting Locale Information</span></span>](retrieving-and-setting-locale-information.md)
</dt> <dt>

[<span data-ttu-id="4a1db-325">使用 Unicode 正規化來代表字串</span><span class="sxs-lookup"><span data-stu-id="4a1db-325">Using Unicode Normalization to Represent Strings</span></span>](using-unicode-normalization-to-represent-strings.md)
</dt> <dt>

[<span data-ttu-id="4a1db-326">安全性考慮：國際功能</span><span class="sxs-lookup"><span data-stu-id="4a1db-326">Security Considerations: International Features</span></span>](security-considerations--international-features.md)
</dt> <dt>

[<span data-ttu-id="4a1db-327">**CompareString**</span><span class="sxs-lookup"><span data-stu-id="4a1db-327">**CompareString**</span></span>](/windows/win32/api/stringapiset/nf-stringapiset-comparestringw)
</dt> <dt>

[<span data-ttu-id="4a1db-328">**CompareStringEx**</span><span class="sxs-lookup"><span data-stu-id="4a1db-328">**CompareStringEx**</span></span>](/windows/desktop/api/Stringapiset/nf-stringapiset-comparestringex)
</dt> <dt>

[<span data-ttu-id="4a1db-329">**CompareStringOrdinal**</span><span class="sxs-lookup"><span data-stu-id="4a1db-329">**CompareStringOrdinal**</span></span>](/windows/desktop/api/Stringapiset/nf-stringapiset-comparestringordinal)
</dt> <dt>

[<span data-ttu-id="4a1db-330">**FindNLSString**</span><span class="sxs-lookup"><span data-stu-id="4a1db-330">**FindNLSString**</span></span>](/windows/desktop/api/Winnls/nf-winnls-findnlsstring)
</dt> <dt>

[<span data-ttu-id="4a1db-331">**FindNLSStringEx**</span><span class="sxs-lookup"><span data-stu-id="4a1db-331">**FindNLSStringEx**</span></span>](/windows/desktop/api/Winnls/nf-winnls-findnlsstringex)
</dt> <dt>

[<span data-ttu-id="4a1db-332">**LCMapString**</span><span class="sxs-lookup"><span data-stu-id="4a1db-332">**LCMapString**</span></span>](/windows/desktop/api/Winnls/nf-winnls-lcmapstringa)
</dt> <dt>

[<span data-ttu-id="4a1db-333">**LCMapStringEx**</span><span class="sxs-lookup"><span data-stu-id="4a1db-333">**LCMapStringEx**</span></span>](/windows/desktop/api/Winnls/nf-winnls-lcmapstringex)
</dt> </dl>

 

 
