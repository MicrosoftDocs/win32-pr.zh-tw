---
title: 程式設計腳本常見問題
description: 程式設計腳本常見問題
ms.assetid: 84078c5b-7b04-48fa-9d0a-d95393c323eb
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 28dec468eb5147968ca0db774f081212a78cf40d
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 09/16/2019
ms.locfileid: "104020704"
---
# <a name="programming-scripting-faq"></a><span data-ttu-id="612ea-103">程式設計腳本常見問題</span><span class="sxs-lookup"><span data-stu-id="612ea-103">Programming Scripting FAQ</span></span>

<span data-ttu-id="612ea-104">\[Microsoft Agent 已于 Windows 7 淘汰，在後續的 Windows 版本中可能無法使用。\]</span><span class="sxs-lookup"><span data-stu-id="612ea-104">\[Microsoft Agent is deprecated as of Windows 7, and may be unavailable in subsequent versions of Windows.\]</span></span>

### <a name="when-i-use-microsoft-visual-basic-or-other-development-tools-for-scripting-microsoft-agent-i-do-not-see-all-the-properties-and-events-used-in-your-samples-how-do-i-access-them"></a><span data-ttu-id="612ea-105">當我使用 Microsoft Visual Basic (或其他開發) 工具來撰寫 Microsoft Agent 的腳本時，我看不到您範例中使用的所有屬性和事件。</span><span class="sxs-lookup"><span data-stu-id="612ea-105">When I use Microsoft Visual Basic (or other development tools) for scripting Microsoft Agent, I do not see all the properties and events used in your samples.</span></span> <span data-ttu-id="612ea-106">如何? 存取它們？</span><span class="sxs-lookup"><span data-stu-id="612ea-106">How do I access them?</span></span>

<span data-ttu-id="612ea-107">Microsoft Agent 控制項所支援的大部分事件、方法和屬性，只會在執行時間公開。</span><span class="sxs-lookup"><span data-stu-id="612ea-107">Most of the events, methods, and properties supported by the Microsoft Agent control are exposed only at run time.</span></span> <span data-ttu-id="612ea-108">如需詳細資訊，請參閱 [Microsoft Agent 控制項程式設計](programming-the-microsoft-agent-control.md) 。</span><span class="sxs-lookup"><span data-stu-id="612ea-108">Consult [Programming the Microsoft Agent Control](programming-the-microsoft-agent-control.md) for further information.</span></span>

### <a name="the-map-tag-or-some-other-tag-doesnt-seem-to-work"></a><span data-ttu-id="612ea-109">地圖示記 (或某些其他標記) 似乎無法運作。</span><span class="sxs-lookup"><span data-stu-id="612ea-109">The Map tag (or some other tag) doesn't seem to work.</span></span>

<span data-ttu-id="612ea-110">某些標記包含加上引號的字串。</span><span class="sxs-lookup"><span data-stu-id="612ea-110">Some tags include quoted strings.</span></span> <span data-ttu-id="612ea-111">針對某些程式設計語言（例如 Microsoft Visual Basic 和 Visual Basic Scripting Edition），您可能必須使用兩個引號來指定標記的參數，或串連雙引號字元作為字串的一部分。</span><span class="sxs-lookup"><span data-stu-id="612ea-111">For some programming languages, such as Microsoft Visual Basic and Visual Basic Scripting Edition, you may have to use two quote marks to designate the tag's parameter or concatenate a double-quote character as part of the string.</span></span> <span data-ttu-id="612ea-112">後者會顯示在此 Visual Basic 範例中：</span><span class="sxs-lookup"><span data-stu-id="612ea-112">The latter is shown in this Visual Basic example:</span></span>

<span data-ttu-id="612ea-113">代理 1 "瓶精靈" )  ( 字元。說 "This This \\ map =" + chr (34) + "口頭 text" \_ + chr (34) + "=" + chr (34) + "Balloon text" + chr (34) + " \\ ."</span><span class="sxs-lookup"><span data-stu-id="612ea-113">Agent1.Characters("Genie").Speak "This is \\map=" + chr(34) + "Spoken text" \_ + chr(34) + "=" + chr(34) + "Balloon text" + chr(34) + "\\."</span></span>

<span data-ttu-id="612ea-114">若為 C、c + + 和 JAVA 程式設計，請在反斜線和雙引號前面加上反斜線。</span><span class="sxs-lookup"><span data-stu-id="612ea-114">For C, C++, and Java programming, precede backslashes and double quotes with a backslash.</span></span> <span data-ttu-id="612ea-115">例如：</span><span class="sxs-lookup"><span data-stu-id="612ea-115">For example:</span></span>

<span data-ttu-id="612ea-116">BSTR bszSpeak = SysAllocString (L "This This \\ \\ map = \\ " 說出的文字 \\ "= \\ " Balloon text \\ " \\ \\ " ) ;</span><span class="sxs-lookup"><span data-stu-id="612ea-116">BSTR bszSpeak = SysAllocString(L"This is \\\\map=\\"Spoken text\\"=\\"Balloon text\\"\\\\");</span></span>

<span data-ttu-id="612ea-117">pCharacter >說 (bszSpeak，... ) ;</span><span class="sxs-lookup"><span data-stu-id="612ea-117">pCharacter->Speak(bszSpeak, ......);</span></span>

> [!Note]  
> <span data-ttu-id="612ea-118">Microsoft 代理程式不支援 Microsoft Speech API 中指定的所有標記。</span><span class="sxs-lookup"><span data-stu-id="612ea-118">Microsoft Agent does not support all the tags specified in the Microsoft Speech API.</span></span> <span data-ttu-id="612ea-119">此外，對某些參數的支援可能取決於所安裝的文字轉換語音引擎。</span><span class="sxs-lookup"><span data-stu-id="612ea-119">In addition, support for some parameters may depend on the text-to-speech engine installed.</span></span> <span data-ttu-id="612ea-120">如需詳細資訊，請參閱 [Microsoft Agent 語音輸出標記](microsoft-agent-speech-output-tags.md)。</span><span class="sxs-lookup"><span data-stu-id="612ea-120">For further information, see [Microsoft Agent Speech Output Tags](microsoft-agent-speech-output-tags.md).</span></span>

 

### <a name="i-dont-seem-to-get-requeststart-and-requestcomplete-events-in-my-script-or-program"></a><span data-ttu-id="612ea-121">我似乎未在腳本 (或程式) 中取得 RequestStart 和 RequestComplete 事件。</span><span class="sxs-lookup"><span data-stu-id="612ea-121">I don't seem to get RequestStart and RequestComplete events in my script (or program).</span></span>

<span data-ttu-id="612ea-122">這可能是下列其中一個問題所造成：</span><span class="sxs-lookup"><span data-stu-id="612ea-122">This could be caused by one of the following problems:</span></span>

-   <span data-ttu-id="612ea-123">您的程式設計語言不完全支援 ActiveX 控制項。</span><span class="sxs-lookup"><span data-stu-id="612ea-123">Your programming language doesn't fully support ActiveX controls.</span></span> <span data-ttu-id="612ea-124">請檢查您的檔，以確定它支援 activex 物件的 ActiveX 介面和事件。</span><span class="sxs-lookup"><span data-stu-id="612ea-124">Check your documentation to ensure that it supports the ActiveX interface and events for ActiveX objects.</span></span>
-   <span data-ttu-id="612ea-125">在已編寫腳本的網頁上，另一個控制項無法安裝或載入。</span><span class="sxs-lookup"><span data-stu-id="612ea-125">On a scripted webpage, another control has failed to install or load.</span></span> <span data-ttu-id="612ea-126">檢查以確定所有其他控制項都已正確安裝，且沒有 Microsoft 代理程式可正常載入。</span><span class="sxs-lookup"><span data-stu-id="612ea-126">Check to ensure that all other controls are installed and loading properly without Microsoft Agent.</span></span>
-   <span data-ttu-id="612ea-127">在具有框架的腳本網頁上，您會在 `<OBJECT>` 單一頁面上有 Microsoft Agent 控制項的標記，以及在另一個頁面上編寫腳本的事件。</span><span class="sxs-lookup"><span data-stu-id="612ea-127">On a scripted webpage with frames, you have the `<OBJECT>` tag for the Microsoft Agent control on one page, and the events scripted on another page.</span></span> <span data-ttu-id="612ea-128">事件只會傳送至裝載控制項的頁面。</span><span class="sxs-lookup"><span data-stu-id="612ea-128">Events are sent only to the page that hosts the control.</span></span>

### <a name="i-am-using-the-microsoft-agent-control-with-other-activex-controls-on-my-webpage-and-i-dont-seem-to-get-any-events"></a><span data-ttu-id="612ea-129">我在我的網頁上使用 Microsoft Agent 控制項搭配其他 ActiveX 控制項，但似乎沒有收到任何事件。</span><span class="sxs-lookup"><span data-stu-id="612ea-129">I am using the Microsoft Agent control with other ActiveX controls on my webpage, and I don't seem to get any events.</span></span>

<span data-ttu-id="612ea-130">查看是否已正確安裝其他控制項。</span><span class="sxs-lookup"><span data-stu-id="612ea-130">Check to see if the other controls are correctly installed.</span></span> <span data-ttu-id="612ea-131">如果另一個 ActiveX 控制項無法正確註冊，Microsoft Agent 控制項可能會接收到其事件。</span><span class="sxs-lookup"><span data-stu-id="612ea-131">If another ActiveX control fails to correctly register itself, the Microsoft Agent control may receive its events.</span></span>

### <a name="what-programming-languages-can-i-use-to-program-the-microsoft-agent-control"></a><span data-ttu-id="612ea-132">我可以使用哪些程式設計語言來設計 Microsoft Agent 控制項？</span><span class="sxs-lookup"><span data-stu-id="612ea-132">What programming languages can I use to program the Microsoft Agent control?</span></span>

<span data-ttu-id="612ea-133">Microsoft Agent 應可從支援 ActiveX 介面的任何語言支援。</span><span class="sxs-lookup"><span data-stu-id="612ea-133">Microsoft Agent should be supportable from any language that supports the ActiveX interface.</span></span> <span data-ttu-id="612ea-134">它包含 Visual Basic、VBScript、JScript、C/c + + 和 JAVA 的程式碼範例。</span><span class="sxs-lookup"><span data-stu-id="612ea-134">It includes code samples for Visual Basic, VBScript, JScript, C/C++, and Java.</span></span>

### <a name="can-i-access-the-parameters-returned-from-microsoft-agent-using-jscript"></a><span data-ttu-id="612ea-135">我可以使用 JScript 來存取 Microsoft 代理程式所傳回的參數嗎？</span><span class="sxs-lookup"><span data-stu-id="612ea-135">Can I access the parameters returned from Microsoft Agent using JScript?</span></span>

<span data-ttu-id="612ea-136">是的，但目前唯一的方法是使用 `<SCRIPT LANGUAGE="JScript" FOR="*object*" EVENT="event()">` 語法。</span><span class="sxs-lookup"><span data-stu-id="612ea-136">Yes, but currently the only way to do this is using the `<SCRIPT LANGUAGE="JScript" FOR="*object*" EVENT="event()">` syntax.</span></span> <span data-ttu-id="612ea-137">雖然 Microsoft Internet Explorer 支援這個語法，但其他瀏覽器並不支援，因此您可能會想要避免在頁面的部分腳本中使用 JScript。</span><span class="sxs-lookup"><span data-stu-id="612ea-137">Although this syntax is supported for Microsoft Internet Explorer, other browsers do not support it, so you may want to avoid using JScript for this part of your page's script.</span></span>

### <a name="can-microsoft-agent-be-used-with-speech-recognition-or-speech-synthesis-text-to-speech-or-tts-engines-other-than-those-supplied-by-microsoft"></a><span data-ttu-id="612ea-138">Microsoft 代理程式是否可以搭配語音辨識或語音合成 (Microsoft 提供的文字轉換語音或 TTS) 引擎？</span><span class="sxs-lookup"><span data-stu-id="612ea-138">Can Microsoft Agent be used with speech recognition or speech synthesis (text-to-speech, or TTS) engines other than those supplied by Microsoft?</span></span>

<span data-ttu-id="612ea-139">是的，前提是引擎支援 microsoft 代理程式所需的 Microsoft Speech API (SAPI) 4.0 介面。</span><span class="sxs-lookup"><span data-stu-id="612ea-139">Yes, provided that the engine supports the Microsoft Speech API (SAPI) 4.0 interfaces required by Microsoft Agent.</span></span> <span data-ttu-id="612ea-140">請與引擎供應商確認。</span><span class="sxs-lookup"><span data-stu-id="612ea-140">Check with the engine supplier.</span></span> <span data-ttu-id="612ea-141">如需 Microsoft Agent 所需的 SAPI 介面完整詳細資訊，請參閱 [語音引擎支援需求](speech-engine-support-requirements.md)。</span><span class="sxs-lookup"><span data-stu-id="612ea-141">For complete details on the SAPI interfaces required by Microsoft Agent, see [Speech Engine Support Requirements](speech-engine-support-requirements.md).</span></span>

### <a name="my-page-includes-html-object-tags-for-microsoft-agent-the-lernout--hauspie-truvoice-tts-engine-and-the-microsoft-command-and-control-speech-recognition-engine-but-not-all-the-components-install"></a><span data-ttu-id="612ea-142">[我的頁面] 包含適用于 Microsoft Agent、Lernout & Hauspie TruVoice TTS 引擎的 HTML 物件標記，以及 Microsoft 命令和 Control speech 辨識引擎，但不是所有元件的安裝。</span><span class="sxs-lookup"><span data-stu-id="612ea-142">My page includes HTML Object tags for Microsoft Agent, the Lernout & Hauspie TruVoice TTS engine, and the Microsoft Command and Control speech recognition engine, but not all the components install.</span></span>

<span data-ttu-id="612ea-143">通常，您可以藉由重新整理頁面來修正此問題。</span><span class="sxs-lookup"><span data-stu-id="612ea-143">Typically, the problem can be corrected by refreshing the page.</span></span> <span data-ttu-id="612ea-144">一般來說，最好先指定 Microsoft Agent Control `<OBJECT>` 標記，接著 Lernout & Hauspie TruVoice engine，然後命令和控制語音辨識引擎。</span><span class="sxs-lookup"><span data-stu-id="612ea-144">As a general practice, it is best to specify the Microsoft Agent Control `<OBJECT>` tag first, then the Lernout & Hauspie TruVoice engine, then the Command and Control speech recognition engine.</span></span>

### <a name="after-calling-the-moveto-method-my-character-seems-to-freeze-even-though-i-have-return-animations-assigned-to-moving-state-animations"></a><span data-ttu-id="612ea-145">在呼叫 MoveTo 方法之後，即使我已傳回指派給移動狀態動畫的動畫，我的字元還是會凍結。</span><span class="sxs-lookup"><span data-stu-id="612ea-145">After calling the MoveTo method, my character seems to freeze even though I have Return animations assigned to Moving state animations.</span></span>

<span data-ttu-id="612ea-146">當您播放動畫時，動畫服務會繼續顯示最後一個畫面格，直到呼叫另一個動畫為止。</span><span class="sxs-lookup"><span data-stu-id="612ea-146">When you play an animation, the animation services continue to display its last frame until another animation is called.</span></span> <span data-ttu-id="612ea-147">因此，您應該在呼叫 [**MoveTo**](moveto-method.md)之後播放另一個動畫。</span><span class="sxs-lookup"><span data-stu-id="612ea-147">Therefore, you should play another animation after calling [**MoveTo**](moveto-method.md).</span></span> <span data-ttu-id="612ea-148">如果您定義了 **移動** 狀態動畫的 **傳回動畫，** 伺服器將會先播放動畫。</span><span class="sxs-lookup"><span data-stu-id="612ea-148">If you defined a **Return** animation for the **Moving** state animation, the server will play it first.</span></span>

### <a name="when-i-query-the-characters-pitch-property-it-returns-a-value-of--1"></a><span data-ttu-id="612ea-149">當我查詢字元的「音調」屬性時，它會傳回值-1。</span><span class="sxs-lookup"><span data-stu-id="612ea-149">When I query the character's Pitch property, it returns a value of -1.</span></span>

<span data-ttu-id="612ea-150">如果已使用語音引擎的預設音調屬性編譯字元，就會發生這種情況;也就是說，建立字元時，不會變更音調。</span><span class="sxs-lookup"><span data-stu-id="612ea-150">This occurs if the character has been compiled using a speech engine's default pitch property; that is, the pitch was not changed when the character was built.</span></span>

### <a name="when-my-code-attempts-to-set-the-tts-mode-id-for-a-text-to-speech-engine-i-get-the-following-error-an-outgoing-call-cannot-be-made-since-the-application-is-dispatching-an-input-synchronous-call"></a><span data-ttu-id="612ea-151">當我的程式碼嘗試設定文字轉換語音引擎的 TTS 模式識別碼時，我收到下列錯誤：無法進行外寄呼叫，因為應用程式正在分派輸入同步呼叫。</span><span class="sxs-lookup"><span data-stu-id="612ea-151">When my code attempts to set the TTS mode ID for a text-to-speech engine, I get the following error: An outgoing call cannot be made since the application is dispatching an input-synchronous call.</span></span>

<span data-ttu-id="612ea-152">若要設定 TTSModeID 屬性，您必須安裝 Speech.dll。</span><span class="sxs-lookup"><span data-stu-id="612ea-152">To set the TTSModeID property, you must have Speech.dll installed.</span></span> <span data-ttu-id="612ea-153">這通常是語音引擎安裝程式碼的一部分。</span><span class="sxs-lookup"><span data-stu-id="612ea-153">This is typically a part of the speech engine's installation code.</span></span> <span data-ttu-id="612ea-154">您也可以安裝 [語音物件] 控制台（可從 Microsoft 代理程式下載頁面取得）來安裝此功能。</span><span class="sxs-lookup"><span data-stu-id="612ea-154">You may also install this by installing the Speech object control panel , available from the Microsoft Agent Downloads page.</span></span>

### <a name="when-i-retry-loading-a-character-that-failed-to-load-the-call-fails-with-a-character-already-loaded-error"></a><span data-ttu-id="612ea-155">當我重試載入無法載入的字元時，呼叫會失敗並出現「已載入的字元」錯誤。</span><span class="sxs-lookup"><span data-stu-id="612ea-155">When I retry loading a character that failed to load, the call fails with a "Character already loaded" error.</span></span>

<span data-ttu-id="612ea-156">Microsoft Agent 控制項不會卸載字元物件 (在其相關聯的字元檔載入失敗時，釋放參考) 。</span><span class="sxs-lookup"><span data-stu-id="612ea-156">The Microsoft Agent control does not unload a character object (release the reference) when its associated character file fails to load.</span></span> <span data-ttu-id="612ea-157">如果您想要重試載入該字元，您必須在第二次呼叫 [**Load**](load-method.md)之前明確呼叫 [**Unload**](unload-method.md) 。</span><span class="sxs-lookup"><span data-stu-id="612ea-157">If you want to retry loading the character, you must explicitly call [**Unload**](unload-method.md) before you call [**Load**](load-method.md) the second time.</span></span> <span data-ttu-id="612ea-158">如果您嘗試從網頁腳本進行此操作，您也必須在 **Unload** 呼叫之前加上 On Error Resume Next 語句，否則卸載 **呼叫也** 會失敗。</span><span class="sxs-lookup"><span data-stu-id="612ea-158">If you attempt this from a webpage script, you also need to precede the **Unload** call with an On Error Resume Next statement, or the **Unload** call will also fail.</span></span> <span data-ttu-id="612ea-159"> (請注意，JScript 沒有 On Error Resume Next 語句。 ) </span><span class="sxs-lookup"><span data-stu-id="612ea-159">(Note that JScript has no On Error Resume Next statement.)</span></span>

<span data-ttu-id="612ea-160">不過，當檔案無法載入時，您可能不需要包含程式碼來立即重試載入某個字元。</span><span class="sxs-lookup"><span data-stu-id="612ea-160">However, you may not need to include code to immediately retry loading a character when the file fails to load.</span></span> <span data-ttu-id="612ea-161">Microsoft Internet Explorer 和 Microsoft 代理程式伺服器元件會自動嘗試重試數次，因此您的重試可能會導致在遠端成功載入。</span><span class="sxs-lookup"><span data-stu-id="612ea-161">Microsoft Internet Explorer and the Microsoft Agent server component automatically attempt to retry several times, so the chances that your retry will result in a successful load are remote.</span></span> <span data-ttu-id="612ea-162">更好的策略是等候 (設定計時器) 幾秒鐘後再重試。</span><span class="sxs-lookup"><span data-stu-id="612ea-162">A better strategy is to wait (set a timer) a few seconds before you retry.</span></span>

### <a name="how-can-i-install-microsoft-agent-as-part-of-my-application-or-from-my-web-server"></a><span data-ttu-id="612ea-163">如何在我的應用程式或 web 伺服器上安裝 Microsoft Agent？</span><span class="sxs-lookup"><span data-stu-id="612ea-163">How can I install Microsoft Agent as part of my application or from my web server?</span></span>

<span data-ttu-id="612ea-164">您可以從 Microsoft 網站安裝代理程式，方法是 *在 HTML 物件標記中* 包含其 CLSID。</span><span class="sxs-lookup"><span data-stu-id="612ea-164">You can install Agent from the Microsoft website by including its *CLSID in an HTML Object tag*.</span></span> <span data-ttu-id="612ea-165">但是，如果您想要從自己的應用程式安裝程式或您自己的伺服器包含並安裝代理程式，您必須下載 Microsoft 代理程式自行安裝封包檔，方法是從 [下載] 頁面下載該檔案。</span><span class="sxs-lookup"><span data-stu-id="612ea-165">However, if you want to include and install Agent from your own application installation program or from your own server, you must download the Microsoft Agent self-installing cabinet file, by downloading it from the Downloads page.</span></span> <span data-ttu-id="612ea-166">下載時，請選擇瀏覽器的 [儲存]，而非 [執行] 選項。</span><span class="sxs-lookup"><span data-stu-id="612ea-166">When downloading, choose the browser's Save rather than Run option.</span></span> <span data-ttu-id="612ea-167">每當執行此檔案時，它會自動在目的電腦上安裝 Microsoft 代理程式。</span><span class="sxs-lookup"><span data-stu-id="612ea-167">Whenever this file is run, it automatically will install Microsoft Agent on the target machine.</span></span> <span data-ttu-id="612ea-168">因此，您可以在安裝腳本中指定檔案。</span><span class="sxs-lookup"><span data-stu-id="612ea-168">Therefore you can specify the file in your installation script.</span></span>

<span data-ttu-id="612ea-169">請勿嘗試透過複製其不同的方式來安裝 Microsoft 代理程式。Dll 和嘗試自行註冊。</span><span class="sxs-lookup"><span data-stu-id="612ea-169">Do not attempt to install Microsoft Agent by copying its various .DLLs and attempting to register it yourself.</span></span> <span data-ttu-id="612ea-170">若嘗試以其他方式安裝代理程式，則不支援執行其自行安裝的封包檔。</span><span class="sxs-lookup"><span data-stu-id="612ea-170">Attempting to install Agent by any other means then executing its self-installing cabinet file is not supported.</span></span>

<span data-ttu-id="612ea-171">目標系統也必須包含 MSVCRT.DLL (VC + + 執行時間) 的最新版本，REGSVR32.EXE Microsoft VC + + (和 COM 隨附的) 註冊工具。</span><span class="sxs-lookup"><span data-stu-id="612ea-171">The target system must also include recent versions of MSVCRT.DLL (VC++ runtime), REGSVR32.EXE (registration tool included with Microsoft VC++), and COM.</span></span> <span data-ttu-id="612ea-172">確保安裝正確版本的最佳方式，是要求安裝 Microsoft Internet Explorer 3.02 或更新版本。</span><span class="sxs-lookup"><span data-stu-id="612ea-172">The best way to ensure that the correct versions are installed is to require that Microsoft Internet Explorer 3.02 or later is installed.</span></span> <span data-ttu-id="612ea-173">不過，您也可以授權這些執行時間需求。</span><span class="sxs-lookup"><span data-stu-id="612ea-173">However, you can also license these runtime requirements.</span></span> <span data-ttu-id="612ea-174"> (最新版本的 COM，請從 Microsoft 網站存取 DCOM 更新。 ) </span><span class="sxs-lookup"><span data-stu-id="612ea-174">(For the latest version of COM, access the DCOM update from the Microsoft website.)</span></span>

<span data-ttu-id="612ea-175">由於此版本的作業系統已包含代理程式，因此 microsoft Windows 2000 不會安裝 microsoft 代理程式2.0。</span><span class="sxs-lookup"><span data-stu-id="612ea-175">Microsoft Agent 2.0 will not install on Microsoft Windows 2000 since this version of the operating system already includes Agent.</span></span>

### <a name="can-i-use-the-visual-basic-setup-wizard-to-install-microsoft-agent"></a><span data-ttu-id="612ea-176">我可以使用 Visual Basic 設定向導來安裝 Microsoft 代理程式嗎？</span><span class="sxs-lookup"><span data-stu-id="612ea-176">Can I use the Visual Basic Setup Wizard to install Microsoft Agent?</span></span>

<span data-ttu-id="612ea-177">雖然您可以使用 Visual Basic (VB) 程式碼來建立自己的安裝程式，但您無法使用 Visual Basic 安裝程式來執行此動作。</span><span class="sxs-lookup"><span data-stu-id="612ea-177">While you can create your own installation program using Visual Basic (VB) code you can't use the Visual Basic Setup Wizard to do this.</span></span> <span data-ttu-id="612ea-178">若要從 VB 安裝代理程式，您可以使用 Shell 命令，並指定 Microsoft Agent 自行安裝封包檔。</span><span class="sxs-lookup"><span data-stu-id="612ea-178">To install Agent from VB, you can use Shell command, specifying the Microsoft Agent self-installing cabinet file.</span></span>

### <a name="how-do-i-install-microsoft-agent-on-windows-2000"></a><span data-ttu-id="612ea-179">如何? 在 Windows 2000 上安裝 Microsoft Agent？</span><span class="sxs-lookup"><span data-stu-id="612ea-179">How do I install Microsoft Agent on Windows 2000?</span></span>

<span data-ttu-id="612ea-180">Microsoft Agent 2.0 不會安裝在 Windows 2000 上，因為它已包含在作業系統中。</span><span class="sxs-lookup"><span data-stu-id="612ea-180">Microsoft Agent 2.0 does not install on Windows 2000 because it is already included as a part of the operating system.</span></span>

### <a name="agentsvr-crashes-when-speak-is-called-with-a-wav-file"></a><span data-ttu-id="612ea-181">使用 WAV 檔呼叫說話時，AgentSvr 損毀。</span><span class="sxs-lookup"><span data-stu-id="612ea-181">AgentSvr crashes when Speak is called with a WAV file.</span></span>

<span data-ttu-id="612ea-182">這可能是因為字元已使用 TTS 進行語音輸出，然後變更為使用 WAV 檔案。</span><span class="sxs-lookup"><span data-stu-id="612ea-182">This may result when the character has been using TTS for spoken output, then changes to use a WAV file.</span></span> <span data-ttu-id="612ea-183">未在說話方法的第一個參數中提供文字。</span><span class="sxs-lookup"><span data-stu-id="612ea-183">Text was not supplied in the first parameter of the Speak method.</span></span>

<span data-ttu-id="612ea-184">若要避免損毀，請在說話方法的第一個參數中包含空白字元，即使您沒有文字輸出也一樣。</span><span class="sxs-lookup"><span data-stu-id="612ea-184">To avoid the crash, include a space character in the first parameter of the Speak method, even if you have no text output.</span></span>

### <a name="even-though-i-have-already-installed-the-agent-language-component-dll-for-a-particular-language-i-still-got-an-error-that-the-component-is-missing-when-i-set-the-characters-language-to-that-language"></a><span data-ttu-id="612ea-185">即使我已安裝特定語言的代理程式語言元件 (DLL) ，仍會收到錯誤，指出當我將字元的語言設定為該語言時，元件遺失。</span><span class="sxs-lookup"><span data-stu-id="612ea-185">Even though I have already installed the Agent language component (DLL) for a particular language, I still got an error that the component is missing when I set the character's language to that language.</span></span>

<span data-ttu-id="612ea-186">當您安裝代理程式語言元件時，例如 Microsoft Office 2000 開啟時，通常就會發生這種情況。</span><span class="sxs-lookup"><span data-stu-id="612ea-186">This usually happens when you have Agent applications such as Microsoft Office 2000 open when you install the Agent language component.</span></span> <span data-ttu-id="612ea-187">關閉所有應用程式，然後再試一次。</span><span class="sxs-lookup"><span data-stu-id="612ea-187">Close all applications and try again.</span></span> <span data-ttu-id="612ea-188">如果問題持續發生，請重新開機您的電腦，您應該能夠立即設定語言識別項。</span><span class="sxs-lookup"><span data-stu-id="612ea-188">If the problem persists, restart your computer and you should be able to set the language ID now.</span></span>

### <a name="when-i-use-the-ampersand--symbol-the-text-around-the-symbol-in-the-characters-word-balloons-is-truncated"></a><span data-ttu-id="612ea-189">當我使用連字號 "&" 符號時，會截斷字元在字元的單字批註中的文字周圍文字。</span><span class="sxs-lookup"><span data-stu-id="612ea-189">When I use the ampersand "&" symbol, the text around the symbol in the character's word balloons is truncated.</span></span>

<span data-ttu-id="612ea-190">這是已知的問題。</span><span class="sxs-lookup"><span data-stu-id="612ea-190">This is a known issue.</span></span> <span data-ttu-id="612ea-191">您可以使用 map 標記來解決這個問題。</span><span class="sxs-lookup"><span data-stu-id="612ea-191">You can work around this by using the map tag.</span></span> <span data-ttu-id="612ea-192">例如，若要在字元的字提示字元中顯示 "A & B"，請 \\ 在朗讀語句中使用 "a map =" 和 "=" && " \\ B"。</span><span class="sxs-lookup"><span data-stu-id="612ea-192">For example to display "A & B" in the character's word balloon, use "A \\map="and"="&&"\\ B" in the Speak statement.</span></span>

### <a name="my-application-allows-users-to-change-the-default-character-and-when-they-do-the-program-crashes"></a><span data-ttu-id="612ea-193">我的應用程式可讓使用者變更預設字元，當程式完成時，程式會損毀。</span><span class="sxs-lookup"><span data-stu-id="612ea-193">My application allows users to change the default character and when they do, the program crashes.</span></span>

<span data-ttu-id="612ea-194">有兩個可能的原因：</span><span class="sxs-lookup"><span data-stu-id="612ea-194">There are two possible causes:</span></span>

<span data-ttu-id="612ea-195">如果您變更預設字元的 TTS 模式識別碼，然後允許使用者透過 ShowDefaultCharacterProperties 變更預設字元，AgentSvr 將會損毀。</span><span class="sxs-lookup"><span data-stu-id="612ea-195">If you change the TTS Mode ID of the default character and then allow the user to change the default character through ShowDefaultCharacterProperties, AgentSvr will crash.</span></span>

<span data-ttu-id="612ea-196">此問題已在 Windows 2000 和 Windows XP 作業系統中修正。</span><span class="sxs-lookup"><span data-stu-id="612ea-196">This problem has been fixed in the Windows 2000 and Windows XP operating systems.</span></span> <span data-ttu-id="612ea-197">若要避免在其他平臺上損毀，您應該不要讓使用者在變更預設字元的 TTS 模式識別碼之後變更預設字元，或是不要使用應用程式或網頁中的預設字元。</span><span class="sxs-lookup"><span data-stu-id="612ea-197">To avoid the crash on other platforms, you should either not allow the user to change the default character after you change the default character's TTS Mode ID, or do not use the default character in your application or webpage.</span></span>

<span data-ttu-id="612ea-198">如果您的應用程式未使用 Microsoft 提供的代理程式字元，請確定您的自訂字元使用具有完整調色板256色彩的調色板。</span><span class="sxs-lookup"><span data-stu-id="612ea-198">If your application does not use Microsoft-supplied Agent characters, make sure that your customized character uses a palette with a full palette of 256 colors.</span></span> <span data-ttu-id="612ea-199">如需詳細資訊，請參閱設計 Microsoft Agent 檔的字元。</span><span class="sxs-lookup"><span data-stu-id="612ea-199">For more information see the Designing Characters for Microsoft Agent document.</span></span>

### <a name="my-page-loads-the-agent-character-from-multiple-frames-with-ie-5-i-get-the-microsoft-agent-failed-to-load-error"></a><span data-ttu-id="612ea-200">我的頁面會從多個畫面載入代理程式字元。</span><span class="sxs-lookup"><span data-stu-id="612ea-200">My page loads the Agent character from multiple frames.</span></span> <span data-ttu-id="612ea-201">使用 IE 5 時，我收到 Microsoft 代理程式無法載入錯誤。</span><span class="sxs-lookup"><span data-stu-id="612ea-201">With IE 5, I get the Microsoft Agent failed to load error.</span></span>

<span data-ttu-id="612ea-202">這是 IE 5 的已知問題。</span><span class="sxs-lookup"><span data-stu-id="612ea-202">This is a known issue with IE 5.</span></span> <span data-ttu-id="612ea-203">瀏覽器處理特定事件的方式有所變更，這會導致 HTML 腳本在 AgentSvr 啟動之前開始執行。</span><span class="sxs-lookup"><span data-stu-id="612ea-203">There was a change in how the browser handles a certain event, which causes the HTML script to begin running before AgentSvr is started.</span></span> <span data-ttu-id="612ea-204">為了讓您的頁面能夠與所有版本的瀏覽器搭配使用，您必須將這一行新增至您的腳本：</span><span class="sxs-lookup"><span data-stu-id="612ea-204">In order to make your page work with all versions of the browser, you need to add this line to your script:</span></span>

<span data-ttu-id="612ea-205">AgentControl。 Connected = True</span><span class="sxs-lookup"><span data-stu-id="612ea-205">AgentControl.Connected = True</span></span>

<span data-ttu-id="612ea-206">這會明確建立與 AgentSvr 的連接。</span><span class="sxs-lookup"><span data-stu-id="612ea-206">which explicitly creates a connection to the AgentSvr.</span></span> <span data-ttu-id="612ea-207">請注意，如果您的頁面從多個畫面載入代理程式，您只需要這麼做。</span><span class="sxs-lookup"><span data-stu-id="612ea-207">Note that you only need to do this if your page loads Agent from multiple frames.</span></span>

### <a name="when-my-application-tries-to-install-microsoft-agent-on-windows-2000-or-windows-xp-i-get-the-error-that-agent-is-not-compatible-with-windows-2000-or-windows-xp"></a><span data-ttu-id="612ea-208">當我的應用程式嘗試在 Windows 2000 (或 Windows XP) 上安裝 Microsoft 代理程式時，會收到代理程式與 Windows 2000 (或 Windows XP) 不相容的錯誤。</span><span class="sxs-lookup"><span data-stu-id="612ea-208">When my application tries to install Microsoft Agent on Windows 2000 (or Windows XP), I get the error that Agent is not compatible with Windows 2000 (or Windows XP).</span></span>

<span data-ttu-id="612ea-209">舊版的代理程式核心元件封包檔 MSAGENT.exe，在 Windows 2000 (和 Windows XP) 上執行時，將會封鎖安裝並顯示不正確的錯誤訊息，指出代理程式與您正在執行的作業系統版本不相容。</span><span class="sxs-lookup"><span data-stu-id="612ea-209">A previous version of the Agent core component cabinet file MSAGENT.exe, when executed on Windows 2000 (and Windows XP), will block installation and display an inaccurate error message that Agent is not compatible with the version of the operating system you are running.</span></span> <span data-ttu-id="612ea-210">事實上，Microsoft Agent 2.0 核心元件包含在 Windows 2000 (和 Windows XP) 中，而且預設已透過 Windows 安裝程式安裝。</span><span class="sxs-lookup"><span data-stu-id="612ea-210">In fact, Microsoft Agent 2.0 core components are included as part of Windows 2000 (and Windows XP), and are already installed by default through Windows setup.</span></span>

<span data-ttu-id="612ea-211">在此版本中，會移除檢查，而且安裝檔案不會在 Windows 2000 (或 Windows XP) 中顯示上述的錯誤訊息。</span><span class="sxs-lookup"><span data-stu-id="612ea-211">In this version, the check is removed and the installation file will not display the aforementioned error message under Windows 2000 (or Windows XP).</span></span> <span data-ttu-id="612ea-212">請注意，這是安裝檔案的唯一變更，而代理程式核心元件本身也不會變更任何程式碼。</span><span class="sxs-lookup"><span data-stu-id="612ea-212">Note that this is the only change to the installation file, and there are no code changes to the Agent core components themselves.</span></span> <span data-ttu-id="612ea-213">因此，如果您已安裝代理程式2.0，或您的網站使用物件標記來觸發從 Microsoft 物件存放區自動下載代理程式核心元件，則不會受到此更新的影響。</span><span class="sxs-lookup"><span data-stu-id="612ea-213">Therefore, you are not affected by this update if you already have Agent 2.0 installed, or if your website uses an object tag to trigger automatic downloads of the Agent core components from the Microsoft Object Store.</span></span>

<span data-ttu-id="612ea-214">如果您將代理程式核心元件安裝檔案包含在您的應用程式中，或是在伺服器上張貼安裝檔案，您可能會想要下載此更新。</span><span class="sxs-lookup"><span data-stu-id="612ea-214">If you include the Agent core component installation file with your application, or if you post the installation file on your server, you may want to download this update.</span></span> <span data-ttu-id="612ea-215">若要這樣做，請按一下這裡，然後選取 [將此程式儲存到磁片] 選項。</span><span class="sxs-lookup"><span data-stu-id="612ea-215">To do so, click here and select the "Save this program to disk" option.</span></span> <span data-ttu-id="612ea-216">在這些情況下，您必須具備有效且目前的代理程式散發授權。</span><span class="sxs-lookup"><span data-stu-id="612ea-216">You must have a valid and current Agent distribution license for these circumstances.</span></span>

<span data-ttu-id="612ea-217">或者，您也可以在安裝舊版 MSAGENT.exe 安裝檔案時，使用 [無訊息] 選項來解決這個問題。</span><span class="sxs-lookup"><span data-stu-id="612ea-217">Alternately, you can also work around this problem by using the silent option when installing the previous version of the MSAGENT.exe installation file.</span></span> <span data-ttu-id="612ea-218">Shell 命令為：</span><span class="sxs-lookup"><span data-stu-id="612ea-218">The shell command is:</span></span>

<span data-ttu-id="612ea-219">**MSAGENT.exe/q： a**</span><span class="sxs-lookup"><span data-stu-id="612ea-219">**MSAGENT.exe /q:a**</span></span>

<span data-ttu-id="612ea-220">這同樣適用于1998年10月發行的代理程式語言元件。</span><span class="sxs-lookup"><span data-stu-id="612ea-220">The same applies to the Agent language components that were originally released in October 1998.</span></span> <span data-ttu-id="612ea-221">有一項檢查會防止阿拉伯文、法文、德文、希伯來文、義大利文、日文、韓文、簡體中文、西班牙文和繁體中文語言元件安裝在 Windows 2000 (和 Windows XP) 。</span><span class="sxs-lookup"><span data-stu-id="612ea-221">There was a check that would prevent the Arabic, French, German, Hebrew, Italian, Japanese, Korean, Simplified Chinese, Spanish, and Traditional Chinese language components from installing under Windows 2000 (and Windows XP).</span></span> <span data-ttu-id="612ea-222">這些安裝檔案的較新版本，以及在2000年3月新增的額外19個語言不包含這項檢查，而且將會在 Windows 2000 (和 Windows XP) 上成功安裝。</span><span class="sxs-lookup"><span data-stu-id="612ea-222">The newer versions of these installation files, along with the additional 19 languages added in March 2000, do not contain this check and will install successfully on Windows 2000 (and Windows XP).</span></span>

### <a name="my-customized-character-exhibits-some-unexpected-behavior-with-its-transparency-color-on-windows-2000-and-windows-xp"></a><span data-ttu-id="612ea-223">我的自訂字元在 Windows 2000 (和 Windows XP) 上表現出了一些非預期的行為，以及其透明度色彩。</span><span class="sxs-lookup"><span data-stu-id="612ea-223">My customized character exhibits some unexpected behavior with its transparency color on Windows 2000 (and Windows XP).</span></span>

<span data-ttu-id="612ea-224">這是使用小於256色彩之調色板建立的字元的已知問題。</span><span class="sxs-lookup"><span data-stu-id="612ea-224">This is a known issue for characters created with a palette of less than 256 colors.</span></span> <span data-ttu-id="612ea-225">這些字元的問題包括背景、透明氣球文字、透明氣球框線或透明氣球背景中顯示的透明色彩。</span><span class="sxs-lookup"><span data-stu-id="612ea-225">Issues with these characters include the transparency color showing in the background, transparent balloon text, transparent balloon border, or transparent balloon background.</span></span> <span data-ttu-id="612ea-226">請注意，這類字元可能會導致您的應用程式在 [代理程式字元選擇器] 對話方塊或 Microsoft Office 助理資源庫中載入時損毀。</span><span class="sxs-lookup"><span data-stu-id="612ea-226">Note that such characters may cause your applications to crash when loaded in the Agent character picker dialog or the Microsoft Office Assistant gallery.</span></span> <span data-ttu-id="612ea-227">您自訂的字元必須使用具有256色彩的完整調色板。</span><span class="sxs-lookup"><span data-stu-id="612ea-227">Your customized characters must use a full palette with 256 colors.</span></span> <span data-ttu-id="612ea-228">您可以使用提供給 Office Assistant 字元的範例選擇區，作為具有完整256色調色板的起點。</span><span class="sxs-lookup"><span data-stu-id="612ea-228">You can use the sample palette provided for Office Assistant characters as a starting point with a full 256 color palette.</span></span>

### <a name="the-character-does-not-use-the-british-english-tts-engine-even-though-i-have-set-its-language-id-to-british-english-h0809"></a><span data-ttu-id="612ea-229">即使我已將其語言識別項設定為英式英文 &h0809，字元也不會使用英國英文 TTS 引擎。</span><span class="sxs-lookup"><span data-stu-id="612ea-229">The character does not use the British English TTS engine even though I have set its language ID to British English &h0809.</span></span>

<span data-ttu-id="612ea-230">首先，請確定您已安裝所有必要元件，例如代理程式核心元件、SAPI 執行時間二進位檔，以及 SAPI4 相容的英式英文 TTS 引擎（例如 TTS3000 英式英文引擎），可在代理程式下載頁面上下載。</span><span class="sxs-lookup"><span data-stu-id="612ea-230">First make sure you have all the necessary components installed—Agent core components, the SAPI runtime binaries, and a SAPI4 compliant British English TTS engine like the TTS3000 British English engine, available for download on the Agent Downloads page.</span></span> <span data-ttu-id="612ea-231">如果您的字元仍未使用美式英文 TTS 引擎，您可能也會安裝美式英文 TTS 引擎。</span><span class="sxs-lookup"><span data-stu-id="612ea-231">If your character is still not using the British English TTS engine, it's likely you also have an American English TTS engine installed.</span></span> <span data-ttu-id="612ea-232">由於英國和美式英文兩者共用相同的主要語言 (英文) 和美式英文是預設值，因此代理程式會挑選由 SAPI 傳回的第一個可用的美式英文 TTS 引擎。</span><span class="sxs-lookup"><span data-stu-id="612ea-232">Since both British and American English share the same primary language (English) and American English is the default, Agent will pick the first available American English TTS engine as returned by SAPI.</span></span> <span data-ttu-id="612ea-233">若要使用英式英文的 TTS 引擎，請改用字元的 TTSModeID 屬性。</span><span class="sxs-lookup"><span data-stu-id="612ea-233">To use a British English TTS engine, use the character's TTSModeID property instead.</span></span> <span data-ttu-id="612ea-234">例如，TTS3000 英式英文男性語氣的 TTSModeID 是 {227A0E41-A92A-11d1-B17B-0020AFED142E}。</span><span class="sxs-lookup"><span data-stu-id="612ea-234">For example, the TTSModeID for the TTS3000 British English male voice is {227A0E41-A92A-11d1-B17B-0020AFED142E}.</span></span> <span data-ttu-id="612ea-235">在 Microsoft Visual Basic 您可以藉由設定 Merlin 的 TTSModeID 來使用此引擎，如下所示：</span><span class="sxs-lookup"><span data-stu-id="612ea-235">In Microsoft Visual Basic you can use this engine by setting Merlin's TTSModeID as follows:</span></span>

<span data-ttu-id="612ea-236">AgentControl "Merlin" )  ( 字元。TTSModeID = {227A0E41-A92A-11d1-B17B-0020AFED142E}</span><span class="sxs-lookup"><span data-stu-id="612ea-236">AgentControl.Characters("Merlin").TTSModeID = {227A0E41-A92A-11d1-B17B-0020AFED142E}</span></span>

### <a name="when-the-characters-volume-is-set-to-zero-using-the-speech-tag-vol0-it-either-has-no-effects-or-crashes-the-agentsvr"></a><span data-ttu-id="612ea-237">使用語音標籤 volume = 0 將字元的磁片區設定為零時 \\ \\ ，不會有任何作用或損毀 AgentSvr。</span><span class="sxs-lookup"><span data-stu-id="612ea-237">When the character's volume is set to zero using the speech tag \\Vol=0\\, it either has no effects or crashes the AgentSvr.</span></span>

<span data-ttu-id="612ea-238">這是已知的問題。</span><span class="sxs-lookup"><span data-stu-id="612ea-238">This is a known problem.</span></span> <span data-ttu-id="612ea-239">在 Windows 95、Windows 98 和 Windows Me 作業系統上，字元的磁片區不會變更，但會保留在先前設定的層級。</span><span class="sxs-lookup"><span data-stu-id="612ea-239">On Windows 95, Windows 98, and Windows Me operating systems, the character's volume does not change but will remain at the previously set level.</span></span> <span data-ttu-id="612ea-240">在 Windows NT 4.0、Windows 2000 和 Windows XP 平臺上，這會導致 AgentSvr 損毀，即使未安裝 TTS 引擎也是如此。</span><span class="sxs-lookup"><span data-stu-id="612ea-240">On Windows NT 4.0, Windows 2000 and Windows XP platforms, this will cause AgentSvr to crash, even when a TTS engine is not installed.</span></span> <span data-ttu-id="612ea-241">由於字元的磁片區範圍從 0 (無回應) 為 65535 (最大磁片區) 、很大，而且連續層級之間的差異不會明顯，因此，簡單的因應措施是在您想要聽不清楚字元的聲音時，將磁片區設定為1，而不是0。</span><span class="sxs-lookup"><span data-stu-id="612ea-241">Since the range of the character's volume, from 0 (silence) to 65535 (maximum volume), is large and the difference between successive levels is hardly discernable, the easy workaround is to set the volume to 1 instead of 0 when you want the character's voice to be inaudible.</span></span>

### <a name="my-customized-characters-return-animation-does-not-play-correctly-after-the-movedown-moveleft-moveright-andor-moveup-animations"></a><span data-ttu-id="612ea-242">在 MoveDown、MoveLeft、MoveRight 和/或上移動畫之後，我的自訂字元傳回動畫無法正常播放。</span><span class="sxs-lookup"><span data-stu-id="612ea-242">My customized character's Return animation does not play correctly after the MoveDown, MoveLeft, MoveRight and/or MoveUp animations.</span></span>

<span data-ttu-id="612ea-243">請確定已將簡單的說話動畫指派給說話狀態。</span><span class="sxs-lookup"><span data-stu-id="612ea-243">Make sure a simple speaking animation is assigned to the Speaking State.</span></span> <span data-ttu-id="612ea-244">例如，您可以使用單一框架，其中包含字元的中性位置和嘴重迭。</span><span class="sxs-lookup"><span data-stu-id="612ea-244">For example, you can use a single frame consisting of the character's neutral position with mouth overlays.</span></span>

 

 




