---
title: 命令事件
description: 命令事件
ms.assetid: 3e180286-dfa0-4b34-90ee-3267ed6f48af
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 5647e7eac3aaba0a6094be6b52cc3726eba34ad7
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/19/2020
ms.locfileid: "104023445"
---
# <a name="command-event"></a><span data-ttu-id="40ff4-103">命令事件</span><span class="sxs-lookup"><span data-stu-id="40ff4-103">Command Event</span></span>

<span data-ttu-id="40ff4-104">\[Microsoft Agent 已于 Windows 7 淘汰，在後續的 Windows 版本中可能無法使用。\]</span><span class="sxs-lookup"><span data-stu-id="40ff4-104">\[Microsoft Agent is deprecated as of Windows 7, and may be unavailable in subsequent versions of Windows.\]</span></span>

<dl> <dt>

<span data-ttu-id="40ff4-105"><span id="Description"></span><span id="description"></span><span id="DESCRIPTION"></span>**描述**</span><span class="sxs-lookup"><span data-stu-id="40ff4-105"><span id="Description"></span><span id="description"></span><span id="DESCRIPTION"></span>**Description**</span></span>
</dt> <dd>

<span data-ttu-id="40ff4-106">當使用者選擇 (用戶端的) 命令時發生。</span><span class="sxs-lookup"><span data-stu-id="40ff4-106">Occurs when the user chooses a (client's) command.</span></span>

</dd> <dt>

<span data-ttu-id="40ff4-107"><span id="Syntax"></span><span id="syntax"></span><span id="SYNTAX"></span>**語法**</span><span class="sxs-lookup"><span data-stu-id="40ff4-107"><span id="Syntax"></span><span id="syntax"></span><span id="SYNTAX"></span>**Syntax**</span></span>
</dt> <dd>

<span data-ttu-id="40ff4-108">**子\*\*\*代理程式* \_ **命令** **(ByVal** *userinput> \* \* \* )**</span><span class="sxs-lookup"><span data-stu-id="40ff4-108">**Sub** *agent*\_**Command** **(ByVal** *UserInput\*\*\*)*\*</span></span>



| <span data-ttu-id="40ff4-109">部分</span><span class="sxs-lookup"><span data-stu-id="40ff4-109">Part</span></span>        | <span data-ttu-id="40ff4-110">描述</span><span class="sxs-lookup"><span data-stu-id="40ff4-110">Description</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|-------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="40ff4-111">*Userinput>*</span><span class="sxs-lookup"><span data-stu-id="40ff4-111">*UserInput*</span></span> | <span data-ttu-id="40ff4-112">識別伺服器所傳回的 [**命令**](/windows/desktop/lwef/the-command-object) 物件。</span><span class="sxs-lookup"><span data-stu-id="40ff4-112">Identifies the [**Command**](/windows/desktop/lwef/the-command-object) object returned by the server.</span></span> <br/> <span data-ttu-id="40ff4-113">您可以從 [**命令**](/windows/desktop/lwef/the-command-object) 物件存取下列屬性：</span><span class="sxs-lookup"><span data-stu-id="40ff4-113">The following properties can be accessed from the [**Command**](/windows/desktop/lwef/the-command-object) object:</span></span><br/> <span data-ttu-id="40ff4-114">CharacterID</span><span class="sxs-lookup"><span data-stu-id="40ff4-114">CharacterID</span></span> <br/> <span data-ttu-id="40ff4-115">字串值，識別接收命令的字元 (識別碼) 名稱。</span><span class="sxs-lookup"><span data-stu-id="40ff4-115">A string value identifying the name (ID) of the character that received the command.</span></span> <br/> [<span data-ttu-id="40ff4-116">**Name**</span><span class="sxs-lookup"><span data-stu-id="40ff4-116">**Name**</span></span>](name-property.md)<br/> <span data-ttu-id="40ff4-117">字串值，識別命令 (識別碼) 的名稱。</span><span class="sxs-lookup"><span data-stu-id="40ff4-117">A string value identifying the name (ID) of the command.</span></span><br/> [<span data-ttu-id="40ff4-118">**信賴度**</span><span class="sxs-lookup"><span data-stu-id="40ff4-118">**Confidence**</span></span>](confidence-property.md)<br/> <span data-ttu-id="40ff4-119">長整數值，指出命令的信賴評分。</span><span class="sxs-lookup"><span data-stu-id="40ff4-119">A Long integer value indicating the confidence scoring for the command.</span></span> <br/> [<span data-ttu-id="40ff4-120">**語音**</span><span class="sxs-lookup"><span data-stu-id="40ff4-120">**Voice**</span></span>](voice-property.md) <br/> <span data-ttu-id="40ff4-121">識別命令語音文字的字串值。</span><span class="sxs-lookup"><span data-stu-id="40ff4-121">A string value identifying the voice text for the command.</span></span><br/> <span data-ttu-id="40ff4-122">Alt1Name</span><span class="sxs-lookup"><span data-stu-id="40ff4-122">Alt1Name</span></span> <br/> <span data-ttu-id="40ff4-123">字串值，用來識別下一個 (第二個) 最佳命令的名稱。</span><span class="sxs-lookup"><span data-stu-id="40ff4-123">A string value identifying the name of the next (second) best command.</span></span><br/> <span data-ttu-id="40ff4-124">Alt1Confidence</span><span class="sxs-lookup"><span data-stu-id="40ff4-124">Alt1Confidence</span></span> <br/> <span data-ttu-id="40ff4-125">長整數值，指出下一個 (第一個) 最佳命令的信賴分數。</span><span class="sxs-lookup"><span data-stu-id="40ff4-125">A Long integer value indicating the confidence scoring for the next (second) best command.</span></span><br/> <span data-ttu-id="40ff4-126">Alt1Voice</span><span class="sxs-lookup"><span data-stu-id="40ff4-126">Alt1Voice</span></span> <br/> <span data-ttu-id="40ff4-127">字串值，可識別下一個最佳替代命令相符的語音文字。</span><span class="sxs-lookup"><span data-stu-id="40ff4-127">A string value identifying the voice text for the next best alternative command match.</span></span><br/> <span data-ttu-id="40ff4-128">Alt2Name</span><span class="sxs-lookup"><span data-stu-id="40ff4-128">Alt2Name</span></span> <br/> <span data-ttu-id="40ff4-129">字串值，識別第三個最佳命令相符項的名稱。</span><span class="sxs-lookup"><span data-stu-id="40ff4-129">A string value identifying the name of third best command match.</span></span><br/> <span data-ttu-id="40ff4-130">Alt2Confidence</span><span class="sxs-lookup"><span data-stu-id="40ff4-130">Alt2Confidence</span></span> <br/> <span data-ttu-id="40ff4-131">長整數，識別第三個最佳命令相符項的信賴分數。</span><span class="sxs-lookup"><span data-stu-id="40ff4-131">A Long integer identifying the confidence scoring for the third best command match.</span></span><br/> <span data-ttu-id="40ff4-132">Alt2Voice</span><span class="sxs-lookup"><span data-stu-id="40ff4-132">Alt2Voice</span></span> <br/> <span data-ttu-id="40ff4-133">字串值，識別第三個最佳命令相符的語音文字。</span><span class="sxs-lookup"><span data-stu-id="40ff4-133">A string value identifying the voice text for the third best command match.</span></span><br/> [<span data-ttu-id="40ff4-134">**計數**</span><span class="sxs-lookup"><span data-stu-id="40ff4-134">**Count**</span></span>](count-property.md) <br/> <span data-ttu-id="40ff4-135">長整數值，指出傳回的替代專案數目。</span><span class="sxs-lookup"><span data-stu-id="40ff4-135">Long integer value indicating the number of alternatives returned.</span></span><br/> |



 

</dd> </dl>

### <a name="remarks"></a><span data-ttu-id="40ff4-136">備註</span><span class="sxs-lookup"><span data-stu-id="40ff4-136">Remarks</span></span>

<span data-ttu-id="40ff4-137">當您的應用程式為輸入-主動，且使用者透過朗讀輸入或字元的快顯功能表選擇命令時，伺服器會通知您此事件。</span><span class="sxs-lookup"><span data-stu-id="40ff4-137">The server notifies you with this event when your application is input-active and the user chooses a command by spoken input or character's pop-up menu.</span></span> <span data-ttu-id="40ff4-138">此事件會傳回 [**計數**](count-property.md) 中可能相符的命令數目，以及這些相符專案的名稱、信賴評分和語音文字。</span><span class="sxs-lookup"><span data-stu-id="40ff4-138">The event passes back the number of possible matching commands in [**Count**](count-property.md) as well as the name, confidence scoring, and voice text for those matches.</span></span>

<span data-ttu-id="40ff4-139">如果語音輸入觸發這個事件，伺服器會傳回一個字串來識別 [**Name**](name-property.md) 參數中最符合的專案，以及 Alt1Name 和 Alt2Name 中的第二個和第三個相符專案。</span><span class="sxs-lookup"><span data-stu-id="40ff4-139">If voice input triggers this event, the server returns a string that identifies the best match in the [**Name**](name-property.md) parameter, and the second- and third-best match in Alt1Name and Alt2Name .</span></span> <span data-ttu-id="40ff4-140">空字串表示輸入不符合您的應用程式所定義的任何命令;例如，它可以是伺服器定義的其中一個命令。</span><span class="sxs-lookup"><span data-stu-id="40ff4-140">An empty string indicates that the input did not match any command your application defined; for example, it could be one of the server's defined commands.</span></span> <span data-ttu-id="40ff4-141">如果命令符合代理程式的命令，則為。例如，隱藏， **名稱** 參數中會傳回空字串，但您仍會收到 [**聲音**](voice-property.md) 參數中聽到的文字。</span><span class="sxs-lookup"><span data-stu-id="40ff4-141">If the command was matched to the Agent's command; for example, Hide, an empty string would be returned in the **Name** parameter, but you would still receive the text heard in the [**Voice**](voice-property.md) parameter.</span></span>

<span data-ttu-id="40ff4-142">您可能會在一個以上的專案中傳回相同的命令名稱。</span><span class="sxs-lookup"><span data-stu-id="40ff4-142">You may get the same command name returned in more than one entry.</span></span> <span data-ttu-id="40ff4-143">[**信賴度**](confidence-property.md)、Alt1Confidence 和 Alt2Confidence 參數會將每個對應的語音辨識引擎所傳回的相對分數（範圍介於-100 到100）傳回。</span><span class="sxs-lookup"><span data-stu-id="40ff4-143">[**Confidence**](confidence-property.md), Alt1Confidence , and Alt2Confidence parameters return the relative scores, in the range of -100 to 100, that are returned by the speech recognition engine for each respective match.</span></span> <span data-ttu-id="40ff4-144">[**Voice**](voice-property.md)、Alt1Voice 和 Alt2Voice 參數會傳回語音辨識引擎針對每個替代方案所符合的語音文字。</span><span class="sxs-lookup"><span data-stu-id="40ff4-144">[**Voice**](voice-property.md), Alt1Voice , and Alt2Voice parameters return the voice text that the speech recognition engine matched for each alternative.</span></span> <span data-ttu-id="40ff4-145">如果 [**Count**](count-property.md) 傳回零 (0) ，表示伺服器偵測到說輸入，但卻判斷沒有相符的命令。</span><span class="sxs-lookup"><span data-stu-id="40ff4-145">If [**Count**](count-property.md) returns zero (0), the server detected spoken input, but determined that there was no matching command.</span></span>

<span data-ttu-id="40ff4-146">如果語音輸入不是命令的來源，例如，如果使用者從字元的快顯功能表中選取命令，伺服器會傳回 [ [**名稱**](name-property.md)] 屬性中所選取命令 (識別碼) 的名稱。</span><span class="sxs-lookup"><span data-stu-id="40ff4-146">If voice input was not the source for the command, for example, if the user selected the command from the character's pop-up menu, the server returns the name (ID) of the command selected in the [**Name**](name-property.md)property.</span></span> <span data-ttu-id="40ff4-147">它也會傳回 [**信賴**](confidence-property.md) 參數的值為100，而 [**語音**](voice-property.md) 參數的值為空字串 ( "" ) 。</span><span class="sxs-lookup"><span data-stu-id="40ff4-147">It also returns the value of the [**Confidence**](confidence-property.md) parameter as 100, and the value of the [**Voice**](voice-property.md) parameters as the empty string ("").</span></span> <span data-ttu-id="40ff4-148">Alt1Name 和 Alt2Name 也會傳回空字串。</span><span class="sxs-lookup"><span data-stu-id="40ff4-148">Alt1Name and Alt2Name also return empty strings.</span></span> <span data-ttu-id="40ff4-149">Alt1Confidence 和 Alt2Confidence 會傳回零 (0) ，而 Alt1Voice 和 Alt2Voice 會傳回空字串。</span><span class="sxs-lookup"><span data-stu-id="40ff4-149">Alt1Confidence and Alt2Confidence return zero (0), and Alt1Voice and Alt2Voice return empty strings.</span></span> <span data-ttu-id="40ff4-150">[**Count**](count-property.md) 會傳回1。</span><span class="sxs-lookup"><span data-stu-id="40ff4-150">[**Count**](count-property.md) returns 1.</span></span>

> [!Note]  
> <span data-ttu-id="40ff4-151">並非所有的語音辨識引擎都可能會傳回此事件所有參數的所有值。</span><span class="sxs-lookup"><span data-stu-id="40ff4-151">Not all speech recognition engines may return all the values for all the parameters of this event.</span></span> <span data-ttu-id="40ff4-152">請洽詢您的引擎廠商，判斷引擎是否支援 Microsoft 語音 API 介面，以傳回替代專案和信賴分數。</span><span class="sxs-lookup"><span data-stu-id="40ff4-152">Check with your engine vendor to determine whether the engine supports the Microsoft Speech API interface for returning alternatives and confidence scores.</span></span>

 

 

