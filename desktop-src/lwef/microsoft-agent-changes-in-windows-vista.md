---
title: Windows Vista 中的 Microsoft Agent 變更
description: Windows Vista 中的 Microsoft Agent 變更
ms.assetid: 2498e8d5-2274-477c-a807-77443c76afb7
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 440fb8afb7acb0118c1e48669089c083e935db5b
ms.sourcegitcommit: 967ba3a2a618e6088cb607164a2a924530278645
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 06/30/2021
ms.locfileid: "113102147"
---
# <a name="microsoft-agent-changes-in-windows-vista"></a><span data-ttu-id="bdc39-103">Windows Vista 中的 Microsoft Agent 變更</span><span class="sxs-lookup"><span data-stu-id="bdc39-103">Microsoft Agent Changes in Windows Vista</span></span>

<span data-ttu-id="bdc39-104">\[Microsoft Agent 已于 Windows 7 淘汰，在後續的 Windows 版本中可能無法使用。\]</span><span class="sxs-lookup"><span data-stu-id="bdc39-104">\[Microsoft Agent is deprecated as of Windows 7, and may be unavailable in subsequent versions of Windows.\]</span></span>

<span data-ttu-id="bdc39-105">Windows Vista 引進語音和語音辨識與 Windows Vista 互動的一些變更。</span><span class="sxs-lookup"><span data-stu-id="bdc39-105">Windows Vista introduces some changes in how speech and speech recognition interact with Windows Vista.</span></span>

<span data-ttu-id="bdc39-106">Microsoft Agent 現在支援 SAPI 5 文字轉換語音和語音辨識元件。</span><span class="sxs-lookup"><span data-stu-id="bdc39-106">Microsoft Agent now supports SAPI 5 Text-to-Speech and Speech Recognition components.</span></span> <span data-ttu-id="bdc39-107">代理程式物件的 TTSModeID 和 SRModeID 屬性仍會用來判斷針對代理程式選取的語音或辨識器，以及改變此選取專案。</span><span class="sxs-lookup"><span data-stu-id="bdc39-107">The TTSModeID and SRModeID properties of the Agent object are still used to determine which voice or recognizer is selected for the agent and to alter this selection.</span></span> <span data-ttu-id="bdc39-108">SAPI 4 模式會顯示為 GUID 字串（例如 "{ca141fd0-ac7f-11d1-97a3-006008273000}"），而 SAPI 5 權杖 (相當於模式) 會顯示為一般名稱，例如 "Microsoft Anna"。</span><span class="sxs-lookup"><span data-stu-id="bdc39-108">SAPI 4 modes appear as GUID strings such as "{ca141fd0-ac7f-11d1-97a3-006008273000}", while SAPI 5 tokens (equivalent to modes) appear as regular names, such as "Microsoft Anna".</span></span> <span data-ttu-id="bdc39-109">如同在舊版中，此代理程式會建立預設的 TTS 和 SR 引擎選項。</span><span class="sxs-lookup"><span data-stu-id="bdc39-109">As in earlier releases, the agent will make a default choice of TTS and SR engines.</span></span> <span data-ttu-id="bdc39-110">如果已安裝 SAPI 5 引擎，則這些引擎一律會優先于任何可能安裝的 SAPI 4 引擎。</span><span class="sxs-lookup"><span data-stu-id="bdc39-110">If SAPI 5 engines are installed then these will always be preferred over any SAPI 4 engines that may be installed.</span></span> <span data-ttu-id="bdc39-111">如果使用者的性別符合該字元，則會使用使用者的預設文字轉換語音引擎（如 [控制台] 中所指定），否則會選擇相同性別的 SAPI 5 引擎（如果有的話）。</span><span class="sxs-lookup"><span data-stu-id="bdc39-111">The user's default Text-to-Speech engine, as specified in the control panel, is used if its gender matches that of the character, otherwise a SAPI 5 engine of the same gender is chosen if one is available.</span></span> <span data-ttu-id="bdc39-112">如果有 SAPI 5 引擎，則會忽略直接在字元上指定的模式識別碼。</span><span class="sxs-lookup"><span data-stu-id="bdc39-112">Mode ids specified directly on the character are ignored if SAPI 5 engines are present.</span></span> <span data-ttu-id="bdc39-113">您可以讀取腳本開頭的 TTSModeID 和 SRModeID 屬性，以驗證預設的選取專案。</span><span class="sxs-lookup"><span data-stu-id="bdc39-113">The default selections can be verified by reading the TTSModeID and SRModeID properties at the beginning of your script.</span></span>

<span data-ttu-id="bdc39-114">如同之前，如果文字轉換語音或語音辨識功能不存在，TTSModeID 和 SRModeID 將會傳回空白字串。</span><span class="sxs-lookup"><span data-stu-id="bdc39-114">As before, TTSModeID and SRModeID will return a blank string if the Text-to-Speech or Speech Recognition capability is not present.</span></span> <span data-ttu-id="bdc39-115">您可以藉由將這些屬性設定為適當的 SAPI 4 模式字串或 SAPI 5 權杖名稱，來選取特定的語音或辨識器。</span><span class="sxs-lookup"><span data-stu-id="bdc39-115">A specific voice or recognizer can be selected by setting these properties to the appropriate SAPI 4 mode string or SAPI 5 token name.</span></span> <span data-ttu-id="bdc39-116">設定特定模式或權杖之後，您也可以再次讀取屬性，以確認它的值已被採用，這表示新的模式或權杖確實可用，且已成功選取。</span><span class="sxs-lookup"><span data-stu-id="bdc39-116">After setting a specific mode or token, you can also read the property back again to verify that its value has taken, which indicates that the new mode or token was indeed available, and was successfully selected.</span></span> <span data-ttu-id="bdc39-117">針對透過 web 部署代理程式的開發人員，請注意，有許多 Vista 使用者已經安裝一或多個 SAPI 5 語音，因此您可能會想要避免自動下載 SAPI 4 語音，除非您的腳本明確要求，否則下載的聲音將不會最後使用。</span><span class="sxs-lookup"><span data-stu-id="bdc39-117">For developers deploying Agent over the web, please note that many Vista users will have one or more SAPI 5 voices installed already, so you may want to avoid auto-downloading SAPI 4 voices unless your script specifically requests them, as the downloaded voice would not end up being used.</span></span>

<span data-ttu-id="bdc39-118">SAPI 5 文字轉換語音引擎所使用的一組標準與 SAPI 4 不同，以使用標記來標注語音，例如變更語音的音調或速率。</span><span class="sxs-lookup"><span data-stu-id="bdc39-118">SAPI 5 Text-to-Speech engines use a different set of standards than SAPI 4 for annotating speech with markup, for example to change the pitch or rate of the speech.</span></span> <span data-ttu-id="bdc39-119">在 SAPI 4 中，您可以使用「斜線」命令，例如/pit = 170/。</span><span class="sxs-lookup"><span data-stu-id="bdc39-119">In SAPI 4 you use "slash" commands, such as /pit=170/.</span></span> <span data-ttu-id="bdc39-120">在 SAPI 5 中，您會使用 XML 標記，例如 \<PITCH MIDDLE="5"/> 。</span><span class="sxs-lookup"><span data-stu-id="bdc39-120">In SAPI 5 you use XML tags, such as \<PITCH MIDDLE="5"/>.</span></span> <span data-ttu-id="bdc39-121">在 Vista 中，代理程式將會在「朗讀」方法字串中接受兩種類型的批註：「斜線」命令將會被 SAPI 5 引擎忽略，而「SAPI 4 引擎」將會忽略 XML 標記。</span><span class="sxs-lookup"><span data-stu-id="bdc39-121">In Vista, Agent will accept both types of annotations in Speak method strings "slash" commands will be ignored by SAPI 5 engines, and XML tags will be ignored by SAPI 4 engines.</span></span> <span data-ttu-id="bdc39-122">和斜線標記一樣，支援 SAPI 5 的 XML 標記會因廠商而異，而某些廠商可能會支援其他標記。</span><span class="sxs-lookup"><span data-stu-id="bdc39-122">As with slash tags, support for SAPI 5 XML tags varies from vendor to vendor, and some vendors may support additional tags.</span></span> <span data-ttu-id="bdc39-123">如需有關 SAPI 5 XML 標記的詳細資訊，請參閱 SAPI 5 規格。</span><span class="sxs-lookup"><span data-stu-id="bdc39-123">For more information on SAPI 5 XML tags, please see the SAPI 5 Specification.</span></span>

<span data-ttu-id="bdc39-124">代理程式已不再支援多種語言。</span><span class="sxs-lookup"><span data-stu-id="bdc39-124">Agent no longer includes support for multiple languages.</span></span> <span data-ttu-id="bdc39-125">代理程式所使用的語言一律會假設為使用者目前的語言，並向作業系統註冊。</span><span class="sxs-lookup"><span data-stu-id="bdc39-125">The language used by Agent is always assumed to be the user's current language, as registered with the operating system.</span></span> <span data-ttu-id="bdc39-126">Agent 物件的 LanguageID 屬性仍然是可寫入的，但 Vista 上的代理程式會忽略它的值。</span><span class="sxs-lookup"><span data-stu-id="bdc39-126">The LanguageID property of the Agent object is still writable, but its value is ignored by Agent on Vista.</span></span> <span data-ttu-id="bdc39-127">例如，如果使用者的語言設定為美式英文 (&H0409) ，而他或她使用將 LanguageID 設定為法文 (&H040C) 的程式，則 [語音提示文字] 和 [先進字元選項] 對話方塊仍會以英文顯示。</span><span class="sxs-lookup"><span data-stu-id="bdc39-127">For example if the user's language is set to US English (&H0409), and he or she uses a program that sets the LanguageID to French (&H040C), then the voice tip text, and Advanced Character Options dialogs will still appear in English.</span></span>

 

 




