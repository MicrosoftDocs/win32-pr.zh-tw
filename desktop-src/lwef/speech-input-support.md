---
title: 語音輸入支援
description: 語音輸入支援
ms.assetid: 4702b941-fcc9-4d00-aba2-eca624b6d417
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b8ecb6f2ddfbbe10f8b892ce922cd466eca96890
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/19/2020
ms.locfileid: "106968091"
---
# <a name="speech-input-support"></a><span data-ttu-id="ece7c-103">語音輸入支援</span><span class="sxs-lookup"><span data-stu-id="ece7c-103">Speech Input Support</span></span>

<span data-ttu-id="ece7c-104">\[Microsoft Agent 已于 Windows 7 淘汰，在後續的 Windows 版本中可能無法使用。\]</span><span class="sxs-lookup"><span data-stu-id="ece7c-104">\[Microsoft Agent is deprecated as of Windows 7, and may be unavailable in subsequent versions of Windows.\]</span></span>

<span data-ttu-id="ece7c-105">除了支援滑鼠和鍵盤互動之外，Microsoft Agent 還包含語音輸入的直接支援。</span><span class="sxs-lookup"><span data-stu-id="ece7c-105">In addition to supporting mouse and keyboard interaction, Microsoft Agent includes direct support for speech input.</span></span> <span data-ttu-id="ece7c-106">由於 Microsoft 代理程式的語音輸入支援是以 Microsoft SAPI (語音應用程式開發介面) 為基礎，因此您可以搭配使用 Microsoft Agent 與語音辨識命令和控制引擎（包括支援 SAPI 的支援）。</span><span class="sxs-lookup"><span data-stu-id="ece7c-106">Because Microsoft Agent's support for speech input is based on Microsoft SAPI (Speech Application Programming Interface), you can use Microsoft Agent with speech recognition command and control engines that include the SAPI-required support.</span></span> <span data-ttu-id="ece7c-107">如需語音引擎需求的詳細資訊，請參閱 [語音引擎支援需求](requirements-for-speech-recognition-engines.md)。</span><span class="sxs-lookup"><span data-stu-id="ece7c-107">For more information on speech engine requirements, see [Speech Engine Support Requirements](requirements-for-speech-recognition-engines.md).</span></span>

<span data-ttu-id="ece7c-108">Microsoft 提供可與 Microsoft 代理程式搭配使用的命令和控制語音辨識引擎。</span><span class="sxs-lookup"><span data-stu-id="ece7c-108">Microsoft provides a command-and-control speech recognition engine you can use with Microsoft Agent.</span></span> <span data-ttu-id="ece7c-109">如需詳細資訊，請參閱 [語音引擎選取](speech-engine-selection.md)。</span><span class="sxs-lookup"><span data-stu-id="ece7c-109">For more information, see [Speech Engine Selection](speech-engine-selection.md).</span></span>

<span data-ttu-id="ece7c-110">使用者可以藉由按下並按住對話接聽熱鍵來起始語音輸入。</span><span class="sxs-lookup"><span data-stu-id="ece7c-110">The user can initiate speech input by pressing and holding the push-to-talk Listening hotkey.</span></span> <span data-ttu-id="ece7c-111">在此接聽模式中，如果語音引擎收到說話輸入的開頭，則會將音訊通道保持在開啟狀態，直到偵測到語句結束為止。</span><span class="sxs-lookup"><span data-stu-id="ece7c-111">In this Listening mode, if the speech engine receives the beginning of spoken input, it holds the audio channel open until it detects the end of the utterance.</span></span> <span data-ttu-id="ece7c-112">不過，若未收到輸入，則不會封鎖音訊輸出。</span><span class="sxs-lookup"><span data-stu-id="ece7c-112">However, when not receiving input, it does not block audio output.</span></span> <span data-ttu-id="ece7c-113">這可讓使用者在按住按鍵時發出多個語音命令，而當使用者不說話時，該字元可能會回應。</span><span class="sxs-lookup"><span data-stu-id="ece7c-113">This enables the user to issue multiple voice commands while holding down the key, and the character can respond when the user isn't speaking.</span></span>

<span data-ttu-id="ece7c-114">當使用者放開接聽金鑰之後，接聽模式就會超時。</span><span class="sxs-lookup"><span data-stu-id="ece7c-114">The Listening mode times out once the user releases the Listening key.</span></span> <span data-ttu-id="ece7c-115">使用者可以使用 Advanced Character 選項來調整此模式的超時時間。</span><span class="sxs-lookup"><span data-stu-id="ece7c-115">The user can adjust the time-out for this mode using the Advanced Character Options.</span></span> <span data-ttu-id="ece7c-116">您無法從用戶端應用程式程式碼設定此超時時間。</span><span class="sxs-lookup"><span data-stu-id="ece7c-116">You cannot set this time-out from your client application code.</span></span>

<span data-ttu-id="ece7c-117">如果字元在使用者說話時嘗試說話，則字元的聲音輸出會失敗，但文字可能仍會顯示在其文字氣球中。</span><span class="sxs-lookup"><span data-stu-id="ece7c-117">If a character attempts to speak while the user is speaking, the character's audible output fails though text may still be displayed in its word balloon.</span></span> <span data-ttu-id="ece7c-118">如果在按下接聽鍵時，字元有音訊通道，伺服器會在處理 [**說話**](speak-method.md) 方法中的文字後，自動將控制權轉移回給使用者。</span><span class="sxs-lookup"><span data-stu-id="ece7c-118">If the character has the audio channel while the Listening key is pressed, the server automatically transfers control back to the user after processing the text in the [**Speak**](speak-method.md) method.</span></span> <span data-ttu-id="ece7c-119">系統會播放選用的 MIDI 音以提示使用者開始說話。</span><span class="sxs-lookup"><span data-stu-id="ece7c-119">An optional MIDI tone is played to cue the user to begin speaking.</span></span> <span data-ttu-id="ece7c-120">這可讓使用者提供輸入，即使驅動該字元的應用程式無法在其輸出中提供邏輯暫停。</span><span class="sxs-lookup"><span data-stu-id="ece7c-120">This enables the user to provide input even if the application driving the character failed to provide logical pauses in its output.</span></span>

<span data-ttu-id="ece7c-121">您也可以使用 [**接聽**](listen-method.md) 方法來起始語音輸入。</span><span class="sxs-lookup"><span data-stu-id="ece7c-121">You can also use the [**Listen**](listen-method.md) method to initiate speech input.</span></span> <span data-ttu-id="ece7c-122">呼叫這個方法會開啟語音辨識一段預先定義的時間。</span><span class="sxs-lookup"><span data-stu-id="ece7c-122">Calling this method turns on the speech recognition for a predefined period of time.</span></span> <span data-ttu-id="ece7c-123">如果在此間隔期間沒有輸入，Microsoft Agent 會自動關閉語音辨識引擎並釋出音訊頻道。</span><span class="sxs-lookup"><span data-stu-id="ece7c-123">If there is no input during this interval, Microsoft Agent automatically turns off the speech recognition engine and frees up the audio channel.</span></span> <span data-ttu-id="ece7c-124">這可避免封鎖音訊裝置的輸入或輸出，並將語音辨識在開啟時所使用的處理器額外負荷降至最低。</span><span class="sxs-lookup"><span data-stu-id="ece7c-124">This avoids blocking input to or output from the audio device and minimizes the processor overhead the speech recognition uses when it is on.</span></span> <span data-ttu-id="ece7c-125">您也可以使用 **接聽** 方法來關閉語音輸入。</span><span class="sxs-lookup"><span data-stu-id="ece7c-125">You can also use the **Listen** method to turn off speech input.</span></span> <span data-ttu-id="ece7c-126">不過，請注意，由於語音辨識引擎會以非同步方式運作，因此效果可能不會立即生效。</span><span class="sxs-lookup"><span data-stu-id="ece7c-126">However, be aware that because the speech recognition engine operates asynchronously, the effect may not be immediate.</span></span> <span data-ttu-id="ece7c-127">如此一來，即使在程式碼呼叫「**接聽**」之後，也可能會收到 [**命令**](command-event.md)事件，以關閉語音輸入。</span><span class="sxs-lookup"><span data-stu-id="ece7c-127">As a result, it is possible to receive a [**Command**](command-event.md) event even after your code called **Listen** to turn off speech input.</span></span>

<span data-ttu-id="ece7c-128">若要支援語音輸入，您可以定義一個 *文法*，也就是您想要讓語音辨識引擎接聽並比對的一組文字，做為 [**命令**](/windows/desktop/lwef/the-commands-collection-object)集合中 [**命令**](/windows/desktop/lwef/the-command-object)的 **語音** 設定。</span><span class="sxs-lookup"><span data-stu-id="ece7c-128">To support speech input, you define a *grammar*, a set of words you want the speech recognition engine to listen and match for as the **Voice** setting for a [**Command**](/windows/desktop/lwef/the-command-object) in your [**Commands**](/windows/desktop/lwef/the-commands-collection-object) collection.</span></span> <span data-ttu-id="ece7c-129">您可以在文法中包含選擇性和替代的單字和重複的序列。</span><span class="sxs-lookup"><span data-stu-id="ece7c-129">You can include optional and alternative words and repeated sequences in your grammar.</span></span> <span data-ttu-id="ece7c-130">請注意，代理程式在其中一個用戶端已成功載入語音引擎或針對其中一個 **命令** 物件撰寫 **語音** 之前，並不會啟用接聽熱鍵。</span><span class="sxs-lookup"><span data-stu-id="ece7c-130">Note that Agent does not enable the Listening hotkey until one of its clients has successfully loaded a speech engine or has authored a **Voice** for one of its **Command** objects.</span></span>

<span data-ttu-id="ece7c-131">無論使用者按下接聽的熱鍵或用戶端應用程式呼叫 [**接聽**](listen-method.md) 方法來起始語音輸入，語音辨識引擎都會嘗試比對語句的輸入與已定義之命令的文法，然後將資訊傳回給伺服器。</span><span class="sxs-lookup"><span data-stu-id="ece7c-131">Whether the user presses the Listening hotkey or your client application calls the [**Listen**](listen-method.md) method to initiate speech input, the speech recognition engine attempts to match an utterance's input to the grammar for the commands that have been defined, and passes the information back the server.</span></span> <span data-ttu-id="ece7c-132">然後伺服器會使用 [**命令**](command-event.md) 事件 ([**IAgentNotifySink：： command**](iagentnotifysink--command.md)) ; 來通知用戶端應用程式。傳回 [**userinput>**](/windows/desktop/lwef/iagentuserinput) 物件，其中包含最符合的命令識別碼和接下來兩個替代專案 (如果有任何) 、信賴分數，以及每個相符專案的相符文字。</span><span class="sxs-lookup"><span data-stu-id="ece7c-132">The server then notifies the client application using the [**Command**](command-event.md) event ([**IAgentNotifySink::Command**](iagentnotifysink--command.md)); passing back the [**UserInput**](/windows/desktop/lwef/iagentuserinput) object that includes the command ID of the best match and next two alternative matches (if any), a confidence score, and the matching text for each match.</span></span>

<span data-ttu-id="ece7c-133">當用戶端應用程式符合語音輸入時，也會通知用戶端應用程式其所提供的其中一個命令。</span><span class="sxs-lookup"><span data-stu-id="ece7c-133">The server also notifies your client application when it matches the speech input to one of its supplied commands.</span></span> <span data-ttu-id="ece7c-134">雖然命令識別碼是 **Null**，但您仍然可以取得信賴分數和文字。</span><span class="sxs-lookup"><span data-stu-id="ece7c-134">While the command ID is **NULL**, you still get the confidence score and text matched.</span></span> <span data-ttu-id="ece7c-135">處於接聽模式時，伺服器會自動播放指派給該字元 **接聽** 狀態的動畫。</span><span class="sxs-lookup"><span data-stu-id="ece7c-135">When in Listening mode, the server automatically plays the animation assigned to the character's **Listening** state.</span></span> <span data-ttu-id="ece7c-136">然後，當實際偵測到語句時，伺服器就會播放該字元的 **聽力** 狀態動畫。</span><span class="sxs-lookup"><span data-stu-id="ece7c-136">Then, when an utterance is actually detected, the server plays the character's **Hearing** state animation.</span></span> <span data-ttu-id="ece7c-137">在語句結束之前，伺服器會將字元保留在用心狀態中。</span><span class="sxs-lookup"><span data-stu-id="ece7c-137">The server will keep the character in an attentive state until the utterance has ended.</span></span> <span data-ttu-id="ece7c-138">這會提供適當的社交意見反應，以提示使用者輸入。</span><span class="sxs-lookup"><span data-stu-id="ece7c-138">This provides the appropriate social feedback to cue the user for input.</span></span>

<span data-ttu-id="ece7c-139">如果使用者停用 [先進字元選項] 中的語音輸入，則也會停用接聽熱鍵。</span><span class="sxs-lookup"><span data-stu-id="ece7c-139">If the user disables speech input in Advanced Character Options, the Listening hotkey will also be disabled.</span></span> <span data-ttu-id="ece7c-140">同樣地，在停用語音輸入時嘗試呼叫 [**接聽**](listen-method.md) 方法會導致方法失敗。</span><span class="sxs-lookup"><span data-stu-id="ece7c-140">Similarly, attempting to call the [**Listen**](listen-method.md) method when speech input is disabled will cause the method to fail.</span></span>

 

 