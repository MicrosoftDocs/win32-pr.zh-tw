---
title: 語音輸入支援
description: 語音輸入支援
ms.assetid: 4702b941-fcc9-4d00-aba2-eca624b6d417
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b8ecb6f2ddfbbe10f8b892ce922cd466eca96890
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/19/2020
ms.locfileid: "106968091"
---
# <a name="speech-input-support"></a>語音輸入支援

\[Microsoft Agent 已于 Windows 7 淘汰，在後續的 Windows 版本中可能無法使用。\]

除了支援滑鼠和鍵盤互動之外，Microsoft Agent 還包含語音輸入的直接支援。 由於 Microsoft 代理程式的語音輸入支援是以 Microsoft SAPI (語音應用程式開發介面) 為基礎，因此您可以搭配使用 Microsoft Agent 與語音辨識命令和控制引擎（包括支援 SAPI 的支援）。 如需語音引擎需求的詳細資訊，請參閱 [語音引擎支援需求](requirements-for-speech-recognition-engines.md)。

Microsoft 提供可與 Microsoft 代理程式搭配使用的命令和控制語音辨識引擎。 如需詳細資訊，請參閱 [語音引擎選取](speech-engine-selection.md)。

使用者可以藉由按下並按住對話接聽熱鍵來起始語音輸入。 在此接聽模式中，如果語音引擎收到說話輸入的開頭，則會將音訊通道保持在開啟狀態，直到偵測到語句結束為止。 不過，若未收到輸入，則不會封鎖音訊輸出。 這可讓使用者在按住按鍵時發出多個語音命令，而當使用者不說話時，該字元可能會回應。

當使用者放開接聽金鑰之後，接聽模式就會超時。 使用者可以使用 Advanced Character 選項來調整此模式的超時時間。 您無法從用戶端應用程式程式碼設定此超時時間。

如果字元在使用者說話時嘗試說話，則字元的聲音輸出會失敗，但文字可能仍會顯示在其文字氣球中。 如果在按下接聽鍵時，字元有音訊通道，伺服器會在處理 [**說話**](speak-method.md) 方法中的文字後，自動將控制權轉移回給使用者。 系統會播放選用的 MIDI 音以提示使用者開始說話。 這可讓使用者提供輸入，即使驅動該字元的應用程式無法在其輸出中提供邏輯暫停。

您也可以使用 [**接聽**](listen-method.md) 方法來起始語音輸入。 呼叫這個方法會開啟語音辨識一段預先定義的時間。 如果在此間隔期間沒有輸入，Microsoft Agent 會自動關閉語音辨識引擎並釋出音訊頻道。 這可避免封鎖音訊裝置的輸入或輸出，並將語音辨識在開啟時所使用的處理器額外負荷降至最低。 您也可以使用 **接聽** 方法來關閉語音輸入。 不過，請注意，由於語音辨識引擎會以非同步方式運作，因此效果可能不會立即生效。 如此一來，即使在程式碼呼叫「**接聽**」之後，也可能會收到 [**命令**](command-event.md)事件，以關閉語音輸入。

若要支援語音輸入，您可以定義一個 *文法*，也就是您想要讓語音辨識引擎接聽並比對的一組文字，做為 [**命令**](/windows/desktop/lwef/the-commands-collection-object)集合中 [**命令**](/windows/desktop/lwef/the-command-object)的 **語音** 設定。 您可以在文法中包含選擇性和替代的單字和重複的序列。 請注意，代理程式在其中一個用戶端已成功載入語音引擎或針對其中一個 **命令** 物件撰寫 **語音** 之前，並不會啟用接聽熱鍵。

無論使用者按下接聽的熱鍵或用戶端應用程式呼叫 [**接聽**](listen-method.md) 方法來起始語音輸入，語音辨識引擎都會嘗試比對語句的輸入與已定義之命令的文法，然後將資訊傳回給伺服器。 然後伺服器會使用 [**命令**](command-event.md) 事件 ([**IAgentNotifySink：： command**](iagentnotifysink--command.md)) ; 來通知用戶端應用程式。傳回 [**userinput>**](/windows/desktop/lwef/iagentuserinput) 物件，其中包含最符合的命令識別碼和接下來兩個替代專案 (如果有任何) 、信賴分數，以及每個相符專案的相符文字。

當用戶端應用程式符合語音輸入時，也會通知用戶端應用程式其所提供的其中一個命令。 雖然命令識別碼是 **Null**，但您仍然可以取得信賴分數和文字。 處於接聽模式時，伺服器會自動播放指派給該字元 **接聽** 狀態的動畫。 然後，當實際偵測到語句時，伺服器就會播放該字元的 **聽力** 狀態動畫。 在語句結束之前，伺服器會將字元保留在用心狀態中。 這會提供適當的社交意見反應，以提示使用者輸入。

如果使用者停用 [先進字元選項] 中的語音輸入，則也會停用接聽熱鍵。 同樣地，在停用語音輸入時嘗試呼叫 [**接聽**](listen-method.md) 方法會導致方法失敗。

 

 