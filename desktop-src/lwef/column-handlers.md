---
title: 建立資料行處理常式
description: Windows Windows 檔案總管中的詳細資料檢視通常會顯示數個標準的資料行。
ms.assetid: 805e0e13-d09e-40f8-955b-c585f388e07e
keywords:
- 資料行處理常式
- 註冊，資料行處理常式
- GetColumnInfo
- GetItemData
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 940796e75f29ba0fcfa025d9a56267e14bdff38f
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/19/2020
ms.locfileid: "104569471"
---
# <a name="creating-column-handlers"></a><span data-ttu-id="705f3-107">建立資料行處理常式</span><span class="sxs-lookup"><span data-stu-id="705f3-107">Creating Column Handlers</span></span>

<span data-ttu-id="705f3-108">\[只有在 Windows XP 或更早版本才支援這項功能。</span><span class="sxs-lookup"><span data-stu-id="705f3-108">\[This feature is supported only under Windows XP or earlier.</span></span> <span data-ttu-id="705f3-109">\]</span><span class="sxs-lookup"><span data-stu-id="705f3-109">\]</span></span>

<span data-ttu-id="705f3-110">Windows Windows 檔案總管中的詳細資料檢視通常會顯示數個標準的資料行。</span><span class="sxs-lookup"><span data-stu-id="705f3-110">The Details view in the Windows Windows Explorer normally displays several standard columns.</span></span> <span data-ttu-id="705f3-111">每個資料行都會列出目前資料夾中每個檔案的資訊，例如檔案大小或類型。</span><span class="sxs-lookup"><span data-stu-id="705f3-111">Each column lists information, such as the file size or type, for each file in the current folder.</span></span> <span data-ttu-id="705f3-112">藉由執行和註冊資料行處理常式，您可以讓自訂資料行可供顯示。</span><span class="sxs-lookup"><span data-stu-id="705f3-112">By implementing and registering a column handler, you can make custom columns available for display.</span></span>

<span data-ttu-id="705f3-113">[建立 shell](/windows/desktop/shell/handlers)擴充處理常式時，會討論如何執行和註冊 shell 擴充處理常式的一般程式。</span><span class="sxs-lookup"><span data-stu-id="705f3-113">The general procedures for implementing and registering a Shell extension handler are discussed in [Creating Shell Extension Handlers](/windows/desktop/shell/handlers).</span></span> <span data-ttu-id="705f3-114">本檔著重于資料行處理常式特定的執行層面。</span><span class="sxs-lookup"><span data-stu-id="705f3-114">This document focuses on those aspects of implementation that are specific to column handlers.</span></span>

<span data-ttu-id="705f3-115">討論下列主題。</span><span class="sxs-lookup"><span data-stu-id="705f3-115">The following topics are discussed.</span></span>

-   [<span data-ttu-id="705f3-116">資料行處理常式的運作方式</span><span class="sxs-lookup"><span data-stu-id="705f3-116">How Column Handlers Work</span></span>](#how-column-handlers-work)
-   [<span data-ttu-id="705f3-117">註冊資料行處理常式</span><span class="sxs-lookup"><span data-stu-id="705f3-117">Registering Column Handlers</span></span>](#registering-column-handlers)
-   [<span data-ttu-id="705f3-118">執行資料行處理常式</span><span class="sxs-lookup"><span data-stu-id="705f3-118">Implementing Column Handlers</span></span>](#implementing-column-handlers)
    -   [<span data-ttu-id="705f3-119">Initialize 方法</span><span class="sxs-lookup"><span data-stu-id="705f3-119">The Initialize Method</span></span>](#the-initialize-method)
    -   [<span data-ttu-id="705f3-120">GetColumnInfo 方法</span><span class="sxs-lookup"><span data-stu-id="705f3-120">The GetColumnInfo Method</span></span>](#the-getcolumninfo-method)
    -   [<span data-ttu-id="705f3-121">GetItemData 方法</span><span class="sxs-lookup"><span data-stu-id="705f3-121">The GetItemData Method</span></span>](#the-getitemdata-method)

## <a name="how-column-handlers-work"></a><span data-ttu-id="705f3-122">資料行處理常式的運作方式</span><span class="sxs-lookup"><span data-stu-id="705f3-122">How Column Handlers Work</span></span>

<span data-ttu-id="705f3-123">下圖顯示詳細資料檢視中的 Windows 檔案總管。</span><span class="sxs-lookup"><span data-stu-id="705f3-123">The following illustration shows Windows Explorer in Details view.</span></span>

![詳細資料檢視中的 windows explorer 螢幕擷取畫面](images/columnproviderhandler1.jpg)

<span data-ttu-id="705f3-125">使用 Windows 2000 時，資料夾也可以支援一些預設不會顯示的資料行。</span><span class="sxs-lookup"><span data-stu-id="705f3-125">With Windows 2000, the folder can also support a number of columns that, by default, are not displayed.</span></span> <span data-ttu-id="705f3-126">使用者可以在其中一個資料行標頭上按一下滑鼠右鍵，然後從功能表中選取 [ **其他 ...** ] 命令，以顯示其他資料行。</span><span class="sxs-lookup"><span data-stu-id="705f3-126">The user can display additional columns by right-clicking one of the column headers and selecting the **More...** command from the menu.</span></span> <span data-ttu-id="705f3-127">接著會出現一個對話方塊，列出資料夾可用的資料行，並讓使用者選取要顯示的資料行。</span><span class="sxs-lookup"><span data-stu-id="705f3-127">A dialog box then appears that lists the available columns for the folder and allows the user to select which columns to display.</span></span> <span data-ttu-id="705f3-128">下圖顯示上述範例的這個對話方塊。</span><span class="sxs-lookup"><span data-stu-id="705f3-128">The following illustration shows this dialog box for the preceding example.</span></span>

![顯示 [選擇詳細資料] 對話方塊的 windows explorer 螢幕擷取畫面](images/columnproviderhandler2.jpg)

<span data-ttu-id="705f3-130">藉由建立資料行處理常式，您可以建立自訂資料行，並將其加入至該清單。</span><span class="sxs-lookup"><span data-stu-id="705f3-130">By creating a column handler, you can create custom columns and add them to that list.</span></span> <span data-ttu-id="705f3-131">例如，包含音樂的檔案集合可以使用資料行處理常式來顯示列出每個檔案所含之演出者和部分的資料行。</span><span class="sxs-lookup"><span data-stu-id="705f3-131">For example, a collection of files that contain music could use a column handler to display columns listing the artist and piece contained by each file.</span></span>

<span data-ttu-id="705f3-132">資料行處理常式是全域物件，會在每次 Windows 檔案總管顯示詳細資料檢視時呼叫。</span><span class="sxs-lookup"><span data-stu-id="705f3-132">A column handler is a global object that is called every time Windows Explorer displays the Details view.</span></span> <span data-ttu-id="705f3-133">不過，資料行處理常式通常只會用來顯示特定 [檔案類型](/windows/desktop/shell/fa-file-types)之成員的自訂資料行。</span><span class="sxs-lookup"><span data-stu-id="705f3-133">However, column handlers are typically used to display custom columns only for members of a particular [file type](/windows/desktop/shell/fa-file-types).</span></span> <span data-ttu-id="705f3-134">在顯示詳細資料檢視之前，Windows 檔案總管會針對其資料行特性查詢所有已註冊的資料行處理常式。</span><span class="sxs-lookup"><span data-stu-id="705f3-134">Before it displays the Details view, Windows Explorer queries all registered column handlers for their column characteristics.</span></span> <span data-ttu-id="705f3-135">如果使用者已選取其中一個處理常式的資料行，Windows 檔案總管會查詢相關聯資料的處理常式。</span><span class="sxs-lookup"><span data-stu-id="705f3-135">If the user has selected one of the handler's columns, Windows Explorer queries the handler for the associated data.</span></span> <span data-ttu-id="705f3-136">當資料行處理常式收到資料的要求時，如果檔案是其支援類型的成員，則會提供資料。</span><span class="sxs-lookup"><span data-stu-id="705f3-136">When a column handler receives a request for data, it provides it if the file is a member of its supported type.</span></span> <span data-ttu-id="705f3-137">否則，它會傳回 FALSE 來忽略要求 \_ 。</span><span class="sxs-lookup"><span data-stu-id="705f3-137">Otherwise, it ignores the request by returning S\_FALSE.</span></span>

## <a name="registering-column-handlers"></a><span data-ttu-id="705f3-138">註冊資料行處理常式</span><span class="sxs-lookup"><span data-stu-id="705f3-138">Registering Column Handlers</span></span>

<span data-ttu-id="705f3-139">資料行處理常式會在下列子機碼下註冊。</span><span class="sxs-lookup"><span data-stu-id="705f3-139">Column handlers are registered under the following subkey.</span></span>

```
HKEY_CLASSES_ROOT
   Folder
      shellex
         ColumnHandlers
```

<span data-ttu-id="705f3-140">使用處理程式的類別識別碼字串形式來建立名為 **ColumnHandlers** 的子機碼， (CLSID) GUID。</span><span class="sxs-lookup"><span data-stu-id="705f3-140">Create a subkey of **ColumnHandlers** named with the string form of the handler's class identifier (CLSID) GUID.</span></span> <span data-ttu-id="705f3-141">如需如何註冊 Shell 擴充處理常式的一般討論，請參閱 [建立 Shell 擴充處理](/windows/desktop/shell/handlers)程式。</span><span class="sxs-lookup"><span data-stu-id="705f3-141">For a general discussion of how to register Shell extension handlers, see [Creating Shell Extension Handlers](/windows/desktop/shell/handlers).</span></span> <span data-ttu-id="705f3-142">下列範例說明如何註冊資料行處理常式。</span><span class="sxs-lookup"><span data-stu-id="705f3-142">The following example illustrates how to register a column handler.</span></span>

```
HKEY_CLASSES_ROOT
   Folder
      shellex
         ColumnHandlers
            {My Column Handler CLSID GUID}
```

## <a name="implementing-column-handlers"></a><span data-ttu-id="705f3-143">執行資料行處理常式</span><span class="sxs-lookup"><span data-stu-id="705f3-143">Implementing Column Handlers</span></span>

<span data-ttu-id="705f3-144">如同所有 Shell 延伸模組處理常式，資料行處理常式也是實作為 Dll (COM) 物件的同進程元件物件模型。</span><span class="sxs-lookup"><span data-stu-id="705f3-144">Like all Shell extension handlers, column handlers are in-process Component Object Model (COM) objects implemented as DLLs.</span></span> <span data-ttu-id="705f3-145">除了 [IUnknown](/windows/win32/api/unknwn/nn-unknwn-iunknown)之外，它們還會匯出 [**IColumnProvider**](/windows/desktop/api/shlobj/nn-shlobj-icolumnprovider)介面。</span><span class="sxs-lookup"><span data-stu-id="705f3-145">They export the [**IColumnProvider**](/windows/desktop/api/shlobj/nn-shlobj-icolumnprovider) interface in addition to [IUnknown](/windows/win32/api/unknwn/nn-unknwn-iunknown).</span></span>

<span data-ttu-id="705f3-146">Windows 檔案總管會呼叫 [**IColumnProvider**](/windows/desktop/api/shlobj/nn-shlobj-icolumnprovider) 匯出的三個方法，以要求其顯示資料行所需的資訊。</span><span class="sxs-lookup"><span data-stu-id="705f3-146">Windows Explorer calls the three methods exported by [**IColumnProvider**](/windows/desktop/api/shlobj/nn-shlobj-icolumnprovider) to request the information it needs to display the column.</span></span> <span data-ttu-id="705f3-147">Windows 檔案總管使用的程式如下：</span><span class="sxs-lookup"><span data-stu-id="705f3-147">The procedure used by Windows Explorer is:</span></span>

1.  <span data-ttu-id="705f3-148">呼叫 [**IColumnProvider：： Initialize**](/windows/desktop/api/shlobj/nf-shlobj-icolumnprovider-initialize) 以指定即將顯示的資料夾。</span><span class="sxs-lookup"><span data-stu-id="705f3-148">Call [**IColumnProvider::Initialize**](/windows/desktop/api/shlobj/nf-shlobj-icolumnprovider-initialize) to specify the folder that is about to be displayed.</span></span>
2.  <span data-ttu-id="705f3-149">呼叫 [**IColumnProvider：： GetColumnInfo**](/windows/desktop/api/shlobj/nf-shlobj-icolumnprovider-getcolumninfo) ，以取得資料行的識別碼和特性。</span><span class="sxs-lookup"><span data-stu-id="705f3-149">Call [**IColumnProvider::GetColumnInfo**](/windows/desktop/api/shlobj/nf-shlobj-icolumnprovider-getcolumninfo) to retrieve the column's identifier and characteristics.</span></span>
3.  <span data-ttu-id="705f3-150">如果使用者已選取資料行，請為資料夾中的每個檔案呼叫 [**IColumnProvider：： GetItemData**](/windows/desktop/api/shlobj/nf-shlobj-icolumnprovider-getitemdata) ，以取出屬於檔案資料行專案的資料。</span><span class="sxs-lookup"><span data-stu-id="705f3-150">If the column has been selected by the user, call [**IColumnProvider::GetItemData**](/windows/desktop/api/shlobj/nf-shlobj-icolumnprovider-getitemdata) for each file in the folder to retrieve the data that belongs in the file's column entry.</span></span>

### <a name="the-initialize-method"></a><span data-ttu-id="705f3-151">Initialize 方法</span><span class="sxs-lookup"><span data-stu-id="705f3-151">The Initialize Method</span></span>

<span data-ttu-id="705f3-152">Windows 檔案總管會呼叫 [**IColumnProvider：： initialize**](/windows/desktop/api/shlobj/nf-shlobj-icolumnprovider-initialize) 來初始化資料行處理常式。</span><span class="sxs-lookup"><span data-stu-id="705f3-152">Windows Explorer calls [**IColumnProvider::Initialize**](/windows/desktop/api/shlobj/nf-shlobj-icolumnprovider-initialize) to initialize the column handler.</span></span> <span data-ttu-id="705f3-153">方法有三個參數，但目前只使用 *wszFolder* 。</span><span class="sxs-lookup"><span data-stu-id="705f3-153">The method has three parameters, but only *wszFolder* is currently used.</span></span> <span data-ttu-id="705f3-154">它會設定為要顯示其詳細資料檢視的資料夾。</span><span class="sxs-lookup"><span data-stu-id="705f3-154">It is set to the folder whose Details view is about to be displayed.</span></span> <span data-ttu-id="705f3-155">儲存資料夾名稱以供稍後使用，並視需要初始化處理常式物件。</span><span class="sxs-lookup"><span data-stu-id="705f3-155">Store the folder name for later use and initialize the handler object as needed.</span></span>

### <a name="the-getcolumninfo-method"></a><span data-ttu-id="705f3-156">GetColumnInfo 方法</span><span class="sxs-lookup"><span data-stu-id="705f3-156">The GetColumnInfo Method</span></span>

<span data-ttu-id="705f3-157">Windows 檔案總管接下來會呼叫 [**IColumnProvider：： GetColumnInfo**](/windows/desktop/api/shlobj/nf-shlobj-icolumnprovider-getcolumninfo) 來要求資料行的識別碼和特性。</span><span class="sxs-lookup"><span data-stu-id="705f3-157">Windows Explorer next calls [**IColumnProvider::GetColumnInfo**](/windows/desktop/api/shlobj/nf-shlobj-icolumnprovider-getcolumninfo) to request the column's identifier and characteristics.</span></span> <span data-ttu-id="705f3-158">它會在 *dwIndex* 參數中傳遞資料行的索引。</span><span class="sxs-lookup"><span data-stu-id="705f3-158">It passes in an index for the column in the *dwIndex* parameter.</span></span> <span data-ttu-id="705f3-159">此索引是用來列舉資料行的任意值。</span><span class="sxs-lookup"><span data-stu-id="705f3-159">This index is an arbitrary value that is used to enumerate columns.</span></span> <span data-ttu-id="705f3-160">Windows 檔案總管也會傳入 [**SHCOLUMNINFO**](/windows/desktop/api/shlobj/ns-shlobj-shcolumninfo) 結構的指標。</span><span class="sxs-lookup"><span data-stu-id="705f3-160">Windows Explorer also passes in a pointer to an [**SHCOLUMNINFO**](/windows/desktop/api/shlobj/ns-shlobj-shcolumninfo) structure.</span></span> <span data-ttu-id="705f3-161">此結構是用來傳回資料行的識別碼和特性。</span><span class="sxs-lookup"><span data-stu-id="705f3-161">This structure is used to return the column's identifier and characteristics.</span></span> <span data-ttu-id="705f3-162">**IColumnProvider：： GetColumnInfo** 應該將適當的值指派給結構的成員，並傳回。</span><span class="sxs-lookup"><span data-stu-id="705f3-162">**IColumnProvider::GetColumnInfo** should assign appropriate values to the members of the structure and return.</span></span>

<span data-ttu-id="705f3-163">資料行是由其 OLE 屬性集識別碼 (FMTID) 和相關聯的屬性識別碼 (PID) 來識別。</span><span class="sxs-lookup"><span data-stu-id="705f3-163">Columns are identified by their OLE property set ID (FMTID) and an associated property ID (PID).</span></span> <span data-ttu-id="705f3-164">[**SHCOLUMNINFO**](/windows/desktop/api/shlobj/ns-shlobj-shcolumninfo)結構（ **scid**）的第一個成員是用來識別資料行之 [**SHCOLUMNID**](/windows/desktop/shell/objects)結構的指標。</span><span class="sxs-lookup"><span data-stu-id="705f3-164">The first member of the [**SHCOLUMNINFO**](/windows/desktop/api/shlobj/ns-shlobj-shcolumninfo) structure, **scid**, is a pointer to an [**SHCOLUMNID**](/windows/desktop/shell/objects) structure that is used to identify the column.</span></span> <span data-ttu-id="705f3-165">其 **fmtid** 成員會保留資料行的 fmtid，而其 **pid** 成員會保存該資料行的 pid。</span><span class="sxs-lookup"><span data-stu-id="705f3-165">Its **fmtid** member holds the column's FMTID, and its **pid** member holds the column's PID.</span></span> <span data-ttu-id="705f3-166">例如，通常用來識別資料行的標準 FMTID/PID 組是摘要資訊屬性集的作者 PID。</span><span class="sxs-lookup"><span data-stu-id="705f3-166">For example, a standard FMTID/PID pair that is commonly used to identify columns is the Author PID of the Summary Information property set.</span></span>

<span data-ttu-id="705f3-167">可能的話，您的處理常式應該使用現有的 FMTIDs 和 Pid 來識別它所支援的資料行。</span><span class="sxs-lookup"><span data-stu-id="705f3-167">If possible, your handler should use existing FMTIDs and PIDs to identify the column it supports.</span></span> <span data-ttu-id="705f3-168">如果您使用自訂 [**SHCOLUMNID**](/windows/desktop/shell/objects) 結構，資料行會只顯示處理常式支援的那些檔案的資料。</span><span class="sxs-lookup"><span data-stu-id="705f3-168">If you use a custom [**SHCOLUMNID**](/windows/desktop/shell/objects) structure, the column will display data only for those files that are supported by the handler.</span></span> <span data-ttu-id="705f3-169">如果資料夾包含其他檔案，其專案將會空白。</span><span class="sxs-lookup"><span data-stu-id="705f3-169">If the folder contains other files, their entries will be blank.</span></span> <span data-ttu-id="705f3-170">如果資料夾包含多個檔案類型的檔案，則使用標準 FMTID/PID 值可能會將不同類型的資料合併到相同的資料行中。</span><span class="sxs-lookup"><span data-stu-id="705f3-170">If a folder contains files from more than one file type, using standard FMTID/PID values could make it possible to merge data from different types into the same column.</span></span>

<span data-ttu-id="705f3-171">將 **vt** 成員設為 [](/windows/win32/api/oaidl/ns-oaidl-variant)   您想要在資料行中顯示之資料的 VARIANT 類型。</span><span class="sxs-lookup"><span data-stu-id="705f3-171">Set the **vt** member to the [**VARIANT**](/windows/win32/api/oaidl/ns-oaidl-variant) type of the data you want to display in the column.</span></span> <span data-ttu-id="705f3-172">最常使用的類型是 VT \_ LPSTR，因為大部分的資料行會以字元字串顯示其資料。</span><span class="sxs-lookup"><span data-stu-id="705f3-172">The most commonly used type is VT\_LPSTR, as most columns display their data as character strings.</span></span> <span data-ttu-id="705f3-173">[**SHCOLUMNINFO**](/windows/desktop/api/shlobj/ns-shlobj-shcolumninfo)結構的其餘成員是用來定義資料行的特性。</span><span class="sxs-lookup"><span data-stu-id="705f3-173">The remaining members of the [**SHCOLUMNINFO**](/windows/desktop/api/shlobj/ns-shlobj-shcolumninfo) structure are used to define the characteristics of the column.</span></span> <span data-ttu-id="705f3-174">適當地指派值。</span><span class="sxs-lookup"><span data-stu-id="705f3-174">Assign values as appropriate.</span></span>

### <a name="the-getitemdata-method"></a><span data-ttu-id="705f3-175">GetItemData 方法</span><span class="sxs-lookup"><span data-stu-id="705f3-175">The GetItemData Method</span></span>

<span data-ttu-id="705f3-176">如果已選取資料行處理常式的資料行，Windows 檔案總管會針對要顯示之資料夾中的每個檔案呼叫 [**IColumnProvider：： GetItemData**](/windows/desktop/api/shlobj/nf-shlobj-icolumnprovider-getitemdata) 。</span><span class="sxs-lookup"><span data-stu-id="705f3-176">If the column handler's column has been selected, Windows Explorer calls [**IColumnProvider::GetItemData**](/windows/desktop/api/shlobj/nf-shlobj-icolumnprovider-getitemdata) for each file in the folder that is to be displayed.</span></span> <span data-ttu-id="705f3-177">*Pscid* 參數是識別資料行之 [**SHCOLUMNID**](/windows/desktop/shell/objects)結構的指標。</span><span class="sxs-lookup"><span data-stu-id="705f3-177">The *pscid* parameter is a pointer to an [**SHCOLUMNID**](/windows/desktop/shell/objects) structure that identifies the column.</span></span> <span data-ttu-id="705f3-178">*Pscd* 參數指向識別特定檔案的 [**SHCOLUMNDATA**](/windows/desktop/api/shlobj/ns-shlobj-shcolumndata)結構。</span><span class="sxs-lookup"><span data-stu-id="705f3-178">The *pscd* parameter points to an [**SHCOLUMNDATA**](/windows/desktop/api/shlobj/ns-shlobj-shcolumndata) structure that identifies the particular file.</span></span>

<span data-ttu-id="705f3-179">*PvarData* 參數會傳回應該在 *pscd* 所指定檔案的處理常式資料行中顯示的資料。</span><span class="sxs-lookup"><span data-stu-id="705f3-179">The *pvarData* parameter returns the data that should be displayed in the handler's column for the file specified by *pscd*.</span></span> <span data-ttu-id="705f3-180">如果您的資料行處理常式支援該檔案，請將其資料值指派給 *pvarData* ，然後返回 S \_ OK。</span><span class="sxs-lookup"><span data-stu-id="705f3-180">If that file is supported by your column handler, assign its data value to *pvarData* and return S\_OK.</span></span> <span data-ttu-id="705f3-181">如果您的資料行處理常式不支援此檔案，則傳回 \_ FALSE，而不將值指派給 *pvarData*。</span><span class="sxs-lookup"><span data-stu-id="705f3-181">If the file is not supported by your column handler, return S\_FALSE without assigning a value to *pvarData*.</span></span>

<span data-ttu-id="705f3-182">許多資料夾會包含任何特定資料行處理常式不支援的一些檔案。</span><span class="sxs-lookup"><span data-stu-id="705f3-182">Many folders will contain a number of files that are not supported by any particular column handler.</span></span> <span data-ttu-id="705f3-183">為了提高效率， [**IColumnProvider：： GetItemData**](/windows/desktop/api/shlobj/nf-shlobj-icolumnprovider-getitemdata)應該先檢查 *pscd* 所指向之結構的 **pwszExt** 成員。</span><span class="sxs-lookup"><span data-stu-id="705f3-183">To improve efficiency, [**IColumnProvider::GetItemData**](/windows/desktop/api/shlobj/nf-shlobj-icolumnprovider-getitemdata) should first check the **pwszExt** member of the structure pointed to by *pscd*.</span></span> <span data-ttu-id="705f3-184">這個成員會保留副檔名。</span><span class="sxs-lookup"><span data-stu-id="705f3-184">This member holds the file name extension.</span></span> <span data-ttu-id="705f3-185">如果延伸模組指出檔案不是您的處理常式所支援之檔案類型的成員，請立即傳回 FALSE，以避免不必要的處理 \_ 。</span><span class="sxs-lookup"><span data-stu-id="705f3-185">If the extension indicates that the file is not a member of a file type supported by your handler, avoid unnecessary processing by immediately returning S\_FALSE.</span></span>

 

 