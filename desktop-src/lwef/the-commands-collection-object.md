---
title: 命令集合物件
description: 命令集合物件
ms.assetid: 8726ce04-77d3-4ae3-bd46-e75f42b36d6f
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c2367035d86f92d57dc459564943b9e7797ecb04
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/19/2020
ms.locfileid: "104374989"
---
# <a name="the-commands-collection-object"></a><span data-ttu-id="b0cde-103">命令集合物件</span><span class="sxs-lookup"><span data-stu-id="b0cde-103">The Commands Collection Object</span></span>

<span data-ttu-id="b0cde-104">\[Microsoft Agent 已于 Windows 7 淘汰，在後續的 Windows 版本中可能無法使用。\]</span><span class="sxs-lookup"><span data-stu-id="b0cde-104">\[Microsoft Agent is deprecated as of Windows 7, and may be unavailable in subsequent versions of Windows.\]</span></span>

<span data-ttu-id="b0cde-105">Microsoft 代理程式伺服器會維護使用者目前可用的命令清單。</span><span class="sxs-lookup"><span data-stu-id="b0cde-105">The Microsoft Agent server maintains a list of commands that are currently available to the user.</span></span> <span data-ttu-id="b0cde-106">這份清單包含伺服器為一般互動所定義的命令 (例如隱藏和開啟 [語音命令] 視窗) 、可用 (清單，但是非輸入主動) 用戶端，以及目前作用中用戶端所定義的命令。</span><span class="sxs-lookup"><span data-stu-id="b0cde-106">This list includes commands that the server defines for general interaction (such as Hide and Open The Voice Commands Window), the list of available (but non-input-active) clients, and the commands defined by the current active client.</span></span> <span data-ttu-id="b0cde-107">前兩組命令是全域命令;也就是說，無論輸入-主動用戶端為何，都可以隨時使用它們。</span><span class="sxs-lookup"><span data-stu-id="b0cde-107">The first two sets of commands are global commands; that is, they are available at any time, regardless of the input-active client.</span></span> <span data-ttu-id="b0cde-108">用戶端定義的命令只有在該用戶端為輸入-主動且可看見該字元時才可使用。</span><span class="sxs-lookup"><span data-stu-id="b0cde-108">Client-defined commands are available only when that client is input-active and the character is visible.</span></span>

<span data-ttu-id="b0cde-109">每個用戶端應用程式都可以定義稱為 [**命令**](/windows/desktop/lwef/the-commands-collection-object) 集合的命令集合。</span><span class="sxs-lookup"><span data-stu-id="b0cde-109">Each client application can define a collection of commands called the [**Commands**](/windows/desktop/lwef/the-commands-collection-object) collection.</span></span> <span data-ttu-id="b0cde-110">若要將命令加入至集合，請使用 [**add**](add-method.md) 或 [**Insert**](insert-method.md) 方法。</span><span class="sxs-lookup"><span data-stu-id="b0cde-110">To add a command to the collection, use the [**Add**](add-method.md) or [**Insert**](insert-method.md) method.</span></span> <span data-ttu-id="b0cde-111">雖然您可以使用不同的語句來指定命令的屬性，但是為了獲得最佳的程式碼效能，請在 **Add** 或 **Insert** 方法語句中指定所有命令的屬性。</span><span class="sxs-lookup"><span data-stu-id="b0cde-111">Although you can specify a command's properties with separate statements, for optimum code performance, specify all of a command's properties in the **Add** or **Insert** method statement.</span></span> <span data-ttu-id="b0cde-112">您可以針對集合中的每個命令，判斷使用者對命令的存取是否出現在字元的快顯功能表、[語音命令] 視窗、[兩者] 或 [兩者] 中。</span><span class="sxs-lookup"><span data-stu-id="b0cde-112">For each command in the collection, you can determine whether user access to the command appears in the character's pop-up menu, in the Voice Commands Window, in both, or in neither.</span></span> <span data-ttu-id="b0cde-113">例如，如果您想要在字元的快顯功能表上出現命令，請設定命令的 [**標題**](caption-property.md) 和 [**可見**](visible-property.md) 的屬性。</span><span class="sxs-lookup"><span data-stu-id="b0cde-113">For example, if you want a command to appear on the pop-up menu for the character, set the command's [**Caption**](caption-property.md) and [**Visible**](visible-property.md) properties.</span></span> <span data-ttu-id="b0cde-114">若要在 [語音命令] 視窗中顯示命令，請設定命令的 [**VoiceCaption**](voicecaption-property.md) 和 [**Voice**](voice-property.md) 屬性。</span><span class="sxs-lookup"><span data-stu-id="b0cde-114">To display the command in the Voice Commands Window, set the command's [**VoiceCaption**](voicecaption-property.md) and [**Voice**](voice-property.md) properties.</span></span>

<span data-ttu-id="b0cde-115">只有當您的用戶端應用程式為輸入-主動時，使用者才能存取集合中的個別通訊 [**命令**](/windows/desktop/lwef/the-commands-collection-object)and。</span><span class="sxs-lookup"><span data-stu-id="b0cde-115">A user can access the individual comm [**Commands**](/windows/desktop/lwef/the-commands-collection-object)ands in your collection only when your client application is input-active.</span></span> <span data-ttu-id="b0cde-116">因此，當您共用其他用戶端應用程式的字元時，通常會想要設定 **命令** 集合物件的 [**Caption**](caption-property.md)、 [**VoiceCaption**](voicecaption-property.md)和 [**Voice**](voice-property.md)屬性，以及集合中的命令。</span><span class="sxs-lookup"><span data-stu-id="b0cde-116">Therefore, when you may be sharing the character with other client applications you'll typically want to set the [**Caption**](caption-property.md), [**VoiceCaption**](voicecaption-property.md), and [**Voice**](voice-property.md) properties for the **Commands** collection object as well as for the commands in the collection.</span></span> <span data-ttu-id="b0cde-117">這會在字元的快顯功能表和 [語音命令] 視窗中放置 **命令** 集合的專案。</span><span class="sxs-lookup"><span data-stu-id="b0cde-117">This places an entry for your **Commands** collection in a character's pop-up menu and in the Voice Commands Window.</span></span>

<span data-ttu-id="b0cde-118">當使用者選擇其 [**命令**](/windows/desktop/lwef/the-commands-collection-object) 專案切換至您的用戶端時，伺服器會自動讓您的用戶端進入作用中狀態，使用 [**ActivateInput**](activateinput-event.md) 事件通知用戶端應用程式，並讓其集合中的命令可供使用。</span><span class="sxs-lookup"><span data-stu-id="b0cde-118">When the user switches to your client by choosing its [**Commands**](/windows/desktop/lwef/the-commands-collection-object) entry, the server automatically makes your client input-active, notifying your client application using the [**ActivateInput**](activateinput-event.md) event and makes the commands in its collection available.</span></span> <span data-ttu-id="b0cde-119">伺服器也會通知用戶端，它不再是使用 [**DeActivateInput**](deactivateinput-event.md) 事件的輸入。</span><span class="sxs-lookup"><span data-stu-id="b0cde-119">The server also notifies the client that it is no longer input-active with the [**DeActivateInput**](deactivateinput-event.md) event.</span></span> <span data-ttu-id="b0cde-120">如此一來，伺服器就只會顯示並接受套用至目前輸入-主動用戶端內容的命令。</span><span class="sxs-lookup"><span data-stu-id="b0cde-120">This enables the server to present and accept only the commands that apply to the current input-active client's context.</span></span> <span data-ttu-id="b0cde-121">它也可避免用戶端之間的命令名稱衝突。</span><span class="sxs-lookup"><span data-stu-id="b0cde-121">It also serves to avoid command-name collisions between clients.</span></span>

<span data-ttu-id="b0cde-122">用戶端也可以使用 [**啟動**](activate-method.md) 方法，明確要求使其成為輸入-主動用戶端。</span><span class="sxs-lookup"><span data-stu-id="b0cde-122">A client can also explicitly request to make itself the input-active client using the [**Activate**](activate-method.md) method.</span></span> <span data-ttu-id="b0cde-123">這個方法也支援將您的應用程式設定為非輸入-主動用戶端。</span><span class="sxs-lookup"><span data-stu-id="b0cde-123">This method also supports setting your application to not be the input-active client.</span></span> <span data-ttu-id="b0cde-124">當您與另一個應用程式共用一個字元時，可能會想要使用這個方法，當應用程式視窗取得焦點時，將應用程式設定為輸入-主動，而當應用程式視窗失去焦點時，則設定為非作用中。</span><span class="sxs-lookup"><span data-stu-id="b0cde-124">You may want to use this method when you are sharing a character with another application, setting your application to be input-active when your application window gets focus and not input-active when it loses focus.</span></span>

<span data-ttu-id="b0cde-125">同樣地，您可以使用 [**啟動**](activate-method.md) 方法，將您的應用程式設定為 (，或不) 字元的使用中用戶端。</span><span class="sxs-lookup"><span data-stu-id="b0cde-125">Similarly, you can use the [**Activate**](activate-method.md) method to set your application to be (or not be) the active client of the character.</span></span> <span data-ttu-id="b0cde-126">作用中用戶端是用戶端，會在其字元為最頂端的字元時收到輸入。</span><span class="sxs-lookup"><span data-stu-id="b0cde-126">The active client is the client that receives input when its character is the topmost character.</span></span> <span data-ttu-id="b0cde-127">當此狀態變更時，伺服器會使用 [**ActiveClientChange**](activeclientchange-event.md) 事件來通知您的應用程式。</span><span class="sxs-lookup"><span data-stu-id="b0cde-127">When this status changes, the server notifies your application with the [**ActiveClientChange**](activeclientchange-event.md) event.</span></span>

<span data-ttu-id="b0cde-128">當字元的快顯功能表顯示時，在使用者重新顯示功能表之前， [**命令**](/windows/desktop/lwef/the-commands-collection-object) 集合的屬性或其集合中的命令變更都不會出現。</span><span class="sxs-lookup"><span data-stu-id="b0cde-128">When a character's pop-up menu displays, changes to the properties of a [**Commands**](/windows/desktop/lwef/the-commands-collection-object) collection or the commands in its collection do not appear until the user redisplays the menu.</span></span> <span data-ttu-id="b0cde-129">不過，[命令] 視窗會在發生變更時顯示變更。</span><span class="sxs-lookup"><span data-stu-id="b0cde-129">However, the Commands Window does display changes as they happen.</span></span>

-   [<span data-ttu-id="b0cde-130">命令物件方法</span><span class="sxs-lookup"><span data-stu-id="b0cde-130">Commands Object Methods</span></span>](commands-object-methods.md)
-   [<span data-ttu-id="b0cde-131">命令物件屬性</span><span class="sxs-lookup"><span data-stu-id="b0cde-131">Commands Object Properties</span></span>](commands-object-properties.md)

 

 