---
title: 製作字元動畫
description: 製作字元動畫
ms.assetid: ed42de30-acac-41e8-bacb-4caaff254724
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 3ed47b30a9bcfcdb5e305b87ced5f02526ae0056
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/19/2020
ms.locfileid: "104023353"
---
# <a name="animating-a-character"></a><span data-ttu-id="47ffb-103">製作字元動畫</span><span class="sxs-lookup"><span data-stu-id="47ffb-103">Animating a Character</span></span>

<span data-ttu-id="47ffb-104">\[Microsoft Agent 已于 Windows 7 淘汰，在後續的 Windows 版本中可能無法使用。\]</span><span class="sxs-lookup"><span data-stu-id="47ffb-104">\[Microsoft Agent is deprecated as of Windows 7, and may be unavailable in subsequent versions of Windows.\]</span></span>

<span data-ttu-id="47ffb-105">載入字元之後，您可以使用數種 Microsoft 代理程式的方法來建立字元的動畫。</span><span class="sxs-lookup"><span data-stu-id="47ffb-105">Once a character is loaded, you can use several of Microsoft Agent's methods for animating the character.</span></span> <span data-ttu-id="47ffb-106">第一個使用的通常是 [**Show**](show-method.md) 方法。</span><span class="sxs-lookup"><span data-stu-id="47ffb-106">The first one you use is typically the [**Show**](show-method.md) method.</span></span> <span data-ttu-id="47ffb-107">**顯示** 會讓字元的框架顯示出來，並播放指派給該字元 **顯示** 狀態的動畫。</span><span class="sxs-lookup"><span data-stu-id="47ffb-107">**Show** makes the character's frame visible and plays the animation assigned to the character's **Showing** state.</span></span>

<span data-ttu-id="47ffb-108">在字元的框架顯示之後，您可以使用 [**play**](play-method.md) 方法，指定動畫的名稱來播放該動畫。</span><span class="sxs-lookup"><span data-stu-id="47ffb-108">Once the character's frame is visible, you can use the [**Play**](play-method.md) method, specifying the name of an animation, to play that animation.</span></span> <span data-ttu-id="47ffb-109">動畫名稱是字元定義專用的。</span><span class="sxs-lookup"><span data-stu-id="47ffb-109">Animation names are specific to a character definition.</span></span> <span data-ttu-id="47ffb-110">當動畫播放時，其視窗的圖形會變更為符合框架中的影像。</span><span class="sxs-lookup"><span data-stu-id="47ffb-110">As an animation plays, the shape of its window changes to match the image in the frame.</span></span> <span data-ttu-id="47ffb-111">這會導致在桌面和所有視窗（或迭置 *順序*）上方顯示的可移動圖形影像或 *sprite*。</span><span class="sxs-lookup"><span data-stu-id="47ffb-111">This results in a movable graphic image, or *sprite*, displayed on top of the desktop and all windows, or *z-order*.</span></span>

<span data-ttu-id="47ffb-112">如果字元的檔案儲存在本機，您就可以呼叫 [**Play**](play-method.md) 方法。</span><span class="sxs-lookup"><span data-stu-id="47ffb-112">If the character's file is stored locally, you can simply call the [**Play**](play-method.md) method.</span></span> <span data-ttu-id="47ffb-113">在其他情況下（例如，當您載入時）。從 HTTP 伺服器 ACF 字元，您必須使用 [**Get**](get-method.md) (或 [**Prepare**](/windows/desktop/lwef/iagentcharacter--prepare)) 方法來先取出動畫資料。</span><span class="sxs-lookup"><span data-stu-id="47ffb-113">In other cases, such as when you have loaded an .ACF character from an HTTP server, you must use the [**Get**](get-method.md) (or [**Prepare**](/windows/desktop/lwef/iagentcharacter--prepare)) method to first retrieve the animation data.</span></span> <span data-ttu-id="47ffb-114">這會導致代理程式從伺服器要求動畫檔案，並將它儲存在本機電腦上的瀏覽器緩衝區中。</span><span class="sxs-lookup"><span data-stu-id="47ffb-114">This will cause Agent to request the animation file from the server and store it in the browser's buffer on the local machine.</span></span>

<span data-ttu-id="47ffb-115">「 [**說話**](speak-method.md) 」方法可讓您對字元進行程式設計，並自動對輸出進行 lip 同步處理。</span><span class="sxs-lookup"><span data-stu-id="47ffb-115">The [**Speak**](speak-method.md) method enables you to program the character to speak, automatically lip-syncing the output.</span></span> <span data-ttu-id="47ffb-116">本檔的輸出一節會涵蓋進一步的詳細資料。</span><span class="sxs-lookup"><span data-stu-id="47ffb-116">Further details are covered in the Output section of this document.</span></span>

<span data-ttu-id="47ffb-117">您可以使用 [**MoveTo**](moveto-method.md) 方法將字元放在新位置。</span><span class="sxs-lookup"><span data-stu-id="47ffb-117">You can use the [**MoveTo**](moveto-method.md) method to position the character at a new location.</span></span> <span data-ttu-id="47ffb-118">當您呼叫 **MoveTo** 方法時，Microsoft Agent 會根據字元的目前位置自動播放適當的動畫，然後移動字元的框架。</span><span class="sxs-lookup"><span data-stu-id="47ffb-118">When you call the **MoveTo** method, Microsoft Agent automatically plays the appropriate animation based on the character's current location, then moves the character's frame.</span></span> <span data-ttu-id="47ffb-119">同樣地，當您呼叫 [**GestureAt**](gestureat-method.md)時，Microsoft Agent 會根據該字元的位置和在呼叫中指定的位置，來播放適當的 gesturing 動畫。</span><span class="sxs-lookup"><span data-stu-id="47ffb-119">Similarly, when you call [**GestureAt**](gestureat-method.md), Microsoft Agent plays the appropriate gesturing animation based on the character's location and the location specified in the call.</span></span>

<span data-ttu-id="47ffb-120">若要隱藏字元，請呼叫 [hide](hide-method.md) 方法。</span><span class="sxs-lookup"><span data-stu-id="47ffb-120">To hide the character, call the [Hide](hide-method.md) method.</span></span> <span data-ttu-id="47ffb-121">這會自動播放與該字元 **隱藏** 狀態相關聯的字元，然後隱藏字元的框架。</span><span class="sxs-lookup"><span data-stu-id="47ffb-121">This automatically plays the character associated with the character's **Hiding** state, then hides the character's frame.</span></span> <span data-ttu-id="47ffb-122">不過，您也可以藉由設定字元的 [**Visible**](visible-property.md) 屬性來隱藏或顯示字元。</span><span class="sxs-lookup"><span data-stu-id="47ffb-122">However, you can also hide or show a character by setting the character's [**Visible**](visible-property.md) property.</span></span>

<span data-ttu-id="47ffb-123">Microsoft Agent 會以非同步方式處理所有的動畫呼叫或 *要求*。</span><span class="sxs-lookup"><span data-stu-id="47ffb-123">Microsoft Agent processes all animation calls, or *requests*, asynchronously.</span></span> <span data-ttu-id="47ffb-124">這可讓您的應用程式程式碼在處理要求時繼續處理其他事件。</span><span class="sxs-lookup"><span data-stu-id="47ffb-124">This enables your application's code to continue handling other events while the request is being processed.</span></span> <span data-ttu-id="47ffb-125">例如，對 [**Play**](play-method.md) 方法的呼叫會將動畫放在字元的佇列中，以便順序播放動畫。</span><span class="sxs-lookup"><span data-stu-id="47ffb-125">For example, calls to the [**Play**](play-method.md) method place the animation in a queue for the character so that the animations can be played sequentially.</span></span> <span data-ttu-id="47ffb-126">不過，這表示您無法假設對其他函式的呼叫將會在程式碼中跟隨的動畫之後執行。</span><span class="sxs-lookup"><span data-stu-id="47ffb-126">However, this means you cannot assume that a call to other functions will necessarily execute after an animation it follows in your code.</span></span> <span data-ttu-id="47ffb-127">例如，呼叫 **Play** 或 [**MoveTo**](moveto-method.md) 之後的語句會在動畫完成之前執行。</span><span class="sxs-lookup"><span data-stu-id="47ffb-127">For example, typically, a statement following a call to **Play** or [**MoveTo**](moveto-method.md) will execute before the animation finishes.</span></span>

<span data-ttu-id="47ffb-128">您可以建立動畫要求的物件參考，然後在動畫開始或完成時，監視伺服器用來通知用戶端字元的 [要求](the-request-object.md) 事件，藉此將程式碼與字元佇列中的動畫同步處理。</span><span class="sxs-lookup"><span data-stu-id="47ffb-128">You can synchronize your code with animations in a character's queue by creating an object reference to the animation request, and, when the animation starts or completes, monitoring the [Request](the-request-object.md) events that the server uses to notify clients of the character.</span></span> <span data-ttu-id="47ffb-129">例如，如果您想要在字元完成動畫時顯示訊息方塊，您可以在 [**RequestComplete**](requestcomplete-event.md) 事件處理副程式中放入訊息方塊呼叫，檢查是否有特定的要求識別碼。</span><span class="sxs-lookup"><span data-stu-id="47ffb-129">For example, if you want a message box to appear when the character finishes an animation, you can put the message box call in your [**RequestComplete**](requestcomplete-event.md) event handling subroutine, checking for the particular request ID.</span></span>

<span data-ttu-id="47ffb-130">隱藏字元時，伺服器不會播放動畫;不過，它仍會將動畫要求排入佇列並處理 (播放動畫) 並將要求狀態傳遞回用戶端。</span><span class="sxs-lookup"><span data-stu-id="47ffb-130">When a character is hidden, the server does not play animations; however, it still queues and processes the animation request (plays the animation) and passes a request status back to the client.</span></span> <span data-ttu-id="47ffb-131">在隱藏狀態中，字元無法變成輸入-主動。</span><span class="sxs-lookup"><span data-stu-id="47ffb-131">In the hidden state, the character cannot become input-active.</span></span> <span data-ttu-id="47ffb-132">不過，如果使用者在) 啟用語音輸入時說出 (的名稱，則伺服器會自動顯示該字元。</span><span class="sxs-lookup"><span data-stu-id="47ffb-132">However, if the user speaks the name of the character (when speech input is enabled), the server automatically shows the character.</span></span>

<span data-ttu-id="47ffb-133">當您的用戶端應用程式同時載入多個字元時，Microsoft Agent 的動畫服務可讓您獨立地建立字元的動畫 [**，或**](interrupt-method.md)使用 [**Wait**](wait-method.md)、插斷或 [**停止**](stop-method.md)方法來同步處理其動畫。</span><span class="sxs-lookup"><span data-stu-id="47ffb-133">When your client application loads multiple characters at the same time, Microsoft Agent's animation services enable you to animate characters independently or use the [**Wait**](wait-method.md), [**Interrupt**](interrupt-method.md), or [**Stop**](stop-method.md) methods to synchronize their animation with each other.</span></span>

<span data-ttu-id="47ffb-134">Microsoft 代理程式也會自動為您播放其他動畫。</span><span class="sxs-lookup"><span data-stu-id="47ffb-134">Microsoft Agent also plays other animations automatically for you.</span></span> <span data-ttu-id="47ffb-135">例如，如果字元的狀態未變更數秒，則代理程式會開始播放指派給該字元 **閒置** 動畫的動畫。</span><span class="sxs-lookup"><span data-stu-id="47ffb-135">For example, if the character's state has not changed for several seconds, Agent begins playing animations assigned to the character's **Idling** animations.</span></span> <span data-ttu-id="47ffb-136">同樣地，當語音輸入啟用時，代理程式會在偵測到語句時播放字元的 **接聽** 動畫，然後 **聽到** 動畫。</span><span class="sxs-lookup"><span data-stu-id="47ffb-136">Similarly, when speech input is enabled, Agent plays the character's **Listening** animations and then **Hearing** animations when an utterance is detected.</span></span> <span data-ttu-id="47ffb-137">這些伺服器管理的動畫稱為「 *狀態*」，並會在建立字元時定義。</span><span class="sxs-lookup"><span data-stu-id="47ffb-137">These server-managed animations are called *states*, and are defined when a character is created.</span></span> <span data-ttu-id="47ffb-138">如需詳細資訊，請參閱 [設計 Microsoft Agent 的字元](agent-states.md)。</span><span class="sxs-lookup"><span data-stu-id="47ffb-138">For more information, see [Designing Characters for Microsoft Agent](agent-states.md).</span></span>

 

 