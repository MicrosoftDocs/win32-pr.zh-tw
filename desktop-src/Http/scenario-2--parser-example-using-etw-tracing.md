---
title: 使用 ETW 追蹤的案例2剖析器範例
description: 若要產生 HTTP 伺服器 API 元件的 ETW 追蹤報告，請執行如 \ 0034; 中所示的步驟。產生 ETW 追蹤報告 \ 0034;使用 ETW 追蹤和 Netsh 命令的案例 1 HTTP Timeout 範例一節，但重現此案例特定的錯誤。
ms.assetid: 2ccd2927-8a64-40a8-a29b-4b680a942f7f
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 866c566973b660e4e665226fbf9b4a266b086b6b
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/19/2020
ms.locfileid: "104023488"
---
# <a name="scenario-2-parser-example-using-etw-tracing"></a><span data-ttu-id="03702-103">案例2：使用 ETW 追蹤的剖析器範例</span><span class="sxs-lookup"><span data-stu-id="03702-103">Scenario 2: Parser Example Using ETW Tracing</span></span>

<span data-ttu-id="03702-104">若要產生 HTTP 伺服器 API 元件的 ETW 追蹤報告，請執行 [下列步驟：使用 ETW 追蹤和 Netsh 命令](scenario-1--http-timeout-example-using-etw-tracing-and-netsh-commands.md)的「產生 Etw 追蹤報表」一節中所示的步驟，但重現此案例特定的錯誤。</span><span class="sxs-lookup"><span data-stu-id="03702-104">To generate an ETW trace report for the HTTP Server API component, run the steps as shown in the "Generating an ETW Trace Report" section of [Scenario 1: HTTP Timeout Example Using ETW Tracing and Netsh Commands](scenario-1--http-timeout-example-using-etw-tracing-and-netsh-commands.md), but reproduce the error specific to this scenario.</span></span> <span data-ttu-id="03702-105">在此範例中，從用戶端電腦存取 web 應用程式，導致用戶端上顯示「400不正確的要求」訊息。</span><span class="sxs-lookup"><span data-stu-id="03702-105">In this example, access the web application from a client machine, resulting in the "400 bad request" message being shown on the client.</span></span> <span data-ttu-id="03702-106">這些步驟會在伺服器上執行，因為它會裝載 web 應用程式。</span><span class="sxs-lookup"><span data-stu-id="03702-106">These steps are run on the server since it is hosting the web application.</span></span>

## <a name="viewing-the-trace-and-diagnosing"></a><span data-ttu-id="03702-107">查看追蹤和診斷</span><span class="sxs-lookup"><span data-stu-id="03702-107">Viewing the Trace and Diagnosing</span></span>

<span data-ttu-id="03702-108">您可以在 Excel 或支援 CSV 格式的任何工具中，查看所產生的追蹤 CSV 檔案。</span><span class="sxs-lookup"><span data-stu-id="03702-108">The resulting CSV file for traces can be viewed in Excel or any tool that supports the CSV format.</span></span> <span data-ttu-id="03702-109">下表2顯示範例追蹤檔 (httptrace.csv) 的摘錄。</span><span class="sxs-lookup"><span data-stu-id="03702-109">Table 2 below shows excerpts from a sample trace file (httptrace.csv).</span></span> <span data-ttu-id="03702-110">在追蹤報表中，[層級] 資料行會顯示值為 "2" 的專案，代表錯誤。</span><span class="sxs-lookup"><span data-stu-id="03702-110">In the trace report, the "Level" column shows an entry with a value of "2", which represents an error.</span></span> <span data-ttu-id="03702-111">如先前所述，HTTP 伺服器 API 元件會遵循 [LevelType 複雜型別複雜型](../wes/eventmanifestschema-leveltype-complextype.md)別一文中定義的 ETW 層級。</span><span class="sxs-lookup"><span data-stu-id="03702-111">As noted above, the HTTP Server API component follows the ETW Levels defined in the article [LevelType Complex Type Complex Type](../wes/eventmanifestschema-leveltype-complextype.md).</span></span>

<span data-ttu-id="03702-112">ETW 層級包括：1關鍵;2錯誤;3警告;4資訊;5詳細資訊。</span><span class="sxs-lookup"><span data-stu-id="03702-112">The ETW levels include: 1 Critical; 2 Error; 3 Warning; 4 Informational; 5 Verbose.</span></span>

<span data-ttu-id="03702-113">發生此錯誤時，事件種類 (類型資料行) 報告 "ParseRequestFailed"。</span><span class="sxs-lookup"><span data-stu-id="03702-113">With this error, the event type (Type column) reports "ParseRequestFailed".</span></span> <span data-ttu-id="03702-114">在 ParseRequestFailed 事件的後續資料行中，我們會看到 "InvalidHost" 專案。</span><span class="sxs-lookup"><span data-stu-id="03702-114">In the subsequent columns for the ParseRequestFailed event, we see an "InvalidHost" entry.</span></span> <span data-ttu-id="03702-115">此專案表示 HTTP 要求中識別的主機不正確（根據 HTTP 通訊協定）。</span><span class="sxs-lookup"><span data-stu-id="03702-115">This entry means that the identified host in the HTTP Request is incorrect, according the HTTP protocol.</span></span> <span data-ttu-id="03702-116">請注意，資料表中包含 "InvalidHost" 專案的資料行不包含在資料表中，以求簡潔，並避免 excerpting 非連續的資料行。</span><span class="sxs-lookup"><span data-stu-id="03702-116">Note the column with the "InvalidHost" entry is not included in the table for the sake of brevity and to avoid excerpting noncontiguous columns.</span></span>

<span data-ttu-id="03702-117">若要修正此剖析問題，應該更正 web 用戶端，以符合 HTTP RFC 的規範。</span><span class="sxs-lookup"><span data-stu-id="03702-117">To fix this parsing issue, the web client should be corrected to be compliant with the HTTP RFC.</span></span> 

| <span data-ttu-id="03702-118">事件名稱</span><span class="sxs-lookup"><span data-stu-id="03702-118">Event name</span></span>                    | <span data-ttu-id="03702-119">類型</span><span class="sxs-lookup"><span data-stu-id="03702-119">Type</span></span>               | <span data-ttu-id="03702-120">事件識別碼</span><span class="sxs-lookup"><span data-stu-id="03702-120">Event ID</span></span> | <span data-ttu-id="03702-121">版本</span><span class="sxs-lookup"><span data-stu-id="03702-121">Version</span></span> | <span data-ttu-id="03702-122">通路</span><span class="sxs-lookup"><span data-stu-id="03702-122">Channel</span></span> | <span data-ttu-id="03702-123">層級</span><span class="sxs-lookup"><span data-stu-id="03702-123">Level</span></span> |
|-------------------------------|--------------------|----------|---------|---------|-------|
| <span data-ttu-id="03702-124">EventTrace</span><span class="sxs-lookup"><span data-stu-id="03702-124">EventTrace</span></span>                    | <span data-ttu-id="03702-125">標頭</span><span class="sxs-lookup"><span data-stu-id="03702-125">Header</span></span>             | <span data-ttu-id="03702-126">0</span><span class="sxs-lookup"><span data-stu-id="03702-126">0</span></span>        | <span data-ttu-id="03702-127">2</span><span class="sxs-lookup"><span data-stu-id="03702-127">2</span></span>       | <span data-ttu-id="03702-128">0</span><span class="sxs-lookup"><span data-stu-id="03702-128">0</span></span>       | <span data-ttu-id="03702-129">0</span><span class="sxs-lookup"><span data-stu-id="03702-129">0</span></span>     |
| <span data-ttu-id="03702-130">Microsoft-Windows-HttpService</span><span class="sxs-lookup"><span data-stu-id="03702-130">Microsoft-Windows-HttpService</span></span> | <span data-ttu-id="03702-131">AddUrl</span><span class="sxs-lookup"><span data-stu-id="03702-131">AddUrl</span></span>             | <span data-ttu-id="03702-132">31</span><span class="sxs-lookup"><span data-stu-id="03702-132">31</span></span>       | <span data-ttu-id="03702-133">0</span><span class="sxs-lookup"><span data-stu-id="03702-133">0</span></span>       | <span data-ttu-id="03702-134">16</span><span class="sxs-lookup"><span data-stu-id="03702-134">16</span></span>      | <span data-ttu-id="03702-135">4</span><span class="sxs-lookup"><span data-stu-id="03702-135">4</span></span>     |
| <span data-ttu-id="03702-136">Microsoft-Windows-HttpService</span><span class="sxs-lookup"><span data-stu-id="03702-136">Microsoft-Windows-HttpService</span></span> | <span data-ttu-id="03702-137">ConnConnect</span><span class="sxs-lookup"><span data-stu-id="03702-137">ConnConnect</span></span>        | <span data-ttu-id="03702-138">21</span><span class="sxs-lookup"><span data-stu-id="03702-138">21</span></span>       | <span data-ttu-id="03702-139">0</span><span class="sxs-lookup"><span data-stu-id="03702-139">0</span></span>       | <span data-ttu-id="03702-140">16</span><span class="sxs-lookup"><span data-stu-id="03702-140">16</span></span>      | <span data-ttu-id="03702-141">4</span><span class="sxs-lookup"><span data-stu-id="03702-141">4</span></span>     |
| <span data-ttu-id="03702-142">Microsoft-Windows-HttpService</span><span class="sxs-lookup"><span data-stu-id="03702-142">Microsoft-Windows-HttpService</span></span> | <span data-ttu-id="03702-143">ConnIdAssgn</span><span class="sxs-lookup"><span data-stu-id="03702-143">ConnIdAssgn</span></span>        | <span data-ttu-id="03702-144">22</span><span class="sxs-lookup"><span data-stu-id="03702-144">22</span></span>       | <span data-ttu-id="03702-145">0</span><span class="sxs-lookup"><span data-stu-id="03702-145">0</span></span>       | <span data-ttu-id="03702-146">16</span><span class="sxs-lookup"><span data-stu-id="03702-146">16</span></span>      | <span data-ttu-id="03702-147">4</span><span class="sxs-lookup"><span data-stu-id="03702-147">4</span></span>     |
| <span data-ttu-id="03702-148">Microsoft-Windows-HttpService</span><span class="sxs-lookup"><span data-stu-id="03702-148">Microsoft-Windows-HttpService</span></span> | <span data-ttu-id="03702-149">RecvReq</span><span class="sxs-lookup"><span data-stu-id="03702-149">RecvReq</span></span>            | <span data-ttu-id="03702-150">1</span><span class="sxs-lookup"><span data-stu-id="03702-150">1</span></span>        | <span data-ttu-id="03702-151">0</span><span class="sxs-lookup"><span data-stu-id="03702-151">0</span></span>       | <span data-ttu-id="03702-152">16</span><span class="sxs-lookup"><span data-stu-id="03702-152">16</span></span>      | <span data-ttu-id="03702-153">4</span><span class="sxs-lookup"><span data-stu-id="03702-153">4</span></span>     |
| <span data-ttu-id="03702-154">Microsoft-Windows-HttpService</span><span class="sxs-lookup"><span data-stu-id="03702-154">Microsoft-Windows-HttpService</span></span> | <span data-ttu-id="03702-155">ParseRequestFailed</span><span class="sxs-lookup"><span data-stu-id="03702-155">ParseRequestFailed</span></span> | <span data-ttu-id="03702-156">52</span><span class="sxs-lookup"><span data-stu-id="03702-156">52</span></span>       | <span data-ttu-id="03702-157">0</span><span class="sxs-lookup"><span data-stu-id="03702-157">0</span></span>       | <span data-ttu-id="03702-158">16</span><span class="sxs-lookup"><span data-stu-id="03702-158">16</span></span>      | <span data-ttu-id="03702-159">2</span><span class="sxs-lookup"><span data-stu-id="03702-159">2</span></span>     |
| <span data-ttu-id="03702-160">Microsoft-Windows-HttpService</span><span class="sxs-lookup"><span data-stu-id="03702-160">Microsoft-Windows-HttpService</span></span> | <span data-ttu-id="03702-161">LogFileWrite</span><span class="sxs-lookup"><span data-stu-id="03702-161">LogFileWrite</span></span>       | <span data-ttu-id="03702-162">51</span><span class="sxs-lookup"><span data-stu-id="03702-162">51</span></span>       | <span data-ttu-id="03702-163">0</span><span class="sxs-lookup"><span data-stu-id="03702-163">0</span></span>       | <span data-ttu-id="03702-164">16</span><span class="sxs-lookup"><span data-stu-id="03702-164">16</span></span>      | <span data-ttu-id="03702-165">4</span><span class="sxs-lookup"><span data-stu-id="03702-165">4</span></span>     |



 

<span data-ttu-id="03702-166">表2：剖析問題的範例追蹤報表摘錄</span><span class="sxs-lookup"><span data-stu-id="03702-166">Table 2: Excerpts from a Sample Trace Report for a Parsing Issue</span></span>

 

 