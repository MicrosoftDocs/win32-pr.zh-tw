---
title: " (HTTP 伺服器 API) 的版本控制"
description: HTTP 伺服器版本 2.0 API 會套用物件範圍版本設定，以判斷 API 的版本。
ms.assetid: 2c2d7501-85e0-44ec-aa42-01372b29266e
keywords:
- HTTP Server 2.0 版 API 中的版本設定
- HTTP 伺服器版本 2.0 API，版本控制
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 5221ff7a93bb24e7e0b8a1b9f7c2399012cdbe95
ms.sourcegitcommit: 8fa6614b715bddf14648cce36d2df22e5232801a
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 12/10/2020
ms.locfileid: "104093635"
---
# <a name="versioning-http-server-api"></a><span data-ttu-id="7e641-105"> (HTTP 伺服器 API) 的版本控制</span><span class="sxs-lookup"><span data-stu-id="7e641-105">Versioning (HTTP Server API)</span></span>

<span data-ttu-id="7e641-106">HTTP 伺服器版本 2.0 API 使版本1.0 要求佇列和 URL 關聯與要求佇列過時。</span><span class="sxs-lookup"><span data-stu-id="7e641-106">The HTTP Server version 2.0 API makes obsolete the version 1.0 request queues and URL associations with the request queue.</span></span> <span data-ttu-id="7e641-107">物件範圍的版本控制可讓應用程式提供應用程式特定的版本資訊。</span><span class="sxs-lookup"><span data-stu-id="7e641-107">Object-scoped versioning allows applications to supply application-specific version information.</span></span> <span data-ttu-id="7e641-108">應用程式可以針對執行所在的作業系統，自動呼叫正確的結構版本。</span><span class="sxs-lookup"><span data-stu-id="7e641-108">An applications can automatically call the correct version of structures for the operating system on which it is running.</span></span>

## <a name="request-queues"></a><span data-ttu-id="7e641-109">要求佇列</span><span class="sxs-lookup"><span data-stu-id="7e641-109">Request Queues</span></span>

<span data-ttu-id="7e641-110">從 HTTP Server 2.0 版 API 開始，會建立要求佇列，並讓 [**HttpCreateRequestQueue**](/windows/desktop/api/Http/nf-http-httpcreaterequestqueue) 淘汰 1.0 [**HttpCreateHttpHandle**](/windows/desktop/api/Http/nf-http-httpcreatehttphandle) 函式版本。</span><span class="sxs-lookup"><span data-stu-id="7e641-110">Starting with HTTP Server version 2.0 API, request queues are created with [**HttpCreateRequestQueue**](/windows/desktop/api/Http/nf-http-httpcreaterequestqueue) making obsolete the version 1.0 [**HttpCreateHttpHandle**](/windows/desktop/api/Http/nf-http-httpcreatehttphandle) function.</span></span> <span data-ttu-id="7e641-111">使用 [**HttpCreateUrlGroup**](/windows/desktop/api/Http/nf-http-httpcreateurlgroup) 函式時，會在2.0 版中引進 URL 群組。</span><span class="sxs-lookup"><span data-stu-id="7e641-111">URL groups are introduced in version 2.0 with the [**HttpCreateUrlGroup**](/windows/desktop/api/Http/nf-http-httpcreateurlgroup) function.</span></span> <span data-ttu-id="7e641-112">使用 [**HttpAddUrlToUrlGroup**](/windows/desktop/api/Http/nf-http-httpaddurltourlgroup) 將 url 新增至群組，以使1.0 版 [**HttpAddUrl**](/windows/desktop/api/Http/nf-http-httpaddurl) 函式過時。</span><span class="sxs-lookup"><span data-stu-id="7e641-112">URLs are added to the group using [**HttpAddUrlToUrlGroup**](/windows/desktop/api/Http/nf-http-httpaddurltourlgroup) which makes obsolete the version 1.0 [**HttpAddUrl**](/windows/desktop/api/Http/nf-http-httpaddurl) function.</span></span> <span data-ttu-id="7e641-113">版本 2.0 URL 群組不得搭配1.0 版要求佇列使用。</span><span class="sxs-lookup"><span data-stu-id="7e641-113">Version 2.0 URL groups must not be used with version 1.0 request queues.</span></span>

<span data-ttu-id="7e641-114">從2.0 版開始，下列1.0 版函式已過時，無法搭配版本2.0 要求佇列使用：</span><span class="sxs-lookup"><span data-stu-id="7e641-114">Starting with version 2.0, the following version 1.0 functions are obsolete and cannot be used with version 2.0 request queues:</span></span>

-   [<span data-ttu-id="7e641-115">**HttpCreateHttpHandle**</span><span class="sxs-lookup"><span data-stu-id="7e641-115">**HttpCreateHttpHandle**</span></span>](/windows/desktop/api/Http/nf-http-httpcreatehttphandle)
-   [<span data-ttu-id="7e641-116">**HttpAddUrl**</span><span class="sxs-lookup"><span data-stu-id="7e641-116">**HttpAddUrl**</span></span>](/windows/desktop/api/Http/nf-http-httpaddurl)
-   [<span data-ttu-id="7e641-117">**HttpRemoveUrl**</span><span class="sxs-lookup"><span data-stu-id="7e641-117">**HttpRemoveUrl**</span></span>](/windows/desktop/api/Http/nf-http-httpremoveurl)

<span data-ttu-id="7e641-118">如需設定 URL 群組的詳細資訊，請參閱設定 [Url 群組](configuring-the-url-group.md) 主題。</span><span class="sxs-lookup"><span data-stu-id="7e641-118">For more information about configuring URL groups, see the [Configuring the URL Group](configuring-the-url-group.md) topic.</span></span> <span data-ttu-id="7e641-119">如需2.0 版要求佇列的詳細資訊，請參閱「 [命名要求佇列](named-request-queue.md) 」主題。</span><span class="sxs-lookup"><span data-stu-id="7e641-119">For more information about version 2.0 request queues, see the [Named Request Queue](named-request-queue.md) topic.</span></span>

## <a name="object-scoped-versioning"></a><span data-ttu-id="7e641-120">Object-Scoped 版本控制</span><span class="sxs-lookup"><span data-stu-id="7e641-120">Object-Scoped Versioning</span></span>

<span data-ttu-id="7e641-121">在1.0 版中，應用程式會在呼叫 [**HttpInitialize**](/windows/desktop/api/Http/nf-http-httpinitialize)時提供 HTTP 伺服器 API 版本。</span><span class="sxs-lookup"><span data-stu-id="7e641-121">In version 1.0, the application supplies the HTTP Server API version in the call to [**HttpInitialize**](/windows/desktop/api/Http/nf-http-httpinitialize).</span></span> <span data-ttu-id="7e641-122">只有呼叫 **HttpInitialize** 的第一個應用程式會接受版本資訊，並且會在相同的進程中套用至所有 HTTP 伺服器 API 應用程式。</span><span class="sxs-lookup"><span data-stu-id="7e641-122">The version information is accepted only from the first application that called **HttpInitialize** and is applied to all the HTTP Server API applications in the same process.</span></span> <span data-ttu-id="7e641-123">從2.0 版 API 開始，不會使用 **HttpInitialize** 呼叫中提供的全域版本資訊。</span><span class="sxs-lookup"><span data-stu-id="7e641-123">Starting with the version 2.0 API, the global version information supplied in the call to **HttpInitialize** is not used.</span></span> <span data-ttu-id="7e641-124">針對2.0 版的應用程式，當要求佇列或伺服器會話由 [**HttpCreateRequestQueue**](/windows/desktop/api/Http/nf-http-httpcreaterequestqueue) 或 [**HttpCreateServerSession**](/windows/desktop/api/Http/nf-http-httpcreateserversession)所建立時，會在 VERSION 參數中傳遞 HTTP 伺服器 API 版本。</span><span class="sxs-lookup"><span data-stu-id="7e641-124">For version 2.0 applications, the HTTP Server API version is passed in the Version parameter when the request queue or server session is created by [**HttpCreateRequestQueue**](/windows/desktop/api/Http/nf-http-httpcreaterequestqueue) or [**HttpCreateServerSession**](/windows/desktop/api/Http/nf-http-httpcreateserversession).</span></span> <span data-ttu-id="7e641-125">使用1.0 版 [**HttpCreateHttpHandle**](/windows/desktop/api/Http/nf-http-httpcreatehttphandle)建立要求佇列時，會自動將它標示為1.0 版。</span><span class="sxs-lookup"><span data-stu-id="7e641-125">When the request queue is created with the version 1.0 [**HttpCreateHttpHandle**](/windows/desktop/api/Http/nf-http-httpcreatehttphandle), it is automatically marked as version 1.0.</span></span> <span data-ttu-id="7e641-126">版本1.0 和2.0 版應用程式都可以在相同的進程中執行。</span><span class="sxs-lookup"><span data-stu-id="7e641-126">Both version 1.0 and version 2.0 applications can run in the same process.</span></span>

<span data-ttu-id="7e641-127">[**Http \_ 要求**](/previous-versions/windows/desktop/legacy/aa364545(v=vs.85))和 [**HTTP \_ 回應**](http-response.md)結構會更新，以包含 HTTP 伺服器2.0 版 API 中的驗證資訊。</span><span class="sxs-lookup"><span data-stu-id="7e641-127">The [**HTTP\_REQUEST**](/previous-versions/windows/desktop/legacy/aa364545(v=vs.85)) and [**HTTP\_RESPONSE**](http-response.md) structures are updated to include authentication information in the HTTP Server version 2.0 API.</span></span> <span data-ttu-id="7e641-128">[**HTTP \_要求 \_ V1**](/windows/desktop/api/Http/ns-http-http_request_v1) 和 [**HTTP \_ 要求 \_ V2**](/windows/desktop/api/Http/ns-http-http_request_v2) 是應用程式所使用的 API 版本專用的。</span><span class="sxs-lookup"><span data-stu-id="7e641-128">[**HTTP\_REQUEST\_V1**](/windows/desktop/api/Http/ns-http-http_request_v1) and [**HTTP\_REQUEST\_V2**](/windows/desktop/api/Http/ns-http-http_request_v2) are specific to the version of the API used by the application.</span></span> <span data-ttu-id="7e641-129">不過，應用程式不應該直接在程式碼中使用這些結構;相反地，他們應該使用 **HTTP \_ 要求** ，根據收到要求的要求佇列版本取得正確的版本。</span><span class="sxs-lookup"><span data-stu-id="7e641-129">However, applications should not use these structures directly in their code; instead they should use **HTTP\_REQUEST** to get the correct version based on the version of the request queue on which the request was received.</span></span> <span data-ttu-id="7e641-130">此外，請注意 **HTTP \_ 要求** 結構的大小是以編譯器代碼所用的作業系統版本為基礎。</span><span class="sxs-lookup"><span data-stu-id="7e641-130">Also, be aware that size of the **HTTP\_REQUEST** structure is based on the version of the operating system under which the code is compiled.</span></span>

 

 
