---
description: Windows GDI+ 會公開由大約600個函式所組成的一般 API。 這些一般 API 函式是由 StringFormat c + + 類別包裝。
ms.assetid: 8e24efb1-8f7d-498a-bd21-79e182b86846
title: 字串格式函數
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 908f43c0835cba8cc811c22313630bb357fbc4618fcd7bd1d338d71b53f7a8c1
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/11/2021
ms.locfileid: "118977368"
---
# <a name="string-format-functions"></a>字串格式函數

Windows GDI+ 會公開一個包含大約600函式的一般 API，這些函式會在 Gdiplus.dll 中執行，並在 Gdiplusflat 中宣告。 GDI+ 一般 API 中的函式是由大約 40 c + + 類別的集合所包裝。 建議您不要直接呼叫一般 API 中的函式。 每當您對 GDI+ 進行呼叫時，您應該呼叫 c + + 包裝函式所提供的方法和函式。 Microsoft 產品支援服務將不會提供直接呼叫一般 API 的程式碼支援。 如需使用這些包裝函式方法的詳細資訊，請參閱[GDI+ 一般 API](-gdiplus-flatapi-flat.md)。

下列一般 API 函式是由 [**StringFormat**](/windows/desktop/api/gdiplusstringformat/nl-gdiplusstringformat-stringformat) c + + 類別包裝。

## <a name="stringformat-functions-and-corresponding-wrapper-methods"></a>StringFormat 函式和對應的包裝函式方法



| 一般函數                                                                                                                                                 | 包裝函式方法                                                                                                                                                                                             | 備註                                                                                                                                                                                                                                                                                                                                                                                                                   |
|---------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| GpStatus WINGDIPAPI GdipCreateStringFormat ( INT formatAttributes、LANGID language、GpStringFormat \* \* format ) <br/>                                     | [**StringFormat：： StringFormat ( IN INT formatFlags = 0，IN LANGID language = LANG \_ 中性 )**](/windows/win32/api/gdiplusstringformat/nf-gdiplusstringformat-stringformat-stringformat(inint_inlangid))<br/>                              | 根據字串格式旗標和語言來建立 [**StringFormat**](/windows/desktop/api/gdiplusstringformat/nl-gdiplusstringformat-stringformat) 物件。                                                                                                                                                                                                                                                                                                   |
| GpStatus WINGDIPAPI GdipStringFormatGetGenericDefault (GpStringFormat \* \* format) <br/>                                                                   | [**StringFormat \* StringFormat：： GenericDefault ()**](/windows/desktop/api/Gdiplusstringformat/nf-gdiplusstringformat-stringformat-genericdefault)<br/>                                                                                            | 建立泛型預設的 [**StringFormat**](/windows/desktop/api/gdiplusstringformat/nl-gdiplusstringformat-stringformat) 物件。                                                                                                                                                                                                                                                                                                                              |
| GpStatus WINGDIPAPI GdipStringFormatGetGenericTypographic (GpStringFormat \* \* format) <br/>                                                               | [**StringFormat \* StringFormat：： GenericTypographic ()**](/windows/desktop/api/Gdiplusstringformat/nf-gdiplusstringformat-stringformat-generictypographic)<br/>                                                                                    | 建立一般的印刷樣式 [**StringFormat**](/windows/desktop/api/gdiplusstringformat/nl-gdiplusstringformat-stringformat) 物件。                                                                                                                                                                                                                                                                                                                          |
| GpStatus WINGDIPAPI GdipDeleteStringFormat (GpStringFormat \* format) <br/>                                                                                | StringFormat：： ~ StringFormat ()  <br/>                                                                                                                                                                  | 釋放 [**StringFormat**](/windows/desktop/api/gdiplusstringformat/nl-gdiplusstringformat-stringformat) 物件所使用的資源。                                                                                                                                                                                                                                                                                                                          |
| GpStatus WINGDIPAPI GdipCloneStringFormat (GDIPCONST GpStringFormat \* format，GpStringFormat \* \* newFormat) <br/>                                         | [**StringFormat：： StringFormat ( const StringFormat \* format )**](/windows/win32/api/gdiplusstringformat/nf-gdiplusstringformat-stringformat-stringformat(conststringformat_))<br/>                                                                        | 從另一個 **StringFormat** 物件建立 [**StringFormat**](/windows/desktop/api/gdiplusstringformat/nl-gdiplusstringformat-stringformat)物件。                                                                                                                                                                                                                                                                                                          |
| GpStatus WINGDIPAPI GdipSetStringFormatFlags (GpStringFormat \* format，INT flags) <br/>                                                                   | [**Status StringFormat：： SetFormatFlags (IN INT flags)**](/windows/desktop/api/Gdiplusstringformat/nf-gdiplusstringformat-stringformat-setformatflags)<br/>                                                                                  | 設定這個 [**StringFormat**](/windows/desktop/api/gdiplusstringformat/nl-gdiplusstringformat-stringformat) 物件的格式旗標。 格式旗標會決定 **StringFormat** 物件的大部分特性。                                                                                                                                                                                                                                     |
| GpStatus WINGDIPAPI GdipGetStringFormatFlags (GDIPCONST GpStringFormat \* format，INT \* flags) <br/>                                                       | [**INT StringFormat：： GetFormatFlags () const**](/windows/desktop/api/Gdiplusstringformat/nf-gdiplusstringformat-stringformat-getformatflags)<br/>                                                                                                 | 取得這個 [**StringFormat**](/windows/desktop/api/gdiplusstringformat/nl-gdiplusstringformat-stringformat) 物件的字串格式旗標。                                                                                                                                                                                                                                                                                                                   |
| GpStatus WINGDIPAPI GdipSetStringFormatAlign (GpStringFormat \* format，StringAlignment align) <br/>                                                       | [**Status StringFormat：： SetAlignment (IN StringAlignment align)**](/windows/desktop/api/Gdiplusstringformat/nf-gdiplusstringformat-stringformat-setalignment)<br/>                                                                          | 設定這個 [**StringFormat**](/windows/desktop/api/gdiplusstringformat/nl-gdiplusstringformat-stringformat) 物件相對於版面配置矩形原點的線條對齊。 [線條對齊] 設定會指定如何在版面配置矩形中垂直對齊字串。 版面配置矩形可用來放置顯示的字串。                                                                                                       |
| GpStatus WINGDIPAPI GdipGetStringFormatAlign (GDIPCONST GpStringFormat \* format，StringAlignment \* align) <br/>                                           | [**StringAlignment StringFormat：： GetAlignment () const**](/windows/desktop/api/Gdiplusstringformat/nf-gdiplusstringformat-stringformat-getalignment)<br/>                                                                                         | 取得 [**StringAlignment**](/windows/desktop/api/Gdiplusenums/ne-gdiplusenums-stringalignment) 列舉的元素，指出這個 [**StringFormat**](/windows/desktop/api/gdiplusstringformat/nl-gdiplusstringformat-stringformat) 物件相對於配置矩形原點的字元對齊。 版面配置矩形可用來放置顯示的字串。                                                                                               |
| GpStatus WINGDIPAPI GdipSetStringFormatLineAlign (GpStringFormat \* format，StringAlignment align) <br/>                                                   | [**Status StringFormat：： SetLineAlignment (IN StringAlignment align)**](/windows/desktop/api/Gdiplusstringformat/nf-gdiplusstringformat-stringformat-setlinealignment)<br/>                                                                  | 設定這個 [**StringFormat**](/windows/desktop/api/gdiplusstringformat/nl-gdiplusstringformat-stringformat) 物件相對於版面配置矩形原點的線條對齊。 [線條對齊] 設定會指定如何在版面配置矩形中垂直對齊字串。 版面配置矩形可用來放置顯示的字串。                                                                                                       |
| GpStatus WINGDIPAPI GdipGetStringFormatLineAlign (GDIPCONST GpStringFormat \* format，StringAlignment \* align) <br/>                                       | [**StringAlignment StringFormat：： GetLineAlignment () const**](/windows/desktop/api/Gdiplusstringformat/nf-gdiplusstringformat-stringformat-getlinealignment)<br/>                                                                                 | 取得 [**StringAlignment**](/windows/desktop/api/Gdiplusenums/ne-gdiplusenums-stringalignment) 列舉的元素，指出這個 [**StringFormat**](/windows/desktop/api/gdiplusstringformat/nl-gdiplusstringformat-stringformat) 物件相對於配置矩形原點的行對齊方式。 [線條對齊] 設定會指定如何在版面配置矩形中垂直對齊字串。 版面配置矩形可用來放置顯示的字串。 |
| GpStatus WINGDIPAPI GdipSetStringFormatTrimming ( GpStringFormat \* 格式，StringTrimming 修剪 ) <br/>                                                | [**Status StringFormat：： SetTrimming (IN StringTrimming 修剪)**](/windows/desktop/api/Gdiplusstringformat/nf-gdiplusstringformat-stringformat-settrimming)<br/>                                                                       | 設定這個 [**StringFormat**](/windows/desktop/api/gdiplusstringformat/nl-gdiplusstringformat-stringformat) 物件的修剪樣式。 修剪樣式會決定如何修剪字串，使其符合版面配置矩形。                                                                                                                                                                                                                          |
| GpStatus WINGDIPAPI GdipGetStringFormatTrimming ( GDIPCONST GpStringFormat \* format、StringTrimming \* 修剪 ) <br/>                                    | [**StringTrimming StringFormat：： GetTrimming () const**](/windows/desktop/api/Gdiplusstringformat/nf-gdiplusstringformat-stringformat-gettrimming)<br/>                                                                                            | 取得 [**StringTrimming**](/windows/desktop/api/Gdiplusenums/ne-gdiplusenums-stringtrimming) 列舉的元素，指出這個 [**StringFormat**](/windows/desktop/api/gdiplusstringformat/nl-gdiplusstringformat-stringformat) 物件的修剪樣式。 修剪樣式會決定如何修剪字串中太大而無法納入版面配置矩形的字元。                                                                                                |
| GpStatus WINGDIPAPI GdipSetStringFormatHotkeyPrefix (GpStringFormat \* format，INT hotkeyPrefix) <br/>                                                     | [**Status StringFormat：： SetHotkeyPrefix (IN HotkeyPrefix hotkeyPrefix)**](/windows/desktop/api/Gdiplusstringformat/nf-gdiplusstringformat-stringformat-sethotkeyprefix)<br/>                                                         | 設定遇到熱鍵前置詞（ (&) ）時在字串上執行的處理類型。 連字號稱為快速鍵前置詞，可用來將特定索引鍵指定為快速鍵。                                                                                                                                                                                                    |
| GpStatus WINGDIPAPI GdipGetStringFormatHotkeyPrefix (GDIPCONST GpStringFormat \* format，INT \* hotkeyPrefix) <br/>                                         | [**HotkeyPrefix StringFormat：： GetHotkeyPrefix () const**](/windows/desktop/api/Gdiplusstringformat/nf-gdiplusstringformat-stringformat-gethotkeyprefix)<br/>                                                                                      | 取得 [**HotkeyPrefix**](/windows/desktop/api/Gdiplusenums/ne-gdiplusenums-hotkeyprefix) 列舉的元素，這個專案會指出遇到熱鍵前置詞（ (&) ）時在字串上執行的處理類型。                                                                                                                                                                                                        |
| GpStatus WINGDIPAPI GdipSetStringFormatTabStops (GpStringFormat \* format、REAL firstTabOffset、INT count、GDIPCONST REAL \* tabStops) <br/>                | [**Status StringFormat：： SetTabStops ( IN REAL firstTabOffset，INT count in const REAL \* tabStops )**](/windows/desktop/api/Gdiplusstringformat/nf-gdiplusstringformat-stringformat-settabstops)<br/>            | 設定這個 [**StringFormat**](/windows/desktop/api/gdiplusstringformat/nl-gdiplusstringformat-stringformat) 物件中的定位停駐點位移。                                                                                                                                                                                                                                                                                                                  |
| GpStatus WINGDIPAPI GdipGetStringFormatTabStops (GDIPCONST GpStringFormat \* format、INT count、real \* FIRSTTABOFFSET、real \* tabStops) <br/>              | [**Status StringFormat：： GetTabStops ( IN INT count、OUT REAL \* firstTabOffset、OUT real \* tabStops ) const**](/windows/desktop/api/Gdiplusstringformat/nf-gdiplusstringformat-stringformat-gettabstops)<br/>        | 取得這個 [**StringFormat**](/windows/desktop/api/gdiplusstringformat/nl-gdiplusstringformat-stringformat) 物件中的定位停駐點位移。                                                                                                                                                                                                                                                                                                               |
| GpStatus WINGDIPAPI GdipGetStringFormatTabStopCount (GDIPCONST GpStringFormat \* format，INT \* count) <br/>                                               | [**INT StringFormat：： GetTabStopCount () const**](/windows/desktop/api/Gdiplusstringformat/nf-gdiplusstringformat-stringformat-gettabstopcount)<br/>                                                                                               | 取得這個 [**StringFormat**](/windows/desktop/api/gdiplusstringformat/nl-gdiplusstringformat-stringformat) 物件中的 tab 鍵停用位移數目。                                                                                                                                                                                                                                                                                                             |
| GpStatus WINGDIPAPI GdipSetStringFormatDigitSubstitution (GpStringFormat \* format、LANGID language、StringDigitSubstitute 替代) <br/>               | [**Status StringFormat：： SetDigitSubstitution ( IN LANGID language，IN StringDigitSubstitute 替代 )**](/windows/desktop/api/Gdiplusstringformat/nf-gdiplusstringformat-stringformat-setdigitsubstitution)<br/>           | 設定數位替代方法，以及對應至替代數位的語言。                                                                                                                                                                                                                                                                                                                            |
| GpStatus WINGDIPAPI GdipGetStringFormatDigitSubstitution (GDIPCONST GpStringFormat \* format、LANGID \* Language、StringDigitSubstitute \* 替代) <br/> | [**StringDigitSubstitute StringFormat：： GetDigitSubstitutionMethod ( ) const**](/windows/desktop/api/Gdiplusstringformat/nf-gdiplusstringformat-stringformat-getdigitsubstitutionmethod)<br/>                                                      | 取得 [**StringDigitSubstitute**](/windows/desktop/api/Gdiplusenums/ne-gdiplusenums-stringdigitsubstitute) 列舉的元素，指出這個 [**StringFormat**](/windows/desktop/api/gdiplusstringformat/nl-gdiplusstringformat-stringformat) 物件所使用的數位替代方法。<br/> 一般函數中的 *language* 參數是16位值，可指定要使用的語言。<br/>                                                     |
| GpStatus WINGDIPAPI GdipGetStringFormatMeasurableCharacterRangeCount ( GDIPCONST GpStringFormat \* format，INT \* count ) <br/>                             | [**INT StringFormat：： GetMeasurableCharacterRangeCount ()**](/windows/desktop/api/Gdiplusstringformat/nf-gdiplusstringformat-stringformat-getmeasurablecharacterrangecount)<br/>                                                                   | 取得目前設定的可測量字元範圍數目。 您可以使用 [**Graphics：： MeasureCharacterRanges**](/windows/desktop/api/Gdiplusgraphics/nf-gdiplusgraphics-graphics-measurecharacterranges) 方法，以字串來測量設定的字元範圍。                                                                                                                |
| GpStatus WINGDIPAPI GdipSetStringFormatMeasurableCharacterRanges ( GpStringFormat \* format、INT rangeCount、GDIPCONST CharacterRange \* 範圍 ) <br/>     | [**Status StringFormat：： SetMeasurableCharacterRanges ( IN INT rangeCount，IN const CharacterRange \* 範圍 )**](/windows/desktop/api/Gdiplusstringformat/nf-gdiplusstringformat-stringformat-setmeasurablecharacterranges)<br/> | 設定這個 StringFormat 物件的一連串字元範圍，該物件在字串中可以用 [**Graphics：： MeasureCharacterRanges**](/windows/desktop/api/Gdiplusgraphics/nf-gdiplusgraphics-graphics-measurecharacterranges) 方法來測量。                                                                                                                                                    |



 

 

 
