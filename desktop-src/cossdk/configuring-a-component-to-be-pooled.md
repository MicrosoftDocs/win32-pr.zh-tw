---
description: 您可以設定只有在已正確寫入元件以支援進行共用時，才會將它設定為集區。 如需這些需求的詳細資訊，請參閱共用物件的需求。
ms.assetid: ffd812cc-811e-4f2a-8736-d1cb22d5abb7
title: 設定要共用的元件
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e2640a9c038a8d0d12e1447adafbaaea91c3addddffd04bccdfad0ba4180740f
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/11/2021
ms.locfileid: "118102380"
---
# <a name="configuring-a-component-to-be-pooled"></a>設定要共用的元件

您可以設定只有在已正確寫入元件以支援進行共用時，才會將它設定為集區。 如需這些需求的詳細資訊，請參閱 [共用物件的需求](requirements-for-poolable-objects.md)。

> [!Note]  
> 依預設，元件不會設定為集區。

 

當您設定要共用的元件時，可以指定下列屬性來決定 COM + 如何維護集區：

-   **最小集區大小。** 表示應用程式啟動時所建立的物件數目，以及在應用程式執行時，集區中維護的物件數目下限。 如果集區中可用的物件數目降到低於指定的最小值，就會建立新的物件來符合任何未處理的物件要求，並重新填滿集區。 如果集區中可用的物件數目大於最小數目，則會在清除週期期間終結這些剩餘的物件。
-   **最大集區大小。** 代表共用管理員將建立的集區物件數目上限，同時由用戶端主動使用和集區中非使用中。 建立物件時，共用管理員會檢查以確認尚未達到集區大小上限，如果沒有，則集區管理員會建立要分配給用戶端之物件的新實例。 如果已達到最大集區大小，用戶端要求將會排入佇列，並且會先以先服務的方式從集區接收第一個可用的物件。 物件建立要求會在指定的期間之後超時。
-   **建立 timeout (ms) 。** 指定在呼叫 [**CoCreateInstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance)之後，從集區傳回物件的用戶端會等待的時間（以毫秒為單位）。 如果用戶端呼叫失敗，則 \_ 會傳回錯誤 E TIMEOUT。

**若要設定共用相關屬性**

1.  在 [元件服務] 系統管理工具的詳細資料窗格中，以滑鼠 **按右鍵您** 要設定的元件，然後按一下 [內容]。

2.  在 [元件屬性] 對話方塊中，按一下 [ **啟用** ] 索引標籤。

3.  若要啟用元件的物件共用，請選取 [ **啟用物件** 共用] 核取方塊。

4.  在 [ **最小集區大小** ] 方塊中，輸入此類型在集區中的最小物件數目。 集區將維持至少這個物件的數目。

5.  在 [u] 方塊中，輸入此類型在集區中的最大物件數目。 物件數目（啟用和停用）永遠不會超過此值。

6.  在 [ **建立超時 (ms)** ] 方塊中，輸入用戶端會等待集區物件的時間（以毫秒為單位）（如果無法立即使用的話）。

## <a name="related-topics"></a>相關主題

<dl> <dt>

[監視物件統計資料](monitoring-object-statistics.md)
</dt> </dl>

 

 
