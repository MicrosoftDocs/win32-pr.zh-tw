---
description: COM + 1.5 版新增了新功能，其設計目的是為了提升開發人員和系統管理員的 COM + 應用程式的整體擴充性、可用性和管理性。
ms.assetid: e7073ba5-6b19-4d94-8cc0-b4e16bb44afd
title: COM + 1.5 的新功能
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 994237002ea5d19c2cb00364f1064df38ed7271f
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/07/2021
ms.locfileid: "104385980"
---
# <a name="whats-new-in-com-15"></a><span data-ttu-id="5ceb4-103">COM + 1.5 的新功能</span><span class="sxs-lookup"><span data-stu-id="5ceb4-103">What's New in COM+ 1.5</span></span>

<span data-ttu-id="5ceb4-104">COM + 1.5 版新增了新功能，其設計目的是為了提升開發人員和系統管理員的 COM + 應用程式的整體擴充性、可用性和管理性。</span><span class="sxs-lookup"><span data-stu-id="5ceb4-104">COM+ version 1.5 adds new features that are designed to increase the overall scalability, availability, and manageability of COM+ applications both for developers and for system administrators.</span></span>

<span data-ttu-id="5ceb4-105">從 Windows XP 和 Windows Server 2003 開始，可以使用 COM + 1.5。</span><span class="sxs-lookup"><span data-stu-id="5ceb4-105">COM+ 1.5 is available starting with Windows XP and Windows Server 2003.</span></span> <span data-ttu-id="5ceb4-106">Windows 2000 中無法使用新的 COM + 1.5 功能。</span><span class="sxs-lookup"><span data-stu-id="5ceb4-106">The new COM+ 1.5 features are not available in Windows 2000.</span></span>

## <a name="application-level-access-checks-enabled-by-default"></a><span data-ttu-id="5ceb4-107">預設啟用 Application-Level 存取檢查</span><span class="sxs-lookup"><span data-stu-id="5ceb4-107">Application-Level Access Checks Enabled by Default</span></span>

<span data-ttu-id="5ceb4-108">作為系統的增強安全性的一部分，建立 COM + 應用程式時，預設會啟用存取檢查。</span><span class="sxs-lookup"><span data-stu-id="5ceb4-108">As part of the enhanced security of the system, access checks are enabled by default when creating a COM+ application.</span></span> <span data-ttu-id="5ceb4-109">在先前的版本中，預設會在應用層級停用存取檢查，並且預設會在元件層級啟用。</span><span class="sxs-lookup"><span data-stu-id="5ceb4-109">In previous versions, access checks were disabled by default at the application level and enabled by default at the component level.</span></span> <span data-ttu-id="5ceb4-110">從 Windows Server 2003 開始，依預設會在應用層級啟用存取檢查，並且在元件層級預設為停用。</span><span class="sxs-lookup"><span data-stu-id="5ceb4-110">Starting with Windows Server 2003, access checks are enabled by default at the application level and disabled by default at the component level.</span></span> <span data-ttu-id="5ceb4-111">如需有關如何變更預設設定的詳細資訊和程式，請參閱 [建立新的 COM + 應用程式](creating-a-new-com--application.md)、 [啟用應用程式的存取檢查](enabling-access-checks-for-an-application.md)，以及在 [元件層級啟用存取檢查](enabling-access-checks-at-the-component-level.md) 。</span><span class="sxs-lookup"><span data-stu-id="5ceb4-111">See [Creating a New COM+ Application](creating-a-new-com--application.md), [Enabling Access Checks for an Application](enabling-access-checks-for-an-application.md), and [Enabling Access Checks at the Component Level](enabling-access-checks-at-the-component-level.md) for more information and procedures on how to change the default settings.</span></span>

## <a name="application-pooling"></a><span data-ttu-id="5ceb4-112">應用程式集區</span><span class="sxs-lookup"><span data-stu-id="5ceb4-112">Application Pooling</span></span>

<span data-ttu-id="5ceb4-113">使用 [**應用程式**](applications.md)集合中 [**COMAdminCatalogObject**](comadmincatalogobject.md)物件的新 ConcurrentApps 屬性，com + 應用程式共用會為單一執行緒進程新增擴充性，並與新的 Com + 應用程式回收服務整合。</span><span class="sxs-lookup"><span data-stu-id="5ceb4-113">With the new ConcurrentApps property of the [**COMAdminCatalogObject**](comadmincatalogobject.md) object in the [**Applications**](applications.md) collection, COM+ Application Pooling adds scalability for single-threaded processes and integrates with the new COM+ Application Recycling service.</span></span> <span data-ttu-id="5ceb4-114">如需詳細資訊，請參閱 [Com + 應用程式](com--application-pooling.md) 集區。</span><span class="sxs-lookup"><span data-stu-id="5ceb4-114">See [COM+ Application Pooling](com--application-pooling.md) for detailed information.</span></span>

## <a name="application-recycling"></a><span data-ttu-id="5ceb4-115">應用程式回收</span><span class="sxs-lookup"><span data-stu-id="5ceb4-115">Application Recycling</span></span>

<span data-ttu-id="5ceb4-116">應用程式回收可大幅提升應用程式的整體穩定性。</span><span class="sxs-lookup"><span data-stu-id="5ceb4-116">Application recycling significantly increases the overall stability of your applications.</span></span> <span data-ttu-id="5ceb4-117">因為大部分應用程式的效能可能會因為像是記憶體流失、依賴協力廠商程式碼，以及 nonscalable 資源使用情形等因素而降低，所以 COM + 應用程式回收提供簡單的解決方案，可正常關閉與應用程式相關聯的進程並重新啟動。</span><span class="sxs-lookup"><span data-stu-id="5ceb4-117">Because the performance of most applications can degrade over time due to factors such as memory leaks, reliance on third-party code, and nonscalable resource usage, COM+ application recycling provides a simple solution to gracefully shut down a process associated with an application and restart it.</span></span> <span data-ttu-id="5ceb4-118">如需詳細資訊，請參閱 [Com + 應用程式回收](com--application-recycling.md) 。</span><span class="sxs-lookup"><span data-stu-id="5ceb4-118">See [COM+ Application Recycling](com--application-recycling.md) for detailed information.</span></span> <span data-ttu-id="5ceb4-119">另請參閱「元件服務管理說明」中的「設定進程回收」，以取得設定進程回收的逐步程式。</span><span class="sxs-lookup"><span data-stu-id="5ceb4-119">Also see "Configuring Process Recycling" in the Component Services Administration Help for a step-by-step procedure for configuring process recycling.</span></span>

## <a name="com-partitions"></a><span data-ttu-id="5ceb4-120">COM + 磁碟分割</span><span class="sxs-lookup"><span data-stu-id="5ceb4-120">COM+ Partitions</span></span>

<span data-ttu-id="5ceb4-121">在此版本中，COM + 引進了 COM + 分割的支援，這項功能可讓您在同一部電腦上安裝及設定多個版本的 COM + 應用程式。</span><span class="sxs-lookup"><span data-stu-id="5ceb4-121">In this release, COM+ introduces support for COM+ partitions, a feature that allows multiple versions of COM+ applications to be installed and configured on the same machine.</span></span> <span data-ttu-id="5ceb4-122">這項功能可以節省使用多部伺服器來管理不同應用程式版本的成本和耗時的工作。</span><span class="sxs-lookup"><span data-stu-id="5ceb4-122">This feature can save you the cost and time-consuming effort of using multiple servers to manage different versions of an application.</span></span> <span data-ttu-id="5ceb4-123">在單一電腦上，每個磁碟分割實際上都會作為虛擬伺服器。</span><span class="sxs-lookup"><span data-stu-id="5ceb4-123">On a single machine, each partition acts, in effect, as a virtual server.</span></span> <span data-ttu-id="5ceb4-124">將應用程式安裝到每個資料分割之後，您可以建立將使用者對應至邏輯伺服器的資料分割集。</span><span class="sxs-lookup"><span data-stu-id="5ceb4-124">After installing the application into each partition, you create partition sets that map users to the logical servers.</span></span> <span data-ttu-id="5ceb4-125">如需如何設定和管理 COM + 分割的詳細資訊，請參閱 [Com +](com--partitions.md) 分割。</span><span class="sxs-lookup"><span data-stu-id="5ceb4-125">See [COM+ Partitions](com--partitions.md) for detailed information about how to set up and manage COM+ partitions.</span></span> <span data-ttu-id="5ceb4-126">另請參閱「元件服務管理說明」中的「管理應用程式磁碟分割」，以取得逐步程式。</span><span class="sxs-lookup"><span data-stu-id="5ceb4-126">Also see "Administering Application Partitions" in the Component Services Administration Help for step-by-step procedures.</span></span>

## <a name="com-services-without-components"></a><span data-ttu-id="5ceb4-127">沒有元件的 COM + 服務</span><span class="sxs-lookup"><span data-stu-id="5ceb4-127">COM+ Services Without Components</span></span>

<span data-ttu-id="5ceb4-128">使用 COM + 1.5，您可以使用 COM + 所提供的服務，而不需要建立元件來包含呼叫這些服務的方法。</span><span class="sxs-lookup"><span data-stu-id="5ceb4-128">With COM+ 1.5, you can use the services provided by COM+ without needing to build a component to contain the methods that call those services.</span></span> <span data-ttu-id="5ceb4-129">這可大幅獲益于通常不使用元件，但想要使用 COM + 服務（例如交易或 COM + 追蹤器）的開發人員。</span><span class="sxs-lookup"><span data-stu-id="5ceb4-129">This greatly benefits developers who do not normally use components but want to use COM+ services such as transactions or the COM+ Tracker.</span></span> <span data-ttu-id="5ceb4-130">藉由使用沒有元件的 COM + 服務，開發人員可以避免建立元件的額外負荷，而此元件只會用來存取所需的 COM + 服務。</span><span class="sxs-lookup"><span data-stu-id="5ceb4-130">By using COM+ services without components, developers can avoid the overhead of creating a component that is used to access only the COM+ services they need.</span></span> <span data-ttu-id="5ceb4-131">如需詳細資訊，請參閱 [沒有元件的 Com + 服務](com--services-without-components.md) 。</span><span class="sxs-lookup"><span data-stu-id="5ceb4-131">See [COM+ Services Without Components](com--services-without-components.md) for detailed information.</span></span>

## <a name="com-soap-service"></a><span data-ttu-id="5ceb4-132">COM + SOAP 服務</span><span class="sxs-lookup"><span data-stu-id="5ceb4-132">COM+ SOAP Service</span></span>

<span data-ttu-id="5ceb4-133">使用 COM + 1.5，您現在可以將 COM + 應用程式公開為 XML web service。</span><span class="sxs-lookup"><span data-stu-id="5ceb4-133">With COM+ 1.5, you can now expose a COM+ application as an XML web service.</span></span> <span data-ttu-id="5ceb4-134">您也可以使用 COM 元件，以透明的方式使用 XML web service （不論是否使用 COM + 部署）。</span><span class="sxs-lookup"><span data-stu-id="5ceb4-134">You can also transparently use an XML web service, whether deployed using COM+ or not, as a COM component.</span></span> <span data-ttu-id="5ceb4-135">這表示您可以輕鬆地從現有的 COM + 應用程式建立新的 XML web service，並輕鬆地將 XML web service 併入新的 COM + 應用程式。</span><span class="sxs-lookup"><span data-stu-id="5ceb4-135">This means that you can easily create new XML web services out of existing COM+ applications and easily incorporate XML web services into new COM+ applications.</span></span> <span data-ttu-id="5ceb4-136">如需詳細資訊，請參閱 [Com + SOAP 服務](com--soap-service.md) 。</span><span class="sxs-lookup"><span data-stu-id="5ceb4-136">See [COM+ SOAP Service](com--soap-service.md) for detailed information.</span></span>

## <a name="configurable-isolation-levels"></a><span data-ttu-id="5ceb4-137">可設定的隔離等級</span><span class="sxs-lookup"><span data-stu-id="5ceb4-137">Configurable Isolation Levels</span></span>

<span data-ttu-id="5ceb4-138">COM + 開發人員可以使用新的 TxIsolationLevel 內容或 [元件服務] 系統管理工具，根據需求來設定應用程式的隔離等級，以協助增加平行存取、效能和擴充性。</span><span class="sxs-lookup"><span data-stu-id="5ceb4-138">COM+ developers can use the new TxIsolationLevel property or the Component Services administrative tool to configure an application's isolation level according to need, helping to increase concurrency, performance, and scalability.</span></span> <span data-ttu-id="5ceb4-139">這種彈性可讓具有適當專長的人員，從其應用程式取得每個最後的輸送量。</span><span class="sxs-lookup"><span data-stu-id="5ceb4-139">This flexibility enables those with the right amount of expertise to get every last ounce of throughput out of their applications.</span></span> <span data-ttu-id="5ceb4-140">如需詳細資訊，請參閱設定 [交易隔離等級](configuring-transaction-isolation-levels.md) 。</span><span class="sxs-lookup"><span data-stu-id="5ceb4-140">See [Configuring Transaction Isolation Levels](configuring-transaction-isolation-levels.md) for detailed information.</span></span>

## <a name="creating-private-components"></a><span data-ttu-id="5ceb4-141">建立私用元件</span><span class="sxs-lookup"><span data-stu-id="5ceb4-141">Creating Private Components</span></span>

<span data-ttu-id="5ceb4-142">如果您在應用程式中有數個協助程式元件，而該應用程式只能從該應用程式內的其他元件呼叫，這一版的 COM + 可讓您使用新的屬性 IsPrivateComponent，將這些元件標示為私用。</span><span class="sxs-lookup"><span data-stu-id="5ceb4-142">In scenarios where you have several helper components in an application that are meant to be called only from other components within that application, this release of COM+ enables you to use a new property, IsPrivateComponent, to mark these components as private.</span></span> <span data-ttu-id="5ceb4-143"> (在先前的 COM + 版本中，所有元件都必須是公用的，才能存取 COM + 服務，這表示可以從其他應用程式啟動這些元件。 ) 私用元件只能由相同應用程式中的其他元件來查看和啟動，讓您更充分掌控要公開的功能。</span><span class="sxs-lookup"><span data-stu-id="5ceb4-143">(In the previous release of COM+, all components had to be public to have access to COM+ services, which means that these components could be activated from other applications.) A private component can be seen and activated only by other components in the same application, giving you more control over what functionality to expose.</span></span> <span data-ttu-id="5ceb4-144">您只需要記錄和維護公用元件，同時使用無法從應用程式外部存取的私用元件，但仍可利用所有 COM + 服務。</span><span class="sxs-lookup"><span data-stu-id="5ceb4-144">You need only document and maintain the public components, while making use of private components that cannot be accessed from outside the application but that can still take advantage of all COM+ services.</span></span>

## <a name="dtc-security-settings"></a><span data-ttu-id="5ceb4-145">DTC 安全性設定</span><span class="sxs-lookup"><span data-stu-id="5ceb4-145">DTC Security Settings</span></span>

<span data-ttu-id="5ceb4-146">已針對 Microsoft Distributed Transaction Coordinator (DTC) 新增了數個新的安全性設定，可讓您自訂管理分散式交易的安全性層級。</span><span class="sxs-lookup"><span data-stu-id="5ceb4-146">Several new security settings have been added for the Microsoft Distributed Transaction Coordinator (DTC), enabling you to customize your security levels for managing distributed transactions.</span></span> <span data-ttu-id="5ceb4-147">請參閱有關這些設定的 DTC 安全性考慮，以及如何執行這些設定。</span><span class="sxs-lookup"><span data-stu-id="5ceb4-147">See DTC Security Considerations about these settings and how to implement them.</span></span>

<span data-ttu-id="5ceb4-148">為了協助進行相互驗證，DTC 會限制為在 NetworkService 帳戶下執行。</span><span class="sxs-lookup"><span data-stu-id="5ceb4-148">To facilitate mutual authentication, the DTC is restricted to running under the NetworkService account.</span></span> <span data-ttu-id="5ceb4-149">如需詳細資訊，請參閱管理帳戶和許可權。</span><span class="sxs-lookup"><span data-stu-id="5ceb4-149">See Managing Accounts and Privileges for detailed information.</span></span>

<span data-ttu-id="5ceb4-150">若要使用 XA 資料庫進行復原，建議您提供執行此復原所需的許可權和角色給 NetworkService 帳戶。</span><span class="sxs-lookup"><span data-stu-id="5ceb4-150">For recovery with XA databases, it is recommended that the NetworkService account be provided the permissions and roles needed to perform this recovery.</span></span> <span data-ttu-id="5ceb4-151">執行這項操作的確切方法是每個資料庫特有的方法。</span><span class="sxs-lookup"><span data-stu-id="5ceb4-151">The exact method of doing this is specific to each database.</span></span> <span data-ttu-id="5ceb4-152">如需詳細資訊，請參閱停用原生分散式交易和停用秘訣和 XA 交易。</span><span class="sxs-lookup"><span data-stu-id="5ceb4-152">See Disabling Native Distributed Transactions and Disabling TIP and XA Transactions for more information.</span></span>

<span data-ttu-id="5ceb4-153">為了在使用 XA 交易時提供更安全的系統，Windows Server 2003 平臺包含新的登錄專案，用來指定 XA DLL 檔案。</span><span class="sxs-lookup"><span data-stu-id="5ceb4-153">To help provide a more secure system when using XA transactions, Windows Server 2003 platforms include a new registry entry for specifying XA DLL files.</span></span> <span data-ttu-id="5ceb4-154">升級至 Windows Server 2003 時，您可以像之前一樣使用 XA 交易，方法是在 [ **HKEY \_ LOCAL \_ MACHINE \\ SOFTWARE \\ Microsoft \\ MSDTC \\ XADLL**] 底下建立登錄專案，其中值名稱是 dll 的名稱 (格式為 *dllname*.dll) ，而值則是 dll 檔案的完整路徑。</span><span class="sxs-lookup"><span data-stu-id="5ceb4-154">When upgrading to Windows Server 2003, you can work with XA transactions as before by creating a registry entry under **HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\MSDTC\\XADLL**, where the value name is the name of the DLL (in the format *dllname*.dll) and the value is the full path of the DLL file.</span></span> <span data-ttu-id="5ceb4-155">您必須為每個使用中的 XA DLL 檔案建立一個專案。</span><span class="sxs-lookup"><span data-stu-id="5ceb4-155">You need to create an entry for each XA DLL file in use.</span></span> <span data-ttu-id="5ceb4-156">如果執行 DTC 的電腦是叢集的一部分，則必須為叢集中的每個節點建立登錄專案。</span><span class="sxs-lookup"><span data-stu-id="5ceb4-156">If the computer running DTC is part of a cluster, the registry entry needs to be made for each node in the cluster.</span></span> <span data-ttu-id="5ceb4-157">如需詳細資訊，請參閱管理 XA 交易。</span><span class="sxs-lookup"><span data-stu-id="5ceb4-157">See Managing XA Transactions for more information.</span></span>

## <a name="low-memory-activation-gates"></a><span data-ttu-id="5ceb4-158">Low-Memory 啟用閘道</span><span class="sxs-lookup"><span data-stu-id="5ceb4-158">Low-Memory Activation Gates</span></span>

<span data-ttu-id="5ceb4-159">在此版本中，COM + 會在建立 COM + 伺服器或物件之前自動檢查記憶體。</span><span class="sxs-lookup"><span data-stu-id="5ceb4-159">With this release, COM+ automatically checks memory before creating a COM+ server or object.</span></span> <span data-ttu-id="5ceb4-160">如果應用程式可用的虛擬記憶體百分比低於固定閾值，則在建立物件之前啟用會失敗。</span><span class="sxs-lookup"><span data-stu-id="5ceb4-160">If the percentage of virtual memory available to the application falls below a fixed threshold, the activation fails before the object is created.</span></span> <span data-ttu-id="5ceb4-161">藉由容錯移轉通常會執行的啟用， [Com + Low-Memory](com--low-memory-activation-gates.md) 啟動閘道服務可大幅提高系統可靠性。</span><span class="sxs-lookup"><span data-stu-id="5ceb4-161">By failing these activations that would normally run, the [COM+ Low-Memory Activation Gates](com--low-memory-activation-gates.md) service greatly enhances system reliability.</span></span>

## <a name="moving-and-copying-com-components"></a><span data-ttu-id="5ceb4-162">移動和複製 COM 元件</span><span class="sxs-lookup"><span data-stu-id="5ceb4-162">Moving and Copying COM Components</span></span>

<span data-ttu-id="5ceb4-163">在此版本中，COM + 允許您移動和複製您的元件。</span><span class="sxs-lookup"><span data-stu-id="5ceb4-163">With this release, COM+ allows you to move and copy your components.</span></span> <span data-ttu-id="5ceb4-164">這表示您可以設定元件的單一實體實作為許多不同的時間。</span><span class="sxs-lookup"><span data-stu-id="5ceb4-164">This means you can configure a single physical implementation of a component many different times.</span></span> <span data-ttu-id="5ceb4-165">您可以在二進位層級（而不是在原始程式碼層級）上重複使用元件，這會產生較少的程式碼、降低開發成本，並加快上市時間。</span><span class="sxs-lookup"><span data-stu-id="5ceb4-165">You get component reuse at a binary level rather than at the source code level, which results in less code, lower development costs, and faster time to market.</span></span> <span data-ttu-id="5ceb4-166">如需詳細資訊，請參閱 [移動元件](moving-components.md) 和 [複製元件](copying-components.md) 。</span><span class="sxs-lookup"><span data-stu-id="5ceb4-166">See [Moving Components](moving-components.md) and [Copying Components](copying-components.md) for detailed information.</span></span>

## <a name="network-access"></a><span data-ttu-id="5ceb4-167">網路存取</span><span class="sxs-lookup"><span data-stu-id="5ceb4-167">Network Access</span></span>

<span data-ttu-id="5ceb4-168">預設會停用 Windows Server 2003 上的 COM + 網路存取，這表示 COM + 預設只能在本機使用。</span><span class="sxs-lookup"><span data-stu-id="5ceb4-168">COM+ network access is disabled by default on Windows Server 2003, meaning that COM+ can be used only locally by default.</span></span> <span data-ttu-id="5ceb4-169">使用下列程式可啟用網路 COM + 存取。</span><span class="sxs-lookup"><span data-stu-id="5ceb4-169">Use the following procedure to enable network COM+ access.</span></span>

<span data-ttu-id="5ceb4-170">**啟用網路 COM + 存取**</span><span class="sxs-lookup"><span data-stu-id="5ceb4-170">**To enable network COM+ access**</span></span>

1.  <span data-ttu-id="5ceb4-171">在 [ **開始** ] 功能表上，指向 [ **主控台**]，然後選取 [ **新增或移除程式**]。</span><span class="sxs-lookup"><span data-stu-id="5ceb4-171">On the **Start** menu, point to **Control Panel**, then select **Add or Remove Programs**.</span></span>

2.  <span data-ttu-id="5ceb4-172">按一下 [ **新增/移除 Windows 元件**]。</span><span class="sxs-lookup"><span data-stu-id="5ceb4-172">Click **Add/Remove Windows Components**.</span></span>

3.  <span data-ttu-id="5ceb4-173">選取 **[應用程式伺服器]** 並按一下 **[詳細資料]**。</span><span class="sxs-lookup"><span data-stu-id="5ceb4-173">Select **Application Server** and click **Details**.</span></span>

4.  <span data-ttu-id="5ceb4-174">核取 [ **啟用網路 COM + 存取**] 旁的核取方塊，然後按一下 **[確定]**。</span><span class="sxs-lookup"><span data-stu-id="5ceb4-174">Check the box next to **Enable network COM+ access**, and then click **OK**.</span></span>

5.  <span data-ttu-id="5ceb4-175">按 **[下一步** ] 完成 [Windows 元件] wizard。</span><span class="sxs-lookup"><span data-stu-id="5ceb4-175">Click **Next** to complete the Windows Components wizard.</span></span>

6.  <span data-ttu-id="5ceb4-176">按一下 **[完成** ] 以關閉嚮導。</span><span class="sxs-lookup"><span data-stu-id="5ceb4-176">Click **Finish** to close the wizard.</span></span>

<span data-ttu-id="5ceb4-177">在 Windows Server 2003 上，DTC 網路交易存取預設為停用。</span><span class="sxs-lookup"><span data-stu-id="5ceb4-177">DTC network transactions access is disabled by default on Windows Server 2003.</span></span> <span data-ttu-id="5ceb4-178">在這些平臺上，DTC 預設只能執行本機交易。</span><span class="sxs-lookup"><span data-stu-id="5ceb4-178">On these platforms, the DTC can perform only local transactions by default.</span></span> <span data-ttu-id="5ceb4-179">使用下列程式來啟用網路 DTC 存取。</span><span class="sxs-lookup"><span data-stu-id="5ceb4-179">Use the following procedure to enable network DTC access.</span></span>

> [!NOTE]
> <span data-ttu-id="5ceb4-180">您也可以使用 [元件服務] 系統管理工具，或透過 COM + 系統管理程式庫以程式設計方式啟用網路 DTC 存取。</span><span class="sxs-lookup"><span data-stu-id="5ceb4-180">You can also enable network DTC access by using the Component Services administrative tool or programmatically through the COM+ Administration Library.</span></span> <span data-ttu-id="5ceb4-181">如需相關的程式資訊，請參閱元件服務管理說明中的「設定 DTC 安全性」。</span><span class="sxs-lookup"><span data-stu-id="5ceb4-181">For procedural information, see "Configuring DTC Security" in the Component Services Administration Help.</span></span>

<span data-ttu-id="5ceb4-182">**啟用網路 DTC 存取**</span><span class="sxs-lookup"><span data-stu-id="5ceb4-182">**To enable network DTC access**</span></span>

1.  <span data-ttu-id="5ceb4-183">在 [ **開始** ] 功能表上，指向 [ **主控台**]，然後選取 [ **新增或移除程式**]。</span><span class="sxs-lookup"><span data-stu-id="5ceb4-183">On the **Start** menu, point to **Control Panel**, then select **Add or Remove Programs**.</span></span>

2.  <span data-ttu-id="5ceb4-184">按一下 [ **新增/移除 Windows 元件**]。</span><span class="sxs-lookup"><span data-stu-id="5ceb4-184">Click **Add/Remove Windows Components**.</span></span>

3.  <span data-ttu-id="5ceb4-185">選取 **[應用程式伺服器]** 並按一下 **[詳細資料]**。</span><span class="sxs-lookup"><span data-stu-id="5ceb4-185">Select **Application Server** and click **Details**.</span></span>

4.  <span data-ttu-id="5ceb4-186">核取 [ **啟用網路 DTC 存取**] 旁的核取方塊，然後按一下 **[確定]**。</span><span class="sxs-lookup"><span data-stu-id="5ceb4-186">Check the box next to **Enable network DTC access**, and then click **OK**.</span></span>

5.  <span data-ttu-id="5ceb4-187">按 **[下一步** ] 完成 [Windows 元件] wizard。</span><span class="sxs-lookup"><span data-stu-id="5ceb4-187">Click **Next** to complete the Windows Components wizard.</span></span>

6.  <span data-ttu-id="5ceb4-188">按一下 **[完成** ] 以關閉嚮導。</span><span class="sxs-lookup"><span data-stu-id="5ceb4-188">Click **Finish** to close the wizard.</span></span>

## <a name="pausing-and-disabling-applications"></a><span data-ttu-id="5ceb4-189">暫停和停用應用程式</span><span class="sxs-lookup"><span data-stu-id="5ceb4-189">Pausing and Disabling Applications</span></span>

<span data-ttu-id="5ceb4-190">COM + 應用程式現在更容易管理。</span><span class="sxs-lookup"><span data-stu-id="5ceb4-190">COM+ applications are now more manageable.</span></span> <span data-ttu-id="5ceb4-191">系統管理員可以暫停和繼續 COM + 伺服器應用程式，或是停用和啟用 COM + 程式庫或伺服器應用程式，甚至是個別設定的元件。</span><span class="sxs-lookup"><span data-stu-id="5ceb4-191">An administrator can pause and resume COM+ server applications or disable and enable COM+ library or server applications, or even individual configured components.</span></span> <span data-ttu-id="5ceb4-192">暫停和停用功能會防止未來的啟用，而不會影響現有的元件實例。</span><span class="sxs-lookup"><span data-stu-id="5ceb4-192">Both the pausing and disabling features prevent future activations without affecting existing component instances.</span></span> <span data-ttu-id="5ceb4-193">如需詳細資訊，請參閱元件服務管理說明中的「管理 COM + 應用程式」。</span><span class="sxs-lookup"><span data-stu-id="5ceb4-193">See "Administering COM+ Applications" in the Component Services Administration Help for more information.</span></span>

## <a name="process-dumping"></a><span data-ttu-id="5ceb4-194">進程傾印</span><span class="sxs-lookup"><span data-stu-id="5ceb4-194">Process Dumping</span></span>

<span data-ttu-id="5ceb4-195">在生產環境中對應用程式進行疑難排解並不容易。</span><span class="sxs-lookup"><span data-stu-id="5ceb4-195">It's not easy troubleshooting applications in a production environment.</span></span> <span data-ttu-id="5ceb4-196">您如何收集問題的相關資訊，而不會干擾執行中的進程？</span><span class="sxs-lookup"><span data-stu-id="5ceb4-196">How do you gather information on a problem without disturbing the running processes?</span></span> <span data-ttu-id="5ceb4-197">COM + 現在透過其新的進程傾印功能提供解決方案。</span><span class="sxs-lookup"><span data-stu-id="5ceb4-197">COM+ now provides a solution through its new process dump feature.</span></span> <span data-ttu-id="5ceb4-198">這項功能可讓系統管理員在不終止進程的情況下，傾印整個進程的狀態。</span><span class="sxs-lookup"><span data-stu-id="5ceb4-198">This feature allows the system administrator to dump the entire state of a process without terminating it.</span></span> <span data-ttu-id="5ceb4-199">如需詳細資訊，請參閱元件服務管理說明中的「管理程式的進程傾印工具以進行偵錯工具的偵錯工具」。</span><span class="sxs-lookup"><span data-stu-id="5ceb4-199">See "Administering the Process Dump Tool for Debugging COM+ Applications" in the Component Services Administration Help for more information.</span></span>

## <a name="process-initialization"></a><span data-ttu-id="5ceb4-200">進程初始化</span><span class="sxs-lookup"><span data-stu-id="5ceb4-200">Process Initialization</span></span>

<span data-ttu-id="5ceb4-201">許多伺服器應用程式在啟動和關閉時，都必須進行特定的初始化和清除作業。</span><span class="sxs-lookup"><span data-stu-id="5ceb4-201">Many server applications need to do specific initialization and cleanup when they are started and shut down.</span></span> <span data-ttu-id="5ceb4-202">在 Windows Server 2003 上執行時，您可以建立可執行 [**IProcessInitializer**](/windows/desktop/api/ComSvcs/nn-comsvcs-iprocessinitializer) 介面的類別。</span><span class="sxs-lookup"><span data-stu-id="5ceb4-202">When running on Windows Server 2003, you can create a class that implements the [**IProcessInitializer**](/windows/desktop/api/ComSvcs/nn-comsvcs-iprocessinitializer) interface.</span></span> <span data-ttu-id="5ceb4-203">當處理常式啟動時，它會呼叫 [**IProcessInitializer：： Startup**](/windows/desktop/api/ComSvcs/nf-comsvcs-iprocessinitializer-startup) ，而當關機時，它會呼叫 [**IProcessInitializer：： Shutdown**](/windows/desktop/api/ComSvcs/nf-comsvcs-iprocessinitializer-shutdown)。</span><span class="sxs-lookup"><span data-stu-id="5ceb4-203">When the process starts up, it calls [**IProcessInitializer::Startup**](/windows/desktop/api/ComSvcs/nf-comsvcs-iprocessinitializer-startup) and when shutting down, it calls [**IProcessInitializer::Shutdown**](/windows/desktop/api/ComSvcs/nf-comsvcs-iprocessinitializer-shutdown).</span></span> <span data-ttu-id="5ceb4-204">這可讓您的元件有機會進行需要的工作，例如初始化連接、檔案和快取。</span><span class="sxs-lookup"><span data-stu-id="5ceb4-204">This gives your component the opportunity to do needed tasks, such as initializing connections, files, and caches.</span></span>

## <a name="running-com-applications-as-nt-services"></a><span data-ttu-id="5ceb4-205">以 NT 服務的形式執行 COM + 應用程式</span><span class="sxs-lookup"><span data-stu-id="5ceb4-205">Running COM+ Applications as NT Services</span></span>

<span data-ttu-id="5ceb4-206">COM + 開發人員現在可以使用 [元件服務] 系統管理工具，將 COM + 伺服器應用程式設定及執行為 NT 服務。</span><span class="sxs-lookup"><span data-stu-id="5ceb4-206">COM+ developers can now use the Component Services administrative tool to configure and implement a COM+ server application as an NT service.</span></span> <span data-ttu-id="5ceb4-207">這表示，如果您的應用程式一律需要執行，則可以自動啟動或重新開機伺服器;如果您的 COM + 應用程式需要執行特殊許可權的作業，您的 COM + 應用程式可以執行為本機系統帳戶;而且您的應用程式相依服務現在可以自動啟動。</span><span class="sxs-lookup"><span data-stu-id="5ceb4-207">This means that the server can be automatically started or restarted if your application always needs to be running; that your COM+ application can run as the local system account if it needs to perform privileged operations; and that your application's dependent services can now be started automatically.</span></span> <span data-ttu-id="5ceb4-208">如需詳細資訊，請參閱 [以服務應用程式形式執行的 Com + 應用程式](com--applications-running-as-service-applications.md) 。</span><span class="sxs-lookup"><span data-stu-id="5ceb4-208">See [COM+ Applications Running as Service Applications](com--applications-running-as-service-applications.md) for detailed information.</span></span>

## <a name="side-by-side-assemblies"></a><span data-ttu-id="5ceb4-209">並存元件</span><span class="sxs-lookup"><span data-stu-id="5ceb4-209">Side-by-Side Assemblies</span></span>

<span data-ttu-id="5ceb4-210">並存 (SxS) 元件可讓應用程式指定要使用哪個版本的系統 DLL 或傳統 COM 元件，例如 MDAC、MFS、MSVCRT.LIB 或 MSXML。</span><span class="sxs-lookup"><span data-stu-id="5ceb4-210">Side-by-side (SxS) assemblies allow applications to specify which version of a system DLL or classic COM component to use, such as MDAC, MFS, MSVCRT, or MSXML.</span></span> <span data-ttu-id="5ceb4-211">例如，如果 ASP 應用程式依賴 MSXML 2.0 版，您可以確保即使在將 service pack 套用到伺服器之後，此應用程式仍會使用 MSXML 2.0 版。</span><span class="sxs-lookup"><span data-stu-id="5ceb4-211">For example, if an ASP application relies on MSXML version 2.0, you can ensure that this application still uses MSXML version 2.0 even after service packs are applied to the server.</span></span> <span data-ttu-id="5ceb4-212">也就是，即使電腦上已安裝 MSXML 的新版本，仍會保留版本2.0，並供您的應用程式使用。</span><span class="sxs-lookup"><span data-stu-id="5ceb4-212">That is, even when a new version of MSXML is installed on the computer, version 2.0 remains and is used by your application.</span></span>

<span data-ttu-id="5ceb4-213">若要設定 SxS 元件，您需要知道 DLL 的路徑，而且每個需要使用 DLL 的虛擬目錄中都有 COM + 資訊清單檔案。</span><span class="sxs-lookup"><span data-stu-id="5ceb4-213">To configure SxS assemblies, you need to know the path to the DLL and that the COM+ manifest file exists in every virtual directory that needs to use the DLL.</span></span> <span data-ttu-id="5ceb4-214">COM + 資訊清單是 XML 檔案，其中包含安裝 DLL 的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="5ceb4-214">The COM+ manifest is an XML file that has information about where a DLL is installed.</span></span> <span data-ttu-id="5ceb4-215">資訊清單是用來建立應用程式的啟用內容。</span><span class="sxs-lookup"><span data-stu-id="5ceb4-215">The manifest is used to create an activation context for the application.</span></span> <span data-ttu-id="5ceb4-216">啟用內容可讓應用程式載入特定 DLL 版本、COM 物件實例或自訂視窗版本。</span><span class="sxs-lookup"><span data-stu-id="5ceb4-216">Activation contexts allow an application to load a particular DLL version, COM object instance, or custom window version.</span></span> <span data-ttu-id="5ceb4-217">您可以使用 [元件服務] 系統管理工具或 ApplicationDirectory 屬性，輸入包含有效 SxS 組件資訊清單檔的應用程式根目錄的完整路徑。</span><span class="sxs-lookup"><span data-stu-id="5ceb4-217">You can use the Component Services administrative tool or ApplicationDirectory property to enter the full path of the application root directory that contains a valid SxS assembly manifest file.</span></span> <span data-ttu-id="5ceb4-218">如需詳細資訊，請參閱 [隔離的應用程式和並存元件](/windows/desktop/SbsCs/isolated-applications-and-side-by-side-assemblies-portal)。</span><span class="sxs-lookup"><span data-stu-id="5ceb4-218">For more information, see [Isolated Applications and Side-by-side Assemblies](/windows/desktop/SbsCs/isolated-applications-and-side-by-side-assemblies-portal).</span></span>

## <a name="windows-error-reporting"></a><span data-ttu-id="5ceb4-219">Windows 錯誤報告</span><span class="sxs-lookup"><span data-stu-id="5ceb4-219">Windows Error Reporting</span></span>

<span data-ttu-id="5ceb4-220">COM + 1.5 包含從 Windows XP 開始提供 Windows 錯誤報告 (WER) 元件的支援。</span><span class="sxs-lookup"><span data-stu-id="5ceb4-220">COM+ 1.5 includes support for the Windows Error Reporting (WER) component, available starting in Windows XP.</span></span> <span data-ttu-id="5ceb4-221">WER 可讓使用者將應用程式錯誤、核心錯誤和無回應的代理程式更新 Microsoft。</span><span class="sxs-lookup"><span data-stu-id="5ceb4-221">WER enables users to notify Microsoft of application faults, kernel faults, and unresponsive applications.</span></span> <span data-ttu-id="5ceb4-222">這些通知可讓 Microsoft 客戶支援小組更有效率地解決技術問題。</span><span class="sxs-lookup"><span data-stu-id="5ceb4-222">These notifications allow the Microsoft customer support teams to solve technical problems more effectively.</span></span> <span data-ttu-id="5ceb4-223">此外，Windows 錯誤報告元件可讓 COM + 開發人員接收可用來改善其應用程式的資訊。</span><span class="sxs-lookup"><span data-stu-id="5ceb4-223">In addition, the Windows Error Reporting component enables COM+ developers to receive information that can be used to improve their applications.</span></span> <span data-ttu-id="5ceb4-224">如需詳細資訊，請參閱 [Windows 錯誤報告](/windows/desktop/wer/windows-error-reporting)。</span><span class="sxs-lookup"><span data-stu-id="5ceb4-224">For more information, see [Windows Error Reporting](/windows/desktop/wer/windows-error-reporting).</span></span>

 

 
