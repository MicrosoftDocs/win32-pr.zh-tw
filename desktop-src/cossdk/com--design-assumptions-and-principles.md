---
description: Microsoft 分散式程式設計模型包含數種技術，包括 MSMQ、IIS、DCOM 和 COM +。 所有這些服務都是針對分散式應用程式所設計。
ms.assetid: c72bbd47-0219-40ba-a7d5-2a6b725972d0
title: COM + 設計假設和原則
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 28b87c5ae631cd5517b215efae3a09968649cd49ea94fe33b33d9b826082e911
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/11/2021
ms.locfileid: "118549393"
---
# <a name="com-design-assumptions-and-principles"></a>COM + 設計假設和原則

Microsoft 分散式程式設計模型包含數種技術，包括 MSMQ、IIS、DCOM 和 COM +。 所有這些服務都是針對分散式應用程式所設計。

COM + 的開發目的是要讓您更輕鬆地建立分散式應用程式。 整體架構是以一組假設和原則為基礎。

## <a name="assumptions"></a>假設

這些假設如下：

-   **COM + 應用程式會跨多個伺服器支援多個使用者。** 換句話說，您要建立分散式應用程式，而這些使用者會在程式碼執行所在的不同主機電腦上。 使用者會透過網際網路或私人網路來存取程式碼。 使用者介面會透過瀏覽器或自訂應用程式呈現，例如以 Microsoft Visual Basic 或 MFC 撰寫的表單架構應用程式。 該使用者介面即將位於用戶端電腦上。
-   **您可以透過將應用程式部署到多部伺服器電腦，將 COM + 應用程式設為可調整，並提供更高的可用性和可靠性。** 如此一來，您就可以在應用程式的工作負載之間取得平衡，並利用 Windows 叢集來提供容錯能力。
-   **如果發生錯誤，當您使用交易時，將會維護從 COM + 應用程式儲存在資料庫中之保存資料的狀態。** 應用程式狀態必須存活可能發生的事故，例如應用程式錯誤、系統損毀或網路失敗。

## <a name="principles"></a>原則

除了這三個假設之外，下列準則還涵蓋 COM + 程式設計模型：

-   **應用程式邏輯將位於伺服器電腦上，而不是在用戶端電腦上。** 有三個主要原因要執行這項操作：
    -   用戶端電腦可能沒有執行應用程式邏輯所需的處理能力或功能。 此外，保留伺服器上的應用程式邏輯可簡化部署。
    -   伺服器電腦通常較接近資料，而這項資料最常用於資料庫。 因為您的應用程式正在存取資料庫，所以您想要對資料庫連接的成本非常敏感。 藉由將大部分的邏輯放在伺服器電腦上，您就可以共用資料庫連接並大幅改善效能。 也可以共用伺服器電腦上的其他資源，也有效能上的好處。
    -   讓應用程式邏輯位於伺服器電腦上，可讓您控制應用程式的安全性內容。 如果您在伺服器電腦上所執行的應用程式元件（而不是在用戶端電腦上）維護該安全性，您可以更充分掌控安全性。
-   **交易是核心。** 根據設計，交易會穿透 COM + 程式設計模型，讓您瞭解它們是非常重要的。 雖然您可以在不使用交易的情況下使用 COM + 的許多服務，但如果您選擇不使用交易，您就無法充分利用您可使用的 COM + 服務。 使用交易的一些重要優點包括下列各項：
    -   交易是並行管理問題的合理解決方案。 此外，交易也有助於防止當機，且具有良好的錯誤復原模式。 此外，交易也會成為跨多個系統管理工作的絕佳方法。
    -   您可以設計以交易為基礎的 COM + 應用程式，以使用 resource manager 和資料庫，以協助保護大部分的狀態資訊。 藉由將狀態保留在資料庫中，或由資源管理員管理的其他儲存體中，您就不需要在應用程式所建立的實際物件內保留很多狀態。 雖然這是來自純粹面向物件模型的離開，但它很適合用來建立具有錯誤復原的分散式應用程式。
-   **應用程式功能是以 COM 物件的形式建立，包裝用來與其他系統或技術通訊的通訊協定。** 因為您可能正在建立將會結合數個技術或舊版系統的元件，所以請規劃使用各種不同的通訊協定。 使用 HTTP 進行用戶端/伺服器通訊，或透過網際網路進行應用程式對應用程式的通訊。 使用 DCOM 在伺服器上進行應用程式對應用程式或元件對元件通訊。

## <a name="related-topics"></a>相關主題

<dl> <dt>

[設計 COM + 應用程式的基本指導方針](basic-guidelines-for-designing-com--applications.md)
</dt> <dt>

[使用 UML 設計 COM + 應用程式](designing-the-com--application-using-uml.md)
</dt> <dt>

[使用 COM + 的一般設計提示](general-design-tips-for-using-com-.md)
</dt> <dt>

[優化與 COM + 商務邏輯層的互動](optimizing-interactions-with-the-com--business-logic-tier.md)
</dt> <dt>

[用來建立分散式應用程式的其他 Microsoft 工具](other-microsoft-tools-for-building-distributed-applications.md)
</dt> </dl>

 

 



