---
description: 交易是資料存放區的一系列修改 (例如資料庫或檔案系統，) 保證全部成功執行，或完全不執行。
ms.assetid: 1567d9d3-7839-42f0-9507-7bbf61d8eaf2
title: 交易式訊息佇列
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b3282a95d4f9a3ba451e78fe4d9f17acf007b0007abea4fdb4951de9c1540383
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/11/2021
ms.locfileid: "119636728"
---
# <a name="transactional-message-queuing"></a>交易式訊息佇列

*交易* 是資料存放區的一系列修改 (例如資料庫或檔案系統，) 保證全部成功執行，或完全不執行。 若要執行交易，記錄會在交易開始之前保留在資料存放區的狀態，而且如果其中一個修改失敗，交易就會傳回失敗，而初始狀態會還原 (或回復) 。 交易是用來維護資料的完整性，因此在商務軟體程式設計中扮演重要的角色。

通常，應用程式可以使用分成數個較小交易或活動的商務交易或工作流程來開發。 這些活動會以時間分隔，然後使用可靠的訊息佇列進行連接。

1.  第一個交易牽涉到訂單輸入資料庫。 [訊息佇列](/previous-versions/windows/desktop/legacy/ms711472(v=vs.85)) 會使用交易功能，將訊息從一個佇列移至另一個佇列，剛好一次移動一次。 如果資料庫已更新，則佇列上會有一則訊息。 如果訊息不會到達佇列，則會中止，而且資料庫會回復。
2.  稍後，訊息佇列會發現伺服器可供使用。 沒有任何應用程式會輪詢伺服器是否存在。 這是第二筆交易。
3.  第三筆交易牽涉到傳送資料庫查詢和傳送資料庫的更新。 如果伺服器在此交易中途失敗，則會復原修改，並將訊息傳回至輸入佇列。 這可確保在交易期間維護資料和資料庫的完整性。

 

 



