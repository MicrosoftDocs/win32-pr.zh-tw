---
description: 針對程式庫應用程式設定以角色為基礎的安全性和驗證時，有一些特殊考慮。
ms.assetid: 1117ac64-653d-4640-97cd-f37b0949dc57
title: 設定程式庫應用程式的安全性
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 8f0d8b3993a00512c20409f1f029b7402d5f9ace97984cbe9757453b5672125f
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/11/2021
ms.locfileid: "118548877"
---
# <a name="configuring-security-for-library-applications"></a>設定程式庫應用程式的安全性

針對程式庫應用程式設定以角色為基礎的安全性和驗證時，有一些特殊考慮。

## <a name="enabling-or-disabling-authentication"></a>啟用或停用驗證

其中一個要考慮的因素是，程式庫應用程式的呼叫端是否應受限於裝載進程的進程層級安全性檢查，也就是是否要啟用或停用驗證。

例如，如果程式庫應用程式將由瀏覽器主控，則可能需要接收未經驗證的回呼。 若要解決此需求，您可以停用驗證，讓裝載進程不會針對程式庫應用程式的呼叫端執行安全性檢查。 當您停用驗證時，程式庫應用程式會有效地未經驗證，而且所有對它的呼叫都會成功。 程式庫應用程式的呼叫端不受限於裝載進程的安全性檢查。 基本上，程式庫應用程式會標記為「未經驗證」，而且會針對程式庫應用程式的呼叫省略安全性檢查。

如需如何啟用或停用驗證的詳細資訊，請參閱 [啟用程式庫應用程式的驗證](enabling-authentication-for-a-library-application.md)。

## <a name="enforcing-role-checks"></a>強制執行角色檢查

另一個要做的決定是程式庫應用程式是否應該使用以 [角色為基礎的安全性](role-based-security-administration.md)。 如果使用以角色為基礎的安全性，您必須使用元件層級安全性，才能執行任何存取檢查。指派給程式庫應用程式的角色不會反映在進程安全描述項中。 程式庫應用程式可以控制的唯一授權是在元件層級。 如需元件層級安全性的詳細資訊，請參閱 [安全性界限](security-boundaries.md)。

若要瞭解如何設定元件層級安全性，請參閱 [設定存取檢查的安全性層級](setting-a-security-level-for-access-checks.md)。

## <a name="configuration-scenarios"></a>設定案例

若要進一步瞭解如何決定程式庫應用程式是否應該使用以角色為基礎的安全性，以及程式庫應用程式是否應該未經驗證，請考慮下列案例：

-   **驗證已啟用，而且會使用以角色為基礎的安全性。** 在此案例中，安全性檢查是由裝載進程進行，而某些呼叫端在進程層級遭到拒絕存取。 此外，也會在程式庫應用層級進行角色檢查，以便在檢查角色成員資格時，讓它透過處理層級安全性檢查的某些呼叫者拒絕存取程式庫應用程式。 這是使用以角色為基礎之安全性的 COM + 程式庫應用程式的一般案例。

    下圖顯示啟用驗證和使用角色檢查的案例。

    ![顯示在主機進程內進行驗證的圖表。](images/18004ed7-e95e-4c66-9e17-f163cdeefd71.png)

-   **驗證已啟用，且未使用以角色為基礎的安全性。** 在此案例中，安全性檢查是在進程層級完成，但不會在程式庫應用層級檢查角色成員資格。 因此，程式庫應用程式的任何呼叫端會透過處理層級的安全性檢查來存取程式庫應用程式，因為不會檢查角色成員資格。 當未使用以角色為基礎的安全性的 COM 應用程式遷移至 COM + 程式庫應用程式時，就會發生這種情況。

    下圖顯示已啟用驗證且未使用角色檢查的案例。

    ![此圖顯示主機進程內程式庫應用程式的進程層級驗證。](images/3e5a64c6-39a9-4ff7-b084-8396fe779210.png)

-   **驗證已停用，並使用以角色為基礎的安全性。** 在此案例中，系統會在進程層級進行安全性檢查，但不會驗證程式庫應用程式的呼叫端。 實際上，程式庫應用程式的呼叫端豁免于進程層級的安全性檢查。 由於已啟用角色檢查，角色成員資格會自行決定誰可以存取程式庫應用程式。 當裝載進程所執行的安全性檢查過於嚴格，但您在程式庫應用程式或特定介面或方法上需要有一些存取限制時，此案例可能很適合。 此案例可讓您有效地關閉進程安全性，並使用以角色為基礎的安全性，仍具有適當的層級存取檢查。

    下圖顯示已停用驗證和角色檢查的案例。

    ![在主機進程內的程式庫應用程式中顯示「檢查角色成員資格」的圖表。](images/e0cc604c-ba86-4087-9a74-1b6fdce8d69a.png)

-   **驗證已停用，且未使用以角色為基礎的安全性。** 在此案例中，安全性檢查仍會在進程層級進行，但在上述案例中，程式庫應用程式的呼叫端一律會通過此安全性檢查。 因為也會停用角色檢查，所以不會在程式庫應用層級檢查角色成員資格。 基本上，任何人都可以呼叫程式庫應用程式。 當您的 COM 物件需要接收未經驗證的回呼時，應選擇此案例，因為 Internet Explorer 和 Microsoft Management Console 嵌入式管理單元所裝載的 ActiveX 控制項可能是這樣的情況。 當然，這個 COM 物件必須受到信任，才能在接收未驗證的呼叫時適當地運作。 例如，它不應該代表其呼叫端存取任意檔案。

    下圖顯示已停用驗證和角色檢查的案例。

    ![顯示在主機進程內未經驗證的程式庫應用程式呼叫的圖表。](images/df3c9a02-52dd-4e07-a5f1-76cef0dab5cb.png)

當您決定要啟用或停用 COM + 程式庫應用程式的驗證之後，請參閱 [啟用程式庫應用程式的驗證](enabling-authentication-for-a-library-application.md) ，以取得說明如何停用 (或使用 [元件服務] 系統管理工具啟用) 驗證的逐步程式。 如果您的程式庫應用程式將會使用以角色為基礎的安全性，請參閱設定 [Role-Based 安全性](configuring-role-based-security.md)。

## <a name="related-topics"></a>相關主題

<dl> <dt>

[程式庫應用程式安全性](library-application-security.md)
</dt> </dl>

 

 



