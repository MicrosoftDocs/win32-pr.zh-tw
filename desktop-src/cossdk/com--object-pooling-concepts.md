---
description: 物件共用是 COM + 所提供的自動服務，可讓您設定元件，使其本身的實例在集區中保持作用中狀態，以供任何要求元件的用戶端使用。
ms.assetid: 74a45220-449a-4d89-a979-a206e5e3d3ad
title: COM + 物件共用概念
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 836dd6f29c2f0bd120843a1a93763d46cb51224966f255251f7e3bfb4c7fa66a
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/11/2021
ms.locfileid: "119129140"
---
# <a name="com-object-pooling-concepts"></a>COM + 物件共用概念

物件共用是 COM + 所提供的自動服務，可讓您設定元件，使其本身的實例在集區中保持作用中狀態，以供任何要求元件的用戶端使用。 您可以針對指定的元件進行系統管理設定和監視集區，並指定集區大小和建立要求超時值等特性。 當應用程式正在執行時，COM + 會為您管理集區，並根據您指定的準則來處理物件啟用和重複使用的詳細資料。

您可以用這種方式重複使用物件，以達到非常顯著的效能和調整優點，特別是當它們被撰寫以充分利用重複使用時。 使用物件共用時，您可以獲得下列優點：

-   您可以加快每個用戶端的物件使用時間，並從物件針對用戶端執行的實際工作中，分解出耗時的初始化和資源取得。
-   您可以分享在所有用戶端上取得昂貴資源的成本。
-   您可以在應用程式啟動時預先設定物件，然後再傳入任何用戶端要求。
-   您可以使用系統管理集區管理來管理資源的使用方式，例如，藉由設定適當的最大集區層級，您可以只開啟與您擁有授權一樣多的資料庫連接。
-   您可以系統管理員設定共用以充分利用可用的硬體資源，您可以在可用的硬體資源變更時輕鬆地調整集區設定。
-   您可以加快使用即時 [ (JIT) 啟用](com--just-in-time-activation.md)之物件的重新開機時間，同時刻意控制如何將資源專用給用戶端。

## <a name="writing-poolable-objects"></a>寫入共用物件

共用物件必須符合特定需求，才能讓多個用戶端使用單一物件實例。 例如，它們無法保存用戶端狀態或具有任何執行緒親和性。 交易對象也有特定需求，因為集區物件所持有的 managed 資源必須手動登錄于交易中。

集區物件可以執行 [**IObjectControl**](/windows/desktop/api/ComSvcs/nn-comsvcs-iobjectcontrol) 來控制如何重複使用它們。 這可讓他們在指定的內容中啟動時，執行初始化，以清除停用的任何用戶端狀態，並指出它們處於無法重複使用的狀態。

通常，以稍微泛用的方式撰寫共用物件，以便系統管理員以函式字串進行自訂，會很有用。 例如，可能會撰寫物件來保存泛型 ODBC 連接，並以系統管理員的方式在函式字串中指定特定的 DSN。

下表所述，本節中的主題提供有關物件共用如何在 COM + 中運作的資訊，以及如何撰寫、設定和執行共用物件的相關資訊。



| 主題                                                                                                 | 描述                                                                                              |
|-------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------|
| [物件共用的運作方式](how-object-pooling-works.md)<br/>                                   | 提供基本概念。<br/>                                                                      |
| [使用物件共用改善效能](improving-performance-with-object-pooling.md)<br/> | 提供有關如何以最有效率的方式使用物件共用的特定詳細資料。<br/>                 |
| [共用物件的需求](requirements-for-poolable-objects.md)<br/>                 | 提供如何撰寫要共用之物件的詳細資料。<br/>                              |
| [共用交易對象](pooling-transactional-objects.md)<br/>                         | 提供適用于共用交易對象之特殊需求的詳細資料。<br/> |
| [控制物件存留期和狀態](controlling-object-lifetime-and-state.md)<br/>         | 描述如何執行集區物件，以控制如何重複使用這些物件。<br/>               |



 

## <a name="related-topics"></a>相關主題

<dl> <dt>

[COM + 物件共用工作](com--object-pooling-tasks.md)
</dt> </dl>

 

 




