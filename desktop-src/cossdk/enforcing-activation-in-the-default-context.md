---
description: 已設定的 COM 元件通常會在其本身的內容中啟用;亦即，COM + 會參考元件類別目錄資訊，以提供任何已設定的服務。
ms.assetid: 09dc7165-22b1-4eca-9591-d83e85556f3f
title: 在預設內容中強制啟用
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 41599f71dc37c37c1a9a574d274ca2858835e2df
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/07/2021
ms.locfileid: "104510752"
---
# <a name="enforcing-activation-in-the-default-context"></a>在預設內容中強制啟用

已設定的 COM 元件通常會在其本身的內容中啟用;亦即，COM + 會參考元件的類別目錄資訊，以提供任何已設定的服務。 不過，您可以選擇在預設內容中啟用已設定的元件。 基底 COM 元件（沒有 COM + 類別目錄資訊的已註冊元件）通常會在預設內容中啟用。

啟用預設內容中的 COM 元件提供三個主要的效能優點，如下所示：

-   您可以藉由限制所建立的內容數目來節省系統資源。
-   您可以藉由限制跨內容呼叫的數目來提高效能。 因為跨內容的呼叫需要封送處理，所以在預設內容中啟動的 COM 物件會更快地對預設內容中的其他物件進行呼叫。 在此情況下， (在相同內容中呼叫的效能，) 類似于呼叫副程式。
-   您可以將較舊的 COM 應用程式匯入至 COM +，並在沒有問題的情況下執行 例如，您可能會有數個舊版的 COM 應用程式，但前提是允許它在一個單元內傳遞物件參考，而不需要封送處理參考。 當匯入至 COM + 時，這些 COM 應用程式無法運作，因為物件參考會跨內容界限傳遞。 但是，如果您使用 [元件服務] 系統管理工具，將應用程式中的所有類別標示為 **必須在預設內容中** 啟動，您可以在匯入時執行這種類型的 COM 應用程式。

在預設內容中啟用已設定元件的主要缺點是，COM + 並未提供任何元件的設定服務。 在增強的效能與使用 COM + 服務的能力之間，會有所取捨。

例如，假設 COM 元件不需要任何 COM + 服務 (例如 [交易](com--transactions.md)、 [即時啟用](com--just-in-time-activation.md)、 [事件](com--events.md)、 [佇列元件](com--queued-components.md)、 [同步](com--synchronization.md)處理或 [物件](com--object-pooling.md) 共用) ，而且元件會對其他可能在預設內容中啟用的 COM 元件進行一些呼叫。 在此情況下，在預設內容中啟動呼叫元件是個不錯的主意。

如果 COM 元件需要 COM + 服務，則無法將它標示為 **必須在預設內容中啟用**。 此外，如果在預設內容中啟動的 COM 物件會對其他內容中的物件進行一些呼叫，則沒有真正的效能提升。  (需詳細資訊，請 [參閱內容](com--contexts.md)。 ) 

**在預設內容中強制啟用**

1.  在 [元件服務] 系統管理工具的詳細資料窗格中，以滑鼠右鍵按一下 [元件] (位於您要在預設內容中啟動之任何選取 COM + 應用程式) 的 [ **元件** ] 資料夾中，然後按一下 [ **屬性**]。

2.  在 [元件屬性] 對話方塊中，按一下 [ **啟用** ] 索引標籤。

3.  選取 [ **必須在預設內容中啟用**] 核取方塊。

4.  按一下 [確定]  。

> [!Note]  
> 當您在預設內容中執行已設定的元件時，COM + 不會針對該元件啟動任何已設定的服務。 當您取消核取 [ **必須在預設內容中啟用**] 核取方塊，然後在其本身的內容中執行設定的元件時，就可以再次使用這些服務。

 

## <a name="related-topics"></a>相關主題

<dl> <dt>

[COM + 即時啟用概念](com--just-in-time-activation-concepts.md)
</dt> <dt>

[在呼叫端的內容中強制啟用](enforcing-activation-in-the-caller-s-context.md)
</dt> </dl>

 

 



