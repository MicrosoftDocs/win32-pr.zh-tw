---
description: COM + 嘗試防止這些錯誤路徑必須在伺服器上執行的情況。
ms.assetid: 0de125a2-2e91-49b9-a903-6c2e173e22a2
title: COM + Low-Memory 啟用管制概念
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 09b4c34e10dcb18a88566d1bc45bb6751e500767c34a2e17cf8cdf12f0f1930c
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/11/2021
ms.locfileid: "119129173"
---
# <a name="com-low-memory-activation-gates-concepts"></a>COM + Low-Memory 啟用管制概念

一般而言，如果您有單一執行緒的單元 (STA) ，就不需要同步處理，因為該單元會為您提供同步處理。 當您有多執行緒單元 (MTA) 和無限制執行緒物件時，同步處理就會變得很重要。 在過去，無限制執行緒物件必須處理鎖定。 您可以藉由設定元件的同步處理屬性，來消除使用鎖定的需求。

當伺服器的資源無法有效率地回應尖峰負載時，通常就會發生可靠性問題。 當伺服器沒有足夠的實體資源可以滿足尖峰需求時，它可能會耗盡虛擬記憶體。 如果使用者的程式碼或系統程式碼未正確處理記憶體配置失敗，就會發生問題。 伺服器開始變慢，而且當記憶體用盡時，記憶體配置會失敗。 伺服器會執行錯誤路徑來處理配置失敗。 如果錯誤路徑包含在伺服器上執行的系統或使用者程式碼中的錯誤，則很難安全地進行陷阱和處理。

COM + 嘗試防止這些錯誤路徑必須在伺服器上執行的情況。 透過低記憶體啟動閘道功能，COM + 會主動監視系統中的記憶體負載，並確保在執行使用者程式碼之前，有合理的可用記憶體數量。 如果應用程式可用的虛擬記憶體百分比低於固定的臨界值，則在建立 COM + 伺服器應用程式或物件之前，啟用會失敗 (，如下圖所示) 。 藉由容錯移轉通常會執行的啟用，低記憶體啟用閘道功能可將使用者程式碼中與記憶體配置相關的問題降至最低，進而大幅提高系統可靠性。

![顯示 COM + 應用程式與低記憶體啟用閘道之間關聯性的圖表。](images/ada5ef02-f2b1-46bb-b0fc-fe7d65f31b43.png)

低記憶體啟用閘道功能只適用于已安裝在 COM + 應用程式中的已設定 COM 元件。

## <a name="how-the-low-memory-activation-gates-feature-works"></a>Low-Memory 啟用閘道功能的運作方式

根據啟用類型而定，低記憶體啟用閘道功能會使用不同的固定閾值層級。 建立 COM + 伺服器應用程式時，如果有10% 以上的虛擬記憶體可用，COM + 允許啟用。 如果有少於10% 的可用，COM + 會進行測試組態，以找出分頁檔是否可以擴充以容納新的記憶體負載。 如果分頁檔案展開，則會建立伺服器應用程式。 如果無法展開分頁檔案，啟用將會失敗，而且不會配置記憶體。

建立物件時，此程式很類似。 在此情況下，如果有超過5% 的可用虛擬記憶體，COM + 允許啟用。 如果有少於5% 的可用，COM + 會繼續進行測試組態。 同樣地，如果測試組態會展開分頁檔案，就會建立物件。 如果不是，啟用就會失敗。

低記憶體啟用閘道的固定閾值層級目前無法設定。 基於這個理由，沒有與這項功能相關聯的工作。

 

 



