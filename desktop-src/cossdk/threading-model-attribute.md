---
description: COM + 會為您管理執行緒。 每個 COM 元件都有一個 >threadingmodel 屬性，您可以在開發元件時指定此屬性。 這個屬性會決定如何將元件物件指派給執行緒，以便執行方法。
ms.assetid: 5fae8475-3d2e-4939-80a7-bc9a677a50b3
title: 執行緒模型屬性
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 91960a753b29ac5f5209a5bafa31c362f3dfe08d
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/07/2021
ms.locfileid: "104385894"
---
# <a name="threading-model-attribute"></a>執行緒模型屬性

COM + 會為您管理執行緒。 每個 COM 元件都有一個 **>threadingmodel** 屬性，您可以在開發元件時指定此屬性。 這個屬性會決定如何將元件的物件指派給執行方法的執行緒。

您可以使用 [元件服務] 系統管理工具，以滑鼠右鍵按一下 [ **元件** ] 資料夾中的元件，按一下 [ **屬性**]，然後按一下 [ **並行** 存取] 索引標籤，以查看執行緒模型屬性。在 **執行緒模型** 下，可能的值如下所示：

-   **主執行緒單元**
-   **單一線程單元**
-   **自由執行緒單元**
-   **中立的單元**
-   **任何單元**

COM + 的慣用執行緒模型是 [中性的單元](neutral-apartments.md)。 但是，如果您未指定元件的執行緒模型，COM + 會使用主執行緒的單元（預設值）。

> [!Note]  
> 如需詳細資訊，請參閱 [選擇執行緒模型](/windows/desktop/com/choosing-the-threading-model)。

 

下表顯示 COM + 中各單元的程式設計模型。



| 型號                     | 公寓                                                 | 免費                               | 兩者                               | 中性                      | 未指定                      |
|---------------------------|-----------------------------------------------------------|------------------------------------|------------------------------------|------------------------------|------------------------------------|
| 單一執行緒，非主要 | 在目前的單元中建立                              | 在多執行緒單元中建立 | 在目前的單元中建立       | 在中立的單元中建立 | 在主執行緒單元中建立 |
| 單一執行緒、主要     | 在目前的單元中建立                              | 在多執行緒單元中建立 | 在目前的單元中建立       | 在中立的單元中建立 | 在目前的單元中建立       |
| 多執行緒             | 在主機單一執行緒單元中建立                 | 在多執行緒單元中建立 | 在多執行緒單元中建立 | 在中立的單元中建立 | 在主執行緒單元中建立 |
| STA 執行緒上的中性 ()    | 在主機單一執行緒的單元中為此執行緒建立 | 在多執行緒單元中建立 | 在中立的單元中建立       | 在中立的單元中建立 | 在主執行緒單元中建立 |
| MTA 執行緒上的中性 ()    | 在主機單一執行緒單元中建立                 | 在多執行緒單元中建立 | 在中立的單元中建立       | 在中立的單元中建立 | 在主執行緒單元中建立 |



 

## <a name="related-topics"></a>相關主題

<dl> <dt>

[**>threadingmodel**](components.md)
</dt> </dl>

 

 
