---
description: 若要從另一個 (用戶端) 電腦遠端存取 COM + 伺服器應用程式，用戶端電腦必須安裝伺服器應用程式的屬性子集，包括 DCOM/QC 介面遠端的 proxy/stub Dll 和型別程式庫。
ms.assetid: 293b424c-4cd4-43a9-9b56-687c753a34f2
title: 部署應用程式 proxy
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 0f5e6439574602005ca53917945fa9005f8959b5
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/07/2021
ms.locfileid: "103936535"
---
# <a name="deploying-application-proxies"></a><span data-ttu-id="7ce0d-103">部署應用程式 proxy</span><span class="sxs-lookup"><span data-stu-id="7ce0d-103">Deploying Application Proxies</span></span>

<span data-ttu-id="7ce0d-104">若要從另一個 (用戶端) 電腦遠端存取 COM + 伺服器應用程式，用戶端電腦必須安裝伺服器應用程式的屬性子集，包括 DCOM/QC 介面遠端的 proxy/stub Dll 和型別程式庫。</span><span class="sxs-lookup"><span data-stu-id="7ce0d-104">To access a COM+ server application remotely from another (client) computer, the client computer must have a subset of the attributes of the server application installed, including proxy/stub DLLs and type libraries for DCOM/QC interface remoting.</span></span> <span data-ttu-id="7ce0d-105">這個子集稱為「 *應用程式 proxy*」。</span><span class="sxs-lookup"><span data-stu-id="7ce0d-105">This subset is called an *application proxy*.</span></span>

<span data-ttu-id="7ce0d-106">您可以透過 [元件服務] 系統管理工具，輕鬆地將 COM + 伺服器應用程式匯出為應用程式 proxy。</span><span class="sxs-lookup"><span data-stu-id="7ce0d-106">Through the Component Services administrative tool, you can easily export a COM+ server application as an application proxy.</span></span> <span data-ttu-id="7ce0d-107">若要讓 COM + 產生應用程式 proxy，必須安裝並不匯入伺服器應用程式中的所有元件。</span><span class="sxs-lookup"><span data-stu-id="7ce0d-107">For COM+ to generate an application proxy, it is important that all components in the server application were installed and not imported.</span></span> <span data-ttu-id="7ce0d-108"> (如需此差異的詳細資訊，請參閱匯 [入元件](importing-components.md)。 ) 這可確保應用程式包含所有必要的註冊資訊。</span><span class="sxs-lookup"><span data-stu-id="7ce0d-108">(For more information on this distinction, see [Importing Components](importing-components.md).) This ensures that the application includes all the necessary registration information.</span></span>

> [!Note]  
> <span data-ttu-id="7ce0d-109">建議您將介面定義與類別的執行區隔開。</span><span class="sxs-lookup"><span data-stu-id="7ce0d-109">It is recommended that you separate the interface definitions from the class implementations.</span></span> <span data-ttu-id="7ce0d-110">否則，COM + 應用程式 proxy 中包含的一組 Dll 或類型程式庫將會包含實際的伺服器程式碼。</span><span class="sxs-lookup"><span data-stu-id="7ce0d-110">Otherwise, the set of DLLs or type libraries included in the COM+ application proxy will include actual server code.</span></span>

 

<span data-ttu-id="7ce0d-111">COM + 產生的應用程式 proxy 是 Windows Installer 安裝套件。</span><span class="sxs-lookup"><span data-stu-id="7ce0d-111">Application proxies generated by COM+ are Windows Installer installation packages.</span></span> <span data-ttu-id="7ce0d-112">安裝之後，應用程式 proxy 會顯示在用戶端電腦的 [新增/移除程式] 控制台 (除非使用 Windows Installer authoring tool) 修改 .msi 檔案。</span><span class="sxs-lookup"><span data-stu-id="7ce0d-112">After installation, the application proxies appear in the client computer's Add/Remove Programs control panel (unless the .msi file is modified using a Windows Installer authoring tool).</span></span>

## <a name="remote-access-via-application-proxies"></a><span data-ttu-id="7ce0d-113">透過應用程式 proxy 進行遠端存取</span><span class="sxs-lookup"><span data-stu-id="7ce0d-113">Remote Access via Application Proxies</span></span>

<span data-ttu-id="7ce0d-114">產生應用程式 proxy 時，COM + 會自動提供下列資訊，讓應用程式 proxy 從遠端存取 COM + 伺服器應用程式時需要這些資訊：</span><span class="sxs-lookup"><span data-stu-id="7ce0d-114">When generating an application proxy, COM+ automatically provides the following information, required for the application proxy to remotely access a COM+ server application:</span></span>

-   <span data-ttu-id="7ce0d-115">類別身分識別資訊 (Clsid 和 Progid) 。</span><span class="sxs-lookup"><span data-stu-id="7ce0d-115">Class identity information (CLSIDs and ProgIDs).</span></span> <span data-ttu-id="7ce0d-116">應用程式 proxy 支援最多兩個 Progid。</span><span class="sxs-lookup"><span data-stu-id="7ce0d-116">An application proxy supports up to two ProgIDs.</span></span>
-   <span data-ttu-id="7ce0d-117">應用程式識別，以及類別與應用程式 (AppID) 的關聯性。</span><span class="sxs-lookup"><span data-stu-id="7ce0d-117">Application identity and relation of classes to applications (AppID).</span></span>
-   <span data-ttu-id="7ce0d-118">每個應用程式的位置資訊 (遠端伺服器名稱) 。</span><span class="sxs-lookup"><span data-stu-id="7ce0d-118">Location information per application (Remote Server Name).</span></span>
-   <span data-ttu-id="7ce0d-119">封送處理應用程式公開的所有介面的資訊 (例如，輸入程式庫和 proxy/存根) 。</span><span class="sxs-lookup"><span data-stu-id="7ce0d-119">Marshaling information for all the interfaces exposed by the application (for example, type libraries and proxy/stubs).</span></span>
-   <span data-ttu-id="7ce0d-120">MSMQ 佇列名稱和識別碼 (是否已針對應用程式) 啟用佇列元件服務。</span><span class="sxs-lookup"><span data-stu-id="7ce0d-120">MSMQ queue names and identifiers (if the queued components service is enabled for the application).</span></span>
-   <span data-ttu-id="7ce0d-121">類別、介面和方法屬性，不包括角色資訊。</span><span class="sxs-lookup"><span data-stu-id="7ce0d-121">Class, interface, and method attributes, excluding role information.</span></span>
-   <span data-ttu-id="7ce0d-122">應用程式屬性。</span><span class="sxs-lookup"><span data-stu-id="7ce0d-122">Application attributes.</span></span>

## <a name="installing-application-proxies-on-other-operating-systems"></a><span data-ttu-id="7ce0d-123">在其他作業系統上安裝應用程式 proxy</span><span class="sxs-lookup"><span data-stu-id="7ce0d-123">Installing Application Proxies on Other Operating Systems</span></span>

<span data-ttu-id="7ce0d-124">與 COM + 伺服器應用程式不同的是，應用程式 proxy 可以安裝在任何支援 DCOM (和 Windows Installer) 的作業系統上。</span><span class="sxs-lookup"><span data-stu-id="7ce0d-124">Unlike COM+ server applications, application proxies can be installed on any operating system that supports DCOM (and Windows Installer).</span></span> <span data-ttu-id="7ce0d-125">在未執行 COM + 的電腦上，只會安裝 DCOM 遠端處理所需的資訊子集。</span><span class="sxs-lookup"><span data-stu-id="7ce0d-125">On computers that aren't running COM+, only the subset of information required for DCOM remoting is installed.</span></span> <span data-ttu-id="7ce0d-126">這項資訊會安裝到 Windows 登錄 (使用 HKEY \_ 類別 \_ ROOT、APPID/CLSID 機碼) 。</span><span class="sxs-lookup"><span data-stu-id="7ce0d-126">This information is installed into the Windows registry (using the HKEY\_CLASSES\_ROOT, APPID/CLSID keys).</span></span>

> [!Note]  
> <span data-ttu-id="7ce0d-127">在未執行 COM + 的電腦上安裝應用程式 proxy ( .msi 檔案) ，必須在這些電腦上執行 Windows Installer。</span><span class="sxs-lookup"><span data-stu-id="7ce0d-127">When installing an application proxy (.msi file) on computers that aren't running COM+, it is necessary to have Windows Installer running on those computers.</span></span> <span data-ttu-id="7ce0d-128">建議開發人員提供 Windows Installer 可轉散發檔案 (instmsi.exe) 以及其應用程式的 .msi 檔案。</span><span class="sxs-lookup"><span data-stu-id="7ce0d-128">It is recommended that developers ship the Windows Installer redistributable file (instmsi.exe) along with their application's .msi file.</span></span> <span data-ttu-id="7ce0d-129">這可確保系統管理員在未執行 COM + 的用戶端上部署應用程式 proxy 時，有 Windows Installer 可供使用。</span><span class="sxs-lookup"><span data-stu-id="7ce0d-129">This will ensure that system administrators have Windows Installer available when deploying application proxies on clients that are not running COM+.</span></span>

 

<span data-ttu-id="7ce0d-130">在執行 COM + 的電腦上，應用程式 proxy 資訊會安裝在 COM + 目錄中，而且會顯示在 [元件服務] 系統管理工具中。</span><span class="sxs-lookup"><span data-stu-id="7ce0d-130">On computers running COM+, the application proxy information is installed into the COM+ catalog and is visible in the Component Services administrative tool.</span></span>

## <a name="related-topics"></a><span data-ttu-id="7ce0d-131">相關主題</span><span class="sxs-lookup"><span data-stu-id="7ce0d-131">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="7ce0d-132">建立 COM + 應用程式的安裝套件</span><span class="sxs-lookup"><span data-stu-id="7ce0d-132">Creating Installation Packages for COM+ Applications</span></span>](creating-installation-packages-for-com--applications.md)
</dt> <dt>

[<span data-ttu-id="7ce0d-133">COM + 類別目錄</span><span class="sxs-lookup"><span data-stu-id="7ce0d-133">The COM+ Catalog</span></span>](the-com--catalog.md)
</dt> <dt>

[<span data-ttu-id="7ce0d-134">COMREPL 複製公用程式</span><span class="sxs-lookup"><span data-stu-id="7ce0d-134">The COMREPL Replication Utility</span></span>](the-comrepl-replication-utility.md)
</dt> </dl>

 

 



