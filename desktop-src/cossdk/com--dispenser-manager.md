---
description: 分配器管理員會提供資源機的資源集區，並確保資源配置器所提供的資源已正確地登記在應用程式物件交易中。
ms.assetid: c8986943-56a1-4668-9e80-7ab2a42333a8
title: COM + 分配管理員
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: ec090ba8c6324363c80a00685e4bc9cfa11185fa1b95ad5db3575608c9fe60ee
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/11/2021
ms.locfileid: "119991688"
---
# <a name="com-dispenser-manager"></a>COM + 分配管理員

分配器管理員會提供資源機的資源集區，並確保資源配置器所提供的資源已正確地登記在應用程式物件的交易中。 分配器管理員會自動回收在物件存留期結束時仍保留的資源，以避免資源「流失」的可能性。 分配者管理員可以要求資源配置者建立新的資源，或在需要調整清查層級時終結閒置資源，而不是使用靜態設定。

> [!Note]  
> 由於公開給應用程式的資源配置器介面不需要是 COM 介面，因此可以在進程中使用分配者管理員，而不需要初始化 COM，例如，以支援 ODBC 資源配置器。

 

建立資源時，資源配置器可能會指定閒置資源在損毀之前，要保留在集區中的時間長度。 在分配器管理員中執行的執行緒一律會尋找這些閒置資源。

## <a name="the-inventory-statistics-manager"></a>清查統計資料管理員

分配器管理員會使用 *清查統計資料管理員* 來管理集區資源清查層級。 清查統計資料管理員會維護每個資源使用時間的記錄，並在未使用 *x* 秒時移除清查中的資源，其中會在建立資源時為每個資源設定 *x* 的值。

## <a name="the-holder-component"></a>持有者元件

分配器管理員會輪詢每個 *持有者*，這是一個由分配管理程式所建立的元件，每隔10秒就會列出每個資源配置器的資源清查，讓它能夠重新調整其資源清查。 每個持有者都會呼叫清查統計資料管理員，以建議每種資源類型的清查層級。 如此一來，持有者可能會要求資源配置器建立或損毀某些清查。

持有者和資源配置器會與特定類型的要求資源進行通訊。 持有者與資源配置器之間存在下列關聯性：

-   持有者可以從資源配置器要求資源。 資源配置器會傳回可用的資源，或建立一個新資源。
-   持有者可以通知資源配置器，應用程式不再需要資源，然後將它傳回資源集區。
-   持有者和資源配置器會一起運作，以維護資源集區的大小。

## <a name="related-topics"></a>相關主題

<dl> <dt>

[COM + 資源配置器概念](com--resource-dispenser-concepts.md)
</dt> </dl>

 

 



