---
description: COM + 佇列的元件服務藉由提供環境，讓您可以同步的方式叫用元件 (即時) 或非同步 (排入佇列) ，藉以增強 COM 程式設計模型。
ms.assetid: fd455679-b2b3-487f-8494-9ea296ce2c89
title: 已排入佇列的元件架構
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: a8a2f6e1012bd3c11a27a44214ee28e84d5bd404
ms.sourcegitcommit: bf526e267d3991892733bdd229c66d5365cf244a
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 02/05/2021
ms.locfileid: "104552484"
---
# <a name="queued-components-architecture"></a>已排入佇列的元件架構

COM + 佇列的元件服務藉由提供環境，讓您可以同步的方式叫用元件 (即時) 或非同步 (排入佇列) ，藉以增強 COM 程式設計模型。 元件不需要知道它是在即時或已排入佇列的內容中採用。

訊息應用程式就像程式之間的電子郵件交易。 要求者將訊息傳送至伺服器;當伺服器收到訊息時，就會處理訊息。 就像電子郵件一樣，訊息系統必須處理網路詳細資料，並確保訊息從用戶端移至伺服器。 在佇列的元件架構中，訊息佇列會負責這項工作。

COM + 佇列元件服務是由下列部分所組成：

-   用戶端或傳送端) 的錄製器 (
-   伺服器或接收端的接聽程式 () 
-   伺服器或接收端的播放程式 () 

![此圖顯示從用戶端到伺服器的路徑：用戶端、錄製器、佇列、接聽程式、播放程式、伺服器。](images/d732774b-1ca6-45ad-bce0-a95b0bfc3edb.png)

## <a name="the-recorder"></a>錄製器

在典型的佇列元件案例中，用戶端會呼叫已排入佇列的元件。 對已排入佇列的元件錄製器進行呼叫，這會將它封裝成訊息的一部分，並將其放在佇列中。 錄製器會將用戶端的安全性內容封送處理到訊息中，並記錄用戶端的所有方法呼叫。 在其作為伺服器元件之 proxy 的角色中，錄製器會從 COM + 目錄中的 queuable 介面選取介面。

錄製的表示會以訊息的形式傳送至訊息佇列，以傳送至伺服器。 當已排入佇列的元件具有 [必要] 或 [受支援] 的交易屬性設定時，只有當用戶端交易認可，且 [訊息佇列] 佇列是交易式時（這是正常建立的預設值），訊息佇列才會接受訊息的傳遞。 當 [交易屬性] 設定為 [需要新的] 時，即使用戶端交易中止，訊息佇列仍可以接受訊息。 如需交易的詳細資訊，請參閱交易式 [訊息佇列](transactional-message-queuing.md)。

## <a name="the-listener"></a>接聽程式

已排入佇列的元件接聽程式會從佇列中取出訊息，並將它傳遞給佇列元件播放機。

## <a name="the-player"></a>播放機

播放程式會在伺服器端拆收用戶端的安全性內容，然後再叫用伺服器元件，並進行相同的方法呼叫。 除非用戶端元件完成，而且記錄方法的交易呼叫認可，否則播放程式不會播放方法呼叫。

## <a name="the-message-mover"></a>訊息移動器

排入佇列的元件訊息移動器是一種公用程式，可將所有失敗的訊息佇列訊息從一個佇列移至另一個佇列，以便重試。 訊息移動器公用程式是可使用 VBScript 叫用的自動化物件;如需詳細資訊，請參閱 [處理錯誤](handling-errors-in-queued-components.md)。

 

 



