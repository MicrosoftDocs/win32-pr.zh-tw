---
title: " (設計基礎) 的錯誤訊息"
description: 錯誤訊息會警示使用者已發生的問題。
ms.assetid: b02110e9-985d-4448-9c95-eb958b0059b1
ms.topic: article
ms.date: 10/20/2020
ms.openlocfilehash: 50e9d945baf736329d38334a94ede6158621167c
ms.sourcegitcommit: 4665ebce0c106bdb52eef36e544280b496b6f50b
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/26/2021
ms.locfileid: "122984101"
---
# <a name="error-messages-design-basics"></a> (設計基礎) 的錯誤訊息

> [!NOTE]
> 此設計指南是針對 Windows 7 所建立，而且尚未針對較新的 Windows 版本進行更新。 大部分的指引仍然適用于準則，但展示和範例不會反映我們目前的 [設計指引](/windows/uwp/design/)。

錯誤訊息會警示使用者已發生的問題。 相反地，警告訊息會警示使用者可能會在未來發生問題的狀況。 您可以使用強制回應對話方塊、就地訊息、通知或氣球來顯示錯誤訊息。

![錯誤訊息的螢幕擷取畫面：無法重新命名](images/mess-error-image1.png)

一般的強制回應錯誤訊息。

有效的錯誤訊息會通知使用者發生問題、解釋發生問題的原因，並提供解決方案，讓使用者可以修正問題。 使用者應執行動作，或將其行為變更為錯誤訊息的結果。

妥善撰寫、實用的錯誤訊息對品質的使用者體驗很重要。 撰寫不當的錯誤訊息會導致產品滿意度偏低，而且是肇因技術支援成本的首要原因。 不必要的錯誤訊息會中斷使用者的流程。

**注意：** 與 [對話方塊](win-dialog-box.md)、 [警告訊息](mess-warn.md)、 [確認](mess-confirm.md)、 [標準圖示](vis-std-icons.md)、 [通知](mess-notif.md)和 [版面](vis-layout.md) 配置相關的指導方針會顯示在不同的文章中。

## <a name="is-this-the-right-user-interface"></a>這是正確的使用者介面嗎？

若要決定使用時機，請考量下列問題：

- **使用者介面 (UI) 呈現已發生的問題嗎？** 如果沒有，則訊息不會是錯誤。 如果使用者警示的情況可能會在未來發生問題，請使用警告訊息。
- **可以防止問題而不會造成混淆嗎？** 若是如此，請改為避免問題。 例如，使用受限制為有效值的控制項，而不是使用可能需要錯誤訊息的不受限制控制項。 此外，當您按一下時，停用控制項會導致錯誤，只要它很明顯地停用控制項的原因。
- **問題可以自動校正嗎？** 如果是的話，請處理問題並隱藏錯誤訊息。
- **使用者是否有可能執行動作，或將其行為變更為訊息的結果？** 如果沒有，則條件不會讓使用者中斷，因此最好是抑制錯誤。
- **當使用者主動使用其他程式時，是否有相關問題？** 如果是的話，請考慮使用 [通知區域圖標](winenv-notification.md)來顯示問題。
- **問題與目前的使用者活動不相關，不需要立即的使用者動作，而且使用者可以自由地忽略它嗎？** 若是如此，請改用 [動作失敗通知](mess-notif.md) 。
- **問題是否與主視窗內的背景工作狀態有關？** 如果是的話，請考慮使用 [狀態列](ctrl-status-bars.md)來顯示問題。
- **主要目標使用者是 IT 專業人員嗎？** 若是如此，請考慮使用替代的意見反應機制，例如 [記錄](glossary.md) 檔專案或電子郵件警示。 IT 專業人員強烈偏好記錄檔，以取得非重要的資訊。

## <a name="design-concepts"></a>設計概念

**不良錯誤訊息的特性**

如果有許多討厭、無用和寫入錯誤的錯誤訊息，就不會驚訝。 而且，由於錯誤訊息通常會使用強制回應對話方塊來呈現，因此它們會中斷使用者目前的活動，並在允許使用者繼續之前先確認要求。

問題的部分在於有很多方法可以進行錯誤。 請考慮下列太可惜的錯誤訊息廳範例：

**不必要的錯誤訊息**

**不正確：**

![錯誤訊息的螢幕擷取畫面：應用程式失敗 ](images/mess-error-image2.png)

Windows XP 的這個範例可能是最糟的錯誤訊息。 這表示程式無法啟動，因為 Windows 本身正在關機的進程中。 使用者無法執行這項操作，甚至想要 (使用者選擇在所有) 之後，關閉 Windows。 藉由顯示此錯誤訊息，Windows 可防止自己關機！

**問題：** 錯誤訊息本身就是問題所在。 除了關閉錯誤訊息之外，使用者也不需要執行任何動作。

**領先的原因：** 報告所有的錯誤案例，不論使用者的目標或觀點。

**建議的替代方案：** 請勿報告使用者不在意的錯誤。

**「成功」錯誤訊息**

**不正確：**

![錯誤訊息的螢幕擷取畫面：移除失敗 ](images/mess-error-image3.png)

此錯誤訊息是由使用者選擇不在程式移除之後立即重新開機 Windows 所造成。 從使用者的觀點來看，移除程式成功。

**問題：** 從使用者的觀點來看，並不會發生任何錯誤。 除了關閉錯誤訊息之外，使用者也不需要執行任何動作。

**領先的原因：** 從使用者的觀點來看，工作已順利完成，但無法從卸載程式的觀點來看。

**建議的替代方案：** 請勿報告使用者認為可接受的條件錯誤。

**完全無用的錯誤訊息**

**不正確：**

![錯誤訊息的螢幕擷取畫面：未知的錯誤 ](images/mess-error-image4.png)

使用者瞭解有錯誤，但不知道錯誤是什麼，或是該怎麼做。 沒關係，沒問題！

**問題：** 錯誤訊息不會提供特定的問題，使用者也不能執行任何動作。

**領先的原因：** 最可能的情況是，程式的錯誤處理不佳。

**建議的替代方案：** 設計正確的錯誤處理常式。

**費解錯誤訊息**

**不正確：**

![錯誤訊息的螢幕擷取畫面：備份未完成 ](images/mess-error-image5.png)

在此範例中，問題陳述很清楚，但補充說明全然 baffling。

**問題：** 問題陳述或解決方案費解。

**領先的原因：** 從程式碼的觀點來解釋問題，而不是從使用者的觀點來說明。

**建議的替代方案：** 撰寫您的目標使用者可以輕鬆瞭解的錯誤訊息正文。 提供使用者可實際執行的解決方案。 設計程式的錯誤訊息體驗沒有程式設計人員在該位置撰寫錯誤訊息。

**Overcommunicate 的錯誤訊息**

**不正確：**

![極詳細訊息的螢幕擷取畫面 ](images/mess-error-image6.png)

在此範例中，錯誤訊息顯然會嘗試說明每個疑難排解步驟。

**問題：** 太多資訊。

**領先的原因：** 提供太多詳細資料，或嘗試在錯誤訊息中說明複雜的疑難排解程式。

**建議的替代方案：** 避免不必要的詳細資料。 此外，請避免疑難排解員。 如果您需要疑難排解員，請將焦點放在最有可能的解決方案，並藉由連結至 [說明] 中的適當主題來說明其餘部分。

**不必要的錯誤訊息**

**不正確：**

![訊息的螢幕擷取畫面：找不到物件 ](images/mess-error-image7.png)

程式找不到物件幾乎聽起來很嚴重。 並假設它是災難性的，為什麼會有回應？

**問題：** 程式的語氣不必要，也不太明顯。

**領先的原因：** 問題的原因是從程式的觀點來看，出現了嚴重的錯誤。

**建議的替代方案：** 根據使用者的觀點，仔細選擇語言。

**使用者的錯誤訊息**

**不正確：**

![訊息的螢幕擷取畫面：不合法的字元 ](images/mess-error-image8.png)

為何讓使用者感覺像是犯罪？

**問題：** 錯誤訊息會以 accuses 使用者提出錯誤的方式片語。

**領先的原因：** 著重于使用者行為而非問題的不區分片語。

**建議的替代方案：** 將焦點放在問題上，而不是因需要而導致問題的使用者動作。

**更愚蠢的錯誤訊息**

**不正確：**

![訊息的螢幕擷取畫面：錯誤報表中的錯誤 ](images/mess-error-image9.png)

在此範例中，問題陳述很諷刺，而且不提供任何解決方案。

**問題：** 更愚蠢或非 sequitors 的錯誤訊息語句。

**領先的原因：** 建立錯誤訊息，而不需要注意其內容。

**建議的替代方案：** 由寫入器製作和審核您的錯誤訊息。 查看錯誤時，請考慮內容和使用者的想法狀態。

**程式設計人員錯誤訊息**

**不正確：**

![訊息的螢幕擷取畫面：存取違規位址 ](images/mess-error-image10.png)

在此範例中，錯誤訊息指出程式中有錯誤。 此錯誤訊息只有程式設計師才有意義。

**問題：** 旨在協助程式開發人員尋找 bug 的訊息會保留在程式的發行版本中。 這些錯誤訊息沒有使用者的意義或值。

**領先的原因：** 使用一般 UI 的程式設計人員將訊息傳送給自己。

**建議的替代方案：** 開發人員必須有條件地編譯所有這類訊息，使其自動從產品的發行版本中移除。 請勿浪費時間來嘗試對使用者發出像是這理解的錯誤，因為他們唯一的物件是程式設計人員。

**呈現不良的錯誤訊息**

**不正確：**

![訊息的螢幕擷取畫面：非預期的失敗 ](images/mess-error-image11.png)

這個範例有許多常見的呈現錯誤。

**問題：** 取得錯誤訊息簡報中錯誤的所有詳細資料。

**領先的原因：** 不知道並套用錯誤訊息指導方針。 請勿使用寫入器和編輯器來建立和檢查錯誤訊息。

錯誤處理的本質是很容易就能進行這些錯誤。 要注意的是，大部分的錯誤訊息都可以針對太可惜的廳被提名人。

**良好錯誤訊息的特性**

相對於先前的錯誤範例，良好的錯誤訊息有：

- **問題。** 指出發生問題。
- **原因。** 說明發生問題的原因。
- **方案。** 提供解決方案，讓使用者可以修正問題。

此外，良好的錯誤訊息會以下列方式呈現：

- **相關。** 這則訊息會顯示使用者在意的問題。
- **可行。** 使用者應執行動作，或將其行為變更為訊息的結果。
- **以使用者為中心。** 此訊息會根據目標使用者動作或目標來描述問題，而不是程式碼不滿意的情況。
- **簡短。** 訊息越短越好，但也不會縮短。
- **清楚。** 此訊息使用一般語言，讓目標使用者可以輕鬆地瞭解問題和解決方案。
- **特定。** 此訊息會使用特定語言來描述問題，並提供相關物件的特定名稱、位置和值。
- **禮貌。** 使用者不應該應該過度或感到愚蠢。
- **罕見。** 不常顯示。 經常顯示的錯誤訊息是不良設計的徵兆。

藉由設計您的錯誤處理經驗來取得這些特性，您就可以將程式的錯誤訊息從太可惜的錯誤訊息大廳中排除。

**避免不必要的錯誤訊息**

通常，最佳的錯誤訊息不會有錯誤訊息。 您可以透過更好的設計來避免許多錯誤，而且通常會有更好的錯誤訊息替代方案。 通常最好避免發生錯誤，而不是報告一個錯誤。

要避免的最明顯錯誤訊息是無法操作的錯誤訊息。 如果使用者可能會在未進行任何變更的情況下關閉訊息，請省略錯誤訊息。

某些錯誤訊息可能會被排除，因為它們不會造成使用者的觀點。 例如，假設使用者嘗試刪除已經在刪除中的檔案。 從程式碼的觀點來看，這可能是未預期的情況，因此使用者不會將其視為錯誤，因為他們想要的結果。

**不正確：**

![message：無法刪除檔案的螢幕擷取畫面 ](images/mess-error-image12.png)

此錯誤訊息應該會被排除，因為動作是從使用者的觀點來看成功。

另一個範例是，假設使用者明確地取消工作。 針對使用者的觀點，下列條件不是錯誤。

**不正確：**

![訊息的螢幕擷取畫面：無法完成備份 ](images/mess-error-image13.png)

此錯誤訊息也應消除，因為動作是從使用者的觀點來看成功。

有時您可以藉由專注于使用者的目標而非技術來消除錯誤訊息。 在這麼做時，請重新考慮什麼是錯誤。 使用者的目標是否有問題，或您的程式滿足這些問題的能力？ 如果使用者的動作在真實世界中有意義，也應該對軟體有意義。

例如，假設在電子商務程式中，使用者嘗試使用搜尋來尋找產品，但常值搜尋查詢沒有相符專案，而且所需的產品不存在。 技術上來說，這是一項錯誤，但是不會提供錯誤訊息，程式可以：

- 繼續搜尋最符合查詢的產品。
- 如果搜尋有明顯的錯誤，則會自動建議已更正的查詢。
- 自動處理常見的問題，例如拼錯、替代拼寫，以及不相符的複數表示和動詞案例。
- 指出產品的存貨。

只要使用者的要求合理，設計完善的電子商務程式應該會傳回合理的結果，而不會發生錯誤。

避免錯誤訊息的另一種好方法是先防止發生問題。 您可以透過下列方式防止錯誤：

- **使用受限制的控制項。** 使用受限制為有效值的控制項。 清單、滑杆、核取方塊、選項按鈕和日期和時間選擇器等控制項都限制為有效值，而文字方塊通常不是，而且可能需要錯誤訊息。 不過，您可以限制文字方塊僅接受特定字元，並接受最大字元數。
- **使用受限制的互動。** 若為拖曳作業，則只允許使用者在有效的目標上放置。
- **使用停用的控制項和功能表項目。** 當使用者可以輕鬆推算控制項或功能表項目停用的原因時，請停用控制項和功能表項目。
- **提供良好的預設值。** 如果使用者可以接受預設值，就不太可能產生輸入錯誤。 即使使用者決定變更值，預設值仍能讓使用者知道預期的輸入格式。
- **讓事情正常運作。** 如果不必要或自動執行工作，使用者就比較不可能發生錯誤。 或者，如果使用者犯了很小的錯誤，但其意圖很清楚，則會自動修正此問題。 例如，您可以自動校正次要格式問題。

**提供必要的錯誤訊息**

有時候您真的需要提供錯誤訊息。 使用者犯了錯誤、網路和裝置停止運作、找不到物件或修改物件、無法完成工作，以及程式有錯誤。 在理想情況下，這些問題會較不常發生，例如，我們可以設計我們的軟體來防止許多類型的使用者錯誤，但這並不是實際的問題。 當這些問題發生時，有一個實用的錯誤訊息就能快速回到他們的腳。

常見的想法是，錯誤訊息是最糟的使用者體驗，而且應該盡可能避免，但是更精確的說，就是使用者混淆是最糟的體驗，因此應該盡可能避免所有成本。 有時候成本會是很有用的錯誤訊息。

請考慮停用的控制項。 大部分的情況下，控制項停用的原因很明顯，因此停用控制項是避免錯誤訊息的絕佳方法。 但是，如果停用控制項的原因不明顯，該怎麼辦？ 使用者無法繼續，而且沒有任何意見反應可判斷問題。 現在使用者停滯，必須推算問題或獲得技術支援。 在這種情況下，最好是讓控制項保持啟用狀態，並改為提供實用的錯誤訊息。

**不正確：**

![訊息的螢幕擷取畫面：儲存備份的位置？ ](images/mess-error-image14.png)

為什麼在這裡停用 [下一步] 按鈕？ 最好讓它保持啟用狀態，並提供實用的錯誤訊息，以避免使用者混淆。

如果您不確定是否應該提供錯誤訊息，請從撰寫您可能提供的錯誤訊息開始。 如果使用者可能會執行動作或變更其行為，請提供錯誤訊息。 相反地，如果使用者可能會在未進行任何變更的情況下關閉訊息，請省略錯誤訊息。

**設計正確的錯誤處理**

雖然製作良好的錯誤訊息正文可能是一項挑戰，但有時候程式可能不會有良好的錯誤處理支援。 請考慮下列錯誤訊息：

**不正確：**

![訊息的螢幕擷取畫面：未知的錯誤 ](images/mess-error-image15.png)

問題其實是未知的，因為缺少程式的錯誤處理支援。

雖然這是很不好的寫入錯誤訊息，但更可能的原因是，基礎程式碼沒有已知的良好錯誤處理，因此沒有已知問題的特定資訊。

為了建立特定、可操作、以使用者為中心的錯誤訊息，程式的錯誤處理常式代碼必須提供特定的高階錯誤資訊：

- 每個問題都應指派唯一的錯誤碼。
- 如果問題有幾個原因，程式應該盡可能判斷特定的原因。
- 如果問題有參數，則必須維持參數。
- 低層級的問題必須以夠高的層級處理，以便從使用者的觀點來呈現錯誤訊息。

良好的錯誤訊息不只是 UI 問題，而是軟體設計的問題。 好的錯誤訊息體驗並不是可以在稍後附加的。

**疑難排解 (以及如何避免)**

如果有數個不同的原因發生問題，則會回報單一錯誤訊息的疑難排解結果。

**不正確：**

![指出三個原因的一則訊息的圖表 ](images/mess-error-image16.png)

**正確：**

![三個訊息的圖表，指出每個訊息的原因](images/mess-error-image17.png)

使用單一錯誤訊息報告多個問題時的疑難排解結果。

在下列範例中，無法移動專案，因為它已經移動或刪除，或存取被拒。 如果程式很容易判斷出原因，為什麼要讓使用者負擔來判斷特定的原因？

**不正確：**

![訊息的螢幕擷取畫面，說明兩個原因 ](images/mess-error-image18.png)

沒錯，這是什麼？ 現在使用者必須進行疑難排解。

此程式可判斷是否拒絕存取，因此應回報此問題，並顯示特定的錯誤訊息。

**正確：**

![訊息的螢幕擷取畫面，指出其中一個原因 ](images/mess-error-image19.png)

因為有特定的原因，所以不需要進行疑難排解。

只有在無法判斷特定原因時，才使用具有多個原因的訊息。 在此範例中，程式很難判斷專案是否已移動或刪除，因此可能會在這裡使用具有多個原因的單一錯誤訊息。 不過，使用者不太可能會在意，例如，他們無法移動已刪除的檔案。 基於這些原因，錯誤訊息甚至不是必要的。

**處理未知的錯誤**

在某些情況下，您的真的不會知道問題、原因或解決方案。 如果要造成來抑制錯誤，最好事先瞭解缺少的資訊，而不是呈現問題、原因或可能不正確的解決方案。

例如，如果您的程式有未處理的例外狀況，則下列錯誤訊息適用：

![訊息的螢幕擷取畫面：發生未知的錯誤 ](images/mess-error-image20.png)

如果您無法隱藏未知的錯誤，最好先事先瞭解缺少的資訊。

另一方面，如果在大部分的情況下可能很有説明，請確實提供特定、可採取動作的資訊。

![顯示 Office Communicator 「伺服器無法使用」訊息的螢幕擷取畫面。 ](images/mess-error-image21.png)

如果網路連線通常是問題，則此錯誤訊息適用于未知的錯誤。

**判斷適當的訊息類型**

根據強調和措辭，某些問題可能會顯示為錯誤、警告或資訊。 例如，假設網頁無法根據目前的 Windows Internet Explorer 設定載入未簽署的 ActiveX 控制項：

- **錯誤。** 「此頁面無法載入未簽署的 ActiveX 控制項」。  (片語做為現有的問題。 ) 
- **警告。** 「此頁面可能無法如預期般運作，因為 Windows Internet Explorer 未設定為載入未簽署的 ActiveX 控制項」。 或「允許此頁面安裝不帶正負號的 ActiveX 控制項？ 從不受信任的來源執行此動作可能會危害您的電腦。」  (這兩個片語為可能會導致未來問題的狀況。 ) 
- **資訊。** 「您已設定 Windows Internet Explorer 封鎖未簽署的 ActiveX 控制項」。  (片語作為事實的陳述。 ) 

**若要判斷適當的訊息類型，請將焦點放在使用者需要知道或採取行動之問題的最重要層面。** 一般來說，如果問題封鎖使用者繼續進行，您應該將它顯示為錯誤;如果使用者可以繼續，請將它顯示為警告。 根據焦點製作 [主要指示](text-ui.md) 或其他對應的文字，然後選擇符合文字的圖示 ([標準](vis-std-icons.md) 或) 。 主要的指令文字和圖示應該一律相符。

**錯誤訊息展示**

Windows 程式中大部分的錯誤訊息都是使用強制回應對話方塊來呈現， (為本文中的大部分範例) ，但還有其他選項：

- 就地
- 汽球
- 通知
- 通知區域圖示
- 狀態列
- 記錄檔 (針對以 IT 專業人員為目標的錯誤) 

在強制回應對話方塊中放入錯誤訊息，具有要求使用者立即關注和通知的優點。 但是，如果不需要注意，這也是其主要缺點。

![訊息的螢幕擷取畫面：停止您正在執行的工作 ](images/mess-error-image22.png)

您真的需要中斷使用者，讓他們可以按一下 [關閉] 按鈕嗎？ 如果沒有，請考慮使用強制回應對話方塊的替代方案。

當使用者在繼續進行之前必須立即確認問題，但通常是不佳的選擇時，強制回應對話方塊是很好的選擇。 一般而言，您應該偏好使用可執行工作的最輕量呈現方式。

**避免 overcommunicating**

一般情況下， [使用者不會進行掃描](vis-layout.md)。 文字越多，就越難掃描文字，而使用者越可能完全不會讀懂文字。 因此，請務必將文字縮小至其基本資訊，並在需要時使用漸進式洩漏和說明連結以提供其他資訊。

有許多極端範例，但讓我們來看一個更常見的例子。 下列範例中的大部分屬性都有良好的錯誤訊息，但其文字並不精確，而且需要動機才能讀取。

**不正確：**

![詳細資訊訊息的螢幕擷取畫面 ](images/mess-error-image23.png)

這個範例是很好的錯誤訊息，但 overcommunicates。

這項文字真正說什麼？ 就像這樣：

**正確：**

![訊息的螢幕擷取畫面：未偵測到 cd 錄製器 ](images/mess-error-image24.png)

這項錯誤訊息基本上都有相同的資訊，但是更簡潔。

藉由使用 [說明] 來提供詳細資料，此錯誤訊息會有 [反向金字塔樣式](text-ui.md) 的簡報。

如需 overcommunicating 的詳細指導方針和範例，請參閱 [消費者介面文字](text-ui.md)。

**如果您只進行八件事**

1. 設計程式以進行錯誤處理。
2. 不要提供不必要的錯誤訊息。
3. 提供必要的錯誤訊息，以避免使用者混淆。
4. 請確定錯誤訊息提供問題、原因和解決方案。
5. 請確定錯誤訊息是相關、可採取動作、簡短、明確、明確、不致和罕見的。
6. 從使用者的觀點來設計錯誤訊息，而不是程式的觀點。
7. 避免使用者進行疑難排解時，請針對每個可偵測的原因使用不同的錯誤訊息。
8. 使用可執行工作的最輕量呈現方法。

**使用模式**

錯誤訊息有數種使用模式：


| 標籤 | 值 |
|--------|-------|
| <strong>系統問題</strong><br /> 作業系統、硬體裝置、網路或程式失敗，或未處於執行工作所需的狀態。 <br /> | 使用者可以解決許多系統問題： <br /><ul><li>裝置問題可以藉由開啟裝置、重新連接裝置，以及插入媒體來解決。</li><li>您可以藉由檢查實體網路連線，以及執行 <strong>網路診斷和修復</strong>，來解決網路問題。</li><li>您可以藉由變更程式選項或重新開機程式來解決程式問題。</li></ul><img src="images/mess-error-image25.png" alt="Screen shot of message: Can't find a camera " /><br /> 在此範例中，程式找不到可執行使用者工作的相機。<br /><img src="images/mess-error-image26.png" alt="Screen shot of message Network discovery off " /><br /> 在此範例中，必須開啟執行工作所需的功能。<br /> | 
| <strong>檔案問題</strong><br /> 找不到使用者起始的工作所需的檔案或資料夾、已在使用中，或其格式不正確。 <br /> | <img src="images/mess-error-image27.png" alt="Screen shot of message: Can't delete file " /><br /> 在此範例中，因為找不到檔案或資料夾，所以無法予以刪除。<br /><img src="images/mess-error-image28.png" alt="Screen shot of message: Can't play this file " /><br /> 在此範例中，程式不支援指定的檔案格式。<br /> | 
| <strong>安全性問題</strong><br /> 使用者無權存取資源，或有足夠的許可權來執行使用者所起始的工作。 <br /> | <img src="images/mess-error-image29.png" alt="Screen shot of message: You don't have permission " /><br /> 在此範例中，使用者沒有存取資源的許可權。<br /><img src="images/mess-error-image30.png" alt="Screen shot of message: You don't have privilege " /><br /> 在此範例中，使用者沒有執行工作的許可權。<br /> | 
| <strong>工作問題</strong><br /> 執行使用者所起始的工作 (不是系統、找不到檔案、檔案格式或安全性問題) 的特定問題。 <br /> | <img src="images/mess-error-image31.png" alt="Screen shot of message: Data can't be pasted " /><br /> 在此範例中，剪貼簿資料無法貼入小畫家中。<br /><img src="images/mess-error-image32.png" alt="Screen shot of message: Upgrade can't be installed " /><br /> 在此範例中，使用者無法安裝軟體升級。<br /> | 
| <strong>使用者輸入問題</strong><br /> 使用者輸入的值與其他使用者輸入不正確或不一致。 <br /> | <img src="images/mess-error-image33.png" alt="Screen shot of message: Incorrect time value " /><br /> 在此範例中，使用者輸入的時間值不正確。<br /><img src="images/mess-error-image34.png" alt="Screen shot of message: Incorrect input format " /><br /> 在此範例中，使用者輸入的格式不正確。<br /> | 


## <a name="guidelines"></a>指導方針

### <a name="presentation"></a>簡報

- 在 **適當時使用工作對話方塊**，以達成一致的外觀和配置。 工作對話方塊需要 Windows Vista 或更新版本，因此不適用於舊版的 Windows。 如果您必須使用訊息方塊，請使用兩個分行符號分隔出補充指令中的主要指令。

### <a name="user-input-errors"></a>使用者輸入錯誤

- **可能的話，請避免或減少使用者輸入錯誤：**
  - 使用受限於有效值的控制項。
  - 當您按一下時停用控制項和功能表項目，就會導致錯誤，只要它很明顯地停用控制項或功能表項目。
  - 提供良好的預設值。

**不正確：**

![具有喇叭音量標籤的文字方塊螢幕擷取畫面 ](images/mess-error-image35.png)

在此範例中，限制的輸入會使用未受限制的文字方塊。 請改用滑杆。

- **針對內容使用者輸入問題，使用非強制回應錯誤處理 (就地錯誤或氣球) 。**
- **在文字方塊中或在文字方塊失去焦點之後，于文字方塊中偵測到非關鍵性、單一點使用者輸入問題時，請使用球標。**[氣球](https://msdn.microsoft.com/library/windows/desktop/aa511451.aspx) 不需要可用的螢幕空間或顯示就地訊息所需的動態配置。 一次只顯示一個氣球。 因為此問題並不重要，所以不需要任何錯誤圖示。 當您按下、解決問題或在超時後，就會離開氣球。

![訊息的螢幕擷取畫面：不正確的字元 ](images/mess-error-image36.png)

在此範例中，氣球表示輸入問題仍然存在於控制項中。

- **使用就地錯誤偵測延遲的錯誤偵測，** 通常是按一下 [認可] 按鈕找到的錯誤。  (不會 [在](glossary.md) 立即認可的設定中使用就地錯誤。 ) 一次可能會有多個就地錯誤。 使用一般文字和16x16 圖元錯誤圖示，盡可能將它們直接放在問題旁。 除非使用者認可，且找不到任何其他錯誤，否則就地錯誤不會消失。

![訊息的螢幕擷取畫面：不正確的電子郵件地址 ](images/mess-error-image37.png)

在此範例中，按一下 [認可] 按鈕時，會使用就地錯誤來進行找到。

- **針對所有其他問題，使用強制回應錯誤處理 (工作對話方塊或訊息方塊) ，** 包括牽涉到多個控制項的錯誤，或是按一下 [認可] 按鈕時發現非內容相關或非輸入的錯誤。
- **當回報使用者輸入問題時，請將輸入焦點設定為具有不正確資料的第一個控制項。** 必要時，將控制項滾動至 view。 如果控制項是文字方塊，請選取 [完整內容]。 這應該一律是錯誤訊息所參考的內容。
- **請勿清除不正確的輸入。** 相反地，請將它保留，讓使用者可以看到並修正問題，而不需要從頭開始。
  - **例外狀況：** 清除不正確的密碼和 PIN 文字方塊，因為使用者無法有效更正遮罩輸入。

### <a name="troubleshooting"></a>疑難排解

- **避免建立疑難排解問題。** 請勿依賴單一錯誤訊息來回報有幾個不同可偵測原因的問題。
- **使用不同的錯誤訊息 (針對每個可偵測的原因，通常會有不同的補充指令) 。** 例如，如果檔案因為許多原因而無法開啟，請針對每個原因提供個別的補充指令。
- **只有在無法判斷特定原因時，才使用具有多個原因的訊息。** 在此情況下，請依解決問題的可能性來呈現解決方案。 這麼做可協助使用者更有效率地解決問題。

### <a name="icons"></a>圖示

- **強制回應錯誤訊息對話方塊沒有標題列圖示。** 標題列圖示會用來做為主視窗與次要視窗之間的視覺差異。
- **使用錯誤圖示。** 例外狀況：
  - 如果錯誤是使用強制回應對話方塊或氣球顯示的使用者輸入問題，請不要使用圖示。 這麼做是 Windows 的鼓勵語氣的計數器。 不過，就地錯誤訊息應該使用較小的錯誤圖示 (16x16 圖元) 來清楚地將它們識別為錯誤訊息。

     ![郵件的螢幕擷取畫面不正確的郵遞區號格式](images/mess-error-image38.png)

     ![郵件電腦名稱稱太長的螢幕擷取畫面](images/mess-error-image39.png)

     在這些範例中，使用者輸入問題不需要錯誤圖示。

     ![郵件電話號碼格式錯誤的螢幕擷取畫面](images/mess-error-image40.png)

     在此範例中，就地錯誤訊息需要較小的錯誤圖示，以明確地將其識別為錯誤訊息。

- 如果問題是因為有圖示 (而不是使用者輸入問題的功能) ，您可以使用功能圖示搭配錯誤重迭。 如果您這麼做，也請使用功能名稱做為錯誤的主旨。

    ![螢幕擷取畫面訊息媒體播放機無法播放檔案 ](images/mess-error-image41.png)

    在此範例中，功能圖示有錯誤重迭，而此功能是錯誤的主旨。

- **請勿使用警告圖示來發生錯誤。** 這麼做通常是為了讓簡報感覺更不嚴重。 錯誤不是警告。

    **不正確：**

    ![未啟用 [訊息快速切換] 的螢幕擷取畫面 ](images/mess-error-image42.png)

    在此範例中，會不正確地使用警告圖示來使錯誤感到較不嚴重。

如需更多指導方針和範例，請參閱 [標準圖示](vis-std-icons.md)。

### <a name="progressive-disclosure"></a>漸進式揭露

- **使用 [顯示/隱藏詳細資料的漸進式洩漏] 按鈕，即可在錯誤訊息中隱藏高階或詳細的資訊。** 這麼做可簡化一般使用的錯誤訊息。 請勿隱藏需要的資訊，因為使用者可能找不到它。

![訊息的螢幕擷取畫面： activesync 無法登入 ](images/mess-error-image43.png)

在此範例中，[漸進式洩漏] 按鈕可協助使用者視需要向下切入至更多詳細資料，或在不需要時簡化 UI。

- **除非真的有更多詳細資料，否則請勿使用顯示/隱藏詳細資料。** 請勿只以更詳細的格式重新聲明現有的資訊。
- **請勿使用顯示/隱藏詳細資料來顯示說明資訊。** 請改用說明連結。

如需標籤指導方針，請參閱 [漸進式洩漏控制項](ctrl-progressive-disclosure-controls.md)。

**不要再顯示此訊息**

- **如果錯誤訊息需要此選項，請重新考慮錯誤和其頻率。** 如果它有良好錯誤的所有特性 (相關、可採取動作且不頻繁的) ，使用者就不應該將它隱藏起來。

如需詳細指導方針，請參閱 [對話方塊](win-dialog-box.md)。

### <a name="default-values"></a>預設值

- **選取最安全、最不具破壞性或最安全的回應作為預設值。** 如果安全性不是因素，請選取最有可能或方便的命令。

### <a name="help"></a>說明

- **設計錯誤訊息，以避免需要協助。** 除非解決方案需要執行幾個步驟，否則使用者通常不需要讀取外部文字來瞭解並解決問題。
- **請確定說明內容相關且實用。** 它不應該是錯誤訊息的詳細重述，而是應該包含超出錯誤訊息範圍的有用資訊，例如避免未來發生問題的方法。 請不要提供說明連結，因為您可以。
- **使用特定、簡潔、相關的說明連結來存取說明內容。** 請勿針對此用途使用命令按鈕或漸進式洩漏。
- **對於您無法進行特定和可採取動作的錯誤訊息，請考慮提供線上說明內容的連結。** 如此一來，您就可以為使用者提供您在程式發行後可以更新的其他資訊。

如需詳細指導方針， [請參閱說明](winenv-help.md)。

### <a name="error-codes"></a>錯誤碼

- **針對您無法進行特定且可採取動作的錯誤訊息，或從 [說明] 獲益的錯誤訊息，請考慮同時提供錯誤碼。** 使用者通常會使用這些錯誤碼來搜尋網際網路，以取得其他資訊。
- **一律提供問題和解決方案的文字描述。** 請勿依賴此用途的錯誤碼。

**不正確：**

![訊息的螢幕擷取畫面：無法開啟檔案 ](images/mess-error-image44.png)

在此範例中，會使用錯誤碼作為解決方案文字的替代方案。

- **為每個不同的原因指派一個唯一的錯誤碼。** 這樣做可避免疑難排解問題。
- **選擇可在網際網路上輕鬆搜尋的錯誤碼。** 如果您使用32位的代碼，請使用十六進位標記法搭配前置的 "0x" 和大寫字元。

**正確：**

1234

0xC0001234

**不正確：**

-1

-67113524

- **使用 [顯示/隱藏詳細資料] 顯示錯誤碼。** 片語為錯誤碼： <error code> 。

![訊息的螢幕擷取畫面：程式未初始化 ](images/mess-error-image45.png)

在此範例中，會使用錯誤碼來補充可受益于進一步資訊的錯誤訊息。

### <a name="sound"></a>音效

- **不要伴隨著有音效效果或嗶聲的錯誤訊息。** 這麼做是 jarring 且不必要的。
  - **例外狀況：** 如果問題對電腦操作很重要，請播放重大的停止音效，而使用者必須立即採取行動以防止嚴重的後果。

## <a name="text"></a>Text

**一般**

- **移除多餘的文字。** 在標題、主要指示、補充指示、命令連結和認可按鈕中尋找。 一般而言，請在指示和互動式控制項中保留完整文字，然後從其他位置移除任何多餘的。
- **使用以使用者為主的說明。** 根據使用者動作或目標來描述問題，而不是在軟體不滿意的方面描述。 使用目標使用者瞭解並使用的語言。 避免技術術語。

**不正確：**

![訊息的螢幕擷取畫面：輸入-同步呼叫 ](images/mess-error-image46.png)

**正確：**

![訊息的螢幕擷取畫面：忙碌接收來電 ](images/mess-error-image47.png)

在這些範例中，正確的版本會說出使用者的語言，而不正確的版本則會過於技術性。

- **請勿使用下列文字：**
  - 錯誤，失敗 (改為使用問題) 
  - 無法 (使用無法改為) 
  - 不合法、無效、錯誤 (請改用不正確的) 
  - Abort、kill、terminate (使用 stop 改) 
  - 嚴重的嚴重 (請改用嚴重的) 

這些條款是不必要的，與 Windows 的鼓勵語氣相反。 [正確使用](vis-std-icons.md)時，錯誤圖示可充分傳達發生問題。

**不正確：**

![訊息的螢幕擷取畫面：嚴重失敗！ ](images/mess-error-image48.png)

**正確：**

![訊息的螢幕擷取畫面：備份必須一次關閉 ](images/mess-error-image49.png)

在不正確的範例中，不需要「嚴重」和「失敗」詞彙。

- 請勿使用意思暗示指責使用者或隱含使用者錯誤的片語。 避免在片語中使用您和。 當使用中的語音通常是慣用的時候，請在使用者為主旨時使用被動聲音，如果使用的是使用中的聲音，可能會覺得應該過度錯誤。

**不正確：**

![您輸入不正確登入之訊息的螢幕擷取畫面 ](images/mess-error-image50.png)

**正確：**

![訊息的螢幕擷取畫面：密碼不正確 ](images/mess-error-image51.png)

不正確的範例會使用主動式聲音意思暗示指責使用者。

- **是特定的。** 避免模糊的用語，例如語法錯誤和不合法的作業。 提供相關物件的特定名稱、位置和值。

**不正確：**

找不到檔案。

磁碟已滿。

值超出範圍。

字元無效。

裝置無法使用。

使用特定的名稱、位置和值，可以更輕鬆地解決這些問題。

- **請勿在嘗試特定的情況下，提供可能不太可能的問題、原因或解決方案。** 請勿提供問題、原因或解決方案，除非它可能是正確的。 例如，比起可能不正確的錯誤，最好是說發生未知的錯誤。
- 除了在要求使用者進行不方便的 (例如等待) 或軟體是面臨這種情況時，**請避免出現「請」這個字**。

**正確：**

請稍候，Windows 將檔案複製到您的電腦。

- 請 **只在錯誤訊息中使用 "抱歉" 這個字，這會導致使用者的嚴重問題** (例如，資料遺失或無法使用電腦) 。 如果程式正常運作期間發生此問題，請不要深感抱歉 (例如，如果使用者需要等候) 的網路連接。

**正確：**

很抱歉，Fabrikam 備份偵測到無法復原的問題，並已關閉以保護您電腦上的檔案。

- **請使用其簡短名稱來參考產品。** 請勿使用完整的產品名稱或商標符號。 請勿包含公司名稱，除非使用者將公司名稱與產品建立關聯。 請勿包含程式版本號碼。

**不正確：**

![顯示 Microsoft Office Outlook 「無法開啟此專案」訊息的螢幕擷取畫面。 ](images/mess-error-image52.png)

**正確：**

![訊息的螢幕擷取畫面：無法開啟此專案 ](images/mess-error-image53.png)

在不正確的範例中，會使用完整的產品名稱和商標符號。

- **請在物件名稱前後加上雙引號。** 這樣做可讓您更輕鬆地剖析文字，並避免可能的尷尬語句。
  - **例外狀況：** 完整檔案路徑、Url 和功能變數名稱不需要用雙引號括住。

**正確：**

![訊息的螢幕擷取畫面：「我的房子」無法使用 ](images/mess-error-image54.png)

在此範例中，如果物件名稱不在引號中，則錯誤訊息會造成混淆。

- **避免使用物件名稱來起始句子。** 這麼做通常很難剖析。
- **請勿使用加上雙引號或全大寫字母的單字。** 驚嘆號和大寫字母讓您覺得 shouting 是使用者。

如需詳細的指導方針和範例，請參閱 [樣式和語氣](text-style-tone.md)。

**標題**

- **使用標題來識別產生錯誤的命令或功能。** 例外狀況：
  - 如果有許多不同的命令顯示錯誤，請考慮改為使用程式名稱。
  - 如果該標題是多餘的，或與主要指示混淆，請改用程式名稱。
- **請勿使用標題來說明或摘要** 說明主要指令用途的問題。

**不正確：**

![顯示「無法重新命名新資料夾」訊息的螢幕擷取畫面。 ](images/mess-error-image55.png)

在此範例中，標題未正確地用來說明問題。

- 使用標題樣式的大小寫，但不含結束標點符號。

**主要指示**

- **您可以使用主要指示，以純文字明確的語言描述問題。**
- **請務必只使用單一的完整句子。** 削減主要指示以瞭解基本資訊。 如果您的程式或使用者是您的程式，則可以將主體保持隱含。 如果您可以很簡潔，請包含問題的原因。 如果您必須進一步說明，請使用補充指示。

**不正確：**

![訊息的螢幕擷取畫面：無法安裝升級 ](images/mess-error-image56.png)

在此範例中，完整的錯誤訊息會放在主要指令中，因此難以閱讀。

- **如果有相關的物件，請指定其名稱，並指定其名稱。**
- **避免將完整檔案路徑和 Url 放在主要指令中。** 相反地，請使用簡短名稱 (例如檔案名) 並將完整名稱 (例如在補充指令中) 的檔案路徑。 但是，如果錯誤訊息不需要補充指令，您可以在主要指令中放入單一完整檔案路徑或 URL。

![message：無法刪除 fabrikam 檔案的螢幕擷取畫面 ](images/mess-error-image57.png)

在此範例中，只會在主要指令中有檔案名。 完整路徑是在補充指令中。

- **如果內容很明顯，請不要提供完整的檔案路徑和 URL。**

![訊息的螢幕擷取畫面：無法重新命名新資料夾 ](images/mess-error-image58.png)

在此範例中，使用者正在從 Windows 檔案總管重新命名檔案。 在此情況下，不需要完整的檔案路徑，因為它從內容中很明顯。

- 盡可能使用目前的時態。
- 使用句型大寫。
- 如果指令是語句，則不包含最後句號。 如果指令是問題，請包含最後一個問號。

**主要指令範本**

雖然片語沒有嚴格的規則，但請盡可能嘗試使用下列主要指令範本：

- [選用主體名稱] 無法 [執行動作]
- [選用主體名稱] 無法 [執行動作]，因為 [原因]
- [選用主體名稱] 無法 [執行動作] 至 "[物件名稱]"
- [選用主體名稱] 無法 [執行動作] 至 "[物件名稱]"，因為 [原因]
- 沒有足夠的 [資源] 可 [執行動作]
- [主體名稱] 沒有 [用途] 所需的 [物件名稱]
- [裝置或設定] 已關閉，因此 [不希望的結果]
- [裝置或設定] 未 [ \| \| 已啟用可找到的開啟 \| ]
- "[物件名稱]" 目前無法使用
- 使用者名稱或密碼不正確
- 您無權存取 "[object name]"
- 您沒有 [執行動作] 的許可權
- [程式名稱] 遇到嚴重的問題，必須立即關閉

當然，請視需要變更主要指令的語法是否正確，並遵守主要指示指導方針。

**補充指示**

- 使用補充指示：
  - 提供有關問題的其他詳細資料。
  - 說明問題的原因。
  - 列出使用者可採取的步驟來修正問題。
  - 提供量值以防止問題重複發生。
- **可能的話，請提出實用且有用的解決方案，讓使用者可以修正問題。** 不過，請確定建議的解決方案可能會解決此問題。 不要藉由建議可能但未必的解決方案，來浪費使用者的時間。

**不正確：**

![訊息的螢幕擷取畫面：記憶體不足 ](images/mess-error-image59.png)

在此範例中，雖然問題及其建議的解決方案是可行的，但這不太可能發生。

- **如果問題是使用者輸入的不正確值，請使用補充指示來說明正確的值。** 使用者不需要從另一個來源判斷這份資訊。
- **如果可以從問題陳述中完整，請不要提供解決方案。**

![訊息的螢幕擷取畫面：時間值不正確 ](images/mess-error-image33.png)

在此範例中，不需要任何補充指示;您可以從問題陳述中完整的解決方案。

- **如果解決方案有多個步驟，請依應完成的順序來顯示這些步驟。** 不過，請避免使用多步驟解決方案，因為使用者難以記住兩個或三個簡單的步驟。 如果需要更多步驟，請參閱適當的說明主題。
- **讓補充指示保持簡潔。** 僅提供使用者需要知道的事項。 省略不必要的詳細資料。 最多可為適中長度的三個句子。
- **為了避免使用者執行指令時發生錯誤，請將結果放在動作之前。**

**正確：**

若要重新開機 Windows，請按一下 [確定]。

**不正確：**

按一下 [確定] 以重新開機 Windows。

在不正確的範例中，使用者可能會意外按一下 [確定]。

- **不建議您聯繫系統管理員，除非這麼做是問題的最可能解決方案。** 針對真正只能由系統管理員解決的問題，保留這類解決方案。

**不正確：**

![訊息的螢幕擷取畫面：伺服器無法使用 ](images/mess-error-image60.png)

在此範例中，最可能的問題是使用者的網路連線，因此不值得您聯絡系統管理員。

- **不建議您聯繫技術支援部門。** 若要解決問題，您可以選擇使用技術支援來解決問題，而不需要透過錯誤訊息來升級。 相反地，請將焦點放在撰寫有用的錯誤訊息，讓使用者可以解決問題，而不需要聯繫技術支援。

**不正確：**

![顯示「無法開啟此專案」訊息的螢幕擷取畫面。 ](images/mess-error-image61.png)

在此範例中，錯誤訊息會不正確地建議與技術支援聯絡。

- 使用完整句子、句子樣式的大小寫和結束標點符號。

**認可按鈕**

- 如果錯誤訊息提供可解決問題的命令按鈕或命令連結，請在 [對話方塊](win-dialog-box.md)中依照各自的指導方針。
- 如果程式因錯誤而必須終止，請提供 [結束程式] 按鈕。 為了避免混淆，請不要針對此用途使用 Close。
- 否則，請提供 [關閉] 按鈕。 請勿將 [確定] 用於錯誤訊息，因為這種措辭表示問題沒問題。
  - **例外狀況：** 如果您的錯誤報表機制具有固定標籤 (與 MessageBox API 相同，請使用 [確定]。 ) 

## <a name="documentation"></a>文件

參考錯誤時：

- 請依主要指示來參考錯誤。 如果主要指令很長或更詳細，請將其摘要。
- 如有必要，您可以將 [錯誤訊息] 對話方塊參考為訊息。 請參閱僅在程式設計和其他技術檔中的錯誤訊息。
- 可能的話，請使用粗體格式化文字。 否則，請只在必要時才將文字放在引號中，以避免混淆。

**範例：** 如果您收到「 **磁片磁碟機中沒有光碟片** 」訊息，請在磁片磁碟機中插入新的光碟片，然後再試一次。
