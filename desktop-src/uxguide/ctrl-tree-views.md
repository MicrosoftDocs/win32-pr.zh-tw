---
title: 樹狀檢視
description: 使用樹狀檢視時，使用者可以透過單一選取或多重選取，來查看階層式排列的物件集合，並與其互動。
ms.assetid: f0206485-e028-41d8-9be2-5d59f0a0b677
ms.topic: article
ms.date: 10/20/2020
ms.openlocfilehash: c5cb2b6d48a30cba6de2136659231d9d37361621
ms.sourcegitcommit: 3bdf30edb314e0fcd17dc4ddbc70e4ec7d3596e6
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 02/10/2021
ms.locfileid: "104570054"
---
# <a name="tree-views"></a>樹狀檢視

> [!NOTE]
> 此設計指南是針對 Windows 7 所建立，而且尚未針對較新版本的 Windows 更新。 大部分的指引仍然適用于準則，但展示和範例不會反映我們目前的 [設計指引](/windows/uwp/design/)。

使用樹狀檢視時，使用者可以透過單一選取或多重選取，來查看階層式排列的物件集合，並與其互動。

在樹狀結構中，包含資料的物件稱為分葉節點，而包含其他物件的物件則稱為容器節點。 單一的最上層容器節點稱為根節點。 使用者可以按一下加號和減號展開器按鈕，展開和折迭容器節點。

![windows explorer 樹狀檢視的螢幕擷取畫面 ](images/ctrl-tree-views-image1.png)

一般的樹狀檢視。

> [!Note]  
> 與 [版面](vis-layout.md) 配置和 [功能表](cmd-menus.md) 相關的指導方針會在個別的文章中顯示。

 

## <a name="is-this-the-right-control"></a>這是正確的控制項嗎？

**擁有階層式資料並不表示您必須使用樹狀檢視。** [清單視圖](ctrl-list-views.md)通常是比較簡單但功能更強大的選擇。 列出視圖：

-   支援數個不同的觀點。
-   支援依詳細資料檢視中的任何資料行排序資料。
-   支援將資料組織成群組，形成兩層級的階層。

**若要使用清單視圖，您可以使用下列技術來壓平合併階層式資訊：**

-   移除根節點（如果有的話），因為它通常不是必要的。
-   使用清單視圖群組、索引標籤、 [下拉式清單](/windows/desktop/uxguide/ctrl-drop)或 [可擴充的標題](glossary.md) 來取代最上層的容器。

    ![包含清單的清單視圖群組螢幕擷取畫面 ](images/ctrl-tree-views-image2.png)

    在此範例中，會使用清單視圖群組作為最上層容器。

    ![用於最上層容器之索引標籤的螢幕擷取畫面 ](images/ctrl-tree-views-image3.png)

    在此範例中，索引標籤會用於最上層容器

    ![作為容器使用之下拉式清單的螢幕擷取畫面 ](images/ctrl-tree-views-image4.png)

    在此範例中，會將下拉式清單用於最上層容器。

-   如果相關聯的控制項顯示選取之容器的內容，則該控制項可以顯示較低層級的階層。

    ![[目錄] 窗格的螢幕擷取畫面 ](images/ctrl-tree-views-image5.png)

    在此範例中，低層級的容器會顯示在文件視窗中。

**如果您需要顯示兩個以上層級的階層，就必須使用樹狀檢視 (不包含根節點) 。**

若要決定樹狀檢視是否為正確的控制項，請考慮下列問題：

-   **資料是否階層式？** 如果不是，請使用其他控制項。
-   **階層是否至少有三個層級 (不包含根) ？** 如果沒有，請考慮其他替代專案，例如清單視圖群組、索引標籤、下拉式清單或可擴充的標題。
-   **專案是否有輔助資料？** 如果是這樣，請考慮在詳細資料檢視模式中使用清單視圖，以充分利用輔助資料。
-   **較低層級的資料與獨立的子工作有何關聯？** 若是如此，請考慮在相關聯的控制項或個別的視窗中顯示資訊， (使用 [命令按鈕](ctrl-command-buttons.md) 或 [連結](ctrl-command-links.md)) 來顯示。
-   **目標使用者是否為 advanced？** Advanced users 更精通使用樹狀結構。 如果您的應用程式是以新手使用者為目標，請避免使用樹狀檢視。
-   **這些專案是否有對大部分使用者都很熟悉的單一、自然階層式分類？** 如果是的話，資料就是樹狀檢視的理想選擇。 如果需要多個視圖或排序，請改用清單視圖。
-   **使用者是否需要在部分（而非全部）的情況下查看較低層級的資料，或是部分但不是所有的時間？** 如果是的話，資料就是樹狀檢視的理想選擇。

> [!Note]  
> 有時候看起來像樹狀檢視的控制項是使用清單視圖來執行的。 在這種情況下，請根據使用方式套用指導方針，而不是在執行時套用。

 

## <a name="design-concepts"></a>設計概念

樹狀結構是用來組織資料並讓它更容易找到，但很難讓樹狀結構中的資料易於探索。 決定樹狀檢視及其組織時，請記住下列原則。

### <a name="predictability-and-discoverability"></a>可預測性和可探索性

**樹狀檢視是以物件之間的關聯性為基礎。** 當物件形成明確、已知、互斥的關聯性時，樹狀結構的效果最佳，其中每個物件都對應至單一且易於判斷的容器。

**有一個重要的問題是，物件可以出現在不同的節點中。** 例如，使用者應該在哪裡尋找播放音樂的硬體裝置、有大型硬碟，並使用 USB 埠？ 可能在數個不同的容器節點中，例如多媒體、儲存體、USB，以及可能的硬體資源。 其中一個解決方法是將每個物件放在單一最適當的容器下，而不考慮任何情況;另一種方法是將每個物件放在所有適用的容器之下。 前者會升級簡單的全新階層，後者會提升可探索性，每個都有優點和潛在的問題。

**使用者可能不會完全瞭解樹狀結構的版面配置，但會在與樹狀結構互動一段時間後，形成關聯性的精神模型。** 如果該精神模型不正確，就會導致混淆。 例如，假設音樂播放機可在多媒體、存放裝置和 USB 容器中找到。 這種安排可改善探索能力。 如果使用者先在多媒體中尋找裝置，則使用者可能會發現所有裝置（像是音樂播放機）都會出現在多媒體容器中。 然後，使用者會預期類似的裝置（例如數位相機）會出現在多媒體容器中，如果不是這種情況，將會混淆。

**設計樹狀結構時的挑戰是將探索能力與可預測的使用者模型進行平衡，以將混淆降至最低。**

### <a name="breadth-vs-depth"></a>廣度和深度

可用性研究顯示， **使用者在尋找樹狀結構中的物件時，會比深度更廣**，因此在設計樹狀結構時，您應該優先使用廣度。 在理想的情況下，樹狀結構不應超過四個層級 (不會計算根節點) ，而且最常存取的物件應該會出現在前兩個層級中。

### <a name="other-principles"></a>其他原則

-   當使用者找到所需的內容時，他們就會停止查看。 它們並不會查看可能會發現物件的位置，因為它們不需要。 這些使用者可能會假設他們找到的第一個路徑是唯一的路徑。
-   使用者在大型、複雜的樹狀結構中尋找物件時遇到問題。 使用者將不會執行完整的手動搜尋來尋找這類樹狀結構中的物件;他們會在他們認為已花費合理的努力時停止。 因此，大型的複雜樹狀結構必須與其他存取方法（例如文字搜尋、索引或篩選）進行補充。
-   有些程式可讓使用者建立自己的樹狀結構。 雖然這類自我設計的樹狀結構可能會與使用者的精神模型一致，但通常會建立 haphazardly 且維護不良。 例如，雖然檔案系統、電子郵件程式和我的最愛清單通常會儲存類似的資訊類型，但使用者很少會使用相同的方式來組織它們。

**如果您只做一件事 .。。**

仔細權衡使用樹狀檢視的優點和缺點。 以階層方式排列資料並不表示您需要使用樹狀檢視。

## <a name="usage-patterns"></a>使用模式

樹狀檢視有數種使用模式：



|                                                                                                                                                  |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|--------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| **只有容器節點的樹狀檢視**<br/> 使用者可以一次查看一個容器，並與之互動。 <br/>                        | 這些樹狀檢視通常有相關聯的控制項，可顯示所選容器的內容，因此使用者一次只能與一個容器互動。 <br/> ![[容器] 窗格和 [內容] 窗格的螢幕擷取畫面 ](images/ctrl-tree-views-image6.png)<br/> 在此範例中，樹狀檢視只有容器節點。 所選節點的內容會顯示在相關聯的清單視圖控制項中。<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| **具有容器和分葉節點的樹狀檢視**<br/> 使用者可以查看容器和離開容器並進行互動。<br/>                       | 這些樹狀檢視通常會有相關聯的控制項，可顯示所選容器或分葉的內容。 讓使用者可以與離開的互動，通常是必須支援多重選取。 <br/> ![樹狀檢視窗格和 [內容] 窗格的螢幕擷取畫面 ](images/ctrl-tree-views-image7.png)<br/> 在此範例中，樹狀檢視同時具有容器和分葉節點。 因為支援多重選取，所以會使用相關控制項中的索引標籤 [來顯示](ctrl-tabs.md) 開啟專案的內容。<br/> 或者，樹狀檢視可以有組織的清單，其中容器是標題，而葉子則是選項。 <br/> ![具有標題和選項的樹狀檢視螢幕擷取畫面 ](images/ctrl-tree-views-image8.png)<br/> 在此範例中，樹狀結構是選項，而容器是選項類別目錄。<br/> |
| **核取方塊樹狀檢視**<br/> 使用者可以選取任意數目的專案，包括 [無]。<br/>                                             | 核取方塊會清楚指出可能會有多個選取專案。 當多重選取專案為必要或常用時，請使用此樹狀結構模式。 <br/> ![具有核取方塊的樹狀檢視螢幕擷取畫面 ](images/ctrl-tree-views-image9.png)<br/> 在此範例中，核取方塊樹狀檢視可讓您選取要開啟或關閉的功能。<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| **樹狀檢視產生器**<br/> 使用者可以一次新增一個容器或分葉，並選擇性地設定順序，藉以建立樹狀結構。<br/> | 使用者可以建立或修改許多樹狀結構。 某些樹狀結構是使用內容功能表和拖放 (（例如 windows explorer) 中的資料夾）來建立，而其他樹狀結構則是使用特殊的對話方塊 (，例如 windows internet explorer 中的 [我的最愛] 清單) 。 <br/> ![[我的最愛] 對話方塊的螢幕擷取畫面 ](images/ctrl-tree-views-image10.png)<br/> 在此 Internet Explorer 範例中，使用者可以使用對話方塊來建立自己的我的最愛清單。<br/>                                                                                                                                                                                                                                                                                                                                                                                     |
| **具有替代存取方法的樹狀檢視**<br/> 使用者可以使用階層式樹狀結構以外的方式來尋找物件。<br/>        | 如先前所述，使用者在大型、複雜的樹狀結構中尋找物件時遇到問題，因此這類樹狀結構應該與其他存取方法（例如文字搜尋、索引或篩選）進行補充。 <br/> ![[內容]、[索引] 和 [我的最愛] 的螢幕擷取畫面 ](images/ctrl-tree-views-image11.png)<br/> 在此範例中，使用者也可以使用目錄、索引和我的最愛來存取訊號。 對於某些使用者來說，[索引] 和 [搜尋] 索引標籤可能會比 [內容] 索引標籤更有用。<br/> ![windows [開始] 功能表和搜尋方塊的螢幕擷取畫面 ](images/ctrl-tree-views-image12.png)<br/> 在此範例中，Windows [開始] 功能表也會在 [搜尋] 方塊中輸入部分名稱，讓使用者存取程式、檔案和網頁。<br/>                                                                                                             |



 

## <a name="guidelines"></a>指導方針

### <a name="presentation"></a>簡報

-   **在容器內，依邏輯順序來排序專案。** 依字母順序排序名稱、依數位順序排序數位和日期（以時間順序排列）。
-   **使用 [永遠顯示選取範圍] 屬性** ，讓使用者可以輕鬆地判斷選取的專案，即使控制項沒有輸入焦點也一樣。
-   **如果樹狀結構作為目錄，請使用單一展開屬性來簡化樹狀結構的管理。** 如此一來，就只會展開樹狀結構的相關部分。
-   **避免呈現空白的樹狀結構。** 如果使用者建立樹狀結構，請使用使用者可能需要的指示或範例專案來初始化樹狀目錄。

    ![internet explorer [我的最愛] 清單的螢幕擷取畫面 ](images/ctrl-tree-views-image13.png)

    在此範例中，清單一開始會顯示範例。

-   **如果使用者沒有理由折迭容器節點，請勿將它們設為可折迭。** 這樣做會增加不必要的複雜性。
-   **如果載入效能是問題，預設只會顯示樹狀結構的第一個和第二個層級容器。** 然後，當使用者展開樹狀結構中的分支時，您就可以視需要載入其他資料。
-   **如果使用者展開或折迭容器，請讓該狀態保持不變，如此一來，下一次顯示樹狀檢視** 時，才會生效，除非使用者可能偏好以預設狀態啟動。 持續性應以每一使用者為基礎的每個樹狀檢視為基礎。
-   **如果高階容器具有類似的內容，請考慮使用視覺線索來區分它們。**

    **不正確：**

    ![具有不同圖示的 outlook 專案螢幕擷取畫面 ](images/ctrl-tree-views-image14.png)

    在此範例中，信箱和封存資料夾具有類似的內容。 當樹狀結構進一步展開之後，使用者很難知道它們在樹狀結構中的位置，進而造成混淆。 在不同的區段中使用稍有不同的圖示，可解決此問題。

-   **重新考慮連接線。** 雖然這些行會清楚地顯示容器和分葉節點之間的關聯性，但不會大幅理解協助，而會大幅增加視覺效果。 具體來說，它們在節點關閉時不會有説明，也不會在節點離需要滾動時提供協助。

    **正確：**

    ![具有連接線之樹狀檢視的螢幕擷取畫面 ](images/ctrl-tree-views-image15.png)

    **較佳：**

    ![沒有連接線的樹狀檢視螢幕擷取畫面 ](images/ctrl-tree-views-image16.png)

    連接程式碼很少有助於理解。

### <a name="interaction"></a>互動

-   **請考慮提供按兩下行為。** 按兩下應該與選取專案並執行其預設命令的效果相同。
-   **讓按兩下行為重複。** 應該一律會有相同效果的命令按鈕或內容功能表命令。
-   如果專案需要進一步說明，請 **在提示中提供說明**。

    ![[我的最愛] 的螢幕擷取畫面，其中有一個專案的查看提示 ](images/ctrl-tree-views-image17.png)

    在此範例中，資訊提示會提供進一步的資訊。

-   **提供相關命令的內容功能表。** 這類命令包括剪下、複製、貼上、移除或刪除、重新命名和屬性。
-   **停用樹狀檢視時，也會停用任何相關聯的標籤和命令按鈕。**

### <a name="tree-organization"></a>樹狀結構組織

-   **使用大部分使用者熟悉的自然階層式結構。**
-   **如果您無法使用這類結構，請嘗試使用可預測的使用者模型來平衡探索能力，以將混淆降至最低。**
-   **為了安全地改善探索能力，請在下列情況下將專案放在多個容器中：**
    -   專案與其他類似的專案沒有關聯 (因此，使用者不會因為) 的關聯而混淆。
    -   有幾個這類冗余的位置專案 (因此，樹狀結構不會變成膨脹) 。
-   **使用正常運作的最簡單階層結構。** 操作方法：
    -   將最常存取的物件放在樹狀結構的前兩個層級 (不會計算根節點) ，並將較不常存取的物件放在階層中較低的位置。
    -   消除不必要或合併重複的中繼層級容器。
-   **偏好深度更廣。** 在理想的情況下，樹狀結構不應超過四個層級，而且最常存取的物件應該會出現在前兩個層級中。
-   **判斷您是否真的需要根節點。** 如果使用者需要在整個樹狀結構上執行命令的能力，請提供根節點， (可能使用根節點) 上的內容功能表。 否則，樹狀結構更簡單且更容易使用。
-   **如果樹狀結構具有替代的存取方法，例如文字搜尋或索引，請將焦點放在最有用的內容，以優化流覽樹狀目錄。** 使用替代的存取方法，樹狀結構的內容不需要完整。 簡化樹狀結構可讓使用者更容易找到最有用的內容。

### <a name="check-box-tree-views"></a>核取方塊樹狀檢視

-   **顯示清單下方選取的專案數目**，特別是當使用者可能選取數個專案時。 這項意見反應可協助使用者確認其選擇是否正確。

    ![選取的專案數目的螢幕擷取畫面 ](images/ctrl-tree-views-image18.png)

    在此範例中，選取的專案數目會顯示在樹狀結構下方。 顯然沒有選取兩個專案。

-   如果有可能有許多專案，並選取或清除所有的專案，請加入 [全選] 和 [全部清除] 命令按鈕。
-   **使用混合狀態核取方塊來指出部分在容器中選取專案。**

    **正確：**

    ![具有混合狀態核取方塊之視窗的螢幕擷取畫面 ](images/ctrl-tree-views-image19.png)

    在此範例中，混合狀態核取方塊用來指出部分選取。

## <a name="recommended-sizing-and-spacing"></a>建議的大小和間距

![樹狀檢視大小和間距的螢幕擷取畫面 ](images/ctrl-tree-views-image20.png)

樹狀檢視控制項的建議大小和間距。

-   **選擇樹狀檢視寬度，以避免** 在完全展開樹狀結構時，對大部分專案進行水準滾動。
-   **包含額外的30% 來容納當地語系化。**
-   **選擇可消除不必要垂直捲動的樹狀檢視高度。** 請考慮讓樹狀檢視稍微長 (或更久，如果有可用空間，) 如果這樣做，就能減少垂直捲動條的需求。

    **不正確：**

    ![short、窄樹狀檢視控制項的螢幕擷取畫面 ](images/ctrl-tree-views-image21.png)

    在此範例中，讓樹狀檢視稍微更寬且更長，在大部分情況下都會消除捲軸。 在此特定樹狀結構中，一次只能開啟一個容器。

-   **如果使用者受益于使樹狀檢視更大，請讓樹狀檢視和其父視窗變成可調整大小。** 這麼做可讓使用者視需要調整樹狀檢視大小。

## <a name="labels"></a>標籤

### <a name="control-labels"></a>控制項標籤

-   所有樹狀檢視都需要標籤。 將標籤以單字或片語的形式寫入，而不是以句子（以冒號結尾）和使用 [靜態文字](glossary.md)。
-   指派唯一的存取金鑰。 如需指派指導方針，請參閱 [鍵盤](inter-keyboard.md)。
-   使用句型大寫。
-   將標籤置於控制項上方，並將標籤與控制項的左邊緣對齊。
-   若為多重選取樹狀結構視圖，請撰寫標籤，讓您可以明確地選取多個選項。 核取方塊：樹狀檢視標籤可能較不明確。

    **不正確：**

    ![具有元件標籤之樹狀檢視的螢幕擷取畫面 ](images/ctrl-tree-views-image22.png)

    在此範例中，標籤不會提供多個選取專案的相關資訊。

    **較佳：**

    ![具有「一或多個」標籤之樹狀檢視的螢幕擷取畫面 ](images/ctrl-tree-views-image23.png)

    在此範例中，標籤會清楚指出可能會有多個選取專案。

    **最好：**

    ![具有核取方塊的樹狀檢視螢幕擷取畫面 ](images/ctrl-tree-views-image24.png)

    在此範例中，核取方塊會清楚指出可能有多重選取，因此標籤不需要明確。

### <a name="data-text"></a>資料文字

-   使用句型大寫。

### <a name="instructional-text"></a>教學文字

-   如果您需要新增有關樹狀檢視的解說文字，請將它加入標籤上方。 使用結尾標點符號的完整句子。
-   使用句型大寫。
-   有説明但不需要的補充說明應該保持簡短。 請將這項資訊放在標籤和冒號之間的括弧內、在主要指示（如果使用）（而不是標籤，或在控制項之下）。

    ![樹狀檢視下方說明的螢幕擷取畫面 ](images/ctrl-tree-views-image8.png)

    在此範例中，補充說明位於控制項底下。

## <a name="documentation"></a>文件

參考樹狀檢視時：

-   使用確切的標籤文字，包括其大小寫，但不包含存取金鑰底線或冒號。 如果內容需要與一般清單有區別，請包含單字清單或階層式清單。
-   若為樹狀結構專案，請使用確切的專案文字，包括其大小寫。
-   只有在程式設計和其他技術檔中，才能將樹狀結構視圖視為樹狀檢視。 在其他地方使用清單或階層式清單，因為詞彙樹狀結構與大部分的使用者混淆。
-   若要描述使用者互動，請針對資料使用 select，然後針對加號和減號按鈕展開和折迭。
-   可能的話，請使用粗體文字來格式化標籤和樹狀結構專案。 否則，請只在必要時才將標籤和專案放在引號中，以避免混淆。

範例：在 [ **內容** ] 清單中，選取 [ **消費者介面設計**]。

在樹狀檢視中參考核取方塊時：

-   使用確切的標籤文字（包含其大小寫），並包含 [單字] 核取方塊。 請勿包含存取金鑰底線。
-   若要描述使用者互動，請使用選取和清除。
-   可能的話，請使用粗體文字來格式化標籤。 否則，請只在必要時才將標籤放在引號中，以避免混淆。

範例：在 [ **要備份的專案** ] 清單中，選取 [ **我的檔** ] 核取方塊。

