---
title: 視窗管理
description: 本文涵蓋 windows 最初顯示時 windows 的預設位置、相對於其他 windows (Z 順序的堆疊順序) 、其初始大小，以及其顯示如何影響輸入焦點。
ms.assetid: d81bd71c-6d8f-45a9-82cb-bdb9b8bcbb11
ms.topic: article
ms.date: 10/20/2020
ms.openlocfilehash: b8dc2858b0e3cc3b2a451210a61315c610afc727ac42156d5c4fc5c112135807
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/11/2021
ms.locfileid: "118212116"
---
# <a name="window-management"></a>視窗管理

> [!NOTE]
> 此設計指南是針對 Windows 7 所建立，而且尚未針對較新的 Windows 版本進行更新。 大部分的指引仍然適用于準則，但展示和範例不會反映我們目前的 [設計指引](/windows/uwp/design/)。

本文涵蓋 windows 最初顯示時 windows 的預設位置、相對於其他 windows ([Z 順序](glossary.md) 的堆疊順序) 、其初始大小，以及其顯示如何影響輸入焦點。

下列指導方針：

-   最上層視窗沒有擁有者視窗，而且會顯示在工作列上。 範例：應用程式視窗。 在 Windows Vista 和更新版本中，沒有擁有者視窗和屬性工作表的對話方塊也會被視為最上層。
-   擁有的視窗具有擁有者視窗，且不會顯示在工作列上。 範例：強制回應對話方塊、非強制回應對話方塊。
-   使用者起始的視窗會顯示為使用者動作的直接結果。 否則，它是由程式起始的程式，或由 Microsoft Windows 起始的系統起始的程式。 例如，[選項] 對話方塊是使用者起始的，但會議提醒是程式已起始。
-   內容視窗是使用者起始的視窗，與啟動它的物件具有強式關聯性。 例如，內容功能表或通知區域圖示所顯示的視窗是內容相關的，但功能表列所顯示的視窗則不是。
-   作用中的監視器是使用中的程式正在執行的監視器。
-   預設監視器是具有 [開始] 功能表、工作列和通知區域的監視器。

## <a name="design-concepts"></a>設計概念

視窗管理是其中一個最基本的使用者活動。 在 Windows Vista 之前，Windows 通常會獲得小型的預設大小並放在畫面中間。 這種方法適用于較舊的單一低解析度監視器，但不適用於新式的影片硬體。

Windows 是設計用來支援新式的影片硬體，其通常會以比最低支援螢幕解析度更高的解析度來執行，而且可能會有多個監視器。 這樣做：

-   可讓使用者完全受益于其先進的硬體。
-   使用者需要較少的時間將滑鼠移動到更遠的距離。
-   讓視窗放置更容易預測，因此更容易尋找。

### <a name="the-minimum-supported-screen-resolution"></a>支援的最低螢幕解析度

Windows 所支援的最小[有效螢幕解析度](glossary.md)是800x600 圖元。 這表示固定大小的視窗應該會完全以最小解析度顯示 (同時保留工作列) 的空間，但可調整大小的視窗可針對1024圖元的有效解析度進行優化，前提是它們可在最低解析度上運作。

目前 Windows 電腦最常見的實體螢幕解析度是1024x768 圖元或更高，以800x600 圖元為目標可讓 Windows：

-   適用于所有新式硬體，包括小型筆記本電腦。
-   支援每英寸高 DPI (點) 設定。
-   支援較大的協助工具。
-   支援以全球為基礎使用的硬體。

選擇要支援的最低解析度需要具有適當的平衡。 以較高的解析度為目標，會導致高達大量新式硬體的效能，而以較低的解析度為目標，會使設計工具無法充分利用可用的螢幕空間。

如果您認為您的目標使用者使用的解析度明顯高於 Windows 的最小值，您可以設計程式以充分利用額外的螢幕空間，方法是使用可調整大小的視窗來進行適當調整。

## <a name="guidelines"></a>指導方針

### <a name="general"></a>一般

-   **支援800x600 圖元的最小 Windows 有效解析度。** 對於必須在安全模式下運作的重要使用者介面 (Ui) ，支援有效的640x480 圖元解析度。 請務必考慮工作列所使用的空間，其方式是針對顯示在工作列上的 windows 保留48垂直 [相對圖元](glossary.md) 。
-   **優化可調整大小的視窗版面配置，以有效解決1024圖元。** 以仍可正常運作的方式，自動調整這些視窗的大小以取得較低的螢幕解析度。
-   **請務必以 96 DPI 測試您的 windows (100%) 為800x600 圖元、120 DPI (125%) （1024x768 圖元）和 144 DPI (150%) 1200x900 圖元。** 檢查是否有版面配置問題，例如剪輯控制項、文字和視窗的裁剪，以及縮放圖示和點陣圖。
-   **針對具有觸控和行動使用案例的程式，請針對 120 DPI 進行優化。** 高 DPI 螢幕目前在觸控和行動電腦上很普遍。
-   可重 **設大小的視窗不再需要** 在右下角顯示調整大小圖像，因為：
    -   視窗的所有邊和邊緣都可以調整大小，而不只是右下角。
    -   圖像需要狀態列才能顯示，但許多可調整大小的視窗都不會提供狀態列。
    -   可調整大小的視窗框線和調整大小指標在通訊時更有效率，因為視窗可調整大小，而不是調整大小圖像

### <a name="title-bar-controls"></a>標題列控制項

使用標題列控制項，如下所示：

-   **關閉。** 所有具有標準視窗框架的主要和次要視窗都應該在標題列上有一個 [關閉] 按鈕。 按一下 [關閉] 具有取消或關閉視窗的效果。

![對話方塊的螢幕擷取畫面，沒有 [關閉] 按鈕 ](images/win-window-mgt-image1.png)

在此範例中，對話方塊的標題列中沒有 [關閉] 按鈕。

-   **最小 化。** 所有主視窗和長時間執行的非模式次要 windows (例如進度對話方塊) 都應該有最小化按鈕。 按一下 [最小化] 可減少視窗的工作列按鈕。 因此，可以最小化的視窗需要標題列圖示。
-   **最大化/還原。** 所有可調整大小的視窗都應該有最大化/還原按鈕。 按一下 [最大化] 會以最大的大小顯示視窗，大部分的視窗都是全螢幕;按一下 [還原] 會將視窗顯示為先前的大小。 但是，有些視窗無法利用全螢幕來獲益，因此這些視窗應該最充分發揮最大的可用大小。

### <a name="window-size"></a>視窗大小

-   **選擇適合其內容的預設視窗大小。** 如果您可以有效地使用空間，請不要害怕使用較大的初始視窗大小。
-   **請盡可能使用可調整大小的視窗，以避免捲軸和截斷的資料。** 具有動態內容和清單的 Windows，從可調整大小的視窗獲益最大。
-   **針對文字檔，請考慮使用最大的行長度65個字元** ，讓文字更容易閱讀。  (字元包含字母、標點符號和空格。 ) 
-   固定大小的視窗：
    -   **必須完全可見並調整大小，才能納入工作區域中。**
-   可調整大小的視窗：
    -   **可以針對較高的解析度進行優化，但在顯示時視需要調整為實際螢幕解析度的大小。**
    -   **對於逐漸較大的視窗大小，必須顯示漸進詳細資訊。** 請確定至少有一個視窗部分或控制項具有可調整大小的內容。
    -   **應避免預設的還原大小最大化或接近最接近的大小。** 相反地，請選擇通常最有用的預設大小，而不是全螢幕。 假設使用者會將視窗最大化，而不是調整大小，使其成為全螢幕。
    -   **如果大小低於，表示內容無法再使用，則應該設定最小的視窗大小。** 針對可調整大小的控制項，請將可調整大小下限的元素大小設定為其最小的功能大小，例如清單視圖中的最小功能性
    -   **如果這麼做，則應該變更簡報，讓內容可以使用較小的大小。**

![media player 按鈕的螢幕擷取畫面 ](images/win-window-mgt-image2.png)

在此範例中，Windows Media Player 會在視窗對標準格式變得太小時變更其格式。

### <a name="window-location"></a>視窗位置

-   **針對下列指導方針，「置中」表示會稍微朝監視器頂端稍微放置垂直位置，而不是完全放在中間。** 將監視/擁有者頂端和視窗頂端之間的空間占45%，並將監視器/擁有者和視窗底端之間的55% 放在最上層。 這樣做的原因是因為眼睛自然偏尖到畫面頂端。

    ![視窗的圖稍微放在中央 ](images/win-window-mgt-image3.png)

    「置中」意指稍微朝監視器頂端稍微放置垂直位置。

-   **如果視窗是內容相關的，請一律將它顯示在其啟始物件附近。** 將它放在外，使來源物件不會包含在視窗中。

    -   如果使用滑鼠來顯示，則可能的話，它會向下和向右位移。

    ![內容視窗放置於物件右邊的圖 ](images/win-window-mgt-image4.png)

    顯示與其啟始物件接近的內容視窗。

    ![通知區域視窗的圖 ](images/win-window-mgt-image5.png)

    從通知區域圖示啟動的 Windows 會顯示在通知區域附近。

-   如果使用畫筆來顯示，可能的話，就可以將它放在使用者手中。 針對右手許可權的使用者，向左顯示;否則會顯示在右側。

    ![內容視窗放置於物件左方的圖 ](images/win-window-mgt-image6.png)

    使用畫筆時，也會顯示內容視窗，使其不會涵蓋在使用者的手中。

-   **開發人員：** 您可以使用 [GetMessageExtraInfo](../tablet/system-events-and-mouse-messages.md) API 來區分滑鼠事件和畫筆事件。 您可以使用[SystemParametersInfo](/windows/win32/api/winuser/nf-winuser-systemparametersinfoa) API 搭配 SPI GETMENUDROPALIGNMENT 來判斷使用者的[handedness](/previous-versions/ms819495(v=msdn.10)) \_ 。
-   **將進度對話方塊放在主動監視器右下角的位置。**

    ![右下角的進度列圖 ](images/win-window-mgt-image7.png)

    在右下角放置進度對話方塊。

-   **如果視窗與目前的內容或使用者動作無關，請將它放在目前的指標位置之外。** 這樣做可避免意外的互動。
-   **如果視窗是最上層應用程式或檔，請一律將其來源從監視器左上角串聯。** 如果是由使用中的程式所建立，請使用主動監視;否則，請使用預設監視。

    ![從左上角三個 windows 串聯的圖 ](images/win-window-mgt-image8.png)

    將最上層應用程式或檔視窗從監視的左上角下層。

-   **如果視窗是最上層的公用程式，請一律在監視器中將其顯示為「中央」。** 如果是由使用中的程式所建立，請使用主動監視;否則，請使用預設監視。

    ![位於監視器中央之公用程式視窗的圖 ](images/win-window-mgt-image9.png)

    中央最上層的公用程式視窗。

-   **如果視窗是擁有的視窗，一開始會將它「置中」顯示在擁有者視窗的頂端。** 針對後續顯示，請考慮將它顯示在其最後一個位置 (相對於擁有者視窗) 如果這麼做，可能會比較方便。

    ![擁有的視窗以擁有者視窗為中心的圖表 ](images/win-window-mgt-image10.png)

    在主控視窗的最上層，最初擁有的視窗。

-   **若為非強制回應對話方塊，一律會先顯示在主控視窗的頂端，讓他們可以輕鬆地找到。** 不過，如果使用者啟動擁有者視窗，則可能會混淆非強制回應對話方塊。

    ![擁有者視窗的非強制回應對話方塊圖 ](images/win-window-mgt-image11.png)

    先在主控視窗頂端顯示非強制回應對話方塊，讓他們更容易尋找。

-   **如有必要，請調整初始位置，讓整個視窗顯示在目標監視器內。** 如果可調整大小的視窗大於目標監視器，請將它縮小為適當大小。

### <a name="window-order-z-order"></a>視窗順序 (Z 順序) 

-   **一律將擁有的視窗置於其擁有者視窗的最上層。** 絕對不要將擁有的視窗放在其擁有者視窗下，因為最有可能的使用者看不到它們。
-   **遵循使用者的 Z 順序選取範圍。當使用者選取視窗時，只會顯示與該程式實例相關聯的視窗， (視窗中，再加上任何擁有者或擁有的 windows) 至 Z 順序的最上層。** 請勿變更任何其他視窗的順序，例如相同程式的獨立實例。

### <a name="window-activation"></a>視窗啟用

-   **考慮使用者的視窗狀態選擇。如果現有的視窗需要注意，請將工作列按鈕閃爍三次，以強調顯示並將其醒目提示，但不進行任何其他動作。** 請勿還原或啟動視窗。 請勿使用任何音效效果。 相反地，讓使用者在準備就緒時啟動視窗。
    -   **例外狀況：** 如果視窗未出現在工作列上，請將它移至所有其他視窗的頂端，並改為將其標題列閃爍。
-   **還原主視窗也應還原其所有的次要** 視窗，即使這些次要視窗有自己的工作列按鈕。 還原時，請將次要視窗放在主視窗的最上層。

### <a name="input-focus"></a>輸入焦點

-   **使用者起始的動作所顯示的 Windows 應該會取得輸入焦點，但只有在視窗立即轉譯時，才** 會 () 。 轉譯視窗之後，就可以將輸入焦點放在一次。
    -   如果視窗轉譯慢 (5 秒以上) ，使用者可能會在等待時執行另一項工作。 在此時取得焦點將會造成干擾，特別是在執行一次以上的時候。
-   **系統起始的動作不會立即顯示或顯示的 Windows 不應取得輸入焦點。** 相反地，在上方顯示時不會有焦點，並讓使用者在準備就緒時啟動它們。
    -   **例外狀況：** 認證管理員。

### <a name="persistence"></a>持續性

-   **重新顯示視窗時，請考慮將它顯示為與上次存取相同的狀態。** 當關閉時，會將使用的監視器、視窗大小、位置和狀態 (最大化與還原) 。 重新調整時，請使用適當的監視來還原已儲存的視窗大小、位置和狀態。 此外，請考慮以每個使用者為基礎，將這些屬性保存在程式實例之間。 **異常：**
    -   當使用者使用時，請勿儲存或讓這些屬性保留給 windows，讓使用者更有可能想要完全從頭開始。
    -   針對 Windows Tablet 及觸控技術電腦上可能使用的程式，請為橫向和縱向模式儲存兩個 Windows 狀態。 如需詳細資訊，請參閱 [設計不同的顯示大小](/previous-versions/windows/desktop/ms695587(v=vs.85))。
-   **如果目前的監視設定防止使用其上次狀態顯示視窗：**
    -   嘗試使用其最後一個監視器來顯示視窗。
    -   如果視窗大於監視器，請視需要調整視窗的大小。
    -   視需要將位置移至左上角，以納入監視器內。
    -   如果上述步驟無法解決問題，請還原成預設視窗放置指導方針。 如果可能的話，請考慮還原先前的大小。

 

 