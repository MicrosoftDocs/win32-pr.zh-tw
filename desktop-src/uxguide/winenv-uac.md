---
title: " (設計基本概念) 的使用者帳戶控制"
description: 設計完善的使用者帳戶控制體驗，可協助您以可預測的方式來避免不必要的全系統變更，並需要進行極低的努力。
ms.assetid: c4b83537-c600-4b24-bda6-df7a82719ab1
ms.topic: article
ms.date: 10/20/2020
ms.openlocfilehash: b346e5cb581ac83ad2ebffabe73c5fbed636d814
ms.sourcegitcommit: 3bdf30edb314e0fcd17dc4ddbc70e4ec7d3596e6
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 02/10/2021
ms.locfileid: "104571383"
---
# <a name="user-account-control"></a>使用者帳戶控制

> [!NOTE]
> 此設計指南是針對 Windows 7 所建立，而且尚未針對較新版本的 Windows 更新。 大部分的指引仍然適用于準則，但展示和範例不會反映我們目前的 [設計指引](/windows/uwp/design/)。

設計完善的使用者帳戶控制體驗，可協助您以可預測的方式來避免不必要的全系統變更，並需要進行極低的努力。

使用「使用者帳戶控制」 (UAC) 完全啟用的情況下，互動式系統管理員通常會以最少的使用者權限執行，但他們可以自行提高許可權，以執行系統管理工作，方法是授與同意 UI 的明確同意。 這類系統管理工作包括安裝軟體和驅動程式、變更全系統設定、查看或變更其他使用者帳戶，以及執行系統管理工具。

在最低許可權狀態下，系統管理員稱為受保護的系統管理員。 在提高許可權的狀態下，它們稱為提高許可權的系統管理員。 相反地，標準使用者無法自行提升，但可以要求系統管理員使用認證 UI 來提高許可權。 內建的系統管理員帳戶不需要提高許可權。

![[允許程式] 安全性訊息的螢幕擷取畫面 ](images/winenv-uac-image1.png)

同意 UI，用來提高受保護的系統管理員許可權。

![要求密碼之訊息的螢幕擷取畫面 ](images/winenv-uac-image2.png)

認證 UI，用來提升標準使用者的許可權。

UAC 提供下列優點：

-   它可減少以較高許可權執行的程式數目，因此有助於防止使用者不小心變更其系統設定，並協助防止「惡意程式碼」取得全系統的存取權。 當您拒絕提高許可權時，惡意程式碼只會影響目前使用者的資料。 如果沒有提高許可權，惡意程式碼就無法進行全系統的變更或影響其他使用者。
-   針對 [受控環境](glossary.md)，設計完善的 UAC 體驗讓使用者在以標準使用者的身份執行時，可以藉由移除不必要的限制來提高生產力。
-   它讓標準使用者可以要求系統管理員授與他們在其目前會話中執行系統管理工作的許可權。
-   針對家用環境，它能讓您更妥善掌控全系統的變更，包括已安裝的軟體。

**開發人員：** 如需瞭解執行資訊，請參閱重新 [設計您的 UI 以獲得 UAC 相容性](/previous-versions/bb756990(v=msdn.10))。

在 Windows Vista 中，受保護的系統管理員可以選擇收到所有系統變更或無的通知。 UAC 預設設定是要通知所有變更，不論其來源為何。 當您收到通知時，您的桌面會變成暗灰色，而且您必須在 UAC 對話方塊中核准或拒絕要求，才能在電腦上進行任何其他動作。 您的桌面變暗，稱為 [安全桌面](glossary.md) ，因為其他程式在暗灰色時無法執行。

除了 Windows Vista 中的兩者之外，Windows 7 還引進了兩個受保護系統管理員的中繼 UAC 設定。 第一個是要在程式進行變更時通知使用者，讓系統管理員在進行變更時自動提升許可權。 這是 Windows 7 中的 UAC 預設設定，也會使用安全桌面。

Windows 7 中的第二個中繼設定與第一個設定相同，差別在於它不會使用安全桌面。

![windows 7 中四個 uac 設定的螢幕擷取畫面 ](images/winenv-uac-image3.png)

Windows 7 引進兩個中繼 UAC 設定。

**注意：** 與撰寫程式 [代碼以支援使用者帳戶控制](/previous-versions/aa905330(v=msdn.10)) 相關的指導方針會在個別的文章中顯示。

## <a name="design-concepts"></a>設計概念

**目標**

設計完善的使用者帳戶控制體驗具有下列目標：

-   **消除不必要的提高許可權。** 使用者只需要提升才能執行需要系統管理許可權的工作。 所有其他工作都應設計成免除提高許可權的需求。 舊版軟體通常需要系統管理員許可權，方法是寫入 HKLM 或 HKCR 登錄區段，或是程式檔或 Windows 系統資料夾。
-   **可預測。** 標準使用者必須知道哪些工作需要系統管理員執行，或無法在受管理的環境中執行。 系統管理員需要知道哪些工作需要提高許可權。 如果他們無法精確地預測提高許可權的需求，則在不應的情況下，他們比較可能會同意系統管理工作。
-   **需要很簡單的工作。** 需要系統管理許可權的工作應該設計為需要單一提升許可權。 需要多次提升的工作很快就會變得很繁瑣。
-   **還原為最低許可權。** 一旦需要系統管理許可權的工作完成後，程式應還原為最低許可權狀態。

**提高許可權工作流程**

當工作需要提高許可權時，它會執行下列步驟：

1.  **進入點。** 當 UAC 完全啟用時需要立即提高許可權的工作，會有以 UAC 防護標示的進入點。 在這種情況下，使用者應該會在按下這類命令之後立即看到提高許可權的 UI，而且當他們從沒有防護罩的工作看到提高許可權的 UI 時，應該要特別小心。

    ![uac 盾牌圖示及其標籤的螢幕擷取畫面 ](images/winenv-uac-image4.png)

    在此範例中，[家長監護] 和 [使用者帳戶] 控制台專案需要提高許可權。

    當 UAC 已部分啟用或完全關閉時，仍會顯示 UAC 防護，以指出工作牽涉到系統層級變更，因此需要提高許可權，即使使用者可能看不到提高許可權的 UI 也是如此。 一律針對需要提高許可權的工作顯示 UAC 防護，讓 UI 保持簡單且可預測。

2.  **海拔。** 針對受保護的系統管理員，此工作會使用同意 UI 要求同意。 針對標準使用者，此工作會使用認證 UI 要求系統管理員認證。

    ![兩種許可權類型的螢幕擷取畫面 ](images/winenv-uac-image5.png)

    這些範例會顯示認證 UI 和同意 UI。

3.  **個別提高許可權的進程。** 就內部而言，會建立新的提高許可權程式來執行工作。
4.  **還原為最低許可權。** 如有必要，請還原為最低許可權，以完成任何不需要提高許可權的步驟。

請注意，工作不會「記住」提高許可權的狀態。 例如，如果使用者在嚮導的提高許可權進入點上來回流覽，則使用者必須每次都提升許可權。

## <a name="usage-patterns"></a>使用模式

「使用者帳戶控制」有數種使用模式 (依喜好) 順序排列：

1.  **適用于標準使用者。** 將其範圍限制為目前的使用者，以設計所有使用者的功能。 藉由將設定限制為目前使用者 (而非全系統) ，您就不需要完全提高提高許可權的 UI，並讓使用者完成工作。

    **不正確：**

    ![訊息的螢幕擷取畫面：您沒有許可權 ](images/winenv-uac-image6.png)

    在此範例中，Windows XP 使用者必須具有系統管理許可權，才能查看或變更目前的時區。

    **正確：**

    ![[日期和時間] 對話方塊的螢幕擷取畫面 ](images/winenv-uac-image7.png)

    在此範例中，Windows 7 和 Windows Vista 中的時區功能已經過重新設計，可供所有使用者使用。

2.  **為標準使用者和系統管理員提供個別的 UI 元素。** 明確地分隔標準使用者工作與系統管理工作。 讓所有使用者都能存取有用的唯讀資訊。 使用 UAC 防護來清楚識別系統管理工作。

    ![uac 盾牌的圖形，顯示需要提高許可權 ](images/winenv-uac-image8.png)

    在此範例中，[系統控制台] 專案會對所有使用者顯示其狀態，但變更全系統設定需要提高許可權。

3.  **允許標準使用者嘗試工作，並在失敗時提升許可權。** 如果標準使用者可以查看資訊，而且可以進行一些變更，而不需要提高許可權，請允許他們存取 UI，而且只有在工作失敗時才會提升許可權。 當標準使用者的存取權有限時（例如，在 Windows 檔案總管中具有自己檔案的屬性），這種方法很適合。 它也適用于主控台混合式中樞頁面上的設定。

    ![[拒絕存取] 訊息的螢幕擷取畫面 ](images/winenv-uac-image9.png)

    在此範例中，使用者嘗試變更程式檔案屬性，但沒有足夠的許可權。 使用者可以提升許可權，然後再試一次。

4.  **僅適用于系統管理員。** 這種方法只適用于系統管理員功能和程式！ 如果功能僅供系統 (管理員使用，且沒有適用于標準使用者) 的導覽路徑或有用的唯讀資訊，您可以在顯示任何 UI 之前，在進入點提示輸入系統管理員認證。 當所有路徑都需要系統管理許可權時，請使用此方法來處理冗長的嚮導和 [分頁流程](glossary.md) 。

    如果整個程式僅供系統管理員，請將它標示為提示輸入系統管理員認證，才能啟動。 Windows 會顯示具有 UAC 防護覆迭的程式圖示。

    ![windows 標誌和 uac 防護的螢幕擷取畫面 ](images/winenv-uac-image10.png)

    在此範例中，程式需要系統管理許可權才能啟動。

## <a name="guidelines"></a>指導方針

### <a name="uac-shield-icon"></a>UAC 防護圖示

-   **使用 uac 防護顯示控制項，指出當 uac 完全啟用時，工作需要立即提高許可權，** 即使 uac 目前未完全啟用也是如此。 如果 wizard 和 [頁面流程](glossary.md) 的所有路徑都需要提高許可權，請在工作的進入點顯示 UAC 盾牌。 UAC 防護的適當使用可協助使用者在需要提高許可權時進行預測。
-   **如果您的程式支援多個版本的 Windows，如果至少有一個版本需要提高許可權，就會顯示 UAC 防護程式。** 由於 Windows XP 不需要提高許可權，因此如果您可以一致且不會危害效能，請考慮移除 Windows XP 的 UAC 防護。
-   **請勿在大部分內容中都不需要提高許可權的工作上顯示 UAC 防護板。** 因為這種方法有時會造成誤導，所以慣用的方法是改為使用適當受防護的內容相關命令。

    ![windows explorer 中相片檔案的螢幕擷取畫面 ](images/winenv-uac-image11.png)

    因為 [新增資料夾] 命令只會在系統資料夾中使用時才需要提高許可權，所以不會顯示 UAC 盾牌。

-   UAC 防護可以顯示在下列控制項上：

    **命令按鈕：**

    ![具有 uac 防護圖示的命令按鈕螢幕擷取畫面 ](images/winenv-uac-image12.png)

    需要立即提高許可權的命令按鈕。

    **命令連結：**

    ![具有 uac 防護圖示的命令連結螢幕擷取畫面 ](images/winenv-uac-image13.png)

    需要立即提高許可權的命令連結。

    **連結：**

    ![變更帳戶連結與 uac 防護板的螢幕擷取畫面 ](images/winenv-uac-image14.png)

    需要立即提高許可權的連結。

    **功能表：**

    ![具有 uac 防護功能表的螢幕擷取畫面 ](images/winenv-uac-image15.png)

    需要立即提高許可權的下拉式功能表。

-   因為工作不記得提高的狀態，請 **不要變更 UAC 防護以反映狀態。**
-   **即使已關閉使用者帳戶控制或使用者使用內建的系統管理員帳戶，也會顯示 UAC 防護程式。** 以一致的方式顯示 UAC 防護程式更容易進行程式設計，並且為使用者提供工作本質的相關資訊。

### <a name="elevation"></a>Elevation

-   **可能的話，請在不提高許可權的情況下，由標準使用者執行設計工作。** 讓所有使用者都能存取有用的唯讀資訊。
-   **針對每個工作（而不是每個設定）來提高許可權。** 請勿在單一頁面或對話方塊中，以系統管理設定來混合標準使用者設定。 例如，如果標準使用者可以變更部分（而非全部）設定，請將這些設定分割為個別的 UI 介面。

    **不正確：**

    ![[日期和時間設定] 對話方塊的螢幕擷取畫面 ](images/winenv-uac-image16.png)

    在此範例中，標準使用者設定與系統管理設定不正確地混合。

    **正確：**

    ![相同對話方塊沒有 uac 防護的螢幕擷取畫面 ](images/winenv-uac-image17.png)

    在此範例中，變更日期和時間的設定位於個別的對話方塊中，僅適用于系統管理員。 時區設定可供標準使用者使用，且不會與系統管理設定混合。

-   **決定是否應該顯示或停用控制項時，請勿考慮需要提高許可權。** 原因：
    -   在未受管理的環境中，假設標準使用者可以藉由要求系統管理員來提升許可權。 停用需要提高許可權的控制項，會使使用者無法讓系統管理員提升許可權。
    -   在受控環境中，假設標準使用者完全無法提升許可權。 移除需要提高許可權的控制項，可防止使用者知道何時停止查看。
-   **若要排除不必要的提高許可權：**
    -   **如果工作可能需要提高許可權，請盡可能延遲提升。** 如果工作需要 [確認](mess-confirm.md)，請在使用者確認之後才顯示提高許可權的 UI。 如果工作一律需要提高許可權，請在其進入點提升許可權。
    -   **提高許可權之後，請保持提高許可權，直到不再需要較高的許可權為止。** 使用者不應該需要提高多次來執行單一工作。
    -   **如果使用者必須提升以進行變更，但選擇不進行任何變更，請將正面的認可按鈕保持在啟用狀態，但將認可處理為取消。** 這麼做可讓使用者不需要提高許可權就能關閉視窗。
    -   **不正確：**
    -   ![視窗的螢幕擷取畫面，其中只有一個作用中的按鈕 ](images/winenv-uac-image18.png)
    -   在此範例中，[儲存變更] 按鈕會停用，以避免不必要的提高許可權，但會在使用者變更選取專案時變成啟用狀態。 不過，已停用的 [認可] 按鈕讓使用者看起來好像沒有選擇。
-   **當工作失敗時，不會顯示錯誤訊息，因為使用者選擇不提升許可權。** 假設使用者刻意選擇不繼續，因此不會將這種情況視為錯誤。

    **不正確：**

    ![訊息的螢幕擷取畫面： fabrikam restore 無法執行 ](images/winenv-uac-image19.png)

    在此範例中，如果使用者決定不提升許可權，Fabrikam 還原會錯誤地提供錯誤訊息。

-   **請勿顯示警告，以說明使用者可能需要提高其許可權來執行工作。** 讓使用者自行探索此事實。
-   **根據下表顯示 UAC 防護和提高許可權的 UI：**

    |                       |                                                                                                                                                                  |                                                                                                                                                                                                                       |                                                                                                      |
    |-----------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------|
    | **Object**      | **情況**                                                                                                                                                | **放置 UAC 防護的位置**                                                                                                                                                                               | **提升時機**                                                                            |
    | 程式<br/>    | 整個程式只適用于系統管理員。<br/>                                                                                                            | ![windows 標誌和 uac 防護的螢幕擷取畫面 ](images/winenv-uac-image10.png)<br/> 程式圖示上的 UAC 防護程式圖示。<br/>                                                                       | 在啟動時顯示提高許可權的 UI。<br/>                                                           |
    | 命令<br/>    | 整個命令僅適用于系統管理員。<br/>                                                                                                            | ![變更帳戶連結和 uac 防護的螢幕擷取畫面 ](images/winenv-uac-image14.png)<br/> 命令按鈕或連結上的 UAC 盾牌。<br/>                                                                      | 當按下命令按鈕或連結時，但在任何確認之後，顯示提高許可權的 UI。<br/> |
    | 命令<br/>    | 命令會顯示適用于所有使用者的實用唯讀資訊，但變更需要系統管理許可權。<br/>                               | ![變更設定連結和 uac 防護的螢幕擷取畫面 ](images/winenv-uac-image8.png)<br/> 命令按鈕上的 UAC 防護或連結以進行變更。<br/>                                                      | 當您按一下 [命令] 按鈕時，但在任何確認之後，顯示提高許可權的 UI。<br/>         |
    | 命令<br/>    | 標準使用者可以查看資訊，而且可能會進行一些變更，而不需要提高許可權。 允許標準使用者嘗試，並在失敗時提升許可權。<br/> | ![[重試] 按鈕上 uac 圖示錯誤的螢幕擷取畫面 ](images/winenv-uac-image9.png)<br/> 不要顯示命令的 UAC 防護程式，但如果命令失敗，則顯示為提高許可權進入點。<br/> | 當使用者重試命令時顯示提高許可權的 UI。<br/>                                       |
    | 工作步驟<br/>  | 所有後續步驟都需要提高許可權。<br/>                                                                                                               | ![使用 uac 防護的下一個命令按鈕的螢幕擷取畫面 ](images/winenv-uac-image20.png)<br/> [下一步] 按鈕上的 UAC 盾牌 (或對等的) 。<br/>                                                                | 按一下 [下一步] 或 [其他認可] 按鈕時，顯示提高許可權的 UI。<br/>                         |
    | 工作步驟<br/>  | 某些分支需要提高許可權。<br/>                                                                                                                      | ![命令連結與 uac 防護板的螢幕擷取畫面 ](images/winenv-uac-image21.png)<br/> 需要提高許可權的命令連結上有 UAC 防護。<br/>                                                              | 按一下具有 UAC 盾牌的命令連結時，顯示提高許可權的 UI。<br/>                      |

    

     

### <a name="elevation-ui"></a>提高許可權 UI

-   **如果使用者提供的帳戶無效 (名稱或密碼) 或沒有系統管理員許可權，請只重新顯示認證 UI。** 不要顯示錯誤訊息。
-   **如果使用者取消認證 UI，請將使用者回到原始的 UI。** 不要顯示錯誤訊息。
-   如果使用者帳戶控制已關閉，而標準使用者嘗試執行需要提高許可權的工作，請提供錯誤訊息，指出「此工作需要系統管理員許可權。 若要執行這項工作，您必須使用系統管理員帳戶登入。」

![工作需要許可權訊息的螢幕擷取畫面 ](images/winenv-uac-image22.png)

在此範例中，使用者帳戶控制已關閉，因此會出現錯誤訊息，說明使用者必須使用系統管理員帳戶。

### <a name="wizards"></a>精靈

-   **不要多次提升。** 當嚮導提高許可權之後，就應該保持提高許可權。
-   如果工作是在嚮導內執行，請在認可頁面的 [下一步] 按鈕上放入 UAC 盾牌 (應提供更 [明確的標籤](win-wizards.md)) 。 當使用者認可時：
    -   如果下一頁是進度頁面，請移至該頁面，並以強制回應方式顯示提高許可權的 UI。 在成功提升許可權之後，請執行此工作。
    -   如果下一頁是 [完成] 頁面，請移至該頁面 (但暫時將其內容取代為 [正在等候許可權 ...] ) ，並以強制回應方式顯示提高許可權的 UI。 在成功提升許可權之後，請執行工作，然後顯示完成頁面內容。
    -   如果使用者取消提高許可權的 UI，請返回 [認可] 頁面。 這麼做可讓使用者再試一次。
-   如果工作是在 wizard 完成後執行，請在認可頁面的 [完成] 按鈕上放入 UAC 盾牌 (應提供更 [明確的標籤](win-wizards.md)) 。 當使用者認可時：
    -   維持在 [認可] 頁面，並以強制回應方式顯示提高許可權的 UI。 在成功提升許可權之後，請關閉嚮導。
    -   如果使用者取消提高許可權的 UI，請返回 [認可] 頁面。 這麼做可讓使用者再試一次。
-   針對僅供系統管理員的冗長的系統管理員，您可以在顯示任何 UI 之前，在進入點提示輸入系統管理員認證。

## <a name="text"></a>Text

-   **請不要使用省略號，因為命令需要提高許可權。** 要提高許可權的需要以 UAC 防護來表示。

## <a name="documentation"></a>文件

參考使用者帳戶控制時：

-   請參閱「使用者帳戶控制」 (第一次提及) 或 UAC (後續提及的) ，而不是最低許可權的使用者帳戶或 LUA。
-   請以標準使用者身分參閱非系統管理員。
-   請將內建的電腦系統管理員稱為內建的系統管理員。

在使用者檔中：

-   請參閱授與同意以授與許可權給執行系統管理工作的動作。

在程式設計和其他技術檔中：

-   請參閱授與同意以提高許可權執行系統管理工作的動作。
-   在 UAC 的內容中，如果沒有提高許可權，請將系統管理員稱為受保護的系統管理員，並在提高許可權之後，將系統管理員視為
-   請參閱用來輸入密碼做為認證 UI 的對話方塊。 請參閱用來將同意授與同意 UI 的對話方塊。 請參閱兩者一般都是提高許可權的 UI。

