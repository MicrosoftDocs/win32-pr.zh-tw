---
title: 配置 New-winevent 識別碼
description: 每個 New-winevent 僅供特定用途使用。 針對非預期的目的使用 New-winevent 可能會導致與其他應用程式或作業系統發生衝突，而導致應用程式或作業系統變得不穩定。
ms.assetid: 956d6db4-f342-4b11-bfd9-92725284223f
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f339641e5a3b679f572bc3b60c3e68be7b65f2a3
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/20/2020
ms.locfileid: "107001080"
---
# <a name="allocation-of-winevent-ids"></a><span data-ttu-id="226e6-104">配置 New-winevent 識別碼</span><span class="sxs-lookup"><span data-stu-id="226e6-104">Allocation of WinEvent IDs</span></span>

<span data-ttu-id="226e6-105">每個 New-winevent 僅供特定用途使用。</span><span class="sxs-lookup"><span data-stu-id="226e6-105">Each WinEvent is intended to be used only for a specific purpose.</span></span> <span data-ttu-id="226e6-106">針對非預期的目的使用 New-winevent 可能會導致與其他應用程式或作業系統發生衝突，而導致應用程式或作業系統變得不穩定。</span><span class="sxs-lookup"><span data-stu-id="226e6-106">Using a WinEvent for an unintended purpose can cause collisions with other applications or the operating system, which can cause the applications or operating system to become unstable.</span></span>

<span data-ttu-id="226e6-107">Microsoft 定義了數種不同的 WinEvents 類別，每個類別目錄都定義了一或多個範圍的值，以做為 New-winevent 識別碼使用。</span><span class="sxs-lookup"><span data-stu-id="226e6-107">Microsoft has defined several different categories of WinEvents and, for each category, has defined one or more ranges of values for use as WinEvent IDs.</span></span> <span data-ttu-id="226e6-108"> (0xA000 的「社區保留範圍」（0xAFFF) 適用于需要定義新 WinEvents 的應用程式。</span><span class="sxs-lookup"><span data-stu-id="226e6-108">The Community Reserved range (0xA000—0xAFFF) is available for applications that need to define new WinEvents.</span></span> <span data-ttu-id="226e6-109">使用來自此範圍的值有助於降低衝突的風險;不過，建立新 WinEvents 的開發人員仍然需要共同作業，以避免應用程式之間發生衝突。</span><span class="sxs-lookup"><span data-stu-id="226e6-109">Using values from this range helps reduce the risk of collisions; however, developers who create new WinEvents still need to collaborate to avoid collisions among their applications.</span></span>

<span data-ttu-id="226e6-110">下表顯示 New-winevent 類別目錄，以及針對每個類別目錄定義的值範圍。</span><span class="sxs-lookup"><span data-stu-id="226e6-110">The following table shows the WinEvent categories and the ranges of values defined for each category.</span></span>



| <span data-ttu-id="226e6-111">類別</span><span class="sxs-lookup"><span data-stu-id="226e6-111">Category</span></span>                                                | <span data-ttu-id="226e6-112">範圍</span><span class="sxs-lookup"><span data-stu-id="226e6-112">Range</span></span>         | <span data-ttu-id="226e6-113">目前使用中</span><span class="sxs-lookup"><span data-stu-id="226e6-113">Currently in use</span></span> | <span data-ttu-id="226e6-114">註解</span><span class="sxs-lookup"><span data-stu-id="226e6-114">Comments</span></span>                                                                                        |
|---------------------------------------------------------|---------------|------------------|-------------------------------------------------------------------------------------------------|
| <span data-ttu-id="226e6-115">Microsoft Active Accessibility (系統保留) 的事件</span><span class="sxs-lookup"><span data-stu-id="226e6-115">Microsoft Active Accessibility events (System Reserved)</span></span> | <span data-ttu-id="226e6-116">0x0001-0x00FF</span><span class="sxs-lookup"><span data-stu-id="226e6-116">0x0001-0x00FF</span></span> | <span data-ttu-id="226e6-117">0x0001-0x0020</span><span class="sxs-lookup"><span data-stu-id="226e6-117">0x0001-0x0020</span></span>    | <span data-ttu-id="226e6-118">事件 \_ 系統 \_ \* 事件識別碼</span><span class="sxs-lookup"><span data-stu-id="226e6-118">EVENT\_SYSTEM\_\* event IDs</span></span>                                                                     |
| <span data-ttu-id="226e6-119">Microsoft Active Accessibility (系統保留) 的事件</span><span class="sxs-lookup"><span data-stu-id="226e6-119">Microsoft Active Accessibility events (System Reserved)</span></span> | <span data-ttu-id="226e6-120">0x4001-0x40FF</span><span class="sxs-lookup"><span data-stu-id="226e6-120">0x4001-0x40FF</span></span> | <span data-ttu-id="226e6-121">0x4001-0x4007</span><span class="sxs-lookup"><span data-stu-id="226e6-121">0x4001-0x4007</span></span>    | <span data-ttu-id="226e6-122">事件 \_ 主控台 \_ \* 事件識別碼</span><span class="sxs-lookup"><span data-stu-id="226e6-122">EVENT\_CONSOLE\_\* event IDs</span></span>                                                                    |
| <span data-ttu-id="226e6-123">消費者介面自動化 (系統保留) 的事件</span><span class="sxs-lookup"><span data-stu-id="226e6-123">UI Automation events (System Reserved)</span></span>                  | <span data-ttu-id="226e6-124">0x4E00-0x4EFF</span><span class="sxs-lookup"><span data-stu-id="226e6-124">0x4E00-0x4EFF</span></span> | <span data-ttu-id="226e6-125">0x4E20-0x4E33</span><span class="sxs-lookup"><span data-stu-id="226e6-125">0x4E20-0x4E33</span></span>    | <span data-ttu-id="226e6-126">消費者介面自動化事件識別碼</span><span class="sxs-lookup"><span data-stu-id="226e6-126">UI Automation event IDs</span></span>                                                                         |
| <span data-ttu-id="226e6-127">消費者介面自動化 (系統保留) 的事件</span><span class="sxs-lookup"><span data-stu-id="226e6-127">UI Automation events (System Reserved)</span></span>                  | <span data-ttu-id="226e6-128">0x7500-0x75FF</span><span class="sxs-lookup"><span data-stu-id="226e6-128">0x7500-0x75FF</span></span> | <span data-ttu-id="226e6-129">0x7530-0x759B</span><span class="sxs-lookup"><span data-stu-id="226e6-129">0x7530-0x759B</span></span>    | <span data-ttu-id="226e6-130">消費者介面自動化屬性變更的事件識別碼</span><span class="sxs-lookup"><span data-stu-id="226e6-130">UI Automation property-changed event IDs</span></span>                                                        |
| <span data-ttu-id="226e6-131">Microsoft Active Accessibility (系統保留) 的事件</span><span class="sxs-lookup"><span data-stu-id="226e6-131">Microsoft Active Accessibility events (System Reserved)</span></span> | <span data-ttu-id="226e6-132">0x8000-0x80FF</span><span class="sxs-lookup"><span data-stu-id="226e6-132">0x8000-0x80FF</span></span> | <span data-ttu-id="226e6-133">0x8000-0x8015</span><span class="sxs-lookup"><span data-stu-id="226e6-133">0x8000-0x8015</span></span>    | <span data-ttu-id="226e6-134">事件 \_ 物件 \_ \* 事件識別碼</span><span class="sxs-lookup"><span data-stu-id="226e6-134">EVENT\_OBJECT\_\* event IDs</span></span>                                                                     |
| <span data-ttu-id="226e6-135">OEM 保留</span><span class="sxs-lookup"><span data-stu-id="226e6-135">OEM Reserved</span></span>                                            | <span data-ttu-id="226e6-136">0x0101-0x01FF</span><span class="sxs-lookup"><span data-stu-id="226e6-136">0x0101-0x01FF</span></span> | <span data-ttu-id="226e6-137">0x0101-0x0122</span><span class="sxs-lookup"><span data-stu-id="226e6-137">0x0101-0x0122</span></span>    | <span data-ttu-id="226e6-138">IAccessible2 事件識別碼</span><span class="sxs-lookup"><span data-stu-id="226e6-138">IAccessible2 event IDs</span></span>                                                                          |
| <span data-ttu-id="226e6-139">保留的社區</span><span class="sxs-lookup"><span data-stu-id="226e6-139">Community Reserved</span></span>                                      | <span data-ttu-id="226e6-140">0xA000-0xAFFF</span><span class="sxs-lookup"><span data-stu-id="226e6-140">0xA000-0xAFFF</span></span> | <span data-ttu-id="226e6-141">無</span><span class="sxs-lookup"><span data-stu-id="226e6-141">None</span></span>             | <span data-ttu-id="226e6-142">針對協助工具互通性同盟所定義的新事件保留 (AIA) 規格</span><span class="sxs-lookup"><span data-stu-id="226e6-142">Reserved for new events defined by Accessibility Interoperability Alliance (AIA) specifications</span></span> |
| <span data-ttu-id="226e6-143">ATOM</span><span class="sxs-lookup"><span data-stu-id="226e6-143">ATOM</span></span>                                                    | <span data-ttu-id="226e6-144">0xC000-0xFFFF</span><span class="sxs-lookup"><span data-stu-id="226e6-144">0xC000-0xFFFF</span></span> | <span data-ttu-id="226e6-145">0xC000-0xFFFF</span><span class="sxs-lookup"><span data-stu-id="226e6-145">0xC000-0xFFFF</span></span>    | <span data-ttu-id="226e6-146">保留給在執行時間配置的自訂事件</span><span class="sxs-lookup"><span data-stu-id="226e6-146">Reserved for custom events allocated at runtime</span></span>                                                 |



 

<span data-ttu-id="226e6-147">下列主題會更詳細地描述 New-winevent 範圍。</span><span class="sxs-lookup"><span data-stu-id="226e6-147">The following topics describe the WinEvent ranges in greater detail.</span></span>

## <a name="microsoft-active-accessibility-and-ui-automation-events"></a><span data-ttu-id="226e6-148">Microsoft Active Accessibility 和消費者介面自動化事件</span><span class="sxs-lookup"><span data-stu-id="226e6-148">Microsoft Active Accessibility and UI Automation Events</span></span>

<span data-ttu-id="226e6-149">New-winevent 識別碼的五個範圍保留供 Microsoft Active Accessibility 和 Microsoft 消費者介面自動化使用。</span><span class="sxs-lookup"><span data-stu-id="226e6-149">Five ranges of WinEvent IDs are reserved for use by Microsoft Active Accessibility and Microsoft UI Automation.</span></span> <span data-ttu-id="226e6-150">第一個範圍 (0x0001-0x00FF) 保留給系統層級的事件，通常用來描述影響系統中所有應用程式的情況。</span><span class="sxs-lookup"><span data-stu-id="226e6-150">The first range (0x0001—0x00FF) is reserved for system-level events, typically used for describing situations affecting all applications in the system.</span></span> <span data-ttu-id="226e6-151">第二個範圍 (0x4001-0x40FF) 保留給 Windows 主控台特定的事件。</span><span class="sxs-lookup"><span data-stu-id="226e6-151">The second range (0x4001—0x40FF) is reserved for Windows console-specific events.</span></span> <span data-ttu-id="226e6-152">第三個 (0x4E00-0x4EFF) 和第四個範圍 (0x7500）-0x75FF) 用於反映消費者介面自動化事件。</span><span class="sxs-lookup"><span data-stu-id="226e6-152">The third (0x4E00—0x4EFF) and fourth ranges (0x7500—0x75FF) are for the reflection of UI Automation events.</span></span> <span data-ttu-id="226e6-153">最後，第五個範圍 (0x8000： 0x80FF) 適用于與某個應用程式內物件相關的情況的物件層級事件。</span><span class="sxs-lookup"><span data-stu-id="226e6-153">Lastly, the fifth range (0x8000—0x80FF) is for object-level events that pertain to situations specific to objects within one application.</span></span>

<span data-ttu-id="226e6-154">所有 Microsoft Active Accessibility 和消費者介面自動化事件都定義于 WinUser .h 和 Uiautomationclient.dll. h 標頭檔中。</span><span class="sxs-lookup"><span data-stu-id="226e6-154">All Microsoft Active Accessibility and UI Automation events are defined in the WinUser.h and UIAutomationClient.h header files.</span></span>

## <a name="oem-reserved-events"></a><span data-ttu-id="226e6-155">OEM 保留的事件</span><span class="sxs-lookup"><span data-stu-id="226e6-155">OEM Reserved Events</span></span>

<span data-ttu-id="226e6-156">OEM 保留範圍開放給任何需要使用 WinEvents 做為通訊機制的人。</span><span class="sxs-lookup"><span data-stu-id="226e6-156">The OEM reserved range is open to anyone who needs to use WinEvents as a communication mechanism.</span></span> <span data-ttu-id="226e6-157">開發人員應定義和發佈事件定義以及其參數 (或也可以使用相關聯的物件類型) 以進行事件處理，以便避免事件識別碼意外發生衝突。</span><span class="sxs-lookup"><span data-stu-id="226e6-157">Developers should define and publish event definitions along with their parameters (or also with associated object types) for event processing so that accidental collisions of event IDs can be avoided.</span></span> <span data-ttu-id="226e6-158">IAccessible2 規格會使用 OEM 保留範圍的一部分。</span><span class="sxs-lookup"><span data-stu-id="226e6-158">The IAccessible2 specification uses part of the OEM reserved range.</span></span>

## <a name="community-reserved-events"></a><span data-ttu-id="226e6-159">社區保留事件</span><span class="sxs-lookup"><span data-stu-id="226e6-159">Community Reserved Events</span></span>

<span data-ttu-id="226e6-160">社區保留範圍適用于協助工具互通性同盟 (AIA) 所指定的 WinEvents，可供整個產業使用。</span><span class="sxs-lookup"><span data-stu-id="226e6-160">The Community Reserved range is for WinEvents specified by the Accessibility Interoperability Alliance (AIA) for use across the industry.</span></span> <span data-ttu-id="226e6-161">強烈建議您使用此範圍內的值來定義及發佈官方規格。</span><span class="sxs-lookup"><span data-stu-id="226e6-161">Developers are strongly encouraged to define and publish an official specification before using values from this range.</span></span>

## <a name="atom-events"></a><span data-ttu-id="226e6-162">ATOM 事件</span><span class="sxs-lookup"><span data-stu-id="226e6-162">ATOM Events</span></span>

<span data-ttu-id="226e6-163">ATOM 範圍是保留給在執行時間透過消費者介面自動化擴充性 API 所配置的事件識別碼。</span><span class="sxs-lookup"><span data-stu-id="226e6-163">The ATOM range is reserved for event IDs that are allocated at runtime through the UI Automation extensibility API.</span></span> <span data-ttu-id="226e6-164">請勿將 ATOM 範圍中的值用於任何其他用途。</span><span class="sxs-lookup"><span data-stu-id="226e6-164">Do not use the values from the ATOM range for any other purpose.</span></span> <span data-ttu-id="226e6-165">從 ATOM 範圍配置 WinEvents 的建議方法是使用 [**GlobalAddAtom**](/windows/desktop/api/winbase/nf-winbase-globaladdatoma) 函數搭配字串 GUID。</span><span class="sxs-lookup"><span data-stu-id="226e6-165">Using the [**GlobalAddAtom**](/windows/desktop/api/winbase/nf-winbase-globaladdatoma) function with a string GUID is the recommended method of allocating WinEvents from the ATOM range.</span></span>

## <a name="using-values-from-a-reserved-range"></a><span data-ttu-id="226e6-166">使用保留範圍內的值</span><span class="sxs-lookup"><span data-stu-id="226e6-166">Using Values from a Reserved Range</span></span>

<span data-ttu-id="226e6-167">根據 New-winevent 規格，無法使用系統保留範圍中的值或任何其他未定義的範圍，而不需要修改 SDK。</span><span class="sxs-lookup"><span data-stu-id="226e6-167">According to the WinEvent specification, values from the System Reserved range, or any other non-defined range, cannot be used without revising the SDK.</span></span> <span data-ttu-id="226e6-168">針對新的 WinEvents，應用程式應該使用 OEM 保留或社區保留範圍中的值。</span><span class="sxs-lookup"><span data-stu-id="226e6-168">For new WinEvents, applications should use values from the OEM Reserved or Community Reserved ranges.</span></span> <span data-ttu-id="226e6-169">在使用新的 New-winevent 之前，強烈建議開發人員以公開且廣泛的方式共用其規格，而且應該使用協助工具互通性聯盟來定義 New-winevent 規格。</span><span class="sxs-lookup"><span data-stu-id="226e6-169">Before using a new WinEvent, developers are strongly advised to share their specifications openly and widely, and should work with the Accessibility Interoperability Alliance to define WinEvent specifications.</span></span>

## <a name="related-topics"></a><span data-ttu-id="226e6-170">相關主題</span><span class="sxs-lookup"><span data-stu-id="226e6-170">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="226e6-171">WinEvents</span><span class="sxs-lookup"><span data-stu-id="226e6-171">WinEvents</span></span>](winevents-infrastructure.md)
</dt> <dt>

[<span data-ttu-id="226e6-172">協助工具互通性聯盟</span><span class="sxs-lookup"><span data-stu-id="226e6-172">Accessibility Interoperability Alliance</span></span>](https://www.atia.org/)
</dt> </dl>

 

 