---
title: 執行 Server-Side 消費者介面自動化提供者
description: 本主題說明如何針對以 c + + 撰寫的自訂控制項，執行伺服器端的 Microsoft 消費者介面自動化提供者。
ms.assetid: c3a919b2-8b8c-4dde-ad71-587f3845a9f5
keywords:
- 消費者介面自動化，伺服器端提供者的執行
- 消費者介面自動化，提供者執行
- 消費者介面自動化，執行伺服器端提供者
- 消費者介面自動化，執行提供者
- 伺服器端提供者，執行
- 伺服器端提供者，介面
- 伺服器端提供者，屬性值
- 伺服器端提供者，事件
- 伺服器端提供者，指派新的父系
- 事件、伺服器端提供者
- 介面、伺服器端提供者
- 提供者，實施
- 執行伺服器端提供者
- 實作提供者
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e7fafbb9d03a25eb2e4713330c0622c25d17f9ff
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/20/2020
ms.locfileid: "106965664"
---
# <a name="implement-a-server-side-ui-automation-provider"></a><span data-ttu-id="e3589-117">執行 Server-Side 消費者介面自動化提供者</span><span class="sxs-lookup"><span data-stu-id="e3589-117">Implement a Server-Side UI Automation Provider</span></span>

<span data-ttu-id="e3589-118">本主題說明如何針對以 c + + 撰寫的自訂控制項，執行伺服器端的 Microsoft 消費者介面自動化提供者。</span><span class="sxs-lookup"><span data-stu-id="e3589-118">This topic describes how to implement a server-side Microsoft UI Automation provider for a custom control written in C++.</span></span> <span data-ttu-id="e3589-119">它包含下列區段：</span><span class="sxs-lookup"><span data-stu-id="e3589-119">It contains the following sections:</span></span>

-   [<span data-ttu-id="e3589-120">提供者介面</span><span class="sxs-lookup"><span data-stu-id="e3589-120">Provider Interfaces</span></span>](#provider-interfaces)
-   [<span data-ttu-id="e3589-121">消費者介面自動化提供者的必要功能</span><span class="sxs-lookup"><span data-stu-id="e3589-121">Required Functionality for UI Automation Providers</span></span>](#required-functionality-for-ui-automation-providers)
-   [<span data-ttu-id="e3589-122">屬性值</span><span class="sxs-lookup"><span data-stu-id="e3589-122">Property Values</span></span>](#property-values)
-   [<span data-ttu-id="e3589-123">來自提供者的事件</span><span class="sxs-lookup"><span data-stu-id="e3589-123">Events from Providers</span></span>](#events-from-providers)
-   [<span data-ttu-id="e3589-124">提供者導覽</span><span class="sxs-lookup"><span data-stu-id="e3589-124">Provider Navigation</span></span>](#provider-navigation)
-   [<span data-ttu-id="e3589-125">指派新的父系</span><span class="sxs-lookup"><span data-stu-id="e3589-125">Assigning a New Parent</span></span>](#assigning-a-new-parent)
-   [<span data-ttu-id="e3589-126">提供者重新置放</span><span class="sxs-lookup"><span data-stu-id="e3589-126">Provider Repositioning</span></span>](#provider-repositioning)
-   [<span data-ttu-id="e3589-127">中斷連接提供者</span><span class="sxs-lookup"><span data-stu-id="e3589-127">Disconnecting Providers</span></span>](#disconnecting-providers)
-   [<span data-ttu-id="e3589-128">相關主題</span><span class="sxs-lookup"><span data-stu-id="e3589-128">Related topics</span></span>](#related-topics)

<span data-ttu-id="e3589-129">如需示範如何執行伺服器端提供者的程式碼範例，請參閱 [消費者介面自動化提供者的如何主題](uiauto-howto-topics-for-uiautomation-providers.md)。</span><span class="sxs-lookup"><span data-stu-id="e3589-129">For code examples that show how to implement server-side providers, see [How-To Topics for UI Automation Providers](uiauto-howto-topics-for-uiautomation-providers.md).</span></span>

## <a name="provider-interfaces"></a><span data-ttu-id="e3589-130">提供者介面</span><span class="sxs-lookup"><span data-stu-id="e3589-130">Provider Interfaces</span></span>

<span data-ttu-id="e3589-131">下列元件物件模型 (COM) 介面提供自訂控制項的功能。</span><span class="sxs-lookup"><span data-stu-id="e3589-131">The following Component Object Model (COM) interfaces provide functionality for custom controls.</span></span> <span data-ttu-id="e3589-132">若要提供基本功能，每個消費者介面自動化提供者都必須至少執行 [**IRawElementProviderSimple**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementprovidersimple) 介面。</span><span class="sxs-lookup"><span data-stu-id="e3589-132">To provide basic functionality, every UI Automation provider must implement at least the [**IRawElementProviderSimple**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementprovidersimple) interface.</span></span> <span data-ttu-id="e3589-133">[**IRawElementProviderFragment**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementproviderfragment)和 [**IRawElementProviderFragmentRoot**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementproviderfragmentroot)介面是選擇性的，但應該針對複雜控制項中的元素來執行，以提供額外的功能。</span><span class="sxs-lookup"><span data-stu-id="e3589-133">The [**IRawElementProviderFragment**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementproviderfragment) and [**IRawElementProviderFragmentRoot**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementproviderfragmentroot) interfaces are optional, but should be implemented for elements in a complex control to provide additional functionality.</span></span>



| <span data-ttu-id="e3589-134">介面</span><span class="sxs-lookup"><span data-stu-id="e3589-134">Interface</span></span>                                                                         | <span data-ttu-id="e3589-135">描述</span><span class="sxs-lookup"><span data-stu-id="e3589-135">Description</span></span>                                                                                                                                                                   |
|-----------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="e3589-136">**IRawElementProviderSimple**</span><span class="sxs-lookup"><span data-stu-id="e3589-136">**IRawElementProviderSimple**</span></span>](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementprovidersimple)             | <span data-ttu-id="e3589-137">提供視窗中裝載之控制項的基本功能，包括控制項模式和屬性的支援。</span><span class="sxs-lookup"><span data-stu-id="e3589-137">Provides basic functionality for a control hosted in a window, including support for control patterns and properties.</span></span>                                                         |
| [<span data-ttu-id="e3589-138">**IRawElementProviderFragment**</span><span class="sxs-lookup"><span data-stu-id="e3589-138">**IRawElementProviderFragment**</span></span>](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementproviderfragment)         | <span data-ttu-id="e3589-139">為複雜控制項中的專案新增功能，包括在片段中導覽、設定焦點，以及傳回元素的周框。</span><span class="sxs-lookup"><span data-stu-id="e3589-139">Adds functionality for an element in a complex control, including navigating in the fragment, setting focus, and returning the bounding rectangle of the element.</span></span>             |
| [<span data-ttu-id="e3589-140">**IRawElementProviderFragmentRoot**</span><span class="sxs-lookup"><span data-stu-id="e3589-140">**IRawElementProviderFragmentRoot**</span></span>](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementproviderfragmentroot) | <span data-ttu-id="e3589-141">為複雜控制項中的根項目新增功能，包括在指定的座標尋找子項目，以及設定整個控制項的焦點狀態。</span><span class="sxs-lookup"><span data-stu-id="e3589-141">Adds functionality for the root element in a complex control, including locating a child element at specified coordinates and setting the focus state for the entire control.</span></span> |



 

> [!Note]  
> <span data-ttu-id="e3589-142">在 managed 程式碼的消費者介面自動化 API 中，這些介面會形成繼承階層。</span><span class="sxs-lookup"><span data-stu-id="e3589-142">In the UI Automation API for managed code, these interfaces form an inheritance hierarchy.</span></span> <span data-ttu-id="e3589-143">這不是 c + + 中的情況，其中介面是完全分開的。</span><span class="sxs-lookup"><span data-stu-id="e3589-143">This is not the case in C++, where the interfaces are completely separate.</span></span>

 

<span data-ttu-id="e3589-144">下列介面可提供額外的功能，但實作為選擇性。</span><span class="sxs-lookup"><span data-stu-id="e3589-144">The following interfaces provide added functionality but implementation is optional.</span></span>



| <span data-ttu-id="e3589-145">介面</span><span class="sxs-lookup"><span data-stu-id="e3589-145">Interface</span></span>                                                                         | <span data-ttu-id="e3589-146">描述</span><span class="sxs-lookup"><span data-stu-id="e3589-146">Description</span></span>                                                                             |
|-----------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------|
| [<span data-ttu-id="e3589-147">**IRawElementProviderAdviseEvents**</span><span class="sxs-lookup"><span data-stu-id="e3589-147">**IRawElementProviderAdviseEvents**</span></span>](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementprovideradviseevents) | <span data-ttu-id="e3589-148">可讓提供者追蹤事件的要求。</span><span class="sxs-lookup"><span data-stu-id="e3589-148">Enables the provider to track requests for events.</span></span>                                      |
| [<span data-ttu-id="e3589-149">**IRawElementProviderHwndOverride**</span><span class="sxs-lookup"><span data-stu-id="e3589-149">**IRawElementProviderHwndOverride**</span></span>](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementproviderhwndoverride) | <span data-ttu-id="e3589-150">可在片段的消費者介面自動化樹狀結構中，重新置放以視窗為基礎的元素。</span><span class="sxs-lookup"><span data-stu-id="e3589-150">Enables repositioning of window-based elements in the UI Automation tree of a fragment.</span></span> |



 

## <a name="required-functionality-for-ui-automation-providers"></a><span data-ttu-id="e3589-151">消費者介面自動化提供者的必要功能</span><span class="sxs-lookup"><span data-stu-id="e3589-151">Required Functionality for UI Automation Providers</span></span>

<span data-ttu-id="e3589-152">若要與消費者介面自動化通訊，您的控制項必須執行下表所述的主要功能區域。</span><span class="sxs-lookup"><span data-stu-id="e3589-152">To communicate with UI Automation, your control must implement the main areas of functionality described in the following table.</span></span>



| <span data-ttu-id="e3589-153">功能</span><span class="sxs-lookup"><span data-stu-id="e3589-153">Functionality</span></span>                                              | <span data-ttu-id="e3589-154">實作</span><span class="sxs-lookup"><span data-stu-id="e3589-154">Implementation</span></span>                                                                                                                                                                                                                                                                                                |
|------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="e3589-155">公開提供者以消費者介面自動化。</span><span class="sxs-lookup"><span data-stu-id="e3589-155">Expose the provider to UI Automation.</span></span>                      | <span data-ttu-id="e3589-156">為了回應傳送至控制項視窗的 [**WM \_ GETOBJECT**](wm-getobject.md) 訊息，會傳回執行 [**IRawElementProviderSimple**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementprovidersimple)的物件。</span><span class="sxs-lookup"><span data-stu-id="e3589-156">In response to a [**WM\_GETOBJECT**](wm-getobject.md) message sent to the control window, return the object that implements [**IRawElementProviderSimple**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementprovidersimple).</span></span> <span data-ttu-id="e3589-157">對於片段，這必須是片段根的提供者。</span><span class="sxs-lookup"><span data-stu-id="e3589-157">For fragments, this must be the provider for the fragment root.</span></span>                                           |
| <span data-ttu-id="e3589-158">提供屬性值。</span><span class="sxs-lookup"><span data-stu-id="e3589-158">Provide property values.</span></span>                                   | <span data-ttu-id="e3589-159">執行 [**IRawElementProviderSimple：： GetPropertyValue**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementprovidersimple-getpropertyvalue) 來提供或覆寫值。</span><span class="sxs-lookup"><span data-stu-id="e3589-159">Implement [**IRawElementProviderSimple::GetPropertyValue**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementprovidersimple-getpropertyvalue) to provide or override values.</span></span>                                                                                                                                                             |
| <span data-ttu-id="e3589-160">讓用戶端與控制項互動。</span><span class="sxs-lookup"><span data-stu-id="e3589-160">Enable the client to interact with the control.</span></span>            | <span data-ttu-id="e3589-161">執行支援每個適當控制項模式的介面，例如 [**IInvokeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-iinvokeprovider)。</span><span class="sxs-lookup"><span data-stu-id="e3589-161">Implement interfaces that support each appropriate control pattern, such as [**IInvokeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-iinvokeprovider).</span></span> <span data-ttu-id="e3589-162">在 [**IRawElementProviderSimple：： GetPatternProvider**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementprovidersimple-getpatternprovider)的實中，傳回這些控制項模式提供者。</span><span class="sxs-lookup"><span data-stu-id="e3589-162">Return these control pattern providers in your implementation of [**IRawElementProviderSimple::GetPatternProvider**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementprovidersimple-getpatternprovider).</span></span> |
| <span data-ttu-id="e3589-163">引發事件。</span><span class="sxs-lookup"><span data-stu-id="e3589-163">Raise events.</span></span>                                              | <span data-ttu-id="e3589-164">[**IProxyProviderWinEventSink**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-iproxyproviderwineventsink)的 [**UiaRaiseAutomationEvent**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiaraiseautomationevent)方法。</span><span class="sxs-lookup"><span data-stu-id="e3589-164">[**UiaRaiseAutomationEvent**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiaraiseautomationevent), methods of [**IProxyProviderWinEventSink**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-iproxyproviderwineventsink).</span></span>                                                                                                                                                |
| <span data-ttu-id="e3589-165">啟用導覽並專注于片段。</span><span class="sxs-lookup"><span data-stu-id="e3589-165">Enable navigating and focusing in a fragment.</span></span>              | <span data-ttu-id="e3589-166">針對片段中的每個元素執行 [**IRawElementProviderFragment**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementproviderfragment) 。</span><span class="sxs-lookup"><span data-stu-id="e3589-166">Implement [**IRawElementProviderFragment**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementproviderfragment) for each element within the fragment.</span></span> <span data-ttu-id="e3589-167">不是片段一部分的元素不需要。</span><span class="sxs-lookup"><span data-stu-id="e3589-167">Not necessary for elements that are not part of a fragment.</span></span>                                                                                                                         |
| <span data-ttu-id="e3589-168">讓焦點和尋找片段中的子項目。</span><span class="sxs-lookup"><span data-stu-id="e3589-168">Enable focusing and locating child elements in a fragment.</span></span> | <span data-ttu-id="e3589-169">執行 [**IRawElementProviderFragmentRoot**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementproviderfragmentroot)。</span><span class="sxs-lookup"><span data-stu-id="e3589-169">Implement [**IRawElementProviderFragmentRoot**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementproviderfragmentroot).</span></span> <span data-ttu-id="e3589-170">不是不是片段根項目的必要專案。</span><span class="sxs-lookup"><span data-stu-id="e3589-170">Not necessary for elements that are not fragment roots.</span></span>                                                                                                                                                          |



 

## <a name="property-values"></a><span data-ttu-id="e3589-171">屬性值</span><span class="sxs-lookup"><span data-stu-id="e3589-171">Property Values</span></span>

<span data-ttu-id="e3589-172">自訂控制項的消費者介面自動化提供者必須支援消費者介面自動化和用戶端應用程式可使用的特定屬性。</span><span class="sxs-lookup"><span data-stu-id="e3589-172">UI Automation providers for custom controls must support certain properties that can be used by UI Automation and by client applications.</span></span> <span data-ttu-id="e3589-173">針對裝載于 windows 中的元素，消費者介面自動化可以從預設視窗提供者取得一些屬性，但必須從自訂提供者取得其他屬性。</span><span class="sxs-lookup"><span data-stu-id="e3589-173">For elements that are hosted in windows, UI Automation can retrieve some properties from the default window provider, but must obtain others from the custom provider.</span></span>

<span data-ttu-id="e3589-174">一般來說，以視窗為基礎之控制項的提供者不需要提供 **PROPERTYID** 所識別的下列屬性：</span><span class="sxs-lookup"><span data-stu-id="e3589-174">Typically, providers for window-based controls do not need to provide the following properties that are identified by **PROPERTYID**:</span></span>

-   [<span data-ttu-id="e3589-175">**UIA \_ BoundingRectanglePropertyId**</span><span class="sxs-lookup"><span data-stu-id="e3589-175">**UIA\_BoundingRectanglePropertyId**</span></span>](uiauto-automation-element-propids.md)
-   [<span data-ttu-id="e3589-176">**UIA \_ ClickablePointPropertyId**</span><span class="sxs-lookup"><span data-stu-id="e3589-176">**UIA\_ClickablePointPropertyId**</span></span>](uiauto-automation-element-propids.md)
-   [<span data-ttu-id="e3589-177">**UIA \_ ProcessIdPropertyId**</span><span class="sxs-lookup"><span data-stu-id="e3589-177">**UIA\_ProcessIdPropertyId**</span></span>](uiauto-automation-element-propids.md)
-   [<span data-ttu-id="e3589-178">**UIA \_ ClassNamePropertyId**</span><span class="sxs-lookup"><span data-stu-id="e3589-178">**UIA\_ClassNamePropertyId**</span></span>](uiauto-automation-element-propids.md)
-   [<span data-ttu-id="e3589-179">**UIA \_ HasKeyboardFocusPropertyId**</span><span class="sxs-lookup"><span data-stu-id="e3589-179">**UIA\_HasKeyboardFocusPropertyId**</span></span>](uiauto-automation-element-propids.md)
-   [<span data-ttu-id="e3589-180">**UIA \_ IsEnabledPropertyId**</span><span class="sxs-lookup"><span data-stu-id="e3589-180">**UIA\_IsEnabledPropertyId**</span></span>](uiauto-automation-element-propids.md)
-   [<span data-ttu-id="e3589-181">**UIA \_ IsKeyboardFocusablePropertyId**</span><span class="sxs-lookup"><span data-stu-id="e3589-181">**UIA\_IsKeyboardFocusablePropertyId**</span></span>](uiauto-automation-element-propids.md)
-   [<span data-ttu-id="e3589-182">**UIA \_ IsPasswordPropertyId**</span><span class="sxs-lookup"><span data-stu-id="e3589-182">**UIA\_IsPasswordPropertyId**</span></span>](uiauto-automation-element-propids.md)
-   [<span data-ttu-id="e3589-183">**UIA \_ NamePropertyId**</span><span class="sxs-lookup"><span data-stu-id="e3589-183">**UIA\_NamePropertyId**</span></span>](uiauto-automation-element-propids.md)
-   [<span data-ttu-id="e3589-184">**UIA \_ RuntimeIdPropertyId**</span><span class="sxs-lookup"><span data-stu-id="e3589-184">**UIA\_RuntimeIdPropertyId**</span></span>](uiauto-automation-element-propids.md)

<span data-ttu-id="e3589-185">在視窗中裝載的簡單元素或片段根的 RuntimeId 屬性是從視窗取得。</span><span class="sxs-lookup"><span data-stu-id="e3589-185">The RuntimeId property of a simple element or fragment root hosted in a window is obtained from the window.</span></span> <span data-ttu-id="e3589-186">不過，根底下的片段元素（例如清單方塊中的清單專案）必須提供自己的識別碼。</span><span class="sxs-lookup"><span data-stu-id="e3589-186">However, fragment elements below the root, such as list items in a list box, must provide their own identifiers.</span></span> <span data-ttu-id="e3589-187">如需詳細資訊，請參閱 [**IRawElementProviderFragment：： GetRuntimeId**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementproviderfragment-getruntimeid)。</span><span class="sxs-lookup"><span data-stu-id="e3589-187">For more information, see [**IRawElementProviderFragment::GetRuntimeId**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementproviderfragment-getruntimeid).</span></span>

<span data-ttu-id="e3589-188">應針對 Windows Forms 控制項中裝載的提供者傳回 IsKeyboardFocusable 屬性。</span><span class="sxs-lookup"><span data-stu-id="e3589-188">The IsKeyboardFocusable property should be returned for providers hosted in a Windows Forms control.</span></span> <span data-ttu-id="e3589-189">在此情況下，預設視窗提供者可能無法擷取正確值。</span><span class="sxs-lookup"><span data-stu-id="e3589-189">In this case, the default window provider may be unable to retrieve the correct value.</span></span>

<span data-ttu-id="e3589-190">名稱屬性通常是由主機提供者所提供。</span><span class="sxs-lookup"><span data-stu-id="e3589-190">The Name property is usually supplied by the host provider.</span></span>

## <a name="events-from-providers"></a><span data-ttu-id="e3589-191">來自提供者的事件</span><span class="sxs-lookup"><span data-stu-id="e3589-191">Events from Providers</span></span>

<span data-ttu-id="e3589-192">消費者介面自動化提供者應該引發事件，以通知用戶端應用程式在 UI 狀態中的變更。</span><span class="sxs-lookup"><span data-stu-id="e3589-192">UI Automation providers should raise events to notify client applications of changes in the state of the UI.</span></span> <span data-ttu-id="e3589-193">下列函數用來引發事件。</span><span class="sxs-lookup"><span data-stu-id="e3589-193">The following functions are used to raise events.</span></span>



| <span data-ttu-id="e3589-194">函式</span><span class="sxs-lookup"><span data-stu-id="e3589-194">Function</span></span>                                                                                   | <span data-ttu-id="e3589-195">描述</span><span class="sxs-lookup"><span data-stu-id="e3589-195">Description</span></span>                                                                                                              |
|--------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="e3589-196">**UiaRaiseAutomationEvent**</span><span class="sxs-lookup"><span data-stu-id="e3589-196">**UiaRaiseAutomationEvent**</span></span>](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiaraiseautomationevent)                  | <span data-ttu-id="e3589-197">引發各種事件，包括由控制項模式觸發的事件。</span><span class="sxs-lookup"><span data-stu-id="e3589-197">Raises various events, including events triggered by control patterns.</span></span>                                                   |
| [<span data-ttu-id="e3589-198">**UiaRaiseAutomationPropertyChangedEvent**</span><span class="sxs-lookup"><span data-stu-id="e3589-198">**UiaRaiseAutomationPropertyChangedEvent**</span></span>](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiaraiseautomationpropertychangedevent) | <span data-ttu-id="e3589-199">當消費者介面自動化屬性變更時引發事件。</span><span class="sxs-lookup"><span data-stu-id="e3589-199">Raises an event when a UI Automation property has changed.</span></span>                                                               |
| [<span data-ttu-id="e3589-200">**UiaRaiseStructureChangedEvent**</span><span class="sxs-lookup"><span data-stu-id="e3589-200">**UiaRaiseStructureChangedEvent**</span></span>](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiaraisestructurechangedevent)      | <span data-ttu-id="e3589-201">當消費者介面自動化樹狀結構的結構變更時引發事件，例如藉由移除或新增專案。</span><span class="sxs-lookup"><span data-stu-id="e3589-201">Raises an event when the structure of the UI Automation tree has changed, for example, by removing or adding an element.</span></span> |



 

<span data-ttu-id="e3589-202">事件的目的是要通知用戶端在 UI 中發生的情況。</span><span class="sxs-lookup"><span data-stu-id="e3589-202">The purpose of an event is to notify the client of something taking place in the UI.</span></span> <span data-ttu-id="e3589-203">無論使用者輸入或用戶端應用程式是否使用消費者介面自動化觸發變更，提供者都應該引發事件。</span><span class="sxs-lookup"><span data-stu-id="e3589-203">Providers should raise an event regardless of whether the change was triggered by user input or by a client application using UI Automation.</span></span> <span data-ttu-id="e3589-204">例如，每當叫用控制項時，只要透過直接使用者輸入或由呼叫 [**IUIAutomationInvokePattern：： Invoke**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationinvokepattern-invoke)的用戶端應用程式叫用控制項，就應該引發 [**UIA \_ Invoke \_ InvokedEventId**](uiauto-event-ids.md)所識別的事件。</span><span class="sxs-lookup"><span data-stu-id="e3589-204">For example, the event identified by [**UIA\_Invoke\_InvokedEventId**](uiauto-event-ids.md) should be raised whenever the control is invoked, either through direct user input or by the client application calling [**IUIAutomationInvokePattern::Invoke**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationinvokepattern-invoke).</span></span>

<span data-ttu-id="e3589-205">若要最佳化效能，提供者可以選擇性地引發事件，或如果沒有註冊任何用戶端應用程式來接收事件，則完全不引發任何事件。</span><span class="sxs-lookup"><span data-stu-id="e3589-205">To optimize performance, a provider can selectively raise events, or raise no events at all if no client application is registered to receive them.</span></span> <span data-ttu-id="e3589-206">下列 API 元素用於優化。</span><span class="sxs-lookup"><span data-stu-id="e3589-206">The following API elements are used for optimization.</span></span>



| <span data-ttu-id="e3589-207">API 元素</span><span class="sxs-lookup"><span data-stu-id="e3589-207">API Element</span></span>                                                                       | <span data-ttu-id="e3589-208">Description</span><span class="sxs-lookup"><span data-stu-id="e3589-208">Description</span></span>                                                                                                                                                       |
|-----------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="e3589-209">**UiaClientsAreListening**</span><span class="sxs-lookup"><span data-stu-id="e3589-209">**UiaClientsAreListening**</span></span>](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiaclientsarelistening)           | <span data-ttu-id="e3589-210">此函式會 ascertains 是否有任何用戶端應用程式已訂閱消費者介面自動化事件。</span><span class="sxs-lookup"><span data-stu-id="e3589-210">This function ascertains whether any client applications have subscribed to UI Automation events.</span></span>                                                                 |
| [<span data-ttu-id="e3589-211">**IRawElementProviderAdviseEvents**</span><span class="sxs-lookup"><span data-stu-id="e3589-211">**IRawElementProviderAdviseEvents**</span></span>](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementprovideradviseevents) | <span data-ttu-id="e3589-212">在片段根上執行此介面可讓您在用戶端針對片段上的事件註冊和取消註冊事件處理常式時，建議提供者。</span><span class="sxs-lookup"><span data-stu-id="e3589-212">Implementing this interface on a fragment root enables the provider to be advised when clients register and unregister event handlers for events on the fragment.</span></span> |



 

> [!Note]  
> <span data-ttu-id="e3589-213">類似于在 COM 程式設計中執行參考計數，消費者介面自動化提供者必須將 [**IRawElementProviderAdviseEvents：： AdviseEventAdded**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementprovideradviseevents-adviseeventadded)和 [**AdviseEventRemoved**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementprovideradviseevents-adviseeventremoved)方法（例如 [**Iunknown：： AddRef**](/windows/desktop/api/unknwn/nf-unknwn-iunknown-addref)和 [**iunknown**](/windows/desktop/api/unknwn/nn-unknwn-iunknown)介面的 [**Release**](/windows/desktop/api/unknwn/nf-unknwn-iunknown-release)方法）視為必要。</span><span class="sxs-lookup"><span data-stu-id="e3589-213">Similar to implementing reference counting in COM programming, it is important for UI Automation providers to treat the [**IRawElementProviderAdviseEvents::AdviseEventAdded**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementprovideradviseevents-adviseeventadded) and [**AdviseEventRemoved**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementprovideradviseevents-adviseeventremoved) methods like the [**IUnknown::AddRef**](/windows/desktop/api/unknwn/nf-unknwn-iunknown-addref) and [**Release**](/windows/desktop/api/unknwn/nf-unknwn-iunknown-release) methods of the [**IUnknown**](/windows/desktop/api/unknwn/nn-unknwn-iunknown) interface.</span></span> <span data-ttu-id="e3589-214">只要針對特定事件或屬性呼叫 **AdviseEventAdded** 的次數超過 **AdviseEventRemoved** ，提供者就應該繼續引發對應的事件，因為某些用戶端仍在接聽。</span><span class="sxs-lookup"><span data-stu-id="e3589-214">As long as **AdviseEventAdded** has been called more times than **AdviseEventRemoved** for a specific event or property, the provider should continue to raise corresponding events, because some clients are still listening.</span></span> <span data-ttu-id="e3589-215">或者，消費者介面自動化提供者可以使用 [**UiaClientsAreListening**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiaclientsarelistening) 函式來判斷是否至少有一個用戶端正在接聽，如果有的話，則會引發所有適當的事件。</span><span class="sxs-lookup"><span data-stu-id="e3589-215">Alternatively, UI Automation providers can use the [**UiaClientsAreListening**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiaclientsarelistening) function to determine whether at least one client is listening and, if so, raise all appropriate events.</span></span>

 

## <a name="provider-navigation"></a><span data-ttu-id="e3589-216">提供者導覽</span><span class="sxs-lookup"><span data-stu-id="e3589-216">Provider Navigation</span></span>

<span data-ttu-id="e3589-217">簡單控制項的提供者（例如視窗中裝載的自訂按鈕）不需要支援消費者介面自動化樹狀結構中的導覽。</span><span class="sxs-lookup"><span data-stu-id="e3589-217">Providers for simple controls, such as a custom button hosted in a window, do not need to support navigation in the UI Automation tree.</span></span> <span data-ttu-id="e3589-218">專案的導覽會由主視窗的預設提供者（在 [**IRawElementProviderSimple：： HostRawElementProvider**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementprovidersimple-get_hostrawelementprovider)的執行中指定）來處理。</span><span class="sxs-lookup"><span data-stu-id="e3589-218">Navigation to and from the element is handled by the default provider for the host window, which is specified in the implementation of [**IRawElementProviderSimple::HostRawElementProvider**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementprovidersimple-get_hostrawelementprovider).</span></span> <span data-ttu-id="e3589-219">不過，當您實作複雜自訂控制項的提供者時，您必須支援片段的根節點與子系之間的導覽，以及同層級節點之間的導覽。</span><span class="sxs-lookup"><span data-stu-id="e3589-219">When you implement a provider for a complex custom control, however, you must support navigation between the root node of the fragment and its descendants, and between sibling nodes.</span></span>

> [!Note]  
> <span data-ttu-id="e3589-220">根以外的片段專案必須從 [**HostRawElementProvider**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementprovidersimple-get_hostrawelementprovider)傳回 **Null** ，因為它們不會直接裝載在視窗中，而且沒有預設提供者可支援它們的導覽。</span><span class="sxs-lookup"><span data-stu-id="e3589-220">Elements of a fragment other than the root must return **NULL** from [**HostRawElementProvider**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementprovidersimple-get_hostrawelementprovider), because they are not directly hosted in a window, and no default provider can support navigation to and from them.</span></span>

 

<span data-ttu-id="e3589-221">片段的結構取決於您的 [**IRawElementProviderFragment：：導覽**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementproviderfragment-navigate)的執行。</span><span class="sxs-lookup"><span data-stu-id="e3589-221">The structure of the fragment is determined by your implementation of [**IRawElementProviderFragment::Navigate**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementproviderfragment-navigate).</span></span> <span data-ttu-id="e3589-222">對於每個片段的可能方向，此方法會傳回該方向中項目的提供者物件。</span><span class="sxs-lookup"><span data-stu-id="e3589-222">For each possible direction from each fragment, this method returns the provider object for the element in that direction.</span></span> <span data-ttu-id="e3589-223">如果該方向沒有任何元素，則方法會傳回 **Null**。</span><span class="sxs-lookup"><span data-stu-id="e3589-223">If there is no element in that direction, the method returns **NULL**.</span></span>

<span data-ttu-id="e3589-224">片段根僅支援導覽至子項目。</span><span class="sxs-lookup"><span data-stu-id="e3589-224">The fragment root supports navigation only to child elements.</span></span> <span data-ttu-id="e3589-225">例如，當方向為 [ **NavigateDirection \_ FirstChild**] 時，清單方塊會傳回清單中的第一個專案，而當方向為 [ **NavigateDirection \_ LastChild**] 時，會傳回最後一個專案。</span><span class="sxs-lookup"><span data-stu-id="e3589-225">For example, a list box returns the first item in the list when the direction is **NavigateDirection\_FirstChild**, and returns the last item when the direction is **NavigateDirection\_LastChild**.</span></span> <span data-ttu-id="e3589-226">片段根目錄不支援導覽至父系或同級;這是由主機視窗提供者處理。</span><span class="sxs-lookup"><span data-stu-id="e3589-226">The fragment root does not support navigation to a parent or to siblings; this is handled by the host window provider.</span></span>

<span data-ttu-id="e3589-227">不是根的片段項目必須支援導覽至父代，以及導覽至任何同層級和其具有的子系。</span><span class="sxs-lookup"><span data-stu-id="e3589-227">Elements of a fragment that are not the root must support navigation to the parent, and to any siblings and children they have.</span></span>

## <a name="assigning-a-new-parent"></a><span data-ttu-id="e3589-228">指派新的父系</span><span class="sxs-lookup"><span data-stu-id="e3589-228">Assigning a New Parent</span></span>

<span data-ttu-id="e3589-229">快顯視窗實際上是最上層視窗，預設會顯示在消費者介面自動化樹狀結構中，做為桌面的子系。</span><span class="sxs-lookup"><span data-stu-id="e3589-229">Pop-up windows are actually top-level windows, and by default, appear in the UI Automation tree as children of the desktop.</span></span> <span data-ttu-id="e3589-230">不過，在許多情況下，快顯視窗在邏輯上是一些其他控制項的子系。</span><span class="sxs-lookup"><span data-stu-id="e3589-230">In many cases, however, pop-up windows are logically children of some other control.</span></span> <span data-ttu-id="e3589-231">例如，下拉式方塊的下拉式清單在邏輯上是下拉式方塊的子系。</span><span class="sxs-lookup"><span data-stu-id="e3589-231">For example, the drop-down list of a combo box is logically a child of the combo box.</span></span> <span data-ttu-id="e3589-232">同樣地，功能表快顯視窗在邏輯上是功能表的子系。</span><span class="sxs-lookup"><span data-stu-id="e3589-232">Similarly, a menu pop-up window is logically a child of the menu.</span></span> <span data-ttu-id="e3589-233">消費者介面自動化支援將新的父系指派給快顯視窗，使其看起來像是相關聯控制項的子系。</span><span class="sxs-lookup"><span data-stu-id="e3589-233">UI Automation provides support to assign a new parent to a pop-up window so that it appears to be a child of the associated control.</span></span>

<span data-ttu-id="e3589-234">若要將新的父系指派給快顯視窗：</span><span class="sxs-lookup"><span data-stu-id="e3589-234">To assign a new parent to a pop-up window:</span></span>

1.  <span data-ttu-id="e3589-235">建立快顯視窗的提供者。</span><span class="sxs-lookup"><span data-stu-id="e3589-235">Create a provider for the pop-up window.</span></span> <span data-ttu-id="e3589-236">這需要事先知道快顯視窗的類別。</span><span class="sxs-lookup"><span data-stu-id="e3589-236">This requires that the class of the pop-up window be known in advance.</span></span>
2.  <span data-ttu-id="e3589-237">像往常一樣，對該快顯視窗執行所有的屬性和控制項模式，就好像它本身就是控制項一樣。</span><span class="sxs-lookup"><span data-stu-id="e3589-237">Implement all properties and control patterns as usual for that pop-up, as though it were a control in its own right.</span></span>
3.  <span data-ttu-id="e3589-238">執行 [**IRawElementProviderSimple：： HostRawElementProvider**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementprovidersimple-get_hostrawelementprovider) 屬性，讓它傳回從 [**UiaHostProviderFromHwnd**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiahostproviderfromhwnd)取得的值，其中參數是快顯視窗的視窗控制碼。</span><span class="sxs-lookup"><span data-stu-id="e3589-238">Implement the [**IRawElementProviderSimple::HostRawElementProvider**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementprovidersimple-get_hostrawelementprovider) property so that it returns the value obtained from [**UiaHostProviderFromHwnd**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiahostproviderfromhwnd), where the parameter is the window handle of the pop-up window.</span></span>
4.  <span data-ttu-id="e3589-239">針對快顯視窗和其父代執行 [**IRawElementProviderFragment：：導覽**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementproviderfragment-navigate) ，以便將導覽正確地處理到邏輯子系和同級子系之間。</span><span class="sxs-lookup"><span data-stu-id="e3589-239">Implement [**IRawElementProviderFragment::Navigate**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementproviderfragment-navigate) for the pop-up window and its parent so that navigation is handled properly from the logical parent to the logical children, and between sibling children.</span></span>

<span data-ttu-id="e3589-240">當消費者介面自動化遇到快顯視窗時，它會辨識出從預設覆寫的導覽，並在遇到做為桌面的子系時，略過快顯視窗。</span><span class="sxs-lookup"><span data-stu-id="e3589-240">When UI Automation encounters the pop-up window, it recognizes that navigation is being overridden from the default, and skips over the pop-up window when it is encountered as a child of the desktop.</span></span> <span data-ttu-id="e3589-241">相反地，節點只能透過片段連接。</span><span class="sxs-lookup"><span data-stu-id="e3589-241">Instead, the node is reachable only through the fragment.</span></span>

<span data-ttu-id="e3589-242">指派新的父系不適合控制項可以裝載任何類別之視窗的情況。</span><span class="sxs-lookup"><span data-stu-id="e3589-242">Assigning a new parent is not suitable for cases where a control can host a window of any class.</span></span> <span data-ttu-id="e3589-243">例如，Rebar 控制項可以在其區段中裝載任何類型的視窗。</span><span class="sxs-lookup"><span data-stu-id="e3589-243">For example, a rebar control can host any type of window in its bands.</span></span> <span data-ttu-id="e3589-244">為了處理這些情況，消費者介面自動化支援替代形式的視窗重新配置，如下一節所述。</span><span class="sxs-lookup"><span data-stu-id="e3589-244">To handle these cases, UI Automation supports an alternative form of window relocation, as described in the next section.</span></span>

## <a name="provider-repositioning"></a><span data-ttu-id="e3589-245">提供者重新置放</span><span class="sxs-lookup"><span data-stu-id="e3589-245">Provider Repositioning</span></span>

<span data-ttu-id="e3589-246">消費者介面自動化片段可能包含兩個或多個元素，且每個專案都包含在視窗中。</span><span class="sxs-lookup"><span data-stu-id="e3589-246">UI Automation fragments may contain two or more elements that are each contained in a window.</span></span> <span data-ttu-id="e3589-247">由於每個視窗都有自己的預設提供者，它會將視窗視為包含視窗的子系，因此預設的消費者介面自動化樹狀結構會將視窗顯示為父視窗的子系。</span><span class="sxs-lookup"><span data-stu-id="e3589-247">Because each window has its own default provider that considers the window to be a child of a containing window, the UI Automation tree by default, will show the windows in the fragment as children of the parent window.</span></span> <span data-ttu-id="e3589-248">在大部分情況下，這是理想的行為，但有時可能會導致混淆，因為它不符合 UI 的邏輯結構。</span><span class="sxs-lookup"><span data-stu-id="e3589-248">In most cases this is desirable behavior, but sometimes it can lead to confusion because it does not match the logical structure of the UI.</span></span>

<span data-ttu-id="e3589-249">rebar 控制項就是這種情況的好範例。</span><span class="sxs-lookup"><span data-stu-id="e3589-249">A good example of this is a rebar control.</span></span> <span data-ttu-id="e3589-250">Rebar 控制項包含群組，其中每一個都可以接著包含視窗控制項，例如工具列、編輯方塊或下拉式方塊。</span><span class="sxs-lookup"><span data-stu-id="e3589-250">A rebar control contains bands, each of which can in turn contain a window-based control, such as a toolbar, an edit box, or a combo box.</span></span> <span data-ttu-id="e3589-251">Rebar 視窗的預設視窗提供者會將頻控制項視窗視為子系，而 Rebar 提供者則會將群組視為子系。</span><span class="sxs-lookup"><span data-stu-id="e3589-251">The default window provider for the rebar window sees the band control windows as children, and the rebar provider sees the bands as children.</span></span> <span data-ttu-id="e3589-252">由於視窗提供者和 Rebar 提供者是以串聯方式運作，並結合其子系，因此，群組和視窗控制項都會顯示為 Rebar 控制項的子系。</span><span class="sxs-lookup"><span data-stu-id="e3589-252">Because the window provider and the rebar provider are working in tandem and combining their children, both the bands and the window-based controls appear as children of the rebar control.</span></span> <span data-ttu-id="e3589-253">不過，在邏輯上，只有波段會顯示為 Rebar 控制項的子系，而且每個波段提供者都應該與它所包含之控制項的預設視窗提供者結合。</span><span class="sxs-lookup"><span data-stu-id="e3589-253">Logically, however, only the bands should appear as children of the rebar control, and each band provider should be coupled with the default window provider for the control it contains.</span></span>

<span data-ttu-id="e3589-254">為了達成此目的，Rebar 控制項的片段根提供者會公開一組代表群組的子系。</span><span class="sxs-lookup"><span data-stu-id="e3589-254">To accomplish this, the fragment root provider for the rebar control exposes a set of children representing the bands.</span></span> <span data-ttu-id="e3589-255">每個波段都有一個可公開屬性和控制項模式的單一提供者。</span><span class="sxs-lookup"><span data-stu-id="e3589-255">Each band has a single provider that may expose properties and control patterns.</span></span> <span data-ttu-id="e3589-256">在 [**IRawElementProviderSimple：： HostRawElementProvider**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementprovidersimple-get_hostrawelementprovider)的實值中，區提供者會傳回控制項視窗的預設視窗提供者，它會藉由呼叫 [**UiaHostProviderFromHwnd**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiahostproviderfromhwnd)來取得它，並將控制項的視窗控制碼傳入 (**HWND**) 。</span><span class="sxs-lookup"><span data-stu-id="e3589-256">In its implementation of [**IRawElementProviderSimple::HostRawElementProvider**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementprovidersimple-get_hostrawelementprovider), the band provider returns the default window provider for the control window, which it obtains by calling [**UiaHostProviderFromHwnd**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiahostproviderfromhwnd), passing in the control's window handle (**HWND**).</span></span> <span data-ttu-id="e3589-257">最後，Rebar 的片段根提供者會實 [**IRawElementProviderHwndOverride**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementproviderhwndoverride) 介面，而且在其 [**IRawElementProviderHwndOverride：： GetOverrideProviderForHwnd**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementproviderhwndoverride-getoverrideproviderforhwnd)的實中，它會針對指定之視窗中包含的控制項傳回適當的區提供者。</span><span class="sxs-lookup"><span data-stu-id="e3589-257">Finally, the fragment root provider for the rebar implements the [**IRawElementProviderHwndOverride**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementproviderhwndoverride) interface, and in its implementation of [**IRawElementProviderHwndOverride::GetOverrideProviderForHwnd**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementproviderhwndoverride-getoverrideproviderforhwnd), it returns the appropriate band provider for the control contained in the specified window.</span></span>

## <a name="disconnecting-providers"></a><span data-ttu-id="e3589-258">中斷連接提供者</span><span class="sxs-lookup"><span data-stu-id="e3589-258">Disconnecting Providers</span></span>

<span data-ttu-id="e3589-259">應用程式通常會在需要時建立控制項，並在之後加以終結。</span><span class="sxs-lookup"><span data-stu-id="e3589-259">Applications typically create controls as they are needed and destroy them afterward.</span></span> <span data-ttu-id="e3589-260">終結控制項之後，應呼叫 [**UiaDisconnectProvider**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiadisconnectprovider)來釋放與控制項相關聯的消費者介面自動化提供者資源。</span><span class="sxs-lookup"><span data-stu-id="e3589-260">After destroying a control, the UI Automation provider resources associated with the control should be released by calling the [**UiaDisconnectProvider**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiadisconnectprovider).</span></span>

<span data-ttu-id="e3589-261">同樣地，應用程式應該使用 [**UiaDisconnectAllProviders**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiadisconnectallproviders) 函式來釋出應用程式中所有提供者所持有的所有消費者介面自動化資源，然後再關閉。</span><span class="sxs-lookup"><span data-stu-id="e3589-261">Similarly, an application should use the [**UiaDisconnectAllProviders**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiadisconnectallproviders) function to release all UI Automation resources held by all providers in the application before shutting down.</span></span>

## <a name="related-topics"></a><span data-ttu-id="e3589-262">相關主題</span><span class="sxs-lookup"><span data-stu-id="e3589-262">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="e3589-263">消費者介面自動化提供者程式設計人員指南</span><span class="sxs-lookup"><span data-stu-id="e3589-263">UI Automation Provider Programmer's Guide</span></span>](uiauto-providerportal.md)
</dt> </dl>

 

 