---
title: 取得 UI 自動化項目
description: 本主題說明為 UI 元素取得 IUIAutomationElement 介面的各種方式。
ms.assetid: 8675851a-4a72-4cbe-ab71-ed6fc891be17
keywords:
- 用戶端，取得消費者介面自動化元素
- 用戶端，消費者介面自動化元素
- 用戶端、根項目
- 用戶端、搜尋範圍
- 消費者介面自動化，取得元素
- 消費者介面自動化，元素
- 消費者介面自動化，根項目
- 消費者介面自動化，條件
- 消費者介面自動化，搜尋範圍
- 取得消費者介面自動化元素
- 根項目
- 搜尋範圍
ms.topic: article
ms.date: 05/31/2018
ms.custom: project-verbatim
ms.openlocfilehash: a1adbcea5cea81f97350ef15c491b289e07d3ee6
ms.sourcegitcommit: af120ad5c30da2fc5eb717ca2a1c4c45878efd71
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 03/20/2021
ms.locfileid: "106992359"
---
# <a name="obtaining-ui-automation-elements"></a><span data-ttu-id="17152-115">取得 UI 自動化項目</span><span class="sxs-lookup"><span data-stu-id="17152-115">Obtaining UI Automation Elements</span></span>

<span data-ttu-id="17152-116">本主題說明為 UI 元素取得 [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) 介面的各種方式。</span><span class="sxs-lookup"><span data-stu-id="17152-116">This topic describes various ways to obtain [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) interfaces for UI elements.</span></span>

<span data-ttu-id="17152-117">[消費者介面自動化檔內容用戶端範例應用程式](https://github.com/microsoft/Windows-classic-samples/tree/master/Samples/UIAutomationDocumentClient)中使用 **IUIAutomationElement** 。</span><span class="sxs-lookup"><span data-stu-id="17152-117">**IUIAutomationElement** is used in the [UI Automation document content client sample app](https://github.com/microsoft/Windows-classic-samples/tree/master/Samples/UIAutomationDocumentClient).</span></span>

## <a name="root-element"></a><span data-ttu-id="17152-118">根項目</span><span class="sxs-lookup"><span data-stu-id="17152-118">Root Element</span></span>

<span data-ttu-id="17152-119">雖然您可以使用方法（例如 [**IUIAutomation：： system.windows.input.focusmanager.getfocusedelement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-getfocusedelement)）直接抓取元素，但有些用戶端應用程式需要視圖專案的階層式結構，又稱為消費者介面自動化樹狀結構。</span><span class="sxs-lookup"><span data-stu-id="17152-119">Although elements can be retrieved directly by using methods, such as [**IUIAutomation::GetFocusedElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-getfocusedelement), some client applications require a view of the hierarchical structure of elements, known as the UI Automation tree.</span></span> <span data-ttu-id="17152-120">此階層的根項目是桌面。</span><span class="sxs-lookup"><span data-stu-id="17152-120">The root element of this hierarchy is the desktop.</span></span> <span data-ttu-id="17152-121">您可以使用 [**IUIAutomation：： GetRootElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-getrootelement) 方法或 [**IUIAutomation：： GetRootElementBuildCache**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-getrootelementbuildcache) 方法來取得這個元素。</span><span class="sxs-lookup"><span data-stu-id="17152-121">You can obtain this element by using the [**IUIAutomation::GetRootElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-getrootelement) method or the [**IUIAutomation::GetRootElementBuildCache**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-getrootelementbuildcache) method.</span></span> <span data-ttu-id="17152-122">這兩種方法都會捕獲 [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) 介面指標。</span><span class="sxs-lookup"><span data-stu-id="17152-122">Both these methods retrieve an [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) interface pointer.</span></span> <span data-ttu-id="17152-123">您可以使用方法（例如 [**IUIAutomationElement：： FindFirst**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findfirst) 和 [**FindAll**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findall)）來搜尋子代元素。</span><span class="sxs-lookup"><span data-stu-id="17152-123">You can search for descendant elements by using methods, such as [**IUIAutomationElement::FindFirst**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findfirst) and [**FindAll**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findall).</span></span>

> [!Note]  
> <span data-ttu-id="17152-124">一般來說，您應該嘗試只取得根項目的直接子系。</span><span class="sxs-lookup"><span data-stu-id="17152-124">In general, you should try to obtain only direct children of the root element.</span></span> <span data-ttu-id="17152-125">搜尋子代可能會逐一查看數百個或數千個元素。</span><span class="sxs-lookup"><span data-stu-id="17152-125">A search for descendants may iterate through hundreds or thousands of elements.</span></span> <span data-ttu-id="17152-126">如果您嘗試取得較低層級的特定項目，您應該從應用程式視窗或較低層級的容器開始搜尋。</span><span class="sxs-lookup"><span data-stu-id="17152-126">If you are attempting to obtain a specific element at a lower level, you should start your search from the application window or from a container at a lower level.</span></span>

 

## <a name="conditions"></a><span data-ttu-id="17152-127">條件</span><span class="sxs-lookup"><span data-stu-id="17152-127">Conditions</span></span>

<span data-ttu-id="17152-128">針對用來抓取消費者介面自動化元素的大部分技術，您必須指定條件。</span><span class="sxs-lookup"><span data-stu-id="17152-128">For most techniques you use to retrieve UI Automation elements, you must specify a condition.</span></span> <span data-ttu-id="17152-129">條件是定義您想要取得之專案的一組準則。</span><span class="sxs-lookup"><span data-stu-id="17152-129">A condition is a set of criteria that defines the elements that you want to retrieve.</span></span> <span data-ttu-id="17152-130">條件是以 [**IUIAutomationCondition**](/windows/win32/api/uiautomationclient/nn-uiautomationclient-iuiautomationcondition) 介面表示。</span><span class="sxs-lookup"><span data-stu-id="17152-130">A condition is represented by the [**IUIAutomationCondition**](/windows/win32/api/uiautomationclient/nn-uiautomationclient-iuiautomationcondition) interface.</span></span>

<span data-ttu-id="17152-131">最簡單的條件是 true 條件，這是預先定義的物件，指定要傳回搜尋範圍中的所有元素。</span><span class="sxs-lookup"><span data-stu-id="17152-131">The simplest condition is the true condition, which is a predefined object that specifies that all elements in the search scope are to be returned.</span></span> <span data-ttu-id="17152-132">False 條件是 true 條件的反向條件，因為它會導致找不到任何專案，所以不太實用。</span><span class="sxs-lookup"><span data-stu-id="17152-132">The false condition is the inverse of the true condition and is less useful, because it would prevent any elements from being found.</span></span> <span data-ttu-id="17152-133">您可以使用 [**IUIAutomation：： CreateTrueCondition**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-createtruecondition)來取得 true 條件的介面。</span><span class="sxs-lookup"><span data-stu-id="17152-133">You can obtain an interface to the true condition by using [**IUIAutomation::CreateTrueCondition**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-createtruecondition).</span></span>

<span data-ttu-id="17152-134">另外還有三個預先定義的條件（可做為 [**IUIAutomation**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomation) 物件上的屬性），可以單獨使用，也可以與其他條件搭配使用： [**IUIAutomation：： ContentViewCondition**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-get_contentviewcondition)、 [**ControlViewCondition**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-get_controlviewcondition)和 [**RawViewCondition**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-get_rawviewcondition)。</span><span class="sxs-lookup"><span data-stu-id="17152-134">Three other predefined conditions, available as properties on the [**IUIAutomation**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomation) object, can be used alone or in combination with other conditions: [**IUIAutomation::ContentViewCondition**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-get_contentviewcondition), [**ControlViewCondition**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-get_controlviewcondition), and [**RawViewCondition**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-get_rawviewcondition).</span></span> <span data-ttu-id="17152-135">**RawViewCondition**（本身使用）相當於 true 條件，因為它不會依 [**IUIAutomationElement：： CurrentIsControlElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentiscontrolelement) 或 [**CurrentIsContentElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentiscontentelement) 屬性來篩選元素。</span><span class="sxs-lookup"><span data-stu-id="17152-135">**RawViewCondition**, used by itself, is equivalent to the true condition, because it does not filter elements by the [**IUIAutomationElement::CurrentIsControlElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentiscontrolelement) or [**CurrentIsContentElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentiscontentelement) properties.</span></span>

<span data-ttu-id="17152-136">其他條件是由條件物件所建立，每個條件物件都會指定屬性值。</span><span class="sxs-lookup"><span data-stu-id="17152-136">Other conditions are built from condition objects, each of which specifies a property value.</span></span> <span data-ttu-id="17152-137">例如，屬性條件可能會指定專案已啟用或支援特定的控制項模式。</span><span class="sxs-lookup"><span data-stu-id="17152-137">For example, a property condition might specify that the element is enabled or that it supports a certain control pattern.</span></span>

<span data-ttu-id="17152-138">您可以藉由呼叫 [**IUIAutomation：： CreateAndCondition**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-createandcondition)、 [**CreateOrCondition**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-createorcondition)、 [**CreateNotCondition**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-createnotcondition)和相關方法來結合使用布林值邏輯的條件。</span><span class="sxs-lookup"><span data-stu-id="17152-138">Conditions that use Boolean logic can be combined by calling [**IUIAutomation::CreateAndCondition**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-createandcondition), [**CreateOrCondition**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-createorcondition), [**CreateNotCondition**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-createnotcondition), and related methods.</span></span>

## <a name="search-scope"></a><span data-ttu-id="17152-139">搜尋範圍</span><span class="sxs-lookup"><span data-stu-id="17152-139">Search Scope</span></span>

<span data-ttu-id="17152-140">使用 [**IUIAutomationElement：： FindFirst**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findfirst) 或 [**FindAll**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findall) 執行的搜尋必須具有範圍和開始位置。</span><span class="sxs-lookup"><span data-stu-id="17152-140">Searches that are performed by using [**IUIAutomationElement::FindFirst**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findfirst) or [**FindAll**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findall) must have a scope and a starting place.</span></span>

> [!Note]  
> <span data-ttu-id="17152-141">這兩種方法的任何評論也適用于 [**IUIAutomationElement：： FindFirstBuildCache**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findfirstbuildcache) 和 [**FindAllBuildCache**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findallbuildcache)。</span><span class="sxs-lookup"><span data-stu-id="17152-141">Any commentary about these two methods also applies to [**IUIAutomationElement::FindFirstBuildCache**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findfirstbuildcache) and [**FindAllBuildCache**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findallbuildcache).</span></span>

 

<span data-ttu-id="17152-142">範圍會定義要搜尋的起始位置周圍的空間。</span><span class="sxs-lookup"><span data-stu-id="17152-142">The scope defines the space around the starting place that is to be searched.</span></span> <span data-ttu-id="17152-143">這可能包括元素本身、其同級、其父系、直屬子系和其子系。</span><span class="sxs-lookup"><span data-stu-id="17152-143">This might include the element itself, its siblings, its parent, its immediate children, and its descendants.</span></span> <span data-ttu-id="17152-144">請注意， **Find** 方法不支援搜尋 Microsoft 消費者介面自動化樹狀結構;也就是說，不支援搜尋上階元素。</span><span class="sxs-lookup"><span data-stu-id="17152-144">Be aware that the **Find** methods do not support searching up the Microsoft UI Automation tree; that is, searching for ancestor elements is not supported.</span></span>

<span data-ttu-id="17152-145">搜尋範圍是由 [**treescope.children**](/windows/desktop/api/UIAutomationClient/ne-uiautomationclient-treescope) 列舉型別中值的位元組合所定義。</span><span class="sxs-lookup"><span data-stu-id="17152-145">The scope of a search is defined by a bitwise combination of values from the [**TreeScope**](/windows/desktop/api/UIAutomationClient/ne-uiautomationclient-treescope) enumerated type.</span></span>

## <a name="finding-a-known-element"></a><span data-ttu-id="17152-146">尋找已知的項目</span><span class="sxs-lookup"><span data-stu-id="17152-146">Finding a Known Element</span></span>

<span data-ttu-id="17152-147">若要找出以名稱、自動化識別碼或其他屬性或屬性組合識別的已知專案，最簡單的方式是使用 [**IUIAutomationElement：： FindFirst**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findfirst) 方法。</span><span class="sxs-lookup"><span data-stu-id="17152-147">To find a known element that is identified by name, automation ID, or some other property or combination of properties, it is easiest to use the [**IUIAutomationElement::FindFirst**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findfirst) method.</span></span> <span data-ttu-id="17152-148">如果搜尋的專案是應用程式視窗，則搜尋的起始點可以是根項目。</span><span class="sxs-lookup"><span data-stu-id="17152-148">If the element sought is an application window, the starting point of the search can be the root element.</span></span>

<span data-ttu-id="17152-149">這種尋找消費者介面自動化元素的方式最適合用於自動化測試案例。</span><span class="sxs-lookup"><span data-stu-id="17152-149">This way of finding UI Automation elements is most useful in automated testing scenarios.</span></span>

<span data-ttu-id="17152-150">如需示範如何尋找已知專案的程式碼範例，請參閱 [依名稱尋找元素](uiauto-howto-find-ui-elements.md)。</span><span class="sxs-lookup"><span data-stu-id="17152-150">For a code example that shows how to find a know element, see [Finding an Element by Name](uiauto-howto-find-ui-elements.md).</span></span>

## <a name="finding-elements-in-a-subtree"></a><span data-ttu-id="17152-151">在子樹狀結構中尋找項目</span><span class="sxs-lookup"><span data-stu-id="17152-151">Finding Elements in a Subtree</span></span>

<span data-ttu-id="17152-152">若要尋找符合特定準則且與已知專案相關的所有元素，您可以在已知元素上呼叫 [**IUIAutomationElement：： FindAll**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findall) 。</span><span class="sxs-lookup"><span data-stu-id="17152-152">To find all elements that meet specific criteria and are related to a known element, you can call [**IUIAutomationElement::FindAll**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findall) on the known element.</span></span> <span data-ttu-id="17152-153">例如，您可以使用這個方法，從清單或功能表中取出清單專案或功能表項目，或是識別對話方塊中的所有控制項。</span><span class="sxs-lookup"><span data-stu-id="17152-153">For example, use this method to retrieve list items or menu items from a list or menu, or to identify all controls in a dialog box.</span></span>

<span data-ttu-id="17152-154">如需示範如何在子樹中尋找專案的程式碼範例，請參閱 [尋找相關元素](uiauto-howto-find-ui-elements.md)。</span><span class="sxs-lookup"><span data-stu-id="17152-154">For a code example that shows how to find elements in a subtree, see [Finding Related Elements](uiauto-howto-find-ui-elements.md).</span></span>

## <a name="walking-a-subtree"></a><span data-ttu-id="17152-155">逐一查看子樹狀結構</span><span class="sxs-lookup"><span data-stu-id="17152-155">Walking a Subtree</span></span>

<span data-ttu-id="17152-156">如果您事先不知道用戶端可能使用的應用程式，您可以使用 [**IUIAutomationTreeWalker**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtreewalker)來建立所有相關專案的子樹。</span><span class="sxs-lookup"><span data-stu-id="17152-156">If you have no prior knowledge of the applications that your client may be used with, you can construct a subtree of all elements of interest by using [**IUIAutomationTreeWalker**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtreewalker).</span></span> <span data-ttu-id="17152-157">例如，您的用戶端可能會這麼做，以回應焦點變更事件;也就是說，當應用程式或控制項收到輸入焦點時，消費者介面自動化用戶端會檢查子系，或許是焦點元素的所有下階。</span><span class="sxs-lookup"><span data-stu-id="17152-157">Your client might do this, for example, in response to a focus-changed event; that is, when an application or control receives input focus, the UI Automation client examines children and perhaps all descendants of the focused element.</span></span>

<span data-ttu-id="17152-158">請注意，消費者介面自動化樹狀結構的流覽需要大量資源。</span><span class="sxs-lookup"><span data-stu-id="17152-158">Be aware that walking the UI Automation tree is resource-intensive.</span></span> <span data-ttu-id="17152-159">只有在無法使用 [**IUIAutomationElement：： FindFirst**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findfirst)、 [**FindAll**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findall)或 [**BuildUpdatedCache**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-buildupdatedcache) 方法時，才會將樹狀結構引導。</span><span class="sxs-lookup"><span data-stu-id="17152-159">Walk the tree only when it is not feasible to use the [**IUIAutomationElement::FindFirst**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findfirst), [**FindAll**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findall), or [**BuildUpdatedCache**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-buildupdatedcache) methods.</span></span>

<span data-ttu-id="17152-160">您可以藉由將自訂條件傳遞至 [**IUIAutomation：： CreateTreeWalker**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-createtreewalker)來定義您自己的樹狀目錄，或者，您可以使用下列其中一個定義為基底 [**IUIAutomation**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomation)屬性的預先定義物件。</span><span class="sxs-lookup"><span data-stu-id="17152-160">You can define your own tree walker by passing a custom condition to [**IUIAutomation::CreateTreeWalker**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-createtreewalker), or you can use one of the following predefined objects that are defined as properties of the base [**IUIAutomation**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomation).</span></span>



| <span data-ttu-id="17152-161">Object</span><span class="sxs-lookup"><span data-stu-id="17152-161">Object</span></span>                                                              | <span data-ttu-id="17152-162">目的</span><span class="sxs-lookup"><span data-stu-id="17152-162">Purpose</span></span>                                                                                                                                                      |
|---------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="17152-163">**ContentViewWalker**</span><span class="sxs-lookup"><span data-stu-id="17152-163">**ContentViewWalker**</span></span>](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-get_contentviewwalker) | <span data-ttu-id="17152-164">只尋找 [**IUIAutomationElement：： CurrentIsContentElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentiscontentelement) 屬性為 **TRUE** 的元素。</span><span class="sxs-lookup"><span data-stu-id="17152-164">Finds only elements whose [**IUIAutomationElement::CurrentIsContentElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentiscontentelement) property is **TRUE**.</span></span> |
| [<span data-ttu-id="17152-165">**ControlViewWalker**</span><span class="sxs-lookup"><span data-stu-id="17152-165">**ControlViewWalker**</span></span>](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-get_controlviewwalker) | <span data-ttu-id="17152-166">只尋找 [**IUIAutomationElement：： CurrentIsControlElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentiscontrolelement) 屬性為 **TRUE** 的元素。</span><span class="sxs-lookup"><span data-stu-id="17152-166">Finds only elements whose [**IUIAutomationElement::CurrentIsControlElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentiscontrolelement) property is **TRUE**.</span></span> |
| [<span data-ttu-id="17152-167">**RawViewWalker**</span><span class="sxs-lookup"><span data-stu-id="17152-167">**RawViewWalker**</span></span>](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-get_rawviewwalker)         | <span data-ttu-id="17152-168">尋找所有項目。</span><span class="sxs-lookup"><span data-stu-id="17152-168">Finds all elements.</span></span>                                                                                                                                          |



 

<span data-ttu-id="17152-169">取得 [**IUIAutomationTreeWalker**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtreewalker)之後，請呼叫 **IUIAutomationTreeWalker：： GetXxx** 方法來流覽子樹元素，並傳入要開始進行的專案。</span><span class="sxs-lookup"><span data-stu-id="17152-169">After you obtain an [**IUIAutomationTreeWalker**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtreewalker), call the **IUIAutomationTreeWalker::GetXxx** methods to navigate elements of the subtree, passing in the element from which to start walking.</span></span>

<span data-ttu-id="17152-170">[**IUIAutomationTreeWalker：：**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtreewalker-normalizeelement)正規化方法可以用來從另一個不是 view 一部分的專案導覽至子樹中的元素。</span><span class="sxs-lookup"><span data-stu-id="17152-170">The [**IUIAutomationTreeWalker::Normalize**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtreewalker-normalizeelement) method can be used for navigating to an element in the subtree from another element that is not part of the view.</span></span> <span data-ttu-id="17152-171">例如，假設您使用 [**IUIAutomation：： ContentViewWalker**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-get_contentviewwalker)建立子樹的視圖。</span><span class="sxs-lookup"><span data-stu-id="17152-171">For example, suppose you create a view of a subtree by using [**IUIAutomation::ContentViewWalker**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-get_contentviewwalker).</span></span> <span data-ttu-id="17152-172">您的應用程式會收到捲軸已收到輸入焦點的通知。</span><span class="sxs-lookup"><span data-stu-id="17152-172">Your application receives notification that a scroll bar has received the input focus.</span></span> <span data-ttu-id="17152-173">因為捲軸不是內容項目，所以不會出現在子樹狀結構檢視中。</span><span class="sxs-lookup"><span data-stu-id="17152-173">Because a scroll bar is not a content element, it is not present in your view of the subtree.</span></span> <span data-ttu-id="17152-174">不過，您可以將代表捲軸的 [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) 傳遞至 **IUIAutomationTreeWalker：：** 正規化，並取出內容視圖中最接近的上階。</span><span class="sxs-lookup"><span data-stu-id="17152-174">However, you can pass the [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) that represents the scroll bar to **IUIAutomationTreeWalker::Normalize** and retrieve the nearest ancestor that is in the content view.</span></span>

<span data-ttu-id="17152-175">如需示範如何使用 [**IUIAutomationTreeWalker**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtreewalker) 介面的程式碼範例，請參閱 [如何逐步執行消費者介面自動化樹狀結構](uiauto-howto-walk-uiautomation-tree.md)。</span><span class="sxs-lookup"><span data-stu-id="17152-175">For code examples that show how to use the [**IUIAutomationTreeWalker**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtreewalker) interface, see [How to Walk the UI Automation Tree](uiauto-howto-walk-uiautomation-tree.md).</span></span>

## <a name="other-ways-to-retrieve-an-element"></a><span data-ttu-id="17152-176">擷取項目的其他方式</span><span class="sxs-lookup"><span data-stu-id="17152-176">Other Ways to Retrieve an Element</span></span>

<span data-ttu-id="17152-177">除了搜尋和流覽之外，您還可以透過下列方式取得 [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) 。</span><span class="sxs-lookup"><span data-stu-id="17152-177">In addition to searches and navigation, you can retrieve an [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) in the following ways.</span></span>

### <a name="from-an-event"></a><span data-ttu-id="17152-178">從事件擷取</span><span class="sxs-lookup"><span data-stu-id="17152-178">From an Event</span></span>

<span data-ttu-id="17152-179">當您的應用程式收到消費者介面自動化事件時，傳遞至事件處理常式的來源物件會以 [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement)表示。</span><span class="sxs-lookup"><span data-stu-id="17152-179">When your application receives a UI Automation event, the source object passed to your event handler is represented by an [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement).</span></span> <span data-ttu-id="17152-180">例如，如果您訂閱焦點變更事件，傳遞給您 [**IUIAutomationFocusChangedEventHandler**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationfocuschangedeventhandler) 的來源就是接收焦點的元素。</span><span class="sxs-lookup"><span data-stu-id="17152-180">For example, if you subscribe to focus-changed events, the source passed to your [**IUIAutomationFocusChangedEventHandler**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationfocuschangedeventhandler) is the element that received the focus.</span></span> <span data-ttu-id="17152-181">如需詳細資訊，請參閱 [訂閱消費者介面自動化事件](uiauto-eventsforclients.md)。</span><span class="sxs-lookup"><span data-stu-id="17152-181">For more information, see [Subscribing to UI Automation Events](uiauto-eventsforclients.md).</span></span>

### <a name="from-a-point"></a><span data-ttu-id="17152-182">從點擷取</span><span class="sxs-lookup"><span data-stu-id="17152-182">From a Point</span></span>

<span data-ttu-id="17152-183">若要從螢幕座標中取出 [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) （例如，資料指標位置），請使用 [**IUIAutomation：： ElementFromPoint**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-elementfrompoint) 方法。</span><span class="sxs-lookup"><span data-stu-id="17152-183">To retrieve an [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) from screen coordinates, for example, a cursor position, use the [**IUIAutomation::ElementFromPoint**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-elementfrompoint) method.</span></span>

### <a name="from-a-window-handle"></a><span data-ttu-id="17152-184">從視窗控制代碼擷取</span><span class="sxs-lookup"><span data-stu-id="17152-184">From a Window Handle</span></span>

<span data-ttu-id="17152-185">若要從 **HWND** 取出 [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) ，請使用 [**IUIAutomation：： ElementFromHandle**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-elementfromhandle)方法。</span><span class="sxs-lookup"><span data-stu-id="17152-185">To retrieve an [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) from an **HWND**, use the [**IUIAutomation::ElementFromHandle**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-elementfromhandle) method.</span></span>

### <a name="from-the-focused-control"></a><span data-ttu-id="17152-186">從取得焦點的控制項擷取</span><span class="sxs-lookup"><span data-stu-id="17152-186">From the Focused Control</span></span>

<span data-ttu-id="17152-187">若要取出表示焦點控制項的 [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) ，請使用 [**IUIAutomation：： system.windows.input.focusmanager.getfocusedelement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-getfocusedelement) 方法。</span><span class="sxs-lookup"><span data-stu-id="17152-187">To retrieve an [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) that represents the focused control, use the [**IUIAutomation::GetFocusedElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-getfocusedelement) method.</span></span>

## <a name="related-topics"></a><span data-ttu-id="17152-188">相關主題</span><span class="sxs-lookup"><span data-stu-id="17152-188">Related topics</span></span>

[<span data-ttu-id="17152-189">UI 自動化樹狀目錄概觀</span><span class="sxs-lookup"><span data-stu-id="17152-189">UI Automation Tree Overview</span></span>](uiauto-treeoverview.md)

[<span data-ttu-id="17152-190">消費者介面自動化檔內容用戶端範例應用程式</span><span class="sxs-lookup"><span data-stu-id="17152-190">UI Automation document content client sample app</span></span>](https://github.com/microsoft/Windows-classic-samples/tree/master/Samples/UIAutomationDocumentClient)
