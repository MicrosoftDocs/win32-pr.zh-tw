---
title: UI 自動化文字單位
description: 本主題說明 Microsoft 消費者介面自動化 \ 32 所支援的文字單位;TextRange 控制項模式。 消費者介面自動化提供者和用戶端會使用文字單位來指定移動或變更文字範圍大小所依據的數量。
ms.assetid: 3ec43a81-c4f1-4c73-865f-a60c751fc3fb
keywords:
- 消費者介面自動化，文字單位
- 文字單位，關於
- 消費者介面自動化，文字單位清單
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 91ff4257c70b34cea01a149b30dff2bf2fbe691a
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/20/2020
ms.locfileid: "104315268"
---
# <a name="ui-automation-text-units"></a><span data-ttu-id="0854e-107">消費者介面自動化文字單位</span><span class="sxs-lookup"><span data-stu-id="0854e-107">UI Automation text units</span></span>

<span data-ttu-id="0854e-108">本主題說明 Microsoft 消費者介面自動化 [TextRange](uiauto-implementingtextandtextrange.md) 控制項模式所支援的文字單位。</span><span class="sxs-lookup"><span data-stu-id="0854e-108">This topic describes the text units supported by the Microsoft UI Automation [TextRange](uiauto-implementingtextandtextrange.md) control pattern.</span></span> <span data-ttu-id="0854e-109">消費者介面自動化提供者和用戶端會使用文字單位來指定移動或變更文字範圍大小所依據的數量。</span><span class="sxs-lookup"><span data-stu-id="0854e-109">UI Automation providers and clients use text units to specify the amount by which to move or change the size of a text range.</span></span>

-   [<span data-ttu-id="0854e-110">文字單位 API 元素</span><span class="sxs-lookup"><span data-stu-id="0854e-110">Text Unit API Elements</span></span>](#text-unit-api-elements)
-   [<span data-ttu-id="0854e-111">文字單位描述</span><span class="sxs-lookup"><span data-stu-id="0854e-111">Text Unit Descriptions</span></span>](#text-unit-descriptions)
    -   [<span data-ttu-id="0854e-112">字元</span><span class="sxs-lookup"><span data-stu-id="0854e-112">Character</span></span>](#character)
    -   [<span data-ttu-id="0854e-113">格式</span><span class="sxs-lookup"><span data-stu-id="0854e-113">Format</span></span>](#format)
    -   [<span data-ttu-id="0854e-114">Word</span><span class="sxs-lookup"><span data-stu-id="0854e-114">Word</span></span>](#word)
    -   [<span data-ttu-id="0854e-115">線條</span><span class="sxs-lookup"><span data-stu-id="0854e-115">Line</span></span>](#line)
    -   [<span data-ttu-id="0854e-116">Paragraph</span><span class="sxs-lookup"><span data-stu-id="0854e-116">Paragraph</span></span>](#paragraph)
    -   [<span data-ttu-id="0854e-117">頁面</span><span class="sxs-lookup"><span data-stu-id="0854e-117">Page</span></span>](#page)
    -   [<span data-ttu-id="0854e-118">文件</span><span class="sxs-lookup"><span data-stu-id="0854e-118">Document</span></span>](#document)
-   [<span data-ttu-id="0854e-119">其他可能的範圍</span><span class="sxs-lookup"><span data-stu-id="0854e-119">Other Potential Ranges</span></span>](#other-potential-ranges)
-   [<span data-ttu-id="0854e-120">相關主題</span><span class="sxs-lookup"><span data-stu-id="0854e-120">Related topics</span></span>](#related-topics)

## <a name="text-unit-api-elements"></a><span data-ttu-id="0854e-121">文字單位 API 元素</span><span class="sxs-lookup"><span data-stu-id="0854e-121">Text unit API elements</span></span>

<span data-ttu-id="0854e-122">消費者介面自動化 API 包含下列需要指定文字單位的方法：</span><span class="sxs-lookup"><span data-stu-id="0854e-122">The UI Automation API includes the following methods that require a text unit to be specified:</span></span>

-   [<span data-ttu-id="0854e-123">**ITextRangeProvider：： Move**</span><span class="sxs-lookup"><span data-stu-id="0854e-123">**ITextRangeProvider::Move**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-move)
-   [<span data-ttu-id="0854e-124">**ITextRangeProvider::ExpandToEnclosingUnit**</span><span class="sxs-lookup"><span data-stu-id="0854e-124">**ITextRangeProvider::ExpandToEnclosingUnit**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-expandtoenclosingunit)
-   [<span data-ttu-id="0854e-125">**ITextRangeProvider::MoveEndpointByUnit**</span><span class="sxs-lookup"><span data-stu-id="0854e-125">**ITextRangeProvider::MoveEndpointByUnit**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-moveendpointbyunit)
-   [<span data-ttu-id="0854e-126">**IUIAutomationTextRange：： Move**</span><span class="sxs-lookup"><span data-stu-id="0854e-126">**IUIAutomationTextRange::Move**</span></span>](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-move)
-   [<span data-ttu-id="0854e-127">**IUIAutomationTextRange::ExpandToEnclosingUnit**</span><span class="sxs-lookup"><span data-stu-id="0854e-127">**IUIAutomationTextRange::ExpandToEnclosingUnit**</span></span>](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-expandtoenclosingunit)
-   [<span data-ttu-id="0854e-128">**IUIAutomationTextRange::MoveEndpointByUnit**</span><span class="sxs-lookup"><span data-stu-id="0854e-128">**IUIAutomationTextRange::MoveEndpointByUnit**</span></span>](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-moveendpointbyunit)

<span data-ttu-id="0854e-129">[**TextUnit**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit)列舉會定義消費者介面自動化文字範圍所支援的文字單位。</span><span class="sxs-lookup"><span data-stu-id="0854e-129">The [**TextUnit**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit) enumeration defines the text units that are supported by UI Automation text ranges.</span></span> <span data-ttu-id="0854e-130">若要指定文字單位， [**TextUnit**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit) 列舉的成員是在 [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) 或 [**IUIAutomationTextRange**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtextrange) 方法的呼叫中指定。</span><span class="sxs-lookup"><span data-stu-id="0854e-130">To specify the text unit, a member of the [**TextUnit**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit) enumeration is specified in a call to an [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) or [**IUIAutomationTextRange**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtextrange) method.</span></span> <span data-ttu-id="0854e-131">文字單位（從最小到最大）如下所示：</span><span class="sxs-lookup"><span data-stu-id="0854e-131">The text units, from smallest to largest, are as follows:</span></span>

-   [<span data-ttu-id="0854e-132">**TextUnit \_ 字元**</span><span class="sxs-lookup"><span data-stu-id="0854e-132">**TextUnit\_Character**</span></span>](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit)
-   [<span data-ttu-id="0854e-133">**TextUnit \_ 格式**</span><span class="sxs-lookup"><span data-stu-id="0854e-133">**TextUnit\_Format**</span></span>](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit)
-   [<span data-ttu-id="0854e-134">**TextUnit \_ Word**</span><span class="sxs-lookup"><span data-stu-id="0854e-134">**TextUnit\_Word**</span></span>](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit)
-   [<span data-ttu-id="0854e-135">**TextUnit \_ 行**</span><span class="sxs-lookup"><span data-stu-id="0854e-135">**TextUnit\_Line**</span></span>](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit)
-   [<span data-ttu-id="0854e-136">**TextUnit \_ 段落**</span><span class="sxs-lookup"><span data-stu-id="0854e-136">**TextUnit\_Paragraph**</span></span>](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit)
-   [<span data-ttu-id="0854e-137">**TextUnit \_ 頁面**</span><span class="sxs-lookup"><span data-stu-id="0854e-137">**TextUnit\_Page**</span></span>](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit)
-   [<span data-ttu-id="0854e-138">**TextUnit \_ 檔**</span><span class="sxs-lookup"><span data-stu-id="0854e-138">**TextUnit\_Document**</span></span>](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit)

<span data-ttu-id="0854e-139">如果特定以文字為基礎的控制項不支援指定的文字單位，則提供者應該以控制項所支援的下一個較大文字單位來回應。</span><span class="sxs-lookup"><span data-stu-id="0854e-139">If a particular text-based control does not support the specified text unit, the provider should respond by substituting the next larger text unit that is supported by the control.</span></span> <span data-ttu-id="0854e-140">例如，如果指定了 [**TextUnit \_ 段落**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit) ，但不支援，則方法可以替代 [**TextUnit \_ 頁面**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit) 或 [**TextUnit \_ 檔**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit)。</span><span class="sxs-lookup"><span data-stu-id="0854e-140">For example, if [**TextUnit\_Paragraph**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit) is specified but not supported, the method can substitute [**TextUnit\_Page**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit) or [**TextUnit\_Document**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit).</span></span>

<span data-ttu-id="0854e-141">來源文字的語言特性可讓提供者難以根據指定的文字單位來判斷文字界限。</span><span class="sxs-lookup"><span data-stu-id="0854e-141">The linguistic characteristics of the source text can make it difficult for a provider to determine text boundaries based on the specified text unit.</span></span> <span data-ttu-id="0854e-142">為了協助判斷文字界限，提供者可以使用 Uniscribe API 函式，例如 [**ScriptBreak**](/windows/desktop/api/usp10/nf-usp10-scriptbreak)。</span><span class="sxs-lookup"><span data-stu-id="0854e-142">For help in determining text boundaries, a provider can use Uniscribe API functions such as [**ScriptBreak**](/windows/desktop/api/usp10/nf-usp10-scriptbreak).</span></span> <span data-ttu-id="0854e-143">如需詳細資訊，請參閱 MSDN 網站上的 [Uniscribe](/windows/desktop/Intl/uniscribe) 。</span><span class="sxs-lookup"><span data-stu-id="0854e-143">For more information, see [Uniscribe](/windows/desktop/Intl/uniscribe) on the MSDN website.</span></span>

## <a name="endpoint-inclusivity"></a><span data-ttu-id="0854e-144">端點包容性</span><span class="sxs-lookup"><span data-stu-id="0854e-144">Endpoint inclusivity</span></span>

<span data-ttu-id="0854e-145">文字單位端點可以作為相同類型之相鄰文字範圍的 [起始](/windows/desktop/api/uiautomationcore/ne-uiautomationcore-textpatternrangeendpoint) 端點和 [端點](/windows/desktop/api/uiautomationcore/ne-uiautomationcore-textpatternrangeendpoint) 端點。</span><span class="sxs-lookup"><span data-stu-id="0854e-145">A text unit endpoint can serve as both a [Start](/windows/desktop/api/uiautomationcore/ne-uiautomationcore-textpatternrangeendpoint) endpoint and an [End](/windows/desktop/api/uiautomationcore/ne-uiautomationcore-textpatternrangeendpoint) endpoint for adjacent text ranges of the same type.</span></span> <span data-ttu-id="0854e-146">如果某個文字單位的結尾也是另一個文字單位的開頭，則包含 [結束](/windows/desktop/api/uiautomationcore/ne-uiautomationcore-textpatternrangeendpoint) 端點的範圍不會共用包含 [開始](/windows/desktop/api/uiautomationcore/ne-uiautomationcore-textpatternrangeendpoint) 端點之相鄰範圍的任何屬性或物件。</span><span class="sxs-lookup"><span data-stu-id="0854e-146">If the end of one text unit is also the start of another text unit, the range containing the [End](/windows/desktop/api/uiautomationcore/ne-uiautomationcore-textpatternrangeendpoint) endpoint does not share any attributes or objects of the adjacent range containing the [Start](/windows/desktop/api/uiautomationcore/ne-uiautomationcore-textpatternrangeendpoint) endpoint.</span></span>

<span data-ttu-id="0854e-147">例如，文字資料流程 "Hello **world**" 包含兩個字型粗細屬性不同的文字單位 (一般和粗體) 。</span><span class="sxs-lookup"><span data-stu-id="0854e-147">For example, a text stream, "Hello **world**", contains two word units with different font weight attributes (normal and bold).</span></span> <span data-ttu-id="0854e-148">在此情況下，文字單位 "Hello" 的 [結束](/windows/desktop/api/uiautomationcore/ne-uiautomationcore-textpatternrangeendpoint)端點和單字單位 "**World**" 的 [開始](/windows/desktop/api/uiautomationcore/ne-uiautomationcore-textpatternrangeendpoint)端點是相同的，因此會產生下列結果：</span><span class="sxs-lookup"><span data-stu-id="0854e-148">In this case, the [End](/windows/desktop/api/uiautomationcore/ne-uiautomationcore-textpatternrangeendpoint) endpoint of the word unit "Hello" and the [Start](/windows/desktop/api/uiautomationcore/ne-uiautomationcore-textpatternrangeendpoint) endpoint of the word unit "**world**" are the same, which results in the following:</span></span>

- <span data-ttu-id="0854e-149">"Hello" 的範圍不會共用字組 "world" 的粗體字屬性，也不會傳回字型粗細文字屬性的 mixed 屬性值。</span><span class="sxs-lookup"><span data-stu-id="0854e-149">The range of "Hello" does not share the bold attribute of the word unit "world" and does not return the mixed attribute value for the font weight text attribute.</span></span>
- <span data-ttu-id="0854e-150">"**World**" 的範圍具有單一字型粗細 (粗體) ，且不會共用上述字組 "Hello" 的字型粗細。</span><span class="sxs-lookup"><span data-stu-id="0854e-150">The range of "**world**" has a single font weight (bold), and does not share the font weight of the preceding word unit “Hello”.</span></span>

<span data-ttu-id="0854e-151">以下是另一個範例，其中的文字資料流程包含兩個單字單元，其中一個是連結： `[Foo]() Bar` 。</span><span class="sxs-lookup"><span data-stu-id="0854e-151">Here's another example where a text stream contains two word units, one of which is a link: `[Foo]() Bar`.</span></span> <span data-ttu-id="0854e-152">在此情況下，單字單元的 [結束](/windows/desktop/api/uiautomationcore/ne-uiautomationcore-textpatternrangeendpoint) 端點 `[Foo]()` 和單字單位 "Bar" 的 [開始](/windows/desktop/api/uiautomationcore/ne-uiautomationcore-textpatternrangeendpoint) 端點是相同的，因此會產生下列結果：</span><span class="sxs-lookup"><span data-stu-id="0854e-152">In this case, the [End](/windows/desktop/api/uiautomationcore/ne-uiautomationcore-textpatternrangeendpoint) endpoint of the word unit `[Foo]()` and the [Start](/windows/desktop/api/uiautomationcore/ne-uiautomationcore-textpatternrangeendpoint) endpoint of the word unit "Bar" are the same, which results in the following:</span></span>

- <span data-ttu-id="0854e-153">連結屬於包含 "Foo" 的文字範圍。</span><span class="sxs-lookup"><span data-stu-id="0854e-153">The link belongs to the text range containing "Foo".</span></span>
- <span data-ttu-id="0854e-154">連結是文字範圍 "Foo" 的子系，並以 [ITextProvider](https://review.docs.microsoft.com/windows/desktop/api/uiautomationcore/nn-uiautomationcore-itextprovider)括住。</span><span class="sxs-lookup"><span data-stu-id="0854e-154">The link is a child of the text range "Foo", and is enclosed by the [ITextProvider](https://review.docs.microsoft.com/windows/desktop/api/uiautomationcore/nn-uiautomationcore-itextprovider).</span></span>
- <span data-ttu-id="0854e-155">文字範圍 "Bar" 沒有子系，而且會以 [ITextProvider](https://review.docs.microsoft.com/windows/desktop/api/uiautomationcore/nn-uiautomationcore-itextprovider)括住。</span><span class="sxs-lookup"><span data-stu-id="0854e-155">The text range "Bar" has no children and and is enclosed by the [ITextProvider](https://review.docs.microsoft.com/windows/desktop/api/uiautomationcore/nn-uiautomationcore-itextprovider).</span></span>

<span data-ttu-id="0854e-156">**其他注意事項：**</span><span class="sxs-lookup"><span data-stu-id="0854e-156">**Additional notes:**</span></span>

> <span data-ttu-id="0854e-157">在具有相同類型之文字範圍的文字單位界限上，退化 (空白) 範圍會假設立即相鄰文字單位的屬性。</span><span class="sxs-lookup"><span data-stu-id="0854e-157">A degenerate (empty) range at a text unit boundary with a text range of the same type assumes properties of the immediately adjacent text unit.</span></span>
>
> <span data-ttu-id="0854e-158">在具有相同類型之文字範圍的文字單位界限上，對一個退化範圍呼叫 [IUIAutomationTextRange：： ExpandToEnclosingUnit](/windows/desktop/api/uiautomationclient/nf-uiautomationclient-iuiautomationtextrange-expandtoenclosingunit
) 時，會將退化範圍展開至下列文字單位。</span><span class="sxs-lookup"><span data-stu-id="0854e-158">Calling [IUIAutomationTextRange::ExpandToEnclosingUnit](/windows/desktop/api/uiautomationclient/nf-uiautomationclient-iuiautomationtextrange-expandtoenclosingunit
) on a degenerate range at a text unit boundary with a text range of the same type, expands the degenerate range to the following text unit.</span></span>

## <a name="text-unit-descriptions"></a><span data-ttu-id="0854e-159">文字單位描述</span><span class="sxs-lookup"><span data-stu-id="0854e-159">Text Unit Descriptions</span></span>

<span data-ttu-id="0854e-160">本節說明消費者介面自動化所支援的每個文字單位。</span><span class="sxs-lookup"><span data-stu-id="0854e-160">This section describes each of the text units supported by UI Automation.</span></span>

### <a name="character"></a><span data-ttu-id="0854e-161">字元</span><span class="sxs-lookup"><span data-stu-id="0854e-161">Character</span></span>

<span data-ttu-id="0854e-162">[**TextUnit \_字元**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit) 是代表單一字元之文字的語言單位。</span><span class="sxs-lookup"><span data-stu-id="0854e-162">[**TextUnit\_Character**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit) is a linguistic unit of text that represents a single character.</span></span> <span data-ttu-id="0854e-163">字元的語言定義會依語言而有所不同。</span><span class="sxs-lookup"><span data-stu-id="0854e-163">The linguistic definition of a character varies by language.</span></span> <span data-ttu-id="0854e-164">若是美式英文，字元通常會以空格或其他字元（例如標點符號、數位或字母）來加上邊框。</span><span class="sxs-lookup"><span data-stu-id="0854e-164">For US English, a character is typically bordered by a space or another character, such as a punctuation mark, a number, or a letter.</span></span>

<span data-ttu-id="0854e-165">像是換行字元的控制字元，以及 Unicode 的左到右標示 (LTM) 不應視為字元，但可以包含在根據字元文字單位正規化的文字範圍中。</span><span class="sxs-lookup"><span data-stu-id="0854e-165">Control characters such as carriage returns and the Unicode left-to-right mark (LTM) should not be considered as characters, but may be included in a text range that is normalized based on the character text unit.</span></span>

<span data-ttu-id="0854e-166">標點符號和斷字字元（例如空格）應該視為字元。</span><span class="sxs-lookup"><span data-stu-id="0854e-166">Punctuation marks and word break characters such as spaces should be considered as characters.</span></span>

### <a name="format"></a><span data-ttu-id="0854e-167">格式</span><span class="sxs-lookup"><span data-stu-id="0854e-167">Format</span></span>

<span data-ttu-id="0854e-168">[**TextUnit \_格式**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit) 是用來根據文字的格式化屬性，來定位文字範圍的界限。</span><span class="sxs-lookup"><span data-stu-id="0854e-168">[**TextUnit\_Format**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit) is used to position the boundary of a text range based on the formatting attributes of the text.</span></span> <span data-ttu-id="0854e-169">例如，如果文字範圍目前定位於單字的單一字元，則在 [**IUIAutomationTextRange：： ExpandToEnclosingUnit**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-expandtoenclosingunit)的呼叫中指定 **TextUnit \_ 格式** 會展開文字範圍，以包含所有與單一字元共用所有相同屬性的文字。</span><span class="sxs-lookup"><span data-stu-id="0854e-169">For example, if a text range is currently positioned on a single character of a word, specifying **TextUnit\_Format** in a call to [**IUIAutomationTextRange::ExpandToEnclosingUnit**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-expandtoenclosingunit) expands the text range to include all text that shares all the same attributes as the single character.</span></span> <span data-ttu-id="0854e-170">產生的文字範圍不一定會包含整個單字。</span><span class="sxs-lookup"><span data-stu-id="0854e-170">The resulting text range might or might not include the entire word.</span></span> <span data-ttu-id="0854e-171">此外，使用格式文字單位並不會在内嵌物件（例如影像或超連結）的界限上展開文字範圍。</span><span class="sxs-lookup"><span data-stu-id="0854e-171">Also, using the format text unit will not expand a text range across the boundary of an embedded object such as an image or hyperlink.</span></span>

<span data-ttu-id="0854e-172">不同于其他文字單位（包含小於自身的文字單位）， [**TextUnit \_ 格式**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit) 可以比其他單位小或大。</span><span class="sxs-lookup"><span data-stu-id="0854e-172">Unlike the other text units, which include the text units that are smaller than themselves, [**TextUnit\_Format**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit) can be smaller or larger than the other units.</span></span> <span data-ttu-id="0854e-173">例如，如果整份檔共用相同的 text 屬性，且不包含任何内嵌物件，依 **TextUnit \_ 格式** 展開文字範圍將會建立包含整份檔的新範圍，而依 [**TextUnit \_ Word**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit) 展開文字範圍會建立較小的範圍。</span><span class="sxs-lookup"><span data-stu-id="0854e-173">For example, if an entire document shares the same text attributes and contains no embedded objects, expanding a text range by **TextUnit\_Format** would create a new range that encompasses the entire document, while expanding the text range by [**TextUnit\_Word**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit) would create a smaller range.</span></span>

### <a name="word"></a><span data-ttu-id="0854e-174">Word</span><span class="sxs-lookup"><span data-stu-id="0854e-174">Word</span></span>

<span data-ttu-id="0854e-175">[**TextUnit \_Word**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit) 是代表單一單字的文字語言單位。</span><span class="sxs-lookup"><span data-stu-id="0854e-175">[**TextUnit\_Word**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit) is a linguistic unit of text that represents a single, whole word.</span></span> <span data-ttu-id="0854e-176">單字的語言定義會因語言而異。</span><span class="sxs-lookup"><span data-stu-id="0854e-176">The linguistic definition of a word varies by language.</span></span> <span data-ttu-id="0854e-177">針對美式英文，單字通常會以空格或標點符號字元分隔。</span><span class="sxs-lookup"><span data-stu-id="0854e-177">For US English, words are typically bordered by spaces or punctuation characters.</span></span>

<span data-ttu-id="0854e-178">當 [**TextUnit \_ Word**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit) 用來設定文字範圍的界限時，產生的文字範圍應包含出現在單字結尾，但在下一個單字開頭之前的任何斷詞字元。</span><span class="sxs-lookup"><span data-stu-id="0854e-178">When [**TextUnit\_Word**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit) is used to set the boundary of a text range, the resulting text range should include any word break characters that are present at the end of the word, but before the start of the next word.</span></span>

### <a name="line"></a><span data-ttu-id="0854e-179">線條</span><span class="sxs-lookup"><span data-stu-id="0854e-179">Line</span></span>

<span data-ttu-id="0854e-180">[**TextUnit \_線條**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit) 是一種文字單位，代表控制項的各方面所呈現的單一文字行。</span><span class="sxs-lookup"><span data-stu-id="0854e-180">[**TextUnit\_Line**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit) is a unit of text that represents a single line of text as presented in the viewport of the control.</span></span> <span data-ttu-id="0854e-181">使用 **TextUnit \_ 線** 設定文字範圍的界限時，提供者應該在控制字元中斷該行的點之後立即設定界限，或讓控制項的視口將文字換行至新行。</span><span class="sxs-lookup"><span data-stu-id="0854e-181">When using **TextUnit\_Line** to set the boundary of a text range, a provider should set the boundary immediately after the point where a control character breaks the line, or where the viewport of the control wraps the text to a new line.</span></span> <span data-ttu-id="0854e-182">界限應該在新行開始時設定。</span><span class="sxs-lookup"><span data-stu-id="0854e-182">The boundary should be set where a new line starts.</span></span>

### <a name="paragraph"></a><span data-ttu-id="0854e-183">Paragraph</span><span class="sxs-lookup"><span data-stu-id="0854e-183">Paragraph</span></span>

<span data-ttu-id="0854e-184">[**TextUnit \_段落**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit) 是表示完整段落的語言文字。</span><span class="sxs-lookup"><span data-stu-id="0854e-184">[**TextUnit\_Paragraph**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit) is a linguistic unit of text that represents a complete paragraph.</span></span> <span data-ttu-id="0854e-185">段落應該在段落的第一個字元之前開始，而且通常會在最後一個字元之後結束。</span><span class="sxs-lookup"><span data-stu-id="0854e-185">A paragraph should begin just before the first character of a paragraph and should typically end just after the last character.</span></span> <span data-ttu-id="0854e-186">段落後面的任何空白行都應該合併到段落中，除非文字來源中的某些內容表示其他。</span><span class="sxs-lookup"><span data-stu-id="0854e-186">Any empty lines following a paragraph should be merged into the paragraph, unless something in the text source indicates otherwise.</span></span> <span data-ttu-id="0854e-187">通常，段落的結束界限也會標示 [**TextUnit \_ 線**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit) 文字單位的結束界限。</span><span class="sxs-lookup"><span data-stu-id="0854e-187">Typically, the end boundary of a paragraph also marks the end boundary of a [**TextUnit\_Line**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit) text unit.</span></span>

### <a name="page"></a><span data-ttu-id="0854e-188">頁面</span><span class="sxs-lookup"><span data-stu-id="0854e-188">Page</span></span>

<span data-ttu-id="0854e-189">[**TextUnit \_頁面**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit) 代表檔的完整文字頁面。</span><span class="sxs-lookup"><span data-stu-id="0854e-189">[**TextUnit\_Page**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit) represents a complete text page of a document.</span></span> <span data-ttu-id="0854e-190">頁面的界限應該在頁面開始和結束的立即點設定。</span><span class="sxs-lookup"><span data-stu-id="0854e-190">The boundaries of a page should be set at the immediate points where a page starts and ends.</span></span>

### <a name="document"></a><span data-ttu-id="0854e-191">文件</span><span class="sxs-lookup"><span data-stu-id="0854e-191">Document</span></span>

<span data-ttu-id="0854e-192">[**TextUnit \_檔**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit) 代表 [文字](uiauto-implementingtextandtextrange.md) 控制項模式所支援之檔的整個內容。</span><span class="sxs-lookup"><span data-stu-id="0854e-192">[**TextUnit\_Document**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit) represents the entire contents of a document as supported by the [Text](uiauto-implementingtextandtextrange.md) control pattern.</span></span> <span data-ttu-id="0854e-193">包含檔的文字範圍之外不應有任何文字。</span><span class="sxs-lookup"><span data-stu-id="0854e-193">No text should exist outside of a text range that contains a document.</span></span> <span data-ttu-id="0854e-194">插入檔中的任何物件（例如跨頁面界限的注釋附注），都應該視為檔的内嵌物件，而不是檔文字內容的一部分。</span><span class="sxs-lookup"><span data-stu-id="0854e-194">Any objects that are inserted into a document, such as annotation notes that cross a page boundary, should be treated as embedded objects of the document and not part of the document's text content.</span></span>

## <a name="other-potential-ranges"></a><span data-ttu-id="0854e-195">其他可能的範圍</span><span class="sxs-lookup"><span data-stu-id="0854e-195">Other Potential Ranges</span></span>

<span data-ttu-id="0854e-196">目前的 [TextRange](uiauto-implementingtextandtextrange.md) 控制項模式規格不允許將新的文字單位值新增至 [**TextUnit**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit) 列舉，也不允許重新定義現有的文字單位值。</span><span class="sxs-lookup"><span data-stu-id="0854e-196">The current [TextRange](uiauto-implementingtextandtextrange.md) control pattern specification does not allow new text unit values to be added to the [**TextUnit**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit) enumeration, nor does it allow the existing text unit values to be redefined.</span></span> <span data-ttu-id="0854e-197">若要公開其他可能的範圍，例如標頭和注釋，提供者應該將這些範圍公開為具有相關聯文字範圍的内嵌物件。</span><span class="sxs-lookup"><span data-stu-id="0854e-197">To expose other potential ranges, such as headers and annotations, a provider should expose these ranges as embedded objects with an associated text range.</span></span> <span data-ttu-id="0854e-198">如此一來，您也可以新增適當控制項模式的支援。</span><span class="sxs-lookup"><span data-stu-id="0854e-198">That way, you can also add support for the appropriate control patterns.</span></span> <span data-ttu-id="0854e-199">此解決方案比定義新的文字單位更有彈性且可擴充。</span><span class="sxs-lookup"><span data-stu-id="0854e-199">This solution is more flexible and extensible than defining new text units.</span></span>

## <a name="related-topics"></a><span data-ttu-id="0854e-200">相關主題</span><span class="sxs-lookup"><span data-stu-id="0854e-200">Related topics</span></span>

### <a name="reference"></a><span data-ttu-id="0854e-201">參考</span><span class="sxs-lookup"><span data-stu-id="0854e-201">Reference</span></span>

[<span data-ttu-id="0854e-202">TextPatternRangeEndpoint</span><span class="sxs-lookup"><span data-stu-id="0854e-202">TextPatternRangeEndpoint</span></span>](/windows/desktop/api/uiautomationcore/ne-uiautomationcore-textpatternrangeendpoint)

[<span data-ttu-id="0854e-203">ITextRangeProvider：： GetChildren</span><span class="sxs-lookup"><span data-stu-id="0854e-203">ITextRangeProvider::GetChildren</span></span>](/windows/win32/api/uiautomationcore/nf-uiautomationcore-itextrangeprovider-getchildren)





### <a name="conceptual"></a><span data-ttu-id="0854e-204">概念</span><span class="sxs-lookup"><span data-stu-id="0854e-204">Conceptual</span></span>

[<span data-ttu-id="0854e-205">消費者介面自動化文字內容的支援</span><span class="sxs-lookup"><span data-stu-id="0854e-205">UI Automation Support for Textual Content</span></span>](uiauto-ui-automation-textpattern-overview.md)

[<span data-ttu-id="0854e-206">使用以文字為基礎的控制項</span><span class="sxs-lookup"><span data-stu-id="0854e-206">Working with Text-based Controls</span></span>](uiauto-workingwithtextbasedcontrols.md)