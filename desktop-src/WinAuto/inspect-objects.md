---
title: 協助工具工具-檢查
description: 檢查 (Inspect.exe) 是以 Windows 為基礎的工具，可讓您選取任何 UI 元素，並查看元素的協助工具資料。
ms.assetid: 38edacbc-cf24-4818-b029-561b21e3704c
keywords:
- 檢查工具
- 協助工具選項
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 1770c6c4db812ea7d2880c50fcc72cd0edc15022
ms.sourcegitcommit: 3e70ae762629e244028b437420ed50b5850db4e3
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 02/20/2020
ms.locfileid: "104374622"
---
# <a name="accessibility-tools---inspect"></a>協助工具工具-檢查

**檢查** (Inspect.exe) 是以 Windows 為基礎的工具，可讓您選取任何 UI 元素，並查看元素的協助工具資料。 您可以查看 Microsoft 消費者介面自動化的屬性和控制項模式，以及 Microsoft Active Accessibility 屬性。 **檢查** 也可讓您測試消費者介面自動化樹狀結構中 automation 元素的導覽結構，以及 Microsoft Active Accessibility 階層中的可存取物件。

**檢查** 是否隨 WINDOWS 軟體開發套件 (SDK) 一起安裝。  (也可在舊版的 Windows SDK 中使用。 ) 它位於 \\ \\ < SDK 安裝路徑的 bin *版本* > \\ < *平臺*> 資料夾 (Inspect.exe) 。

> [!NOTE]
> **檢查** 是舊版工具。 建議您改為使用 [協助工具深入](https://accessibilityinsights.io/) 解析。

## <a name="requirements"></a>規格需求

您可以使用 **檢查** 來檢查沒有消費者介面自動化的系統上的協助工具資料，但只能檢查 Microsoft Active Accessibility 屬性。 若要檢查消費者介面自動化，消費者介面自動化必須存在於系統上。 如需詳細資訊，請參閱 [消費者介面自動化](entry-uiauto-win32.md)的「需求」一節。

**檢查** 會安裝為 Windows SDK 的整體工具組的一部分，而不是以個別下載方式來散發。 Windows SDK 包含本節中記載的所有協助工具相關工具。 [取得 Windows SDK。](https://developer.microsoft.com/) 如果您需要先前的版本， (也有從該頁面連結的 SDK 下載封存。 ) 

若要執行 [**檢查**]，請在 [ \\ bin 版本平臺>] 資料夾中尋找 Inspect.exe， \\ <  > \\ < 然後執行它 (您通常不需要以系統管理員身分執行) 。

## <a name="the-inspect-window"></a>[檢查] 視窗

[ **檢查** ] 視窗有幾個主要部分：

- 標題列： 顯示 (HWND) 的 [ **檢查** ] 視窗控制碼。
- 功能表列： 提供 **檢查** 功能的存取權。
- 工具 欄。 提供 **檢查** 功能的存取權。
- 樹狀檢視。 以樹狀檢視控制項的形式提供 UI 專案的階層式結構，讓您可以用來在專案之間流覽。
- 資料檢視。 顯示所選 UI 元素的所有公開協助工具屬性。

功能表列中的可用命令也可在工具列中使用。 以下影像顯示 **Inspect** 工具正在查詢「記事本」中 **\[編輯\]** 功能表元素的使用者介面自動化屬性。

![顯示檢查工具之使用者介面的螢幕擷取畫面](images/inspect.png)

## <a name="using-inspect"></a>使用檢查

當您開始 **檢查** 時， **樹** 視圖會在專案階層中顯示目前選取之 ui 元素的位置，而 **資料** 視圖會顯示所選 ui 元素的屬性資訊。 您可以流覽 UI 來查看 UI 中每個元素的協助工具資訊。 依預設， **檢查** 會追蹤鍵盤或滑鼠焦點。 當焦點變更時， **資料** 視圖會以具有焦點之元素的屬性資訊進行更新。

若要在 UI 元素之間流覽，您可以使用下列任何一項：

- 滑鼠
- 鍵盤
- **樹** 視圖中的樹狀檢視控制項
- **導覽** 功能表中的導覽選項
- 工具列中的導覽選項

最後三個選項可讓您流覽 UI 的樹狀結構階層。 此樹狀結構的結構在消費者介面自動化和 Microsoft Active Accessibility 模式之間可能稍有不同。

## <a name="verifying-accessibility-property-information"></a>驗證協助工具屬性資訊

**資料** 視圖會顯示目前選取之 UI 元素的屬性資訊。 您可以設定 [ **檢查** ]，以顯示所有協助工具屬性的相關資訊或這些屬性的子集。 您也可以指定其他的視圖選項，例如 **檢查** 應該保留在其他使用者介面之上，還是 **檢查** 是否應在選取的元素周圍反白顯示周框。 當您設定 [ **檢查** ] 以您想要的方式運作之後，您就可以開始在 UI 專案之間導覽，以及查看屬性資訊。 **檢查** 會在關閉時儲存您的設定，並使用這些設定來初始化下次 **檢查** 會話。

### <a name="configure-property-settings"></a>設定屬性設定

1. 從 [ **選項** ] 功能表選取 [ **設定**]，或從工具列選取 [ **顯示設定] 對話方塊** 。
2. 在 **主視窗的 [顯示]** 清單中，選取您要在 [**檢查**] 的 [**資料**] 查看中顯示的屬性。
3. 在 **資訊工具提示** 清單的 [顯示] 中，選取您要在工具提示中顯示的屬性。
4. 若要查看 UI 元素可能不支援的屬性，請選取 [ **顯示不支援的屬性** ] 方塊。
5. 按一下 [確定]  。

### <a name="to-configure-viewing-options"></a>設定查看選項

- 在 [ **選項** ] 功能表或工具列中，您可以選取下列的視圖選項。

| 選取此選項時 | **檢查** 是否有                                                                                                                                                                                                              |
|------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 永遠開啟頂端                | 會顯示在螢幕上的任何其他視窗上方。                                                                                                                                                                                  |
| MSAA 模式                    | 顯示 Microsoft Active Accessibility 屬性資訊。                                                                                                                                                                      |
| 消費者介面自動化模式           | 顯示消費者介面自動化屬性資訊。                                                                                                                                                                                       |
| 僅可見的 Windows View    | 僅適用于 MSAA 模式。                                                                                                                                                                                                       |
| 未經處理的檢視                     | 顯示 **樹** 視圖中消費者介面自動化樹狀結構或 MSAA 樹狀結構的 [原始視圖](uiauto-treeoverview.md)。                                                                                                             |
| 控制項檢視                 | 在 **樹** 視圖中顯示消費者介面自動化樹狀結構的 [控制項視圖](uiauto-treeoverview.md)。 僅適用于消費者介面自動化模式。                                                                            |
| 內容檢視                 | 在 **樹** 視圖中顯示消費者介面自動化樹狀結構的 [內容視圖](uiauto-treeoverview.md)。 僅適用于消費者介面自動化模式。                                                                            |
| 現用暫止工具列         | 在滑鼠停留時啟用工具列按鈕，而不需要按滑鼠按鍵。                                                                                                                                                      |
| 發生錯誤時嗶聲                | 當消費者介面自動化或 MSAA 作業期間偵測到錯誤時，發出嗶聲。                                                                                                                                                          |
| SPI \_ SCREENREADER 旗標       | 假設螢幕讀取器存在。 此旗標表示應用程式應該以資料的方式提供資訊，而非以圖形方式提供資訊。 您不應該假設已設定此旗標，因為螢幕讀取器已存在。         |
| 顯示反白顯示矩形     | 反白顯示具有焦點之元素周圍的矩形。                                                                                                                                                                              |
| 顯示插入號醒目提示         | 反白顯示插入號。 僅適用于 MSAA 模式。                                                                                                                                                                                 |
| 顯示資訊工具提示     | 顯示工具提示中的屬性資訊。                                                                                                                                                                                           |
| 觀賞焦點                  | 遵循鍵盤焦點。 若選取此選項，則會安裝非同步焦點事件勾點，並將插入點移至具有焦點的元素左上角。 這會導致 **檢查** 在大約一秒內重新整理其屬性。 |
| 觀賞插入號                  | 遵循插入號。 僅適用于 MSAA 模式。                                                                                                                                                                                    |
| 監看游標                 | 在游標之後。                                                                                                                                                                                                                |
| 監看工具提示               | 遵循工具提示。                                                                                                                                                                                                              |
| 顯示樹狀結構                    | 顯示 **樹** 視圖。                                                                                                                                                                                                        |

## <a name="verifying-accessibility-navigation"></a>驗證協助工具導覽

當您使用 [ **檢查**] 來選取 UI 元素之後，就可以驗證該專案是否公開輔助技術產品的正確 Windows 自動化導覽。

### <a name="verify-accessibility-navigation"></a>確認協助工具導覽

1. 開啟 [ **檢查** ] 和您想要測試的應用程式。
2. 選取您要從中開始導覽的 UI 元素。
3. 在 [ **資料** ] 窗格中，確認元素會公開正確的導覽相關屬性。
4. 使用 **樹** 視圖、 **導覽** 功能表或工具列上的瀏覽按鈕來流覽 UI，並確認每個元素都公開正確的導覽相關屬性。
    > [!Note]  
    > **導覽** 功能表選項和導覽工具列按鈕會根據選取的專案在樹狀結構中的位置而變更。

## <a name="interacting-with-ui-elements"></a>與 UI 元素互動

Windows Automation 公開的方法可讓輔助技術產品與 UI 元素互動，就像是使用滑鼠或鍵盤一樣 (例如，按一下按鈕) 。 [ **檢查** 動作] 功能表可讓測試人員在元素上叫用 Windows Automation 方法 (例如，叫用 **。 invoke** 會) 呼叫 [**IUIAutomationInvokePattern：： invoke**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationinvokepattern-invoke) 方法。

### <a name="interact-with-ui-elements"></a>與 UI 元素互動

1. 開啟 [ **檢查** ] 和您想要測試的應用程式。
2. 選取您要與之互動的 UI 元素。
3. 從 [ **動作** ] 功能表或工具列中，選取對應至您想要叫用之 Windows Automation 方法的動作。

[**動作**] 功能表包含 [重新整理] 和 [**焦點**] 專案，以及根據選取的消費者介面自動化模式或 MSAA 模式而 **有所不同的其他** 專案。 在消費者介面自動化模式中，其他專案會反映目前選取的 UI 元素所支援的控制項模式。 在 MSAA 模式中，其他專案一律是由下列專案所組成：

| 動作                | 描述                                                                                                           |
|-----------------------|-----------------------------------------------------------------------------------------------------------------------|
| 重新整理               | 重新整理使用者介面。 可在 MSAA 和消費者介面自動化模式中使用。                                               |
| 預設動作        | 執行元素的預設動作。                                                                          |
| 焦點                 | 設定元素的焦點。 可在 MSAA 和消費者介面自動化模式中使用。                                                  |
| 選取                | 選取元素。                                                                                                  |
| 擴充選取範圍      | 擴充專案的選取範圍，以包含第一個選取專案與目前專案之間的所有元素。 |
| 加入至選取範圍      | 選取目前的專案 (例如清單專案) 。                                                                    |
| 從選取範圍移除 | 從選取專案移除目前的專案。                                                                       |
| SetAccValue           | 將元素的 Microsoft Active Accessibility 值設定為指定的字串。                                 |
| 焦點的子系         | 導覽至目前擁有焦點之專案的子系。                                                       |
| 在游標處 System.windows.media.visualtreehelper.hittest     | 導覽至滑鼠游標所指定之元素的子系。                                                      |
| System.windows.media.visualtreehelper.hittest .。。            | 開啟 [ **system.windows.media.visualtreehelper.hittest** ] 對話方塊。                                                                                     |



 

## <a name="keyboard-shortcuts"></a>鍵盤快速鍵

即使 **檢查** 不是作用中的應用程式，也可以使用鍵盤快速鍵來叫用許多功能表項目。 不過請注意，快速鍵會與某些應用程式發生衝突。

下列鍵盤快速鍵會啟動功能表上的各種選項：



| 作法                                                                                                                                       | 使用此鍵盤快速鍵 |
|--------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------|
| 叫用游標下的物件預設動作， (執行預設動作) 。 僅適用于 MSAA 模式。                                       | CTRL+SHIFT+F2              |
| 選取游標下的物件 (選取 [) ]。 僅適用于 MSAA 模式。                                                                        | CTRL+SHIFT+F3              |
| 將鍵盤焦點設定在游標下的物件 (焦點) 。                                                                                   | CTRL + SHIFT + F4              |
| 從游標下的物件移至上一個同級物件。 此命令只會在容器 (先前的同級) 中導覽至物件。 | CTRL+SHIFT+F5              |
| 移至物件的父系 (父) 。                                                                                                            | CTRL+SHIFT+F6              |
| 移至目前物件的第一個子系 (第一個子) 。                                                                                     | CTRL + SHIFT + F7              |
| 從游標下的位置移至下一個同級物件。 此命令只會在容器內 (下一個同級) 中導覽至物件。         | CTRL + SHIFT + F8              |
| 移至目前物件的最後一個子系， (最後一個子) 。                                                                                       | CTRL+SHIFT+F9              |
| 移至滑鼠游標下的物件 (游標) 的 System.windows.media.visualtreehelper.hittest。 僅適用于 MSAA 模式。                                                      | CTRL+SHIFT+1               |
| 將資料檢視的內容複寫到剪貼簿， (複製所有) 。                                                                                  | CTRL+SHIFT+4               |
| 重新整理資料檢視的內容 (重新整理) 。                                                                                                 | CTRL+SHIFT+5               |
| 觀賞焦點 (觀看焦點) 的物件。                                                                                                   | CTRL+SHIFT+6               |
| 移至游標停留 (左邊) 的同級物件。 僅適用于 MSAA 模式。                                        | CTRL+SHIFT+7               |
| 移至物件上方的同級物件，游標停留在 () 。 僅適用于 MSAA 模式。                                                | CTRL+SHIFT+8               |
| 移至游標上方 (下) 的同級物件。 僅適用于 MSAA 模式。                                                 | CTRL+SHIFT+9               |
| 移至游標停留 (右邊) 的同級物件。 僅適用于 MSAA 模式。                                      | CTRL + SHIFT + 0               |

## <a name="related-topics"></a>相關主題

- [協助工具事件監控程式](accessible-event-watcher.md)
- [測試控管](testing-tools.md)
- [UI 協助工具檢查程式](ui-accessibility-checker.md)
- [使用者介面自動化確認](ui-automation-verify.md)
- [AccScope](accscope.md)
