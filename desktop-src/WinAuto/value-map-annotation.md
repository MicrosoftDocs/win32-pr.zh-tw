---
title: 值對應注釋
description: 值對應注釋
ms.assetid: f7c9304a-0eed-4a73-ab06-56723f3cfa5d
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 8d21b04374344475689989c2570af6975dc97c13
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 09/16/2019
ms.locfileid: "104560894"
---
# <a name="value-map-annotation"></a>值對應注釋

使用值對應注釋，您可以使用對應字串來指出清單視圖或樹狀檢視中專案的影像索引如何對應至其角色或狀態。 例如，對應字串可能表示清單視圖的影像索引0對應到核取方塊的角色，而影像索引1則對應到選項按鈕的角色。

您也可以使用「值對應注釋」來指定對應至滑杆上數值的字串。

## <a name="when-to-use-this-technique"></a>使用這項技術的時機

在下列情況下，請考慮使用值對應注釋。

-   當主控描繪的清單視圖或樹狀檢視合併使用影像時，您想要根據該影像提供自訂的可存取描述 ([**description**](description-property.md) 屬性) 。 下圖顯示一個範例。

    ![[開始] 功能表的圖例，其中圖示提供視覺線索給內容](images/iconlist.gif)

-   當主控描繪的清單視圖或樹狀檢視控制項合併使用影像，使樹狀目錄或清單專案的作用像是簡單控制項（通常是核取方塊或選項按鈕），而您想要將影像對應至角色。 下列螢幕擷取畫面顯示範例。

    ![internet explorer 選項設定核取方塊和選項按鈕值的螢幕擷取畫面](images/customlist.gif)

-   使用滑杆來選取可以描述為簡單整數以外的值時，如下列螢幕擷取畫面所示，其中的螢幕解析度設定會以字串描述。

    ![用來設定螢幕解析度之滑杆的螢幕擷取畫面](images/slider.gif)

使用值對應注釋，對應字串會指出清單或樹狀結構的影像索引如何對應至其角色或狀態。 或者，它可以指出滑杆的數值如何對應至字串。 例如，對應字串可能表示清單視圖的影像索引0對應到核取方塊的角色，而影像索引1則對應到選項按鈕的角色。 使用 [**IAccPropServices：： SetHwndPropStr ()**](/windows/desktop/api/Oleacc/nf-oleacc-iaccpropservices-sethwndpropstr) 將對應字串附加至控制項。

由於需要控制項專屬知識才能支援值對應，因此支援值對應注釋的控制項和屬性數目有限，包括滑杆值對應、清單視圖和樹狀檢視。

## <a name="slider-value-map&quot;></a>滑杆值對應

**PROPID \_ACC \_ VALUEMAP** 包含從內部滑杆位置到人們可讀取字串的對應。 Oleacc.dll 滑杆 proxy 支援此屬性。 如果在值對應中找到目前的滑杆值，對應的字串就會公開為值，而不是預設的百分比字串 (例如 &quot;50" ) 。

## <a name="list-view-and-tree-view"></a>清單視圖和樹狀檢視

**PROPID \_ACC \_ ROLEMAP**、 **PROPID \_ ACC \_ STATEMAP** 和 **PROPID \_ ACC \_ DESCRIPTONMAP** 提供從狀態映射索引到角色和狀態值的對應。 這些對應可讓這些映射索引對應到適當的角色 (通常是 [**角色 \_ 系統 \_ 選項按鈕**](object-roles.md) 或 [**角色 \_ 系統 \_ CHECKBUTTON**](object-roles.md)) 和其他狀態位 (通常會 [**\_ \_ 檢查) 狀態系統**](object-state-constants.md) 。

如需值對應注釋的詳細資訊，請參閱下列主題：

-   [使用值對應注釋](using-value-map-annotation.md)
-   [值對應注釋範例](value-map-annotation-sample.md)

## <a name="annotation-map-format"></a>注釋地圖格式

下表描述批註對應中包含的欄位。



| 欄位               | 描述                                                                                                                                                                                                                                                                   |
|---------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 的                 | 表示使用特定的編碼配置。 未來的編碼配置可能會支援其他首碼。                                                                                                                                                          |
| 分隔符號 | 通常會使用冒號 (： ) ，但可以是 **Null** 或空白以外的另一個字元。 因為此字元將作為其餘欄位的分隔符號，所以不能當做地圖中值的一部分使用。                                               |
| 0、1或2          | 值，指出正在使用的索引鍵。 針對樹狀檢視和清單視圖角色和狀態對應，此索引鍵可以是 0 (映射索引) 、1 (狀態影像索引) ，或 2 (重迭影像索引) 。 針對滑杆和其他不提供按鍵選擇的控制項，此值必須為0。 |
| 分隔符號 | :                                                                                                                                                                                                                                                                             |
| 索引鍵/值組     | 每個配對都包含一個金鑰字串和一個分隔符號。 索引鍵字串是一個數位，而且可能是以十進位或十六進位 (開頭為 "0x" 前置詞) 格式。                                                                                                            |
| 值字串        | 如果是值對應，這就是字串。 針對角色和狀態對應，這是數位 (十進位或十六進位) 。                                                                                                                                                                         |
| 分隔符號 | :                                                                                                                                                                                                                                                                             |



 

例如，地圖看起來可能如下所示：


```C++
A:0:0:Cold:1:Warm:3:Hot:
```



將此值對應套用至滑杆控制項時，當滑杆位於位置1時，將會公開 "暖" 值。 因為這個範例不包含值2，所以會公開該位置的預設值。 若為滑杆，預設值會是百分比值，例如33。

 

 




