---
title: 使用伺服器注釋
description: 本主題提供使用伺服器批註來指定回呼物件的相關資訊。
ms.assetid: eeeebddc-2752-4d8f-b4fa-38ce156acc08
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: cb545cd4dd016901d69f67d5ab5cab15dda08875
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/20/2020
ms.locfileid: "106976338"
---
# <a name="using-server-annotation"></a><span data-ttu-id="5c65c-103">使用伺服器注釋</span><span class="sxs-lookup"><span data-stu-id="5c65c-103">Using Server Annotation</span></span>

<span data-ttu-id="5c65c-104">本主題提供使用伺服器批註來指定回呼物件的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="5c65c-104">This topic provides information about using server annotation to specify a callback object.</span></span>

<span data-ttu-id="5c65c-105">**覆寫指定回呼物件的屬性**</span><span class="sxs-lookup"><span data-stu-id="5c65c-105">**To override a property that specifies a callback object**</span></span>

1.  <span data-ttu-id="5c65c-106">取得要加上批註之可存取元素的 [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) 介面指標。</span><span class="sxs-lookup"><span data-stu-id="5c65c-106">Obtain an [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) interface pointer to the accessible element that is to be annotated.</span></span>
2.  <span data-ttu-id="5c65c-107">在可存取的專案上呼叫 [**QueryInterface**](/windows/desktop/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) ，以取得 [**IAccIdentity**](/windows/desktop/api/oleacc/nn-oleacc-iaccidentity) 介面指標。</span><span class="sxs-lookup"><span data-stu-id="5c65c-107">Call [**QueryInterface**](/windows/desktop/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) on the accessible element to get an [**IAccIdentity**](/windows/desktop/api/oleacc/nn-oleacc-iaccidentity) interface pointer.</span></span>
3.  <span data-ttu-id="5c65c-108">在 [**IAccIdentity**](/windows/desktop/api/oleacc/nn-oleacc-iaccidentity)介面指標上呼叫 [**IAccIdentity：： GetIdentityString ()**](/windows/desktop/api/Oleacc/nf-oleacc-iaccidentity-getidentitystring) ，以取得可唯一識別要標注之可存取專案的字串。</span><span class="sxs-lookup"><span data-stu-id="5c65c-108">Call [**IAccIdentity::GetIdentityString()**](/windows/desktop/api/Oleacc/nf-oleacc-iaccidentity-getidentitystring) on the [**IAccIdentity**](/windows/desktop/api/oleacc/nn-oleacc-iaccidentity) interface pointer to obtain a string that uniquely identifies the accessible element that is to be annotated.</span></span>
4.  <span data-ttu-id="5c65c-109">使用 [**CoCreateInstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance) 或 [**CoCreateInstanceEx**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstanceex) 來建立 [**IAccPropServices**](/windows/desktop/api/oleacc/nn-oleacc-iaccpropservices) 物件。</span><span class="sxs-lookup"><span data-stu-id="5c65c-109">Use [**CoCreateInstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance) or [**CoCreateInstanceEx**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstanceex) to create the [**IAccPropServices**](/windows/desktop/api/oleacc/nn-oleacc-iaccpropservices) object.</span></span>
5.  <span data-ttu-id="5c65c-110">建立元件物件模型 (COM) 物件，該物件會執行 [**IAccPropServer**](/windows/desktop/api/oleacc/nn-oleacc-iaccpropserver)。</span><span class="sxs-lookup"><span data-stu-id="5c65c-110">Create a Component Object Model (COM) object that implements [**IAccPropServer**](/windows/desktop/api/oleacc/nn-oleacc-iaccpropserver).</span></span>
6.  <span data-ttu-id="5c65c-111">呼叫 [**IAccPropServices：： SetPropServer**](/windows/desktop/api/Oleacc/nf-oleacc-iaccpropservices-setpropserver)，傳遞識別字串、指出要覆寫之屬性的 GUID，以及 [**IAccPropServer**](/windows/desktop/api/oleacc/nn-oleacc-iaccpropserver) 回呼物件的指標。</span><span class="sxs-lookup"><span data-stu-id="5c65c-111">Call [**IAccPropServices::SetPropServer**](/windows/desktop/api/Oleacc/nf-oleacc-iaccpropservices-setpropserver), passing the identity string, a GUID indicating the property to be overridden, and a pointer to the [**IAccPropServer**](/windows/desktop/api/oleacc/nn-oleacc-iaccpropserver) callback object.</span></span>
7.  <span data-ttu-id="5c65c-112">發行介面指標和可用記憶體。</span><span class="sxs-lookup"><span data-stu-id="5c65c-112">Release interface pointers and free memory.</span></span>

<span data-ttu-id="5c65c-113">當用戶端要求可存取專案的屬性時，將會呼叫回呼物件，並將值傳回給用戶端。</span><span class="sxs-lookup"><span data-stu-id="5c65c-113">When a client requests the property of the accessible element, the callback object will be called and will return the value to the client.</span></span>

<span data-ttu-id="5c65c-114">當指定值時，伺服器開發人員也可以使用 [**IAccPropServices：： ComposeHwndIdentityString**](/windows/desktop/api/Oleacc/nf-oleacc-iaccpropservices-composehwndidentitystring) 方法來取得識別字串;或者，他們可以使用 [**IAccPropServices：： SetHwndPropServer**](/windows/desktop/api/Oleacc/nf-oleacc-iaccpropservices-sethwndpropserver) 方法，並指定 *hwnd*、 *idObject* 或 *idChild* 參數，而非識別字串。</span><span class="sxs-lookup"><span data-stu-id="5c65c-114">As when specifying a value, server developers can alternatively use the [**IAccPropServices::ComposeHwndIdentityString**](/windows/desktop/api/Oleacc/nf-oleacc-iaccpropservices-composehwndidentitystring) method to obtain an identity string; or they can use the [**IAccPropServices::SetHwndPropServer**](/windows/desktop/api/Oleacc/nf-oleacc-iaccpropservices-sethwndpropserver) method and specify the *hwnd*, *idObject*, or *idChild* parameters instead of an identity string.</span></span>

<span data-ttu-id="5c65c-115">在容器物件上使用 [**SetPropServer**](/windows/desktop/api/Oleacc/nf-oleacc-iaccpropservices-setpropserver) 或 [**SetHwndPropServer**](/windows/desktop/api/Oleacc/nf-oleacc-iaccpropservices-sethwndpropserver) 時，伺服器開發人員可以選擇性地指定覆寫資訊也應套用至該容器的所有元素子系。</span><span class="sxs-lookup"><span data-stu-id="5c65c-115">When using either [**SetPropServer**](/windows/desktop/api/Oleacc/nf-oleacc-iaccpropservices-setpropserver) or [**SetHwndPropServer**](/windows/desktop/api/Oleacc/nf-oleacc-iaccpropservices-sethwndpropserver) on a container object, server developers can optionally specify that the overriding information should also apply to all element children of that container.</span></span>

<span data-ttu-id="5c65c-116">伺服器可以使用 [**IAccPropServices：： ClearProps**](/windows/desktop/api/Oleacc/nf-oleacc-iaccpropservices-clearprops)，隨時明確清除註釋。</span><span class="sxs-lookup"><span data-stu-id="5c65c-116">Servers can explicitly clear the annotation at any time by using [**IAccPropServices::ClearProps**](/windows/desktop/api/Oleacc/nf-oleacc-iaccpropservices-clearprops).</span></span> <span data-ttu-id="5c65c-117">這通常不是必要的，因為批註服務會在批註的可存取專案消失時，自動清除和釋放批註資訊。</span><span class="sxs-lookup"><span data-stu-id="5c65c-117">This is usually not required, as the annotation service will automatically clean up and release annotation information when the accessible element being annotated disappears.</span></span>

<span data-ttu-id="5c65c-118">以下是可使用此程式標注的屬性清單。</span><span class="sxs-lookup"><span data-stu-id="5c65c-118">Below is a list of properties that can be annotated using this procedure.</span></span>

## <a name="properties-supported-when-specifying-a-callback"></a><span data-ttu-id="5c65c-119">指定回呼時支援的屬性</span><span class="sxs-lookup"><span data-stu-id="5c65c-119">Properties Supported When Specifying a Callback</span></span>

<span data-ttu-id="5c65c-120">指定回呼時，可以標注下列屬性。</span><span class="sxs-lookup"><span data-stu-id="5c65c-120">When specifying a callback, the following properties can be annotated.</span></span> <span data-ttu-id="5c65c-121">這些屬性目前無法藉由指定值來直接批註。</span><span class="sxs-lookup"><span data-stu-id="5c65c-121">Currently these properties cannot be annotated directly by specifying a value.</span></span>



| <span data-ttu-id="5c65c-122">屬性</span><span class="sxs-lookup"><span data-stu-id="5c65c-122">Property</span></span>                      | <span data-ttu-id="5c65c-123">類型</span><span class="sxs-lookup"><span data-stu-id="5c65c-123">Type</span></span>                                                             |
|-------------------------------|------------------------------------------------------------------|
| <span data-ttu-id="5c65c-124">PROPID \_ ACC \_ 名稱</span><span class="sxs-lookup"><span data-stu-id="5c65c-124">PROPID\_ACC\_NAME</span></span>             | <span data-ttu-id="5c65c-125">VT \_ BSTR</span><span class="sxs-lookup"><span data-stu-id="5c65c-125">VT\_BSTR</span></span>                                                         |
| <span data-ttu-id="5c65c-126">PROPID \_ ACC \_ 描述</span><span class="sxs-lookup"><span data-stu-id="5c65c-126">PROPID\_ACC\_DESCRIPTION</span></span>      | <span data-ttu-id="5c65c-127">VT \_ BSTR</span><span class="sxs-lookup"><span data-stu-id="5c65c-127">VT\_BSTR</span></span>                                                         |
| <span data-ttu-id="5c65c-128">PROPID \_ ACC \_ 角色</span><span class="sxs-lookup"><span data-stu-id="5c65c-128">PROPID\_ACC\_ROLE</span></span>             | <span data-ttu-id="5c65c-129">VT \_ I4</span><span class="sxs-lookup"><span data-stu-id="5c65c-129">VT\_I4</span></span>                                                           |
| <span data-ttu-id="5c65c-130">PROPID \_ ACC \_ 狀態</span><span class="sxs-lookup"><span data-stu-id="5c65c-130">PROPID\_ACC\_STATE</span></span>            | <span data-ttu-id="5c65c-131">VT \_ I4</span><span class="sxs-lookup"><span data-stu-id="5c65c-131">VT\_I4</span></span>                                                           |
| <span data-ttu-id="5c65c-132">PROPID \_ ACC \_ 說明</span><span class="sxs-lookup"><span data-stu-id="5c65c-132">PROPID\_ACC\_HELP</span></span>             | <span data-ttu-id="5c65c-133">VT \_ BSTR</span><span class="sxs-lookup"><span data-stu-id="5c65c-133">VT\_BSTR</span></span>                                                         |
| <span data-ttu-id="5c65c-134">PROPID \_ ACC \_ KEYBOARDSHORTCUT</span><span class="sxs-lookup"><span data-stu-id="5c65c-134">PROPID\_ACC\_KEYBOARDSHORTCUT</span></span> | <span data-ttu-id="5c65c-135">VT \_ BSTR</span><span class="sxs-lookup"><span data-stu-id="5c65c-135">VT\_BSTR</span></span>                                                         |
| <span data-ttu-id="5c65c-136">PROPID \_ ACC \_ DEFAULTACTION</span><span class="sxs-lookup"><span data-stu-id="5c65c-136">PROPID\_ACC\_DEFAULTACTION</span></span>    | <span data-ttu-id="5c65c-137">VT \_ BSTR</span><span class="sxs-lookup"><span data-stu-id="5c65c-137">VT\_BSTR</span></span>                                                         |
| <span data-ttu-id="5c65c-138">PROPID \_ ACC 的 \_ VALUEMAP</span><span class="sxs-lookup"><span data-stu-id="5c65c-138">PROPID\_ACC\_VALUEMAP</span></span>         | <span data-ttu-id="5c65c-139">VT \_ BSTR</span><span class="sxs-lookup"><span data-stu-id="5c65c-139">VT\_BSTR</span></span>                                                         |
| <span data-ttu-id="5c65c-140">PROPID \_ ACC \_ ROLEMAP</span><span class="sxs-lookup"><span data-stu-id="5c65c-140">PROPID\_ACC\_ROLEMAP</span></span>          | <span data-ttu-id="5c65c-141">VT \_ BSTR</span><span class="sxs-lookup"><span data-stu-id="5c65c-141">VT\_BSTR</span></span>                                                         |
| <span data-ttu-id="5c65c-142">PROPID \_ ACC \_ STATEMAP</span><span class="sxs-lookup"><span data-stu-id="5c65c-142">PROPID\_ACC\_STATEMAP</span></span>         | <span data-ttu-id="5c65c-143">VT \_ BSTR</span><span class="sxs-lookup"><span data-stu-id="5c65c-143">VT\_BSTR</span></span>                                                         |
| <span data-ttu-id="5c65c-144">PROPID \_ ACC \_ 焦點</span><span class="sxs-lookup"><span data-stu-id="5c65c-144">PROPID\_ACC\_FOCUS</span></span>            | <span data-ttu-id="5c65c-145">VT \_ 分派</span><span class="sxs-lookup"><span data-stu-id="5c65c-145">VT\_DISPATCH</span></span><br/> <span data-ttu-id="5c65c-146">VT \_ I4</span><span class="sxs-lookup"><span data-stu-id="5c65c-146">VT\_I4</span></span><br/>                        |
| <span data-ttu-id="5c65c-147">PROPID \_ ACC \_ 選取專案</span><span class="sxs-lookup"><span data-stu-id="5c65c-147">PROPID\_ACC\_SELECTION</span></span>        | <span data-ttu-id="5c65c-148">VT \_ 分派</span><span class="sxs-lookup"><span data-stu-id="5c65c-148">VT\_DISPATCH</span></span><br/> <span data-ttu-id="5c65c-149">VT \_ I4</span><span class="sxs-lookup"><span data-stu-id="5c65c-149">VT\_I4</span></span><br/> <span data-ttu-id="5c65c-150">VT \_ 不明</span><span class="sxs-lookup"><span data-stu-id="5c65c-150">VT\_UNKNOWN</span></span><br/> |
| <span data-ttu-id="5c65c-151">PROPID \_ ACC \_ 父系</span><span class="sxs-lookup"><span data-stu-id="5c65c-151">PROPID\_ACC\_PARENT</span></span>           | <span data-ttu-id="5c65c-152">VT \_ 分派</span><span class="sxs-lookup"><span data-stu-id="5c65c-152">VT\_DISPATCH</span></span>                                                     |
| <span data-ttu-id="5c65c-153">PROPID \_ ACC \_ NAV \_</span><span class="sxs-lookup"><span data-stu-id="5c65c-153">PROPID\_ACC\_NAV\_UP</span></span>          | <span data-ttu-id="5c65c-154">VT \_ 分派</span><span class="sxs-lookup"><span data-stu-id="5c65c-154">VT\_DISPATCH</span></span><br/> <span data-ttu-id="5c65c-155">VT \_ I4</span><span class="sxs-lookup"><span data-stu-id="5c65c-155">VT\_I4</span></span><br/>                        |
| <span data-ttu-id="5c65c-156">PROPID \_ ACC \_ NAV \_</span><span class="sxs-lookup"><span data-stu-id="5c65c-156">PROPID\_ACC\_NAV\_DOWN</span></span>        | <span data-ttu-id="5c65c-157">VT \_ 分派</span><span class="sxs-lookup"><span data-stu-id="5c65c-157">VT\_DISPATCH</span></span><br/> <span data-ttu-id="5c65c-158">VT \_ I4</span><span class="sxs-lookup"><span data-stu-id="5c65c-158">VT\_I4</span></span><br/>                        |
| <span data-ttu-id="5c65c-159">PROPID \_ ACC \_ NAV \_ 左方</span><span class="sxs-lookup"><span data-stu-id="5c65c-159">PROPID\_ACC\_NAV\_LEFT</span></span>        | <span data-ttu-id="5c65c-160">VT \_ 分派</span><span class="sxs-lookup"><span data-stu-id="5c65c-160">VT\_DISPATCH</span></span><br/> <span data-ttu-id="5c65c-161">VT \_ I4</span><span class="sxs-lookup"><span data-stu-id="5c65c-161">VT\_I4</span></span><br/>                        |
| <span data-ttu-id="5c65c-162">PROPID \_ ACC \_ NAV \_ 右移</span><span class="sxs-lookup"><span data-stu-id="5c65c-162">PROPID\_ACC\_NAV\_RIGHT</span></span>       | <span data-ttu-id="5c65c-163">VT \_ 分派</span><span class="sxs-lookup"><span data-stu-id="5c65c-163">VT\_DISPATCH</span></span><br/> <span data-ttu-id="5c65c-164">VT \_ I4</span><span class="sxs-lookup"><span data-stu-id="5c65c-164">VT\_I4</span></span><br/>                        |
| <span data-ttu-id="5c65c-165">PROPID \_ ACC \_ NAV \_ 上一頁</span><span class="sxs-lookup"><span data-stu-id="5c65c-165">PROPID\_ACC\_NAV\_PREV</span></span>        | <span data-ttu-id="5c65c-166">VT \_ 分派</span><span class="sxs-lookup"><span data-stu-id="5c65c-166">VT\_DISPATCH</span></span><br/> <span data-ttu-id="5c65c-167">VT \_ I4</span><span class="sxs-lookup"><span data-stu-id="5c65c-167">VT\_I4</span></span><br/>                        |
| <span data-ttu-id="5c65c-168">PROPID \_ ACC \_ NAV \_ 下一頁</span><span class="sxs-lookup"><span data-stu-id="5c65c-168">PROPID\_ACC\_NAV\_NEXT</span></span>        | <span data-ttu-id="5c65c-169">VT \_ 分派</span><span class="sxs-lookup"><span data-stu-id="5c65c-169">VT\_DISPATCH</span></span><br/> <span data-ttu-id="5c65c-170">VT \_ I4</span><span class="sxs-lookup"><span data-stu-id="5c65c-170">VT\_I4</span></span><br/>                        |
| <span data-ttu-id="5c65c-171">PROPID \_ ACC \_ NAV \_ FIRSTCHILD</span><span class="sxs-lookup"><span data-stu-id="5c65c-171">PROPID\_ACC\_NAV\_FIRSTCHILD</span></span>  | <span data-ttu-id="5c65c-172">VT \_ 分派</span><span class="sxs-lookup"><span data-stu-id="5c65c-172">VT\_DISPATCH</span></span><br/> <span data-ttu-id="5c65c-173">VT \_ I4</span><span class="sxs-lookup"><span data-stu-id="5c65c-173">VT\_I4</span></span><br/>                        |
| <span data-ttu-id="5c65c-174">PROPID \_ ACC \_ NAV \_ LASTCHILD</span><span class="sxs-lookup"><span data-stu-id="5c65c-174">PROPID\_ACC\_NAV\_LASTCHILD</span></span>   | <span data-ttu-id="5c65c-175">VT \_ 分派</span><span class="sxs-lookup"><span data-stu-id="5c65c-175">VT\_DISPATCH</span></span><br/> <span data-ttu-id="5c65c-176">VT \_ I4</span><span class="sxs-lookup"><span data-stu-id="5c65c-176">VT\_I4</span></span><br/>                        |



 

 

