---
title: 產生適當的 WinEvents
description: 伺服器開發人員必須確保為所有 UI 元素產生適當的 WinEvents，包括以視窗為基礎的 UI 元素、無視窗 UI 元素，以及具有高度自訂行為的 UI 元素。
ms.assetid: 253e0162-20e6-4e89-b563-aae9cf7e53a9
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: af6273411115e908303e863a34908e15ef91b19c
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 09/16/2019
ms.locfileid: "104183910"
---
# <a name="generating-appropriate-winevents"></a><span data-ttu-id="6b864-103">產生適當的 WinEvents</span><span class="sxs-lookup"><span data-stu-id="6b864-103">Generating Appropriate WinEvents</span></span>

<span data-ttu-id="6b864-104">伺服器開發人員必須確保為所有 UI 元素產生適當的 WinEvents，包括以視窗為基礎的 UI 元素、無視窗 UI 元素，以及具有高度自訂行為的 UI 元素。</span><span class="sxs-lookup"><span data-stu-id="6b864-104">Server developers need to ensure that appropriate WinEvents are generated for all UI elements, including window-based UI elements, windowless UI elements, and UI elements with highly customized behaviors.</span></span>

<span data-ttu-id="6b864-105">使用者會為標準的 **HWND** 型 UI 元素提供預設的 new-winevent 支援。</span><span class="sxs-lookup"><span data-stu-id="6b864-105">USER provides default WinEvent support for standard, **HWND**-based UI elements.</span></span> <span data-ttu-id="6b864-106">因為使用者會自動產生這些事件，所以伺服器只需要針對自訂控制項、無視窗專案，或是使用者尚未產生其事件的控制項產生事件。</span><span class="sxs-lookup"><span data-stu-id="6b864-106">Because USER generates these events automatically, servers need to generate events only for custom controls, windowless elements, or controls whose events are not already generated by USER.</span></span>

<span data-ttu-id="6b864-107">若要傳送事件，伺服器會呼叫 [**NotifyWinEvent**](/windows/desktop/api/Winuser/nf-winuser-notifywinevent) 並傳遞事件常數、物件識別碼，以及可以回應用戶端要求之視窗的 **HWND** ，以取得詳細資訊。</span><span class="sxs-lookup"><span data-stu-id="6b864-107">To send an event, servers call [**NotifyWinEvent**](/windows/desktop/api/Winuser/nf-winuser-notifywinevent) and pass the event constant, an object ID, and the **HWND** for a window that can respond to client requests for more information.</span></span> <span data-ttu-id="6b864-108">需要引發的事件會根據 UI 元素的類型而有所不同。</span><span class="sxs-lookup"><span data-stu-id="6b864-108">The events that need to be fired vary according to the type of UI element.</span></span> <span data-ttu-id="6b864-109">有一些應針對所有控制項傳送的一般事件，以及應該只針對適當的 UI 元素傳送的特定事件。</span><span class="sxs-lookup"><span data-stu-id="6b864-109">There are general events that should be sent for all controls, and specific events that should be sent only for the appropriate UI element.</span></span>

## <a name="general-events"></a><span data-ttu-id="6b864-110">一般事件</span><span class="sxs-lookup"><span data-stu-id="6b864-110">General Events</span></span>

<span data-ttu-id="6b864-111">您可以針對所有 UI 元素傳送一般 WinEvents。</span><span class="sxs-lookup"><span data-stu-id="6b864-111">General WinEvents can be sent for all UI elements.</span></span> <span data-ttu-id="6b864-112">這些包括：</span><span class="sxs-lookup"><span data-stu-id="6b864-112">These include:</span></span>

-   <span data-ttu-id="6b864-113">[**活動 \_建立 \_**](event-constants.md) 物件時建立 (的物件) </span><span class="sxs-lookup"><span data-stu-id="6b864-113">[**EVENT\_OBJECT\_CREATE**](event-constants.md) (when an object is created)</span></span>
-   <span data-ttu-id="6b864-114">[**活動 \_物件 \_**](event-constants.md) 終結時 (物件終結) </span><span class="sxs-lookup"><span data-stu-id="6b864-114">[**EVENT\_OBJECT\_DESTROY**](event-constants.md) (when an object is destroyed)</span></span>
-   <span data-ttu-id="6b864-115">[**活動 \_顯示 \_**](event-constants.md) 物件時顯示 (的物件) </span><span class="sxs-lookup"><span data-stu-id="6b864-115">[**EVENT\_OBJECT\_SHOW**](event-constants.md) (when an object is shown)</span></span>
-   <span data-ttu-id="6b864-116">[**活動 \_隱藏 \_**](event-constants.md) 物件時隱藏 (物件) </span><span class="sxs-lookup"><span data-stu-id="6b864-116">[**EVENT\_OBJECT\_HIDE**](event-constants.md) (when an object is hidden)</span></span>

## <a name="specific-events"></a><span data-ttu-id="6b864-117">特定事件</span><span class="sxs-lookup"><span data-stu-id="6b864-117">Specific Events</span></span>

<span data-ttu-id="6b864-118">您也可以針對特定類型的 UI 元素傳送特定的 WinEvents。</span><span class="sxs-lookup"><span data-stu-id="6b864-118">There are also specific WinEvents that can be sent for a particular type of UI element.</span></span> <span data-ttu-id="6b864-119">例如，針對允許使用者進行選取的控制項（例如清單方塊），使用 [**事件 \_ 物件 \_ 選擇**](event-constants.md) 。</span><span class="sxs-lookup"><span data-stu-id="6b864-119">For example, use [**EVENT\_OBJECT\_SELECTION**](event-constants.md) for controls that allow the user to make a selection, such as a list box.</span></span>

<span data-ttu-id="6b864-120">如需特定 UI 元素類型所預期的事件的詳細資訊，請參閱下列資源：</span><span class="sxs-lookup"><span data-stu-id="6b864-120">For more information about which events are expected for a particular type of UI element, see the following resources:</span></span>

-   <span data-ttu-id="6b864-121">[附錄 A：支援的消費者介面元素參考](appendix-a--supported-user-interface-elements-reference.md)。</span><span class="sxs-lookup"><span data-stu-id="6b864-121">[Appendix A: Supported User Interface Elements Reference](appendix-a--supported-user-interface-elements-reference.md).</span></span> <span data-ttu-id="6b864-122">本附錄包含由 Microsoft Active Accessibility 公開之系統產生之 UI 元素的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="6b864-122">This appendix includes information about system-generated UI elements that are exposed by Microsoft Active Accessibility.</span></span> <span data-ttu-id="6b864-123">每個控制項的檔包含可由 UI 元素產生的事件相關資訊。</span><span class="sxs-lookup"><span data-stu-id="6b864-123">Documentation for each control includes information about events that can be generated by the UI element.</span></span>
-   <span data-ttu-id="6b864-124">[事件常數](event-constants.md)。</span><span class="sxs-lookup"><span data-stu-id="6b864-124">[Event Constants](event-constants.md).</span></span> <span data-ttu-id="6b864-125">本主題包含作業系統和伺服器應用程式所產生之事件的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="6b864-125">This topic includes information about events generated by the operating system and server applications.</span></span>
-   <span data-ttu-id="6b864-126"> (AccEvent.exe) 可存取的事件監看員。</span><span class="sxs-lookup"><span data-stu-id="6b864-126">Accessible Event Watcher (AccEvent.exe).</span></span> <span data-ttu-id="6b864-127">此工具會顯示使用者針對特定 UI 元素傳送的事件。</span><span class="sxs-lookup"><span data-stu-id="6b864-127">This tool shows which events USER sends for a particular UI element.</span></span> <span data-ttu-id="6b864-128">您可以使用此工具來瞭解 UI 元素可以預期的事件。</span><span class="sxs-lookup"><span data-stu-id="6b864-128">You can use this tool to learn which events you can expect for a UI element.</span></span> <span data-ttu-id="6b864-129">如需詳細資訊，請參閱 [可存取的事件](accessible-event-watcher.md)監看員。</span><span class="sxs-lookup"><span data-stu-id="6b864-129">For more information, see [Accessible Event Watcher](accessible-event-watcher.md).</span></span>

 

 




