---
title: IAccessible proxy
description: IAccessible proxy 提供標準 UI 元素的預設協助工具資訊，使用者控制項、使用者功能表，以及來自 COMCTL 和 COMCTL32.DLL 的通用控制項。
ms.assetid: 236c2064-de44-4021-8825-f1519312dbfc
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 53dcb4cae8980e4003d9915c6783e4ddb043a8c8
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/20/2020
ms.locfileid: "104315676"
---
# <a name="iaccessible-proxies"></a><span data-ttu-id="db4d6-103">IAccessible proxy</span><span class="sxs-lookup"><span data-stu-id="db4d6-103">IAccessible Proxies</span></span>

<span data-ttu-id="db4d6-104">[**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) proxy 提供標準 UI 元素的預設協助工具資訊：使用者控制項、使用者功能表，以及來自 COMCTL 和 comctl32.dll 的通用控制項。</span><span class="sxs-lookup"><span data-stu-id="db4d6-104">[**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) proxies provide default accessibility information for standard UI elements: USER controls, USER menus, and common controls from COMCTL and COMCTL32.</span></span> <span data-ttu-id="db4d6-105">這項預設支援是透過 Oleacc.dll 所建立的 **IAccessible** 物件公開，並提供 Microsoft Active Accessibility 支援，而不需要額外的伺服器開發工作。</span><span class="sxs-lookup"><span data-stu-id="db4d6-105">This default support is exposed through **IAccessible** objects created by Oleacc.dll and delivers Microsoft Active Accessibility support without additional server development work.</span></span> <span data-ttu-id="db4d6-106">然後伺服器可以使用 [動態批註 API](dynamic-annotation-api.md) 來修改 Oleacc.dll 所公開的大部分資訊，但它並沒有完整的控制權。</span><span class="sxs-lookup"><span data-stu-id="db4d6-106">The server can then use the [Dynamic Annotation API](dynamic-annotation-api.md) to modify much of the information exposed by Oleacc.dll, but it does not have complete control.</span></span>

## <a name="creating-a-proxy"></a><span data-ttu-id="db4d6-107">建立 Proxy</span><span class="sxs-lookup"><span data-stu-id="db4d6-107">Creating a Proxy</span></span>

<span data-ttu-id="db4d6-108">若要判斷 UI 專案是否原本就支援 [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) 介面，Oleacc.dll 傳送了 [**WM \_ GETOBJECT**](wm-getobject.md) 訊息給它。</span><span class="sxs-lookup"><span data-stu-id="db4d6-108">To determine whether a UI element natively supports the [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) interface, Oleacc.dll sends it a [**WM\_GETOBJECT**](wm-getobject.md) message.</span></span> <span data-ttu-id="db4d6-109">非零傳回值表示該元素原本就支援 Microsoft Active Accessibility，並提供它自己的 **IAccessible** 支援。</span><span class="sxs-lookup"><span data-stu-id="db4d6-109">A nonzero return value means the element natively supports Microsoft Active Accessibility and provides its own **IAccessible** support.</span></span> <span data-ttu-id="db4d6-110">但是，如果傳回值為零，Oleacc.dll 會提供 UI 元素的 proxy 物件，並嘗試代表其傳回有意義的資訊。</span><span class="sxs-lookup"><span data-stu-id="db4d6-110">However, if the return value is zero, Oleacc.dll provides a proxy object for the UI element and attempts to return meaningful information on its behalf.</span></span> <span data-ttu-id="db4d6-111">如需有關 **wm \_ getobject** 的詳細資訊，請參閱 [Wm getobject 的 \_ 運作方式](how-wm-getobject-works.md)。</span><span class="sxs-lookup"><span data-stu-id="db4d6-111">For more information about **WM\_GETOBJECT**, see [How WM\_GETOBJECT Works](how-wm-getobject-works.md).</span></span>

## <a name="what-information-is-exposed"></a><span data-ttu-id="db4d6-112">公開的資訊</span><span class="sxs-lookup"><span data-stu-id="db4d6-112">What Information Is Exposed</span></span>

<span data-ttu-id="db4d6-113">Oleacc.dll 使用 UI 元素的 Windows 類別名稱，判斷應該針對每個 [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) 屬性公開哪些資訊，以及如何收集該資訊。</span><span class="sxs-lookup"><span data-stu-id="db4d6-113">Oleacc.dll uses the UI element's Windows class name to determine what information should be exposed for each of its [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) properties and how to collect that information.</span></span> <span data-ttu-id="db4d6-114">例如，Oleacc.dll 會呼叫 [**GetWindowText**](/windows/desktop/api/winuser/nf-winuser-getwindowtexta) 函式，以抓取標準 push 按鈕的 [**Name**](name-property.md) 屬性，但會呼叫這個相同的函式，以取得標準編輯控制項的 [**Value**](value-property.md) 屬性。</span><span class="sxs-lookup"><span data-stu-id="db4d6-114">For example, Oleacc.dll calls the [**GetWindowText**](/windows/desktop/api/winuser/nf-winuser-getwindowtexta) function to retrieve the [**Name**](name-property.md) property for a standard push button, but calls this same function to retrieve the [**Value**](value-property.md) property for a standard edit control.</span></span> <span data-ttu-id="db4d6-115">實際上，Oleacc.dll 會將每個 **IAccessible** 方法對應到適當的 Microsoft Win32 或控制項特定的訊息或函式呼叫。</span><span class="sxs-lookup"><span data-stu-id="db4d6-115">In effect, Oleacc.dll is mapping each **IAccessible** method to an appropriate Microsoft Win32 or control-specific message or function call.</span></span> <span data-ttu-id="db4d6-116">藉由使用這個以類別名稱為基礎的特殊大小寫，它可以透過 **IAccessible** proxy 傳回有意義的資訊，而不需要在伺服器中 Microsoft Active Accessibility 支援。</span><span class="sxs-lookup"><span data-stu-id="db4d6-116">By using this class name-based special casing, it can return meaningful information through **IAccessible** proxies without any Microsoft Active Accessibility support in the server.</span></span>

<span data-ttu-id="db4d6-117">使用標準 UI 專案所建立的應用程式，通常可獲得完整的 Microsoft Active Accessibility 支援，而不需要額外的開發工作</span><span class="sxs-lookup"><span data-stu-id="db4d6-117">Applications built with standard UI elements typically get full Microsoft Active Accessibility support without additional development work.</span></span> <span data-ttu-id="db4d6-118">這項規則的例外狀況是已經過子類別化的控制項，其不會儲存自己的字串 (缺少 **HASSTRINGS** 樣式) 或主控描繪。</span><span class="sxs-lookup"><span data-stu-id="db4d6-118">The exceptions to this rule are controls that have been subclassed, that do not store their own strings (absence of the **HASSTRINGS** style), or that are owner-drawn.</span></span> <span data-ttu-id="db4d6-119">在這些情況下，Oleacc.dll 無法收集所需的資訊，因為這項資訊會儲存在控制項之外。</span><span class="sxs-lookup"><span data-stu-id="db4d6-119">In these cases, Oleacc.dll cannot gather the information it needs because the information is stored outside the control.</span></span> <span data-ttu-id="db4d6-120">不過，在許多案例中，已建立因應措施，或使用動態注釋，可讓伺服器與 Oleacc.dll 提供的 proxy 合作。</span><span class="sxs-lookup"><span data-stu-id="db4d6-120">However in many of these scenarios, established workarounds, or the use of Dynamic Annotation, allow the server to cooperate with the proxies provided by Oleacc.dll.</span></span>

## <a name="generic-proxy-objects"></a><span data-ttu-id="db4d6-121">泛型 Proxy 物件</span><span class="sxs-lookup"><span data-stu-id="db4d6-121">Generic Proxy Objects</span></span>

<span data-ttu-id="db4d6-122">如果 Oleacc.dll 無法辨識 UI 元素的類別名稱，則會建立泛型 proxy，盡可能公開最多的資訊。</span><span class="sxs-lookup"><span data-stu-id="db4d6-122">If Oleacc.dll does not recognize the class name of the UI element, it creates a generic proxy that exposes as much information as possible.</span></span> <span data-ttu-id="db4d6-123">大部分情況下，這包括物件的周框、父物件、從 [**WM \_ GETTEXT**](/windows/desktop/winmsg/wm-gettext))  (的名稱，以及視窗階層中的任何子系。</span><span class="sxs-lookup"><span data-stu-id="db4d6-123">At most, this includes the object's bounding rectangle, parent object, name (from [**WM\_GETTEXT**](/windows/desktop/winmsg/wm-gettext)), and any children in the window hierarchy.</span></span>

 

 