---
title: '編輯控制項 (MSAA UI 元素參考) '
description: 編輯控制項可讓使用者查看和編輯文字。
ms.assetid: a42c73f2-4005-4db9-84bc-637c9c4310f1
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 0dde6e562b651b91376bc7d675b2b71ac999cf48
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 09/16/2019
ms.locfileid: "104507456"
---
# <a name="edit-control-msaa-ui-element-reference"></a><span data-ttu-id="4d306-103">編輯控制項 (MSAA UI 元素參考) </span><span class="sxs-lookup"><span data-stu-id="4d306-103">Edit Control (MSAA UI Element Reference)</span></span>

> [!Note]  
> <span data-ttu-id="4d306-104">本主題說明如何 **編輯控制項** 物件，以用於 MSAA UI 元素參考。</span><span class="sxs-lookup"><span data-stu-id="4d306-104">This topic describes **Edit Control** objects for purposes of MSAA UI Element Reference.</span></span> <span data-ttu-id="4d306-105">此處未說明如何在不同的 UI 架構中建立 **編輯控制項** 物件。</span><span class="sxs-lookup"><span data-stu-id="4d306-105">How to create **Edit Control** objects in various UI frameworks is not described here.</span></span> <span data-ttu-id="4d306-106">請參閱您所使用之 UI 架構的 API 參考檔。</span><span class="sxs-lookup"><span data-stu-id="4d306-106">See the API reference documentation for the UI framework you're using.</span></span>

 

<span data-ttu-id="4d306-107">編輯控制項可讓使用者查看和編輯文字。</span><span class="sxs-lookup"><span data-stu-id="4d306-107">Edit controls let a user view and edit text.</span></span> <span data-ttu-id="4d306-108">您可以使用許多不同的樣式來建立編輯控制項，例如 ES \_ 多行。</span><span class="sxs-lookup"><span data-stu-id="4d306-108">Edit controls are created with many different styles such as ES\_MULTILINE.</span></span> <span data-ttu-id="4d306-109">此樣式會建立多行編輯控制項（例如 [記事本] 的工作區）和 [ES \_ READONLY]，以建立唯讀編輯控制項。</span><span class="sxs-lookup"><span data-stu-id="4d306-109">This style creates a multiline edit control, such as the client area of Notepad, and ES\_READONLY, which creates a read-only edit control.</span></span>

<span data-ttu-id="4d306-110">Microsoft Active Accessibility 不會區分以視窗類別名稱 "EDIT" 建立的編輯控制項，以及以視窗類別名稱 "RichEdit" 或 "RichEdit20A" 建立的 rich edit 控制項。</span><span class="sxs-lookup"><span data-stu-id="4d306-110">Microsoft Active Accessibility does not make a distinction between edit controls created with the window class name "EDIT" and rich edit controls created with the window class name "RichEdit" or "RichEdit20A".</span></span>

## <a name="iaccessible-methods"></a><span data-ttu-id="4d306-111">IAccessible 方法</span><span class="sxs-lookup"><span data-stu-id="4d306-111">IAccessible Methods</span></span>

<span data-ttu-id="4d306-112">編輯控制項支援下列 [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) 方法：</span><span class="sxs-lookup"><span data-stu-id="4d306-112">Edit controls support the following [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) methods:</span></span>

-   [<span data-ttu-id="4d306-113">**accHitTest**</span><span class="sxs-lookup"><span data-stu-id="4d306-113">**accHitTest**</span></span>](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-acchittest)
-   [<span data-ttu-id="4d306-114">**accLocation**</span><span class="sxs-lookup"><span data-stu-id="4d306-114">**accLocation**</span></span>](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-acclocation)
-   [<span data-ttu-id="4d306-115">**accNavigate**</span><span class="sxs-lookup"><span data-stu-id="4d306-115">**accNavigate**</span></span>](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-accnavigate)
-   [<span data-ttu-id="4d306-116">**accSelect**</span><span class="sxs-lookup"><span data-stu-id="4d306-116">**accSelect**</span></span>](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-accselect)

## <a name="iaccessible-properties"></a><span data-ttu-id="4d306-117">IAccessible 屬性</span><span class="sxs-lookup"><span data-stu-id="4d306-117">IAccessible Properties</span></span>

<span data-ttu-id="4d306-118">編輯控制項支援下列 [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) 屬性：</span><span class="sxs-lookup"><span data-stu-id="4d306-118">Edit controls support the following [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) properties:</span></span>



| <span data-ttu-id="4d306-119">屬性</span><span class="sxs-lookup"><span data-stu-id="4d306-119">Property</span></span>                                                                             | <span data-ttu-id="4d306-120">註解</span><span class="sxs-lookup"><span data-stu-id="4d306-120">Comments</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|--------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="4d306-121">**取得 \_ accChild**</span><span class="sxs-lookup"><span data-stu-id="4d306-121">**get\_accChild**</span></span>](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_accchild)                       |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| [<span data-ttu-id="4d306-122">**取得 \_ accChildCount**</span><span class="sxs-lookup"><span data-stu-id="4d306-122">**get\_accChildCount**</span></span>](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_accchildcount)             |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| [<span data-ttu-id="4d306-123">**取得 \_ accDescription**</span><span class="sxs-lookup"><span data-stu-id="4d306-123">**get\_accDescription**</span></span>](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_accdescription)           |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| [<span data-ttu-id="4d306-124">**取得 \_ accFocus**</span><span class="sxs-lookup"><span data-stu-id="4d306-124">**get\_accFocus**</span></span>](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_accfocus)                       |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| [<span data-ttu-id="4d306-125">**取得 \_ accKeyboardShortcut**</span><span class="sxs-lookup"><span data-stu-id="4d306-125">**get\_accKeyboardShortcut**</span></span>](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_acckeyboardshortcut) | <span data-ttu-id="4d306-126">**KeyboardShortcut** 屬性是編輯控制項的存取金鑰，在編輯控制項的標籤文字中是加上底線的字元。</span><span class="sxs-lookup"><span data-stu-id="4d306-126">The **KeyboardShortcut** property is the edit control's access key, which is an underlined character in the text of the edit control's label.</span></span> <span data-ttu-id="4d306-127">例如，在標準檔案開啟對話方塊（例如 WordPad）中，標示為 "Filename：" 的編輯控制項的 **KeyboardShortcut** 是 "Alt + n"。</span><span class="sxs-lookup"><span data-stu-id="4d306-127">For example, on a standard File Open dialog box such as in WordPad, the **KeyboardShortcut** for the edit control labeled "Filename:" is "Alt+n".</span></span>                                                                                                                                                                                                                                                                                                                                        |
| [<span data-ttu-id="4d306-128">**取得 \_ accName**</span><span class="sxs-lookup"><span data-stu-id="4d306-128">**get\_accName**</span></span>](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_accname)                         | <span data-ttu-id="4d306-129">**Name** 屬性是靜態文字控制項中標記編輯控制項的文字。</span><span class="sxs-lookup"><span data-stu-id="4d306-129">The **Name** property is the text from a static text control that labels the edit control.</span></span> <span data-ttu-id="4d306-130">例如，在標準的 [開啟] 對話方塊中（例如在 [WordPad] 中），編輯控制項的 [ **名稱** ] 屬性為 [檔案名：]。</span><span class="sxs-lookup"><span data-stu-id="4d306-130">For example, on a standard File Open dialog box such as in WordPad, the **Name** property for the edit control is "File name:".</span></span>                                                                                                                                                                                                                                                                                                                                                                                                             |
| [<span data-ttu-id="4d306-131">**取得 \_ accParent**</span><span class="sxs-lookup"><span data-stu-id="4d306-131">**get\_accParent**</span></span>](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_accparent)                     | <span data-ttu-id="4d306-132">**父** 屬性是在控制項周圍 ([**角色 \_ 系統 \_ 視窗**](object-roles.md)) 的視窗，而且具有與控制項相同的 **名稱** 屬性和視窗類別名稱。</span><span class="sxs-lookup"><span data-stu-id="4d306-132">The **Parent** property is a window ( [**ROLE\_SYSTEM\_WINDOW**](object-roles.md) ) that surrounds the control and has the same **Name** property and window class name as the control.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                            |
| [<span data-ttu-id="4d306-133">**取得 \_ accRole**</span><span class="sxs-lookup"><span data-stu-id="4d306-133">**get\_accRole**</span></span>](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_accrole)                         | <span data-ttu-id="4d306-134">**Role** 屬性是 [**角色 \_ 系統 \_ 文字**](object-roles.md)。</span><span class="sxs-lookup"><span data-stu-id="4d306-134">The **Role** property is [**ROLE\_SYSTEM\_TEXT**](object-roles.md).</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| [<span data-ttu-id="4d306-135">**取得 \_ accSelection**</span><span class="sxs-lookup"><span data-stu-id="4d306-135">**get\_accSelection**</span></span>](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_accselection)               |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| [<span data-ttu-id="4d306-136">**取得 \_ accState**</span><span class="sxs-lookup"><span data-stu-id="4d306-136">**get\_accState**</span></span>](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_accstate)                       | <span data-ttu-id="4d306-137">**State** 屬性是下列一或多個 [值](object-state-constants.md)的組合：[**狀態 \_ 系統 \_ 不可見**](object-state-constants.md) \| [**狀態系統可 \_ \_ 設定焦點**](object-state-constants.md) \| [**狀態 \_ 系統 \_ 焦點**](object-state-constants.md) \| [**狀態 \_ 系統 \_ 唯讀**](object-state-constants.md) \| [**狀態系統 \_ \_ 保護**](object-state-constants.md) \| [**狀態系統 \_ \_ 正常**](object-state-constants.md)</span><span class="sxs-lookup"><span data-stu-id="4d306-137">The **State** property is a combination of one or more of the following [values](object-state-constants.md):[**STATE\_SYSTEM\_INVISIBLE**](object-state-constants.md) \| [**STATE\_SYSTEM\_FOCUSABLE**](object-state-constants.md) \| [**STATE\_SYSTEM\_FOCUSED**](object-state-constants.md) \| [**STATE\_SYSTEM\_READONLY**](object-state-constants.md) \| [**STATE\_SYSTEM\_PROTECTED**](object-state-constants.md) \| [**STATE\_SYSTEM\_NORMAL**](object-state-constants.md)</span></span><br/> |
| [<span data-ttu-id="4d306-138">**取得 \_ accValue**</span><span class="sxs-lookup"><span data-stu-id="4d306-138">**get\_accValue**</span></span>](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_accvalue)                       | <span data-ttu-id="4d306-139">**Value** 屬性是包含編輯控制項中文字的單一字串。</span><span class="sxs-lookup"><span data-stu-id="4d306-139">The **Value** property is a single string that contains the text in the edit control.</span></span> <span data-ttu-id="4d306-140">但是，如果控制項受到密碼保護，則 **Value** 屬性會傳回 E \_ ACCESSDENIED。</span><span class="sxs-lookup"><span data-stu-id="4d306-140">However, if the control is password protected, the **Value** property returns E\_ACCESSDENIED.</span></span> <span data-ttu-id="4d306-141">若為多行編輯控制項，此字串會在每一行的結尾包含換行字元和分行符號。</span><span class="sxs-lookup"><span data-stu-id="4d306-141">For multiline edit controls, the string contains a carriage return and a newline character at the end of each line.</span></span>                                                                                                                                                                                                                                                                                                                               |



 

## <a name="notes"></a><span data-ttu-id="4d306-142">備註</span><span class="sxs-lookup"><span data-stu-id="4d306-142">Notes</span></span>

-   <span data-ttu-id="4d306-143">Microsoft Active Accessibility 不支援選取 [編輯] 和 [rich edit] 控制項中包含的文字，因為該文字會在物件的 [ **值** ] 屬性中公開為字串。</span><span class="sxs-lookup"><span data-stu-id="4d306-143">Microsoft Active Accessibility does not support the selection of the text contained in edit and rich edit controls because the text is exposed as a string in the object's **Value** property.</span></span>
-   <span data-ttu-id="4d306-144">Riched20.dll (所提供的 rich edit 控制項（用於 Windows 98 中的 WordPad）) 在文字選取期間變更插入號位置時，不會傳送任何 WinEvents。</span><span class="sxs-lookup"><span data-stu-id="4d306-144">The rich edit control provided by Riched20.dll (which is used in text editors such as WordPad in Windows 98) does not send any WinEvents when the caret position is changed during text selection.</span></span> <span data-ttu-id="4d306-145">當使用者按下 SHIFT 和方向鍵選取文字時，插入號物件不會觸發 [**事件 \_ 物件 \_ LOCATIONCHANGE**](event-constants.md) new-winevent。</span><span class="sxs-lookup"><span data-stu-id="4d306-145">When users press SHIFT and arrow keys to select text, the caret object does not trigger the [**EVENT\_OBJECT\_LOCATIONCHANGE**](event-constants.md) WinEvent.</span></span> <span data-ttu-id="4d306-146">當您透過 rich edit 訊息以程式設計方式設定選取專案時，插入號物件不會傳送任何事件來指出其新位置。</span><span class="sxs-lookup"><span data-stu-id="4d306-146">When the selection is set programmatically through rich edit messages, the caret object does not send any events to indicate its new position.</span></span>

    <span data-ttu-id="4d306-147">使用 Riched20.dll 的所有應用程式都會出現此問題。</span><span class="sxs-lookup"><span data-stu-id="4d306-147">All applications that use Riched20.dll exhibit this problem.</span></span> <span data-ttu-id="4d306-148">使用較舊版本之 rich edit 控制項的應用程式，會根據選取專案正確地傳送事件。</span><span class="sxs-lookup"><span data-stu-id="4d306-148">Applications using earlier versions of the rich edit control correctly send events based on the selection.</span></span>

-   <span data-ttu-id="4d306-149">密碼編輯控制項的 **狀態** 值一律包含 [**\_ \_ 受保護**](object-state-constants.md)的位旗標狀態系統。</span><span class="sxs-lookup"><span data-stu-id="4d306-149">The **State** value for password edit controls always includes the bit flag [**STATE\_SYSTEM\_PROTECTED**](object-state-constants.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="4d306-150">相關主題</span><span class="sxs-lookup"><span data-stu-id="4d306-150">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="4d306-151">IAccessible 介面</span><span class="sxs-lookup"><span data-stu-id="4d306-151">IAccessible Interface</span></span>](/windows/desktop/api/oleacc/nn-oleacc-iaccessible)
</dt> </dl>

 

 





