---
title: 如何在參數中使用子識別碼
description: 本主題描述輸入參數、輸出參數，以及解讀 IAccessible 方法所傳回之子識別碼的特殊案例。
ms.assetid: 051ec5ba-540c-4ae1-b917-4c229557ca2f
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c03026e6abf769efab95cc513231fad3af64511f
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/20/2020
ms.locfileid: "104375809"
---
# <a name="how-child-ids-are-used-in-parameters"></a><span data-ttu-id="95139-103">如何在參數中使用子識別碼</span><span class="sxs-lookup"><span data-stu-id="95139-103">How Child IDs Are Used in Parameters</span></span>

<span data-ttu-id="95139-104">本主題描述輸入參數、輸出參數，以及解讀 [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) 方法所傳回之子識別碼的特殊案例。</span><span class="sxs-lookup"><span data-stu-id="95139-104">This topic describes input parameters, output parameters, and special cases for interpreting child IDs returned from [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) methods.</span></span>

## <a name="input-parameters"></a><span data-ttu-id="95139-105">輸入參數</span><span class="sxs-lookup"><span data-stu-id="95139-105">Input Parameters</span></span>

<span data-ttu-id="95139-106">許多 Microsoft Active Accessibility 函式和大部分的 [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) 屬性都採用 [**VARIANT**](/windows/win32/api/oaidl/ns-oaidl-variant) 結構做為輸入參數。</span><span class="sxs-lookup"><span data-stu-id="95139-106">Many of the Microsoft Active Accessibility functions and most of the [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) properties take a [**VARIANT**](/windows/win32/api/oaidl/ns-oaidl-variant) structure as an input parameter.</span></span> <span data-ttu-id="95139-107">針對大部分的 **IAccessible** 屬性，此參數可讓用戶端開發人員指定是否要取得物件本身或物件的其中一個簡單元素的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="95139-107">For most of the **IAccessible** properties, this parameter allows client developers to specify whether they want information about the object itself or about one of the object's simple elements.</span></span>

<span data-ttu-id="95139-108">Microsoft Active Accessibility 提供常數 **CHILDID 本身 \_** ，表示需要物件本身的資訊。</span><span class="sxs-lookup"><span data-stu-id="95139-108">Microsoft Active Accessibility provides the constant **CHILDID\_SELF** to indicate that information is needed about the object itself.</span></span> <span data-ttu-id="95139-109">為了取得簡單元素的相關資訊，用戶端開發人員會在 [**VARIANT**](/windows/win32/api/oaidl/ns-oaidl-variant) 參數中指定其子系識別碼。</span><span class="sxs-lookup"><span data-stu-id="95139-109">To obtain information about a simple element, client developers specify its child ID in the [**VARIANT**](/windows/win32/api/oaidl/ns-oaidl-variant) parameter.</span></span>

<span data-ttu-id="95139-110">初始化 [**VARIANT**](/windows/win32/api/oaidl/ns-oaidl-variant)參數時，請務必在 **vt** 成員中指定 **vt \_ I4** ，除了指定子識別碼值 (或 CHILDID **lVal** 成員中 **的 \_ SELF**) 之外。</span><span class="sxs-lookup"><span data-stu-id="95139-110">When initializing a [**VARIANT**](/windows/win32/api/oaidl/ns-oaidl-variant) parameter, be sure to specify **VT\_I4** in the **vt** member in addition to specifying the child ID value (or **CHILDID\_SELF**) in the **lVal** member.</span></span>

<span data-ttu-id="95139-111">例如，若要取得物件的名稱，而不是物件的其中一個子專案，請將 IAccessible：： get accName 的第一個參數的 [**VARIANT**](/windows/win32/api/oaidl/ns-oaidl-variant)初始化為 [**：： Get \_**](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_accname) ( **CHILDID \_ SELF** in **vt**) member 中的 **lVal** 成員和 **vt \_ I4** ，然後呼叫 **IAccessible：： get \_ accName**。</span><span class="sxs-lookup"><span data-stu-id="95139-111">For example, to get the name of an object, and not one of the object's child elements, initialize the [**VARIANT**](/windows/win32/api/oaidl/ns-oaidl-variant) for the first parameter of [**IAccessible::get\_accName**](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_accname) ( **CHILDID\_SELF** in the **lVal** member and **VT\_I4** in the **vt** member), and then call **IAccessible::get\_accName**.</span></span>

## <a name="output-parameters"></a><span data-ttu-id="95139-112">輸出參數</span><span class="sxs-lookup"><span data-stu-id="95139-112">Output Parameters</span></span>

<span data-ttu-id="95139-113">有幾個 [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible)函式和方法具有 [**VARIANT**](/windows/win32/api/oaidl/ns-oaidl-variant) \* output 參數，其中包含子物件的子系識別碼或 [**IDispatch**](/previous-versions/windows/desktop/api/oaidl/nn-oaidl-idispatch)介面指標。</span><span class="sxs-lookup"><span data-stu-id="95139-113">Several [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) functions and methods have a [**VARIANT**](/windows/win32/api/oaidl/ns-oaidl-variant)\* output parameter that contains a child ID or an [**IDispatch**](/previous-versions/windows/desktop/api/oaidl/nn-oaidl-idispatch) interface pointer to a child object.</span></span> <span data-ttu-id="95139-114">用戶端必須採取不同的步驟，取決於它們是否會收到 **VT \_ I4** 子系識別碼 (簡單元素) 或使用 **CHILDID \_ SELF** (full object) 的 **IDispatch** 介面指標。</span><span class="sxs-lookup"><span data-stu-id="95139-114">There are different steps that a client must take depending on whether they receive a **VT\_I4** child ID (simple element) or an **IDispatch** interface pointer with **CHILDID\_SELF** (full object).</span></span> <span data-ttu-id="95139-115">遵循這些步驟將提供 **IAccessible** 介面指標和子系識別碼，讓用戶端能夠使用 **IAccessible** 方法和屬性。</span><span class="sxs-lookup"><span data-stu-id="95139-115">Following these steps will provide an **IAccessible** interface pointer and child ID that together allow clients to use the **IAccessible** methods and properties.</span></span> <span data-ttu-id="95139-116">這些步驟適用于 [**IAccessible：： accHitTest**](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-acchittest)、 [**get \_ accFocus**](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_accfocus)和 [**get \_ accSelection**](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_accselection) 方法。</span><span class="sxs-lookup"><span data-stu-id="95139-116">These steps apply to the [**IAccessible::accHitTest**](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-acchittest), [**get\_accFocus**](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_accfocus), and [**get\_accSelection**](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_accselection) methods.</span></span> <span data-ttu-id="95139-117">它們也適用于 [**AccessibleObjectFromEvent**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfromevent)、 [**AccessibleObjectFromPoint**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfrompoint)和 [**AccessibleObjectFromWindow**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfromwindow) 用戶端函式。</span><span class="sxs-lookup"><span data-stu-id="95139-117">They also apply to the [**AccessibleObjectFromEvent**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfromevent), [**AccessibleObjectFromPoint**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfrompoint), and [**AccessibleObjectFromWindow**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfromwindow) client functions.</span></span>

<span data-ttu-id="95139-118">下表列出傳回的可能結果，以及所需的後續處理步驟，讓用戶端有 [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) 介面指標和子系識別碼。</span><span class="sxs-lookup"><span data-stu-id="95139-118">The following table lists the possible result returned and the required post-processing steps so that clients will have an [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) interface pointer and child ID.</span></span>



| <span data-ttu-id="95139-119">傳回的結果</span><span class="sxs-lookup"><span data-stu-id="95139-119">Result returned</span></span>                                      | <span data-ttu-id="95139-120">傳回值的後置處理</span><span class="sxs-lookup"><span data-stu-id="95139-120">Post-processing for the return value</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="95139-121">[**IDispatch**](/previous-versions/windows/desktop/api/oaidl/nn-oaidl-idispatch) 介面指標</span><span class="sxs-lookup"><span data-stu-id="95139-121">[**IDispatch**](/previous-versions/windows/desktop/api/oaidl/nn-oaidl-idispatch) interface pointer</span></span> | <span data-ttu-id="95139-122">這是完整的物件。呼叫 [**QueryInterface**](/windows/desktop/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) 以存取 [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) 介面指標。</span><span class="sxs-lookup"><span data-stu-id="95139-122">This is a full object.Call [**QueryInterface**](/windows/desktop/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) to access the [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) interface pointer.</span></span><br/> <span data-ttu-id="95139-123">使用 [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) 介面指標搭配 **CHILDID \_ SELF** 來存取 **IAccessible** 方法和屬性。</span><span class="sxs-lookup"><span data-stu-id="95139-123">Use the [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) interface pointer with **CHILDID\_SELF** to access **IAccessible** methods and properties.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                               |
| <span data-ttu-id="95139-124">VT \_ I4 子識別碼</span><span class="sxs-lookup"><span data-stu-id="95139-124">VT\_I4 child ID</span></span>                                      | <span data-ttu-id="95139-125">使用子系識別碼呼叫 [**IAccessible：： get \_ accChild**](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_accchild) ，以查看您是否有 [**IDispatch**](/previous-versions/windows/desktop/api/oaidl/nn-oaidl-idispatch) 介面指標。如果您取得 [**IDispatch**](/previous-versions/windows/desktop/api/oaidl/nn-oaidl-idispatch) 介面指標，請使用它搭配 **CHILDID \_ SELF** 來存取 [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) 介面方法和屬性。</span><span class="sxs-lookup"><span data-stu-id="95139-125">Call [**IAccessible::get\_accChild**](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_accchild) using the child ID to see if you have an [**IDispatch**](/previous-versions/windows/desktop/api/oaidl/nn-oaidl-idispatch) interface pointer.If you get an [**IDispatch**](/previous-versions/windows/desktop/api/oaidl/nn-oaidl-idispatch) interface pointer, use it with **CHILDID\_SELF** to access [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) interface methods and properties.</span></span><br/> <span data-ttu-id="95139-126">如果 [**get \_ accChild**](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_accchild) 的呼叫失敗，您就會有一個簡單的元素。</span><span class="sxs-lookup"><span data-stu-id="95139-126">If the call to [**get\_accChild**](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_accchild) fails, you have a simple element.</span></span> <span data-ttu-id="95139-127">使用原始的 [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) 介面指標 (您在呼叫上述方法或函式時所使用的指標，) 具有呼叫傳回的 **VT \_ I4** 子識別碼。</span><span class="sxs-lookup"><span data-stu-id="95139-127">Use the original [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) interface pointer (the one you used in your call to the method or function mentioned above) with the **VT\_I4** child ID that the call returned.</span></span><br/> |



 

<span data-ttu-id="95139-128">在您可以使用 [**VARIANT**](/windows/win32/api/oaidl/ns-oaidl-variant) 參數之前，您必須呼叫 [**VariantInit**](/previous-versions/windows/desktop/api/oleauto/nf-oleauto-variantinit) 元件物件模型 (COM) 函數來將它初始化。</span><span class="sxs-lookup"><span data-stu-id="95139-128">Before you can use a [**VARIANT**](/windows/win32/api/oaidl/ns-oaidl-variant) parameter, you must initialize it by calling the [**VariantInit**](/previous-versions/windows/desktop/api/oleauto/nf-oleauto-variantinit) Component Object Model (COM) function.</span></span> <span data-ttu-id="95139-129">完成結構之後，請呼叫 [**VariantClear**](/previous-versions/windows/desktop/api/oleauto/nf-oleauto-variantclear) 來釋放為該 **變異** 保留的記憶體。</span><span class="sxs-lookup"><span data-stu-id="95139-129">When finished with the structure, call [**VariantClear**](/previous-versions/windows/desktop/api/oleauto/nf-oleauto-variantclear) to free the memory reserved for that **VARIANT**.</span></span>

## <a name="special-cases"></a><span data-ttu-id="95139-130">特殊案例</span><span class="sxs-lookup"><span data-stu-id="95139-130">Special Cases</span></span>

<span data-ttu-id="95139-131">上表中的指導方針有一些例外狀況，例如 [**IAccessible：： accHitTest**](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-acchittest) 方法傳回子系識別碼時。</span><span class="sxs-lookup"><span data-stu-id="95139-131">There are exceptions to the guidelines in the above table, such as when a child ID is returned by the [**IAccessible::accHitTest**](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-acchittest) method.</span></span> <span data-ttu-id="95139-132">如果子系是可存取的物件，則伺服器必須傳回 [**IDispatch**](/previous-versions/windows/desktop/api/oaidl/nn-oaidl-idispatch) 介面。</span><span class="sxs-lookup"><span data-stu-id="95139-132">Servers must return an [**IDispatch**](/previous-versions/windows/desktop/api/oaidl/nn-oaidl-idispatch) interface if the child is an accessible object.</span></span> <span data-ttu-id="95139-133">如果 **IAccessible：： accHitTest** 傳回子系識別碼，則子系是簡單元素。</span><span class="sxs-lookup"><span data-stu-id="95139-133">If a child ID is returned by **IAccessible::accHitTest**, the child is a simple element.</span></span>

<span data-ttu-id="95139-134">此外，也有特殊的 [**accNavigate**](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-accnavigate)案例。</span><span class="sxs-lookup"><span data-stu-id="95139-134">In addition, there are special cases for [**accNavigate**](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-accnavigate).</span></span> <span data-ttu-id="95139-135">如需詳細資訊，請參閱 **IAccessible：： accNavigate** 和 [空間與邏輯導覽](spatial-and-logical-navigation.md)。</span><span class="sxs-lookup"><span data-stu-id="95139-135">For more information, see **IAccessible::accNavigate** and [Spatial and Logical Navigation](spatial-and-logical-navigation.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="95139-136">相關主題</span><span class="sxs-lookup"><span data-stu-id="95139-136">Related topics</span></span>

<dl> <dt>

<span data-ttu-id="95139-137">**概念**</span><span class="sxs-lookup"><span data-stu-id="95139-137">**Conceptual**</span></span>
</dt> <dt>

[<span data-ttu-id="95139-138">IDispatch 介面</span><span class="sxs-lookup"><span data-stu-id="95139-138">IDispatch Interface</span></span>](idispatch-interface.md)
</dt> <dt>

[<span data-ttu-id="95139-139">VARIANT 結構</span><span class="sxs-lookup"><span data-stu-id="95139-139">VARIANT Structure</span></span>](variant-structure.md)
</dt> </dl>

 

