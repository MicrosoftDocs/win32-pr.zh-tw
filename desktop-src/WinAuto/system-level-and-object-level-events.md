---
title: System-Level 和 Object-Level 事件
description: Microsoft Active Accessibility 使用三個類別的 WinEvents 系統層級、物件層級和主控台。
ms.assetid: 3333fe6c-38cd-4e7e-be4b-94c9f824e7e7
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b0d14a0469527a7654dd3e323adb47d650866ca9
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 09/16/2019
ms.locfileid: "104300579"
---
# <a name="system-level-and-object-level-events"></a><span data-ttu-id="6ee9c-103">System-Level 和 Object-Level 事件</span><span class="sxs-lookup"><span data-stu-id="6ee9c-103">System-Level and Object-Level Events</span></span>

<span data-ttu-id="6ee9c-104">Microsoft Active Accessibility 使用三個 WinEvents 類別： *系統層級*、 *物件層級* 和 *主控台*。</span><span class="sxs-lookup"><span data-stu-id="6ee9c-104">Microsoft Active Accessibility uses three classes of WinEvents: *system level*, *object level*, and *console*.</span></span> <span data-ttu-id="6ee9c-105">每一個都有下列對應的 [事件常](event-constants.md) 數值：</span><span class="sxs-lookup"><span data-stu-id="6ee9c-105">Each has one of the following corresponding [event constant](event-constants.md) values:</span></span>

-   <span data-ttu-id="6ee9c-106">以事件系統開頭的事件常數 \_ 可識別系統層級事件。</span><span class="sxs-lookup"><span data-stu-id="6ee9c-106">Event constants that begin with EVENT\_SYSTEM identify system-level events.</span></span> <span data-ttu-id="6ee9c-107">這些事件會說明影響系統中所有應用程式的情況。</span><span class="sxs-lookup"><span data-stu-id="6ee9c-107">These events describe situations affecting all applications in the system.</span></span>
-   <span data-ttu-id="6ee9c-108">以 EVENT 物件開頭的事件常數會 \_ 識別物件層級的事件。</span><span class="sxs-lookup"><span data-stu-id="6ee9c-108">Event constants that begin with EVENT\_OBJECT identify object-level events.</span></span> <span data-ttu-id="6ee9c-109">這些事件與某個應用程式內物件特定的情況有關。</span><span class="sxs-lookup"><span data-stu-id="6ee9c-109">These events pertain to situations specific to objects within one application.</span></span>
-   <span data-ttu-id="6ee9c-110">以事件主控台開頭的事件常數 \_ 可識別主控台層級的事件。</span><span class="sxs-lookup"><span data-stu-id="6ee9c-110">Event constants that begin with EVENT\_CONSOLE identify console-level events.</span></span> <span data-ttu-id="6ee9c-111">這些事件表示主控台視窗中的變更。</span><span class="sxs-lookup"><span data-stu-id="6ee9c-111">These events indicate changes in console windows.</span></span>

<span data-ttu-id="6ee9c-112">事件的系統層級和物件層級類別都是由作業系統和伺服器應用程式所產生。</span><span class="sxs-lookup"><span data-stu-id="6ee9c-112">Both the system- and object-level classes of events are generated by the operating system and server applications.</span></span> <span data-ttu-id="6ee9c-113">作業系統會針對下列案例產生系統層級和物件層級的事件：</span><span class="sxs-lookup"><span data-stu-id="6ee9c-113">The operating system generates system-level and object-level events for the following scenarios:</span></span>

-   <span data-ttu-id="6ee9c-114">有關焦點變更的全系統通知</span><span class="sxs-lookup"><span data-stu-id="6ee9c-114">System-wide notifications about focus changes</span></span>
-   <span data-ttu-id="6ee9c-115">啟用變更</span><span class="sxs-lookup"><span data-stu-id="6ee9c-115">Activation changes</span></span>
-   <span data-ttu-id="6ee9c-116">關於系統提供物件的事件，例如通用控制項</span><span class="sxs-lookup"><span data-stu-id="6ee9c-116">Events regarding system-provided objects, such as common controls</span></span>

<span data-ttu-id="6ee9c-117">伺服器應用程式會針對複寫系統物件的自訂物件產生系統層級事件，例如自訂功能表和捲軸。</span><span class="sxs-lookup"><span data-stu-id="6ee9c-117">Server applications generate system-level events for custom objects that replicate system objects, such as custom menus and scroll bars.</span></span>

<span data-ttu-id="6ee9c-118">伺服器應用程式通常會產生物件層級的事件，以便變更其所包含的可存取物件，例如物件建立、損毀和選取。</span><span class="sxs-lookup"><span data-stu-id="6ee9c-118">Server applications typically generate object-level events for changes to the accessible objects they contain, such as object creation, destruction, and selection.</span></span>

<span data-ttu-id="6ee9c-119">雖然系統會產生 [**視窗**](window.md) 物件的物件層級事件，但是伺服器也必須針對視窗中包含的每個可存取物件傳送物件層級事件。</span><span class="sxs-lookup"><span data-stu-id="6ee9c-119">Although the system generates object-level events for [**window**](window.md) objects, servers must also send object-level events for every accessible object contained in a window.</span></span> <span data-ttu-id="6ee9c-120">例如，如果伺服器應用程式註冊應用程式定義的視窗類別來建立自訂控制項，系統就會為包含自訂控制項的視窗產生物件層級的事件。伺服器會產生可存取物件的物件層級事件，以提供控制項的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="6ee9c-120">For example, if a server application registers an application-defined window class to create a custom control, the system generates object-level events for the window that contains the custom control; the server generates object-level events for the accessible object that provides information about the control.</span></span>

<span data-ttu-id="6ee9c-121">伺服器只會針對其實 [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) 介面的自訂控制項，產生物件層級事件。</span><span class="sxs-lookup"><span data-stu-id="6ee9c-121">Servers only generate object-level events for the custom controls for which they implement the [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) interface.</span></span> <span data-ttu-id="6ee9c-122">如需詳細資訊，請參閱 [自訂消費者介面元素](custom-user-interface-elements.md)。</span><span class="sxs-lookup"><span data-stu-id="6ee9c-122">For more information, see [Custom User Interface Elements](custom-user-interface-elements.md).</span></span>

 

 




