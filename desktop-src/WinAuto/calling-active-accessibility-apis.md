---
title: 呼叫 Active Accessibility Api
description: Microsoft Active Accessibility 為用戶端和伺服器提供 (Api) 的應用程式程式設計介面。
ms.assetid: c40441d2-7294-4c76-8b42-08ed66eccb7e
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 209a239495fddbcaf2275f095abc889295568b3c
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/20/2020
ms.locfileid: "104023619"
---
# <a name="calling-active-accessibility-apis"></a><span data-ttu-id="2bea2-103">呼叫 Active Accessibility Api</span><span class="sxs-lookup"><span data-stu-id="2bea2-103">Calling Active Accessibility APIs</span></span>

<span data-ttu-id="2bea2-104">Microsoft Active Accessibility 為用戶端和伺服器提供 (Api) 的應用程式程式設計介面。</span><span class="sxs-lookup"><span data-stu-id="2bea2-104">Microsoft Active Accessibility provides application programming interfaces (APIs) for both clients and servers.</span></span> <span data-ttu-id="2bea2-105">大部分是在 Microsoft Active Accessibility 動態連結程式庫中執行，Oleacc.dll，但 [**NotifyWinEvent**](/windows/desktop/api/Winuser/nf-winuser-notifywinevent)、 [**SetWinEventHook**](/windows/desktop/api/Winuser/nf-winuser-setwineventhook)和 [**UnhookWinEvent**](/windows/desktop/api/Winuser/nf-winuser-unhookwinevent) 會在 user32.dll 中執行，這是 Microsoft Windows 作業系統的核心元件。</span><span class="sxs-lookup"><span data-stu-id="2bea2-105">Most are implemented in the Microsoft Active Accessibility dynamic-link library, Oleacc.dll, but [**NotifyWinEvent**](/windows/desktop/api/Winuser/nf-winuser-notifywinevent), [**SetWinEventHook**](/windows/desktop/api/Winuser/nf-winuser-setwineventhook), and [**UnhookWinEvent**](/windows/desktop/api/Winuser/nf-winuser-unhookwinevent) are implemented in user32.dll, which is a core component of the Microsoft Windows operating system.</span></span>

<span data-ttu-id="2bea2-106">執行 Windows 95 或 Microsoft Windows NT 4.0 的電腦未安裝 Oleacc.dll 和正確的 user32.dll 版本，因為 Microsoft Active Accessibility 已合併至 Windows 的後續版本。</span><span class="sxs-lookup"><span data-stu-id="2bea2-106">Computers running Windows 95 or Microsoft Windows NT 4.0 do not have Oleacc.dll and the correct version of user32.dll installed because Microsoft Active Accessibility was incorporated in stages into succeeding versions of Windows.</span></span> <span data-ttu-id="2bea2-107">因此，在這些平臺上執行的應用程式會使用 [**LoadLibrary**](/windows/desktop/api/libloaderapi/nf-libloaderapi-loadlibrarya) 函式在執行時間明確連結到 Oleacc.dll，而不是依賴匯入程式庫。</span><span class="sxs-lookup"><span data-stu-id="2bea2-107">As a result, applications that run on these platforms explicitly link to Oleacc.dll at run time using the [**LoadLibrary**](/windows/desktop/api/libloaderapi/nf-libloaderapi-loadlibrarya) function instead of relying on import libraries.</span></span> <span data-ttu-id="2bea2-108">Active Accessibility 1.3 支援 Windows 95 和 Microsoft Windows NT 4.0。</span><span class="sxs-lookup"><span data-stu-id="2bea2-108">Active Accessibility 1.3 supports Windows 95 and Microsoft Windows NT 4.0.</span></span> <span data-ttu-id="2bea2-109">Microsoft Active Accessibility 不支援舊版的 Windows。</span><span class="sxs-lookup"><span data-stu-id="2bea2-109">Earlier versions of Windows are not supported by Microsoft Active Accessibility.</span></span>

<span data-ttu-id="2bea2-110">伺服器應用程式會使用 [**GetProcAddress**](/windows/desktop/api/libloaderapi/nf-libloaderapi-getprocaddress) 函數來取出 Microsoft Active Accessibility 函式的位址，然後透過函式指標進行呼叫。</span><span class="sxs-lookup"><span data-stu-id="2bea2-110">Server applications use the [**GetProcAddress**](/windows/desktop/api/libloaderapi/nf-libloaderapi-getprocaddress) function to retrieve the address of an Microsoft Active Accessibility function and then make the call through a function pointer.</span></span> <span data-ttu-id="2bea2-111">如果呼叫在 Oleacc.dll 中執行的函式，則伺服器應用程式會使用在調用調用中從 [**LoadLibrary**](/windows/desktop/api/libloaderapi/nf-libloaderapi-loadlibrarya)傳回的句 **柄。**</span><span class="sxs-lookup"><span data-stu-id="2bea2-111">If calling a function that was implemented in Oleacc.dll, server applications use the handle returned from [**LoadLibrary**](/windows/desktop/api/libloaderapi/nf-libloaderapi-loadlibrarya) in the call to **GetProcAddress**.</span></span> <span data-ttu-id="2bea2-112">如果呼叫 user32.dll 中定義的函式，則伺服器應用程式會呼叫指定 "USER32" 的 [**GetModuleHandle**](/windows/desktop/api/libloaderapi/nf-libloaderapi-getmodulehandlea) ，並在調用中使用傳回的模組控制碼來進行 **GetProcAddress**。</span><span class="sxs-lookup"><span data-stu-id="2bea2-112">If calling a function defined in user32.dll, server applications call [**GetModuleHandle**](/windows/desktop/api/libloaderapi/nf-libloaderapi-getmodulehandlea) specifying "USER32" and use the returned module handle in the call to **GetProcAddress**.</span></span>

<span data-ttu-id="2bea2-113">例如，如果應用程式使用 [**NotifyWinEvent**](/windows/desktop/api/Winuser/nf-winuser-notifywinevent)，它會使用 user32.dll 的模組控制碼來呼叫 [**GetProcAddress**](/windows/desktop/api/libloaderapi/nf-libloaderapi-getprocaddress) ，以取得函數的位址。</span><span class="sxs-lookup"><span data-stu-id="2bea2-113">For example, if an application uses [**NotifyWinEvent**](/windows/desktop/api/Winuser/nf-winuser-notifywinevent), it calls [**GetProcAddress**](/windows/desktop/api/libloaderapi/nf-libloaderapi-getprocaddress) using the module handle of user32.dll to get the address of the function.</span></span> <span data-ttu-id="2bea2-114">如果呼叫成功 (表示這個版本的 Windows 支援 Microsoft Active Accessibility) ，則應用程式會設定旗標，指出可以安全地呼叫 **NotifyWinEvent**。</span><span class="sxs-lookup"><span data-stu-id="2bea2-114">If the call is successful (meaning that this version of Windows supports Microsoft Active Accessibility), then the application sets a flag that indicates that it is safe to call **NotifyWinEvent**.</span></span> <span data-ttu-id="2bea2-115">從 **GetProcAddress** 接收的位址會儲存在函式指標變數中，並在整個程式碼中使用。</span><span class="sxs-lookup"><span data-stu-id="2bea2-115">The address received from **GetProcAddress** is stored in a function pointer variable and used throughout the code.</span></span>

 

 