---
title: 消費者介面自動化如何公開内嵌物件
description: 本主題說明 Microsoft 消費者介面自動化如何在文字檔或容器中公開内嵌物件或子項目。
ms.assetid: 5ecf5e94-5329-4abb-aedb-4e303688e5f7
keywords:
- 消費者介面自動化，文字模式總覽
- 消費者介面自動化，文字控制項總覽
- 消費者介面自動化，文字控制項模式
- 消費者介面自動化，内嵌物件總覽
- 消費者介面自動化，公開内嵌物件
- 消費者介面自動化，内嵌物件的案例
- 文字模式，關於
- 文字控制項，關於
- 文字控制項模式
- 控制項模式、文字
- 內嵌物件
- 公開内嵌物件
ms.topic: article
ms.date: 08/31/2019
ms.openlocfilehash: b85d7fa9e068400e3a339625acad1036a4cdd111
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/20/2020
ms.locfileid: "103682410"
---
# <a name="how-ui-automation-exposes-embedded-objects"></a><span data-ttu-id="2fa75-115">消費者介面自動化如何公開内嵌物件</span><span class="sxs-lookup"><span data-stu-id="2fa75-115">How UI Automation Exposes Embedded Objects</span></span>

<span data-ttu-id="2fa75-116">本主題說明 Microsoft 消費者介面自動化如何使用 Text 和 TextRange 控制項模式，在文字檔或容器中) 的子系/子代元素 (公開内嵌物件。</span><span class="sxs-lookup"><span data-stu-id="2fa75-116">This topic describes how Microsoft UI Automation uses the Text and TextRange control patterns to expose embedded objects (child/descendent elements) in a text document or container.</span></span>

<span data-ttu-id="2fa75-117">針對消費者介面自動化，内嵌物件是任何具有非文字界限的元素，例如影像、超連結、表格或檔案類型 (Microsoft Excel 試算表、Microsoft Windows Media 檔案等) 。</span><span class="sxs-lookup"><span data-stu-id="2fa75-117">For UI Automation, an embedded object is any element that has non-textual boundaries such as an image, hyperlink, table, or document type (Microsoft Excel spreadsheet, Microsoft Windows Media file, and so on).</span></span>

> [!NOTE]
> <span data-ttu-id="2fa75-118">這與元件物件模型不同 (COM) OLE 定義 (請參閱 [内嵌物件](../com/embedded-objects.md)) ，也就是在一個應用程式中建立專案，並在另一個應用程式中內嵌或連結的專案。</span><span class="sxs-lookup"><span data-stu-id="2fa75-118">This differs from the Component Object Model (COM) OLE definition (see [Embedded Objects](../com/embedded-objects.md)), where an element is created in one application and embedded or linked in another application.</span></span> <span data-ttu-id="2fa75-119">是否可以在它的原始應用程式中編輯物件，與消費者介面自動化的內容無關。</span><span class="sxs-lookup"><span data-stu-id="2fa75-119">Whether the object can be edited in its original application is irrelevant in the context of UI Automation.</span></span>

## <a name="embedded-objects-and-the-ui-automation-tree"></a><span data-ttu-id="2fa75-120">內嵌物件和 UI 自動化樹狀目錄</span><span class="sxs-lookup"><span data-stu-id="2fa75-120">Embedded Objects and the UI Automation Tree</span></span>

<span data-ttu-id="2fa75-121">内嵌物件在消費者介面自動化樹狀結構的控制項視圖中會被視為個別的元素。</span><span class="sxs-lookup"><span data-stu-id="2fa75-121">Embedded objects are treated as individual elements in the control view of the UI Automation tree.</span></span> <span data-ttu-id="2fa75-122">它們會公開成為文字容器的子系，以便透過與消費者介面自動化中其他控制項相同的物件模型來存取它們。</span><span class="sxs-lookup"><span data-stu-id="2fa75-122">They are exposed as children of the text container so that they can be accessed through the same object model as other controls in UI Automation.</span></span>

<span data-ttu-id="2fa75-123">下表列出容器和非容器元素的範例。</span><span class="sxs-lookup"><span data-stu-id="2fa75-123">The following table lists examples of container and non-container elements.</span></span>

:::row:::
   :::column span="2":::

      <span data-ttu-id="2fa75-124">**容器元素**</span><span class="sxs-lookup"><span data-stu-id="2fa75-124">**Container elements**</span></span>

   :::column-end:::
   :::column span="":::

      <span data-ttu-id="2fa75-125">**非容器元素**</span><span class="sxs-lookup"><span data-stu-id="2fa75-125">**Non-container elements**</span></span>

   :::column-end:::
:::row-end:::
:::row:::
   :::column span="":::

- <span data-ttu-id="2fa75-126">Calendar</span><span class="sxs-lookup"><span data-stu-id="2fa75-126">Calendar</span></span>
- <span data-ttu-id="2fa75-127">Combobox</span><span class="sxs-lookup"><span data-stu-id="2fa75-127">Combobox</span></span>
- <span data-ttu-id="2fa75-128">DataGrid</span><span class="sxs-lookup"><span data-stu-id="2fa75-128">DataGrid</span></span>
- <span data-ttu-id="2fa75-129">文件</span><span class="sxs-lookup"><span data-stu-id="2fa75-129">Document</span></span>
- <span data-ttu-id="2fa75-130">編輯</span><span class="sxs-lookup"><span data-stu-id="2fa75-130">Edit</span></span>
- <span data-ttu-id="2fa75-131">Group</span><span class="sxs-lookup"><span data-stu-id="2fa75-131">Group</span></span>
- <span data-ttu-id="2fa75-132">標頭</span><span class="sxs-lookup"><span data-stu-id="2fa75-132">Header</span></span>
- <span data-ttu-id="2fa75-133">HeaderItem</span><span class="sxs-lookup"><span data-stu-id="2fa75-133">HeaderItem</span></span>
- <span data-ttu-id="2fa75-134">List</span><span class="sxs-lookup"><span data-stu-id="2fa75-134">List</span></span>
- <span data-ttu-id="2fa75-135">功能表</span><span class="sxs-lookup"><span data-stu-id="2fa75-135">Menu</span></span>

   :::column-end:::
   :::column span="":::

- <span data-ttu-id="2fa75-136">MenuBar</span><span class="sxs-lookup"><span data-stu-id="2fa75-136">MenuBar</span></span>
- <span data-ttu-id="2fa75-137">窗格</span><span class="sxs-lookup"><span data-stu-id="2fa75-137">Pane</span></span>
- <span data-ttu-id="2fa75-138">SplitButton</span><span class="sxs-lookup"><span data-stu-id="2fa75-138">SplitButton</span></span>
- <span data-ttu-id="2fa75-139">索引標籤</span><span class="sxs-lookup"><span data-stu-id="2fa75-139">Tab</span></span>
- <span data-ttu-id="2fa75-140">資料表</span><span class="sxs-lookup"><span data-stu-id="2fa75-140">Table</span></span>
- <span data-ttu-id="2fa75-141">工具列</span><span class="sxs-lookup"><span data-stu-id="2fa75-141">Toolbar</span></span>
- <span data-ttu-id="2fa75-142">樹狀結構</span><span class="sxs-lookup"><span data-stu-id="2fa75-142">Tree</span></span>
- <span data-ttu-id="2fa75-143">TreeItem</span><span class="sxs-lookup"><span data-stu-id="2fa75-143">TreeItem</span></span>
- <span data-ttu-id="2fa75-144">時間範圍</span><span class="sxs-lookup"><span data-stu-id="2fa75-144">Window</span></span>

   :::column-end:::
   :::column span="":::

- <span data-ttu-id="2fa75-145">連結</span><span class="sxs-lookup"><span data-stu-id="2fa75-145">Link</span></span>
- <span data-ttu-id="2fa75-146">Cpl</span><span class="sxs-lookup"><span data-stu-id="2fa75-146">CheckBoxes</span></span>
- <span data-ttu-id="2fa75-147">按鈕</span><span class="sxs-lookup"><span data-stu-id="2fa75-147">Button</span></span>

  :::column-end:::
:::row-end:::

<span data-ttu-id="2fa75-148">下圖顯示使用內嵌資料表和影像)  (檔的文字容器。</span><span class="sxs-lookup"><span data-stu-id="2fa75-148">The following image shows a text container (document) with an embedded table and image.</span></span>

![顯示具有內嵌資料表和影像之檔的圖例](images/embeddedtable.jpg)

<span data-ttu-id="2fa75-150">上述檔的消費者介面自動化內容視圖如下圖所示。</span><span class="sxs-lookup"><span data-stu-id="2fa75-150">The UI Automation content view of the preceding document is shown in the following diagram.</span></span>

![具有内嵌物件之檔的 ui 自動化內容視圖圖](images/contenttree.jpg)

### <a name="compatible-and-non-compatible-embedded-objects"></a><span data-ttu-id="2fa75-152">「相容」和「不相容」的内嵌物件</span><span class="sxs-lookup"><span data-stu-id="2fa75-152">"Compatible" and "Non-Compatible" embedded objects</span></span>

<span data-ttu-id="2fa75-153">某些消費者介面自動化提供者會針對其所包含的每個 TextPattern 物件使用相同的文字存放區。</span><span class="sxs-lookup"><span data-stu-id="2fa75-153">Some UI Automation providers use the same text store for each TextPattern object they contain.</span></span>  <span data-ttu-id="2fa75-154">與容器相同的文字存放區所支援的物件稱為「相容」的内嵌物件。</span><span class="sxs-lookup"><span data-stu-id="2fa75-154">Objects backed by the same text store as their container are referred to as "compatible" embedded objects.</span></span> <span data-ttu-id="2fa75-155">這些物件可以是 TextPattern 物件，在此情況下，其文字範圍可與從其容器取得的文字範圍相當。</span><span class="sxs-lookup"><span data-stu-id="2fa75-155">These objects can be TextPattern objects themselves and, in this case, their text ranges are comparable to text ranges obtained from their container.</span></span> <span data-ttu-id="2fa75-156">這可讓提供者公開個別 TextPattern 物件的用戶端資訊，就像是一個大型文字提供者一樣。</span><span class="sxs-lookup"><span data-stu-id="2fa75-156">This enables the providers to expose client information about the individual TextPattern objects as if they were one, large text provider.</span></span>

<span data-ttu-id="2fa75-157">但是，提供者可以針對內嵌于 TextPattern 容器內的不同 TextPattern 物件使用不同的文字存放區。</span><span class="sxs-lookup"><span data-stu-id="2fa75-157">However, providers can use different text stores for different TextPattern objects embedded within a TextPattern container.</span></span> <span data-ttu-id="2fa75-158">容器的文字存放區不支援的物件稱為「不相容」的内嵌物件。</span><span class="sxs-lookup"><span data-stu-id="2fa75-158">Objects not backed by the container's text store are referred to as "non-compatible" embedded objects.</span></span> <span data-ttu-id="2fa75-159">這些類型的内嵌物件不一定是以 TextPattern 為基礎的物件。</span><span class="sxs-lookup"><span data-stu-id="2fa75-159">These types of embedded objects might or might not be TextPattern-based objects.</span></span>  

<span data-ttu-id="2fa75-160">下表列出一些相容和不相容的内嵌物件範例。</span><span class="sxs-lookup"><span data-stu-id="2fa75-160">The following table lists some examples of compatible and non-compatible embedded objects.</span></span>

|   | <span data-ttu-id="2fa75-161">相容的内嵌物件</span><span class="sxs-lookup"><span data-stu-id="2fa75-161">Compatible embedded objects</span></span> | <span data-ttu-id="2fa75-162">不相容的内嵌物件</span><span class="sxs-lookup"><span data-stu-id="2fa75-162">Non-compatible embedded objects</span></span> |
| --- | --- | --- |
| <span data-ttu-id="2fa75-163">非 TextPattern 的内嵌物件</span><span class="sxs-lookup"><span data-stu-id="2fa75-163">Non-TextPattern embedded objects</span></span> | <span data-ttu-id="2fa75-164">按鈕 Microsoft Edge</span><span class="sxs-lookup"><span data-stu-id="2fa75-164">Button in Microsoft Edge</span></span><br><span data-ttu-id="2fa75-165">Microsoft Edge 中的資料表</span><span class="sxs-lookup"><span data-stu-id="2fa75-165">Data Table in Microsoft Edge</span></span> | <span data-ttu-id="2fa75-166">Microsoft XAML 架構 k 中的按鈕</span><span class="sxs-lookup"><span data-stu-id="2fa75-166">Button in RichTextBlock in Microsoft’s XAML framework</span></span><br><span data-ttu-id="2fa75-167">Microsoft Edge 中具有 alt 文字的影像</span><span class="sxs-lookup"><span data-stu-id="2fa75-167">Images with alt-text in Microsoft Edge</span></span><br><span data-ttu-id="2fa75-168">Microsoft XAML 架構中 k 的 ListView with ListItems</span><span class="sxs-lookup"><span data-stu-id="2fa75-168">ListView with ListItems in RichTextBlock in Microsoft’s XAML framework</span></span> |
| <span data-ttu-id="2fa75-169">TextPattern 内嵌物件</span><span class="sxs-lookup"><span data-stu-id="2fa75-169">TextPattern embedded objects</span></span> | <span data-ttu-id="2fa75-170">Microsoft Edge 中 "text" 類型的輸入控制項</span><span class="sxs-lookup"><span data-stu-id="2fa75-170">Input control of type “text” in Microsoft Edge</span></span><br><span data-ttu-id="2fa75-171">Word 檔中的表格</span><span class="sxs-lookup"><span data-stu-id="2fa75-171">Table in a Word document</span></span> | <span data-ttu-id="2fa75-172">Microsoft Word 檔中的 TextBox 元素</span><span class="sxs-lookup"><span data-stu-id="2fa75-172">TextBox element in a Microsoft Word document</span></span> |

## <a name="exposing-embedded-objects"></a><span data-ttu-id="2fa75-173">公開内嵌物件</span><span class="sxs-lookup"><span data-stu-id="2fa75-173">Exposing Embedded Objects</span></span>

<span data-ttu-id="2fa75-174">[Text 和 TextRange](uiauto-implementingtextandtextrange.md)控制項模式會公開屬性和方法，以方便流覽和查詢內嵌物件。</span><span class="sxs-lookup"><span data-stu-id="2fa75-174">The [Text and TextRange](uiauto-implementingtextandtextrange.md) control patterns expose properties and methods that facilitate navigation and querying of embedded objects.</span></span>

<span data-ttu-id="2fa75-175">文字內容 (或文字容器的內部文字) 和内嵌物件（例如超連結或資料表單元格）會在控制項視圖和消費者介面自動化樹狀結構的內容視圖中公開為單一的連續文字資料流程;系統會忽略物件界限。</span><span class="sxs-lookup"><span data-stu-id="2fa75-175">The textual content (or inner text) of a text container and an embedded object, such as a hyperlink or table cell, is exposed as a single, continuous text stream in both the control view and the content view of the UI Automation tree; object boundaries are ignored.</span></span> <span data-ttu-id="2fa75-176">如果消費者介面自動化用戶端正在以某種方式來朗誦、解讀或分析文字，則應檢查特殊案例（例如具有文字內容或其他內嵌物件的表格）的文字範圍。</span><span class="sxs-lookup"><span data-stu-id="2fa75-176">If a UI Automation client is retrieving the text to recite, interpret, or analyze in some manner, the text range should be checked for special cases, such as a table with textual content or other embedded objects.</span></span> <span data-ttu-id="2fa75-177">呼叫 [**IUIAutomationTextRange：： GetChildren**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-getchildren) ，以取得每個內嵌物件的 [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) 介面，然後呼叫 [**IUIAutomationTextPattern：： RangeFromChild**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextpattern-rangefromchild) 來取得每個元素的文字範圍。</span><span class="sxs-lookup"><span data-stu-id="2fa75-177">Call [**IUIAutomationTextRange::GetChildren**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-getchildren) to obtain a [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) interface for each embedded object, and then call [**IUIAutomationTextPattern::RangeFromChild**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextpattern-rangefromchild) to obtain a text range for each element.</span></span> <span data-ttu-id="2fa75-178">這會以遞迴方式進行，直到擷取所有的文字內容為止。</span><span class="sxs-lookup"><span data-stu-id="2fa75-178">This is done recursively until all textual content has been retrieved.</span></span>

> [!NOTE]
> <span data-ttu-id="2fa75-179">退化 (或折迭的) 範圍是開始端點和結束端點相同的位置。</span><span class="sxs-lookup"><span data-stu-id="2fa75-179">A degenerate (or collapsed) range is where the start endpoint and the end endpoint are same.</span></span> <span data-ttu-id="2fa75-180">退化範圍通常用來指出文字游標在 [ITextProvider](/windows/win32/api/uiautomationcore/nn-uiautomationcore-itextprovider) [GetSelection](/windows/win32/api/uiautomationcore/nf-uiautomationcore-itextprovider-getselection) 和 [GetCaretRange](/windows/win32/api/uiautomationcore/nf-uiautomationcore-itextprovider2-getcaretrange) 方法中的位置。</span><span class="sxs-lookup"><span data-stu-id="2fa75-180">Degenerate ranges are often used to indicate text cursor position through the [ITextProvider](/windows/win32/api/uiautomationcore/nn-uiautomationcore-itextprovider) [GetSelection](/windows/win32/api/uiautomationcore/nf-uiautomationcore-itextprovider-getselection) and [GetCaretRange](/windows/win32/api/uiautomationcore/nf-uiautomationcore-itextprovider2-getcaretrange) methods.</span></span>

<span data-ttu-id="2fa75-181">下圖顯示具有内嵌物件和其範圍範圍的文字資料流程。</span><span class="sxs-lookup"><span data-stu-id="2fa75-181">The following diagram shows a text stream with embedded objects and their range spans.</span></span>

![顯示具有内嵌物件及其範圍範圍之文字資料流程的圖表](images/rangespans.jpg)

## <a name="embedded-objects-and-textunit"></a><span data-ttu-id="2fa75-183">内嵌物件和 TextUnit</span><span class="sxs-lookup"><span data-stu-id="2fa75-183">Embedded objects and TextUnit</span></span>

<span data-ttu-id="2fa75-184">[ITextProvider](/windows/win32/api/uiautomationcore/nn-uiautomationcore-itextprovider)物件可以由指定的[TextUnit](/windows/desktop/api/uiautomationcore/ne-uiautomationcore-textunit)進行往返。</span><span class="sxs-lookup"><span data-stu-id="2fa75-184">An [ITextProvider](/windows/win32/api/uiautomationcore/nn-uiautomationcore-itextprovider) object can be traversed and  by a specified [TextUnit](/windows/desktop/api/uiautomationcore/ne-uiautomationcore-textunit).</span></span> <span data-ttu-id="2fa75-185">包含内嵌物件的提供者可以用很多方式來進行處理，但内嵌物件會影響到遍歷。</span><span class="sxs-lookup"><span data-stu-id="2fa75-185">Providers that contain embedded objects can be traversed in much the same way, but embedded objects do affect traversal.</span></span> <span data-ttu-id="2fa75-186">以下是一些要注意的事項：</span><span class="sxs-lookup"><span data-stu-id="2fa75-186">Here are some things to be aware of:</span></span>

- <span data-ttu-id="2fa75-187">任何不相容的内嵌物件都會以容器元素 TextPattern 的文字存放區中的取代字元 U + FFFC 來表示。</span><span class="sxs-lookup"><span data-stu-id="2fa75-187">Any non-compatible embedded object is represented by the replacement character U+FFFC in the text store of the container element's TextPattern.</span></span> <span data-ttu-id="2fa75-188">它也會同時視為字元單位和單字單位。</span><span class="sxs-lookup"><span data-stu-id="2fa75-188">It is also considered both a character unit and a word unit.</span></span>
- <span data-ttu-id="2fa75-189">相容的内嵌物件可能包含多個字元和單字。</span><span class="sxs-lookup"><span data-stu-id="2fa75-189">Compatible embedded objects may consist of multiple characters and words.</span></span>
- <span data-ttu-id="2fa75-190">封入元素是橫跨整個文字範圍的最底層元素。</span><span class="sxs-lookup"><span data-stu-id="2fa75-190">The enclosing element is the bottom-most element that spans the entire text range.</span></span>
- <span data-ttu-id="2fa75-191">範圍的子專案也是在範圍內部分或完全封閉之容器元素的子項目。</span><span class="sxs-lookup"><span data-stu-id="2fa75-191">Child elements of a range are also child elements of a container element that is partially or completely enclosed within the range.</span></span>
- <span data-ttu-id="2fa75-192">在理想的情況下 (特別是如果是資料表之類的容器元素) 單字界限不會超出物件界限。</span><span class="sxs-lookup"><span data-stu-id="2fa75-192">Ideally (especially in case of container elements like Table) a word boundary does not go beyond the object boundary.</span></span> <span data-ttu-id="2fa75-193">在下列範例中，文字單位 "Bar" 不包含標記 (的任何文字位置，而不是 `</td>` `<br \>` "Bar" ) 的一部分。</span><span class="sxs-lookup"><span data-stu-id="2fa75-193">In the following example, the word unit "Bar" does not contain any text position that is outside the `</td>` tag (`<br \>` is not be part of the word "Bar").</span></span>

```Xaml
<table style="width:100%">
  <tr>
    <th>Name</th>
    <th>Notes</th>
  </tr>
  <tr>
    <td>Eve Jackson</td>
    <td>Foo Bar</td>
  </tr>
</table>
<br/>
```

- <span data-ttu-id="2fa75-194">一般而言， `<br \>` 會將視為個別的單字，使其不會超過行界限。</span><span class="sxs-lookup"><span data-stu-id="2fa75-194">In general, `<br \>` is treated as an individual word such that it does not go beyond a line boundary.</span></span>
- <span data-ttu-id="2fa75-195">上述規則的例外狀況是文字文字單位在本身內包含完整物件的位置。</span><span class="sxs-lookup"><span data-stu-id="2fa75-195">An exception to the previous rule is where a Word text unit contains complete objects within itself.</span></span> <span data-ttu-id="2fa75-196">例如， `<p>Hello <a href="#">link</a> here.</p>` 包含內嵌容器的 "Hello"、"link" 和 "here" 等字。</span><span class="sxs-lookup"><span data-stu-id="2fa75-196">For example, `<p>Hello <a href="#">link</a> here.</p>`, which includes inline containers, has the words "Hello ", "link " and "here."</span></span> <span data-ttu-id="2fa75-197">其中 "link" 具有 TextPattern 物件做為封入專案，以及連結化物件做為子系。</span><span class="sxs-lookup"><span data-stu-id="2fa75-197">Where "link " has a TextPattern object as the enclosing element and a link object as its child.</span></span>
- <span data-ttu-id="2fa75-198">在字元單位的案例中，物件是封入元素 (文字單位，這就不應該有子系) 。</span><span class="sxs-lookup"><span data-stu-id="2fa75-198">In the case of Character units, the object is the enclosing element (text units like this should not have children).</span></span>
- <span data-ttu-id="2fa75-199">注釋物件不應該以内嵌物件表示。</span><span class="sxs-lookup"><span data-stu-id="2fa75-199">Annotation objects should not be represented as embedded object.</span></span> <span data-ttu-id="2fa75-200">例如，在共同撰寫的檔中有其他作者規範存在。</span><span class="sxs-lookup"><span data-stu-id="2fa75-200">For example, the presence of other Author specifiers in a co-authored document.</span></span>
- <span data-ttu-id="2fa75-201">内嵌物件至少需要一個資料指標位置，注釋只是中繼資料。</span><span class="sxs-lookup"><span data-stu-id="2fa75-201">Embedded objects take up at least one cursor position, annotation is just metadata.</span></span>
- <span data-ttu-id="2fa75-202">每個物件界限 (開始與結束) 會以 TextPattern 檔範圍中的格式分隔符號表示。</span><span class="sxs-lookup"><span data-stu-id="2fa75-202">Each object boundary (start and end) is represented by a format break in the TextPattern document range.</span></span>
- <span data-ttu-id="2fa75-203">若是 HTML，每個 html 標記不一定會產生消費者介面自動化物件。</span><span class="sxs-lookup"><span data-stu-id="2fa75-203">For HTML, each html tag does not necessarily result in a UI Automation object.</span></span> <span data-ttu-id="2fa75-204">例如， <em></em> 強調標記內的內容不需要表示為元素，而是 UIA_IsItalicAttributeId 傳回 TRUE 的文字資料流程。</span><span class="sxs-lookup"><span data-stu-id="2fa75-204">For example, content within <em></em> emphasis tags need not be represented as element but rather a text stream where UIA_IsItalicAttributeId returns TRUE.</span></span>
- <span data-ttu-id="2fa75-205">啟動端點是內含的，且為端點專用時的慣用端點。</span><span class="sxs-lookup"><span data-stu-id="2fa75-205">Start endpoint is inclusive and is the preferred endpoint while the End endpoint is exclusive.</span></span> <span data-ttu-id="2fa75-206">當範圍為退化，且開始和結束端點屬於該範圍的相同位置時，這非常有用。</span><span class="sxs-lookup"><span data-stu-id="2fa75-206">This is useful for when the range is degenerate and the Start and End endpoints belong to same position for that range.</span></span>

## <a name="comparing-embedded-objects"></a><span data-ttu-id="2fa75-207">比較内嵌物件</span><span class="sxs-lookup"><span data-stu-id="2fa75-207">Comparing embedded objects</span></span>

<span data-ttu-id="2fa75-208">在類似的子關聯性中，並共用相同的支援文字存放區的嵌套 TextPattern 物件稱為可比較。</span><span class="sxs-lookup"><span data-stu-id="2fa75-208">Nested TextPattern objects that are in a similar child relationship and share the same backing text store are called comparable.</span></span> <span data-ttu-id="2fa75-209">在此情況下，可以使用 [ITextRangeProvider：： Compare](/windows/win32/api/uiautomationcore/nf-uiautomationcore-itextrangeprovider-compare) 和 [ITextRangeProvider：： CompareEndpoints](/windows/win32/api/uiautomationcore/nf-uiautomationcore-itextrangeprovider-compareendpoints)來比較 TextPattern 物件的範圍。</span><span class="sxs-lookup"><span data-stu-id="2fa75-209">In this case, ranges from either of the TextPattern objects can be compared using [ITextRangeProvider::Compare](/windows/win32/api/uiautomationcore/nf-uiautomationcore-itextrangeprovider-compare) and [ITextRangeProvider::CompareEndpoints](/windows/win32/api/uiautomationcore/nf-uiautomationcore-itextrangeprovider-compareendpoints).</span></span> <span data-ttu-id="2fa75-210">兩者都會產生有效的數值，以指定其相對位置。</span><span class="sxs-lookup"><span data-stu-id="2fa75-210">Both result in a valid numerical value specifying their relative position.</span></span>

<span data-ttu-id="2fa75-211">如果物件在 TextPattern ([ITextProvider：： RangeFromChild](/windows/win32/api/uiautomationcore/nf-uiautomationcore-itextprovider-rangefromchild)) 中的有效範圍，且文字範圍背後的內容不是空的，而且不是取代字元，則內嵌于 TextPattern 物件中的非 TextPattern 物件可與 TextPattern 比較。</span><span class="sxs-lookup"><span data-stu-id="2fa75-211">A non-TextPattern object embedded in a TextPattern object is comparable to the TextPattern if the object has a valid range in the TextPattern ([ITextProvider::RangeFromChild](/windows/win32/api/uiautomationcore/nf-uiautomationcore-itextprovider-rangefromchild)) and the content behind the text range is not empty and is not a replacement character.</span></span>

## <a name="embedded-textpattern-objects-and-the-document-textunit"></a><span data-ttu-id="2fa75-212">內嵌 TextPattern 物件和檔 TextUnit</span><span class="sxs-lookup"><span data-stu-id="2fa75-212">Embedded TextPattern objects and the Document TextUnit</span></span>

<span data-ttu-id="2fa75-213">針對內嵌的 TextPattern 物件， [檔](/windows/win32/api/uiautomationcore/ne-uiautomationcore-textunit) 單位只會辨識該元素內所包含的內容。</span><span class="sxs-lookup"><span data-stu-id="2fa75-213">For embedded TextPattern objects, the [Document](/windows/win32/api/uiautomationcore/ne-uiautomationcore-textunit) unit only recognizes the content contained within that element.</span></span>

### <a name="word-textpattern-element-hierarchy"></a><span data-ttu-id="2fa75-214">Word TextPattern 元素階層</span><span class="sxs-lookup"><span data-stu-id="2fa75-214">Word TextPattern element hierarchy</span></span>

- <span data-ttu-id="2fa75-215">Document 元素會執行 TextPattern 和 [document](/windows/win32/api/uiautomationcore/ne-uiautomationcore-textunit) ，以傳回整個 Word 檔範圍。</span><span class="sxs-lookup"><span data-stu-id="2fa75-215">The document element implements TextPattern and [Document](/windows/win32/api/uiautomationcore/ne-uiautomationcore-textunit) returns the entire Word document range.</span></span>
- <span data-ttu-id="2fa75-216">檔的個別頁面會執行 TextPattern，而且 [檔](/windows/win32/api/uiautomationcore/ne-uiautomationcore-textunit) 會傳回這些個別頁面的內容 (即使頁面與整個檔 TextPattern) 共用相同的文字存放區也一樣。</span><span class="sxs-lookup"><span data-stu-id="2fa75-216">Individual pages of the document implement TextPattern and [Document](/windows/win32/api/uiautomationcore/ne-uiautomationcore-textunit) returns the content of those individual pages (even though the pages share the same text store with the entire document TextPattern).</span></span>

### <a name="webpage-and-text-input-controls-in-edge"></a><span data-ttu-id="2fa75-217">Edge 中的網頁和文字輸入控制項</span><span class="sxs-lookup"><span data-stu-id="2fa75-217">Webpage and text input controls in Edge</span></span>

- <span data-ttu-id="2fa75-218">主要網頁窗格元素會執行 TextPattern，並公開整個網頁內容。</span><span class="sxs-lookup"><span data-stu-id="2fa75-218">The main webpage Pane element implements TextPattern and exposes the entire webpage content.</span></span>
- <span data-ttu-id="2fa75-219">個別的文字輸入控制項支援 TextPattern，其中檔範圍代表每個輸入欄位中包含的文字 (即使它們與整個網頁) 共用相同的文字存放區也一樣。</span><span class="sxs-lookup"><span data-stu-id="2fa75-219">Individual text input controls support TextPattern where a document range represents the text contained in each input field (even though they share the same text store with the entire webpage).</span></span>

## <a name="common-scenarios"></a><span data-ttu-id="2fa75-220">常見案例</span><span class="sxs-lookup"><span data-stu-id="2fa75-220">Common Scenarios</span></span>

<span data-ttu-id="2fa75-221">本章節提供包含内嵌物件之常見案例的範例：超連結、影像和資料表。</span><span class="sxs-lookup"><span data-stu-id="2fa75-221">This section presents examples of common scenarios that involve embedded objects: hyperlinks, images, and tables.</span></span> <span data-ttu-id="2fa75-222">在下列範例中，左大括弧 ( {) 表示文字範圍的起始端點，右邊的大括弧 (} ) 代表結束端點。</span><span class="sxs-lookup"><span data-stu-id="2fa75-222">In the following examples, the left brace ({) represents the Start endpoint of the text range, and the right brace (}) represents the End endpoint.</span></span>

### <a name="hyperlink-example-1-a-text-range-that-contains-an-embedded-text-hyperlink"></a><span data-ttu-id="2fa75-223">HyperLink 範例1：包含內嵌文字超連結的文字範圍</span><span class="sxs-lookup"><span data-stu-id="2fa75-223">HyperLink Example 1: A text range that contains an embedded text hyperlink</span></span>

<span data-ttu-id="2fa75-224">下列文字範圍包含內嵌文字超連結。</span><span class="sxs-lookup"><span data-stu-id="2fa75-224">The following text range contains an embedded text hyperlink.</span></span>

  <span data-ttu-id="2fa75-225">{URL https://www.microsoft.com 內嵌在文字中}。</span><span class="sxs-lookup"><span data-stu-id="2fa75-225">{The URL https://www.microsoft.com is embedded in text}.</span></span>

<span data-ttu-id="2fa75-226">呼叫 [**IUIAutomationTextRange：： GetText**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-gettext)、 [**GetEnclosingElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-getenclosingelement)、 [**GetChildren**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-getchildren)和 [**IUIAutomationTextPattern：： RangeFromChild**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextpattern-rangefromchild) 方法會產生下表所述的行為。</span><span class="sxs-lookup"><span data-stu-id="2fa75-226">Calling the [**IUIAutomationTextRange::GetText**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-gettext), [**GetEnclosingElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-getenclosingelement), [**GetChildren**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-getchildren), and [**IUIAutomationTextPattern::RangeFromChild**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextpattern-rangefromchild) methods results in the behaviors described in the following table.</span></span>

| <span data-ttu-id="2fa75-227">呼叫的方法</span><span class="sxs-lookup"><span data-stu-id="2fa75-227">Method called</span></span>                                                                                                                                                                                                                                                     | <span data-ttu-id="2fa75-228">結果</span><span class="sxs-lookup"><span data-stu-id="2fa75-228">Result</span></span>                                                                                                                                                   |
|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="2fa75-229">**IUIAutomationTextRange：： GetText**</span><span class="sxs-lookup"><span data-stu-id="2fa75-229">**IUIAutomationTextRange::GetText**</span></span>](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-gettext)                                                                                                                                                                                  | <span data-ttu-id="2fa75-230">傳回字串「URL https://www.microsoft.com 內嵌在文字中」。</span><span class="sxs-lookup"><span data-stu-id="2fa75-230">Returns the string "The URL https://www.microsoft.com is embedded in text".</span></span>                                                                               |
| [<span data-ttu-id="2fa75-231">**IUIAutomationTextRange::GetEnclosingElement**</span><span class="sxs-lookup"><span data-stu-id="2fa75-231">**IUIAutomationTextRange::GetEnclosingElement**</span></span>](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-getenclosingelement)                                                                                                                                                          | <span data-ttu-id="2fa75-232">傳回包含文字範圍的最內層消費者介面自動化專案，在此案例中，表示文字提供者本身的 Automation 元素。</span><span class="sxs-lookup"><span data-stu-id="2fa75-232">Returns the innermost UI Automation element that encloses the text range, in this case, the automation element that represents the text provider itself.</span></span> |
| [<span data-ttu-id="2fa75-233">**IUIAutomationTextRange：： GetChildren**</span><span class="sxs-lookup"><span data-stu-id="2fa75-233">**IUIAutomationTextRange::GetChildren**</span></span>](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-getchildren)                                                                                                                                                                          | <span data-ttu-id="2fa75-234">傳回代表超連結控制項的消費者介面自動化元素。</span><span class="sxs-lookup"><span data-stu-id="2fa75-234">Returns a UI Automation element representing the hyperlink control.</span></span>                                                                                      |
| <span data-ttu-id="2fa75-235">[**IUIAutomationTextPattern：： RangeFromChild**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextpattern-rangefromchild)，其中消費者介面自動化元素是由先前的 [**IUIAutomationTextRange：： GetChildren**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-getchildren) 方法所傳回。</span><span class="sxs-lookup"><span data-stu-id="2fa75-235">[**IUIAutomationTextPattern::RangeFromChild**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextpattern-rangefromchild), where the UI Automation element was returned by the previous [**IUIAutomationTextRange::GetChildren**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-getchildren) method.</span></span> | <span data-ttu-id="2fa75-236">傳回表示 "" 的範圍 https://www.microsoft.com 。</span><span class="sxs-lookup"><span data-stu-id="2fa75-236">Returns the range that represents "https://www.microsoft.com".</span></span>                                                                                            |
### <a name="hyperlink-example-2-a-text-range-that-partially-spans-an-embedded-text-hyperlink"></a><span data-ttu-id="2fa75-237">HyperLink 範例2：部分跨越內嵌文字超連結的文字範圍</span><span class="sxs-lookup"><span data-stu-id="2fa75-237">HyperLink Example 2: A text range that partially spans an embedded text hyperlink</span></span>

<span data-ttu-id="2fa75-238">下列文字範圍部分跨越內嵌文字超連結。</span><span class="sxs-lookup"><span data-stu-id="2fa75-238">The following text range partially spans an embedded text hyperlink.</span></span>

  <span data-ttu-id="2fa75-239">URL HTTPs：//{www} 內嵌于文字中。</span><span class="sxs-lookup"><span data-stu-id="2fa75-239">The URL https://{www} is embedded in text.</span></span>

<span data-ttu-id="2fa75-240">呼叫 [**IUIAutomationTextRange：： GetText**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-gettext)、 [**GetEnclosingElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-getenclosingelement)和 [**GetChildren**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-getchildren) 方法會產生下表所述的行為。</span><span class="sxs-lookup"><span data-stu-id="2fa75-240">Calling the [**IUIAutomationTextRange::GetText**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-gettext), [**GetEnclosingElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-getenclosingelement), and [**GetChildren**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-getchildren) methods results in the behaviors described in the following table.</span></span>

| <span data-ttu-id="2fa75-241">呼叫的方法</span><span class="sxs-lookup"><span data-stu-id="2fa75-241">Method called</span></span>                                                                                            | <span data-ttu-id="2fa75-242">結果</span><span class="sxs-lookup"><span data-stu-id="2fa75-242">Result</span></span>                                                                                                         |
|----------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="2fa75-243">**IUIAutomationTextRange：： GetText**</span><span class="sxs-lookup"><span data-stu-id="2fa75-243">**IUIAutomationTextRange::GetText**</span></span>](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-gettext)                         | <span data-ttu-id="2fa75-244">傳回字串 "www"。</span><span class="sxs-lookup"><span data-stu-id="2fa75-244">Returns the string "www".</span></span>                                                                                      |
| [<span data-ttu-id="2fa75-245">**IUIAutomationTextRange::GetEnclosingElement**</span><span class="sxs-lookup"><span data-stu-id="2fa75-245">**IUIAutomationTextRange::GetEnclosingElement**</span></span>](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-getenclosingelement) | <span data-ttu-id="2fa75-246">傳回括住文字範圍的最內層消費者介面自動化元素;在此案例中為超連結控制項。</span><span class="sxs-lookup"><span data-stu-id="2fa75-246">Returns the innermost UI Automation element that encloses the text range; in this case, the hyperlink control.</span></span> |
| [<span data-ttu-id="2fa75-247">**IUIAutomationTextRange：： GetChildren**</span><span class="sxs-lookup"><span data-stu-id="2fa75-247">**IUIAutomationTextRange::GetChildren**</span></span>](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-getchildren)                 | <span data-ttu-id="2fa75-248">會傳回 **Null** ，因為文字範圍不會跨越整個 URL 字串。</span><span class="sxs-lookup"><span data-stu-id="2fa75-248">Returns **NULL** because the text range does not span the entire URL string.</span></span>                                   |

### <a name="hyperlink-example-3-a-text-range-that-partially-spans-the-content-of-a-text-container"></a><span data-ttu-id="2fa75-249">超連結範例3：部分跨越文字容器內容的文字範圍</span><span class="sxs-lookup"><span data-stu-id="2fa75-249">HyperLink Example 3: A text range that partially spans the content of a text container</span></span>

<span data-ttu-id="2fa75-250">下列文字範圍部分跨越文字容器的內容。</span><span class="sxs-lookup"><span data-stu-id="2fa75-250">The following text range partially spans the content of a text container.</span></span> <span data-ttu-id="2fa75-251">此文字容器有不屬於此文字範圍的內嵌文字超連結。</span><span class="sxs-lookup"><span data-stu-id="2fa75-251">The text container has an embedded text hyperlink that is not part of the text range.</span></span>

  <span data-ttu-id="2fa75-252">{URL} https://www.microsoft.com 內嵌于文字中。</span><span class="sxs-lookup"><span data-stu-id="2fa75-252">{The URL} https://www.microsoft.com is embedded in text.</span></span>

<span data-ttu-id="2fa75-253">呼叫 [**IUIAutomationTextRange：： GetText**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-gettext)、 [**GetEnclosingElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-getenclosingelement)和 [**Move**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-move) 方法會產生下表所述的行為。</span><span class="sxs-lookup"><span data-stu-id="2fa75-253">Calling the [**IUIAutomationTextRange::GetText**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-gettext), [**GetEnclosingElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-getenclosingelement), and [**Move**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-move) methods results in the behaviors described in the following table.</span></span>

| <span data-ttu-id="2fa75-254">呼叫的方法</span><span class="sxs-lookup"><span data-stu-id="2fa75-254">Method called</span></span>                                                                                            | <span data-ttu-id="2fa75-255">結果</span><span class="sxs-lookup"><span data-stu-id="2fa75-255">Result</span></span>                                                                                                                                                                                                                            |
|----------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="2fa75-256">**IUIAutomationTextRange：： GetText**</span><span class="sxs-lookup"><span data-stu-id="2fa75-256">**IUIAutomationTextRange::GetText**</span></span>](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-gettext)                         | <span data-ttu-id="2fa75-257">傳回字串 "The URL"。</span><span class="sxs-lookup"><span data-stu-id="2fa75-257">Returns the string "The URL".</span></span>                                                                                                                                                                                                     |
| [<span data-ttu-id="2fa75-258">**IUIAutomationTextRange::GetEnclosingElement**</span><span class="sxs-lookup"><span data-stu-id="2fa75-258">**IUIAutomationTextRange::GetEnclosingElement**</span></span>](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-getenclosingelement) | <span data-ttu-id="2fa75-259">傳回括住文字範圍的最內層消費者介面自動化專案，在此案例中為代表文字提供者本身的元素。</span><span class="sxs-lookup"><span data-stu-id="2fa75-259">Returns the innermost UI Automation element that encloses the text range, in this case, the element that represents the text provider itself.</span></span>                                                                                     |
| [<span data-ttu-id="2fa75-260">**IUIAutomationTextRange：： Move**</span><span class="sxs-lookup"><span data-stu-id="2fa75-260">**IUIAutomationTextRange::Move**</span></span>](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-move)                               | <span data-ttu-id="2fa75-261">將文字範圍範圍移至 "HTTPs://"，因為超連結的文字是由個別單字所組成。</span><span class="sxs-lookup"><span data-stu-id="2fa75-261">Moves the text range span to "https://" because the text of the hyperlink is made up of individual words.</span></span> <span data-ttu-id="2fa75-262">在此情況下，並未將超連結視為單一物件。</span><span class="sxs-lookup"><span data-stu-id="2fa75-262">In this case, the hyperlink is not treated as a single object.</span></span><br/> <span data-ttu-id="2fa75-263">The URL {http} is embedded in text.</span><span class="sxs-lookup"><span data-stu-id="2fa75-263">The URL {http} is embedded in text.</span></span><br/> |

### <a name="image-example-1-a-text-range-that-contains-an-embedded-image"></a><span data-ttu-id="2fa75-264">影像範例1：包含內嵌影像的文字範圍</span><span class="sxs-lookup"><span data-stu-id="2fa75-264">Image Example 1: A text range that contains an embedded image</span></span>

<span data-ttu-id="2fa75-265">下列文字範圍包含往復的內嵌影像。</span><span class="sxs-lookup"><span data-stu-id="2fa75-265">The following text range contains an embedded image of a shuttle.</span></span>

 <span data-ttu-id="2fa75-266">{影像</span><span class="sxs-lookup"><span data-stu-id="2fa75-266">{The image</span></span> ![快速導航圖](images/shuttle.jpg) <span data-ttu-id="2fa75-268">內嵌于文字} 中。</span><span class="sxs-lookup"><span data-stu-id="2fa75-268">is embedded in text}.</span></span>

<span data-ttu-id="2fa75-269">呼叫 [**IUIAutomationTextRange：： GetText**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-gettext)、 [**GetEnclosingElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-getenclosingelement)、 [**GetChildren**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-getchildren)和 [**IUIAutomationTextPattern：： RangeFromChild**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextpattern-rangefromchild) 方法會產生下表所述的行為。</span><span class="sxs-lookup"><span data-stu-id="2fa75-269">Calling the [**IUIAutomationTextRange::GetText**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-gettext), [**GetEnclosingElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-getenclosingelement), [**GetChildren**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-getchildren), and [**IUIAutomationTextPattern::RangeFromChild**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextpattern-rangefromchild) methods results in the behaviors described in the following table.</span></span>

| <span data-ttu-id="2fa75-270">呼叫的方法</span><span class="sxs-lookup"><span data-stu-id="2fa75-270">Method called</span></span>                                                                                                                                                                                                                                                    | <span data-ttu-id="2fa75-271">結果</span><span class="sxs-lookup"><span data-stu-id="2fa75-271">Result</span></span>                                                                                                                                        |
|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="2fa75-272">**IUIAutomationTextRange：： GetText**</span><span class="sxs-lookup"><span data-stu-id="2fa75-272">**IUIAutomationTextRange::GetText**</span></span>](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-gettext)                                                                                                                                                                                 | <span data-ttu-id="2fa75-273">傳回字串「影像內嵌在文字中」。</span><span class="sxs-lookup"><span data-stu-id="2fa75-273">Returns the string "The image is embedded in text".</span></span> <span data-ttu-id="2fa75-274">任何與影像相關聯的替代文字都不會包含在文字資料流程中。</span><span class="sxs-lookup"><span data-stu-id="2fa75-274">Any ALT text associated with the image is not included in the text stream.</span></span>                |
| [<span data-ttu-id="2fa75-275">**IUIAutomationTextRange::GetEnclosingElement**</span><span class="sxs-lookup"><span data-stu-id="2fa75-275">**IUIAutomationTextRange::GetEnclosingElement**</span></span>](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-getenclosingelement)                                                                                                                                                         | <span data-ttu-id="2fa75-276">傳回括住文字範圍的最內層消費者介面自動化專案，在此案例中為代表文字提供者本身的元素。</span><span class="sxs-lookup"><span data-stu-id="2fa75-276">Returns the innermost UI Automation element that encloses the text range, in this case, the element that represents the text provider itself.</span></span> |
| [<span data-ttu-id="2fa75-277">**IUIAutomationTextRange：： GetChildren**</span><span class="sxs-lookup"><span data-stu-id="2fa75-277">**IUIAutomationTextRange::GetChildren**</span></span>](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-getchildren)                                                                                                                                                                         | <span data-ttu-id="2fa75-278">傳回代表影像控制項的消費者介面自動化元素。</span><span class="sxs-lookup"><span data-stu-id="2fa75-278">Returns a UI Automation element representing the image control.</span></span>                                                                               |
| <span data-ttu-id="2fa75-279">[**IUIAutomationTextPattern：： RangeFromChild**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextpattern-rangefromchild) ，其中消費者介面自動化元素是由先前的 [**IUIAutomationTextRange：： GetChildren**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-getchildren) 方法所傳回。</span><span class="sxs-lookup"><span data-stu-id="2fa75-279">[**IUIAutomationTextPattern::RangeFromChild**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextpattern-rangefromchild) where the UI Automation element was returned by the previous [**IUIAutomationTextRange::GetChildren**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-getchildren) method.</span></span> | <span data-ttu-id="2fa75-280">傳回退化範圍。</span><span class="sxs-lookup"><span data-stu-id="2fa75-280">Returns the degenerate range.</span></span>                                                                                                                 |

### <a name="image-example-2-a-text-range-that-partially-spans-the-content-of-a-text-container"></a><span data-ttu-id="2fa75-281">影像範例2：部分跨越文字容器內容的文字範圍</span><span class="sxs-lookup"><span data-stu-id="2fa75-281">Image Example 2: A text range that partially spans the content of a text container</span></span>

<span data-ttu-id="2fa75-282">下列文字範圍部分跨越文字容器的內容。</span><span class="sxs-lookup"><span data-stu-id="2fa75-282">The following text range partially spans the content of a text container.</span></span> <span data-ttu-id="2fa75-283">此文字容器有不屬於此文字範圍的內嵌影像。</span><span class="sxs-lookup"><span data-stu-id="2fa75-283">The text container has an embedded image that is not part of the text range.</span></span>

 <span data-ttu-id="2fa75-284">{映射}</span><span class="sxs-lookup"><span data-stu-id="2fa75-284">{The image}</span></span> ![快速導航圖](images/shuttle.jpg) <span data-ttu-id="2fa75-286">內嵌于文字中。</span><span class="sxs-lookup"><span data-stu-id="2fa75-286">is embedded in text.</span></span>

<span data-ttu-id="2fa75-287">呼叫 [**IUIAutomationTextRange：： GetText**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-gettext)、 [**GetEnclosingElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-getenclosingelement)和 [**Move**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-move) 方法會產生下表所述的行為。</span><span class="sxs-lookup"><span data-stu-id="2fa75-287">Calling the [**IUIAutomationTextRange::GetText**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-gettext), [**GetEnclosingElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-getenclosingelement), and [**Move**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-move) methods results in the behaviors described in the following table.</span></span>

| <span data-ttu-id="2fa75-288">呼叫的方法</span><span class="sxs-lookup"><span data-stu-id="2fa75-288">Method called</span></span>                                                                                                          | <span data-ttu-id="2fa75-289">結果</span><span class="sxs-lookup"><span data-stu-id="2fa75-289">Result</span></span>                                                                                                                                                                                                                                                                          |
|------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="2fa75-290">**IUIAutomationTextRange：： GetText**</span><span class="sxs-lookup"><span data-stu-id="2fa75-290">**IUIAutomationTextRange::GetText**</span></span>](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-gettext)                                       | <span data-ttu-id="2fa75-291">傳回字串 "The image"。</span><span class="sxs-lookup"><span data-stu-id="2fa75-291">Returns the string "The image".</span></span>                                                                                                                                                                                                                                                 |
| [<span data-ttu-id="2fa75-292">**IUIAutomationTextRange::GetEnclosingElement**</span><span class="sxs-lookup"><span data-stu-id="2fa75-292">**IUIAutomationTextRange::GetEnclosingElement**</span></span>](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-getenclosingelement)               | <span data-ttu-id="2fa75-293">傳回括住文字範圍的最內層消費者介面自動化專案，在此案例中為代表文字提供者本身的元素。</span><span class="sxs-lookup"><span data-stu-id="2fa75-293">Returns the innermost UI Automation element that encloses the text range, in this case, the element that represents the text provider itself.</span></span>                                                                                                                                   |
| <span data-ttu-id="2fa75-294">[**IUIAutomationTextRange：： Move**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-move) (**TextUnit \_ Word**，2) 的參數。</span><span class="sxs-lookup"><span data-stu-id="2fa75-294">[**IUIAutomationTextRange::Move**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-move) with parameters of (**TextUnit\_Word**, 2).</span></span> | <span data-ttu-id="2fa75-295">將文字範圍移至 "is"。</span><span class="sxs-lookup"><span data-stu-id="2fa75-295">Moves the text range span to "is ".</span></span> <span data-ttu-id="2fa75-296">因為只有以文字為基礎的內嵌物件會被視為文字資料流程的一部分，所以此範例中的影像並不會影響 [**IUIAutomationTextRange：： Move**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-move) 或其傳回值，在此情況下為2。</span><span class="sxs-lookup"><span data-stu-id="2fa75-296">Because only text-based embedded objects are considered part of the text stream, the image in this example does not affect [**IUIAutomationTextRange::Move**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-move) or its return value, in this case, 2.</span></span> |

### <a name="table"></a><span data-ttu-id="2fa75-297">資料表</span><span class="sxs-lookup"><span data-stu-id="2fa75-297">Table</span></span>

### <a name="table-example-1-gets-the-text-container-from-the-content-of-a-cell"></a><span data-ttu-id="2fa75-298">表格範例1：從儲存格內容取得文字容器</span><span class="sxs-lookup"><span data-stu-id="2fa75-298">Table Example 1: Gets the text container from the content of a cell</span></span>

<span data-ttu-id="2fa75-299">下表從儲存格內容取得文字容器。</span><span class="sxs-lookup"><span data-stu-id="2fa75-299">The following table gets the text container from the content of a cell.</span></span>

| <span data-ttu-id="2fa75-300">包含影像的儲存格</span><span class="sxs-lookup"><span data-stu-id="2fa75-300">Cell with Image</span></span>                                            | <span data-ttu-id="2fa75-301">包含文字的儲存格</span><span class="sxs-lookup"><span data-stu-id="2fa75-301">Cell with Text</span></span> |
|------------------------------------------------------------|----------------|
| ![快速導航圖](images/shuttle.jpg)           | <span data-ttu-id="2fa75-303">X</span><span class="sxs-lookup"><span data-stu-id="2fa75-303">X</span></span>              |
| ![空間和望遠鏡的圖解](images/space.jpg) | <span data-ttu-id="2fa75-305">Y</span><span class="sxs-lookup"><span data-stu-id="2fa75-305">Y</span></span>              |
| ![microscope 的圖例](images/microscope.jpg)     | <span data-ttu-id="2fa75-307">Z</span><span class="sxs-lookup"><span data-stu-id="2fa75-307">Z</span></span>              |

<span data-ttu-id="2fa75-308">呼叫 [**IUIAutomationGridPattern：： GetItem**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationgridpattern-getitem)、 [**IUIAutomationTextPattern：： RangeFromChild**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextpattern-rangefromchild)和 [**IUIAutomationTextRange：： GetEnclosingElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-getenclosingelement) 方法會產生下表所述的行為。</span><span class="sxs-lookup"><span data-stu-id="2fa75-308">Calling the [**IUIAutomationGridPattern::GetItem**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationgridpattern-getitem), [**IUIAutomationTextPattern::RangeFromChild**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextpattern-rangefromchild), and [**IUIAutomationTextRange::GetEnclosingElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-getenclosingelement) methods results in the behaviors described in the following table.</span></span>

| <span data-ttu-id="2fa75-309">呼叫的方法</span><span class="sxs-lookup"><span data-stu-id="2fa75-309">Method called</span></span>                                                                                                                                                                                                                       | <span data-ttu-id="2fa75-310">結果</span><span class="sxs-lookup"><span data-stu-id="2fa75-310">Result</span></span>                                                                                                                                                                                      |
|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="2fa75-311">[**IUIAutomationGridPattern：： GetItem**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationgridpattern-getitem) 參數 (0，0) 。</span><span class="sxs-lookup"><span data-stu-id="2fa75-311">[**IUIAutomationGridPattern::GetItem**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationgridpattern-getitem) with parameters (0, 0).</span></span>                                                                                                                        | <span data-ttu-id="2fa75-312">傳回代表資料表單元格內容的消費者介面自動化專案，在此案例中，元素是文字控制項。</span><span class="sxs-lookup"><span data-stu-id="2fa75-312">Returns the UI Automation element that represents the content of the table cell, in this case, the element is a text control.</span></span>                                                               |
| [<span data-ttu-id="2fa75-313">**iuiautomatioNtextpattern::rangefromchild**</span><span class="sxs-lookup"><span data-stu-id="2fa75-313">**iuiautomationtextpattern::rangefromchild**</span></span>](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextpattern-rangefromchild)                                                                                                                                  | <span data-ttu-id="2fa75-314">傳回影像的範圍。</span><span class="sxs-lookup"><span data-stu-id="2fa75-314">returns the range of the image</span></span> ![快速導航圖](images/shuttle.jpg)<span data-ttu-id="2fa75-316">.</span><span class="sxs-lookup"><span data-stu-id="2fa75-316">.</span></span>                                                                                                            |
| <span data-ttu-id="2fa75-317">[**GetEnclosingElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-getenclosingelement) ，用於先前的 [**IUIAutomationTextPattern：： RangeFromChild**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextpattern-rangefromchild) 方法所傳回的物件。</span><span class="sxs-lookup"><span data-stu-id="2fa75-317">[**GetEnclosingElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-getenclosingelement) for the object returned by the previous [**IUIAutomationTextPattern::RangeFromChild**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextpattern-rangefromchild) method.</span></span> | <span data-ttu-id="2fa75-318">傳回代表資料表單元格的消費者介面自動化元素。</span><span class="sxs-lookup"><span data-stu-id="2fa75-318">Returns the UI Automation element representing the table cell.</span></span> <span data-ttu-id="2fa75-319">在此情況下，元素是支援 [TableItem](uiauto-implementingtableitem.md) 控制項模式的文字控制項。</span><span class="sxs-lookup"><span data-stu-id="2fa75-319">In this case, the element is a text control that supports the [TableItem](uiauto-implementingtableitem.md) control pattern.</span></span> |
| <span data-ttu-id="2fa75-320">[**IUIAutomationTextRange：： GetEnclosingElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-getenclosingelement) ，適用于前一個 **GetEnclosingElement** 方法所傳回的物件。</span><span class="sxs-lookup"><span data-stu-id="2fa75-320">[**IUIAutomationTextRange::GetEnclosingElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-getenclosingelement) for the object returned by the previous **GetEnclosingElement** method.</span></span>                                                    | <span data-ttu-id="2fa75-321">傳回代表資料表的消費者介面自動化元素。</span><span class="sxs-lookup"><span data-stu-id="2fa75-321">Returns the UI Automation element representing the table.</span></span>                                                                                                                                   |
| <span data-ttu-id="2fa75-322">[**IUIAutomationTextRange：： GetEnclosingElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-getenclosingelement) ，適用于前一個 **GetEnclosingElement** 方法所傳回的物件。</span><span class="sxs-lookup"><span data-stu-id="2fa75-322">[**IUIAutomationTextRange::GetEnclosingElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-getenclosingelement) for the object returned by the previous **GetEnclosingElement** method.</span></span>                                                    | <span data-ttu-id="2fa75-323">傳回表示文字提供者本身的消費者介面自動化元素。</span><span class="sxs-lookup"><span data-stu-id="2fa75-323">Returns the UI Automation element that represents the text provider itself.</span></span>                                                                                                                 |

### <a name="table-example-2-gets-the-text-content-of-a-cell"></a><span data-ttu-id="2fa75-324">資料表範例2：取得儲存格的文字內容</span><span class="sxs-lookup"><span data-stu-id="2fa75-324">Table Example 2: Gets the text content of a cell</span></span>

<span data-ttu-id="2fa75-325">上述範例中的資料表會取得儲存格的文字內容。</span><span class="sxs-lookup"><span data-stu-id="2fa75-325">The table in the preceding example gets the text content of a cell.</span></span>

<span data-ttu-id="2fa75-326">呼叫 [**IUIAutomationGridPattern：： GetItem**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationgridpattern-getitem) 和 [**IUIAutomationTextPattern：： RangeFromChild**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextpattern-rangefromchild) 方法會產生下表所述的行為。</span><span class="sxs-lookup"><span data-stu-id="2fa75-326">Calling the [**IUIAutomationGridPattern::GetItem**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationgridpattern-getitem) and [**IUIAutomationTextPattern::RangeFromChild**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextpattern-rangefromchild) methods results in the behaviors described in the following table.</span></span>

| <span data-ttu-id="2fa75-327">呼叫的方法</span><span class="sxs-lookup"><span data-stu-id="2fa75-327">Method called</span></span>                                                                                                                                                                                                                                                          | <span data-ttu-id="2fa75-328">結果</span><span class="sxs-lookup"><span data-stu-id="2fa75-328">Result</span></span>                                                                                                                     |
|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="2fa75-329">[**IUIAutomationGridPattern：： GetItem**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationgridpattern-getitem) 與參數 (1，1) 。</span><span class="sxs-lookup"><span data-stu-id="2fa75-329">[**IUIAutomationGridPattern::GetItem**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationgridpattern-getitem) with parameters (1,1).</span></span>                                                                                                                                                            | <span data-ttu-id="2fa75-330">傳回代表資料表單元格內容的消費者介面自動化元素。</span><span class="sxs-lookup"><span data-stu-id="2fa75-330">Returns the UI Automation element representing the content of the table cell.</span></span> <span data-ttu-id="2fa75-331">在此情況下，元素是文字控制項。</span><span class="sxs-lookup"><span data-stu-id="2fa75-331">In this case, the element is a text control.</span></span> |
| <span data-ttu-id="2fa75-332">[**IUIAutomationTextPattern：： RangeFromChild**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextpattern-rangefromchild) ，其中消費者介面自動化專案是前一個 [**IUIAutomationGridPattern：： GetItem**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationgridpattern-getitem) 方法所傳回的物件。</span><span class="sxs-lookup"><span data-stu-id="2fa75-332">[**IUIAutomationTextPattern::RangeFromChild**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextpattern-rangefromchild) where the UI Automation element is the object returned by the previous [**IUIAutomationGridPattern::GetItem**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationgridpattern-getitem) method.</span></span> | <span data-ttu-id="2fa75-333">傳回 "Y"。</span><span class="sxs-lookup"><span data-stu-id="2fa75-333">Returns "Y".</span></span>                                                                                                               |

<span data-ttu-id="2fa75-334">當您透過 [**TextUnit \_ 線**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit)移動檔時，如果文字範圍輸入了內嵌的表格，則資料格中的每一行文字都應該視為線條。</span><span class="sxs-lookup"><span data-stu-id="2fa75-334">When moving through a document by [**TextUnit\_Line**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit), if the text range enters an embedded table, each line of text in a cell should be treated as a line.</span></span>

## <a name="related-topics"></a><span data-ttu-id="2fa75-335">相關主題</span><span class="sxs-lookup"><span data-stu-id="2fa75-335">Related topics</span></span>

### <a name="conceptual"></a><span data-ttu-id="2fa75-336">概念</span><span class="sxs-lookup"><span data-stu-id="2fa75-336">Conceptual</span></span>

- [<span data-ttu-id="2fa75-337">關於 Text 和 TextRange 控制項模式</span><span class="sxs-lookup"><span data-stu-id="2fa75-337">About the Text and TextRange Control Patterns</span></span>](uiauto-about-text-and-textrange-patterns.md)
- [<span data-ttu-id="2fa75-338">消費者介面自動化 Text 屬性</span><span class="sxs-lookup"><span data-stu-id="2fa75-338">UI Automation Text Attributes</span></span>](uiauto-textattributes.md)
- [<span data-ttu-id="2fa75-339">UI 自動化控制項模式概觀</span><span class="sxs-lookup"><span data-stu-id="2fa75-339">UI Automation Control Patterns Overview</span></span>](uiauto-controlpatternsoverview.md)
- [<span data-ttu-id="2fa75-340">消費者介面自動化文字內容的支援</span><span class="sxs-lookup"><span data-stu-id="2fa75-340">UI Automation Support for Textual Content</span></span>](uiauto-ui-automation-textpattern-overview.md)