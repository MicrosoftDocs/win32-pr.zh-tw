---
title: '樹狀檢視控制項 (MSAA UI 元素參考) '
description: 樹狀檢視控制項會使用線條來連接階層中的相關專案，以顯示專案的階層式清單。 每個專案都包含一個標籤和一個選擇性點陣圖。 Windows 檔案總管使用樹狀檢視控制項來顯示目錄。
ms.assetid: 5b104a77-71e5-4555-acde-1e63ac7ea5c1
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 0781f5cb20038fb0b23d816153ab59411bf93dc7
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 09/16/2019
ms.locfileid: "104021408"
---
# <a name="tree-view-control-msaa-ui-element-reference"></a><span data-ttu-id="ca13c-105">樹狀檢視控制項 (MSAA UI 元素參考) </span><span class="sxs-lookup"><span data-stu-id="ca13c-105">Tree View Control (MSAA UI Element Reference)</span></span>

> [!Note]  
> <span data-ttu-id="ca13c-106">本主題描述用於 MSAA UI 專案參考之 **樹狀檢視控制項** 物件的用途。</span><span class="sxs-lookup"><span data-stu-id="ca13c-106">This topic describes **Tree View Control** objects for purposes of MSAA UI Element Reference.</span></span> <span data-ttu-id="ca13c-107">此處未說明如何在各種 UI 架構中建立 **樹狀檢視控制項** 物件。</span><span class="sxs-lookup"><span data-stu-id="ca13c-107">How to create **Tree View Control** objects in various UI frameworks is not described here.</span></span> <span data-ttu-id="ca13c-108">請參閱您所使用之 UI 架構的 API 參考檔。</span><span class="sxs-lookup"><span data-stu-id="ca13c-108">See the API reference documentation for the UI framework you're using.</span></span>

 

<span data-ttu-id="ca13c-109">樹狀檢視控制項會使用線條來連接階層中的相關專案，以顯示專案的階層式清單。</span><span class="sxs-lookup"><span data-stu-id="ca13c-109">A tree view control displays a hierarchical list of items using lines to connect related items in a hierarchy.</span></span> <span data-ttu-id="ca13c-110">每個專案都包含一個標籤和一個選擇性點陣圖。</span><span class="sxs-lookup"><span data-stu-id="ca13c-110">Each item consists of a label and an optional bitmap.</span></span> <span data-ttu-id="ca13c-111">Windows 檔案總管使用樹狀檢視控制項來顯示目錄。</span><span class="sxs-lookup"><span data-stu-id="ca13c-111">Windows Explorer uses a tree view control to display directories.</span></span>

<span data-ttu-id="ca13c-112">樹狀檢視控制項的視窗類別名稱是 WC \_ TREEVIEW，在 Commctrl 中定義為 "SysTreeView"。</span><span class="sxs-lookup"><span data-stu-id="ca13c-112">The window class name for a tree view control is WC\_TREEVIEW, which is defined as "SysTreeView" in Commctrl.h.</span></span>

## <a name="iaccessible-methods"></a><span data-ttu-id="ca13c-113">IAccessible 方法</span><span class="sxs-lookup"><span data-stu-id="ca13c-113">IAccessible Methods</span></span>

<span data-ttu-id="ca13c-114">樹狀檢視控制項支援下列 [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) 方法：</span><span class="sxs-lookup"><span data-stu-id="ca13c-114">A tree view control supports the following [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) methods:</span></span>



| <span data-ttu-id="ca13c-115">方法</span><span class="sxs-lookup"><span data-stu-id="ca13c-115">Method</span></span>                                                                    | <span data-ttu-id="ca13c-116">註解</span><span class="sxs-lookup"><span data-stu-id="ca13c-116">Comments</span></span>                                                                                                                                                                                                                                                              |
|---------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="ca13c-117">**accDoDefaultAction**</span><span class="sxs-lookup"><span data-stu-id="ca13c-117">**accDoDefaultAction**</span></span>](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-accdodefaultaction) | <span data-ttu-id="ca13c-118">樹狀檢視物件本身沒有 [**accDoDefaultAction**](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-accdodefaultaction) 方法。</span><span class="sxs-lookup"><span data-stu-id="ca13c-118">The tree view object itself does not have a [**accDoDefaultAction**](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-accdodefaultaction) method.</span></span> <span data-ttu-id="ca13c-119">根據樹狀檢視中專案的 [ **狀態** ] 屬性， **accDoDefaultAction** 會展開或折迭指定的專案。</span><span class="sxs-lookup"><span data-stu-id="ca13c-119">Depending on the **State** property of an item in the tree view, **accDoDefaultAction** either expands or collapses the specified item.</span></span> |
| [<span data-ttu-id="ca13c-120">**accHitTest**</span><span class="sxs-lookup"><span data-stu-id="ca13c-120">**accHitTest**</span></span>](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-acchittest)                 |                                                                                                                                                                                                                                                                       |
| [<span data-ttu-id="ca13c-121">**accLocation**</span><span class="sxs-lookup"><span data-stu-id="ca13c-121">**accLocation**</span></span>](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-acclocation)               |                                                                                                                                                                                                                                                                       |
| [<span data-ttu-id="ca13c-122">**accNavigate**</span><span class="sxs-lookup"><span data-stu-id="ca13c-122">**accNavigate**</span></span>](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-accnavigate)               |                                                                                                                                                                                                                                                                       |
| [<span data-ttu-id="ca13c-123">**accSelect**</span><span class="sxs-lookup"><span data-stu-id="ca13c-123">**accSelect**</span></span>](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-accselect)                   |                                                                                                                                                                                                                                                                       |



 

## <a name="iaccessible-properties"></a><span data-ttu-id="ca13c-124">IAccessible 屬性</span><span class="sxs-lookup"><span data-stu-id="ca13c-124">IAccessible Properties</span></span>

<span data-ttu-id="ca13c-125">樹狀檢視控制項支援下列 [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) 屬性：</span><span class="sxs-lookup"><span data-stu-id="ca13c-125">A tree view control supports the following [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) properties:</span></span>



| <span data-ttu-id="ca13c-126">屬性</span><span class="sxs-lookup"><span data-stu-id="ca13c-126">Property</span></span>                                                                             | <span data-ttu-id="ca13c-127">註解</span><span class="sxs-lookup"><span data-stu-id="ca13c-127">Comments</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|--------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="ca13c-128">**取得 \_ accChild**</span><span class="sxs-lookup"><span data-stu-id="ca13c-128">**get\_accChild**</span></span>](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_accchild)                       |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| [<span data-ttu-id="ca13c-129">**取得 \_ accChildCount**</span><span class="sxs-lookup"><span data-stu-id="ca13c-129">**get\_accChildCount**</span></span>](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_accchildcount)             | <span data-ttu-id="ca13c-130">樹狀檢視物件的 **ChildCount** 屬性是樹狀檢視中所包含的專案數目。</span><span class="sxs-lookup"><span data-stu-id="ca13c-130">The **ChildCount** property for the tree view object is the number of items contained in the tree view.</span></span> <span data-ttu-id="ca13c-131">每個樹狀檢視專案的 **ChildCount** 屬性都是零。</span><span class="sxs-lookup"><span data-stu-id="ca13c-131">The **ChildCount** property for each tree view item is zero.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| [<span data-ttu-id="ca13c-132">**取得 \_ accDefaultAction**</span><span class="sxs-lookup"><span data-stu-id="ca13c-132">**get\_accDefaultAction**</span></span>](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_accdefaultaction)       | <span data-ttu-id="ca13c-133">樹狀檢視物件本身沒有 **DefaultAction** 屬性。</span><span class="sxs-lookup"><span data-stu-id="ca13c-133">The tree view object itself does not have a **DefaultAction** property.</span></span> <span data-ttu-id="ca13c-134">樹狀檢視中展開的專案會以 "Collapse" 作為其 **DefaultAction** 屬性，而且未展開的專案會將 "Expand" 作為其 **DefaultAction** 屬性。</span><span class="sxs-lookup"><span data-stu-id="ca13c-134">An item in the tree view that is expanded has "Collapse" as its **DefaultAction** property, and an item that is not expanded has "Expand" as its **DefaultAction** property.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| [<span data-ttu-id="ca13c-135">**取得 \_ accDescription**</span><span class="sxs-lookup"><span data-stu-id="ca13c-135">**get\_accDescription**</span></span>](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_accdescription)           |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| [<span data-ttu-id="ca13c-136">**取得 \_ accFocus**</span><span class="sxs-lookup"><span data-stu-id="ca13c-136">**get\_accFocus**</span></span>](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_accfocus)                       |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| [<span data-ttu-id="ca13c-137">**取得 \_ accHelp**</span><span class="sxs-lookup"><span data-stu-id="ca13c-137">**get\_accHelp**</span></span>](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_acchelp)                         |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| [<span data-ttu-id="ca13c-138">**取得 \_ accHelpTopic**</span><span class="sxs-lookup"><span data-stu-id="ca13c-138">**get\_accHelpTopic**</span></span>](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_acchelptopic)               |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| [<span data-ttu-id="ca13c-139">**取得 \_ accKeyboardShortcut**</span><span class="sxs-lookup"><span data-stu-id="ca13c-139">**get\_accKeyboardShortcut**</span></span>](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_acckeyboardshortcut) |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| [<span data-ttu-id="ca13c-140">**取得 \_ accName**</span><span class="sxs-lookup"><span data-stu-id="ca13c-140">**get\_accName**</span></span>](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_accname)                         | <span data-ttu-id="ca13c-141">樹狀檢視物件的 [ **名稱** ] 屬性是從控制項的視窗文字 (或標題) 取得。</span><span class="sxs-lookup"><span data-stu-id="ca13c-141">The **Name** property for the tree view object is obtained from the control's window text (or caption).</span></span> <span data-ttu-id="ca13c-142">此文字不會與樹狀檢視控制項一起顯示，因此伺服器開發人員必須在控制項的資源定義語句中提供有意義的文字，以協助用戶端公用程式的使用者識別控制項。</span><span class="sxs-lookup"><span data-stu-id="ca13c-142">This text is not displayed with the tree view control, so server developers must provide meaningful text in the control's resource definition statement to help users of client utilities to identify the control.</span></span> <span data-ttu-id="ca13c-143">樹狀檢視中專案的 [ **名稱** ] 屬性是顯示在樹狀檢視專案中的文字。</span><span class="sxs-lookup"><span data-stu-id="ca13c-143">The **Name** property for an item in the tree view is the text displayed in the tree view item.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| [<span data-ttu-id="ca13c-144">**取得 \_ accParent**</span><span class="sxs-lookup"><span data-stu-id="ca13c-144">**get\_accParent**</span></span>](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_accparent)                     | <span data-ttu-id="ca13c-145">樹狀檢視物件的 **父** 屬性是視窗 ( [**角色 \_ 系統 \_ 視窗**](object-roles.md) ) ，它會圍繞控制項，而且具有與控制項相同的 **名稱** 屬性和視窗類別名稱。</span><span class="sxs-lookup"><span data-stu-id="ca13c-145">The **Parent** property of the tree view object is a window ( [**ROLE\_SYSTEM\_WINDOW**](object-roles.md) ) that surrounds the control and has the same **Name** property and window class name as the control.</span></span> <span data-ttu-id="ca13c-146">樹狀檢視中每個專案的 **父** 屬性為樹狀檢視物件。</span><span class="sxs-lookup"><span data-stu-id="ca13c-146">The **Parent** property of each item in the tree view is the tree view object.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| [<span data-ttu-id="ca13c-147">**取得 \_ accRole**</span><span class="sxs-lookup"><span data-stu-id="ca13c-147">**get\_accRole**</span></span>](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_accrole)                         | <span data-ttu-id="ca13c-148">樹狀檢視物件具有 **角色** 屬性 [**角色 \_ 系統 \_ 大綱**](object-roles.md)。</span><span class="sxs-lookup"><span data-stu-id="ca13c-148">The tree view object has the **Role** property [**ROLE\_SYSTEM\_OUTLINE**](object-roles.md).</span></span> <span data-ttu-id="ca13c-149">樹狀檢視中的每個專案都有 **role** property [**role \_ SYSTEM \_ OUTLINEITEM**](object-roles.md)。</span><span class="sxs-lookup"><span data-stu-id="ca13c-149">Each item in the tree view has the **Role** property [**ROLE\_SYSTEM\_OUTLINEITEM**](object-roles.md).</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| [<span data-ttu-id="ca13c-150">**取得 \_ accSelection**</span><span class="sxs-lookup"><span data-stu-id="ca13c-150">**get\_accSelection**</span></span>](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_accselection)               |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| [<span data-ttu-id="ca13c-151">**取得 \_ accState**</span><span class="sxs-lookup"><span data-stu-id="ca13c-151">**get\_accState**</span></span>](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_accstate)                       | <span data-ttu-id="ca13c-152">樹狀檢視的 [**狀態**] 屬性是下列一或多個 [值](object-state-constants.md)的組合： [[**狀態 \_ 系統 \_ 不可見**](object-state-constants.md) \| [**狀態 \_ 系統 \_ 無法使用**](object-state-constants.md) \| [**狀態系統] \_ \_ 焦點**](object-state-constants.md) \| [**狀態 \_ 系統可 \_ 設定**](object-state-constants.md)的</span><span class="sxs-lookup"><span data-stu-id="ca13c-152">The **State** property for the tree view is a combination of one or more of the following [values](object-state-constants.md): [**STATE\_SYSTEM\_INVISIBLE**](object-state-constants.md) \| [**STATE\_SYSTEM\_UNAVAILABLE**](object-state-constants.md) \| [**STATE\_SYSTEM\_FOCUSED**](object-state-constants.md) \| [**STATE\_SYSTEM\_FOCUSABLE**](object-state-constants.md)</span></span><br/> <span data-ttu-id="ca13c-153">針對樹狀檢視專案， **state** 屬性包含 [**狀態 \_ 系統 \_ 展開**](object-state-constants.md) 或 [**狀態 \_ 系統 \_**](object-state-constants.md)折迭。</span><span class="sxs-lookup"><span data-stu-id="ca13c-153">For the tree view items, the **State** property includes either [**STATE\_SYSTEM\_EXPANDED**](object-state-constants.md) or [**STATE\_SYSTEM\_COLLAPSED**](object-state-constants.md).</span></span><br/> <span data-ttu-id="ca13c-154">**State** 屬性的其他可能值包括：</span><span class="sxs-lookup"><span data-stu-id="ca13c-154">Additional possible values for the **State** property include:</span></span><br/> <span data-ttu-id="ca13c-155">[**狀態 \_系統 \_ 焦點**](object-state-constants.md) \| [**狀態 \_ 系統可 \_ 設定可設定**](object-state-constants.md) \| [**狀態系統可 \_ \_ 選取**](object-state-constants.md)狀態系統 \| [**\_ \_ 選取**](object-state-constants.md)的 \| [**狀態 \_ 系統 \_ HOTTRACKED**](object-state-constants.md)</span><span class="sxs-lookup"><span data-stu-id="ca13c-155">[**STATE\_SYSTEM\_FOCUSED**](object-state-constants.md) \| [**STATE\_SYSTEM\_FOCUSABLE**](object-state-constants.md) \| [**STATE\_SYSTEM\_SELECTABLE**](object-state-constants.md) \| [**STATE\_SYSTEM\_SELECTED**](object-state-constants.md) \| [**STATE\_SYSTEM\_HOTTRACKED**](object-state-constants.md)</span></span><br/> |
| [<span data-ttu-id="ca13c-156">**取得 \_ accValue**</span><span class="sxs-lookup"><span data-stu-id="ca13c-156">**get\_accValue**</span></span>](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_accvalue)                       | <span data-ttu-id="ca13c-157">樹狀檢視物件沒有值。</span><span class="sxs-lookup"><span data-stu-id="ca13c-157">The tree view object does not have a value.</span></span> <span data-ttu-id="ca13c-158">每個樹狀檢視專案的 [ **值** ] 屬性都是階層中專案的縮排層級。</span><span class="sxs-lookup"><span data-stu-id="ca13c-158">The **Value** property for each tree view item is the indentation level of the item in the hierarchy.</span></span> <span data-ttu-id="ca13c-159">例如，在 Windows 檔案總管中，"Desktop" 專案的 **值** 屬性為 "0";專案 "我的電腦" （位於階層中的下一個層級）的 **值** 屬性為 "1";而且每個磁片磁碟機（位於階層中的下一個層級）的 **值** 屬性為 "2"。</span><span class="sxs-lookup"><span data-stu-id="ca13c-159">For example, in Windows Explorer, the item "Desktop" has a **Value** property of "0"; the item "My Computer", which is at the next level in the hierarchy, has a **Value** property of "1"; and each of the disk drives, which are at the next level in the hierarchy, have a **Value** property of "2".</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |



 

## <a name="notes"></a><span data-ttu-id="ca13c-160">備註</span><span class="sxs-lookup"><span data-stu-id="ca13c-160">Notes</span></span>

<span data-ttu-id="ca13c-161">樹狀檢視專案的 **accLocation** 屬性只會傳回專案中文字的位置。</span><span class="sxs-lookup"><span data-stu-id="ca13c-161">The **accLocation** property of tree view items returns the location only of the text in the item.</span></span> <span data-ttu-id="ca13c-162">**AccLocation** 針對樹狀檢視專案所傳回的座標不包含位於文字左邊的圖示。</span><span class="sxs-lookup"><span data-stu-id="ca13c-162">The coordinates returned by **accLocation** for tree view items do not include the icon located to the left of the text.</span></span>

## <a name="related-topics"></a><span data-ttu-id="ca13c-163">相關主題</span><span class="sxs-lookup"><span data-stu-id="ca13c-163">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="ca13c-164">IAccessible 介面</span><span class="sxs-lookup"><span data-stu-id="ca13c-164">IAccessible Interface</span></span>](/windows/desktop/api/oleacc/nn-oleacc-iaccessible)
</dt> </dl>

 

 





