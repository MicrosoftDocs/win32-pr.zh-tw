---
title: 如何在專案視圖中查詢虛擬化專案
description: 本主題說明如何使用 Microsoft 消費者介面自動化來抓取 Windows 7 專案視圖中虛擬化專案的 UI 資訊。
ms.assetid: a0bff8a1-47b1-4750-8086-e2e65a79099e
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: a098635d6e1045c6ff4573de088d8455685014d3
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 09/16/2019
ms.locfileid: "104372530"
---
# <a name="how-to-query-a-virtualized-item-in-items-view"></a><span data-ttu-id="8a0ee-103">如何在專案視圖中查詢虛擬化專案</span><span class="sxs-lookup"><span data-stu-id="8a0ee-103">How to Query a Virtualized Item in Items View</span></span>

<span data-ttu-id="8a0ee-104">本主題說明如何使用 Microsoft 消費者介面自動化來抓取 Windows 7 專案視圖中虛擬化專案的 UI 資訊。</span><span class="sxs-lookup"><span data-stu-id="8a0ee-104">This topic describes how to use Microsoft UI Automation to retrieve UI information about virtualized items in the Windows 7 Items View.</span></span> <span data-ttu-id="8a0ee-105">本主題包含下列各節。</span><span class="sxs-lookup"><span data-stu-id="8a0ee-105">This topic includes the following sections.</span></span>

> [!Note]  
> <span data-ttu-id="8a0ee-106">本主題僅適用于 Windows 7。</span><span class="sxs-lookup"><span data-stu-id="8a0ee-106">This topic applies to Windows 7 only.</span></span> <span data-ttu-id="8a0ee-107">請注意，本主題中所述的協助工具功能可能會在未來的 Windows 版本中變更。</span><span class="sxs-lookup"><span data-stu-id="8a0ee-107">Be aware that the accessibility features described in this topic may change in future versions of Windows.</span></span>

 

-   [<span data-ttu-id="8a0ee-108">概觀</span><span class="sxs-lookup"><span data-stu-id="8a0ee-108">Overview</span></span>](#overview)
-   [<span data-ttu-id="8a0ee-109">專案視圖樹狀結構</span><span class="sxs-lookup"><span data-stu-id="8a0ee-109">Items View Tree Structure</span></span>](#items-view-tree-structure)
-   [<span data-ttu-id="8a0ee-110">虛擬化</span><span class="sxs-lookup"><span data-stu-id="8a0ee-110">Virtualization</span></span>](#virtualization)
-   [<span data-ttu-id="8a0ee-111">取得所有專案的計數</span><span class="sxs-lookup"><span data-stu-id="8a0ee-111">Obtaining a Count of All Items</span></span>](#obtaining-a-count-of-all-items)
-   [<span data-ttu-id="8a0ee-112">取得與所有專案相關的專案索引</span><span class="sxs-lookup"><span data-stu-id="8a0ee-112">Obtaining an Item Index with Respect to All Items</span></span>](#obtaining-an-item-index-with-respect-to-all-items)
-   [<span data-ttu-id="8a0ee-113">取得 Vitualized 專案的參考</span><span class="sxs-lookup"><span data-stu-id="8a0ee-113">Obtaining a Reference to a Vitualized Item</span></span>](#obtaining-a-reference-to-a-vitualized-item)
-   [<span data-ttu-id="8a0ee-114">在螢幕上滾動虛擬專案</span><span class="sxs-lookup"><span data-stu-id="8a0ee-114">Scrolling a Virtualized Item on Screen</span></span>](#scrolling-a-virtualized-item-on-screen)
-   [<span data-ttu-id="8a0ee-115">相關主題</span><span class="sxs-lookup"><span data-stu-id="8a0ee-115">Related topics</span></span>](#related-topics)

## <a name="overview"></a><span data-ttu-id="8a0ee-116">概觀</span><span class="sxs-lookup"><span data-stu-id="8a0ee-116">Overview</span></span>

<span data-ttu-id="8a0ee-117">專案視圖是使用者介面元件，可讓使用者查看檔案和其他專案並與其互動。</span><span class="sxs-lookup"><span data-stu-id="8a0ee-117">Items View is a user interface component that enables users to view and interact with files and other items.</span></span> <span data-ttu-id="8a0ee-118">在 Windows 7 中，[專案] 視圖會取代 [清單視圖] 控制項，以便在 Windows 檔案總管的預設視圖中呈現專案。</span><span class="sxs-lookup"><span data-stu-id="8a0ee-118">In Windows 7, Items View replaces the list-view control for presenting items in the default view of Windows Explorer.</span></span> <span data-ttu-id="8a0ee-119">[專案] 視圖也會用於 [一般專案] 對話方塊中，[開始] 功能表搜尋結果，以及其他使用 Explorer 瀏覽器控制項的 Windows 7 UI 元素。</span><span class="sxs-lookup"><span data-stu-id="8a0ee-119">Items View is also used in the Common Item Dialog, Start menu search results, and other Windows 7 UI elements that use the Explorer Browser control.</span></span> <span data-ttu-id="8a0ee-120">相較于清單視圖控制項，[專案] 視圖會為使用者提供下列優點：</span><span class="sxs-lookup"><span data-stu-id="8a0ee-120">Compared to the list-view control, Items View offers the following advantages to users:</span></span>

-   <span data-ttu-id="8a0ee-121">Items View 可以用更實用、更理想且相關的方式來呈現專案，讓使用者可以更輕鬆、快速且 enjoyably 地尋找及整理專案。</span><span class="sxs-lookup"><span data-stu-id="8a0ee-121">Items View can present items in ways that are more useful, desirable, and relevant, enabling users to find and organize items more simply, quickly, and enjoyably.</span></span>
-   <span data-ttu-id="8a0ee-122">專案視圖可以顯示具有不同效能特性之資料來源中的大型專案集，讓使用者能夠流覽和搜尋跨多個來源的整個專案集合。</span><span class="sxs-lookup"><span data-stu-id="8a0ee-122">Items View can display large sets of items from data sources that have different performance characteristics, enabling users to browse and search their entire collection of items across multiple sources.</span></span>

<span data-ttu-id="8a0ee-123">下圖顯示 Windows 檔案總管中的專案視圖。</span><span class="sxs-lookup"><span data-stu-id="8a0ee-123">The following image shows the Items View in Windows Explorer.</span></span>

![顯示 windows explorer 和專案 view 元件的螢幕擷取畫面](images/itemsview.gif)

<span data-ttu-id="8a0ee-125">從開發人員的觀點來看，[專案] 視圖的一般結構和功能類似于清單視圖控制項。</span><span class="sxs-lookup"><span data-stu-id="8a0ee-125">From a developer's perspective, the general structure and functionality of Items View is similar to that of the list-view control.</span></span> <span data-ttu-id="8a0ee-126">主要差異在於專案視圖支援虛擬化，而清單視圖控制項則不支援。</span><span class="sxs-lookup"><span data-stu-id="8a0ee-126">The main difference is that Items View supports virtualization, whereas the list-view control does not.</span></span> <span data-ttu-id="8a0ee-127">此外，專案視圖會使用兩個新的消費者介面自動化介面，以確保可存取專案視圖所提供的虛擬化內容。</span><span class="sxs-lookup"><span data-stu-id="8a0ee-127">Also, Items View uses two new UI Automation interfaces to ensure that virtualized content provided by Items View is accessible.</span></span> <span data-ttu-id="8a0ee-128">本主題的下列各節將說明這些介面。</span><span class="sxs-lookup"><span data-stu-id="8a0ee-128">These interfaces are described in the following sections of this topic.</span></span>

<span data-ttu-id="8a0ee-129">如需消費者介面自動化中虛擬化的一般資訊，請參閱 [使用虛擬化專案](uiauto-workingwithvirtualizeditems.md)。</span><span class="sxs-lookup"><span data-stu-id="8a0ee-129">For general information about virtualization in UI Automation, see [Working with Virtualized Items](uiauto-workingwithvirtualizeditems.md).</span></span>

## <a name="items-view-tree-structure"></a><span data-ttu-id="8a0ee-130">專案視圖樹狀結構</span><span class="sxs-lookup"><span data-stu-id="8a0ee-130">Items View Tree Structure</span></span>

<span data-ttu-id="8a0ee-131">在消費者介面自動化樹狀結構中，專案視圖的最上層消費者介面自動化專案的名稱為 "ItemsView"，而控制項類型為 "list"。</span><span class="sxs-lookup"><span data-stu-id="8a0ee-131">In the UI Automation tree, the top level UI Automation element of Items View has the name "ItemsView" and the control type "list".</span></span> <span data-ttu-id="8a0ee-132">在上圖中，ItemsView 消費者介面自動化元素以紅色框住。</span><span class="sxs-lookup"><span data-stu-id="8a0ee-132">In the previous image, the ItemsView UI Automation element is outlined in red.</span></span> <span data-ttu-id="8a0ee-133">各種消費者介面自動化專案都存在於 ItemsView 的最上層，但本檔中只會參考其他兩個消費者介面自動化元素：群組專案和清單專案。</span><span class="sxs-lookup"><span data-stu-id="8a0ee-133">Various UI Automation elements exist below the top level of ItemsView, but only two other UI Automation elements are referenced in this document: group items and list items.</span></span>

<span data-ttu-id="8a0ee-134">群組專案是包含該群組所有清單專案的消費者介面自動化專案，其控制項類型是 "Group"，而其名稱會根據組名而有所不同。</span><span class="sxs-lookup"><span data-stu-id="8a0ee-134">The group items are the UI Automation elements that contain all of the list items of that group—their control type is "Group" and their names vary depending on the group name.</span></span> <span data-ttu-id="8a0ee-135">在上圖中，第一個群組專案同時包含 "A-H (1) " 標頭和 "Folder" 清單專案，且其名稱為 "A-H"。</span><span class="sxs-lookup"><span data-stu-id="8a0ee-135">In the previous image, the first group item contains both the "A-H (1)" header and the "Folder" list item, and its name is "A-H".</span></span>

<span data-ttu-id="8a0ee-136">清單專案是代表視圖中分葉專案的消費者介面自動化專案，其控制項類型為「專案名稱」，而其名稱會根據專案名稱而有所不同。</span><span class="sxs-lookup"><span data-stu-id="8a0ee-136">The list items are the UI Automation elements that represent the leaf items in the view—their control type is "ListItem" and their names vary depending on the item name.</span></span> <span data-ttu-id="8a0ee-137">在上圖中，清單元素是分葉元素，例如「資料夾」、「音樂」和「圖片」。</span><span class="sxs-lookup"><span data-stu-id="8a0ee-137">In the previous image, the list elements are the leaf elements such as "Folder", "Music", and "Picture".</span></span> <span data-ttu-id="8a0ee-138">這三個消費者介面自動化專案是由本檔其餘部分中的「詞彙 ItemsView 元素」、「群組元素」和「專案組合」元素所參考。</span><span class="sxs-lookup"><span data-stu-id="8a0ee-138">These three UI Automation elements are referred to by the terms ItemsView element, Group element, and ListItem element in the remainder of this document.</span></span>

## <a name="virtualization"></a><span data-ttu-id="8a0ee-139">虛擬化</span><span class="sxs-lookup"><span data-stu-id="8a0ee-139">Virtualization</span></span>

<span data-ttu-id="8a0ee-140">專案視圖會使用虛擬化，這表示不會從系統提取 view 可見區域以外的專案，也不會建立這些專案的 UI 標記法。</span><span class="sxs-lookup"><span data-stu-id="8a0ee-140">Items View uses virtualization, which means that items outside the visible area of the view are not fetched from the system, and the UI representation of them is not created.</span></span> <span data-ttu-id="8a0ee-141">這些專案稱為 *虛擬化專案*。</span><span class="sxs-lookup"><span data-stu-id="8a0ee-141">These items are called *virtualized items*.</span></span> <span data-ttu-id="8a0ee-142">因為它們不會建立，所以虛擬化專案沒有消費者介面自動化元素，因此當消費者介面自動化用戶端列舉樹狀結構時，不會出現在消費者介面自動化樹狀目錄中。</span><span class="sxs-lookup"><span data-stu-id="8a0ee-142">Because they are not created, virtualized items do not have UI Automation elements and therefore do not appear in the UI Automation tree when a UI Automation client enumerates the tree.</span></span> <span data-ttu-id="8a0ee-143">此外，消費者介面自動化控制項模式只會在可見的元素上運作。</span><span class="sxs-lookup"><span data-stu-id="8a0ee-143">Also, UI Automation control patterns operate only on visible elements.</span></span> <span data-ttu-id="8a0ee-144">例如，當用戶端呼叫 [**IUIAutomationSelectionPattern：： GetCurrentSelection**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationselectionpattern-getcurrentselection)方法時，[選取](uiauto-implementingselection.md)控制項模式只會傳回可見的選取專案。</span><span class="sxs-lookup"><span data-stu-id="8a0ee-144">For example, the [Selection](uiauto-implementingselection.md) control pattern returns only the visible selected items when a client calls the [**IUIAutomationSelectionPattern::GetCurrentSelection**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationselectionpattern-getcurrentselection) method.</span></span>

<span data-ttu-id="8a0ee-145">專案視圖支援抓取下列虛擬化專案相關資訊的能力：</span><span class="sxs-lookup"><span data-stu-id="8a0ee-145">Items View supports the ability to retrieve the following information about virtualized items:</span></span>

-   <span data-ttu-id="8a0ee-146">專案總數的計數，包括虛擬化專案</span><span class="sxs-lookup"><span data-stu-id="8a0ee-146">A count of the total number of items, including virtualized items</span></span>
-   <span data-ttu-id="8a0ee-147">虛擬化專案的消費者介面自動化元素</span><span class="sxs-lookup"><span data-stu-id="8a0ee-147">UI Automation elements for virtualized items</span></span>
-   <span data-ttu-id="8a0ee-148">已選取之虛擬化專案的消費者介面自動化元素</span><span class="sxs-lookup"><span data-stu-id="8a0ee-148">UI Automation elements for the virtualized items that are selected</span></span>

## <a name="obtaining-a-count-of-all-items"></a><span data-ttu-id="8a0ee-149">取得所有專案的計數</span><span class="sxs-lookup"><span data-stu-id="8a0ee-149">Obtaining a Count of All Items</span></span>

<span data-ttu-id="8a0ee-150">用戶端可以使用 ItemsView 元素來取得所有專案的計數，以及所選取專案的計數。</span><span class="sxs-lookup"><span data-stu-id="8a0ee-150">A client can use the ItemsView element to get a count of all items, as well as a count of the selected items.</span></span> <span data-ttu-id="8a0ee-151">ItemsView 元素提供兩種方式來取得這些計數。</span><span class="sxs-lookup"><span data-stu-id="8a0ee-151">The ItemsView element provides two ways to get these counts.</span></span> <span data-ttu-id="8a0ee-152">第一個是取得 ItemsView 專案的 ItemStatus 屬性，而第二個則是從 ItemsView 元素取得自訂屬性。</span><span class="sxs-lookup"><span data-stu-id="8a0ee-152">The first is by getting the ItemStatus property of the ItemsView element, and the second is by getting custom properties from the ItemsView element.</span></span>

<span data-ttu-id="8a0ee-153">ItemStatus 屬性是一個字串，可指定專案總數的計數和選取專案的計數（以逗號分隔）。</span><span class="sxs-lookup"><span data-stu-id="8a0ee-153">The ItemStatus property is a string that specifies a count of the total number of items and a count of the selected items, separated by a comma.</span></span> <span data-ttu-id="8a0ee-154">例如： "3 個專案，已選取1個專案"。</span><span class="sxs-lookup"><span data-stu-id="8a0ee-154">For example: "3 items, 1 item selected".</span></span> <span data-ttu-id="8a0ee-155">這個字串是當地語系化的，可直接傳達給使用者。</span><span class="sxs-lookup"><span data-stu-id="8a0ee-155">This string is localized and can be communicated directly to the user.</span></span>

<span data-ttu-id="8a0ee-156">ItemsView 元素的自訂屬性包含專案計數的一個屬性，而另一個屬性則包含選取專案計數。</span><span class="sxs-lookup"><span data-stu-id="8a0ee-156">The custom properties of the ItemsView element include one property for the item count, and another for the selection count.</span></span> <span data-ttu-id="8a0ee-157">包括：</span><span class="sxs-lookup"><span data-stu-id="8a0ee-157">They include:</span></span>

-   <span data-ttu-id="8a0ee-158">ItemCount \_ 屬性 \_ GUID (ABBF5C45-5CCC-47b7-BB4E-87CB87BBD162) -view 中所有唯一專案的計數。</span><span class="sxs-lookup"><span data-stu-id="8a0ee-158">ItemCount\_Property\_GUID (ABBF5C45-5CCC-47b7-BB4E-87CB87BBD162)—The count of all unique items in the view.</span></span> <span data-ttu-id="8a0ee-159">如果依據多重值屬性分組 (MVP) 讓單一專案可以多次出現，則每個專案只會計算一次。</span><span class="sxs-lookup"><span data-stu-id="8a0ee-159">If grouped by a multi-value property (MVP) so that a single item can appear multiple times, each item is counted only once.</span></span>

    <span data-ttu-id="8a0ee-160"> (UIAutomationType： [**UIAutomationType \_ Int**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-uiautomationtype)，程式設計名稱： "ItemCount" ) </span><span class="sxs-lookup"><span data-stu-id="8a0ee-160">(UIAutomationType: [**UIAutomationType\_Int**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-uiautomationtype), Programmatic Name: "ItemCount")</span></span>

-   <span data-ttu-id="8a0ee-161">SelectedItemCount \_ 屬性 \_ GUID (92A053DA-2969-4021-BF27-514CFC2E4A69) -在 view 中選取的所有唯一專案計數。</span><span class="sxs-lookup"><span data-stu-id="8a0ee-161">SelectedItemCount\_Property\_GUID (92A053DA-2969-4021-BF27-514CFC2E4A69)—The count of all unique items selected in the view.</span></span> <span data-ttu-id="8a0ee-162">如果依據多重值屬性分組 (MVP) 讓單一專案可以多次出現，則每個專案只會計算一次。</span><span class="sxs-lookup"><span data-stu-id="8a0ee-162">If grouped by a multi-value property (MVP) so that a single item can appear multiple times, each item is counted only once.</span></span>

    <span data-ttu-id="8a0ee-163"> (UIAutomationType： [**UIAutomationType \_ Int**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-uiautomationtype)，程式設計名稱： "SelectedItemCount" ) </span><span class="sxs-lookup"><span data-stu-id="8a0ee-163">(UIAutomationType: [**UIAutomationType\_Int**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-uiautomationtype), Programmatic Name: "SelectedItemCount")</span></span>

<span data-ttu-id="8a0ee-164">這些自訂屬性是在 Shlguid 中定義，其中包含在 Windows 軟體開發套件 (SDK) 中，而這些屬性則是透過 [**IUIAutomationRegistrar：： RegisterProperty**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iuiautomationregistrar-registerproperty) 方法來註冊。</span><span class="sxs-lookup"><span data-stu-id="8a0ee-164">These custom properties are defined in Shlguid.h, which is included in the Windows Software Development Kit (SDK), and these properties are registered through the [**IUIAutomationRegistrar::RegisterProperty**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iuiautomationregistrar-registerproperty) method.</span></span> <span data-ttu-id="8a0ee-165">消費者介面自動化用戶端會使用 **RegisterProperty** 來抓取自訂屬性 (PROPERTYIDs) 的屬性識別碼。</span><span class="sxs-lookup"><span data-stu-id="8a0ee-165">UI Automation clients use **RegisterProperty** to retrieve property identifiers (PROPERTYIDs) for the custom properties.</span></span>

## <a name="obtaining-an-item-index-with-respect-to-all-items"></a><span data-ttu-id="8a0ee-166">取得與所有專案相關的專案索引</span><span class="sxs-lookup"><span data-stu-id="8a0ee-166">Obtaining an Item Index with Respect to All Items</span></span>

<span data-ttu-id="8a0ee-167">用戶端可以取得專案的索引，方法是取得專案的 ItemStatus 屬性，或取得 [專案] 元素的自訂屬性。</span><span class="sxs-lookup"><span data-stu-id="8a0ee-167">A client can obtain the index of an item either by getting the ItemStatus property of a ListItem element, or by getting a custom property of a ListItem element.</span></span>

<span data-ttu-id="8a0ee-168">ItemStatus 屬性是一個字串，其中包含與專案總數相關之專案的索引。</span><span class="sxs-lookup"><span data-stu-id="8a0ee-168">The ItemStatus property is a string that contains the index of an item with respect to the total number of items.</span></span> <span data-ttu-id="8a0ee-169">例如：「專案 1/3」。</span><span class="sxs-lookup"><span data-stu-id="8a0ee-169">For example: "item 1 of 3".</span></span> <span data-ttu-id="8a0ee-170">這個字串是當地語系化的，可直接傳達給使用者。</span><span class="sxs-lookup"><span data-stu-id="8a0ee-170">This string is localized and can be communicated directly to the user.</span></span>

<span data-ttu-id="8a0ee-171">下列自訂屬性會取得 [專案] 元素的專案索引：</span><span class="sxs-lookup"><span data-stu-id="8a0ee-171">The following custom property gets the item index of a ListItem element:</span></span>

-   <span data-ttu-id="8a0ee-172">ItemIndex \_ 屬性 \_ GUID (92A053DA-2969-4021-BF27-514CFC2E4A69) -專案的以1為基的絕對索引。</span><span class="sxs-lookup"><span data-stu-id="8a0ee-172">ItemIndex\_Property\_GUID (92A053DA-2969-4021-BF27-514CFC2E4A69)—The 1-based absolute index of an item.</span></span> <span data-ttu-id="8a0ee-173">如果依據多重值屬性分組 (MVP) 讓單一專案可以出現兩次，則專案的每個外觀都會取得個別的索引。</span><span class="sxs-lookup"><span data-stu-id="8a0ee-173">If grouped by a multi-value property (MVP) so that a single item can appear twice, each appearance of the item gets a separate index.</span></span>

    <span data-ttu-id="8a0ee-174"> (UIAutomationType： [**UIAutomationType \_ Int**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-uiautomationtype)，程式設計名稱： "ItemIndex" ) </span><span class="sxs-lookup"><span data-stu-id="8a0ee-174">(UIAutomationType: [**UIAutomationType\_Int**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-uiautomationtype), Programmatic Name: "ItemIndex")</span></span>

<span data-ttu-id="8a0ee-175">這個自訂屬性是在 Shlguid 中定義，其中包含在 Windows SDK 中，並透過 [**IUIAutomationRegistrar：： RegisterProperty**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iuiautomationregistrar-registerproperty) 方法註冊。</span><span class="sxs-lookup"><span data-stu-id="8a0ee-175">This custom property is defined in Shlguid.h, which is included in the Windows SDK, and is registered through the [**IUIAutomationRegistrar::RegisterProperty**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iuiautomationregistrar-registerproperty) method.</span></span> <span data-ttu-id="8a0ee-176">消費者介面自動化用戶端會使用 **RegisterProperty** 來抓取自訂屬性 (PROPERTYIDs) 的屬性識別碼。</span><span class="sxs-lookup"><span data-stu-id="8a0ee-176">UI Automation clients use **RegisterProperty** to retrieve a property identifier (PROPERTYIDs) for the custom property.</span></span>

## <a name="obtaining-a-reference-to-a-vitualized-item"></a><span data-ttu-id="8a0ee-177">取得 Vitualized 專案的參考</span><span class="sxs-lookup"><span data-stu-id="8a0ee-177">Obtaining a Reference to a Vitualized Item</span></span>

<span data-ttu-id="8a0ee-178">ItemsView 元素會將 [>itemcontainer](uiauto-implementingitemcontainer.md) 控制項模式 ([**IItemContainerProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-iitemcontainerprovider)) 介面，以允許用戶端取得虛擬化專案的消費者介面自動化專案， (可見區域以外的專案) 。</span><span class="sxs-lookup"><span data-stu-id="8a0ee-178">An ItemsView element implements the [ItemContainer](uiauto-implementingitemcontainer.md) control pattern ([**IItemContainerProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-iitemcontainerprovider) interface), which allows a client to get a UI Automation element for a virtualized item (an item that is outside the visible area).</span></span> <span data-ttu-id="8a0ee-179">ItemsView 可讓用戶端藉由搜尋名稱和選取屬性來尋找 [專案] 元素，嘗試搜尋任何其他屬性將會失敗。</span><span class="sxs-lookup"><span data-stu-id="8a0ee-179">ItemsView allows the client to find a ListItem element by searching on the Name and Selection properties—attempting to search on any other property will fail.</span></span>

<span data-ttu-id="8a0ee-180">虛擬專案只會將 [VirtualizedItem](uiauto-implementingvirtualizeditem.md) 控制項模式實 ([**IVirtualizedItemProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-ivirtualizeditemprovider) 介面) 。</span><span class="sxs-lookup"><span data-stu-id="8a0ee-180">A virtual element implements only the [VirtualizedItem](uiauto-implementingvirtualizeditem.md) control pattern ([**IVirtualizedItemProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-ivirtualizeditemprovider) interface).</span></span> <span data-ttu-id="8a0ee-181">因為虛擬化消費者介面自動化專案所代表的專案尚未存在，所以嘗試取得專案的任何其他控制項模式或屬性將會失敗。</span><span class="sxs-lookup"><span data-stu-id="8a0ee-181">Because the item that is represented by a virtualized UI Automation element does not exist yet, attempting to get any other control pattern or property of the element will fail.</span></span>

<span data-ttu-id="8a0ee-182">專案組合和群組專案都已虛擬化，但是只能從 [>itemcontainer](uiauto-implementingitemcontainer.md) 控制項模式傳回專案組合元素。</span><span class="sxs-lookup"><span data-stu-id="8a0ee-182">Both ListItem and Group elements are virtualized, but only ListItem elements can be returned from the [ItemContainer](uiauto-implementingitemcontainer.md) control pattern.</span></span> <span data-ttu-id="8a0ee-183">由於呼叫 [**IUIAutomationItemContainerPattern：： FindItemByProperty**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationitemcontainerpattern-finditembyproperty) 方法會在 UI 執行緒上執行，而且會封鎖，因此在 **FindItemByProperty** 傳回之前，view 不會回應，而且提供者上的任何其他方法呼叫都必須等到 **FindItemByProperty** 完成為止。</span><span class="sxs-lookup"><span data-stu-id="8a0ee-183">Because the call to the [**IUIAutomationItemContainerPattern::FindItemByProperty**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationitemcontainerpattern-finditembyproperty) method runs on the UI thread and is blocking, the view will not respond until **FindItemByProperty** returns, and any other method calls on the provider must wait until **FindItemByProperty** finishes.</span></span> <span data-ttu-id="8a0ee-184">在某些情況下， **FindItemByProperty** 必須在傳回之前處理整個資料集，這可能需要大量資源。</span><span class="sxs-lookup"><span data-stu-id="8a0ee-184">In some instances, **FindItemByProperty** must process the entire data set before returning, which can be resource-intensive.</span></span> <span data-ttu-id="8a0ee-185">將 **Null** 指定為起始元素，會導致 **FindItemByProperty** 開始使用 view 中的第一個專案進行搜尋。</span><span class="sxs-lookup"><span data-stu-id="8a0ee-185">Specifying **NULL** as the starting element causes **FindItemByProperty** to begin the search with the first item in the view.</span></span>

<span data-ttu-id="8a0ee-186">ItemsView 支援下列 [**FindItemByProperty**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationitemcontainerpattern-finditembyproperty)屬性：</span><span class="sxs-lookup"><span data-stu-id="8a0ee-186">ItemsView supports the following properties for [**FindItemByProperty**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationitemcontainerpattern-finditembyproperty):</span></span>

-   <span data-ttu-id="8a0ee-187">Name (UIA \_ NamePropertyId) -搜尋名稱完全符合指定字串的第一個專案。</span><span class="sxs-lookup"><span data-stu-id="8a0ee-187">Name (UIA\_NamePropertyId)—Searches for the first item whose name fully matches the specified string.</span></span> <span data-ttu-id="8a0ee-188">搜尋是不區分大小寫的。</span><span class="sxs-lookup"><span data-stu-id="8a0ee-188">The search is not case sensitive.</span></span> <span data-ttu-id="8a0ee-189">不支援萬用字元或部分相符。</span><span class="sxs-lookup"><span data-stu-id="8a0ee-189">Wildcard characters or partial matching is not supported.</span></span> <span data-ttu-id="8a0ee-190">如果指定了 **Null** 名稱，則會傳回起始元素之後的下一個專案。</span><span class="sxs-lookup"><span data-stu-id="8a0ee-190">If a **NULL** name is specified, the next item after the starting element is returned.</span></span> <span data-ttu-id="8a0ee-191">指定 **Null** 名稱可讓消費者介面自動化用戶端列舉視圖中的所有專案;但是，不建議您列舉所有的專案，因為它會使 view 中的所有專案都能實現。</span><span class="sxs-lookup"><span data-stu-id="8a0ee-191">Specifying **NULL** names allows a UI Automation client to enumerate all items in the view; however, enumerating all items is discouraged because it causes all items in the view to be realized.</span></span>
-   <span data-ttu-id="8a0ee-192">SelectionItem \_ IsSelected (UIA \_ SelectionItemIsSelectedPropertyId) —搜尋 SelectionItem \_ IsSelected 屬性符合指定值的第一個專案。</span><span class="sxs-lookup"><span data-stu-id="8a0ee-192">SelectionItem\_IsSelected (UIA\_SelectionItemIsSelectedPropertyId)—Searches for the first item whose SelectionItem\_IsSelected property matches the specified value.</span></span> <span data-ttu-id="8a0ee-193">指定 **TRUE** 以尋找第一個選取的專案，或指定 **FALSE** 來尋找第一個未選取的專案。</span><span class="sxs-lookup"><span data-stu-id="8a0ee-193">Specify **TRUE** to find the first selected item, or **FALSE** to find the first non-selected item.</span></span> <span data-ttu-id="8a0ee-194">列舉所有選取的專案時請小心，因為選取的專案數目可能很大，特別是當使用者已選取所有專案時。</span><span class="sxs-lookup"><span data-stu-id="8a0ee-194">Be careful when enumerating all selected items because the number of selected items can be very large, especially if the user has selected all items.</span></span>

## <a name="scrolling-a-virtualized-item-on-screen"></a><span data-ttu-id="8a0ee-195">在螢幕上滾動虛擬專案</span><span class="sxs-lookup"><span data-stu-id="8a0ee-195">Scrolling a Virtualized Item on Screen</span></span>

<span data-ttu-id="8a0ee-196">取得虛擬化 (的) 專案之消費者介面自動化專案的參考之後，用戶端就可以使用 [VirtualizedItem](uiauto-implementingvirtualizeditem.md)控制項模式的 [**IUIAutomationVirtualizeItemPattern：：**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationvirtualizeditempattern-realize) get-help 方法，將專案滾動至 view。</span><span class="sxs-lookup"><span data-stu-id="8a0ee-196">After obtaining a reference to a UI Automation element for a virtualized (off-screen) item, the client can scroll the item into view by using the [**IUIAutomationVirtualizeItemPattern::Realize**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationvirtualizeditempattern-realize) method of the [VirtualizedItem](uiauto-implementingvirtualizeditem.md) control pattern.</span></span> <span data-ttu-id="8a0ee-197">在瞭解專案之後，就會看到該專案，而且通常與 [專案組合] 元素相關聯的所有屬性和控制項模式都可供用戶端使用。</span><span class="sxs-lookup"><span data-stu-id="8a0ee-197">After the item is realized, it is visible, and all properties and control patterns normally associated with a ListItem element are available to the client.</span></span>

<span data-ttu-id="8a0ee-198">只有 [**IUIAutomationItemContainerPattern：： FindItemByProperty**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationitemcontainerpattern-finditembyproperty) 方法所取得的 [專案] 元素會公開 [VirtualizedItem](uiauto-implementingvirtualizeditem.md) 控制項模式。</span><span class="sxs-lookup"><span data-stu-id="8a0ee-198">Only ListItem elements obtained by the [**IUIAutomationItemContainerPattern::FindItemByProperty**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationitemcontainerpattern-finditembyproperty) method expose the [VirtualizedItem](uiauto-implementingvirtualizeditem.md) control pattern.</span></span> <span data-ttu-id="8a0ee-199">當螢幕上的專案在螢幕上滾動時，元素會變成無效，而且用戶端必須呼叫 **FindItemByProperty** 來取得螢幕上的參考。</span><span class="sxs-lookup"><span data-stu-id="8a0ee-199">When an on-screen element is scrolled off-screen, the element becomes invalid and the client must call **FindItemByProperty** to get the off-screen reference.</span></span>

<span data-ttu-id="8a0ee-200">您也可以使用 [滾動](uiauto-implementingscroll.md) 條控制項模式 (或使用捲軸) ，將專案移入和移出視野。</span><span class="sxs-lookup"><span data-stu-id="8a0ee-200">It is also possible to move items into and out of view by using the [Scroll](uiauto-implementingscroll.md) control pattern (or by using the scroll bars).</span></span> <span data-ttu-id="8a0ee-201">專案和群組會在進入視野時實現，並會在其離開視圖時進行虛擬化。</span><span class="sxs-lookup"><span data-stu-id="8a0ee-201">Items and groups are realized as they scroll into view, and are virtualized as they scroll out of view.</span></span>

## <a name="related-topics"></a><span data-ttu-id="8a0ee-202">相關主題</span><span class="sxs-lookup"><span data-stu-id="8a0ee-202">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="8a0ee-203">使用虛擬化專案</span><span class="sxs-lookup"><span data-stu-id="8a0ee-203">Working with Virtualized Items</span></span>](uiauto-workingwithvirtualizeditems.md)
</dt> </dl>

 

 




