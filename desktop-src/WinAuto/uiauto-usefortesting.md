---
title: 使用 UI 自動化進行自動化測試
description: 本總覽說明 Microsoft 消費者介面自動化如何作為在自動化測試案例中以程式設計方式存取的架構。
ms.assetid: 192162f9-55bf-4111-9f15-c0d3b5af2ab7
keywords:
- 用戶端，消費者介面自動化自動化測試
- 用戶端，自動化測試
- 用戶端，測試
- 用戶端，自動化測試控管
- 適用于自動化測試的用戶端、消費者介面自動化工具
- 用戶端，消費者介面自動化測試
- 消費者介面自動化，自動化測試
- 消費者介面自動化，測試
- 消費者介面自動化，自動化測試的工具
- 自動化的測試
- 自動化測試的工具
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 269ff32cae26f8bb8ea6bb5b55ac91f1e0486685
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 09/16/2019
ms.locfileid: "104021456"
---
# <a name="using-ui-automation-for-automated-testing"></a><span data-ttu-id="d0193-114">使用 UI 自動化進行自動化測試</span><span class="sxs-lookup"><span data-stu-id="d0193-114">Using UI Automation for Automated Testing</span></span>

<span data-ttu-id="d0193-115">本總覽說明 Microsoft 消費者介面自動化如何作為在自動化測試案例中以程式設計方式存取的架構。</span><span class="sxs-lookup"><span data-stu-id="d0193-115">This overview describes how Microsoft UI Automation can be useful as a framework for programmatic access in automated testing scenarios.</span></span>

<span data-ttu-id="d0193-116">消費者介面自動化提供統一的物件模型，可讓所有 UI 架構以可存取且輕鬆的自動化方式公開複雜且豐富的功能。</span><span class="sxs-lookup"><span data-stu-id="d0193-116">UI Automation provides a unified object model that enables all UI frameworks to expose complex and rich functionality in an accessible and easily automated manner.</span></span>

<span data-ttu-id="d0193-117">消費者介面自動化是以 Microsoft Active Accessibility 的後續發展而成，這是一種架構，旨在提供可供存取控制項和應用程式的解決方案。</span><span class="sxs-lookup"><span data-stu-id="d0193-117">UI Automation was developed as a successor to Microsoft Active Accessibility, a framework designed to provide a solution for making controls and applications accessible.</span></span> <span data-ttu-id="d0193-118">Microsoft Active Accessibility 不是以測試自動化為考慮而設計，雖然它會因為存取範圍和自動化的類似需求而演進至該角色。</span><span class="sxs-lookup"><span data-stu-id="d0193-118">Microsoft Active Accessibility was not designed with test automation in mind, although it evolved into that role because of the similar requirements of accessibility and automation.</span></span> <span data-ttu-id="d0193-119">消費者介面自動化的設計目的是為了提供適用于自動化測試的強大功能，以及提供更精確的協助工具解決方案。</span><span class="sxs-lookup"><span data-stu-id="d0193-119">UI Automation is specifically designed to provide robust functionality for automated testing, in addition to providing more refined solutions for accessibility.</span></span> <span data-ttu-id="d0193-120">例如，Microsoft Active Accessibility 依賴單一介面來公開 UI 的相關資訊，並收集輔助技術產品所需的資訊;消費者介面自動化分隔兩個模型。</span><span class="sxs-lookup"><span data-stu-id="d0193-120">For example, Microsoft Active Accessibility relies on a single interface to expose information about the UI and to collect the information needed by assistive technology products; UI Automation separates the two models.</span></span>

<span data-ttu-id="d0193-121">提供者和用戶端都必須執行消費者介面自動化，才能做為自動化測試控管。</span><span class="sxs-lookup"><span data-stu-id="d0193-121">Both a provider and a client are required to implement UI Automation for it to be useful as an automated test tool.</span></span> <span data-ttu-id="d0193-122">消費者介面自動化提供者是應用程式，例如 Microsoft Word、Microsoft Excel，以及以 Windows 作業系統為基礎的其他協力廠商應用程式或控制項。</span><span class="sxs-lookup"><span data-stu-id="d0193-122">UI Automation providers are applications, such as Microsoft Word, Microsoft Excel, and other third-party applications or controls based on the Windows operating system.</span></span> <span data-ttu-id="d0193-123">使用者介面自動化用戶端則包括自動化測試指令碼和輔助技術應用程式。</span><span class="sxs-lookup"><span data-stu-id="d0193-123">UI Automation clients include automated test scripts and assistive technology applications.</span></span>

<span data-ttu-id="d0193-124">本主題包含下列各節。</span><span class="sxs-lookup"><span data-stu-id="d0193-124">This topic contains the following sections.</span></span>

-   [<span data-ttu-id="d0193-125">提供者中的消費者介面自動化</span><span class="sxs-lookup"><span data-stu-id="d0193-125">UI Automation in Providers</span></span>](#ui-automation-in-providers)
-   [<span data-ttu-id="d0193-126">用戶端中的消費者介面自動化</span><span class="sxs-lookup"><span data-stu-id="d0193-126">UI Automation in Clients</span></span>](#ui-automation-in-clients)
    -   [<span data-ttu-id="d0193-127">以程式設計方式存取</span><span class="sxs-lookup"><span data-stu-id="d0193-127">Programmatic Access</span></span>](#programmatic-access)
-   [<span data-ttu-id="d0193-128">測試自動化的主要屬性</span><span class="sxs-lookup"><span data-stu-id="d0193-128">Key Properties for Test Automation</span></span>](#key-properties-for-test-automation)
-   [<span data-ttu-id="d0193-129">相關工具和技術</span><span class="sxs-lookup"><span data-stu-id="d0193-129">Related Tools and Technologies</span></span>](#related-tools-and-technologies)
-   [<span data-ttu-id="d0193-130">相關主題</span><span class="sxs-lookup"><span data-stu-id="d0193-130">Related topics</span></span>](#related-topics)

## <a name="ui-automation-in-providers"></a><span data-ttu-id="d0193-131">提供者中的消費者介面自動化</span><span class="sxs-lookup"><span data-stu-id="d0193-131">UI Automation in Providers</span></span>

<span data-ttu-id="d0193-132">若要將使用者介面的元素自動化，開發人員必須查看終端使用者可以使用標準鍵盤和滑鼠互動來執行 UI 物件的動作。</span><span class="sxs-lookup"><span data-stu-id="d0193-132">To automate an element of the user interface, the developer must look at what actions an end user can perform on the UI object by using standard keyboard and mouse interaction.</span></span> <span data-ttu-id="d0193-133">識別出這些按鍵動作之後，就應該在控制項上執行鏡像功能和 UI 元素行為的消費者介面自動化控制項模式。</span><span class="sxs-lookup"><span data-stu-id="d0193-133">After these key actions have been identified, the UI Automation control patterns that mirror the functionality and behavior of the UI element should be implemented on the control.</span></span> <span data-ttu-id="d0193-134">例如，使用者與下拉式方塊控制項的互動通常牽涉到展開和折迭下拉式方塊，以顯示或隱藏專案清單、從清單中選取專案，或透過鍵盤輸入加入新值。</span><span class="sxs-lookup"><span data-stu-id="d0193-134">For example, user interaction with a combo box control typically involves expanding and collapsing the combo box to display or hide a list of items, selecting an item from the list, or adding a new value through keyboard input.</span></span>

<span data-ttu-id="d0193-135">藉由其他協助工具模式，開發人員必須直接從個別按鈕、功能或其他控制項收集資訊。</span><span class="sxs-lookup"><span data-stu-id="d0193-135">With other accessibility models, developers must gather information directly from individual buttons, menus, or other controls.</span></span> <span data-ttu-id="d0193-136">每個控制項類型都有數十個次要變化。</span><span class="sxs-lookup"><span data-stu-id="d0193-136">Every control type comes in dozens of minor variations.</span></span> <span data-ttu-id="d0193-137">換句話說，即使按鈕的10個變化運作方式相同，且執行相同的函式，它們都必須視為唯一的控制項。</span><span class="sxs-lookup"><span data-stu-id="d0193-137">In other words, even though 10 variations of a pushbutton work the same way and perform the same function, they must all be treated as unique controls.</span></span> <span data-ttu-id="d0193-138">無法得知這些控制項是否功能對等。</span><span class="sxs-lookup"><span data-stu-id="d0193-138">There is no way to know that these controls are functionally equivalent.</span></span> <span data-ttu-id="d0193-139">已開發消費者介面自動化控制項模式來代表這些常見的控制項行為。</span><span class="sxs-lookup"><span data-stu-id="d0193-139">UI Automation control patterns were developed to represent these common control behaviors.</span></span> <span data-ttu-id="d0193-140">如需詳細資訊，請參閱 [UI Automation Control Patterns Overview](uiauto-controlpatternsoverview.md)。</span><span class="sxs-lookup"><span data-stu-id="d0193-140">For more information, see [UI Automation Control Patterns Overview](uiauto-controlpatternsoverview.md).</span></span>

<span data-ttu-id="d0193-141">如果沒有消費者介面自動化所提供之控制項模式的統一模型，測試控管和開發人員就必須有架構特定的資訊，才能在該架構中公開屬性和控制行為。</span><span class="sxs-lookup"><span data-stu-id="d0193-141">Without the unified model of control patterns provided by UI Automation, test tools and developers must have framework-specific information to expose properties and control behaviors in that framework.</span></span> <span data-ttu-id="d0193-142">因為許多不同的 UI 架構可以同時存在於 Windows 作業系統中，包括 Microsoft Win32、Windows Forms 和 Windows Presentation Foundation (WPF) ，所以使用看似類似的控制項測試多個應用程式可能會是個很困難的工作。</span><span class="sxs-lookup"><span data-stu-id="d0193-142">Because several different UI frameworks can be present at the same time in Windows operating systems, including Microsoft Win32, Windows Forms, and Windows Presentation Foundation (WPF), it can be a daunting task to test multiple applications with controls that seem similar.</span></span> <span data-ttu-id="d0193-143">例如，下表列出取出與按鈕控制項相關聯之名稱或文字所需的架構特定屬性名稱，並顯示對等的消費者介面自動化屬性。</span><span class="sxs-lookup"><span data-stu-id="d0193-143">For example, the following table lists the framework-specific property names required to retrieve the name or text associated with a button control and shows the equivalent UI Automation property.</span></span>



| <span data-ttu-id="d0193-144">控制項類型</span><span class="sxs-lookup"><span data-stu-id="d0193-144">Control type</span></span> | <span data-ttu-id="d0193-145">UI 架構</span><span class="sxs-lookup"><span data-stu-id="d0193-145">UI framework</span></span> | <span data-ttu-id="d0193-146">架構特定屬性</span><span class="sxs-lookup"><span data-stu-id="d0193-146">Framework-specific property</span></span> | <span data-ttu-id="d0193-147">消費者介面自動化屬性</span><span class="sxs-lookup"><span data-stu-id="d0193-147">UI Automation property</span></span> |
|--------------|--------------|-----------------------------|------------------------|
| <span data-ttu-id="d0193-148">按鈕</span><span class="sxs-lookup"><span data-stu-id="d0193-148">Button</span></span>       | <span data-ttu-id="d0193-149">WPF</span><span class="sxs-lookup"><span data-stu-id="d0193-149">WPF</span></span>          | <span data-ttu-id="d0193-150">Content</span><span class="sxs-lookup"><span data-stu-id="d0193-150">Content</span></span>                     | <span data-ttu-id="d0193-151">Name 屬性</span><span class="sxs-lookup"><span data-stu-id="d0193-151">Name property</span></span>          |
| <span data-ttu-id="d0193-152">按鈕</span><span class="sxs-lookup"><span data-stu-id="d0193-152">Button</span></span>       | <span data-ttu-id="d0193-153">Win32</span><span class="sxs-lookup"><span data-stu-id="d0193-153">Win32</span></span>        | <span data-ttu-id="d0193-154">標題</span><span class="sxs-lookup"><span data-stu-id="d0193-154">Caption</span></span>                     | <span data-ttu-id="d0193-155">Name 屬性</span><span class="sxs-lookup"><span data-stu-id="d0193-155">Name property</span></span>          |
| <span data-ttu-id="d0193-156">Image</span><span class="sxs-lookup"><span data-stu-id="d0193-156">Image</span></span>        | <span data-ttu-id="d0193-157">HTML</span><span class="sxs-lookup"><span data-stu-id="d0193-157">HTML</span></span>         | <span data-ttu-id="d0193-158">alt</span><span class="sxs-lookup"><span data-stu-id="d0193-158">alt</span></span>                         | <span data-ttu-id="d0193-159">Name 屬性</span><span class="sxs-lookup"><span data-stu-id="d0193-159">Name property</span></span>          |



 

<span data-ttu-id="d0193-160">消費者介面自動化提供者負責將其控制項的架構特定屬性對應至相等的消費者介面自動化屬性。</span><span class="sxs-lookup"><span data-stu-id="d0193-160">UI Automation providers are responsible for mapping the framework-specific properties of their controls to the equivalent UI Automation properties.</span></span> <span data-ttu-id="d0193-161">如需有關在提供者中執行消費者介面自動化的詳細資訊，請參閱 [消費者介面自動化提供者程式設計人員手冊](uiauto-providerportal.md)。</span><span class="sxs-lookup"><span data-stu-id="d0193-161">For information on implementing UI Automation in a provider, see [UI Automation Provider Programmer's Guide](uiauto-providerportal.md).</span></span> <span data-ttu-id="d0193-162">如需有關如何執行控制項模式的詳細資訊，請參閱實 [消費者介面自動化控制項模式](uiauto-implementinguiautocontrolpatterns.md)。</span><span class="sxs-lookup"><span data-stu-id="d0193-162">For information on implementing control patterns, see [Implementing UI Automation Control Patterns](uiauto-implementinguiautocontrolpatterns.md).</span></span>

## <a name="ui-automation-in-clients"></a><span data-ttu-id="d0193-163">用戶端中的消費者介面自動化</span><span class="sxs-lookup"><span data-stu-id="d0193-163">UI Automation in Clients</span></span>

<span data-ttu-id="d0193-164">自動化測試控管和案例的目標是可一致且可重複操作的 UI。</span><span class="sxs-lookup"><span data-stu-id="d0193-164">The goal of automated test tools and scenarios is the consistent and repeatable manipulation of the UI.</span></span> <span data-ttu-id="d0193-165">例如，這可能牽涉到單元測試特定控制項，以及記錄和執行測試腳本，以逐一查看一組控制項上的一連串泛型動作。</span><span class="sxs-lookup"><span data-stu-id="d0193-165">For example, this can involve unit testing specific controls, and recording and running test scripts that iterate through a series of generic actions on a group of controls.</span></span>

<span data-ttu-id="d0193-166">自動化應用程式的複雜之處是，將測試與動態目標同步處理的困難，例如，顯示目前正在執行之應用程式清單的清單方塊控制項（例如 Windows 工作管理員）。</span><span class="sxs-lookup"><span data-stu-id="d0193-166">A complication in automated applications is the difficulty of synchronizing a test with a dynamic target, for example, a list box control, such as Windows Task Manager, that displays a list of currently running applications.</span></span> <span data-ttu-id="d0193-167">因為清單方塊中的專案會在測試應用程式的控制項之外動態更新，所以嘗試在清單方塊中重複選取特定專案時，不可能發生任何一致性。</span><span class="sxs-lookup"><span data-stu-id="d0193-167">Because the items in the list box are dynamically updated outside the control of the test application, an attempt to repeat selecting a specific item in the list box with any consistency is impossible.</span></span> <span data-ttu-id="d0193-168">當您嘗試在測試應用程式的控制項以外的 UI 中重複簡單的焦點變更時，可能會發生類似的問題。</span><span class="sxs-lookup"><span data-stu-id="d0193-168">Similar issues can arise when attempting to repeat simple focus changes in a UI that is outside the control of the test application.</span></span>

### <a name="programmatic-access"></a><span data-ttu-id="d0193-169">程式設計存取</span><span class="sxs-lookup"><span data-stu-id="d0193-169">Programmatic Access</span></span>

<span data-ttu-id="d0193-170">程式設計存取能夠透過程式碼，模擬由傳統滑鼠和鍵盤輸入所公開的任何互動和體驗。</span><span class="sxs-lookup"><span data-stu-id="d0193-170">Programmatic access provides the ability to imitate, through code, any interaction and experience exposed by traditional mouse and keyboard input.</span></span> <span data-ttu-id="d0193-171">消費者介面自動化可透過五個元件進行程式設計存取：</span><span class="sxs-lookup"><span data-stu-id="d0193-171">UI Automation enables programmatic access through five components:</span></span>

-   <span data-ttu-id="d0193-172">消費者介面自動化樹狀結構有助於流覽 UI 的結構。</span><span class="sxs-lookup"><span data-stu-id="d0193-172">The UI Automation tree facilitates navigation through the structure of the UI.</span></span> <span data-ttu-id="d0193-173">樹狀結構是從 **HWND** 的集合所建立。</span><span class="sxs-lookup"><span data-stu-id="d0193-173">The tree is built from the collection of **HWND** s.</span></span> <span data-ttu-id="d0193-174">如需詳細資訊，請參閱 [消費者介面自動化樹狀結構總覽](uiauto-treeoverview.md)。</span><span class="sxs-lookup"><span data-stu-id="d0193-174">For more information, see [UI Automation Tree Overview](uiauto-treeoverview.md).</span></span>
-   <span data-ttu-id="d0193-175">Automation 元素是 UI 中的個別元件。</span><span class="sxs-lookup"><span data-stu-id="d0193-175">Automation elements are individual components in the UI.</span></span> <span data-ttu-id="d0193-176">這些通常可以比 **HWND** 更細微。</span><span class="sxs-lookup"><span data-stu-id="d0193-176">These can often be more granular than an **HWND**.</span></span>
-   <span data-ttu-id="d0193-177">Automation 屬性提供有關 UI 元素的特定資訊。</span><span class="sxs-lookup"><span data-stu-id="d0193-177">Automation properties provide specific information about UI elements.</span></span> <span data-ttu-id="d0193-178">如需詳細資訊，請參閱 [UI Automation Properties Overview](uiauto-propertiesoverview.md)。</span><span class="sxs-lookup"><span data-stu-id="d0193-178">For more information, see [UI Automation Properties Overview](uiauto-propertiesoverview.md).</span></span>
-   <span data-ttu-id="d0193-179">控制項模式定義控制項功能的特定層面，可以包含屬性、方法、事件和結構資訊。</span><span class="sxs-lookup"><span data-stu-id="d0193-179">Control patterns define a particular aspect of a control's functionality; they can consist of property, method, event, and structure information.</span></span> <span data-ttu-id="d0193-180">如需詳細資訊，請參閱 [UI Automation Control Patterns Overview](uiauto-controlpatternsoverview.md)。</span><span class="sxs-lookup"><span data-stu-id="d0193-180">For more information, see [UI Automation Control Patterns Overview](uiauto-controlpatternsoverview.md).</span></span>
-   <span data-ttu-id="d0193-181">自動化事件會提供事件通知和資訊。</span><span class="sxs-lookup"><span data-stu-id="d0193-181">Automation events provide event notifications and information.</span></span> <span data-ttu-id="d0193-182">如需詳細資訊，請參閱 [UI Automation Events Overview](uiauto-eventsoverview.md)。</span><span class="sxs-lookup"><span data-stu-id="d0193-182">For more information, see [UI Automation Events Overview](uiauto-eventsoverview.md).</span></span>

## <a name="key-properties-for-test-automation"></a><span data-ttu-id="d0193-183">測試自動化的主要屬性</span><span class="sxs-lookup"><span data-stu-id="d0193-183">Key Properties for Test Automation</span></span>

<span data-ttu-id="d0193-184">在 UI 中唯一識別並接著找到任何控制項的功能，可提供自動化測試應用程式在該 UI 上操作的基礎。</span><span class="sxs-lookup"><span data-stu-id="d0193-184">The ability to uniquely identify and subsequently locate any control in the UI provides the basis for automated test applications to operate on that UI.</span></span> <span data-ttu-id="d0193-185">下表說明用戶端和提供者用來識別及尋找控制項的消費者介面自動化屬性。</span><span class="sxs-lookup"><span data-stu-id="d0193-185">UI Automation properties used by clients and providers to identify and locate controls are described in the following table.</span></span>



| <span data-ttu-id="d0193-186">屬性</span><span class="sxs-lookup"><span data-stu-id="d0193-186">Property</span></span>     | <span data-ttu-id="d0193-187">描述</span><span class="sxs-lookup"><span data-stu-id="d0193-187">Description</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|--------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="d0193-188">AutomationId</span><span class="sxs-lookup"><span data-stu-id="d0193-188">AutomationId</span></span> | <span data-ttu-id="d0193-189">可唯一區分 automation 元素與其同級。</span><span class="sxs-lookup"><span data-stu-id="d0193-189">Uniquely distinguishes an automation element from its siblings.</span></span> <span data-ttu-id="d0193-190">不需要支援 AutomationId 屬性。</span><span class="sxs-lookup"><span data-stu-id="d0193-190">Support for the AutomationId property is not required.</span></span> <span data-ttu-id="d0193-191">如果有的話，在應用程式的任何實例中，專案的 AutomationId 屬性都會相同，無論當地語言為何。</span><span class="sxs-lookup"><span data-stu-id="d0193-191">When it is available, the AutomationId property of an element is the same in any instance of the application, regardless of the local language.</span></span> <span data-ttu-id="d0193-192">雖然 AutomationId 屬性在同一個同級元素之間是唯一的，但在整個桌面中可能不是唯一的。</span><span class="sxs-lookup"><span data-stu-id="d0193-192">Although the AutomationId property is unique among sibling elements, it may not be unique across the entire desktop.</span></span> <span data-ttu-id="d0193-193">例如，應用程式的多個實例或 Microsoft Windows 檔案總管中的多個資料夾檢視可能包含具有相同 AutomationIdProperty 的元素，例如 "SystemMenuBar"。</span><span class="sxs-lookup"><span data-stu-id="d0193-193">For example, multiple instances of an application, or multiple folder views in Microsoft Windows Explorer, may contain elements with the same AutomationIdProperty, such as "SystemMenuBar".</span></span> <span data-ttu-id="d0193-194">用戶端不應該針對其他應用程式所公開的 AutomationIds 做出任何假設。</span><span class="sxs-lookup"><span data-stu-id="d0193-194">Clients should make no assumptions regarding the AutomationIds exposed by other applications.</span></span> <span data-ttu-id="d0193-195">AutomationId 不保證會在應用程式的不同版本或組建之間保持穩定。</span><span class="sxs-lookup"><span data-stu-id="d0193-195">AutomationId is not guaranteed to be stable across different releases or builds of an application.</span></span> |
| <span data-ttu-id="d0193-196">ControlType</span><span class="sxs-lookup"><span data-stu-id="d0193-196">ControlType</span></span>  | <span data-ttu-id="d0193-197">識別自動化項目所代表的控制項類型。</span><span class="sxs-lookup"><span data-stu-id="d0193-197">Identifies the type of control represented by an automation element.</span></span> <span data-ttu-id="d0193-198">重要的資訊可以從對控制項類型的了解加以推斷。</span><span class="sxs-lookup"><span data-stu-id="d0193-198">Significant information can be inferred from knowledge of the control type.</span></span> <span data-ttu-id="d0193-199">如需詳細資訊，請參閱 [UI Automation Control Types Overview](uiauto-controltypesoverview.md)。</span><span class="sxs-lookup"><span data-stu-id="d0193-199">For more information, see [UI Automation Control Types Overview](uiauto-controltypesoverview.md).</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| <span data-ttu-id="d0193-200">Name</span><span class="sxs-lookup"><span data-stu-id="d0193-200">Name</span></span>         | <span data-ttu-id="d0193-201">識別或解釋 automation 元素目的的文字字串。</span><span class="sxs-lookup"><span data-stu-id="d0193-201">A text string that identifies or explains the purpose of an automation element.</span></span> <span data-ttu-id="d0193-202">它應該謹慎使用，因為它可以當地語系化。</span><span class="sxs-lookup"><span data-stu-id="d0193-202">It should be used with caution because it can be localized.</span></span> <span data-ttu-id="d0193-203">名稱屬性不是在同級之間的唯一識別碼。</span><span class="sxs-lookup"><span data-stu-id="d0193-203">The Name property is not a unique identifier among siblings.</span></span> <span data-ttu-id="d0193-204">針對測試自動化，用戶端應該改用 AutomationId 屬性或 RuntimeId 屬性。</span><span class="sxs-lookup"><span data-stu-id="d0193-204">For test automation, clients should use the AutomationId property or RuntimeId property instead.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| <span data-ttu-id="d0193-205">RuntimeId</span><span class="sxs-lookup"><span data-stu-id="d0193-205">RuntimeId</span></span>    | <span data-ttu-id="d0193-206">整數的陣列，表示 automation 元素的識別碼。</span><span class="sxs-lookup"><span data-stu-id="d0193-206">An array of integers that represent an identifier for an automation element.</span></span> <span data-ttu-id="d0193-207">識別碼在桌面上是唯一的，但保證只有產生它的桌面 UI 才是唯一的。</span><span class="sxs-lookup"><span data-stu-id="d0193-207">The identifier is unique on the desktop, but is guaranteed to be unique only to the UI of the desktop on which it was generated.</span></span> <span data-ttu-id="d0193-208">您可以在一段時間內重複使用識別碼。</span><span class="sxs-lookup"><span data-stu-id="d0193-208">Identifiers can be reused over time.</span></span> <span data-ttu-id="d0193-209">使用 [**IUIAutomation：： CompareElements**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-compareelements) 來判斷目前具有特定執行時間識別碼的元素是否為先前具有該識別碼的相同元素。</span><span class="sxs-lookup"><span data-stu-id="d0193-209">Use [**IUIAutomation::CompareElements**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-compareelements) to determine if the element that currently has a particular runtime ID is the same element that previously had that ID.</span></span> <span data-ttu-id="d0193-210">此外，RuntimeId 屬性的格式可能會變更。</span><span class="sxs-lookup"><span data-stu-id="d0193-210">Also, the format of the RuntimeId property may change.</span></span> <span data-ttu-id="d0193-211">它應該被視為不透明的值，而且只用于比較。例如，判斷 automation 元素是否在快取中。</span><span class="sxs-lookup"><span data-stu-id="d0193-211">It should be treated as an opaque value and used only for comparison; for example, to determine whether an automation element is in the cache.</span></span>                                                                                                                       |



 

## <a name="related-tools-and-technologies"></a><span data-ttu-id="d0193-212">相關工具和技術</span><span class="sxs-lookup"><span data-stu-id="d0193-212">Related Tools and Technologies</span></span>

<span data-ttu-id="d0193-213">[檢查](inspect-objects.md) (Inspect.exe) 是以 Windows 為基礎的工具，可用來收集提供者和用戶端開發和偵錯工具的消費者介面自動化資訊。</span><span class="sxs-lookup"><span data-stu-id="d0193-213">[Inspect](inspect-objects.md) (Inspect.exe) is a Windows-based tool that you can use to gather UI Automation information for provider and client development and debugging.</span></span> <span data-ttu-id="d0193-214">檢查包含在 Windows 軟體開發套件 (SDK) 中。</span><span class="sxs-lookup"><span data-stu-id="d0193-214">Inspect is included in the Windows Software Development Kit (SDK).</span></span>

## <a name="related-topics"></a><span data-ttu-id="d0193-215">相關主題</span><span class="sxs-lookup"><span data-stu-id="d0193-215">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="d0193-216">消費者介面自動化安全性考慮</span><span class="sxs-lookup"><span data-stu-id="d0193-216">UI Automation Security Considerations</span></span>](uiauto-securityoverview.md)
</dt> </dl>

 

 




