---
title: Text 和 TextRange 控制項模式
description: 描述用於執行 ITextProvider、ITextProvider2 和 ITextRangeProvider 的方針和慣例，包括屬性和方法的相關資訊。
ms.assetid: 4d541c31-11f7-4d7e-a0e0-9ed1da873d07
keywords:
- 消費者介面自動化，執行文字控制項模式
- 消費者介面自動化，執行 TextRange 控制項模式
- 消費者介面自動化，文字控制項模式
- 消費者介面自動化，TextRange 控制項模式
- 消費者介面自動化、ITextProvider
- 消費者介面自動化、ITextRangeProvider
- ITextProvider
- ITextRangeProvider
- 實消費者介面自動化的文字控制項模式
- 執行消費者介面自動化 TextRange 控制項模式
- 文字控制項模式
- TextRange 控制項模式
- 控制項模式，ITextProvider
- 控制項模式，ITextRangeProvider
- 控制項模式，執行消費者介面自動化文字
- 控制項模式，執行消費者介面自動化 TextRange
- 控制項模式、文字
- 控制項模式、TextRange
- 介面，ITextProvider
- 介面，ITextRangeProvider
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f53429dc8ec137a83b6a40db377b5c84aeb36120
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/20/2020
ms.locfileid: "104559055"
---
# <a name="text-and-textrange-control-patterns"></a><span data-ttu-id="cd447-123">Text 和 TextRange 控制項模式</span><span class="sxs-lookup"><span data-stu-id="cd447-123">Text and TextRange Control Patterns</span></span>

<span data-ttu-id="cd447-124">描述用於執行 [**ITextProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider)、 [**ITextProvider2**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-itextprovider2)和 [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider)的方針和慣例，包括屬性和方法的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="cd447-124">Describes guidelines and conventions for implementing [**ITextProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider), [**ITextProvider2**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-itextprovider2), and [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider), including information about properties and methods.</span></span> <span data-ttu-id="cd447-125">**文字** 控制項模式可讓應用程式和控制項公開簡單的文字物件模型，讓用戶端可以從以文字為基礎的控制項取出文字內容、文字屬性和内嵌物件。</span><span class="sxs-lookup"><span data-stu-id="cd447-125">The **Text** control pattern enables applications and controls to expose a simple text object model, enabling clients to retrieve textual content, text attributes, and embedded objects from text-based controls.</span></span>

<span data-ttu-id="cd447-126">為了支援 **文字** 控制項模式，控制項會執行 [**ITextProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider) 和 [**ITextProvider2**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-itextprovider2) 介面。</span><span class="sxs-lookup"><span data-stu-id="cd447-126">To support the **Text** control pattern, controls implement the [**ITextProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider) and [**ITextProvider2**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-itextprovider2) interfaces.</span></span> <span data-ttu-id="cd447-127">應該支援 **文字** 控制項模式的控制項類型包括 [編輯](uiauto-supporteditcontroltype.md) 和 [檔](uiauto-supportdocumentcontroltype.md) 控制項類型，以及任何其他可讓使用者輸入文字或選取唯讀文字的控制項類型。</span><span class="sxs-lookup"><span data-stu-id="cd447-127">Control types that should support the **Text** control pattern include the [Edit](uiauto-supporteditcontroltype.md) and [Document](uiauto-supportdocumentcontroltype.md) control types, and any other control type that enables the user to enter text or select read-only text.</span></span>

<span data-ttu-id="cd447-128">**文字** 控制項模式可以與其他 Microsoft 消費者介面自動化控制項模式搭配使用，以支援文字中的數種類型的内嵌物件，包括資料表、超連結和命令按鈕。</span><span class="sxs-lookup"><span data-stu-id="cd447-128">The **Text** control pattern can be used with other Microsoft UI Automation control patterns to support several types of embedded objects in the text, including tables, hyperlinks, and command buttons.</span></span>

<span data-ttu-id="cd447-129">[**ITextProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider)和 [**ITextProvider2**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-itextprovider2)介面包含一些用來取得文字範圍的方法。</span><span class="sxs-lookup"><span data-stu-id="cd447-129">The [**ITextProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider) and [**ITextProvider2**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-itextprovider2) interfaces include a number of methods for acquiring text ranges.</span></span> <span data-ttu-id="cd447-130">*文字範圍* 是一種物件，代表文字容器中連續的文字範圍（或多個不連續的文字範圍）。</span><span class="sxs-lookup"><span data-stu-id="cd447-130">A *text range* is an object that represents a contiguous span of text—or multiple, disjoint spans of text—in a text container.</span></span> <span data-ttu-id="cd447-131">其中一個 **ITextProvider** 方法會取得代表整份檔的文字範圍，而有些則會取得代表檔某部分的文字範圍，例如選取的文字、可見的文字或內嵌于文字中的物件。</span><span class="sxs-lookup"><span data-stu-id="cd447-131">One **ITextProvider** method acquires a text range that represents the entire document, while others acquire text ranges that represent some portion of the document, such as the selected text, the visible text, or an object embedded in the text.</span></span>

<span data-ttu-id="cd447-132">文字範圍物件是透過 [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider)介面所實作為的 **TextRange** 控制項模式來表示。</span><span class="sxs-lookup"><span data-stu-id="cd447-132">A text range object is represented by the **TextRange** control pattern, which is implemented through the [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) interface.</span></span> <span data-ttu-id="cd447-133">**TextRange** 控制項模式提供了方法和屬性，可用來公開範圍內文字的相關資訊、移動範圍的端點、選取或取消選取文字、將範圍滾動到視野等等。</span><span class="sxs-lookup"><span data-stu-id="cd447-133">The **TextRange** control pattern provides methods and properties used to expose information about the text in the range, move the endpoints of the range, select or deselect text, scroll the range into view, and so on.</span></span>

<span data-ttu-id="cd447-134">如需 **Text** 和 **TextRange** 控制項模式的詳細資訊，請參閱 [消費者介面自動化文字內容支援](uiauto-ui-automation-textpattern-overview.md)。</span><span class="sxs-lookup"><span data-stu-id="cd447-134">For more information about the **Text** and **TextRange** control patterns, see [UI Automation Support for Textual Content](uiauto-ui-automation-textpattern-overview.md).</span></span>

<span data-ttu-id="cd447-135">從 Windows 8.1 提供者開始可以執行 [**ITextRangeProvider2**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider2) 介面。</span><span class="sxs-lookup"><span data-stu-id="cd447-135">Starting with Windows 8.1 providers can implement the [**ITextRangeProvider2**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider2) interface.</span></span> <span data-ttu-id="cd447-136">這可讓您叫用與文字範圍相關聯的內容功能表。</span><span class="sxs-lookup"><span data-stu-id="cd447-136">This enables invoking context menus that are associated with a text range.</span></span> <span data-ttu-id="cd447-137">這可支援文字自動校正或輸入法編輯器等案例 (IME) 候選項目選取專案。</span><span class="sxs-lookup"><span data-stu-id="cd447-137">This supports scenarios such as text autocorrection or Input Method Editor (IME) candidate selection.</span></span>

<span data-ttu-id="cd447-138">本主題包含下列各節。</span><span class="sxs-lookup"><span data-stu-id="cd447-138">This topic contains the following sections.</span></span>

-   [<span data-ttu-id="cd447-139">實作方針和慣例</span><span class="sxs-lookup"><span data-stu-id="cd447-139">Implementation Guidelines and Conventions</span></span>](#implementation-guidelines-and-conventions)
-   [<span data-ttu-id="cd447-140">**ITextProvider** 的必要成員</span><span class="sxs-lookup"><span data-stu-id="cd447-140">Required Members for **ITextProvider**</span></span>](#required-members-for-itextprovider)
-   [<span data-ttu-id="cd447-141">**ITextRangeProvider** 的必要成員</span><span class="sxs-lookup"><span data-stu-id="cd447-141">Required Members for **ITextRangeProvider**</span></span>](#required-members-for-itextrangeprovider)
-   [<span data-ttu-id="cd447-142">支援文字範圍</span><span class="sxs-lookup"><span data-stu-id="cd447-142">Supporting Text Ranges</span></span>](#supporting-text-ranges)
    -   [<span data-ttu-id="cd447-143">依文字單位操作文字範圍</span><span class="sxs-lookup"><span data-stu-id="cd447-143">Manipulating a Text Range by Text Unit</span></span>](#manipulating-a-text-range-by-text-unit)
    -   [<span data-ttu-id="cd447-144">選取文字範圍中的文字</span><span class="sxs-lookup"><span data-stu-id="cd447-144">Selecting Text in a Text Range</span></span>](#selecting-text-in-a-text-range)
    -   [<span data-ttu-id="cd447-145">從文字範圍取得文字</span><span class="sxs-lookup"><span data-stu-id="cd447-145">Acquiring Text from a Text Range</span></span>](#acquiring-text-from-a-text-range)
    -   [<span data-ttu-id="cd447-146">執行 ShowCoNtextMenu</span><span class="sxs-lookup"><span data-stu-id="cd447-146">Implementing ShowContextMenu</span></span>](#implementing-showcontextmenu)
-   [<span data-ttu-id="cd447-147">與系統插入點的互通性</span><span class="sxs-lookup"><span data-stu-id="cd447-147">Interoperability with the System Caret</span></span>](#interoperability-with-the-system-caret)
-   [<span data-ttu-id="cd447-148">相關主題</span><span class="sxs-lookup"><span data-stu-id="cd447-148">Related topics</span></span>](#related-topics)

## <a name="implementation-guidelines-and-conventions"></a><span data-ttu-id="cd447-149">實作方針和慣例</span><span class="sxs-lookup"><span data-stu-id="cd447-149">Implementation Guidelines and Conventions</span></span>

<span data-ttu-id="cd447-150">在執行 **文字** 控制項模式時，請注意下列方針和慣例：</span><span class="sxs-lookup"><span data-stu-id="cd447-150">When implementing the **Text** control pattern, note the following guidelines and conventions:</span></span>

-   <span data-ttu-id="cd447-151">任何可存取文字 (例如輸入文字或選取唯讀文字) 的控制項都應該支援 **文字** 控制項模式。</span><span class="sxs-lookup"><span data-stu-id="cd447-151">Any control that enables access to text (for example, entering text or selecting read-only text) should support the **Text** control pattern.</span></span>
-   <span data-ttu-id="cd447-152">**文字** 控制項模式可以與任何呈現文字的 UI 元素搭配使用，甚至是標準按鈕控制項上的靜態標籤。</span><span class="sxs-lookup"><span data-stu-id="cd447-152">The **Text** control pattern can be used with any UI element that presents text, even a static label on a standard button control.</span></span> <span data-ttu-id="cd447-153">但是，無法選取或沒有插入點的靜態文字控制項則不需要它。</span><span class="sxs-lookup"><span data-stu-id="cd447-153">However, it is not required on static text controls that cannot be selected or do not have an insertion point.</span></span>
-   <span data-ttu-id="cd447-154">為了確保文字可以完全存取，執行 [**ITextProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider) 的控制項也應該支援 [**IValueProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-ivalueprovider) 介面。</span><span class="sxs-lookup"><span data-stu-id="cd447-154">To ensure that text is fully accessible, controls that implement [**ITextProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider) should also support the [**IValueProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-ivalueprovider) interface.</span></span> <span data-ttu-id="cd447-155">**IValueProvider** 可提供程式設計方式來變更文字，以補充 **ITextProvider** 。</span><span class="sxs-lookup"><span data-stu-id="cd447-155">**IValueProvider** complements **ITextProvider** by providing a programmatic way to change the text.</span></span> <span data-ttu-id="cd447-156">它也提供與輔助技術用戶端應用程式更高的相容性，包括以舊版技術（例如 Microsoft Active Accessibility）為基礎的應用程式。</span><span class="sxs-lookup"><span data-stu-id="cd447-156">It also offers greater compatibility with assistive technology client applications, including those based on legacy technologies such as Microsoft Active Accessibility.</span></span> <span data-ttu-id="cd447-157">當兩個控制項模式都執行時 **，TextChanged** 事件 ([**UIA \_ Text \_ TextChangedEventId**](uiauto-event-ids.md)) 和 **AutomationPropertyChanged** event ([**UIA \_ AutomationPropertyChangedEventId**](uiauto-event-ids.md)) 等同于 **Value** 屬性 ([**UIA \_ ValueValuePropertyId**](uiauto-control-pattern-propids.md)) 。</span><span class="sxs-lookup"><span data-stu-id="cd447-157">When both control patterns are implemented, the **TextChanged** event ([**UIA\_Text\_TextChangedEventId**](uiauto-event-ids.md)) and **AutomationPropertyChanged** event ([**UIA\_AutomationPropertyChangedEventId**](uiauto-event-ids.md)) are equivalent for the **Value** property ([**UIA\_ValueValuePropertyId**](uiauto-control-pattern-propids.md)).</span></span> <span data-ttu-id="cd447-158">必須同時支援這兩個事件。</span><span class="sxs-lookup"><span data-stu-id="cd447-158">Both events must be supported.</span></span>
-   <span data-ttu-id="cd447-159">**文字** 控制項模式僅支援一個文字資料流程和一個控制項的一個區。</span><span class="sxs-lookup"><span data-stu-id="cd447-159">The **Text** control pattern supports only one stream of text and one viewport per control.</span></span> <span data-ttu-id="cd447-160">如果應用程式在窗格中提供多個檔的視圖，每個 view (控制項) 應該獨立支援 [**ITextProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider) 。</span><span class="sxs-lookup"><span data-stu-id="cd447-160">If the application offers multiple views of document in panes, each view (control) should support [**ITextProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider) independently.</span></span>
-   <span data-ttu-id="cd447-161">[**ITextProvider：： GetSelection**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-getselection)方法可能會傳回單一文字範圍，代表目前選取的文字。</span><span class="sxs-lookup"><span data-stu-id="cd447-161">The [**ITextProvider::GetSelection**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-getselection) method may return a single text range representing the currently selected text.</span></span> <span data-ttu-id="cd447-162">如果控制項支援選取多個非連續的文字範圍， **GetSelection** 方法應該會傳回陣列，其中包含每個所選文字範圍的一個 [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) 介面。</span><span class="sxs-lookup"><span data-stu-id="cd447-162">If a control supports the selection of multiple, noncontiguous spans of text, the **GetSelection** method should return an array that contains one [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) interface for each selected span of text.</span></span>
-   <span data-ttu-id="cd447-163">**文字** 控制項模式將插入點表示為退化 (空白) 文字範圍。</span><span class="sxs-lookup"><span data-stu-id="cd447-163">The **Text** control pattern represents the insertion point as a degenerate (empty) text range.</span></span> <span data-ttu-id="cd447-164">當插入點存在且未選取任何文字時， [**ITextProvider：： GetSelection**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-getselection) 方法應該會傳回退化文字範圍。</span><span class="sxs-lookup"><span data-stu-id="cd447-164">The [**ITextProvider::GetSelection**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-getselection) method should return a degenerate text range when the insertion point exists and no text is selected.</span></span> <span data-ttu-id="cd447-165">如需詳細資訊，請參閱 [與系統插入號的互通性](#interoperability-with-the-system-caret)。</span><span class="sxs-lookup"><span data-stu-id="cd447-165">For more information, see [Interoperability with the System Caret](#interoperability-with-the-system-caret).</span></span>
-   <span data-ttu-id="cd447-166">[**ITextProvider：： GetVisibleRanges**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-getvisibleranges)方法可能會在區域中看到連續的文字範圍時傳回單一文字範圍，或者，它可能會傳回不相鄰文字範圍的陣列，代表多個部分可見的文字行。</span><span class="sxs-lookup"><span data-stu-id="cd447-166">The [**ITextProvider::GetVisibleRanges**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-getvisibleranges) method may return a single text range if a contiguous range of text is visible in the viewport, or it may return an array of disjoint text ranges representing multiple, partially visible lines of text.</span></span>
-   <span data-ttu-id="cd447-167">如果子項目未包含任何文字， [**ITextProvider：： RangeFromChild**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-rangefromchild) 方法應該會傳回一個退化範圍。</span><span class="sxs-lookup"><span data-stu-id="cd447-167">The [**ITextProvider::RangeFromChild**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-rangefromchild) method should return a degenerate range if the child element contains no text.</span></span> <span data-ttu-id="cd447-168">因為内嵌物件可以包含文字，所以 **RangeFromChild** 方法不一定會傳回退化文字範圍。</span><span class="sxs-lookup"><span data-stu-id="cd447-168">Because an embedded object can include text, the **RangeFromChild** method may not always return a degenerate text range.</span></span> <span data-ttu-id="cd447-169">如需詳細資訊，請參閱 [消費者介面自動化如何公開内嵌物件](uiauto-textpattern-and-embedded-objects-overview.md)。</span><span class="sxs-lookup"><span data-stu-id="cd447-169">For more information, see [How UI Automation Exposes Embedded Objects](uiauto-textpattern-and-embedded-objects-overview.md).</span></span>
-   <span data-ttu-id="cd447-170">[**ITextProvider：： RangeFromPoint**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-rangefrompoint)方法會使用指定的螢幕座標，在檔區域中執行點擊測試。</span><span class="sxs-lookup"><span data-stu-id="cd447-170">The [**ITextProvider::RangeFromPoint**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-rangefrompoint) method performs hit testing in the document area using the specified screen coordinates.</span></span> <span data-ttu-id="cd447-171">產生的文字範圍應該與插入點或選取專案一致，因為在指定的螢幕座標上按一下位置會產生此結果。</span><span class="sxs-lookup"><span data-stu-id="cd447-171">The resulting text range should be consistent with the insertion point or selection that would result from clicking the location at the specified screen coordinates.</span></span> <span data-ttu-id="cd447-172">例如，如果影像位於指定的螢幕座標，則產生的文字範圍應該與 [**ITextProvider：： RangeFromChild**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-rangefromchild) 方法為影像取得的文字範圍相同。</span><span class="sxs-lookup"><span data-stu-id="cd447-172">For example, if an image resides at the specified screen coordinates, the resulting text range should be the same as the text range that the [**ITextProvider::RangeFromChild**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-rangefromchild) method would acquire for the image.</span></span> <span data-ttu-id="cd447-173">同樣地，如果用戶端應用程式要求系統插入點中央位置的文字範圍 (插入點) ，則產生的文字範圍應該與系統插入點位置相同。</span><span class="sxs-lookup"><span data-stu-id="cd447-173">Similarly, if a client application requests a text range for the location at the center of the system caret (the insertion point), the resulting text range should be the same as the system caret location.</span></span>
-   <span data-ttu-id="cd447-174">[**ITextProvider：:D ocumentrange**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-get_documentrange)屬性應該一律提供文字範圍，其中包含對應的 [**ITextProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider)執行所支援的所有文字。</span><span class="sxs-lookup"><span data-stu-id="cd447-174">The [**ITextProvider::DocumentRange**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-get_documentrange) property should always provide a text range that includes all of the text supported by the corresponding [**ITextProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider) implementation.</span></span>
-   <span data-ttu-id="cd447-175">[**UIA \_ 文字 \_ TextChangedEventId**](uiauto-event-ids.md)事件必須在任何文字變更發生之後引發，即使在隱藏區中看不到變更。</span><span class="sxs-lookup"><span data-stu-id="cd447-175">The [**UIA\_Text\_TextChangedEventId**](uiauto-event-ids.md) event must be raised after any text change occurs, even if the change is not visible in the viewport.</span></span> <span data-ttu-id="cd447-176">例如，提供者應該引發事件，即使使用者在選取的文字上貼上完全相同的文字也是一樣。</span><span class="sxs-lookup"><span data-stu-id="cd447-176">For example, the provider should raise the event even if the user pastes the exact same text over the selected text.</span></span>
-   <span data-ttu-id="cd447-177">[**UIA \_ 文字 \_ TextSelectionChangedEventId**](uiauto-event-ids.md)必須在選取文字變更時引發，或每次插入點 (插入點) 在文字之間移動時引發。</span><span class="sxs-lookup"><span data-stu-id="cd447-177">The [**UIA\_Text\_TextSelectionChangedEventId**](uiauto-event-ids.md) must be raised whenever the selection of text changes, or whenever the insertion point (caret) moves among the text.</span></span>

<span data-ttu-id="cd447-178">在執行 **TextRange** 控制項模式時，請注意下列方針和慣例：</span><span class="sxs-lookup"><span data-stu-id="cd447-178">When implementing the **TextRange** control pattern, note the following guidelines and conventions:</span></span>

-   <span data-ttu-id="cd447-179">**TextRange** 控制項模式的所有方法都應該執行文字作業，不論文字的可見度狀態為何。</span><span class="sxs-lookup"><span data-stu-id="cd447-179">All methods of the **TextRange** control pattern should perform text operations regardless of the visibility state of the text.</span></span> <span data-ttu-id="cd447-180">您可以藉由查詢 **IsHidden** text 屬性 ([**UIA \_ IsHiddenAttributeId**](uiauto-textattribute-ids.md)) 來判斷文字範圍的可見度。</span><span class="sxs-lookup"><span data-stu-id="cd447-180">The visibility of a text range can always be determined by querying the **IsHidden** text attribute ([**UIA\_IsHiddenAttributeId**](uiauto-textattribute-ids.md)).</span></span>
-   <span data-ttu-id="cd447-181">如果可能，提供者應該確保任何文字變更（例如刪除、插入和移動）都會反映在相關聯的文字範圍物件中， ([**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) 介面的實例) 並引發 [**UIA 的 \_ 文字 \_ TextChangedEventId**](uiauto-event-ids.md) 事件。</span><span class="sxs-lookup"><span data-stu-id="cd447-181">If possible, a provider should ensure that any text changes, such as deletions, insertions, and moves, are reflected in the associated text range objects (instances of [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) interface) and raise a [**UIA\_Text\_TextChangedEventId**](uiauto-event-ids.md) event.</span></span> <span data-ttu-id="cd447-182">用戶端可以使用事件做為提示來確認編輯控制項文字的編輯變更。</span><span class="sxs-lookup"><span data-stu-id="cd447-182">Clients may use the event as a hint to confirm editorial changes made to the text of a control.</span></span>
-   <span data-ttu-id="cd447-183">[**ITextRangeProvider：： Compare**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-compare)、 [**CompareEndpoints**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-compareendpoints)和 [**MoveEndpointByRange**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-moveendpointbyrange)方法所使用的所有文字範圍物件都必須是相同的 **文字** 控制項模式執行的對等。</span><span class="sxs-lookup"><span data-stu-id="cd447-183">All of the text range objects used by the [**ITextRangeProvider::Compare**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-compare), [**CompareEndpoints**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-compareendpoints), and [**MoveEndpointByRange**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-moveendpointbyrange) methods must be peers of the same **Text** control pattern implementation.</span></span>
-   <span data-ttu-id="cd447-184">雖然並非必要，但 [**ITextRangeProvider：： CompareEndpoints**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-compareendpoints)方法所抓取的 *pRetVal* 值可以指出兩個端點之間的距離（以字元為單位 ([**TextUnit \_ 字元**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit)) ）。</span><span class="sxs-lookup"><span data-stu-id="cd447-184">Although not required, the *pRetVal* value retrieved by the [**ITextRangeProvider::CompareEndpoints**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-compareendpoints) method can indicate the distance, in characters ([**TextUnit\_Character**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit)), between the two endpoints.</span></span> <span data-ttu-id="cd447-185">不過，用戶端應用程式不應該依賴 *pRetVal* 的精確度，而不是其正值或負數值。</span><span class="sxs-lookup"><span data-stu-id="cd447-185">However, client applications should not depend on the accuracy of *pRetVal* beyond its positive or negative value.</span></span>
-   <span data-ttu-id="cd447-186">[**ITextRangeProvider：： ExpandToEnclosingUnit**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-expandtoenclosingunit)、 [**Move**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-move)和 [**MoveEndpointByUnit**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-moveendpointbyunit)方法需要仔細考慮指定的文字單位。</span><span class="sxs-lookup"><span data-stu-id="cd447-186">The [**ITextRangeProvider::ExpandToEnclosingUnit**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-expandtoenclosingunit), [**Move**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-move), and [**MoveEndpointByUnit**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-moveendpointbyunit) methods require careful consideration of the specified text unit.</span></span> <span data-ttu-id="cd447-187">如需詳細資訊，請參閱依文字單位操作 TextRange。</span><span class="sxs-lookup"><span data-stu-id="cd447-187">For more information, see Manipulating a TextRange by Text Unit.</span></span>
-   <span data-ttu-id="cd447-188">如需與 [**ITextRangeProvider：： Select**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-select)、 [**AddToSelection**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-addtoselection)和 [**RemoveFromSelection**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-removefromselection) 方法相關的實作需求，請參閱選取文字範圍中的文字。</span><span class="sxs-lookup"><span data-stu-id="cd447-188">For implementation requirements related to the [**ITextRangeProvider::Select**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-select), [**AddToSelection**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-addtoselection), and [**RemoveFromSelection**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-removefromselection) methods, see Selecting Text in a Text Range.</span></span>
-   <span data-ttu-id="cd447-189">[**ITextRangeProvider：： FindText**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-findtext)和 [**FindAttribute**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-findattribute)方法會針對單一相符的文字字串或文字屬性向前或向後搜尋。</span><span class="sxs-lookup"><span data-stu-id="cd447-189">The [**ITextRangeProvider::FindText**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-findtext) and [**FindAttribute**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-findattribute) methods search forward or backward for a single matching text string or text attribute.</span></span> <span data-ttu-id="cd447-190">如果找不到相符項，則應該傳回 **Null** 。</span><span class="sxs-lookup"><span data-stu-id="cd447-190">They should return **NULL** if no match is found.</span></span>
-   <span data-ttu-id="cd447-191">如果相關聯的屬性在範圍內，或是文字控制項不支援屬性，則 [**ITextRangeProvider：： GetAttributeValue**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-getattributevalue) 方法必須傳回從 [**UiaGetReservedMixedAttributeValue**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiagetreservedmixedattributevalue) 或 [**UiaGetReservedNotSupportedValue**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiagetreservednotsupportedvalue) 函數取得的位址。</span><span class="sxs-lookup"><span data-stu-id="cd447-191">The [**ITextRangeProvider::GetAttributeValue**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-getattributevalue) method must return the address acquired from the [**UiaGetReservedMixedAttributeValue**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiagetreservedmixedattributevalue) or [**UiaGetReservedNotSupportedValue**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiagetreservednotsupportedvalue) function if the associated attribute varies in the range, or if the attribute is not supported by the text control.</span></span> <span data-ttu-id="cd447-192">**TextRange** 控制項模式規格不允許加入新的文字屬性識別碼或變更現有屬性的定義方式。</span><span class="sxs-lookup"><span data-stu-id="cd447-192">The **TextRange** control pattern specification does not allow adding new text-attribute identifiers or changing how the existing attributes are defined.</span></span>
-   <span data-ttu-id="cd447-193">可能的話， [**ITextRangeProvider：： GetBoundingRectangles**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-getboundingrectangles) 方法應該會傳回陣列，其中包含文字範圍中每一個完整或部分可見的文字行的周框。</span><span class="sxs-lookup"><span data-stu-id="cd447-193">If possible, the [**ITextRangeProvider::GetBoundingRectangles**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-getboundingrectangles) method should return an array that contains one bounding rectangle for each fully or partially visible line of text in a text range.</span></span> <span data-ttu-id="cd447-194">如果無法這麼做，則提供者可以傳回陣列，其中包含只有全可見行的周框矩形;不過，這會限制用戶端應用程式能夠準確描述螢幕上文字的呈現方式。</span><span class="sxs-lookup"><span data-stu-id="cd447-194">If this is not possible, the provider can return an array that contains the bounding rectangles of only fully visible lines; however, this limits a client application's ability to accurately describe how the text is being presented on the screen.</span></span>
-   <span data-ttu-id="cd447-195">[**ITextRangeProvider：： GetChildren**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-getchildren)方法應該會傳回內嵌于文字範圍中的所有子項目，但不需要傳回子項目的任何子系。</span><span class="sxs-lookup"><span data-stu-id="cd447-195">The [**ITextRangeProvider::GetChildren**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-getchildren) method should return all child elements embedded in a text range, but it does not need to return any children of the child elements.</span></span> <span data-ttu-id="cd447-196">例如，如果文字範圍包含的資料表具有多個子儲存格，則 **GetChildren** 方法可能只會傳回 table 元素，而不會傳回資料格元素。</span><span class="sxs-lookup"><span data-stu-id="cd447-196">For example, if a text range contains a table that has a number of child cells, the **GetChildren** method may return just the table element and not the cell elements.</span></span> <span data-ttu-id="cd447-197">基於效能或架構原因，提供者可能無法公開自動化樹狀結構中的檔所裝載的所有内嵌物件。</span><span class="sxs-lookup"><span data-stu-id="cd447-197">For performance or architectural reasons, a provider may not be able to expose all embedded objects that are hosted in a document in the automation tree.</span></span> <span data-ttu-id="cd447-198">在此情況下，提供者至少應該支援透過 **GetChildren** 方法來列舉子物件，而在選項中，則是支援解除虛擬化支援的 [VirtualizedItem](uiauto-implementingvirtualizeditem.md) 控制項模式。</span><span class="sxs-lookup"><span data-stu-id="cd447-198">In this case, the provider should at least support the enumerating of child objects through the **GetChildren** method and, as an option, support the [VirtualizedItem](uiauto-implementingvirtualizeditem.md) control pattern for de-virtualization support.</span></span>
-   <span data-ttu-id="cd447-199">[**ITextRangeProvider：： GetEnclosingElement**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-getenclosingelement)方法通常會傳回提供文字範圍的文字提供者。</span><span class="sxs-lookup"><span data-stu-id="cd447-199">The [**ITextRangeProvider::GetEnclosingElement**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-getenclosingelement) method typically returns the text provider that supplies the text range.</span></span> <span data-ttu-id="cd447-200">但是，如果文字提供者支援子物件（例如資料表或超連結），封入專案可以是文字提供者的子代。</span><span class="sxs-lookup"><span data-stu-id="cd447-200">However, if the text provider supports child objects such as tables or hyperlinks, the enclosing element could be a descendant of the text provider.</span></span> <span data-ttu-id="cd447-201">**GetEnclosingElement** 所傳回的元素應該是最接近指定文字範圍的專案。</span><span class="sxs-lookup"><span data-stu-id="cd447-201">The element returned by **GetEnclosingElement** should be the element closest to the given text range.</span></span> <span data-ttu-id="cd447-202">例如，如果文字範圍是在資料表的資料格中， **GetEnclosingElement** 應該會傳回包含資料格，而不是 table 元素。</span><span class="sxs-lookup"><span data-stu-id="cd447-202">For example, if the text range is in a cell of a table, **GetEnclosingElement** should return the containing cell instead of the table element.</span></span>
-   <span data-ttu-id="cd447-203">[**ITextRangeProvider：： GetText**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-gettext)方法應該會傳回範圍中的純文字。</span><span class="sxs-lookup"><span data-stu-id="cd447-203">The [**ITextRangeProvider::GetText**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-gettext) method should return the plain text in the range.</span></span> <span data-ttu-id="cd447-204">如需詳細資訊，請參閱從文字範圍取得文字。</span><span class="sxs-lookup"><span data-stu-id="cd447-204">For more information, see Acquiring Text from a Text Range.</span></span>
-   <span data-ttu-id="cd447-205">呼叫 [**ITextRangeProvider：： ScrollIntoView**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-scrollintoview) 應該將文字控制項的視口中的文字對齊，如 *alignToTop* 參數所指定。</span><span class="sxs-lookup"><span data-stu-id="cd447-205">Calling [**ITextRangeProvider::ScrollIntoView**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-scrollintoview) should align the text in the viewport of the text control as specified by the *alignToTop* parameter.</span></span> <span data-ttu-id="cd447-206">雖然水準對齊沒有任何需求，但是文字範圍應該會以水準和垂直方式顯示。</span><span class="sxs-lookup"><span data-stu-id="cd447-206">Although there is no requirement in terms of horizontal alignment, the text range should be visible both horizontally and vertically.</span></span> <span data-ttu-id="cd447-207">評估 *alignToTop* 參數時，提供者必須考慮文字控制項的方向和文字的流程方向。</span><span class="sxs-lookup"><span data-stu-id="cd447-207">When evaluating the *alignToTop* parameter, a provider must take into account the orientation of the text control and the flow direction of the text.</span></span> <span data-ttu-id="cd447-208">例如，如果 *alignToTop* 為 **TRUE** ，代表包含由右至左流動之文字的垂直方向文字控制項，則提供者應該將文字範圍對齊至區域的右側。</span><span class="sxs-lookup"><span data-stu-id="cd447-208">For example, if *alignToTop* is **TRUE** for a vertically oriented text control containing text that flows from right to left, the provider should align the text range with the right side of the viewport.</span></span>
-   <span data-ttu-id="cd447-209">當您透過 [**TextUnit \_ 線**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit)移動檔時，如果文字範圍輸入了內嵌的表格，則資料格中的每一行文字都應該視為線條。</span><span class="sxs-lookup"><span data-stu-id="cd447-209">When moving through a document by [**TextUnit\_Line**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit), if the text range enters an embedded table, each line of text in a cell should be treated as a line.</span></span>

## <a name="required-members-for-itextprovider"></a><span data-ttu-id="cd447-210">**ITextProvider** 的必要成員</span><span class="sxs-lookup"><span data-stu-id="cd447-210">Required Members for **ITextProvider**</span></span>

<span data-ttu-id="cd447-211">執行 [**ITextProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider) 介面需要下列屬性和方法。</span><span class="sxs-lookup"><span data-stu-id="cd447-211">The following properties and methods are required for implementing the [**ITextProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider) interface.</span></span>



| <span data-ttu-id="cd447-212">必要成員</span><span class="sxs-lookup"><span data-stu-id="cd447-212">Required members</span></span>                                                                                        | <span data-ttu-id="cd447-213">成員類型</span><span class="sxs-lookup"><span data-stu-id="cd447-213">Member type</span></span> | <span data-ttu-id="cd447-214">備註</span><span class="sxs-lookup"><span data-stu-id="cd447-214">Notes</span></span> |
|---------------------------------------------------------------------------------------------------------|-------------|-------|
| [<span data-ttu-id="cd447-215">**DocumentRange**</span><span class="sxs-lookup"><span data-stu-id="cd447-215">**DocumentRange**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-get_documentrange)                                             | <span data-ttu-id="cd447-216">屬性</span><span class="sxs-lookup"><span data-stu-id="cd447-216">Property</span></span>    | <span data-ttu-id="cd447-217">無</span><span class="sxs-lookup"><span data-stu-id="cd447-217">None</span></span>  |
| [<span data-ttu-id="cd447-218">**SupportedTextSelection**</span><span class="sxs-lookup"><span data-stu-id="cd447-218">**SupportedTextSelection**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-get_supportedtextselection)                           | <span data-ttu-id="cd447-219">屬性</span><span class="sxs-lookup"><span data-stu-id="cd447-219">Property</span></span>    | <span data-ttu-id="cd447-220">無</span><span class="sxs-lookup"><span data-stu-id="cd447-220">None</span></span>  |
| [<span data-ttu-id="cd447-221">**GetSelection**</span><span class="sxs-lookup"><span data-stu-id="cd447-221">**GetSelection**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-getselection)                                               | <span data-ttu-id="cd447-222">方法</span><span class="sxs-lookup"><span data-stu-id="cd447-222">Method</span></span>      | <span data-ttu-id="cd447-223">無</span><span class="sxs-lookup"><span data-stu-id="cd447-223">None</span></span>  |
| [<span data-ttu-id="cd447-224">**GetVisibleRanges**</span><span class="sxs-lookup"><span data-stu-id="cd447-224">**GetVisibleRanges**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-getvisibleranges)                                       | <span data-ttu-id="cd447-225">方法</span><span class="sxs-lookup"><span data-stu-id="cd447-225">Method</span></span>      | <span data-ttu-id="cd447-226">無</span><span class="sxs-lookup"><span data-stu-id="cd447-226">None</span></span>  |
| [<span data-ttu-id="cd447-227">**RangeFromChild**</span><span class="sxs-lookup"><span data-stu-id="cd447-227">**RangeFromChild**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-rangefromchild)                                           | <span data-ttu-id="cd447-228">方法</span><span class="sxs-lookup"><span data-stu-id="cd447-228">Method</span></span>      | <span data-ttu-id="cd447-229">無</span><span class="sxs-lookup"><span data-stu-id="cd447-229">None</span></span>  |
| [<span data-ttu-id="cd447-230">**RangeFromPoint**</span><span class="sxs-lookup"><span data-stu-id="cd447-230">**RangeFromPoint**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-rangefrompoint)                                           | <span data-ttu-id="cd447-231">方法</span><span class="sxs-lookup"><span data-stu-id="cd447-231">Method</span></span>      | <span data-ttu-id="cd447-232">無</span><span class="sxs-lookup"><span data-stu-id="cd447-232">None</span></span>  |
| [<span data-ttu-id="cd447-233">**UIA \_ 文字 \_ TextChangedEventId**</span><span class="sxs-lookup"><span data-stu-id="cd447-233">**UIA\_Text\_TextChangedEventId**</span></span>](uiauto-event-ids.md)                   | <span data-ttu-id="cd447-234">事件</span><span class="sxs-lookup"><span data-stu-id="cd447-234">Event</span></span>       | <span data-ttu-id="cd447-235">無</span><span class="sxs-lookup"><span data-stu-id="cd447-235">None</span></span>  |
| [<span data-ttu-id="cd447-236">**UIA \_ 文字 \_ TextSelectionChangedEventId**</span><span class="sxs-lookup"><span data-stu-id="cd447-236">**UIA\_Text\_TextSelectionChangedEventId**</span></span>](uiauto-event-ids.md) | <span data-ttu-id="cd447-237">事件</span><span class="sxs-lookup"><span data-stu-id="cd447-237">Event</span></span>       | <span data-ttu-id="cd447-238">無</span><span class="sxs-lookup"><span data-stu-id="cd447-238">None</span></span>  |



 

<span data-ttu-id="cd447-239">執行 [**ITextProvider2**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-itextprovider2) 介面需要下列其他屬性和方法。</span><span class="sxs-lookup"><span data-stu-id="cd447-239">The following additional properties and methods are required for implementing the [**ITextProvider2**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-itextprovider2) interface.</span></span>



| <span data-ttu-id="cd447-240">必要成員</span><span class="sxs-lookup"><span data-stu-id="cd447-240">Required members</span></span>                                                         | <span data-ttu-id="cd447-241">成員類型</span><span class="sxs-lookup"><span data-stu-id="cd447-241">Member type</span></span> | <span data-ttu-id="cd447-242">備註</span><span class="sxs-lookup"><span data-stu-id="cd447-242">Notes</span></span> |
|--------------------------------------------------------------------------|-------------|-------|
| [<span data-ttu-id="cd447-243">**GetCaretRange**</span><span class="sxs-lookup"><span data-stu-id="cd447-243">**GetCaretRange**</span></span>](/windows/desktop/api/uiautomationcore/nf-uiautomationcore-itextprovider2-getcaretrange)         | <span data-ttu-id="cd447-244">方法</span><span class="sxs-lookup"><span data-stu-id="cd447-244">Method</span></span>      | <span data-ttu-id="cd447-245">無</span><span class="sxs-lookup"><span data-stu-id="cd447-245">None</span></span>  |
| [<span data-ttu-id="cd447-246">**RangeFromAnnotation**</span><span class="sxs-lookup"><span data-stu-id="cd447-246">**RangeFromAnnotation**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider2-rangefromannotation) | <span data-ttu-id="cd447-247">方法</span><span class="sxs-lookup"><span data-stu-id="cd447-247">Method</span></span>      | <span data-ttu-id="cd447-248">無</span><span class="sxs-lookup"><span data-stu-id="cd447-248">None</span></span>  |



 

## <a name="required-members-for-itextrangeprovider"></a><span data-ttu-id="cd447-249">**ITextRangeProvider** 的必要成員</span><span class="sxs-lookup"><span data-stu-id="cd447-249">Required Members for **ITextRangeProvider**</span></span>

<span data-ttu-id="cd447-250">執行 [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) 介面需要下列屬性和方法。</span><span class="sxs-lookup"><span data-stu-id="cd447-250">The following properties and methods are required for implementing the [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) interface.</span></span>



| <span data-ttu-id="cd447-251">必要成員</span><span class="sxs-lookup"><span data-stu-id="cd447-251">Required members</span></span>                                                                 | <span data-ttu-id="cd447-252">成員類型</span><span class="sxs-lookup"><span data-stu-id="cd447-252">Member type</span></span> | <span data-ttu-id="cd447-253">備註</span><span class="sxs-lookup"><span data-stu-id="cd447-253">Notes</span></span> |
|----------------------------------------------------------------------------------|-------------|-------|
| [<span data-ttu-id="cd447-254">**AddToSelection**</span><span class="sxs-lookup"><span data-stu-id="cd447-254">**AddToSelection**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-addtoselection)               | <span data-ttu-id="cd447-255">方法</span><span class="sxs-lookup"><span data-stu-id="cd447-255">Method</span></span>      | <span data-ttu-id="cd447-256">無</span><span class="sxs-lookup"><span data-stu-id="cd447-256">None</span></span>  |
| [<span data-ttu-id="cd447-257">**克隆**</span><span class="sxs-lookup"><span data-stu-id="cd447-257">**Clone**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-clone)                                 | <span data-ttu-id="cd447-258">方法</span><span class="sxs-lookup"><span data-stu-id="cd447-258">Method</span></span>      | <span data-ttu-id="cd447-259">無</span><span class="sxs-lookup"><span data-stu-id="cd447-259">None</span></span>  |
| [<span data-ttu-id="cd447-260">**比較**</span><span class="sxs-lookup"><span data-stu-id="cd447-260">**Compare**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-compare)                             | <span data-ttu-id="cd447-261">方法</span><span class="sxs-lookup"><span data-stu-id="cd447-261">Method</span></span>      | <span data-ttu-id="cd447-262">無</span><span class="sxs-lookup"><span data-stu-id="cd447-262">None</span></span>  |
| [<span data-ttu-id="cd447-263">**CompareEndpoints**</span><span class="sxs-lookup"><span data-stu-id="cd447-263">**CompareEndpoints**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-compareendpoints)           | <span data-ttu-id="cd447-264">方法</span><span class="sxs-lookup"><span data-stu-id="cd447-264">Method</span></span>      | <span data-ttu-id="cd447-265">無</span><span class="sxs-lookup"><span data-stu-id="cd447-265">None</span></span>  |
| [<span data-ttu-id="cd447-266">**ExpandToEnclosingUnit**</span><span class="sxs-lookup"><span data-stu-id="cd447-266">**ExpandToEnclosingUnit**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-expandtoenclosingunit) | <span data-ttu-id="cd447-267">方法</span><span class="sxs-lookup"><span data-stu-id="cd447-267">Method</span></span>      | <span data-ttu-id="cd447-268">無</span><span class="sxs-lookup"><span data-stu-id="cd447-268">None</span></span>  |
| [<span data-ttu-id="cd447-269">**FindAttribute**</span><span class="sxs-lookup"><span data-stu-id="cd447-269">**FindAttribute**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-findattribute)                 | <span data-ttu-id="cd447-270">方法</span><span class="sxs-lookup"><span data-stu-id="cd447-270">Method</span></span>      | <span data-ttu-id="cd447-271">無</span><span class="sxs-lookup"><span data-stu-id="cd447-271">None</span></span>  |
| [<span data-ttu-id="cd447-272">**FindText**</span><span class="sxs-lookup"><span data-stu-id="cd447-272">**FindText**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-findtext)                           | <span data-ttu-id="cd447-273">方法</span><span class="sxs-lookup"><span data-stu-id="cd447-273">Method</span></span>      | <span data-ttu-id="cd447-274">無</span><span class="sxs-lookup"><span data-stu-id="cd447-274">None</span></span>  |
| [<span data-ttu-id="cd447-275">**GetAttributeValue**</span><span class="sxs-lookup"><span data-stu-id="cd447-275">**GetAttributeValue**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-getattributevalue)         | <span data-ttu-id="cd447-276">方法</span><span class="sxs-lookup"><span data-stu-id="cd447-276">Method</span></span>      | <span data-ttu-id="cd447-277">無</span><span class="sxs-lookup"><span data-stu-id="cd447-277">None</span></span>  |
| [<span data-ttu-id="cd447-278">**GetBoundingRectangles**</span><span class="sxs-lookup"><span data-stu-id="cd447-278">**GetBoundingRectangles**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-getboundingrectangles) | <span data-ttu-id="cd447-279">方法</span><span class="sxs-lookup"><span data-stu-id="cd447-279">Method</span></span>      | <span data-ttu-id="cd447-280">無</span><span class="sxs-lookup"><span data-stu-id="cd447-280">None</span></span>  |
| [<span data-ttu-id="cd447-281">**GetChildren**</span><span class="sxs-lookup"><span data-stu-id="cd447-281">**GetChildren**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-getchildren)                     | <span data-ttu-id="cd447-282">方法</span><span class="sxs-lookup"><span data-stu-id="cd447-282">Method</span></span>      | <span data-ttu-id="cd447-283">無</span><span class="sxs-lookup"><span data-stu-id="cd447-283">None</span></span>  |
| [<span data-ttu-id="cd447-284">**GetEnclosingElement**</span><span class="sxs-lookup"><span data-stu-id="cd447-284">**GetEnclosingElement**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-getenclosingelement)     | <span data-ttu-id="cd447-285">方法</span><span class="sxs-lookup"><span data-stu-id="cd447-285">Method</span></span>      | <span data-ttu-id="cd447-286">無</span><span class="sxs-lookup"><span data-stu-id="cd447-286">None</span></span>  |
| [<span data-ttu-id="cd447-287">**GetText**</span><span class="sxs-lookup"><span data-stu-id="cd447-287">**GetText**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-gettext)                             | <span data-ttu-id="cd447-288">方法</span><span class="sxs-lookup"><span data-stu-id="cd447-288">Method</span></span>      | <span data-ttu-id="cd447-289">無</span><span class="sxs-lookup"><span data-stu-id="cd447-289">None</span></span>  |
| [<span data-ttu-id="cd447-290">**移動**</span><span class="sxs-lookup"><span data-stu-id="cd447-290">**Move**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-move)                                   | <span data-ttu-id="cd447-291">方法</span><span class="sxs-lookup"><span data-stu-id="cd447-291">Method</span></span>      | <span data-ttu-id="cd447-292">無</span><span class="sxs-lookup"><span data-stu-id="cd447-292">None</span></span>  |
| [<span data-ttu-id="cd447-293">**MoveEndpointByUnit**</span><span class="sxs-lookup"><span data-stu-id="cd447-293">**MoveEndpointByUnit**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-moveendpointbyunit)       | <span data-ttu-id="cd447-294">方法</span><span class="sxs-lookup"><span data-stu-id="cd447-294">Method</span></span>      | <span data-ttu-id="cd447-295">無</span><span class="sxs-lookup"><span data-stu-id="cd447-295">None</span></span>  |
| [<span data-ttu-id="cd447-296">**MoveEndpointByRange**</span><span class="sxs-lookup"><span data-stu-id="cd447-296">**MoveEndpointByRange**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-moveendpointbyrange)     | <span data-ttu-id="cd447-297">方法</span><span class="sxs-lookup"><span data-stu-id="cd447-297">Method</span></span>      | <span data-ttu-id="cd447-298">無</span><span class="sxs-lookup"><span data-stu-id="cd447-298">None</span></span>  |
| [<span data-ttu-id="cd447-299">**選擇**</span><span class="sxs-lookup"><span data-stu-id="cd447-299">**Select**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-select)                               | <span data-ttu-id="cd447-300">方法</span><span class="sxs-lookup"><span data-stu-id="cd447-300">Method</span></span>      | <span data-ttu-id="cd447-301">無</span><span class="sxs-lookup"><span data-stu-id="cd447-301">None</span></span>  |
| [<span data-ttu-id="cd447-302">**ScrollIntoView**</span><span class="sxs-lookup"><span data-stu-id="cd447-302">**ScrollIntoView**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-scrollintoview)               | <span data-ttu-id="cd447-303">方法</span><span class="sxs-lookup"><span data-stu-id="cd447-303">Method</span></span>      | <span data-ttu-id="cd447-304">無</span><span class="sxs-lookup"><span data-stu-id="cd447-304">None</span></span>  |



 

<span data-ttu-id="cd447-305">執行 [**ITextRangeProvider2**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider2) 介面需要下列其他屬性和方法。</span><span class="sxs-lookup"><span data-stu-id="cd447-305">The following additional properties and methods are required for implementing the [**ITextRangeProvider2**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider2) interface.</span></span>



| <span data-ttu-id="cd447-306">必要成員</span><span class="sxs-lookup"><span data-stu-id="cd447-306">Required members</span></span>                                                      | <span data-ttu-id="cd447-307">成員類型</span><span class="sxs-lookup"><span data-stu-id="cd447-307">Member type</span></span> | <span data-ttu-id="cd447-308">備註</span><span class="sxs-lookup"><span data-stu-id="cd447-308">Notes</span></span>                                      |
|-----------------------------------------------------------------------|-------------|--------------------------------------------|
| [<span data-ttu-id="cd447-309">**ShowContextMenu**</span><span class="sxs-lookup"><span data-stu-id="cd447-309">**ShowContextMenu**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider2-showcontextmenu) | <span data-ttu-id="cd447-310">方法</span><span class="sxs-lookup"><span data-stu-id="cd447-310">Method</span></span>      | <span data-ttu-id="cd447-311">請參閱「執行 ShowCoNtextMenu」一節</span><span class="sxs-lookup"><span data-stu-id="cd447-311">See "Implementing ShowContextMenu" section</span></span> |



 

<span data-ttu-id="cd447-312">**TextRange** 控制項模式沒有相關聯的事件。</span><span class="sxs-lookup"><span data-stu-id="cd447-312">The **TextRange** control pattern has no associated events.</span></span>

## <a name="supporting-text-ranges"></a><span data-ttu-id="cd447-313">支援文字範圍</span><span class="sxs-lookup"><span data-stu-id="cd447-313">Supporting Text Ranges</span></span>

<span data-ttu-id="cd447-314">本節說明提供者如何執行 [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) 和 [**ITextRangeProvider2**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider2) 介面的各種方法，以支援 **TextRange** 控制項模式。</span><span class="sxs-lookup"><span data-stu-id="cd447-314">This section describes how a provider should implement various methods of the [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) and [**ITextRangeProvider2**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider2) interfaces to support the **TextRange** control pattern.</span></span>

### <a name="manipulating-a-text-range-by-text-unit"></a><span data-ttu-id="cd447-315">依文字單位操作文字範圍</span><span class="sxs-lookup"><span data-stu-id="cd447-315">Manipulating a Text Range by Text Unit</span></span>

<span data-ttu-id="cd447-316">[**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider)介面提供數種方法，可在以文字為基礎的控制項中操作和導覽文字範圍。</span><span class="sxs-lookup"><span data-stu-id="cd447-316">The [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) interface provides several methods for manipulating and navigating text ranges in a text-based control.</span></span> <span data-ttu-id="cd447-317">[**ITextRangeProvider：： Move**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-move)、 [**MoveEndpointByUnit**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-moveendpointbyunit)和 [**ExpandToEnclosingUnit**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-expandtoenclosingunit)方法會依據指定的文字單位（例如字元、字、段落等等）移動文字範圍或其中一個端點。</span><span class="sxs-lookup"><span data-stu-id="cd447-317">The [**ITextRangeProvider::Move**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-move), [**MoveEndpointByUnit**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-moveendpointbyunit), and [**ExpandToEnclosingUnit**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-expandtoenclosingunit) methods move a text range or one of its endpoints by the specified text unit, such as character, word, paragraph, and so on.</span></span> <span data-ttu-id="cd447-318">如需詳細資訊，請參閱 [消費者介面自動化文字單位](/windows/desktop/WinAuto/uiauto-uiautomationtextunits)。</span><span class="sxs-lookup"><span data-stu-id="cd447-318">For more information, see [UI Automation Text Units](/windows/desktop/WinAuto/uiauto-uiautomationtextunits).</span></span>

<span data-ttu-id="cd447-319">不論其名稱為何， [**ITextRangeProvider：： ExpandToEnclosingUnit**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-expandtoenclosingunit) 方法都不一定會展開文字範圍。</span><span class="sxs-lookup"><span data-stu-id="cd447-319">Despite its name, the [**ITextRangeProvider::ExpandToEnclosingUnit**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-expandtoenclosingunit) method does not necessarily expand a text range.</span></span> <span data-ttu-id="cd447-320">相反地，它會藉由移動端點來「標準化」文字範圍，使範圍包含指定的文字單位。</span><span class="sxs-lookup"><span data-stu-id="cd447-320">Instead, it "normalizes" a text range by moving the endpoints so that the range encompasses the specified text unit.</span></span> <span data-ttu-id="cd447-321">如果範圍小於指定的單位，則範圍會展開，如果超過指定的單位，則會縮短。</span><span class="sxs-lookup"><span data-stu-id="cd447-321">The range is expanded if it is smaller than the specified unit, or shortened if it is longer than the specified unit.</span></span> <span data-ttu-id="cd447-322">**ExpandToEnclosingUnit** 方法一定要以一致的方式來正規化文字範圍是很重要的。否則，文字範圍操作的其他方面將無法預期。</span><span class="sxs-lookup"><span data-stu-id="cd447-322">It is critical that the **ExpandToEnclosingUnit** method always normalizes text ranges in a consistent manner; otherwise, other aspects of text range manipulation by text unit would be unpredictable.</span></span> <span data-ttu-id="cd447-323">下圖顯示 **ExpandToEnclosingUnit** 如何藉由移動範圍的端點，將文字範圍標準化。</span><span class="sxs-lookup"><span data-stu-id="cd447-323">The following diagram shows how **ExpandToEnclosingUnit** normalizes a text range by moving the endpoints of the range.</span></span>

![顯示呼叫 expandtoenclosingunit 前後文字範圍端點位置的圖表](images/expandtoenclosingunit.jpg)

<span data-ttu-id="cd447-325">如果文字範圍是從文字單位的開頭開始，而且在下一個文字單位界限的開頭或之前結束，則結束端點會移至下一個文字單位界限， (在上圖中看到1和 2) 。</span><span class="sxs-lookup"><span data-stu-id="cd447-325">If the text range starts at the beginning of a text unit and ends at the beginning of, or before, the next text unit boundary, the ending endpoint is moved to the next text unit boundary (see 1 and 2 in the previous diagram).</span></span>

<span data-ttu-id="cd447-326">如果文字範圍是從文字單位的開頭開始，並在下一個單位界限結束或之後結束，則結束端點會維持或移至下一個單元界限之後的起點 (請參閱上圖中的3和 4) 。</span><span class="sxs-lookup"><span data-stu-id="cd447-326">If the text range starts at the beginning of a text unit and ends at, or after, the next unit boundary, the ending endpoint stays or is moved backward to the next unit boundary after the starting endpoint (see 3 and 4 in the previous illustration).</span></span> <span data-ttu-id="cd447-327">如果開始與結束端點之間有多個文字單位界限，結束端點就會向後移至起始端點之後的下一個單位界限，而產生長度為一個文字單位的文字範圍。</span><span class="sxs-lookup"><span data-stu-id="cd447-327">If there is more than one text unit boundary between the starting and ending endpoints, the ending endpoint is moved backward to the next unit boundary after the starting endpoint, resulting in a text range that is one text unit in length.</span></span>

<span data-ttu-id="cd447-328">如果文字範圍是從文字單位的中間開始，則起始端點會往回移至文字單元的開頭，而結束端點則會視需要向後移或往後移動至起始端點之後的下一個單位界限 (在上圖中看到5到8的) 。</span><span class="sxs-lookup"><span data-stu-id="cd447-328">If the text range starts in a middle of the text unit, the starting endpoint is moved backward to the beginning of the text unit, and the ending endpoint is moved forward or backward, as necessary, to the next unit boundary after the starting endpoint (see 5 through 8 in the previous diagram).</span></span>

<span data-ttu-id="cd447-329">呼叫 [**ITextRangeProvider：： Move**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-move) 方法時，提供者會使用與 [**ExpandToEnclosingUnit**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-expandtoenclosingunit) 方法相同的正規化邏輯，以指定的文字單位來將文字範圍標準化。</span><span class="sxs-lookup"><span data-stu-id="cd447-329">When the [**ITextRangeProvider::Move**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-move) method is called, the provider normalizes the text range by the specified text unit, using the same normalization logic as the [**ExpandToEnclosingUnit**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-expandtoenclosingunit) method.</span></span> <span data-ttu-id="cd447-330">然後，提供者會將範圍向後或向前移動指定的文字單位數目。</span><span class="sxs-lookup"><span data-stu-id="cd447-330">Then, the provider moves the range backward or forward by the specified number of text units.</span></span> <span data-ttu-id="cd447-331">移動範圍時，提供者應該忽略文字中任何内嵌物件的界限。</span><span class="sxs-lookup"><span data-stu-id="cd447-331">When moving the range, the provider should ignore the boundaries of any embedded objects in the text.</span></span> <span data-ttu-id="cd447-332"> (不過，單位界限本身可能會受到内嵌物件) 的影響。</span><span class="sxs-lookup"><span data-stu-id="cd447-332">(However, the unit boundary itself may be affected by the existence of an embedded object).</span></span> <span data-ttu-id="cd447-333">下圖將示範 **Move** 方法如何在内嵌物件和文字單位界限之間移動文字範圍（單位為單位）。</span><span class="sxs-lookup"><span data-stu-id="cd447-333">The following diagram demonstrates how the **Move** method moves a text range, unit by unit, across embedded objects and text unit boundaries.</span></span>

![顯示移動方法如何跨物件和文字單位界限移動端點範圍的圖表](images/move.jpg)

<span data-ttu-id="cd447-335">[**ITextRangeProvider：： MoveEndpointByUnit**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-moveendpointbyunit)方法會依指定的文字單位，向前或向後移動其中一個端點，如下圖所示。</span><span class="sxs-lookup"><span data-stu-id="cd447-335">The [**ITextRangeProvider::MoveEndpointByUnit**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-moveendpointbyunit) method moves one of the endpoints forward or backward by specified text unit, as the following illustration shows.</span></span>

![顯示 moveendpointbyunit 如何移動範圍端點的圖表](images/moveendpointbyunit.gif)

<span data-ttu-id="cd447-337">[**ITextRangeProvider：： MoveEndpointByRange**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-moveendpointbyrange)方法可讓用戶端應用程式將文字範圍的一個端點設定為與第二個文字範圍之指定端點相同的位置。</span><span class="sxs-lookup"><span data-stu-id="cd447-337">The [**ITextRangeProvider::MoveEndpointByRange**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-moveendpointbyrange) method enables a client application to set one endpoint of a text range to same location as the specified endpoint of a second text range.</span></span>

### <a name="selecting-text-in-a-text-range"></a><span data-ttu-id="cd447-338">選取文字範圍中的文字</span><span class="sxs-lookup"><span data-stu-id="cd447-338">Selecting Text in a Text Range</span></span>

<span data-ttu-id="cd447-339">[**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider)介面包含數個方法，可控制以文字為基礎之控制項中的文字選取範圍。</span><span class="sxs-lookup"><span data-stu-id="cd447-339">The [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) interface includes several methods for controlling the selection of text in a text-based control.</span></span>

<span data-ttu-id="cd447-340">[**ITextRangeProvider：： Select**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-select)方法應該選取對應至文字範圍的文字，並從文字控制項移除先前的選取專案（如果有的話）。</span><span class="sxs-lookup"><span data-stu-id="cd447-340">The [**ITextRangeProvider::Select**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-select) method should select the text that corresponds to a text range, and remove the previous selection, if any, from the text control.</span></span> <span data-ttu-id="cd447-341">如果在退化文字範圍上呼叫 **Select** ，則提供者應該將插入點移至文字範圍的位置，而不需要選取任何文字。</span><span class="sxs-lookup"><span data-stu-id="cd447-341">If **Select** is called on a degenerate text range, the provider should move the insertion point to the location of the text range without selecting any text.</span></span>

<span data-ttu-id="cd447-342">如果控制項支援選取多個不連續的文字範圍， [**ITextRangeProvider：： AddToSelection**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-addtoselection) 和 [**RemoveFromSelection**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-removefromselection) 方法會將文字範圍加入至所選文字範圍的集合，並將其從集合中移除。</span><span class="sxs-lookup"><span data-stu-id="cd447-342">If a control supports the selection of multiple, disjoint spans of text, the [**ITextRangeProvider::AddToSelection**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-addtoselection) and [**RemoveFromSelection**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-removefromselection) methods add text ranges to, and remove them from, the collection of selected text ranges.</span></span> <span data-ttu-id="cd447-343">如果控制項一次只支援一個選取的文字範圍，但是選取作業會導致選取多個不連續的文字範圍，則提供者應該傳回 **電子 \_ INVALIDOPERATION** 錯誤，或是延伸或截斷目前的選取範圍。</span><span class="sxs-lookup"><span data-stu-id="cd447-343">If the control only supports one selected text range at a time, but the selection operation would result in the selection of multiple disjoint text ranges, the provider should either return an **E\_INVALIDOPERATION** error, or should extend or truncate the current selection.</span></span> <span data-ttu-id="cd447-344">[**ITextProvider：： SupportedTextSelection**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-get_supportedtextselection)屬性應該指出控制項是否支援選取單一或多個文字範圍，或完全無。</span><span class="sxs-lookup"><span data-stu-id="cd447-344">The [**ITextProvider::SupportedTextSelection**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-get_supportedtextselection) property should indicate whether a control supports the selection of single or multiple spans of text, or none at all.</span></span>

<span data-ttu-id="cd447-345">如果以文字為基礎的控制項支援文字插入，則在控制項中的退化文字範圍上呼叫 [**ITextRangeProvider：： AddToSelection**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-addtoselection) 或 [**RemoveFromSelection**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-removefromselection) 應移動插入點，但不應選取任何文字。</span><span class="sxs-lookup"><span data-stu-id="cd447-345">If a text-based control supports text insertions, calling [**ITextRangeProvider::AddToSelection**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-addtoselection) or [**RemoveFromSelection**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-removefromselection) on a degenerate text range in the control should move the insertion point but should not select any text.</span></span>

### <a name="acquiring-text-from-a-text-range"></a><span data-ttu-id="cd447-346">從文字範圍取得文字</span><span class="sxs-lookup"><span data-stu-id="cd447-346">Acquiring Text from a Text Range</span></span>

<span data-ttu-id="cd447-347">[**ITextRangeProvider：： GetText**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-gettext)方法應該會傳回文字範圍的純文字。</span><span class="sxs-lookup"><span data-stu-id="cd447-347">The [**ITextRangeProvider::GetText**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-gettext) method should return the plain text of a text range.</span></span> <span data-ttu-id="cd447-348">純文字應該包含在來源文字中找到的所有控制字元，例如，換行字元和 Unicode 從左至右的標記 (LRM) 。</span><span class="sxs-lookup"><span data-stu-id="cd447-348">The plain text should include all control characters found in the source text, such as carriage returns and the Unicode left-to-right mark (LRM).</span></span> <span data-ttu-id="cd447-349">純文字不應包含任何標記標記，例如可能存在於來源文字中的 HTML。</span><span class="sxs-lookup"><span data-stu-id="cd447-349">The plain text should not include any markup tags such as HTML that may be present in the source text.</span></span> <span data-ttu-id="cd447-350">此外，來源文字中的任何轉義碼都應轉換成純文字對等專案。</span><span class="sxs-lookup"><span data-stu-id="cd447-350">Also, any escape codes in the source text should be converted to the plain text equivalents.</span></span> <span data-ttu-id="cd447-351">例如，" &nbsp; " 應該轉換成簡單的空白字元。</span><span class="sxs-lookup"><span data-stu-id="cd447-351">For example, "&nbsp;" should be converted to a simple space character.</span></span>

<span data-ttu-id="cd447-352">如果内嵌物件跨越某個範圍的文字，則純文字應該包含物件的內部文字，而不是內嵌) 物件的 [名稱] 屬性 (替代文字，因為它可能與描述性的內部文字不一致。</span><span class="sxs-lookup"><span data-stu-id="cd447-352">If an embedded object spans a range of text, the plain text should include the inner text of the object, but not the alternative text (the name property of the embedded object) because it might be inconsistent with the descriptive inner text.</span></span> <span data-ttu-id="cd447-353">如需詳細資訊，請參閱 [消費者介面自動化如何公開内嵌物件](uiauto-textpattern-and-embedded-objects-overview.md)。</span><span class="sxs-lookup"><span data-stu-id="cd447-353">For more information, see [How UI Automation Exposes Embedded Objects](uiauto-textpattern-and-embedded-objects-overview.md).</span></span>

### <a name="implementing-showcontextmenu"></a><span data-ttu-id="cd447-354">執行 ShowCoNtextMenu</span><span class="sxs-lookup"><span data-stu-id="cd447-354">Implementing ShowContextMenu</span></span>

<span data-ttu-id="cd447-355">[**ITextRangeProvider2：： ShowCoNtextMenu**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider2-showcontextmenu) 應該一律在範圍的起點點顯示內容功能表。</span><span class="sxs-lookup"><span data-stu-id="cd447-355">[**ITextRangeProvider2::ShowContextMenu**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider2-showcontextmenu) should always show the context menu at the beginning end point of the range.</span></span> <span data-ttu-id="cd447-356">這應該相當於使用者按下內容功能表鍵或 SHIFT + F10 與範圍開頭的插入點時所發生的情況。</span><span class="sxs-lookup"><span data-stu-id="cd447-356">This should be equivalent to what would happen if the user pressed the context menu key or SHIFT + F10 with the insertion point at the beginning of the range.</span></span>

<span data-ttu-id="cd447-357">如果顯示操作功能表通常會導致插入點移動到指定的位置，則它應該這麼做，以程式設計方式叫用 [**ShowCoNtextMenu**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider2-showcontextmenu) 來消費者介面自動化支援。</span><span class="sxs-lookup"><span data-stu-id="cd447-357">If showing the context menu would typically result in the insertion point moving to a given location, then it should do so for programmatically invoking [**ShowContextMenu**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider2-showcontextmenu) for UI Automation support also.</span></span>

## <a name="interoperability-with-the-system-caret"></a><span data-ttu-id="cd447-358">與系統插入點的互通性</span><span class="sxs-lookup"><span data-stu-id="cd447-358">Interoperability with the System Caret</span></span>

<span data-ttu-id="cd447-359">正確支援插入點對於許多用戶端應用程式都很重要，包括不是以消費者介面自動化為基礎的應用程式。</span><span class="sxs-lookup"><span data-stu-id="cd447-359">Correctly supporting the insertion point is critical to many client applications, including those not based on UI Automation.</span></span> <span data-ttu-id="cd447-360">在 **文字** 控制項模式中，插入點是以 (空白) 文字範圍在系統插入號的位置來表示。</span><span class="sxs-lookup"><span data-stu-id="cd447-360">In the **Text** control pattern, the insertion point is represented by a degenerate (empty) text range at the position of the system caret.</span></span> <span data-ttu-id="cd447-361">當插入點移動時，控制項應該會引發 **TextSelectionChanged** 事件， ([**UIA \_ Text \_ TextSelectionChangedEventId**](uiauto-event-ids.md)) 。</span><span class="sxs-lookup"><span data-stu-id="cd447-361">When the insertion point moves, a control should raise the **TextSelectionChanged** event ([**UIA\_Text\_TextSelectionChangedEventId**](uiauto-event-ids.md)).</span></span> <span data-ttu-id="cd447-362">某些用戶端應用程式相依于此事件來監視插入點的位置，以及追蹤文字選取範圍。</span><span class="sxs-lookup"><span data-stu-id="cd447-362">Some client applications depend on this event to monitor the location of the insertion point, and to keep track of the text selection.</span></span>

<span data-ttu-id="cd447-363">當控制項包含選取的文字時，目前的 **文字** 控制項模式設計不會提供直接將插入點位置與特定文字範圍產生關聯的方式。</span><span class="sxs-lookup"><span data-stu-id="cd447-363">When a control contains selected text, the current design of the **Text** control pattern does not provide a way to directly associate the location of the insertion point with a particular text range.</span></span> <span data-ttu-id="cd447-364">提供者必須追蹤文字選取範圍，並適當地設定插入點的位置。</span><span class="sxs-lookup"><span data-stu-id="cd447-364">The provider must keep track of the text selection and set the location of the insertion point appropriately.</span></span> <span data-ttu-id="cd447-365">因為選取文字通常是藉由在按住 SHIFT 或 CTRL 鍵時移動插入點來完成，或兩者都有，所以提供者可以在選取專案變更時，藉由檢查這些按鍵的狀態來追蹤文字選取範圍。</span><span class="sxs-lookup"><span data-stu-id="cd447-365">Because selecting text is typically done by moving the insertion point while holding down the SHIFT or CTRL key, or both, a provider can track the text selection by checking the state of these keys whenever the selection changes.</span></span>

<span data-ttu-id="cd447-366">由於協助工具架構會為系統插入號提供內建的支援，但不會針對自訂插入號提供內建支援，因此，以文字為基礎的控制項應該盡可能使用系統插入號。</span><span class="sxs-lookup"><span data-stu-id="cd447-366">Because the accessibility framework provides built-in support for the system caret but not for a custom caret, text-based controls should use the system caret whenever possible.</span></span> <span data-ttu-id="cd447-367">使用自訂插入號的控制項可讓您建立與自訂插入號相同維度的系統插入號，並將系統插入點放置在控制項 UI 中的相同位置，以做為自訂插入點（也就是插入點），來確保插入號可以存取。</span><span class="sxs-lookup"><span data-stu-id="cd447-367">Controls that use a custom caret can ensure that the caret is accessible by creating a system caret that has the same dimensions as the custom caret, and positioning the system caret at the same location in the UI of the control as the custom caret—that is, at the insertion point.</span></span> <span data-ttu-id="cd447-368">或者，使用自訂插入號的控制項可以執行 [**OBJID \_ 插入**](object-identifiers.md) 號的 Microsoft Active Accessibility 提供者，以直接為您的自訂插入號提供協助工具資訊。</span><span class="sxs-lookup"><span data-stu-id="cd447-368">As an alternative, a control that uses a custom caret can implement a Microsoft Active Accessibility provider for [**OBJID\_CARET**](object-identifiers.md) to provide accessibility information directly for your custom caret.</span></span>

<span data-ttu-id="cd447-369">如需系統插入號的詳細資訊，請參閱 [游標](/windows/desktop/menurc/carets)。</span><span class="sxs-lookup"><span data-stu-id="cd447-369">For more information about the system caret, see [Carets](/windows/desktop/menurc/carets).</span></span>

<span data-ttu-id="cd447-370">若要測試您的控制項是否適當地公開系統插入號的位置，請使用 [檢查](inspect-objects.md) 和 [可存取的事件](accessible-event-watcher.md) 監看員工具。</span><span class="sxs-lookup"><span data-stu-id="cd447-370">To test whether your control properly exposes the location of the system caret, use the [Inspect](inspect-objects.md) and [Accessible Event Watcher](accessible-event-watcher.md) tools.</span></span>

<span data-ttu-id="cd447-371">系統插入號點陣圖中間的螢幕座標應該一律符合插入點的位置。</span><span class="sxs-lookup"><span data-stu-id="cd447-371">The screen coordinates of the center of the system caret bitmap should always match the location of the insertion point.</span></span> <span data-ttu-id="cd447-372">如此一來，用戶端就可以在 [**ITextProvider：： RangeFromPoint**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-rangefrompoint) 的呼叫中使用插入號螢幕座標，以取得可精確表示插入點位置的文字範圍。</span><span class="sxs-lookup"><span data-stu-id="cd447-372">That way, a client can use the caret screen coordinates in a call to [**ITextProvider::RangeFromPoint**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-rangefrompoint) to retrieve a text range that accurately represents the location of the insertion point.</span></span>

## <a name="related-topics"></a><span data-ttu-id="cd447-373">相關主題</span><span class="sxs-lookup"><span data-stu-id="cd447-373">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="cd447-374">控制項類型及其支援的控制項模式</span><span class="sxs-lookup"><span data-stu-id="cd447-374">Control Types and Their Supported Control Patterns</span></span>](uiauto-controlpatternmapping.md)
</dt> <dt>

[<span data-ttu-id="cd447-375">Text 控制項類型</span><span class="sxs-lookup"><span data-stu-id="cd447-375">Text Control Type</span></span>](uiauto-supporttextcontroltype.md)
</dt> <dt>

[<span data-ttu-id="cd447-376">Macos textedit 控制項模式</span><span class="sxs-lookup"><span data-stu-id="cd447-376">TextEdit Control Pattern</span></span>](textedit-control-pattern.md)
</dt> <dt>

[<span data-ttu-id="cd447-377">TextChild 控制項模式</span><span class="sxs-lookup"><span data-stu-id="cd447-377">TextChild Control Pattern</span></span>](textchild-control-pattern.md)
</dt> <dt>

[<span data-ttu-id="cd447-378">UI 自動化控制項模式概觀</span><span class="sxs-lookup"><span data-stu-id="cd447-378">UI Automation Control Patterns Overview</span></span>](uiauto-controlpatternsoverview.md)
</dt> <dt>

[<span data-ttu-id="cd447-379">消費者介面自動化文字內容的支援</span><span class="sxs-lookup"><span data-stu-id="cd447-379">UI Automation Support for Textual Content</span></span>](uiauto-ui-automation-textpattern-overview.md)
</dt> <dt>

[<span data-ttu-id="cd447-380">UI 自動化樹狀目錄概觀</span><span class="sxs-lookup"><span data-stu-id="cd447-380">UI Automation Tree Overview</span></span>](uiauto-treeoverview.md)
</dt> </dl>

 

 