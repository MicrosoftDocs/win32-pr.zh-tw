---
title: 快取消費者介面自動化屬性和控制項模式
description: 使用 Microsoft 消費者介面自動化時，用戶端通常需要針對多個自動化元素取出多個屬性。
ms.assetid: 948b3bb9-75a9-4197-9680-e6fe7bb86feb
keywords:
- 快取，消費者介面自動化屬性
- 快取，屬性
- 快取，消費者介面自動化控制項模式
- 快取、控制項模式
- 消費者介面自動化，快取屬性
- 消費者介面自動化，屬性快取
- 用戶端，快取消費者介面自動化屬性
- 用戶端，快取消費者介面自動化控制項模式
- 消費者介面自動化，快取控制項模式
- 消費者介面自動化，控制項模式快取
- 控制項模式，快取
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 69f75a7dc9491565fdfdc0ecc73808c2fb6a9d82
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 09/16/2019
ms.locfileid: "104372004"
---
# <a name="caching-ui-automation-properties-and-control-patterns"></a><span data-ttu-id="bf0cb-114">快取消費者介面自動化屬性和控制項模式</span><span class="sxs-lookup"><span data-stu-id="bf0cb-114">Caching UI Automation Properties and Control Patterns</span></span>

<span data-ttu-id="bf0cb-115">使用 Microsoft 消費者介面自動化時，用戶端通常需要針對多個自動化元素取出多個屬性。</span><span class="sxs-lookup"><span data-stu-id="bf0cb-115">When using Microsoft UI Automation, clients often need to retrieve multiple properties for multiple automation elements.</span></span> <span data-ttu-id="bf0cb-116">用戶端可以使用屬性抓取方法（例如 [**IUIAutomationElement：： CurrentName**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentname) 或 [**CurrentAccessKey**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentaccesskey)），一次取出一個元素的個別屬性。</span><span class="sxs-lookup"><span data-stu-id="bf0cb-116">A client could retrieve individual properties one element at a time by using the property retrieval methods such as [**IUIAutomationElement::CurrentName**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentname) or [**CurrentAccessKey**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentaccesskey).</span></span> <span data-ttu-id="bf0cb-117">不過，這個方法的速度很慢且沒有效率，因為它需要針對每個要抓取的屬性進行跨進程呼叫。</span><span class="sxs-lookup"><span data-stu-id="bf0cb-117">However, this method is slow and inefficient because it requires a cross-process call for each property being retrieved.</span></span> <span data-ttu-id="bf0cb-118">為了改善效能，用戶端可以使用快取 (也稱為大量提取) 消費者介面自動化的功能。</span><span class="sxs-lookup"><span data-stu-id="bf0cb-118">To improve performance, clients can use the caching (also called bulk fetching) capabilities of UI Automation.</span></span> <span data-ttu-id="bf0cb-119">快取可讓用戶端使用單一方法呼叫來取得所有所需專案的所有所需屬性。</span><span class="sxs-lookup"><span data-stu-id="bf0cb-119">Caching enables a client to retrieve all of the desired properties for all of the desired elements with a single method call.</span></span> <span data-ttu-id="bf0cb-120">然後，用戶端可以視需要從快取中取出個別的屬性，並可定期取得快取的新快照集，通常是為了回應在 UI 中表示變更的事件。</span><span class="sxs-lookup"><span data-stu-id="bf0cb-120">The client can then retrieve the individual properties from the cache as needed, and can get a new snapshot of the cache periodically, generally in response to events that signify changes in the UI.</span></span>

<span data-ttu-id="bf0cb-121">應用程式可以在使用方法（例如 [**IUIAutomation：： ElementFromPointBuildCache**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-elementfrompointbuildcache)、 [**IUIAutomationTreeWalker：： GetFirstChildElementBuildCache**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtreewalker-getfirstchildelementbuildcache)或 [**IUIAutomationElement：： FindFirstBuildCache**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findfirstbuildcache)）抓取消費者介面自動化專案時，要求快取。</span><span class="sxs-lookup"><span data-stu-id="bf0cb-121">The application can request caching when it retrieves a UI Automation element by using a method, such as [**IUIAutomation::ElementFromPointBuildCache**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-elementfrompointbuildcache), [**IUIAutomationTreeWalker::GetFirstChildElementBuildCache**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtreewalker-getfirstchildelementbuildcache), or [**IUIAutomationElement::FindFirstBuildCache**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findfirstbuildcache).</span></span>

<span data-ttu-id="bf0cb-122">當您在訂閱事件時指定快取要求時，也會發生快取。</span><span class="sxs-lookup"><span data-stu-id="bf0cb-122">Caching also occurs when you specify a cache request while subscribing to events.</span></span> <span data-ttu-id="bf0cb-123">傳遞至事件處理常式做為事件來源的消費者介面自動化專案包含快取的屬性和快取要求所指定的控制項模式。</span><span class="sxs-lookup"><span data-stu-id="bf0cb-123">The UI Automation element passed to your event handler as the source of an event contains the cached properties and control patterns that are specified by the cache request.</span></span> <span data-ttu-id="bf0cb-124">訂閱事件之後對快取要求所做的任何變更都不會有任何作用。</span><span class="sxs-lookup"><span data-stu-id="bf0cb-124">Any changes made to the cache request after you subscribe to the event have no effect.</span></span>

<span data-ttu-id="bf0cb-125">本主題包含下列各節。</span><span class="sxs-lookup"><span data-stu-id="bf0cb-125">This topic contains the following sections.</span></span>

-   [<span data-ttu-id="bf0cb-126">快取要求</span><span class="sxs-lookup"><span data-stu-id="bf0cb-126">Cache Requests</span></span>](#cache-requests)
    -   [<span data-ttu-id="bf0cb-127">指定要快取的屬性和控制項模式</span><span class="sxs-lookup"><span data-stu-id="bf0cb-127">Specifying Property and Control Patterns to Cache</span></span>](#specifying-property-and-control-patterns-to-cache)
    -   [<span data-ttu-id="bf0cb-128">指定快取要求的範圍和篩選</span><span class="sxs-lookup"><span data-stu-id="bf0cb-128">Specifying the Scoping and Filtering of a Caching Request</span></span>](#specifying-the-scoping-and-filtering-of-a-caching-request)
    -   [<span data-ttu-id="bf0cb-129">元素參考的強度</span><span class="sxs-lookup"><span data-stu-id="bf0cb-129">Strength of Element References</span></span>](#strength-of-element-references)
-   [<span data-ttu-id="bf0cb-130">擷取快取的子系和父代</span><span class="sxs-lookup"><span data-stu-id="bf0cb-130">Retrieving Cached Children and Parents</span></span>](#retrieving-cached-children-and-parents)
-   [<span data-ttu-id="bf0cb-131">正在抓取快取的新快照集</span><span class="sxs-lookup"><span data-stu-id="bf0cb-131">Retrieving a New Snapshot of the Cache</span></span>](#retrieving-a-new-snapshot-of-the-cache)
-   [<span data-ttu-id="bf0cb-132">範例</span><span class="sxs-lookup"><span data-stu-id="bf0cb-132">Examples</span></span>](#examples)
-   [<span data-ttu-id="bf0cb-133">相關主題</span><span class="sxs-lookup"><span data-stu-id="bf0cb-133">Related topics</span></span>](#related-topics)

## <a name="cache-requests"></a><span data-ttu-id="bf0cb-134">快取要求</span><span class="sxs-lookup"><span data-stu-id="bf0cb-134">Cache Requests</span></span>

<span data-ttu-id="bf0cb-135">快取牽涉到判斷要抓取哪些屬性，以及要從中取出哪些專案，然後再使用這項資訊來建立快取要求。</span><span class="sxs-lookup"><span data-stu-id="bf0cb-135">Caching involves determining which properties to retrieve and which elements to retrieve them from, and then using this information to create a cache request.</span></span> <span data-ttu-id="bf0cb-136">只要用戶端取得 UI 專案的 [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) 介面，消費者介面自動化就會快取快取要求中所指定的資訊。</span><span class="sxs-lookup"><span data-stu-id="bf0cb-136">Whenever the client obtains an [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) interface for UI item, UI Automation caches the information that is specified in the cache request.</span></span>

<span data-ttu-id="bf0cb-137">若要建立快取要求，請先使用 [**IUIAutomation：： CreateCacheRequest**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-createcacherequest) 方法來取出 [**IUIAutomationCacheRequest**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationcacherequest) 介面指標。</span><span class="sxs-lookup"><span data-stu-id="bf0cb-137">To create a cache request, begin by using the [**IUIAutomation::CreateCacheRequest**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-createcacherequest) method to retrieve an [**IUIAutomationCacheRequest**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationcacherequest) interface pointer.</span></span> <span data-ttu-id="bf0cb-138">接下來，使用 **IUIAutomationCacheRequest** 的方法來設定快取要求。</span><span class="sxs-lookup"><span data-stu-id="bf0cb-138">Next, configure the cache request by using the methods of **IUIAutomationCacheRequest**.</span></span>

### <a name="specifying-property-and-control-patterns-to-cache"></a><span data-ttu-id="bf0cb-139">指定要快取的屬性和控制項模式</span><span class="sxs-lookup"><span data-stu-id="bf0cb-139">Specifying Property and Control Patterns to Cache</span></span>

<span data-ttu-id="bf0cb-140">您可以藉由呼叫 [**IUIAutomationCacheRequest：： AddProperty**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationcacherequest-addproperty)來指定要快取的屬性。</span><span class="sxs-lookup"><span data-stu-id="bf0cb-140">You can specify properties to cache by calling [**IUIAutomationCacheRequest::AddProperty**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationcacherequest-addproperty).</span></span> <span data-ttu-id="bf0cb-141">您可以藉由呼叫 [**IUIAutomationCacheRequest：： AddPattern**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationcacherequest-addpattern)來指定要快取的控制項模式。</span><span class="sxs-lookup"><span data-stu-id="bf0cb-141">You can specify control patterns to cache by calling [**IUIAutomationCacheRequest::AddPattern**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationcacherequest-addpattern).</span></span> <span data-ttu-id="bf0cb-142">快取控制項模式時，不會自動快取其屬性;您必須使用 **AddProperty** 來指定想要快取的屬性。</span><span class="sxs-lookup"><span data-stu-id="bf0cb-142">When a control pattern is cached, its properties are not automatically cached; you must specify the properties you want to cache by using **AddProperty**.</span></span>

<span data-ttu-id="bf0cb-143">您可以取得控制項模式屬性 (例如， [值](uiauto-implementingvalue.md) 控制項模式的 value 屬性) ，而不需要將整個控制項模式取出至快取中。</span><span class="sxs-lookup"><span data-stu-id="bf0cb-143">You can retrieve a control pattern property (for example, the Value property of the [Value](uiauto-implementingvalue.md) control pattern), without having to retrieve the entire control pattern into the cache.</span></span> <span data-ttu-id="bf0cb-144">只有當您需要使用控制項模式方法時，才必須抓取控制項模式。</span><span class="sxs-lookup"><span data-stu-id="bf0cb-144">You must retrieve the control pattern only if you need to use a control pattern method.</span></span>

### <a name="specifying-the-scoping-and-filtering-of-a-caching-request"></a><span data-ttu-id="bf0cb-145">指定快取要求的範圍和篩選</span><span class="sxs-lookup"><span data-stu-id="bf0cb-145">Specifying the Scoping and Filtering of a Caching Request</span></span>

<span data-ttu-id="bf0cb-146">您可以在使用要求之前設定 [**IUIAutomationCacheRequest：： treescope.children**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationcacherequest-get_treescope) 屬性，以指定要快取其屬性和控制項模式的元素。</span><span class="sxs-lookup"><span data-stu-id="bf0cb-146">You can specify the elements whose properties and control patterns you want to cache by setting the [**IUIAutomationCacheRequest::TreeScope**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationcacherequest-get_treescope) property before using the request.</span></span> <span data-ttu-id="bf0cb-147">範圍相對於傳遞快取要求的方法所抓取的元素。</span><span class="sxs-lookup"><span data-stu-id="bf0cb-147">The scope is relative to the elements that are retrieved by the method to which the cache request is passed.</span></span> <span data-ttu-id="bf0cb-148">例如，如果您只設定 [**Treescope.children \_ 子**](/windows/desktop/api/UIAutomationClient/ne-uiautomationclient-treescope)系，然後取出消費者介面自動化專案，則會快取該專案之子系的屬性和控制項模式，但不會快取專案本身的屬性和控制項模式。</span><span class="sxs-lookup"><span data-stu-id="bf0cb-148">For example, if you set only [**TreeScope\_Children**](/windows/desktop/api/UIAutomationClient/ne-uiautomationclient-treescope), and then retrieve a UI Automation element, the properties and control patterns of children of that element are cached, but the properties and control patterns of the element itself are not cached.</span></span> <span data-ttu-id="bf0cb-149">為了確保針對抓取的元素本身進行快取，您必須在 **IUIAutomationCacheRequest：： treescope.children** 屬性中包含 **treescope.children \_ 元素**。</span><span class="sxs-lookup"><span data-stu-id="bf0cb-149">To ensure that caching is done for the retrieved element itself, you must include **TreeScope\_Element** in the **IUIAutomationCacheRequest::TreeScope** property.</span></span> <span data-ttu-id="bf0cb-150">您無法將範圍設定為 **Treescope.children \_ Parent** 或 **treescope.children \_ 祖** 系。</span><span class="sxs-lookup"><span data-stu-id="bf0cb-150">It is not possible to set the scope to **TreeScope\_Parent** or **TreeScope\_Ancestors**.</span></span> <span data-ttu-id="bf0cb-151">不過，快取子項目時即會快取父項目；請參閱本主題中的＜擷取快取的子系和父代＞。</span><span class="sxs-lookup"><span data-stu-id="bf0cb-151">However, a parent element can be cached when a child element is cached; see Retrieving Cached Children and Parents in this topic.</span></span>

<span data-ttu-id="bf0cb-152">快取的範圍也會受到 [**IUIAutomationCacheRequest：： TreeFilter**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationcacherequest-get_treefilter) 屬性的影響。</span><span class="sxs-lookup"><span data-stu-id="bf0cb-152">The extent of caching is also affected by the [**IUIAutomationCacheRequest::TreeFilter**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationcacherequest-get_treefilter) property.</span></span> <span data-ttu-id="bf0cb-153">根據預設，只會針對出現在消費者介面自動化樹狀結構之控制項視圖中的元素執行快取。</span><span class="sxs-lookup"><span data-stu-id="bf0cb-153">By default, caching is performed only for elements that appear in the control view of the UI Automation tree.</span></span> <span data-ttu-id="bf0cb-154">不過，您可以變更此屬性，將快取套用至所有項目，或是只套用至內容檢視中顯示的項目。</span><span class="sxs-lookup"><span data-stu-id="bf0cb-154">However, you can change this property to apply caching to all elements, or only to elements that appear in the content view.</span></span>

### <a name="strength-of-element-references"></a><span data-ttu-id="bf0cb-155">元素參考的強度</span><span class="sxs-lookup"><span data-stu-id="bf0cb-155">Strength of Element References</span></span>

<span data-ttu-id="bf0cb-156">當您取得 automation 專案時，根據預設，您可以存取該專案的所有屬性和控制項模式，包括未快取的屬性和控制項模式。</span><span class="sxs-lookup"><span data-stu-id="bf0cb-156">When you retrieve an automation element, by default you have access to all properties and control patterns of that element, including those properties and control patterns that were not cached.</span></span> <span data-ttu-id="bf0cb-157">不過，您可以藉由將 [**IUIAutomationCacheRequest：： AutomationElementMode**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationcacherequest-get_automationelementmode) 屬性設定為 **AutomationElementMode \_ None**，來指定元素的參考只參考快取的資料。</span><span class="sxs-lookup"><span data-stu-id="bf0cb-157">However, you can specify that the reference to the element refers to cached data only, by setting the [**IUIAutomationCacheRequest::AutomationElementMode**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationcacherequest-get_automationelementmode) property to **AutomationElementMode\_None**.</span></span> <span data-ttu-id="bf0cb-158">在此情況下，您無法存取任何未快取的屬性，也無法控制所抓取專案的模式。</span><span class="sxs-lookup"><span data-stu-id="bf0cb-158">In this case, you do not have access to any uncached properties and control patterns of retrieved elements.</span></span> <span data-ttu-id="bf0cb-159">這表示您無法存取任何目前的屬性，例如 [**IUIAutomationElement：： CurrentIsEnabled**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentisenabled) ，或使用 [**IUIAutomationElement：： GetCurrentPattern**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-getcurrentpattern)取得控制項模式。</span><span class="sxs-lookup"><span data-stu-id="bf0cb-159">This means that you cannot access any current properties such as [**IUIAutomationElement::CurrentIsEnabled**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentisenabled) or retrieve a control pattern by using [**IUIAutomationElement::GetCurrentPattern**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-getcurrentpattern).</span></span> <span data-ttu-id="bf0cb-160">在快取的控制項模式中，您無法呼叫在控制項上執行動作的方法，例如 [**IUIAutomationInvokePattern：： Invoke**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationinvokepattern-invoke)。</span><span class="sxs-lookup"><span data-stu-id="bf0cb-160">On cached control patterns, you cannot call methods that perform actions on the control, such as [**IUIAutomationInvokePattern::Invoke**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationinvokepattern-invoke).</span></span>

<span data-ttu-id="bf0cb-161">可能不需要物件之完整參考的應用程式範例是螢幕讀取器，它可能會預先提取視窗中專案的名稱和控制項類型屬性，而不需要 automation 元素物件本身。</span><span class="sxs-lookup"><span data-stu-id="bf0cb-161">An example of an application that might not need full references to objects is a screen reader, which might prefetch the name and control type properties of elements in a window without needing the automation element objects themselves.</span></span>

## <a name="retrieving-cached-children-and-parents"></a><span data-ttu-id="bf0cb-162">擷取快取的子系和父代</span><span class="sxs-lookup"><span data-stu-id="bf0cb-162">Retrieving Cached Children and Parents</span></span>

<span data-ttu-id="bf0cb-163">當您透過要求的 [**IUIAutomationCacheRequest：： treescope.children**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationcacherequest-get_treescope) 屬性抓取 automation 元素並要求該元素之子系的快取時，可以在您所抓取的元素上呼叫 [**IUIAutomationElement：： GetCachedChildren**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-getcachedchildren) ，以取得子項目。</span><span class="sxs-lookup"><span data-stu-id="bf0cb-163">When you retrieve an automation element and request caching for children of that element through the [**IUIAutomationCacheRequest::TreeScope**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationcacherequest-get_treescope) property of the request, it is possible to get the child elements by calling [**IUIAutomationElement::GetCachedChildren**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-getcachedchildren) on the element you retrieved.</span></span>

<span data-ttu-id="bf0cb-164">如果 [**treescope.children \_**](/windows/desktop/api/UIAutomationClient/ne-uiautomationclient-treescope) 專案包含在快取要求的範圍內，您可以在任何子項目上呼叫 [**IUIAutomationElement：： GetCachedParent**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-getcachedparent) ，以抓取要求的根項目。</span><span class="sxs-lookup"><span data-stu-id="bf0cb-164">If [**TreeScope\_Element**](/windows/desktop/api/UIAutomationClient/ne-uiautomationclient-treescope) was included in the scope of the cache request, the root element of the request can be retrieved by calling [**IUIAutomationElement::GetCachedParent**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-getcachedparent) on any of the child elements.</span></span>

> [!Note]  
> <span data-ttu-id="bf0cb-165">您無法快取要求之根項目的父代或祖系。</span><span class="sxs-lookup"><span data-stu-id="bf0cb-165">You cannot cache parents or ancestors of the root element of the request.</span></span>

 

## <a name="retrieving-a-new-snapshot-of-the-cache"></a><span data-ttu-id="bf0cb-166">正在抓取快取的新快照集</span><span class="sxs-lookup"><span data-stu-id="bf0cb-166">Retrieving a New Snapshot of the Cache</span></span>

<span data-ttu-id="bf0cb-167">只有在 UI 中沒有任何變更時，快取才有效。</span><span class="sxs-lookup"><span data-stu-id="bf0cb-167">The cache is valid only as long as nothing changes in the UI.</span></span> <span data-ttu-id="bf0cb-168">您的應用程式會負責抓取快取的新快照集（通常是為了回應事件）。</span><span class="sxs-lookup"><span data-stu-id="bf0cb-168">Your application is responsible for retrieving a new snapshot of the cache, typically, in response to events.</span></span>

<span data-ttu-id="bf0cb-169">如果您使用快取要求訂閱事件，則每當呼叫事件處理常式時，就會取得快取的 [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) 新快照集作為事件的來源。</span><span class="sxs-lookup"><span data-stu-id="bf0cb-169">If you subscribe to an event with a cache request, you obtain an [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) new snapshot of the cache as the source of the event whenever your event handler is called.</span></span> <span data-ttu-id="bf0cb-170">您也可以藉由呼叫 [**IUIAutomationElement：： BuildUpdatedCache**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-buildupdatedcache)，來取得專案的快取資訊的新快照。</span><span class="sxs-lookup"><span data-stu-id="bf0cb-170">You can also retrieve a new snapshot of cached information for an element by calling [**IUIAutomationElement::BuildUpdatedCache**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-buildupdatedcache).</span></span> <span data-ttu-id="bf0cb-171">您可以傳入原始 [**IUIAutomationCacheRequest**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationcacherequest) ，以取得先前快取的所有資訊的新快照。</span><span class="sxs-lookup"><span data-stu-id="bf0cb-171">You can pass in the original [**IUIAutomationCacheRequest**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationcacherequest) to get a new snapshot of all information that was previously cached.</span></span>

<span data-ttu-id="bf0cb-172">抓取快取的新快照集並不會修改任何現有 [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) 參考的屬性。</span><span class="sxs-lookup"><span data-stu-id="bf0cb-172">Retrieving a new snapshot of the cache does not modify the properties of any existing [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) references.</span></span>

## <a name="examples"></a><span data-ttu-id="bf0cb-173">範例</span><span class="sxs-lookup"><span data-stu-id="bf0cb-173">Examples</span></span>

<span data-ttu-id="bf0cb-174">如需示範如何使用消費者介面自動化之快取功能的程式碼範例，請參閱 [如何使用](uiauto-howto-use-caching.md)快取。</span><span class="sxs-lookup"><span data-stu-id="bf0cb-174">For code examples that show how to use the caching capabilities of UI Automation, see [How to Use Caching](uiauto-howto-use-caching.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="bf0cb-175">相關主題</span><span class="sxs-lookup"><span data-stu-id="bf0cb-175">Related topics</span></span>

<dl> <dt>

<span data-ttu-id="bf0cb-176">**概念**</span><span class="sxs-lookup"><span data-stu-id="bf0cb-176">**Conceptual**</span></span>
</dt> <dt>

[<span data-ttu-id="bf0cb-177">UI 自動化控制項模式概觀</span><span class="sxs-lookup"><span data-stu-id="bf0cb-177">UI Automation Control Patterns Overview</span></span>](uiauto-controlpatternsoverview.md)
</dt> <dt>

[<span data-ttu-id="bf0cb-178">取得 UI 自動化項目</span><span class="sxs-lookup"><span data-stu-id="bf0cb-178">Obtaining UI Automation Elements</span></span>](uiauto-obtainingelements.md)
</dt> <dt>

[<span data-ttu-id="bf0cb-179">UI 自動化屬性概觀</span><span class="sxs-lookup"><span data-stu-id="bf0cb-179">UI Automation Properties Overview</span></span>](uiauto-propertiesoverview.md)
</dt> </dl>

 

 




