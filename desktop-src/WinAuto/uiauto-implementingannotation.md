---
title: Annotation 控制項模式
description: 描述執行 IAnnotationProvider 的方針和慣例，包括屬性和方法的相關資訊。 批註控制項模式是用來公開檔中批註的屬性。
ms.assetid: 5A334991-66AF-4A82-9A09-09D5BDAAA771
keywords:
- 消費者介面自動化，執行批註控制項模式
- 消費者介面自動化，annotation 控制項模式
- 消費者介面自動化、IAnnotationProvider
- IAnnotationProvider
- 執行消費者介面自動化 annotation 控制項模式
- annotation 控制項模式
- 控制項模式，IAnnotationProvider
- 控制項模式，執行消費者介面自動化注釋
- 控制項模式、注釋
- 介面，IAnnotationProvider
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 1c1a0441816e548faaa9076b3a9717c0aa76f08a
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/20/2020
ms.locfileid: "106966044"
---
# <a name="annotation-control-pattern"></a><span data-ttu-id="24716-114">Annotation 控制項模式</span><span class="sxs-lookup"><span data-stu-id="24716-114">Annotation Control Pattern</span></span>

<span data-ttu-id="24716-115">描述執行 [**IAnnotationProvider**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-iannotationprovider)的方針和慣例，包括屬性和方法的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="24716-115">Describes guidelines and conventions for implementing [**IAnnotationProvider**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-iannotationprovider), including information about properties and methods.</span></span> <span data-ttu-id="24716-116">**批註** 控制項模式是用來公開檔中批註的屬性。</span><span class="sxs-lookup"><span data-stu-id="24716-116">The **Annotation** control pattern is used to expose the properties of an annotation in a document.</span></span>

<span data-ttu-id="24716-117">其中一個範例是檔邊界中的批註批註提示，並連接到某些檔文字或試算表儲存格。</span><span class="sxs-lookup"><span data-stu-id="24716-117">One example is a comment balloon that is in the margin of a document and is connected to some document text or a spreadsheet cell.</span></span>

<span data-ttu-id="24716-118">下圖顯示批註的範例。</span><span class="sxs-lookup"><span data-stu-id="24716-118">The following illustration shows an example of an annotation.</span></span> <span data-ttu-id="24716-119">如需執行此控制項模式的控制項範例，請參閱 [控制項類型及其支援的控制項模式](uiauto-controlpatternmapping.md)。</span><span class="sxs-lookup"><span data-stu-id="24716-119">For examples of controls that implement this control pattern, see [Control Types and Their Supported Control Patterns](uiauto-controlpatternmapping.md).</span></span>

![顯示檔中批註 baloon 的螢幕擷取畫面](images/annotation.png)

<span data-ttu-id="24716-121">本主題包含下列各節。</span><span class="sxs-lookup"><span data-stu-id="24716-121">This topic contains the following sections.</span></span>

-   [<span data-ttu-id="24716-122">實作方針和慣例</span><span class="sxs-lookup"><span data-stu-id="24716-122">Implementation Guidelines and Conventions</span></span>](#implementation-guidelines-and-conventions)
-   [<span data-ttu-id="24716-123">**IAnnotationProvider** 的必要成員</span><span class="sxs-lookup"><span data-stu-id="24716-123">Required Members for **IAnnotationProvider**</span></span>](#required-members-for-iannotationprovider)
-   [<span data-ttu-id="24716-124">相關主題</span><span class="sxs-lookup"><span data-stu-id="24716-124">Related topics</span></span>](#related-topics)

## <a name="implementation-guidelines-and-conventions"></a><span data-ttu-id="24716-125">實作方針和慣例</span><span class="sxs-lookup"><span data-stu-id="24716-125">Implementation Guidelines and Conventions</span></span>

<span data-ttu-id="24716-126">在執行 **注釋** 控制項模式時，請注意下列方針和慣例：</span><span class="sxs-lookup"><span data-stu-id="24716-126">When implementing the **Annotation** control pattern, note the following guidelines and conventions:</span></span>

-   <span data-ttu-id="24716-127">有許多不同類型的批註。</span><span class="sxs-lookup"><span data-stu-id="24716-127">There are many different kinds of annotations.</span></span> <span data-ttu-id="24716-128">Uiautomationclient.dll 標頭檔會定義一組命名的常數值，這些值會識別 Microsoft 消費者介面自動化支援的批註類型。</span><span class="sxs-lookup"><span data-stu-id="24716-128">The UIAutomationClient.h header file defines a set of named constant values that identify the types of annotations that Microsoft UI Automation supports.</span></span> <span data-ttu-id="24716-129">如需詳細資訊，請參閱 [**批註類型識別碼**](uiauto-annotation-type-identifiers.md)。</span><span class="sxs-lookup"><span data-stu-id="24716-129">For more information, see [**Annotation Type Identifiers**](uiauto-annotation-type-identifiers.md).</span></span>
-   <span data-ttu-id="24716-130">如果您使用 [**AnnotationType \_ Unknown**](uiauto-annotation-type-identifiers.md)，則必須執行 [**IAnnotationProvider：： AnnotationTypeName**](/windows/desktop/api/uiautomationcore/nf-uiautomationcore-iannotationprovider-get_annotationtypename) 屬性，讓用戶端能夠探索批註類型的名稱。</span><span class="sxs-lookup"><span data-stu-id="24716-130">If you use [**AnnotationType\_Unknown**](uiauto-annotation-type-identifiers.md), you must implement the [**IAnnotationProvider::AnnotationTypeName**](/windows/desktop/api/uiautomationcore/nf-uiautomationcore-iannotationprovider-get_annotationtypename) property to enable clients to discover the name of the annotation type.</span></span> <span data-ttu-id="24716-131">您不需要為標準注釋類型執行 **AnnotationTypeName** ，因為消費者介面自動化提供預設名稱，但如果您需要覆寫預設名稱，可以執行此動作。</span><span class="sxs-lookup"><span data-stu-id="24716-131">You do not need to implement **AnnotationTypeName** for a standard annotation type because UI Automation provides a default name, but you can implement it if you need to override the default name.</span></span>
-   <span data-ttu-id="24716-132">[**IAnnotationProvider：： Author**](/windows/desktop/api/uiautomationcore/nf-uiautomationcore-iannotationprovider-get_author)屬性是選擇性的。</span><span class="sxs-lookup"><span data-stu-id="24716-132">The [**IAnnotationProvider::Author**](/windows/desktop/api/uiautomationcore/nf-uiautomationcore-iannotationprovider-get_author) property is optional.</span></span>
-   <span data-ttu-id="24716-133">[**IAnnotationProvider：:D atetime**](/windows/desktop/api/uiautomationcore/nf-uiautomationcore-iannotationprovider-get_datetime)屬性是選擇性的。</span><span class="sxs-lookup"><span data-stu-id="24716-133">The [**IAnnotationProvider::DateTime**](/windows/desktop/api/uiautomationcore/nf-uiautomationcore-iannotationprovider-get_datetime) property is optional.</span></span>
-   <span data-ttu-id="24716-134">[**IAnnotationProvider：： Target**](/windows/desktop/api/uiautomationcore/nf-uiautomationcore-iannotationprovider-get_target)屬性是必要的，因為它會將批註連結至 ui 元素，讓用戶端可以從批註導覽至批註所參考的 ui 專案。</span><span class="sxs-lookup"><span data-stu-id="24716-134">The [**IAnnotationProvider::Target**](/windows/desktop/api/uiautomationcore/nf-uiautomationcore-iannotationprovider-get_target) property is required because it links an annotation to a UI element, enabling a client to navigate from the annotation back to the UI element to which the annotation refers.</span></span>
-   <span data-ttu-id="24716-135">由於批註可以採用許多不同的表單，因此 [**IAnnotationProvider**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-iannotationprovider) 介面不會定義用來儲存批註值或文字的屬性。</span><span class="sxs-lookup"><span data-stu-id="24716-135">Because annotations can take many different forms, the [**IAnnotationProvider**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-iannotationprovider) interface does not define a property for storing the value or text of an annotation.</span></span> <span data-ttu-id="24716-136">簡單的批註應該會公開 [**IValueProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-ivalueprovider) 介面，而 [**IValueProvider：： Value**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-ivalueprovider-get_value) 屬性應該會傳回指定註解文字的唯讀值。</span><span class="sxs-lookup"><span data-stu-id="24716-136">A simple annotation should expose the [**IValueProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-ivalueprovider) interface, and the [**IValueProvider::Value**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-ivalueprovider-get_value) property should return a read-only value that specifies the annotation text.</span></span> <span data-ttu-id="24716-137">更豐富的批註應該會公開 [**ITextProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider) 介面，以提供更豐富的文字給用戶端。</span><span class="sxs-lookup"><span data-stu-id="24716-137">A richer annotation should expose the [**ITextProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider) interface to provide richer text to clients.</span></span>
-   <span data-ttu-id="24716-138">從 UI 元素導覽至專案上的注釋，取決於要標注的元素類型，如下所示：</span><span class="sxs-lookup"><span data-stu-id="24716-138">Navigating from a UI element to an annotation on the element depends on the kind of element being annotated, as follows:</span></span>
    -   <span data-ttu-id="24716-139">針對試算表儲存格，請執行 [**ISpreadsheetItemProvider：： GetAnnotationObjects**](/windows/desktop/api/uiautomationcore/nf-uiautomationcore-ispreadsheetitemprovider-getannotationobjects) 方法來參考批註。</span><span class="sxs-lookup"><span data-stu-id="24716-139">For spreadsheet cells, implement the [**ISpreadsheetItemProvider::GetAnnotationObjects**](/windows/desktop/api/uiautomationcore/nf-uiautomationcore-ispreadsheetitemprovider-getannotationobjects) method to refer to the annotation.</span></span>
    -   <span data-ttu-id="24716-140">若為文字內容，請在 [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider)介面上執行 [**AnnotationObjects**](uiauto-textattribute-ids.md)文字屬性，以參考批註。</span><span class="sxs-lookup"><span data-stu-id="24716-140">For textual content, implement the [**AnnotationObjects**](uiauto-textattribute-ids.md) text attribute on the [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) interface to refer to the annotation.</span></span>
-   <span data-ttu-id="24716-141">某些類型的注釋不需要完整執行 [**IAnnotationProvider**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-iannotationprovider) 介面。</span><span class="sxs-lookup"><span data-stu-id="24716-141">Some kinds of annotations do not require a full implementation of the [**IAnnotationProvider**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-iannotationprovider) interface.</span></span> <span data-ttu-id="24716-142">例如，您可以讓 [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider)介面傳回 [**AnnotationType \_ SpellingError**](uiauto-annotation-type-identifiers.md)的 [**AnnotationTypes**](uiauto-textattribute-ids.md) text 屬性，以及 [**AnnotationObjects**](uiauto-textattribute-ids.md) text 屬性的 null 值，來表示簡單的拼寫錯誤指標。</span><span class="sxs-lookup"><span data-stu-id="24716-142">For example, a simple spelling-error indicator could be represented by having the [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) interface return an [**AnnotationTypes**](uiauto-textattribute-ids.md) text attribute of [**AnnotationType\_SpellingError**](uiauto-annotation-type-identifiers.md), and a null value for the [**AnnotationObjects**](uiauto-textattribute-ids.md) text attribute.</span></span>
-   <span data-ttu-id="24716-143">在不可見的 UI 元素上執行 [**IAnnotationProvider**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-iannotationprovider) 介面可能會很有用。</span><span class="sxs-lookup"><span data-stu-id="24716-143">It can be useful to implement the [**IAnnotationProvider**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-iannotationprovider) interface on a UI element that is not visible.</span></span> <span data-ttu-id="24716-144">例如，您可以建立一個非可見的消費者介面自動化元素來執行 **IAnnotationProvider** ，以提供有關文法錯誤的延伸資訊。</span><span class="sxs-lookup"><span data-stu-id="24716-144">For example, you could create a non-visible UI Automation element that implements **IAnnotationProvider** to provide extended information about a grammar error.</span></span>
-   <span data-ttu-id="24716-145">如果控制項包含重迭的批註，以文字為基礎之控制項中的注釋可能會很複雜。</span><span class="sxs-lookup"><span data-stu-id="24716-145">Annotations in a text-based control can be complex if the control contains overlapping comments.</span></span> <span data-ttu-id="24716-146">使用下列指導方針來處理複雜的批註：</span><span class="sxs-lookup"><span data-stu-id="24716-146">Use the following guidelines to handle complex annotations:</span></span>
    -   <span data-ttu-id="24716-147">沒有批註的文字範圍應該會傳回 [**AnnotationTypes**](uiauto-textattribute-ids.md) text 屬性的空陣列，以及 [**AnnotationObjects**](uiauto-textattribute-ids.md) text 屬性的空陣列。</span><span class="sxs-lookup"><span data-stu-id="24716-147">A text range with no annotations should return an empty array for the [**AnnotationTypes**](uiauto-textattribute-ids.md) text attribute and an empty array for the [**AnnotationObjects**](uiauto-textattribute-ids.md) text attribute.</span></span>
    -   <span data-ttu-id="24716-148">具有一個批註的文字範圍應針對 [**AnnotationTypes**](uiauto-textattribute-ids.md)文字屬性傳回一個整數值的陣列，並針對 [**AnnotationObjects**](uiauto-textattribute-ids.md) Text 屬性傳回一個 [**IRawElementProviderSimple**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementprovidersimple)介面的陣列。</span><span class="sxs-lookup"><span data-stu-id="24716-148">A text range with one annotation should return an array of one integer value for the [**AnnotationTypes**](uiauto-textattribute-ids.md) text attribute and an array of one [**IRawElementProviderSimple**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementprovidersimple) interface for the [**AnnotationObjects**](uiauto-textattribute-ids.md) text attribute.</span></span>
    -   <span data-ttu-id="24716-149">具有多個批註的文字範圍應傳回 [**AnnotationTypes**](uiauto-textattribute-ids.md) text 屬性的多個整數值陣列，以及 [**AnnotationObjects**](uiauto-textattribute-ids.md) Text 屬性之相符 [**IRawElementProviderSimple**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementprovidersimple)介面數目的陣列。</span><span class="sxs-lookup"><span data-stu-id="24716-149">A text range with multiple annotations should return an array of multiple integer values for the [**AnnotationTypes**](uiauto-textattribute-ids.md) text attribute and an array of a matching number of [**IRawElementProviderSimple**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementprovidersimple) interfaces for the [**AnnotationObjects**](uiauto-textattribute-ids.md) text attribute.</span></span>
    -   <span data-ttu-id="24716-150">具有不同批註的文字範圍（例如具有批註和非註解文字的範圍）應該會傳回 [**AnnotationTypes**](uiauto-textattribute-ids.md)和 [**AnnotationObjects**](uiauto-textattribute-ids.md)的 [**ReservedMixedAttributeValue**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiagetreservedmixedattributevalue)屬性。</span><span class="sxs-lookup"><span data-stu-id="24716-150">A text range with varying annotations, such as a range with both annotated and non-annotated text, should return the [**ReservedMixedAttributeValue**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiagetreservedmixedattributevalue) property for both [**AnnotationTypes**](uiauto-textattribute-ids.md) and [**AnnotationObjects**](uiauto-textattribute-ids.md).</span></span> <span data-ttu-id="24716-151">接收此回應的用戶端可以細分文字範圍，以找出批註的開始和結束位置。</span><span class="sxs-lookup"><span data-stu-id="24716-151">A client receiving this response can subdivide the text range to find where the annotations begin and end.</span></span>

## <a name="required-members-for-iannotationprovider"></a><span data-ttu-id="24716-152">**IAnnotationProvider** 的必要成員</span><span class="sxs-lookup"><span data-stu-id="24716-152">Required Members for **IAnnotationProvider**</span></span>

<span data-ttu-id="24716-153">執行 [**IAnnotationProvider**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-iannotationprovider) 介面需要下列屬性。</span><span class="sxs-lookup"><span data-stu-id="24716-153">The following properties are required for implementing the [**IAnnotationProvider**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-iannotationprovider) interface.</span></span>



| <span data-ttu-id="24716-154">必要成員</span><span class="sxs-lookup"><span data-stu-id="24716-154">Required members</span></span>                                                                | <span data-ttu-id="24716-155">成員類型</span><span class="sxs-lookup"><span data-stu-id="24716-155">Member type</span></span> | <span data-ttu-id="24716-156">備註</span><span class="sxs-lookup"><span data-stu-id="24716-156">Notes</span></span> |
|---------------------------------------------------------------------------------|-------------|-------|
| [<span data-ttu-id="24716-157">**AnnotationTypeId**</span><span class="sxs-lookup"><span data-stu-id="24716-157">**AnnotationTypeId**</span></span>](/windows/desktop/api/uiautomationcore/nf-uiautomationcore-iannotationprovider-get_annotationtypeid)     | <span data-ttu-id="24716-158">屬性</span><span class="sxs-lookup"><span data-stu-id="24716-158">Property</span></span>    | <span data-ttu-id="24716-159">無。</span><span class="sxs-lookup"><span data-stu-id="24716-159">None.</span></span> |
| [<span data-ttu-id="24716-160">**AnnotationTypeName**</span><span class="sxs-lookup"><span data-stu-id="24716-160">**AnnotationTypeName**</span></span>](/windows/desktop/api/uiautomationcore/nf-uiautomationcore-iannotationprovider-get_annotationtypename) | <span data-ttu-id="24716-161">屬性</span><span class="sxs-lookup"><span data-stu-id="24716-161">Property</span></span>    | <span data-ttu-id="24716-162">無。</span><span class="sxs-lookup"><span data-stu-id="24716-162">None.</span></span> |
| [<span data-ttu-id="24716-163">**作者**</span><span class="sxs-lookup"><span data-stu-id="24716-163">**Author**</span></span>](/windows/desktop/api/uiautomationcore/nf-uiautomationcore-iannotationprovider-get_author)                         | <span data-ttu-id="24716-164">屬性</span><span class="sxs-lookup"><span data-stu-id="24716-164">Property</span></span>    | <span data-ttu-id="24716-165">無。</span><span class="sxs-lookup"><span data-stu-id="24716-165">None.</span></span> |
| [<span data-ttu-id="24716-166">**Datetime**</span><span class="sxs-lookup"><span data-stu-id="24716-166">**DateTime**</span></span>](/windows/desktop/api/uiautomationcore/nf-uiautomationcore-iannotationprovider-get_datetime)                     | <span data-ttu-id="24716-167">屬性</span><span class="sxs-lookup"><span data-stu-id="24716-167">Property</span></span>    | <span data-ttu-id="24716-168">無。</span><span class="sxs-lookup"><span data-stu-id="24716-168">None.</span></span> |
| [<span data-ttu-id="24716-169">**目標**</span><span class="sxs-lookup"><span data-stu-id="24716-169">**Target**</span></span>](/windows/desktop/api/uiautomationcore/nf-uiautomationcore-iannotationprovider-get_target)                         | <span data-ttu-id="24716-170">屬性</span><span class="sxs-lookup"><span data-stu-id="24716-170">Property</span></span>    | <span data-ttu-id="24716-171">無。</span><span class="sxs-lookup"><span data-stu-id="24716-171">None.</span></span> |



 

<span data-ttu-id="24716-172">此控制項模式沒有任何相關聯的事件。</span><span class="sxs-lookup"><span data-stu-id="24716-172">This control pattern has no associated events.</span></span>

## <a name="related-topics"></a><span data-ttu-id="24716-173">相關主題</span><span class="sxs-lookup"><span data-stu-id="24716-173">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="24716-174">控制項類型及其支援的控制項模式</span><span class="sxs-lookup"><span data-stu-id="24716-174">Control Types and Their Supported Control Patterns</span></span>](uiauto-controlpatternmapping.md)
</dt> <dt>

[<span data-ttu-id="24716-175">UI 自動化控制項模式概觀</span><span class="sxs-lookup"><span data-stu-id="24716-175">UI Automation Control Patterns Overview</span></span>](uiauto-controlpatternsoverview.md)
</dt> <dt>

[<span data-ttu-id="24716-176">UI 自動化樹狀目錄概觀</span><span class="sxs-lookup"><span data-stu-id="24716-176">UI Automation Tree Overview</span></span>](uiauto-treeoverview.md)
</dt> </dl>

 

 