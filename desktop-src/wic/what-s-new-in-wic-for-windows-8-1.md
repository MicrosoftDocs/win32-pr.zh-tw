---
description: Windows 影像處理元件 (WIC) 已更新為新版本的 Windows。 本主題提供這些新功能的快速簡介。
ms.assetid: 710B71CE-6FCC-46DA-A65C-6E4FC6A04275
title: WIC 的新功能
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 84b8b3783ac2fd8ef6a971f785cec80f868a6b80
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/08/2021
ms.locfileid: "106990475"
---
# <a name="whats-new-in-wic"></a><span data-ttu-id="d80cf-104">WIC 的新功能</span><span class="sxs-lookup"><span data-stu-id="d80cf-104">What's New in WIC</span></span>

<span data-ttu-id="d80cf-105">Windows 影像處理元件 (WIC) 已更新為新版本的 Windows。</span><span class="sxs-lookup"><span data-stu-id="d80cf-105">Windows Imaging Component (WIC) has been updated with new releases of Windows.</span></span> <span data-ttu-id="d80cf-106">本主題提供這些新功能的快速簡介。</span><span class="sxs-lookup"><span data-stu-id="d80cf-106">This topic provides a quick introduction to these new features.</span></span>

## <a name="whats-new-for-windows-10-version-1507"></a><span data-ttu-id="d80cf-107">Windows 10 的新功能，版本1507</span><span class="sxs-lookup"><span data-stu-id="d80cf-107">What's new for Windows 10, version 1507</span></span>

### <a name="access-to-low-level-jpeg-data-for-wic-decoding-and-encoding"></a><span data-ttu-id="d80cf-108">存取適用于 WIC 解碼和編碼的低層級 JPEG 資料</span><span class="sxs-lookup"><span data-stu-id="d80cf-108">Access to low level JPEG data for WIC decoding and encoding</span></span>

<span data-ttu-id="d80cf-109">從 Windows 10 開始，WIC 1507 版可讓您存取低層級 JPEG 資料結構，包括 Huffman 和量化資料表。</span><span class="sxs-lookup"><span data-stu-id="d80cf-109">Starting in Windows 10, version 1507, WIC provides access to low level JPEG data structures, including Huffman and quantization tables.</span></span> <span data-ttu-id="d80cf-110">如需詳細資訊，請參閱下列主題：</span><span class="sxs-lookup"><span data-stu-id="d80cf-110">For more information, see the following topics:</span></span>

-   <span data-ttu-id="d80cf-111">[**IWICJpegFrameDecode**](/windows/win32/api/Wincodec/nn-wincodec-iwicjpegframedecode) 介面</span><span class="sxs-lookup"><span data-stu-id="d80cf-111">[**IWICJpegFrameDecode**](/windows/win32/api/Wincodec/nn-wincodec-iwicjpegframedecode) interface</span></span>
-   <span data-ttu-id="d80cf-112">[**IWICJpegFrameEncode**](/windows/win32/api/Wincodec/nn-wincodec-iwicjpegframeencode) 介面</span><span class="sxs-lookup"><span data-stu-id="d80cf-112">[**IWICJpegFrameEncode**](/windows/win32/api/Wincodec/nn-wincodec-iwicjpegframeencode) interface</span></span>

### <a name="jpeg-indexing"></a><span data-ttu-id="d80cf-113">JPEG 索引</span><span class="sxs-lookup"><span data-stu-id="d80cf-113">JPEG indexing</span></span>

<span data-ttu-id="d80cf-114">JPEG 索引是一種技術，可大幅提升隨機存取大型 JPEG 影像之小型子領域的效能，代價是有一些額外的記憶體使用量。</span><span class="sxs-lookup"><span data-stu-id="d80cf-114">JPEG indexing is a technique that significantly improves the performance of randomly accessing small sub regions of a large JPEG image, at the cost of some additional memory usage.</span></span> <span data-ttu-id="d80cf-115">任何 WIC 的呼叫者都可以利用 JPEG 索引。</span><span class="sxs-lookup"><span data-stu-id="d80cf-115">JPEG indexing can be leveraged by any caller of WIC.</span></span>

<span data-ttu-id="d80cf-116">[**ID2D1ImageSourceFromWic**](/windows/win32/api/d2d1_3/nn-d2d1_3-id2d1imagesourcefromwic)介面的設計目的是要在開啟時，利用 JPEG 索引。</span><span class="sxs-lookup"><span data-stu-id="d80cf-116">The [**ID2D1ImageSourceFromWic**](/windows/win32/api/d2d1_3/nn-d2d1_3-id2d1imagesourcefromwic) interface is designed to leverage JPEG indexing if it is turned on.</span></span> <span data-ttu-id="d80cf-117">例如，ID2D1ImageSource API 只會在案例中要求影像的需要區段，例如大型解析度影像的平移和縮放。</span><span class="sxs-lookup"><span data-stu-id="d80cf-117">For example, the ID2D1ImageSource API will only request the needed sections of the image in a scenario such as pan and zoom for a large resolution image.</span></span> <span data-ttu-id="d80cf-118">如需詳細資訊，請參閱下列主題：</span><span class="sxs-lookup"><span data-stu-id="d80cf-118">For more information, see the following topics:</span></span>

-   <span data-ttu-id="d80cf-119">[**IWICJpegFrameDecode：： SetIndexing**](/windows/win32/api/Wincodec/nf-wincodec-iwicjpegframedecode-setindexing) 方法</span><span class="sxs-lookup"><span data-stu-id="d80cf-119">[**IWICJpegFrameDecode::SetIndexing**](/windows/win32/api/Wincodec/nf-wincodec-iwicjpegframedecode-setindexing) method</span></span>
-   <span data-ttu-id="d80cf-120">[**ID2D1ImageSourceFromWic**](/windows/win32/api/d2d1_3/nn-d2d1_3-id2d1imagesourcefromwic) 介面</span><span class="sxs-lookup"><span data-stu-id="d80cf-120">[**ID2D1ImageSourceFromWic**](/windows/win32/api/d2d1_3/nn-d2d1_3-id2d1imagesourcefromwic) interface</span></span>

## <a name="whats-new-for-windows-81"></a><span data-ttu-id="d80cf-121">Windows 8.1 的新功能</span><span class="sxs-lookup"><span data-stu-id="d80cf-121">What's new for Windows 8.1</span></span>

### <a name="support-for-jpeg-ycbcr-images"></a><span data-ttu-id="d80cf-122">支援 JPEG YCbCr 影像</span><span class="sxs-lookup"><span data-stu-id="d80cf-122">Support for JPEG YCbCr images</span></span>

<span data-ttu-id="d80cf-123">從 Windows 8.1 開始，WIC 提供以原生格式解碼、轉換及編碼 JPEG Y'CbCr 影像資料的支援。</span><span class="sxs-lookup"><span data-stu-id="d80cf-123">Starting in Windows 8.1, WIC provides support for decoding, transforming and encoding JPEG Y'CbCr image data in its native format.</span></span> <span data-ttu-id="d80cf-124">這可讓應用程式在使用 Y'CbCr 編碼的 Jpeg 時，大幅減少某些影像作業的處理時間和記憶體耗用量。</span><span class="sxs-lookup"><span data-stu-id="d80cf-124">This allows apps to significantly decrease processing time and memory consumption for certain imaging operations when working with Y'CbCr encoded JPEGs.</span></span> <span data-ttu-id="d80cf-125">如需詳細資訊，請參閱下列主題：</span><span class="sxs-lookup"><span data-stu-id="d80cf-125">For more information, see the following topics:</span></span>

-   <span data-ttu-id="d80cf-126">[Direct2D](-wic-sample-d2d-viewer.md)[YCbCr 效果](../direct2d/ycbcr-effect.md)</span><span class="sxs-lookup"><span data-stu-id="d80cf-126">[Direct2D](-wic-sample-d2d-viewer.md)[YCbCr effect](../direct2d/ycbcr-effect.md)</span></span>
-   <span data-ttu-id="d80cf-127">[**IWICPlanarBitmapSourceTransform**](/windows/win32/api/Wincodec/nn-wincodec-iwicplanarbitmapsourcetransform) 介面</span><span class="sxs-lookup"><span data-stu-id="d80cf-127">[**IWICPlanarBitmapSourceTransform**](/windows/win32/api/Wincodec/nn-wincodec-iwicplanarbitmapsourcetransform) interface</span></span>
-   <span data-ttu-id="d80cf-128">[**IWICPlanarBitmapFrameEncode**](/windows/win32/api/Wincodec/nn-wincodec-iwicplanarbitmapframeencode) 介面</span><span class="sxs-lookup"><span data-stu-id="d80cf-128">[**IWICPlanarBitmapFrameEncode**](/windows/win32/api/Wincodec/nn-wincodec-iwicplanarbitmapframeencode) interface</span></span>

### <a name="support-for-block-compressed-formats-dds-files"></a><span data-ttu-id="d80cf-129">支援 (DDS 檔案的區塊壓縮格式) </span><span class="sxs-lookup"><span data-stu-id="d80cf-129">Support for block compressed formats (DDS files)</span></span>

<span data-ttu-id="d80cf-130">從 Windows 8.1 開始，WIC 會加入新的編解碼器，以支援以下列格式編碼的 DDS 影像： DXGI \_ format \_ BC1 \_ UNORM、dxgi \_ FORMAT \_ BC2 \_ UNORM 和 DXGI \_ format \_ BC3 \_ UNORM。</span><span class="sxs-lookup"><span data-stu-id="d80cf-130">Starting in Windows 8.1, WIC adds a new codec that supports DDS images encoded in the following formats: DXGI\_FORMAT\_BC1\_UNORM, DXGI\_FORMAT\_BC2\_UNORM, and DXGI\_FORMAT\_BC3\_UNORM.</span></span> <span data-ttu-id="d80cf-131">您可以使用標準 WIC 介面，以已解碼的格式存取 DDS 區塊壓縮的資料，或直接使用新的 DDS 特定介面進行存取。</span><span class="sxs-lookup"><span data-stu-id="d80cf-131">DDS block compressed data can be accessed in a decoded form using standard WIC interfaces, or directly accessed using new DDS specific interfaces.</span></span> <span data-ttu-id="d80cf-132">如需詳細資訊，請參閱下列主題：</span><span class="sxs-lookup"><span data-stu-id="d80cf-132">For more information, see the following topics:</span></span>

-   <span data-ttu-id="d80cf-133">[**IWICDdsDecoder**](/windows/win32/api/Wincodec/nn-wincodec-iwicddsdecoder) 介面</span><span class="sxs-lookup"><span data-stu-id="d80cf-133">[**IWICDdsDecoder**](/windows/win32/api/Wincodec/nn-wincodec-iwicddsdecoder) interface</span></span>
-   <span data-ttu-id="d80cf-134">[**IWICDdsEncoder**](/windows/win32/api/Wincodec/nn-wincodec-iwicddsencoder) 介面</span><span class="sxs-lookup"><span data-stu-id="d80cf-134">[**IWICDdsEncoder**](/windows/win32/api/Wincodec/nn-wincodec-iwicddsencoder) interface</span></span>

## <a name="whats-new-for-windows-8"></a><span data-ttu-id="d80cf-135">Windows 8 的新功能</span><span class="sxs-lookup"><span data-stu-id="d80cf-135">What's new for Windows 8</span></span>

<span data-ttu-id="d80cf-136">在 Windows 8 中，WIC 已更新數個新功能。</span><span class="sxs-lookup"><span data-stu-id="d80cf-136">In Windows 8, WIC has been updated with several new features.</span></span> <span data-ttu-id="d80cf-137">Windows 7 和 Windows Server 2008 R2 上的 WIC 更新版本也可透過 windows 7 的 [platform update](../direct3darticles/platform-update-for-windows-7.md)（可透過 [Windows 7 的平臺更新取得](https://support.microsoft.com/kb/2670838)）在 Windows 7 和 windows Server R2 上取得。</span><span class="sxs-lookup"><span data-stu-id="d80cf-137">The updated version of WIC is also available on Windows 7 and Windows Server 2008 R2 via the [Platform Update for Windows 7](../direct3darticles/platform-update-for-windows-7.md), which is available through the [Platform Update for Windows 7](https://support.microsoft.com/kb/2670838).</span></span>

### <a name="improved-direct2d-integration"></a><span data-ttu-id="d80cf-138">改良的 Direct2D 整合</span><span class="sxs-lookup"><span data-stu-id="d80cf-138">Improved Direct2D integration</span></span>

<span data-ttu-id="d80cf-139">Windows 8 中的 WIC 可提供這些 Api 來改善 Direct2D 與 WIC 的整合：</span><span class="sxs-lookup"><span data-stu-id="d80cf-139">WIC in Windows 8 provides these APIs to improve Direct2D integration with WIC:</span></span>

-   <span data-ttu-id="d80cf-140">[**IWICImageEncoder**](/windows/win32/api/Wincodec/nn-wincodec-iwicimageencoder) -可將 Direct2D [**ID2D1Image**](/windows/win32/api/d2d1/nn-d2d1-id2d1image) 內容編碼為 [IWICBitmapFrameEncode](-wic-imp-iwicbitmapframeencode.md)的新介面。</span><span class="sxs-lookup"><span data-stu-id="d80cf-140">[**IWICImageEncoder**](/windows/win32/api/Wincodec/nn-wincodec-iwicimageencoder) - A new interface which can encode Direct2D [**ID2D1Image**](/windows/win32/api/d2d1/nn-d2d1-id2d1image) content to an [IWICBitmapFrameEncode](-wic-imp-iwicbitmapframeencode.md).</span></span> <span data-ttu-id="d80cf-141">這個介面的方法會採用 [**WICImageParameters**](/windows/win32/api/Wincodec/ns-wincodec-wicimageparameters)的指標，也就是控制編碼的參數。</span><span class="sxs-lookup"><span data-stu-id="d80cf-141">The methods of this interface take a pointer to [**WICImageParameters**](/windows/win32/api/Wincodec/ns-wincodec-wicimageparameters), which are parameters to control encoding.</span></span>
-   <span data-ttu-id="d80cf-142">[**IWICImagingFactory2**](/windows/win32/api/Wincodec/nn-wincodec-iwicimagingfactory2) -使用 [**CreateImageEncoder**](/windows/win32/api/Wincodec/nf-wincodec-iwicimagingfactory2-createimageencoder) 方法的新 WIC factory。</span><span class="sxs-lookup"><span data-stu-id="d80cf-142">[**IWICImagingFactory2**](/windows/win32/api/Wincodec/nn-wincodec-iwicimagingfactory2) - New WIC factory with the [**CreateImageEncoder**](/windows/win32/api/Wincodec/nf-wincodec-iwicimagingfactory2-createimageencoder) method.</span></span> <span data-ttu-id="d80cf-143">此介面繼承自原始的 WIC factory [**IWICImagingFactory**](/windows/win32/api/Wincodec/nn-wincodec-iwicimagingfactory)，並以相同的方式建立。</span><span class="sxs-lookup"><span data-stu-id="d80cf-143">This interface inherits from the original WIC factory, [**IWICImagingFactory**](/windows/win32/api/Wincodec/nn-wincodec-iwicimagingfactory), and is created the same way.</span></span>

### <a name="changes-to-bmp-codec-alpha-support"></a><span data-ttu-id="d80cf-144">BMP 編解碼器 Alpha 支援的變更</span><span class="sxs-lookup"><span data-stu-id="d80cf-144">Changes to BMP codec alpha support</span></span>

<span data-ttu-id="d80cf-145">Windows 8 中的 WIC 支援以 [WICPixelFormat32bppBGRA](-wic-codec-native-pixel-formats.md)格式的影像形式載入 [**BITMAPV5HEADER**](/windows/win32/api/wingdi/ns-wingdi-bitmapv5header)影像檔案。</span><span class="sxs-lookup"><span data-stu-id="d80cf-145">WIC in Windows 8 supports loading [**BITMAPV5HEADER**](/windows/win32/api/wingdi/ns-wingdi-bitmapv5header) image files as [WICPixelFormat32bppBGRA](-wic-codec-native-pixel-formats.md)-formatted images.</span></span> <span data-ttu-id="d80cf-146">此外，BMP 編碼器支援新的布林值 "EnableV5Header32bppBGRA"，它會指示編碼器使用32bppBGRA 影像資料來寫入 **BITMAPV5HEADER** 。</span><span class="sxs-lookup"><span data-stu-id="d80cf-146">In addition, the BMP encoder supports a new Boolean ,encoder option "EnableV5Header32bppBGRA", which instructs the encoder to write a **BITMAPV5HEADER** with the 32bppBGRA image data.</span></span>

<span data-ttu-id="d80cf-147">如需 BMP 格式的詳細資訊，請參閱 [Bmp 格式總覽](bmp-format-overview.md)。</span><span class="sxs-lookup"><span data-stu-id="d80cf-147">For more info about BMP formats, see [BMP Format Overview](bmp-format-overview.md).</span></span>

### <a name="new-pixel-formats"></a><span data-ttu-id="d80cf-148">新的像素格式</span><span class="sxs-lookup"><span data-stu-id="d80cf-148">New pixel formats</span></span>

<span data-ttu-id="d80cf-149">Windows 8 中的 WIC 定義了下列新的像素格式：</span><span class="sxs-lookup"><span data-stu-id="d80cf-149">WIC in Windows 8 defines these new pixel formats:</span></span>

-   <span data-ttu-id="d80cf-150">GUID \_ WICPixelFormat32bppRGB</span><span class="sxs-lookup"><span data-stu-id="d80cf-150">GUID\_WICPixelFormat32bppRGB</span></span>
-   <span data-ttu-id="d80cf-151">GUID \_ WICPixelFormat64bppRGB</span><span class="sxs-lookup"><span data-stu-id="d80cf-151">GUID\_WICPixelFormat64bppRGB</span></span>
-   <span data-ttu-id="d80cf-152">GUID \_ WICPixelFormat96bppRGBFloat</span><span class="sxs-lookup"><span data-stu-id="d80cf-152">GUID\_WICPixelFormat96bppRGBFloat</span></span>
-   <span data-ttu-id="d80cf-153">GUID \_ WICPixelFormat64bppPRGBAHalf</span><span class="sxs-lookup"><span data-stu-id="d80cf-153">GUID\_WICPixelFormat64bppPRGBAHalf</span></span>

> [!Note]  
> <span data-ttu-id="d80cf-154">TIFF 內建編解碼器會傳回 GUID \_ WICPixelFormat96bppRGBFloat 資料。</span><span class="sxs-lookup"><span data-stu-id="d80cf-154">The TIFF built-in codec will return GUID\_WICPixelFormat96bppRGBFloat data.</span></span> <span data-ttu-id="d80cf-155">內建的編解碼器未使用其他三種格式。</span><span class="sxs-lookup"><span data-stu-id="d80cf-155">The other three formats are not used by built-in codecs.</span></span>

 

### <a name="restrictions-to-component-extensibility-in-appcontainer"></a><span data-ttu-id="d80cf-156">AppContainer 中元件擴充性的限制</span><span class="sxs-lookup"><span data-stu-id="d80cf-156">Restrictions to component extensibility in AppContainer</span></span>

<span data-ttu-id="d80cf-157">在包含所有 Windows Store 應用程式的 AppContainer 進程中執行時，WIC 將只會使用 Windows 提供的元件，而不論系統上是否已安裝其他元件。</span><span class="sxs-lookup"><span data-stu-id="d80cf-157">When running in an AppContainer process, which includes all Windows Store apps, WIC will only use Windows-provided components, regardless of whether additional components are installed on the system.</span></span> <span data-ttu-id="d80cf-158">未在 AppContainer 中執行的應用程式不會受到影響。</span><span class="sxs-lookup"><span data-stu-id="d80cf-158">App that are not running in AppContainer are not affected.</span></span>

<span data-ttu-id="d80cf-159">應用程式不需要在 AppContainger 中執行任何程式碼變更，但 [**WICComponentEnumerateOptions**](/windows/win32/api/Wincodec/ne-wincodec-wiccomponentenumerateoptions) 旗標和廠商 GUID 參數將不會有任何作用。</span><span class="sxs-lookup"><span data-stu-id="d80cf-159">Apps don't need to make any code changes to run in an AppContainger, but the [**WICComponentEnumerateOptions**](/windows/win32/api/Wincodec/ne-wincodec-wiccomponentenumerateoptions) flag and vendor GUID parameters will have no effect.</span></span> <span data-ttu-id="d80cf-160">如果無法由 Windows 提供的編解碼器解碼，則 WIC 將無法載入映射，而且呼叫 [**CreateComponentEnumerator**](/windows/win32/api/Wincodec/nf-wincodec-iwicimagingfactory-createcomponentenumerator) 方法只會傳回 windows 提供的元件。</span><span class="sxs-lookup"><span data-stu-id="d80cf-160">WIC will fail to load an image if it cannot be decoded by a Windows provided codec, and calling the [**CreateComponentEnumerator**](/windows/win32/api/Wincodec/nf-wincodec-iwicimagingfactory-createcomponentenumerator) method will only return Windows provided components.</span></span>

### <a name="changes-to-clsid_wicpngdecoder-and-png-decoder-color-context-support"></a><span data-ttu-id="d80cf-161">CLSID \_ WICPngDecoder 和 PNG 解碼器色彩內容支援的變更</span><span class="sxs-lookup"><span data-stu-id="d80cf-161">Changes to CLSID\_WICPngDecoder and PNG decoder color context support</span></span>

<span data-ttu-id="d80cf-162">**CLSID \_** 已新增 WICPngDecoder1 與 **clsid \_ WICPNGDECODER** 相同的 GUID，並新增了 **clsid \_ WICPngDecoder2** 。</span><span class="sxs-lookup"><span data-stu-id="d80cf-162">**CLSID\_WICPngDecoder1** has been added with the same GUID as **CLSID\_WICPngDecoder**, and **CLSID\_WICPngDecoder2** has been added.</span></span>

<span data-ttu-id="d80cf-163">針對 Windows 8 SDK 編譯時， **clsid \_ WICPngDecoder** 會 \# 定義為 **clsid \_ WICPNGDECODER2** ，以使用新的 PNG 解碼器行為來升級新編譯的應用程式。</span><span class="sxs-lookup"><span data-stu-id="d80cf-163">When compiled against the Windows 8 SDK, **CLSID\_WICPngDecoder** is \#defined to **CLSID\_WICPngDecoder2** to promote newly compiled apps using the new PNG decoder behavior.</span></span> <span data-ttu-id="d80cf-164">應用程式應繼續指定 **CLSID \_ WICPngDecoder**。</span><span class="sxs-lookup"><span data-stu-id="d80cf-164">Apps should continue to specify **CLSID\_WICPngDecoder**.</span></span>

<span data-ttu-id="d80cf-165">指定 **CLSID \_ WICPngDecoder2** 將會建立 WIC PNG 解碼器的版本，此版本將會從 cHRM 和 GAMA 區塊產生 [**IWICColorCoNtext**](/windows/win32/api/Wincodec/nn-wincodec-iwiccolorcontext) 。</span><span class="sxs-lookup"><span data-stu-id="d80cf-165">Specifying **CLSID\_WICPngDecoder2** will create a version of the WIC PNG decoder that will generate an [**IWICColorContext**](/windows/win32/api/Wincodec/nn-wincodec-iwiccolorcontext) from cHRM and gAMA chunks.</span></span> <span data-ttu-id="d80cf-166">這可讓此色彩空間中繼資料與其他 Windows Api 搭配使用，以用於管理來源影像的色彩。</span><span class="sxs-lookup"><span data-stu-id="d80cf-166">This allows this color space metadata to be used with other Windows APIs for color managing the source image.</span></span> <span data-ttu-id="d80cf-167">如果有 iCCP 區塊，則不會從 gAMA 和 cHRM 區塊產生 **IWICColorCoNtext** ，如果出現 srgb 區塊，或 GAMA 和 cHRM 區塊指出 sRGB 色彩空間，則不會產生。</span><span class="sxs-lookup"><span data-stu-id="d80cf-167">An **IWICColorContext** is not generated from the gAMA and cHRM chunks if an iCCP chunk is present, if an sRGB chunk is present, or if the gAMA and cHRM chunks indicate an sRGB color space.</span></span>

<span data-ttu-id="d80cf-168">應用程式可以指定 **CLSID \_ WICPngDecoder1** 來建立不會從 gAMA 和 CHRM 區塊產生 [**IWICColorCoNtext**](/windows/win32/api/Wincodec/nn-wincodec-iwiccolorcontext) 的 WIC PNG 解碼版本。</span><span class="sxs-lookup"><span data-stu-id="d80cf-168">An app can specify **CLSID\_WICPngDecoder1** to create a version of the WIC PNG decoder that does not generate an [**IWICColorContext**](/windows/win32/api/Wincodec/nn-wincodec-iwiccolorcontext) from the gAMA and cHRM chunks.</span></span> <span data-ttu-id="d80cf-169">這與舊版 Windows 中的 PNG 解碼器行為相符。</span><span class="sxs-lookup"><span data-stu-id="d80cf-169">This matches the behavior of the PNG decoder in previous versions of Windows.</span></span>

### <a name="changes-to-wincodec_sdk_version"></a><span data-ttu-id="d80cf-170">WINCODEC \_ SDK 版本的 \_ 變更</span><span class="sxs-lookup"><span data-stu-id="d80cf-170">Changes to WINCODEC\_SDK\_VERSION</span></span>

<span data-ttu-id="d80cf-171">針對 Windows 8 SDK 進行編譯時，會將 **WINCODEC \_ sdk \_ 版本** \# 定義為 **WINCODEC \_ SDK \_ VERSION2** ，以使用新的 PNG 解碼器行為來升級新編譯的應用程式。</span><span class="sxs-lookup"><span data-stu-id="d80cf-171">When compiled against the Windows 8 SDK, **WINCODEC\_SDK\_VERSION** is \#defined to **WINCODEC\_SDK\_VERSION2** to promote newly compiled apps using the new PNG decoder behavior.</span></span> <span data-ttu-id="d80cf-172">否則，它會 \# 定義為 **WINCODEC \_ SDK \_ VERSION1**。</span><span class="sxs-lookup"><span data-stu-id="d80cf-172">Otherwise, it is \#defined to **WINCODEC\_SDK\_VERSION1**.</span></span> <span data-ttu-id="d80cf-173">應用程式應繼續指定 **WINCODEC \_ SDK \_ 版本**。</span><span class="sxs-lookup"><span data-stu-id="d80cf-173">Apps should continue to specify **WINCODEC\_SDK\_VERSION**.</span></span>

<span data-ttu-id="d80cf-174">在呼叫 [**WICCreateImagingFactory \_ Proxy**](-wic-codec-wiccreateimagingfactory-proxy.md)以建立映射處理站時指定 **WINCODEC \_ SDK \_ 版本**，會導致建立 **CLSID \_ WICPngDecoder2** ，而不是從 [**CreateDecoder**](/windows/win32/api/Wincodec/nf-wincodec-iwicimagingfactory-createdecoder)方法及其變異的 **clsid \_ WICPngDecoder1** 建立。</span><span class="sxs-lookup"><span data-stu-id="d80cf-174">Specifying **WINCODEC\_SDK\_VERSION** when calling [**WICCreateImagingFactory\_Proxy**](-wic-codec-wiccreateimagingfactory-proxy.md) to create the imaging factory causes **CLSID\_WICPngDecoder2** to be created instead of **CLSID\_WICPngDecoder1** from the [**CreateDecoder**](/windows/win32/api/Wincodec/nf-wincodec-iwicimagingfactory-createdecoder) method and its variants.</span></span> <span data-ttu-id="d80cf-175">此外，解碼器元件資訊列舉值會傳回 **clsid \_ WICPngDecoder2** 元件資訊，但不會傳回 **clsid \_ WICPngDecoder1** 資訊。</span><span class="sxs-lookup"><span data-stu-id="d80cf-175">Also, a decoder component info enumerator will return **CLSID\_WICPngDecoder2** component info, but not **CLSID\_WICPngDecoder1** info.</span></span>

<span data-ttu-id="d80cf-176">在上述案例中，指定 **WINCODEC \_ SDK \_ VERSION1** 將會導致使用 **clsid \_ WICPngDecoder1** ，而不是 **clsid \_ WICPngDecoder2** 。</span><span class="sxs-lookup"><span data-stu-id="d80cf-176">Specifying **WINCODEC\_SDK\_VERSION1** will cause **CLSID\_WICPngDecoder1** to be used instead of **CLSID\_WICPngDecoder2** in the above cases.</span></span>

### <a name="changes-to-clsid_wicimagingfactory"></a><span data-ttu-id="d80cf-177">CLSID WICImagingFactory 的變更 \_</span><span class="sxs-lookup"><span data-stu-id="d80cf-177">Changes to CLSID\_WICImagingFactory</span></span>

<span data-ttu-id="d80cf-178">**CLSID \_** 已新增 WICImagingFactory1 與 **clsid \_ WICIMAGINGFACTORY** 相同的 GUID，並新增了 **clsid \_ WICImagingFactory2** 。</span><span class="sxs-lookup"><span data-stu-id="d80cf-178">**CLSID\_WICImagingFactory1** has been added with the same GUID as **CLSID\_WICImagingFactory**, and **CLSID\_WICImagingFactory2** has been added.</span></span>

<span data-ttu-id="d80cf-179">針對 Windows 8 SDK 編譯時， **clsid \_ WICImagingFactory** 會 \# 定義為 **clsid \_ WICIMAGINGFACTORY2** ，以使用新的 PNG 解碼器行為來升級新編譯的應用程式。</span><span class="sxs-lookup"><span data-stu-id="d80cf-179">When compiled against the Windows 8 SDK, **CLSID\_WICImagingFactory** is \#defined to **CLSID\_WICImagingFactory2** to promote newly compiled apps using the new PNG decoder behavior.</span></span> <span data-ttu-id="d80cf-180">應用程式應繼續指定 **CLSID \_ WICImagingFactory**。</span><span class="sxs-lookup"><span data-stu-id="d80cf-180">Apps should continue to specify **CLSID\_WICImagingFactory**.</span></span>

<span data-ttu-id="d80cf-181">當呼叫 [**CoCreateInstance**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance)來建立映射處理站時，指定 **clsid \_ WICImagingFactory2** 會導致建立 **CLSID \_ WICPngDecoder2** ，而不是 [**CreateDecoder**](/windows/win32/api/Wincodec/nf-wincodec-iwicimagingfactory-createdecoder)方法及其變異的 **clsid \_ WICPngDecoder1** 。</span><span class="sxs-lookup"><span data-stu-id="d80cf-181">Specifying **CLSID\_WICImagingFactory2** when calling [**CoCreateInstance**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance) to create the imaging factory causes **CLSID\_WICPngDecoder2** to be created instead of **CLSID\_WICPngDecoder1** from the [**CreateDecoder**](/windows/win32/api/Wincodec/nf-wincodec-iwicimagingfactory-createdecoder) method and its variants.</span></span> <span data-ttu-id="d80cf-182">此外，解碼器元件資訊列舉值會傳回 **clsid \_ WICPngDecoder2** 元件資訊，但不會傳回 **clsid \_ WICPngDecoder1** 資訊。</span><span class="sxs-lookup"><span data-stu-id="d80cf-182">Also, a decoder component info enumerator will return **CLSID\_WICPngDecoder2** component info, but not **CLSID\_WICPngDecoder1** info.</span></span>

<span data-ttu-id="d80cf-183">在上述案例中，指定 **clsid \_ WICImagingFactory1** 會導致使用 **clsid \_ WICPngDecoder1** ，而不是 **clsid \_ WICPngDecoder2** 。</span><span class="sxs-lookup"><span data-stu-id="d80cf-183">Specifying **CLSID\_WICImagingFactory1** will cause **CLSID\_WICPngDecoder1** to be used instead of **CLSID\_WICPngDecoder2** in the above cases.</span></span>

## <a name="whats-new-for-windows-7"></a><span data-ttu-id="d80cf-184">Windows 7 的新功能</span><span class="sxs-lookup"><span data-stu-id="d80cf-184">What's new for Windows 7</span></span>

<span data-ttu-id="d80cf-185">在 Windows 7 中，WIC 已更新數個新功能。</span><span class="sxs-lookup"><span data-stu-id="d80cf-185">In Windows 7, WIC has been updated with several new features.</span></span> <span data-ttu-id="d80cf-186">本主題提供這些新功能的快速簡介。</span><span class="sxs-lookup"><span data-stu-id="d80cf-186">This topic provides a quick introduction to these new features.</span></span>

### <a name="updates-to-the-tiff-codec"></a><span data-ttu-id="d80cf-187">TIFF 編解碼器的更新</span><span class="sxs-lookup"><span data-stu-id="d80cf-187">Updates to the TIFF Codec</span></span>

<span data-ttu-id="d80cf-188">已更新 Windows 7 的 WIC TIFF 編解碼器，以支援舊版 WIC 不支援的數項功能。</span><span class="sxs-lookup"><span data-stu-id="d80cf-188">The WIC TIFF codec has been updated for Windows 7 to support several features not supported by the previous version of WIC.</span></span>

-   <span data-ttu-id="d80cf-189">支援大型 TIFF 檔案。</span><span class="sxs-lookup"><span data-stu-id="d80cf-189">Support for large TIFF files.</span></span>
-   <span data-ttu-id="d80cf-190">將已平平的 TIFF 影像解碼。</span><span class="sxs-lookup"><span data-stu-id="d80cf-190">Decode tiled TIFF images.</span></span>
-   <span data-ttu-id="d80cf-191">將平面 (平面) TIFF 影像。</span><span class="sxs-lookup"><span data-stu-id="d80cf-191">Decode flat (planar) TIFF images.</span></span>
-   <span data-ttu-id="d80cf-192">解碼 JPEG 編碼的 TIFF 影像。</span><span class="sxs-lookup"><span data-stu-id="d80cf-192">Decode JPEG encoded TIFF images.</span></span>

### <a name="progressive-decoding"></a><span data-ttu-id="d80cf-193">漸進式解碼</span><span class="sxs-lookup"><span data-stu-id="d80cf-193">Progressive Decoding</span></span>

<span data-ttu-id="d80cf-194">漸進式解碼能讓您在整個影像下載完成之前，以累加方式解碼和轉譯部分影像。</span><span class="sxs-lookup"><span data-stu-id="d80cf-194">Progressive decoding provides the ability to incrementally decode and render portions of an image before the entire image has finished downloading.</span></span> <span data-ttu-id="d80cf-195">這項功能可大幅改善從網際網路流覽影像時的使用者體驗，因為使用者不需要等待整個影像下載，就可以開始進行解碼。</span><span class="sxs-lookup"><span data-stu-id="d80cf-195">This feature greatly improves the user experience when viewing images from the Internet, because the user does not have to wait for the entire image to download before decoding can begin.</span></span> <span data-ttu-id="d80cf-196">使用漸進式解碼時，使用者可以在下載整個影像之前，看到有可用資料的影像預覽。</span><span class="sxs-lookup"><span data-stu-id="d80cf-196">With progressive decoding, users are able to see an image preview with available data long before the entire image is downloaded.</span></span> <span data-ttu-id="d80cf-197">這項功能對於任何用來從網際網路或受限頻寬的資料來源來查看影像的應用程式而言是不可或缺的。</span><span class="sxs-lookup"><span data-stu-id="d80cf-197">This feature is essential for any application used to view images from the Internet or from data sources with limited bandwidth.</span></span>

<span data-ttu-id="d80cf-198">如需詳細資訊，請參閱 [漸進式解碼總覽](-wic-progressive-decoding.md)。</span><span class="sxs-lookup"><span data-stu-id="d80cf-198">For more information, see the [Progressive Decoding Overview](-wic-progressive-decoding.md).</span></span>

### <a name="extended-metadata-support-for-jpeg-png-and-gif"></a><span data-ttu-id="d80cf-199">JPEG、PNG 和 GIF 的延伸中繼資料支援</span><span class="sxs-lookup"><span data-stu-id="d80cf-199">Extended Metadata Support for JPEG, PNG, and GIF</span></span>

<span data-ttu-id="d80cf-200">在 Windows 7 中，WIC 已擴充其對 JPEG、PNG 和 GIF 影像的中繼資料支援。</span><span class="sxs-lookup"><span data-stu-id="d80cf-200">In Windows 7, WIC has extended its metadata support for JPEG, PNG, and GIF images.</span></span>

-   <span data-ttu-id="d80cf-201">新增動畫 GIF 和 GIF 屬性的支援。</span><span class="sxs-lookup"><span data-stu-id="d80cf-201">Added support for animated GIF and GIF properties.</span></span>
-   <span data-ttu-id="d80cf-202">擴充的 JPG 元資料處理程式，可支援色度、亮度和批註中繼資料。</span><span class="sxs-lookup"><span data-stu-id="d80cf-202">Expanded JPG metadata handlers to support chrominance, luminance, and comment metadata.</span></span>
-   <span data-ttu-id="d80cf-203">擴充的 PNG 元資料處理程式，可支援時間、sRGB、iCCP、>hist、cHRM、iTXt、bKGD 和 gAMA 中繼資料。</span><span class="sxs-lookup"><span data-stu-id="d80cf-203">Expanded PNG metadata handlers to support tIME, sRGB, iCCP, hIST, cHRM, iTXt, bKGD, and gAMA metadata.</span></span>
-   <span data-ttu-id="d80cf-204">新增 ResolutionInfo 中繼資料和 IPTC 摘要中繼資料的新8BIM 元資料處理程式。</span><span class="sxs-lookup"><span data-stu-id="d80cf-204">Added new 8BIM metadata handlers for ResolutionInfo metadata and IPTC digest metadata.</span></span>
-   <span data-ttu-id="d80cf-205">已新增邏輯螢幕描述元的新元資料處理程式 (LSD) 、影像描述元 (IMD) 、圖形控制項延伸 (GCE) ，以及應用程式延伸模組 (n) 中繼資料。</span><span class="sxs-lookup"><span data-stu-id="d80cf-205">Added new metadata handlers for Logical Screen Descriptor (LSD), Image Descriptor (IMD), Graphic Control Extensions (GCE), and Application Extensions (APE) metadata.</span></span>
-   <span data-ttu-id="d80cf-206">支援跨越 APPn 區塊的中繼資料。</span><span class="sxs-lookup"><span data-stu-id="d80cf-206">Support for metadata that spans APPn blocks.</span></span>

### <a name="multi-threaded-apartment-support"></a><span data-ttu-id="d80cf-207">多執行緒的單元支援</span><span class="sxs-lookup"><span data-stu-id="d80cf-207">Multi Threaded Apartment Support</span></span>

<span data-ttu-id="d80cf-208">多執行緒單元內的物件 (MTA) 可由 MTA 內任意數目的執行緒同時呼叫，以提供多核心系統和特定伺服器案例的效能提升。</span><span class="sxs-lookup"><span data-stu-id="d80cf-208">Objects within a multithreaded apartment (MTA) may be called concurrently by any number of threads within the MTA, allowing for better performance on multicore systems and certain server scenarios.</span></span> <span data-ttu-id="d80cf-209">此外，位於 MTA 內的 WIC 編解碼器，可以呼叫位於 MTA 內的其他物件，而不需要在存留于不同 STA 單元的執行緒之間呼叫的封送處理成本。</span><span class="sxs-lookup"><span data-stu-id="d80cf-209">In addition, WIC codecs that live within an MTA can call other objects that live within the MTA without the marshaling cost associated of calling between threads that live in different STA apartments.</span></span> <span data-ttu-id="d80cf-210">在 Windows 7 中，所有的內建 WIC 編解碼器都已更新為支援 MTA，包括 JPEG、TIFF、PNG、GIF、.ICO 和 BMP。</span><span class="sxs-lookup"><span data-stu-id="d80cf-210">In Windows 7, all in-box WIC codecs have been updated to support MTA, including JPEG, TIFF, PNG, GIF, ICO, and BMP.</span></span> <span data-ttu-id="d80cf-211">強烈建議您撰寫編解碼器以支援 MTA。</span><span class="sxs-lookup"><span data-stu-id="d80cf-211">It is highly recommended that codecs be written to support MTA.</span></span> <span data-ttu-id="d80cf-212">不支援 MTA 的編解碼器會在多執行緒應用程式中造成效能大幅降低，因為封送處理。</span><span class="sxs-lookup"><span data-stu-id="d80cf-212">Codecs that do not support MTA will cause significant performance degredation in multithreaded applications due to marshaling.</span></span> <span data-ttu-id="d80cf-213">啟用 MTA 支援需要在編解碼器中執行適當的同步處理。</span><span class="sxs-lookup"><span data-stu-id="d80cf-213">Enabling MTA support requires proper synchronization to be implemented in the codec.</span></span> <span data-ttu-id="d80cf-214">這些同步處理技術的確切執行已超出本檔的範圍。</span><span class="sxs-lookup"><span data-stu-id="d80cf-214">Exact implementation of these synchronization techniques is beyond the scope of this paper.</span></span> <span data-ttu-id="d80cf-215">以下提供同步處理元件物件模型 (COM) 物件的一般參考。</span><span class="sxs-lookup"><span data-stu-id="d80cf-215">A general reference for synchronizing Component Object Model (COM) objects is provided below.</span></span>

### <a name="metadata-working-group-implementations"></a><span data-ttu-id="d80cf-216">中繼資料工作群組實施</span><span class="sxs-lookup"><span data-stu-id="d80cf-216">Metadata Working Group Implementations</span></span>

<span data-ttu-id="d80cf-217">目前有各種不同的中繼資料儲存格式包含重迭的屬性，不含任何明確的產業標準或讀取和寫入這些元資料格式的一致方法指引。</span><span class="sxs-lookup"><span data-stu-id="d80cf-217">There are currently a variety of metadata storage formats that contain overlapping properties, without any clear industry standard or guidance on consistent methods for reading and writing these metadata formats.</span></span> <span data-ttu-id="d80cf-218">為了協助使用這各種格式和屬性， (MWG) 的中繼資料工作群組形成。</span><span class="sxs-lookup"><span data-stu-id="d80cf-218">To help with this variety of formats and properties, the Metadata Working Group (MWG) was formed.</span></span> <span data-ttu-id="d80cf-219">MWG 的目的是要提供指導方針，以確保各種平臺、應用程式和裝置之間的互通性。</span><span class="sxs-lookup"><span data-stu-id="d80cf-219">The aim of the MWG is to provide guidelines that ensure interoperability among a wide variety of platforms, applications, and devices.</span></span> <span data-ttu-id="d80cf-220">MWG 所建立的指導方針適用于 XMP、Exif 和 IPTC 元資料欄位，以及 JPEG、TIFF 和 PSD 影像格式。</span><span class="sxs-lookup"><span data-stu-id="d80cf-220">The guidelines established by the MWG apply to the XMP, Exif, and IPTC metadata fields, and to the JPEG, TIFF, and PSD image formats.</span></span>

<span data-ttu-id="d80cf-221">在 Windows 7 中，相片元資料處理程式和中繼資料原則層已更新為根據 MWG 所建立的指導方針來讀取和寫入影像中繼資料。</span><span class="sxs-lookup"><span data-stu-id="d80cf-221">In Windows 7, the photo metadata handler and the metadata policy layer have been updated to read and write image metadata according to the guidelines established by the MWG.</span></span> <span data-ttu-id="d80cf-222">如需有關中繼資料工作群組 (MWG) 的詳細資訊，請參閱已 [建立的中繼資料指導方針](https://s3.amazonaws.com/software.tagthatphoto.com/docs/mwg_guidance.pdf)。</span><span class="sxs-lookup"><span data-stu-id="d80cf-222">For more information on the Metadata Working Group (MWG), view the [established metadata guidelines](https://s3.amazonaws.com/software.tagthatphoto.com/docs/mwg_guidance.pdf).</span></span>

### <a name="windows-7-features-supported-on-windows-vista-and-windows-server-2008"></a><span data-ttu-id="d80cf-223">Windows Vista 和 Windows Server 2008 支援的 windows 7 功能</span><span class="sxs-lookup"><span data-stu-id="d80cf-223">Windows 7 features supported on Windows Vista and Windows Server 2008</span></span>

<span data-ttu-id="d80cf-224">[Windows Vista 的平臺更新](../win7ip/platform-update-for-windows-vista-portal.md)是一組執行時間程式庫，可讓開發人員將應用程式的目標設為 windows 7 和 windows Vista。</span><span class="sxs-lookup"><span data-stu-id="d80cf-224">The [Platform Update for Windows Vista](../win7ip/platform-update-for-windows-vista-portal.md) is a set of run-time libraries that enables developers to target applications to both Windows 7 and Windows Vista.</span></span> <span data-ttu-id="d80cf-225">Windows Server 2008 的平臺更新是一組執行時間程式庫，可讓開發人員將應用程式的目標設為 Windows Server 2008 R2 和 Windows Server 2008。</span><span class="sxs-lookup"><span data-stu-id="d80cf-225">The Platform Update for Windows Server 2008 is a set of run-time libraries that enables developers to target applications to both Windows Server 2008 R2 and Windows Server 2008.</span></span> <span data-ttu-id="d80cf-226">所有 Windows Vista 和 Windows Server 2008 客戶都可以透過 Windows Update，取得 Windows Vista 的平臺更新和 Windows Server 2008 的平臺更新。</span><span class="sxs-lookup"><span data-stu-id="d80cf-226">The Platform Update for Windows Vista and the Platform Update for Windows Server 2008 will be available to all Windows Vista and Windows Server 2008 customers through Windows Update.</span></span> <span data-ttu-id="d80cf-227">需要適用于 Windows Vista 或 Windows Server 2008 平臺更新的協力廠商應用程式，可以 Windows Update 偵測是否已安裝必要的更新;如果不是，Windows Update 會在背景中下載並安裝它。</span><span class="sxs-lookup"><span data-stu-id="d80cf-227">Third-party applications that require Platform Update for Windows Vista or Platform Update for Windows Server 2008 can have Windows Update detect whether the required updated is installed; if it is not, Windows Update will download and install it in the background.</span></span> <span data-ttu-id="d80cf-228">如需這兩項更新的詳細資訊，請參閱 Windows Vista 的平臺更新。</span><span class="sxs-lookup"><span data-stu-id="d80cf-228">For more information about both updates, see Platform Update for Windows Vista</span></span>

 

 
