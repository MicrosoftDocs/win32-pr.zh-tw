---
description: 本主題介紹 Windows 影像處理元件 (WIC) 的中繼資料查詢語言。
ms.assetid: 5ffa0a69-b53d-4be3-b802-deaaa743e6bd
title: 中繼資料查詢語言總覽
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: ee4b55bdc7079565f98411e28977d3d8c41e191f
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/08/2021
ms.locfileid: "104567275"
---
# <a name="metadata-query-language-overview"></a><span data-ttu-id="80cec-103">中繼資料查詢語言總覽</span><span class="sxs-lookup"><span data-stu-id="80cec-103">Metadata Query Language Overview</span></span>

<span data-ttu-id="80cec-104">本主題介紹 Windows 影像處理元件 (WIC) 的中繼資料查詢語言。</span><span class="sxs-lookup"><span data-stu-id="80cec-104">This topic introduces the metadata query language for Windows Imaging Component (WIC).</span></span> <span data-ttu-id="80cec-105">您可以使用中繼資料查詢語言來建立運算式，以找出特定資料 (中繼資料專案) 和位置 (中繼資料區塊) 在影像的中繼資料內。</span><span class="sxs-lookup"><span data-stu-id="80cec-105">You use the metadata query language to create expressions that find specific data (metadata items) and locations (metadata blocks) within the metadata of an image.</span></span>

<span data-ttu-id="80cec-106">本主題包含下列各節。</span><span class="sxs-lookup"><span data-stu-id="80cec-106">This topic contains the following sections.</span></span>

-   [<span data-ttu-id="80cec-107">先決條件</span><span class="sxs-lookup"><span data-stu-id="80cec-107">Prerequisites</span></span>](#prerequisites)
-   [<span data-ttu-id="80cec-108">簡介</span><span class="sxs-lookup"><span data-stu-id="80cec-108">Introduction</span></span>](#introduction)
-   [<span data-ttu-id="80cec-109">路徑運算式的剖析</span><span class="sxs-lookup"><span data-stu-id="80cec-109">Anatomy of a Path Expression</span></span>](#anatomy-of-a-path-expression)
    -   [<span data-ttu-id="80cec-110">區塊選取</span><span class="sxs-lookup"><span data-stu-id="80cec-110">Block Selection</span></span>](#block-selection)
    -   [<span data-ttu-id="80cec-111">專案選取</span><span class="sxs-lookup"><span data-stu-id="80cec-111">Item Selection</span></span>](#item-selection)
    -   [<span data-ttu-id="80cec-112">Escape 字元</span><span class="sxs-lookup"><span data-stu-id="80cec-112">Escape Character</span></span>](#escape-character)
    -   [<span data-ttu-id="80cec-113">範例運算式</span><span class="sxs-lookup"><span data-stu-id="80cec-113">Sample Expressions</span></span>](#sample-expressions)
-   [<span data-ttu-id="80cec-114">相片中繼資料原則運算式</span><span class="sxs-lookup"><span data-stu-id="80cec-114">Photo Metadata Policy Expressions</span></span>](#photo-metadata-policy-expressions)
-   [<span data-ttu-id="80cec-115">中繼資料查詢語言摘要</span><span class="sxs-lookup"><span data-stu-id="80cec-115">Metadata Query Language Summary</span></span>](#metadata-query-language-summary)
-   [<span data-ttu-id="80cec-116">相關主題</span><span class="sxs-lookup"><span data-stu-id="80cec-116">Related topics</span></span>](#related-topics)

## <a name="prerequisites"></a><span data-ttu-id="80cec-117">必要條件</span><span class="sxs-lookup"><span data-stu-id="80cec-117">Prerequisites</span></span>

<span data-ttu-id="80cec-118">若要瞭解本主題，您應該熟悉 wic 中繼資料 [總覽](-wic-about-metadata.md) 中所述的 wic 中繼資料系統，以及存取中繼資料（如 [讀取和寫入影像中繼資料的總覽](-wic-codec-readingwritingmetadata.md)所述）。</span><span class="sxs-lookup"><span data-stu-id="80cec-118">To understand this topic, you should be familiar with the WIC metadata system as described in the [WIC Metadata Overview](-wic-about-metadata.md) and accessing metadata, as described in the [Overview of Reading and Writing Image Metadata](-wic-codec-readingwritingmetadata.md).</span></span>

## <a name="introduction"></a><span data-ttu-id="80cec-119">簡介</span><span class="sxs-lookup"><span data-stu-id="80cec-119">Introduction</span></span>

<span data-ttu-id="80cec-120">您主要透過兩個元件物件模型來與中繼資料平臺互動 (COM) 元件： [**IWICMetadataQueryReader**](/windows/desktop/api/Wincodec/nn-wincodec-iwicmetadataqueryreader) 介面所代表的查詢讀取器，以及由 [**IWICMetadataQueryWriter**](/windows/desktop/api/Wincodec/nn-wincodec-iwicmetadataquerywriter) 介面表示的查詢寫入器。</span><span class="sxs-lookup"><span data-stu-id="80cec-120">You interact with the metadata platform primarily through two Component Object Model (COM) components: a query reader, represented by the [**IWICMetadataQueryReader**](/windows/desktop/api/Wincodec/nn-wincodec-iwicmetadataqueryreader) interface, and a query writer, represented by the [**IWICMetadataQueryWriter**](/windows/desktop/api/Wincodec/nn-wincodec-iwicmetadataquerywriter) interface.</span></span> <span data-ttu-id="80cec-121">這些元件可讓您使用中繼資料查詢語言來讀取或寫入中繼資料。</span><span class="sxs-lookup"><span data-stu-id="80cec-121">These components enable you to read or write metadata using the metadata query language.</span></span> <span data-ttu-id="80cec-122">查詢語言描述路徑運算式的語法，而查詢元件會使用這個路徑運算式來存取所需的中繼資料。</span><span class="sxs-lookup"><span data-stu-id="80cec-122">The query language describes the syntax of a path expression and the query components use this path expression to access the desired metadata.</span></span> <span data-ttu-id="80cec-123">此路徑運算式描述中繼資料區塊或專案的位置。</span><span class="sxs-lookup"><span data-stu-id="80cec-123">This path expression describes the location of a metadata block or item.</span></span>

<span data-ttu-id="80cec-124">中繼資料區塊是特定格式之中繼資料的命名群組。</span><span class="sxs-lookup"><span data-stu-id="80cec-124">A metadata block is a named group of metadata in a specific format.</span></span> <span data-ttu-id="80cec-125">中繼資料區塊可以包含個別的中繼資料專案，例如作者或建立時間，以及其他中繼資料區塊。</span><span class="sxs-lookup"><span data-stu-id="80cec-125">A metadata block can contain individual metadata items such as an author or creation time and additional metadata blocks.</span></span> <span data-ttu-id="80cec-126">中繼資料區塊的名稱是由其格式所決定。</span><span class="sxs-lookup"><span data-stu-id="80cec-126">A metadata block's name is determined by its format.</span></span> <span data-ttu-id="80cec-127">例如，包含 App1 中繼資料的中繼資料區塊會命名為 "App1"。</span><span class="sxs-lookup"><span data-stu-id="80cec-127">For example, a metadata block containing App1 metadata would be named "app1".</span></span> <span data-ttu-id="80cec-128">常見的元資料格式包括 App1、Exif、IFD 和 XMP。</span><span class="sxs-lookup"><span data-stu-id="80cec-128">Common metadata formats include App1, Exif, IFD, and XMP.</span></span>

<span data-ttu-id="80cec-129">中繼資料專案是描述特性的名稱/值組，例如作者、標題和評等。</span><span class="sxs-lookup"><span data-stu-id="80cec-129">A metadata item is a name/value pair that describes characteristics like author, title, and rating.</span></span>

<span data-ttu-id="80cec-130">路徑運算式包含一或多個中繼資料區塊名稱。</span><span class="sxs-lookup"><span data-stu-id="80cec-130">A path expression contains one or more metadata block names.</span></span> <span data-ttu-id="80cec-131">它也可以在中繼資料區塊內指定中繼資料專案。</span><span class="sxs-lookup"><span data-stu-id="80cec-131">It can also specify a metadata item within a metadata block.</span></span> <span data-ttu-id="80cec-132">下列路徑運算式代表 App1 區塊，其中包含包含中繼資料專案的 IFD 區塊：</span><span class="sxs-lookup"><span data-stu-id="80cec-132">The following path expression represents an App1 block which contains an IFD block which contains the metadata item:</span></span>

-   <span data-ttu-id="80cec-133">/app1/ifd/{ushort = 18249}</span><span class="sxs-lookup"><span data-stu-id="80cec-133">/app1/ifd/{ushort=18249}</span></span>

<span data-ttu-id="80cec-134">下圖說明包含四個根中繼資料區塊之範例 JPEG 影像的組成： App0、App1、XMP 和 unknown 區塊。</span><span class="sxs-lookup"><span data-stu-id="80cec-134">The following diagram illustrates the makeup of an example JPEG image with four root metadata blocks: App0, App1, XMP, and an unknown block.</span></span> <span data-ttu-id="80cec-135">每個醒目提示的專案都會注明中繼資料的類型 (區塊或專案) ，以及用來取出資料的查詢運算式。</span><span class="sxs-lookup"><span data-stu-id="80cec-135">Each highlighted item notes the type of metadata (block or item) and the query expression used to retrieve the data.</span></span>

![具有中繼資料標注的 jpeg 影像](graphics/jpegwithcallouts.png)

> [!Note]  
> <span data-ttu-id="80cec-137">此圖表的內容會在此檔中參考，並用於許多範例中。</span><span class="sxs-lookup"><span data-stu-id="80cec-137">The contents of this diagram are referenced throughout this document and are used in many of the examples.</span></span>

 

## <a name="anatomy-of-a-path-expression"></a><span data-ttu-id="80cec-138">路徑運算式的剖析</span><span class="sxs-lookup"><span data-stu-id="80cec-138">Anatomy of a Path Expression</span></span>

<span data-ttu-id="80cec-139">若要使用 WIC Api 來存取中繼資料，在大部分情況下都必須使用完整的查詢運算式。</span><span class="sxs-lookup"><span data-stu-id="80cec-139">To access metadata using the WIC APIs, a fully qualified query expression must be used in most cases.</span></span> <span data-ttu-id="80cec-140">本主題討論用來存取中繼資料的完整運算式。</span><span class="sxs-lookup"><span data-stu-id="80cec-140">This topic discusses fully qualified expressions for accessing metadata.</span></span> <span data-ttu-id="80cec-141">如果您需要有關使用非完整運算式之案例的資訊，請參閱本檔稍後的「相片中繼資料原則運算式」一節。</span><span class="sxs-lookup"><span data-stu-id="80cec-141">If you need information about the cases in which non-fully qualified expressions are used, refer to the Photo Metadata Policy Expression section later in this document.</span></span>

<span data-ttu-id="80cec-142">什麼是完整的查詢運算式？</span><span class="sxs-lookup"><span data-stu-id="80cec-142">What is a fully qualified query expression?</span></span> <span data-ttu-id="80cec-143">在 WIC 中，完整的運算式是開頭為路徑字元斜線 (/) 的字串，後面接著中繼資料區塊或特定中繼資料專案的導覽路徑。</span><span class="sxs-lookup"><span data-stu-id="80cec-143">In WIC, a fully qualified expression is a string that begins with the path character slash (/), followed by a navigation path to a metadata block or a specific metadata item.</span></span> <span data-ttu-id="80cec-144">導覽路徑內的每個步驟都是以斜線分隔，形成用來存取中繼資料區塊或中繼資料專案的運算式。</span><span class="sxs-lookup"><span data-stu-id="80cec-144">Each step within the navigation path is separated by a slash, forming an expression for accessing a metadata block or a metadata item.</span></span> <span data-ttu-id="80cec-145">例如，以下是完整的查詢運算式，可存取在 App1 區塊中嵌套的 IFD 區塊中的 Microsoft 相片分級：</span><span class="sxs-lookup"><span data-stu-id="80cec-145">For example, the following is a fully qualified query expression that accesses the Microsoft Photo Rating in an IFD block that is nested in an App1 block:</span></span>

-   <span data-ttu-id="80cec-146">/app1/ifd/{ushort = 18249}</span><span class="sxs-lookup"><span data-stu-id="80cec-146">/app1/ifd/{ushort=18249}</span></span>

<span data-ttu-id="80cec-147">當 WIC 剖析此運算式時，它會先在映射的中繼資料內搜尋 App1 中繼資料區塊。</span><span class="sxs-lookup"><span data-stu-id="80cec-147">When WIC parses this expression, it first searches for the App1 metadata block within the image's metadata.</span></span> <span data-ttu-id="80cec-148">如果找到 App1 區塊，則會繼續搜尋以尋找嵌套的 IFD 中繼資料區塊。</span><span class="sxs-lookup"><span data-stu-id="80cec-148">If the App1 block is found, it continues its search looking for the nested IFD metadata block.</span></span> <span data-ttu-id="80cec-149">如果找到了 IFD 區塊，則會在此案例中尋找特定的中繼資料專案，在此案例中為在 IFD 中繼資料區塊內的標記18249下的 MicrosoftPhoto 評等。</span><span class="sxs-lookup"><span data-stu-id="80cec-149">If the IFD block is found, it then looks for the specific metadata item, in this case the MicrosoftPhoto rating under the tag 18249, within the IFD metadata block.</span></span> <span data-ttu-id="80cec-150">如果任何時間的 WIC 都找不到中繼資料區塊或專案，它就會中止查詢。</span><span class="sxs-lookup"><span data-stu-id="80cec-150">If at any time WIC does not find a metadata block or item, it aborts the query.</span></span>

### <a name="block-selection"></a><span data-ttu-id="80cec-151">區塊選取</span><span class="sxs-lookup"><span data-stu-id="80cec-151">Block Selection</span></span>

<span data-ttu-id="80cec-152">最簡單的 WIC 中繼資料查詢運算式是取得特定中繼資料區塊之查詢讀取器/寫入器的運算式。</span><span class="sxs-lookup"><span data-stu-id="80cec-152">The simplest WIC metadata query expression is an expression to obtain a query reader/writer for a specific metadata block.</span></span> <span data-ttu-id="80cec-153">取得查詢讀取器/寫入器可讓您直接將後續查詢直接導向至嵌套的中繼資料區塊，而不需要處理其父區塊。</span><span class="sxs-lookup"><span data-stu-id="80cec-153">Obtaining a query reader/writer enables you to direct subsequent queries directly to a nested metadata block without dealing with its parent block.</span></span> <span data-ttu-id="80cec-154">區塊選取查詢運算式是所需中繼資料區塊的導覽路徑。</span><span class="sxs-lookup"><span data-stu-id="80cec-154">A block selection query expression is a navigation path to the desired metadata block.</span></span> <span data-ttu-id="80cec-155">例如，在上圖中，有五個中繼資料區塊，其中兩個會嵌套在其他中繼資料區塊中。</span><span class="sxs-lookup"><span data-stu-id="80cec-155">For example, in the previous illustration there are five metadata blocks, two of which are nested in other metadata blocks.</span></span> <span data-ttu-id="80cec-156">以下是 JPEG 範例中每個中繼資料區塊的路徑運算式：</span><span class="sxs-lookup"><span data-stu-id="80cec-156">The following are the path expressions to each metadata block in the JPEG example:</span></span>

-   <span data-ttu-id="80cec-157">/app0</span><span class="sxs-lookup"><span data-stu-id="80cec-157">/app0</span></span>
-   <span data-ttu-id="80cec-158">/app1</span><span class="sxs-lookup"><span data-stu-id="80cec-158">/app1</span></span>
-   <span data-ttu-id="80cec-159">/app1/ifd</span><span class="sxs-lookup"><span data-stu-id="80cec-159">/app1/ifd</span></span>
-   <span data-ttu-id="80cec-160">/app1/ifd/exif</span><span class="sxs-lookup"><span data-stu-id="80cec-160">/app1/ifd/exif</span></span>
-   <span data-ttu-id="80cec-161">/xmp</span><span class="sxs-lookup"><span data-stu-id="80cec-161">/xmp</span></span>

<span data-ttu-id="80cec-162">當您使用查詢讀取器/寫入器來執行查詢時，它會傳回新的查詢讀取器/寫入器，以服務指定之中繼資料區塊範圍內的查詢。</span><span class="sxs-lookup"><span data-stu-id="80cec-162">When you use a query reader/writer to execute a query, it returns a new query reader/writer that services queries within the scope of the specified metadata block.</span></span> <span data-ttu-id="80cec-163">比方說，如果您執行查詢 "/app1"，就會取得新的查詢讀取器，而對新的讀取器的查詢則是相對於 App1 區塊。</span><span class="sxs-lookup"><span data-stu-id="80cec-163">For instance, if you execute the query "/app1" , a new query reader is obtained and queries to the new reader are relative to the App1 block.</span></span> <span data-ttu-id="80cec-164">這表示查詢 "/ifd" 對新的讀取器有效，因為 App1 區塊包含 IFD 區塊。</span><span class="sxs-lookup"><span data-stu-id="80cec-164">This means that the query "/ifd" is valid for the new reader because the App1 block contains an IFD block.</span></span> <span data-ttu-id="80cec-165">不過，"/xmp" 無法運作，因為這個 App1 區塊不包含 XMP 中繼資料區塊。</span><span class="sxs-lookup"><span data-stu-id="80cec-165">However, "/xmp" would not work because this App1 block does not contain an XMP metadata block.</span></span>

<span data-ttu-id="80cec-166">查詢語言也支援索引標記法。</span><span class="sxs-lookup"><span data-stu-id="80cec-166">The query language also supports an index notation.</span></span> <span data-ttu-id="80cec-167">當有多個相同類型的區塊存在時，索引標記法可讓您存取特定的中繼資料區塊。</span><span class="sxs-lookup"><span data-stu-id="80cec-167">Index notation provides access to a specific metadata block when multiple blocks of the same type exist.</span></span> <span data-ttu-id="80cec-168">在 JPEG 範例中，可以使用下列索引路徑運算式：</span><span class="sxs-lookup"><span data-stu-id="80cec-168">For the JPEG example, the following indexed path expression can be used:</span></span>

-   <span data-ttu-id="80cec-169">/\[0 \] app1/ \[ 0 的 \] ifd</span><span class="sxs-lookup"><span data-stu-id="80cec-169">/\[0\]app1/\[0\]ifd</span></span>

<span data-ttu-id="80cec-170">在查詢語言中，所有索引都會從零開始。</span><span class="sxs-lookup"><span data-stu-id="80cec-170">In the query language, all indexes start at zero.</span></span> <span data-ttu-id="80cec-171">在先前的運算式中，第一個 App1 區塊的第零個查詢和第二個零查詢會查詢第一個嵌套的 IFD 區塊。</span><span class="sxs-lookup"><span data-stu-id="80cec-171">In the previous expression, the first zero queries for the first App1 block and the second zero queries the first nested IFD block.</span></span> <span data-ttu-id="80cec-172">即使有多個相同類型的區塊不存在，仍然可以使用索引標記法。</span><span class="sxs-lookup"><span data-stu-id="80cec-172">Index notation can still be used even when multiple blocks of the same type do not exist.</span></span> <span data-ttu-id="80cec-173">如果範例 JPEG 包含具有內嵌 IFD 區塊的第二個 App1 區塊，則會使用運算式 "/ \[ 1 \] App1/IFD" 來存取第二個 App1 區塊。</span><span class="sxs-lookup"><span data-stu-id="80cec-173">If the example JPEG included a second App1 block with an embedded IFD block, the expression "/\[1\]app1/ifd" would be used to access the second App1 block.</span></span>

<span data-ttu-id="80cec-174">在處理 PNG 文字區塊時，索引標記法會變得更常見，因為 PNG 影像可能會有一個以上的文字區塊。</span><span class="sxs-lookup"><span data-stu-id="80cec-174">Index notation becomes more common when dealing with PNG tEXt chunks because it is likely that the PNG image will have more than one tEXt chunk.</span></span>

> [!Note]  
> <span data-ttu-id="80cec-175">不支援多維度陣列索引。</span><span class="sxs-lookup"><span data-stu-id="80cec-175">Multidimensional array indexes are not supported.</span></span>

 

### <a name="item-selection"></a><span data-ttu-id="80cec-176">專案選取</span><span class="sxs-lookup"><span data-stu-id="80cec-176">Item Selection</span></span>

<span data-ttu-id="80cec-177">您可以藉由建立區塊選取運算式來存取中繼資料區塊中的中繼資料專案。</span><span class="sxs-lookup"><span data-stu-id="80cec-177">You can access the metadata items in a metadata block by building on the block selection expressions.</span></span> <span data-ttu-id="80cec-178">請考慮 JPEG 範例中的 XMP 和 Microsoft 照片評等屬性。</span><span class="sxs-lookup"><span data-stu-id="80cec-178">Consider the XMP and Microsoft Photo rating properties in the JPEG example.</span></span> <span data-ttu-id="80cec-179">此中繼資料存在於兩個中繼資料區塊中： App1/IFD 和 XMP 區塊。</span><span class="sxs-lookup"><span data-stu-id="80cec-179">This metadata exists in two metadata blocks: the App1/IFD and XMP blocks.</span></span> <span data-ttu-id="80cec-180">因此，可以使用一個以上的運算式來存取相同的資料。</span><span class="sxs-lookup"><span data-stu-id="80cec-180">Therefore, more than one expression can be used to access the same data.</span></span> <span data-ttu-id="80cec-181">下列運算式會存取 XMP 區塊中的 MicrosoftPhoto 評等：</span><span class="sxs-lookup"><span data-stu-id="80cec-181">The following expression accesses the MicrosoftPhoto rating in the XMP block:</span></span>

-   <span data-ttu-id="80cec-182">/xmp/xmp：評等</span><span class="sxs-lookup"><span data-stu-id="80cec-182">/xmp/xmp:Rating</span></span>

<span data-ttu-id="80cec-183">運算式的 "xmp：" 部分是易記的架構識別碼。</span><span class="sxs-lookup"><span data-stu-id="80cec-183">The "xmp:" part of the expression is a schema friendly identifier.</span></span> <span data-ttu-id="80cec-184">XMP 是可擴充的標準，可讓協力廠商實體發行自己的架構，以定義如何儲存某些中繼資料專案。</span><span class="sxs-lookup"><span data-stu-id="80cec-184">XMP is an extensible standard and allows third party entities to publish their own schemas which define how to store certain metadata items.</span></span> <span data-ttu-id="80cec-185">XMP 架構是由 URL 完整識別，但是 WIC 針對已知的架構提供了一組易記的識別碼。</span><span class="sxs-lookup"><span data-stu-id="80cec-185">An XMP schema is fully identified by a URL, but WIC provides a set of friendly identifiers for well-known schemas.</span></span> <span data-ttu-id="80cec-186">如需詳細資訊，請參閱 [原生影像格式中繼資料查詢](-wic-native-image-format-metadata-queries.md) 主題。</span><span class="sxs-lookup"><span data-stu-id="80cec-186">For more information, see the [Native Image Format Metadata Queries](-wic-native-image-format-metadata-queries.md) topic.</span></span>

<span data-ttu-id="80cec-187">針對 JPEG 影像，評等資訊也可以儲存在 App1 nested 的 IFD 區塊內。</span><span class="sxs-lookup"><span data-stu-id="80cec-187">For JPEG images, rating information can also be stored within the App1 nested IFD block.</span></span> <span data-ttu-id="80cec-188">不過，不同于 XMP 評等範例，IFD 區塊不會使用架構名稱來存取評等資訊。</span><span class="sxs-lookup"><span data-stu-id="80cec-188">However, unlike the XMP rating example, the IFD block does not use a schema name to access the rating information.</span></span> <span data-ttu-id="80cec-189">您可以改用日期運算式。</span><span class="sxs-lookup"><span data-stu-id="80cec-189">You use a data expression instead.</span></span> <span data-ttu-id="80cec-190">下列運算式是用來存取 App1 nested 的 IFD 區塊中的 MicrosoftPhoto 評等：</span><span class="sxs-lookup"><span data-stu-id="80cec-190">The following expression is used to access the MicrosoftPhoto rating in the App1 nested IFD block:</span></span>

-   <span data-ttu-id="80cec-191">/app1/ifd/{ushort = 18249}</span><span class="sxs-lookup"><span data-stu-id="80cec-191">/app1/ifd/{ushort=18249}</span></span>

<span data-ttu-id="80cec-192">在此運算式中，運算式的 "/app1/ifd" 部分是 IFD 區塊的導覽路徑 (如先前在 [區塊選取] 區段中所述) 。</span><span class="sxs-lookup"><span data-stu-id="80cec-192">In this expression, the "/app1/ifd" part of the expression is the navigation path to the IFD block (as discussed previously in the Block Selection section).</span></span> <span data-ttu-id="80cec-193">運算式 "/{ushort = 18249}" 的第二個部分會存取資料。</span><span class="sxs-lookup"><span data-stu-id="80cec-193">The second part of the expression "/{ushort=18249}" accesses the data.</span></span> <span data-ttu-id="80cec-194">運算式的這個部分會指示查詢剖析器尋找內嵌在不帶正負號之簡短標記中的資料，其標記識別項為18249。</span><span class="sxs-lookup"><span data-stu-id="80cec-194">This part of the expression instructs the query parser to find the data embedded in the unsigned short tag that has the tag identifier 18249.</span></span>

> [!Note]  
> <span data-ttu-id="80cec-195">如需每個影像格式所支援的通用元資料格式清單，請參閱 [原生影像格式中繼資料查詢](-wic-native-image-format-metadata-queries.md) 主題。</span><span class="sxs-lookup"><span data-stu-id="80cec-195">For a list of common metadata formats supported by each image format at, see the [Native Image Format Metadata Queries](-wic-native-image-format-metadata-queries.md) topic.</span></span>

 

<span data-ttu-id="80cec-196">{Ushort = 18249} 是日期運算式，可採用數種形式。</span><span class="sxs-lookup"><span data-stu-id="80cec-196">The {ushort=18249} is a data expression and can take several forms.</span></span> <span data-ttu-id="80cec-197">日期運算式是包含所要求之元資料標記或索引鍵（在此案例中為 "18249"）的兩個部分運算式，以及索引鍵的資料類型（在此案例中為 "ushort"）。</span><span class="sxs-lookup"><span data-stu-id="80cec-197">A data expression is a two part expression containing the requested metadata tag or key, in this case "18249", and the data type of the key, in this case "ushort".</span></span> <span data-ttu-id="80cec-198">這兩個部分會以等號 (=) 分隔。</span><span class="sxs-lookup"><span data-stu-id="80cec-198">The two parts are separated by an equal sign (=).</span></span> <span data-ttu-id="80cec-199">WICsupports 大多數常見的 C/c + + 資料類型。</span><span class="sxs-lookup"><span data-stu-id="80cec-199">WICsupports a majority of the common C/C++ data types.</span></span> <span data-ttu-id="80cec-200">查詢語言接受下列資料類型：</span><span class="sxs-lookup"><span data-stu-id="80cec-200">The following data types are accepted by the query language:</span></span>

-   <span data-ttu-id="80cec-201">char</span><span class="sxs-lookup"><span data-stu-id="80cec-201">char</span></span>
-   <span data-ttu-id="80cec-202">uchar</span><span class="sxs-lookup"><span data-stu-id="80cec-202">uchar</span></span>
-   <span data-ttu-id="80cec-203">short</span><span class="sxs-lookup"><span data-stu-id="80cec-203">short</span></span>
-   <span data-ttu-id="80cec-204">ushort</span><span class="sxs-lookup"><span data-stu-id="80cec-204">ushort</span></span>
-   <span data-ttu-id="80cec-205">long</span><span class="sxs-lookup"><span data-stu-id="80cec-205">long</span></span>
-   <span data-ttu-id="80cec-206">ulong</span><span class="sxs-lookup"><span data-stu-id="80cec-206">ulong</span></span>
-   <span data-ttu-id="80cec-207">int</span><span class="sxs-lookup"><span data-stu-id="80cec-207">int</span></span>
-   <span data-ttu-id="80cec-208">uint</span><span class="sxs-lookup"><span data-stu-id="80cec-208">uint</span></span>
-   <span data-ttu-id="80cec-209">longlong</span><span class="sxs-lookup"><span data-stu-id="80cec-209">longlong</span></span>
-   <span data-ttu-id="80cec-210">FLOAT</span><span class="sxs-lookup"><span data-stu-id="80cec-210">float</span></span>
-   <span data-ttu-id="80cec-211">double</span><span class="sxs-lookup"><span data-stu-id="80cec-211">double</span></span>
-   <span data-ttu-id="80cec-212">字串</span><span class="sxs-lookup"><span data-stu-id="80cec-212">str</span></span>
-   <span data-ttu-id="80cec-213">wstr</span><span class="sxs-lookup"><span data-stu-id="80cec-213">wstr</span></span>
-   <span data-ttu-id="80cec-214">guid</span><span class="sxs-lookup"><span data-stu-id="80cec-214">guid</span></span>
-   <span data-ttu-id="80cec-215">bool</span><span class="sxs-lookup"><span data-stu-id="80cec-215">bool</span></span>

> [!Note]  
> <span data-ttu-id="80cec-216">這份清單只會指定中繼資料查詢語言所支援的資料類型。</span><span class="sxs-lookup"><span data-stu-id="80cec-216">This list only specifies the data types supported by the metadata query language.</span></span> <span data-ttu-id="80cec-217">建立中繼資料查詢日期運算式（例如 {ushort = 18249}）時，請使用這些資料類型。</span><span class="sxs-lookup"><span data-stu-id="80cec-217">Use these data types when creating a metadata query data expression such as {ushort=18249}.</span></span> <span data-ttu-id="80cec-218">WIC 會傳回中繼資料專案的值，其格式為 PROPVARIANT，它會定義自己的型別系統。</span><span class="sxs-lookup"><span data-stu-id="80cec-218">The WIC returns the metadata item's value in the form of PROPVARIANT, which defines its own type system.</span></span>

 

<span data-ttu-id="80cec-219">範例中的 "18249" 是資料標記。</span><span class="sxs-lookup"><span data-stu-id="80cec-219">The "18249" in the example is the data tag.</span></span> <span data-ttu-id="80cec-220">此特定數位是由 Microsoft 所定義，以包含 MicrosoftPhoto 評等。</span><span class="sxs-lookup"><span data-stu-id="80cec-220">This particular number is defined by Microsoft to contain the MicrosoftPhoto rating.</span></span> <span data-ttu-id="80cec-221">根據您要尋找的資料項目，資料標記可以是任何數位、字串或 GUID</span><span class="sxs-lookup"><span data-stu-id="80cec-221">The data tag can be any number, string, or GUID depending on the data item you are looking for</span></span>

<span data-ttu-id="80cec-222">不同于 XMP 評等範例，App1/IFD 區塊中的評等值沒有名稱衝突。</span><span class="sxs-lookup"><span data-stu-id="80cec-222">Unlike the XMP Rating example, there is no name collision for the rating value in the App1/IFD block.</span></span> <span data-ttu-id="80cec-223">這是因為 XMP 分級值實際上是儲存在不同的 ushort 標記18246。</span><span class="sxs-lookup"><span data-stu-id="80cec-223">This is because the XMP rating value is actually stored under a different ushort tag, 18246.</span></span> <span data-ttu-id="80cec-224">因此，用來存取 App1/IFD 區塊中 XMP 評等的運算式為：</span><span class="sxs-lookup"><span data-stu-id="80cec-224">Thus, the expression to access the XMP rating in the App1/IFD block is:</span></span>

-   <span data-ttu-id="80cec-225">/app1/ifd/{ushort = 18246}</span><span class="sxs-lookup"><span data-stu-id="80cec-225">/app1/ifd/{ushort=18246}</span></span>

> [!Note]  
> <span data-ttu-id="80cec-226">如需中繼資料查詢語言的正式描述，請參閱本檔稍後的「中繼資料查詢語言摘要」一節。</span><span class="sxs-lookup"><span data-stu-id="80cec-226">For a formal description of the metadata query language, see the Metadata Query Language Summary section later in this document.</span></span>

 

### <a name="escape-character"></a><span data-ttu-id="80cec-227">逸出字元</span><span class="sxs-lookup"><span data-stu-id="80cec-227">Escape Character</span></span>

<span data-ttu-id="80cec-228">查詢語言不區分大小寫，且會將所有字元視為小寫。</span><span class="sxs-lookup"><span data-stu-id="80cec-228">The query language is not case sensitive and treats all characters as lowercase.</span></span> <span data-ttu-id="80cec-229">不過，某些元資料格式 (例如 XMP) 會區分大小寫。</span><span class="sxs-lookup"><span data-stu-id="80cec-229">However, some metadata formats (such as XMP) are case sensitive.</span></span> <span data-ttu-id="80cec-230">使用區分大小寫的元資料格式時， \\ 當您想要指定大寫字元時，請使用反斜線 () 字元。</span><span class="sxs-lookup"><span data-stu-id="80cec-230">When working with a case-sensitive metadata format, use the backslash (\\) character when you want to specify an uppercase character.</span></span>

<span data-ttu-id="80cec-231">Escape 字元是由語言剖析器取用，而後面的下列字元則是直接解讀。</span><span class="sxs-lookup"><span data-stu-id="80cec-231">The escape character is consumed by the language parser and the following character that follows it is interpreted directly.</span></span> <span data-ttu-id="80cec-232">例如，運算式 {char = \\ \\ } 解析為 ' \\ '，而 {char = \\ C} 解析為大寫 C。如果沒有 escape 字元，{char = \\ } 將是不正確運算式，而 {char = C} 會解讀為小寫 C。</span><span class="sxs-lookup"><span data-stu-id="80cec-232">For example, the expression {char=\\\\} is resolved as '\\'and {char=\\C} is resolved as an uppercase C. Without the escape character, {char=\\} would be an invalid expression and {char=C} would be interpreted as a lowercase c.</span></span> <span data-ttu-id="80cec-233">在區分大小寫的元資料格式中，請務必在所有大寫字母之前使用反斜線字元。</span><span class="sxs-lookup"><span data-stu-id="80cec-233">Be sure to use the backslash escape character before all uppercase letters in metadata formats that are case sensitive.</span></span>

### <a name="sample-expressions"></a><span data-ttu-id="80cec-234">範例運算式</span><span class="sxs-lookup"><span data-stu-id="80cec-234">Sample Expressions</span></span>

<span data-ttu-id="80cec-235">下表提供查詢語言剖析器的一些範例運算式和其解釋的說明。</span><span class="sxs-lookup"><span data-stu-id="80cec-235">The following table provides some example expressions and descriptions of their interpretations by the query language parser.</span></span> 

| <span data-ttu-id="80cec-236">運算式</span><span class="sxs-lookup"><span data-stu-id="80cec-236">Expression</span></span>                     | <span data-ttu-id="80cec-237">描述</span><span class="sxs-lookup"><span data-stu-id="80cec-237">Description</span></span>                                                                                                                                                                                                                                                                                                                                                      |
|--------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="80cec-238">ifd/xmp/exif：作者</span><span class="sxs-lookup"><span data-stu-id="80cec-238">ifd/xmp/exif:Author</span></span>            | <span data-ttu-id="80cec-239">對應至下列導覽路徑： "Exif" 架構中的 IFD 區塊-> XMP block > "Author" 屬性。</span><span class="sxs-lookup"><span data-stu-id="80cec-239">Corresponds to the following navigation path: IFD block -> XMP block -> "Author" property in the "Exif" schema.</span></span>                                                                                                                                                                                                                                            |
| <span data-ttu-id="80cec-240">/\[1個 \] ifd/ \[ 0 \] xmp/exif：作者</span><span class="sxs-lookup"><span data-stu-id="80cec-240">/\[1\]ifd/\[0\]xmp/exif:Author</span></span> | <span data-ttu-id="80cec-241">與此資料表中的第一個專案相同，不同之處在于前置詞會 \[ \# \] 描述在發生名稱衝突時要流覽的專案。</span><span class="sxs-lookup"><span data-stu-id="80cec-241">Same as the first item in this table except that the \[\#\] prefix describes which item to navigate in event of a name collision.</span></span>                                                                                                                                                                                                                                |
| <span data-ttu-id="80cec-242">/ifd/{ushort = 700}/Author</span><span class="sxs-lookup"><span data-stu-id="80cec-242">/ifd/{ushort=700}/Author</span></span>       | <span data-ttu-id="80cec-243">與此資料表中的第一個專案相同，不同之處在于它會使用日期運算式來參考 XMP 區塊，而不是在不帶正負號的簡短標記識別項 700) 上內嵌 (的 XMP 區塊。</span><span class="sxs-lookup"><span data-stu-id="80cec-243">Same as the first item in this table except that it uses a data expression to reference the XMP block instead of the block name "xmp" (XMP block is embedded under the unsigned short tag identifier 700).</span></span> <span data-ttu-id="80cec-244">此外，"Author" 屬性不會指定架構。</span><span class="sxs-lookup"><span data-stu-id="80cec-244">Also, the "Author" property does not specify a schema.</span></span> <span data-ttu-id="80cec-245">查詢剖析器會嘗試在所有架構中比對屬性，並傳回第一個相符項。</span><span class="sxs-lookup"><span data-stu-id="80cec-245">The query parser will try to match the property across all schemas and return the first match.</span></span> |
| <span data-ttu-id="80cec-246">/ifd/xmp</span><span class="sxs-lookup"><span data-stu-id="80cec-246">/ifd/xmp</span></span>                       | <span data-ttu-id="80cec-247">提供中繼資料區塊的導覽路徑。</span><span class="sxs-lookup"><span data-stu-id="80cec-247">Provides a navigation path to a metadata block.</span></span> <span data-ttu-id="80cec-248">如果找到區塊，則會傳回新的中繼資料讀取器/寫入器。</span><span class="sxs-lookup"><span data-stu-id="80cec-248">If the block is found, a new metadata reader/writer is returned.</span></span>                                                                                                                                                                                                                                                 |
| <span data-ttu-id="80cec-249">/\[\*\]tEXt/關鍵字</span><span class="sxs-lookup"><span data-stu-id="80cec-249">/\[\*\]tEXt/Keyword</span></span>            | <span data-ttu-id="80cec-250">取得或設定 PNG 區塊的關鍵字屬性。</span><span class="sxs-lookup"><span data-stu-id="80cec-250">Gets or sets the Keyword property for a PNG chunk.</span></span> <span data-ttu-id="80cec-251">因為 PNG 中繼資料規格允許特定類型的多個區塊，所以 \[ \* \] 標記法會取得/設定具有適當屬性的資料 PNG 區塊。</span><span class="sxs-lookup"><span data-stu-id="80cec-251">Because the PNG metadata specification allows for multiple chunks of a particular type, the \[\*\] notation gets/sets the data PNG chunk with the appropriate property.</span></span> <span data-ttu-id="80cec-252">根據 PNG 規格，不能有兩個區塊具有相同的屬性。</span><span class="sxs-lookup"><span data-stu-id="80cec-252">Per the PNG specification, no two chunks can have the same properties.</span></span>                                                                |



 

<span data-ttu-id="80cec-253">您也可以使用中繼資料 GUID 來唯一識別每個中繼資料區塊，以取代易記的區塊名稱。</span><span class="sxs-lookup"><span data-stu-id="80cec-253">Each metadata block is also uniquely identified by the metadata GUID which can be used in place of the friendly block name.</span></span> <span data-ttu-id="80cec-254">您可以使用下列語法來取代提供的區塊名稱： "/{guid = GUID}/ \[ n \] {GUID = guid}/schema： tagidentifier"</span><span class="sxs-lookup"><span data-stu-id="80cec-254">The following syntax can be used in place of providing block names: "/{guid=GUID}/\[n\]{guid=GUID}/schema:tagidentifier"</span></span>

<span data-ttu-id="80cec-255">下表提供一些不正確範例，以及它們將被拒絕的原因。</span><span class="sxs-lookup"><span data-stu-id="80cec-255">The following table provides some invalid examples and the reasons they would be rejected.</span></span> 

| <span data-ttu-id="80cec-256">運算式無效</span><span class="sxs-lookup"><span data-stu-id="80cec-256">Invalid Expression</span></span>         | <span data-ttu-id="80cec-257">拒絕描述</span><span class="sxs-lookup"><span data-stu-id="80cec-257">Rejection description</span></span>                                                                                                                                                  |
|----------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="80cec-258">/ifd/ \[ 0 \] \[ 2 \] exif/</span><span class="sxs-lookup"><span data-stu-id="80cec-258">/ifd/\[0\]\[2\]exif/</span></span>       | <span data-ttu-id="80cec-259">因為不支援多維度陣列索引，所以已拒絕。</span><span class="sxs-lookup"><span data-stu-id="80cec-259">Rejected because multi dimensional array indexes are not supported.</span></span>                                                                                                    |
| <span data-ttu-id="80cec-260">/ifd/{ushort = 1}/{ushort = 2}</span><span class="sxs-lookup"><span data-stu-id="80cec-260">/ifd/{ushort=1}/{ushort=2}</span></span> | <span data-ttu-id="80cec-261">除非 IFD 的 tagID = 1 是元資料處理程式，其中包含 tagID = 2 的中繼資料專案，否則已拒絕。</span><span class="sxs-lookup"><span data-stu-id="80cec-261">Rejected unless the IFD has a tagID=1 which is a metadata handler that contains a metadata item with a tagID=2.</span></span>                                                        |
| <span data-ttu-id="80cec-262">/{ushort = 1}</span><span class="sxs-lookup"><span data-stu-id="80cec-262">/{ushort=1}</span></span>                | <span data-ttu-id="80cec-263">如果查詢處理相對於中繼資料階層的最上層，則會拒絕。</span><span class="sxs-lookup"><span data-stu-id="80cec-263">Rejected if the query processing is relative to a top level of the metadata hierarchy.</span></span> <span data-ttu-id="80cec-264">這是因為最上層只包含中繼資料區塊，而非資料項目。</span><span class="sxs-lookup"><span data-stu-id="80cec-264">This is because the top level contains only metadata blocks and not data items.</span></span> |



 

## <a name="photo-metadata-policy-expressions"></a><span data-ttu-id="80cec-265">相片中繼資料原則運算式</span><span class="sxs-lookup"><span data-stu-id="80cec-265">Photo Metadata Policy Expressions</span></span>

<span data-ttu-id="80cec-266">如先前所述，完整的查詢運算式會以斜線 (/) 開頭。</span><span class="sxs-lookup"><span data-stu-id="80cec-266">As noted previously, a fully qualified query expression starts with a slash (/).</span></span> <span data-ttu-id="80cec-267">不是以斜線開頭的運算式會評估為原則運算式。</span><span class="sxs-lookup"><span data-stu-id="80cec-267">Expressions that do not begin with the slash are evaluated as policy expressions.</span></span> <span data-ttu-id="80cec-268">原則運算式可讓您查詢影像相關 Windows [Shell 屬性](https://msdn.microsoft.com/library/ms788673(VS.85).aspx)的相片中繼資料。</span><span class="sxs-lookup"><span data-stu-id="80cec-268">A policy expression enables you to query the photo metadata for image-related Windows [Shell Properties](https://msdn.microsoft.com/library/ms788673(VS.85).aspx).</span></span> <span data-ttu-id="80cec-269">在本檔稍早的資料選擇區段中，會使用 "/xmp/xmp：評等" 運算式來存取 XMP 評等屬性。</span><span class="sxs-lookup"><span data-stu-id="80cec-269">In the Data Selection section earlier in this document, the expression "/xmp/xmp:Rating" was used to access the XMP rating property.</span></span> <span data-ttu-id="80cec-270">您也可以使用下列原則運算式來查詢此屬性：</span><span class="sxs-lookup"><span data-stu-id="80cec-270">This property can also be queried using the following policy expression:</span></span>

-   <span data-ttu-id="80cec-271">System. SimpleRating</span><span class="sxs-lookup"><span data-stu-id="80cec-271">System.SimpleRating</span></span>

<span data-ttu-id="80cec-272">若要存取 MicrosoftPhoto 架構中的評等屬性，可以使用下列查詢運算式：</span><span class="sxs-lookup"><span data-stu-id="80cec-272">To access the rating property from the MicrosoftPhoto schema, the following query expression can be used:</span></span>

-   <span data-ttu-id="80cec-273">系統評分</span><span class="sxs-lookup"><span data-stu-id="80cec-273">System.Rating</span></span>

<span data-ttu-id="80cec-274">相片中繼資料原則運算式的行為方式與完整的中繼資料查詢不同，有幾個值得注意的方式。</span><span class="sxs-lookup"><span data-stu-id="80cec-274">Photo metadata policy expressions behave differently from fully qualified metadata queries in a few notable ways.</span></span>

<span data-ttu-id="80cec-275">首先，當您使用原則運算式來存取中繼資料時，WIC 會在多個中繼資料區塊中有相同屬性的情況下，執行仲裁和衝突解決。</span><span class="sxs-lookup"><span data-stu-id="80cec-275">First, when accessing metadata using a policy expression, WIC performs arbitration and conflict resolution in the case that the same property is available in multiple metadata blocks.</span></span> <span data-ttu-id="80cec-276">比方說，MicrosoftPhoto 和 XMP 分級值都同時儲存在 App1/IFD 區塊和 XMP 區塊中。</span><span class="sxs-lookup"><span data-stu-id="80cec-276">For instance, both the MicrosoftPhoto and the XMP rating values are stored in both the App1/IFD block and the XMP block.</span></span> <span data-ttu-id="80cec-277">相片中繼資料原則會決定讀取中繼資料時所傳回之區塊值的優先順序。</span><span class="sxs-lookup"><span data-stu-id="80cec-277">The photo metadata policy determines the precedence for which block value is returned when reading metadata.</span></span> <span data-ttu-id="80cec-278">當您撰寫中繼資料時，相片中繼資料原則可確保不同區塊中的相同屬性一致。</span><span class="sxs-lookup"><span data-stu-id="80cec-278">When you are writing metadata, the photo metadata policy ensures that the same properties in different blocks are consistent.</span></span> <span data-ttu-id="80cec-279">如果您使用「/xmp/xmp：評等」之類的中繼資料查詢，則必須負責在不同的中繼資料位置之間仲裁。</span><span class="sxs-lookup"><span data-stu-id="80cec-279">If you use a metadata query such as "/xmp/xmp:Rating", you are responsible for arbitrating between the various metadata locations.</span></span>

> [!Note]  
> <span data-ttu-id="80cec-280">如需支援的原則運算式及其對應原則的清單，請參閱「 [相片中繼資料原則](photo-metadata-policies.md) 」主題。</span><span class="sxs-lookup"><span data-stu-id="80cec-280">For a list of the supported policy expressions and their mapping policies, see the [Photo Metadata Policies](photo-metadata-policies.md) topic.</span></span>

 

<span data-ttu-id="80cec-281">其次，相片中繼資料原則運算式與影像格式無關，而不是完整的中繼資料查詢。</span><span class="sxs-lookup"><span data-stu-id="80cec-281">Second, photo metadata policy expressions are independent of the image format, while fully qualified metadata queries are not.</span></span> <span data-ttu-id="80cec-282">例如，「/xmp/xmp：評等」查詢是 JPEG 格式特有的。</span><span class="sxs-lookup"><span data-stu-id="80cec-282">For example, the "/xmp/xmp:Rating" query is specific to the JPEG format.</span></span> <span data-ttu-id="80cec-283">TIFF 影像也支援 XMP 中繼資料，但它的儲存方式與 JPEG 不同，因此 TIFF 查詢會是「/ifd/xmp/xmp：評等」。</span><span class="sxs-lookup"><span data-stu-id="80cec-283">TIFF images also support XMP metadata, but it is stored differently compared to JPEG, so the TIFF query would be “/ifd/xmp/xmp:Rating”.</span></span> <span data-ttu-id="80cec-284">不過，在這兩種情況下，原則運算式會是 "SimpleRating"。</span><span class="sxs-lookup"><span data-stu-id="80cec-284">However, in both cases the policy expression would be “System.SimpleRating”.</span></span>

<span data-ttu-id="80cec-285">相較于完整的中繼資料查詢，相片中繼資料原則運算式可提供更高層級的抽象概念和簡化，因此在不需要低層級中繼資料存取的情況下，最好採用此方法。</span><span class="sxs-lookup"><span data-stu-id="80cec-285">Photo metadata policy expressions provide a higher level of abstraction and simplicity when compared to fully qualified metadata queries, and so should be preferred in cases where low-level metadata access is not needed.</span></span> <span data-ttu-id="80cec-286">不過，原則運算式只提供一組有限的影像中繼資料存取，而中繼資料查詢語言可讓您存取儲存在影像檔案中的幾乎所有中繼資料。</span><span class="sxs-lookup"><span data-stu-id="80cec-286">However, policy expressions only provide access to a limited set of image metadata, whereas the metadata query language provides access to nearly all of the metadata stored within an image file.</span></span>

## <a name="metadata-query-language-summary"></a><span data-ttu-id="80cec-287">中繼資料查詢語言摘要</span><span class="sxs-lookup"><span data-stu-id="80cec-287">Metadata Query Language Summary</span></span>

<span data-ttu-id="80cec-288">下表是 WIC 中繼資料查詢語言的正式定義。</span><span class="sxs-lookup"><span data-stu-id="80cec-288">The following table is a formal definition of the WIC metadata query language.</span></span> <span data-ttu-id="80cec-289">每個文法符號表示由其他符號組成的運算式。</span><span class="sxs-lookup"><span data-stu-id="80cec-289">Each grammar symbol represents an expression made up of other symbols.</span></span> <span data-ttu-id="80cec-290">運算式可以是另一個符號或其他符號序列，以分隔號分隔 (\|) ，表示「或」選擇。</span><span class="sxs-lookup"><span data-stu-id="80cec-290">The expression can be another symbol or a sequence of other symbols separated by the vertical bar (\|), indicating an "or" choice.</span></span> <span data-ttu-id="80cec-291">右邊的整個運算式可以替代左邊的指定符號。</span><span class="sxs-lookup"><span data-stu-id="80cec-291">The whole expression on the right is a possible substitution for the specified symbol on the left.</span></span> 

| <span data-ttu-id="80cec-292">符號</span><span class="sxs-lookup"><span data-stu-id="80cec-292">Symbol</span></span>                   | <span data-ttu-id="80cec-293">運算式</span><span class="sxs-lookup"><span data-stu-id="80cec-293">Expression</span></span>                                                                                                                                                                  |
|--------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| \<path>             | <span data-ttu-id="80cec-294">\<name> \| '/' \<property path></span><span class="sxs-lookup"><span data-stu-id="80cec-294">\<name> \| '/' \<property path></span></span>                                                                                                                                   |
| \<property path>    | <span data-ttu-id="80cec-295">\<metadata item> \| \<property path> '/' \<property path></span><span class="sxs-lookup"><span data-stu-id="80cec-295">\<metadata item> \| \<property path> '/' \<property path></span></span>                                                                                                    |
| \<metadata item>    | <span data-ttu-id="80cec-296">\<index name> \| \<item name> \| \<schema name> ':' \<item name></span><span class="sxs-lookup"><span data-stu-id="80cec-296">\<index name> \| \<item name> \| \<schema name> ':' \<item name></span></span>                                                                                        |
| \<schema name>      | \<item name>                                                                                                                                                           |
| \<item name>        | <span data-ttu-id="80cec-297">\<metadata item> \| <indexed item><index></span><span class="sxs-lookup"><span data-stu-id="80cec-297">\<metadata item> \| <indexed item><index></span></span>                                                                                                                  |
| \<indexed item>     | <span data-ttu-id="80cec-298">\<item> \| \<implied metadata>\<item></span><span class="sxs-lookup"><span data-stu-id="80cec-298">\<item> \| \<implied metadata>\<item></span></span>                                                                                                                        |
| \<implied metadata> | <span data-ttu-id="80cec-299">' < ' \<name> ' > '</span><span class="sxs-lookup"><span data-stu-id="80cec-299">'<'\<name>'>'</span></span>                                                                                                                                                    |
| \<item>             | <span data-ttu-id="80cec-300">\<name> \| \<index> \<data> \| \<data></span><span class="sxs-lookup"><span data-stu-id="80cec-300">\<name> \| \<index> \<data> \| \<data></span></span>                                                                                                                  |
| \<data>             | <span data-ttu-id="80cec-301">'{' \<data type> '=' \<value> '}'</span><span class="sxs-lookup"><span data-stu-id="80cec-301">'{' \<data type> '=' \<value> '}'</span></span>                                                                                                                                 |
| \<index>            | <span data-ttu-id="80cec-302">'\[' \<number> \| \<star> '\]'</span><span class="sxs-lookup"><span data-stu-id="80cec-302">'\[' \<number> \| \<star> '\]'</span></span>                                                                                                                                    |
| \<data type>        | <span data-ttu-id="80cec-303">' char ' \| ' uchar ' ' \| short ' ' \| ushort ' ' \| long ' \| ' ulong ' \| ' int ' \| ' uint ' \| ' longlong ' \| ' ulonglong ' \| ' float ' ' \| double ' \| ' str ' \| ' wstr ' \| ' guid ' \| ' bool '</span><span class="sxs-lookup"><span data-stu-id="80cec-303">'char' \| 'uchar' \| 'short' \| 'ushort' \| 'long' \| 'ulong' \| 'int' \| 'uint' \| 'longlong' \| 'ulonglong' \| 'float' \| 'double' \| 'str' \| 'wstr' \| 'guid' \| 'bool'</span></span> |
| \<data value>       | <span data-ttu-id="80cec-304">\<number> \| \<name> \| \<guid></span><span class="sxs-lookup"><span data-stu-id="80cec-304">\<number> \| \<name> \| \<guid></span></span>                                                                                                                              |
| \<star>             | <span data-ttu-id="80cec-305">'\*'</span><span class="sxs-lookup"><span data-stu-id="80cec-305">'\*'</span></span>                                                                                                                                                                        |
| \<number>           | <span data-ttu-id="80cec-306">number</span><span class="sxs-lookup"><span data-stu-id="80cec-306">number</span></span>                                                                                                                                                                      |
| \<name>             | <span data-ttu-id="80cec-307">字串</span><span class="sxs-lookup"><span data-stu-id="80cec-307">string</span></span>                                                                                                                                                                      |
| \<guid>             | <span data-ttu-id="80cec-308">guid</span><span class="sxs-lookup"><span data-stu-id="80cec-308">guid</span></span>                                                                                                                                                                        |



 

## <a name="related-topics"></a><span data-ttu-id="80cec-309">相關主題</span><span class="sxs-lookup"><span data-stu-id="80cec-309">Related topics</span></span>

<dl> <dt>

<span data-ttu-id="80cec-310">**概念**</span><span class="sxs-lookup"><span data-stu-id="80cec-310">**Conceptual**</span></span>
</dt> <dt>

[<span data-ttu-id="80cec-311">Windows 影像處理元件總覽</span><span class="sxs-lookup"><span data-stu-id="80cec-311">Windows Imaging Component Overview</span></span>](-wic-about-windows-imaging-codec.md)
</dt> <dt>

[<span data-ttu-id="80cec-312">WIC 中繼資料總覽</span><span class="sxs-lookup"><span data-stu-id="80cec-312">WIC Metadata Overview</span></span>](-wic-about-metadata.md)
</dt> <dt>

[<span data-ttu-id="80cec-313">讀取和寫入影像中繼資料的總覽</span><span class="sxs-lookup"><span data-stu-id="80cec-313">Overview of Reading and Writing Image Metadata</span></span>](-wic-codec-readingwritingmetadata.md)
</dt> <dt>

[<span data-ttu-id="80cec-314">中繼資料擴充性總覽</span><span class="sxs-lookup"><span data-stu-id="80cec-314">Metadata Extensibility Overview</span></span>](-wic-codec-metadatahandlers.md)
</dt> <dt>

[<span data-ttu-id="80cec-315">How to：使用中繼資料重新編碼 JPEG 影像</span><span class="sxs-lookup"><span data-stu-id="80cec-315">How-to: Re-encode a JPEG Image with Metadata</span></span>](-wic-codec-jpegmetadataencoding.md)
</dt> </dl>

 

 



