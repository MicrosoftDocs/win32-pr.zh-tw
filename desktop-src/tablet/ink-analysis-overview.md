---
description: InkAnalysis Api 為 Tablet PC 開發人員提供功能強大的工具，以程式設計方式檢查筆墨輸入。 API 會將筆墨分類為有意義的類別，例如單字、線條、段落和繪圖。
ms.assetid: d9521a8c-f61a-40ea-8603-e8afbba75a4e
title: 筆墨分析總覽
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 3056a5e5fbff8be82f6df2de2a34fadd9761e50f451ee2d48c112589d1aff397
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/11/2021
ms.locfileid: "118718907"
---
# <a name="ink-analysis-overview"></a>筆墨分析總覽

InkAnalysis Api 為 Tablet PC 開發人員提供功能強大的工具，以程式設計方式檢查筆墨輸入。 API 會將筆墨分類為有意義的類別，例如單字、線條、段落和繪圖。

您可以使用各種不同的方式來使用每個分類，包括改善手寫的辨識結果。

## <a name="ink-analysis-basics"></a>筆墨分析基本概念

本節介紹 Tablet PC 平臺筆墨分析技術，並說明其使用時機和方式。

InkAnalysis Api 能有效地結合兩個不同但免費的技術：手寫辨識和版面配置分類。 結合這兩種技術，可提供比單獨取得的結果更大的結果。

手寫辨識是手寫數位筆跡的計算分析，會以指定的語言傳回以字元為基礎的轉譯。 也就是說，手寫辨識是電腦「讀取」人員手寫的方式。

筆墨分析可進一步細分為筆跡分類和版面配置分析。 筆墨分類是以語義有意義的單位（例如段落、線條、單字和繪圖）計算的筆跡。 版面配置分析是筆跡輸入的計算檢查，用來判斷筆跡在筆跡表面上的位置，以及筆劃與其他空間之間的關聯性，甚至是語義。 例如，版面配置分析可告知您特定的筆墨部分是批註或呼叫。

### <a name="recognition"></a>辨識

在 InkAnalysis API 中使用筆墨分析進行辨識組合的其中一個範例，可協助開發人員改善辨識結果。 Tablet PC 手寫辨識引擎主要是設計來辨識一條水平線的筆跡。 不過，人們通常會在拍攝筆記時撰寫多行程式碼，而這些線條不保證會與頁面相對水準。 使用 InkAnalysis API 時，筆墨分析器會將筆墨前置處理，然後再傳送至辨識器。 分析過的筆墨會在辨識之前轉換為水準，以改善辨識結果。

其他辨識的優點是藉由在將筆墨傳送至辨識器之前，讓筆墨分析器更正不正確的筆觸順序資訊來衍生。 此外，辨識結果現在以選擇性的方式提供。 也就是說，開發人員可以在單一呼叫中，快速地取得單一單字、線條或段落的辨識結果。

### <a name="ink-classification"></a>筆墨分類

當然，在許多情況下，您可能會將筆墨資料保持不變，而不是立即轉換成文字。 筆墨分析也會在這裡提供優點。 具體來說，InkAnalysis Api 可讓您根據手寫筆劃是否為書寫或繪圖來加以分割。 分類為書寫的筆墨筆觸是組成單字或字元的筆墨筆劃。 所有其他筆劃都是繪圖。 這可為您提供新的方式來存取筆墨資料，並啟用新的使用者案例。 例如，您可以根據使用者所按下的筆劃類型，執行選取專案，使其不同;如果使用者按下書寫筆劃，則應用程式會選取組成單字的整組筆劃，如果使用者按下繪圖搧風，應用程式只會選取該筆觸。

### <a name="layout-analysis"></a>版面配置分析

在撰寫和繪製元件時，有用的版面配置分析實際上遠超越筆墨的相對簡單明細。

筆墨分析也包含書寫和繪製筆劃的更豐富明細。 作為一個非常簡單的範例，請拍攝筆墨的 blob，如下圖所示。

![兩條簡單的手寫](images/12e7a221-59c1-4d69-b7aa-67f2caebe375.jpg)

在平臺分析這些筆觸之後，它會傳回這些筆觸的樹狀標記法，如下圖所示。 在這個簡單的案例中，樹狀結構只包含段落、行和單字資訊，但是這個樹狀結構的豐富程度會隨著筆墨檔的複雜度而增加。

![根、段落、行和單字的樹狀結構表示](images/be5a7635-0abc-45ad-bcb5-98fddee5e148.jpg)

由於這項資訊現在會分成可管理的單位，因此您現在可以建立功能更強大的功能。 例如，應用程式可以擴充功能，讓使用者在其中按一下以選取文字，然後按兩次以選取整個行，然後按三次來選取整段文字的功能。 藉由利用分析作業所傳回的樹狀結構，應用程式可以將分區域關聯回樹狀結構中的筆劃。 應用程式找到筆觸之後，就可以向上查看樹狀結構，以判斷要選取的相鄰筆觸的方式和。

選取整行是筆墨分析優點的簡單範例，但是當其中一個會考慮筆墨分析器可以偵測的不同階層結構類型時，可能會很有説明：

-   已排序和未排序的清單
-   圖形
-   Annotative 以文字內嵌撰寫的批註

功能的類型會因應用程式而異，而且會根據需求和可用的筆墨分析和辨識引擎。

### <a name="key-ink-analysis-features"></a>重要筆墨分析功能

InkAnalysis API 的主要功能包括下列功能：

-   累加式分析
-   持續性
-   資料 Proxy
-   和解
-   擴充性

### <a name="incremental-analysis"></a>累加式分析

當終端使用者使用筆墨時，通常會將其視為手寫。 筆墨會持續受編輯作業的影響，例如新增筆墨、刪除現有筆墨，以及修改筆墨屬性，全都是以編輯手寫的相同方式完成。 這些編輯作業會影響分析結果。 進行編輯時，通常會在特定時間點將其隔離到檔的區段。 例如，假設使用者寫入五行筆跡。 應用程式分析筆墨的標準方式是等候使用者完成全部五行筆墨的書寫（例如段落），然後以同步或非同步方式分析結果。

您可以將分析時所分析的區域隔離，然後只 reanalyzing 已變更的部分結果，藉此優化分析這五行所花費的整體時間。 分析第一行之後，除非使用者修改了第一行，否則永遠不會再次辨識。 第二行的辨識會被視為獨立的辨識作業。

這種漸進式方法適用于辨識作業的行層級，但它需要針對筆墨分析作業以較高層級的方式運作。 由於筆墨分析器可以針對這五行筆墨偵測不同的較高層級分類 (例如，它可能是清單) 中的標準段落或五個專案，而筆墨分析器的累加方法是必須分析這些較高的結構。 也就是說，在筆跡分析器將筆墨的第一行分類為線條之後，它會在分類第二行時再次檢查它是否仍然是線條。 不過，「筆跡分析器」會將這次的雙重檢查隔離到段落，並在分析第二個段落時忽略第一個段落，將第二個段落視為獨立的筆墨分析器作業。 當應用程式中已有大量筆墨時，此累加的分析方法可大幅節省處理時間。

### <a name="persistence"></a>持續性

累加式分析可在指定的會話或 [**InkAnalyzer**](inkanalyzer.md) 物件的實例內順利運作。 不過，當筆墨保存到磁片之後，第一代 Tablet PC 平臺 Api 無法執行累加式分析。 InkAnalysis API 可讓您將筆墨儲存至磁片，以及保存形式的分析結果。 當筆墨載入時可以載入分析結果，而且可以插入 **InkAnalyzer** 的新實例。 然後， **InkAnalyzer** 物件的新實例會具有與先前相同的結果狀態，而且現在可接受任何修改做為現有狀態的累加變更，而不是再次分析所有專案。

### <a name="data-proxy"></a>資料 Proxy

許多應用程式在其應用程式中已經有某種類型的現有檔結構;例如，圖形或資料庫。 [**InkAnalyzer**](inkanalyzer.md)也會在 [**CoNtextNode**](icontextnode.md)物件的樹狀結構中，以結構化形式呈現結果。 **InkAnalyzer** 結構和應用程式的現有結構需要雙向交互操作：結果會從 **InkAnalyzer** 提取至應用程式，並將狀態從應用程式推送到 **InkAnalyzer**。

如果您只需要將 [**InkAnalyzer**](inkanalyzer.md) 中的結果提取到應用程式的結構中，就會相當簡單。 應用程式會逐一查看結果樹狀結構，並將 (整合) 所需的所有結果全都併入其現有的資料結構中。 不過，因為許多水準應用程式都需要增量分析和持續性磁片，所以問題會變成雙向。 狀態 (過去的結果) 需要從應用程式的結構提取並推送至 **InkAnalyzer**。

為了滿足這項需求， [**InkAnalyzer**](inkanalyzer.md) 包含一系列事件，可在分析作業期間于適當時間引發，以允許應用程式將資料的要求 proxy 回其現有的結構。 這些事件只會針對累加作業所需的那些 [**CoNtextNode**](icontextnode.md) 物件引發。

### <a name="reconciliation"></a>和解

大部分的應用程式會想要在背景中分析筆墨，以保持最小的使用者介面中斷。 在背景中分析筆墨會造成問題，不過，如果使用者變更筆墨 (或正在分析的相鄰筆墨) 。 例如，如果使用者在背景作業期間刪除筆墨，則產生的結構會在背景作業開始時反映檔的狀態，而不是在完成時反映檔的狀態。

為了協助應用程式， [**InkAnalyzer**](inkanalyzer.md) 會協調分析作業的開頭和結尾之間的檔狀態差異。 當分析在背景中執行時，使用者或應用程式所做的變更一律會覆寫在背景中計算的結果。 在對帳之後，只會報告結果結構中不會與檔變更衝突的部分，並將衝突的筆觸標記為未來的分析。 下次執行背景分析作業時，會根據新的狀態重新計算結果。

下圖顯示此程式。 從上到下，圖表中的時間是以線性方式表示。

![分析作業期間協調檔狀態變更的進程](images/6323e0b5-b6b3-4adc-8c73-da3fad5b4bc2.jpg)

1.  在時間 1 (t1) 時，應用程式會從使用者收集筆跡，包括任何類型的筆墨修改，例如新增、移除或修改。
2.  在 t2，應用程式會叫用背景分析作業。 [**InkAnalyzer**](inkanalyzer.md)會決定哪些筆墨沒有結果，以及要重複檢查哪些筆墨。 它會複製所需的筆墨資料，讓背景執行緒可以獨立執行。
3.  在 t3 上， [**InkAnalyzer**](inkanalyzer.md) 會將使用者介面執行緒執行傳回給應用程式。 **InkAnalyzer** 會建立第二個執行緒、背景分析執行緒，而筆墨分析和辨識引擎會分析複製的筆墨資料。
4.  在第二個背景執行緒上進行分析作業時，使用者會繼續在 t4 和 t5 上編輯檔、新增和移除筆劃資料。 這些編輯可能會與在背景中處理的工作發生衝突。
5.  在 t6，背景執行緒已完成分析作業，並已準備好結果。 在 [**InkAnalyzer**](inkanalyzer.md) 將結果傳達給應用程式之前，它會執行對帳演算法，以判斷在計算分析作業時所進行的使用者編輯 (t4 和 t5) 與結果產生衝突。 如果偵測到任何衝突，則會將衝突的筆劃標示為重新分析，這會在下次應用程式叫用背景分析作業時發生。
6.  最後，在 t7 時，如果偵測到所有衝突， [**InkAnalyzer**](inkanalyzer.md) 會向應用程式呈現結果。

### <a name="extensibility"></a>擴充性

InkAnalysis Api 可讓應用程式使用新的分析引擎類型，以防止應用程式必須重寫 InkAnalysis API 的所有優點，包括對帳、資料 proxy、持續性和累加式分析。

## <a name="related-topics"></a>相關主題

<dl> <dt>

[Microsoft Ink](/previous-versions/dotnet/netframework-3.5/ms581553(v=vs.90))
</dt> <dt>

[筆跡分析參考](ink-analysis-reference.md)
</dt> </dl>

 

 
