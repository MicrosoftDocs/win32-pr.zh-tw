---
description: Microsoft Tablet PC 輸入面板是一種功能強大的工具，可使用畫筆來輸入手寫文字，並在不使用鍵盤的情況下更正文字。
ms.assetid: c45ac1b5-7713-4bcb-a130-4692cff99aa2
title: 啟用自訂筆墨收集器的文字更正
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: cb4dee4c7dfee1489cd002848c496be41f73d953
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/08/2021
ms.locfileid: "104553544"
---
# <a name="enabling-text-correction-for-custom-ink-collectors"></a><span data-ttu-id="228b1-103">啟用自訂筆墨收集器的文字更正</span><span class="sxs-lookup"><span data-stu-id="228b1-103">Enabling Text Correction for Custom Ink Collectors</span></span>

<span data-ttu-id="228b1-104">Microsoft Tablet PC 輸入面板是一種功能強大的工具，可使用畫筆來輸入手寫文字，並在不使用鍵盤的情況下更正文字。</span><span class="sxs-lookup"><span data-stu-id="228b1-104">Microsoft Tablet PC Input Panel is a powerful tool for entering handwritten text with a pen and correcting text without the use of a keyboard.</span></span> <span data-ttu-id="228b1-105">使用 [輸入面板] 時，使用者會在輸入面板的筆墨表面上以手寫方式輸入文字，這會導致輸入面板將使用者的手寫辨識為文字。</span><span class="sxs-lookup"><span data-stu-id="228b1-105">When using Input Panel, a user enters text by handwriting onto Input Panel's inking surfaces, which causes Input Panel to recognize the user's handwriting as text.</span></span> <span data-ttu-id="228b1-106">辨識文字之後，使用者可以在 [輸入面板] 上按 [插入]，將文字插入應用程式或檔中。</span><span class="sxs-lookup"><span data-stu-id="228b1-106">Once the text has been recognized, the user taps Insert on Input Panel to insert the text into an application or document.</span></span> <span data-ttu-id="228b1-107">在插入文字之前，使用者可以存取 [輸入面板] 中的一組更正工具。</span><span class="sxs-lookup"><span data-stu-id="228b1-107">Prior to inserting the text, a user has access to a set of correction tools in Input Panel.</span></span> <span data-ttu-id="228b1-108">這些包括選取替代辨識結果、重寫單一字元的能力，或甚至是將整個單字重寫。</span><span class="sxs-lookup"><span data-stu-id="228b1-108">These include the selection of an alternative recognition result, the ability to rewrite a single character, or even to scratch-out the entire word and rewrite.</span></span> <span data-ttu-id="228b1-109">這些更正工具可讓使用者更正辨識錯誤和人為錯誤。</span><span class="sxs-lookup"><span data-stu-id="228b1-109">These correction tools enable a user to correct both recognition errors and human errors.</span></span>

<span data-ttu-id="228b1-110">在檔中使用 [輸入面板] 輸入的文字之後，使用者就可以存取在 Windows [文字服務架構](/windows/desktop/TSF/text-services-framework)型和已啟用文字服務的應用程式中插入之前所提供的相同更正功能。</span><span class="sxs-lookup"><span data-stu-id="228b1-110">Once the text entered using Input Panel is in the document, users have access to the same correction functionality that is available prior to insertion in Windows [Text Services Framework](/windows/desktop/TSF/text-services-framework)-based and Text Services-enabled applications.</span></span> <span data-ttu-id="228b1-111">從 Microsoft Windows XP Service Pack 2 Tablet PC Edition 開始，所有豐富的編輯應用程式都是文字服務-預設為啟用，而且從 Windows Vista 開始，HTML 應用程式是預設啟用的文字服務。</span><span class="sxs-lookup"><span data-stu-id="228b1-111">Starting in Microsoft Windows XP Service Pack 2 Tablet PC Edition all Rich Edit applications are Text Services-enabled by default, and starting in Windows Vista, HTML applications are Text Services-enabled by default.</span></span> <span data-ttu-id="228b1-112">檔內更正僅適用于以文字服務為基礎且已啟用的應用程式;這是因為輸入面板相依于文字服務的功能來儲存相關聯的文字屬性（包括筆墨物件和辨識替代項），以提供檔內的更正。</span><span class="sxs-lookup"><span data-stu-id="228b1-112">In-document correction is only available in Text Service based and enabled applications; this is because Input Panel is dependent on Text Service's capability to store associated text properties, including ink objects and recognition alternates, in order to provide in-document correction.</span></span>

![具有文字更正的 tablet pc 輸入面板](images/a0dced5e-16de-410b-965f-5d97d297cee5.jpg)

<span data-ttu-id="228b1-114">不過，在許多情況下，您可以使用輸入面板來修正語音辨識或更正輸入的文字，而不是以使用輸入面板的文字輸入來啟動，但在這種情況下，檔內更正可能對 Tablet PC 使用者非常有用。</span><span class="sxs-lookup"><span data-stu-id="228b1-114">There are, however, numerous scenarios, including correcting speech recognition or correcting typed text on the go, that do not start with text entry using Input Panel but in which in-document correction can be extremely useful for Tablet PC users.</span></span> <span data-ttu-id="228b1-115">其中的一個主要範例是在應用程式中提供使用畫筆輸入文字的自訂筆跡表面。</span><span class="sxs-lookup"><span data-stu-id="228b1-115">A prime example is in applications that provide custom inking surfaces for entering text using a pen.</span></span> <span data-ttu-id="228b1-116">自訂筆跡介面是一個很好的方式，可讓應用程式針對每個應用程式的文字輸入工作提供唯一量身打造的功能。</span><span class="sxs-lookup"><span data-stu-id="228b1-116">Custom inking surfaces are a great way for applications to provide uniquely tailored functionality specific to the text entry tasks of each application.</span></span> <span data-ttu-id="228b1-117">此外，自訂的筆墨表面也提供完全整合的 Tablet PC 使用者體驗，讓它清楚地看畫筆是包含它們之應用程式中的第一個類別輸入裝置。</span><span class="sxs-lookup"><span data-stu-id="228b1-117">Additionally, custom inking surfaces provide a fully integrated Tablet PC user experience, which makes it clear the pen is a first class input device in applications that contain them.</span></span> <span data-ttu-id="228b1-118">不過，提供自訂筆跡表面的應用程式可能不允許或可能無法提供來自輸入面板檔內更正的相同等級的更正支援。</span><span class="sxs-lookup"><span data-stu-id="228b1-118">However, applications that provide custom inking surfaces may not allow or may not be able to provide the same level of correction support that is available from Input Panel in-document correction.</span></span>

![自訂筆墨收集器](images/b6797b12-dda6-44c4-87f4-570fe0c23f3a.jpg)

<span data-ttu-id="228b1-120">以文字服務為基礎或已啟用的應用程式，在其中使用 [輸入面板] 來更正未輸入的文字時，可使用 [輸入面板] 中的 [IHandWrittenTextInsertion API]，在 managed 程式) 代碼中使用輸入面板的[](/windows/desktop/api/peninputpanel/nn-peninputpanel-ihandwrittentextinsertion) API ([>textinput HandwrittenTextInsertion](/previous-versions/ms573516(v=vs.100))類別，以啟用以其他方式輸入之文字的檔內校正。</span><span class="sxs-lookup"><span data-stu-id="228b1-120">Text Services based or enabled applications in which in-document correction is useful for correction of text not entered using Input Panel are able to use Input Panel's [**IHandWrittenTextInsertion**](/windows/desktop/api/peninputpanel/nn-peninputpanel-ihandwrittentextinsertion) API ([Microsoft.TextInput.HandwrittenTextInsertion](/previous-versions/ms573516(v=vs.100)) class in managed code)to enable in-document correction for text entered by other means.</span></span> <span data-ttu-id="228b1-121">如此一來，應用程式就可以低廉價格將強大的修正支援新增至自訂的筆墨表面或其他文字輸入案例，並將其 Tablet PC 文字輸入的故事。</span><span class="sxs-lookup"><span data-stu-id="228b1-121">In this way, applications can cheaply add powerful correction support to their custom inking surfaces or other text entry scenarios, and round out their Tablet PC text entry story.</span></span> <span data-ttu-id="228b1-122">輸入面板 IHandWrittenTextInsertion API 隨附于 Windows Vista 作業系統中，屬於平板電腦平臺 SDK 1.9 版或更新版本。</span><span class="sxs-lookup"><span data-stu-id="228b1-122">The Input Panel IHandWrittenTextInsertion API is included as part of the Windows Vista operating system and as part of the Tablet Platform SDK version 1.9 or newer.</span></span> <span data-ttu-id="228b1-123">同時包含 .NET 和 COM 型的 API 版本。</span><span class="sxs-lookup"><span data-stu-id="228b1-123">Both a .NET and COM based version of the API are included.</span></span> <span data-ttu-id="228b1-124">Windows Vista 和更新版本支援使用輸入面板來啟用未輸入文字的檔內更正。</span><span class="sxs-lookup"><span data-stu-id="228b1-124">Enabling in-document correction for text not entered using Input Panel is supported on Windows Vista and newer.</span></span> <span data-ttu-id="228b1-125">檔內更正僅適用于拉丁語言，而且無法顯示拉丁字元集以外的任何字元。</span><span class="sxs-lookup"><span data-stu-id="228b1-125">In-document correction is only available for Latin languages and is unable to display any character outside the Latin character set.</span></span>

## <a name="how-to-use-the-handwrittentextinsertion-api-in-an-application"></a><span data-ttu-id="228b1-126">如何在應用程式中使用 HandwrittenTextInsertion API</span><span class="sxs-lookup"><span data-stu-id="228b1-126">How to Use the HandwrittenTextInsertion API in an Application</span></span>

<span data-ttu-id="228b1-127">為了針對未使用輸入面板和使用 [**IHandWrittenTextInsertion**](/windows/desktop/api/peninputpanel/nn-peninputpanel-ihandwrittentextinsertion) API 所輸入的文字，將輸入面板的輸入面板檔內更正，以整合輸入面板的必要變更很簡單。</span><span class="sxs-lookup"><span data-stu-id="228b1-127">The required changes to an application in order to integrate Input Panel in-document correction for text not entered using Input Panel and using the [**IHandWrittenTextInsertion**](/windows/desktop/api/peninputpanel/nn-peninputpanel-ihandwrittentextinsertion) API are straightforward.</span></span> <span data-ttu-id="228b1-128">除了最後一個步驟之外，所有應用程式的自訂文字專案程式碼都會保持不變。</span><span class="sxs-lookup"><span data-stu-id="228b1-128">All of the application's custom text entry code remains unchanged except for the last step.</span></span> <span data-ttu-id="228b1-129">在使用自訂筆跡介面、語音辨識或其他方法所輸入文字的位置，會在文字服務 **啟用的文字** 欄位中顯示，而不是直接將文字傳送到文字欄位。</span><span class="sxs-lookup"><span data-stu-id="228b1-129">At the point at which text entered using a custom inking surface, speech recognition, or other means is to be displayed in a text services enabled text field, the application sends the text to the **IHandWrittenTextInsertion** interface instead of sending it directly to the text field.</span></span> <span data-ttu-id="228b1-130">輸入面板的可程式性元件接著會處理將文字插入文字欄位和文字服務備份存放區的程式。</span><span class="sxs-lookup"><span data-stu-id="228b1-130">The Input Panel programmability component then handles inserting the text into both the text field and the Text Services backing-store.</span></span> <span data-ttu-id="228b1-131">將文字新增至文字服務備份儲存區時，輸入面板的可程式性元件會處理設定輸入面板所需的文字屬性，以便針對該文字啟用檔內更正。</span><span class="sxs-lookup"><span data-stu-id="228b1-131">When adding the text to the Text Services backing-store, the Input Panel programmability component handles setting the text properties that are required by Input Panel for in-document correction to be enabled for that text.</span></span>

<span data-ttu-id="228b1-132">下一節將逐步說明使用 [**IHandWrittenTextInsertion**](/windows/desktop/api/peninputpanel/nn-peninputpanel-ihandwrittentextinsertion) API COM 版本之 c + + 應用程式的程式。</span><span class="sxs-lookup"><span data-stu-id="228b1-132">The following section walks through this process in detail for a C++ application using the COM version of the [**IHandWrittenTextInsertion**](/windows/desktop/api/peninputpanel/nn-peninputpanel-ihandwrittentextinsertion) API.</span></span> <span data-ttu-id="228b1-133">在 C \# + + 中使用 COM 版本的 c # 中使用 .NET Framework 版 API 的步驟有很大的不同。</span><span class="sxs-lookup"><span data-stu-id="228b1-133">There are notes anywhere the steps for using the .NET Framework version of the API in C\# differ for the using COM version in C++.</span></span> <span data-ttu-id="228b1-134">Managed **HandwrittenTextInsertion** API 包含單一 COM 介面 **IHandwrittenTextInsertion**。</span><span class="sxs-lookup"><span data-stu-id="228b1-134">The managed **HandwrittenTextInsertion** API includes a single COM interface, **IHandwrittenTextInsertion**.</span></span> <span data-ttu-id="228b1-135">此介面的定義位於 PenInputPanel .h 和 PenInputPanel \_ i.c。</span><span class="sxs-lookup"><span data-stu-id="228b1-135">The definition for this interface is located in PenInputPanel.h and PenInputPanel\_i.c.</span></span>

<span data-ttu-id="228b1-136">首先，應用程式應該使用 [**CoCreateInstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance)函數來產生具有類別識別碼 **CLSID \_ HandwrittenTextInsertion** 的 [**IHandWrittenTextInsertion**](/windows/desktop/api/peninputpanel/nn-peninputpanel-ihandwrittentextinsertion)實例。</span><span class="sxs-lookup"><span data-stu-id="228b1-136">First, the application should use the [**CoCreateInstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance) function to produce an instance of [**IHandWrittenTextInsertion**](/windows/desktop/api/peninputpanel/nn-peninputpanel-ihandwrittentextinsertion) with class id **CLSID\_HandwrittenTextInsertion**.</span></span> <span data-ttu-id="228b1-137">請注意，只有在建立視窗並獲得焦點之後，才會成功建立 **CLSID \_ HandwrittenTextInsertion** 物件，因為在此之前，不會啟動文字服務支援存放區。</span><span class="sxs-lookup"><span data-stu-id="228b1-137">Note that the creation of a **CLSID\_HandwrittenTextInsertion** object will succeed only after a window is created and given focus, because until then the Text Services backing-store is not activated.</span></span> <span data-ttu-id="228b1-138">此外，如果系統上沒有 tiptsf.dll， **CoCreateInstance** 函式會失敗並傳回 **REGDB \_ E \_ CLASSNOTREG**，表示系統上不支援輸入面板的檔內更正。</span><span class="sxs-lookup"><span data-stu-id="228b1-138">Additionally, if tiptsf.dll is not present on the system, the **CoCreateInstance** function fails and returns **REGDB\_E\_CLASSNOTREG**, indicating that Input Panel in-document correction is not supported on the system.</span></span> <span data-ttu-id="228b1-139">此時應用程式應該繼續進行，而不嘗試啟用輸入面板的檔內校正。</span><span class="sxs-lookup"><span data-stu-id="228b1-139">At this point the application should proceed without trying to enable Input Panel in-document correction.</span></span> <span data-ttu-id="228b1-140">您必須可從應用程式的程式碼存取 **HandwrittenTextInsertion** 實例，以處理將文字插入文字欄位的程式碼。</span><span class="sxs-lookup"><span data-stu-id="228b1-140">The instance of **HandwrittenTextInsertion** must be accessible from the application's code that handles inserting text into a text field.</span></span>

> [!Note]  
> <span data-ttu-id="228b1-141">使用 .NET Framework 版的 API 時，應用程式應該加入 using 語句以允許存取 [>textinput](/previous-versions/dotnet/netframework-3.5/ms581554(v=vs.90)) 命名空間，然後直接建立物件。</span><span class="sxs-lookup"><span data-stu-id="228b1-141">When working with the .NET Framework version of the API, the application should add a using statement to allow access to the [Microsoft.Ink.TextInput](/previous-versions/dotnet/netframework-3.5/ms581554(v=vs.90)) namespace and then create the object directly.</span></span>

 

<span data-ttu-id="228b1-142">其次，必須改變應用程式的程式碼，以將文字插入文字欄位中，如此一來，它就不會再直接將文字插入文字欄位中，而會改為呼叫 [**IHandwrittenTextInsertion**](/windows/desktop/api/peninputpanel/nn-peninputpanel-ihandwrittentextinsertion)的兩個插入方法的其中一個。</span><span class="sxs-lookup"><span data-stu-id="228b1-142">Second, the application's code that is responsible for inserting text into a text field must be altered so that it no longer inserts text into a text field directly, but calls one or the other of [**IHandwrittenTextInsertion**](/windows/desktop/api/peninputpanel/nn-peninputpanel-ihandwrittentextinsertion)'s two insertion methods instead.</span></span> <span data-ttu-id="228b1-143">應用程式是否應該選擇呼叫 [**InsertRecognitionResultsArray**](/windows/desktop/api/peninputpanel/nf-peninputpanel-ihandwrittentextinsertion-insertrecognitionresultsarray) 或 [**InsertRecognitionResults**](/windows/desktop/api/peninputpanel/nf-peninputpanel-ihandwrittentextinsertion-insertinkrecognitionresult) ，取決於應用程式是否針對儲存為數組或 [**IInkRecognitionResult**](/windows/desktop/api/msinkaut/nn-msinkaut-iinkrecognitionresult) 物件的文字進行辨識替代。</span><span class="sxs-lookup"><span data-stu-id="228b1-143">Whether the applications should choose to call [**InsertRecognitionResultsArray**](/windows/desktop/api/peninputpanel/nf-peninputpanel-ihandwrittentextinsertion-insertrecognitionresultsarray) or [**InsertRecognitionResults**](/windows/desktop/api/peninputpanel/nf-peninputpanel-ihandwrittentextinsertion-insertinkrecognitionresult) depends on whether the application has the recognition alternates for the text stored as an array or as an [**IInkRecognitionResult**](/windows/desktop/api/msinkaut/nn-msinkaut-iinkrecognitionresult) object.</span></span>

> [!Note]  
> <span data-ttu-id="228b1-144">在 managed 程式碼中工作時，InsertRecognitionResultsArray 所使用的對應辨識物件為 [RecognitionResult](/previous-versions/ms552537(v=vs.100))。</span><span class="sxs-lookup"><span data-stu-id="228b1-144">When working in managed code, the corresponding recognition object consumed by InsertRecognitionResultsArray is [RecognitionResult](/previous-versions/ms552537(v=vs.100)).</span></span> <span data-ttu-id="228b1-145">這兩種方法都會使用下列三個參數：</span><span class="sxs-lookup"><span data-stu-id="228b1-145">Both methods consume the following three parameters:</span></span>

 

-   <span data-ttu-id="228b1-146">*替代* 這是兩個維度的字串集合，儲存為數組的陣列或 [**IInkRecognitionResult**](/windows/desktop/api/msinkaut/nn-msinkaut-iinkrecognitionresult) (或 [RecognitionResult](/previous-versions/ms552537(v=vs.100))) 物件。</span><span class="sxs-lookup"><span data-stu-id="228b1-146">*alternates* Is a two dimensional collection of strings, stored either as an array of arrays or as an [**IInkRecognitionResult**](/windows/desktop/api/msinkaut/nn-msinkaut-iinkrecognitionresult) (or [RecognitionResult](/previous-versions/ms552537(v=vs.100))) object.</span></span> <span data-ttu-id="228b1-147">如果替代項儲存為數組的陣列，則應該以安全陣列指標的形式傳遞。</span><span class="sxs-lookup"><span data-stu-id="228b1-147">If the alternates are stored as an array of arrays, then it should be passed as a safe array pointer.</span></span> <span data-ttu-id="228b1-148">最上層陣列中的每個專案都是插入中單一單字的替代清單。</span><span class="sxs-lookup"><span data-stu-id="228b1-148">Each entry in the top level array is a list of alternates for a single word in the insertion.</span></span> <span data-ttu-id="228b1-149">替代項的子陣列中位置零的專案是插入文字欄位中的文字。</span><span class="sxs-lookup"><span data-stu-id="228b1-149">The entry at position zero in the sub-arrays of alternates is the text that is inserted into the text field.</span></span> <span data-ttu-id="228b1-150">每個子陣列中的額外替代 (索引1到 n) 都會儲存在文字服務備份儲存區中，並提供給使用者作為檔內更正的一部分選項。</span><span class="sxs-lookup"><span data-stu-id="228b1-150">The additional alternates (indices 1 through n in each sub-array) are stored in the Text Services backing-store and offered to the user as choices as part of in-document correction.</span></span> <span data-ttu-id="228b1-151">如果未包含替代項，則使用者會看到「沒有建議」取代替代清單。</span><span class="sxs-lookup"><span data-stu-id="228b1-151">If alternates are not included, then the user sees 'No suggestion' in place of the list of alternates.</span></span> <span data-ttu-id="228b1-152">如果插入包含多個單字之間有空格，則每個空格都必須包含在最上層陣列中做為專案。</span><span class="sxs-lookup"><span data-stu-id="228b1-152">If an insertion contains multiple words with spaces between them, then each space must be included as an entry in the top level array.</span></span>
-   <span data-ttu-id="228b1-153">*語言* 對應至 *替代* 參數中所包含之文字的輸入語言 [LCID](/previous-versions/ms221397(v=vs.71)) 。</span><span class="sxs-lookup"><span data-stu-id="228b1-153">*language* The Input Language [LCID](/previous-versions/ms221397(v=vs.71)) that corresponds to the text contained in the *alternates* parameter.</span></span> <span data-ttu-id="228b1-154">在手寫或語音辨識器產生 *替代* 項內容的情況下，這也是與所用辨識器相關聯的 [ [**語言**](/windows/desktop/api/msinkaut/nf-msinkaut-iinkrecognizer-get_languages) ] 屬性。</span><span class="sxs-lookup"><span data-stu-id="228b1-154">In the case in which the contents of *alternates* was generated by a handwriting or speech recognizer, this is also the [**Languages**](/windows/desktop/api/msinkaut/nf-msinkaut-iinkrecognizer-get_languages) property associated with the recognizer used.</span></span>
-   <span data-ttu-id="228b1-155">*fLatticeContainsAutoSpacingInformation* 旗標，指出 *替代* 參數中包含的文字是否由已啟用自動間距的辨識器產生。</span><span class="sxs-lookup"><span data-stu-id="228b1-155">*fLatticeContainsAutoSpacingInformation* A flag indicating whether the text contained in the *alternates* parameter was generated by a recognizer with auto-spacing enabled.</span></span> <span data-ttu-id="228b1-156">如果已啟用自動間距，則旗標應設定為 **TRUE**。</span><span class="sxs-lookup"><span data-stu-id="228b1-156">If auto-spacing was enabled, then the flag should be set to **TRUE**.</span></span> <span data-ttu-id="228b1-157">如果已停用自動間距，則旗標應設定為 **FALSE**。</span><span class="sxs-lookup"><span data-stu-id="228b1-157">If auto-spacing was disabled, then the flag should be set to **FALSE**.</span></span> <span data-ttu-id="228b1-158">如果 *替代* 項的內容是由不支援自動間距的辨識器所產生，或者完全不是由辨識器產生，則旗標應設為 **FALSE**。</span><span class="sxs-lookup"><span data-stu-id="228b1-158">In the case in which the contents of *alternates* was generated by a recognizer that does not support auto-spacing, or was not generated by a recognizer at all, then the flag should be set to **FALSE**.</span></span>

<span data-ttu-id="228b1-159">輸入面板的可程式性模型可以從系統插入號的位置，插入檔或應用程式中的文字。</span><span class="sxs-lookup"><span data-stu-id="228b1-159">Input Panel's programmability model is able to insert the text in the document or application from the position of the system caret.</span></span>

<span data-ttu-id="228b1-160">如果插入成功，這兩種方法都會傳回 **S \_ OK** 。</span><span class="sxs-lookup"><span data-stu-id="228b1-160">Both methods return **S\_OK** if the insertion succeeds.</span></span> <span data-ttu-id="228b1-161">如果應用程式不是以文字服務為基礎或未啟用，則會傳回 **e \_ NOINTERFACE** ，而如果 *替代* 功能格式不正確或無法存取，則會傳回 **e \_ INVALIDARG** 。</span><span class="sxs-lookup"><span data-stu-id="228b1-161">They return **E\_NOINTERFACE** if the application is not Text Services based or enabled, and **E\_INVALIDARG** if *alternates* is improperly formatted or inaccessible.</span></span> <span data-ttu-id="228b1-162">如果系統上沒有足夠的記憶體可用，它們也可能會傳回 **e \_ OUTOFMEMORY** ，或在發生嚴重失敗（例如文字服務架構未啟用）之後 **\_ 發生** 錯誤。</span><span class="sxs-lookup"><span data-stu-id="228b1-162">They may also return **E\_OUTOFMEMORY** if there is not enough memory available on the system, or **E\_FAIL** after a catastrophic failure such as the Text Services Framework not being enabled.</span></span>

### <a name="conclusion"></a><span data-ttu-id="228b1-163">結論</span><span class="sxs-lookup"><span data-stu-id="228b1-163">Conclusion</span></span>

<span data-ttu-id="228b1-164">使用 [輸入面板] 針對未輸入的文字啟用輸入面板的檔內更正，對於以文字服務為基礎或啟用的應用程式，使用功能強大的畫筆修正功能來補充自訂筆跡或輸入方法，是一種便宜且簡單的方式。</span><span class="sxs-lookup"><span data-stu-id="228b1-164">Enabling Input Panel in-document correction for text not entered using Input Panel is a cheap and easy way for a Text Services based or enabled application to supplement a custom inking or input method with powerful pen-based correction functionality.</span></span> <span data-ttu-id="228b1-165">在 Windows Vista 中，所有豐富的編輯和 Trident 應用程式都已啟用文字服務。</span><span class="sxs-lookup"><span data-stu-id="228b1-165">On Windows Vista, all Rich Edit and Trident applications are Text Services enabled.</span></span> <span data-ttu-id="228b1-166">雖然整合式筆墨表面是將自訂 Tablet PC 使用者體驗新增到應用程式的絕佳選項，但是如果不包含更正功能，則只支援一半的文字專案。</span><span class="sxs-lookup"><span data-stu-id="228b1-166">While integrated inking surfaces are a great option for adding a custom Tablet PC user experience to an application, they only support half of text entry if they do not include correction capabilities.</span></span> <span data-ttu-id="228b1-167">檔內更正可為使用者提供另一半的案例，方法是新增交換辨識選項的功能，或重寫部分或全部的選取專案。</span><span class="sxs-lookup"><span data-stu-id="228b1-167">In-document correction provides users with the other half of the story by adding the ability to swap a selection for a recognition alternate, or to rewrite part or all of the selection.</span></span>

## <a name="related-topics"></a><span data-ttu-id="228b1-168">相關主題</span><span class="sxs-lookup"><span data-stu-id="228b1-168">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="228b1-169">程式設計文字輸入面板</span><span class="sxs-lookup"><span data-stu-id="228b1-169">Programming the Text Input Panel</span></span>](programming-the-text-input-panel.md)
</dt> </dl>

 

 
