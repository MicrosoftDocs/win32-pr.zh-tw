---
description: " (API) 使用 StylusInput 應用程式設計介面時的執行緒考慮。"
ms.assetid: 5d98768a-c60b-4bb0-8640-9bf38254d41f
title: StylusInput API 的執行緒考慮
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 530ac95fdf0e74e30c83a437b6ed573d03bb2c91
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/08/2021
ms.locfileid: "103849376"
---
# <a name="threading-considerations-for-the-stylusinput-api"></a><span data-ttu-id="71bd3-103">StylusInput API 的執行緒考慮</span><span class="sxs-lookup"><span data-stu-id="71bd3-103">Threading Considerations for the StylusInput API</span></span>

<span data-ttu-id="71bd3-104">[**RealTimeStylus**](realtimestylus-class.md)物件是設計來提供從 tablet 畫筆即時存取資料流程的功能。</span><span class="sxs-lookup"><span data-stu-id="71bd3-104">The [**RealTimeStylus**](realtimestylus-class.md) object is designed to provide real-time access to the data stream from the tablet pen.</span></span> <span data-ttu-id="71bd3-105">外掛程式，可將實 [**IStylusSyncPlugin**](/windows/win32/api/rtscom/nn-rtscom-istylussyncplugin) 或 [**IStylusAsyncPlugin**](/windows/win32/api/rtscom/nn-rtscom-istylusasyncplugin) 介面的物件加入至 **RealTimeStylus** 物件。</span><span class="sxs-lookup"><span data-stu-id="71bd3-105">Plug-ins, objects which implement the [**IStylusSyncPlugin**](/windows/win32/api/rtscom/nn-rtscom-istylussyncplugin) or [**IStylusAsyncPlugin**](/windows/win32/api/rtscom/nn-rtscom-istylusasyncplugin) interface can be added to a **RealTimeStylus** object.</span></span> <span data-ttu-id="71bd3-106">同步外掛程式通常會直接在高優先順序的執行緒上由 **RealTimeStylus** 物件呼叫，而非同步外掛程式通常會在應用程式的使用者介面上呼叫， (UI) 執行緒。</span><span class="sxs-lookup"><span data-stu-id="71bd3-106">Synchronous plug-ins are generally called directly by the **RealTimeStylus** object on a high-priority thread, while asynchronous plug-ins are generally called on the application's user interface (UI) thread.</span></span> <span data-ttu-id="71bd3-107">針對需要即時存取資料流程和 undemanding 的工作（例如封包篩選），建立或使用同步外掛程式。</span><span class="sxs-lookup"><span data-stu-id="71bd3-107">Create or use synchronous plug-ins for tasks that require real-time access to the data stream and are computationally undemanding, such as packet filtering.</span></span> <span data-ttu-id="71bd3-108">針對不需要即時存取資料流程的工作建立或使用非同步外掛程式，例如筆墨收集。</span><span class="sxs-lookup"><span data-stu-id="71bd3-108">Create or use asynchronous plug-ins for tasks that do not require real-time access to the data stream, such as ink collection.</span></span>

<span data-ttu-id="71bd3-109">因為 [**realtimestylus**](realtimestylus-class.md) 物件之非同步外掛程式集合的外掛程式資料已排入佇列，所以非同步外掛程式可能會在接收其 [RealTimeStylusDisabled](/previous-versions/ms824774(v=msdn.10)) 方法的呼叫之前接收資料，但在停用 **RealTimeStylus** 物件之後。</span><span class="sxs-lookup"><span data-stu-id="71bd3-109">Because the plug-in data for the [**RealTimeStylus**](realtimestylus-class.md) object's asynchronous plug-in collection is queued, asynchronous plug-ins may receive data prior to receiving a call to its [RealTimeStylusDisabled](/previous-versions/ms824774(v=msdn.10)) method but after the **RealTimeStylus** object is disabled.</span></span> <span data-ttu-id="71bd3-110">請注意，如果已停用 **realtimestylus** 物件，某些 **realtimestylus** 物件的方法和屬性會擲回例外狀況。</span><span class="sxs-lookup"><span data-stu-id="71bd3-110">Note that some of the **RealTimeStylus** object's methods and properties throw an exception if the **RealTimeStylus** object is disabled.</span></span>

<span data-ttu-id="71bd3-111">下列 [**IStylusSyncPlugin**](/windows/win32/api/rtscom/nn-rtscom-istylussyncplugin) 介面方法可能會在 tablet 畫筆資料執行緒以外的執行緒上呼叫。</span><span class="sxs-lookup"><span data-stu-id="71bd3-111">The following [**IStylusSyncPlugin**](/windows/win32/api/rtscom/nn-rtscom-istylussyncplugin) interface methods may call on a thread other than the tablet pen data thread.</span></span>

-   <span data-ttu-id="71bd3-112">[RealTimeStylusEnabled](/previous-versions/ms824758(v=msdn.10))和 [RealTimeStylusDisabled](/previous-versions/ms824757(v=msdn.10))方法會線上程上呼叫，以更新 [**realtimestylus**](realtimestylus-class.md)物件的 [Enabled](/previous-versions/ms585380(v=vs.100))屬性，或在啟用 **realtimestylus** 物件時加入或移除外掛程式。</span><span class="sxs-lookup"><span data-stu-id="71bd3-112">The [RealTimeStylusEnabled](/previous-versions/ms824758(v=msdn.10)) and [RealTimeStylusDisabled](/previous-versions/ms824757(v=msdn.10)) methods are called on the thread that updates the [**RealTimeStylus**](realtimestylus-class.md) object's [Enabled](/previous-versions/ms585380(v=vs.100)) property or that adds or removes the plug-in while the **RealTimeStylus** object is enabled.</span></span>
-   <span data-ttu-id="71bd3-113">[CustomStylusDataAdded](/previous-versions/ms824753(v=msdn.10))方法會在呼叫 [**RealTimeStylus**](realtimestylus-class.md)物件之 [AddCustomStylusDataToQueue](/previous-versions/ms825761(v=msdn.10))方法的執行緒上呼叫。</span><span class="sxs-lookup"><span data-stu-id="71bd3-113">The [CustomStylusDataAdded](/previous-versions/ms824753(v=msdn.10)) method is called on the thread that calls the [**RealTimeStylus**](realtimestylus-class.md) object's [AddCustomStylusDataToQueue](/previous-versions/ms825761(v=msdn.10)) method.</span></span>
-   <span data-ttu-id="71bd3-114">[錯誤](/previous-versions/ms824754(v=msdn.10))方法是在同步外掛程式于擲回例外狀況時執行的執行緒上呼叫。</span><span class="sxs-lookup"><span data-stu-id="71bd3-114">The [Error](/previous-versions/ms824754(v=msdn.10)) method is called on the thread on which the synchronous plug-in is running when it throws an exception.</span></span>

<span data-ttu-id="71bd3-115">若要從同步外掛程式與您的應用程式互動，請使用 [**RealTimeStylus**](realtimestylus-class.md)物件的 [AddCustomStylusDataToQueue](/previous-versions/ms825761(v=msdn.10))方法，並處理其中一個非同步外掛程式的自訂手寫筆資料。如果您從同步外掛程式對另一個執行緒進行同步呼叫，您可能會封鎖 **RealTimeStylus** 物件，因而封鎖筆墨收集。</span><span class="sxs-lookup"><span data-stu-id="71bd3-115">To interact with your application from a synchronous plug-in, use the [AddCustomStylusDataToQueue](/previous-versions/ms825761(v=msdn.10)) method of the [**RealTimeStylus**](realtimestylus-class.md) object and handle the custom stylus data in one of your asynchronous plug-ins. If you make a synchronous call to another thread from a synchronous plug-in, you may block the **RealTimeStylus** object and thus block ink collection.</span></span>

<span data-ttu-id="71bd3-116">某些工作可能需要對 tablet 畫筆的資料串流進行即時存取，例如 multistroke 手勢辨識。</span><span class="sxs-lookup"><span data-stu-id="71bd3-116">Certain tasks may be computationally demanding yet still require real-time access to the tablet pen's data stream, such as for multistroke gesture recognition.</span></span> <span data-ttu-id="71bd3-117">StylusInput Api 提供了串聯的 [**realtimestylus**](realtimestylus-class.md) 模型，可讓您使用兩個 **RealTimeStylus** 物件，每個物件都會從不同的執行緒呼叫它的同步外掛程式。</span><span class="sxs-lookup"><span data-stu-id="71bd3-117">The StylusInput APIs provide a cascaded [**RealTimeStylus**](realtimestylus-class.md) model that allows you to use two **RealTimeStylus** objects, each one calling its synchronous plug-ins from different threads.</span></span> <span data-ttu-id="71bd3-118">如需有關串聯的 **realtimestylus** 模型的詳細資訊，請參閱 [串聯的 realtimestylus 模型](the-cascaded-realtimestylus-model.md)。</span><span class="sxs-lookup"><span data-stu-id="71bd3-118">For more information about the cascaded **RealTimeStylus** model, see [The Cascaded RealTimeStylus Model](the-cascaded-realtimestylus-model.md).</span></span>

> [!Note]  
> <span data-ttu-id="71bd3-119">您無法在不同的進程中將 [**RealTimeStylus**](realtimestylus-class.md) 物件附加至視窗或控制項。</span><span class="sxs-lookup"><span data-stu-id="71bd3-119">You cannot attach the [**RealTimeStylus**](realtimestylus-class.md) object to a window or control in a different process.</span></span>

 

<span data-ttu-id="71bd3-120">如需 Tablet PC 一般執行緒考慮的詳細資訊，請參閱 [TABLET Pc 執行緒的考慮](tablet-pc-threading-considerations.md)</span><span class="sxs-lookup"><span data-stu-id="71bd3-120">For more information about threading considerations for the Tablet PC in general, see [Tablet PC Threading Considerations](tablet-pc-threading-considerations.md)</span></span>

 

 
