---
description: 執行指定的動作時， \_ 應用程式幾乎會立即傳送和接收系統事件 (前面加上 ISG) 。
ms.assetid: deca6d17-fe2c-4130-88ca-d0605bcb6084
title: 滑鼠訊息和系統事件的時間軸
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 8aee3e6cb7882e1628fee0d2bc40f79ed1e29f55
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/08/2021
ms.locfileid: "106987641"
---
# <a name="timeline-of-mouse-messages-and-system-events"></a><span data-ttu-id="8eb02-103">滑鼠訊息和系統事件的時間軸</span><span class="sxs-lookup"><span data-stu-id="8eb02-103">Timeline of Mouse Messages and System Events</span></span>

<span data-ttu-id="8eb02-104">執行指定的動作時， \_ 應用程式幾乎會立即傳送和接收系統事件 (前面加上 ISG) 。</span><span class="sxs-lookup"><span data-stu-id="8eb02-104">When a given action is performed, the system events (prefixed with ISG\_) are sent and received almost instantaneously by the application.</span></span> <span data-ttu-id="8eb02-105">在執行動作時，會傳送以 WM) 為首碼 (的滑鼠訊息 \_ ，並在由 Microsoft Windows 訊息處理服務處理事件所需的時間之後，由應用程式接收。</span><span class="sxs-lookup"><span data-stu-id="8eb02-105">The mouse messages (prefixed with WM\_) are sent when the action is performed and are received by the application after the time it takes for the event to be processed by the Microsoft Windows messaging service.</span></span> <span data-ttu-id="8eb02-106">此外， **CursorDown** 和 **CursorUp** 是從畫筆硬體接收的畫筆事件。</span><span class="sxs-lookup"><span data-stu-id="8eb02-106">In addition, **CursorDown** and **CursorUp** are pen events that are received from the pen hardware.</span></span> <span data-ttu-id="8eb02-107">當 tablet 畫筆觸及螢幕，以及從螢幕中移除時，就會傳送它們。</span><span class="sxs-lookup"><span data-stu-id="8eb02-107">They are sent when the tablet pen touches the screen and when it is lifted from the screen, respectively.</span></span>

<span data-ttu-id="8eb02-108">畫筆事件和滑鼠訊息不會進行同步處理。</span><span class="sxs-lookup"><span data-stu-id="8eb02-108">Pen events and mouse messages are not synchronized.</span></span> <span data-ttu-id="8eb02-109">不保證對應的滑鼠訊息和畫筆事件會以特定順序發生。</span><span class="sxs-lookup"><span data-stu-id="8eb02-109">There is no guarantee that corresponding mouse messages and pen events will occur in a particular order.</span></span> <span data-ttu-id="8eb02-110">下圖顯示所傳送之系統和滑鼠事件的預期（但不一定是可預測的）順序。</span><span class="sxs-lookup"><span data-stu-id="8eb02-110">The following chart shows the expected, but not always predictable, sequence of system and mouse events that are sent.</span></span> <span data-ttu-id="8eb02-111">請注意，在圖表中偵測到系統手勢事件時會延遲滑鼠事件。</span><span class="sxs-lookup"><span data-stu-id="8eb02-111">Notice in the chart that the mouse events are delayed when system gesture events are detected.</span></span>

![畫筆輸入的系統和滑鼠事件的預期順序](images/ccdafa48-13c0-4af7-aec5-ed162be4bbe7.jpg)

## <a name="important-implementation-considerations"></a><span data-ttu-id="8eb02-113">重要的實作為考慮</span><span class="sxs-lookup"><span data-stu-id="8eb02-113">Important Implementation Considerations</span></span>

<span data-ttu-id="8eb02-114">在開發滑鼠訊息和系統事件時，請考慮下列事項：</span><span class="sxs-lookup"><span data-stu-id="8eb02-114">Consider the following when developing for mouse messages and system events:</span></span>

-   <span data-ttu-id="8eb02-115">無論畫筆或滑鼠是否使用，畫筆事件和滑鼠訊息都會傳送至應用程式。</span><span class="sxs-lookup"><span data-stu-id="8eb02-115">Both pen events and mouse messages are sent to an application, regardless of whether the pen or the mouse is used.</span></span>
-   <span data-ttu-id="8eb02-116">如果您的應用程式同時接聽畫筆和滑鼠訊息，則很難預測訊息的關聯性，因此是最終行為。</span><span class="sxs-lookup"><span data-stu-id="8eb02-116">If your application listens for both pen and mouse messages it is difficult to predict the relationship of the messages and hence the eventual behavior.</span></span> <span data-ttu-id="8eb02-117">畫筆事件和滑鼠訊息不會進行同步處理。</span><span class="sxs-lookup"><span data-stu-id="8eb02-117">Pen events and mouse messages are not synchronized.</span></span> <span data-ttu-id="8eb02-118">不保證對應的滑鼠訊息和畫筆事件 (例如，WM \_ LBUTTONDOWN、 **\_ ISG** 點、wm \_ LBUTTONDBLCLK 和 **ISG \_ DBLTAP**) 將依特定順序進行。</span><span class="sxs-lookup"><span data-stu-id="8eb02-118">There is no guarantee that corresponding mouse messages and pen events (such as WM\_LBUTTONDOWN and **ISG\_TAP**, or WM\_LBUTTONDBLCLK and **ISG\_DBLTAP**) will occur in a particular order.</span></span> <span data-ttu-id="8eb02-119">這些訊息之間的關聯性相當複雜。</span><span class="sxs-lookup"><span data-stu-id="8eb02-119">The relationship between these messages is complex.</span></span>
-   <span data-ttu-id="8eb02-120">建議您不要在相同的應用程式功能中混用和比對滑鼠和畫筆事件。</span><span class="sxs-lookup"><span data-stu-id="8eb02-120">It is recommended not to mix-and-match mouse and pen events in the same application feature.</span></span> <span data-ttu-id="8eb02-121">例如，回應 **CursorDown** 和 **MouseUp** 的應用程式功能可能不會如預期般運作，或是與未來的 Tablet PC SDK 版本一樣。</span><span class="sxs-lookup"><span data-stu-id="8eb02-121">For example an application feature that responds to **CursorDown** and **MouseUp** may not behave as expected now or with future versions of the Tablet PC SDK.</span></span>
-   <span data-ttu-id="8eb02-122">針對 [按住] 事件順序，如果使用者在序列完成之前拖曳 tablet 畫筆，則會傳送的事件對應至左方拖曳。</span><span class="sxs-lookup"><span data-stu-id="8eb02-122">For the hold through event sequence, if the user drags the tablet pen before the sequence is complete, the events that are sent correspond to left-drag.</span></span> <span data-ttu-id="8eb02-123">例如，當拖曳開始時，會傳送 **ISG \_ 拖曳** 和 WM \_ LBUTTONDOWN。</span><span class="sxs-lookup"><span data-stu-id="8eb02-123">For example, when the drag starts, **ISG\_DRAG** and WM\_LBUTTONDOWN are sent.</span></span> <span data-ttu-id="8eb02-124">當畫筆最後會提起時，會傳送 **CursorUp** 和 WM \_ LBUTTONUP。</span><span class="sxs-lookup"><span data-stu-id="8eb02-124">When the pen is eventually lifted, **CursorUp** and WM\_LBUTTONUP are sent.</span></span> <span data-ttu-id="8eb02-125">系統筆勢事件可能不會立即引發，因為它必須判斷發生何種類型的事件。</span><span class="sxs-lookup"><span data-stu-id="8eb02-125">The system gesture event may not fire immediately because it must determine what kind of event is occurring.</span></span>
-   <span data-ttu-id="8eb02-126">使用 tablet 畫筆的點一下，通常比按兩下滑鼠的方式更不精確。</span><span class="sxs-lookup"><span data-stu-id="8eb02-126">A double-tap with a tablet pen is often less accurate than a double-click with a mouse.</span></span> <span data-ttu-id="8eb02-127">這是利用 tablet 畫筆來執行兩點的固有本質。</span><span class="sxs-lookup"><span data-stu-id="8eb02-127">This comes from the inherent nature of performing a double-tap with a tablet pen.</span></span> <span data-ttu-id="8eb02-128">由於使用者必須提起 tablet 畫筆以執行點一下，所以點擊之間的時間通常會大於按兩下時的對應時間。</span><span class="sxs-lookup"><span data-stu-id="8eb02-128">Because the user must lift the tablet pen to perform a double-tap, the time between taps is often greater than the corresponding time between clicks of a double-click.</span></span> <span data-ttu-id="8eb02-129">此外，這兩個 tablet 畫筆的點擊率很可能會在螢幕座標上發生，而不是在兩次按下滑鼠的情況下執行。</span><span class="sxs-lookup"><span data-stu-id="8eb02-129">In addition, it is likely that the two taps of the tablet pen occur at screen coordinates that are further apart than those for the two clicks of the mouse.</span></span> <span data-ttu-id="8eb02-130">為了因應這種情況，Windows XP Tablet PC Edition 具有設定，可讓您在兩個點之間的時間點距離與滑鼠按兩下分開的點點。</span><span class="sxs-lookup"><span data-stu-id="8eb02-130">To accommodate this, Windows XP Tablet PC Edition has settings for the temporal and spatial distance between the two taps of a double-tap that are separate from the mouse settings for a double-click.</span></span> <span data-ttu-id="8eb02-131">這些設定可以在主控台中的 Tablet 和畫筆設定中調整。</span><span class="sxs-lookup"><span data-stu-id="8eb02-131">These settings can be adjusted in Tablet and Pen Settings in Control Panel.</span></span>

<span data-ttu-id="8eb02-132">基於這些考慮，應用程式應該只接聽一組訊息，而非兩者。</span><span class="sxs-lookup"><span data-stu-id="8eb02-132">Because of these considerations, applications should listen to only one set of messages rather than both.</span></span> <span data-ttu-id="8eb02-133">如果您要建立已啟用畫筆的應用程式，只需聆聽系統和畫筆訊息。</span><span class="sxs-lookup"><span data-stu-id="8eb02-133">If you are building a pen-enabled application, listen only to the system and pen messages.</span></span> <span data-ttu-id="8eb02-134">這些訊息是可預測的，且適用于 tablet 畫筆。</span><span class="sxs-lookup"><span data-stu-id="8eb02-134">These messages are predictable and work well with the tablet pen.</span></span> <span data-ttu-id="8eb02-135">如果您要建立的應用程式未啟用畫筆，請只聆聽滑鼠訊息。</span><span class="sxs-lookup"><span data-stu-id="8eb02-135">If you are building an application that is not pen-enabled, listen only for the mouse messages.</span></span>

 

 



