---
description: Windows Vista 的發行版本包含了 [Tablet PC 輸入面板] 的新可程式性物件，可提供應用程式如何使用和與輸入面板互動的新範圍。
ms.assetid: 539f41d3-5fb8-4e20-99ba-0d5af1f0cc54
title: 適用于 PenInputPanel 使用者的 TextInputPanel
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 14ed213db49427d997f0ea1dda414cf1a6a0c2d4
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/08/2021
ms.locfileid: "104320607"
---
# <a name="textinputpanel-for-users-of-peninputpanel"></a><span data-ttu-id="59591-103">適用于 PenInputPanel 使用者的 TextInputPanel</span><span class="sxs-lookup"><span data-stu-id="59591-103">TextInputPanel for Users of PenInputPanel</span></span>

<span data-ttu-id="59591-104">Windows Vista 的發行版本包含了 [Tablet PC 輸入面板] 的新可程式性物件，可提供應用程式如何使用和與輸入面板互動的新範圍。</span><span class="sxs-lookup"><span data-stu-id="59591-104">The release of Windows Vista includes a new programmability object for the Tablet PC Input Panel that provides a new range of possibility for how an application can use and interact with Input Panel.</span></span> <span data-ttu-id="59591-105">第一次，應用程式開發人員可以將 In-Place 輸入面板圖示定位至文字方塊中，或將它放在客戶筆跡表面的角落，以提供替代輸入模式的存取權。</span><span class="sxs-lookup"><span data-stu-id="59591-105">For the first time application developers can position the In-Place Input Panel Icon to line up with a text box or place it in the corner of a customer inking surface to offer access to an alternative input mode.</span></span> <span data-ttu-id="59591-106">當輸入面板圖示展開至 In-Place 輸入面板之後，開發人員就會有相同的定位控制權。</span><span class="sxs-lookup"><span data-stu-id="59591-106">Developers have the same control over positioning once the Input Panel Icon is expanded into the In-Place Input Panel.</span></span> <span data-ttu-id="59591-107">如此一來，就可以確保 In-Place 輸入面板永遠不會與應用程式佈建中的主要使用者介面元素重迭，或甚至是重新排列應用程式的使用者介面，以為 In-Place 輸入面板建立空間，然後將它放在保留空間中。</span><span class="sxs-lookup"><span data-stu-id="59591-107">This makes it possible to assure the In-Place Input Panel never overlaps with key user interface elements in an application's layout or even to reflow an application's user interface to make space for the In-Place Input Panel and then place it in the reserved space.</span></span> <span data-ttu-id="59591-108">新的可程式性模型不僅支援定位，開發人員也可以自訂輸入區域、更正模式以及許多其他的輸入面板屬性，以在應用程式中量身訂做文字輸入體驗。</span><span class="sxs-lookup"><span data-stu-id="59591-108">The new programmability model includes support for more than just positioning though, developers can also customize the input area, correction mode, and many other properties of Input Panel to tailor make the text entry experience in an application.</span></span> <span data-ttu-id="59591-109">最後，在第一次，應用程式可能會接收使用者筆跡，除了可辨識的文字之外，還能與輸入面板中的文字插入相關聯。</span><span class="sxs-lookup"><span data-stu-id="59591-109">Lastly, for the first time it is possible for an application to receive the user ink, in addition to the recognized text, associated with text insertions from Input Panel.</span></span> <span data-ttu-id="59591-110">這會啟用新的應用程式案例，包括變更追蹤記錄中的筆墨，以及允許使用者在應用程式中編輯或查看筆墨。</span><span class="sxs-lookup"><span data-stu-id="59591-110">This enables new application scenarios including ink in change tracking logs and allowing users to edit or view ink in the application.</span></span> <span data-ttu-id="59591-111">這些新的程式設計功能是 Microsoft 針對輸入面板開發人員故事所收到意見反應的直接結果，並代表更緊密地整合應用程式與輸入面板的第一步。</span><span class="sxs-lookup"><span data-stu-id="59591-111">These new programmability features are the direct result of feedback Microsoft has received about the Input Panel developer story and represent the first step toward tighter integration of applications and Input Panel.</span></span>

<span data-ttu-id="59591-112">為了提供此擴充的輸入面板可程式化模型，現有的機制可以用程式設計方式與輸入面板互動， [**PenInputPanel**](peninputpanel-class.md) 物件會被取代，並取代為新的 [**TextInputPanel**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel) 物件。</span><span class="sxs-lookup"><span data-stu-id="59591-112">In order to provide this enriched Input Panel programmability model the existing mechanism for programmatically interacting with Input Panel, the [**PenInputPanel**](peninputpanel-class.md) object, is being deprecated and replaced by the new [**TextInputPanel**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel) object.</span></span> <span data-ttu-id="59591-113">除了提供新的程式設計功能之外， **TextInputPanel** 物件也提供 **PenInputPanel** 物件的所有程式設計功能。</span><span class="sxs-lookup"><span data-stu-id="59591-113">In addition to providing new programmability features, the **TextInputPanel** object also provides close to all of the programmatic capabilities of the **PenInputPanel** object.</span></span> <span data-ttu-id="59591-114">**TextInputPanel** 物件包含在 windows Vista 和 Windows Vista 軟體發展人員套件中。</span><span class="sxs-lookup"><span data-stu-id="59591-114">The **TextInputPanel** object is included in both Windows Vista and the Windows Vista Software Developer Kit.</span></span> <span data-ttu-id="59591-115">**TextInputPanel** 物件只與 windows Vista 的 [輸入面板] 相容，且不能與 Windows XP Service Pack 2 或舊版的 [輸入面板] 搭配使用。</span><span class="sxs-lookup"><span data-stu-id="59591-115">The **TextInputPanel** object is only compatible with the Windows Vista Input Panel and cannot be used with the Windows XP Service Pack 2 or older Input Panel.</span></span> <span data-ttu-id="59591-116">先前撰寫為使用 **PenInputPanel** 物件的應用程式將會繼續使用 Windows Vista 輸入面板，不過，在撰寫新的平板電腦應用程式時，強烈建議您使用新的 **TextInputPanel** 物件，而不是已淘汰的 **PenInputPanel** 物件。</span><span class="sxs-lookup"><span data-stu-id="59591-116">Application that were previously written to use the **PenInputPanel** object will continue to work with the Windows Vista Input Panel, however, when writing new Tablet applications developers are strongly encouraged to use the new **TextInputPanel** object instead of the deprecated **PenInputPanel** object.</span></span>

<span data-ttu-id="59591-117">[**TextInputPanel**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel)物件的每個可程式性選項，都可以根據每個文字欄位來套用。</span><span class="sxs-lookup"><span data-stu-id="59591-117">Each of the programmability options of the [**TextInputPanel**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel) object can be applied on a per text field basis.</span></span> <span data-ttu-id="59591-118">使用 [**AttachedEditWindow**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_attachededitwindow)屬性附加 **TextInputPanel** 物件的實例，即可完成這項作業。</span><span class="sxs-lookup"><span data-stu-id="59591-118">This is accomplished by attaching an instance of the **TextInputPanel** object using the [**AttachedEditWindow**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_attachededitwindow) property.</span></span> <span data-ttu-id="59591-119">屬性應該設定為文字欄位的視窗控制碼。</span><span class="sxs-lookup"><span data-stu-id="59591-119">The property should be set to the window handle for the text field.</span></span>

> [!Note]  
> <span data-ttu-id="59591-120">：當輸入面板處於就地互動模式時，以及當輸入面板處於浮動或停駐互動模式時，會套用下列幾個屬性和方法所述。</span><span class="sxs-lookup"><span data-stu-id="59591-120">: Several of the properties and methods describe below apply when Input Panel is in the in-place interaction mode and not when Input Panel is in the floating or docked interaction mode.</span></span> <span data-ttu-id="59591-121">就地互動模式是將焦點放在可編輯欄位中的輸入面板行為，會導致輸入面板圖示出現在欄位旁，而按下輸入面板圖示會導致輸入面板展開。</span><span class="sxs-lookup"><span data-stu-id="59591-121">The in-place interaction mode is the Input Panel behavior where placing focus in an editable field causes the Input Panel Icon to appear next to the field, and tapping on the Input Panel Icon causes Input Panel to expand.</span></span> <span data-ttu-id="59591-122">只有當輸入面板處於就地互動模式時，才會套用的方法和屬性會在方法或屬性名稱中包含「就地」。</span><span class="sxs-lookup"><span data-stu-id="59591-122">The methods and properties that only apply when Input Panel is in the in-place interaction mode all contain 'InPlace' in the method or property name.</span></span>

 

## <a name="control-of-input-panel-icon-and-input-panel-visibility"></a><span data-ttu-id="59591-123">輸入面板圖示和輸入面板可見度的控制權</span><span class="sxs-lookup"><span data-stu-id="59591-123">Control of Input Panel Icon and Input Panel Visibility</span></span>

<span data-ttu-id="59591-124">輸入面板的第一個層面是，應用程式開發人員可以在 Windows Vista 中獲得更多的控制權。</span><span class="sxs-lookup"><span data-stu-id="59591-124">The first aspect of Input Panel which application developers have more control over in Windows Vista is its visibility.</span></span> <span data-ttu-id="59591-125">您可以使用 [**TextInputPanel**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel) 物件，以三種方式控制 In-Place 輸入面板的可見度。</span><span class="sxs-lookup"><span data-stu-id="59591-125">Using the [**TextInputPanel**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel) object it is possible to control the visibility of the In-Place Input Panel in three ways.</span></span> <span data-ttu-id="59591-126">使用屬性和方法的組合，應用程式可以判斷 In-Place 輸入面板是否顯示、In-Place 輸入面板顯示時，以及它是先顯示為輸入面板圖示或立即顯示展開。</span><span class="sxs-lookup"><span data-stu-id="59591-126">With a combination of properties and methods an application can determine if the In-Place Input Panel shows, when the In-Place Input Panel shows, and whether it appears first as the Input Panel Icon or immediately shows expanded.</span></span> <span data-ttu-id="59591-127">藉由結合這些技術，以控制在下一節中所討論的定位技術，應用程式開發人員可以使用應用程式中的 In-Place 輸入面板來建立自訂啟動點和自訂工作流程。</span><span class="sxs-lookup"><span data-stu-id="59591-127">By combining these techniques for controlling visibility with the techniques for controlling positioning discussed in the next section it is possible for application developers to create custom launch points and custom work flows using the In-Place Input Panel in an application.</span></span>

> [!Note]  
> <span data-ttu-id="59591-128">只有當輸入面板處於 In-Place 互動模式時，本節中所討論的屬性和方法才適用。</span><span class="sxs-lookup"><span data-stu-id="59591-128">The properties and methods discussed in this section only apply when Input Panel is in the In-Place interaction mode.</span></span>

 

<span data-ttu-id="59591-129">首先，最重要的是，將 [**InPlaceVisibleOnFocus**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_inplacevisibleonfocus) 屬性設定為 **false**，就可以防止出現 In-Place 輸入面板和輸入面板圖示。</span><span class="sxs-lookup"><span data-stu-id="59591-129">First and most basically, it is possible to prevent the In-Place Input Panel and the Input Panel Icon from ever appearing by setting the [**InPlaceVisibleOnFocus**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_inplacevisibleonfocus) property to **false**.</span></span> <span data-ttu-id="59591-130">將它設定為 **true** 會將它還原為系統預設值（如果可能的話），但前提是使用者未停用它或群組原則。</span><span class="sxs-lookup"><span data-stu-id="59591-130">Setting it to **true** reverts it to the system default of appearing when possible, provided it has not been disabled by the user or Group Policy.</span></span> <span data-ttu-id="59591-131">此選項適用于包含自訂文字輸入解決方案的應用程式，做為輸入面板的替代方案。</span><span class="sxs-lookup"><span data-stu-id="59591-131">This option is useful for applications that include custom text entry solutions as an alternative to Input Panel.</span></span>

<span data-ttu-id="59591-132">其次，藉由設定 [**DefaultInPlaceState**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_defaultinplacestate) 屬性，開發人員可以指定 [**InPlaceState**](/windows/win32/api/peninputpanel/ne-peninputpanel-inplacestate) 列舉所指定的就地狀態，當焦點放在文字欄位時，In-Place 輸入面板就會出現在中。</span><span class="sxs-lookup"><span data-stu-id="59591-132">Second, by setting the [**DefaultInPlaceState**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_defaultinplacestate) property a developer can specify which in-place state, as specified by the [**InPlaceState**](/windows/win32/api/peninputpanel/ne-peninputpanel-inplacestate) enumeration, the In-Place Input Panel appears in when focus is placed in a text field.</span></span> <span data-ttu-id="59591-133">系統預設 In-Place 值為，除非輸入面板已在展開狀態中，否則 [輸入面板] 會出現在 [暫止] 狀態中，否則 [輸入面板] 會維持展開狀態。</span><span class="sxs-lookup"><span data-stu-id="59591-133">The system default is for the In-Place Input Panel to appear in the hover state unless Input Panel is already visible in the expanded state, in which case Input Panel remains expanded.</span></span> <span data-ttu-id="59591-134">將 [ **DefaultInPlaceState** ] 屬性設定為 [ **\_ 展開 InPlaceState** ] 會導致 In-Place 輸入面板一律會顯示為展開狀態，而不是先出現輸入面板圖示，然後在輸入面板展開之前要求使用者先點擊輸入面板圖示。</span><span class="sxs-lookup"><span data-stu-id="59591-134">Setting the **DefaultInPlaceState** property to **InPlaceState\_Expanded** causes the In-Place Input Panel to always appear expanded, rather than the Input Panel Icon appearing first and then requiring the user to tap the Input Panel Icon before Input Panel expands.</span></span> <span data-ttu-id="59591-135">另外兩個選項是 **InPlaceState \_ Auto**，也就是系統預設行為和 **InPlaceState \_ HoverTarget** ，一律會顯示輸入面板圖示。</span><span class="sxs-lookup"><span data-stu-id="59591-135">The other two options are **InPlaceState\_Auto**, which is the system default behavior and **InPlaceState\_HoverTarget** which always causes the Input Panel Icon to appear.</span></span> <span data-ttu-id="59591-136">指定 In-Place 輸入面板一律會一直展開的功能是 [**TextInputPanel**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel) 物件的新功能，而且不可能使用 [**PenInputPanel**](peninputpanel-class.md) 物件。</span><span class="sxs-lookup"><span data-stu-id="59591-136">The ability to specify that the In-Place Input Panel always appear expanded is new with the [**TextInputPanel**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel) object and not possible using the [**PenInputPanel**](peninputpanel-class.md) object.</span></span> <span data-ttu-id="59591-137">下圖顯示面板的 In-Place 輸入面板圖示和展開的狀態。</span><span class="sxs-lookup"><span data-stu-id="59591-137">The following illustration shows the In-Place Input Panel icon and expanded states of the panel.</span></span>

![就地輸入面板圖示和展開的狀態](images/8ce866b6-9a45-499f-a3d1-95a1d34d6402.jpg)

<span data-ttu-id="59591-139">除了能夠控制就地狀態之外，開發人員也有可能藉由取得 [**CurrentInPlaceState**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_currentinplacestate) 屬性，在指定的時間決定就地狀態。</span><span class="sxs-lookup"><span data-stu-id="59591-139">In addition to being able to control the in-place state, it is also possible for a developer to determine the in-place state at a given moment by getting the [**CurrentInPlaceState**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_currentinplacestate) property.</span></span> <span data-ttu-id="59591-140">當輸入面板不可見時， **CurrentInPlaceState** 等於 [**DefaultInPlaceState**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_defaultinplacestate) ，除非 **DefaultInPlaceState** **InPlaceState \_ Auto** ，否則 **CurrentInPlaceState** 會變成 **InPlaceState \_ HoverTarget**。</span><span class="sxs-lookup"><span data-stu-id="59591-140">The **CurrentInPlaceState** is equal to [**DefaultInPlaceState**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_defaultinplacestate) when Input Panel is not visible, except when the **DefaultInPlaceState** is **InPlaceState\_Auto** in which case the **CurrentInPlaceState** becomes **InPlaceState\_HoverTarget**.</span></span> <span data-ttu-id="59591-141">[**InPlaceVisibilityChanging**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpaneleventsink-inplacevisibilitychanging)  /  [**InPlaceVisibilityChanged**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpaneleventsink-inplacevisibilitychanged)事件可以用來追蹤 In-Place 輸入面板的可見度狀態。</span><span class="sxs-lookup"><span data-stu-id="59591-141">The [**InPlaceVisibilityChanging**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpaneleventsink-inplacevisibilitychanging) / [**InPlaceVisibilityChanged**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpaneleventsink-inplacevisibilitychanged) events can be used to keep track on the In-Place Input Panel's visibility state.</span></span>

<span data-ttu-id="59591-142">最後，開發人員可以強制 In-Place 的輸入面板使用 [**SetInPlaceVisibility**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-setinplacevisibility) 方法來隱藏或顯示。</span><span class="sxs-lookup"><span data-stu-id="59591-142">Lastly, a developer can force the In-Place Input Panel to hide or show using the [**SetInPlaceVisibility**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-setinplacevisibility) method.</span></span> <span data-ttu-id="59591-143">如果開發人員先前已設定 [**DefaultInPlaceState**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_defaultinplacestate) 屬性，當強制顯示時，輸入面板會顯示為指定的狀態。</span><span class="sxs-lookup"><span data-stu-id="59591-143">If the developer has previously set the [**DefaultInPlaceState**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_defaultinplacestate) property, Input Panel appears in the specified state when forced to show.</span></span> <span data-ttu-id="59591-144">只有當焦點目前位於 [**TextInputPanel**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel) 物件所連接的視窗中，以及當使用者未在另一個互動模式（例如停駐或浮動）中開啟輸入面板時，才允許應用程式隱藏或顯示 In-Place 輸入面板。</span><span class="sxs-lookup"><span data-stu-id="59591-144">An application is only permitted to hide or show the In-Place Input Panel when focus is currently in the window the [**TextInputPanel**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel) object is attached to and when the user does not have Input Panel open in another interaction mode, such as docked or floating.</span></span> <span data-ttu-id="59591-145">強制 In-Place 輸入面板隱藏或顯示的功能也是 **TextInputPanel** 物件的新功能，而且不可能使用 [**PenInputPanel**](peninputpanel-class.md) 物件。</span><span class="sxs-lookup"><span data-stu-id="59591-145">The ability to force the In-Place Input Panel to hide or show is also new with the **TextInputPanel** object and not possible using the [**PenInputPanel**](peninputpanel-class.md) object.</span></span>

<span data-ttu-id="59591-146">這些選項讓應用程式開發人員能在 In-Place 輸入面板出現時，以及在何種狀態中，對其進行細微的控制。</span><span class="sxs-lookup"><span data-stu-id="59591-146">These options give application developers fine grain control over when the In-Place Input Panel appears and in what state.</span></span> <span data-ttu-id="59591-147">藉由自訂預設的就地狀態，並控制與焦點無關的就地可見度，應用程式開發人員可以在輸入面板回應應用程式設定或使用者輸入至應用程式時，建立自訂工作流程。</span><span class="sxs-lookup"><span data-stu-id="59591-147">By customizing the default in-place state and controlling the in-place visibility independently of focus changes an application developer can create a custom work flow when Input Panel responds to either application settings or user input into an application.</span></span>

## <a name="absolute-positioning-of-input-panel-icon-and-input-panel"></a><span data-ttu-id="59591-148">輸入面板圖示和輸入面板的絕對位置</span><span class="sxs-lookup"><span data-stu-id="59591-148">Absolute Positioning of Input Panel Icon and Input Panel</span></span>

<span data-ttu-id="59591-149">[**TextInputPanel**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel)物件中最吸引人的新功能可能是 In-Place 輸入面板的絕對位置。</span><span class="sxs-lookup"><span data-stu-id="59591-149">Possibly the most compelling new feature found in the [**TextInputPanel**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel) object is absolute positioning of the In-Place Input Panel.</span></span> <span data-ttu-id="59591-150">有了這項新功能，應用程式開發人員可以確保 In-Place 輸入面板不會與應用程式佈建中的一或多個重要視覺元素重迭。</span><span class="sxs-lookup"><span data-stu-id="59591-150">With this new capability an application developer can ensure that the In-Place Input Panel does not overlap with one or more key visual elements in an application layout.</span></span> <span data-ttu-id="59591-151">您可以使用 [**PenInputPanel**](peninputpanel-class.md) 物件，根據位移將 In-Place 輸入面板放置在相對於文字欄位的位置，不過，輸入面板仍會自行調整以保持在畫面上。</span><span class="sxs-lookup"><span data-stu-id="59591-151">Using the [**PenInputPanel**](peninputpanel-class.md) object it was possible to position the In-Place Input Panel relative to a text field based on an offset, however, Input Panel would still adjust itself to keep on the screen.</span></span> <span data-ttu-id="59591-152">第一次在 Vista 中，應用程式可以使用螢幕座標，將 In-Place 輸入面板定位於絕對位置。</span><span class="sxs-lookup"><span data-stu-id="59591-152">For the first time in Vista an application can position the In-Place Input Panel at an absolute position using screen coordinates.</span></span> <span data-ttu-id="59591-153">此外，將輸入面板保持在螢幕上的責任是讓應用程式開發人員更有可能會自動自動重新調整輸入面板的位置。</span><span class="sxs-lookup"><span data-stu-id="59591-153">Additionally, the responsibility of keeping Input Panel on the screen is left to the application developer therefore removing the chance that Input Panel will automatically, and seemingly randomly, reposition itself.</span></span>

> [!Note]  
> <span data-ttu-id="59591-154">只有當輸入面板處於 In-Place 互動模式時，本節中所討論的屬性和方法才適用。</span><span class="sxs-lookup"><span data-stu-id="59591-154">The properties and methods discussed in this section only apply when Input Panel is in the In-Place interaction mode.</span></span>

 

<span data-ttu-id="59591-155">絕對位置 In-Place 輸入面板所需的兩個主要方法是 [**SetInPlacePosition**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-setinplaceposition) 和 [**SetInPlaceHoverTargetPosition**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-setinplacehovertargetposition)。</span><span class="sxs-lookup"><span data-stu-id="59591-155">The two primary methods necessary for absolutely positioning the In-Place Input Panel are [**SetInPlacePosition**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-setinplaceposition) and [**SetInPlaceHoverTargetPosition**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-setinplacehovertargetposition).</span></span> <span data-ttu-id="59591-156">第一個用來指定 In-Place 輸入面板的位置，而第二個用來指定 In-Place 輸入面板的輸入面板圖示位置。</span><span class="sxs-lookup"><span data-stu-id="59591-156">The first is used to specify the location of the In-Place Input Panel and the second is used to specify the location of the Input Panel Icon for the In-Place Input Panel.</span></span> <span data-ttu-id="59591-157">如果應用程式選擇只設定輸入面板圖示位置，而不是 In-Place 輸入面板的位置，則 In-Place 的輸入面板會顯示在系統所決定的預設位置。</span><span class="sxs-lookup"><span data-stu-id="59591-157">If an application chooses to only set the Input Panel Icon location and not the location of the In-Place Input Panel, then the In-Place Input Panel appears in the default location determined by the system.</span></span> <span data-ttu-id="59591-158">同樣地，如果應用程式重新置放 In-Place 輸入面板，而不是輸入面板圖示，則輸入面板圖示會出現在預設位置。</span><span class="sxs-lookup"><span data-stu-id="59591-158">Similarly if an application repositions the In-Place Input Panel but not the Input Panel Icon, the Input Panel Icon appears in the default location.</span></span> <span data-ttu-id="59591-159">位置是以螢幕座標指定。</span><span class="sxs-lookup"><span data-stu-id="59591-159">Location is specified in screen coordinates.</span></span> <span data-ttu-id="59591-160">實際放置的點是輸入面板圖示或輸入面板的左上角，沒有展開的校正合併數十億。</span><span class="sxs-lookup"><span data-stu-id="59591-160">The actual point being positioned is the upper left corner of the Input Panel Icon or Input Panel with no Correction Comb expanded.</span></span> <span data-ttu-id="59591-161">當更正合併數十億展開時，放置的點不會變更。</span><span class="sxs-lookup"><span data-stu-id="59591-161">When the Correction Comb is expanded, the point being positioned does not change.</span></span> <span data-ttu-id="59591-162"> (請參閱下方的圖 2) In-Place 輸入面板和 In-Place 輸入面板圖示的位置都不會有限制，而呼叫這些方法的應用程式必須負責將它們保留在畫面上。</span><span class="sxs-lookup"><span data-stu-id="59591-162">(See Figure 2 below)There are no restricts on where the In-Place Input Panel and the In-Place Input Panel Icon can be places and it is the responsibility of the applications calling these methods to keep them on the screen.</span></span> <span data-ttu-id="59591-163">這兩種方法都是同步的，表示在方法傳回之前會發生位置。</span><span class="sxs-lookup"><span data-stu-id="59591-163">Both methods are synchronous, meaning positioning occurs before the method returns.</span></span> <span data-ttu-id="59591-164">如果已在浮動或停駐互動模式中開啟輸入面板，嘗試放置 In-Place 輸入面板或 In-Place 輸入面板圖示會失敗。</span><span class="sxs-lookup"><span data-stu-id="59591-164">In the case where Input Panel is already open in the floating or docked interaction mode, an attempt to position the In-Place Input Panel or the In-Place Input Panel Icon fails.</span></span> <span data-ttu-id="59591-165">此外，如果附加至 [**TextInputPanel**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel) 物件的視窗目前沒有焦點，則方法會失敗。</span><span class="sxs-lookup"><span data-stu-id="59591-165">Additionally the methods fail if the window attached to the [**TextInputPanel**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel) object does not currently have focus.</span></span>

<span data-ttu-id="59591-166">對 [**SetInPlacePosition**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-setinplaceposition) 或 [**SetInPlaceHoverTargetPosition**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-setinplacehovertargetposition) 的呼叫不會自動導致 In-Place 輸入面板或輸入面板圖示顯示，它只會在下一次顯示時設定位置。</span><span class="sxs-lookup"><span data-stu-id="59591-166">A call to [**SetInPlacePosition**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-setinplaceposition) or [**SetInPlaceHoverTargetPosition**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-setinplacehovertargetposition) does not automatically cause the In-Place Input Panel or Input Panel Icon to show, it simply sets the position for the next time they are shown.</span></span> <span data-ttu-id="59591-167">呼叫 [**SetInPlaceVisibility**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-setinplacevisibility) 可以用來強制它們立即顯示。</span><span class="sxs-lookup"><span data-stu-id="59591-167">Calling [**SetInPlaceVisibility**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-setinplacevisibility) can be used to force them to show immediately.</span></span>

![就地輸入面板的度量](images/0c67a77a-5d2f-489f-9357-b8a168d024d3.jpg)

<span data-ttu-id="59591-169">在定位 In-Place 輸入面板時，計算是否會關閉畫面可能有點複雜。</span><span class="sxs-lookup"><span data-stu-id="59591-169">When positioning the In-Place Input Panel calculating whether it will go off the screen can be a little tricky.</span></span> <span data-ttu-id="59591-170">為了簡化此程式，您可以使用 [**TextInputPanel**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel) 物件的數個屬性來簡化此程式。</span><span class="sxs-lookup"><span data-stu-id="59591-170">To make this process easier, there are several properties of the [**TextInputPanel**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel) object that can be used to simplify this process.</span></span> <span data-ttu-id="59591-171">這些屬性和事件可以搭配使用，以判斷 In-Place 輸入面板在其所有狀態中的確切大小：</span><span class="sxs-lookup"><span data-stu-id="59591-171">Together these properties and event can be used to determine the exact size of the In-Place Input Panel in all of its states:</span></span>

-   <span data-ttu-id="59591-172">[**InPlaceBoundingRectangle**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_inplaceboundingrectangle)–此屬性會在目前輸入語言的最大輸入區域顯示時，提供 In-Place 輸入面板的周框。</span><span class="sxs-lookup"><span data-stu-id="59591-172">[**InPlaceBoundingRectangle**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_inplaceboundingrectangle)– This property provides the bounding rectangle for the In-Place Input Panel when the largest input area for the current input language is showing.</span></span> <span data-ttu-id="59591-173">如果將書寫板或字元輸入板判斷為最大的輸入區域，則會包含插入按鈕的高度。</span><span class="sxs-lookup"><span data-stu-id="59591-173">If the Writing Pad or Character Pad are determined to the largest input area, then the height of the Insert button is included.</span></span> <span data-ttu-id="59591-174">它不包含修正合併數十億的高度。當 In-Place 的輸入面板自動成長時 [](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpaneleventsink-inplacesizechanging)，  /  就會引發 InPlaceSizeChanging [**InPlaceSizeChanged**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpaneleventsink-inplacesizechanged)事件組，且這個屬性的值會更新為包含額外的寫入區域或書寫線。</span><span class="sxs-lookup"><span data-stu-id="59591-174">It does not include the height of the Correction Comb. When the In-Place Input Panel auto grows, [**InPlaceSizeChanging**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpaneleventsink-inplacesizechanging) / [**InPlaceSizeChanged**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpaneleventsink-inplacesizechanged) event pair is fired and the value of this property is updated to include the additional writing area or writing line.</span></span>
-   <span data-ttu-id="59591-175">[**PopUpCorrectionHeight**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_popupcorrectionheight)–此屬性指定在輸入面板上方時，插入後修正合併數十億的高度。</span><span class="sxs-lookup"><span data-stu-id="59591-175">[**PopUpCorrectionHeight**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_popupcorrectionheight)– This property specifies the height of the Post-Insertion Correction Comb when it is positioned above Input Panel.</span></span> <span data-ttu-id="59591-176">若要取得合併數十億彈出的 [輸入面板] 的完整 In-Place 高度，請將 [**InPlaceBoundingRectangle**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_inplaceboundingrectangle) 的高度新增至 **PopUpCorrectionHeight**。</span><span class="sxs-lookup"><span data-stu-id="59591-176">To get the full height of the In-Place Input Panel with the Post-Insertion Correction Comb popped-up, add the height of the [**InPlaceBoundingRectangle**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_inplaceboundingrectangle) to the **PopUpCorrectionHeight**.</span></span>

<span data-ttu-id="59591-177">以更簡單的方式設定 In-Place 輸入面板和輸入面板圖示的絕對位置，應用程式可以只指定 In-Place 輸入面板是否預設為顯示在文字輸入欄位的上方或下方。</span><span class="sxs-lookup"><span data-stu-id="59591-177">As a simpler alternative to setting the absolute position of the In-Place Input Panel and Input Panel Icon, an application can just specify whether the In-Place Input Panel defaults to appearing above or below a text entry field.</span></span> <span data-ttu-id="59591-178">如此一來，就能夠以更鬆散控制的方式，避免應用程式佈建中的元素重迭。</span><span class="sxs-lookup"><span data-stu-id="59591-178">In this way it is possible to avoid overlapping elements in the application layout in a more loosely controlled manner.</span></span> <span data-ttu-id="59591-179">若要這樣做，應用程式會將 [**PreferredInPlaceDirection**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_preferredinplacedirection) 設定為 **InPlaceDirection \_ 底端** 或 **InPlaceDirection \_ Top**。</span><span class="sxs-lookup"><span data-stu-id="59591-179">To do this the application sets the [**PreferredInPlaceDirection**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_preferredinplacedirection) to **InPlaceDirection\_Bottom** or **InPlaceDirection\_Top**.</span></span> <span data-ttu-id="59591-180">屬性是喜好設定，因為當必要時，In-Place 輸入面板會覆寫應用程式所設定的喜好設定，以便在螢幕上保持輸入面板。</span><span class="sxs-lookup"><span data-stu-id="59591-180">The property is a preference because the In-Place Input Panel overrides the preference set by the application when necessary to keep Input Panel on the screen.</span></span> <span data-ttu-id="59591-181">系統預設值是在可能的情況下將 In-Place 輸入面板放置在文字欄位下方，並在上方放置。</span><span class="sxs-lookup"><span data-stu-id="59591-181">The system default is to position the In-Place Input Panel below a text field when possible and otherwise to position it above.</span></span> <span data-ttu-id="59591-182">將 **PreferredInPlaceDirection** 設定為 **InPlaceDirection 會 \_ 自動** 還原系統預設值。</span><span class="sxs-lookup"><span data-stu-id="59591-182">Setting the **PreferredInPlaceDirection** to **InPlaceDirection\_Auto** restores the system default.</span></span>

<span data-ttu-id="59591-183">[**TextInputPanel**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel)物件的屬性、方法和事件，可讓開發人員對 In-Place 輸入面板進行必要的控制權，以巧妙地在應用程式佈建中放置 In-Place 輸入面板和輸入面板圖示的位置，使其不會中斷配置流程，而在某些情況下可能會顯示整合。</span><span class="sxs-lookup"><span data-stu-id="59591-183">Together the properties, methods and events of the [**TextInputPanel**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel) object give developers the necessary control over the In-Place Input Panel to be able to cleverly position the In-Place Input Panel and Input Panel Icon in an application layout so they do not disrupt the layout flow and in some case may appear integrated.</span></span> <span data-ttu-id="59591-184">這種新的控制層級是 Tablet 應用程式設計的一大勝利。</span><span class="sxs-lookup"><span data-stu-id="59591-184">This new level of control is a big win for Tablet application design.</span></span>

## <a name="access-to-the-three-input-panel-areas-writing-pad-character-pad-and-keyboard"></a><span data-ttu-id="59591-185">存取三個輸入面板區域：書寫板、字元輸入板和鍵盤</span><span class="sxs-lookup"><span data-stu-id="59591-185">Access to the Three Input Panel Areas: Writing Pad, Character Pad and Keyboard</span></span>

<span data-ttu-id="59591-186">輸入面板有三個輸入區域：書寫板、字元輸入板和鍵盤。</span><span class="sxs-lookup"><span data-stu-id="59591-186">Input Panel has three input areas, the Writing Pad, Character Pad, and Keyboard.</span></span> <span data-ttu-id="59591-187">使用 [**TextInputPanel**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel) 物件時，應用程式可以指定輸入面板開啟時顯示給使用者的預設輸入區域。</span><span class="sxs-lookup"><span data-stu-id="59591-187">Using the [**TextInputPanel**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel) object an application can specify the default input area that is shown to the user when Input Panel opens.</span></span> <span data-ttu-id="59591-188">應用程式的主要原因是要將輸入區域與特定欄位的輸入類型配對。</span><span class="sxs-lookup"><span data-stu-id="59591-188">The main reason for an application to do so is to pair the input area with the input type of specific field.</span></span> <span data-ttu-id="59591-189">例如，書寫板最適合用來填滿批註欄位，但在輸入包含數位和字母的產品序號時，鍵盤可能更方便。</span><span class="sxs-lookup"><span data-stu-id="59591-189">For example, the Writing Pad is probably best suited for filling out a comments field, but the Keyboard may be more convenient for entering a product serial number that contains both numbers and letters.</span></span> <span data-ttu-id="59591-190">為了指定預設的輸入區域，應用程式會將 [**DefaultInputArea**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_defaultinputarea) 屬性設定為 [**PanelInputArea**](/windows/win32/api/peninputpanel/ne-peninputpanel-panelinputarea) 列舉所定義之三個輸入區域的其中一個。</span><span class="sxs-lookup"><span data-stu-id="59591-190">In order to specify the default input area an applications sets the [**DefaultInputArea**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_defaultinputarea) property to one of the three input areas as defined by the [**PanelInputArea**](/windows/win32/api/peninputpanel/ne-peninputpanel-panelinputarea) enumeration.</span></span> <span data-ttu-id="59591-191">下圖顯示三個輸入區域。</span><span class="sxs-lookup"><span data-stu-id="59591-191">The following illustration shows the three input areas.</span></span>

![書寫、字元和鍵盤輸入面板](images/3f1e3d03-88b9-478c-b12d-00d341bc8d5c.jpg)

<span data-ttu-id="59591-193">系統預設輸入區域是英文、法文、德文、西班牙文、義大利文、葡萄牙文、荷蘭文和其他所有拉丁輸入語言的書寫板。</span><span class="sxs-lookup"><span data-stu-id="59591-193">The system default input area is the Writing Pad for English, French, German, Spanish, Italian, Portuguese, Dutch and all other Latin input languages.</span></span> <span data-ttu-id="59591-194">針對東亞輸入語言（包括日文、中文和韓文），預設輸入區域是字元輸入區。</span><span class="sxs-lookup"><span data-stu-id="59591-194">For the East Asian input languages, including Japanese, Chinese, and Korean, the default input area is the Character Pad.</span></span> <span data-ttu-id="59591-195">不過，當使用者變更輸入區域時，它會覆寫目前輸入語言的預設輸入區域，並儲存為該輸入語言的新預設值。</span><span class="sxs-lookup"><span data-stu-id="59591-195">However, when the user changes input area it overrides the default input area for the current input language and is stored as the new default for that input language.</span></span> <span data-ttu-id="59591-196">鍵盤是密碼欄位的預設輸入區域，不論輸入語言為何，除非使用者或群組原則已停用密碼安全性。</span><span class="sxs-lookup"><span data-stu-id="59591-196">The Keyboard is the default input area for password fields, regardless of the input language unless password security has been disabled by the user or group policy.</span></span> <span data-ttu-id="59591-197">在所有情況下，除非目前欄位是密碼欄位，或目前輸入語言的手寫辨識器不支援以程式設計方式選取的輸入區域，否則設定預設輸入面板區域會以程式設計方式覆寫系統預設值。</span><span class="sxs-lookup"><span data-stu-id="59591-197">In all cases setting the default input panel area programmatically overrides the system default, unless the current field is a password field or the handwriting recognizer for the current input language does no support the programmatically selected input area.</span></span> <span data-ttu-id="59591-198">將 [**DefaultInputArea**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_defaultinputarea) 屬性設定為 **InPlaceDirection 會 \_ 自動** 還原系統預設設定。</span><span class="sxs-lookup"><span data-stu-id="59591-198">Setting the [**DefaultInputArea**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_defaultinputarea) property to **InPlaceDirection\_Auto** restores the system default settings.</span></span>

<span data-ttu-id="59591-199">無論預設輸入面板區域是否已設定為以程式設計方式設定，使用者都可以選擇在輸入面板開啟後變更目前的輸入面板區域。</span><span class="sxs-lookup"><span data-stu-id="59591-199">Regardless of whether the default input panel area has been set programmatically, or not, the user has the option to change the current input panel area once Input Panel is open.</span></span> <span data-ttu-id="59591-200">在使用者變更目前的輸入區域之後，使用者選取會持續存在，直到輸入面板關閉或使用者再次變更選取專案為止。</span><span class="sxs-lookup"><span data-stu-id="59591-200">After the user has changed the current input area, the user selection persists until Input Panel closes or the user changes the selection again.</span></span> <span data-ttu-id="59591-201">輸入面板關閉並重新開啟之後，以程式設計方式設定預設輸入區域會重新顯示。</span><span class="sxs-lookup"><span data-stu-id="59591-201">After Input Panel closes and reopens, the programmatically set default input area re-shows.</span></span>

<span data-ttu-id="59591-202">由於目前的輸入面板區域可能與預設輸入面板區域不同，因此應用程式可以查詢 [**CurrentInputArea**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_currentinputarea) 屬性，以判斷目前可見的輸入區域。</span><span class="sxs-lookup"><span data-stu-id="59591-202">Since the current input panel area may be different that the default input panel area, an application can query the [**CurrentInputArea**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_currentinputarea) property to determine which input area is currently visible.</span></span> <span data-ttu-id="59591-203">如果沒有顯示 [輸入面板]，目前的輸入區域等於預設的輸入區域。</span><span class="sxs-lookup"><span data-stu-id="59591-203">If Input Panel is not currently visible, the current input area is equal to the default input area.</span></span> <span data-ttu-id="59591-204">**CurrentInputArea** 屬性絕不會等於 **PanelInputArea \_ Auto**。</span><span class="sxs-lookup"><span data-stu-id="59591-204">The **CurrentInputArea** property is never equal to **PanelInputArea\_Auto**.</span></span> <span data-ttu-id="59591-205">如果 [**DefaultInputArea**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_defaultinputarea) 等於 **PanelInputArea \_ Auto**，則 **CurrentInputArea** 等於所顯示的最後一個輸入區域，如果從未顯示輸入面板，則為目前輸入語言的系統預設值。</span><span class="sxs-lookup"><span data-stu-id="59591-205">If the [**DefaultInputArea**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_defaultinputarea) is equal to **PanelInputArea\_Auto**, then the **CurrentInputArea** is equal to the last input area shown or the system default for the current input language if Input Panel has never been shown.</span></span>

<span data-ttu-id="59591-206">在 [**PenInputPanel**](peninputpanel-class.md) 物件和 [**TextInputPanel**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel) 物件的輸入區域支援之間，主要的差異在於，應用程式現在除了書寫板和鍵盤之外，還可以選擇將預設輸入區域設定為字元輸入區。</span><span class="sxs-lookup"><span data-stu-id="59591-206">The primary difference between the input area support found in the [**PenInputPanel**](peninputpanel-class.md) object and that of the [**TextInputPanel**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel) object is the fact that the application now has the option to set the default input area to the Character Pad, in addition to the Writing Pad and Keyboard.</span></span>

<span data-ttu-id="59591-207">使用上述屬性，應用程式可以控制不同欄位中所顯示的輸入面板輸入區域，並將使用者的文字輸入經驗優化。</span><span class="sxs-lookup"><span data-stu-id="59591-207">Using the above properties an application can control the Input Panel input area shown in different fields and optimize the user's text input experience.</span></span> <span data-ttu-id="59591-208">此外，應用程式也可以維持對目前輸入區域的認知，並根據最適合目前使用者工作的輸入區域做出條件式決策。</span><span class="sxs-lookup"><span data-stu-id="59591-208">Additionally, the application can maintain awareness of the current input area and make conditional decisions according to which input area is best suited to the current user task.</span></span>

## <a name="detailed-information-about-input-panels-interaction-mode"></a><span data-ttu-id="59591-209">輸入面板互動模式的詳細資訊</span><span class="sxs-lookup"><span data-stu-id="59591-209">Detailed Information about Input Panel's Interaction Mode</span></span>

<span data-ttu-id="59591-210">為了能夠偵測輸入面板的目前輸入區域，您也可以偵測目前的互動模式：就地、停駐或浮動。</span><span class="sxs-lookup"><span data-stu-id="59591-210">In additional to being able to detect Input Panel's current input area, it is also possible to detect the current interaction mode: In-Place, Docked or Floating.</span></span> <span data-ttu-id="59591-211">應用程式可能必須知道目前的互動模式，才能瞭解使用者如何與應用程式互動，或因為 [**TextInputPanel**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel) 物件的某些方法和屬性只適用于 In-Place 互動模式。</span><span class="sxs-lookup"><span data-stu-id="59591-211">It may be important for the application to know the current interaction mode either to understand how the user is interacting with the application or because some methods and properties of the [**TextInputPanel**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel) object only apply to the In-Place interaction mode.</span></span> <span data-ttu-id="59591-212">例如，在應用程式中，會將現有的使用者介面專案重新排列，然後將 In-Place 輸入面板置於其使用者介面中的空白區域，以確定在進行調整之前，目前的互動模式是就地進行的。</span><span class="sxs-lookup"><span data-stu-id="59591-212">For example in application the reflows existing user interface elements and then positions the In-Place Input Panel over a blank area in its user interfaces should check to make sure the current interaction mode is in-place before making adjustments.</span></span>

![固定、浮動和步調輸入面板模式](images/98c8e96b-99b2-477a-9843-33b1fae7e75b.jpg)

<span data-ttu-id="59591-214">[**TextInputPanel**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel)物件的 [**CurrentInteractionMode**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_currentinteractionmode)屬性會儲存使用者所選擇的目前互動模式。</span><span class="sxs-lookup"><span data-stu-id="59591-214">The [**CurrentInteractionMode**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_currentinteractionmode) property, of the [**TextInputPanel**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel) object, stores the current interaction mode as chosen by the user.</span></span> <span data-ttu-id="59591-215">可能的模式是由 [**InteractionMode**](/windows/win32/api/peninputpanel/ne-peninputpanel-interactionmode) 列舉定義為：</span><span class="sxs-lookup"><span data-stu-id="59591-215">The possible modes are defined by the [**InteractionMode**](/windows/win32/api/peninputpanel/ne-peninputpanel-interactionmode) enumeration as:</span></span>

<span data-ttu-id="59591-216">**InteractionMode \_就地**–在 In-Place 互動模式輸入面板中，會出現在目前具有焦點的文字輸入欄位旁。</span><span class="sxs-lookup"><span data-stu-id="59591-216">**InteractionMode\_InPlace**– In the In-Place interaction mode Input Panel appears next to the text entry field that currently has focus.</span></span> <span data-ttu-id="59591-217">依預設，當插入點放在文字輸入欄位時，會顯示 In-Place 輸入面板] 圖示。</span><span class="sxs-lookup"><span data-stu-id="59591-217">By default, the In-Place Input Panel Icon appears when an insertion point is placed in a text entry field.</span></span> <span data-ttu-id="59591-218">點擊輸入面板圖示會導致輸入面板展開。</span><span class="sxs-lookup"><span data-stu-id="59591-218">Tapping on the Input Panel Icon causes Input Panel to expand.</span></span> <span data-ttu-id="59591-219">只有當插入點位於可編輯的欄位時，才會顯示 In-Place 的輸入面板。</span><span class="sxs-lookup"><span data-stu-id="59591-219">The In-Place Input Panel is only visible when an insertion point is in an editable field.</span></span>

<span data-ttu-id="59591-220">InteractionMode \_ 浮動：浮動互動模式類似于「就地互動」模式，但不會系結至插入點。</span><span class="sxs-lookup"><span data-stu-id="59591-220">InteractionMode\_Floating – The Floating interaction mode is similar to the InPlace interaction mode, except it is not tied to an insertion point.</span></span> <span data-ttu-id="59591-221">浮動輸入面板的開啟方式是在 [輸入面板] 索引標籤上，依預設會出現在螢幕的左邊緣。</span><span class="sxs-lookup"><span data-stu-id="59591-221">The Floating Input Panel is opened by tapping on the Input Panel tab which appears by default on the left edge of the screen.</span></span> <span data-ttu-id="59591-222">[浮動輸入面板] 和 [輸入面板] 索引標籤都可以由使用者拖曳和重新置放。</span><span class="sxs-lookup"><span data-stu-id="59591-222">Both the Floating Input Panel and Input Panel tab can be dragged and repositioned by the user.</span></span> <span data-ttu-id="59591-223">在浮動模式中，輸入面板的位置和控制權會完全留給使用者使用。</span><span class="sxs-lookup"><span data-stu-id="59591-223">In the floating mode positioning and control of Input Panel is left entirely to the user.</span></span>

<span data-ttu-id="59591-224">InteractionMode \_ DockedTop –在 Docked-Top 互動模式輸入面板會顯示在畫面頂端，而使用中桌面會調整大小，因此輸入面板不會與任何其他視窗或 UI 元素重迭。</span><span class="sxs-lookup"><span data-stu-id="59591-224">InteractionMode\_DockedTop – In the Docked-Top interaction mode Input Panel appears at the top of the screen and the active desktop is resized so Input Panel does not overlap with any other windows or UI elements.</span></span> <span data-ttu-id="59591-225">在固定模式輸入面板中，無法拖曳或四處移動。</span><span class="sxs-lookup"><span data-stu-id="59591-225">In the docked mode Input Panel cannot be dragged or moved around.</span></span>

<span data-ttu-id="59591-226">InteractionMode \_ DockedBottom – Docked-Bottom 互動模式與 Docked-Top 模式相同，但輸入面板會顯示在畫面底部。</span><span class="sxs-lookup"><span data-stu-id="59591-226">InteractionMode\_DockedBottom – The Docked-Bottom interaction mode is the same as the Docked-Top mode except Input Panel appears at the bottom of the screen.</span></span>

<span data-ttu-id="59591-227">當輸入面板未顯示時，目前的互動模式是就地的。</span><span class="sxs-lookup"><span data-stu-id="59591-227">When Input Panel is not visible, the current interaction mode is In-Place.</span></span>

<span data-ttu-id="59591-228">發行目前的互動模型是另一種方式， [**TextInputPanel**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel) 物件會提供輸入面板狀態的詳細資訊，而不是任何先前版本中的可用資訊。</span><span class="sxs-lookup"><span data-stu-id="59591-228">Publishing the current interaction model is another way the [**TextInputPanel**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel) object provides more information about the state of Input Panel than has been available in any previous version.</span></span>

## <a name="detailed-information-about-input-panels-correction-mode"></a><span data-ttu-id="59591-229">輸入面板的更正模式的詳細資訊</span><span class="sxs-lookup"><span data-stu-id="59591-229">Detailed Information about Input Panel's Correction Mode</span></span>

<span data-ttu-id="59591-230">[輸入面板] 的最後一個部分是 [**TextInputPanel**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel) 物件提供的詳細資訊，也就是更正模式。</span><span class="sxs-lookup"><span data-stu-id="59591-230">The final aspect of Input Panel that the [**TextInputPanel**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel) object gives you detailed information about and control of is the correction mode.</span></span> <span data-ttu-id="59591-231">瞭解更正模式可協助應用程式判斷輸入面板的目前大小。</span><span class="sxs-lookup"><span data-stu-id="59591-231">Knowing the correction mode helps applications determine the current size of Input Panel.</span></span> <span data-ttu-id="59591-232">控制應用程式中的插入後修正如何展開，是在應用程式中自訂修正體驗的一種方式。</span><span class="sxs-lookup"><span data-stu-id="59591-232">Controlling how the Post-Insertion Correction expands in an application is one way to customize the correction experience in an application.</span></span>

<span data-ttu-id="59591-233">更正合併數十億可以出現的基本模式有兩種：預先插入和插入後。</span><span class="sxs-lookup"><span data-stu-id="59591-233">There are two basic modes the Correction Comb can appear in: Pre-Insertion and the Post-Insertion.</span></span> <span data-ttu-id="59591-234">預先插入更正合併數十億是用來更正文字，然後再將它插入應用程式。</span><span class="sxs-lookup"><span data-stu-id="59591-234">The Pre-Insertion Correction Comb is used to correct text before inserting it into an application.</span></span> <span data-ttu-id="59591-235">它是藉由在書寫板中的基準底下顯示的暫止文字來啟動，以做為使用者筆跡。</span><span class="sxs-lookup"><span data-stu-id="59591-235">It is activated by tapping on the pending text that appear below the baseline in the Writing Pad as the user inks.</span></span> <span data-ttu-id="59591-236">插入後更正合併數十億是用來修正插入應用程式後的文字。</span><span class="sxs-lookup"><span data-stu-id="59591-236">The Post-Insertion Correction Comb is used to correct text after it has been inserted into an application.</span></span> <span data-ttu-id="59591-237">它是藉由將插入點放入或選取先前插入的文字來啟用。</span><span class="sxs-lookup"><span data-stu-id="59591-237">It is activated by placing the insertion point in or selecting text that was previously inserted.</span></span> <span data-ttu-id="59591-238">除了這兩種基本模式之外，也有幾種不同的方式可顯示插入後更正合併數十億。</span><span class="sxs-lookup"><span data-stu-id="59591-238">Beyond the two basic modes, there are several variations on how the Post-Insertion Correction Comb can appear.</span></span> <span data-ttu-id="59591-239">首先，它可以出現在輸入面板的上方或下方，而第二個則可顯示為折迭或展開。</span><span class="sxs-lookup"><span data-stu-id="59591-239">First it can appear either above or below Input Panel and second it can appear collapsed or expanded.</span></span> <span data-ttu-id="59591-240">在折迭狀態中，插入後更正合併數十億只會顯示替代清單。</span><span class="sxs-lookup"><span data-stu-id="59591-240">In the collapsed state the Post-Insertion Correction Comb only shows a list of alternates.</span></span> <span data-ttu-id="59591-241">在展開的狀態中，它同時包含替代項和用來重寫單字的區域。</span><span class="sxs-lookup"><span data-stu-id="59591-241">In the expanded state it includes both the alternates and an area to rewrite the word.</span></span>

![更正合併數十億、前置和後置插入輸入面板](images/6cc627de-fc15-4721-9f6a-7e1517d9e650.jpg)

<span data-ttu-id="59591-243">[**CurrentCorrectionMode**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_currentcorrectionmode)屬性可讓應用程式判斷更正合併數十億的目前設定。這個屬性的可能值如 [**CorrectionMode**](/windows/win32/api/peninputpanel/ne-peninputpanel-correctionmode)列舉所定義： **NotVisible**、 **PreInsertion**、 **PostInsertionCollapsed** 和 **PostInsertionExpanded**。</span><span class="sxs-lookup"><span data-stu-id="59591-243">The [**CurrentCorrectionMode**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_currentcorrectionmode) property allows an application to determine the current configuration of the Correction Comb. The possible values of this property as defined by the [**CorrectionMode**](/windows/win32/api/peninputpanel/ne-peninputpanel-correctionmode) enumerations are: **NotVisible**, **PreInsertion**, **PostInsertionCollapsed**, and **PostInsertionExpanded**.</span></span> <span data-ttu-id="59591-244">若未顯示輸入面板或更正合併數十億，則 **CurrentCorrectionMode** 為 **NotVisible**。</span><span class="sxs-lookup"><span data-stu-id="59591-244">When no Input Panel or Correction Comb is visible, the **CurrentCorrectionMode** is **NotVisible**.</span></span>

<span data-ttu-id="59591-245">根據預設，系統會顯示當您選取可更正的文字，並在插入點放置在可更正的文字中時，所展開的插入後修正合併數十億。</span><span class="sxs-lookup"><span data-stu-id="59591-245">By default the system shows the Post-Insertion Correction Comb expanded when the selects correctable text and shows it collapsed when the insertion point is placed in correctable text.</span></span> <span data-ttu-id="59591-246">應用程式可以將 [**ExpandPostInsertionCorrection**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_expandpostinsertioncorrection) 屬性設定為 **true**，以指定插入後更正合併數十億應該一律顯示的位置。</span><span class="sxs-lookup"><span data-stu-id="59591-246">An application can specify where the Post-Insertion Correction Comb should always show expanded by setting the [**ExpandPostInsertionCorrection**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_expandpostinsertioncorrection) property to **true**.</span></span> <span data-ttu-id="59591-247">系統預設值為 **false**。</span><span class="sxs-lookup"><span data-stu-id="59591-247">The system default is **false**.</span></span> <span data-ttu-id="59591-248">當 **ExpandPostInsertionCorrection** 屬性與 [**IHandWrittenTextInsertion**](/windows/desktop/api/peninputpanel/nn-peninputpanel-ihandwrittentextinsertion) 介面搭配使用時，應用程式開發人員可以低廉價格將更正支援新增至不會自動取得的應用程式。</span><span class="sxs-lookup"><span data-stu-id="59591-248">When the **ExpandPostInsertionCorrection** property is used in conjunction with the [**IHandWrittenTextInsertion**](/windows/desktop/api/peninputpanel/nn-peninputpanel-ihandwrittentextinsertion) interface an application developer can cheaply add correction support to applications that would not get it automatically.</span></span>

<span data-ttu-id="59591-249">追蹤和控制輸入面板的更正狀態是 [**TextInputPanel**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel) 物件的許多新功能之一，可讓輸入面板和應用程式整合更緊密。</span><span class="sxs-lookup"><span data-stu-id="59591-249">Tracking and controlling the correction state of the Input Panel is one of the many new features of the [**TextInputPanel**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel) object that make tighter Input Panel and application integration possible.</span></span>

## <a name="event-notification-before-and-after-the-event-occurs"></a><span data-ttu-id="59591-250">事件發生前後的事件通知</span><span class="sxs-lookup"><span data-stu-id="59591-250">Event Notification Before and After the Event Occurs</span></span>

<span data-ttu-id="59591-251">在 [**TextInputPanel**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel) 物件中大幅改善的輸入面板可程式性的另一個層面是事件模型。</span><span class="sxs-lookup"><span data-stu-id="59591-251">Another aspect of Input Panel programmability that is greatly improved in the [**TextInputPanel**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel) object is the event model.</span></span> <span data-ttu-id="59591-252">現在，在變更發生之前和之後，現在不會引發事件以在輸入面板的狀態變更時發出信號變更。</span><span class="sxs-lookup"><span data-stu-id="59591-252">Now instead of only raising events signaling a change in Input Panel's state after the change has occurred there are separate events sent before and after the change occurs.</span></span> <span data-ttu-id="59591-253">通知事件開始的事件包含目前的時態動詞，例如「變更」或「插入」，而發出事件的事件則會包含過去的時態動詞，例如「已變更」或「插入」。</span><span class="sxs-lookup"><span data-stu-id="59591-253">Events signaling the start of an event contain present tense verbs such as 'Changing' or 'Inserting', while events signaling the conclusion of an event contain past tense verbs such as 'Changed' or 'Inserted'.</span></span>

<span data-ttu-id="59591-254">此事件模型可讓應用程式在發生變更之前或發生變更時對其做出反應。</span><span class="sxs-lookup"><span data-stu-id="59591-254">This event model makes it possible for an application to react to a change before or as it occurs.</span></span> <span data-ttu-id="59591-255">在所有事件的事件處理常式完成之前，輸入面板會遭到封鎖而無法繼續進行變更或繼續進行變更。</span><span class="sxs-lookup"><span data-stu-id="59591-255">Input Panel is blocked from proceeding with a change or resuming after change until the event handlers for all events have completed.</span></span> <span data-ttu-id="59591-256">這些事件是同步的，因此應用程式可能會延遲變更，直到完成回應為止。</span><span class="sxs-lookup"><span data-stu-id="59591-256">These events are synchronous and in this way an application can delay a change until it has finished reacting.</span></span> <span data-ttu-id="59591-257">不過，事件處理常式執行輸入面板的時間會變成無法存取，而且可能會顯示為無回應，因此事件處理常式必須正常執行。</span><span class="sxs-lookup"><span data-stu-id="59591-257">However, the time where an event handler is executing Input Panel becomes inaccessible to the user and may appear hung, therefore it is important that event handler perform well.</span></span> <span data-ttu-id="59591-258">但是，應用程式不可能會阻止或取消事件。</span><span class="sxs-lookup"><span data-stu-id="59591-258">However, it is not possible for an application to prevent or cancel an event.</span></span> <span data-ttu-id="59591-259">所有事件參數都是唯讀的。</span><span class="sxs-lookup"><span data-stu-id="59591-259">All event parameters are read-only.</span></span> <span data-ttu-id="59591-260">以下是 [**TextInputPanel**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel) 物件六個事件配對的描述：</span><span class="sxs-lookup"><span data-stu-id="59591-260">Below is a description of the [**TextInputPanel**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel) object's six event pairs:</span></span>

-   <span data-ttu-id="59591-261">[**InPlaceStateChanging**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpaneleventsink-inplacestatechanging)  / [**InPlaceStateChanged**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpaneleventsink-inplacestatechanged)-就地狀態即將離開或已從暫止切換為展開或相反的通知。</span><span class="sxs-lookup"><span data-stu-id="59591-261">[**InPlaceStateChanging**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpaneleventsink-inplacestatechanging) / [**InPlaceStateChanged**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpaneleventsink-inplacestatechanged)– Notification that the in-place state is about to or has just switched from hover to expanded or vice versa.</span></span> <span data-ttu-id="59591-262">參數是新的和舊的就地狀態。</span><span class="sxs-lookup"><span data-stu-id="59591-262">Parameters are the new and old in-place state.</span></span> <span data-ttu-id="59591-263">巧合，並變更 [**CurrentInPlaceState**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_currentinplacestate) 屬性的值。</span><span class="sxs-lookup"><span data-stu-id="59591-263">Coincidences with a change in the value of the [**CurrentInPlaceState**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_currentinplacestate) property.</span></span>
-   <span data-ttu-id="59591-264">[**InPlaceSizeChanging**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpaneleventsink-inplacesizechanging)  / [**InPlaceSizeChanged**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpaneleventsink-inplacesizechanged)–指出 In-Place 的輸入面板大小即將變更或因使用者調整大小、自動成長或輸入區域變更而變更時。</span><span class="sxs-lookup"><span data-stu-id="59591-264">[**InPlaceSizeChanging**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpaneleventsink-inplacesizechanging) / [**InPlaceSizeChanged**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpaneleventsink-inplacesizechanged)– Indicated when the In-Place Input Panel size is about to change or has changed due to a user resize, auto growth, or an input area change.</span></span> <span data-ttu-id="59591-265">參數是新的和舊的周框。</span><span class="sxs-lookup"><span data-stu-id="59591-265">Parameters are the new and old bounding rectangle.</span></span> <span data-ttu-id="59591-266">巧合，並變更 [**InPlaceBoundingRectangle**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_inplaceboundingrectangle) 屬性的值。</span><span class="sxs-lookup"><span data-stu-id="59591-266">Coincidences with a change in the value of the [**InPlaceBoundingRectangle**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_inplaceboundingrectangle) property.</span></span>
-   <span data-ttu-id="59591-267">[**InputAreaChanging**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpaneleventsink-inputareachanging)  / [**InputAreaChanged**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpaneleventsink-inputareachanged)–當輸入面板輸入區域即將變更或已從三個可能的輸入區域（書寫板、字元輸入區或鍵盤）變更為另一個時報告。</span><span class="sxs-lookup"><span data-stu-id="59591-267">[**InputAreaChanging**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpaneleventsink-inputareachanging) / [**InputAreaChanged**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpaneleventsink-inputareachanged)– Reports when the Input Panel input area is about to change or has changed from to the other of the three possible input areas: Writing Pad, Character Pad or Keyboard.</span></span> <span data-ttu-id="59591-268">參數是新的和舊的輸入區域。</span><span class="sxs-lookup"><span data-stu-id="59591-268">Parameters are the new and old input area.</span></span> <span data-ttu-id="59591-269">[**CurrentInputArea**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_currentinputarea)屬性值的變更一致</span><span class="sxs-lookup"><span data-stu-id="59591-269">Coincides with a change in the value of the [**CurrentInputArea**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_currentinputarea) property</span></span>
-   <span data-ttu-id="59591-270">[**CorrectionModeChanging**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpaneleventsink-correctionmodechanging)  / [**CorrectionModeChanged**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpaneleventsink-correctionmodechanged)–更正模式即將變更或已變更的通知。</span><span class="sxs-lookup"><span data-stu-id="59591-270">[**CorrectionModeChanging**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpaneleventsink-correctionmodechanging) / [**CorrectionModeChanged**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpaneleventsink-correctionmodechanged)– Notification that the correction mode is about to change or has changed.</span></span> <span data-ttu-id="59591-271">可能的更正模式包括：不可見、預先插入、插入後折迭，以及展開後置插入。</span><span class="sxs-lookup"><span data-stu-id="59591-271">Possible correction modes are: not visible, Pre-Insertion, Post-Insertion collapsed, and Post-Insertion expanded.</span></span> <span data-ttu-id="59591-272">參數是新的和舊的更正模式。</span><span class="sxs-lookup"><span data-stu-id="59591-272">Parameters are the new and old correction mode.</span></span> <span data-ttu-id="59591-273">會與 [**CurrentCorrectionMode**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_currentcorrectionmode) 屬性值的變更一致。</span><span class="sxs-lookup"><span data-stu-id="59591-273">Coincides with a change in the value of the [**CurrentCorrectionMode**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpanel-get_currentcorrectionmode) property.</span></span>
-   <span data-ttu-id="59591-274">[**InPlaceVisibilityChanging**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpaneleventsink-inplacevisibilitychanging)  / [**InPlaceVisibilityChanged**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpaneleventsink-inplacevisibilitychanged)–指出 In-Place 的輸入面板可見度即將變更或已變更。</span><span class="sxs-lookup"><span data-stu-id="59591-274">[**InPlaceVisibilityChanging**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpaneleventsink-inplacevisibilitychanging) / [**InPlaceVisibilityChanged**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpaneleventsink-inplacevisibilitychanged)– Indicates when the In-Place Input Panel visibility is about to change or has changed.</span></span> <span data-ttu-id="59591-275">參數是新的和舊的可見度。</span><span class="sxs-lookup"><span data-stu-id="59591-275">Parameters are the new and old visibility.</span></span> <span data-ttu-id="59591-276">**False** 的新可見度表示 In-Place 輸入面板未開啟，但不會阻止在浮動或停駐互動模式中看到輸入面板。</span><span class="sxs-lookup"><span data-stu-id="59591-276">A new visibility of **false** means the In-Place Input Panel is not open, but does not preclude Input Panel being visible in the Floating or Docked interaction mode.</span></span>
-   <span data-ttu-id="59591-277">[**TextInserting**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpaneleventsink-textinserting)  / [**TextInserted**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpaneleventsink-textinserted)–指出文字即將插入或已從輸入面板插入的時間。</span><span class="sxs-lookup"><span data-stu-id="59591-277">[**TextInserting**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpaneleventsink-textinserting) / [**TextInserted**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpaneleventsink-textinserted)– Indicates when text is about to be inserted or has been inserted from Input Panel.</span></span> <span data-ttu-id="59591-278">參數是 [**InkDisp**](inkdisp-class.md) 物件的陣列，每個物件都包含用來組成插入的筆墨行和文字。</span><span class="sxs-lookup"><span data-stu-id="59591-278">Parameter is an array of [**InkDisp**](inkdisp-class.md) objects, each containing a line of the ink and text that make up the insertion.</span></span> <span data-ttu-id="59591-279">下一節會詳細說明此事件。</span><span class="sxs-lookup"><span data-stu-id="59591-279">More on this event in the next section.</span></span>

<span data-ttu-id="59591-280">這些事件會為應用程式提供有關輸入面板中變更的重要資訊，並允許它們適當地回應。</span><span class="sxs-lookup"><span data-stu-id="59591-280">These events provide applications with essential information about changes in Input Panel and allow them to react accordingly.</span></span> <span data-ttu-id="59591-281">同樣地，輸入面板事件模型中的變更代表在應用程式與輸入面板之間進行更佳互動的步驟。</span><span class="sxs-lookup"><span data-stu-id="59591-281">Again the change in the Input Panel event model represents a step toward better interaction between applications and Input Panel.</span></span>

## <a name="support-for-collecting-the-ink-and-text-entered-in-input-panel"></a><span data-ttu-id="59591-282">支援收集輸入面板中輸入的筆墨和文字</span><span class="sxs-lookup"><span data-stu-id="59591-282">Support for Collecting the Ink and Text Entered in Input Panel</span></span>

<span data-ttu-id="59591-283">最後一點是， [**TextInputPanel**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel) 物件中一項非常強大的新功能，就是能夠在文字插入應用程式時，透過輸入面板從輸入面板中取得輸入文字的筆墨物件。</span><span class="sxs-lookup"><span data-stu-id="59591-283">Last but certainly not least, one very powerful new feature of the [**TextInputPanel**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel) object is the ability to get the ink object for text entered via Input Panel out of Input Panel at the time the text is inserted into an application.</span></span> <span data-ttu-id="59591-284">基於變更追蹤和記錄保留的目的，這是經常要求的功能。</span><span class="sxs-lookup"><span data-stu-id="59591-284">This has been an often requested feature for the purpose of change tracking and record keeping.</span></span> <span data-ttu-id="59591-285">它也可讓應用程式以靜態元素或自訂的筆墨介面，在其 UI 中使用筆墨。</span><span class="sxs-lookup"><span data-stu-id="59591-285">It also allows applications to make use of the ink in their UI either as a static element or with a custom inking surface.</span></span>

<span data-ttu-id="59591-286">為了接收透過 [輸入面板] 輸入之文字的 [**InkDisp**](inkdisp-class.md)物件，應用程式必須註冊，才能接收 [**TextInputPanel**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel)物件所產生的 [**TextInserting**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpaneleventsink-textinserting)或 [**TextInserted**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpaneleventsink-textinserted)事件。</span><span class="sxs-lookup"><span data-stu-id="59591-286">In order to receive the [**InkDisp**](inkdisp-class.md) object for text entered via Input Panel, an application must register to receive the [**TextInserting**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpaneleventsink-textinserting) or [**TextInserted**](/windows/desktop/api/peninputpanel/nf-peninputpanel-itextinputpaneleventsink-textinserted) events generated by the [**TextInputPanel**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel) object.</span></span> <span data-ttu-id="59591-287">**TextInserting** 事件會在文字從輸入面板插入應用程式之前立即引發，而且在所有事件處理常式完成之前，不會插入文字。</span><span class="sxs-lookup"><span data-stu-id="59591-287">The **TextInserting** event is fired immediately before text is inserted from Input Panel into an application and the text does not insert until all event handlers complete.</span></span> <span data-ttu-id="59591-288">**TextInserted** 事件會在插入測試之後立即引發。</span><span class="sxs-lookup"><span data-stu-id="59591-288">The **TextInserted** event fires immediately after test is inserted.</span></span> <span data-ttu-id="59591-289">**TextInserting** 和 **TextInserted** 事件的唯一參數是 **InkDisp** 物件的陣列，其中包含從輸入面板插入的每一行文字的一個 **InkDisp** 物件。</span><span class="sxs-lookup"><span data-stu-id="59591-289">The only parameter for both the **TextInserting** and **TextInserted** event is an array of **InkDisp** objects which includes one **InkDisp** object for each line of text inserted from Input Panel.</span></span> <span data-ttu-id="59591-290">注意：當事件處理常式正在執行時，輸入面板處於非使用中狀態，而且可能會對使用者顯示為無回應，因此請務必讓這些事件處理常式變得輕量，並確保它們能快速執行。</span><span class="sxs-lookup"><span data-stu-id="59591-290">Note: Input Panel is inactive while the event handlers are running and may appear hung to the user, therefore it is important to make these event handlers light weight and make sure they execute quickly.</span></span> <span data-ttu-id="59591-291">此外，應用程式不應該建立此事件的處理常式，除非它有特定的資訊用途，因為這樣做會有相關聯的效能成本。</span><span class="sxs-lookup"><span data-stu-id="59591-291">Additionally, an application should not create a handler for this event unless it has a specific use for the information since there is a performance cost associated with doing so.</span></span> <span data-ttu-id="59591-292">輸入面板只會在有應用程式要求資料時封送處理筆墨資料，否則輸入面板可以略過這項昂貴的作業。</span><span class="sxs-lookup"><span data-stu-id="59591-292">Input Panel only marshals the ink data if there is an application requesting the data, otherwise, Input Panel can skip this costly operation.</span></span> <span data-ttu-id="59591-293">**TextInserting** 和 **TextInserted** 事件的參數都是唯讀的，這表示應用程式在插入應用程式之前，不可能變更插入的文字。</span><span class="sxs-lookup"><span data-stu-id="59591-293">The parameters of both the **TextInserting** and **TextInserted** events are read-only, meaning it is not possible for applications to change inserted text before it is inserted into the application.</span></span>

<span data-ttu-id="59591-294">應用程式可以使用這種新功能執行的可能性很廣泛，而且使用起來可能不容易。</span><span class="sxs-lookup"><span data-stu-id="59591-294">The possibilities for what applications can do with this new functionality are broad and it could not be simpler to use.</span></span> <span data-ttu-id="59591-295">允許應用程式收集透過輸入面板所輸入的已辨識文字和筆墨，就是在 Windows Vista 中改善輸入面板開發人員故事的另一種方式。</span><span class="sxs-lookup"><span data-stu-id="59591-295">Allow recognized text and ink entered via Input Panel to be collected by applications is just another way Input Panel's developer story is improved in Windows Vista.</span></span>

## <a name="conclusion"></a><span data-ttu-id="59591-296">結論</span><span class="sxs-lookup"><span data-stu-id="59591-296">Conclusion</span></span>

<span data-ttu-id="59591-297">整體來說，[Tablet PC 輸入面板] 的可程式性案例在 Windows Vista 中引進 [**TextInputPanel**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel) 物件，大幅改善了。</span><span class="sxs-lookup"><span data-stu-id="59591-297">Overall, the programmability story for the Tablet PC Input Panel is greatly improved with the introduction of the [**TextInputPanel**](/windows/desktop/api/peninputpanel/nn-peninputpanel-itextinputpanel) object in Windows Vista.</span></span> <span data-ttu-id="59591-298">藉由使用 **TextInputPanel** 物件，應用程式開發人員可以更充分掌控舊版中狀態輸入面板的控制權和詳細資訊。</span><span class="sxs-lookup"><span data-stu-id="59591-298">By using the **TextInputPanel** object, application developers have greater control and more information about the state Input Panel in previous release.</span></span> <span data-ttu-id="59591-299">因此，強烈建議應用程式開發人員建立新的 Tablet PC 應用程式或更新現有的應用程式，以使用 **TextInputPanel** 物件，而不是現在已被取代的 [**PenInputPanel**](peninputpanel-class.md) 物件。</span><span class="sxs-lookup"><span data-stu-id="59591-299">As a result application developers building new Tablet PC applications or updating existing applications are strongly encouraged to use the **TextInputPanel** object instead of the now deprecated [**PenInputPanel**](peninputpanel-class.md) object.</span></span> <span data-ttu-id="59591-300">此外，支援新功能（例如輸入面板的絕對位置和輸入面板圖示），以及應用程式透過 [輸入面板] 同時接收辨識器文字和筆墨的功能，可啟用新的應用程式功能和案例。</span><span class="sxs-lookup"><span data-stu-id="59591-300">Additionally, support for new features such as absolute positioning of Input Panel and the Input Panel icon, and the ability for application to receive both recognizer text and ink entered via Input Panel enable new application functionality and scenarios.</span></span> <span data-ttu-id="59591-301">包含這些功能和其他幾項功能，可直接回應開發人員的意見反應，並標示將輸入面板與 Tablet PC 應用程式完全整合的第一步。</span><span class="sxs-lookup"><span data-stu-id="59591-301">The inclusion of these features and several others are in direct response to developer feedback and mark the first steps toward full integration of Input Panel with Tablet PC applications.</span></span> <span data-ttu-id="59591-302">最後，擴充 Tablet PC 應用程式功能對應用程式開發人員和 Tablet PC 平臺而言都是一大勝利。</span><span class="sxs-lookup"><span data-stu-id="59591-302">Ultimately, expanding the Tablet PC application functionality is a big win for both application developers and the Tablet PC platform.</span></span>

 

 



