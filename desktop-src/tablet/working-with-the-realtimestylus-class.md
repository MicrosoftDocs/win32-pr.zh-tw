---
description: RealTimeStylus 類別是 StylusInput 應用程式設計介面的一部分， (Api) 。 下列各節說明 RealTimeStylus 類別和 StylusInput Api 的主要元素。
ms.assetid: 6385c387-5b11-4719-a6ec-e0bebe875348
title: 使用 RealTimeStylus 類別
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 919c4de38cb0835996928c877ca4c42faf6a5f96
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/07/2021
ms.locfileid: "103690892"
---
# <a name="working-with-the-realtimestylus-class"></a><span data-ttu-id="2cc36-104">使用 RealTimeStylus 類別</span><span class="sxs-lookup"><span data-stu-id="2cc36-104">Working with the RealTimeStylus Class</span></span>

<span data-ttu-id="2cc36-105">[**RealTimeStylus**](realtimestylus-class.md)類別是 StylusInput 應用程式設計介面的一部分， (api) 。</span><span class="sxs-lookup"><span data-stu-id="2cc36-105">The [**RealTimeStylus**](realtimestylus-class.md) class is part of the StylusInput application programming interfaces (APIs).</span></span> <span data-ttu-id="2cc36-106">下列各節說明 **RealTimeStylus** 類別和 StylusInput api 的主要元素。</span><span class="sxs-lookup"><span data-stu-id="2cc36-106">The following sections describe key elements of the **RealTimeStylus** class and the StylusInput APIs.</span></span>

## <a name="instantiating-the-realtimestylus-class"></a><span data-ttu-id="2cc36-107">具現化 RealTimeStylus 類別</span><span class="sxs-lookup"><span data-stu-id="2cc36-107">Instantiating the RealTimeStylus Class</span></span>

<span data-ttu-id="2cc36-108">當您建立 [**RealTimeStylus**](realtimestylus-class.md) 物件時，可以選擇將它附加至視窗控制碼或控制項。</span><span class="sxs-lookup"><span data-stu-id="2cc36-108">When you create a [**RealTimeStylus**](realtimestylus-class.md) object, you have the option of attaching it to a window handle or to a control.</span></span> <span data-ttu-id="2cc36-109">將 **RealTimeStylus** 物件附加至視窗控制碼需要額外的許可權。</span><span class="sxs-lookup"><span data-stu-id="2cc36-109">Attaching the **RealTimeStylus** object to a window handle requires additional permissions.</span></span> <span data-ttu-id="2cc36-110">如需這些許可權的詳細資訊，請參閱 [StylusInput api 的部分信任考慮](partial-trust-considerations-for-the-stylusinput-apis.md)。</span><span class="sxs-lookup"><span data-stu-id="2cc36-110">For more information about these permissions, see [Partial Trust Considerations for the StylusInput APIs](partial-trust-considerations-for-the-stylusinput-apis.md).</span></span>

> [!Note]  
> <span data-ttu-id="2cc36-111">您無法在不同的進程中將 [**RealTimeStylus**](realtimestylus-class.md) 物件附加至視窗或控制項。</span><span class="sxs-lookup"><span data-stu-id="2cc36-111">You cannot attach the [**RealTimeStylus**](realtimestylus-class.md) object to a window or control in a different process.</span></span>

 

<span data-ttu-id="2cc36-112">如果您使用預設的函式，則會建立只能接受來自另一個 **realtimestylus** 物件之輸入的 [**realtimestylus**](realtimestylus-class.md)物件。</span><span class="sxs-lookup"><span data-stu-id="2cc36-112">If you use the default constructor, you create a [**RealTimeStylus**](realtimestylus-class.md) object that can only accept input from another **RealTimeStylus** object.</span></span> <span data-ttu-id="2cc36-113">如需連接兩個 **realtimestylus** 物件的詳細資訊，請參閱 [串聯的 realtimestylus 模型](the-cascaded-realtimestylus-model.md)。</span><span class="sxs-lookup"><span data-stu-id="2cc36-113">For more information about connecting two **RealTimeStylus** objects, see [The Cascaded RealTimeStylus Model](the-cascaded-realtimestylus-model.md).</span></span>

<span data-ttu-id="2cc36-114">[**RealTimeStylus**](realtimestylus-class.md)物件會實 [IDisposable](/dotnet/api/system.idisposable)介面。</span><span class="sxs-lookup"><span data-stu-id="2cc36-114">The [**RealTimeStylus**](realtimestylus-class.md) object implements the [IDisposable](/dotnet/api/system.idisposable) interface.</span></span>

## <a name="extending-the-realtimestylus-class"></a><span data-ttu-id="2cc36-115">擴充 RealTimeStylus 類別</span><span class="sxs-lookup"><span data-stu-id="2cc36-115">Extending the RealTimeStylus Class</span></span>

<span data-ttu-id="2cc36-116">為了讓您的外掛程式可以從 tablet 畫筆與資料流程互動， [**RealTimeStylus**](realtimestylus-class.md) 物件會維護兩個外掛程式集合，這些集合可由 [**GetStylusSyncPlugin**](/windows/desktop/api/RTSCom/nf-rtscom-irealtimestylus-getstylussyncplugin) 和 c + + 中的 [**GetStylusAsyncPlugin**](/windows/desktop/api/RTSCom/nf-rtscom-irealtimestylus-getstylusasyncplugin) 方法和 managed 程式碼中的 [SyncPluginCollection](/previous-versions/ms824833(v=msdn.10)) 和 [AsyncPluginCollection](/previous-versions/ms824831(v=msdn.10)) 屬性來存取。</span><span class="sxs-lookup"><span data-stu-id="2cc36-116">To allow your plug-ins to interact with the data stream from the tablet pen, the [**RealTimeStylus**](realtimestylus-class.md) object maintains two plug-in collections, which are accessible by the [**GetStylusSyncPlugin**](/windows/desktop/api/RTSCom/nf-rtscom-irealtimestylus-getstylussyncplugin) and the [**GetStylusAsyncPlugin**](/windows/desktop/api/RTSCom/nf-rtscom-irealtimestylus-getstylusasyncplugin) methods in C++ and by the [SyncPluginCollection](/previous-versions/ms824833(v=msdn.10)) and [AsyncPluginCollection](/previous-versions/ms824831(v=msdn.10)) properties in managed code.</span></span> <span data-ttu-id="2cc36-117">您可以在適當的屬性中呼叫集合的 [**AddStylusSyncPlugin**](/windows/desktop/api/RTSCom/nf-rtscom-irealtimestylus-addstylussyncplugin) 或 [**AddStylusAsyncPlugin**](/windows/desktop/api/RTSCom/nf-rtscom-irealtimestylus-addstylusasyncplugin) 方法，以加入外掛程式。</span><span class="sxs-lookup"><span data-stu-id="2cc36-117">You can add a plug-in by calling either the [**AddStylusSyncPlugin**](/windows/desktop/api/RTSCom/nf-rtscom-irealtimestylus-addstylussyncplugin) or the [**AddStylusAsyncPlugin**](/windows/desktop/api/RTSCom/nf-rtscom-irealtimestylus-addstylusasyncplugin) method of the collection within the appropriate property.</span></span> <span data-ttu-id="2cc36-118">如需建立和使用外掛程式的詳細資訊，請參閱 [外掛程式和 RealTimeStylus 類別](plug-ins-and-the-realtimestylus-class.md)。</span><span class="sxs-lookup"><span data-stu-id="2cc36-118">For more information about creating and using plug-ins, see [Plug-ins and the RealTimeStylus Class](plug-ins-and-the-realtimestylus-class.md).</span></span> <span data-ttu-id="2cc36-119">如需決定是否要針對特定工作建立同步或非同步外掛程式的詳細資訊，請參閱 [StylusInput api 的執行緒考慮](threading-considerations-for-the-stylusinput-apis.md) 和 [StylusInput Api 的效能考慮](performance-considerations-for-the-stylusinput-apis.md)。</span><span class="sxs-lookup"><span data-stu-id="2cc36-119">For information about deciding whether to create a synchronous or asynchronous plug-in for a particular task, see [Threading Considerations for the StylusInput APIs](threading-considerations-for-the-stylusinput-apis.md) and [Performance Considerations for the StylusInput APIs](performance-considerations-for-the-stylusinput-apis.md).</span></span>

<span data-ttu-id="2cc36-120">同步外掛程式必須執行 [**IStylusSyncPlugin**](/windows/win32/api/rtscom/nn-rtscom-istylussyncplugin) 介面，而非同步外掛程式必須執行 [**IStylusAsyncPlugin**](/windows/win32/api/rtscom/nn-rtscom-istylusasyncplugin) 介面。</span><span class="sxs-lookup"><span data-stu-id="2cc36-120">Synchronous plug-ins must implement the [**IStylusSyncPlugin**](/windows/win32/api/rtscom/nn-rtscom-istylussyncplugin) interface, and asynchronous plug-ins must implement the [**IStylusAsyncPlugin**](/windows/win32/api/rtscom/nn-rtscom-istylusasyncplugin) interface.</span></span> <span data-ttu-id="2cc36-121">每個外掛程式都有 [**IStylusSyncPlugin. DataInterest**](/windows/desktop/api/RTSCom/nf-rtscom-istylusplugin-datainterest) 或 [**IStylusAsyncPlugin. DataInterest**](/windows/desktop/api/RTSCom/nf-rtscom-istylusplugin-datainterest) 屬性。</span><span class="sxs-lookup"><span data-stu-id="2cc36-121">Each plug-in has a [**IStylusSyncPlugin.DataInterest**](/windows/desktop/api/RTSCom/nf-rtscom-istylusplugin-datainterest) or [**IStylusAsyncPlugin.DataInterest**](/windows/desktop/api/RTSCom/nf-rtscom-istylusplugin-datainterest) property.</span></span> <span data-ttu-id="2cc36-122">[**RealTimeStylus**](realtimestylus-class.md)物件只會針對外掛程式已訂閱的方法，呼叫外掛程式的通知方法。</span><span class="sxs-lookup"><span data-stu-id="2cc36-122">The [**RealTimeStylus**](realtimestylus-class.md) object calls only the notification methods of the plug-in for methods in which the plug-in has subscribed.</span></span> <span data-ttu-id="2cc36-123">如需有關通知方法的詳細資訊，請參閱 [外掛程式資料和 RealTimeStylus 類別](plug-in-data-and-the-realtimestylus-class.md)。</span><span class="sxs-lookup"><span data-stu-id="2cc36-123">For more information about the notification methods, see [Plug-in Data and the RealTimeStylus Class](plug-in-data-and-the-realtimestylus-class.md).</span></span>

<span data-ttu-id="2cc36-124">[**RealTimeStylus**](realtimestylus-class.md)物件會實 [**IStylusAsyncPlugin**](/windows/win32/api/rtscom/nn-rtscom-istylusasyncplugin)介面。</span><span class="sxs-lookup"><span data-stu-id="2cc36-124">The [**RealTimeStylus**](realtimestylus-class.md) object implements the [**IStylusAsyncPlugin**](/windows/win32/api/rtscom/nn-rtscom-istylusasyncplugin) interface.</span></span> <span data-ttu-id="2cc36-125">具現化可接受另一個 **realtimestylus** 物件輸入之 **realtimestylus** 物件的唯一方法是使用預設的函式，並執行串聯的 **RealTimeStylus** 模型。</span><span class="sxs-lookup"><span data-stu-id="2cc36-125">The only way to instantiate a **RealTimeStylus** object that accepts input from another **RealTimeStylus** object is to use the default constructor and implement the cascaded **RealTimeStylus** model.</span></span> <span data-ttu-id="2cc36-126">如需連接兩個 **realtimestylus** 物件的詳細資訊，請參閱 [串聯的 realtimestylus 模型](the-cascaded-realtimestylus-model.md)。</span><span class="sxs-lookup"><span data-stu-id="2cc36-126">For more information about connecting two **RealTimeStylus** objects see [The Cascaded RealTimeStylus Model](the-cascaded-realtimestylus-model.md).</span></span>

<span data-ttu-id="2cc36-127">[**RealTimeStylus**](realtimestylus-class.md)物件具有兩個包含 tablet 畫筆資料的內部佇列、輸入佇列和輸出佇列。</span><span class="sxs-lookup"><span data-stu-id="2cc36-127">The [**RealTimeStylus**](realtimestylus-class.md) object has two internal queues that carry the tablet pen data, the input queue and the output queue.</span></span> <span data-ttu-id="2cc36-128">畫筆資料會轉換成 [StylusInput. PluginData](/previous-versions/ms574862(v=vs.100)) 命名空間中的類別實例。</span><span class="sxs-lookup"><span data-stu-id="2cc36-128">The pen data is converted into instances of the classes in the [Microsoft.StylusInput.PluginData](/previous-versions/ms574862(v=vs.100)) namespace.</span></span> <span data-ttu-id="2cc36-129">下列清單說明 **RealTimeStylus** 物件如何處理 tablet 畫筆資料。</span><span class="sxs-lookup"><span data-stu-id="2cc36-129">The following list describes how the **RealTimeStylus** object handles the tablet pen data.</span></span>

1.  <span data-ttu-id="2cc36-130">[**RealTimeStylus**](realtimestylus-class.md)物件會先在其輸入佇列中，然後從 tablet 畫筆資料流程檢查外掛程式資料物件。</span><span class="sxs-lookup"><span data-stu-id="2cc36-130">The [**RealTimeStylus**](realtimestylus-class.md) object checks for plug-in data objects first on its input queue and then from the tablet pen data stream.</span></span>
2.  <span data-ttu-id="2cc36-131">[**RealTimeStylus**](realtimestylus-class.md)物件會將一個外掛程式資料物件傳送到其同步外掛程式集合中的物件。</span><span class="sxs-lookup"><span data-stu-id="2cc36-131">The [**RealTimeStylus**](realtimestylus-class.md) object sends one plug-in data object to the objects in its synchronous plug-in collection.</span></span> <span data-ttu-id="2cc36-132">每個同步外掛程式都可以將資料新增至輸入或輸出佇列。</span><span class="sxs-lookup"><span data-stu-id="2cc36-132">Each synchronous plug-in can add data to either the input or output queue.</span></span>
3.  <span data-ttu-id="2cc36-133">將外掛程式資料物件傳送到同步外掛程式集合的所有成員之後，外掛程式資料物件就會放置在 [**RealTimeStylus**](realtimestylus-class.md) 物件的輸出佇列中。</span><span class="sxs-lookup"><span data-stu-id="2cc36-133">Once the plug-in data object has been sent to all members of the synchronous plug-in collection, the plug-in data object is placed on the [**RealTimeStylus**](realtimestylus-class.md) object's output queue.</span></span>
4.  <span data-ttu-id="2cc36-134">然後， [**RealTimeStylus**](realtimestylus-class.md) 物件會檢查下一個要處理的外掛程式資料物件。</span><span class="sxs-lookup"><span data-stu-id="2cc36-134">The [**RealTimeStylus**](realtimestylus-class.md) object then checks for the next plug-in data object to process.</span></span>
5.  <span data-ttu-id="2cc36-135">當 [**realtimestylus**](realtimestylus-class.md) 物件的輸出佇列包含資料時， **realtimestylus** 物件會從其輸出佇列將一個外掛程式資料物件傳送到其非同步外掛程式集合中的物件。</span><span class="sxs-lookup"><span data-stu-id="2cc36-135">While the [**RealTimeStylus**](realtimestylus-class.md) object's output queue contains data, the **RealTimeStylus** object sends one plug-in data object from its output queue to the objects in its asynchronous plug-in collection.</span></span> <span data-ttu-id="2cc36-136">每個非同步外掛程式都可以將資料加入至輸入或輸出佇列，但由於非同步外掛程式是在使用者介面上執行 (UI) 執行緒，因此會將資料新增至佇列，而該資料會相對於 **RealTimeStylus** 物件正在處理的目前畫筆資料，而不是與非同步外掛程式所處理的資料相對。</span><span class="sxs-lookup"><span data-stu-id="2cc36-136">Each asynchronous plug-in can add data to either the input or output queue, but since the asynchronous plug-ins run on the user interface (UI) thread, the data is added to the queue in relation to the current pen data the **RealTimeStylus** object is processing, and not in relation to the data that the asynchronous plug-in is processing.</span></span>

<span data-ttu-id="2cc36-137">下圖說明透過 [**RealTimeStylus**](realtimestylus-class.md) 物件和其外掛程式集合進行 tablet 畫筆資料的流程。</span><span class="sxs-lookup"><span data-stu-id="2cc36-137">The following diagram illustrates the flow of tablet pen data through the [**RealTimeStylus**](realtimestylus-class.md) object and its plug-in collections.</span></span>

![顯示 tablet pc 畫筆資料流程的 illustratiom](images/5a698bc9-833b-4b24-9fa2-70be0ca61032.gif)

<span data-ttu-id="2cc36-139">在此圖中，圓形 "A" 和 "B" 代表已新增至 [**RealTimeStylus**](realtimestylus-class.md) 物件輸出佇列且尚未傳送至非同步外掛程式集合的 tablet 畫筆資料。</span><span class="sxs-lookup"><span data-stu-id="2cc36-139">In this diagram the circles lettered "A" and "B" represent tablet pen data that has already been added to the [**RealTimeStylus**](realtimestylus-class.md) object's output queue and that has not yet been sent to the asynchronous plug-in collection.</span></span> <span data-ttu-id="2cc36-140">以字母 "C" 表示 **RealTimeStylus** 物件目前正在處理的 tablet 畫筆資料。</span><span class="sxs-lookup"><span data-stu-id="2cc36-140">The circle lettered "C" represents the tablet pen data that the **RealTimeStylus** object is currently processing.</span></span> <span data-ttu-id="2cc36-141">它會傳送至同步的外掛程式集合，並放在輸出佇列中。</span><span class="sxs-lookup"><span data-stu-id="2cc36-141">It is sent to the synchronous plug-in collection and placed on the output queue.</span></span> <span data-ttu-id="2cc36-142">空的圓形代表在輸出佇列中加入未來 tablet 畫筆資料的位置。</span><span class="sxs-lookup"><span data-stu-id="2cc36-142">The empty circle represents the position in the output queue where future tablet pen data is added.</span></span>

<span data-ttu-id="2cc36-143">如需有關如何將特定資料新增至佇列並加以處理的詳細資訊，請參閱 [外掛程式資料和 RealTimeStylus 類別](plug-in-data-and-the-realtimestylus-class.md)。</span><span class="sxs-lookup"><span data-stu-id="2cc36-143">For more information about how specific data is added to the queue and processed, see [Plug-in Data and the RealTimeStylus Class](plug-in-data-and-the-realtimestylus-class.md).</span></span>

<span data-ttu-id="2cc36-144">以下是在收集筆墨的表單上使用 [**RealTimeStylus**](realtimestylus-class.md) 物件的最基本案例。</span><span class="sxs-lookup"><span data-stu-id="2cc36-144">The following is a minimal scenario for using the [**RealTimeStylus**](realtimestylus-class.md) object on a form that collects ink.</span></span>

1.  <span data-ttu-id="2cc36-145">建立可執行 [**IStylusAsyncPlugin**](/windows/win32/api/rtscom/nn-rtscom-istylusasyncplugin) 介面的表單。</span><span class="sxs-lookup"><span data-stu-id="2cc36-145">Create a form that implements the [**IStylusAsyncPlugin**](/windows/win32/api/rtscom/nn-rtscom-istylusasyncplugin) interface.</span></span>
2.  <span data-ttu-id="2cc36-146">建立附加至表單上控制項的 [**RealTimeStylus**](realtimestylus-class.md) 物件。</span><span class="sxs-lookup"><span data-stu-id="2cc36-146">Create a [**RealTimeStylus**](realtimestylus-class.md) object attached to a control on the form.</span></span>
3.  <span data-ttu-id="2cc36-147">在表單的 [**IStylusAsyncPlugin DataInterest**](/windows/desktop/api/RTSCom/nf-rtscom-istylusplugin-datainterest) 屬性中，設定 StylusDown、封包和 StylusUp 通知的興趣。</span><span class="sxs-lookup"><span data-stu-id="2cc36-147">Set interest in the StylusDown, Packets, and StylusUp notifications in the form's [**IStylusAsyncPlugin.DataInterest**](/windows/desktop/api/RTSCom/nf-rtscom-istylusplugin-datainterest) property.</span></span>
4.  <span data-ttu-id="2cc36-148">在表單的 [**StylusDown**](/windows/desktop/api/RTSCom/nf-rtscom-istylusplugin-stylusdown)、封 [**包**](/windows/desktop/api/RTSCom/nf-rtscom-istylusplugin-packets)和 [**StylusUp**](/windows/desktop/api/RTSCom/nf-rtscom-istylusplugin-stylusup) 方法中，新增程式碼以處理從表單之 [**RealTimeStylus**](realtimestylus-class.md) 物件傳送的手寫筆向下、封包和手寫筆的通知。</span><span class="sxs-lookup"><span data-stu-id="2cc36-148">In the form's [**StylusDown**](/windows/desktop/api/RTSCom/nf-rtscom-istylusplugin-stylusdown), [**Packets**](/windows/desktop/api/RTSCom/nf-rtscom-istylusplugin-packets), and [**StylusUp**](/windows/desktop/api/RTSCom/nf-rtscom-istylusplugin-stylusup) methods, add code to handle the stylus down, packets, and stylus up notifications that are sent from the form's [**RealTimeStylus**](realtimestylus-class.md) object.</span></span>

<span data-ttu-id="2cc36-149">如需這類應用程式的範例，請參閱 [RealTimeStylus 筆墨集合範例](realtimestylus-ink-collection-sample.md)。</span><span class="sxs-lookup"><span data-stu-id="2cc36-149">For a sample of such an application, see the [RealTimeStylus Ink Collection Sample](realtimestylus-ink-collection-sample.md).</span></span>

## <a name="working-with-tablet-objects"></a><span data-ttu-id="2cc36-150">使用平板電腦物件</span><span class="sxs-lookup"><span data-stu-id="2cc36-150">Working with Tablet Objects</span></span>

<span data-ttu-id="2cc36-151">每個啟用的 [**RealTimeStylus**](realtimestylus-class.md) 物件都會維護可與其互動之 [**Tablet**](/windows/desktop/api/msinkaut/nn-msinkaut-iinktablet) 物件的唯一識別碼清單。</span><span class="sxs-lookup"><span data-stu-id="2cc36-151">Each enabled [**RealTimeStylus**](realtimestylus-class.md) object maintains a list of unique identifiers for the [**Tablet**](/windows/desktop/api/msinkaut/nn-msinkaut-iinktablet) objects it can interact with.</span></span> <span data-ttu-id="2cc36-152">**RealTimeStylus** 物件會公開兩種方法來轉譯唯一識別碼和 **平板** 電腦物件： [**GetTabletCoNtextIdFromTablet**](/windows/desktop/api/RTSCom/nf-rtscom-irealtimestylus-gettabletcontextidfromtablet)和 [**GetTabletFromTabletCoNtextId**](/windows/desktop/api/RTSCom/nf-rtscom-irealtimestylus-gettabletfromtabletcontextid)方法。</span><span class="sxs-lookup"><span data-stu-id="2cc36-152">The **RealTimeStylus** object exposes two methods for translating between the unique identifier and the **Tablet** object: the [**GetTabletContextIdFromTablet**](/windows/desktop/api/RTSCom/nf-rtscom-irealtimestylus-gettabletcontextidfromtablet) and [**GetTabletFromTabletContextId**](/windows/desktop/api/RTSCom/nf-rtscom-irealtimestylus-gettabletfromtabletcontextid) methods.</span></span>

<span data-ttu-id="2cc36-153">Managed 程式碼中的 [TabletPropertyDescription](/previous-versions/ms827769(v=msdn.10)) 物件 () 包含 [PacketPropertyId](/previous-versions/ms827780(v=msdn.10)) 屬性和 [TabletPropertyMetrics](/previous-versions/ms827781(v=msdn.10)) 結構，可描述特定 [**平板**](/windows/desktop/api/msinkaut/nn-msinkaut-iinktablet) 電腦物件之屬性的範圍、解析度和單位。</span><span class="sxs-lookup"><span data-stu-id="2cc36-153">The [TabletPropertyDescription](/previous-versions/ms827769(v=msdn.10)) object (in managed code) contains a [PacketPropertyId](/previous-versions/ms827780(v=msdn.10)) property and a [TabletPropertyMetrics](/previous-versions/ms827781(v=msdn.10)) structure that describes the range, resolution, and units of the property for a specific [**Tablet**](/windows/desktop/api/msinkaut/nn-msinkaut-iinktablet) object.</span></span> <span data-ttu-id="2cc36-154">[**Realtimestylus**](realtimestylus-class.md)物件的 [**GetDesiredPacketDescription**](/windows/desktop/api/RTSCom/nf-rtscom-irealtimestylus-getdesiredpacketdescription)方法會傳回全域唯一識別碼的陣列 (Guid) 適用于 **RealTimeStylus** 物件在有這些封包屬性時轉送到其外掛程式的封包屬性。</span><span class="sxs-lookup"><span data-stu-id="2cc36-154">The [**RealTimeStylus**](realtimestylus-class.md) object's [**GetDesiredPacketDescription**](/windows/desktop/api/RTSCom/nf-rtscom-irealtimestylus-getdesiredpacketdescription) method returns an array of globally unique identifiers (GUIDs) for the packet properties that the **RealTimeStylus** object forwards to its plug-ins when those packet properties are available.</span></span> <span data-ttu-id="2cc36-155">若要修改 **realtimestylus** 物件傳遞給其外掛程式的封包屬性集合，請呼叫 **Realtimestylus** 物件的 [**SetDesiredPacketDescription**](/windows/desktop/api/RTSCom/nf-rtscom-irealtimestylus-setdesiredpacketdescription) 方法。</span><span class="sxs-lookup"><span data-stu-id="2cc36-155">To modify the set of packet properties the **RealTimeStylus** object passes to its plug-ins, call the **RealTimeStylus** object's [**SetDesiredPacketDescription**](/windows/desktop/api/RTSCom/nf-rtscom-irealtimestylus-setdesiredpacketdescription) method.</span></span> <span data-ttu-id="2cc36-156">**RealTimeStylus** 物件的 managed 程式碼) 中 (的 [GetTabletPropertyDescriptionCollection](/previous-versions/ms825935(v=msdn.10))方法會接受唯一的平板電腦識別碼，並傳回 [TabletPropertyDescription](/previous-versions/ms827760(v=msdn.10))物件的集合。</span><span class="sxs-lookup"><span data-stu-id="2cc36-156">The [GetTabletPropertyDescriptionCollection](/previous-versions/ms825935(v=msdn.10)) method (in managed code) of the **RealTimeStylus** object takes a unique tablet identifier and returns a collection of [TabletPropertyDescription](/previous-versions/ms827760(v=msdn.10)) objects.</span></span> <span data-ttu-id="2cc36-157">這些封包屬性代表 **GetDesiredPacketDescription** 方法所傳回的 tablet 所支援的屬性子集。</span><span class="sxs-lookup"><span data-stu-id="2cc36-157">These packet properties represent the subset of properties supported by the tablet that are returned by the **GetDesiredPacketDescription** method.</span></span>

<span data-ttu-id="2cc36-158">如需標準的封包屬性 Guid 清單，請參閱 [PacketPropertyGuids 常數](packetpropertyguids-constants.md) 類別。</span><span class="sxs-lookup"><span data-stu-id="2cc36-158">For a list of the standard packet property GUIDs, see the [PacketPropertyGuids Constants](packetpropertyguids-constants.md) class.</span></span>

## <a name="special-considerations"></a><span data-ttu-id="2cc36-159">特殊考慮</span><span class="sxs-lookup"><span data-stu-id="2cc36-159">Special Considerations</span></span>

<span data-ttu-id="2cc36-160">下列清單描述搭配 [**Tablet**](/windows/desktop/api/msinkaut/nn-msinkaut-iinktablet)物件使用 [**RealTimeStylus**](realtimestylus-class.md)物件時，要考慮的其他重點。</span><span class="sxs-lookup"><span data-stu-id="2cc36-160">The following list describes other points to take into consideration when using the [**RealTimeStylus**](realtimestylus-class.md) object with a [**Tablet**](/windows/desktop/api/msinkaut/nn-msinkaut-iinktablet) object.</span></span>

-   <span data-ttu-id="2cc36-161">只有當 [**Tablet**](/windows/desktop/api/msinkaut/nn-msinkaut-iinktablet)物件停用時，才能呼叫 [**SetDesiredPacketDescription**](/windows/desktop/api/RTSCom/nf-rtscom-irealtimestylus-setdesiredpacketdescription)方法。</span><span class="sxs-lookup"><span data-stu-id="2cc36-161">The [**SetDesiredPacketDescription**](/windows/desktop/api/RTSCom/nf-rtscom-irealtimestylus-setdesiredpacketdescription) method can only be called while the [**Tablet**](/windows/desktop/api/msinkaut/nn-msinkaut-iinktablet) object is disabled.</span></span> <span data-ttu-id="2cc36-162">[**RealTimeStylus**](realtimestylus-class.md)物件可修改所需的封包屬性清單;因此，呼叫 **SetDesiredPacketDescription** 方法之後，請呼叫 [**GetDesiredPacketDescription**](/windows/desktop/api/RTSCom/nf-rtscom-irealtimestylus-getdesiredpacketdescription)方法來判斷 **RealTimeStylus** 物件可以轉寄至其外掛程式的封包屬性。只保證平板電腦支援 [PacketProperty](packetproperty-guids.md)的 **X**、 **Y** 和 **PacketStatus** 值。</span><span class="sxs-lookup"><span data-stu-id="2cc36-162">The [**RealTimeStylus**](realtimestylus-class.md) object may modify the list of desired packet properties; therefore, call the [**GetDesiredPacketDescription**](/windows/desktop/api/RTSCom/nf-rtscom-irealtimestylus-getdesiredpacketdescription) method after the call to the **SetDesiredPacketDescription** method to determine which packet properties the **RealTimeStylus** object can forward to its plug-ins. A tablet is only guaranteed to support the **X**, **Y**, and **PacketStatus** values for the [PacketProperty](packetproperty-guids.md).</span></span> <span data-ttu-id="2cc36-163">因此，您的外掛程式設計可能需要考慮接收的封包屬性數少於預期。</span><span class="sxs-lookup"><span data-stu-id="2cc36-163">Therefore, your plug-in design may need to account for receiving fewer packet properties than desired.</span></span>
-   <span data-ttu-id="2cc36-164">Managed 程式碼) 的 [GetTabletPropertyDescriptionCollection](/previous-versions/ms825935(v=msdn.10)) 方法 (只能在啟用 [**RealTimeStylus**](realtimestylus-class.md) 物件時呼叫。</span><span class="sxs-lookup"><span data-stu-id="2cc36-164">The [GetTabletPropertyDescriptionCollection](/previous-versions/ms825935(v=msdn.10)) method (for managed code) can only be called while the [**RealTimeStylus**](realtimestylus-class.md) object is enabled.</span></span> <span data-ttu-id="2cc36-165">因為在停用 **RealTimeStylus** 物件之後，可以將通知傳送至非同步外掛程式，所以您可能需要快取每個 [**Tablet**](/windows/desktop/api/msinkaut/nn-msinkaut-iinktablet) 物件的資訊。</span><span class="sxs-lookup"><span data-stu-id="2cc36-165">Because notification can be sent to the async plug-ins after the **RealTimeStylus** object has been disabled, you may need to cache the information for each [**Tablet**](/windows/desktop/api/msinkaut/nn-msinkaut-iinktablet) object.</span></span> <span data-ttu-id="2cc36-166">GetTabletPropertyDescriptionCollection 方法會傳回指定的平板電腦所支援之所需的封包屬性清單。</span><span class="sxs-lookup"><span data-stu-id="2cc36-166">The GetTabletPropertyDescriptionCollection method returns a list of the desired packet properties that are supported by the specified tablet.</span></span>
-   <span data-ttu-id="2cc36-167">啟用 [**RealTimeStylus**](realtimestylus-class.md) 物件之後，每個外掛程式都會收到其 [**RealTimeStylusEnabled**](/windows/desktop/api/RTSCom/nf-rtscom-istylusplugin-realtimestylusenabled) 方法的呼叫。</span><span class="sxs-lookup"><span data-stu-id="2cc36-167">When the [**RealTimeStylus**](realtimestylus-class.md) object is enabled, each plug-in receives a call to its [**RealTimeStylusEnabled**](/windows/desktop/api/RTSCom/nf-rtscom-istylusplugin-realtimestylusenabled) method.</span></span> <span data-ttu-id="2cc36-168">在通知中傳遞的 [RealTimeStylusEnabledData](/previous-versions/ms824229(v=msdn.10)) 物件，會在啟用 **RealTimeStylus** 物件時，包含可用的平板電腦內容識別碼的集合。</span><span class="sxs-lookup"><span data-stu-id="2cc36-168">The [RealTimeStylusEnabledData](/previous-versions/ms824229(v=msdn.10)) object passed in the notification contains a collection of the context identifiers for the available tablets at the time the **RealTimeStylus** object is enabled.</span></span>
-   <span data-ttu-id="2cc36-169">當您在啟用 **realtimestylus** 物件時，將 [**realtimestylus**](realtimestylus-class.md)物件可使用的平板電腦加入或移除 Tablet PC 時， **realtimestylus** 物件會通知其外掛程式已新增或移除 [**tablet**](/windows/desktop/api/msinkaut/nn-msinkaut-iinktablet)物件。</span><span class="sxs-lookup"><span data-stu-id="2cc36-169">When a tablet that the [**RealTimeStylus**](realtimestylus-class.md) object can use is added to or removed from the Tablet PC while the **RealTimeStylus** object is enabled, the **RealTimeStylus** object notifies its plug-ins that a [**Tablet**](/windows/desktop/api/msinkaut/nn-msinkaut-iinktablet) object has been added or removed.</span></span> <span data-ttu-id="2cc36-170">如需詳細資訊，請參閱 [外掛程式資料和 RealTimeStylus 類別](plug-in-data-and-the-realtimestylus-class.md)。</span><span class="sxs-lookup"><span data-stu-id="2cc36-170">For more information, see [Plug-in Data and the RealTimeStylus Class](plug-in-data-and-the-realtimestylus-class.md).</span></span>

## <a name="working-with-tablet-pens"></a><span data-ttu-id="2cc36-171">使用 Tablet 畫筆</span><span class="sxs-lookup"><span data-stu-id="2cc36-171">Working with Tablet Pens</span></span>

<span data-ttu-id="2cc36-172">在許多通知方法中， [**RealTimeStylus**](realtimestylus-class.md) 物件會將 tablet 畫筆的相關資訊傳遞到其外掛程式。</span><span class="sxs-lookup"><span data-stu-id="2cc36-172">The [**RealTimeStylus**](realtimestylus-class.md) object passes information about the tablet pen to its plug-ins in a number of the notification methods.</span></span> <span data-ttu-id="2cc36-173">Tablet 畫筆的相關資訊會由 [手寫筆](/previous-versions/ms824824(v=msdn.10)) 物件（透過 [**GetStyluses**](/windows/desktop/api/RTSCom/nf-rtscom-irealtimestylus-getstyluses) 方法取得）來表示。</span><span class="sxs-lookup"><span data-stu-id="2cc36-173">Information about the tablet pen is represented by a [Stylus](/previous-versions/ms824824(v=msdn.10)) object, gotten through the [**GetStyluses**](/windows/desktop/api/RTSCom/nf-rtscom-irealtimestylus-getstyluses) method.</span></span> <span data-ttu-id="2cc36-174">此物件是資料收集時的 tablet 畫筆標記法。</span><span class="sxs-lookup"><span data-stu-id="2cc36-174">This object is a representation of the tablet pen at the time the data was gathered.</span></span> <span data-ttu-id="2cc36-175">由於外掛程式會接收 tablet 畫筆資料作為 tablet 畫筆資料流程的一部分，因此外掛程式應使用手寫筆物件中的資訊，而不是透過 [**Cursor**](/windows/desktop/api/msinkaut/nn-msinkaut-iinkcursor) 類別檢查特定 tablet 畫筆的目前狀態。</span><span class="sxs-lookup"><span data-stu-id="2cc36-175">Because plug-ins receive the tablet pen data as part of the tablet pen data stream, the plug-ins should use the information in the Stylus object instead of checking for the current state of a particular tablet pen through the [**Cursor**](/windows/desktop/api/msinkaut/nn-msinkaut-iinkcursor) class.</span></span> <span data-ttu-id="2cc36-176">如需 tablet 畫筆和 tablet 畫筆按鈕資料如何傳遞至外掛程式的詳細資訊，請參閱 [外掛程式資料和 RealTimeStylus 類別](plug-in-data-and-the-realtimestylus-class.md)。</span><span class="sxs-lookup"><span data-stu-id="2cc36-176">For information about how tablet pen and tablet pen button data is passed to plug-ins, see [Plug-in Data and the RealTimeStylus Class](plug-in-data-and-the-realtimestylus-class.md).</span></span>

<span data-ttu-id="2cc36-177">若要取得 [**realtimestylus**](realtimestylus-class.md)物件自上一次啟用以來遇到的 [手寫筆](/previous-versions/ms824824(v=msdn.10))物件陣列，請使用 **realtimestylus** 物件的 [**GetStyluses**](/windows/desktop/api/RTSCom/nf-rtscom-irealtimestylus-getstyluses)方法。</span><span class="sxs-lookup"><span data-stu-id="2cc36-177">To get an array of the [Stylus](/previous-versions/ms824824(v=msdn.10)) objects that the [**RealTimeStylus**](realtimestylus-class.md) object has encountered since it was last enabled, use the **RealTimeStylus** object's [**GetStyluses**](/windows/desktop/api/RTSCom/nf-rtscom-irealtimestylus-getstyluses) method.</span></span>

## <a name="related-topics"></a><span data-ttu-id="2cc36-178">相關主題</span><span class="sxs-lookup"><span data-stu-id="2cc36-178">Related topics</span></span>

<dl> <dt>

<span data-ttu-id="2cc36-179">[Microsoft Ink 平板電腦](/previous-versions/ms827783(v=msdn.10))</span><span class="sxs-lookup"><span data-stu-id="2cc36-179">[Microsoft.Ink.Tablet](/previous-versions/ms827783(v=msdn.10))</span></span>
</dt> <dt>

<span data-ttu-id="2cc36-180">[StylusInput](/previous-versions/ms585724(v=vs.100))</span><span class="sxs-lookup"><span data-stu-id="2cc36-180">[Microsoft.StylusInput.RealTimeStylus](/previous-versions/ms585724(v=vs.100))</span></span>
</dt> <dt>

[<span data-ttu-id="2cc36-181">串聯的 RealTimeStylus 模型</span><span class="sxs-lookup"><span data-stu-id="2cc36-181">The Cascaded RealTimeStylus Model</span></span>](the-cascaded-realtimestylus-model.md)
</dt> <dt>

[<span data-ttu-id="2cc36-182">StylusInput Api 的部分信任考慮</span><span class="sxs-lookup"><span data-stu-id="2cc36-182">Partial Trust Considerations for the StylusInput APIs</span></span>](partial-trust-considerations-for-the-stylusinput-apis.md)
</dt> <dt>

[<span data-ttu-id="2cc36-183">外掛程式資料和 RealTimeStylus 類別</span><span class="sxs-lookup"><span data-stu-id="2cc36-183">Plug-in Data and the RealTimeStylus Class</span></span>](plug-in-data-and-the-realtimestylus-class.md)
</dt> <dt>

[<span data-ttu-id="2cc36-184">StylusInput Api 的執行緒考慮</span><span class="sxs-lookup"><span data-stu-id="2cc36-184">Threading Considerations for the StylusInput APIs</span></span>](threading-considerations-for-the-stylusinput-apis.md)
</dt> </dl>

 

 
