---
description: 您通常會想要複製一組更複雜的資訊，而不是可 (ISF) 的筆墨序列化格式。
ms.assetid: 1cef7f91-118c-4a16-802d-bd2ec5d15416
title: 以 HTML 儲存筆墨
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 8372e6e77ea0284bc44fa70883964e53b3063bab
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/08/2021
ms.locfileid: "106990360"
---
# <a name="storing-ink-in-html"></a><span data-ttu-id="c089c-103">以 HTML 儲存筆墨</span><span class="sxs-lookup"><span data-stu-id="c089c-103">Storing Ink in HTML</span></span>

<span data-ttu-id="c089c-104">您通常會想要複製一組更複雜的資訊，而不是可 (ISF) 的筆墨序列化格式。</span><span class="sxs-lookup"><span data-stu-id="c089c-104">It is usually desirable to copy a more complicated set of information than can be contained in ink serialized format (ISF).</span></span> <span data-ttu-id="c089c-105">HTML 特別適用于互通性格式，因為它會以業界標準的形式接受，以及其代表異類內容的能力。</span><span class="sxs-lookup"><span data-stu-id="c089c-105">HTML is especially useful as an interoperability format because of its strong acceptance as an industry standard and its ability to represent heterogeneous content.</span></span>

<span data-ttu-id="c089c-106">HTML 已廣泛理解、妥善記載，並熟悉許多開發人員。</span><span class="sxs-lookup"><span data-stu-id="c089c-106">HTML is widely understood, well documented, and familiar to many developers.</span></span> <span data-ttu-id="c089c-107">有許多適用于 HTML 生產的工具。</span><span class="sxs-lookup"><span data-stu-id="c089c-107">There are many tools for HTML production.</span></span> <span data-ttu-id="c089c-108">此外，Microsoft Windows 還包含應用程式設計介面， (Api) ，以轉譯和操作 HTML。</span><span class="sxs-lookup"><span data-stu-id="c089c-108">In addition, Microsoft Windows contains application programming interfaces (APIs) for rendering and manipulation of HTML.</span></span> <span data-ttu-id="c089c-109">最後，Tablet PC 平臺 Api 提供嚴加防禦 GIF 持續性格式，適用于以其他格式內嵌，最重要的是 HTML。</span><span class="sxs-lookup"><span data-stu-id="c089c-109">Finally, the Tablet PC Platform APIs provide the fortified GIF persistence format, which is suitable for embedding in other formats, most importantly HTML.</span></span> <span data-ttu-id="c089c-110">此格式是由 GIF 檔案所組成，其中包含內嵌在應用程式延伸模組區塊中筆跡序列化格式 (ISF) 。</span><span class="sxs-lookup"><span data-stu-id="c089c-110">This format consists of a GIF file with Ink Serialized Format (ISF) embedded in an application extension block.</span></span>

<span data-ttu-id="c089c-111">這些 GIF 檔是筆墨物件的標記法：</span><span class="sxs-lookup"><span data-stu-id="c089c-111">These GIF files are representations of ink objects that:</span></span>

-   <span data-ttu-id="c089c-112">在未啟用筆墨的應用程式中轉譯，例如瀏覽器或舊版字處理器。</span><span class="sxs-lookup"><span data-stu-id="c089c-112">Render in applications that are not ink-enabled, such as browsers or legacy word processors.</span></span>
-   <span data-ttu-id="c089c-113">包含原始筆跡中的所有必要資訊，而這些資訊是為了進行編輯或辨識等用途而想要維護的。</span><span class="sxs-lookup"><span data-stu-id="c089c-113">Contain all the necessary information from the original ink that one would want to maintain for purposes such as editing or recognition.</span></span>

<span data-ttu-id="c089c-114">這些 GIF 檔案可以使用 Tablet PC 平臺 Api 的持續性方法來產生。</span><span class="sxs-lookup"><span data-stu-id="c089c-114">These GIF files can be produced by using the persistence methods of the Tablet PC Platform APIs.</span></span> <span data-ttu-id="c089c-115">它們是 Gif，而且應該使用 GIF 擴充功能，而如果應用程式不是啟用筆墨，就不會有任何不同的標準 GIF。</span><span class="sxs-lookup"><span data-stu-id="c089c-115">They are GIFs and should use the GIF extension and, to an application that is not ink-enabled, there is nothing different about them from a normal GIF.</span></span> <span data-ttu-id="c089c-116">不過，對啟用筆墨的應用程式來說，有一組豐富的資料基礎是影像。</span><span class="sxs-lookup"><span data-stu-id="c089c-116">To an ink-enabled application, however, there is a rich set of data underlying the image.</span></span>

<span data-ttu-id="c089c-117">在 Tablet PC 平臺 Api 產生之後，HTML 中的 IMG 標記會參考嚴加防禦 GIF。</span><span class="sxs-lookup"><span data-stu-id="c089c-117">After it is produced by the Tablet PC Platform APIs, a fortified GIF is referenced by an IMG tag in HTML.</span></span> <span data-ttu-id="c089c-118">然後 HTML 會儲存在標準 CF HTML 剪貼簿位置中 \_ 。</span><span class="sxs-lookup"><span data-stu-id="c089c-118">The HTML is then stored in the standard CF\_HTML Clipboard slot.</span></span> <span data-ttu-id="c089c-119">這可讓其他應用程式看到 HTML，不論它們是否為啟用筆墨。</span><span class="sxs-lookup"><span data-stu-id="c089c-119">This allows the HTML to be visible to other applications, whether they are ink-enabled.</span></span> <span data-ttu-id="c089c-120">映射本身可以儲存在 Windows 網際網路快取中，並設定為在適當的一段時間後到期。</span><span class="sxs-lookup"><span data-stu-id="c089c-120">The image itself can be stored in the Windows Internet cache and set to age out after an appropriate amount of time.</span></span>

<span data-ttu-id="c089c-121">提供或要求 IMG 標記的特定裝飾。</span><span class="sxs-lookup"><span data-stu-id="c089c-121">Specific adornments to the IMG tag are provided or required.</span></span> <span data-ttu-id="c089c-122">這些裝飾會將 HTML 識別為包含筆墨。</span><span class="sxs-lookup"><span data-stu-id="c089c-122">These adornments identify the HTML as containing ink.</span></span> <span data-ttu-id="c089c-123">下列範例會使用 HTML 標籤來參考嚴加防禦 GIF：</span><span class="sxs-lookup"><span data-stu-id="c089c-123">The following example refers to a fortified GIF by using HTML tags:</span></span>

`<img href="34372423432.gif" />`

<span data-ttu-id="c089c-124">如果需要以其他方式（例如級聯樣式表或 Vector Markup Language (VML) ）參考影像，則應該仍會有參考影像的 IMG 標記。</span><span class="sxs-lookup"><span data-stu-id="c089c-124">If it is necessary to refer to the image by some other means, such as cascading style sheets or Vector Markup Language (VML), there should still be an IMG tag referencing the image.</span></span> <span data-ttu-id="c089c-125">這可讓您在接受 HTML 表示筆墨的任何應用程式中進行剪下和貼上。</span><span class="sxs-lookup"><span data-stu-id="c089c-125">This allows cutting and pasting into and out of any application that accepts HTML representations of ink.</span></span>

<span data-ttu-id="c089c-126">以 HTML 支援筆墨的應用程式應該：</span><span class="sxs-lookup"><span data-stu-id="c089c-126">Applications that support ink in HTML should:</span></span>

-   <span data-ttu-id="c089c-127">\_當使用者執行複製時產生 CF HTML。</span><span class="sxs-lookup"><span data-stu-id="c089c-127">Generate CF\_HTML when the user executes a copy.</span></span> <span data-ttu-id="c089c-128">在 \_ 複製 (上產生 CF HTML 或另存為 HTML) 時， [](/previous-versions/dotnet/netframework-3.5/ms571335(v=vs.90))請使用 PersistenceFormat 值，在 *p* 參數中指定 [](/previous-versions/ms827245(v=msdn.10))值，以產生嚴加防禦 GIF 影像。</span><span class="sxs-lookup"><span data-stu-id="c089c-128">When generating CF\_HTML on copy (or save as HTML), use the [Microsoft.Ink.Ink.Save](/previous-versions/dotnet/netframework-3.5/ms571335(v=vs.90)) method, specifying the [Microsoft.Ink.PersistenceFormat](/previous-versions/ms827245(v=msdn.10)) value in the *p* parameter, to generate a fortified GIF image.</span></span> <span data-ttu-id="c089c-129">替代文字應設定為最精確的辨識結果。</span><span class="sxs-lookup"><span data-stu-id="c089c-129">The alt text should be set to the most accurate recognition result.</span></span> <span data-ttu-id="c089c-130">您可以視需要將定位設定為絕對或就地。</span><span class="sxs-lookup"><span data-stu-id="c089c-130">You can set positioning to either absolute or in-place, as desired.</span></span>
-   <span data-ttu-id="c089c-131">檢查所有的 IMG 標籤，以判斷是否有任何影像指向包含筆墨的影像（如果已選擇要貼上的 CF HTML 位置） \_ 。</span><span class="sxs-lookup"><span data-stu-id="c089c-131">Check all IMG tags to determine if any images they point to contain ink, if the CF\_HTML slot is chosen for a paste.</span></span> <span data-ttu-id="c089c-132">如果是的話，請在內部將影像視為 [筆墨](/previous-versions/aa515768(v=msdn.10)) 物件。</span><span class="sxs-lookup"><span data-stu-id="c089c-132">If so, treat the images as [Ink](/previous-versions/aa515768(v=msdn.10)) objects internally.</span></span> <span data-ttu-id="c089c-133">雖然此版本只支援 GIF 檔案，但在未來支援其他影像格式的情況下，您的應用程式也應該檢查非 GIF 影像。</span><span class="sxs-lookup"><span data-stu-id="c089c-133">Although only GIF files are supported in this version, your application should check non-GIF images as well, in case additional image formats are supported in the future.</span></span>
-   <span data-ttu-id="c089c-134">支援對 ISF 的複製和貼上。</span><span class="sxs-lookup"><span data-stu-id="c089c-134">Support the copying and pasting of ISF.</span></span> <span data-ttu-id="c089c-135">支援 HTML 的應用程式也應該支援 ISF，以增強無法辨識 HTML 之啟用筆墨的應用程式的互通性。</span><span class="sxs-lookup"><span data-stu-id="c089c-135">Applications that support HTML should also support ISF to enhance interoperability with ink-enabled applications that do not recognize HTML.</span></span> <span data-ttu-id="c089c-136">這類似于將 HTML 放在剪貼簿上的應用程式也會放置文字的慣例。</span><span class="sxs-lookup"><span data-stu-id="c089c-136">This is similar to the convention that applications that place HTML on the Clipboard also place text.</span></span>

<span data-ttu-id="c089c-137">如需嚴加防禦 Gif 的詳細資訊，請參閱 [建立區塊](building-blocks.md)。</span><span class="sxs-lookup"><span data-stu-id="c089c-137">For more information about fortified GIFs, see [Building Blocks](building-blocks.md).</span></span>

 

 
