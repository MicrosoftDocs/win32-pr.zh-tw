---
description: 為了協助支援應用程式中的筆跡，有兩個物件可以內嵌，而且任何 OLE 容器都支援這些物件。
ms.assetid: fbd7bdf0-63b4-48d1-be91-eabbbb3f1618
title: sInk 和 tInk 物件
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 4ef7ed1c06d256fe8eda9fad4bf15afa19fcb833
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/08/2021
ms.locfileid: "106983924"
---
# <a name="sink-and-tink-objects"></a><span data-ttu-id="6c800-103">sInk 和 tInk 物件</span><span class="sxs-lookup"><span data-stu-id="6c800-103">sInk and tInk Objects</span></span>

<span data-ttu-id="6c800-104">為了協助支援應用程式中的筆跡，有兩個物件可以內嵌，而且任何 OLE 容器都支援這些物件。</span><span class="sxs-lookup"><span data-stu-id="6c800-104">To aid the support of ink in applications, there are two objects, both of which can be embedded and are supported by any OLE container.</span></span> <span data-ttu-id="6c800-105">其產生方式是呼叫 **ClipboardCopy 方法 (矩形、InkClipboardFormats、InkClipboardModes) 或\*\*\*\*方法 (筆觸、InkClipboardFormats、InkClipboardModes)** 方法，以及：</span><span class="sxs-lookup"><span data-stu-id="6c800-105">They are produced by calling either the **Ink.ClipboardCopy Method (Rectangle, InkClipboardFormats, InkClipboardModes)** or the **Ink.ClipboardCopy Method (Strokes, InkClipboardFormats, InkClipboardModes)** method and are:</span></span>

-   <span data-ttu-id="6c800-106">文字筆墨物件 (tInk) 。</span><span class="sxs-lookup"><span data-stu-id="6c800-106">Text ink object (tInk).</span></span> <span data-ttu-id="6c800-107">這是代表預期會形成單字之筆墨的 OLE 物件。</span><span class="sxs-lookup"><span data-stu-id="6c800-107">This is an OLE object representing ink that is expected to form words.</span></span> <span data-ttu-id="6c800-108">TInk 物件可讓手寫筆跡轉換成文字，可作為辨識器傳回的文字，或是取自辨識替代項的清單中所做的選擇。</span><span class="sxs-lookup"><span data-stu-id="6c800-108">A tInk object allows the handwritten ink to be converted to text, either as the text returned by a recognizer or the choice taken from a list of recognition alternates.</span></span> <span data-ttu-id="6c800-109">您可以透過程式設計方式設定筆墨的色彩和大小，而且可以根據物件周圍文字的屬性來設定。</span><span class="sxs-lookup"><span data-stu-id="6c800-109">The color and size of the ink can be set programmatically and can be based on the attributes of the text around the object.</span></span> <span data-ttu-id="6c800-110">TInk 物件的目的是要包含單一單字。TInk 物件是一個小型的輕量物件，可執行簡單的作業，例如轉譯 (提供裝置內容的控制碼 (HDC) 和 RECT) ，並在給定資料流程 (時保存本身) 。</span><span class="sxs-lookup"><span data-stu-id="6c800-110">The tInk object is intended to contain a single word.The tInk object is a small, lightweight object that can perform simple operations like rendering (given a handle to a device context (HDC) and a RECT), and persisting itself (given a stream).</span></span> <span data-ttu-id="6c800-111">使用 tInk 物件時，在使用手寫和文字輸入的應用程式中工作時，可提供順暢的使用者體驗。</span><span class="sxs-lookup"><span data-stu-id="6c800-111">Using a tInk object allows a seamless user experience when working in an application that uses input of both handwriting and text.</span></span>
-   <span data-ttu-id="6c800-112"> (接收器) 草繪筆墨物件。</span><span class="sxs-lookup"><span data-stu-id="6c800-112">Sketch ink object (sInk).</span></span> <span data-ttu-id="6c800-113">這是代表不需要形成單字之筆墨的 OLE 物件。</span><span class="sxs-lookup"><span data-stu-id="6c800-113">This is an OLE object representing ink that is not expected to form words.</span></span> <span data-ttu-id="6c800-114">接收物件會被解釋為繪圖。</span><span class="sxs-lookup"><span data-stu-id="6c800-114">A sInk object is interpreted as a drawing.</span></span> <span data-ttu-id="6c800-115">接收物件也適合用來表示多個單字。</span><span class="sxs-lookup"><span data-stu-id="6c800-115">A sInk object is also useful for representing multiple words.</span></span>

<span data-ttu-id="6c800-116">這些物件可用於應用程式之間的互通性，方法是將它們放在剪貼簿上的 OLE 物件位置，或是以 Rtf)  (RTF 格式來內嵌它們。</span><span class="sxs-lookup"><span data-stu-id="6c800-116">These objects can be used for interoperability between applications, either by placing them in the OLE object slot on the Clipboard or by embedding them in Rich Text Format (RTF).</span></span>

<span data-ttu-id="6c800-117">您可以透過下列方式使用 tInk 和接收物件：</span><span class="sxs-lookup"><span data-stu-id="6c800-117">You can use tInk and sInk objects in the following ways:</span></span>

-   <span data-ttu-id="6c800-118">Microsoft Word 2002 支援 tInk 和接收物件。</span><span class="sxs-lookup"><span data-stu-id="6c800-118">Both tInk and sInk objects are supported in Microsoft Word 2002.</span></span> <span data-ttu-id="6c800-119">使用者可以使用 Word 2002 中提供的「書寫」和「繪製文字輸入面板」，將筆墨插入 Word 檔中。</span><span class="sxs-lookup"><span data-stu-id="6c800-119">Users can insert ink into a Word document by using the writing and drawing text input panels provided in Word 2002.</span></span> <span data-ttu-id="6c800-120">這個筆墨會以具有接收器或 tInk 物件之 CLSID 的 OLE 物件形式內嵌至 Word 檔案。</span><span class="sxs-lookup"><span data-stu-id="6c800-120">This ink is embedded into the Word file as an OLE object with the CLSID of either the sInk or tInk object.</span></span>
-   <span data-ttu-id="6c800-121">Tablet PC [InkEdit](/previous-versions/ms552265(v=vs.100)) 控制項會使用 tInk 物件。</span><span class="sxs-lookup"><span data-stu-id="6c800-121">The Tablet PC [InkEdit](/previous-versions/ms552265(v=vs.100)) control makes use of the tInk object.</span></span> <span data-ttu-id="6c800-122">InkEdit 控制項是標準 [RichTextBox](/dotnet/api/system.windows.forms.richtextbox?view=netcore-3.1) 控制項的子類別。</span><span class="sxs-lookup"><span data-stu-id="6c800-122">The InkEdit control is a subclass of the standard [RichTextBox](/dotnet/api/system.windows.forms.richtextbox?view=netcore-3.1) control.</span></span> <span data-ttu-id="6c800-123">筆墨會以 tInk 物件的形式插入 InkEdit 控制項的 RTF 資料流程中。</span><span class="sxs-lookup"><span data-stu-id="6c800-123">Ink is inserted into the InkEdit control's RTF stream as a tInk object.</span></span>
-   <span data-ttu-id="6c800-124">當應用程式將選取的 [筆墨](/previous-versions/aa515768(v=msdn.10)) 物件移到剪貼簿時，Ole 物件剪貼簿位置會包含 TInk 或接收 ole 物件。</span><span class="sxs-lookup"><span data-stu-id="6c800-124">When an application moves a selected [Ink](/previous-versions/aa515768(v=msdn.10)) object onto the Clipboard, the OLE object Clipboard slot contains a tInk or sInk OLE object.</span></span>

<span data-ttu-id="6c800-125">例如，您的應用程式可以辨識手寫，並將任何 [筆墨](/previous-versions/aa515768(v=msdn.10)) 物件標示為 tInk 物件。</span><span class="sxs-lookup"><span data-stu-id="6c800-125">For example, your application can recognize handwriting and mark any [Ink](/previous-versions/aa515768(v=msdn.10)) object as a tInk object.</span></span> <span data-ttu-id="6c800-126">然後，如果您選取筆跡中的單字，並將其複製並貼到 Word 中，則會在 Word 2002 中顯示該單字的替代項。</span><span class="sxs-lookup"><span data-stu-id="6c800-126">Then, if you select a word in ink and copy and paste it to Word, alternates for that word are shown in Word 2002.</span></span>

> [!Note]  
> <span data-ttu-id="6c800-127">當您將接收器或 tInk 物件放在剪貼簿上作為 OLE 物件時，Tablet PC 平臺的剪貼簿支援會自動為您選取增強的中繼檔 (EMF) 旗標。</span><span class="sxs-lookup"><span data-stu-id="6c800-127">The Tablet PC Platform's Clipboard support automatically selects the Enhanced Metafile (EMF) flag for you when you place a sInk or tInk object on the Clipboard as an OLE object.</span></span> <span data-ttu-id="6c800-128">物件本身會儲存在 [剪貼簿] 的 [剪貼簿] 和 [物件描述項位置] 中。</span><span class="sxs-lookup"><span data-stu-id="6c800-128">The object itself is stored on the Clipboard in the embed source and object descriptor slots.</span></span>

 

<span data-ttu-id="6c800-129">另一個範例是，藉由使用接收物件，您可以在應用程式中繪製筆墨草圖、將草圖複製並貼上至 Word 2002，然後使用 Word 中的 [Tablet PC 輸入面板] 編輯繪圖。</span><span class="sxs-lookup"><span data-stu-id="6c800-129">As another example, by using the sInk object, you can draw an ink sketch in an application, copy and paste the sketch to Word 2002, and then edit the drawing by using Tablet PC Input Panel in Word.</span></span>

<span data-ttu-id="6c800-130">為了成功包含 tInk 物件，應用程式必須針對内嵌物件執行 OLE 容器支援。</span><span class="sxs-lookup"><span data-stu-id="6c800-130">In order to successfully contain tInk objects, an application must implement OLE container support for embedded objects.</span></span> <span data-ttu-id="6c800-131">然後，若要讓容器完全支援 tInk，您必須建立：</span><span class="sxs-lookup"><span data-stu-id="6c800-131">Then, to make the container fully support tInk, you must institute:</span></span>

-   <span data-ttu-id="6c800-132">修改程式碼以進行尋找和取代。</span><span class="sxs-lookup"><span data-stu-id="6c800-132">Modifications to the code for Find and Replace.</span></span> <span data-ttu-id="6c800-133">這些物件的類型必須是查核，而不是略過搜尋中的內嵌物件。</span><span class="sxs-lookup"><span data-stu-id="6c800-133">Instead of skipping embedded objects in the search, these objects must be interrogated for type.</span></span> <span data-ttu-id="6c800-134">如果它們是 tInk 物件，則必須將它們具現化，並針對其對應的文字進行查詢。</span><span class="sxs-lookup"><span data-stu-id="6c800-134">If they are a tInk object, they must be instantiated and queried for their corresponding text.</span></span>
-   <span data-ttu-id="6c800-135">修改選取行為。</span><span class="sxs-lookup"><span data-stu-id="6c800-135">Modifications to selection behavior.</span></span> <span data-ttu-id="6c800-136">TInk 物件的選取範圍絕對不應該與調整大小控點一起出現。</span><span class="sxs-lookup"><span data-stu-id="6c800-136">Selection of tInk objects should never appear with sizing handles.</span></span> <span data-ttu-id="6c800-137">它們的選取方式應該與檔中選取文字的方式相同。</span><span class="sxs-lookup"><span data-stu-id="6c800-137">They should be selected in the same way that text is selected in the document.</span></span> <span data-ttu-id="6c800-138">物件的選取程式碼必須偵測型別是否為 tInk，並適當地顯示選取範圍。</span><span class="sxs-lookup"><span data-stu-id="6c800-138">Selection code for objects must detect if the type is tInk and display the selection appropriately.</span></span>
-   <span data-ttu-id="6c800-139">環境屬性的使用。</span><span class="sxs-lookup"><span data-stu-id="6c800-139">Use of ambient properties.</span></span> <span data-ttu-id="6c800-140">字型大小、色彩和粗體格式等環境屬性必須傳送至 tInk 物件。</span><span class="sxs-lookup"><span data-stu-id="6c800-140">Ambient properties such as font size, color, and bold formatting need to be transmitted to the tInk object.</span></span> <span data-ttu-id="6c800-141">這些屬性的應用會變更手寫筆跡的寬度，因此需要透過呼叫 [**GetInkExtent 方法**](/windows/desktop/api/msinkaut/nf-msinkaut-iinklineinfo-getinkextent) 或 [IOleObject：： GetExtent](/windows/win32/api/oleidl/nf-oleidl-ioleobject-getextent) 方法來更新大小。</span><span class="sxs-lookup"><span data-stu-id="6c800-141">Application of these properties changes the width of the handwritten ink, so a size update is required by calling the [**GetInkExtent Method**](/windows/desktop/api/msinkaut/nf-msinkaut-iinklineinfo-getinkextent) or [IOleObject::GetExtent](/windows/win32/api/oleidl/nf-oleidl-ioleobject-getextent) method.</span></span>
-   <span data-ttu-id="6c800-142">覆寫預設 [IOleObject：:D overb](/windows/win32/api/oleidl/nf-oleidl-ioleobject-doverb) 方法處理。</span><span class="sxs-lookup"><span data-stu-id="6c800-142">Override the default [IOleObject::DoVerb](/windows/win32/api/oleidl/nf-oleidl-ioleobject-doverb) method processing.</span></span> <span data-ttu-id="6c800-143">這可讓轉換成文字以將 tInk 物件的批次傳遞至辨識器，然後將這些文字分成辨識區段。</span><span class="sxs-lookup"><span data-stu-id="6c800-143">This allows conversion to text to pass a batch of tInk objects to the recognizer, which can then break the words into recognition segments.</span></span>

<span data-ttu-id="6c800-144">如需將字詞細分為辨識區段的詳細資訊，請參閱辨識 [區段](recognition-segments.md)。</span><span class="sxs-lookup"><span data-stu-id="6c800-144">For more information about breaking words into recognition segments, see [Recognition Segments](recognition-segments.md).</span></span>

 

 
