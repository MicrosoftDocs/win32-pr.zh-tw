---
title: COM 物件和結構化儲存體
description: 持續性屬性最常見的其中一個用途是使用它們來儲存與該物件相關之系統物件（例如檔）的資料。
ms.assetid: 95136e9a-4c80-4704-ae65-9759487cf8f8
keywords:
- COM 物件和結構化儲存體
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 472a3d2fb9c145538bbd6b5e87dfcc9523feff78
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 09/16/2019
ms.locfileid: "104371922"
---
# <a name="com-objects-and-structured-storage"></a><span data-ttu-id="d7c70-104">COM 物件和結構化儲存體</span><span class="sxs-lookup"><span data-stu-id="d7c70-104">COM Objects and Structured Storage</span></span>

<span data-ttu-id="d7c70-105">持續性屬性最常見的其中一個用途是使用它們來儲存與該物件相關之系統物件（例如檔）的資料。</span><span class="sxs-lookup"><span data-stu-id="d7c70-105">One of the most common current uses of persistent properties is to use them to store data about a system object, such as a document, with that object.</span></span> <span data-ttu-id="d7c70-106">當然，有可能會使用任何物件（例如印表機）來儲存屬性，因此只需要查看其屬性，即可判斷其位置、類型等等。</span><span class="sxs-lookup"><span data-stu-id="d7c70-106">There is, of course, the potential of storing properties with any object, such as a printer, so it would only be necessary to look at its properties to determine its location, its type, and so on.</span></span> <span data-ttu-id="d7c70-107">使用者物件可以有屬性集，其中包含名字、姓氏、辦公室和電話等資料。</span><span class="sxs-lookup"><span data-stu-id="d7c70-107">A user object could have a property set that includes data such as First Name, Last Name, Office, and Phone.</span></span> <span data-ttu-id="d7c70-108">您可以撰寫應用程式，以根據物件的屬性查詢全系統的物件集合，例如，顯示位於特定大樓的所有印表機。</span><span class="sxs-lookup"><span data-stu-id="d7c70-108">Applications can be written to query a system-wide set of objects based on their properties, for example, displaying all printers located in a certain building.</span></span> <span data-ttu-id="d7c70-109">不過，目前的系統最常使用檔的屬性。</span><span class="sxs-lookup"><span data-stu-id="d7c70-109">Current systems, however, most frequently use properties on documents.</span></span>

<span data-ttu-id="d7c70-110">COM 定義的主要屬性集標準是 [摘要資訊屬性集](the-summary-information-property-set.md)。</span><span class="sxs-lookup"><span data-stu-id="d7c70-110">The primary property set standard defined by COM is [The Summary Information Property Set](the-summary-information-property-set.md).</span></span> <span data-ttu-id="d7c70-111">這個屬性集既簡單又常用。</span><span class="sxs-lookup"><span data-stu-id="d7c70-111">This property set is both simple and commonly used.</span></span> <span data-ttu-id="d7c70-112">應用程式所建立的大部分檔都有一組共同的屬性，適用于這些檔的使用者。</span><span class="sxs-lookup"><span data-stu-id="d7c70-112">Most documents created by applications have a common set of attributes useful to users of those documents.</span></span> <span data-ttu-id="d7c70-113">這些屬性包括檔作者的名稱、檔的主旨、建立時等等。</span><span class="sxs-lookup"><span data-stu-id="d7c70-113">These attributes include the name of the document author, the subject of the document, when it was created, and so on.</span></span> <span data-ttu-id="d7c70-114">另外還有兩個屬性集是針對 Microsoft Office 95、Office 97 和更新版本所定義的。</span><span class="sxs-lookup"><span data-stu-id="d7c70-114">Two other property sets are defined for Microsoft Office 95, Office 97 and later.</span></span> <span data-ttu-id="d7c70-115">這些是 [COM 檔摘要] 屬性集和 [User-Defined 屬性] 屬性集。</span><span class="sxs-lookup"><span data-stu-id="d7c70-115">These are the COM Document Summary property set and the User-Defined Properties property set.</span></span> <span data-ttu-id="d7c70-116">如需詳細資訊，請參閱 [結構化儲存體序列化屬性集格式](structured-storage-serialized-property-set-format.md)。</span><span class="sxs-lookup"><span data-stu-id="d7c70-116">For more information, see [Structured Storage Serialized Property Set Format](structured-storage-serialized-property-set-format.md).</span></span>

<span data-ttu-id="d7c70-117">在 Windows 3.1 中，每個應用程式都有不同的方式可將此資料儲存在其檔中。</span><span class="sxs-lookup"><span data-stu-id="d7c70-117">In Windows 3.1, each application had a different way of storing this data within its documents.</span></span> <span data-ttu-id="d7c70-118">若要檢查給定檔的摘要資訊，使用者必須執行建立檔的應用程式，開啟它，然後叫用 [應用程式摘要資訊] 對話方塊，讓應用程式只顯示其摘要資訊。</span><span class="sxs-lookup"><span data-stu-id="d7c70-118">To examine the summary information for a given document, the user had to run the application that created the document, open it, and invoke the application Summary Information dialog box, so only the application could display its summary information.</span></span>

<span data-ttu-id="d7c70-119">COM 屬性集和屬性集介面可讓您在不執行建立應用程式的情況下查看檔案屬性。</span><span class="sxs-lookup"><span data-stu-id="d7c70-119">COM property sets and the property set interfaces make it possible to see the document properties without running the creating application.</span></span> <span data-ttu-id="d7c70-120">例如，所有版本的 Microsoft Word 6.0 或更新版本，以及許多其他已啟用 COM 的應用程式現在會使用 COM 結構化儲存區和此處所述的屬性集標準來儲存檔。</span><span class="sxs-lookup"><span data-stu-id="d7c70-120">For example, all versions of Microsoft Word 6.0 or later, and many other COM-enabled applications now save their documents using COM structured storage and the property set standard described here.</span></span> <span data-ttu-id="d7c70-121">因此，其他 Office 套件應用程式可以顯示 [該檔案的摘要資訊屬性集](the-summary-information-property-set.md) ，只要該檔案是 com 結構化儲存體檔案，而且建立的應用程式將資訊儲存為 Com 屬性集格式即可。</span><span class="sxs-lookup"><span data-stu-id="d7c70-121">Thus, other Office Suite applications are able to display [The Summary Information Property Set](the-summary-information-property-set.md) for such a file, as long as that file is a COM structured storage file, and the creating application saved the information in the COM Property Set format.</span></span> <span data-ttu-id="d7c70-122">例如，Windows 95 或 Windows 98 shell 會使用這種方式，並可讓使用者直接從 shell 查看任何文字6.0 或更新版本檔的屬性。</span><span class="sxs-lookup"><span data-stu-id="d7c70-122">The Windows 95 or Windows 98 shell, for example, uses this, and allows the end user to view the properties of any Word 6.0 or later document directly from the shell.</span></span>

<span data-ttu-id="d7c70-123">若要使用其他應用程式的屬性集，其他應用程式必須辨識如何解讀屬性集內的屬性，這表示標準。</span><span class="sxs-lookup"><span data-stu-id="d7c70-123">To use property sets from other applications, the other applications must recognize how to interpret the properties within a property set, which implies a standard.</span></span> <span data-ttu-id="d7c70-124">COM 藉由定義一個標準屬性集（即 COM 摘要資訊屬性集）來採用此方法。</span><span class="sxs-lookup"><span data-stu-id="d7c70-124">COM has pioneered this approach by defining one standard property set, the COM Summary Information Property Set.</span></span> <span data-ttu-id="d7c70-125">任何具有這個屬性集定義的應用程式，都可以輕鬆地存取使用該屬性集規格之 COM 應用程式所建立之任何檔中包含的摘要資訊。</span><span class="sxs-lookup"><span data-stu-id="d7c70-125">Any application that has the definition of this property set can easily access the summary information contained in any document created by an COM application that uses that property set specification.</span></span>

 

 




