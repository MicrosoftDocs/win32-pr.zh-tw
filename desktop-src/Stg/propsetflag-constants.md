---
title: 'PROPSETFLAG 常數 (Propidl.idl) '
description: 定義屬性集的特性。
ms.assetid: 6f865c8f-bbca-4122-b076-14f2bc56f292
topic_type:
- apiref
api_name:
- PROPSETFLAG_DEFAULT
- PROPSETFLAG_NONSIMPLE
- PROPSETFLAG_ANSI
- PROPSETFLAG_UNBUFFERED
- PROPSETFLAG_CASE_SENSITIVE
api_location:
- Propidl.h
api_type:
- HeaderDef
ms.topic: reference
ms.date: 05/31/2018
ms.openlocfilehash: e8f31d7b2659eeaa003c1a0d15103e94ad1a5c89
ms.sourcegitcommit: a1494c819bc5200050696e66057f1020f5b142cb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 12/12/2020
ms.locfileid: "103934428"
---
# <a name="propsetflag-constants"></a><span data-ttu-id="a67ed-103">PROPSETFLAG 常數</span><span class="sxs-lookup"><span data-stu-id="a67ed-103">PROPSETFLAG Constants</span></span>

<span data-ttu-id="a67ed-104">PROPSETFLAG 常數會定義屬性集的特性。</span><span class="sxs-lookup"><span data-stu-id="a67ed-104">The PROPSETFLAG constants define characteristics of a property set.</span></span> <span data-ttu-id="a67ed-105">下表所列的值用於 [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage)方法、 [**StgCreatePropStg**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatepropstg)函式和 [**StgOpenPropStg**](/windows/desktop/api/coml2api/nf-coml2api-stgopenpropstg)函數的 *grfFlags* 參數中。</span><span class="sxs-lookup"><span data-stu-id="a67ed-105">The values, listed in the following table, are used in the *grfFlags* parameter of [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) methods, the [**StgCreatePropStg**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatepropstg) function, and the [**StgOpenPropStg**](/windows/desktop/api/coml2api/nf-coml2api-stgopenpropstg) function.</span></span>



| <span data-ttu-id="a67ed-106">常數/值</span><span class="sxs-lookup"><span data-stu-id="a67ed-106">Constant/value</span></span>                                                                                                                                                                                                                                               | <span data-ttu-id="a67ed-107">Description</span><span class="sxs-lookup"><span data-stu-id="a67ed-107">Description</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|:-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span id="PROPSETFLAG_DEFAULT"></span><span id="propsetflag_default"></span><dl> <span data-ttu-id="a67ed-108"><dt>**PROPSETFLAG \_預設值**</dt> <dt>0</dt></span><span class="sxs-lookup"><span data-stu-id="a67ed-108"><dt>**PROPSETFLAG\_DEFAULT**</dt> <dt>0</dt></span></span> </dl>                       | <span data-ttu-id="a67ed-109">如果未指定，根據預設，只有簡單的屬性值可以寫入屬性集。</span><span class="sxs-lookup"><span data-stu-id="a67ed-109">If left unspecified, by default only simple property values may be written to the property set.</span></span> <span data-ttu-id="a67ed-110">使用簡單的屬性值可防止在複合檔案和獨立的 [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage)執行中交易屬性集。</span><span class="sxs-lookup"><span data-stu-id="a67ed-110">Using simple property values prevents property sets from being transacted in the compound file and stand-alone implementations of [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage).</span></span> <span data-ttu-id="a67ed-111">非 e 屬性值必須用於此用途。</span><span class="sxs-lookup"><span data-stu-id="a67ed-111">Non-e property values must be used for this purpose.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| <span id="PROPSETFLAG_NONSIMPLE"></span><span id="propsetflag_nonsimple"></span><dl> <span data-ttu-id="a67ed-112"><dt>**PROPSETFLAG \_簡單**</dt> <dt>1</dt></span><span class="sxs-lookup"><span data-stu-id="a67ed-112"><dt>**PROPSETFLAG\_NONSIMPLE**</dt> <dt>1</dt></span></span> </dl>                 | <span data-ttu-id="a67ed-113">如果有指定，就可以將簡單屬性值寫入屬性集，並將屬性集儲存在儲存物件中。</span><span class="sxs-lookup"><span data-stu-id="a67ed-113">If specified, nonsimple property values can be written to the property set and the property set is saved in a storage object.</span></span> <span data-ttu-id="a67ed-114">非簡單的屬性值包括具有 VT 儲存的 VARTYPE \_ 、vt \_ 資料流程、vt \_ 儲存 \_ 物件或 vt \_ 資料流程 \_ 物件的值。</span><span class="sxs-lookup"><span data-stu-id="a67ed-114">Non-simple property values include those with a VARTYPE of VT\_STORAGE, VT\_STREAM, VT\_STORED\_OBJECT, or VT\_STREAMED\_OBJECT.</span></span> <span data-ttu-id="a67ed-115">如果未指定此旗標，則無法將非簡單類型寫入屬性集。</span><span class="sxs-lookup"><span data-stu-id="a67ed-115">If this flag is not specified, non-simple types cannot be written into the property set.</span></span> <span data-ttu-id="a67ed-116">在複合檔案和獨立的執行中，只有在指定 **PROPSETFLAG \_ 簡單** 時，才可以交易屬性集。</span><span class="sxs-lookup"><span data-stu-id="a67ed-116">In the compound file and stand-alone implementations, property sets may be transacted only if **PROPSETFLAG\_NONSIMPLE** is specified.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| <span id="PROPSETFLAG_ANSI"></span><span id="propsetflag_ansi"></span><dl> <span data-ttu-id="a67ed-117"><dt>**PROPSETFLAG \_ANSI**</dt> <dt>2</dt></span><span class="sxs-lookup"><span data-stu-id="a67ed-117"><dt>**PROPSETFLAG\_ANSI**</dt> <dt>2</dt></span></span> </dl>                                | <span data-ttu-id="a67ed-118">如果有指定，屬性集中所有非明確 Unicode 的字串值（也就是 VT LPWSTR 以外的字串值） \_ 都會與目前的系統 ANSI 字碼頁一併儲存。</span><span class="sxs-lookup"><span data-stu-id="a67ed-118">If specified, all string values in the property set that are not explicitly Unicode, that is, those other than VT\_LPWSTR, are stored with the current system ANSI code page.</span></span> <span data-ttu-id="a67ed-119">如需詳細資訊，請參閱 [**GetACP**](/windows/desktop/api/winnls/nf-winnls-getacp)。</span><span class="sxs-lookup"><span data-stu-id="a67ed-119">For more information, see [**GetACP**](/windows/desktop/api/winnls/nf-winnls-getacp).</span></span> <span data-ttu-id="a67ed-120">不建議使用此值。</span><span class="sxs-lookup"><span data-stu-id="a67ed-120">Use of this value is not recommended.</span></span> <span data-ttu-id="a67ed-121">如需詳細資訊，請參閱＜備註＞。</span><span class="sxs-lookup"><span data-stu-id="a67ed-121">For more information, see Remarks.</span></span><br/> <span data-ttu-id="a67ed-122">如果此值不存在，新屬性集中的字串值會儲存為 Unicode。</span><span class="sxs-lookup"><span data-stu-id="a67ed-122">If this value is absent, string values in the new property set are stored in Unicode.</span></span> <span data-ttu-id="a67ed-123">此值所提供的控制程度是必要的，如此一來，使用屬性相關介面的用戶端就可以與標準屬性集交互操作，例如 OLE2 摘要資訊（可能存在於 ANSI 字碼頁中）。</span><span class="sxs-lookup"><span data-stu-id="a67ed-123">The degree of control that this value provides is necessary so that clients using the property-related interfaces can interoperate with standard property sets such as the OLE2 summary information, which may exist in the ANSI code page.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| <span id="PROPSETFLAG_UNBUFFERED"></span><span id="propsetflag_unbuffered"></span><dl> <span data-ttu-id="a67ed-124"><dt>**PROPSETFLAG \_未緩衝**</dt> <dt>4</dt></span><span class="sxs-lookup"><span data-stu-id="a67ed-124"><dt>**PROPSETFLAG\_UNBUFFERED**</dt> <dt>4</dt></span></span> </dl>              | <span data-ttu-id="a67ed-125">只能搭配 [**StgCreatePropStg**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatepropstg) 和 [**StgOpenPropStg**](/windows/desktop/api/coml2api/nf-coml2api-stgopenpropstg) 函數使用;亦即，在屬性集介面的獨立執行中。</span><span class="sxs-lookup"><span data-stu-id="a67ed-125">Used only with the [**StgCreatePropStg**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatepropstg) and [**StgOpenPropStg**](/windows/desktop/api/coml2api/nf-coml2api-stgopenpropstg) functions; that is, in the stand-alone implementations of property set interfaces.</span></span> <span data-ttu-id="a67ed-126">如果在這些函式中指定，則不會緩衝處理屬性集的變更。</span><span class="sxs-lookup"><span data-stu-id="a67ed-126">If specified in these functions, changes to the property set are not buffered.</span></span> <span data-ttu-id="a67ed-127">相反地，變更一律會直接寫入屬性集。</span><span class="sxs-lookup"><span data-stu-id="a67ed-127">Instead, changes are always written directly to the property set.</span></span> <span data-ttu-id="a67ed-128">對屬性集 [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) 方法的呼叫將會變更它。</span><span class="sxs-lookup"><span data-stu-id="a67ed-128">Calls to a property set [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) methods will change it.</span></span> <span data-ttu-id="a67ed-129">不過，根據預設，變更會在內部屬性集快取中進行緩衝處理，然後在呼叫 [**IPropertyStorage：： Commit**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-commit) 方法時，寫入屬性集。</span><span class="sxs-lookup"><span data-stu-id="a67ed-129">However, by default, changes are buffered in an internal property set cache and are subsequently written to the property set when the [**IPropertyStorage::Commit**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-commit) method is called.</span></span> <br/> <span data-ttu-id="a67ed-130">設定 **PROPSETFLAG 無 \_ 緩衝** 會降低效能，因為在每次變更屬性集之後，會自動清除屬性集內部緩衝區。</span><span class="sxs-lookup"><span data-stu-id="a67ed-130">Setting **PROPSETFLAG\_UNBUFFERED** decreases performance because the property set internal buffer is automatically flushed after every change to the property set.</span></span> <span data-ttu-id="a67ed-131">不過，直接寫入變更可防止協調問題。</span><span class="sxs-lookup"><span data-stu-id="a67ed-131">However, writing changes directly will prevent coordination problems.</span></span> <span data-ttu-id="a67ed-132">例如，如果在交易模式中開啟儲存物件，則會緩衝處理屬性集。</span><span class="sxs-lookup"><span data-stu-id="a67ed-132">For example, if the storage object is opened in transacted mode, and the property set is buffered.</span></span> <span data-ttu-id="a67ed-133">然後，如果您在儲存物件上呼叫 [**IStorage：： Commit**](/windows/desktop/api/Objidl/nf-objidl-istorage-commit) 方法，則不會將屬性集變更視為交易的一部分，因為它們位於尚未排清的緩衝區中。</span><span class="sxs-lookup"><span data-stu-id="a67ed-133">Then, if you call the [**IStorage::Commit**](/windows/desktop/api/Objidl/nf-objidl-istorage-commit) method on the storage object, the property set changes will not be picked up as part of the transaction, because they are in a buffer that has not been flushed yet.</span></span> <span data-ttu-id="a67ed-134">您必須在呼叫 **IStorage：： commit** 之前呼叫 [**IPropertyStorage：： commit**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-commit) ，以排清屬性集緩衝區，然後再認可對儲存體的變更。</span><span class="sxs-lookup"><span data-stu-id="a67ed-134">You must call [**IPropertyStorage::Commit**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-commit) prior to calling **IStorage::Commit** to flush the property set buffer before committing changes to the storage.</span></span> <span data-ttu-id="a67ed-135">除了進行兩個呼叫之外，您還可以設定 **PROPSETFLAG 無 \_ 緩衝** ，讓變更一律直接寫入屬性集，且永遠不會在屬性集的內部快取中進行緩衝處理。</span><span class="sxs-lookup"><span data-stu-id="a67ed-135">As an alternative to making two calls, you can set **PROPSETFLAG\_UNBUFFERED** so that changes are always written directly to the property set and are never buffered in the property set's internal cache.</span></span> <span data-ttu-id="a67ed-136">然後，在認可交易儲存體時，就會挑選變更。</span><span class="sxs-lookup"><span data-stu-id="a67ed-136">Then, the changes will be picked up when the transacted storage is committed.</span></span><br/> |
| <span id="PROPSETFLAG_CASE_SENSITIVE"></span><span id="propsetflag_case_sensitive"></span><dl> <span data-ttu-id="a67ed-137"><dt>**PROPSETFLAG \_區分 \_ 大小寫**</dt> <dt>8</dt></span><span class="sxs-lookup"><span data-stu-id="a67ed-137"><dt>**PROPSETFLAG\_CASE\_SENSITIVE**</dt> <dt>8</dt></span></span> </dl> | <span data-ttu-id="a67ed-138">如果有指定，屬性名稱會區分大小寫。</span><span class="sxs-lookup"><span data-stu-id="a67ed-138">If specified, property names are case sensitive.</span></span> <span data-ttu-id="a67ed-139">只有在第1版的屬性集序列化格式中，才可以區分大小寫的屬性名稱。</span><span class="sxs-lookup"><span data-stu-id="a67ed-139">Case-sensitive property names are only possible in the version 1 property set serialization format.</span></span> <span data-ttu-id="a67ed-140">如需詳細資訊，請參閱 [屬性集序列化](version-0-vs--version-1-property-set-serialization.md)。</span><span class="sxs-lookup"><span data-stu-id="a67ed-140">For more information, see [Property Set Serialization](version-0-vs--version-1-property-set-serialization.md).</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |



## <a name="remarks"></a><span data-ttu-id="a67ed-141">備註</span><span class="sxs-lookup"><span data-stu-id="a67ed-141">Remarks</span></span>

<span data-ttu-id="a67ed-142">您可以使用位運算來設定和檢查這些值，以決定如何建立和開啟屬性集。</span><span class="sxs-lookup"><span data-stu-id="a67ed-142">These values can be set and checked using bitwise operations that determine how property sets are created and opened.</span></span> <span data-ttu-id="a67ed-143">屬性集是使用 [**IPropertySetStorage：： Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create) 方法或 [**StgCreatePropStg**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatepropstg) 函數所建立。</span><span class="sxs-lookup"><span data-stu-id="a67ed-143">Property sets are created using the [**IPropertySetStorage::Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create) method or the [**StgCreatePropStg**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatepropstg) function.</span></span> <span data-ttu-id="a67ed-144">它們是使用 [**IPropertySetStorage：： Open**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-open) 方法或 [**StgOpenPropStg**](/windows/desktop/api/coml2api/nf-coml2api-stgopenpropstg) 函數來開啟。</span><span class="sxs-lookup"><span data-stu-id="a67ed-144">They are opened using the [**IPropertySetStorage::Open**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-open) method or the [**StgOpenPropStg**](/windows/desktop/api/coml2api/nf-coml2api-stgopenpropstg) function.</span></span>

<span data-ttu-id="a67ed-145">建議您不要在 *grfFlags* 參數中設定 **PROPSETFLAG \_ ANSI** 旗標，以將屬性集建立為 Unicode。</span><span class="sxs-lookup"><span data-stu-id="a67ed-145">It is recommended that property sets be created as Unicode by not setting the **PROPSETFLAG\_ANSI** flag in the *grfFlags* parameter.</span></span> <span data-ttu-id="a67ed-146">此外，也建議您避免使用 VT \_ LPSTR 值，並改為使用 vt \_ LPWSTR 值。</span><span class="sxs-lookup"><span data-stu-id="a67ed-146">It is also recommended that you avoid using VT\_LPSTR values, and use VT\_LPWSTR values instead.</span></span> <span data-ttu-id="a67ed-147">當屬性集字碼頁是 Unicode 時，VT \_ LPSTR 字串值會在儲存時轉換成 unicode，並在抓取時轉換回多位元組字元串值。</span><span class="sxs-lookup"><span data-stu-id="a67ed-147">When the property set code page is Unicode, VT\_LPSTR string values are converted to Unicode when stored, and converted back to multibyte string values when retrieved.</span></span> <span data-ttu-id="a67ed-148">當屬性集的字碼頁不是 Unicode 時，屬性名稱、VT \_ BSTR 字串和簡單屬性值會在儲存時轉換成多位元組字元串，並且在抓取時轉換回 Unicode，全都使用目前的系統 ANSI 字碼頁。</span><span class="sxs-lookup"><span data-stu-id="a67ed-148">When the code page of the property set is not Unicode, property names, VT\_BSTR strings, and nonsimple property values are converted to multibyte strings when stored, and converted back to Unicode when retrieved, all using the current system ANSI code page.</span></span>

## <a name="requirements"></a><span data-ttu-id="a67ed-149">規格需求</span><span class="sxs-lookup"><span data-stu-id="a67ed-149">Requirements</span></span>



| <span data-ttu-id="a67ed-150">需求</span><span class="sxs-lookup"><span data-stu-id="a67ed-150">Requirement</span></span> | <span data-ttu-id="a67ed-151">值</span><span class="sxs-lookup"><span data-stu-id="a67ed-151">Value</span></span> |
|-------------------------------------|--------------------------------------------------------------------------------------|
| <span data-ttu-id="a67ed-152">最低支援的用戶端</span><span class="sxs-lookup"><span data-stu-id="a67ed-152">Minimum supported client</span></span><br/> | <span data-ttu-id="a67ed-153">Windows 2000 Professional \[僅限傳統型應用程式\]</span><span class="sxs-lookup"><span data-stu-id="a67ed-153">Windows 2000 Professional \[desktop apps only\]</span></span><br/>                           |
| <span data-ttu-id="a67ed-154">最低支援的伺服器</span><span class="sxs-lookup"><span data-stu-id="a67ed-154">Minimum supported server</span></span><br/> | <span data-ttu-id="a67ed-155">Windows 2000 Server \[僅限傳統型應用程式\]</span><span class="sxs-lookup"><span data-stu-id="a67ed-155">Windows 2000 Server \[desktop apps only\]</span></span><br/>                                 |
| <span data-ttu-id="a67ed-156">標頭</span><span class="sxs-lookup"><span data-stu-id="a67ed-156">Header</span></span><br/>                   | <dl> <span data-ttu-id="a67ed-157"><dt>Propidl.idl。h</dt></span><span class="sxs-lookup"><span data-stu-id="a67ed-157"><dt>Propidl.h</dt></span></span> </dl> |



## <a name="see-also"></a><span data-ttu-id="a67ed-158">另請參閱</span><span class="sxs-lookup"><span data-stu-id="a67ed-158">See also</span></span>

<dl> <dt>

[<span data-ttu-id="a67ed-159">**FmtIdToPropStgName**</span><span class="sxs-lookup"><span data-stu-id="a67ed-159">**FmtIdToPropStgName**</span></span>](/windows/desktop/api/coml2api/nf-coml2api-fmtidtopropstgname)
</dt> <dt>

[<span data-ttu-id="a67ed-160">**IPropertySetStorage：： Create**</span><span class="sxs-lookup"><span data-stu-id="a67ed-160">**IPropertySetStorage::Create**</span></span>](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create)
</dt> <dt>

[<span data-ttu-id="a67ed-161">**IPropertySetStorage：： Open**</span><span class="sxs-lookup"><span data-stu-id="a67ed-161">**IPropertySetStorage::Open**</span></span>](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-open)
</dt> <dt>

[<span data-ttu-id="a67ed-162">**PropStgNameToFmtId**</span><span class="sxs-lookup"><span data-stu-id="a67ed-162">**PropStgNameToFmtId**</span></span>](/windows/desktop/api/coml2api/nf-coml2api-propstgnametofmtid)
</dt> <dt>

[<span data-ttu-id="a67ed-163">**StgCreatePropSetStg**</span><span class="sxs-lookup"><span data-stu-id="a67ed-163">**StgCreatePropSetStg**</span></span>](/windows/desktop/api/coml2api/nf-coml2api-stgcreatepropsetstg)
</dt> <dt>

[<span data-ttu-id="a67ed-164">**StgCreatePropStg**</span><span class="sxs-lookup"><span data-stu-id="a67ed-164">**StgCreatePropStg**</span></span>](/windows/desktop/api/coml2api/nf-coml2api-stgcreatepropstg)
</dt> <dt>

[<span data-ttu-id="a67ed-165">**StgOpenPropStg**</span><span class="sxs-lookup"><span data-stu-id="a67ed-165">**StgOpenPropStg**</span></span>](/windows/desktop/api/coml2api/nf-coml2api-stgopenpropstg)
</dt> </dl>

 

