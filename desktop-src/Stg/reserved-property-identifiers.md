---
title: 保留的屬性識別碼
description: 保留的屬性識別碼不能用來做為 (識別碼) 的屬性識別碼。 除了0、1和任何大於或等於、0x80000000 的值之外，您還可以使用任何屬性識別碼 (識別碼) 。 這些屬性識別碼值已保留供應用程式使用。
ms.assetid: d313a7b1-4cac-41f8-ba38-bf9cfaeb9d5c
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 05053fd2a31a5e8ceec63420e74884484abef12d44dcfe3e7023c81b5e67e27a
ms.sourcegitcommit: e6600f550f79bddfe58bd4696ac50dd52cb03d7e
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/11/2021
ms.locfileid: "119683058"
---
# <a name="reserved-property-identifiers"></a>保留的屬性識別碼

保留的屬性識別碼不能用來做為 (識別碼) 的屬性識別碼。 除了0、1和任何大於或等於、0x80000000 的值之外，您還可以使用任何屬性識別碼 (識別碼) 。 這些屬性識別碼值已保留供應用程式使用。

下表列出保留的屬性識別碼，以及屬性識別碼保留的描述。



| 保留的屬性識別碼 | 描述                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|----------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 0                    | 保留以建立選擇性的 [屬性集顯示名稱字典](property-set-display-name-dictionary.md)。 這可讓屬性設定使用者將意義附加至屬性，而不是由類型指標所提供的屬性。                                                                                                                                                                                                                                                                                                                                                                |
| 1                    | 保留為字碼頁的指標 (Windows) 或腳本 (Macintosh) ，以在解讀屬性集中的字串時使用。<br/> 屬性集中的所有字串值都必須以相同的字碼頁儲存。 屬性集標頭中的原始作業系統值 (PROPERTYSETHEADER：:d wosver) 決定字碼頁指標是否對應至 Windows 字碼頁或 Macintosh 腳本。<br/>                                                                                                                                                        |
| 0x80000000           | 保留作為屬性集所寫入之地區設定的指示。<br/> 屬性集的預設地區設定是 (地區設定 \_ 系統預設) 的系統預設地區設定 \_ 。 如需地區設定 \_ 系統預設值的詳細資訊 \_ ，請參閱 Win32 api。 當地區設定指示器不存在於屬性集內時，會使用預設值。<br/>                                                                                                                                                                                                                        |
| 0x80000003           | 保留為屬性集行為的指標。 這個屬性識別碼值是 VT \_ UI4，開頭為 **dword** 資料類型，其中包含值 VT \_ UI4，後面接著表示屬性集行為的 **dword** 。<br/> 目前，此值中所定義的唯一位是低序位位 (0x1) 。 如果設定此位，它會指出屬性識別碼為0所表示的屬性集名稱，應該視為區分大小寫。 如果未設定此位，或 (識別碼 0x80000003) 的行為屬性不存在，則應該將名稱視為不區分大小寫。<br/> |
| 0xFFFFFFFF           | 保留以方便程式設計。 它永遠不會出現在序列化的屬性集中。<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |



 

具有較高位設定的屬性識別碼 (也就是，負值) 保留給 Microsoft 未來使用的值。

在保留的屬性中，識別碼值在0xBFFFFFFF 範圍中的識別碼值，會被不了解其意義的實作為唯讀。 例如，如果執行不了解屬性0x80000000 的意義，則應該允許讀取該屬性，但不能寫入或刪除。 這類的實應允許0xC0000000 範圍中的屬性0xFFFFFFFE 為讀取、寫入或刪除。 屬性識別碼0xFFFFFFFF 是保留值，而且不應該出現在序列化的屬性集中。

## <a name="property-set-locale"></a>屬性集地區設定

應用程式可以選擇支援地區設定，或使用預設行為。 建議應用程式允許使用者指定工作地區設定。 這類應用程式應該將使用者指定的地區設定識別碼寫入屬性。 使用使用者預設地區設定 (地區設定 \_ 使用者預設) 的應用程式 \_ 應該將使用者預設地區設定識別碼寫入屬性。 如需地區設定 \_ 使用者預設值的詳細資訊 \_ ，請參閱 WIN32 API。

> [!Note]  
> 如果使用 [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) 介面來建立屬性集，則會自動將使用者預設地區設定寫入為地區設定指標。

 

應用程式也應該處理外部物件的案例，也就是地區設定不是應用程式地區設定、使用者地區設定或系統地區設定的情況。

地區設定指標屬性的類型為 VT \_ U14，因此是由包含 vt U14 的 **dword** 所組成 \_ ，後面接著包含地區設定識別碼 (LCID) 的 **dword** ，如 WIN32 API 中所定義。

## <a name="code-page-indicator"></a>字碼頁指標

當不是屬性集之作者的應用程式在集合中變更類型為 string 的屬性時，它應該會檢查字碼頁指標並採取下列其中一項動作：

-   以字碼頁指標所指定的格式來撰寫字串。
-   取代並重寫以變更字碼頁。

如果應用程式無法辨識這個指標，它就不應該修改屬性。 屬性集的所有建立者都必須撰寫字碼頁指標;但是，如果字碼頁指示器不存在，則必須假設讀者電腦上的主要字碼頁。

> [!Note]  
> 如果使用 [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) 介面來建立屬性集，則會自動寫入字碼頁指標。

 

WIN32 API 中會提供字碼頁的可能值 (如需詳細資訊，請參閱 [**GetACP**](/windows/desktop/api/winnls/nf-winnls-getacp) 函式) ，以及 *Macintosh Volume VI 內* 的頁面14-111。  (這些資源可能無法在某些語言及國家/地區使用。 ) 例如，「美國 ANSI」（code page US ANSI）會以十進位) 中的 0x04E4 (1252 來表示，而 Unicode 的字碼頁則是 0x04B0 (1200 in decimal) 。

建議您盡可能使用 Unicode 字碼頁，並使用 VT \_ LPWSTR 而非 vt \_ LPSTR，以避免在儲存和抓取期間使用多位元組 < > Unicode 轉換。 針對所有屬性集使用相同的字碼頁，是在全球達成互通屬性集的唯一方法。 在 Unicode 或非 Unicode 字碼頁中，請注意 VT \_ LPSTR 或 vt BSTR 開頭的計數 \_ 是 **位元組** 計數而非 **字元** 計數。 此位元組計數包含字串結尾的一或兩個零位元組 (字串) 的 **Null** 結束字元。

屬性識別碼1是 VT \_ i2 型別，以包含值 VT i2 的 **DWORD** 開頭， \_ 後面接著指出字碼頁的 **縮寫** 。

 

