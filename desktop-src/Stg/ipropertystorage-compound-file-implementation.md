---
title: IPropertyStorage-Compound 檔案的執行
description: 結構化儲存體架構的 COM 實作為所謂的複合檔案。
ms.assetid: c4b4f313-de58-44f2-8ce1-a07cc187d8ca
keywords:
- IPropertyStorage Strctd Stg.、執行、複合檔案
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 03d927b0145077f12e5ba508ca65554ca33633a3
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/20/2020
ms.locfileid: "103842423"
---
# <a name="ipropertystorage-compound-file-implementation"></a><span data-ttu-id="a33ce-104">IPropertyStorage-Compound 檔案的執行</span><span class="sxs-lookup"><span data-stu-id="a33ce-104">IPropertyStorage-Compound File Implementation</span></span>

<span data-ttu-id="a33ce-105">結構化儲存體架構的 COM 實作為所謂的 [複合檔案](istorage-compound-file-implementation.md)。</span><span class="sxs-lookup"><span data-stu-id="a33ce-105">The COM implementation of the Structured Storage architecture is called [compound files](istorage-compound-file-implementation.md).</span></span> <span data-ttu-id="a33ce-106">在複合檔案中執行的儲存物件包括兩個 [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage)的實作為：管理單一持續性屬性集的介面，以及管理持續性屬性集群組的介面 [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage)。</span><span class="sxs-lookup"><span data-stu-id="a33ce-106">Storage objects as implemented in compound files include an implementation of both [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage), the interface that manages a single persistent property set, and [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage), the interface that manages groups of persistent property sets.</span></span> <span data-ttu-id="a33ce-107">如需 **IPropertyStorage** 介面的詳細資訊，請參閱 **IPropertyStorage** 和 [屬性儲存體考慮](property-storage-considerations.md)。</span><span class="sxs-lookup"><span data-stu-id="a33ce-107">For more information about the **IPropertyStorage** interface, see **IPropertyStorage** and [Property Storage Considerations](property-storage-considerations.md).</span></span>

<span data-ttu-id="a33ce-108">若要取得 [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage)的複合檔案執行指標，請呼叫 [**StgCreateStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatestorageex) 來建立新的複合檔案物件或 [**StgOpenStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorageex) ，以開啟先前建立的複合檔案物件。</span><span class="sxs-lookup"><span data-stu-id="a33ce-108">To get a pointer to the compound file implementation of [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage), call [**StgCreateStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatestorageex) to create a new compound file object or [**StgOpenStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorageex) to open a previously created compound file object.</span></span> <span data-ttu-id="a33ce-109">在 **StgCreateStorageEx** 的案例中， *stgfmt* 參數應設為 stgfmt \_ 儲存體。</span><span class="sxs-lookup"><span data-stu-id="a33ce-109">In the case of **StgCreateStorageEx**, the *stgfmt* parameter should be set to STGFMT\_STORAGE.</span></span> <span data-ttu-id="a33ce-110">在 **StgOpenStorageEx** 的案例中， *stgfmt* 參數應設定為 stgfmt \_ 儲存體或 stgfmt \_ ANY。</span><span class="sxs-lookup"><span data-stu-id="a33ce-110">In the case of **StgOpenStorageEx**, the *stgfmt* parameter should be set to STGFMT\_STORAGE or STGFMT\_ANY.</span></span> <span data-ttu-id="a33ce-111">在這兩種情況下，會將 *riid* 參數設定為 IID \_ IPropertySetStorage。</span><span class="sxs-lookup"><span data-stu-id="a33ce-111">In both cases, the *riid* parameter should be set to IID\_IPropertySetStorage.</span></span> <span data-ttu-id="a33ce-112">這兩個函數都會提供物件 [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) 介面的指標。</span><span class="sxs-lookup"><span data-stu-id="a33ce-112">Both functions supply a pointer to the object [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) interface.</span></span> <span data-ttu-id="a33ce-113">藉由呼叫該介面的 [**Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create) 或 [**Open**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-open) 方法，您將會取得 **IPropertyStorage** 介面的指標，您可以用它來呼叫其任何方法。</span><span class="sxs-lookup"><span data-stu-id="a33ce-113">By calling either the [**Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create) or [**Open**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-open) method of that interface, you will get a pointer to the **IPropertyStorage** interface, which you can use to call any of its methods.</span></span>

<span data-ttu-id="a33ce-114">若要取得 [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) 的複合檔案執行指標，另一種方式是呼叫較舊的 [**StgCreateDocfile**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatedocfile) 和 [**StgOpenStorage**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorage) 函式，或將 IID IStorage 的 *riid* 參數指定 \_ 至 [**StgCreateStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatestorageex) 或 [**StgOpenStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorageex) 函數。</span><span class="sxs-lookup"><span data-stu-id="a33ce-114">An alternative way to get a pointer to the compound file implementation of [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) is to call the older [**StgCreateDocfile**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatedocfile) and [**StgOpenStorage**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorage) functions, or to specify an *riid* parameter of IID\_IStorage to the [**StgCreateStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatestorageex) or [**StgOpenStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorageex) function.</span></span> <span data-ttu-id="a33ce-115">在任一種情況下，都會傳回物件之 [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) 介面的指標。</span><span class="sxs-lookup"><span data-stu-id="a33ce-115">In either case, a pointer to the object's [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) interface is returned.</span></span> <span data-ttu-id="a33ce-116">使用持續性屬性集，呼叫 **IPropertySetStorage** 介面的 [**QueryInterface**](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) ，指定介面識別碼的標頭定義名稱 (iid) iid \_ IPropertySetStorage。</span><span class="sxs-lookup"><span data-stu-id="a33ce-116">With persistent property sets, call [**QueryInterface**](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) for the **IPropertySetStorage** interface, specifying the header-defined name for the interface identifier (IID) IID\_IPropertySetStorage.</span></span>

## <a name="when-to-use"></a><span data-ttu-id="a33ce-117">使用時機</span><span class="sxs-lookup"><span data-stu-id="a33ce-117">When to Use</span></span>

<span data-ttu-id="a33ce-118">使用 [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) 來管理單一屬性集內的屬性。</span><span class="sxs-lookup"><span data-stu-id="a33ce-118">Use [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) to manage properties within a single property set.</span></span> <span data-ttu-id="a33ce-119">其方法支援讀取、寫入和刪除屬性，以及可與屬性識別碼相關聯的選擇性字串名稱。</span><span class="sxs-lookup"><span data-stu-id="a33ce-119">Its methods support reading, writing, and deleting both properties and the optional string names that can be associated with property identifiers.</span></span> <span data-ttu-id="a33ce-120">其他方法支援標準認可和還原儲存體作業。</span><span class="sxs-lookup"><span data-stu-id="a33ce-120">Other methods support the standard commit and revert storage operations.</span></span> <span data-ttu-id="a33ce-121">另外還有一種方法，可讓您設定與屬性儲存相關聯的時間，另一種方法則允許指派可以用來將其他程式碼（例如使用者介面程式碼）與屬性集相關聯的 CLSID。</span><span class="sxs-lookup"><span data-stu-id="a33ce-121">There is also a method that enables you to set times associated with the property storage, and another that permits the assignment of a CLSID that can be used to associate other code, such as user interface code, with the property set.</span></span> <span data-ttu-id="a33ce-122">呼叫 [**Enum**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-enum) 方法會提供 [**IEnumSTATPROPSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg)的複合檔案執行指標，可讓您列舉集合中的屬性。</span><span class="sxs-lookup"><span data-stu-id="a33ce-122">Calling the [**Enum**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-enum) method supplies a pointer to the compound file implementation of [**IEnumSTATPROPSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg), which allows you to enumerate the properties in the set.</span></span>

> [!Note]  
> <span data-ttu-id="a33ce-123">如果您在簡單模式的屬性集儲存體上呼叫 [**StgCreateDocfile**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatedocfile)、 [**StgCreateStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatestorageex)、 [**StgOpenStorage**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorage)或 [**StgOpenStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorageex)來取得 [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage)的指標， **IPropertyStorage** 方法會遵守簡單模式資料流程的規則。</span><span class="sxs-lookup"><span data-stu-id="a33ce-123">If you obtain a pointer to [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) by calling [**StgCreateDocfile**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatedocfile), [**StgCreateStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatestorageex), [**StgOpenStorage**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorage) or [**StgOpenStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorageex) on a simple-mode property set storage, the **IPropertyStorage** methods adhere to the rules of simple-mode streams.</span></span> <span data-ttu-id="a33ce-124">如果是針對以 STGM simple 旗標建立或開啟的檔案取得該檔案，則該屬性集會儲存為簡單模式 \_ 。</span><span class="sxs-lookup"><span data-stu-id="a33ce-124">The property set storage is simple mode if it was obtained for a file that was created or opened with the STGM\_SIMPLE flag.</span></span> <span data-ttu-id="a33ce-125">在此情況下，不一定能讓基礎資料流程變得更大，也無法以較大的屬性取代現有的屬性。</span><span class="sxs-lookup"><span data-stu-id="a33ce-125">In this case, it is not always possible to make the underlying stream larger and it is not possible to replace existing properties with larger properties.</span></span> <span data-ttu-id="a33ce-126">如需詳細資訊，請參閱 [IPropertySetStorage 複合檔案執行](ipropertysetstorage-compound-file-implementation.md)。</span><span class="sxs-lookup"><span data-stu-id="a33ce-126">For more information, see [IPropertySetStorage-Compound File Implementation](ipropertysetstorage-compound-file-implementation.md).</span></span>

 

## <a name="ipropertystorage-and-caching"></a><span data-ttu-id="a33ce-127">IPropertyStorage 和快取</span><span class="sxs-lookup"><span data-stu-id="a33ce-127">IPropertyStorage and Caching</span></span>

<span data-ttu-id="a33ce-128">[**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage)的複合檔案執行會將開啟的屬性集快取在記憶體中，以改善效能。</span><span class="sxs-lookup"><span data-stu-id="a33ce-128">The compound file implementation of [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) caches open property sets in memory in order to improve performance.</span></span> <span data-ttu-id="a33ce-129">如此一來，就不會將屬性集的變更寫入至複合檔案，直到呼叫) 方法的 [**Commit**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-commit) 或 **Release** (最後一個參考為止。</span><span class="sxs-lookup"><span data-stu-id="a33ce-129">As a result, changes to a property set are not written to the compound file until the [**Commit**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-commit) or **Release** (last reference) methods are called.</span></span>

## <a name="simple-mode-property-sets"></a><span data-ttu-id="a33ce-130">簡單模式屬性集</span><span class="sxs-lookup"><span data-stu-id="a33ce-130">Simple Mode Property Sets</span></span>

<span data-ttu-id="a33ce-131">如果屬性儲存物件是從簡單模式屬性集儲存物件建立，則為簡單模式。</span><span class="sxs-lookup"><span data-stu-id="a33ce-131">A property storage object is in simple mode if it is created from a simple mode property set storage object.</span></span> <span data-ttu-id="a33ce-132">例如，如果從 [**StgOpenStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorageex) 函式取得屬性集的儲存物件，並在 \_ *GRFMODE* 參數中設定 STGM 簡單旗標，則會處於簡單模式。</span><span class="sxs-lookup"><span data-stu-id="a33ce-132">For example, a property set storage object would be in simple mode if it were obtained from the [**StgOpenStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorageex) function, with the STGM\_SIMPLE flag set in the *grfMode* parameter.</span></span> <span data-ttu-id="a33ce-133">請注意，「簡單模式」與「簡單屬性集」無關。</span><span class="sxs-lookup"><span data-stu-id="a33ce-133">Note that "simple mode" is unrelated to "simple property sets".</span></span> <span data-ttu-id="a33ce-134">如果透過呼叫 [**IPropertySetStorage：： Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create) 和 \_ *grfFlags* 參數中所設定的 PROPSETFLAG 簡單旗標，來建立屬性集，則會很簡單。</span><span class="sxs-lookup"><span data-stu-id="a33ce-134">A property set is simple if it is created by calling [**IPropertySetStorage::Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create) with the PROPSETFLAG\_NONSIMPLE flag set in the *grfFlags* parameter.</span></span> <span data-ttu-id="a33ce-135">如需簡單和簡單屬性集的詳細資訊，請參閱 [屬性集的儲存和資料流程物件](storage-vs--stream-for-a-property-set.md)。</span><span class="sxs-lookup"><span data-stu-id="a33ce-135">For more information about simple and nonsimple property sets, see [Storage and Stream Objects for a Property Set](storage-vs--stream-for-a-property-set.md).</span></span>

<span data-ttu-id="a33ce-136">當您建立簡單模式屬性儲存物件時，它的使用沒有任何限制。</span><span class="sxs-lookup"><span data-stu-id="a33ce-136">When a simple mode property storage object is created, there are no restrictions on its use.</span></span> <span data-ttu-id="a33ce-137">開啟現有的簡單模式屬性儲存物件時，無法成長儲存屬性集的基礎資料流程物件。</span><span class="sxs-lookup"><span data-stu-id="a33ce-137">When an existing simple-mode property storage object is opened, the underlying stream object that stores the property set cannot be grown.</span></span> <span data-ttu-id="a33ce-138">因此，如果變更需要較大的資料流程，就不一定能夠修改這類的屬性儲存物件。</span><span class="sxs-lookup"><span data-stu-id="a33ce-138">Consequently, it is not always possible to modify such a property storage object if the change requires a larger stream.</span></span>

## <a name="property-set-formats"></a><span data-ttu-id="a33ce-139">屬性集格式</span><span class="sxs-lookup"><span data-stu-id="a33ce-139">Property Set Formats</span></span>

<span data-ttu-id="a33ce-140">[**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage)的複合檔案執行同時支援 version 0 和 version 1 property set 序列化格式。</span><span class="sxs-lookup"><span data-stu-id="a33ce-140">The compound file implementation of [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) supports both the version 0 and the version 1 property set serialization formats.</span></span> <span data-ttu-id="a33ce-141">在 Windows 2000 上執行的電腦上支援第1版的格式。</span><span class="sxs-lookup"><span data-stu-id="a33ce-141">The version 1 format is supported on computers running on Windows 2000.</span></span> <span data-ttu-id="a33ce-142">如需詳細資訊，請參閱 [屬性集序列化](version-0-vs--version-1-property-set-serialization.md)。</span><span class="sxs-lookup"><span data-stu-id="a33ce-142">For more information, see [Property Set Serialization](version-0-vs--version-1-property-set-serialization.md).</span></span> <span data-ttu-id="a33ce-143">除非要求新功能，否則會以 version 0 格式建立屬性集，並保留該格式。</span><span class="sxs-lookup"><span data-stu-id="a33ce-143">Property sets are created in version 0 format and remain in that format unless new features are requested.</span></span> <span data-ttu-id="a33ce-144">發生這種情況時，格式會更新為第1版。</span><span class="sxs-lookup"><span data-stu-id="a33ce-144">When that occurs, the format is updated to version 1.</span></span>

<span data-ttu-id="a33ce-145">例如，如果使用 PROPSETFLAG 預設旗標建立屬性集 \_ ，其格式為0版。</span><span class="sxs-lookup"><span data-stu-id="a33ce-145">For example, if a property set is created with the PROPSETFLAG\_DEFAULT flag, its format is version 0.</span></span> <span data-ttu-id="a33ce-146">只要符合版本0格式的屬性類型會寫入至該屬性集並從該屬性集讀取，屬性集會維持為版本0格式。</span><span class="sxs-lookup"><span data-stu-id="a33ce-146">As long as property types that conform to the version 0 format are written to and read from that property set, the property set remains in version 0 format.</span></span> <span data-ttu-id="a33ce-147">如果第1版屬性類型寫入屬性集，屬性集會自動更新為第1版。</span><span class="sxs-lookup"><span data-stu-id="a33ce-147">If a version 1 property type is written to the property set, the property set is automatically updated to version 1.</span></span> <span data-ttu-id="a33ce-148">之後，只能辨識版本0的執行程式無法再讀取該屬性集。</span><span class="sxs-lookup"><span data-stu-id="a33ce-148">Subsequently, that property set can no longer be read by implementations that recognize only version 0.</span></span>

## <a name="ipropertystorage-and-variant-types"></a><span data-ttu-id="a33ce-149">IPropertyStorage 和 Variant 類型</span><span class="sxs-lookup"><span data-stu-id="a33ce-149">IPropertyStorage and Variant Types</span></span>

<span data-ttu-id="a33ce-150">[**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage)的複合檔案執行不支援在 \_ \_ [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant)結構的 **vt** 成員中，以 vt 未知或 vt 的 variant 類型。</span><span class="sxs-lookup"><span data-stu-id="a33ce-150">The compound file implementation of [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) does not support the variant types VT\_UNKNOWN or VT\_DISPATCH in the **vt** member of the [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) structure.</span></span>

<span data-ttu-id="a33ce-151">下表列出 SafeArray 內支援的 variant 類型。也就是說，這些值可以與 \_ [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant)結構的 **VT** 成員中的 vt 陣列合併。</span><span class="sxs-lookup"><span data-stu-id="a33ce-151">The following table lists variant types that are supported within a SafeArray; that is, these values can be combined with VT\_ARRAY in the **vt** member of the [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) structure.</span></span>



<span data-ttu-id="a33ce-152">IPropertyStorage 的複合檔案執行在 SafeArray 內支援的 Variant 類型</span><span class="sxs-lookup"><span data-stu-id="a33ce-152">Variant types supported within SafeArray by compound file implementation of IPropertyStorage</span></span>

<span data-ttu-id="a33ce-153">VT \_ I1</span><span class="sxs-lookup"><span data-stu-id="a33ce-153">VT\_I1</span></span>

<span data-ttu-id="a33ce-154">VT \_ UI1</span><span class="sxs-lookup"><span data-stu-id="a33ce-154">VT\_UI1</span></span>

<span data-ttu-id="a33ce-155">VT \_ I2</span><span class="sxs-lookup"><span data-stu-id="a33ce-155">VT\_I2</span></span>

<span data-ttu-id="a33ce-156">VT \_ UI2</span><span class="sxs-lookup"><span data-stu-id="a33ce-156">VT\_UI2</span></span>

<span data-ttu-id="a33ce-157">VT \_ I4</span><span class="sxs-lookup"><span data-stu-id="a33ce-157">VT\_I4</span></span>

<span data-ttu-id="a33ce-158">VT \_ UI4</span><span class="sxs-lookup"><span data-stu-id="a33ce-158">VT\_UI4</span></span>

<span data-ttu-id="a33ce-159">VT \_ INT</span><span class="sxs-lookup"><span data-stu-id="a33ce-159">VT\_INT</span></span>

<span data-ttu-id="a33ce-160">VT \_ UINT</span><span class="sxs-lookup"><span data-stu-id="a33ce-160">VT\_UINT</span></span>

<span data-ttu-id="a33ce-161">VT \_ R4</span><span class="sxs-lookup"><span data-stu-id="a33ce-161">VT\_R4</span></span>

<span data-ttu-id="a33ce-162">VT \_ R8</span><span class="sxs-lookup"><span data-stu-id="a33ce-162">VT\_R8</span></span>

<span data-ttu-id="a33ce-163">VT \_ CY</span><span class="sxs-lookup"><span data-stu-id="a33ce-163">VT\_CY</span></span>

<span data-ttu-id="a33ce-164">VT \_ 日期</span><span class="sxs-lookup"><span data-stu-id="a33ce-164">VT\_DATE</span></span>

<span data-ttu-id="a33ce-165">VT \_ BSTR</span><span class="sxs-lookup"><span data-stu-id="a33ce-165">VT\_BSTR</span></span>

<span data-ttu-id="a33ce-166">VT \_ BOOL</span><span class="sxs-lookup"><span data-stu-id="a33ce-166">VT\_BOOL</span></span>

<span data-ttu-id="a33ce-167">VT \_ DECIMAL</span><span class="sxs-lookup"><span data-stu-id="a33ce-167">VT\_DECIMAL</span></span>

<span data-ttu-id="a33ce-168">VT \_ 錯誤</span><span class="sxs-lookup"><span data-stu-id="a33ce-168">VT\_ERROR</span></span>

<span data-ttu-id="a33ce-169">VT \_ 變異</span><span class="sxs-lookup"><span data-stu-id="a33ce-169">VT\_VARIANT</span></span>

 



 

<span data-ttu-id="a33ce-170">當 VT \_ VARIANT 與 vt 陣列合併時 \_ ，SafeArray 本身會保存 [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) 結構。</span><span class="sxs-lookup"><span data-stu-id="a33ce-170">When VT\_VARIANT is combined with VT\_ARRAY, the SafeArray itself holds [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) structures.</span></span> <span data-ttu-id="a33ce-171">不過，這些元素的類型必須取自上述清單，不能是 VT \_ 變異，也不能包含 vt \_ 向量、vt \_ 陣列或 vt \_ BYREF 指標。</span><span class="sxs-lookup"><span data-stu-id="a33ce-171">However, the types of these elements must be taken from the preceding list, cannot be VT\_VARIANT, and cannot include the VT\_VECTOR, VT\_ARRAY, or VT\_BYREF indicators.</span></span>

## <a name="ipropertystorage-methods"></a><span data-ttu-id="a33ce-172">IPropertyStorage 方法</span><span class="sxs-lookup"><span data-stu-id="a33ce-172">IPropertyStorage Methods</span></span>

<span data-ttu-id="a33ce-173">[**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage)的複合檔案執行支援下列方法：</span><span class="sxs-lookup"><span data-stu-id="a33ce-173">The compound file implementation of [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) supports the following methods:</span></span>

<dl> <dt>

<span data-ttu-id="a33ce-174"><span id="IPropertyStorage__ReadMultiple"></span><span id="ipropertystorage__readmultiple"></span><span id="IPROPERTYSTORAGE__READMULTIPLE"></span>[**IPropertyStorage::ReadMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-readmultiple)</span><span class="sxs-lookup"><span data-stu-id="a33ce-174"><span id="IPropertyStorage__ReadMultiple"></span><span id="ipropertystorage__readmultiple"></span><span id="IPROPERTYSTORAGE__READMULTIPLE"></span>[**IPropertyStorage::ReadMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-readmultiple)</span></span>
</dt> <dd>

<span data-ttu-id="a33ce-175">讀取 *rgpspec* 陣列中所指定的屬性，並在 PROPVARIANTs 的 *rgvar* 陣列中提供所有有效屬性的值。</span><span class="sxs-lookup"><span data-stu-id="a33ce-175">Reads the properties specified in the *rgpspec* array and supplies the values of all valid properties in the *rgvar* array of PROPVARIANTs.</span></span> <span data-ttu-id="a33ce-176">在 COM 複合檔案執行中，參考資料流或儲存體類型的重複屬性識別碼會導致多個對 [**IStorage：： OpenStream**](/windows/desktop/api/Objidl/nf-objidl-istorage-openstream) 或 [**IStorage：： OpenStorage**](/windows/desktop/api/Objidl/nf-objidl-istorage-openstorage) 的呼叫，而 **ReadMultiple** 的成功或失敗取決於基礎儲存體實作為共用開啟作業的能力。</span><span class="sxs-lookup"><span data-stu-id="a33ce-176">In the COM compound file implementation, duplicate property identifiers that refer to stream or storage types result in multiple calls to [**IStorage::OpenStream**](/windows/desktop/api/Objidl/nf-objidl-istorage-openstream) or [**IStorage::OpenStorage**](/windows/desktop/api/Objidl/nf-objidl-istorage-openstorage) and the success or failure of **ReadMultiple** depends on the underlying storage implementation's ability to share opening operations.</span></span> <span data-ttu-id="a33ce-177">因為在複合檔案 STGM 中 \_ ，會強制執行共用 \_ 獨佔，所以多次開啟嘗試將會失敗。</span><span class="sxs-lookup"><span data-stu-id="a33ce-177">Because in a compound file STGM\_SHARE\_EXCLUSIVE is forced, multiple open attempts will fail.</span></span> <span data-ttu-id="a33ce-178">不支援從相同的父儲存體多次開啟相同的儲存物件。</span><span class="sxs-lookup"><span data-stu-id="a33ce-178">Opening the same storage object more than once from the same parent storage is not supported.</span></span> <span data-ttu-id="a33ce-179">\_ \_ 必須指定 STGM 共用專屬旗標。</span><span class="sxs-lookup"><span data-stu-id="a33ce-179">The STGM\_SHARE\_EXCLUSIVE flag must be specified.</span></span>

<span data-ttu-id="a33ce-180">此外，為了確保安全線程作業，如果相同的資料流程或儲存值屬性是透過 COM 複合檔案執行中的相同 [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) 指標來要求數次，則開啟作業將會成功或失敗，取決於屬性是否已開啟，以及基礎檔案系統是否處理資料流程或儲存體的多重進入。</span><span class="sxs-lookup"><span data-stu-id="a33ce-180">In addition, to ensure thread-safe operation if the same stream- or storage-valued property is requested several times through the same [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) pointer in the COM compound file implementation, the open operation will succeed or fail depending on whether the property is already open and whether the underlying file system handles multiple openings of a stream or storage.</span></span> <span data-ttu-id="a33ce-181">因此，在資料流程或儲存值屬性上的 **ReadMultiple** 作業一律會導致呼叫 [**IStorage：： OpenStream**](/windows/desktop/api/Objidl/nf-objidl-istorage-openstream)或 [**IStorage：： OpenStorage**](/windows/desktop/api/Objidl/nf-objidl-istorage-openstorage)，此呼叫會將 access (STGM \_ READWRITE，依此類推，) 和共用旗標 (STGM \_ 共用 \_ 獨佔，以及在原始屬性集開啟或建立時所指定的) 。</span><span class="sxs-lookup"><span data-stu-id="a33ce-181">Thus, the **ReadMultiple** operation on a stream- or storage-valued property always results in a call to [**IStorage::OpenStream**](/windows/desktop/api/Objidl/nf-objidl-istorage-openstream), or [**IStorage::OpenStorage**](/windows/desktop/api/Objidl/nf-objidl-istorage-openstorage), which passes the access (STGM\_READWRITE, and so forth) and share flags (STGM\_SHARE\_EXCLUSIVE, and so on) specified when the original property set was opened or created.</span></span>

<span data-ttu-id="a33ce-182">如果方法失敗，寫入 *rgvar* 的值 \[ \] 就不會定義。</span><span class="sxs-lookup"><span data-stu-id="a33ce-182">If the method fails, the values written to *rgvar*\[\] are undefined.</span></span> <span data-ttu-id="a33ce-183">如果已成功開啟部分資料流程或儲存值屬性，但執行完成之前發生錯誤，則應該在方法傳回之前釋放。</span><span class="sxs-lookup"><span data-stu-id="a33ce-183">If some stream- or storage-valued properties are opened successfully but an error occurs before execution is complete, these should be released before the method returns.</span></span>

</dd> <dt>

<span data-ttu-id="a33ce-184"><span id="IPropertyStorage__WriteMultiple"></span><span id="ipropertystorage__writemultiple"></span><span id="IPROPERTYSTORAGE__WRITEMULTIPLE"></span>[**IPropertyStorage::WriteMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-writemultiple)</span><span class="sxs-lookup"><span data-stu-id="a33ce-184"><span id="IPropertyStorage__WriteMultiple"></span><span id="ipropertystorage__writemultiple"></span><span id="IPROPERTYSTORAGE__WRITEMULTIPLE"></span>[**IPropertyStorage::WriteMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-writemultiple)</span></span>
</dt> <dd>

<span data-ttu-id="a33ce-185">寫入 *rgpspec* 陣列中指定的屬性 \[ \] ，並將 *rgvar* 中指定的 [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant)標記和值指派給它們 \[ \] 。</span><span class="sxs-lookup"><span data-stu-id="a33ce-185">Writes the properties specified in the *rgpspec*\[\] array, assigning them the [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) tags and values specified in *rgvar*\[\].</span></span> <span data-ttu-id="a33ce-186">已存在的屬性會指派指定的 **PROPVARIANT** 值。</span><span class="sxs-lookup"><span data-stu-id="a33ce-186">Properties that already exist are assigned the specified **PROPVARIANT** values.</span></span> <span data-ttu-id="a33ce-187">目前不存在的屬性會建立。</span><span class="sxs-lookup"><span data-stu-id="a33ce-187">Properties that do not currently exist are created.</span></span>

</dd> <dt>

<span data-ttu-id="a33ce-188"><span id="IPropertyStorage__DeleteMultiple"></span><span id="ipropertystorage__deletemultiple"></span><span id="IPROPERTYSTORAGE__DELETEMULTIPLE"></span>[**IPropertyStorage：:D eleteMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-deletemultiple)</span><span class="sxs-lookup"><span data-stu-id="a33ce-188"><span id="IPropertyStorage__DeleteMultiple"></span><span id="ipropertystorage__deletemultiple"></span><span id="IPROPERTYSTORAGE__DELETEMULTIPLE"></span>[**IPropertyStorage::DeleteMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-deletemultiple)</span></span>
</dt> <dd>

<span data-ttu-id="a33ce-189">刪除在 *rgpspec* 中指定的屬性 \[ \] 。</span><span class="sxs-lookup"><span data-stu-id="a33ce-189">Deletes the properties specified in the *rgpspec*\[\].</span></span>

</dd> <dt>

<span data-ttu-id="a33ce-190"><span id="IPropertyStorage__ReadPropertyNames"></span><span id="ipropertystorage__readpropertynames"></span><span id="IPROPERTYSTORAGE__READPROPERTYNAMES"></span>[**IPropertyStorage::ReadPropertyNames**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-readpropertynames)</span><span class="sxs-lookup"><span data-stu-id="a33ce-190"><span id="IPropertyStorage__ReadPropertyNames"></span><span id="ipropertystorage__readpropertynames"></span><span id="IPROPERTYSTORAGE__READPROPERTYNAMES"></span>[**IPropertyStorage::ReadPropertyNames**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-readpropertynames)</span></span>
</dt> <dd>

<span data-ttu-id="a33ce-191">讀取與 *rgpropid* 陣列中所指定屬性識別碼相關聯的現有字串名稱 \[ \] 。</span><span class="sxs-lookup"><span data-stu-id="a33ce-191">Reads existing string names associated with the property IDs specified in the *rgpropid*\[\] array.</span></span>

</dd> <dt>

<span data-ttu-id="a33ce-192"><span id="IPropertyStorage__WritePropertyNames"></span><span id="ipropertystorage__writepropertynames"></span><span id="IPROPERTYSTORAGE__WRITEPROPERTYNAMES"></span>[**IPropertyStorage::WritePropertyNames**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-writepropertynames)</span><span class="sxs-lookup"><span data-stu-id="a33ce-192"><span id="IPropertyStorage__WritePropertyNames"></span><span id="ipropertystorage__writepropertynames"></span><span id="IPROPERTYSTORAGE__WRITEPROPERTYNAMES"></span>[**IPropertyStorage::WritePropertyNames**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-writepropertynames)</span></span>
</dt> <dd>

<span data-ttu-id="a33ce-193">將 *rglpwstrName* 陣列中指定的字串名稱指派給 *rgpropid* 陣列中所指定的屬性識別碼。</span><span class="sxs-lookup"><span data-stu-id="a33ce-193">Assigns string names specified in the *rglpwstrName* array to property IDs specified in the *rgpropid* array.</span></span>

</dd> <dt>

<span data-ttu-id="a33ce-194"><span id="IPropertyStorage__DeletePropertyNames"></span><span id="ipropertystorage__deletepropertynames"></span><span id="IPROPERTYSTORAGE__DELETEPROPERTYNAMES"></span>[**IPropertyStorage：:D eletePropertyNames**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-deletepropertynames)</span><span class="sxs-lookup"><span data-stu-id="a33ce-194"><span id="IPropertyStorage__DeletePropertyNames"></span><span id="ipropertystorage__deletepropertynames"></span><span id="IPROPERTYSTORAGE__DELETEPROPERTYNAMES"></span>[**IPropertyStorage::DeletePropertyNames**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-deletepropertynames)</span></span>
</dt> <dd>

<span data-ttu-id="a33ce-195">刪除 *rgpropid* 陣列中所指定屬性的屬性名稱 \[ \] 。</span><span class="sxs-lookup"><span data-stu-id="a33ce-195">Deletes property names for the properties specified in the *rgpropid*\[\] array.</span></span>

</dd> <dt>

<span data-ttu-id="a33ce-196"><span id="IPropertyStorage__SetClass"></span><span id="ipropertystorage__setclass"></span><span id="IPROPERTYSTORAGE__SETCLASS"></span>[**IPropertyStorage::SetClass**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-setclass)</span><span class="sxs-lookup"><span data-stu-id="a33ce-196"><span id="IPropertyStorage__SetClass"></span><span id="ipropertystorage__setclass"></span><span id="IPROPERTYSTORAGE__SETCLASS"></span>[**IPropertyStorage::SetClass**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-setclass)</span></span>
</dt> <dd>

<span data-ttu-id="a33ce-197">設定屬性集資料流程的 **CLSID** 。</span><span class="sxs-lookup"><span data-stu-id="a33ce-197">Sets the **CLSID** of the property set stream.</span></span> <span data-ttu-id="a33ce-198">在複合檔案執行中，在簡單屬性集上設定 CLSID (可以合法包含儲存區或資料流程值屬性（如 [**IPropertySetStorage：： Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create)) 中所述）也會在基礎 substorage 上設定 clsid，以便透過呼叫 [**IStorage：： Stat**](/windows/desktop/api/Objidl/nf-objidl-istorage-stat)來取得它。</span><span class="sxs-lookup"><span data-stu-id="a33ce-198">In the compound file implementation, setting the CLSID on a nonsimple property set (one that can legally contain storage- or stream-valued properties, as described in [**IPropertySetStorage::Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create)) also sets the CLSID on the underlying substorage so that it can be obtained through a call to [**IStorage::Stat**](/windows/desktop/api/Objidl/nf-objidl-istorage-stat).</span></span>

</dd> <dt>

<span data-ttu-id="a33ce-199"><span id="IPropertyStorage__Commit"></span><span id="ipropertystorage__commit"></span><span id="IPROPERTYSTORAGE__COMMIT"></span>[**IPropertyStorage：： Commit**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-commit)</span><span class="sxs-lookup"><span data-stu-id="a33ce-199"><span id="IPropertyStorage__Commit"></span><span id="ipropertystorage__commit"></span><span id="IPROPERTYSTORAGE__COMMIT"></span>[**IPropertyStorage::Commit**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-commit)</span></span>
</dt> <dd>

<span data-ttu-id="a33ce-200">針對簡單和簡單的屬性集，將屬性集記憶體影像排清到基礎儲存體。</span><span class="sxs-lookup"><span data-stu-id="a33ce-200">For both simple and nonsimple property sets, flushes the property set memory image to the underlying storage.</span></span> <span data-ttu-id="a33ce-201">此外，對於簡單交易模式屬性集，這個方法會在包含屬性集的儲存體上執行 commit (as in [**IStorage：： commit**](/windows/desktop/api/Objidl/nf-objidl-istorage-commit)) 。</span><span class="sxs-lookup"><span data-stu-id="a33ce-201">In addition, for nonsimple transacted-mode property sets, this method performs a commit (as in [**IStorage::Commit**](/windows/desktop/api/Objidl/nf-objidl-istorage-commit)) on the storage which contains the property set.</span></span>

</dd> <dt>

<span data-ttu-id="a33ce-202"><span id="IPropertyStorage__Revert"></span><span id="ipropertystorage__revert"></span><span id="IPROPERTYSTORAGE__REVERT"></span>[**IPropertyStorage：： Revert**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-revert)</span><span class="sxs-lookup"><span data-stu-id="a33ce-202"><span id="IPropertyStorage__Revert"></span><span id="ipropertystorage__revert"></span><span id="IPROPERTYSTORAGE__REVERT"></span>[**IPropertyStorage::Revert**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-revert)</span></span>
</dt> <dd>

<span data-ttu-id="a33ce-203">僅針對簡單屬性集，會呼叫基礎儲存體的 [**Revert**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-revert) 方法，並重新開啟「內容」資料流程。</span><span class="sxs-lookup"><span data-stu-id="a33ce-203">For nonsimple property sets only, calls the [**Revert**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-revert) method of the underlying storage and reopens the 'contents' stream.</span></span> <span data-ttu-id="a33ce-204">針對簡單的屬性集，這個介面一律會傳回 S \_ OK。</span><span class="sxs-lookup"><span data-stu-id="a33ce-204">For simple property sets, this interface always returns S\_OK.</span></span> <span data-ttu-id="a33ce-205">簡單屬性集是使用 \_ [**IPropertySetStorage：： Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create) 方法中的 PROPSETFLAG 簡單旗標所建立的屬性集。</span><span class="sxs-lookup"><span data-stu-id="a33ce-205">Nonsimple property sets are those which were created using the PROPSETFLAG\_NONSIMPLE flag in the [**IPropertySetStorage::Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create) method.</span></span> <span data-ttu-id="a33ce-206">如需詳細資訊，請參閱 [屬性集的儲存和資料流程物件](storage-vs--stream-for-a-property-set.md) 。</span><span class="sxs-lookup"><span data-stu-id="a33ce-206">For more information, see [Storage and Stream Objects for a Property Set](storage-vs--stream-for-a-property-set.md) .</span></span>

</dd> <dt>

<span data-ttu-id="a33ce-207"><span id="IPropertyStorage__Enum"></span><span id="ipropertystorage__enum"></span><span id="IPROPERTYSTORAGE__ENUM"></span>[**IPropertyStorage：： Enum**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-enum)</span><span class="sxs-lookup"><span data-stu-id="a33ce-207"><span id="IPropertyStorage__Enum"></span><span id="ipropertystorage__enum"></span><span id="IPROPERTYSTORAGE__ENUM"></span>[**IPropertyStorage::Enum**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-enum)</span></span>
</dt> <dd>

<span data-ttu-id="a33ce-208">會建立 [**IEnumSTATPROPSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg)的實例，您可以呼叫這些方法來列舉 [**STATPROPSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg) 結構，以提供集合中每個屬性的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="a33ce-208">Constructs an instance of [**IEnumSTATPROPSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg), the methods of which can be called to enumerate the [**STATPROPSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg) structures that provide information about each of the properties in the set.</span></span> <span data-ttu-id="a33ce-209">這項執行會建立一個陣列，以讀取整個屬性集，並在呼叫 **IEnumSTATPROPSTG：： Clone** 時共用。</span><span class="sxs-lookup"><span data-stu-id="a33ce-209">This implementation creates an array into which the entire property set is read and which can be shared when **IEnumSTATPROPSTG::Clone** is called.</span></span> <span data-ttu-id="a33ce-210">屬性集的變更不會反映在開啟的 **IEnumSTATPROPSTG** 實例中。</span><span class="sxs-lookup"><span data-stu-id="a33ce-210">Changes to the property set are not reflected in an open **IEnumSTATPROPSTG** instance.</span></span> <span data-ttu-id="a33ce-211">若要查看這類變更，必須建立此列舉值的新實例。</span><span class="sxs-lookup"><span data-stu-id="a33ce-211">To see such changes, a new instance of this enumerator must be constructed.</span></span>

</dd> <dt>

<span data-ttu-id="a33ce-212"><span id="IPropertyStorage__Stat"></span><span id="ipropertystorage__stat"></span><span id="IPROPERTYSTORAGE__STAT"></span>[**IPropertyStorage：： Stat**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-stat)</span><span class="sxs-lookup"><span data-stu-id="a33ce-212"><span id="IPropertyStorage__Stat"></span><span id="ipropertystorage__stat"></span><span id="IPROPERTYSTORAGE__STAT"></span>[**IPropertyStorage::Stat**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-stat)</span></span>
</dt> <dd>

<span data-ttu-id="a33ce-213">填入 [**STATPROPSETSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg) 結構的成員，其中包含整個屬性集的相關資料。</span><span class="sxs-lookup"><span data-stu-id="a33ce-213">Fills in the members of a [**STATPROPSETSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg) structure, which contains data about the property set as a whole.</span></span> <span data-ttu-id="a33ce-214">傳回時，提供結構的指標。</span><span class="sxs-lookup"><span data-stu-id="a33ce-214">On return, supplies a pointer to the structure.</span></span> <span data-ttu-id="a33ce-215">若為簡單儲存集，此實作為會呼叫 [**IStorage：： stat**](/windows/desktop/api/Objidl/nf-objidl-istorage-stat) (或 [**IStream：： stat**](/windows/desktop/api/Objidl/nf-objidl-istream-stat)) 從基礎儲存體或資料流程取得時間。</span><span class="sxs-lookup"><span data-stu-id="a33ce-215">For nonsimple storage sets, this implementation calls [**IStorage::Stat**](/windows/desktop/api/Objidl/nf-objidl-istorage-stat) (or [**IStream::Stat**](/windows/desktop/api/Objidl/nf-objidl-istream-stat)) to get the times from the underlying storage or stream.</span></span> <span data-ttu-id="a33ce-216">針對簡單的儲存集，將不會保留任何時間。</span><span class="sxs-lookup"><span data-stu-id="a33ce-216">For simple storage sets, no times are maintained.</span></span>

</dd> <dt>

<span data-ttu-id="a33ce-217"><span id="IPropertyStorage__SetTimes"></span><span id="ipropertystorage__settimes"></span><span id="IPROPERTYSTORAGE__SETTIMES"></span>[**IPropertyStorage::SetTimes**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-settimes)</span><span class="sxs-lookup"><span data-stu-id="a33ce-217"><span id="IPropertyStorage__SetTimes"></span><span id="ipropertystorage__settimes"></span><span id="IPROPERTYSTORAGE__SETTIMES"></span>[**IPropertyStorage::SetTimes**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-settimes)</span></span>
</dt> <dd>

<span data-ttu-id="a33ce-218">僅針對簡單屬性集，設定基礎儲存體所支援的時間。</span><span class="sxs-lookup"><span data-stu-id="a33ce-218">For nonsimple property sets only, sets the times supported by the underlying storage.</span></span> <span data-ttu-id="a33ce-219">複合檔案儲存體的執行支援全部三種：修改、存取和建立。</span><span class="sxs-lookup"><span data-stu-id="a33ce-219">The compound file storage implementation supports all three: modification, access, and creation.</span></span> <span data-ttu-id="a33ce-220">這項 [**SetTimes**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-settimes) 的執行會呼叫基礎儲存體的 [**IStorage：： SetElementTimes**](/windows/desktop/api/Objidl/nf-objidl-istorage-setelementtimes) 方法，以取得這些時間。</span><span class="sxs-lookup"><span data-stu-id="a33ce-220">This implementation of [**SetTimes**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-settimes) calls the [**IStorage::SetElementTimes**](/windows/desktop/api/Objidl/nf-objidl-istorage-setelementtimes) method of the underlying storage to retrieve these times.</span></span>

</dd> </dl>

## <a name="related-topics"></a><span data-ttu-id="a33ce-221">相關主題</span><span class="sxs-lookup"><span data-stu-id="a33ce-221">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="a33ce-222">**IPropertyStorage**</span><span class="sxs-lookup"><span data-stu-id="a33ce-222">**IPropertyStorage**</span></span>](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage)
</dt> <dt>

[<span data-ttu-id="a33ce-223">**IStorage：： SetElementTimes**</span><span class="sxs-lookup"><span data-stu-id="a33ce-223">**IStorage::SetElementTimes**</span></span>](/windows/desktop/api/Objidl/nf-objidl-istorage-setelementtimes)
</dt> </dl>

 

 