---
title: StoClien 總覽
description: StoClien 範例會示範用戶端如何使用結構化儲存體，以及它如何指示伺服器元件使用此儲存體。
ms.assetid: 1f540e0f-2189-4f45-aad3-9b4b56732907
keywords:
- StoClien 總覽
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: ee37f6f84cf981bda637abbd96ff8e8f0314d8ee
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 09/16/2019
ms.locfileid: "106969023"
---
# <a name="stoclien-overview"></a><span data-ttu-id="dc922-104">StoClien 總覽</span><span class="sxs-lookup"><span data-stu-id="dc922-104">StoClien Overview</span></span>

## <a name="purpose"></a><span data-ttu-id="dc922-105">目的</span><span class="sxs-lookup"><span data-stu-id="dc922-105">Purpose</span></span>

<span data-ttu-id="dc922-106">[StoClien](structured-storage-client-sample--stoclien-.md)範例的主要焦點是用戶端如何使用結構化的儲存體，以及它如何指示伺服器元件使用此儲存體。</span><span class="sxs-lookup"><span data-stu-id="dc922-106">The principal focus of the [StoClien](structured-storage-client-sample--stoclien-.md) sample is how the client uses structured storage and how it instructs a server component to use this storage.</span></span> <span data-ttu-id="dc922-107">StoClien 範例示範結構化儲存體服務的程式設計模型。</span><span class="sxs-lookup"><span data-stu-id="dc922-107">The StoClien sample demonstrates a programming model of structured storage services.</span></span>

## <a name="functionality"></a><span data-ttu-id="dc922-108">功能</span><span class="sxs-lookup"><span data-stu-id="dc922-108">Functionality</span></span>

<span data-ttu-id="dc922-109">[StoClien](structured-storage-client-sample--stoclien-.md)功能類似于某些 Microsoft Visual C++ 版本中的「自由曲線」範例。</span><span class="sxs-lookup"><span data-stu-id="dc922-109">The [StoClien](structured-storage-client-sample--stoclien-.md) functionality is similar to the "scribble" samples in some versions of Microsoft Visual C++.</span></span> <span data-ttu-id="dc922-110">StoClien 範例和 [StoServe](structured-storage-server-sample--stoserve-.md) 範例之間的差異在於以 COM 技術為基礎的內部架構。</span><span class="sxs-lookup"><span data-stu-id="dc922-110">The difference between the StoClien sample and the [StoServe](structured-storage-server-sample--stoserve-.md) sample is an internal architecture based on COM technology.</span></span> <span data-ttu-id="dc922-111">在 COM 用戶端與 COM 伺服器之間會保持清楚的架構差異。</span><span class="sxs-lookup"><span data-stu-id="dc922-111">A clear architectural distinction is kept between COM client and COM server.</span></span>

<span data-ttu-id="dc922-112">[StoClien](structured-storage-client-sample--stoclien-.md) 會在 COM 複合檔案的結構化儲存體中載入並儲存其繪圖。</span><span class="sxs-lookup"><span data-stu-id="dc922-112">[StoClien](structured-storage-client-sample--stoclien-.md) loads and saves its drawings in the structured storage of COM compound files.</span></span>

<span data-ttu-id="dc922-113">[StoClien](structured-storage-client-sample--stoclien-.md)範例會建立並使用在 \_ [StoServe](structured-storage-server-sample--stoserve-.md)伺服器中提供作為 CLSID DllPaper 元件的可連接 COPaper COM 物件。</span><span class="sxs-lookup"><span data-stu-id="dc922-113">The [StoClien](structured-storage-client-sample--stoclien-.md) sample creates and uses the connectable COPaper COM object that is provided as the CLSID\_DllPaper component in the [StoServe](structured-storage-server-sample--stoserve-.md) server.</span></span> <span data-ttu-id="dc922-114">StoClien 用戶端會建立 COPaper 物件，並透過該物件公開的 IPaper 介面來控制它。</span><span class="sxs-lookup"><span data-stu-id="dc922-114">The StoClien client creates a COPaper object and controls it through the IPaper interface that the object exposes.</span></span> <span data-ttu-id="dc922-115">StoClien 會取得使用者的繪圖資料，並在其管理的視窗中以圖形方式呈現資料。</span><span class="sxs-lookup"><span data-stu-id="dc922-115">StoClien obtains drawing data from the user and graphically represents it in a window that it manages.</span></span> <span data-ttu-id="dc922-116">StoClien 會使用 COPaper IPaper 介面，將繪圖資料儲存在 COPaper 中，並將此資料的檔案儲存作業導向。</span><span class="sxs-lookup"><span data-stu-id="dc922-116">StoClien uses the COPaper IPaper interface to save the drawing data in COPaper and to direct file storage operations on this data.</span></span>

<span data-ttu-id="dc922-117">COPaper COM 物件只會封裝繪圖紙張資料的伺服器型儲存：伺服器端沒有提供 (GUI) 行為的圖形化使用者介面。</span><span class="sxs-lookup"><span data-stu-id="dc922-117">A COPaper COM object encapsulates only the server-based storage of the drawing paper data: No graphical user interface (GUI) behavior is provided on the server side.</span></span> <span data-ttu-id="dc922-118">所有 GUI 行為都會在用戶端中隔離。</span><span class="sxs-lookup"><span data-stu-id="dc922-118">All GUI behavior is isolated in the client.</span></span> <span data-ttu-id="dc922-119">COPaper 物件的資料管理和儲存功能只可透過 COM 自訂介面 IPaper。</span><span class="sxs-lookup"><span data-stu-id="dc922-119">The data management and storage features of COPaper objects are available only through an COM custom interface, IPaper.</span></span>

<span data-ttu-id="dc922-120">[StoClien](structured-storage-client-sample--stoclien-.md) 會合作與 COPaper，以載入並儲存 COPaper 繪圖資料。</span><span class="sxs-lookup"><span data-stu-id="dc922-120">[StoClien](structured-storage-client-sample--stoclien-.md) cooperates with the COPaper to load and save the COPaper drawing data.</span></span> <span data-ttu-id="dc922-121">StoClien 會取得複合檔案中儲存物件的 [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) 介面。</span><span class="sxs-lookup"><span data-stu-id="dc922-121">StoClien obtains an [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) interface for the storage object in a compound file.</span></span> <span data-ttu-id="dc922-122">在其載入和儲存作業中，StoClien 會將 **IStorage** 介面的指標傳遞到伺服器中的 COPaper。</span><span class="sxs-lookup"><span data-stu-id="dc922-122">In its load and save operations, StoClien passes a pointer to the **IStorage** interface to COPaper in the server.</span></span> <span data-ttu-id="dc922-123">COPaper 會使用提供的 **IStorage** 在儲存體中建立資料流程。</span><span class="sxs-lookup"><span data-stu-id="dc922-123">COPaper uses the provided **IStorage** to create streams in the storage.</span></span> <span data-ttu-id="dc922-124">COPaper 接著可以使用標準 [**IStream**](/windows/desktop/api/Objidl/nn-objidl-istream) 介面，來讀取和寫入其所管理的繪圖資料。</span><span class="sxs-lookup"><span data-stu-id="dc922-124">COPaper can then use the standard [**IStream**](/windows/desktop/api/Objidl/nn-objidl-istream) interface for reading and writing the drawing data it manages.</span></span>

<span data-ttu-id="dc922-125">COPaper 只會管理繪圖資料;它不會執行任何 GUI 動作。</span><span class="sxs-lookup"><span data-stu-id="dc922-125">COPaper only manages the drawing data; it performs no GUI actions.</span></span> <span data-ttu-id="dc922-126">[StoClien](structured-storage-client-sample--stoclien-.md) 為繪圖應用程式提供 GUI。</span><span class="sxs-lookup"><span data-stu-id="dc922-126">[StoClien](structured-storage-client-sample--stoclien-.md) provides the GUI for the drawing application.</span></span> <span data-ttu-id="dc922-127">它會將此封裝在中央 CGuiPaper c + + 物件中。</span><span class="sxs-lookup"><span data-stu-id="dc922-127">It encapsulates this in a central CGuiPaper C++ object.</span></span>

<span data-ttu-id="dc922-128">[StoClien](structured-storage-client-sample--stoclien-.md) 也會在 COPaperSink COM 物件中執行自訂 IPaperSink 介面，並將此介面連接至伺服器 COPaper 物件中的適當連接點。</span><span class="sxs-lookup"><span data-stu-id="dc922-128">[StoClien](structured-storage-client-sample--stoclien-.md) also implements the custom IPaperSink interface in a COPaperSink COM object and connects this interface to an appropriate connection point in the server COPaper object.</span></span> <span data-ttu-id="dc922-129">COPaper 會使用連接的 IPaperSink 介面，將通知傳回至 StoClien。</span><span class="sxs-lookup"><span data-stu-id="dc922-129">COPaper uses the connected IPaperSink interface to send notifications back to StoClien.</span></span> <span data-ttu-id="dc922-130">使用 COPaper 的可連線物件技術，在 StoClien 中完成 COPaper 繪圖資料的一般 GUI 重新繪製。</span><span class="sxs-lookup"><span data-stu-id="dc922-130">The normal GUI repainting of the COPaper drawing data is done in StoClien using the COPaper connectable object technology.</span></span>

<span data-ttu-id="dc922-131">[StoClien](structured-storage-client-sample--stoclien-.md) 是一種應用程式，您可以使用一般方式或從命令提示字元視窗直接執行。</span><span class="sxs-lookup"><span data-stu-id="dc922-131">[StoClien](structured-storage-client-sample--stoclien-.md) is an application that you can execute directly in the normal manner or from the command prompt window.</span></span> <span data-ttu-id="dc922-132">StoClien 會在命令列上接受選擇性的檔案名參數。</span><span class="sxs-lookup"><span data-stu-id="dc922-132">StoClien accepts an optional file name parameter on the command line.</span></span>

<span data-ttu-id="dc922-133">在下列範例中，DllPaper 是複合檔案，其中包含繪製資料的相容結構化儲存體。</span><span class="sxs-lookup"><span data-stu-id="dc922-133">In the following example, Drawing.pap is a compound file containing DllPaper-compatible structured storage of drawing data.</span></span> <span data-ttu-id="dc922-134">如果未指定任何命令列檔案名參數，則 [StoClien](structured-storage-client-sample--stoclien-.md) 會使用預設的檔案名 StoClien，並嘗試在與執行中 Stoclien.exe 相同的目錄中開啟該名稱。</span><span class="sxs-lookup"><span data-stu-id="dc922-134">If no command line file name parameter is specified, [StoClien](structured-storage-client-sample--stoclien-.md) uses the default file name Stoclien.pap and attempts to open it in the same directory as the executing Stoclien.exe.</span></span>

<span data-ttu-id="dc922-135">**StoClien c： \\ 繪圖 \\ 繪圖。 pap**</span><span class="sxs-lookup"><span data-stu-id="dc922-135">**StoClien c:\\drawings\\drawing.pap**</span></span>

## <a name="support-information"></a><span data-ttu-id="dc922-136">支援資訊</span><span class="sxs-lookup"><span data-stu-id="dc922-136">Support Information</span></span>

<span data-ttu-id="dc922-137">如需 [StoClien](structured-storage-client-sample--stoclien-.md)的詳細資訊、功能描述和程式碼教學課程，請參閱 Stoclien.htm 中的程式碼導覽一節。</span><span class="sxs-lookup"><span data-stu-id="dc922-137">For more information, functional descriptions and a code tutorial for [StoClien](structured-storage-client-sample--stoclien-.md), see the Code Tour section in Stoclien.htm.</span></span> <span data-ttu-id="dc922-138">如需 StoClien 的外部使用者作業的詳細資訊，請參閱 Stoclien.htm 中的 [使用方式] 和 [作業] 區段。</span><span class="sxs-lookup"><span data-stu-id="dc922-138">For more information about the external user operation of StoClien, see the Usage and Operation sections in Stoclien.htm.</span></span> <span data-ttu-id="dc922-139">若要讀取 Stoclient.htm，請在主要教學課程目錄中執行 Tutorial.exe，然後按一下課程表中的 StoClien 課程。</span><span class="sxs-lookup"><span data-stu-id="dc922-139">To read Stoclient.htm, run Tutorial.exe in the main tutorial directory and click the StoClien lesson in the table of lessons.</span></span> <span data-ttu-id="dc922-140">或者，在 Windows 檔案總管中尋找主要教學課程目錄之後，請按一下 [Stoclien.htm]。</span><span class="sxs-lookup"><span data-stu-id="dc922-140">Alternatively, click Stoclien.htm after locating the main tutorial directory in Windows Explorer.</span></span> <span data-ttu-id="dc922-141">如需 [**StoServe**](structured-storage-server-sample--stoserve-.md) 的運作方式，以及如何將其服務公開給 StoClien 的詳細資訊，請參閱主要教學課程目錄中的 Stoserve.htm。</span><span class="sxs-lookup"><span data-stu-id="dc922-141">For more information about how [**StoServe**](structured-storage-server-sample--stoserve-.md) works and exposes its services to StoClien, see Stoserve.htm in the main tutorial directory.</span></span> <span data-ttu-id="dc922-142">請注意，您必須先建立 Stoserve.dll，才能建立 StoClien。</span><span class="sxs-lookup"><span data-stu-id="dc922-142">Be aware that you must build the Stoserve.dll before building StoClien.</span></span> <span data-ttu-id="dc922-143">[**StoServe**](structured-storage-server-sample--stoserve-.md)的 makefile 會在系統登錄中註冊該伺服器，因此您必須先建立 [**StoServe**](structured-storage-server-sample--stoserve-.md) ，然後再嘗試執行 StoClien。</span><span class="sxs-lookup"><span data-stu-id="dc922-143">The makefile for [**StoServe**](structured-storage-server-sample--stoserve-.md) registers that server in the system registry, so you must build [**StoServe**](structured-storage-server-sample--stoserve-.md) before attempting to run StoClien.</span></span>

<span data-ttu-id="dc922-144">如需有關在此 COM 教學課程系列中設定系統以建立和測試程式碼範例的詳細資訊，請參閱 [如何建立範例](how-to-build-samples.md)。</span><span class="sxs-lookup"><span data-stu-id="dc922-144">For more information about setting up a system to build and test the code samples in this COM Tutorial series, see [How to Build Samples](how-to-build-samples.md).</span></span> <span data-ttu-id="dc922-145">提供的 makefile (MAKEFILE) 與 Microsoft NMAKE 相容。</span><span class="sxs-lookup"><span data-stu-id="dc922-145">The supplied makefile (MAKEFILE) is Microsoft NMAKE-compatible.</span></span> <span data-ttu-id="dc922-146">若要建立 debug 組建，請在 [命令提示字元] 視窗中發出 NMAKE 命令。</span><span class="sxs-lookup"><span data-stu-id="dc922-146">To create a debug build, issue the NMAKE command in the command prompt window.</span></span>

<span data-ttu-id="dc922-147">為了方便起見，會提供每個範例的專案檔，以用於 Microsoft Visual Studio。</span><span class="sxs-lookup"><span data-stu-id="dc922-147">For convenience, a project file is provided for each sample for use in Microsoft Visual Studio.</span></span> <span data-ttu-id="dc922-148">若要載入 [StoClien](structured-storage-client-sample--stoclien-.md) 範例的專案，請在範例目錄中的命令提示字元執行 Visual Studio，如下所示：</span><span class="sxs-lookup"><span data-stu-id="dc922-148">To load the project for the [StoClien](structured-storage-client-sample--stoclien-.md) sample, run Visual Studio at the command prompt in the sample directory as follows:</span></span>

<span data-ttu-id="dc922-149">MSDEV STOCLIEN.Dsp</span><span class="sxs-lookup"><span data-stu-id="dc922-149">MSDEV STOCLIEN.DSP</span></span>

<span data-ttu-id="dc922-150">您也可以按兩下 Windows 檔案總管中的 Stoclient，將範例專案載入 Visual Studio。</span><span class="sxs-lookup"><span data-stu-id="dc922-150">You can also double-click the Stoclient.dsp file in Windows Explorer to load a sample project into Visual Studio.</span></span> <span data-ttu-id="dc922-151">在 Visual Studio 中，您可以流覽範例來源的 c + + 類別，並通常執行其他編輯編譯-編譯-debug 作業。</span><span class="sxs-lookup"><span data-stu-id="dc922-151">In Visual Studio, you can browse the C++ classes of the sample source and generally perform the other edit-compile-debug operations.</span></span> <span data-ttu-id="dc922-152">請注意，在伺服器 SDK 中，從 Visual Studio 編譯這些範例需要在 Visual Studio 中正確設定目錄路徑。</span><span class="sxs-lookup"><span data-stu-id="dc922-152">Be aware that, as part of the Server SDK, the compilation of these samples from within Visual Studio requires the proper setting of directory paths in Visual Studio.</span></span> <span data-ttu-id="dc922-153">如需詳細資訊，請參閱 [如何建立範例](how-to-build-samples.md)。</span><span class="sxs-lookup"><span data-stu-id="dc922-153">For more information, see [How to Build Samples](how-to-build-samples.md).</span></span>

## <a name="remarks"></a><span data-ttu-id="dc922-154">備註</span><span class="sxs-lookup"><span data-stu-id="dc922-154">Remarks</span></span>

<span data-ttu-id="dc922-155">您必須先編譯用戶端範例和其他相關的範例，才能執行用戶端。</span><span class="sxs-lookup"><span data-stu-id="dc922-155">The client sample and other related samples must be compiled before you can run the client.</span></span> <span data-ttu-id="dc922-156">如需建立範例的詳細資訊，請參閱 [如何建立範例](how-to-build-samples.md)。</span><span class="sxs-lookup"><span data-stu-id="dc922-156">For more information about building the samples, see [How to Build Samples](how-to-build-samples.md).</span></span> <span data-ttu-id="dc922-157">如果您已建立適當的範例，Stoclien.exe 是要針對此範例執行的用戶端可執行檔。</span><span class="sxs-lookup"><span data-stu-id="dc922-157">If you have built the appropriate samples, Stoclien.exe is the client executable to run for this sample.</span></span>

<span data-ttu-id="dc922-158">Stoclien.exe 的應用程式會提供此教學課程的使用者介面。</span><span class="sxs-lookup"><span data-stu-id="dc922-158">The Stoclien.exe application provides the user interface for this tutorial.</span></span> <span data-ttu-id="dc922-159">它會執行相關聯但獨立的 Stoserve.dll，以示範在複合檔案中使用 COM 結構化儲存的用戶端和伺服器。</span><span class="sxs-lookup"><span data-stu-id="dc922-159">It exercises the associated, but independent, Stoserve.dll to demonstrate both client and server use of COM structured storage in compound files.</span></span>

 

 




