---
title: 管理屬性
description: 每個屬性都包含屬性（property）識別碼 (在其屬性集) 中是唯一的、variant 型別 (VT 或 VarType) 標記（代表值的型別）和值本身。
ms.assetid: d220ecb4-b014-4ac9-a636-9a493187cc87
keywords:
- 結構化儲存體 Strctd Stg.，使用，管理屬性
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 10dd78a1f8a8484090728dba6fe149840e940461
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/20/2020
ms.locfileid: "103842420"
---
# <a name="managing-properties"></a><span data-ttu-id="77bbe-104">管理屬性</span><span class="sxs-lookup"><span data-stu-id="77bbe-104">Managing Properties</span></span>

<span data-ttu-id="77bbe-105">每個屬性都包含屬性（property） *識別碼* (在其屬性集) 中是唯一的、 *variant 型別 (VT 或 VarType) 標記* （代表值的型別）和 *值* 本身。</span><span class="sxs-lookup"><span data-stu-id="77bbe-105">Every property consists of a *property identifier* (unique within its property set), a *variant type (VT or VarType) tag* that represents the type of a value, and the *value* itself.</span></span> <span data-ttu-id="77bbe-106">Variant 類型標記描述值中資料的標記法。</span><span class="sxs-lookup"><span data-stu-id="77bbe-106">The variant type tag describes the representation of the data in the value.</span></span> <span data-ttu-id="77bbe-107">此外，也可以將可以用來識別屬性的 *字串名稱* 指派給屬性，而不是使用所需的數值屬性識別碼 (識別碼) 。</span><span class="sxs-lookup"><span data-stu-id="77bbe-107">In addition, a property may also be assigned a *string name* that can be used to identify the property, rather than using the required numerical property identifier (ID).</span></span> <span data-ttu-id="77bbe-108">為了建立及管理屬性，COM 會定義 [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) 介面。</span><span class="sxs-lookup"><span data-stu-id="77bbe-108">To create and manage properties, COM defines the [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) interface.</span></span>

<span data-ttu-id="77bbe-109">[**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage)介面包括讀取和寫入屬性（property）或屬性（property）名稱陣列的方法。</span><span class="sxs-lookup"><span data-stu-id="77bbe-109">The [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) interface includes methods to read and write arrays of either properties or property names.</span></span> <span data-ttu-id="77bbe-110">介面包括與相同名稱的 [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage)方法類似的 [**認可**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-commit)和 [**還原**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-revert)方法。</span><span class="sxs-lookup"><span data-stu-id="77bbe-110">The interface includes [**Commit**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-commit) and [**Revert**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-revert) methods that are similar to [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) methods of the same name.</span></span> <span data-ttu-id="77bbe-111">有公用程式方法可讓您設定屬性集 (CLSID) 的類別識別碼、設定與集合相關聯的時間，以及取得屬性集的相關統計資料。</span><span class="sxs-lookup"><span data-stu-id="77bbe-111">There are utility methods that allow you to set the class identifier (CLSID) of the property set, set the times associated with the set, and get statistics about the property set.</span></span> <span data-ttu-id="77bbe-112">最後， [**Enum**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-enum) 方法會建立列舉值，並傳回其 [**IEnumSTATPROPSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg) 介面的指標。</span><span class="sxs-lookup"><span data-stu-id="77bbe-112">Finally, the [**Enum**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-enum) method creates an enumerator and returns a pointer to its [**IEnumSTATPROPSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg) interface.</span></span> <span data-ttu-id="77bbe-113">您可以呼叫這個介面的方法來列舉物件上的 [**STATPROPSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg) 結構，以提供目前屬性集中所有屬性的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="77bbe-113">You can call the methods of this interface to enumerate [**STATPROPSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg) structures on your object, which will provide information about all of the properties in the current property set.</span></span>

<span data-ttu-id="77bbe-114">以下是如何表示屬性的範例。</span><span class="sxs-lookup"><span data-stu-id="77bbe-114">The following is an example of how properties are represented.</span></span> <span data-ttu-id="77bbe-115">如果屬性集內的特定屬性保存動物的科學名稱，則該名稱可能會儲存為以零結尾的字串。</span><span class="sxs-lookup"><span data-stu-id="77bbe-115">If a specific property in a property set holds an animal's scientific name, that name could be stored as a zero-terminated string.</span></span> <span data-ttu-id="77bbe-116">連同名稱一起儲存會是一個型別指標，表示值是以零結尾的字串。</span><span class="sxs-lookup"><span data-stu-id="77bbe-116">Stored along with the name would be a type indicator to indicate that the value is a zero-terminated string.</span></span> <span data-ttu-id="77bbe-117">這些屬性可能具有下列特性：</span><span class="sxs-lookup"><span data-stu-id="77bbe-117">These properties might have the following characteristics:</span></span>



| <span data-ttu-id="77bbe-118">屬性識別碼</span><span class="sxs-lookup"><span data-stu-id="77bbe-118">Property ID</span></span> | <span data-ttu-id="77bbe-119">字串識別碼</span><span class="sxs-lookup"><span data-stu-id="77bbe-119">String identifier</span></span> | <span data-ttu-id="77bbe-120">類型指標</span><span class="sxs-lookup"><span data-stu-id="77bbe-120">Type indicator</span></span> | <span data-ttu-id="77bbe-121">表示的值</span><span class="sxs-lookup"><span data-stu-id="77bbe-121">Value represented</span></span>              |
|-------------|-------------------|----------------|--------------------------------|
| <span data-ttu-id="77bbe-122">02</span><span class="sxs-lookup"><span data-stu-id="77bbe-122">02</span></span>          | <span data-ttu-id="77bbe-123">PID \_ ANIMALNAME</span><span class="sxs-lookup"><span data-stu-id="77bbe-123">PID\_ANIMALNAME</span></span>   | <span data-ttu-id="77bbe-124">VT \_ LPWSTR</span><span class="sxs-lookup"><span data-stu-id="77bbe-124">VT\_LPWSTR</span></span>     | <span data-ttu-id="77bbe-125">以零結束的 Unicode 字串</span><span class="sxs-lookup"><span data-stu-id="77bbe-125">Zero-terminated Unicode string</span></span> |
| <span data-ttu-id="77bbe-126">03</span><span class="sxs-lookup"><span data-stu-id="77bbe-126">03</span></span>          | <span data-ttu-id="77bbe-127">PID \_ LEGCOUNT</span><span class="sxs-lookup"><span data-stu-id="77bbe-127">PID\_LEGCOUNT</span></span>     | <span data-ttu-id="77bbe-128">VT \_ I2</span><span class="sxs-lookup"><span data-stu-id="77bbe-128">VT\_I2</span></span>         | <span data-ttu-id="77bbe-129">WORD</span><span class="sxs-lookup"><span data-stu-id="77bbe-129">WORD</span></span>                           |



 

<span data-ttu-id="77bbe-130">任何辨識屬性集格式的應用程式（透過其格式識別碼 (FMTID) ），都可以查看識別碼為 PID ANIMALNAME 的屬性 \_ ，並判斷它是以零結尾的字串，並讀取和寫入值。</span><span class="sxs-lookup"><span data-stu-id="77bbe-130">Any application that recognizes the property set format—identifying it through its format identifier (FMTID)—can look at the property with an identifier of PID\_ANIMALNAME, determine that it is a zero-terminated string, and read and write the value.</span></span> <span data-ttu-id="77bbe-131">雖然應用程式可以呼叫 [**IPropertyStorage：： ReadMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-readmultiple) 來讀取任何或所有屬性集 (先取得) 的指標，但應用程式必須知道如何解讀屬性集。</span><span class="sxs-lookup"><span data-stu-id="77bbe-131">Although the application can call [**IPropertyStorage::ReadMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-readmultiple) to read any or all of a property set (having first obtained a pointer), the application must know how to interpret the property set.</span></span>

<span data-ttu-id="77bbe-132">屬性值會透過屬性介面傳遞為 [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant)類型的實例。</span><span class="sxs-lookup"><span data-stu-id="77bbe-132">A property value is passed through property interfaces as an instance of the type [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant).</span></span>

<span data-ttu-id="77bbe-133">請務必區分這些儲存 (持續性) 屬性和執行時間屬性。</span><span class="sxs-lookup"><span data-stu-id="77bbe-133">It is important to distinguish between these stored (persistent) properties, and run-time properties.</span></span> <span data-ttu-id="77bbe-134">Variant 類型值常數的名稱開頭為 VT \_ 。</span><span class="sxs-lookup"><span data-stu-id="77bbe-134">Variant-type value constants have names beginning with VT\_.</span></span> <span data-ttu-id="77bbe-135">不過，有效的 PROPVARIANTs 集並非完全等同于自動化和 ActiveX 控制項中所使用的一組 Variant。</span><span class="sxs-lookup"><span data-stu-id="77bbe-135">The set of valid PROPVARIANTs is, however, not entirely equivalent to the set of VARIANTs used in Automation and ActiveX controls.</span></span>

<span data-ttu-id="77bbe-136">這兩個結構之間的唯一差異是每個結構中允許的一組 VT \_ (Variant 類型/VarType) 標記。</span><span class="sxs-lookup"><span data-stu-id="77bbe-136">The only difference between the two structures is the allowable set of VT\_ (Variant Type / VarType) tags in each.</span></span> <span data-ttu-id="77bbe-137">在變數和 PROPVARIANT 中可使用特定屬性類型的情況下， (VT 值的型別標記 \_) 一律具有相同的值。</span><span class="sxs-lookup"><span data-stu-id="77bbe-137">Where a certain property type can be used in both a VARIANT and a PROPVARIANT, the type tag (the VT\_ value) always has an identical value.</span></span> <span data-ttu-id="77bbe-138">此外，針對指定的 VT \_ 值，variant 和 PROPVARIANTs 中使用的記憶體中標記法相同。</span><span class="sxs-lookup"><span data-stu-id="77bbe-138">Further, for a given VT\_ value, the in-memory representation used in VARIANTs and PROPVARIANTs is identical.</span></span> <span data-ttu-id="77bbe-139">這種方法可讓型別系統捕捉不允許的型別標籤，同時讓熟悉的用戶端在適當的情況下執行指標轉換。</span><span class="sxs-lookup"><span data-stu-id="77bbe-139">Taken all together, this approach allows the type system to catch disallowed type tags, while at the same time allowing a knowledgeable client to implement a pointer cast when appropriate.</span></span>

<span data-ttu-id="77bbe-140">如需詳細資訊，請參閱下一節的 [屬性儲存體考慮](property-storage-considerations.md)。</span><span class="sxs-lookup"><span data-stu-id="77bbe-140">For more information, see the following section, [Property Storage Considerations](property-storage-considerations.md).</span></span>

 

 