---
title: 關於清單方塊
description: 本章節描述清單方塊功能。
ms.assetid: 359bb363-5b97-4e0c-bdc4-bfa6a6504a76
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 674712226a79960e44ab99ed8e59c88b27984efb
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/21/2020
ms.locfileid: "104463749"
---
# <a name="about-list-boxes"></a><span data-ttu-id="9cf9f-103">關於清單方塊</span><span class="sxs-lookup"><span data-stu-id="9cf9f-103">About List Boxes</span></span>

<span data-ttu-id="9cf9f-104">清單方塊控制項包含一份簡單的清單，使用者通常可以從該清單中選取一或多個專案。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-104">A list box control contains a simple list from which the user can generally select one or more items.</span></span> <span data-ttu-id="9cf9f-105">相較于 [清單視圖](list-view-control-reference.md) 控制項，清單方塊可提供有限的彈性。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-105">List boxes provide limited flexibility compared with [List View](list-view-control-reference.md) controls.</span></span>

<span data-ttu-id="9cf9f-106">清單方塊專案可以用文字字串、點陣圖或兩者表示。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-106">List box items can be represented by text strings, bitmaps, or both.</span></span> <span data-ttu-id="9cf9f-107">如果清單方塊不夠大，無法一次顯示所有清單方塊專案，清單方塊會提供捲軸。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-107">If the list box is not large enough to display all the list box items at once, the list box provides a scroll bar.</span></span> <span data-ttu-id="9cf9f-108">使用者會在清單方塊專案中滾動，並視需要套用或移除選取狀態。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-108">The user scrolls through the list box items and applies or removes selection status as necessary.</span></span> <span data-ttu-id="9cf9f-109">選取清單方塊專案會變更其視覺外觀，通常是將文字和背景色彩變更為相關作業系統度量所指定的色彩。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-109">Selecting a list box item changes its visual appearance, usually by changing the text and background colors to those specified by the relevant operating system metrics.</span></span> <span data-ttu-id="9cf9f-110">當使用者選取或取消選取專案時，系統會將通知訊息傳送至清單方塊的父視窗。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-110">When the user selects or deselects an item, the system sends a notification message to the parent window of the list box.</span></span>

<span data-ttu-id="9cf9f-111">若為 ANSI 應用程式，系統會使用 **CP \_ ACP** 字碼頁，將清單方塊中的文字轉換成 Unicode。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-111">For an ANSI application, the system converts the text in a list box to Unicode by using the **CP\_ACP** code page.</span></span> <span data-ttu-id="9cf9f-112">這可能會造成問題。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-112">This can cause problems.</span></span> <span data-ttu-id="9cf9f-113">例如，在 Windows 的非 Unicode 清單方塊中，有重音的羅馬字元，日文版將會出現混亂。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-113">For example, accented Roman characters in a non-Unicode list box in Windows, Japanese version will come out garbled.</span></span> <span data-ttu-id="9cf9f-114">若要修正此問題，請將應用程式編譯為 Unicode 或使用主控描繪清單方塊。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-114">To fix this, either compile the application as Unicode or use an owner-drawn list box.</span></span>

<span data-ttu-id="9cf9f-115">本節將討論下列主題：</span><span class="sxs-lookup"><span data-stu-id="9cf9f-115">This section discusses the following topics:</span></span>

-   [<span data-ttu-id="9cf9f-116">建立清單方塊</span><span class="sxs-lookup"><span data-stu-id="9cf9f-116">Creating a List Box</span></span>](#creating-a-list-box)
-   [<span data-ttu-id="9cf9f-117">清單方塊類型和樣式</span><span class="sxs-lookup"><span data-stu-id="9cf9f-117">List Box Types and Styles</span></span>](#list-box-types-and-styles)
-   [<span data-ttu-id="9cf9f-118">清單方塊函數</span><span class="sxs-lookup"><span data-stu-id="9cf9f-118">List Box Functions</span></span>](#list-box-functions)
-   [<span data-ttu-id="9cf9f-119">清單方塊中的通知訊息</span><span class="sxs-lookup"><span data-stu-id="9cf9f-119">Notification Messages from List Boxes</span></span>](#notification-messages-from-list-boxes)
-   [<span data-ttu-id="9cf9f-120">傳送至清單方塊的訊息</span><span class="sxs-lookup"><span data-stu-id="9cf9f-120">Messages to List Boxes</span></span>](#notification-messages-from-list-boxes)
-   [<span data-ttu-id="9cf9f-121">預設視窗訊息處理</span><span class="sxs-lookup"><span data-stu-id="9cf9f-121">Default Window Message Processing</span></span>](#default-window-message-processing)
-   [<span data-ttu-id="9cf9f-122">擁有者繪製清單方塊</span><span class="sxs-lookup"><span data-stu-id="9cf9f-122">Owner-Drawn List Boxes</span></span>](#owner-drawn-list-boxes)
-   [<span data-ttu-id="9cf9f-123">拖曳清單方塊</span><span class="sxs-lookup"><span data-stu-id="9cf9f-123">Drag List Boxes</span></span>](#drag-list-boxes)
    -   [<span data-ttu-id="9cf9f-124">建立拖曳清單方塊</span><span class="sxs-lookup"><span data-stu-id="9cf9f-124">Creating Drag List Boxes</span></span>](#creating-drag-list-boxes)
    -   [<span data-ttu-id="9cf9f-125">拖曳清單方塊訊息</span><span class="sxs-lookup"><span data-stu-id="9cf9f-125">Drag List Box Messages</span></span>](#drag-list-box-messages)
    -   [<span data-ttu-id="9cf9f-126">拖曳清單方塊通知碼</span><span class="sxs-lookup"><span data-stu-id="9cf9f-126">Drag List Box Notification Codes</span></span>](#drag-list-box-notification-codes)

## <a name="creating-a-list-box"></a><span data-ttu-id="9cf9f-127">建立清單方塊</span><span class="sxs-lookup"><span data-stu-id="9cf9f-127">Creating a List Box</span></span>

<span data-ttu-id="9cf9f-128">在對話方塊中建立清單方塊的最簡單方式，就是將它從 [工具箱] 中 Microsoft Visual Studio 拖曳至對話方塊資源。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-128">The easiest way to create a list box in a dialog box is to drag it from the Toolbox in Microsoft Visual Studio onto your dialog resource.</span></span> <span data-ttu-id="9cf9f-129">若要動態建立清單方塊，或是在對話方塊以外的視窗中建立清單方塊，請使用 [**CreateWindowEx**](/windows/desktop/api/winuser/nf-winuser-createwindowexa) 函式，並指定 [**WC \_ LISTBOX**](common-control-window-classes.md) 視窗類別和適當的 [清單方塊樣式](list-box-styles.md)。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-129">To create a list box dynamically, or to create a list box in a window other than a dialog box, use the [**CreateWindowEx**](/windows/desktop/api/winuser/nf-winuser-createwindowexa) function, specifying the [**WC\_LISTBOX**](common-control-window-classes.md) window class and the appropriate [list box styles](list-box-styles.md).</span></span>

## <a name="list-box-types-and-styles"></a><span data-ttu-id="9cf9f-130">清單方塊類型和樣式</span><span class="sxs-lookup"><span data-stu-id="9cf9f-130">List Box Types and Styles</span></span>

<span data-ttu-id="9cf9f-131">清單方塊有兩種類型：單一選取 (預設) 和多重選取。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-131">There are two types of list boxes: single-selection (the default) and multiple-selection.</span></span> <span data-ttu-id="9cf9f-132">在單一選取清單方塊中，使用者一次只能選取一個專案。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-132">In a single-selection list box, the user can select only one item at a time.</span></span> <span data-ttu-id="9cf9f-133">在多重選取清單方塊中，使用者可以一次選取一個以上的專案。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-133">In a multiple-selection list box, the user can select more than one item at a time.</span></span> <span data-ttu-id="9cf9f-134">若要建立多重選取清單方塊，請指定 [**磅 \_ MULTIPLESEL**](list-box-styles.md) 或 [**磅 \_ EXTENDEDSEL**](list-box-styles.md) 樣式。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-134">To create a multiple-selection list box, specify the [**LBS\_MULTIPLESEL**](list-box-styles.md) or the [**LBS\_EXTENDEDSEL**](list-box-styles.md) style.</span></span>

<span data-ttu-id="9cf9f-135">清單方塊的外觀和操作是由 [清單方塊樣式](list-box-styles.md) 和視窗樣式所控制。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-135">The appearance and operation of a list box is controlled by [list box styles](list-box-styles.md) and window styles.</span></span> <span data-ttu-id="9cf9f-136">這些樣式表示清單是否經過排序、排列在多個資料行中，以及由應用程式所繪製，依此類推。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-136">These styles indicate whether the list is sorted, arranged in multiple columns, drawn by the application, and so on.</span></span> <span data-ttu-id="9cf9f-137">清單方塊的維度和樣式通常是在包含在應用程式資源中的對話方塊範本中定義。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-137">The dimensions and styles of a list box are typically defined in a dialog box template that is included in an application's resources.</span></span>

> [!Note]  
> <span data-ttu-id="9cf9f-138">若要搭配這些控制項使用視覺化樣式，應用程式必須包含資訊清單，而且必須在程式的開頭呼叫 [**InitCommonControls**](/windows/desktop/api/Commctrl/nf-commctrl-initcommoncontrols) 。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-138">To use visual styles with these controls, an application must include a manifest and must call [**InitCommonControls**](/windows/desktop/api/Commctrl/nf-commctrl-initcommoncontrols) at the beginning of the program.</span></span> <span data-ttu-id="9cf9f-139">如需視覺化樣式的詳細資訊，請參閱 [視覺化樣式](themes-overview.md)。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-139">For information on visual styles, see [Visual Styles](themes-overview.md).</span></span> <span data-ttu-id="9cf9f-140">如需資訊清單的詳細資訊，請參閱 [啟用視覺化樣式](cookbook-overview.md)。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-140">For information on manifests, see [Enabling Visual Styles](cookbook-overview.md).</span></span>

 

## <a name="list-box-functions"></a><span data-ttu-id="9cf9f-141">清單方塊函數</span><span class="sxs-lookup"><span data-stu-id="9cf9f-141">List Box Functions</span></span>

<span data-ttu-id="9cf9f-142">[**DlgDirList**](/windows/desktop/api/Winuser/nf-winuser-dlgdirlista)函式會將清單方塊的內容取代為符合指定準則組的磁片磁碟機、目錄和檔案的名稱。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-142">The [**DlgDirList**](/windows/desktop/api/Winuser/nf-winuser-dlgdirlista) function replaces the contents of a list box with the names of drives, directories, and files that match a specified set of criteria.</span></span> <span data-ttu-id="9cf9f-143">[**DlgDirSelectEx**](/windows/desktop/api/Winuser/nf-winuser-dlgdirselectexa)函式會抓取由 **DlgDirList** 初始化的清單方塊中目前的選取範圍。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-143">The [**DlgDirSelectEx**](/windows/desktop/api/Winuser/nf-winuser-dlgdirselectexa) function retrieves the current selection in a list box that is initialized by **DlgDirList**.</span></span> <span data-ttu-id="9cf9f-144">這些功能可以讓使用者從清單方塊中選取磁片磁碟機、目錄或檔案，而不需要輸入檔案的位置和名稱。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-144">These functions make it possible for the user to select a drive, directory, or file from a list box without typing the location and name of the file.</span></span>

<span data-ttu-id="9cf9f-145">此外， [**GetListBoxInfo**](/windows/desktop/api/Winuser/nf-winuser-getlistboxinfo) 函數會傳回指定清單方塊中每個資料行的專案數。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-145">Also, the [**GetListBoxInfo**](/windows/desktop/api/Winuser/nf-winuser-getlistboxinfo) function returns the number of items per column in a specified list box.</span></span>

## <a name="notification-messages-from-list-boxes"></a><span data-ttu-id="9cf9f-146">清單方塊中的通知訊息</span><span class="sxs-lookup"><span data-stu-id="9cf9f-146">Notification Messages from List Boxes</span></span>

<span data-ttu-id="9cf9f-147">當事件發生在清單方塊中時，清單方塊會以 [**WM \_ 命令**](/windows/desktop/menurc/wm-command) 訊息的形式傳送通知碼至擁有者視窗的對話方塊程式。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-147">When an event occurs in a list box, the list box sends a notification code, in the form of a [**WM\_COMMAND**](/windows/desktop/menurc/wm-command) message, to the dialog box procedure of the owner window.</span></span> <span data-ttu-id="9cf9f-148">當使用者選取、按兩下或取消清單方塊專案時，會傳送清單方塊通知碼;當清單方塊收到或失去鍵盤焦點時：當系統無法配置足夠的記憶體給清單方塊要求時。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-148">List box notification codes are sent when a user selects, double-clicks, or cancels a list box item; when the list box receives or loses the keyboard focus; and when the system cannot allocate enough memory for a list box request.</span></span> <span data-ttu-id="9cf9f-149">**WM \_ 命令** 訊息包含 *wParam* 參數的低序位字組中的清單方塊識別碼，以及高序位單字中的通知碼。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-149">A **WM\_COMMAND** message contains the list box identifier in the low-order word of the *wParam* parameter, and the notification code in the high-order word.</span></span> <span data-ttu-id="9cf9f-150">*LParam* 參數包含控制項視窗控制碼。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-150">The *lParam* parameter contains the control window handle.</span></span>

<span data-ttu-id="9cf9f-151">不需要使用對話方塊程式來處理這些訊息;預設的視窗程式會進行處理。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-151">A dialog box procedure is not required to process these messages; the default window procedure processes them.</span></span>

<span data-ttu-id="9cf9f-152">應用程式應該監視並處理下列清單方塊通知碼。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-152">An application should monitor and process the following list box notification codes.</span></span>



| <span data-ttu-id="9cf9f-153">通知碼</span><span class="sxs-lookup"><span data-stu-id="9cf9f-153">Notification code</span></span>                   | <span data-ttu-id="9cf9f-154">Description</span><span class="sxs-lookup"><span data-stu-id="9cf9f-154">Description</span></span>                                                      |
|-------------------------------------|------------------------------------------------------------------|
| [<span data-ttu-id="9cf9f-155">LBN \_ DBLCLK</span><span class="sxs-lookup"><span data-stu-id="9cf9f-155">LBN\_DBLCLK</span></span>](lbn-dblclk.md)       | <span data-ttu-id="9cf9f-156">使用者按兩下清單方塊中的專案。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-156">The user double-clicks an item in the list box.</span></span>                  |
| [<span data-ttu-id="9cf9f-157">LBN \_ ERRSPACE</span><span class="sxs-lookup"><span data-stu-id="9cf9f-157">LBN\_ERRSPACE</span></span>](lbn-errspace.md)   | <span data-ttu-id="9cf9f-158">清單方塊無法配置足夠的記憶體來完成要求。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-158">The list box cannot allocate enough memory to fulfill a request.</span></span> |
| [<span data-ttu-id="9cf9f-159">LBN \_ KILLFOCUS</span><span class="sxs-lookup"><span data-stu-id="9cf9f-159">LBN\_KILLFOCUS</span></span>](lbn-killfocus.md) | <span data-ttu-id="9cf9f-160">清單方塊失去鍵盤焦點。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-160">The list box loses the keyboard focus.</span></span>                           |
| [<span data-ttu-id="9cf9f-161">LBN \_ SELCANCEL</span><span class="sxs-lookup"><span data-stu-id="9cf9f-161">LBN\_SELCANCEL</span></span>](lbn-selcancel.md) | <span data-ttu-id="9cf9f-162">使用者在清單方塊中取消選取專案。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-162">The user cancels the selection of an item in the list box.</span></span>       |
| [<span data-ttu-id="9cf9f-163">LBN \_ SELCHANGE</span><span class="sxs-lookup"><span data-stu-id="9cf9f-163">LBN\_SELCHANGE</span></span>](lbn-selchange.md) | <span data-ttu-id="9cf9f-164">清單方塊中的選取專案即將變更。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-164">The selection in a list box is about to change.</span></span>                  |
| [<span data-ttu-id="9cf9f-165">LBN \_ SETFOCUS</span><span class="sxs-lookup"><span data-stu-id="9cf9f-165">LBN\_SETFOCUS</span></span>](lbn-setfocus.md)   | <span data-ttu-id="9cf9f-166">清單方塊會收到鍵盤焦點。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-166">The list box receives the keyboard focus.</span></span>                        |



 

## <a name="messages-to-list-boxes"></a><span data-ttu-id="9cf9f-167">傳送至清單方塊的訊息</span><span class="sxs-lookup"><span data-stu-id="9cf9f-167">Messages to List Boxes</span></span>

<span data-ttu-id="9cf9f-168">對話方塊程式可將訊息傳送至清單方塊，以新增、刪除、檢查及變更清單方塊專案。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-168">A dialog box procedure can send messages to a list box to add, delete, examine, and change list box items.</span></span> <span data-ttu-id="9cf9f-169">例如，對話方塊程式可能會將 [**lb \_ ADDSTRING**](lb-addstring.md) 訊息傳送至清單方塊以加入專案，並傳送 [**lb \_ GETSEL**](lb-getsel.md) 訊息來判斷是否已選取專案。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-169">For example, a dialog box procedure could send an [**LB\_ADDSTRING**](lb-addstring.md) message to a list box to add an item, and an [**LB\_GETSEL**](lb-getsel.md) message to determine whether the item is selected.</span></span> <span data-ttu-id="9cf9f-170">其他訊息則會設定並取得清單方塊的大小、外觀和行為的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-170">Other messages set and retrieve information about the size, appearance, and behavior of the list box.</span></span> <span data-ttu-id="9cf9f-171">例如， [**LB \_ SETHORIZONTALEXTENT**](lb-sethorizontalextent.md) 訊息會設定清單方塊的可滾動寬度。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-171">For example, the [**LB\_SETHORIZONTALEXTENT**](lb-sethorizontalextent.md) message sets the scrollable width of a list box.</span></span> <span data-ttu-id="9cf9f-172">對話方塊程式可以使用 [**SendMessage**](/windows/desktop/api/winuser/nf-winuser-sendmessage) 或 [**SendDlgItemMessage**](/windows/desktop/api/winuser/nf-winuser-senddlgitemmessagea) 函數，將任何訊息傳送至清單方塊。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-172">A dialog box procedure can send any message to a list box by using the [**SendMessage**](/windows/desktop/api/winuser/nf-winuser-sendmessage) or [**SendDlgItemMessage**](/windows/desktop/api/winuser/nf-winuser-senddlgitemmessagea) function.</span></span>

<span data-ttu-id="9cf9f-173">清單方塊專案通常會由其 *索引* 參考，此整數代表清單方塊中專案的位置。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-173">A list box item is often referenced by its *index*, an integer that represents the item's position in the list box.</span></span> <span data-ttu-id="9cf9f-174">清單方塊中第一個專案的索引為0，第二個專案的索引為1，依此類推。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-174">The index of the first item in a list box is 0, the index of the second item is 1, and so on.</span></span>

<span data-ttu-id="9cf9f-175">下表說明預先定義的清單方塊程式如何回應清單方塊訊息。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-175">The following table describes how the predefined list box procedure responds to list box messages.</span></span>



| <span data-ttu-id="9cf9f-176">訊息</span><span class="sxs-lookup"><span data-stu-id="9cf9f-176">Message</span></span>                                                   | <span data-ttu-id="9cf9f-177">回應</span><span class="sxs-lookup"><span data-stu-id="9cf9f-177">Response</span></span>                                                                                                                                                                                                                         |
|-----------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="9cf9f-178">**LB \_ ADDFILE**</span><span class="sxs-lookup"><span data-stu-id="9cf9f-178">**LB\_ADDFILE**</span></span>](lb-addfile.md)                         | <span data-ttu-id="9cf9f-179">將檔案插入至 [**DlgDirList**](/windows/desktop/api/Winuser/nf-winuser-dlgdirlista) 函式所填滿的目錄清單方塊，並抓取所插入專案的清單方塊索引。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-179">Inserts a file into a directory list box that is filled by the [**DlgDirList**](/windows/desktop/api/Winuser/nf-winuser-dlgdirlista) function and retrieves the list box index of the inserted item.</span></span>                                                                  |
| [<span data-ttu-id="9cf9f-180">**LB \_ ADDSTRING**</span><span class="sxs-lookup"><span data-stu-id="9cf9f-180">**LB\_ADDSTRING**</span></span>](lb-addstring.md)                     | <span data-ttu-id="9cf9f-181">將字串加入至清單方塊，並傳回其索引。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-181">Adds a string to a list box and returns its index.</span></span>                                                                                                                                                                               |
| [<span data-ttu-id="9cf9f-182">**LB \_ DELETESTRING**</span><span class="sxs-lookup"><span data-stu-id="9cf9f-182">**LB\_DELETESTRING**</span></span>](lb-deletestring.md)               | <span data-ttu-id="9cf9f-183">從清單方塊中移除字串，並傳回清單中剩餘的字串數目。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-183">Removes a string from a list box and returns the number of strings that remain in the list.</span></span>                                                                                                                                      |
| [<span data-ttu-id="9cf9f-184">**LB \_ 目錄**</span><span class="sxs-lookup"><span data-stu-id="9cf9f-184">**LB\_DIR**</span></span>](lb-dir.md)                                 | <span data-ttu-id="9cf9f-185">將檔案名清單新增至清單方塊，並傳回所加入之最後一個檔案名的索引。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-185">Adds a list of file names to a list box and returns the index of the last file name added.</span></span>                                                                                                                                       |
| [<span data-ttu-id="9cf9f-186">**LB \_ FINDSTRING**</span><span class="sxs-lookup"><span data-stu-id="9cf9f-186">**LB\_FINDSTRING**</span></span>](lb-findstring.md)                   | <span data-ttu-id="9cf9f-187">傳回清單方塊中以指定字串開頭之第一個字串的索引。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-187">Returns the index of the first string in the list box that begins with a specified string.</span></span>                                                                                                                                       |
| [<span data-ttu-id="9cf9f-188">**LB \_ FINDSTRINGEXACT**</span><span class="sxs-lookup"><span data-stu-id="9cf9f-188">**LB\_FINDSTRINGEXACT**</span></span>](lb-findstringexact.md)         | <span data-ttu-id="9cf9f-189">傳回清單方塊中等於指定之字串的字串索引。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-189">Returns the index of the string in the list box that is equal to a specified string.</span></span>                                                                                                                                             |
| [<span data-ttu-id="9cf9f-190">**LB \_ GETANCHORINDEX**</span><span class="sxs-lookup"><span data-stu-id="9cf9f-190">**LB\_GETANCHORINDEX**</span></span>](lb-getanchorindex.md)           | <span data-ttu-id="9cf9f-191">傳回滑鼠最後選取之專案的索引。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-191">Returns the index of the item that the mouse last selected.</span></span>                                                                                                                                                                      |
| [<span data-ttu-id="9cf9f-192">**LB \_ GETCARETINDEX**</span><span class="sxs-lookup"><span data-stu-id="9cf9f-192">**LB\_GETCARETINDEX**</span></span>](lb-getcaretindex.md)             | <span data-ttu-id="9cf9f-193">傳回具有焦點矩形之專案的索引。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-193">Returns the index of the item that has the focus rectangle.</span></span>                                                                                                                                                                      |
| [<span data-ttu-id="9cf9f-194">**LB \_ GETCOUNT**</span><span class="sxs-lookup"><span data-stu-id="9cf9f-194">**LB\_GETCOUNT**</span></span>](lb-getcount.md)                       | <span data-ttu-id="9cf9f-195">傳回清單方塊中的專案數。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-195">Returns the number of items in the list box.</span></span>                                                                                                                                                                                     |
| [<span data-ttu-id="9cf9f-196">**LB \_ GETCURSEL**</span><span class="sxs-lookup"><span data-stu-id="9cf9f-196">**LB\_GETCURSEL**</span></span>](lb-getcursel.md)                     | <span data-ttu-id="9cf9f-197">傳回目前選取專案的索引。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-197">Returns the index of the currently selected item.</span></span>                                                                                                                                                                                |
| [<span data-ttu-id="9cf9f-198">**LB \_ GETHORIZONTALEXTENT**</span><span class="sxs-lookup"><span data-stu-id="9cf9f-198">**LB\_GETHORIZONTALEXTENT**</span></span>](lb-gethorizontalextent.md) | <span data-ttu-id="9cf9f-199">傳回清單方塊的可滾動寬度（以圖元為單位）。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-199">Returns the scrollable width, in pixels, of a list box.</span></span>                                                                                                                                                                          |
| [<span data-ttu-id="9cf9f-200">**LB \_ GETITEMDATA**</span><span class="sxs-lookup"><span data-stu-id="9cf9f-200">**LB\_GETITEMDATA**</span></span>](lb-getitemdata.md)                 | <span data-ttu-id="9cf9f-201">傳回與指定專案相關聯的值。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-201">Returns the value that is associated with the specified item.</span></span>                                                                                                                                                                    |
| [<span data-ttu-id="9cf9f-202">**LB \_ GETITEMHEIGHT**</span><span class="sxs-lookup"><span data-stu-id="9cf9f-202">**LB\_GETITEMHEIGHT**</span></span>](lb-getitemheight.md)             | <span data-ttu-id="9cf9f-203">傳回清單方塊中專案的高度（以圖元為單位）。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-203">Returns the height, in pixels, of an item in a list box.</span></span>                                                                                                                                                                         |
| [<span data-ttu-id="9cf9f-204">**LB \_ GETITEMRECT**</span><span class="sxs-lookup"><span data-stu-id="9cf9f-204">**LB\_GETITEMRECT**</span></span>](lb-getitemrect.md)                 | <span data-ttu-id="9cf9f-205">抓取指定清單方塊專案的用戶端座標。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-205">Retrieves the client coordinates of the specified list box item.</span></span>                                                                                                                                                                 |
| [<span data-ttu-id="9cf9f-206">**LB \_ GETLOCALE**</span><span class="sxs-lookup"><span data-stu-id="9cf9f-206">**LB\_GETLOCALE**</span></span>](lb-getlocale.md)                     | <span data-ttu-id="9cf9f-207">抓取清單方塊的地區設定。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-207">Retrieves the locale of the list box.</span></span> <span data-ttu-id="9cf9f-208">高序位單字包含國家/地區代碼，而低序位字組則包含語言識別項。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-208">The high-order word contains the country/region code and the low-order word contains the language identifier.</span></span>                                                                              |
| [<span data-ttu-id="9cf9f-209">**LB \_ GETSEL**</span><span class="sxs-lookup"><span data-stu-id="9cf9f-209">**LB\_GETSEL**</span></span>](lb-getsel.md)                           | <span data-ttu-id="9cf9f-210">傳回清單方塊專案的選取狀態。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-210">Returns the selection state of a list box item.</span></span>                                                                                                                                                                                  |
| [<span data-ttu-id="9cf9f-211">**LB \_ GETSELCOUNT**</span><span class="sxs-lookup"><span data-stu-id="9cf9f-211">**LB\_GETSELCOUNT**</span></span>](lb-getselcount.md)                 | <span data-ttu-id="9cf9f-212">在多重選取清單方塊中傳回選取的專案數目。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-212">Returns the number of selected items in a multiple-selection list box.</span></span>                                                                                                                                                           |
| [<span data-ttu-id="9cf9f-213">**LB \_ GETSELITEMS**</span><span class="sxs-lookup"><span data-stu-id="9cf9f-213">**LB\_GETSELITEMS**</span></span>](lb-getselitems.md)                 | <span data-ttu-id="9cf9f-214">在多重選取清單方塊中建立所有選定專案的索引陣列，並傳回選取的專案總數。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-214">Creates an array of the indexes of all selected items in a multiple-selection list box and returns the total number of selected items.</span></span>                                                                                           |
| [<span data-ttu-id="9cf9f-215">**LB \_ GETTEXT**</span><span class="sxs-lookup"><span data-stu-id="9cf9f-215">**LB\_GETTEXT**</span></span>](lb-gettext.md)                         | <span data-ttu-id="9cf9f-216">抓取與指定專案相關聯的字串，以及字串的長度。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-216">Retrieves the string associated with a specified item and the length of the string.</span></span>                                                                                                                                              |
| [<span data-ttu-id="9cf9f-217">**LB \_ GETTEXTLEN**</span><span class="sxs-lookup"><span data-stu-id="9cf9f-217">**LB\_GETTEXTLEN**</span></span>](lb-gettextlen.md)                   | <span data-ttu-id="9cf9f-218">傳回與指定專案相關聯之字串的長度（以字元為單位）。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-218">Returns the length, in characters, of the string associated with a specified item.</span></span>                                                                                                                                               |
| [<span data-ttu-id="9cf9f-219">**LB \_ GETTOPINDEX**</span><span class="sxs-lookup"><span data-stu-id="9cf9f-219">**LB\_GETTOPINDEX**</span></span>](lb-gettopindex.md)                 | <span data-ttu-id="9cf9f-220">傳回清單方塊中第一個可見專案的索引。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-220">Returns the index of the first visible item in a list box.</span></span>                                                                                                                                                                       |
| [<span data-ttu-id="9cf9f-221">**LB \_ INITSTORAGE**</span><span class="sxs-lookup"><span data-stu-id="9cf9f-221">**LB\_INITSTORAGE**</span></span>](lb-initstorage.md)                 | <span data-ttu-id="9cf9f-222">為指定的專案數和其相關聯的字串配置記憶體。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-222">Allocates memory for the specified number of items and their associated strings.</span></span>                                                                                                                                                 |
| [<span data-ttu-id="9cf9f-223">**LB \_ INSERTSTRING**</span><span class="sxs-lookup"><span data-stu-id="9cf9f-223">**LB\_INSERTSTRING**</span></span>](lb-insertstring.md)               | <span data-ttu-id="9cf9f-224">在清單方塊中的指定索引處插入字串。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-224">Inserts a string at a specified index in a list box.</span></span>                                                                                                                                                                             |
| [<span data-ttu-id="9cf9f-225">**LB \_ ITEMFROMPOINT**</span><span class="sxs-lookup"><span data-stu-id="9cf9f-225">**LB\_ITEMFROMPOINT**</span></span>](lb-itemfrompoint.md)             | <span data-ttu-id="9cf9f-226">抓取清單方塊中最接近指定點之專案的以零為基底的索引。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-226">Retrieves the zero-based index of the item nearest the specified point in a list box.</span></span>                                                                                                                                            |
| [<span data-ttu-id="9cf9f-227">**LB \_ RESETCONTENT**</span><span class="sxs-lookup"><span data-stu-id="9cf9f-227">**LB\_RESETCONTENT**</span></span>](lb-resetcontent.md)               | <span data-ttu-id="9cf9f-228">從清單方塊中移除所有專案。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-228">Removes all items from a list box.</span></span>                                                                                                                                                                                               |
| [<span data-ttu-id="9cf9f-229">**LB \_ SELECTSTRING**</span><span class="sxs-lookup"><span data-stu-id="9cf9f-229">**LB\_SELECTSTRING**</span></span>](lb-selectstring.md)               | <span data-ttu-id="9cf9f-230">選取找到的第一個符合指定前置詞的字串。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-230">Selects the first string it finds that matches a specified prefix.</span></span>                                                                                                                                                               |
| [<span data-ttu-id="9cf9f-231">**LB \_ SELITEMRANGE**</span><span class="sxs-lookup"><span data-stu-id="9cf9f-231">**LB\_SELITEMRANGE**</span></span>](lb-selitemrange.md)               | <span data-ttu-id="9cf9f-232">在清單方塊中選取指定的專案範圍。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-232">Selects a specified range of items in a list box.</span></span>                                                                                                                                                                                |
| [<span data-ttu-id="9cf9f-233">**LB \_ SELITEMRANGEEX**</span><span class="sxs-lookup"><span data-stu-id="9cf9f-233">**LB\_SELITEMRANGEEX**</span></span>](lb-selitemrangeex.md)           | <span data-ttu-id="9cf9f-234">如果範圍中第一個專案的索引小於範圍中最後一個專案的索引，則選取指定的專案範圍。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-234">Selects a specified range of items if the index of the first item in the range is less than the index of the last item in the range.</span></span> <span data-ttu-id="9cf9f-235">如果第一個專案的索引大於最後一個專案的索引，則取消選取範圍。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-235">Cancels the selection in the range if the index of the first item is greater than the last.</span></span> |
| [<span data-ttu-id="9cf9f-236">**LB \_ SETANCHORINDEX**</span><span class="sxs-lookup"><span data-stu-id="9cf9f-236">**LB\_SETANCHORINDEX**</span></span>](lb-setanchorindex.md)           | <span data-ttu-id="9cf9f-237">將滑鼠最後選取的專案設定為指定的專案。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-237">Sets the item that the mouse last selected to a specified item.</span></span>                                                                                                                                                                  |
| [<span data-ttu-id="9cf9f-238">**LB \_ SETCARETINDEX**</span><span class="sxs-lookup"><span data-stu-id="9cf9f-238">**LB\_SETCARETINDEX**</span></span>](lb-setcaretindex.md)             | <span data-ttu-id="9cf9f-239">將焦點矩形設定為指定的清單方塊專案。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-239">Sets the focus rectangle to a specified list box item.</span></span>                                                                                                                                                                           |
| [<span data-ttu-id="9cf9f-240">**LB \_ SETCOLUMNWIDTH**</span><span class="sxs-lookup"><span data-stu-id="9cf9f-240">**LB\_SETCOLUMNWIDTH**</span></span>](lb-setcolumnwidth.md)           | <span data-ttu-id="9cf9f-241">設定清單方塊中所有資料行的寬度（以圖元為單位）。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-241">Sets the width, in pixels, of all columns in a list box.</span></span>                                                                                                                                                                         |
| [<span data-ttu-id="9cf9f-242">**LB \_ SETCOUNT**</span><span class="sxs-lookup"><span data-stu-id="9cf9f-242">**LB\_SETCOUNT**</span></span>](lb-setcount.md)                       | <span data-ttu-id="9cf9f-243">設定清單方塊中的專案數。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-243">Sets the number of items in a list box.</span></span>                                                                                                                                                                                          |
| [<span data-ttu-id="9cf9f-244">**LB \_ SETCURSEL**</span><span class="sxs-lookup"><span data-stu-id="9cf9f-244">**LB\_SETCURSEL**</span></span>](lb-setcursel.md)                     | <span data-ttu-id="9cf9f-245">選取指定的清單方塊專案。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-245">Selects a specified list box item.</span></span>                                                                                                                                                                                               |
| [<span data-ttu-id="9cf9f-246">**LB \_ SETHORIZONTALEXTENT**</span><span class="sxs-lookup"><span data-stu-id="9cf9f-246">**LB\_SETHORIZONTALEXTENT**</span></span>](lb-sethorizontalextent.md) | <span data-ttu-id="9cf9f-247">設定清單方塊的可滾動寬度（以圖元為單位）。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-247">Sets the scrollable width, in pixels, of a list box.</span></span>                                                                                                                                                                             |
| [<span data-ttu-id="9cf9f-248">**LB \_ SETITEMDATA**</span><span class="sxs-lookup"><span data-stu-id="9cf9f-248">**LB\_SETITEMDATA**</span></span>](lb-setitemdata.md)                 | <span data-ttu-id="9cf9f-249">使值與清單方塊專案產生關聯。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-249">Associates a value with a list box item.</span></span>                                                                                                                                                                                         |
| [<span data-ttu-id="9cf9f-250">**LB \_ SETITEMHEIGHT**</span><span class="sxs-lookup"><span data-stu-id="9cf9f-250">**LB\_SETITEMHEIGHT**</span></span>](lb-setitemheight.md)             | <span data-ttu-id="9cf9f-251">設定清單方塊中專案或專案的高度（以圖元為單位）。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-251">Sets the height, in pixels, of an item or items in a list box.</span></span>                                                                                                                                                                   |
| [<span data-ttu-id="9cf9f-252">**LB \_ SETLOCALE**</span><span class="sxs-lookup"><span data-stu-id="9cf9f-252">**LB\_SETLOCALE**</span></span>](lb-setlocale.md)                     | <span data-ttu-id="9cf9f-253">設定清單方塊的地區設定，並傳回先前的地區設定識別碼。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-253">Sets the locale of a list box and returns the previous locale identifier.</span></span>                                                                                                                                                        |
| [<span data-ttu-id="9cf9f-254">**LB \_ SETSEL**</span><span class="sxs-lookup"><span data-stu-id="9cf9f-254">**LB\_SETSEL**</span></span>](lb-setsel.md)                           | <span data-ttu-id="9cf9f-255">在多重選取清單方塊中選取專案。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-255">Selects an item in a multiple-selection list box.</span></span>                                                                                                                                                                                |
| [<span data-ttu-id="9cf9f-256">**LB \_ SETTABSTOPS**</span><span class="sxs-lookup"><span data-stu-id="9cf9f-256">**LB\_SETTABSTOPS**</span></span>](lb-settabstops.md)                 | <span data-ttu-id="9cf9f-257">將索引標籤設定為指定陣列中所指定的索引鍵。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-257">Sets the tab stops to those specified in a specified array.</span></span>                                                                                                                                                                      |
| [<span data-ttu-id="9cf9f-258">**LB \_ SETTOPINDEX**</span><span class="sxs-lookup"><span data-stu-id="9cf9f-258">**LB\_SETTOPINDEX**</span></span>](lb-settopindex.md)                 | <span data-ttu-id="9cf9f-259">滾動清單方塊，讓指定的專案位於可見範圍的最上方。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-259">Scrolls the list box so the specified item is at the top of the visible range.</span></span>                                                                                                                                                   |



 

## <a name="default-window-message-processing"></a><span data-ttu-id="9cf9f-260">預設視窗訊息處理</span><span class="sxs-lookup"><span data-stu-id="9cf9f-260">Default Window Message Processing</span></span>

<span data-ttu-id="9cf9f-261">預先定義的清單方塊視窗類別的視窗程式會針對清單方塊未處理的所有訊息執行預設處理。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-261">The window procedure for the predefined list box window class carries out default processing for all messages that the list box does not process.</span></span> <span data-ttu-id="9cf9f-262">當清單方塊程式針對訊息傳回 **FALSE** 時，預先定義的視窗程式會檢查訊息，並執行預設動作，如下表所示。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-262">When the list box procedure returns **FALSE** for a message, the predefined window procedure checks the message and performs default actions, as shown in the following table.</span></span>



| <span data-ttu-id="9cf9f-263">訊息</span><span class="sxs-lookup"><span data-stu-id="9cf9f-263">Message</span></span>                                            | <span data-ttu-id="9cf9f-264">預設動作</span><span class="sxs-lookup"><span data-stu-id="9cf9f-264">Default action</span></span>                                                                                                                                                                                                                                                                                                                                                           |
|----------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="9cf9f-265">**WM \_ 字元**</span><span class="sxs-lookup"><span data-stu-id="9cf9f-265">**WM\_CHAR**</span></span>](/windows/desktop/inputdev/wm-char)                   | <span data-ttu-id="9cf9f-266">將選取範圍移至以使用者輸入的字元開頭的第一個專案。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-266">Moves the selection to the first item that begins with the character that the user typed.</span></span> <span data-ttu-id="9cf9f-267">如果清單方塊具有 L [**BS \_ OWNERDRAW**](button-styles.md) 樣式，則不會發生任何動作。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-267">If the list box has the L [**BS\_OWNERDRAW**](button-styles.md) style, no action occurs.</span></span> <span data-ttu-id="9cf9f-268">在短時間間隔內鍵入的多個字元會視為群組，並選取以該字元系列開頭的第一個專案。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-268">Multiple characters that are typed within a short interval are treated as a group, and the first item that begins with that series of characters is selected.</span></span><br/> |
| [<span data-ttu-id="9cf9f-269">**WM \_ 建立**</span><span class="sxs-lookup"><span data-stu-id="9cf9f-269">**WM\_CREATE**</span></span>](/windows/desktop/winmsg/wm-create)                 | <span data-ttu-id="9cf9f-270">建立空的清單方塊。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-270">Creates an empty list box.</span></span>                                                                                                                                                                                                                                                                                                                                               |
| [<span data-ttu-id="9cf9f-271">**WM 損 \_ 毀**</span><span class="sxs-lookup"><span data-stu-id="9cf9f-271">**WM\_DESTROY**</span></span>](/windows/desktop/winmsg/wm-destroy)               | <span data-ttu-id="9cf9f-272">終結清單方塊並釋出其使用的任何資源。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-272">Destroys the list box and frees any resources that it uses.</span></span>                                                                                                                                                                                                                                                                                                              |
|                                                    | <span data-ttu-id="9cf9f-273">將訊息傳遞至對話方塊程式或父視窗進程。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-273">Passes the message to the dialog box procedure or parent window process.</span></span>                                                                                                                                                                                                                                                                                                 |
| [<span data-ttu-id="9cf9f-274">**\_啟用 WM**</span><span class="sxs-lookup"><span data-stu-id="9cf9f-274">**WM\_ENABLE**</span></span>](/windows/desktop/winmsg/wm-enable)                 | <span data-ttu-id="9cf9f-275">如果控制項是可見的，則會使矩形失效，讓字串可以繪製成灰色。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-275">If the control is visible, invalidates the rectangle so the strings can be painted gray.</span></span>                                                                                                                                                                                                                                                                                 |
| [<span data-ttu-id="9cf9f-276">**WM \_ ERASEBKGND**</span><span class="sxs-lookup"><span data-stu-id="9cf9f-276">**WM\_ERASEBKGND**</span></span>](/windows/desktop/winmsg/wm-erasebkgnd)         | <span data-ttu-id="9cf9f-277">清除清單方塊的背景。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-277">Erases the background of a list box.</span></span> <span data-ttu-id="9cf9f-278">如果清單方塊具有 L [**BS \_ OWNERDRAW**](button-styles.md) 樣式，則不會清除背景。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-278">If the list box has the L [**BS\_OWNERDRAW**](button-styles.md) style, the background is not erased.</span></span>                                                                                                                                                                                                                   |
| [<span data-ttu-id="9cf9f-279">**WM \_ GETDLGCODE**</span><span class="sxs-lookup"><span data-stu-id="9cf9f-279">**WM\_GETDLGCODE**</span></span>](/windows/desktop/dlgbox/wm-getdlgcode)         | <span data-ttu-id="9cf9f-280">傳回 DLGC \_ WANTARROWS \| DLGC \_ WANTCHARS，表示預設清單方塊程式會處理方向鍵和 [**WM \_ 字元**](/windows/desktop/inputdev/wm-char) 訊息。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-280">Returns DLGC\_WANTARROWS \| DLGC\_WANTCHARS, indicating that the default list box procedure processes the arrow keys and [**WM\_CHAR**](/windows/desktop/inputdev/wm-char) messages.</span></span>                                                                                                                                                                                                      |
| [<span data-ttu-id="9cf9f-281">**WM \_ GETFONT**</span><span class="sxs-lookup"><span data-stu-id="9cf9f-281">**WM\_GETFONT**</span></span>](/windows/desktop/winmsg/wm-getfont)               | <span data-ttu-id="9cf9f-282">將控制碼傳回至清單方塊的目前字型。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-282">Returns a handle to the current font for the list box.</span></span>                                                                                                                                                                                                                                                                                                                   |
| [<span data-ttu-id="9cf9f-283">**WM \_ HSCROLL**</span><span class="sxs-lookup"><span data-stu-id="9cf9f-283">**WM\_HSCROLL**</span></span>](wm-hscroll.md)                  | <span data-ttu-id="9cf9f-284">水準滾動清單方塊。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-284">Scrolls the list box horizontally.</span></span>                                                                                                                                                                                                                                                                                                                                       |
| [<span data-ttu-id="9cf9f-285">**WM \_ KEYDOWN**</span><span class="sxs-lookup"><span data-stu-id="9cf9f-285">**WM\_KEYDOWN**</span></span>](/windows/desktop/inputdev/wm-keydown)             | <span data-ttu-id="9cf9f-286">處理虛擬機器碼以進行滾動。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-286">Processes virtual keys for scrolling.</span></span> <span data-ttu-id="9cf9f-287">虛擬機器碼是要將插入號移至其中的專案索引。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-287">The virtual key is the index of the item to move the caret to.</span></span> <span data-ttu-id="9cf9f-288">選取範圍不會變更。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-288">The selection is not changed.</span></span>                                                                                                                                                                                                                                       |
| [<span data-ttu-id="9cf9f-289">**WM \_ KILLFOCUS**</span><span class="sxs-lookup"><span data-stu-id="9cf9f-289">**WM\_KILLFOCUS**</span></span>](/windows/desktop/inputdev/wm-killfocus)         | <span data-ttu-id="9cf9f-290">關閉並終結插入號。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-290">Turns the caret off and destroys it.</span></span> <span data-ttu-id="9cf9f-291">將 [LBN \_ KILLFOCUS](lbn-killfocus.md) 通知碼傳送給清單方塊的擁有者。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-291">Sends an [LBN\_KILLFOCUS](lbn-killfocus.md) notification code to the owner of the list box.</span></span>                                                                                                                                                                                                                                        |
| [<span data-ttu-id="9cf9f-292">**WM \_ LBUTTONDBLCLK**</span><span class="sxs-lookup"><span data-stu-id="9cf9f-292">**WM\_LBUTTONDBLCLK**</span></span>](/windows/desktop/inputdev/wm-lbuttondblclk) | <span data-ttu-id="9cf9f-293">追蹤清單方塊工作區中的滑鼠。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-293">Tracks the mouse in the list box client area.</span></span> <span data-ttu-id="9cf9f-294">這可讓使用者在清單方塊用戶端區域之外放開滑鼠按鍵時，取消選取專案。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-294">This enables the user to cancel a selection if the mouse button is released outside the list box client area.</span></span>                                                                                                                                                                                                              |
| [<span data-ttu-id="9cf9f-295">**WM \_ LBUTTONDOWN**</span><span class="sxs-lookup"><span data-stu-id="9cf9f-295">**WM\_LBUTTONDOWN**</span></span>](/windows/desktop/inputdev/wm-lbuttondown)     | <span data-ttu-id="9cf9f-296">追蹤清單方塊工作區中的滑鼠。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-296">Tracks the mouse in the list box client area.</span></span> <span data-ttu-id="9cf9f-297">這可讓使用者在清單方塊用戶端區域之外放開滑鼠按鍵時，取消選取專案。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-297">This enables the user to cancel a selection if the mouse button is released outside the list box client area.</span></span>                                                                                                                                                                                                              |
| [<span data-ttu-id="9cf9f-298">**WM \_ LBUTTONUP**</span><span class="sxs-lookup"><span data-stu-id="9cf9f-298">**WM\_LBUTTONUP**</span></span>](/windows/desktop/inputdev/wm-lbuttonup)         | <span data-ttu-id="9cf9f-299">追蹤清單方塊工作區中的滑鼠。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-299">Tracks the mouse in the list box client area.</span></span> <span data-ttu-id="9cf9f-300">這可讓使用者在清單方塊用戶端區域之外放開滑鼠按鍵時，取消選取專案。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-300">This enables the user to cancel a selection if the mouse button is released outside the list box client area.</span></span>                                                                                                                                                                                                              |
| [<span data-ttu-id="9cf9f-301">**WM \_ MOUSEMOVE**</span><span class="sxs-lookup"><span data-stu-id="9cf9f-301">**WM\_MOUSEMOVE**</span></span>](/windows/desktop/inputdev/wm-mousemove)         | <span data-ttu-id="9cf9f-302">追蹤清單方塊工作區中的滑鼠。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-302">Tracks the mouse in the list box client area.</span></span> <span data-ttu-id="9cf9f-303">這可讓使用者在清單方塊用戶端區域之外放開滑鼠按鍵時，取消選取專案。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-303">This enables the user to cancel a selection if the mouse button is released outside the list box client area.</span></span>                                                                                                                                                                                                              |
| [<span data-ttu-id="9cf9f-304">**WM \_ 油漆**</span><span class="sxs-lookup"><span data-stu-id="9cf9f-304">**WM\_PAINT**</span></span>](/windows/desktop/gdi/wm-paint)                      | <span data-ttu-id="9cf9f-305">使用 (DC) 的裝置內容清單方塊控制碼，執行子類別化繪製作業。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-305">Performs a subclassed paint operation by using the list box handle to the device context (DC).</span></span>                                                                                                                                                                                                                                                                           |
| [<span data-ttu-id="9cf9f-306">**WM \_ SETFOCUS**</span><span class="sxs-lookup"><span data-stu-id="9cf9f-306">**WM\_SETFOCUS**</span></span>](/windows/desktop/inputdev/wm-setfocus)           | <span data-ttu-id="9cf9f-307">開啟插入號，並將 [LBN 的 \_ SETFOCUS](lbn-setfocus.md) 通知碼傳送給清單方塊的擁有者。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-307">Turns the caret on and sends an [LBN\_SETFOCUS](lbn-setfocus.md) notification code to the owner of the list box.</span></span>                                                                                                                                                                                                                                                        |
| [<span data-ttu-id="9cf9f-308">**WM \_ SETFONT**</span><span class="sxs-lookup"><span data-stu-id="9cf9f-308">**WM\_SETFONT**</span></span>](/windows/desktop/winmsg/wm-setfont)               | <span data-ttu-id="9cf9f-309">為清單方塊設定新的字型。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-309">Sets a new font for the list box.</span></span>                                                                                                                                                                                                                                                                                                                                        |
| [<span data-ttu-id="9cf9f-310">**WM \_ SETREDRAW**</span><span class="sxs-lookup"><span data-stu-id="9cf9f-310">**WM\_SETREDRAW**</span></span>](/windows/desktop/gdi/wm-setredraw)              | <span data-ttu-id="9cf9f-311">根據 *wParam* 的值，設定或清除重繪旗標。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-311">Sets or clears the redraw flag based on the value of *wParam*.</span></span>                                                                                                                                                                                                                                                                                                           |
| [<span data-ttu-id="9cf9f-312">**WM \_ 大小**</span><span class="sxs-lookup"><span data-stu-id="9cf9f-312">**WM\_SIZE**</span></span>](/windows/desktop/winmsg/wm-size)                     | <span data-ttu-id="9cf9f-313">將清單方塊的大小調整為整數專案數目。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-313">Resizes the list box to an integral number of items.</span></span>                                                                                                                                                                                                                                                                                                                     |
| [<span data-ttu-id="9cf9f-314">**WM \_ VSCROLL**</span><span class="sxs-lookup"><span data-stu-id="9cf9f-314">**WM\_VSCROLL**</span></span>](wm-vscroll.md)                  | <span data-ttu-id="9cf9f-315">垂直捲動清單方塊。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-315">Scrolls the list box vertically.</span></span>                                                                                                                                                                                                                                                                                                                                         |



 

<span data-ttu-id="9cf9f-316">預先定義的清單方塊程式會將所有其他訊息傳遞給 [**DefWindowProc**](/windows/desktop/api/winuser/nf-winuser-defwindowproca) ，以進行預設處理。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-316">The predefined list box procedure passes all other messages to [**DefWindowProc**](/windows/desktop/api/winuser/nf-winuser-defwindowproca) for default processing.</span></span>

## <a name="owner-drawn-list-boxes"></a><span data-ttu-id="9cf9f-317">Owner-Drawn 清單方塊</span><span class="sxs-lookup"><span data-stu-id="9cf9f-317">Owner-Drawn List Boxes</span></span>

<span data-ttu-id="9cf9f-318">應用程式可以建立主控 *描繪清單方塊* ，以承擔繪製清單專案的責任。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-318">An application can create an *owner-drawn* list box to take responsibility for painting list items.</span></span> <span data-ttu-id="9cf9f-319">主控描繪清單方塊的父視窗或對話方塊 (其 *擁有* 者) 需要繪製清單方塊的一部分時，才會收到 [**WM \_ DRAWITEM**](wm-drawitem.md) 訊息。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-319">The parent window or dialog box of an owner-drawn list box (its *owner*) receives [**WM\_DRAWITEM**](wm-drawitem.md) messages when a portion of the list box needs to be painted.</span></span> <span data-ttu-id="9cf9f-320">擁有者繪製清單方塊可以列出除了文字字串以外的資訊。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-320">An owner-drawn list box can list information other than, or in addition to, text strings.</span></span>

<span data-ttu-id="9cf9f-321">擁有者繪製清單方塊的擁有者必須處理 [**WM \_ DRAWITEM**](wm-drawitem.md) 訊息。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-321">The owner of an owner-drawn list box must process the [**WM\_DRAWITEM**](wm-drawitem.md) message.</span></span> <span data-ttu-id="9cf9f-322">每當需要重新繪製清單方塊的一部分時，就會傳送此訊息。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-322">This message is sent whenever a portion of the list box must be redrawn.</span></span> <span data-ttu-id="9cf9f-323">擁有者可能需要處理其他訊息，視針對清單方塊所指定的樣式而定。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-323">The owner may need to process other messages, depending on the styles specified for the list box.</span></span>

<span data-ttu-id="9cf9f-324">應用程式可以藉由指定 [**磅 \_ OWNERDRAWFIXED**](list-box-styles.md) 或 [**磅 \_ OWNERDRAWVARIABLE**](list-box-styles.md) 樣式來建立主控描繪清單方塊。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-324">An application can create an owner-drawn list box by specifying the [**LBS\_OWNERDRAWFIXED**](list-box-styles.md) or [**LBS\_OWNERDRAWVARIABLE**](list-box-styles.md) style.</span></span> <span data-ttu-id="9cf9f-325">如果清單方塊中的所有清單專案都有相同的高度（例如字串或圖示），則應用程式可以使用 **磅 \_ OWNERDRAWFIXED** 樣式。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-325">If all list items in the list box are the same height, such as strings or icons, an application can use the **LBS\_OWNERDRAWFIXED** style.</span></span> <span data-ttu-id="9cf9f-326">如果清單專案具有不同的高度 (例如，不同大小的點陣圖) 應用程式可以使用 **磅 \_ OWNERDRAWVARIABLE** 樣式。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-326">If list items are of varying height (for example, bitmaps of different size) an application can use the **LBS\_OWNERDRAWVARIABLE** style.</span></span>

<span data-ttu-id="9cf9f-327">擁有者繪製清單方塊的擁有者可以處理 [**WM \_ MEASUREITEM**](wm-measureitem.md) 訊息，以指定清單專案的維度。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-327">The owner of an owner-drawn list box can process a [**WM\_MEASUREITEM**](wm-measureitem.md) message to specify the dimensions of list items.</span></span> <span data-ttu-id="9cf9f-328">如果應用程式使用 [**磅 \_ OWNERDRAWFIXED**](list-box-styles.md) 樣式建立清單方塊，則系統只會傳送一次 **WM \_ MEASUREITEM** 訊息。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-328">If the application creates the list box by using the [**LBS\_OWNERDRAWFIXED**](list-box-styles.md) style, the system sends the **WM\_MEASUREITEM** message only once.</span></span> <span data-ttu-id="9cf9f-329">擁有者指定的維度會用於所有清單專案。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-329">The dimensions that are specified by the owner are used for all list items.</span></span> <span data-ttu-id="9cf9f-330">如果使用 [**磅 \_ OWNERDRAWVARIABLE**](list-box-styles.md) 樣式，系統就會針對每個新增至清單方塊的清單專案傳送 **WM \_ MEASUREITEM** 訊息。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-330">If the [**LBS\_OWNERDRAWVARIABLE**](list-box-styles.md) style is used, the system sends a **WM\_MEASUREITEM** message for each list item that is added to the list box.</span></span> <span data-ttu-id="9cf9f-331">擁有者可以在任何時間分別使用 [**LB \_ GETITEMHEIGHT**](lb-getitemheight.md) 和 [**lb \_ SETITEMHEIGHT**](lb-setitemheight.md) 訊息來判斷或設定清單專案的高度。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-331">The owner can determine or set the height of a list item at any time by using the [**LB\_GETITEMHEIGHT**](lb-getitemheight.md) and [**LB\_SETITEMHEIGHT**](lb-setitemheight.md) messages, respectively.</span></span>

<span data-ttu-id="9cf9f-332">如果顯示在主控描繪清單方塊中的資訊包含文字，應用程式可以藉由指定 [**磅 \_ HASSTRINGS**](list-box-styles.md) 樣式來追蹤每個清單專案的文字。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-332">If the information displayed in an owner-drawn list box includes text, an application can keep track of the text for each list item by specifying the [**LBS\_HASSTRINGS**](list-box-styles.md) style.</span></span> <span data-ttu-id="9cf9f-333">具有 [**磅 \_ 排序**](list-box-styles.md) 樣式的清單方塊會根據此文字來排序。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-333">List boxes with the [**LBS\_SORT**](list-box-styles.md) style are sorted based on this text.</span></span> <span data-ttu-id="9cf9f-334">如果清單方塊已排序，但不是 **磅 \_ HASSTRINGS** 樣式，則擁有者必須處理 [**WM \_ COMPAREITEM**](wm-compareitem.md) 訊息。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-334">If a list box is sorted, but is not of the **LBS\_HASSTRINGS** style, the owner must process the [**WM\_COMPAREITEM**](wm-compareitem.md) message.</span></span>

<span data-ttu-id="9cf9f-335">在主控描繪清單方塊中，擁有者必須追蹤包含除了文字以外之資訊的清單專案。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-335">In an owner-drawn list box, the owner must keep track of list items that contain information other than or in addition to text.</span></span> <span data-ttu-id="9cf9f-336">其中一個方便的方式，就是使用 [**LB \_ SETITEMDATA**](lb-setitemdata.md) 訊息將資訊的控制碼儲存為專案資料。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-336">One convenient way to do this is to save the handle to the information as item data by using the [**LB\_SETITEMDATA**](lb-setitemdata.md) message.</span></span> <span data-ttu-id="9cf9f-337">若要釋放與清單方塊中的專案相關聯的資料物件，擁有者可以處理 [**WM \_ DELETEITEM**](wm-deleteitem.md) 訊息。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-337">To free data objects associated with items in a list box, the owner can process the [**WM\_DELETEITEM**](wm-deleteitem.md) message.</span></span>

<span data-ttu-id="9cf9f-338">如需主控描繪清單方塊的範例，請參閱 [如何建立 Owner-Drawn 清單方塊](create-an-owner-drawn-list-box.md)。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-338">For an example of an owner-drawn list box, see [How to Create an Owner-Drawn List Box](create-an-owner-drawn-list-box.md).</span></span>

## <a name="drag-list-boxes"></a><span data-ttu-id="9cf9f-339">拖曳清單方塊</span><span class="sxs-lookup"><span data-stu-id="9cf9f-339">Drag List Boxes</span></span>

<span data-ttu-id="9cf9f-340">拖曳清單方塊是一種特殊類型的清單方塊，可讓使用者將專案從某個位置拖曳至另一個位置。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-340">A drag list box is a special type of list box that enables the user to drag items from one position to another.</span></span> <span data-ttu-id="9cf9f-341">應用程式可以使用拖曳清單方塊以特定順序顯示字串，並讓使用者將專案拖曳至 [位置] 來變更順序。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-341">An application can use a drag list box to display strings in a particular sequence and enable the user to change the sequence by dragging the items into position.</span></span>

### <a name="creating-drag-list-boxes"></a><span data-ttu-id="9cf9f-342">建立拖曳清單方塊</span><span class="sxs-lookup"><span data-stu-id="9cf9f-342">Creating Drag List Boxes</span></span>

<span data-ttu-id="9cf9f-343">拖曳清單方塊具有相同的視窗樣式，並處理與標準清單方塊相同的訊息。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-343">Drag list boxes have the same window styles and process the same messages as standard list boxes.</span></span> <span data-ttu-id="9cf9f-344">若要建立拖曳清單方塊，請先建立標準清單方塊，然後呼叫 [**MakeDragList**](/windows/desktop/api/Commctrl/nf-commctrl-makedraglist) 函數。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-344">To create a drag list box, first create a standard list box and then call the [**MakeDragList**](/windows/desktop/api/Commctrl/nf-commctrl-makedraglist) function.</span></span> <span data-ttu-id="9cf9f-345">若要將對話方塊中的清單方塊轉換成拖曳清單方塊，您可以在處理 WM INITDIALOG 訊息時呼叫 **MakeDragList** \_ 。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-345">To convert a list box in a dialog box to a drag list box, you can call **MakeDragList** when the WM\_INITDIALOG message is processed.</span></span>

### <a name="drag-list-box-messages"></a><span data-ttu-id="9cf9f-346">拖曳清單方塊訊息</span><span class="sxs-lookup"><span data-stu-id="9cf9f-346">Drag List Box Messages</span></span>

<span data-ttu-id="9cf9f-347">拖曳清單方塊會透過將拖曳清單訊息傳送給父視窗，來通知拖曳事件的父視窗。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-347">A drag list box notifies the parent window of drag events by sending it a drag list message.</span></span> <span data-ttu-id="9cf9f-348">父視窗必須處理拖曳清單訊息。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-348">The parent window must process the drag list message.</span></span>

<span data-ttu-id="9cf9f-349">當呼叫 [**MakeDragList**](/windows/desktop/api/Commctrl/nf-commctrl-makedraglist) 函式時，拖曳清單方塊會註冊此訊息。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-349">The drag list box registers this message when the [**MakeDragList**](/windows/desktop/api/Commctrl/nf-commctrl-makedraglist) function is called.</span></span> <span data-ttu-id="9cf9f-350">若要取得拖曳清單訊息 (數值) 的訊息識別碼，請呼叫 [**RegisterWindowMessage**](/windows/desktop/api/winuser/nf-winuser-registerwindowmessagea) 函式，並指定 DRAGLISTMSGSTRING 值。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-350">To retrieve the message identifier (numeric value) of the drag list message, call the [**RegisterWindowMessage**](/windows/desktop/api/winuser/nf-winuser-registerwindowmessagea) function and specify the DRAGLISTMSGSTRING value.</span></span>

<span data-ttu-id="9cf9f-351">拖曳清單訊息的 *wParam* 參數是拖曳清單方塊的控制項識別碼。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-351">The *wParam* parameter of the drag list message is the control identifier for the drag list box.</span></span> <span data-ttu-id="9cf9f-352">*LParam* 參數是 [**DRAGLISTINFO**](/windows/win32/api/commctrl/ns-commctrl-draglistinfo)結構的位址，其中包含拖曳事件的通知碼和其他資訊。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-352">The *lParam* parameter is the address of a [**DRAGLISTINFO**](/windows/win32/api/commctrl/ns-commctrl-draglistinfo) structure, which contains the notification code for the drag event and other information.</span></span> <span data-ttu-id="9cf9f-353">訊息的傳回值取決於通知。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-353">The return value of the message depends on the notification.</span></span>

### <a name="drag-list-box-notification-codes"></a><span data-ttu-id="9cf9f-354">拖曳清單方塊通知碼</span><span class="sxs-lookup"><span data-stu-id="9cf9f-354">Drag List Box Notification Codes</span></span>

<span data-ttu-id="9cf9f-355">拖曳清單通知碼（由拖曳清單訊息所包含之 [**DRAGLISTINFO**](/windows/win32/api/commctrl/ns-commctrl-draglistinfo)結構的 **uNotification** 成員識別）可以是 [ [dl \_ BEGINDRAG](dl-begindrag.md)]、[ [dl \_ 拖曳](dl-dragging.md)]、[ [dl \_ CANCELDRAG](dl-canceldrag.md)] 或 [dl 已卸載]。 [ \_](dl-dropped.md)</span><span class="sxs-lookup"><span data-stu-id="9cf9f-355">The drag list notification code, which is identified by the **uNotification** member of the [**DRAGLISTINFO**](/windows/win32/api/commctrl/ns-commctrl-draglistinfo) structure included with the drag list message, can be [DL\_BEGINDRAG](dl-begindrag.md), [DL\_DRAGGING](dl-dragging.md), [DL\_CANCELDRAG](dl-canceldrag.md), or [DL\_DROPPED](dl-dropped.md).</span></span>

<span data-ttu-id="9cf9f-356">當游標位於清單專案，且使用者按下滑鼠左鍵時，會傳送 [DL \_ BEGINDRAG](dl-begindrag.md) 通知碼。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-356">The [DL\_BEGINDRAG](dl-begindrag.md) notification code is sent when the cursor is on a list item and the user clicks the left mouse button.</span></span> <span data-ttu-id="9cf9f-357">父視窗可以傳回 **TRUE** 來開始拖曳作業，或傳回 **FALSE** 以禁止拖曳。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-357">The parent window can return **TRUE** to begin the drag operation or **FALSE** to disallow dragging.</span></span> <span data-ttu-id="9cf9f-358">如此一來，父視窗就可以針對某些清單專案進行拖曳，並為其他專案停用它。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-358">In this way, the parent window can enable dragging for some list items and disable it for others.</span></span> <span data-ttu-id="9cf9f-359">您可以使用 [**LBItemFromPt**](/windows/desktop/api/Commctrl/nf-commctrl-lbitemfrompt) 函數，判斷哪個清單專案位於指定的位置。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-359">You can determine which list item is at the specified location by using the [**LBItemFromPt**](/windows/desktop/api/Commctrl/nf-commctrl-lbitemfrompt) function.</span></span>

<span data-ttu-id="9cf9f-360">如果正在進行拖曳，則每次移動滑鼠時，或是在未移動滑鼠時，以固定間隔傳送 [DL \_ 拖曳](dl-dragging.md) 通知碼。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-360">If dragging is in effect, the [DL\_DRAGGING](dl-dragging.md) notification code is sent whenever the mouse is moved, or at regular intervals if the mouse is not being moved.</span></span> <span data-ttu-id="9cf9f-361">父視窗應該會先使用 [**LBItemFromPt**](/windows/desktop/api/Commctrl/nf-commctrl-lbitemfrompt) 來判斷游標下的清單專案，然後使用 [**DrawInsert**](/windows/desktop/api/Commctrl/nf-commctrl-drawinsert) 函數來繪製插入圖示。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-361">The parent window should first determine the list item under the cursor by using [**LBItemFromPt**](/windows/desktop/api/Commctrl/nf-commctrl-lbitemfrompt) and then draw the insert icon by using the [**DrawInsert**](/windows/desktop/api/Commctrl/nf-commctrl-drawinsert) function.</span></span> <span data-ttu-id="9cf9f-362">藉由針對 **LBItemFromPt** 的 *BAutoScroll* 參數指定 **TRUE** ，如果游標位於其工作區的上方或下方，您就可以讓清單方塊以一行滾動。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-362">By specifying **TRUE** for the *bAutoScroll* parameter of **LBItemFromPt**, you can cause the list box to scroll by one line if the cursor is above or below its client area.</span></span> <span data-ttu-id="9cf9f-363">您為此通知傳回的值會指定要設定拖曳清單方塊的滑鼠游標類型。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-363">The value you return for this notification specifies the type of mouse cursor that the drag list box should set.</span></span>

<span data-ttu-id="9cf9f-364">如果使用者以滑鼠右鍵按一下滑鼠右鍵，或按下 ESC 鍵，則會傳送 [DL \_ CANCELDRAG](dl-canceldrag.md) 通知碼。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-364">The [DL\_CANCELDRAG](dl-canceldrag.md) notification code is sent if the user cancels a drag operation by clicking the right mouse button or pressing the ESC key.</span></span> <span data-ttu-id="9cf9f-365">如果使用者透過放開滑鼠左鍵完成拖曳作業，即使游標不在清單專案上，也會傳送 DL 已卸載的通知碼。 [ \_ ](dl-dropped.md)</span><span class="sxs-lookup"><span data-stu-id="9cf9f-365">The [DL\_DROPPED](dl-dropped.md) notification code is sent if the user completes a drag operation by releasing the left mouse button, even if the cursor is not over a list item.</span></span> <span data-ttu-id="9cf9f-366">拖曳清單方塊會在傳送任一通知之前，先放開滑鼠捕捉。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-366">The drag list box releases the mouse capture before sending either notification.</span></span> <span data-ttu-id="9cf9f-367">這兩個通知的傳回值會被忽略。</span><span class="sxs-lookup"><span data-stu-id="9cf9f-367">The return value of these two notifications is ignored.</span></span> <span data-ttu-id="9cf9f-368">拖曳清單</span><span class="sxs-lookup"><span data-stu-id="9cf9f-368">Drag List</span></span>

 

