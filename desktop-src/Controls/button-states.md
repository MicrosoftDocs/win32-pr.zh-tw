---
title: 按鈕狀態
description: 本節將討論如何選取按鈕來變更其狀態，以及應用程式應該如何回應。
ms.assetid: 7302f0f3-f29d-43d7-8e25-4f36d5ef6a86
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 96865191ac64b14dd35ff1d22631c6bf11763aff
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/21/2020
ms.locfileid: "104463809"
---
# <a name="button-states"></a>按鈕狀態

本節將討論如何選取按鈕來變更其狀態，以及應用程式應該如何回應。

本節包含下列主題：

-   [按鈕選取](#button-selection)
-   [按鈕狀態的元素](#elements-of-a-button-state)
    -   [焦點狀態](#focus-state)
    -   [推送狀態](#push-state)
    -   [檢查狀態](#check-state)
-   [按鈕狀態的變更](#changes-to-a-button-state)

## <a name="button-selection"></a>按鈕選取

使用者可以透過下列三種方式來選取按鈕：以滑鼠按一下按鈕、依序移至該按鈕，然後按下 ENTER 鍵，或者 (如果按鈕是 [**WS \_ group**](/windows/desktop/winmsg/window-styles) 樣式所定義之群組的一部分) 方法是在群組中使用方向鍵，然後使用方向鍵在該群組內移動。 這兩個定位方法是系統所提供的預先定義鍵盤介面的一部分。 如需此介面的完整描述，請參閱 [對話方塊](/windows/desktop/dlgbox/dialog-boxes)。

選取按鈕通常會導致下列事件：

-   系統會為按鈕提供鍵盤焦點。
-   按鈕會將訊息傳送給其父視窗，以通知其選取專案。
-   父視窗 (或系統) 傳送訊息給按鈕以變更其狀態。
-   父視窗 (或系統) 會重新繪製按鈕，以反映其新狀態。

## <a name="elements-of-a-button-state"></a>按鈕狀態的元素

按鈕的狀態可依焦點狀態、推播狀態和檢查狀態來表徵。

-   [焦點狀態](#focus-state)
-   [推送狀態](#push-state)
-   [檢查狀態](#check-state)

### <a name="focus-state"></a>焦點狀態

焦點狀態適用于核取方塊、選項按鈕、推播按鈕或主控描繪按鈕。 當使用者選取按鈕時，按鈕就會收到鍵盤焦點，並在使用者選取另一個控制項時失去焦點。 一次只能有一個控制項可以有鍵盤焦點。

當按鈕具有鍵盤焦點時，系統通常會以虛線括住，以反白顯示按鈕的文字、圖示或點陣圖。 此外，當按鈕具有焦點時，按鈕的深色框線也會很高。 系統會自動變更自動按鈕的醒目提示，但應用程式必須藉由傳送訊息來變更非自動按鈕的醒目提示。

### <a name="push-state"></a>推送狀態

推送狀態會套用至下拉按鈕、核取方塊、選項按鈕或三個狀態的核取方塊，但不適用於其他按鈕。 按鈕的推送狀態可以是已推送或未推送。 推送按鈕 (或具有 [**BS \_ PUSHLIKE**](button-styles.md) 樣式) 的任何按鈕時，按鈕就會繪製為凹陷按鈕。 未推送時，會將它繪製為引發按鈕。 按一下核取方塊、選項按鈕或三個狀態核取方塊時，按鈕的背景會呈現灰色。 未推送時，按鈕的背景不會呈現灰色。

### <a name="check-state"></a>檢查狀態

檢查狀態適用于核取方塊、選項按鈕或三個狀態核取方塊，但不適用於其他按鈕。 您可以針對三種狀態的核取方塊檢查、清除或 (狀態，) 不定。 如果核取方塊包含核取記號，則會核取該核取方塊，並在沒有核取方塊時清除。 當選項按鈕包含黑色點時，就會核取該按鈕;當它不存在時，就會清除此選項。 如果有三個狀態核取方塊，則會在它包含核取記號時加以清除，如果沒有，則會清除，而且當它包含灰色方塊時，則會予以不定。 系統會自動變更自動按鈕的檢查狀態，但應用程式必須變更非自動按鈕的檢查狀態。

## <a name="changes-to-a-button-state"></a>按鈕狀態的變更

當使用者選取按鈕時，通常需要變更一或多個按鈕的狀態元素。 系統會自動變更所有按鈕類型的焦點狀態、推播按鈕的推送狀態或具有 [**BS \_ PUSHLIKE**](button-styles.md) 樣式的按鈕，以及所有自動按鈕的檢查狀態。 應用程式必須進行所有其他狀態變更，並將按鈕的類型、樣式和目前的狀態納入考慮。 下列清單顯示每個按鈕類型必須變更的狀態元素：

-   核取方塊必須變更檢查狀態。
-   選項按鈕必須變更檢查狀態。 您也可能需要變更相同群組中其他選項按鈕的檢查狀態，以確保選項按鈕的互斥本質。
-   由於主控描繪按鈕的狀態與應用程式相依，因此應用程式在按鈕中必須變更的內容可能會有所不同。 必須變更群組方塊的元素，因為使用者無法選取群組框。

應用程式可以將 [**BM \_ GETCHECK**](bm-getcheck.md) 或 [**BM \_ >getstate**](bm-getstate.md) 訊息傳送給它，藉以判斷按鈕的狀態; 應用程式可以將 [**BM \_ SETCHECK**](bm-setcheck.md) 或 [**BM \_ SETSTATE**](bm-setstate.md) 訊息傳送給它，藉以設定按鈕的狀態。

 

 