---
title: '狀態列 (Windows 控制項) '
description: 狀態列是父視窗底部的水準視窗，其中應用程式可以顯示各種類型的狀態資訊。
ms.assetid: vs|controls|~\controls\status\status.htm
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 3c2d1130b25cf0dc6373021e063210b765aa34a5
ms.sourcegitcommit: 8fa6614b715bddf14648cce36d2df22e5232801a
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 12/10/2020
ms.locfileid: "106969547"
---
# <a name="status-bars-windows-controls"></a><span data-ttu-id="fef3a-103">狀態列 (Windows 控制項) </span><span class="sxs-lookup"><span data-stu-id="fef3a-103">Status Bars (Windows Controls)</span></span>

<span data-ttu-id="fef3a-104">*狀態列* 是父視窗底部的水準視窗，其中應用程式可以顯示各種類型的狀態資訊。</span><span class="sxs-lookup"><span data-stu-id="fef3a-104">A *status bar* is a horizontal window at the bottom of a parent window in which an application can display various kinds of status information.</span></span> <span data-ttu-id="fef3a-105">狀態列可以分割成多個部分，以顯示一種以上的資訊。</span><span class="sxs-lookup"><span data-stu-id="fef3a-105">The status bar can be divided into parts to display more than one type of information.</span></span> <span data-ttu-id="fef3a-106">下列螢幕擷取畫面顯示 Microsoft Windows 油漆應用程式中的狀態列。</span><span class="sxs-lookup"><span data-stu-id="fef3a-106">The following screen shot shows the status bar in the Microsoft Windows Paint application.</span></span> <span data-ttu-id="fef3a-107">在此情況下，狀態列會包含文字「若要協助，請按一下 [說明] 功能表上的 [說明主題]。</span><span class="sxs-lookup"><span data-stu-id="fef3a-107">In this case, the status bar contains the text "For Help, click Help Topics on the Help Menu".</span></span> <span data-ttu-id="fef3a-108">狀態列是視窗底部的區域，其中包含解說文字和座標資訊。</span><span class="sxs-lookup"><span data-stu-id="fef3a-108">The status bar is the area at the bottom of the window that contains Help text and coordinate information.</span></span>

![繪圖應用程式的螢幕擷取畫面，包含包含線上說明相關提示的狀態列](images/sb-paint.png)

<span data-ttu-id="fef3a-110">本節包含下列主題。</span><span class="sxs-lookup"><span data-stu-id="fef3a-110">This section includes the following topics.</span></span>

-   [<span data-ttu-id="fef3a-111">類型和樣式</span><span class="sxs-lookup"><span data-stu-id="fef3a-111">Types and Styles</span></span>](#types-and-styles)
-   [<span data-ttu-id="fef3a-112">大小和高度</span><span class="sxs-lookup"><span data-stu-id="fef3a-112">Size and Height</span></span>](#size-and-height)
-   [<span data-ttu-id="fef3a-113">多部分的狀態列</span><span class="sxs-lookup"><span data-stu-id="fef3a-113">Multiple-Part Status Bars</span></span>](#multiple-part-status-bars)
-   [<span data-ttu-id="fef3a-114">狀態列文字作業</span><span class="sxs-lookup"><span data-stu-id="fef3a-114">Status Bar Text Operations</span></span>](#status-bar-text-operations)
-   [<span data-ttu-id="fef3a-115">擁有者繪製的狀態列</span><span class="sxs-lookup"><span data-stu-id="fef3a-115">Owner-Drawn Status Bars</span></span>](#owner-drawn-status-bars)
-   [<span data-ttu-id="fef3a-116">簡單模式狀態列</span><span class="sxs-lookup"><span data-stu-id="fef3a-116">Simple Mode Status Bars</span></span>](#simple-mode-status-bars)
-   [<span data-ttu-id="fef3a-117">預設狀態列訊息處理</span><span class="sxs-lookup"><span data-stu-id="fef3a-117">Default Status Bar Message Processing</span></span>](#default-status-bar-message-processing)

## <a name="types-and-styles"></a><span data-ttu-id="fef3a-118">類型和樣式</span><span class="sxs-lookup"><span data-stu-id="fef3a-118">Types and Styles</span></span>

<span data-ttu-id="fef3a-119">狀態列的預設位置是在父視窗的底部，但您可以指定 [**CCS \_ top**](common-control-styles.md) 樣式，讓它出現在父視窗的工作區頂端。</span><span class="sxs-lookup"><span data-stu-id="fef3a-119">The default position of a status bar is along the bottom of the parent window, but you can specify the [**CCS\_TOP**](common-control-styles.md) style to have it appear at the top of the parent window's client area.</span></span>

<span data-ttu-id="fef3a-120">您可以指定 [**SBARS \_ SIZEGRIP**](status-bar-styles.md) 樣式，在狀態列的右端包含調整大小的底框。</span><span class="sxs-lookup"><span data-stu-id="fef3a-120">You can specify the [**SBARS\_SIZEGRIP**](status-bar-styles.md) style to include a sizing grip at the right end of the status bar.</span></span>

> [!Note]  
> <span data-ttu-id="fef3a-121">不建議結合 [**CCS \_ TOP**](common-control-styles.md) 和 [**SBARS \_ SIZEGRIP**](status-bar-styles.md) 樣式，因為產生的調整大小底框無法正常運作。</span><span class="sxs-lookup"><span data-stu-id="fef3a-121">Combining the [**CCS\_TOP**](common-control-styles.md) and [**SBARS\_SIZEGRIP**](status-bar-styles.md) styles is not recommended because the resulting sizing grip is not functional.</span></span>

 

## <a name="size-and-height"></a><span data-ttu-id="fef3a-122">大小和高度</span><span class="sxs-lookup"><span data-stu-id="fef3a-122">Size and Height</span></span>

<span data-ttu-id="fef3a-123">狀態列的視窗程式會自動設定視窗的初始大小和位置，並忽略 [**CreateWindowEx**](/windows/desktop/api/winuser/nf-winuser-createwindowexa) 函數中指定的值。</span><span class="sxs-lookup"><span data-stu-id="fef3a-123">The window procedure for the status bar automatically sets the initial size and position of the window, ignoring the values specified in the [**CreateWindowEx**](/windows/desktop/api/winuser/nf-winuser-createwindowexa) function.</span></span> <span data-ttu-id="fef3a-124">這個寬度與父視窗工作區的寬度相同。</span><span class="sxs-lookup"><span data-stu-id="fef3a-124">The width is the same as that of the parent window's client area.</span></span> <span data-ttu-id="fef3a-125">高度是根據目前在狀態列裝置內容中所選取之字型的度量，以及視窗框線的寬度。</span><span class="sxs-lookup"><span data-stu-id="fef3a-125">The height is based on the metrics of the font that is currently selected into the status bar's device context and on the width of the window's borders.</span></span>

<span data-ttu-id="fef3a-126">視窗程式會在每次收到 [**WM \_ 大小**](/windows/desktop/winmsg/wm-size) 訊息時，自動調整狀態列的大小。</span><span class="sxs-lookup"><span data-stu-id="fef3a-126">The window procedure automatically adjusts the size of the status bar whenever it receives a [**WM\_SIZE**](/windows/desktop/winmsg/wm-size) message.</span></span> <span data-ttu-id="fef3a-127">一般而言，父視窗的大小變更時，父視窗會將 **WM \_ 大小** 訊息傳送到狀態列。</span><span class="sxs-lookup"><span data-stu-id="fef3a-127">Typically, when the size of the parent window changes, the parent sends a **WM\_SIZE** message to the status bar.</span></span>

<span data-ttu-id="fef3a-128">應用程式可以藉由傳送 [**SB \_ SETMINHEIGHT**](sb-setminheight.md) 訊息（以圖元為單位）來設定狀態列的繪圖區域最小高度。</span><span class="sxs-lookup"><span data-stu-id="fef3a-128">An application can set the minimum height of a status bar's drawing area by sending the window an [**SB\_SETMINHEIGHT**](sb-setminheight.md) message, specifying the minimum height, in pixels.</span></span> <span data-ttu-id="fef3a-129">繪圖區域不包括視窗框線。</span><span class="sxs-lookup"><span data-stu-id="fef3a-129">The drawing area does not include the window's borders.</span></span> <span data-ttu-id="fef3a-130">最小高度適用于在主控描繪的狀態列中繪製。</span><span class="sxs-lookup"><span data-stu-id="fef3a-130">A minimum height is useful for drawing in an owner-drawn status bar.</span></span> <span data-ttu-id="fef3a-131">如需詳細資訊，請參閱本章稍後的主控描繪 [狀態列](#owner-drawn-status-bars) 。</span><span class="sxs-lookup"><span data-stu-id="fef3a-131">For more information, see [Owner-Drawn Status Bars](#owner-drawn-status-bars) later in this chapter.</span></span>

<span data-ttu-id="fef3a-132">您可以藉由傳送 [**SB \_ GETBORDERS**](sb-getborders.md) 訊息的時間範圍，來取得狀態列的框線寬度。</span><span class="sxs-lookup"><span data-stu-id="fef3a-132">You retrieve the widths of the borders of a status bar by sending the window an [**SB\_GETBORDERS**](sb-getborders.md) message.</span></span> <span data-ttu-id="fef3a-133">訊息包含接收寬度之三個元素陣列的位址。</span><span class="sxs-lookup"><span data-stu-id="fef3a-133">The message includes the address of a three-element array that receives the widths.</span></span>

## <a name="multiple-part-status-bars"></a><span data-ttu-id="fef3a-134">Multiple-Part 狀態列</span><span class="sxs-lookup"><span data-stu-id="fef3a-134">Multiple-Part Status Bars</span></span>

<span data-ttu-id="fef3a-135">狀態列可以有許多不同的部分，每個部分會顯示不同的文字行。</span><span class="sxs-lookup"><span data-stu-id="fef3a-135">A status bar can have many different parts, each displaying a different line of text.</span></span> <span data-ttu-id="fef3a-136">您可以藉由傳送 [**SB \_ SETPARTS**](sb-setparts.md) 訊息給視窗，並指定要建立的部分數目和整數陣列的位址，將狀態列分割成各部分。</span><span class="sxs-lookup"><span data-stu-id="fef3a-136">You divide a status bar into parts by sending the window an [**SB\_SETPARTS**](sb-setparts.md) message, specifying the number of parts to create and the address of an integer array.</span></span> <span data-ttu-id="fef3a-137">陣列中每個元件都包含一個元素，而每個元素都會指定元件右邊緣的用戶端座標。</span><span class="sxs-lookup"><span data-stu-id="fef3a-137">The array contains one element for each part, and each element specifies the client coordinate of the right edge of a part.</span></span>

<span data-ttu-id="fef3a-138">狀態列的最大值為256個部分，但應用程式通常使用的數量遠低於該部分。</span><span class="sxs-lookup"><span data-stu-id="fef3a-138">A status bar can have a maximum of 256 parts, although applications typically use far fewer than that.</span></span> <span data-ttu-id="fef3a-139">您可以藉由傳送 [**SB \_ GETPARTS**](sb-getparts.md) 訊息的時間範圍，抓取狀態列中的元件計數，以及每個元件右邊緣的座標。</span><span class="sxs-lookup"><span data-stu-id="fef3a-139">You retrieve a count of the parts in a status bar, as well as the coordinate of the right edge of each part, by sending the window an [**SB\_GETPARTS**](sb-getparts.md) message.</span></span>

## <a name="status-bar-text-operations"></a><span data-ttu-id="fef3a-140">狀態列文字作業</span><span class="sxs-lookup"><span data-stu-id="fef3a-140">Status Bar Text Operations</span></span>

<span data-ttu-id="fef3a-141">您可以藉由傳送 [**SB \_ SETTEXT**](sb-settext.md) 訊息、指定元件以零為起始的索引、要在元件中繪製之字串的位址，以及用來繪製字串的技巧，來設定狀態列任何部分的文字。</span><span class="sxs-lookup"><span data-stu-id="fef3a-141">You set the text of any part of a status bar by sending the [**SB\_SETTEXT**](sb-settext.md) message, specifying the zero-based index of a part, an address of the string to draw in the part, and the technique for drawing the string.</span></span> <span data-ttu-id="fef3a-142">繪圖技術會判斷文字是否有框線，以及框線的樣式（如果有的話）。</span><span class="sxs-lookup"><span data-stu-id="fef3a-142">The drawing technique determines whether the text has a border and, if it does, the style of the border.</span></span> <span data-ttu-id="fef3a-143">它也會決定父視窗是否負責繪製文字。</span><span class="sxs-lookup"><span data-stu-id="fef3a-143">It also determines whether the parent window is responsible for drawing the text.</span></span> <span data-ttu-id="fef3a-144">如需詳細資訊，請參閱以下的主控描繪 [狀態列](#owner-drawn-status-bars) 一節。</span><span class="sxs-lookup"><span data-stu-id="fef3a-144">For more information, see the [Owner-Drawn Status Bars](#owner-drawn-status-bars) section below.</span></span>

<span data-ttu-id="fef3a-145">根據預設，文字會在狀態列的指定部分中靠左對齊。</span><span class="sxs-lookup"><span data-stu-id="fef3a-145">By default, text is left-aligned within the specified part of a status bar.</span></span> <span data-ttu-id="fef3a-146">您可以 \\ 在文字中內嵌定位字元 (t) ，或將其靠右對齊。</span><span class="sxs-lookup"><span data-stu-id="fef3a-146">You can embed tab characters (\\ t) in the text to center or right-align it.</span></span> <span data-ttu-id="fef3a-147">單一索引標籤字元右邊的文字置中，而第二個定位字元右邊的文字靠右對齊。</span><span class="sxs-lookup"><span data-stu-id="fef3a-147">Text to the right of a single tab character is centered, and text to the right of a second tab character is right-aligned.</span></span>

<span data-ttu-id="fef3a-148">若要從狀態列取出文字，請使用 [**sb \_ GETTEXTLENGTH**](sb-gettextlength.md) 和 [**sb \_ GETTEXT**](sb-gettext.md) 訊息。</span><span class="sxs-lookup"><span data-stu-id="fef3a-148">To retrieve text from a status bar, use the [**SB\_GETTEXTLENGTH**](sb-gettextlength.md) and [**SB\_GETTEXT**](sb-gettext.md) messages.</span></span>

<span data-ttu-id="fef3a-149">如果您的應用程式使用只有一個部分的狀態列，您可以使用 [**wm \_ SETTEXT**](/windows/desktop/winmsg/wm-settext)、 [**wm \_ GETTEXT**](/windows/desktop/winmsg/wm-gettext)和 [**wm \_ GETTEXTLENGTH**](/windows/desktop/winmsg/wm-gettextlength) 訊息來執行文字作業。</span><span class="sxs-lookup"><span data-stu-id="fef3a-149">If your application uses a status bar that has only one part, you can use the [**WM\_SETTEXT**](/windows/desktop/winmsg/wm-settext), [**WM\_GETTEXT**](/windows/desktop/winmsg/wm-gettext), and [**WM\_GETTEXTLENGTH**](/windows/desktop/winmsg/wm-gettextlength) messages to perform text operations.</span></span> <span data-ttu-id="fef3a-150">這些訊息只會處理索引為零的部分，可讓您將狀態列視為靜態文字控制項。</span><span class="sxs-lookup"><span data-stu-id="fef3a-150">These messages deal only with the part that has an index of zero, allowing you to treat the status bar much like a static text control.</span></span>

<span data-ttu-id="fef3a-151">若要顯示未建立狀態列的狀態行，請使用 [**DrawStatusText**](/windows/desktop/api/Commctrl/nf-commctrl-drawstatustexta) 函數。</span><span class="sxs-lookup"><span data-stu-id="fef3a-151">To display a line of status without creating a status bar, use the [**DrawStatusText**](/windows/desktop/api/Commctrl/nf-commctrl-drawstatustexta) function.</span></span> <span data-ttu-id="fef3a-152">函式使用相同的技術，將狀態繪製為狀態列的視窗程式，但不會自動設定狀態資訊的大小和位置。</span><span class="sxs-lookup"><span data-stu-id="fef3a-152">The function uses the same techniques to draw the status as the window procedure for the status bar, but it does not automatically set the size and position of the status information.</span></span> <span data-ttu-id="fef3a-153">呼叫函式時，您必須指定狀態資訊的大小和位置，以及要在其中繪製它之視窗的裝置內容。</span><span class="sxs-lookup"><span data-stu-id="fef3a-153">When calling the function, you must specify the size and position of the status information as well as the device context of the window in which to draw it.</span></span>

## <a name="owner-drawn-status-bars"></a><span data-ttu-id="fef3a-154">Owner-Drawn 狀態列</span><span class="sxs-lookup"><span data-stu-id="fef3a-154">Owner-Drawn Status Bars</span></span>

<span data-ttu-id="fef3a-155">您可以將狀態列的個別部分定義為主控描繪的部分。</span><span class="sxs-lookup"><span data-stu-id="fef3a-155">You can define individual parts of a status bar to be owner-drawn parts.</span></span> <span data-ttu-id="fef3a-156">使用這項技術可讓您擁有更多的控制權，而不是視窗元件的外觀。</span><span class="sxs-lookup"><span data-stu-id="fef3a-156">Using this technique gives you more control than you would otherwise have over the appearance of the window part.</span></span> <span data-ttu-id="fef3a-157">例如，您可以顯示點陣圖而非文字，或使用不同的字型來繪製文字。</span><span class="sxs-lookup"><span data-stu-id="fef3a-157">For example, you can display a bitmap rather than text or draw text using a different font.</span></span>

<span data-ttu-id="fef3a-158">若要將視窗元件定義為主控描繪，請將 [**SB \_ SETTEXT**](sb-settext.md) 訊息傳送至狀態列，並指定部分和 SBT \_ OWNERDRAW 繪圖技術。</span><span class="sxs-lookup"><span data-stu-id="fef3a-158">To define a window part as owner-drawn, send the [**SB\_SETTEXT**](sb-settext.md) message to the status bar, specifying the part and the SBT\_OWNERDRAW drawing technique.</span></span> <span data-ttu-id="fef3a-159">當 \_ 指定 SBT OWNERDRAW 時， *lParam* 參數是應用程式在繪製元件時可使用的32位應用程式定義值。</span><span class="sxs-lookup"><span data-stu-id="fef3a-159">When SBT\_OWNERDRAW is specified, the *lParam* parameter is a 32-bit application-defined value that the application can use when drawing the part.</span></span> <span data-ttu-id="fef3a-160">例如，您可以指定字型控制碼、點陣圖控制碼、字串的位址等等。</span><span class="sxs-lookup"><span data-stu-id="fef3a-160">For example, you can specify a font handle, a bitmap handle, an address of a string, and so on.</span></span>

<span data-ttu-id="fef3a-161">當狀態列需要繪製擁有者繪製的元件時，它會將 [**WM \_ DRAWITEM**](wm-drawitem.md) 訊息傳送至父視窗。</span><span class="sxs-lookup"><span data-stu-id="fef3a-161">When a status bar needs to draw an owner-drawn part, it sends the [**WM\_DRAWITEM**](wm-drawitem.md) message to the parent window.</span></span> <span data-ttu-id="fef3a-162">訊息的 *wParam* 參數是狀態列的子視窗識別碼，而 *LParam* 參數是 [**DRAWITEMSTRUCT**](/windows/win32/api/winuser/ns-winuser-drawitemstruct) 結構的位址。</span><span class="sxs-lookup"><span data-stu-id="fef3a-162">The *wParam* parameter of the message is the child window identifier of the status bar, and the *lParam* parameter is the address of a [**DRAWITEMSTRUCT**](/windows/win32/api/winuser/ns-winuser-drawitemstruct) structure.</span></span> <span data-ttu-id="fef3a-163">父視窗會使用結構中的資訊來繪製元件。</span><span class="sxs-lookup"><span data-stu-id="fef3a-163">The parent window uses the information in the structure to draw the part.</span></span> <span data-ttu-id="fef3a-164">針對狀態列的主控描繪部分， **DRAWITEMSTRUCT** 包含下列資訊。</span><span class="sxs-lookup"><span data-stu-id="fef3a-164">For an owner-drawn part of a status bar, **DRAWITEMSTRUCT** contains the following information.</span></span>



| <span data-ttu-id="fef3a-165">member</span><span class="sxs-lookup"><span data-stu-id="fef3a-165">Member</span></span>         | <span data-ttu-id="fef3a-166">描述</span><span class="sxs-lookup"><span data-stu-id="fef3a-166">Description</span></span>                                                                                                            |
|----------------|------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="fef3a-167">**CtlType**</span><span class="sxs-lookup"><span data-stu-id="fef3a-167">**CtlType**</span></span>    | <span data-ttu-id="fef3a-168">明確請勿使用。</span><span class="sxs-lookup"><span data-stu-id="fef3a-168">Undefined; do not use.</span></span>                                                                                                 |
| <span data-ttu-id="fef3a-169">**CtlID**</span><span class="sxs-lookup"><span data-stu-id="fef3a-169">**CtlID**</span></span>      | <span data-ttu-id="fef3a-170">狀態列的子視窗識別碼。</span><span class="sxs-lookup"><span data-stu-id="fef3a-170">Child window identifier of the status bar.</span></span>                                                                             |
| <span data-ttu-id="fef3a-171">**itemID**</span><span class="sxs-lookup"><span data-stu-id="fef3a-171">**itemID**</span></span>     | <span data-ttu-id="fef3a-172">要繪製之部分的以零為基底的索引。</span><span class="sxs-lookup"><span data-stu-id="fef3a-172">Zero-based index of the part to be drawn.</span></span>                                                                              |
| <span data-ttu-id="fef3a-173">**itemAction**</span><span class="sxs-lookup"><span data-stu-id="fef3a-173">**itemAction**</span></span> | <span data-ttu-id="fef3a-174">明確請勿使用。</span><span class="sxs-lookup"><span data-stu-id="fef3a-174">Undefined; do not use.</span></span>                                                                                                 |
| <span data-ttu-id="fef3a-175">**itemState**</span><span class="sxs-lookup"><span data-stu-id="fef3a-175">**itemState**</span></span>  | <span data-ttu-id="fef3a-176">明確請勿使用。</span><span class="sxs-lookup"><span data-stu-id="fef3a-176">Undefined; do not use.</span></span>                                                                                                 |
| <span data-ttu-id="fef3a-177">**hwndItem**</span><span class="sxs-lookup"><span data-stu-id="fef3a-177">**hwndItem**</span></span>   | <span data-ttu-id="fef3a-178">狀態列的控制碼。</span><span class="sxs-lookup"><span data-stu-id="fef3a-178">Handle to the status bar.</span></span>                                                                                              |
| <span data-ttu-id="fef3a-179">**hDC**</span><span class="sxs-lookup"><span data-stu-id="fef3a-179">**hDC**</span></span>        | <span data-ttu-id="fef3a-180">狀態列的裝置內容控制碼。</span><span class="sxs-lookup"><span data-stu-id="fef3a-180">Handle to the device context of the status bar.</span></span>                                                                        |
| <span data-ttu-id="fef3a-181">**rcItem**</span><span class="sxs-lookup"><span data-stu-id="fef3a-181">**rcItem**</span></span>     | <span data-ttu-id="fef3a-182">要繪製之視窗部分的座標。</span><span class="sxs-lookup"><span data-stu-id="fef3a-182">Coordinates of the window part to be drawn.</span></span> <span data-ttu-id="fef3a-183">座標是相對於狀態列的左上角。</span><span class="sxs-lookup"><span data-stu-id="fef3a-183">The coordinates are relative to the upper left corner of the status bar.</span></span>   |
| <span data-ttu-id="fef3a-184">**itemData**</span><span class="sxs-lookup"><span data-stu-id="fef3a-184">**itemData**</span></span>   | <span data-ttu-id="fef3a-185">在 [**SB \_ SETTEXT**](sb-settext.md)訊息的 *lParam* 參數中指定的應用程式定義32位值。</span><span class="sxs-lookup"><span data-stu-id="fef3a-185">Application-defined 32-bit value specified in the *lParam* parameter of the [**SB\_SETTEXT**](sb-settext.md) message.</span></span> |



 

## <a name="simple-mode-status-bars"></a><span data-ttu-id="fef3a-186">簡單模式狀態列</span><span class="sxs-lookup"><span data-stu-id="fef3a-186">Simple Mode Status Bars</span></span>

<span data-ttu-id="fef3a-187">您可以藉由將一個 [**SB \_ 簡單**](sb-simple.md) 的訊息傳送給它，將狀態列放在「簡單模式」中。</span><span class="sxs-lookup"><span data-stu-id="fef3a-187">You put a status bar in "simple mode" by sending it an [**SB\_SIMPLE**](sb-simple.md) message.</span></span> <span data-ttu-id="fef3a-188">簡單模式的狀態列只會顯示一個部分。</span><span class="sxs-lookup"><span data-stu-id="fef3a-188">A simple mode status bar displays only one part.</span></span> <span data-ttu-id="fef3a-189">當視窗的文字設定完成時，視窗會失效，但在下一個 [**WM \_ 油漆**](/windows/desktop/gdi/wm-paint)之前不會重新繪製。</span><span class="sxs-lookup"><span data-stu-id="fef3a-189">When the text of the window is set, the window is invalidated, but it is not redrawn until the next [**WM\_PAINT**](/windows/desktop/gdi/wm-paint).</span></span> <span data-ttu-id="fef3a-190">藉由將重繪視窗的次數降到最低，等候訊息可減少螢幕閃爍。</span><span class="sxs-lookup"><span data-stu-id="fef3a-190">Waiting for the message reduces screen flicker by minimizing the number of times the window is redrawn.</span></span> <span data-ttu-id="fef3a-191">簡單模式狀態列適用于顯示功能表項目的解說文字，而使用者會在功能表中滾動。</span><span class="sxs-lookup"><span data-stu-id="fef3a-191">A simple mode status bar is useful for displaying Help text for menu items while the user is scrolling through the menu.</span></span>

<span data-ttu-id="fef3a-192">在簡單模式下，狀態列所顯示的字串會與在簡單模式中顯示的字串分開維護。</span><span class="sxs-lookup"><span data-stu-id="fef3a-192">The string that a status bar displays while in simple mode is maintained separately from the strings that it displays while in nonsimple mode.</span></span> <span data-ttu-id="fef3a-193">這表示您可以在簡單模式下放置視窗、設定它的文字，並切換回簡單模式，而不會變更簡單模式文字。</span><span class="sxs-lookup"><span data-stu-id="fef3a-193">This means you can put the window in simple mode, set its text, and switch back to nonsimple mode without the nonsimple mode text being changed.</span></span>

<span data-ttu-id="fef3a-194">設定簡單模式狀態列的文字時，您可以指定 SBT OWNERDRAW 以外的任何繪圖技術 \_ 。</span><span class="sxs-lookup"><span data-stu-id="fef3a-194">When setting the text of a simple mode status bar, you can specify any drawing technique except SBT\_OWNERDRAW.</span></span> <span data-ttu-id="fef3a-195">簡單模式的狀態列不支援「擁有者繪圖」。</span><span class="sxs-lookup"><span data-stu-id="fef3a-195">A simple mode status bar does not support owner drawing.</span></span>

## <a name="default-status-bar-message-processing"></a><span data-ttu-id="fef3a-196">預設狀態列訊息處理</span><span class="sxs-lookup"><span data-stu-id="fef3a-196">Default Status Bar Message Processing</span></span>

<span data-ttu-id="fef3a-197">本節說明由預先定義之 [**STATUSCLASSNAME**](common-control-window-classes.md) 類別的視窗程式所處理的訊息。</span><span class="sxs-lookup"><span data-stu-id="fef3a-197">This section describes the messages handled by the window procedure for the predefined [**STATUSCLASSNAME**](common-control-window-classes.md) class.</span></span>



| <span data-ttu-id="fef3a-198">訊息</span><span class="sxs-lookup"><span data-stu-id="fef3a-198">Message</span></span>               | <span data-ttu-id="fef3a-199">預設處理</span><span class="sxs-lookup"><span data-stu-id="fef3a-199">Default processing</span></span>                                                                                                                                                                                                                                                       |
|-----------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="fef3a-200">**WM \_ 建立**</span><span class="sxs-lookup"><span data-stu-id="fef3a-200">**WM\_CREATE**</span></span>        | <span data-ttu-id="fef3a-201">初始化狀態列。</span><span class="sxs-lookup"><span data-stu-id="fef3a-201">Initializes the status bar.</span></span>                                                                                                                                                                                                                                              |
| <span data-ttu-id="fef3a-202">**WM 損 \_ 毀**</span><span class="sxs-lookup"><span data-stu-id="fef3a-202">**WM\_DESTROY**</span></span>       | <span data-ttu-id="fef3a-203">釋出配置給狀態列的資源。</span><span class="sxs-lookup"><span data-stu-id="fef3a-203">Frees resources allocated for the status bar.</span></span>                                                                                                                                                                                                                            |
| <span data-ttu-id="fef3a-204">**WM \_ GETFONT**</span><span class="sxs-lookup"><span data-stu-id="fef3a-204">**WM\_GETFONT**</span></span>       | <span data-ttu-id="fef3a-205">傳回目前字型的控制碼，狀態列會用它來繪製其文字。</span><span class="sxs-lookup"><span data-stu-id="fef3a-205">Returns the handle to the current font with which the status bar draws its text.</span></span>                                                                                                                                                                                         |
| <span data-ttu-id="fef3a-206">**WM \_ GETTEXT**</span><span class="sxs-lookup"><span data-stu-id="fef3a-206">**WM\_GETTEXT**</span></span>       | <span data-ttu-id="fef3a-207">從狀態列的第一個部分將文字複製到緩衝區。</span><span class="sxs-lookup"><span data-stu-id="fef3a-207">Copies the text from the first part of a status bar to a buffer.</span></span> <span data-ttu-id="fef3a-208">它會傳回32位值，這個值會指定文字的長度（以字元為單位），以及用來繪製文字的技巧。</span><span class="sxs-lookup"><span data-stu-id="fef3a-208">It returns a 32-bit value that specifies the length, in characters, of the text and the technique used to draw the text.</span></span>                                                                                |
| <span data-ttu-id="fef3a-209">**WM \_ GETTEXTLENGTH**</span><span class="sxs-lookup"><span data-stu-id="fef3a-209">**WM\_GETTEXTLENGTH**</span></span> | <span data-ttu-id="fef3a-210">傳回32位值，這個值會指定狀態列第一個部分中文字的長度（以字元為單位），以及用來繪製文字的技巧。</span><span class="sxs-lookup"><span data-stu-id="fef3a-210">Returns a 32-bit value that specifies the length, in characters, of the text in the first part of a status bar and the technique used to draw the text.</span></span>                                                                                                                  |
| <span data-ttu-id="fef3a-211">**WM \_ NCHITTEST**</span><span class="sxs-lookup"><span data-stu-id="fef3a-211">**WM\_NCHITTEST**</span></span>     | <span data-ttu-id="fef3a-212">如果滑鼠游標位於調整大小的底框中，則傳回 HTBOTTOMRIGHT 值，使系統顯示調整大小游標。</span><span class="sxs-lookup"><span data-stu-id="fef3a-212">Returns the HTBOTTOMRIGHT value if the mouse cursor is in the sizing grip, causing the system to display the sizing cursor.</span></span> <span data-ttu-id="fef3a-213">如果滑鼠游標不在調整大小的底框中，狀態列就會將此訊息傳遞至 [**DefWindowProc**](/windows/desktop/api/winuser/nf-winuser-defwindowproca) 函式。</span><span class="sxs-lookup"><span data-stu-id="fef3a-213">If the mouse cursor is not in the sizing grip, the status bar passes this message to the [**DefWindowProc**](/windows/desktop/api/winuser/nf-winuser-defwindowproca) function.</span></span> |
| <span data-ttu-id="fef3a-214">**WM \_ 油漆**</span><span class="sxs-lookup"><span data-stu-id="fef3a-214">**WM\_PAINT**</span></span>         | <span data-ttu-id="fef3a-215">繪製狀態列的無效區域。</span><span class="sxs-lookup"><span data-stu-id="fef3a-215">Paints the invalid region of the status bar.</span></span> <span data-ttu-id="fef3a-216">如果 *wParam* 參數不是 **Null**，則控制項會假設值為 HDC，並且使用該裝置內容繪製。</span><span class="sxs-lookup"><span data-stu-id="fef3a-216">If the *wParam* parameter is non-**NULL**, the control assumes that the value is an HDC and paints using that device context.</span></span>                                                                                               |
| <span data-ttu-id="fef3a-217">**WM \_ SETFONT**</span><span class="sxs-lookup"><span data-stu-id="fef3a-217">**WM\_SETFONT**</span></span>       | <span data-ttu-id="fef3a-218">在狀態列的裝置內容中選取字型控點。</span><span class="sxs-lookup"><span data-stu-id="fef3a-218">Selects the font handle into the device context for the status bar.</span></span>                                                                                                                                                                                                      |
| <span data-ttu-id="fef3a-219">**WM \_ SETTEXT**</span><span class="sxs-lookup"><span data-stu-id="fef3a-219">**WM\_SETTEXT**</span></span>       | <span data-ttu-id="fef3a-220">使用預設的繪圖作業 (指定為零) ，將指定的文字複製到狀態列的第一個部分。</span><span class="sxs-lookup"><span data-stu-id="fef3a-220">Copies the specified text into the first part of a status bar, using the default drawing operation (specified as zero).</span></span> <span data-ttu-id="fef3a-221">如果成功，則傳回 **TRUE** ，否則傳回 **FALSE** 。</span><span class="sxs-lookup"><span data-stu-id="fef3a-221">It returns **TRUE** if successful, or **FALSE** otherwise.</span></span>                                                                                       |
| <span data-ttu-id="fef3a-222">**WM \_ 大小**</span><span class="sxs-lookup"><span data-stu-id="fef3a-222">**WM\_SIZE**</span></span>          | <span data-ttu-id="fef3a-223">根據父視窗工作區的目前寬度和狀態列目前字型的高度，調整狀態列的大小。</span><span class="sxs-lookup"><span data-stu-id="fef3a-223">Resizes the status bar based on the current width of the parent window's client area and the height of the current font of the status bar.</span></span>                                                                                                                               |



 

 

 
