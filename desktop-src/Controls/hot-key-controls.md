---
title: 關於快速鍵控制項
description: 快速鍵控制項是一種視窗，可讓使用者輸入按鍵的組合，以做為快速鍵使用。
ms.assetid: 5f011459-4c30-45d4-9668-19f575b041ce
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: dec45d61df535025cff00fee6428f604aa670bf3
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/21/2020
ms.locfileid: "103683153"
---
# <a name="about-hot-key-controls"></a><span data-ttu-id="2617b-103">關於快速鍵控制項</span><span class="sxs-lookup"><span data-stu-id="2617b-103">About Hot Key Controls</span></span>

<span data-ttu-id="2617b-104">快速鍵控制項是一種視窗，可讓使用者輸入按鍵的組合，以做為快速鍵使用。</span><span class="sxs-lookup"><span data-stu-id="2617b-104">A hot key control is a window that enables the user to enter a combination of keystrokes to be used as a hot key.</span></span> <span data-ttu-id="2617b-105">快速鍵是使用者可以按來快速執行動作的按鍵組合。</span><span class="sxs-lookup"><span data-stu-id="2617b-105">A hot key is a key combination that the user can press to perform an action quickly.</span></span> <span data-ttu-id="2617b-106">例如，使用者可以建立啟動指定視窗的熱鍵，然後將它放到迭置順序的最上層。</span><span class="sxs-lookup"><span data-stu-id="2617b-106">For example, a user can create a hot key that activates a given window and brings it to the top of the z-order.</span></span> <span data-ttu-id="2617b-107">快速鍵控制項會顯示使用者的選項，並確保使用者選取有效的按鍵組合。</span><span class="sxs-lookup"><span data-stu-id="2617b-107">The hot key control displays the user's choices and ensures that the user selects a valid key combination.</span></span> <span data-ttu-id="2617b-108">下列螢幕擷取畫面顯示當使用者按下 ALT 鍵之後，快速鍵控制項如何出現在對話方塊中。</span><span class="sxs-lookup"><span data-stu-id="2617b-108">The following screen shot shows how a hot key control appears in a dialog box after the user presses the Alt key.</span></span>

![包含快速鍵控制項之對話方塊的螢幕擷取畫面](images/hotkey.png)

## <a name="using-hot-key-controls"></a><span data-ttu-id="2617b-110">使用快速鍵控制項</span><span class="sxs-lookup"><span data-stu-id="2617b-110">Using Hot Key Controls</span></span>

<span data-ttu-id="2617b-111">當使用者輸入要做為快速鍵的按鍵組合時，索引鍵的名稱會出現在熱鍵控制項中。</span><span class="sxs-lookup"><span data-stu-id="2617b-111">When the user enters a key combination to be used as a hot key, the names of the keys appear in the hot key control.</span></span> <span data-ttu-id="2617b-112">按鍵組合可以包含輔助按鍵 (例如 CTRL、ALT 或 SHIFT) ，以及伴隨的按鍵 (例如，字元鍵、箭號、函式索引鍵等) 。</span><span class="sxs-lookup"><span data-stu-id="2617b-112">A key combination can consist of a modifier key (such as CTRL, ALT, or SHIFT) and an accompanying key (such as a character key, an arrow key, a function key, and so on).</span></span>

<span data-ttu-id="2617b-113">當使用者選擇了按鍵組合之後，應用程式會從快速鍵控制項抓取按鍵組合，並使用它來設定系統中的快速鍵。</span><span class="sxs-lookup"><span data-stu-id="2617b-113">After the user has chosen a key combination, the application retrieves the key combination from the hot key control and uses it to set up a hot key in the system.</span></span> <span data-ttu-id="2617b-114">從快速鍵控制項取出的資訊包括一個旗標，指出所附索引鍵的輔助按鍵和虛擬金鑰碼。</span><span class="sxs-lookup"><span data-stu-id="2617b-114">The information retrieved from the hot key control includes a flag indicating the modifier key and the virtual key code of the accompanying key.</span></span>

<span data-ttu-id="2617b-115">應用程式可以使用快速鍵控制項所提供的資訊，來設定全域熱鍵或執行緒特定的快速鍵。</span><span class="sxs-lookup"><span data-stu-id="2617b-115">The application can use the information provided by a hot key control to set up a global hot key or a thread-specific hot key.</span></span> <span data-ttu-id="2617b-116">全域快速鍵會與特定視窗相關聯;它可讓使用者從系統的任何部分啟動視窗。</span><span class="sxs-lookup"><span data-stu-id="2617b-116">A global hot key is associated with a particular window; it allows the user to activate the window from any part of the system.</span></span> <span data-ttu-id="2617b-117">應用程式會使用 [**WM \_ SETHOTKEY**](/windows/desktop/inputdev/wm-sethotkey) 訊息來設定全域快速鍵。</span><span class="sxs-lookup"><span data-stu-id="2617b-117">An application sets a global hot key by using the [**WM\_SETHOTKEY**](/windows/desktop/inputdev/wm-sethotkey) message.</span></span> <span data-ttu-id="2617b-118">每當使用者按下全域快速鍵時，在 **wm \_ SETHOTKEY** 中指定的視窗就會收到指定 [**SC \_ 熱鍵**](/windows/desktop/inputdev/wm-sethotkey)值的 [**wm \_ SYSCOMMAND**](/windows/desktop/menurc/wm-syscommand)訊息。</span><span class="sxs-lookup"><span data-stu-id="2617b-118">Whenever the user presses a global hot key, the window specified in **WM\_SETHOTKEY** receives a [**WM\_SYSCOMMAND**](/windows/desktop/menurc/wm-syscommand) message that specifies the [**SC\_HOTKEY**](/windows/desktop/inputdev/wm-sethotkey) value.</span></span> <span data-ttu-id="2617b-119">此訊息會啟用接收它的視窗。</span><span class="sxs-lookup"><span data-stu-id="2617b-119">This message activates the window that receives it.</span></span> <span data-ttu-id="2617b-120">在呼叫 **WM \_ SETHOTKEY** 的應用程式結束之前，快速鍵會保持有效。</span><span class="sxs-lookup"><span data-stu-id="2617b-120">The hot key remains valid until the application that called **WM\_SETHOTKEY** exits.</span></span>

<span data-ttu-id="2617b-121">執行緒特定的熱鍵會產生可張貼至特定執行緒開頭的 [**WM \_ 熱鍵**](/windows/desktop/inputdev/wm-hotkey) 訊息，以便在訊息迴圈的下一個反復專案中移除。</span><span class="sxs-lookup"><span data-stu-id="2617b-121">A thread-specific hot key generates a [**WM\_HOTKEY**](/windows/desktop/inputdev/wm-hotkey) message that is posted to the beginning of a particular thread so that it is removed by the next iteration of the message loop.</span></span> <span data-ttu-id="2617b-122">應用程式會使用 [**RegisterHotKey**](/windows/desktop/api/winuser/nf-winuser-registerhotkey) 函數來設定執行緒特定的熱鍵。</span><span class="sxs-lookup"><span data-stu-id="2617b-122">An application sets a thread-specific hot key by using the [**RegisterHotKey**](/windows/desktop/api/winuser/nf-winuser-registerhotkey) function.</span></span>

### <a name="hot-key-control-messages"></a><span data-ttu-id="2617b-123">快速鍵控制訊息</span><span class="sxs-lookup"><span data-stu-id="2617b-123">Hot Key Control Messages</span></span>

<span data-ttu-id="2617b-124">建立熱鍵控制項之後，應用程式會使用三個訊息與其互動： [**HKM \_ SETRULES**](hkm-setrules.md)、 [**HKM \_ SETHOTKEY**](hkm-sethotkey.md)和 [**HKM \_ GETHOTKEY**](hkm-gethotkey.md)。</span><span class="sxs-lookup"><span data-stu-id="2617b-124">After creating a hot key control, an application interacts with it by using three messages: [**HKM\_SETRULES**](hkm-setrules.md), [**HKM\_SETHOTKEY**](hkm-sethotkey.md), and [**HKM\_GETHOTKEY**](hkm-gethotkey.md).</span></span>

<span data-ttu-id="2617b-125">應用程式可以傳送 [**HKM \_ SETRULES**](hkm-setrules.md) 訊息，以指定一組被視為無效快速鍵的 CTRL、ALT 和 SHIFT 鍵組合。</span><span class="sxs-lookup"><span data-stu-id="2617b-125">An application can send the [**HKM\_SETRULES**](hkm-setrules.md) message to specify a set of CTRL, ALT, and SHIFT key combinations that are considered invalid hot keys.</span></span> <span data-ttu-id="2617b-126">如果應用程式指定不正確按鍵組合，則也應該在使用者選取不正確組合時，指定要使用的預設修飾片語合。</span><span class="sxs-lookup"><span data-stu-id="2617b-126">If the application specifies an invalid key combination, it should also specify a default modifier combination to use when the user selects the invalid combination.</span></span> <span data-ttu-id="2617b-127">當使用者輸入不正確組合時，系統會針對不正確組合和預設的組合執行邏輯 OR 運算。</span><span class="sxs-lookup"><span data-stu-id="2617b-127">When the user enters the invalid combination, the system performs a logical OR operation on the invalid combination and the default combination.</span></span> <span data-ttu-id="2617b-128">結果會被視為有效的組合;它會轉換成字串並顯示在控制項中。</span><span class="sxs-lookup"><span data-stu-id="2617b-128">The result is considered a valid combination; it is converted to a string and displayed in the control.</span></span>

<span data-ttu-id="2617b-129">[**HKM \_ SETHOTKEY**](hkm-sethotkey.md)訊息可讓應用程式設定快速鍵控制項的快速鍵組合。</span><span class="sxs-lookup"><span data-stu-id="2617b-129">The [**HKM\_SETHOTKEY**](hkm-sethotkey.md) message allows an application to set the hot key combination for a hot key control.</span></span> <span data-ttu-id="2617b-130">此訊息通常也會在建立快速鍵控制項時使用。</span><span class="sxs-lookup"><span data-stu-id="2617b-130">This message is also typically used when the hot key control is created.</span></span>

<span data-ttu-id="2617b-131">應用程式會使用 [**HKM \_ GETHOTKEY**](hkm-gethotkey.md) 訊息來取得使用者所選擇之快速鍵的虛擬機器碼和修飾詞旗標。</span><span class="sxs-lookup"><span data-stu-id="2617b-131">Applications use the [**HKM\_GETHOTKEY**](hkm-gethotkey.md) message to retrieve the virtual key code and modifier flags of the hot key chosen by the user.</span></span>

### <a name="hot-key-control-notifications"></a><span data-ttu-id="2617b-132">快速鍵控制通知</span><span class="sxs-lookup"><span data-stu-id="2617b-132">Hot Key Control Notifications</span></span>

<span data-ttu-id="2617b-133">快速鍵控制項不會透過 [**WM \_ 通知**](wm-notify.md) 訊息傳送任何通知碼。</span><span class="sxs-lookup"><span data-stu-id="2617b-133">The hot key control does not send any notification codes via the [**WM\_NOTIFY**](wm-notify.md) message.</span></span> <span data-ttu-id="2617b-134">不過，它會在使用者變更控制項的內容時，透過 [**WM \_ 命令**](/windows/desktop/menurc/wm-command)訊息傳送 [EN \_ 變更](en-change.md)通知。</span><span class="sxs-lookup"><span data-stu-id="2617b-134">It will, however, send the [EN\_CHANGE](en-change.md) notification via the [**WM\_COMMAND**](/windows/desktop/menurc/wm-command) message when the user changes the contents of the control.</span></span>

### <a name="default-hot-key-message-processing"></a><span data-ttu-id="2617b-135">預設的快速鍵訊息處理</span><span class="sxs-lookup"><span data-stu-id="2617b-135">Default Hot Key Message Processing</span></span>

<span data-ttu-id="2617b-136">本節說明使用快速鍵控制項之預先定義之快速鍵 [**\_ 類別**](common-control-window-classes.md) 視窗類別的視窗程式所處理的視窗訊息。</span><span class="sxs-lookup"><span data-stu-id="2617b-136">This section describes the window messages handled by the window procedure for the pre defined [**HOTKEY\_CLASS**](common-control-window-classes.md) window class used with hot key controls.</span></span>



|                                                |                                                                                                                                                                                                                                                                                                                                               |
|------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="2617b-137">**訊息**</span><span class="sxs-lookup"><span data-stu-id="2617b-137">**Message**</span></span>                                    | <span data-ttu-id="2617b-138">**處理已執行**</span><span class="sxs-lookup"><span data-stu-id="2617b-138">**Processing performed**</span></span>                                                                                                                                                                                                                                                                                                                      |
| [<span data-ttu-id="2617b-139">**WM \_ 字元**</span><span class="sxs-lookup"><span data-stu-id="2617b-139">**WM\_CHAR**</span></span>](/windows/desktop/inputdev/wm-char)               | <span data-ttu-id="2617b-140">抓取虛擬金鑰程式碼。</span><span class="sxs-lookup"><span data-stu-id="2617b-140">Retrieves the virtual key code.</span></span>                                                                                                                                                                                                                                                                                                               |
| [<span data-ttu-id="2617b-141">**WM \_ 建立**</span><span class="sxs-lookup"><span data-stu-id="2617b-141">**WM\_CREATE**</span></span>](/windows/desktop/winmsg/wm-create)             | <span data-ttu-id="2617b-142">初始化熱鍵控制項、清除任何熱鍵規則，並使用系統字型。</span><span class="sxs-lookup"><span data-stu-id="2617b-142">Initializes the hot key control, clears any hot key rules, and uses the system font.</span></span>                                                                                                                                                                                                                                                          |
| [<span data-ttu-id="2617b-143">**WM \_ ERASEBKGND**</span><span class="sxs-lookup"><span data-stu-id="2617b-143">**WM\_ERASEBKGND**</span></span>](/windows/desktop/winmsg/wm-erasebkgnd)     | <span data-ttu-id="2617b-144">隱藏插入號、呼叫 [**DefWindowProc**](/windows/desktop/api/winuser/nf-winuser-defwindowproca) 函式，然後再次顯示插入號。</span><span class="sxs-lookup"><span data-stu-id="2617b-144">Hides the caret, calls the [**DefWindowProc**](/windows/desktop/api/winuser/nf-winuser-defwindowproca) function, and shows the caret again.</span></span>                                                                                                                                                                                                                                     |
| [<span data-ttu-id="2617b-145">**WM \_ GETDLGCODE**</span><span class="sxs-lookup"><span data-stu-id="2617b-145">**WM\_GETDLGCODE**</span></span>](/windows/desktop/dlgbox/wm-getdlgcode)     | <span data-ttu-id="2617b-146">傳回 [**DLGC \_ WANTCHARS**](/windows/desktop/dlgbox/wm-getdlgcode) 和 [**DLGC \_ WANTARROWS**](/windows/desktop/dlgbox/wm-getdlgcode) 值的組合。</span><span class="sxs-lookup"><span data-stu-id="2617b-146">Returns a combination of the [**DLGC\_WANTCHARS**](/windows/desktop/dlgbox/wm-getdlgcode) and [**DLGC\_WANTARROWS**](/windows/desktop/dlgbox/wm-getdlgcode) values.</span></span>                                                                                                                                               |
| [<span data-ttu-id="2617b-147">**WM \_ GETFONT**</span><span class="sxs-lookup"><span data-stu-id="2617b-147">**WM\_GETFONT**</span></span>](/windows/desktop/winmsg/wm-getfont)           | <span data-ttu-id="2617b-148">抓取字型。</span><span class="sxs-lookup"><span data-stu-id="2617b-148">Retrieves the font.</span></span>                                                                                                                                                                                                                                                                                                                           |
| [<span data-ttu-id="2617b-149">**WM \_ KEYDOWN**</span><span class="sxs-lookup"><span data-stu-id="2617b-149">**WM\_KEYDOWN**</span></span>](/windows/desktop/inputdev/wm-keydown)         | <span data-ttu-id="2617b-150">如果索引鍵為 ENTER、TAB、空格鍵、DEL、ESC 或倒退鍵，則呼叫 [**DefWindowProc**](/windows/desktop/api/winuser/nf-winuser-defwindowproca) 函數。</span><span class="sxs-lookup"><span data-stu-id="2617b-150">Calls the [**DefWindowProc**](/windows/desktop/api/winuser/nf-winuser-defwindowproca) function if the key is ENTER, TAB, SPACE BAR, DEL, ESC, or BACKSPACE.</span></span> <span data-ttu-id="2617b-151">如果索引鍵是 SHIFT、CTRL 或 ALT，它會檢查組合是否有效，如果是，則會使用組合來設定快速鍵。</span><span class="sxs-lookup"><span data-stu-id="2617b-151">If the key is SHIFT, CTRL, or ALT, it checks whether the combination is valid and, if it is, sets the hot key using the combination.</span></span> <span data-ttu-id="2617b-152">所有其他金鑰都會設定為快速鍵，而不會先檢查其有效性。</span><span class="sxs-lookup"><span data-stu-id="2617b-152">All other keys are set as hot keys without their validity being checked first.</span></span> |
| [<span data-ttu-id="2617b-153">**WM \_ KEYUP**</span><span class="sxs-lookup"><span data-stu-id="2617b-153">**WM\_KEYUP**</span></span>](/windows/desktop/inputdev/wm-keyup)             | <span data-ttu-id="2617b-154">抓取虛擬金鑰程式碼。</span><span class="sxs-lookup"><span data-stu-id="2617b-154">Retrieves the virtual key code.</span></span>                                                                                                                                                                                                                                                                                                               |
| [<span data-ttu-id="2617b-155">**WM \_ KILLFOCUS**</span><span class="sxs-lookup"><span data-stu-id="2617b-155">**WM\_KILLFOCUS**</span></span>](/windows/desktop/inputdev/wm-killfocus)     | <span data-ttu-id="2617b-156">終結插入號。</span><span class="sxs-lookup"><span data-stu-id="2617b-156">Destroys the caret.</span></span>                                                                                                                                                                                                                                                                                                                           |
| [<span data-ttu-id="2617b-157">**WM \_ LBUTTONDOWN**</span><span class="sxs-lookup"><span data-stu-id="2617b-157">**WM\_LBUTTONDOWN**</span></span>](/windows/desktop/inputdev/wm-lbuttondown) | <span data-ttu-id="2617b-158">將焦點設定至視窗。</span><span class="sxs-lookup"><span data-stu-id="2617b-158">Sets the focus to the window.</span></span>                                                                                                                                                                                                                                                                                                                 |
| [<span data-ttu-id="2617b-159">**WM \_ NCCREATE**</span><span class="sxs-lookup"><span data-stu-id="2617b-159">**WM\_NCCREATE**</span></span>](/windows/desktop/winmsg/wm-nccreate)         | <span data-ttu-id="2617b-160">設定 [**WS \_ EX \_ CLIENTEDGE**](/windows/desktop/winmsg/extended-window-styles) 視窗樣式。</span><span class="sxs-lookup"><span data-stu-id="2617b-160">Sets the [**WS\_EX\_CLIENTEDGE**](/windows/desktop/winmsg/extended-window-styles) window style.</span></span>                                                                                                                                                                                                                              |
| [<span data-ttu-id="2617b-161">**WM \_ 油漆**</span><span class="sxs-lookup"><span data-stu-id="2617b-161">**WM\_PAINT**</span></span>](/windows/desktop/gdi/wm-paint)                  | <span data-ttu-id="2617b-162">繪製快速鍵控制項。</span><span class="sxs-lookup"><span data-stu-id="2617b-162">Paints the hot key control.</span></span>                                                                                                                                                                                                                                                                                                                   |
| [<span data-ttu-id="2617b-163">**WM \_ SETFOCUS**</span><span class="sxs-lookup"><span data-stu-id="2617b-163">**WM\_SETFOCUS**</span></span>](/windows/desktop/inputdev/wm-setfocus)       | <span data-ttu-id="2617b-164">建立並顯示插入號。</span><span class="sxs-lookup"><span data-stu-id="2617b-164">Creates and shows the caret.</span></span>                                                                                                                                                                                                                                                                                                                  |
| [<span data-ttu-id="2617b-165">**WM \_ SETFONT**</span><span class="sxs-lookup"><span data-stu-id="2617b-165">**WM\_SETFONT**</span></span>](/windows/desktop/winmsg/wm-setfont)           | <span data-ttu-id="2617b-166">設定字型。</span><span class="sxs-lookup"><span data-stu-id="2617b-166">Sets the font.</span></span>                                                                                                                                                                                                                                                                                                                                |
| [<span data-ttu-id="2617b-167">**WM \_ SYSCHAR**</span><span class="sxs-lookup"><span data-stu-id="2617b-167">**WM\_SYSCHAR**</span></span>](/windows/desktop/menurc/wm-syschar)           | <span data-ttu-id="2617b-168">抓取虛擬金鑰程式碼。</span><span class="sxs-lookup"><span data-stu-id="2617b-168">Retrieves the virtual key code.</span></span>                                                                                                                                                                                                                                                                                                               |
| [<span data-ttu-id="2617b-169">**WM \_ SYSKEYDOWN**</span><span class="sxs-lookup"><span data-stu-id="2617b-169">**WM\_SYSKEYDOWN**</span></span>](/windows/desktop/inputdev/wm-syskeydown)   | <span data-ttu-id="2617b-170">如果索引鍵為 ENTER、TAB、空格鍵、DEL、ESC 或倒退鍵，則呼叫 [**DefWindowProc**](/windows/desktop/api/winuser/nf-winuser-defwindowproca) 函數。</span><span class="sxs-lookup"><span data-stu-id="2617b-170">Calls the [**DefWindowProc**](/windows/desktop/api/winuser/nf-winuser-defwindowproca) function if the key is ENTER, TAB, SPACE BAR, DEL, ESC, or BACKSPACE.</span></span> <span data-ttu-id="2617b-171">如果索引鍵是 SHIFT、CTRL 或 ALT，它會檢查組合是否有效，如果是，則會使用組合來設定快速鍵。</span><span class="sxs-lookup"><span data-stu-id="2617b-171">If the key is SHIFT, CTRL, or ALT, it checks whether the combination is valid and, if it is, sets the hot key using the combination.</span></span> <span data-ttu-id="2617b-172">所有其他金鑰都會設定為快速鍵，而不會先檢查其有效性。</span><span class="sxs-lookup"><span data-stu-id="2617b-172">All other keys are set as hot keys without their validity being checked first.</span></span> |
| [<span data-ttu-id="2617b-173">**WM \_ SYSKEYUP**</span><span class="sxs-lookup"><span data-stu-id="2617b-173">**WM\_SYSKEYUP**</span></span>](/windows/desktop/inputdev/wm-syskeyup)       | <span data-ttu-id="2617b-174">抓取虛擬金鑰程式碼。</span><span class="sxs-lookup"><span data-stu-id="2617b-174">Retrieves the virtual key code.</span></span>                                                                                                                                                                                                                                                                                                               |



 

 

 