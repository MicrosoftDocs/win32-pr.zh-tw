---
title: 關於日期和時間選擇器控制項
description: 日期和時間選擇器 (DTP) 控制項提供簡單且直覺的介面，可讓您用來與使用者交換日期和時間資訊。
ms.assetid: 6749c3ae-2c52-4183-ac4e-68ca7ebf1e13
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 04604c01a73aa8f2ebb8542061412372faee5282
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/21/2020
ms.locfileid: "104024210"
---
# <a name="about-date-and-time-picker-controls"></a><span data-ttu-id="3c0c2-103">關於日期和時間選擇器控制項</span><span class="sxs-lookup"><span data-stu-id="3c0c2-103">About Date and Time Picker Controls</span></span>

<span data-ttu-id="3c0c2-104">*日期和時間選擇器 (DTP) 控制項* 提供簡單且直覺的介面，可讓您用來與使用者交換日期和時間資訊。</span><span class="sxs-lookup"><span data-stu-id="3c0c2-104">A *date and time picker (DTP) control* provides a simple and intuitive interface through which to exchange date and time information with a user.</span></span> <span data-ttu-id="3c0c2-105">例如，您可以使用 DTP 控制項要求使用者輸入日期，然後輕鬆地取出選取專案。</span><span class="sxs-lookup"><span data-stu-id="3c0c2-105">For example, with a DTP control you can ask the user to enter a date and then easily retrieve the selection.</span></span>

<span data-ttu-id="3c0c2-106">我們將討論下列主題：</span><span class="sxs-lookup"><span data-stu-id="3c0c2-106">The following topics are discussed:</span></span>

-   [<span data-ttu-id="3c0c2-107">日期和時間選擇器消費者介面</span><span class="sxs-lookup"><span data-stu-id="3c0c2-107">Date and Time Picker User Interface</span></span>](#date-and-time-picker-user-interface)
-   [<span data-ttu-id="3c0c2-108">日期和時間選擇器控制項樣式和格式</span><span class="sxs-lookup"><span data-stu-id="3c0c2-108">Date and Time Picker Control Styles and Formats</span></span>](#date-and-time-picker-control-styles-and-formats)
    -   [<span data-ttu-id="3c0c2-109">預設格式</span><span class="sxs-lookup"><span data-stu-id="3c0c2-109">Preset Formats</span></span>](#preset-formats)
    -   [<span data-ttu-id="3c0c2-110">自訂格式</span><span class="sxs-lookup"><span data-stu-id="3c0c2-110">Custom formats</span></span>](#custom-formats)
    -   [<span data-ttu-id="3c0c2-111">格式字串</span><span class="sxs-lookup"><span data-stu-id="3c0c2-111">Format Strings</span></span>](#format-strings)
    -   [<span data-ttu-id="3c0c2-112">回呼欄位</span><span class="sxs-lookup"><span data-stu-id="3c0c2-112">Callback fields</span></span>](#callback-fields)
-   [<span data-ttu-id="3c0c2-113">日期和時間選擇器控制項通知訊息</span><span class="sxs-lookup"><span data-stu-id="3c0c2-113">Date and Time Picker Control Notification Messages</span></span>](#date-and-time-picker-control-notification-messages)
-   [<span data-ttu-id="3c0c2-114">相關主題</span><span class="sxs-lookup"><span data-stu-id="3c0c2-114">Related topics</span></span>](#related-topics)

> [!Note]
> <span data-ttu-id="3c0c2-115">Windows 不支援1601之前的日期。</span><span class="sxs-lookup"><span data-stu-id="3c0c2-115">Windows does not support dates prior to 1601.</span></span> <span data-ttu-id="3c0c2-116">如需詳細資訊，請參閱 [**FILETIME**](/windows/desktop/api/minwinbase/ns-minwinbase-filetime) 結構。</span><span class="sxs-lookup"><span data-stu-id="3c0c2-116">See the [**FILETIME**](/windows/desktop/api/minwinbase/ns-minwinbase-filetime) structure for details.</span></span>
>
> <span data-ttu-id="3c0c2-117">此控制項以西曆為基礎，這是在1753中引進的行事曆。</span><span class="sxs-lookup"><span data-stu-id="3c0c2-117">The control is based on the Gregorian calendar, which was introduced in 1753.</span></span> <span data-ttu-id="3c0c2-118">它不會計算與 Julian 行事曆一致的日期。</span><span class="sxs-lookup"><span data-stu-id="3c0c2-118">It will not calculate dates that are consistent with the Julian calendar.</span></span>

## <a name="date-and-time-picker-user-interface"></a><span data-ttu-id="3c0c2-119">日期和時間選擇器消費者介面</span><span class="sxs-lookup"><span data-stu-id="3c0c2-119">Date and Time Picker User Interface</span></span>

<span data-ttu-id="3c0c2-120">日期和時間選擇器的工作區 (DTP) 控制項會顯示日期或時間資訊（或兩者），並作為使用者用來修改資訊的介面。</span><span class="sxs-lookup"><span data-stu-id="3c0c2-120">The client area of a date and time picker (DTP) control displays date or time information, or both, and acts as the interface through which users modify the information.</span></span> <span data-ttu-id="3c0c2-121">您可以從行事曆選取日期，也可以使用上下按鈕控制項來選取日期。您可以藉由在控制項 [格式字串](#format-strings)所定義的欄位中輸入來變更時間。</span><span class="sxs-lookup"><span data-stu-id="3c0c2-121">The date can be selected from a calendar, or by using an up-down control; the time can be changed by typing in fields that are defined by the control's [Format Strings](#format-strings).</span></span> <span data-ttu-id="3c0c2-122">控制項（選擇性）會顯示覆選框。</span><span class="sxs-lookup"><span data-stu-id="3c0c2-122">Optionally, the control displays a check box.</span></span> <span data-ttu-id="3c0c2-123">核取此選項時，可以抓取控制項中的值;否則，會將控制項視為未初始化。</span><span class="sxs-lookup"><span data-stu-id="3c0c2-123">When it is checked, the value in the control can be retrieved; otherwise, the control is considered to be uninitialized.</span></span>

<span data-ttu-id="3c0c2-124">下圖顯示包含三個日期選擇器控制項的視窗。</span><span class="sxs-lookup"><span data-stu-id="3c0c2-124">The following illustration shows a window that contains three date-picker controls.</span></span> <span data-ttu-id="3c0c2-125">第一個日期選擇器控制項是使用 [**dts \_ SHOWNONE**](date-and-time-picker-control-styles.md) 樣式（具有 [**dts \_ 上下按鈕**](date-and-time-picker-control-styles.md) 樣式的第二個）來建立，而第三個則沒有特殊樣式。</span><span class="sxs-lookup"><span data-stu-id="3c0c2-125">The first date-picker control was created with the [**DTS\_SHOWNONE**](date-and-time-picker-control-styles.md) style, the second with the [**DTS\_UPDOWN**](date-and-time-picker-control-styles.md) style, and the third with no special styles.</span></span> <span data-ttu-id="3c0c2-126">在第三個控制項中，使用者按一下向下箭號以顯示行事曆。</span><span class="sxs-lookup"><span data-stu-id="3c0c2-126">In the third control, the user has clicked the down arrow to display the calendar.</span></span>

![示範三種日期選擇器控制項樣式之視窗的螢幕擷取畫面](images/dtpdatepick.png)

<span data-ttu-id="3c0c2-128">下圖顯示具有三個包含時間之控制項的視窗。</span><span class="sxs-lookup"><span data-stu-id="3c0c2-128">The following illustration shows a windows with three controls that contain the time.</span></span>

<span data-ttu-id="3c0c2-129">第一個控制項是使用 [**DTS \_ 時間格式**](date-and-time-picker-control-styles.md) 樣式建立的，而且會顯示預設時間的時間，這是由四個欄位所組成。</span><span class="sxs-lookup"><span data-stu-id="3c0c2-129">The first control has been created with the [**DTS\_TIMEFORMAT**](date-and-time-picker-control-styles.md) style and shows the time in the default time, which consists of four fields.</span></span> <span data-ttu-id="3c0c2-130">使用者可以在這些欄位中輸入有效的值，或選取欄位，然後使用上下箭號來變更值。</span><span class="sxs-lookup"><span data-stu-id="3c0c2-130">The user can type a valid value in any of these fields, or select the field and change the value by using the up-down control or arrow keys.</span></span>

<span data-ttu-id="3c0c2-131">第二個控制項會顯示使用 [**DateTime \_ SetFormat**](/windows/desktop/api/Commctrl/nf-commctrl-datetime_setformat)設定的自訂格式。</span><span class="sxs-lookup"><span data-stu-id="3c0c2-131">The second control shows a custom format set by using [**DateTime\_SetFormat**](/windows/desktop/api/Commctrl/nf-commctrl-datetime_setformat).</span></span> <span data-ttu-id="3c0c2-132">如同第一個控制項，使用者可以藉由輸入或使用方向鍵來變更時間欄位。</span><span class="sxs-lookup"><span data-stu-id="3c0c2-132">As with the first control, the user can change the time fields by typing or by using arrow keys.</span></span> <span data-ttu-id="3c0c2-133">當使用者按一下向下箭號時，從開啟的行事曆選取日期，即可變更星期幾。</span><span class="sxs-lookup"><span data-stu-id="3c0c2-133">The day of the week can be changed by selecting a date from the calendar that opens when the user clicks on the down arrow.</span></span>

<span data-ttu-id="3c0c2-134">第三個控制項會顯示如何將任意文字加入控制項。</span><span class="sxs-lookup"><span data-stu-id="3c0c2-134">The third control shows how arbitrary text can be added to the control.</span></span> <span data-ttu-id="3c0c2-135">使用者可以藉由輸入、使用箭號鍵或使用上下按鈕控制項，來選取一小時 (從1到 24) 。</span><span class="sxs-lookup"><span data-stu-id="3c0c2-135">The user can select an hour (from 1 to 24) by typing, by using the arrow keys, or by using the up-down control.</span></span>

![視窗的螢幕擷取畫面，顯示包含時間的三個控制項](images/dtpdatetimepick.png)

<span data-ttu-id="3c0c2-137">DTP 控制項會根據使用者的輸入自動更新內部資訊。</span><span class="sxs-lookup"><span data-stu-id="3c0c2-137">The DTP control automatically updates internal information based on the user's input.</span></span> <span data-ttu-id="3c0c2-138">控制項會將下列各項辨識為有效的輸入。</span><span class="sxs-lookup"><span data-stu-id="3c0c2-138">The control recognizes the following as valid input.</span></span>



| <span data-ttu-id="3c0c2-139">輸入類別</span><span class="sxs-lookup"><span data-stu-id="3c0c2-139">Input Category</span></span> | <span data-ttu-id="3c0c2-140">Description</span><span class="sxs-lookup"><span data-stu-id="3c0c2-140">Description</span></span>                                                                                                                                                                                                                                                                                                                                                                  |
|----------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="3c0c2-141">箭號鍵</span><span class="sxs-lookup"><span data-stu-id="3c0c2-141">Arrow Keys</span></span>     | <span data-ttu-id="3c0c2-142">控制項接受箭號鍵來導覽控制項中的欄位，以及變更值。</span><span class="sxs-lookup"><span data-stu-id="3c0c2-142">The control accepts arrow keys to navigate the fields in the control and change values.</span></span> <span data-ttu-id="3c0c2-143">如果使用者嘗試以指定的方向移動超過最後一個欄位，則使用者可以按下或鍵來移動控制項，鍵盤焦點會「換行」至控制項的另一邊的欄位。</span><span class="sxs-lookup"><span data-stu-id="3c0c2-143">The user can press the or keys to move through the control If the user attempts to move past the last field in a given direction, the keyboard focus "wraps around" to the field on the opposite side of the control.</span></span> <span data-ttu-id="3c0c2-144">和索引鍵會以累加方式變更目前欄位中的值。</span><span class="sxs-lookup"><span data-stu-id="3c0c2-144">The and keys change values in the current field incrementally.</span></span> |
| <span data-ttu-id="3c0c2-145">結束和首頁</span><span class="sxs-lookup"><span data-stu-id="3c0c2-145">End and Home</span></span>   | <span data-ttu-id="3c0c2-146">控制項接受 VK \_ END 和 VK \_ HOME 虛擬機器碼，以將目前欄位內的值分別變更為其上限和下限。</span><span class="sxs-lookup"><span data-stu-id="3c0c2-146">The control accepts the VK\_END and VK\_HOME virtual keys to change the value within the current field to its upper and lower limits, respectively.</span></span>                                                                                                                                                                                                                          |
| <span data-ttu-id="3c0c2-147">函數金鑰</span><span class="sxs-lookup"><span data-stu-id="3c0c2-147">Function Keys</span></span>  | <span data-ttu-id="3c0c2-148">金鑰會啟用編輯模式。</span><span class="sxs-lookup"><span data-stu-id="3c0c2-148">The key activates edit mode.</span></span> <span data-ttu-id="3c0c2-149">按鍵會讓控制項顯示下拉式月曆控制項， (按下 [) ]。</span><span class="sxs-lookup"><span data-stu-id="3c0c2-149">The key causes the control to display a drop-down month calendar control (pressing does this as well).</span></span>                                                                                                                                                                                                                                          |
| <span data-ttu-id="3c0c2-150">數字</span><span class="sxs-lookup"><span data-stu-id="3c0c2-150">Numbers</span></span>        | <span data-ttu-id="3c0c2-151">控制項接受兩個字元區段中的數值輸入。</span><span class="sxs-lookup"><span data-stu-id="3c0c2-151">The control accepts numeric input in two-character segments.</span></span> <span data-ttu-id="3c0c2-152">如果使用者輸入的值無效 (例如將月份設定為 14) ，控制項會拒絕它，並將顯示重設為先前的值。</span><span class="sxs-lookup"><span data-stu-id="3c0c2-152">If the value entered by the user is invalid (like setting the month to 14), the control rejects it and resets the display to the previous value.</span></span>                                                                                                                                                                |
| <span data-ttu-id="3c0c2-153">加號和減號</span><span class="sxs-lookup"><span data-stu-id="3c0c2-153">Plus and Minus</span></span> | <span data-ttu-id="3c0c2-154">此控制項可接受 VK \_ ADD 和 VK \_ 減數位鍵台的虛擬機器，以遞增和遞減目前欄位中的值。</span><span class="sxs-lookup"><span data-stu-id="3c0c2-154">The control accepts the VK\_ADD and VK\_SUBTRACT virtual keys from the numeric keypad to increment and decrement the value in the current field.</span></span>                                                                                                                                                                                                                             |



 

<span data-ttu-id="3c0c2-155">未使用 [**DTS \_ 上下按鈕**](date-and-time-picker-control-styles.md) 樣式的 DTP 控制項會顯示箭號按鈕。</span><span class="sxs-lookup"><span data-stu-id="3c0c2-155">DTP controls that do not use the [**DTS\_UPDOWN**](date-and-time-picker-control-styles.md) style display an arrow button.</span></span> <span data-ttu-id="3c0c2-156">如果使用者按一下此按鈕，月曆控制項就會下拉。</span><span class="sxs-lookup"><span data-stu-id="3c0c2-156">If the user clicks this button, a month calendar control drops down.</span></span> <span data-ttu-id="3c0c2-157">使用者可以按一下行事曆的區域來選取特定日期。</span><span class="sxs-lookup"><span data-stu-id="3c0c2-157">The user can select a specific date by clicking an area of the calendar.</span></span>

## <a name="date-and-time-picker-control-styles-and-formats"></a><span data-ttu-id="3c0c2-158">日期和時間選擇器控制項樣式和格式</span><span class="sxs-lookup"><span data-stu-id="3c0c2-158">Date and Time Picker Control Styles and Formats</span></span>

<span data-ttu-id="3c0c2-159">日期和時間選擇器 (DTP) 控制項有數種 [日期和時間選擇器控制項樣式](date-and-time-picker-control-styles.md) ，可決定控制項的外觀和行為。</span><span class="sxs-lookup"><span data-stu-id="3c0c2-159">Date and time picker (DTP) controls have several [Date and Time Picker Control Styles](date-and-time-picker-control-styles.md) that determine a control's appearance and behavior.</span></span> <span data-ttu-id="3c0c2-160">使用 [**CreateWindowEx**](/windows/desktop/api/winuser/nf-winuser-createwindowexa)的 *dwStyle* 參數來建立控制項時，請指定樣式。</span><span class="sxs-lookup"><span data-stu-id="3c0c2-160">Specify the style when creating the control with the *dwStyle* parameter of [**CreateWindowEx**](/windows/desktop/api/winuser/nf-winuser-createwindowexa).</span></span> <span data-ttu-id="3c0c2-161">若要在建立控制項之後取得或變更視窗樣式，請使用 [**GetWindowLong**](/windows/desktop/api/winuser/nf-winuser-getwindowlonga) 和 [**SetWindowLong**](/windows/desktop/api/winuser/nf-winuser-setwindowlonga)。</span><span class="sxs-lookup"><span data-stu-id="3c0c2-161">To retrieve or change the window style after you have created the control, use [**GetWindowLong**](/windows/desktop/api/winuser/nf-winuser-getwindowlonga) and [**SetWindowLong**](/windows/desktop/api/winuser/nf-winuser-setwindowlonga).</span></span>

### <a name="preset-formats"></a><span data-ttu-id="3c0c2-162">預設格式</span><span class="sxs-lookup"><span data-stu-id="3c0c2-162">Preset Formats</span></span>

<span data-ttu-id="3c0c2-163">有三種預設格式可用來顯示日期，另一種則用於顯示時間。</span><span class="sxs-lookup"><span data-stu-id="3c0c2-163">There are three preset formats available for displaying the date and one for displaying time.</span></span> <span data-ttu-id="3c0c2-164">選擇下列其中一個視窗樣式來設定這些格式。</span><span class="sxs-lookup"><span data-stu-id="3c0c2-164">Set these formats by choosing one of the following window styles.</span></span>



|                                                                                                       |                                                            |
|-------------------------------------------------------------------------------------------------------|------------------------------------------------------------|
| [<span data-ttu-id="3c0c2-165">**DTS \_ LONGDATEFORMAT**</span><span class="sxs-lookup"><span data-stu-id="3c0c2-165">**DTS\_LONGDATEFORMAT**</span></span>](date-and-time-picker-control-styles.md)                 | <span data-ttu-id="3c0c2-166">顯示內容看起來會像是「1996年4月19日星期五」。</span><span class="sxs-lookup"><span data-stu-id="3c0c2-166">The display will look like: "Friday, April 19, 1996".</span></span>      |
| [<span data-ttu-id="3c0c2-167">**DTS \_ SHORTDATEFORMAT**</span><span class="sxs-lookup"><span data-stu-id="3c0c2-167">**DTS\_SHORTDATEFORMAT**</span></span>](date-and-time-picker-control-styles.md)               | <span data-ttu-id="3c0c2-168">顯示內容看起來會像是 "4/19/96"。</span><span class="sxs-lookup"><span data-stu-id="3c0c2-168">The display will look like: "4/19/96".</span></span>                     |
| [<span data-ttu-id="3c0c2-169">**DTS \_ SHORTDATECENTURYFORMAT**</span><span class="sxs-lookup"><span data-stu-id="3c0c2-169">**DTS\_SHORTDATECENTURYFORMAT**</span></span>](date-and-time-picker-control-styles.md) | <span data-ttu-id="3c0c2-170">**版本 5.80**。</span><span class="sxs-lookup"><span data-stu-id="3c0c2-170">**Version 5.80**.</span></span> <span data-ttu-id="3c0c2-171">顯示內容看起來會像是 "4/19/1996"。</span><span class="sxs-lookup"><span data-stu-id="3c0c2-171">The display will look like: "4/19/1996".</span></span> |
| [<span data-ttu-id="3c0c2-172">**DTS \_ 時間格式**</span><span class="sxs-lookup"><span data-stu-id="3c0c2-172">**DTS\_TIMEFORMAT**</span></span>](date-and-time-picker-control-styles.md)                         | <span data-ttu-id="3c0c2-173">顯示器看起來會像是： "5:31:42 PM"。</span><span class="sxs-lookup"><span data-stu-id="3c0c2-173">The display will look like: "5:31:42 PM".</span></span>                  |



 

### <a name="custom-formats"></a><span data-ttu-id="3c0c2-174">自訂格式</span><span class="sxs-lookup"><span data-stu-id="3c0c2-174">Custom formats</span></span>

<span data-ttu-id="3c0c2-175">DTP 控制項會依賴格式字串來決定它會如何顯示資訊的欄位。</span><span class="sxs-lookup"><span data-stu-id="3c0c2-175">A DTP control relies on a format string to determine how it will display fields of information.</span></span> <span data-ttu-id="3c0c2-176">如果預設格式不足夠，您可以藉由定義自己的格式字串來建立自訂格式。</span><span class="sxs-lookup"><span data-stu-id="3c0c2-176">If the preset formats are not sufficient, you can create a custom format by defining your own format string.</span></span> <span data-ttu-id="3c0c2-177">自訂格式可為應用程式提供更大的彈性。</span><span class="sxs-lookup"><span data-stu-id="3c0c2-177">Custom formats provide greater flexibility for an application.</span></span> <span data-ttu-id="3c0c2-178">它們可讓您指定控制項將顯示資訊欄位的順序。</span><span class="sxs-lookup"><span data-stu-id="3c0c2-178">They enable you to specify the order in which the control will display fields of information.</span></span> <span data-ttu-id="3c0c2-179">您可以包含內文文字以及回呼欄位，以便向使用者要求資訊。</span><span class="sxs-lookup"><span data-stu-id="3c0c2-179">You can include body text as well as callback fields for requesting information from the user.</span></span> <span data-ttu-id="3c0c2-180">建立字串之後，您可以將它指派給具有 [**DTM \_ SETFORMAT**](dtm-setformat.md) 訊息的 DTP 控制項。</span><span class="sxs-lookup"><span data-stu-id="3c0c2-180">Once the string is created, you assign it to the DTP control with a [**DTM\_SETFORMAT**](dtm-setformat.md) message.</span></span>

### <a name="format-strings"></a><span data-ttu-id="3c0c2-181">格式字串</span><span class="sxs-lookup"><span data-stu-id="3c0c2-181">Format Strings</span></span>

<span data-ttu-id="3c0c2-182">DTP 格式字串是由一系列的元素所組成，這些專案代表特定的資訊片段，並定義其顯示格式。</span><span class="sxs-lookup"><span data-stu-id="3c0c2-182">A DTP format string consists of a series of elements that represent a particular piece of information and define its display format.</span></span> <span data-ttu-id="3c0c2-183">專案會依照其在格式字串中出現的順序顯示。</span><span class="sxs-lookup"><span data-stu-id="3c0c2-183">The elements will be displayed in the order they appear in the format string.</span></span>

<span data-ttu-id="3c0c2-184">日期和時間格式專案將會取代為實際的日期和時間。</span><span class="sxs-lookup"><span data-stu-id="3c0c2-184">Date and time format elements will be replaced by the actual date and time.</span></span> <span data-ttu-id="3c0c2-185">它們是由下列字元群組所定義。</span><span class="sxs-lookup"><span data-stu-id="3c0c2-185">They are defined by the following groups of characters.</span></span>



| <span data-ttu-id="3c0c2-186">元素</span><span class="sxs-lookup"><span data-stu-id="3c0c2-186">Element</span></span> | <span data-ttu-id="3c0c2-187">描述</span><span class="sxs-lookup"><span data-stu-id="3c0c2-187">Description</span></span>                                                                       |
|---------|-----------------------------------------------------------------------------------|
| <span data-ttu-id="3c0c2-188">"d"</span><span class="sxs-lookup"><span data-stu-id="3c0c2-188">"d"</span></span>     | <span data-ttu-id="3c0c2-189">一或兩位數的日期。</span><span class="sxs-lookup"><span data-stu-id="3c0c2-189">The one- or two-digit day.</span></span>                                                        |
| <span data-ttu-id="3c0c2-190">"dd"</span><span class="sxs-lookup"><span data-stu-id="3c0c2-190">"dd"</span></span>    | <span data-ttu-id="3c0c2-191">兩位數的日期。</span><span class="sxs-lookup"><span data-stu-id="3c0c2-191">The two-digit day.</span></span> <span data-ttu-id="3c0c2-192">單一位數的日值前面會加上零。</span><span class="sxs-lookup"><span data-stu-id="3c0c2-192">Single-digit day values are preceded by a zero.</span></span>                |
| <span data-ttu-id="3c0c2-193">"ddd"</span><span class="sxs-lookup"><span data-stu-id="3c0c2-193">"ddd"</span></span>   | <span data-ttu-id="3c0c2-194">三個字元的工作日縮寫。</span><span class="sxs-lookup"><span data-stu-id="3c0c2-194">The three-character weekday abbreviation.</span></span>                                         |
| <span data-ttu-id="3c0c2-195">"dddd"</span><span class="sxs-lookup"><span data-stu-id="3c0c2-195">"dddd"</span></span>  | <span data-ttu-id="3c0c2-196">完整的工作日名稱。</span><span class="sxs-lookup"><span data-stu-id="3c0c2-196">The full weekday name.</span></span>                                                            |
| <span data-ttu-id="3c0c2-197">"h"</span><span class="sxs-lookup"><span data-stu-id="3c0c2-197">"h"</span></span>     | <span data-ttu-id="3c0c2-198">12小時格式的一或兩位數小時。</span><span class="sxs-lookup"><span data-stu-id="3c0c2-198">The one- or two-digit hour in 12-hour format.</span></span>                                     |
| <span data-ttu-id="3c0c2-199">"hh"</span><span class="sxs-lookup"><span data-stu-id="3c0c2-199">"hh"</span></span>    | <span data-ttu-id="3c0c2-200">12小時制的兩位數小時。</span><span class="sxs-lookup"><span data-stu-id="3c0c2-200">The two-digit hour in 12-hour format.</span></span> <span data-ttu-id="3c0c2-201">單一位數值的前面會加上零。</span><span class="sxs-lookup"><span data-stu-id="3c0c2-201">Single-digit values are preceded by a zero.</span></span> |
| <span data-ttu-id="3c0c2-202">"H"</span><span class="sxs-lookup"><span data-stu-id="3c0c2-202">"H"</span></span>     | <span data-ttu-id="3c0c2-203">以24小時制格式的一或兩位數小時。</span><span class="sxs-lookup"><span data-stu-id="3c0c2-203">The one- or two-digit hour in 24-hour format.</span></span>                                     |
| <span data-ttu-id="3c0c2-204">"HH"</span><span class="sxs-lookup"><span data-stu-id="3c0c2-204">"HH"</span></span>    | <span data-ttu-id="3c0c2-205">以24小時制的兩位數小時。</span><span class="sxs-lookup"><span data-stu-id="3c0c2-205">The two-digit hour in 24-hour format.</span></span> <span data-ttu-id="3c0c2-206">單一位數值的前面會加上零。</span><span class="sxs-lookup"><span data-stu-id="3c0c2-206">Single-digit values are preceded by a zero.</span></span> |
| <span data-ttu-id="3c0c2-207">"m"</span><span class="sxs-lookup"><span data-stu-id="3c0c2-207">"m"</span></span>     | <span data-ttu-id="3c0c2-208">一或兩位數的分鐘。</span><span class="sxs-lookup"><span data-stu-id="3c0c2-208">The one- or two-digit minute.</span></span>                                                     |
| <span data-ttu-id="3c0c2-209">"mm"</span><span class="sxs-lookup"><span data-stu-id="3c0c2-209">"mm"</span></span>    | <span data-ttu-id="3c0c2-210">兩位數的分鐘。</span><span class="sxs-lookup"><span data-stu-id="3c0c2-210">The two-digit minute.</span></span> <span data-ttu-id="3c0c2-211">單一位數值的前面會加上零。</span><span class="sxs-lookup"><span data-stu-id="3c0c2-211">Single-digit values are preceded by a zero.</span></span>                 |
| <span data-ttu-id="3c0c2-212">"M"</span><span class="sxs-lookup"><span data-stu-id="3c0c2-212">"M"</span></span>     | <span data-ttu-id="3c0c2-213">一或兩位數的月份數位。</span><span class="sxs-lookup"><span data-stu-id="3c0c2-213">The one- or two-digit month number.</span></span>                                               |
| <span data-ttu-id="3c0c2-214">"MM"</span><span class="sxs-lookup"><span data-stu-id="3c0c2-214">"MM"</span></span>    | <span data-ttu-id="3c0c2-215">兩位數的月份數位。</span><span class="sxs-lookup"><span data-stu-id="3c0c2-215">The two-digit month number.</span></span> <span data-ttu-id="3c0c2-216">單一位數值的前面會加上零。</span><span class="sxs-lookup"><span data-stu-id="3c0c2-216">Single-digit values are preceded by a zero.</span></span>           |
| <span data-ttu-id="3c0c2-217">"MMM"</span><span class="sxs-lookup"><span data-stu-id="3c0c2-217">"MMM"</span></span>   | <span data-ttu-id="3c0c2-218">三個字元的月份縮寫。</span><span class="sxs-lookup"><span data-stu-id="3c0c2-218">The three-character month abbreviation.</span></span>                                           |
| <span data-ttu-id="3c0c2-219">"MMMM"</span><span class="sxs-lookup"><span data-stu-id="3c0c2-219">"MMMM"</span></span>  | <span data-ttu-id="3c0c2-220">完整月份名稱。</span><span class="sxs-lookup"><span data-stu-id="3c0c2-220">The full month name.</span></span>                                                              |
| <span data-ttu-id="3c0c2-221">"t"</span><span class="sxs-lookup"><span data-stu-id="3c0c2-221">"t"</span></span>     | <span data-ttu-id="3c0c2-222">單字母 AM/PM 縮寫 (也就是說，AM 會顯示為 "A" ) 。</span><span class="sxs-lookup"><span data-stu-id="3c0c2-222">The one-letter AM/PM abbreviation (that is, AM is displayed as "A").</span></span>              |
| <span data-ttu-id="3c0c2-223">"tt"</span><span class="sxs-lookup"><span data-stu-id="3c0c2-223">"tt"</span></span>    | <span data-ttu-id="3c0c2-224">雙字母上午/下午的縮寫 (也就是說，AM 會顯示為 "AM" ) 。</span><span class="sxs-lookup"><span data-stu-id="3c0c2-224">The two-letter AM/PM abbreviation (that is, AM is displayed as "AM").</span></span>             |
| <span data-ttu-id="3c0c2-225">"yy"</span><span class="sxs-lookup"><span data-stu-id="3c0c2-225">"yy"</span></span>    | <span data-ttu-id="3c0c2-226">年份的最後兩個數字 (也就是說，1996會顯示為 "96" ) 。</span><span class="sxs-lookup"><span data-stu-id="3c0c2-226">The last two digits of the year (that is, 1996 would be displayed as "96").</span></span>       |
| <span data-ttu-id="3c0c2-227">"yyyy"</span><span class="sxs-lookup"><span data-stu-id="3c0c2-227">"yyyy"</span></span>  | <span data-ttu-id="3c0c2-228">一年 (，1996會顯示為 "1996" ) 。</span><span class="sxs-lookup"><span data-stu-id="3c0c2-228">The full year (that is, 1996 would be displayed as "1996").</span></span>                       |



 

<span data-ttu-id="3c0c2-229">若要讓資訊更容易閱讀，您可以將本文以單引號括住，以將本文文字加入至格式字串。</span><span class="sxs-lookup"><span data-stu-id="3c0c2-229">To make the information more readable, you can add body text to the format string by enclosing it in single quotes.</span></span> <span data-ttu-id="3c0c2-230">空格和標點符號不需要加上引號。</span><span class="sxs-lookup"><span data-stu-id="3c0c2-230">Spaces and punctuation marks do not need to be quoted.</span></span>

> [!Note]  
> <span data-ttu-id="3c0c2-231">未以單引號分隔的非字元將會導致 DTP 控制項無法預期地顯示。</span><span class="sxs-lookup"><span data-stu-id="3c0c2-231">Nonformat characters that are not delimited by single quotes will result in unpredictable display by the DTP control.</span></span>

<span data-ttu-id="3c0c2-232">例如，若要顯示目前的日期，其格式為 "' Today 為：04:22:31 星期二3月23日，1996"，格式字串為 "' Today '： ' hh '： '： '： ' 的 dddd MMM dd '，' yyyy"。</span><span class="sxs-lookup"><span data-stu-id="3c0c2-232">For example, to display the current date with the format "'Today is: 04:22:31 Tuesday Mar 23, 1996", the format string is "'Today is: 'hh':'m':'s dddd MMM dd', 'yyyy".</span></span> <span data-ttu-id="3c0c2-233">若要在本文文字中包含單引號，請使用兩個連續的單引號。</span><span class="sxs-lookup"><span data-stu-id="3c0c2-233">To include a single quote in your body text, use two consecutive single quotes.</span></span> <span data-ttu-id="3c0c2-234">例如，"' 別忘了 ' MMM dd '，' yyyy" 會產生如下所示的輸出：不要忘記1996年3月23日。</span><span class="sxs-lookup"><span data-stu-id="3c0c2-234">For example, "'Don't forget' MMM dd',' yyyy" produces output that looks like: Do not forget Mar 23, 1996.</span></span> <span data-ttu-id="3c0c2-235">您不一定要使用引號搭配逗點，因此「' 別忘了 ' MMM dd，yyyy "也是有效的，而且會產生相同的輸出。</span><span class="sxs-lookup"><span data-stu-id="3c0c2-235">It is not necessary to use quotes with the comma, so "'Don't forget' MMM dd, yyyy" is also valid, and produces the same output.</span></span>

### <a name="callback-fields"></a><span data-ttu-id="3c0c2-236">回呼欄位</span><span class="sxs-lookup"><span data-stu-id="3c0c2-236">Callback fields</span></span>

<span data-ttu-id="3c0c2-237">除了標準 [格式字串](#format-strings) 和內文文字之外，您也可以將顯示的某些部分定義為 [回呼欄位](#callback-fields)。</span><span class="sxs-lookup"><span data-stu-id="3c0c2-237">In addition to the standard [Format Strings](#format-strings) and body text, you can also define certain parts of the display as [Callback fields](#callback-fields).</span></span> <span data-ttu-id="3c0c2-238">這些欄位可以用來查詢使用者的資訊。</span><span class="sxs-lookup"><span data-stu-id="3c0c2-238">These fields can be used to query the user for information.</span></span> <span data-ttu-id="3c0c2-239">若要宣告回呼欄位，請在格式字串中的任何位置包含一或多個 "X" 字元 (ASCII 代碼 88) 。</span><span class="sxs-lookup"><span data-stu-id="3c0c2-239">To declare a callback field, include one or more "X" characters (ASCII Code 88) anywhere in the format string.</span></span> <span data-ttu-id="3c0c2-240">您可以重複 "X" 字元，建立具有唯一身分識別的回呼欄位。</span><span class="sxs-lookup"><span data-stu-id="3c0c2-240">You can create callback fields that have a unique identity by repeating the "X" character.</span></span> <span data-ttu-id="3c0c2-241">因此，格式字串 "XX dddd MMM dd '，' yyy XXX" 包含兩個唯一的回呼欄位： "XX" 和 "XXX"。</span><span class="sxs-lookup"><span data-stu-id="3c0c2-241">Thus, the format string "XX dddd MMM dd', 'yyy XXX" contains two unique callback fields, "XX" and "XXX".</span></span> <span data-ttu-id="3c0c2-242">如同其他 DTP 控制項欄位，回呼欄位會根據其在格式字串中的位置，以左至右的順序顯示。</span><span class="sxs-lookup"><span data-stu-id="3c0c2-242">Like other DTP control fields, callback fields are displayed in left-to-right order based on their location in the format string.</span></span>

<span data-ttu-id="3c0c2-243">當 DTP 控制項剖析格式字串並遇到回呼欄位時，它會傳送 [DTN \_ 格式](dtn-format.md) 和 [DTN \_ FORMATQUERY](dtn-formatquery.md) 通知碼。</span><span class="sxs-lookup"><span data-stu-id="3c0c2-243">When the DTP control parses the format string and encounters a callback field, it sends [DTN\_FORMAT](dtn-format.md) and [DTN\_FORMATQUERY](dtn-formatquery.md) notification codes.</span></span> <span data-ttu-id="3c0c2-244">對應至回呼欄位的格式字串專案會隨附于通知中，以允許接收應用程式判斷正在查詢的回呼欄位。</span><span class="sxs-lookup"><span data-stu-id="3c0c2-244">The format string element corresponding to the callback field is included with the notifications to allow the receiving application to determine which callback field is being queried.</span></span> <span data-ttu-id="3c0c2-245">控制項的擁有者必須回應這些通知，以確保已正確顯示自訂資訊。</span><span class="sxs-lookup"><span data-stu-id="3c0c2-245">The owner of the control must respond to these notifications to ensure that the custom information is properly displayed.</span></span>

## <a name="date-and-time-picker-control-notification-messages"></a><span data-ttu-id="3c0c2-246">日期和時間選擇器控制項通知訊息</span><span class="sxs-lookup"><span data-stu-id="3c0c2-246">Date and Time Picker Control Notification Messages</span></span>

<span data-ttu-id="3c0c2-247">日期和時間選擇器 (DTP) 控制項接收使用者輸入或處理常式，以及回應回呼欄位時，會傳送通知碼。</span><span class="sxs-lookup"><span data-stu-id="3c0c2-247">A date and time picker (DTP) control sends notification codes when it receives user input or processes and reacts to callback fields.</span></span> <span data-ttu-id="3c0c2-248">控制項的父系以 [**WM \_ 通知**](wm-notify.md) 訊息的形式接收這些通知碼。</span><span class="sxs-lookup"><span data-stu-id="3c0c2-248">The parent of the control receives these notification codes in the form of [**WM\_NOTIFY**](wm-notify.md) messages.</span></span>

<span data-ttu-id="3c0c2-249">下列通知碼適用于 DTP 控制項。</span><span class="sxs-lookup"><span data-stu-id="3c0c2-249">The following notification codes are used with DTP controls.</span></span>



| <span data-ttu-id="3c0c2-250">通知碼</span><span class="sxs-lookup"><span data-stu-id="3c0c2-250">Notification code</span></span>                             | <span data-ttu-id="3c0c2-251">Description</span><span class="sxs-lookup"><span data-stu-id="3c0c2-251">Description</span></span>                                                                                                                                                                                                       |
|-----------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="3c0c2-252">DTN \_ 特寫</span><span class="sxs-lookup"><span data-stu-id="3c0c2-252">DTN\_CLOSEUP</span></span>](dtn-closeup.md)               | <span data-ttu-id="3c0c2-253">指出即將移除下拉月曆的行事曆。</span><span class="sxs-lookup"><span data-stu-id="3c0c2-253">Indicates that the drop-down month calendar is about to be removed.</span></span>                                                                                                                                               |
| [<span data-ttu-id="3c0c2-254">DTN \_ DATETIMECHANGE</span><span class="sxs-lookup"><span data-stu-id="3c0c2-254">DTN\_DATETIMECHANGE</span></span>](dtn-datetimechange.md) | <span data-ttu-id="3c0c2-255">通知 DTP 控制項內的變更。</span><span class="sxs-lookup"><span data-stu-id="3c0c2-255">Signals a change within the DTP control.</span></span>                                                                                                                                                                          |
| [<span data-ttu-id="3c0c2-256">DTN \_ 下拉式清單</span><span class="sxs-lookup"><span data-stu-id="3c0c2-256">DTN\_DROPDOWN</span></span>](dtn-dropdown.md)             | <span data-ttu-id="3c0c2-257">指出即將顯示下拉式月份行事曆。</span><span class="sxs-lookup"><span data-stu-id="3c0c2-257">Indicates that the drop-down month calendar is about to be displayed.</span></span>                                                                                                                                             |
| [<span data-ttu-id="3c0c2-258">DTN \_ 格式</span><span class="sxs-lookup"><span data-stu-id="3c0c2-258">DTN\_FORMAT</span></span>](dtn-format.md)                 | <span data-ttu-id="3c0c2-259">要求文字顯示在描述為回呼欄位的格式字串部分中。</span><span class="sxs-lookup"><span data-stu-id="3c0c2-259">Requests text to display in a portion of the format string described as a callback field.</span></span>                                                                                                                         |
| [<span data-ttu-id="3c0c2-260">DTN \_ FORMATQUERY</span><span class="sxs-lookup"><span data-stu-id="3c0c2-260">DTN\_FORMATQUERY</span></span>](dtn-formatquery.md)       | <span data-ttu-id="3c0c2-261">要求要顯示在回呼欄位中之文字的最大可允許大小的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="3c0c2-261">Requests information about the maximum allowable size of the text to be displayed in a callback field.</span></span>                                                                                                            |
| [<span data-ttu-id="3c0c2-262">DTN \_ USERSTRING</span><span class="sxs-lookup"><span data-stu-id="3c0c2-262">DTN\_USERSTRING</span></span>](dtn-userstring.md)         | <span data-ttu-id="3c0c2-263">表示使用者在控制項中編輯作業的結尾。</span><span class="sxs-lookup"><span data-stu-id="3c0c2-263">Signals the end of a user's edit operation within the control.</span></span> <span data-ttu-id="3c0c2-264">此通知僅由使用 [**DTS \_ APPCANPARSE**](date-and-time-picker-control-styles.md) 樣式的 DTP 控制項所傳送。</span><span class="sxs-lookup"><span data-stu-id="3c0c2-264">This notification is sent only by DTP controls that use the [**DTS\_APPCANPARSE**](date-and-time-picker-control-styles.md) style.</span></span> |
| [<span data-ttu-id="3c0c2-265">DTN \_ WMKEYDOWN</span><span class="sxs-lookup"><span data-stu-id="3c0c2-265">DTN\_WMKEYDOWN</span></span>](dtn-wmkeydown.md)           | <span data-ttu-id="3c0c2-266">表示使用者已在 DTP 控制項的回呼欄位中按下某個按鍵。</span><span class="sxs-lookup"><span data-stu-id="3c0c2-266">Signals that the user has pressed a key in a callback field of the DTP control.</span></span>                                                                                                                                   |



 

## <a name="related-topics"></a><span data-ttu-id="3c0c2-267">相關主題</span><span class="sxs-lookup"><span data-stu-id="3c0c2-267">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="3c0c2-268">日期和時間選擇器控制項參考</span><span class="sxs-lookup"><span data-stu-id="3c0c2-268">Date and Time Picker Control Reference</span></span>](date-and-time-picker-control-reference.md)
</dt> </dl>

 

 