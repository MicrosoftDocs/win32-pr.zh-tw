---
title: 關於日期和時間選擇器控制項
description: 日期和時間選擇器 (DTP) 控制項提供簡單且直覺的介面，可讓您用來與使用者交換日期和時間資訊。
ms.assetid: 6749c3ae-2c52-4183-ac4e-68ca7ebf1e13
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 04604c01a73aa8f2ebb8542061412372faee5282
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/21/2020
ms.locfileid: "104024210"
---
# <a name="about-date-and-time-picker-controls"></a>關於日期和時間選擇器控制項

*日期和時間選擇器 (DTP) 控制項* 提供簡單且直覺的介面，可讓您用來與使用者交換日期和時間資訊。 例如，您可以使用 DTP 控制項要求使用者輸入日期，然後輕鬆地取出選取專案。

我們將討論下列主題：

-   [日期和時間選擇器消費者介面](#date-and-time-picker-user-interface)
-   [日期和時間選擇器控制項樣式和格式](#date-and-time-picker-control-styles-and-formats)
    -   [預設格式](#preset-formats)
    -   [自訂格式](#custom-formats)
    -   [格式字串](#format-strings)
    -   [回呼欄位](#callback-fields)
-   [日期和時間選擇器控制項通知訊息](#date-and-time-picker-control-notification-messages)
-   [相關主題](#related-topics)

> [!Note]
> Windows 不支援1601之前的日期。 如需詳細資訊，請參閱 [**FILETIME**](/windows/desktop/api/minwinbase/ns-minwinbase-filetime) 結構。
>
> 此控制項以西曆為基礎，這是在1753中引進的行事曆。 它不會計算與 Julian 行事曆一致的日期。

## <a name="date-and-time-picker-user-interface"></a>日期和時間選擇器消費者介面

日期和時間選擇器的工作區 (DTP) 控制項會顯示日期或時間資訊（或兩者），並作為使用者用來修改資訊的介面。 您可以從行事曆選取日期，也可以使用上下按鈕控制項來選取日期。您可以藉由在控制項 [格式字串](#format-strings)所定義的欄位中輸入來變更時間。 控制項（選擇性）會顯示覆選框。 核取此選項時，可以抓取控制項中的值;否則，會將控制項視為未初始化。

下圖顯示包含三個日期選擇器控制項的視窗。 第一個日期選擇器控制項是使用 [**dts \_ SHOWNONE**](date-and-time-picker-control-styles.md) 樣式（具有 [**dts \_ 上下按鈕**](date-and-time-picker-control-styles.md) 樣式的第二個）來建立，而第三個則沒有特殊樣式。 在第三個控制項中，使用者按一下向下箭號以顯示行事曆。

![示範三種日期選擇器控制項樣式之視窗的螢幕擷取畫面](images/dtpdatepick.png)

下圖顯示具有三個包含時間之控制項的視窗。

第一個控制項是使用 [**DTS \_ 時間格式**](date-and-time-picker-control-styles.md) 樣式建立的，而且會顯示預設時間的時間，這是由四個欄位所組成。 使用者可以在這些欄位中輸入有效的值，或選取欄位，然後使用上下箭號來變更值。

第二個控制項會顯示使用 [**DateTime \_ SetFormat**](/windows/desktop/api/Commctrl/nf-commctrl-datetime_setformat)設定的自訂格式。 如同第一個控制項，使用者可以藉由輸入或使用方向鍵來變更時間欄位。 當使用者按一下向下箭號時，從開啟的行事曆選取日期，即可變更星期幾。

第三個控制項會顯示如何將任意文字加入控制項。 使用者可以藉由輸入、使用箭號鍵或使用上下按鈕控制項，來選取一小時 (從1到 24) 。

![視窗的螢幕擷取畫面，顯示包含時間的三個控制項](images/dtpdatetimepick.png)

DTP 控制項會根據使用者的輸入自動更新內部資訊。 控制項會將下列各項辨識為有效的輸入。



| 輸入類別 | Description                                                                                                                                                                                                                                                                                                                                                                  |
|----------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 箭號鍵     | 控制項接受箭號鍵來導覽控制項中的欄位，以及變更值。 如果使用者嘗試以指定的方向移動超過最後一個欄位，則使用者可以按下或鍵來移動控制項，鍵盤焦點會「換行」至控制項的另一邊的欄位。 和索引鍵會以累加方式變更目前欄位中的值。 |
| 結束和首頁   | 控制項接受 VK \_ END 和 VK \_ HOME 虛擬機器碼，以將目前欄位內的值分別變更為其上限和下限。                                                                                                                                                                                                                          |
| 函數金鑰  | 金鑰會啟用編輯模式。 按鍵會讓控制項顯示下拉式月曆控制項， (按下 [) ]。                                                                                                                                                                                                                                          |
| 數字        | 控制項接受兩個字元區段中的數值輸入。 如果使用者輸入的值無效 (例如將月份設定為 14) ，控制項會拒絕它，並將顯示重設為先前的值。                                                                                                                                                                |
| 加號和減號 | 此控制項可接受 VK \_ ADD 和 VK \_ 減數位鍵台的虛擬機器，以遞增和遞減目前欄位中的值。                                                                                                                                                                                                                             |



 

未使用 [**DTS \_ 上下按鈕**](date-and-time-picker-control-styles.md) 樣式的 DTP 控制項會顯示箭號按鈕。 如果使用者按一下此按鈕，月曆控制項就會下拉。 使用者可以按一下行事曆的區域來選取特定日期。

## <a name="date-and-time-picker-control-styles-and-formats"></a>日期和時間選擇器控制項樣式和格式

日期和時間選擇器 (DTP) 控制項有數種 [日期和時間選擇器控制項樣式](date-and-time-picker-control-styles.md) ，可決定控制項的外觀和行為。 使用 [**CreateWindowEx**](/windows/desktop/api/winuser/nf-winuser-createwindowexa)的 *dwStyle* 參數來建立控制項時，請指定樣式。 若要在建立控制項之後取得或變更視窗樣式，請使用 [**GetWindowLong**](/windows/desktop/api/winuser/nf-winuser-getwindowlonga) 和 [**SetWindowLong**](/windows/desktop/api/winuser/nf-winuser-setwindowlonga)。

### <a name="preset-formats"></a>預設格式

有三種預設格式可用來顯示日期，另一種則用於顯示時間。 選擇下列其中一個視窗樣式來設定這些格式。



|                                                                                                       |                                                            |
|-------------------------------------------------------------------------------------------------------|------------------------------------------------------------|
| [**DTS \_ LONGDATEFORMAT**](date-and-time-picker-control-styles.md)                 | 顯示內容看起來會像是「1996年4月19日星期五」。      |
| [**DTS \_ SHORTDATEFORMAT**](date-and-time-picker-control-styles.md)               | 顯示內容看起來會像是 "4/19/96"。                     |
| [**DTS \_ SHORTDATECENTURYFORMAT**](date-and-time-picker-control-styles.md) | **版本 5.80**。 顯示內容看起來會像是 "4/19/1996"。 |
| [**DTS \_ 時間格式**](date-and-time-picker-control-styles.md)                         | 顯示器看起來會像是： "5:31:42 PM"。                  |



 

### <a name="custom-formats"></a>自訂格式

DTP 控制項會依賴格式字串來決定它會如何顯示資訊的欄位。 如果預設格式不足夠，您可以藉由定義自己的格式字串來建立自訂格式。 自訂格式可為應用程式提供更大的彈性。 它們可讓您指定控制項將顯示資訊欄位的順序。 您可以包含內文文字以及回呼欄位，以便向使用者要求資訊。 建立字串之後，您可以將它指派給具有 [**DTM \_ SETFORMAT**](dtm-setformat.md) 訊息的 DTP 控制項。

### <a name="format-strings"></a>格式字串

DTP 格式字串是由一系列的元素所組成，這些專案代表特定的資訊片段，並定義其顯示格式。 專案會依照其在格式字串中出現的順序顯示。

日期和時間格式專案將會取代為實際的日期和時間。 它們是由下列字元群組所定義。



| 元素 | 描述                                                                       |
|---------|-----------------------------------------------------------------------------------|
| "d"     | 一或兩位數的日期。                                                        |
| "dd"    | 兩位數的日期。 單一位數的日值前面會加上零。                |
| "ddd"   | 三個字元的工作日縮寫。                                         |
| "dddd"  | 完整的工作日名稱。                                                            |
| "h"     | 12小時格式的一或兩位數小時。                                     |
| "hh"    | 12小時制的兩位數小時。 單一位數值的前面會加上零。 |
| "H"     | 以24小時制格式的一或兩位數小時。                                     |
| "HH"    | 以24小時制的兩位數小時。 單一位數值的前面會加上零。 |
| "m"     | 一或兩位數的分鐘。                                                     |
| "mm"    | 兩位數的分鐘。 單一位數值的前面會加上零。                 |
| "M"     | 一或兩位數的月份數位。                                               |
| "MM"    | 兩位數的月份數位。 單一位數值的前面會加上零。           |
| "MMM"   | 三個字元的月份縮寫。                                           |
| "MMMM"  | 完整月份名稱。                                                              |
| "t"     | 單字母 AM/PM 縮寫 (也就是說，AM 會顯示為 "A" ) 。              |
| "tt"    | 雙字母上午/下午的縮寫 (也就是說，AM 會顯示為 "AM" ) 。             |
| "yy"    | 年份的最後兩個數字 (也就是說，1996會顯示為 "96" ) 。       |
| "yyyy"  | 一年 (，1996會顯示為 "1996" ) 。                       |



 

若要讓資訊更容易閱讀，您可以將本文以單引號括住，以將本文文字加入至格式字串。 空格和標點符號不需要加上引號。

> [!Note]  
> 未以單引號分隔的非字元將會導致 DTP 控制項無法預期地顯示。

例如，若要顯示目前的日期，其格式為 "' Today 為：04:22:31 星期二3月23日，1996"，格式字串為 "' Today '： ' hh '： '： '： ' 的 dddd MMM dd '，' yyyy"。 若要在本文文字中包含單引號，請使用兩個連續的單引號。 例如，"' 別忘了 ' MMM dd '，' yyyy" 會產生如下所示的輸出：不要忘記1996年3月23日。 您不一定要使用引號搭配逗點，因此「' 別忘了 ' MMM dd，yyyy "也是有效的，而且會產生相同的輸出。

### <a name="callback-fields"></a>回呼欄位

除了標準 [格式字串](#format-strings) 和內文文字之外，您也可以將顯示的某些部分定義為 [回呼欄位](#callback-fields)。 這些欄位可以用來查詢使用者的資訊。 若要宣告回呼欄位，請在格式字串中的任何位置包含一或多個 "X" 字元 (ASCII 代碼 88) 。 您可以重複 "X" 字元，建立具有唯一身分識別的回呼欄位。 因此，格式字串 "XX dddd MMM dd '，' yyy XXX" 包含兩個唯一的回呼欄位： "XX" 和 "XXX"。 如同其他 DTP 控制項欄位，回呼欄位會根據其在格式字串中的位置，以左至右的順序顯示。

當 DTP 控制項剖析格式字串並遇到回呼欄位時，它會傳送 [DTN \_ 格式](dtn-format.md) 和 [DTN \_ FORMATQUERY](dtn-formatquery.md) 通知碼。 對應至回呼欄位的格式字串專案會隨附于通知中，以允許接收應用程式判斷正在查詢的回呼欄位。 控制項的擁有者必須回應這些通知，以確保已正確顯示自訂資訊。

## <a name="date-and-time-picker-control-notification-messages"></a>日期和時間選擇器控制項通知訊息

日期和時間選擇器 (DTP) 控制項接收使用者輸入或處理常式，以及回應回呼欄位時，會傳送通知碼。 控制項的父系以 [**WM \_ 通知**](wm-notify.md) 訊息的形式接收這些通知碼。

下列通知碼適用于 DTP 控制項。



| 通知碼                             | Description                                                                                                                                                                                                       |
|-----------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [DTN \_ 特寫](dtn-closeup.md)               | 指出即將移除下拉月曆的行事曆。                                                                                                                                               |
| [DTN \_ DATETIMECHANGE](dtn-datetimechange.md) | 通知 DTP 控制項內的變更。                                                                                                                                                                          |
| [DTN \_ 下拉式清單](dtn-dropdown.md)             | 指出即將顯示下拉式月份行事曆。                                                                                                                                             |
| [DTN \_ 格式](dtn-format.md)                 | 要求文字顯示在描述為回呼欄位的格式字串部分中。                                                                                                                         |
| [DTN \_ FORMATQUERY](dtn-formatquery.md)       | 要求要顯示在回呼欄位中之文字的最大可允許大小的相關資訊。                                                                                                            |
| [DTN \_ USERSTRING](dtn-userstring.md)         | 表示使用者在控制項中編輯作業的結尾。 此通知僅由使用 [**DTS \_ APPCANPARSE**](date-and-time-picker-control-styles.md) 樣式的 DTP 控制項所傳送。 |
| [DTN \_ WMKEYDOWN](dtn-wmkeydown.md)           | 表示使用者已在 DTP 控制項的回呼欄位中按下某個按鍵。                                                                                                                                   |



 

## <a name="related-topics"></a>相關主題

<dl> <dt>

[日期和時間選擇器控制項參考](date-and-time-picker-control-reference.md)
</dt> </dl>

 

 