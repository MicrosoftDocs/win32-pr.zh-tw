---
title: 日期和時間選擇器
description: 本章節包含與日期和時間選擇器控制項搭配使用之 API 元素的相關資訊。
ms.assetid: vs|controls|~\controls\datetime\reflist.htm
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 0e4e91b325b798ff465d8048cac2f0a9a72e5774
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/21/2020
ms.locfileid: "103842811"
---
# <a name="date-and-time-picker"></a><span data-ttu-id="8b03a-103">日期和時間選擇器</span><span class="sxs-lookup"><span data-stu-id="8b03a-103">Date and Time Picker</span></span>

<span data-ttu-id="8b03a-104">本章節包含與日期和時間選擇器控制項搭配使用之 API 元素的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="8b03a-104">This section contains information about the API elements used with date and time picker controls.</span></span>

### <a name="overviews"></a><span data-ttu-id="8b03a-105">概觀</span><span class="sxs-lookup"><span data-stu-id="8b03a-105">Overviews</span></span>



| <span data-ttu-id="8b03a-106">主題</span><span class="sxs-lookup"><span data-stu-id="8b03a-106">Topic</span></span>                                                                    | <span data-ttu-id="8b03a-107">目錄</span><span class="sxs-lookup"><span data-stu-id="8b03a-107">Contents</span></span>                                                                                                                                                     |
|--------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="8b03a-108">關於日期和時間選擇器控制項</span><span class="sxs-lookup"><span data-stu-id="8b03a-108">About Date and Time Picker Controls</span></span>](date-and-time-picker-controls.md) | <span data-ttu-id="8b03a-109">*日期和時間選擇器 (DTP) 控制項* 提供簡單且直覺的介面，可讓您用來與使用者交換日期和時間資訊。</span><span class="sxs-lookup"><span data-stu-id="8b03a-109">A *date and time picker (DTP) control* provides a simple and intuitive interface through which to exchange date and time information with a user.</span></span><br/> |
| [<span data-ttu-id="8b03a-110">使用日期時間選擇器控制項</span><span class="sxs-lookup"><span data-stu-id="8b03a-110">Using Date and Time Picker Controls</span></span>](using-date-and-time-picker.md)    | <span data-ttu-id="8b03a-111">本節提供用來執行日期和時間選擇器控制項的資訊和範例程式碼。</span><span class="sxs-lookup"><span data-stu-id="8b03a-111">This section provides information and sample code for implementing date and time picker controls.</span></span> <br/>                                                |



 

### <a name="macros"></a><span data-ttu-id="8b03a-112">巨集</span><span class="sxs-lookup"><span data-stu-id="8b03a-112">Macros</span></span>



| <span data-ttu-id="8b03a-113">主題</span><span class="sxs-lookup"><span data-stu-id="8b03a-113">Topic</span></span>                                                                     | <span data-ttu-id="8b03a-114">目錄</span><span class="sxs-lookup"><span data-stu-id="8b03a-114">Contents</span></span>                                                                                                                                                                                                                                                                     |
|---------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="8b03a-115">**DateTime \_ CloseMonthCal**</span><span class="sxs-lookup"><span data-stu-id="8b03a-115">**DateTime\_CloseMonthCal**</span></span>](/windows/desktop/api/Commctrl/nf-commctrl-datetime_closemonthcal)                 | <span data-ttu-id="8b03a-116">關閉 (DTP) 控制項的日期和時間選擇器。</span><span class="sxs-lookup"><span data-stu-id="8b03a-116">Closes the date and time picker (DTP) control.</span></span> <span data-ttu-id="8b03a-117">使用這個宏或明確地傳送 [**DTM \_ CLOSEMONTHCAL**](dtm-closemonthcal.md) 訊息。</span><span class="sxs-lookup"><span data-stu-id="8b03a-117">Use this macro or send the [**DTM\_CLOSEMONTHCAL**](dtm-closemonthcal.md) message explicitly.</span></span><br/>                                                                                                                     |
| [<span data-ttu-id="8b03a-118">**DateTime \_ GetDateTimePickerInfo**</span><span class="sxs-lookup"><span data-stu-id="8b03a-118">**DateTime\_GetDateTimePickerInfo**</span></span>](/windows/desktop/api/Commctrl/nf-commctrl-datetime_getdatetimepickerinfo) | <span data-ttu-id="8b03a-119">取得指定日期和時間選擇器 (DTP) 控制項的資訊。</span><span class="sxs-lookup"><span data-stu-id="8b03a-119">Gets information for a specified date and time picker (DTP) control.</span></span><br/>                                                                                                                                                                                              |
| [<span data-ttu-id="8b03a-120">**DateTime \_ GetIdealSize**</span><span class="sxs-lookup"><span data-stu-id="8b03a-120">**DateTime\_GetIdealSize**</span></span>](/windows/desktop/api/Commctrl/nf-commctrl-datetime_getidealsize)                   | <span data-ttu-id="8b03a-121">取得在不剪切的情況下顯示控制項所需的大小。</span><span class="sxs-lookup"><span data-stu-id="8b03a-121">Gets the size needed to display the control without clipping.</span></span> <span data-ttu-id="8b03a-122">使用這個宏或明確地傳送 [**DTM \_ GETIDEALSIZE**](dtm-getidealsize.md) 訊息。</span><span class="sxs-lookup"><span data-stu-id="8b03a-122">Use this macro or send the [**DTM\_GETIDEALSIZE**](dtm-getidealsize.md) message explicitly.</span></span><br/>                                                                                                        |
| [<span data-ttu-id="8b03a-123">**DateTime \_ GetMonthCal**</span><span class="sxs-lookup"><span data-stu-id="8b03a-123">**DateTime\_GetMonthCal**</span></span>](/windows/desktop/api/Commctrl/nf-commctrl-datetime_getmonthcal)                     | <span data-ttu-id="8b03a-124">取得日期和時間選擇器的 (DTP) 子月曆控制項的控制碼。</span><span class="sxs-lookup"><span data-stu-id="8b03a-124">Gets the handle to a date and time picker's (DTP) child month calendar control.</span></span> <span data-ttu-id="8b03a-125">您可以使用此宏，或明確地傳送 [**DTM \_ GETMONTHCAL**](dtm-getmonthcal.md) 訊息。</span><span class="sxs-lookup"><span data-stu-id="8b03a-125">You can use this macro or send the [**DTM\_GETMONTHCAL**](dtm-getmonthcal.md) message explicitly.</span></span> <br/>                                                                               |
| [<span data-ttu-id="8b03a-126">**DateTime \_ GetMonthCalColor**</span><span class="sxs-lookup"><span data-stu-id="8b03a-126">**DateTime\_GetMonthCalColor**</span></span>](/windows/desktop/api/Commctrl/nf-commctrl-datetime_getmonthcalcolor)           | <span data-ttu-id="8b03a-127">取得日期和時間選擇器中的月曆指定部分的色彩， (DTP) 控制項。</span><span class="sxs-lookup"><span data-stu-id="8b03a-127">Gets the color for a given portion of the month calendar within a date and time picker (DTP) control.</span></span> <span data-ttu-id="8b03a-128">您可以使用此宏，或明確地傳送 [**DTM \_ GETMCCOLOR**](dtm-getmccolor.md) 訊息。</span><span class="sxs-lookup"><span data-stu-id="8b03a-128">You can use this macro or send the [**DTM\_GETMCCOLOR**](dtm-getmccolor.md) message explicitly.</span></span> <br/>                                                           |
| [<span data-ttu-id="8b03a-129">**DateTime \_ GetMonthCalFont**</span><span class="sxs-lookup"><span data-stu-id="8b03a-129">**DateTime\_GetMonthCalFont**</span></span>](/windows/desktop/api/Commctrl/nf-commctrl-datetime_getmonthcalfont)             | <span data-ttu-id="8b03a-130">取得日期和時間選擇器 (DTP) 控制項的子月曆控制項目前使用的字型。</span><span class="sxs-lookup"><span data-stu-id="8b03a-130">Gets the font that the date and time picker (DTP) control's child month calendar control is currently using.</span></span> <span data-ttu-id="8b03a-131">您可以使用此宏，或明確地傳送 [**DTM \_ GETMCFONT**](dtm-getmcfont.md) 訊息。</span><span class="sxs-lookup"><span data-stu-id="8b03a-131">You can use this macro or send the [**DTM\_GETMCFONT**](dtm-getmcfont.md) message explicitly.</span></span> <br/>                                                      |
| [<span data-ttu-id="8b03a-132">**DateTime \_ GetMonthCalStyle**</span><span class="sxs-lookup"><span data-stu-id="8b03a-132">**DateTime\_GetMonthCalStyle**</span></span>](/windows/desktop/api/Commctrl/nf-commctrl-datetime_getmonthcalstyle)           | <span data-ttu-id="8b03a-133">取得指定之 DTP 控制項的樣式。</span><span class="sxs-lookup"><span data-stu-id="8b03a-133">Gets the style of a specified DTP control.</span></span> <span data-ttu-id="8b03a-134">使用這個宏或明確地傳送 [**DTM \_ GETMCSTYLE**](dtm-getmcstyle.md) 訊息。</span><span class="sxs-lookup"><span data-stu-id="8b03a-134">Use this macro or send the [**DTM\_GETMCSTYLE**](dtm-getmcstyle.md) message explicitly.</span></span><br/>                                                                                                                               |
| [<span data-ttu-id="8b03a-135">**DateTime \_ GetRange**</span><span class="sxs-lookup"><span data-stu-id="8b03a-135">**DateTime\_GetRange**</span></span>](/windows/desktop/api/Commctrl/nf-commctrl-datetime_getrange)                           | <span data-ttu-id="8b03a-136">取得日期和時間選擇器 (DTP) 控制項的最小和最大允許系統時間。</span><span class="sxs-lookup"><span data-stu-id="8b03a-136">Gets the current minimum and maximum allowable system times for a date and time picker (DTP) control.</span></span> <span data-ttu-id="8b03a-137">您可以使用這個宏，或明確地傳送 [**DTM \_ GETRANGE**](dtm-getrange.md) 訊息。</span><span class="sxs-lookup"><span data-stu-id="8b03a-137">You can use this macro, or send the [**DTM\_GETRANGE**](dtm-getrange.md) message explicitly.</span></span> <br/>                                                              |
| [<span data-ttu-id="8b03a-138">**DateTime \_ GetSystemtime**</span><span class="sxs-lookup"><span data-stu-id="8b03a-138">**DateTime\_GetSystemtime**</span></span>](/windows/desktop/api/Commctrl/nf-commctrl-datetime_getsystemtime)                 | <span data-ttu-id="8b03a-139">從日期和時間選擇器取得目前選取的時間 (DTP) 控制項，並將它放在指定的 [**SYSTEMTIME**](/windows/desktop/api/minwinbase/ns-minwinbase-systemtime) 結構中。</span><span class="sxs-lookup"><span data-stu-id="8b03a-139">Gets the currently selected time from a date and time picker (DTP) control and places it in a specified [**SYSTEMTIME**](/windows/desktop/api/minwinbase/ns-minwinbase-systemtime) structure.</span></span> <span data-ttu-id="8b03a-140">您可以使用這個宏，或明確地傳送 [**DTM \_ GETSYSTEMTIME**](dtm-getsystemtime.md) 訊息。</span><span class="sxs-lookup"><span data-stu-id="8b03a-140">You can use this macro, or send the [**DTM\_GETSYSTEMTIME**](dtm-getsystemtime.md) message explicitly.</span></span> <br/> |
| [<span data-ttu-id="8b03a-141">**DateTime \_ SetFormat**</span><span class="sxs-lookup"><span data-stu-id="8b03a-141">**DateTime\_SetFormat**</span></span>](/windows/desktop/api/Commctrl/nf-commctrl-datetime_setformat)                         | <span data-ttu-id="8b03a-142">根據指定的格式字串，設定日期和時間選擇器的顯示 (DTP) 控制項。</span><span class="sxs-lookup"><span data-stu-id="8b03a-142">Sets the display of a date and time picker (DTP) control based on a given format string.</span></span> <span data-ttu-id="8b03a-143">您可以使用此宏，或明確地傳送 [**DTM \_ SETFORMAT**](dtm-setformat.md) 訊息。</span><span class="sxs-lookup"><span data-stu-id="8b03a-143">You can use this macro or send the [**DTM\_SETFORMAT**](dtm-setformat.md) message explicitly.</span></span> <br/>                                                                          |
| [<span data-ttu-id="8b03a-144">**DateTime \_ SetMonthCalColor**</span><span class="sxs-lookup"><span data-stu-id="8b03a-144">**DateTime\_SetMonthCalColor**</span></span>](/windows/desktop/api/Commctrl/nf-commctrl-datetime_setmonthcalcolor)           | <span data-ttu-id="8b03a-145">在日期和時間選擇器中，設定日曆指定部分的色彩， (DTP) 控制項。</span><span class="sxs-lookup"><span data-stu-id="8b03a-145">Sets the color for a given portion of the month calendar within a date and time picker (DTP) control.</span></span> <span data-ttu-id="8b03a-146">您可以使用此宏，或明確地傳送 [**DTM \_ SETMCCOLOR**](dtm-setmccolor.md) 訊息。</span><span class="sxs-lookup"><span data-stu-id="8b03a-146">You can use this macro or send the [**DTM\_SETMCCOLOR**](dtm-setmccolor.md) message explicitly.</span></span> <br/>                                                           |
| [<span data-ttu-id="8b03a-147">**DateTime \_ SetMonthCalFont**</span><span class="sxs-lookup"><span data-stu-id="8b03a-147">**DateTime\_SetMonthCalFont**</span></span>](/windows/desktop/api/Commctrl/nf-commctrl-datetime_setmonthcalfont)             | <span data-ttu-id="8b03a-148">設定日期和時間選擇器 (DTP) 控制項的子月曆控制項所使用的字型。</span><span class="sxs-lookup"><span data-stu-id="8b03a-148">Sets the font to be used by the date and time picker (DTP) control's child month calendar control.</span></span> <span data-ttu-id="8b03a-149">您可以使用此宏或明確地傳送 [**DTM \_ SETMCFONT**](dtm-setmcfont.md) 訊息。</span><span class="sxs-lookup"><span data-stu-id="8b03a-149">You can use this macro or explicitly send the [**DTM\_SETMCFONT**](dtm-setmcfont.md) message.</span></span> <br/>                                                                |
| [<span data-ttu-id="8b03a-150">**DateTime \_ SetMonthCalStyle**</span><span class="sxs-lookup"><span data-stu-id="8b03a-150">**DateTime\_SetMonthCalStyle**</span></span>](/windows/desktop/api/Commctrl/nf-commctrl-datetime_setmonthcalstyle)           | <span data-ttu-id="8b03a-151">設定指定之 DTP 控制項的樣式。</span><span class="sxs-lookup"><span data-stu-id="8b03a-151">Sets the style for a specified DTP control.</span></span> <span data-ttu-id="8b03a-152">使用這個宏或明確地傳送 [**DTM \_ SETMCSTYLE**](dtm-setmcstyle.md) 訊息。</span><span class="sxs-lookup"><span data-stu-id="8b03a-152">Use this macro or send the [**DTM\_SETMCSTYLE**](dtm-setmcstyle.md) message explicitly.</span></span><br/>                                                                                                                              |
| [<span data-ttu-id="8b03a-153">**DateTime \_ SetRange**</span><span class="sxs-lookup"><span data-stu-id="8b03a-153">**DateTime\_SetRange**</span></span>](/windows/desktop/api/Commctrl/nf-commctrl-datetime_setrange)                           | <span data-ttu-id="8b03a-154">設定日期和時間選擇器 (DTP) 控制項的最小和最大允許系統時間。</span><span class="sxs-lookup"><span data-stu-id="8b03a-154">Sets the minimum and maximum allowable system times for a date and time picker (DTP) control.</span></span> <span data-ttu-id="8b03a-155">您可以使用這個宏，或明確地傳送 [**DTM \_ SETRANGE**](dtm-setrange.md) 訊息。</span><span class="sxs-lookup"><span data-stu-id="8b03a-155">You can use this macro or send the [**DTM\_SETRANGE**](dtm-setrange.md) message explicitly.</span></span> <br/>                                                                       |
| [<span data-ttu-id="8b03a-156">**DateTime \_ SetSystemtime**</span><span class="sxs-lookup"><span data-stu-id="8b03a-156">**DateTime\_SetSystemtime**</span></span>](/windows/desktop/api/Commctrl/nf-commctrl-datetime_setsystemtime)                 | <span data-ttu-id="8b03a-157">設定日期和時間選擇器 (DTP) 控制項設定為指定的日期和時間。</span><span class="sxs-lookup"><span data-stu-id="8b03a-157">Sets a date and time picker (DTP) control to a given date and time.</span></span> <span data-ttu-id="8b03a-158">您可以使用此宏，或明確地傳送 [**DTM \_ SETSYSTEMTIME**](dtm-setsystemtime.md) 訊息。</span><span class="sxs-lookup"><span data-stu-id="8b03a-158">You can use this macro or send the [**DTM\_SETSYSTEMTIME**](dtm-setsystemtime.md) message explicitly.</span></span> <br/>                                                                                       |



 

### <a name="messages"></a><span data-ttu-id="8b03a-159">訊息</span><span class="sxs-lookup"><span data-stu-id="8b03a-159">Messages</span></span>



| <span data-ttu-id="8b03a-160">主題</span><span class="sxs-lookup"><span data-stu-id="8b03a-160">Topic</span></span>                                                           | <span data-ttu-id="8b03a-161">目錄</span><span class="sxs-lookup"><span data-stu-id="8b03a-161">Contents</span></span>                                                                                                                                                                                                                                                                              |
|-----------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="8b03a-162">**DTM \_ CLOSEMONTHCAL**</span><span class="sxs-lookup"><span data-stu-id="8b03a-162">**DTM\_CLOSEMONTHCAL**</span></span>](dtm-closemonthcal.md)                 | <span data-ttu-id="8b03a-163">關閉 DTP 控制項。</span><span class="sxs-lookup"><span data-stu-id="8b03a-163">Closes a DTP control.</span></span> <span data-ttu-id="8b03a-164">請明確地傳送此訊息，或使用 [**DateTime \_ CloseMonthCal**](/windows/desktop/api/Commctrl/nf-commctrl-datetime_closemonthcal) 宏。</span><span class="sxs-lookup"><span data-stu-id="8b03a-164">Send this message explicitly or by using the [**DateTime\_CloseMonthCal**](/windows/desktop/api/Commctrl/nf-commctrl-datetime_closemonthcal) macro.</span></span><br/>                                                                                                                                        |
| [<span data-ttu-id="8b03a-165">**DTM \_ GETDATETIMEPICKERINFO**</span><span class="sxs-lookup"><span data-stu-id="8b03a-165">**DTM\_GETDATETIMEPICKERINFO**</span></span>](dtm-getdatetimepickerinfo.md) | <span data-ttu-id="8b03a-166">取得 (DTP) 控制項之日期和時間選擇器的資訊。</span><span class="sxs-lookup"><span data-stu-id="8b03a-166">Gets information on a date and time picker (DTP) control.</span></span><br/>                                                                                                                                                                                                                  |
| [<span data-ttu-id="8b03a-167">**DTM \_ GETIDEALSIZE**</span><span class="sxs-lookup"><span data-stu-id="8b03a-167">**DTM\_GETIDEALSIZE**</span></span>](dtm-getidealsize.md)                   | <span data-ttu-id="8b03a-168">取得在不剪切的情況下顯示控制項所需的大小。</span><span class="sxs-lookup"><span data-stu-id="8b03a-168">Gets the size needed to display the control without clipping.</span></span> <span data-ttu-id="8b03a-169">請明確地傳送此訊息，或使用 [**DateTime \_ GetIdealSize**](/windows/desktop/api/Commctrl/nf-commctrl-datetime_getidealsize) 宏。</span><span class="sxs-lookup"><span data-stu-id="8b03a-169">Send this message explicitly or by using the [**DateTime\_GetIdealSize**](/windows/desktop/api/Commctrl/nf-commctrl-datetime_getidealsize) macro.</span></span><br/>                                                                                                  |
| [<span data-ttu-id="8b03a-170">**DTM \_ GETMCCOLOR**</span><span class="sxs-lookup"><span data-stu-id="8b03a-170">**DTM\_GETMCCOLOR**</span></span>](dtm-getmccolor.md)                       | <span data-ttu-id="8b03a-171">取得日期和時間選擇器中的月曆指定部分的色彩， (DTP) 控制項。</span><span class="sxs-lookup"><span data-stu-id="8b03a-171">Gets the color for a given portion of the month calendar within a date and time picker (DTP) control.</span></span> <span data-ttu-id="8b03a-172">您可以明確地傳送此訊息，或使用 [**DateTime \_ GetMonthCalColor**](/windows/desktop/api/Commctrl/nf-commctrl-datetime_getmonthcalcolor) 宏。</span><span class="sxs-lookup"><span data-stu-id="8b03a-172">You can send this message explicitly or use the [**DateTime\_GetMonthCalColor**](/windows/desktop/api/Commctrl/nf-commctrl-datetime_getmonthcalcolor) macro.</span></span> <br/>                                              |
| [<span data-ttu-id="8b03a-173">**DTM \_ GETMCFONT**</span><span class="sxs-lookup"><span data-stu-id="8b03a-173">**DTM\_GETMCFONT**</span></span>](dtm-getmcfont.md)                         | <span data-ttu-id="8b03a-174">取得日期和時間選擇器 (DTP) 控制項的子月曆控制項目前使用的字型。</span><span class="sxs-lookup"><span data-stu-id="8b03a-174">Gets the font that the date and time picker (DTP) control's child month calendar control is currently using.</span></span> <span data-ttu-id="8b03a-175">您可以明確地傳送此訊息，或使用 [**DateTime \_ GetMonthCalFont**](/windows/desktop/api/Commctrl/nf-commctrl-datetime_getmonthcalfont) 宏。</span><span class="sxs-lookup"><span data-stu-id="8b03a-175">You can send this message explicitly or use the [**DateTime\_GetMonthCalFont**](/windows/desktop/api/Commctrl/nf-commctrl-datetime_getmonthcalfont) macro.</span></span> <br/>                                         |
| [<span data-ttu-id="8b03a-176">**DTM \_ GETMCSTYLE**</span><span class="sxs-lookup"><span data-stu-id="8b03a-176">**DTM\_GETMCSTYLE**</span></span>](dtm-getmcstyle.md)                       | <span data-ttu-id="8b03a-177">取得 DTP 控制項的樣式。</span><span class="sxs-lookup"><span data-stu-id="8b03a-177">Gets the style of a DTP control.</span></span> <span data-ttu-id="8b03a-178">請明確地傳送此訊息，或使用 [**DateTime \_ GetMonthCalStyle**](/windows/desktop/api/Commctrl/nf-commctrl-datetime_getmonthcalstyle) 宏。</span><span class="sxs-lookup"><span data-stu-id="8b03a-178">Send this message explicitly or by using the [**DateTime\_GetMonthCalStyle**](/windows/desktop/api/Commctrl/nf-commctrl-datetime_getmonthcalstyle) macro.</span></span><br/>                                                                                                                       |
| [<span data-ttu-id="8b03a-179">**DTM \_ GETMONTHCAL**</span><span class="sxs-lookup"><span data-stu-id="8b03a-179">**DTM\_GETMONTHCAL**</span></span>](dtm-getmonthcal.md)                     | <span data-ttu-id="8b03a-180">取得日期和時間選擇器的 (DTP) 子月曆控制項的控制碼。</span><span class="sxs-lookup"><span data-stu-id="8b03a-180">Gets the handle to a date and time picker's (DTP) child month calendar control.</span></span> <span data-ttu-id="8b03a-181">您可以明確地傳送此訊息，或使用 [**DateTime \_ GetMonthCal**](/windows/desktop/api/Commctrl/nf-commctrl-datetime_getmonthcal) 宏。</span><span class="sxs-lookup"><span data-stu-id="8b03a-181">You can send this message explicitly or use the [**DateTime\_GetMonthCal**](/windows/desktop/api/Commctrl/nf-commctrl-datetime_getmonthcal) macro.</span></span> <br/>                                                                              |
| [<span data-ttu-id="8b03a-182">**DTM \_ GETRANGE**</span><span class="sxs-lookup"><span data-stu-id="8b03a-182">**DTM\_GETRANGE**</span></span>](dtm-getrange.md)                           | <span data-ttu-id="8b03a-183">取得日期和時間選擇器 (DTP) 控制項的最小和最大允許系統時間。</span><span class="sxs-lookup"><span data-stu-id="8b03a-183">Gets the current minimum and maximum allowable system times for a date and time picker (DTP) control.</span></span> <span data-ttu-id="8b03a-184">您可以明確地傳送此訊息，或使用 [**DateTime \_ GetRange**](/windows/desktop/api/Commctrl/nf-commctrl-datetime_getrange) 宏。</span><span class="sxs-lookup"><span data-stu-id="8b03a-184">You can send this message explicitly or use the [**DateTime\_GetRange**](/windows/desktop/api/Commctrl/nf-commctrl-datetime_getrange) macro.</span></span> <br/>                                                              |
| [<span data-ttu-id="8b03a-185">**DTM \_ GETSYSTEMTIME**</span><span class="sxs-lookup"><span data-stu-id="8b03a-185">**DTM\_GETSYSTEMTIME**</span></span>](dtm-getsystemtime.md)                 | <span data-ttu-id="8b03a-186">從日期和時間選擇器取得目前選取的時間 (DTP) 控制項，並將它放在指定的 [**SYSTEMTIME**](/windows/desktop/api/minwinbase/ns-minwinbase-systemtime) 結構中。</span><span class="sxs-lookup"><span data-stu-id="8b03a-186">Gets the currently selected time from a date and time picker (DTP) control and places it in a specified [**SYSTEMTIME**](/windows/desktop/api/minwinbase/ns-minwinbase-systemtime) structure.</span></span> <span data-ttu-id="8b03a-187">您可以明確地傳送此訊息，或使用 [**DateTime \_ GetSystemtime**](/windows/desktop/api/Commctrl/nf-commctrl-datetime_getsystemtime) 宏。</span><span class="sxs-lookup"><span data-stu-id="8b03a-187">You can send this message explicitly or use the [**DateTime\_GetSystemtime**](/windows/desktop/api/Commctrl/nf-commctrl-datetime_getsystemtime) macro.</span></span> <br/> |
| [<span data-ttu-id="8b03a-188">**DTM \_ SETFORMAT**</span><span class="sxs-lookup"><span data-stu-id="8b03a-188">**DTM\_SETFORMAT**</span></span>](dtm-setformat.md)                         | <span data-ttu-id="8b03a-189">根據指定的格式字串，設定日期和時間選擇器的顯示 (DTP) 控制項。</span><span class="sxs-lookup"><span data-stu-id="8b03a-189">Sets the display of a date and time picker (DTP) control based on a given format string.</span></span> <span data-ttu-id="8b03a-190">您可以明確地傳送此訊息，或使用 [**DateTime \_ SetFormat**](/windows/desktop/api/Commctrl/nf-commctrl-datetime_setformat) 宏。</span><span class="sxs-lookup"><span data-stu-id="8b03a-190">You can send this message explicitly or use the [**DateTime\_SetFormat**](/windows/desktop/api/Commctrl/nf-commctrl-datetime_setformat) macro.</span></span> <br/>                                                                         |
| [<span data-ttu-id="8b03a-191">**DTM \_ SETMCCOLOR**</span><span class="sxs-lookup"><span data-stu-id="8b03a-191">**DTM\_SETMCCOLOR**</span></span>](dtm-setmccolor.md)                       | <span data-ttu-id="8b03a-192">在日期和時間選擇器中，設定日曆指定部分的色彩， (DTP) 控制項。</span><span class="sxs-lookup"><span data-stu-id="8b03a-192">Sets the color for a given portion of the month calendar within a date and time picker (DTP) control.</span></span> <span data-ttu-id="8b03a-193">您可以明確地傳送此訊息，或使用 [**DateTime \_ SetMonthCalColor**](/windows/desktop/api/Commctrl/nf-commctrl-datetime_setmonthcalcolor) 宏。</span><span class="sxs-lookup"><span data-stu-id="8b03a-193">You can send this message explicitly or use the [**DateTime\_SetMonthCalColor**](/windows/desktop/api/Commctrl/nf-commctrl-datetime_setmonthcalcolor) macro.</span></span> <br/>                                              |
| [<span data-ttu-id="8b03a-194">**DTM \_ SETMCFONT**</span><span class="sxs-lookup"><span data-stu-id="8b03a-194">**DTM\_SETMCFONT**</span></span>](dtm-setmcfont.md)                         | <span data-ttu-id="8b03a-195">設定日期和時間選擇器 (DTP) 控制項的子月曆控制項所使用的字型。</span><span class="sxs-lookup"><span data-stu-id="8b03a-195">Sets the font to be used by the date and time picker (DTP) control's child month calendar control.</span></span> <span data-ttu-id="8b03a-196">您可以明確地傳送此訊息，或使用 [**DateTime \_ SetMonthCalFont**](/windows/desktop/api/Commctrl/nf-commctrl-datetime_setmonthcalfont) 宏。</span><span class="sxs-lookup"><span data-stu-id="8b03a-196">You can send this message explicitly or use the [**DateTime\_SetMonthCalFont**](/windows/desktop/api/Commctrl/nf-commctrl-datetime_setmonthcalfont) macro.</span></span><br/>                                                    |
| [<span data-ttu-id="8b03a-197">**DTM \_ SETMCSTYLE**</span><span class="sxs-lookup"><span data-stu-id="8b03a-197">**DTM\_SETMCSTYLE**</span></span>](dtm-setmcstyle.md)                       | <span data-ttu-id="8b03a-198">設定 DTP 控制項的樣式。</span><span class="sxs-lookup"><span data-stu-id="8b03a-198">Sets the style of a DTP control.</span></span> <span data-ttu-id="8b03a-199">請明確地傳送此訊息，或使用 [**DateTime \_ SetMonthCalStyle**](/windows/desktop/api/Commctrl/nf-commctrl-datetime_setmonthcalstyle) 宏。</span><span class="sxs-lookup"><span data-stu-id="8b03a-199">Send this message explicitly or by using the [**DateTime\_SetMonthCalStyle**](/windows/desktop/api/Commctrl/nf-commctrl-datetime_setmonthcalstyle) macro.</span></span><br/>                                                                                                                       |
| [<span data-ttu-id="8b03a-200">**DTM \_ SETRANGE**</span><span class="sxs-lookup"><span data-stu-id="8b03a-200">**DTM\_SETRANGE**</span></span>](dtm-setrange.md)                           | <span data-ttu-id="8b03a-201">設定日期和時間選擇器 (DTP) 控制項的最小和最大允許系統時間。</span><span class="sxs-lookup"><span data-stu-id="8b03a-201">Sets the minimum and maximum allowable system times for a date and time picker (DTP) control.</span></span> <span data-ttu-id="8b03a-202">您可以明確地傳送此訊息，或使用 [**DateTime \_ SetRange**](/windows/desktop/api/Commctrl/nf-commctrl-datetime_setrange) 宏。</span><span class="sxs-lookup"><span data-stu-id="8b03a-202">You can send this message explicitly or use the [**DateTime\_SetRange**](/windows/desktop/api/Commctrl/nf-commctrl-datetime_setrange) macro.</span></span> <br/>                                                                      |
| [<span data-ttu-id="8b03a-203">**DTM \_ SETSYSTEMTIME**</span><span class="sxs-lookup"><span data-stu-id="8b03a-203">**DTM\_SETSYSTEMTIME**</span></span>](dtm-setsystemtime.md)                 | <span data-ttu-id="8b03a-204">設定日期和時間選擇器 (DTP) 控制項的時間。</span><span class="sxs-lookup"><span data-stu-id="8b03a-204">Sets the time in a date and time picker (DTP) control.</span></span> <span data-ttu-id="8b03a-205">您可以明確地傳送此訊息，或使用 [**DateTime \_ SetSystemtime**](/windows/desktop/api/Commctrl/nf-commctrl-datetime_setsystemtime) 宏。</span><span class="sxs-lookup"><span data-stu-id="8b03a-205">You can send this message explicitly or use the [**DateTime\_SetSystemtime**](/windows/desktop/api/Commctrl/nf-commctrl-datetime_setsystemtime) macro.</span></span> <br/>                                                                                                   |



 

### <a name="notifications"></a><span data-ttu-id="8b03a-206">通知</span><span class="sxs-lookup"><span data-stu-id="8b03a-206">Notifications</span></span>



| <span data-ttu-id="8b03a-207">主題</span><span class="sxs-lookup"><span data-stu-id="8b03a-207">Topic</span></span>                                                   | <span data-ttu-id="8b03a-208">目錄</span><span class="sxs-lookup"><span data-stu-id="8b03a-208">Contents</span></span>                                                                                                                                                                                                                                                                                                                                                     |
|---------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="8b03a-209">DTN \_ 特寫</span><span class="sxs-lookup"><span data-stu-id="8b03a-209">DTN\_CLOSEUP</span></span>](dtn-closeup.md)                         | <span data-ttu-id="8b03a-210">由日期和時間選擇器所傳送 (DTP) 控制使用者何時關閉下拉式月曆。</span><span class="sxs-lookup"><span data-stu-id="8b03a-210">Sent by a date and time picker (DTP) control when the user closes the drop-down month calendar.</span></span> <span data-ttu-id="8b03a-211">當使用者選擇月曆中的日期，或在行事曆開啟時按一下下拉箭號時，就會關閉月曆。</span><span class="sxs-lookup"><span data-stu-id="8b03a-211">The month calendar is closed when the user chooses a date from the month calendar or clicks the drop-down arrow while the calendar is open.</span></span> <br/>                                                                                                      |
| [<span data-ttu-id="8b03a-212">DTN \_ DATETIMECHANGE</span><span class="sxs-lookup"><span data-stu-id="8b03a-212">DTN\_DATETIMECHANGE</span></span>](dtn-datetimechange.md)           | <span data-ttu-id="8b03a-213">每次發生變更時，日期和時間選擇器都會傳送 (的 DTP) 控制。</span><span class="sxs-lookup"><span data-stu-id="8b03a-213">Sent by a date and time picker (DTP) control whenever a change occurs.</span></span> <span data-ttu-id="8b03a-214">此通知碼會以 [**WM \_ 通知**](wm-notify.md) 訊息的形式傳送。</span><span class="sxs-lookup"><span data-stu-id="8b03a-214">This notification code is sent in the form of a [**WM\_NOTIFY**](wm-notify.md) message.</span></span> <br/>                                                                                                                                                                                  |
| [<span data-ttu-id="8b03a-215">DTN \_ 下拉式清單</span><span class="sxs-lookup"><span data-stu-id="8b03a-215">DTN\_DROPDOWN</span></span>](dtn-dropdown.md)                       | <span data-ttu-id="8b03a-216">當使用者啟動下拉式月曆時，日期和時間選擇器會傳送 (DTP) 控制。</span><span class="sxs-lookup"><span data-stu-id="8b03a-216">Sent by a date and time picker (DTP) control when the user activates the drop-down month calendar.</span></span> <br/>                                                                                                                                                                                                                                               |
| [<span data-ttu-id="8b03a-217">DTN \_ 格式</span><span class="sxs-lookup"><span data-stu-id="8b03a-217">DTN\_FORMAT</span></span>](dtn-format.md)                           | <span data-ttu-id="8b03a-218">由日期和時間選擇器所傳送 (DTP) 控制項，要求在回呼欄位中顯示文字。</span><span class="sxs-lookup"><span data-stu-id="8b03a-218">Sent by a date and time picker (DTP) control to request text to be displayed in a callback field.</span></span> <span data-ttu-id="8b03a-219">此通知碼會以 [**WM \_ 通知**](wm-notify.md) 訊息的形式傳送。</span><span class="sxs-lookup"><span data-stu-id="8b03a-219">This notification code is sent in the form of a [**WM\_NOTIFY**](wm-notify.md) message.</span></span> <br/>                                                                                                                                                       |
| [<span data-ttu-id="8b03a-220">DTN \_ FORMATQUERY</span><span class="sxs-lookup"><span data-stu-id="8b03a-220">DTN\_FORMATQUERY</span></span>](dtn-formatquery.md)                 | <span data-ttu-id="8b03a-221">由日期和時間選擇器所傳送 (DTP) 控制項，以取得將顯示在回呼欄位中之字串的允許大小上限。</span><span class="sxs-lookup"><span data-stu-id="8b03a-221">Sent by a date and time picker (DTP) control to retrieve the maximum allowable size of the string that will be displayed in a callback field.</span></span> <span data-ttu-id="8b03a-222">此通知碼會以 [**WM \_ 通知**](wm-notify.md) 訊息的形式傳送。</span><span class="sxs-lookup"><span data-stu-id="8b03a-222">This notification code is sent in the form of a [**WM\_NOTIFY**](wm-notify.md) message.</span></span> <br/>                                                                                                           |
| [<span data-ttu-id="8b03a-223">DTN \_ USERSTRING</span><span class="sxs-lookup"><span data-stu-id="8b03a-223">DTN\_USERSTRING</span></span>](dtn-userstring.md)                   | <span data-ttu-id="8b03a-224">當使用者完成編輯控制項中的字串時，日期和時間選擇器會傳送 (DTP) 控制項。</span><span class="sxs-lookup"><span data-stu-id="8b03a-224">Sent by a date and time picker (DTP) control when a user finishes editing a string in the control.</span></span> <span data-ttu-id="8b03a-225">只有設定為 [**DTS \_ APPCANPARSE**](date-and-time-picker-control-styles.md) 樣式的 DTP 控制項才會傳送此通知碼。</span><span class="sxs-lookup"><span data-stu-id="8b03a-225">This notification code is only sent by DTP controls that are set to the [**DTS\_APPCANPARSE**](date-and-time-picker-control-styles.md) style.</span></span> <span data-ttu-id="8b03a-226">這則訊息會以 [**WM \_ 通知**](wm-notify.md) 訊息的形式傳送。</span><span class="sxs-lookup"><span data-stu-id="8b03a-226">This message is sent in the form of a [**WM\_NOTIFY**](wm-notify.md) message.</span></span> <br/> |
| [<span data-ttu-id="8b03a-227">DTN \_ WMKEYDOWN</span><span class="sxs-lookup"><span data-stu-id="8b03a-227">DTN\_WMKEYDOWN</span></span>](dtn-wmkeydown.md)                     | <span data-ttu-id="8b03a-228">當使用者在回呼欄位中輸入時，日期和時間選擇器會傳送 (DTP) 控制項。</span><span class="sxs-lookup"><span data-stu-id="8b03a-228">Sent by a date and time picker (DTP) control when the user types in a callback field.</span></span> <span data-ttu-id="8b03a-229">這則訊息會以 [**WM \_ 通知**](wm-notify.md) 訊息的形式傳送。</span><span class="sxs-lookup"><span data-stu-id="8b03a-229">This message is sent in the form of a [**WM\_NOTIFY**](wm-notify.md) message.</span></span> <br/>                                                                                                                                                                             |
| [<span data-ttu-id="8b03a-230">NM \_ KILLFOCUS (日期時間) </span><span class="sxs-lookup"><span data-stu-id="8b03a-230">NM\_KILLFOCUS (date time)</span></span>](nm-killfocus-date-time.md) | <span data-ttu-id="8b03a-231">通知日期和時間選擇器控制項的父視窗，表示控制項已遺失輸入焦點。</span><span class="sxs-lookup"><span data-stu-id="8b03a-231">Notifies a date and time picker control's parent window that the control has lost the input focus.</span></span> <span data-ttu-id="8b03a-232">[**NM \_KILLFOCUS (日期時間)**](nm-killfocus-date-time.md) 會以 [**WM \_ 通知**](wm-notify.md) 訊息的形式傳送。</span><span class="sxs-lookup"><span data-stu-id="8b03a-232">[**NM\_KILLFOCUS (date time)**](nm-killfocus-date-time.md) is sent in the form of a [**WM\_NOTIFY**](wm-notify.md) message.</span></span> <br/>                                                                                                                 |
| [<span data-ttu-id="8b03a-233">NM \_ SETFOCUS (日期時間) </span><span class="sxs-lookup"><span data-stu-id="8b03a-233">NM\_SETFOCUS (date time)</span></span>](nm-setfocus-date-time-.md)  | <span data-ttu-id="8b03a-234">通知日期和時間選擇器控制項的父視窗，控制項已收到輸入焦點。</span><span class="sxs-lookup"><span data-stu-id="8b03a-234">Notifies a date and time picker control's parent window that the control has received the input focus.</span></span> <span data-ttu-id="8b03a-235">[NM \_SETFOCUS (日期時間)](nm-setfocus-date-time-.md) 會以 [**WM \_ 通知**](wm-notify.md) 訊息的形式傳送。</span><span class="sxs-lookup"><span data-stu-id="8b03a-235">[NM\_SETFOCUS (date time)](nm-setfocus-date-time-.md) is sent in the form of a [**WM\_NOTIFY**](wm-notify.md) message.</span></span> <br/>                                                                                                                  |



 

### <a name="structures"></a><span data-ttu-id="8b03a-236">結構</span><span class="sxs-lookup"><span data-stu-id="8b03a-236">Structures</span></span>



| <span data-ttu-id="8b03a-237">主題</span><span class="sxs-lookup"><span data-stu-id="8b03a-237">Topic</span></span>                                                  | <span data-ttu-id="8b03a-238">目錄</span><span class="sxs-lookup"><span data-stu-id="8b03a-238">Contents</span></span>                                                                                                                                                                                                                                                                                                                                                                                           |
|--------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="8b03a-239">**DATETIMEPICKERINFO**</span><span class="sxs-lookup"><span data-stu-id="8b03a-239">**DATETIMEPICKERINFO**</span></span>](/windows/win32/api/commctrl/ns-commctrl-datetimepickerinfo)       | <span data-ttu-id="8b03a-240">包含有關 DTP 控制項的資訊。</span><span class="sxs-lookup"><span data-stu-id="8b03a-240">Contains information about a DTP control.</span></span> <br/>                                                                                                                                                                                                                                                                                                                                              |
| [<span data-ttu-id="8b03a-241">**NMDATETIMECHANGE**</span><span class="sxs-lookup"><span data-stu-id="8b03a-241">**NMDATETIMECHANGE**</span></span>](/windows/win32/api/commctrl/ns-commctrl-nmdatetimechange)           | <span data-ttu-id="8b03a-242">包含在日期和時間選擇器中發生之變更的相關資訊 (DTP) 控制項。</span><span class="sxs-lookup"><span data-stu-id="8b03a-242">Contains information about a change that has taken place in a date and time picker (DTP) control.</span></span> <span data-ttu-id="8b03a-243">此結構會與 [DTN \_ DATETIMECHANGE](dtn-datetimechange.md) 通知程式碼搭配使用。</span><span class="sxs-lookup"><span data-stu-id="8b03a-243">This structure is used with the [DTN\_DATETIMECHANGE](dtn-datetimechange.md) notification code.</span></span> <br/>                                                                                                                                                                                     |
| [<span data-ttu-id="8b03a-244">**NMDATETIMEFORMAT**</span><span class="sxs-lookup"><span data-stu-id="8b03a-244">**NMDATETIMEFORMAT**</span></span>](/windows/win32/api/commctrl/ns-commctrl-nmdatetimeformata)           | <span data-ttu-id="8b03a-245">包含部分格式字串的相關資訊，此字串會定義日期和時間選擇器中的回呼欄位， (DTP) 控制項。</span><span class="sxs-lookup"><span data-stu-id="8b03a-245">Contains information about a portion of the format string that defines a callback field within a date and time picker (DTP) control.</span></span> <span data-ttu-id="8b03a-246">它會攜帶定義回呼欄位的子字串，並包含緩衝區來接收將顯示在回呼欄位中的字串。</span><span class="sxs-lookup"><span data-stu-id="8b03a-246">It carries the substring that defines the callback field and contains a buffer to receive the string that will be displayed in the callback field.</span></span> <span data-ttu-id="8b03a-247">此結構會搭配 [DTN \_ 格式](dtn-format.md) 通知碼使用。</span><span class="sxs-lookup"><span data-stu-id="8b03a-247">This structure is used with the [DTN\_FORMAT](dtn-format.md) notification code.</span></span> <br/>               |
| [<span data-ttu-id="8b03a-248">**NMDATETIMEFORMATQUERY**</span><span class="sxs-lookup"><span data-stu-id="8b03a-248">**NMDATETIMEFORMATQUERY**</span></span>](/windows/win32/api/commctrl/ns-commctrl-nmdatetimeformatquerya) | <span data-ttu-id="8b03a-249">包含日期和時間選擇器 (DTP) 控制項回呼欄位的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="8b03a-249">Contains information about a date and time picker (DTP) control callback field.</span></span> <span data-ttu-id="8b03a-250">它包含的子字串 (取自訂回呼欄位的控制項格式字串) 。</span><span class="sxs-lookup"><span data-stu-id="8b03a-250">It contains a substring (taken from the control's format string) that defines a callback field.</span></span> <span data-ttu-id="8b03a-251">結構會接收將在回呼欄位中顯示之文字的允許大小上限。</span><span class="sxs-lookup"><span data-stu-id="8b03a-251">The structure receives the maximum allowable size of the text that will be displayed in the callback field.</span></span> <span data-ttu-id="8b03a-252">此結構會與 [DTN \_ FORMATQUERY](dtn-formatquery.md) 通知程式碼搭配使用。</span><span class="sxs-lookup"><span data-stu-id="8b03a-252">This structure is used with the [DTN\_FORMATQUERY](dtn-formatquery.md) notification code.</span></span> <br/> |
| [<span data-ttu-id="8b03a-253">**NMDATETIMESTRING**</span><span class="sxs-lookup"><span data-stu-id="8b03a-253">**NMDATETIMESTRING**</span></span>](/windows/win32/api/commctrl/ns-commctrl-nmdatetimestringa)           | <span data-ttu-id="8b03a-254">包含在日期和時間選擇器中進行的編輯作業的特定資訊 (DTP) 控制項。</span><span class="sxs-lookup"><span data-stu-id="8b03a-254">Contains information specific to an edit operation that has taken place in a date and time picker (DTP) control.</span></span> <span data-ttu-id="8b03a-255">此訊息可搭配 [DTN \_ USERSTRING](dtn-userstring.md) 通知碼使用。</span><span class="sxs-lookup"><span data-stu-id="8b03a-255">This message is used with the [DTN\_USERSTRING](dtn-userstring.md) notification code.</span></span> <br/>                                                                                                                                                                                |
| [<span data-ttu-id="8b03a-256">**NMDATETIMEWMKEYDOWN**</span><span class="sxs-lookup"><span data-stu-id="8b03a-256">**NMDATETIMEWMKEYDOWN**</span></span>](/windows/win32/api/commctrl/ns-commctrl-nmdatetimewmkeydowna)     | <span data-ttu-id="8b03a-257">攜帶用來描述和處理 [DTN \_ WMKEYDOWN](dtn-wmkeydown.md) 通知碼的資訊。</span><span class="sxs-lookup"><span data-stu-id="8b03a-257">Carries information used to describe and handle a [DTN\_WMKEYDOWN](dtn-wmkeydown.md) notification code.</span></span> <br/>                                                                                                                                                                                                                                                                               |



 

### <a name="constants"></a><span data-ttu-id="8b03a-258">常數</span><span class="sxs-lookup"><span data-stu-id="8b03a-258">Constants</span></span>



| <span data-ttu-id="8b03a-259">主題</span><span class="sxs-lookup"><span data-stu-id="8b03a-259">Topic</span></span>                                                                          | <span data-ttu-id="8b03a-260">目錄</span><span class="sxs-lookup"><span data-stu-id="8b03a-260">Contents</span></span>                                                                                |
|--------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------|
| [<span data-ttu-id="8b03a-261">日期和時間選擇器控制項樣式</span><span class="sxs-lookup"><span data-stu-id="8b03a-261">Date and Time Picker Control Styles</span></span>](date-and-time-picker-control-styles.md) | <span data-ttu-id="8b03a-262">此處所列的視窗樣式是日期和時間選擇器控制項特有的樣式。</span><span class="sxs-lookup"><span data-stu-id="8b03a-262">The window styles listed here are specific to date and time picker controls.</span></span><br/> |



 

 

