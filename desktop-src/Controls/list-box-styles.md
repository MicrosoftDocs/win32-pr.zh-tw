---
title: '清單方塊樣式 (Winuser .h) '
description: 若要使用 CreateWindow 或 CreateWindowEx 函式建立清單方塊，請使用 LISTBOX 類別、適當的視窗樣式常數，以及下列樣式常數來定義清單方塊。
ms.assetid: bbf430f1-cdc1-4f87-b296-acf74cc6fc1b
topic_type:
- apiref
api_name:
- LBS_COMBOBOX
- LBS_DISABLENOSCROLL
- LBS_EXTENDEDSEL
- LBS_HASSTRINGS
- LBS_MULTICOLUMN
- LBS_MULTIPLESEL
- LBS_NODATA
- LBS_NOINTEGRALHEIGHT
- LBS_NOREDRAW
- LBS_NOSEL
- LBS_NOTIFY
- LBS_OWNERDRAWFIXED
- LBS_OWNERDRAWVARIABLE
- LBS_SORT
- LBS_STANDARD
- LBS_USETABSTOPS
- LBS_WANTKEYBOARDINPUT
api_location:
- Winuser.h
api_type:
- HeaderDef
ms.topic: reference
ms.date: 05/31/2018
ms.openlocfilehash: 26d453f32a225718f94690f42266fffc7c03cc13
ms.sourcegitcommit: c8ec1ded1ffffc364d3c4f560bb2171da0dc5040
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 03/22/2021
ms.locfileid: "106989808"
---
# <a name="list-box-styles"></a>清單方塊樣式

若要使用 [**CreateWindow**](/windows/desktop/api/winuser/nf-winuser-createwindowa) 或 [**CreateWindowEx**](/windows/desktop/api/winuser/nf-winuser-createwindowexa) 函式建立清單方塊，請使用 LISTBOX 類別、適當的視窗樣式常數，以及下列樣式常數來定義清單方塊。 建立控制項之後，除非有注明，否則無法修改這些樣式。



| 常數                                                                                                                                                                              | 描述                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|:--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span id="LBS_COMBOBOX"></span><span id="lbs_combobox"></span><dl> <dt>**磅 \_ COMBOBOX**</dt> </dl>                            | 通知清單框其為下拉式方塊的一部分。 這可讓兩個控制項之間進行協調，使其呈現統一的 UI。 下拉式列示方塊本身必須設定這個樣式。 如果樣式是由下拉式方塊以外的任何一個設定，清單方塊將會錯誤地視為下拉式方塊的子系，而導致失敗。<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| <span id="LBS_DISABLENOSCROLL"></span><span id="lbs_disablenoscroll"></span><dl> <dt>**磅 \_ DISABLENOSCROLL**</dt> </dl>       | 顯示已停用的水準或垂直捲動條（當清單方塊未包含足夠的專案可滾動時）。 如果您未指定此樣式，當清單方塊未包含足夠的專案時，就會隱藏捲軸。 此樣式必須與 [**ws \_ VSCROLL**](/windows/desktop/winmsg/window-styles) 或 [**ws \_ HSCROLL**](/windows/desktop/winmsg/window-styles) 樣式搭配使用。<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| <span id="LBS_EXTENDEDSEL"></span><span id="lbs_extendedsel"></span><dl> <dt>**磅 \_ EXTENDEDSEL**</dt> </dl>                   | 允許使用 SHIFT 鍵和滑鼠或特殊按鍵組合來選取多個專案。<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| <span id="LBS_HASSTRINGS"></span><span id="lbs_hasstrings"></span><dl> <dt>**磅 \_ HASSTRINGS**</dt> </dl>                      | 指定清單方塊包含字串所組成的專案。 清單方塊會維護字串的記憶體和位址，讓應用程式可以使用 [**LB \_ GETTEXT**](lb-gettext.md) 訊息來取得特定專案的文字。 依預設，擁有者繪製清單方塊以外的所有清單方塊都有此樣式。 您可以使用或不使用此樣式來建立主控描繪清單方塊。<br/> 針對沒有此樣式的主控描繪清單方塊， [**LB \_ GETTEXT**](lb-gettext.md) 訊息會抓取與專案資料)  (專案相關聯的值。 <br/>                                                                                                                                                                                                                                                                                                                                    |
| <span id="LBS_MULTICOLUMN"></span><span id="lbs_multicolumn"></span><dl> <dt>**磅的多重 \_ 列**</dt> </dl>                   | 指定水準滾動的多欄清單方塊。 清單方塊會自動計算資料行的寬度，或應用程式可以使用 [**LB \_ SETCOLUMNWIDTH**](lb-setcolumnwidth.md) 訊息來設定寬度。 如果清單方塊具有 **磅 \_ OWNERDRAWFIXED** 樣式，則應用程式可以在清單方塊傳送 [**WM \_ MEASUREITEM**](wm-measureitem.md) 訊息時設定寬度。 <br/> 具有 **磅多重 \_ 列** 樣式的清單方塊無法以垂直方式滾動，它會忽略它所收到的任何 [**WM \_ VSCROLL**](wm-vscroll.md) 訊息。 <br/> 無法 **合併 \_ 磅** 的多欄和 **磅 \_ OWNERDRAWVARIABLE** 樣式。 如果同時指定這兩者，則會忽略 **磅 \_ OWNERDRAWVARIABLE** 。<br/>                                                                                                                                                                                |
| <span id="LBS_MULTIPLESEL"></span><span id="lbs_multiplesel"></span><dl> <dt>**磅 \_ MULTIPLESEL**</dt> </dl>                   | 每次使用者按一下或按兩下清單方塊中的字串時，開啟或關閉字串選取專案。 使用者可以選取任意數目的字串。<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| <span id="LBS_NODATA"></span><span id="lbs_nodata"></span><dl> <dt>**磅 \_ NODATA**</dt> </dl>                                  | 指定 [無資料] 清單方塊。 當清單方塊的項目計數會超過一千時，請指定此樣式。 [無資料] 清單方塊也必須有 **磅 \_ OWNERDRAWFIXED** 樣式，但不能有磅的 **\_ 排序** 或 **磅 \_ HASSTRINGS** 樣式。 <br/> 無資料清單方塊類似於主控描繪清單方塊，但它的項目不包含字串或點陣圖資料。 新增、插入或刪除專案的命令一律會忽略任何指定的專案資料;在清單方塊中尋找字串的要求一律會失敗。 當必須繪製專案時，系統會將 [**WM \_ DRAWITEM**](wm-drawitem.md) 訊息傳送給擁有者視窗。 以 **WM \_ DRAWITEM** 訊息傳遞的 [**DRAWITEMSTRUCT**](/windows/win32/api/winuser/ns-winuser-drawitemstruct)結構的 **itemID** 成員，指定要繪製之專案的行號。 [無資料] 清單方塊不會傳送 [**WM \_ DELETEITEM**](wm-deleteitem.md) 訊息。<br/> |
| <span id="LBS_NOINTEGRALHEIGHT"></span><span id="lbs_nointegralheight"></span><dl> <dt>**磅 \_ NOINTEGRALHEIGHT**</dt> </dl>    | 指定清單方塊的大小正好是應用程式在建立清單方塊時所指定的大小。 一般來說，系統會調整清單方塊的大小，讓清單方塊不會顯示部分專案。<br/> 對於具有 **磅 \_ OWNERDRAWVARIABLE** 樣式的清單方塊，一律會強制執行 **磅 \_ NOINTEGRALHEIGHT** 樣式。<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| <span id="LBS_NOREDRAW"></span><span id="lbs_noredraw"></span><dl> <dt>**磅 \_ NOREDRAW**</dt> </dl>                            | 指定當進行變更時，不會更新清單方塊的外觀。<br/> 若要變更控制項的重繪狀態，請使用 [**WM \_ SETREDRAW**](/windows/desktop/gdi/wm-setredraw) 訊息。<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| <span id="LBS_NOSEL"></span><span id="lbs_nosel"></span><dl> <dt>**磅 \_ NOSEL**</dt> </dl>                                     | 指定清單方塊包含可查看但未選取的專案。 <br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| <span id="LBS_NOTIFY"></span><span id="lbs_notify"></span><dl> <dt>**磅 \_ 通知**</dt> </dl>                                  | 當使用者按一下清單方塊專案 ([LBN \_ SELCHANGE](lbn-selchange.md)) 、按兩下 ([LBN \_ DBLCLK](lbn-dblclk.md)) 的專案，或取消選取專案 ([LBN \_ SELCANCEL](lbn-selcancel.md)) 時，此清單方塊就會傳送通知碼至父視窗。 <br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| <span id="LBS_OWNERDRAWFIXED"></span><span id="lbs_ownerdrawfixed"></span><dl> <dt>**磅 \_ OWNERDRAWFIXED**</dt> </dl>          | 指定清單方塊的擁有者會負責繪製其內容，而且清單方塊中的專案具有相同的高度。 當清單方塊建立時，擁有者視窗會收到 [**wm \_ MEASUREITEM**](wm-measureitem.md) 訊息，而當清單方塊的視覺外觀變更時，則會收到 [**wm \_ DRAWITEM**](wm-drawitem.md) 訊息。<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| <span id="LBS_OWNERDRAWVARIABLE"></span><span id="lbs_ownerdrawvariable"></span><dl> <dt>**磅 \_ OWNERDRAWVARIABLE**</dt> </dl> | 指定清單方塊的擁有者會負責繪製其內容，而且清單方塊中的專案會高度為變數。 當清單方塊建立時，擁有者視窗會針對方塊中的每個專案接收一個 [**wm \_ MEASUREITEM**](wm-measureitem.md) 訊息，而當清單方塊的視覺外觀變更時，會收到 [**wm \_ DRAWITEM**](wm-drawitem.md) 訊息。<br/> 此樣式會啟用 **磅 \_ NOINTEGRALHEIGHT** 樣式。<br/> 如果指定了磅的多重 **\_ 列** 樣式，則會忽略這個樣式。 <br/>                                                                                                                                                                                                                                                                                                                                                                  |
| <span id="LBS_SORT"></span><span id="lbs_sort"></span><dl> <dt>**磅 \_ 排序**</dt> </dl>                                        | 依字母順序排序清單方塊中的字串。<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| <span id="LBS_STANDARD"></span><span id="lbs_standard"></span><dl> <dt>**磅 \_ 標準**</dt> </dl>                            | 依字母順序排序清單方塊中的字串。 當使用者按一下清單方塊專案、按兩下專案或取消選取專案時，父視窗就會收到通知碼。 清單方塊具有垂直捲動條，且在所有側邊都有框線。 此樣式結合了 **磅的 \_ 通知**、 **磅 \_ 排序**、 [**ws \_ VSCROLL**](/windows/desktop/winmsg/window-styles)和 [**ws \_ 框線**](/windows/desktop/winmsg/window-styles) 樣式。<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| <span id="LBS_USETABSTOPS"></span><span id="lbs_usetabstops"></span><dl> <dt>**磅 \_ USETABSTOPS**</dt> </dl>                   | 讓清單方塊在繪製其字串時辨識和展開定位字元。 您可以使用 [**LB \_ SETTABSTOPS**](lb-settabstops.md) 訊息來指定制表位位置。 預設的索引標籤位置是 [32] 對話方塊範本單位。 對話方塊範本單位是對話方塊範本中使用的裝置獨立單位。 若要將度量從對話方塊範本單位轉換為螢幕單位 (圖元) ，請使用 [**MapDialogRect**](/windows/desktop/api/winuser/nf-winuser-mapdialogrect) 函數。<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| <span id="LBS_WANTKEYBOARDINPUT"></span><span id="lbs_wantkeyboardinput"></span><dl> <dt>**磅 \_ WANTKEYBOARDINPUT**</dt> </dl> | 指定清單方塊的擁有者每次使用者按下按鍵，且清單方塊具有輸入焦點時，就會收到 [**WM \_ VKEYTOITEM**](wm-vkeytoitem.md) 訊息。 這可讓應用程式執行鍵盤輸入的特殊處理。<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |



## <a name="requirements"></a>規格需求



| 需求 | 值 |
|-------------------|--------------------------------------------------------------------------------------|
| 標頭<br/> | <dl> <dt>Winuser。h</dt> </dl> |



 

