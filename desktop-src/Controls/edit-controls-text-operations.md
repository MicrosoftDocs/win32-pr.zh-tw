---
title: 編輯控制項文字作業
description: 系統會自動處理所有使用者起始的文字作業，並在作業完成時通知應用程式。
ms.assetid: 9af3a1bc-4c87-4cc9-966d-50742be7c811
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 9640616cf70b9a2933ef9d4c3fdb2accbfdcabf0
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/21/2020
ms.locfileid: "104024155"
---
# <a name="edit-control-text-operations"></a><span data-ttu-id="c1ea3-103">編輯控制項文字作業</span><span class="sxs-lookup"><span data-stu-id="c1ea3-103">Edit Control Text Operations</span></span>

<span data-ttu-id="c1ea3-104">系統會自動處理所有使用者起始的文字作業，並在作業完成時通知應用程式。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-104">The system automatically processes all user-initiated text operations and notifies the application when the operations are completed.</span></span>

<span data-ttu-id="c1ea3-105">下列主題將討論使用者起始的文字操作和應用程式的回應：</span><span class="sxs-lookup"><span data-stu-id="c1ea3-105">The following topics discuss user-initiated text operations and the application's response:</span></span>

-   [<span data-ttu-id="c1ea3-106">選取編輯控制項</span><span class="sxs-lookup"><span data-stu-id="c1ea3-106">Selecting an Edit Control</span></span>](#selecting-an-edit-control)
-   [<span data-ttu-id="c1ea3-107">設定和取出文字</span><span class="sxs-lookup"><span data-stu-id="c1ea3-107">Setting and Retrieving Text</span></span>](#setting-and-retrieving-text)
-   [<span data-ttu-id="c1ea3-108">選取文字</span><span class="sxs-lookup"><span data-stu-id="c1ea3-108">Selecting Text</span></span>](#selecting-text)
-   [<span data-ttu-id="c1ea3-109">取代文字</span><span class="sxs-lookup"><span data-stu-id="c1ea3-109">Replacing Text</span></span>](#replacing-text)
-   [<span data-ttu-id="c1ea3-110">變更編輯控制項所使用的字型</span><span class="sxs-lookup"><span data-stu-id="c1ea3-110">Changing the Font Used by an Edit Control</span></span>](#changing-the-font-used-by-an-edit-control)
-   [<span data-ttu-id="c1ea3-111">剪下複製貼上和清除作業</span><span class="sxs-lookup"><span data-stu-id="c1ea3-111">Cut Copy Paste and Clear Operations</span></span>](#cut-copy-paste-and-clear-operations)
-   [<span data-ttu-id="c1ea3-112">修改文字</span><span class="sxs-lookup"><span data-stu-id="c1ea3-112">Modifying Text</span></span>](#modifying-text)
-   [<span data-ttu-id="c1ea3-113">限制使用者輸入的文字</span><span class="sxs-lookup"><span data-stu-id="c1ea3-113">Limiting User Entered Text</span></span>](#limiting-user-entered-text)
-   [<span data-ttu-id="c1ea3-114">字元和行作業</span><span class="sxs-lookup"><span data-stu-id="c1ea3-114">Character and Line Operations</span></span>](#character-and-line-operations)
-   [<span data-ttu-id="c1ea3-115">在編輯控制項中滾動文字</span><span class="sxs-lookup"><span data-stu-id="c1ea3-115">Scrolling Text in an Edit Control</span></span>](#scrolling-text-in-an-edit-control)
-   [<span data-ttu-id="c1ea3-116">設定制表位和邊界</span><span class="sxs-lookup"><span data-stu-id="c1ea3-116">Setting Tab Stops and Margins</span></span>](#setting-tab-stops-and-margins)
-   [<span data-ttu-id="c1ea3-117">隱藏使用者輸入</span><span class="sxs-lookup"><span data-stu-id="c1ea3-117">Concealing User Input</span></span>](#concealing-user-input)
-   [<span data-ttu-id="c1ea3-118">使用整數</span><span class="sxs-lookup"><span data-stu-id="c1ea3-118">Using Integers</span></span>](#using-integers)
-   [<span data-ttu-id="c1ea3-119">復原文字作業</span><span class="sxs-lookup"><span data-stu-id="c1ea3-119">Undoing Text Operations</span></span>](#undoing-text-operations)
-   [<span data-ttu-id="c1ea3-120">處理 Wordwrap 和換行</span><span class="sxs-lookup"><span data-stu-id="c1ea3-120">Handling Wordwrap and Line Breaks</span></span>](#handling-wordwrap-and-line-breaks)
-   [<span data-ttu-id="c1ea3-121">取出點和字元</span><span class="sxs-lookup"><span data-stu-id="c1ea3-121">Retrieving Points and Characters</span></span>](#retrieving-points-and-characters)
-   [<span data-ttu-id="c1ea3-122">自動完成字串</span><span class="sxs-lookup"><span data-stu-id="c1ea3-122">Autocompletion of Strings</span></span>](#autocompletion-of-strings)
-   [<span data-ttu-id="c1ea3-123">編輯控制項中的複雜字集</span><span class="sxs-lookup"><span data-stu-id="c1ea3-123">Complex Script in Edit Controls</span></span>](#complex-script-in-edit-controls)

## <a name="selecting-an-edit-control"></a><span data-ttu-id="c1ea3-124">選取編輯控制項</span><span class="sxs-lookup"><span data-stu-id="c1ea3-124">Selecting an Edit Control</span></span>

<span data-ttu-id="c1ea3-125">使用者可以選取編輯控制項，方法是按一下滑鼠或按下 TAB 鍵移至該控制項。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-125">The user can select an edit control by clicking it with the mouse or by pressing the TAB key to move to it.</span></span> <span data-ttu-id="c1ea3-126">Tab 鍵方法是系統所提供的預先定義鍵盤介面的一部分。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-126">The tabbing method is part of a predefined keyboard interface that the system provides.</span></span> <span data-ttu-id="c1ea3-127">如需此介面的完整描述，請參閱 [對話方塊](/windows/desktop/dlgbox/dialog-boxes)。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-127">For a complete description of this interface, see [Dialog Boxes](/windows/desktop/dlgbox/dialog-boxes).</span></span> <span data-ttu-id="c1ea3-128">當使用者選取編輯控制項時，系統會將鍵盤焦點提供給控制項， (在) [鍵盤輸入](/windows/desktop/inputdev/about-keyboard-input) 中看到「鍵盤焦點和啟用」，並使用反向影片來反白顯示其文字。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-128">When the user selects an edit control, the system gives the control the keyboard focus (see "Keyboard Focus and Activation" in [About Keyboard Input](/windows/desktop/inputdev/about-keyboard-input)) and highlights its text by using reverse video.</span></span>

## <a name="setting-and-retrieving-text"></a><span data-ttu-id="c1ea3-129">設定和取出文字</span><span class="sxs-lookup"><span data-stu-id="c1ea3-129">Setting and Retrieving Text</span></span>

<span data-ttu-id="c1ea3-130">應用程式可以使用 [**SetWindowText**](/windows/desktop/api/winuser/nf-winuser-setwindowtexta) 函式、 [**SetDlgItemText**](/windows/desktop/DevNotes/-setdlgitemtext) 函式，或將控制項傳送至 [**WM \_ SETTEXT**](/windows/desktop/winmsg/wm-settext) 訊息，來設定編輯控制項的文字。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-130">An application can set the text of an edit control by using the [**SetWindowText**](/windows/desktop/api/winuser/nf-winuser-setwindowtexta) function, the [**SetDlgItemText**](/windows/desktop/DevNotes/-setdlgitemtext) function, or by sending the control a [**WM\_SETTEXT**](/windows/desktop/winmsg/wm-settext) message.</span></span>

<span data-ttu-id="c1ea3-131">若要從編輯控制項取出所有文字，請先使用 [**GetWindowTextLength**](/windows/desktop/api/winuser/nf-winuser-getwindowtextlengtha) 函式或 [**WM \_ GETTEXTLENGTH**](/windows/desktop/winmsg/wm-gettextlength) 訊息來判斷包含文字所需的緩衝區大小。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-131">To retrieve all text from an edit control, first use the [**GetWindowTextLength**](/windows/desktop/api/winuser/nf-winuser-getwindowtextlengtha) function or the [**WM\_GETTEXTLENGTH**](/windows/desktop/winmsg/wm-gettextlength) message to determine the size of buffer needed to contain the text.</span></span> <span data-ttu-id="c1ea3-132">接下來，使用 [**GetWindowText**](/windows/desktop/DevNotes/-getwindowtext) 函式、 [**GetDlgItemText**](/windows/desktop/api/winuser/nf-winuser-getdlgitemtexta) 函式或 [**WM \_ GETTEXT**](/windows/desktop/winmsg/wm-gettext) 訊息來取得文字。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-132">Next, retrieve the text by using the [**GetWindowText**](/windows/desktop/DevNotes/-getwindowtext) function, the [**GetDlgItemText**](/windows/desktop/api/winuser/nf-winuser-getdlgitemtexta) function, or the [**WM\_GETTEXT**](/windows/desktop/winmsg/wm-gettext) message.</span></span>

## <a name="selecting-text"></a><span data-ttu-id="c1ea3-133">選取文字</span><span class="sxs-lookup"><span data-stu-id="c1ea3-133">Selecting Text</span></span>

<span data-ttu-id="c1ea3-134">選取編輯控制項之後，使用者就可以使用滑鼠或鍵盤選取控制項中的文字。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-134">After selecting an edit control, the user can select text in the control by using the mouse or the keyboard.</span></span> <span data-ttu-id="c1ea3-135">應用程式可以藉由傳送 [**EM \_ GETSEL**](em-getsel.md) 訊息給控制項，來取出編輯控制項中目前選取範圍的開始和結束字元位置。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-135">An application can retrieve the starting and ending character positions of the current selection in an edit control by sending the control an [**EM\_GETSEL**](em-getsel.md) message.</span></span> <span data-ttu-id="c1ea3-136">結束位置的傳回值會大於選取範圍中的最後一個字元 (也就是最後一個選取的字元) 之後第一個字元的位置。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-136">The return value for the ending position is one greater than the last character in the selection (that is, the position of the first character following the last selected character).</span></span>

<span data-ttu-id="c1ea3-137">應用程式也可以在編輯控制項中選取文字，方法是使用選取範圍的開頭和結尾字元索引來傳送 [**EM \_ SETSEL**](em-setsel.md) 訊息給控制項。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-137">An application can also select text in an edit control by sending the control an [**EM\_SETSEL**](em-setsel.md) message with the starting and ending character indexes for the selection.</span></span> <span data-ttu-id="c1ea3-138">例如，應用程式可以使用 **em \_ SETSEL** 搭配 [**em \_ REPLACESEL**](em-replacesel.md) 來刪除編輯控制項中的文字。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-138">For example, the application can use **EM\_SETSEL** with [**EM\_REPLACESEL**](em-replacesel.md) to delete text from an edit control.</span></span>

<span data-ttu-id="c1ea3-139">這三個訊息適用于單行和多行編輯控制項。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-139">These three messages apply to both single-line and multiline edit controls.</span></span>

## <a name="replacing-text"></a><span data-ttu-id="c1ea3-140">取代文字</span><span class="sxs-lookup"><span data-stu-id="c1ea3-140">Replacing Text</span></span>

<span data-ttu-id="c1ea3-141">應用程式可以在編輯控制項中取代選取的文字，方法是將具有取代文字指標的 [**EM \_ REPLACESEL**](em-replacesel.md) 訊息傳送給控制項。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-141">An application can replace selected text in an edit control by sending the control an [**EM\_REPLACESEL**](em-replacesel.md) message with a pointer to the replacement text.</span></span> <span data-ttu-id="c1ea3-142">如果沒有目前的選取範圍， **EM \_ REPLACESEL** 會在插入點插入取代文字。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-142">If there is no current selection, **EM\_REPLACESEL** inserts the replacement text at the insertion point.</span></span> <span data-ttu-id="c1ea3-143">如果取代文字超過可用的記憶體，應用程式可能會收到 [EN \_ ERRSPACE](en-errspace.md) 通知碼。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-143">The application may receive an [EN\_ERRSPACE](en-errspace.md) notification code if the replacement text exceeds the available memory.</span></span> <span data-ttu-id="c1ea3-144">這則訊息適用于單行和多行編輯控制項。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-144">This message applies to both single-line and multiline edit controls.</span></span>

<span data-ttu-id="c1ea3-145">應用程式可以使用 [**EM \_ REPLACESEL**](em-replacesel.md) 來取代編輯控制項文字的一部分，或使用 [**SetDlgItemText**](/windows/desktop/api/winuser/nf-winuser-setdlgitemtexta) 函式來取代它的所有部分。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-145">An application can use [**EM\_REPLACESEL**](em-replacesel.md) to replace part of an edit control's text or the [**SetDlgItemText**](/windows/desktop/api/winuser/nf-winuser-setdlgitemtexta) function to replace all of it.</span></span>

## <a name="changing-the-font-used-by-an-edit-control"></a><span data-ttu-id="c1ea3-146">變更編輯控制項所使用的字型</span><span class="sxs-lookup"><span data-stu-id="c1ea3-146">Changing the Font Used by an Edit Control</span></span>

<span data-ttu-id="c1ea3-147">應用程式可以藉由傳送 [**WM \_ SETFONT**](/windows/desktop/winmsg/wm-setfont) 訊息來變更編輯控制項所使用的字型。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-147">An application can change the font that an edit control uses by sending the [**WM\_SETFONT**](/windows/desktop/winmsg/wm-setfont) message.</span></span> <span data-ttu-id="c1ea3-148">大部分的應用程式會在處理 [**WM \_ INITDIALOG**](/windows/desktop/dlgbox/wm-initdialog) 訊息時這麼做。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-148">Most applications do this while processing the [**WM\_INITDIALOG**](/windows/desktop/dlgbox/wm-initdialog) message.</span></span> <span data-ttu-id="c1ea3-149">變更字型不會變更編輯控制項的大小;傳送 **WM \_ SETFONT** 訊息的應用程式可能必須取得文字的字型計量，並重新計算編輯控制項的大小。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-149">Changing the font does not change the size of the edit control; applications that send the **WM\_SETFONT** message may have to retrieve the font metrics for the text and recalculate the size of the edit control.</span></span> <span data-ttu-id="c1ea3-150">如需字型和字型度量的詳細資訊，請參閱字型 [和文字](/windows/desktop/gdi/fonts-and-text)。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-150">For more information about fonts and font metrics, see [Fonts and Text](/windows/desktop/gdi/fonts-and-text).</span></span>

## <a name="cut-copy-paste-and-clear-operations"></a><span data-ttu-id="c1ea3-151">剪下複製貼上和清除作業</span><span class="sxs-lookup"><span data-stu-id="c1ea3-151">Cut Copy Paste and Clear Operations</span></span>

<span data-ttu-id="c1ea3-152">在編輯控制項和剪貼簿之間移動文字有四個訊息。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-152">There are four messages for moving text between an edit control and the clipboard.</span></span> <span data-ttu-id="c1ea3-153">如果有任何) 從編輯控制項複製到剪貼簿，而不是從編輯控制項刪除，則會將目前的選取範圍複製 (。 [**\_**](/windows/desktop/dataxchg/wm-copy)</span><span class="sxs-lookup"><span data-stu-id="c1ea3-153">The [**WM\_COPY**](/windows/desktop/dataxchg/wm-copy) message copies the current selection (if any) from an edit control to the clipboard without deleting it from the edit control.</span></span> <span data-ttu-id="c1ea3-154">如果編輯控制項中有任何) ，然後將已刪除的文字複製到剪貼簿，則 [ [**WM \_ 剪**](/windows/desktop/dataxchg/wm-cut) 下] 訊息會刪除目前的選取範圍 (。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-154">The [**WM\_CUT**](/windows/desktop/dataxchg/wm-cut) message deletes the current selection (if any) in the edit control and copies the deleted text to the clipboard.</span></span> <span data-ttu-id="c1ea3-155">如果有任何) 來自編輯控制項，則 [ [**WM \_ 清除**](/windows/desktop/dataxchg/wm-clear) ] 訊息會刪除目前的選取範圍 (，但除非使用者按下 SHIFT 鍵) ，否則不會將它複製到剪貼簿 (。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-155">The [**WM\_CLEAR**](/windows/desktop/dataxchg/wm-clear) message deletes the current selection (if any) from an edit control, but does not copy it to the clipboard (unless the user pressed the SHIFT key).</span></span> <span data-ttu-id="c1ea3-156">[**WM \_ 貼**](/windows/desktop/dataxchg/wm-paste)上訊息會將剪貼簿中的文字複製到插入點的編輯控制項。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-156">The [**WM\_PASTE**](/windows/desktop/dataxchg/wm-paste) message copies text from the clipboard into an edit control at the insertion point.</span></span> <span data-ttu-id="c1ea3-157">這四個訊息適用于單行和多行編輯控制項。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-157">These four messages apply to both single-line and multiline edit controls.</span></span>

<span data-ttu-id="c1ea3-158">Microsoft Windows NT 4.0 和更新版本：編輯控制項包含內建的內容功能表，可讓使用者輕鬆地在編輯控制項和剪貼簿之間移動文字。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-158">Microsoft Windows NT 4.0 and later: An edit control includes a built-in context menu that makes it easy for the user to move text between the edit control and the clipboard.</span></span> <span data-ttu-id="c1ea3-159">當使用者以滑鼠右鍵按一下控制項時，就會顯示內容功能表。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-159">The context menu appears when the user right-clicks the control.</span></span> <span data-ttu-id="c1ea3-160">內容功能表中的命令包括 [**復原**]、[**剪** 下]、[**複製**]、[**貼** 上]、[**刪除**] 和 [全 **選**</span><span class="sxs-lookup"><span data-stu-id="c1ea3-160">The commands in the context menu include **Undo**, **Cut**, **Copy**, **Paste**, **Delete**, and **Select All**.</span></span>

## <a name="modifying-text"></a><span data-ttu-id="c1ea3-161">修改文字</span><span class="sxs-lookup"><span data-stu-id="c1ea3-161">Modifying Text</span></span>

<span data-ttu-id="c1ea3-162">使用者可以選取、刪除或移動編輯控制項中的文字。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-162">The user can select, delete, or move text in an edit control.</span></span> <span data-ttu-id="c1ea3-163">系統會維護每個編輯控制項的內部旗標，指出是否已修改控制項的內容。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-163">The system maintains an internal flag for each edit control indicating whether the content of the control has been modified.</span></span> <span data-ttu-id="c1ea3-164">系統會在建立控制項時清除此旗標，並在每次修改控制項中的文字時設定旗標。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-164">The system clears this flag when it creates the control and sets the flag whenever the text in the control is modified.</span></span> <span data-ttu-id="c1ea3-165">應用程式可以藉由傳送 [**EM \_ GETMODIFY**](em-getmodify.md) 訊息的控制權來取得修改旗標。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-165">An application can retrieve the modification flag by sending the control an [**EM\_GETMODIFY**](em-getmodify.md) message.</span></span> <span data-ttu-id="c1ea3-166">然後，應用程式可以藉由傳送 [**EM \_ SETMODIFY**](em-setmodify.md) 訊息的控制權來設定或清除修改旗標。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-166">The application can then set or clear the modification flag by sending the control an [**EM\_SETMODIFY**](em-setmodify.md) message.</span></span> <span data-ttu-id="c1ea3-167">這些訊息適用于單行和多行編輯控制項。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-167">These messages apply to both single-line and multiline edit controls.</span></span>

## <a name="limiting-user-entered-text"></a><span data-ttu-id="c1ea3-168">限制使用者輸入的文字</span><span class="sxs-lookup"><span data-stu-id="c1ea3-168">Limiting User Entered Text</span></span>

<span data-ttu-id="c1ea3-169">使用者可以在編輯控制項中輸入的文字數量預設限制為 32 KB。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-169">The default limit to the amount of text a user can enter in an edit control is 32 KB.</span></span> <span data-ttu-id="c1ea3-170">應用程式可以藉由傳送 [**EM \_ SETLIMITTEXT**](em-setlimittext.md) 訊息的控制權來變更預設限制。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-170">An application can change the default limit by sending the control an [**EM\_SETLIMITTEXT**](em-setlimittext.md) message.</span></span> <span data-ttu-id="c1ea3-171">這則訊息會設定使用者可以輸入至編輯控制項的位元組數目的固定限制，但不會影響在傳送訊息時，以及 [**SetDlgItemText**](/windows/desktop/api/winuser/nf-winuser-setdlgitemtexta) 函式或 [**WM \_ SETTEXT**](/windows/desktop/winmsg/wm-settext) 訊息複製到控制項中的文字。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-171">This message sets a hard limit to the number of bytes the user can enter into an edit control, but affects neither text that is already in the control when the message was sent nor text copied to the control by the [**SetDlgItemText**](/windows/desktop/api/winuser/nf-winuser-setdlgitemtexta) function or the [**WM\_SETTEXT**](/windows/desktop/winmsg/wm-settext) message.</span></span> <span data-ttu-id="c1ea3-172">例如，假設應用程式使用 **SetDlgItemText** 函式在編輯控制項中放置500個位元組，而使用者也輸入500個位元組， (1000 個位元組總計) 。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-172">For example, suppose that the application uses the **SetDlgItemText** function to place 500 bytes in an edit control, and the user also enters 500 bytes (1,000 bytes total).</span></span> <span data-ttu-id="c1ea3-173">如果應用程式接著傳送 **EM \_ SETLIMITTEXT** 訊息，將使用者輸入的文字限制為300個位元組，則編輯控制項中的1000位元組仍會保留在該處，而且使用者也無法再加入任何文字。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-173">If the application then sends an **EM\_SETLIMITTEXT** message limiting user-entered text to 300 bytes, the 1,000 bytes already in the edit control remain there, and the user cannot add any more text.</span></span> <span data-ttu-id="c1ea3-174">另一方面，如果應用程式傳送 **EM \_ SETLIMITTEXT** 訊息將使用者輸入的文字限制為1300個位元組，則會保留1000個位元組，但使用者可以增加300個位元組。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-174">On the other hand, if the application sends an **EM\_SETLIMITTEXT** message limiting user-entered text to 1,300 bytes, the 1,000 bytes remain, but the user can add 300 more bytes.</span></span>

<span data-ttu-id="c1ea3-175">當使用者達到編輯控制項的字元限制時，系統會傳送包含 [EN \_ MAXTEXT](en-maxtext.md)通知碼的 [**WM \_ 命令**](/windows/desktop/menurc/wm-command)訊息給應用程式。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-175">When the user reaches the character limit of an edit control, the system sends the application a [**WM\_COMMAND**](/windows/desktop/menurc/wm-command) message containing an [EN\_MAXTEXT](en-maxtext.md) notification code.</span></span> <span data-ttu-id="c1ea3-176">此通知碼不表示記憶體已用盡，但已達到使用者輸入文字的限制;使用者無法輸入任何文字。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-176">This notification code does not mean that memory has been exhausted, but that the limit for user-entered text has been reached; the user cannot enter any more text.</span></span> <span data-ttu-id="c1ea3-177">若要變更此限制，應用程式必須以較高的限制將新的 [**EM \_ SETLIMITTEXT**](em-setlimittext.md) 訊息傳送給控制項。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-177">To change this limit, an application must send the control a new [**EM\_SETLIMITTEXT**](em-setlimittext.md) message with a higher limit.</span></span>

<span data-ttu-id="c1ea3-178">使用 [**EM \_ SETLIMITTEXT**](em-setlimittext.md) 和 [EN \_ MAXTEXT](en-maxtext.md)的範例，假設應用程式必須在編輯控制項中將使用者限制為不超過四個字元。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-178">As an example of the use of [**EM\_SETLIMITTEXT**](em-setlimittext.md) and [EN\_MAXTEXT](en-maxtext.md), suppose that the application must limit the user to no more than four characters in an edit control.</span></span> <span data-ttu-id="c1ea3-179">應用程式會使用 **EM \_ SETLIMITTEXT** 來指定四個字元的限制。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-179">The application would use **EM\_SETLIMITTEXT** to specify a four-character limit.</span></span> <span data-ttu-id="c1ea3-180">如果使用者嘗試輸入第五個字元，系統會將 EN \_ MAXTEXT 通知碼傳送給應用程式。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-180">If the user tried to enter a fifth character, the system would send an EN\_MAXTEXT notification code to the application.</span></span>

## <a name="character-and-line-operations"></a><span data-ttu-id="c1ea3-181">字元和行作業</span><span class="sxs-lookup"><span data-stu-id="c1ea3-181">Character and Line Operations</span></span>

<span data-ttu-id="c1ea3-182">有幾個訊息會傳回編輯控制項中的字元和行的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-182">There are several messages that return information about the characters and lines in an edit control.</span></span> <span data-ttu-id="c1ea3-183">大部分的訊息會傳回索引（通常是以零為基底的數位）來參考字元或行。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-183">Most of the messages return an index, usually a zero-based number, to refer to a character or line.</span></span> <span data-ttu-id="c1ea3-184">例如，在包含 n 個字元的單行編輯控制項中，行索引為零，而字元是從零到 n-1 的索引。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-184">For example, in a single-line edit control that contains n characters, the line index is zero and the characters are indexed from zero to n-1.</span></span> <span data-ttu-id="c1ea3-185">在包含 m 行和 n 個字元的多行編輯控制項中，這些行會從零到 m-1 編制索引，而字元的索引則是從零到 n-1。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-185">In a multiline edit control that contains m lines and n characters, the lines are indexed from zero to m-1, and the characters are indexed from zero to n-1.</span></span> <span data-ttu-id="c1ea3-186">請注意，字元索引會忽略換行字元。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-186">Note that character indexing ignores line breaks.</span></span>

<span data-ttu-id="c1ea3-187">應用程式可以將 [**WM \_ GETTEXTLENGTH**](/windows/desktop/winmsg/wm-gettextlength) 訊息傳送至編輯控制項，以判斷編輯控制項中的字元數。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-187">An application can determine the number of characters in an edit control by sending the [**WM\_GETTEXTLENGTH**](/windows/desktop/winmsg/wm-gettextlength) message to the edit control.</span></span> <span data-ttu-id="c1ea3-188">此訊息會傳回單行或多行編輯控制項中文字的長度（以字元為單位） (不包括結束的 null 字元) ）。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-188">This message returns the length, in characters (not including the terminating null character), of the text in a single-line or multiline edit control.</span></span> <span data-ttu-id="c1ea3-189">[**EM \_ LINELENGTH**](em-linelength.md)訊息會以字元為單位傳回該行中字元索引所指定的行長度（以字元為單位）。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-189">The [**EM\_LINELENGTH**](em-linelength.md) message returns the length, in characters, of a line specified by the character index of a character in the line.</span></span> <span data-ttu-id="c1ea3-190">傳回的長度不包含任何選取的字元。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-190">The returned length does not include any selected characters.</span></span> <span data-ttu-id="c1ea3-191">應用程式可以在單行或多行編輯控制項中使用這些訊息。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-191">An application can use these messages in a single-line or multiline edit control.</span></span>

<span data-ttu-id="c1ea3-192">[**EM \_ GETFIRSTVISIBLELINE**](em-getfirstvisibleline.md)訊息會傳回多行編輯控制項中最上層可見行的以零為起始的索引，或單行編輯控制項中第一個可見字元的以零為基底的索引。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-192">The [**EM\_GETFIRSTVISIBLELINE**](em-getfirstvisibleline.md) message returns the zero-based index of the uppermost visible line in a multiline edit control, or the zero-based index of the first visible character in a single-line edit control.</span></span> <span data-ttu-id="c1ea3-193">應用程式可以將 [**EM \_ GETLINE**](em-getline.md) 訊息傳送至編輯控制項，以從編輯控制項將一行複製到緩衝區。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-193">An application can copy a line from an edit control to a buffer by sending the [**EM\_GETLINE**](em-getline.md) message to the edit control.</span></span> <span data-ttu-id="c1ea3-194">該行是由其行索引所指定，而接收緩衝區的第一個單字則包含要複製到緩衝區的最大位元組數目。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-194">The line is specified by its line index and the first word of the receiving buffer contains the maximum number of bytes to be copied to the buffer.</span></span> <span data-ttu-id="c1ea3-195">傳回值是複製的位元組數目。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-195">The return value is the number of bytes copied.</span></span> <span data-ttu-id="c1ea3-196">此訊息也可用於單行或多行編輯控制項。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-196">This message can also be used in a single-line or multiline edit control.</span></span>

<span data-ttu-id="c1ea3-197">有唯一的訊息可用來傳回多行編輯控制項中某一行的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-197">There are unique messages available to return the information about a line in a multiline edit control.</span></span> <span data-ttu-id="c1ea3-198">[**EM \_ GETLINECOUNT**](em-getlinecount.md)訊息會傳回編輯控制項中的行數。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-198">The [**EM\_GETLINECOUNT**](em-getlinecount.md) message returns the number of lines in an edit control.</span></span> <span data-ttu-id="c1ea3-199">[**EM \_ LINEFROMCHAR**](em-linefromchar.md)訊息會傳回包含指定字元索引的行索引。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-199">The [**EM\_LINEFROMCHAR**](em-linefromchar.md) message returns the index of the line containing a specified character index.</span></span> <span data-ttu-id="c1ea3-200">[**EM \_ LINEINDEX**](em-lineindex.md)訊息會傳回指定行中第一個字元的索引。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-200">The [**EM\_LINEINDEX**](em-lineindex.md) message returns the index of the first character in a specified line.</span></span>

## <a name="scrolling-text-in-an-edit-control"></a><span data-ttu-id="c1ea3-201">在編輯控制項中滾動文字</span><span class="sxs-lookup"><span data-stu-id="c1ea3-201">Scrolling Text in an Edit Control</span></span>

<span data-ttu-id="c1ea3-202">若要在編輯控制項中執行滾動功能，您可以使用 [編輯控制項類型和樣式](about-edit-controls.md)中所討論的自動滾動樣式，也可以明確地在編輯控制項中加入捲軸。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-202">To implement scrolling in an edit control, you can use the automatic scrolling styles discussed in [Edit Control Types and Styles](about-edit-controls.md), or you can explicitly add scroll bars to the edit control.</span></span> <span data-ttu-id="c1ea3-203">若要加入水準捲軸，請使用樣式 WS \_ HSCROLL; 若要加入垂直捲動條，請使用樣式 [**ws \_ VSCROLL**](/windows/desktop/winmsg/window-styles)。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-203">To add a horizontal scroll bar, use the style WS\_HSCROLL; to add a vertical scroll bar, use the style [**WS\_VSCROLL**](/windows/desktop/winmsg/window-styles).</span></span> <span data-ttu-id="c1ea3-204">具有捲軸的編輯控制項會處理自己的捲軸訊息。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-204">An edit control with scroll bars processes its own scroll bar messages.</span></span> <span data-ttu-id="c1ea3-205">如需加入捲軸以編輯控制項的詳細資訊，請參閱 [捲軸](scroll-bars.md)。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-205">For detailed information about adding scroll bars to edit controls, see [Scroll Bars](scroll-bars.md).</span></span>

<span data-ttu-id="c1ea3-206">系統會提供三個訊息，讓應用程式可以使用捲軸傳送至編輯控制項。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-206">The system provides three messages that an application can send to an edit control with scroll bars.</span></span> <span data-ttu-id="c1ea3-207">[**EM \_ LINESCROLL**](em-linescroll.md)訊息可以垂直和水準地滾動多行編輯控制項。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-207">The [**EM\_LINESCROLL**](em-linescroll.md) message can scroll a multiline edit control both vertically and horizontally.</span></span> <span data-ttu-id="c1ea3-208">*LParam* 參數會指定從目前的行垂直垂直捲動的行數，而 *wParam* 參數指定要水準滾動的字元數（從目前的字元開始）。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-208">The *lParam* parameter specifies the number of lines to scroll vertically starting from the current line and the *wParam* parameter specifies the number of characters to scroll horizontally, starting from the current character.</span></span> <span data-ttu-id="c1ea3-209">如果有 [**es \_ CENTER**](edit-control-styles.md) 或 [**es \_ 許可權**](edit-control-styles.md) 樣式，則編輯控制項不會認可水準滾動消息。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-209">The edit control does not acknowledge horizontal scrolling messages if it has the [**ES\_CENTER**](edit-control-styles.md) or [**ES\_RIGHT**](edit-control-styles.md) style.</span></span> <span data-ttu-id="c1ea3-210">**EM \_ LINESCROLL** 訊息只適用于多行編輯控制項。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-210">The **EM\_LINESCROLL** message applies to multiline edit controls only.</span></span>

<span data-ttu-id="c1ea3-211">[**EM \_ 滾動**](em-scroll.md)條訊息會垂直捲動多行編輯控制項。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-211">The [**EM\_SCROLL**](em-scroll.md) message scrolls a multiline edit control vertically.</span></span> <span data-ttu-id="c1ea3-212">*WParam* 參數會指定滾動動作。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-212">The *wParam* parameter specifies the scrolling action.</span></span> <span data-ttu-id="c1ea3-213">**EM \_ 滾動** 條訊息只適用于多行編輯控制項。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-213">The **EM\_SCROLL** message applies to multiline edit controls only.</span></span> <span data-ttu-id="c1ea3-214">**EM \_滾動** 條的效果與 [**WM \_ VSCROLL**](wm-vscroll.md) 訊息相同。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-214">**EM\_SCROLL** has the same effect as the [**WM\_VSCROLL**](wm-vscroll.md) message.</span></span>

<span data-ttu-id="c1ea3-215">[**EM \_ SCROLLCARET**](em-scrollcaret.md)訊息會將插入號滾動至編輯控制項中的 view。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-215">The [**EM\_SCROLLCARET**](em-scrollcaret.md) message scrolls the caret into view in an edit control.</span></span>

## <a name="setting-tab-stops-and-margins"></a><span data-ttu-id="c1ea3-216">設定制表位和邊界</span><span class="sxs-lookup"><span data-stu-id="c1ea3-216">Setting Tab Stops and Margins</span></span>

<span data-ttu-id="c1ea3-217">應用程式可以使用 [**EM \_ SETTABSTOPS**](em-settabstops.md) 訊息，在多行編輯控制項中設定制表位。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-217">An application can set tab stops in a multiline edit control by using the [**EM\_SETTABSTOPS**](em-settabstops.md) message.</span></span> <span data-ttu-id="c1ea3-218"> (定位停駐點的預設值為8個字元。 ) 當應用程式將文字加入編輯控制項時，文字中的定位字元會自動產生空間，直到下一個索引標籤停止為止。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-218">(The default for a tab stop is eight characters.) When an application adds text to the edit control, tab characters in the text automatically generate space up to the next tab stop.</span></span> <span data-ttu-id="c1ea3-219">**EM \_ SETTABSTOPS** 訊息不會自動造成系統重繪文字。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-219">The **EM\_SETTABSTOPS** message does not automatically cause the system to redraw the text.</span></span> <span data-ttu-id="c1ea3-220">若要這樣做，應用程式可以呼叫 [**InvalidateRect**](/windows/desktop/api/winuser/nf-winuser-invalidaterect) 函數。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-220">To do that, an application can call the [**InvalidateRect**](/windows/desktop/api/winuser/nf-winuser-invalidaterect) function.</span></span> <span data-ttu-id="c1ea3-221">**EM \_ SETTABSTOPS** 訊息只適用于多行編輯控制項。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-221">The **EM\_SETTABSTOPS** message applies to multiline edit controls only.</span></span>

<span data-ttu-id="c1ea3-222">應用程式可以使用 [**EM \_ SETMARGINS**](em-setmargins.md) 訊息來設定編輯控制項的左邊界和右邊界的寬度。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-222">An application can set the width of the left and right margins for an edit control by using the [**EM\_SETMARGINS**](em-setmargins.md) message.</span></span> <span data-ttu-id="c1ea3-223">傳送此訊息之後，系統會重新繪製編輯控制項以反映新的邊界設定。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-223">After sending this message, the system redraws the edit control to reflect the new margin settings.</span></span> <span data-ttu-id="c1ea3-224">應用程式可以藉由傳送 [**EM \_ GETMARGINS**](em-getmargins.md) 訊息來取得左右邊界的寬度。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-224">An application can retrieve the width of the left or right margin by sending the [**EM\_GETMARGINS**](em-getmargins.md) message.</span></span> <span data-ttu-id="c1ea3-225">根據預設，編輯控制項邊界的寬度足以容納最大的字元水準懸垂 (負 ABC 寬度) 用於編輯控制項中目前的字型。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-225">By default, the edit control margins are set just wide enough to accommodate the largest character horizontal overhang (negative ABC widths) for the current font being used in the edit control.</span></span>

## <a name="concealing-user-input"></a><span data-ttu-id="c1ea3-226">隱藏使用者輸入</span><span class="sxs-lookup"><span data-stu-id="c1ea3-226">Concealing User Input</span></span>

<span data-ttu-id="c1ea3-227">應用程式可以使用編輯控制項中的密碼字元來隱藏使用者輸入。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-227">An application can use a password character in an edit control to conceal user input.</span></span> <span data-ttu-id="c1ea3-228">設定密碼字元時，會顯示該字元來取代使用者輸入的每個字元。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-228">When a password character is set, it is displayed in place of each character the user types.</span></span> <span data-ttu-id="c1ea3-229">移除密碼字元時，控制項會顯示使用者所輸入的字元。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-229">When a password character is removed, the control displays the characters the user types.</span></span> <span data-ttu-id="c1ea3-230">如果應用程式使用 style [**ES \_ 密碼**](edit-control-styles.md)建立單行編輯控制項，則預設密碼字元是星號 (\*) 。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-230">If the application creates a single-line edit control using the style [**ES\_PASSWORD**](edit-control-styles.md), the default password character is an asterisk (\*).</span></span> <span data-ttu-id="c1ea3-231">應用程式可以使用 [**em \_ SETPASSWORDCHAR**](em-setpasswordchar.md) 訊息來移除或定義不同的密碼字元，並使用 [**em \_ GETPASSWORDCHAR**](em-getpasswordchar.md) 訊息來取出目前的密碼字元。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-231">An application can use the [**EM\_SETPASSWORDCHAR**](em-setpasswordchar.md) message to remove or define a different password character and the [**EM\_GETPASSWORDCHAR**](em-getpasswordchar.md) message to retrieve the current password character.</span></span> <span data-ttu-id="c1ea3-232">這些訊息只適用于單行編輯控制項。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-232">These messages apply to single-line edit controls only.</span></span>

## <a name="using-integers"></a><span data-ttu-id="c1ea3-233">使用整數</span><span class="sxs-lookup"><span data-stu-id="c1ea3-233">Using Integers</span></span>

<span data-ttu-id="c1ea3-234">針對只包含數位的編輯控制項，有兩個整數轉換函數。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-234">There are two integer-conversion functions for edit controls designed to contain numbers only.</span></span> <span data-ttu-id="c1ea3-235">[**SetDlgItemInt**](/windows/desktop/api/winuser/nf-winuser-setdlgitemint)函式會 (簽署或未簽署的) 來建立指定之整數的字串表示，並將字串傳送至編輯控制項。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-235">The [**SetDlgItemInt**](/windows/desktop/api/winuser/nf-winuser-setdlgitemint) function creates the string representation of a specified integer (signed or unsigned) and sends the string to an edit control.</span></span> <span data-ttu-id="c1ea3-236">**SetDlgItemInt** 不會傳回任何值。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-236">**SetDlgItemInt** returns no value.</span></span> <span data-ttu-id="c1ea3-237">[**GetDlgItemInt**](/windows/desktop/api/winuser/nf-winuser-getdlgitemint)函式會從編輯控制項中的字串表示，建立整數 (簽署或未簽署的) 。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-237">The [**GetDlgItemInt**](/windows/desktop/api/winuser/nf-winuser-getdlgitemint) function creates an integer (signed or unsigned) from its string representation in an edit control.</span></span> <span data-ttu-id="c1ea3-238">**GetDlgItemInt** 會傳回整數 (或) 的錯誤值。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-238">**GetDlgItemInt** returns the integer (or an error value).</span></span>

## <a name="undoing-text-operations"></a><span data-ttu-id="c1ea3-239">復原文字作業</span><span class="sxs-lookup"><span data-stu-id="c1ea3-239">Undoing Text Operations</span></span>

<span data-ttu-id="c1ea3-240">每個編輯控制項都會維護一個復原旗標，指出應用程式是否可以反轉或復原編輯控制項上最近的作業， (復原文字刪除，例如) 。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-240">Every edit control maintains an undo flag that indicates whether an application can reverse or undo the most recent operation on the edit control (undoing a text deletion, for example).</span></span> <span data-ttu-id="c1ea3-241">編輯控制項會設定復原旗標，以指出作業可以復原並重設，以表示作業無法復原。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-241">The edit control sets the undo flag to indicate that the operation can be undone and resets it to indicate that the operation cannot be undone.</span></span> <span data-ttu-id="c1ea3-242">應用程式可以藉由傳送 [**EM \_ CANUNDO**](em-canundo.md) 訊息的控制權，判斷復原旗標的設定。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-242">An application can determine the setting of the undo flag by sending the control an [**EM\_CANUNDO**](em-canundo.md) message.</span></span>

<span data-ttu-id="c1ea3-243">應用程式可以藉由將「 [**EM \_ 復原**](em-undo.md) 」訊息傳送給控制項，來復原最近的操作。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-243">An application can undo the most recent operation by sending the control an [**EM\_UNDO**](em-undo.md) message.</span></span> <span data-ttu-id="c1ea3-244">如果沒有任何其他編輯控制項作業會先發生，就可以復原操作。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-244">An operation can be undone provided no other edit control operation occurs first.</span></span> <span data-ttu-id="c1ea3-245">例如，使用者可以刪除文字、取代文字 (復原刪除) ，然後再刪除文字， (復原取代) 。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-245">For example, the user can delete text, replace the text (undo the deletion), and then delete the text again (undo the replacement).</span></span> <span data-ttu-id="c1ea3-246">**EM \_ 復原** 訊息適用于單行和多行編輯控制項，而且一律適用于單行編輯控制項。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-246">The **EM\_UNDO** message applies to both single-line and multiline edit controls and always works for single-line edit controls.</span></span>

<span data-ttu-id="c1ea3-247">應用程式可以傳送 [**EM \_ EMPTYUNDOBUFFER**](em-emptyundobuffer.md) 訊息給控制項，以重設編輯控制項的復原旗標。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-247">An application can reset an edit control's undo flag by sending the control an [**EM\_EMPTYUNDOBUFFER**](em-emptyundobuffer.md) message.</span></span> <span data-ttu-id="c1ea3-248">每當編輯控制項收到 [**EM \_ SETHANDLE**](em-sethandle.md) 或 [**WM \_ SETTEXT**](/windows/desktop/winmsg/wm-settext) 訊息時，系統就會自動重設復原旗標。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-248">The system automatically resets the undo flag whenever an edit control receives an [**EM\_SETHANDLE**](em-sethandle.md) or [**WM\_SETTEXT**](/windows/desktop/winmsg/wm-settext) message.</span></span> <span data-ttu-id="c1ea3-249">[**SetDlgItemText**](/windows/desktop/api/winuser/nf-winuser-setdlgitemtexta)函式會傳送 **WM \_ SETTEXT** 訊息。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-249">The [**SetDlgItemText**](/windows/desktop/api/winuser/nf-winuser-setdlgitemtexta) function sends a **WM\_SETTEXT** message.</span></span>

## <a name="handling-wordwrap-and-line-breaks"></a><span data-ttu-id="c1ea3-250">處理 Wordwrap 和換行</span><span class="sxs-lookup"><span data-stu-id="c1ea3-250">Handling Wordwrap and Line Breaks</span></span>

<span data-ttu-id="c1ea3-251">應用程式可以搭配多行編輯控制項使用 Wordwrap 函式，以找出應該包裝到下一行的單字或單字片段。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-251">An application can use Wordwrap functions with multiline edit controls to locate the word or word fragment that should be wrapped to the next line.</span></span> <span data-ttu-id="c1ea3-252">使用系統提供的預設 Wordwrap 函式時，行一律會以單字之間的空格結尾。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-252">Using the default Wordwrap function provided by the system, lines always end at the spaces between words.</span></span> <span data-ttu-id="c1ea3-253">應用程式可以指定它自己的 Wordwrap 函式，方法是提供 [*EditWordBreakProc*](/windows/win32/api/winuser/nc-winuser-editwordbreakproca) Wordwrap 函式，並傳送 [**EM \_ SETWORDBREAKPROC**](em-setwordbreakproc.md) 訊息給編輯控制項。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-253">An application can specify its own Wordwrap function by supplying an [*EditWordBreakProc*](/windows/win32/api/winuser/nc-winuser-editwordbreakproca) Wordwrap function and sending the edit control an [**EM\_SETWORDBREAKPROC**](em-setwordbreakproc.md) message.</span></span> <span data-ttu-id="c1ea3-254">應用程式可以藉由傳送 [**EM \_ GETWORDBREAKPROC**](em-getwordbreakproc.md) 訊息給控制項，來取得目前 Wordwrap 函式的位址。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-254">An application can retrieve the address of the current Wordwrap function by sending the control an [**EM\_GETWORDBREAKPROC**](em-getwordbreakproc.md) message.</span></span>

<span data-ttu-id="c1ea3-255">應用程式可以指示多行編輯控制項在換行字元 (兩個換行字元，以及在換行文字行的結尾自動) 換行字元。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-255">An application may direct a multiline edit control to add or remove a soft line break character (two carriage returns and a line feed) automatically at the end of wrapped-text lines.</span></span> <span data-ttu-id="c1ea3-256">應用程式可以藉由傳送編輯控制項的 [**EM \_ FMTLINES**](em-fmtlines.md) 訊息，開啟或關閉此功能。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-256">An application can turn this feature on or off by sending the edit control an [**EM\_FMTLINES**](em-fmtlines.md) message.</span></span> <span data-ttu-id="c1ea3-257">這則訊息只適用于多行編輯控制項，而且不會影響以硬換行結尾的行 (一個換行字元和使用者) 輸入的換行字元。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-257">This message applies only to multiline edit controls and does not affect a line that ends with a hard line break (one carriage return and a line feed entered by the user).</span></span> <span data-ttu-id="c1ea3-258">此外，在多行編輯控制項中，應用程式可以指定 [**ES \_ WANTRETURN**](edit-control-styles.md) 樣式，要求系統在使用者按下 [編輯] 控制項中的 ENTER 鍵時，插入一個回車。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-258">Also in multiline edit controls, an application can specify the [**ES\_WANTRETURN**](edit-control-styles.md) style to request that the system insert a carriage return when the user presses the ENTER key in the edit control.</span></span>

## <a name="retrieving-points-and-characters"></a><span data-ttu-id="c1ea3-259">取出點和字元</span><span class="sxs-lookup"><span data-stu-id="c1ea3-259">Retrieving Points and Characters</span></span>

<span data-ttu-id="c1ea3-260">若要判斷最接近編輯控制項工作區中指定點的字元，請將 [**EM \_ CHARFROMPOS**](em-charfrompos.md) 訊息傳送至控制項。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-260">To determine the character closest to a specified point in the client area of an edit control, send the [**EM\_CHARFROMPOS**](em-charfrompos.md) message to the control.</span></span> <span data-ttu-id="c1ea3-261">訊息會傳回最接近點的字元索引和字元的行索引。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-261">The message returns the character index and line index of the character nearest the point.</span></span> <span data-ttu-id="c1ea3-262">同樣地，您可以藉由傳送 [**EM \_ POSFROMCHAR**](em-posfromchar.md) 訊息來取出指定字元的工作區座標。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-262">Similarly, you can retrieve the client area coordinates of a specified character by sending the [**EM\_POSFROMCHAR**](em-posfromchar.md) message.</span></span> <span data-ttu-id="c1ea3-263">訊息會傳回指定字元左上角的 x 和 y 座標。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-263">The message returns the x and y coordinates of the upper-left corner of the specified character.</span></span>

## <a name="autocompletion-of-strings"></a><span data-ttu-id="c1ea3-264">自動完成字串</span><span class="sxs-lookup"><span data-stu-id="c1ea3-264">Autocompletion of Strings</span></span>

<span data-ttu-id="c1ea3-265">自動完成會將已部分在編輯控制項中輸入的字串展開為完整字串。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-265">Autocompletion expands strings that have been partially entered in an edit control into complete strings.</span></span> <span data-ttu-id="c1ea3-266">例如，當使用者開始在 [Windows Internet Explorer] 工具列中內嵌的 [位址] 編輯控制項中輸入 URL 時，自動完成功能會將字串展開為一或多個與現有部分字串一致的完整 Url。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-266">For example, when a user starts to enter a URL in the Address edit control that is embedded in the Windows Internet Explorer toolbar, autocompletion expands the string into one or more complete URLs that are consistent with the existing partial string.</span></span> <span data-ttu-id="c1ea3-267">部分 URL 字串（例如 "mic"）可能會展開為 " https://www.microsoft.com " 或 " https://www.microsoft.com/windows "。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-267">A partial URL string such as "mic" might be expanded to "https://www.microsoft.com" or "https://www.microsoft.com/windows".</span></span> <span data-ttu-id="c1ea3-268">自動完成通常會與編輯控制項或具有內嵌編輯控制項的控制項一起使用。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-268">Autocompletion is typically used with edit controls or with controls that have an embedded edit control.</span></span>

<span data-ttu-id="c1ea3-269">如需詳細資訊，請參閱 [**IAutoComplete**](/windows/desktop/api/shldisp/nn-shldisp-iautocomplete) 和 [**IAutoComplete2**](/windows/desktop/api/shldisp/nn-shldisp-iautocomplete2) 介面檔。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-269">For more information, see the [**IAutoComplete**](/windows/desktop/api/shldisp/nn-shldisp-iautocomplete) and [**IAutoComplete2**](/windows/desktop/api/shldisp/nn-shldisp-iautocomplete2) interface documentation.</span></span>

## <a name="complex-script-in-edit-controls"></a><span data-ttu-id="c1ea3-270">編輯控制項中的複雜字集</span><span class="sxs-lookup"><span data-stu-id="c1ea3-270">Complex Script in Edit Controls</span></span>

<span data-ttu-id="c1ea3-271">*複雜的腳本* 是一種語言，其列印表單未以簡單的方式配置。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-271">A *complex script* is a language whose printed form is not laid out in a simple way.</span></span> <span data-ttu-id="c1ea3-272">例如，複雜的腳本可能會允許雙向轉譯、字型的內容成形，或合併字元。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-272">For example, a complex script may allow bidirectional rendering, contextual shaping of glyphs, or combining characters.</span></span> <span data-ttu-id="c1ea3-273">標準編輯控制項已經過擴充，可支援多語系文字和複雜的腳本。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-273">The standard edit controls have been extended to support multilingual text and complex scripts.</span></span> <span data-ttu-id="c1ea3-274">這不僅包括輸入和顯示，也包括正確的資料指標移動 (在泰文和梵文腳本中的字元叢集，例如) 。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-274">This includes not only input and display, but also correct cursor movement over character clusters (in Thai and Devanagari script, for example).</span></span>

<span data-ttu-id="c1ea3-275">妥善撰寫的應用程式會自動收到此支援，而不需要修改。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-275">A well-written application receives this support automatically, without modification.</span></span> <span data-ttu-id="c1ea3-276">同樣地，您應該考慮加入由右至左讀取順序和靠右對齊的支援。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-276">Again, you should consider adding support for right-to-left reading order and right alignment.</span></span> <span data-ttu-id="c1ea3-277">在此情況下，請切換編輯控制項視窗的擴充樣式旗標來控制這些屬性，如下列範例所示。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-277">In this case, toggle the extended style flags of the edit control window to control these attributes, as shown in the following example.</span></span>


```
// ID_EDITCONTROL is the control ID in the resource file.
HANDLE hWndEdit = GetDlgItem(hDlg, ID_EDITCONTROL);
LONG lAlign = GetWindowLong(hWndEdit, GWL_EXSTYLE) ;

// To toggle alignment
lAlign ^= WS_EX_RIGHT ;

// To toggle reading order
lAlign ^= WS_EX_RTLREADING ;
```



<span data-ttu-id="c1ea3-278">設定 **lAlign** 值之後，請設定 [編輯控制項] 視窗的擴充樣式，以啟用新的顯示，如下所示。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-278">After setting the **lAlign** value, enable the new display by setting the extended style of the edit control window as follows.</span></span>


```
// This assumes your edit control is in a dialog box. If not, 
// get the edit control handle from another source.

SetWindowLong(hWndEdit, GWL_EXSTYLE, lAlign);
InvalidateRect(hWndEdit, NULL, FALSE);
```



<span data-ttu-id="c1ea3-279">Uniscribe 是另一組函數，可提供精確的控制來處理複雜的腳本。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-279">Uniscribe is another set of functions that provide fine control for processing complex scripts.</span></span> <span data-ttu-id="c1ea3-280">如需詳細資訊，請參閱 [Uniscribe](/windows/desktop/Intl/uniscribe)。</span><span class="sxs-lookup"><span data-stu-id="c1ea3-280">For more information, see [Uniscribe](/windows/desktop/Intl/uniscribe).</span></span>

 

 