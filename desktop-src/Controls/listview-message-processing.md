---
title: 預設 List-View 訊息處理
description: 此區段會列出由清單視圖控制項所執行的視窗訊息處理。
ms.assetid: c634c446-37e5-4f7c-b337-306c29961e58
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 6bdc19927479a78bd2bffeaaa66b2986847747f3
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/21/2020
ms.locfileid: "104024162"
---
# <a name="default-list-view-message-processing"></a><span data-ttu-id="6c111-103">預設 List-View 訊息處理</span><span class="sxs-lookup"><span data-stu-id="6c111-103">Default List-View Message Processing</span></span>

<span data-ttu-id="6c111-104">此區段會列出由清單視圖控制項所執行的視窗訊息處理。</span><span class="sxs-lookup"><span data-stu-id="6c111-104">This section lists the window message processing performed by a list-view control.</span></span>

## <a name="message-processing"></a><span data-ttu-id="6c111-105">訊息處理</span><span class="sxs-lookup"><span data-stu-id="6c111-105">Message Processing</span></span>

<span data-ttu-id="6c111-106">下表描述由清單視圖控制項所執行的視窗訊息處理。</span><span class="sxs-lookup"><span data-stu-id="6c111-106">The following table describes the window message processing performed by a list-view control.</span></span>



| <span data-ttu-id="6c111-107">訊息</span><span class="sxs-lookup"><span data-stu-id="6c111-107">Message</span></span>                  | <span data-ttu-id="6c111-108">處理已執行</span><span class="sxs-lookup"><span data-stu-id="6c111-108">Processing performed</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|--------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="6c111-109">**WM \_ 字元**</span><span class="sxs-lookup"><span data-stu-id="6c111-109">**WM\_CHAR**</span></span>             | <span data-ttu-id="6c111-110">搜尋以指定字元開頭的清單視圖專案，如果找到該專案，則選取並將焦點設定至專案。</span><span class="sxs-lookup"><span data-stu-id="6c111-110">Searches for a list-view item that begins with the specified character and, if the item is found, selects and sets the focus to the item.</span></span> <span data-ttu-id="6c111-111">在逾時間隔內收到多個要串連的字元（目前已固定一秒），而且清單視圖控制項會搜尋以產生的字串開頭的專案。</span><span class="sxs-lookup"><span data-stu-id="6c111-111">Multiple characters received within a time-out interval, currently fixed at one second, are concatenated, and the list-view control searches for an item that begins with the resulting string.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| <span data-ttu-id="6c111-112">**WM \_ 命令**</span><span class="sxs-lookup"><span data-stu-id="6c111-112">**WM\_COMMAND**</span></span>          | <span data-ttu-id="6c111-113">處理 [en \_ UPDATE](en-update.md) 和 [en \_ KILLFOCUS](en-killfocus.md) 通知代碼，並將所有其他編輯控制項通知轉送至父視窗。</span><span class="sxs-lookup"><span data-stu-id="6c111-113">Processes the [EN\_UPDATE](en-update.md) and [EN\_KILLFOCUS](en-killfocus.md) notification codes and forwards all other edit control notifications to the parent window.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| <span data-ttu-id="6c111-114">**WM \_ 建立**</span><span class="sxs-lookup"><span data-stu-id="6c111-114">**WM\_CREATE**</span></span>           | <span data-ttu-id="6c111-115">對 [**WM \_ NCCREATE**](/windows/desktop/winmsg/wm-nccreate)執行額外的初始化。</span><span class="sxs-lookup"><span data-stu-id="6c111-115">Performs initialization additional to [**WM\_NCCREATE**](/windows/desktop/winmsg/wm-nccreate).</span></span> <span data-ttu-id="6c111-116">如果未指定 [**lvs) \_ SHAREIMAGELISTS**](list-view-window-styles.md) 視窗樣式，則清單視圖控制項會在此時建立圖示和小型圖示影像清單。</span><span class="sxs-lookup"><span data-stu-id="6c111-116">If the [**LVS\_SHAREIMAGELISTS**](list-view-window-styles.md) window style is not specified, the list-view control creates the icon and small icon image lists at this point.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| <span data-ttu-id="6c111-117">**WM 損 \_ 毀**</span><span class="sxs-lookup"><span data-stu-id="6c111-117">**WM\_DESTROY**</span></span>          | <span data-ttu-id="6c111-118">釋出在 [**WM \_ 建立**](/windows/desktop/winmsg/wm-create)期間配置的資源。</span><span class="sxs-lookup"><span data-stu-id="6c111-118">Frees resources allocated during [**WM\_CREATE**](/windows/desktop/winmsg/wm-create).</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| <span data-ttu-id="6c111-119">**WM \_ ERASEBKGND**</span><span class="sxs-lookup"><span data-stu-id="6c111-119">**WM\_ERASEBKGND**</span></span>       | <span data-ttu-id="6c111-120">使用清單視圖控制項目前的背景色彩，清除視窗背景。</span><span class="sxs-lookup"><span data-stu-id="6c111-120">Erases the window background using the current background color for the list-view control.</span></span> <span data-ttu-id="6c111-121">如果背景色彩為 [CLR \_ 無] 值，則清單視圖控制項會將訊息轉送至父視窗。</span><span class="sxs-lookup"><span data-stu-id="6c111-121">If the background color is the CLR\_NONE value, the list-view control forwards the message to the parent window.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| <span data-ttu-id="6c111-122">**WM \_ GETDLGCODE**</span><span class="sxs-lookup"><span data-stu-id="6c111-122">**WM\_GETDLGCODE**</span></span>       | <span data-ttu-id="6c111-123">傳回 DLGC \_ WANTTAB 和 DLGC WANTARROWS 值的組合 \_ 。</span><span class="sxs-lookup"><span data-stu-id="6c111-123">Returns a combination of the DLGC\_WANTTAB and DLGC\_WANTARROWS values.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| <span data-ttu-id="6c111-124">**WM \_ GETFONT**</span><span class="sxs-lookup"><span data-stu-id="6c111-124">**WM\_GETFONT**</span></span>          | <span data-ttu-id="6c111-125">傳回目前標籤字型的控制碼。</span><span class="sxs-lookup"><span data-stu-id="6c111-125">Returns the handle to the current label font.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| <span data-ttu-id="6c111-126">**WM \_ HSCROLL**</span><span class="sxs-lookup"><span data-stu-id="6c111-126">**WM\_HSCROLL**</span></span>          | <span data-ttu-id="6c111-127">水準滾動清單視圖控制項。</span><span class="sxs-lookup"><span data-stu-id="6c111-127">Scrolls the list-view control horizontally.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| <span data-ttu-id="6c111-128">**WM \_ KEYDOWN**</span><span class="sxs-lookup"><span data-stu-id="6c111-128">**WM\_KEYDOWN**</span></span>          | <span data-ttu-id="6c111-129">處理空格鍵、ENTER 和箭號，並將 [LVN \_ KEYDOWN](lvn-keydown.md) 通知程式碼傳送至父視窗。</span><span class="sxs-lookup"><span data-stu-id="6c111-129">Processes the SPACEBAR, ENTER, and arrow keys and sends an [LVN\_KEYDOWN](lvn-keydown.md) notification code to the parent window.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| <span data-ttu-id="6c111-130">**WM \_ KILLFOCUS**</span><span class="sxs-lookup"><span data-stu-id="6c111-130">**WM\_KILLFOCUS**</span></span>        | <span data-ttu-id="6c111-131">重新繪製焦點清單專案（如果有的話），並將 [NM \_ KILLFOCUS](nm-killfocus.md) 通知程式碼傳送至父視窗。</span><span class="sxs-lookup"><span data-stu-id="6c111-131">Repaints the focused list item, if any, and sends an [NM\_KILLFOCUS](nm-killfocus.md) notification code to the parent window.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| <span data-ttu-id="6c111-132">**WM \_ LBUTTONDBLCLK**</span><span class="sxs-lookup"><span data-stu-id="6c111-132">**WM\_LBUTTONDBLCLK**</span></span>    | <span data-ttu-id="6c111-133">以 [NM \_ DBLCLK (清單視圖 ](nm-dblclk-list-view.md) 的形式傳送父視窗) 通知碼。</span><span class="sxs-lookup"><span data-stu-id="6c111-133">Sends the parent window an [NM\_DBLCLK (list view)](nm-dblclk-list-view.md) notification code.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| <span data-ttu-id="6c111-134">**WM \_ LBUTTONDOWN**</span><span class="sxs-lookup"><span data-stu-id="6c111-134">**WM\_LBUTTONDOWN**</span></span>      | <span data-ttu-id="6c111-135">以不同的方式處理，視是否正在起始按一下或拖曳操作而定。</span><span class="sxs-lookup"><span data-stu-id="6c111-135">Processed in different ways depending on whether a click or drag operation is being initiated.</span></span> <span data-ttu-id="6c111-136">為了判斷牽涉到的作業，清單視圖控制項會進入強制回應訊息迴圈，直到按鈕放開或移動滑鼠為止。</span><span class="sxs-lookup"><span data-stu-id="6c111-136">To determine which operation is involved, the list-view control enters a modal message loop until either the button is released or the mouse is moved.</span></span> <span data-ttu-id="6c111-137">如果按一下，清單視圖控制項可能會變更哪個專案具有焦點，以及要選取哪些專案、將游標位置納入考慮、SHIFT 和 CTRL 鍵的狀態等等。</span><span class="sxs-lookup"><span data-stu-id="6c111-137">In the case of a click, the list-view control might change which item has the focus and which items are selected, taking into account the cursor position, the state of the SHIFT and CTRL keys, and so on.</span></span> <span data-ttu-id="6c111-138">然後，清單視圖控制項會傳送其父視窗，即 [NM \_ CLICK (清單視圖) ](nm-click-list-view.md) 通知碼。</span><span class="sxs-lookup"><span data-stu-id="6c111-138">Then the list-view control sends its parent window an [NM\_CLICK (list view)](nm-click-list-view.md) notification code.</span></span><br/> <span data-ttu-id="6c111-139">如果從專案開始拖曳，清單視圖控制項會選取焦點，並將焦點設定至專案。</span><span class="sxs-lookup"><span data-stu-id="6c111-139">If dragging begins over an item, the list-view control selects and sets the focus to the item.</span></span> <span data-ttu-id="6c111-140">然後，它會將 [LVN \_ BEGINDRAG](lvn-begindrag.md) 通知程式碼傳送至父視窗。</span><span class="sxs-lookup"><span data-stu-id="6c111-140">Then it sends an [LVN\_BEGINDRAG](lvn-begindrag.md) notification code to the parent window.</span></span> <span data-ttu-id="6c111-141">父視窗負責實際執行拖曳作業。</span><span class="sxs-lookup"><span data-stu-id="6c111-141">The parent window is responsible for actually carrying out the drag operation.</span></span><br/> <span data-ttu-id="6c111-142">如果從視窗背景拖曳開始，則清單視圖控制項會進入另一個強制回應的訊息迴圈，讓使用者藉由拖曳滑鼠來形成矩形。</span><span class="sxs-lookup"><span data-stu-id="6c111-142">If dragging begins over the window background, the list-view control enters another modal message loop, enabling the user to form a rectangle by dragging the mouse.</span></span> <span data-ttu-id="6c111-143">選取矩形內的專案。</span><span class="sxs-lookup"><span data-stu-id="6c111-143">Items within the rectangle are selected.</span></span><br/> |
| <span data-ttu-id="6c111-144">**WM \_ NCCREATE**</span><span class="sxs-lookup"><span data-stu-id="6c111-144">**WM\_NCCREATE**</span></span>         | <span data-ttu-id="6c111-145">配置並初始化內部資料結構，然後呼叫 [**DefWindowProc**](/windows/desktop/api/winuser/nf-winuser-defwindowproca) 函數。</span><span class="sxs-lookup"><span data-stu-id="6c111-145">Allocates and initializes an internal data structure and then calls the [**DefWindowProc**](/windows/desktop/api/winuser/nf-winuser-defwindowproca) function.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| <span data-ttu-id="6c111-146">**WM \_ NCDESTROY**</span><span class="sxs-lookup"><span data-stu-id="6c111-146">**WM\_NCDESTROY**</span></span>        | <span data-ttu-id="6c111-147">釋放由清單視圖控制項配置的資源。</span><span class="sxs-lookup"><span data-stu-id="6c111-147">Frees resources allocated by the list-view control.</span></span> <span data-ttu-id="6c111-148">除非使用 [**lvs) \_ SHAREIMAGELISTS**](list-view-window-styles.md) 樣式，這包括刪除完整大小和小型影像清單。</span><span class="sxs-lookup"><span data-stu-id="6c111-148">Unless the [**LVS\_SHAREIMAGELISTS**](list-view-window-styles.md) style is used, this includes deleting the full-sized and small image lists.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| <span data-ttu-id="6c111-149">**WM \_ 通知**</span><span class="sxs-lookup"><span data-stu-id="6c111-149">**WM\_NOTIFY**</span></span>           | <span data-ttu-id="6c111-150">處理標題控制項通知碼。</span><span class="sxs-lookup"><span data-stu-id="6c111-150">Processes header control notification codes.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| <span data-ttu-id="6c111-151">**WM \_ 油漆**</span><span class="sxs-lookup"><span data-stu-id="6c111-151">**WM\_PAINT**</span></span>            | <span data-ttu-id="6c111-152">顯示更新區域中的任何專案。</span><span class="sxs-lookup"><span data-stu-id="6c111-152">Displays any items in the update region.</span></span> <span data-ttu-id="6c111-153">針對回呼專案，控制項會先將 [LVN \_ GETDISPINFO](lvn-getdispinfo.md) 通知程式碼傳送至主控視窗，以要求顯示資訊。</span><span class="sxs-lookup"><span data-stu-id="6c111-153">For callback items, the control first sends an [LVN\_GETDISPINFO](lvn-getdispinfo.md) notification code to the owner window to request display information.</span></span> <span data-ttu-id="6c111-154">如果 *wParam* 參數不是 Null，則控制項會假設值為 HDC，並且使用該裝置內容繪製。</span><span class="sxs-lookup"><span data-stu-id="6c111-154">If the *wParam* parameter is non-NULL, the control assumes that the value is an HDC and paints using that device context.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| <span data-ttu-id="6c111-155">**WM \_ RBUTTONDOWN**</span><span class="sxs-lookup"><span data-stu-id="6c111-155">**WM\_RBUTTONDOWN**</span></span>      | <span data-ttu-id="6c111-156">其處理方式與 [**WM \_ LBUTTONDOWN**](/windows/desktop/inputdev/wm-lbuttondown) 訊息相同，不同之處在于控制項傳送了 [nm \_ RCLICK (清單)](nm-rclick-list-view.md) 通知碼 (而不是 [) \_ 按一下 (清單視圖)](nm-click-list-view.md) (和 [LVN \_ BEGINRDRAG](lvn-beginrdrag.md) 通知碼) ，而不是 [LVN \_ BEGINDRAG](lvn-begindrag.md) 。</span><span class="sxs-lookup"><span data-stu-id="6c111-156">Processed the same way as the [**WM\_LBUTTONDOWN**](/windows/desktop/inputdev/wm-lbuttondown) message, except that the control sends an [NM\_RCLICK (list view)](nm-rclick-list-view.md) notification code (instead of [NM\_CLICK (list view)](nm-click-list-view.md)) and an [LVN\_BEGINRDRAG](lvn-beginrdrag.md) notification code (instead of [LVN\_BEGINDRAG](lvn-begindrag.md)).</span></span> <span data-ttu-id="6c111-157">請注意，此控制項會處理對應的 [**WM \_ RBUTTONUP**](/windows/desktop/inputdev/wm-rbuttonup) 訊息，而不會將其分派。</span><span class="sxs-lookup"><span data-stu-id="6c111-157">Note that the control processes the corresponding [**WM\_RBUTTONUP**](/windows/desktop/inputdev/wm-rbuttonup) message, and does not dispatch it.</span></span> <span data-ttu-id="6c111-158">如此一來，應用程式就無法看到這個訊息，即使是子類別化控制項也一樣。</span><span class="sxs-lookup"><span data-stu-id="6c111-158">Applications thus cannot see this message, even by subclassing the control.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| <span data-ttu-id="6c111-159">**WM \_ SETFOCUS**</span><span class="sxs-lookup"><span data-stu-id="6c111-159">**WM\_SETFOCUS**</span></span>         | <span data-ttu-id="6c111-160">重新繪製焦點清單專案（如果有的話），並將 [NM \_ SETFOCUS](nm-setfocus.md) 的通知程式碼傳送至父視窗。</span><span class="sxs-lookup"><span data-stu-id="6c111-160">Repaints the focused list item, if any, and sends an [NM\_SETFOCUS](nm-setfocus.md) notification code to the parent window.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| <span data-ttu-id="6c111-161">**WM \_ SETFONT**</span><span class="sxs-lookup"><span data-stu-id="6c111-161">**WM\_SETFONT**</span></span>          | <span data-ttu-id="6c111-162">儲存指定的字型控制碼、將訊息轉送至頁首視窗（如果有的話），然後使用新字型重新繪製。</span><span class="sxs-lookup"><span data-stu-id="6c111-162">Saves the specified font handle, forwards the message to the header window, if any, and repaints using the new font.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| <span data-ttu-id="6c111-163">**WM \_ SETREDRAW**</span><span class="sxs-lookup"><span data-stu-id="6c111-163">**WM\_SETREDRAW**</span></span>        | <span data-ttu-id="6c111-164">開啟或關閉重繪。</span><span class="sxs-lookup"><span data-stu-id="6c111-164">Turns redrawing on or off.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| <span data-ttu-id="6c111-165">**WM \_ 計時器**</span><span class="sxs-lookup"><span data-stu-id="6c111-165">**WM\_TIMER**</span></span>            | <span data-ttu-id="6c111-166">開始編輯專案標籤。</span><span class="sxs-lookup"><span data-stu-id="6c111-166">Begins editing of an item label.</span></span> <span data-ttu-id="6c111-167">如果使用者按一下焦點專案的標籤，清單視圖控制項會設定計時器，而不是立即進入編輯模式。</span><span class="sxs-lookup"><span data-stu-id="6c111-167">If the user clicks the label of the focused item, the list-view control sets a timer instead of entering edit mode immediately.</span></span> <span data-ttu-id="6c111-168">如果使用者按兩下標籤，計時器可以讓清單視圖控制項 *不* 進入編輯模式。</span><span class="sxs-lookup"><span data-stu-id="6c111-168">The timer makes it possible for the list-view control to *not* enter edit mode if the user double-clicks the label.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| <span data-ttu-id="6c111-169">**WM \_ VSCROLL**</span><span class="sxs-lookup"><span data-stu-id="6c111-169">**WM\_VSCROLL**</span></span>          | <span data-ttu-id="6c111-170">垂直捲動清單視圖控制項。</span><span class="sxs-lookup"><span data-stu-id="6c111-170">Scrolls the list-view control vertically.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| <span data-ttu-id="6c111-171">**WM \_ WINDOWPOSCHANGED**</span><span class="sxs-lookup"><span data-stu-id="6c111-171">**WM\_WINDOWPOSCHANGED**</span></span> | <span data-ttu-id="6c111-172">更新視窗捲軸。</span><span class="sxs-lookup"><span data-stu-id="6c111-172">Updates the window scroll bars.</span></span> <span data-ttu-id="6c111-173">如果目前的視圖是圖示或小型圖示視圖，而且指定了 [**lvs) \_ AUTOARRANGE**](list-view-window-styles.md) 樣式，則清單視圖控制項也會排列清單專案。</span><span class="sxs-lookup"><span data-stu-id="6c111-173">If the current view is icon or small icon view, and the [**LVS\_AUTOARRANGE**](list-view-window-styles.md) style is specified, the list-view control will also arrange the list items.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| <span data-ttu-id="6c111-174">**WM \_ WININICHANGE**</span><span class="sxs-lookup"><span data-stu-id="6c111-174">**WM\_WININICHANGE**</span></span>     | <span data-ttu-id="6c111-175">處理系統計量的變更。</span><span class="sxs-lookup"><span data-stu-id="6c111-175">Processes changes to system metrics.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |



 

 

