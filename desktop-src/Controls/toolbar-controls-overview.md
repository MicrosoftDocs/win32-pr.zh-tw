---
title: 關於工具列控制項
description: 工具列是包含一或多個按鈕的控制項。
ms.assetid: b5a00a81-8d23-4844-8b0a-776e7cceced8
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 6f615da972f14bb88c4915504c089dd6b40d9aca
ms.sourcegitcommit: 0f7a8198bacd5493ab1e78a9583c7a3578794765
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 05/25/2021
ms.locfileid: "110424148"
---
# <a name="about-toolbar-controls"></a><span data-ttu-id="647f7-103">關於工具列控制項</span><span class="sxs-lookup"><span data-stu-id="647f7-103">About Toolbar Controls</span></span>

<span data-ttu-id="647f7-104">工具列是包含一或多個按鈕的控制項。</span><span class="sxs-lookup"><span data-stu-id="647f7-104">A toolbar is a control that contains one or more buttons.</span></span> <span data-ttu-id="647f7-105">當使用者按下每個按鈕時，會將命令訊息傳送至父視窗。</span><span class="sxs-lookup"><span data-stu-id="647f7-105">Each button, when clicked by a user, sends a command message to the parent window.</span></span> <span data-ttu-id="647f7-106">通常，工具列中的按鈕對應於應用程式功能表中的項目，為使用者提供其他更直接的方式來存取應用程式的命令。</span><span class="sxs-lookup"><span data-stu-id="647f7-106">Typically, the buttons in a toolbar correspond to items in the application's menu, providing an additional and more direct way for the user to access an application's commands.</span></span>

<span data-ttu-id="647f7-107">下列螢幕擷取畫面顯示一個視窗，其中包含檔案作業的簡單工具列。</span><span class="sxs-lookup"><span data-stu-id="647f7-107">The following screen shot shows a window that contains a simple toolbar for file operations.</span></span> <span data-ttu-id="647f7-108">應用程式已啟用視覺化樣式。</span><span class="sxs-lookup"><span data-stu-id="647f7-108">The application has enabled visual styles.</span></span> <span data-ttu-id="647f7-109">[儲存] 按鈕為「熱」，因為在拍攝螢幕擷取畫面時，游標停留在其上方。</span><span class="sxs-lookup"><span data-stu-id="647f7-109">The Save button is "hot" because the cursor was hovering over it when the screen shot was taken.</span></span> <span data-ttu-id="647f7-110">控制項的實際外觀會依據作業系統和使用者選取的主題而有所不同。</span><span class="sxs-lookup"><span data-stu-id="647f7-110">The actual appearance of the control varies depending on the operating system and the user-selected theme.</span></span>

![具有三個按鈕工具列之視窗的螢幕擷取畫面;一個按鈕是熱的](images/tb-withstyles.png)

<span data-ttu-id="647f7-112">下列螢幕擷取畫面顯示在未啟用視覺化樣式的情況下編譯之應用程式中的相同控制項。</span><span class="sxs-lookup"><span data-stu-id="647f7-112">The following screen shot shows the same control in an application that was compiled without visual styles enabled.</span></span>

![沒有視覺化樣式之視窗的螢幕擷取畫面：沒有任何按鈕看起來很熱](images/tb-wostyles.png)

<span data-ttu-id="647f7-114">下列主題討論在規劃工具列時要考慮的功能。</span><span class="sxs-lookup"><span data-stu-id="647f7-114">The following topics discuss features to consider when planning a toolbar.</span></span> <span data-ttu-id="647f7-115">如需有關執行的特定資訊和範例程式碼，請參閱 [使用工具列控制項](using-toolbar-controls.md)。</span><span class="sxs-lookup"><span data-stu-id="647f7-115">For specific information on implementation, and example code, see [Using Toolbar Controls](using-toolbar-controls.md).</span></span>

-   [<span data-ttu-id="647f7-116">指定工具列大小和位置</span><span class="sxs-lookup"><span data-stu-id="647f7-116">Specifying Toolbar Size and Position</span></span>](#specifying-toolbar-size-and-position)
-   [<span data-ttu-id="647f7-117">透明工具列</span><span class="sxs-lookup"><span data-stu-id="647f7-117">Transparent Toolbars</span></span>](#transparent-toolbars)
-   [<span data-ttu-id="647f7-118">清單樣式的工具列</span><span class="sxs-lookup"><span data-stu-id="647f7-118">List-style Toolbars</span></span>](#list-style-toolbars)
-   [<span data-ttu-id="647f7-119">定義按鈕影像</span><span class="sxs-lookup"><span data-stu-id="647f7-119">Defining Button Images</span></span>](#defining-button-images)
    -   [<span data-ttu-id="647f7-120">使用點陣圖定義按鈕影像</span><span class="sxs-lookup"><span data-stu-id="647f7-120">Defining Button Images by Using Bitmaps</span></span>](#defining-button-images-by-using-bitmaps)
    -   [<span data-ttu-id="647f7-121">使用影像清單定義按鈕影像</span><span class="sxs-lookup"><span data-stu-id="647f7-121">Defining Button Images by Using Image Lists</span></span>](#defining-button-images-by-using-image-lists)
-   [<span data-ttu-id="647f7-122">定義按鈕的文字</span><span class="sxs-lookup"><span data-stu-id="647f7-122">Defining Text for Buttons</span></span>](#defining-text-for-buttons)
-   [<span data-ttu-id="647f7-123">新增工具列按鈕</span><span class="sxs-lookup"><span data-stu-id="647f7-123">Adding Toolbar Buttons</span></span>](#adding-toolbar-buttons)
    -   [<span data-ttu-id="647f7-124">工具列按鈕樣式</span><span class="sxs-lookup"><span data-stu-id="647f7-124">Toolbar Button Styles</span></span>](#toolbar-button-styles)
    -   [<span data-ttu-id="647f7-125">工具列按鈕狀態</span><span class="sxs-lookup"><span data-stu-id="647f7-125">Toolbar Button States</span></span>](#toolbar-button-states)
    -   [<span data-ttu-id="647f7-126">命令識別碼</span><span class="sxs-lookup"><span data-stu-id="647f7-126">Command Identifier</span></span>](#command-identifier)
    -   [<span data-ttu-id="647f7-127">按鈕大小和位置</span><span class="sxs-lookup"><span data-stu-id="647f7-127">Button Size and Position</span></span>](#button-size-and-position)
-   [<span data-ttu-id="647f7-128">啟用自訂</span><span class="sxs-lookup"><span data-stu-id="647f7-128">Enabling Customization</span></span>](#enabling-customization)
-   [<span data-ttu-id="647f7-129">啟用熱追蹤</span><span class="sxs-lookup"><span data-stu-id="647f7-129">Enabling Hot-tracking</span></span>](#enabling-hot-tracking)

## <a name="specifying-toolbar-size-and-position"></a><span data-ttu-id="647f7-130">指定工具列大小和位置</span><span class="sxs-lookup"><span data-stu-id="647f7-130">Specifying Toolbar Size and Position</span></span>

<span data-ttu-id="647f7-131">如果您使用 [**CreateToolbarEx**](/windows/desktop/api/Commctrl/nf-commctrl-createtoolbarex)建立工具列，此函式可讓您以圖元為單位來指定工具列的高度和寬度。</span><span class="sxs-lookup"><span data-stu-id="647f7-131">If you create a toolbar using [**CreateToolbarEx**](/windows/desktop/api/Commctrl/nf-commctrl-createtoolbarex), the function enables you to specify in pixels the height and width of the toolbar.</span></span>

> [!Note]  
> <span data-ttu-id="647f7-132">不建議使用 [**CreateToolbarEx**](/windows/desktop/api/Commctrl/nf-commctrl-createtoolbarex) ，因為它不支援工具列的新功能，包括影像清單。</span><span class="sxs-lookup"><span data-stu-id="647f7-132">Using [**CreateToolbarEx**](/windows/desktop/api/Commctrl/nf-commctrl-createtoolbarex) is not recommended, as it does not support new features of toolbars, including image lists.</span></span> <span data-ttu-id="647f7-133">如需建立工具列的詳細資訊，請參閱 [使用工具列控制項](using-toolbar-controls.md)。</span><span class="sxs-lookup"><span data-stu-id="647f7-133">For more information about creating toolbars, see [Using Toolbar Controls](using-toolbar-controls.md).</span></span>

 

<span data-ttu-id="647f7-134">[**CreateWindowEx**](/windows/desktop/api/winuser/nf-winuser-createwindowexa)函式沒有可指定工具列大小的參數。</span><span class="sxs-lookup"><span data-stu-id="647f7-134">The [**CreateWindowEx**](/windows/desktop/api/winuser/nf-winuser-createwindowexa) function does not have parameters for specifying toolbar size.</span></span> <span data-ttu-id="647f7-135">工具列視窗程式會自動設定工具列視窗的大小和位置。</span><span class="sxs-lookup"><span data-stu-id="647f7-135">The toolbar window procedure automatically sets the size and position of the toolbar window.</span></span> <span data-ttu-id="647f7-136">高度是以工具列中按鈕的高度為基礎。</span><span class="sxs-lookup"><span data-stu-id="647f7-136">The height is based on the height of the buttons in the toolbar.</span></span> <span data-ttu-id="647f7-137">寬度與父視窗工作區的寬度相同。</span><span class="sxs-lookup"><span data-stu-id="647f7-137">The width is the same as the width of the parent window's client area.</span></span> <span data-ttu-id="647f7-138">若要變更自動調整規模設定，請傳送 [**TB 的 \_ SETBUTTONSIZE**](tb-setbuttonsize.md) 訊息。</span><span class="sxs-lookup"><span data-stu-id="647f7-138">To change the automatic size settings, send a [**TB\_SETBUTTONSIZE**](tb-setbuttonsize.md) message.</span></span> <span data-ttu-id="647f7-139">[ [**CCS \_ TOP**](common-control-styles.md) ] 和 [ [**CCS] \_ 下方**](common-control-styles.md) 的 [常用] 控制項樣式可決定工具列是否位於工作區的頂端或底部。</span><span class="sxs-lookup"><span data-stu-id="647f7-139">The [**CCS\_TOP**](common-control-styles.md) and [**CCS\_BOTTOM**](common-control-styles.md) common control styles determine whether the toolbar is positioned along the top or bottom of the client area.</span></span> <span data-ttu-id="647f7-140">依預設，工具列具有 CCS 的 **\_ 最上層** 樣式。</span><span class="sxs-lookup"><span data-stu-id="647f7-140">By default, a toolbar has the **CCS\_TOP** style.</span></span>

<span data-ttu-id="647f7-141">此外，工具列視窗程式會在每次收到 [**WM \_ 大小**](/windows/desktop/winmsg/wm-size) 或 TB 的自動 [**\_ 調整**](tb-autosize.md) 訊息時，自動調整工具列的大小。</span><span class="sxs-lookup"><span data-stu-id="647f7-141">Also, the toolbar window procedure automatically adjusts the size of the toolbar whenever it receives a [**WM\_SIZE**](/windows/desktop/winmsg/wm-size) or [**TB\_AUTOSIZE**](tb-autosize.md) message.</span></span> <span data-ttu-id="647f7-142">每當父視窗的大小變更時，或傳送需要調整工具列大小的訊息（例如， [**TB \_ SETBUTTONSIZE**](tb-setbuttonsize.md) 訊息）之後，應用程式就應該傳送這些訊息中的任一個。</span><span class="sxs-lookup"><span data-stu-id="647f7-142">An application should send either of these messages whenever the size of the parent window changes or after sending a message that requires adjusting the size of the toolbar—for example, a [**TB\_SETBUTTONSIZE**](tb-setbuttonsize.md) message.</span></span>

<span data-ttu-id="647f7-143">您可以藉由設定 [**CCS \_ NORESIZE**](common-control-styles.md) 和 [**CCS \_ NOPARENTALIGN**](common-control-styles.md) 通用控制項樣式來關閉工具列預設大小調整和定位行為。</span><span class="sxs-lookup"><span data-stu-id="647f7-143">The toolbar default sizing and positioning behaviors can be turned off by setting the [**CCS\_NORESIZE**](common-control-styles.md) and [**CCS\_NOPARENTALIGN**](common-control-styles.md) common control styles.</span></span> <span data-ttu-id="647f7-144">Rebar 控制項所裝載的工具列控制項必須設定這些樣式，因為 Rebar 控制項的大小和定位工具列。</span><span class="sxs-lookup"><span data-stu-id="647f7-144">Toolbar controls that are hosted by rebar controls must set these styles because the rebar control sizes and positions the toolbar.</span></span>

## <a name="transparent-toolbars"></a><span data-ttu-id="647f7-145">透明工具列</span><span class="sxs-lookup"><span data-stu-id="647f7-145">Transparent Toolbars</span></span>

<span data-ttu-id="647f7-146">Toolbar 控制項支援可讓工具列下的工作區顯示的透明外觀。</span><span class="sxs-lookup"><span data-stu-id="647f7-146">Toolbar controls support a transparent look that allows the client area under the toolbar to show through.</span></span> <span data-ttu-id="647f7-147">有兩種透明的工具列，其中有一個具有平面按鈕的透明工具列，以及一個具有三維按鈕的工具列。</span><span class="sxs-lookup"><span data-stu-id="647f7-147">There are two kinds of transparent toolbars, ones with flat buttons and ones with three-dimensional buttons.</span></span> <span data-ttu-id="647f7-148">如果您想要讓應用程式符合 Windows 介面，請使用「一般透明樣式」工具列。</span><span class="sxs-lookup"><span data-stu-id="647f7-148">If you want your application to match the Windows interface, use the flat transparent style toolbar.</span></span>

<span data-ttu-id="647f7-149">下列螢幕擷取畫面顯示兩種透明工具列，而不是使用視覺化樣式。</span><span class="sxs-lookup"><span data-stu-id="647f7-149">The following screen shot shows the two kinds of transparent toolbars, not using visual styles.</span></span>

![兩個視窗的螢幕擷取畫面，其中包含不同樣式的工具列，但兩個工具列都是透明的](images/toolbartrans.jpg)

<span data-ttu-id="647f7-151">下列螢幕擷取畫面顯示透明工具列，因為它可能會出現在 Windows Vista 中，並啟用視覺化樣式。</span><span class="sxs-lookup"><span data-stu-id="647f7-151">The following screen shot shows a transparent toolbar as it might appear in Windows Vista, with visual styles enabled.</span></span> <span data-ttu-id="647f7-152">對話方塊的背景色彩已變更，使透明度更明顯。</span><span class="sxs-lookup"><span data-stu-id="647f7-152">The background color of the dialog box has been changed to make the transparency more obvious.</span></span>

![windows vista 中具有透明工具列之視窗的螢幕擷取畫面](images/tb-transparent.png)

<span data-ttu-id="647f7-154">若要建立透明的工具列，您只需要在 [**CreateWindowEx**](/windows/desktop/api/winuser/nf-winuser-createwindowexa)的視窗樣式參數中加入 TBSTYLE 的 [一般] 或 [ [**TBSTYLE \_**](toolbar-control-and-button-styles.md) ]。 [**\_**](toolbar-control-and-button-styles.md)</span><span class="sxs-lookup"><span data-stu-id="647f7-154">To create a transparent toolbar, all you need to do is add [**TBSTYLE\_FLAT**](toolbar-control-and-button-styles.md) or [**TBSTYLE\_TRANSPARENT**](toolbar-control-and-button-styles.md) to the window style parameter of [**CreateWindowEx**](/windows/desktop/api/winuser/nf-winuser-createwindowexa).</span></span> <span data-ttu-id="647f7-155">如果您不想讓一行出現來指出工具列底部，請勿使用 [ [**WS \_ 框線**](/windows/desktop/winmsg/window-styles) 視窗樣式]。</span><span class="sxs-lookup"><span data-stu-id="647f7-155">If you do not want a line to appear to indicate the bottom of the toolbar, do not use the [**WS\_BORDER**](/windows/desktop/winmsg/window-styles) window style.</span></span>

> [!Note]  
> <span data-ttu-id="647f7-156">使用視覺化樣式時，工具列預設可能是平面的。</span><span class="sxs-lookup"><span data-stu-id="647f7-156">When using visual styles, toolbars may be flat by default.</span></span>

 

## <a name="list-style-toolbars"></a><span data-ttu-id="647f7-157">清單樣式的工具列</span><span class="sxs-lookup"><span data-stu-id="647f7-157">List-style Toolbars</span></span>

<span data-ttu-id="647f7-158">工具列按鈕可讓您同時顯示文字和點陣圖。</span><span class="sxs-lookup"><span data-stu-id="647f7-158">Toolbar buttons enable you to display both text and bitmaps.</span></span> <span data-ttu-id="647f7-159">使用 [**TBSTYLE \_ 清單**](toolbar-control-and-button-styles.md) 樣式建立的工具列上的按鈕，會將文字放到點陣圖右邊，而不是在其下。</span><span class="sxs-lookup"><span data-stu-id="647f7-159">The buttons on a toolbar created with the [**TBSTYLE\_LIST**](toolbar-control-and-button-styles.md) style place text to the right of the bitmap instead of under it.</span></span>

<span data-ttu-id="647f7-160">下列螢幕擷取畫面顯示具有清單樣式的工具列。</span><span class="sxs-lookup"><span data-stu-id="647f7-160">The following screen shot shows a toolbar with the list style.</span></span>

![具有每個圖示右邊文字的工具列螢幕擷取畫面](images/tb-liststyle.png)

<span data-ttu-id="647f7-162">您可以搭配使用 [ [**TBSTYLE] \_ 清單**](toolbar-control-and-button-styles.md) 工具列樣式與 [ [**TBSTYLE] \_ 平面**](toolbar-control-and-button-styles.md) 樣式，建立具有平面按鈕的工具列。</span><span class="sxs-lookup"><span data-stu-id="647f7-162">You can use the [**TBSTYLE\_LIST**](toolbar-control-and-button-styles.md) toolbar style in combination with the [**TBSTYLE\_FLAT**](toolbar-control-and-button-styles.md) style to create a toolbar with flat buttons.</span></span>

## <a name="defining-button-images"></a><span data-ttu-id="647f7-163">定義按鈕影像</span><span class="sxs-lookup"><span data-stu-id="647f7-163">Defining Button Images</span></span>

<span data-ttu-id="647f7-164">有兩種方式可以指定按鈕的影像：依點陣圖或影像清單。</span><span class="sxs-lookup"><span data-stu-id="647f7-164">There are two ways to specify the images for buttons—by bitmaps or by image lists.</span></span> <span data-ttu-id="647f7-165">應用程式必須選擇要使用的方法。</span><span class="sxs-lookup"><span data-stu-id="647f7-165">An application must choose which method to use.</span></span> <span data-ttu-id="647f7-166">它無法同時使用這兩種方法與相同的工具列控制項。</span><span class="sxs-lookup"><span data-stu-id="647f7-166">It cannot use both methods with the same toolbar control.</span></span> <span data-ttu-id="647f7-167">請注意， [**CreateToolbarEx**](/windows/desktop/api/Commctrl/nf-commctrl-createtoolbarex) 函數會使用 bitmap 方法。</span><span class="sxs-lookup"><span data-stu-id="647f7-167">Note that the [**CreateToolbarEx**](/windows/desktop/api/Commctrl/nf-commctrl-createtoolbarex) function uses the bitmap method.</span></span> <span data-ttu-id="647f7-168">想要使用影像清單方法的應用程式必須使用 [**CreateWindowEx**](/windows/desktop/api/winuser/nf-winuser-createwindowexa) 函式來建立工具列控制項。</span><span class="sxs-lookup"><span data-stu-id="647f7-168">Applications that want to use the image list method must use the [**CreateWindowEx**](/windows/desktop/api/winuser/nf-winuser-createwindowexa) function to create the toolbar control.</span></span>

### <a name="defining-button-images-by-using-bitmaps"></a><span data-ttu-id="647f7-169">使用點陣圖定義按鈕影像</span><span class="sxs-lookup"><span data-stu-id="647f7-169">Defining Button Images by Using Bitmaps</span></span>

<span data-ttu-id="647f7-170">工具列中的每個按鈕都可以包含點陣圖影像。</span><span class="sxs-lookup"><span data-stu-id="647f7-170">Each button in a toolbar can include a bitmapped image.</span></span> <span data-ttu-id="647f7-171">工具列會使用內部清單來儲存繪製影像所需的資訊。</span><span class="sxs-lookup"><span data-stu-id="647f7-171">A toolbar uses an internal list to store the information that it needs to draw the images.</span></span> <span data-ttu-id="647f7-172">當您呼叫 [**CreateToolbarEx**](/windows/desktop/api/Commctrl/nf-commctrl-createtoolbarex) 函式時，您會指定包含初始影像的單色或色彩點陣圖，而工具列會將資訊新增至影像的內部清單。</span><span class="sxs-lookup"><span data-stu-id="647f7-172">When you call the [**CreateToolbarEx**](/windows/desktop/api/Commctrl/nf-commctrl-createtoolbarex) function, you specify a monochrome or color bitmap that contains the initial images, and the toolbar adds the information to the internal list of images.</span></span> <span data-ttu-id="647f7-173">您稍後可以使用 [**TB \_ ADDBITMAP**](tb-addbitmap.md) 訊息來新增其他映射。</span><span class="sxs-lookup"><span data-stu-id="647f7-173">You can add additional images later by using the [**TB\_ADDBITMAP**](tb-addbitmap.md) message.</span></span>

<span data-ttu-id="647f7-174">每個映射都有以零為基底的索引。</span><span class="sxs-lookup"><span data-stu-id="647f7-174">Each image has a zero-based index.</span></span> <span data-ttu-id="647f7-175">新增至內部清單的第一個影像的索引為0，第二個影像的索引為1，依此類推。</span><span class="sxs-lookup"><span data-stu-id="647f7-175">The first image added to the internal list has an index of 0, the second image has an index of 1, and so on.</span></span> <span data-ttu-id="647f7-176">[**TB \_ADDBITMAP**](tb-addbitmap.md) 會將影像新增至清單的結尾，並傳回它所新增之第一個新映射的索引。</span><span class="sxs-lookup"><span data-stu-id="647f7-176">[**TB\_ADDBITMAP**](tb-addbitmap.md) adds images to the end of the list and returns the index of the first new image that it added.</span></span> <span data-ttu-id="647f7-177">若要將影像與按鈕建立關聯，您必須在將點陣圖新增至內部影像清單之後傳送 [**TB \_ ADDBUTTONS**](tb-addbuttons.md) 訊息，並指定映射的索引。</span><span class="sxs-lookup"><span data-stu-id="647f7-177">To associate the image with a button, you must send a [**TB\_ADDBUTTONS**](tb-addbuttons.md) message and specify the image's index after you add bitmaps to the internal image list.</span></span>

<span data-ttu-id="647f7-178">Windows 假設所有工具列的點陣圖影像大小都相同。</span><span class="sxs-lookup"><span data-stu-id="647f7-178">Windows assumes that all of a toolbar's bitmapped images are the same size.</span></span> <span data-ttu-id="647f7-179">您可以使用 [**CreateToolbarEx**](/windows/desktop/api/Commctrl/nf-commctrl-createtoolbarex)來指定建立工具列時的大小。</span><span class="sxs-lookup"><span data-stu-id="647f7-179">You specify the size when you create the toolbar by using [**CreateToolbarEx**](/windows/desktop/api/Commctrl/nf-commctrl-createtoolbarex).</span></span> <span data-ttu-id="647f7-180">如果您使用 [**CreateWindowEx**](/windows/desktop/api/winuser/nf-winuser-createwindowexa) 函式來建立工具列，影像的大小會設定為預設維度 16 x 15 圖元。</span><span class="sxs-lookup"><span data-stu-id="647f7-180">If you use the [**CreateWindowEx**](/windows/desktop/api/winuser/nf-winuser-createwindowexa) function to create a toolbar, the size of the images is set to the default dimensions of 16 by 15 pixels.</span></span> <span data-ttu-id="647f7-181">您可以使用 [**TB 的 \_ SETBITMAPSIZE**](tb-setbitmapsize.md) 訊息來變更點陣圖影像的維度，但您必須先執行此動作，才能將任何影像新增至內部清單。</span><span class="sxs-lookup"><span data-stu-id="647f7-181">You can use the [**TB\_SETBITMAPSIZE**](tb-setbitmapsize.md) message to change the dimensions of the bitmapped images, but you must do so before adding any images to the internal list.</span></span>

### <a name="defining-button-images-by-using-image-lists"></a><span data-ttu-id="647f7-182">使用影像清單定義按鈕影像</span><span class="sxs-lookup"><span data-stu-id="647f7-182">Defining Button Images by Using Image Lists</span></span>

<span data-ttu-id="647f7-183">您也可以將按鈕影像儲存在一組 [影像清單](image-lists.md)中。</span><span class="sxs-lookup"><span data-stu-id="647f7-183">You can also store button images in a set of [Image Lists](image-lists.md).</span></span> <span data-ttu-id="647f7-184">影像清單是相同大小的影像集合，每個影像都可由其索引參考。</span><span class="sxs-lookup"><span data-stu-id="647f7-184">An image list is a collection of images of the same size, each of which can be referred to by its index.</span></span> <span data-ttu-id="647f7-185">影像清單可用來管理大型的圖示或點陣圖集。</span><span class="sxs-lookup"><span data-stu-id="647f7-185">Image lists are used to manage large sets of icons or bitmaps.</span></span> <span data-ttu-id="647f7-186">您最多可以使用三個不同的影像清單來顯示各種狀態下的按鈕，如下表所示。</span><span class="sxs-lookup"><span data-stu-id="647f7-186">You can use up to three different image lists to display buttons in various states, as shown in the following table.</span></span>



|  <span data-ttu-id="647f7-187">州</span><span class="sxs-lookup"><span data-stu-id="647f7-187">State</span></span>        |  <span data-ttu-id="647f7-188">描述</span><span class="sxs-lookup"><span data-stu-id="647f7-188">Description</span></span>                                                                                                                                                                                            |
|----------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="647f7-189">正常</span><span class="sxs-lookup"><span data-stu-id="647f7-189">Normal</span></span>   | <span data-ttu-id="647f7-190">處於預設狀態的按鈕。</span><span class="sxs-lookup"><span data-stu-id="647f7-190">Buttons in their default state.</span></span>                                                                                                                                                              |
| <span data-ttu-id="647f7-191">經常性存取層</span><span class="sxs-lookup"><span data-stu-id="647f7-191">Hot</span></span>      | <span data-ttu-id="647f7-192">指標或按下的按鈕。</span><span class="sxs-lookup"><span data-stu-id="647f7-192">Buttons that are under the pointer or pressed.</span></span> <span data-ttu-id="647f7-193">只有具有 [**TBSTYLE \_ 平面**](toolbar-control-and-button-styles.md) 樣式的工具列控制項才支援熱專案。</span><span class="sxs-lookup"><span data-stu-id="647f7-193">Hot items are supported only in toolbar controls that have the [**TBSTYLE\_FLAT**](toolbar-control-and-button-styles.md) style.</span></span> |
| <span data-ttu-id="647f7-194">停用</span><span class="sxs-lookup"><span data-stu-id="647f7-194">Disabled</span></span> | <span data-ttu-id="647f7-195">已停用的按鈕。</span><span class="sxs-lookup"><span data-stu-id="647f7-195">Buttons that are disabled.</span></span>                                                                                                                                                                   |



 

<span data-ttu-id="647f7-196">終結工具列之後，應用程式必須釋放任何已建立的影像清單。</span><span class="sxs-lookup"><span data-stu-id="647f7-196">After the toolbar is destroyed, applications must free any image lists they have created.</span></span>

## <a name="defining-text-for-buttons"></a><span data-ttu-id="647f7-197">定義按鈕的文字</span><span class="sxs-lookup"><span data-stu-id="647f7-197">Defining Text for Buttons</span></span>

<span data-ttu-id="647f7-198">除了影像之外，每個按鈕都可以顯示字串，而不是。</span><span class="sxs-lookup"><span data-stu-id="647f7-198">Each button can display a string in addition to, or instead of, an image.</span></span> <span data-ttu-id="647f7-199">工具列會維護內部清單，其中包含工具列按鈕的所有可用字串。</span><span class="sxs-lookup"><span data-stu-id="647f7-199">A toolbar maintains an internal list that contains all the strings available to toolbar buttons.</span></span> <span data-ttu-id="647f7-200">您可以使用 [**TB \_ ADDSTRING**](tb-addstring.md) 訊息將字串加入至內部清單，指定包含要加入之字串的緩衝區位址。</span><span class="sxs-lookup"><span data-stu-id="647f7-200">You add strings to the internal list by using the [**TB\_ADDSTRING**](tb-addstring.md) message, specifying the address of the buffer containing the strings to add.</span></span> <span data-ttu-id="647f7-201">每個字串都必須以 null 終止，而最後一個字串必須以兩個 null 字元結束。</span><span class="sxs-lookup"><span data-stu-id="647f7-201">Each string must be null-terminated, and the last string must be terminated with two null characters.</span></span>

<span data-ttu-id="647f7-202">每個字串都有以零為基底的索引。</span><span class="sxs-lookup"><span data-stu-id="647f7-202">Each string has a zero-based index.</span></span> <span data-ttu-id="647f7-203">新增至字串內部清單的第一個字串的索引為0，第二個字串的索引為1，依此類推。</span><span class="sxs-lookup"><span data-stu-id="647f7-203">The first string added to the internal list of strings has an index of 0, the second string has an index of 1, and so on.</span></span> <span data-ttu-id="647f7-204">[**TB \_ADDSTRING**](tb-addstring.md) 會將字串加入至清單的結尾，並傳回第一個新字串的索引。</span><span class="sxs-lookup"><span data-stu-id="647f7-204">[**TB\_ADDSTRING**](tb-addstring.md) adds strings to the end of the list and returns the index of the first new string.</span></span> <span data-ttu-id="647f7-205">您可以使用字串的索引，將字串與按鈕產生關聯。</span><span class="sxs-lookup"><span data-stu-id="647f7-205">You use a string's index to associate the string with a button.</span></span>

<span data-ttu-id="647f7-206">使用 [**TB \_ ADDSTRING**](tb-addstring.md) 並非將字串新增至工具列的唯一方法。</span><span class="sxs-lookup"><span data-stu-id="647f7-206">Using [**TB\_ADDSTRING**](tb-addstring.md) is not the only way to add strings to a toolbar.</span></span> <span data-ttu-id="647f7-207">您可以在傳遞至 [**TB \_ ADDBUTTONS**](tb-addbuttons.md)之 [**TBBUTTON**](/windows/desktop/api/Commctrl/ns-commctrl-tbbutton)結構的 **iString** 成員中傳遞字串指標，藉以在按鈕中顯示字串。</span><span class="sxs-lookup"><span data-stu-id="647f7-207">You can display a string in a button by passing a string pointer in the **iString** member of the [**TBBUTTON**](/windows/desktop/api/Commctrl/ns-commctrl-tbbutton) structure that is passed to [**TB\_ADDBUTTONS**](tb-addbuttons.md).</span></span> <span data-ttu-id="647f7-208">此外，您可以使用 [**TB \_ SETBUTTONINFO**](tb-setbuttoninfo.md) 將文字指派給工具列按鈕。</span><span class="sxs-lookup"><span data-stu-id="647f7-208">Additionally, you can use [**TB\_SETBUTTONINFO**](tb-setbuttoninfo.md) to assign text to a toolbar button.</span></span>

## <a name="adding-toolbar-buttons"></a><span data-ttu-id="647f7-209">新增工具列按鈕</span><span class="sxs-lookup"><span data-stu-id="647f7-209">Adding Toolbar Buttons</span></span>

<span data-ttu-id="647f7-210">如果您使用 [**CreateToolbarEx**](/windows/desktop/api/Commctrl/nf-commctrl-createtoolbarex) 函式來建立工具列，則可以將按鈕加入至工具列，方法是填入 [**TBBUTTON**](/windows/desktop/api/Commctrl/ns-commctrl-tbbutton) 結構的陣列，並在函式呼叫中指定陣列的位址。</span><span class="sxs-lookup"><span data-stu-id="647f7-210">If you use the [**CreateToolbarEx**](/windows/desktop/api/Commctrl/nf-commctrl-createtoolbarex) function to create a toolbar, you can add buttons to the toolbar by filling an array of [**TBBUTTON**](/windows/desktop/api/Commctrl/ns-commctrl-tbbutton) structures and specifying the address of the array in the function call.</span></span> <span data-ttu-id="647f7-211">不過， [**CreateWindowEx**](/windows/desktop/api/winuser/nf-winuser-createwindowexa) 函式沒有可傳遞 **TBBUTTON** 結構的參數。</span><span class="sxs-lookup"><span data-stu-id="647f7-211">However, the [**CreateWindowEx**](/windows/desktop/api/winuser/nf-winuser-createwindowexa) function does not have a parameter for passing a **TBBUTTON** structure.</span></span> <span data-ttu-id="647f7-212">**CreateWindowEx** 會建立一個空白工具列，您可以藉由傳送 [**TB \_ ADDBUTTONS**](tb-addbuttons.md) 訊息來填滿，並指定 **TBBUTTON** 結構的位址。</span><span class="sxs-lookup"><span data-stu-id="647f7-212">**CreateWindowEx** creates an empty toolbar that you fill by sending a [**TB\_ADDBUTTONS**](tb-addbuttons.md) message, specifying the address of a **TBBUTTON** structure.</span></span>

<span data-ttu-id="647f7-213">建立工具列之後，您可以藉由傳送 [**tb \_ INSERTBUTTON**](tb-insertbutton.md) 或 [**tb \_ ADDBUTTONS**](tb-addbuttons.md) 訊息來新增按鈕。</span><span class="sxs-lookup"><span data-stu-id="647f7-213">After a toolbar is created, you can add buttons by sending a [**TB\_INSERTBUTTON**](tb-insertbutton.md) or [**TB\_ADDBUTTONS**](tb-addbuttons.md) message.</span></span> <span data-ttu-id="647f7-214">每個按鈕都會以 [**TBBUTTON**](/windows/desktop/api/Commctrl/ns-commctrl-tbbutton) 結構描述，此結構會定義按鈕的屬性，包括其字串和點陣圖的索引，以及其樣式、狀態、命令識別碼和應用程式定義的32位值。</span><span class="sxs-lookup"><span data-stu-id="647f7-214">Each button is described by a [**TBBUTTON**](/windows/desktop/api/Commctrl/ns-commctrl-tbbutton) structure, which defines the attributes of the button, including the indexes of its string and bitmap as well as its style, state, command identifier, and application-defined 32-bit value.</span></span>

> [!Note]  
> <span data-ttu-id="647f7-215">如果您使用 [**CreateWindowEx**](/windows/desktop/api/winuser/nf-winuser-createwindowexa) 函式來建立工具列，則必須在新增任何按鈕之前傳送 [**TB \_ BUTTONSTRUCTSIZE**](tb-buttonstructsize.md) 訊息。</span><span class="sxs-lookup"><span data-stu-id="647f7-215">If you use the [**CreateWindowEx**](/windows/desktop/api/winuser/nf-winuser-createwindowexa) function to create a toolbar, you must send the [**TB\_BUTTONSTRUCTSIZE**](tb-buttonstructsize.md) message before adding any buttons.</span></span> <span data-ttu-id="647f7-216">訊息會將 [**TBBUTTON**](/windows/desktop/api/Commctrl/ns-commctrl-tbbutton) 結構的大小傳遞給工具列。</span><span class="sxs-lookup"><span data-stu-id="647f7-216">The message passes the size of the [**TBBUTTON**](/windows/desktop/api/Commctrl/ns-commctrl-tbbutton) structure to the toolbar.</span></span>

 

### <a name="toolbar-button-styles"></a><span data-ttu-id="647f7-217">工具列按鈕樣式</span><span class="sxs-lookup"><span data-stu-id="647f7-217">Toolbar Button Styles</span></span>

<span data-ttu-id="647f7-218">按鈕的樣式可決定按鈕的顯示方式，以及它如何回應使用者輸入。</span><span class="sxs-lookup"><span data-stu-id="647f7-218">A button's style determines how the button appears and how it responds to user input.</span></span> <span data-ttu-id="647f7-219">例如，[ [**BTNS] \_ 按鈕**](toolbar-control-and-button-styles.md) 樣式建立的工具列按鈕，其行為類似標準的 [推送] 按鈕。</span><span class="sxs-lookup"><span data-stu-id="647f7-219">For instance, the [**BTNS\_BUTTON**](toolbar-control-and-button-styles.md) style creates a toolbar button that behaves like a standard push button.</span></span> <span data-ttu-id="647f7-220">具有 [**BTNS \_ 檢查**](toolbar-control-and-button-styles.md) 樣式的按鈕類似于標準推播按鈕，不同之處在于它會在每次使用者按一下時，于按下和 nonpressed 狀態之間切換。</span><span class="sxs-lookup"><span data-stu-id="647f7-220">A button that has the [**BTNS\_CHECK**](toolbar-control-and-button-styles.md) style is similar to a standard push button, except it toggles between the pressed and nonpressed states each time the user clicks it.</span></span>

<span data-ttu-id="647f7-221">您可以使用 [**BTNS \_ GROUP**](toolbar-control-and-button-styles.md) 或 [**BTNS \_ CHECKGROUP**](toolbar-control-and-button-styles.md) 樣式，建立與選項按鈕類似的工具列按鈕群組。</span><span class="sxs-lookup"><span data-stu-id="647f7-221">You can create groups of toolbar buttons that act like radio buttons by using the [**BTNS\_GROUP**](toolbar-control-and-button-styles.md) or [**BTNS\_CHECKGROUP**](toolbar-control-and-button-styles.md) style.</span></span> <span data-ttu-id="647f7-222">這會讓按鈕保持按下狀態，直到使用者選擇群組中的另一個按鈕為止。</span><span class="sxs-lookup"><span data-stu-id="647f7-222">This causes a button to stay pressed until the user chooses another button in the group.</span></span> <span data-ttu-id="647f7-223">群組會定義為連續的按鈕集合，全部都有 **BTNS \_ Group** 或 **BTNS \_ CHECKGROUP** 樣式。</span><span class="sxs-lookup"><span data-stu-id="647f7-223">A group is defined as a contiguous collection of buttons, all with the **BTNS\_GROUP** or **BTNS\_CHECKGROUP** style.</span></span>

<span data-ttu-id="647f7-224">[**BTNS \_ SEP**](toolbar-control-and-button-styles.md)樣式會建立按鈕之間的小間距，或在一般工具列上的按鈕之間繪製 etch 若。</span><span class="sxs-lookup"><span data-stu-id="647f7-224">The [**BTNS\_SEP**](toolbar-control-and-button-styles.md) style creates a small gap between buttons or draws an etch between buttons on flat toolbars.</span></span> <span data-ttu-id="647f7-225">具有 **BTNS \_ SEP** 樣式的按鈕不會接收使用者輸入。</span><span class="sxs-lookup"><span data-stu-id="647f7-225">A button with the **BTNS\_SEP** style does not receive user input.</span></span>

<span data-ttu-id="647f7-226">版本5.80 的通用控制項引進了一些新的工具列按鈕樣式，並重新命名一些較舊的樣式。</span><span class="sxs-lookup"><span data-stu-id="647f7-226">Version 5.80 of the common controls introduced some new toolbar button styles and renamed some of the older styles.</span></span> <span data-ttu-id="647f7-227">所有按鈕樣式旗標現在都以 BTNS xxx 開頭， \_ 而不是 TBSTYLE \_ xxx。</span><span class="sxs-lookup"><span data-stu-id="647f7-227">All button style flags now begin with BTNS\_XXX instead of TBSTYLE\_XXX.</span></span> <span data-ttu-id="647f7-228">如需按鈕樣式的清單和討論，請參閱 [工具列控制項和按鈕樣式](toolbar-control-and-button-styles.md)。</span><span class="sxs-lookup"><span data-stu-id="647f7-228">For a listing and discussion of the button styles, see [Toolbar Control and Button Styles](toolbar-control-and-button-styles.md).</span></span>

### <a name="toolbar-button-states"></a><span data-ttu-id="647f7-229">工具列按鈕狀態</span><span class="sxs-lookup"><span data-stu-id="647f7-229">Toolbar Button States</span></span>

<span data-ttu-id="647f7-230">工具列中的每個按鈕都有一個狀態。</span><span class="sxs-lookup"><span data-stu-id="647f7-230">Each button in a toolbar has a state.</span></span> <span data-ttu-id="647f7-231">工具列會更新按鈕的狀態，以反映使用者動作，例如按一下按鈕。</span><span class="sxs-lookup"><span data-stu-id="647f7-231">The toolbar updates a button's state to reflect user actions, such as clicking the button.</span></span> <span data-ttu-id="647f7-232">狀態會指出按鈕目前為按下或未按下、啟用或停用、隱藏或顯示。</span><span class="sxs-lookup"><span data-stu-id="647f7-232">The state indicates whether the button is currently pressed or not pressed, enabled or disabled, hidden or visible.</span></span> <span data-ttu-id="647f7-233">雖然應用程式會在將按鈕新增至工具列時設定按鈕的初始狀態，但它可以藉由將 [**tb \_ >getstate**](tb-getstate.md) 和 [**tb \_ SETSTATE**](tb-setstate.md) 訊息傳送至工具列，來變更和取得狀態。</span><span class="sxs-lookup"><span data-stu-id="647f7-233">Although an application sets a button's initial state when adding the button to the toolbar, it can change and retrieve the state by sending [**TB\_GETSTATE**](tb-getstate.md) and [**TB\_SETSTATE**](tb-setstate.md) messages to the toolbar.</span></span> <span data-ttu-id="647f7-234">如需工具列按鈕狀態的清單，請參閱 [工具列狀態](toolbar-button-states.md)。</span><span class="sxs-lookup"><span data-stu-id="647f7-234">For a list of toolbar button states, see [Toolbar States](toolbar-button-states.md).</span></span>

### <a name="command-identifier"></a><span data-ttu-id="647f7-235">命令識別碼</span><span class="sxs-lookup"><span data-stu-id="647f7-235">Command Identifier</span></span>

<span data-ttu-id="647f7-236">每個按鈕都有與其相關聯的應用程式定義命令識別碼。</span><span class="sxs-lookup"><span data-stu-id="647f7-236">Each button has an application-defined command identifier associated with it.</span></span> <span data-ttu-id="647f7-237">按鈕識別碼通常是在應用程式標頭檔中定義。</span><span class="sxs-lookup"><span data-stu-id="647f7-237">Button identifiers are usually defined in an application header file.</span></span> <span data-ttu-id="647f7-238">例如，[貼上] 按鈕可以定義為：</span><span class="sxs-lookup"><span data-stu-id="647f7-238">For example, a Paste button can be defined as:</span></span>


```
#define ID_PASTE 100
```



<span data-ttu-id="647f7-239">當使用者選取按鈕時，工具列會將包含按鈕命令識別碼的 [**wm \_ 命令**](/windows/desktop/menurc/wm-command) 或 [**wm \_ 通知**](wm-notify.md) 訊息傳送至父視窗。</span><span class="sxs-lookup"><span data-stu-id="647f7-239">When the user selects a button, the toolbar sends the parent window a [**WM\_COMMAND**](/windows/desktop/menurc/wm-command) or [**WM\_NOTIFY**](wm-notify.md) message that includes the command identifier of the button.</span></span> <span data-ttu-id="647f7-240">父視窗會檢查命令識別碼，並執行與按鈕相關聯的命令。</span><span class="sxs-lookup"><span data-stu-id="647f7-240">The parent window examines the command identifier and carries out the command associated with the button.</span></span> <span data-ttu-id="647f7-241">如需控制項何時傳送 **wm \_ 命令** 訊息，以及何時傳送 **wm \_ 通知** 的詳細資訊，請參閱 [**WM \_ 通知**](wm-notify.md) 檔的「備註」一節。</span><span class="sxs-lookup"><span data-stu-id="647f7-241">For information about when controls send **WM\_COMMAND** messages and when they send **WM\_NOTIFY**, see the Remarks section of the [**WM\_NOTIFY**](wm-notify.md) documentation.</span></span>

### <a name="button-size-and-position"></a><span data-ttu-id="647f7-242">按鈕大小和位置</span><span class="sxs-lookup"><span data-stu-id="647f7-242">Button Size and Position</span></span>

<span data-ttu-id="647f7-243">工具列會藉由指派每個按鈕的位置索引來追蹤其按鈕。</span><span class="sxs-lookup"><span data-stu-id="647f7-243">A toolbar keeps track of its buttons by assigning each button a position index.</span></span> <span data-ttu-id="647f7-244">索引是以零為基底;也就是說，最左邊的按鈕索引為0，右邊的下一個按鈕索引為1，依此類推。</span><span class="sxs-lookup"><span data-stu-id="647f7-244">The index is zero-based; that is, the leftmost button has an index of 0, the next button to the right has an index of 1, and so on.</span></span> <span data-ttu-id="647f7-245">應用程式在傳送訊息以抓取按鈕的相關資訊或設定按鈕的屬性時，必須指定按鈕的索引。</span><span class="sxs-lookup"><span data-stu-id="647f7-245">An application must specify the index of a button when sending messages to retrieve information about the button or to set the button's attributes.</span></span>

<span data-ttu-id="647f7-246">當插入和移除按鈕時，工具列會更新位置索引。</span><span class="sxs-lookup"><span data-stu-id="647f7-246">A toolbar updates the position indexes as buttons are inserted and removed.</span></span> <span data-ttu-id="647f7-247">應用程式可以使用 [**TB \_ COMMANDTOINDEX**](tb-commandtoindex.md) 訊息來取出按鈕的目前位置索引。</span><span class="sxs-lookup"><span data-stu-id="647f7-247">An application can retrieve the current position index of a button by using the [**TB\_COMMANDTOINDEX**](tb-commandtoindex.md) message.</span></span> <span data-ttu-id="647f7-248">訊息會指定按鈕的命令識別碼，而工具列視窗會使用識別碼來找出按鈕，並傳回其位置索引。</span><span class="sxs-lookup"><span data-stu-id="647f7-248">The message specifies the command identifier of a button, and the toolbar window uses the identifier to locate the button and return its position index.</span></span>

<span data-ttu-id="647f7-249">工具列中的所有按鈕都有相同的大小。</span><span class="sxs-lookup"><span data-stu-id="647f7-249">All buttons in a toolbar are the same size.</span></span> <span data-ttu-id="647f7-250">當您建立工具列時， [**CreateToolbarEx**](/windows/desktop/api/Commctrl/nf-commctrl-createtoolbarex) 函式會要求您設定按鈕的初始大小。</span><span class="sxs-lookup"><span data-stu-id="647f7-250">The [**CreateToolbarEx**](/windows/desktop/api/Commctrl/nf-commctrl-createtoolbarex) function requires you to set the initial size of the buttons when you create the toolbar.</span></span> <span data-ttu-id="647f7-251">當您使用 [**CreateWindowEx**](/windows/desktop/api/winuser/nf-winuser-createwindowexa) 函式時，初始大小會設定為預設維度24乘以22圖元。</span><span class="sxs-lookup"><span data-stu-id="647f7-251">When you use the [**CreateWindowEx**](/windows/desktop/api/winuser/nf-winuser-createwindowexa) function, the initial size is set to the default dimensions of 24 by 22 pixels.</span></span> <span data-ttu-id="647f7-252">您可以使用 [ [**TB \_ SETBUTTONSIZE**](tb-setbuttonsize.md) ] 訊息來變更按鈕大小，但您必須先執行此動作，才能將任何按鈕新增至工具列。</span><span class="sxs-lookup"><span data-stu-id="647f7-252">You can use the [**TB\_SETBUTTONSIZE**](tb-setbuttonsize.md) message to change the button size, but you must do so before adding any buttons to the toolbar.</span></span> <span data-ttu-id="647f7-253">[**TB 的 \_ GETITEMRECT**](tb-getitemrect.md)訊息會抓取按鈕目前的維度。</span><span class="sxs-lookup"><span data-stu-id="647f7-253">The [**TB\_GETITEMRECT**](tb-getitemrect.md) message retrieves the current dimensions of the buttons.</span></span>

<span data-ttu-id="647f7-254">當您加入的字串長度超過工具列目前的任何字串時，工具列會自動重設其按鈕的寬度。</span><span class="sxs-lookup"><span data-stu-id="647f7-254">When you add a string that is longer than any string currently in the toolbar, the toolbar automatically resets the width of its buttons.</span></span> <span data-ttu-id="647f7-255">寬度設定為容納工具列中最長的字串。</span><span class="sxs-lookup"><span data-stu-id="647f7-255">The width is set to accommodate the longest string in the toolbar.</span></span>

## <a name="enabling-customization"></a><span data-ttu-id="647f7-256">啟用自訂</span><span class="sxs-lookup"><span data-stu-id="647f7-256">Enabling Customization</span></span>

<span data-ttu-id="647f7-257">工具列具有內建的自訂功能，可讓使用者透過提供 [**CCS 可 \_ 調整**](common-control-styles.md) 的通用控制項樣式來提供給使用者使用。</span><span class="sxs-lookup"><span data-stu-id="647f7-257">A toolbar has built-in customization features that you can make available to the user by giving the toolbar the [**CCS\_ADJUSTABLE**](common-control-styles.md) common control style.</span></span> <span data-ttu-id="647f7-258">自訂功能可讓使用者將按鈕拖曳至新的位置，或者拖曳出工具列以移除按鈕。</span><span class="sxs-lookup"><span data-stu-id="647f7-258">The customization features allow the user to drag a button to a new position or to remove a button by dragging it off the toolbar.</span></span> <span data-ttu-id="647f7-259">此外，使用者可以按兩下工具列顯示 [自訂工具列] 對話方塊，讓使用者加入、刪除及重新排列工具列按鈕。</span><span class="sxs-lookup"><span data-stu-id="647f7-259">In addition, the user can double-click the toolbar to display the Customize Toolbar dialog box, which allows the user to add, delete, and rearrange toolbar buttons.</span></span> <span data-ttu-id="647f7-260">若要顯示對話方塊，請使用 [**TB \_ 自訂**](tb-customize.md) 訊息。</span><span class="sxs-lookup"><span data-stu-id="647f7-260">To display the dialog box, use the [**TB\_CUSTOMIZE**](tb-customize.md) message.</span></span> <span data-ttu-id="647f7-261">應用程式會決定使用者是否可用自訂功能，以及控制使用者可自訂工具列的範圍。</span><span class="sxs-lookup"><span data-stu-id="647f7-261">An application determines whether the customization features are available to the user and controls the extent to which the user can customize the toolbar.</span></span>

<span data-ttu-id="647f7-262">在自訂程式中，應用程式通常需要儲存和還原工具列的狀態。</span><span class="sxs-lookup"><span data-stu-id="647f7-262">As part of the customization process, applications often need to save and restore a toolbar's state.</span></span> <span data-ttu-id="647f7-263">例如，許多應用程式會在使用者開始自訂工具列之前儲存工具列狀態，以防使用者稍後想要將工具列還原為其原始狀態。</span><span class="sxs-lookup"><span data-stu-id="647f7-263">For instance, many applications store the toolbar state before the user begins customizing the toolbar in case the user later wants to restore the toolbar to its original state.</span></span> <span data-ttu-id="647f7-264">工具列控制項不會自動保留其 precustomization 狀態的記錄。</span><span class="sxs-lookup"><span data-stu-id="647f7-264">The toolbar control does not automatically keep a record of its precustomization state.</span></span> <span data-ttu-id="647f7-265">您的應用程式必須儲存工具列狀態，才能進行還原。</span><span class="sxs-lookup"><span data-stu-id="647f7-265">Your application must save the toolbar state in order to restore it.</span></span> <span data-ttu-id="647f7-266">如需詳細資訊，請參閱 [使用工具列控制項](using-toolbar-controls.md)。</span><span class="sxs-lookup"><span data-stu-id="647f7-266">For more information, see [Using Toolbar Controls](using-toolbar-controls.md).</span></span>

## <a name="enabling-hot-tracking"></a><span data-ttu-id="647f7-267">啟用熱追蹤</span><span class="sxs-lookup"><span data-stu-id="647f7-267">Enabling Hot-tracking</span></span>

<span data-ttu-id="647f7-268">熱追蹤表示當指標移到專案上時，按鈕的外觀會變更。</span><span class="sxs-lookup"><span data-stu-id="647f7-268">Hot-tracking means that when the pointer moves over an item, the button's appearance changes.</span></span> <span data-ttu-id="647f7-269">啟用視覺化樣式時，工具列預設會支援熱追蹤。</span><span class="sxs-lookup"><span data-stu-id="647f7-269">When visual styles are enabled, toolbars support hot-tracking by default.</span></span> <span data-ttu-id="647f7-270">否則，只有以 [**TBSTYLE \_ 平面**](toolbar-control-and-button-styles.md) 樣式建立的工具列控制項才支援熱追蹤。</span><span class="sxs-lookup"><span data-stu-id="647f7-270">Otherwise, only toolbar controls created with the [**TBSTYLE\_FLAT**](toolbar-control-and-button-styles.md) style support hot-tracking.</span></span> <span data-ttu-id="647f7-271">您可以使用其他視窗樣式搭配 **TBSTYLE \_ 平面** 來產生可啟用熱追蹤的工具列，但從一般工具列有不同的外觀。</span><span class="sxs-lookup"><span data-stu-id="647f7-271">You can use other window styles in combination with **TBSTYLE\_FLAT** to produce toolbars that enable hot-tracking but have a different appearance from a flat toolbar.</span></span> <span data-ttu-id="647f7-272">如需詳細資訊，請參閱 [使用工具列控制項](using-toolbar-controls.md)。</span><span class="sxs-lookup"><span data-stu-id="647f7-272">For more information, see [Using Toolbar Controls](using-toolbar-controls.md).</span></span>

 

 