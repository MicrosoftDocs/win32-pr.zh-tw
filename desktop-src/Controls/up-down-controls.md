---
title: 關於 Up-Down 控制項
description: 由上而下的控制項是一組箭號按鈕，使用者可以按一下來遞增或遞減值，例如在附屬控制項中顯示的捲軸位置或數位， (稱為「合作者視窗) 。
ms.assetid: ae2c0283-9cad-40d1-b8a6-a90484a95f56
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 2cc8dad15a8254b138cae4175cc16b1ef3111745
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/21/2020
ms.locfileid: "103683178"
---
# <a name="about-up-down-controls"></a><span data-ttu-id="37e2d-103">關於 Up-Down 控制項</span><span class="sxs-lookup"><span data-stu-id="37e2d-103">About Up-Down Controls</span></span>

<span data-ttu-id="37e2d-104">由上而下的控制項是一組箭號按鈕，使用者可以按一下來遞增或遞減值，例如在附屬控制項中顯示的捲軸位置或數位， (稱為「合作者視窗) 。</span><span class="sxs-lookup"><span data-stu-id="37e2d-104">An up-down control is a pair of arrow buttons that the user can click to increment or decrement a value, such as a scroll position or a number displayed in a companion control (called a buddy window).</span></span>

<span data-ttu-id="37e2d-105">對使用者而言，上下控制項和其合作者視窗通常看起來像單一控制項。</span><span class="sxs-lookup"><span data-stu-id="37e2d-105">To the user, an up-down control and its buddy window often look like a single control.</span></span> <span data-ttu-id="37e2d-106">您可以指定由上而下的控制項自動定位於其協同視窗的旁邊，而且它會自動將好友視窗的標題設定為目前的位置。</span><span class="sxs-lookup"><span data-stu-id="37e2d-106">You can specify that an up-down control automatically position itself next to its buddy window and that it automatically set the caption of the buddy window to its current position.</span></span> <span data-ttu-id="37e2d-107">例如，您可以使用上下按鈕控制項搭配編輯控制項，以提示使用者輸入數位。</span><span class="sxs-lookup"><span data-stu-id="37e2d-107">For example, you can use an up-down control with an edit control to prompt the user for numeric input.</span></span> <span data-ttu-id="37e2d-108">下圖顯示以編輯控制項作為其協同視窗的上下按鈕控制項，此控制項有時也稱為微調控制項。</span><span class="sxs-lookup"><span data-stu-id="37e2d-108">The following illustration shows an up-down control with an edit control as its buddy window, a combination that is sometimes referred to as a spinner control.</span></span>

![螢幕擷取畫面，顯示在右邊緣有向上和向下箭號的簡短矩形控制項](images/updown.jpg)

<span data-ttu-id="37e2d-110">本節將討論下列主題。</span><span class="sxs-lookup"><span data-stu-id="37e2d-110">The following topics are discussed in this section.</span></span>

-   [<span data-ttu-id="37e2d-111">上下控制項樣式</span><span class="sxs-lookup"><span data-stu-id="37e2d-111">Up-Down Control Styles</span></span>](#up-down-control-styles)
-   [<span data-ttu-id="37e2d-112">定位與加速</span><span class="sxs-lookup"><span data-stu-id="37e2d-112">Position and Acceleration</span></span>](#position-and-acceleration)
-   [<span data-ttu-id="37e2d-113">預設 Up-Down 控制訊息處理</span><span class="sxs-lookup"><span data-stu-id="37e2d-113">Default Up-Down Controls Message Processing</span></span>](#default-up-down-controls-message-processing)

## <a name="up-down-control-styles"></a><span data-ttu-id="37e2d-114">Up-Down 控制項樣式</span><span class="sxs-lookup"><span data-stu-id="37e2d-114">Up-Down Control Styles</span></span>

<span data-ttu-id="37e2d-115">您可以使用視窗樣式來操作最新控制項的特性，例如，它在其協同視窗中的相對位置、是否設定其協同視窗的文字，以及是否要處理向上箭號和向下鍵。</span><span class="sxs-lookup"><span data-stu-id="37e2d-115">Using window styles, you can manipulate characteristics of an up-down control, such as how it positions itself relative to its buddy window, whether it sets the text of its buddy window, and whether it processes the UP ARROW and DOWN ARROW keys.</span></span>

<span data-ttu-id="37e2d-116">具有 ud [**\_ ALIGNLEFT**](up-down-control-styles.md) 或 ud [**\_ ALIGNRIGHT**](up-down-control-styles.md) 樣式的上下按鈕會對齊其好友視窗的左邊緣或右邊緣。</span><span class="sxs-lookup"><span data-stu-id="37e2d-116">An up-down control with the [**UDS\_ALIGNLEFT**](up-down-control-styles.md) or [**UDS\_ALIGNRIGHT**](up-down-control-styles.md) style aligns with the left or right edge of its buddy window.</span></span> <span data-ttu-id="37e2d-117">好友視窗的寬度會減少以容納上下按鈕控制項的寬度。</span><span class="sxs-lookup"><span data-stu-id="37e2d-117">The width of the buddy window is decreased to accommodate the width of the up-down control.</span></span>

<span data-ttu-id="37e2d-118">具有 ud [**\_ SETBUDDYINT**](up-down-control-styles.md) 樣式的上下按鈕控制項，會在目前的位置變更時，設定其好友視窗的標題。</span><span class="sxs-lookup"><span data-stu-id="37e2d-118">An up-down control with the [**UDS\_SETBUDDYINT**](up-down-control-styles.md) style sets the caption of its buddy window whenever the current position changes.</span></span> <span data-ttu-id="37e2d-119">除非指定了 ud [**\_ NOTHOUSANDS**](up-down-control-styles.md) 樣式，否則控制項會在十進位字串的每三位數之間插入千位分隔符號。</span><span class="sxs-lookup"><span data-stu-id="37e2d-119">The control inserts a thousands separator between every three digits of a decimal string unless the [**UDS\_NOTHOUSANDS**](up-down-control-styles.md) style is specified.</span></span> <span data-ttu-id="37e2d-120">如果 [合作者] 視窗是清單方塊，則會將其目前的選取範圍（而不是其標題）設定為由上而下的控制項。</span><span class="sxs-lookup"><span data-stu-id="37e2d-120">If the buddy window is a list box, an up-down control sets its current selection instead of its caption.</span></span>

<span data-ttu-id="37e2d-121">您可以指定 ud [**\_ ARROWKEYS**](up-down-control-styles.md) 樣式，以提供最新控制項的鍵盤介面。</span><span class="sxs-lookup"><span data-stu-id="37e2d-121">You can specify the [**UDS\_ARROWKEYS**](up-down-control-styles.md) style to provide a keyboard interface for an up-down control.</span></span> <span data-ttu-id="37e2d-122">如果指定此樣式，控制項會處理向上和向下鍵。</span><span class="sxs-lookup"><span data-stu-id="37e2d-122">If this style is specified, the control processes the up and down arrow keys.</span></span> <span data-ttu-id="37e2d-123">控制項也會將好友視窗子類別化，讓它可以在好友視窗具有焦點時處理這些按鍵。</span><span class="sxs-lookup"><span data-stu-id="37e2d-123">The control also subclasses the buddy window so that it can process these keys when the buddy window has the focus.</span></span>

<span data-ttu-id="37e2d-124">如果您使用上下按鈕控制項來進行水準滾動，則可以指定 ud [**\_ HORZ**](up-down-control-styles.md) 樣式。</span><span class="sxs-lookup"><span data-stu-id="37e2d-124">If you use an up-down control for horizontal scrolling, you can specify the [**UDS\_HORZ**](up-down-control-styles.md) style.</span></span> <span data-ttu-id="37e2d-125">此樣式會讓下一個控制項的箭號向左和向右指向，而不是向上和向下。</span><span class="sxs-lookup"><span data-stu-id="37e2d-125">This style causes the up-down control's arrows to point left and right instead of up and down.</span></span>

<span data-ttu-id="37e2d-126">根據預設，如果使用者嘗試遞增或遞減超過最大值或最小值，則目前的位置不會變更。</span><span class="sxs-lookup"><span data-stu-id="37e2d-126">By default, the current position does not change if the user attempts to increment it or decrement it beyond the maximum or minimum value.</span></span> <span data-ttu-id="37e2d-127">您可以使用 ud [**\_ 換行**](up-down-control-styles.md) 樣式來變更此行為，讓位置「換行」至相反的極端。</span><span class="sxs-lookup"><span data-stu-id="37e2d-127">You can change this behavior by using the [**UDS\_WRAP**](up-down-control-styles.md) style, so the position "wraps" to the opposite extreme.</span></span> <span data-ttu-id="37e2d-128">例如，以超過上限的遞增會將位置包裝回下限值。</span><span class="sxs-lookup"><span data-stu-id="37e2d-128">For example, incrementing past the upper limit wraps the position back to the lower limit.</span></span>

## <a name="position-and-acceleration"></a><span data-ttu-id="37e2d-129">定位與加速</span><span class="sxs-lookup"><span data-stu-id="37e2d-129">Position and Acceleration</span></span>

<span data-ttu-id="37e2d-130">建立上下按鈕控制項之後，您可以藉由傳送訊息來變更控制項的目前位置、最小位置和最大位置。</span><span class="sxs-lookup"><span data-stu-id="37e2d-130">After an up-down control is created, you can change the control's current position, minimum position, and maximum position by sending messages.</span></span> <span data-ttu-id="37e2d-131">您也可以變更用來顯示好友視窗中目前位置的基本基底，以及按一下向上或向下箭號時，目前位置變更的速率。</span><span class="sxs-lookup"><span data-stu-id="37e2d-131">You can also change the radix base used to display the current position in the buddy window and the rate at which the current position changes when the up or down arrow is clicked.</span></span>

<span data-ttu-id="37e2d-132">若要取出上下按鈕控制項的目前位置，請使用 [**UDM \_ GETPOS**](udm-getpos.md) 訊息。</span><span class="sxs-lookup"><span data-stu-id="37e2d-132">To retrieve the current position of an up-down control, use the [**UDM\_GETPOS**](udm-getpos.md) message.</span></span> <span data-ttu-id="37e2d-133">針對具有合作者視窗的上下按鈕控制項，目前的位置是在好友視窗標題中的數位。</span><span class="sxs-lookup"><span data-stu-id="37e2d-133">For an up-down control with a buddy window, the current position is the number in the buddy window's caption.</span></span> <span data-ttu-id="37e2d-134">由於標題可能已變更 (例如，使用者可能已編輯編輯控制項的文字) ，由上而下的控制項則會取得目前的標題，並據以更新其目前的位置。</span><span class="sxs-lookup"><span data-stu-id="37e2d-134">Because the caption may have changed (for example, the user may have edited the text of an edit control), the up-down control retrieves the current caption and updates its current position accordingly.</span></span>

<span data-ttu-id="37e2d-135">好友視窗的標題可以是十進位或十六進位字串，取決於基底基底 (也就是由上而下控制項10或 16) 。</span><span class="sxs-lookup"><span data-stu-id="37e2d-135">The buddy window's caption may be either a decimal or hexadecimal string, depending on the radix base (that is, either base 10 or 16) of the up-down control.</span></span> <span data-ttu-id="37e2d-136">您可以使用 [**udm \_ SETBASE**](udm-setbase.md) 訊息來設定基本基底，並使用 [**udm \_ GETBASE**](udm-getbase.md) 訊息來取得基數基底。</span><span class="sxs-lookup"><span data-stu-id="37e2d-136">You can set the radix base by using the [**UDM\_SETBASE**](udm-setbase.md) message and retrieve the radix base by using the [**UDM\_GETBASE**](udm-getbase.md) message.</span></span>

<span data-ttu-id="37e2d-137">[**UDM \_ SETPOS**](udm-setpos.md)訊息會設定合作者視窗的目前位置。</span><span class="sxs-lookup"><span data-stu-id="37e2d-137">The [**UDM\_SETPOS**](udm-setpos.md) message sets the current position of a buddy window.</span></span> <span data-ttu-id="37e2d-138">請注意，和捲軸不同的是，當按下向上鍵和向下箭號時，上下按鈕會自動變更其目前的位置。</span><span class="sxs-lookup"><span data-stu-id="37e2d-138">Note that unlike a scroll bar, an up-down control automatically changes its current position when the up and down arrows are clicked.</span></span> <span data-ttu-id="37e2d-139">因此，應用程式在處理 [**WM \_ VSCROLL**](wm-vscroll.md) 或 [**WM \_ HSCROLL**](wm-hscroll.md) 訊息時，不需要設定目前的位置。</span><span class="sxs-lookup"><span data-stu-id="37e2d-139">An application, therefore, does not need to set the current position when processing the [**WM\_VSCROLL**](wm-vscroll.md) or [**WM\_HSCROLL**](wm-hscroll.md) message.</span></span>

<span data-ttu-id="37e2d-140">您可以使用 [**UDM \_ SETRANGE**](udm-setrange.md) 訊息來變更上下按鈕控制項的最小和最大位置。</span><span class="sxs-lookup"><span data-stu-id="37e2d-140">You can change the minimum and maximum positions of an up-down control by using the [**UDM\_SETRANGE**](udm-setrange.md) message.</span></span> <span data-ttu-id="37e2d-141">最大位置可能小於最小值，而在此情況下，按一下向上箭號按鈕會減少目前的位置。</span><span class="sxs-lookup"><span data-stu-id="37e2d-141">The maximum position may be less than the minimum, and in that case clicking the up arrow button decreases the current position.</span></span> <span data-ttu-id="37e2d-142">若要以另一種方式進行，向上指的是移到最大的位置。</span><span class="sxs-lookup"><span data-stu-id="37e2d-142">To put it another way, up means moving toward the maximum position.</span></span> <span data-ttu-id="37e2d-143">若要取得上下按鈕控制項的最小和最大位置，請使用 [**UDM \_ GETRANGE**](udm-getrange.md) 訊息。</span><span class="sxs-lookup"><span data-stu-id="37e2d-143">To retrieve the minimum and maximum positions for an up-down control, use the [**UDM\_GETRANGE**](udm-getrange.md) message.</span></span>

<span data-ttu-id="37e2d-144">您可以設定上下按鈕控制項的加速，以控制當使用者按住箭號按鈕時，位置變更的速率。</span><span class="sxs-lookup"><span data-stu-id="37e2d-144">You can control the rate at which the position changes when the user holds down an arrow button by setting the up-down control's acceleration.</span></span> <span data-ttu-id="37e2d-145">加速是由 [**UDACCEL**](/windows/desktop/api/Commctrl/ns-commctrl-udaccel) 結構的陣列所定義。</span><span class="sxs-lookup"><span data-stu-id="37e2d-145">The acceleration is defined by an array of [**UDACCEL**](/windows/desktop/api/Commctrl/ns-commctrl-udaccel) structures.</span></span> <span data-ttu-id="37e2d-146">每個結構會指定時間間隔，以及該間隔結束時要遞增或遞減的單位數。</span><span class="sxs-lookup"><span data-stu-id="37e2d-146">Each structure specifies a time interval and the number of units by which to increment or decrement at the end of that interval.</span></span> <span data-ttu-id="37e2d-147">若要設定加速，請使用 [**UDM \_ SETACCEL**](udm-setaccel.md) 訊息。</span><span class="sxs-lookup"><span data-stu-id="37e2d-147">To set the acceleration, use the [**UDM\_SETACCEL**](udm-setaccel.md) message.</span></span> <span data-ttu-id="37e2d-148">若要取得加速資訊，請使用 [**UDM \_ GETACCEL**](udm-getaccel.md) 訊息。</span><span class="sxs-lookup"><span data-stu-id="37e2d-148">To retrieve acceleration information, use the [**UDM\_GETACCEL**](udm-getaccel.md) message.</span></span>

## <a name="default-up-down-controls-message-processing"></a><span data-ttu-id="37e2d-149">預設 Up-Down 控制訊息處理</span><span class="sxs-lookup"><span data-stu-id="37e2d-149">Default Up-Down Controls Message Processing</span></span>

<span data-ttu-id="37e2d-150">本章節描述由上而下控制項所處理的標準 Windows 訊息。</span><span class="sxs-lookup"><span data-stu-id="37e2d-150">This section describes the standard Windows messages processed by an up-down control.</span></span>



| <span data-ttu-id="37e2d-151">訊息</span><span class="sxs-lookup"><span data-stu-id="37e2d-151">Message</span></span>                                        | <span data-ttu-id="37e2d-152">處理已執行</span><span class="sxs-lookup"><span data-stu-id="37e2d-152">Processing performed</span></span>                                                                                                                                                                                         |
|------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="37e2d-153">**WM \_ 建立**</span><span class="sxs-lookup"><span data-stu-id="37e2d-153">**WM\_CREATE**</span></span>](/windows/desktop/winmsg/wm-create)             | <span data-ttu-id="37e2d-154">配置並初始化私用資料結構，並將其位址儲存為視窗資料。</span><span class="sxs-lookup"><span data-stu-id="37e2d-154">Allocates and initializes a private data structure and saves its address as window data.</span></span>                                                                                                                     |
| [<span data-ttu-id="37e2d-155">**WM 損 \_ 毀**</span><span class="sxs-lookup"><span data-stu-id="37e2d-155">**WM\_DESTROY**</span></span>](/windows/desktop/winmsg/wm-destroy)           | <span data-ttu-id="37e2d-156">釋放在 [**WM \_ 建立**](/windows/desktop/winmsg/wm-create) 處理期間配置的資料。</span><span class="sxs-lookup"><span data-stu-id="37e2d-156">Frees data allocated during [**WM\_CREATE**](/windows/desktop/winmsg/wm-create) processing.</span></span>                                                                                                                                   |
| [<span data-ttu-id="37e2d-157">**\_啟用 WM**</span><span class="sxs-lookup"><span data-stu-id="37e2d-157">**WM\_ENABLE**</span></span>](/windows/desktop/winmsg/wm-enable)             | <span data-ttu-id="37e2d-158">使視窗失效。</span><span class="sxs-lookup"><span data-stu-id="37e2d-158">Invalidates the window.</span></span>                                                                                                                                                                                      |
| [<span data-ttu-id="37e2d-159">**WM \_ KEYDOWN**</span><span class="sxs-lookup"><span data-stu-id="37e2d-159">**WM\_KEYDOWN**</span></span>](/windows/desktop/inputdev/wm-keydown)         | <span data-ttu-id="37e2d-160">變更向上箭號或向下鍵時的目前位置。</span><span class="sxs-lookup"><span data-stu-id="37e2d-160">Changes the current position in the case of an UP ARROW or DOWN ARROW key.</span></span>                                                                                                                                   |
| [<span data-ttu-id="37e2d-161">**WM \_ KEYUP**</span><span class="sxs-lookup"><span data-stu-id="37e2d-161">**WM\_KEYUP**</span></span>](/windows/desktop/inputdev/wm-keyup)             | <span data-ttu-id="37e2d-162">完成位置變更。</span><span class="sxs-lookup"><span data-stu-id="37e2d-162">Completes the position change.</span></span>                                                                                                                                                                               |
| [<span data-ttu-id="37e2d-163">**WM \_ LBUTTONDOWN**</span><span class="sxs-lookup"><span data-stu-id="37e2d-163">**WM\_LBUTTONDOWN**</span></span>](/windows/desktop/inputdev/wm-lbuttondown) | <span data-ttu-id="37e2d-164">捕捉滑鼠。</span><span class="sxs-lookup"><span data-stu-id="37e2d-164">Captures the mouse.</span></span> <span data-ttu-id="37e2d-165">如果 [合作者] 視窗是 [編輯控制項] 或 [清單] 方塊，則會將焦點設定為 [好友] 視窗。</span><span class="sxs-lookup"><span data-stu-id="37e2d-165">If the buddy window is an edit control or list box, it sets the focus to the buddy window.</span></span> <span data-ttu-id="37e2d-166">如果滑鼠移至向上或向下按鈕，就會開始變更位置並設定計時器。</span><span class="sxs-lookup"><span data-stu-id="37e2d-166">If the mouse is over the up or down button, it begins changing the position and sets a timer.</span></span> |
| [<span data-ttu-id="37e2d-167">**WM \_ LBUTTONUP**</span><span class="sxs-lookup"><span data-stu-id="37e2d-167">**WM\_LBUTTONUP**</span></span>](/windows/desktop/inputdev/wm-lbuttonup)     | <span data-ttu-id="37e2d-168">完成位置的變更，並在上下按鈕控制項已捕捉到滑鼠時放開滑鼠捕捉。</span><span class="sxs-lookup"><span data-stu-id="37e2d-168">Completes the position change and releases the mouse capture if the up-down control has captured the mouse.</span></span> <span data-ttu-id="37e2d-169">如果 [合作者] 視窗是編輯控制項，則會選取 [編輯] 控制項中的所有文字。</span><span class="sxs-lookup"><span data-stu-id="37e2d-169">If the buddy window is an edit control, it selects all the text in the edit control.</span></span>             |
| [<span data-ttu-id="37e2d-170">**WM \_ 油漆**</span><span class="sxs-lookup"><span data-stu-id="37e2d-170">**WM\_PAINT**</span></span>](/windows/desktop/gdi/wm-paint)                  | <span data-ttu-id="37e2d-171">繪製上下按鈕控制項。</span><span class="sxs-lookup"><span data-stu-id="37e2d-171">Paints the up-down control.</span></span> <span data-ttu-id="37e2d-172">如果 *wParam* 參數不是 Null，則控制項會假設值為 **HDC** ，並且使用該裝置內容繪製。</span><span class="sxs-lookup"><span data-stu-id="37e2d-172">If the *wParam* parameter is non-NULL, the control assumes that the value is an **HDC** and paints using that device context.</span></span>                                                    |
| [<span data-ttu-id="37e2d-173">**WM \_ 計時器**</span><span class="sxs-lookup"><span data-stu-id="37e2d-173">**WM\_TIMER**</span></span>](/windows/desktop/winmsg/wm-timer)               | <span data-ttu-id="37e2d-174">變更目前的位置，如果滑鼠停留在按鈕上，而且已經過足夠的間隔時間。</span><span class="sxs-lookup"><span data-stu-id="37e2d-174">Changes the current position if the mouse is being held down over a button and a sufficient interval has elapsed.</span></span>                                                                                            |



 

 

 