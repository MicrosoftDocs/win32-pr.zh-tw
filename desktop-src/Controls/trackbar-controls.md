---
title: 關於資料說明控制項
description: '[點擊線] 是一種視窗，其中包含滑杆 (有時也稱為頻道中) 的捲動方塊，以及選擇性的刻度標記。 當使用者使用滑鼠或方向按鍵移動滑杆時，會傳送通知訊息以指出變更。'
ms.assetid: 9fc7bef8-da1d-493b-9a9a-3770873713f0
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 83e364f57a094ed5a29369a00a112150d0282f24
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/21/2020
ms.locfileid: "103683155"
---
# <a name="about-trackbar-controls"></a><span data-ttu-id="2cb36-104">關於資料說明控制項</span><span class="sxs-lookup"><span data-stu-id="2cb36-104">About Trackbar Controls</span></span>

<span data-ttu-id="2cb36-105">[點擊線] 是一種視窗，其中包含滑杆 (有時也稱為頻道中) 的捲動方塊，以及選擇性的刻度標記。</span><span class="sxs-lookup"><span data-stu-id="2cb36-105">A trackbar is a window that contains a slider (sometimes called a thumb) in a channel, and optional tick marks.</span></span> <span data-ttu-id="2cb36-106">當使用者使用滑鼠或方向按鍵移動滑杆時，會傳送通知訊息以指出變更。</span><span class="sxs-lookup"><span data-stu-id="2cb36-106">When the user moves the slider, using either the mouse or the direction keys, the trackbar sends notification messages to indicate the change.</span></span>

-   [<span data-ttu-id="2cb36-107">選取範圍</span><span class="sxs-lookup"><span data-stu-id="2cb36-107">Selection Range</span></span>](#selection-range)
-   [<span data-ttu-id="2cb36-108">訊息</span><span class="sxs-lookup"><span data-stu-id="2cb36-108">Trackbar Messages</span></span>](#trackbar-messages)
-   [<span data-ttu-id="2cb36-109">資訊提示通知訊息</span><span class="sxs-lookup"><span data-stu-id="2cb36-109">Trackbar Notification Messages</span></span>](#trackbar-notification-messages)
-   [<span data-ttu-id="2cb36-110">預設的顯示訊息處理</span><span class="sxs-lookup"><span data-stu-id="2cb36-110">Default Trackbar Message Processing</span></span>](#default-trackbar-message-processing)
-   [<span data-ttu-id="2cb36-111">跟蹤工具工具提示</span><span class="sxs-lookup"><span data-stu-id="2cb36-111">Trackbar Tooltips</span></span>](#trackbar-tooltips)

<span data-ttu-id="2cb36-112">當您想要讓使用者在範圍內選取離散不帶正負號的整數值或一組連續不帶正負號的整數值時，Trackbars 會很有用。</span><span class="sxs-lookup"><span data-stu-id="2cb36-112">Trackbars are useful when you want the user to select a discrete unsigned integer value or a set of consecutive unsigned integer values in a range.</span></span> <span data-ttu-id="2cb36-113">例如，您可以使用標題，讓使用者將滑杆移至指定的刻度，以設定鍵盤的重複速度。</span><span class="sxs-lookup"><span data-stu-id="2cb36-113">For example, you might use a trackbar to allow the user to set the repeat rate of the keyboard by moving the slider to a given tick mark.</span></span> <span data-ttu-id="2cb36-114">下圖顯示一般的敘述。</span><span class="sxs-lookup"><span data-stu-id="2cb36-114">The following illustration shows a typical trackbar.</span></span>

![具有標籤的快捷方式的螢幕擷取畫面，其具有緩慢和快速的結尾](images/tkb-simple.png)

<span data-ttu-id="2cb36-116">當您建立時，會以您所指定的遞增順序來移動其中的滑杆。</span><span class="sxs-lookup"><span data-stu-id="2cb36-116">The slider in a trackbar moves in increments that you specify when you create it.</span></span> <span data-ttu-id="2cb36-117">此範圍中的值稱為邏輯單元。</span><span class="sxs-lookup"><span data-stu-id="2cb36-117">The values in this range are referred to as logical units.</span></span> <span data-ttu-id="2cb36-118">例如，如果您指定 [提要的邏輯單元] 的範圍是從0到5，則滑杆只能佔用六個位置：位於提要欄左側的位置，以及範圍中每個遞增的一個位置。</span><span class="sxs-lookup"><span data-stu-id="2cb36-118">For example, if you specify that the trackbar should have logical units that range from 0 to 5, the slider can occupy only six positions: a position at the left side of the trackbar and one position for each increment in the range.</span></span> <span data-ttu-id="2cb36-119">通常，每個位置都是以刻度來識別;不過，刻度的數目是任意的，且可以少於邏輯位置的數目。</span><span class="sxs-lookup"><span data-stu-id="2cb36-119">Typically, each of these positions is identified by a tick mark; however, the number of tick marks is arbitrary and can be fewer than the number of logical positions.</span></span>

<span data-ttu-id="2cb36-120">您可以使用 [**CreateWindowEx**](/windows/desktop/api/winuser/nf-winuser-createwindowexa) 函式來建立程式，並指定 [並排] [**\_ 類別**](common-control-window-classes.md) 視窗類別。</span><span class="sxs-lookup"><span data-stu-id="2cb36-120">You create a trackbar by using the [**CreateWindowEx**](/windows/desktop/api/winuser/nf-winuser-createwindowexa) function, specifying the [**TRACKBAR\_CLASS**](common-control-window-classes.md) window class.</span></span> <span data-ttu-id="2cb36-121">在您建立了一個程式之後，您可以使用 [訊息] 訊息來設定和取出其許多屬性。</span><span class="sxs-lookup"><span data-stu-id="2cb36-121">After you have created a trackbar, you can use trackbar messages to set and retrieve many of its properties.</span></span> <span data-ttu-id="2cb36-122">您可以進行的變更包括設定滑桿的最小和最大位置、繪製刻度標記、設定選取範圍，以及重新調整滑桿定位。</span><span class="sxs-lookup"><span data-stu-id="2cb36-122">Changes that you can make include setting the minimum and maximum positions for the slider, drawing tick marks, setting a selection range, and repositioning the slider.</span></span>

## <a name="selection-range"></a><span data-ttu-id="2cb36-123">選取範圍</span><span class="sxs-lookup"><span data-stu-id="2cb36-123">Selection Range</span></span>

<span data-ttu-id="2cb36-124">如果您建立具有 [Tb] [**\_ ENABLESELRANGE**](trackbar-control-styles.md) 樣式的 [內容]，則可以指定選取範圍。</span><span class="sxs-lookup"><span data-stu-id="2cb36-124">If you create a trackbar with the [**TBS\_ENABLESELRANGE**](trackbar-control-styles.md) style, you can specify a selection range.</span></span> <span data-ttu-id="2cb36-125">這些敘述會反白顯示選取範圍，並在開頭和結尾顯示三角形刻度標記，如下圖所示。</span><span class="sxs-lookup"><span data-stu-id="2cb36-125">The trackbar highlights the selection range and displays triangular tick marks at the start and end, as shown in the following illustration.</span></span>

![醒目提示範圍的 [顯示] 的螢幕擷取畫面](images/tkb-selrange.png)

<span data-ttu-id="2cb36-127">選取器的選取範圍不會以任何方式影響其功能。</span><span class="sxs-lookup"><span data-stu-id="2cb36-127">The trackbar's selection range does not affect its functionality in any way.</span></span> <span data-ttu-id="2cb36-128">它是由應用程式執行範圍所組成。</span><span class="sxs-lookup"><span data-stu-id="2cb36-128">It is up to the application to implement the range.</span></span> <span data-ttu-id="2cb36-129">您可以透過下列其中一種方式來執行此動作：</span><span class="sxs-lookup"><span data-stu-id="2cb36-129">You might do this in one of the following ways:</span></span>

-   <span data-ttu-id="2cb36-130">您可以使用選取範圍來讓使用者設定某個參數的最大值和最小值。</span><span class="sxs-lookup"><span data-stu-id="2cb36-130">Use a selection range to enable the user to set maximum and minimum values for some parameter.</span></span> <span data-ttu-id="2cb36-131">例如，使用者可以將滑杆移至某個位置，然後按一下標示為「最大值」的按鈕。</span><span class="sxs-lookup"><span data-stu-id="2cb36-131">For example, the user could move the slider to a position and then click a button labeled "Max".</span></span> <span data-ttu-id="2cb36-132">然後，應用程式會設定選取範圍來顯示使用者選擇的值。</span><span class="sxs-lookup"><span data-stu-id="2cb36-132">The application then sets the selection range to show the values chosen by the user.</span></span>
-   <span data-ttu-id="2cb36-133">藉由處理 [**WM \_ HSCROLL**](wm-hscroll.md) 或 [**WM \_ VSCROLL**](wm-vscroll.md) 通知，將滑杆的移動限制在控制項內預先決定的子範圍，並不允許在選取範圍之外進行任何移動。</span><span class="sxs-lookup"><span data-stu-id="2cb36-133">Limit the movement of the slider to a predetermined subrange within the control, by handling the [**WM\_HSCROLL**](wm-hscroll.md) or [**WM\_VSCROLL**](wm-vscroll.md) notification and disallowing any movement outside the selection range.</span></span> <span data-ttu-id="2cb36-134">例如，您可以執行這項作業，例如，如果使用者可用的值範圍因其他使用者所做的選擇，或根據可用的資源而變更。</span><span class="sxs-lookup"><span data-stu-id="2cb36-134">You might do this, for example, if the range of values available to the user can change because of other choices the user has made, or according to available resources.</span></span>

## <a name="trackbar-messages"></a><span data-ttu-id="2cb36-135">訊息</span><span class="sxs-lookup"><span data-stu-id="2cb36-135">Trackbar Messages</span></span>

<span data-ttu-id="2cb36-136">資料條的邏輯單元是這些連續值的組合，可供這些連續值使用。</span><span class="sxs-lookup"><span data-stu-id="2cb36-136">The logical units of a trackbar are the set of contiguous values that the trackbar can represent.</span></span> <span data-ttu-id="2cb36-137">它們通常是藉由在建立資料 [**TBM \_**](tbm-setrange.md) 時，透過指定可能值的範圍來定義。</span><span class="sxs-lookup"><span data-stu-id="2cb36-137">They are usually defined by specifying the range of possible values with a [**TBM\_SETRANGE**](tbm-setrange.md) message as soon as the trackbar has been created.</span></span> <span data-ttu-id="2cb36-138">應用程式可以使用 **TBM \_ SETRANGE**、 [**TBM \_ SETRANGEMAX**](tbm-setrangemax.md)或 [**TBM \_ SETRANGEMIN**](tbm-setrangemin.md)，以動態方式改變範圍。</span><span class="sxs-lookup"><span data-stu-id="2cb36-138">Applications can dynamically alter the range by using **TBM\_SETRANGE**, [**TBM\_SETRANGEMAX**](tbm-setrangemax.md), or [**TBM\_SETRANGEMIN**](tbm-setrangemin.md).</span></span>

<span data-ttu-id="2cb36-139">若要取出滑杆的位置 (也就是使用者已選擇) 的值，請使用 [**TBM \_ GETPOS**](tbm-getpos.md) 訊息。</span><span class="sxs-lookup"><span data-stu-id="2cb36-139">To retrieve the position of the slider (that is, the value the user has chosen), use the [**TBM\_GETPOS**](tbm-getpos.md) message.</span></span> <span data-ttu-id="2cb36-140">若要設定滑杆的位置，請使用 [**TBM \_ SETPOS**](tbm-setpos.md) 訊息。</span><span class="sxs-lookup"><span data-stu-id="2cb36-140">To set the position of the slider, use the [**TBM\_SETPOS**](tbm-setpos.md) message.</span></span>

<span data-ttu-id="2cb36-141">除非您指定 [ [**tb] \_ NOTICKS**](trackbar-control-styles.md) 樣式，否則會自動在其開頭和結尾顯示刻度標記。</span><span class="sxs-lookup"><span data-stu-id="2cb36-141">A trackbar automatically displays tick marks at its beginning and end, unless you specify the [**TBS\_NOTICKS**](trackbar-control-styles.md) style.</span></span> <span data-ttu-id="2cb36-142"> (在 Microsoft Visual Studio 資源編輯器中，這表示將刻度標記屬性設為 False。 ) 您可以使用 [ [**tb] \_ AUTOTICKS**](trackbar-control-styles.md) 樣式，以定期間隔沿著協助工具來自動顯示其他刻度標記。</span><span class="sxs-lookup"><span data-stu-id="2cb36-142">(In the Microsoft Visual Studio resource editor, this means setting the Tick Marks property to False.) You can use the [**TBS\_AUTOTICKS**](trackbar-control-styles.md) style to automatically display additional tick marks at regular intervals along the trackbar.</span></span> <span data-ttu-id="2cb36-143">根據預設，[ **tb] \_ AUTOTICKS** 的 [並排顯示] 會在每個 [並排顯示] 範圍的遞增位置顯示刻度標記。</span><span class="sxs-lookup"><span data-stu-id="2cb36-143">By default, a **TBS\_AUTOTICKS** trackbar displays a tick mark at each increment of the trackbar's range.</span></span> <span data-ttu-id="2cb36-144">若要指定自動刻度的不同間隔，請將 [**TBM \_ SETTICFREQ**](tbm-setticfreq.md) 訊息傳送至 [訊息]。</span><span class="sxs-lookup"><span data-stu-id="2cb36-144">To specify a different interval for the automatic tick marks, send the [**TBM\_SETTICFREQ**](tbm-setticfreq.md) message to the trackbar.</span></span> <span data-ttu-id="2cb36-145">例如，您可以使用此訊息只顯示1到100範圍內的10個刻度標記。</span><span class="sxs-lookup"><span data-stu-id="2cb36-145">For example, you could use this message to display only 10 tick marks in a range of 1 through 100.</span></span>

<span data-ttu-id="2cb36-146">若要設定單一刻度的位置，請傳送 [**TBM \_ SETTIC**](tbm-settic.md) 訊息。</span><span class="sxs-lookup"><span data-stu-id="2cb36-146">To set the position of a single tick mark, send the [**TBM\_SETTIC**](tbm-settic.md) message.</span></span> <span data-ttu-id="2cb36-147">使用的資料會維護一個 DWORD 值陣列，這些值會儲存每個刻度標記的位置。</span><span class="sxs-lookup"><span data-stu-id="2cb36-147">A trackbar maintains an array of DWORD values that stores the position of each tick mark.</span></span> <span data-ttu-id="2cb36-148">陣列不包含第一個和最後一個刻度，它們會自動建立。</span><span class="sxs-lookup"><span data-stu-id="2cb36-148">The array does not include the first and last tick marks, which the trackbar creates automatically.</span></span> <span data-ttu-id="2cb36-149">當您傳送 [**TBM \_ GETTIC**](tbm-gettic.md) 訊息來取得對應刻度的位置時，可以在此陣列中指定索引。</span><span class="sxs-lookup"><span data-stu-id="2cb36-149">You can specify an index in this array when you send the [**TBM\_GETTIC**](tbm-gettic.md) message to retrieve the position of the corresponding tick mark.</span></span> <span data-ttu-id="2cb36-150">或者，您可以傳送 [**TBM \_ GETPTICS**](tbm-getptics.md) 訊息來取得陣列的指標。</span><span class="sxs-lookup"><span data-stu-id="2cb36-150">Alternatively, you can send the [**TBM\_GETPTICS**](tbm-getptics.md) message to retrieve a pointer to the array.</span></span> <span data-ttu-id="2cb36-151">陣列中的元素數目等於兩個小於 [**TBM \_ GETNUMTICS**](tbm-getnumtics.md) 訊息所傳回的滴答計數。</span><span class="sxs-lookup"><span data-stu-id="2cb36-151">The number of elements in the array is equal to two less than the tick count returned by the [**TBM\_GETNUMTICS**](tbm-getnumtics.md) message.</span></span> <span data-ttu-id="2cb36-152">這是因為 **TBM \_ GETNUMTICS** 所傳回的計數包含不包含在陣列中的第一個和最後一個刻度標記。</span><span class="sxs-lookup"><span data-stu-id="2cb36-152">This is because the count returned by **TBM\_GETNUMTICS** includes the first and last tick marks, which are not included in the array.</span></span> <span data-ttu-id="2cb36-153">若要抓取刻度的實體位置，請在 [協調器] 視窗的用戶端座標中，傳送 [**TBM \_ GETTICPOS**](tbm-getticpos.md) 訊息。</span><span class="sxs-lookup"><span data-stu-id="2cb36-153">To retrieve the physical position of a tick mark, in client coordinates of the trackbar's window, send the [**TBM\_GETTICPOS**](tbm-getticpos.md) message.</span></span> <span data-ttu-id="2cb36-154">[**TBM \_ CLEARTICS**](tbm-cleartics.md)訊息會移除所有的標頭和最後一個和最後一個的刻度標記。</span><span class="sxs-lookup"><span data-stu-id="2cb36-154">The [**TBM\_CLEARTICS**](tbm-cleartics.md) message removes all but the first and last of a trackbar's tick marks.</span></span>

<span data-ttu-id="2cb36-155">追蹤程式的線條大小可決定滑杆從箭號按鍵回應鍵盤輸入的距離，例如向右箭號或向下鍵。</span><span class="sxs-lookup"><span data-stu-id="2cb36-155">A trackbar's line size determines how far the slider moves in response to keyboard input from the arrow keys, such as the RIGHT ARROW or DOWN ARROW key.</span></span> <span data-ttu-id="2cb36-156">若要取得或設定行大小，請傳送 [**TBM \_ GETLINESIZE**](tbm-getlinesize.md) 和 [**TBM \_ SETLINESIZE**](tbm-setlinesize.md) 訊息。</span><span class="sxs-lookup"><span data-stu-id="2cb36-156">To retrieve or set the line size, send the [**TBM\_GETLINESIZE**](tbm-getlinesize.md) and [**TBM\_SETLINESIZE**](tbm-setlinesize.md) messages.</span></span> <span data-ttu-id="2cb36-157">\_當使用者按下方向鍵時，這些對應項也會將 tb 的組合和 tb \_ LINEDOWN 通知碼傳送至其父視窗。</span><span class="sxs-lookup"><span data-stu-id="2cb36-157">The trackbar also sends the TB\_LINEUP and TB\_LINEDOWN notification codes to its parent window when the user presses the arrow keys.</span></span>

<span data-ttu-id="2cb36-158">追蹤點的頁面大小可決定滑杆回應鍵盤輸入的進度，例如 PAGE UP 或 PAGE DOWN 鍵，或滑鼠輸入，例如在 [追蹤] 通道中按一下。</span><span class="sxs-lookup"><span data-stu-id="2cb36-158">A trackbar's page size determines how far the slider moves in response to keyboard input, such as the PAGE UP or PAGE DOWN key, or mouse input, such as clicks in the trackbar channel.</span></span> <span data-ttu-id="2cb36-159">若要取得或設定頁面大小，請傳送 [**TBM \_ GETPAGESIZE**](tbm-getpagesize.md) 和 [**TBM \_ >setpagesize method**](tbm-setpagesize.md) 訊息。</span><span class="sxs-lookup"><span data-stu-id="2cb36-159">To retrieve or set the page size, send the [**TBM\_GETPAGESIZE**](tbm-getpagesize.md) and [**TBM\_SETPAGESIZE**](tbm-setpagesize.md) messages.</span></span> <span data-ttu-id="2cb36-160">\_當您收到滾動頁的鍵盤或滑鼠輸入時，這些頁首也會將 tb PAGEUP 和 tb \_ PAGEDOWN 通知碼傳送至其父視窗。</span><span class="sxs-lookup"><span data-stu-id="2cb36-160">The trackbar also sends the TB\_PAGEUP and TB\_PAGEDOWN notification codes to its parent window when it receives keyboard or mouse input that scrolls the page.</span></span> <span data-ttu-id="2cb36-161">如需詳細資訊，請參閱「資料 [提示通知訊息](#trackbar-notification-messages)」。</span><span class="sxs-lookup"><span data-stu-id="2cb36-161">For more information, see [Trackbar Notification Messages](#trackbar-notification-messages).</span></span>

<span data-ttu-id="2cb36-162">應用程式可以傳送訊息，以抓取資訊提供程式的維度。</span><span class="sxs-lookup"><span data-stu-id="2cb36-162">An application can send messages to retrieve the dimensions of a trackbar.</span></span> <span data-ttu-id="2cb36-163">[**TBM \_ GETTHUMBRECT**](tbm-getthumbrect.md)訊息會抓取滑杆的周框。</span><span class="sxs-lookup"><span data-stu-id="2cb36-163">The [**TBM\_GETTHUMBRECT**](tbm-getthumbrect.md) message retrieves the bounding rectangle for the slider.</span></span> <span data-ttu-id="2cb36-164">[**TBM \_ GETTHUMBLENGTH**](tbm-getthumblength.md)訊息會捕獲滑杆的長度。</span><span class="sxs-lookup"><span data-stu-id="2cb36-164">The [**TBM\_GETTHUMBLENGTH**](tbm-getthumblength.md) message retrieves the length of the slider.</span></span> <span data-ttu-id="2cb36-165">[**TBM \_ GETCHANNELRECT**](tbm-getchannelrect.md)訊息會抓取用來表示滑杆通道的周框，也就是滑杆移動的區域。</span><span class="sxs-lookup"><span data-stu-id="2cb36-165">The [**TBM\_GETCHANNELRECT**](tbm-getchannelrect.md) message retrieves the bounding rectangle for the trackbar's channel, which is the area over which the slider moves.</span></span> <span data-ttu-id="2cb36-166">它包含選取範圍時的醒目提示。</span><span class="sxs-lookup"><span data-stu-id="2cb36-166">It contains the highlight when a range is selected.</span></span> <span data-ttu-id="2cb36-167">如果 FIXEDLENGTH 樣式有 [ [**TBS \_**](trackbar-control-styles.md) ]，您可以傳送 [**TBM \_ SETTHUMBLENGTH**](tbm-setthumblength.md) 訊息來變更滑杆的長度。</span><span class="sxs-lookup"><span data-stu-id="2cb36-167">If a trackbar has the [**TBS\_FIXEDLENGTH**](trackbar-control-styles.md) style, you can send the [**TBM\_SETTHUMBLENGTH**](tbm-setthumblength.md) message to change the length of the slider.</span></span>

<span data-ttu-id="2cb36-168">您可以藉由將訊息傳送至 [選取範圍]，來取得或設定選取範圍。</span><span class="sxs-lookup"><span data-stu-id="2cb36-168">You retrieve or set the selection range by sending messages to the trackbar.</span></span> <span data-ttu-id="2cb36-169">使用 [**TBM \_ SETSEL**](tbm-setsel.md) 訊息來設定選取專案的開始和結束位置。</span><span class="sxs-lookup"><span data-stu-id="2cb36-169">Use the [**TBM\_SETSEL**](tbm-setsel.md) message to set the starting and ending positions of a selection.</span></span> <span data-ttu-id="2cb36-170">若只設定開始位置，或只設定選取範圍的結束位置，請傳送 [**TBM \_ SETSELSTART**](tbm-setselstart.md) 或 [**TBM \_ SETSELEND**](tbm-setselend.md) 訊息。</span><span class="sxs-lookup"><span data-stu-id="2cb36-170">To set just the starting position or just the ending position of a selection, send a [**TBM\_SETSELSTART**](tbm-setselstart.md) or [**TBM\_SETSELEND**](tbm-setselend.md) message.</span></span> <span data-ttu-id="2cb36-171">若要取得選取範圍的開始或結束位置，請傳送 [**TBM \_ GETSELSTART**](tbm-getselstart.md) 或 [**TBM \_ GETSELEND**](tbm-getselend.md) 訊息。</span><span class="sxs-lookup"><span data-stu-id="2cb36-171">To retrieve the starting or ending positions of a selection range, send a [**TBM\_GETSELSTART**](tbm-getselstart.md) or [**TBM\_GETSELEND**](tbm-getselend.md) message.</span></span> <span data-ttu-id="2cb36-172">若要清除選取範圍，並將其還原至其原始範圍，請傳送 [**TBM \_ CLEARSEL**](tbm-clearsel.md) 訊息。</span><span class="sxs-lookup"><span data-stu-id="2cb36-172">To clear a selection range and restore the trackbar to its original range, send the [**TBM\_CLEARSEL**](tbm-clearsel.md) message.</span></span>

> [!Note]  
> <span data-ttu-id="2cb36-173">應用程式必須負責確保使用者無法選取選取範圍以外的值。</span><span class="sxs-lookup"><span data-stu-id="2cb36-173">It is the application's responsibility to ensure that the user cannot select values outside the selection range.</span></span> <span data-ttu-id="2cb36-174">控制項本身不會防止使用者將滑杆移至範圍之外。</span><span class="sxs-lookup"><span data-stu-id="2cb36-174">The control itself does not prevent the user from moving the slider outside the range.</span></span>

 

## <a name="trackbar-notification-messages"></a><span data-ttu-id="2cb36-175">資訊提示通知訊息</span><span class="sxs-lookup"><span data-stu-id="2cb36-175">Trackbar Notification Messages</span></span>

<span data-ttu-id="2cb36-176">藉由將父系 [**\_ HSCROLL**](wm-hscroll.md) 或 [**wm \_ VSCROLL**](wm-vscroll.md) 訊息傳送給父系，以將其父視窗通知使用者動作。</span><span class="sxs-lookup"><span data-stu-id="2cb36-176">A trackbar notifies its parent window of user actions by sending the parent a [**WM\_HSCROLL**](wm-hscroll.md) or [**WM\_VSCROLL**](wm-vscroll.md) message.</span></span> <span data-ttu-id="2cb36-177">具有 [Tb] [**\_ HORZ**](trackbar-control-styles.md) 樣式的 [使用中]，會傳送 **WM \_ HSCROLL** 訊息。</span><span class="sxs-lookup"><span data-stu-id="2cb36-177">A trackbar with the [**TBS\_HORZ**](trackbar-control-styles.md) style sends **WM\_HSCROLL** messages.</span></span> <span data-ttu-id="2cb36-178">具有 [**TBS \_ 垂直**](trackbar-control-styles.md) 樣式的「使用中」的訊息會傳送 **WM \_ VSCROLL** 訊息。</span><span class="sxs-lookup"><span data-stu-id="2cb36-178">A trackbar with the [**TBS\_VERT**](trackbar-control-styles.md) style sends **WM\_VSCROLL** messages.</span></span> <span data-ttu-id="2cb36-179">**Wm \_ HSCROLL** 或 **WM \_ VSCROLL** 之 *wParam* 參數的低序位文字包含通知碼。</span><span class="sxs-lookup"><span data-stu-id="2cb36-179">The low-order word of the *wParam* parameter of **WM\_HSCROLL** or **WM\_VSCROLL** contains the notification code.</span></span> <span data-ttu-id="2cb36-180">針對 TB \_ THUMBPOSITION 和 tb \_ THUMBTRACK 通知碼， *wParam* 參數的高序位字組會指定滑杆的位置。</span><span class="sxs-lookup"><span data-stu-id="2cb36-180">For the TB\_THUMBPOSITION and TB\_THUMBTRACK notification codes, the high-order word of the *wParam* parameter specifies the position of the slider.</span></span> <span data-ttu-id="2cb36-181">若為所有其他通知碼，高序位字是零;傳送 [**TBM \_ GETPOS**](tbm-getpos.md) 訊息來判斷滑杆的位置。</span><span class="sxs-lookup"><span data-stu-id="2cb36-181">For all other notification codes, the high-order word is zero; send the [**TBM\_GETPOS**](tbm-getpos.md) message to determine the slider position.</span></span> <span data-ttu-id="2cb36-182">*LParam* 參數是對等的控制碼。</span><span class="sxs-lookup"><span data-stu-id="2cb36-182">The *lParam* parameter is the handle to the trackbar.</span></span>

<span data-ttu-id="2cb36-183">\_ \_ \_ \_ 只有當使用者使用鍵盤與頁首互動時，系統才會傳送 TB 的底部、tb LINEDOWN、TB 的組合和 tb 的最高通知碼。</span><span class="sxs-lookup"><span data-stu-id="2cb36-183">The system sends the TB\_BOTTOM, TB\_LINEDOWN, TB\_LINEUP, and TB\_TOP notification codes only when the user interacts with a trackbar by using the keyboard.</span></span> <span data-ttu-id="2cb36-184">\_ \_ 只有當使用者使用滑鼠時，才會傳送 TB THUMBPOSITION 和 tb THUMBTRACK 通知碼。</span><span class="sxs-lookup"><span data-stu-id="2cb36-184">The TB\_THUMBPOSITION and TB\_THUMBTRACK notification codes are only sent when the user is using the mouse.</span></span> <span data-ttu-id="2cb36-185">\_ \_ \_ 在這兩種情況下都會傳送 tb 的 ENDTRACK、TB PAGEDOWN 和 tb PAGEUP 通知碼。</span><span class="sxs-lookup"><span data-stu-id="2cb36-185">The TB\_ENDTRACK, TB\_PAGEDOWN, and TB\_PAGEUP notification codes are sent in both cases.</span></span> <span data-ttu-id="2cb36-186">下表列出的是 (的虛擬機器碼程式碼，以及會導致傳送 [**虛擬金鑰代碼**](/windows/desktop/inputdev/virtual-key-codes)通知的滑鼠事件) 的事件。</span><span class="sxs-lookup"><span data-stu-id="2cb36-186">The following table lists the trackbar notification codes and the events (virtual key codes or mouse events) that cause the [**Virtual-Key Codes**](/windows/desktop/inputdev/virtual-key-codes)notifications to be sent.</span></span>



| <span data-ttu-id="2cb36-187">通知碼</span><span class="sxs-lookup"><span data-stu-id="2cb36-187">Notification code</span></span> | <span data-ttu-id="2cb36-188">已傳送的原因</span><span class="sxs-lookup"><span data-stu-id="2cb36-188">Reason sent</span></span>                                                                                                                     |
|-------------------|---------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="2cb36-189">TB \_ 底部</span><span class="sxs-lookup"><span data-stu-id="2cb36-189">TB\_BOTTOM</span></span>        | [<span data-ttu-id="2cb36-190">**VK \_ 結束**</span><span class="sxs-lookup"><span data-stu-id="2cb36-190">**VK\_END**</span></span>](/windows/desktop/inputdev/virtual-key-codes)                                                                         |
| <span data-ttu-id="2cb36-191">TB \_ ENDTRACK</span><span class="sxs-lookup"><span data-stu-id="2cb36-191">TB\_ENDTRACK</span></span>      | <span data-ttu-id="2cb36-192">[**WM \_KEYUP**](/windows/desktop/inputdev/wm-keyup) (使用者發行了一個傳送相關虛擬機器碼的金鑰) </span><span class="sxs-lookup"><span data-stu-id="2cb36-192">[**WM\_KEYUP**](/windows/desktop/inputdev/wm-keyup) (the user released a key that sent a relevant virtual key code)</span></span>                              |
| <span data-ttu-id="2cb36-193">TB \_ LINEDOWN</span><span class="sxs-lookup"><span data-stu-id="2cb36-193">TB\_LINEDOWN</span></span>      | <span data-ttu-id="2cb36-194">[**VK \_向右**](/windows/desktop/inputdev/virtual-key-codes)或 [ **\_ 向下 VK**](/windows/desktop/inputdev/virtual-key-codes)</span><span class="sxs-lookup"><span data-stu-id="2cb36-194">[**VK\_RIGHT**](/windows/desktop/inputdev/virtual-key-codes) or [**VK\_DOWN**](/windows/desktop/inputdev/virtual-key-codes)</span></span>     |
| <span data-ttu-id="2cb36-195">TB 的 \_ 系列</span><span class="sxs-lookup"><span data-stu-id="2cb36-195">TB\_LINEUP</span></span>        | <span data-ttu-id="2cb36-196">[**VK \_LEFT**](/windows/desktop/inputdev/virtual-key-codes)或 [ **VK \_ UP**](/windows/desktop/inputdev/virtual-key-codes)</span><span class="sxs-lookup"><span data-stu-id="2cb36-196">[**VK\_LEFT**](/windows/desktop/inputdev/virtual-key-codes) or [**VK\_UP**](/windows/desktop/inputdev/virtual-key-codes)</span></span>              |
| <span data-ttu-id="2cb36-197">TB \_ PAGEDOWN</span><span class="sxs-lookup"><span data-stu-id="2cb36-197">TB\_PAGEDOWN</span></span>      | <span data-ttu-id="2cb36-198">[**VK \_接下來**](/windows/desktop/inputdev/virtual-key-codes) (使用者按一下滑杆下方或右邊的頻道) </span><span class="sxs-lookup"><span data-stu-id="2cb36-198">[**VK\_NEXT**](/windows/desktop/inputdev/virtual-key-codes) (the user clicked the channel below or to the right of the slider)</span></span>   |
| <span data-ttu-id="2cb36-199">TB \_ PAGEUP</span><span class="sxs-lookup"><span data-stu-id="2cb36-199">TB\_PAGEUP</span></span>        | <span data-ttu-id="2cb36-200">[**VK \_之前**](/windows/desktop/inputdev/virtual-key-codes) (使用者按一下滑杆上方或左邊的頻道) </span><span class="sxs-lookup"><span data-stu-id="2cb36-200">[**VK\_PRIOR**](/windows/desktop/inputdev/virtual-key-codes) (the user clicked the channel above or to the left of the slider)</span></span> |
| <span data-ttu-id="2cb36-201">TB \_ THUMBPOSITION</span><span class="sxs-lookup"><span data-stu-id="2cb36-201">TB\_THUMBPOSITION</span></span> | <span data-ttu-id="2cb36-202">[**WM \_LBUTTONUP**](/windows/desktop/inputdev/wm-lbuttonup) 遵循 TB \_ THUMBTRACK 通知碼</span><span class="sxs-lookup"><span data-stu-id="2cb36-202">[**WM\_LBUTTONUP**](/windows/desktop/inputdev/wm-lbuttonup) following a TB\_THUMBTRACK notification code</span></span>                                         |
| <span data-ttu-id="2cb36-203">TB \_ THUMBTRACK</span><span class="sxs-lookup"><span data-stu-id="2cb36-203">TB\_THUMBTRACK</span></span>    | <span data-ttu-id="2cb36-204">滑杆移動 (使用者拖曳滑杆) </span><span class="sxs-lookup"><span data-stu-id="2cb36-204">Slider movement (the user dragged the slider)</span></span>                                                                                   |
| <span data-ttu-id="2cb36-205">TB \_ TOP</span><span class="sxs-lookup"><span data-stu-id="2cb36-205">TB\_TOP</span></span>           | [<span data-ttu-id="2cb36-206">**VK \_ 首頁**</span><span class="sxs-lookup"><span data-stu-id="2cb36-206">**VK\_HOME**</span></span>](/windows/desktop/inputdev/virtual-key-codes)                                                                      |



 

## <a name="default-trackbar-message-processing"></a><span data-ttu-id="2cb36-207">預設的顯示訊息處理</span><span class="sxs-lookup"><span data-stu-id="2cb36-207">Default Trackbar Message Processing</span></span>

<span data-ttu-id="2cb36-208">本章節描述由處理常式執行的視窗訊息處理。</span><span class="sxs-lookup"><span data-stu-id="2cb36-208">This section describes the window message processing performed by a trackbar.</span></span>



| <span data-ttu-id="2cb36-209">訊息</span><span class="sxs-lookup"><span data-stu-id="2cb36-209">Message</span></span>                                              | <span data-ttu-id="2cb36-210">處理已執行</span><span class="sxs-lookup"><span data-stu-id="2cb36-210">Processing performed</span></span>                                                                                                                                                                                                                                     |
|------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="2cb36-211">**WM \_ CAPTURECHANGED**</span><span class="sxs-lookup"><span data-stu-id="2cb36-211">**WM\_CAPTURECHANGED**</span></span>](/windows/desktop/inputdev/wm-capturechanged) | <span data-ttu-id="2cb36-212">如果已在 [**WM \_ LBUTTONDOWN**](/windows/desktop/inputdev/wm-lbuttondown) 處理期間設定計時器，則會將它刪除，並在必要時傳送 TB \_ THUMBPOSITION 通知碼。</span><span class="sxs-lookup"><span data-stu-id="2cb36-212">Kills the timer if one was set during [**WM\_LBUTTONDOWN**](/windows/desktop/inputdev/wm-lbuttondown) processing and sends the TB\_THUMBPOSITION notification code, if necessary.</span></span> <span data-ttu-id="2cb36-213">它一律會傳送 TB 的 \_ ENDTRACK 通知程式碼。</span><span class="sxs-lookup"><span data-stu-id="2cb36-213">It always sends the TB\_ENDTRACK notification code.</span></span>                                     |
| [<span data-ttu-id="2cb36-214">**WM \_ 建立**</span><span class="sxs-lookup"><span data-stu-id="2cb36-214">**WM\_CREATE**</span></span>](/windows/desktop/winmsg/wm-create)                   | <span data-ttu-id="2cb36-215">執行其他初始化，例如將行大小、頁面大小和刻度標記頻率設定為預設值。</span><span class="sxs-lookup"><span data-stu-id="2cb36-215">Performs additional initialization, such as setting the line size, page size, and tick mark frequency to default values.</span></span>                                                                                                                                 |
| [<span data-ttu-id="2cb36-216">**WM 損 \_ 毀**</span><span class="sxs-lookup"><span data-stu-id="2cb36-216">**WM\_DESTROY**</span></span>](/windows/desktop/winmsg/wm-destroy)                 | <span data-ttu-id="2cb36-217">釋出資源。</span><span class="sxs-lookup"><span data-stu-id="2cb36-217">Frees resources.</span></span>                                                                                                                                                                                                                                         |
| [<span data-ttu-id="2cb36-218">**\_啟用 WM**</span><span class="sxs-lookup"><span data-stu-id="2cb36-218">**WM\_ENABLE**</span></span>](/windows/desktop/winmsg/wm-enable)                   | <span data-ttu-id="2cb36-219">重新繪製 [[] [跟蹤條] 視窗。</span><span class="sxs-lookup"><span data-stu-id="2cb36-219">Repaints the trackbar window.</span></span>                                                                                                                                                                                                                            |
| [<span data-ttu-id="2cb36-220">**WM \_ ERASEBKGND**</span><span class="sxs-lookup"><span data-stu-id="2cb36-220">**WM\_ERASEBKGND**</span></span>](/windows/desktop/winmsg/wm-erasebkgnd)           | <span data-ttu-id="2cb36-221">使用目前的背景色彩來清除視窗背景。</span><span class="sxs-lookup"><span data-stu-id="2cb36-221">Erases the window background, using the current background color for the trackbar.</span></span>                                                                                                                                                                       |
| [<span data-ttu-id="2cb36-222">**WM \_ GETDLGCODE**</span><span class="sxs-lookup"><span data-stu-id="2cb36-222">**WM\_GETDLGCODE**</span></span>](/windows/desktop/dlgbox/wm-getdlgcode)           | <span data-ttu-id="2cb36-223">傳回 DLGC \_ WANTARROWS 值。</span><span class="sxs-lookup"><span data-stu-id="2cb36-223">Returns the DLGC\_WANTARROWS value.</span></span>                                                                                                                                                                                                                      |
| [<span data-ttu-id="2cb36-224">**WM \_ KEYDOWN**</span><span class="sxs-lookup"><span data-stu-id="2cb36-224">**WM\_KEYDOWN**</span></span>](/windows/desktop/inputdev/wm-keydown)               | <span data-ttu-id="2cb36-225">適當地處理方向機碼，並傳送 TB 的 \_ 最高、tb 的 \_ 底部、tb \_ PAGEUP、TB \_ PAGEDOWN、TB 的組合 \_ 和 tb \_ LINEDOWN 通知碼。</span><span class="sxs-lookup"><span data-stu-id="2cb36-225">Processes the direction keys and sends the TB\_TOP, TB\_BOTTOM, TB\_PAGEUP, TB\_PAGEDOWN, TB\_LINEUP, and TB\_LINEDOWN notification codes, as appropriate.</span></span>                                                                                               |
| [<span data-ttu-id="2cb36-226">**WM \_ KEYUP**</span><span class="sxs-lookup"><span data-stu-id="2cb36-226">**WM\_KEYUP**</span></span>](/windows/desktop/inputdev/wm-keyup)                   | <span data-ttu-id="2cb36-227">\_如果金鑰是其中一個方向機碼，則傳送 TB 的 ENDTRACK 通知程式碼。</span><span class="sxs-lookup"><span data-stu-id="2cb36-227">Sends the TB\_ENDTRACK notification code if the key was one of the direction keys.</span></span>                                                                                                                                                                       |
| [<span data-ttu-id="2cb36-228">**WM \_ KILLFOCUS**</span><span class="sxs-lookup"><span data-stu-id="2cb36-228">**WM\_KILLFOCUS**</span></span>](/windows/desktop/inputdev/wm-killfocus)           | <span data-ttu-id="2cb36-229">重新繪製 [[] [跟蹤條] 視窗。</span><span class="sxs-lookup"><span data-stu-id="2cb36-229">Repaints the trackbar window.</span></span>                                                                                                                                                                                                                            |
| [<span data-ttu-id="2cb36-230">**WM \_ LBUTTONDOWN**</span><span class="sxs-lookup"><span data-stu-id="2cb36-230">**WM\_LBUTTONDOWN**</span></span>](/windows/desktop/inputdev/wm-lbuttondown)       | <span data-ttu-id="2cb36-231">將焦點和滑鼠捕捉設定至字幕。</span><span class="sxs-lookup"><span data-stu-id="2cb36-231">Sets the focus and the mouse capture to the trackbar.</span></span> <span data-ttu-id="2cb36-232">必要時，它會設定計時器，以決定當使用者按住視窗中的滑鼠按鍵時，滑杆朝滑鼠游標移動的速度。</span><span class="sxs-lookup"><span data-stu-id="2cb36-232">When necessary, it sets a timer that determines how quickly the slider moves toward the mouse cursor when the user holds down the mouse button in the window.</span></span>                                      |
| [<span data-ttu-id="2cb36-233">**WM \_ LBUTTONUP**</span><span class="sxs-lookup"><span data-stu-id="2cb36-233">**WM\_LBUTTONUP**</span></span>](/windows/desktop/inputdev/wm-lbuttonup)           | <span data-ttu-id="2cb36-234">釋放滑鼠捕捉並終止計時器（如果在進行 [**WM \_ LBUTTONDOWN**](/windows/desktop/inputdev/wm-lbuttondown) 處理期間設定計時器）。</span><span class="sxs-lookup"><span data-stu-id="2cb36-234">Releases the mouse capture and terminates the timer if one was set during [**WM\_LBUTTONDOWN**](/windows/desktop/inputdev/wm-lbuttondown) processing.</span></span> <span data-ttu-id="2cb36-235">如有必要，它會傳送 TB 的 \_ THUMBPOSITION 通知碼。</span><span class="sxs-lookup"><span data-stu-id="2cb36-235">It sends the TB\_THUMBPOSITION notification code, if necessary.</span></span> <span data-ttu-id="2cb36-236">它一律會傳送 TB 的 \_ ENDTRACK 通知程式碼。</span><span class="sxs-lookup"><span data-stu-id="2cb36-236">It always sends the TB\_ENDTRACK notification code.</span></span> |
| [<span data-ttu-id="2cb36-237">**WM \_ MOUSEMOVE**</span><span class="sxs-lookup"><span data-stu-id="2cb36-237">**WM\_MOUSEMOVE**</span></span>](/windows/desktop/inputdev/wm-mousemove)           | <span data-ttu-id="2cb36-238">移動滑杆，並 \_ 在追蹤滑鼠 (查看 [**WM \_ 計時器**](/windows/desktop/winmsg/wm-timer)) 時傳送 TB 的 THUMBTRACK 通知程式碼。</span><span class="sxs-lookup"><span data-stu-id="2cb36-238">Moves the slider and sends the TB\_THUMBTRACK notification code when tracking the mouse (see [**WM\_TIMER**](/windows/desktop/winmsg/wm-timer)).</span></span>                                                                                                                          |
| [<span data-ttu-id="2cb36-239">**WM \_ 油漆**</span><span class="sxs-lookup"><span data-stu-id="2cb36-239">**WM\_PAINT**</span></span>](/windows/desktop/gdi/wm-paint)                        | <span data-ttu-id="2cb36-240">繪製跟蹤條。</span><span class="sxs-lookup"><span data-stu-id="2cb36-240">Paints the trackbar.</span></span> <span data-ttu-id="2cb36-241">如果 wParam 參數不是 Null，則控制項會假設值為 HDC，並且使用該裝置內容繪製。</span><span class="sxs-lookup"><span data-stu-id="2cb36-241">If the wParam parameter is non-NULL, the control assumes that the value is an HDC and paints using that device context.</span></span>                                                                                                             |
| [<span data-ttu-id="2cb36-242">**WM \_ SETFOCUS**</span><span class="sxs-lookup"><span data-stu-id="2cb36-242">**WM\_SETFOCUS**</span></span>](/windows/desktop/inputdev/wm-setfocus)             | <span data-ttu-id="2cb36-243">重新繪製 [[] [跟蹤條] 視窗。</span><span class="sxs-lookup"><span data-stu-id="2cb36-243">Repaints the trackbar window.</span></span>                                                                                                                                                                                                                            |
| [<span data-ttu-id="2cb36-244">**WM \_ 大小**</span><span class="sxs-lookup"><span data-stu-id="2cb36-244">**WM\_SIZE**</span></span>](/windows/desktop/winmsg/wm-size)                       | <span data-ttu-id="2cb36-245">設定捲軸的維度，如果沒有足夠空間可顯示滑杆，則移除滑杆。</span><span class="sxs-lookup"><span data-stu-id="2cb36-245">Sets the dimensions of the trackbar, removing the slider if there is not enough room to display it.</span></span>                                                                                                                                                      |
| [<span data-ttu-id="2cb36-246">**WM \_ 計時器**</span><span class="sxs-lookup"><span data-stu-id="2cb36-246">**WM\_TIMER**</span></span>](/windows/desktop/winmsg/wm-timer)                     | <span data-ttu-id="2cb36-247">抓取滑鼠位置並更新滑杆的位置。</span><span class="sxs-lookup"><span data-stu-id="2cb36-247">Retrieves the mouse position and updates the position of the slider.</span></span> <span data-ttu-id="2cb36-248"> (只有在使用者拖曳滑杆時，才會收到此功能。 ) </span><span class="sxs-lookup"><span data-stu-id="2cb36-248">(It is received only when the user is dragging the slider.)</span></span>                                                                                                                         |
| [<span data-ttu-id="2cb36-249">**WM \_ WININICHANGE**</span><span class="sxs-lookup"><span data-stu-id="2cb36-249">**WM\_WININICHANGE**</span></span>](/windows/desktop/winmsg/wm-wininichange)       | <span data-ttu-id="2cb36-250">初始化滑杆維度。</span><span class="sxs-lookup"><span data-stu-id="2cb36-250">Initializes slider dimensions.</span></span>                                                                                                                                                                                                                           |



 

## <a name="trackbar-tooltips"></a><span data-ttu-id="2cb36-251">跟蹤工具工具提示</span><span class="sxs-lookup"><span data-stu-id="2cb36-251">Trackbar Tooltips</span></span>

<span data-ttu-id="2cb36-252">使用 [ [**tb] \_ 工具提示**](trackbar-control-styles.md) 樣式建立的 [使用的]，會有預設的工具提示控制項。</span><span class="sxs-lookup"><span data-stu-id="2cb36-252">A trackbar that is created with the [**TBS\_TOOLTIPS**](trackbar-control-styles.md) style has a default tooltip control.</span></span> <span data-ttu-id="2cb36-253">當使用者使用滑鼠拖曳滑杆時，工具提示會保持可見，並顯示目前的值。</span><span class="sxs-lookup"><span data-stu-id="2cb36-253">The tooltip remains visible and displays the current value as the user drags the slider using the mouse.</span></span>

<span data-ttu-id="2cb36-254">您可以藉由傳送 [**TBM \_ SETTOOLTIPS**](tbm-settooltips.md) 訊息，將新的工具提示控制項指派給程式。</span><span class="sxs-lookup"><span data-stu-id="2cb36-254">You can assign a new tooltip control to a trackbar by sending the [**TBM\_SETTOOLTIPS**](tbm-settooltips.md) message.</span></span> <span data-ttu-id="2cb36-255">若要取得指派的工具提示控制項的控制碼，請使用 [**TBM \_ GETTOOLTIPS**](tbm-gettooltips.md) 訊息。</span><span class="sxs-lookup"><span data-stu-id="2cb36-255">To retrieve the handle to an assigned tooltip control, use the [**TBM\_GETTOOLTIPS**](tbm-gettooltips.md) message.</span></span>

 

 