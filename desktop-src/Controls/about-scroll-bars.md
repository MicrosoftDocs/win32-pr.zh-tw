---
title: 關於捲軸
description: 視窗可以顯示大於視窗工作區的資料物件，例如，檔或點陣圖。
ms.assetid: 9cb3afad-79ef-4817-950a-c8c1de39401b
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 9d410e98ea1fe722d6dc1c4869010df30f99bddb
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/21/2020
ms.locfileid: "104024120"
---
# <a name="about-scroll-bars"></a><span data-ttu-id="e3bf3-103">關於捲軸</span><span class="sxs-lookup"><span data-stu-id="e3bf3-103">About Scroll Bars</span></span>

<span data-ttu-id="e3bf3-104">視窗可以顯示大於視窗工作區的資料物件，例如，檔或點陣圖。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-104">A window can display a data object, such as a document or a bitmap, that is larger than the window's client area.</span></span> <span data-ttu-id="e3bf3-105">當使用捲軸來提供時，使用者可以在工作區中滾動資料物件，以查看超出視窗框線的物件部分。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-105">When provided with a scroll bar, the user can scroll a data object in the client area to bring into view the portions of the object that extend beyond the borders of the window.</span></span>

<span data-ttu-id="e3bf3-106">捲軸應該包含在用戶端區域內容超出視窗框線的任何視窗中。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-106">Scroll bars should be included in any window for which the content of the client area extends beyond the window's borders.</span></span> <span data-ttu-id="e3bf3-107">捲軸的方向決定當使用者操作捲軸時，滾動發生的方向。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-107">A scroll bar's orientation determines the direction in which scrolling occurs when the user operates the scroll bar.</span></span> <span data-ttu-id="e3bf3-108">水準捲軸可讓使用者將視窗的內容向左或向右滾動。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-108">A horizontal scroll bar enables the user to scroll the content of a window to the left or right.</span></span> <span data-ttu-id="e3bf3-109">垂直捲動條可讓使用者將內容向上或向下滾動。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-109">A vertical scroll bar enables the user to scroll the content up or down.</span></span>

<span data-ttu-id="e3bf3-110">本節將討論下列主題。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-110">The following topics are discussed in this section.</span></span>

-   [<span data-ttu-id="e3bf3-111">捲軸的部分</span><span class="sxs-lookup"><span data-stu-id="e3bf3-111">Parts of a Scroll Bar</span></span>](#parts-of-a-scroll-bar)
-   [<span data-ttu-id="e3bf3-112">標準捲軸和捲軸控制項</span><span class="sxs-lookup"><span data-stu-id="e3bf3-112">Standard Scroll Bars and Scroll Bar Controls</span></span>](#standard-scroll-bars-and-scroll-bar-controls)
-   [<span data-ttu-id="e3bf3-113">捲動方塊位置和滾動範圍</span><span class="sxs-lookup"><span data-stu-id="e3bf3-113">Scroll Box Position and Scrolling Range</span></span>](#scroll-box-position-and-scrolling-range)
-   [<span data-ttu-id="e3bf3-114">捲軸可見度</span><span class="sxs-lookup"><span data-stu-id="e3bf3-114">Scroll Bar Visibility</span></span>](#scroll-bar-visibility)
-   [<span data-ttu-id="e3bf3-115">捲軸要求</span><span class="sxs-lookup"><span data-stu-id="e3bf3-115">Scroll Bar Requests</span></span>](#scroll-bar-requests)
-   [<span data-ttu-id="e3bf3-116">捲軸的鍵盤介面</span><span class="sxs-lookup"><span data-stu-id="e3bf3-116">Keyboard Interface for a Scroll Bar</span></span>](#keyboard-interface-for-a-scroll-bar)
-   [<span data-ttu-id="e3bf3-117">滾動工作區</span><span class="sxs-lookup"><span data-stu-id="e3bf3-117">Scrolling the Client Area</span></span>](#scrolling-the-client-area)
-   [<span data-ttu-id="e3bf3-118">捲軸色彩和度量</span><span class="sxs-lookup"><span data-stu-id="e3bf3-118">Scroll Bar Colors and Metrics</span></span>](#scroll-bar-colors-and-metrics)

## <a name="parts-of-a-scroll-bar"></a><span data-ttu-id="e3bf3-119">捲軸的部分</span><span class="sxs-lookup"><span data-stu-id="e3bf3-119">Parts of a Scroll Bar</span></span>

<span data-ttu-id="e3bf3-120">捲軸包含一個陰影軸，其中每一端有一個箭號按鈕，而 *捲動方塊* (有時也稱為箭號按鈕之間的捲動方塊) 。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-120">A scroll bar consists of a shaded shaft with an arrow button at each end and a *scroll box* (sometimes called a thumb) between the arrow buttons.</span></span> <span data-ttu-id="e3bf3-121">捲軸代表視窗工作區中資料物件的整體長度或寬度;捲動方塊代表在工作區中可見的物件部分。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-121">A scroll bar represents the overall length or width of a data object in a window's client area; the scroll box represents the portion of the object that is visible in the client area.</span></span> <span data-ttu-id="e3bf3-122">每當使用者滾動資料物件以顯示其不同部分時，捲動方塊的位置就會變更。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-122">The position of the scroll box changes whenever the user scrolls a data object to display a different portion of it.</span></span> <span data-ttu-id="e3bf3-123">系統也會調整捲軸捲動方塊的大小，使其指出整個資料物件的哪個部分目前顯示在視窗中。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-123">The system also adjusts the size of a scroll bar's scroll box so that it indicates what portion of the entire data object is currently visible in the window.</span></span> <span data-ttu-id="e3bf3-124">如果大部分的物件都是可見的，則捲動方塊會佔用大部分的捲軸軸。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-124">If most of the object is visible, the scroll box occupies most of the scroll bar shaft.</span></span> <span data-ttu-id="e3bf3-125">同樣地，如果只顯示物件的一小部分，則捲動方塊會佔用捲軸軸的一小部分。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-125">Similarly, if only a small portion of the object is visible, the scroll box occupies a small part of the scroll bar shaft.</span></span>

<span data-ttu-id="e3bf3-126">使用者可以按一下其中一個箭號按鈕、按一下陰影捲軸軸中的區域，或拖曳捲動方塊，來滾動視窗的內容。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-126">The user scrolls the content of a window by clicking one of the arrow buttons, by clicking the area in the shaded scroll bar shaft, or by dragging the scroll box.</span></span> <span data-ttu-id="e3bf3-127">當使用者按一下箭號按鈕時，應用程式會以一個單位將內容滾動 (通常是一行或欄) 。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-127">When the user clicks an arrow button, the application scrolls the content by one unit (typically a single line or column).</span></span> <span data-ttu-id="e3bf3-128">當使用者按一下陰影區域時，應用程式會將內容滾動一個視窗。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-128">When the user clicks the shaded areas, the application scrolls the content by one window.</span></span> <span data-ttu-id="e3bf3-129">當使用者拖曳捲動方塊時所發生的滾動量，取決於使用者拖曳捲動方塊的距離，以及捲軸的滾動範圍。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-129">The amount of scrolling that occurs when the user drags the scroll box depends on the distance the user drags the scroll box and on the scrolling range of the scroll bar.</span></span> <span data-ttu-id="e3bf3-130">如需滾動範圍的詳細資訊，請參閱 [捲動方塊位置和滾動範圍](#scroll-box-position-and-scrolling-range)。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-130">For more information about the scrolling range, see [Scroll Box Position and Scrolling Range](#scroll-box-position-and-scrolling-range).</span></span>

<span data-ttu-id="e3bf3-131">下列螢幕擷取畫面顯示具有垂直和水準捲軸的 rich edit 控制項，因為它們可能出現在 Windows Vista 中。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-131">The following screen shot shows a rich edit control with vertical and horizontal scroll bars, as they might appear in Windows Vista.</span></span> <span data-ttu-id="e3bf3-132">垂直捲動條目前為「熱」，因為在拍攝螢幕擷取畫面時，滑鼠指標停留在其上方。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-132">The vertical scroll bar is currently "hot" because the mouse pointer was hovering over it when the screen shot was taken.</span></span>

![具有捲軸之 rich edit 控制項的螢幕擷取畫面](images/sbvista.png)

## <a name="standard-scroll-bars-and-scroll-bar-controls"></a><span data-ttu-id="e3bf3-134">標準捲軸和捲軸控制項</span><span class="sxs-lookup"><span data-stu-id="e3bf3-134">Standard Scroll Bars and Scroll Bar Controls</span></span>

<span data-ttu-id="e3bf3-135">捲軸會以標準捲軸或捲軸控制項的形式包含在視窗中。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-135">A scroll bar is included in a window either as a standard scroll bar or as a scroll bar control.</span></span> <span data-ttu-id="e3bf3-136">標準捲軸位於視窗的非工作區。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-136">A standard scroll bar is located in the nonclient area of a window.</span></span> <span data-ttu-id="e3bf3-137">它是以視窗建立，並在視窗顯示時顯示。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-137">It is created with the window and displayed when the window is displayed.</span></span> <span data-ttu-id="e3bf3-138">標準捲軸的唯一目的是讓使用者產生滾動要求來查看工作區的整個內容。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-138">The sole purpose of a standard scroll bar is to enable the user to generate scrolling requests for viewing the entire content of the client area.</span></span> <span data-ttu-id="e3bf3-139">您可以在建立視窗時指定 [**ws \_ HSCROLL**](/windows/desktop/winmsg/window-styles)、 [**WS \_ VSCROLL**](/windows/desktop/winmsg/window-styles)或這兩種樣式，以在視窗中包含標準捲軸。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-139">You can include a standard scroll bar in a window by specifying [**WS\_HSCROLL**](/windows/desktop/winmsg/window-styles), [**WS\_VSCROLL**](/windows/desktop/winmsg/window-styles), or both styles when you create the window.</span></span> <span data-ttu-id="e3bf3-140">**WS \_ HSCROLL** 樣式會建立位於工作區底部的水準捲軸。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-140">The **WS\_HSCROLL** style creates a horizontal scroll bar positioned at the bottom of the client area.</span></span> <span data-ttu-id="e3bf3-141">**WS \_ VSCROLL** 樣式會建立位於工作區右邊的垂直捲動條。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-141">The **WS\_VSCROLL** style creates a vertical scroll bar positioned at the right of the client area.</span></span> <span data-ttu-id="e3bf3-142">SM \_ CXHSCROLL 和 sm \_ CYHSCROLL 系統度量值會定義標準水準捲軸的寬度和高度。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-142">The SM\_CXHSCROLL and SM\_CYHSCROLL system metric values define the width and height of a standard horizontal scroll bar.</span></span> <span data-ttu-id="e3bf3-143">SM \_ CXVSCROLL 和 sm \_ CYVSCROLL 值會定義標準垂直捲動條的寬度和高度。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-143">The SM\_CXVSCROLL and SM\_CYVSCROLL values define the width and height of a standard vertical scroll bar.</span></span> <span data-ttu-id="e3bf3-144">標準捲軸是其相關視窗的一部分，因此沒有自己的視窗控制碼。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-144">A standard scroll bar is part of its associated window and therefore does not have a window handle of its own.</span></span>

<span data-ttu-id="e3bf3-145">捲軸控制項是屬於捲軸視窗類別的控制項視窗。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-145">A scroll bar control is a control window that belongs to the SCROLLBAR window class.</span></span> <span data-ttu-id="e3bf3-146">捲軸控制項隨即出現，並如同標準捲軸，但它是另一個視窗。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-146">A scroll bar control appears and functions like a standard scroll bar, but it is a separate window.</span></span> <span data-ttu-id="e3bf3-147">捲軸控制項是個別的視窗，會取得直接輸入焦點。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-147">As a separate window, a scroll bar control takes direct input focus.</span></span> <span data-ttu-id="e3bf3-148">不同于標準捲軸，捲軸控制項也有內建的鍵盤介面。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-148">Unlike a standard scroll bar, a scroll bar control also has a built-in keyboard interface.</span></span>

<span data-ttu-id="e3bf3-149">您可以在單一視窗中視需要使用任意數目的捲軸控制項。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-149">You can use as many scroll bar controls as needed in a single window.</span></span> <span data-ttu-id="e3bf3-150">當您建立捲軸控制項時，您必須指定捲軸的大小和位置。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-150">When you create a scroll bar control, you must specify the scroll bar's size and position.</span></span> <span data-ttu-id="e3bf3-151">但是，如果捲軸控制項的視窗可以調整大小，則每當視窗的大小變更時，就必須調整捲軸的大小。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-151">However, if a scroll bar control's window can be resized, adjustments to the scroll bar's size must be made whenever the size of the window changes.</span></span>

<span data-ttu-id="e3bf3-152">使用標準捲軸的優點是，系統會建立捲軸，並自動設定其大小和位置。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-152">The advantage of using a standard scroll bar is that the system creates the scroll bar and automatically sets its size and position.</span></span> <span data-ttu-id="e3bf3-153">但是，標準捲軸有時太過嚴格。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-153">However, standard scroll bars are sometimes too restrictive.</span></span> <span data-ttu-id="e3bf3-154">例如，假設您想要將工作區分割成象限，並使用一組不同的捲軸來控制每個象限的內容。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-154">For example, suppose that you want to divide a client area into quadrants and use a separate set of scroll bars to control the content of each quadrant.</span></span> <span data-ttu-id="e3bf3-155">您無法使用標準捲軸，因為您只能針對特定視窗建立一組捲軸。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-155">You cannot use standard scroll bars because you can only create one set of scroll bars for a particular window.</span></span> <span data-ttu-id="e3bf3-156">請改用捲軸控制項，因為您可以視需要將多個控制項加入至視窗。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-156">Use scroll bar controls instead, because you can add as many of them to a window as you want.</span></span>

<span data-ttu-id="e3bf3-157">應用程式除了滾動視窗內容之外，也可以針對其他用途提供捲軸控制項。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-157">Applications can provide scroll bar controls for purposes other than scrolling the content of a window.</span></span> <span data-ttu-id="e3bf3-158">例如，螢幕保護裝置應用程式可能會提供捲軸，讓您在螢幕上設定圖形的移動速度。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-158">For example, a screen saver application might provide a scroll bar for setting the speed at which graphics are moved about on the screen.</span></span>

<span data-ttu-id="e3bf3-159">捲軸控制項可以有許多樣式，用來控制捲軸的方向和位置。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-159">A scroll bar control can have a number of styles that serves to control the orientation and position of the scroll bar.</span></span> <span data-ttu-id="e3bf3-160">當您呼叫 [**CreateWindowEx**](/windows/desktop/api/winuser/nf-winuser-createwindowexa) 函式來建立捲軸控制項時，您會指定想要的樣式。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-160">You specify the styles that you want when you call the [**CreateWindowEx**](/windows/desktop/api/winuser/nf-winuser-createwindowexa) function to create a scroll bar control.</span></span> <span data-ttu-id="e3bf3-161">某些樣式會建立使用預設寬度或高度的捲軸控制項。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-161">Some of the styles create a scroll bar control that uses a default width or height.</span></span> <span data-ttu-id="e3bf3-162">不過，您一律必須指定捲軸的 x 和 y 座標，以及其他維度。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-162">However, you must always specify the x- and y-coordinates and the other dimensions of the scroll bar.</span></span>

<span data-ttu-id="e3bf3-163">如需捲軸控制項樣式的表格，請參閱 [捲軸控制項樣式](scroll-bar-control-styles.md)。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-163">For a table of scroll bar control styles, see [Scroll Bar Control Styles](scroll-bar-control-styles.md).</span></span>

> [!Note]  
> <span data-ttu-id="e3bf3-164">若要使用具有捲軸的視覺化樣式，應用程式必須包含資訊清單，而且必須在程式的開頭呼叫 [**InitCommonControls**](/windows/desktop/api/Commctrl/nf-commctrl-initcommoncontrols) 。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-164">To use visual styles with scroll bars, an application must include a manifest and must call [**InitCommonControls**](/windows/desktop/api/Commctrl/nf-commctrl-initcommoncontrols) at the beginning of the program.</span></span> <span data-ttu-id="e3bf3-165">如需視覺化樣式的詳細資訊，請參閱 [視覺化樣式](themes-overview.md)。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-165">For information on visual styles, see [Visual Styles](themes-overview.md).</span></span> <span data-ttu-id="e3bf3-166">如需資訊清單的詳細資訊，請參閱 [啟用視覺化樣式](cookbook-overview.md)。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-166">For information on manifests, see [Enabling Visual Styles](cookbook-overview.md).</span></span>

 

## <a name="scroll-box-position-and-scrolling-range"></a><span data-ttu-id="e3bf3-167">捲動方塊位置和滾動範圍</span><span class="sxs-lookup"><span data-stu-id="e3bf3-167">Scroll Box Position and Scrolling Range</span></span>

<span data-ttu-id="e3bf3-168">捲動方塊的位置以整數表示;這是相對於捲軸的左邊或上方，視捲軸為水準或垂直而定。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-168">The position of the scroll box is represented as an integer; it is relative to the left or upper end of the scroll bar, depending on whether the scroll bar is horizontal or vertical.</span></span> <span data-ttu-id="e3bf3-169">位置必須在滾動範圍的最小值和最大值內。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-169">The position must be within the minimum and maximum values of the scrolling range.</span></span> <span data-ttu-id="e3bf3-170">例如，在範圍為0到100的捲軸中，位置50是在中間，其餘的位置則沿著捲軸平均分佈。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-170">For example, in a scroll bar with a range of 0 through 100, position 50 is in the middle, with the remaining positions distributed equally along the scroll bar.</span></span> <span data-ttu-id="e3bf3-171">初始範圍取決於捲軸。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-171">The initial range depends on the scroll bar.</span></span> <span data-ttu-id="e3bf3-172">標準捲軸的初始範圍是0到 100;捲軸控制項有空白範圍 (最小值和最大值都是零) ，除非您在建立控制項時提供明確的範圍。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-172">Standard scroll bars have an initial range of 0 through 100; scroll bar controls have an empty range (both minimum and maximum values are zero), unless you supply an explicit range when the control is created.</span></span> <span data-ttu-id="e3bf3-173">您可以隨時變更範圍。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-173">You can change the range at any time.</span></span> <span data-ttu-id="e3bf3-174">您可以使用 [**SetScrollInfo**](/windows/desktop/api/Winuser/nf-winuser-setscrollinfo) 函數來設定範圍值，並使用 [**GetScrollInfo**](/windows/desktop/api/Winuser/nf-winuser-getscrollinfo) 函式來取出目前的範圍值。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-174">You can use the [**SetScrollInfo**](/windows/desktop/api/Winuser/nf-winuser-setscrollinfo) function to set the range values, and the [**GetScrollInfo**](/windows/desktop/api/Winuser/nf-winuser-getscrollinfo) function to retrieve the current range values.</span></span>

<span data-ttu-id="e3bf3-175">應用程式通常會將捲軸範圍調整為方便的整數，讓您輕鬆地將捲動方塊位置轉譯成對應到要滾動之資料物件的值。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-175">An application typically adjusts the scroll range to convenient integers, making it easy to translate the scroll box position into a value corresponding to the data object to be scrolled.</span></span> <span data-ttu-id="e3bf3-176">例如，如果應用程式必須在一次只能顯示16行的視窗中顯示260行的文字檔，垂直捲動條範圍可以設定為1到244。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-176">For example, if an application must display 260 lines of a text file in a window that can show only 16 lines at a time, the vertical scroll bar range can be set to 1 through 244.</span></span> <span data-ttu-id="e3bf3-177">如果捲動方塊位於位置1，則第一行會位於視窗頂端。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-177">If the scroll box is at position 1, the first line will be at the top of the window.</span></span> <span data-ttu-id="e3bf3-178">如果捲動方塊位於位置244，最後一行 (行 260) 將會位於視窗底部。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-178">If the scroll box is at position 244, the last line (line 260) will be at the bottom of the window.</span></span> <span data-ttu-id="e3bf3-179">如果應用程式嘗試指定的位置值小於最小值或超過最大值，則會改用最小或最大滾動範圍值。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-179">If an application attempts to specify a position value that is less than the minimum or more than the maximum, the minimum or maximum scrolling range value is used instead.</span></span>

<span data-ttu-id="e3bf3-180">您可以設定捲軸的頁面大小。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-180">You can set a page size for a scroll bar.</span></span> <span data-ttu-id="e3bf3-181">*頁面大小* 代表在擁有者視窗的工作區中，可符合其目前大小的資料單位數目。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-181">The *page size* represents the number of data units that can fit in the client area of the owner window given its current size.</span></span> <span data-ttu-id="e3bf3-182">例如，如果工作區可以容納16行文字，則應用程式會將頁面大小設定為16。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-182">For example, if the client area can hold 16 lines of text, an application would set the page size to 16.</span></span> <span data-ttu-id="e3bf3-183">系統會使用頁面大小，以及捲軸軸的滾動範圍和長度，來設定捲動方塊的大小。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-183">The system uses the page size, along with the scrolling range and length of the scroll bar shaft, to set the size of the scroll box.</span></span> <span data-ttu-id="e3bf3-184">每當有調整包含捲軸的視窗時，應用程式應該呼叫 [**SetScrollInfo**](/windows/desktop/api/Winuser/nf-winuser-setscrollinfo) 函式來設定頁面大小。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-184">Whenever a window containing a scroll bar is resized, an application should call the [**SetScrollInfo**](/windows/desktop/api/Winuser/nf-winuser-setscrollinfo) function to set the page size.</span></span> <span data-ttu-id="e3bf3-185">應用程式可以藉由呼叫傳送 [**GetScrollInfo**](/windows/desktop/api/Winuser/nf-winuser-getscrollinfo) 函式來取得目前的頁面大小。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-185">An application can retrieve the current page size by calling the sending [**GetScrollInfo**](/windows/desktop/api/Winuser/nf-winuser-getscrollinfo) function.</span></span>

<span data-ttu-id="e3bf3-186">若要在捲軸範圍和資料物件之間建立有用的關聯性，應用程式必須在資料物件的大小變更時調整範圍。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-186">To establish a useful relationship between the scroll bar range and the data object, an application must adjust the range whenever the size of the data object changes.</span></span>

<span data-ttu-id="e3bf3-187">當使用者在捲軸中移動捲動方塊時，捲軸會將捲動方塊位置報告為捲軸範圍中的整數。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-187">As the user moves the scroll box in a scroll bar, the scroll bar reports the scroll box position as an integer in the scrolling range.</span></span> <span data-ttu-id="e3bf3-188">如果位置是最小值，則捲動方塊位於垂直捲動條的頂端，或是水準捲軸的左邊端。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-188">If the position is the minimum value, the scroll box is at the top of a vertical scroll bar or at the left end of a horizontal scroll bar.</span></span> <span data-ttu-id="e3bf3-189">如果位置是最大值，則捲動方塊位於垂直捲動條的底部或水準捲軸的右端。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-189">If the position is the maximum value, the scroll box is at the bottom of a vertical scroll bar or at right end of a horizontal scroll bar.</span></span>

<span data-ttu-id="e3bf3-190">捲軸可以報告的最大值 (也就是，最大滾動位置) 取決於頁面大小。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-190">The maximum value that a scroll bar can report (that is, the maximum scrolling position) depends on the page size.</span></span> <span data-ttu-id="e3bf3-191">如果捲軸的頁面大小大於一，則最大捲軸位置小於最大範圍值。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-191">If the scroll bar has a page size greater than one, the maximum scrolling position is less than the maximum range value.</span></span> <span data-ttu-id="e3bf3-192">您可以使用下列公式來計算最大滾動位置：</span><span class="sxs-lookup"><span data-stu-id="e3bf3-192">You can use the following formula to calculate the maximum scrolling position:</span></span>


```
MaxScrollPos = MaxRangeValue - (PageSize - 1) 
```



<span data-ttu-id="e3bf3-193">應用程式必須在捲軸中移動捲動方塊。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-193">An application must move the scroll box in a scroll bar.</span></span> <span data-ttu-id="e3bf3-194">雖然使用者會要求在捲軸中滾動捲軸，但捲軸不會自動更新捲動方塊位置。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-194">Although the user makes a request for scrolling in a scroll bar, the scroll bar does not automatically update the scroll box position.</span></span> <span data-ttu-id="e3bf3-195">相反地，它會將要求傳遞至父視窗，該視窗必須滾動資料並更新捲動方塊的位置。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-195">Instead, it passes the request to the parent window, which must scroll the data and update the scroll box position.</span></span> <span data-ttu-id="e3bf3-196">應用程式會使用 [**SetScrollInfo**](/windows/desktop/api/Winuser/nf-winuser-setscrollinfo) 函數來更新捲動方塊位置;否則，它會使用 [**SetScrollPos**](/windows/desktop/api/Winuser/nf-winuser-setscrollpos) 函數。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-196">An application uses the [**SetScrollInfo**](/windows/desktop/api/Winuser/nf-winuser-setscrollinfo) function to update the scroll box position; otherwise, it uses the [**SetScrollPos**](/windows/desktop/api/Winuser/nf-winuser-setscrollpos) function.</span></span> <span data-ttu-id="e3bf3-197">因為它會控制捲動方塊的移動，所以應用程式可以使用最適合滾動資料的增量來移動捲動方塊。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-197">Because it controls the scroll box movement, the application can move the scroll box in increments that work best for the data being scrolled.</span></span>

## <a name="scroll-bar-visibility"></a><span data-ttu-id="e3bf3-198">捲軸可見度</span><span class="sxs-lookup"><span data-stu-id="e3bf3-198">Scroll Bar Visibility</span></span>

<span data-ttu-id="e3bf3-199">當指定了相等的最小值和最大值時，系統會隱藏和停用標準捲軸。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-199">The system hides and disables a standard scroll bar when equal minimum and maximum values are specified.</span></span> <span data-ttu-id="e3bf3-200">如果您指定的頁面大小包含捲軸的整個捲軸範圍，則系統也會隱藏和停用標準捲軸。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-200">The system also hides and disables a standard scroll bar if you specify a page size that includes the entire scroll range of the scroll bar.</span></span> <span data-ttu-id="e3bf3-201">這是在工作區內容不需要捲軸時，暫時隱藏捲軸的方式。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-201">This is the way to temporarily hide a scroll bar when it is not needed for the content of the client area.</span></span> <span data-ttu-id="e3bf3-202">在隱藏時，不需要在捲軸上進行滾動要求。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-202">There is no need to make scrolling requests through the scroll bar when it is hidden.</span></span> <span data-ttu-id="e3bf3-203">當您將最小值和最大值設定為不相等的值，或未包含整個捲軸範圍的頁面大小時，系統會啟用捲軸並再次顯示。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-203">The system enables the scroll bar and shows it again when you set the minimum and maximum values to unequal values or when the page size that does not include the entire scroll range.</span></span> <span data-ttu-id="e3bf3-204">[**ShowScrollBar**](/windows/desktop/api/Winuser/nf-winuser-showscrollbar)函數也可以用來隱藏或顯示捲軸。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-204">The [**ShowScrollBar**](/windows/desktop/api/Winuser/nf-winuser-showscrollbar) function can also be used to hide or show a scroll bar.</span></span> <span data-ttu-id="e3bf3-205">它不會影響捲軸的範圍、頁面大小或捲動方塊位置。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-205">It does not affect the scroll bar's range, page size, or scroll box position.</span></span>

<span data-ttu-id="e3bf3-206">[**EnableScrollBar**](/windows/desktop/api/Winuser/nf-winuser-enablescrollbar)函式可用來停用捲軸的一或兩個箭號。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-206">The [**EnableScrollBar**](/windows/desktop/api/Winuser/nf-winuser-enablescrollbar) function can be used to disable one or both arrows of a scroll bar.</span></span> <span data-ttu-id="e3bf3-207">應用程式會以灰色顯示已停用的箭號，而不會回應使用者輸入。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-207">An application displays disabled arrows in gray and does not respond to user input.</span></span>

## <a name="scroll-bar-requests"></a><span data-ttu-id="e3bf3-208">捲軸要求</span><span class="sxs-lookup"><span data-stu-id="e3bf3-208">Scroll Bar Requests</span></span>

<span data-ttu-id="e3bf3-209">使用者可以按一下捲軸的各個部分來進行滾動要求。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-209">The user makes scrolling requests by clicking various parts of a scroll bar.</span></span> <span data-ttu-id="e3bf3-210">系統會以 [**wm \_ HSCROLL**](wm-hscroll.md) 或 [**wm \_ VSCROLL**](wm-vscroll.md) 訊息的形式，將要求傳送至指定的視窗。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-210">The system sends the request to the specified window in the form of a [**WM\_HSCROLL**](wm-hscroll.md) or [**WM\_VSCROLL**](wm-vscroll.md) message.</span></span> <span data-ttu-id="e3bf3-211">水準捲軸傳送 **wm \_ HSCROLL** 訊息; 垂直捲動條傳送 **wm \_ VSCROLL** 訊息。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-211">A horizontal scroll bar sends the **WM\_HSCROLL** message; a vertical scroll bar sends the **WM\_VSCROLL** message.</span></span> <span data-ttu-id="e3bf3-212">每個訊息都包含一個要求碼，該程式碼會對應至使用者的動作、捲軸的控制碼 (捲軸控制項) ，而在某些情況下則是捲動方塊的位置。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-212">Each message includes a request code that corresponds to the user's action, to the handle to the scroll bar (scroll bar controls only), and, in some cases, to the position of the scroll box.</span></span>

<span data-ttu-id="e3bf3-213">下圖顯示當您按一下捲軸的不同部分時，使用者所產生的要求碼。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-213">The following diagram shows the request code that the user generates when clicking various parts of a scroll bar.</span></span>

![顯示兩個捲軸上每個區域相關聯之要求碼的圖表](images/csscr-02.png)

<span data-ttu-id="e3bf3-215">SB \_ 值會指定使用者所採取的動作。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-215">The SB\_ values specify the action the user takes.</span></span> <span data-ttu-id="e3bf3-216">應用程式會檢查與 [**wm \_ HSCROLL**](wm-hscroll.md) 和 [**wm \_ VSCROLL**](wm-vscroll.md) 訊息伴隨的程式碼，然後執行適當的滾動作業。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-216">An application examines the codes that accompany the [**WM\_HSCROLL**](wm-hscroll.md) and [**WM\_VSCROLL**](wm-vscroll.md) messages and then performs the appropriate scrolling operation.</span></span> <span data-ttu-id="e3bf3-217">在下表中，會為每個值指定使用者的動作，後面接著應用程式的回應。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-217">In the following table, the user's action is specified for each value, followed by the application's response.</span></span> <span data-ttu-id="e3bf3-218">在每個案例中，應用程式會視需要為資料定義一個單位。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-218">In each case, a unit is defined by the application as appropriate for the data.</span></span> <span data-ttu-id="e3bf3-219">例如，垂直捲動文字的一般單位是一行文字。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-219">For example, the typical unit for scrolling text vertically is a line of text.</span></span>



| <span data-ttu-id="e3bf3-220">要求</span><span class="sxs-lookup"><span data-stu-id="e3bf3-220">Request</span></span>           | <span data-ttu-id="e3bf3-221">動作</span><span class="sxs-lookup"><span data-stu-id="e3bf3-221">Action</span></span>                                                                               | <span data-ttu-id="e3bf3-222">回應</span><span class="sxs-lookup"><span data-stu-id="e3bf3-222">Response</span></span>                                                                                                                                                                                                                                                                                                                         |
|-------------------|--------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="e3bf3-223">SB \_ 系列</span><span class="sxs-lookup"><span data-stu-id="e3bf3-223">SB\_LINEUP</span></span>        | <span data-ttu-id="e3bf3-224">使用者按一下頂端滾動箭號。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-224">The user clicks the top scroll arrow.</span></span>                                                | <span data-ttu-id="e3bf3-225">遞減捲動方塊位置;以一個單位向資料頂端滾動。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-225">Decrements the scroll box position; scrolls toward the top of the data by one unit.</span></span>                                                                                                                                                                                                                                              |
| <span data-ttu-id="e3bf3-226">SB \_ LINEDOWN</span><span class="sxs-lookup"><span data-stu-id="e3bf3-226">SB\_LINEDOWN</span></span>      | <span data-ttu-id="e3bf3-227">使用者按一下底部的滾動箭號。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-227">The user clicks the bottom scroll arrow.</span></span>                                             | <span data-ttu-id="e3bf3-228">遞增捲動方塊位置;將資料向下滾動一個單位。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-228">Increments the scroll box position; scrolls toward the bottom of the data by one unit.</span></span>                                                                                                                                                                                                                                           |
| <span data-ttu-id="e3bf3-229">SB \_ LINELEFT</span><span class="sxs-lookup"><span data-stu-id="e3bf3-229">SB\_LINELEFT</span></span>      | <span data-ttu-id="e3bf3-230">使用者按一下左方滾動箭號。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-230">The user clicks the left scroll arrow.</span></span>                                               | <span data-ttu-id="e3bf3-231">遞減捲動方塊位置;將資料的左邊向左滾動一個單位。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-231">Decrements the scroll box position; scrolls toward the left end of the data by one unit.</span></span>                                                                                                                                                                                                                                         |
| <span data-ttu-id="e3bf3-232">SB \_ LINERIGHT</span><span class="sxs-lookup"><span data-stu-id="e3bf3-232">SB\_LINERIGHT</span></span>     | <span data-ttu-id="e3bf3-233">使用者按一下向右滾動箭號。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-233">The user clicks the right scroll arrow.</span></span>                                              | <span data-ttu-id="e3bf3-234">遞增捲動方塊位置;將資料向右滾動一個單位。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-234">Increments the scroll box position; scrolls toward the right end of the data by one unit.</span></span>                                                                                                                                                                                                                                        |
| <span data-ttu-id="e3bf3-235">SB \_ PAGEUP</span><span class="sxs-lookup"><span data-stu-id="e3bf3-235">SB\_PAGEUP</span></span>        | <span data-ttu-id="e3bf3-236">使用者按一下捲動方塊上方的捲軸軸。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-236">The user clicks the scroll bar shaft above the scroll box.</span></span>                           | <span data-ttu-id="e3bf3-237">將捲動方塊位置遞減為視窗中的資料單位數目;依相同數目的單位向資料頂端滾動。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-237">Decrements the scroll box position by the number of data units in the window; scrolls toward the top of the data by the same number of units.</span></span>                                                                                                                                                                                    |
| <span data-ttu-id="e3bf3-238">SB \_ PAGEDOWN</span><span class="sxs-lookup"><span data-stu-id="e3bf3-238">SB\_PAGEDOWN</span></span>      | <span data-ttu-id="e3bf3-239">使用者按一下捲動方塊下方的捲軸軸。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-239">The user clicks the scroll bar shaft below the scroll box.</span></span>                           | <span data-ttu-id="e3bf3-240">以視窗中的資料單位數目遞增捲動方塊位置;以相同數目的單位向下滾動資料。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-240">Increments the scroll box position by the number of data units in the window; scrolls toward the bottom of the data by the same number of units.</span></span>                                                                                                                                                                                 |
| <span data-ttu-id="e3bf3-241">SB \_ PAGELEFT</span><span class="sxs-lookup"><span data-stu-id="e3bf3-241">SB\_PAGELEFT</span></span>      | <span data-ttu-id="e3bf3-242">使用者按一下捲動方塊左邊的捲軸軸。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-242">The user clicks the scroll bar shaft to the left of the scroll box.</span></span>                  | <span data-ttu-id="e3bf3-243">將捲動方塊位置遞減為視窗中的資料單位數目;將相同數目的單位向左滾動資料。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-243">Decrements the scroll box position by the number of data units in the window; scrolls toward the left end of the data by the same number of units.</span></span>                                                                                                                                                                               |
| <span data-ttu-id="e3bf3-244">SB \_ PAGERIGHT</span><span class="sxs-lookup"><span data-stu-id="e3bf3-244">SB\_PAGERIGHT</span></span>     | <span data-ttu-id="e3bf3-245">使用者按一下捲動方塊右側的捲軸軸。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-245">The user clicks the scroll bar shaft to the right of the scroll box.</span></span>                 | <span data-ttu-id="e3bf3-246">以視窗中的資料單位數目遞增捲動方塊位置;將相同數目的單位向右滾動至資料的右端。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-246">Increments the scroll box position by the number of data units in the window; scrolls toward the right end of the data by the same number of units.</span></span>                                                                                                                                                                              |
| <span data-ttu-id="e3bf3-247">SB \_ THUMBPOSITION</span><span class="sxs-lookup"><span data-stu-id="e3bf3-247">SB\_THUMBPOSITION</span></span> | <span data-ttu-id="e3bf3-248">拖曳之後，使用者會放開捲動方塊。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-248">The user releases the scroll box after dragging it.</span></span>                                  | <span data-ttu-id="e3bf3-249">將捲動方塊設定為訊息中指定的位置;將資料以捲動方塊移動的相同單位數滾動。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-249">Sets the scroll box to the position specified in the message; scrolls the data by the same number of units the scroll box has moved.</span></span>                                                                                                                                                                                             |
| <span data-ttu-id="e3bf3-250">SB \_ THUMBTRACK</span><span class="sxs-lookup"><span data-stu-id="e3bf3-250">SB\_THUMBTRACK</span></span>    | <span data-ttu-id="e3bf3-251">使用者拖曳捲動方塊。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-251">The user drags the scroll box.</span></span>                                                       | <span data-ttu-id="e3bf3-252">將捲動方塊設定為訊息中指定的位置，並將資料以捲動方塊移動的相同單位數，以快速繪製資料的應用程式為單位滾動。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-252">Sets the scroll box to the position specified in the message and scrolls the data by the same number of units the scroll box has moved for applications that draw data quickly.</span></span> <span data-ttu-id="e3bf3-253">無法快速繪製資料的應用程式必須先等待 SB \_ THUMBPOSITION 要求碼，再移動捲動方塊並滾動資料。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-253">Applications that cannot draw data quickly must wait for the SB\_THUMBPOSITION request code before moving the scroll box and scrolling the data.</span></span> |
| <span data-ttu-id="e3bf3-254">SB \_ ENDSCROLL</span><span class="sxs-lookup"><span data-stu-id="e3bf3-254">SB\_ENDSCROLL</span></span>     | <span data-ttu-id="e3bf3-255">當使用者將滑鼠放在箭號或捲軸軸上時，就會放開滑鼠。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-255">The user releases the mouse after holding it on an arrow or in the scroll bar shaft.</span></span> | <span data-ttu-id="e3bf3-256">不需要回應。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-256">No response is needed.</span></span>                                                                                                                                                                                                                                                                                                           |



 

<span data-ttu-id="e3bf3-257">\_當使用者按一下並拖曳捲動方塊時，捲軸會產生 sb THUMBPOSITION 和 sb \_ THUMBTRACK 要求碼。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-257">A scroll bar generates SB\_THUMBPOSITION and SB\_THUMBTRACK request code when the user clicks and drags the scroll box.</span></span> <span data-ttu-id="e3bf3-258">應用程式應該以程式設計的方式處理 SB \_ THUMBTRACK 或 sb \_ THUMBPOSITION 的要求碼。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-258">An application should be programmed to process either the SB\_THUMBTRACK or SB\_THUMBPOSITION request code.</span></span>

<span data-ttu-id="e3bf3-259">\_當使用者按一下捲動方塊之後放開滑鼠按鍵時，就會發生 SB THUMBPOSITION 要求程式碼。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-259">The SB\_THUMBPOSITION request code occurs when the user releases the mouse button after clicking the scroll box.</span></span> <span data-ttu-id="e3bf3-260">處理此訊息的應用程式會在使用者將捲動方塊拖曳至想要的位置並放開滑鼠按鍵之後，執行滾動操作。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-260">An application that processes this message performs the scrolling operation after the user has dragged the scroll box to the desired position and released the mouse button.</span></span>

<span data-ttu-id="e3bf3-261">當 \_ 使用者拖曳捲動方塊時，會發生 SB THUMBTRACK 要求程式碼。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-261">The SB\_THUMBTRACK request code occurs as the user drags the scroll box.</span></span> <span data-ttu-id="e3bf3-262">如果應用程式處理 SB \_ THUMBTRACK 要求碼，它可以在使用者拖曳捲動方塊時滾動視窗的內容。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-262">If an application processes SB\_THUMBTRACK request codes, it can scroll the content of a window as the user drags the scroll box.</span></span> <span data-ttu-id="e3bf3-263">不過，捲軸可能會 \_ 在短時間內產生許多 SB THUMBTRACK 要求碼，因此應用程式應該只在可以快速重新繪製視窗的內容時，才處理這些要求代碼。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-263">However, a scroll bar can generate many SB\_THUMBTRACK request code in a short period, so an application should process these request codes only if it can quickly repaint the content of the window.</span></span>

## <a name="keyboard-interface-for-a-scroll-bar"></a><span data-ttu-id="e3bf3-264">捲軸的鍵盤介面</span><span class="sxs-lookup"><span data-stu-id="e3bf3-264">Keyboard Interface for a Scroll Bar</span></span>

<span data-ttu-id="e3bf3-265">捲軸控制項提供內建的鍵盤介面，可讓使用者使用鍵盤來發出滾動要求;標準捲軸不是。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-265">A scroll bar control provides a built-in keyboard interface that enables the user to issue scrolling requests by using the keyboard; a standard scroll bar does not.</span></span> <span data-ttu-id="e3bf3-266">當捲軸控制項具有鍵盤焦點時，會在使用者按下方向鍵時，將 [**wm \_ HSCROLL**](wm-hscroll.md) 和 [**WM \_ VSCROLL**](wm-vscroll.md) 訊息傳送至其父視窗。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-266">When a scroll bar control has the keyboard focus, it sends [**WM\_HSCROLL**](wm-hscroll.md) and [**WM\_VSCROLL**](wm-vscroll.md) messages to its parent window when the user presses the arrow keys.</span></span> <span data-ttu-id="e3bf3-267">要求碼會隨每個對應至使用者按下箭號鍵的訊息一起傳送。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-267">The request code is sent with each message corresponding to the arrow key the user has pressed.</span></span> <span data-ttu-id="e3bf3-268">以下是方向鍵及其對應的要求碼。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-268">Following are the arrow keys and their corresponding request codes.</span></span>



| <span data-ttu-id="e3bf3-269">箭號鍵</span><span class="sxs-lookup"><span data-stu-id="e3bf3-269">Arrow key</span></span> | <span data-ttu-id="e3bf3-270">要求碼</span><span class="sxs-lookup"><span data-stu-id="e3bf3-270">Request code</span></span>                  |
|-----------|-------------------------------|
| <span data-ttu-id="e3bf3-271">DOWN</span><span class="sxs-lookup"><span data-stu-id="e3bf3-271">DOWN</span></span>      | <span data-ttu-id="e3bf3-272">SB \_ LINEDOWN 或 sb \_ LINERIGHT</span><span class="sxs-lookup"><span data-stu-id="e3bf3-272">SB\_LINEDOWN or SB\_LINERIGHT</span></span> |
| <span data-ttu-id="e3bf3-273">END</span><span class="sxs-lookup"><span data-stu-id="e3bf3-273">END</span></span>       | <span data-ttu-id="e3bf3-274">SB \_ 底部</span><span class="sxs-lookup"><span data-stu-id="e3bf3-274">SB\_BOTTOM</span></span>                    |
| <span data-ttu-id="e3bf3-275">HOME</span><span class="sxs-lookup"><span data-stu-id="e3bf3-275">HOME</span></span>      | <span data-ttu-id="e3bf3-276">SB \_ TOP</span><span class="sxs-lookup"><span data-stu-id="e3bf3-276">SB\_TOP</span></span>                       |
| <span data-ttu-id="e3bf3-277">LEFT</span><span class="sxs-lookup"><span data-stu-id="e3bf3-277">LEFT</span></span>      | <span data-ttu-id="e3bf3-278">SB \_ 陣容或 sb \_ LINELEFT</span><span class="sxs-lookup"><span data-stu-id="e3bf3-278">SB\_LINEUP or SB\_LINELEFT</span></span>    |
| <span data-ttu-id="e3bf3-279">>PGDN</span><span class="sxs-lookup"><span data-stu-id="e3bf3-279">PGDN</span></span>      | <span data-ttu-id="e3bf3-280">SB \_ PAGEDOWN 或 sb \_ PAGERIGHT</span><span class="sxs-lookup"><span data-stu-id="e3bf3-280">SB\_PAGEDOWN or SB\_PAGERIGHT</span></span> |
| <span data-ttu-id="e3bf3-281">PGUP</span><span class="sxs-lookup"><span data-stu-id="e3bf3-281">PGUP</span></span>      | <span data-ttu-id="e3bf3-282">SB \_ PAGEUP 或 sb \_ PAGELEFT</span><span class="sxs-lookup"><span data-stu-id="e3bf3-282">SB\_PAGEUP or SB\_PAGELEFT</span></span>    |
| <span data-ttu-id="e3bf3-283">RIGHT</span><span class="sxs-lookup"><span data-stu-id="e3bf3-283">RIGHT</span></span>     | <span data-ttu-id="e3bf3-284">SB \_ LINEDOWN 或 sb \_ LINERIGHT</span><span class="sxs-lookup"><span data-stu-id="e3bf3-284">SB\_LINEDOWN or SB\_LINERIGHT</span></span> |
| <span data-ttu-id="e3bf3-285">UP</span><span class="sxs-lookup"><span data-stu-id="e3bf3-285">UP</span></span>        | <span data-ttu-id="e3bf3-286">SB \_ 陣容或 sb \_ LINELEFT</span><span class="sxs-lookup"><span data-stu-id="e3bf3-286">SB\_LINEUP or SB\_LINELEFT</span></span>    |



 

 

> [!Note]  
> <span data-ttu-id="e3bf3-287">捲軸控制項的鍵盤介面會傳送 SB \_ TOP 和 sb 底部的 \_ 要求碼。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-287">The keyboard interface of a scroll bar control sends the SB\_TOP and SB\_BOTTOM request codes.</span></span> <span data-ttu-id="e3bf3-288">SB \_ top 要求碼表示使用者已到達滾動範圍的最上方值。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-288">The SB\_TOP request code indicates that the user has reached the top value of the scrolling range.</span></span> <span data-ttu-id="e3bf3-289">應用程式會向下滾動視窗內容，以便顯示資料物件的頂端。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-289">An application scrolls the window content downward so that the top of the data object is visible.</span></span> <span data-ttu-id="e3bf3-290">SB \_ 底部要求碼表示使用者已到達滾動範圍的底部值。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-290">The SB\_BOTTOM request code indicates that the user has reached the bottom value of the scrolling range.</span></span> <span data-ttu-id="e3bf3-291">如果應用程式處理 SB 最 \_ 下方的要求碼，它會向上滾動視窗內容，以便顯示資料物件的底部。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-291">If an application processes the SB\_BOTTOM request code, it scrolls the window content upward so that the bottom of the data object is visible.</span></span>

 

<span data-ttu-id="e3bf3-292">如果您想要標準捲軸的鍵盤介面，您可以在視窗程式中處理 [**WM \_ KEYDOWN**](/windows/desktop/inputdev/wm-keydown) 訊息，然後根據伴隨于訊息的虛擬機器碼來執行適當的滾動動作，藉此建立一個。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-292">If you want a keyboard interface for a standard scroll bar, you can create one yourself by processing the [**WM\_KEYDOWN**](/windows/desktop/inputdev/wm-keydown) message in your window procedure and then performing the appropriate scrolling action based on the virtual-key code that accompanies the message.</span></span> <span data-ttu-id="e3bf3-293">如需如何為捲軸建立鍵盤介面的詳細資訊，請參閱 [建立標準捲軸的鍵盤介面](using-scroll-bars.md)。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-293">For information about how to create a keyboard interface for a scroll bar, see [Creating a Keyboard Interface for a Standard Scroll Bar](using-scroll-bars.md).</span></span>

## <a name="scrolling-the-client-area"></a><span data-ttu-id="e3bf3-294">滾動工作區</span><span class="sxs-lookup"><span data-stu-id="e3bf3-294">Scrolling the Client Area</span></span>

<span data-ttu-id="e3bf3-295">要將工作區的內容最簡單的方式是清除，然後再重新繪製。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-295">The simplest way to scroll the content of a client area is to erase and then redraw it.</span></span> <span data-ttu-id="e3bf3-296">這是應用程式可能會與 SB \_ PAGEUP、sb \_ PAGEDOWN 和 sb TOP 要求碼搭配使用的方法， \_ 通常需要全新的內容。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-296">This is the method an application is likely to use with SB\_PAGEUP, SB\_PAGEDOWN, and SB\_TOP request codes, which typically require completely new content.</span></span>

<span data-ttu-id="e3bf3-297">針對某些要求碼（例如 SB 組合 \_ 和 sb \_ LINEDOWN），不需要清除所有的內容，因為在進行滾動之後，某些內容仍會顯示。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-297">For some request codes, such as SB\_LINEUP and SB\_LINEDOWN, not all the content need be erased, because some remains visible after scrolling occurs.</span></span> <span data-ttu-id="e3bf3-298">[**ScrollWindowEx**](/windows/desktop/api/Winuser/nf-winuser-scrollwindowex)函式會保留一部分的工作區內容、將保留的部分移至指定的數量，然後準備工作區的其餘部分以繪製新的資訊。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-298">The [**ScrollWindowEx**](/windows/desktop/api/Winuser/nf-winuser-scrollwindowex) function preserves a portion of the client area's content, moves the preserved portion a specified amount, and then prepares the rest of the client area for painting new information.</span></span> <span data-ttu-id="e3bf3-299">**ScrollWindowEx** 會使用 [**BitBlt**](/windows/desktop/api/wingdi/nf-wingdi-bitblt) 函數，將資料物件的特定部分移至工作區中的新位置。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-299">**ScrollWindowEx** uses the [**BitBlt**](/windows/desktop/api/wingdi/nf-wingdi-bitblt) function to move a specific part of the data object to a new location within the client area.</span></span> <span data-ttu-id="e3bf3-300">在下一個 [**WM \_ 油漆**](/windows/desktop/gdi/wm-paint) 訊息發生時，工作區中任何未保留的部分 (未保留的任何部分) 會失效、清除及繪製。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-300">Any uncovered part of the client area (anything not preserved) is invalidated, erased, and painted when the next [**WM\_PAINT**](/windows/desktop/gdi/wm-paint) message occurs.</span></span>

<span data-ttu-id="e3bf3-301">[**ScrollWindowEx**](/windows/desktop/api/Winuser/nf-winuser-scrollwindowex)函式可以用來從滾動作業中排除部分的工作區。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-301">The [**ScrollWindowEx**](/windows/desktop/api/Winuser/nf-winuser-scrollwindowex) function can be used to exclude a portion of the client area from the scrolling operation.</span></span> <span data-ttu-id="e3bf3-302">這會讓具有固定位置的專案（例如子視窗）在工作區內移動。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-302">This keeps items with fixed positions, such as child windows, from moving within the client area.</span></span> <span data-ttu-id="e3bf3-303">它會自動使接收新資訊的工作區部分失效，因此應用程式不需要計算自己的裁剪區域。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-303">It automatically invalidates the portion of the client area that is to receive the new information, so the application does not have to compute its own clipping regions.</span></span> <span data-ttu-id="e3bf3-304">如需裁剪的詳細資訊，請參閱 [裁剪](/windows/desktop/gdi/clipping)。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-304">For more information on clipping, see [Clipping](/windows/desktop/gdi/clipping).</span></span>

<span data-ttu-id="e3bf3-305">應用程式通常會以捲軸所指示的方向來滾動視窗的內容。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-305">Usually an application scrolls the content of a window in the direction opposite that indicated by the scroll bar.</span></span> <span data-ttu-id="e3bf3-306">例如，當使用者在捲動方塊下方的區域中按一下捲軸軸時，應用程式會向上將視窗中的物件向下滾動，以顯示位於可見部分之下的物件部分。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-306">For example, when the user clicks the scroll bar shaft in the area below the scroll box, an application scrolls the object in the window upward to reveal a portion of the object that is below the visible portion.</span></span>

<span data-ttu-id="e3bf3-307">您也可以使用 [**ScrollDC**](/windows/desktop/api/Winuser/nf-winuser-scrolldc) 函式來滾動矩形區域。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-307">You can also scroll a rectangular region using the [**ScrollDC**](/windows/desktop/api/Winuser/nf-winuser-scrolldc) function.</span></span>

## <a name="scroll-bar-colors-and-metrics"></a><span data-ttu-id="e3bf3-308">捲軸色彩和度量</span><span class="sxs-lookup"><span data-stu-id="e3bf3-308">Scroll Bar Colors and Metrics</span></span>

<span data-ttu-id="e3bf3-309">系統定義的色彩值、色彩 \_ 捲軸，會控制捲軸軸內的色彩。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-309">The system-defined color value, COLOR\_SCROLLBAR, controls the color within a scroll bar shaft.</span></span> <span data-ttu-id="e3bf3-310">您可以使用 [**GetSysColor**](/windows/desktop/api/winuser/nf-winuser-getsyscolor) 函式來決定捲軸軸的色彩，並使用 [**SetSysColors**](/windows/desktop/api/winuser/nf-winuser-setsyscolors) 函式來設定捲軸軸的色彩。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-310">Use the [**GetSysColor**](/windows/desktop/api/winuser/nf-winuser-getsyscolor) function to determine the color of the scroll bar shaft and the [**SetSysColors**](/windows/desktop/api/winuser/nf-winuser-setsyscolors) function to set the color of the scroll bar shaft.</span></span> <span data-ttu-id="e3bf3-311">不過請注意，這種色彩變更會影響系統中的所有捲軸。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-311">Note, however, that this change of color affects all scroll bars in the system.</span></span>

<span data-ttu-id="e3bf3-312">您可以藉由呼叫 [**GetSystemMetrics**](/windows/desktop/api/winuser/nf-winuser-getsystemmetrics) 函式，取得系統在標準捲軸中使用的點陣圖維度。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-312">You can get the dimensions of the bitmaps that the system uses in standard scroll bars by calling the [**GetSystemMetrics**](/windows/desktop/api/winuser/nf-winuser-getsystemmetrics) function.</span></span> <span data-ttu-id="e3bf3-313">以下是與捲軸相關聯的系統度量值。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-313">Following are the system metric values associated with scroll bars.</span></span>



| <span data-ttu-id="e3bf3-314">系統度量</span><span class="sxs-lookup"><span data-stu-id="e3bf3-314">System metric</span></span> | <span data-ttu-id="e3bf3-315">Description</span><span class="sxs-lookup"><span data-stu-id="e3bf3-315">Description</span></span>                                                                                                                |
|---------------|----------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="e3bf3-316">SM \_ CXHSCROLL</span><span class="sxs-lookup"><span data-stu-id="e3bf3-316">SM\_CXHSCROLL</span></span> | <span data-ttu-id="e3bf3-317">水準捲軸上箭號點陣圖的寬度</span><span class="sxs-lookup"><span data-stu-id="e3bf3-317">Width of arrow bitmap on horizontal scroll bar</span></span>                                                                             |
| <span data-ttu-id="e3bf3-318">SM \_ CXHTHUMB</span><span class="sxs-lookup"><span data-stu-id="e3bf3-318">SM\_CXHTHUMB</span></span>  | <span data-ttu-id="e3bf3-319">水準捲軸的捲動方塊寬度。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-319">Width of scroll box on horizontal scroll bar.</span></span> <span data-ttu-id="e3bf3-320">此值會抓取頁面大小為零的捲軸寬度。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-320">This value retrieves the width a scroll bar that has a page size of zero.</span></span>    |
| <span data-ttu-id="e3bf3-321">SM \_ CXVSCROLL</span><span class="sxs-lookup"><span data-stu-id="e3bf3-321">SM\_CXVSCROLL</span></span> | <span data-ttu-id="e3bf3-322">垂直捲動條上箭號點陣圖的寬度</span><span class="sxs-lookup"><span data-stu-id="e3bf3-322">Width of arrow bitmap on vertical scroll bar</span></span>                                                                               |
| <span data-ttu-id="e3bf3-323">SM \_ CYHSCROLL</span><span class="sxs-lookup"><span data-stu-id="e3bf3-323">SM\_CYHSCROLL</span></span> | <span data-ttu-id="e3bf3-324">水準捲軸上箭號點陣圖的高度</span><span class="sxs-lookup"><span data-stu-id="e3bf3-324">Height of arrow bitmap on horizontal scroll bar</span></span>                                                                            |
| <span data-ttu-id="e3bf3-325">SM \_ CYVSCROLL</span><span class="sxs-lookup"><span data-stu-id="e3bf3-325">SM\_CYVSCROLL</span></span> | <span data-ttu-id="e3bf3-326">垂直捲動條上箭號點陣圖的高度</span><span class="sxs-lookup"><span data-stu-id="e3bf3-326">Height of arrow bitmap on vertical scroll bar</span></span>                                                                              |
| <span data-ttu-id="e3bf3-327">SM \_ CYVTHUMB</span><span class="sxs-lookup"><span data-stu-id="e3bf3-327">SM\_CYVTHUMB</span></span>  | <span data-ttu-id="e3bf3-328">垂直捲動條的捲動方塊高度。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-328">Height of scroll box on vertical scroll bar.</span></span> <span data-ttu-id="e3bf3-329">此值會抓取頁面大小為零的捲軸高度。</span><span class="sxs-lookup"><span data-stu-id="e3bf3-329">This value retrieves the height of a scroll bar that has a page size of zero.</span></span> |



 

 

 