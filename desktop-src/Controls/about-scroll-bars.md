---
title: 關於捲軸
description: 視窗可以顯示大於視窗工作區的資料物件，例如，檔或點陣圖。
ms.assetid: 9cb3afad-79ef-4817-950a-c8c1de39401b
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 9d410e98ea1fe722d6dc1c4869010df30f99bddb
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/21/2020
ms.locfileid: "104024120"
---
# <a name="about-scroll-bars"></a>關於捲軸

視窗可以顯示大於視窗工作區的資料物件，例如，檔或點陣圖。 當使用捲軸來提供時，使用者可以在工作區中滾動資料物件，以查看超出視窗框線的物件部分。

捲軸應該包含在用戶端區域內容超出視窗框線的任何視窗中。 捲軸的方向決定當使用者操作捲軸時，滾動發生的方向。 水準捲軸可讓使用者將視窗的內容向左或向右滾動。 垂直捲動條可讓使用者將內容向上或向下滾動。

本節將討論下列主題。

-   [捲軸的部分](#parts-of-a-scroll-bar)
-   [標準捲軸和捲軸控制項](#standard-scroll-bars-and-scroll-bar-controls)
-   [捲動方塊位置和滾動範圍](#scroll-box-position-and-scrolling-range)
-   [捲軸可見度](#scroll-bar-visibility)
-   [捲軸要求](#scroll-bar-requests)
-   [捲軸的鍵盤介面](#keyboard-interface-for-a-scroll-bar)
-   [滾動工作區](#scrolling-the-client-area)
-   [捲軸色彩和度量](#scroll-bar-colors-and-metrics)

## <a name="parts-of-a-scroll-bar"></a>捲軸的部分

捲軸包含一個陰影軸，其中每一端有一個箭號按鈕，而 *捲動方塊* (有時也稱為箭號按鈕之間的捲動方塊) 。 捲軸代表視窗工作區中資料物件的整體長度或寬度;捲動方塊代表在工作區中可見的物件部分。 每當使用者滾動資料物件以顯示其不同部分時，捲動方塊的位置就會變更。 系統也會調整捲軸捲動方塊的大小，使其指出整個資料物件的哪個部分目前顯示在視窗中。 如果大部分的物件都是可見的，則捲動方塊會佔用大部分的捲軸軸。 同樣地，如果只顯示物件的一小部分，則捲動方塊會佔用捲軸軸的一小部分。

使用者可以按一下其中一個箭號按鈕、按一下陰影捲軸軸中的區域，或拖曳捲動方塊，來滾動視窗的內容。 當使用者按一下箭號按鈕時，應用程式會以一個單位將內容滾動 (通常是一行或欄) 。 當使用者按一下陰影區域時，應用程式會將內容滾動一個視窗。 當使用者拖曳捲動方塊時所發生的滾動量，取決於使用者拖曳捲動方塊的距離，以及捲軸的滾動範圍。 如需滾動範圍的詳細資訊，請參閱 [捲動方塊位置和滾動範圍](#scroll-box-position-and-scrolling-range)。

下列螢幕擷取畫面顯示具有垂直和水準捲軸的 rich edit 控制項，因為它們可能出現在 Windows Vista 中。 垂直捲動條目前為「熱」，因為在拍攝螢幕擷取畫面時，滑鼠指標停留在其上方。

![具有捲軸之 rich edit 控制項的螢幕擷取畫面](images/sbvista.png)

## <a name="standard-scroll-bars-and-scroll-bar-controls"></a>標準捲軸和捲軸控制項

捲軸會以標準捲軸或捲軸控制項的形式包含在視窗中。 標準捲軸位於視窗的非工作區。 它是以視窗建立，並在視窗顯示時顯示。 標準捲軸的唯一目的是讓使用者產生滾動要求來查看工作區的整個內容。 您可以在建立視窗時指定 [**ws \_ HSCROLL**](/windows/desktop/winmsg/window-styles)、 [**WS \_ VSCROLL**](/windows/desktop/winmsg/window-styles)或這兩種樣式，以在視窗中包含標準捲軸。 **WS \_ HSCROLL** 樣式會建立位於工作區底部的水準捲軸。 **WS \_ VSCROLL** 樣式會建立位於工作區右邊的垂直捲動條。 SM \_ CXHSCROLL 和 sm \_ CYHSCROLL 系統度量值會定義標準水準捲軸的寬度和高度。 SM \_ CXVSCROLL 和 sm \_ CYVSCROLL 值會定義標準垂直捲動條的寬度和高度。 標準捲軸是其相關視窗的一部分，因此沒有自己的視窗控制碼。

捲軸控制項是屬於捲軸視窗類別的控制項視窗。 捲軸控制項隨即出現，並如同標準捲軸，但它是另一個視窗。 捲軸控制項是個別的視窗，會取得直接輸入焦點。 不同于標準捲軸，捲軸控制項也有內建的鍵盤介面。

您可以在單一視窗中視需要使用任意數目的捲軸控制項。 當您建立捲軸控制項時，您必須指定捲軸的大小和位置。 但是，如果捲軸控制項的視窗可以調整大小，則每當視窗的大小變更時，就必須調整捲軸的大小。

使用標準捲軸的優點是，系統會建立捲軸，並自動設定其大小和位置。 但是，標準捲軸有時太過嚴格。 例如，假設您想要將工作區分割成象限，並使用一組不同的捲軸來控制每個象限的內容。 您無法使用標準捲軸，因為您只能針對特定視窗建立一組捲軸。 請改用捲軸控制項，因為您可以視需要將多個控制項加入至視窗。

應用程式除了滾動視窗內容之外，也可以針對其他用途提供捲軸控制項。 例如，螢幕保護裝置應用程式可能會提供捲軸，讓您在螢幕上設定圖形的移動速度。

捲軸控制項可以有許多樣式，用來控制捲軸的方向和位置。 當您呼叫 [**CreateWindowEx**](/windows/desktop/api/winuser/nf-winuser-createwindowexa) 函式來建立捲軸控制項時，您會指定想要的樣式。 某些樣式會建立使用預設寬度或高度的捲軸控制項。 不過，您一律必須指定捲軸的 x 和 y 座標，以及其他維度。

如需捲軸控制項樣式的表格，請參閱 [捲軸控制項樣式](scroll-bar-control-styles.md)。

> [!Note]  
> 若要使用具有捲軸的視覺化樣式，應用程式必須包含資訊清單，而且必須在程式的開頭呼叫 [**InitCommonControls**](/windows/desktop/api/Commctrl/nf-commctrl-initcommoncontrols) 。 如需視覺化樣式的詳細資訊，請參閱 [視覺化樣式](themes-overview.md)。 如需資訊清單的詳細資訊，請參閱 [啟用視覺化樣式](cookbook-overview.md)。

 

## <a name="scroll-box-position-and-scrolling-range"></a>捲動方塊位置和滾動範圍

捲動方塊的位置以整數表示;這是相對於捲軸的左邊或上方，視捲軸為水準或垂直而定。 位置必須在滾動範圍的最小值和最大值內。 例如，在範圍為0到100的捲軸中，位置50是在中間，其餘的位置則沿著捲軸平均分佈。 初始範圍取決於捲軸。 標準捲軸的初始範圍是0到 100;捲軸控制項有空白範圍 (最小值和最大值都是零) ，除非您在建立控制項時提供明確的範圍。 您可以隨時變更範圍。 您可以使用 [**SetScrollInfo**](/windows/desktop/api/Winuser/nf-winuser-setscrollinfo) 函數來設定範圍值，並使用 [**GetScrollInfo**](/windows/desktop/api/Winuser/nf-winuser-getscrollinfo) 函式來取出目前的範圍值。

應用程式通常會將捲軸範圍調整為方便的整數，讓您輕鬆地將捲動方塊位置轉譯成對應到要滾動之資料物件的值。 例如，如果應用程式必須在一次只能顯示16行的視窗中顯示260行的文字檔，垂直捲動條範圍可以設定為1到244。 如果捲動方塊位於位置1，則第一行會位於視窗頂端。 如果捲動方塊位於位置244，最後一行 (行 260) 將會位於視窗底部。 如果應用程式嘗試指定的位置值小於最小值或超過最大值，則會改用最小或最大滾動範圍值。

您可以設定捲軸的頁面大小。 *頁面大小* 代表在擁有者視窗的工作區中，可符合其目前大小的資料單位數目。 例如，如果工作區可以容納16行文字，則應用程式會將頁面大小設定為16。 系統會使用頁面大小，以及捲軸軸的滾動範圍和長度，來設定捲動方塊的大小。 每當有調整包含捲軸的視窗時，應用程式應該呼叫 [**SetScrollInfo**](/windows/desktop/api/Winuser/nf-winuser-setscrollinfo) 函式來設定頁面大小。 應用程式可以藉由呼叫傳送 [**GetScrollInfo**](/windows/desktop/api/Winuser/nf-winuser-getscrollinfo) 函式來取得目前的頁面大小。

若要在捲軸範圍和資料物件之間建立有用的關聯性，應用程式必須在資料物件的大小變更時調整範圍。

當使用者在捲軸中移動捲動方塊時，捲軸會將捲動方塊位置報告為捲軸範圍中的整數。 如果位置是最小值，則捲動方塊位於垂直捲動條的頂端，或是水準捲軸的左邊端。 如果位置是最大值，則捲動方塊位於垂直捲動條的底部或水準捲軸的右端。

捲軸可以報告的最大值 (也就是，最大滾動位置) 取決於頁面大小。 如果捲軸的頁面大小大於一，則最大捲軸位置小於最大範圍值。 您可以使用下列公式來計算最大滾動位置：


```
MaxScrollPos = MaxRangeValue - (PageSize - 1) 
```



應用程式必須在捲軸中移動捲動方塊。 雖然使用者會要求在捲軸中滾動捲軸，但捲軸不會自動更新捲動方塊位置。 相反地，它會將要求傳遞至父視窗，該視窗必須滾動資料並更新捲動方塊的位置。 應用程式會使用 [**SetScrollInfo**](/windows/desktop/api/Winuser/nf-winuser-setscrollinfo) 函數來更新捲動方塊位置;否則，它會使用 [**SetScrollPos**](/windows/desktop/api/Winuser/nf-winuser-setscrollpos) 函數。 因為它會控制捲動方塊的移動，所以應用程式可以使用最適合滾動資料的增量來移動捲動方塊。

## <a name="scroll-bar-visibility"></a>捲軸可見度

當指定了相等的最小值和最大值時，系統會隱藏和停用標準捲軸。 如果您指定的頁面大小包含捲軸的整個捲軸範圍，則系統也會隱藏和停用標準捲軸。 這是在工作區內容不需要捲軸時，暫時隱藏捲軸的方式。 在隱藏時，不需要在捲軸上進行滾動要求。 當您將最小值和最大值設定為不相等的值，或未包含整個捲軸範圍的頁面大小時，系統會啟用捲軸並再次顯示。 [**ShowScrollBar**](/windows/desktop/api/Winuser/nf-winuser-showscrollbar)函數也可以用來隱藏或顯示捲軸。 它不會影響捲軸的範圍、頁面大小或捲動方塊位置。

[**EnableScrollBar**](/windows/desktop/api/Winuser/nf-winuser-enablescrollbar)函式可用來停用捲軸的一或兩個箭號。 應用程式會以灰色顯示已停用的箭號，而不會回應使用者輸入。

## <a name="scroll-bar-requests"></a>捲軸要求

使用者可以按一下捲軸的各個部分來進行滾動要求。 系統會以 [**wm \_ HSCROLL**](wm-hscroll.md) 或 [**wm \_ VSCROLL**](wm-vscroll.md) 訊息的形式，將要求傳送至指定的視窗。 水準捲軸傳送 **wm \_ HSCROLL** 訊息; 垂直捲動條傳送 **wm \_ VSCROLL** 訊息。 每個訊息都包含一個要求碼，該程式碼會對應至使用者的動作、捲軸的控制碼 (捲軸控制項) ，而在某些情況下則是捲動方塊的位置。

下圖顯示當您按一下捲軸的不同部分時，使用者所產生的要求碼。

![顯示兩個捲軸上每個區域相關聯之要求碼的圖表](images/csscr-02.png)

SB \_ 值會指定使用者所採取的動作。 應用程式會檢查與 [**wm \_ HSCROLL**](wm-hscroll.md) 和 [**wm \_ VSCROLL**](wm-vscroll.md) 訊息伴隨的程式碼，然後執行適當的滾動作業。 在下表中，會為每個值指定使用者的動作，後面接著應用程式的回應。 在每個案例中，應用程式會視需要為資料定義一個單位。 例如，垂直捲動文字的一般單位是一行文字。



| 要求           | 動作                                                                               | 回應                                                                                                                                                                                                                                                                                                                         |
|-------------------|--------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| SB \_ 系列        | 使用者按一下頂端滾動箭號。                                                | 遞減捲動方塊位置;以一個單位向資料頂端滾動。                                                                                                                                                                                                                                              |
| SB \_ LINEDOWN      | 使用者按一下底部的滾動箭號。                                             | 遞增捲動方塊位置;將資料向下滾動一個單位。                                                                                                                                                                                                                                           |
| SB \_ LINELEFT      | 使用者按一下左方滾動箭號。                                               | 遞減捲動方塊位置;將資料的左邊向左滾動一個單位。                                                                                                                                                                                                                                         |
| SB \_ LINERIGHT     | 使用者按一下向右滾動箭號。                                              | 遞增捲動方塊位置;將資料向右滾動一個單位。                                                                                                                                                                                                                                        |
| SB \_ PAGEUP        | 使用者按一下捲動方塊上方的捲軸軸。                           | 將捲動方塊位置遞減為視窗中的資料單位數目;依相同數目的單位向資料頂端滾動。                                                                                                                                                                                    |
| SB \_ PAGEDOWN      | 使用者按一下捲動方塊下方的捲軸軸。                           | 以視窗中的資料單位數目遞增捲動方塊位置;以相同數目的單位向下滾動資料。                                                                                                                                                                                 |
| SB \_ PAGELEFT      | 使用者按一下捲動方塊左邊的捲軸軸。                  | 將捲動方塊位置遞減為視窗中的資料單位數目;將相同數目的單位向左滾動資料。                                                                                                                                                                               |
| SB \_ PAGERIGHT     | 使用者按一下捲動方塊右側的捲軸軸。                 | 以視窗中的資料單位數目遞增捲動方塊位置;將相同數目的單位向右滾動至資料的右端。                                                                                                                                                                              |
| SB \_ THUMBPOSITION | 拖曳之後，使用者會放開捲動方塊。                                  | 將捲動方塊設定為訊息中指定的位置;將資料以捲動方塊移動的相同單位數滾動。                                                                                                                                                                                             |
| SB \_ THUMBTRACK    | 使用者拖曳捲動方塊。                                                       | 將捲動方塊設定為訊息中指定的位置，並將資料以捲動方塊移動的相同單位數，以快速繪製資料的應用程式為單位滾動。 無法快速繪製資料的應用程式必須先等待 SB \_ THUMBPOSITION 要求碼，再移動捲動方塊並滾動資料。 |
| SB \_ ENDSCROLL     | 當使用者將滑鼠放在箭號或捲軸軸上時，就會放開滑鼠。 | 不需要回應。                                                                                                                                                                                                                                                                                                           |



 

\_當使用者按一下並拖曳捲動方塊時，捲軸會產生 sb THUMBPOSITION 和 sb \_ THUMBTRACK 要求碼。 應用程式應該以程式設計的方式處理 SB \_ THUMBTRACK 或 sb \_ THUMBPOSITION 的要求碼。

\_當使用者按一下捲動方塊之後放開滑鼠按鍵時，就會發生 SB THUMBPOSITION 要求程式碼。 處理此訊息的應用程式會在使用者將捲動方塊拖曳至想要的位置並放開滑鼠按鍵之後，執行滾動操作。

當 \_ 使用者拖曳捲動方塊時，會發生 SB THUMBTRACK 要求程式碼。 如果應用程式處理 SB \_ THUMBTRACK 要求碼，它可以在使用者拖曳捲動方塊時滾動視窗的內容。 不過，捲軸可能會 \_ 在短時間內產生許多 SB THUMBTRACK 要求碼，因此應用程式應該只在可以快速重新繪製視窗的內容時，才處理這些要求代碼。

## <a name="keyboard-interface-for-a-scroll-bar"></a>捲軸的鍵盤介面

捲軸控制項提供內建的鍵盤介面，可讓使用者使用鍵盤來發出滾動要求;標準捲軸不是。 當捲軸控制項具有鍵盤焦點時，會在使用者按下方向鍵時，將 [**wm \_ HSCROLL**](wm-hscroll.md) 和 [**WM \_ VSCROLL**](wm-vscroll.md) 訊息傳送至其父視窗。 要求碼會隨每個對應至使用者按下箭號鍵的訊息一起傳送。 以下是方向鍵及其對應的要求碼。



| 箭號鍵 | 要求碼                  |
|-----------|-------------------------------|
| DOWN      | SB \_ LINEDOWN 或 sb \_ LINERIGHT |
| END       | SB \_ 底部                    |
| HOME      | SB \_ TOP                       |
| LEFT      | SB \_ 陣容或 sb \_ LINELEFT    |
| >PGDN      | SB \_ PAGEDOWN 或 sb \_ PAGERIGHT |
| PGUP      | SB \_ PAGEUP 或 sb \_ PAGELEFT    |
| RIGHT     | SB \_ LINEDOWN 或 sb \_ LINERIGHT |
| UP        | SB \_ 陣容或 sb \_ LINELEFT    |



 

 

> [!Note]  
> 捲軸控制項的鍵盤介面會傳送 SB \_ TOP 和 sb 底部的 \_ 要求碼。 SB \_ top 要求碼表示使用者已到達滾動範圍的最上方值。 應用程式會向下滾動視窗內容，以便顯示資料物件的頂端。 SB \_ 底部要求碼表示使用者已到達滾動範圍的底部值。 如果應用程式處理 SB 最 \_ 下方的要求碼，它會向上滾動視窗內容，以便顯示資料物件的底部。

 

如果您想要標準捲軸的鍵盤介面，您可以在視窗程式中處理 [**WM \_ KEYDOWN**](/windows/desktop/inputdev/wm-keydown) 訊息，然後根據伴隨于訊息的虛擬機器碼來執行適當的滾動動作，藉此建立一個。 如需如何為捲軸建立鍵盤介面的詳細資訊，請參閱 [建立標準捲軸的鍵盤介面](using-scroll-bars.md)。

## <a name="scrolling-the-client-area"></a>滾動工作區

要將工作區的內容最簡單的方式是清除，然後再重新繪製。 這是應用程式可能會與 SB \_ PAGEUP、sb \_ PAGEDOWN 和 sb TOP 要求碼搭配使用的方法， \_ 通常需要全新的內容。

針對某些要求碼（例如 SB 組合 \_ 和 sb \_ LINEDOWN），不需要清除所有的內容，因為在進行滾動之後，某些內容仍會顯示。 [**ScrollWindowEx**](/windows/desktop/api/Winuser/nf-winuser-scrollwindowex)函式會保留一部分的工作區內容、將保留的部分移至指定的數量，然後準備工作區的其餘部分以繪製新的資訊。 **ScrollWindowEx** 會使用 [**BitBlt**](/windows/desktop/api/wingdi/nf-wingdi-bitblt) 函數，將資料物件的特定部分移至工作區中的新位置。 在下一個 [**WM \_ 油漆**](/windows/desktop/gdi/wm-paint) 訊息發生時，工作區中任何未保留的部分 (未保留的任何部分) 會失效、清除及繪製。

[**ScrollWindowEx**](/windows/desktop/api/Winuser/nf-winuser-scrollwindowex)函式可以用來從滾動作業中排除部分的工作區。 這會讓具有固定位置的專案（例如子視窗）在工作區內移動。 它會自動使接收新資訊的工作區部分失效，因此應用程式不需要計算自己的裁剪區域。 如需裁剪的詳細資訊，請參閱 [裁剪](/windows/desktop/gdi/clipping)。

應用程式通常會以捲軸所指示的方向來滾動視窗的內容。 例如，當使用者在捲動方塊下方的區域中按一下捲軸軸時，應用程式會向上將視窗中的物件向下滾動，以顯示位於可見部分之下的物件部分。

您也可以使用 [**ScrollDC**](/windows/desktop/api/Winuser/nf-winuser-scrolldc) 函式來滾動矩形區域。

## <a name="scroll-bar-colors-and-metrics"></a>捲軸色彩和度量

系統定義的色彩值、色彩 \_ 捲軸，會控制捲軸軸內的色彩。 您可以使用 [**GetSysColor**](/windows/desktop/api/winuser/nf-winuser-getsyscolor) 函式來決定捲軸軸的色彩，並使用 [**SetSysColors**](/windows/desktop/api/winuser/nf-winuser-setsyscolors) 函式來設定捲軸軸的色彩。 不過請注意，這種色彩變更會影響系統中的所有捲軸。

您可以藉由呼叫 [**GetSystemMetrics**](/windows/desktop/api/winuser/nf-winuser-getsystemmetrics) 函式，取得系統在標準捲軸中使用的點陣圖維度。 以下是與捲軸相關聯的系統度量值。



| 系統度量 | Description                                                                                                                |
|---------------|----------------------------------------------------------------------------------------------------------------------------|
| SM \_ CXHSCROLL | 水準捲軸上箭號點陣圖的寬度                                                                             |
| SM \_ CXHTHUMB  | 水準捲軸的捲動方塊寬度。 此值會抓取頁面大小為零的捲軸寬度。    |
| SM \_ CXVSCROLL | 垂直捲動條上箭號點陣圖的寬度                                                                               |
| SM \_ CYHSCROLL | 水準捲軸上箭號點陣圖的高度                                                                            |
| SM \_ CYVSCROLL | 垂直捲動條上箭號點陣圖的高度                                                                              |
| SM \_ CYVTHUMB  | 垂直捲動條的捲動方塊高度。 此值會抓取頁面大小為零的捲軸高度。 |



 

 

 