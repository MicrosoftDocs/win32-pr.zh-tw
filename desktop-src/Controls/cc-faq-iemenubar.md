---
title: 如何建立網際網路 Explorer-Style 功能表列
description: 乍看之下，Microsoft Internet Explorer 5 和更新版本中的功能表列看起來類似于標準功能表。 但是，當您開始使用它時，它看起來會非常不同。
ms.assetid: e0fe25f2-3d49-4c5a-a3f9-2f468f2cfef2
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b262bc55407d263c97d4bd7e3938a9794d3a58f5
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/21/2020
ms.locfileid: "103842772"
---
# <a name="how-to-create-an-internet-explorer-style-menu-bar"></a><span data-ttu-id="d14cb-104">如何建立網際網路 Explorer-Style 功能表列</span><span class="sxs-lookup"><span data-stu-id="d14cb-104">How to Create an Internet Explorer-Style Menu Bar</span></span>

<span data-ttu-id="d14cb-105">乍看之下，Microsoft Internet Explorer 5 和更新版本中的功能表列看起來類似于標準功能表。</span><span class="sxs-lookup"><span data-stu-id="d14cb-105">At first glance, the menu bar in Microsoft Internet Explorer 5 and later looks similar to a standard menu.</span></span> <span data-ttu-id="d14cb-106">但是，當您開始使用它時，它看起來會非常不同。</span><span class="sxs-lookup"><span data-stu-id="d14cb-106">However, it looks quite different when you begin using it.</span></span>

<span data-ttu-id="d14cb-107">下列螢幕擷取畫面顯示已選取 [工具] 功能表的 [Windows Internet Explorer] 功能表列。</span><span class="sxs-lookup"><span data-stu-id="d14cb-107">The following screen shot shows the Windows Internet Explorer menu bar with the Tools menu selected.</span></span>

![顯示 windows internet explorer 功能表列的螢幕擷取畫面，其中已選取 [工具] 功能表](images/howto8.jpg)

<span data-ttu-id="d14cb-109">功能表列實際上是一個看起來像標準功能表的工具列控制項。</span><span class="sxs-lookup"><span data-stu-id="d14cb-109">The menu bar is actually a toolbar control that looks like a standard menu.</span></span> <span data-ttu-id="d14cb-110">功能表列除了最上層功能表項目之外，還包含一系列的純文字按鈕，可在按一下時顯示下拉式功能表。</span><span class="sxs-lookup"><span data-stu-id="d14cb-110">Instead of top-level menu items, a menu bar has a series of text-only buttons that display a drop-down menu when clicked.</span></span> <span data-ttu-id="d14cb-111">但是，以特殊類型的工具列來說，功能表列具有標準功能表缺乏的一些功能：</span><span class="sxs-lookup"><span data-stu-id="d14cb-111">However, as a specialized type of toolbar, a menu bar has some capabilities that standard menus lack:</span></span>

-   <span data-ttu-id="d14cb-112">您可以使用標準的工具列技術來自訂它，讓使用者可以移動、刪除或新增專案。</span><span class="sxs-lookup"><span data-stu-id="d14cb-112">It can be customized using standard toolbar techniques, allowing the user to move, delete, or add items.</span></span>
-   <span data-ttu-id="d14cb-113">它可能會有熱追蹤，讓使用者知道他們何時超過最上層專案，而不需要先按一下。</span><span class="sxs-lookup"><span data-stu-id="d14cb-113">It can have hot-tracking, so that users will know when they are over a top-level item without having to click it first.</span></span>

<span data-ttu-id="d14cb-114">功能表列可以併入 Rebar 控制項中，提供下列功能：</span><span class="sxs-lookup"><span data-stu-id="d14cb-114">A menu bar can be incorporated into a rebar control, giving it the following features:</span></span>

-   <span data-ttu-id="d14cb-115">它可以有移動流覽線，可讓使用者移動或調整寬線的大小。</span><span class="sxs-lookup"><span data-stu-id="d14cb-115">It can have a gripper, which allows the user to move or resize the band.</span></span>
-   <span data-ttu-id="d14cb-116">它可以與其他群組（例如上圖中的標準工具列）共用 Rebar 控制項中的條紋。</span><span class="sxs-lookup"><span data-stu-id="d14cb-116">It can share a strip in the rebar control with other bands, such as the standard toolbar in the preceding illustration.</span></span>
-   <span data-ttu-id="d14cb-117">它可以在連續的頻外涵蓋時顯示箭號，讓使用者存取隱藏的專案。</span><span class="sxs-lookup"><span data-stu-id="d14cb-117">It can display a chevron when it is covered by an adjacent band, giving the user access to the hidden items.</span></span>
-   <span data-ttu-id="d14cb-118">它可以有應用程式定義的背景點陣圖。</span><span class="sxs-lookup"><span data-stu-id="d14cb-118">It can have an application-defined background bitmap.</span></span>

<span data-ttu-id="d14cb-119">本主題討論如何執行功能表列。</span><span class="sxs-lookup"><span data-stu-id="d14cb-119">This topic discusses how to implement a menu bar.</span></span> <span data-ttu-id="d14cb-120">因為功能表列是工具列控制項的特殊執行，所以焦點會放在功能表列特定的主題上。</span><span class="sxs-lookup"><span data-stu-id="d14cb-120">Since a menu bar is a specialized implementation of a toolbar control, the focus will be on topics that are specific to menu bars.</span></span> <span data-ttu-id="d14cb-121">如需如何將工具列併入 Rebar 控制項的討論，請參閱 [如何建立網際網路 Explorer-Style 工具列](cc-faq-ietoolbar.md) 和 [Rebar 控制項](rebar-controls.md)。</span><span class="sxs-lookup"><span data-stu-id="d14cb-121">For a discussion of how to incorporate a toolbar into a rebar control, see [How to Create an Internet Explorer-Style Toolbar](cc-faq-ietoolbar.md) and [About Rebar Controls](rebar-controls.md).</span></span>

-   [<span data-ttu-id="d14cb-122">在功能表列中建立工具列</span><span class="sxs-lookup"><span data-stu-id="d14cb-122">Making a Toolbar into a Menu Bar</span></span>](#making-a-toolbar-into-a-menu-bar)
-   [<span data-ttu-id="d14cb-123">已停用功能表 Hot-Tracking 處理導覽</span><span class="sxs-lookup"><span data-stu-id="d14cb-123">Handling Navigation with Menu Hot-Tracking Disabled</span></span>](#handling-navigation-with-menu-hot-tracking-disabled)
    -   [<span data-ttu-id="d14cb-124">滑鼠導覽</span><span class="sxs-lookup"><span data-stu-id="d14cb-124">Mouse Navigation</span></span>](#mouse-navigation)
    -   [<span data-ttu-id="d14cb-125">鍵盤流覽</span><span class="sxs-lookup"><span data-stu-id="d14cb-125">Keyboard Navigation</span></span>](#keyboard-navigation)
    -   [<span data-ttu-id="d14cb-126">混合導覽</span><span class="sxs-lookup"><span data-stu-id="d14cb-126">Mixed Navigation</span></span>](#mixed-navigation)
-   [<span data-ttu-id="d14cb-127">已啟用功能表 Hot-Tracking 的處理導覽</span><span class="sxs-lookup"><span data-stu-id="d14cb-127">Handling Navigation with Menu Hot-Tracking Enabled</span></span>](#handling-navigation-with-menu-hot-tracking-enabled)
    -   [<span data-ttu-id="d14cb-128">功能表熱追蹤的訊息處理</span><span class="sxs-lookup"><span data-stu-id="d14cb-128">Message Processing for Menu Hot-Tracking</span></span>](#message-processing-for-menu-hot-tracking)
    -   [<span data-ttu-id="d14cb-129">滑鼠導覽</span><span class="sxs-lookup"><span data-stu-id="d14cb-129">Mouse Navigation</span></span>](#mouse-navigation)
    -   [<span data-ttu-id="d14cb-130">鍵盤流覽</span><span class="sxs-lookup"><span data-stu-id="d14cb-130">Keyboard Navigation</span></span>](#keyboard-navigation)

## <a name="making-a-toolbar-into-a-menu-bar"></a><span data-ttu-id="d14cb-131">在功能表列中建立工具列</span><span class="sxs-lookup"><span data-stu-id="d14cb-131">Making a Toolbar into a Menu Bar</span></span>

<span data-ttu-id="d14cb-132">若要將工具列設為功能表列：</span><span class="sxs-lookup"><span data-stu-id="d14cb-132">To make a toolbar into a menu bar:</span></span>

-   <span data-ttu-id="d14cb-133">藉由將 TBSTYLE 包含在 [**其他 \_**](toolbar-control-and-button-styles.md) 視窗樣式旗標中，來建立一般工具列。</span><span class="sxs-lookup"><span data-stu-id="d14cb-133">Create a flat toolbar by including [**TBSTYLE\_FLAT**](toolbar-control-and-button-styles.md) with the other window style flags.</span></span> <span data-ttu-id="d14cb-134">**TBSTYLE 的 \_ 平面** 樣式也可啟用熱追蹤。</span><span class="sxs-lookup"><span data-stu-id="d14cb-134">The **TBSTYLE\_FLAT** style also enables hot-tracking.</span></span> <span data-ttu-id="d14cb-135">使用此樣式時，功能表列看起來很像標準功能表，直到使用者啟動按鈕為止。</span><span class="sxs-lookup"><span data-stu-id="d14cb-135">With this style, the menu bar looks much like a standard menu until the user activates a button.</span></span> <span data-ttu-id="d14cb-136">然後，按鈕會顯示在工具列上，然後按下按鍵，就像標準按鈕一樣。</span><span class="sxs-lookup"><span data-stu-id="d14cb-136">Then, the button appears to stand out from the toolbar and depress when it is clicked, just like a standard button.</span></span> <span data-ttu-id="d14cb-137">因為已啟用熱追蹤，所以啟動按鈕所需的一切都是要將游標停留在其上方。</span><span class="sxs-lookup"><span data-stu-id="d14cb-137">Because hot-tracking is enabled, all that is needed to activate a button is for the cursor to hover over it.</span></span> <span data-ttu-id="d14cb-138">如果游標移至另一個按鈕，將會啟用它，並停用舊的按鈕。</span><span class="sxs-lookup"><span data-stu-id="d14cb-138">If the cursor moves to another button, it will be activated and the old button deactivated.</span></span>
-   <span data-ttu-id="d14cb-139">藉由包含 [**TBSTYLE \_ 清單**](toolbar-control-and-button-styles.md) 與其他視窗樣式旗標，建立清單樣式的按鈕。</span><span class="sxs-lookup"><span data-stu-id="d14cb-139">Create list-style buttons by including [**TBSTYLE\_LIST**](toolbar-control-and-button-styles.md) with the other window style flags.</span></span> <span data-ttu-id="d14cb-140">此樣式會建立更精簡的按鈕，看起來更像是標準最上層功能表項目。</span><span class="sxs-lookup"><span data-stu-id="d14cb-140">This style creates a thinner button that looks more like a standard top-level menu item.</span></span>
-   <span data-ttu-id="d14cb-141">將按鈕 [**TBBUTTON**](/windows/desktop/api/Commctrl/ns-commctrl-tbbutton)結構的 **iBitmap** 成員設定為 I \_ IMAGENONE，並將 **iString** 成員設為按鈕文字，以將按鈕設為純文字。</span><span class="sxs-lookup"><span data-stu-id="d14cb-141">Make the buttons text-only by setting the **iBitmap** member of the button's [**TBBUTTON**](/windows/desktop/api/Commctrl/ns-commctrl-tbbutton) structure to I\_IMAGENONE and the **iString** member to the button text.</span></span>
-   <span data-ttu-id="d14cb-142">為每個按鈕提供 [**BTNS \_ 下拉式**](toolbar-control-and-button-styles.md) 樣式。</span><span class="sxs-lookup"><span data-stu-id="d14cb-142">Give each button the [**BTNS\_DROPDOWN**](toolbar-control-and-button-styles.md) style.</span></span> <span data-ttu-id="d14cb-143">按一下按鈕時，工具列控制項會傳送 [TBN 的 \_ 下拉式](tbn-dropdown.md) 通知給您的應用程式，提示它顯示按鈕的功能表。</span><span class="sxs-lookup"><span data-stu-id="d14cb-143">When the button is clicked, the toolbar control sends your application a [TBN\_DROPDOWN](tbn-dropdown.md) notification to prompt it to display the button's menu.</span></span>
-   <span data-ttu-id="d14cb-144">將功能表列併入 Rebar 區中。</span><span class="sxs-lookup"><span data-stu-id="d14cb-144">Incorporate the menu bar into a rebar band.</span></span> <span data-ttu-id="d14cb-145">啟用 grippers 和燕尾，如 [如何建立網際網路 Explorer-Style 的工具列](cc-faq-ietoolbar.md)中所述。</span><span class="sxs-lookup"><span data-stu-id="d14cb-145">Enable both grippers and chevrons, as discussed in [How to Create an Internet Explorer-Style Toolbar](cc-faq-ietoolbar.md).</span></span>
-   <span data-ttu-id="d14cb-146">執行 [TBN 的 \_](tbn-dropdown.md) 下拉式處理常式，以在按 *下* 按鈕時顯示按鈕的下拉式功能表。</span><span class="sxs-lookup"><span data-stu-id="d14cb-146">Implement a [TBN\_DROPDOWN](tbn-dropdown.md) handler to display the button's *drop-down menu* when it is clicked.</span></span> <span data-ttu-id="d14cb-147">下拉式功能表是快顯功能表的一種類型。</span><span class="sxs-lookup"><span data-stu-id="d14cb-147">The drop-down menu is a type of pop-up menu.</span></span> <span data-ttu-id="d14cb-148">它是使用 [**trackpopupmenu 讓**](/windows/desktop/api/winuser/nf-winuser-trackpopupmenu) 函式來建立，其左上角與按鈕的左下角對齊。</span><span class="sxs-lookup"><span data-stu-id="d14cb-148">It is created by using the [**TrackPopupMenu**](/windows/desktop/api/winuser/nf-winuser-trackpopupmenu) function, with its upper-left corner aligned with the lower-left corner of the button.</span></span>
-   <span data-ttu-id="d14cb-149">執行鍵盤導覽，讓功能表列可在沒有滑鼠的情況下完整存取。</span><span class="sxs-lookup"><span data-stu-id="d14cb-149">Implement keyboard navigation, so that the menu bar is fully accessible without a mouse.</span></span>
-   <span data-ttu-id="d14cb-150">執行功能表熱追蹤。</span><span class="sxs-lookup"><span data-stu-id="d14cb-150">Implement menu hot-tracking.</span></span> <span data-ttu-id="d14cb-151">使用標準功能表，在顯示最上層功能表項目的功能表之後，將游標移至另一個最上層專案，會自動顯示其功能表並折迭上一個專案的功能表。</span><span class="sxs-lookup"><span data-stu-id="d14cb-151">With standard menus, once a top level menu item's menu has been displayed, moving the cursor over another top-level item automatically displays its menu and collapses the menu of the previous item.</span></span> <span data-ttu-id="d14cb-152">工具列控制項將會熱追蹤游標並變更按鈕影像，但會自動顯示新的功能表。</span><span class="sxs-lookup"><span data-stu-id="d14cb-152">The toolbar control will hot-track the cursor and change the button image, but it does automatically display the new menu.</span></span> <span data-ttu-id="d14cb-153">您的應用程式必須明確地完成。</span><span class="sxs-lookup"><span data-stu-id="d14cb-153">Your application must do so explicitly.</span></span>

<span data-ttu-id="d14cb-154">這些專案大多都可直接執行，並在其他地方討論。</span><span class="sxs-lookup"><span data-stu-id="d14cb-154">Most of these items are straightforward to implement and are discussed elsewhere.</span></span> <span data-ttu-id="d14cb-155">如需如何使用工具列和 Rebar 控制項的一般討論，請參閱 [如何建立網際網路 Explorer-Style 工具列](cc-faq-ietoolbar.md)、 [工具列控制項](toolbar-controls-overview.md)或 [關於 Rebar 控制項](rebar-controls.md) 。</span><span class="sxs-lookup"><span data-stu-id="d14cb-155">See [How to Create an Internet Explorer-Style Toolbar](cc-faq-ietoolbar.md), [About Toolbar Controls](toolbar-controls-overview.md), or [About Rebar Controls](rebar-controls.md) for a general discussion of how to use toolbars and rebar controls.</span></span> <span data-ttu-id="d14cb-156">如需如何處理快顯功能表的討論，請參閱 [功能表](/windows/desktop/menurc/menus) 。</span><span class="sxs-lookup"><span data-stu-id="d14cb-156">See [Menus](/windows/desktop/menurc/menus) for a discussion of how to handle pop-up menus.</span></span> <span data-ttu-id="d14cb-157">本主題的其餘部分將討論最後兩個專案：鍵盤導覽和功能表熱追蹤。</span><span class="sxs-lookup"><span data-stu-id="d14cb-157">The final two items, keyboard navigation and menu hot-tracking, are discussed in the remainder of this topic.</span></span>

## <a name="handling-navigation-with-menu-hot-tracking-disabled"></a><span data-ttu-id="d14cb-158">已停用功能表 Hot-Tracking 處理導覽</span><span class="sxs-lookup"><span data-stu-id="d14cb-158">Handling Navigation with Menu Hot-Tracking Disabled</span></span>

<span data-ttu-id="d14cb-159">使用者可以選擇使用滑鼠、鍵盤或兩者的混合來流覽功能表列。</span><span class="sxs-lookup"><span data-stu-id="d14cb-159">Users can choose to navigate the menu bar with the mouse, the keyboard, or a mixture of both.</span></span> <span data-ttu-id="d14cb-160">若要執行功能表列流覽，您的應用程式必須處理工具列通知，並監視滑鼠和鍵盤。</span><span class="sxs-lookup"><span data-stu-id="d14cb-160">To implement menu bar navigation, your application must handle toolbar notifications and monitor the mouse and keyboard.</span></span> <span data-ttu-id="d14cb-161">這項工作可分成兩個不同的部分：不論是否有功能表熱追蹤。</span><span class="sxs-lookup"><span data-stu-id="d14cb-161">This task can be broken into two distinct parts: with and without menu hot-tracking.</span></span> <span data-ttu-id="d14cb-162">本節討論如何在沒有顯示功能表且未啟用功能表熱追蹤的情況下處理導覽。</span><span class="sxs-lookup"><span data-stu-id="d14cb-162">This section discusses how to handle navigation when no menus are displayed and menu hot-tracking is not enabled.</span></span>

### <a name="mouse-navigation"></a><span data-ttu-id="d14cb-163">滑鼠導覽</span><span class="sxs-lookup"><span data-stu-id="d14cb-163">Mouse Navigation</span></span>

<span data-ttu-id="d14cb-164">如果停用功能表熱追蹤，您可以將功能表列視為一般工具列。</span><span class="sxs-lookup"><span data-stu-id="d14cb-164">If menu hot-tracking is disabled, you can treat a menu bar as a normal toolbar.</span></span> <span data-ttu-id="d14cb-165">如果使用者是使用滑鼠流覽，則您的所有應用程式都需要處理 TBN 的 [ \_ 下拉式清單](tbn-dropdown.md) 通知。</span><span class="sxs-lookup"><span data-stu-id="d14cb-165">If the user is navigating with a mouse, all your application needs to do is handle the [TBN\_DROPDOWN](tbn-dropdown.md) notification.</span></span> <span data-ttu-id="d14cb-166">收到此通知時，會顯示適當的下拉式功能表，並啟用功能表熱追蹤。</span><span class="sxs-lookup"><span data-stu-id="d14cb-166">When this notification is received, display the appropriate drop-down menu, and enable menu hot-tracking.</span></span> <span data-ttu-id="d14cb-167">從那開始，您會在 [處理導覽] 功能表中所討論的 [熱追蹤] 制度中， [Hot-Tracking 已啟用](#handling-navigation-with-menu-hot-tracking-enabled)。</span><span class="sxs-lookup"><span data-stu-id="d14cb-167">From then on, you are in the menu hot-tracking regime discussed in [Handling Navigation with Menu Hot-Tracking Enabled](#handling-navigation-with-menu-hot-tracking-enabled).</span></span>

<span data-ttu-id="d14cb-168">如 [混合導覽](#mixed-navigation)所述，您也需要處理 [TBN \_ HOTITEMCHANGE](tbn-hotitemchange.md) 通知，以追蹤作用中的按鈕。</span><span class="sxs-lookup"><span data-stu-id="d14cb-168">As discussed in [Mixed Navigation](#mixed-navigation), you also need to handle the [TBN\_HOTITEMCHANGE](tbn-hotitemchange.md) notification to keep track of the active button.</span></span> <span data-ttu-id="d14cb-169">如果使用者只是使用滑鼠流覽，但在混合滑鼠和鍵盤流覽時需要此通知，則這項通知是不相關的。</span><span class="sxs-lookup"><span data-stu-id="d14cb-169">This notification is irrelevant if the user is only navigating with the mouse, but it is necessary when mouse and keyboard navigation are mixed.</span></span>

### <a name="keyboard-navigation"></a><span data-ttu-id="d14cb-170">鍵盤導覽</span><span class="sxs-lookup"><span data-stu-id="d14cb-170">Keyboard Navigation</span></span>

<span data-ttu-id="d14cb-171">如上一節所述，當功能表熱追蹤停用時，使用者可以使用鍵盤進行一些流覽作業。</span><span class="sxs-lookup"><span data-stu-id="d14cb-171">As noted in the previous section, the user can do a number of navigation operations with the keyboard when menu hot-tracking is disabled.</span></span> <span data-ttu-id="d14cb-172">只有當工具列控制項有焦點時，工具列控制項才支援鍵盤流覽。</span><span class="sxs-lookup"><span data-stu-id="d14cb-172">Toolbar controls support keyboard navigation only if they have focus.</span></span> <span data-ttu-id="d14cb-173">它們也不會處理功能表列所需的所有按鍵按鍵。</span><span class="sxs-lookup"><span data-stu-id="d14cb-173">They also do not handle all the key presses that are needed for menu bars.</span></span> <span data-ttu-id="d14cb-174">處理鍵盤導覽最簡單的方法，就是明確地處理相關的按鍵事件。</span><span class="sxs-lookup"><span data-stu-id="d14cb-174">The simplest solution to handling keyboard navigation is to process the relevant key press events explicitly.</span></span>

<span data-ttu-id="d14cb-175">如果停用功能表熱追蹤，您的應用程式必須以下列方式處理這些按鍵事件：</span><span class="sxs-lookup"><span data-stu-id="d14cb-175">If menu hot-tracking is disabled, your application must handle these key press events in the following way:</span></span>

-   <span data-ttu-id="d14cb-176">F10 鍵。</span><span class="sxs-lookup"><span data-stu-id="d14cb-176">The F10 key.</span></span> <span data-ttu-id="d14cb-177">啟用具有 [**TB \_ SETHOTITEM**](tb-sethotitem.md)的第一個按鈕。</span><span class="sxs-lookup"><span data-stu-id="d14cb-177">Activate the first button with [**TB\_SETHOTITEM**](tb-sethotitem.md).</span></span>
-   <span data-ttu-id="d14cb-178">向左鍵和向右箭號。</span><span class="sxs-lookup"><span data-stu-id="d14cb-178">The LEFT ARROW and RIGHT ARROW keys.</span></span> <span data-ttu-id="d14cb-179">啟用具有 [**TB \_ SETHOTITEM**](tb-sethotitem.md)的相鄰按鈕。</span><span class="sxs-lookup"><span data-stu-id="d14cb-179">Activate the adjacent button with [**TB\_SETHOTITEM**](tb-sethotitem.md).</span></span> <span data-ttu-id="d14cb-180">如果使用者嘗試流覽功能表列的任一端，請啟用另一端的第一個按鈕。</span><span class="sxs-lookup"><span data-stu-id="d14cb-180">If the user attempts to navigate off either end of the menu bar, activate the first button at the opposite end.</span></span>
-   <span data-ttu-id="d14cb-181">ESCAPE 鍵。</span><span class="sxs-lookup"><span data-stu-id="d14cb-181">The ESCAPE key.</span></span> <span data-ttu-id="d14cb-182">停用具有 [**TB \_ SETHOTITEM**](tb-sethotitem.md)的作用中按鈕。</span><span class="sxs-lookup"><span data-stu-id="d14cb-182">Deactivate the active button with [**TB\_SETHOTITEM**](tb-sethotitem.md).</span></span> <span data-ttu-id="d14cb-183">功能表列應該會回到啟用第一個按鈕之前的狀態。</span><span class="sxs-lookup"><span data-stu-id="d14cb-183">The menu bar should be returned to the state it had prior to activating the first button.</span></span>
-   <span data-ttu-id="d14cb-184">ALT *鍵* 加速器鍵。</span><span class="sxs-lookup"><span data-stu-id="d14cb-184">An ALT-*Key* accelerator key.</span></span> <span data-ttu-id="d14cb-185">使用 [**TB \_ MAPACCELERATOR**](tb-mapaccelerator.md) 訊息來判斷索引 *鍵* 字元所對應的按鈕。</span><span class="sxs-lookup"><span data-stu-id="d14cb-185">Use the [**TB\_MAPACCELERATOR**](tb-mapaccelerator.md) message to determine which button the *Key* character corresponds to.</span></span> <span data-ttu-id="d14cb-186">顯示按鈕的下拉式功能表，並啟用功能表熱追蹤。</span><span class="sxs-lookup"><span data-stu-id="d14cb-186">Display the button's drop-down menu and enable menu hot-tracking.</span></span>
-   <span data-ttu-id="d14cb-187">向下鍵。</span><span class="sxs-lookup"><span data-stu-id="d14cb-187">The DOWN ARROW key.</span></span> <span data-ttu-id="d14cb-188">如果按鈕為作用中，但未顯示任何功能表，則會顯示按鈕的功能表，並啟用功能表熱追蹤。</span><span class="sxs-lookup"><span data-stu-id="d14cb-188">If a button is active but no menu has been displayed, display the button's menu and enable menu hot-tracking.</span></span>
-   <span data-ttu-id="d14cb-189">ENTER 鍵。</span><span class="sxs-lookup"><span data-stu-id="d14cb-189">The ENTER key.</span></span> <span data-ttu-id="d14cb-190">停用具有 [**TB \_ SETHOTITEM**](tb-sethotitem.md)的作用中按鈕。</span><span class="sxs-lookup"><span data-stu-id="d14cb-190">Deactivate the active button with [**TB\_SETHOTITEM**](tb-sethotitem.md).</span></span> <span data-ttu-id="d14cb-191">功能表列應該會回到啟用第一個按鈕之前的狀態。</span><span class="sxs-lookup"><span data-stu-id="d14cb-191">The menu bar should be returned to the state it had prior to activating the first button.</span></span>

### <a name="mixed-navigation"></a><span data-ttu-id="d14cb-192">混合導覽</span><span class="sxs-lookup"><span data-stu-id="d14cb-192">Mixed Navigation</span></span>

<span data-ttu-id="d14cb-193">上一節中所述的鍵盤導覽處理常式基本上會執行兩項工作：追蹤使用中的按鈕，並在選取按鈕時顯示適當的功能表。</span><span class="sxs-lookup"><span data-stu-id="d14cb-193">The keyboard navigation handlers outlined in the preceding section basically do two tasks: keep track of the active button and display the appropriate menu when a button is selected.</span></span> <span data-ttu-id="d14cb-194">只要使用者只流覽鍵盤，這些處理常式就已足夠。</span><span class="sxs-lookup"><span data-stu-id="d14cb-194">These handlers are sufficient as long as the user navigates only with the keyboard.</span></span> <span data-ttu-id="d14cb-195">不過，使用者通常會混合鍵盤和滑鼠導覽。</span><span class="sxs-lookup"><span data-stu-id="d14cb-195">However, users often mix keyboard and mouse navigation.</span></span> <span data-ttu-id="d14cb-196">例如，他們可能會以 F10 鍵啟動第一個按鈕，使用滑鼠來啟用不同的按鈕，然後使用向下鍵開啟其功能表。</span><span class="sxs-lookup"><span data-stu-id="d14cb-196">For example, they might activate the first button with the F10 key, use the mouse to activate a different button, and then open its menu with the DOWN ARROW key.</span></span> <span data-ttu-id="d14cb-197">如果您只監視按鍵來追蹤使用中的金鑰，您將會顯示錯誤的功能表。</span><span class="sxs-lookup"><span data-stu-id="d14cb-197">If you are only monitoring key presses to keep track of the active key, you will display the wrong menu.</span></span> <span data-ttu-id="d14cb-198">您也必須處理 [TBN \_ HOTITEMCHANGE](tbn-hotitemchange.md) 通知，以精確地追蹤使用中的按鈕。</span><span class="sxs-lookup"><span data-stu-id="d14cb-198">You must also handle the [TBN\_HOTITEMCHANGE](tbn-hotitemchange.md) notification to accurately keep track of the active button.</span></span>

## <a name="handling-navigation-with-menu-hot-tracking-enabled"></a><span data-ttu-id="d14cb-199">已啟用功能表 Hot-Tracking 的處理導覽</span><span class="sxs-lookup"><span data-stu-id="d14cb-199">Handling Navigation with Menu Hot-Tracking Enabled</span></span>

<span data-ttu-id="d14cb-200">啟用功能表熱追蹤時，您的應用程式必須變更回應使用者流覽的方式。</span><span class="sxs-lookup"><span data-stu-id="d14cb-200">When menu hot-tracking is enabled, your application must change the way it responds to user navigation.</span></span> <span data-ttu-id="d14cb-201">若要複製標準功能表的行為，您必須明確地執行下列功能。</span><span class="sxs-lookup"><span data-stu-id="d14cb-201">To replicate the behavior of standard menus, you must implement the following features explicitly.</span></span>

<span data-ttu-id="d14cb-202">使用滑鼠流覽：</span><span class="sxs-lookup"><span data-stu-id="d14cb-202">With mouse navigation:</span></span>

-   <span data-ttu-id="d14cb-203">如果使用者將游標移至另一個按鈕上，則會立即顯示該功能表，並顯示上一個功能表。</span><span class="sxs-lookup"><span data-stu-id="d14cb-203">If the user moves the cursor over another button, that menu immediately appears and the previous menu disappears.</span></span>
-   <span data-ttu-id="d14cb-204">功能表熱追蹤會保持作用中，直到使用者選取命令或按一下不是功能表區域一部分的點為止。</span><span class="sxs-lookup"><span data-stu-id="d14cb-204">Menu hot-tracking stays active until the user selects a command or clicks a point that is not part of the menu region.</span></span> <span data-ttu-id="d14cb-205">這兩個動作都會停用功能表熱追蹤，直到按一下另一個按鈕為止。</span><span class="sxs-lookup"><span data-stu-id="d14cb-205">Either action deactivates menu hot-tracking until another button is clicked.</span></span>
-   <span data-ttu-id="d14cb-206">如果游標移出功能表，則目前的下拉式功能表會一直保留到游標移回之前，或使用者按一下外點以外的位置，也就是功能表所涵蓋的區域。</span><span class="sxs-lookup"><span data-stu-id="d14cb-206">If the cursor moves off the menu, the current drop-down menu remains until the cursor moves back onto, or the user clicks a point outside, the area covered by the menu.</span></span> <span data-ttu-id="d14cb-207">如果資料指標返回的按鈕和目前顯示的不同，則舊功能表會折迭，並顯示新功能表。</span><span class="sxs-lookup"><span data-stu-id="d14cb-207">If the cursor returns to a different button than the one currently being displayed, the old menu is collapsed and the new menu is displayed.</span></span>

<span data-ttu-id="d14cb-208">使用鍵盤流覽：</span><span class="sxs-lookup"><span data-stu-id="d14cb-208">With keyboard navigation:</span></span>

-   <span data-ttu-id="d14cb-209">向右箭號會將焦點向右移動。</span><span class="sxs-lookup"><span data-stu-id="d14cb-209">The RIGHT ARROW key moves the focus to the right.</span></span> <span data-ttu-id="d14cb-210">如果專案有子功能表，請顯示子功能表。</span><span class="sxs-lookup"><span data-stu-id="d14cb-210">If the item has a submenu, display the submenu.</span></span> <span data-ttu-id="d14cb-211">如果專案沒有子功能表，請折迭功能表和任何子功能表，以 [ [**TB] \_ SETHOTITEM**](tb-sethotitem.md)啟動 [下一步] 按鈕，並顯示相鄰按鈕的功能表。</span><span class="sxs-lookup"><span data-stu-id="d14cb-211">If the item does not have a submenu, collapse the menu and any submenus, activate the next button with [**TB\_SETHOTITEM**](tb-sethotitem.md), and display the menu for the adjacent button.</span></span> <span data-ttu-id="d14cb-212">如果接收到此訊息時，最後一個按鈕是作用中，則會顯示第一個按鈕的功能表。</span><span class="sxs-lookup"><span data-stu-id="d14cb-212">If the last button is active when this message is received, display the menu for the first button.</span></span>
-   <span data-ttu-id="d14cb-213">向左箭號會將焦點向左移動。</span><span class="sxs-lookup"><span data-stu-id="d14cb-213">The LEFT ARROW key moves the focus to the left.</span></span> <span data-ttu-id="d14cb-214">如果專案是子功能表，請折迭該專案並將焦點移至其父功能表。</span><span class="sxs-lookup"><span data-stu-id="d14cb-214">If the item is a submenu, collapse it and shift focus to its parent menu.</span></span> <span data-ttu-id="d14cb-215">如果專案不是子功能表，請折迭功能表，以 [ [**TB] \_ SETHOTITEM**](tb-sethotitem.md)啟用 [下一步] 按鈕，然後顯示該按鈕的功能表。</span><span class="sxs-lookup"><span data-stu-id="d14cb-215">If the item is not a submenu, collapse the menu, activate the next button with [**TB\_SETHOTITEM**](tb-sethotitem.md), and display the menu for that button.</span></span>

<!-- -->

-   <span data-ttu-id="d14cb-216">ESCAPE 鍵可將顯示一個步驟。</span><span class="sxs-lookup"><span data-stu-id="d14cb-216">The ESCAPE key backs the display up one step.</span></span>
    -   <span data-ttu-id="d14cb-217">如果顯示子功能表，則會折迭並將焦點移至父功能表。</span><span class="sxs-lookup"><span data-stu-id="d14cb-217">If a submenu is displayed, it is collapsed and focus shifts to the parent menu.</span></span>
    -   <span data-ttu-id="d14cb-218">如果顯示按鈕的功能表，則會折迭並停用功能表熱追蹤。</span><span class="sxs-lookup"><span data-stu-id="d14cb-218">If a button's menu is displayed, it is collapsed and menu hot-tracking is disabled.</span></span> <span data-ttu-id="d14cb-219">專案的按鈕會保持作用中狀態。</span><span class="sxs-lookup"><span data-stu-id="d14cb-219">The item's button remains active.</span></span>
    -   <span data-ttu-id="d14cb-220">如果未顯示任何功能表，但按鈕為使用中，則會停用按鈕，並停用功能表熱追蹤。</span><span class="sxs-lookup"><span data-stu-id="d14cb-220">If no menus are displayed but a button is active, the button is deactivated and menu hot-tracking is disabled.</span></span>
-   <span data-ttu-id="d14cb-221">向上鍵和向下鍵只用于在特定功能表中流覽。</span><span class="sxs-lookup"><span data-stu-id="d14cb-221">The UP ARROW and DOWN ARROW keys are used only to navigate within a particular menu.</span></span>
-   <span data-ttu-id="d14cb-222">ENTER 鍵會啟動與功能表項目相關聯的命令。</span><span class="sxs-lookup"><span data-stu-id="d14cb-222">The ENTER key launches the command associated with a menu item.</span></span> <span data-ttu-id="d14cb-223">如果功能表項目有子功能表，則 ENTER 鍵會顯示它。</span><span class="sxs-lookup"><span data-stu-id="d14cb-223">If the menu item has a submenu, the ENTER key displays it.</span></span>

<span data-ttu-id="d14cb-224">如同功能表熱追蹤已停用的情況，您的應用程式必須能夠處理滑鼠、鍵盤和混合導覽。</span><span class="sxs-lookup"><span data-stu-id="d14cb-224">As with the menu hot-tracking disabled case, your application must be able to handle mouse, keyboard, and mixed navigation.</span></span> <span data-ttu-id="d14cb-225">不過，顯示功能表的事實表示訊息必須以不同的方式處理。</span><span class="sxs-lookup"><span data-stu-id="d14cb-225">However, the fact that a menu is displayed means that messaging will have to be handled somewhat differently.</span></span>

### <a name="message-processing-for-menu-hot-tracking"></a><span data-ttu-id="d14cb-226">功能表 Hot-Tracking 的訊息處理</span><span class="sxs-lookup"><span data-stu-id="d14cb-226">Message Processing for Menu Hot-Tracking</span></span>

<span data-ttu-id="d14cb-227">功能表熱追蹤需要在任何時間顯示功能表，除了切換至新功能表所需的短暫間隔以外。</span><span class="sxs-lookup"><span data-stu-id="d14cb-227">Menu hot-tracking requires that a menu be displayed at all times, apart from the brief interval required to switch to a new menu.</span></span> <span data-ttu-id="d14cb-228">不過， [**trackpopupmenu 讓**](/windows/desktop/api/winuser/nf-winuser-trackpopupmenu) 所顯示的下拉式功能表為強制回應。</span><span class="sxs-lookup"><span data-stu-id="d14cb-228">However, the drop-down menu that is displayed by [**TrackPopupMenu**](/windows/desktop/api/winuser/nf-winuser-trackpopupmenu) is modal.</span></span> <span data-ttu-id="d14cb-229">您的應用程式將會繼續直接接收部分訊息，包括 [**wm \_ 命令**](/windows/desktop/menurc/wm-command)、 [TBN \_ HOTITEMCHANGE](tbn-hotitemchange.md)，以及一般功能表相關訊息（例如 [**wm \_ MENUSELECT**](/windows/desktop/menurc/wm-menuselect)）。</span><span class="sxs-lookup"><span data-stu-id="d14cb-229">Your application will continue to receive some messages directly, including [**WM\_COMMAND**](/windows/desktop/menurc/wm-command), [TBN\_HOTITEMCHANGE](tbn-hotitemchange.md), and normal menu-related messages such as [**WM\_MENUSELECT**](/windows/desktop/menurc/wm-menuselect).</span></span> <span data-ttu-id="d14cb-230">但是，它不會直接收到低層級的鍵盤或滑鼠訊息。</span><span class="sxs-lookup"><span data-stu-id="d14cb-230">However, it will not receive low-level keyboard or mouse messages directly.</span></span> <span data-ttu-id="d14cb-231">若要處理諸如 [**WM \_ MOUSEMOVE**](/windows/desktop/inputdev/wm-mousemove)之類的訊息，您必須設定訊息勾點，以攔截導向至功能表的訊息。</span><span class="sxs-lookup"><span data-stu-id="d14cb-231">To handle messages such as [**WM\_MOUSEMOVE**](/windows/desktop/inputdev/wm-mousemove), you must set a message hook to intercept messages that are directed to the menu.</span></span>

<span data-ttu-id="d14cb-232">出現下拉式功能表時，請呼叫 [**SetWindowsHookEx**](/windows/desktop/api/winuser/nf-winuser-setwindowshookexa) 函式，並將 *idHook* 參數設定為 WH MSGFILTER，以設定訊息掛勾 \_ 。</span><span class="sxs-lookup"><span data-stu-id="d14cb-232">When a drop-down menu is displayed, set the message hook by calling the [**SetWindowsHookEx**](/windows/desktop/api/winuser/nf-winuser-setwindowshookexa) function with the *idHook* parameter set to WH\_MSGFILTER.</span></span> <span data-ttu-id="d14cb-233">所有適用于功能表的訊息都會傳遞至您的 [勾](/previous-versions/windows/desktop/legacy/ms644987(v=vs.85))點程式。</span><span class="sxs-lookup"><span data-stu-id="d14cb-233">All messages intended for the menu will be passed to your [hook procedure](/previous-versions/windows/desktop/legacy/ms644987(v=vs.85)).</span></span> <span data-ttu-id="d14cb-234">例如，下列程式碼片段會設定訊息攔截，以將會攔截到下拉式功能表的訊息。</span><span class="sxs-lookup"><span data-stu-id="d14cb-234">For example, the following code fragment sets a message hook that will trap messages that are going to a drop-down menu.</span></span> <span data-ttu-id="d14cb-235">`MsgHook` 這是攔截程式的名稱，而 `hhookMsg` 則是程式的控制碼。</span><span class="sxs-lookup"><span data-stu-id="d14cb-235">`MsgHook` is the name of the hook procedure, and `hhookMsg` is the handle to the procedure.</span></span>


```
hhookMsg = SetWindowsHookEx(WH_MSGFILTER, MsgHook, HINST_THISDLL, 0);
```



<span data-ttu-id="d14cb-236">藉由將攔截程式的 *nCode* 參數設定為 [MSGF] 功能表，即可識別功能表訊息 \_ 。</span><span class="sxs-lookup"><span data-stu-id="d14cb-236">Menu messages are identified by setting the hook procedure's *nCode* parameter to MSGF\_MENU.</span></span> <span data-ttu-id="d14cb-237">*LParam* 參數會指向含有 [**訊息的訊息結構。**](/windows/win32/api/winuser/ns-winuser-msg)</span><span class="sxs-lookup"><span data-stu-id="d14cb-237">The *lParam* parameter will point to a [**MSG**](/windows/win32/api/winuser/ns-winuser-msg) structure with the message.</span></span> <span data-ttu-id="d14cb-238">本主題的其餘部分將討論哪些訊息需要處理的詳細資訊，以及如何處理這些訊息。</span><span class="sxs-lookup"><span data-stu-id="d14cb-238">The details of which messages need to be handled, and how, are discussed in the remainder of this topic.</span></span>

<span data-ttu-id="d14cb-239">您的應用程式必須藉由呼叫 [**CallNextHookEx**](/windows/desktop/api/winuser/nf-winuser-callnexthookex) 函式，將所有訊息傳遞至下一個訊息勾點。</span><span class="sxs-lookup"><span data-stu-id="d14cb-239">Your application must pass all messages on to the next message hook by calling the [**CallNextHookEx**](/windows/desktop/api/winuser/nf-winuser-callnexthookex) function.</span></span> <span data-ttu-id="d14cb-240">您也必須將滑鼠訊息直接傳送到工具列控制項，以確保將任何點座標轉換成工具列用戶端座標空間。</span><span class="sxs-lookup"><span data-stu-id="d14cb-240">You must also send mouse messages directly to the toolbar control, making sure to convert any point coordinates to the toolbar client coordinate space.</span></span> <span data-ttu-id="d14cb-241">直接傳送訊息可確保工具列控制項收到適當的滑鼠訊息。</span><span class="sxs-lookup"><span data-stu-id="d14cb-241">Sending the messages directly ensures that the toolbar control receives the appropriate mouse messages.</span></span> <span data-ttu-id="d14cb-242">例如，工具列必須接收 [**WM 的 \_ MOUSEMOVE**](/windows/desktop/inputdev/wm-mousemove) 訊息，才能對其按鈕進行熱追蹤。</span><span class="sxs-lookup"><span data-stu-id="d14cb-242">For instance, the toolbar needs to receive [**WM\_MOUSEMOVE**](/windows/desktop/inputdev/wm-mousemove) messages in order to hot-track its buttons.</span></span>

<span data-ttu-id="d14cb-243">啟用新按鈕時，您的應用程式必須以 [**WM \_ CANCELMODE**](/windows/desktop/winmsg/wm-cancelmode) 訊息折迭舊的下拉式功能表，並顯示新的功能表。</span><span class="sxs-lookup"><span data-stu-id="d14cb-243">When a new button is activated, your application must collapse the old drop-down menu with a [**WM\_CANCELMODE**](/windows/desktop/winmsg/wm-cancelmode) message, and display a new menu.</span></span> <span data-ttu-id="d14cb-244">當焦點取自具有鍵盤導覽的功能表列，或按一下功能表區域以外的地方時，也必須折迭下拉式功能表。</span><span class="sxs-lookup"><span data-stu-id="d14cb-244">It must also collapse the drop-down menu when focus is taken from the menu bar with keyboard navigation or by clicking outside the menu area.</span></span> <span data-ttu-id="d14cb-245">當您折迭功能表時，您應該使用 [**UnhookWindowsHookEx**](/windows/desktop/api/winuser/nf-winuser-unhookwindowshookex) 函式來釋出它的訊息勾點。</span><span class="sxs-lookup"><span data-stu-id="d14cb-245">Whenever you collapse a menu, you should free its message hook by using the [**UnhookWindowsHookEx**](/windows/desktop/api/winuser/nf-winuser-unhookwindowshookex) function.</span></span> <span data-ttu-id="d14cb-246">如果您需要顯示另一個下拉式功能表，請建立新的訊息勾點。</span><span class="sxs-lookup"><span data-stu-id="d14cb-246">If you need to display another drop-down menu, create a new message hook.</span></span> <span data-ttu-id="d14cb-247">啟動命令時，功能表將會自動折迭，但您必須明確釋放訊息掛勾。</span><span class="sxs-lookup"><span data-stu-id="d14cb-247">When a command is launched, the menu will be collapsed automatically but you must explicitly free the message hook.</span></span>

<span data-ttu-id="d14cb-248">下列程式碼範例會釋出先前範例中所設定的訊息掛勾。</span><span class="sxs-lookup"><span data-stu-id="d14cb-248">The following code example frees the message hook that was set in the previous example.</span></span>


```
UnhookWindowsHookEx(hhookMsg);
```



### <a name="mouse-navigation"></a><span data-ttu-id="d14cb-249">滑鼠導覽</span><span class="sxs-lookup"><span data-stu-id="d14cb-249">Mouse Navigation</span></span>

<span data-ttu-id="d14cb-250">當一般工具列控制項熱追蹤按鈕時，它會反白顯示 [使用中] 按鈕，並在每次啟用新按鈕時，傳送 [TBN \_ HOTITEMCHANGE](tbn-hotitemchange.md) 通知給應用程式。</span><span class="sxs-lookup"><span data-stu-id="d14cb-250">When a normal toolbar control hot-tracks buttons, it highlights the active button and sends the application a [TBN\_HOTITEMCHANGE](tbn-hotitemchange.md) notification each time a new button is activated.</span></span> <span data-ttu-id="d14cb-251">您的應用程式會負責顯示適當的下拉式功能表。</span><span class="sxs-lookup"><span data-stu-id="d14cb-251">Your application is responsible for displaying the appropriate drop-down menu.</span></span> <span data-ttu-id="d14cb-252">它必須：</span><span class="sxs-lookup"><span data-stu-id="d14cb-252">It must:</span></span>

-   <span data-ttu-id="d14cb-253">處理 [TBN \_ HOTITEMCHANGE](tbn-hotitemchange.md) 通知，以追蹤作用中的按鈕。</span><span class="sxs-lookup"><span data-stu-id="d14cb-253">Handle the [TBN\_HOTITEMCHANGE](tbn-hotitemchange.md) notification to keep track of the active button.</span></span> <span data-ttu-id="d14cb-254">當使用中的按鈕變更時，請折迭舊的功能表並建立新的功能表。</span><span class="sxs-lookup"><span data-stu-id="d14cb-254">When the active button changes, collapse the old menu and create a new one.</span></span>
-   <span data-ttu-id="d14cb-255">處理按一下按鈕時所傳送的 [TBN \_ 下拉式清單](tbn-dropdown.md) 通知。</span><span class="sxs-lookup"><span data-stu-id="d14cb-255">Handle the [TBN\_DROPDOWN](tbn-dropdown.md) notification that is sent when a button is clicked.</span></span> <span data-ttu-id="d14cb-256">接著，它會折迭功能表並停用功能表熱追蹤。</span><span class="sxs-lookup"><span data-stu-id="d14cb-256">It should then collapse the menu and disable menu hot-tracking.</span></span> <span data-ttu-id="d14cb-257">按鈕會保持作用中狀態。</span><span class="sxs-lookup"><span data-stu-id="d14cb-257">The button remains active.</span></span>
-   <span data-ttu-id="d14cb-258">處理訊息攔截程式中的 [**wm \_ LBUTTONDOWN**](/windows/desktop/inputdev/wm-lbuttondown)、 [**wm \_ RBUTTONDOWN**](/windows/desktop/inputdev/wm-rbuttondown)和 [**wm \_ MOUSEMOVE**](/windows/desktop/inputdev/wm-mousemove) 訊息，以追蹤滑鼠位置。</span><span class="sxs-lookup"><span data-stu-id="d14cb-258">Handle the [**WM\_LBUTTONDOWN**](/windows/desktop/inputdev/wm-lbuttondown), [**WM\_RBUTTONDOWN**](/windows/desktop/inputdev/wm-rbuttondown), and [**WM\_MOUSEMOVE**](/windows/desktop/inputdev/wm-mousemove) messages in your message hook procedure, to keep track of the mouse position.</span></span> <span data-ttu-id="d14cb-259">如果按一下功能表區域以外的滑鼠，請折迭目前的下拉式功能表、停用功能表熱追蹤，然後將功能表列返回其 preactivation 狀態。</span><span class="sxs-lookup"><span data-stu-id="d14cb-259">If the mouse is clicked outside the menu area, collapse the current drop-down menu, deactivate menu hot-tracking, and return the menu bar to its preactivation state.</span></span>
-   <span data-ttu-id="d14cb-260">啟動功能表命令時，請停用功能表熱追蹤。</span><span class="sxs-lookup"><span data-stu-id="d14cb-260">When a menu command is launched, disable menu hot-tracking.</span></span> <span data-ttu-id="d14cb-261">此功能表會自動折迭，但您必須明確釋放訊息掛勾。</span><span class="sxs-lookup"><span data-stu-id="d14cb-261">The menu will be collapsed automatically but you must explicitly free the message hook.</span></span>

<span data-ttu-id="d14cb-262">您也必須處理與功能表相關的訊息，例如，當功能表項目需要顯示子功能表時，所傳送的 [**WM \_ INITMENUPOPUP**](/windows/desktop/menurc/wm-initmenupopup) 訊息。</span><span class="sxs-lookup"><span data-stu-id="d14cb-262">You must also handle menu-related messaging, such as the [**WM\_INITMENUPOPUP**](/windows/desktop/menurc/wm-initmenupopup) message that is sent when a menu item needs to display a submenu.</span></span> <span data-ttu-id="d14cb-263">如需如何處理這類訊息的討論，請參閱 [功能表](/windows/desktop/menurc/menus)。</span><span class="sxs-lookup"><span data-stu-id="d14cb-263">For a discussion of how to handle such messages, see [Menus](/windows/desktop/menurc/menus).</span></span>

### <a name="keyboard-navigation"></a><span data-ttu-id="d14cb-264">鍵盤導覽</span><span class="sxs-lookup"><span data-stu-id="d14cb-264">Keyboard Navigation</span></span>

<span data-ttu-id="d14cb-265">您的應用程式必須處理訊息攔截程式中的鍵盤訊息，並對影響功能表熱追蹤的程式採取行動。</span><span class="sxs-lookup"><span data-stu-id="d14cb-265">Your application must process keyboard messages in the message hook procedure and act on those that affect menu hot-tracking.</span></span> <span data-ttu-id="d14cb-266">必須處理下列按鍵：</span><span class="sxs-lookup"><span data-stu-id="d14cb-266">The following key presses must be handled:</span></span>

-   <span data-ttu-id="d14cb-267">ESCAPE 鍵。</span><span class="sxs-lookup"><span data-stu-id="d14cb-267">The ESCAPE key.</span></span> <span data-ttu-id="d14cb-268">ESCAPE 鍵可將顯示層級備份為一層。</span><span class="sxs-lookup"><span data-stu-id="d14cb-268">The ESCAPE key backs the display up one level.</span></span> <span data-ttu-id="d14cb-269">如果正在顯示子功能表，則必須折迭。</span><span class="sxs-lookup"><span data-stu-id="d14cb-269">If a submenu is being displayed, it must be collapsed.</span></span> <span data-ttu-id="d14cb-270">如果顯示按鈕的主要功能表，請將它折迭並停用功能表熱追蹤。</span><span class="sxs-lookup"><span data-stu-id="d14cb-270">If a button's primary menu is displayed, collapse it and disable menu hot-tracking.</span></span> <span data-ttu-id="d14cb-271">按鈕會保持作用中狀態。</span><span class="sxs-lookup"><span data-stu-id="d14cb-271">The button remains active.</span></span>
-   <span data-ttu-id="d14cb-272">向右鍵。</span><span class="sxs-lookup"><span data-stu-id="d14cb-272">The RIGHT ARROW key.</span></span> <span data-ttu-id="d14cb-273">如果專案有子功能表，則會顯示它。</span><span class="sxs-lookup"><span data-stu-id="d14cb-273">If the item has a submenu, display it.</span></span> <span data-ttu-id="d14cb-274">如果專案沒有子功能表，請折迭功能表和任何子功能表，以 [ [**TB] \_ SETHOTITEM**](tb-sethotitem.md)啟用 [下一步] 按鈕，並顯示其功能表。</span><span class="sxs-lookup"><span data-stu-id="d14cb-274">If the item does not have a submenu, collapse the menu and any submenus, activate the next button with [**TB\_SETHOTITEM**](tb-sethotitem.md), and display its menu.</span></span> <span data-ttu-id="d14cb-275">如果收到此通知時，最後一個按鈕是作用中，則會顯示第一個按鈕的功能表。</span><span class="sxs-lookup"><span data-stu-id="d14cb-275">If the last button was active when this notification was received, display the menu for the first button.</span></span>
-   <span data-ttu-id="d14cb-276">向左鍵。</span><span class="sxs-lookup"><span data-stu-id="d14cb-276">The LEFT ARROW key.</span></span> <span data-ttu-id="d14cb-277">如果專案在子功能表中，請折迭並將焦點移至其父功能表。</span><span class="sxs-lookup"><span data-stu-id="d14cb-277">If the item is in a submenu, collapse it and shift focus to its parent menu.</span></span> <span data-ttu-id="d14cb-278">如果專案不是子功能表，請折迭功能表，啟動具有 [TB] [**\_ SETHOTITEM**](tb-sethotitem.md)的相鄰按鈕，並顯示其功能表。</span><span class="sxs-lookup"><span data-stu-id="d14cb-278">If the item is not a submenu, collapse the menu, activate the adjacent button with [**TB\_SETHOTITEM**](tb-sethotitem.md), and display its menu.</span></span> <span data-ttu-id="d14cb-279">如果收到此通知時，第一個按鈕是作用中，則會顯示 [上一步] 按鈕的功能表。</span><span class="sxs-lookup"><span data-stu-id="d14cb-279">If the first button was active when this notification was received, display the menu for the last button.</span></span>
-   <span data-ttu-id="d14cb-280">向上鍵和向下鍵。</span><span class="sxs-lookup"><span data-stu-id="d14cb-280">The UP ARROW and DOWN ARROW keys.</span></span> <span data-ttu-id="d14cb-281">這些金鑰是用來在功能表內流覽，但不會直接影響功能表熱追蹤。</span><span class="sxs-lookup"><span data-stu-id="d14cb-281">These keys are used to navigate within a menu but do not directly affect menu hot-tracking.</span></span>
-   <span data-ttu-id="d14cb-282">ALT *鍵* 加速器鍵。</span><span class="sxs-lookup"><span data-stu-id="d14cb-282">An ALT-*Key* accelerator key.</span></span> <span data-ttu-id="d14cb-283">使用 [**TB \_ MAPACCELERATOR**](tb-mapaccelerator.md) 訊息來判斷索引 *鍵* 字元所對應的按鈕。</span><span class="sxs-lookup"><span data-stu-id="d14cb-283">Use the [**TB\_MAPACCELERATOR**](tb-mapaccelerator.md) message to determine which button the *Key* character corresponds to.</span></span> <span data-ttu-id="d14cb-284">如果它對應的按鈕與目前使用中的按鈕不同，請折迭目前的下拉式功能表，以 [ [**TB] \_ SETHOTITEM**](tb-sethotitem.md)啟動新按鈕，並顯示相鄰按鈕的功能表。</span><span class="sxs-lookup"><span data-stu-id="d14cb-284">If it corresponds to a different button than the currently active one, collapse the current drop-down menu, activate the new button with [**TB\_SETHOTITEM**](tb-sethotitem.md), and display the menu for the adjacent button.</span></span> <span data-ttu-id="d14cb-285">如果索引 *鍵字元* 對應到目前顯示的按鈕，請折迭下拉式功能表，並停用功能表熱追蹤。</span><span class="sxs-lookup"><span data-stu-id="d14cb-285">If the *Key character* corresponds to the currently displayed button, collapse the drop-down menu and disable menu hot-tracking.</span></span> <span data-ttu-id="d14cb-286">按鈕應該保持作用中狀態。</span><span class="sxs-lookup"><span data-stu-id="d14cb-286">The button should remain active.</span></span>

 

 