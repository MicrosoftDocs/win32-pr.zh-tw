---
title: 如何建立網際網路 Explorer-Style 工具列
description: Windows Internet Explorer 的主要使用者介面功能之一，就是工具列。 它不僅可讓使用者存取廣泛的功能，還可讓使用者根據個人喜好來自訂版面配置。
ms.assetid: d24969ec-4dea-44c6-b045-5611de8f1cce
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: d32228f941a7c7e1253884ab5d72368f66f25c7f
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/21/2020
ms.locfileid: "104093387"
---
# <a name="how-to-create-an-internet-explorer-style-toolbar"></a><span data-ttu-id="67b6d-104">如何建立網際網路 Explorer-Style 工具列</span><span class="sxs-lookup"><span data-stu-id="67b6d-104">How to Create an Internet Explorer-Style Toolbar</span></span>

<span data-ttu-id="67b6d-105">Windows Internet Explorer 的主要使用者介面功能之一，就是工具列。</span><span class="sxs-lookup"><span data-stu-id="67b6d-105">One of the key user interface features of Windows Internet Explorer is the toolbar.</span></span> <span data-ttu-id="67b6d-106">它不僅可讓使用者存取廣泛的功能，還可讓使用者根據個人喜好來自訂版面配置。</span><span class="sxs-lookup"><span data-stu-id="67b6d-106">It not only gives users access to a wide array of features, it also allows users to customize its layout according to their personal preferences.</span></span>

<span data-ttu-id="67b6d-107">下列螢幕擷取畫面顯示 Internet Explorer 的工具列，並強調一些重要功能。</span><span class="sxs-lookup"><span data-stu-id="67b6d-107">The following screen shot shows the Internet Explorer toolbar, and highlights some of the key features.</span></span>

![windows internet explorer 工具列的螢幕擷取畫面，其中包含8項功能的標籤](images/howto1a.jpg)

<span data-ttu-id="67b6d-109">此工具列基本上是由具有四個群組的 Rebar 控制項所組成：三個工具列和一個功能表列。</span><span class="sxs-lookup"><span data-stu-id="67b6d-109">This toolbar essentially consists of a rebar control with four bands: three toolbars and a menu bar.</span></span> <span data-ttu-id="67b6d-110">由於它是以通用控制項 API 來執行，因此開發人員可以建立具有任何或所有功能的工具列。</span><span class="sxs-lookup"><span data-stu-id="67b6d-110">Because it is implemented with the common controls API, developers can create toolbars with any or all of its features.</span></span> <span data-ttu-id="67b6d-111">本主題討論 Internet Explorer 工具列的基本功能，以及如何在您的應用程式中加以執行。</span><span class="sxs-lookup"><span data-stu-id="67b6d-111">This topic discusses the essential features of the Internet Explorer toolbar and how to implement them in your application.</span></span>

-   [<span data-ttu-id="67b6d-112">Rebar 控制項</span><span class="sxs-lookup"><span data-stu-id="67b6d-112">The Rebar Control</span></span>](#the-rebar-control)
    -   [<span data-ttu-id="67b6d-113">執行 Rebar 控制項</span><span class="sxs-lookup"><span data-stu-id="67b6d-113">Implementing the Rebar Control</span></span>](#implementing-the-rebar-control)
-   [<span data-ttu-id="67b6d-114">工具列</span><span class="sxs-lookup"><span data-stu-id="67b6d-114">The Toolbars</span></span>](#how-to-create-an-internet-explorer-style-toolbar)
    -   [<span data-ttu-id="67b6d-115">下拉按鈕</span><span class="sxs-lookup"><span data-stu-id="67b6d-115">Drop-down Buttons</span></span>](#drop-down-buttons)
    -   [<span data-ttu-id="67b6d-116">清單樣式按鈕</span><span class="sxs-lookup"><span data-stu-id="67b6d-116">List-Style Buttons</span></span>](#list-style-buttons)
    -   [<span data-ttu-id="67b6d-117">角括弧</span><span class="sxs-lookup"><span data-stu-id="67b6d-117">Chevrons</span></span>](#handling-chevrons)
    -   [<span data-ttu-id="67b6d-118">熱追蹤</span><span class="sxs-lookup"><span data-stu-id="67b6d-118">Hot-Tracking</span></span>](#hot-tracking)
-   [<span data-ttu-id="67b6d-119">相關主題</span><span class="sxs-lookup"><span data-stu-id="67b6d-119">Related topics</span></span>](#related-topics)

## <a name="the-rebar-control"></a><span data-ttu-id="67b6d-120">Rebar 控制項</span><span class="sxs-lookup"><span data-stu-id="67b6d-120">The Rebar Control</span></span>

<span data-ttu-id="67b6d-121">Internet Explorer 工具列的基礎結構是由 [Rebar 控制項](rebar-controls.md)提供。</span><span class="sxs-lookup"><span data-stu-id="67b6d-121">The underlying structure of the Internet Explorer toolbar is provided by a [rebar control](rebar-controls.md).</span></span> <span data-ttu-id="67b6d-122">此控制項可讓使用者自訂工具集合的相片順序。</span><span class="sxs-lookup"><span data-stu-id="67b6d-122">This control provides a way for users to customize the arrangement of a collection of tools.</span></span> <span data-ttu-id="67b6d-123">每個 Rebar 都包含一 *或多個* 群組，通常是長、包含子視窗的窄矩形，通常是工具列控制項。</span><span class="sxs-lookup"><span data-stu-id="67b6d-123">Each rebar contains one or more *bands*, which are typically long, narrow rectangles that contain a child window, commonly a toolbar control.</span></span>

<span data-ttu-id="67b6d-124">Rebar 控制項會在矩形區域中顯示其區段，通常是在視窗的頂端。</span><span class="sxs-lookup"><span data-stu-id="67b6d-124">The rebar control displays its bands in a rectangular area, typically at the top of the window.</span></span> <span data-ttu-id="67b6d-125">這個矩形會細分為一個或多個寬線的寬線。</span><span class="sxs-lookup"><span data-stu-id="67b6d-125">This rectangle is subdivided into one or more strips that are the height of a band.</span></span> <span data-ttu-id="67b6d-126">每個波段都可以位於不同的區域上，或多個群組可放置在相同的區域上。</span><span class="sxs-lookup"><span data-stu-id="67b6d-126">Each band can be on a separate strip, or multiple bands can be placed on the same strip.</span></span>

<span data-ttu-id="67b6d-127">Rebar 控制項為使用者提供兩種方式來排列其工具：</span><span class="sxs-lookup"><span data-stu-id="67b6d-127">A rebar control provides users with two ways to arrange their tools:</span></span>

-   <span data-ttu-id="67b6d-128">每個波段的左邊緣通常都有一個 *控制* 者。</span><span class="sxs-lookup"><span data-stu-id="67b6d-128">Each band usually has a *gripper* at its left edge.</span></span> <span data-ttu-id="67b6d-129">當單一區域的兩個或多個波段超過視窗寬度時，會使用 Grippers。</span><span class="sxs-lookup"><span data-stu-id="67b6d-129">Grippers are used when two or more bands on a single strip exceed the width of the window.</span></span> <span data-ttu-id="67b6d-130">藉由將移出手柄向左或向右拖曳，使用者可以控制要配置給每個波段的空間量。</span><span class="sxs-lookup"><span data-stu-id="67b6d-130">By dragging the gripper to the left or right, users can control how much space is allocated to each band.</span></span>
-   <span data-ttu-id="67b6d-131">使用者可以藉由拖放來移動 Rebar 顯示矩形內的條紋。</span><span class="sxs-lookup"><span data-stu-id="67b6d-131">Users can move the bands within the rebar's display rectangle by dragging and dropping.</span></span> <span data-ttu-id="67b6d-132">Rebar 控制項接著會變更顯示，以容納新的條紋相片順序。</span><span class="sxs-lookup"><span data-stu-id="67b6d-132">The rebar control then changes the display to accommodate the new arrangement of bands.</span></span> <span data-ttu-id="67b6d-133">如果從區域中移除所有的條紋，則 Rebar 的高度將會縮小，放大視圖區域。</span><span class="sxs-lookup"><span data-stu-id="67b6d-133">If all the bands are removed from a strip, the height of the rebar will be reduced, enlarging the viewing area.</span></span>

<span data-ttu-id="67b6d-134">應用程式可以視需要新增或移除區段。</span><span class="sxs-lookup"><span data-stu-id="67b6d-134">An application can add or remove bands as needed.</span></span> <span data-ttu-id="67b6d-135">一般情況下，應用程式可讓使用者透過 [View] 功能表或快捷方式功能表來選取要顯示的波段。</span><span class="sxs-lookup"><span data-stu-id="67b6d-135">Typically, applications enable users to select which bands they want to have displayed through the View menu or a shortcut menu.</span></span>

<span data-ttu-id="67b6d-136">如果帶狀線的組合寬度超過視窗的寬度，則 Rebar 控制項將視需要調整其寬度。</span><span class="sxs-lookup"><span data-stu-id="67b6d-136">If the combined width of the bands on a strip exceeds the width of the window, the rebar control will adjust their widths as needed.</span></span> <span data-ttu-id="67b6d-137">部分工具可能會涵蓋在連續的頻外。</span><span class="sxs-lookup"><span data-stu-id="67b6d-137">Some of the tools might be covered by the adjacent band.</span></span>

<span data-ttu-id="67b6d-138">[版本 5.80](common-control-versions.md) 的通用控制項提供了一種方式，讓使用者可以存取另一個範圍所涵蓋的工具。</span><span class="sxs-lookup"><span data-stu-id="67b6d-138">[Version 5.80](common-control-versions.md) of the common controls provides a way to make tools that have been covered by another band accessible to the user.</span></span> <span data-ttu-id="67b6d-139">如果您 \_ 在頻外 [**REBARBANDINFO**](/windows/win32/api/commctrl/ns-commctrl-rebarbandinfoa)結構的 **FSTYLE** 成員中設定 RBBS USECHEVRON 旗標，則會顯示已涵蓋的工具列的 *燕* 號。</span><span class="sxs-lookup"><span data-stu-id="67b6d-139">If you set the RBBS\_USECHEVRON flag in the **fStyle** member of the band's [**REBARBANDINFO**](/windows/win32/api/commctrl/ns-commctrl-rebarbandinfoa) structure, a *chevron* will be displayed for toolbars that have been covered.</span></span> <span data-ttu-id="67b6d-140">當使用者按一下箭號時，就會顯示功能表，讓他或她可以使用隱藏的工具。</span><span class="sxs-lookup"><span data-stu-id="67b6d-140">When a user clicks the chevron, a menu is displayed that allows him or her to use the hidden tools.</span></span> <span data-ttu-id="67b6d-141">下列來自 Microsoft Internet Explorer 6 的螢幕擷取畫面，會顯示在涵蓋標準工具列的一部分時所顯示的功能表。</span><span class="sxs-lookup"><span data-stu-id="67b6d-141">The following screen shot from Microsoft Internet Explorer 6 shows the menu that is displayed when part of the standard toolbar is covered.</span></span>

![顯示功能表的螢幕擷取畫面，其中按一下箭號按鈕](images/howto2.jpg)

<span data-ttu-id="67b6d-143">由於每個波段都包含一個控制項，因此您可以透過控制項的 API 提供額外的彈性。</span><span class="sxs-lookup"><span data-stu-id="67b6d-143">Since each band contains a control, you can provide additional flexibility through the control's API.</span></span> <span data-ttu-id="67b6d-144">例如，您可以執行工具列自訂，讓使用者加入、移動或移除工具欄上的按鈕。</span><span class="sxs-lookup"><span data-stu-id="67b6d-144">For example, you can implement toolbar customization to enable the user to add, move, or delete buttons on a toolbar.</span></span>

### <a name="implementing-the-rebar-control"></a><span data-ttu-id="67b6d-145">執行 Rebar 控制項</span><span class="sxs-lookup"><span data-stu-id="67b6d-145">Implementing the Rebar Control</span></span>

<span data-ttu-id="67b6d-146">Internet Explorer 工具列的大部分功能實際上都是在個別的區段中實作為。</span><span class="sxs-lookup"><span data-stu-id="67b6d-146">Most of the features of the Internet Explorer toolbar are actually implemented in the individual bands.</span></span> <span data-ttu-id="67b6d-147">Rebar 控制項本身的執行相當簡單，如下所示。</span><span class="sxs-lookup"><span data-stu-id="67b6d-147">The implementation of the rebar control itself is straightforward and is listed below.</span></span>

1.  <span data-ttu-id="67b6d-148">使用 [**CreateWindowEx**](/windows/desktop/api/winuser/nf-winuser-createwindowexa)建立 Rebar 控制項。</span><span class="sxs-lookup"><span data-stu-id="67b6d-148">Create the rebar control with [**CreateWindowEx**](/windows/desktop/api/winuser/nf-winuser-createwindowexa).</span></span> <span data-ttu-id="67b6d-149">將 *dwExStyle* 設定 [**為 WS \_ EX \_ 工具視窗**](/windows/desktop/winmsg/extended-window-styles) ，並將 *lpClassName* 設定為 [**REBARCLASSNAME**](common-control-window-classes.md)。</span><span class="sxs-lookup"><span data-stu-id="67b6d-149">Set *dwExStyle* to [**WS\_EX\_TOOLWINDOW**](/windows/desktop/winmsg/extended-window-styles) and *lpClassName* to [**REBARCLASSNAME**](common-control-window-classes.md).</span></span> <span data-ttu-id="67b6d-150">Internet Explorer 會使用下列視窗樣式：</span><span class="sxs-lookup"><span data-stu-id="67b6d-150">Internet Explorer uses the following window styles:</span></span>

    -   [<span data-ttu-id="67b6d-151">**RBS \_ BANDBORDERS**</span><span class="sxs-lookup"><span data-stu-id="67b6d-151">**RBS\_BANDBORDERS**</span></span>](rebar-control-styles.md)
    -   [<span data-ttu-id="67b6d-152">**RBS \_ DBLCLKTOGGLE**</span><span class="sxs-lookup"><span data-stu-id="67b6d-152">**RBS\_DBLCLKTOGGLE**</span></span>](rebar-control-styles.md)
    -   [<span data-ttu-id="67b6d-153">**RBS \_ REGISTERDROP**</span><span class="sxs-lookup"><span data-stu-id="67b6d-153">**RBS\_REGISTERDROP**</span></span>](rebar-control-styles.md)
    -   [<span data-ttu-id="67b6d-154">**RBS \_ VARHEIGHT**</span><span class="sxs-lookup"><span data-stu-id="67b6d-154">**RBS\_VARHEIGHT**</span></span>](rebar-control-styles.md)
    -   [<span data-ttu-id="67b6d-155">**CCS \_ NODIVIDER**</span><span class="sxs-lookup"><span data-stu-id="67b6d-155">**CCS\_NODIVIDER**</span></span>](common-control-styles.md)
    -   [<span data-ttu-id="67b6d-156">**CCS \_ NOPARENTALIGN**</span><span class="sxs-lookup"><span data-stu-id="67b6d-156">**CCS\_NOPARENTALIGN**</span></span>](common-control-styles.md)
    -   [<span data-ttu-id="67b6d-157">**WS \_ 框線**</span><span class="sxs-lookup"><span data-stu-id="67b6d-157">**WS\_BORDER**</span></span>](/windows/desktop/winmsg/window-styles)
    -   [<span data-ttu-id="67b6d-158">**WS \_ 子系**</span><span class="sxs-lookup"><span data-stu-id="67b6d-158">**WS\_CHILD**</span></span>](/windows/desktop/winmsg/window-styles)
    -   [<span data-ttu-id="67b6d-159">**WS \_ CLIPCHILDREN**</span><span class="sxs-lookup"><span data-stu-id="67b6d-159">**WS\_CLIPCHILDREN**</span></span>](/windows/desktop/winmsg/window-styles)
    -   [<span data-ttu-id="67b6d-160">**WS \_ CLIPSIBLINGS**</span><span class="sxs-lookup"><span data-stu-id="67b6d-160">**WS\_CLIPSIBLINGS**</span></span>](/windows/desktop/winmsg/window-styles)
    -   [<span data-ttu-id="67b6d-161">**WS \_ 可見**</span><span class="sxs-lookup"><span data-stu-id="67b6d-161">**WS\_VISIBLE**</span></span>](/windows/desktop/winmsg/window-styles)

    <span data-ttu-id="67b6d-162">設定適用于您應用程式的其他參數。</span><span class="sxs-lookup"><span data-stu-id="67b6d-162">Set the other parameters as appropriate for your application.</span></span>

2.  <span data-ttu-id="67b6d-163">使用 [**CreateWindowEx**](/windows/desktop/api/winuser/nf-winuser-createwindowexa) 或特製化控制項建立功能（例如 [**CreateToolbarEx**](/windows/desktop/api/Commctrl/nf-commctrl-createtoolbarex)）來建立控制項。</span><span class="sxs-lookup"><span data-stu-id="67b6d-163">Create a control with [**CreateWindowEx**](/windows/desktop/api/winuser/nf-winuser-createwindowexa) or a specialized control creation function such as [**CreateToolbarEx**](/windows/desktop/api/Commctrl/nf-commctrl-createtoolbarex).</span></span>
3.  <span data-ttu-id="67b6d-164">填入 [**REBARBANDINFO**](/windows/win32/api/commctrl/ns-commctrl-rebarbandinfoa)的成員，以初始化控制項的頻外。</span><span class="sxs-lookup"><span data-stu-id="67b6d-164">Initialize a band for the control by filling in the members of [**REBARBANDINFO**](/windows/win32/api/commctrl/ns-commctrl-rebarbandinfoa).</span></span> <span data-ttu-id="67b6d-165">包含 RBBS \_ USECHEVRON 樣式與 **fStyle** 成員，以啟用燕形。</span><span class="sxs-lookup"><span data-stu-id="67b6d-165">Include the RBBS\_USECHEVRON style with the **fStyle** member to enable chevrons.</span></span>
4.  <span data-ttu-id="67b6d-166">使用 [**RB \_ INSERTBAND**](rb-insertband.md) 訊息，將頻外新增至 Rebar 控制項。</span><span class="sxs-lookup"><span data-stu-id="67b6d-166">Add the band to the rebar control with an [**RB\_INSERTBAND**](rb-insertband.md) message.</span></span>
5.  <span data-ttu-id="67b6d-167">針對其餘的區段重複步驟2-4。</span><span class="sxs-lookup"><span data-stu-id="67b6d-167">Repeat steps 2-4 for the remaining bands.</span></span>
6.  <span data-ttu-id="67b6d-168">執行 Rebar 通知的處理常式。</span><span class="sxs-lookup"><span data-stu-id="67b6d-168">Implement handlers for the rebar notifications.</span></span> <span data-ttu-id="67b6d-169">尤其是，您必須在按下箭號時，處理 [RBN \_ CHEVRONPUSHED](rbn-chevronpushed.md) ，以顯示下拉式功能表。</span><span class="sxs-lookup"><span data-stu-id="67b6d-169">In particular, you will need to handle [RBN\_CHEVRONPUSHED](rbn-chevronpushed.md) to display a drop-down menu when a chevron is clicked.</span></span> <span data-ttu-id="67b6d-170">如需詳細資訊，請參閱 [處理燕形](#handling-chevrons)。</span><span class="sxs-lookup"><span data-stu-id="67b6d-170">For further information, see [Handling Chevrons](#handling-chevrons).</span></span>

<span data-ttu-id="67b6d-171">預設會包含 grippers。</span><span class="sxs-lookup"><span data-stu-id="67b6d-171">The grippers are included by default.</span></span> <span data-ttu-id="67b6d-172">若要省略頻外的控制器，請 \_ 在波段 [**REBARBANDINFO**](/windows/win32/api/commctrl/ns-commctrl-rebarbandinfoa)結構的 **FSTYLE** 成員中設定 RBBS NOGRIPPER 旗標。</span><span class="sxs-lookup"><span data-stu-id="67b6d-172">To omit the gripper for a band, set the RBBS\_NOGRIPPER flag in the **fStyle** member of the band's [**REBARBANDINFO**](/windows/win32/api/commctrl/ns-commctrl-rebarbandinfoa) structure.</span></span> <span data-ttu-id="67b6d-173">如需有關實施 Rebar 控制項的詳細資訊，請參閱 [關於 Rebar 控制項](rebar-controls.md)。</span><span class="sxs-lookup"><span data-stu-id="67b6d-173">For further information on implementing rebar controls, see [About Rebar Controls](rebar-controls.md).</span></span>

### <a name="handling-chevrons"></a><span data-ttu-id="67b6d-174">處理燕尾</span><span class="sxs-lookup"><span data-stu-id="67b6d-174">Handling Chevrons</span></span>

<span data-ttu-id="67b6d-175">當使用者按一下箭號時，Rebar 控制項會傳送 [RBN \_ CHEVRONPUSHED](rbn-chevronpushed.md) 通知給您的應用程式。</span><span class="sxs-lookup"><span data-stu-id="67b6d-175">When a user clicks a chevron, the rebar control sends your application an [RBN\_CHEVRONPUSHED](rbn-chevronpushed.md) notification.</span></span> <span data-ttu-id="67b6d-176">與通知一起傳遞的 [**NMREBARCHEVRON**](/windows/win32/api/commctrl/ns-commctrl-nmrebarchevron)結構包含帶線的識別碼，以及帶有箭號所佔用之 [**矩形的矩形結構。**](/previous-versions//dd162897(v=vs.85))</span><span class="sxs-lookup"><span data-stu-id="67b6d-176">The [**NMREBARCHEVRON**](/windows/win32/api/commctrl/ns-commctrl-nmrebarchevron) structure that is passed with the notification contains the band's identifier and a [**RECT**](/previous-versions//dd162897(v=vs.85)) structure with the rectangle that is occupied by the chevron.</span></span> <span data-ttu-id="67b6d-177">您的處理常式必須判斷哪些按鈕是隱藏的，並在快顯功能表上顯示相關聯的命令。</span><span class="sxs-lookup"><span data-stu-id="67b6d-177">Your handler must determine which buttons are hidden and display the associated commands on a pop-up menu.</span></span>

<span data-ttu-id="67b6d-178">下列程式概述如何處理 [RBN \_ CHEVRONPUSHED](rbn-chevronpushed.md) 通知：</span><span class="sxs-lookup"><span data-stu-id="67b6d-178">The following procedure outlines how to handle an [RBN\_CHEVRONPUSHED](rbn-chevronpushed.md) notification:</span></span>

1.  <span data-ttu-id="67b6d-179">將 Rebar 控制項傳送至 [**RB \_ GETRECT**](rb-getrect.md) 訊息，以抓取所選範圍的目前周框。</span><span class="sxs-lookup"><span data-stu-id="67b6d-179">Retrieve the current bounding rectangle for the selected band by sending the rebar control an [**RB\_GETRECT**](rb-getrect.md) message.</span></span>
2.  <span data-ttu-id="67b6d-180">藉由將寬線的工具列控制項傳送至 [**TB 的 \_ BUTTONCOUNT**](tb-buttoncount.md) 訊息，以抓取按鈕的總數目。</span><span class="sxs-lookup"><span data-stu-id="67b6d-180">Retrieve the total number of buttons by sending the band's toolbar control a [**TB\_BUTTONCOUNT**](tb-buttoncount.md) message.</span></span>
3.  <span data-ttu-id="67b6d-181">從最左邊的按鈕開始，藉由將工具列控制項傳送至 [**TB 的 \_ GETITEMRECT**](tb-getitemrect.md) 訊息，來取出按鈕的周框。</span><span class="sxs-lookup"><span data-stu-id="67b6d-181">Starting from the leftmost button, retrieve the button's bounding rectangle by sending the toolbar control a [**TB\_GETITEMRECT**](tb-getitemrect.md) message.</span></span>
4.  <span data-ttu-id="67b6d-182">將頻外和按鈕矩形傳遞給 [**IntersectRect**](/windows/desktop/api/winuser/nf-winuser-intersectrect) 函數。</span><span class="sxs-lookup"><span data-stu-id="67b6d-182">Pass the band and button rectangles to the [**IntersectRect**](/windows/desktop/api/winuser/nf-winuser-intersectrect) function.</span></span> <span data-ttu-id="67b6d-183">此函式會傳回對應至按鈕可見部分的 [**矩形**](/previous-versions//dd162897(v=vs.85)) 結構。</span><span class="sxs-lookup"><span data-stu-id="67b6d-183">This function will return a [**RECT**](/previous-versions//dd162897(v=vs.85)) structure that corresponds to the visible portion of the button.</span></span>
5.  <span data-ttu-id="67b6d-184">將按鈕的可見部分的按鈕矩形和矩形傳遞給 [**EqualRect**](/windows/desktop/api/winuser/nf-winuser-equalrect) 函數。</span><span class="sxs-lookup"><span data-stu-id="67b6d-184">Pass the button rectangle and the rectangle for the visible portion of the button to the [**EqualRect**](/windows/desktop/api/winuser/nf-winuser-equalrect) function.</span></span>
6.  <span data-ttu-id="67b6d-185">如果 [**EqualRect**](/windows/desktop/api/winuser/nf-winuser-equalrect) 傳回 **TRUE**，則會顯示整個按鈕。</span><span class="sxs-lookup"><span data-stu-id="67b6d-185">If [**EqualRect**](/windows/desktop/api/winuser/nf-winuser-equalrect) returns **TRUE**, the entire button is visible.</span></span> <span data-ttu-id="67b6d-186">針對工具列上的 [下一步] 按鈕重複步驟3-5。</span><span class="sxs-lookup"><span data-stu-id="67b6d-186">Repeat steps 3-5 for the next button on the toolbar.</span></span> <span data-ttu-id="67b6d-187">如果 **EqualRect** 傳回 **FALSE**，則按鈕至少為部分隱藏，而且所有剩餘的按鈕都將完全隱藏。</span><span class="sxs-lookup"><span data-stu-id="67b6d-187">If **EqualRect** returns **FALSE**, the button is at least partially hidden and all remaining buttons will be completely hidden.</span></span> <span data-ttu-id="67b6d-188">繼續進行下一個步驟。</span><span class="sxs-lookup"><span data-stu-id="67b6d-188">Continue to the next step.</span></span>
7.  <span data-ttu-id="67b6d-189">建立快顯功能表，其中包含每個隱藏按鈕的專案。</span><span class="sxs-lookup"><span data-stu-id="67b6d-189">Create a pop-up menu with items for each of the hidden buttons.</span></span>
8.  <span data-ttu-id="67b6d-190">使用 [**trackpopupmenu 讓**](/windows/desktop/api/winuser/nf-winuser-trackpopupmenu) 函數來顯示快顯功能表。</span><span class="sxs-lookup"><span data-stu-id="67b6d-190">Display the pop-up menu by using the [**TrackPopupMenu**](/windows/desktop/api/winuser/nf-winuser-trackpopupmenu) function.</span></span> <span data-ttu-id="67b6d-191">使用以 [RBN \_ CHEVRONPUSHED](rbn-chevronpushed.md) 通知傳遞的燕形矩形來定位功能表。</span><span class="sxs-lookup"><span data-stu-id="67b6d-191">Use the chevron rectangle that was passed with the [RBN\_CHEVRONPUSHED](rbn-chevronpushed.md) notification to position the menu.</span></span> <span data-ttu-id="67b6d-192">功能表應該緊接在箭號正下方，且左邊緣對齊。</span><span class="sxs-lookup"><span data-stu-id="67b6d-192">The menu should be immediately below the chevron, with the left edges aligned.</span></span>
9.  <span data-ttu-id="67b6d-193">處理功能表命令。</span><span class="sxs-lookup"><span data-stu-id="67b6d-193">Handle the menu commands.</span></span>

## <a name="the-toolbars"></a><span data-ttu-id="67b6d-194">工具列</span><span class="sxs-lookup"><span data-stu-id="67b6d-194">The Toolbars</span></span>

<span data-ttu-id="67b6d-195">Internet Explorer 工具列的大部分複雜性都是在組成 Rebar 群組的控制項中執行。</span><span class="sxs-lookup"><span data-stu-id="67b6d-195">Most of the complexity of the Internet Explorer toolbar lies in the implementation of controls that make up the rebar bands.</span></span> <span data-ttu-id="67b6d-196">Internet Explorer 通常會顯示四個區段：</span><span class="sxs-lookup"><span data-stu-id="67b6d-196">Internet Explorer commonly displays four bands:</span></span>

-   <span data-ttu-id="67b6d-197">功能表列</span><span class="sxs-lookup"><span data-stu-id="67b6d-197">The menu bar</span></span>
-   <span data-ttu-id="67b6d-198">標準工具列</span><span class="sxs-lookup"><span data-stu-id="67b6d-198">The standard toolbar</span></span>
-   <span data-ttu-id="67b6d-199">連結工具列</span><span class="sxs-lookup"><span data-stu-id="67b6d-199">The links toolbar</span></span>
-   <span data-ttu-id="67b6d-200">位址工具列</span><span class="sxs-lookup"><span data-stu-id="67b6d-200">The address toolbar</span></span>

<span data-ttu-id="67b6d-201">所有這些等量（包括功能表列）實際上都會保存工具列控制項。</span><span class="sxs-lookup"><span data-stu-id="67b6d-201">All of these bands, including the menu bar, actually hold toolbar controls.</span></span> <span data-ttu-id="67b6d-202">本節討論標準和連結工具列的執行。</span><span class="sxs-lookup"><span data-stu-id="67b6d-202">This section discusses the implementation of the standard and links toolbars.</span></span> <span data-ttu-id="67b6d-203">功能表列稍微複雜一點，在 [如何建立網際網路 Explorer-Style 功能表列](cc-faq-iemenubar.md)中也會分別討論。</span><span class="sxs-lookup"><span data-stu-id="67b6d-203">The menu bar is somewhat more complicated and is discussed separately in [How to Create an Internet Explorer-Style Menu Bar](cc-faq-iemenubar.md).</span></span>

<span data-ttu-id="67b6d-204">[關於] 工具列 [控制項](toolbar-controls-overview.md)中會討論執行工具列控制項的基本程式。</span><span class="sxs-lookup"><span data-stu-id="67b6d-204">The basic procedures for implementing toolbar controls are discussed in [About Toolbar Controls](toolbar-controls-overview.md).</span></span> <span data-ttu-id="67b6d-205">本節著重于 Internet Explorer 用來提高控制項可用性的一些較新工具列功能。</span><span class="sxs-lookup"><span data-stu-id="67b6d-205">This section focuses on some of the newer toolbar features that are used by Internet Explorer to increase the usability of the control.</span></span>

-   [<span data-ttu-id="67b6d-206">下拉按鈕</span><span class="sxs-lookup"><span data-stu-id="67b6d-206">Drop-down Buttons</span></span>](#drop-down-buttons)
-   [<span data-ttu-id="67b6d-207">清單樣式按鈕</span><span class="sxs-lookup"><span data-stu-id="67b6d-207">List-Style Buttons</span></span>](#list-style-buttons)
-   [<span data-ttu-id="67b6d-208">角括弧</span><span class="sxs-lookup"><span data-stu-id="67b6d-208">Chevrons</span></span>](#handling-chevrons)
-   [<span data-ttu-id="67b6d-209">熱追蹤</span><span class="sxs-lookup"><span data-stu-id="67b6d-209">Hot-Tracking</span></span>](#hot-tracking)

### <a name="drop-down-buttons"></a><span data-ttu-id="67b6d-210">下拉按鈕</span><span class="sxs-lookup"><span data-stu-id="67b6d-210">Drop-down Buttons</span></span>

<span data-ttu-id="67b6d-211">下拉式按鈕支援多個命令。</span><span class="sxs-lookup"><span data-stu-id="67b6d-211">Drop-down buttons support multiple commands.</span></span> <span data-ttu-id="67b6d-212">當使用者按一下下拉式按鈕時，按鈕會顯示快顯功能表，而不是啟動命令。</span><span class="sxs-lookup"><span data-stu-id="67b6d-212">When the user clicks a drop-down button, the button displays a pop-up menu instead of launching a command.</span></span> <span data-ttu-id="67b6d-213">使用者從功能表中選取命令來啟動命令。</span><span class="sxs-lookup"><span data-stu-id="67b6d-213">The user launches a command by selecting it from the menu.</span></span> <span data-ttu-id="67b6d-214">下列螢幕擷取畫面顯示 Internet Explorer 標準工具列中的下拉式按鈕和功能表。</span><span class="sxs-lookup"><span data-stu-id="67b6d-214">The following screen shot shows a drop-down button and menu from the Internet Explorer standard toolbar.</span></span>

![顯示郵件下拉式功能表的螢幕擷取畫面](images/howto3.jpg)

<span data-ttu-id="67b6d-216">您可以藉由將樣式旗標新增至按鈕 [**TBBUTTON**](/windows/desktop/api/Commctrl/ns-commctrl-tbbutton)結構的 **fStyle** 成員，將下拉式功能新增至任何按鈕樣式。</span><span class="sxs-lookup"><span data-stu-id="67b6d-216">Drop-down functionality can be added to any button style by adding a style flag to the **fStyle** member of the button's [**TBBUTTON**](/windows/desktop/api/Commctrl/ns-commctrl-tbbutton) structure.</span></span> <span data-ttu-id="67b6d-217">下拉式按鈕有三種樣式，Internet Explorer 使用這些樣式：</span><span class="sxs-lookup"><span data-stu-id="67b6d-217">There are three styles of drop-down button, all of which are used by Internet Explorer:</span></span>

-   <span data-ttu-id="67b6d-218">純下拉式按鈕具有 [ [**BTNS] 下拉式 \_ 清單**](toolbar-control-and-button-styles.md) 樣式。</span><span class="sxs-lookup"><span data-stu-id="67b6d-218">Plain drop-down buttons have the [**BTNS\_DROPDOWN**](toolbar-control-and-button-styles.md) style.</span></span> <span data-ttu-id="67b6d-219">它們看起來像是一般按鈕，但是按一下時會顯示功能表，而不是啟動命令。</span><span class="sxs-lookup"><span data-stu-id="67b6d-219">They look like normal buttons, but they display a menu when clicked instead of launching a command.</span></span>
-   <span data-ttu-id="67b6d-220">簡單的下拉箭號按鈕具有 [**BTNS \_ WHOLEDROPDOWN**](toolbar-control-and-button-styles.md) 樣式。</span><span class="sxs-lookup"><span data-stu-id="67b6d-220">Simple drop-down arrow buttons have the [**BTNS\_WHOLEDROPDOWN**](toolbar-control-and-button-styles.md) style.</span></span> <span data-ttu-id="67b6d-221">它們旁邊會顯示按鈕影像或文字旁邊的箭號。</span><span class="sxs-lookup"><span data-stu-id="67b6d-221">They have an arrow displayed next to the button image or text.</span></span> <span data-ttu-id="67b6d-222">除了外觀的差異以外，它們與一般下拉按鈕相同。</span><span class="sxs-lookup"><span data-stu-id="67b6d-222">Other than the difference in appearance, they are identical to plain drop-down buttons.</span></span> <span data-ttu-id="67b6d-223">在上圖中當做範例使用的 [郵件] 按鈕是下拉箭號按鈕。</span><span class="sxs-lookup"><span data-stu-id="67b6d-223">The Mail button used as the example in the preceding illustration is a drop-down arrow button.</span></span>
-   <span data-ttu-id="67b6d-224">將 [**TBSTYLE \_ EX \_ DRAWDDARROWS**](toolbar-extended-styles.md) 擴充樣式新增至 [**BTNS \_ 下拉式清單**](toolbar-control-and-button-styles.md) 的下拉箭號按鈕，具有與文字或影像分開的箭號。</span><span class="sxs-lookup"><span data-stu-id="67b6d-224">Drop-down arrow buttons that add the [**TBSTYLE\_EX\_DRAWDDARROWS**](toolbar-extended-styles.md) extended style to [**BTNS\_DROPDOWN**](toolbar-control-and-button-styles.md) have an arrow that is separated from the text or image.</span></span> <span data-ttu-id="67b6d-225">此按鈕樣式結合下拉式清單和標準按鈕的功能。</span><span class="sxs-lookup"><span data-stu-id="67b6d-225">This button style combines the functionality of drop-down and standard buttons.</span></span> <span data-ttu-id="67b6d-226">如果使用者按一下箭號，就會顯示功能表，而使用者可以從數個命令中選擇。</span><span class="sxs-lookup"><span data-stu-id="67b6d-226">If the user clicks the arrow, a menu is displayed and the user can choose from several commands.</span></span> <span data-ttu-id="67b6d-227">如果使用者按一下連續的按鈕，就會啟動預設命令。</span><span class="sxs-lookup"><span data-stu-id="67b6d-227">If the user clicks the adjacent button, it launches a default command.</span></span> <span data-ttu-id="67b6d-228">下列螢幕擷取畫面顯示 Internet Explorer 的 [ **上一頁** ] 按鈕，其使用分隔箭號。</span><span class="sxs-lookup"><span data-stu-id="67b6d-228">The following screen shot shows the Internet Explorer **Back** button, which uses a separated arrow.</span></span>

    ![顯示 [上一頁] 分割按鈕功能表的螢幕擷取畫面](images/howto4.jpg)

<span data-ttu-id="67b6d-230">當使用者按一下具有一般或簡單箭號樣式的下拉式按鈕時，工具列控制項會傳送 TBN 的下拉式通知給您的 [應用 \_ ](tbn-dropdown.md) 程式。</span><span class="sxs-lookup"><span data-stu-id="67b6d-230">When the user clicks a drop-down button with either the plain or simple arrow styles, the toolbar control sends your application a [TBN\_DROPDOWN](tbn-dropdown.md) notification.</span></span> <span data-ttu-id="67b6d-231">當您的應用程式收到此訊息時，它會負責建立及顯示功能表，以及處理選取的命令。</span><span class="sxs-lookup"><span data-stu-id="67b6d-231">When your application receives this message, it is responsible for creating and displaying the menu, and for handling the selected command.</span></span>

<span data-ttu-id="67b6d-232">當使用者按一下分隔箭號時，工具列控制項會傳送 [TBN 的 \_ 下拉式](tbn-dropdown.md) 通知給您的應用程式。</span><span class="sxs-lookup"><span data-stu-id="67b6d-232">When the user clicks a separated arrow, the toolbar control sends your application a [TBN\_DROPDOWN](tbn-dropdown.md) notification.</span></span> <span data-ttu-id="67b6d-233">您的應用程式應該處理它的方式，與處理其他兩種類型的下拉按鈕相同。</span><span class="sxs-lookup"><span data-stu-id="67b6d-233">Your application should handle it the same way as it handles the other two types of drop-down buttons.</span></span> <span data-ttu-id="67b6d-234">如果使用者按一下 [main] 按鈕，您的應用程式會收到 [**WM \_ 命令**](/windows/desktop/menurc/wm-command) 訊息，其中包含按鈕的命令識別碼，就像是標準按鈕一樣。</span><span class="sxs-lookup"><span data-stu-id="67b6d-234">If the user clicks the main button, your application receives a [**WM\_COMMAND**](/windows/desktop/menurc/wm-command) message with the button's command ID, just as if it were a standard button.</span></span> <span data-ttu-id="67b6d-235">應用程式通常會在下拉式功能表中啟動 top 命令來回應，但您可以隨意地以任何適當的方式回應。</span><span class="sxs-lookup"><span data-stu-id="67b6d-235">Applications typically respond by launching the top command in the drop-down menu, but you are free to respond in any suitable way.</span></span>

### <a name="list-style-buttons"></a><span data-ttu-id="67b6d-236">List-Style 按鈕</span><span class="sxs-lookup"><span data-stu-id="67b6d-236">List-Style Buttons</span></span>

<span data-ttu-id="67b6d-237">使用標準按鈕時，如果您新增文字，則會顯示在點陣圖下方。</span><span class="sxs-lookup"><span data-stu-id="67b6d-237">With standard buttons, if you add text, it is displayed below the bitmap.</span></span> <span data-ttu-id="67b6d-238">下列螢幕擷取畫面顯示 [Internet Explorer **搜尋**] 和 [我的最愛 **]** 按鈕與標準按鈕文字。</span><span class="sxs-lookup"><span data-stu-id="67b6d-238">The following screen shot shows the Internet Explorer **Search** and **Favorites** buttons with standard button text.</span></span>

![顯示 [搜尋] 和 [我的最愛] 工具列與標準按鈕的螢幕擷取畫面](images/howto6.jpg)

<span data-ttu-id="67b6d-240">Microsoft Internet Explorer 5 和更新版本會使用 [**TBSTYLE \_ 清單**](toolbar-control-and-button-styles.md) 樣式。</span><span class="sxs-lookup"><span data-stu-id="67b6d-240">Microsoft Internet Explorer 5 and later versions use the [**TBSTYLE\_LIST**](toolbar-control-and-button-styles.md) style.</span></span> <span data-ttu-id="67b6d-241">文字位於點陣圖的右邊，減少按鈕的高度並放大觀看區域。</span><span class="sxs-lookup"><span data-stu-id="67b6d-241">The text is to the right of the bitmap, reducing the height of the button and enlarging the viewing region.</span></span> <span data-ttu-id="67b6d-242">下圖顯示 [Internet Explorer 6 **搜尋** **]** 和 [我的最愛] 按鈕與 **TBSTYLE \_ 清單** 樣式。</span><span class="sxs-lookup"><span data-stu-id="67b6d-242">The following illustration shows the Internet Explorer 6 **Search** and **Favorites** buttons with the **TBSTYLE\_LIST** style.</span></span>

![顯示 [搜尋] 和 [我的最愛] 工具列使用清單樣式按鈕的螢幕擷取畫面](images/howto5.jpg)

### <a name="chevrons"></a><span data-ttu-id="67b6d-244">角括弧</span><span class="sxs-lookup"><span data-stu-id="67b6d-244">Chevrons</span></span>

<span data-ttu-id="67b6d-245">當使用者重新排列 Rebar 控制項中的條紋時，可能會涵蓋工具列的一部分。</span><span class="sxs-lookup"><span data-stu-id="67b6d-245">When the user rearranges the bands in the rebar control, part of a toolbar might be covered up.</span></span> <span data-ttu-id="67b6d-246">如果使用 RBBS \_ USECHEVRON 樣式來建立頻外，Rebar 控制項將會在工具列的右邊緣顯示箭號。</span><span class="sxs-lookup"><span data-stu-id="67b6d-246">If the band was created with the RBBS\_USECHEVRON style, the rebar control will display a chevron at the right edge of the toolbar.</span></span> <span data-ttu-id="67b6d-247">使用者按一下箭號可顯示具有隱藏工具的功能表。</span><span class="sxs-lookup"><span data-stu-id="67b6d-247">The user clicks the chevron to display a menu with the hidden tools.</span></span>

### <a name="hot-tracking"></a><span data-ttu-id="67b6d-248">Hot-Tracking</span><span class="sxs-lookup"><span data-stu-id="67b6d-248">Hot-Tracking</span></span>

<span data-ttu-id="67b6d-249">啟用熱追蹤時，當游標停留在按鈕上時，按鈕會變成 *熱* 。</span><span class="sxs-lookup"><span data-stu-id="67b6d-249">When hot-tracking is enabled, a button becomes *hot* when the cursor is over it.</span></span> <span data-ttu-id="67b6d-250">[經常性存取] 按鈕通常會與工具列上的其他按鈕（依特殊影像區別）。</span><span class="sxs-lookup"><span data-stu-id="67b6d-250">The hot button is normally distinguished from the other buttons on the toolbar by a distinctive image.</span></span> <span data-ttu-id="67b6d-251">根據預設，作用中按鈕會出現在工具列的其餘部分上方。</span><span class="sxs-lookup"><span data-stu-id="67b6d-251">By default, a hot button appears to be raised above the rest of the toolbar.</span></span> <span data-ttu-id="67b6d-252">當新按鈕變得熱時，您的應用程式會收到 [TBN \_ HOTITEMCHANGE](tbn-hotitemchange.md) 通知。</span><span class="sxs-lookup"><span data-stu-id="67b6d-252">When a new button becomes hot, your application receives a [TBN\_HOTITEMCHANGE](tbn-hotitemchange.md) notification.</span></span> <span data-ttu-id="67b6d-253">下圖顯示 [Internet Explorer 5 **搜尋**] 和 [我的最愛] 按鈕，以及 [熱 **搜尋** **]** 按鈕。</span><span class="sxs-lookup"><span data-stu-id="67b6d-253">The following illustration shows the Internet Explorer 5 **Search** and **Favorites** buttons, with a hot **Search** button.</span></span> <span data-ttu-id="67b6d-254">除了具有引發的外觀之外，按鈕的灰色點陣圖也已被彩色的點陣圖取代。</span><span class="sxs-lookup"><span data-stu-id="67b6d-254">In addition to having a raised appearance, the button's gray bitmap has been replaced with a colored one.</span></span>

![顯示 [搜尋] 和 [我的最愛] 按鈕的螢幕擷取畫面，其中包含熱搜尋按鈕](images/howto7.jpg)

<span data-ttu-id="67b6d-256">若要啟用熱追蹤，請使用 [**TBSTYLE 的 \_ 平面**](toolbar-control-and-button-styles.md) 或 [**TBSTYLE \_ 清單**](toolbar-control-and-button-styles.md) 樣式建立工具列控制項。</span><span class="sxs-lookup"><span data-stu-id="67b6d-256">To enable hot-tracking, create a toolbar control with either the [**TBSTYLE\_FLAT**](toolbar-control-and-button-styles.md) or [**TBSTYLE\_LIST**](toolbar-control-and-button-styles.md) style.</span></span> <span data-ttu-id="67b6d-257">這些 *稱為一般工具列，* 因為個別按鈕通常不會以任何方式反白顯示。</span><span class="sxs-lookup"><span data-stu-id="67b6d-257">These are referred to as *flat* toolbars because the individual buttons are not ordinarily highlighted in any way.</span></span> <span data-ttu-id="67b6d-258">點陣圖只會顯示在旁邊。</span><span class="sxs-lookup"><span data-stu-id="67b6d-258">The bitmaps are simply displayed next to each other.</span></span> <span data-ttu-id="67b6d-259">他們只會在熱時採用類似按鈕的外觀。</span><span class="sxs-lookup"><span data-stu-id="67b6d-259">They take on a button-like appearance only when they are hot.</span></span> <span data-ttu-id="67b6d-260">這兩種樣式也是透明的，這表示圖示的背景會是基礎用戶端視窗的色彩。</span><span class="sxs-lookup"><span data-stu-id="67b6d-260">These two styles are also transparent, which means that the background of the icons will be the color of the underlying client window.</span></span>

<span data-ttu-id="67b6d-261">若要在按鈕作用時顯示不同的點陣圖，請建立第二個 [影像清單](image-lists.md) ，其中包含工具列上所有按鈕的熱影像。</span><span class="sxs-lookup"><span data-stu-id="67b6d-261">To have a different bitmap displayed when the button is hot, create a second [image list](image-lists.md) that contains hot images for all the buttons on the toolbar.</span></span> <span data-ttu-id="67b6d-262">這些影像的大小和順序應該與預設影像清單中的相同。</span><span class="sxs-lookup"><span data-stu-id="67b6d-262">The size and order of these images should be the same as in the default image list.</span></span> <span data-ttu-id="67b6d-263">將 [**\_ SETHOTIMAGELIST**](tb-sethotimagelist.md) 訊息傳送至工具列控制項，以設定熱影像清單。</span><span class="sxs-lookup"><span data-stu-id="67b6d-263">Send the toolbar control a [**TB\_SETHOTIMAGELIST**](tb-sethotimagelist.md) message to set the hot image list.</span></span>

## <a name="related-topics"></a><span data-ttu-id="67b6d-264">相關主題</span><span class="sxs-lookup"><span data-stu-id="67b6d-264">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="67b6d-265">如何建立網際網路 Explorer-Style 功能表列</span><span class="sxs-lookup"><span data-stu-id="67b6d-265">How to Create an Internet Explorer-Style Menu Bar</span></span>](cc-faq-iemenubar.md)
</dt> </dl>

 

 