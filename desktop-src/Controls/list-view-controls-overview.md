---
title: 關於 List-View 控制項
description: 清單視圖控制項是顯示專案集合的視窗。
ms.assetid: 163f7778-690c-4166-b0c5-c7be1a03ae98
ms.topic: article
ms.date: 05/31/2018
ms.custom: project-verbatim
ms.openlocfilehash: fe1b953bf7d7204a3afffcfa0bc5aa5af9bf94fa
ms.sourcegitcommit: af120ad5c30da2fc5eb717ca2a1c4c45878efd71
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 03/20/2021
ms.locfileid: "106992360"
---
# <a name="about-list-view-controls"></a><span data-ttu-id="359b1-103">關於 List-View 控制項</span><span class="sxs-lookup"><span data-stu-id="359b1-103">About List-View Controls</span></span>

<span data-ttu-id="359b1-104">請參閱 [虛擬 listview 控制項範例](https://github.com/microsoft/Windows-classic-samples/tree/master/Samples/Win7Samples/winui/controls/common/vlistvw)。</span><span class="sxs-lookup"><span data-stu-id="359b1-104">See the [Virtual listview control sample](https://github.com/microsoft/Windows-classic-samples/tree/master/Samples/Win7Samples/winui/controls/common/vlistvw).</span></span>

<span data-ttu-id="359b1-105">清單視圖控制項是顯示專案集合的視窗。</span><span class="sxs-lookup"><span data-stu-id="359b1-105">A list-view control is a window that displays a collection of items.</span></span> <span data-ttu-id="359b1-106">清單視圖控制項提供數種方式來排列和顯示專案，而且比簡單 [清單方塊](list-boxes.md)更有彈性。</span><span class="sxs-lookup"><span data-stu-id="359b1-106">List-view controls provide several ways to arrange and display items and are much more flexible than simple [List Boxes](list-boxes.md).</span></span> <span data-ttu-id="359b1-107">例如，每個專案的其他相關資訊可以顯示在圖示和標籤右邊的資料行中。</span><span class="sxs-lookup"><span data-stu-id="359b1-107">For example, additional information about each item can be displayed in columns to the right of the icon and label.</span></span>

-   [<span data-ttu-id="359b1-108">清單-視圖樣式和視圖</span><span class="sxs-lookup"><span data-stu-id="359b1-108">List-View Styles and Views</span></span>](#list-view-styles-and-views)
    -   [<span data-ttu-id="359b1-109">擴充的 List-View 樣式</span><span class="sxs-lookup"><span data-stu-id="359b1-109">Extended List-View Styles</span></span>](#extended-list-view-styles)
-   [<span data-ttu-id="359b1-110">虛擬 List-View 樣式</span><span class="sxs-lookup"><span data-stu-id="359b1-110">Virtual List-View Style</span></span>](#virtual-list-view-style)
    -   [<span data-ttu-id="359b1-111">建立虛擬 List-View 控制項</span><span class="sxs-lookup"><span data-stu-id="359b1-111">Creating a Virtual List-View Control</span></span>](#creating-a-virtual-list-view-control)
    -   [<span data-ttu-id="359b1-112">相容性問題</span><span class="sxs-lookup"><span data-stu-id="359b1-112">Compatibility Issues</span></span>](#compatibility-issues)
    -   [<span data-ttu-id="359b1-113">處理虛擬 List-View 控制通知碼</span><span class="sxs-lookup"><span data-stu-id="359b1-113">Handling Virtual List-View Control Notification Codes</span></span>](#handling-virtual-list-view-control-notification-codes)
    -   [<span data-ttu-id="359b1-114">快取管理</span><span class="sxs-lookup"><span data-stu-id="359b1-114">Cache Management</span></span>](#cache-management)
-   [<span data-ttu-id="359b1-115">清單-查看工作區</span><span class="sxs-lookup"><span data-stu-id="359b1-115">List-View Working Areas</span></span>](#list-view-working-areas)
-   [<span data-ttu-id="359b1-116">清單視圖影像清單</span><span class="sxs-lookup"><span data-stu-id="359b1-116">List-View Image Lists</span></span>](#list-view-image-lists)
-   [<span data-ttu-id="359b1-117">清單視圖專案和子專案</span><span class="sxs-lookup"><span data-stu-id="359b1-117">List-View Items and Subitems</span></span>](#list-view-items-and-subitems)
    -   [<span data-ttu-id="359b1-118">清單視圖專案狀態</span><span class="sxs-lookup"><span data-stu-id="359b1-118">List-View Item States</span></span>](#list-view-item-states)
    -   [<span data-ttu-id="359b1-119">回呼專案和回呼遮罩</span><span class="sxs-lookup"><span data-stu-id="359b1-119">Callback Items and the Callback Mask</span></span>](#callback-items-and-the-callback-mask)
    -   [<span data-ttu-id="359b1-120">清單視圖專案位置</span><span class="sxs-lookup"><span data-stu-id="359b1-120">List-View Item Position</span></span>](#list-view-item-position)
    -   [<span data-ttu-id="359b1-121">排列、排序和尋找專案</span><span class="sxs-lookup"><span data-stu-id="359b1-121">Arranging, Sorting, and Finding Items</span></span>](#arranging-sorting-and-finding-items)
-   [<span data-ttu-id="359b1-122">清單-視圖資料行</span><span class="sxs-lookup"><span data-stu-id="359b1-122">List-View Columns</span></span>](#list-view-columns)
-   [<span data-ttu-id="359b1-123">清單視圖捲軸位置</span><span class="sxs-lookup"><span data-stu-id="359b1-123">List-View Scroll Position</span></span>](#list-view-scroll-position)
-   [<span data-ttu-id="359b1-124">清單-查看標籤編輯</span><span class="sxs-lookup"><span data-stu-id="359b1-124">List-View Label Editing</span></span>](#list-view-label-editing)
-   [<span data-ttu-id="359b1-125">清單視圖色彩</span><span class="sxs-lookup"><span data-stu-id="359b1-125">List-View Colors</span></span>](#list-view-colors)
-   [<span data-ttu-id="359b1-126">依群組排列清單專案</span><span class="sxs-lookup"><span data-stu-id="359b1-126">Arranging List Items by Group</span></span>](#arranging-list-items-by-group)
-   [<span data-ttu-id="359b1-127">插入標記</span><span class="sxs-lookup"><span data-stu-id="359b1-127">Insertion Marks</span></span>](#insertion-marks)

## <a name="list-view-styles-and-views"></a><span data-ttu-id="359b1-128">List-View 樣式和視圖</span><span class="sxs-lookup"><span data-stu-id="359b1-128">List-View Styles and Views</span></span>

<span data-ttu-id="359b1-129">清單視圖控制項可以在五個不同的視圖中顯示專案。</span><span class="sxs-lookup"><span data-stu-id="359b1-129">List-view controls can display items in five different views.</span></span> <span data-ttu-id="359b1-130">控制項的視窗樣式會指定預設視圖。</span><span class="sxs-lookup"><span data-stu-id="359b1-130">The control's window style specifies the default view.</span></span> <span data-ttu-id="359b1-131">額外的視窗樣式會指定專案與控制項特定功能的對齊方式。</span><span class="sxs-lookup"><span data-stu-id="359b1-131">Additional window styles specify the alignment of items and control-specific features.</span></span> <span data-ttu-id="359b1-132">下表描述這些視圖。</span><span class="sxs-lookup"><span data-stu-id="359b1-132">The following table describes the views.</span></span>



| <span data-ttu-id="359b1-133">檢視名稱</span><span class="sxs-lookup"><span data-stu-id="359b1-133">View Name</span></span>             | <span data-ttu-id="359b1-134">Description</span><span class="sxs-lookup"><span data-stu-id="359b1-134">Description</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|-----------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="359b1-135">圖示視圖</span><span class="sxs-lookup"><span data-stu-id="359b1-135">Icon view</span></span>             | <span data-ttu-id="359b1-136">由 [**lvs) \_ 圖示**](list-view-window-styles.md)視窗樣式或透過 [**LVM \_ SETVIEW**](lvm-setview.md)訊息傳遞 **LV \_ 視圖 \_ 圖示** 來指定。</span><span class="sxs-lookup"><span data-stu-id="359b1-136">Specified by the [**LVS\_ICON**](list-view-window-styles.md) window style or by passing **LV\_VIEW\_ICON** with the [**LVM\_SETVIEW**](lvm-setview.md) message.</span></span> <span data-ttu-id="359b1-137">每個項目顯示成下方附有標籤的全螢幕圖示。</span><span class="sxs-lookup"><span data-stu-id="359b1-137">Each item appears as a full-sized icon with a label below it.</span></span> <span data-ttu-id="359b1-138">使用者可以將專案拖曳到清單視圖視窗中的任何位置。</span><span class="sxs-lookup"><span data-stu-id="359b1-138">The user can drag the items to any location in the list-view window.</span></span>                                                                                                                                                                                                                                         |
| <span data-ttu-id="359b1-139">小圖示視圖</span><span class="sxs-lookup"><span data-stu-id="359b1-139">Small icon view</span></span>       | <span data-ttu-id="359b1-140">由 [**lvs) \_ SMALLICON**](list-view-window-styles.md)視窗樣式或藉由使用 [**LVM \_ SETVIEW**](lvm-setview.md)傳遞 **LV \_ VIEW \_ SMALLICON** 所指定。</span><span class="sxs-lookup"><span data-stu-id="359b1-140">Specified by the [**LVS\_SMALLICON**](list-view-window-styles.md) window style or by passing **LV\_VIEW\_SMALLICON** with [**LVM\_SETVIEW**](lvm-setview.md).</span></span> <span data-ttu-id="359b1-141">每個專案都會顯示為具有其右邊標籤的小圖示。</span><span class="sxs-lookup"><span data-stu-id="359b1-141">Each item appears as a small icon with the label to the right of it.</span></span> <span data-ttu-id="359b1-142">使用者可以將專案拖曳到任何位置。</span><span class="sxs-lookup"><span data-stu-id="359b1-142">The user can drag the items to any location.</span></span>                                                                                                                                                                                                                                                       |
| <span data-ttu-id="359b1-143">清單檢視</span><span class="sxs-lookup"><span data-stu-id="359b1-143">List view</span></span>             | <span data-ttu-id="359b1-144">由 [**lvs) \_ 清單**](list-view-window-styles.md)視窗樣式或藉由使用 [**LVM \_ SETVIEW**](lvm-setview.md)傳遞 **LV \_ 視圖 \_ 清單** 來指定。</span><span class="sxs-lookup"><span data-stu-id="359b1-144">Specified by the [**LVS\_LIST**](list-view-window-styles.md) window style or by passing **LV\_VIEW\_LIST** with [**LVM\_SETVIEW**](lvm-setview.md).</span></span> <span data-ttu-id="359b1-145">每個專案都會顯示為一個小圖示，並在其右邊加上標籤。</span><span class="sxs-lookup"><span data-stu-id="359b1-145">Each item appears as a small icon with a label to the right of it.</span></span> <span data-ttu-id="359b1-146">專案會排列在資料行中，且使用者無法將其拖曳至任意位置。</span><span class="sxs-lookup"><span data-stu-id="359b1-146">Items are arranged in columns and the user cannot drag them to an arbitrary location.</span></span>                                                                                                                                                                                                                               |
| <span data-ttu-id="359b1-147">報表 (詳細資料) 視圖</span><span class="sxs-lookup"><span data-stu-id="359b1-147">Report (details) view</span></span> | <span data-ttu-id="359b1-148">由 [**lvs) \_ 報表**](list-view-window-styles.md)視窗樣式指定，或透過 [**LVM \_ SETVIEW**](lvm-setview.md)傳遞 **LV \_ 視圖 \_ 詳細資料**。</span><span class="sxs-lookup"><span data-stu-id="359b1-148">Specified by the [**LVS\_REPORT**](list-view-window-styles.md) window style or by passing **LV\_VIEW\_DETAILS** with [**LVM\_SETVIEW**](lvm-setview.md).</span></span> <span data-ttu-id="359b1-149">每個專案都會出現在自己的行上，並將資訊排列在資料行中。</span><span class="sxs-lookup"><span data-stu-id="359b1-149">Each item appears on its own line, with information arranged in columns.</span></span> <span data-ttu-id="359b1-150">最左邊的資料行一律會靠左對齊，並包含小圖示和標籤。</span><span class="sxs-lookup"><span data-stu-id="359b1-150">The leftmost column is always left justified and contains the small icon and label.</span></span> <span data-ttu-id="359b1-151">後續的資料行包含應用程式所指定的子工作。</span><span class="sxs-lookup"><span data-stu-id="359b1-151">Subsequent columns contain subitems as specified by the application.</span></span> <span data-ttu-id="359b1-152">除非您同時指定 [**lvs) \_ NOCOLUMNHEADER**](list-view-window-styles.md) 視窗樣式，否則每個資料行都有一個標頭。</span><span class="sxs-lookup"><span data-stu-id="359b1-152">Each column has a header, unless you also specify the [**LVS\_NOCOLUMNHEADER**](list-view-window-styles.md) window style.</span></span> |
| <span data-ttu-id="359b1-153">並排顯示檢視</span><span class="sxs-lookup"><span data-stu-id="359b1-153">Tile View</span></span>             | <span data-ttu-id="359b1-154">**第6版和更新版本。**</span><span class="sxs-lookup"><span data-stu-id="359b1-154">**Version 6 and later.**</span></span> <span data-ttu-id="359b1-155">藉由使用 [**LVM \_ SETVIEW**](lvm-setview.md)傳遞 **LV \_ VIEW \_ 磚** 來指定。</span><span class="sxs-lookup"><span data-stu-id="359b1-155">Specified by passing **LV\_VIEW\_TILE** with [**LVM\_SETVIEW**](lvm-setview.md).</span></span> <span data-ttu-id="359b1-156">每個專案都會顯示為完整大小的圖示，其標籤旁邊有一或多行。</span><span class="sxs-lookup"><span data-stu-id="359b1-156">Each item appears as a full-sized icon with a label of one or more lines beside it.</span></span>                                                                                                                                                                                                                                                                                                                                                        |



 

<span data-ttu-id="359b1-157">下列螢幕擷取畫面使用 views 來顯示有關七個寵物的不同資訊量。</span><span class="sxs-lookup"><span data-stu-id="359b1-157">The following screen shots use views to show different amounts of information about each of seven pets.</span></span> <span data-ttu-id="359b1-158">這些視圖會示範資訊可能會出現在 Windows Vista 上的方式。</span><span class="sxs-lookup"><span data-stu-id="359b1-158">The views demonstrate how the information might appear on Windows Vista.</span></span> <span data-ttu-id="359b1-159">控制項的視覺化樣式已使用 [**SetWindowTheme**](/windows/desktop/api/Uxtheme/nf-uxtheme-setwindowtheme)設定為 "Explorer" 主題。</span><span class="sxs-lookup"><span data-stu-id="359b1-159">The visual styles for the control have been set to the "Explorer" theme by using [**SetWindowTheme**](/windows/desktop/api/Uxtheme/nf-uxtheme-setwindowtheme).</span></span>

<span data-ttu-id="359b1-160">下列螢幕擷取畫面顯示詳細資料檢視。</span><span class="sxs-lookup"><span data-stu-id="359b1-160">The following screen shot shows the details view.</span></span>

![顯示五個數據行和七個數據列資訊的螢幕擷取畫面](images/lv-detailsview.png)

<span data-ttu-id="359b1-162">下列螢幕擷取畫面顯示圖示視圖。</span><span class="sxs-lookup"><span data-stu-id="359b1-162">The following screen shot shows the icon view.</span></span>

![只顯示每個寵物名稱的螢幕擷取畫面，以及表示物種的圖示](images/lv-iconview.png)

<span data-ttu-id="359b1-164">下列螢幕擷取畫面顯示清單視圖。</span><span class="sxs-lookup"><span data-stu-id="359b1-164">The following screen shot shows the list view.</span></span>

![顯示每個寵物的螢幕擷取畫面，接下來是寵物名稱、知名和價格文字的大型圖示](images/lv-listview.png)

<span data-ttu-id="359b1-166">下列螢幕擷取畫面顯示圖格視圖。</span><span class="sxs-lookup"><span data-stu-id="359b1-166">The following screen shot shows the tile view.</span></span>

![並排顯示。](images/lv-tileview.png)

<span data-ttu-id="359b1-168">您可以在建立清單視圖控制項之後變更檢視類型。</span><span class="sxs-lookup"><span data-stu-id="359b1-168">You can change the view type after you create a list-view control.</span></span> <span data-ttu-id="359b1-169">若要取出並變更視窗樣式，請使用 [**GetWindowLong**](/windows/desktop/api/winuser/nf-winuser-getwindowlonga) 和 [**SetWindowLong**](/windows/desktop/api/winuser/nf-winuser-setwindowlonga) 函式。</span><span class="sxs-lookup"><span data-stu-id="359b1-169">To retrieve and change the window style, use the [**GetWindowLong**](/windows/desktop/api/winuser/nf-winuser-getwindowlonga) and [**SetWindowLong**](/windows/desktop/api/winuser/nf-winuser-setwindowlonga) functions.</span></span> <span data-ttu-id="359b1-170">若要判斷目前視圖的視窗樣式，請使用 [**lvs) \_ TYPEMASK**](list-view-window-styles.md) 值。</span><span class="sxs-lookup"><span data-stu-id="359b1-170">To determine the window styles of the current view, use the [**LVS\_TYPEMASK**](list-view-window-styles.md) value.</span></span>

<span data-ttu-id="359b1-171">您可以藉由指定 [**lvs) \_ ALIGNTOP**](list-view-window-styles.md) (預設) 或 [**lvs) \_ ALIGNLEFT**](list-view-window-styles.md) 視窗樣式，來控制專案在圖示或小型圖示視圖中的相片順序。</span><span class="sxs-lookup"><span data-stu-id="359b1-171">You can control the way items are arranged in icon or small icon view by specifying either the [**LVS\_ALIGNTOP**](list-view-window-styles.md) (default) or [**LVS\_ALIGNLEFT**](list-view-window-styles.md) window style.</span></span>

<span data-ttu-id="359b1-172">您可以在建立清單視圖控制項之後變更對齊。</span><span class="sxs-lookup"><span data-stu-id="359b1-172">You can change the alignment after you create a list-view control.</span></span> <span data-ttu-id="359b1-173">若要判斷目前的對齊，請使用 [**lvs) \_ ALIGNMASK**](list-view-window-styles.md) 值。</span><span class="sxs-lookup"><span data-stu-id="359b1-173">To determine the current alignment, use the [**LVS\_ALIGNMASK**](list-view-window-styles.md) value.</span></span>

<span data-ttu-id="359b1-174">其他視窗樣式提供其他選項，例如使用者是否可以編輯標籤，或一次選取一個以上的專案。</span><span class="sxs-lookup"><span data-stu-id="359b1-174">Additional window styles provide other options, such as whether a user can edit labels or select more than one item at a time.</span></span> <span data-ttu-id="359b1-175">如需完整清單，請參閱 [清單視圖視窗樣式](list-view-window-styles.md)。</span><span class="sxs-lookup"><span data-stu-id="359b1-175">For a complete list, see [List-View Window Styles](list-view-window-styles.md).</span></span>

### <a name="extended-list-view-styles"></a><span data-ttu-id="359b1-176">擴充的 List-View 樣式</span><span class="sxs-lookup"><span data-stu-id="359b1-176">Extended List-View Styles</span></span>

<span data-ttu-id="359b1-177">擴充清單視圖控制項樣式提供選項，例如核取方塊、平面捲軸、格線和熱追蹤。</span><span class="sxs-lookup"><span data-stu-id="359b1-177">The extended list-view control styles provide options such as check boxes, flat scroll bars, grid lines, and hot-tracking.</span></span> <span data-ttu-id="359b1-178">如需完整清單，請參閱 [擴充的 List-View 樣式](extended-list-view-styles.md)。</span><span class="sxs-lookup"><span data-stu-id="359b1-178">For a complete list, see [Extended List-View Styles](extended-list-view-styles.md).</span></span> <span data-ttu-id="359b1-179">您無法使用與標準視窗樣式相同的方式來存取擴充清單視圖樣式。</span><span class="sxs-lookup"><span data-stu-id="359b1-179">You do not access extended list-view styles in the same manner as standard window styles.</span></span> <span data-ttu-id="359b1-180">您不會使用 [**GetWindowLong**](/windows/desktop/api/winuser/nf-winuser-getwindowlonga) 和 [**SetWindowLong**](/windows/desktop/api/winuser/nf-winuser-setwindowlonga) 函數來進行擴充樣式變更。</span><span class="sxs-lookup"><span data-stu-id="359b1-180">You do not use the [**GetWindowLong**](/windows/desktop/api/winuser/nf-winuser-getwindowlonga) and [**SetWindowLong**](/windows/desktop/api/winuser/nf-winuser-setwindowlonga) functions to make extended style changes.</span></span>

<span data-ttu-id="359b1-181">有兩個訊息可設定和取出擴充樣式資訊， [**lvm \_ SETEXTENDEDLISTVIEWSTYLE**](lvm-setextendedlistviewstyle.md) 和 [**lvm \_ GETEXTENDEDLISTVIEWSTYLE**](lvm-getextendedlistviewstyle.md)。</span><span class="sxs-lookup"><span data-stu-id="359b1-181">There are two messages that set and retrieve extended style information, [**LVM\_SETEXTENDEDLISTVIEWSTYLE**](lvm-setextendedlistviewstyle.md) and [**LVM\_GETEXTENDEDLISTVIEWSTYLE**](lvm-getextendedlistviewstyle.md).</span></span> <span data-ttu-id="359b1-182">您可以使用下列對應的宏，而不是明確地傳送訊息： [**listview \_ SetExtendedListViewStyle**](/windows/desktop/api/Commctrl/nf-commctrl-listview_setextendedlistviewstyle)、 [**listview \_ SetExtendedListViewStyleEx**](/windows/desktop/api/Commctrl/nf-commctrl-listview_setextendedlistviewstyleex)和 [**listview \_ GetExtendedListViewStyle**](/windows/desktop/api/Commctrl/nf-commctrl-listview_getextendedlistviewstyle)。</span><span class="sxs-lookup"><span data-stu-id="359b1-182">Instead of sending the messages explicitly, you can use the following corresponding macros: [**ListView\_SetExtendedListViewStyle**](/windows/desktop/api/Commctrl/nf-commctrl-listview_setextendedlistviewstyle), [**ListView\_SetExtendedListViewStyleEx**](/windows/desktop/api/Commctrl/nf-commctrl-listview_setextendedlistviewstyleex), and [**ListView\_GetExtendedListViewStyle**](/windows/desktop/api/Commctrl/nf-commctrl-listview_getextendedlistviewstyle).</span></span>

## <a name="virtual-list-view-style"></a><span data-ttu-id="359b1-183">虛擬 List-View 樣式</span><span class="sxs-lookup"><span data-stu-id="359b1-183">Virtual List-View Style</span></span>

<span data-ttu-id="359b1-184">虛擬清單視圖是具有 [**lvs) \_ OWNERDATA**](list-view-window-styles.md) 樣式的清單視圖控制項。</span><span class="sxs-lookup"><span data-stu-id="359b1-184">A virtual list view is a list-view control that has the [**LVS\_OWNERDATA**](list-view-window-styles.md) style.</span></span> <span data-ttu-id="359b1-185">這種樣式可讓控制項處理數百萬個專案，因為擁有者會收到管理專案資料的負擔。</span><span class="sxs-lookup"><span data-stu-id="359b1-185">This style enables the control to handle millions of items because the owner receives the burden of managing item data.</span></span> <span data-ttu-id="359b1-186">這可讓您搭配使用虛擬清單-view 控制項與大型資料庫的資訊，其中已有特定的資料存取方法。</span><span class="sxs-lookup"><span data-stu-id="359b1-186">This allows you to use the virtual list-view control with large databases of information, where specific methods of data access are already in place.</span></span>

<span data-ttu-id="359b1-187">虛擬清單控制項會維持極少的專案資訊本身。</span><span class="sxs-lookup"><span data-stu-id="359b1-187">A virtual list-view control maintains very little item information itself.</span></span> <span data-ttu-id="359b1-188">除了專案選取和焦點資訊之外，控制項的擁有者必須管理所有專案資訊。</span><span class="sxs-lookup"><span data-stu-id="359b1-188">Except for the item selection and focus information, the owner of the control must manage all item information.</span></span> <span data-ttu-id="359b1-189">其他進程會使用 [LVN \_ GETDISPINFO](lvn-getdispinfo.md) 通知碼來要求擁有者的專案資訊。</span><span class="sxs-lookup"><span data-stu-id="359b1-189">Other processes request item information from the owner by using [LVN\_GETDISPINFO](lvn-getdispinfo.md) notification codes.</span></span>

<span data-ttu-id="359b1-190">因為這種類型的清單控制項適用于大型資料集，建議您快取要求的專案資料，以改善抓取效能。</span><span class="sxs-lookup"><span data-stu-id="359b1-190">Because this type of list control is intended for large data sets, it is recommended that you cache requested item data to improve retrieval performance.</span></span> <span data-ttu-id="359b1-191">清單視圖會提供快取提示機制，以協助優化快取。</span><span class="sxs-lookup"><span data-stu-id="359b1-191">The list view provides a cache-hinting mechanism to assist in optimizing the cache.</span></span> <span data-ttu-id="359b1-192">提示會以 [LVN \_ ODCACHEHINT](lvn-odcachehint.md) 通知碼的形式來執行。</span><span class="sxs-lookup"><span data-stu-id="359b1-192">The hint is implemented in the form of an [LVN\_ODCACHEHINT](lvn-odcachehint.md) notification code.</span></span>

### <a name="creating-a-virtual-list-view-control"></a><span data-ttu-id="359b1-193">建立虛擬 List-View 控制項</span><span class="sxs-lookup"><span data-stu-id="359b1-193">Creating a Virtual List-View Control</span></span>

<span data-ttu-id="359b1-194">您可以使用 [**CreateWindow**](/windows/desktop/api/winuser/nf-winuser-createwindowa) 或 [**CreateWindowEx**](/windows/desktop/api/winuser/nf-winuser-createwindowexa) 函式來建立虛擬清單-View 控制項，將 [**lvs) \_ OWNERDATA**](list-view-window-styles.md) 視窗樣式指定為 *dwStyle* 函數參數的一部分。</span><span class="sxs-lookup"><span data-stu-id="359b1-194">You create virtual list-view controls using the [**CreateWindow**](/windows/desktop/api/winuser/nf-winuser-createwindowa) or [**CreateWindowEx**](/windows/desktop/api/winuser/nf-winuser-createwindowexa) function, specifying the [**LVS\_OWNERDATA**](list-view-window-styles.md) window style as part of the *dwStyle* function parameter.</span></span> <span data-ttu-id="359b1-195">不支援在 **lvs) \_ OWNERDATA** 樣式之間動態切換。</span><span class="sxs-lookup"><span data-stu-id="359b1-195">Dynamically switching to and from the **LVS\_OWNERDATA** style is not supported.</span></span>

<span data-ttu-id="359b1-196">您可以使用 [**lvs) \_ OWNERDATA**](list-view-window-styles.md) 樣式搭配大部分的視窗樣式，但 [**lvs) \_ SORTASCENDING**](list-view-window-styles.md) 或 [**lvs) \_ SORTDESCENDING**](list-view-window-styles.md) 樣式除外。</span><span class="sxs-lookup"><span data-stu-id="359b1-196">You can use the [**LVS\_OWNERDATA**](list-view-window-styles.md) style in combination with most other window styles, except the [**LVS\_SORTASCENDING**](list-view-window-styles.md) or [**LVS\_SORTDESCENDING**](list-view-window-styles.md) style.</span></span> <span data-ttu-id="359b1-197">所有虛擬清單-view 控制項預設為 [**lvs) \_ AUTOARRANGE**](list-view-window-styles.md) 樣式。</span><span class="sxs-lookup"><span data-stu-id="359b1-197">All virtual list-view controls default to the [**LVS\_AUTOARRANGE**](list-view-window-styles.md) style.</span></span>

<span data-ttu-id="359b1-198">若要讓專案顯示在清單中，您必須先明確地或使用 [**ListView \_ SetItemCountEx**](/windows/desktop/api/Commctrl/nf-commctrl-listview_setitemcountex)宏傳送 [**LVM \_ SETITEMCOUNT**](lvm-setitemcount.md)訊息。</span><span class="sxs-lookup"><span data-stu-id="359b1-198">To enable items to be displayed in the list, you must first send the [**LVM\_SETITEMCOUNT**](lvm-setitemcount.md) message, either explicitly or by using the [**ListView\_SetItemCountEx**](/windows/desktop/api/Commctrl/nf-commctrl-listview_setitemcountex) macro.</span></span>

<span data-ttu-id="359b1-199">下列訊息在 [**lvs) \_ OWNERDATA**](list-view-window-styles.md) style 下不受支援： [**lvm \_ ENABLEGROUPVIEW**](lvm-enablegroupview.md)、 [**lvm \_ GETITEMTEXT**](lvm-getitemtext.md)、 [**lvm \_ SETTILEINFO**](lvm-settileinfo.md)和 [**lvm \_ MAPIDTOINDEX**](lvm-mapidtoindex.md)。</span><span class="sxs-lookup"><span data-stu-id="359b1-199">The following messages are not supported under the [**LVS\_OWNERDATA**](list-view-window-styles.md) style: [**LVM\_ENABLEGROUPVIEW**](lvm-enablegroupview.md), [**LVM\_GETITEMTEXT**](lvm-getitemtext.md), [**LVM\_SETTILEINFO**](lvm-settileinfo.md), and [**LVM\_MAPIDTOINDEX**](lvm-mapidtoindex.md).</span></span>

### <a name="compatibility-issues"></a><span data-ttu-id="359b1-200">相容性問題</span><span class="sxs-lookup"><span data-stu-id="359b1-200">Compatibility Issues</span></span>

<span data-ttu-id="359b1-201">所有四個清單視圖樣式（圖示、小圖示、清單和報表檢視）都支援 [**lvs) \_ OWNERDATA**](list-view-window-styles.md) 樣式。</span><span class="sxs-lookup"><span data-stu-id="359b1-201">All four of the list-view styles—icon, small icon, list, and report view—support the [**LVS\_OWNERDATA**](list-view-window-styles.md) style.</span></span> <span data-ttu-id="359b1-202">具有 **lvs) \_ OWNERDATA** 樣式的清單視圖控制項不會儲存任何專案特定資訊。</span><span class="sxs-lookup"><span data-stu-id="359b1-202">List-view controls that have the **LVS\_OWNERDATA** style do not store any item-specific information.</span></span> <span data-ttu-id="359b1-203">因此，您可以套用至專案的唯一有效專案狀態旗標，會 [**LVIS \_ 選取**](list-view-item-states.md) 並 [**LVIS \_ 焦點**](list-view-item-states.md)。</span><span class="sxs-lookup"><span data-stu-id="359b1-203">Therefore, the only valid item state flags that you can apply to an item are [**LVIS\_SELECTED**](list-view-item-states.md) and [**LVIS\_FOCUSED**](list-view-item-states.md).</span></span> <span data-ttu-id="359b1-204">不會儲存任何其他狀態資訊。</span><span class="sxs-lookup"><span data-stu-id="359b1-204">No other state information is stored.</span></span> <span data-ttu-id="359b1-205">尤其是，清單視圖控制項不會維護每個專案的狀態或重迭影像。</span><span class="sxs-lookup"><span data-stu-id="359b1-205">In particular, the list-view control does not maintain state or overlay images for each item.</span></span> <span data-ttu-id="359b1-206">不過，您可以讓清單視圖控制項透過將 [**LVM \_ SETCALLBACKMASK**](lvm-setcallbackmask.md) 訊息傳送給應用程式，以查詢這些映射。</span><span class="sxs-lookup"><span data-stu-id="359b1-206">However, you can have the list-view control query your application for these images by sending it an [**LVM\_SETCALLBACKMASK**](lvm-setcallbackmask.md) message.</span></span>

<span data-ttu-id="359b1-207">大部分的清單視圖控制訊息和相關宏都受到完整支援。</span><span class="sxs-lookup"><span data-stu-id="359b1-207">Most list-view control messages and the associated macros are fully supported.</span></span> <span data-ttu-id="359b1-208">但是，當您使用 [**lvs) \_ OWNERDATA**](list-view-window-styles.md) 樣式時，有些訊息有一些限制或不受支援。</span><span class="sxs-lookup"><span data-stu-id="359b1-208">However, some messages have limitations or are unsupported when you use the [**LVS\_OWNERDATA**](list-view-window-styles.md) style.</span></span> <span data-ttu-id="359b1-209">下表摘要列出受影響的訊息。</span><span class="sxs-lookup"><span data-stu-id="359b1-209">The following table summarizes the affected messages.</span></span>



| <span data-ttu-id="359b1-210">訊息</span><span class="sxs-lookup"><span data-stu-id="359b1-210">Message</span></span>                                             | <span data-ttu-id="359b1-211">限制</span><span class="sxs-lookup"><span data-stu-id="359b1-211">Limitation</span></span>                                                                                                                                                                                                                                                      |
|-----------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="359b1-212">**LVM \_ 排列**</span><span class="sxs-lookup"><span data-stu-id="359b1-212">**LVM\_ARRANGE**</span></span>](lvm-arrange.md)                 | <span data-ttu-id="359b1-213">不支援 **LVA \_ 網格** 線樣式。</span><span class="sxs-lookup"><span data-stu-id="359b1-213">Does not support the **LVA\_SNAPTOGRID** style.</span></span>                                                                                                                                                                                                                 |
| [<span data-ttu-id="359b1-214">**LVM \_ DELETEALLITEMS**</span><span class="sxs-lookup"><span data-stu-id="359b1-214">**LVM\_DELETEALLITEMS**</span></span>](lvm-deleteallitems.md)   | <span data-ttu-id="359b1-215">將專案計數設定為零，並清除所有內部選取變數，但不會實際刪除任何專案。</span><span class="sxs-lookup"><span data-stu-id="359b1-215">Sets the item count to zero and clears all internal selection variables, but it does not actually delete any items.</span></span> <span data-ttu-id="359b1-216">它會發出通知回撥。</span><span class="sxs-lookup"><span data-stu-id="359b1-216">It makes a notification callback.</span></span>                                                                                                           |
| [<span data-ttu-id="359b1-217">**LVM \_ DELETEITEM**</span><span class="sxs-lookup"><span data-stu-id="359b1-217">**LVM\_DELETEITEM**</span></span>](lvm-deleteitem.md)           | <span data-ttu-id="359b1-218">僅支援選取完整性，並不會實際刪除專案。</span><span class="sxs-lookup"><span data-stu-id="359b1-218">Is supported for selection integrity only and does not actually delete an item.</span></span>                                                                                                                                                                                 |
| [<span data-ttu-id="359b1-219">**LVM \_ GETITEMSTATE**</span><span class="sxs-lookup"><span data-stu-id="359b1-219">**LVM\_GETITEMSTATE**</span></span>](lvm-getitemstate.md)       | <span data-ttu-id="359b1-220">只傳回焦點和選取狀態 (亦即，清單視圖控制項所儲存的狀態) 。</span><span class="sxs-lookup"><span data-stu-id="359b1-220">Returns only focus and selection states (that is, those states stored by the list-view control).</span></span>                                                                                                                                                                |
| [<span data-ttu-id="359b1-221">**LVM \_ GETNEXTITEM**</span><span class="sxs-lookup"><span data-stu-id="359b1-221">**LVM\_GETNEXTITEM**</span></span>](lvm-getnextitem.md)         | <span data-ttu-id="359b1-222">不支援 **LVNI \_ 剪** 下、 **LVNI \_ HIDDEN** 或 **LVNI \_ DROPHILITED** 的清單視圖搜尋準則。</span><span class="sxs-lookup"><span data-stu-id="359b1-222">Does not support the list-view search criteria **LVNI\_CUT**, **LVNI\_HIDDEN**, or **LVNI\_DROPHILITED**.</span></span> <span data-ttu-id="359b1-223">支援所有其他準則。</span><span class="sxs-lookup"><span data-stu-id="359b1-223">All other criteria are supported.</span></span>                                                                                                                     |
| [<span data-ttu-id="359b1-224">**LVM \_ GETWORKAREAS**</span><span class="sxs-lookup"><span data-stu-id="359b1-224">**LVM\_GETWORKAREAS**</span></span>](lvm-getworkareas.md)       | <span data-ttu-id="359b1-225">不支援。</span><span class="sxs-lookup"><span data-stu-id="359b1-225">Is not supported.</span></span>                                                                                                                                                                                                                                               |
| [<span data-ttu-id="359b1-226">**LVM \_ INSERTITEM**</span><span class="sxs-lookup"><span data-stu-id="359b1-226">**LVM\_INSERTITEM**</span></span>](lvm-insertitem.md)           | <span data-ttu-id="359b1-227">僅支援選取完整性。</span><span class="sxs-lookup"><span data-stu-id="359b1-227">Is supported for selection integrity only.</span></span>                                                                                                                                                                                                                      |
| [<span data-ttu-id="359b1-228">**LVM \_ SETITEM**</span><span class="sxs-lookup"><span data-stu-id="359b1-228">**LVM\_SETITEM**</span></span>](lvm-setitem.md)                 | <span data-ttu-id="359b1-229">不支援。</span><span class="sxs-lookup"><span data-stu-id="359b1-229">Is not supported.</span></span> <span data-ttu-id="359b1-230">若要設定專案狀態，請使用 [**ListView \_ SetItemState**](/windows/desktop/api/Commctrl/nf-commctrl-listview_setitemstate) 訊息。</span><span class="sxs-lookup"><span data-stu-id="359b1-230">To set the item state, use the [**ListView\_SetItemState**](/windows/desktop/api/Commctrl/nf-commctrl-listview_setitemstate) message.</span></span>                                                                                                                                               |
| [<span data-ttu-id="359b1-231">**LVM \_ SETITEMCOUNT**</span><span class="sxs-lookup"><span data-stu-id="359b1-231">**LVM\_SETITEMCOUNT**</span></span>](lvm-setitemcount.md)       | <span data-ttu-id="359b1-232">設定目前在清單中的專案數。</span><span class="sxs-lookup"><span data-stu-id="359b1-232">Sets the number of items currently in the list.</span></span> <span data-ttu-id="359b1-233">如果清單視圖控制項傳送的通知要求任何專案的資料達最大值集，則必須準備好提供該資料給擁有者。</span><span class="sxs-lookup"><span data-stu-id="359b1-233">If the list-view control sends a notification that requests data for any item up to the maximum set, the owner must be prepared to supply that data.</span></span> <span data-ttu-id="359b1-234">訊息參數支援虛擬清單-view 控制項。</span><span class="sxs-lookup"><span data-stu-id="359b1-234">The message parameters support virtual list-view controls.</span></span> |
| [<span data-ttu-id="359b1-235">**LVM \_ SETITEMPOSITION**</span><span class="sxs-lookup"><span data-stu-id="359b1-235">**LVM\_SETITEMPOSITION**</span></span>](lvm-setitemposition.md) | <span data-ttu-id="359b1-236">不支援。</span><span class="sxs-lookup"><span data-stu-id="359b1-236">Is not supported.</span></span>                                                                                                                                                                                                                                               |
| [<span data-ttu-id="359b1-237">**LVM \_ SETITEMSTATE**</span><span class="sxs-lookup"><span data-stu-id="359b1-237">**LVM\_SETITEMSTATE**</span></span>](lvm-setitemstate.md)       | <span data-ttu-id="359b1-238">只允許變更專案的選取範圍和焦點狀態。</span><span class="sxs-lookup"><span data-stu-id="359b1-238">Allows only the selection and focus states to be changed for the item.</span></span>                                                                                                                                                                                          |
| [<span data-ttu-id="359b1-239">**LVM \_ SETITEMTEXT**</span><span class="sxs-lookup"><span data-stu-id="359b1-239">**LVM\_SETITEMTEXT**</span></span>](lvm-setitemtext.md)         | <span data-ttu-id="359b1-240">不支援。</span><span class="sxs-lookup"><span data-stu-id="359b1-240">Is not supported.</span></span> <span data-ttu-id="359b1-241">應用程式必須負責維護專案文字。</span><span class="sxs-lookup"><span data-stu-id="359b1-241">It is the application's responsibility to maintain the item texts.</span></span>                                                                                                                                                                            |
| [<span data-ttu-id="359b1-242">**LVM \_ SETWORKAREAS**</span><span class="sxs-lookup"><span data-stu-id="359b1-242">**LVM\_SETWORKAREAS**</span></span>](lvm-setworkareas.md)       | <span data-ttu-id="359b1-243">不支援。</span><span class="sxs-lookup"><span data-stu-id="359b1-243">Is not supported.</span></span>                                                                                                                                                                                                                                               |
| [<span data-ttu-id="359b1-244">**LVM \_ SORTITEMS**</span><span class="sxs-lookup"><span data-stu-id="359b1-244">**LVM\_SORTITEMS**</span></span>](lvm-sortitems.md)             | <span data-ttu-id="359b1-245">不支援。</span><span class="sxs-lookup"><span data-stu-id="359b1-245">Is not supported.</span></span> <span data-ttu-id="359b1-246">應用程式必須負責以所需的順序呈現專案。</span><span class="sxs-lookup"><span data-stu-id="359b1-246">It is the application's responsibility to present the items in the desired order.</span></span>                                                                                                                                                             |



 

### <a name="handling-virtual-list-view-control-notification-codes"></a><span data-ttu-id="359b1-247">處理虛擬 List-View 控制通知碼</span><span class="sxs-lookup"><span data-stu-id="359b1-247">Handling Virtual List-View Control Notification Codes</span></span>

<span data-ttu-id="359b1-248">具有 [**lvs) \_ OWNERDATA**](list-view-window-styles.md) 樣式的清單視圖控制項，會傳送與其他清單視圖控制項相同的通知碼，以及兩個額外的控制項： [LVN \_ ODCACHEHINT](lvn-odcachehint.md) 和 [LVN \_ ODFINDITEM](lvn-odfinditem.md)。</span><span class="sxs-lookup"><span data-stu-id="359b1-248">List-view controls with the [**LVS\_OWNERDATA**](list-view-window-styles.md) style send the same notification codes as other list-view controls and two additional ones: [LVN\_ODCACHEHINT](lvn-odcachehint.md) and [LVN\_ODFINDITEM](lvn-odfinditem.md).</span></span> <span data-ttu-id="359b1-249">以下是 **lvs) \_ OWNERDATA** 樣式所傳送的清單視圖控制項最常見的通知。</span><span class="sxs-lookup"><span data-stu-id="359b1-249">The following are the most common notifications that the list-view control with the **LVS\_OWNERDATA** style sends.</span></span>



|                                         |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|-----------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="359b1-250">LVN \_ GETDISPINFO</span><span class="sxs-lookup"><span data-stu-id="359b1-250">LVN\_GETDISPINFO</span></span>](lvn-getdispinfo.md) | <span data-ttu-id="359b1-251">虛擬清單控制項只會維護很少的專案資訊。</span><span class="sxs-lookup"><span data-stu-id="359b1-251">A virtual list-view control maintains very little item information on its own.</span></span> <span data-ttu-id="359b1-252">因此，它通常會傳送 [LVN \_ GETDISPINFO](lvn-getdispinfo.md) 通知碼來要求專案資訊。</span><span class="sxs-lookup"><span data-stu-id="359b1-252">As a result, it often sends the [LVN\_GETDISPINFO](lvn-getdispinfo.md) notification code to request item information.</span></span> <span data-ttu-id="359b1-253">此訊息的處理方式與標準清單控制項中的回呼專案非常類似。</span><span class="sxs-lookup"><span data-stu-id="359b1-253">This message is handled in much the same way as callback items in a standard list control.</span></span> <span data-ttu-id="359b1-254">由於控制項支援的專案數目可能很大，因此快取專案資料可改善效能。</span><span class="sxs-lookup"><span data-stu-id="359b1-254">Because the number of items supported by the control can be very large, caching item data improves performance.</span></span> <span data-ttu-id="359b1-255">處理 LVN \_ GETDISPINFO 時，控制項的擁有者會先嘗試從快取提供要求的專案資訊 (如需詳細資訊，請參閱快取 [管理](#cache-management)) 。</span><span class="sxs-lookup"><span data-stu-id="359b1-255">When handling LVN\_GETDISPINFO, the owner of the control first attempts to supply requested item information from the cache (for more information, see [Cache Management](#cache-management)).</span></span> <span data-ttu-id="359b1-256">如果未快取要求的專案，擁有者必須做好準備，才能以其他方式提供資訊。</span><span class="sxs-lookup"><span data-stu-id="359b1-256">If the requested item is not cached, the owner must be prepared to supply the information by other means.</span></span> |
| [<span data-ttu-id="359b1-257">LVN \_ ODCACHEHINT</span><span class="sxs-lookup"><span data-stu-id="359b1-257">LVN\_ODCACHEHINT</span></span>](lvn-odcachehint.md) | <span data-ttu-id="359b1-258">虛擬清單視圖會傳送 [LVN \_ ODCACHEHINT](lvn-odcachehint.md) 通知碼，以協助優化快取。</span><span class="sxs-lookup"><span data-stu-id="359b1-258">A virtual list view sends the [LVN\_ODCACHEHINT](lvn-odcachehint.md) notification code to assist in optimizing the cache.</span></span> <span data-ttu-id="359b1-259">通知碼會針對建議快取的專案範圍提供內含的索引值。</span><span class="sxs-lookup"><span data-stu-id="359b1-259">The notification code provides inclusive index values for a range of items that it recommends be cached.</span></span> <span data-ttu-id="359b1-260">收到通知碼時，擁有者必須做好準備，以針對要求的範圍載入具有專案資訊的快取，如此一來，當傳送 [LVN \_ GETDISPINFO](lvn-getdispinfo.md) 訊息時，即可立即取得資訊。</span><span class="sxs-lookup"><span data-stu-id="359b1-260">Upon receiving the notification code, the owner must be prepared to load the cache with item information for the requested range so that the information will be readily available when an [LVN\_GETDISPINFO](lvn-getdispinfo.md) message is sent.</span></span>                                                                                                                                                                                                                                   |
| [<span data-ttu-id="359b1-261">LVN \_ ODFINDITEM</span><span class="sxs-lookup"><span data-stu-id="359b1-261">LVN\_ODFINDITEM</span></span>](lvn-odfinditem.md)   | <span data-ttu-id="359b1-262">當控制項需要擁有者來尋找特定的回呼專案時，虛擬清單-view 控制項就會傳送 [LVN \_ ODFINDITEM](lvn-odfinditem.md) 通知碼。</span><span class="sxs-lookup"><span data-stu-id="359b1-262">The [LVN\_ODFINDITEM](lvn-odfinditem.md) notification code is sent by a virtual list-view control when the control needs the owner to find a particular callback item.</span></span> <span data-ttu-id="359b1-263">當清單視圖控制項收到快速存取金鑰或收到 [**LVM \_ FINDITEM**](lvm-finditem.md) 訊息時，就會傳送通知碼。</span><span class="sxs-lookup"><span data-stu-id="359b1-263">The notification code is sent when the list-view control receives quick key access or when it receives an [**LVM\_FINDITEM**](lvm-finditem.md) message.</span></span> <span data-ttu-id="359b1-264">搜尋資訊會以 [**LVFINDINFO**](/windows/win32/api/commctrl/ns-commctrl-lvfindinfoa) 結構的形式傳送，這是 [**NMLVFINDITEM**](/windows/win32/api/commctrl/ns-commctrl-nmlvfinditema) 結構的成員。</span><span class="sxs-lookup"><span data-stu-id="359b1-264">Search information is sent in the form of an [**LVFINDINFO**](/windows/win32/api/commctrl/ns-commctrl-lvfindinfoa) structure, which is a member of the [**NMLVFINDITEM**](/windows/win32/api/commctrl/ns-commctrl-nmlvfinditema) structure.</span></span> <span data-ttu-id="359b1-265">擁有者必須做好準備，才能搜尋符合清單視圖控制項所提供之資訊的專案。</span><span class="sxs-lookup"><span data-stu-id="359b1-265">The owner must be prepared to search for an item that matches the information given by the list-view control.</span></span> <span data-ttu-id="359b1-266">如果成功，擁有者會傳回專案的索引; 如果找不到相符專案，則會傳回-1。</span><span class="sxs-lookup"><span data-stu-id="359b1-266">The owner returns the index of the item if successful, or -1 if no matching item is found.</span></span>               |



 

### <a name="cache-management"></a><span data-ttu-id="359b1-267">快取管理</span><span class="sxs-lookup"><span data-stu-id="359b1-267">Cache Management</span></span>

<span data-ttu-id="359b1-268">具有 [**lvs) \_ OWNERDATA**](list-view-window-styles.md) 樣式的清單視圖控制項會產生大量的 [LVN \_ GETDISPINFO](lvn-getdispinfo.md) 通知碼，以及協助優化快取（ [LVN \_ ODCACHEHINT](lvn-odcachehint.md) 訊息）。</span><span class="sxs-lookup"><span data-stu-id="359b1-268">A list-view control with the [**LVS\_OWNERDATA**](list-view-window-styles.md) style produces a large number of [LVN\_GETDISPINFO](lvn-getdispinfo.md) notification codes and, to assist in optimizing the cache, an [LVN\_ODCACHEHINT](lvn-odcachehint.md) message.</span></span> <span data-ttu-id="359b1-269">LVN \_ ODCACHEHINT 訊息提供要包含在快取中之建議專案的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="359b1-269">LVN\_ODCACHEHINT messages provide information about the recommended items to include within the cache.</span></span> <span data-ttu-id="359b1-270">這些訊息會以 [**WM \_ 通知**](wm-notify.md) 訊息的形式傳送， *LParam* 值會作為 [**NMLVCACHEHINT**](/windows/win32/api/commctrl/ns-commctrl-nmlvcachehint) 結構的位址。</span><span class="sxs-lookup"><span data-stu-id="359b1-270">These messages are sent as [**WM\_NOTIFY**](wm-notify.md) messages, with the *lParam* value acting as the address of an [**NMLVCACHEHINT**](/windows/win32/api/commctrl/ns-commctrl-nmlvcachehint) structure.</span></span>

<span data-ttu-id="359b1-271">[**NMLVCACHEHINT**](/windows/win32/api/commctrl/ns-commctrl-nmlvcachehint)結構包含兩個整數成員（ **iFrom** 和 **分成**），代表最可能需要之專案範圍的內含端點。</span><span class="sxs-lookup"><span data-stu-id="359b1-271">The [**NMLVCACHEHINT**](/windows/win32/api/commctrl/ns-commctrl-nmlvcachehint) structure includes two integer members, **iFrom** and **iTo**, that represent the inclusive endpoints of a range of items that most likely will be needed.</span></span> <span data-ttu-id="359b1-272">擁有者必須做好準備，以針對建議範圍內的每個專案，載入具有專案資訊的快取。</span><span class="sxs-lookup"><span data-stu-id="359b1-272">The owner must be prepared to load the cache with the item information for each of the items within the recommended range.</span></span>

<span data-ttu-id="359b1-273">清單控制項通常需要第一個專案的專案資訊 (offset 0) 。</span><span class="sxs-lookup"><span data-stu-id="359b1-273">The list control often needs item information for the first item (offset 0).</span></span> <span data-ttu-id="359b1-274">[LVN \_ ODCACHEHINT](lvn-odcachehint.md)通知碼可能不一定會包含專案0，但必須一律包含在快取中。</span><span class="sxs-lookup"><span data-stu-id="359b1-274">The [LVN\_ODCACHEHINT](lvn-odcachehint.md) notification code might not always include item 0, but it must always be included in the cache.</span></span>

<span data-ttu-id="359b1-275">通常會存取清單中的最後一個專案。</span><span class="sxs-lookup"><span data-stu-id="359b1-275">The last items in the list are accessed often.</span></span> <span data-ttu-id="359b1-276">因此，擁有者可能會想要保留第二個快取，其中包含清單結尾的專案。</span><span class="sxs-lookup"><span data-stu-id="359b1-276">Therefore, the owner might want to keep a second cache that includes the items at the end of the list.</span></span> <span data-ttu-id="359b1-277">從 [LVN \_ ODCACHEHINT](lvn-odcachehint.md) 所要求的範圍可以針對結尾快取進行檢查，讓它自動可用，而不是每次重載相同的結束範圍。</span><span class="sxs-lookup"><span data-stu-id="359b1-277">The requested range from [LVN\_ODCACHEHINT](lvn-odcachehint.md) can be checked against the end cache to make it available automatically instead of reloading the same end range each time.</span></span>

## <a name="list-view-working-areas"></a><span data-ttu-id="359b1-278">List-View 工作區</span><span class="sxs-lookup"><span data-stu-id="359b1-278">List-View Working Areas</span></span>

<span data-ttu-id="359b1-279">清單視圖控制項支援工作區域，這些區域是清單視圖控制項用來排列其專案的矩形虛擬區域。</span><span class="sxs-lookup"><span data-stu-id="359b1-279">List-view controls support working areas, which are rectangular virtual areas that the list-view control uses to arrange its items.</span></span> <span data-ttu-id="359b1-280">工作區域不是視窗，且不能有可見的框線。</span><span class="sxs-lookup"><span data-stu-id="359b1-280">A working area is not a window and cannot have a visible border.</span></span> <span data-ttu-id="359b1-281">依預設，清單視圖控制項沒有任何工作區域。</span><span class="sxs-lookup"><span data-stu-id="359b1-281">By default, the list-view control has no working areas.</span></span> <span data-ttu-id="359b1-282">藉由建立工作區，您可以在專案的左邊、頂端或右邊建立空白框線，或在正常情況下，顯示水準捲軸。</span><span class="sxs-lookup"><span data-stu-id="359b1-282">By creating a working area, you can create an empty border on the left, top, or right of the items or cause a horizontal scroll bar to be displayed when there normally would not be one.</span></span>

<span data-ttu-id="359b1-283">建立工作區時，位於工作區域內的專案會成為工作區域的成員。</span><span class="sxs-lookup"><span data-stu-id="359b1-283">When a working area is created, items that lie within the working area become members of the working area.</span></span> <span data-ttu-id="359b1-284">同樣地，如果將某個專案移到工作區，該專案就會變成該工作區的成員。</span><span class="sxs-lookup"><span data-stu-id="359b1-284">Similarly, if an item is moved into a working area, the item becomes a member of that working area.</span></span> <span data-ttu-id="359b1-285">如果專案不在任何工作區域內，它會自動成為第一個 (索引 0) 工作區域的成員。</span><span class="sxs-lookup"><span data-stu-id="359b1-285">If an item does not lie within any working area, it automatically becomes a member of the first (index 0) working area.</span></span> <span data-ttu-id="359b1-286">若要將新專案放在特定工作區中，您必須先建立專案，然後使用 [**lvm \_ SETITEMPOSITION**](lvm-setitemposition.md) 或 [**lvm \_ SETITEMPOSITION32**](lvm-setitemposition32.md) 訊息將它移至所需的工作區域。</span><span class="sxs-lookup"><span data-stu-id="359b1-286">To place new item within a specific working area, you must first create the item and then use either the [**LVM\_SETITEMPOSITION**](lvm-setitemposition.md) or the [**LVM\_SETITEMPOSITION32**](lvm-setitemposition32.md) message to move it into the desired working area.</span></span>

<span data-ttu-id="359b1-287">下圖是清單視圖控制項的範例，其中包含四個工作區，每個區域都在不同的工作區象限中。</span><span class="sxs-lookup"><span data-stu-id="359b1-287">The following illustration is an example of a list-view control that contains four working areas, each in a different quadrant of the client area.</span></span>

![清單視圖控制項的螢幕擷取畫面，其中有一個工作區域位於工作區的每個象限中](images/working.jpg)

<span data-ttu-id="359b1-289">多個工作區可以用來在單一視圖內建立不同的區域。</span><span class="sxs-lookup"><span data-stu-id="359b1-289">Multiple working areas can be used for creating different areas within one view.</span></span> <span data-ttu-id="359b1-290">您可以在具有不同意義的單一視圖中建立區域。</span><span class="sxs-lookup"><span data-stu-id="359b1-290">You can create areas in a single view that have different meanings.</span></span> <span data-ttu-id="359b1-291">例如，檔案系統的視圖可能會有讀取/寫入檔案的區域，以及唯讀檔案的另一個區域。</span><span class="sxs-lookup"><span data-stu-id="359b1-291">For example, a view of a file system might have an area for read/write files and another area for read-only files.</span></span> <span data-ttu-id="359b1-292">使用者可以將專案放在不同的工作區中，藉以分類專案。</span><span class="sxs-lookup"><span data-stu-id="359b1-292">The user can categorize items by placing them in different working areas.</span></span> <span data-ttu-id="359b1-293">如果檔案已移至唯讀區域，則會自動變成隻讀區域。</span><span class="sxs-lookup"><span data-stu-id="359b1-293">If a file is moved into the read-only area, it will automatically become read-only.</span></span>

<span data-ttu-id="359b1-294">多個工作區可以交集，但位於交集內的任何專案都會變成具有較低索引之區域的成員。因此，最好避免這種情況。</span><span class="sxs-lookup"><span data-stu-id="359b1-294">Multiple working areas can intersect, but any items that lie within the intersection become members of the area with the lower index; therefore, it is best to avoid this situation.</span></span> <span data-ttu-id="359b1-295">排序多個工作區時，專案會與相同工作區域中的其他專案進行排序。</span><span class="sxs-lookup"><span data-stu-id="359b1-295">When sorting multiple work areas, the items are sorted compared to the other items in the same working area.</span></span>

<span data-ttu-id="359b1-296">您可以使用 [**LVM \_ GETNUMBEROFWORKAREAS**](lvm-getnumberofworkareas.md) 訊息抓取工作區域數目。</span><span class="sxs-lookup"><span data-stu-id="359b1-296">The number of working areas can be retrieved with the [**LVM\_GETNUMBEROFWORKAREAS**](lvm-getnumberofworkareas.md) message.</span></span> <span data-ttu-id="359b1-297">工作區域會隨 [**lvm \_ SETWORKAREAS**](lvm-setworkareas.md) 訊息變更，而且可以使用 [**lvm \_ GETWORKAREAS**](lvm-getworkareas.md) 訊息來抓取。</span><span class="sxs-lookup"><span data-stu-id="359b1-297">The working areas are changed with the [**LVM\_SETWORKAREAS**](lvm-setworkareas.md) message and can be retrieved with the [**LVM\_GETWORKAREAS**](lvm-getworkareas.md) message.</span></span> <span data-ttu-id="359b1-298">這兩個訊息都採用 [**rect**](/previous-versions//dd162897(v=vs.85)) 結構陣列的位址做為 *LParam* ，而 **rect** 結構的數目則為 *wParam*。</span><span class="sxs-lookup"><span data-stu-id="359b1-298">Both of these messages take the address of an array of [**RECT**](/previous-versions//dd162897(v=vs.85)) structures as the *lParam* and the number of **RECT** structures as the *wParam*.</span></span> <span data-ttu-id="359b1-299">這些結構的 **左邊** 和 **頂端** 成員會指定工作區域的原點)  (左上角的座標， **右邊** 和 **底部** 的成員則指定工作區域的右下角。</span><span class="sxs-lookup"><span data-stu-id="359b1-299">The **left** and **top** members of these structures specify the coordinates of the upper-left corner (the origin) of the working area, and the **right** and **bottom** members specify the lower-right corner of the working area.</span></span> <span data-ttu-id="359b1-300">所有座標都是在清單視圖的用戶端座標中。</span><span class="sxs-lookup"><span data-stu-id="359b1-300">All the coordinates are in client coordinates of the list view.</span></span> <span data-ttu-id="359b1-301">允許的工作區域數目上限是由 **LV \_ MAX \_ WORKAREAS** 值定義。</span><span class="sxs-lookup"><span data-stu-id="359b1-301">The maximum number of working areas allowed is defined by the **LV\_MAX\_WORKAREAS** value.</span></span>

<span data-ttu-id="359b1-302">變更工作區域不會影響具有 [**lvs) \_ 清單**](list-view-window-styles.md) 或 [**lvs) \_ 報表**](list-view-window-styles.md) 視圖的清單視圖控制項，但在變更檢視類型時，將會維護工作區域。</span><span class="sxs-lookup"><span data-stu-id="359b1-302">Changing the working area has no effect on list-view controls that have the [**LVS\_LIST**](list-view-window-styles.md) or [**LVS\_REPORT**](list-view-window-styles.md) view, but the working areas will be maintained when the view type is changed.</span></span> <span data-ttu-id="359b1-303">您可以使用 [**lvs) \_ 圖示**](list-view-window-styles.md) 和 [**lvs) \_ SMALLICON**](list-view-window-styles.md) views，修改工作區以變更專案的顯示方式。</span><span class="sxs-lookup"><span data-stu-id="359b1-303">With the [**LVS\_ICON**](list-view-window-styles.md) and [**LVS\_SMALLICON**](list-view-window-styles.md) views, the working area can be modified to change the way the items are displayed.</span></span> <span data-ttu-id="359b1-304">讓工作區域的寬度 (靠右左邊) 大於控制項的用戶端寬度，會導致專案以該寬度和水準捲軸來顯示。</span><span class="sxs-lookup"><span data-stu-id="359b1-304">Making the width of the working area (right - left) greater than the client width of the control causes the items to be wrapped at that width and the horizontal scroll bar to be displayed.</span></span> <span data-ttu-id="359b1-305">使工作區域的寬度比控制項的工作區寬度窄，會導致專案在工作區域內換行，而不是工作區的寬度。</span><span class="sxs-lookup"><span data-stu-id="359b1-305">Making the width of the working area narrower than the width of the control's client area causes the items to be wrapped within the working area and not the client area.</span></span> <span data-ttu-id="359b1-306">將 **left** 或 **top** 成員設為正值，會導致專案從工作區域開始顯示，在控制項邊緣與專案之間建立空白空間。</span><span class="sxs-lookup"><span data-stu-id="359b1-306">Setting the **left** or **top** member to a positive value causes the items to be displayed starting at the working area, creating an empty space between the edge of the control and the items.</span></span> <span data-ttu-id="359b1-307">您也可以在控制項的右邊緣和專案之間建立空白空間，讓工作區域的寬度小於控制項的用戶端寬度。</span><span class="sxs-lookup"><span data-stu-id="359b1-307">An empty space can also be created between the right edge of the control and the items by making the width of the working area less than the client width of the control.</span></span>

## <a name="list-view-image-lists"></a><span data-ttu-id="359b1-308">List-View 影像清單</span><span class="sxs-lookup"><span data-stu-id="359b1-308">List-View Image Lists</span></span>

<span data-ttu-id="359b1-309">依預設，清單視圖控制項不會顯示專案影像。</span><span class="sxs-lookup"><span data-stu-id="359b1-309">By default, a list-view control does not display item images.</span></span> <span data-ttu-id="359b1-310">若要顯示專案影像，您必須建立影像清單，並將它們與控制項建立關聯。</span><span class="sxs-lookup"><span data-stu-id="359b1-310">To display item images, you must create image lists and associate them with the control.</span></span> <span data-ttu-id="359b1-311">清單視圖控制項可以有三個影像清單：</span><span class="sxs-lookup"><span data-stu-id="359b1-311">A list-view control can have three image lists:</span></span>

-   <span data-ttu-id="359b1-312">影像清單，其中包含當控制項在圖示視圖中時，所顯示的完整大小圖示。</span><span class="sxs-lookup"><span data-stu-id="359b1-312">An image list that contains full-sized icons displayed when the control is in icon view.</span></span>
-   <span data-ttu-id="359b1-313">影像清單，其中包含當控制項處於小型圖示視圖、清單視圖或報表檢視時所顯示的小圖示。</span><span class="sxs-lookup"><span data-stu-id="359b1-313">An image list that contains small icons displayed when the control is in small icon view, list view, or report view.</span></span>
-   <span data-ttu-id="359b1-314">包含狀態影像的影像清單，會顯示在完整大小或小圖示的左邊。</span><span class="sxs-lookup"><span data-stu-id="359b1-314">An image list that contains state images, which are displayed to the left of the full-sized or small icon.</span></span> <span data-ttu-id="359b1-315">您可以使用狀態影像（例如核取和清除的核取方塊）來表示應用程式定義的專案狀態。</span><span class="sxs-lookup"><span data-stu-id="359b1-315">You can use state images, such as checked and cleared check boxes, to indicate application-defined item states.</span></span> <span data-ttu-id="359b1-316">狀態影像會顯示在圖示視圖、小型圖示視圖、清單視圖和報表檢視中。</span><span class="sxs-lookup"><span data-stu-id="359b1-316">State images are displayed in icon view, small icon view, list view, and report view.</span></span>

<span data-ttu-id="359b1-317">完整大小和小型圖示影像清單也可以包含重迭 *影像*，其設計目的是要在專案圖示上以透明方式繪製。</span><span class="sxs-lookup"><span data-stu-id="359b1-317">The full-sized and small icon image lists can also contain *overlay images*, which are designed to be drawn transparently over the item icons.</span></span>

<span data-ttu-id="359b1-318">若要在清單視圖控制項中使用覆迭影像：</span><span class="sxs-lookup"><span data-stu-id="359b1-318">To use overlay images in a list-view control:</span></span>

1.  <span data-ttu-id="359b1-319">呼叫 [**ImageList \_ SetOverlayImage**](/windows/desktop/api/Commctrl/nf-commctrl-imagelist_setoverlayimage) 函式，將重迭影像索引指派給完整大小和小型圖示影像清單中的影像。</span><span class="sxs-lookup"><span data-stu-id="359b1-319">Call the [**ImageList\_SetOverlayImage**](/windows/desktop/api/Commctrl/nf-commctrl-imagelist_setoverlayimage) function to assign an overlay image index to an image in the full-sized and small icon image lists.</span></span> <span data-ttu-id="359b1-320">覆迭影像是由以一為基礎的索引來識別。</span><span class="sxs-lookup"><span data-stu-id="359b1-320">An overlay image is identified by a one-based index.</span></span>
2.  <span data-ttu-id="359b1-321">當您呼叫 [**listview \_ InsertItem**](/windows/desktop/api/Commctrl/nf-commctrl-listview_insertitem) 或 [**listview \_ SetItem**](/windows/desktop/api/Commctrl/nf-commctrl-listview_setitem) 宏時，可以將重迭影像索引與專案產生關聯。</span><span class="sxs-lookup"><span data-stu-id="359b1-321">You can associate an overlay image index with an item when you call the [**ListView\_InsertItem**](/windows/desktop/api/Commctrl/nf-commctrl-listview_insertitem) or [**ListView\_SetItem**](/windows/desktop/api/Commctrl/nf-commctrl-listview_setitem) macro.</span></span> <span data-ttu-id="359b1-322">使用 [**INDEXTOOVERLAYMASK**](/windows/desktop/api/Commctrl/nf-commctrl-indextooverlaymask)宏，在專案的 [**LVITEM**](/windows/win32/api/commctrl/ns-commctrl-lvitema)結構的 **state** 成員中指定覆迭影像索引。</span><span class="sxs-lookup"><span data-stu-id="359b1-322">Use the [**INDEXTOOVERLAYMASK**](/windows/desktop/api/Commctrl/nf-commctrl-indextooverlaymask) macro to specify an overlay image index in the **state** member of the item's [**LVITEM**](/windows/win32/api/commctrl/ns-commctrl-lvitema) structure.</span></span> <span data-ttu-id="359b1-323">您也必須在 **stateMask** 成員中設定 [**LVIS \_ OVERLAYMASK**](list-view-item-states.md)位。</span><span class="sxs-lookup"><span data-stu-id="359b1-323">You must also set the [**LVIS\_OVERLAYMASK**](list-view-item-states.md) bits in the **stateMask** member.</span></span>

<span data-ttu-id="359b1-324">如果指定狀態影像清單，清單視圖控制項會在狀態影像的每個專案圖示左邊保留空間。</span><span class="sxs-lookup"><span data-stu-id="359b1-324">If a state image list is specified, a list-view control reserves space to the left of each item's icon for a state image.</span></span>

<span data-ttu-id="359b1-325">若要將狀態影像與專案產生關聯，請使用 [**INDEXTOSTATEIMAGEMASK**](/windows/desktop/api/Commctrl/nf-commctrl-indextostateimagemask)宏在 [**LVITEM**](/windows/win32/api/commctrl/ns-commctrl-lvitema)結構的 **state** 成員中指定狀態影像索引。</span><span class="sxs-lookup"><span data-stu-id="359b1-325">To associate a state image with an item, use the [**INDEXTOSTATEIMAGEMASK**](/windows/desktop/api/Commctrl/nf-commctrl-indextostateimagemask) macro to specify a state image index in the **state** member of the [**LVITEM**](/windows/win32/api/commctrl/ns-commctrl-lvitema) structure.</span></span> <span data-ttu-id="359b1-326">索引會識別控制項狀態影像清單中的影像。</span><span class="sxs-lookup"><span data-stu-id="359b1-326">The index identifies an image in the control's state image list.</span></span> <span data-ttu-id="359b1-327">雖然影像清單索引是以零為基底，但控制項會使用以一為基礎的索引來識別狀態影像。</span><span class="sxs-lookup"><span data-stu-id="359b1-327">Although image list indexes are zero-based, the control uses one-based indexes to identify state images.</span></span> <span data-ttu-id="359b1-328">狀態影像索引為零表示專案沒有狀態影像。</span><span class="sxs-lookup"><span data-stu-id="359b1-328">A state image index of zero indicates that an item has no state image.</span></span>

<span data-ttu-id="359b1-329">根據預設，當清單視圖控制項被終結時，它會終結指派給它的影像清單。</span><span class="sxs-lookup"><span data-stu-id="359b1-329">By default, when a list-view control is destroyed, it destroys the image lists assigned to it.</span></span> <span data-ttu-id="359b1-330">但是，如果清單視圖控制項有 [ [**lvs) \_ SHAREIMAGELISTS**](list-view-window-styles.md) ] 視窗樣式，則應用程式會負責在不再使用時終結影像清單。</span><span class="sxs-lookup"><span data-stu-id="359b1-330">However, if a list-view control has the [**LVS\_SHAREIMAGELISTS**](list-view-window-styles.md) window style, the application is responsible for destroying the image lists when they are no longer in use.</span></span> <span data-ttu-id="359b1-331">如果您將相同的影像清單指派給多個清單視圖控制項，則應該指定此樣式;否則，有一個以上的控制項可能會嘗試終結相同的影像清單。</span><span class="sxs-lookup"><span data-stu-id="359b1-331">You should specify this style if you assign the same image lists to multiple list-view controls; otherwise, more than one control might try to destroy the same image list.</span></span>

## <a name="list-view-items-and-subitems"></a><span data-ttu-id="359b1-332">List-View 專案與子專案</span><span class="sxs-lookup"><span data-stu-id="359b1-332">List-View Items and Subitems</span></span>

<span data-ttu-id="359b1-333">清單視圖控制項中的每個專案都有圖示、標籤、目前的狀態，以及應用程式定義的值。</span><span class="sxs-lookup"><span data-stu-id="359b1-333">Each item in a list-view control has an icon, a label, a current state, and an application-defined value.</span></span> <span data-ttu-id="359b1-334">藉由使用清單視圖訊息，您可以加入、修改和刪除專案，以及取得專案的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="359b1-334">By using list-view messages, you can add, modify, and delete items as well as retrieve information about items.</span></span>

<span data-ttu-id="359b1-335">每個專案都可以有一個或多個子 *專案。*</span><span class="sxs-lookup"><span data-stu-id="359b1-335">Each item can have one or more *subitems*.</span></span> <span data-ttu-id="359b1-336">子專案是在報表檢視中，顯示在與專案的圖示和標籤分開的資料行中的字串。</span><span class="sxs-lookup"><span data-stu-id="359b1-336">A subitem is a string that, in report view, is displayed in a column separate from the item's icon and label.</span></span> <span data-ttu-id="359b1-337">若要指定子工作的文字，請使用 [**lvm \_ SETITEMTEXT**](lvm-setitemtext.md) 或 [**lvm \_ SETITEM**](lvm-setitem.md) 訊息。</span><span class="sxs-lookup"><span data-stu-id="359b1-337">To specify the text of a subitem, use the [**LVM\_SETITEMTEXT**](lvm-setitemtext.md) or [**LVM\_SETITEM**](lvm-setitem.md) message.</span></span> <span data-ttu-id="359b1-338">清單視圖控制項中的所有專案都有相同的子專案數目。</span><span class="sxs-lookup"><span data-stu-id="359b1-338">All items in a list-view control have the same number of subitems.</span></span> <span data-ttu-id="359b1-339">子的數目取決於清單視圖控制項中的資料行數目。</span><span class="sxs-lookup"><span data-stu-id="359b1-339">The number of subitems is determined by the number of columns in the list-view control.</span></span> <span data-ttu-id="359b1-340">當您將資料行加入至清單視圖控制項時，您會指定其相關聯的子索引。</span><span class="sxs-lookup"><span data-stu-id="359b1-340">When you add a column to a list-view control, you specify its associated subitem index.</span></span>

<span data-ttu-id="359b1-341">[**LVITEM**](/windows/win32/api/commctrl/ns-commctrl-lvitema)結構會定義清單視圖專案或子專案。</span><span class="sxs-lookup"><span data-stu-id="359b1-341">The [**LVITEM**](/windows/win32/api/commctrl/ns-commctrl-lvitema) structure defines a list-view item or subitem.</span></span> <span data-ttu-id="359b1-342">**IItem** 成員是專案的以零為基底的索引。</span><span class="sxs-lookup"><span data-stu-id="359b1-342">The **iItem** member is the zero-based index of the item.</span></span> <span data-ttu-id="359b1-343">如果結構包含專案的相關資訊， **iSubItem** 成員是子專案的以一為起始的索引，或為零。</span><span class="sxs-lookup"><span data-stu-id="359b1-343">The **iSubItem** member is the one-based index of a subitem or zero if the structure contains information about an item.</span></span> <span data-ttu-id="359b1-344">其他成員會指定項目的文字、圖示、狀態和項目資料。</span><span class="sxs-lookup"><span data-stu-id="359b1-344">Additional members specify the item's text, icon, state, and item data.</span></span> <span data-ttu-id="359b1-345">*專案資料* 是與清單視圖專案相關聯的應用程式定義值。</span><span class="sxs-lookup"><span data-stu-id="359b1-345">*Item data* is an application-defined value associated with a list-view item.</span></span>

<span data-ttu-id="359b1-346">若要將專案加入至清單視圖控制項，請使用 [**LVM \_ INSERTITEM**](lvm-insertitem.md) 訊息，並指定 [**LVITEM**](/windows/win32/api/commctrl/ns-commctrl-lvitema) 結構的位址。</span><span class="sxs-lookup"><span data-stu-id="359b1-346">To add an item to a list-view control, use the [**LVM\_INSERTITEM**](lvm-insertitem.md) message, specifying the address of an [**LVITEM**](/windows/win32/api/commctrl/ns-commctrl-lvitema) structure.</span></span> <span data-ttu-id="359b1-347">新增多個專案之前，您可以將 [**LVM \_ SETITEMCOUNT**](lvm-setitemcount.md) 訊息傳送給控制項，並指定控制項最終將包含的專案數目。</span><span class="sxs-lookup"><span data-stu-id="359b1-347">Before adding multiple items, you can send the control an [**LVM\_SETITEMCOUNT**](lvm-setitemcount.md) message, specifying the number of items the control will ultimately contain.</span></span> <span data-ttu-id="359b1-348">此訊息可讓清單視圖控制項只重新配置其內部資料結構一次，而不是每次新增專案。</span><span class="sxs-lookup"><span data-stu-id="359b1-348">This message enables the list-view control to reallocate its internal data structures only once rather than every time you add an item.</span></span> <span data-ttu-id="359b1-349">您可以使用 [**LVM \_ GETITEMCOUNT**](lvm-getitemcount.md) 訊息來判斷清單視圖控制項中的專案數。</span><span class="sxs-lookup"><span data-stu-id="359b1-349">You can determine the number of items in a list-view control by using the [**LVM\_GETITEMCOUNT**](lvm-getitemcount.md) message.</span></span> <span data-ttu-id="359b1-350">如果您要將大量專案加入至清單視圖控制項，可以在新增專案之前停用重繪來加速程式，然後在新增專案之後啟用重新繪製。</span><span class="sxs-lookup"><span data-stu-id="359b1-350">If you are adding a large number of items to a list-view control, you can speed up the process by disabling redrawing before adding the items, then enable redrawing after the items are added.</span></span> <span data-ttu-id="359b1-351">使用 [**WM \_ SETREDRAW**](/windows/desktop/gdi/wm-setredraw) 訊息來啟用和停用重繪。</span><span class="sxs-lookup"><span data-stu-id="359b1-351">Use the [**WM\_SETREDRAW**](/windows/desktop/gdi/wm-setredraw) message to enable and disable redrawing.</span></span>

<span data-ttu-id="359b1-352">若要變更清單視圖專案的屬性，請使用 [**LVM \_ SETITEM**](lvm-setitem.md) 訊息，並指定 [**LVITEM**](/windows/win32/api/commctrl/ns-commctrl-lvitema) 結構的位址。</span><span class="sxs-lookup"><span data-stu-id="359b1-352">To change the attributes of a list-view item, use the [**LVM\_SETITEM**](lvm-setitem.md) message, specifying the address of an [**LVITEM**](/windows/win32/api/commctrl/ns-commctrl-lvitema) structure.</span></span> <span data-ttu-id="359b1-353">此結構的 **遮罩** 成員會指定您想要變更的專案屬性。</span><span class="sxs-lookup"><span data-stu-id="359b1-353">The **mask** member of this structure specifies the item attributes you want to change.</span></span> <span data-ttu-id="359b1-354">例如，若只要變更專案或子專案的文字，請使用 [**LVM \_ SETITEMTEXT**](lvm-setitemtext.md) 訊息。</span><span class="sxs-lookup"><span data-stu-id="359b1-354">For example, to change only the text of an item or subitem, use the [**LVM\_SETITEMTEXT**](lvm-setitemtext.md) message.</span></span>

<span data-ttu-id="359b1-355">若要取出清單視圖專案的相關資訊，請使用 [**LVM \_ GETITEM**](lvm-getitem.md) 訊息，並指定要填入之 [**LVITEM**](/windows/win32/api/commctrl/ns-commctrl-lvitema) 結構的位址。</span><span class="sxs-lookup"><span data-stu-id="359b1-355">To retrieve information about a list-view item, use the [**LVM\_GETITEM**](lvm-getitem.md) message, specifying the address of the [**LVITEM**](/windows/win32/api/commctrl/ns-commctrl-lvitema) structure to fill in.</span></span> <span data-ttu-id="359b1-356">此結構的 **遮罩** 成員會指定要取出的專案屬性。</span><span class="sxs-lookup"><span data-stu-id="359b1-356">The **mask** member of this structure specifies the item attributes to be retrieved.</span></span> <span data-ttu-id="359b1-357">若只要取出專案或子專案的文字，請使用 [**LVM \_ GETITEMTEXT**](lvm-getitemtext.md) 訊息。</span><span class="sxs-lookup"><span data-stu-id="359b1-357">To retrieve only an item or subitem's text, use the [**LVM\_GETITEMTEXT**](lvm-getitemtext.md) message.</span></span>

<span data-ttu-id="359b1-358">若要刪除清單視圖專案，請使用 [**LVM \_ DELETEITEM**](lvm-deleteitem.md) 訊息。</span><span class="sxs-lookup"><span data-stu-id="359b1-358">To delete a list-view item, use the [**LVM\_DELETEITEM**](lvm-deleteitem.md) message.</span></span> <span data-ttu-id="359b1-359">您可以使用 [**LVM \_ DELETEALLITEMS**](lvm-deleteallitems.md) 訊息來刪除清單視圖控制項中的所有專案。</span><span class="sxs-lookup"><span data-stu-id="359b1-359">You can delete all items in a list-view control by using the [**LVM\_DELETEALLITEMS**](lvm-deleteallitems.md) message.</span></span>

### <a name="list-view-item-states"></a><span data-ttu-id="359b1-360">List-View 專案狀態</span><span class="sxs-lookup"><span data-stu-id="359b1-360">List-View Item States</span></span>

<span data-ttu-id="359b1-361">專案的狀態是一個值，可指定專案的可用性、指出使用者動作，或是反映專案的狀態。</span><span class="sxs-lookup"><span data-stu-id="359b1-361">An item's state is a value that specifies the item's availability, indicates user actions, or otherwise reflects the item's status.</span></span> <span data-ttu-id="359b1-362">清單視圖控制項會變更某些狀態位，例如使用者選取專案時。</span><span class="sxs-lookup"><span data-stu-id="359b1-362">A list-view control changes some state bits, such as when the user selects an item.</span></span> <span data-ttu-id="359b1-363">應用程式可能會變更其他狀態位，以停用或隱藏專案，或指定重迭影像或狀態影像。</span><span class="sxs-lookup"><span data-stu-id="359b1-363">An application might change other state bits to disable or hide the item or to specify an overlay image or state image.</span></span> <span data-ttu-id="359b1-364">如需覆迭影像和狀態影像的詳細資訊，請參閱 [清單-視圖影像清單](#list-view-image-lists)。</span><span class="sxs-lookup"><span data-stu-id="359b1-364">For more information about overlay images and state images, see [List-View Image Lists](#list-view-image-lists).</span></span>

<span data-ttu-id="359b1-365">專案的狀態是由 [**LVITEM**](/windows/win32/api/commctrl/ns-commctrl-lvitema)結構的 **state** 成員所指定。</span><span class="sxs-lookup"><span data-stu-id="359b1-365">An item's state is specified by the **state** member of the [**LVITEM**](/windows/win32/api/commctrl/ns-commctrl-lvitema) structure.</span></span> <span data-ttu-id="359b1-366">當您指定或變更專案的狀態時， **stateMask** 成員會指定您需要變更的狀態位。</span><span class="sxs-lookup"><span data-stu-id="359b1-366">When you specify or change an item's state, the **stateMask** member specifies which state bits you need to change.</span></span> <span data-ttu-id="359b1-367">您可以使用 [**LVM \_ SETITEMSTATE**](lvm-setitemstate.md) 訊息來變更專案的狀態。</span><span class="sxs-lookup"><span data-stu-id="359b1-367">You can change an item's state by using the [**LVM\_SETITEMSTATE**](lvm-setitemstate.md) message.</span></span> <span data-ttu-id="359b1-368">您可以在建立專案時指定專案的狀態，或使用 [**LVM \_ SETITEM**](lvm-setitem.md) 訊息來變更其屬性。</span><span class="sxs-lookup"><span data-stu-id="359b1-368">You can specify an item's state when you create it or when you change its attributes by using the [**LVM\_SETITEM**](lvm-setitem.md) message.</span></span> <span data-ttu-id="359b1-369">若要判斷專案的目前狀態，請使用 [**lvm \_ GETITEMSTATE**](lvm-getitemstate.md) 或 [**lvm \_ GETITEM**](lvm-getitem.md) 訊息。</span><span class="sxs-lookup"><span data-stu-id="359b1-369">To determine an item's current state, use the [**LVM\_GETITEMSTATE**](lvm-getitemstate.md) or [**LVM\_GETITEM**](lvm-getitem.md) message.</span></span>

<span data-ttu-id="359b1-370">若要設定專案的重迭影像， [**LVITEM**](/windows/win32/api/commctrl/ns-commctrl-lvitema)結構的 **stateMask** 成員必須包含 [**LVIS \_ OVERLAYMASK**](list-view-item-states.md)值，而且 **狀態** 成員必須包含覆迭影像的以一為基礎的索引，而這個覆迭影像會使用 [**INDEXTOOVERLAYMASK**](/windows/desktop/api/Commctrl/nf-commctrl-indextooverlaymask)宏來向左移動8個位。</span><span class="sxs-lookup"><span data-stu-id="359b1-370">To set an item's overlay image, the **stateMask** member of the [**LVITEM**](/windows/win32/api/commctrl/ns-commctrl-lvitema) structure must include the [**LVIS\_OVERLAYMASK**](list-view-item-states.md) value, and the **state** member must include the one-based index of the overlay image shifted left 8 bits by using the [**INDEXTOOVERLAYMASK**](/windows/desktop/api/Commctrl/nf-commctrl-indextooverlaymask) macro.</span></span> <span data-ttu-id="359b1-371">索引可以是零，以指定無重迭影像。</span><span class="sxs-lookup"><span data-stu-id="359b1-371">The index can be zero to specify no overlay image.</span></span>

<span data-ttu-id="359b1-372">若要設定專案的狀態影像， [**LVITEM**](/windows/win32/api/commctrl/ns-commctrl-lvitema)結構的 **stateMask** 成員必須包含 [**LVIS \_ STATEIMAGEMASK**](list-view-item-states.md)值，而且 **狀態** 成員必須包含使用 [**INDEXTOSTATEIMAGEMASK**](/windows/desktop/api/Commctrl/nf-commctrl-indextostateimagemask)宏將左移12個位的狀態影像之以一為起始的索引。</span><span class="sxs-lookup"><span data-stu-id="359b1-372">To set an item's state image, the **stateMask** member of the [**LVITEM**](/windows/win32/api/commctrl/ns-commctrl-lvitema) structure must include the [**LVIS\_STATEIMAGEMASK**](list-view-item-states.md) value, and the **state** member must include the one-based index of the state image shifted left 12 bits by using the [**INDEXTOSTATEIMAGEMASK**](/windows/desktop/api/Commctrl/nf-commctrl-indextostateimagemask) macro.</span></span> <span data-ttu-id="359b1-373">索引可以是零，以指定無狀態影像。</span><span class="sxs-lookup"><span data-stu-id="359b1-373">The index can be zero to specify no state image.</span></span>

### <a name="callback-items-and-the-callback-mask"></a><span data-ttu-id="359b1-374">回呼項目和回呼遮罩</span><span class="sxs-lookup"><span data-stu-id="359b1-374">Callback Items and the Callback Mask</span></span>

<span data-ttu-id="359b1-375">針對每個專案，清單視圖控制項通常會儲存標籤文字、專案圖示的影像清單索引，以及專案狀態的一組位旗標。</span><span class="sxs-lookup"><span data-stu-id="359b1-375">For each of its items, a list-view control typically stores the label text, the image list index of the item's icons, and a set of bit flags for the item's state.</span></span> <span data-ttu-id="359b1-376">您可以定義回呼專案或變更控制項的回呼遮罩，以指出應用程式（而不是控制項）儲存部分或全部資訊。</span><span class="sxs-lookup"><span data-stu-id="359b1-376">You can define callback items or change the control's callback mask to indicate that the application, rather than the control, stores some or all of this information.</span></span> <span data-ttu-id="359b1-377">如果您的應用程式儲存其中一些資訊，您可能會想要使用回呼。</span><span class="sxs-lookup"><span data-stu-id="359b1-377">You might want to use callbacks if your application stores some of this information.</span></span>

<span data-ttu-id="359b1-378">清單視圖控制項中的 *回呼專案* 是應用程式儲存文字或圖示索引的專案，或兩者。</span><span class="sxs-lookup"><span data-stu-id="359b1-378">A *callback item* in a list-view control is an item for which the application stores the text or icon index, or both.</span></span> <span data-ttu-id="359b1-379">您可以在傳送 [**LVM \_ INSERTITEM**](lvm-insertitem.md) 訊息時定義回呼專案，以將專案新增至清單視圖控制項。</span><span class="sxs-lookup"><span data-stu-id="359b1-379">You can define callback items when you send the [**LVM\_INSERTITEM**](lvm-insertitem.md) message to add an item to the list-view control.</span></span> <span data-ttu-id="359b1-380">如果應用程式儲存專案或子專案的文字，請將專案 [**LVITEM**](/windows/win32/api/commctrl/ns-commctrl-lvitema)結構的 **pszText** 成員設定為 **LPSTR \_ TEXTCALLBACK**。</span><span class="sxs-lookup"><span data-stu-id="359b1-380">If the application stores the text for the item or subitem, set the **pszText** member of the item's [**LVITEM**](/windows/win32/api/commctrl/ns-commctrl-lvitema) structure to **LPSTR\_TEXTCALLBACK**.</span></span> <span data-ttu-id="359b1-381">如果應用程式儲存專案的圖示索引，請將專案 **LVITEM** 結構的 **iImage** 成員設定為 **I \_ IMAGECALLBACK**。</span><span class="sxs-lookup"><span data-stu-id="359b1-381">If the application stores the icon index for an item, set the **iImage** member of the item's **LVITEM** structure to **I\_IMAGECALLBACK**.</span></span>

<span data-ttu-id="359b1-382">清單視圖控制項的 *回呼遮罩* 是一組位旗標，用來指定應用程式（而非控制項）儲存目前資料的專案狀態。</span><span class="sxs-lookup"><span data-stu-id="359b1-382">The *callback mask* of a list-view control is a set of bit flags that specify the item states for which the application, rather than the control, stores the current data.</span></span> <span data-ttu-id="359b1-383">回呼遮罩適用於所有控制項的項目，與套用至特定項目的回呼項目指定不同。</span><span class="sxs-lookup"><span data-stu-id="359b1-383">The callback mask applies to all of the control's items, unlike the callback item designation, which applies to a specific item.</span></span> <span data-ttu-id="359b1-384">回呼遮罩預設為零，表示清單視圖控制項會儲存所有專案狀態資訊。</span><span class="sxs-lookup"><span data-stu-id="359b1-384">The callback mask is zero by default, meaning that the list-view control stores all item state information.</span></span> <span data-ttu-id="359b1-385">建立清單視圖控制項並初始化其專案之後，您可以傳送 [**LVM \_ SETCALLBACKMASK**](lvm-setcallbackmask.md) 訊息來變更回呼遮罩。</span><span class="sxs-lookup"><span data-stu-id="359b1-385">After creating a list-view control and initializing its items, you can send the [**LVM\_SETCALLBACKMASK**](lvm-setcallbackmask.md) message to change the callback mask.</span></span> <span data-ttu-id="359b1-386">若要取得目前的回呼遮罩，請傳送 [**LVM \_ GETCALLBACKMASK**](lvm-getcallbackmask.md) 訊息。</span><span class="sxs-lookup"><span data-stu-id="359b1-386">To retrieve the current callback mask, send the [**LVM\_GETCALLBACKMASK**](lvm-getcallbackmask.md) message.</span></span>

<span data-ttu-id="359b1-387">當清單視圖控制項必須顯示或排序應用程式儲存回呼資訊的清單視圖專案時，控制項會將 [LVN \_ GETDISPINFO](lvn-getdispinfo.md) 通知程式碼傳送至控制項的父視窗。</span><span class="sxs-lookup"><span data-stu-id="359b1-387">When a list-view control must display or sort a list-view item for which the application stores callback information, the control sends the [LVN\_GETDISPINFO](lvn-getdispinfo.md) notification code to the control's parent window.</span></span> <span data-ttu-id="359b1-388">這則訊息會指定 [**NMLVDISPINFO**](/windows/win32/api/commctrl/ns-commctrl-nmlvdispinfoa) 結構，其中包含所需的資訊類型，並識別要取出的專案或子專案。</span><span class="sxs-lookup"><span data-stu-id="359b1-388">This message specifies an [**NMLVDISPINFO**](/windows/win32/api/commctrl/ns-commctrl-nmlvdispinfoa) structure that contains the type of information required and identifies the item or subitem to retrieve.</span></span> <span data-ttu-id="359b1-389">父視窗必須處理 LVN \_ GETDISPINFO，以提供所要求的資料。</span><span class="sxs-lookup"><span data-stu-id="359b1-389">The parent window must process LVN\_GETDISPINFO to provide the requested data.</span></span>

<span data-ttu-id="359b1-390">如果清單視圖控制項偵測到專案的回呼資訊中有變更，例如文字、圖示或狀態資訊的變更，控制項會傳送 [LVN \_ SETDISPINFO](lvn-setdispinfo.md) 通知碼來通知您變更。</span><span class="sxs-lookup"><span data-stu-id="359b1-390">If the list-view control detects a change in an item's callback information, such as a change in the text, icon, or state information, the control sends an [LVN\_SETDISPINFO](lvn-setdispinfo.md) notification code to notify you of the change.</span></span>

<span data-ttu-id="359b1-391">如果您變更回呼專案的屬性或狀態位，則會使用 [**LVM \_ 更新**](lvm-update.md) 訊息來強制控制項重新繪製專案。</span><span class="sxs-lookup"><span data-stu-id="359b1-391">If you change a callback item's attributes or state bits, you use the [**LVM\_UPDATE**](lvm-update.md) message to force the control to repaint the item.</span></span> <span data-ttu-id="359b1-392">此訊息也會讓控制項在有 [**lvs) \_ AUTOARRANGE**](list-view-window-styles.md) 樣式時排列其專案。</span><span class="sxs-lookup"><span data-stu-id="359b1-392">This message also causes the control to arrange its items if it has the [**LVS\_AUTOARRANGE**](list-view-window-styles.md) style.</span></span> <span data-ttu-id="359b1-393">您可以使用 [**LVM \_ REDRAWITEMS**](lvm-redrawitems.md) 訊息來使清單-view 控制項工作區的對應部分失效，以重繪某範圍的專案。</span><span class="sxs-lookup"><span data-stu-id="359b1-393">You can use the [**LVM\_REDRAWITEMS**](lvm-redrawitems.md) message to redraw a range of items by invalidating the corresponding portions of the list-view control's client area.</span></span>

<span data-ttu-id="359b1-394">藉由有效使用回呼專案和回呼遮罩，您可以確保每個專案屬性只能在一個位置進行維護。</span><span class="sxs-lookup"><span data-stu-id="359b1-394">By effectively using callback items and the callback mask, you can ensure that each item attribute is maintained in only one place.</span></span> <span data-ttu-id="359b1-395">這麼做可以簡化您的應用程式，但唯一儲存的空間是儲存專案標籤和子專案文字所需的記憶體。</span><span class="sxs-lookup"><span data-stu-id="359b1-395">Doing this can simplify your application, but the only space saved is the memory that would otherwise be required to store item labels and subitem text.</span></span>

### <a name="list-view-item-position"></a><span data-ttu-id="359b1-396">List-View 專案位置</span><span class="sxs-lookup"><span data-stu-id="359b1-396">List-View Item Position</span></span>

<span data-ttu-id="359b1-397">每個清單視圖專案都有一個位置和大小，您可以使用訊息來取得和設定。</span><span class="sxs-lookup"><span data-stu-id="359b1-397">Every list-view item has a position and size, which you can retrieve and set using messages.</span></span> <span data-ttu-id="359b1-398">您也可以判斷哪一個專案在指定的位置（如果有的話）。</span><span class="sxs-lookup"><span data-stu-id="359b1-398">You can also determine which item, if any, is at a specified position.</span></span> <span data-ttu-id="359b1-399">清單視圖專案的位置會指定在 *view 座標* 中，這是由捲軸位置位移的用戶端座標。</span><span class="sxs-lookup"><span data-stu-id="359b1-399">The position of list-view items is specified in *view coordinates*, which are client coordinates offset by the scroll position.</span></span>

<span data-ttu-id="359b1-400">若要取出並設定專案的位置，請使用 [**lvm \_ GETITEMPOSITION**](lvm-getitemposition.md) 和 [**lvm \_ SETITEMPOSITION**](lvm-setitemposition.md) 訊息。</span><span class="sxs-lookup"><span data-stu-id="359b1-400">To retrieve and set an item's position, use the [**LVM\_GETITEMPOSITION**](lvm-getitemposition.md) and [**LVM\_SETITEMPOSITION**](lvm-setitemposition.md) messages.</span></span> <span data-ttu-id="359b1-401">**LVM \_GETITEMPOSITION** 適用于所有視圖，但 **LVM \_ SETITEMPOSITION** 只適用于圖示和小型圖示視圖。</span><span class="sxs-lookup"><span data-stu-id="359b1-401">**LVM\_GETITEMPOSITION** works for all views, but **LVM\_SETITEMPOSITION** works only for icon and small icon views.</span></span>

<span data-ttu-id="359b1-402">您可以使用 [**LVM \_ system.windows.media.visualtreehelper.hittest**](lvm-hittest.md) 訊息來判斷哪個專案（如果有的話）是在特定位置。</span><span class="sxs-lookup"><span data-stu-id="359b1-402">You can determine which item, if any, is at a particular location by using the [**LVM\_HITTEST**](lvm-hittest.md) message.</span></span>

<span data-ttu-id="359b1-403">若要抓取清單專案的周框，或僅針對其圖示或標籤取得周框，請使用 [**LVM \_ GETITEMRECT**](lvm-getitemrect.md) 訊息。</span><span class="sxs-lookup"><span data-stu-id="359b1-403">To retrieve the bounding rectangle for a list item or only for its icon or label, use the [**LVM\_GETITEMRECT**](lvm-getitemrect.md) message.</span></span>

### <a name="arranging-sorting-and-finding-items"></a><span data-ttu-id="359b1-404">排列、排序和尋找專案</span><span class="sxs-lookup"><span data-stu-id="359b1-404">Arranging, Sorting, and Finding Items</span></span>

<span data-ttu-id="359b1-405">您可以使用清單視圖訊息來排列和排序專案，以及根據專案的屬性或位置來尋找專案。</span><span class="sxs-lookup"><span data-stu-id="359b1-405">You can use list-view messages to arrange and sort items and to find items based on their attributes or positions.</span></span> <span data-ttu-id="359b1-406">排列重新置放專案以對齊格線，但專案的索引不會變更。</span><span class="sxs-lookup"><span data-stu-id="359b1-406">Arranging repositions items to align on a grid, but the indexes of the items do not change.</span></span> <span data-ttu-id="359b1-407">排序會變更 (的專案順序及其對應的索引) ，然後據此重新置放。</span><span class="sxs-lookup"><span data-stu-id="359b1-407">Sorting changes the sequence of items (and their corresponding indexes) and then repositions them accordingly.</span></span> <span data-ttu-id="359b1-408">您只能在圖示和小型圖示視圖中排列專案，但是您可以在任何視圖中排序專案。</span><span class="sxs-lookup"><span data-stu-id="359b1-408">You can arrange items only in icon and small icon views, but you can sort items in any view.</span></span> <span data-ttu-id="359b1-409">若要尋找專案，請傳送可指定專案位置或屬性的清單視圖訊息。</span><span class="sxs-lookup"><span data-stu-id="359b1-409">To find items, you send list-view messages that specify an item location or property.</span></span>

<span data-ttu-id="359b1-410">若要排列專案，請使用 [**LVM \_ 排列**](lvm-arrange.md) 訊息。</span><span class="sxs-lookup"><span data-stu-id="359b1-410">To arrange items, use the [**LVM\_ARRANGE**](lvm-arrange.md) message.</span></span> <span data-ttu-id="359b1-411">您可以藉由指定 [ [**lvs) \_ AUTOARRANGE**](list-view-window-styles.md) ] 視窗樣式，確保每次都能排列專案。</span><span class="sxs-lookup"><span data-stu-id="359b1-411">You can ensure that items are arranged at all times by specifying the [**LVS\_AUTOARRANGE**](list-view-window-styles.md) window style.</span></span>

<span data-ttu-id="359b1-412">若要排序專案，請使用 [**LVM \_ SORTITEMS**](lvm-sortitems.md) 訊息。</span><span class="sxs-lookup"><span data-stu-id="359b1-412">To sort items, use the [**LVM\_SORTITEMS**](lvm-sortitems.md) message.</span></span> <span data-ttu-id="359b1-413">當您使用這個訊息進行排序時，您會指定一個應用程式定義的回呼函式，以供清單視圖控制項呼叫來比較任何兩個專案的相對順序。</span><span class="sxs-lookup"><span data-stu-id="359b1-413">When you sort using this message, you specify an application-defined callback function that the list-view control calls to compare the relative order of any two items.</span></span> <span data-ttu-id="359b1-414">控制項會將與這兩個專案相關聯的專案資料傳遞給比較函數。</span><span class="sxs-lookup"><span data-stu-id="359b1-414">The control passes to the comparison function the item data associated with each of the two items.</span></span> <span data-ttu-id="359b1-415">專案資料是將專案插入清單中時，在專案的 [**LVITEM**](/windows/win32/api/commctrl/ns-commctrl-lvitema)結構的 **lParam** 成員中指定的值。</span><span class="sxs-lookup"><span data-stu-id="359b1-415">The item data is the value that was specified in the **lParam** member of the item's [**LVITEM**](/windows/win32/api/commctrl/ns-commctrl-lvitema) structure when it was inserted into the list.</span></span> <span data-ttu-id="359b1-416">藉由指定適當的專案資料並提供適當的比較函式，您可以依標籤、任何子專案或任何其他屬性來排序專案。</span><span class="sxs-lookup"><span data-stu-id="359b1-416">By specifying the appropriate item data and supplying an appropriate comparison function, you can sort items by their label, by any subitem, or by any other property.</span></span> <span data-ttu-id="359b1-417">請注意，排序專案不會重新排列對應的子專案。</span><span class="sxs-lookup"><span data-stu-id="359b1-417">Note that sorting items does not reorder the corresponding subitems.</span></span> <span data-ttu-id="359b1-418">重新排序專案時，會將專案與其對應的子專案一起攜帶;也就是說，整個資料列會保持在一起。</span><span class="sxs-lookup"><span data-stu-id="359b1-418">When items are reordered, their corresponding subitems are carried with them; that is, whole rows are kept together.</span></span> <span data-ttu-id="359b1-419">若要個別排序資料行，請從其專案卸離子專案，您必須在使用 [**LVM \_ SETITEM**](lvm-setitem.md)排序之後重新產生資料行。</span><span class="sxs-lookup"><span data-stu-id="359b1-419">To order the columns separately from one another, detaching the subitems from their items, you must regenerate the columns after sorting using [**LVM\_SETITEM**](lvm-setitem.md).</span></span>

<span data-ttu-id="359b1-420">您可以藉由指定 [ [**lvs) \_ SORTASCENDING**](list-view-window-styles.md) ] 或 [ [**lvs) \_ SORTDESCENDING**](list-view-window-styles.md) ] 視窗樣式，確保一律會排序清單視圖控制項。</span><span class="sxs-lookup"><span data-stu-id="359b1-420">You can ensure that a list-view control is always sorted by specifying the [**LVS\_SORTASCENDING**](list-view-window-styles.md) or [**LVS\_SORTDESCENDING**](list-view-window-styles.md) window style.</span></span> <span data-ttu-id="359b1-421">具有這些樣式的控制項會使用專案的標籤文字，以遞增或遞減順序排序。</span><span class="sxs-lookup"><span data-stu-id="359b1-421">Controls with these styles use the label text of the items to sort them in ascending or descending order.</span></span> <span data-ttu-id="359b1-422">使用這些視窗樣式時，不能提供比較函數。</span><span class="sxs-lookup"><span data-stu-id="359b1-422">You cannot supply a comparison function when using these window styles.</span></span> <span data-ttu-id="359b1-423">如果清單視圖控制項有其中一種樣式，則如果您嘗試插入具有 **LPSTR \_ TEXTCALLBACK** 的專案做為其 [**LVITEM**](/windows/win32/api/commctrl/ns-commctrl-lvitema)結構的 **pszText** 成員， [**LVM \_ INSERTITEM**](lvm-insertitem.md)訊息將會失敗。</span><span class="sxs-lookup"><span data-stu-id="359b1-423">If a list-view control has either of these styles, an [**LVM\_INSERTITEM**](lvm-insertitem.md) message will fail if you try to insert an item that has **LPSTR\_TEXTCALLBACK** as the **pszText** member of its [**LVITEM**](/windows/win32/api/commctrl/ns-commctrl-lvitema) structure.</span></span>

<span data-ttu-id="359b1-424">您可以使用 [**LVM \_ FINDITEM**](lvm-finditem.md) 訊息，尋找具有特定屬性的清單視圖專案。</span><span class="sxs-lookup"><span data-stu-id="359b1-424">You can find a list-view item with specific properties by using the [**LVM\_FINDITEM**](lvm-finditem.md) message.</span></span> <span data-ttu-id="359b1-425">您可以使用 [**LVM \_ GETNEXTITEM**](lvm-getnextitem.md) 訊息，找到處于指定狀態且與指定專案具有指定之關聯性的清單視圖專案。</span><span class="sxs-lookup"><span data-stu-id="359b1-425">You can find a list-view item that is in a specified state and has a specified relationship to a given item by using the [**LVM\_GETNEXTITEM**](lvm-getnextitem.md) message.</span></span> <span data-ttu-id="359b1-426">例如，您可以取出指定專案右邊的下一個選取專案。</span><span class="sxs-lookup"><span data-stu-id="359b1-426">For example, you can retrieve the next selected item to the right of a specified item.</span></span>

## <a name="list-view-columns"></a><span data-ttu-id="359b1-427">List-View 資料行</span><span class="sxs-lookup"><span data-stu-id="359b1-427">List-View Columns</span></span>

<span data-ttu-id="359b1-428">資料行控制專案和其子專案在報表檢視中的顯示方式。</span><span class="sxs-lookup"><span data-stu-id="359b1-428">Columns control the way items and their subitems are displayed in report view.</span></span> <span data-ttu-id="359b1-429">每個資料行都有標題和寬度，並與特定子專案相關聯;子項零是專案的圖示和標籤。</span><span class="sxs-lookup"><span data-stu-id="359b1-429">Each column has a title and width and is associated with a specific subitem; subitem zero is the item's icon and label.</span></span> <span data-ttu-id="359b1-430">資料行的屬性是由 [**LVCOLUMN**](/windows/win32/api/commctrl/ns-commctrl-lvcolumna) 結構所定義。</span><span class="sxs-lookup"><span data-stu-id="359b1-430">The attributes of a column are defined by an [**LVCOLUMN**](/windows/win32/api/commctrl/ns-commctrl-lvcolumna) structure.</span></span>

<span data-ttu-id="359b1-431">若要將資料行新增至清單視圖控制項，請使用 [**LVM \_ INSERTCOLUMN**](lvm-insertcolumn.md) 訊息。</span><span class="sxs-lookup"><span data-stu-id="359b1-431">To add a column to a list-view control, use the [**LVM\_INSERTCOLUMN**](lvm-insertcolumn.md) message.</span></span> <span data-ttu-id="359b1-432">若要刪除資料行，請使用 [**LVM \_ DELETECOLUMN**](lvm-deletecolumn.md) 訊息。</span><span class="sxs-lookup"><span data-stu-id="359b1-432">To delete a column, use the [**LVM\_DELETECOLUMN**](lvm-deletecolumn.md) message.</span></span>

> [!Note]  
> <span data-ttu-id="359b1-433">只有 ComCtl32.dll 6 版和更新版本才支援刪除清單視圖控制項中的資料行零。</span><span class="sxs-lookup"><span data-stu-id="359b1-433">Deleting column zero of a list-view control is supported only in ComCtl32.dll version 6 and later.</span></span> <span data-ttu-id="359b1-434">第5版也支援刪除資料行零，但只有在您使用 [**CCM \_ SETVERSION**](ccm-setversion.md) 將版本設定為5或更新版本之後。</span><span class="sxs-lookup"><span data-stu-id="359b1-434">Version 5 also supports deleting column zero, but only after you use [**CCM\_SETVERSION**](ccm-setversion.md) to set the version to 5 or later.</span></span> <span data-ttu-id="359b1-435">第5版之前的版本不支援刪除資料行0。</span><span class="sxs-lookup"><span data-stu-id="359b1-435">Versions prior to version 5 do not support deleting column zero.</span></span>

 

<span data-ttu-id="359b1-436">您可以使用 [**lvm \_ GETCOLUMN**](lvm-getcolumn.md) 和 [**lvm \_ SETCOLUMN**](lvm-setcolumn.md) 訊息來取得和變更現有資料行的屬性。</span><span class="sxs-lookup"><span data-stu-id="359b1-436">You can retrieve and change the properties of an existing column by using the [**LVM\_GETCOLUMN**](lvm-getcolumn.md) and [**LVM\_SETCOLUMN**](lvm-setcolumn.md) messages.</span></span> <span data-ttu-id="359b1-437">若要取出或變更資料行的寬度，請使用 [**lvm \_ GETCOLUMNWIDTH**](lvm-getcolumnwidth.md) 和 [**lvm \_ SETCOLUMNWIDTH**](lvm-setcolumnwidth.md) 訊息。</span><span class="sxs-lookup"><span data-stu-id="359b1-437">To retrieve or change a column's width, use the [**LVM\_GETCOLUMNWIDTH**](lvm-getcolumnwidth.md) and [**LVM\_SETCOLUMNWIDTH**](lvm-setcolumnwidth.md) messages.</span></span>

<span data-ttu-id="359b1-438">除非指定了 [**lvs) \_ NOCOLUMNHEADER**](list-view-window-styles.md) 視窗樣式，否則資料行標頭會出現在報表檢視中。</span><span class="sxs-lookup"><span data-stu-id="359b1-438">Unless the [**LVS\_NOCOLUMNHEADER**](list-view-window-styles.md) window style is specified, column headers appear in report view.</span></span> <span data-ttu-id="359b1-439">使用者可以按一下資料行標頭，使 [**LVN \_ COLUMNCLICK**](lvn-columnclick.md) 通知碼傳送至父視窗。</span><span class="sxs-lookup"><span data-stu-id="359b1-439">The user can click a column header, causing an [**LVN\_COLUMNCLICK**](lvn-columnclick.md) notification code to be sent to the parent window.</span></span> <span data-ttu-id="359b1-440">一般情況下，父視窗會在按一下時，依指定的資料行排序清單視圖控制項。</span><span class="sxs-lookup"><span data-stu-id="359b1-440">Typically, the parent window sorts the list-view control by the specified column when this clicking occurs.</span></span> <span data-ttu-id="359b1-441">使用者也可以拖曳標頭之間的資料行輔助線來調整資料行的大小。</span><span class="sxs-lookup"><span data-stu-id="359b1-441">The user can also drag the column guides between the headers to size the columns.</span></span>

<span data-ttu-id="359b1-442">清單視圖控制項可以顯示資料行標題旁的影像。</span><span class="sxs-lookup"><span data-stu-id="359b1-442">List-view controls can display images next to column titles.</span></span> <span data-ttu-id="359b1-443">若要執行這項功能，請指定 **LVCF \_ 影像** 值，並將影像的索引指派給 [**LVCOLUMN**](/windows/win32/api/commctrl/ns-commctrl-lvcolumna)結構中的 **iImage** 成員。</span><span class="sxs-lookup"><span data-stu-id="359b1-443">To implement this feature, specify the **LVCF\_IMAGE** value and assign the index of the image to the **iImage** member in the [**LVCOLUMN**](/windows/win32/api/commctrl/ns-commctrl-lvcolumna) structure.</span></span>

<span data-ttu-id="359b1-444">清單視圖控制項可以設定顯示資料行的順序。</span><span class="sxs-lookup"><span data-stu-id="359b1-444">List-view controls can set the order in which columns are displayed.</span></span> <span data-ttu-id="359b1-445">若要執行這項功能，請指定 **LVCF \_ 順序** 值，並將資料行順序指派給 [**LVCOLUMN**](/windows/win32/api/commctrl/ns-commctrl-lvcolumna)結構中的 **iOrder** 成員。</span><span class="sxs-lookup"><span data-stu-id="359b1-445">To implement this feature, specify the **LVCF\_ORDER** value and assign the column order to the **iOrder** member in the [**LVCOLUMN**](/windows/win32/api/commctrl/ns-commctrl-lvcolumna) structure.</span></span> <span data-ttu-id="359b1-446">資料行順序是以零為基底，而且是由左至右的順序。</span><span class="sxs-lookup"><span data-stu-id="359b1-446">The column order is zero-based and is in left-to-right order.</span></span> <span data-ttu-id="359b1-447">例如，零表示最左邊的資料行。</span><span class="sxs-lookup"><span data-stu-id="359b1-447">For example, zero indicates the leftmost column.</span></span>

## <a name="list-view-scroll-position"></a><span data-ttu-id="359b1-448">List-View 捲軸位置</span><span class="sxs-lookup"><span data-stu-id="359b1-448">List-View Scroll Position</span></span>

<span data-ttu-id="359b1-449">除非指定了 [ [**lvs) \_ NOSCROLL**](list-view-window-styles.md) ] 視窗樣式，否則清單視圖控制項可滾動顯示超過控制項工作區所能容納的專案。</span><span class="sxs-lookup"><span data-stu-id="359b1-449">Unless the [**LVS\_NOSCROLL**](list-view-window-styles.md) window style is specified, a list-view control can be scrolled to show more items than can fit in the client area of the control.</span></span> <span data-ttu-id="359b1-450">您可以抓取清單視圖控制項的滾動位置和相關資訊、依指定的數量來滾動清單視圖控制項，或滾動清單視圖控制項，以顯示指定的清單專案。</span><span class="sxs-lookup"><span data-stu-id="359b1-450">You can retrieve a list-view control's scroll position and related information, scroll a list-view control by a specified amount, or scroll a list-view control so that a specified list item is visible.</span></span>

<span data-ttu-id="359b1-451">在圖示視圖或小型圖示視圖中，目前的捲軸位置是由 *視圖來源* 所定義。</span><span class="sxs-lookup"><span data-stu-id="359b1-451">In icon view or small icon view, the current scroll position is defined by the *view origin*.</span></span> <span data-ttu-id="359b1-452">視圖來源是相對於清單視圖控制項可見區域的座標集合，對應于視圖座標 (0，0) 。</span><span class="sxs-lookup"><span data-stu-id="359b1-452">The view origin is the set of coordinates, relative to the visible area of the list-view control, that correspond to the view coordinates (0, 0).</span></span> <span data-ttu-id="359b1-453">若要取得目前的視圖來源，請使用 [**LVM \_ GETORIGIN**](lvm-getorigin.md) 訊息。</span><span class="sxs-lookup"><span data-stu-id="359b1-453">To retrieve the current view origin, use the [**LVM\_GETORIGIN**](lvm-getorigin.md) message.</span></span> <span data-ttu-id="359b1-454">此訊息只能用在圖示或小型圖示視圖中;它會在清單或報表檢視中傳回錯誤。</span><span class="sxs-lookup"><span data-stu-id="359b1-454">This message should be used only in icon or small icon view; it returns an error in list or report view.</span></span>

<span data-ttu-id="359b1-455">在清單或報表檢視中，目前的捲軸位置是由 *top 索引* 所定義。</span><span class="sxs-lookup"><span data-stu-id="359b1-455">In list or report view, the current scroll position is defined by the *top index*.</span></span> <span data-ttu-id="359b1-456">頂端索引是清單視圖控制項中第一個可見專案的索引。</span><span class="sxs-lookup"><span data-stu-id="359b1-456">The top index is the index of the first visible item in the list-view control.</span></span> <span data-ttu-id="359b1-457">若要取得目前的頂端索引，請使用 [**LVM \_ GETTOPINDEX**](lvm-gettopindex.md) 訊息。</span><span class="sxs-lookup"><span data-stu-id="359b1-457">To retrieve the current top index, use the [**LVM\_GETTOPINDEX**](lvm-gettopindex.md) message.</span></span> <span data-ttu-id="359b1-458">此訊息只會傳回清單或報表檢視中的有效結果;它會在圖示或小型圖示視圖中傳回零。</span><span class="sxs-lookup"><span data-stu-id="359b1-458">This message returns a valid result only in list or report view; it returns zero in icon or small icon view.</span></span>

<span data-ttu-id="359b1-459">您可以使用 [**LVM \_ GETVIEWRECT**](lvm-getviewrect.md) 訊息來取得清單視圖控制項中所有專案的周框（相對於控制項的可見區域）。</span><span class="sxs-lookup"><span data-stu-id="359b1-459">You can use the [**LVM\_GETVIEWRECT**](lvm-getviewrect.md) message to retrieve the bounding rectangle of all items in a list-view control, relative to the visible area of the control.</span></span>

<span data-ttu-id="359b1-460">[**LVM \_ GETCOUNTPERPAGE**](lvm-getcountperpage.md)訊息會傳回符合清單視圖控制項一頁的專案數。</span><span class="sxs-lookup"><span data-stu-id="359b1-460">The [**LVM\_GETCOUNTPERPAGE**](lvm-getcountperpage.md) message returns the number of items that fit in one page of the list-view control.</span></span> <span data-ttu-id="359b1-461">此訊息只會傳回清單和報表檢視中的有效結果;在圖示和小型圖示視圖中，它會傳回專案的總數。</span><span class="sxs-lookup"><span data-stu-id="359b1-461">This message returns a valid result only in list and report views; in icon and small icon views, it returns the total number of items.</span></span>

<span data-ttu-id="359b1-462">若要依特定數量滾動清單視圖控制項，請使用 [**LVM \_ 滾動**](lvm-scroll.md) 條訊息。</span><span class="sxs-lookup"><span data-stu-id="359b1-462">To scroll a list-view control by a specific amount, use the [**LVM\_SCROLL**](lvm-scroll.md) message.</span></span> <span data-ttu-id="359b1-463">使用 [**LVM \_ ENSUREVISIBLE**](lvm-ensurevisible.md) 訊息時，您可以視需要滾動清單視圖控制項，以確保可以看見指定的專案。</span><span class="sxs-lookup"><span data-stu-id="359b1-463">Using the [**LVM\_ENSUREVISIBLE**](lvm-ensurevisible.md) message, you can scroll the list-view control, if necessary, to ensure that a specified item is visible.</span></span>

## <a name="list-view-label-editing"></a><span data-ttu-id="359b1-464">List-View 標籤編輯</span><span class="sxs-lookup"><span data-stu-id="359b1-464">List-View Label Editing</span></span>

<span data-ttu-id="359b1-465">具有 [ [**lvs) \_ EDITLABELS**](list-view-window-styles.md) ] 視窗樣式的清單視圖控制項，可讓使用者就地編輯專案標籤。</span><span class="sxs-lookup"><span data-stu-id="359b1-465">A list-view control that has the [**LVS\_EDITLABELS**](list-view-window-styles.md) window style enables a user to edit item labels in place.</span></span> <span data-ttu-id="359b1-466">使用者可以按一下具有焦點之專案的標籤來開始編輯。</span><span class="sxs-lookup"><span data-stu-id="359b1-466">The user begins editing by clicking the label of an item that has the focus.</span></span> <span data-ttu-id="359b1-467">或者，應用程式可以使用 [**LVM \_ EDITLABEL**](lvm-editlabel.md) 訊息自動開始編輯。</span><span class="sxs-lookup"><span data-stu-id="359b1-467">Alternatively, an application can begin editing automatically by using the [**LVM\_EDITLABEL**](lvm-editlabel.md) message.</span></span> <span data-ttu-id="359b1-468">當編輯開始以及取消或完成時，清單視圖控制項會通知父視窗。</span><span class="sxs-lookup"><span data-stu-id="359b1-468">The list-view control notifies the parent window when editing begins and when it is canceled or completed.</span></span> <span data-ttu-id="359b1-469">編輯完成時，父視窗會負責更新專案的標籤（如果有的話）。</span><span class="sxs-lookup"><span data-stu-id="359b1-469">When editing is completed, the parent window is responsible for updating the item's label, if appropriate.</span></span>

<span data-ttu-id="359b1-470">當標籤編輯開始時，會建立、定位和初始化 [編輯控制項](edit-controls.md) 。</span><span class="sxs-lookup"><span data-stu-id="359b1-470">When label editing begins, an [edit control](edit-controls.md) is created, positioned, and initialized.</span></span> <span data-ttu-id="359b1-471">在顯示之前，清單視圖控制項會將 [LVN \_ BEGINLABELEDIT](lvn-beginlabeledit.md) 通知程式碼傳送給其父視窗。</span><span class="sxs-lookup"><span data-stu-id="359b1-471">Before it is displayed, the list-view control sends its parent window an [LVN\_BEGINLABELEDIT](lvn-beginlabeledit.md) notification code.</span></span> <span data-ttu-id="359b1-472">如果您需要修改標籤編輯程式，可以執行此通知的處理常式。</span><span class="sxs-lookup"><span data-stu-id="359b1-472">If you need to modify the label editing process, you can implement a handler for this notification.</span></span>

<span data-ttu-id="359b1-473">[LVN \_ BEGINLABELEDIT](lvn-beginlabeledit.md)通知處理常式的其中一個用途是控制使用者可以編輯的標籤。</span><span class="sxs-lookup"><span data-stu-id="359b1-473">One use for an [LVN\_BEGINLABELEDIT](lvn-beginlabeledit.md) notification handler is to control which labels the user can edit.</span></span> <span data-ttu-id="359b1-474">若要防止編輯標籤，請傳回非零值。</span><span class="sxs-lookup"><span data-stu-id="359b1-474">To prevent label editing, return a nonzero value.</span></span> <span data-ttu-id="359b1-475">若要自訂標籤編輯，請將 [**LVM \_ GETEDITCONTROL**](lvm-geteditcontrol.md) 訊息傳送至清單視圖控制項，讓通知處理常式取出編輯控制項的控制碼。</span><span class="sxs-lookup"><span data-stu-id="359b1-475">To customize label editing, have the notification handler retrieve a handle to the edit control by sending an [**LVM\_GETEDITCONTROL**](lvm-geteditcontrol.md) message to the list-view control.</span></span> <span data-ttu-id="359b1-476">有了該控制碼之後，您就可以傳送一般的 EM XXX 訊息來自訂編輯控制項 \_ 。</span><span class="sxs-lookup"><span data-stu-id="359b1-476">Once you have that handle, you can customize the edit control by sending the usual EM\_XXX messages.</span></span> <span data-ttu-id="359b1-477">比方說，若要限制使用者可以輸入的文字數量，請將編輯控制項傳送給 [**EM \_ LIMITTEXT**](em-limittext.md) 訊息。</span><span class="sxs-lookup"><span data-stu-id="359b1-477">For instance, to limit the amount of text a user can enter, send the edit control an [**EM\_LIMITTEXT**](em-limittext.md) message.</span></span> <span data-ttu-id="359b1-478">您可以使用 [**SetWindowText**](/windows/desktop/api/winuser/nf-winuser-setwindowtexta)來變更編輯控制項的預設文字。</span><span class="sxs-lookup"><span data-stu-id="359b1-478">You can change the edit control's default text with [**SetWindowText**](/windows/desktop/api/winuser/nf-winuser-setwindowtexta).</span></span> <span data-ttu-id="359b1-479">您甚至可以將編輯控制項設為子類別，以攔截並捨棄不正確字元。</span><span class="sxs-lookup"><span data-stu-id="359b1-479">You can even subclass the edit control to intercept and discard invalid characters.</span></span>

<span data-ttu-id="359b1-480">當標籤編輯遭到取消或完成時，清單視圖控制項會將 [LVN \_ ENDLABELEDIT](lvn-endlabeledit.md) 通知程式碼傳送給其父視窗。</span><span class="sxs-lookup"><span data-stu-id="359b1-480">When label editing is canceled or completed, a list-view control sends its parent window an [LVN\_ENDLABELEDIT](lvn-endlabeledit.md) notification code.</span></span> <span data-ttu-id="359b1-481">*LParam* 參數是 [**NMLVDISPINFO**](/windows/win32/api/commctrl/ns-commctrl-nmlvdispinfoa)結構的位址。</span><span class="sxs-lookup"><span data-stu-id="359b1-481">The *lParam* parameter is the address of an [**NMLVDISPINFO**](/windows/win32/api/commctrl/ns-commctrl-nmlvdispinfoa) structure.</span></span> <span data-ttu-id="359b1-482">此結構的 **專案** 成員是 [**LVITEM**](/windows/win32/api/commctrl/ns-commctrl-lvitema) 結構，其 **iItem** 成員會識別該專案。</span><span class="sxs-lookup"><span data-stu-id="359b1-482">The **item** member of this structure is an [**LVITEM**](/windows/win32/api/commctrl/ns-commctrl-lvitema) structure whose **iItem** member identifies the item.</span></span> <span data-ttu-id="359b1-483">如果取消編輯，則 **LVITEM** 結構的 **PszText** 成員為 **Null**;否則， **pszText** 是已編輯文字的位址。</span><span class="sxs-lookup"><span data-stu-id="359b1-483">If editing is canceled, the **pszText** member of the **LVITEM** structure is **NULL**; otherwise, **pszText** is the address of the edited text.</span></span> <span data-ttu-id="359b1-484">如果要保留新的標籤，父視窗會負責更新專案的標籤。</span><span class="sxs-lookup"><span data-stu-id="359b1-484">The parent window is responsible for updating the item's label if it wants to keep the new label.</span></span>

## <a name="list-view-colors"></a><span data-ttu-id="359b1-485">List-View 色彩</span><span class="sxs-lookup"><span data-stu-id="359b1-485">List-View Colors</span></span>

<span data-ttu-id="359b1-486">應用程式可以針對清單視圖控制項，取得並設定三種色彩。</span><span class="sxs-lookup"><span data-stu-id="359b1-486">An application can retrieve and set three colors for a list-view control.</span></span>



| <span data-ttu-id="359b1-487">Color</span><span class="sxs-lookup"><span data-stu-id="359b1-487">Color</span></span>                   | <span data-ttu-id="359b1-488">用來取得和設定色彩的訊息</span><span class="sxs-lookup"><span data-stu-id="359b1-488">Messages used to retrieve and set colors</span></span>                                                             |
|-------------------------|------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="359b1-489">文字色彩</span><span class="sxs-lookup"><span data-stu-id="359b1-489">Text color</span></span>              | <span data-ttu-id="359b1-490">[**LVM \_GETTEXTCOLOR**](lvm-gettextcolor.md)， [ **LVM \_ SETTEXTCOLOR**](lvm-settextcolor.md)</span><span class="sxs-lookup"><span data-stu-id="359b1-490">[**LVM\_GETTEXTCOLOR**](lvm-gettextcolor.md), [**LVM\_SETTEXTCOLOR**](lvm-settextcolor.md)</span></span>         |
| <span data-ttu-id="359b1-491">文字背景色彩</span><span class="sxs-lookup"><span data-stu-id="359b1-491">Text background color</span></span>   | <span data-ttu-id="359b1-492">[**LVM \_GETTEXTBKCOLOR**](lvm-gettextbkcolor.md)， [ **LVM \_ SETTEXTBKCOLOR**](lvm-settextbkcolor.md)</span><span class="sxs-lookup"><span data-stu-id="359b1-492">[**LVM\_GETTEXTBKCOLOR**](lvm-gettextbkcolor.md), [**LVM\_SETTEXTBKCOLOR**](lvm-settextbkcolor.md)</span></span> |
| <span data-ttu-id="359b1-493">視窗背景色彩</span><span class="sxs-lookup"><span data-stu-id="359b1-493">Window background color</span></span> | <span data-ttu-id="359b1-494">[**LVM \_GETBKCOLOR**](lvm-getbkcolor.md)， [ **LVM \_ SETBKCOLOR**](lvm-setbkcolor.md)</span><span class="sxs-lookup"><span data-stu-id="359b1-494">[**LVM\_GETBKCOLOR**](lvm-getbkcolor.md), [**LVM\_SETBKCOLOR**](lvm-setbkcolor.md)</span></span>                 |



 

<span data-ttu-id="359b1-495">若要更明顯地自訂清單視圖控制項的外觀，請使用 [NM \_ CUSTOMDRAW (清單視圖) ](nm-customdraw-list-view.md) 或使用視覺化樣式 (查看 [視覺化樣式](themes-overview.md) 和 [啟用視覺化樣式](cookbook-overview.md)) 。</span><span class="sxs-lookup"><span data-stu-id="359b1-495">To customize the appearance of a list-view control more significantly, use [NM\_CUSTOMDRAW (list view)](nm-customdraw-list-view.md) or use visual styles (see [Visual Styles](themes-overview.md) and [Enabling Visual Styles](cookbook-overview.md)).</span></span>

## <a name="arranging-list-items-by-group"></a><span data-ttu-id="359b1-496">依群組排列清單專案</span><span class="sxs-lookup"><span data-stu-id="359b1-496">Arranging List Items by Group</span></span>

<span data-ttu-id="359b1-497">清單視圖控制項的群組功能可讓您以視覺化方式將相關的專案集合分組。</span><span class="sxs-lookup"><span data-stu-id="359b1-497">The grouping features of the list-view control enable you to visually group logically related sets of items.</span></span> <span data-ttu-id="359b1-498">您可以根據專案屬性、屬性或其他特性來建立群組。</span><span class="sxs-lookup"><span data-stu-id="359b1-498">Groups can be created based on item properties, attributes, or other characteristics.</span></span> <span data-ttu-id="359b1-499">這些群組通常會以包含群組名稱的水準標頭在螢幕上分隔。</span><span class="sxs-lookup"><span data-stu-id="359b1-499">These groups are typically separated on the screen by a horizontal header that contains the name of the group.</span></span> <span data-ttu-id="359b1-500">下列螢幕擷取畫面顯示群組專案。</span><span class="sxs-lookup"><span data-stu-id="359b1-500">The following screen shot shows grouped items.</span></span>

![清單視圖控制項的螢幕擷取畫面，其中有一個群組中的狗和另一個群組中的貓](images/lv-groups.png)

<span data-ttu-id="359b1-502">您可以使用 [**LVGROUP**](/windows/win32/api/commctrl/ns-commctrl-lvgroup) 結構來儲存有關群組的資訊，例如頁首和頁尾文字、群組的目前狀態等等。</span><span class="sxs-lookup"><span data-stu-id="359b1-502">You use the [**LVGROUP**](/windows/win32/api/commctrl/ns-commctrl-lvgroup) structure to store information about a group, such as the header and footer text, the current state of the group, and so on.</span></span> <span data-ttu-id="359b1-503">群組 API 包含的訊息可讓您藉由將專案新增至群組、將群組新增至視圖、排序群組專案，以及查詢專案大小和其他資訊的群組，來管理群組和群組元素。</span><span class="sxs-lookup"><span data-stu-id="359b1-503">The grouping API includes messages that enable you to manage groups and group elements by adding items to groups, adding groups to views, sorting group items, and querying groups for item size and other information.</span></span> <span data-ttu-id="359b1-504">例如，您可以使用 [ [**listview \_ SetGroupMetrics**](/windows/desktop/api/Commctrl/nf-commctrl-listview_setgroupmetrics) ] 和 [ [**listview \_ GetGroupMetrics**](/windows/desktop/api/Commctrl/nf-commctrl-listview_getgroupmetrics) 宏] 來設定和取出每個群組的顯示參數。</span><span class="sxs-lookup"><span data-stu-id="359b1-504">For example, you can set and retrieve display parameters for each group by using the [**ListView\_SetGroupMetrics**](/windows/desktop/api/Commctrl/nf-commctrl-listview_setgroupmetrics) and [**ListView\_GetGroupMetrics**](/windows/desktop/api/Commctrl/nf-commctrl-listview_getgroupmetrics) macros.</span></span>

<span data-ttu-id="359b1-505">群組可在清單視圖以外的所有視圖中使用。</span><span class="sxs-lookup"><span data-stu-id="359b1-505">Grouping is available in all views except list view.</span></span> <span data-ttu-id="359b1-506">它無法在具有 [**lvs) \_ OWNERDATA**](list-view-window-styles.md) 樣式的控制項上使用。</span><span class="sxs-lookup"><span data-stu-id="359b1-506">It is not available on controls that have the [**LVS\_OWNERDATA**](list-view-window-styles.md) style.</span></span>

<span data-ttu-id="359b1-507">如需詳細資訊，請參閱 [使用 List-View 控制項](using-list-view-controls.md)。</span><span class="sxs-lookup"><span data-stu-id="359b1-507">For more information, see [Using List-View Controls](using-list-view-controls.md).</span></span>

## <a name="insertion-marks"></a><span data-ttu-id="359b1-508">插入標記</span><span class="sxs-lookup"><span data-stu-id="359b1-508">Insertion Marks</span></span>

<span data-ttu-id="359b1-509">插入標記會顯示將放置拖曳專案的使用者。</span><span class="sxs-lookup"><span data-stu-id="359b1-509">Insertion marks show users where dragged items will be placed.</span></span> <span data-ttu-id="359b1-510">當使用者將專案拖曳到 [ **開始** ] 功能表或快速啟動 bar 時，目前會顯示插入標記。</span><span class="sxs-lookup"><span data-stu-id="359b1-510">Insertion marks currently display when the user drags an item into the **Start** menu or Quick Launch bar.</span></span> <span data-ttu-id="359b1-511">插入標記也適用于設定為 autoarrange 的清單。</span><span class="sxs-lookup"><span data-stu-id="359b1-511">The insertion mark also works for lists that are set to autoarrange.</span></span> <span data-ttu-id="359b1-512">當使用者將項目拖曳至另外兩個項目之間的某個點時，插入標記會顯示該項目的預期新位置。</span><span class="sxs-lookup"><span data-stu-id="359b1-512">When a user drags an item to a point between two other items, the insertion mark shows the item's expected new location.</span></span> <span data-ttu-id="359b1-513">下列螢幕擷取畫面顯示插入標記。</span><span class="sxs-lookup"><span data-stu-id="359b1-513">The following screen shot shows an insertion mark.</span></span>

![在清單視圖控制項中，于兩個其他兩個檔案之間拖曳一個檔案時，顯示插入標記的螢幕擷取畫面](images/insertmark.png)

<span data-ttu-id="359b1-515">插入標記 API 專案藉由提供可執行點擊偵測的訊息和旗標，來指定插入標記的位置和外觀，以及查詢目前的插入標記大小和外觀的相關資訊，藉此啟用插入標記的位置。</span><span class="sxs-lookup"><span data-stu-id="359b1-515">The insertion mark API elements enable placement of insertion marks by providing messages and flags that perform hit detection, that specify the location and appearance of the insertion mark by item, and that query for information about the current size and appearance of the insertion mark.</span></span>

## <a name="see-also"></a><span data-ttu-id="359b1-516">另請參閱</span><span class="sxs-lookup"><span data-stu-id="359b1-516">See also</span></span>

* [<span data-ttu-id="359b1-517">虛擬 listview 控制項範例</span><span class="sxs-lookup"><span data-stu-id="359b1-517">Virtual listview control sample</span></span>](https://github.com/microsoft/Windows-classic-samples/tree/master/Samples/Win7Samples/winui/controls/common/vlistvw)
