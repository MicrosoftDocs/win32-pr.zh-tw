---
title: 關於 Month Calendar 控制項
description: 月曆控制項會實行類似行事曆的使用者介面。
ms.assetid: 81b8f233-272e-4043-92ff-5ff47b0610d6
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f21fba66f9fb71ad45f8853578821ad5f83da00e
ms.sourcegitcommit: 0f7a8198bacd5493ab1e78a9583c7a3578794765
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 05/25/2021
ms.locfileid: "110423748"
---
# <a name="about-month-calendar-controls"></a>關於 Month Calendar 控制項

月曆控制項會實行類似行事曆的使用者介面。 這提供使用者一個用於輸入或選取日期之非常直接易懂和辨識的方法。 藉由使用現有的資料類型，控制項也提供應用程式取得和設定控制項中日期資訊的方法。

-   [月曆控制項功能](#month-calendar-control-features)
    -   [選取一天](#selecting-a-day)
    -   [選取不連續的月份](#selecting-a-nonadjacent-month)
    -   [選取不同的年份](#selecting-a-different-year)
-   [當地語系化](#localization)
-   [月曆控制項中的時間](#times-in-the-month-calendar-control)

## <a name="month-calendar-control-features"></a>月曆控制項功能

下列螢幕擷取畫面顯示已調整大小以顯示兩個月的月曆控制項。

![對話方塊的螢幕擷取畫面，其中顯示兩個月並排顯示的月曆控制項](images/mc-simple.png)

> [!Note]  
> 月曆控制項的外觀和行為在不同版本的執行時間程式庫中稍有不同。 本主題著重在 Windows Vista Comctl32.dll 的第6版中所顯示的控制項。

 

圖例中的控制項具有下列選用功能。

-   目前的日期會顯示在控制項底部的另一行。 這是預設樣式。
-   「今天的圓形」 (實際上是此版本中的矩形) 出現在目前的日期，而「今天」的行則顯示為視覺提示。 這是預設樣式。
-   每個資料列的左邊都會顯示周數。 必須指定這個樣式。
-   某些日期會根據應用程式所設定的日期狀態以粗體顯示。 例如，已排定會議的日期可能會以粗體顯示。 必須指定這個樣式。

> [!Note]
>
> Windows 不支援1601之前的日期。 如需詳細資料，請參閱 [**FILETIME**](/windows/desktop/api/minwinbase/ns-minwinbase-filetime) 。
>
> 月曆控制項是以西曆為基礎，這是在1753中引進的行事曆。 它不會計算與1753之前使用的 Julian 行事曆一致的日期。

 

### <a name="selecting-a-day"></a>選取一天

依預設，當使用者按一下月曆控制項左上角或右上角的箭號按鈕時，控制項會更新其顯示，以顯示上一個月或下個月。 使用者也可以執行相同的動作，方法是按一下第一個月之前和最後一個月之後顯示的部分月份。

下列鍵盤命令也可以用來移動選取專案。 行事曆一律會視需要滾動，以顯示選取的日期。  ([**虛擬機器碼代碼**](/windows/desktop/inputdev/virtual-key-codes) 會顯示在資料表中。 ) 



|    命令      |    描述                    |
|-------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 向左箭號 (VK \_ left)    | 選取前一天。                                                                                                                                                                                                                 |
| 向右箭號 (VK \_ right)  | 選取 [下一天]。                                                                                                                                                                                                                     |
| 向上鍵 (VK \_ up)        | 選取上周的相同日期。                                                                                                                                                                                                |
| 向下箭號 (\_ 向下 VK)    | 選取下一周的相同日期。                                                                                                                                                                                                    |
| PAGE UP (VK \_ 之前的)      | 選取上個月的相同日期。  (如果該月份沒有當天，則會選取最接近的日期;例如，選取範圍從3月31日到2月28日或29日移動。 )                                                       |
| 下一頁 (VK \_ 下一個)     | 選取下個月的相同日期。                                                                                                                                                                                                   |
| HOME (VK \_ home)          | 選取目前月份的第一天。                                                                                                                                                                                               |
| End (VK \_ end)            | 選取目前月份的最後一天。                                                                                                                                                                                                |
| CTRL + HOME             | 向後滾動一個月，然後選取最左邊資料行中的某一天。                                                                                                                                                                       |
| CTRL + END              | 向前滾動一個月，並在最右邊的資料行中選取一天。                                                                                                                                                                       |
| CTRL + PAGE UP          | 選取在先前月份中的相同日期。 選取範圍的移動月份數是控制項中顯示的月數。 例如，如果顯示兩個月，則選取專案會從6月6日移至5月6日。    |
| CTRL + PAGE DOWN        | 選取在先前月份中的相同日期。 選取範圍的移動月份數是控制項中顯示的月數。 例如，如果顯示兩個月，則選取專案會從6月6日移至8月6日。 |



 

如果月曆控制項未使用 [**MCS \_ NOTODAY**](month-calendar-control-styles.md) 樣式，使用者可以按一下控制項底部的 [Today] 文字，以返回目前的日期。 如果看不到目前的日期，控制項會更新其顯示畫面來顯示它。

應用程式可以使用 [**MCM \_ SETMONTHDELTA**](mcm-setmonthdelta.md) 訊息或對應的宏 [**MonthCal \_ SETMONTHDELTA**](/windows/desktop/api/Commctrl/nf-commctrl-monthcal_setmonthdelta)，來變更控制項更新其顯示的月份數。 不過，PAGE UP 和 PAGE DOWN 鍵會將選取的月份變更為1，而不論顯示的月份數或 **MCM \_ SETMONTHDELTA** 所設定的值為何。

### <a name="selecting-a-nonadjacent-month"></a>選取不連續的月份

當使用者按一下所顯示月份的名稱時，年份中的所有月份都會列出 (在舊版中，這是快顯功能表) 。 使用者可以在清單中選取一個月。 如果看不到使用者的選取專案，月曆控制項會滾動其顯示，以顯示選擇的月份。 在下列螢幕擷取畫面中，月曆控制項會顯示兩個相鄰年份的月份。

![對話方塊的螢幕擷取畫面，其中包含顯示所有月份2007和2008的月曆控制項](images/mc-months.png)

### <a name="selecting-a-different-year"></a>選取不同的年份

如果使用者按一下年份，則會列出一組年份，而使用者可以選取不同的年份，如下列螢幕擷取畫面所示。

![月曆控制項的螢幕擷取畫面，顯示從1999到2020的所有年份](images/mc-years.png)

## <a name="localization"></a>當地語系化

月曆控制項從地區設定 \_ 使用者預設值取得其格式和所有字串 \_ 。

## <a name="times-in-the-month-calendar-control"></a>月曆控制項中的時間

月曆控制項不會顯示時間。 但是，用來設定和取出所選日期或今天日期的 [**SYSTEMTIME**](/windows/desktop/api/minwinbase/ns-minwinbase-systemtime) 結構會包含時間欄位。 當您以程式設計方式設定日期時，控制項會複製時間欄位，或先進行驗證，如果無效，則會儲存目前的預設時間。 以下是設定日期的訊息清單，以及如何處理時間欄位的描述。



|  訊息         |  描述            |
|---------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [**MCM \_ SETCURSEL**](mcm-setcursel.md)     | 控制項會複製時間欄位，而不需要驗證或修改。                                                                                                                                        |
| [**MCM \_ SETRANGE**](mcm-setrange.md)       | 傳入之結構的時間欄位會經過驗證。 如果有效，則不需要修改即可複製時間欄位。 如果無效，控制項會從今天的資料複製時間欄位。                  |
| [**MCM \_ SETSELRANGE**](mcm-setselrange.md) | 傳入之結構的時間欄位會經過驗證。 如果有效，則不需要修改即可複製時間欄位。 如果無效，控制項會保留目前選取範圍內的時間欄位。 |
| [**MCM \_ SETTODAY**](mcm-settoday.md)       | 控制項會複製時間欄位，而不需要驗證或修改。                                                                                                                                        |



 

從控制項取出日期時，時間欄位將會從預存時間複製，而不需要修改。 控制項的時間欄位處理是為了方便程式設計師而提供。 除了上述以外的任何作業之外，控制項不會檢查或修改時間欄位的結果。

 

 