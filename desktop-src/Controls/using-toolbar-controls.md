---
title: 使用工具列控制項
description: 本主題包含在應用程式中使用工具列控制項的執行詳細資料與範例程式碼。
ms.assetid: 5e52049c-58b4-478c-92ee-ea2f16534f6c
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: d7e62f5672b993f345277dd1b5812a43e312f27b
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/21/2020
ms.locfileid: "104024134"
---
# <a name="using-toolbar-controls"></a><span data-ttu-id="fa3bf-103">使用工具列控制項</span><span class="sxs-lookup"><span data-stu-id="fa3bf-103">Using Toolbar Controls</span></span>

<span data-ttu-id="fa3bf-104">本主題包含在應用程式中使用工具列控制項的執行詳細資料與範例程式碼。</span><span class="sxs-lookup"><span data-stu-id="fa3bf-104">This topic contains implementation details and example code for using toolbar controls in your applications.</span></span>

## <a name="in-this-section"></a><span data-ttu-id="fa3bf-105">本節內容</span><span class="sxs-lookup"><span data-stu-id="fa3bf-105">In this section</span></span>



| <span data-ttu-id="fa3bf-106">主題</span><span class="sxs-lookup"><span data-stu-id="fa3bf-106">Topic</span></span>                                                                                              | <span data-ttu-id="fa3bf-107">描述</span><span class="sxs-lookup"><span data-stu-id="fa3bf-107">Description</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|----------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="fa3bf-108">如何建立工具列</span><span class="sxs-lookup"><span data-stu-id="fa3bf-108">How to Create Toolbars</span></span>](create-toolbars.md)<br/>                                           | <span data-ttu-id="fa3bf-109">若要建立工具列，請使用 [**CreateWindowEx**](/windows/desktop/api/winuser/nf-winuser-createwindowexa) 函數，並指定 [**TOOLBARCLASSNAME**](common-control-window-classes.md) 視窗類別。</span><span class="sxs-lookup"><span data-stu-id="fa3bf-109">To create a toolbar, use the [**CreateWindowEx**](/windows/desktop/api/winuser/nf-winuser-createwindowexa) function, specifying the [**TOOLBARCLASSNAME**](common-control-window-classes.md) window class.</span></span> <span data-ttu-id="fa3bf-110">產生的工具列一開始不會包含任何按鈕。</span><span class="sxs-lookup"><span data-stu-id="fa3bf-110">The resulting toolbar initially contains no buttons.</span></span> <span data-ttu-id="fa3bf-111">使用 [**tb \_ ADDBUTTONS**](tb-addbuttons.md) 或 [**tb \_ INSERTBUTTON**](tb-insertbutton.md) 訊息，將按鈕新增至工具列。</span><span class="sxs-lookup"><span data-stu-id="fa3bf-111">Add buttons to the toolbar by using the [**TB\_ADDBUTTONS**](tb-addbuttons.md) or [**TB\_INSERTBUTTON**](tb-insertbutton.md) message.</span></span> <span data-ttu-id="fa3bf-112">在所有專案和字串都插入控制項之後，您必須傳送 [**TB 的 \_ AUTOSIZE**](tb-autosize.md) 訊息，讓工具列根據其內容重新計算其大小。</span><span class="sxs-lookup"><span data-stu-id="fa3bf-112">You must send the [**TB\_AUTOSIZE**](tb-autosize.md) message after all the items and strings have been inserted into the control, to cause the toolbar to recalculate its size based on its content.</span></span> <br/>        |
| [<span data-ttu-id="fa3bf-113">如何建立垂直工具列</span><span class="sxs-lookup"><span data-stu-id="fa3bf-113">How to Create Vertical Toolbars</span></span>](create-vertical-toolbars.md)<br/>                         | <span data-ttu-id="fa3bf-114">建立垂直工具列的關鍵是在視窗樣式中 [**包含 \_ 垂直 CCS**](common-control-styles.md) ，以及為每個按鈕設定 [**TBSTATE \_ 換行**](toolbar-button-states.md) 樣式。</span><span class="sxs-lookup"><span data-stu-id="fa3bf-114">The key to creating a vertical toolbar is to include [**CCS\_VERT**](common-control-styles.md) in the window style, and to set the [**TBSTATE\_WRAP**](toolbar-button-states.md) style for each button.</span></span> <br/>                                                                                                                                                                                                                                                                                                                                                                      |
| [<span data-ttu-id="fa3bf-115">如何動態標記工具列按鈕</span><span class="sxs-lookup"><span data-stu-id="fa3bf-115">How to Dynamically Label Toolbar Buttons</span></span>](dynamically-label-toolbar-buttons.md)<br/>       | <span data-ttu-id="fa3bf-116">您可以使用 [**TB \_ SETBUTTONINFO**](tb-setbuttoninfo.md) 訊息，將文字指派給現有的按鈕。</span><span class="sxs-lookup"><span data-stu-id="fa3bf-116">You can assign text to an existing button by using the [**TB\_SETBUTTONINFO**](tb-setbuttoninfo.md) message.</span></span> <br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| [<span data-ttu-id="fa3bf-117">如何顯示按鈕的工具提示</span><span class="sxs-lookup"><span data-stu-id="fa3bf-117">How to Display Tooltips for Buttons</span></span>](display-tooltips-for-buttons.md)<br/>                 | <span data-ttu-id="fa3bf-118">當您指定 [**TBSTYLE \_ 工具提示**](toolbar-control-and-button-styles.md) 樣式時，工具列會建立和管理工具提示控制項。</span><span class="sxs-lookup"><span data-stu-id="fa3bf-118">When you specify the [**TBSTYLE\_TOOLTIPS**](toolbar-control-and-button-styles.md) style, the toolbar creates and manages a tooltip control.</span></span> <span data-ttu-id="fa3bf-119">工具提示控制項是隱藏的，只有在使用者將指標移到工具列按鈕上方，並將其保留大約一秒時才會出現。</span><span class="sxs-lookup"><span data-stu-id="fa3bf-119">The tooltip control is hidden and appears only when users move the pointer over a toolbar button and leave it there for approximately one second.</span></span> <br/>                                                                                                                                                                                                                                                                                     |
| [<span data-ttu-id="fa3bf-120">如何處理下拉按鈕</span><span class="sxs-lookup"><span data-stu-id="fa3bf-120">How to Handle Drop-down Buttons</span></span>](handle-drop-down-buttons.md)<br/>                         | <span data-ttu-id="fa3bf-121">下拉式按鈕可以提供選項清單給使用者。</span><span class="sxs-lookup"><span data-stu-id="fa3bf-121">A drop-down button can present users with a list of options.</span></span> <span data-ttu-id="fa3bf-122">若要建立此按鈕樣式，請指定 [ [**BTNS \_ ] 下拉式**](toolbar-control-and-button-styles.md) 樣式 (也稱為 [ [**TBSTYLE \_ ] 下拉式清單**](toolbar-control-and-button-styles.md) ，以相容于舊版的通用控制項) 。</span><span class="sxs-lookup"><span data-stu-id="fa3bf-122">To create this style of button, specify the [**BTNS\_DROPDOWN**](toolbar-control-and-button-styles.md) style (also called [**TBSTYLE\_DROPDOWN**](toolbar-control-and-button-styles.md) for compatibility with previous versions of the common controls).</span></span> <span data-ttu-id="fa3bf-123">若要以箭號顯示下拉式按鈕，您也必須透過傳送 [**TB \_ SETEXTENDEDSTYLE**](tb-setextendedstyle.md)訊息來設定 [**TBSTYLE \_ EX \_ DRAWDDARROWS**](toolbar-extended-styles.md)工具列樣式。</span><span class="sxs-lookup"><span data-stu-id="fa3bf-123">To show a drop-down button with an arrow, you must also set the [**TBSTYLE\_EX\_DRAWDDARROWS**](toolbar-extended-styles.md) toolbar style by sending a [**TB\_SETEXTENDEDSTYLE**](tb-setextendedstyle.md) message.</span></span> <br/> |
| [<span data-ttu-id="fa3bf-124">如何自訂工具列</span><span class="sxs-lookup"><span data-stu-id="fa3bf-124">How to Customize Toolbars</span></span>](customize-toolbars.md)<br/>                                     | <span data-ttu-id="fa3bf-125">大部分的 Windows 應用程式都使用工具列控制項，讓使用者能夠輕鬆存取程式功能。</span><span class="sxs-lookup"><span data-stu-id="fa3bf-125">Most Windows-based applications use toolbar controls to provide users with convenient access to the program functionality.</span></span> <span data-ttu-id="fa3bf-126">不過，靜態工具列有一些缺點，像是空間太少，無法有效顯示所有可用的工具。</span><span class="sxs-lookup"><span data-stu-id="fa3bf-126">However, static toolbars have some shortcomings such as too little space to effectively display all the available tools.</span></span> <span data-ttu-id="fa3bf-127">解決此問題的方法是讓應用程式的工具列成為使用者可自訂的。</span><span class="sxs-lookup"><span data-stu-id="fa3bf-127">The solution to this problem is to make your application's toolbars user-customizable.</span></span> <span data-ttu-id="fa3bf-128">然後，使用者可以選擇只顯示所需的工具，並以適合其個人工作型態的方式來組織它們。</span><span class="sxs-lookup"><span data-stu-id="fa3bf-128">Then, users can choose to display only the tools they need, and they can organize them in a way that suits their personal workstyle.</span></span> <br/>                                                                                                                      |
| [<span data-ttu-id="fa3bf-129">如何在工具列中內嵌 Nonbutton 控制項</span><span class="sxs-lookup"><span data-stu-id="fa3bf-129">How to Embed Nonbutton Controls in Toolbars</span></span>](embed-nonbutton-controls-in-toolbars.md)<br/> | <span data-ttu-id="fa3bf-130">工具列僅支援按鈕;因此，如果您的應用程式需要不同類型的控制項，您必須建立子視窗。</span><span class="sxs-lookup"><span data-stu-id="fa3bf-130">Toolbars support only buttons; therefore, if your application requires a different kind of control, you must create a child window.</span></span> <span data-ttu-id="fa3bf-131">下圖顯示具有內嵌編輯控制項的工具列。</span><span class="sxs-lookup"><span data-stu-id="fa3bf-131">The following illustration shows a toolbar with an embedded edit control.</span></span> <br/>                                                                                                                                                                                                                                                                                                                                                                                        |
| [<span data-ttu-id="fa3bf-132">如何搭配使用熱追蹤與工具列</span><span class="sxs-lookup"><span data-stu-id="fa3bf-132">How to Use Hot-tracking with Toolbars</span></span>](use-hot-tracking-with-toolbars.md)<br/>             | <span data-ttu-id="fa3bf-133">當滑鼠指標停留在專案上時，專案會變成經常性存取。</span><span class="sxs-lookup"><span data-stu-id="fa3bf-133">When a mouse pointer hovers over an item, the item becomes hot.</span></span> <span data-ttu-id="fa3bf-134">如果啟用熱追蹤，則會反白顯示熱專案。</span><span class="sxs-lookup"><span data-stu-id="fa3bf-134">If hot-tracking is enabled, the hot item is highlighted.</span></span> <span data-ttu-id="fa3bf-135">使用 [**TBSTYLE \_ 平面**](toolbar-control-and-button-styles.md) 樣式建立的工具列，或使用 [視覺化樣式](themes-overview.md)的工具列，預設支援熱追蹤。</span><span class="sxs-lookup"><span data-stu-id="fa3bf-135">A toolbar that is created with the [**TBSTYLE\_FLAT**](toolbar-control-and-button-styles.md) style, or one that uses [Visual Styles](themes-overview.md), supports hot-tracking by default.</span></span> <br/>                                                                                                                                                                                                                                                                  |
| [<span data-ttu-id="fa3bf-136">如何建立 Internet Explorer 樣式的工具列</span><span class="sxs-lookup"><span data-stu-id="fa3bf-136">How to Create an Internet Explorer-style Toolbar</span></span>](cc-faq-ietoolbar.md)<br/>                | <span data-ttu-id="fa3bf-137">Windows Internet Explorer 的主要使用者介面功能之一，就是工具列。</span><span class="sxs-lookup"><span data-stu-id="fa3bf-137">One of the key user interface features of Windows Internet Explorer is the toolbar.</span></span> <span data-ttu-id="fa3bf-138">它不僅可讓使用者存取廣泛的功能，還可讓使用者根據個人喜好來自訂版面配置。</span><span class="sxs-lookup"><span data-stu-id="fa3bf-138">It not only gives users access to a wide array of features, it also allows users to customize its layout according to their personal preferences.</span></span> <br/>                                                                                                                                                                                                                                                                                                                                                                |
| [<span data-ttu-id="fa3bf-139">如何建立 Internet Explorer 樣式的功能表列</span><span class="sxs-lookup"><span data-stu-id="fa3bf-139">How to Create an Internet Explorer-style Menu Bar</span></span>](cc-faq-iemenubar.md)<br/>               | <span data-ttu-id="fa3bf-140">乍看之下，Microsoft Internet Explorer 5 和更新版本中的功能表列看起來類似于標準功能表。</span><span class="sxs-lookup"><span data-stu-id="fa3bf-140">At first glance, the menu bar in Microsoft Internet Explorer 5 and later looks similar to a standard menu.</span></span> <span data-ttu-id="fa3bf-141">但是，當您開始使用它時，它看起來會非常不同。</span><span class="sxs-lookup"><span data-stu-id="fa3bf-141">However, it looks quite different when you begin using it.</span></span> <br/>                                                                                                                                                                                                                                                                                                                                                                                                                                |



 

 

