---
title: 關於自訂繪圖
description: 本章節包含有關自訂繪製功能的一般資訊，並提供應用程式如何支援自訂繪製的概念總覽。
ms.assetid: dd104661-1e0c-4569-9753-817bcded1894
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 121a4df5aa6fab222a5c4387ebdcfba51a7977b2
ms.sourcegitcommit: 773fa6257ead6c74154ad3cf46d21e49adc900aa
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 09/09/2020
ms.locfileid: "104463864"
---
# <a name="about-custom-draw"></a><span data-ttu-id="7fa6f-103">關於自訂繪圖</span><span class="sxs-lookup"><span data-stu-id="7fa6f-103">About Custom Draw</span></span>

<span data-ttu-id="7fa6f-104">本章節包含有關自訂繪製功能的一般資訊，並提供應用程式如何支援自訂繪製的概念總覽。</span><span class="sxs-lookup"><span data-stu-id="7fa6f-104">This section contains general information about custom draw functionality and provides a conceptual overview of how an application can support custom draw.</span></span> <span data-ttu-id="7fa6f-105">目前，下列控制項支援自訂繪製功能：</span><span class="sxs-lookup"><span data-stu-id="7fa6f-105">Currently, the following controls support custom draw functionality:</span></span>

-   <span data-ttu-id="7fa6f-106">標題控制項</span><span class="sxs-lookup"><span data-stu-id="7fa6f-106">Header controls</span></span>
-   <span data-ttu-id="7fa6f-107">清單視圖控制項</span><span class="sxs-lookup"><span data-stu-id="7fa6f-107">List-view controls</span></span>
-   <span data-ttu-id="7fa6f-108">Rebar 控制項</span><span class="sxs-lookup"><span data-stu-id="7fa6f-108">Rebar controls</span></span>
-   <span data-ttu-id="7fa6f-109">工具列控制項</span><span class="sxs-lookup"><span data-stu-id="7fa6f-109">Toolbar controls</span></span>
-   <span data-ttu-id="7fa6f-110">工具提示控制項</span><span class="sxs-lookup"><span data-stu-id="7fa6f-110">Tooltip controls</span></span>
-   <span data-ttu-id="7fa6f-111">[請] 控制項</span><span class="sxs-lookup"><span data-stu-id="7fa6f-111">Trackbar controls</span></span>
-   <span data-ttu-id="7fa6f-112">樹狀檢視控制項</span><span class="sxs-lookup"><span data-stu-id="7fa6f-112">Tree-view controls</span></span>

<!-- -->

-   [<span data-ttu-id="7fa6f-113">關於自訂繪製通知訊息</span><span class="sxs-lookup"><span data-stu-id="7fa6f-113">About Custom Draw Notification Messages</span></span>](#about-custom-draw-notification-messages)
-   [<span data-ttu-id="7fa6f-114">繪製迴圈、繪製階段和通知訊息</span><span class="sxs-lookup"><span data-stu-id="7fa6f-114">Paint Cycles, Drawing Stages, and Notification Messages</span></span>](#paint-cycles-drawing-stages-and-notification-messages)
-   [<span data-ttu-id="7fa6f-115">利用自訂繪圖服務</span><span class="sxs-lookup"><span data-stu-id="7fa6f-115">Taking Advantage of Custom Draw Services</span></span>](#taking-advantage-of-custom-draw-services)
    -   [<span data-ttu-id="7fa6f-116">回應 prepaint 通知</span><span class="sxs-lookup"><span data-stu-id="7fa6f-116">Responding to the prepaint notification</span></span>](#responding-to-the-prepaint-notification)
    -   [<span data-ttu-id="7fa6f-117">要求專案特定通知</span><span class="sxs-lookup"><span data-stu-id="7fa6f-117">Requesting item-specific notifications</span></span>](#requesting-item-specific-notifications)
    -   [<span data-ttu-id="7fa6f-118">自行繪製專案</span><span class="sxs-lookup"><span data-stu-id="7fa6f-118">Drawing the item yourself</span></span>](#drawing-the-item-yourself)
    -   [<span data-ttu-id="7fa6f-119">變更字型和色彩</span><span class="sxs-lookup"><span data-stu-id="7fa6f-119">Changing fonts and colors</span></span>](#changing-fonts-and-colors)
-   [<span data-ttu-id="7fa6f-120">使用 List-View 和 Tree-View 控制項的自訂繪圖</span><span class="sxs-lookup"><span data-stu-id="7fa6f-120">Custom Draw With List-View and Tree-View Controls</span></span>](#custom-draw-with-list-view-and-tree-view-controls)
    -   [<span data-ttu-id="7fa6f-121">使用 List-View 控制項的自訂繪圖</span><span class="sxs-lookup"><span data-stu-id="7fa6f-121">Custom Draw With List-View Controls</span></span>](#custom-draw-with-list-view-controls)
-   [<span data-ttu-id="7fa6f-122">相關主題</span><span class="sxs-lookup"><span data-stu-id="7fa6f-122">Related topics</span></span>](#related-topics)

## <a name="about-custom-draw-notification-messages"></a><span data-ttu-id="7fa6f-123">關於自訂繪製通知訊息</span><span class="sxs-lookup"><span data-stu-id="7fa6f-123">About Custom Draw Notification Messages</span></span>

<span data-ttu-id="7fa6f-124">所有支援自訂繪製的通用控制項，會在繪圖作業期間的特定點傳送 [NM \_ CUSTOMDRAW](nm-customdraw.md) 通知碼。</span><span class="sxs-lookup"><span data-stu-id="7fa6f-124">All common controls that support custom draw send [NM\_CUSTOMDRAW](nm-customdraw.md) notification codes at specific points during drawing operations.</span></span> <span data-ttu-id="7fa6f-125">這些通知碼描述適用于整個控制項的繪圖作業，以及控制項內專案特定的繪製作業。</span><span class="sxs-lookup"><span data-stu-id="7fa6f-125">These notification codes describe drawing operations that apply to the entire control as well as drawing operations specific to items within the control.</span></span> <span data-ttu-id="7fa6f-126">如同許多通知碼，NM \_ CUSTOMDRAW 通知會以 [**WM \_ 通知**](wm-notify.md) 訊息的形式傳送。</span><span class="sxs-lookup"><span data-stu-id="7fa6f-126">Like many notification codes, NM\_CUSTOMDRAW notifications are sent as [**WM\_NOTIFY**](wm-notify.md) messages.</span></span>

<span data-ttu-id="7fa6f-127">自訂繪製通知的 *lParam* 參數將會是 [**NMCUSTOMDRAW**](/windows/win32/api/commctrl/ns-commctrl-nmcustomdraw) 結構的位址，或是包含 **NMCUSTOMDRAW** 結構作為其第一個成員的控制項特定結構。</span><span class="sxs-lookup"><span data-stu-id="7fa6f-127">The *lParam* parameter of a custom draw notification will be the address of an [**NMCUSTOMDRAW**](/windows/win32/api/commctrl/ns-commctrl-nmcustomdraw) structure or a control-specific structure that contains an **NMCUSTOMDRAW** structure as its first member.</span></span> <span data-ttu-id="7fa6f-128">下表說明控制項與其使用的結構之間的關聯性。</span><span class="sxs-lookup"><span data-stu-id="7fa6f-128">The following table illustrates the relationship between the controls and the structures they use.</span></span>



| <span data-ttu-id="7fa6f-129">結構</span><span class="sxs-lookup"><span data-stu-id="7fa6f-129">Structure</span></span>                                | <span data-ttu-id="7fa6f-130">使用對象</span><span class="sxs-lookup"><span data-stu-id="7fa6f-130">Used by</span></span>                              |
|------------------------------------------|--------------------------------------|
| [<span data-ttu-id="7fa6f-131">**NMCUSTOMDRAW**</span><span class="sxs-lookup"><span data-stu-id="7fa6f-131">**NMCUSTOMDRAW**</span></span>](/windows/win32/api/commctrl/ns-commctrl-nmcustomdraw)     | <span data-ttu-id="7fa6f-132">Rebar、頁首及標題控制項</span><span class="sxs-lookup"><span data-stu-id="7fa6f-132">Rebar, trackbar, and header controls</span></span> |
| [<span data-ttu-id="7fa6f-133">**NMLVCUSTOMDRAW**</span><span class="sxs-lookup"><span data-stu-id="7fa6f-133">**NMLVCUSTOMDRAW**</span></span>](/windows/win32/api/commctrl/ns-commctrl-nmlvcustomdraw) | <span data-ttu-id="7fa6f-134">清單視圖控制項</span><span class="sxs-lookup"><span data-stu-id="7fa6f-134">List-view controls</span></span>                   |
| [<span data-ttu-id="7fa6f-135">**NMTBCUSTOMDRAW**</span><span class="sxs-lookup"><span data-stu-id="7fa6f-135">**NMTBCUSTOMDRAW**</span></span>](/windows/desktop/api/Commctrl/ns-commctrl-nmtbcustomdraw) | <span data-ttu-id="7fa6f-136">工具列控制項</span><span class="sxs-lookup"><span data-stu-id="7fa6f-136">Toolbar controls</span></span>                     |
| [<span data-ttu-id="7fa6f-137">**NMTTCUSTOMDRAW**</span><span class="sxs-lookup"><span data-stu-id="7fa6f-137">**NMTTCUSTOMDRAW**</span></span>](/windows/win32/api/commctrl/ns-commctrl-nmttcustomdraw) | <span data-ttu-id="7fa6f-138">工具提示控制項</span><span class="sxs-lookup"><span data-stu-id="7fa6f-138">Tooltip controls</span></span>                     |
| [<span data-ttu-id="7fa6f-139">**NMTVCUSTOMDRAW**</span><span class="sxs-lookup"><span data-stu-id="7fa6f-139">**NMTVCUSTOMDRAW**</span></span>](/windows/win32/api/commctrl/ns-commctrl-nmtvcustomdraw) | <span data-ttu-id="7fa6f-140">樹狀檢視控制項</span><span class="sxs-lookup"><span data-stu-id="7fa6f-140">Tree-view controls</span></span>                   |



 

## <a name="paint-cycles-drawing-stages-and-notification-messages"></a><span data-ttu-id="7fa6f-141">繪製迴圈、繪製階段和通知訊息</span><span class="sxs-lookup"><span data-stu-id="7fa6f-141">Paint Cycles, Drawing Stages, and Notification Messages</span></span>

<span data-ttu-id="7fa6f-142">如同所有 Windows 應用程式，通用控制項會根據從系統或其他應用程式接收到的訊息，定期進行繪製和清除。</span><span class="sxs-lookup"><span data-stu-id="7fa6f-142">Like all Windows applications, common controls periodically paint and erase themselves based on messages received from the system or other applications.</span></span> <span data-ttu-id="7fa6f-143">控制項繪製或清除的進程稱為「 *繪製迴圈*」。</span><span class="sxs-lookup"><span data-stu-id="7fa6f-143">The process of a control painting or erasing itself is called a *paint cycle*.</span></span> <span data-ttu-id="7fa6f-144">支援自訂繪製的控制項會透過每個油漆週期定期傳送 [NM \_ CUSTOMDRAW](nm-customdraw.md) 通知碼。</span><span class="sxs-lookup"><span data-stu-id="7fa6f-144">Controls that support custom draw send [NM\_CUSTOMDRAW](nm-customdraw.md) notification codes periodically through each paint cycle.</span></span> <span data-ttu-id="7fa6f-145">此通知碼伴隨著 [**NMCUSTOMDRAW**](/windows/win32/api/commctrl/ns-commctrl-nmcustomdraw) 結構或另一個結構，其中包含 **NMCUSTOMDRAW** 結構作為其第一個成員。</span><span class="sxs-lookup"><span data-stu-id="7fa6f-145">This notification code is accompanied by an [**NMCUSTOMDRAW**](/windows/win32/api/commctrl/ns-commctrl-nmcustomdraw) structure or another structure that contains an **NMCUSTOMDRAW** structure as its first member.</span></span>

<span data-ttu-id="7fa6f-146">[**NMCUSTOMDRAW**](/windows/win32/api/commctrl/ns-commctrl-nmcustomdraw)結構所包含的其中一項資訊是繪製週期的目前階段。</span><span class="sxs-lookup"><span data-stu-id="7fa6f-146">One piece of information that the [**NMCUSTOMDRAW**](/windows/win32/api/commctrl/ns-commctrl-nmcustomdraw) structure contains is the current stage of the paint cycle.</span></span> <span data-ttu-id="7fa6f-147">這稱為「 *繪製階段* 」，並以結構 **dwDrawStage** 成員中的值表示。</span><span class="sxs-lookup"><span data-stu-id="7fa6f-147">This is referred to as the *draw stage* and is represented by the value in the structure's **dwDrawStage** member.</span></span> <span data-ttu-id="7fa6f-148">控制項會通知其父系大約四個基本繪圖階段。</span><span class="sxs-lookup"><span data-stu-id="7fa6f-148">A control informs its parent about four basic draw stages.</span></span> <span data-ttu-id="7fa6f-149">這些基本或全域繪圖階段會以下列旗標值在結構中表示， (在 Commctrl 中定義) 。</span><span class="sxs-lookup"><span data-stu-id="7fa6f-149">These basic, or global, draw stages are represented in the structure by the following flag values (defined in Commctrl.h).</span></span>



| <span data-ttu-id="7fa6f-150">全域繪製階段值</span><span class="sxs-lookup"><span data-stu-id="7fa6f-150">Global draw stage values</span></span> | <span data-ttu-id="7fa6f-151">Description</span><span class="sxs-lookup"><span data-stu-id="7fa6f-151">Description</span></span>                        |
|--------------------------|------------------------------------|
| <span data-ttu-id="7fa6f-152">CDDS \_ PREPAINT</span><span class="sxs-lookup"><span data-stu-id="7fa6f-152">CDDS\_PREPAINT</span></span>           | <span data-ttu-id="7fa6f-153">開始繪製迴圈之前。</span><span class="sxs-lookup"><span data-stu-id="7fa6f-153">Before the paint cycle begins.</span></span>     |
| <span data-ttu-id="7fa6f-154">CDDS \_ POSTPAINT</span><span class="sxs-lookup"><span data-stu-id="7fa6f-154">CDDS\_POSTPAINT</span></span>          | <span data-ttu-id="7fa6f-155">繪製迴圈完成之後。</span><span class="sxs-lookup"><span data-stu-id="7fa6f-155">After the paint cycle is complete.</span></span> |
| <span data-ttu-id="7fa6f-156">CDDS \_ PREERASE</span><span class="sxs-lookup"><span data-stu-id="7fa6f-156">CDDS\_PREERASE</span></span>           | <span data-ttu-id="7fa6f-157">開始清除迴圈之前。</span><span class="sxs-lookup"><span data-stu-id="7fa6f-157">Before the erase cycle begins.</span></span>     |
| <span data-ttu-id="7fa6f-158">CDDS \_ POSTERASE</span><span class="sxs-lookup"><span data-stu-id="7fa6f-158">CDDS\_POSTERASE</span></span>          | <span data-ttu-id="7fa6f-159">清除迴圈完成之後。</span><span class="sxs-lookup"><span data-stu-id="7fa6f-159">After the erase cycle is complete.</span></span> |



 

<span data-ttu-id="7fa6f-160">上述每個值都可以與 CDDS \_ 專案旗標結合，以指定專案特定的繪製階段。</span><span class="sxs-lookup"><span data-stu-id="7fa6f-160">Each of the preceding values can be combined with the CDDS\_ITEM flag to specify draw stages specific to items.</span></span> <span data-ttu-id="7fa6f-161">為了方便起見，Commctrl 包含下列專案特定的值。</span><span class="sxs-lookup"><span data-stu-id="7fa6f-161">For convenience, Commctrl.h contains the following item-specific values.</span></span>



| <span data-ttu-id="7fa6f-162">專案特定的繪製階段值</span><span class="sxs-lookup"><span data-stu-id="7fa6f-162">Item-specific draw stage values</span></span> | <span data-ttu-id="7fa6f-163">Description</span><span class="sxs-lookup"><span data-stu-id="7fa6f-163">Description</span></span>                                                                                                                                                                                                                                                                         |
|---------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="7fa6f-164">CDDS \_ ITEMPREPAINT</span><span class="sxs-lookup"><span data-stu-id="7fa6f-164">CDDS\_ITEMPREPAINT</span></span>              | <span data-ttu-id="7fa6f-165">繪製專案之前。</span><span class="sxs-lookup"><span data-stu-id="7fa6f-165">Before an item is drawn.</span></span>                                                                                                                                                                                                                                                            |
| <span data-ttu-id="7fa6f-166">CDDS \_ ITEMPOSTPAINT</span><span class="sxs-lookup"><span data-stu-id="7fa6f-166">CDDS\_ITEMPOSTPAINT</span></span>             | <span data-ttu-id="7fa6f-167">繪製專案之後。</span><span class="sxs-lookup"><span data-stu-id="7fa6f-167">After an item has been drawn.</span></span>                                                                                                                                                                                                                                                       |
| <span data-ttu-id="7fa6f-168">CDDS \_ ITEMPREERASE</span><span class="sxs-lookup"><span data-stu-id="7fa6f-168">CDDS\_ITEMPREERASE</span></span>              | <span data-ttu-id="7fa6f-169">清除專案之前。</span><span class="sxs-lookup"><span data-stu-id="7fa6f-169">Before an item is erased.</span></span>                                                                                                                                                                                                                                                           |
| <span data-ttu-id="7fa6f-170">CDDS \_ ITEMPOSTERASE</span><span class="sxs-lookup"><span data-stu-id="7fa6f-170">CDDS\_ITEMPOSTERASE</span></span>             | <span data-ttu-id="7fa6f-171">清除專案之後。</span><span class="sxs-lookup"><span data-stu-id="7fa6f-171">After an item has been erased.</span></span>                                                                                                                                                                                                                                                      |
| <span data-ttu-id="7fa6f-172">CDDS \_ 子項</span><span class="sxs-lookup"><span data-stu-id="7fa6f-172">CDDS\_SUBITEM</span></span>                   | <span data-ttu-id="7fa6f-173">[通用控制項版本](common-control-versions.md) 4.71。</span><span class="sxs-lookup"><span data-stu-id="7fa6f-173">[Common Control Versions](common-control-versions.md) 4.71.</span></span> <span data-ttu-id="7fa6f-174">\_ \_ 如果正在繪製子工作，則為與 CDDS ITEMPREPAINT 或 CDDS ITEMPOSTPAINT 結合的旗標。</span><span class="sxs-lookup"><span data-stu-id="7fa6f-174">Flag combined with CDDS\_ITEMPREPAINT or CDDS\_ITEMPOSTPAINT if a subitem is being drawn.</span></span> <span data-ttu-id="7fa6f-175">只有在 [**CDRF \_ NOTIFYITEMDRAW**](cdrf-constants.md) 是從 CDDS PREPAINT 傳回時才會設定 \_ 。</span><span class="sxs-lookup"><span data-stu-id="7fa6f-175">This will only be set if [**CDRF\_NOTIFYITEMDRAW**](cdrf-constants.md) is returned from CDDS\_PREPAINT.</span></span> |



 

<span data-ttu-id="7fa6f-176">您的應用程式必須處理 [NM \_ CUSTOMDRAW](nm-customdraw.md) 通知碼，然後傳回特定值，通知控制項它必須做什麼。</span><span class="sxs-lookup"><span data-stu-id="7fa6f-176">Your application must process the [NM\_CUSTOMDRAW](nm-customdraw.md) notification code and then return a specific value that informs the control what it must do.</span></span> <span data-ttu-id="7fa6f-177">如需這些傳回值的詳細資訊，請參閱下列各節。</span><span class="sxs-lookup"><span data-stu-id="7fa6f-177">See the following sections for more information about these return values.</span></span>

## <a name="taking-advantage-of-custom-draw-services"></a><span data-ttu-id="7fa6f-178">利用自訂繪圖服務</span><span class="sxs-lookup"><span data-stu-id="7fa6f-178">Taking Advantage of Custom Draw Services</span></span>

<span data-ttu-id="7fa6f-179">利用自訂繪製功能的關鍵是回應控制項所傳送的 [NM \_ CUSTOMDRAW](nm-customdraw.md) 通知碼。</span><span class="sxs-lookup"><span data-stu-id="7fa6f-179">The key to harnessing custom draw functionality is in responding to the [NM\_CUSTOMDRAW](nm-customdraw.md) notification codes that a control sends.</span></span> <span data-ttu-id="7fa6f-180">應用程式為了回應這些通知所傳送的傳回值，會決定該繪製週期的控制項行為。</span><span class="sxs-lookup"><span data-stu-id="7fa6f-180">The return values your application sends in response to these notifications determine the control's behavior for that paint cycle.</span></span>

<span data-ttu-id="7fa6f-181">本節包含有關應用程式如何使用 [NM \_ CUSTOMDRAW](nm-customdraw.md) 通知傳回值來判斷控制項行為的資訊。</span><span class="sxs-lookup"><span data-stu-id="7fa6f-181">This section contains information about how your application can use [NM\_CUSTOMDRAW](nm-customdraw.md) notification return values to determine the control's behavior.</span></span>

<span data-ttu-id="7fa6f-182">詳細資料分成下列主題：</span><span class="sxs-lookup"><span data-stu-id="7fa6f-182">Details are broken into the following topics:</span></span>

-   [<span data-ttu-id="7fa6f-183">回應 prepaint 通知</span><span class="sxs-lookup"><span data-stu-id="7fa6f-183">Responding to the prepaint notification</span></span>](#responding-to-the-prepaint-notification)
-   [<span data-ttu-id="7fa6f-184">要求專案特定通知</span><span class="sxs-lookup"><span data-stu-id="7fa6f-184">Requesting item-specific notifications</span></span>](#requesting-item-specific-notifications)
-   [<span data-ttu-id="7fa6f-185">自行繪製專案</span><span class="sxs-lookup"><span data-stu-id="7fa6f-185">Drawing the item yourself</span></span>](#drawing-the-item-yourself)
-   [<span data-ttu-id="7fa6f-186">變更字型和色彩</span><span class="sxs-lookup"><span data-stu-id="7fa6f-186">Changing fonts and colors</span></span>](#changing-fonts-and-colors)

### <a name="responding-to-the-prepaint-notification"></a><span data-ttu-id="7fa6f-187">回應 prepaint 通知</span><span class="sxs-lookup"><span data-stu-id="7fa6f-187">Responding to the prepaint notification</span></span>

<span data-ttu-id="7fa6f-188">在每個繪製週期的開頭，控制項會傳送 [nm \_ CUSTOMDRAW](nm-customdraw.md) 通知碼， \_ 在隨附的 NM CUSTOMDRAW 結構的 **dwDrawStage** 成員中指定 CDDS PREPAINT 值 \_ 。</span><span class="sxs-lookup"><span data-stu-id="7fa6f-188">At the beginning of each paint cycle, the control sends the [NM\_CUSTOMDRAW](nm-customdraw.md) notification code, specifying the CDDS\_PREPAINT value in the **dwDrawStage** member of the accompanying NM\_CUSTOMDRAW structure.</span></span> <span data-ttu-id="7fa6f-189">您的應用程式傳回給第一個通知的值，會指定控制項如何和何時針對該繪製迴圈的其餘部分傳送後續的自訂繪製通知。</span><span class="sxs-lookup"><span data-stu-id="7fa6f-189">The value that your application returns to this first notification dictates how and when the control sends subsequent custom draw notifications for the rest of that paint cycle.</span></span> <span data-ttu-id="7fa6f-190">您的應用程式可以傳回下列旗標的組合，以回應第一個通知。</span><span class="sxs-lookup"><span data-stu-id="7fa6f-190">Your application can return a combination of the following flags in response to the first notification.</span></span>



| <span data-ttu-id="7fa6f-191">傳回值</span><span class="sxs-lookup"><span data-stu-id="7fa6f-191">Return value</span></span>            | <span data-ttu-id="7fa6f-192">效果</span><span class="sxs-lookup"><span data-stu-id="7fa6f-192">Effect</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|-------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="7fa6f-193">CDRF \_ DODEFAULT</span><span class="sxs-lookup"><span data-stu-id="7fa6f-193">CDRF\_DODEFAULT</span></span>         | <span data-ttu-id="7fa6f-194">控制項將會自行繪製。</span><span class="sxs-lookup"><span data-stu-id="7fa6f-194">The control will draw itself.</span></span> <span data-ttu-id="7fa6f-195">它不會針對此繪製週期傳送額外的 [NM \_ CUSTOMDRAW](nm-customdraw.md) 通知。</span><span class="sxs-lookup"><span data-stu-id="7fa6f-195">It will not send additional [NM\_CUSTOMDRAW](nm-customdraw.md) notifications for this paint cycle.</span></span> <span data-ttu-id="7fa6f-196">此旗標不可與任何其他旗標一起使用。</span><span class="sxs-lookup"><span data-stu-id="7fa6f-196">This flag cannot be used with any other flag.</span></span>                                                                                                                                                                                                                                                                               |
| <span data-ttu-id="7fa6f-197">CDRF \_ DOERASE</span><span class="sxs-lookup"><span data-stu-id="7fa6f-197">CDRF\_DOERASE</span></span>           | <span data-ttu-id="7fa6f-198">控制項只會繪製背景。</span><span class="sxs-lookup"><span data-stu-id="7fa6f-198">The control will only draw the background.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                    |
| <span data-ttu-id="7fa6f-199">CDRF \_ NEWFONT</span><span class="sxs-lookup"><span data-stu-id="7fa6f-199">CDRF\_NEWFONT</span></span>           | <span data-ttu-id="7fa6f-200">您的應用程式已為專案指定新字型;控制項將會使用新的字型。</span><span class="sxs-lookup"><span data-stu-id="7fa6f-200">Your application specified a new font for the item; the control will use the new font.</span></span> <span data-ttu-id="7fa6f-201">如需變更字型的詳細資訊，請參閱 [變更字型和色彩](#changing-fonts-and-colors)。</span><span class="sxs-lookup"><span data-stu-id="7fa6f-201">For more information on changing fonts, see [Changing fonts and colors](#changing-fonts-and-colors).</span></span> <span data-ttu-id="7fa6f-202">當 **dwDrawStage** 等於 CDDS ITEMPREPAINT 時，就會發生這種情況 \_ 。</span><span class="sxs-lookup"><span data-stu-id="7fa6f-202">This occurs when **dwDrawStage** equals CDDS\_ITEMPREPAINT.</span></span>                                                                                                                                                                                                       |
| <span data-ttu-id="7fa6f-203">CDRF \_ NOTIFYITEMDRAW</span><span class="sxs-lookup"><span data-stu-id="7fa6f-203">CDRF\_NOTIFYITEMDRAW</span></span>    | <span data-ttu-id="7fa6f-204">控制項將會通知任何專案特定繪圖作業的父系。</span><span class="sxs-lookup"><span data-stu-id="7fa6f-204">The control will notify the parent of any item-specific drawing operations.</span></span> <span data-ttu-id="7fa6f-205">它會在繪製專案之前和之後傳送 [NM \_ CUSTOMDRAW](nm-customdraw.md) 通知碼。當 **dwDrawStage** 等於 CDDS PREPAINT 時，就會發生這種情況 \_ 。</span><span class="sxs-lookup"><span data-stu-id="7fa6f-205">It will send [NM\_CUSTOMDRAW](nm-customdraw.md) notification codes before and after it draws items.This occurs when **dwDrawStage** equals CDDS\_PREPAINT.</span></span>                                                                                                                                                                                                                       |
| <span data-ttu-id="7fa6f-206">CDRF \_ NOTIFYPOSTERASE</span><span class="sxs-lookup"><span data-stu-id="7fa6f-206">CDRF\_NOTIFYPOSTERASE</span></span>   | <span data-ttu-id="7fa6f-207">控制項將會在清除專案之後通知父代。</span><span class="sxs-lookup"><span data-stu-id="7fa6f-207">The control will notify the parent after erasing an item.</span></span> <span data-ttu-id="7fa6f-208">當 **dwDrawStage** 等於 CDDS PREPAINT 時，就會發生這種情況 \_ 。</span><span class="sxs-lookup"><span data-stu-id="7fa6f-208">This occurs when **dwDrawStage** equals CDDS\_PREPAINT.</span></span>                                                                                                                                                                                                                                                                                                                                             |
| <span data-ttu-id="7fa6f-209">CDRF \_ NOTIFYPOSTPAINT</span><span class="sxs-lookup"><span data-stu-id="7fa6f-209">CDRF\_NOTIFYPOSTPAINT</span></span>   | <span data-ttu-id="7fa6f-210">當整個控制項的繪製迴圈完成時，控制項將傳送 [NM \_ CUSTOMDRAW](nm-customdraw.md) 通知。</span><span class="sxs-lookup"><span data-stu-id="7fa6f-210">The control will send an [NM\_CUSTOMDRAW](nm-customdraw.md) notification when the painting cycle for the entire control is complete.</span></span> <span data-ttu-id="7fa6f-211">當 **dwDrawStage** 等於 CDDS PREPAINT 時，就會發生這種情況 \_ 。</span><span class="sxs-lookup"><span data-stu-id="7fa6f-211">This occurs when **dwDrawStage** equals CDDS\_PREPAINT.</span></span>                                                                                                                                                                                                                                                                 |
| <span data-ttu-id="7fa6f-212">CDRF \_ NOTIFYSUBITEMDRAW</span><span class="sxs-lookup"><span data-stu-id="7fa6f-212">CDRF\_NOTIFYSUBITEMDRAW</span></span> | <span data-ttu-id="7fa6f-213">[版本 4.71](common-control-versions.md)。</span><span class="sxs-lookup"><span data-stu-id="7fa6f-213">[Version 4.71](common-control-versions.md).</span></span> <span data-ttu-id="7fa6f-214">您的應用程式將會在[ \_ ](nm-customdraw.md)  \_ \| \_ 繪製每個清單-view 子集合之前，收到 CUSTOMDRAW 通知，並將 dwDrawStage 設定為 CDDS ITEMPREPAINT CDDS 子。</span><span class="sxs-lookup"><span data-stu-id="7fa6f-214">Your application will receive an [NM\_CUSTOMDRAW](nm-customdraw.md) notification with **dwDrawStage** set to CDDS\_ITEMPREPAINT \| CDDS\_SUBITEM before each list-view subitem is drawn.</span></span> <span data-ttu-id="7fa6f-215">然後，您可以分別為每個子項指定字型和色彩，或針對預設處理傳回 [**CDRF \_ DODEFAULT**](cdrf-constants.md) 。</span><span class="sxs-lookup"><span data-stu-id="7fa6f-215">You can then specify font and color for each subitem separately or return [**CDRF\_DODEFAULT**](cdrf-constants.md) for default processing.</span></span> <span data-ttu-id="7fa6f-216">當 **dwDrawStage** 等於 CDDS ITEMPREPAINT 時，就會發生這種情況 \_ 。</span><span class="sxs-lookup"><span data-stu-id="7fa6f-216">This occurs when **dwDrawStage** equals CDDS\_ITEMPREPAINT.</span></span> |
| <span data-ttu-id="7fa6f-217">CDRF \_ SKIPDEFAULT</span><span class="sxs-lookup"><span data-stu-id="7fa6f-217">CDRF\_SKIPDEFAULT</span></span>       | <span data-ttu-id="7fa6f-218">您的應用程式會以手動方式繪製專案。</span><span class="sxs-lookup"><span data-stu-id="7fa6f-218">Your application drew the item manually.</span></span> <span data-ttu-id="7fa6f-219">控制項不會繪製專案。</span><span class="sxs-lookup"><span data-stu-id="7fa6f-219">The control will not draw the item.</span></span> <span data-ttu-id="7fa6f-220">當 **dwDrawStage** 等於 CDDS ITEMPREPAINT 時，就會發生這種情況 \_ 。</span><span class="sxs-lookup"><span data-stu-id="7fa6f-220">This occurs when **dwDrawStage** equals CDDS\_ITEMPREPAINT.</span></span>                                                                                                                                                                                                                                                                                                                      |
| <span data-ttu-id="7fa6f-221">CDRF \_ SKIPPOSTPAINT</span><span class="sxs-lookup"><span data-stu-id="7fa6f-221">CDRF\_SKIPPOSTPAINT</span></span>     | <span data-ttu-id="7fa6f-222">控制項不會在專案周圍繪製焦點矩形。</span><span class="sxs-lookup"><span data-stu-id="7fa6f-222">The control will not draw the focus rectangle around an item.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                 |



 

### <a name="requesting-item-specific-notifications"></a><span data-ttu-id="7fa6f-223">要求專案特定通知</span><span class="sxs-lookup"><span data-stu-id="7fa6f-223">Requesting item-specific notifications</span></span>

<span data-ttu-id="7fa6f-224">如果您的應用程式將 [**CDRF \_ NOTIFYITEMDRAW**](cdrf-constants.md) 傳回到初始 prepaint 自訂繪製通知，此控制項就會傳送該繪製迴圈期間所繪製之每個專案的通知。</span><span class="sxs-lookup"><span data-stu-id="7fa6f-224">If your application returns [**CDRF\_NOTIFYITEMDRAW**](cdrf-constants.md) to the initial prepaint custom draw notification, the control will send notifications for each item it draws during that paint cycle.</span></span> <span data-ttu-id="7fa6f-225">這些專案特定的通知 \_ 在隨附 [**NMCUSTOMDRAW**](/windows/win32/api/commctrl/ns-commctrl-nmcustomdraw)結構的 **dwDrawStage** 成員中將會有 CDDS ITEMPREPAINT 值。</span><span class="sxs-lookup"><span data-stu-id="7fa6f-225">These item-specific notifications will have the CDDS\_ITEMPREPAINT value in the **dwDrawStage** member of the accompanying [**NMCUSTOMDRAW**](/windows/win32/api/commctrl/ns-commctrl-nmcustomdraw) structure.</span></span> <span data-ttu-id="7fa6f-226">您可以要求控制項在完成繪製專案時傳送另一個通知，方法是將 [**CDRF \_ NOTIFYPOSTPAINT**](cdrf-constants.md) 傳給這些專案特定的通知。</span><span class="sxs-lookup"><span data-stu-id="7fa6f-226">You can request that the control send another notification when it is finished drawing the item by returning [**CDRF\_NOTIFYPOSTPAINT**](cdrf-constants.md) to these item-specific notifications.</span></span> <span data-ttu-id="7fa6f-227">否則，會傳回 [**CDRF \_ DODEFAULT**](cdrf-constants.md) ，而且控制項在開始繪製下一個專案之前，不會通知父視窗。</span><span class="sxs-lookup"><span data-stu-id="7fa6f-227">Otherwise, return [**CDRF\_DODEFAULT**](cdrf-constants.md) and the control will not notify the parent window until it starts to draw the next item.</span></span>

### <a name="drawing-the-item-yourself"></a><span data-ttu-id="7fa6f-228">自行繪製專案</span><span class="sxs-lookup"><span data-stu-id="7fa6f-228">Drawing the item yourself</span></span>

<span data-ttu-id="7fa6f-229">如果您的應用程式繪製整個專案，請傳回 [**CDRF \_ SKIPDEFAULT**](cdrf-constants.md)。</span><span class="sxs-lookup"><span data-stu-id="7fa6f-229">If your application draws the entire item, return [**CDRF\_SKIPDEFAULT**](cdrf-constants.md).</span></span> <span data-ttu-id="7fa6f-230">這可讓控制項略過不需要繪製的專案，藉此減少系統額外負荷。</span><span class="sxs-lookup"><span data-stu-id="7fa6f-230">This allows the control to skip items that it does not need to draw, thereby decreasing system overhead.</span></span> <span data-ttu-id="7fa6f-231">請記住，傳回這個值表示控制項不會繪製專案的任何部分。</span><span class="sxs-lookup"><span data-stu-id="7fa6f-231">Keep in mind that returning this value means the control will not draw any portion of the item.</span></span>

### <a name="changing-fonts-and-colors"></a><span data-ttu-id="7fa6f-232">變更字型和色彩</span><span class="sxs-lookup"><span data-stu-id="7fa6f-232">Changing fonts and colors</span></span>

<span data-ttu-id="7fa6f-233">您的應用程式可以使用自訂繪製來變更專案的字型。</span><span class="sxs-lookup"><span data-stu-id="7fa6f-233">Your application can use custom draw to change an item's font.</span></span> <span data-ttu-id="7fa6f-234">只要選取您想要的 HFONT 到與自訂繪製通知相關聯之 [**NMCUSTOMDRAW**](/windows/win32/api/commctrl/ns-commctrl-nmcustomdraw)結構的 **hdc** 成員所指定的裝置內容中。</span><span class="sxs-lookup"><span data-stu-id="7fa6f-234">Simply select the HFONT you want into the device context specified by the **hdc** member of the [**NMCUSTOMDRAW**](/windows/win32/api/commctrl/ns-commctrl-nmcustomdraw) structure associated with the custom draw notification.</span></span> <span data-ttu-id="7fa6f-235">由於您選取的字型可能會有不同于預設字型的度量，請確定您在通知訊息的傳回值中包含 [**CDRF \_ NEWFONT**](cdrf-constants.md) 位。</span><span class="sxs-lookup"><span data-stu-id="7fa6f-235">Since the font you select might have different metrics than the default font, make sure you include the [**CDRF\_NEWFONT**](cdrf-constants.md) bit in the return value for the notification message.</span></span> <span data-ttu-id="7fa6f-236">如需使用這項功能的詳細資訊，請參閱 [使用自訂繪製](using-custom-draw.md)的範例程式碼。</span><span class="sxs-lookup"><span data-stu-id="7fa6f-236">For more information on using this functionality, see the sample code in [Using Custom Draw](using-custom-draw.md).</span></span> <span data-ttu-id="7fa6f-237">您的應用程式所指定的字型會用來顯示未選取的專案。</span><span class="sxs-lookup"><span data-stu-id="7fa6f-237">The font that your application specifies is used to display that item when it is not selected.</span></span> <span data-ttu-id="7fa6f-238">自訂繪圖不允許您變更所選取專案的字型屬性。</span><span class="sxs-lookup"><span data-stu-id="7fa6f-238">Custom draw does not allow you to change the font attributes for selected items.</span></span>

<span data-ttu-id="7fa6f-239">若要變更所有支援自訂繪製之控制項的文字色彩，但清單視圖和樹狀檢視除外，只要在自訂繪製通知結構所提供的裝置內容中，使用 [**SetTextColor**](/windows/desktop/api/wingdi/nf-wingdi-settextcolor) 和 [**SetBkColor**](/windows/desktop/api/wingdi/nf-wingdi-setbkcolor) 函式來設定所需的文字和背景色彩。</span><span class="sxs-lookup"><span data-stu-id="7fa6f-239">To change text colors for all controls that support custom draw except for the list view and tree view, simply set the desired text and background colors in the device context supplied in the custom draw notification structure with the [**SetTextColor**](/windows/desktop/api/wingdi/nf-wingdi-settextcolor) and [**SetBkColor**](/windows/desktop/api/wingdi/nf-wingdi-setbkcolor) functions.</span></span> <span data-ttu-id="7fa6f-240">若要修改清單視圖或樹狀檢視中的文字色彩，您需要將所需的色彩值放在 [**NMLVCUSTOMDRAW**](/windows/win32/api/commctrl/ns-commctrl-nmlvcustomdraw)或 [**NMTVCUSTOMDRAW**](/windows/win32/api/commctrl/ns-commctrl-nmtvcustomdraw)結構的 **clrText** 和 **clrTextBk** 成員中。</span><span class="sxs-lookup"><span data-stu-id="7fa6f-240">To modify the text colors in the list view or tree view, you need to place the desired color values in the **clrText** and **clrTextBk** members of the [**NMLVCUSTOMDRAW**](/windows/win32/api/commctrl/ns-commctrl-nmlvcustomdraw) or [**NMTVCUSTOMDRAW**](/windows/win32/api/commctrl/ns-commctrl-nmtvcustomdraw) structure.</span></span>

> [!Note]  
> <span data-ttu-id="7fa6f-241">在 [6.0 版](common-control-versions.md) 的通用控制項之前，工具列會忽略 [**CDRF \_ NEWFONT**](cdrf-constants.md) 旗標。</span><span class="sxs-lookup"><span data-stu-id="7fa6f-241">Prior to [Version 6.0](common-control-versions.md) of the common controls, toolbars ignore the [**CDRF\_NEWFONT**](cdrf-constants.md) flag.</span></span> <span data-ttu-id="7fa6f-242">版本6.0 支援 **CDRF \_ NEWFONT** 旗標，您可以使用它來為工具列選取不同的字型。</span><span class="sxs-lookup"><span data-stu-id="7fa6f-242">Version 6.0 supports the **CDRF\_NEWFONT** flag, and you can use it to select a different font for the toolbar.</span></span> <span data-ttu-id="7fa6f-243">不過，視覺效果樣式為作用中時，您無法變更工具列的色彩。</span><span class="sxs-lookup"><span data-stu-id="7fa6f-243">However, you cannot change a toolbar's color when a visual style is active.</span></span> <span data-ttu-id="7fa6f-244">若要變更6.0 版中的工具列色彩，您必須先藉由呼叫 [**SetWindowTheme**](/windows/desktop/api/Uxtheme/nf-uxtheme-setwindowtheme) 並不指定視覺化樣式來停用視覺化樣式：</span><span class="sxs-lookup"><span data-stu-id="7fa6f-244">To change a toolbar's color in Version 6.0, you must first disable visual styles by calling [**SetWindowTheme**](/windows/desktop/api/Uxtheme/nf-uxtheme-setwindowtheme) and specifying no visual style:</span></span>

 


```
SetWindowTheme (hwnd, "", "");
```



## <a name="custom-draw-with-list-view-and-tree-view-controls"></a><span data-ttu-id="7fa6f-245">使用 List-View 和 Tree-View 控制項的自訂繪圖</span><span class="sxs-lookup"><span data-stu-id="7fa6f-245">Custom Draw With List-View and Tree-View Controls</span></span>

<span data-ttu-id="7fa6f-246">大部分的常見控制項都可以用相同的方式來處理。</span><span class="sxs-lookup"><span data-stu-id="7fa6f-246">Most common controls can be handled in essentially the same way.</span></span> <span data-ttu-id="7fa6f-247">不過，清單視圖和樹狀檢視控制項有一些功能需要稍微不同的方式來自訂繪圖。</span><span class="sxs-lookup"><span data-stu-id="7fa6f-247">However, the list-view and tree-view controls have some features that require a somewhat different approach to custom draw.</span></span>

<span data-ttu-id="7fa6f-248">針對 [版本 5.0](common-control-versions.md)，如果您藉由傳回 [**CDRF \_ NEWFONT**](cdrf-constants.md)來變更字型，則這兩個控制項可能會顯示裁剪的文字。</span><span class="sxs-lookup"><span data-stu-id="7fa6f-248">For [Version 5.0](common-control-versions.md), these two controls may display clipped text if you change the font by returning [**CDRF\_NEWFONT**](cdrf-constants.md).</span></span> <span data-ttu-id="7fa6f-249">這是與舊版通用控制項的回溯相容性所需的行為。</span><span class="sxs-lookup"><span data-stu-id="7fa6f-249">This behavior is necessary for backward compatibility with earlier versions of the common controls.</span></span> <span data-ttu-id="7fa6f-250">如果您想要變更清單視圖或樹狀檢視控制項的字型，如果您在將任何專案加入至控制項之前，將 *wParam* 值設定為5，則會得到更 [**好的結果 \_**](ccm-setversion.md) 。</span><span class="sxs-lookup"><span data-stu-id="7fa6f-250">If you want to change the font of a list-view or tree-view control, you will get better results if you send a [**CCM\_SETVERSION**](ccm-setversion.md) message with the *wParam* value set to 5 before adding any items to the control.</span></span> <span data-ttu-id="7fa6f-251">如需使用自訂繪製的樹狀檢視控制項範例，請參閱知識庫檔 [範例： CustDTv 說明 TreeView 中的自訂繪製 (Q248496) ]( https://support.microsoft.com/default.aspx?scid=kb;EN-US;q248496)。</span><span class="sxs-lookup"><span data-stu-id="7fa6f-251">For an example of a tree-view control that uses custom draw see Knowledge Base article [SAMPLE: CustDTv Illustrates Custom Draw in a TreeView (Q248496)]( https://support.microsoft.com/default.aspx?scid=kb;EN-US;q248496).</span></span>

### <a name="custom-draw-with-list-view-controls"></a><span data-ttu-id="7fa6f-252">使用 List-View 控制項的自訂繪圖</span><span class="sxs-lookup"><span data-stu-id="7fa6f-252">Custom Draw With List-View Controls</span></span>

<span data-ttu-id="7fa6f-253">由於清單視圖控制項有子工作和多個顯示模式，因此您必須以不同于其他常見控制項的方式來處理 [NM \_ CUSTOMDRAW](nm-customdraw.md) 通知。</span><span class="sxs-lookup"><span data-stu-id="7fa6f-253">Because list-view controls have subitems and multiple display modes, you will need to handle the [NM\_CUSTOMDRAW](nm-customdraw.md) notification somewhat differently than for the other common controls.</span></span>

<span data-ttu-id="7fa6f-254">若為報表模式，請使用下列程式。</span><span class="sxs-lookup"><span data-stu-id="7fa6f-254">For report mode, use the following procedure.</span></span>

1.  <span data-ttu-id="7fa6f-255">第一個 [NM \_ CUSTOMDRAW](nm-customdraw.md)通知會將相關聯 [**NMCUSTOMDRAW**](/windows/win32/api/commctrl/ns-commctrl-nmcustomdraw)結構的 **dwDrawStage** 成員設為 CDDS \_ PREPAINT。</span><span class="sxs-lookup"><span data-stu-id="7fa6f-255">The first [NM\_CUSTOMDRAW](nm-customdraw.md) notification will have the **dwDrawStage** member of the associated [**NMCUSTOMDRAW**](/windows/win32/api/commctrl/ns-commctrl-nmcustomdraw) structure set to CDDS\_PREPAINT.</span></span> <span data-ttu-id="7fa6f-256">傳回 [**CDRF \_ NOTIFYITEMDRAW**](cdrf-constants.md)。</span><span class="sxs-lookup"><span data-stu-id="7fa6f-256">Return [**CDRF\_NOTIFYITEMDRAW**](cdrf-constants.md).</span></span>
2.  <span data-ttu-id="7fa6f-257">然後，您會收到具有 **dwDrawStage** 設定為 CDDS ITEMPREPAINT 的 [NM \_ CUSTOMDRAW](nm-customdraw.md)通知 \_ 。</span><span class="sxs-lookup"><span data-stu-id="7fa6f-257">You will then receive an [NM\_CUSTOMDRAW](nm-customdraw.md) notification with **dwDrawStage** set to CDDS\_ITEMPREPAINT.</span></span> <span data-ttu-id="7fa6f-258">如果您指定新的字型或色彩並傳回 [**CDRF \_ NEWFONT**](cdrf-constants.md)，則會變更專案的所有子專案。</span><span class="sxs-lookup"><span data-stu-id="7fa6f-258">If you specify new fonts or colors and return [**CDRF\_NEWFONT**](cdrf-constants.md), all subitems of the item will be changed.</span></span> <span data-ttu-id="7fa6f-259">如果您想要改為個別處理每個子項，請傳回 [**CDRF \_ NOTIFYSUBITEMDRAW**](cdrf-constants.md)。</span><span class="sxs-lookup"><span data-stu-id="7fa6f-259">If you want instead to handle each subitem separately, return [**CDRF\_NOTIFYSUBITEMDRAW**](cdrf-constants.md).</span></span>
3.  <span data-ttu-id="7fa6f-260">如果您在上一個步驟中傳回 [**CDRF \_ NOTIFYSUBITEMDRAW**](cdrf-constants.md) ，您就會收到每個子項的 [NM \_ CUSTOMDRAW](nm-customdraw.md) 通知， **dwDrawStage** 設定為 CDDS 子工作 \_ \| CDDS \_ ITEMPREPAINT。</span><span class="sxs-lookup"><span data-stu-id="7fa6f-260">If you returned [**CDRF\_NOTIFYSUBITEMDRAW**](cdrf-constants.md) in the previous step, you will then receive an [NM\_CUSTOMDRAW](nm-customdraw.md) notification for each subitem with **dwDrawStage** set to CDDS\_SUBITEM \| CDDS\_ITEMPREPAINT.</span></span> <span data-ttu-id="7fa6f-261">若要變更該子工作的字型或色彩，請指定新的字型或色彩，並傳回 [**CDRF \_ NEWFONT**](cdrf-constants.md)。</span><span class="sxs-lookup"><span data-stu-id="7fa6f-261">To change the font or color for that subitem, specify a new font or color and return [**CDRF\_NEWFONT**](cdrf-constants.md).</span></span>

<span data-ttu-id="7fa6f-262">針對大型圖示、小型圖示和清單模式，請使用下列程式。</span><span class="sxs-lookup"><span data-stu-id="7fa6f-262">For the large icon, small icon, and list modes, use the following procedure.</span></span>

1.  <span data-ttu-id="7fa6f-263">第一個 [NM \_ CUSTOMDRAW](nm-customdraw.md)通知會將相關聯 [**NMCUSTOMDRAW**](/windows/win32/api/commctrl/ns-commctrl-nmcustomdraw)結構的 **dwDrawStage** 成員設為 CDDS \_ PREPAINT。</span><span class="sxs-lookup"><span data-stu-id="7fa6f-263">The first [NM\_CUSTOMDRAW](nm-customdraw.md) notification will have the **dwDrawStage** member of the associated [**NMCUSTOMDRAW**](/windows/win32/api/commctrl/ns-commctrl-nmcustomdraw) structure set to CDDS\_PREPAINT.</span></span> <span data-ttu-id="7fa6f-264">傳回 [**CDRF \_ NOTIFYITEMDRAW**](cdrf-constants.md)。</span><span class="sxs-lookup"><span data-stu-id="7fa6f-264">Return [**CDRF\_NOTIFYITEMDRAW**](cdrf-constants.md).</span></span>
2.  <span data-ttu-id="7fa6f-265">然後，您會收到具有 **dwDrawStage** 設定為 CDDS ITEMPREPAINT 的 [NM \_ CUSTOMDRAW](nm-customdraw.md)通知 \_ 。</span><span class="sxs-lookup"><span data-stu-id="7fa6f-265">You will then receive an [NM\_CUSTOMDRAW](nm-customdraw.md) notification with **dwDrawStage** set to CDDS\_ITEMPREPAINT.</span></span> <span data-ttu-id="7fa6f-266">您可以藉由指定新的字型和色彩並傳回 [**CDRF \_ NEWFONT**](cdrf-constants.md)，來變更專案的字型或色彩。</span><span class="sxs-lookup"><span data-stu-id="7fa6f-266">You can change the fonts or colors of an item by specifying new fonts and colors and returning [**CDRF\_NEWFONT**](cdrf-constants.md).</span></span> <span data-ttu-id="7fa6f-267">因為這些模式沒有子項，所以您不會收到任何額外的 NM \_ CUSTOMDRAW 通知。</span><span class="sxs-lookup"><span data-stu-id="7fa6f-267">Because these modes do not have subitems, you will not receive any additional NM\_CUSTOMDRAW notifications.</span></span>

<span data-ttu-id="7fa6f-268">如需清單-view [NM \_ CUSTOMDRAW](nm-customdraw.md) 通知處理常式的範例，請參閱 [使用自訂繪製](using-custom-draw.md)。</span><span class="sxs-lookup"><span data-stu-id="7fa6f-268">For an example of a list-view [NM\_CUSTOMDRAW](nm-customdraw.md) notification handler, see [Using Custom Draw](using-custom-draw.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="7fa6f-269">相關主題</span><span class="sxs-lookup"><span data-stu-id="7fa6f-269">Related topics</span></span>

<dl> <dt>

<span data-ttu-id="7fa6f-270">**概念**</span><span class="sxs-lookup"><span data-stu-id="7fa6f-270">**Conceptual**</span></span>
</dt> <dt>

[<span data-ttu-id="7fa6f-271">使用自訂繪圖</span><span class="sxs-lookup"><span data-stu-id="7fa6f-271">Using Custom Draw</span></span>](using-custom-draw.md)
</dt> <dt>

[<span data-ttu-id="7fa6f-272">自訂繪圖參考</span><span class="sxs-lookup"><span data-stu-id="7fa6f-272">Custom Draw Reference</span></span>](custom-draw-reference.md)
</dt> <dt>

<span data-ttu-id="7fa6f-273">**其他資源**</span><span class="sxs-lookup"><span data-stu-id="7fa6f-273">**Other Resources**</span></span>
</dt> <dt>

[<span data-ttu-id="7fa6f-274">範例： CustDTv 說明 TreeView 中的自訂繪製 (Q248496) </span><span class="sxs-lookup"><span data-stu-id="7fa6f-274">SAMPLE: CustDTv Illustrates Custom Draw in a TreeView (Q248496)</span></span>]( https://support.microsoft.com/default.aspx?scid=kb;EN-US;q248496)
</dt> </dl>

 

 