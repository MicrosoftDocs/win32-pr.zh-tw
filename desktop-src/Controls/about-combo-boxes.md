---
title: 關於下拉式方塊
description: 本節討論不同類型的下拉式方塊。
ms.assetid: 76410a87-aa0e-4da9-9e78-c80ac485e3cd
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 344596a3c0aa772568956344aaddcc053b534993
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/21/2020
ms.locfileid: "104559739"
---
# <a name="about-combo-boxes"></a><span data-ttu-id="5bad6-103">關於下拉式方塊</span><span class="sxs-lookup"><span data-stu-id="5bad6-103">About Combo Boxes</span></span>

<span data-ttu-id="5bad6-104">下拉式方塊結合了編輯方塊或靜態文字和清單。</span><span class="sxs-lookup"><span data-stu-id="5bad6-104">A combo box combines an edit box or static text and a list.</span></span>

<span data-ttu-id="5bad6-105">本主題包含下列各節。</span><span class="sxs-lookup"><span data-stu-id="5bad6-105">This topic contains the following sections.</span></span>

-   [<span data-ttu-id="5bad6-106">下拉式列示方塊類型和樣式</span><span class="sxs-lookup"><span data-stu-id="5bad6-106">Combo Box Types and Styles</span></span>](#combo-box-types-and-styles)
-   [<span data-ttu-id="5bad6-107">下拉式方塊清單</span><span class="sxs-lookup"><span data-stu-id="5bad6-107">Combo Box List</span></span>](#combo-box-list)
    -   [<span data-ttu-id="5bad6-108">目前的選取範圍</span><span class="sxs-lookup"><span data-stu-id="5bad6-108">Current Selection</span></span>](#current-selection)
    -   [<span data-ttu-id="5bad6-109">下拉式清單</span><span class="sxs-lookup"><span data-stu-id="5bad6-109">Drop-down Lists</span></span>](#drop-down-lists)
    -   [<span data-ttu-id="5bad6-110">清單內容</span><span class="sxs-lookup"><span data-stu-id="5bad6-110">List Contents</span></span>](#list-contents)
-   [<span data-ttu-id="5bad6-111">編輯控制項選取欄位</span><span class="sxs-lookup"><span data-stu-id="5bad6-111">Edit Control Selection Fields</span></span>](#edit-control-selection-fields)
-   [<span data-ttu-id="5bad6-112">擁有者繪製的下拉式方塊</span><span class="sxs-lookup"><span data-stu-id="5bad6-112">Owner-Drawn Combo Boxes</span></span>](#owner-drawn-combo-boxes)
-   [<span data-ttu-id="5bad6-113">子類別化下拉式方塊</span><span class="sxs-lookup"><span data-stu-id="5bad6-113">Subclassed Combo Boxes</span></span>](#subclassed-combo-boxes)

## <a name="combo-box-types-and-styles"></a><span data-ttu-id="5bad6-114">下拉式列示方塊類型和樣式</span><span class="sxs-lookup"><span data-stu-id="5bad6-114">Combo Box Types and Styles</span></span>

<span data-ttu-id="5bad6-115">下拉式方塊包含清單和選取欄位。</span><span class="sxs-lookup"><span data-stu-id="5bad6-115">A combo box consists of a list and a selection field.</span></span> <span data-ttu-id="5bad6-116">此清單會顯示使用者可以選取的選項，而 [選取範圍] 欄位則會顯示目前的選取專案。</span><span class="sxs-lookup"><span data-stu-id="5bad6-116">The list presents the options that a user can select, and the selection field displays the current selection.</span></span> <span data-ttu-id="5bad6-117">如果選取欄位是編輯控制項，則使用者可以輸入清單中未提供的資訊;否則，使用者只能選取清單中的專案。</span><span class="sxs-lookup"><span data-stu-id="5bad6-117">If the selection field is an edit control, the user can enter information not available in the list; otherwise, the user can only select items in the list.</span></span>

<span data-ttu-id="5bad6-118">通用控制項程式庫包含三種主要的下拉式列示方塊樣式，如下表所示。</span><span class="sxs-lookup"><span data-stu-id="5bad6-118">The common controls library includes three main styles of combo box, as shown in the following table.</span></span>



| <span data-ttu-id="5bad6-119">下拉式列示方塊類型</span><span class="sxs-lookup"><span data-stu-id="5bad6-119">Combo box type</span></span>             | <span data-ttu-id="5bad6-120">樣式常數</span><span class="sxs-lookup"><span data-stu-id="5bad6-120">Style constant</span></span>                                                 | <span data-ttu-id="5bad6-121">Description</span><span class="sxs-lookup"><span data-stu-id="5bad6-121">Description</span></span>                                                                                  |
|----------------------------|----------------------------------------------------------------|----------------------------------------------------------------------------------------------|
| <span data-ttu-id="5bad6-122">簡單</span><span class="sxs-lookup"><span data-stu-id="5bad6-122">Simple</span></span>                     | [<span data-ttu-id="5bad6-123">**CBS \_ 簡單**</span><span class="sxs-lookup"><span data-stu-id="5bad6-123">**CBS\_SIMPLE**</span></span>](combo-box-styles.md)             | <span data-ttu-id="5bad6-124">每次都會顯示清單，並在編輯控制項中顯示選取的專案。</span><span class="sxs-lookup"><span data-stu-id="5bad6-124">Displays the list at all times, and shows the selected item in an edit control.</span></span>              |
| <span data-ttu-id="5bad6-125">Drop-down</span><span class="sxs-lookup"><span data-stu-id="5bad6-125">Drop-down</span></span>                  | [<span data-ttu-id="5bad6-126">**CBS \_ 下拉式清單**</span><span class="sxs-lookup"><span data-stu-id="5bad6-126">**CBS\_DROPDOWN**</span></span>](combo-box-styles.md)         | <span data-ttu-id="5bad6-127">當您按一下圖示時，會顯示清單，並在編輯控制項中顯示選取的專案。</span><span class="sxs-lookup"><span data-stu-id="5bad6-127">Displays the list when the icon is clicked, and shows the selected item in an edit control.</span></span>  |
| <span data-ttu-id="5bad6-128">下拉式清單 (下拉清單) </span><span class="sxs-lookup"><span data-stu-id="5bad6-128">Drop-down list (drop list)</span></span> | [<span data-ttu-id="5bad6-129">**CBS \_ DROPDOWNLIST**</span><span class="sxs-lookup"><span data-stu-id="5bad6-129">**CBS\_DROPDOWNLIST**</span></span>](combo-box-styles.md) | <span data-ttu-id="5bad6-130">當您按一下圖示時，會顯示清單，並在靜態控制項中顯示選取的專案。</span><span class="sxs-lookup"><span data-stu-id="5bad6-130">Displays the list when the icon is clicked, and shows the selected item in a static control.</span></span> |



 

<span data-ttu-id="5bad6-131">下列螢幕擷取畫面會顯示三種下拉式方塊，因為它們可能出現在 Windows Vista 中。</span><span class="sxs-lookup"><span data-stu-id="5bad6-131">The following screen shots each show the three kinds of combo box as they might appear in Windows Vista.</span></span> <span data-ttu-id="5bad6-132">在第一個螢幕擷取畫面中，使用者已在 [簡單] 下拉式方塊中選取專案。</span><span class="sxs-lookup"><span data-stu-id="5bad6-132">In the first screen shot, the user has selected an item in the simple combo box.</span></span> <span data-ttu-id="5bad6-133">使用者也可以在這個控制項的編輯方塊中輸入新值。</span><span class="sxs-lookup"><span data-stu-id="5bad6-133">The user can also type a new value in the edit box of this control.</span></span> <span data-ttu-id="5bad6-134">清單已在 Microsoft Visual Studio 資源編輯器中調整大小，只夠大以容納兩個專案。</span><span class="sxs-lookup"><span data-stu-id="5bad6-134">The list has been sized in the Microsoft Visual Studio resource editor and is only large enough to accommodate two items.</span></span>

![顯示簡單下拉式方塊中所選取專案的螢幕擷取畫面](images/simplecombo.png)

<span data-ttu-id="5bad6-136">在第二個螢幕擷取畫面中，使用者在下拉式方塊的編輯控制項中輸入了新文字。</span><span class="sxs-lookup"><span data-stu-id="5bad6-136">In the second screen shot, the user has typed new text in the edit control of the drop-down combo box.</span></span> <span data-ttu-id="5bad6-137">使用者也可以選取現有的專案。</span><span class="sxs-lookup"><span data-stu-id="5bad6-137">The user could also have selected an existing item.</span></span> <span data-ttu-id="5bad6-138">清單方塊會展開以容納盡可能多的專案。</span><span class="sxs-lookup"><span data-stu-id="5bad6-138">The list box expands to accommodate as many items as possible.</span></span>

![顯示輸入至下拉式方塊之文字的螢幕擷取畫面](images/dropdown.png)

<span data-ttu-id="5bad6-140">在第三個螢幕擷取畫面中，使用者已開啟下拉式清單下拉式方塊。</span><span class="sxs-lookup"><span data-stu-id="5bad6-140">In the third screen shot, the user has opened the drop-down list combo box.</span></span> <span data-ttu-id="5bad6-141">清單方塊會展開以容納盡可能多的專案。</span><span class="sxs-lookup"><span data-stu-id="5bad6-141">The list box expands to accommodate as many items as possible.</span></span> <span data-ttu-id="5bad6-142">使用者無法輸入新文字。</span><span class="sxs-lookup"><span data-stu-id="5bad6-142">The user cannot enter new text.</span></span>

![顯示下拉式清單下拉式方塊中所選取專案的螢幕擷取畫面](images/droplist.png)

<span data-ttu-id="5bad6-144">另外還有一些定義特定屬性的下拉式列示方塊樣式。</span><span class="sxs-lookup"><span data-stu-id="5bad6-144">There are also a number of combo box styles that define specific properties.</span></span> <span data-ttu-id="5bad6-145">下拉式列示方塊樣式會定義下拉式方塊的特定屬性。</span><span class="sxs-lookup"><span data-stu-id="5bad6-145">Combo box styles define specific properties of a combo box.</span></span> <span data-ttu-id="5bad6-146">您可以結合樣式;不過，某些樣式只適用于特定的下拉式列示方塊類型。</span><span class="sxs-lookup"><span data-stu-id="5bad6-146">You can combine styles; however, some styles apply only to certain combo box types.</span></span> <span data-ttu-id="5bad6-147">如需下拉式列示方塊樣式的表格，請參閱 [下拉式列示方塊樣式](combo-box-styles.md)。</span><span class="sxs-lookup"><span data-stu-id="5bad6-147">For a table of combo box styles, see [Combo Box Styles](combo-box-styles.md).</span></span>

> [!Note]  
> <span data-ttu-id="5bad6-148">若要搭配使用視覺化樣式與下拉式方塊，應用程式必須包含資訊清單，而且必須在程式的開頭呼叫 [**InitCommonControls**](/windows/desktop/api/Commctrl/nf-commctrl-initcommoncontrols) 。</span><span class="sxs-lookup"><span data-stu-id="5bad6-148">To use visual styles with combo boxes, an application must include a manifest and must call [**InitCommonControls**](/windows/desktop/api/Commctrl/nf-commctrl-initcommoncontrols) at the beginning of the program.</span></span> <span data-ttu-id="5bad6-149">如需視覺化樣式的詳細資訊，請參閱 [視覺化樣式](themes-overview.md)。</span><span class="sxs-lookup"><span data-stu-id="5bad6-149">For information on visual styles, see [Visual Styles](themes-overview.md).</span></span> <span data-ttu-id="5bad6-150">如需資訊清單的詳細資訊，請參閱 [啟用視覺化樣式](cookbook-overview.md)。</span><span class="sxs-lookup"><span data-stu-id="5bad6-150">For information on manifests, see [Enabling Visual Styles](cookbook-overview.md).</span></span>

 

## <a name="combo-box-list"></a><span data-ttu-id="5bad6-151">下拉式方塊清單</span><span class="sxs-lookup"><span data-stu-id="5bad6-151">Combo Box List</span></span>

<span data-ttu-id="5bad6-152">此清單是下拉式方塊的一部分，可顯示使用者可以選取的專案。</span><span class="sxs-lookup"><span data-stu-id="5bad6-152">The list is the portion of a combo box that displays the items a user can select.</span></span> <span data-ttu-id="5bad6-153">一般而言，應用程式會在建立下拉式方塊時，初始化清單的內容。</span><span class="sxs-lookup"><span data-stu-id="5bad6-153">Typically, an application initializes the contents of the list when it creates a combo box.</span></span> <span data-ttu-id="5bad6-154">使用者選取的任何清單專案都是 *目前的選取* 專案。</span><span class="sxs-lookup"><span data-stu-id="5bad6-154">Any list item selected by the user is the *current selection*.</span></span> <span data-ttu-id="5bad6-155">無法選取多個專案。</span><span class="sxs-lookup"><span data-stu-id="5bad6-155">Multiple items cannot be selected.</span></span> <span data-ttu-id="5bad6-156">在 [簡單] 和 [下拉式] 下拉式方塊中，使用者可以輸入選取欄位，而不是選取清單專案。</span><span class="sxs-lookup"><span data-stu-id="5bad6-156">In simple and drop-down combo boxes, the user can type in the selection field instead of selecting a list item.</span></span> <span data-ttu-id="5bad6-157">在這些情況下，沒有目前的選取專案，而且應用程式必須負責將專案新增至清單，並使其成為目前的選取專案（如果適合的話）。</span><span class="sxs-lookup"><span data-stu-id="5bad6-157">In these cases, there is no current selection, and it is the application's responsibility to add the item to the list and make it the current selection, if it is appropriate to do so.</span></span>

<span data-ttu-id="5bad6-158">本節將討論下列主題：</span><span class="sxs-lookup"><span data-stu-id="5bad6-158">This section discusses following topics:</span></span>

-   [<span data-ttu-id="5bad6-159">目前的選取範圍</span><span class="sxs-lookup"><span data-stu-id="5bad6-159">Current Selection</span></span>](#current-selection)
-   [<span data-ttu-id="5bad6-160">下拉式清單</span><span class="sxs-lookup"><span data-stu-id="5bad6-160">Drop-down Lists</span></span>](#drop-down-lists)
-   [<span data-ttu-id="5bad6-161">清單內容</span><span class="sxs-lookup"><span data-stu-id="5bad6-161">List Contents</span></span>](#list-contents)

### <a name="current-selection"></a><span data-ttu-id="5bad6-162">目前的選取範圍</span><span class="sxs-lookup"><span data-stu-id="5bad6-162">Current Selection</span></span>

<span data-ttu-id="5bad6-163">目前的選取範圍是使用者已選取的清單專案;選取的文字會出現在下拉式方塊的 [選取範圍] 欄位中。</span><span class="sxs-lookup"><span data-stu-id="5bad6-163">The current selection is a list item that the user has selected; the selected text appears in the selection field of the combo box.</span></span> <span data-ttu-id="5bad6-164">不過，在簡單下拉式方塊或下拉式方塊的案例中，目前的選取範圍只是下拉式方塊中一種可能的使用者輸入形式。</span><span class="sxs-lookup"><span data-stu-id="5bad6-164">However, in the case of a simple combo box or a drop-down combo box, the current selection is only one form of possible user input in a combo box.</span></span> <span data-ttu-id="5bad6-165">使用者也可以在 [選取範圍] 欄位中輸入文字。</span><span class="sxs-lookup"><span data-stu-id="5bad6-165">The user can also type text in the selection field.</span></span>

<span data-ttu-id="5bad6-166">目前的選取範圍是由所選取清單專案以零為起始的索引來識別。</span><span class="sxs-lookup"><span data-stu-id="5bad6-166">The current selection is identified by the zero-based index of the selected list item.</span></span> <span data-ttu-id="5bad6-167">應用程式隨時都可以設定和取出。</span><span class="sxs-lookup"><span data-stu-id="5bad6-167">An application can set and retrieve it at any time.</span></span> <span data-ttu-id="5bad6-168">當使用者變更下拉式方塊的目前選取範圍時，父視窗或對話方塊程式會收到通知。</span><span class="sxs-lookup"><span data-stu-id="5bad6-168">The parent window or dialog box procedure receives notification when the user changes the current selection for a combo box.</span></span> <span data-ttu-id="5bad6-169">當應用程式變更選取專案時，不會通知父視窗或對話方塊。</span><span class="sxs-lookup"><span data-stu-id="5bad6-169">The parent window or dialog box is not notified when the application changes the selection.</span></span>

<span data-ttu-id="5bad6-170">建立下拉式方塊時，沒有目前的選取範圍。</span><span class="sxs-lookup"><span data-stu-id="5bad6-170">When a combo box is created, there is no current selection.</span></span> <span data-ttu-id="5bad6-171">如果使用者已編輯選取欄位的內容，則這也適用于簡單或下拉式方塊。</span><span class="sxs-lookup"><span data-stu-id="5bad6-171">This is also true for a simple or drop-down combo box, if the user has edited the contents of the selection field.</span></span> <span data-ttu-id="5bad6-172">若要設定目前的選取專案，應用程式會將 [**CB \_ SETCURSEL**](cb-setcursel.md) 訊息傳送至下拉式方塊。</span><span class="sxs-lookup"><span data-stu-id="5bad6-172">To set the current selection, an application sends the [**CB\_SETCURSEL**](cb-setcursel.md) message to the combo box.</span></span> <span data-ttu-id="5bad6-173">應用程式也可以使用 [**CB \_ SELECTSTRING**](cb-selectstring.md) 訊息，將目前的選取範圍設定為其字串開頭為指定字串的清單專案。</span><span class="sxs-lookup"><span data-stu-id="5bad6-173">An application can also use the [**CB\_SELECTSTRING**](cb-selectstring.md) message to set the current selection to a list item whose string begins with a specified string.</span></span> <span data-ttu-id="5bad6-174">若要判斷目前的選取專案，應用程式會將 [**CB \_ GETCURSEL**](cb-getcursel.md) 訊息傳送至下拉式方塊。</span><span class="sxs-lookup"><span data-stu-id="5bad6-174">To determine the current selection, an application sends the [**CB\_GETCURSEL**](cb-getcursel.md) message to the combo box.</span></span> <span data-ttu-id="5bad6-175">如果目前沒有選取範圍，則此訊息會傳回 CB \_ ERR。</span><span class="sxs-lookup"><span data-stu-id="5bad6-175">If there is no current selection, this message returns CB\_ERR.</span></span>

<span data-ttu-id="5bad6-176">當使用者變更下拉式方塊中目前的選取範圍時，父視窗或對話方塊程式會使用 *wParam* 參數的高序位字組中的 [CBN \_ SELCHANGE](cbn-selchange.md)通知碼來接收 [**WM \_ 命令**](/windows/desktop/menurc/wm-command)訊息。</span><span class="sxs-lookup"><span data-stu-id="5bad6-176">When the user changes the current selection in a combo box, the parent window or dialog-box procedure receives a [**WM\_COMMAND**](/windows/desktop/menurc/wm-command) message with the [CBN\_SELCHANGE](cbn-selchange.md) notification code in the high-order word of the *wParam* parameter.</span></span> <span data-ttu-id="5bad6-177">使用 [**CB \_ SETCURSEL**](cb-setcursel.md) 訊息設定目前的選取範圍時，不會傳送此通知碼。</span><span class="sxs-lookup"><span data-stu-id="5bad6-177">This notification code is not sent when the current selection is set using the [**CB\_SETCURSEL**](cb-setcursel.md) message.</span></span>

<span data-ttu-id="5bad6-178">下拉式清單方塊或下拉式清單方塊會在下拉式清單關閉時，將 [CBN \_ 特寫](cbn-closeup.md) 通知程式碼傳送至父視窗或對話方塊程式。</span><span class="sxs-lookup"><span data-stu-id="5bad6-178">A drop-down combo box or drop-down list box sends the [CBN\_CLOSEUP](cbn-closeup.md) notification code to the parent window or dialog-box procedure when the drop-down list closes.</span></span> <span data-ttu-id="5bad6-179">如果使用者變更目前的選取範圍，下拉式方塊也會在下拉式清單關閉時傳送 [CBN \_ SELCHANGE](cbn-selchange.md) 通知碼。</span><span class="sxs-lookup"><span data-stu-id="5bad6-179">If the user changed the current selection, the combo box also sends the [CBN\_SELCHANGE](cbn-selchange.md) notification code when the drop-down list closes.</span></span> <span data-ttu-id="5bad6-180">若要在每次使用者選取清單專案時執行特定進程，您可以處理 CBN \_ SELCHANGE 或 CBN \_ 特寫通知碼。</span><span class="sxs-lookup"><span data-stu-id="5bad6-180">To execute a specific process each time the user selects a list item, you can handle either the CBN\_SELCHANGE or CBN\_CLOSEUP notification code.</span></span> <span data-ttu-id="5bad6-181">一般來說，您會先等候 CBN \_ 特寫通知碼，再處理目前選取範圍內的變更。</span><span class="sxs-lookup"><span data-stu-id="5bad6-181">Typically, you would wait for the CBN\_CLOSEUP notification code before processing a change in the current selection.</span></span> <span data-ttu-id="5bad6-182">如果需要大量的處理，這可能特別重要。</span><span class="sxs-lookup"><span data-stu-id="5bad6-182">This can be particularly important if a significant amount of processing is required.</span></span>

<span data-ttu-id="5bad6-183">應用程式也可以處理 [CBN \_ SELENDOK](cbn-selendok.md) 和 [CBN \_ SELENDCANCEL](cbn-selendcancel.md) 通知碼。</span><span class="sxs-lookup"><span data-stu-id="5bad6-183">An application could also process the [CBN\_SELENDOK](cbn-selendok.md) and [CBN\_SELENDCANCEL](cbn-selendcancel.md) notification codes.</span></span> <span data-ttu-id="5bad6-184">\_當使用者選取清單專案時，系統會傳送 CBN SELENDOK，或選取專案然後關閉清單。</span><span class="sxs-lookup"><span data-stu-id="5bad6-184">The system sends CBN\_SELENDOK when the user selects a list item, or selects an item and then closes the list.</span></span> <span data-ttu-id="5bad6-185">這表示使用者已完成，而且應該處理選取的專案。</span><span class="sxs-lookup"><span data-stu-id="5bad6-185">This indicates that the user has finished, and that the selection should be processed.</span></span> <span data-ttu-id="5bad6-186">CBN \_ SELENDCANCEL 會在使用者選取專案時傳送，但接著會選取另一個控制項，在下拉式清單開啟時按下 ESC 鍵，或關閉對話方塊。</span><span class="sxs-lookup"><span data-stu-id="5bad6-186">CBN\_SELENDCANCEL is sent when the user selects an item, but then selects another control, presses ESC while the drop-down list is open, or closes the dialog box.</span></span> <span data-ttu-id="5bad6-187">這表示應該忽略使用者的選取專案。</span><span class="sxs-lookup"><span data-stu-id="5bad6-187">This indicates that the user's selection should be ignored.</span></span> <span data-ttu-id="5bad6-188">CBN \_ SELENDOK 會在每個 [CBN \_ SELCHANGE](cbn-selchange.md) 訊息之前傳送。</span><span class="sxs-lookup"><span data-stu-id="5bad6-188">CBN\_SELENDOK is sent before every [CBN\_SELCHANGE](cbn-selchange.md) message.</span></span>

<span data-ttu-id="5bad6-189">在簡單的下拉式方塊中，當使用者按兩下清單專案時，系統會傳送 [CBN \_ DBLCLK](cbn-dblclk.md) 通知碼。</span><span class="sxs-lookup"><span data-stu-id="5bad6-189">In a simple combo box, the system sends the [CBN\_DBLCLK](cbn-dblclk.md) notification code when the user double-clicks a list item.</span></span> <span data-ttu-id="5bad6-190">在下拉式清單方塊或下拉式清單中，按一下即會隱藏清單，因此不可能按兩下某個專案。</span><span class="sxs-lookup"><span data-stu-id="5bad6-190">In a drop-down combo box or drop-down list, a single click hides the list, so it is not possible to double-click an item.</span></span>

### <a name="drop-down-lists"></a><span data-ttu-id="5bad6-191">下拉式清單</span><span class="sxs-lookup"><span data-stu-id="5bad6-191">Drop-down Lists</span></span>

<span data-ttu-id="5bad6-192">某些通知和訊息只適用于包含下拉式清單的下拉式方塊。</span><span class="sxs-lookup"><span data-stu-id="5bad6-192">Certain notifications and messages apply only to combo boxes containing drop-down lists.</span></span> <span data-ttu-id="5bad6-193">當下拉式清單已開啟或關閉時，下拉式方塊的父視窗會以 [**WM \_ 命令**](/windows/desktop/menurc/wm-command) 訊息的形式接收通知。</span><span class="sxs-lookup"><span data-stu-id="5bad6-193">When a drop-down list is open or closed, the parent window of a combo box receives a notification in the form of a [**WM\_COMMAND**](/windows/desktop/menurc/wm-command) message.</span></span> <span data-ttu-id="5bad6-194">如果正在開啟清單， *wParam* 的高序位字是 [CBN \_ 下拉式](cbn-dropdown.md)清單。</span><span class="sxs-lookup"><span data-stu-id="5bad6-194">If the list is being opened, the high-order word of *wParam* is [CBN\_DROPDOWN](cbn-dropdown.md).</span></span> <span data-ttu-id="5bad6-195">如果清單已關閉，則為 [CBN \_ 特寫](cbn-closeup.md)。</span><span class="sxs-lookup"><span data-stu-id="5bad6-195">If the list is being closed, it is [CBN\_CLOSEUP](cbn-closeup.md).</span></span>

<span data-ttu-id="5bad6-196">應用程式可以使用 [**CB \_ SHOWDROPDOWN**](cb-showdropdown.md) 訊息開啟下拉式方塊或下拉式清單方塊的清單。</span><span class="sxs-lookup"><span data-stu-id="5bad6-196">An application can open the list of a drop-down combo box or drop-down list box by using the [**CB\_SHOWDROPDOWN**](cb-showdropdown.md) message.</span></span> <span data-ttu-id="5bad6-197">它可以使用 [**cb \_ GETDROPPEDSTATE**](cb-getdroppedstate.md) 訊息來判斷清單是否開啟，並且可以使用 [**cb \_ GETDROPPEDCONTROLRECT**](cb-getdroppedcontrolrect.md) 訊息來判斷下拉式清單的座標。</span><span class="sxs-lookup"><span data-stu-id="5bad6-197">It can determine whether the list is open by using the [**CB\_GETDROPPEDSTATE**](cb-getdroppedstate.md) message and can determine the coordinates of a drop-down list by using the [**CB\_GETDROPPEDCONTROLRECT**](cb-getdroppedcontrolrect.md) message.</span></span> <span data-ttu-id="5bad6-198">應用程式也可以使用 [**CB \_ SETDROPPEDWIDTH**](cb-setdroppedwidth.md) 訊息來增加下拉式清單的寬度。</span><span class="sxs-lookup"><span data-stu-id="5bad6-198">An application can also increase the width of a drop-down list by using the [**CB\_SETDROPPEDWIDTH**](cb-setdroppedwidth.md) message.</span></span>

### <a name="list-contents"></a><span data-ttu-id="5bad6-199">清單內容</span><span class="sxs-lookup"><span data-stu-id="5bad6-199">List Contents</span></span>

<span data-ttu-id="5bad6-200">當應用程式建立下拉式方塊時，通常會藉由將一或多個專案加入至清單來初始化下拉式方塊。</span><span class="sxs-lookup"><span data-stu-id="5bad6-200">When an application creates a combo box, it typically initializes the combo box by adding one or more items to the list.</span></span> <span data-ttu-id="5bad6-201">之後，應用程式可以加入或刪除清單專案、重新初始化清單，或從中取出專案資訊。</span><span class="sxs-lookup"><span data-stu-id="5bad6-201">Later, an application may add or delete list items, reinitialize the list, or retrieve item information from it.</span></span>

<span data-ttu-id="5bad6-202">應用程式會將 [**CB \_ ADDSTRING**](cb-addstring.md) 訊息傳送給下拉式方塊，以將清單專案新增至下拉式方塊。</span><span class="sxs-lookup"><span data-stu-id="5bad6-202">An application adds list items to a combo box by sending the [**CB\_ADDSTRING**](cb-addstring.md) message to it.</span></span> <span data-ttu-id="5bad6-203">指定的專案會加入至清單的結尾，或在排序的下拉式方塊中，根據專案的字串以正確排序的位置加入。</span><span class="sxs-lookup"><span data-stu-id="5bad6-203">The specified item is added to the end of the list or, in a sorted combo box, in its correct sorted position based on the item's string.</span></span> <span data-ttu-id="5bad6-204">在未排序的下拉式方塊中，應用程式可以使用 [**CB \_ INSERTSTRING**](cb-insertstring.md) 訊息，在特定位置插入專案。</span><span class="sxs-lookup"><span data-stu-id="5bad6-204">In an unsorted combo box, an application can use the [**CB\_INSERTSTRING**](cb-insertstring.md) message to insert an item at a specific position.</span></span> <span data-ttu-id="5bad6-205">加入之後，清單專案的位置就會識別。</span><span class="sxs-lookup"><span data-stu-id="5bad6-205">Once added, a list item is identified by its position.</span></span>

<span data-ttu-id="5bad6-206">藉由使用 [**CB \_ FINDSTRING**](cb-findstring.md) 或 [**cb \_ FINDSTRINGEXACT**](cb-findstringexact.md) 訊息，應用程式可以決定清單專案的位置。</span><span class="sxs-lookup"><span data-stu-id="5bad6-206">By using the [**CB\_FINDSTRING**](cb-findstring.md) or [**CB\_FINDSTRINGEXACT**](cb-findstringexact.md) message, an application can determine the position of a list item.</span></span> <span data-ttu-id="5bad6-207">**CB \_FINDSTRING** 會尋找其字串開頭為指定字串的專案。</span><span class="sxs-lookup"><span data-stu-id="5bad6-207">**CB\_FINDSTRING** finds an item whose string begins with the specified string.</span></span> <span data-ttu-id="5bad6-208">**CB \_FINDSTRINGEXACT** 會尋找其字串完全符合字串的專案。</span><span class="sxs-lookup"><span data-stu-id="5bad6-208">**CB\_FINDSTRINGEXACT** finds an item whose string matches the string exactly.</span></span> <span data-ttu-id="5bad6-209">這兩個訊息都不區分大小寫。</span><span class="sxs-lookup"><span data-stu-id="5bad6-209">Neither message is case sensitive.</span></span>

<span data-ttu-id="5bad6-210">應用程式可以使用 [**CB \_ DELETESTRING**](cb-deletestring.md) 訊息來移除清單專案。</span><span class="sxs-lookup"><span data-stu-id="5bad6-210">An application can remove a list item by using the [**CB\_DELETESTRING**](cb-deletestring.md) message.</span></span> <span data-ttu-id="5bad6-211">如果應用程式需要重新初始化下拉式方塊清單，則可以先使用 [**CB \_ RESETCONTENT**](cb-resetcontent.md) 訊息來清除其整個內容。</span><span class="sxs-lookup"><span data-stu-id="5bad6-211">If an application needs to reinitialize the combo box list, it can first clear its entire contents by using the [**CB\_RESETCONTENT**](cb-resetcontent.md) message.</span></span> <span data-ttu-id="5bad6-212">在下拉式方塊已經顯示之後，將多個專案加入清單中時，應用程式可以清除重繪旗標，以防止下拉式方塊在加入每個專案之後重新繪製。</span><span class="sxs-lookup"><span data-stu-id="5bad6-212">When adding multiple items to the list after a combo box has already been shown, an application can clear the redraw flag to prevent the combo box from being repainted after each item is added.</span></span> <span data-ttu-id="5bad6-213">如需重新繪製的詳細資訊，請參閱 [**WM \_ SETREDRAW**](/windows/desktop/gdi/wm-setredraw) 訊息的說明。</span><span class="sxs-lookup"><span data-stu-id="5bad6-213">For more information about redrawing, see the description of the [**WM\_SETREDRAW**](/windows/desktop/gdi/wm-setredraw) message.</span></span>

<span data-ttu-id="5bad6-214">若要取出與清單專案相關聯的字串，應用程式可以使用 [**CB \_ GETLBTEXT**](cb-getlbtext.md) 訊息。</span><span class="sxs-lookup"><span data-stu-id="5bad6-214">To retrieve the string associated with a list item, an application can use the [**CB\_GETLBTEXT**](cb-getlbtext.md) message.</span></span> <span data-ttu-id="5bad6-215">專案的字串會複製到應用程式所指定的緩衝區。</span><span class="sxs-lookup"><span data-stu-id="5bad6-215">The item's string is copied to the buffer specified by the application.</span></span> <span data-ttu-id="5bad6-216">為了確保緩衝區夠大而足以接收字串，應用程式可以先使用 [**CB \_ GETLBTEXTLEN**](cb-getlbtextlen.md) 訊息來判斷字串的長度。</span><span class="sxs-lookup"><span data-stu-id="5bad6-216">To ensure that the buffer is large enough to receive the string, the application can first use the [**CB\_GETLBTEXTLEN**](cb-getlbtextlen.md) message to determine the length of the string.</span></span> <span data-ttu-id="5bad6-217">若要取得下拉式方塊中的清單專案數，應用程式可以使用 [**CB \_ GETCOUNT**](cb-getcount.md) 訊息。</span><span class="sxs-lookup"><span data-stu-id="5bad6-217">To get the number of list items in a combo box, an application can use the [**CB\_GETCOUNT**](cb-getcount.md) message.</span></span>

## <a name="edit-control-selection-fields"></a><span data-ttu-id="5bad6-218">編輯控制項選取欄位</span><span class="sxs-lookup"><span data-stu-id="5bad6-218">Edit Control Selection Fields</span></span>

<span data-ttu-id="5bad6-219">應用程式可以取出或設定選取欄位的內容，也可以決定或設定編輯選取範圍。</span><span class="sxs-lookup"><span data-stu-id="5bad6-219">An application can retrieve or set the contents of the selection field and can determine or set the edit selection.</span></span> <span data-ttu-id="5bad6-220">應用程式也可以限制使用者可在 [選取範圍] 欄位中輸入的文字數量。</span><span class="sxs-lookup"><span data-stu-id="5bad6-220">The application can also limit the amount of text a user can type in the selection field.</span></span> <span data-ttu-id="5bad6-221">當選取專案欄位的內容變更時，系統會將通知訊息傳送至父視窗或對話方塊程式。</span><span class="sxs-lookup"><span data-stu-id="5bad6-221">When the contents of the selection field change, the system sends notification messages to the parent window or dialog box procedure.</span></span>

<span data-ttu-id="5bad6-222">若要抓取選取欄位的內容，應用程式可以將 [**WM \_ GETTEXT**](/windows/desktop/winmsg/wm-gettext) 訊息傳送至下拉式方塊。</span><span class="sxs-lookup"><span data-stu-id="5bad6-222">To retrieve the content of the selection field, an application can send the [**WM\_GETTEXT**](/windows/desktop/winmsg/wm-gettext) message to the combo box.</span></span> <span data-ttu-id="5bad6-223">若要設定簡單或下拉式下拉式方塊的選取範圍內容，應用程式可以將 [**WM \_ SETTEXT**](/windows/desktop/winmsg/wm-settext) 訊息傳送至下拉式方塊。</span><span class="sxs-lookup"><span data-stu-id="5bad6-223">To set the contents of the selection field of a simple or drop-down combo box, an application can send the [**WM\_SETTEXT**](/windows/desktop/winmsg/wm-settext) message to the combo box.</span></span>

<span data-ttu-id="5bad6-224">編輯選取範圍是在 [簡單] 或 [下拉式] 下拉式方塊的 [選取範圍] 欄位中所選取文字的範圍（如果有的話）。</span><span class="sxs-lookup"><span data-stu-id="5bad6-224">The edit selection is the range of selected text, if any, in the selection field of a simple or drop-down combo box.</span></span> <span data-ttu-id="5bad6-225">應用程式可以使用 [**CB \_ GETEDITSEL**](cb-geteditsel.md) 訊息來判斷目前選取範圍的開始和結束字元位置。</span><span class="sxs-lookup"><span data-stu-id="5bad6-225">An application can determine the starting and ending character positions of the current selection by using the [**CB\_GETEDITSEL**](cb-geteditsel.md) message.</span></span> <span data-ttu-id="5bad6-226">它也可以使用 [**CB \_ SETEDITSEL**](cb-seteditsel.md) 訊息選取編輯選取範圍中的字元。</span><span class="sxs-lookup"><span data-stu-id="5bad6-226">It can also select characters in the edit selection by using the [**CB\_SETEDITSEL**](cb-seteditsel.md) message.</span></span>

<span data-ttu-id="5bad6-227">一開始，使用者可以在選取欄位中輸入的文字數量受限於選取範圍欄位的大小。</span><span class="sxs-lookup"><span data-stu-id="5bad6-227">Initially, the amount of text that the user can type into the selection field is limited by the size of the selection field.</span></span> <span data-ttu-id="5bad6-228">但是，如果下拉式方塊具有 [**CBS \_ AUTOHSCROLL**](combo-box-styles.md) 樣式，則文字可以繼續超出選取範圍欄位的大小。</span><span class="sxs-lookup"><span data-stu-id="5bad6-228">However, if the combo box has the [**CBS\_AUTOHSCROLL**](combo-box-styles.md) style, the text can continue beyond the size of the selection field.</span></span> <span data-ttu-id="5bad6-229">無論控制項是否有 **CBS \_ AUTOHSCROLL** 樣式，應用程式都可以使用 [**CB \_ LIMITTEXT**](cb-limittext.md)訊息來限制使用者可在 [選取] 欄位中輸入的文字數量。</span><span class="sxs-lookup"><span data-stu-id="5bad6-229">An application can use the [**CB\_LIMITTEXT**](cb-limittext.md) message to limit the amount of text a user can type into the selection field, regardless of whether the control has the **CBS\_AUTOHSCROLL** style.</span></span>

<span data-ttu-id="5bad6-230">當使用者編輯選擇欄位的內容時，父視窗或對話方塊程式會收到通知訊息。</span><span class="sxs-lookup"><span data-stu-id="5bad6-230">When the user edits the content of the selection field, the parent window or dialog box procedure receives notification messages.</span></span> <span data-ttu-id="5bad6-231">[CBN \_ EDITUPDATE](cbn-editupdate.md)通知碼會先傳送，表示已編輯選取欄位中的文字。</span><span class="sxs-lookup"><span data-stu-id="5bad6-231">The [CBN\_EDITUPDATE](cbn-editupdate.md) notification code is sent first, indicating that the text in the selection field has been edited.</span></span> <span data-ttu-id="5bad6-232">在變更的文字顯示之後，系統會傳送 [CBN \_ EDITCHANGE](cbn-editchange.md)。</span><span class="sxs-lookup"><span data-stu-id="5bad6-232">After the altered text is displayed, the system sends [CBN\_EDITCHANGE](cbn-editchange.md).</span></span> <span data-ttu-id="5bad6-233">當選取欄位內容因為選取清單專案的結果而變更時，不會傳送這些訊息。</span><span class="sxs-lookup"><span data-stu-id="5bad6-233">When the selection field content changes as the result of a list item being selected, these messages are not sent.</span></span>

## <a name="owner-drawn-combo-boxes"></a><span data-ttu-id="5bad6-234">Owner-Drawn 下拉式方塊</span><span class="sxs-lookup"><span data-stu-id="5bad6-234">Owner-Drawn Combo Boxes</span></span>

<span data-ttu-id="5bad6-235">應用程式可以建立主控描繪的下拉式列示方塊，以負責繪製清單專案。</span><span class="sxs-lookup"><span data-stu-id="5bad6-235">An application can create an owner-drawn combo box to take responsibility for painting list items.</span></span> <span data-ttu-id="5bad6-236">主控描繪下拉式方塊的父視窗 (其擁有者) 需要繪製下拉式方塊的一部分時，才會收到 [**WM \_ DRAWITEM**](wm-drawitem.md) 訊息。</span><span class="sxs-lookup"><span data-stu-id="5bad6-236">The parent window of an owner-drawn combo box (its owner) receives [**WM\_DRAWITEM**](wm-drawitem.md) messages when a portion of the combo box needs to be painted.</span></span> <span data-ttu-id="5bad6-237">主控描繪的下拉式列示方塊可以列出除了文字字串以外的資訊。</span><span class="sxs-lookup"><span data-stu-id="5bad6-237">An owner-drawn combo box can list information other than, or in addition to, text strings.</span></span> <span data-ttu-id="5bad6-238">擁有者繪製的下拉式列示方塊可以是任何類型。</span><span class="sxs-lookup"><span data-stu-id="5bad6-238">Owner-drawn combo boxes can be of any type.</span></span> <span data-ttu-id="5bad6-239">不過，在 [簡單] 或 [下拉式] 下拉式方塊中的編輯控制項只能顯示文字，而擁有者會在下拉式清單方塊中繪製選取欄位。</span><span class="sxs-lookup"><span data-stu-id="5bad6-239">However, the edit control in a simple or drop-down combo box can only display text, while the owner paints the selection field in a drop-down list box.</span></span>

<span data-ttu-id="5bad6-240">主控描繪下拉式方塊的擁有者必須處理 [**WM \_ DRAWITEM**](wm-drawitem.md) 訊息。</span><span class="sxs-lookup"><span data-stu-id="5bad6-240">The owner of an owner-drawn combo box must process the [**WM\_DRAWITEM**](wm-drawitem.md) message.</span></span> <span data-ttu-id="5bad6-241">每當需要重新繪製下拉式方塊的一部分時，就會傳送此訊息。</span><span class="sxs-lookup"><span data-stu-id="5bad6-241">This message is sent whenever a portion of the combo box must be redrawn.</span></span> <span data-ttu-id="5bad6-242">擁有者可能需要根據為下拉式方塊指定的樣式來處理其他訊息。</span><span class="sxs-lookup"><span data-stu-id="5bad6-242">The owner may need to process other messages, depending on the styles specified for the combo box.</span></span>

<span data-ttu-id="5bad6-243">應用程式可以藉由指定 [**cbs \_ OWNERDRAWFIXED**](combo-box-styles.md) 或 [**cbs \_ OWNERDRAWVARIABLE**](combo-box-styles.md) 樣式來建立主控描繪的下拉式方塊。</span><span class="sxs-lookup"><span data-stu-id="5bad6-243">An application can create an owner-drawn combo box by specifying the [**CBS\_OWNERDRAWFIXED**](combo-box-styles.md) or [**CBS\_OWNERDRAWVARIABLE**](combo-box-styles.md) style.</span></span> <span data-ttu-id="5bad6-244">如果下拉式方塊中的所有清單專案都有相同的高度（例如字串或圖示），則應用程式可以使用 **CBS \_ OWNERDRAWFIXED** 樣式。</span><span class="sxs-lookup"><span data-stu-id="5bad6-244">If all list items in the combo box are the same height, such as strings or icons, an application can use the **CBS\_OWNERDRAWFIXED** style.</span></span> <span data-ttu-id="5bad6-245">如果清單專案具有不同的高度（例如不同大小的點陣圖），則應用程式可以使用 **CBS \_ OWNERDRAWVARIABLE** 樣式。</span><span class="sxs-lookup"><span data-stu-id="5bad6-245">If list items are of varying height, like bitmaps of different size, an application can use the **CBS\_OWNERDRAWVARIABLE** style.</span></span>

<span data-ttu-id="5bad6-246">主控描繪下拉式方塊的擁有者可以處理 [**WM \_ MEASUREITEM**](wm-measureitem.md) 訊息，以便在下拉式方塊中指定清單專案的維度。</span><span class="sxs-lookup"><span data-stu-id="5bad6-246">The owner of an owner-drawn combo box can process a [**WM\_MEASUREITEM**](wm-measureitem.md) message to specify the dimensions of list items in the combo box.</span></span> <span data-ttu-id="5bad6-247">如果應用程式使用 [**CBS \_ OWNERDRAWFIXED**](combo-box-styles.md) 樣式建立下拉式方塊，系統只會傳送一次 **WM \_ MEASUREITEM** 訊息。</span><span class="sxs-lookup"><span data-stu-id="5bad6-247">If the application creates the combo box by using the [**CBS\_OWNERDRAWFIXED**](combo-box-styles.md) style, the system sends the **WM\_MEASUREITEM** message only once.</span></span> <span data-ttu-id="5bad6-248">擁有者指定的維度會用於所有清單專案。</span><span class="sxs-lookup"><span data-stu-id="5bad6-248">The dimensions specified by the owner are used for all list items.</span></span> <span data-ttu-id="5bad6-249">如果使用 [**CBS \_ OWNERDRAWVARIABLE**](combo-box-styles.md) 樣式，系統就會針對新增至下拉式方塊的每個清單專案傳送 **WM \_ MEASUREITEM** 訊息。</span><span class="sxs-lookup"><span data-stu-id="5bad6-249">If the [**CBS\_OWNERDRAWVARIABLE**](combo-box-styles.md) style is used, the system sends a **WM\_MEASUREITEM** message for each list item added to the combo box.</span></span> <span data-ttu-id="5bad6-250">擁有者可以在任何時間使用 [**cb \_ GETITEMHEIGHT**](cb-getitemheight.md) 和 [**cb \_ SETITEMHEIGHT**](cb-setitemheight.md) 訊息，隨時決定或設定清單專案的高度。</span><span class="sxs-lookup"><span data-stu-id="5bad6-250">The owner can determine or set the height of a list item at any time by using the [**CB\_GETITEMHEIGHT**](cb-getitemheight.md) and [**CB\_SETITEMHEIGHT**](cb-setitemheight.md) messages, respectively.</span></span>

<span data-ttu-id="5bad6-251">如果顯示在主控描繪下拉式方塊中的資訊包含文字，應用程式可以藉由指定 [**CBS \_ HASSTRINGS**](combo-box-styles.md) 樣式來追蹤每個清單專案的文字。</span><span class="sxs-lookup"><span data-stu-id="5bad6-251">If the information displayed in an owner-drawn combo box includes text, an application can keep track of the text for each list item by specifying the [**CBS\_HASSTRINGS**](combo-box-styles.md) style.</span></span> <span data-ttu-id="5bad6-252">具有 [**CBS \_ 排序**](combo-box-styles.md) 樣式的下拉式方塊會根據此文字來排序。</span><span class="sxs-lookup"><span data-stu-id="5bad6-252">Combo boxes with the [**CBS\_SORT**](combo-box-styles.md) style are sorted based on this text.</span></span> <span data-ttu-id="5bad6-253">如果下拉式方塊已排序，而非 **CBS \_ HASSTRINGS** 樣式，則擁有者必須處理 [**WM \_ COMPAREITEM**](wm-compareitem.md) 訊息。</span><span class="sxs-lookup"><span data-stu-id="5bad6-253">If a combo box is sorted and not of the **CBS\_HASSTRINGS** style, the owner must process the [**WM\_COMPAREITEM**](wm-compareitem.md) message.</span></span>

<span data-ttu-id="5bad6-254">在主控描繪的下拉式方塊中，擁有者必須追蹤包含除了文字以外之資訊的清單專案。</span><span class="sxs-lookup"><span data-stu-id="5bad6-254">In an owner-drawn combo box, the owner must keep track of list items containing information other than or in addition to text.</span></span> <span data-ttu-id="5bad6-255">其中一個方便的方式是將資訊的控制碼儲存為專案資料。</span><span class="sxs-lookup"><span data-stu-id="5bad6-255">One convenient way to do this is to save the handle to the information as item data.</span></span> <span data-ttu-id="5bad6-256">若要釋放與下拉式方塊中專案相關聯的資料物件，擁有者可以處理 [**WM \_ DELETEITEM**](wm-deleteitem.md) 訊息。</span><span class="sxs-lookup"><span data-stu-id="5bad6-256">To free data objects associated with items in a combo box, the owner can process the [**WM\_DELETEITEM**](wm-deleteitem.md) message.</span></span>

## <a name="subclassed-combo-boxes"></a><span data-ttu-id="5bad6-257">子類別化下拉式方塊</span><span class="sxs-lookup"><span data-stu-id="5bad6-257">Subclassed Combo Boxes</span></span>

<span data-ttu-id="5bad6-258">子類別化是允許應用程式攔截和處理傳送或張貼至視窗之訊息的程式。</span><span class="sxs-lookup"><span data-stu-id="5bad6-258">Subclassing is a procedure that allows an application to intercept and process messages sent or posted to a window.</span></span> <span data-ttu-id="5bad6-259">藉由使用子類別化，應用程式可以替代特定訊息的處理，同時將大部分的訊息處理保留給類別定義的視窗程式。</span><span class="sxs-lookup"><span data-stu-id="5bad6-259">By using subclassing, an application can substitute its own processing for certain messages, while leaving most message processing to the class-defined window procedure.</span></span>

<span data-ttu-id="5bad6-260">當作業系統建立視窗時，會將它的相關資訊儲存在包含視窗程式指標的內部資料結構中。</span><span class="sxs-lookup"><span data-stu-id="5bad6-260">When the operating system creates a window, it saves information about it in an internal data structure that includes a pointer to the window procedure.</span></span> <span data-ttu-id="5bad6-261">若要子類別化視窗，應用程式會呼叫 [**SetClassLong**](/windows/desktop/api/winuser/nf-winuser-setclasslonga) 函式，將該程式的指標取代為應用程式定義之子類別程式的指標。</span><span class="sxs-lookup"><span data-stu-id="5bad6-261">To subclass a window, an application calls the [**SetClassLong**](/windows/desktop/api/winuser/nf-winuser-setclasslonga) function to replace the pointer to that procedure with a pointer to an application-defined subclass procedure.</span></span> <span data-ttu-id="5bad6-262">之後，視窗中的所有訊息都會傳送至子類別程式。</span><span class="sxs-lookup"><span data-stu-id="5bad6-262">Thereafter, all messages to the window are sent to the subclass procedure.</span></span> <span data-ttu-id="5bad6-263">此程式會接著使用 [**CallWindowProc**](/windows/desktop/api/winuser/nf-winuser-callwindowproca) 函式，將未處理的訊息傳遞給原始的視窗程式。</span><span class="sxs-lookup"><span data-stu-id="5bad6-263">This procedure then uses the [**CallWindowProc**](/windows/desktop/api/winuser/nf-winuser-callwindowproca) function to pass unprocessed messages to the original window procedure.</span></span> <span data-ttu-id="5bad6-264">如需 COMBOBOX 類別視窗程式所執行之訊息處理的描述，請參閱 [預設下拉式方塊行為](combo-box-features.md)。</span><span class="sxs-lookup"><span data-stu-id="5bad6-264">For a description of the message processing performed by the COMBOBOX class window procedure, see [Default Combo Box Behavior](combo-box-features.md).</span></span>

<span data-ttu-id="5bad6-265">當下拉式方塊位於對話方塊外部時，除非它使用子類別程式，否則應用程式無法處理 TAB 鍵、ENTER 鍵和 ESC 鍵。</span><span class="sxs-lookup"><span data-stu-id="5bad6-265">When the combo box is outside a dialog box, an application cannot process the TAB, ENTER, and ESC keys unless it uses a subclass procedure.</span></span> <span data-ttu-id="5bad6-266">當簡單或下拉下拉式方塊收到輸入焦點時，它會立即將焦點設定為其子編輯控制項。</span><span class="sxs-lookup"><span data-stu-id="5bad6-266">When a simple or drop-down combo box receives the input focus, it immediately sets the focus to its child edit control.</span></span> <span data-ttu-id="5bad6-267">因此，應用程式必須將編輯控制項子類別化，才能攔截簡單或下拉式方塊的鍵盤輸入。</span><span class="sxs-lookup"><span data-stu-id="5bad6-267">Therefore, an application must subclass the edit control to intercept keyboard input for a simple or drop-down combo box.</span></span> <span data-ttu-id="5bad6-268">如需這項工作的範例，請參閱子類別化 [下拉式](using-combo-boxes.md)方塊。</span><span class="sxs-lookup"><span data-stu-id="5bad6-268">For an example of this, see [Subclassing a Combo Box](using-combo-boxes.md).</span></span>

<span data-ttu-id="5bad6-269">如果子類別程式處理 [**WM \_ 油漆**](/windows/desktop/gdi/wm-paint) 訊息，則必須使用 [**BeginPaint**](/windows/desktop/api/winuser/nf-winuser-beginpaint) 函式來準備繪製。</span><span class="sxs-lookup"><span data-stu-id="5bad6-269">If a subclass procedure processes the [**WM\_PAINT**](/windows/desktop/gdi/wm-paint) message, it must use the [**BeginPaint**](/windows/desktop/api/winuser/nf-winuser-beginpaint) function to prepare for painting.</span></span> <span data-ttu-id="5bad6-270">在呼叫 [**EndPaint**](/windows/desktop/api/winuser/nf-winuser-endpaint) 函式之前，它會將裝置內容 (DC) 控制碼傳遞為視窗程式的 *wParam* 參數。</span><span class="sxs-lookup"><span data-stu-id="5bad6-270">Before calling the [**EndPaint**](/windows/desktop/api/winuser/nf-winuser-endpaint) function, it passes the device context (DC) handle as the *wParam* parameter for the window procedure.</span></span> <span data-ttu-id="5bad6-271">如果先呼叫 **EndPaint** ，則類別視窗程式不會進行繪製，因為 **EndPaint** 會驗證整個視窗。</span><span class="sxs-lookup"><span data-stu-id="5bad6-271">If **EndPaint** is called first, the class window procedure does no painting because **EndPaint** validates the entire window.</span></span>

<span data-ttu-id="5bad6-272">子類別化的相關技術 superclassing。</span><span class="sxs-lookup"><span data-stu-id="5bad6-272">A technique related to subclassing is superclassing.</span></span> <span data-ttu-id="5bad6-273">超類類似于任何其他類別，不同之處在于其視窗程式不會呼叫 [**DefWindowProc**](/windows/desktop/api/winuser/nf-winuser-defwindowproca) 來處理未處理的訊息。</span><span class="sxs-lookup"><span data-stu-id="5bad6-273">A superclass resembles any other class except that its window procedure does not call [**DefWindowProc**](/windows/desktop/api/winuser/nf-winuser-defwindowproca) to handle unprocessed messages.</span></span> <span data-ttu-id="5bad6-274">相反地，它會將未處理的訊息傳遞至父視窗類別的視窗程式。</span><span class="sxs-lookup"><span data-stu-id="5bad6-274">Instead, it passes unprocessed messages to the window procedure for the parent window class.</span></span> <span data-ttu-id="5bad6-275">遵循 [視窗程式](/windows/desktop/winmsg/window-procedures) 中的指導方針，以避免子類別化和 superclassing 可能發生的問題。</span><span class="sxs-lookup"><span data-stu-id="5bad6-275">Follow the guidelines in [Window Procedures](/windows/desktop/winmsg/window-procedures) to avoid problems that can occur with subclassing and superclassing.</span></span>

 

 