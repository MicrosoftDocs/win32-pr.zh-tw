---
title: 關於索引標籤控制項
description: 「索引標籤控制項」類似於筆記本裡的分隔頁或檔案櫃中的標籤。 藉由使用索引標籤控制項，應用程式可以定義視窗或對話方塊中同一個區域的多個頁面。
ms.assetid: 55ed2863-7f8d-43ce-a0f9-6f6d41e3f947
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 0c45ac7caa05c73e1dcf22a8e6f0eb4d031ca079
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/21/2020
ms.locfileid: "104093380"
---
# <a name="about-tab-controls"></a><span data-ttu-id="3aec6-104">關於索引標籤控制項</span><span class="sxs-lookup"><span data-stu-id="3aec6-104">About Tab Controls</span></span>

<span data-ttu-id="3aec6-105">「索引標籤控制項」類似於筆記本裡的分隔頁或檔案櫃中的標籤。</span><span class="sxs-lookup"><span data-stu-id="3aec6-105">A tab control is analogous to the dividers in a notebook or the labels in a file cabinet.</span></span> <span data-ttu-id="3aec6-106">藉由使用索引標籤控制項，應用程式可以定義視窗或對話方塊中同一個區域的多個頁面。</span><span class="sxs-lookup"><span data-stu-id="3aec6-106">By using a tab control, an application can define multiple pages for the same area of a window or dialog box.</span></span> <span data-ttu-id="3aec6-107">每個頁面都包含特定類型的資訊或應用程式在使用者選取對應的索引標籤時所顯示的一組控制項。</span><span class="sxs-lookup"><span data-stu-id="3aec6-107">Each page consists of a certain type of information or a group of controls that the application displays when the user selects the corresponding tab.</span></span>

<span data-ttu-id="3aec6-108">下列螢幕擷取畫面顯示簡單的索引標籤控制項，其中包含一周中各天的索引標籤。</span><span class="sxs-lookup"><span data-stu-id="3aec6-108">The following screen shot shows a simple tab control that contains tabs for days of the week.</span></span> <span data-ttu-id="3aec6-109">已選取 [星期二] 索引標籤。</span><span class="sxs-lookup"><span data-stu-id="3aec6-109">The Tuesday tab has been selected.</span></span>

![包含五個索引標籤的屬性工作表螢幕擷取畫面，每週的每一天一次](images/tab-simple.png)

<span data-ttu-id="3aec6-111">本主題包含下列各節。</span><span class="sxs-lookup"><span data-stu-id="3aec6-111">This topic includes the following sections.</span></span>

-   [<span data-ttu-id="3aec6-112">建立索引標籤控制項</span><span class="sxs-lookup"><span data-stu-id="3aec6-112">Creating Tab Controls</span></span>](#creating-tab-controls)
-   [<span data-ttu-id="3aec6-113">索引標籤控制項樣式</span><span class="sxs-lookup"><span data-stu-id="3aec6-113">Tab Control Styles</span></span>](#tab-control-styles)
-   [<span data-ttu-id="3aec6-114">Tab 和 Tab 屬性</span><span class="sxs-lookup"><span data-stu-id="3aec6-114">Tabs and Tab Attributes</span></span>](#tabs-and-tab-attributes)
-   [<span data-ttu-id="3aec6-115">顯示區域</span><span class="sxs-lookup"><span data-stu-id="3aec6-115">Display Area</span></span>](#display-area)
-   [<span data-ttu-id="3aec6-116">索引標籤選項</span><span class="sxs-lookup"><span data-stu-id="3aec6-116">Tab Selection</span></span>](#tab-selection)
-   [<span data-ttu-id="3aec6-117">索引標籤控制項影像清單</span><span class="sxs-lookup"><span data-stu-id="3aec6-117">Tab Control Image Lists</span></span>](#tab-control-image-lists)
-   [<span data-ttu-id="3aec6-118">定位鍵大小和位置</span><span class="sxs-lookup"><span data-stu-id="3aec6-118">Tab Size and Position</span></span>](#tab-size-and-position)
-   [<span data-ttu-id="3aec6-119">主控描繪索引標籤</span><span class="sxs-lookup"><span data-stu-id="3aec6-119">Owner-Drawn Tabs</span></span>](#owner-drawn-tabs)
-   [<span data-ttu-id="3aec6-120">索引標籤控制項工具提示</span><span class="sxs-lookup"><span data-stu-id="3aec6-120">Tab Control Tooltips</span></span>](#tab-control-tooltips)
-   [<span data-ttu-id="3aec6-121">預設選項卡控制訊息處理</span><span class="sxs-lookup"><span data-stu-id="3aec6-121">Default Tab Control Message Processing</span></span>](#default-tab-control-message-processing)

## <a name="creating-tab-controls"></a><span data-ttu-id="3aec6-122">建立索引標籤控制項</span><span class="sxs-lookup"><span data-stu-id="3aec6-122">Creating Tab Controls</span></span>

<span data-ttu-id="3aec6-123">您可以藉由呼叫 [**CreateWindowEx**](/windows/desktop/api/winuser/nf-winuser-createwindowexa) 函式來建立索引標籤控制項，並指定 [**WC \_ TABCONTROL**](common-control-window-classes.md) 視窗類別。</span><span class="sxs-lookup"><span data-stu-id="3aec6-123">You can create a tab control by calling the [**CreateWindowEx**](/windows/desktop/api/winuser/nf-winuser-createwindowexa) function, specifying the [**WC\_TABCONTROL**](common-control-window-classes.md) window class.</span></span> <span data-ttu-id="3aec6-124">載入通用控制項 DLL 時，會註冊此視窗類別。</span><span class="sxs-lookup"><span data-stu-id="3aec6-124">This window class is registered when the common controls DLL is loaded.</span></span> <span data-ttu-id="3aec6-125">若要確定已載入 DLL，請使用 [**InitCommonControlsEx**](/windows/desktop/api/Commctrl/nf-commctrl-initcommoncontrolsex) 函數。</span><span class="sxs-lookup"><span data-stu-id="3aec6-125">To ensure that the DLL is loaded, use the [**InitCommonControlsEx**](/windows/desktop/api/Commctrl/nf-commctrl-initcommoncontrolsex) function.</span></span>

<span data-ttu-id="3aec6-126">在 Microsoft Visual Studio 中，您可以使用 [工具箱] 來建立索引標籤控制項。</span><span class="sxs-lookup"><span data-stu-id="3aec6-126">In Microsoft Visual Studio, you can create a tab control by using the Toolbox.</span></span>

<span data-ttu-id="3aec6-127">您會將訊息傳送至索引標籤控制項以加入索引標籤，否則會影響控制項的外觀和行為。</span><span class="sxs-lookup"><span data-stu-id="3aec6-127">You send messages to a tab control to add tabs and otherwise affect the control's appearance and behavior.</span></span> <span data-ttu-id="3aec6-128">每個訊息都有您可以使用的對應宏，而不是明確地傳送訊息。</span><span class="sxs-lookup"><span data-stu-id="3aec6-128">Each message has a corresponding macro that you can use instead of sending the message explicitly.</span></span> <span data-ttu-id="3aec6-129">您無法停用 [選項卡] 控制項中的個別索引標籤。</span><span class="sxs-lookup"><span data-stu-id="3aec6-129">You cannot disable an individual tab in a tab control.</span></span> <span data-ttu-id="3aec6-130">不過，您可以停用對應的頁面，以停用屬性工作表中的索引標籤控制項。</span><span class="sxs-lookup"><span data-stu-id="3aec6-130">However, you can disable a tab control in a property sheet by disabling the corresponding page.</span></span>

## <a name="tab-control-styles"></a><span data-ttu-id="3aec6-131">索引標籤控制項樣式</span><span class="sxs-lookup"><span data-stu-id="3aec6-131">Tab Control Styles</span></span>

<span data-ttu-id="3aec6-132">您可以在建立控制項時指定索引標籤控制項樣式，將某些特性套用至索引標籤控制項。</span><span class="sxs-lookup"><span data-stu-id="3aec6-132">You can apply certain characteristics to tab controls by specifying tab control styles when the control is created.</span></span> <span data-ttu-id="3aec6-133">例如，您可以在索引標籤控制項中指定索引標籤的對齊方式和一般外觀。</span><span class="sxs-lookup"><span data-stu-id="3aec6-133">For example, you can specify the alignment and general appearance of the tabs in a tab control.</span></span>

<span data-ttu-id="3aec6-134">您可以藉由指定 [ [**TCS] \_ 按鈕**](tab-control-styles.md) 樣式，讓索引標籤看起來像按鈕。</span><span class="sxs-lookup"><span data-stu-id="3aec6-134">You can cause the tabs to look like buttons by specifying the [**TCS\_BUTTONS**](tab-control-styles.md) style.</span></span> <span data-ttu-id="3aec6-135">這種索引標籤控制項中的索引標籤應該提供與按鈕控制項相同的功能;也就是說，按一下索引標籤應該執行命令，而不是顯示頁面。</span><span class="sxs-lookup"><span data-stu-id="3aec6-135">Tabs in this type of tab control should serve the same function as button controls; that is, clicking a tab should carry out a command instead of displaying a page.</span></span> <span data-ttu-id="3aec6-136">因為 [按鈕] 索引標籤控制項中的顯示區域通常不會使用，所以不會在其周圍繪製框線。</span><span class="sxs-lookup"><span data-stu-id="3aec6-136">Because the display area in a button tab control is typically not used, no border is drawn around it.</span></span>

<span data-ttu-id="3aec6-137">您可以指定 [**TCS \_ FOCUSONBUTTONDOWN**](tab-control-styles.md) 樣式，讓索引標籤在按一下時接收輸入焦點。</span><span class="sxs-lookup"><span data-stu-id="3aec6-137">You can cause a tab to receive the input focus when clicked by specifying the [**TCS\_FOCUSONBUTTONDOWN**](tab-control-styles.md) style.</span></span> <span data-ttu-id="3aec6-138">此樣式通常僅適用于 [**TCS \_ 按鈕**](tab-control-styles.md) 樣式。</span><span class="sxs-lookup"><span data-stu-id="3aec6-138">This style is typically used only with the [**TCS\_BUTTONS**](tab-control-styles.md) style.</span></span> <span data-ttu-id="3aec6-139">您可以使用 [**TCS \_ FOCUSNEVER**](tab-control-styles.md) 樣式，指定索引標籤不會在按一下時收到輸入焦點。</span><span class="sxs-lookup"><span data-stu-id="3aec6-139">You can specify that a tab does not receive input focus when clicked by using the [**TCS\_FOCUSNEVER**](tab-control-styles.md) style.</span></span>

<span data-ttu-id="3aec6-140">依預設，索引標籤控制項只會顯示一列索引標籤。</span><span class="sxs-lookup"><span data-stu-id="3aec6-140">By default, a tab control displays only one row of tabs.</span></span> <span data-ttu-id="3aec6-141">如果未顯示所有索引標籤，則索引標籤控制項會顯示上下按鈕控制項，讓使用者可以將其他索引標籤移到視野中。</span><span class="sxs-lookup"><span data-stu-id="3aec6-141">If not all tabs can be shown at once, the tab control displays an up-down control so that the user can scroll additional tabs into view.</span></span> <span data-ttu-id="3aec6-142">如果有必要，您可以藉由指定 [**TCS \_ 多行**](tab-control-styles.md) 樣式，讓索引標籤控制項顯示多個資料列的索引標籤。</span><span class="sxs-lookup"><span data-stu-id="3aec6-142">You can cause a tab control to display multiple rows of tabs, if necessary, by specifying the [**TCS\_MULTILINE**](tab-control-styles.md) style.</span></span> <span data-ttu-id="3aec6-143">使用此樣式，可以一次顯示所有索引標籤。</span><span class="sxs-lookup"><span data-stu-id="3aec6-143">With this style, all tabs can be displayed at once.</span></span> <span data-ttu-id="3aec6-144">除非您指定 [**TCS \_ RIGHTJUSTIFY**](tab-control-styles.md) 樣式，否則索引標籤會在每個資料列中保持靠左對齊。</span><span class="sxs-lookup"><span data-stu-id="3aec6-144">The tabs are left-aligned within each row unless you specify the [**TCS\_RIGHTJUSTIFY**](tab-control-styles.md) style.</span></span> <span data-ttu-id="3aec6-145">在此情況下，每個索引標籤的寬度都會增加，讓索引標籤的每個資料列都填滿整個索引標籤控制項的寬度。</span><span class="sxs-lookup"><span data-stu-id="3aec6-145">In this case, the width of each tab is increased so that each row of tabs fills the entire width of the tab control.</span></span>

<span data-ttu-id="3aec6-146">索引標籤控制項會自動調整每個索引標籤的大小，以符合其圖示（如果有的話）及其標籤。</span><span class="sxs-lookup"><span data-stu-id="3aec6-146">A tab control automatically sizes each tab to fit its icon, if any, and its label.</span></span> <span data-ttu-id="3aec6-147">若要提供相同寬度的所有索引標籤，您可以指定 [**TCS \_ FIXEDWIDTH**](tab-control-styles.md) 樣式。</span><span class="sxs-lookup"><span data-stu-id="3aec6-147">To give all tabs the same width, you can specify the [**TCS\_FIXEDWIDTH**](tab-control-styles.md) style.</span></span> <span data-ttu-id="3aec6-148">控制項會調整所有索引標籤的大小以符合最寬的標籤，或您可以使用 [**TCM \_ SETITEMSIZE**](tcm-setitemsize.md) 訊息來指派特定的寬度和高度。</span><span class="sxs-lookup"><span data-stu-id="3aec6-148">The control sizes all the tabs to fit the widest label, or you can assign a specific width and height by using the [**TCM\_SETITEMSIZE**](tcm-setitemsize.md) message.</span></span> <span data-ttu-id="3aec6-149">在每個索引標籤中，控制項會將圖示和標籤放在標籤的左邊。</span><span class="sxs-lookup"><span data-stu-id="3aec6-149">Within each tab, the control centers the icon and label, placing the icon to the left of the label.</span></span> <span data-ttu-id="3aec6-150">您可以藉由指定 [**TCS \_ FORCEICONLEFT**](tab-control-styles.md) 樣式來強制左側的圖示，讓標籤保持在最中央。</span><span class="sxs-lookup"><span data-stu-id="3aec6-150">You can force the icon to the left, leaving the label centered, by specifying the [**TCS\_FORCEICONLEFT**](tab-control-styles.md) style.</span></span> <span data-ttu-id="3aec6-151">您可以使用 [**TCS \_ FORCELABELLEFT**](tab-control-styles.md) 樣式，將圖示和標籤靠左對齊。</span><span class="sxs-lookup"><span data-stu-id="3aec6-151">You can left-align both the icon and label by using the [**TCS\_FORCELABELLEFT**](tab-control-styles.md) style.</span></span> <span data-ttu-id="3aec6-152">您無法將 **TCS \_ FIXEDWIDTH** 樣式與 [**TCS \_ RIGHTJUSTIFY**](tab-control-styles.md) 樣式搭配使用。</span><span class="sxs-lookup"><span data-stu-id="3aec6-152">You cannot use the **TCS\_FIXEDWIDTH** style with the [**TCS\_RIGHTJUSTIFY**](tab-control-styles.md) style.</span></span>

<span data-ttu-id="3aec6-153">您可以使用 [**TCS \_ OWNERDRAWFIXED**](tab-control-styles.md) 樣式，指定父視窗繪製控制項中的索引標籤。</span><span class="sxs-lookup"><span data-stu-id="3aec6-153">You can specify that the parent window draws the tabs in the control by using the [**TCS\_OWNERDRAWFIXED**](tab-control-styles.md) style.</span></span> <span data-ttu-id="3aec6-154">如需詳細資訊，請參閱 [擁有者繪製](#owner-drawn-tabs)索引標籤。</span><span class="sxs-lookup"><span data-stu-id="3aec6-154">For more information, see [Owner-Drawn Tabs](#owner-drawn-tabs).</span></span>

<span data-ttu-id="3aec6-155">您可以使用 [**TCS \_ 工具提示**](tab-control-styles.md) 樣式，指定索引標籤控制項將建立工具提示控制項。</span><span class="sxs-lookup"><span data-stu-id="3aec6-155">You can specify that a tab control will create a tooltip control by using the [**TCS\_TOOLTIPS**](tab-control-styles.md) style.</span></span> <span data-ttu-id="3aec6-156">如需有關這個的詳細資訊，請參閱 [選項提示控制項](#tab-control-tooltips)。</span><span class="sxs-lookup"><span data-stu-id="3aec6-156">For more information about this, see [Tab Control Tooltips](#tab-control-tooltips).</span></span>

## <a name="tabs-and-tab-attributes"></a><span data-ttu-id="3aec6-157">Tab 和 Tab 屬性</span><span class="sxs-lookup"><span data-stu-id="3aec6-157">Tabs and Tab Attributes</span></span>

<span data-ttu-id="3aec6-158">索引標籤控制項中的每個索引標籤都包含一個圖示、一個標籤和一個應用程式定義的資料。</span><span class="sxs-lookup"><span data-stu-id="3aec6-158">Each tab in a tab control consists of an icon, a label, and application-defined data.</span></span> <span data-ttu-id="3aec6-159">這項資訊是由 [**TCITEM**](/windows/win32/api/commctrl/ns-commctrl-tcitema) 結構所指定。</span><span class="sxs-lookup"><span data-stu-id="3aec6-159">This information is specified by a [**TCITEM**](/windows/win32/api/commctrl/ns-commctrl-tcitema) structure.</span></span> <span data-ttu-id="3aec6-160">您可以將索引標籤加入至索引標籤控制項、取出索引標籤數目、抓取和設定索引標籤的內容，以及刪除索引標籤。</span><span class="sxs-lookup"><span data-stu-id="3aec6-160">You can add tabs to a tab control, retrieve the number of tabs, retrieve and set the contents of a tab, and delete tabs.</span></span> <span data-ttu-id="3aec6-161">索引標籤是由其以零為基底的索引加以識別。</span><span class="sxs-lookup"><span data-stu-id="3aec6-161">Tabs are identified by their zero-based index.</span></span>

<span data-ttu-id="3aec6-162">若要將索引標籤加入至索引標籤控制項，請使用 [**TCM \_ INSERTITEM**](tcm-insertitem.md) 訊息，並指定專案的位置和 [**TCITEM**](/windows/win32/api/commctrl/ns-commctrl-tcitema) 結構的位址。</span><span class="sxs-lookup"><span data-stu-id="3aec6-162">To add tabs to a tab control, use the [**TCM\_INSERTITEM**](tcm-insertitem.md) message, specifying the position of the item and the address of a [**TCITEM**](/windows/win32/api/commctrl/ns-commctrl-tcitema) structure.</span></span> <span data-ttu-id="3aec6-163">您可以使用 [**tcm \_ GETITEM**](tcm-getitem.md) 和 [**tcm \_ SETITEM**](tcm-setitem.md) 訊息來取得和設定現有索引標籤的內容。</span><span class="sxs-lookup"><span data-stu-id="3aec6-163">You can retrieve and set the contents of an existing tab by using the [**TCM\_GETITEM**](tcm-getitem.md) and [**TCM\_SETITEM**](tcm-setitem.md) messages.</span></span> <span data-ttu-id="3aec6-164">針對每個索引標籤，您可以指定圖示、標籤或兩者。</span><span class="sxs-lookup"><span data-stu-id="3aec6-164">For each tab, you can specify an icon, a label, or both.</span></span> <span data-ttu-id="3aec6-165">您也可以指定要與索引標籤建立關聯的應用程式定義資料。</span><span class="sxs-lookup"><span data-stu-id="3aec6-165">You can also specify application-defined data to associate with the tab.</span></span>

<span data-ttu-id="3aec6-166">您可以使用 tcm [**\_ GETITEMCOUNT**](tcm-getitemcount.md) 訊息來取出目前的索引標籤數目、使用 [**tcm \_ DELETEITEM**](tcm-deleteitem.md) 訊息刪除索引標籤，以及使用 [**tcm \_ DELETEALLITEMS**](tcm-deleteallitems.md) 訊息刪除索引標籤控制項中的所有索引標籤。</span><span class="sxs-lookup"><span data-stu-id="3aec6-166">You can retrieve the current number of tabs by using the [**TCM\_GETITEMCOUNT**](tcm-getitemcount.md) message, delete a tab by using the [**TCM\_DELETEITEM**](tcm-deleteitem.md) message, and delete all tabs in a tab control by using the [**TCM\_DELETEALLITEMS**](tcm-deleteallitems.md) message.</span></span>

<span data-ttu-id="3aec6-167">您可以將應用程式定義資料與每一個索引標籤建立關聯。例如，您可以使用對應的索引標籤來儲存每個頁面的相關資訊。根據預設，索引標籤控制項會針對應用程式定義的資料，每個索引標籤配置四個額外的位元組。</span><span class="sxs-lookup"><span data-stu-id="3aec6-167">You can associate application-defined data with each tab. For example, you might save information about each page with its corresponding tab. By default, a tab control allocates four extra bytes per tab for application-defined data.</span></span> <span data-ttu-id="3aec6-168">您可以使用 [**TCM \_ SETITEMEXTRA**](tcm-setitemextra.md) 訊息來變更每個索引標籤的額外位元組數目。</span><span class="sxs-lookup"><span data-stu-id="3aec6-168">You can change the number of extra bytes per tab by using the [**TCM\_SETITEMEXTRA**](tcm-setitemextra.md) message.</span></span> <span data-ttu-id="3aec6-169">只有當選項卡控制項為空白時，才能使用此訊息。</span><span class="sxs-lookup"><span data-stu-id="3aec6-169">You can only use this message when the tab control is empty.</span></span>

<span data-ttu-id="3aec6-170">應用程式定義的資料是由 [**TCITEM**](/windows/win32/api/commctrl/ns-commctrl-tcitema)結構的 **lParam** 成員所指定。</span><span class="sxs-lookup"><span data-stu-id="3aec6-170">The application-defined data is specified by the **lParam** member of the [**TCITEM**](/windows/win32/api/commctrl/ns-commctrl-tcitema) structure.</span></span> <span data-ttu-id="3aec6-171">如果您使用超過4個位元組的應用程式定義資料，您需要定義自己的結構，並使用它來取代 **TCITEM**。</span><span class="sxs-lookup"><span data-stu-id="3aec6-171">If you use more than 4 bytes of application-defined data, you need to define your own structure and use it instead of **TCITEM**.</span></span> <span data-ttu-id="3aec6-172">您可以使用 [**TCM \_ GETITEM**](tcm-getitem.md) 和 [**tcm \_ SETITEM**](tcm-setitem.md) 訊息，以抓取和設定索引標籤的其他相關資訊，來取得和設定應用程式定義的資料。</span><span class="sxs-lookup"><span data-stu-id="3aec6-172">You can retrieve and set application-defined data the same way you retrieve and set other information about a tab—by using the [**TCM\_GETITEM**](tcm-getitem.md) and [**TCM\_SETITEM**](tcm-setitem.md) messages.</span></span>

<span data-ttu-id="3aec6-173">您結構的第一個成員必須是 [**TCITEMHEADER**](/windows/win32/api/commctrl/ns-commctrl-tcitemheadera) 結構，而其餘成員必須指定應用程式定義的資料。</span><span class="sxs-lookup"><span data-stu-id="3aec6-173">The first member of your structure must be a [**TCITEMHEADER**](/windows/win32/api/commctrl/ns-commctrl-tcitemheadera) structure, and the remaining members must specify application-defined data.</span></span> <span data-ttu-id="3aec6-174">**TCITEMHEADER** 與 [**TCITEM**](/windows/win32/api/commctrl/ns-commctrl-tcitema)相同，不同之處在于它沒有 **lParam** 成員。</span><span class="sxs-lookup"><span data-stu-id="3aec6-174">**TCITEMHEADER** is identical to [**TCITEM**](/windows/win32/api/commctrl/ns-commctrl-tcitema), except it does not have the **lParam** member.</span></span> <span data-ttu-id="3aec6-175">您的結構大小與 **TCITEMHEADER** 大小之間的差異應等於每個索引標籤的額外位元組數目。</span><span class="sxs-lookup"><span data-stu-id="3aec6-175">The difference between the size of your structure and the size of **TCITEMHEADER** should equal the number of extra bytes per tab.</span></span>

## <a name="display-area"></a><span data-ttu-id="3aec6-176">顯示區域</span><span class="sxs-lookup"><span data-stu-id="3aec6-176">Display Area</span></span>

<span data-ttu-id="3aec6-177">索引標籤控制項的顯示區域是應用程式顯示目前頁面的區域。</span><span class="sxs-lookup"><span data-stu-id="3aec6-177">The display area of a tab control is the area in which an application displays the current page.</span></span> <span data-ttu-id="3aec6-178">一般而言，應用程式會建立一個子視窗或對話方塊，設定視窗大小和位置以符合顯示區域。</span><span class="sxs-lookup"><span data-stu-id="3aec6-178">Typically, an application creates a child window or dialog box, setting the window size and position to fit the display area.</span></span> <span data-ttu-id="3aec6-179">針對索引標籤控制項的視窗矩形，您可以使用 [**TCM \_ ADJUSTRECT**](tcm-adjustrect.md) 訊息來計算顯示區域的周框。</span><span class="sxs-lookup"><span data-stu-id="3aec6-179">Given the window rectangle for a tab control, you can calculate the bounding rectangle of the display area by using the [**TCM\_ADJUSTRECT**](tcm-adjustrect.md) message.</span></span>

<span data-ttu-id="3aec6-180">有時顯示區域必須是特定大小，例如，非模式子對話方塊的大小。</span><span class="sxs-lookup"><span data-stu-id="3aec6-180">Sometimes the display area must be a particular size—for example, the size of a modeless child dialog box.</span></span> <span data-ttu-id="3aec6-181">若為顯示區域指定周框，您可以使用 [**TCM \_ ADJUSTRECT**](tcm-adjustrect.md) 來計算索引標籤控制項的對應視窗矩形。</span><span class="sxs-lookup"><span data-stu-id="3aec6-181">Given the bounding rectangle for the display area, you can use [**TCM\_ADJUSTRECT**](tcm-adjustrect.md) to calculate the corresponding window rectangle for the tab control.</span></span>

## <a name="tab-selection"></a><span data-ttu-id="3aec6-182">索引標籤選項</span><span class="sxs-lookup"><span data-stu-id="3aec6-182">Tab Selection</span></span>

<span data-ttu-id="3aec6-183">當使用者選取索引標籤時，索引標籤控制項會以 [**WM \_ 通知**](wm-notify.md) 訊息的形式傳送其父視窗通知碼。</span><span class="sxs-lookup"><span data-stu-id="3aec6-183">When the user selects a tab, a tab control sends its parent window notification codes in the form of [**WM\_NOTIFY**](wm-notify.md) messages.</span></span> <span data-ttu-id="3aec6-184">[TCN \_ SELCHANGING](tcn-selchanging.md)通知碼會在選取範圍變更前傳送，而[TCN \_ SELCHANGE](tcn-selchange.md)通知碼會在選取範圍變更之後傳送。</span><span class="sxs-lookup"><span data-stu-id="3aec6-184">The [TCN\_SELCHANGING](tcn-selchanging.md) notification code is sent before the selection changes, and the [TCN\_SELCHANGE](tcn-selchange.md) notification code is sent after the selection changes.</span></span>

<span data-ttu-id="3aec6-185">您可以處理 [TCN \_ SELCHANGING](tcn-selchanging.md) 來儲存傳出頁面的狀態。</span><span class="sxs-lookup"><span data-stu-id="3aec6-185">You can process [TCN\_SELCHANGING](tcn-selchanging.md) to save the state of the outgoing page.</span></span> <span data-ttu-id="3aec6-186">您可以傳回 **TRUE** 以防止選取範圍變更。</span><span class="sxs-lookup"><span data-stu-id="3aec6-186">You can return **TRUE** to prevent the selection from changing.</span></span> <span data-ttu-id="3aec6-187">例如，您可能不想要切換離開控制項有無效設定的子對話方塊。</span><span class="sxs-lookup"><span data-stu-id="3aec6-187">For example, you might not want to switch away from a child dialog box in which a control has an invalid setting.</span></span>

<span data-ttu-id="3aec6-188">您必須處理 [TCN \_ SELCHANGE](tcn-selchange.md) ，才能在顯示區域中顯示傳入的頁面。</span><span class="sxs-lookup"><span data-stu-id="3aec6-188">You must process [TCN\_SELCHANGE](tcn-selchange.md) to display the incoming page in the display area.</span></span> <span data-ttu-id="3aec6-189">這可能只需要變更子視窗中所顯示的資訊。</span><span class="sxs-lookup"><span data-stu-id="3aec6-189">This might simply entail changing the information displayed in a child window.</span></span> <span data-ttu-id="3aec6-190">更常發生的是，每個頁面都包含一個子視窗或一個對話方塊。</span><span class="sxs-lookup"><span data-stu-id="3aec6-190">More often, each page consists of a child window or dialog box.</span></span> <span data-ttu-id="3aec6-191">在此情況下，應用程式可能會藉由終結或隱藏外寄子視窗或對話方塊，以及建立或顯示內送的子視窗或對話方塊，來處理此通知。</span><span class="sxs-lookup"><span data-stu-id="3aec6-191">In this case, an application might process this notification by destroying or hiding the outgoing child window or dialog box and by creating or showing the incoming child window or dialog box.</span></span>

<span data-ttu-id="3aec6-192">您可以使用 [**tcm \_ GETCURSEL**](tcm-getcursel.md) 和 [**tcm \_ SETCURSEL**](tcm-setcursel.md) 訊息來取得和設定目前的選取範圍。</span><span class="sxs-lookup"><span data-stu-id="3aec6-192">You can retrieve and set the current selection by using the [**TCM\_GETCURSEL**](tcm-getcursel.md) and [**TCM\_SETCURSEL**](tcm-setcursel.md) messages.</span></span>

## <a name="tab-control-image-lists"></a><span data-ttu-id="3aec6-193">索引標籤控制項影像清單</span><span class="sxs-lookup"><span data-stu-id="3aec6-193">Tab Control Image Lists</span></span>

<span data-ttu-id="3aec6-194">每個索引標籤都可以有相關聯的圖示，此圖示是由索引標籤控制項影像清單中的索引所指定。</span><span class="sxs-lookup"><span data-stu-id="3aec6-194">Each tab can have an icon associated with it, which is specified by an index in the image list for the tab control.</span></span> <span data-ttu-id="3aec6-195">建立索引標籤控制項時，它沒有相關聯的影像清單。</span><span class="sxs-lookup"><span data-stu-id="3aec6-195">When a tab control is created, it has no image list associated with it.</span></span> <span data-ttu-id="3aec6-196">應用程式可以使用 [**ImageList \_ create**](/windows/desktop/api/Commctrl/nf-commctrl-imagelist_create) 函式來建立影像清單，然後使用 [**TCM \_ SETIMAGELIST**](tcm-setimagelist.md) 訊息將它指派給索引標籤控制項。</span><span class="sxs-lookup"><span data-stu-id="3aec6-196">An application can create an image list by using the [**ImageList\_Create**](/windows/desktop/api/Commctrl/nf-commctrl-imagelist_create) function and then assign it to a tab control by using the [**TCM\_SETIMAGELIST**](tcm-setimagelist.md) message.</span></span>

<span data-ttu-id="3aec6-197">您可以將影像加入至索引標籤控制項的影像清單，就像您對任何其他影像清單一樣。</span><span class="sxs-lookup"><span data-stu-id="3aec6-197">You can add images to a tab control's image list just as you would to any other image list.</span></span> <span data-ttu-id="3aec6-198">不過，應用程式應該使用 [**TCM \_ REMOVEIMAGE**](tcm-removeimage.md) 訊息來移除影像，而不是使用 [**ImageList \_ remove**](/windows/desktop/api/Commctrl/nf-commctrl-imagelist_remove) 函數。</span><span class="sxs-lookup"><span data-stu-id="3aec6-198">However, an application should remove images by using the [**TCM\_REMOVEIMAGE**](tcm-removeimage.md) message instead of the [**ImageList\_Remove**](/windows/desktop/api/Commctrl/nf-commctrl-imagelist_remove) function.</span></span> <span data-ttu-id="3aec6-199">此訊息可確保每個索引標籤都會與之前的映射保持相關聯。</span><span class="sxs-lookup"><span data-stu-id="3aec6-199">This message ensures that each tab remains associated with the same image as before.</span></span>

<span data-ttu-id="3aec6-200">終結的索引標籤控制項不會摧毀與其相關聯的影像清單。</span><span class="sxs-lookup"><span data-stu-id="3aec6-200">Destroying a tab control does not destroy an image list that is associated with it.</span></span> <span data-ttu-id="3aec6-201">您必須分開終結影像清單。</span><span class="sxs-lookup"><span data-stu-id="3aec6-201">You must destroy the image list separately.</span></span> <span data-ttu-id="3aec6-202">如果您想要將相同的影像清單指派給多個索引標籤控制項，這會很有用。</span><span class="sxs-lookup"><span data-stu-id="3aec6-202">This is useful if you want to assign the same image list to multiple tab controls.</span></span>

<span data-ttu-id="3aec6-203">若要取得目前與索引標籤控制項相關聯之影像清單的控制碼，您可以使用 [**TCM \_ GETIMAGELIST**](tcm-getimagelist.md) 訊息。</span><span class="sxs-lookup"><span data-stu-id="3aec6-203">To retrieve the handle to the image list currently associated with a tab control, you can use the [**TCM\_GETIMAGELIST**](tcm-getimagelist.md) message.</span></span>

## <a name="tab-size-and-position"></a><span data-ttu-id="3aec6-204">定位鍵大小和位置</span><span class="sxs-lookup"><span data-stu-id="3aec6-204">Tab Size and Position</span></span>

<span data-ttu-id="3aec6-205">索引標籤控制項中的每個索引標籤都有大小和位置。</span><span class="sxs-lookup"><span data-stu-id="3aec6-205">Each tab in a tab control has a size and position.</span></span> <span data-ttu-id="3aec6-206">您可以設定索引標籤的大小、取出索引標籤的周框，或判斷哪個索引標籤位於指定的位置。</span><span class="sxs-lookup"><span data-stu-id="3aec6-206">You can set the size of tabs, retrieve the bounding rectangle of a tab, or determine which tab is at a specified position.</span></span>

<span data-ttu-id="3aec6-207">針對固定寬度和主控描繪的索引標籤控制項，您可以使用 [**TCM \_ SETITEMSIZE**](tcm-setitemsize.md) 訊息來設定索引標籤的精確寬度和高度。</span><span class="sxs-lookup"><span data-stu-id="3aec6-207">For fixed-width and owner-drawn tab controls, you can set the exact width and height of tabs by using the [**TCM\_SETITEMSIZE**](tcm-setitemsize.md) message.</span></span> <span data-ttu-id="3aec6-208">在其他索引標籤控制項中，每個索引標籤的大小都是根據索引標籤的圖示和標籤來計算。索引標籤控制項包含框線和額外邊界的空間。</span><span class="sxs-lookup"><span data-stu-id="3aec6-208">In other tab controls, each tab's size is calculated based on the icon and label for the tab. The tab control includes space for a border and an additional margin.</span></span> <span data-ttu-id="3aec6-209">您可以使用 [**TCM \_ SETPADDING**](tcm-setpadding.md) 訊息來設定邊界的粗細。</span><span class="sxs-lookup"><span data-stu-id="3aec6-209">You can set the thickness of the margin by using the [**TCM\_SETPADDING**](tcm-setpadding.md) message.</span></span>

<span data-ttu-id="3aec6-210">您可以使用 [**TCM \_ GETITEMRECT**](tcm-getitemrect.md) 訊息來判斷索引標籤目前的周框。</span><span class="sxs-lookup"><span data-stu-id="3aec6-210">You can determine the current bounding rectangle for a tab by using the [**TCM\_GETITEMRECT**](tcm-getitemrect.md) message.</span></span> <span data-ttu-id="3aec6-211">您可以使用 [**TCM \_ system.windows.media.visualtreehelper.hittest**](tcm-hittest.md) 訊息，判斷哪一個索引標籤（如果有的話）位於指定的位置。</span><span class="sxs-lookup"><span data-stu-id="3aec6-211">You can determine which tab, if any, is at a specified location by using the [**TCM\_HITTEST**](tcm-hittest.md) message.</span></span>

<span data-ttu-id="3aec6-212">在具有 [**TCS \_ 多行**](tab-control-styles.md) 樣式的索引標籤控制項中，您可以使用 [**TCM \_ GETROWCOUNT**](tcm-getrowcount.md) 訊息來判斷目前的索引標籤數目。</span><span class="sxs-lookup"><span data-stu-id="3aec6-212">In a tab control with the [**TCS\_MULTILINE**](tab-control-styles.md) style, you can determine the current number of rows of tabs by using the [**TCM\_GETROWCOUNT**](tcm-getrowcount.md) message.</span></span>

## <a name="owner-drawn-tabs"></a><span data-ttu-id="3aec6-213">Owner-Drawn] 索引標籤</span><span class="sxs-lookup"><span data-stu-id="3aec6-213">Owner-Drawn Tabs</span></span>

<span data-ttu-id="3aec6-214">如果有 [**TCS \_ OWNERDRAWFIXED**](tab-control-styles.md) 樣式的索引標籤控制項，父視窗必須藉由處理 [**WM \_ DRAWITEM**](wm-drawitem.md) 訊息來繪製索引標籤。</span><span class="sxs-lookup"><span data-stu-id="3aec6-214">If a tab control has the [**TCS\_OWNERDRAWFIXED**](tab-control-styles.md) style, the parent window must paint tabs by processing the [**WM\_DRAWITEM**](wm-drawitem.md) message.</span></span> <span data-ttu-id="3aec6-215">當需要繪製索引標籤時，索引標籤控制項會傳送此訊息。</span><span class="sxs-lookup"><span data-stu-id="3aec6-215">The tab control sends this message whenever a tab needs to be painted.</span></span> <span data-ttu-id="3aec6-216">*LParam* 參數會指定 [**DRAWITEMSTRUCT**](/windows/win32/api/winuser/ns-winuser-drawitemstruct)結構的位址，其中包含索引標籤的索引、其周框，以及要在其中繪製 (DC) 的裝置內容。</span><span class="sxs-lookup"><span data-stu-id="3aec6-216">The *lParam* parameter specifies the address of a [**DRAWITEMSTRUCT**](/windows/win32/api/winuser/ns-winuser-drawitemstruct) structure, which contains the index of the tab, its bounding rectangle, and the device context (DC) in which to draw.</span></span>

<span data-ttu-id="3aec6-217">依預設， [**DRAWITEMSTRUCT**](/windows/win32/api/winuser/ns-winuser-drawitemstruct)的 **itemData** 成員會包含 [**TCITEM**](/windows/win32/api/commctrl/ns-commctrl-tcitema)結構之 **lParam** 成員的值。</span><span class="sxs-lookup"><span data-stu-id="3aec6-217">By default, the **itemData** member of [**DRAWITEMSTRUCT**](/windows/win32/api/winuser/ns-winuser-drawitemstruct) contains the value of the **lParam** member of the [**TCITEM**](/windows/win32/api/commctrl/ns-commctrl-tcitema) structure.</span></span> <span data-ttu-id="3aec6-218">但是，如果您變更每個索引標籤的應用程式定義資料量， **itemData** 會改為包含資料的位址。</span><span class="sxs-lookup"><span data-stu-id="3aec6-218">However, if you change the amount of application-defined data per tab, **itemData** contains the address of the data instead.</span></span> <span data-ttu-id="3aec6-219">您可以使用 [**TCM \_ SETITEMEXTRA**](tcm-setitemextra.md) 訊息來變更每個索引標籤上的應用程式定義資料量。</span><span class="sxs-lookup"><span data-stu-id="3aec6-219">You can change the amount of application-defined data per tab by using the [**TCM\_SETITEMEXTRA**](tcm-setitemextra.md) message.</span></span>

<span data-ttu-id="3aec6-220">若要在索引標籤控制項中指定專案的大小，父視窗必須處理 [**WM \_ MEASUREITEM**](wm-measureitem.md) 訊息。</span><span class="sxs-lookup"><span data-stu-id="3aec6-220">To specify the size of items in a tab control, the parent window must process the [**WM\_MEASUREITEM**](wm-measureitem.md) message.</span></span> <span data-ttu-id="3aec6-221">由於主控描繪索引標籤控制項中的所有索引標籤大小都相同，因此此訊息只會傳送一次。</span><span class="sxs-lookup"><span data-stu-id="3aec6-221">Because all tabs in an owner-drawn tab control are the same size, this message is sent only once.</span></span> <span data-ttu-id="3aec6-222">針對不同大小的主控描繪索引標籤，沒有任何索引標籤控制項樣式。</span><span class="sxs-lookup"><span data-stu-id="3aec6-222">There is no tab control style for owner-drawn tabs of varying size.</span></span> <span data-ttu-id="3aec6-223">您也可以使用 [**TCM \_ SETITEMSIZE**](tcm-setitemsize.md) 訊息來設定索引標籤的寬度和高度。</span><span class="sxs-lookup"><span data-stu-id="3aec6-223">You can also set the width and height of tabs by using the [**TCM\_SETITEMSIZE**](tcm-setitemsize.md) message.</span></span>

## <a name="tab-control-tooltips"></a><span data-ttu-id="3aec6-224">索引標籤控制項工具提示</span><span class="sxs-lookup"><span data-stu-id="3aec6-224">Tab Control Tooltips</span></span>

<span data-ttu-id="3aec6-225">您可以使用工具提示控制項，在索引標籤控制項中提供每個索引標籤的簡短描述。</span><span class="sxs-lookup"><span data-stu-id="3aec6-225">You can use a tooltip control to provide a brief description of each tab in a tab control.</span></span> <span data-ttu-id="3aec6-226">具有 [**TCS \_ 工具提示**](tab-control-styles.md) 樣式的索引標籤控制項，會在建立時建立工具提示控制項，並在工具提示控制項損毀時將它終結。</span><span class="sxs-lookup"><span data-stu-id="3aec6-226">A tab control that has the [**TCS\_TOOLTIPS**](tab-control-styles.md) style creates a tooltip control when it is created and destroys the tooltip control when it is destroyed.</span></span> <span data-ttu-id="3aec6-227">您也可以建立工具提示控制項，並將它指派給索引標籤控制項。</span><span class="sxs-lookup"><span data-stu-id="3aec6-227">You can also create a tooltip control and assign it to a tab control.</span></span>

<span data-ttu-id="3aec6-228">如果您使用具有索引標籤控制項的工具提示控制項，父視窗必須處理 [TTN \_ GETDISPINFO](ttn-getdispinfo.md) 通知程式碼，以提供要求上每個索引標籤的描述。</span><span class="sxs-lookup"><span data-stu-id="3aec6-228">If you use a tooltip control with a tab control, the parent window must process the [TTN\_GETDISPINFO](ttn-getdispinfo.md) notification code to provide a description of each tab on request.</span></span>

<span data-ttu-id="3aec6-229">若要使用具有多個索引標籤控制項的相同工具提示控制項，請自行建立工具提示控制項，並使用 [**TCM \_ SETTOOLTIPS**](tcm-settooltips.md) 訊息將它指派給索引標籤控制項。</span><span class="sxs-lookup"><span data-stu-id="3aec6-229">To use the same tooltip control with more than one tab control, create the tooltip control yourself and assign it to the tab control by using the [**TCM\_SETTOOLTIPS**](tcm-settooltips.md) message.</span></span> <span data-ttu-id="3aec6-230">您可以使用 [**TCM \_ GETTOOLTIPS**](tcm-gettooltips.md) 訊息來抓取索引標籤控制項目前工具提示控制項的控制碼。</span><span class="sxs-lookup"><span data-stu-id="3aec6-230">You can retrieve the handle to a tab control's current tooltip control by using the [**TCM\_GETTOOLTIPS**](tcm-gettooltips.md) message.</span></span> <span data-ttu-id="3aec6-231">如果您建立自己的工具提示控制項，則不應使用 [**TCS \_ 工具提示**](tab-control-styles.md) 樣式。</span><span class="sxs-lookup"><span data-stu-id="3aec6-231">If you create your own tooltip control, you should not use the [**TCS\_TOOLTIPS**](tab-control-styles.md) style.</span></span>

## <a name="default-tab-control-message-processing"></a><span data-ttu-id="3aec6-232">預設選項卡控制訊息處理</span><span class="sxs-lookup"><span data-stu-id="3aec6-232">Default Tab Control Message Processing</span></span>

<span data-ttu-id="3aec6-233">本節說明由索引標籤控制項執行的訊息處理。</span><span class="sxs-lookup"><span data-stu-id="3aec6-233">This section describes the message processing performed by a tab control.</span></span> <span data-ttu-id="3aec6-234">本檔的其他章節將討論索引標籤控制項特定的訊息。</span><span class="sxs-lookup"><span data-stu-id="3aec6-234">Messages specific to tab controls are discussed in other sections of this documentation.</span></span>



| <span data-ttu-id="3aec6-235">訊息</span><span class="sxs-lookup"><span data-stu-id="3aec6-235">Message</span></span>                                                  | <span data-ttu-id="3aec6-236">處理已執行</span><span class="sxs-lookup"><span data-stu-id="3aec6-236">Processing performed</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|----------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="3aec6-237">**WM \_ CAPTURECHANGED**</span><span class="sxs-lookup"><span data-stu-id="3aec6-237">**WM\_CAPTURECHANGED**</span></span>](/windows/desktop/inputdev/wm-capturechanged) | <span data-ttu-id="3aec6-238">如果索引標籤控制項放開滑鼠捕捉本身，就不會執行任何動作。</span><span class="sxs-lookup"><span data-stu-id="3aec6-238">Does nothing if the tab control released the mouse capture itself.</span></span> <span data-ttu-id="3aec6-239">如果另一個視窗已捕捉到滑鼠，而按鈕已關閉，則命令會放開按鈕。</span><span class="sxs-lookup"><span data-stu-id="3aec6-239">If another window captured the mouse and a button is held down, the command releases the button.</span></span>                                                                                                                                                                                                                                                                                                                |
| [<span data-ttu-id="3aec6-240">**WM \_ 建立**</span><span class="sxs-lookup"><span data-stu-id="3aec6-240">**WM\_CREATE**</span></span>](/windows/desktop/winmsg/wm-create)                 | <span data-ttu-id="3aec6-241">配置並初始化內部資料結構。</span><span class="sxs-lookup"><span data-stu-id="3aec6-241">Allocates and initializes an internal data structure.</span></span> <span data-ttu-id="3aec6-242">如果指定了 [**TCS \_ 工具提示**](tab-control-styles.md) 樣式，控制項會建立工具提示控制項。</span><span class="sxs-lookup"><span data-stu-id="3aec6-242">The control creates a tooltip control if the [**TCS\_TOOLTIPS**](tab-control-styles.md) style is specified.</span></span>                                                                                                                                                                                                                                                                                                    |
| [<span data-ttu-id="3aec6-243">**WM 損 \_ 毀**</span><span class="sxs-lookup"><span data-stu-id="3aec6-243">**WM\_DESTROY**</span></span>](/windows/desktop/winmsg/wm-destroy)               | <span data-ttu-id="3aec6-244">釋出在 [**WM \_ 建立**](/windows/desktop/winmsg/wm-create) 處理期間配置的資源。</span><span class="sxs-lookup"><span data-stu-id="3aec6-244">Frees resources allocated during [**WM\_CREATE**](/windows/desktop/winmsg/wm-create) processing.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                    |
| [<span data-ttu-id="3aec6-245">**WM \_ GETDLGCODE**</span><span class="sxs-lookup"><span data-stu-id="3aec6-245">**WM\_GETDLGCODE**</span></span>](/windows/desktop/dlgbox/wm-getdlgcode)         | <span data-ttu-id="3aec6-246">傳回 DLGC \_ WANTARROWS 和 DLGC WANTCHARS 值的組合 \_ 。</span><span class="sxs-lookup"><span data-stu-id="3aec6-246">Returns a combination of the DLGC\_WANTARROWS and DLGC\_WANTCHARS values.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                          |
| [<span data-ttu-id="3aec6-247">**WM \_ GETFONT**</span><span class="sxs-lookup"><span data-stu-id="3aec6-247">**WM\_GETFONT**</span></span>](/windows/desktop/winmsg/wm-getfont)               | <span data-ttu-id="3aec6-248">傳回用於標籤之字型的控制碼。</span><span class="sxs-lookup"><span data-stu-id="3aec6-248">Returns the handle to the font used for labels.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| [<span data-ttu-id="3aec6-249">**WM \_ KEYDOWN**</span><span class="sxs-lookup"><span data-stu-id="3aec6-249">**WM\_KEYDOWN**</span></span>](/windows/desktop/inputdev/wm-keydown)               | <span data-ttu-id="3aec6-250">處理方向按鍵並變更選取範圍（如適用）。</span><span class="sxs-lookup"><span data-stu-id="3aec6-250">Processes direction keys and changes the selection, if appropriate.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                |
| [<span data-ttu-id="3aec6-251">**WM \_ KILLFOCUS**</span><span class="sxs-lookup"><span data-stu-id="3aec6-251">**WM\_KILLFOCUS**</span></span>](/windows/desktop/inputdev/wm-killfocus)           | <span data-ttu-id="3aec6-252">使具有焦點的索引標籤失效，因此將會重新繪製以反映未取得焦點狀態。</span><span class="sxs-lookup"><span data-stu-id="3aec6-252">Invalidates the tab that has the focus so it will be repainted to reflect an unfocused state.</span></span>                                                                                                                                                                                                                                                                                                                                                                                      |
| [<span data-ttu-id="3aec6-253">**WM \_ LBUTTONDOWN**</span><span class="sxs-lookup"><span data-stu-id="3aec6-253">**WM\_LBUTTONDOWN**</span></span>](/windows/desktop/inputdev/wm-lbuttondown)       | <span data-ttu-id="3aec6-254">將訊息轉送至工具提示控制項（如果有的話），並在使用者按一下索引標籤時變更選取專案。如果使用者按一下按鈕，控制項會重新繪製按鈕，以提供凹陷的外觀並捕捉滑鼠。</span><span class="sxs-lookup"><span data-stu-id="3aec6-254">Forwards the message to the tooltip control, if any, and changes the selection if the user is clicking a tab. If the user is clicking a button, the control redraws the button to give a sunken appearance and captures the mouse.</span></span> <span data-ttu-id="3aec6-255">如果使用者按一下索引標籤或按鈕，並指定 [**TCS \_ FOCUSONBUTTONDOWN**](tab-control-styles.md) 樣式，控制項就會將焦點設為本身。</span><span class="sxs-lookup"><span data-stu-id="3aec6-255">If the user is clicking either a tab or button and the [**TCS\_FOCUSONBUTTONDOWN**](tab-control-styles.md) style is specified, the control sets the focus to itself.</span></span>                                                     |
| [<span data-ttu-id="3aec6-256">**WM \_ LBUTTONUP**</span><span class="sxs-lookup"><span data-stu-id="3aec6-256">**WM\_LBUTTONUP**</span></span>](/windows/desktop/inputdev/wm-lbuttonup)           | <span data-ttu-id="3aec6-257">如果已按下按鈕，則放開滑鼠。</span><span class="sxs-lookup"><span data-stu-id="3aec6-257">Releases the mouse if a button was pressed.</span></span> <span data-ttu-id="3aec6-258">如果游標停留在按鈕上且正在關閉，控制項會據以變更選取專案，並重新繪製按鈕。</span><span class="sxs-lookup"><span data-stu-id="3aec6-258">If the cursor is over the button and is being held down, the control changes the selection accordingly and redraws the button.</span></span>                                                                                                                                                                                                                                                                                                         |
| [<span data-ttu-id="3aec6-259">**WM \_ MOUSEMOVE**</span><span class="sxs-lookup"><span data-stu-id="3aec6-259">**WM\_MOUSEMOVE**</span></span>](/windows/desktop/inputdev/wm-mousemove)           | <span data-ttu-id="3aec6-260">將訊息轉送至工具提示控制項（如果有的話）。</span><span class="sxs-lookup"><span data-stu-id="3aec6-260">Forwards the message to the tooltip control, if any.</span></span> <span data-ttu-id="3aec6-261">如果指定了 [ [**TCS] \_ 按鈕**](tab-control-styles.md) 樣式，並且在按一下之後將滑鼠按鍵保持在關閉狀態，則控制項也可以重繪受影響的按鈕，讓它成為引發或凹陷的外觀。</span><span class="sxs-lookup"><span data-stu-id="3aec6-261">If the [**TCS\_BUTTONS**](tab-control-styles.md) style is specified and the mouse button is being held down after clicking, the control may also redraw the affected button to give it a raised or sunken appearance.</span></span>                                                                                                                                                                                            |
| [<span data-ttu-id="3aec6-262">**WM \_ 通知**</span><span class="sxs-lookup"><span data-stu-id="3aec6-262">**WM\_NOTIFY**</span></span>](wm-notify.md)                          | <span data-ttu-id="3aec6-263">轉寄工具提示控制項所傳送的通知碼。</span><span class="sxs-lookup"><span data-stu-id="3aec6-263">Forwards notification codes sent by the tooltip control.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                           |
| [<span data-ttu-id="3aec6-264">**WM \_ 油漆**</span><span class="sxs-lookup"><span data-stu-id="3aec6-264">**WM\_PAINT**</span></span>](/windows/desktop/gdi/wm-paint)                            | <span data-ttu-id="3aec6-265">在顯示區域周圍繪製框線 (除非指定了 [**TCS \_ 按鈕**](tab-control-styles.md) 樣式) 並繪製任何交集于無效矩形的索引標籤。</span><span class="sxs-lookup"><span data-stu-id="3aec6-265">Draws a border around the display area (unless the [**TCS\_BUTTONS**](tab-control-styles.md) style is specified) and paints any tabs that intersect the invalid rectangle.</span></span> <span data-ttu-id="3aec6-266">在每個索引標籤中，它會繪製 (的索引標籤主體，或將 [**WM \_ DRAWITEM**](wm-drawitem.md) 訊息傳送至父視窗) ，然後在索引標籤周圍繪製框線。如果 *wParam* 參數不是 Null，則控制項會假設值為 HDC，並且使用該裝置內容繪製。</span><span class="sxs-lookup"><span data-stu-id="3aec6-266">For each tab, it draws the body of the tab (or sends a [**WM\_DRAWITEM**](wm-drawitem.md) message to the parent window) and then draws a border around the tab. If the *wParam* parameter is non-NULL, the control assumes that the value is an HDC and paints using that device context.</span></span> |
| [<span data-ttu-id="3aec6-267">**WM \_ RBUTTONDOWN**</span><span class="sxs-lookup"><span data-stu-id="3aec6-267">**WM\_RBUTTONDOWN**</span></span>](/windows/desktop/inputdev/wm-rbuttondown)       | <span data-ttu-id="3aec6-268">將 [NM \_ RCLICK](nm-rclick-tab.md) 通知程式碼傳送至父視窗。</span><span class="sxs-lookup"><span data-stu-id="3aec6-268">Sends an [NM\_RCLICK](nm-rclick-tab.md) notification code to the parent window.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                   |
| [<span data-ttu-id="3aec6-269">**WM \_ SETFOCUS**</span><span class="sxs-lookup"><span data-stu-id="3aec6-269">**WM\_SETFOCUS**</span></span>](/windows/desktop/inputdev/wm-setfocus)             | <span data-ttu-id="3aec6-270">使具有焦點的索引標籤失效，以便重新繪製以反映焦點狀態。</span><span class="sxs-lookup"><span data-stu-id="3aec6-270">Invalidates the tab that has the focus so that it will be repainted to reflect a focused state.</span></span>                                                                                                                                                                                                                                                                                                                                                                                    |
| [<span data-ttu-id="3aec6-271">**WM \_ SETFONT**</span><span class="sxs-lookup"><span data-stu-id="3aec6-271">**WM\_SETFONT**</span></span>](/windows/desktop/winmsg/wm-setfont)               | <span data-ttu-id="3aec6-272">設定用於標籤的字型。</span><span class="sxs-lookup"><span data-stu-id="3aec6-272">Sets the font used for labels.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| [<span data-ttu-id="3aec6-273">**WM \_ SETREDRAW**</span><span class="sxs-lookup"><span data-stu-id="3aec6-273">**WM\_SETREDRAW**</span></span>](/windows/desktop/gdi/wm-setredraw)                    | <span data-ttu-id="3aec6-274">設定內部旗標的狀態，這個旗標會決定當插入和刪除專案時、變更字型時，是否重新繪製控制項。</span><span class="sxs-lookup"><span data-stu-id="3aec6-274">Sets the state of an internal flag that determines whether the control is repainted when items are inserted and deleted, when the font is changed, and so on.</span></span>                                                                                                                                                                                                                                                                                                                      |
| [<span data-ttu-id="3aec6-275">**WM \_ 大小**</span><span class="sxs-lookup"><span data-stu-id="3aec6-275">**WM\_SIZE**</span></span>](/windows/desktop/winmsg/wm-size)                     | <span data-ttu-id="3aec6-276">重新計算索引標籤的位置，並且可能使部分的索引標籤控制項無效，以強制重新繪製部分或所有索引標籤。</span><span class="sxs-lookup"><span data-stu-id="3aec6-276">Recalculates the positions of tabs and may invalidate part of the tab control to force repainting of some or all tabs.</span></span>                                                                                                                                                                                                                                                                                                                                                             |



 

 

 