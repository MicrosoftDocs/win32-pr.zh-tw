---
title: 關於編輯控制項
description: 編輯控制項是一個矩形控制項視窗，通常是在對話方塊中用來讓使用者輸入和編輯文字。
ms.assetid: 43baa58a-bc00-47c0-a3fe-413d50f08c29
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e4bbc116d3cf96ec3f5349680cc4f4b3df673cfb
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/21/2020
ms.locfileid: "104382942"
---
# <a name="about-edit-controls"></a>關於編輯控制項

*編輯控制項* 是一個矩形控制項視窗，通常是在對話方塊中用來讓使用者輸入和編輯文字。

編輯控制項支援 Unicode 字元集，其中字元是兩個位元組，而 ANSI 字元集的字元是一個位元組。 如需 Unicode 和 ANSI 字元集的詳細資訊，請參閱 [unicode 和字元集](/windows/desktop/Intl/unicode-and-character-sets)。

*Rich edit 控制項* 支援許多在系統編輯控制項中無法使用的功能。 如需詳細資訊，請參閱 [Rich Edit 控制項](rich-edit-controls.md)。

本總覽將討論下列主題。

-   [編輯控制項功能](#edit-control-features)
-   [編輯控制項類型和樣式](#edit-control-types-and-styles)
    -   [多行樣式](#multiline-style)
    -   [滾動樣式](#scrolling-styles)
    -   [對齊樣式](#alignment-styles)
    -   [文字和輸入樣式](#text-and-input-styles)
    -   [視覺化樣式](#visual-styles)
-   [文字緩衝區](#the-text-buffer)
    -   [配置文字緩衝區](#allocating-a-text-buffer)
    -   [初始化文字緩衝區](#initializing-a-text-buffer)
    -   [將純文字緩衝區設為唯讀](#making-a-text-buffer-read-only)
-   [變更格式化矩形](#changing-the-formatting-rectangle)
-   [編輯控制項通知訊息](#edit-control-notification-messages)
-   [編輯控制項預設訊息處理](#edit-control-default-message-processing)

## <a name="edit-control-features"></a>編輯控制項功能

選取此選項時，編輯控制項會顯示閃爍的插入號，表示插入點。 然後，使用者可以輸入文字、移動插入點，或選取要使用鍵盤或滑鼠編輯的文字。 編輯控制項會以 [**WM \_ 命令**](/windows/desktop/menurc/wm-command) 訊息的形式，將通知碼傳送至其父視窗。 如需來自編輯控制項之訊息的詳細資訊，請參閱 [編輯控制項通知訊息](#edit-control-notification-messages)。 父視窗可以藉由呼叫 [**SendDlgItemMessage**](/windows/desktop/api/winuser/nf-winuser-senddlgitemmessagea) 函數，將訊息傳送至對話方塊中的編輯控制項。 您也可以使用預先定義的宏來傳送某些訊息。

系統提供單行編輯控制項和多行編輯控制項。 編輯控制項屬於編輯視窗類別。

下拉式方塊是一個控制項，結合了編輯控制項和清單方塊的大部分功能。 在下拉式方塊中，編輯控制項會顯示目前的選取專案，而清單方塊則會顯示使用者可以選取的選項。 如需下拉式方塊的詳細資訊，請參閱 [下拉式方塊](combo-boxes.md)。

許多開發人員會使用通用對話方塊程式庫中提供的對話方塊 (Comdlg32.dll) 來執行其他可能需要自訂編輯控制項的工作。 如需通用對話方塊的詳細資訊，請參閱 [通用對話方塊程式庫](/windows/desktop/dlgbox/common-dialog-box-library)。

## <a name="edit-control-types-and-styles"></a>編輯控制項類型和樣式

個別的編輯控制項可以同時有數個樣式。 大部分的開發人員會使用工具來開發對話方塊，因此可能不需要明確指定編輯控制項樣式。 但是，如果應用程式使用 [**CreateWindow**](/windows/desktop/api/winuser/nf-winuser-createwindowa) 或 [**CreateWindowEx**](/windows/desktop/api/winuser/nf-winuser-createwindowexa) 函式來建立編輯控制項，則必須指定這些編輯控制項樣式。 如需編輯控制項樣式的表格，請參閱 [編輯控制項樣式](edit-control-styles.md)。

每個編輯控制項都會指定樣式值的組合，以定義編輯控制項的外觀和功能。 樣式值可以建立單一行或多行編輯控制項的外觀;對齊控制項中的文字;並決定在編輯控制項中顯示文字的方式，甚至是。

### <a name="multiline-style"></a>多行樣式

編輯控制項有兩種線條樣式。 預設值是單行編輯控制項。 應用程式也可以使用 [**ES \_ 多行**](edit-control-styles.md) 樣式來建立多行編輯控制項。

### <a name="scrolling-styles"></a>滾動樣式

[**ES \_ AUTOHSCROLL**](edit-control-styles.md)樣式會在使用者輸入文字時，告知編輯控制項以水準方式滾動文字。 如果未指定此樣式，則編輯控制項無法水準滾動。 針對沒有 **ES \_ AUTOHSCROLL** 的單行編輯控制項，只會接受填滿控制項可見區域的字元。 針對沒有 **ES \_ AUTOHSCROLL** 的多行編輯控制項，當使用者輸入的文字多於可在單一行上顯示的文字時，文字會換行至下一行。 如果指定了多行編輯控制項的 **ES \_ AUTOHSCROLL** ，當使用者輸入的文字多於可在單一行上顯示的文字時，控制項會水準滾動; 文字不會換行。

[**ES \_AUTOHSCROLL**](edit-control-styles.md) 會自動套用至具有 [**WS \_ HSCROLL**](/windows/desktop/winmsg/window-styles) 樣式的靠左對齊、多行編輯控制項。 換句話說，任何靠左對齊、且具有水準捲軸的多行編輯控制項都會自動水準滾動。

[**ES \_**](edit-control-styles.md)未靠左對齊的多行編輯控制項會忽略 AUTOHSCROLL。 置中和靠右對齊的多行編輯控制項無法水準滾動

[**ES \_ AUTOVSCROLL**](edit-control-styles.md)樣式會告知編輯控制項，在使用者輸入超過編輯控制項中顯示的文字時，垂直地滾動文字。 這個樣式只適用于多行編輯控制項。 如果未指定多行編輯控制項的樣式，則在輸入的文字多於可顯示的文字時，編輯控制項將不會接受輸入。

### <a name="alignment-styles"></a>對齊樣式

有三種樣式可讓系統對齊編輯控制項中的文字。 [**Es \_ left**](edit-control-styles.md)、 [**es \_ CENTER**](edit-control-styles.md)和 [**es \_ right**](edit-control-styles.md)樣式可決定文字是靠左、置中還是靠右對齊。 靠右對齊和置中的多行編輯控制項不能有 [**ES \_ AUTOHSCROLL**](edit-control-styles.md) 樣式; 也就是說，它們無法水準滾動。

雖然不可能動態變更編輯控制項的對齊樣式，但是下列技巧可以用來解決這項限制：

-   建立多個編輯控制項，每個應用程式所需的樣式各一個，並視需要在兩者之間切換。
-   視需要使用所需的樣式來建立新的編輯控制項，然後切換至新的控制項。

### <a name="text-and-input-styles"></a>文字和輸入樣式

應用程式可以使用樣式來指定編輯控制項顯示文字的方式。 [**ES \_ 小寫**](edit-control-styles.md)樣式會將輸入編輯控制項的所有大寫字元轉換成小寫字元。 同樣地， [**ES \_ 大寫**](edit-control-styles.md) 樣式會將所有小寫字元都轉換成大寫字元。

如需有關字元集的詳細資訊，請參閱 [Unicode 和字元集](/windows/desktop/Intl/unicode-and-character-sets)。

[**ES \_ 編號**](edit-control-styles.md)樣式會將輸入限制為僅限編輯控制項中的數位。

[**ES \_ READONLY**](edit-control-styles.md)樣式會將編輯控制項變更為唯讀狀態。

[**ES \_ 密碼**](edit-control-styles.md)樣式會以星號顯示單行編輯控制項中的所有字元。 應用程式可以使用 [**EM \_ SETPASSWORDCHAR**](em-setpasswordchar.md) 訊息來定義要顯示的不同字元，如本主題稍後所述。

如果編輯控制項來自 Comctl32.dll 第6版，則會有黑色圓圈是 [**ES \_ 密碼**](edit-control-styles.md) 樣式的預設字元。 在舊版通用控制項的編輯控制項中，預設字元是星號。

[**ES \_ OEMCONVERT**](edit-control-styles.md)樣式會讓輸入至編輯控制項的文字從設定為 OEM 字元集的 windows 字元轉換，再轉換回 windows 字元集。 這可確保當應用程式呼叫 [**CharToOem**](/windows/desktop/api/winuser/nf-winuser-chartooema) 函式將編輯控制項中的 Windows 字串轉換成 OEM 字元時，會進行適當的字元轉換。 **ES \_OEMCONVERT** 最適合用於編輯控制項，其包含將在不支援 Unicode 的檔案系統上使用的檔案名。

針對對話方塊中的多行編輯控制項， [**ES \_ WANTRETURN**](edit-control-styles.md) 樣式會讓控制項在使用者按下 ENTER 鍵同時輸入文字時，插入一個換行字元。 如果未指定此樣式，按下 ENTER 鍵的效果就會與按下對話方塊中的預設推送按鈕相同。 如果沒有 **ES \_ WANTRETURN**，使用者必須按 CTRL + ENTER 來插入換行字元。 如需 Wordwrap 和分行符號的詳細資訊，請參閱 [處理 Wordwrap 和分行符號](edit-controls-text-operations.md)。

### <a name="visual-styles"></a>視覺化樣式

當編輯控制項沒有焦點時， [**ES \_ NOHIDESEL**](edit-control-styles.md) 樣式會讓選取的文字保持反白顯示。 如果沒有這個樣式，當控制項失去焦點時，選取的文字就會失去反白顯示。

依預設，編輯控制項沒有框線。 若要提供它，應用程式可以使用 [**WS \_ 框線**](/windows/desktop/winmsg/window-styles) 視窗樣式。

若要搭配編輯控制項使用視覺化樣式，應用程式必須包含資訊清單，而且必須在程式的開頭呼叫 [**InitCommonControls**](/windows/desktop/api/Commctrl/nf-commctrl-initcommoncontrols) 。 如需視覺化樣式的詳細資訊，請參閱 [視覺化樣式](themes-overview.md)。 如需資訊清單的詳細資訊，請參閱 [啟用視覺化樣式](cookbook-overview.md)。

## <a name="the-text-buffer"></a>文字緩衝區

系統會視需要將編輯控制項文字儲存在緩衝區中，並將其複製到控制項。

下列主題將討論系統如何配置和初始化緩衝區並變更其特性：

-   [配置文字緩衝區](#allocating-a-text-buffer)
-   [初始化文字緩衝區](#initializing-a-text-buffer)
-   [將純文字緩衝區設為唯讀](#making-a-text-buffer-read-only)

### <a name="allocating-a-text-buffer"></a>配置文字緩衝區

當系統建立編輯控制項時，它會自動建立一個文字緩衝區、設定它的初始大小，然後視需要增加大小。 單一行編輯控制項的大小最多可達 32 kb 的預先定義限制 (KB) 。 因為這項限制可能會變更，所以稱為「軟限制」。 應用程式可以將 [**EM \_ SETLIMITTEXT**](em-setlimittext.md) 訊息傳送至編輯控制項，以設定緩衝區大小的固定限制。 如果緩衝區超過任一個限制，系統就會傳送 [EN \_ ERRSPACE](en-errspace.md) 通知碼給應用程式。 應用程式可以藉由傳送 [**EM \_ GETLIMITTEXT**](em-getlimittext.md) 訊息來取得目前的文字限制。

系統通常會在對話方塊中，使用應用程式資料區段以外的記憶體，在對話方塊中建立編輯控制項緩衝區。 應用程式可以隱藏此預設配置行為，並使用 DS LOCALEDIT 樣式從其本機堆積建立緩衝區 \_ (在建立編輯控制項) 中，請參閱 [關於對話方塊](/windows/desktop/dlgbox/about-dialog-boxes) 中的「對話方塊範本樣式」。 使用 DS LOCALEDIT 樣式的應用程式 \_ 會負責所有的緩衝區配置。 若要進行初始配置，應用程式可以呼叫 [**LocalAlloc**](/windows/desktop/api/winbase/nf-winbase-localalloc) 函式，並將傳回的緩衝區控制碼傳送至編輯控制項，方法是將 [**EM \_ SETHANDLE**](em-sethandle.md) 訊息傳送給它。 為了讓後續的配置 (回應 [ \_ ERRSPACE](en-errspace.md) 通知程式碼（例如) ），應用程式應該儲存目前的緩衝區內容 (如有必要) 並取得新的緩衝區，如下所示。

若要儲存目前的緩衝區並取得新的緩衝區，請依照此程式進行操作。

1.  藉由傳送 [**EM \_ GETHANDLE**](em-gethandle.md) 訊息給控制項，來取得目前為多行編輯控制項中的文字配置的記憶體控制碼。
2.  藉由呼叫 [**>localfree**](/windows/desktop/api/winbase/nf-winbase-localfree) 函數來釋放緩衝區。
3.  藉由呼叫 [**LocalAlloc**](/windows/desktop/api/winbase/nf-winbase-localalloc)，取得新的緩衝區 (和緩衝區控制碼) 。
4.  傳送 [**EM \_ SETHANDLE**](em-sethandle.md) 訊息給控制項，以提供緩衝區控制碼給系統。

[**Em \_ SETHANDLE**](em-sethandle.md)和 [**em \_ GETHANDLE**](em-gethandle.md)訊息只適用于多行編輯控制項。

使用預設配置行為的應用程式 (也就是不使用 DS \_ LOCALEDIT 樣式 (請參閱 [ [關於] 對話方塊](/windows/desktop/dlgbox/about-dialog-boxes) 中的「對話方塊範本樣式」) ) 不得將 [**em \_ SETHANDLE**](em-sethandle.md) 和 [**em \_ GETHANDLE**](em-gethandle.md) 訊息傳送至編輯控制項。

傳送 [**em \_ SETHANDLE**](em-sethandle.md) 訊息有幾個副作用：它會清除 [復原] 旗標， (讓 [**em \_ CANUNDO**](em-canundo.md) 訊息傳回零) ，它會清除 [修改] 旗標 (讓 [**em \_ GETMODIFY**](em-getmodify.md) 訊息傳回零) ，然後重新繪製編輯控制項視窗。

### <a name="initializing-a-text-buffer"></a>初始化文字緩衝區

應用程式可以藉由呼叫 [**SetDlgItemText**](/windows/desktop/api/winuser/nf-winuser-setdlgitemtexta) 函數來初始化或重新初始化編輯控制項的文字緩衝區。 應用程式可以藉由呼叫 [**GetDlgItemText**](/windows/desktop/api/winuser/nf-winuser-getdlgitemtexta) 函式來取出文字緩衝區的內容。

### <a name="making-a-text-buffer-read-only"></a>將純文字緩衝區設為唯讀

針對每個編輯控制項，系統會維護唯讀旗標，指出控制項的文字是否為 (預設) 或唯讀的。 應用程式可以藉由傳送 [**EM \_ SETREADONLY**](em-setreadonly.md) 訊息給控制項，來設定文字的讀取/寫入旗標或唯讀旗標。 若要判斷編輯控制項是否為唯讀，應用程式可以使用 **GWL \_ 樣式** 常數來呼叫 [**GetWindowLong**](/windows/desktop/api/winuser/nf-winuser-getwindowlonga)函數。 **EM \_ SETREADONLY** 訊息適用于單行和多行編輯控制項。

## <a name="changing-the-formatting-rectangle"></a>變更格式化矩形

編輯控制項的文字可見度是由其視窗矩形的維度及其格式化矩形所控管。 視窗矩形是包含編輯控制項之視窗的工作區。 格式化矩形是由系統維護的結構，用來格式化視窗矩形中顯示的文字。 第一次顯示編輯控制項時，螢幕上的兩個矩形會相同。 應用程式可以使格式設定矩形大於視窗矩形 (因此會限制編輯控制項文字的可見度) 或小於視窗矩形 (因此會在文字) 周圍建立額外的空白字元。

應用程式可以藉由將 [**EM \_ SETRECT**](em-setrect.md) 訊息傳送給它，來設定編輯控制項格式化矩形的座標。 **EM \_ SETRECT** 訊息也會自動重新繪製編輯控制項的文字。 若要在不重繪控制項文字的情況下建立格式化矩形的座標，應用程式可以傳送 [**EM \_ SETRECTNP**](em-setrectnp.md) 訊息給控制項。 若要取出格式化矩形的座標，應用程式可以傳送 [**EM \_ GETRECT**](em-getrect.md) 訊息給控制項。 這些訊息只適用于多行編輯控制項。

## <a name="edit-control-notification-messages"></a>編輯控制項通知訊息

使用者使用鍵盤和滑鼠來進行編輯要求。 系統會以 [**WM \_ 命令**](/windows/desktop/menurc/wm-command) 訊息的形式，將每個要求傳送至編輯控制項的父視窗。 此訊息會在 *wParam* 參數的低序位字組中包含編輯控制項識別碼、在 *lParam* 參數中包含編輯控制項的控制碼，以及在 *wParam* 參數的高序位字中對應至使用者動作的編輯控制項通知程式碼。

應用程式應該檢查每個通知訊息隨附的通知碼，並適當地回應。 下表列出每個編輯控制項通知碼以及產生它的動作。



| 通知碼                 | 使用者動作                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|-----------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [EN \_ 變更](en-change.md)       | 使用者已修改編輯控制項中的文字。 系統會在傳送此通知程式碼之前，先更新顯示 (與) [ \_ 更新](en-update.md) 不同。                                                                                                                                                                                                                                                                                                                                                                                                                     |
| [EN \_ ERRSPACE](en-errspace.md)   | 編輯控制項無法配置足夠的記憶體來符合特定的要求。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| [EN \_ HSCROLL](en-hscroll.md)     | 使用者已按一下編輯控制項的水準捲軸。 系統會先傳送此通知碼，然後再更新畫面。                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| [EN \_ KILLFOCUS](en-killfocus.md) | 使用者選取了另一個控制項。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| [EN \_ MAXTEXT](en-maxtext.md)     | 插入文字時，使用者已超過編輯控制項的指定字元數。 插入已被截斷。 當編輯控制項沒有 [**es \_ AUTOHSCROLL**](edit-control-styles.md) 樣式，以及要插入的字元數超過編輯控制項的寬度，或當編輯控制項沒有 [**es \_ AUTOVSCROLL**](edit-control-styles.md) 樣式，且要插入的行總數超過編輯控制項的高度時，也會傳送此通知碼。 |
| [EN \_ SETFOCUS](en-setfocus.md)   | 使用者已選取此編輯控制項。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| [EN \_ 更新](en-update.md)       | 使用者已更改編輯控制項中的文字，而系統即將顯示新的文字。 系統會在格式化文字之後，但在顯示文字之前傳送此通知碼，讓應用程式可以調整編輯控制項視窗的大小。                                                                                                                                                                                                                                                                                                                   |
| [EN \_ VSCROLL](en-vscroll.md)     | 使用者已按下編輯控制項的垂直捲動條，或是在編輯控制項上方滾動滑鼠滾輪。 系統會先傳送此通知碼，然後再更新畫面。                                                                                                                                                                                                                                                                                                                                                                                        |
| [EN \_ SEARCHWEB](en-searchweb.md) | 使用者已按下 [搜尋 web] 內容功能表項目。 系統會在啟動瀏覽器之後傳送這則通知。                                                                                                                                                                                                                                                                                                                                                                                        |



 

此外，系統會在繪製編輯控制項之前，將 [**WM \_ CTLCOLOREDIT**](wm-ctlcoloredit.md) 訊息傳送至編輯控制項的父視窗。 此訊息包含編輯控制項的顯示內容 (DC) 的控制碼，以及子視窗的控制碼。 父視窗可以使用這些控點來變更編輯控制項的文字和背景色彩。

## <a name="edit-control-default-message-processing"></a>編輯控制項預設訊息處理

預先定義的編輯控制項視窗類別的視窗程式，會針對編輯控制程式未處理的所有訊息執行預設處理。 當編輯控制程式針對任何訊息傳回 **FALSE** 時，預先定義的視窗程式會檢查訊息，並執行下列預設動作。



| 訊息                                                   | 預設動作                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|-----------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [**EM \_ CANUNDO**](em-canundo.md)                         | 如果編輯控制項作業可以復原，則傳回 **TRUE** 。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| [**EM \_ CHARFROMPOS**](em-charfrompos.md)                 | 傳回最接近指定點之字元的字元索引和行索引。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| [**EM \_ EMPTYUNDOBUFFER**](em-emptyundobuffer.md)         | 清空復原緩衝區，並將 [**EM \_ CANUNDO**](em-canundo.md) 訊息取出的復原旗標設定為 **FALSE**。 每當編輯控制項收到 [**WM \_ SETTEXT**](/windows/desktop/winmsg/wm-settext) 或 [**EM \_ SETHANDLE**](em-sethandle.md) 訊息時，系統就會自動清除復原旗標。                                                                                                                                                                                                                                                                                 |
| [**EM \_ FMTLINES**](em-fmtlines.md)                       | 在多行編輯控制項中，新增或移除 (兩個換行字元和換行字元的換行字元) 至換行字元的結尾。 單行編輯控制項不會處理它。                                                                                                                                                                                                                                                                                                                                                                                     |
| [**EM \_ GETFIRSTVISIBLELINE**](em-getfirstvisibleline.md) | 傳回單行編輯控制項中第一個可見字元的以零為起始的索引，或多行編輯控制項中最上層可見行之以零為起始的索引。                                                                                                                                                                                                                                                                                                                                                                                                      |
| [**EM \_ GETHANDLE**](em-gethandle.md)                     | 傳回控制碼，識別包含多行編輯控制項文字的緩衝區。 單行編輯控制項不會處理它。                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| [**EM \_ GETLIMITTEXT**](em-getlimittext.md)               | 傳回目前的文字限制（以字元為單位）。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| [**EM \_ GETLINE**](em-getline.md)                         | 將單行編輯控制項中的字元複製到緩衝區，並傳回復制的字元數。 在多行編輯控制項中，從控制項取出一行文字，並傳回復制的字元數。                                                                                                                                                                                                                                                                                                                                                      |
| [**EM \_ GETLINECOUNT**](em-getlinecount.md)               | 傳回編輯控制項中的行數。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| [**EM \_ GETMARGINS**](em-getmargins.md)                   | 傳回左邊界和右邊界的寬度。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| [**EM \_ GETMODIFY**](em-getmodify.md)                     | 傳回旗標，指出編輯控制項的內容是否已修改。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| [**EM \_ GETPASSWORDCHAR**](em-getpasswordchar.md)         | 傳回編輯控制項搭配 [**ES \_ 密碼**](edit-control-styles.md) 樣式使用的字元。                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| [**EM \_ GETRECT**](em-getrect.md)                         | 傳回編輯控制項中格式化矩形的座標。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| [**EM \_ GETSEL**](em-getsel.md)                           | 傳回編輯控制項中目前選取範圍的開始和結束字元位置。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| [**EM \_ GETTHUMB**](em-getthumb.md)                       | 以多行編輯控制項的方式，傳回垂直捲動條中捲動方塊的位置。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| [**EM \_ GETWORDBREAKPROC**](em-getwordbreakproc.md)       | 傳回編輯控制項中目前 Wordwrap 函式的位址。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| [**EM \_ LINEFROMCHAR**](em-linefromchar.md)               | 傳回包含指定字元索引的多行編輯控制項中，以零為基底的行號。 這則訊息是 [**EM \_ LINEINDEX**](em-lineindex.md) 訊息的反向。 單行編輯控制項不會處理它。                                                                                                                                                                                                                                                                                                                              |
| [**EM \_ LINEINDEX**](em-lineindex.md)                     | 傳回多行編輯控制項中的行字元。 這則訊息是 [**EM \_ LINEFROMCHAR**](em-linefromchar.md) 訊息的反向。 單行編輯控制項不會處理它。                                                                                                                                                                                                                                                                                                                                                                            |
| [**EM \_ LINELENGTH**](em-linelength.md)                   | 傳回單行編輯控制項的長度（以字元為單位）。 在多行編輯控制項中，傳回指定行的長度（以字元為單位）。                                                                                                                                                                                                                                                                                                                                                                                                                            |
| [**EM \_ LINESCROLL**](em-linescroll.md)                   | 當控制項有 [**ES \_ 左方**](edit-control-styles.md) 樣式的) 時，在單行編輯控制項中垂直捲動文字，或在多行編輯控制項中水準滾動文字 (。 *LParam* 參數會指定要垂直捲動的行數（從目前的行開始）。 *WParam* 參數會指定要水準滾動的字元數（從目前的字元開始）。                                                                                                                                                         |
| [**EM \_ POSFROMCHAR**](em-posfromchar.md)                 | 傳回指定字元的用戶端座標。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| [**EM \_ REPLACESEL**](em-replacesel.md)                   | 將目前的選取範圍取代為應用程式提供的緩衝區中的文字、傳送父視窗的 [ \_ UPDATE](en-update.md) 和 [en \_ 變更](en-change.md) 通知碼，以及更新復原緩衝區。                                                                                                                                                                                                                                                                                                                                                              |
| [**EM \_ 捲軸**](em-scroll.md)                           | 在多行編輯控制項中垂直捲動文字。 這則訊息相當於將 [**WM \_ VSCROLL**](wm-vscroll.md) 訊息傳送至編輯控制項。 單行編輯控制項不會處理它。                                                                                                                                                                                                                                                                                                                                                                 |
| [**EM \_ SCROLLCARET**](em-scrollcaret.md)                 | 將插入號滾動至編輯控制項中的 view。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| [**EM \_ SETFONT**](em-setfontsize.md)                     | 不支援。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| [**EM \_ SETHANDLE**](em-sethandle.md)                     | 將控制碼設定為當做文字緩衝區使用的記憶體、清空復原緩衝區、將捲軸位置重設為零，然後重新繪製視窗。                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| [**EM \_ SETLIMITTEXT**](em-setlimittext.md)               | 設定使用者可以在編輯控制項中輸入的最大字元數。 針對單行編輯控制項，此值為0x7FFFFFFE 或 *wParam* 參數的值，以較小者為准。 若為多行編輯控制項，此值為1或 *wParam* 參數的值，以較小者為准。<br/>                                                                                                                                                                                                                                          |
| [**EM \_ SETMARGINS**](em-setmargins.md)                   | 設定左邊界和右邊界的寬度，並重新繪製編輯控制項以反映新的邊界。                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| [**EM \_ SETMODIFY**](em-setmodify.md)                     | 設定或清除修改旗標，指出編輯控制項是否已修改。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| [**EM \_ SETPASSWORDCHAR**](em-setpasswordchar.md)         | 定義編輯控制項搭配 [**ES \_ 密碼**](edit-control-styles.md) 樣式使用的字元。                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| [**EM \_ SETREADONLY**](em-setreadonly.md)                 | 在編輯控制項中，設定或移除唯讀樣式 ([**ES \_ READONLY**](edit-control-styles.md)) 。                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| [**EM \_ SETRECT**](em-setrect.md)                         | 設定多行編輯控制項的格式化矩形，並重新繪製視窗。 單行編輯控制項不會處理它。                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| [**EM \_ SETRECTNP**](em-setrectnp.md)                     | 設定多行編輯控制項的格式化矩形，但不重繪視窗。 單行編輯控制項不會處理它。                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| [**EM \_ SETSEL**](em-setsel.md)                           | 藉由設定要選取的開始和結束位置，選取編輯控制項中的字元範圍。                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| [**EM \_ SETTABSTOPS**](em-settabstops.md)                 | 在多行編輯控制項中設定制表位位置。 單行編輯控制項不會處理它。                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| [**EM \_ SETWORDBREAKPROC**](em-setwordbreakproc.md)       | 使用應用程式定義的 Wordwrap 函數來取代預設的 Wordwrap 函式。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| [**EM \_ 復原**](em-undo.md)                               | 移除剛插入或插入任何已刪除字元的文字，並將選取範圍設定為插入的文字。 如有必要，將 [en \_ 更新](en-update.md) 和 [en \_ 變更](en-change.md) 通知代碼傳送至父視窗。                                                                                                                                                                                                                                                                                                                               |
| [**WM \_ 字元**](/windows/desktop/inputdev/wm-char)                          | 將字元寫入單行編輯控制項，並將 [en \_ 更新](en-update.md) 和 [en \_ 變更](en-change.md) 通知程式碼傳送至父視窗。 將字元寫入至多行編輯控制項。 處理標準函式的快速鍵，例如用於複製的 CTRL + C，以及用來貼上的 CTRL + V。 在多行編輯控制項中，也可以使用 [進程] 索引標籤和 CTRL + TAB 鍵，在對話方塊中的控制項之間移動，以及在多行編輯控制項中插入索引標籤。 針對不合法的字元使用 [**MessageBeep**](/windows/desktop/api/winuser/nf-winuser-messagebeep) 函數。 |
| [**WM \_ 清除**](/windows/desktop/dataxchg/wm-clear)                        | 清除編輯控制項中目前的選取專案（如果有的話）。 如果沒有目前的選取範圍，會刪除插入號右邊的字元。 如果使用者按下 SHIFT 鍵，則會將選取專案剪下到剪貼簿，或在沒有選取專案時，刪除插入號左方的字元。 如果使用者按下 CTRL 鍵，就會刪除選取範圍，或在沒有選取專案時刪除到行尾。                                                                                                                                               |
| [**WM \_ 複製**](/windows/desktop/dataxchg/wm-copy)                          | 會將文字複製到剪貼簿，除非 style 是 [**ES \_ 密碼**](edit-control-styles.md)，在此情況下，訊息會傳回零。                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| [**WM \_ 建立**](/windows/desktop/winmsg/wm-create)                        | 建立編輯控制項，並通知父視窗， **如果** 成功，則為1，否則為1。                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| [**WM \_ 剪下**](/windows/desktop/dataxchg/wm-cut)                            | 將選取專案剪下到剪貼簿，或刪除游標左邊的字元（如果沒有選取）。                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| [**\_啟用 WM**](/windows/desktop/winmsg/wm-enable)                        | 使單一線條編輯控制項的矩形以灰色重繪。 傳回單行和多行編輯控制項的已啟用狀態。                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| [**WM \_ ERASEBKGND**](/windows/desktop/winmsg/wm-erasebkgnd)                | 以編輯控制項的目前色彩填滿多行編輯控制項視窗。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| [**WM \_ GETDLGCODE**](/windows/desktop/dlgbox/wm-getdlgcode)                | 傳回下列值： DLGC \_ WANTCHARS、DLGC \_ HASSETSEL 和 DLGC \_ WANTARROWS。 在多行編輯控制項中，它也會傳回 DLGC \_ WANTALLKEYS。 如果使用者按下 ALT + 倒退鍵，它也會傳回 DLGC \_ WANTMESSAGE。                                                                                                                                                                                                                                                                                                                                                        |
| [**WM \_ GETFONT**](/windows/desktop/winmsg/wm-getfont)                      | 傳回控制項所使用之字型的控制碼，如果控制項使用系統字型，則 **為 Null** 。                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| [**WM \_ GETTEXT**](/windows/desktop/winmsg/wm-gettext)                      | 將指定的字元數複製到緩衝區，並傳回復制的字元數。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| [**WM \_ GETTEXTLENGTH**](/windows/desktop/winmsg/wm-gettextlength)          | 傳回編輯控制項中文字的長度（以字元為單位）。 長度不包含 null 終止字元。                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| [**WM \_ HSCROLL**](wm-hscroll.md)                         | 水準滾動多行編輯控制項中的文字，並處理捲動方塊的移動。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| [**WM \_ KEYDOWN**](/windows/desktop/inputdev/wm-keydown)                    | 執行虛擬金鑰程式碼的標準處理。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| [**WM \_ KILLFOCUS**](/windows/desktop/inputdev/wm-killfocus)                | 移除編輯控制項視窗的鍵盤焦點、終結插入號、隱藏目前的選取範圍，然後通知父視窗，編輯控制項已遺失焦點。                                                                                                                                                                                                                                                                                                                                                                                                   |
| [**WM \_ LBUTTONDBLCLK**](/windows/desktop/inputdev/wm-lbuttondblclk)        | 清除目前的選取範圍，並選取游標下的文字。 如果 SHIFT 鍵已按下，則會將選取範圍延伸至游標下的單字。                                                                                                                                                                                                                                                                                                                                                                                                                            |
| [**WM \_ LBUTTONDOWN**](/windows/desktop/inputdev/wm-lbuttondown)            | 變更目前的插入點。 如果按下 SHIFT 鍵，則會將選取範圍擴充到游標的位置。 在多行編輯控制項中，也會將計時器設定為當使用者按住滑鼠按鍵時，自動滾動至多行編輯控制項視窗之外。                                                                                                                                                                                                                                                                                             |
| [**WM \_ LBUTTONUP**](/windows/desktop/inputdev/wm-lbuttonup)                | 釋放滑鼠捕捉，並設定單行編輯控制項中的文字插入點。 在多行編輯控制項中，也會終止在 [**WM \_ LBUTTONDOWN**](/windows/desktop/inputdev/wm-lbuttondown) 訊息中設定的計時器。                                                                                                                                                                                                                                                                                                                                                           |
| [**WM \_ MOUSEMOVE**](/windows/desktop/inputdev/wm-mousemove)                | 如果滑鼠按鍵已關閉，則變更單行編輯控制項中目前的選取範圍。 在多行編輯控制項中，也會將計時器設定為當使用者按住滑鼠按鍵，以在多行編輯控制項視窗之外時自動滾動。                                                                                                                                                                                                                                                                                                                          |
| [**WM \_ NCCREATE**](/windows/desktop/winmsg/wm-nccreate)                    | 視窗 [**CREATESTRUCT**](/windows/win32/api/winuser/ns-winuser-createstructa) 結構的指標。 當您第一次建立視窗時，會將此訊息傳送至 [**WM \_ CREATE**](/windows/desktop/winmsg/wm-create) message。                                                                                                                                                                                                                                                                                                                                                                                           |
| [**WM \_ NCDESTROY**](/windows/desktop/winmsg/wm-ncdestroy)                  | 釋出與編輯控制項視窗相關聯的所有記憶體，包括文字緩衝區、復原緩衝區、tab 鍵停止緩衝區和反白筆刷。                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| [**WM \_ 油漆**](/windows/desktop/gdi/wm-paint)                             | 清除背景、以編輯控制項視窗的目前色彩填滿視窗、繪製框線 (（如果有任何) ）、設定字型並繪製任何文字，以及顯示文字插入插入號。                                                                                                                                                                                                                                                                                                                                                                                       |
| [**WM \_ 貼上**](/windows/desktop/dataxchg/wm-paste)                        | 將剪貼簿中的文字貼入位於插入號位置的 [編輯] 控制項視窗。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| [**WM \_ SETFOCUS**](/windows/desktop/inputdev/wm-setfocus)                  | 設定編輯控制項視窗的鍵盤焦點 (顯示目前的選取專案（如果已隱藏），並建立插入號) 。                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| [**WM \_ SETFONT**](/windows/desktop/winmsg/wm-setfont)                      | 設定字型，並選擇性地重新繪製編輯控制項。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| [**WM \_ SETTEXT**](/windows/desktop/winmsg/wm-settext)                      | 會將文字複製到單行編輯控制項，當記憶體不足、清空復原緩衝區，並將 [en \_ 更新](en-update.md) 和 [en \_ 變更](en-change.md) 通知程式碼傳送至父視窗時，就會通知父視窗。 在多行編輯控制項中，您也可以視需要 rewraps (行) 並設定捲軸位置。                                                                                                                                                                                                                           |
| [**WM \_ 大小**](/windows/desktop/winmsg/wm-size)                            | 設定編輯控制項視窗的大小，以確保大小能容納字元的高度和寬度。                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| [**WM \_ SYSCHAR**](/windows/desktop/menurc/wm-syschar)                      | 如果使用者按下 ALT + 倒退鍵，則傳回 **TRUE** ;否則不採取任何動作。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| [**WM \_ SYSKEYDOWN**](/windows/desktop/inputdev/wm-syskeydown)              | 如果使用者按下 ALT + 倒退鍵，則復原最後一個動作;否則不採取任何動作。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| [**WM \_ 計時器**](/windows/desktop/winmsg/wm-timer)                          | 如果使用者按住滑鼠按鍵，在 [多行編輯控制項] 視窗之外，就會滾動編輯控制項視窗中的文字。                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| [**WM \_ 復原**](wm-undo.md)                               | 移除剛插入或插入任何已刪除字元的文字，並將選取範圍設定為插入的文字。 如有必要，將 [en \_ 更新](en-update.md) 和 [en \_ 變更](en-change.md) 通知代碼傳送至父視窗。                                                                                                                                                                                                                                                                                                                               |
| [**WM \_ VSCROLL**](wm-vscroll.md)                         | 垂直捲動多行編輯控制項，並處理捲動方塊的移動。 單行編輯控制項不會處理它。                                                                                                                                                                                                                                                                                                                                                                                                                                                    |



 

預先定義的編輯控制項視窗程式會將所有其他訊息傳遞至 [**DefWindowProc**](/windows/desktop/api/winuser/nf-winuser-defwindowproca) 函式，以進行預設處理。

 

