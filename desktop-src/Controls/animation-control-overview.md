---
title: 關於動畫控制項
description: 動畫控制項是顯示 Audio-Video 交錯 (AVI) 剪輯的視窗。 AVI 剪輯是一系列的點陣圖框架，例如電影。 動畫控制項只能顯示不包含音訊的 AVI 剪輯。
ms.assetid: 6be69d1a-5b2c-41d5-b6d7-e86ddac2cb0d
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 1625828e5f4febce7314da365c9db93ce3a07136
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/21/2020
ms.locfileid: "106965870"
---
# <a name="about-animation-controls"></a><span data-ttu-id="d7721-105">關於動畫控制項</span><span class="sxs-lookup"><span data-stu-id="d7721-105">About Animation Controls</span></span>

<span data-ttu-id="d7721-106">*動畫控制項* 是顯示 Audio-Video 交錯 (AVI) 剪輯的視窗。</span><span class="sxs-lookup"><span data-stu-id="d7721-106">An *animation control* is a window that displays an Audio-Video Interleaved (AVI) clip.</span></span> <span data-ttu-id="d7721-107">AVI 剪輯是一系列的點陣圖框架，例如電影。</span><span class="sxs-lookup"><span data-stu-id="d7721-107">An AVI clip is a series of bitmap frames like a movie.</span></span> <span data-ttu-id="d7721-108">動畫控制項只能顯示不包含音訊的 AVI 剪輯。</span><span class="sxs-lookup"><span data-stu-id="d7721-108">Animation controls can only display AVI clips that do not contain audio.</span></span>

<span data-ttu-id="d7721-109">動畫控制項的常見用途之一，是在冗長的作業期間表示系統活動。</span><span class="sxs-lookup"><span data-stu-id="d7721-109">One common use for an animation control is to indicate system activity during a lengthy operation.</span></span> <span data-ttu-id="d7721-110">這是可能的，因為操作執行緒會在顯示 AVI 剪輯時繼續執行。</span><span class="sxs-lookup"><span data-stu-id="d7721-110">This is possible because the operation thread continues executing while the AVI clip is displayed.</span></span> <span data-ttu-id="d7721-111">例如，Windows 檔案總管的 [尋找] 對話方塊會在系統搜尋檔案時顯示移動放大鏡。</span><span class="sxs-lookup"><span data-stu-id="d7721-111">For example, the Find dialog box of Windows Explorer displays a moving magnifying glass as the system searches for a file.</span></span>

> [!Note]  
> <span data-ttu-id="d7721-112">如果您使用 ComCtl32.dll 版本6，則不支援此執行緒;請確定您的應用程式不會封鎖 UI，否則不會發生動畫。</span><span class="sxs-lookup"><span data-stu-id="d7721-112">If you are using ComCtl32.dll version 6 the thread is not supported; make sure that your application does not block the UI, or else the animation will not occur.</span></span>

 

<span data-ttu-id="d7721-113">動畫控制項可以顯示源自未壓縮 AVI 檔案的 AVI 剪輯，或從使用執行時間長度 (BI RLE8) 編碼所壓縮的 AVI 檔案 \_ 。</span><span class="sxs-lookup"><span data-stu-id="d7721-113">An animation control can display an AVI clip originating from either an uncompressed AVI file or from an AVI file that was compressed using run-length (BI\_RLE8) encoding.</span></span> <span data-ttu-id="d7721-114">您可以將 AVI 剪輯以 AVI 資源的形式新增至您的應用程式，也可以將您的應用程式隨附于不同的 AVI 檔。</span><span class="sxs-lookup"><span data-stu-id="d7721-114">You can add the AVI clip to your application as an AVI resource, or the clip can accompany your application as a separate AVI file.</span></span>

> [!Note]  
> <span data-ttu-id="d7721-115">AVI 檔案或資源不能有音效通道。</span><span class="sxs-lookup"><span data-stu-id="d7721-115">The AVI file, or resource, must not have a sound channel.</span></span> <span data-ttu-id="d7721-116">動畫控制項的功能非常有限，而且可能會變更。</span><span class="sxs-lookup"><span data-stu-id="d7721-116">The capabilities of the animation control are very limited and are subject to change.</span></span> <span data-ttu-id="d7721-117">如果您需要控制項來提供應用程式的多媒體播放和記錄功能，您可以使用 MCIWnd 控制項。</span><span class="sxs-lookup"><span data-stu-id="d7721-117">If you need a control to provide multimedia playback and recording capabilities for your application, you can use the MCIWnd control.</span></span> <span data-ttu-id="d7721-118">如需詳細資訊，請參閱 [MCIWnd 視窗類別](/windows/desktop/Multimedia/mciwnd-window-class)。</span><span class="sxs-lookup"><span data-stu-id="d7721-118">For more information, see [MCIWnd Window Class](/windows/desktop/Multimedia/mciwnd-window-class).</span></span>

 

<span data-ttu-id="d7721-119">本節將討論下列主題。</span><span class="sxs-lookup"><span data-stu-id="d7721-119">This section discusses the following topics.</span></span>

-   [<span data-ttu-id="d7721-120">建立動畫控制項</span><span class="sxs-lookup"><span data-stu-id="d7721-120">Animation Control Creation</span></span>](#animation-control-creation)
-   [<span data-ttu-id="d7721-121">關於動畫控制項訊息</span><span class="sxs-lookup"><span data-stu-id="d7721-121">About Animation Control Messages</span></span>](#about-animation-control-messages)
-   [<span data-ttu-id="d7721-122">預設訊息處理</span><span class="sxs-lookup"><span data-stu-id="d7721-122">Default Message Processing</span></span>](#default-message-processing)

## <a name="animation-control-creation"></a><span data-ttu-id="d7721-123">建立動畫控制項</span><span class="sxs-lookup"><span data-stu-id="d7721-123">Animation Control Creation</span></span>

<span data-ttu-id="d7721-124">動畫控制項屬於 [**動畫 \_ 類別**](common-control-window-classes.md) 視窗類別。</span><span class="sxs-lookup"><span data-stu-id="d7721-124">An animation control belongs to the [**ANIMATE\_CLASS**](common-control-window-classes.md) window class.</span></span> <span data-ttu-id="d7721-125">您可以使用 [**CreateWindow**](/windows/desktop/api/winuser/nf-winuser-createwindowa) 或 [**CreateWindowEx**](/windows/desktop/api/winuser/nf-winuser-createwindowexa) 函式或建立動畫宏 [**\_ 建立**](/windows/desktop/api/Commctrl/nf-commctrl-animate_create) 動畫控制項。</span><span class="sxs-lookup"><span data-stu-id="d7721-125">You create an animation control by using the [**CreateWindow**](/windows/desktop/api/winuser/nf-winuser-createwindowa) or [**CreateWindowEx**](/windows/desktop/api/winuser/nf-winuser-createwindowexa) function or the [**Animate\_Create**](/windows/desktop/api/Commctrl/nf-commctrl-animate_create) macro.</span></span> <span data-ttu-id="d7721-126">宏會將動畫控制項放在父視窗的左上角，如果未指定 [**ACS \_ CENTER**](animation-control-styles.md) 樣式，則會根據 AVI 剪輯中的框架維度來設定控制項的寬度和高度。</span><span class="sxs-lookup"><span data-stu-id="d7721-126">The macro positions the animation control in the upper-left corner of the parent window and, if the [**ACS\_CENTER**](animation-control-styles.md) style is not specified, sets the width and height of the control based on the dimensions of a frame in the AVI clip.</span></span> <span data-ttu-id="d7721-127">如果指定了 **ACS \_ 中心** ， **\_ 建立動畫** 會將控制項的寬度和高度設定為零。</span><span class="sxs-lookup"><span data-stu-id="d7721-127">If **ACS\_CENTER** is specified, **Animate\_Create** sets the width and height of the control to zero.</span></span> <span data-ttu-id="d7721-128">您可以使用 [**SetWindowPos**](/windows/desktop/api/winuser/nf-winuser-setwindowpos) 函式來設定控制項的位置和大小。</span><span class="sxs-lookup"><span data-stu-id="d7721-128">You can use the [**SetWindowPos**](/windows/desktop/api/winuser/nf-winuser-setwindowpos) function to set the position and size of the control.</span></span>

<span data-ttu-id="d7721-129">如果您在對話方塊或對話方塊資源內建立動畫控制項，當使用者關閉對話方塊時，控制項會自動終結控制項。</span><span class="sxs-lookup"><span data-stu-id="d7721-129">If you create an animation control within a dialog box or from a dialog box resource, the control is automatically destroyed when the user closes the dialog box.</span></span> <span data-ttu-id="d7721-130">如果您在視窗內建立動畫控制項，則必須明確地終結控制項。</span><span class="sxs-lookup"><span data-stu-id="d7721-130">If you create an animation control within a window, you must explicitly destroy the control.</span></span>

## <a name="about-animation-control-messages"></a><span data-ttu-id="d7721-131">關於動畫控制項訊息</span><span class="sxs-lookup"><span data-stu-id="d7721-131">About Animation Control Messages</span></span>

<span data-ttu-id="d7721-132">應用程式會將訊息傳送至動畫控制項，以開啟、播放、停止及關閉對應的 AVI 剪輯。</span><span class="sxs-lookup"><span data-stu-id="d7721-132">An application sends messages to an animation control to open, play, stop, and close the corresponding AVI clip.</span></span> <span data-ttu-id="d7721-133">每個訊息都有一或多個宏可供您使用，而不是明確地傳送訊息。</span><span class="sxs-lookup"><span data-stu-id="d7721-133">Each message has one or more macros that you can use instead of sending the message explicitly.</span></span>

<span data-ttu-id="d7721-134">建立動畫控制項之後，應用程式會傳送未配置的 [**\_ 開啟**](acm-open.md) 訊息來開啟 AVI 剪輯，並將其載入記憶體中。</span><span class="sxs-lookup"><span data-stu-id="d7721-134">After creating an animation control, an application sends the [**ACM\_OPEN**](acm-open.md) message to open an AVI clip and load it into memory.</span></span> <span data-ttu-id="d7721-135">這則訊息會指定 AVI 檔案的路徑或 AVI 資源的名稱。</span><span class="sxs-lookup"><span data-stu-id="d7721-135">The message specifies either the path of an AVI file or the name of an AVI resource.</span></span> <span data-ttu-id="d7721-136">系統會從建立動畫控制項的模組載入 AVI 資源。</span><span class="sxs-lookup"><span data-stu-id="d7721-136">The system loads the AVI resource from the module that created the animation control.</span></span>

<span data-ttu-id="d7721-137">如果動畫控制項具有 [**ACS \_ 自動播放**](animation-control-styles.md) 樣式，則在開啟 AVI 檔案或 avi 資源之後，控制項會立即開始播放 avi 剪輯。</span><span class="sxs-lookup"><span data-stu-id="d7721-137">If the animation control has the [**ACS\_AUTOPLAY**](animation-control-styles.md) style, the control begins playing the AVI clip immediately after the AVI file or AVI resource is opened.</span></span> <span data-ttu-id="d7721-138">否則，應用程式可以使用「執行中的」 [**\_ 播放**](acm-play.md) 訊息來啟動 AVI 剪輯。</span><span class="sxs-lookup"><span data-stu-id="d7721-138">Otherwise, an application can use the [**ACM\_PLAY**](acm-play.md) message to start the AVI clip.</span></span> <span data-ttu-id="d7721-139">應用程式可以藉由傳送未產生的 [**\_ 停止**](acm-stop.md) 訊息，隨時停止剪輯。</span><span class="sxs-lookup"><span data-stu-id="d7721-139">An application can stop the clip at any time by sending the [**ACM\_STOP**](acm-stop.md) message.</span></span> <span data-ttu-id="d7721-140">當控制項完成播放 AVI 剪輯或傳送 **「完成」 \_ 時，會** 顯示最後播放的畫面格。</span><span class="sxs-lookup"><span data-stu-id="d7721-140">The last frame played remains displayed when the control finishes playing the AVI clip or when **ACM\_STOP** is sent.</span></span>

<span data-ttu-id="d7721-141">動畫控制項可以將兩個通知代碼傳送至其父視窗： [ACN \_ START](acn-start.md) 和 [ACN \_ STOP](acn-stop.md)。</span><span class="sxs-lookup"><span data-stu-id="d7721-141">An animation control can send two notification codes to its parent window: [ACN\_START](acn-start.md) and [ACN\_STOP](acn-stop.md).</span></span> <span data-ttu-id="d7721-142">大部分的應用程式都不會處理任一種通知。</span><span class="sxs-lookup"><span data-stu-id="d7721-142">Most applications do not handle either notification.</span></span>

<span data-ttu-id="d7721-143">若要關閉 AVI 檔案或 AVI 資源，並將它從記憶體中移除，應用程式可以使用「[**動畫 \_ 關閉**](/windows/desktop/api/Commctrl/nf-commctrl-animate_close)」宏，此宏會將檔案名或資源名稱設定為 **Null** 的 [**\_ 開啟狀態**](acm-open.md)傳送給。</span><span class="sxs-lookup"><span data-stu-id="d7721-143">To close the AVI file or AVI resource and remove it from memory, an application can use the [**Animate\_Close**](/windows/desktop/api/Commctrl/nf-commctrl-animate_close) macro, which sends [**ACM\_OPEN**](acm-open.md) with the file name or resource name set to **NULL**.</span></span>

## <a name="default-message-processing"></a><span data-ttu-id="d7721-144">預設訊息處理</span><span class="sxs-lookup"><span data-stu-id="d7721-144">Default Message Processing</span></span>

<span data-ttu-id="d7721-145">本章節描述由 [**動畫 \_ 類別**](common-control-window-classes.md) 視窗類別的視窗程式所處理的視窗訊息。</span><span class="sxs-lookup"><span data-stu-id="d7721-145">This section describes the window messages handled by the window procedure for the [**ANIMATE\_CLASS**](common-control-window-classes.md) window class.</span></span>



| <span data-ttu-id="d7721-146">訊息</span><span class="sxs-lookup"><span data-stu-id="d7721-146">Message</span></span>                                    | <span data-ttu-id="d7721-147">處理已執行</span><span class="sxs-lookup"><span data-stu-id="d7721-147">Processing performed</span></span>                                                                                                                                                                                                                                                                        |
|--------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="d7721-148">**WM \_ 關閉**</span><span class="sxs-lookup"><span data-stu-id="d7721-148">**WM\_CLOSE**</span></span>](/windows/desktop/winmsg/wm-close)           | <span data-ttu-id="d7721-149">釋出與動畫控制項相關聯的 AVI 檔案或 AVI 資源。</span><span class="sxs-lookup"><span data-stu-id="d7721-149">Frees the AVI file or AVI resource associated with the animation control.</span></span>                                                                                                                                                                                                                   |
| [<span data-ttu-id="d7721-150">**WM 損 \_ 毀**</span><span class="sxs-lookup"><span data-stu-id="d7721-150">**WM\_DESTROY**</span></span>](/windows/desktop/winmsg/wm-destroy)       | <span data-ttu-id="d7721-151">釋放 AVI 檔案或 AVI 資源、釋放內部資料結構，然後呼叫 [**DefWindowProc**](/windows/desktop/api/winuser/nf-winuser-defwindowproca) 函數。</span><span class="sxs-lookup"><span data-stu-id="d7721-151">Frees the AVI file or AVI resource, frees an internal data structure, and then calls the [**DefWindowProc**](/windows/desktop/api/winuser/nf-winuser-defwindowproca) function.</span></span>                                                                                                                                                |
| [<span data-ttu-id="d7721-152">**WM \_ ERASEBKGND**</span><span class="sxs-lookup"><span data-stu-id="d7721-152">**WM\_ERASEBKGND**</span></span>](/windows/desktop/winmsg/wm-erasebkgnd) | <span data-ttu-id="d7721-153">使用靜態控制項目前的背景色彩來清除視窗背景。</span><span class="sxs-lookup"><span data-stu-id="d7721-153">Erases the window background using the current background color for static controls.</span></span>                                                                                                                                                                                                        |
| [<span data-ttu-id="d7721-154">**WM \_ NCCREATE**</span><span class="sxs-lookup"><span data-stu-id="d7721-154">**WM\_NCCREATE**</span></span>](/windows/desktop/winmsg/wm-nccreate)     | <span data-ttu-id="d7721-155">配置並初始化內部資料結構，然後呼叫 [**DefWindowProc**](/windows/desktop/api/winuser/nf-winuser-defwindowproca)。</span><span class="sxs-lookup"><span data-stu-id="d7721-155">Allocates and initializes an internal data structure and then calls [**DefWindowProc**](/windows/desktop/api/winuser/nf-winuser-defwindowproca).</span></span>                                                                                                                                                                              |
| [<span data-ttu-id="d7721-156">**WM \_ NCHITTEST**</span><span class="sxs-lookup"><span data-stu-id="d7721-156">**WM\_NCHITTEST**</span></span>](/windows/desktop/inputdev/wm-nchittest) | <span data-ttu-id="d7721-157">傳回 HTTRANSPARENT 點擊測試值。</span><span class="sxs-lookup"><span data-stu-id="d7721-157">Returns the HTTRANSPARENT hit test value.</span></span>                                                                                                                                                                                                                                                   |
| [<span data-ttu-id="d7721-158">**WM \_ 油漆**</span><span class="sxs-lookup"><span data-stu-id="d7721-158">**WM\_PAINT**</span></span>](/windows/desktop/gdi/wm-paint)              | <span data-ttu-id="d7721-159">在動畫控制項中繪製 AVI 框架。</span><span class="sxs-lookup"><span data-stu-id="d7721-159">Draws an AVI frame in the animation control.</span></span>                                                                                                                                                                                                                                                |
| [<span data-ttu-id="d7721-160">**WM \_ 大小**</span><span class="sxs-lookup"><span data-stu-id="d7721-160">**WM\_SIZE**</span></span>](/windows/desktop/winmsg/wm-size)             | <span data-ttu-id="d7721-161">檢查控制項是否具有 [**ACS \_ 中心**](animation-control-styles.md) 樣式。</span><span class="sxs-lookup"><span data-stu-id="d7721-161">Checks if the control has the [**ACS\_CENTER**](animation-control-styles.md) style.</span></span> <span data-ttu-id="d7721-162">如果控制項不存在，就會呼叫 [**DefWindowProc**](/windows/desktop/api/winuser/nf-winuser-defwindowproca)。</span><span class="sxs-lookup"><span data-stu-id="d7721-162">If the control does not, it calls [**DefWindowProc**](/windows/desktop/api/winuser/nf-winuser-defwindowproca).</span></span> <span data-ttu-id="d7721-163">否則，它會將動畫放在控制項中，使控制項失效，然後呼叫 **DefWindowProc**。</span><span class="sxs-lookup"><span data-stu-id="d7721-163">Otherwise, it centers the animation in the control, invalidates the control, and then calls **DefWindowProc**.</span></span> |



 

 

 