---
title: 關於工具提示控制項
description: 當使用者將滑鼠指標暫停在工具或其他 UI 元素上方時，工具提示會自動出現或快顯。
ms.assetid: 1020cec7-57b4-4463-9419-f80fd14fa12c
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e9c1042523c86e794865da5d38fb023ee37d60b4
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/21/2020
ms.locfileid: "104024173"
---
# <a name="about-tooltip-controls"></a><span data-ttu-id="92093-103">關於工具提示控制項</span><span class="sxs-lookup"><span data-stu-id="92093-103">About Tooltip Controls</span></span>

<span data-ttu-id="92093-104">當使用者將滑鼠指標暫停在工具或其他 UI 元素上方時，工具提示會自動出現或快顯。</span><span class="sxs-lookup"><span data-stu-id="92093-104">Tooltips appear automatically, or pop up, when the user pauses the mouse pointer over a tool or some other UI element.</span></span> <span data-ttu-id="92093-105">工具提示會出現在指標附近，並在使用者按一下滑鼠按鍵時消失、將指標移離工具，或只是等候幾秒鐘。</span><span class="sxs-lookup"><span data-stu-id="92093-105">The tooltip appears near the pointer and disappears when the user clicks a mouse button, moves the pointer away from the tool, or simply waits for a few seconds.</span></span>

<span data-ttu-id="92093-106">下圖中的工具提示控制項顯示 Windows 桌面上檔案的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="92093-106">The tooltip control in the following illustration displays information about a file on the Windows desktop.</span></span> <span data-ttu-id="92093-107">當您將滑鼠移到圖上時，您也應該會看到包含描述性文字的即時工具提示。</span><span class="sxs-lookup"><span data-stu-id="92093-107">As you move the mouse over the illustration, you should also see a live tooltip that contains descriptive text.</span></span>

![顯示工具提示中顯示在桌面上的檔案之文字的螢幕擷取畫面](images/tt-desktop.png)

<span data-ttu-id="92093-109">本節說明工具提示控制項的運作方式，以及如何建立。</span><span class="sxs-lookup"><span data-stu-id="92093-109">This section describes how tooltip controls work and how you create them.</span></span>

-   [<span data-ttu-id="92093-110">工具提示行為和外觀</span><span class="sxs-lookup"><span data-stu-id="92093-110">Tooltip Behavior and Appearance</span></span>](#tooltip-behavior-and-appearance)
-   [<span data-ttu-id="92093-111">建立工具提示控制項</span><span class="sxs-lookup"><span data-stu-id="92093-111">Creating Tooltip Controls</span></span>](#creating-tooltip-controls)
-   [<span data-ttu-id="92093-112">啟用工具提示控制項</span><span class="sxs-lookup"><span data-stu-id="92093-112">Activating Tooltip Controls</span></span>](#activating-tooltip-controls)
-   [<span data-ttu-id="92093-113">支援工具</span><span class="sxs-lookup"><span data-stu-id="92093-113">Supporting Tools</span></span>](#supporting-tools)
-   [<span data-ttu-id="92093-114">顯示文字</span><span class="sxs-lookup"><span data-stu-id="92093-114">Displaying Text</span></span>](#displaying-text)
-   [<span data-ttu-id="92093-115">訊息與通知</span><span class="sxs-lookup"><span data-stu-id="92093-115">Messaging and Notification</span></span>](#messaging-and-notification)
-   [<span data-ttu-id="92093-116">點擊測試</span><span class="sxs-lookup"><span data-stu-id="92093-116">Hit Testing</span></span>](#hit-testing)
-   [<span data-ttu-id="92093-117">預設訊息處理</span><span class="sxs-lookup"><span data-stu-id="92093-117">Default Message Processing</span></span>](#default-message-processing)

## <a name="tooltip-behavior-and-appearance"></a><span data-ttu-id="92093-118">工具提示行為和外觀</span><span class="sxs-lookup"><span data-stu-id="92093-118">Tooltip Behavior and Appearance</span></span>

<span data-ttu-id="92093-119">工具提示控制項可以顯示一行或多行文字。</span><span class="sxs-lookup"><span data-stu-id="92093-119">Tooltip controls can display a single line of text or multiple lines.</span></span> <span data-ttu-id="92093-120">它們的角落可以是圓角或方形。</span><span class="sxs-lookup"><span data-stu-id="92093-120">Their corners can be rounded or square.</span></span> <span data-ttu-id="92093-121">它們不一定會有指向像是卡通語音球的工具。</span><span class="sxs-lookup"><span data-stu-id="92093-121">They might or might not have a stem that points to the tools like a cartoon speech balloon.</span></span> <span data-ttu-id="92093-122">工具提示文字可以是固定的，也可以使用滑鼠指標（稱為「追蹤」）移動。</span><span class="sxs-lookup"><span data-stu-id="92093-122">Tooltip text can be stationary or can move with the mouse pointer, called tracking.</span></span> <span data-ttu-id="92093-123">靜止文字可以顯示在工具的旁邊，也可以透過工具（稱為就地）來顯示。</span><span class="sxs-lookup"><span data-stu-id="92093-123">Stationary text can be displayed adjacent to a tool or it can be displayed over a tool, which is referred to as in-place.</span></span> <span data-ttu-id="92093-124">標準工具提示為固定、顯示單一文字、具有方形邊角，而且沒有指向工具的主幹。</span><span class="sxs-lookup"><span data-stu-id="92093-124">Standard tooltips are stationary, display a single line of text, have square corners, and have no stem pointing to the tool.</span></span>

<span data-ttu-id="92093-125">[版本 4.70](common-control-versions.md)的通用控制項支援的追蹤工具提示，會動態變更螢幕上的位置。</span><span class="sxs-lookup"><span data-stu-id="92093-125">Tracking tooltips, which are supported by [version 4.70](common-control-versions.md) of the common controls, change position on the screen dynamically.</span></span> <span data-ttu-id="92093-126">藉由快速更新位置，這些工具提示控制項看似可順暢地移動或「追蹤」。</span><span class="sxs-lookup"><span data-stu-id="92093-126">By rapidly updating the position, these tooltip controls appear to move smoothly, or "track."</span></span> <span data-ttu-id="92093-127">當您想要工具提示文字移動時，當滑鼠指標的位置遵循時，這些功能就很有用。</span><span class="sxs-lookup"><span data-stu-id="92093-127">These are useful when you want tooltip text to follow the position of the mouse pointer as it moves.</span></span> <span data-ttu-id="92093-128">如需追蹤工具提示的詳細資訊，以及顯示如何建立程式碼的範例，請參閱 [追蹤工具提示](using-tooltip-contro.md)。</span><span class="sxs-lookup"><span data-stu-id="92093-128">For more information about tracking tooltips and an example with code that shows how you create them, see [Tracking Tooltips](using-tooltip-contro.md).</span></span>

<span data-ttu-id="92093-129">多行工具提示（共4.70 版的通用控制項也支援）會將文字顯示在一行以上。</span><span class="sxs-lookup"><span data-stu-id="92093-129">Multiline tooltips, which are also supported by version 4.70 of the common controls, display text on more than one line.</span></span> <span data-ttu-id="92093-130">這些很適合用來顯示冗長的訊息。</span><span class="sxs-lookup"><span data-stu-id="92093-130">These are useful for displaying lengthy messages.</span></span> <span data-ttu-id="92093-131">如需詳細資訊和示範如何建立多行工具提示的範例，請參閱 [多行工具提示](using-tooltip-contro.md)。</span><span class="sxs-lookup"><span data-stu-id="92093-131">For more information and an example that shows how to create multiline tooltips, see [Multiline Tooltips](using-tooltip-contro.md).</span></span>

<span data-ttu-id="92093-132">氣球工具提示會顯示在具有圓角的方塊和指向工具的主幹中。</span><span class="sxs-lookup"><span data-stu-id="92093-132">Balloon tooltips are displayed in a box with rounded corners and a stem pointing to the tool.</span></span> <span data-ttu-id="92093-133">它們可以是單行或多行。</span><span class="sxs-lookup"><span data-stu-id="92093-133">They can be either single-line or multiline.</span></span> <span data-ttu-id="92093-134">下圖顯示在其預設位置中有詞幹和矩形的氣球工具提示。</span><span class="sxs-lookup"><span data-stu-id="92093-134">The following illustration shows a balloon tooltip with the stem and rectangle in their default positions.</span></span> <span data-ttu-id="92093-135">如需氣球工具提示的詳細資訊，以及示範如何建立它們的範例，請參閱 [使用工具提示控制項](using-tooltip-contro.md)。</span><span class="sxs-lookup"><span data-stu-id="92093-135">For more information about balloon tooltips and an example that shows how to create them, see [Using Tooltip Controls](using-tooltip-contro.md).</span></span>

![顯示工具提示的螢幕擷取畫面，其中包含一行文字，位於對話方塊的按鈕上方](images/tt-balloon.png)

<span data-ttu-id="92093-137">工具提示也可以有標題文字和圖示，如下圖所示。</span><span class="sxs-lookup"><span data-stu-id="92093-137">A tooltip can also have title text and an icon, as shown in the following illustration.</span></span> <span data-ttu-id="92093-138">請注意，工具提示必須有文字;如果只有標題文字，則不會顯示工具提示。</span><span class="sxs-lookup"><span data-stu-id="92093-138">Note that the tooltip must have text; if it has only title text, the tooltip does not display.</span></span> <span data-ttu-id="92093-139">此外，除非有標題，否則不會出現圖示。</span><span class="sxs-lookup"><span data-stu-id="92093-139">Also the icon does not appear unless there is a title.</span></span>

![顯示工具提示圖示、標題和文字的螢幕擷取畫面，其位於對話方塊的按鈕下方](images/tt-titled.png)

<span data-ttu-id="92093-141">有時候文字字串會被裁剪，因為它們太長，無法完全顯示在小視窗中。</span><span class="sxs-lookup"><span data-stu-id="92093-141">Sometimes text strings are clipped because they are too long to be displayed completely in a small window.</span></span> <span data-ttu-id="92093-142">就地工具提示會用來顯示已裁剪之物件的文字字串，例如下圖中的檔案名。</span><span class="sxs-lookup"><span data-stu-id="92093-142">In-place tooltips are used to display text strings for objects that have been clipped, such as the file name in the following illustration.</span></span> <span data-ttu-id="92093-143">如需示範如何建立就地工具提示的範例，請參閱就地 [工具提示](using-tooltip-contro.md)。</span><span class="sxs-lookup"><span data-stu-id="92093-143">For an example that shows how to create in-place tooltips, see [In-Place Tooltips](using-tooltip-contro.md).</span></span>

![顯示工具提示的螢幕擷取畫面，其中包含位於樹狀目錄控制項中檔案圖示旁邊的檔案名](images/tt-inplace.png)

<span data-ttu-id="92093-145">游標必須停留在工具上一段時間，才會顯示工具提示。</span><span class="sxs-lookup"><span data-stu-id="92093-145">The cursor must hover over a tool for a period of time before the tooltip is displayed.</span></span> <span data-ttu-id="92093-146">此超時的預設持續時間是由使用者的按兩下時間來控制，通常約為半秒。</span><span class="sxs-lookup"><span data-stu-id="92093-146">The default duration of this timeout is controlled by the user's double click time and is typically about one-half second.</span></span> <span data-ttu-id="92093-147">若要指定非預設的超時值，請將 [**TTM \_ SETDELAYTIME**](ttm-setdelaytime.md) 訊息傳送給工具提示控制項。</span><span class="sxs-lookup"><span data-stu-id="92093-147">To specify a non-default timeout value, send the tooltip control a [**TTM\_SETDELAYTIME**](ttm-setdelaytime.md) message.</span></span>

## <a name="creating-tooltip-controls"></a><span data-ttu-id="92093-148">建立工具提示控制項</span><span class="sxs-lookup"><span data-stu-id="92093-148">Creating Tooltip Controls</span></span>

<span data-ttu-id="92093-149">若要建立工具提示控制項，請呼叫 [**CreateWindowEx**](/windows/desktop/api/winuser/nf-winuser-createwindowexa) 並指定 [**工具提示 \_ 類別**](common-control-window-classes.md) 視窗類別。</span><span class="sxs-lookup"><span data-stu-id="92093-149">To create a tooltip control, call [**CreateWindowEx**](/windows/desktop/api/winuser/nf-winuser-createwindowexa) and specify the [**TOOLTIPS\_CLASS**](common-control-window-classes.md) window class.</span></span> <span data-ttu-id="92093-150">載入通用控制項 DLL 時，會註冊這個類別。</span><span class="sxs-lookup"><span data-stu-id="92093-150">This class is registered when the common control DLL is loaded.</span></span> <span data-ttu-id="92093-151">若要確定已載入此 DLL，請在您的應用程式中包含 [**InitCommonControlsEx**](/windows/desktop/api/Commctrl/nf-commctrl-initcommoncontrolsex) 函式。</span><span class="sxs-lookup"><span data-stu-id="92093-151">To ensure that this DLL is loaded, include the [**InitCommonControlsEx**](/windows/desktop/api/Commctrl/nf-commctrl-initcommoncontrolsex) function in your application.</span></span> <span data-ttu-id="92093-152">您必須將工具提示控制項明確定義為最上層。</span><span class="sxs-lookup"><span data-stu-id="92093-152">You must explicitly define a tooltip control as topmost.</span></span> <span data-ttu-id="92093-153">否則，它可能會包含在父視窗中。</span><span class="sxs-lookup"><span data-stu-id="92093-153">Otherwise, it might be covered by the parent window.</span></span> <span data-ttu-id="92093-154">下列程式碼片段顯示如何建立工具提示控制項。</span><span class="sxs-lookup"><span data-stu-id="92093-154">The following code fragment shows how to create a tooltip control.</span></span>


```
HWND hwndTip = CreateWindowEx(NULL, TOOLTIPS_CLASS, NULL,
                            WS_POPUP | TTS_NOPREFIX | TTS_ALWAYSTIP,
                            CW_USEDEFAULT, CW_USEDEFAULT,
                            CW_USEDEFAULT, CW_USEDEFAULT,
                            hwndParent, NULL, hinstMyDll,
                            NULL);

SetWindowPos(hwndTip, HWND_TOPMOST,0, 0, 0, 0,
             SWP_NOMOVE | SWP_NOSIZE | SWP_NOACTIVATE);
```



<span data-ttu-id="92093-155">工具提示控制項的視窗程式會自動設定控制項的大小、位置和可見度。</span><span class="sxs-lookup"><span data-stu-id="92093-155">The window procedure for the tooltip control automatically sets the size, position, and visibility of the control.</span></span> <span data-ttu-id="92093-156">工具提示視窗的高度是以目前在工具提示控制項的裝置內容中所選取字型的高度為基礎。</span><span class="sxs-lookup"><span data-stu-id="92093-156">The height of the tooltip window is based on the height of the font currently selected into the device context for the tooltip control.</span></span> <span data-ttu-id="92093-157">寬度會根據目前在工具提示視窗中的字串長度而有所不同。</span><span class="sxs-lookup"><span data-stu-id="92093-157">The width varies based on the length of the string currently in the tooltip window.</span></span>

## <a name="activating-tooltip-controls"></a><span data-ttu-id="92093-158">啟用工具提示控制項</span><span class="sxs-lookup"><span data-stu-id="92093-158">Activating Tooltip Controls</span></span>

<span data-ttu-id="92093-159">工具提示控制項可以是作用中或非作用中。</span><span class="sxs-lookup"><span data-stu-id="92093-159">A tooltip control can be either active or inactive.</span></span> <span data-ttu-id="92093-160">當使用中時，當滑鼠指標位於工具上時，就會顯示工具提示文字。</span><span class="sxs-lookup"><span data-stu-id="92093-160">When it is active, the tooltip text appears when the mouse pointer is on a tool.</span></span> <span data-ttu-id="92093-161">當它處於非使用中狀態時，即使指標在工具上，也不會出現工具提示文字。</span><span class="sxs-lookup"><span data-stu-id="92093-161">When it is inactive, the tooltip text does not appear, even if the pointer is on a tool.</span></span> <span data-ttu-id="92093-162">[**TTM \_ 啟動**](ttm-activate.md)訊息會啟用並停用工具提示控制項。</span><span class="sxs-lookup"><span data-stu-id="92093-162">The [**TTM\_ACTIVATE**](ttm-activate.md) message activates and deactivates a tooltip control.</span></span>

## <a name="supporting-tools"></a><span data-ttu-id="92093-163">支援工具</span><span class="sxs-lookup"><span data-stu-id="92093-163">Supporting Tools</span></span>

<span data-ttu-id="92093-164">工具提示控制項可支援任意數目的工具。</span><span class="sxs-lookup"><span data-stu-id="92093-164">A tooltip control can support any number of tools.</span></span> <span data-ttu-id="92093-165">若要支援特定的工具，您必須透過將 [**TTM \_ ADDTOOL**](ttm-addtool.md) 訊息傳送給控制項，向工具提示控制項註冊工具。</span><span class="sxs-lookup"><span data-stu-id="92093-165">To support a particular tool, you must register the tool with the tooltip control by sending the control the [**TTM\_ADDTOOL**](ttm-addtool.md) message.</span></span> <span data-ttu-id="92093-166">訊息包含 [**TOOLINFO**](/windows/win32/api/commctrl/ns-commctrl-tttoolinfoa) 結構的位址，其提供工具提示控制項顯示工具文字所需的資訊。</span><span class="sxs-lookup"><span data-stu-id="92093-166">The message includes the address of a [**TOOLINFO**](/windows/win32/api/commctrl/ns-commctrl-tttoolinfoa) structure, which provides information the tooltip control needs to display text for the tool.</span></span> <span data-ttu-id="92093-167">**TOOLINFO** 結構的 **uID** 成員是由應用程式所定義。</span><span class="sxs-lookup"><span data-stu-id="92093-167">The **uID** member of the **TOOLINFO** structure is defined by the application.</span></span> <span data-ttu-id="92093-168">每次加入工具時，您的應用程式都會提供唯一的識別碼。</span><span class="sxs-lookup"><span data-stu-id="92093-168">Each time you add a tool, your application provides a unique identifier.</span></span> <span data-ttu-id="92093-169">**TOOLINFO** 結構的 **cbSize** 成員是必要的，而且必須指定結構的大小。</span><span class="sxs-lookup"><span data-stu-id="92093-169">The **cbSize** member of the **TOOLINFO** structure is required, and must specify the size of the structure.</span></span>

<span data-ttu-id="92093-170">工具提示控制項支援實作為 windows (的工具，例如子視窗或控制 windows) ，以及視窗工作區中的矩形區域。</span><span class="sxs-lookup"><span data-stu-id="92093-170">A tooltip control supports tools implemented as windows (such as child windows or control windows) and as rectangular areas within a window's client area.</span></span> <span data-ttu-id="92093-171">當您加入實作為矩形區域的工具時， [**TOOLINFO**](/windows/win32/api/commctrl/ns-commctrl-tttoolinfoa)結構的 **hwnd** 成員必須指定包含該區域之視窗的控制碼，而 **rect** 成員必須指定區域周框矩形的用戶端座標。</span><span class="sxs-lookup"><span data-stu-id="92093-171">When you add a tool implemented as a rectangular area, the **hwnd** member of the [**TOOLINFO**](/windows/win32/api/commctrl/ns-commctrl-tttoolinfoa) structure must specify the handle to the window that contains the area, and the **rect** member must specify the client coordinates of the area's bounding rectangle.</span></span> <span data-ttu-id="92093-172">此外， **uID** 成員必須為工具指定應用程式定義的識別碼。</span><span class="sxs-lookup"><span data-stu-id="92093-172">In addition, the **uID** member must specify the application-defined identifier for the tool.</span></span>

<span data-ttu-id="92093-173">當您加入實作為視窗的工具時， [**TOOLINFO**](/windows/win32/api/commctrl/ns-commctrl-tttoolinfoa)結構的 **uID** 成員必須包含工具的視窗控制碼。</span><span class="sxs-lookup"><span data-stu-id="92093-173">When you add a tool implemented as a window, the **uID** member of the [**TOOLINFO**](/windows/win32/api/commctrl/ns-commctrl-tttoolinfoa) structure must contain the window handle to the tool.</span></span> <span data-ttu-id="92093-174">此外， **uFlags** 成員還必須指定 **TTF \_ IDISHWND** 值，告知工具提示控制項將 **uID** 成員解讀為視窗控制碼。</span><span class="sxs-lookup"><span data-stu-id="92093-174">Also, the **uFlags** member must specify the **TTF\_IDISHWND** value, which tells the tooltip control to interpret the **uID** member as a window handle.</span></span>

## <a name="displaying-text"></a><span data-ttu-id="92093-175">顯示文字</span><span class="sxs-lookup"><span data-stu-id="92093-175">Displaying Text</span></span>

<span data-ttu-id="92093-176">當您將工具加入至工具提示控制項時， [**TOOLINFO**](/windows/win32/api/commctrl/ns-commctrl-tttoolinfoa)結構的 **lpszText** 成員必須指定要顯示給工具的字串位址。</span><span class="sxs-lookup"><span data-stu-id="92093-176">When you add a tool to a tooltip control, the **lpszText** member of the [**TOOLINFO**](/windows/win32/api/commctrl/ns-commctrl-tttoolinfoa) structure must specify the address of the string to display for the tool.</span></span> <span data-ttu-id="92093-177">新增工具之後，您可以使用 [**TTM \_ UPDATETIPTEXT**](ttm-updatetiptext.md) 訊息來變更文字。</span><span class="sxs-lookup"><span data-stu-id="92093-177">After you add a tool, you can change the text using the [**TTM\_UPDATETIPTEXT**](ttm-updatetiptext.md) message.</span></span>

<span data-ttu-id="92093-178">如果 **lpszText** 的高序位字是零，則低序位字必須是字串資源的識別碼。</span><span class="sxs-lookup"><span data-stu-id="92093-178">If the high-order word of **lpszText** is zero, the low-order word must be the identifier of a string resource.</span></span> <span data-ttu-id="92093-179">當工具提示控制項需要文字時，系統會從 [**TOOLINFO**](/windows/win32/api/commctrl/ns-commctrl-tttoolinfoa)結構的 **hinst** 成員所識別的應用程式實例載入指定的字串資源。</span><span class="sxs-lookup"><span data-stu-id="92093-179">When the tooltip control needs the text, the system loads the specified string resource from the application instance identified by the **hinst** member of the [**TOOLINFO**](/windows/win32/api/commctrl/ns-commctrl-tttoolinfoa) structure.</span></span>

<span data-ttu-id="92093-180">如果您 \_ 在 **lpszText** 成員中指定 LPSTR TEXTCALLBACK 值，每當工具提示控制項需要顯示工具的文字時，工具提示控制項就會通知 [**TOOLINFO**](/windows/win32/api/commctrl/ns-commctrl-tttoolinfoa)結構的 **hwnd** 成員中指定的視窗。</span><span class="sxs-lookup"><span data-stu-id="92093-180">If you specify the LPSTR\_TEXTCALLBACK value in the **lpszText** member, the tooltip control notifies the window specified in the **hwnd** member of the [**TOOLINFO**](/windows/win32/api/commctrl/ns-commctrl-tttoolinfoa)structure whenever the tooltip control needs to display text for the tool.</span></span> <span data-ttu-id="92093-181">工具提示控制項會將 [TTN \_ GETDISPINFO](ttn-getdispinfo.md) 通知程式碼傳送至視窗。</span><span class="sxs-lookup"><span data-stu-id="92093-181">The tooltip control sends the [TTN\_GETDISPINFO](ttn-getdispinfo.md) notification code to the window.</span></span> <span data-ttu-id="92093-182">訊息包含 [**NMTTDISPINFO**](/windows/win32/api/commctrl/ns-commctrl-nmttdispinfoa) 結構的位址，其中包含視窗控制碼以及工具的應用程式定義識別碼。</span><span class="sxs-lookup"><span data-stu-id="92093-182">The message includes the address of a [**NMTTDISPINFO**](/windows/win32/api/commctrl/ns-commctrl-nmttdispinfoa) structure, which contains the window handle as well as the application-defined identifier for the tool.</span></span> <span data-ttu-id="92093-183">此視窗會檢查結構，以判斷需要文字的工具，並使用工具提示控制項所需的資訊來填滿適當的結構成員，以便顯示字串。</span><span class="sxs-lookup"><span data-stu-id="92093-183">The window examines the structure to determine the tool for which text is needed, and it fills the appropriate structure members with information that the tooltip control needs in order to display the string.</span></span>

> [!Note]  
> <span data-ttu-id="92093-184">標準工具提示文字的最大長度是80個字元。</span><span class="sxs-lookup"><span data-stu-id="92093-184">The maximum length for standard tooltip text is 80 characters.</span></span> <span data-ttu-id="92093-185">如需詳細資訊，請參閱 [**NMTTDISPINFO**](/windows/win32/api/commctrl/ns-commctrl-nmttdispinfoa) 結構。</span><span class="sxs-lookup"><span data-stu-id="92093-185">For more information, see the [**NMTTDISPINFO**](/windows/win32/api/commctrl/ns-commctrl-nmttdispinfoa) structure.</span></span> <span data-ttu-id="92093-186">多行工具提示文字可能較長。</span><span class="sxs-lookup"><span data-stu-id="92093-186">Multiline tooltip text can be longer.</span></span>

 

<span data-ttu-id="92093-187">許多應用程式會建立包含對應至功能表命令之工具的工具列。</span><span class="sxs-lookup"><span data-stu-id="92093-187">Many applications create toolbars containing tools that correspond to menu commands.</span></span> <span data-ttu-id="92093-188">針對這類工具，工具提示控制項顯示與對應功能表項目相同的文字是很方便的。</span><span class="sxs-lookup"><span data-stu-id="92093-188">For such tools, it is convenient for the tooltip control to display the same text as the corresponding menu item.</span></span> <span data-ttu-id="92093-189">系統會自動從所有傳遞給工具提示控制項的字串中移除連字號 (&) 快速鍵字元， \\ 除非控制項有 [**TTS \_ NOPREFIX**](tooltip-styles.md) 樣式，否則會在第一個索引標籤字元 (t) 上結束字串。</span><span class="sxs-lookup"><span data-stu-id="92093-189">The system automatically strips the ampersand (&) accelerator characters from all strings passed to a tooltip control, and terminates the string at the first tab character (\\t), unless the control has the [**TTS\_NOPREFIX**](tooltip-styles.md) style.</span></span>

<span data-ttu-id="92093-190">若要取出工具的文字，請使用 [**TTM \_ GETTEXT**](ttm-gettext.md) 訊息。</span><span class="sxs-lookup"><span data-stu-id="92093-190">To retrieve the text for a tool, use the [**TTM\_GETTEXT**](ttm-gettext.md) message.</span></span>

## <a name="messaging-and-notification"></a><span data-ttu-id="92093-191">訊息與通知</span><span class="sxs-lookup"><span data-stu-id="92093-191">Messaging and Notification</span></span>

<span data-ttu-id="92093-192">當滑鼠指標停留在區域上時，通常會顯示工具提示文字，通常是由按鈕控制項等工具所定義的矩形。</span><span class="sxs-lookup"><span data-stu-id="92093-192">Tooltip text is normally displayed when the mouse pointer hovers over an area, typically the rectangle defined by a tool such as a button control.</span></span> <span data-ttu-id="92093-193">不過，Microsoft Windows 只會將滑鼠相關的訊息傳送至包含指標的視窗，而不是工具提示控制項本身。</span><span class="sxs-lookup"><span data-stu-id="92093-193">However, Microsoft Windows only sends mouse-related messages to the window that contains the pointer, not the tooltip control itself.</span></span> <span data-ttu-id="92093-194">滑鼠相關資訊必須轉送至工具提示控制項，才能讓它在適當的時間和位置顯示工具提示文字。</span><span class="sxs-lookup"><span data-stu-id="92093-194">Mouse-related information must be relayed to the tooltip control in order for it to display the tooltip text at the appropriate time and place.</span></span>

<span data-ttu-id="92093-195">如果有下列情況，您就可以自動轉送訊息：</span><span class="sxs-lookup"><span data-stu-id="92093-195">You can have messages relayed automatically if:</span></span>

-   <span data-ttu-id="92093-196">此工具是一個控制項，或定義為工具 [**TOOLINFO**](/windows/win32/api/commctrl/ns-commctrl-tttoolinfoa) 結構中的矩形。</span><span class="sxs-lookup"><span data-stu-id="92093-196">The tool is a control or is defined as a rectangle in the tool's [**TOOLINFO**](/windows/win32/api/commctrl/ns-commctrl-tttoolinfoa) structure.</span></span>
-   <span data-ttu-id="92093-197">與工具相關聯的視窗會在與工具提示控制項相同的執行緒中。</span><span class="sxs-lookup"><span data-stu-id="92093-197">The window associated with the tool is in the same thread as the tooltip control.</span></span>

<span data-ttu-id="92093-198">如果符合這兩個條件，當您使用 [**TTM \_ ADDTOOL**](ttm-addtool.md)將工具新增至工具提示控制項時，請在工具 [**TOOLINFO**](/windows/win32/api/commctrl/ns-commctrl-tttoolinfoa)結構的 **uFlags** 成員中設定 **TTF 子 \_ 類別** 旗標。</span><span class="sxs-lookup"><span data-stu-id="92093-198">If these two conditions are met, set the **TTF\_SUBCLASS** flag in the **uFlags** member of the tool's [**TOOLINFO**](/windows/win32/api/commctrl/ns-commctrl-tttoolinfoa) structure when you add the tool to the tooltip control with [**TTM\_ADDTOOL**](ttm-addtool.md).</span></span> <span data-ttu-id="92093-199">必要的滑鼠訊息會自動轉送至工具提示控制項。</span><span class="sxs-lookup"><span data-stu-id="92093-199">The necessary mouse messages then will be relayed automatically to the tooltip control.</span></span>

<span data-ttu-id="92093-200">設定 **TTF 子 \_ 類別** ，以將滑鼠訊息轉送至控制項，對於大多數用途都已足夠。</span><span class="sxs-lookup"><span data-stu-id="92093-200">Setting **TTF\_SUBCLASS** to have mouse messages relayed to the control is sufficient for most purposes.</span></span> <span data-ttu-id="92093-201">不過，在工具提示控制項和工具視窗之間沒有直接連接的情況下，它將無法運作。</span><span class="sxs-lookup"><span data-stu-id="92093-201">However, it will not work in cases where there is no direct connection between the tooltip control and the tool's window.</span></span> <span data-ttu-id="92093-202">例如，如果在應用程式定義的視窗中將工具實作為矩形區域，則視窗程式會收到滑鼠訊息。</span><span class="sxs-lookup"><span data-stu-id="92093-202">For example, if a tool is implemented as a rectangular area in an application-defined window, the window procedure receives the mouse messages.</span></span> <span data-ttu-id="92093-203">設定 **TTF 子 \_ 類別** 就足以確保將它們傳遞給控制項。</span><span class="sxs-lookup"><span data-stu-id="92093-203">Setting **TTF\_SUBCLASS** is sufficient to ensure that they are passed to the control.</span></span> <span data-ttu-id="92093-204">但是，如果工具是實作為系統定義的視窗，則會將滑鼠訊息傳送至該視窗，且不會直接提供給應用程式使用。</span><span class="sxs-lookup"><span data-stu-id="92093-204">However, if a tool is implemented as a system-defined window, mouse messages are sent to that window and are not directly available to the application.</span></span> <span data-ttu-id="92093-205">在此情況下，您必須將視窗子類別化或使用訊息攔截來存取滑鼠訊息。</span><span class="sxs-lookup"><span data-stu-id="92093-205">In this case, you must either subclass the window or use a message hook to access the mouse messages.</span></span> <span data-ttu-id="92093-206">然後，您必須使用 [**TTM \_ RELAYEVENT**](ttm-relayevent.md)，將滑鼠訊息明確地轉送至工具提示控制項。</span><span class="sxs-lookup"><span data-stu-id="92093-206">You must then explicitly relay mouse messages to the tooltip control with [**TTM\_RELAYEVENT**](ttm-relayevent.md).</span></span> <span data-ttu-id="92093-207">如需如何使用 **TTM \_ RELAYEVENT** 的範例，請參閱 [追蹤工具提示](using-tooltip-contro.md)。</span><span class="sxs-lookup"><span data-stu-id="92093-207">For an example of how to use **TTM\_RELAYEVENT**, see [Tracking Tooltips](using-tooltip-contro.md).</span></span>

<span data-ttu-id="92093-208">當工具提示控制項收到 [**WM \_ MOUSEMOVE**](/windows/desktop/inputdev/wm-mousemove) 訊息時，它會判斷滑鼠指標是否在工具的周框中。</span><span class="sxs-lookup"><span data-stu-id="92093-208">When a tooltip control receives a [**WM\_MOUSEMOVE**](/windows/desktop/inputdev/wm-mousemove) message, it determines whether the mouse pointer is in the bounding rectangle of a tool.</span></span> <span data-ttu-id="92093-209">如果是，則工具提示控制項會設定計時器。</span><span class="sxs-lookup"><span data-stu-id="92093-209">If it is, the tooltip control sets a timer.</span></span> <span data-ttu-id="92093-210">在逾時間隔結束時，工具提示控制項會檢查指標的位置，以查看是否已移動指標。</span><span class="sxs-lookup"><span data-stu-id="92093-210">At the end of the time-out interval, the tooltip control checks the position of the pointer to see if it has moved.</span></span> <span data-ttu-id="92093-211">如果沒有，工具提示控制項會抓取工具的文字，並顯示工具提示。</span><span class="sxs-lookup"><span data-stu-id="92093-211">If it hasn't, the tooltip control retrieves the text for the tool and displays the tooltip.</span></span> <span data-ttu-id="92093-212">工具提示控制項會繼續顯示視窗，直到它收到轉送的按鈕或按鈕下的訊息，或直到 **WM \_ MOUSEMOVE** 訊息指出指標已移至工具的周框以外的範圍。</span><span class="sxs-lookup"><span data-stu-id="92093-212">The tooltip control continues to show the window until it receives a relayed button-up or button-down message or until a **WM\_MOUSEMOVE** message indicates that the pointer has moved outside the bounding rectangle of the tool.</span></span>

<span data-ttu-id="92093-213">工具提示控制項實際上有三個相關聯的時間持續時間。</span><span class="sxs-lookup"><span data-stu-id="92093-213">A tooltip control actually has three time-out durations associated with it.</span></span> <span data-ttu-id="92093-214">初始持續時間是在顯示工具提示視窗之前，滑鼠指標必須保持在工具周框內的靜止時間。</span><span class="sxs-lookup"><span data-stu-id="92093-214">The initial duration is the time that the mouse pointer must remain stationary within the bounding rectangle of a tool before the tooltip window is displayed.</span></span> <span data-ttu-id="92093-215">Reshow 持續時間是在指標從一個工具移至另一個工具時，顯示後續工具提示視窗之前的延遲時間長度。</span><span class="sxs-lookup"><span data-stu-id="92093-215">The reshow duration is the length of the delay before subsequent tooltip windows are displayed when the pointer moves from one tool to another.</span></span> <span data-ttu-id="92093-216">快顯視窗持續時間是工具提示視窗在隱藏之前保持顯示狀態的時間。</span><span class="sxs-lookup"><span data-stu-id="92093-216">The pop-up duration is the time that the tooltip window remains displayed before it is hidden.</span></span> <span data-ttu-id="92093-217">亦即，如果指標在顯示工具提示視窗之後，在周框內保持不變，則會在快顯期間結束時自動隱藏工具提示視窗。</span><span class="sxs-lookup"><span data-stu-id="92093-217">That is, if the pointer remains stationary within the bounding rectangle after the tooltip window is displayed, the tooltip window is automatically hidden at the end of the pop-up duration.</span></span> <span data-ttu-id="92093-218">您可以使用 [**TTM \_ SETDELAYTIME**](ttm-setdelaytime.md) 訊息來調整所有超時時間。</span><span class="sxs-lookup"><span data-stu-id="92093-218">You can adjust all of the time-out durations by using the [**TTM\_SETDELAYTIME**](ttm-setdelaytime.md) message.</span></span>

<span data-ttu-id="92093-219">如果應用程式包含實作為矩形區域的工具，以及控制項的大小或位置變更，則應用程式可以使用 [**TTM \_ NEWTOOLRECT**](ttm-newtoolrect.md) 訊息來報告工具提示控制項的變更。</span><span class="sxs-lookup"><span data-stu-id="92093-219">If an application includes a tool implemented as a rectangular area and the size or position of the control changes, the application can use the [**TTM\_NEWTOOLRECT**](ttm-newtoolrect.md) message to report the change to the tooltip control.</span></span> <span data-ttu-id="92093-220">應用程式不需要針對實作為視窗的工具報告大小和位置變更，因為工具提示控制項使用工具的視窗控制碼來判斷滑鼠指標是否在工具上，而不是工具的周框。</span><span class="sxs-lookup"><span data-stu-id="92093-220">An application does not need to report size and position changes for a tool implemented as a window because the tooltip control uses the tool's window handle to determine if the mouse pointer is on the tool, not the tool's bounding rectangle.</span></span>

<span data-ttu-id="92093-221">當工具提示即將顯示時，工具提示控制項會將 [TTN \_ 顯示](ttn-show.md) 通知碼傳送給擁有者視窗。</span><span class="sxs-lookup"><span data-stu-id="92093-221">When a tooltip is about to be displayed, the tooltip control sends the owner window a [TTN\_SHOW](ttn-show.md) notification code.</span></span> <span data-ttu-id="92093-222">當工具提示即將隱藏時，擁有者視窗會收到 [TTN 的 \_ POP](ttn-pop.md) 通知碼。</span><span class="sxs-lookup"><span data-stu-id="92093-222">The owner window receives a [TTN\_POP](ttn-pop.md) notification code when a tooltip is about to be hidden.</span></span> <span data-ttu-id="92093-223">每個通知碼都會在 [**WM \_ 通知**](wm-notify.md) 訊息的內容中傳送。</span><span class="sxs-lookup"><span data-stu-id="92093-223">Each notification code is sent in the context of a [**WM\_NOTIFY**](wm-notify.md) message.</span></span>

## <a name="hit-testing"></a><span data-ttu-id="92093-224">點擊測試</span><span class="sxs-lookup"><span data-stu-id="92093-224">Hit Testing</span></span>

<span data-ttu-id="92093-225">[**TTM \_ system.windows.media.visualtreehelper.hittest**](ttm-hittest.md)訊息可讓您取得工具提示控制項維護有關特定點之工具的資訊。</span><span class="sxs-lookup"><span data-stu-id="92093-225">The [**TTM\_HITTEST**](ttm-hittest.md) message allows you to retrieve information that a tooltip control maintains about the tool occupying a particular point.</span></span> <span data-ttu-id="92093-226">此訊息包含 [**TTHITTESTINFO**](/windows/win32/api/commctrl/ns-commctrl-tthittestinfoa) 結構，其中包含視窗控制碼、點的座標，以及 [**TOOLINFO**](/windows/win32/api/commctrl/ns-commctrl-tttoolinfoa) 結構的位址。</span><span class="sxs-lookup"><span data-stu-id="92093-226">The message includes a [**TTHITTESTINFO**](/windows/win32/api/commctrl/ns-commctrl-tthittestinfoa) structure that contains a window handle, the coordinates of a point, and the address of a [**TOOLINFO**](/windows/win32/api/commctrl/ns-commctrl-tttoolinfoa) structure.</span></span> <span data-ttu-id="92093-227">工具提示控制項會判斷工具是否會佔用點，如果有的話，會以工具的相關資訊填滿 **TOOLINFO** 。</span><span class="sxs-lookup"><span data-stu-id="92093-227">The tooltip control determines whether a tool occupies the point and, if it does, fills **TOOLINFO** with information about the tool.</span></span>

## <a name="default-message-processing"></a><span data-ttu-id="92093-228">預設訊息處理</span><span class="sxs-lookup"><span data-stu-id="92093-228">Default Message Processing</span></span>

<span data-ttu-id="92093-229">下表描述工具提示控制項的視窗程式所處理的訊息。</span><span class="sxs-lookup"><span data-stu-id="92093-229">The following table describes the messages handled by the window procedure for the tooltip control.</span></span>



| <span data-ttu-id="92093-230">訊息</span><span class="sxs-lookup"><span data-stu-id="92093-230">Message</span></span>                                        | <span data-ttu-id="92093-231">描述</span><span class="sxs-lookup"><span data-stu-id="92093-231">Description</span></span>                                                                                                                                                                                                                                                       |
|------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="92093-232">**WM \_ 建立**</span><span class="sxs-lookup"><span data-stu-id="92093-232">**WM\_CREATE**</span></span>](/windows/desktop/winmsg/wm-create)             | <span data-ttu-id="92093-233">確保工具提示控制項具有 [**ws \_ EX \_ 工具視窗**](/windows/desktop/winmsg/window-styles) 和 [**ws \_ 彈出**](/windows/desktop/winmsg/window-styles) 視窗樣式。</span><span class="sxs-lookup"><span data-stu-id="92093-233">Ensures that the tooltip control has the [**WS\_EX\_TOOLWINDOW**](/windows/desktop/winmsg/window-styles) and [**WS\_POPUP**](/windows/desktop/winmsg/window-styles) window styles.</span></span> <span data-ttu-id="92093-234">它也會配置記憶體並初始化內部變數。</span><span class="sxs-lookup"><span data-stu-id="92093-234">It also allocates memory and initializes internal variables.</span></span> |
| [<span data-ttu-id="92093-235">**WM 損 \_ 毀**</span><span class="sxs-lookup"><span data-stu-id="92093-235">**WM\_DESTROY**</span></span>](/windows/desktop/winmsg/wm-destroy)           | <span data-ttu-id="92093-236">釋出配置給工具提示控制項的資源。</span><span class="sxs-lookup"><span data-stu-id="92093-236">Frees resources allocated for the tooltip control.</span></span>                                                                                                                                                                                                                |
| [<span data-ttu-id="92093-237">**WM \_ GETFONT**</span><span class="sxs-lookup"><span data-stu-id="92093-237">**WM\_GETFONT**</span></span>](/windows/desktop/winmsg/wm-getfont)           | <span data-ttu-id="92093-238">傳回工具提示控制項將用來繪製文字的字型控制碼。</span><span class="sxs-lookup"><span data-stu-id="92093-238">Returns the handle of the font that the tooltip control will use to draw text.</span></span>                                                                                                                                                                                    |
| [<span data-ttu-id="92093-239">**WM \_ MOUSEMOVE**</span><span class="sxs-lookup"><span data-stu-id="92093-239">**WM\_MOUSEMOVE**</span></span>](/windows/desktop/inputdev/wm-mousemove)     | <span data-ttu-id="92093-240">隱藏工具提示視窗。</span><span class="sxs-lookup"><span data-stu-id="92093-240">Hides the tooltip window.</span></span>                                                                                                                                                                                                                                         |
| [<span data-ttu-id="92093-241">**WM \_ 油漆**</span><span class="sxs-lookup"><span data-stu-id="92093-241">**WM\_PAINT**</span></span>](/windows/desktop/gdi/wm-paint)                  | <span data-ttu-id="92093-242">繪製工具提示視窗。</span><span class="sxs-lookup"><span data-stu-id="92093-242">Draws the tooltip window.</span></span>                                                                                                                                                                                                                                         |
| [<span data-ttu-id="92093-243">**WM \_ SETFONT**</span><span class="sxs-lookup"><span data-stu-id="92093-243">**WM\_SETFONT**</span></span>](/windows/desktop/winmsg/wm-setfont)           | <span data-ttu-id="92093-244">設定工具提示控制項將用來繪製文字的字型控制碼。</span><span class="sxs-lookup"><span data-stu-id="92093-244">Sets the handle of the font that the tooltip control will use to draw text.</span></span>                                                                                                                                                                                       |
| [<span data-ttu-id="92093-245">**WM \_ 計時器**</span><span class="sxs-lookup"><span data-stu-id="92093-245">**WM\_TIMER**</span></span>](/windows/desktop/winmsg/wm-timer)               | <span data-ttu-id="92093-246">如果工具已變更位置，或滑鼠指標移至工具外，則隱藏工具提示視窗。</span><span class="sxs-lookup"><span data-stu-id="92093-246">Hides the tooltip window if the tool has changed position or if the mouse pointer has moved outside the tool.</span></span> <span data-ttu-id="92093-247">否則，它會顯示工具提示視窗。</span><span class="sxs-lookup"><span data-stu-id="92093-247">Otherwise, it shows the tooltip window.</span></span>                                                                                                             |
| [<span data-ttu-id="92093-248">**WM \_ WININICHANGE**</span><span class="sxs-lookup"><span data-stu-id="92093-248">**WM\_WININICHANGE**</span></span>](/windows/desktop/winmsg/wm-wininichange) | <span data-ttu-id="92093-249">重設以系統計量為基礎的內部變數。</span><span class="sxs-lookup"><span data-stu-id="92093-249">Resets internal variables that are based on system metrics.</span></span>                                                                                                                                                                                                       |



 

 

 