---
title: Windows 7 開發人員指南) 效能 (
description: Windows 7 可將硬體能源效率和擴充性最大化，同時維持高效能。
ms.assetid: db48aa8f-749e-4a56-8a91-ac9b81d6e8c9
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 752f66e80265bf7d6b3ea26e7baabdc6550ce921
ms.sourcegitcommit: 8fa6614b715bddf14648cce36d2df22e5232801a
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 12/10/2020
ms.locfileid: "104316952"
---
# <a name="performance-windows-7-developer-guide"></a><span data-ttu-id="b7acc-103">Windows 7 開發人員指南) 效能 (</span><span class="sxs-lookup"><span data-stu-id="b7acc-103">Performance (Windows 7 Developer Guide)</span></span>

<span data-ttu-id="b7acc-104">Windows 7 可將硬體能源效率和擴充性最大化，同時維持高效能。</span><span class="sxs-lookup"><span data-stu-id="b7acc-104">Windows 7 maximizes hardware energy efficiency and scalability while maintaining high performance.</span></span> <span data-ttu-id="b7acc-105">透過減少背景活動，以及啟動系統服務觸發程式的新支援，來改善能源效率。</span><span class="sxs-lookup"><span data-stu-id="b7acc-105">Energy efficiency is improved through reduced background activity and new support for the trigger starting of system services.</span></span> <span data-ttu-id="b7acc-106">Windows 7 也提供 Windows 核心的改良功能，讓應用程式和服務能夠在各平臺之間有效率地調整規模。</span><span class="sxs-lookup"><span data-stu-id="b7acc-106">Windows 7 also offers improvements in the Windows kernel that enable applications and services to scale efficiently between platforms.</span></span> <span data-ttu-id="b7acc-107">Windows 7 與 Windows Vista 中的許多功能和 Api 的效能已獲得改善。</span><span class="sxs-lookup"><span data-stu-id="b7acc-107">Performance of many features and APIs is improved in Windows 7 versus Windows Vista.</span></span> <span data-ttu-id="b7acc-108">例如，伺服器上的驅動程式效能是透過新的使用者模式和核心模式拓撲 Api 進行優化。</span><span class="sxs-lookup"><span data-stu-id="b7acc-108">For example, driver performance on servers is optimized by new user-mode and kernel-mode topology APIs.</span></span> <span data-ttu-id="b7acc-109">圖形轉譯的速度更平滑且更快速。</span><span class="sxs-lookup"><span data-stu-id="b7acc-109">Graphics rendering is considerably smoother and faster.</span></span> <span data-ttu-id="b7acc-110">協助工具效能的速度也會比之前快很多。</span><span class="sxs-lookup"><span data-stu-id="b7acc-110">Accessibility performance is also significantly faster than before.</span></span>

## <a name="building-power-efficient-applications"></a><span data-ttu-id="b7acc-111">建立 Power-Efficient 應用程式</span><span class="sxs-lookup"><span data-stu-id="b7acc-111">Building Power-Efficient Applications</span></span>

<span data-ttu-id="b7acc-112">建立節能的應用程式，利用最新的電源管理技術，是開發人員目前面臨的重大挑戰。</span><span class="sxs-lookup"><span data-stu-id="b7acc-112">Building energy efficient applications that take advantage of the latest power management technologies is a significant challenge developers are facing today.</span></span> <span data-ttu-id="b7acc-113">一般來說，處理器和裝置製造商會在其最新的供應專案經過測量和基準測試時，獲得最新的注意力。</span><span class="sxs-lookup"><span data-stu-id="b7acc-113">Typically, processor and device manufacturers get all of the attention as their latest offerings are measured and benchmarked.</span></span> <span data-ttu-id="b7acc-114">不過，單一應用程式很容易就能防止最新一代的硬體實現其能源效率的潛力。</span><span class="sxs-lookup"><span data-stu-id="b7acc-114">However, a single application can easily prevent the latest generation of hardware from realizing its energy-efficiency potential.</span></span> <span data-ttu-id="b7acc-115">例如，增加平臺計時器解析度的單一應用程式可能會將電池壽命減少10%。</span><span class="sxs-lookup"><span data-stu-id="b7acc-115">For example, a single application that increases the platform timer resolution can decrease battery life by 10 percent.</span></span>

<span data-ttu-id="b7acc-116">使用電池電力的擴充作業和能源效率技術，是現今開發人員的關鍵需求。</span><span class="sxs-lookup"><span data-stu-id="b7acc-116">Extended operation on battery power and the use of energy efficient technologies are key requirements for today's developers.</span></span> <span data-ttu-id="b7acc-117">Windows 7 可大幅減少作業系統執行的活動數目，以防止使用省電模式。</span><span class="sxs-lookup"><span data-stu-id="b7acc-117">Windows 7 greatly reduces the number of activities that the operating system performs that prevent use of power-saving modes.</span></span> <span data-ttu-id="b7acc-118">它也支援啟動系統服務的觸發程式，以讓處理器更頻繁地變成閒置狀態，並持續維持閒置狀態，以降低耗電量。</span><span class="sxs-lookup"><span data-stu-id="b7acc-118">It also supports the trigger-starting of system services to enable processors to become idle more often and stay idle longer, which decreases power consumption.</span></span> <span data-ttu-id="b7acc-119">此外，Windows 7 還會利用最新的節能硬體，包括網路介面卡、存放裝置和圖形卡。</span><span class="sxs-lookup"><span data-stu-id="b7acc-119">In addition, Windows 7 takes advantage of the latest energy-efficient hardware, including network adapters, storage devices, and graphics cards.</span></span>

<span data-ttu-id="b7acc-120">Windows 7 提供基礎結構和工具，讓開發人員能夠輕鬆地判斷其應用程式的能源衝擊。</span><span class="sxs-lookup"><span data-stu-id="b7acc-120">Windows 7 provides the infrastructure and tools that make it easy for developers to determine the energy impact of their applications.</span></span> <span data-ttu-id="b7acc-121">一組事件回呼可讓應用程式在系統使用電池電源時減少其活動，並在系統處於 *AC* 電源時自動擴大。</span><span class="sxs-lookup"><span data-stu-id="b7acc-121">A set of event callbacks enable applications to reduce their activity when the system is on battery power and automatically scale up when the system is on *AC* power.</span></span> <span data-ttu-id="b7acc-122">對於牽涉到背景程式或服務的應用程式，Windows 7 提供新的基礎結構，讓您在最適當的情況下自動啟用背景工作，以便將能源效率最大化。</span><span class="sxs-lookup"><span data-stu-id="b7acc-122">For applications that involve a background process or service, Windows 7 features new infrastructure to automatically enable background tasks when most appropriate in order to maximize energy efficiency.</span></span> <span data-ttu-id="b7acc-123"> (參閱 Windows 7 的 [WHDC 效能核心](https://www.microsoft.com/whdc/system/sysperf/default.mspx) 和 [電源管理總覽](https://www.climatesaverscomputing.org/wordpress/wp-content/uploads/2011/06/Power_Management_in_Windows_7_Overview.pdf). ) </span><span class="sxs-lookup"><span data-stu-id="b7acc-123">(See [WHDC Performance Central](https://www.microsoft.com/whdc/system/sysperf/default.mspx) and [Power Management in Windows 7 Overview](https://www.climatesaverscomputing.org/wordpress/wp-content/uploads/2011/06/Power_Management_in_Windows_7_Overview.pdf).)</span></span>

## <a name="service-control-manager"></a><span data-ttu-id="b7acc-124">服務控制管理員</span><span class="sxs-lookup"><span data-stu-id="b7acc-124">Service Control Manager</span></span>

<span data-ttu-id="b7acc-125">Windows 7Service Control Manager (SCM) 已經過擴充，因此當系統發生特定的系統事件或觸發程式時，就可以自動啟動和停止服務。</span><span class="sxs-lookup"><span data-stu-id="b7acc-125">The Windows 7Service Control Manager (SCM) has been extended so that a service can be automatically started and stopped when a specific system event, or trigger, occurs on the system.</span></span> <span data-ttu-id="b7acc-126">觸發程式啟動功能可移除在電腦啟動時自動啟動服務的需求，然後輪詢或等候事件發生，例如裝置抵達。</span><span class="sxs-lookup"><span data-stu-id="b7acc-126">Trigger-start capabilities remove the need for services to start up automatically at computer startup and then poll or wait for an event to occur, such as device arrival.</span></span> <span data-ttu-id="b7acc-127">服務的一般觸發程式事件包括：</span><span class="sxs-lookup"><span data-stu-id="b7acc-127">Common trigger events for services include:</span></span>

-   <span data-ttu-id="b7acc-128">裝置類別介面抵達：只有在有特定類型的裝置存在或連接到系統時，才會啟動服務。</span><span class="sxs-lookup"><span data-stu-id="b7acc-128">Device-class interface arrival: Start a service only when a certain type of device is present or attached on the system.</span></span>
-   <span data-ttu-id="b7acc-129">網域加入：只有當系統已加入 Windows 網域時，才會啟動服務。</span><span class="sxs-lookup"><span data-stu-id="b7acc-129">Domain join: Start a service only if the system is joined to a Windows domain.</span></span>
-   <span data-ttu-id="b7acc-130">群組原則變更：當系統上的群組原則重新整理時，就會自動啟動服務。</span><span class="sxs-lookup"><span data-stu-id="b7acc-130">Group policy change: Start a service automatically when group policies are refreshed on the system.</span></span>
-   <span data-ttu-id="b7acc-131">IP 位址抵達：只有當系統連線到網路時，才會啟動服務。</span><span class="sxs-lookup"><span data-stu-id="b7acc-131">IP address arrival: Start a service only when the system is connected to the network.</span></span>

<span data-ttu-id="b7acc-132">軟體發展人員可以使用適用于 Windows 7 的預先定義觸發程式類型，以及啟用觸發程式啟動功能的設定選項。</span><span class="sxs-lookup"><span data-stu-id="b7acc-132">Software developers can use the predefined trigger types for Windows 7 and the configuration options to enable trigger-start capability.</span></span> <span data-ttu-id="b7acc-133">Windows 7SCM 會公開一組新的 Api，讓服務註冊特定的自訂觸發程式事件。</span><span class="sxs-lookup"><span data-stu-id="b7acc-133">The Windows 7SCM exposes a new set of APIs that enable a service to register for specific custom trigger events.</span></span> <span data-ttu-id="b7acc-134"> (請參閱 [服務控制管理員](../services/service-control-manager.md)。 ) </span><span class="sxs-lookup"><span data-stu-id="b7acc-134">(See [Service Control Manager](../services/service-control-manager.md).)</span></span>

## <a name="windows-troubleshooting-platform"></a><span data-ttu-id="b7acc-135">Windows 疑難排解平臺</span><span class="sxs-lookup"><span data-stu-id="b7acc-135">Windows Troubleshooting Platform</span></span>

<span data-ttu-id="b7acc-136">Windows 7 提供一套完整且可擴充的疑難排解平臺，使用 PowerShell 架構的機制來疑難排解和解決問題。</span><span class="sxs-lookup"><span data-stu-id="b7acc-136">Windows 7 delivers a comprehensive and extensible Troubleshooting Platform that uses a PowerShell-based mechanism to troubleshoot and resolve problems.</span></span> <span data-ttu-id="b7acc-137">疑難排解平臺的主要元件包括疑難排解套件、疑難排解引擎和疑難排解 wizard。</span><span class="sxs-lookup"><span data-stu-id="b7acc-137">The key components of the Troubleshooting Platform include a troubleshooting package, troubleshooting engine, and troubleshooting wizard.</span></span> <span data-ttu-id="b7acc-138">疑難排解套件是 PowerShell 腳本和相關中繼資料的集合。</span><span class="sxs-lookup"><span data-stu-id="b7acc-138">The troubleshooting pack is a collection of PowerShell scripts and relevant metadata.</span></span> <span data-ttu-id="b7acc-139">疑難排解引擎會啟動 PowerShell 執行時間來執行疑難排解套件，並公開一組介面來控制疑難排解套件的執行。</span><span class="sxs-lookup"><span data-stu-id="b7acc-139">The troubleshooting engine launches a PowerShell runtime to execute a troubleshooting pack, and exposes a set of interfaces to control troubleshooting pack execution.</span></span>

<span data-ttu-id="b7acc-140">疑難排解 wizard 可提供一致的疑難排解套件體驗，與疑難排解引擎進行通訊，以疑難排解並解決疑難排解套件中所指定的問題。</span><span class="sxs-lookup"><span data-stu-id="b7acc-140">The troubleshooting wizard provides a consistent experience across troubleshooting packs, communicating with the troubleshooting engine to troubleshoot and resolve problems that are specified in a troubleshooting pack.</span></span> <span data-ttu-id="b7acc-141">您也可以透過一組 PowerShell *commandlet* 來控制疑難排解套件的執行。</span><span class="sxs-lookup"><span data-stu-id="b7acc-141">Execution of a troubleshooting pack can also be controlled through a set of PowerShell *commandlets*.</span></span>

<span data-ttu-id="b7acc-142">疑難排解平臺與 Windows 7PC 解決方案中心緊密整合，讓其他應用程式能夠以與 PC 管理擬訂規則一部分類似的方式來執行診斷。</span><span class="sxs-lookup"><span data-stu-id="b7acc-142">The Troubleshooting Platform seamlessly integrates with the Windows 7PC Solution Center, enabling other applications to execute diagnostics in a similar manner as part of their PC management regimen.</span></span> <span data-ttu-id="b7acc-143">IT 專業人員可透過 *群組原則* 在企業內使用來設定疑難排解平臺，也可以使用 Windows 疑難排解工具組，讓開發人員撰寫疑難排解套件。</span><span class="sxs-lookup"><span data-stu-id="b7acc-143">The Troubleshooting Platform is configurable by IT professionals through *Group Policy* for use within the enterprise, and a Windows Troubleshooting Toolkit that allows developers to author troubleshooting packs is also available.</span></span> <span data-ttu-id="b7acc-144"> (參閱 [Windows 疑難排解 Platform](/previous-versions/windows/desktop/wintt/windows-troubleshooting-toolkit-portal)。 ) </span><span class="sxs-lookup"><span data-stu-id="b7acc-144">(See [Windows Troubleshooting Platform](/previous-versions/windows/desktop/wintt/windows-troubleshooting-toolkit-portal).)</span></span>

![針對平臺 ui 進行疑難排解](images/windows7-devguide-troubleshoot.jpg)

<span data-ttu-id="b7acc-146">疑難排解平臺與 Windows 7PC 解決方案中心緊密整合</span><span class="sxs-lookup"><span data-stu-id="b7acc-146">The Troubleshooting Platform seamlessly integrates with the Windows 7PC Solution Center</span></span>

 

 
