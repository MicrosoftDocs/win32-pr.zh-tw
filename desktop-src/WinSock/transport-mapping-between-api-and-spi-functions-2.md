---
description: Winsock 傳輸 SPI 類似于 Winsock API，因為所有的基本通訊端函數都會出現。
ms.assetid: 37ef8a69-2aa0-4824-8ca9-4b84158086db
title: API 與 SPI 函數之間的傳輸對應
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: a0f11b950c48d0887f1e593c65f9d77e27c33917
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/08/2021
ms.locfileid: "106984639"
---
# <a name="transport-mapping-between-api-and-spi-functions"></a><span data-ttu-id="1259a-103">API 與 SPI 函數之間的傳輸對應</span><span class="sxs-lookup"><span data-stu-id="1259a-103">Transport Mapping Between API and SPI Functions</span></span>

<span data-ttu-id="1259a-104">Winsock 傳輸 SPI 類似于 Winsock API，因為所有的基本通訊端函數都會出現。</span><span class="sxs-lookup"><span data-stu-id="1259a-104">The Winsock Transport SPI is similar to the Winsock API in that all of the basic socket functions appear.</span></span> <span data-ttu-id="1259a-105">當新版本的 Winsock 函式和原始版本都存在於 API 時，SPI 中只會顯示新的版本。</span><span class="sxs-lookup"><span data-stu-id="1259a-105">When a new version of a Winsock function and the original version both exist in the API, only the new version will show up in the SPI.</span></span> <span data-ttu-id="1259a-106">以下清單將說明這一點。</span><span class="sxs-lookup"><span data-stu-id="1259a-106">This is illustrated in the following list.</span></span>

-   <span data-ttu-id="1259a-107">[**connect**](/windows/desktop/api/Winsock2/nf-winsock2-connect) 和 [**WSAConnect**](/windows/desktop/api/Winsock2/nf-winsock2-wsaconnect) 都對應至 [**WSPConnect**](/previous-versions/windows/hardware/network/ff566275(v=vs.85))</span><span class="sxs-lookup"><span data-stu-id="1259a-107">[**connect**](/windows/desktop/api/Winsock2/nf-winsock2-connect) and [**WSAConnect**](/windows/desktop/api/Winsock2/nf-winsock2-wsaconnect) both map to [**WSPConnect**](/previous-versions/windows/hardware/network/ff566275(v=vs.85))</span></span>
-   <span data-ttu-id="1259a-108">[**accept**](/windows/desktop/api/Winsock2/nf-winsock2-accept) 和 [**WSAAccept**](/windows/desktop/api/Winsock2/nf-winsock2-wsaaccept) 對應至 [**WSPAccept**](/windows/desktop/api/Ws2spi/nc-ws2spi-lpwspaccept)</span><span class="sxs-lookup"><span data-stu-id="1259a-108">[**accept**](/windows/desktop/api/Winsock2/nf-winsock2-accept) and [**WSAAccept**](/windows/desktop/api/Winsock2/nf-winsock2-wsaaccept) map to [**WSPAccept**](/windows/desktop/api/Ws2spi/nc-ws2spi-lpwspaccept)</span></span>
-   <span data-ttu-id="1259a-109">[**通訊端**](/windows/desktop/api/Winsock2/nf-winsock2-socket) 和 [**WSASocket**](/windows/desktop/api/Winsock2/nf-winsock2-wsasocketa) 對應至 [**WSPSocket**](/windows/desktop/api/Ws2spi/nc-ws2spi-lpwspsocket)</span><span class="sxs-lookup"><span data-stu-id="1259a-109">[**socket**](/windows/desktop/api/Winsock2/nf-winsock2-socket) and [**WSASocket**](/windows/desktop/api/Winsock2/nf-winsock2-wsasocketa) map to [**WSPSocket**](/windows/desktop/api/Ws2spi/nc-ws2spi-lpwspsocket)</span></span>

<span data-ttu-id="1259a-110">其他已折迭至 SPI 增強版的 API 函式包括：</span><span class="sxs-lookup"><span data-stu-id="1259a-110">Other API functions that are collapsed into the enhanced versions in SPI include:</span></span>

-   [<span data-ttu-id="1259a-111">**發送**</span><span class="sxs-lookup"><span data-stu-id="1259a-111">**send**</span></span>](/windows/desktop/api/Winsock2/nf-winsock2-send)
-   [<span data-ttu-id="1259a-112">**sendto**</span><span class="sxs-lookup"><span data-stu-id="1259a-112">**sendto**</span></span>](/windows/desktop/api/winsock/nf-winsock-sendto)
-   [<span data-ttu-id="1259a-113">**recv**</span><span class="sxs-lookup"><span data-stu-id="1259a-113">**recv**</span></span>](/windows/desktop/api/winsock/nf-winsock-recv)
-   [<span data-ttu-id="1259a-114">**recvfrom**</span><span class="sxs-lookup"><span data-stu-id="1259a-114">**recvfrom**</span></span>](/windows/desktop/api/winsock/nf-winsock-recvfrom)
-   [<span data-ttu-id="1259a-115">**ioctlsocket**</span><span class="sxs-lookup"><span data-stu-id="1259a-115">**ioctlsocket**</span></span>](/windows/desktop/api/winsock/nf-winsock-ioctlsocket)

<span data-ttu-id="1259a-116">[**Htonl**](/windows/desktop/api/winsock/nf-winsock-htonl)、 [**htons**](/windows/desktop/api/winsock/nf-winsock-htons)、 [**ntohl**](/windows/desktop/api/winsock/nf-winsock-ntohl)和 [**Ntohs**](/windows/desktop/api/winsock/nf-winsock-ntohs)等支援函式是在 Ws232.dll 中執行 \_ ，而不會向下傳遞給服務提供者。</span><span class="sxs-lookup"><span data-stu-id="1259a-116">Support functions like [**htonl**](/windows/desktop/api/winsock/nf-winsock-htonl), [**htons**](/windows/desktop/api/winsock/nf-winsock-htons), [**ntohl**](/windows/desktop/api/winsock/nf-winsock-ntohl), and [**ntohs**](/windows/desktop/api/winsock/nf-winsock-ntohs) are implemented in the Ws2\_32.dll, and are not passed down to service providers.</span></span> <span data-ttu-id="1259a-117">這些函數的 WSA 版本也是如此。</span><span class="sxs-lookup"><span data-stu-id="1259a-117">The same holds true for the WSA versions of these functions.</span></span>

<span data-ttu-id="1259a-118">Windows 通訊端服務提供者列舉和封鎖攔截相關函式是在 Ws232.dll 中實現 \_ ， [**因此 WSAEnumProtocols**](/windows/desktop/api/Winsock2/nf-winsock2-wsaenumprotocolsa)、 [WSAIsBlocking](/windows/desktop/api/winsock2/nf-winsock2-wsaisblocking)、 [WSASetBlockingHook](/windows/desktop/api/winsock2/nf-winsock2-wsasetblockinghook)和 [WSAUnhookBlockingHook](/windows/desktop/api/winsock2/nf-winsock2-wsaunhookblockinghook) 不會顯示為 SPI 函式。</span><span class="sxs-lookup"><span data-stu-id="1259a-118">Windows Sockets service provider enumeration and the blocking hook-related functions are realized in the Ws2\_32.dll, thus [**WSAEnumProtocols**](/windows/desktop/api/Winsock2/nf-winsock2-wsaenumprotocolsa), [WSAIsBlocking](/windows/desktop/api/winsock2/nf-winsock2-wsaisblocking), [WSASetBlockingHook](/windows/desktop/api/winsock2/nf-winsock2-wsasetblockinghook), and [WSAUnhookBlockingHook](/windows/desktop/api/winsock2/nf-winsock2-wsaunhookblockinghook) do not appear as SPI functions.</span></span>

<span data-ttu-id="1259a-119">由於錯誤碼會連同 SPI 函式一起傳回，因此 SPI 中不需要 [**WSAGetLastError**](/windows/desktop/api/winsock/nf-winsock-wsagetlasterror) 和 [**WSASetLastError**](/windows/desktop/api/winsock/nf-winsock-wsasetlasterror) 的對應專案。</span><span class="sxs-lookup"><span data-stu-id="1259a-119">Because error codes are returned along with SPI functions, equivalents of [**WSAGetLastError**](/windows/desktop/api/winsock/nf-winsock-wsagetlasterror) and [**WSASetLastError**](/windows/desktop/api/winsock/nf-winsock-wsasetlasterror) are not required in the SPI.</span></span>

<span data-ttu-id="1259a-120">事件物件操作和等候函式（包括 [**WSACreateEvent**](/windows/desktop/api/Winsock2/nf-winsock2-wsacreateevent)、 [**WSACloseEvent**](/windows/desktop/api/Winsock2/nf-winsock2-wsacloseevent)、 [**WSASetEvent**](/windows/desktop/api/Winsock2/nf-winsock2-wsasetevent)、 [**WSAResetEvent**](/windows/desktop/api/Winsock2/nf-winsock2-wsaresetevent)和 [**WSAWaitForMultipleEvents**](/windows/desktop/api/Winsock2/nf-winsock2-wsawaitformultipleevents) ）會直接對應到原生 Windows 服務，因此不會出現在 SPI 中。</span><span class="sxs-lookup"><span data-stu-id="1259a-120">The event object manipulation and wait functions, including [**WSACreateEvent**](/windows/desktop/api/Winsock2/nf-winsock2-wsacreateevent), [**WSACloseEvent**](/windows/desktop/api/Winsock2/nf-winsock2-wsacloseevent), [**WSASetEvent**](/windows/desktop/api/Winsock2/nf-winsock2-wsasetevent), [**WSAResetEvent**](/windows/desktop/api/Winsock2/nf-winsock2-wsaresetevent), and [**WSAWaitForMultipleEvents**](/windows/desktop/api/Winsock2/nf-winsock2-wsawaitformultipleevents) are mapped directly to native Windows services and thus are not present in the SPI.</span></span>

<span data-ttu-id="1259a-121">Windows 通訊端1.1 （例如 **GetXbyY**、 **WSAAsyncGetXByY** 和 [**WSACancelAsyncRequest**](/windows/desktop/api/winsock/nf-winsock-wsacancelasyncrequest)，以及 [**gethostname**](/windows/desktop/api/winsock/nf-winsock-gethostname) ）中的所有 tcp/ip 特定名稱轉換和解析函式，會根據 \_ 新的名稱解析功能，在 Ws232.dll 內進行。</span><span class="sxs-lookup"><span data-stu-id="1259a-121">All the TCP/IP-specific name conversion and resolution functions in Windows Sockets 1.1 such as **GetXbyY**, **WSAAsyncGetXByY**, and [**WSACancelAsyncRequest**](/windows/desktop/api/winsock/nf-winsock-wsacancelasyncrequest), as well as [**gethostname**](/windows/desktop/api/winsock/nf-winsock-gethostname) are implemented within the Ws2\_32.dll in terms of the new name resolution facilities.</span></span> <span data-ttu-id="1259a-122">如需詳細資訊，請參閱 [Windows 通訊端 1.1 SPI 中 tcp/ip 的相容名稱解析](compatible-name-resolution-for-tcp-ip-in-the-windows-sockets-1-1-spi-2.md)。</span><span class="sxs-lookup"><span data-stu-id="1259a-122">For more information, see [Compatible Name Resolution for TCP/IP in the Windows Sockets 1.1 SPI](compatible-name-resolution-for-tcp-ip-in-the-windows-sockets-1-1-spi-2.md).</span></span> <span data-ttu-id="1259a-123">轉換函式（例如 [**inet \_ addr**](/windows/win32/api/winsock2/nf-winsock2-inet_addr) 和 [**inet \_ ntoa**](/windows/win32/api/winsock2/nf-winsock2-inet_ntoa) ）是在 Ws2 \_32.dll 內執行。</span><span class="sxs-lookup"><span data-stu-id="1259a-123">Conversion functions such as [**inet\_addr**](/windows/win32/api/winsock2/nf-winsock2-inet_addr) and [**inet\_ntoa**](/windows/win32/api/winsock2/nf-winsock2-inet_ntoa) are implemented within the Ws2\_32.dll.</span></span>

 

 
