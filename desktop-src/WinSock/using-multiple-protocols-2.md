---
description: 應用程式會使用 WSAEnumProtocols 函數來判斷存在哪些傳輸通訊協定和通訊協定鏈，以及取得相關聯 WSAPROTOCOL 資訊結構中所包含之每個的相關資訊 \_ 。
ms.assetid: 4f38cb07-d824-4d43-abd8-89d58dc15810
title: 使用多個通訊協定
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 1ab9a37dcc90f1094126f701641539dd3f26a1a3
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/07/2021
ms.locfileid: "104112996"
---
# <a name="using-multiple-protocols"></a><span data-ttu-id="3a2fa-103">使用多個通訊協定</span><span class="sxs-lookup"><span data-stu-id="3a2fa-103">Using Multiple Protocols</span></span>

<span data-ttu-id="3a2fa-104">應用程式會使用 [**WSAEnumProtocols**](/windows/desktop/api/Winsock2/nf-winsock2-wsaenumprotocolsa) 函數來判斷存在哪些傳輸通訊協定和通訊協定鏈，以及取得相關聯 [**WSAPROTOCOL \_ 資訊**](/windows/win32/api/winsock2/ns-winsock2-wsaprotocol_infoa) 結構中所包含之每個的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="3a2fa-104">An application uses the [**WSAEnumProtocols**](/windows/desktop/api/Winsock2/nf-winsock2-wsaenumprotocolsa) function to determine which transport protocols and protocol chains are present, and to obtain information about each as contained in the associated [**WSAPROTOCOL\_INFO**](/windows/win32/api/winsock2/ns-winsock2-wsaprotocol_infoa) structure.</span></span>

<span data-ttu-id="3a2fa-105">在大部分的情況下，每個通訊協定或通訊協定鏈都有一個 [**WSAPROTOCOL \_ 資訊**](/windows/win32/api/winsock2/ns-winsock2-wsaprotocol_infoa) 結構。</span><span class="sxs-lookup"><span data-stu-id="3a2fa-105">In most instances, there is a single [**WSAPROTOCOL\_INFO**](/windows/win32/api/winsock2/ns-winsock2-wsaprotocol_infoa) structure for each protocol or protocol chain.</span></span> <span data-ttu-id="3a2fa-106">不過，某些通訊協定會展示多個行為。</span><span class="sxs-lookup"><span data-stu-id="3a2fa-106">However, some protocols exhibit multiple behaviors.</span></span> <span data-ttu-id="3a2fa-107">例如，SPX 通訊協定是訊息導向的 (也就是說，傳送者的訊息界限會由網路) 保留，但是接收的通訊端可以忽略這些訊息界限，並將其視為位元組串流。</span><span class="sxs-lookup"><span data-stu-id="3a2fa-107">For example, the SPX protocol is message oriented (that is, the sender's message boundaries are preserved by the network), but the receiving socket can ignore these message boundaries and treat them as a byte stream.</span></span> <span data-ttu-id="3a2fa-108">因此，每個行為都有兩個不同的 **WSAPROTOCOL \_ 資訊** 結構專案。</span><span class="sxs-lookup"><span data-stu-id="3a2fa-108">Thus, two different **WSAPROTOCOL\_INFO** structure entries could exist for SPX—one for each behavior.</span></span>

<span data-ttu-id="3a2fa-109">在 Windows 通訊端2中，會出現數個新的位址系列、通訊端類型和通訊協定值。</span><span class="sxs-lookup"><span data-stu-id="3a2fa-109">In Windows Sockets 2, several new address family, socket type, and protocol values appear.</span></span> <span data-ttu-id="3a2fa-110">Windows 通訊端1.1 支援單一位址系列 (AF \_ INET) 適用于 IPv4，其中由少數知名的通訊端類型和通訊協定識別碼組成。</span><span class="sxs-lookup"><span data-stu-id="3a2fa-110">Windows Sockets 1.1 supported a single address family (AF\_INET) for IPv4 that consisted of a small number of well-known socket types and protocol identifiers.</span></span> <span data-ttu-id="3a2fa-111">由於相容性的緣故，Windows 通訊端2會保留現有的位址系列、通訊端類型和通訊協定識別碼，但它也支援新的傳輸通訊協定新的位址系列值給新的媒體類型。</span><span class="sxs-lookup"><span data-stu-id="3a2fa-111">Windows Sockets 2 retains the existing address family, socket type, and protocol identifiers for compatibility reasons, but it also supports new address family values for new transport protocols with new media types.</span></span>

<span data-ttu-id="3a2fa-112">新的唯一識別碼不一定是知名的，但這應該不會造成問題。</span><span class="sxs-lookup"><span data-stu-id="3a2fa-112">New, unique identifiers are not necessarily well known, but this should not pose a problem.</span></span> <span data-ttu-id="3a2fa-113">建議需要與通訊協定無關的應用程式，根據其適用性（而不是指派給其 *通訊端 \_ 類型* 或 *通訊協定* 參數的值）選取通訊協定。</span><span class="sxs-lookup"><span data-stu-id="3a2fa-113">Applications that need to be protocol-independent are encouraged to select a protocol on the basis of its suitability rather than the values assigned to their *socket\_type* or *protocol* parameters.</span></span> <span data-ttu-id="3a2fa-114">通訊協定適用性是由通訊屬性工作表示，例如訊息與位元組資料流程，以及包含在通訊協定 [**WSAPROTOCOL \_ 資訊**](/windows/win32/api/winsock2/ns-winsock2-wsaprotocol_infoa) 結構中可靠且不可靠的通訊屬性。</span><span class="sxs-lookup"><span data-stu-id="3a2fa-114">Protocol suitability is indicated by the communications attributes, such as message-versus-byte stream, and reliable-versus-unreliable, that are contained in the protocol [**WSAPROTOCOL\_INFO**](/windows/win32/api/winsock2/ns-winsock2-wsaprotocol_infoa) structure.</span></span> <span data-ttu-id="3a2fa-115">以適用性為基礎選取通訊協定，而不是已知的通訊協定名稱和通訊端類型，可讓與通訊協定無關的應用程式利用新的傳輸通訊協定與其相關聯的媒體類型（因為它們變成可用）。</span><span class="sxs-lookup"><span data-stu-id="3a2fa-115">Selecting protocols on the basis of suitability as opposed to well-known protocol names and socket types lets protocol-independent applications take advantage of new transport protocols and their associated media types, as they become available.</span></span>

<span data-ttu-id="3a2fa-116">伺服器一半的用戶端/伺服器應用程式會藉由在所有適合的傳輸通訊協定上建立接聽通訊端來獲益。</span><span class="sxs-lookup"><span data-stu-id="3a2fa-116">The server half of a client/server application benefits by establishing listening sockets on all suitable transport protocols.</span></span> <span data-ttu-id="3a2fa-117">然後，用戶端可以使用任何適當的通訊協定來建立其連接。</span><span class="sxs-lookup"><span data-stu-id="3a2fa-117">Then, the client can establish its connection using any suitable protocol.</span></span> <span data-ttu-id="3a2fa-118">例如，這會讓用戶端應用程式不受修改，不論它是在透過區域網路連線的桌面系統上執行，還是在使用無線網路的膝上型電腦上執行。</span><span class="sxs-lookup"><span data-stu-id="3a2fa-118">For example, this would let a client application be unmodified whether it was running on a desktop system connected through LAN or on a laptop using a wireless network.</span></span>

 

 
