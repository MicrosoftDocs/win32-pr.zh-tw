---
description: 為了讓命名空間提供者能夠透過 Windows 通訊端存取，它必須正確安裝在系統上，並向 Windows 通訊端註冊。
ms.assetid: c73baf62-b862-476c-b381-be00699e78ca
title: 名稱解析設定和安裝
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 423e0ca7c9c5290a040a17e0f1ded2a97a1aed15
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/07/2021
ms.locfileid: "106998237"
---
# <a name="name-resolution-configuration-and-installation"></a><span data-ttu-id="086ae-103">名稱解析設定和安裝</span><span class="sxs-lookup"><span data-stu-id="086ae-103">Name Resolution Configuration and Installation</span></span>

<span data-ttu-id="086ae-104">為了讓命名空間提供者能夠透過 Windows 通訊端存取，它必須正確安裝在系統上，並向 Windows 通訊端註冊。</span><span class="sxs-lookup"><span data-stu-id="086ae-104">In order for a namespace provider to be accessible through Windows Sockets it must be properly installed on the system and registered with Windows Sockets.</span></span> <span data-ttu-id="086ae-105">藉由叫用廠商的安裝程式來安裝命名空間提供者時，必須將設定資訊新增至設定資料庫，以提供 Ws2 \_32.dll 有關服務提供者的必要資訊。</span><span class="sxs-lookup"><span data-stu-id="086ae-105">When a namespace provider is installed by invoking a vendor's installation program, configuration information must be added to a configuration database to give the Ws2\_32.dll required information regarding the service provider.</span></span> <span data-ttu-id="086ae-106">Ws2 \_32.dll 會匯出 [**WSCInstallNameSpace**](/windows/desktop/api/Ws2spi/nf-ws2spi-wscinstallnamespace) ，供廠商的安裝程式使用。</span><span class="sxs-lookup"><span data-stu-id="086ae-106">The Ws2\_32.dll exports [**WSCInstallNameSpace**](/windows/desktop/api/Ws2spi/nf-ws2spi-wscinstallnamespace) for the vendor's installation program to use.</span></span> <span data-ttu-id="086ae-107">此函式是用來提供要安裝之服務提供者的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="086ae-107">This function is used to supply relevant information about the service provider to be installed.</span></span> <span data-ttu-id="086ae-108">此資訊包括：</span><span class="sxs-lookup"><span data-stu-id="086ae-108">This information includes:</span></span>

-   <span data-ttu-id="086ae-109">提供者名稱—表示在主控台中顯示之提供者的字串。</span><span class="sxs-lookup"><span data-stu-id="086ae-109">Provider Name — A string representing the provider for display in Control Panel.</span></span>
-   <span data-ttu-id="086ae-110">提供者版本-此提供者的版本。</span><span class="sxs-lookup"><span data-stu-id="086ae-110">Provider Version — The version of this provider.</span></span>
-   <span data-ttu-id="086ae-111">提供者路徑-提供者 DLL 的路徑名稱。</span><span class="sxs-lookup"><span data-stu-id="086ae-111">Provider Path — A path name to the provider DLL.</span></span>
-   <span data-ttu-id="086ae-112">命名空間：提供者所支援的命名空間。</span><span class="sxs-lookup"><span data-stu-id="086ae-112">Namespace — The namespace supported by the provider.</span></span>
-   <span data-ttu-id="086ae-113">提供者 GUID-代表此提供者/命名空間組合的唯一廠商提供數位。</span><span class="sxs-lookup"><span data-stu-id="086ae-113">Provider GUID — A unique, vendor-supplied number representing this provider/namespace combination.</span></span> <span data-ttu-id="086ae-114">這會用來做為此提供者的所有後續參考，以及卸載的索引鍵。</span><span class="sxs-lookup"><span data-stu-id="086ae-114">This is used as a key for all subsequent references to this provider, and for uninstall.</span></span> <span data-ttu-id="086ae-115">這些值是使用 Uuidgen.exe 公用程式所建立。</span><span class="sxs-lookup"><span data-stu-id="086ae-115">These values are created using the Uuidgen.exe utility.</span></span>
-   <span data-ttu-id="086ae-116">儲存所有旗標—此旗標指出這個命名空間提供者是否將負責保留所有服務類別的所有服務類別架構資訊。</span><span class="sxs-lookup"><span data-stu-id="086ae-116">Stores all flags — a flag indicating whether this namespace provider will be responsible for retaining all service class schema information for all service classes.</span></span> <span data-ttu-id="086ae-117">如果有這類提供者，Ws2 \_32.dll 就不需要查詢每個個別的命名空間提供者來取得這項資訊。</span><span class="sxs-lookup"><span data-stu-id="086ae-117">If such a provider exists, the Ws2\_32.dll does not need to query each individual namespace provider for this information.</span></span>

<span data-ttu-id="086ae-118">在 Windows Vista 和更新版本上，提供了增強的 [**WSCInstallNameSpaceEx32**](/windows/desktop/api/Ws2spi/nf-ws2spi-wscinstallnamespaceex32) 函式，可讓命名空間提供者傳遞特定于命名空間的額外資料 blob。</span><span class="sxs-lookup"><span data-stu-id="086ae-118">On Windows Vista and later, an enhanced [**WSCInstallNameSpaceEx32**](/windows/desktop/api/Ws2spi/nf-ws2spi-wscinstallnamespaceex32) function is provided that allows the namespace provider to pass an additional blob of data specific to the namespace.</span></span>

<span data-ttu-id="086ae-119">在64位平臺上，會提供類似的 [**WSCInstallNameSpace32**](/windows/desktop/api/Ws2spi/nf-ws2spi-wscinstallnamespace32) 和 [**WSCInstallNameSpaceEx32**](/windows/desktop/api/Ws2spi/nf-ws2spi-wscinstallnamespaceex32) 功能，以在32位目錄中安裝命名空間。</span><span class="sxs-lookup"><span data-stu-id="086ae-119">On 64-bit platforms, similar [**WSCInstallNameSpace32**](/windows/desktop/api/Ws2spi/nf-ws2spi-wscinstallnamespace32) and [**WSCInstallNameSpaceEx32**](/windows/desktop/api/Ws2spi/nf-ws2spi-wscinstallnamespaceex32) functions are provided to install a namespace in the 32-bit catalog.</span></span>

<span data-ttu-id="086ae-120">Ws2 \_32.dll 也提供一個函式 [**WSCUnInstallNameSpace**](/windows/desktop/api/Ws2spi/nf-ws2spi-wscuninstallnamespace)，供廠商的卸載程式從設定資料庫移除所有相關資訊。</span><span class="sxs-lookup"><span data-stu-id="086ae-120">The Ws2\_32.dll also provides a function, [**WSCUnInstallNameSpace**](/windows/desktop/api/Ws2spi/nf-ws2spi-wscuninstallnamespace), for a vendor's deinstallation program to remove all the relevant information from the configuration database.</span></span> <span data-ttu-id="086ae-121">這項設定資訊的確切位置和格式對 Ws232.dll 是私 \_ 用的，而且只能由上述的函式來操作。</span><span class="sxs-lookup"><span data-stu-id="086ae-121">The exact location and format of this configuration information is private to the Ws2\_32.dll, and can only be manipulated by the above-mentioned functions.</span></span>

<span data-ttu-id="086ae-122">在64位平臺上，會提供類似的 [**WSCInstallNameSpace32**](/windows/desktop/api/Ws2spi/nf-ws2spi-wscinstallnamespace32) 函式來卸載32位目錄中的命名空間。</span><span class="sxs-lookup"><span data-stu-id="086ae-122">On 64-bit platforms, a similar [**WSCInstallNameSpace32**](/windows/desktop/api/Ws2spi/nf-ws2spi-wscinstallnamespace32) function is provided to uninstall a namespace in the 32-bit catalog.</span></span>

<span data-ttu-id="086ae-123">在任何時間點，都會將命名空間提供者視為使用中或非作用中，並透過 [**WSCEnableNSProvider**](/windows/desktop/api/Ws2spi/nf-ws2spi-wscenablensprovider) 和 [**WSCEnableNSProvider32**](/windows/desktop/api/Ws2spi/nf-ws2spi-wscenablensprovider32) 函式來控制此設定。</span><span class="sxs-lookup"><span data-stu-id="086ae-123">At any point, an namespace provider is considered to be either active or inactive, with this setting controlled through the [**WSCEnableNSProvider**](/windows/desktop/api/Ws2spi/nf-ws2spi-wscenablensprovider) and [**WSCEnableNSProvider32**](/windows/desktop/api/Ws2spi/nf-ws2spi-wscenablensprovider32) functions.</span></span> <span data-ttu-id="086ae-124">當使用 [**WSAEnumNameSpaceProviders**](/windows/desktop/api/Winsock2/nf-winsock2-wsaenumnamespaceprovidersa)、 [**WSAEnumNameSpaceProvidersEx**](/windows/desktop/api/Winsock2/nf-winsock2-wsaenumnamespaceprovidersexa)、 [**WSCEnumNameSpaceProviders32**](/windows/desktop/api/Ws2spi/nf-ws2spi-wscenumnamespaceproviders32)和) [**WSCEnumNameSpaceProvidersEx32**](/windows/desktop/api/Ws2spi/nf-ws2spi-wscenumnamespaceprovidersex32) 函式來列舉 (時，仍會繼續顯示非作用中的命名空間提供者，但是 Ws2 \_32.dll 不會將任何查詢或服務註冊作業路由傳送給這些提供者。</span><span class="sxs-lookup"><span data-stu-id="086ae-124">Namespace providers that are inactive continue to show up when enumerated (using the [**WSAEnumNameSpaceProviders**](/windows/desktop/api/Winsock2/nf-winsock2-wsaenumnamespaceprovidersa), [**WSAEnumNameSpaceProvidersEx**](/windows/desktop/api/Winsock2/nf-winsock2-wsaenumnamespaceprovidersexa), [**WSCEnumNameSpaceProviders32**](/windows/desktop/api/Ws2spi/nf-ws2spi-wscenumnamespaceproviders32), and [**WSCEnumNameSpaceProvidersEx32**](/windows/desktop/api/Ws2spi/nf-ws2spi-wscenumnamespaceprovidersex32) functions), but the Ws2\_32.dll will not route any query or service registration operations to these providers.</span></span> <span data-ttu-id="086ae-125">如果有多個已安裝的命名空間提供者可以支援指定的命名空間，這項功能就很有用。</span><span class="sxs-lookup"><span data-stu-id="086ae-125">This capability can be useful in situations where more than one of the installed namespace providers can support a given namespace.</span></span>

<span data-ttu-id="086ae-126">當單一 API 函式中參考多個命名空間提供者時，不會指定將查詢和註冊作業路由傳送至命名空間提供者的順序。</span><span class="sxs-lookup"><span data-stu-id="086ae-126">When multiple namespace providers are referenced in a single API function, the order in which the order in which the queries and registration operations are routed to namespace providers is unspecified.</span></span> <span data-ttu-id="086ae-127">順序與命名空間提供者的安裝順序無關。</span><span class="sxs-lookup"><span data-stu-id="086ae-127">The order is unrelated to the order in which namespace providers are installed.</span></span> <span data-ttu-id="086ae-128">有兩種方式可以控制要使用哪一個命名空間提供者來解析名稱查詢。</span><span class="sxs-lookup"><span data-stu-id="086ae-128">There are two ways to control which namespace providers are used to resolve a name query.</span></span> <span data-ttu-id="086ae-129">首先， [**WSCEnableNSProvider**](/windows/desktop/api/Ws2spi/nf-ws2spi-wscenablensprovider) 和 [**WSCEnableNSProvider32**](/windows/desktop/api/Ws2spi/nf-ws2spi-wscenablensprovider32) 函數可用來以整個電腦的持續方式來啟用和停用命名空間。</span><span class="sxs-lookup"><span data-stu-id="086ae-129">First, the [**WSCEnableNSProvider**](/windows/desktop/api/Ws2spi/nf-ws2spi-wscenablensprovider) and [**WSCEnableNSProvider32**](/windows/desktop/api/Ws2spi/nf-ws2spi-wscenablensprovider32) functions can be used to enable and disable namespaces in a computer-wide, persistent way.</span></span> <span data-ttu-id="086ae-130">第二，應用程式可以藉由指定提供者的識別 GUID 作為查詢的一部分，將個別查詢導向至特定的提供者。</span><span class="sxs-lookup"><span data-stu-id="086ae-130">Second, applications can direct an individual query to a particular provider by specifying that provider's identifying GUID as part of the query.</span></span>

 

 



