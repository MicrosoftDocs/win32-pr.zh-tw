---
description: 在下列情況中，multipoint 通訊端的特性通常是藉由在兩個平面中的其中一個 (控制項或資料) 來描述其角色。
ms.assetid: 35e4a8c9-d943-44b8-be61-605b60a6cf5d
title: 用於聯結 Multipoint 葉的 SPI 語義
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: aa0e77203e5405f6cb820baba5d545de03e3a8ce
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/08/2021
ms.locfileid: "107001390"
---
# <a name="spi-semantics-for-joining-multipoint-leaves"></a><span data-ttu-id="dc000-103">用於聯結 Multipoint 葉的 SPI 語義</span><span class="sxs-lookup"><span data-stu-id="dc000-103">SPI Semantics for Joining Multipoint Leaves</span></span>

<span data-ttu-id="dc000-104">在下列情況中，multipoint 通訊端的特性通常是藉由在兩個平面中的其中一個 (控制項或資料) 來描述其角色。</span><span class="sxs-lookup"><span data-stu-id="dc000-104">In the following, a multipoint socket is frequently characterized by describing its role in one of the two planes (control or data).</span></span> <span data-ttu-id="dc000-105">您應該瞭解這個相同的通訊端在另一個平面中具有角色，但不會提及這項功能，以便讓參考保持簡短。</span><span class="sxs-lookup"><span data-stu-id="dc000-105">It should be understood that this same socket has a role in the other plane, but this is not mentioned in order to keep the references short.</span></span> <span data-ttu-id="dc000-106">例如，c \_ 根通訊端的參考可以參考 c \_ 根/d \_ 根或 c \_ 根/d 分 \_ 葉通訊端。</span><span class="sxs-lookup"><span data-stu-id="dc000-106">For example a reference to a c\_root socket could refer to either a c\_root/d\_root or a c\_root/d\_leaf socket.</span></span>

<span data-ttu-id="dc000-107">在根控制項平面配置中，會以兩種不同的方式，將新的分葉節點新增至多點會話。</span><span class="sxs-lookup"><span data-stu-id="dc000-107">In rooted control plane schemes, new leaf nodes are added to a multipoint session in one or both of two different ways.</span></span> <span data-ttu-id="dc000-108">在第一個方法中，根目錄會使用 [**WSPJoinLeaf**](/windows/desktop/api/Ws2spi/nc-ws2spi-lpwspjoinleaf) 來起始與分葉節點的連接，並邀請它成為參與者。</span><span class="sxs-lookup"><span data-stu-id="dc000-108">In the first method, the root uses [**WSPJoinLeaf**](/windows/desktop/api/Ws2spi/nc-ws2spi-lpwspjoinleaf) to initiate a connection with a leaf node and invite it to become a participant.</span></span> <span data-ttu-id="dc000-109">在分葉節點上，對等應用程式必須已建立 c 分 \_ 葉通訊端，並使用 [**WSPListen**](/previous-versions/windows/hardware/network/ff566297(v=vs.85)) 將它設定為接聽模式。</span><span class="sxs-lookup"><span data-stu-id="dc000-109">On the leaf node, the peer application must have created a c\_leaf socket and used [**WSPListen**](/previous-versions/windows/hardware/network/ff566297(v=vs.85)) to set it into listen mode.</span></span> <span data-ttu-id="dc000-110">\_當受邀加入會話時，分葉節點將會收到 FD 接受指示，並藉由呼叫 [**WSPAccept**](/windows/desktop/api/Ws2spi/nc-ws2spi-lpwspaccept)來指示其聯結意願。</span><span class="sxs-lookup"><span data-stu-id="dc000-110">The leaf node will receive an FD\_ACCEPT indication when invited to join the session, and signals its willingness to join by calling [**WSPAccept**](/windows/desktop/api/Ws2spi/nc-ws2spi-lpwspaccept).</span></span> <span data-ttu-id="dc000-111">當聯結作業完成時，根應用程式將會收到 FD \_ 連接指示。</span><span class="sxs-lookup"><span data-stu-id="dc000-111">The root application will receive an FD\_CONNECT indication when the join operation has been completed.</span></span>

<span data-ttu-id="dc000-112">在第二個方法中，角色基本上是反向的。</span><span class="sxs-lookup"><span data-stu-id="dc000-112">In the second method, the roles are essentially reversed.</span></span> <span data-ttu-id="dc000-113">根用戶端會建立 c \_ 根通訊端，並將其設定為接聽模式。</span><span class="sxs-lookup"><span data-stu-id="dc000-113">The root client creates a c\_root socket and sets it into listen mode.</span></span> <span data-ttu-id="dc000-114">希望加入會話的分葉節點會建立 c 分 \_ 葉通訊端，並使用 [**WSPJoinLeaf**](/windows/desktop/api/Ws2spi/nc-ws2spi-lpwspjoinleaf) 來起始連接和要求進場。</span><span class="sxs-lookup"><span data-stu-id="dc000-114">A leaf node wishing to join the session creates a c\_leaf socket and uses [**WSPJoinLeaf**](/windows/desktop/api/Ws2spi/nc-ws2spi-lpwspjoinleaf) to initiate the connection and request admittance.</span></span> <span data-ttu-id="dc000-115">\_當傳入的進場要求抵達時，根用戶端會收到 FD 接受，並藉由呼叫 [**WSPAccept**](/windows/desktop/api/Ws2spi/nc-ws2spi-lpwspaccept)來認可分葉節點。</span><span class="sxs-lookup"><span data-stu-id="dc000-115">The root client receives FD\_ACCEPT when an incoming admittance request arrives, and admits the leaf node by calling [**WSPAccept**](/windows/desktop/api/Ws2spi/nc-ws2spi-lpwspaccept).</span></span> <span data-ttu-id="dc000-116">當分葉節點 \_ 被許可時，會收到 FD CONNECT。</span><span class="sxs-lookup"><span data-stu-id="dc000-116">The leaf node receives FD\_CONNECT when it has been admitted.</span></span>

<span data-ttu-id="dc000-117">在 nonrooted 控制平面中，如果所有節點都是 c \_ 葉子，則會使用 [**WSPJoinLeaf**](/windows/desktop/api/Ws2spi/nc-ws2spi-lpwspjoinleaf) 函式來起始將節點加入現有的 multipoint 會話中。</span><span class="sxs-lookup"><span data-stu-id="dc000-117">In a nonrooted control plane, where all nodes are c\_leafs, the [**WSPJoinLeaf**](/windows/desktop/api/Ws2spi/nc-ws2spi-lpwspjoinleaf) function is used to initiate the inclusion of a node into an existing multipoint session.</span></span> <span data-ttu-id="dc000-118">\_當聯結已完成，且傳回的通訊端描述項可在 multipoint 會話中使用時，就會提供 FD 連接指示。</span><span class="sxs-lookup"><span data-stu-id="dc000-118">An FD\_CONNECT indication is provided when the join has been completed and the returned socket descriptor is usable in the multipoint session.</span></span> <span data-ttu-id="dc000-119">在 IP 多播的案例中，這會對應至 IP \_ 新增 \_ 成員資格通訊端選項。</span><span class="sxs-lookup"><span data-stu-id="dc000-119">In the case of IP multicast, this would correspond to the IP\_ADD\_MEMBERSHIP socket option.</span></span>

<span data-ttu-id="dc000-120">因此，用戶端會使用 [**WSPJoinLeaf**](/windows/desktop/api/Ws2spi/nc-ws2spi-lpwspjoinleaf)的三個實例：</span><span class="sxs-lookup"><span data-stu-id="dc000-120">There are, therefore, three instances where a client would use [**WSPJoinLeaf**](/windows/desktop/api/Ws2spi/nc-ws2spi-lpwspjoinleaf):</span></span>

-   <span data-ttu-id="dc000-121">作為 multipoint 根，並邀請新的分葉加入會話。</span><span class="sxs-lookup"><span data-stu-id="dc000-121">Acting as a multipoint root and inviting a new leaf to join the session.</span></span>
-   <span data-ttu-id="dc000-122">做為對根 multipoint 會話提出進場要求的分葉。</span><span class="sxs-lookup"><span data-stu-id="dc000-122">Acting as a leaf making an admittance request to a rooted multipoint session.</span></span>
-   <span data-ttu-id="dc000-123">作為搜尋進場至 nonrooted multipoint 會話的分葉 (例如 IP 多播。 ) </span><span class="sxs-lookup"><span data-stu-id="dc000-123">Acting as a leaf seeking admittance to a nonrooted multipoint session (for example, IP multicast.)</span></span>

 

 
