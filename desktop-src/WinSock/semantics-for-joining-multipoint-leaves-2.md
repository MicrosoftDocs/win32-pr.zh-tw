---
description: 在下列情況中，multipoint 通訊端的描述通常是在兩個平面中的其中一個 (控制項或資料) 中定義其角色。
ms.assetid: 34f639e2-9363-4f3f-a8de-b7c5d12618c9
title: 聯結 Multipoint 離開的語義
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: df12683838fbad89f717b08d7a19802f24556761
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/07/2021
ms.locfileid: "106982358"
---
# <a name="semantics-for-joining-multipoint-leaves"></a><span data-ttu-id="1ad2e-103">聯結 Multipoint 離開的語義</span><span class="sxs-lookup"><span data-stu-id="1ad2e-103">Semantics for Joining Multipoint Leaves</span></span>

<span data-ttu-id="1ad2e-104">在下列情況中，multipoint 通訊端的描述通常是在兩個平面中的其中一個 (控制項或資料) 中定義其角色。</span><span class="sxs-lookup"><span data-stu-id="1ad2e-104">In the following, a multipoint socket is frequently described by defining its role in one of the two planes (control or data).</span></span> <span data-ttu-id="1ad2e-105">您應該瞭解這個相同的通訊端在另一個平面中具有角色，但不會提及這項功能，以便讓參考保持簡短。</span><span class="sxs-lookup"><span data-stu-id="1ad2e-105">It should be understood that this same socket has a role in the other plane, but this is not mentioned in order to keep the references short.</span></span> <span data-ttu-id="1ad2e-106">例如，當對 "c \_ 根通訊端" 進行參考時，這可以是 c \_ 根/d \_ 根或 c \_ 根/d 分 \_ 葉通訊端。</span><span class="sxs-lookup"><span data-stu-id="1ad2e-106">For example when a reference is made to a "c\_root socket", this could be either a c\_root/d\_root or a c\_root/d\_leaf socket.</span></span>

<span data-ttu-id="1ad2e-107">在根控制項平面配置中，會以兩種不同的方式，將新的分葉節點新增至多點會話。</span><span class="sxs-lookup"><span data-stu-id="1ad2e-107">In rooted control plane schemes, new leaf nodes are added to a multipoint session in one or both of two different ways.</span></span> <span data-ttu-id="1ad2e-108">在第一個方法中，根目錄會使用 [**WSAJoinLeaf**](/windows/desktop/api/Winsock2/nf-winsock2-wsajoinleaf) 來起始與分葉節點的連接，並邀請它成為參與者。</span><span class="sxs-lookup"><span data-stu-id="1ad2e-108">In the first method, the root uses [**WSAJoinLeaf**](/windows/desktop/api/Winsock2/nf-winsock2-wsajoinleaf) to initiate a connection with a leaf node and to invite it to become a participant.</span></span> <span data-ttu-id="1ad2e-109">在分葉節點上，對等應用程式必須已建立 c 分 \_ 葉通訊端，並使用 [**接聽**](/windows/desktop/api/Winsock2/nf-winsock2-listen) 將它設定為接聽模式。</span><span class="sxs-lookup"><span data-stu-id="1ad2e-109">On the leaf node, the peer application must have created a c\_leaf socket and used [**listen**](/windows/desktop/api/Winsock2/nf-winsock2-listen) to set it into listen mode.</span></span> <span data-ttu-id="1ad2e-110">\_當受邀加入會話時，分葉節點會收到 FD 接受指示，並透過呼叫 [**WSAAccept**](/windows/desktop/api/Winsock2/nf-winsock2-wsaaccept)來指示其聯結意願。</span><span class="sxs-lookup"><span data-stu-id="1ad2e-110">The leaf node receives an FD\_ACCEPT indication when invited to join the session, and signals its willingness to join by calling [**WSAAccept**](/windows/desktop/api/Winsock2/nf-winsock2-wsaaccept).</span></span> <span data-ttu-id="1ad2e-111">當聯結作業完成時，根應用程式就會收到 FD \_ 連接指示。 </span><span class="sxs-lookup"><span data-stu-id="1ad2e-111">The root application then receives an FD\_CONNECT indication when the **join** operation has been completed.</span></span>

<span data-ttu-id="1ad2e-112">在第二個方法中，角色基本上是反向的。</span><span class="sxs-lookup"><span data-stu-id="1ad2e-112">In the second method, the roles are essentially reversed.</span></span> <span data-ttu-id="1ad2e-113">根應用程式會建立 c \_ 根通訊端，並將它設定為接聽模式。</span><span class="sxs-lookup"><span data-stu-id="1ad2e-113">The root application creates a c\_root socket and sets it into listen mode.</span></span> <span data-ttu-id="1ad2e-114">希望加入會話的分葉節點會建立 c 分 \_ 葉通訊端，並使用 [**WSAJoinLeaf**](/windows/desktop/api/Winsock2/nf-winsock2-wsajoinleaf) 來起始連接和要求進場。</span><span class="sxs-lookup"><span data-stu-id="1ad2e-114">A leaf node wishing to join the session creates a c\_leaf socket and uses [**WSAJoinLeaf**](/windows/desktop/api/Winsock2/nf-winsock2-wsajoinleaf) to initiate the connection and request admittance.</span></span> <span data-ttu-id="1ad2e-115">\_當傳入的進場要求抵達時，根應用程式會收到 FD 接受，並藉由呼叫 [**WSAAccept**](/windows/desktop/api/Winsock2/nf-winsock2-wsaaccept)來認可分葉節點。</span><span class="sxs-lookup"><span data-stu-id="1ad2e-115">The root application receives FD\_ACCEPT when an incoming admittance request arrives, and admits the leaf node by calling [**WSAAccept**](/windows/desktop/api/Winsock2/nf-winsock2-wsaaccept).</span></span> <span data-ttu-id="1ad2e-116">當分葉節點 \_ 被許可時，會收到 FD CONNECT。</span><span class="sxs-lookup"><span data-stu-id="1ad2e-116">The leaf node receives FD\_CONNECT when it has been admitted.</span></span>

<span data-ttu-id="1ad2e-117">在 nonrooted 控制平面中，如果所有節點都是 c 分 \_ 葉，則會使用 [**WSAJoinLeaf**](/windows/desktop/api/Winsock2/nf-winsock2-wsajoinleaf) 來起始將節點加入現有的 multipoint 會話中。</span><span class="sxs-lookup"><span data-stu-id="1ad2e-117">In a nonrooted control plane, where all nodes are c\_leaf's, the [**WSAJoinLeaf**](/windows/desktop/api/Winsock2/nf-winsock2-wsajoinleaf) is used to initiate the inclusion of a node into an existing multipoint session.</span></span> <span data-ttu-id="1ad2e-118">\_當聯結已完成，且傳回的通訊端描述項可在 multipoint 會話中使用時，就會提供 FD 連接指示。</span><span class="sxs-lookup"><span data-stu-id="1ad2e-118">An FD\_CONNECT indication is provided when the join has been completed and the returned socket descriptor is usable in the multipoint session.</span></span> <span data-ttu-id="1ad2e-119">在 IP 多播的案例中，這會對應至 IP \_ 新增 \_ 成員資格通訊端選項。</span><span class="sxs-lookup"><span data-stu-id="1ad2e-119">In the case of IP multicast, this would correspond to the IP\_ADD\_MEMBERSHIP socket option.</span></span>

<span data-ttu-id="1ad2e-120">如果您熟悉 IP 多播使用無連接 UDP 通訊協定的 (讀者，可能會擔心此處提供的連接導向語義。</span><span class="sxs-lookup"><span data-stu-id="1ad2e-120">(Readers familiar with IP multicast's use of the connectionless UDP protocol may be concerned by the connection-oriented semantics presented here.</span></span> <span data-ttu-id="1ad2e-121">尤其是在 UDP 通訊端上使用 [**WSAJoinLeaf**](/windows/desktop/api/Winsock2/nf-winsock2-wsajoinleaf) 並等候 FD 連接指示的概念 \_ 可能會麻煩。</span><span class="sxs-lookup"><span data-stu-id="1ad2e-121">In particular the notion of using [**WSAJoinLeaf**](/windows/desktop/api/Winsock2/nf-winsock2-wsajoinleaf) on a UDP socket and waiting for an FD\_CONNECT indication may be troubling.</span></span> <span data-ttu-id="1ad2e-122">但是，將連接導向的語義套用至不需連線的通訊協定有很大的引用。</span><span class="sxs-lookup"><span data-stu-id="1ad2e-122">There is, however, ample precedent for applying connection-oriented semantics to connectionless protocols.</span></span> <span data-ttu-id="1ad2e-123">它是允許的，有時也很有用，例如在 UDP 通訊端上叫用標準 [**connect**](/windows/desktop/api/Winsock2/nf-winsock2-connect) 函式。</span><span class="sxs-lookup"><span data-stu-id="1ad2e-123">It is allowed and sometimes useful, for example, to invoke the standard [**connect**](/windows/desktop/api/Winsock2/nf-winsock2-connect) function on a UDP socket.</span></span> <span data-ttu-id="1ad2e-124">將連接導向的語義套用至無連接通訊端的一般結果是這類通訊端的使用方式的限制，而這也是這種情況。</span><span class="sxs-lookup"><span data-stu-id="1ad2e-124">The general result of applying connection-oriented semantics to connectionless sockets is a restriction in how such sockets may be used, and this is the case here, as well.</span></span> <span data-ttu-id="1ad2e-125">**WSAJoinLeaf** 中使用的 UDP 通訊端將會有某些限制，並等候 FD \_ 連接指示 (在此案例中，只是表示已傳送對應的 IGMP 訊息) 這種限制。 ) </span><span class="sxs-lookup"><span data-stu-id="1ad2e-125">A UDP socket used in **WSAJoinLeaf** will have certain restrictions, and waiting for an FD\_CONNECT indication (which in this case simply indicates that the corresponding IGMP message has been sent) is one such limitation.)</span></span>

<span data-ttu-id="1ad2e-126">因此，應用程式會使用 [**WSAJoinLeaf**](/windows/desktop/api/Winsock2/nf-winsock2-wsajoinleaf) 作為下列三個實例：</span><span class="sxs-lookup"><span data-stu-id="1ad2e-126">There are therefore, three instances where an application would use [**WSAJoinLeaf**](/windows/desktop/api/Winsock2/nf-winsock2-wsajoinleaf) acting as a:</span></span>

-   <span data-ttu-id="1ad2e-127">Multipoint 根和邀請新分葉加入會話</span><span class="sxs-lookup"><span data-stu-id="1ad2e-127">Multipoint root and inviting a new leaf to join the session</span></span>
-   <span data-ttu-id="1ad2e-128">對根 multipoint 會話提出進場要求的分葉</span><span class="sxs-lookup"><span data-stu-id="1ad2e-128">Leaf making an admittance request to a rooted multipoint session</span></span>
-   <span data-ttu-id="1ad2e-129">搜尋進場至 nonrooted multipoint 會話的分葉 (例如 IP 多播) </span><span class="sxs-lookup"><span data-stu-id="1ad2e-129">Leaf seeking admittance to a nonrooted multipoint session (for example, IP multicast)</span></span>

 

 



