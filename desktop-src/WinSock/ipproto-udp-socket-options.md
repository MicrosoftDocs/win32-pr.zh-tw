---
description: 下表描述適用于為 \_ IPv4 和 IPv6 位址系列建立之通訊端的 IPPROTO UDP 通訊端選項 (AF \_ INET 和 AF INET6) ，並將 \_ protocol 參數提供給指定為 udp (IPPROTO \_ udp) 的 socket 函數。
ms.assetid: 579448a1-22af-488f-a1f5-97ba69a15524
title: IPPROTO_UDP 通訊端選項
ms.topic: article
ms.date: 10/02/2019
ms.openlocfilehash: 6f1f25ebae34d7db4290ab23bbf799fc0e0b68df
ms.sourcegitcommit: c8ec1ded1ffffc364d3c4f560bb2171da0dc5040
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 03/22/2021
ms.locfileid: "106977487"
---
# <a name="ipproto_udp-socket-options"></a><span data-ttu-id="00567-103">IPPROTO \_ UDP 通訊端選項</span><span class="sxs-lookup"><span data-stu-id="00567-103">IPPROTO\_UDP socket options</span></span>

<span data-ttu-id="00567-104">下表描述適用于為 IPv4 和 IPv6 位址系列建立之通訊端的 **IPPROTO \_ UDP** 通訊端選項 (AF \_ INET 和 AF INET6) ，並將 \_ *PROTOCOL* 參數提供給指定為 udp (IPPROTO udp) 的 [**socket**](/windows/win32/api/Winsock2/nf-winsock2-socket) 函數 \_ 。</span><span class="sxs-lookup"><span data-stu-id="00567-104">The following table describes **IPPROTO\_UDP** socket options that apply to sockets created for the IPv4 and IPv6 address families (AF\_INET and AF\_INET6) with the *protocol* parameter to the [**socket**](/windows/win32/api/Winsock2/nf-winsock2-socket) function specified as UDP (IPPROTO\_UDP).</span></span> <span data-ttu-id="00567-105">如需取得和設定通訊端選項的詳細資訊，請參閱 [**getsockopt**](/windows/win32/api/winsock/nf-winsock-getsockopt) 和 [**setsockopt**](/windows/win32/api/winsock/nf-winsock-setsockopt) 函數參考頁面。</span><span class="sxs-lookup"><span data-stu-id="00567-105">See the [**getsockopt**](/windows/win32/api/winsock/nf-winsock-getsockopt) and [**setsockopt**](/windows/win32/api/winsock/nf-winsock-setsockopt) function reference pages for more information on getting and setting socket options.</span></span>

<span data-ttu-id="00567-106">若要列舉通訊協定，並針對每個已安裝的通訊協定探索支援的屬性，請使用 [**WSAEnumProtocols**](/windows/win32/api/Winsock2/nf-winsock2-wsaenumprotocolsa)、 [**WSCEnumProtocols**](/windows/win32/api/Ws2spi/nf-ws2spi-wscenumprotocols)或 [**WSCEnumProtocols32**](/windows/win32/api/Ws2spi/nf-ws2spi-wscenumprotocols32) 函數。</span><span class="sxs-lookup"><span data-stu-id="00567-106">To enumerate protocols and discover supported properties for each installed protocol, use the [**WSAEnumProtocols**](/windows/win32/api/Winsock2/nf-winsock2-wsaenumprotocolsa), [**WSCEnumProtocols**](/windows/win32/api/Ws2spi/nf-ws2spi-wscenumprotocols), or [**WSCEnumProtocols32**](/windows/win32/api/Ws2spi/nf-ws2spi-wscenumprotocols32) function.</span></span>

## <a name="options"></a><span data-ttu-id="00567-107">選項。</span><span class="sxs-lookup"><span data-stu-id="00567-107">Options</span></span>

| <span data-ttu-id="00567-108">選項</span><span class="sxs-lookup"><span data-stu-id="00567-108">Option</span></span> | <span data-ttu-id="00567-109">Get</span><span class="sxs-lookup"><span data-stu-id="00567-109">Get</span></span> | <span data-ttu-id="00567-110">設定</span><span class="sxs-lookup"><span data-stu-id="00567-110">Set</span></span> | <span data-ttu-id="00567-111">Optval 類型</span><span class="sxs-lookup"><span data-stu-id="00567-111">Optval type</span></span> | <span data-ttu-id="00567-112">Description</span><span class="sxs-lookup"><span data-stu-id="00567-112">Description</span></span> |
|-|-|-|-|-|
| <span data-ttu-id="00567-113">UDP 總和 \_ 檢查碼 \_ 涵蓋範圍 (ws2tcpip .h) </span><span class="sxs-lookup"><span data-stu-id="00567-113">UDP\_CHECKSUM\_COVERAGE (ws2tcpip.h)</span></span> | <span data-ttu-id="00567-114">是</span><span class="sxs-lookup"><span data-stu-id="00567-114">yes</span></span> | <span data-ttu-id="00567-115">是</span><span class="sxs-lookup"><span data-stu-id="00567-115">yes</span></span> | <span data-ttu-id="00567-116">DWORD (布林值) </span><span class="sxs-lookup"><span data-stu-id="00567-116">DWORD (boolean)</span></span> | <span data-ttu-id="00567-117">若 **為 TRUE**，則會使用總和檢查碼傳送 UDP 資料包。</span><span class="sxs-lookup"><span data-stu-id="00567-117">When **TRUE**, UDP datagrams are sent with a checksum.</span></span> |
| <span data-ttu-id="00567-118">UDP \_ NOCHECKSUM (ws2tcpip .h) </span><span class="sxs-lookup"><span data-stu-id="00567-118">UDP\_NOCHECKSUM (ws2tcpip.h)</span></span> | <span data-ttu-id="00567-119">是</span><span class="sxs-lookup"><span data-stu-id="00567-119">yes</span></span> | <span data-ttu-id="00567-120">是</span><span class="sxs-lookup"><span data-stu-id="00567-120">yes</span></span> | <span data-ttu-id="00567-121">DWORD (布林值) </span><span class="sxs-lookup"><span data-stu-id="00567-121">DWORD (boolean)</span></span> | <span data-ttu-id="00567-122">若 **為 TRUE**，則會傳送 UDP 資料包，且總和檢查碼為零。</span><span class="sxs-lookup"><span data-stu-id="00567-122">When **TRUE**, UDP datagrams are sent with the checksum of zero.</span></span> <span data-ttu-id="00567-123">服務提供者所需。</span><span class="sxs-lookup"><span data-stu-id="00567-123">Required for service providers.</span></span> <span data-ttu-id="00567-124">如果服務提供者沒有可停用 UDP 總和檢查碼計算的機制，則可以直接儲存此選項，而不需要採取任何動作。</span><span class="sxs-lookup"><span data-stu-id="00567-124">If a service provider does not have a mechanism to disable UDP checksum calculation, it may simply store this option without taking any action.</span></span> <span data-ttu-id="00567-125">IPv6 不支援此選項。</span><span class="sxs-lookup"><span data-stu-id="00567-125">This option is not supported for IPv6.</span></span> |
| <span data-ttu-id="00567-126">UDP_RECV_MAX_COALESCED_SIZE (ws2ipdef .h;包含 ws2tcpip .h) </span><span class="sxs-lookup"><span data-stu-id="00567-126">UDP_RECV_MAX_COALESCED_SIZE (ws2ipdef.h; include ws2tcpip.h)</span></span> | <span data-ttu-id="00567-127">是</span><span class="sxs-lookup"><span data-stu-id="00567-127">yes</span></span> | <span data-ttu-id="00567-128">是</span><span class="sxs-lookup"><span data-stu-id="00567-128">yes</span></span> | <span data-ttu-id="00567-129">DWORD</span><span class="sxs-lookup"><span data-stu-id="00567-129">DWORD</span></span> | <span data-ttu-id="00567-130">當設定為非零值時，多個接收的資料包可能會在向您的應用程式表示之前，合併成單一訊息緩衝區。</span><span class="sxs-lookup"><span data-stu-id="00567-130">When set to a non-zero value, multiple received datagrams may be coalesced into a single message buffer before being indicated to your application.</span></span> <span data-ttu-id="00567-131">選項值代表可對您的應用程式表示的合併訊息之訊息大小上限（以位元組為單位）。</span><span class="sxs-lookup"><span data-stu-id="00567-131">The option value represents the maximum message size in bytes for coalesced messages that can be indicated to your application.</span></span> <span data-ttu-id="00567-132">可能仍會指出大於選項值的未合併訊息。</span><span class="sxs-lookup"><span data-stu-id="00567-132">Un-coalesced messages larger than the option value may still be indicated.</span></span> <span data-ttu-id="00567-133">預設值為 0 (沒有聯合) 。</span><span class="sxs-lookup"><span data-stu-id="00567-133">The default value is 0 (no coalescing).</span></span> <span data-ttu-id="00567-134">只有當資料包源自相同的來源位址和埠時，才會合並。</span><span class="sxs-lookup"><span data-stu-id="00567-134">Datagrams will only be coalesced if they originated from the same source address and port.</span></span> <span data-ttu-id="00567-135">所有結合的資料包都會具有相同的大小 &mdash; ，但最後一個資料包可能較小。</span><span class="sxs-lookup"><span data-stu-id="00567-135">All datagrams coalesced will be of the same size&mdash;except the last datagram, which may be smaller.</span></span> <span data-ttu-id="00567-136">如果您的應用程式想要抓取資料包大小 (除了最後一個資料包（可能不同) ）之外，您必須使用支援控制資訊的接收 API (例如 [**LPFN_WSARECVMSG (WSARECVMSG)**](/windows/win32/api/mswsock/nc-mswsock-lpfn_wsarecvmsg)) 。</span><span class="sxs-lookup"><span data-stu-id="00567-136">If your application wants to retrieve the datagram sizes (except the last datagram, which may differ) that were coalesced, you must use a receive API that supports control information (such as [**LPFN_WSARECVMSG (WSARecvMsg)**](/windows/win32/api/mswsock/nc-mswsock-lpfn_wsarecvmsg)).</span></span> <span data-ttu-id="00567-137">除了最後一則訊息的大小，可以在 **UDP_COALESCED_INFO** control 訊息中找到，其類型為 DWORD。</span><span class="sxs-lookup"><span data-stu-id="00567-137">The size of all but the last message can be found in the **UDP_COALESCED_INFO** control message, which is of type DWORD.</span></span> <span data-ttu-id="00567-138">針對型別安全，您的應用程式應該使用 [WSAGetUdpRecvMaxCoalescedSize](/windows/win32/api/ws2tcpip/nf-ws2tcpip-wsagetudprecvmaxcoalescedsize) 和 [WSASetUdpRecvMaxCoalescedSize](/windows/win32/api/ws2tcpip/nf-ws2tcpip-wsasetudprecvmaxcoalescedsize) 函式，而不是直接使用通訊端選項。</span><span class="sxs-lookup"><span data-stu-id="00567-138">For type safety, your application should use the [WSAGetUdpRecvMaxCoalescedSize](/windows/win32/api/ws2tcpip/nf-ws2tcpip-wsagetudprecvmaxcoalescedsize) and [WSASetUdpRecvMaxCoalescedSize](/windows/win32/api/ws2tcpip/nf-ws2tcpip-wsasetudprecvmaxcoalescedsize) functions instead of the socket option directly.</span></span> |
| <span data-ttu-id="00567-139">UDP_SEND_MSG_SIZE (ws2ipdef .h;包含 ws2tcpip .h) </span><span class="sxs-lookup"><span data-stu-id="00567-139">UDP_SEND_MSG_SIZE (ws2ipdef.h; include ws2tcpip.h)</span></span> | <span data-ttu-id="00567-140">是</span><span class="sxs-lookup"><span data-stu-id="00567-140">yes</span></span> | <span data-ttu-id="00567-141">是</span><span class="sxs-lookup"><span data-stu-id="00567-141">yes</span></span> | <span data-ttu-id="00567-142">DWORD</span><span class="sxs-lookup"><span data-stu-id="00567-142">DWORD</span></span> | <span data-ttu-id="00567-143">當設定為非零值時，網路堆疊會將您的應用程式傳送的緩衝區細分為多個訊息。</span><span class="sxs-lookup"><span data-stu-id="00567-143">When set to a non-zero value, buffers sent by your application are broken down into multiple messages by the networking stack.</span></span> <span data-ttu-id="00567-144">選項值代表每個細分訊息的大小。</span><span class="sxs-lookup"><span data-stu-id="00567-144">The option value represents the size of each broken-down message.</span></span> <span data-ttu-id="00567-145">選項值以位元組表示。</span><span class="sxs-lookup"><span data-stu-id="00567-145">The option value is represented in bytes.</span></span> <span data-ttu-id="00567-146">最後一個區段的大小可能小於選項的值。</span><span class="sxs-lookup"><span data-stu-id="00567-146">The last segment's size may be less than the value of the option.</span></span> <span data-ttu-id="00567-147">預設值為 0 (沒有分割) 。</span><span class="sxs-lookup"><span data-stu-id="00567-147">The default value is 0 (no segmentation).</span></span> <span data-ttu-id="00567-148">您的應用程式應該將值設定為低於目的地 () s 的路徑的 MTU，以避免 IP 片段。</span><span class="sxs-lookup"><span data-stu-id="00567-148">Your application should set a value that is lower than the MTU of the path to the destination(s) in order to avoid IP fragmentation.</span></span> <span data-ttu-id="00567-149">針對型別安全，您的應用程式應該使用 [WSAGetUdpSendMessageSize](/windows/win32/api/ws2tcpip/nf-ws2tcpip-wsagetudpsendmessagesize) 和 [WSASetUdpSendMessageSize](/windows/win32/api/ws2tcpip/nf-ws2tcpip-wsasetudpsendmessagesize) 函式，而不是直接使用通訊端選項。</span><span class="sxs-lookup"><span data-stu-id="00567-149">For type safety, your application should use the [WSAGetUdpSendMessageSize](/windows/win32/api/ws2tcpip/nf-ws2tcpip-wsagetudpsendmessagesize) and [WSASetUdpSendMessageSize](/windows/win32/api/ws2tcpip/nf-ws2tcpip-wsasetudpsendmessagesize) functions instead of the socket option directly.</span></span> |

## <a name="legacy-windows-support-for-ipproto_udp-options"></a><span data-ttu-id="00567-150">IPPROTO UDP 選項的舊版 Windows 支援 \_</span><span class="sxs-lookup"><span data-stu-id="00567-150">Legacy Windows support for IPPROTO\_UDP options</span></span>

<span data-ttu-id="00567-151">**UDP \_在 \_** windows 2000 和 windows NT4 上無法使用總和檢查碼涵蓋範圍。</span><span class="sxs-lookup"><span data-stu-id="00567-151">**UDP\_CHECKSUM\_COVERAGE** is unavailable on Windows 2000 and on Windows NT4.</span></span> <span data-ttu-id="00567-152">**UDP \_Windows \_** 9X/Me 無法使用總和檢查碼涵蓋範圍和 **UDP \_ NOCHECKSUM** 。</span><span class="sxs-lookup"><span data-stu-id="00567-152">**UDP\_CHECKSUM\_COVERAGE** and **UDP\_NOCHECKSUM** are unavailable on Windows 9x/Me.</span></span> 

## <a name="remarks"></a><span data-ttu-id="00567-153">備註</span><span class="sxs-lookup"><span data-stu-id="00567-153">Remarks</span></span>

<span data-ttu-id="00567-154">在 Windows Vista 和更新版本的 Microsoft Windows 軟體開發套件 (SDK) 發行時，標頭檔的組織已變更，且 **IPPROTO \_ UDP** 層級定義于 *Ws2def .h* 標頭檔中，該檔案會自動包含在 *Winsock2* 標頭檔中。</span><span class="sxs-lookup"><span data-stu-id="00567-154">On the Microsoft Windows Software Development Kit (SDK) released for Windows Vista and later, the organization of header files has changed and **IPPROTO\_UDP** level is defined in the *Ws2def.h* header file which is automatically included in the *Winsock2.h* header file.</span></span> <span data-ttu-id="00567-155">**IPPROTO \_ UDP** 通訊端選項定義于 *Ws2tcpip .h* 標頭檔中。</span><span class="sxs-lookup"><span data-stu-id="00567-155">The **IPPROTO\_UDP** socket options are defined in the *Ws2tcpip.h* header file.</span></span> <span data-ttu-id="00567-156">不應直接使用 *Ws2def* 標頭檔。</span><span class="sxs-lookup"><span data-stu-id="00567-156">The *Ws2def.h* header file should never be used directly.</span></span>

## <a name="requirements"></a><span data-ttu-id="00567-157">規格需求</span><span class="sxs-lookup"><span data-stu-id="00567-157">Requirements</span></span>

| <span data-ttu-id="00567-158">需求</span><span class="sxs-lookup"><span data-stu-id="00567-158">Requirement</span></span> | <span data-ttu-id="00567-159">值</span><span class="sxs-lookup"><span data-stu-id="00567-159">Value</span></span> |
|-|-|
| <span data-ttu-id="00567-160">標頭</span><span class="sxs-lookup"><span data-stu-id="00567-160">Header</span></span><br/> | <dl> <span data-ttu-id="00567-161">ws2ipdef (<dt>在 Windows Server 2003、WINDOWS XP 及 windows 2000 上</dt><dt>包含) ws2tcpip 和 ws2tcpip</dt> 。h</span><span class="sxs-lookup"><span data-stu-id="00567-161"><dt>ws2ipdef.h (include ws2tcpip.h), and ws2tcpip.h</dt> <dt>Winsock2.h on Windows Server 2003, Windows XP, and Windows 2000</dt></span></span> </dl> |
