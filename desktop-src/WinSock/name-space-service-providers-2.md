---
description: 命名空間提供者會在 Winsock 命名空間 SPI 和現有名稱服務的原生程式設計介面（例如 DNS、X 500 或 NetWare 目錄服務 (NDS) ）之間，執行介面對應。
ms.assetid: 9b35aa58-9011-4e0d-8c93-02714952b4a5
title: 命名空間服務提供者
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 4e975c7ad0e5df29910624bb8f0b9d94fd24d9b8
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/07/2021
ms.locfileid: "106970420"
---
# <a name="namespace-service-providers"></a><span data-ttu-id="fa985-103">命名空間服務提供者</span><span class="sxs-lookup"><span data-stu-id="fa985-103">Namespace Service Providers</span></span>

<span data-ttu-id="fa985-104">命名空間提供者會在 Winsock 命名空間 SPI 和現有名稱服務的原生程式設計介面（例如 DNS、X 500 或 NetWare 目錄服務 (NDS) ）之間，執行介面對應。</span><span class="sxs-lookup"><span data-stu-id="fa985-104">A namespace provider implements an interface mapping between the Winsock namespace SPI and the native programmatic interface of an existing name service such as DNS, X.500, or NetWare Directory Services (NDS).</span></span> <span data-ttu-id="fa985-105">雖然命名空間提供者只支援一個命名空間，但是有可能會安裝指定命名空間的多個提供者。</span><span class="sxs-lookup"><span data-stu-id="fa985-105">While a namespace provider supports exactly one namespace, it is possible for multiple providers for a given namespace to be installed.</span></span> <span data-ttu-id="fa985-106">單一 DLL 也有可能建立多個命名空間提供者的實例。</span><span class="sxs-lookup"><span data-stu-id="fa985-106">It is also possible for a single DLL to create an instance of multiple namespace providers.</span></span> <span data-ttu-id="fa985-107">安裝命名空間提供者時，會維護 [**WSANAMESPACE \_ 資訊**](/windows/desktop/api/Winsock2/ns-winsock2-wsanamespace_infow) 結構的目錄。</span><span class="sxs-lookup"><span data-stu-id="fa985-107">As namespace providers are installed, a catalog of [**WSANAMESPACE\_INFO**](/windows/desktop/api/Winsock2/ns-winsock2-wsanamespace_infow) structures is maintained.</span></span> <span data-ttu-id="fa985-108">應用程式可能會使用 [**WSAEnumNameSpaceProviders**](/windows/desktop/api/Winsock2/nf-winsock2-wsaenumnamespaceprovidersa) 來找出電腦支援的命名空間。</span><span class="sxs-lookup"><span data-stu-id="fa985-108">An application may use [**WSAEnumNameSpaceProviders**](/windows/desktop/api/Winsock2/nf-winsock2-wsaenumnamespaceprovidersa) to discover which namespaces are supported on a computer.</span></span>

<span data-ttu-id="fa985-109">在 Windows Vista 和更新版本上，提供了增強的 [**WSANAMESPACE \_ INFOEX**](/windows/desktop/api/Winsock2/ns-winsock2-wsanamespace_infoexw) 結構和 [**WSAEnumNameSpaceProvidersEx**](/windows/desktop/api/Winsock2/nf-winsock2-wsaenumnamespaceprovidersexa) 函數。</span><span class="sxs-lookup"><span data-stu-id="fa985-109">On Windows Vista and later, an enhanced [**WSANAMESPACE\_INFOEX**](/windows/desktop/api/Winsock2/ns-winsock2-wsanamespace_infoexw) structure and [**WSAEnumNameSpaceProvidersEx**](/windows/desktop/api/Winsock2/nf-winsock2-wsaenumnamespaceprovidersexa) function are provided.</span></span>

<span data-ttu-id="fa985-110">在64位平臺上，會提供類似的 [**WSCEnumNameSpaceProviders32**](/windows/desktop/api/Ws2spi/nf-ws2spi-wscenumnamespaceproviders32) 和 [**WSCEnumNameSpaceProvidersEx32**](/windows/desktop/api/Ws2spi/nf-ws2spi-wscenumnamespaceprovidersex32) 函數來列舉32位目錄。</span><span class="sxs-lookup"><span data-stu-id="fa985-110">On 64-bit platforms, similar [**WSCEnumNameSpaceProviders32**](/windows/desktop/api/Ws2spi/nf-ws2spi-wscenumnamespaceproviders32) and [**WSCEnumNameSpaceProvidersEx32**](/windows/desktop/api/Ws2spi/nf-ws2spi-wscenumnamespaceprovidersex32) functions are provided to enumerate the 32-bit catalog.</span></span>

<span data-ttu-id="fa985-111">如需詳細資訊，請參閱 [Winsock 命名空間服務提供者需求](winsock-namespace-service-provider-requirements.md) 。</span><span class="sxs-lookup"><span data-stu-id="fa985-111">Refer to [Winsock Namespace Service Provider Requirements](winsock-namespace-service-provider-requirements.md) for detailed information.</span></span>

## <a name="legacy-getxbyy-service-providers"></a><span data-ttu-id="fa985-112">舊版 GetXbyY 服務提供者</span><span class="sxs-lookup"><span data-stu-id="fa985-112">Legacy GetXbyY Service Providers</span></span>

<span data-ttu-id="fa985-113">Windows 通訊端2完全支援在 Windows 通訊端1.1 版中找到的 TCP/IP 特定名稱解析功能。</span><span class="sxs-lookup"><span data-stu-id="fa985-113">Windows Sockets 2 fully supports the TCP/IP-specific name resolution facilities found in Windows Sockets version 1.1.</span></span> <span data-ttu-id="fa985-114">它會藉由在 SPI 中包含一組 **GetXbyY** 函式來完成這項工作。</span><span class="sxs-lookup"><span data-stu-id="fa985-114">It does this by including the set of **GetXbyY** functions in the SPI.</span></span> <span data-ttu-id="fa985-115">不過，這組函式的處理方式與 SPI 函式的其餘部分有些不同。</span><span class="sxs-lookup"><span data-stu-id="fa985-115">However, the treatment of this set of functions is somewhat different from the rest of the SPI functions.</span></span> <span data-ttu-id="fa985-116">SPI 中出現的 **GetXbyY** 函式會以 GETXBYYSP 開頭 \_ ，並在下表中摘要說明。</span><span class="sxs-lookup"><span data-stu-id="fa985-116">The **GetXbyY** functions appearing in the SPI are prefaced with GETXBYYSP\_, and are summarized in the following table.</span></span>

<span data-ttu-id="fa985-117">Berkeley 樣式函數</span><span class="sxs-lookup"><span data-stu-id="fa985-117">Berkeley Style Functions</span></span>



| <span data-ttu-id="fa985-118">SPI 函式名稱</span><span class="sxs-lookup"><span data-stu-id="fa985-118">SPI function name</span></span>           | <span data-ttu-id="fa985-119">Description</span><span class="sxs-lookup"><span data-stu-id="fa985-119">Description</span></span>                                                                              |
|-----------------------------|------------------------------------------------------------------------------------------|
| <span data-ttu-id="fa985-120">GETXBYYSP \_ gethostbyaddr</span><span class="sxs-lookup"><span data-stu-id="fa985-120">GETXBYYSP\_gethostbyaddr</span></span>    | <span data-ttu-id="fa985-121">為指定的主機位址提供 [**hostent**](/windows/desktop/api/winsock/ns-winsock-hostent) 結構。</span><span class="sxs-lookup"><span data-stu-id="fa985-121">Supplies a [**hostent**](/windows/desktop/api/winsock/ns-winsock-hostent) structure for the specified host address.</span></span>        |
| <span data-ttu-id="fa985-122">GETXBYYSP \_ gethostbyname</span><span class="sxs-lookup"><span data-stu-id="fa985-122">GETXBYYSP\_gethostbyname</span></span>    | <span data-ttu-id="fa985-123">提供指定之主機名稱的 [**hostent**](/windows/desktop/api/winsock/ns-winsock-hostent) 結構。</span><span class="sxs-lookup"><span data-stu-id="fa985-123">Supplies a [**hostent**](/windows/desktop/api/winsock/ns-winsock-hostent) structure for the specified host name.</span></span>           |
| <span data-ttu-id="fa985-124">GETXBYYSP \_ getprotobyname</span><span class="sxs-lookup"><span data-stu-id="fa985-124">GETXBYYSP\_getprotobyname</span></span>   | <span data-ttu-id="fa985-125">提供指定之通訊協定名稱的 [**protoent**](/windows/desktop/api/winsock/ns-winsock-protoent) 結構。</span><span class="sxs-lookup"><span data-stu-id="fa985-125">Supplies a [**protoent**](/windows/desktop/api/winsock/ns-winsock-protoent) structure for the specified protocol name.</span></span>     |
| <span data-ttu-id="fa985-126">GETXBYYSP \_ getprotobynumber</span><span class="sxs-lookup"><span data-stu-id="fa985-126">GETXBYYSP\_getprotobynumber</span></span> | <span data-ttu-id="fa985-127">為指定的通訊協定編號提供 [**protoent**](/windows/desktop/api/winsock/ns-winsock-protoent) 結構。</span><span class="sxs-lookup"><span data-stu-id="fa985-127">Supplies a [**protoent**](/windows/desktop/api/winsock/ns-winsock-protoent) structure for the specified protocol number.</span></span>   |
| <span data-ttu-id="fa985-128">GETXBYYSP \_ getservbyname</span><span class="sxs-lookup"><span data-stu-id="fa985-128">GETXBYYSP\_getservbyname</span></span>    | <span data-ttu-id="fa985-129">為指定的服務提供 [**servent**](/windows/desktop/api/winsock/ns-winsock-servent) 結構，例如 e。</span><span class="sxs-lookup"><span data-stu-id="fa985-129">Supplies a [**servent**](/windows/desktop/api/winsock/ns-winsock-servent) structure for the specified service nam.e</span></span>        |
| <span data-ttu-id="fa985-130">GETXBYYSP \_ getservbyport</span><span class="sxs-lookup"><span data-stu-id="fa985-130">GETXBYYSP\_getservbyport</span></span>    | <span data-ttu-id="fa985-131">在指定的埠上提供服務的 [**servent**](/windows/desktop/api/winsock/ns-winsock-servent) 結構。</span><span class="sxs-lookup"><span data-stu-id="fa985-131">Supplies a [**servent**](/windows/desktop/api/winsock/ns-winsock-servent) structure for the service at the specified port.</span></span> |
| <span data-ttu-id="fa985-132">GETXBYYSP \_ gethostname</span><span class="sxs-lookup"><span data-stu-id="fa985-132">GETXBYYSP\_gethostname</span></span>      | <span data-ttu-id="fa985-133">傳回本機電腦的標準主機名稱。</span><span class="sxs-lookup"><span data-stu-id="fa985-133">Returns the standard host name for the local computer.</span></span>                                   |



 

<span data-ttu-id="fa985-134">非同步樣式函數</span><span class="sxs-lookup"><span data-stu-id="fa985-134">Async Style Functions</span></span>



| <span data-ttu-id="fa985-135">SPI 函式名稱</span><span class="sxs-lookup"><span data-stu-id="fa985-135">SPI function name</span></span>                   | <span data-ttu-id="fa985-136">Description</span><span class="sxs-lookup"><span data-stu-id="fa985-136">Description</span></span>                                                                              |
|-------------------------------------|------------------------------------------------------------------------------------------|
| <span data-ttu-id="fa985-137">GETXBYYSP \_ WSAAsyncGetHostByAddr</span><span class="sxs-lookup"><span data-stu-id="fa985-137">GETXBYYSP\_WSAAsyncGetHostByAddr</span></span>    | <span data-ttu-id="fa985-138">為指定的主機位址提供 [**hostent**](/windows/desktop/api/winsock/ns-winsock-hostent) 結構。</span><span class="sxs-lookup"><span data-stu-id="fa985-138">Supplies a [**hostent**](/windows/desktop/api/winsock/ns-winsock-hostent) structure for the specified host address.</span></span>        |
| <span data-ttu-id="fa985-139">GETXBYYSP \_ WSAAsyncGetHostByName</span><span class="sxs-lookup"><span data-stu-id="fa985-139">GETXBYYSP\_WSAAsyncGetHostByName</span></span>    | <span data-ttu-id="fa985-140">提供指定之主機名稱的 [**hostent**](/windows/desktop/api/winsock/ns-winsock-hostent) 結構。</span><span class="sxs-lookup"><span data-stu-id="fa985-140">Supplies a [**hostent**](/windows/desktop/api/winsock/ns-winsock-hostent) structure for the specified host name.</span></span>           |
| <span data-ttu-id="fa985-141">GETXBYYSP \_ WSAAsyncGetProtoByName</span><span class="sxs-lookup"><span data-stu-id="fa985-141">GETXBYYSP\_WSAAsyncGetProtoByName</span></span>   | <span data-ttu-id="fa985-142">提供指定之通訊協定名稱的 [**protoent**](/windows/desktop/api/winsock/ns-winsock-protoent) 結構。</span><span class="sxs-lookup"><span data-stu-id="fa985-142">Supplies a [**protoent**](/windows/desktop/api/winsock/ns-winsock-protoent) structure for the specified protocol name.</span></span>     |
| <span data-ttu-id="fa985-143">GETXBYYSP \_ WSAAsyncGetProtoByNumber</span><span class="sxs-lookup"><span data-stu-id="fa985-143">GETXBYYSP\_WSAAsyncGetProtoByNumber</span></span> | <span data-ttu-id="fa985-144">為指定的通訊協定編號提供 [**protoent**](/windows/desktop/api/winsock/ns-winsock-protoent) 結構。</span><span class="sxs-lookup"><span data-stu-id="fa985-144">Supplies a [**protoent**](/windows/desktop/api/winsock/ns-winsock-protoent) structure for the specified protocol number.</span></span>   |
| <span data-ttu-id="fa985-145">GETXBYYSP \_ WSAAsyncGetServByName</span><span class="sxs-lookup"><span data-stu-id="fa985-145">GETXBYYSP\_WSAAsyncGetServByName</span></span>    | <span data-ttu-id="fa985-146">提供指定服務名稱的 [**servent**](/windows/desktop/api/winsock/ns-winsock-servent) 結構。</span><span class="sxs-lookup"><span data-stu-id="fa985-146">Supplies a [**servent**](/windows/desktop/api/winsock/ns-winsock-servent) structure for the specified service name.</span></span>        |
| <span data-ttu-id="fa985-147">GETXBYYSP \_ WSAAsyncGetServByPort</span><span class="sxs-lookup"><span data-stu-id="fa985-147">GETXBYYSP\_WSAAsyncGetServByPort</span></span>    | <span data-ttu-id="fa985-148">在指定的埠上提供服務的 [**servent**](/windows/desktop/api/winsock/ns-winsock-servent) 結構。</span><span class="sxs-lookup"><span data-stu-id="fa985-148">Supplies a [**servent**](/windows/desktop/api/winsock/ns-winsock-servent) structure for the service at the specified port.</span></span> |
| <span data-ttu-id="fa985-149">GETXBYYSP \_ WSACancelAsyncRequest</span><span class="sxs-lookup"><span data-stu-id="fa985-149">GETXBYYSP\_WSACancelAsyncRequest</span></span>    | <span data-ttu-id="fa985-150">取消非同步 **GetXbyY** 操作。</span><span class="sxs-lookup"><span data-stu-id="fa985-150">Cancels an asynchronous **GetXbyY** operation.</span></span>                                           |



 

<span data-ttu-id="fa985-151">SPI 中這些 **GetXbyY** 函式的語法和語義與在 API 規格中記載的語法和語法完全相同，因此不會在此處重複。</span><span class="sxs-lookup"><span data-stu-id="fa985-151">The syntax and semantics of these **GetXbyY** functions in the SPI are exactly the same as those documented in the API Specification and are, therefore, not repeated here.</span></span>

<span data-ttu-id="fa985-152">Windows 通訊端 2 DLL 只允許一個服務提供者提供這些服務。</span><span class="sxs-lookup"><span data-stu-id="fa985-152">The Windows Sockets 2 DLL allows exactly one service provider to offer these services.</span></span> <span data-ttu-id="fa985-153">因此，在啟動時，不需要在服務提供者所收到的程式資料表中包含這些函式的指標。</span><span class="sxs-lookup"><span data-stu-id="fa985-153">Therefore, there is no need to include pointers to these functions in the procedure table received from service providers at startup.</span></span> <span data-ttu-id="fa985-154">在 Windows 環境中，執行這些函式之 DLL 的路徑是從下列登錄路徑中找到的值取出。</span><span class="sxs-lookup"><span data-stu-id="fa985-154">In Windows environments the path to the DLL that implements these functions is retrieved from the value found in the following registry path.</span></span> <span data-ttu-id="fa985-155">此登錄專案預設不存在：</span><span class="sxs-lookup"><span data-stu-id="fa985-155">This registry entry does not exist by default:</span></span>

<span data-ttu-id="fa985-156">**HKEY \_LOCAL \_ MACHINE** \\ **System** \\ **CurrentControlSet** \\ **Services** \\ **WinSock2** \\ **參數** \\ **GetXByYLibraryPath**</span><span class="sxs-lookup"><span data-stu-id="fa985-156">**HKEY\_LOCAL\_MACHINE**\\**System**\\**CurrentControlSet**\\**Services**\\**WinSock2**\\**Parameters**\\**GetXByYLibraryPath**</span></span>

## <a name="built-in-default-getxbyy-service-provider"></a><span data-ttu-id="fa985-157">Built-In 預設 GetXbyY 服務提供者</span><span class="sxs-lookup"><span data-stu-id="fa985-157">Built-In Default GetXbyY Service Provider</span></span>

<span data-ttu-id="fa985-158">預設的 **GetXbyY** 服務提供者已整合到標準的 Windows 通訊端2執行時間元件中。</span><span class="sxs-lookup"><span data-stu-id="fa985-158">A default **GetXbyY** service provider is integrated into the standard Windows Sockets 2 run-time components.</span></span> <span data-ttu-id="fa985-159">這個預設提供者會執行上述所有的函式，因此這些函式不需要由任何命名空間提供者來執行。</span><span class="sxs-lookup"><span data-stu-id="fa985-159">This default provider implements all of the above functions, thus it is not required for these functions to be implemented by any namespace provider.</span></span> <span data-ttu-id="fa985-160">不過，命名空間提供者可自由提供任何或所有這些函式 (，因此只要儲存字串，就會覆寫預設) ，也就是在指示的登錄機碼中執行這些函式之 DLL 的路徑。</span><span class="sxs-lookup"><span data-stu-id="fa985-160">However, a namespace provider is free to provide any or all of these functions (and thus override the defaults) by simply storing the string which is the path to the DLL that implements these functions in the indicated registry key.</span></span> <span data-ttu-id="fa985-161">未由命名提供者 DLL 匯出的任何 **GetXbyY** 函數，都會透過內建預設值提供。</span><span class="sxs-lookup"><span data-stu-id="fa985-161">Any of the **GetXbyY** functions not exported by the named provider DLL will be supplied through the built-in defaults.</span></span> <span data-ttu-id="fa985-162">不過，請注意，如果提供者想要提供任何非同步版本的 **GetXbyY** 函式，則應該提供所有的非同步函式，讓取消作業可以正確運作。</span><span class="sxs-lookup"><span data-stu-id="fa985-162">Note, however, that if a provider elects to supply any of the async version of the **GetXbyY** functions, he should supply all of the async functions so that the cancel operation will work appropriately.</span></span>

<span data-ttu-id="fa985-163">預設 **GetXbyY** 服務提供者的目前實作為位於 Wsock32.dll 內。</span><span class="sxs-lookup"><span data-stu-id="fa985-163">The current implementation of the default **GetXbyY** service provider resides within the Wsock32.dll.</span></span> <span data-ttu-id="fa985-164">根據透過主控台建立 TCP/IP 設定的方式，將會使用 DNS 或本機主機檔案來進行名稱解析。</span><span class="sxs-lookup"><span data-stu-id="fa985-164">Depending on how the TCP/IP settings have been established through Control Panel, name resolution will occur using either DNS or local host files.</span></span> <span data-ttu-id="fa985-165">使用 DNS 時，預設 **GetXbyY** 服務提供者會使用標準 Windows 通訊端 1.1 API 呼叫來與 DNS 伺服器通訊。</span><span class="sxs-lookup"><span data-stu-id="fa985-165">When DNS is used, the default **GetXbyY** service provider uses standard Windows Sockets 1.1 API calls to communicate with the DNS server.</span></span> <span data-ttu-id="fa985-166">使用設定為預設 TCP/IP 堆疊的任何 TCP/IP 堆疊，就會發生這些交易。</span><span class="sxs-lookup"><span data-stu-id="fa985-166">These transactions will occur using whatever TCP/IP stack is configured as the default TCP/IP stack.</span></span> <span data-ttu-id="fa985-167">不過，有兩個特殊案例值得一提。</span><span class="sxs-lookup"><span data-stu-id="fa985-167">Two special cases however, deserve special mention.</span></span>

<span data-ttu-id="fa985-168">GETXBYYSP gethostname 的預設執行會從登錄取得 \_ 本機主機名稱。</span><span class="sxs-lookup"><span data-stu-id="fa985-168">The default implementation of GETXBYYSP\_gethostname obtains the local host name from the registry.</span></span> <span data-ttu-id="fa985-169">這會對應至指派給 "我的電腦" 的名稱。</span><span class="sxs-lookup"><span data-stu-id="fa985-169">This will correspond to the name assigned to "My Computer".</span></span> <span data-ttu-id="fa985-170">GETXBYYSP \_ gethostbyname 和 GETXBYYSP WSAAsyncGetHostByName 的預設實， \_ 一律會將提供的主機名稱與本機主機名稱進行比較。</span><span class="sxs-lookup"><span data-stu-id="fa985-170">The default implementation of GETXBYYSP\_gethostbyname and GETXBYYSP\_WSAAsyncGetHostByName always compares the supplied host name with the local host name.</span></span> <span data-ttu-id="fa985-171">如果兩者相符，則預設的執行會使用私用介面探查 Microsoft TCP/IP 堆疊，以便探索其本機 IP 位址。</span><span class="sxs-lookup"><span data-stu-id="fa985-171">If they match, the default implementation uses a private interface to probe the Microsoft TCP/IP stack in order to discover its local IP address.</span></span> <span data-ttu-id="fa985-172">因此，為了完全獨立于 Microsoft TCP/IP 堆疊，命名空間提供者必須同時執行 GETXBYYSP \_ gethostbyname 和 GETXBYYSP \_ WSAAsyncGetHostByName。</span><span class="sxs-lookup"><span data-stu-id="fa985-172">Thus, in order to be completely independent of the Microsoft TCP/IP stack, a namespace provider must implement both GETXBYYSP\_gethostbyname and GETXBYYSP\_WSAAsyncGetHostByName.</span></span>

 

 



