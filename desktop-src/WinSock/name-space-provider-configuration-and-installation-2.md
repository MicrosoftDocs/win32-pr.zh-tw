---
description: WSCEnableNSProviderWSCEnableNSProvider32WSCInstallNameSpaceWSCInstallNameSpace32WSCInstallNameSpaceExWSCInstallNameSpaceEx32WSCUnInstallNameSpaceWSCUnInstallNameSpace32WSCWriteNameSpaceOrderWSCWriteNameSpaceOrder32
ms.assetid: 3dd289fb-eebb-48b2-a887-eeb60322ab09
title: 命名空間提供者設定和安裝
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 1c87de8fee4ccaea0fb6978037e1e41684b56267
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/07/2021
ms.locfileid: "104511421"
---
# <a name="namespace-provider-configuration-and-installation"></a><span data-ttu-id="c331a-103">命名空間提供者設定和安裝</span><span class="sxs-lookup"><span data-stu-id="c331a-103">Namespace Provider Configuration and Installation</span></span>

-   [<span data-ttu-id="c331a-104">**WSCEnableNSProvider**</span><span class="sxs-lookup"><span data-stu-id="c331a-104">**WSCEnableNSProvider**</span></span>](/windows/desktop/api/Ws2spi/nf-ws2spi-wscenablensprovider)
-   [<span data-ttu-id="c331a-105">**WSCEnableNSProvider32**</span><span class="sxs-lookup"><span data-stu-id="c331a-105">**WSCEnableNSProvider32**</span></span>](/windows/desktop/api/Ws2spi/nf-ws2spi-wscenablensprovider32)
-   [<span data-ttu-id="c331a-106">**WSCInstallNameSpace**</span><span class="sxs-lookup"><span data-stu-id="c331a-106">**WSCInstallNameSpace**</span></span>](/windows/desktop/api/Ws2spi/nf-ws2spi-wscinstallnamespace)
-   [<span data-ttu-id="c331a-107">**WSCInstallNameSpace32**</span><span class="sxs-lookup"><span data-stu-id="c331a-107">**WSCInstallNameSpace32**</span></span>](/windows/desktop/api/Ws2spi/nf-ws2spi-wscinstallnamespace32)
-   [<span data-ttu-id="c331a-108">**WSCInstallNameSpaceEx**</span><span class="sxs-lookup"><span data-stu-id="c331a-108">**WSCInstallNameSpaceEx**</span></span>](/windows/desktop/api/Ws2spi/nf-ws2spi-wscinstallnamespaceex)
-   [<span data-ttu-id="c331a-109">**WSCInstallNameSpaceEx32**</span><span class="sxs-lookup"><span data-stu-id="c331a-109">**WSCInstallNameSpaceEx32**</span></span>](/windows/desktop/api/Ws2spi/nf-ws2spi-wscinstallnamespaceex32)
-   [<span data-ttu-id="c331a-110">**WSCUnInstallNameSpace**</span><span class="sxs-lookup"><span data-stu-id="c331a-110">**WSCUnInstallNameSpace**</span></span>](/windows/desktop/api/Ws2spi/nf-ws2spi-wscuninstallnamespace)
-   [<span data-ttu-id="c331a-111">**WSCUnInstallNameSpace32**</span><span class="sxs-lookup"><span data-stu-id="c331a-111">**WSCUnInstallNameSpace32**</span></span>](/windows/desktop/api/Ws2spi/nf-ws2spi-wscuninstallnamespace32)
-   [<span data-ttu-id="c331a-112">**WSCWriteNameSpaceOrder**</span><span class="sxs-lookup"><span data-stu-id="c331a-112">**WSCWriteNameSpaceOrder**</span></span>](/windows/desktop/api/Sporder/nf-sporder-wscwritenamespaceorder)
-   [<span data-ttu-id="c331a-113">**WSCWriteNameSpaceOrder32**</span><span class="sxs-lookup"><span data-stu-id="c331a-113">**WSCWriteNameSpaceOrder32**</span></span>](/windows/desktop/api/Sporder/nf-sporder-wscwritenamespaceorder32)

<span data-ttu-id="c331a-114">如先前所述，命名空間提供者的安裝應用程式必須呼叫 [**WSCInstallNameSpace**](/windows/desktop/api/Ws2spi/nf-ws2spi-wscinstallnamespace) 或 [**WSCInstallNameSpaceEx**](/windows/desktop/api/Ws2spi/nf-ws2spi-wscinstallnamespaceex) ，才能向 Ws2 \_32.dll 註冊，並提供靜態設定資訊。</span><span class="sxs-lookup"><span data-stu-id="c331a-114">As mentioned previously, the installation application for a namespace provider must call [**WSCInstallNameSpace**](/windows/desktop/api/Ws2spi/nf-ws2spi-wscinstallnamespace) or [**WSCInstallNameSpaceEx**](/windows/desktop/api/Ws2spi/nf-ws2spi-wscinstallnamespaceex) to register with the Ws2\_32.dll and supply static configuration information.</span></span> <span data-ttu-id="c331a-115">若要在64位平臺上安裝至32位目錄，命名空間提供者必須呼叫 [**WSCInstallNameSpace32**](/windows/desktop/api/Ws2spi/nf-ws2spi-wscinstallnamespace32) 或 [**WSCInstallNameSpaceEx32**](/windows/desktop/api/Ws2spi/nf-ws2spi-wscinstallnamespaceex32)。</span><span class="sxs-lookup"><span data-stu-id="c331a-115">To install into the 32-bit catalog on a 64-bit platform, the namespace provider must call [**WSCInstallNameSpace32**](/windows/desktop/api/Ws2spi/nf-ws2spi-wscinstallnamespace32) or [**WSCInstallNameSpaceEx32**](/windows/desktop/api/Ws2spi/nf-ws2spi-wscinstallnamespaceex32).</span></span> <span data-ttu-id="c331a-116">Ws2 \_32.dll 會使用這項資訊來完成其路由函式，以及其 [**WSAEnumNameSpaceProviders**](/windows/desktop/api/Winsock2/nf-winsock2-wsaenumnamespaceprovidersa) 和 [**WSAEnumNameSpaceProvidersEx**](/windows/desktop/api/Winsock2/nf-winsock2-wsaenumnamespaceprovidersexa)的實作為。</span><span class="sxs-lookup"><span data-stu-id="c331a-116">The Ws2\_32.dll uses this information to accomplish its routing function and in its implementation of [**WSAEnumNameSpaceProviders**](/windows/desktop/api/Winsock2/nf-winsock2-wsaenumnamespaceprovidersa) and [**WSAEnumNameSpaceProvidersEx**](/windows/desktop/api/Winsock2/nf-winsock2-wsaenumnamespaceprovidersexa).</span></span> <span data-ttu-id="c331a-117">[**WSCUnInstallNameSpace**](/windows/desktop/api/Ws2spi/nf-ws2spi-wscuninstallnamespace)函式是用來從登錄中移除命名空間提供者，而 [**WSCEnableNSProvider**](/windows/desktop/api/Ws2spi/nf-ws2spi-wscenablensprovider)函數是用來切換作用中和非作用中狀態之間的提供者。</span><span class="sxs-lookup"><span data-stu-id="c331a-117">The [**WSCUnInstallNameSpace**](/windows/desktop/api/Ws2spi/nf-ws2spi-wscuninstallnamespace) function is used to remove a namespace provider from the registry, and the [**WSCEnableNSProvider**](/windows/desktop/api/Ws2spi/nf-ws2spi-wscenablensprovider) function is used to toggle a provider between the active and inactive states.</span></span>

<span data-ttu-id="c331a-118">在64位平臺上， [**WSCUnInstallNameSpace32**](/windows/desktop/api/Ws2spi/nf-ws2spi-wscuninstallnamespace32) 和 [**WSCEnableNSProvider32**](/windows/desktop/api/Ws2spi/nf-ws2spi-wscenablensprovider32) 是處理32位目錄的類似函數。</span><span class="sxs-lookup"><span data-stu-id="c331a-118">On a 64-bit platform, [**WSCUnInstallNameSpace32**](/windows/desktop/api/Ws2spi/nf-ws2spi-wscuninstallnamespace32) and [**WSCEnableNSProvider32**](/windows/desktop/api/Ws2spi/nf-ws2spi-wscenablensprovider32) are similar functions to deal with the 32-bit catalog.</span></span>

<span data-ttu-id="c331a-119">目前已載入且正在執行的應用程式看不到這三項作業的結果。</span><span class="sxs-lookup"><span data-stu-id="c331a-119">The results of these three operations are not visible to applications that are currently loaded and running.</span></span> <span data-ttu-id="c331a-120">只有在這些作業發生之後才開始執行的應用程式才會受到影響。</span><span class="sxs-lookup"><span data-stu-id="c331a-120">Only applications that begin executing after these operations have occurred will be affected by them.</span></span>

<span data-ttu-id="c331a-121">此架構明確支援在單一 DLL 內具現化多個命名空間提供者，不過每個這類提供者都必須有唯一的命名空間提供者識別碼 (GUID) 配置，而且在64位平臺上的每個具現化 (都必須進行個別的 [**WSCInstallNameSpace**](/windows/desktop/api/Ws2spi/nf-ws2spi-wscinstallnamespace) 或 [**WSCInstallNameSpaceEx**](/windows/desktop/api/Ws2spi/nf-ws2spi-wscinstallnamespaceex) 呼叫，32位目錄的函式為 [**WSCInstallNameSpace32**](/windows/desktop/api/Ws2spi/nf-ws2spi-wscinstallnamespace32) 和 [**WSCInstallNameSpaceEx32**](/windows/desktop/api/Ws2spi/nf-ws2spi-wscinstallnamespaceex32)) 。</span><span class="sxs-lookup"><span data-stu-id="c331a-121">This architecture explicitly supports the instantiation of multiple namespace providers within a single DLL, however each such provider must have a unique namespace provider identifier (GUID) allocated, and a separate call to [**WSCInstallNameSpace**](/windows/desktop/api/Ws2spi/nf-ws2spi-wscinstallnamespace) or [**WSCInstallNameSpaceEx**](/windows/desktop/api/Ws2spi/nf-ws2spi-wscinstallnamespaceex) must occur for each instantiation (On 64-bit platforms, the functions for the 32-bit catalog are [**WSCInstallNameSpace32**](/windows/desktop/api/Ws2spi/nf-ws2spi-wscinstallnamespace32) and [**WSCInstallNameSpaceEx32**](/windows/desktop/api/Ws2spi/nf-ws2spi-wscinstallnamespaceex32)).</span></span> <span data-ttu-id="c331a-122">這類提供者可以決定要叫用的具現化，因為 (NSP) 識別碼的命名空間提供者會顯示為每個 NSP 函數中的參數。</span><span class="sxs-lookup"><span data-stu-id="c331a-122">Such a provider can determine which instantiation is being invoked because the namespace provider (NSP) identifier appears as a parameter in every NSP function.</span></span>

 

 



