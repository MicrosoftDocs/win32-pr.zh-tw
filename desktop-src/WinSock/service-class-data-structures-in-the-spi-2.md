---
description: 安裝新的服務類別時，必須備妥和提供 WSASERVICECLASSINFO 結構。 此結構也包含子結構，其中包含一系列適用于特定命名空間的參數。
ms.assetid: fb225e0c-a0c7-44e1-80fb-7b924b371afa
title: SPI 中的服務類別資料結構
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b5bf249c7437751e7c6d08b2fdf3830e92921ce7
ms.sourcegitcommit: 5b98bf8c68922f8f03c14f793fbe17504900559c
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 02/12/2021
ms.locfileid: "104554317"
---
# <a name="service-class-data-structures-in-the-spi"></a><span data-ttu-id="044e8-104">SPI 中的服務類別資料結構</span><span class="sxs-lookup"><span data-stu-id="044e8-104">Service Class Data Structures in the SPI</span></span>

<span data-ttu-id="044e8-105">安裝新的服務類別時，必須備妥和提供 [**WSASERVICECLASSINFO**](/windows/desktop/api/Winsock2/ns-winsock2-wsaserviceclassinfow) 結構。</span><span class="sxs-lookup"><span data-stu-id="044e8-105">When a new service class is installed, a [**WSASERVICECLASSINFO**](/windows/desktop/api/Winsock2/ns-winsock2-wsaserviceclassinfow) structure must be prepared and supplied.</span></span> <span data-ttu-id="044e8-106">此結構也包含子結構，其中包含一系列適用于特定命名空間的參數。</span><span class="sxs-lookup"><span data-stu-id="044e8-106">This structure also consists of substructures that contain a series of parameters that apply to specific namespaces.</span></span>

![此圖顯示適用于特定命名空間的 WSASERVICECLASSINFO 結構、子結構和參數。](images/ovrvw3-3.png)

<span data-ttu-id="044e8-108">每個服務類別都有一個 [**WSASERVICECLASSINFO**](/windows/desktop/api/Winsock2/ns-winsock2-wsaserviceclassinfow) 結構。</span><span class="sxs-lookup"><span data-stu-id="044e8-108">For each service class, there is a single [**WSASERVICECLASSINFO**](/windows/desktop/api/Winsock2/ns-winsock2-wsaserviceclassinfow) structure.</span></span> <span data-ttu-id="044e8-109">在 **WSASERVICECLASSINFO** 結構內，服務類別的唯一識別碼會包含在 **lpServiceClassId** 中，而 **lpServiceClassName** 會參考相關聯的顯示字串。</span><span class="sxs-lookup"><span data-stu-id="044e8-109">Within the **WSASERVICECLASSINFO** structure, the service class's unique identifier is contained in **lpServiceClassId**, and an associated display string is referenced by **lpServiceClassName**.</span></span>

<span data-ttu-id="044e8-110">[**WSASERVICECLASSINFO**](/windows/desktop/api/Winsock2/ns-winsock2-wsaserviceclassinfow)結構中的 **lpClassInfos** 成員會參考 [**WSANSCLASSINFO**](/windows/desktop/api/Winsock2/ns-winsock2-wsansclassinfow)結構的陣列，其中每個結構都會提供套用至指定命名空間的具名引數和具類型參數。</span><span class="sxs-lookup"><span data-stu-id="044e8-110">The **lpClassInfos** member in the [**WSASERVICECLASSINFO**](/windows/desktop/api/Winsock2/ns-winsock2-wsaserviceclassinfow) structure references an array of [**WSANSCLASSINFO**](/windows/desktop/api/Winsock2/ns-winsock2-wsansclassinfow) structures, each of which supplies a named and typed parameter that applies to a specified namespace.</span></span> <span data-ttu-id="044e8-111">**LpszName** 成員的值範例包括： SAPID、TCPPORT、UDPPORT 等等。這些字串通常是在 **dwNameSpace** 中所識別的命名空間特有。</span><span class="sxs-lookup"><span data-stu-id="044e8-111">Examples of values for the **lpszName** member include: SAPID, TCPPORT, UDPPORT, etc. These strings are generally specific to the namespace identified in **dwNameSpace**.</span></span> <span data-ttu-id="044e8-112">**DwValueType** 的一般值可能是 reg \_ DWORD、reg \_ SZ 等等。**DwValueSize** 成員會指出 **lpValue** 所指向之資料項目的長度。</span><span class="sxs-lookup"><span data-stu-id="044e8-112">Typical values for **dwValueType** might be REG\_DWORD, REG\_SZ, etc. The **dwValueSize** member indicates the length of the data item pointed to by **lpValue**.</span></span>

<span data-ttu-id="044e8-113">[**WSASERVICECLASSINFO**](/windows/desktop/api/Winsock2/ns-winsock2-wsaserviceclassinfow)結構中所表示的整個資料集合，都會透過 [**NSPInstallServiceClass**](/windows/desktop/api/Ws2spi/nc-ws2spi-lpnspinstallserviceclass)提供給每個命名空間提供者。</span><span class="sxs-lookup"><span data-stu-id="044e8-113">The entire collection of data represented in a [**WSASERVICECLASSINFO**](/windows/desktop/api/Winsock2/ns-winsock2-wsaserviceclassinfow) structure is provided to each namespace provider via [**NSPInstallServiceClass**](/windows/desktop/api/Ws2spi/nc-ws2spi-lpnspinstallserviceclass).</span></span> <span data-ttu-id="044e8-114">接著，每個個別的命名空間提供者會 sifts [**WSANSCLASSINFO**](/windows/desktop/api/Winsock2/ns-winsock2-wsansclassinfow) 結構的清單，並保留適用的資訊。</span><span class="sxs-lookup"><span data-stu-id="044e8-114">Each individual namespace provider then sifts through the list of [**WSANSCLASSINFO**](/windows/desktop/api/Winsock2/ns-winsock2-wsansclassinfow) structures and retain the information applicable to it.</span></span> <span data-ttu-id="044e8-115">此架構也構思了特殊命名空間提供者的未來存在，該提供者會保留所有命名空間的所有服務類別架構資訊。</span><span class="sxs-lookup"><span data-stu-id="044e8-115">This architecture also envisions the future existence of a special namespace provider that would retain all of the service class schema information for all of the namespaces.</span></span> <span data-ttu-id="044e8-116">Ws2 \_32.dll 會查詢此提供者，以在叫用 [**NSPLookupServiceBegin**](/windows/desktop/api/Ws2spi/nc-ws2spi-lpnsplookupservicebegin)叫用以起始查詢，以及叫用 [**NSPSetService**](/windows/desktop/api/Ws2spi/nc-ws2spi-lpnspsetservice)以註冊服務時，取得提供給命名空間提供者所需的 **WSASERVICECLASSINFO** 資料。</span><span class="sxs-lookup"><span data-stu-id="044e8-116">The Ws2\_32.dll would query this provider to obtain the **WSASERVICECLASSINFO** data needed to supply to namespace providers when [**NSPLookupServiceBegin**](/windows/desktop/api/Ws2spi/nc-ws2spi-lpnsplookupservicebegin) is invoked to initiate a query, and when [**NSPSetService**](/windows/desktop/api/Ws2spi/nc-ws2spi-lpnspsetservice) is invoked to register a service.</span></span> <span data-ttu-id="044e8-117">命名空間提供者不應依賴這項功能，而應該改為取得提供者特定的方法，以取得任何所需的服務類別架構資訊。</span><span class="sxs-lookup"><span data-stu-id="044e8-117">Namespace provider should not rely on this capability for the time being, and should instead have a provider-specific means to obtain any needed service class schema information.</span></span> <span data-ttu-id="044e8-118">如果沒有任何提供者儲存所有命名空間的所有服務類別架構，Ws2 \_32.dll 將會使用 [**NSPGetServiceClassInfo**](/windows/desktop/api/Ws2spi/nc-ws2spi-lpnspgetserviceclassinfo) ，從每個個別的命名空間提供者取得這類資訊。</span><span class="sxs-lookup"><span data-stu-id="044e8-118">In the absence of a provider that stores all service class schema for all namespaces, the Ws2\_32.dll will use [**NSPGetServiceClassInfo**](/windows/desktop/api/Ws2spi/nc-ws2spi-lpnspgetserviceclassinfo) to obtain such information from each individual namespace provider.</span></span>

 

 



