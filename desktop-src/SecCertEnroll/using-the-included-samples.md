---
description: '憑證註冊 API 包含多個範例，其設計目的是要協助您建立自訂應用程式。 大部分的範例都是使用 c + + 撰寫，但 c # 和 Visual Basic Scripting Edition (VBScript) 範例也包含在內。'
ms.assetid: 70ac7b75-542c-4d79-85ce-4b1bac414879
title: 使用包含的範例
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: bd3cbf17d35e65ade52e97438d638cbd4f1489e0
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/08/2021
ms.locfileid: "106985479"
---
# <a name="using-the-included-samples"></a><span data-ttu-id="f6765-104">使用包含的範例</span><span class="sxs-lookup"><span data-stu-id="f6765-104">Using the Included Samples</span></span>

<span data-ttu-id="f6765-105">憑證註冊 API 包含多個範例，其設計目的是要協助您建立自訂應用程式。</span><span class="sxs-lookup"><span data-stu-id="f6765-105">The Certificate Enrollment API includes multiple samples designed to help you create custom applications.</span></span> <span data-ttu-id="f6765-106">大部分的範例都是使用 c + + 撰寫，但 c # 和 Visual Basic Scripting Edition (VBScript) 範例也包含在內。</span><span class="sxs-lookup"><span data-stu-id="f6765-106">Most of the samples are written by using C++, but C# and Visual Basic Scripting Edition (VBScript) samples are also included.</span></span>

<span data-ttu-id="f6765-107">當您安裝 Microsoft Windows 軟體開發套件 (SDK) 時，預設會在 *% ProgramFiles%* \\ Microsoft sdk \\ Windows \\ 7.0 版 \\ 範例 \\ 安全性 \\ X509 憑證註冊 \\ 資料夾中安裝下列範例。</span><span class="sxs-lookup"><span data-stu-id="f6765-107">When you install the Microsoft Windows Software Development Kit (SDK), the following samples are installed, by default, in the *%ProgramFiles%*\\Microsoft SDKs\\Windows\\v7.0\\Samples\\Security\\X509 Certificate Enrollment\\ folder.</span></span>



| <span data-ttu-id="f6765-108">範例</span><span class="sxs-lookup"><span data-stu-id="f6765-108">Sample</span></span>                                                                 | <span data-ttu-id="f6765-109">描述</span><span class="sxs-lookup"><span data-stu-id="f6765-109">Description</span></span>                                                                                                                                                                                                                                                                                                                                                | <span data-ttu-id="f6765-110">語言</span><span class="sxs-lookup"><span data-stu-id="f6765-110">Language</span></span>            |
|------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------|
| [<span data-ttu-id="f6765-111">createCNGCustomCMC</span><span class="sxs-lookup"><span data-stu-id="f6765-111">createCNGCustomCMC</span></span>](createcngcustomcmc.md)                           | <span data-ttu-id="f6765-112">從內部的嵌套 PKCS 10 要求建立 CMC 要求物件 \# 。</span><span class="sxs-lookup"><span data-stu-id="f6765-112">Creates a CMC request object from an inner nested PKCS \#10 request.</span></span><br/>                                                                                                                                                                                                                                                                            | <span data-ttu-id="f6765-113">C++</span><span class="sxs-lookup"><span data-stu-id="f6765-113">C++</span></span><br/>      |
| [<span data-ttu-id="f6765-114">enrollCommon</span><span class="sxs-lookup"><span data-stu-id="f6765-114">enrollCommon</span></span>](enrollcommon.md)                                       | <span data-ttu-id="f6765-115">包含下列提供的範例所使用的 helper 函式和宏。</span><span class="sxs-lookup"><span data-stu-id="f6765-115">Contains the following helper functions and macros used by the included samples.</span></span><br/>                                                                                                                                                                                                                                                                | <span data-ttu-id="f6765-116">C++</span><span class="sxs-lookup"><span data-stu-id="f6765-116">C++</span></span><br/>      |
| [<span data-ttu-id="f6765-117">enrollCustomCMC</span><span class="sxs-lookup"><span data-stu-id="f6765-117">enrollCustomCMC</span></span>](enrollcustomcmc.md)                                 | <span data-ttu-id="f6765-118">建立 CMC 憑證要求，並在憑證階層中註冊電腦。</span><span class="sxs-lookup"><span data-stu-id="f6765-118">Creates a CMC certificate request and enrolls a computer in a certificate hierarchy.</span></span><br/>                                                                                                                                                                                                                                                            | <span data-ttu-id="f6765-119">C++</span><span class="sxs-lookup"><span data-stu-id="f6765-119">C++</span></span><br/>      |
| [<span data-ttu-id="f6765-120">enrollCustomPKCS10</span><span class="sxs-lookup"><span data-stu-id="f6765-120">enrollCustomPKCS10</span></span>](enrollcustompkcs10.md)                           | <span data-ttu-id="f6765-121">建立自訂的 PKCS \# 10 要求、將它提交給獨立的 [*憑證授權單位*](/windows/desktop/SecGloss/c-gly) 單位（ (CA) ），並在 [*憑證存放區*](/windows/desktop/SecGloss/c-gly)中安裝已發行的憑證。</span><span class="sxs-lookup"><span data-stu-id="f6765-121">Creates a custom PKCS \#10 request, submits it to a stand-alone [*certification authority*](/windows/desktop/SecGloss/c-gly) (CA), and installs the issued certificate in the [*certificate store*](/windows/desktop/SecGloss/c-gly).</span></span><br/> | <span data-ttu-id="f6765-122">C++</span><span class="sxs-lookup"><span data-stu-id="f6765-122">C++</span></span><br/>      |
| [<span data-ttu-id="f6765-123">enrollCustomPKCS10 \_ 2</span><span class="sxs-lookup"><span data-stu-id="f6765-123">enrollCustomPKCS10\_2</span></span>](enrollcustompkcs10-2.md)                      | <span data-ttu-id="f6765-124">建立自訂的 PKCS \# 10 要求，並嘗試在企業 CA 中進行註冊。</span><span class="sxs-lookup"><span data-stu-id="f6765-124">Creates a custom PKCS \#10 request and attempts to enroll it in an enterprise CA.</span></span><br/>                                                                                                                                                                                                                                                               | <span data-ttu-id="f6765-125">C++</span><span class="sxs-lookup"><span data-stu-id="f6765-125">C++</span></span><br/>      |
| [<span data-ttu-id="f6765-126">enrollEOBOCMC</span><span class="sxs-lookup"><span data-stu-id="f6765-126">enrollEOBOCMC</span></span>](enrolleobocmc.md)                                     | <span data-ttu-id="f6765-127">代表另一位使用者建立 CMC 憑證要求，並在證書階層中註冊使用者。</span><span class="sxs-lookup"><span data-stu-id="f6765-127">Creates a CMC certificate request on behalf of another user and enrolls the user in a certificate hierarchy.</span></span><br/>                                                                                                                                                                                                                                    | <span data-ttu-id="f6765-128">C++</span><span class="sxs-lookup"><span data-stu-id="f6765-128">C++</span></span><br/>      |
| [<span data-ttu-id="f6765-129">enrollFromPublicKey</span><span class="sxs-lookup"><span data-stu-id="f6765-129">enrollFromPublicKey</span></span>](enrollfrompublickey.md)                         | <span data-ttu-id="f6765-130">初始化 PKCS \# 10 憑證要求物件、將其包裝在 CMC 要求物件中、將 CMC 要求提交至企業 CA，並將 CA 傳回的憑證儲存在檔案中。</span><span class="sxs-lookup"><span data-stu-id="f6765-130">Initializes a PKCS \#10 certificate request object, wraps it in a CMC request object, submits the CMC request to an enterprise CA, and saves the certificate returned by the CA in a file.</span></span><br/>                                                                                                                                                      | <span data-ttu-id="f6765-131">C++</span><span class="sxs-lookup"><span data-stu-id="f6765-131">C++</span></span><br/>      |
| [<span data-ttu-id="f6765-132">enrollKeyArchivalCMC</span><span class="sxs-lookup"><span data-stu-id="f6765-132">enrollKeyArchivalCMC</span></span>](enrollkeyarchivalcmc.md)                       | <span data-ttu-id="f6765-133">建立 CMC 憑證要求，以封存 CA 上的 [*私密金鑰*](/windows/desktop/SecGloss/p-gly) 。</span><span class="sxs-lookup"><span data-stu-id="f6765-133">Creates a CMC certificate request to archive a [*private key*](/windows/desktop/SecGloss/p-gly) on a CA.</span></span><br/>                                                                                                                                                                                                     | <span data-ttu-id="f6765-134">C++</span><span class="sxs-lookup"><span data-stu-id="f6765-134">C++</span></span><br/>      |
| [<span data-ttu-id="f6765-135">enrollNestedCMC</span><span class="sxs-lookup"><span data-stu-id="f6765-135">enrollNestedCMC</span></span>](enrollnestedcmc.md)                                 | <span data-ttu-id="f6765-136">從檔案讀取現有的 CMC 憑證要求、將其包裝在另一個 CMC 要求中、簽署此外部要求、將它提交給 CA，然後將憑證回應儲存至檔案。</span><span class="sxs-lookup"><span data-stu-id="f6765-136">Reads an existing CMC certificate request from a file, wraps it in another CMC request, signs this outer request, submits it to a CA, and saves the certificate response from the CA to a file.</span></span><br/>                                                                                                                                                 | <span data-ttu-id="f6765-137">C++</span><span class="sxs-lookup"><span data-stu-id="f6765-137">C++</span></span><br/>      |
| [<span data-ttu-id="f6765-138">enrollPKCS7</span><span class="sxs-lookup"><span data-stu-id="f6765-138">enrollPKCS7</span></span>](enrollpkcs7.md)                                         | <span data-ttu-id="f6765-139">藉由繼承公開金鑰和私密金鑰和憑證範本，從現有的憑證建立 [*PKCS \# 7*](/windows/desktop/SecGloss/p-gly) 要求。</span><span class="sxs-lookup"><span data-stu-id="f6765-139">Creates a [*PKCS \#7*](/windows/desktop/SecGloss/p-gly) request from an existing certificate by inheriting the public and private keys and the certificate template.</span></span> <span data-ttu-id="f6765-140">此範例會在憑證階層中註冊使用者，並安裝憑證回應。</span><span class="sxs-lookup"><span data-stu-id="f6765-140">The sample enrolls the user in a certificate hierarchy and installs the certificate response.</span></span><br/>                                   | <span data-ttu-id="f6765-141">C++</span><span class="sxs-lookup"><span data-stu-id="f6765-141">C++</span></span><br/>      |
| [<span data-ttu-id="f6765-142">enrollRenewalPKCS7</span><span class="sxs-lookup"><span data-stu-id="f6765-142">enrollRenewalPKCS7</span></span>](enrollrenewalpkcs7.md)                           | <span data-ttu-id="f6765-143">建立 PKCS \# 7 要求物件以更新現有的憑證。</span><span class="sxs-lookup"><span data-stu-id="f6765-143">Creates a PKCS \#7 request object to renew an existing certificate.</span></span><br/>                                                                                                                                                                                                                                                                             | <span data-ttu-id="f6765-144">C++</span><span class="sxs-lookup"><span data-stu-id="f6765-144">C++</span></span><br/>      |
| [<span data-ttu-id="f6765-145">enrollSimpleMachineCert</span><span class="sxs-lookup"><span data-stu-id="f6765-145">enrollSimpleMachineCert</span></span>](enrollsimplemachinecert.md)                 | <span data-ttu-id="f6765-146">使用範本、憑證顯示名稱和憑證描述，在證書階層中註冊電腦。</span><span class="sxs-lookup"><span data-stu-id="f6765-146">Enrolls a computer in a certificate hierarchy by using a template, a certificate display name, and the certificate description.</span></span><br/>                                                                                                                                                                                                                 | <span data-ttu-id="f6765-147">C + +、VBS</span><span class="sxs-lookup"><span data-stu-id="f6765-147">C++, VBS</span></span><br/> |
| [<span data-ttu-id="f6765-148">enrollSimpleUserCert</span><span class="sxs-lookup"><span data-stu-id="f6765-148">enrollSimpleUserCert</span></span>](enrollsimpleusercert.md)                       | <span data-ttu-id="f6765-149">使用範本、主體名稱和金鑰的長度（以位為單位），向 CA 註冊使用者。</span><span class="sxs-lookup"><span data-stu-id="f6765-149">Enrolls an end user with a CA by using a template, the subject name, and the length, in bits, of the key.</span></span><br/>                                                                                                                                                                                                                                       | <span data-ttu-id="f6765-150">C + +、C#</span><span class="sxs-lookup"><span data-stu-id="f6765-150">C++, C#</span></span><br/> |
| [<span data-ttu-id="f6765-151">enrollWithIX509EnrollmentHelper</span><span class="sxs-lookup"><span data-stu-id="f6765-151">enrollWithIX509EnrollmentHelper</span></span>](enrollwithix509enrollmenthelper.md) | <span data-ttu-id="f6765-152">示範如何使用 Windows 7 HTTP 通訊協定在企業 CA 註冊憑證。</span><span class="sxs-lookup"><span data-stu-id="f6765-152">Demonstrates how to use the Windows 7 HTTP protocol to enroll a certificate in an enterprise CA.</span></span><br/>                                                                                                                                                                                                                                                | <span data-ttu-id="f6765-153">C#</span><span class="sxs-lookup"><span data-stu-id="f6765-153">C#</span></span><br/>      |
| [<span data-ttu-id="f6765-154">installResponseFromPFX</span><span class="sxs-lookup"><span data-stu-id="f6765-154">installResponseFromPFX</span></span>](installresponsefrompfx.md)                   | <span data-ttu-id="f6765-155">從個人資訊交換將已註冊的憑證 (PFX) 檔案安裝至憑證存放區。</span><span class="sxs-lookup"><span data-stu-id="f6765-155">Installs an enrolled certificate from a Personal Information Exchange (PFX) file to the certificate store.</span></span><br/>                                                                                                                                                                                                                                      | <span data-ttu-id="f6765-156">C++</span><span class="sxs-lookup"><span data-stu-id="f6765-156">C++</span></span><br/>      |



 

## <a name="related-topics"></a><span data-ttu-id="f6765-157">相關主題</span><span class="sxs-lookup"><span data-stu-id="f6765-157">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="f6765-158">使用憑證註冊 API</span><span class="sxs-lookup"><span data-stu-id="f6765-158">Using the Certificate Enrollment API</span></span>](about-the-certificate-enrollment-api.md)
</dt> </dl>

 

