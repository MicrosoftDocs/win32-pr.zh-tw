---
description: 實行 IX509PrivateKey 和 IX509PublicKey 介面。
ms.assetid: 1358053e-ed4e-4482-b160-5b9b1024c771
title: 私用和公開金鑰函數
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e2c1d8ec481c87337e7d7e56cffee47f1f483b84
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/08/2021
ms.locfileid: "106978013"
---
# <a name="private-and-public-key-functions"></a><span data-ttu-id="1ce95-103">私用和公開金鑰函數</span><span class="sxs-lookup"><span data-stu-id="1ce95-103">Private and Public Key Functions</span></span>

<span data-ttu-id="1ce95-104">CertEnroll.dll 會實行 [**IX509PrivateKey**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509privatekey) 和 [**IX509PublicKey**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509publickey) 介面。</span><span class="sxs-lookup"><span data-stu-id="1ce95-104">CertEnroll.dll implements the [**IX509PrivateKey**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509privatekey) and [**IX509PublicKey**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509publickey) interfaces.</span></span> <span data-ttu-id="1ce95-105">例如，您可以使用 [**IX509PrivateKey**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509privatekey) 介面在 [*私密金鑰*](/windows/desktop/SecGloss/p-gly)上執行下列動作：</span><span class="sxs-lookup"><span data-stu-id="1ce95-105">You can, for example, use the [**IX509PrivateKey**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509privatekey) interface to perform the following actions on a [*private key*](/windows/desktop/SecGloss/p-gly):</span></span>

-   <span data-ttu-id="1ce95-106">建立、開啟、關閉、匯入、匯出和刪除金鑰。</span><span class="sxs-lookup"><span data-stu-id="1ce95-106">Create, open, close, import, export, and delete the key.</span></span>
-   <span data-ttu-id="1ce95-107">指定或取出 [*公開金鑰演算法*](/windows/desktop/SecGloss/p-gly)。</span><span class="sxs-lookup"><span data-stu-id="1ce95-107">Specify or retrieve the [*public key algorithm*](/windows/desktop/SecGloss/p-gly).</span></span>
-   <span data-ttu-id="1ce95-108">指定或取得支援公開金鑰演算法 (CSP) 的可用 [*密碼編譯服務提供者*](/windows/desktop/SecGloss/c-gly) 的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="1ce95-108">Specify or retrieve information about the available [*cryptographic service provider*](/windows/desktop/SecGloss/c-gly) (CSP) that support the public key algorithm.</span></span>
-   <span data-ttu-id="1ce95-109">指定或取出與 [*私密金鑰*](/windows/desktop/SecGloss/p-gly)相關聯的 [*憑證*](/windows/desktop/SecGloss/c-gly)。</span><span class="sxs-lookup"><span data-stu-id="1ce95-109">Specify or retrieve the [*certificate*](/windows/desktop/SecGloss/c-gly) associated with the [*private key*](/windows/desktop/SecGloss/p-gly).</span></span>
-   <span data-ttu-id="1ce95-110">指定或取出 [*金鑰容器*](/windows/desktop/SecGloss/k-gly)的名稱。</span><span class="sxs-lookup"><span data-stu-id="1ce95-110">Specify or retrieve the name of the [*key container*](/windows/desktop/SecGloss/k-gly).</span></span>
-   <span data-ttu-id="1ce95-111">指定或抓取索引鍵的說明和顯示名稱。</span><span class="sxs-lookup"><span data-stu-id="1ce95-111">Specify or retrieve a description of and a display name for the key.</span></span>
-   <span data-ttu-id="1ce95-112">指定或抓取私密金鑰上的匯出條件約束位置。</span><span class="sxs-lookup"><span data-stu-id="1ce95-112">Specify or retrieve the export constraints places on a private key.</span></span>
-   <span data-ttu-id="1ce95-113">指定或取得布林值，指出金鑰是否存在。</span><span class="sxs-lookup"><span data-stu-id="1ce95-113">Specify or retrieve a Boolean value that indicates whether the key exists.</span></span>
-   <span data-ttu-id="1ce95-114">指定或取出值，指出如何在使用之前保護金鑰。</span><span class="sxs-lookup"><span data-stu-id="1ce95-114">Specify or retrieve a value that indicates how the key is protected before use.</span></span>
-   <span data-ttu-id="1ce95-115">指定或取出值，指出金鑰是否可用於簽署、加密或兩者。</span><span class="sxs-lookup"><span data-stu-id="1ce95-115">Specify or retrieve a value that indicates whether the key can be used for signing, encryption, or both.</span></span>
-   <span data-ttu-id="1ce95-116">指定或取出值，以識別可使用金鑰的特定用途。</span><span class="sxs-lookup"><span data-stu-id="1ce95-116">Specify or retrieve a value that identifies the specific purpose for which the key can be used.</span></span>
-   <span data-ttu-id="1ce95-117">指定或取出金鑰的長度。</span><span class="sxs-lookup"><span data-stu-id="1ce95-117">Specify or retrieve the length of the key.</span></span>
-   <span data-ttu-id="1ce95-118">指定或取出值，指出是否在電腦或使用者的內容中使用或儲存金鑰。</span><span class="sxs-lookup"><span data-stu-id="1ce95-118">Specify or retrieve a value that indicates whether the key is used or saved in the context of a computer or user.</span></span>
-   <span data-ttu-id="1ce95-119">取得布林值，這個值會指定是否已開啟索引鍵。</span><span class="sxs-lookup"><span data-stu-id="1ce95-119">Retrieve a Boolean value that specifies whether the key has been opened.</span></span>
-   <span data-ttu-id="1ce95-120">指定個人識別碼，以存取 [*智慧卡*](/windows/desktop/SecGloss/s-gly)上的私密金鑰。</span><span class="sxs-lookup"><span data-stu-id="1ce95-120">Specify a personal identification number to access a private key on a [*smart card*](/windows/desktop/SecGloss/s-gly).</span></span>
-   <span data-ttu-id="1ce95-121">指定或取出與金鑰相關聯的 CSP 名稱。</span><span class="sxs-lookup"><span data-stu-id="1ce95-121">Specify or retrieve the name of the CSP associated with the key.</span></span>
-   <span data-ttu-id="1ce95-122">指定或取得金鑰的 [*安全描述項*](/windows/desktop/SecGloss/s-gly) 。</span><span class="sxs-lookup"><span data-stu-id="1ce95-122">Specify or retrieve the [*security descriptor*](/windows/desktop/SecGloss/s-gly) for the key.</span></span>

<span data-ttu-id="1ce95-123">下列各節會識別 Xenroll.dll 所匯出的函式，該函式可用於管理 [*密碼編譯金鑰*](/windows/desktop/SecGloss/c-gly)。</span><span class="sxs-lookup"><span data-stu-id="1ce95-123">Each of the following sections identifies a function exported by Xenroll.dll that can be used to manage a [*cryptographic key*](/windows/desktop/SecGloss/c-gly).</span></span> <span data-ttu-id="1ce95-124">每個主題也會討論如何使用 CertEnroll.dll 來取代函式，或指出兩個程式庫之間沒有對應存在：</span><span class="sxs-lookup"><span data-stu-id="1ce95-124">Each topic also discusses how to use CertEnroll.dll to replace the function or indicates that no mapping between the two libraries exists:</span></span>

-   [<span data-ttu-id="1ce95-125">ContainerNameWStr</span><span class="sxs-lookup"><span data-stu-id="1ce95-125">ContainerNameWStr</span></span>](#containernamewstr)
-   [<span data-ttu-id="1ce95-126">GenKeyFlags</span><span class="sxs-lookup"><span data-stu-id="1ce95-126">GenKeyFlags</span></span>](#genkeyflags)
-   [<span data-ttu-id="1ce95-127">GetKeyLen</span><span class="sxs-lookup"><span data-stu-id="1ce95-127">GetKeyLen</span></span>](#getkeylenex)
-   [<span data-ttu-id="1ce95-128">GetKeyLenEx</span><span class="sxs-lookup"><span data-stu-id="1ce95-128">GetKeyLenEx</span></span>](#getkeylenex)
-   [<span data-ttu-id="1ce95-129">GetSupportedKeySpec</span><span class="sxs-lookup"><span data-stu-id="1ce95-129">GetSupportedKeySpec</span></span>](#getsupportedkeyspec)
-   [<span data-ttu-id="1ce95-130">KeySpec</span><span class="sxs-lookup"><span data-stu-id="1ce95-130">KeySpec</span></span>](#getsupportedkeyspec)
-   [<span data-ttu-id="1ce95-131">LimitExchangeKeyToEncipherment</span><span class="sxs-lookup"><span data-stu-id="1ce95-131">LimitExchangeKeyToEncipherment</span></span>](#limitexchangekeytoencipherment)
-   [<span data-ttu-id="1ce95-132">PVKFileNameWStr</span><span class="sxs-lookup"><span data-stu-id="1ce95-132">PVKFileNameWStr</span></span>](#pvkfilenamewstr)
-   [<span data-ttu-id="1ce95-133">ReuseHardwareKeyIfUnableToGenNew</span><span class="sxs-lookup"><span data-stu-id="1ce95-133">ReuseHardwareKeyIfUnableToGenNew</span></span>](#reusehardwarekeyifunabletogennew)
-   [<span data-ttu-id="1ce95-134">假如 useexistingkeyset</span><span class="sxs-lookup"><span data-stu-id="1ce95-134">UseExistingKeySet</span></span>](#useexistingkeyset)
-   [<span data-ttu-id="1ce95-135">相關主題</span><span class="sxs-lookup"><span data-stu-id="1ce95-135">Related topics</span></span>](#related-topics)

## <a name="containernamewstr"></a><span data-ttu-id="1ce95-136">ContainerNameWStr</span><span class="sxs-lookup"><span data-stu-id="1ce95-136">ContainerNameWStr</span></span>

<span data-ttu-id="1ce95-137">Xenroll.dll 中的 [**ContainerNameWStr**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-get_containernamewstr) 函數會指定或抓取 [*金鑰容器*](/windows/desktop/SecGloss/k-gly)的名稱。</span><span class="sxs-lookup"><span data-stu-id="1ce95-137">The [**ContainerNameWStr**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-get_containernamewstr) function in Xenroll.dll specifies or retrieves the name of the [*key container*](/windows/desktop/SecGloss/k-gly).</span></span>

<span data-ttu-id="1ce95-138">使用 CertEnroll.dll 時，您可以執行下列動作來取出金鑰容器的名稱：</span><span class="sxs-lookup"><span data-stu-id="1ce95-138">When using CertEnroll.dll, you can perform the following actions to retrieve the name of a key container:</span></span>

1.  <span data-ttu-id="1ce95-139">呼叫現有 [**IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment)物件上的 [**Request**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-get_request)屬性。</span><span class="sxs-lookup"><span data-stu-id="1ce95-139">Call the [**Request**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-get_request) property on an existing [**IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment) object.</span></span>
2.  <span data-ttu-id="1ce95-140">在步驟1傳回的要求上呼叫 [**GetInnerRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequest-getinnerrequest) 方法，以取得最內層的要求。</span><span class="sxs-lookup"><span data-stu-id="1ce95-140">Call the [**GetInnerRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequest-getinnerrequest) method on the request returned from step 1 to retrieve the innermost request.</span></span>
3.  <span data-ttu-id="1ce95-141">在步驟2所傳回的 [**IX509CertificateRequest**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequest)物件上呼叫 **QueryInterface** ，以轉換為 [**IX509CertificateRequestPkcs10**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequestpkcs10)物件。</span><span class="sxs-lookup"><span data-stu-id="1ce95-141">Call **QueryInterface** on the [**IX509CertificateRequest**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequest) object returned from step 2 to cast to an [**IX509CertificateRequestPkcs10**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequestpkcs10) object.</span></span>
4.  <span data-ttu-id="1ce95-142">呼叫 PKCS 10 要求上的 [**PrivateKey**](/windows/desktop/SecCrypto/privatekey) 屬性 \# 。</span><span class="sxs-lookup"><span data-stu-id="1ce95-142">Call the [**PrivateKey**](/windows/desktop/SecCrypto/privatekey) property on the PKCS \#10 request.</span></span>
5.  <span data-ttu-id="1ce95-143">呼叫從步驟4取出的 [**IX509PrivateKey**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509privatekey)物件上的 [**容器**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509privatekey-get_containername)屬性。</span><span class="sxs-lookup"><span data-stu-id="1ce95-143">Call the [**ContainerName**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509privatekey-get_containername) property on the [**IX509PrivateKey**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509privatekey) object retrieved from step 4.</span></span>

## <a name="genkeyflags"></a><span data-ttu-id="1ce95-144">GenKeyFlags</span><span class="sxs-lookup"><span data-stu-id="1ce95-144">GenKeyFlags</span></span>

<span data-ttu-id="1ce95-145">Xenroll.dll 中定義的 [**GenKeyFlags**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-get_genkeyflags) 函數會指定或抓取用來產生私密金鑰或 [*公開/私密金鑰*](/windows/desktop/SecGloss/p-gly)組的旗標。</span><span class="sxs-lookup"><span data-stu-id="1ce95-145">The [**GenKeyFlags**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-get_genkeyflags) function defined in Xenroll.dll specifies or retrieves flags used to generate a private key or [*public/private key pair*](/windows/desktop/SecGloss/p-gly).</span></span>

<span data-ttu-id="1ce95-146">使用 CertEnroll.dll 時，您可以指定一些不同的屬性，這些屬性會決定如何建立私密金鑰。</span><span class="sxs-lookup"><span data-stu-id="1ce95-146">When using CertEnroll.dll, you can specify a number of different properties that will determine how a private key is created.</span></span> <span data-ttu-id="1ce95-147">如需詳細資訊，請參閱 [**Create**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509privatekey-create)。</span><span class="sxs-lookup"><span data-stu-id="1ce95-147">For more information, see [**Create**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509privatekey-create).</span></span>

## <a name="getkeylen"></a><span data-ttu-id="1ce95-148">GetKeyLen</span><span class="sxs-lookup"><span data-stu-id="1ce95-148">GetKeyLen</span></span>

<span data-ttu-id="1ce95-149">Xenroll.dll 中定義的 [**GetKeyLen**](/windows/desktop/api/xenroll/nf-xenroll-ienroll2-getkeylen) 函數會抓取加密金鑰的最大或最小金鑰大小。</span><span class="sxs-lookup"><span data-stu-id="1ce95-149">The [**GetKeyLen**](/windows/desktop/api/xenroll/nf-xenroll-ienroll2-getkeylen) function defined in Xenroll.dll retrieves the maximum or minimum key size of an encryption key.</span></span>

<span data-ttu-id="1ce95-150">使用 CertEnroll.dll 時，您可以呼叫 [**IX509PrivateKey**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509privatekey)或 [**IX509PublicKey**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509publickey)物件的 [**Length**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509privatekey-get_length)屬性來取得金鑰大小（以位為單位）。</span><span class="sxs-lookup"><span data-stu-id="1ce95-150">When using CertEnroll.dll, you can call the [**Length**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509privatekey-get_length) property on an [**IX509PrivateKey**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509privatekey) or [**IX509PublicKey**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509publickey) object to retrieve the key size, in bits.</span></span>

## <a name="getkeylenex"></a><span data-ttu-id="1ce95-151">GetKeyLenEx</span><span class="sxs-lookup"><span data-stu-id="1ce95-151">GetKeyLenEx</span></span>

<span data-ttu-id="1ce95-152">Xenroll.dll 中定義的 [**GetKeyLenEx**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-getkeylenex) 函數會抓取加密金鑰的最大或最小金鑰大小或增量長度。</span><span class="sxs-lookup"><span data-stu-id="1ce95-152">The [**GetKeyLenEx**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-getkeylenex) function defined in Xenroll.dll retrieves the maximum or minimum key size or the increment length of an encryption key.</span></span>

<span data-ttu-id="1ce95-153">使用 CertEnroll.dll 時，您可以呼叫 [**IX509PrivateKey**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509privatekey)或 [**IX509PublicKey**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509publickey)物件的 [**Length**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509privatekey-get_length)屬性來取得金鑰大小（以位為單位）。</span><span class="sxs-lookup"><span data-stu-id="1ce95-153">When using CertEnroll.dll, you can call the [**Length**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509privatekey-get_length) property on an [**IX509PrivateKey**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509privatekey) or [**IX509PublicKey**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509publickey) object to retrieve the key size, in bits.</span></span> <span data-ttu-id="1ce95-154">如果演算法支援增量索引鍵長度，您可以呼叫 [**ICspAlgorithm**](/windows/desktop/api/CertEnroll/nn-certenroll-icspalgorithm)物件上的 [**IncrementLength**](/windows/desktop/api/CertEnroll/nf-certenroll-icspalgorithm-get_incrementlength)屬性，以取得遞增值。</span><span class="sxs-lookup"><span data-stu-id="1ce95-154">If an algorithm supports incremental key lengths, you can call the [**IncrementLength**](/windows/desktop/api/CertEnroll/nf-certenroll-icspalgorithm-get_incrementlength) property on the [**ICspAlgorithm**](/windows/desktop/api/CertEnroll/nn-certenroll-icspalgorithm) object to retrieve the increment value.</span></span> <span data-ttu-id="1ce95-155">您也可以呼叫 [**MinLength**](/windows/desktop/api/CertEnroll/nf-certenroll-icspalgorithm-get_minlength) 和 [**MaxLength**](/windows/desktop/api/CertEnroll/nf-certenroll-icspalgorithm-get_maxlength) 屬性來取得最小和最大金鑰大小。</span><span class="sxs-lookup"><span data-stu-id="1ce95-155">You can also call the [**MinLength**](/windows/desktop/api/CertEnroll/nf-certenroll-icspalgorithm-get_minlength) and [**MaxLength**](/windows/desktop/api/CertEnroll/nf-certenroll-icspalgorithm-get_maxlength) properties to retrieve the minimum and maximum key sizes.</span></span>

## <a name="getsupportedkeyspec"></a><span data-ttu-id="1ce95-156">GetSupportedKeySpec</span><span class="sxs-lookup"><span data-stu-id="1ce95-156">GetSupportedKeySpec</span></span>

<span data-ttu-id="1ce95-157">Xenroll.dll 中定義的 [**GetSupportedKeySpec**](/windows/desktop/api/xenroll/nf-xenroll-ienroll2-getsupportedkeyspec) 函式會抓取值，指出 CSP 是否支援 exchange 金鑰、簽署金鑰或兩者。</span><span class="sxs-lookup"><span data-stu-id="1ce95-157">The [**GetSupportedKeySpec**](/windows/desktop/api/xenroll/nf-xenroll-ienroll2-getsupportedkeyspec) function defined in Xenroll.dll retrieves a value that indicates whether a CSP supports exchange keys, signing keys, or both.</span></span>

<span data-ttu-id="1ce95-158">使用 CertEnroll.dll 時，您可以呼叫 [**IX509PrivateKey**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509privatekey)或 [**ICspInformation**](/windows/desktop/api/CertEnroll/nn-certenroll-icspinformation)物件上的 [**KeySpec**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509privatekey-get_keyspec)屬性，以取出金鑰所支援的作業。</span><span class="sxs-lookup"><span data-stu-id="1ce95-158">When using CertEnroll.dll, you can call the [**KeySpec**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509privatekey-get_keyspec) property on the [**IX509PrivateKey**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509privatekey) or [**ICspInformation**](/windows/desktop/api/CertEnroll/nn-certenroll-icspinformation) objects to retrieve the operations supported by the key.</span></span>

## <a name="keyspec"></a><span data-ttu-id="1ce95-159">KeySpec</span><span class="sxs-lookup"><span data-stu-id="1ce95-159">KeySpec</span></span>

<span data-ttu-id="1ce95-160">Xenroll.dll 中定義的 [**KeySpec**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-get_keyspec) 函數會指定或抓取索引鍵類型。</span><span class="sxs-lookup"><span data-stu-id="1ce95-160">The [**KeySpec**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-get_keyspec) function defined in Xenroll.dll specifies or retrieves the key type.</span></span>

<span data-ttu-id="1ce95-161">使用 CertEnroll.dll 時，您可以在 [**IX509PrivateKey**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509privatekey)物件上呼叫 [**KeySpec**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509privatekey-get_keyspec)屬性，以取得金鑰所支援的作業。</span><span class="sxs-lookup"><span data-stu-id="1ce95-161">When using CertEnroll.dll, you can call the [**KeySpec**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509privatekey-get_keyspec) property on an [**IX509PrivateKey**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509privatekey) object to retrieve the operations supported by the key.</span></span>

## <a name="limitexchangekeytoencipherment"></a><span data-ttu-id="1ce95-162">LimitExchangeKeyToEncipherment</span><span class="sxs-lookup"><span data-stu-id="1ce95-162">LimitExchangeKeyToEncipherment</span></span>

<span data-ttu-id="1ce95-163">Xenroll.dll 中定義的 [**LimitExchangeKeyToEncipherment**](/windows/desktop/api/xenroll/nf-xenroll-ienroll2-get_limitexchangekeytoencipherment) 函式會指定或抓取布林值，指出加密金鑰是否只能用於資料或金鑰加密。</span><span class="sxs-lookup"><span data-stu-id="1ce95-163">The [**LimitExchangeKeyToEncipherment**](/windows/desktop/api/xenroll/nf-xenroll-ienroll2-get_limitexchangekeytoencipherment) function defined in Xenroll.dll specifies or retrieves a Boolean value that indicates whether an encryption key can be used only for data or key encipherment.</span></span>

<span data-ttu-id="1ce95-164">CertEnroll.dll 不包含此函數的直接對等專案。</span><span class="sxs-lookup"><span data-stu-id="1ce95-164">CertEnroll.dll does not contain a direct equivalent for this function.</span></span> <span data-ttu-id="1ce95-165">不過，您可以指定 [**IX509ExtensionKeyUsage**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensionkeyusage) 物件，並將它新增至憑證要求，以達到幾乎相等的結果。</span><span class="sxs-lookup"><span data-stu-id="1ce95-165">You can, however, achieve a nearly equivalent result by specifying an [**IX509ExtensionKeyUsage**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensionkeyusage) object and adding it to the certificate request.</span></span>

## <a name="pvkfilenamewstr"></a><span data-ttu-id="1ce95-166">PVKFileNameWStr</span><span class="sxs-lookup"><span data-stu-id="1ce95-166">PVKFileNameWStr</span></span>

<span data-ttu-id="1ce95-167">Xenroll.dll 中定義的 [**PVKFileNameWStr**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-get_pvkfilenamewstr) 函式會指定或抓取包含所匯出金鑰的檔案名。</span><span class="sxs-lookup"><span data-stu-id="1ce95-167">The [**PVKFileNameWStr**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-get_pvkfilenamewstr) function defined in Xenroll.dll specifies or retrieves the name of a file that contains exported keys.</span></span>

<span data-ttu-id="1ce95-168">使用 CertEnroll.dll 時，您可以在 [**IX509PrivateKey**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509privatekey)物件上呼叫 [**export**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509privatekey-export)方法，以將金鑰匯出至 **BSTR**。</span><span class="sxs-lookup"><span data-stu-id="1ce95-168">When using CertEnroll.dll, you can call the [**Export**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509privatekey-export) method on an [**IX509PrivateKey**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509privatekey) object to export a key to a **BSTR**.</span></span> <span data-ttu-id="1ce95-169">您可以呼叫 [**ExportPublicKey**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509privatekey-exportpublickey) 方法來匯出非對稱金鑰組的 [*公開金鑰*](/windows/desktop/SecGloss/p-gly) 部分。</span><span class="sxs-lookup"><span data-stu-id="1ce95-169">You can call the [**ExportPublicKey**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509privatekey-exportpublickey) method to export the [*public key*](/windows/desktop/SecGloss/p-gly) portion of an asymmetric key pair.</span></span>

## <a name="reusehardwarekeyifunabletogennew"></a><span data-ttu-id="1ce95-170">ReuseHardwareKeyIfUnableToGenNew</span><span class="sxs-lookup"><span data-stu-id="1ce95-170">ReuseHardwareKeyIfUnableToGenNew</span></span>

<span data-ttu-id="1ce95-171">Xenroll.dll 中定義的 [**ReuseHardwareKeyIfUnableToGenNew**](/windows/desktop/api/xenroll/nf-xenroll-ienroll2-get_reusehardwarekeyifunabletogennew) 函式會指定或抓取布林值，指出在產生新的索引鍵時，如果發生錯誤，是否重複使用現有的金鑰。</span><span class="sxs-lookup"><span data-stu-id="1ce95-171">The [**ReuseHardwareKeyIfUnableToGenNew**](/windows/desktop/api/xenroll/nf-xenroll-ienroll2-get_reusehardwarekeyifunabletogennew) function defined in Xenroll.dll specifies or retrieves a Boolean value that indicates whether an existing key is reused when an error is encountered when generating a new key.</span></span>

<span data-ttu-id="1ce95-172">使用 CertEnroll.dll 時，您可以在 [**IX509CertificateRequestPkcs10**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequestpkcs10)物件上呼叫 [**InitializeFromCertificate**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequestpkcs10-initializefromcertificate)方法，並指定 [**X509RequestInheritOptions**](/windows/desktop/api/CertEnroll/ne-certenroll-x509requestinheritoptions)列舉型別的值，以重複使用現有的私密金鑰。</span><span class="sxs-lookup"><span data-stu-id="1ce95-172">When using CertEnroll.dll, you can call the [**InitializeFromCertificate**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequestpkcs10-initializefromcertificate) method on an [**IX509CertificateRequestPkcs10**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequestpkcs10) object and specify a value of the [**X509RequestInheritOptions**](/windows/desktop/api/CertEnroll/ne-certenroll-x509requestinheritoptions) enumeration type to reuse an existing private key.</span></span>

## <a name="useexistingkeyset"></a><span data-ttu-id="1ce95-173">假如 useexistingkeyset</span><span class="sxs-lookup"><span data-stu-id="1ce95-173">UseExistingKeySet</span></span>

<span data-ttu-id="1ce95-174">Xenroll.dll 中定義的 [**假如 useexistingkeyset**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-get_useexistingkeyset) 函數會指定或抓取布林值，指出是否要使用現有的索引鍵。</span><span class="sxs-lookup"><span data-stu-id="1ce95-174">The [**UseExistingKeySet**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-get_useexistingkeyset) function defined in Xenroll.dll specifies or retrieves a Boolean value that indicates whether to use existing keys.</span></span>

<span data-ttu-id="1ce95-175">使用 CertEnroll.dll 時，您可以在 [**IX509CertificateRequestPkcs10**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequestpkcs10)物件上呼叫 [**InitializeFromCertificate**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequestpkcs10-initializefromcertificate)方法，並指定 [**X509RequestInheritOptions**](/windows/desktop/api/CertEnroll/ne-certenroll-x509requestinheritoptions)列舉型別的值，以重複使用現有的私用和公開金鑰。</span><span class="sxs-lookup"><span data-stu-id="1ce95-175">When using CertEnroll.dll, you can call the [**InitializeFromCertificate**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequestpkcs10-initializefromcertificate) method on an [**IX509CertificateRequestPkcs10**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequestpkcs10) object and specify a value of the [**X509RequestInheritOptions**](/windows/desktop/api/CertEnroll/ne-certenroll-x509requestinheritoptions) enumeration type to reuse existing private and public keys.</span></span>

## <a name="related-topics"></a><span data-ttu-id="1ce95-176">相關主題</span><span class="sxs-lookup"><span data-stu-id="1ce95-176">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="1ce95-177">將 Xenroll.dll 對應至 CertEnroll.dll</span><span class="sxs-lookup"><span data-stu-id="1ce95-177">Mapping Xenroll.dll to CertEnroll.dll</span></span>](mapping-xenroll-dll-to-certenroll-dll.md)
</dt> </dl>

 

 
