---
description: X.509 第3版憑證格式可識別多個可新增至憑證的延伸模組，以提供有關金鑰使用方式、憑證原則和條件約束、替代名稱表單等的增強資訊。
ms.assetid: d53107b7-a153-41cf-9876-1d28aaf99816
title: 擴充功能
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 4bc490c8763a00fae9e7fb1e8a702ff87e2c18fd
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/08/2021
ms.locfileid: "107001736"
---
# <a name="extension-functions"></a><span data-ttu-id="6512a-103">擴充功能</span><span class="sxs-lookup"><span data-stu-id="6512a-103">Extension Functions</span></span>

<span data-ttu-id="6512a-104">[*X.509*](/windows/desktop/SecGloss/x-gly)第3版憑證格式可識別多個可新增至憑證的延伸模組，以提供有關金鑰使用方式、憑證原則和條件約束、替代名稱表單等的增強資訊。</span><span class="sxs-lookup"><span data-stu-id="6512a-104">The [*X.509*](/windows/desktop/SecGloss/x-gly) version 3 certificate format identifies multiple extensions that can be added to a certificate to provide enhanced information about key usage, certificate policies and constraints, alternative name forms, and more.</span></span>

<span data-ttu-id="6512a-105">CertEnroll.dll 會執行下列介面來管理憑證延伸：</span><span class="sxs-lookup"><span data-stu-id="6512a-105">CertEnroll.dll implements the following interfaces to manage certificate extensions:</span></span>

-   [<span data-ttu-id="6512a-106">**IX509Extension**</span><span class="sxs-lookup"><span data-stu-id="6512a-106">**IX509Extension**</span></span>](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extension)
-   [<span data-ttu-id="6512a-107">**IX509Extensions**</span><span class="sxs-lookup"><span data-stu-id="6512a-107">**IX509Extensions**</span></span>](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensions)
-   [<span data-ttu-id="6512a-108">**IX509ExtensionAlternativeNames**</span><span class="sxs-lookup"><span data-stu-id="6512a-108">**IX509ExtensionAlternativeNames**</span></span>](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensionalternativenames)
-   [<span data-ttu-id="6512a-109">**IX509ExtensionAuthorityKeyIdentifier**</span><span class="sxs-lookup"><span data-stu-id="6512a-109">**IX509ExtensionAuthorityKeyIdentifier**</span></span>](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensionauthoritykeyidentifier)
-   [<span data-ttu-id="6512a-110">**IX509ExtensionBasicConstraints**</span><span class="sxs-lookup"><span data-stu-id="6512a-110">**IX509ExtensionBasicConstraints**</span></span>](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensionbasicconstraints)
-   [<span data-ttu-id="6512a-111">**IX509ExtensionCertificatePolicies**</span><span class="sxs-lookup"><span data-stu-id="6512a-111">**IX509ExtensionCertificatePolicies**</span></span>](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensioncertificatepolicies)
-   [<span data-ttu-id="6512a-112">**IX509ExtensionEnhancedKeyUsage**</span><span class="sxs-lookup"><span data-stu-id="6512a-112">**IX509ExtensionEnhancedKeyUsage**</span></span>](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensionenhancedkeyusage)
-   [<span data-ttu-id="6512a-113">**IX509ExtensionKeyUsage**</span><span class="sxs-lookup"><span data-stu-id="6512a-113">**IX509ExtensionKeyUsage**</span></span>](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensionkeyusage)
-   [<span data-ttu-id="6512a-114">**IX509ExtensionMSApplicationPolicies**</span><span class="sxs-lookup"><span data-stu-id="6512a-114">**IX509ExtensionMSApplicationPolicies**</span></span>](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensionmsapplicationpolicies)
-   [<span data-ttu-id="6512a-115">**IX509ExtensionSmimeCapabilities**</span><span class="sxs-lookup"><span data-stu-id="6512a-115">**IX509ExtensionSmimeCapabilities**</span></span>](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensionsmimecapabilities)
-   [<span data-ttu-id="6512a-116">**IX509ExtensionSubjectKeyIdentifier**</span><span class="sxs-lookup"><span data-stu-id="6512a-116">**IX509ExtensionSubjectKeyIdentifier**</span></span>](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensionsubjectkeyidentifier)
-   [<span data-ttu-id="6512a-117">**IX509ExtensionTemplate**</span><span class="sxs-lookup"><span data-stu-id="6512a-117">**IX509ExtensionTemplate**</span></span>](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensiontemplate)
-   [<span data-ttu-id="6512a-118">**IX509ExtensionTemplateName**</span><span class="sxs-lookup"><span data-stu-id="6512a-118">**IX509ExtensionTemplateName**</span></span>](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensiontemplatename)

<span data-ttu-id="6512a-119">下列各節將討論 Xenroll.dll 管理憑證延伸所匯出的函式。</span><span class="sxs-lookup"><span data-stu-id="6512a-119">Each of the following sections discusses a function exported by Xenroll.dll to manage certificate extensions.</span></span> <span data-ttu-id="6512a-120">每個章節也會討論如何使用 CertEnroll.dll 來取代函式，或指出兩個程式庫之間沒有對應存在：</span><span class="sxs-lookup"><span data-stu-id="6512a-120">Each section also discusses how to use CertEnroll.dll to replace the function or indicates that no mapping between the two libraries exists:</span></span>

-   [<span data-ttu-id="6512a-121">AddCertTypeToRequestWStr</span><span class="sxs-lookup"><span data-stu-id="6512a-121">AddCertTypeToRequestWStr</span></span>](#addcerttypetorequestwstr)
-   [<span data-ttu-id="6512a-122">AddCertTypeToRequestWStrEx</span><span class="sxs-lookup"><span data-stu-id="6512a-122">AddCertTypeToRequestWStrEx</span></span>](#addcerttypetorequestwstrex)
-   [<span data-ttu-id="6512a-123">AddExtensionsToRequest</span><span class="sxs-lookup"><span data-stu-id="6512a-123">AddExtensionsToRequest</span></span>](#addextensionstorequest)
-   [<span data-ttu-id="6512a-124">addExtensionToRequestWStr</span><span class="sxs-lookup"><span data-stu-id="6512a-124">addExtensionToRequestWStr</span></span>](#addextensiontorequestwstr)
-   [<span data-ttu-id="6512a-125">EnableSMIMECapabilities</span><span class="sxs-lookup"><span data-stu-id="6512a-125">EnableSMIMECapabilities</span></span>](#enablesmimecapabilities)
-   [<span data-ttu-id="6512a-126">IncludeSubjectKeyID</span><span class="sxs-lookup"><span data-stu-id="6512a-126">IncludeSubjectKeyID</span></span>](#includesubjectkeyid)
-   [<span data-ttu-id="6512a-127">resetExtensions</span><span class="sxs-lookup"><span data-stu-id="6512a-127">resetExtensions</span></span>](#resetextensions)
-   [<span data-ttu-id="6512a-128">相關主題</span><span class="sxs-lookup"><span data-stu-id="6512a-128">Related topics</span></span>](#related-topics)

## <a name="addcerttypetorequestwstr"></a><span data-ttu-id="6512a-129">AddCertTypeToRequestWStr</span><span class="sxs-lookup"><span data-stu-id="6512a-129">AddCertTypeToRequestWStr</span></span>

<span data-ttu-id="6512a-130">Xenroll.dll 中的 [**AddCertTypeToRequestWStr**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-addcerttypetorequestwstr) 函數會依名稱將憑證範本新增至要求。</span><span class="sxs-lookup"><span data-stu-id="6512a-130">The [**AddCertTypeToRequestWStr**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-addcerttypetorequestwstr) function in Xenroll.dll adds a certificate template, by name, to a request.</span></span>

<span data-ttu-id="6512a-131">使用 CertEnroll.dll，將範本併入憑證要求的慣用方法，是在 PKCS [](/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequestpkcs10-initializefromtemplatename) \# 10 或 [\* pkcs ) 要求物件或 CMC 要求上的 [**InitializeFromInnerRequestTemplateName**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequestcmc-initializefrominnerrequesttemplatename)方法上使用 InitializeFromTemplateName 方法。</span><span class="sxs-lookup"><span data-stu-id="6512a-131">Using CertEnroll.dll, the preferred method to incorporate a template into a certificate request is to use the [**InitializeFromTemplateName**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequestpkcs10-initializefromtemplatename) method on a PKCS\#10 or [\*PKCS ) request object or the [**InitializeFromInnerRequestTemplateName**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequestcmc-initializefrominnerrequesttemplatename) method on a CMC request.</span></span>

<span data-ttu-id="6512a-132">如果用戶端上無法使用特定範本，但是 (CA) 的 [*憑證授權單位*](/windows/desktop/SecGloss/c-gly) 單位預期會瞭解該範本，您可以使用 [**IX509ExtensionTemplateName**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensiontemplatename) 介面來新增第1版的範本，或者您可以使用 [**IX509ExtensionTemplate**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensiontemplate) 介面將第2版範本新增至憑證要求。</span><span class="sxs-lookup"><span data-stu-id="6512a-132">If a specific template is not available on the client but is expected to be understood by the [*certification authority*](/windows/desktop/SecGloss/c-gly) (CA), you can use the [**IX509ExtensionTemplateName**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensiontemplatename) interface to add a version 1 template or you can use the [**IX509ExtensionTemplate**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensiontemplate) interface to add a version 2 template to a certificate request.</span></span> <span data-ttu-id="6512a-133">例如，若要新增第1版的範本，請執行下列動作：</span><span class="sxs-lookup"><span data-stu-id="6512a-133">For example, to add a version 1 template, perform the following actions:</span></span>

1.  <span data-ttu-id="6512a-134">建立 [**IX509Extensions**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensions) 物件。</span><span class="sxs-lookup"><span data-stu-id="6512a-134">Create an [**IX509Extensions**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensions) object.</span></span>
2.  <span data-ttu-id="6512a-135">建立 [**IX509ExtensionTemplateName**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensiontemplatename) 物件，並呼叫 [**InitializeEncode**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509extensiontemplatename-initializeencode) 方法，並指定範本名稱。</span><span class="sxs-lookup"><span data-stu-id="6512a-135">Create an [**IX509ExtensionTemplateName**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensiontemplatename) object and call the [**InitializeEncode**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509extensiontemplatename-initializeencode) method, specifying the template name.</span></span>
3.  <span data-ttu-id="6512a-136">藉由呼叫 [**add**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509extensions-add)方法，將建立的延伸模組加入至 [**IX509Extensions**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensions)集合。</span><span class="sxs-lookup"><span data-stu-id="6512a-136">Add the extension created to the [**IX509Extensions**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensions) collection by calling the [**Add**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509extensions-add) method.</span></span>
4.  <span data-ttu-id="6512a-137">建立 [**IX509AttributeExtensions**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509attributeextensions) 物件，並呼叫 [**InitializeEncode**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509attributeextensions-initializeencode) 方法，並在輸入時指定 [**IX509Extensions**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensions) 集合。</span><span class="sxs-lookup"><span data-stu-id="6512a-137">Create an [**IX509AttributeExtensions**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509attributeextensions) object and call the [**InitializeEncode**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509attributeextensions-initializeencode) method, specifying the [**IX509Extensions**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensions) collection on input.</span></span>
5.  <span data-ttu-id="6512a-138">藉由呼叫現有 [**IX509CertificateRequestPkcs10**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequestpkcs10)或 [**IX509CertificateRequestCmc**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequestcmc)要求物件上的 [**CryptAttributes**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequestpkcs10-get_cryptattributes)屬性，來取出 [**ICryptAttributes**](/windows/desktop/api/CertEnroll/nn-certenroll-icryptattributes)集合物件。</span><span class="sxs-lookup"><span data-stu-id="6512a-138">Retrieve an [**ICryptAttributes**](/windows/desktop/api/CertEnroll/nn-certenroll-icryptattributes) collection object by calling the [**CryptAttributes**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequestpkcs10-get_cryptattributes) property on an existing [**IX509CertificateRequestPkcs10**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequestpkcs10) or [**IX509CertificateRequestCmc**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequestcmc) request object.</span></span>

## <a name="addcerttypetorequestwstrex"></a><span data-ttu-id="6512a-139">AddCertTypeToRequestWStrEx</span><span class="sxs-lookup"><span data-stu-id="6512a-139">AddCertTypeToRequestWStrEx</span></span>

<span data-ttu-id="6512a-140">Xenroll.dll 中的 [**AddCertTypeToRequestWStrEx**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-addcerttypetorequestwstrex) 函式會依名稱、物件識別碼和版本將憑證範本新增至要求。</span><span class="sxs-lookup"><span data-stu-id="6512a-140">The [**AddCertTypeToRequestWStrEx**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-addcerttypetorequestwstrex) function in Xenroll.dll adds a certificate template to a request by name, object identifier, and version.</span></span>

<span data-ttu-id="6512a-141">如需如何使用 CertEnroll.dll 在要求中併入範本資訊的相關資訊，請參閱 AddCertTypeToRequestWStr。</span><span class="sxs-lookup"><span data-stu-id="6512a-141">For information about how to use CertEnroll.dll to incorporate template information in a request, see AddCertTypeToRequestWStr.</span></span>

## <a name="addextensionstorequest"></a><span data-ttu-id="6512a-142">AddExtensionsToRequest</span><span class="sxs-lookup"><span data-stu-id="6512a-142">AddExtensionsToRequest</span></span>

<span data-ttu-id="6512a-143">Xenroll.dll 中的 [**AddExtensionsToRequest**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-addextensionstorequest) 函式會將擴充功能的集合加入至要求。</span><span class="sxs-lookup"><span data-stu-id="6512a-143">The [**AddExtensionsToRequest**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-addextensionstorequest) function in Xenroll.dll adds a collection of extensions to a request.</span></span>

<span data-ttu-id="6512a-144">在 CertEnroll.dll 中，會將擴充功能新增至 CMC 或 PKCS 10 要求的屬性集合 \# 。</span><span class="sxs-lookup"><span data-stu-id="6512a-144">In CertEnroll.dll, extensions are added to the attributes collection of a CMC or a PKCS \#10 request.</span></span> <span data-ttu-id="6512a-145">若要加入延伸模組，請執行下列動作：</span><span class="sxs-lookup"><span data-stu-id="6512a-145">To add extensions, perform the following actions:</span></span>

1.  <span data-ttu-id="6512a-146">建立 [**IX509Extensions**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensions) 物件。</span><span class="sxs-lookup"><span data-stu-id="6512a-146">Create an [**IX509Extensions**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensions) object.</span></span>
2.  <span data-ttu-id="6512a-147">建立 [**IX509Extension**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extension) 物件，並呼叫 [**Initialize**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509extension-initialize) 方法，從物件識別碼和延伸模組值建立延伸，或使用先前所列的任何介面來定義其中一個較常見的延伸模組。</span><span class="sxs-lookup"><span data-stu-id="6512a-147">Create an [**IX509Extension**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extension) object and call the [**Initialize**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509extension-initialize) method to create an extension from an object identifier and extension value or use any of the interfaces listed earlier to define one of the more common extensions.</span></span>
3.  <span data-ttu-id="6512a-148">藉由呼叫 [**add**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509extensions-add)方法，將在上一個步驟中建立的每個新擴充功能新增至 [**IX509Extensions**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensions)集合。</span><span class="sxs-lookup"><span data-stu-id="6512a-148">Add each new extension created in the preceding step to the [**IX509Extensions**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensions) collection by calling the [**Add**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509extensions-add) method.</span></span>

## <a name="addextensiontorequestwstr"></a><span data-ttu-id="6512a-149">addExtensionToRequestWStr</span><span class="sxs-lookup"><span data-stu-id="6512a-149">addExtensionToRequestWStr</span></span>

<span data-ttu-id="6512a-150">Xenroll.dll 中的 [**addExtensionToRequestWStr**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-addextensiontorequestwstr) 函式會在要求中新增特定的擴充功能。</span><span class="sxs-lookup"><span data-stu-id="6512a-150">The [**addExtensionToRequestWStr**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-addextensiontorequestwstr) function in Xenroll.dll adds a specific extension to the request.</span></span>

<span data-ttu-id="6512a-151">在 CertEnroll.dll 中，必須先定義特定的擴充功能，並將其新增至延伸模組集合，再將擴充集合新增至 CMC 或 PKCS 10 要求的屬性集合 \# 。</span><span class="sxs-lookup"><span data-stu-id="6512a-151">In CertEnroll.dll, a specific extension must be defined and added to an extensions collection before the extension collection is added to the attributes collection of a CMC or a PKCS \#10 request.</span></span> <span data-ttu-id="6512a-152">如需詳細資訊，請參閱上述 AddExtensionsToRequest 討論。</span><span class="sxs-lookup"><span data-stu-id="6512a-152">For more information see the AddExtensionsToRequest discussion above.</span></span>

## <a name="enablesmimecapabilities"></a><span data-ttu-id="6512a-153">EnableSMIMECapabilities</span><span class="sxs-lookup"><span data-stu-id="6512a-153">EnableSMIMECapabilities</span></span>

<span data-ttu-id="6512a-154">Xenroll.dll 中的 [**EnableSMIMECapabilities**](/windows/desktop/api/xenroll/nf-xenroll-ienroll2-get_enablesmimecapabilities) 函式會指定或抓取布林值，指出是否要將 **SMIMECapabilities** 延伸模組加入至要求。</span><span class="sxs-lookup"><span data-stu-id="6512a-154">The [**EnableSMIMECapabilities**](/windows/desktop/api/xenroll/nf-xenroll-ienroll2-get_enablesmimecapabilities) function in Xenroll.dll specifies or retrieves a Boolean value that indicates whether to add the **SMIMECapabilities** extension to the request.</span></span>

<span data-ttu-id="6512a-155">您可以呼叫 [**IX509CertificateRequestPkcs10**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequestpkcs10)物件上的 [**SmimeCapabilities**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequestpkcs10-get_smimecapabilities)屬性，在編碼之前自動將 [**IX509ExtensionSmimeCapabilities**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensionsmimecapabilities)物件新增至要求。</span><span class="sxs-lookup"><span data-stu-id="6512a-155">You can call the [**SmimeCapabilities**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequestpkcs10-get_smimecapabilities) property on the [**IX509CertificateRequestPkcs10**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequestpkcs10) object to automatically add an [**IX509ExtensionSmimeCapabilities**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensionsmimecapabilities) object to the request before encoding.</span></span>

## <a name="includesubjectkeyid"></a><span data-ttu-id="6512a-156">IncludeSubjectKeyID</span><span class="sxs-lookup"><span data-stu-id="6512a-156">IncludeSubjectKeyID</span></span>

<span data-ttu-id="6512a-157">Xenroll.dll 中的 [**IncludeSubjectKeyID**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-get_includesubjectkeyid) 函式會指定或抓取布林值，指出是否要將 **SubjectKeyIdentifier** 延伸模組加入至要求。</span><span class="sxs-lookup"><span data-stu-id="6512a-157">The [**IncludeSubjectKeyID**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-get_includesubjectkeyid) function in Xenroll.dll specifies or retrieves a Boolean value that indicates whether to add the **SubjectKeyIdentifier** extension to the request.</span></span>

<span data-ttu-id="6512a-158">根據預設，初始化 [**IX509CertificateRequestPkcs10**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequestpkcs10)要求物件時，會建立 **SubjectKeyIdentifier** 延伸模組。</span><span class="sxs-lookup"><span data-stu-id="6512a-158">By default, the **SubjectKeyIdentifier** extension is created when the [**IX509CertificateRequestPkcs10**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequestpkcs10) request object is initialized.</span></span> <span data-ttu-id="6512a-159">您可以藉由呼叫 [**SuppressOids**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequestpkcs10-get_suppressoids) 屬性來覆寫此行為。</span><span class="sxs-lookup"><span data-stu-id="6512a-159">You can override this behavior by calling the [**SuppressOids**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequestpkcs10-get_suppressoids) property.</span></span>

<span data-ttu-id="6512a-160">如果您有 [*公開/私密金鑰*](/windows/desktop/SecGloss/p-gly)組，您也可以在 CertEnroll.dll 中使用 [**IX509ExtensionSubjectKeyIdentifier**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensionsubjectkeyidentifier) 介面，藉由執行下列動作，將 **SubjectKeyIdentifier** 擴充功能新增至憑證要求：</span><span class="sxs-lookup"><span data-stu-id="6512a-160">If you have a [*public/private key pair*](/windows/desktop/SecGloss/p-gly), you can also use the [**IX509ExtensionSubjectKeyIdentifier**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensionsubjectkeyidentifier) interface in CertEnroll.dll to add a **SubjectKeyIdentifier** extension to a certificate request by performing the following actions:</span></span>

1.  <span data-ttu-id="6512a-161">建立 [**IX509Extensions**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensions) 物件。</span><span class="sxs-lookup"><span data-stu-id="6512a-161">Create an [**IX509Extensions**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensions) object.</span></span>
2.  <span data-ttu-id="6512a-162">建立 [**IX509ExtensionSubjectKeyIdentifier**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensionsubjectkeyidentifier) 物件，並呼叫 [**InitializeEncode**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509extensionsubjectkeyidentifier-initializeencode) 方法，並指定包含識別碼的字串。</span><span class="sxs-lookup"><span data-stu-id="6512a-162">Create an [**IX509ExtensionSubjectKeyIdentifier**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensionsubjectkeyidentifier) object and call the [**InitializeEncode**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509extensionsubjectkeyidentifier-initializeencode) method, specifying a string that contains the identifier.</span></span> <span data-ttu-id="6512a-163">一般來說，這是 CA 簽署憑證中包含之 [*公開金鑰*](/windows/desktop/SecGloss/p-gly) 的20位元組 sha-1 雜湊。</span><span class="sxs-lookup"><span data-stu-id="6512a-163">Typically, this is a 20-byte SHA-1 hash of the [*public key*](/windows/desktop/SecGloss/p-gly) contained in the CA signing certificate.</span></span>
3.  <span data-ttu-id="6512a-164">藉由呼叫 [**add**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509extensions-add)方法，將建立的延伸模組加入至 [**IX509Extensions**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensions)集合。</span><span class="sxs-lookup"><span data-stu-id="6512a-164">Add the extension created to the [**IX509Extensions**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensions) collection by calling the [**Add**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509extensions-add) method.</span></span>
4.  <span data-ttu-id="6512a-165">建立 [**IX509AttributeExtensions**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509attributeextensions) 物件，並呼叫 [**InitializeEncode**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509attributeextensions-initializeencode) 方法，並在輸入時指定 [**IX509Extensions**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensions) 集合。</span><span class="sxs-lookup"><span data-stu-id="6512a-165">Create an [**IX509AttributeExtensions**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509attributeextensions) object and call the [**InitializeEncode**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509attributeextensions-initializeencode) method, specifying the [**IX509Extensions**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensions) collection on input.</span></span>
5.  <span data-ttu-id="6512a-166">藉由呼叫現有 [**IX509CertificateRequestPkcs10**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequestpkcs10)或 [**IX509CertificateRequestCmc**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequestcmc)要求物件上的 [**CryptAttributes**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequestpkcs10-get_cryptattributes)屬性，來取出 [**ICryptAttributes**](/windows/desktop/api/CertEnroll/nn-certenroll-icryptattributes)集合物件。</span><span class="sxs-lookup"><span data-stu-id="6512a-166">Retrieve an [**ICryptAttributes**](/windows/desktop/api/CertEnroll/nn-certenroll-icryptattributes) collection object by calling the [**CryptAttributes**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequestpkcs10-get_cryptattributes) property on an existing [**IX509CertificateRequestPkcs10**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequestpkcs10) or [**IX509CertificateRequestCmc**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequestcmc) request object.</span></span>

## <a name="resetextensions"></a><span data-ttu-id="6512a-167">resetExtensions</span><span class="sxs-lookup"><span data-stu-id="6512a-167">resetExtensions</span></span>

<span data-ttu-id="6512a-168">Xenroll.dll 中的 [**resetExtensions**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-resetextensions) 函式會從要求中移除擴充功能集合。</span><span class="sxs-lookup"><span data-stu-id="6512a-168">The [**resetExtensions**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-resetextensions) function in Xenroll.dll removes the extension collection from the request.</span></span>

<span data-ttu-id="6512a-169">若要使用 CertEnroll.dll 從索引編號移除要求中的延伸模組，請在 [**IX509Extensions**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensions)集合上呼叫 [**remove**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509extensions-remove)方法。</span><span class="sxs-lookup"><span data-stu-id="6512a-169">To remove an extension from a request by index number using CertEnroll.dll, call the [**Remove**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509extensions-remove) method on the [**IX509Extensions**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensions) collection.</span></span> <span data-ttu-id="6512a-170">若要從要求中移除所有屬性，請呼叫 [**Clear**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509extensions-clear) 方法。</span><span class="sxs-lookup"><span data-stu-id="6512a-170">To remove all attributes from a request, call the [**Clear**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509extensions-clear) method.</span></span>

## <a name="related-topics"></a><span data-ttu-id="6512a-171">相關主題</span><span class="sxs-lookup"><span data-stu-id="6512a-171">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="6512a-172">將 Xenroll.dll 對應至 CertEnroll.dll</span><span class="sxs-lookup"><span data-stu-id="6512a-172">Mapping Xenroll.dll to CertEnroll.dll</span></span>](mapping-xenroll-dll-to-certenroll-dll.md)
</dt> <dt>

[<span data-ttu-id="6512a-173">**ICryptAttributes**</span><span class="sxs-lookup"><span data-stu-id="6512a-173">**ICryptAttributes**</span></span>](/windows/desktop/api/CertEnroll/nn-certenroll-icryptattributes)
</dt> <dt>

[<span data-ttu-id="6512a-174">**IX509Extension**</span><span class="sxs-lookup"><span data-stu-id="6512a-174">**IX509Extension**</span></span>](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extension)
</dt> <dt>

[<span data-ttu-id="6512a-175">**IX509Extensions**</span><span class="sxs-lookup"><span data-stu-id="6512a-175">**IX509Extensions**</span></span>](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensions)
</dt> </dl>

 

 
