---
description: 屬性是用來將值與憑證產生關聯。
ms.assetid: a6433416-fe77-4bb0-bd8e-9410a49ab861
title: 外部屬性函式
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 26c8148022bf604aa90780787c068b330c469ae6
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/08/2021
ms.locfileid: "104194382"
---
# <a name="external-property-functions"></a><span data-ttu-id="5c983-103">外部屬性函式</span><span class="sxs-lookup"><span data-stu-id="5c983-103">External Property Functions</span></span>

<span data-ttu-id="5c983-104">屬性是用來將值與憑證產生關聯。</span><span class="sxs-lookup"><span data-stu-id="5c983-104">Properties are used to associate a value with a certificate.</span></span> <span data-ttu-id="5c983-105">屬性絕不會由 [*憑證授權單位*](/windows/desktop/SecGloss/c-gly) 單位 (CA) 傳送或處理，而且不會儲存在憑證內。</span><span class="sxs-lookup"><span data-stu-id="5c983-105">Properties are never sent to or processed by a [*certification authority*](/windows/desktop/SecGloss/c-gly) (CA), and they are not stored inside a certificate.</span></span> <span data-ttu-id="5c983-106">一般而言，在從 CA 接收憑證之後，以及將憑證儲存在存放區之前，它們都會與憑證相關聯。</span><span class="sxs-lookup"><span data-stu-id="5c983-106">Typically, they are associated with a certificate after the certificate is received from the CA and before it is saved in a store.</span></span> <span data-ttu-id="5c983-107">這些屬性會連同憑證儲存在存放區中。</span><span class="sxs-lookup"><span data-stu-id="5c983-107">The properties are saved in the store along with the certificate.</span></span> <span data-ttu-id="5c983-108">CertEnroll.dll 會實 [**ICertProperty**](/windows/desktop/api/CertEnroll/nn-certenroll-icertproperty) 介面，以及下列衍生自 **ICertProperty** 的介面：</span><span class="sxs-lookup"><span data-stu-id="5c983-108">CertEnroll.dll implements the [**ICertProperty**](/windows/desktop/api/CertEnroll/nn-certenroll-icertproperty) interface and the following interfaces derived from **ICertProperty**:</span></span>

-   [<span data-ttu-id="5c983-109">**ICertPropertyArchived**</span><span class="sxs-lookup"><span data-stu-id="5c983-109">**ICertPropertyArchived**</span></span>](/windows/desktop/api/CertEnroll/nn-certenroll-icertpropertyarchived)
-   [<span data-ttu-id="5c983-110">**ICertPropertyArchivedKeyHash**</span><span class="sxs-lookup"><span data-stu-id="5c983-110">**ICertPropertyArchivedKeyHash**</span></span>](/windows/desktop/api/CertEnroll/nn-certenroll-icertpropertyarchivedkeyhash)
-   [<span data-ttu-id="5c983-111">**ICertPropertyAutoEnroll**</span><span class="sxs-lookup"><span data-stu-id="5c983-111">**ICertPropertyAutoEnroll**</span></span>](/windows/desktop/api/CertEnroll/nn-certenroll-icertpropertyautoenroll)
-   [<span data-ttu-id="5c983-112">**ICertPropertyBackedUp**</span><span class="sxs-lookup"><span data-stu-id="5c983-112">**ICertPropertyBackedUp**</span></span>](/windows/desktop/api/CertEnroll/nn-certenroll-icertpropertybackedup)
-   [<span data-ttu-id="5c983-113">**ICertPropertyDescription**</span><span class="sxs-lookup"><span data-stu-id="5c983-113">**ICertPropertyDescription**</span></span>](/windows/desktop/api/CertEnroll/nn-certenroll-icertpropertydescription)
-   [<span data-ttu-id="5c983-114">**ICertPropertyEnrollment**</span><span class="sxs-lookup"><span data-stu-id="5c983-114">**ICertPropertyEnrollment**</span></span>](/windows/desktop/api/CertEnroll/nn-certenroll-icertpropertyenrollment)
-   [<span data-ttu-id="5c983-115">**ICertPropertyFriendlyName**</span><span class="sxs-lookup"><span data-stu-id="5c983-115">**ICertPropertyFriendlyName**</span></span>](/windows/desktop/api/CertEnroll/nn-certenroll-icertpropertyfriendlyname)
-   [<span data-ttu-id="5c983-116">**ICertPropertyKeyProvInfo**</span><span class="sxs-lookup"><span data-stu-id="5c983-116">**ICertPropertyKeyProvInfo**</span></span>](/windows/desktop/api/CertEnroll/nn-certenroll-icertpropertykeyprovinfo)
-   [<span data-ttu-id="5c983-117">**ICertPropertyRenewal**</span><span class="sxs-lookup"><span data-stu-id="5c983-117">**ICertPropertyRenewal**</span></span>](/windows/desktop/api/CertEnroll/nn-certenroll-icertpropertyrenewal)
-   [<span data-ttu-id="5c983-118">**ICertPropertyRequestOriginator**</span><span class="sxs-lookup"><span data-stu-id="5c983-118">**ICertPropertyRequestOriginator**</span></span>](/windows/desktop/api/CertEnroll/nn-certenroll-icertpropertyrequestoriginator)
-   [<span data-ttu-id="5c983-119">**ICertPropertySHA1Hash**</span><span class="sxs-lookup"><span data-stu-id="5c983-119">**ICertPropertySHA1Hash**</span></span>](/windows/desktop/api/CertEnroll/nn-certenroll-icertpropertysha1hash)

<span data-ttu-id="5c983-120">下列各節會識別 Xenroll.dll 所匯出的函式，以管理外部憑證屬性。</span><span class="sxs-lookup"><span data-stu-id="5c983-120">Each of the following sections identifies a function exported by Xenroll.dll to manage external certificate properties.</span></span> <span data-ttu-id="5c983-121">每個章節也會討論如何使用 CertEnroll.dll 來取代函式，或指出兩個程式庫之間沒有對應存在：</span><span class="sxs-lookup"><span data-stu-id="5c983-121">Each section also discusses how to use CertEnroll.dll to replace the function or indicates that no mapping between the two libraries exists:</span></span>

-   [<span data-ttu-id="5c983-122">addBlobPropertyToCertificateWStr</span><span class="sxs-lookup"><span data-stu-id="5c983-122">addBlobPropertyToCertificateWStr</span></span>](#addblobpropertytocertificatewstr)
-   [<span data-ttu-id="5c983-123">GetPrivateKeyArchiveCertificate</span><span class="sxs-lookup"><span data-stu-id="5c983-123">GetPrivateKeyArchiveCertificate</span></span>](#getprivatekeyarchivecertificate)
-   [<span data-ttu-id="5c983-124">resetBlobProperties</span><span class="sxs-lookup"><span data-stu-id="5c983-124">resetBlobProperties</span></span>](#resetblobproperties)
-   [<span data-ttu-id="5c983-125">SetPrivateKeyArchiveCertificate</span><span class="sxs-lookup"><span data-stu-id="5c983-125">SetPrivateKeyArchiveCertificate</span></span>](#setprivatekeyarchivecertificate)
-   [<span data-ttu-id="5c983-126">SetSignerCertificate</span><span class="sxs-lookup"><span data-stu-id="5c983-126">SetSignerCertificate</span></span>](#setsignercertificate)
-   [<span data-ttu-id="5c983-127">ThumbPrintWStr</span><span class="sxs-lookup"><span data-stu-id="5c983-127">ThumbPrintWStr</span></span>](#thumbprintwstr)
-   [<span data-ttu-id="5c983-128">相關主題</span><span class="sxs-lookup"><span data-stu-id="5c983-128">Related topics</span></span>](#related-topics)

## <a name="addblobpropertytocertificatewstr"></a><span data-ttu-id="5c983-129">addBlobPropertyToCertificateWStr</span><span class="sxs-lookup"><span data-stu-id="5c983-129">addBlobPropertyToCertificateWStr</span></span>

<span data-ttu-id="5c983-130">Xenroll.dll 中的 [**addBlobPropertyToCertificateWStr**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-addblobpropertytocertificatewstr) 函數會將屬性加入至憑證。</span><span class="sxs-lookup"><span data-stu-id="5c983-130">The [**addBlobPropertyToCertificateWStr**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-addblobpropertytocertificatewstr) function in Xenroll.dll adds a property to the certificate.</span></span>

<span data-ttu-id="5c983-131">在 CertEnroll.dll 中，所有衍生自 [**ICertProperty**](/windows/desktop/api/CertEnroll/nn-certenroll-icertproperty) 的物件都會執行 [**SetValueOnCertificate**](/windows/desktop/api/CertEnroll/nf-certenroll-icertproperty-setvalueoncertificate) 方法，您可以使用此方法將屬性與憑證產生關聯。</span><span class="sxs-lookup"><span data-stu-id="5c983-131">In CertEnroll.dll, all of the objects derived from [**ICertProperty**](/windows/desktop/api/CertEnroll/nn-certenroll-icertproperty) implement a [**SetValueOnCertificate**](/windows/desktop/api/CertEnroll/nf-certenroll-icertproperty-setvalueoncertificate) method that you can use to associate a property with a certificate.</span></span> <span data-ttu-id="5c983-132">此外， [**IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment) 物件也會直接執行 [**enrollment.certificatefriendlyname**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-get_certificatefriendlyname) 和 [**CertificateDescription**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-get_certificatedescription) 屬性。</span><span class="sxs-lookup"><span data-stu-id="5c983-132">Also, the [**IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment) object directly implements the [**CertificateFriendlyName**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-get_certificatefriendlyname) and [**CertificateDescription**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-get_certificatedescription) properties.</span></span>

## <a name="getprivatekeyarchivecertificate"></a><span data-ttu-id="5c983-133">GetPrivateKeyArchiveCertificate</span><span class="sxs-lookup"><span data-stu-id="5c983-133">GetPrivateKeyArchiveCertificate</span></span>

<span data-ttu-id="5c983-134">Xenroll.dll 中的 [**GetPrivateKeyArchiveCertificate**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-getprivatekeyarchivecertificate) 函式會抓取用來保存 [*私密金鑰*](/windows/desktop/SecGloss/p-gly)的 exchange 憑證。</span><span class="sxs-lookup"><span data-stu-id="5c983-134">The [**GetPrivateKeyArchiveCertificate**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-getprivatekeyarchivecertificate) function in Xenroll.dll retrieves the exchange certificate used to archive a [*private key*](/windows/desktop/SecGloss/p-gly).</span></span>

<span data-ttu-id="5c983-135">您可以使用 CertEnroll.dll 中的 [**IX509CertificateRequestCmc**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequestcmc) 物件來建立 CA 的要求，以封存您的私密金鑰。</span><span class="sxs-lookup"><span data-stu-id="5c983-135">You can use the [**IX509CertificateRequestCmc**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequestcmc) object in CertEnroll.dll to create a request for a CA to archive your private key.</span></span> <span data-ttu-id="5c983-136">您必須從 CA 取出 exchange 憑證，並使用該憑證中包含的 [*公開金鑰*](/windows/desktop/SecGloss/p-gly) 來加密您要提交以封存的私密金鑰。</span><span class="sxs-lookup"><span data-stu-id="5c983-136">You must retrieve an exchange certificate from the CA and use the [*public key*](/windows/desktop/SecGloss/p-gly) contained in that certificate to encrypt the private key that you are submitting for archival.</span></span> <span data-ttu-id="5c983-137">若要指定或取出 CA exchange 憑證，請呼叫該物件上的 [**KeyArchivalCertificate**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequestcmc-get_keyarchivalcertificate) 屬性。</span><span class="sxs-lookup"><span data-stu-id="5c983-137">To specify or retrieve a CA exchange certificate, call the [**KeyArchivalCertificate**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequestcmc-get_keyarchivalcertificate) property on that object.</span></span>

## <a name="resetblobproperties"></a><span data-ttu-id="5c983-138">resetBlobProperties</span><span class="sxs-lookup"><span data-stu-id="5c983-138">resetBlobProperties</span></span>

<span data-ttu-id="5c983-139">Xenroll.dll 中的 [**resetBlobProperties**](/windows/desktop/api/xenroll/nf-xenroll-icenroll4-resetblobproperties) 函式會從憑證中移除屬性集合。</span><span class="sxs-lookup"><span data-stu-id="5c983-139">The [**resetBlobProperties**](/windows/desktop/api/xenroll/nf-xenroll-icenroll4-resetblobproperties) function in Xenroll.dll removes the property collection from the certificate.</span></span>

<span data-ttu-id="5c983-140">在 CertEnroll.dll 中，所有衍生自 [**ICertProperty**](/windows/desktop/api/CertEnroll/nn-certenroll-icertproperty) 的屬性物件都會執行 [**RemoveFromCertificate**](/windows/desktop/api/CertEnroll/nf-certenroll-icertproperty-removefromcertificate) 屬性，讓您可以用來將屬性與憑證解除關聯。</span><span class="sxs-lookup"><span data-stu-id="5c983-140">In CertEnroll.dll, all of the property objects derived from [**ICertProperty**](/windows/desktop/api/CertEnroll/nn-certenroll-icertproperty) implement the [**RemoveFromCertificate**](/windows/desktop/api/CertEnroll/nf-certenroll-icertproperty-removefromcertificate) property that you can use to disassociate a property from a certificate.</span></span>

## <a name="setprivatekeyarchivecertificate"></a><span data-ttu-id="5c983-141">SetPrivateKeyArchiveCertificate</span><span class="sxs-lookup"><span data-stu-id="5c983-141">SetPrivateKeyArchiveCertificate</span></span>

<span data-ttu-id="5c983-142">Xenroll.dll 中的 [**SetPrivateKeyArchiveCertificate**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-setprivatekeyarchivecertificate) 函數會指定用來封存私密金鑰的 exchange 憑證。</span><span class="sxs-lookup"><span data-stu-id="5c983-142">The [**SetPrivateKeyArchiveCertificate**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-setprivatekeyarchivecertificate) function in Xenroll.dll specifies an exchange certificate used to archive a private key.</span></span>

<span data-ttu-id="5c983-143">您可以使用 CertEnroll.dll 中的 [**IX509CertificateRequestCmc**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequestcmc) 物件來建立 CA 的要求，以封存您的私密金鑰。</span><span class="sxs-lookup"><span data-stu-id="5c983-143">You can use the [**IX509CertificateRequestCmc**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequestcmc) object in CertEnroll.dll to create a request for a CA to archive your private key.</span></span> <span data-ttu-id="5c983-144">您必須從 CA 取出 exchange 憑證，並使用該憑證中包含的公開金鑰來加密您要提交以封存的私密金鑰。</span><span class="sxs-lookup"><span data-stu-id="5c983-144">You must retrieve an exchange certificate from the CA and use the public key contained in that certificate to encrypt the private key that you are submitting for archival.</span></span> <span data-ttu-id="5c983-145">若要指定或取出 CA exchange 憑證，請呼叫該物件上的 [**KeyArchivalCertificate**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequestcmc-get_keyarchivalcertificate) 屬性。</span><span class="sxs-lookup"><span data-stu-id="5c983-145">To specify or retrieve a CA exchange certificate, call the [**KeyArchivalCertificate**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequestcmc-get_keyarchivalcertificate) property on that object.</span></span>

## <a name="setsignercertificate"></a><span data-ttu-id="5c983-146">SetSignerCertificate</span><span class="sxs-lookup"><span data-stu-id="5c983-146">SetSignerCertificate</span></span>

<span data-ttu-id="5c983-147">Xenroll.dll 中的 [**SetSignerCertificate**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-setsignercertificate) 函數會指定簽署者憑證。</span><span class="sxs-lookup"><span data-stu-id="5c983-147">The [**SetSignerCertificate**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-setsignercertificate) function in Xenroll.dll Specifies a signer certificate.</span></span>

<span data-ttu-id="5c983-148">CertEnroll.dll 中的 [**ISignerCertificate**](/windows/desktop/api/CertEnroll/nn-certenroll-isignercertificate) 物件可用於簽署 [*PKCS \# 7*](/windows/desktop/SecGloss/p-gly)、CMC 或自我簽署的 [*憑證要求*](/windows/desktop/SecGloss/c-gly)。</span><span class="sxs-lookup"><span data-stu-id="5c983-148">The [**ISignerCertificate**](/windows/desktop/api/CertEnroll/nn-certenroll-isignercertificate) object in CertEnroll.dll can be used to sign a [*PKCS \#7*](/windows/desktop/SecGloss/p-gly), CMC, or self-signed [*certificate request*](/windows/desktop/SecGloss/c-gly).</span></span> <span data-ttu-id="5c983-149">您可以藉由呼叫下列其中一個屬性，使用現有的簽署憑證來初始化物件，並將它與要求產生關聯：</span><span class="sxs-lookup"><span data-stu-id="5c983-149">You can initialize the object by using an existing signing certificate and associate it with a request by calling one of the following properties:</span></span>

-   <span data-ttu-id="5c983-150">IX509CertificateRequestCmc 上的 [**SignerCertificates**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequestcmc-get_signercertificates) [](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequestcmc)</span><span class="sxs-lookup"><span data-stu-id="5c983-150">[**SignerCertificates**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequestcmc-get_signercertificates) on [**IX509CertificateRequestCmc**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequestcmc)</span></span>
-   <span data-ttu-id="5c983-151">IX509CertificateRequestPkcs7 上的 [**SignerCertificate**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequestpkcs7-get_signercertificate) [](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequestpkcs7)</span><span class="sxs-lookup"><span data-stu-id="5c983-151">[**SignerCertificate**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequestpkcs7-get_signercertificate) on [**IX509CertificateRequestPkcs7**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequestpkcs7)</span></span>
-   <span data-ttu-id="5c983-152">IX509CertificateRequestCertificate 上的 [**SignerCertificate**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequestcertificate-get_signercertificate) [](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequestcertificate)</span><span class="sxs-lookup"><span data-stu-id="5c983-152">[**SignerCertificate**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequestcertificate-get_signercertificate) on [**IX509CertificateRequestCertificate**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequestcertificate)</span></span>

<span data-ttu-id="5c983-153">此外，如果您從內部要求和範本初始化 CMC 要求，或從現有的要求初始化 PKCS \# 7 要求，則可能會設定簽署憑證。</span><span class="sxs-lookup"><span data-stu-id="5c983-153">Also, if you initialize a CMC request from an inner request and a template or you initialize a PKCS \#7 request from an existing request, the signing certificate may be set.</span></span>

## <a name="thumbprintwstr"></a><span data-ttu-id="5c983-154">ThumbPrintWStr</span><span class="sxs-lookup"><span data-stu-id="5c983-154">ThumbPrintWStr</span></span>

<span data-ttu-id="5c983-155">Xenroll.dll 中的 [**ThumbPrintWStr**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-get_thumbprintwstr) 函數會指定或抓取憑證雜湊的值。</span><span class="sxs-lookup"><span data-stu-id="5c983-155">The [**ThumbPrintWStr**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-get_thumbprintwstr) function in Xenroll.dll specifies or retrieves the value of the certificate hash.</span></span>

<span data-ttu-id="5c983-156">在 CertEnroll.dll 中，您可以使用 [**ICertPropertySHA1Hash**](/windows/desktop/api/CertEnroll/nn-certenroll-icertpropertysha1hash)物件來取得 [*雜湊*](/windows/desktop/SecGloss/h-gly)值， () 由呼叫 [**InitializeFromCertificate**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequestpkcs7-initializefromcertificate)方法建立的 [*指紋*](/windows/desktop/SecGloss/t-gly)。</span><span class="sxs-lookup"><span data-stu-id="5c983-156">In CertEnroll.dll, you can use the [**ICertPropertySHA1Hash**](/windows/desktop/api/CertEnroll/nn-certenroll-icertpropertysha1hash) object to retrieve a [*hash*](/windows/desktop/SecGloss/h-gly) value ([*thumbprint*](/windows/desktop/SecGloss/t-gly)) created by calling the [**InitializeFromCertificate**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequestpkcs7-initializefromcertificate) method.</span></span>

## <a name="related-topics"></a><span data-ttu-id="5c983-157">相關主題</span><span class="sxs-lookup"><span data-stu-id="5c983-157">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="5c983-158">將 Xenroll.dll 對應至 CertEnroll.dll</span><span class="sxs-lookup"><span data-stu-id="5c983-158">Mapping Xenroll.dll to CertEnroll.dll</span></span>](mapping-xenroll-dll-to-certenroll-dll.md)
</dt> </dl>

 

 
