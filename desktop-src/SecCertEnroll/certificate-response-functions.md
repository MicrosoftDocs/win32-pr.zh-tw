---
description: 實行 IX509Enrollment 介面。
ms.assetid: bcf5c2f0-b99f-4de5-83f4-44f17dc31cd4
title: 憑證回應功能
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 15eec71d0493fa4961988b86db0397d0fd516508
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/08/2021
ms.locfileid: "106992062"
---
# <a name="certificate-response-functions"></a><span data-ttu-id="e79cf-103">憑證回應功能</span><span class="sxs-lookup"><span data-stu-id="e79cf-103">Certificate Response Functions</span></span>

<span data-ttu-id="e79cf-104">CertEnroll.dll 會 [**IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment) 介面來提交用戶端憑證要求，並安裝 (CA) 的 [*憑證授權單位*](/windows/desktop/SecGloss/c-gly) 單位回應。</span><span class="sxs-lookup"><span data-stu-id="e79cf-104">CertEnroll.dll implements the [**IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment) interface to submit a client certificate request and install the response from a [*certification authority*](/windows/desktop/SecGloss/c-gly) (CA).</span></span>

<span data-ttu-id="e79cf-105">註冊程式可以容納下列三種案例：</span><span class="sxs-lookup"><span data-stu-id="e79cf-105">The enrollment process can accommodate the following three scenarios:</span></span>

<dl> <span data-ttu-id="e79cf-106">頻外註冊</span><span class="sxs-lookup"><span data-stu-id="e79cf-106">Out-of-band enrollment</span></span>

1.  <span data-ttu-id="e79cf-107">呼叫 [**IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment) 物件所執行的任何初始化方法。</span><span class="sxs-lookup"><span data-stu-id="e79cf-107">Call any initialization method implemented by the [**IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment) object.</span></span>
2.  <span data-ttu-id="e79cf-108">呼叫 [**CreateRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest) 方法來取得要求。</span><span class="sxs-lookup"><span data-stu-id="e79cf-108">Call the [**CreateRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest) method to retrieve the request.</span></span>
3.  <span data-ttu-id="e79cf-109">以手動方式或使用其他程式) ，從頻外 (提交要求。</span><span class="sxs-lookup"><span data-stu-id="e79cf-109">Submit the request out of band (manually or by using some other process).</span></span>
4.  <span data-ttu-id="e79cf-110">接收來自 CA 的回應。</span><span class="sxs-lookup"><span data-stu-id="e79cf-110">Receive the response from a CA.</span></span>
5.  <span data-ttu-id="e79cf-111">呼叫 [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) 方法。</span><span class="sxs-lookup"><span data-stu-id="e79cf-111">Call the [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) method.</span></span>

  
<span data-ttu-id="e79cf-112">自動註冊</span><span class="sxs-lookup"><span data-stu-id="e79cf-112">Automatic enrollment</span></span>

1.  <span data-ttu-id="e79cf-113">呼叫 [**IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment) 物件所執行的任何初始化方法。</span><span class="sxs-lookup"><span data-stu-id="e79cf-113">Call any initialization method implemented by the [**IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment) object.</span></span>
2.  <span data-ttu-id="e79cf-114">呼叫 [**註冊**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) 方法。</span><span class="sxs-lookup"><span data-stu-id="e79cf-114">Call the [**Enroll**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) method.</span></span>

  
<span data-ttu-id="e79cf-115">延遲的註冊</span><span class="sxs-lookup"><span data-stu-id="e79cf-115">Delayed enrollment</span></span>

1.  <span data-ttu-id="e79cf-116">呼叫 [**IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment) 物件所執行的任何初始化方法。</span><span class="sxs-lookup"><span data-stu-id="e79cf-116">Call any initialization method implemented by the [**IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment) object.</span></span>
2.  <span data-ttu-id="e79cf-117">呼叫 [**CreateRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest) 方法來取得要求。</span><span class="sxs-lookup"><span data-stu-id="e79cf-117">Call the [**CreateRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest) method to retrieve the request.</span></span>
3.  <span data-ttu-id="e79cf-118">儲存要求，直到您準備好提交要求為止。</span><span class="sxs-lookup"><span data-stu-id="e79cf-118">Store the request until you are ready to submit it.</span></span>
4.  <span data-ttu-id="e79cf-119">當您準備好要註冊時，請呼叫 [**Initialize**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-initialize) 方法來重新初始化註冊物件。</span><span class="sxs-lookup"><span data-stu-id="e79cf-119">When you are ready to enroll, call the [**Initialize**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-initialize) method to reinitialize the enrollment object.</span></span>
5.  <span data-ttu-id="e79cf-120">當 CA 傳回憑證時，呼叫 [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) 方法。</span><span class="sxs-lookup"><span data-stu-id="e79cf-120">Call the [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) method when the CA returns a certificate.</span></span>

  
</dl>

<span data-ttu-id="e79cf-121">在註冊過程中，您可以呼叫 [**IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment)物件上的 [**Status**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-get_status)屬性來取得 [**EnrollmentEnrollStatus**](/windows/desktop/api/CertEnroll/ne-certenroll-enrollmentenrollstatus)列舉值，以識別註冊成功、暫止、已略過、產生錯誤或遭到拒絕。</span><span class="sxs-lookup"><span data-stu-id="e79cf-121">During the enrollment process, you can call the [**Status**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-get_status) property on the [**IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment) object to retrieve an [**EnrollmentEnrollStatus**](/windows/desktop/api/CertEnroll/ne-certenroll-enrollmentenrollstatus) enumeration value that identifies whether enrollment succeeded, is pending, was skipped, generated an error, or was denied.</span></span>

<span data-ttu-id="e79cf-122">下列各節會識別 Xenroll.dll 所匯出的函式，以從 CA 安裝憑證回應。</span><span class="sxs-lookup"><span data-stu-id="e79cf-122">Each of the following sections identifies a function exported by Xenroll.dll to install a certificate response from a CA.</span></span> <span data-ttu-id="e79cf-123">每個章節也會討論如何使用 CertEnroll.dll 來取代函式，或指出兩個程式庫之間沒有對應存在：</span><span class="sxs-lookup"><span data-stu-id="e79cf-123">Each section also discusses how to use CertEnroll.dll to replace the function or indicates that no mapping between the two libraries exists:</span></span>

-   [<span data-ttu-id="e79cf-124">acceptFilePKCS7WStr</span><span class="sxs-lookup"><span data-stu-id="e79cf-124">acceptFilePKCS7WStr</span></span>](#acceptfilepkcs7wstr)
-   [<span data-ttu-id="e79cf-125">acceptFileResponseWStr</span><span class="sxs-lookup"><span data-stu-id="e79cf-125">acceptFileResponseWStr</span></span>](#acceptfileresponsewstr)
-   [<span data-ttu-id="e79cf-126">acceptPKCS7Blob</span><span class="sxs-lookup"><span data-stu-id="e79cf-126">acceptPKCS7Blob</span></span>](#acceptpkcs7blob)
-   [<span data-ttu-id="e79cf-127">acceptResponseBlob</span><span class="sxs-lookup"><span data-stu-id="e79cf-127">acceptResponseBlob</span></span>](#acceptresponseblob)
-   [<span data-ttu-id="e79cf-128">getCertCoNtextFromFileResponseWStr</span><span class="sxs-lookup"><span data-stu-id="e79cf-128">getCertContextFromFileResponseWStr</span></span>](#getcertcontextfromfileresponsewstr)
-   [<span data-ttu-id="e79cf-129">getCertCoNtextFromPKCS7</span><span class="sxs-lookup"><span data-stu-id="e79cf-129">getCertContextFromPKCS7</span></span>](#getcertcontextfrompkcs7)
-   [<span data-ttu-id="e79cf-130">getCertCoNtextFromResponseBlob</span><span class="sxs-lookup"><span data-stu-id="e79cf-130">getCertContextFromResponseBlob</span></span>](#getcertcontextfromresponseblob)
-   [<span data-ttu-id="e79cf-131">InstallPKCS7Blob</span><span class="sxs-lookup"><span data-stu-id="e79cf-131">InstallPKCS7Blob</span></span>](#installpkcs7blobex)
-   [<span data-ttu-id="e79cf-132">InstallPKCS7BlobEx</span><span class="sxs-lookup"><span data-stu-id="e79cf-132">InstallPKCS7BlobEx</span></span>](#installpkcs7blobex)
-   [<span data-ttu-id="e79cf-133">SPCFileNameWStr</span><span class="sxs-lookup"><span data-stu-id="e79cf-133">SPCFileNameWStr</span></span>](#spcfilenamewstr)
-   [<span data-ttu-id="e79cf-134">WriteCertToCSP</span><span class="sxs-lookup"><span data-stu-id="e79cf-134">WriteCertToCSP</span></span>](#writecerttocsp)
-   [<span data-ttu-id="e79cf-135">WriteCertToUserDS</span><span class="sxs-lookup"><span data-stu-id="e79cf-135">WriteCertToUserDS</span></span>](#writecerttouserds)
-   [<span data-ttu-id="e79cf-136">相關主題</span><span class="sxs-lookup"><span data-stu-id="e79cf-136">Related topics</span></span>](#related-topics)

## <a name="acceptfilepkcs7wstr"></a><span data-ttu-id="e79cf-137">acceptFilePKCS7WStr</span><span class="sxs-lookup"><span data-stu-id="e79cf-137">acceptFilePKCS7WStr</span></span>

<span data-ttu-id="e79cf-138">Xenroll.dll 中的 [**acceptFilePKCS7WStr**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-acceptfilepkcs7wstr) 函數會從檔案安裝 [*PKCS \# 7*](/windows/desktop/SecGloss/p-gly) 回應。</span><span class="sxs-lookup"><span data-stu-id="e79cf-138">The [**acceptFilePKCS7WStr**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-acceptfilepkcs7wstr) function in Xenroll.dll installs a [*PKCS \#7*](/windows/desktop/SecGloss/p-gly) response from a file.</span></span>

<span data-ttu-id="e79cf-139">CertEnroll.dll 程式庫不會直接執行從檔案安裝 PKCS \# 7 憑證回應的功能。</span><span class="sxs-lookup"><span data-stu-id="e79cf-139">The CertEnroll.dll library does not directly implement functionality to install a PKCS \#7 certificate response from a file.</span></span> <span data-ttu-id="e79cf-140">不過，您可以建立自訂函式，將檔案資料讀入位元組陣列，然後呼叫 [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) 來安裝回應。</span><span class="sxs-lookup"><span data-stu-id="e79cf-140">You can, however, create a custom function to read the file data into a byte array and call [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) to install the response.</span></span>

<span data-ttu-id="e79cf-141">如果您為 [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse)的第一個參數指定 [**InstallResponseRestrictionFlags**](/windows/desktop/api/CertEnroll/ne-certenroll-installresponserestrictionflags)列舉的 **AllowNoOutstandingRequest** 值，則虛擬憑證不需要存在，如此可讓您在未先呼叫 [**註冊**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll)或 [**CreateRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest)的情況下，安裝憑證。</span><span class="sxs-lookup"><span data-stu-id="e79cf-141">If you specify the **AllowNoOutstandingRequest** value of the [**InstallResponseRestrictionFlags**](/windows/desktop/api/CertEnroll/ne-certenroll-installresponserestrictionflags) enumeration for the first parameter of [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse), a dummy certificate need not exist, thereby enabling you to install a certificate without first calling [**Enroll**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) or [**CreateRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest).</span></span> <span data-ttu-id="e79cf-142">但是，如果您要使用 web 腳本來安裝憑證，要求存放區中必須有虛擬憑證存在。</span><span class="sxs-lookup"><span data-stu-id="e79cf-142">However, if you are installing a certificate by using a web script, a dummy certificate must exist in the request store.</span></span> <span data-ttu-id="e79cf-143">因此，您必須為第一個參數指定 **AllowNone** 。</span><span class="sxs-lookup"><span data-stu-id="e79cf-143">You must therefore specify **AllowNone** for the first parameter.</span></span>

## <a name="acceptfileresponsewstr"></a><span data-ttu-id="e79cf-144">acceptFileResponseWStr</span><span class="sxs-lookup"><span data-stu-id="e79cf-144">acceptFileResponseWStr</span></span>

<span data-ttu-id="e79cf-145">Xenroll.dll 中的 [**acceptFileResponseWStr**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-acceptfileresponsewstr) 函數會從檔案安裝 PKCS \# 7 或 CMC 憑證回應。</span><span class="sxs-lookup"><span data-stu-id="e79cf-145">The [**acceptFileResponseWStr**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-acceptfileresponsewstr) function in Xenroll.dll installs a PKCS \#7 or CMC certificate response from a file.</span></span>

<span data-ttu-id="e79cf-146">CertEnroll.dll 程式庫不會直接執行從檔案安裝憑證回應的功能。</span><span class="sxs-lookup"><span data-stu-id="e79cf-146">The CertEnroll.dll library does not directly implement functionality to install a certificate response from a file.</span></span> <span data-ttu-id="e79cf-147">不過，您可以建立自訂函式，將檔案資料讀入位元組陣列，然後呼叫 [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) 來安裝 PKCS \# 7 或 CMC 回應。</span><span class="sxs-lookup"><span data-stu-id="e79cf-147">You can, however, create a custom function to read the file data into a byte array and call [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) to install the PKCS \#7 or CMC response.</span></span>

<span data-ttu-id="e79cf-148">如果您為 [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse)的第一個參數指定 [**InstallResponseRestrictionFlags**](/windows/desktop/api/CertEnroll/ne-certenroll-installresponserestrictionflags)列舉的 **AllowNoOutstandingRequest** 值，則虛擬憑證不需要存在，如此可讓您在未先呼叫 [**註冊**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll)或 [**CreateRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest)的情況下，安裝憑證。</span><span class="sxs-lookup"><span data-stu-id="e79cf-148">If you specify the **AllowNoOutstandingRequest** value of the [**InstallResponseRestrictionFlags**](/windows/desktop/api/CertEnroll/ne-certenroll-installresponserestrictionflags) enumeration for the first parameter of [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse), a dummy certificate need not exist, thereby enabling you to install a certificate without first calling [**Enroll**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) or [**CreateRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest).</span></span> <span data-ttu-id="e79cf-149">但是，如果您要使用 web 腳本來安裝憑證，要求存放區中必須有虛擬憑證存在。</span><span class="sxs-lookup"><span data-stu-id="e79cf-149">However, if you are installing a certificate by using a web script, a dummy certificate must exist in the request store.</span></span> <span data-ttu-id="e79cf-150">因此，您必須為第一個參數指定 **AllowNone** 。</span><span class="sxs-lookup"><span data-stu-id="e79cf-150">You must therefore specify **AllowNone** for the first parameter.</span></span>

## <a name="acceptpkcs7blob"></a><span data-ttu-id="e79cf-151">acceptPKCS7Blob</span><span class="sxs-lookup"><span data-stu-id="e79cf-151">acceptPKCS7Blob</span></span>

<span data-ttu-id="e79cf-152">Xenroll.dll 中的 [**acceptPKCS7Blob**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-acceptpkcs7blob) 函式會安裝 \# 包含在位元組陣列中的 PKCS 7 回應。</span><span class="sxs-lookup"><span data-stu-id="e79cf-152">The [**acceptPKCS7Blob**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-acceptpkcs7blob) function in Xenroll.dll installs a PKCS \#7 response contained in a byte array.</span></span>

<span data-ttu-id="e79cf-153">您可以呼叫 [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) 來安裝 PKCS \# 7 訊息。</span><span class="sxs-lookup"><span data-stu-id="e79cf-153">You can call [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) to install a PKCS \#7 message.</span></span> <span data-ttu-id="e79cf-154">如果您為 [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse)的第一個參數指定 [**InstallResponseRestrictionFlags**](/windows/desktop/api/CertEnroll/ne-certenroll-installresponserestrictionflags)列舉的 **AllowNoOutstandingRequest** 值，則虛擬憑證不需要存在，因此可讓您在 \# 未先呼叫 [**註冊**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll)或 [**CreateRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest)的情況下安裝 PKCS 7 回應。</span><span class="sxs-lookup"><span data-stu-id="e79cf-154">If you specify the **AllowNoOutstandingRequest** value of the [**InstallResponseRestrictionFlags**](/windows/desktop/api/CertEnroll/ne-certenroll-installresponserestrictionflags) enumeration for the first parameter of [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse), a dummy certificate need not exist, thereby enabling you to install the PKCS \#7 response without first calling [**Enroll**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) or [**CreateRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest).</span></span> <span data-ttu-id="e79cf-155">但是，如果您要使用 web 腳本來安裝憑證，要求存放區中必須有虛擬憑證存在。</span><span class="sxs-lookup"><span data-stu-id="e79cf-155">However, if you are installing a certificate by using a web script, a dummy certificate must exist in the request store.</span></span> <span data-ttu-id="e79cf-156">因此，您必須為第一個參數指定 **AllowNone** 。</span><span class="sxs-lookup"><span data-stu-id="e79cf-156">You must therefore specify **AllowNone** for the first parameter.</span></span>

## <a name="acceptresponseblob"></a><span data-ttu-id="e79cf-157">acceptResponseBlob</span><span class="sxs-lookup"><span data-stu-id="e79cf-157">acceptResponseBlob</span></span>

<span data-ttu-id="e79cf-158">Xenroll.dll 中的 [**acceptResponseBlob**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-acceptresponseblob) 函數會安裝 \# 包含在位元組陣列中的 PKCS 7 或 CMC 憑證回應。</span><span class="sxs-lookup"><span data-stu-id="e79cf-158">The [**acceptResponseBlob**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-acceptresponseblob) function in Xenroll.dll installs a PKCS \#7 or CMC certificate response contained in a byte array.</span></span>

<span data-ttu-id="e79cf-159">您可以呼叫 [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) 來安裝 PKCS \# 7 或 CMC 回應。</span><span class="sxs-lookup"><span data-stu-id="e79cf-159">You can call [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) to install a PKCS \#7 or CMC response.</span></span> <span data-ttu-id="e79cf-160">如果您為 [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse)的第一個參數指定 [**InstallResponseRestrictionFlags**](/windows/desktop/api/CertEnroll/ne-certenroll-installresponserestrictionflags)列舉的 **AllowNoOutstandingRequest** 值，則虛擬憑證不需要存在，如此可讓您在未先呼叫 [**註冊**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll)或 [**CreateRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest)的情況下安裝回應。</span><span class="sxs-lookup"><span data-stu-id="e79cf-160">If you specify the **AllowNoOutstandingRequest** value of the [**InstallResponseRestrictionFlags**](/windows/desktop/api/CertEnroll/ne-certenroll-installresponserestrictionflags) enumeration for the first parameter of [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse), a dummy certificate need not exist, thereby enabling you to install the response without first calling [**Enroll**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) or [**CreateRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest).</span></span> <span data-ttu-id="e79cf-161">但是，如果您要使用 web 腳本來安裝憑證，要求存放區中必須有虛擬憑證存在。</span><span class="sxs-lookup"><span data-stu-id="e79cf-161">However, if you are installing a certificate by using a web script, a dummy certificate must exist in the request store.</span></span> <span data-ttu-id="e79cf-162">因此，您必須為第一個參數指定 **AllowNone** 。</span><span class="sxs-lookup"><span data-stu-id="e79cf-162">You must therefore specify **AllowNone** for the first parameter.</span></span>

## <a name="getcertcontextfromfileresponsewstr"></a><span data-ttu-id="e79cf-163">getCertCoNtextFromFileResponseWStr</span><span class="sxs-lookup"><span data-stu-id="e79cf-163">getCertContextFromFileResponseWStr</span></span>

<span data-ttu-id="e79cf-164">Xenroll.dll 中的 [**getCertCoNtextFromFileResponseWStr**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-getcertcontextfromfileresponsewstr) 函數會從檔案抓取用戶端憑證。</span><span class="sxs-lookup"><span data-stu-id="e79cf-164">The [**getCertContextFromFileResponseWStr**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-getcertcontextfromfileresponsewstr) function in Xenroll.dll retrieves the client certificate from a file.</span></span>

<span data-ttu-id="e79cf-165">CertEnroll.dll 程式庫不會直接執行從儲存在檔案中的 CA 回應取得憑證的功能。</span><span class="sxs-lookup"><span data-stu-id="e79cf-165">The CertEnroll.dll library does not directly implement functionality to retrieve a certificate from a CA response saved in a file.</span></span> <span data-ttu-id="e79cf-166">不過，您可以建立自訂函式，將檔案資料讀入位元組陣列中，並呼叫 [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) 來安裝 PKCS \# 7 或 CMC 回應，然後呼叫 [**憑證**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-get_certificate) 屬性來取得憑證。</span><span class="sxs-lookup"><span data-stu-id="e79cf-166">You can, however, create a custom function to read the file data into a byte array and call [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) to install the PKCS \#7 or CMC response, and call the [**Certificate**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-get_certificate) property to retrieve the certificate.</span></span>

<span data-ttu-id="e79cf-167">如果您為 [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse)的第一個參數指定 [**InstallResponseRestrictionFlags**](/windows/desktop/api/CertEnroll/ne-certenroll-installresponserestrictionflags)列舉的 **AllowNoOutstandingRequest** 值，則虛擬憑證不需要存在，如此可讓您在未先呼叫 [**註冊**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll)或 [**CreateRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest)的情況下，安裝憑證。</span><span class="sxs-lookup"><span data-stu-id="e79cf-167">If you specify the **AllowNoOutstandingRequest** value of the [**InstallResponseRestrictionFlags**](/windows/desktop/api/CertEnroll/ne-certenroll-installresponserestrictionflags) enumeration for the first parameter of [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse), a dummy certificate need not exist, thereby enabling you to install a certificate without first calling [**Enroll**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) or [**CreateRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest).</span></span> <span data-ttu-id="e79cf-168">但是，如果您要使用 web 腳本來安裝憑證，要求存放區中必須有虛擬憑證存在。</span><span class="sxs-lookup"><span data-stu-id="e79cf-168">However, if you are installing a certificate by using a web script, a dummy certificate must exist in the request store.</span></span> <span data-ttu-id="e79cf-169">因此，您必須為第一個參數指定 **AllowNone** 。</span><span class="sxs-lookup"><span data-stu-id="e79cf-169">You must therefore specify **AllowNone** for the first parameter.</span></span>

## <a name="getcertcontextfrompkcs7"></a><span data-ttu-id="e79cf-170">getCertCoNtextFromPKCS7</span><span class="sxs-lookup"><span data-stu-id="e79cf-170">getCertContextFromPKCS7</span></span>

<span data-ttu-id="e79cf-171">Xenroll.dll 中的 [**getCertCoNtextFromPKCS7**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-getcertcontextfrompkcs7) 函數會從 PKCS 7 回應中抓取用戶端憑證 \# 。</span><span class="sxs-lookup"><span data-stu-id="e79cf-171">The [**getCertContextFromPKCS7**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-getcertcontextfrompkcs7) function in Xenroll.dll retrieves the client certificate from a PKCS \#7 response.</span></span>

<span data-ttu-id="e79cf-172">呼叫 [**註冊**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll)或 [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse)方法之後，您可以呼叫 [**IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment)物件上的 [**certificate**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-get_certificate)屬性來取得憑證。</span><span class="sxs-lookup"><span data-stu-id="e79cf-172">You can call the [**Certificate**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-get_certificate) property on the [**IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment) object to retrieve a certificate after calling the [**Enroll**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) or [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) method.</span></span>

## <a name="getcertcontextfromresponseblob"></a><span data-ttu-id="e79cf-173">getCertCoNtextFromResponseBlob</span><span class="sxs-lookup"><span data-stu-id="e79cf-173">getCertContextFromResponseBlob</span></span>

<span data-ttu-id="e79cf-174">Xenroll.dll 中的 [**getCertCoNtextFromResponseBlob**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-getcertcontextfromresponseblob) 函式會從 PKCS \# 7 或 CMC 回應中抓取用戶端憑證。</span><span class="sxs-lookup"><span data-stu-id="e79cf-174">The [**getCertContextFromResponseBlob**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-getcertcontextfromresponseblob) function in Xenroll.dll retrieves a client certificate from a PKCS \#7 or CMC response.</span></span>

<span data-ttu-id="e79cf-175">呼叫 [**註冊**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll)或 [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse)方法之後，您可以呼叫 [**IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment)物件上的 [**certificate**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-get_certificate)屬性來取得憑證。</span><span class="sxs-lookup"><span data-stu-id="e79cf-175">You can call the [**Certificate**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-get_certificate) property on the [**IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment) object to retrieve a certificate after calling the [**Enroll**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) or [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) method.</span></span>

## <a name="installpkcs7blob"></a><span data-ttu-id="e79cf-176">InstallPKCS7Blob</span><span class="sxs-lookup"><span data-stu-id="e79cf-176">InstallPKCS7Blob</span></span>

<span data-ttu-id="e79cf-177">Xenroll.dll 中的 [**InstallPKCS7Blob**](/windows/desktop/api/xenroll/nf-xenroll-ienroll2-installpkcs7blob) 函數會安裝 PKCS \# 7 回應。</span><span class="sxs-lookup"><span data-stu-id="e79cf-177">The [**InstallPKCS7Blob**](/windows/desktop/api/xenroll/nf-xenroll-ienroll2-installpkcs7blob) function in Xenroll.dll installs a PKCS \#7 response.</span></span>

<span data-ttu-id="e79cf-178">您可以呼叫 [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) 來安裝 PKCS \# 7 或 CMC 回應。</span><span class="sxs-lookup"><span data-stu-id="e79cf-178">You can call [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) to install a PKCS \#7 or CMC response.</span></span> <span data-ttu-id="e79cf-179">如果您為 [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse)的第一個參數指定 [**InstallResponseRestrictionFlags**](/windows/desktop/api/CertEnroll/ne-certenroll-installresponserestrictionflags)列舉的 **AllowNoOutstandingRequest** 值，則虛擬憑證不需要存在，如此可讓您在未先呼叫 [**註冊**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll)或 [**CreateRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest)的情況下安裝回應。</span><span class="sxs-lookup"><span data-stu-id="e79cf-179">If you specify the **AllowNoOutstandingRequest** value of the [**InstallResponseRestrictionFlags**](/windows/desktop/api/CertEnroll/ne-certenroll-installresponserestrictionflags) enumeration for the first parameter of [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse), a dummy certificate need not exist, thereby enabling you to install the response without first calling [**Enroll**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) or [**CreateRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest).</span></span> <span data-ttu-id="e79cf-180">但是，如果您要使用 web 腳本來安裝憑證，要求存放區中必須有虛擬憑證存在。</span><span class="sxs-lookup"><span data-stu-id="e79cf-180">However, if you are installing a certificate by using a web script, a dummy certificate must exist in the request store.</span></span> <span data-ttu-id="e79cf-181">因此，您必須為第一個參數指定 **AllowNone** 。</span><span class="sxs-lookup"><span data-stu-id="e79cf-181">You must therefore specify **AllowNone** for the first parameter.</span></span>

## <a name="installpkcs7blobex"></a><span data-ttu-id="e79cf-182">InstallPKCS7BlobEx</span><span class="sxs-lookup"><span data-stu-id="e79cf-182">InstallPKCS7BlobEx</span></span>

<span data-ttu-id="e79cf-183">Xenroll.dll 中的 [**InstallPKCS7BlobEx**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-installpkcs7blobex) 函數會安裝 PKCS \# 7 回應，並傳回已安裝的憑證數目。</span><span class="sxs-lookup"><span data-stu-id="e79cf-183">The [**InstallPKCS7BlobEx**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-installpkcs7blobex) function in Xenroll.dll installs a PKCS \#7 response and returns the number of certificates installed.</span></span>

<span data-ttu-id="e79cf-184">您可以呼叫 [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) 來安裝 PKCS \# 7 或 CMC 回應。</span><span class="sxs-lookup"><span data-stu-id="e79cf-184">You can call [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) to install a PKCS \#7 or CMC response.</span></span> <span data-ttu-id="e79cf-185">如果您為 [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse)的第一個參數指定 [**InstallResponseRestrictionFlags**](/windows/desktop/api/CertEnroll/ne-certenroll-installresponserestrictionflags)列舉的 **AllowNoOutstandingRequest** 值，則虛擬憑證不需要存在，如此可讓您在未先呼叫 [**註冊**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll)或 [**CreateRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest)的情況下安裝回應。</span><span class="sxs-lookup"><span data-stu-id="e79cf-185">If you specify the **AllowNoOutstandingRequest** value of the [**InstallResponseRestrictionFlags**](/windows/desktop/api/CertEnroll/ne-certenroll-installresponserestrictionflags) enumeration for the first parameter of [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse), a dummy certificate need not exist, thereby enabling you to install the response without first calling [**Enroll**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) or [**CreateRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest).</span></span> <span data-ttu-id="e79cf-186">但是，如果您要使用 web 腳本來安裝憑證，要求存放區中必須有虛擬憑證存在。</span><span class="sxs-lookup"><span data-stu-id="e79cf-186">However, if you are installing a certificate by using a web script, a dummy certificate must exist in the request store.</span></span> <span data-ttu-id="e79cf-187">因此，您必須為第一個參數指定 **AllowNone** 。</span><span class="sxs-lookup"><span data-stu-id="e79cf-187">You must therefore specify **AllowNone** for the first parameter.</span></span>

## <a name="spcfilenamewstr"></a><span data-ttu-id="e79cf-188">SPCFileNameWStr</span><span class="sxs-lookup"><span data-stu-id="e79cf-188">SPCFileNameWStr</span></span>

<span data-ttu-id="e79cf-189">Xenroll.dll 中的 [**SPCFileNameWStr**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-get_spcfilenamewstr) 函數會指定或抓取要儲存憑證回應的檔案名。</span><span class="sxs-lookup"><span data-stu-id="e79cf-189">The [**SPCFileNameWStr**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-get_spcfilenamewstr) function in Xenroll.dll specifies or retrieves the name of the file in which to save the certificate response.</span></span> <span data-ttu-id="e79cf-190">CertEnroll.dll 程式庫不會執行可讓您將憑證複製到特定檔案的功能。</span><span class="sxs-lookup"><span data-stu-id="e79cf-190">The CertEnroll.dll library does not implement functionality that enables you to copy a certificate to a specific file.</span></span> <span data-ttu-id="e79cf-191">註冊程式會自動將憑證鏈安裝到適當存放區中的檔案。</span><span class="sxs-lookup"><span data-stu-id="e79cf-191">The enrollment process automatically installs the certificate chain into files in the appropriate stores.</span></span>

## <a name="writecerttocsp"></a><span data-ttu-id="e79cf-192">WriteCertToCSP</span><span class="sxs-lookup"><span data-stu-id="e79cf-192">WriteCertToCSP</span></span>

<span data-ttu-id="e79cf-193">Xenroll.dll 中的 [**WriteCertToCSP**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-get_writecerttocsp) 函式會指定或抓取布林值，指出是否應將憑證寫入 (CSP) 的 [*密碼編譯服務提供者*](/windows/desktop/SecGloss/c-gly) 。</span><span class="sxs-lookup"><span data-stu-id="e79cf-193">The [**WriteCertToCSP**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-get_writecerttocsp) function in Xenroll.dll specifies or retrieves a Boolean value that indicates whether a certificate should be written to a [*cryptographic service provider*](/windows/desktop/SecGloss/c-gly) (CSP).</span></span> <span data-ttu-id="e79cf-194">一般而言，如果呼叫此函式，則提供者是 [*智慧卡*](/windows/desktop/SecGloss/s-gly)。</span><span class="sxs-lookup"><span data-stu-id="e79cf-194">Typically, if this function is called, the provider is a [*smart card*](/windows/desktop/SecGloss/s-gly).</span></span>

<span data-ttu-id="e79cf-195">在 CertEnroll.dll 中，當用戶端呼叫 [**註冊**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) 方法來提交智慧卡憑證的要求併發出憑證時， [**註冊**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) 會自動將憑證安裝在智慧卡上，並假設該卡片是安裝在讀取器中。</span><span class="sxs-lookup"><span data-stu-id="e79cf-195">In CertEnroll.dll, when a client calls the [**Enroll**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) method to submit a request for a smart card certificate and a certificate is issued, [**Enroll**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) automatically installs the certificate on the smart card, assuming that the card is installed in the reader.</span></span> <span data-ttu-id="e79cf-196">[**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse)方法也會自動將憑證寫入智慧卡。</span><span class="sxs-lookup"><span data-stu-id="e79cf-196">The [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) method also automatically writes the certificate to the smart card.</span></span>

## <a name="writecerttouserds"></a><span data-ttu-id="e79cf-197">WriteCertToUserDS</span><span class="sxs-lookup"><span data-stu-id="e79cf-197">WriteCertToUserDS</span></span>

<span data-ttu-id="e79cf-198">Xenroll.dll 中的 [**WriteCertToUserDS**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-get_writecerttouserds) 函數會指定或抓取布林值，指出是否應將憑證儲存在 Active Directory 存放區中。</span><span class="sxs-lookup"><span data-stu-id="e79cf-198">The [**WriteCertToUserDS**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-get_writecerttouserds) function in Xenroll.dll specifies or retrieves a Boolean value that indicates whether a certificate should be saved in the Active Directory store.</span></span> <span data-ttu-id="e79cf-199">CertEnroll.dll 程式庫不會執行功能，可讓您指定要將憑證複製到其中的存放區。</span><span class="sxs-lookup"><span data-stu-id="e79cf-199">The CertEnroll.dll library does not implement functionality that enables you to specify a store to copy a certificate to.</span></span>

## <a name="related-topics"></a><span data-ttu-id="e79cf-200">相關主題</span><span class="sxs-lookup"><span data-stu-id="e79cf-200">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="e79cf-201">將 Xenroll.dll 對應至 CertEnroll.dll</span><span class="sxs-lookup"><span data-stu-id="e79cf-201">Mapping Xenroll.dll to CertEnroll.dll</span></span>](mapping-xenroll-dll-to-certenroll-dll.md)
</dt> <dt>

[<span data-ttu-id="e79cf-202">**IX509Enrollment**</span><span class="sxs-lookup"><span data-stu-id="e79cf-202">**IX509Enrollment**</span></span>](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment)
</dt> </dl>

 

 
