---
description: Xenroll.dll 所匯出的函式，可用於管理密碼編譯提供者。
ms.assetid: 4f6f353d-6b06-45b4-8808-56998d3727a4
title: 密碼編譯服務提供者函數
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 6a981b418271ba834352c0301c005b39742729a5
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/07/2021
ms.locfileid: "103689688"
---
# <a name="cryptographic-service-provider-functions"></a><span data-ttu-id="2240b-103">密碼編譯服務提供者函數</span><span class="sxs-lookup"><span data-stu-id="2240b-103">Cryptographic Service Provider Functions</span></span>

<span data-ttu-id="2240b-104">下列各節會識別 Xenroll.dll 所匯出的函式，該函式可用於管理密碼編譯提供者。</span><span class="sxs-lookup"><span data-stu-id="2240b-104">Each of the following sections identifies a function exported by Xenroll.dll that can be used to manage a cryptographic provider.</span></span> <span data-ttu-id="2240b-105">每個主題也會討論如何使用 CertEnroll.dll 來取代函式，或指出兩個程式庫之間沒有對應存在：</span><span class="sxs-lookup"><span data-stu-id="2240b-105">Each topic also discusses how to use CertEnroll.dll to replace the function or indicates that no mapping between the two libraries exists:</span></span>

-   [<span data-ttu-id="2240b-106">EnumAlgs</span><span class="sxs-lookup"><span data-stu-id="2240b-106">EnumAlgs</span></span>](#enumalgs)
-   [<span data-ttu-id="2240b-107">enumContainersWStr</span><span class="sxs-lookup"><span data-stu-id="2240b-107">enumContainersWStr</span></span>](#enumcontainerswstr)
-   [<span data-ttu-id="2240b-108">enumProvidersWStr</span><span class="sxs-lookup"><span data-stu-id="2240b-108">enumProvidersWStr</span></span>](#enumproviderswstr)
-   [<span data-ttu-id="2240b-109">GetAlgNameWStr</span><span class="sxs-lookup"><span data-stu-id="2240b-109">GetAlgNameWStr</span></span>](#getalgnamewstr)
-   [<span data-ttu-id="2240b-110">getProviderTypeWStr</span><span class="sxs-lookup"><span data-stu-id="2240b-110">getProviderTypeWStr</span></span>](#getprovidertypewstr)
-   [<span data-ttu-id="2240b-111">HashAlgID</span><span class="sxs-lookup"><span data-stu-id="2240b-111">HashAlgID</span></span>](#hashalgid)
-   [<span data-ttu-id="2240b-112">HashAlgorithmWStr</span><span class="sxs-lookup"><span data-stu-id="2240b-112">HashAlgorithmWStr</span></span>](#hashalgorithmwstr)
-   [<span data-ttu-id="2240b-113">ProviderFlags</span><span class="sxs-lookup"><span data-stu-id="2240b-113">ProviderFlags</span></span>](#providerflags)
-   [<span data-ttu-id="2240b-114">ProviderNameWStr</span><span class="sxs-lookup"><span data-stu-id="2240b-114">ProviderNameWStr</span></span>](#providernamewstr)
-   [<span data-ttu-id="2240b-115">ProviderType</span><span class="sxs-lookup"><span data-stu-id="2240b-115">ProviderType</span></span>](#getprovidertypewstr)
-   [<span data-ttu-id="2240b-116">相關主題</span><span class="sxs-lookup"><span data-stu-id="2240b-116">Related topics</span></span>](#related-topics)

## <a name="enumalgs"></a><span data-ttu-id="2240b-117">EnumAlgs</span><span class="sxs-lookup"><span data-stu-id="2240b-117">EnumAlgs</span></span>

<span data-ttu-id="2240b-118">Xenroll.dll 中的 [**EnumAlgs**](/windows/desktop/api/xenroll/nf-xenroll-ienroll2-enumalgs) 函數會抓取密碼編譯演算法集合。</span><span class="sxs-lookup"><span data-stu-id="2240b-118">The [**EnumAlgs**](/windows/desktop/api/xenroll/nf-xenroll-ienroll2-enumalgs) function in Xenroll.dll retrieves a cryptographic algorithm collection.</span></span>

<span data-ttu-id="2240b-119">使用 CertEnroll.dll 時，您可以執行下列動作，以抓取 [*密碼編譯服務提供者*](/windows/desktop/SecGloss/c-gly) 所支援之演算法的相關資訊 (CSP) ：</span><span class="sxs-lookup"><span data-stu-id="2240b-119">When using CertEnroll.dll, you can perform the following actions to retrieve information about the algorithms supported by a [*cryptographic service provider*](/windows/desktop/SecGloss/c-gly) (CSP):</span></span>

1.  <span data-ttu-id="2240b-120">呼叫現有 [**IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment)物件上的 [**Request**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-get_request)屬性。</span><span class="sxs-lookup"><span data-stu-id="2240b-120">Call the [**Request**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-get_request) property on an existing [**IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment) object.</span></span>
2.  <span data-ttu-id="2240b-121">在步驟1傳回的要求上呼叫 [**GetInnerRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequest-getinnerrequest) 方法，以取得最內層的要求。</span><span class="sxs-lookup"><span data-stu-id="2240b-121">Call the [**GetInnerRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequest-getinnerrequest) method on the request returned from step 1 to retrieve the innermost request.</span></span>
3.  <span data-ttu-id="2240b-122">在步驟2所傳回的 [**IX509CertificateRequest**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequest)物件上呼叫 **QueryInterface** ，以轉換為 [**IX509CertificateRequestPkcs10**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequestpkcs10)物件。</span><span class="sxs-lookup"><span data-stu-id="2240b-122">Call **QueryInterface** on the [**IX509CertificateRequest**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequest) object returned from step 2 to cast to an [**IX509CertificateRequestPkcs10**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequestpkcs10) object.</span></span>
4.  <span data-ttu-id="2240b-123">呼叫 PKCS 10 要求上的 [**PrivateKey**](/windows/desktop/SecCrypto/privatekey) 屬性 \# 。</span><span class="sxs-lookup"><span data-stu-id="2240b-123">Call the [**PrivateKey**](/windows/desktop/SecCrypto/privatekey) property on the PKCS \#10 request.</span></span>
5.  <span data-ttu-id="2240b-124">呼叫從步驟4取出的 [**IX509PrivateKey**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509privatekey)物件上的 [**CspInformations**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509privatekey-get_cspinformations)屬性。</span><span class="sxs-lookup"><span data-stu-id="2240b-124">Call the [**CspInformations**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509privatekey-get_cspinformations) property on the [**IX509PrivateKey**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509privatekey) object retrieved from step 4.</span></span>
6.  <span data-ttu-id="2240b-125">在步驟5中抓取的 [**ICspInformations**](/windows/desktop/api/CertEnroll/nn-certenroll-icspinformations)集合中，呼叫特定 [**ICspInformation**](/windows/desktop/api/CertEnroll/nn-certenroll-icspinformation)物件上的 [**CspAlgorithms**](/windows/desktop/api/CertEnroll/nf-certenroll-icspinformation-get_cspalgorithms)屬性。</span><span class="sxs-lookup"><span data-stu-id="2240b-125">Call the [**CspAlgorithms**](/windows/desktop/api/CertEnroll/nf-certenroll-icspinformation-get_cspalgorithms) property on a specific [**ICspInformation**](/windows/desktop/api/CertEnroll/nn-certenroll-icspinformation) object in the [**ICspInformations**](/windows/desktop/api/CertEnroll/nn-certenroll-icspinformations) collection retrieved in step 5.</span></span>

## <a name="enumcontainerswstr"></a><span data-ttu-id="2240b-126">enumContainersWStr</span><span class="sxs-lookup"><span data-stu-id="2240b-126">enumContainersWStr</span></span>

<span data-ttu-id="2240b-127">Xenroll.dll 中的 [**enumContainersWStr**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-enumcontainerswstr) 函式會依據索引，從集合中抓取金鑰容器。</span><span class="sxs-lookup"><span data-stu-id="2240b-127">The [**enumContainersWStr**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-enumcontainerswstr) function in Xenroll.dll retrieves a key container from the collection by index.</span></span>

<span data-ttu-id="2240b-128">CertEnroll.dll 程式庫不會直接執行此功能。</span><span class="sxs-lookup"><span data-stu-id="2240b-128">The CertEnroll.dll library does not directly implement this functionality.</span></span>

## <a name="enumproviderswstr"></a><span data-ttu-id="2240b-129">enumProvidersWStr</span><span class="sxs-lookup"><span data-stu-id="2240b-129">enumProvidersWStr</span></span>

<span data-ttu-id="2240b-130">Xenroll.dll 中的 [**enumProvidersWStr**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-enumproviderswstr) 函式會依據索引，從集合中取出 CSP。</span><span class="sxs-lookup"><span data-stu-id="2240b-130">The [**enumProvidersWStr**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-enumproviderswstr) function in Xenroll.dll retrieves a CSP from the collection by index.</span></span>

<span data-ttu-id="2240b-131">使用 CertEnroll.dll 時，您可以執行下列動作來取出密碼編譯容器的集合：</span><span class="sxs-lookup"><span data-stu-id="2240b-131">When using CertEnroll.dll, you can perform the following actions to retrieve the collection of cryptographic containers:</span></span>

1.  <span data-ttu-id="2240b-132">呼叫現有 [**IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment)物件上的 [**Request**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-get_request)屬性。</span><span class="sxs-lookup"><span data-stu-id="2240b-132">Call the [**Request**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-get_request) property on an existing [**IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment) object.</span></span>
2.  <span data-ttu-id="2240b-133">在步驟1傳回的要求上呼叫 [**GetInnerRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequest-getinnerrequest) 方法，以取得最內層的要求。</span><span class="sxs-lookup"><span data-stu-id="2240b-133">Call the [**GetInnerRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequest-getinnerrequest) method on the request returned from step 1 to retrieve the innermost request.</span></span>
3.  <span data-ttu-id="2240b-134">在步驟2所傳回的 [**IX509CertificateRequest**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequest)物件上呼叫 **QueryInterface** ，以轉換為 [**IX509CertificateRequestPkcs10**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequestpkcs10)物件。</span><span class="sxs-lookup"><span data-stu-id="2240b-134">Call **QueryInterface** on the [**IX509CertificateRequest**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequest) object returned from step 2 to cast to an [**IX509CertificateRequestPkcs10**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequestpkcs10) object.</span></span>
4.  <span data-ttu-id="2240b-135">呼叫 PKCS 10 要求上的 [**PrivateKey**](/windows/desktop/SecCrypto/privatekey) 屬性 \# 。</span><span class="sxs-lookup"><span data-stu-id="2240b-135">Call the [**PrivateKey**](/windows/desktop/SecCrypto/privatekey) property on the PKCS \#10 request.</span></span>
5.  <span data-ttu-id="2240b-136">呼叫從步驟4取出的 [**IX509PrivateKey**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509privatekey)物件上的 [**CspInformations**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509privatekey-get_cspinformations)屬性。</span><span class="sxs-lookup"><span data-stu-id="2240b-136">Call the [**CspInformations**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509privatekey-get_cspinformations) property on the [**IX509PrivateKey**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509privatekey) object retrieved from step 4.</span></span>

## <a name="getalgnamewstr"></a><span data-ttu-id="2240b-137">GetAlgNameWStr</span><span class="sxs-lookup"><span data-stu-id="2240b-137">GetAlgNameWStr</span></span>

<span data-ttu-id="2240b-138">Xenroll.dll 中的 [**GetAlgNameWStr**](/windows/desktop/api/xenroll/nf-xenroll-ienroll2-getalgnamewstr) 函數會抓取 [*密碼編譯演算法*](/windows/desktop/SecGloss/c-gly)的名稱。</span><span class="sxs-lookup"><span data-stu-id="2240b-138">The [**GetAlgNameWStr**](/windows/desktop/api/xenroll/nf-xenroll-ienroll2-getalgnamewstr) function in Xenroll.dll retrieves the name of a [*cryptographic algorithm*](/windows/desktop/SecGloss/c-gly).</span></span>

<span data-ttu-id="2240b-139">使用 CertEnroll.dll 時，您可以執行下列動作來取出演算法名稱：</span><span class="sxs-lookup"><span data-stu-id="2240b-139">When using CertEnroll.dll, you can perform the following actions to retrieve the algorithm name:</span></span>

1.  <span data-ttu-id="2240b-140">呼叫現有 [**IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment)物件上的 [**Request**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-get_request)屬性。</span><span class="sxs-lookup"><span data-stu-id="2240b-140">Call the [**Request**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-get_request) property on an existing [**IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment) object.</span></span>
2.  <span data-ttu-id="2240b-141">在步驟1傳回的要求上呼叫 [**GetInnerRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequest-getinnerrequest) 方法，以取得最內層的要求。</span><span class="sxs-lookup"><span data-stu-id="2240b-141">Call the [**GetInnerRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequest-getinnerrequest) method on the request returned from step 1 to retrieve the innermost request.</span></span>
3.  <span data-ttu-id="2240b-142">在步驟2所傳回的 [**IX509CertificateRequest**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequest)物件上呼叫 **QueryInterface** ，以轉換為 [**IX509CertificateRequestPkcs10**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequestpkcs10)物件。</span><span class="sxs-lookup"><span data-stu-id="2240b-142">Call **QueryInterface** on the [**IX509CertificateRequest**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequest) object returned from step 2 to cast to an [**IX509CertificateRequestPkcs10**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequestpkcs10) object.</span></span>
4.  <span data-ttu-id="2240b-143">呼叫 PKCS 10 要求上的 [**PrivateKey**](/windows/desktop/SecCrypto/privatekey) 屬性 \# 。</span><span class="sxs-lookup"><span data-stu-id="2240b-143">Call the [**PrivateKey**](/windows/desktop/SecCrypto/privatekey) property on the PKCS \#10 request.</span></span>
5.  <span data-ttu-id="2240b-144">呼叫 [**IX509PrivateKey**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509privatekey)物件上的 [**演算法**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509privatekey-get_algorithm)屬性，以取出演算法物件識別碼。</span><span class="sxs-lookup"><span data-stu-id="2240b-144">Call the [**Algorithm**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509privatekey-get_algorithm) property on the [**IX509PrivateKey**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509privatekey) object to retrieve the algorithm object identifier.</span></span>
6.  <span data-ttu-id="2240b-145">呼叫 [**IObjectId**](/windows/desktop/api/CertEnroll/nn-certenroll-iobjectid)介面上的 [ [**FriendlyName**](/windows/desktop/api/CertEnroll/nf-certenroll-iobjectid-get_friendlyname) ] 屬性，以取得演算法顯示名稱。</span><span class="sxs-lookup"><span data-stu-id="2240b-145">Call the [**FriendlyName**](/windows/desktop/api/CertEnroll/nf-certenroll-iobjectid-get_friendlyname) property on the [**IObjectId**](/windows/desktop/api/CertEnroll/nn-certenroll-iobjectid) interface to retrieve the algorithm display name.</span></span>

## <a name="getprovidertypewstr"></a><span data-ttu-id="2240b-146">getProviderTypeWStr</span><span class="sxs-lookup"><span data-stu-id="2240b-146">getProviderTypeWStr</span></span>

<span data-ttu-id="2240b-147">Xenroll.dll 中的 [**getProviderTypeWStr**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-getprovidertypewstr) 函數會抓取密碼編譯提供者類型。</span><span class="sxs-lookup"><span data-stu-id="2240b-147">The [**getProviderTypeWStr**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-getprovidertypewstr) function in Xenroll.dll retrieves the cryptographic provider type.</span></span>

<span data-ttu-id="2240b-148">使用 CertEnroll.dll 時，您可以執行下列動作來取出提供者類型：</span><span class="sxs-lookup"><span data-stu-id="2240b-148">When using CertEnroll.dll, you can perform the following actions to retrieve the provider type:</span></span>

1.  <span data-ttu-id="2240b-149">呼叫現有 [**IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment)物件上的 [**Request**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-get_request)屬性。</span><span class="sxs-lookup"><span data-stu-id="2240b-149">Call the [**Request**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-get_request) property on an existing [**IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment) object.</span></span>
2.  <span data-ttu-id="2240b-150">在步驟1傳回的要求上呼叫 [**GetInnerRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequest-getinnerrequest) 方法，以取得最內層的要求。</span><span class="sxs-lookup"><span data-stu-id="2240b-150">Call the [**GetInnerRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequest-getinnerrequest) method on the request returned from step 1 to retrieve the innermost request.</span></span>
3.  <span data-ttu-id="2240b-151">在步驟2所傳回的 [**IX509CertificateRequest**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequest)物件上呼叫 **QueryInterface** ，以轉換為 [**IX509CertificateRequestPkcs10**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequestpkcs10)物件。</span><span class="sxs-lookup"><span data-stu-id="2240b-151">Call **QueryInterface** on the [**IX509CertificateRequest**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequest) object returned from step 2 to cast to an [**IX509CertificateRequestPkcs10**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequestpkcs10) object.</span></span>
4.  <span data-ttu-id="2240b-152">呼叫 PKCS 10 要求上的 [**PrivateKey**](/windows/desktop/SecCrypto/privatekey) 屬性 \# 。</span><span class="sxs-lookup"><span data-stu-id="2240b-152">Call the [**PrivateKey**](/windows/desktop/SecCrypto/privatekey) property on the PKCS \#10 request.</span></span>
5.  <span data-ttu-id="2240b-153">呼叫從步驟4取出的 [**IX509PrivateKey**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509privatekey)物件上的 [**ProviderType**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509privatekey-get_providertype)屬性。</span><span class="sxs-lookup"><span data-stu-id="2240b-153">Call the [**ProviderType**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509privatekey-get_providertype) property on the [**IX509PrivateKey**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509privatekey) object retrieved from step 4.</span></span>

## <a name="hashalgid"></a><span data-ttu-id="2240b-154">HashAlgID</span><span class="sxs-lookup"><span data-stu-id="2240b-154">HashAlgID</span></span>

<span data-ttu-id="2240b-155">Xenroll.dll 中的 [**HashAlgID**](/windows/desktop/api/xenroll/nf-xenroll-ienroll2-get_hashalgid) 函式會抓取整數值，其中包含用來簽署要求的演算法識別碼。</span><span class="sxs-lookup"><span data-stu-id="2240b-155">The [**HashAlgID**](/windows/desktop/api/xenroll/nf-xenroll-ienroll2-get_hashalgid) function in Xenroll.dll retrieves an integer value that contains the ID of the algorithm used to sign a request.</span></span>

<span data-ttu-id="2240b-156">使用 CertEnroll.dll 時，您可以執行下列動作來取得雜湊演算法：</span><span class="sxs-lookup"><span data-stu-id="2240b-156">When using CertEnroll.dll, you can perform the following actions to retrieve the hashing algorithm:</span></span>

-   <span data-ttu-id="2240b-157">藉由呼叫 pkcs 10 或 CMC 要求上的 [**SignatureInformation**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequestpkcs10-get_signatureinformation)屬性， [](/windows/desktop/api/CertEnroll/nn-certenroll-ix509signatureinformation) \# 或 [*pkcs \# 7*](/windows/desktop/SecGloss/p-gly)要求上的 [**SignerCertificate**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequestpkcs7-get_signercertificate)屬性，來取出 IX509SignatureInformation 介面。</span><span class="sxs-lookup"><span data-stu-id="2240b-157">Retrieve an [**IX509SignatureInformation**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509signatureinformation) interface by calling the [**SignatureInformation**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequestpkcs10-get_signatureinformation) property on a PKCS \#10 or CMC request or the [**SignerCertificate**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequestpkcs7-get_signercertificate) property on a [*PKCS \#7*](/windows/desktop/SecGloss/p-gly) request.</span></span>
-   <span data-ttu-id="2240b-158">呼叫簽章資訊物件上的 [**HashAlgorithm**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509signatureinformation-get_hashalgorithm) 屬性，以取出雜湊演算法物件識別碼。</span><span class="sxs-lookup"><span data-stu-id="2240b-158">Call the [**HashAlgorithm**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509signatureinformation-get_hashalgorithm) property on the signature information object to retrieve the hash algorithm object identifier.</span></span>

## <a name="hashalgorithmwstr"></a><span data-ttu-id="2240b-159">HashAlgorithmWStr</span><span class="sxs-lookup"><span data-stu-id="2240b-159">HashAlgorithmWStr</span></span>

<span data-ttu-id="2240b-160">Xenroll.dll 中的 [**HashAlgorithmWStr**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-get_hashalgorithmwstr) 函數會指定或抓取字串值，以識別用來簽署要求的雜湊演算法。</span><span class="sxs-lookup"><span data-stu-id="2240b-160">The [**HashAlgorithmWStr**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-get_hashalgorithmwstr) function in Xenroll.dll specifies or retrieves a string value that identifies the hashing algorithm used to sign a request.</span></span>

<span data-ttu-id="2240b-161">使用 CertEnroll.dll 時，您可以執行下列動作來取得雜湊演算法：</span><span class="sxs-lookup"><span data-stu-id="2240b-161">When using CertEnroll.dll, you can perform the following actions to retrieve the hashing algorithm:</span></span>

-   <span data-ttu-id="2240b-162">藉由呼叫 pkcs 10 或 CMC 要求上的 [**SignatureInformation**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequestpkcs10-get_signatureinformation)屬性， [](/windows/desktop/api/CertEnroll/nn-certenroll-ix509signatureinformation) \# 或 Pkcs 7 要求上的 [**SignerCertificate**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequestpkcs7-get_signercertificate)屬性，來取出 IX509SignatureInformation 介面 \# 。</span><span class="sxs-lookup"><span data-stu-id="2240b-162">Retrieve an [**IX509SignatureInformation**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509signatureinformation) interface by calling the [**SignatureInformation**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequestpkcs10-get_signatureinformation) property on a PKCS \#10 or CMC request or the [**SignerCertificate**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequestpkcs7-get_signercertificate) property on a PKCS \#7 request.</span></span>
-   <span data-ttu-id="2240b-163">呼叫簽章資訊物件上的 [**HashAlgorithm**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509signatureinformation-get_hashalgorithm) 屬性，以取出雜湊演算法物件識別碼。</span><span class="sxs-lookup"><span data-stu-id="2240b-163">Call the [**HashAlgorithm**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509signatureinformation-get_hashalgorithm) property on the signature information object to retrieve the hash algorithm object identifier.</span></span>
-   <span data-ttu-id="2240b-164">在步驟2中傳回的 [**IObjectId**](/windows/desktop/api/CertEnroll/nn-certenroll-iobjectid)介面上呼叫 [**FriendlyName**](/windows/desktop/api/CertEnroll/nf-certenroll-iobjectid-get_friendlyname)屬性，以抓取演算法顯示名稱。</span><span class="sxs-lookup"><span data-stu-id="2240b-164">Call the [**FriendlyName**](/windows/desktop/api/CertEnroll/nf-certenroll-iobjectid-get_friendlyname) property on the [**IObjectId**](/windows/desktop/api/CertEnroll/nn-certenroll-iobjectid) interface returned in step 2 to retrieve the algorithm display name.</span></span>

## <a name="providerflags"></a><span data-ttu-id="2240b-165">ProviderFlags</span><span class="sxs-lookup"><span data-stu-id="2240b-165">ProviderFlags</span></span>

<span data-ttu-id="2240b-166">Xenroll.dll 中的 [**ProviderFlags**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-get_providerflags) 函數會指定或抓取取得 CSP 控制碼時使用的旗標。</span><span class="sxs-lookup"><span data-stu-id="2240b-166">The [**ProviderFlags**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-get_providerflags) function in Xenroll.dll specifies or retrieves the flags used when acquiring a handle to a CSP.</span></span>

<span data-ttu-id="2240b-167">CertEnroll.dll 程式庫不會完全對應此函式，但是您可以從註冊物件和 [*私密金鑰*](/windows/desktop/SecGloss/p-gly)取得豐富的屬性資訊。</span><span class="sxs-lookup"><span data-stu-id="2240b-167">The CertEnroll.dll library does not map this function perfectly, but you can obtain rich property information from the enrollment object and the [*private key*](/windows/desktop/SecGloss/p-gly).</span></span> <span data-ttu-id="2240b-168">如需詳細資訊，請檢查 [**IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment) 和 [**IX509PrivateKey**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509privatekey) 介面所公開的屬性。</span><span class="sxs-lookup"><span data-stu-id="2240b-168">For more information, examine the properties exposed by the [**IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment) and [**IX509PrivateKey**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509privatekey) interfaces.</span></span>

## <a name="providernamewstr"></a><span data-ttu-id="2240b-169">ProviderNameWStr</span><span class="sxs-lookup"><span data-stu-id="2240b-169">ProviderNameWStr</span></span>

<span data-ttu-id="2240b-170">Xenroll.dll 中的 [**ProviderNameWStr**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-get_providernamewstr) 函數會指定或抓取 CSP 的名稱。</span><span class="sxs-lookup"><span data-stu-id="2240b-170">The [**ProviderNameWStr**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-get_providernamewstr) function in Xenroll.dll specifies or retrieves the name of a CSP.</span></span>

<span data-ttu-id="2240b-171">使用 CertEnroll.dll 時，您可以執行下列動作來取出提供者名稱：</span><span class="sxs-lookup"><span data-stu-id="2240b-171">When using CertEnroll.dll, you can perform the following actions to retrieve the provider name:</span></span>

1.  <span data-ttu-id="2240b-172">呼叫現有 [**IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment)物件上的 [**Request**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-get_request)屬性。</span><span class="sxs-lookup"><span data-stu-id="2240b-172">Call the [**Request**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-get_request) property on an existing [**IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment) object.</span></span>
2.  <span data-ttu-id="2240b-173">在步驟1傳回的要求上呼叫 [**GetInnerRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequest-getinnerrequest) 方法，以取得最內層的要求。</span><span class="sxs-lookup"><span data-stu-id="2240b-173">Call the [**GetInnerRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequest-getinnerrequest) method on the request returned from step 1 to retrieve the innermost request.</span></span>
3.  <span data-ttu-id="2240b-174">在步驟2所傳回的 [**IX509CertificateRequest**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequest)物件上呼叫 **QueryInterface** ，以轉換為 [**IX509CertificateRequestPkcs10**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequestpkcs10)物件。</span><span class="sxs-lookup"><span data-stu-id="2240b-174">Call **QueryInterface** on the [**IX509CertificateRequest**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequest) object returned from step 2 to cast to an [**IX509CertificateRequestPkcs10**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequestpkcs10) object.</span></span>
4.  <span data-ttu-id="2240b-175">呼叫 PKCS 10 要求上的 [**PrivateKey**](/windows/desktop/SecCrypto/privatekey) 屬性 \# 。</span><span class="sxs-lookup"><span data-stu-id="2240b-175">Call the [**PrivateKey**](/windows/desktop/SecCrypto/privatekey) property on the PKCS \#10 request.</span></span>
5.  <span data-ttu-id="2240b-176">在從步驟4取出的 [**IX509PrivateKey**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509privatekey)物件上，呼叫 [**ProviderName**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509privatekey-get_providername)屬性。</span><span class="sxs-lookup"><span data-stu-id="2240b-176">Call the [**ProviderName**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509privatekey-get_providername) property on the [**IX509PrivateKey**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509privatekey) object retrieved from step 4.</span></span>

## <a name="providertype"></a><span data-ttu-id="2240b-177">ProviderType</span><span class="sxs-lookup"><span data-stu-id="2240b-177">ProviderType</span></span>

<span data-ttu-id="2240b-178">Xenroll.dll 中的 [**ProviderType**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-get_providertype) 函式會指定或抓取識別 CSP 型別的整數值。</span><span class="sxs-lookup"><span data-stu-id="2240b-178">The [**ProviderType**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-get_providertype) function in Xenroll.dll specifies or retrieves an integer value that identifies the type of the CSP.</span></span>

<span data-ttu-id="2240b-179">使用 CertEnroll.dll 時，您可以執行下列動作來取出提供者類型：</span><span class="sxs-lookup"><span data-stu-id="2240b-179">When using CertEnroll.dll, you can perform the following actions to retrieve the provider type:</span></span>

1.  <span data-ttu-id="2240b-180">呼叫現有 [**IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment)物件上的 [**Request**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-get_request)屬性。</span><span class="sxs-lookup"><span data-stu-id="2240b-180">Call the [**Request**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-get_request) property on an existing [**IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment) object.</span></span>
2.  <span data-ttu-id="2240b-181">在步驟1傳回的要求上呼叫 [**GetInnerRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequest-getinnerrequest) 方法，以取得最內層的要求。</span><span class="sxs-lookup"><span data-stu-id="2240b-181">Call the [**GetInnerRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequest-getinnerrequest) method on the request returned from step 1 to retrieve the innermost request.</span></span>
3.  <span data-ttu-id="2240b-182">在步驟2所傳回的 [**IX509CertificateRequest**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequest)物件上呼叫 **QueryInterface** ，以轉換為 [**IX509CertificateRequestPkcs10**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequestpkcs10)物件。</span><span class="sxs-lookup"><span data-stu-id="2240b-182">Call **QueryInterface** on the [**IX509CertificateRequest**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequest) object returned from step 2 to cast to an [**IX509CertificateRequestPkcs10**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequestpkcs10) object.</span></span>
4.  <span data-ttu-id="2240b-183">呼叫 PKCS 10 要求上的 [**PrivateKey**](/windows/desktop/SecCrypto/privatekey) 屬性 \# 。</span><span class="sxs-lookup"><span data-stu-id="2240b-183">Call the [**PrivateKey**](/windows/desktop/SecCrypto/privatekey) property on the PKCS \#10 request.</span></span>
5.  <span data-ttu-id="2240b-184">呼叫從步驟4取出的 [**IX509PrivateKey**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509privatekey)物件上的 [**ProviderType**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509privatekey-get_providertype)屬性。</span><span class="sxs-lookup"><span data-stu-id="2240b-184">Call the [**ProviderType**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509privatekey-get_providertype) property on the [**IX509PrivateKey**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509privatekey) object retrieved from step 4.</span></span>

## <a name="related-topics"></a><span data-ttu-id="2240b-185">相關主題</span><span class="sxs-lookup"><span data-stu-id="2240b-185">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="2240b-186">將 Xenroll.dll 對應至 CertEnroll.dll</span><span class="sxs-lookup"><span data-stu-id="2240b-186">Mapping Xenroll.dll to CertEnroll.dll</span></span>](mapping-xenroll-dll-to-certenroll-dll.md)
</dt> <dt>

[<span data-ttu-id="2240b-187">**ICspAlgorithm**</span><span class="sxs-lookup"><span data-stu-id="2240b-187">**ICspAlgorithm**</span></span>](/windows/desktop/api/CertEnroll/nn-certenroll-icspalgorithm)
</dt> <dt>

[<span data-ttu-id="2240b-188">**ICspAlgorithms**</span><span class="sxs-lookup"><span data-stu-id="2240b-188">**ICspAlgorithms**</span></span>](/windows/desktop/api/CertEnroll/nn-certenroll-icspalgorithms)
</dt> <dt>

[<span data-ttu-id="2240b-189">**ICspInformation**</span><span class="sxs-lookup"><span data-stu-id="2240b-189">**ICspInformation**</span></span>](/windows/desktop/api/CertEnroll/nn-certenroll-icspinformation)
</dt> <dt>

[<span data-ttu-id="2240b-190">**ICspInformations**</span><span class="sxs-lookup"><span data-stu-id="2240b-190">**ICspInformations**</span></span>](/windows/desktop/api/CertEnroll/nn-certenroll-icspinformations)
</dt> <dt>

[<span data-ttu-id="2240b-191">**IX509Enrollment**</span><span class="sxs-lookup"><span data-stu-id="2240b-191">**IX509Enrollment**</span></span>](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment)
</dt> <dt>

[<span data-ttu-id="2240b-192">**IX509PrivateKey**</span><span class="sxs-lookup"><span data-stu-id="2240b-192">**IX509PrivateKey**</span></span>](/windows/desktop/api/CertEnroll/nn-certenroll-ix509privatekey)
</dt> </dl>

 

 
