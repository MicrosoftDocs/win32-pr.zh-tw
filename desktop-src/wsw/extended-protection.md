---
title: 開始就支援
description: 「擴充保護」是一種機制，可將外部安全通道（例如 SSL）系結至內部通道驗證通訊協定，例如 Kerberos APREQ 和 HTTP 標頭驗證。
ms.assetid: 35e48846-05e5-4db9-a3b5-098b62815b66
keywords:
- 擴充保護原生 Web 服務
- WWSAPI
- WWS
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 895bdfecf994f6673c2ed7e7367bc3a7b5bd70c9
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 09/16/2019
ms.locfileid: "106966197"
---
# <a name="extended-protection"></a><span data-ttu-id="19ee1-106">開始就支援</span><span class="sxs-lookup"><span data-stu-id="19ee1-106">Extended Protection</span></span>

<span data-ttu-id="19ee1-107">「擴充保護」是一種機制，可將外部安全通道（例如 SSL）系結至內部通道驗證通訊協定，例如 Kerberos APREQ 和 HTTP 標頭驗證。</span><span class="sxs-lookup"><span data-stu-id="19ee1-107">Extended protection is a mechanism to bind an outer secure channel such as SSL to inner channel authentication protocols such as Kerberos-APREQ and HTTP header authentication.</span></span>

<span data-ttu-id="19ee1-108">擴充保護的概念是在 RFC2743 中定義。</span><span class="sxs-lookup"><span data-stu-id="19ee1-108">The concept of extended protection is defined in RFC2743.</span></span>

<span data-ttu-id="19ee1-109">如果有擴充保護，則會自動在用戶端上設定，但在伺服器上可能需要針對非預設案例進行設定。</span><span class="sxs-lookup"><span data-stu-id="19ee1-109">Extended protection, when available, is configured automatically on the client but may require configuration on the server for non-default scenarios.</span></span>

## <a name="supported-configurations"></a><span data-ttu-id="19ee1-110">支援的組態</span><span class="sxs-lookup"><span data-stu-id="19ee1-110">Supported Configurations</span></span>

<span data-ttu-id="19ee1-111">使用 Windows 整合式驗證通訊協定（例如 [**ws \_ HTTP \_ 標頭 \_ 驗證 \_ 安全性 \_**](/windows/desktop/api/WebServices/ns-webservices-ws_http_header_auth_security_binding)系結和 [**ws \_ KERBEROS \_ APREQ \_ 訊息 \_ 安全性 \_**](/windows/desktop/api/WebServices/ns-webservices-ws_kerberos_apreq_message_security_binding)系結）搭配安全性系結使用 [**WS \_ HTTP \_ 通道 \_**](/windows/desktop/api/WebServices/ne-webservices-ws_channel_binding)系結時，支援擴充保護。</span><span class="sxs-lookup"><span data-stu-id="19ee1-111">Extended protection is supported when using [**WS\_HTTP\_CHANNEL\_BINDING**](/windows/desktop/api/WebServices/ne-webservices-ws_channel_binding) with security bindings using Windows Integrated Authentication protocols such as [**WS\_HTTP\_HEADER\_AUTH\_SECURITY\_BINDING**](/windows/desktop/api/WebServices/ns-webservices-ws_http_header_auth_security_binding) and [**WS\_KERBEROS\_APREQ\_MESSAGE\_SECURITY\_BINDING**](/windows/desktop/api/WebServices/ns-webservices-ws_kerberos_apreq_message_security_binding).</span></span> <span data-ttu-id="19ee1-112">它是透過下列 [**安全性屬性**](/windows/desktop/api/WebServices/ns-webservices-ws_security_property)進行設定：</span><span class="sxs-lookup"><span data-stu-id="19ee1-112">It is configured via the following [**security properties**](/windows/desktop/api/WebServices/ns-webservices-ws_security_property):</span></span>

-   [<span data-ttu-id="19ee1-113">**WS \_ 安全性 \_ 屬性 \_ 延伸 \_ 保護 \_ 原則**</span><span class="sxs-lookup"><span data-stu-id="19ee1-113">**WS\_SECURITY\_PROPERTY\_EXTENDED\_PROTECTION\_POLICY**</span></span>](/windows/desktop/api/WebServices/ne-webservices-ws_security_property_id)
-   [<span data-ttu-id="19ee1-114">**WS \_ 安全性 \_ 屬性 \_ 擴充 \_ 保護 \_ 案例**</span><span class="sxs-lookup"><span data-stu-id="19ee1-114">**WS\_SECURITY\_PROPERTY\_EXTENDED\_PROTECTION\_SCENARIO**</span></span>](/windows/desktop/api/WebServices/ne-webservices-ws_security_property_id)
-   [<span data-ttu-id="19ee1-115">**WS \_ 安全性 \_ 屬性 \_ 服務 \_ 身分識別**</span><span class="sxs-lookup"><span data-stu-id="19ee1-115">**WS\_SECURITY\_PROPERTY\_SERVICE\_IDENTITIES**</span></span>](/windows/desktop/api/WebServices/ne-webservices-ws_security_property_id)

<span data-ttu-id="19ee1-116">以下是可能涉及擴充保護的設定：</span><span class="sxs-lookup"><span data-stu-id="19ee1-116">The following configurations involving extended protection are possible:</span></span>

<span data-ttu-id="19ee1-117">用戶端</span><span class="sxs-lookup"><span data-stu-id="19ee1-117">Client</span></span>

-   <span data-ttu-id="19ee1-118">[**WS \_SSL \_ 傳輸 \_ 安全性 \_**](/windows/desktop/api/WebServices/ns-webservices-ws_ssl_transport_security_binding) 系結會與 [**ws \_ KERBEROS \_ APREQ \_ 訊息 \_ 安全性 \_**](/windows/desktop/api/WebServices/ns-webservices-ws_kerberos_apreq_message_security_binding) 系結或 [**ws \_ HTTP \_ 標頭 \_ 驗證 \_ 安全性 \_**](/windows/desktop/api/WebServices/ns-webservices-ws_http_header_auth_security_binding)系結搭配使用。</span><span class="sxs-lookup"><span data-stu-id="19ee1-118">[**WS\_SSL\_TRANSPORT\_SECURITY\_BINDING**](/windows/desktop/api/WebServices/ns-webservices-ws_ssl_transport_security_binding) is used with [**WS\_KERBEROS\_APREQ\_MESSAGE\_SECURITY\_BINDING**](/windows/desktop/api/WebServices/ns-webservices-ws_kerberos_apreq_message_security_binding) or [**WS\_HTTP\_HEADER\_AUTH\_SECURITY\_BINDING**](/windows/desktop/api/WebServices/ns-webservices-ws_http_header_auth_security_binding).</span></span> <span data-ttu-id="19ee1-119">在這項設定中，驗證系結會透過從 SSL 連線自動解壓縮的延伸保護權杖，系結至 SSL 連線。</span><span class="sxs-lookup"><span data-stu-id="19ee1-119">In this configuration the authentication binding is bound to the SSL connection via an extended protection token that is automatically extracted from the SSL connection.</span></span>
-   <span data-ttu-id="19ee1-120">未使用任何 SSL，且已設定 [**WS \_ HTTP \_ 標頭 \_ 驗證 \_ 安全性 \_**](/windows/desktop/api/WebServices/ns-webservices-ws_http_header_auth_security_binding) 系結。</span><span class="sxs-lookup"><span data-stu-id="19ee1-120">No SSL is used and [**WS\_HTTP\_HEADER\_AUTH\_SECURITY\_BINDING**](/windows/desktop/api/WebServices/ns-webservices-ws_http_header_auth_security_binding) is set.</span></span> <span data-ttu-id="19ee1-121">驗證系結會透過伺服器主體名稱 (SPN) 來系結，autonatically 由 [**WS \_ 端點 \_ 位址**](/windows/desktop/api/WebServices/ns-webservices-ws_endpoint_address)決定。</span><span class="sxs-lookup"><span data-stu-id="19ee1-121">The authentication binding is bound via the Server Principal Name (SPN), which is autonatically determined from the [**WS\_ENDPOINT\_ADDRESS**](/windows/desktop/api/WebServices/ns-webservices-ws_endpoint_address).</span></span>

<span data-ttu-id="19ee1-122">伺服器</span><span class="sxs-lookup"><span data-stu-id="19ee1-122">Server</span></span>

-   <span data-ttu-id="19ee1-123">[**WS \_SSL \_ 傳輸 \_ 安全性 \_**](/windows/desktop/api/WebServices/ns-webservices-ws_ssl_transport_security_binding) 系結會與 [**ws \_ KERBEROS \_ APREQ \_ 訊息 \_ 安全性 \_**](/windows/desktop/api/WebServices/ns-webservices-ws_kerberos_apreq_message_security_binding) 系結或 [**ws \_ HTTP \_ 標頭 \_ 驗證 \_ 安全性 \_**](/windows/desktop/api/WebServices/ns-webservices-ws_http_header_auth_security_binding)系結搭配使用。</span><span class="sxs-lookup"><span data-stu-id="19ee1-123">[**WS\_SSL\_TRANSPORT\_SECURITY\_BINDING**](/windows/desktop/api/WebServices/ns-webservices-ws_ssl_transport_security_binding) is used with [**WS\_KERBEROS\_APREQ\_MESSAGE\_SECURITY\_BINDING**](/windows/desktop/api/WebServices/ns-webservices-ws_kerberos_apreq_message_security_binding) or [**WS\_HTTP\_HEADER\_AUTH\_SECURITY\_BINDING**](/windows/desktop/api/WebServices/ns-webservices-ws_http_header_auth_security_binding).</span></span> <span data-ttu-id="19ee1-124">在這項設定中，驗證系結會透過擴充保護權杖系結至 SSL 連線，此權杖會從 SSL 連線中解壓縮並自動驗證。</span><span class="sxs-lookup"><span data-stu-id="19ee1-124">In this configuration the authentication binding is bound to the SSL connection via an extended protection token that is extracted from the SSL connection and validated automatically.</span></span>
-   <span data-ttu-id="19ee1-125">未使用任何 SSL，且已設定 [**WS \_ HTTP \_ 標頭 \_ 驗證 \_ 安全性 \_**](/windows/desktop/api/WebServices/ns-webservices-ws_http_header_auth_security_binding) 系結。</span><span class="sxs-lookup"><span data-stu-id="19ee1-125">No SSL is used and [**WS\_HTTP\_HEADER\_AUTH\_SECURITY\_BINDING**](/windows/desktop/api/WebServices/ns-webservices-ws_http_header_auth_security_binding) is set.</span></span> <span data-ttu-id="19ee1-126">驗證系結會透過伺服器主體名稱系結 (SPN) ，必須透過 [**WS \_ 安全性 \_ 屬性 \_ 服務 \_**](/windows/desktop/api/WebServices/ne-webservices-ws_security_property_id)識別來提供。</span><span class="sxs-lookup"><span data-stu-id="19ee1-126">The authentication binding is bound via the Server Principal Name (SPN), which must be provided via [**WS\_SECURITY\_PROPERTY\_SERVICE\_IDENTITIES**](/windows/desktop/api/WebServices/ne-webservices-ws_security_property_id).</span></span> <span data-ttu-id="19ee1-127">收到訊息時，會將 SPN 解壓縮，並驗證是否完全符合所提供的服務名稱。</span><span class="sxs-lookup"><span data-stu-id="19ee1-127">When a message is received, the SPN is extracted and validated for an exact match with the provided service names.</span></span> <span data-ttu-id="19ee1-128">未提供 Spn 等同于設定 [**WS \_ 延伸 \_ 保護 \_ 原則 \_ 永不**](/windows/desktop/api/WebServices/ne-webservices-ws_extended_protection_policy)如此。</span><span class="sxs-lookup"><span data-stu-id="19ee1-128">Not providing SPNs is the equivalent of setting [**WS\_EXTENDED\_PROTECTION\_POLICY\_NEVER**](/windows/desktop/api/WebServices/ne-webservices-ws_extended_protection_policy).</span></span>
-   <span data-ttu-id="19ee1-129">未使用任何 SSL、已指定 [**ws \_ 擴充 \_ 保護 \_ 案例 \_ \_**](/windows/desktop/api/WebServices/ne-webservices-ws_extended_protection_scenario) 系結伺服器，且使用 [**ws \_ KERBEROS \_ APREQ \_ 訊息 \_ 安全性 \_**](/windows/desktop/api/WebServices/ns-webservices-ws_kerberos_apreq_message_security_binding) 系結。</span><span class="sxs-lookup"><span data-stu-id="19ee1-129">No SSL is used, [**WS\_EXTENDED\_PROTECTION\_SCENARIO\_BOUND\_SERVER**](/windows/desktop/api/WebServices/ne-webservices-ws_extended_protection_scenario) is specified and [**WS\_KERBEROS\_APREQ\_MESSAGE\_SECURITY\_BINDING**](/windows/desktop/api/WebServices/ns-webservices-ws_kerberos_apreq_message_security_binding) is used.</span></span> <span data-ttu-id="19ee1-130">在此設定中，不能設定 [**WS \_ SECURITY \_ PROPERTY \_ SERVICE \_**](/windows/desktop/api/WebServices/ne-webservices-ws_security_property_id) 身分識別。</span><span class="sxs-lookup"><span data-stu-id="19ee1-130">In this configuration, [**WS\_SECURITY\_PROPERTY\_SERVICE\_IDENTITIES**](/windows/desktop/api/WebServices/ne-webservices-ws_security_property_id) must not be set.</span></span> <span data-ttu-id="19ee1-131">除了 Kerberos 通訊協定的一部分以外，不會執行任何 SPN 檢查。</span><span class="sxs-lookup"><span data-stu-id="19ee1-131">No SPN check is performed beyond what is done as part of the Kerberos protocol.</span></span>
-   <span data-ttu-id="19ee1-132">[**WS \_已指定擴充 \_ 保護 \_ 案例 \_ 終止的 \_ SSL**](/windows/desktop/api/WebServices/ne-webservices-ws_extended_protection_scenario) ，且使用 [**ws \_ KERBEROS \_ APREQ \_ 訊息 \_ 安全性 \_**](/windows/desktop/api/WebServices/ns-webservices-ws_kerberos_apreq_message_security_binding) 系結或 [**ws \_ HTTP \_ 標頭 \_ 驗證 \_ 安全性 \_**](/windows/desktop/api/WebServices/ns-webservices-ws_http_header_auth_security_binding) 系結。</span><span class="sxs-lookup"><span data-stu-id="19ee1-132">[**WS\_EXTENDED\_PROTECTION\_SCENARIO\_TERMINATED\_SSL**](/windows/desktop/api/WebServices/ne-webservices-ws_extended_protection_scenario) is specified and either [**WS\_KERBEROS\_APREQ\_MESSAGE\_SECURITY\_BINDING**](/windows/desktop/api/WebServices/ns-webservices-ws_kerberos_apreq_message_security_binding) or [**WS\_HTTP\_HEADER\_AUTH\_SECURITY\_BINDING**](/windows/desktop/api/WebServices/ns-webservices-ws_http_header_auth_security_binding) is used.</span></span> <span data-ttu-id="19ee1-133">[**WS \_必須設定安全性 \_ 屬性 \_ 服務 \_**](/windows/desktop/api/WebServices/ne-webservices-ws_security_property_id) 識別。</span><span class="sxs-lookup"><span data-stu-id="19ee1-133">[**WS\_SECURITY\_PROPERTY\_SERVICE\_IDENTITIES**](/windows/desktop/api/WebServices/ne-webservices-ws_security_property_id) must be set.</span></span>

## <a name="supported-platforms"></a><span data-ttu-id="19ee1-134">支援的平台</span><span class="sxs-lookup"><span data-stu-id="19ee1-134">Supported Platforms</span></span>

<span data-ttu-id="19ee1-135">在作業系統中支援擴充保護的平臺支援。</span><span class="sxs-lookup"><span data-stu-id="19ee1-135">Extended protection is supported on platforms with support for it in the operating system.</span></span> <span data-ttu-id="19ee1-136">Windows 7 和 Windows Server 2008 R2 提供內建支援。</span><span class="sxs-lookup"><span data-stu-id="19ee1-136">Windows 7 and Windows Server 2008 R2 provide built-in support.</span></span> <span data-ttu-id="19ee1-137">其他平臺可能需要更新。</span><span class="sxs-lookup"><span data-stu-id="19ee1-137">Other platforms may require an update.</span></span>

<span data-ttu-id="19ee1-138">如果伺服器的作業系統未提供這類支援，用戶端傳送的任何擴充保護資訊都會被忽略。</span><span class="sxs-lookup"><span data-stu-id="19ee1-138">If the server's operating system does not provide such support, any extended protection information sent by the client is ignored.</span></span> <span data-ttu-id="19ee1-139">如此一來，使用擴充保護的用戶端就可以與這類伺服器通訊，但會遺失安全性優勢。</span><span class="sxs-lookup"><span data-stu-id="19ee1-139">As a result, clients using extended protection can communicate with such a server, but the security benefit is lost.</span></span> <span data-ttu-id="19ee1-140">在用戶端上， [**ws \_ KERBEROS \_ APREQ \_ 訊息 \_ 安全性 \_**](/windows/desktop/api/WebServices/ns-webservices-ws_kerberos_apreq_message_security_binding) 系結與 [**ws \_ SSL \_ 傳輸 \_ 安全性 \_**](/windows/desktop/api/WebServices/ns-webservices-ws_ssl_transport_security_binding) 系結結合，只支援 Vista 和更新版本的擴充保護。</span><span class="sxs-lookup"><span data-stu-id="19ee1-140">On the client, [**WS\_KERBEROS\_APREQ\_MESSAGE\_SECURITY\_BINDING**](/windows/desktop/api/WebServices/ns-webservices-ws_kerberos_apreq_message_security_binding) combined with [**WS\_SSL\_TRANSPORT\_SECURITY\_BINDING**](/windows/desktop/api/WebServices/ns-webservices-ws_ssl_transport_security_binding) only supports extended protection on Vista and above.</span></span>

<span data-ttu-id="19ee1-141">注意：無法使用擴充保護，因此不會防止使用任何特定設定。</span><span class="sxs-lookup"><span data-stu-id="19ee1-141">NOTE: Extended protection being unavailable does not prevent any particular configuration from being used.</span></span>

## <a name="interoperability"></a><span data-ttu-id="19ee1-142">互通性</span><span class="sxs-lookup"><span data-stu-id="19ee1-142">Interoperability</span></span>

<span data-ttu-id="19ee1-143">預設設定的伺服器可以與 SOAP 用戶端通訊，而不論它們是否使用擴充保護。</span><span class="sxs-lookup"><span data-stu-id="19ee1-143">A default-configured server can communicate with SOAP clients regardless of whether they use extended protection or not.</span></span> <span data-ttu-id="19ee1-144">其中一個例外狀況是 Windows XP 和 Windows Server 2003 WWSAPI 用戶端，這些用戶端已更新為支援擴充保護，並且使用 [**ws \_ KERBEROS \_ APREQ \_ 訊息 \_ 安全性 \_**](/windows/desktop/api/WebServices/ns-webservices-ws_kerberos_apreq_message_security_binding) 系結和 [**ws \_ SSL \_ 傳輸 \_ 安全性 \_**](/windows/desktop/api/WebServices/ns-webservices-ws_ssl_transport_security_binding)系結。</span><span class="sxs-lookup"><span data-stu-id="19ee1-144">The one exception being Windows XP and Windows Server 2003 WWSAPI clients that have been updated to support extended protection and use both [**WS\_KERBEROS\_APREQ\_MESSAGE\_SECURITY\_BINDING**](/windows/desktop/api/WebServices/ns-webservices-ws_kerberos_apreq_message_security_binding) and [**WS\_SSL\_TRANSPORT\_SECURITY\_BINDING**](/windows/desktop/api/WebServices/ns-webservices-ws_ssl_transport_security_binding).</span></span> <span data-ttu-id="19ee1-145">若要支援這類用戶端，您永遠都不能指定伺服器所指定的 [**WS \_ 延伸 \_ 保護 \_ 原則 \_**](/windows/desktop/api/WebServices/ne-webservices-ws_extended_protection_policy) 。</span><span class="sxs-lookup"><span data-stu-id="19ee1-145">To support such clients [**WS\_EXTENDED\_PROTECTION\_POLICY\_NEVER**](/windows/desktop/api/WebServices/ne-webservices-ws_extended_protection_policy) must be specified by the server.</span></span> <span data-ttu-id="19ee1-146">使用 **WS \_ 延伸 \_ 保護 \_ 原則 \_** 設定的伺服器一律會拒絕不使用擴充保護的用戶端進行通訊。</span><span class="sxs-lookup"><span data-stu-id="19ee1-146">Servers configured with **WS\_EXTENDED\_PROTECTION\_POLICY\_ALWAYS** will reject communication from clients that do not use extended protection.</span></span> <span data-ttu-id="19ee1-147">在用戶端上， **ws \_ KERBEROS \_ APREQ \_ 訊息 \_ 安全性 \_** 系結與 **ws \_ SSL \_ 傳輸 \_ 安全性 \_** 系結結合之後，將會使用 Vista 和更新版本上的 HTTP 區塊傳輸編碼來傳送訊息。</span><span class="sxs-lookup"><span data-stu-id="19ee1-147">On the client, **WS\_KERBEROS\_APREQ\_MESSAGE\_SECURITY\_BINDING** combined with **WS\_SSL\_TRANSPORT\_SECURITY\_BINDING** will result in the message being sent using the HTTP chunked transfer encoding on Vista and above.</span></span> <span data-ttu-id="19ee1-148">這可能會造成不支援區區塊轉送的伺服器發生互通性問題。</span><span class="sxs-lookup"><span data-stu-id="19ee1-148">This may cause interop issues with servers that do not support chunked transfer.</span></span>

<span data-ttu-id="19ee1-149">下列列舉/常數屬於擴充保護的一部分：</span><span class="sxs-lookup"><span data-stu-id="19ee1-149">The following Enums/Constants are part of extended protection:</span></span>

-   [<span data-ttu-id="19ee1-150">**WS \_ 延伸 \_ 保護 \_ 原則**</span><span class="sxs-lookup"><span data-stu-id="19ee1-150">**WS\_EXTENDED\_PROTECTION\_POLICY**</span></span>](/windows/desktop/api/WebServices/ne-webservices-ws_extended_protection_policy)
-   [<span data-ttu-id="19ee1-151">**WS \_ 擴充 \_ 保護 \_ 案例**</span><span class="sxs-lookup"><span data-stu-id="19ee1-151">**WS\_EXTENDED\_PROTECTION\_SCENARIO**</span></span>](/windows/desktop/api/WebServices/ne-webservices-ws_extended_protection_scenario)

<span data-ttu-id="19ee1-152">下列結構是擴充保護的一部分：</span><span class="sxs-lookup"><span data-stu-id="19ee1-152">The following stuctures are part of extended protection:</span></span>

-   [<span data-ttu-id="19ee1-153">**WS \_ 服務 \_ 安全性身分識別 \_**</span><span class="sxs-lookup"><span data-stu-id="19ee1-153">**WS\_SERVICE\_SECURITY\_IDENTITIES**</span></span>](/windows/desktop/api/WebServices/ns-webservices-ws_service_security_identities)

 

 




