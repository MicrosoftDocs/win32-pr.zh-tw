---
title: 安全性概觀
description: Windows Web 服務 API 中的安全性架構 (WWSAPI) 提供使用傳輸安全性的訊息完整性、機密性、重新執行偵測和伺服器驗證。
ms.assetid: 2681bffc-ba07-4822-b265-2bf7f95297d4
keywords:
- 適用于 Windows 的安全性概觀 Web 服務
- WWSAPI
- WWS
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 741e98ef023c0bae146b5fde582484f2dd133df6
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/20/2020
ms.locfileid: "104463472"
---
# <a name="security-overview"></a><span data-ttu-id="376a3-106">安全性概觀</span><span class="sxs-lookup"><span data-stu-id="376a3-106">Security Overview</span></span>

<span data-ttu-id="376a3-107">Windows Web 服務 API 中的安全性架構 (WWSAPI) 提供：</span><span class="sxs-lookup"><span data-stu-id="376a3-107">The security framework in Windows Web Services API (WWSAPI) provides:</span></span>

-   <span data-ttu-id="376a3-108">使用傳輸安全性的訊息完整性、機密性、重新執行偵測和伺服器驗證。</span><span class="sxs-lookup"><span data-stu-id="376a3-108">Message integrity, confidentiality, replay detection and server authentication using transport security.</span></span>
-   <span data-ttu-id="376a3-109">使用 SOAP 訊息安全性或傳輸安全性的用戶端驗證，例如安全性權杖驗證、憑證信任和撤銷檢查等等。</span><span class="sxs-lookup"><span data-stu-id="376a3-109">Client authentication such as security token validation, certificate trust and revocation checks, etc using SOAP message security or transport security.</span></span>

## <a name="the-security-programming-model"></a><span data-ttu-id="376a3-110">安全性程式設計模型</span><span class="sxs-lookup"><span data-stu-id="376a3-110">The Security Programming Model</span></span>

<span data-ttu-id="376a3-111">安全性[與通道相關聯。](channel-layer-overview.md)</span><span class="sxs-lookup"><span data-stu-id="376a3-111">Security is associated with [communication channels](channel-layer-overview.md).</span></span> <span data-ttu-id="376a3-112">保護通道是由下列步驟所組成。</span><span class="sxs-lookup"><span data-stu-id="376a3-112">Securing a channel consists of the following steps.</span></span>

-   <span data-ttu-id="376a3-113">建立並初始化適用于應用程式安全性需求的一或多個 [**安全性**](/windows/desktop/api/WebServices/ns-webservices-ws_security_binding) 系結。</span><span class="sxs-lookup"><span data-stu-id="376a3-113">Create and initialize one or more [**security bindings**](/windows/desktop/api/WebServices/ns-webservices-ws_security_binding) appropriate for the application's security requirements.</span></span>
-   <span data-ttu-id="376a3-114">建立包含這些安全性系結的 [**安全性描述**](/windows/desktop/api/WebServices/ns-webservices-ws_security_description) 。</span><span class="sxs-lookup"><span data-stu-id="376a3-114">Create a [**security description**](/windows/desktop/api/WebServices/ns-webservices-ws_security_description) containing those security bindings.</span></span>
-   <span data-ttu-id="376a3-115">在用戶端) 上建立 [**通道**](/windows/desktop/api/WebServices/nf-webservices-wscreatechannel)或 [**服務 proxy**](/windows/desktop/api/WebServices/nf-webservices-wscreateserviceproxy) (，或在伺服器端建立接聽 [**程式或**](/windows/desktop/api/WebServices/nf-webservices-wscreatelistener)[**服務主機**](/windows/desktop/api/WebServices/nf-webservices-wscreateservicehost) (，) 傳遞該安全性描述。</span><span class="sxs-lookup"><span data-stu-id="376a3-115">Create a [**channel**](/windows/desktop/api/WebServices/nf-webservices-wscreatechannel) or [**service proxy**](/windows/desktop/api/WebServices/nf-webservices-wscreateserviceproxy) (on the client side), or create a [**listener**](/windows/desktop/api/WebServices/nf-webservices-wscreatelistener) or [**service host**](/windows/desktop/api/WebServices/nf-webservices-wscreateservicehost) (on the server side) passing in that security description.</span></span>
-   <span data-ttu-id="376a3-116">進行開啟、接受、傳送、接收、關閉等的一般通道程式設計步驟。</span><span class="sxs-lookup"><span data-stu-id="376a3-116">Do the normal channel programming steps of Open, Accept, Send, Receive, Close etc.</span></span>

<span data-ttu-id="376a3-117">在通道上傳送和接收的訊息，會根據提供的安全性描述自動受到執行時間的保護。</span><span class="sxs-lookup"><span data-stu-id="376a3-117">Messages sent and received on the channel are secured automatically by the runtime according the supplied security description.</span></span> <span data-ttu-id="376a3-118">（選擇性）您可以在安全性系結中指定一或多個全 [通道安全性設定](security-channel-settings.md) ，或在安全性系結中指定整個系結 [安全性設定](security-binding-settings.md) ，以微調這些步驟。</span><span class="sxs-lookup"><span data-stu-id="376a3-118">Optionally, these steps can be fine-tuned by specifying one or more [channel-wide security settings](security-channel-settings.md) in the security description or [binding-wide security settings](security-binding-settings.md) in a security binding.</span></span>

<span data-ttu-id="376a3-119">任何需要的寄件者身分識別授權，都必須由應用程式使用附加至每個接收訊息的 [安全性處理結果](security-processing-results.md) 來完成。</span><span class="sxs-lookup"><span data-stu-id="376a3-119">Any required authorization of sender identities must be done by the application using the [security processing results](security-processing-results.md) attached to each received message.</span></span> <span data-ttu-id="376a3-120">安全性描述中未指定授權步驟，而且執行時間不會自動執行。</span><span class="sxs-lookup"><span data-stu-id="376a3-120">Authorization steps are not specified in the security description, nor are performed automatically by the runtime.</span></span>

<span data-ttu-id="376a3-121">安全性描述中的錯誤，例如不支援的系結、不適用屬性/欄位、缺少必要屬性/欄位或不正確屬性/域值，將導致通道或接聽程式建立失敗。</span><span class="sxs-lookup"><span data-stu-id="376a3-121">Errors in the security description, such as unsupported bindings, inapplicable properties/fields, lack of required properties/fields or invalid property/field values, will cause channel or listener creation to fail.</span></span>

## <a name="selecting-security-bindings"></a><span data-ttu-id="376a3-122">選取安全性系結</span><span class="sxs-lookup"><span data-stu-id="376a3-122">Selecting Security Bindings</span></span>

<span data-ttu-id="376a3-123">設計應用程式的安全性時，主要決定是要包含在安全性描述中的安全性系結選取。</span><span class="sxs-lookup"><span data-stu-id="376a3-123">When designing security for an application, the primary decision is the selection of the security bindings to be included in the security description.</span></span> <span data-ttu-id="376a3-124">以下是一些指導方針，可讓您選擇適用于應用程式安全性案例的安全性系結。</span><span class="sxs-lookup"><span data-stu-id="376a3-124">The following are some guidelines for choosing security bindings suitable for an application's security scenario.</span></span> <span data-ttu-id="376a3-125">有用的啟發學習法是先瞭解 (的安全性認證類型，例如 [**x.509 憑證**](/windows/desktop/api/WebServices/ns-webservices-ws_cert_credential)、 [**Windows 網域使用者名稱/密碼**](/windows/desktop/api/WebServices/ns-webservices-ws_windows_integrated_auth_credential)、 [**應用程式定義的使用者名稱/密碼**](/windows/desktop/api/WebServices/ns-webservices-ws_username_credential)) 將可供應用程式使用，然後選擇可以使用該認證類型的安全性系結。</span><span class="sxs-lookup"><span data-stu-id="376a3-125">A useful heuristic is to first understand what security credential types (such as [**X.509 certificates**](/windows/desktop/api/WebServices/ns-webservices-ws_cert_credential), [**Windows domain username/passwords**](/windows/desktop/api/WebServices/ns-webservices-ws_windows_integrated_auth_credential), [**application defined username/passwords**](/windows/desktop/api/WebServices/ns-webservices-ws_username_credential)) will be available to the application, and to then choose a security binding that can use that credential type.</span></span>

-   <span data-ttu-id="376a3-126">安全性會套用至傳輸位元組資料流程層級 (在 SOAP 訊息界限) 底下的傳輸安全性，是第一個要考慮的選項。</span><span class="sxs-lookup"><span data-stu-id="376a3-126">Transport security, where security is applied at the transport byte stream level (below the SOAP message boundaries), is the first option to consider.</span></span>
    -   <span data-ttu-id="376a3-127">針對網際網路案例，以及可在伺服器上部署 x.509 憑證的內部網路案例中，應用程式可能會使用 [**WS \_ SSL \_ 傳輸 \_ 安全性 \_**](/windows/desktop/api/WebServices/ns-webservices-ws_ssl_transport_security_binding)系結。</span><span class="sxs-lookup"><span data-stu-id="376a3-127">For Internet scenarios, and for those Intranet scenarios where an X.509 certificate can be deployed at the server, the application may use [**WS\_SSL\_TRANSPORT\_SECURITY\_BINDING**](/windows/desktop/api/WebServices/ns-webservices-ws_ssl_transport_security_binding).</span></span> <span data-ttu-id="376a3-128">下列範例說明此選項。</span><span class="sxs-lookup"><span data-stu-id="376a3-128">The following example illustrates this option.</span></span> <span data-ttu-id="376a3-129">Client： [HttpClientWithSslExample](httpclientwithsslexample.md) Server： [HttpServerWithSslExample](httpserverwithsslexample.md)。</span><span class="sxs-lookup"><span data-stu-id="376a3-129">Client: [HttpClientWithSslExample](httpclientwithsslexample.md) Server: [HttpServerWithSslExample](httpserverwithsslexample.md).</span></span>

        <span data-ttu-id="376a3-130">如果需要透過 HTTP 標頭驗證進行用戶端驗證，則可以新增 [**WS \_ HTTP \_ 標頭 \_ 驗證 \_ 安全性 \_**](/windows/desktop/api/WebServices/ns-webservices-ws_http_header_auth_security_binding) 系結來提供該功能。</span><span class="sxs-lookup"><span data-stu-id="376a3-130">If client authentication via HTTP header authentication is desired, a [**WS\_HTTP\_HEADER\_AUTH\_SECURITY\_BINDING**](/windows/desktop/api/WebServices/ns-webservices-ws_http_header_auth_security_binding) can be added to provide that functionality.</span></span>

    -   <span data-ttu-id="376a3-131">若是適用于 Windows 整合式驗證通訊協定（例如 Kerberos、NTLM 和 SPNEGO）的內部網路案例，應用程式可能會使用 [**WS \_ TCP \_ SSPI \_ 傳輸 \_ 安全性 \_**](/windows/desktop/api/WebServices/ns-webservices-ws_tcp_sspi_transport_security_binding)系結。</span><span class="sxs-lookup"><span data-stu-id="376a3-131">For Intranet scenarios where Windows Integrated Authentication protocols such as Kerberos, NTLM and SPNEGO are appropriate, the application may use [**WS\_TCP\_SSPI\_TRANSPORT\_SECURITY\_BINDING**](/windows/desktop/api/WebServices/ns-webservices-ws_tcp_sspi_transport_security_binding).</span></span> <span data-ttu-id="376a3-132">下列範例說明此選項： Client： [RequestReplyTcpClientWithWindowsTransportSecurityExample](requestreplytcpclientwithwindowstransportsecurityexample.md) Server： [RequestReplyTcpServerWithWindowsTransportSecurityExample](requestreplytcpserverwithwindowstransportsecurityexample.md)。</span><span class="sxs-lookup"><span data-stu-id="376a3-132">The following example illustrates this option: Client: [RequestReplyTcpClientWithWindowsTransportSecurityExample](requestreplytcpclientwithwindowstransportsecurityexample.md) Server: [RequestReplyTcpServerWithWindowsTransportSecurityExample](requestreplytcpserverwithwindowstransportsecurityexample.md).</span></span>

        <span data-ttu-id="376a3-133">用戶端 over 具名管道： [RequestReplyNamedPipesClientWithWindowsTransportSecurityExample](requestreplynamedpipesclientwithwindowstransportsecurityexample.md)</span><span class="sxs-lookup"><span data-stu-id="376a3-133">Client over named pipes: [RequestReplyNamedPipesClientWithWindowsTransportSecurityExample](requestreplynamedpipesclientwithwindowstransportsecurityexample.md)</span></span>

        <span data-ttu-id="376a3-134">伺服器 over 具名管道： [RequestReplyNamedPipesServerWithWindowsTransportSecurityExample](requestreplynamedpipesserverwithwindowstransportsecurityexample.md)</span><span class="sxs-lookup"><span data-stu-id="376a3-134">Server over named pipes: [RequestReplyNamedPipesServerWithWindowsTransportSecurityExample](requestreplynamedpipesserverwithwindowstransportsecurityexample.md)</span></span>

    -   <span data-ttu-id="376a3-135">針對 Windows 整合式驗證通訊協定（例如 Kerberos、NTLM 和 SPNEGO）的本機電腦案例，應用程式可能會使用 [**ws \_ TCP \_ SSPI \_ 傳輸 \_ 安全性 \_**](/windows/desktop/api/WebServices/ns-webservices-ws_tcp_sspi_transport_security_binding) 系結或 [**ws \_ NAMEDPIPE \_ SSPI \_ 傳輸 \_ 安全性 \_**](/windows/desktop/api/WebServices/ns-webservices-ws_namedpipe_sspi_transport_security_binding)系結。</span><span class="sxs-lookup"><span data-stu-id="376a3-135">For local machine scenarios where Windows Integrated Authentication protocols such as Kerberos, NTLM and SPNEGO are appropriate, the application may use [**WS\_TCP\_SSPI\_TRANSPORT\_SECURITY\_BINDING**](/windows/desktop/api/WebServices/ns-webservices-ws_tcp_sspi_transport_security_binding) or [**WS\_NAMEDPIPE\_SSPI\_TRANSPORT\_SECURITY\_BINDING**](/windows/desktop/api/WebServices/ns-webservices-ws_namedpipe_sspi_transport_security_binding).</span></span> <span data-ttu-id="376a3-136">[**Ws \_ NAMEDPIPE \_ 通道系結在這 \_**](/windows/desktop/api/WebServices/ne-webservices-ws_channel_binding)種情況下是慣用的，因為它可確保流量不會離開電腦 (這是 **WS \_ NAMEDPIPE \_ 通道 \_** 系結) 的屬性。</span><span class="sxs-lookup"><span data-stu-id="376a3-136">The [**WS\_NAMEDPIPE\_CHANNEL\_BINDING**](/windows/desktop/api/WebServices/ne-webservices-ws_channel_binding) is preferred in such scenarios because it guarantees that traffic will not leave the machine (this is the property of **WS\_NAMEDPIPE\_CHANNEL\_BINDING**).</span></span>

-   <span data-ttu-id="376a3-137">混合模式安全性，其中傳輸安全性可保護連接，而 SOAP 訊息中的 WS-Security 標頭會提供用戶端驗證，是下一個要考慮的選項。</span><span class="sxs-lookup"><span data-stu-id="376a3-137">Mixed-mode security, where transport security protects the connection and a WS-Security header in the SOAP message provides client authentication, is the next option to consider.</span></span> <span data-ttu-id="376a3-138">下列系結會與上一節所述的其中一個傳輸安全性系結搭配使用。</span><span class="sxs-lookup"><span data-stu-id="376a3-138">The following bindings are used in conjunction with one of the transport security bindings described in the previous section.</span></span>
    -   <span data-ttu-id="376a3-139">當用戶端是由應用層級的使用者名稱/密碼組進行驗證時，應用程式可以使用 [**WS 使用者 \_ 名稱 \_ 訊息 \_ 安全性 \_**](/windows/desktop/api/WebServices/ns-webservices-ws_username_message_security_binding) 系結來提供驗證資料。</span><span class="sxs-lookup"><span data-stu-id="376a3-139">When the client is authenticated by an application-level username/password pair, the application can use a [**WS\_USERNAME\_MESSAGE\_SECURITY\_BINDING**](/windows/desktop/api/WebServices/ns-webservices-ws_username_message_security_binding) to provide the authentication data.</span></span> <span data-ttu-id="376a3-140">下列範例說明如何使用此系結搭配 [**WS \_ SSL \_ 傳輸 \_ 安全性 \_**](/windows/desktop/api/WebServices/ns-webservices-ws_ssl_transport_security_binding)系結：</span><span class="sxs-lookup"><span data-stu-id="376a3-140">The following examples illustrate the usage of this binding in conjunction with a [**WS\_SSL\_TRANSPORT\_SECURITY\_BINDING**](/windows/desktop/api/WebServices/ns-webservices-ws_ssl_transport_security_binding):</span></span>
        -   <span data-ttu-id="376a3-141">用戶端： [HttpClientWithUsernameOverSslExample](httpclientwithusernameoversslexample.md)</span><span class="sxs-lookup"><span data-stu-id="376a3-141">Client: [HttpClientWithUsernameOverSslExample](httpclientwithusernameoversslexample.md)</span></span>
        -   <span data-ttu-id="376a3-142">伺服器： [HttpServerWithUsernameOverSslExample](httpserverwithusernameoversslexample.md)</span><span class="sxs-lookup"><span data-stu-id="376a3-142">Server: [HttpServerWithUsernameOverSslExample](httpserverwithusernameoversslexample.md)</span></span>
    -   <span data-ttu-id="376a3-143">當用戶端由 Kerberos 票證進行驗證時，應用程式可以使用 [**WS \_ Kerberos \_ APREQ \_ 訊息 \_ 安全性 \_**](/windows/desktop/api/WebServices/ns-webservices-ws_kerberos_apreq_message_security_binding) 系結來提供驗證資料。</span><span class="sxs-lookup"><span data-stu-id="376a3-143">When the client is authenticated by a Kerberos ticket, the application can use a [**WS\_KERBEROS\_APREQ\_MESSAGE\_SECURITY\_BINDING**](/windows/desktop/api/WebServices/ns-webservices-ws_kerberos_apreq_message_security_binding) to provide the authentication data.</span></span>
    -   <span data-ttu-id="376a3-144">使用 [安全性內容](security-context.md)時，用戶端會先建立與伺服器的安全性內容，然後使用該內容來驗證訊息。</span><span class="sxs-lookup"><span data-stu-id="376a3-144">When using a [security context](security-context.md), the client first establishes a security context with the server and then uses that context to authenticate messages.</span></span> <span data-ttu-id="376a3-145">若要啟用此功能，安全性描述必須包含 [**WS \_ 安全性 \_ 內容 \_ 訊息 \_ 安全性 \_**](/windows/desktop/api/WebServices/ns-webservices-ws_security_context_message_security_binding)系結。</span><span class="sxs-lookup"><span data-stu-id="376a3-145">To enable this functionality, the security description must contain a [**WS\_SECURITY\_CONTEXT\_MESSAGE\_SECURITY\_BINDING**](/windows/desktop/api/WebServices/ns-webservices-ws_security_context_message_security_binding).</span></span> <span data-ttu-id="376a3-146">一旦建立之後，就可以透過輕量權杖來傳輸安全性內容，這樣可避免必須在每個訊息中傳送可能耗用大量和計算成本的用戶端認證。</span><span class="sxs-lookup"><span data-stu-id="376a3-146">Once established, security contexts can be transmitted by means of lightweight tokens, which avoids having to send the potentially large and computationally expensive client credentials with every message.</span></span>
    -   <span data-ttu-id="376a3-147">在 [聯合安全性](federation.md) 案例中，用戶端會先取得安全性權杖服務所發出的安全性權杖 (STS) ，然後將發行的權杖提供給服務。</span><span class="sxs-lookup"><span data-stu-id="376a3-147">In a [federated security](federation.md) scenario, the client first obtains a security token issued by a security token service (STS), and then presents the issued token to a service.</span></span> <span data-ttu-id="376a3-148">用戶端：若要從 STS 取得安全性權杖，應用程式可以使用 [**WsRequestSecurityToken**](/windows/desktop/api/WebServices/nf-webservices-wsrequestsecuritytoken)。</span><span class="sxs-lookup"><span data-stu-id="376a3-148">Client-side: To obtain the security token from the STS, the application may use [**WsRequestSecurityToken**](/windows/desktop/api/WebServices/nf-webservices-wsrequestsecuritytoken).</span></span> <span data-ttu-id="376a3-149">或者，應用程式可能會使用用戶端安全性權杖提供者程式庫（例如 CardSpace 或 LiveID），然後使用其輸出在本機建立使用 [**WsCreateXmlSecurityToken**](/windows/desktop/api/WebServices/nf-webservices-wscreatexmlsecuritytoken)的安全性權杖。</span><span class="sxs-lookup"><span data-stu-id="376a3-149">Alternatively, the application may use a client side security token provider library such as CardSpace or LiveID, and then use their output to locally create a security token using [**WsCreateXmlSecurityToken**](/windows/desktop/api/WebServices/nf-webservices-wscreatexmlsecuritytoken).</span></span> <span data-ttu-id="376a3-150">無論何種方式，當安全性權杖可供用戶端使用時，它可能會使用包含 [**WS \_ XML \_ 權杖 \_ 訊息 \_ 安全性 \_**](/windows/desktop/api/WebServices/ns-webservices-ws_xml_token_message_security_binding)系結的安全性描述來呈現給服務。</span><span class="sxs-lookup"><span data-stu-id="376a3-150">Either way, once the security token is available to the client, it may be presented to the service using a security description containing a [**WS\_XML\_TOKEN\_MESSAGE\_SECURITY\_BINDING**](/windows/desktop/api/WebServices/ns-webservices-ws_xml_token_message_security_binding).</span></span> <span data-ttu-id="376a3-151">伺服器端：如果 STS 所發行的安全性權杖是 SAML 權杖，則伺服器可能會使用具有 [**WS \_ SAML \_ 訊息 \_ 安全性 \_**](/windows/desktop/api/WebServices/ns-webservices-ws_saml_message_security_binding)系結的安全性描述。</span><span class="sxs-lookup"><span data-stu-id="376a3-151">Server-side: If the security token issued by the STS is a SAML token, then the server may use a security description with a [**WS\_SAML\_MESSAGE\_SECURITY\_BINDING**](/windows/desktop/api/WebServices/ns-webservices-ws_saml_message_security_binding).</span></span>
        > [!Note]  
        > <span data-ttu-id="376a3-152">Windows 7 和 Windows Server 2008 R2： WWSAPI 只支援[輕量 Web 服務安全性設定檔 (LWSSP) ](/openspecs/windows_protocols/ms-lwssp/376af2f8-f4fe-4577-bfd5-370ac12cac2e)所定義的[ws-trust](http://specs.xmlsoap.org/ws/2005/02/trust/WS-Trust.pdf)和[ws-SecureConversation](http://specs.xmlsoap.org/ws/2005/02/sc/WS-SecureConversation.pdf) 。</span><span class="sxs-lookup"><span data-stu-id="376a3-152">Windows 7 and Windows Server 2008 R2: WWSAPI only supports [Ws-Trust](http://specs.xmlsoap.org/ws/2005/02/trust/WS-Trust.pdf) and [Ws-SecureConversation](http://specs.xmlsoap.org/ws/2005/02/sc/WS-SecureConversation.pdf) as defined by [Lightweight Web Services Security Profile (LWSSP)](/openspecs/windows_protocols/ms-lwssp/376af2f8-f4fe-4577-bfd5-370ac12cac2e).</span></span> <span data-ttu-id="376a3-153">如需有關 Microsoft 執行的詳細資訊，請參閱 LWSSP 的 [訊息語法](/openspecs/windows_protocols/ms-lwssp/d4f0f509-e14a-47b5-81e8-ade06a51d1ed) 一節。</span><span class="sxs-lookup"><span data-stu-id="376a3-153">For details regarding Microsoft's implementation please see the [MESSAGE Syntax](/openspecs/windows_protocols/ms-lwssp/d4f0f509-e14a-47b5-81e8-ade06a51d1ed) section of LWSSP.</span></span>

         
-   <span data-ttu-id="376a3-154">最後一個要考慮的選項是使用驗證系結，而不使用保護系結，例如 [**WS \_ SSL \_ 傳輸 \_ 安全性 \_**](/windows/desktop/api/WebServices/ns-webservices-ws_ssl_transport_security_binding)系結。</span><span class="sxs-lookup"><span data-stu-id="376a3-154">The final option to consider is using authentication bindings without using a protection binding such as [**WS\_SSL\_TRANSPORT\_SECURITY\_BINDING**](/windows/desktop/api/WebServices/ns-webservices-ws_ssl_transport_security_binding).</span></span> <span data-ttu-id="376a3-155">這會導致以純文字方式傳輸認證，而且可能會影響安全性。</span><span class="sxs-lookup"><span data-stu-id="376a3-155">This will result in the credentials being transmitted in clear text and can have security implications.</span></span> <span data-ttu-id="376a3-156">應謹慎地評估使用此選項，以確保不會產生任何弱點。</span><span class="sxs-lookup"><span data-stu-id="376a3-156">The use of this option should be carefully evaluated to ensure that there are no vulnerabilities as a result.</span></span> <span data-ttu-id="376a3-157">有可能使用的範例是透過安全的私人網路，在後端伺服器之間交換訊息。</span><span class="sxs-lookup"><span data-stu-id="376a3-157">An example of a potential use is exchanging messages between back-end servers over a secure private network.</span></span> <span data-ttu-id="376a3-158">下列設定支援此選項。</span><span class="sxs-lookup"><span data-stu-id="376a3-158">The following configurations support this option.</span></span>

    -   <span data-ttu-id="376a3-159">[**WS \_HTTP \_ 標頭 \_ 驗證 \_ 安全性 \_**](/windows/desktop/api/WebServices/ns-webservices-ws_http_header_auth_security_binding) 系結在所有設定中都支援此選項。</span><span class="sxs-lookup"><span data-stu-id="376a3-159">[**WS\_HTTP\_HEADER\_AUTH\_SECURITY\_BINDING**](/windows/desktop/api/WebServices/ns-webservices-ws_http_header_auth_security_binding) supports this option in all configurations.</span></span>
    -   <span data-ttu-id="376a3-160">[**WS \_使用 HTTP 做為傳輸時，使用者名稱 \_ 訊息 \_ 安全性 \_**](/windows/desktop/api/WebServices/ns-webservices-ws_username_message_security_binding) 系結可在伺服器上支援這個選項。</span><span class="sxs-lookup"><span data-stu-id="376a3-160">[**WS\_USERNAME\_MESSAGE\_SECURITY\_BINDING**](/windows/desktop/api/WebServices/ns-webservices-ws_username_message_security_binding) supports this option on the server when using HTTP as transport.</span></span>
    -   <span data-ttu-id="376a3-161">[**WS \_當使用 HTTP 做為傳輸時，KERBEROS \_ APREQ \_ 訊息 \_ 安全性 \_**](/windows/desktop/api/WebServices/ns-webservices-ws_kerberos_apreq_message_security_binding) 系結支援伺服器上的這個選項。</span><span class="sxs-lookup"><span data-stu-id="376a3-161">[**WS\_KERBEROS\_APREQ\_MESSAGE\_SECURITY\_BINDING**](/windows/desktop/api/WebServices/ns-webservices-ws_kerberos_apreq_message_security_binding) supports this option on the server when using HTTP as transport.</span></span>
    -   <span data-ttu-id="376a3-162">[**WS \_使用 HTTP 做為傳輸時，安全性 \_ 內容 \_ 訊息 \_ 安全性 \_**](/windows/desktop/api/WebServices/ns-webservices-ws_security_context_message_security_binding) 系結可在伺服器上支援這個選項。</span><span class="sxs-lookup"><span data-stu-id="376a3-162">[**WS\_SECURITY\_CONTEXT\_MESSAGE\_SECURITY\_BINDING**](/windows/desktop/api/WebServices/ns-webservices-ws_security_context_message_security_binding) supports this option on the server when using HTTP as transport.</span></span>
    -   <span data-ttu-id="376a3-163">[**WS \_使用 HTTP 做為傳輸時，SAML \_ 訊息 \_ 安全性 \_**](/windows/desktop/api/WebServices/ns-webservices-ws_saml_message_security_binding) 系結可在伺服器上支援這個選項。</span><span class="sxs-lookup"><span data-stu-id="376a3-163">[**WS\_SAML\_MESSAGE\_SECURITY\_BINDING**](/windows/desktop/api/WebServices/ns-webservices-ws_saml_message_security_binding) supports this option on the server when using HTTP as transport.</span></span>

    <span data-ttu-id="376a3-164">啟用此選項需要明確地將 [**ws \_ 保護 \_ 等級**](/windows/desktop/api/WebServices/ne-webservices-ws_protection_level) 設定為 **ws \_ 保護 \_ 層級 \_ 正負號 \_ 和 \_ 加密** 以外的值。</span><span class="sxs-lookup"><span data-stu-id="376a3-164">Enabling this option requires explicitly setting the [**WS\_PROTECTION\_LEVEL**](/windows/desktop/api/WebServices/ne-webservices-ws_protection_level) to a value other than **WS\_PROTECTION\_LEVEL\_SIGN\_AND\_ENCRYPT**.</span></span>

## <a name="channels-and-security"></a><span data-ttu-id="376a3-165">通道和安全性</span><span class="sxs-lookup"><span data-stu-id="376a3-165">Channels and Security</span></span>

<span data-ttu-id="376a3-166">如先前所述，安全性的範圍是通道。</span><span class="sxs-lookup"><span data-stu-id="376a3-166">As noted above, security is scoped to channels.</span></span> <span data-ttu-id="376a3-167">此外，通道作業會在所有安全性系結間一致地對應到安全性步驟。</span><span class="sxs-lookup"><span data-stu-id="376a3-167">Moreover, channel operations map to security steps consistently across all security bindings.</span></span>

-   <span data-ttu-id="376a3-168">通道建立：驗證安全性描述中指定的一組安全性系結，之後仍會為通道保持固定。</span><span class="sxs-lookup"><span data-stu-id="376a3-168">Channel create: The set of security bindings specified in the security description is validated and remains fixed for the channel thereafter.</span></span> <span data-ttu-id="376a3-169">通道堆疊的形狀，包括用於以 WS-Trust 為基礎之協商的任何側邊通道，也會加以決定。</span><span class="sxs-lookup"><span data-stu-id="376a3-169">The shape of the channel stack, including any side-channels to be used for WS-Trust based negotiations, is also determined.</span></span>
-   <span data-ttu-id="376a3-170">通道開啟：系統會載入安全性系結中提供的任何認證，並建立安全性會話。</span><span class="sxs-lookup"><span data-stu-id="376a3-170">Channel open: Any credentials that are supplied as part of security bindings are loaded, and security sessions are established.</span></span> <span data-ttu-id="376a3-171">一般而言，開啟的通道會包含「即時」安全性狀態。</span><span class="sxs-lookup"><span data-stu-id="376a3-171">In general, an open channel contains 'live' security state.</span></span> <span data-ttu-id="376a3-172">開啟用戶端通道也會指定伺服器的端點位址，以供執行時間執行伺服器驗證。</span><span class="sxs-lookup"><span data-stu-id="376a3-172">Opening a client channel also specifies the server's endpoint address against which server authentication will be done by the runtime.</span></span>
-   <span data-ttu-id="376a3-173">在通道開啟和關閉之間：可在此階段安全地傳送和接收訊息。</span><span class="sxs-lookup"><span data-stu-id="376a3-173">Between channel open and close: Messages can be securely sent and received during this phase.</span></span>
-   <span data-ttu-id="376a3-174">訊息傳送：系統會視需要取得或更新安全性內容權杖，並根據安全性描述將安全性套用到每個傳輸的訊息。</span><span class="sxs-lookup"><span data-stu-id="376a3-174">Message send: Security context tokens are obtained or renewed as needed and security is applied to each transmitted message according to the security description.</span></span> <span data-ttu-id="376a3-175">套用安全性時所發生的錯誤會以傳送錯誤的形式傳回給應用程式。</span><span class="sxs-lookup"><span data-stu-id="376a3-175">Errors that are encountered when applying security are returned to the application as send errors.</span></span>
-   <span data-ttu-id="376a3-176">訊息接收：根據安全性描述，在每個接收的訊息上驗證安全性。</span><span class="sxs-lookup"><span data-stu-id="376a3-176">Message receive: Security is verified on each received message according to the security description.</span></span> <span data-ttu-id="376a3-177">任何訊息安全性驗證錯誤都會以接收錯誤的形式傳回給應用程式。</span><span class="sxs-lookup"><span data-stu-id="376a3-177">Any message security verification errors are returned to the application as receive errors.</span></span> <span data-ttu-id="376a3-178">這些每個訊息的錯誤不會影響通道狀態或後續的接收。</span><span class="sxs-lookup"><span data-stu-id="376a3-178">These per-message errors do not affect the channel state or subsequent receives.</span></span> <span data-ttu-id="376a3-179">應用程式可能會捨棄失敗的接收，並重新啟動另一個訊息的接收。</span><span class="sxs-lookup"><span data-stu-id="376a3-179">The application may discard a failed receive and restart a receive for another message.</span></span>
-   <span data-ttu-id="376a3-180">通道中止：通道可能會在任何時間中止，以中止通道上的所有 i/o。</span><span class="sxs-lookup"><span data-stu-id="376a3-180">Channel abort: The channel may be aborted at any time to halt all I/O on the channel.</span></span> <span data-ttu-id="376a3-181">在中止時，通道將會進入錯誤狀態，而且不會允許任何更多的傳送或接收。</span><span class="sxs-lookup"><span data-stu-id="376a3-181">On abort, the channel will go into a faulted state and will not allow any more sends or receives.</span></span> <span data-ttu-id="376a3-182">不過，通道可能仍會保留一些「即時」安全性狀態，因此需要關閉後續通道，才能完全處置所有狀態。</span><span class="sxs-lookup"><span data-stu-id="376a3-182">However, the channel may still retain some 'live' security state, so a subsequent channel close will be necessary to dispose all state cleanly.</span></span>
-   <span data-ttu-id="376a3-183">通道關閉：已處置在開啟時建立的安全性狀態，並將會話中斷。</span><span class="sxs-lookup"><span data-stu-id="376a3-183">Channel close: The security state created at open is disposed and sessions are torn down.</span></span> <span data-ttu-id="376a3-184">已取消安全性內容權杖。</span><span class="sxs-lookup"><span data-stu-id="376a3-184">Security context tokens are cancelled.</span></span> <span data-ttu-id="376a3-185">通道堆疊會保持不變，但不包含「即時」安全性狀態或已載入的認證。</span><span class="sxs-lookup"><span data-stu-id="376a3-185">The channel stack remains, but contains no 'live' security state or loaded credentials.</span></span>
-   <span data-ttu-id="376a3-186">通道可用：在建立時建立的通道堆疊以及所有安全性資源都會釋出。</span><span class="sxs-lookup"><span data-stu-id="376a3-186">Channel free: The channel stack built at create, together with all security resources, are freed.</span></span>

## <a name="security-apis"></a><span data-ttu-id="376a3-187">安全性 Api</span><span class="sxs-lookup"><span data-stu-id="376a3-187">Security APIs</span></span>

<span data-ttu-id="376a3-188">安全性的 API 檔分為下列主題。</span><span class="sxs-lookup"><span data-stu-id="376a3-188">The API documentation for security is grouped into the following topics.</span></span>

-   [<span data-ttu-id="376a3-189">安全性描述</span><span class="sxs-lookup"><span data-stu-id="376a3-189">Security Description</span></span>](security-description.md)
    -   [<span data-ttu-id="376a3-190">安全性通道設定</span><span class="sxs-lookup"><span data-stu-id="376a3-190">Security Channel Settings</span></span>](security-channel-settings.md)
    -   [<span data-ttu-id="376a3-191">安全性系結</span><span class="sxs-lookup"><span data-stu-id="376a3-191">Security Bindings</span></span>](security-bindings.md)
        -   [<span data-ttu-id="376a3-192">安全性認證</span><span class="sxs-lookup"><span data-stu-id="376a3-192">Security Credentials</span></span>](security-credentials.md)
        -   [<span data-ttu-id="376a3-193">安全性繫結設定</span><span class="sxs-lookup"><span data-stu-id="376a3-193">Security Binding Settings</span></span>](security-binding-settings.md)
-   [<span data-ttu-id="376a3-194">同盟</span><span class="sxs-lookup"><span data-stu-id="376a3-194">Federation</span></span>](federation.md)
-   [<span data-ttu-id="376a3-195">安全性內容</span><span class="sxs-lookup"><span data-stu-id="376a3-195">Security Context</span></span>](security-context.md)
-   [<span data-ttu-id="376a3-196">端點識別</span><span class="sxs-lookup"><span data-stu-id="376a3-196">Endpoint Identity</span></span>](endpoint-identity.md)
-   [<span data-ttu-id="376a3-197">安全性處理結果</span><span class="sxs-lookup"><span data-stu-id="376a3-197">Security Processing Results</span></span>](security-processing-results.md)

## <a name="security"></a><span data-ttu-id="376a3-198">安全性</span><span class="sxs-lookup"><span data-stu-id="376a3-198">Security</span></span>

<span data-ttu-id="376a3-199">使用 WWSAPI 安全性 API 時，應用程式會面臨許多安全性風險：</span><span class="sxs-lookup"><span data-stu-id="376a3-199">When using the WWSAPI Security API, applications face several security risks:</span></span>

<dl> <dt>

<span data-ttu-id="376a3-200"><span id="Accidental_misconfiguration"></span><span id="accidental_misconfiguration"></span><span id="ACCIDENTAL_MISCONFIGURATION"></span>意外設定錯誤</span><span class="sxs-lookup"><span data-stu-id="376a3-200"><span id="Accidental_misconfiguration"></span><span id="accidental_misconfiguration"></span><span id="ACCIDENTAL_MISCONFIGURATION"></span>Accidental misconfiguration</span></span>
</dt> <dd>

<span data-ttu-id="376a3-201">WWSAPI 支援一系列安全性相關的設定選項。</span><span class="sxs-lookup"><span data-stu-id="376a3-201">WWSAPI supports a range of security-related configuration options.</span></span> <span data-ttu-id="376a3-202">請參閱，例如 [**WS 安全性系結 \_ \_ \_ 屬性 \_ 識別碼**](/windows/desktop/api/WebServices/ne-webservices-ws_security_binding_property_id)。</span><span class="sxs-lookup"><span data-stu-id="376a3-202">See for example [**WS\_SECURITY\_BINDING\_PROPERTY\_ID**](/windows/desktop/api/WebServices/ne-webservices-ws_security_binding_property_id).</span></span> <span data-ttu-id="376a3-203">其中一些選項（例如 **WS 安全性系 \_ 結 \_ \_ 屬性 \_ 允許 \_ 匿名 \_ 用戶端** ）允許應用程式降低各種安全性系結所提供的預設安全性層級。</span><span class="sxs-lookup"><span data-stu-id="376a3-203">Some of these options, such as **WS\_SECURITY\_BINDING\_PROPERTY\_ALLOW\_ANONYMOUS\_CLIENTS** allow the application to lower the default level of security provided by the various Security Bindings.</span></span> <span data-ttu-id="376a3-204">您應該仔細評估使用這類選項，以確保沒有任何產生的攻擊媒介。</span><span class="sxs-lookup"><span data-stu-id="376a3-204">The use of such options should be carefully evaluated to ensure that there are no resulting attack vectors.</span></span>

<span data-ttu-id="376a3-205">此外，如先前所述，WWSAPI 可讓應用程式刻意停用完整保護訊息結算所需的特定步驟，例如即使傳輸安全性認證，也允許停用加密。</span><span class="sxs-lookup"><span data-stu-id="376a3-205">Additionally, as described above, WWSAPI allows an application to deliberately disable certain steps required to fully secure a message exchange, such as allowing to disable encryption even though security credentials are transmitted.</span></span> <span data-ttu-id="376a3-206">這允許啟用某些特定案例，而且不應該用於一般通訊。</span><span class="sxs-lookup"><span data-stu-id="376a3-206">This is allowed to enable certain specific scenarios and should not be used for general communication.</span></span> <span data-ttu-id="376a3-207">[**Ws-management \_ \_ 等級**](/windows/desktop/api/WebServices/ne-webservices-ws_protection_level)必須明確地減少以啟用此案例，而且應用程式不應該變更該值，除非絕對必要，因為這樣做會停用許多設計來確保安全設定的檢查。</span><span class="sxs-lookup"><span data-stu-id="376a3-207">The [**WS\_PROTECTION\_LEVEL**](/windows/desktop/api/WebServices/ne-webservices-ws_protection_level) must be specifically lowered to enable this scenarios, and applications should not change that value unless absolutely necessary, as doing so will disable many checks that are designed to ensure a secure configuration.</span></span>

</dd> <dt>

<span data-ttu-id="376a3-208"><span id="Storing_confidential_information_in_memory"></span><span id="storing_confidential_information_in_memory"></span><span id="STORING_CONFIDENTIAL_INFORMATION_IN_MEMORY"></span>將機密資訊儲存在記憶體中</span><span class="sxs-lookup"><span data-stu-id="376a3-208"><span id="Storing_confidential_information_in_memory"></span><span id="storing_confidential_information_in_memory"></span><span id="STORING_CONFIDENTIAL_INFORMATION_IN_MEMORY"></span>Storing confidential information in memory</span></span>
</dt> <dd>

<span data-ttu-id="376a3-209">儲存在記憶體中的機密資訊（例如密碼）很容易由具有特殊許可權的攻擊者（例如分頁檔）解壓縮。</span><span class="sxs-lookup"><span data-stu-id="376a3-209">Confidential information, such as passwords, that is stored in memory is vulnerable to being extracted by a privileged attacker by means of, for example, the page file.</span></span> <span data-ttu-id="376a3-210">WWSAPI 會複製所提供的認證，並將該複本加密，讓原始資料保持未受保護。</span><span class="sxs-lookup"><span data-stu-id="376a3-210">WWSAPI makes a copy of provided credentials and encrypts that copy, leaving the original data unprotected.</span></span> <span data-ttu-id="376a3-211">應用程式必須負責保護原始實例。</span><span class="sxs-lookup"><span data-stu-id="376a3-211">It is the application's responsibility to protect the original instance.</span></span> <span data-ttu-id="376a3-212">此外，加密的複本會在使用時短暫解密，開啟視窗將其解壓縮。</span><span class="sxs-lookup"><span data-stu-id="376a3-212">Additionally, the encrypted copy is briefly decrypted while being used, opening up a window to extract it.</span></span>

</dd> <dt>

<span data-ttu-id="376a3-213"><span id="Denial_of_service"></span><span id="denial_of_service"></span><span id="DENIAL_OF_SERVICE"></span>拒絕服務</span><span class="sxs-lookup"><span data-stu-id="376a3-213"><span id="Denial_of_service"></span><span id="denial_of_service"></span><span id="DENIAL_OF_SERVICE"></span>Denial of service</span></span>
</dt> <dd>

<span data-ttu-id="376a3-214">安全性處理可能會耗用大量資源。</span><span class="sxs-lookup"><span data-stu-id="376a3-214">Security processing can consume significant resources.</span></span> <span data-ttu-id="376a3-215">每個額外的安全性系結都會增加這些成本。</span><span class="sxs-lookup"><span data-stu-id="376a3-215">Every additional security binding increases those costs.</span></span> <span data-ttu-id="376a3-216">WWSAPI 會在發生安全性驗證失敗時立即中止安全性處理，但是在執行重要工作之前，可能不會進行某些檢查（例如授權決策）。</span><span class="sxs-lookup"><span data-stu-id="376a3-216">WWSAPI aborts security processing as soon as a security verification failure is encountered, but certain checks such as authorization decisions may not take place until after significant work has been performed.</span></span>

<span data-ttu-id="376a3-217">當訊息在伺服器上處理時，安全性狀態會儲存在訊息堆積上。</span><span class="sxs-lookup"><span data-stu-id="376a3-217">While a message is processed on the server, security state is stored on the message heap.</span></span> <span data-ttu-id="376a3-218">應用程式可以藉由透過 WS \_ MESSAGE \_ PROPERTY \_ 堆積屬性減少該堆積的大小，來限制安全性處理期間的記憶體耗用量 \_ 。</span><span class="sxs-lookup"><span data-stu-id="376a3-218">The application can limit the memory consumption during security processing by reducing the size of that heap through WS\_MESSAGE\_PROPERTY\_HEAP\_PROPERTIES.</span></span> <span data-ttu-id="376a3-219">此外，某些安全性系結（例如 WS \_ security \_ CONTEXT \_ MESSAGE \_ security \_ BINDING）可能會導致伺服器代表用戶端配置資源。</span><span class="sxs-lookup"><span data-stu-id="376a3-219">Additionally, certain security bindings such as the WS\_SECURITY\_CONTEXT\_MESSAGE\_SECURITY\_BINDING can cause the server to allocate resources on behalf of the client.</span></span> <span data-ttu-id="376a3-220">您可以透過下列 [**WS 安全性系結 \_ \_ \_ 屬性 \_ 識別碼**](/windows/desktop/api/WebServices/ne-webservices-ws_security_binding_property_id) 值來設定這些資源的限制：</span><span class="sxs-lookup"><span data-stu-id="376a3-220">The limits for those resources can be configured by way of the following [**WS\_SECURITY\_BINDING\_PROPERTY\_ID**](/windows/desktop/api/WebServices/ne-webservices-ws_security_binding_property_id) values:</span></span>

-   <span data-ttu-id="376a3-221">WS \_ 安全性系結 \_ \_ 屬性 \_ 安全性 \_ 內容 \_ 最大 \_ 暫止內容 \_</span><span class="sxs-lookup"><span data-stu-id="376a3-221">WS\_SECURITY\_BINDING\_PROPERTY\_SECURITY\_CONTEXT\_MAX\_PENDING\_CONTEXTS</span></span>
-   <span data-ttu-id="376a3-222">WS \_ 安全性系結 \_ \_ 屬性 \_ 安全性 \_ 內容 \_ 最大 \_ \_ 作用中內容</span><span class="sxs-lookup"><span data-stu-id="376a3-222">WS\_SECURITY\_BINDING\_PROPERTY\_SECURITY\_CONTEXT\_MAX\_ACTIVE\_CONTEXTS</span></span>
-   <span data-ttu-id="376a3-223">WS \_ 安全性系結 \_ \_ 屬性 \_ 安全性 \_ 內容 \_ 更新 \_ 間隔</span><span class="sxs-lookup"><span data-stu-id="376a3-223">WS\_SECURITY\_BINDING\_PROPERTY\_SECURITY\_CONTEXT\_RENEWAL\_INTERVAL</span></span>
-   <span data-ttu-id="376a3-224">WS \_ 安全性系結 \_ \_ 屬性 \_ 安全性 \_ 內容 \_ 變換 \_ 間隔</span><span class="sxs-lookup"><span data-stu-id="376a3-224">WS\_SECURITY\_BINDING\_PROPERTY\_SECURITY\_CONTEXT\_ROLLOVER\_INTERVAL</span></span>

<span data-ttu-id="376a3-225">將這些限制設定為低值，可減少記憶體耗用量上限，但會導致在達到配額時拒絕合法的用戶端。</span><span class="sxs-lookup"><span data-stu-id="376a3-225">Setting those limits to low values reduces the maximum memory consumption but can lead to legitimate clients being rejected when the quota is reached.</span></span>

</dd> </dl>

 

 