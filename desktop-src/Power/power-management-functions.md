---
description: 下列函式會搭配電源管理使用。
ms.assetid: eae96a9e-ced2-4e13-b250-33c5acbbae48
title: 電源管理功能
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 3c9ad544c7483cdda6be015da2314c5463fd0eca
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/07/2021
ms.locfileid: "103944233"
---
# <a name="power-management-functions"></a>電源管理功能

下列函式會搭配電源管理使用。

| 函式                                                                                           | 描述                                                                                                                                                                                                                             |
|----------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [**CallNtPowerInformation**](/windows/desktop/api/Powerbase/nf-powerbase-callntpowerinformation)                                           | 設定或抓取電源資訊。                                                                                                                                                                                                    |
| [**DevicePowerClose**](/windows/desktop/api/PowrProf/nf-powrprof-devicepowerclose)                                                       | 釋出裝置清單中的所有節點，並終結裝置清單。                                                                                                                                                                        |
| [**DevicePowerEnumDevices**](/windows/desktop/api/PowrProf/nf-powrprof-devicepowerenumdevices)                                           | 列舉系統上符合指定準則的裝置。                                                                                                                                                                      |
| [**DevicePowerOpen**](/windows/desktop/api/PowrProf/nf-powrprof-devicepoweropen)                                                         | 藉由查詢所有裝置來初始化裝置清單。                                                                                                                                                                                  |
| [**DevicePowerSetDeviceState**](/windows/desktop/api/PowrProf/nf-powrprof-devicepowersetdevicestate)                                     | 修改指定之裝置上的指定資料。                                                                                                                                                                                    |
| [**EFFECTIVE_POWER_MODE_CALLBACK**](/windows/desktop/api/powersetting/nf-powersetting-effective_power_mode_callback)                                     | 有效電源模式回呼的函式類別。                                                                                                                                                                                    |
| [**GetActivePwrScheme**](/windows/desktop/api/PowrProf/nf-powrprof-getactivepwrscheme)                                         | 抓取現用電源配置的索引。                                                                                                                                                                                     |
| [**GetCurrentPowerPolicies**](/windows/desktop/api/PowrProf/nf-powrprof-getcurrentpowerpolicies)                                         | 抓取目前的系統電源原則設定。                                                                                                                                                                                     |
| [**GetDevicePowerState**](/windows/desktop/api/Winbase/nf-winbase-getdevicepowerstate)                                                 | 抓取指定裝置目前的電源狀態。                                                                                                                                                                              |
| [**GetPwrCapabilities**](/windows/desktop/api/Powerbase/nf-powerbase-getpwrcapabilities)                                                   | 捕獲系統電源功能的相關資訊。                                                                                                                                                                              |
| [**GetSystemPowerStatus**](/windows/desktop/api/Winbase/nf-winbase-getsystempowerstatus)                                               | 捕獲系統的電源狀態。                                                                                                                                                                                               |
| [**IsSystemResumeAutomatic**](/windows/desktop/api/Winbase/nf-winbase-issystemresumeautomatic)                                         | 指出電腦的目前狀態。                                                                                                                                                                                            |
| [**PowerCanRestoreIndividualDefaultPowerScheme**](/windows/desktop/api/PowrProf/nf-powrprof-powercanrestoreindividualdefaultpowerscheme) | 判斷目前的使用者是否有權存取指定的電源配置的資料，以便在必要時加以還原。                                                                                                         |
| [**PowerClearRequest**](/windows/desktop/api/winbase/nf-winbase-powerclearrequest)                                                     | 針對 power request 物件的指定類型遞減電源要求的計數。                                                                                                                                                |
| [**PowerCreatePossibleSetting**](/windows/desktop/api/PowrProf/nf-powrprof-powercreatepossiblesetting)                                   | 為指定的電源設定建立可能的設定值。                                                                                                                                                                         |
| [**PowerCreateRequest**](/windows/desktop/api/winbase/nf-winbase-powercreaterequest)                                                   | 建立 power request 物件。                                                                                                                                                                                                         |
| [**PowerCreateSetting**](/windows/desktop/api/PowrProf/nf-powrprof-powercreatesetting)                                                   | 建立指定之電源設定的設定值。                                                                                                                                                                                  |
| [**PowerDeleteScheme**](/windows/desktop/api/PowrProf/nf-powrprof-powerdeletescheme)                                                     | 從資料庫刪除指定的配置。                                                                                                                                                                                           |
| [**PowerDeterminePlatformRole**](/windows/desktop/api/PowrProf/nf-powrprof-powerdetermineplatformrole)                                   | 決定電腦角色。                                                                                                                                                                                                           |
| [**PowerDuplicateScheme**](/windows/desktop/api/PowrProf/nf-powrprof-powerduplicatescheme)                                               | 複製現有的電源配置。                                                                                                                                                                                                    |
| [**PowerEnumerate**](/windows/desktop/api/PowrProf/nf-powrprof-powerenumerate)                                                           | 列舉電源配置中指定的元素。                                                                                                                                                                                    |
| [**PowerGetActiveScheme**](/windows/desktop/api/Powersetting/nf-powersetting-powergetactivescheme)                                               | 抓取主動式電源配置。                                                                                                                                                                                                      |
| [**PowerImportPowerScheme**](/windows/desktop/api/PowrProf/nf-powrprof-powerimportpowerscheme)                                           | 從檔案匯入電源配置。                                                                                                                                                                                                     |
| [**PowerIsSettingRangeDefined**](/windows/desktop/api/Powrprof/nf-powrprof-powerissettingrangedefined)                                   | 查詢指定的電源設定是否代表可能值的範圍。                                                                                                                                                      |
| [**PowerReadACDefaultIndex**](/windows/desktop/api/PowrProf/nf-powrprof-powerreadacdefaultindex)                                         | 抓取指定電源設定的預設 AC 索引。                                                                                                                                                                          |
| [**PowerReadACValue**](/windows/desktop/api/Powersetting/nf-powersetting-powerreadacvalue)                                                       | 抓取指定電源設定的 AC 電源值。                                                                                                                                                                           |
| [**PowerReadACValueIndex**](/windows/desktop/api/PowrProf/nf-powrprof-powerreadacvalueindex)                                             | 抓取指定電源設定的 AC 索引。                                                                                                                                                                                  |
| [**PowerReadDCDefaultIndex**](/windows/desktop/api/PowrProf/nf-powrprof-powerreaddcdefaultindex)                                         | 抓取指定之電源設定的預設 DC 索引。                                                                                                                                                                          |
| [**PowerReadDCValue**](/windows/desktop/api/Powersetting/nf-powersetting-powerreaddcvalue)                                                       | 抓取指定電源設定的 DC 電源值。                                                                                                                                                                           |
| [**PowerReadDCValueIndex**](/windows/desktop/api/PowrProf/nf-powrprof-powerreaddcvalueindex)                                             | 抓取指定之電源設定的 DC 值索引。                                                                                                                                                                            |
| [**PowerReadDescription**](/windows/desktop/api/PowrProf/nf-powrprof-powerreaddescription)                                               | 抓取指定的電源設定、子群組或配置的描述。                                                                                                                                                         |
| [**PowerReadFriendlyName**](/windows/desktop/api/PowrProf/nf-powrprof-powerreadfriendlyname)                                             | 抓取指定的電源設定、子群組或配置的易記名稱。                                                                                                                                                       |
| [**PowerReadIconResourceSpecifier**](/windows/desktop/api/PowrProf/nf-powrprof-powerreadiconresourcespecifier)                           | 抓取指定的電源設定、子群組或配置的圖示資源。                                                                                                                                                       |
| [**PowerReadPossibleDescription**](/windows/desktop/api/PowrProf/nf-powrprof-powerreadpossibledescription)                               | 抓取電源設定值其中一個可能選項的描述。                                                                                                                                                     |
| [**PowerReadPossibleFriendlyName**](/windows/desktop/api/PowrProf/nf-powrprof-powerreadpossiblefriendlyname)                             | 抓取電源設定值其中一個可能選項的易記名稱。                                                                                                                                                   |
| [**PowerReadPossibleValue**](/windows/desktop/api/PowrProf/nf-powrprof-powerreadpossiblevalue)                                           | 抓取電源設定可能值的值。                                                                                                                                                                            |
| [**PowerReadSettingAttributes**](/windows/desktop/api/PowrProf/nf-powrprof-powerreadsettingattributes)                                   | 傳回指定之電源設定的目前屬性。                                                                                                                                                                           |
| [**PowerReadValueIncrement**](/windows/desktop/api/PowrProf/nf-powrprof-powerreadvalueincrement)                                         | 抓取電源設定的最小值與最大值之間的有效值增量。                                                                                                                                                |
| [**PowerReadValueMax**](/windows/desktop/api/PowrProf/nf-powrprof-powerreadvaluemax)                                                     | 抓取指定之電源設定的最大值。                                                                                                                                                                            |
| [**PowerReadValueMin**](/windows/desktop/api/PowrProf/nf-powrprof-powerreadvaluemin)                                                     | 抓取指定之電源設定的最小值。                                                                                                                                                                            |
| [**PowerReadValueUnitsSpecifier**](/windows/desktop/api/PowrProf/nf-powrprof-powerreadvalueunitsspecifier)                               | 讀取用來描述支援某個值範圍之電源設定單位的字串。                                                                                                                                         |
| [**PowerRegisterForEffectivePowerModeNotifications**](/windows/desktop/api/powersetting/nf-powersetting-powerregisterforeffectivepowermodenotifications)                               | 註冊回呼以接收有效的電源模式變更通知。                                                                                                                                         |
| [**PowerRegisterSuspendResumeNotification**](/windows/desktop/api/Powerbase/nf-powerbase-powerregistersuspendresumenotification)           | 註冊在系統暫停或繼續時接收通知。                                                                                                                                                              |
| [**PowerRemovePowerSetting**](/windows/desktop/api/PowrProf/nf-powrprof-powerremovepowersetting)                                         | 刪除指定的電源設定。                                                                                                                                                                                                    |
| [**PowerReplaceDefaultPowerSchemes**](/windows/desktop/api/PowrProf/nf-powrprof-powerreplacedefaultpowerschemes)                         | 以目前使用者的電源配置取代預設使用者的電源配置。                                                                                                                                                  |
| [**PowerRestoreDefaultPowerSchemes**](/windows/desktop/api/PowrProf/nf-powrprof-powerrestoredefaultpowerschemes)                         | 將目前使用者的電源配置取代為預設使用者的電源配置。                                                                                                                                                         |
| [**PowerRestoreIndividualDefaultPowerScheme**](/windows/desktop/api/PowrProf/nf-powrprof-powerrestoreindividualdefaultpowerscheme)       | 將目前使用者的特定電源配置取代為預設使用者的一種。                                                                                                                                                   |
| [**PowerSetActiveScheme**](/windows/desktop/api/Powersetting/nf-powersetting-powersetactivescheme)                                               | 設定目前使用者的主動式電源配置。                                                                                                                                                                                      |
| [**PowerSetRequest**](/windows/desktop/api/winbase/nf-winbase-powersetrequest)                                                         | 為 power request 物件的指定型別遞增電源要求的計數。                                                                                                                                                |
| [**PowerSettingAccessCheck**](/windows/desktop/api/PowrProf/nf-powrprof-powersettingaccesscheck)                                         | 針對指定的電源設定，查詢群組原則覆寫。                                                                                                                                                                       |
| [**PowerSettingAccessCheckEx**](/windows/desktop/api/Powrprof/nf-powrprof-powersettingaccesscheckex)                                     | 查詢指定電源設定的群組原則覆寫，並指定設定所要求的存取權。                                                                                                                    |
| [**PowerSettingRegisterNotification**](/windows/desktop/api/Powersetting/nf-powersetting-powersettingregisternotification)                       | 註冊以在電源設定變更時接收通知。                                                                                                                                                                         |
| [**PowerSettingUnregisterNotification**](/windows/desktop/api/Powersetting/nf-powersetting-powersettingunregisternotification)                   | 取消註冊，以在電源設定變更時接收通知。                                                                                                                                                            |
| [**PowerUnregisterFromEffectivePowerModeNotifications**](/windows/desktop/api/Powersetting/nf-powersetting-powersettingunregisternotification)                   | 從有效的電源模式變更通知取消註冊。                                                                                                                                                             |
| [**PowerUnregisterSuspendResumeNotification**](/windows/desktop/api/Powerbase/nf-powerbase-powerunregistersuspendresumenotification)       | 取消註冊，以在系統暫停或繼續時接收通知。                                                                                                                                                 |
| [**PowerWriteACDefaultIndex**](/windows/desktop/api/PowrProf/nf-powrprof-powerwriteacdefaultindex)                                       | 設定指定之電源設定的預設 AC 索引。                                                                                                                                                                               |
| [**PowerWriteACValueIndex**](/windows/desktop/api/Powersetting/nf-powersetting-powerwriteacvalueindex)                                           | 設定指定之電源設定的 AC 值索引。                                                                                                                                                                                 |
| [**PowerWriteDCDefaultIndex**](/windows/desktop/api/PowrProf/nf-powrprof-powerwritedcdefaultindex)                                       | 設定指定之電源設定的預設 DC 索引。                                                                                                                                                                               |
| [**PowerWriteDCValueIndex**](/windows/desktop/api/Powersetting/nf-powersetting-powerwritedcvalueindex)                                           | 設定指定之電源設定的 DC 索引。                                                                                                                                                                                       |
| [**PowerWriteDescription**](/windows/desktop/api/PowrProf/nf-powrprof-powerwritedescription)                                             | 設定指定之電源設定、子群組或配置的描述。                                                                                                                                                              |
| [**PowerWriteFriendlyName**](/windows/desktop/api/PowrProf/nf-powrprof-powerwritefriendlyname)                                           | 設定指定之電源設定、子群組或配置的易記名稱。                                                                                                                                                            |
| [**PowerWriteIconResourceSpecifier**](/windows/desktop/api/PowrProf/nf-powrprof-powerwriteiconresourcespecifier)                         | 設定指定之電源設定、子群組或配置的圖示資源。                                                                                                                                                            |
| [**PowerWritePossibleDescription**](/windows/desktop/api/PowrProf/nf-powrprof-powerwritepossibledescription)                             | 設定其中一個電源設定值可能選項的描述。                                                                                                                                                          |
| [**PowerWritePossibleFriendlyName**](/windows/desktop/api/PowrProf/nf-powrprof-powerwritepossiblefriendlyname)                           | 設定指定電源設定之可能設定的易記名稱。                                                                                                                                                           |
| [**PowerWritePossibleValue**](/windows/desktop/api/PowrProf/nf-powrprof-powerwritepossiblevalue)                                         | 設定電源設定可能值的值。                                                                                                                                                                                 |
| [**PowerWriteSettingAttributes**](/windows/desktop/api/PowrProf/nf-powrprof-powerwritesettingattributes)                                 | 設定電源按鍵的電源屬性。                                                                                                                                                                                               |
| [**PowerWriteValueIncrement**](/windows/desktop/api/PowrProf/nf-powrprof-powerwritevalueincrement)                                       | 在電源設定的最小值和最大值之間設定有效值的增量。                                                                                                                                                     |
| [**PowerWriteValueMax**](/windows/desktop/api/PowrProf/nf-powrprof-powerwritevaluemax)                                                   | 設定指定之電源設定的最大值。                                                                                                                                                                                 |
| [**PowerWriteValueMin**](/windows/desktop/api/PowrProf/nf-powrprof-powerwritevaluemin)                                                   | 設定指定之電源設定的最小值。                                                                                                                                                                                 |
| [**PowerWriteValueUnitsSpecifier**](/windows/desktop/api/PowrProf/nf-powrprof-powerwritevalueunitsspecifier)                             | 寫入用來描述支援某個值範圍之電源設定單位的字串。                                                                                                                                        |
| [**RegisterPowerSettingNotification**](/windows/desktop/api/WinUser/nf-winuser-registerpowersettingnotification)                       | 註冊應用程式以接收特定電源設定事件的電源設定通知。                                                                                                                                  |
| [**RegisterSuspendResumeNotification**](/windows/desktop/api/Winuser/nf-winuser-registersuspendresumenotification)                     | 註冊在系統暫停或繼續時接收通知。 類似于 [**PowerRegisterSuspendResumeNotification**](/windows/desktop/api/Powerbase/nf-powerbase-powerregistersuspendresumenotification)，但在使用者模式下運作，而且可以採用視窗控制碼。 |
| [**SetSuspendState**](/windows/desktop/api/PowrProf/nf-powrprof-setsuspendstate)                                                         | 設定系統暫止狀態。                                                                                                                                                                                                          |
| [**SetThreadExecutionState**](/windows/desktop/api/Winbase/nf-winbase-setthreadexecutionstate)                                         | 讓代理程式更新系統它正在使用中。                                                                                                                                                                            |
| [**UnregisterPowerSettingNotification**](/windows/desktop/api/WinUser/nf-winuser-unregisterpowersettingnotification)                   | 取消註冊電源設定通知。                                                                                                                                                                                             |
| [**UnregisterSuspendResumeNotification**](/windows/desktop/api/Winuser/nf-winuser-unregistersuspendresumenotification)                 | 取消註冊，以在系統暫停或繼續時接收通知。 類似于 [**PowerUnregisterSuspendResumeNotification**](/windows/desktop/api/Powerbase/nf-powerbase-powerunregistersuspendresumenotification) ，但在使用者模式下運作。              |



 

## <a name="power-management-functions-windows-server-2003-and-earlier"></a>電源管理功能： Windows Server 2003 及更早版本

Windows Server 2008、Windows Vista 和更新版本的 Windows 都支援下列功能，以與舊版 Windows 相容。 針對 Windows Server 2008、Windows Vista 和更新版本所撰寫的應用程式，應該使用此表格所列的替代方案。



| Windows Server 2003 及更早版本                            | Description                                                                           | Windows Server 2008 和 Windows Vista                                                                                                                                           |
|------------------------------------------------------------|---------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [**CanUserWritePwrScheme**](/windows/desktop/api/PowrProf/nf-powrprof-canuserwritepwrscheme)     | 判斷目前的使用者是否有足夠的許可權來撰寫電源配置。 | [**PowerSettingAccessCheck**](/windows/desktop/api/PowrProf/nf-powrprof-powersettingaccesscheck)                                                                                                                      |
| [**DeletePwrScheme**](/windows/desktop/api/PowrProf/nf-powrprof-deletepwrscheme)                 | 刪除指定的電源配置。                                                   | [**PowerDeleteScheme**](/windows/desktop/api/PowrProf/nf-powrprof-powerdeletescheme)                                                                                                                                  |
| [**EnumPwrSchemes**](/windows/desktop/api/PowrProf/nf-powrprof-enumpwrschemes)                   | 列舉所有的電源配置。                                                         | [**PowerEnumerate**](/windows/desktop/api/PowrProf/nf-powrprof-powerenumerate)                                                                                                                                        |
| [**GetActivePwrScheme**](/windows/desktop/api/PowrProf/nf-powrprof-getactivepwrscheme)           | 抓取現用電源配置的索引。                                       | [**PowerGetActiveScheme**](/windows/desktop/api/Powersetting/nf-powersetting-powergetactivescheme)                                                                                                                            |
| [**GetPwrDiskSpindownRange**](/windows/desktop/api/PowrProf/nf-powrprof-getpwrdiskspindownrange) | 抓取磁片 spindown 範圍。                                                    | 透過 GUID \_ 磁片 \_ 子群組電源設定子群組來控制。 使用 [**PowerEnumerate**](/windows/desktop/api/PowrProf/nf-powrprof-powerenumerate) 函式來列舉個別設定。                |
| [**IsPwrHibernateAllowed**](/windows/desktop/api/PowrProf/nf-powrprof-ispwrhibernateallowed)     | 判斷電腦是否支援休眠。                                 | [**GetPwrCapabilities**](/windows/desktop/api/Powerbase/nf-powerbase-getpwrcapabilities)                                                                                                                                |
| [**IsPwrShutdownAllowed**](/windows/desktop/api/PowrProf/nf-powrprof-ispwrshutdownallowed)       | 判斷電腦是否支援軟關閉電源狀態。                    | 不適用。 從 Windows Vista 開始，電腦必須支援軟關閉。                                                                                                   |
| [**IsPwrSuspendAllowed**](/windows/desktop/api/PowrProf/nf-powrprof-ispwrsuspendallowed)         | 判斷電腦是否支援睡眠狀態。                            | [**GetPwrCapabilities**](/windows/desktop/api/Powerbase/nf-powerbase-getpwrcapabilities)                                                                                                                                |
| [**ReadGlobalPwrPolicy**](/windows/desktop/api/PowrProf/nf-powrprof-readglobalpwrpolicy)         | 抓取目前的全域電源原則設定。                                   | Power read 函式                                                                                                                                                            |
| [**ReadProcessorPwrScheme**](/windows/desktop/api/PowrProf/nf-powrprof-readprocessorpwrscheme)   | 抓取指定電源配置的處理器電源原則設定。         | 透過 [GUID \_ 處理器 \_ 設定] \_ 子群組電源設定子群組來控制。 使用 [**PowerEnumerate**](/windows/desktop/api/PowrProf/nf-powrprof-powerenumerate) 函式來列舉個別設定。 |
| [**ReadPwrScheme**](/windows/desktop/api/PowrProf/nf-powrprof-readpwrscheme)                     | 抓取指定電源配置的唯一電源原則設定。    | Power read 函式                                                                                                                                                            |
| [**RequestWakeupLatency**](/windows/desktop/api/WinBase/nf-winbase-requestwakeuplatency)       | 指定電腦應進入工作狀態的速度大約快。            | 不適用。                                                                                                                                                                 |
| [**SetActivePwrScheme**](/windows/desktop/api/PowrProf/nf-powrprof-setactivepwrscheme)           | 設定使用中的電源配置。                                                         | [**PowerSetActiveScheme**](/windows/desktop/api/Powersetting/nf-powersetting-powersetactivescheme)                                                                                                                            |
| [**SetSystemPowerState**](/windows/desktop/api/WinBase/nf-winbase-setsystempowerstate)         | 藉由關閉電源來暫停系統。                                           | [**SetSuspendState**](/windows/desktop/api/PowrProf/nf-powrprof-setsuspendstate)                                                                                                                                      |
| [**WriteGlobalPwrPolicy**](/windows/desktop/api/PowrProf/nf-powrprof-writeglobalpwrpolicy)       | 寫入全域電源原則設定。                                                  | 電源寫入功能                                                                                                                                                           |
| [**WriteProcessorPwrScheme**](/windows/desktop/api/PowrProf/nf-powrprof-writeprocessorpwrscheme) | 針對指定的電源配置，寫入處理器電源原則設定。                | 透過 [GUID \_ 處理器 \_ 設定] \_ 子群組電源設定子群組來控制。 使用 [**PowerEnumerate**](/windows/desktop/api/PowrProf/nf-powrprof-powerenumerate) 函式來列舉個別設定。 |
| [**WritePwrScheme**](/windows/desktop/api/PowrProf/nf-powrprof-writepwrscheme)                   | 寫入電源配置特有的原則設定。                           | 電源寫入功能                                                                                                                                                           |



 

 

 



