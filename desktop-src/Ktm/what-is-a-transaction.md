---
description: 交易是一組具有下列屬性的作業：不可部分完成、一致、隔離且持久的 (ACID) 。
ms.assetid: b3da52a3-1c52-4577-a997-7e72ebc03fa8
title: 什麼是交易？
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f0c459462d3aee3d7eef556ce0951ede537e8109
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/07/2021
ms.locfileid: "103849014"
---
# <a name="what-is-a-transaction"></a><span data-ttu-id="94616-103">什麼是交易？</span><span class="sxs-lookup"><span data-stu-id="94616-103">What is a Transaction?</span></span>

<span data-ttu-id="94616-104">交易是一組具有下列屬性的作業：不可部分完成、一致、隔離且持久的 (ACID) 。</span><span class="sxs-lookup"><span data-stu-id="94616-104">A transaction is a group of operations that have the following properties: atomic, consistent, isolated, and durable (ACID).</span></span> <span data-ttu-id="94616-105">交易的支援可讓您開發新類型的應用程式，同時簡化開發程式並讓應用程式更穩固。</span><span class="sxs-lookup"><span data-stu-id="94616-105">The support of transactions enables new types of applications to be developed, while simplifying the development process and making the application more robust.</span></span> <span data-ttu-id="94616-106">本主題的其餘部分提供的案例會示範這些屬性的需求，以及定義每個屬性的資料表。</span><span class="sxs-lookup"><span data-stu-id="94616-106">The remainder of this topic provides scenarios that demonstrate the need for these properties, then a table that defines each property.</span></span>

<span data-ttu-id="94616-107">在一組不可部分 *完成的作業* 中，群組中的每個作業都必須成功，否則它們的影響必須復原 (也稱為 *回復*) 。</span><span class="sxs-lookup"><span data-stu-id="94616-107">In an *atomic* group of operations, either every operation in the group must succeed, or the effects of all of them must be undone (also known as *rolling back*).</span></span> <span data-ttu-id="94616-108">例如，銀行傳輸必須是一組不可部分完成的作業：一個帳戶的付款與另一個帳戶的點數。</span><span class="sxs-lookup"><span data-stu-id="94616-108">For example, a bank transfer must be an atomic set of two operations: a debit from one account and a credit to another account.</span></span> <span data-ttu-id="94616-109">必須將借方和點數實作為不可部分完成的群組。</span><span class="sxs-lookup"><span data-stu-id="94616-109">The debit and credit must be implemented as an atomic group.</span></span> <span data-ttu-id="94616-110">如果這兩項作業不會成功，則會 unfairly 傳輸，以利銀行或帳戶持有者。</span><span class="sxs-lookup"><span data-stu-id="94616-110">If those two operations do not both succeed, then the transfer is either unfairly in favor of the bank or the account holder.</span></span>

<span data-ttu-id="94616-111">*一致性* 的需求表示，在交易 (假設我們在交易) 之前先使用一致的系統啟動，資料會保持一致。</span><span class="sxs-lookup"><span data-stu-id="94616-111">The requirement of *consistency* means that the data is consistent after the transaction (assuming that we started with a consistent system before the transaction).</span></span> <span data-ttu-id="94616-112">針對銀行傳輸範例，一致性可能會定義為將兩個帳戶的合併帳戶餘額視為常數。</span><span class="sxs-lookup"><span data-stu-id="94616-112">For the bank transfer example, consistency may be defined as having the combined account balance of the two accounts be a constant.</span></span> <span data-ttu-id="94616-113">若要在銀行轉帳範例中實行一致性，您只需要支付相同金額的轉帳和信用額度。</span><span class="sxs-lookup"><span data-stu-id="94616-113">To implement consistency in the bank transfer example, the debit and credit operations simply need to be for the same amount of money.</span></span>

<span data-ttu-id="94616-114">另一個交易範例是網站的更新。</span><span class="sxs-lookup"><span data-stu-id="94616-114">Another example of a transaction is an update to a website.</span></span> <span data-ttu-id="94616-115">電子商務網站要求新的產品類別瀏覽目錄頁面，必須與描述新產品的產品詳細資料頁面完全相同的時間出現。</span><span class="sxs-lookup"><span data-stu-id="94616-115">An electronic commerce site requires that a new product category navigation page to appear at exactly the same time as the product detail pages that describe the new products.</span></span> <span data-ttu-id="94616-116">在此情況下，必須在交易控制下更新和加入多個目錄專案。</span><span class="sxs-lookup"><span data-stu-id="94616-116">In this case, there is a need to update and add multiple directory entries under the control of a transaction.</span></span> <span data-ttu-id="94616-117">您不僅需要讓更新成為不可部分完成的，而且目前正在購物的客戶也必須看不到進行中的更新。</span><span class="sxs-lookup"><span data-stu-id="94616-117">Not only is it necessary to have the updates be atomic, but it is also necessary that a customer who is currently shopping must not see the updates in progress.</span></span> <span data-ttu-id="94616-118">這是交易的 *隔離* 屬性範例。</span><span class="sxs-lookup"><span data-stu-id="94616-118">This is an example of the *isolation* property of transactions.</span></span>

<span data-ttu-id="94616-119">*持久性* 的屬性需要在更新完成後，即使系統停止回應，其效果仍會持續。</span><span class="sxs-lookup"><span data-stu-id="94616-119">The property of *durability* requires that after an update is finished, its effects persist even if the system stops responding.</span></span> <span data-ttu-id="94616-120">在先前的範例中，您可以藉由確保適當的資料復原來提供耐久性，如此一來，所有代表將新產品新增至網站的新檔案系統專案都會出現在系統停止回應之後。</span><span class="sxs-lookup"><span data-stu-id="94616-120">In the previous example, durability can be provided simply by ensuring adequate data recovery so that all new file system entries that represent the addition of a new product to the site appear after a system stops responding.</span></span> <span data-ttu-id="94616-121">這需要具有資料備份、修復和高可用性機制的系統。</span><span class="sxs-lookup"><span data-stu-id="94616-121">This requires a system with data backup, recovery, and high availability mechanisms.</span></span>

<span data-ttu-id="94616-122">交易不可部分完成性的保證以及其他屬性，都存在於任何數目的失敗，包括先前失敗的復原階段期間發生的失敗。</span><span class="sxs-lookup"><span data-stu-id="94616-122">The guarantee of the atomicity of a transaction, as well as the other properties, is present in the face of any number of failures, including failures that occur during the recovery phase of a prior failure.</span></span> <span data-ttu-id="94616-123">最後，系統會到達兩種狀態之一：已套用所有作業，或尚未套用任何作業。</span><span class="sxs-lookup"><span data-stu-id="94616-123">Eventually the system will reach either one of two states: all operations have been applied or none of the operations have been applied.</span></span>

<span data-ttu-id="94616-124">下表摘要說明交易的屬性。</span><span class="sxs-lookup"><span data-stu-id="94616-124">The properties of a transaction are summarized in the following table.</span></span>



| <span data-ttu-id="94616-125">詞彙</span><span class="sxs-lookup"><span data-stu-id="94616-125">Term</span></span>                                                                                                         | <span data-ttu-id="94616-126">描述</span><span class="sxs-lookup"><span data-stu-id="94616-126">Description</span></span>                                                                                                                       |
|--------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="94616-127"><span id="Atomic"></span><span id="atomic"></span><span id="ATOMIC"></span>原子</span><span class="sxs-lookup"><span data-stu-id="94616-127"><span id="Atomic"></span><span id="atomic"></span><span id="ATOMIC"></span>Atomic</span></span><br/>                 | <span data-ttu-id="94616-128">交易中的所有作業都成功，或不會保存任何作業。</span><span class="sxs-lookup"><span data-stu-id="94616-128">Either all of the operations in the transaction succeed or none of the operations persist.</span></span><br/>                             |
| <span data-ttu-id="94616-129"><span id="Consistent"></span><span id="consistent"></span><span id="CONSISTENT"></span>一致</span><span class="sxs-lookup"><span data-stu-id="94616-129"><span id="Consistent"></span><span id="consistent"></span><span id="CONSISTENT"></span>Consistent</span></span><br/> | <span data-ttu-id="94616-130">如果資料在交易開始之前是一致的，則在交易完成之後，這些資料會保持一致。</span><span class="sxs-lookup"><span data-stu-id="94616-130">If the data are consistent before the transaction begins, then they will be consistent after the transaction finishes.</span></span><br/> |
| <span data-ttu-id="94616-131"><span id="Isolated_"></span><span id="isolated_"></span><span id="ISOLATED_"></span>孤立</span><span class="sxs-lookup"><span data-stu-id="94616-131"><span id="Isolated_"></span><span id="isolated_"></span><span id="ISOLATED_"></span>Isolated</span></span> <br/>     | <span data-ttu-id="94616-132">正在進行之交易的影響會隱藏于所有其他交易中。</span><span class="sxs-lookup"><span data-stu-id="94616-132">The effects of a transaction that is in progress are hidden from all other transactions.</span></span><br/>                               |
| <span data-ttu-id="94616-133"><span id="Durable"></span><span id="durable"></span><span id="DURABLE"></span>耐用</span><span class="sxs-lookup"><span data-stu-id="94616-133"><span id="Durable"></span><span id="durable"></span><span id="DURABLE"></span>Durable</span></span><br/>             | <span data-ttu-id="94616-134">當交易完成時，其結果會是持續性的，而且會在系統損毀時存活。</span><span class="sxs-lookup"><span data-stu-id="94616-134">When a transaction finishes, its results are persistent and will survive a system crash.</span></span><br/>                               |



 

<span data-ttu-id="94616-135">這些屬性可確保軟體可以處理未預期的錯誤，因為在發生非預期的情況下，可能會導致無法順利完成的交易。</span><span class="sxs-lookup"><span data-stu-id="94616-135">These properties ensure that software can handle unexpected errors, because it can simply abort a transaction when an unexpected situation prevents a successful completion.</span></span> <span data-ttu-id="94616-136">交易基礎結構可確保復原已中止交易的所有效果，並將資料傳回一致的狀態。</span><span class="sxs-lookup"><span data-stu-id="94616-136">The transaction infrastructure ensures that all the effects of the aborted transaction are rolled back, returning the data to a consistent state.</span></span> <span data-ttu-id="94616-137">因此，交易系統可順利復原系統失敗。</span><span class="sxs-lookup"><span data-stu-id="94616-137">Therefore, a transactional system enables a graceful recovery from system failures.</span></span>

<span data-ttu-id="94616-138">為了保證 ACID 屬性，支援交易的系統必須有健全的記錄功能，可在必要時用來認可或回復交易。</span><span class="sxs-lookup"><span data-stu-id="94616-138">To guarantee the ACID properties, a system that supports transactions must have a robust logging capability that can be used to commit or roll back transactions as necessary.</span></span> <span data-ttu-id="94616-139">如需詳細資訊，請參閱 [通用記錄檔系統](/previous-versions/windows/desktop/clfs/common-log-file-system-portal)。</span><span class="sxs-lookup"><span data-stu-id="94616-139">For more information, see [Common Log File System](/previous-versions/windows/desktop/clfs/common-log-file-system-portal).</span></span>

 

