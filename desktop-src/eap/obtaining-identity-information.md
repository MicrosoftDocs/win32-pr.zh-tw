---
title: 取得身分識別資訊
description: 實作為驗證通訊協定的廠商也可以提供函數介面，以取得要求驗證之使用者的初始識別資訊。
ms.assetid: 773c9fdb-c810-4cea-afed-df6484a9c9c9
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: bb9519da9d66937fd25245fe78f12ef34c3c0ad8
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/19/2020
ms.locfileid: "104023317"
---
# <a name="obtaining-identity-information"></a><span data-ttu-id="f105a-103">取得身分識別資訊</span><span class="sxs-lookup"><span data-stu-id="f105a-103">Obtaining Identity Information</span></span>

<span data-ttu-id="f105a-104">實作為驗證通訊協定的廠商也可以提供函數介面，以取得要求驗證之使用者的初始識別資訊。</span><span class="sxs-lookup"><span data-stu-id="f105a-104">The vendor that implements the authentication protocol may also provide a function interface that obtains initial identifying information for the user requesting authentication.</span></span>

<span data-ttu-id="f105a-105">廠商應該執行下列功能。</span><span class="sxs-lookup"><span data-stu-id="f105a-105">The vendor should implement the following functions.</span></span>

-   [<span data-ttu-id="f105a-106">**RasEapGetIdentity**</span><span class="sxs-lookup"><span data-stu-id="f105a-106">**RasEapGetIdentity**</span></span>](/previous-versions/windows/desktop/api/Raseapif/nf-raseapif-raseapgetidentity)
-   [<span data-ttu-id="f105a-107">**RasEapFreeMemory**</span><span class="sxs-lookup"><span data-stu-id="f105a-107">**RasEapFreeMemory**</span></span>](/previous-versions/windows/desktop/api/Raseapif/nf-raseapif-raseapfreememory)

<span data-ttu-id="f105a-108">這些函式可以在與驗證通訊協定相同的 DLL 或個別的 DLL 中執行。</span><span class="sxs-lookup"><span data-stu-id="f105a-108">These functions may be implemented in the same DLL as the authentication protocol, or in a separate DLL.</span></span> <span data-ttu-id="f105a-109">此外，執行身分識別函式的 DLL 可能會支援一個以上的驗證通訊協定。</span><span class="sxs-lookup"><span data-stu-id="f105a-109">Also, the DLL that implements the identity functions may support more than one authentication protocol.</span></span> <span data-ttu-id="f105a-110">這些函式之 DLL 的路徑會儲存在 [ [RAS \_ EAP VALUENAME \_ 身分 \_ 識別](authentication-protocol-registry-values.md) 登錄] 值的 [驗證通訊協定] 的金鑰下。</span><span class="sxs-lookup"><span data-stu-id="f105a-110">The path to the DLL for these functions is stored in the [RAS\_EAP\_VALUENAME\_IDENTITY](authentication-protocol-registry-values.md) registry value, under the key for the authentication protocol.</span></span> <span data-ttu-id="f105a-111">如需有關建立此登錄值的詳細資訊，請參閱 [EAP 安裝](eap-installation.md)。</span><span class="sxs-lookup"><span data-stu-id="f105a-111">For more information about creating this registry value, see [EAP Installation](eap-installation.md).</span></span>

<span data-ttu-id="f105a-112">[**RasEapGetIdentity**](/previous-versions/windows/desktop/api/Raseapif/nf-raseapif-raseapgetidentity)函式通常會顯示使用者介面 (UI) 來取得使用者的身分識別資訊。</span><span class="sxs-lookup"><span data-stu-id="f105a-112">The [**RasEapGetIdentity**](/previous-versions/windows/desktop/api/Raseapif/nf-raseapif-raseapgetidentity) function typically displays a user interface (UI) to obtain identity information for the user.</span></span> <span data-ttu-id="f105a-113">但是，如果 *dwFlags* 參數包含 RAS \_ EAP 旗標 \_ \_ 非 \_ 互動式旗標，則 **RasEapGetIdentity** 不應顯示 UI。</span><span class="sxs-lookup"><span data-stu-id="f105a-113">However, if the *dwFlags* parameter contains the RAS\_EAP\_FLAG\_NON\_INTERACTIVE flag, **RasEapGetIdentity** should not display a UI.</span></span>

<span data-ttu-id="f105a-114">如果 [**RasEapGetIdentity**](/previous-versions/windows/desktop/api/Raseapif/nf-raseapif-raseapgetidentity)確實顯示 ui，則 ui 必須支援 [**LOWORD**](/previous-versions/windows/desktop/legacy/ms632659(v=vs.85)) (*wParam*) 值等於 IDCANCEL 的 [**WM \_ 命令**](../menurc/wm-command.md)訊息。</span><span class="sxs-lookup"><span data-stu-id="f105a-114">If [**RasEapGetIdentity**](/previous-versions/windows/desktop/api/Raseapif/nf-raseapif-raseapgetidentity) does display a UI, the UI must support [**WM\_COMMAND**](../menurc/wm-command.md) messages where the value of [**LOWORD**](/previous-versions/windows/desktop/legacy/ms632659(v=vs.85))(*wParam*) is equal to IDCANCEL.</span></span>

<span data-ttu-id="f105a-115">如果此 EAP 的登錄中的 [RAS \_ EAP \_ VALUENAME \_ INVOKE \_ NAMEDLG](authentication-protocol-registry-values.md)值設為零，則驗證服務會呼叫 [**RasEapGetIdentity**](/previous-versions/windows/desktop/api/Raseapif/nf-raseapif-raseapgetidentity) 。</span><span class="sxs-lookup"><span data-stu-id="f105a-115">The authentication service calls [**RasEapGetIdentity**](/previous-versions/windows/desktop/api/Raseapif/nf-raseapif-raseapgetidentity) if the [RAS\_EAP\_VALUENAME\_INVOKE\_NAMEDLG](authentication-protocol-registry-values.md) value that is in the registry for this EAP is set to zero.</span></span> <span data-ttu-id="f105a-116">如果 RAS \_ EAP \_ VALUENAME \_ INVOKE 叫用 \_ NAMEDLG 不存在或存在，而且設定為1，則驗證服務會顯示標準系統使用者名稱對話方塊。</span><span class="sxs-lookup"><span data-stu-id="f105a-116">If RAS\_EAP\_VALUENAME\_INVOKE\_NAMEDLG is not present, or is present and is set to one, the authentication service displays the standard system user name dialog box.</span></span>

<span data-ttu-id="f105a-117">除了 RAS \_ EAP \_ valuename \_ INVOKE \_ NAMEDLG，EAP 廠商可能會在登錄中建立相關的值，也就是 [ras \_ eap \_ valuename \_ invoke \_ PWDDLG](authentication-protocol-registry-values.md)。</span><span class="sxs-lookup"><span data-stu-id="f105a-117">In addition to RAS\_EAP\_VALUENAME\_INVOKE\_NAMEDLG, the EAP vendor may create a related value, [RAS\_EAP\_VALUENAME\_INVOKE\_PWDDLG](authentication-protocol-registry-values.md), in the registry.</span></span> <span data-ttu-id="f105a-118">如果這個值存在且設定為零，服務將不會顯示標準系統密碼對話方塊。</span><span class="sxs-lookup"><span data-stu-id="f105a-118">If this value is present and is set to zero, the service will not display the standard system password dialog.</span></span> <span data-ttu-id="f105a-119">此值在執行生物特徵辨識方法（例如指紋掃描）來驗證使用者時很有用。</span><span class="sxs-lookup"><span data-stu-id="f105a-119">This value is useful when implementing a biometric method such as a fingerprint scan to authenticate the user.</span></span> <span data-ttu-id="f105a-120">如果 RAS \_ eap \_ valuename \_ INVOKE \_ NAMEDLG 和 ras \_ eap \_ valuename \_ invoke \_ PWDDLG 值為零，則可以使用身分識別 UI 來取得身分識別和生物特徵辨識資訊。</span><span class="sxs-lookup"><span data-stu-id="f105a-120">If both the RAS\_EAP\_VALUENAME\_INVOKE\_NAMEDLG and RAS\_EAP\_VALUENAME\_INVOKE\_PWDDLG values are zero, an identity UI could be used to obtain both the identity and biometric information.</span></span> <span data-ttu-id="f105a-121">但是，如果只有 RAS \_ EAP \_ VALUENAME \_ INVOKE \_ PWDDLG 為零，驗證服務將不會呼叫 [**RasEapGetIdentity**](/previous-versions/windows/desktop/api/Raseapif/nf-raseapif-raseapgetidentity)。</span><span class="sxs-lookup"><span data-stu-id="f105a-121">However, if only RAS\_EAP\_VALUENAME\_INVOKE\_PWDDLG is zero, the authentication service will not call [**RasEapGetIdentity**](/previous-versions/windows/desktop/api/Raseapif/nf-raseapif-raseapgetidentity).</span></span> <span data-ttu-id="f105a-122">在此情況下，您可以使用 [互動式使用者介面](interactive-user-interface.md) 來取得生物特徵辨識資訊。</span><span class="sxs-lookup"><span data-stu-id="f105a-122">In this case, you could use the [interactive user interface](interactive-user-interface.md) to obtain the biometric information.</span></span>

<span data-ttu-id="f105a-123">如需這些登錄值的詳細資訊，請參閱 [驗證通訊協定登錄值](authentication-protocol-registry-values.md)。</span><span class="sxs-lookup"><span data-stu-id="f105a-123">For more information on these registry values, see [Authentication Protocol Registry Values](authentication-protocol-registry-values.md).</span></span>

<span data-ttu-id="f105a-124">[**RasEapGetIdentity**](/previous-versions/windows/desktop/api/Raseapif/nf-raseapif-raseapgetidentity)所取得的資訊會在呼叫 [**RasEapBegin**](/previous-versions/windows/desktop/legacy/aa363520(v=vs.85))期間傳遞至驗證通訊協定。</span><span class="sxs-lookup"><span data-stu-id="f105a-124">The information obtained by [**RasEapGetIdentity**](/previous-versions/windows/desktop/api/Raseapif/nf-raseapif-raseapgetidentity) is passed to the authentication protocol during the call to [**RasEapBegin**](/previous-versions/windows/desktop/legacy/aa363520(v=vs.85)).</span></span> <span data-ttu-id="f105a-125">這項資訊是由 [**PPP \_ EAP \_ 輸入**](/windows/desktop/api/Raseapif/ns-raseapif-ppp_eap_input)結構的 **pszIdentity** 和 **pUserData** 成員所指向。</span><span class="sxs-lookup"><span data-stu-id="f105a-125">The information is pointed to by the **pszIdentity** and **pUserData** members of the [**PPP\_EAP\_INPUT**](/windows/desktop/api/Raseapif/ns-raseapif-ppp_eap_input) structure.</span></span> <span data-ttu-id="f105a-126">若要將此資訊儲存在用戶端電腦的登錄中，驗證通訊協定應該會傳回 [**RasEapMakeMessage**](/previous-versions/windows/desktop/legacy/aa363532(v=vs.85))的 *pEapOutput* 參數中的資訊。</span><span class="sxs-lookup"><span data-stu-id="f105a-126">To save this information in the registry on the client computer, the authentication protocol should return the information in the *pEapOutput* parameter of [**RasEapMakeMessage**](/previous-versions/windows/desktop/legacy/aa363532(v=vs.85)).</span></span>

<span data-ttu-id="f105a-127">呼叫 [**RasEapBegin**](/previous-versions/windows/desktop/legacy/aa363520(v=vs.85))之後，驗證服務會呼叫 [**RasEapFreeMemory**](/previous-versions/windows/desktop/api/Raseapif/nf-raseapif-raseapfreememory) 來釋放此資料所佔用的記憶體。</span><span class="sxs-lookup"><span data-stu-id="f105a-127">After the call to [**RasEapBegin**](/previous-versions/windows/desktop/legacy/aa363520(v=vs.85)), the authentication service calls [**RasEapFreeMemory**](/previous-versions/windows/desktop/api/Raseapif/nf-raseapif-raseapfreememory) to free the memory occupied by this data.</span></span> <span data-ttu-id="f105a-128">因此，在呼叫 **RasEapBegin** 期間，驗證通訊協定應該會將資訊複製到私用記憶體緩衝區。</span><span class="sxs-lookup"><span data-stu-id="f105a-128">Therefore, the authentication protocol should copy the information into a private memory buffer during the call to **RasEapBegin**.</span></span>

 

 