---
title: Server-Side 設定消費者介面
description: 藉由執行 COM 介面 IEAPProviderConfig，來為伺服器執行設定 UI。
ms.assetid: b205c573-6694-42c0-b4f1-1480932dd644
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e0904c90fea2bef3ccc00c00135be09a711d8454
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/19/2020
ms.locfileid: "104314968"
---
# <a name="server-side-configuration-user-interface"></a><span data-ttu-id="38127-103">Server-Side 設定消費者介面</span><span class="sxs-lookup"><span data-stu-id="38127-103">Server-Side Configuration User Interface</span></span>

<span data-ttu-id="38127-104">藉由執行 COM 介面 [**IEAPProviderConfig**](/previous-versions/windows/desktop/api/Rrascfg/nn-rrascfg-ieapproviderconfig)，來為伺服器執行設定 UI。</span><span class="sxs-lookup"><span data-stu-id="38127-104">Implement a configuration UI for the server by implementing the COM interface, [**IEAPProviderConfig**](/previous-versions/windows/desktop/api/Rrascfg/nn-rrascfg-ieapproviderconfig).</span></span> <span data-ttu-id="38127-105">這個 COM 介面衍生自 [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown) 並加入三個方法： [**IEAPProviderConfig：： Initialize**](/previous-versions/windows/desktop/api/Rrascfg/nf-rrascfg-ieapproviderconfig-initialize)、 [**IEAPProviderConfig：： ServerInvokeConfigUI**](/previous-versions/windows/desktop/api/Rrascfg/nf-rrascfg-ieapproviderconfig-serverinvokeconfigui)和 [**IEAPProviderConfig：：**](/previous-versions/windows/desktop/api/Rrascfg/nf-rrascfg-ieapproviderconfig-uninitialize)Initialize。</span><span class="sxs-lookup"><span data-stu-id="38127-105">This COM interface derives from [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown) and adds three methods: [**IEAPProviderConfig::Initialize**](/previous-versions/windows/desktop/api/Rrascfg/nf-rrascfg-ieapproviderconfig-initialize), [**IEAPProviderConfig::ServerInvokeConfigUI**](/previous-versions/windows/desktop/api/Rrascfg/nf-rrascfg-ieapproviderconfig-serverinvokeconfigui), and [**IEAPProviderConfig::Uninitialize**](/previous-versions/windows/desktop/api/Rrascfg/nf-rrascfg-ieapproviderconfig-uninitialize).</span></span>

<span data-ttu-id="38127-106">UI 應該支援遠端系統管理。</span><span class="sxs-lookup"><span data-stu-id="38127-106">The UI should support remote administration.</span></span> <span data-ttu-id="38127-107">換句話說，雖然 UI 會設定伺服器上的驗證通訊協定，但是 UI 本身也可能在不同的電腦上執行。</span><span class="sxs-lookup"><span data-stu-id="38127-107">In other words, although the UI will configure the authentication protocol on the server, the UI itself may be running on a different computer.</span></span> <span data-ttu-id="38127-108">若要支援遠端系統管理，請將 UI 程式碼與實際執行設定的程式碼分開。</span><span class="sxs-lookup"><span data-stu-id="38127-108">To support remote administration, separate the UI code from the code that actually performs the configuration.</span></span> <span data-ttu-id="38127-109">設定程式碼位於驗證通訊協定執行所在的伺服器上。</span><span class="sxs-lookup"><span data-stu-id="38127-109">The configuration code resides on the server on which the authentication protocol runs.</span></span>

<span data-ttu-id="38127-110">使用 Active Template Library (ATL) 來執行 [**IEAPProviderConfig**](/previous-versions/windows/desktop/api/Rrascfg/nn-rrascfg-ieapproviderconfig)。</span><span class="sxs-lookup"><span data-stu-id="38127-110">Use the Active Template Library (ATL) to implement [**IEAPProviderConfig**](/previous-versions/windows/desktop/api/Rrascfg/nn-rrascfg-ieapproviderconfig).</span></span> <span data-ttu-id="38127-111">如需詳細資訊，請參閱 SDK 範例目錄中的伺服器端設定 UI 範例。</span><span class="sxs-lookup"><span data-stu-id="38127-111">For more information, see the sample server-side configuration UI in the SDK samples directory.</span></span> <span data-ttu-id="38127-112">設定 UI 物件 (CLSID) 的類別識別碼應放置在登錄中，並將值名稱設為 [RAS \_ EAP \_ VALUENAME \_ CONFIG \_ CLSID](authentication-protocol-registry-values.md)。</span><span class="sxs-lookup"><span data-stu-id="38127-112">The class identifier (CLSID) for the configuration UI object should be placed in the registry with a value name of [RAS\_EAP\_VALUENAME\_CONFIG\_CLSID](authentication-protocol-registry-values.md).</span></span> <span data-ttu-id="38127-113">如需詳細資訊，請參閱 [驗證通訊協定登錄值](authentication-protocol-registry-values.md)。</span><span class="sxs-lookup"><span data-stu-id="38127-113">For more information, see [Authentication Protocol Registry Values](authentication-protocol-registry-values.md).</span></span>

<span data-ttu-id="38127-114">當使用者在 [路由] 和 [RAS] 的 [內容] 對話方塊中按一下驗證通訊協定的 [設定] 按鈕時，系統會檢查 \_ \_ \_ \_ 登錄中是否有此驗證通訊協定的 RAS EAP VALUENAME 設定 CLSID 值。</span><span class="sxs-lookup"><span data-stu-id="38127-114">When the user clicks the Configure button for an authentication protocol in the Properties dialog box for Routing and RAS, the system checks whether a RAS\_EAP\_VALUENAME\_CONFIG\_CLSID value for this authentication protocol exists in the registry.</span></span> <span data-ttu-id="38127-115">如果是，COM 會將設定 UI 物件具現化。</span><span class="sxs-lookup"><span data-stu-id="38127-115">If so, COM instantiates the configuration UI object.</span></span> <span data-ttu-id="38127-116">如果系統在登錄中找不到 RAS \_ EAP \_ VALUENAME 設定 \_ \_ CLSID，而且系統可存取 (DS) 的目錄服務，系統會嘗試從類別存放區具現化物件。</span><span class="sxs-lookup"><span data-stu-id="38127-116">If the system is unable to find RAS\_EAP\_VALUENAME\_CONFIG\_CLSID in the registry and the system has access to Directory Services (DS), the system attempts to instantiate the object from the Class Store.</span></span>

<span data-ttu-id="38127-117">如果使用者同時連線到多部電腦，則會具現化多個設定 UI 物件。</span><span class="sxs-lookup"><span data-stu-id="38127-117">In the case where the user is connected to multiple machines simultaneously, multiple configuration UI objects are instantiated.</span></span>

 

 