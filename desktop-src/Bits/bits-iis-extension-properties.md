---
title: BITS IIS 擴充功能屬性
description: 背景智慧型傳送服務 (位) 使用 ISAPI 擴充 IIS 以支援上傳作業。
ms.assetid: 08a40cc1-ec6d-4b65-971a-15c7b06df148
keywords:
- BITS IIS 擴充功能屬性位
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c09412f6aa0be1ab76e6e45ea0920e1caf1054d7
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/20/2020
ms.locfileid: "104508036"
---
# <a name="bits-iis-extension-properties"></a><span data-ttu-id="d4000-104">BITS IIS 擴充功能屬性</span><span class="sxs-lookup"><span data-stu-id="d4000-104">BITS IIS Extension Properties</span></span>

<span data-ttu-id="d4000-105">背景智慧型傳送服務 (位) 使用 ISAPI 擴充 IIS 以支援 [**上傳作業**](/windows/win32/api/bits/ne-bits-bg_job_type)。</span><span class="sxs-lookup"><span data-stu-id="d4000-105">Background Intelligent Transfer Service (BITS) uses an ISAPI to extend IIS to support [**upload jobs**](/windows/win32/api/bits/ne-bits-bg_job_type).</span></span> <span data-ttu-id="d4000-106">下表列出 BITS 新增至虛擬目錄元件之 IIS 元資料庫的屬性。</span><span class="sxs-lookup"><span data-stu-id="d4000-106">The following table lists the properties that BITS adds to the IIS metabase for the virtual directory component.</span></span> <span data-ttu-id="d4000-107">BITS 會使用這些屬性來判斷如何上傳檔案。</span><span class="sxs-lookup"><span data-stu-id="d4000-107">BITS uses these properties to determine how to upload the files.</span></span> <span data-ttu-id="d4000-108">BITS IIS 延伸模組屬性是可繼承的，但 **BITSUploadEnabled** 除外。</span><span class="sxs-lookup"><span data-stu-id="d4000-108">The BITS IIS extension properties are inheritable, except for **BITSUploadEnabled**.</span></span>



<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th><span data-ttu-id="d4000-109">屬性</span><span class="sxs-lookup"><span data-stu-id="d4000-109">Property</span></span></th>
<th><span data-ttu-id="d4000-110">描述</span><span class="sxs-lookup"><span data-stu-id="d4000-110">Description</span></span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span data-ttu-id="d4000-111"><strong>BITSUploadEnabled</strong>資料類型： <strong>布林值</strong></span><span class="sxs-lookup"><span data-stu-id="d4000-111"><strong>BITSUploadEnabled</strong>Data type: <strong>Boolean</strong></span></span><br/></td>
<td><span data-ttu-id="d4000-112">指出是否已在虛擬目錄上啟用 BITS 上傳。</span><span class="sxs-lookup"><span data-stu-id="d4000-112">Indicates whether BITS uploads are enabled on the virtual directory.</span></span> <span data-ttu-id="d4000-113">如果設定不存在或為0，則會停用 BITS 上傳。</span><span class="sxs-lookup"><span data-stu-id="d4000-113">If the setting is not present or is 0, BITS uploads are disabled.</span></span><br/> <span data-ttu-id="d4000-114">這是一個唯讀屬性。</span><span class="sxs-lookup"><span data-stu-id="d4000-114">This is a read-only property.</span></span> <span data-ttu-id="d4000-115">若要設定這個屬性，請呼叫<a href="/windows/win32/api/bitscfg/nn-bitscfg-ibitsextensionsetup"><strong>IBITSExtensionSetup</strong></a>介面的<a href="/windows/win32/api/bitscfg/nf-bitscfg-ibitsextensionsetup-enablebitsuploads"><strong>EnableBITSUploads</strong></a>或<a href="/windows/win32/api/bitscfg/nf-bitscfg-ibitsextensionsetup-disablebitsuploads"><strong>DisableBITSUploads</strong></a>方法。</span><span class="sxs-lookup"><span data-stu-id="d4000-115">To set this property, call the <a href="/windows/win32/api/bitscfg/nf-bitscfg-ibitsextensionsetup-enablebitsuploads"><strong>EnableBITSUploads</strong></a> or <a href="/windows/win32/api/bitscfg/nf-bitscfg-ibitsextensionsetup-disablebitsuploads"><strong>DisableBITSUploads</strong></a> method of the <a href="/windows/win32/api/bitscfg/nn-bitscfg-ibitsextensionsetup"><strong>IBITSExtensionSetup</strong></a> interface.</span></span><br/></td>
</tr>
<tr class="even">
<td><span data-ttu-id="d4000-116"><strong>BITSSessionTimeout</strong>資料類型： <strong>DWORD</strong></span><span class="sxs-lookup"><span data-stu-id="d4000-116"><strong>BITSSessionTimeout</strong>Data type: <strong>DWORD</strong></span></span><br/></td>
<td><span data-ttu-id="d4000-117">如果上傳檔案未進行任何進度，則維持連接的秒數;進行進度時，會重設計時器。</span><span class="sxs-lookup"><span data-stu-id="d4000-117">Number of seconds the connection is maintained if no progress is made uploading the file; the timer is reset when progress is made.</span></span> <span data-ttu-id="d4000-118">如果達到超時，則 BITS 會關閉連接，並清除與會話相關聯的資料。</span><span class="sxs-lookup"><span data-stu-id="d4000-118">BITS closes the connection if the time-out is reached and cleans up data associated with the session.</span></span><br/> <span data-ttu-id="d4000-119">設定簡短的會話超時可能是上傳-回復作業的問題，因為只有當使用者登入並聯機到網路時，才會下載回復。</span><span class="sxs-lookup"><span data-stu-id="d4000-119">Setting a short session time-out can be an issue for upload-reply jobs because the reply is only downloaded when the user is logged on and connected to the network.</span></span> <span data-ttu-id="d4000-120">在下載回復之前，會話可能會出現一段時間，在這種情況下，會話就會取消，而且會刪除回復檔。</span><span class="sxs-lookup"><span data-stu-id="d4000-120">It is possible for the session to time out before the reply is downloaded, in which case the session is canceled and the reply file is deleted.</span></span><br/> <span data-ttu-id="d4000-121">請注意，如果 <a href="/windows/win32/bits/group-policies">JobInactivityTimeout</a> 群組原則值 (預設值為 90) 天，則 BITS 會取消工作，不論此設定為何。</span><span class="sxs-lookup"><span data-stu-id="d4000-121">Note that BITS cancels the job if the <a href="/windows/win32/bits/group-policies">JobInactivityTimeout</a> Group Policy value (default is 90 days) is reached, regardless of this setting.</span></span><br/> <span data-ttu-id="d4000-122">預設值為 1209600 (14 天) 。</span><span class="sxs-lookup"><span data-stu-id="d4000-122">Default value is 1,209,600 (14 days).</span></span><br/></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="d4000-123"><strong>BITSMaximumUploadSize</strong>資料類型： <strong>字串</strong></span><span class="sxs-lookup"><span data-stu-id="d4000-123"><strong>BITSMaximumUploadSize</strong>Data type: <strong>String</strong></span></span><br/></td>
<td><span data-ttu-id="d4000-124">每個作業可上傳的位元組數目上限。</span><span class="sxs-lookup"><span data-stu-id="d4000-124">Maximum number of bytes that can be uploaded per job.</span></span> <span data-ttu-id="d4000-125">將最大位元組數目指定為十進位字串;字串值必須小於或等於 &quot; 1844674407370955 &quot; 。</span><span class="sxs-lookup"><span data-stu-id="d4000-125">Specify the maximum number of bytes as a decimal string; the string value must be less than or equal to &quot;1844674407370955&quot;.</span></span> <span data-ttu-id="d4000-126">空字串與指定 &quot; 1844674407370955 相同 &quot; 。</span><span class="sxs-lookup"><span data-stu-id="d4000-126">An empty string is the same as specifying &quot;1844674407370955&quot;.</span></span><br/> <span data-ttu-id="d4000-127">預設值為空字串。</span><span class="sxs-lookup"><span data-stu-id="d4000-127">Default value is an empty string.</span></span><br/>
<blockquote>
[!Note]<br />
<span data-ttu-id="d4000-128">在 IIS 7 中，預設上傳限制為30000000個位元組。</span><span class="sxs-lookup"><span data-stu-id="d4000-128">In IIS 7, the default upload limit is 30 million bytes.</span></span> <span data-ttu-id="d4000-129"><strong>BITSMaximumUploadSize</strong>屬性的值不能超過 IIS 限制。</span><span class="sxs-lookup"><span data-stu-id="d4000-129">The value of the <strong>BITSMaximumUploadSize</strong> property cannot exceed the IIS limit.</span></span> <span data-ttu-id="d4000-130">如需變更 IIS 預設值的詳細資訊和詳細資訊，請參閱 <a href="https://support.microsoft.com//kb/942074">KB942074</a>。</span><span class="sxs-lookup"><span data-stu-id="d4000-130">For details and information on changing the IIS default, see <a href="https://support.microsoft.com//kb/942074">KB942074</a>.</span></span>
</blockquote>
<br/> <br/></td>
</tr>
<tr class="even">
<td><span data-ttu-id="d4000-131"><strong>BITSServerNotificationType</strong>資料類型： <strong>DWORD</strong></span><span class="sxs-lookup"><span data-stu-id="d4000-131"><strong>BITSServerNotificationType</strong>Data type: <strong>DWORD</strong></span></span><br/></td>
<td><span data-ttu-id="d4000-132">指定如何將上傳檔案傳送至伺服器應用程式。</span><span class="sxs-lookup"><span data-stu-id="d4000-132">Specifies how to send the upload file to the server application.</span></span> <span data-ttu-id="d4000-133">可能的值為：0、1和2。</span><span class="sxs-lookup"><span data-stu-id="d4000-133">The possible values are: 0, 1, and 2.</span></span><br/> <span data-ttu-id="d4000-134">值為0表示不會將檔案傳送至伺服器應用程式。</span><span class="sxs-lookup"><span data-stu-id="d4000-134">A value of 0 means the file is not sent to the server application.</span></span> <span data-ttu-id="d4000-135">BITS 會將上傳檔案放在遠端名稱所指定的目錄中， (當您將檔案 <a href="/windows/win32/api/bits/nf-bits-ibackgroundcopyjob-addfile">新增</a> 至作業) 時所指定的遠端名稱，而不會通知伺服器應用程式。</span><span class="sxs-lookup"><span data-stu-id="d4000-135">BITS puts the upload file in the directory specified in the remote name (the remote name specified when you <a href="/windows/win32/api/bits/nf-bits-ibackgroundcopyjob-addfile">added the file</a> to the job) without notifying the server application.</span></span> <span data-ttu-id="d4000-136">如果檔案目前存在於目的地目錄中，則會取代為上傳檔案。</span><span class="sxs-lookup"><span data-stu-id="d4000-136">If the file currently exists in the destination directory, it is replaced with the upload file.</span></span><br/> <span data-ttu-id="d4000-137">1值表示 BITS 會將上傳檔案的位置傳遞至 <strong>BITSServerNotificationURL</strong> 屬性中指定的伺服器應用程式。</span><span class="sxs-lookup"><span data-stu-id="d4000-137">A value of 1 means BITS passes the location of the upload file to the server application specified in the <strong>BITSServerNotificationURL</strong> property.</span></span> <span data-ttu-id="d4000-138">伺服器應用程式會處理檔案，並視需要產生回復檔。</span><span class="sxs-lookup"><span data-stu-id="d4000-138">The server application processes the file and generates a reply file, if needed.</span></span> <span data-ttu-id="d4000-139">根據預設，BITS 會在接收到伺服器應用程式的回應之後，從伺服器移除上傳和回復檔案。</span><span class="sxs-lookup"><span data-stu-id="d4000-139">By default, BITS removes the upload and reply files from the server after it receives the response from the server application.</span></span> <span data-ttu-id="d4000-140">若要讓 BITS 將上傳檔案複製到工作中的遠端檔案名所指定的位置，請在您的回應中包含 <a href="/windows/win32/bits/notification-protocol-for-server-applications">位複製檔案到目的地</a> 的標頭。</span><span class="sxs-lookup"><span data-stu-id="d4000-140">To have BITS copy the upload file to the location specified by the remote file name in the job, include the <a href="/windows/win32/bits/notification-protocol-for-server-applications">BITS-Copy-File-To-Destination</a> header in your response.</span></span> <span data-ttu-id="d4000-141">如果您未包含標頭，而且想要儲存上傳和回復檔案，則必須先將上傳和回復檔案複製到新的位置，然後再回應。</span><span class="sxs-lookup"><span data-stu-id="d4000-141">If you do not include the header and you want to save the upload and reply files, you must copy the upload and reply files to a new location before responding.</span></span><br/> <span data-ttu-id="d4000-142">值為2表示 BITS 會將要求主體中的上傳檔案傳遞至 <strong>BITSServerNotificationURL</strong> 屬性中指定的伺服器應用程式。</span><span class="sxs-lookup"><span data-stu-id="d4000-142">A value of 2 means BITS passes the upload file in the body of the request to the server application specified in the <strong>BITSServerNotificationURL</strong> property.</span></span> <span data-ttu-id="d4000-143">伺服器應用程式會處理檔案，並在回應本文中傳回回複（如有需要）。</span><span class="sxs-lookup"><span data-stu-id="d4000-143">The server application processes the file and passes back the reply in the body of the response, if needed.</span></span><br/> <span data-ttu-id="d4000-144">如需要求和回應標頭的詳細資訊，請參閱 <a href="/windows/win32/bits/notification-protocol-for-server-applications">伺服器應用程式的通知通訊協定</a>。</span><span class="sxs-lookup"><span data-stu-id="d4000-144">For details on the request and response headers, see <a href="/windows/win32/bits/notification-protocol-for-server-applications">Notification Protocol for Server Applications</a>.</span></span><br/> <span data-ttu-id="d4000-145">伺服器應用程式必須在五分鐘內提供回應。</span><span class="sxs-lookup"><span data-stu-id="d4000-145">The server application must provide a response within five minutes.</span></span> <span data-ttu-id="d4000-146">如果伺服器應用程式未在五分鐘內回復，則作業會進入暫時性錯誤狀態。</span><span class="sxs-lookup"><span data-stu-id="d4000-146">If the server application does not reply within five minutes, the job enters the transient error state.</span></span> <span data-ttu-id="d4000-147">當 <a href="/windows/win32/api/bits/nf-bits-ibackgroundcopyjob-setminimumretrydelay"><strong>重試延遲</strong></a> 到期時，BITS 伺服器會傳送另一個通知給伺服器應用程式 (應該撰寫伺服器應用程式，以處理重複的通知) 。<strong>BITS 1.5：</strong> 通知超時時間為30秒。</span><span class="sxs-lookup"><span data-stu-id="d4000-147">When the <a href="/windows/win32/api/bits/nf-bits-ibackgroundcopyjob-setminimumretrydelay"><strong>retry delay</strong></a> expires, the BITS server will send another notification to the server application (the server application should be written to handle duplicate notifications).<strong>BITS 1.5:</strong> The notification time-out is 30 seconds.</span></span><br/> <br/> <span data-ttu-id="d4000-148">預設值為 0。</span><span class="sxs-lookup"><span data-stu-id="d4000-148">Default value is 0.</span></span><br/></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="d4000-149"><strong>BITSServerNotificationURL</strong>資料類型： <strong>字串</strong></span><span class="sxs-lookup"><span data-stu-id="d4000-149"><strong>BITSServerNotificationURL</strong>Data type: <strong>String</strong></span></span><br/></td>
<td><span data-ttu-id="d4000-150">選擇性。</span><span class="sxs-lookup"><span data-stu-id="d4000-150">Optional.</span></span> <span data-ttu-id="d4000-151">包含 BITS 張貼上傳檔案的伺服器應用程式的 URL。</span><span class="sxs-lookup"><span data-stu-id="d4000-151">Contains the URL of the server application to which BITS posts the upload file.</span></span> <span data-ttu-id="d4000-152">如果 <strong>BITSServerNotificationType</strong> 屬性的值是1或2，則您必須指定 URL。</span><span class="sxs-lookup"><span data-stu-id="d4000-152">You must specify a URL if the value of the <strong>BITSServerNotificationType</strong> property is 1 or 2.</span></span> <span data-ttu-id="d4000-153">URL 的限制為2200個字元，不包括 null 結束字元。</span><span class="sxs-lookup"><span data-stu-id="d4000-153">The URL is limited to 2,200 characters, not including the null terminator.</span></span> <span data-ttu-id="d4000-154">URL 必須是 HTTP URL;BITS 不支援 HTTPS 通知 Url。</span><span class="sxs-lookup"><span data-stu-id="d4000-154">The URL must be an HTTP URL; BITS does not support HTTPS notification URLs.</span></span><br/> <span data-ttu-id="d4000-155">如果在上傳時無法使用 URL，BITS 會重試上傳，直到通知 URL 存在或重試期限到期為止。</span><span class="sxs-lookup"><span data-stu-id="d4000-155">If the URL is not available at the time of upload, BITS will retry the upload until the notification URL exists or until the retry period expires.</span></span><br/> <span data-ttu-id="d4000-156">請注意，如果作業中指定的遠端名稱包含查詢字串，則查詢字串會附加至您指定的 URL。</span><span class="sxs-lookup"><span data-stu-id="d4000-156">Note that if the remote name specified in the job contains a query string, the query string is appended to the URL that you specify.</span></span> <span data-ttu-id="d4000-157">例如，如果遠端名稱包含， https://myserver/myvdir/subdir/file.asp?ACCOUNT=86433 而且您將 <strong>BITSServerNotificationURL</strong> 設定指定為 https://otherserver/myvdir2/bag.asp ，則 BITS 張貼的 URL 就是 https://otherserver/myvdir2/bag.asp?ACCOUNT=86433 。</span><span class="sxs-lookup"><span data-stu-id="d4000-157">For example, if the remote name contains https://myserver/myvdir/subdir/file.asp?ACCOUNT=86433 and you specify the <strong>BITSServerNotificationURL</strong> setting as https://otherserver/myvdir2/bag.asp, the URL to which BITS posts is https://otherserver/myvdir2/bag.asp?ACCOUNT=86433.</span></span><br/> <span data-ttu-id="d4000-158">如果原始 URL 為， https://myserver/myvdir/file.txt 且通知 url 為 myasp，則 BITS 會使用 HTTP//myserver/myvdir/myasp 作為通知 url。</span><span class="sxs-lookup"><span data-stu-id="d4000-158">If the original URL is https://myserver/myvdir/file.txt and the notification URL is myasp.asp, BITS uses http//myserver/myvdir/myasp.asp as the notification URL.</span></span><br/> <span data-ttu-id="d4000-159">如果 URL 的路徑和檔案名部分包含在用戶端和伺服器上的字碼頁不通用的 Unicode 字元，則伺服器上的 URL 轉譯將會失敗，而且 BITS 工作將會處於錯誤狀態。</span><span class="sxs-lookup"><span data-stu-id="d4000-159">If the path and file name portion of the URL contains Unicode characters not in common to the code page on both the client and server, the URL translation will fail on the server and the BITS job will be placed in the error state.</span></span> <span data-ttu-id="d4000-160">如果 URL 的伺服器部分包含 Unicode 字元，您必須使用 <a href="/windows/win32/intl/handling-internationalized-domain-names--idns">國際化功能變數名稱</a> (IDN) 來將伺服器部分編碼。</span><span class="sxs-lookup"><span data-stu-id="d4000-160">If the server portion of the URL contains Unicode characters, you must encode the server portion using <a href="/windows/win32/intl/handling-internationalized-domain-names--idns">Internationalized Domain Names</a> (IDN).</span></span><br/></td>
</tr>
<tr class="even">
<td><span data-ttu-id="d4000-161"><strong>BITSHostId</strong>資料類型： <strong>字串</strong></span><span class="sxs-lookup"><span data-stu-id="d4000-161"><strong>BITSHostId</strong>Data Type: <strong>String</strong></span></span><br/></td>
<td><span data-ttu-id="d4000-162">如果伺服器安裝是不使用共用存放裝置的 web 伺服陣列，請設定此屬性。</span><span class="sxs-lookup"><span data-stu-id="d4000-162">Set this property if the server installation is a web farm that does not use shared storage.</span></span><br/> <span data-ttu-id="d4000-163">在上傳程式中斷之後，指定要重新連接之伺服器的伺服器名稱或 IP 位址。</span><span class="sxs-lookup"><span data-stu-id="d4000-163">Specify the server name or IP address of the server to reconnect to after the upload process is interrupted.</span></span> <span data-ttu-id="d4000-164">一般來說，您會指定要設定的伺服器名稱。</span><span class="sxs-lookup"><span data-stu-id="d4000-164">Typically, you specify the name of the server you are configuring.</span></span> <span data-ttu-id="d4000-165">URL 的限制為300個字元，不包括 null 結束字元。</span><span class="sxs-lookup"><span data-stu-id="d4000-165">The URL is limited to 300 characters, not including the null terminator.</span></span><br/> <span data-ttu-id="d4000-166">如果您未指定此屬性，且上傳程式中斷，BITS 可能會在伺服器陣列中的另一部伺服器上繼續工作。</span><span class="sxs-lookup"><span data-stu-id="d4000-166">If you do not specify this property and the upload process is interrupted, it is possible that BITS will resume the job on another server in the farm.</span></span> <span data-ttu-id="d4000-167">不過，先前的伺服器仍包含中斷前的部分上傳檔案。</span><span class="sxs-lookup"><span data-stu-id="d4000-167">However, the previous server still contains the partial upload file from before the interruption.</span></span> <span data-ttu-id="d4000-168">在 <strong>BITSSessionTimeout</strong> 到期後，BITS 會移除部分檔案。</span><span class="sxs-lookup"><span data-stu-id="d4000-168">BITS removes the partial file after the <strong>BITSSessionTimeout</strong> expires.</span></span><br/>
<blockquote>
[!Note]<br />
<span data-ttu-id="d4000-169">如果使用網路負載平衡 (NLB) 或具有多個 IP 位址的 DNS 名稱的 web 伺服陣列中使用 SSL，則請勿使用 <strong>BITSHostId</strong> 屬性，除非您在憑證中包含叢集名稱和個別的伺服器名稱。</span><span class="sxs-lookup"><span data-stu-id="d4000-169">Do not use the <strong>BITSHostId</strong> property if SSL is used in a web farm that uses Network Load Balancing (NLB) or DNS names with multiple IP addresses, unless you include the cluster name and individual server names in the certificate.</span></span> <span data-ttu-id="d4000-170"> (如果 <strong>BITSHostId</strong> 中指定的伺服器名稱與憑證上的一般名稱不相符，作業將會失敗 ) 。請改為針對 NLB 將親和 <a href="/previous-versions/tn-archive/bb687542(v=technet.10)">性</a> 參數設定為 <strong>單一</strong> ，以確保用戶端在未來會與相同的伺服器進行通訊。</span><span class="sxs-lookup"><span data-stu-id="d4000-170">(If the server name specified in <strong>BITSHostId</strong> does not match the common name on the certificate, the job will fail.) Instead, for NLB, set the <a href="/previous-versions/tn-archive/bb687542(v=technet.10)">Affinity</a> parameter to <strong>Single</strong> to ensure that the client communicates with the same server in the future.</span></span>
</blockquote>
<br/> <br/></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="d4000-171"><strong>BITSHostIdFallbackTimeout</strong>資料類型： <strong>DWORD</strong></span><span class="sxs-lookup"><span data-stu-id="d4000-171"><strong>BITSHostIdFallbackTimeout</strong>Data type: <strong>DWORD</strong></span></span><br/></td>
<td><span data-ttu-id="d4000-172">BITS 用戶端在還原為作業遠端檔案名中指定的主機名稱之前，嘗試重新連線到 <strong>BITSHostId</strong> 伺服器名稱的秒數。</span><span class="sxs-lookup"><span data-stu-id="d4000-172">Number of seconds the BITS client tries to reconnect to the <strong>BITSHostId</strong> server name before reverting to the host name specified in the remote file name of the job.</span></span> <span data-ttu-id="d4000-173">當 BITS 無法連線到 <strong>BITSHostId</strong> 伺服器時，就會開始計時器。</span><span class="sxs-lookup"><span data-stu-id="d4000-173">The timer begins when BITS is unable to connect to the <strong>BITSHostId</strong> server.</span></span> <span data-ttu-id="d4000-174">當用戶端成功連接到伺服器時，就會重設計時器。</span><span class="sxs-lookup"><span data-stu-id="d4000-174">The timer is reset when the client successfully connects to the server.</span></span><br/> <span data-ttu-id="d4000-175">請注意，作業 (的 [無進度超時] 值，請參閱 <a href="/windows/win32/api/bits/nf-bits-ibackgroundcopyjob-setnoprogresstimeout"><strong>IBackgroundCopyJob：： SetNoProgressTimeout</strong></a>) 應超過這個超時值。</span><span class="sxs-lookup"><span data-stu-id="d4000-175">Note that the no progress timeout value of the job (see <a href="/windows/win32/api/bits/nf-bits-ibackgroundcopyjob-setnoprogresstimeout"><strong>IBackgroundCopyJob::SetNoProgressTimeout</strong></a>) should be longer than this timeout value.</span></span> <span data-ttu-id="d4000-176">如果不是，則工作會失敗，然後回復超時值過期。</span><span class="sxs-lookup"><span data-stu-id="d4000-176">If not, the job will fail before fallback timeout value expires.</span></span><br/> <span data-ttu-id="d4000-177">只有當您設定 <strong>BITSHostId</strong> 屬性時，才設定這個屬性。</span><span class="sxs-lookup"><span data-stu-id="d4000-177">Set this property only if you set the <strong>BITSHostId</strong> property.</span></span><br/> <span data-ttu-id="d4000-178">預設值為 86400 (1 天) 。</span><span class="sxs-lookup"><span data-stu-id="d4000-178">Default value is 86,400 (1 day).</span></span><br/></td>
</tr>
<tr class="even">
<td><span data-ttu-id="d4000-179"><strong>BITSAllowOverwrites</strong>資料類型： <strong>整數</strong></span><span class="sxs-lookup"><span data-stu-id="d4000-179"><strong>BITSAllowOverwrites</strong>Data type: <strong>Integer</strong></span></span><br/></td>
<td><span data-ttu-id="d4000-180">指出上傳檔案是否可以覆寫具有相同名稱的現有檔案。</span><span class="sxs-lookup"><span data-stu-id="d4000-180">Indicates whether an upload file can overwrite an existing file with the same name.</span></span> <span data-ttu-id="d4000-181">如果 <strong>BITSAllowOverwrites</strong> 是1，則上傳檔案會覆寫現有的檔案。</span><span class="sxs-lookup"><span data-stu-id="d4000-181">The upload file overwrites the existing file if <strong>BITSAllowOverwrites</strong> is 1.</span></span><br/> <span data-ttu-id="d4000-182">預設值為 0。</span><span class="sxs-lookup"><span data-stu-id="d4000-182">Default value is 0.</span></span><br/> <span data-ttu-id="d4000-183"><strong>IIS 6.0：</strong> 您只能從腳本設定此屬性，您無法在 IIS 使用者介面中使用 [BITS 延伸模組屬性] 頁面來設定這個屬性。</span><span class="sxs-lookup"><span data-stu-id="d4000-183"><strong>IIS 6.0:</strong> You can set this property only from a script, you cannot set it using the BITS extension properties page in the IIS user interface.</span></span><br/> <br/></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="d4000-184"><strong>BITSCleanupUseDefault</strong>資料類型： <strong>布林值</strong></span><span class="sxs-lookup"><span data-stu-id="d4000-184"><strong>BITSCleanupUseDefault</strong>Data type: <strong>Boolean</strong></span></span><br/></td>
<td><span data-ttu-id="d4000-185">指出清除工作是否使用預設排程。</span><span class="sxs-lookup"><span data-stu-id="d4000-185">Indicates whether the cleanup task uses the default schedules.</span></span> <span data-ttu-id="d4000-186">預設會每隔12小時執行一次清除工作。</span><span class="sxs-lookup"><span data-stu-id="d4000-186">By default, the cleanup task is run every 12 hours.</span></span><br/> <span data-ttu-id="d4000-187">設定為1則使用預設排程;否則為0以指定排程。</span><span class="sxs-lookup"><span data-stu-id="d4000-187">Set to 1 to use the default schedule; otherwise, 0 to specify a schedule.</span></span><br/> <span data-ttu-id="d4000-188">若要指定排程，請使用 <strong>BITSCleanupCount</strong> 和 <strong>BITSCleanupUnits</strong> 屬性。</span><span class="sxs-lookup"><span data-stu-id="d4000-188">To specify a schedule, use the <strong>BITSCleanupCount</strong> and <strong>BITSCleanupUnits</strong> properties.</span></span><br/> <span data-ttu-id="d4000-189">清除工作會藉由刪除未在會話超時期間內修改的作業來清除虛擬目錄 (查看 <strong>BITSSessionTimeout</strong>) 。</span><span class="sxs-lookup"><span data-stu-id="d4000-189">The cleanup task cleans up the virtual directory by deleting jobs that have not been modified within the session time-out period (see <strong>BITSSessionTimeout</strong>).</span></span><br/> <span data-ttu-id="d4000-190">預設值為1，使用預設排程。</span><span class="sxs-lookup"><span data-stu-id="d4000-190">The default is 1 use the default schedule.</span></span><br/> <span data-ttu-id="d4000-191"><strong>IIS 6.0：</strong> 不支援。</span><span class="sxs-lookup"><span data-stu-id="d4000-191"><strong>IIS 6.0:</strong> Not supported.</span></span><br/></td>
</tr>
<tr class="even">
<td><span data-ttu-id="d4000-192"><strong>BITSCleanupCount</strong>資料類型： <strong>整數</strong></span><span class="sxs-lookup"><span data-stu-id="d4000-192"><strong>BITSCleanupCount</strong>Data type: <strong>Integer</strong></span></span><br/></td>
<td><span data-ttu-id="d4000-193">指定執行清除工作之間要等候的間隔。</span><span class="sxs-lookup"><span data-stu-id="d4000-193">Specifies the interval to wait between running the cleanup task.</span></span> <span data-ttu-id="d4000-194">您可以指定的間隔取決於單位。</span><span class="sxs-lookup"><span data-stu-id="d4000-194">The interval that you can specify depends on the units.</span></span> <span data-ttu-id="d4000-195">如需可能的間隔值，請參閱 <strong>BITSCleanupUnits</strong> 屬性。</span><span class="sxs-lookup"><span data-stu-id="d4000-195">For possible interval values, see the <strong>BITSCleanupUnits</strong> property.</span></span><br/> <span data-ttu-id="d4000-196">如果 <strong>BITSCleanupUseDefault</strong> 為0，則會忽略這個屬性。</span><span class="sxs-lookup"><span data-stu-id="d4000-196">This property is ignored if <strong>BITSCleanupUseDefault</strong> is 0.</span></span><br/> <span data-ttu-id="d4000-197"><strong>IIS 6.0：</strong> 不支援。</span><span class="sxs-lookup"><span data-stu-id="d4000-197"><strong>IIS 6.0:</strong> Not supported.</span></span><br/> <br/></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="d4000-198"><strong>BITSCleanupUnits</strong>資料類型： <strong>整數</strong></span><span class="sxs-lookup"><span data-stu-id="d4000-198"><strong>BITSCleanupUnits</strong>Data type: <strong>Integer</strong></span></span><br/></td>
<td><span data-ttu-id="d4000-199">指定 <strong>BITSCleanupCount</strong> 屬性中所指定之清除間隔的單位。</span><span class="sxs-lookup"><span data-stu-id="d4000-199">Specifies the units for the cleanup interval specified in the <strong>BITSCleanupCount</strong> property.</span></span> <span data-ttu-id="d4000-200">如果 <strong>BITSCleanupUseDefault</strong> 為0，則會忽略這個屬性。</span><span class="sxs-lookup"><span data-stu-id="d4000-200">This property is ignored if <strong>BITSCleanupUseDefault</strong> is 0.</span></span><br/> <span data-ttu-id="d4000-201">可能的值包括：</span><span class="sxs-lookup"><span data-stu-id="d4000-201">The possible values are:</span></span><dl> <span data-ttu-id="d4000-202">0：單位為分鐘。</span><span class="sxs-lookup"><span data-stu-id="d4000-202">0: The units are minutes.</span></span> <span data-ttu-id="d4000-203">可能的值為1到60。</span><span class="sxs-lookup"><span data-stu-id="d4000-203">Possible values are 1 to 60.</span></span><br />
<span data-ttu-id="d4000-204">1：單位為小時。</span><span class="sxs-lookup"><span data-stu-id="d4000-204">1: The units are hours.</span></span> <span data-ttu-id="d4000-205">此為預設值。</span><span class="sxs-lookup"><span data-stu-id="d4000-205">This is the default.</span></span> <span data-ttu-id="d4000-206">可能的值為1到24。</span><span class="sxs-lookup"><span data-stu-id="d4000-206">Possible values are 1 to 24.</span></span><br />
<span data-ttu-id="d4000-207">2：單位是天。</span><span class="sxs-lookup"><span data-stu-id="d4000-207">2: The units are days.</span></span> <span data-ttu-id="d4000-208">可能的值為1到360。</span><span class="sxs-lookup"><span data-stu-id="d4000-208">Possible values are 1 to 360.</span></span><br />
</dl> <br/> <span data-ttu-id="d4000-209"><strong>IIS 6.0：</strong> 不支援。</span><span class="sxs-lookup"><span data-stu-id="d4000-209"><strong>IIS 6.0:</strong> Not supported.</span></span><br/> <br/></td>
</tr>
<tr class="even">
<td><span data-ttu-id="d4000-210"><strong>BITSNumberOfSessionsLimit</strong>資料類型： <strong>整數</strong></span><span class="sxs-lookup"><span data-stu-id="d4000-210"><strong>BITSNumberOfSessionsLimit</strong>Data type: <strong>Integer</strong></span></span><br/></td>
<td><span data-ttu-id="d4000-211">限制使用者可以同時存在的上傳會話數目。</span><span class="sxs-lookup"><span data-stu-id="d4000-211">Limits the number of upload sessions that can exist concurrently for a user.</span></span> <span data-ttu-id="d4000-212">如果使用者的會話數目超過此限制，當清除工作執行時，將會刪除最近的會話，直到使用者的會話數目低於限制為止。</span><span class="sxs-lookup"><span data-stu-id="d4000-212">If the number of sessions for a user is more than this limit, when the cleanup task runs it will delete the most recent sessions until the number of sessions for the user is below the limit.</span></span><br/> <span data-ttu-id="d4000-213">預設值是50會話。</span><span class="sxs-lookup"><span data-stu-id="d4000-213">The default is 50 sessions.</span></span><br/> <span data-ttu-id="d4000-214"><strong>IIS 6.0：</strong> 不支援。</span><span class="sxs-lookup"><span data-stu-id="d4000-214"><strong>IIS 6.0:</strong> Not supported.</span></span><br/> <br/></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="d4000-215"><strong>BITSSessionLimitEnable</strong>資料類型： <strong>布林值</strong></span><span class="sxs-lookup"><span data-stu-id="d4000-215"><strong>BITSSessionLimitEnable</strong>Data type: <strong>Boolean</strong></span></span><br/></td>
<td><span data-ttu-id="d4000-216">指出 BITS 是否會限制每個使用者的上傳會話數目。</span><span class="sxs-lookup"><span data-stu-id="d4000-216">Indicates whether BITS limits the number of upload sessions per user.</span></span> <span data-ttu-id="d4000-217">如果設定不存在或為0，則會停用此限制。</span><span class="sxs-lookup"><span data-stu-id="d4000-217">If the setting is not present or is 0, the limit is disabled.</span></span><br/> <span data-ttu-id="d4000-218">若要指定限制，請設定 <strong>BITSNumberOfSessionsLimit</strong> 屬性。</span><span class="sxs-lookup"><span data-stu-id="d4000-218">To specify the limit, set the <strong>BITSNumberOfSessionsLimit</strong> property.</span></span><br/> <span data-ttu-id="d4000-219">預設值是 1。</span><span class="sxs-lookup"><span data-stu-id="d4000-219">The default is 1.</span></span><br/> <span data-ttu-id="d4000-220"><strong>IIS 6.0：</strong> 不支援。</span><span class="sxs-lookup"><span data-stu-id="d4000-220"><strong>IIS 6.0:</strong> Not supported.</span></span><br/> <br/></td>
</tr>
</tbody>
</table>



 

<span data-ttu-id="d4000-221">下列範例示範如何使用 Windows Script Host 設定 BITS IIS 延伸模組屬性。</span><span class="sxs-lookup"><span data-stu-id="d4000-221">The following example shows how to set the BITS IIS extension properties using Windows Script Host.</span></span> <span data-ttu-id="d4000-222">如果虛擬目錄指向遠端共用，也請設定 **UNCUserName** 和 **UNCPassword** IIS 屬性。</span><span class="sxs-lookup"><span data-stu-id="d4000-222">If the virtual directory points to a remote share, also set the **UNCUserName** and **UNCPassword** IIS properties.</span></span>


```JScript
if (WScript.Arguments.length < 2)
{
    WScript.Echo("Usage: bitsvdir virtual_directory local_directory");
    WScript.Quit(1);
}

VirtualDirectoryName = WScript.Arguments(0);
LocalDirectoryName = WScript.Arguments(1);

ServerObj = GetObject("IIS://LocalHost/W3SVC/1/ROOT");
VirtualDir = ServerObj.Create("IIsWebVirtualDir", VirtualDirectoryName );

VirtualDir.Path = LocalDirectoryName;
VirtualDir.AppIsolated = 0;
VirtualDir.AccessScript = true;
VirtualDir.AccessRead = false;
VirtualDir.AccessWrite = false;
VirtualDir.SetInfo();

// Set BITS specific IIS configuration settings
VirtualDir.EnableBITSUploads();
VirtualDir.BITSMaximumUploadSize = "4294967296";
VirtualDir.SetInfo();

WScript.Echo( "Created virtual directory " + VirtualDirectoryName + 
              " with a local directory of " + LocalDirectoryName );
WScript.Quit( 0 );
```



 

