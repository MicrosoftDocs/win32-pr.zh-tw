---
description: 建立 ASF 檔案時，ContentInfo 物件必須知道媒體內容的特性，才能以正確的值填入不同的標頭物件。
ms.assetid: 30e3c10b-1310-4194-8b83-221dfe73b03c
title: 在 ContentInfo 物件中設定屬性
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e386d5eb33dd1893b195a870425b2336ab9c316f
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/07/2021
ms.locfileid: "104114357"
---
# <a name="setting-properties-in-the-contentinfo-object"></a><span data-ttu-id="a3676-103">在 ContentInfo 物件中設定屬性</span><span class="sxs-lookup"><span data-stu-id="a3676-103">Setting Properties in the ContentInfo Object</span></span>

<span data-ttu-id="a3676-104">建立 ASF 檔案時，ContentInfo 物件必須知道媒體內容的特性，才能以正確的值填入不同的標頭物件。</span><span class="sxs-lookup"><span data-stu-id="a3676-104">While creating an ASF file, the ContentInfo object needs to know the characteristics of the media content so that the various header objects are populated with the correct values.</span></span>

-   [<span data-ttu-id="a3676-105">ContentInfo 物件中的內容相關設定</span><span class="sxs-lookup"><span data-stu-id="a3676-105">Content-Related Settings in the ContentInfo Object</span></span>](#content-related-settings-in-the-contentinfo-object)
-   [<span data-ttu-id="a3676-106">使用編碼器設定來設定 ContentInfo 物件</span><span class="sxs-lookup"><span data-stu-id="a3676-106">Configuring the ContentInfo Object with Encoder Settings</span></span>](#configuring-the-contentinfo-object-with-encoder-settings)
-   [<span data-ttu-id="a3676-107">相關主題</span><span class="sxs-lookup"><span data-stu-id="a3676-107">Related topics</span></span>](#related-topics)

## <a name="content-related-settings-in-the-contentinfo-object"></a><span data-ttu-id="a3676-108">ContentInfo 物件中的內容相關設定</span><span class="sxs-lookup"><span data-stu-id="a3676-108">Content-Related Settings in the ContentInfo Object</span></span>

<span data-ttu-id="a3676-109">內容設定是包含在設定檔中的串流設定，並指定媒體接收器的串流識別碼、媒體類型和有漏洞 bucket 參數。</span><span class="sxs-lookup"><span data-stu-id="a3676-109">Content configuration settings are stream settings, which are contained within the profile and specify the stream identifier, the media type, and the leaky bucket parameters for the media sink.</span></span> <span data-ttu-id="a3676-110">藉由呼叫 [**IMFASFContentInfo：： SetProfile**](/windows/desktop/api/wmcontainer/nf-wmcontainer-imfasfcontentinfo-setprofile)在 ContentInfo 物件上設定設定檔之後，這些值會反映在產生的 ASF 標頭物件中。</span><span class="sxs-lookup"><span data-stu-id="a3676-110">After the profile is set on the ContentInfo object by calling [**IMFASFContentInfo::SetProfile**](/windows/desktop/api/wmcontainer/nf-wmcontainer-imfasfcontentinfo-setprofile), these values are reflected in the ASF Header Object that was generated.</span></span> <span data-ttu-id="a3676-111">如需這些設定的詳細資訊，請參閱 [建立及設定 ASF 資料流程](creating-and-configuring-asf-streams.md)。</span><span class="sxs-lookup"><span data-stu-id="a3676-111">For information about these settings, see [Creating and Configuring ASF Streams](creating-and-configuring-asf-streams.md).</span></span>

## <a name="configuring-the-contentinfo-object-with-encoder-settings"></a><span data-ttu-id="a3676-112">使用編碼器設定來設定 ContentInfo 物件</span><span class="sxs-lookup"><span data-stu-id="a3676-112">Configuring the ContentInfo Object with Encoder Settings</span></span>

<span data-ttu-id="a3676-113">數位媒體音訊或影片資料很複雜，並佔用海量儲存體。</span><span class="sxs-lookup"><span data-stu-id="a3676-113">Digital media audio or video data is complex and takes up large amounts of memory.</span></span> <span data-ttu-id="a3676-114">在大部分的情況下，音訊和影片都會使用編碼器進行壓縮，然後再新增至 ASF 檔案。</span><span class="sxs-lookup"><span data-stu-id="a3676-114">Under most circumstances, both audio and video are compressed by using encoders before being added to an ASF file.</span></span> <span data-ttu-id="a3676-115">在媒體基礎中，會使用一個輸入和一個輸出，將編碼器實作為 [媒體基礎轉換](media-foundation-transforms.md) (MFTs) 。</span><span class="sxs-lookup"><span data-stu-id="a3676-115">In Media Foundation, encoders are implemented as [Media Foundation Transforms](media-foundation-transforms.md) (MFTs) with one input and one output.</span></span> <span data-ttu-id="a3676-116">您必須根據輸入資料流程的媒體類型，以及您選擇用來壓縮資料流程的編碼類型，來選取輸出媒體類型。</span><span class="sxs-lookup"><span data-stu-id="a3676-116">You must select the output media type depending on the media type of the input stream and the encoding type you choose for compressing the stream.</span></span>

<span data-ttu-id="a3676-117">在編碼會話之前，您必須根據編碼類型設定相關的屬性來設定編碼器。</span><span class="sxs-lookup"><span data-stu-id="a3676-117">Before the encoding session, the encoder must be configured by setting the relevant properties depending on the type of encoding.</span></span>

<span data-ttu-id="a3676-118">設定編碼器之後，您必須使用編碼器值設定 ContentInfo 物件，因為 [asf](asf-multiplexer.md) 多工器和 Asf 媒體接收（以填入的 ContentInfo 物件初始化）會使用有漏洞值區值之類的設定來產生 ASF 資料封包。</span><span class="sxs-lookup"><span data-stu-id="a3676-118">After configuring the encoder, you must configure the ContentInfo object with the encoder values because the [ASF Multiplexer](asf-multiplexer.md) and the ASF Media Sink, which are initialized with the populated ContentInfo object, use settings such as the leaky bucket values, to generate ASF data packets.</span></span> <span data-ttu-id="a3676-119">這些值不會儲存在最終的 ASF 標頭物件中。</span><span class="sxs-lookup"><span data-stu-id="a3676-119">The values are not saved in the final ASF Header Object.</span></span> <span data-ttu-id="a3676-120">編碼設定會公開為屬性。</span><span class="sxs-lookup"><span data-stu-id="a3676-120">The encoding settings are exposed as properties.</span></span> <span data-ttu-id="a3676-121">若要使用編碼器屬性來設定 ContentInfo 物件，請執行下列動作：</span><span class="sxs-lookup"><span data-stu-id="a3676-121">To configure the ContentInfo object with the encoder properties, do the following:</span></span>

1.  <span data-ttu-id="a3676-122">直接針對 **IPropertyStore** 介面查詢編碼器 ([**IMFTransform**](/windows/desktop/api/mftransform/nn-mftransform-imftransform)) 介面，以取得編碼器屬性存放區的指標。</span><span class="sxs-lookup"><span data-stu-id="a3676-122">Get a pointer to the encoder's property store by querying the encoder ([**IMFTransform**](/windows/desktop/api/mftransform/nn-mftransform-imftransform) interface) directly for the **IPropertyStore** interface.</span></span>
2.  <span data-ttu-id="a3676-123">呼叫 [**IMFASFContentInfo：： GetEncodingConfigurationPropertyStore**](/windows/desktop/api/wmcontainer/nf-wmcontainer-imfasfcontentinfo-getencodingconfigurationpropertystore)。</span><span class="sxs-lookup"><span data-stu-id="a3676-123">Call [**IMFASFContentInfo::GetEncodingConfigurationPropertyStore**](/windows/desktop/api/wmcontainer/nf-wmcontainer-imfasfcontentinfo-getencodingconfigurationpropertystore).</span></span> <span data-ttu-id="a3676-124">若要設定資料流程特定屬性，請在 *wStreamNumber* 參數中指定資料流程識別碼;若為檔案層級屬性，則傳遞0。</span><span class="sxs-lookup"><span data-stu-id="a3676-124">To set stream-specific properties, specify the stream identifier in the *wStreamNumber* parameter; for file-level properties, pass 0.</span></span> <span data-ttu-id="a3676-125">*PpIStore* 參數會接收 **IPropertyStore** 介面的指標。</span><span class="sxs-lookup"><span data-stu-id="a3676-125">The *ppIStore* parameter receives a pointer to the **IPropertyStore** interface.</span></span> <span data-ttu-id="a3676-126">收到的屬性存放區是空的。</span><span class="sxs-lookup"><span data-stu-id="a3676-126">The received property store is empty.</span></span>
3.  <span data-ttu-id="a3676-127">在編碼器上呼叫 **IPropertyStore：： GetValue** ，然後藉由指定屬性索引鍵常數來取得屬性值。</span><span class="sxs-lookup"><span data-stu-id="a3676-127">Call **IPropertyStore::GetValue** on the encoder and get the property value by specifying the property key constants.</span></span> <span data-ttu-id="a3676-128">如需編碼屬性的完整清單，請參閱 [編解碼器程式設計參考](/previous-versions//aa384554(v=vs.85))。</span><span class="sxs-lookup"><span data-stu-id="a3676-128">For a complete list of encoding properties, see the [Codec Programming Reference](/previous-versions//aa384554(v=vs.85)).</span></span>
4.  <span data-ttu-id="a3676-129">在 ContentInfo 物件上呼叫 **IPropertyStore：： SetValue** ，以設定屬性存放區中的必要屬性。</span><span class="sxs-lookup"><span data-stu-id="a3676-129">Call **IPropertyStore::SetValue** on the ContentInfo object to set the required property in the property store.</span></span>
5.  <span data-ttu-id="a3676-130">針對您要設定的每個屬性重複步驟3和4。</span><span class="sxs-lookup"><span data-stu-id="a3676-130">Repeat steps 3 and 4 for each property that you want to set.</span></span>

<span data-ttu-id="a3676-131">您可以藉由呼叫 [**MFCreateASFMediaSinkActivate**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreateasfmediasinkactivate)，藉由使用啟用物件來建立 ASF 媒體接收器。</span><span class="sxs-lookup"><span data-stu-id="a3676-131">The ASF media sink can be created by using an activation object by calling [**MFCreateASFMediaSinkActivate**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreateasfmediasinkactivate).</span></span> <span data-ttu-id="a3676-132">新的媒體接收物件是根據可在 ContentInfo 物件的屬性存放區中設定的媒體接收特定設定來設定。</span><span class="sxs-lookup"><span data-stu-id="a3676-132">The new media sink object is configured based on media sink-specific settings that can be set in the ContentInfo object's property store.</span></span> <span data-ttu-id="a3676-133">下表顯示 ASF 媒體接收器屬性常數。</span><span class="sxs-lookup"><span data-stu-id="a3676-133">The following table shows the ASF media sink property constants.</span></span>



| <span data-ttu-id="a3676-134">屬性</span><span class="sxs-lookup"><span data-stu-id="a3676-134">Property</span></span>                                                                                                     | <span data-ttu-id="a3676-135">描述</span><span class="sxs-lookup"><span data-stu-id="a3676-135">Description</span></span>                                                                                                                                                                                                                                                                                           |
|--------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="a3676-136">**MFPKEY \_ ASFMEDIASINK \_ BASE \_ SENDTIME**</span><span class="sxs-lookup"><span data-stu-id="a3676-136">**MFPKEY\_ASFMEDIASINK\_BASE\_SENDTIME**</span></span>](mfpkey-asfmediasink-base-sendtime-property.md)                   | <span data-ttu-id="a3676-137">傳送時間會指出何時會釋放有漏洞 bucket 內的承載。</span><span class="sxs-lookup"><span data-stu-id="a3676-137">The send time indicates when the payload inside the leaky bucket will be released.</span></span> <span data-ttu-id="a3676-138">這個屬性值表示第一個傳送時間。</span><span class="sxs-lookup"><span data-stu-id="a3676-138">This property value indicates the first send time.</span></span> <span data-ttu-id="a3676-139">多工器會使用此值來計算所產生封包的後續傳送時間，並確保資料會透過有漏洞值區穩定流動。</span><span class="sxs-lookup"><span data-stu-id="a3676-139">The multiplexer uses this value to calculate the subsequent send times for the generated packets and ensures that data flows steadily through the leaky bucket.</span></span> |
| [<span data-ttu-id="a3676-140">**MFPKEY \_ ASFMEDIASINK \_ AUTOADJUST \_ 位元速率**</span><span class="sxs-lookup"><span data-stu-id="a3676-140">**MFPKEY\_ASFMEDIASINK\_AUTOADJUST\_BITRATE**</span></span>](mfpkey-asfmediasink-autoadjust-bitrate-property.md)         | <span data-ttu-id="a3676-141">這個 **BOOL** 值會指出多工器是否需要自動調整位元速率，以確保資料不會溢位有漏洞值區。</span><span class="sxs-lookup"><span data-stu-id="a3676-141">This **BOOL** value indicates whether the multiplexer needs to adjust the bit rate automatically to ensure that data does not overflow the leaky bucket.</span></span>                                                                                                                                              |
| [<span data-ttu-id="a3676-142">**MFPKEY \_ ASFMEDIASINK \_ DRMACTION**</span><span class="sxs-lookup"><span data-stu-id="a3676-142">**MFPKEY\_ASFMEDIASINK\_DRMACTION**</span></span>](mfpkey-asfmediasink-drmaction-property.md)                            | <span data-ttu-id="a3676-143">這表示檔案產生的 ASF 媒體接收 DRM 動作。</span><span class="sxs-lookup"><span data-stu-id="a3676-143">This indicates the ASF media sink DRM action for file generation.</span></span> <span data-ttu-id="a3676-144">在此版本中，只支援 DRM 轉碼。</span><span class="sxs-lookup"><span data-stu-id="a3676-144">In this release, only DRM transcode is supported.</span></span>                                                                                                                                                                                   |
| [<span data-ttu-id="a3676-145">**MFPKEY \_ ASFSTREAMSINK 已 \_ 更正 \_ LEAKYBUCKET**</span><span class="sxs-lookup"><span data-stu-id="a3676-145">**MFPKEY\_ASFSTREAMSINK\_CORRECTED\_LEAKYBUCKET**</span></span>](mfpkey-asfstreamsink-corrected-leakybucket-property.md) | <span data-ttu-id="a3676-146">當編碼器決定要使用哪個緩衝區視窗和位元速率時，必須設定這個屬性。</span><span class="sxs-lookup"><span data-stu-id="a3676-146">This property must be set when the encoder decides which buffer window and bit rate to use.</span></span> <span data-ttu-id="a3676-147">若要設定這些值，請使用 [**IWMCodecLeakyBucket**](/windows/desktop/api/wmcodecdsp/nn-wmcodecdsp-iwmcodecleakybucket) 介面。</span><span class="sxs-lookup"><span data-stu-id="a3676-147">To set these values, use the [**IWMCodecLeakyBucket**](/windows/desktop/api/wmcodecdsp/nn-wmcodecdsp-iwmcodecleakybucket) interface.</span></span> <span data-ttu-id="a3676-148">這必須針對 ASF 檔案中的每個資料流程進行設定。</span><span class="sxs-lookup"><span data-stu-id="a3676-148">This must be set for each stream in the ASF file.</span></span>                                                     |



 

## <a name="related-topics"></a><span data-ttu-id="a3676-149">相關主題</span><span class="sxs-lookup"><span data-stu-id="a3676-149">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="a3676-150">為新檔案撰寫 ASF 標頭物件</span><span class="sxs-lookup"><span data-stu-id="a3676-150">Writing an ASF Header Object for a New File</span></span>](writing-an-asf-header-object-for-a-new-file.md)
</dt> </dl>

 

 
