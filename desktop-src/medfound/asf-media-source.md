---
description: 媒體基礎提供 ASF 媒體來源，可讓應用程式用來代表架構的管線層中的 ASF 檔案。
ms.assetid: a2d2b382-d666-4a37-a6a9-0b839fbfbec3
title: ASF 媒體來源
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 75dc682d48339ce4ff707e7859a6962b9f5cfd92
ms.sourcegitcommit: c16214e53680dc71d1c07111b51f72b82a4512d8
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 03/03/2021
ms.locfileid: "106982811"
---
# <a name="asf-media-source"></a><span data-ttu-id="f0ff1-103">ASF 媒體來源</span><span class="sxs-lookup"><span data-stu-id="f0ff1-103">ASF Media Source</span></span>

<span data-ttu-id="f0ff1-104">媒體基礎提供 ASF 媒體來源，可讓應用程式用來代表架構的管線層中的 ASF 檔案。</span><span class="sxs-lookup"><span data-stu-id="f0ff1-104">Media Foundation provides the ASF media source that an application can use to represent an ASF file in the pipeline layer of the architecture.</span></span>

<span data-ttu-id="f0ff1-105">為了播放 ASF 檔案，應用程式可以使用 ASF 媒體來源將資料送入播放管線。</span><span class="sxs-lookup"><span data-stu-id="f0ff1-105">In order to play an ASF file, an application can use the ASF media source to feed data into a playback pipeline.</span></span> <span data-ttu-id="f0ff1-106">在編碼案例中，應用程式可以使用 ASF 媒體來源作為來源，以轉換成另一種格式，或將較高的位元速率檔案轉換成較低的位元速率檔案，而不變更格式。</span><span class="sxs-lookup"><span data-stu-id="f0ff1-106">In an encoding scenario, application can use the ASF media source as the source to convert into another format or for converting a higher bit-rate file to a lower bit-rate file without changing formats.</span></span> <span data-ttu-id="f0ff1-107">您必須在管線層中使用 ASF 媒體來源，也就是應用程式必須使用媒體會話來控制操作。</span><span class="sxs-lookup"><span data-stu-id="f0ff1-107">The ASF media source must be used in the pipeline layer, that is, an application must use the Media Session to control the operation.</span></span> <span data-ttu-id="f0ff1-108">此存取層級可讓應用程式在媒體會話進行時取得事件。</span><span class="sxs-lookup"><span data-stu-id="f0ff1-108">This level of access allows the applications to get events while the Media Session is in progress.</span></span> <span data-ttu-id="f0ff1-109">若要取得更低層級的 ASF 內容存取權，應用程式必須使用 WMContainer 層 ASF 元件。</span><span class="sxs-lookup"><span data-stu-id="f0ff1-109">To get lower-level access to the ASF content, an application must use the WMContainer Layer ASF components.</span></span>

<span data-ttu-id="f0ff1-110">ASF 媒體來源會實 [**IMFMediaSource**](/windows/desktop/api/mfidl/nn-mfidl-imfmediasource) 介面，這是媒體基礎中媒體來源的泛型介面。</span><span class="sxs-lookup"><span data-stu-id="f0ff1-110">The ASF media source implements the [**IMFMediaSource**](/windows/desktop/api/mfidl/nn-mfidl-imfmediasource) interface, which is the generic interface for media sources in Media Foundation.</span></span> <span data-ttu-id="f0ff1-111">如同任何其他媒體來源，ASF 媒體來源提供的簡報描述項主要描述 ASF 標頭物件。</span><span class="sxs-lookup"><span data-stu-id="f0ff1-111">Like any other media source, the ASF media source provides a presentation descriptor that primarily describes the ASF Header Object.</span></span> <span data-ttu-id="f0ff1-112">此外，ASF 媒體來源會提供代表媒體內容中每個資料流程的資料流程描述項。</span><span class="sxs-lookup"><span data-stu-id="f0ff1-112">In addition, the ASF media source provides stream descriptors that represent each stream in the media content.</span></span> <span data-ttu-id="f0ff1-113">如需詳細資訊，請參閱 [ASF 檔案結構](asf-file-structure.md)。</span><span class="sxs-lookup"><span data-stu-id="f0ff1-113">For more information, see [ASF File Structure](asf-file-structure.md).</span></span>

-   [<span data-ttu-id="f0ff1-114">建立 ASF 媒體來源</span><span class="sxs-lookup"><span data-stu-id="f0ff1-114">Creating the ASF Media Source</span></span>](#creating-the-asf-media-source)
-   [<span data-ttu-id="f0ff1-115">ASF 媒體來源的設定</span><span class="sxs-lookup"><span data-stu-id="f0ff1-115">Configuration Settings for the ASF Media Source</span></span>](#configuration-settings-for-the-asf-media-source)
-   [<span data-ttu-id="f0ff1-116">ASF 媒體來源物件模型</span><span class="sxs-lookup"><span data-stu-id="f0ff1-116">ASF Media Source Object Model</span></span>](#asf-media-source-object-model)
-   [<span data-ttu-id="f0ff1-117">ASF 媒體來源服務</span><span class="sxs-lookup"><span data-stu-id="f0ff1-117">ASF Media Source Services</span></span>](#asf-media-source-services)
    -   [<span data-ttu-id="f0ff1-118">時間碼轉譯</span><span class="sxs-lookup"><span data-stu-id="f0ff1-118">Timecode Translation</span></span>](#timecode-translation)
-   [<span data-ttu-id="f0ff1-119">相關主題</span><span class="sxs-lookup"><span data-stu-id="f0ff1-119">Related topics</span></span>](#related-topics)

## <a name="creating-the-asf-media-source"></a><span data-ttu-id="f0ff1-120">建立 ASF 媒體來源</span><span class="sxs-lookup"><span data-stu-id="f0ff1-120">Creating the ASF Media Source</span></span>

<span data-ttu-id="f0ff1-121">若要建立 ASF 媒體來源，應用程式必須使用 [來源解析](source-resolver.md)程式。</span><span class="sxs-lookup"><span data-stu-id="f0ff1-121">To create the ASF media source, the application must use the [Source Resolver](source-resolver.md).</span></span> <span data-ttu-id="f0ff1-122">為了建立 ASF 媒體來源，應用程式必須提供來源解析程式建立 ASF 媒體來源的來源。</span><span class="sxs-lookup"><span data-stu-id="f0ff1-122">In order to create the ASF media source, the application must provide the source for which the source resolver creates the ASF media source.</span></span> <span data-ttu-id="f0ff1-123">您必須指定來源檔案的 URL 或包含媒體的位元組資料流程，以提供來源資訊。</span><span class="sxs-lookup"><span data-stu-id="f0ff1-123">The source information must be provided by either specifying the URL of the source file or the byte stream that contains the media.</span></span> <span data-ttu-id="f0ff1-124">如果應用程式選擇藉由指定 URL 來建立 ASF 媒體來源，則必須針對同步作業呼叫 [**IMFSourceResolver：： CreateObjectFromURL**](/windows/desktop/api/mfidl/nf-mfidl-imfsourceresolver-createobjectfromurl) 或 **IMFSourceResolver：： Begin .。。** 非同步作業的 EndCreateObjectFromURL。</span><span class="sxs-lookup"><span data-stu-id="f0ff1-124">If the application chooses to create the ASF media source by specifying the URL, it must call either [**IMFSourceResolver::CreateObjectFromURL**](/windows/desktop/api/mfidl/nf-mfidl-imfsourceresolver-createobjectfromurl) for synchronous operation or **IMFSourceResolver::Begin…EndCreateObjectFromURL** for asynchronous operation.</span></span> <span data-ttu-id="f0ff1-125">從位元組串流建立媒體來源的程式很類似。</span><span class="sxs-lookup"><span data-stu-id="f0ff1-125">The process for creating the media source from a byte stream is similar.</span></span> <span data-ttu-id="f0ff1-126">應用程式必須呼叫 [**IMFSourceResolver：： CreateObjectFromByteStream**](/windows/desktop/api/mfidl/nf-mfidl-imfsourceresolver-createobjectfrombytestream) 進行同步作業或 **IMFSourceResolver：： Begin .。。** 非同步作業的 EndCreateObjectFromBytestream。</span><span class="sxs-lookup"><span data-stu-id="f0ff1-126">The application must call either [**IMFSourceResolver::CreateObjectFromByteStream**](/windows/desktop/api/mfidl/nf-mfidl-imfsourceresolver-createobjectfrombytestream) for synchronous operation or **IMFSourceResolver::Begin…EndCreateObjectFromBytestream** for asynchronous operation.</span></span> <span data-ttu-id="f0ff1-127">這些呼叫必須 \_ \_ 在 *dwFlags* 參數中指定 MF 解析 MEDIASOURCE。</span><span class="sxs-lookup"><span data-stu-id="f0ff1-127">These calls must specify MF\_RESOLUTION\_MEDIASOURCE in *dwFlags* parameter.</span></span> <span data-ttu-id="f0ff1-128">如需使用此旗標的詳細資訊，請參閱使用來源解析程式。</span><span class="sxs-lookup"><span data-stu-id="f0ff1-128">For more information about using this flag, see Using the Source Resolver.</span></span>

<span data-ttu-id="f0ff1-129">如果應用程式指定 URL，則在本機檔案中，URL 字串可以包含媒體檔案的路徑，也可以使用 "file：" 配置作為前置詞。</span><span class="sxs-lookup"><span data-stu-id="f0ff1-129">If the application specifies a URL, for a local file, the URL string can contain the path of the media file or can be prefixed with the “file: “scheme.</span></span> <span data-ttu-id="f0ff1-130">副檔名必須是 ".asf"、"wm"、L ".wma" 或 ".wmv"。</span><span class="sxs-lookup"><span data-stu-id="f0ff1-130">The file name extension must be ".asf", ".wm", L".wma", or ".wmv".</span></span> <span data-ttu-id="f0ff1-131">若為網路上的 ASF 檔案，來源解析程式會建立使用 ASF 媒體來源的 [網路來源](network-source-features.md)。</span><span class="sxs-lookup"><span data-stu-id="f0ff1-131">For an ASF file on the network, the source resolver creates the [Network Source](network-source-features.md), which uses the ASF media source.</span></span>

<span data-ttu-id="f0ff1-132">在建立物件期間，來源解析程式會在系統登錄中尋找配置處理常式和位元組資料流程處理常式的清單，並載入最接近的相符處理常式，以便剖析媒體內容，也會在下方建立媒體來源物件。</span><span class="sxs-lookup"><span data-stu-id="f0ff1-132">During the object creation process, the source resolver looks up the list of scheme handlers and the byte stream handlers in the system registry and loads the closest matching handler that can parse the media content and also create the media source object underneath.</span></span> <span data-ttu-id="f0ff1-133">無論用來建立媒體來源 (URL 和位元組串流) 的方法，來源解析程式都會建立位元組資料流程，並將來源媒體的內容讀入位元組資料流程中。</span><span class="sxs-lookup"><span data-stu-id="f0ff1-133">Irrespective of the method used to create the media source (URL and byte stream), the source resolver creates a byte stream and reads the contents of source media into the byte stream.</span></span> <span data-ttu-id="f0ff1-134">如需詳細資訊，請參閱 [配置處理常式和 Byte-Stream 處理常式](scheme-handlers-and-byte-stream-handlers.md)。</span><span class="sxs-lookup"><span data-stu-id="f0ff1-134">For more information, see [Scheme Handlers and Byte-Stream Handlers](scheme-handlers-and-byte-stream-handlers.md).</span></span>

<span data-ttu-id="f0ff1-135">如需有關如何建立媒體來源的程式碼範例，請參閱 [使用來源解析程式](using-the-source-resolver.md)。</span><span class="sxs-lookup"><span data-stu-id="f0ff1-135">For code example about how to create a media source, see [Using the Source Resolver](using-the-source-resolver.md).</span></span>

## <a name="configuration-settings-for-the-asf-media-source"></a><span data-ttu-id="f0ff1-136">ASF 媒體來源的設定</span><span class="sxs-lookup"><span data-stu-id="f0ff1-136">Configuration Settings for the ASF Media Source</span></span>

<span data-ttu-id="f0ff1-137">來源解析程式會查詢基礎位元組資料流程的功能，並決定新建立之媒體來源上允許的作業。</span><span class="sxs-lookup"><span data-stu-id="f0ff1-137">The source resolver queries for the capabilities of the underlying byte stream and determines the operations are allowed on the newly created media source.</span></span> <span data-ttu-id="f0ff1-138">其中一項功能是搜尋。</span><span class="sxs-lookup"><span data-stu-id="f0ff1-138">One of such capabilities is seeking.</span></span> <span data-ttu-id="f0ff1-139">如果允許搜尋作業，應用程式可以指定媒體來源在搜尋簡報中的特定點時，所使用的搜尋模式。</span><span class="sxs-lookup"><span data-stu-id="f0ff1-139">If a seek operation is allowed, the application can specify the seeking mode that the media source uses while seeking to a particular point in the presentation.</span></span>

<span data-ttu-id="f0ff1-140">應用程式可以在建立物件期間，設定要使用之媒體來源的搜尋模式。</span><span class="sxs-lookup"><span data-stu-id="f0ff1-140">An application can set the seek mode, for the media source to use, during object creation.</span></span> <span data-ttu-id="f0ff1-141">使用指定的搜尋模式建立 ASF 媒體來源之後，就無法在媒體來源上修改或在簡報期間動態變更。</span><span class="sxs-lookup"><span data-stu-id="f0ff1-141">After the ASF media source is created with the specified seek mode, it cannot be modified on the media source or dynamically changed during a presentation.</span></span> <span data-ttu-id="f0ff1-142">搜尋喜好設定會指定為應用程式呼叫中用來建立媒體來源之相關來源解析程式方法的屬性。</span><span class="sxs-lookup"><span data-stu-id="f0ff1-142">Seeking preferences are specified as properties in the application’s call to the relevant source resolver methods that are used to create the media source.</span></span> <span data-ttu-id="f0ff1-143">這些屬性集合會在屬性存放區中設定，並傳遞至 *pProps* 參數。</span><span class="sxs-lookup"><span data-stu-id="f0ff1-143">These set of properties are set in a property store and passed to the *pProps* parameter.</span></span> <span data-ttu-id="f0ff1-144">如果未傳遞這些屬性，則會使用預設設定來處理媒體來源功能。</span><span class="sxs-lookup"><span data-stu-id="f0ff1-144">If these properties are not passed, the media source functions with the default settings.</span></span> <span data-ttu-id="f0ff1-145">如需有關設定這些屬性的詳細資訊，請參閱設定 [媒體來源](configuring-a-media-source.md)。</span><span class="sxs-lookup"><span data-stu-id="f0ff1-145">For more information about setting these properties, see [Configuring a Media Source](configuring-a-media-source.md).</span></span>

<span data-ttu-id="f0ff1-146">如果允許搜尋，ASF 媒體來源支援下列搜尋模式：</span><span class="sxs-lookup"><span data-stu-id="f0ff1-146">If seeking is allowed, the ASF media source supports the following seek modes:</span></span>

-   <span data-ttu-id="f0ff1-147">確切搜尋：在此模式中，ASF 媒體來源依賴 ASF 檔案的 ASF 索引物件。</span><span class="sxs-lookup"><span data-stu-id="f0ff1-147">Exact seeking: In this mode, the ASF media source relies on the ASF Index Object of the ASF file.</span></span> <span data-ttu-id="f0ff1-148">如果檔案沒有 Index 物件，則會停用確切搜尋，而且會根據媒體來源上設定的應用程式指定屬性，使用其中一個其他模式。</span><span class="sxs-lookup"><span data-stu-id="f0ff1-148">If the file does not have the Index Object, exact seeking is disabled and one of the other modes are used depending on the application-specified properties that are set on the media source.</span></span>
-   <span data-ttu-id="f0ff1-149">近似搜尋：此模式是由應用程式所要求，方法是將屬性存放區中的 [**MFPKEY \_ ASFMediaSource \_ ApproxSeek**](mfpkey-asfmediasource-approxseek-property.md) 傳遞給相關的來源解析程式方法。</span><span class="sxs-lookup"><span data-stu-id="f0ff1-149">Approximate seeking: This mode is requested by the application by passing [**MFPKEY\_ASFMediaSource\_ApproxSeek**](mfpkey-asfmediasource-approxseek-property.md) in the property store to the relevant source resolver methods.</span></span> <span data-ttu-id="f0ff1-150">不過，只有在位元組資料流程不支援以時間為基礎的搜尋時，才會使用大約的搜尋。</span><span class="sxs-lookup"><span data-stu-id="f0ff1-150">However, approximate seeking is only used if the byte stream does not support time-based seeking.</span></span> <span data-ttu-id="f0ff1-151">在此模式中，媒體來源會判斷相對於搜尋時間的開始時間。</span><span class="sxs-lookup"><span data-stu-id="f0ff1-151">In this mode, the media source determine a start time that is relatively closer to the seek time.</span></span> <span data-ttu-id="f0ff1-152">如果 ASF 檔案包含 ASF 索引物件，則會用來計算開始時間。</span><span class="sxs-lookup"><span data-stu-id="f0ff1-152">If the ASF file contains an ASF Index Object, it is used to calculate the start time.</span></span> <span data-ttu-id="f0ff1-153">近似的搜尋較不精確，但是比確切的搜尋更快，因為所花的時間會以預先決定的開始時間轉譯第一個樣本的時間更快。</span><span class="sxs-lookup"><span data-stu-id="f0ff1-153">Approximate seeking is less accurate but faster than exact seeking because the time taken render the first sample at the predetermined start time is faster.</span></span>
-   <span data-ttu-id="f0ff1-154">反復搜尋：若要設定此模式，應用程式必須設定 [MFPKEY \_ ASFMediaSource \_ IterativeSeekIfNoIndex](mfpkey-asfmediasource-iterativeseekifnoindex.md) 屬性。</span><span class="sxs-lookup"><span data-stu-id="f0ff1-154">Iterative seeking: To set this mode, the application must set the [MFPKEY\_ASFMediaSource\_IterativeSeekIfNoIndex](mfpkey-asfmediasource-iterativeseekifnoindex.md) property.</span></span> <span data-ttu-id="f0ff1-155">反復搜尋是一種演算法，可在 ASF 檔案中尋找不包含 ASF 索引物件的位置。</span><span class="sxs-lookup"><span data-stu-id="f0ff1-155">Iterative seeking is an algorithm to find a position in an ASF file that contains no ASF Index Object.</span></span> <span data-ttu-id="f0ff1-156">在此模式中，媒體來源會藉由讀取位元組資料流程位移來 determins 搜尋點的粗略估計。</span><span class="sxs-lookup"><span data-stu-id="f0ff1-156">In this mode, the media source determins a rough estimate of the seek point by reading the byte stream offset.</span></span> <span data-ttu-id="f0ff1-157">它會根據平均位元速率來使用一連串的近似值，以逐漸接近目標搜尋時間。</span><span class="sxs-lookup"><span data-stu-id="f0ff1-157">It uses a series of approximations, based on the average bit rate, to get progressively closer to the target seek time.</span></span> <span data-ttu-id="f0ff1-158"> (演算法類似于二進位搜尋。 ) 反復的搜尋可能需要比使用 Index 物件搜尋更長的時間，因此預設為停用。</span><span class="sxs-lookup"><span data-stu-id="f0ff1-158">(The algorithm is similar to a binary search.) Iterative seeking can take longer than seeking by using the Index Object, so it is disabled by default.</span></span> <span data-ttu-id="f0ff1-159">如果設定此屬性，請使用下列屬性來設定搜尋參數： [MFPKEY \_ ASFMediaSource \_ IterativeSeek \_ Max \_ Count](mfpkey-asfmediasource-iterativeseek-max-count.md)[MFPKEY \_ ASFMediaSource \_ IterativeSeek \_ 容忍度（ \_ \_ 毫秒）](mfpkey-asfmediasource-iterativeseek-tolerance-in-millisecond.md)。</span><span class="sxs-lookup"><span data-stu-id="f0ff1-159">If you set this property, use the following properties to set the search parameters: [MFPKEY\_ASFMediaSource\_IterativeSeek\_Max\_Count](mfpkey-asfmediasource-iterativeseek-max-count.md)[MFPKEY\_ASFMediaSource\_IterativeSeek\_Tolerance\_In\_MilliSecond](mfpkey-asfmediasource-iterativeseek-tolerance-in-millisecond.md).</span></span> <span data-ttu-id="f0ff1-160">這些屬性會分別設定反覆運算次數和容錯值的最大數目。</span><span class="sxs-lookup"><span data-stu-id="f0ff1-160">These properties set the maximum number of iterations and the tolerance, respectively.</span></span> <span data-ttu-id="f0ff1-161">當演算法達到反覆運算次數上限時，或當它找到的封包與搜尋時間的距離在指定的容錯範圍內時，就會中止。</span><span class="sxs-lookup"><span data-stu-id="f0ff1-161">The algorithm halts when it reaches the maximum number of iterations, or when it finds a packet whose distance from the seek time is within the specified tolerance.</span></span>

<span data-ttu-id="f0ff1-162">總而言之，當 ASF 檔案未包含 ASF 索引物件時，應用程式可以選擇近似值或反復搜尋。</span><span class="sxs-lookup"><span data-stu-id="f0ff1-162">In a nutshell, the application has the option of choosing approximate or iterative seeking when the ASF file does not contain an ASF Index Object.</span></span>

## <a name="asf-media-source-object-model"></a><span data-ttu-id="f0ff1-163">ASF 媒體來源物件模型</span><span class="sxs-lookup"><span data-stu-id="f0ff1-163">ASF Media Source Object Model</span></span>

<span data-ttu-id="f0ff1-164">ASF 媒體來源會實 [**IMFMediaSource**](/windows/desktop/api/mfidl/nn-mfidl-imfmediasource) 介面並公開下列介面。</span><span class="sxs-lookup"><span data-stu-id="f0ff1-164">The ASF media source implements the [**IMFMediaSource**](/windows/desktop/api/mfidl/nn-mfidl-imfmediasource) interface and exposes the following interfaces.</span></span> <span data-ttu-id="f0ff1-165">應用程式可以藉由呼叫 ASF 媒體來源上的 **IMFMediaSource：： QueryInterface** 來取得這些介面的參考。</span><span class="sxs-lookup"><span data-stu-id="f0ff1-165">An application can get a reference to these interfaces by calling **IMFMediaSource::QueryInterface** on the ASF media source.</span></span>



| <span data-ttu-id="f0ff1-166">介面</span><span class="sxs-lookup"><span data-stu-id="f0ff1-166">Interface</span></span>                                                | <span data-ttu-id="f0ff1-167">描述</span><span class="sxs-lookup"><span data-stu-id="f0ff1-167">Description</span></span>                                                                                                                                        |
|----------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="f0ff1-168">**IMFMediaSource**</span><span class="sxs-lookup"><span data-stu-id="f0ff1-168">**IMFMediaSource**</span></span>](/windows/desktop/api/mfidl/nn-mfidl-imfmediasource)                 | <span data-ttu-id="f0ff1-169">所有媒體來源都需要。</span><span class="sxs-lookup"><span data-stu-id="f0ff1-169">Required for all media sources.</span></span>                                                                                                                    |
| [<span data-ttu-id="f0ff1-170">**IMFMediaEventGenerator**</span><span class="sxs-lookup"><span data-stu-id="f0ff1-170">**IMFMediaEventGenerator**</span></span>](/windows/desktop/api/mfobjects/nn-mfobjects-imfmediaeventgenerator) | <span data-ttu-id="f0ff1-171">所有媒體來源都需要。</span><span class="sxs-lookup"><span data-stu-id="f0ff1-171">Required for all media sources.</span></span> <span data-ttu-id="f0ff1-172">允許應用程式透過媒體會話從媒體來源取得事件。</span><span class="sxs-lookup"><span data-stu-id="f0ff1-172">Allows applications to get events from the media source through the Media Session.</span></span>                                 |
| [<span data-ttu-id="f0ff1-173">**IMFGetService**</span><span class="sxs-lookup"><span data-stu-id="f0ff1-173">**IMFGetService**</span></span>](/windows/desktop/api/mfidl/nn-mfidl-imfgetservice)                   | <span data-ttu-id="f0ff1-174">查詢指定服務介面的媒體來源。</span><span class="sxs-lookup"><span data-stu-id="f0ff1-174">Queries the media source for the specified service interface.</span></span>                                                                                      |
| [<span data-ttu-id="f0ff1-175">**IPropertyStore**</span><span class="sxs-lookup"><span data-stu-id="f0ff1-175">**IPropertyStore**</span></span>](/windows/win32/api/propsys/nn-propsys-ipropertystore)               | <span data-ttu-id="f0ff1-176">設定並取得媒體來源的屬性。</span><span class="sxs-lookup"><span data-stu-id="f0ff1-176">Sets and gets properties on the media source.</span></span> <span data-ttu-id="f0ff1-177">每個屬性都包含描述性名稱和值。</span><span class="sxs-lookup"><span data-stu-id="f0ff1-177">Each property contains a descriptive name and a value.</span></span>                                               |
| [<span data-ttu-id="f0ff1-178">**IMFMetadata**</span><span class="sxs-lookup"><span data-stu-id="f0ff1-178">**IMFMetadata**</span></span>](/windows/desktop/api/mfidl/nn-mfidl-imfmetadata)                       | <span data-ttu-id="f0ff1-179">描述 ASF 檔案的中繼資料。</span><span class="sxs-lookup"><span data-stu-id="f0ff1-179">Describes the metadata for the ASF file.</span></span>                                                                                                           |
| [<span data-ttu-id="f0ff1-180">**IMFMetadataProvider**</span><span class="sxs-lookup"><span data-stu-id="f0ff1-180">**IMFMetadataProvider**</span></span>](/windows/desktop/api/mfidl/nn-mfidl-imfmetadataprovider)       | <span data-ttu-id="f0ff1-181">取得中繼資料的集合，不論是針對整個簡報，或是簡報中的一個資料流程。</span><span class="sxs-lookup"><span data-stu-id="f0ff1-181">Retrieves a collection of metadata, either for an entire presentation, or for one stream in the presentation.</span></span>                                      |
| [<span data-ttu-id="f0ff1-182">**IMFRateSupport**</span><span class="sxs-lookup"><span data-stu-id="f0ff1-182">**IMFRateSupport**</span></span>](/windows/desktop/api/mfidl/nn-mfidl-imfratesupport)                 | <span data-ttu-id="f0ff1-183">查詢支援的播放率範圍，包括反向播放。</span><span class="sxs-lookup"><span data-stu-id="f0ff1-183">Queries the range of playback rates that are supported, including reverse playback.</span></span>                                                                |
| [<span data-ttu-id="f0ff1-184">**IMFRateControl**</span><span class="sxs-lookup"><span data-stu-id="f0ff1-184">**IMFRateControl**</span></span>](/windows/desktop/api/mfidl/nn-mfidl-imfratecontrol)                 | <span data-ttu-id="f0ff1-185">取得或設定播放速率。</span><span class="sxs-lookup"><span data-stu-id="f0ff1-185">Gets or sets the playback rate.</span></span>                                                                                                                    |
| [<span data-ttu-id="f0ff1-186">**IMFTrustedInput**</span><span class="sxs-lookup"><span data-stu-id="f0ff1-186">**IMFTrustedInput**</span></span>](/windows/desktop/api/mfidl/nn-mfidl-imftrustedinput)               | <span data-ttu-id="f0ff1-187">取得來源中包含之每個 ASF 資料流程的 ITA。</span><span class="sxs-lookup"><span data-stu-id="f0ff1-187">Gets the ITA for each of the ASF streams contained in the source.</span></span>                                                                                  |
| [<span data-ttu-id="f0ff1-188">**IMFPMPClient**</span><span class="sxs-lookup"><span data-stu-id="f0ff1-188">**IMFPMPClient**</span></span>](/windows/desktop/api/mfidl/nn-mfidl-imfpmpclient)                     | <span data-ttu-id="f0ff1-189">讓媒體來源接收指向 [**IMFPMPHost**](/windows/desktop/api/mfidl/nn-mfidl-imfpmphost) 介面的指標，該介面是用來在 PMP 進程中建立物件。</span><span class="sxs-lookup"><span data-stu-id="f0ff1-189">Enables a media source to receive a pointer to the [**IMFPMPHost**](/windows/desktop/api/mfidl/nn-mfidl-imfpmphost) interface, which is used to create objects in the PMP process.</span></span> |
| [<span data-ttu-id="f0ff1-190">**IMFTimecodeTranslate**</span><span class="sxs-lookup"><span data-stu-id="f0ff1-190">**IMFTimecodeTranslate**</span></span>](/windows/desktop/api/mfidl/nn-mfidl-imftimecodetranslate)     | <span data-ttu-id="f0ff1-191">轉換運動圖片和電視工程師 (的) 時間碼和 100-納秒時間單位。</span><span class="sxs-lookup"><span data-stu-id="f0ff1-191">Converts between Society of Motion Picture and Television Engineers (SMPTE) time codes and 100-nanosecond time units.</span></span>                              |



 

## <a name="asf-media-source-services"></a><span data-ttu-id="f0ff1-192">ASF 媒體來源服務</span><span class="sxs-lookup"><span data-stu-id="f0ff1-192">ASF Media Source Services</span></span>

<span data-ttu-id="f0ff1-193">ASF 媒體來源提供適用于 ASF 檔案範圍的各種服務。</span><span class="sxs-lookup"><span data-stu-id="f0ff1-193">The ASF media source provides various services that are scoped for ASF file.</span></span> <span data-ttu-id="f0ff1-194">若要取得特定服務的指標，應用程式必須在呼叫 [**MFGetService**](/windows/desktop/api/mfidl/nf-mfidl-mfgetservice)時，使用下列其中一個服務識別碼。</span><span class="sxs-lookup"><span data-stu-id="f0ff1-194">To get a pointer to a particular service, the application must use one of the following service identifiers in its call to [**MFGetService**](/windows/desktop/api/mfidl/nf-mfidl-mfgetservice).</span></span> <span data-ttu-id="f0ff1-195">如需詳細資訊，請參閱 [服務介面](service-interfaces.md)。</span><span class="sxs-lookup"><span data-stu-id="f0ff1-195">For information, see [Service Interfaces](service-interfaces.md).</span></span>



| <span data-ttu-id="f0ff1-196">服務識別碼</span><span class="sxs-lookup"><span data-stu-id="f0ff1-196">Service Identifier</span></span>               | <span data-ttu-id="f0ff1-197">Description</span><span class="sxs-lookup"><span data-stu-id="f0ff1-197">Description</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|----------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="f0ff1-198">MF \_ 速率 \_ 控制 \_ 服務</span><span class="sxs-lookup"><span data-stu-id="f0ff1-198">MF\_RATE\_CONTROL\_SERVICE</span></span>       | <span data-ttu-id="f0ff1-199">藉由使用此識別碼，應用程式可以取得 [**IMFRateSupport**](/windows/desktop/api/mfidl/nn-mfidl-imfratesupport) 或 [**IMFRateControl**](/windows/desktop/api/mfidl/nn-mfidl-imfratecontrol) 介面的指標。</span><span class="sxs-lookup"><span data-stu-id="f0ff1-199">By using this identifier, an application can get a pointer to either [**IMFRateSupport**](/windows/desktop/api/mfidl/nn-mfidl-imfratesupport) or [**IMFRateControl**](/windows/desktop/api/mfidl/nn-mfidl-imfratecontrol) interfaces.</span></span> <span data-ttu-id="f0ff1-200">藉由使用媒體來源所實行的速率支持對象，應用程式可以檢查基礎 ASF 媒體檔案是否支援特定的速率，同時也能取得最快且最慢的速率。</span><span class="sxs-lookup"><span data-stu-id="f0ff1-200">By using the rate support object implemented by the media source, the application can check if a particular rate is supported by the underlying ASF media file also get the fastest and the slowest rate.</span></span> <span data-ttu-id="f0ff1-201">藉由使用速率控制物件，應用程式可以取得並設定播放速率。</span><span class="sxs-lookup"><span data-stu-id="f0ff1-201">By using the rate control object the application can get and set the playback rate.</span></span> <span data-ttu-id="f0ff1-202">如果應用程式指定播放的特定速率，ASF 媒體來源會先檢查要求的速率是否在速率限制內 (由 fasted 和最慢的速率決定) 然後設定速率。</span><span class="sxs-lookup"><span data-stu-id="f0ff1-202">If the application specifies a particular rate for playback, the ASF media source first checks if the requested rate is within the rate limits (determined by fasted and slowest rates) and then sets the rate.</span></span> <span data-ttu-id="f0ff1-203">這不會檢查變數條件，因為位元速率可能會因為網路頻寬而變更。</span><span class="sxs-lookup"><span data-stu-id="f0ff1-203">This does not check for variable conditions as the bitrate might change any moment depending on the network bandwidth.</span></span> <span data-ttu-id="f0ff1-204">如需詳細資訊，請按 [速率控制](rate-control.md)。</span><span class="sxs-lookup"><span data-stu-id="f0ff1-204">For more information, [Rate Control](rate-control.md).</span></span> |
| <span data-ttu-id="f0ff1-205">MF \_ 中繼資料 \_ 提供者 \_ 服務</span><span class="sxs-lookup"><span data-stu-id="f0ff1-205">MF\_METADATA\_PROVIDER\_SERVICE</span></span>  | <span data-ttu-id="f0ff1-206">藉由使用此識別碼，應用程式可以取得 ASF 媒體來源之 [**IMFMetadataProvider**](/windows/desktop/api/mfidl/nn-mfidl-imfmetadataprovider) 介面的指標。</span><span class="sxs-lookup"><span data-stu-id="f0ff1-206">By using this identifier, the application can get a pointer to the [**IMFMetadataProvider**](/windows/desktop/api/mfidl/nn-mfidl-imfmetadataprovider) interface of the ASF media source.</span></span> <span data-ttu-id="f0ff1-207">此介面可讓您存取 ASF 檔案的相關資訊，尤其是 ASF 標頭物件和媒體內容中包含的串流。</span><span class="sxs-lookup"><span data-stu-id="f0ff1-207">This interface provides access to information about ASF file specifically the ASF Header Objects and the streams contained within the media content.</span></span> <span data-ttu-id="f0ff1-208">標頭資訊是透過呈現描述元屬性公開，而資料流程資訊則是透過資料流程描述元屬性提供。</span><span class="sxs-lookup"><span data-stu-id="f0ff1-208">Header information is exposes through presentation descriptor attributes and stream information is provided through stream descriptor attributes.</span></span> <span data-ttu-id="f0ff1-209">如需這些屬性的詳細資訊，請參閱 [媒體基礎 ASF 標頭物件的屬性](media-foundation-attributes-for-asf-header-objects.md)。</span><span class="sxs-lookup"><span data-stu-id="f0ff1-209">For more information about these attributes, see [Media Foundation Attributes for ASF Header Objects](media-foundation-attributes-for-asf-header-objects.md).</span></span> <span data-ttu-id="f0ff1-210">除了透過屬性公開的資訊之外，還存在描述中繼資料（設定為屬性）。</span><span class="sxs-lookup"><span data-stu-id="f0ff1-210">In addition to information that is exposed through attributes, there also exists descriptive metadata, which are set as properties.</span></span>                                                                                                 |
| <span data-ttu-id="f0ff1-211">MF \_ 屬性 \_ 處理常式 \_ 服務</span><span class="sxs-lookup"><span data-stu-id="f0ff1-211">MF\_PROPERTY\_HANDLER\_SERVICE</span></span>   | <span data-ttu-id="f0ff1-212">藉由使用此識別碼，應用程式可以取得 ASF 媒體來源之 [**IPropertyStore**](/windows/win32/api/propsys/nn-propsys-ipropertystore) 介面的指標。</span><span class="sxs-lookup"><span data-stu-id="f0ff1-212">By using this identifier, the application can get a pointer to the [**IPropertyStore**](/windows/win32/api/propsys/nn-propsys-ipropertystore) interface of the ASF media source.</span></span> <span data-ttu-id="f0ff1-213">屬性存放區包含與 ASF 檔案相關的所有中繼資料。</span><span class="sxs-lookup"><span data-stu-id="f0ff1-213">The property store contains all the metadata related to the ASF file.</span></span> <span data-ttu-id="f0ff1-214">此識別碼是 Windows 7 中的新識別碼，取代了 \_ \_ \_ 用於取得中繼資料屬性的 MF 中繼資料提供者服務。</span><span class="sxs-lookup"><span data-stu-id="f0ff1-214">This identifier is new in Windows 7 and replaces MF\_METADATA\_PROVIDER\_SERVICE for getting metadata properties.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| <span data-ttu-id="f0ff1-215">MFNETSOURCE \_ 統計資料 \_ 服務</span><span class="sxs-lookup"><span data-stu-id="f0ff1-215">MFNETSOURCE\_STATISTICS\_SERVICE</span></span> | <span data-ttu-id="f0ff1-216">如需詳細資訊，請參閱在 [用戶端記錄](client-logging.md)中取出網路統計資料。</span><span class="sxs-lookup"><span data-stu-id="f0ff1-216">For more information, see Retrieving Network Statistics in [Client Logging](client-logging.md).</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| <span data-ttu-id="f0ff1-217">MF 時間 \_ 碼 \_ 服務</span><span class="sxs-lookup"><span data-stu-id="f0ff1-217">MF\_TIMECODE\_SERVICE</span></span>            | <span data-ttu-id="f0ff1-218">藉由使用此識別碼，應用程式可以取得媒體來源 [**IMFTimecodeTranslate**](/windows/desktop/api/mfidl/nn-mfidl-imftimecodetranslate) 介面的指標。</span><span class="sxs-lookup"><span data-stu-id="f0ff1-218">By using this identifier, the application can get a pointer to the media source’s [**IMFTimecodeTranslate**](/windows/desktop/api/mfidl/nn-mfidl-imftimecodetranslate) interface.</span></span> <span data-ttu-id="f0ff1-219">這種實現可用來執行時間程式碼轉譯，例如將 SMPTE 時間代碼轉換為 100-nano 秒單位及背面。</span><span class="sxs-lookup"><span data-stu-id="f0ff1-219">This implementation can be used to perform time code translations such as converting SMPTE time code to 100-nano second units and back.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |



 

### <a name="timecode-translation"></a><span data-ttu-id="f0ff1-220">時間碼轉譯</span><span class="sxs-lookup"><span data-stu-id="f0ff1-220">Timecode Translation</span></span>

<span data-ttu-id="f0ff1-221">ASF 媒體來源提供時間程式碼轉譯服務，可讓您的應用程式將 SMPTE 時間代碼轉換為 100-納秒單位) 中最接近的呈現時間 (。</span><span class="sxs-lookup"><span data-stu-id="f0ff1-221">The ASF media source provides a time code translation service that allows your application to convert SMPTE time code to the closest presentation time (in 100-nanosecond unit).</span></span> <span data-ttu-id="f0ff1-222">相反地，應用程式也可以取得要求的呈現時間的時間碼。</span><span class="sxs-lookup"><span data-stu-id="f0ff1-222">Conversely, the application can also get the time code for a requested presentation time.</span></span> <span data-ttu-id="f0ff1-223">服務可透過 [**IMFTimecodeTranslate**](/windows/desktop/api/mfidl/nn-mfidl-imftimecodetranslate) 介面（ASF 媒體來源所實行）來取得。</span><span class="sxs-lookup"><span data-stu-id="f0ff1-223">The service is available through the [**IMFTimecodeTranslate**](/windows/desktop/api/mfidl/nn-mfidl-imftimecodetranslate) interface, which the ASF media source implements.</span></span> <span data-ttu-id="f0ff1-224">這個介面指標上的方法呼叫是非同步，可從您的主應用程式執行緒執行，而不會封鎖應用程式的使用者介面。</span><span class="sxs-lookup"><span data-stu-id="f0ff1-224">The method calls on this interface pointer are asynchronous that can run from your main application thread without blocking the user interface of your application.</span></span>

<span data-ttu-id="f0ff1-225">下列步驟摘要說明時間程式碼轉譯的程式：</span><span class="sxs-lookup"><span data-stu-id="f0ff1-225">The following steps summarize the procedure for time code translation:</span></span>

1.  <span data-ttu-id="f0ff1-226">藉由呼叫 [**MFGetService**](/windows/desktop/api/mfidl/nf-mfidl-mfgetservice)並指定 **MF 時間 \_ 碼 \_ 服務** 識別碼，取得 ASF 媒體來源 [**IMFTimecodeTranslate**](/windows/desktop/api/mfidl/nn-mfidl-imftimecodetranslate)介面的指標。</span><span class="sxs-lookup"><span data-stu-id="f0ff1-226">Get pointer to the [**IMFTimecodeTranslate**](/windows/desktop/api/mfidl/nn-mfidl-imftimecodetranslate) interface of the ASF media source by calling [**MFGetService**](/windows/desktop/api/mfidl/nf-mfidl-mfgetservice) and specifying the **MF\_TIMECODE\_SERVICE** identifier.</span></span>
2.  <span data-ttu-id="f0ff1-227">呼叫 [**IMFTimecodeTranslate：： BeginConvertTimecodeToHNS**](/windows/desktop/api/mfidl/nf-mfidl-imftimecodetranslate-beginconverttimecodetohns) 或 [**IMFTimecodeTranslate：： BeginConvertHNSToTimecode**](/windows/desktop/api/mfidl/nf-mfidl-imftimecodetranslate-beginconverthnstotimecode) ，並指定要轉譯的時間。</span><span class="sxs-lookup"><span data-stu-id="f0ff1-227">Call [**IMFTimecodeTranslate::BeginConvertTimecodeToHNS**](/windows/desktop/api/mfidl/nf-mfidl-imftimecodetranslate-beginconverttimecodetohns) or [**IMFTimecodeTranslate::BeginConvertHNSToTimecode**](/windows/desktop/api/mfidl/nf-mfidl-imftimecodetranslate-beginconverthnstotimecode) and specify the time that is to be translated..</span></span> <span data-ttu-id="f0ff1-228">若為 **BeginConvertTimecodeToHNS** ，必須將時間代碼指定為具有 **VT \_ I8** 資料類型的 [**PROPVARIANT**](/windows/win32/api/propidl/ns-propidl-propvariant)變數。</span><span class="sxs-lookup"><span data-stu-id="f0ff1-228">For **BeginConvertTimecodeToHNS** the time code must be specified as a [**PROPVARIANT**](/windows/win32/api/propidl/ns-propidl-propvariant) variable with **VT\_I8** data type.</span></span> <span data-ttu-id="f0ff1-229">**BeginConvertHNSToTimecode** 方法所需的時間是 100-納秒的單位做為 [**MFTIME**](mftime.md)類型。</span><span class="sxs-lookup"><span data-stu-id="f0ff1-229">The **BeginConvertHNSToTimecode** method requires the time in 100-nanosecond units as the [**MFTIME**](mftime.md) type.</span></span>
3.  <span data-ttu-id="f0ff1-230">適當地呼叫 [**IMFTimecodeTranslate：： EndConvertTimecodeToHNS**](/windows/desktop/api/mfidl/nf-mfidl-imftimecodetranslate-endconverttimecodetohns) 或 **IMFTimecodeTranslate：： EndConvertTimecodeToHNS** 來完成非同步作業。</span><span class="sxs-lookup"><span data-stu-id="f0ff1-230">Complete the asynchronous operation by calling [**IMFTimecodeTranslate::EndConvertTimecodeToHNS**](/windows/desktop/api/mfidl/nf-mfidl-imftimecodetranslate-endconverttimecodetohns) or **IMFTimecodeTranslate::EndConvertTimecodeToHNS** appropriately.</span></span>

<span data-ttu-id="f0ff1-231">在建立媒體來源期間，來源解析程式會建立檔案的位元組資料流程，媒體來源會從該檔案讀取 ASF 內容。</span><span class="sxs-lookup"><span data-stu-id="f0ff1-231">During the creation of the media source, the source resolver creates a byte stream for the file from which the media source reads the ASF content.</span></span> <span data-ttu-id="f0ff1-232">為了讓時間轉換成功，與 ASF 檔案相關聯的位元組資料流程必須具備搜尋功能;否則，應用程式 \_ \_ \_ 會 \_ 從 **開始 ...** 呼叫取得 MF E BYTESTREAM 無法搜尋的錯誤。</span><span class="sxs-lookup"><span data-stu-id="f0ff1-232">In order for the time conversions to be successful, the byte stream associated with the ASF file must have seeking capabilities; otherwise, the application gets the MF\_E\_BYTESTREAM\_NOT\_SEEKABLE error from the **Begin...** call.</span></span> <span data-ttu-id="f0ff1-233">時間轉換的另一項需求是，asf 檔案（以 ASF 媒體來源表示）必須具有 ASF 索引物件。</span><span class="sxs-lookup"><span data-stu-id="f0ff1-233">Another requirement for time conversions is that the ASF file, represented by the ASF media source, must have ASF Index Objects.</span></span> <span data-ttu-id="f0ff1-234">系統會從可維護所有索引的 ASF 索引物件和 ASF 檔案的對應搜尋點解壓縮呈現時間和時間碼。</span><span class="sxs-lookup"><span data-stu-id="f0ff1-234">The presentation times and the time codes are extracted from the ASF Index Objects that maintain all the indexes and the corresponding seek- points for the ASF file.</span></span> <span data-ttu-id="f0ff1-235">針對簡報時間程式碼轉譯，ASF 檔案必須包含簡單的索引物件;對於時間代碼對簡報時間轉譯，ASF 檔案必須有 Index 物件。</span><span class="sxs-lookup"><span data-stu-id="f0ff1-235">For presentation time-to-time code translation, the ASF file must contain a Simple Index Object; for time code-to-presentation time translation, the ASF file must have an Index Object.</span></span> <span data-ttu-id="f0ff1-236">轉換作業依賴基礎 *索引子* (WMContainer 元件) 來剖析和讀取與 ASF 檔案相關聯的索引物件。</span><span class="sxs-lookup"><span data-stu-id="f0ff1-236">The conversion operations rely on the underlying *indexer* (WMContainer component) to parse and read the Index Object associated with the ASF file.</span></span> <span data-ttu-id="f0ff1-237">如果檔案不包含索引物件，應用程式會以非同步方式接收 MF \_ E \_ NO \_ index 錯誤碼。</span><span class="sxs-lookup"><span data-stu-id="f0ff1-237">If the file does not contain an Index Object, the application asynchronously receives the MF\_E\_NO\_INDEX error code.</span></span>

<span data-ttu-id="f0ff1-238">為了轉譯應用程式所要求的時間，媒體來源會列舉檔案內的資料流程，並尋找包含適當 ASF 索引物件的資料流程。</span><span class="sxs-lookup"><span data-stu-id="f0ff1-238">To translate the time requested by the application, the media source enumerates the streams within the file and finds the stream that contains the appropriate ASF Index Object.</span></span> <span data-ttu-id="f0ff1-239">如果找到這類串流，媒體來源會剖析串流的 ASF 封包，直到到達正確的時間碼為止。</span><span class="sxs-lookup"><span data-stu-id="f0ff1-239">If such a stream is found, the media source parses the stream’s ASF packets are parsed until the correct time code is reached.</span></span> <span data-ttu-id="f0ff1-240">找到正確的範例之後，它會從範例中取出對應的呈現時間或時間代碼，然後將它傳回給呼叫者。</span><span class="sxs-lookup"><span data-stu-id="f0ff1-240">After it finds the correct sample it retrieves the corresponding presentation time or the time code from the sample, and returns it to the caller.</span></span>

### <a name="script-command-support"></a><span data-ttu-id="f0ff1-241">指令碼命令支援</span><span class="sxs-lookup"><span data-stu-id="f0ff1-241">Script Command Support</span></span>

<span data-ttu-id="f0ff1-242">當您建立包含腳本資料流程的 ASF 拓撲時，腳本資料流程節點會加入拓撲中。</span><span class="sxs-lookup"><span data-stu-id="f0ff1-242">When you build an ASF topology that contains a script stream a Script Stream node is added to the topology.</span></span> <span data-ttu-id="f0ff1-243">此節點會在適當的時間傳送 IMFSamples。</span><span class="sxs-lookup"><span data-stu-id="f0ff1-243">This node will send IMFSamples at the appropriate time.</span></span> <span data-ttu-id="f0ff1-244">腳本來源節點所提供的 IMFSample 會將資料儲存在與範例相關聯的 IMFMediaBuffer 中。</span><span class="sxs-lookup"><span data-stu-id="f0ff1-244">The IMFSample provided by the script source node stores the data in the IMFMediaBuffer associated with the sample.</span></span> <span data-ttu-id="f0ff1-245">您可以在範例上呼叫 CopyToBuffer 來取得 IMFMediaBuffer，然後呼叫緩衝區上的鎖定來取得資料。</span><span class="sxs-lookup"><span data-stu-id="f0ff1-245">You can call CopyToBuffer on the sample to get an IMFMediaBuffer and then call Lock on the buffer to get the data.</span></span> 

<span data-ttu-id="f0ff1-246">腳本資料流程承載會以類型字串的形式封裝到緩衝區中，後面接著 Null、命令字串，後面接著 Null。</span><span class="sxs-lookup"><span data-stu-id="f0ff1-246">Script stream payloads are packed into the buffer as a type string, followed by NULL, followed by the command string, followed by NULL.</span></span> <span data-ttu-id="f0ff1-247">字串是具有 ASF 格式的 Unicode。</span><span class="sxs-lookup"><span data-stu-id="f0ff1-247">Strings are Unicode in the ASF format.</span></span>

<span data-ttu-id="f0ff1-248">例如，承載可能看起來如下 (其中 \ 0 表示 Null 字元) ：</span><span class="sxs-lookup"><span data-stu-id="f0ff1-248">For example, a payload might look like the following (where \0 indicates a NULL character):</span></span>

<span data-ttu-id="f0ff1-249">*URL\0http://contoso.com\0*</span><span class="sxs-lookup"><span data-stu-id="f0ff1-249">*URL\0http://contoso.com\0*</span></span>

<span data-ttu-id="f0ff1-250">*Text\0This 是 caption\0*</span><span class="sxs-lookup"><span data-stu-id="f0ff1-250">*Text\0This is a caption\0*</span></span>



## <a name="related-topics"></a><span data-ttu-id="f0ff1-251">相關主題</span><span class="sxs-lookup"><span data-stu-id="f0ff1-251">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="f0ff1-252">管線層 ASF 元件</span><span class="sxs-lookup"><span data-stu-id="f0ff1-252">Pipeline Layer ASF Components</span></span>](pipeline-layer-asf-components.md)
</dt> <dt>

[<span data-ttu-id="f0ff1-253">媒體基礎中的 ASF 支援</span><span class="sxs-lookup"><span data-stu-id="f0ff1-253">ASF Support in Media Foundation</span></span>](asf-support-in-media-foundation.md)
</dt> </dl>

 

 
