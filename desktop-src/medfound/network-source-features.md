---
description: 網路來源功能
ms.assetid: a4e20ecb-c145-4823-ae59-f6fc88593d86
title: 網路來源功能
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 8e937a97cf743740d9cebf84ad477c52cdee5083
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/07/2021
ms.locfileid: "104562782"
---
# <a name="network-source-features"></a><span data-ttu-id="4a82a-103">網路來源功能</span><span class="sxs-lookup"><span data-stu-id="4a82a-103">Network Source Features</span></span>

<span data-ttu-id="4a82a-104">網路來源提供串流處理媒體檔案的基底執行，並公開 [**IMFMediaSource**](/windows/desktop/api/mfidl/nn-mfidl-imfmediasource) 介面。</span><span class="sxs-lookup"><span data-stu-id="4a82a-104">The network source provides the base implementation for streaming media files and exposes the [**IMFMediaSource**](/windows/desktop/api/mfidl/nn-mfidl-imfmediasource) interface.</span></span> <span data-ttu-id="4a82a-105">特定網路來源的執行取決於用來開啟來源的通訊協定（例如 RTSP 或 HTTP）。</span><span class="sxs-lookup"><span data-stu-id="4a82a-105">The specific network source implementation depends on the protocol used to open the source such as RTSP or HTTP.</span></span> <span data-ttu-id="4a82a-106">通訊協定特定的網路來源會擴充基本網路功能。</span><span class="sxs-lookup"><span data-stu-id="4a82a-106">The protocol-specific network sources extend the basic network functionality.</span></span> <span data-ttu-id="4a82a-107">如需支援的配置和通訊協定的相關資訊，請參閱 [支援的通訊協定](supported-protocols.md)。</span><span class="sxs-lookup"><span data-stu-id="4a82a-107">For information about the supported schemes and protocols, see [Supported Protocols](supported-protocols.md).</span></span>

<span data-ttu-id="4a82a-108">網路來源：</span><span class="sxs-lookup"><span data-stu-id="4a82a-108">The network source:</span></span>

-   <span data-ttu-id="4a82a-109">會執行快取、proxy 偵測和自動重新連接等功能。</span><span class="sxs-lookup"><span data-stu-id="4a82a-109">Implements features such as caching, proxy detection, and auto-reconnection.</span></span>
-   <span data-ttu-id="4a82a-110">將與來源解析程式通訊協定無關的呼叫轉換為通訊協定特定的呼叫。</span><span class="sxs-lookup"><span data-stu-id="4a82a-110">Converts protocol-independent calls from the source resolver to protocol-specific calls.</span></span>
-   <span data-ttu-id="4a82a-111">與通訊端層和作業系統互動。</span><span class="sxs-lookup"><span data-stu-id="4a82a-111">Interacts with the socket layer and the operating system.</span></span> <span data-ttu-id="4a82a-112">剖析 SDP 描述並使用它作為設定資料，並從基礎通訊端層讀取串流資料。</span><span class="sxs-lookup"><span data-stu-id="4a82a-112">Parses the SDP description and uses it as configuration data, and reads stream data from the underlying sockets layer.</span></span> <span data-ttu-id="4a82a-113">接收時，網路來源負責重新排列和要求重新傳輸封包。</span><span class="sxs-lookup"><span data-stu-id="4a82a-113">When receiving, the network source is responsible for reordering and requesting retransmissions of packets.</span></span>

## <a name="network-source-creation"></a><span data-ttu-id="4a82a-114">建立網路來源</span><span class="sxs-lookup"><span data-stu-id="4a82a-114">Network Source Creation</span></span>

<span data-ttu-id="4a82a-115">從網路建立來源的媒體來源與本機檔案的媒體來源不同。</span><span class="sxs-lookup"><span data-stu-id="4a82a-115">Creating a media source for a source from the network is not different from a media source for a local file.</span></span> <span data-ttu-id="4a82a-116">應用程式會將來源的 URL 傳遞至 [來源解析程式](source-resolver.md) 方法（例如 [**IMFSourceResolver：： CreateObjectFromURL**](/windows/desktop/api/mfidl/nf-mfidl-imfsourceresolver-createobjectfromurl) 或 [**IMFSourceResolver：： BEGINCREATEOBJECTFROMURL**](/windows/desktop/api/mfidl/nf-mfidl-imfsourceresolver-begincreateobjectfromurl) ），並指定 MF \_ 解析 \_ MEDIASOURCE 旗標。</span><span class="sxs-lookup"><span data-stu-id="4a82a-116">The application passes the URL for the source to [Source Resolver](source-resolver.md) methods such as [**IMFSourceResolver::CreateObjectFromURL**](/windows/desktop/api/mfidl/nf-mfidl-imfsourceresolver-createobjectfromurl) or [**IMFSourceResolver::BeginCreateObjectFromURL**](/windows/desktop/api/mfidl/nf-mfidl-imfsourceresolver-begincreateobjectfromurl) and specifies the MF\_RESOLUTION\_MEDIASOURCE flag.</span></span> <span data-ttu-id="4a82a-117">如需使用此旗標的詳細資訊，請參閱 [使用來源解析程式](using-the-source-resolver.md)。</span><span class="sxs-lookup"><span data-stu-id="4a82a-117">For more information about using this flag, see [Using the Source Resolver](using-the-source-resolver.md).</span></span>

<span data-ttu-id="4a82a-118">來源解析程式會根據應用程式所提供的配置，載入適當的配置處理常式物件，此物件會公開 [**IMFSchemeHandler**](/windows/desktop/api/mfidl/nn-mfidl-imfschemehandler) 介面。</span><span class="sxs-lookup"><span data-stu-id="4a82a-118">Depending on the scheme provided by the application, the source resolver loads the appropriate the scheme handler object, which exposes the [**IMFSchemeHandler**](/windows/desktop/api/mfidl/nn-mfidl-imfschemehandler) interface.</span></span> <span data-ttu-id="4a82a-119">應用程式也可以藉由呼叫 [**IMFSchemeHandler：： BeginCreateObject**](/windows/desktop/api/mfidl/nf-mfidl-imfschemehandler-begincreateobject)，直接使用配置處理常式來建立網路來源。</span><span class="sxs-lookup"><span data-stu-id="4a82a-119">The application can also use the scheme handler directly to create the network source by calling [**IMFSchemeHandler::BeginCreateObject**](/windows/desktop/api/mfidl/nf-mfidl-imfschemehandler-begincreateobject).</span></span>

<span data-ttu-id="4a82a-120">如需詳細資訊，請參閱 [配置處理常式和 Byte-Stream 處理常式](scheme-handlers-and-byte-stream-handlers.md)。</span><span class="sxs-lookup"><span data-stu-id="4a82a-120">For more information, see [Scheme Handlers and Byte-Stream Handlers](scheme-handlers-and-byte-stream-handlers.md).</span></span>

<span data-ttu-id="4a82a-121">媒體基礎不支援網路來源的位元組資料流程。</span><span class="sxs-lookup"><span data-stu-id="4a82a-121">Media Foundation does not support byte streams for network sources.</span></span> <span data-ttu-id="4a82a-122">只有下載的內容案例才支援位元組資料流程物件。</span><span class="sxs-lookup"><span data-stu-id="4a82a-122">The byte stream object is only supported in the downloaded content scenario.</span></span> <span data-ttu-id="4a82a-123">所有資料都會儘快傳輸，以便在本機電腦上儲存為檔案。</span><span class="sxs-lookup"><span data-stu-id="4a82a-123">All the data is transmitted as quickly as possible so that it can be saved as a file on the local machine.</span></span> <span data-ttu-id="4a82a-124">web 伺服器提供下載的資料。</span><span class="sxs-lookup"><span data-stu-id="4a82a-124">web servers provide downloaded data.</span></span> <span data-ttu-id="4a82a-125">下載開始之後，就不會從用戶端到伺服器之間進行通訊。</span><span class="sxs-lookup"><span data-stu-id="4a82a-125">There is no communication from the client to the server after the download begins.</span></span> <span data-ttu-id="4a82a-126">在此情況下，會使用 HTTP 下載通訊協定。</span><span class="sxs-lookup"><span data-stu-id="4a82a-126">In this case the HTTP download protocol is used.</span></span>

<span data-ttu-id="4a82a-127">如果應用程式要求來源解析程式為 "HTTP："、"mms：" 或 "rtsp：" 配置建立位元組資料流程物件，則呼叫會失敗，並出現 MF \_ E \_ 不支援的 \_ 配置錯誤。</span><span class="sxs-lookup"><span data-stu-id="4a82a-127">If the application requests the source resolver to create a byte stream object for "http:", "mms:", or "rtsp:" schemes, then the call fails with the MF\_E\_UNSUPPORTED\_SCHEME error.</span></span>

> [!Note]  
> <span data-ttu-id="4a82a-128">在 Windows 7 中，網路來源支援 Windows Media 站檔案 (。.NSC) 。</span><span class="sxs-lookup"><span data-stu-id="4a82a-128">In Windows 7, the network source supports Windows Media Station files (.NSC).</span></span> <span data-ttu-id="4a82a-129">這些檔案是用來透過網路進行媒體內容的多播串流處理。</span><span class="sxs-lookup"><span data-stu-id="4a82a-129">These files are used in multicast streaming of media content over a network.</span></span> <span data-ttu-id="4a82a-130">為指定的建立網路來源。.NSC 檔，應用程式必須使用來源解析程式。</span><span class="sxs-lookup"><span data-stu-id="4a82a-130">To create the network source for a specified .NSC file, the application must use the source resolver.</span></span>

 

<span data-ttu-id="4a82a-131">如果應用程式使用配置處理常式，則非同步呼叫會忽略 *dwFlags* 參數，並在完成時傳回網路來源的指標。</span><span class="sxs-lookup"><span data-stu-id="4a82a-131">If the application is using the scheme handler, then the asynchronous call ignores the *dwFlags* parameter and returns a pointer to the network source on completion.</span></span>

<span data-ttu-id="4a82a-132">下圖顯示使用網路來源進行媒體串流處理的資料流程。</span><span class="sxs-lookup"><span data-stu-id="4a82a-132">The following illustration shows the data flow for media streaming using the network source.</span></span>

![流程圖，顯示從應用程式到串流伺服器的路徑，以及網路來源與媒體會話之間的迴圈](images/3f9186ea-53ed-4a31-a097-92f39fa08624.gif)

## <a name="network-source-configuration"></a><span data-ttu-id="4a82a-134">網路來源設定</span><span class="sxs-lookup"><span data-stu-id="4a82a-134">Network Source Configuration</span></span>

<span data-ttu-id="4a82a-135">本主題說明網路來源所支援的功能，以及相關聯的設定選項。</span><span class="sxs-lookup"><span data-stu-id="4a82a-135">This topic describes the features supported by the network source and the associated configuration options.</span></span> <span data-ttu-id="4a82a-136">應用程式可以在建立網路來源物件時設定網路來源。</span><span class="sxs-lookup"><span data-stu-id="4a82a-136">An application can configure the network source when creating the network source object.</span></span> <span data-ttu-id="4a82a-137">這些選項會儲存在 **IPropertyStore** 物件中，應用程式必須在來源解析程式方法的 *pProps* 參數中傳遞，或 [**IMFSchemeHandler：： BeginCreateObject**](/windows/desktop/api/mfidl/nf-mfidl-imfschemehandler-begincreateobject)。</span><span class="sxs-lookup"><span data-stu-id="4a82a-137">These options are stored in an **IPropertyStore** object, which the application must pass in the *pProps* parameter of the source resolver methods or [**IMFSchemeHandler::BeginCreateObject**](/windows/desktop/api/mfidl/nf-mfidl-imfschemehandler-begincreateobject).</span></span>

### <a name="auto-reconnect"></a><span data-ttu-id="4a82a-138">自動重新連線</span><span class="sxs-lookup"><span data-stu-id="4a82a-138">Auto-Reconnect</span></span>

<span data-ttu-id="4a82a-139">網路來源的自動重新連線功能可讓用戶端在伺服器的 TCP 連線失敗或用戶端無法接收封包時，自動重新連線至媒體伺服器。</span><span class="sxs-lookup"><span data-stu-id="4a82a-139">The auto-reconnect feature of the network source enables a client to reconnect to the media server automatically when the TCP connection to the server fails or the client fails to receive packets.</span></span> <span data-ttu-id="4a82a-140">連接失敗時，網路來源會使用先前連線中使用的相同設定，嘗試重新連線至媒體伺服器。</span><span class="sxs-lookup"><span data-stu-id="4a82a-140">When connection fails, the network source attempts to reconnect to the media server using the same configuration that was used in the previous connection.</span></span> <span data-ttu-id="4a82a-141">重新連接程式是非同步。</span><span class="sxs-lookup"><span data-stu-id="4a82a-141">The reconnection process is asynchronous.</span></span> <span data-ttu-id="4a82a-142">當重新連線時，網路來源會引發 [MEReconnectStart](mereconnectstart.md) 事件，而當重新連線成功或失敗時，則會引發 [MEReconnectEnd](mereconnectend.md) 事件。</span><span class="sxs-lookup"><span data-stu-id="4a82a-142">The network source raises the [MEReconnectStart](mereconnectstart.md) event when it begins reconnection and the [MEReconnectEnd](mereconnectend.md) event when the reconnection succeeds or fails.</span></span>

<span data-ttu-id="4a82a-143">如果重新連接嘗試次數超過 [**MFNETSOURCE \_ AUTORECONNECTLIMIT**](mfnetsource-autoreconnectlimit-property.md) 屬性所指定的最大值，則重新連接作業將會取消。</span><span class="sxs-lookup"><span data-stu-id="4a82a-143">If the number of reconnection attempts exceeds the maximum value specified by the [**MFNETSOURCE\_AUTORECONNECTLIMIT**](mfnetsource-autoreconnectlimit-property.md) property, the reconnection operation is canceled.</span></span> <span data-ttu-id="4a82a-144">重新連接嘗試次數會儲存在 [**MFNETSOURCE \_ AUTORECONNECTPROGRESS**](mfnetsource-autoreconnectprogress-property.md) 屬性中。</span><span class="sxs-lookup"><span data-stu-id="4a82a-144">The number of reconnection attempts is stored in the [**MFNETSOURCE\_AUTORECONNECTPROGRESS**](mfnetsource-autoreconnectprogress-property.md) property.</span></span>

<span data-ttu-id="4a82a-145">自動重新連線可讓媒體內容順暢地播放，即使連至媒體伺服器的 TCP 連線失敗也一樣。</span><span class="sxs-lookup"><span data-stu-id="4a82a-145">Auto-reconnect enables smooth playback of media content even when the TCP connection to the media server fails.</span></span> <span data-ttu-id="4a82a-146">若要順利播放，用戶端的快取中必須有足夠的資料（至少1到2分鐘），才能繼續播放，直到重新連接為止。</span><span class="sxs-lookup"><span data-stu-id="4a82a-146">For a smooth playback experience, the client must have sufficient data, at least 1 to 2 minutes, in its cache to continue playback until reconnection.</span></span> <span data-ttu-id="4a82a-147">可以在 [**MFNETSOURCE \_ MAXBUFFERTIMEMS**](mfnetsource-maxbuffertimems-property.md) 屬性中設定網路來源可以緩衝的最大資料量。</span><span class="sxs-lookup"><span data-stu-id="4a82a-147">The maximum amount of data that the network source can buffer can be set in the [**MFNETSOURCE\_MAXBUFFERTIMEMS**](mfnetsource-maxbuffertimems-property.md) property.</span></span>

### <a name="fast-streaming"></a><span data-ttu-id="4a82a-148">快速串流處理 </span><span class="sxs-lookup"><span data-stu-id="4a82a-148">Fast Streaming</span></span>

<span data-ttu-id="4a82a-149">網路來源用戶端要求伺服器以較快的速率來串流內容開頭的一些資料，而不是由內容位元速率所指定。</span><span class="sxs-lookup"><span data-stu-id="4a82a-149">The network source client requests the server to stream some of the data at the beginning of the content at a faster rate than that specified by the bit rate of the content.</span></span> <span data-ttu-id="4a82a-150">如果伺服器上已啟用 [ *快速啟動* ]，伺服器會傳送加速的位元速率串流，讓用戶端可以更快緩衝足夠的資料量，而非即時。</span><span class="sxs-lookup"><span data-stu-id="4a82a-150">If *Fast Startup* is enabled on the server, the server sends an accelerated bit-rate stream so that the client can buffer a sufficient amount of data faster than in real time.</span></span> <span data-ttu-id="4a82a-151">這可透過將初始緩衝延遲降至最低，進而改善使用者體驗，這可能是因為用戶端電腦或網路的低速度，以及可用的頻寬等各種因素所致。</span><span class="sxs-lookup"><span data-stu-id="4a82a-151">This improves user experience by minimizing initial buffering delays, which can be caused by various factors such as low speed of the client computer or the network, and available bandwidth.</span></span>

<span data-ttu-id="4a82a-152">若要指定用戶端可以要求的快速串流資料量，請設定 [**MFNETSOURCE \_ ACCELERATEDSTREAMINGDURATION**](mfnetsource-acceleratedstreamingduration-property.md) 屬性。</span><span class="sxs-lookup"><span data-stu-id="4a82a-152">To specify the amount of fast-streaming data that the client can request, set the [**MFNETSOURCE\_ACCELERATEDSTREAMINGDURATION**](mfnetsource-acceleratedstreamingduration-property.md) property.</span></span> <span data-ttu-id="4a82a-153">如果網路來源使用 UDP 做為傳輸通訊協定，請改為設定 [**MFNETSOURCE \_ MAXUDPACCELERATEDSTREAMINGDURATION**](mfnetsource-maxudpacceleratedstreamingduration-property.md) 屬性，以指定最大的快速串流資料量。</span><span class="sxs-lookup"><span data-stu-id="4a82a-153">If the network source is using UDP as the transport protocol, specify the maximum amount of fast-streaming data by setting the [**MFNETSOURCE\_MAXUDPACCELERATEDSTREAMINGDURATION**](mfnetsource-maxudpacceleratedstreamingduration-property.md) property instead.</span></span>

<span data-ttu-id="4a82a-154">您也可以透過 *快速快* 取功能，在用戶端上進行快速串流，以比即時串流隨選內容更快，並在用戶端的本機快取上快取資料。</span><span class="sxs-lookup"><span data-stu-id="4a82a-154">Fast streaming on the client is also possible through the *Fast Cache* feature—streaming on-demand content faster than real time and caching data on the client's local cache.</span></span> <span data-ttu-id="4a82a-155">若要使用這種類型的快速串流，必須在網路來源上啟用快速快取，且伺服器必須支援。</span><span class="sxs-lookup"><span data-stu-id="4a82a-155">To use this type of fast streaming, Fast Cache must be enabled on the network source, and the server must support it.</span></span> <span data-ttu-id="4a82a-156">當用戶端從伺服器要求內容時，網路來源會先檢查內容是否已在用戶端的快取中。</span><span class="sxs-lookup"><span data-stu-id="4a82a-156">When the client requests content from the server, the network source first checks to see whether the content is already in the client's cache.</span></span> <span data-ttu-id="4a82a-157">如果內容位於用戶端的本機快取中，而且尚未過期，則會轉譯。</span><span class="sxs-lookup"><span data-stu-id="4a82a-157">If the content is in the client's local cache and has not expired, it is rendered.</span></span> <span data-ttu-id="4a82a-158">如果內容不在本機快取中或已過期，則會串流處理和快取內容，而且網路來源會從本機快取中播放。</span><span class="sxs-lookup"><span data-stu-id="4a82a-158">If the content is not in the local cache or has already expired, the content is streamed and cached, and the network source plays it from the local cache.</span></span> <span data-ttu-id="4a82a-159">在後續的要求中，針對播放清單，只會快取遺漏的專案，然後再播放。</span><span class="sxs-lookup"><span data-stu-id="4a82a-159">In subsequent requests, for playlists, only missing entries are cached and then played.</span></span> <span data-ttu-id="4a82a-160">如果播放清單專案已在用戶端的本機快取中，則會從該處播放，而不會再次快取。</span><span class="sxs-lookup"><span data-stu-id="4a82a-160">If a playlist entry is already in the client's local cache, it is played from there and not cached again.</span></span>

<span data-ttu-id="4a82a-161">依預設，網路來源用戶端上會啟用快速快取。</span><span class="sxs-lookup"><span data-stu-id="4a82a-161">By default, Fast Cache is enabled on the network source client.</span></span> <span data-ttu-id="4a82a-162">但是，下列因素也會決定是否要使用此功能：</span><span class="sxs-lookup"><span data-stu-id="4a82a-162">However, the following factors also determine whether the feature is used:</span></span>

-   <span data-ttu-id="4a82a-163">用戶端必須有額外的頻寬可供下載，且快取內容的速度比一般速度還要快。</span><span class="sxs-lookup"><span data-stu-id="4a82a-163">The client must have extra bandwidth available to download and cache the content faster than the normal speed.</span></span>
-   <span data-ttu-id="4a82a-164">用戶端必須有足夠的磁碟空間。</span><span class="sxs-lookup"><span data-stu-id="4a82a-164">The client must have sufficient disk space.</span></span> <span data-ttu-id="4a82a-165">如果用戶端在快取要求的隨選內容之後，有小於 100 MB 的可用磁碟空間，則不會進行快取，但會同時進行資料流程處理和轉譯。</span><span class="sxs-lookup"><span data-stu-id="4a82a-165">If the client has less than 100 MB of free disk space after caching the requested on-demand content, it is not cached, but is streamed and rendered simultaneously.</span></span>

<span data-ttu-id="4a82a-166">快取功能是由 [**MFNETSOURCE \_ CACHEENABLED**](mfnetsource-cacheenabled-property.md) 屬性所控制。</span><span class="sxs-lookup"><span data-stu-id="4a82a-166">The Fast Cache feature is controlled by the [**MFNETSOURCE\_CACHEENABLED**](mfnetsource-cacheenabled-property.md) property.</span></span>

### <a name="buffer-management"></a><span data-ttu-id="4a82a-167">緩衝區管理</span><span class="sxs-lookup"><span data-stu-id="4a82a-167">Buffer Management</span></span>

<span data-ttu-id="4a82a-168">網路來源提供有效率的緩衝區管理，可監視用戶端上的緩衝區狀態。</span><span class="sxs-lookup"><span data-stu-id="4a82a-168">The network source provides efficient buffer management that monitors the buffer state on the client.</span></span> <span data-ttu-id="4a82a-169">根據預設，網路來源會在啟動時緩衝5秒的資料。</span><span class="sxs-lookup"><span data-stu-id="4a82a-169">By default, the network source buffers 5 seconds of data at startup.</span></span> <span data-ttu-id="4a82a-170">您可以藉由設定 [**MFNETSOURCE \_ BUFFERINGTIME**](mfnetsource-bufferingtime-property.md) 屬性來設定這個值。</span><span class="sxs-lookup"><span data-stu-id="4a82a-170">This value can be configured by setting the [**MFNETSOURCE\_BUFFERINGTIME**](mfnetsource-bufferingtime-property.md) property.</span></span> <span data-ttu-id="4a82a-171">根據此屬性值，網路來源會計算足夠的緩衝區大小，以確保媒體內容的播放流暢且不中斷。</span><span class="sxs-lookup"><span data-stu-id="4a82a-171">Based on this property value, the network source computes the buffer size that is sufficient to ensure smooth and uninterrupted playback of the media content.</span></span> <span data-ttu-id="4a82a-172">如果這個屬性設定為0，則會停用緩衝區管理。</span><span class="sxs-lookup"><span data-stu-id="4a82a-172">If this property is set to 0, buffer management is disabled.</span></span> <span data-ttu-id="4a82a-173">當緩衝區中的內容數量很低時，網路來源會開始緩衝並引發 [MEBufferingStarted](mebufferingstarted.md) 事件，以指出已開始緩衝。</span><span class="sxs-lookup"><span data-stu-id="4a82a-173">When the amount of content in the buffer is low, the network source starts buffering and raises the [MEBufferingStarted](mebufferingstarted.md) event to indicate that buffering has begun.</span></span> <span data-ttu-id="4a82a-174">收到此事件時，管線會停止轉譯。</span><span class="sxs-lookup"><span data-stu-id="4a82a-174">Upon receiving this event, the pipeline stops rendering.</span></span> <span data-ttu-id="4a82a-175">當緩衝處理完成時，網路來源會引發 [MEBufferingStopped](mebufferingstopped.md) 事件，而用戶端可以再次開始轉譯。</span><span class="sxs-lookup"><span data-stu-id="4a82a-175">When buffering is complete, the network source raises the [MEBufferingStopped](mebufferingstopped.md) event, and the client can start rendering again.</span></span>

<span data-ttu-id="4a82a-176">用戶端會在累積了第一個樣本的緩衝區大小所指出的資料量之後，開始轉譯內容。</span><span class="sxs-lookup"><span data-stu-id="4a82a-176">The client starts rendering the content after it has accumulated the amount of data indicated by the buffer size of the first sample.</span></span> <span data-ttu-id="4a82a-177">如果這個值低於計算的緩衝區大小，則會立即開始播放。</span><span class="sxs-lookup"><span data-stu-id="4a82a-177">If this value is lower than the calculated buffer size, then the playback starts immediately.</span></span> <span data-ttu-id="4a82a-178">此行為非常類似于快速啟動功能。</span><span class="sxs-lookup"><span data-stu-id="4a82a-178">This behavior is very similar to the Fast Startup feature.</span></span>

<span data-ttu-id="4a82a-179">[**MFNETSOURCE \_ MAXBUFFERTIMEMS**](mfnetsource-maxbuffertimems-property.md)屬性會儲存可以緩衝的最大資料量。</span><span class="sxs-lookup"><span data-stu-id="4a82a-179">The [**MFNETSOURCE\_MAXBUFFERTIMEMS**](mfnetsource-maxbuffertimems-property.md) property stores the maximum amount of data that can be buffered.</span></span>

### <a name="bandwidth-selection"></a><span data-ttu-id="4a82a-180">頻寬選取</span><span class="sxs-lookup"><span data-stu-id="4a82a-180">Bandwidth Selection</span></span>

<span data-ttu-id="4a82a-181">當用戶端連線至媒體伺服器時，在連線設定過程中，網路來源會執行 *靜態封包配對* 測量，以估計用戶端與伺服器之間的初始連結頻寬。</span><span class="sxs-lookup"><span data-stu-id="4a82a-181">When a client connects to the media server, as part of the connection setup, the network source performs *static packet-pair* measurement to estimate the initial link bandwidth between client and server.</span></span> <span data-ttu-id="4a82a-182">根據此測量結果，用戶端可以選取符合估計頻寬的音訊和影片串流。</span><span class="sxs-lookup"><span data-stu-id="4a82a-182">Based on the result of this measurement, the client can select audio and video streams that fit within the estimated bandwidth.</span></span> <span data-ttu-id="4a82a-183">這可確保流暢地播放串流媒體內容。</span><span class="sxs-lookup"><span data-stu-id="4a82a-183">This ensures smooth playback of the streaming media content.</span></span>

<span data-ttu-id="4a82a-184">在快速啟動階段期間，會執行 *動態封包配對* 度量。</span><span class="sxs-lookup"><span data-stu-id="4a82a-184">During the Fast Startup stage, *dynamic packet-pair* measurement is performed.</span></span> <span data-ttu-id="4a82a-185">在此程式中，用戶端會收到大量的資料，也就是多個封包或範例。</span><span class="sxs-lookup"><span data-stu-id="4a82a-185">In this process, the client receives large amounts of data, which can be multiple packets or samples.</span></span>

<span data-ttu-id="4a82a-186">動態封包組量測的結果比靜態封包配對測量傳回的連結頻寬估計更為精確，因為靜態封包組進程會傳送固定大小的單一封包，這可能不會產生高頻寬網路的精確結果。</span><span class="sxs-lookup"><span data-stu-id="4a82a-186">The result of dynamic packet-pair measurement is more accurate than the link bandwidth estimate returned by static packet-pair measurement because the static packet-pair process sends a single packet of fixed size, which may not yield accurate results for high bandwidth networks.</span></span>

<span data-ttu-id="4a82a-187">應用程式可以使用 [**MFNETSOURCE \_ PPBANDWIDTH**](mfnetsource-ppbandwidth-property.md) 屬性來取得估計的頻寬。</span><span class="sxs-lookup"><span data-stu-id="4a82a-187">The application can get the estimated bandwidth by using the [**MFNETSOURCE\_PPBANDWIDTH**](mfnetsource-ppbandwidth-property.md) property.</span></span>

<span data-ttu-id="4a82a-188">網路狀況可能會動態變更，導致網路來源的播放發生問題。</span><span class="sxs-lookup"><span data-stu-id="4a82a-188">Network conditions may change dynamically, causing glitches in playback of the network source.</span></span> <span data-ttu-id="4a82a-189">網路來源可以根據接收速率和緩衝區狀態變更用戶端的初始資料流程選取專案。</span><span class="sxs-lookup"><span data-stu-id="4a82a-189">The network source can change the client's initial stream selection based on the receiving rate and the buffer state.</span></span> <span data-ttu-id="4a82a-190">例如，用戶端可能會在網路擁塞期間切換至較低的位元速率，並在網路流量改善時切換回較高的位元速率，且用戶端已累積足夠的緩衝內容數量。</span><span class="sxs-lookup"><span data-stu-id="4a82a-190">For example, the client might switch to a lower bit rate during network congestion and switch back to a higher bit rate when network traffic has improved and the client has accumulated a sufficient amount of buffered content.</span></span>

## <a name="related-topics"></a><span data-ttu-id="4a82a-191">相關主題</span><span class="sxs-lookup"><span data-stu-id="4a82a-191">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="4a82a-192">媒體基礎中的網路功能</span><span class="sxs-lookup"><span data-stu-id="4a82a-192">Networking in Media Foundation</span></span>](networking-in-media-foundation.md)
</dt> </dl>

 

 



