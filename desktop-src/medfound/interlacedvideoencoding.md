---
description: 交錯式影片編碼
ms.assetid: 7695d4e3-4a75-4972-ab02-bc532d6a4dce
title: '交錯式影片編碼 (Microsoft 媒體基礎) '
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 15269aca3f2878504fef56c62b1a1d70ecd89295c237164ba864b15aaae371d4
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/11/2021
ms.locfileid: "119724388"
---
# <a name="interlaced-video-encoding-microsoft-media-foundation"></a>交錯式影片編碼 (Microsoft 媒體基礎) 

用於電腦的影片資料通常是 *漸進式* 的，這表示每個畫面格都會編碼為單一影像。 有些裝置（像是電視）不會一次顯示一個框架，而是兩個影像。 其中一個影像或欄位包含所有偶數的資料列。 另一個欄位包含所有奇數編號資料列的資料。 針對每個畫面格使用多個欄位編碼的影片稱為交錯式，因為它是透過在偶數位段和奇數位段之間切換來呈現。

在過去，交錯式影片內容在使用 Windows Media 視訊編解碼器進行編碼之前，一律會先取消交錯。 但從 Windows Media 9 系列開始，影片編碼器支援壓縮交錯內容，而不需要先將它轉換成漸進式內容。 如果內容是在交錯顯示（例如電視）上轉譯，則維護編碼檔案中的交錯是很重要的。 這項功能的重要性很高，因為支援 Windows 媒體內容散佈至 DVD 播放機、機上盒和其他家用電子產品。

編碼和提供交錯式影片最簡單的方式，就是使用 Windows 媒體格式 SDK 來開發應用程式，並將內容儲存在 ASF 檔案中。 有關框架的交錯式資訊會使用資料單位延伸模組傳遞給編解碼器，這適用于 ASF 內容，但在其他容器中的支援也比較棘手。 如需有關資料單位延伸的詳細資訊，請參閱 [使用資料單位延伸](usingdataunitextensions.md)。

為了支援交錯編碼，需要兩個主要步驟：將畫面格資訊取得至編碼器，並將資訊傳遞至轉譯應用程式。 下列段落會描述這些步驟。

## <a name="interlaced-video-and-the-encoder"></a>交錯式影片和編碼器

編碼影片的第一個步驟是使用維護的交錯，將編碼器設定成將交錯欄位編碼。 若要這樣做，請將 [MFPKEY \_ INTERLACEDCODINGENABLED](mfpkey-interlacedcodingenabledproperty.md) 屬性設定為 **TRUE**。 這會準備編碼器以接收交錯式範例。 每個輸入範例都必須包含這兩個欄位。

啟用交錯編碼之後，您使用編碼器處理的每個範例都應該已附加資料單位延伸。 沒有預期資料單位延伸的範例會假設為漸進式。 識別延伸模組的 GUID 是 D590DC20-07BC-436C-9CF7-F3BBFBF1A4DC。 下表定義了 Windows 媒體格式 SDK 的物件所傳遞的值。



| 值      | 描述                                                                                                                              |
|------------|------------------------------------------------------------------------------------------------------------------------------------------|
| 0x00000020 | 指定範例先以底部欄位編碼。 此值只有在結合交錯值時才有意義。 |
| 0x00000040 | 指定範例會先使用頂端欄位進行編碼。 此值只有在結合交錯值時才有意義。    |
| 0x00000080 | 指定此範例為交錯式。 這是對編解碼器 DMOs 有意義的唯一值。                                    |



 

前兩個值的其中一個，一律會使用位 Or， **或** 在取樣上進行設定，而結合0x80。 不過，編碼器只會檢查0x80，並忽略其餘的延伸模組。 如果延伸模組將範例識別為交錯式，則編碼器會在壓縮的資料流程中維持範例交錯，並在資料流程中內嵌指示旗標，讓解碼器可以識別交錯的框架。 每個交錯範例都會標示為，因此混合漸進和交錯的來源內容可以一起編碼為數據流。

Windows 媒體格式 SDK 寫入器物件在轉譯時，會在其寫入至 ASF 容器的 data 區段的範例中包含內容類型資料單位延伸模組。

## <a name="reading-and-rendering-interlaced-video"></a>閱讀和轉譯交錯式影片

此解碼器會根據編碼器在資料流程中設定的旗標來識別交錯樣本。 在預設情況下，此解碼器會 deinterlaces 範例並傳遞漸進式輸出。 播放程式應用程式可以設定 [MFPKEY \_ 解碼器 \_ 去交錯](mfpkey-decoder-deinterlacingproperty.md) 屬性，以設定使用交錯來處理輸出的輸出。

在解碼影片傳遞範例之後，會發生交錯播放影片的困難。 裝置中的轉譯器 (視訊卡或晶片) 無法正確地顯示影片內容，而不知道哪個欄位是什麼。 在使用 Windows 媒體格式 SDK 的應用程式中，內容類型資料單位延伸會從未壓縮的範例中取出，並可傳遞至裝置。

直接使用編解碼器物件時，不會自動傳送此資料。 您必須在您的緩衝區物件和用於編碼內容的容器中，執行資料單位延伸模組支援。 最常見的媒體容器類型 (例如 AVI) 不支援範例層級的中繼資料。 您可以執行自己的系統來將資料儲存在檔案中，並將其與個別的範例產生關聯，但只有自訂的讀取器才能取得它。

> [!Note]  
> 將 [MFPKEY \_ INTERLACEDCODINGENABLED](mfpkey-interlacedcodingenabledproperty.md) 屬性設定為 **TRUE**，然後不傳送任何附加了 content-type 資料單位延伸的範例，可能會導致編碼器損毀。 只有在您有可傳遞的交錯式取樣時，才會設定交錯編碼的編碼器。

 

## <a name="related-topics"></a>相關主題

<dl> <dt>

[使用影片](workingwithvideo.md)
</dt> </dl>

 

 



