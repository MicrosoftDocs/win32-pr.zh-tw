---
description: Sequencer 來源事件
ms.assetid: 28654bae-9ce2-467b-b769-63279d69b173
title: Sequencer 來源事件
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: fdf97cc5ff25c8a5fc40fa4990bf38c652f94e63
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/07/2021
ms.locfileid: "106974567"
---
# <a name="sequencer-source-events"></a><span data-ttu-id="75296-103">Sequencer 來源事件</span><span class="sxs-lookup"><span data-stu-id="75296-103">Sequencer Source Events</span></span>

<span data-ttu-id="75296-104">當 [Sequencer 來源](sequencer-source.md) 播放一系列的檔案時，媒體會話通常會傳送正常播放期間傳送的相同事件，以及 [媒體會話事件](media-session-events.md)中所列出的事件。</span><span class="sxs-lookup"><span data-stu-id="75296-104">When the [Sequencer Source](sequencer-source.md) plays a sequence of files, the Media Session generally sends all of the same events that are sent during normal playback, and which are listed in [Media Session Events](media-session-events.md).</span></span> <span data-ttu-id="75296-105">應用程式會使用媒體會話的 [**IMFMediaEventGenerator**](/windows/desktop/api/mfobjects/nn-mfobjects-imfmediaeventgenerator) 介面取得這些事件。</span><span class="sxs-lookup"><span data-stu-id="75296-105">The application gets these events using the Media Session's [**IMFMediaEventGenerator**](/windows/desktop/api/mfobjects/nn-mfobjects-imfmediaeventgenerator) interface.</span></span>

<span data-ttu-id="75296-106">此外，還有一些特定于播放清單區段的事件。</span><span class="sxs-lookup"><span data-stu-id="75296-106">In addition, there are some events which are specific to playlist segments.</span></span>



| <span data-ttu-id="75296-107">事件</span><span class="sxs-lookup"><span data-stu-id="75296-107">Event</span></span>                                                                                                   | <span data-ttu-id="75296-108">描述</span><span class="sxs-lookup"><span data-stu-id="75296-108">Description</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|---------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="75296-109">MENewPresentation</span><span class="sxs-lookup"><span data-stu-id="75296-109">MENewPresentation</span></span>](menewpresentation.md)                                                              | <span data-ttu-id="75296-110">通知應用程式要預先進行下一個拓撲。</span><span class="sxs-lookup"><span data-stu-id="75296-110">Signals the application to preroll the next topology.</span></span><br/> <span data-ttu-id="75296-111">為了在兩個連續的簡報之間提供順暢的轉換，sequencer 來源會事先載入下一個拓撲。</span><span class="sxs-lookup"><span data-stu-id="75296-111">To provide a seamless transition between two consecutive presentations, the sequencer source loads the next topology in advance.</span></span> <span data-ttu-id="75296-112">當使用中拓撲仍在播放時，sequencer 來源會傳送此事件以供下一個拓撲，只要來源中有可用的後續拓撲即可。</span><span class="sxs-lookup"><span data-stu-id="75296-112">While the active topology is still playing, the sequencer source sends this event for the next topology, as long as there is a subsequent topology available in the source.</span></span><br/> <span data-ttu-id="75296-113">此事件的事件資料是下一個拓撲的表示描述項。</span><span class="sxs-lookup"><span data-stu-id="75296-113">This event data for this event is the presentation descriptor for the next topology.</span></span> <span data-ttu-id="75296-114">應用程式會負責在媒體會話上設定對應的拓撲，如 [使用 Sequencer 來源](using-the-sequencer-source.md)中所述。</span><span class="sxs-lookup"><span data-stu-id="75296-114">The application is responsible for setting the corresponding topology on the Media Session, as described in [Using the Sequencer Source](using-the-sequencer-source.md).</span></span><br/> |
| [<span data-ttu-id="75296-115">MEEndOfPresentationSegment</span><span class="sxs-lookup"><span data-stu-id="75296-115">MEEndOfPresentationSegment</span></span>](meendofpresentationsegment.md)                                            | <span data-ttu-id="75296-116">當媒體會話完成播放目前的區段時，如果該區段後面接著另一個區段，sequencer 來源就會引發此事件。</span><span class="sxs-lookup"><span data-stu-id="75296-116">The sequencer source raises this event when the Media Session has completed playing the current segment, if that segment is followed by another segment.</span></span> <span data-ttu-id="75296-117"> (如果目前區段是最後一個區段，sequencer 來源會改為引發 [MEEndOfPresentation](meendofpresentation.md) 事件。 ) </span><span class="sxs-lookup"><span data-stu-id="75296-117">(If the current segment is the last one, the sequencer source raises the [MEEndOfPresentation](meendofpresentation.md) event instead.)</span></span><br/> <span data-ttu-id="75296-118">媒體會話將此事件轉送到應用程式。</span><span class="sxs-lookup"><span data-stu-id="75296-118">The Media Session forwards this event to the application.</span></span> <span data-ttu-id="75296-119">一般來說，當媒體會話開始處理下一個區段之後，應用程式會收到 [MEEndOfPresentationSegment](meendofpresentationsegment.md) ，但是媒體接收器仍會提供上一個區段的範例。</span><span class="sxs-lookup"><span data-stu-id="75296-119">Typically, the application receives [MEEndOfPresentationSegment](meendofpresentationsegment.md) after the Media Session has started processing the next segment, but while the media sinks are still delivering the samples for the previous segment.</span></span><br/>                            |
| <span data-ttu-id="75296-120">[MESessionTopologyStatus](mesessiontopologystatus.md)，狀態為 **MF \_ TOPOSTATUS \_ 接收已 \_ 切換**。</span><span class="sxs-lookup"><span data-stu-id="75296-120">[MESessionTopologyStatus](mesessiontopologystatus.md), with status **MF\_TOPOSTATUS\_SINK\_SWITCHED**.</span></span> | <span data-ttu-id="75296-121">當媒體會話轉換到 sequencer 來源中的下一個拓撲，而媒體接收器已完成播放先前的拓撲時，就會引發此事件。</span><span class="sxs-lookup"><span data-stu-id="75296-121">The Media Session raises this event when it makes a transition to the next topology in the sequencer source and media sinks have completed playing the previous topology.</span></span> <span data-ttu-id="75296-122">此事件包含下一個拓撲的指標。</span><span class="sxs-lookup"><span data-stu-id="75296-122">This event contains a pointer to the next topology.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                      |



 

## <a name="example-1-playback-without-skipping"></a><span data-ttu-id="75296-123">範例1：不略過的播放</span><span class="sxs-lookup"><span data-stu-id="75296-123">Example 1: Playback without Skipping</span></span>

<span data-ttu-id="75296-124">牽涉到 sequencer 來源時，從媒體會話取得的事件數目可能會造成混淆，尤其是因為與某個區段相關聯的事件通常會與下一個區段的事件交錯。</span><span class="sxs-lookup"><span data-stu-id="75296-124">When the sequencer source is involved, the number of events that you get from the Media Session can be confusing, especially because events associated with one segment are often interleaved with events for the next segment.</span></span>

<span data-ttu-id="75296-125">在第一個範例中，應用程式會將三個區段（S1、S2 和 S3）排入佇列。</span><span class="sxs-lookup"><span data-stu-id="75296-125">In the first example, the application queues three segments, S1, S2, and S3.</span></span> <span data-ttu-id="75296-126">第三個區段具有 **SequencerTopologyFlags \_ 最後一個** 旗標，表示其為序列中的最後一個區段。</span><span class="sxs-lookup"><span data-stu-id="75296-126">The third segment has the **SequencerTopologyFlags\_Last** flag, to signal it is the last segment in the sequence.</span></span> <span data-ttu-id="75296-127">每個事件對應的區段都是以括弧括住。</span><span class="sxs-lookup"><span data-stu-id="75296-127">The segment to which each event corresponds is given in parentheses.</span></span> <span data-ttu-id="75296-128">也會列出應用程式的 [**SetTopology**](/windows/desktop/api/mfidl/nf-mfidl-imfmediasession-settopology) 呼叫，讓作業的順序更清楚。</span><span class="sxs-lookup"><span data-stu-id="75296-128">The application's [**SetTopology**](/windows/desktop/api/mfidl/nf-mfidl-imfmediasession-settopology) calls are also listed, to make the order of operations clearer.</span></span>

-   <span data-ttu-id="75296-129">應用程式呼叫 [**IMFMediaSession：： SetTopology**](/windows/desktop/api/mfidl/nf-mfidl-imfmediasession-settopology) (S1) </span><span class="sxs-lookup"><span data-stu-id="75296-129">Application calls [**IMFMediaSession::SetTopology**](/windows/desktop/api/mfidl/nf-mfidl-imfmediasession-settopology) (S1)</span></span>
-   <span data-ttu-id="75296-130">[MESessionTopologySet](mesessiontopologyset.md) (S1) </span><span class="sxs-lookup"><span data-stu-id="75296-130">[MESessionTopologySet](mesessiontopologyset.md) (S1)</span></span>
-   <span data-ttu-id="75296-131">[MESessionTopologyStatus](mesessiontopologystatus.md)： **MF \_ TOPOSTATUS \_ READY** (S1) </span><span class="sxs-lookup"><span data-stu-id="75296-131">[MESessionTopologyStatus](mesessiontopologystatus.md): **MF\_TOPOSTATUS\_READY** (S1)</span></span>
-   <span data-ttu-id="75296-132">[MENewPresentation](menewpresentation.md) (S2 預先) </span><span class="sxs-lookup"><span data-stu-id="75296-132">[MENewPresentation](menewpresentation.md) (S2 preroll)</span></span>
-   <span data-ttu-id="75296-133">應用程式呼叫 [**IMFMediaSession：： SetTopology**](/windows/desktop/api/mfidl/nf-mfidl-imfmediasession-settopology) (S2) </span><span class="sxs-lookup"><span data-stu-id="75296-133">Application calls [**IMFMediaSession::SetTopology**](/windows/desktop/api/mfidl/nf-mfidl-imfmediasession-settopology) (S2)</span></span>
-   <span data-ttu-id="75296-134">[MESessionTopologyStatus](mesessiontopologystatus.md)： **MF \_ TOPOSTATUS \_ 啟動 \_ 來源** (S1) 的起點</span><span class="sxs-lookup"><span data-stu-id="75296-134">[MESessionTopologyStatus](mesessiontopologystatus.md): **MF\_TOPOSTATUS\_STARTED\_SOURCE** (start of S1)</span></span>
-   <span data-ttu-id="75296-135">[MESessionTopologySet](mesessiontopologyset.md) (S2) </span><span class="sxs-lookup"><span data-stu-id="75296-135">[MESessionTopologySet](mesessiontopologyset.md) (S2)</span></span>
-   <span data-ttu-id="75296-136">[MEEndOfPresentationSegment](meendofpresentationsegment.md) (S1) 的結尾</span><span class="sxs-lookup"><span data-stu-id="75296-136">[MEEndOfPresentationSegment](meendofpresentationsegment.md) (end of S1)</span></span>
-   <span data-ttu-id="75296-137">[MESessionTopologyStatus](mesessiontopologystatus.md)： **MF \_ TOPOSTATUS \_** (S1) 結束</span><span class="sxs-lookup"><span data-stu-id="75296-137">[MESessionTopologyStatus](mesessiontopologystatus.md): **MF\_TOPOSTATUS\_ENDED** (S1)</span></span>
-   <span data-ttu-id="75296-138">[MESessionTopologyStatus](mesessiontopologystatus.md)： **MF \_ TOPOSTATUS \_ 接收 \_ 切換** (轉換至 S2) </span><span class="sxs-lookup"><span data-stu-id="75296-138">[MESessionTopologyStatus](mesessiontopologystatus.md): **MF\_TOPOSTATUS\_SINK\_SWITCHED** (transition to S2)</span></span>
-   <span data-ttu-id="75296-139">[MESessionTopologyStatus](mesessiontopologystatus.md)： **MF \_ TOPOSTATUS \_ READY** (S2) </span><span class="sxs-lookup"><span data-stu-id="75296-139">[MESessionTopologyStatus](mesessiontopologystatus.md): **MF\_TOPOSTATUS\_READY** (S2)</span></span>
-   <span data-ttu-id="75296-140">[MESessionTopologyStatus](mesessiontopologystatus.md)： **MF \_ TOPOSTATUS \_ 啟動 \_ 來源** (開始 S2) </span><span class="sxs-lookup"><span data-stu-id="75296-140">[MESessionTopologyStatus](mesessiontopologystatus.md): **MF\_TOPOSTATUS\_STARTED\_SOURCE** (start of S2)</span></span>
-   <span data-ttu-id="75296-141">[MENewPresentation](menewpresentation.md) (S3 預先) </span><span class="sxs-lookup"><span data-stu-id="75296-141">[MENewPresentation](menewpresentation.md) (S3 preroll)</span></span>
-   <span data-ttu-id="75296-142">應用程式呼叫 [**IMFMediaSession：： SetTopology**](/windows/desktop/api/mfidl/nf-mfidl-imfmediasession-settopology) (S2) </span><span class="sxs-lookup"><span data-stu-id="75296-142">Application calls [**IMFMediaSession::SetTopology**](/windows/desktop/api/mfidl/nf-mfidl-imfmediasession-settopology) (S2)</span></span>
-   <span data-ttu-id="75296-143">[MESessionTopologySet](mesessiontopologyset.md) (S3) </span><span class="sxs-lookup"><span data-stu-id="75296-143">[MESessionTopologySet](mesessiontopologyset.md) (S3)</span></span>
-   <span data-ttu-id="75296-144">[MEEndOfPresentationSegment](meendofpresentationsegment.md) (S2) 的結尾</span><span class="sxs-lookup"><span data-stu-id="75296-144">[MEEndOfPresentationSegment](meendofpresentationsegment.md) (end of S2)</span></span>
-   <span data-ttu-id="75296-145">[MESessionTopologyStatus](mesessiontopologystatus.md)： **MF \_ TOPOSTATUS \_ 結束** (S2) </span><span class="sxs-lookup"><span data-stu-id="75296-145">[MESessionTopologyStatus](mesessiontopologystatus.md): **MF\_TOPOSTATUS\_ENDED** (S2)</span></span>
-   <span data-ttu-id="75296-146">[MESessionTopologyStatus](mesessiontopologystatus.md)： **MF \_ TOPOSTATUS \_ 接收 \_ 切換** (轉換至 S3) </span><span class="sxs-lookup"><span data-stu-id="75296-146">[MESessionTopologyStatus](mesessiontopologystatus.md): **MF\_TOPOSTATUS\_SINK\_SWITCHED** (transition to S3)</span></span>
-   <span data-ttu-id="75296-147">[MESessionTopologyStatus](mesessiontopologystatus.md)： **MF \_ TOPOSTATUS \_ READY** (S3) </span><span class="sxs-lookup"><span data-stu-id="75296-147">[MESessionTopologyStatus](mesessiontopologystatus.md): **MF\_TOPOSTATUS\_READY** (S3)</span></span>
-   <span data-ttu-id="75296-148">[MESessionTopologyStatus](mesessiontopologystatus.md)： **MF \_ TOPOSTATUS \_ 啟動 \_ 來源** (S3) 起點</span><span class="sxs-lookup"><span data-stu-id="75296-148">[MESessionTopologyStatus](mesessiontopologystatus.md): **MF\_TOPOSTATUS\_STARTED\_SOURCE** (start of S3)</span></span>
-   <span data-ttu-id="75296-149">[MEEndOfPresentation](meendofpresentation.md) (S3 結尾;最後一個區段) </span><span class="sxs-lookup"><span data-stu-id="75296-149">[MEEndOfPresentation](meendofpresentation.md) (end of S3; last segment)</span></span>
-   <span data-ttu-id="75296-150">[MESessionTopologyStatus](mesessiontopologystatus.md)： **MF \_ TOPOSTATUS \_ 結束**</span><span class="sxs-lookup"><span data-stu-id="75296-150">[MESessionTopologyStatus](mesessiontopologystatus.md): **MF\_TOPOSTATUS\_ENDED**</span></span>
-   [<span data-ttu-id="75296-151">MESessionEnded</span><span class="sxs-lookup"><span data-stu-id="75296-151">MESessionEnded</span></span>](mesessionended.md)

<span data-ttu-id="75296-152">這份清單不包含您可能會收到的每個事件。</span><span class="sxs-lookup"><span data-stu-id="75296-152">This list does not include every event that you might receive.</span></span> <span data-ttu-id="75296-153"> (例如，它會省略 [MESessionCapabilitiesChanged](mesessioncapabilitieschanged.md) 事件，每當會話功能變更時就會傳送此事件。</span><span class="sxs-lookup"><span data-stu-id="75296-153">(For example, it omits the [MESessionCapabilitiesChanged](mesessioncapabilitieschanged.md) event, which is sent whenever the session capabilities change.</span></span> <span data-ttu-id="75296-154">應用程式通常會在簡報中收到多個 MESessionCapabilitiesChanged 事件。 ) 此處所列的事件是顯示從一個區段轉換到下一個區段的事件。</span><span class="sxs-lookup"><span data-stu-id="75296-154">An application typically receives multiple MESessionCapabilitiesChanged events throughout a presentation.) The events listed here are the ones that show the transition from one segment to the next.</span></span> <span data-ttu-id="75296-155">最重要的事件是 [MENewPresentation](menewpresentation.md)，它會指示應用程式預先進行下一個拓撲，並使用 [MEEndOfPresentationSegment](meendofpresentationsegment.md)來表示區段結尾 (除了最後一個區段) 之外。</span><span class="sxs-lookup"><span data-stu-id="75296-155">The most important events are [MENewPresentation](menewpresentation.md), which signals the application to preroll the next topology, and [MEEndOfPresentationSegment](meendofpresentationsegment.md), which signals the end of a segment (except for the last segment).</span></span>

<span data-ttu-id="75296-156">由於媒體基礎中的事件是非同步，而且不會使用方法呼叫進行序列化，因此確切的順序可能會不同。</span><span class="sxs-lookup"><span data-stu-id="75296-156">Because events in Media Foundation are asynchronous, and are not serialized with method calls, the exact order could vary.</span></span> <span data-ttu-id="75296-157">例如，您可以在應用程式呼叫 [**SetTopology**](/windows/desktop/api/mfidl/nf-mfidl-imfmediasession-settopology) for S2 之前，接收 S1 的 **MF \_ TOPOSTATUS \_ 已啟動 \_ 來源**。</span><span class="sxs-lookup"><span data-stu-id="75296-157">For example, you could receive **MF\_TOPOSTATUS\_STARTED\_SOURCE** for S1 before the application calls [**SetTopology**](/windows/desktop/api/mfidl/nf-mfidl-imfmediasession-settopology) for S2.</span></span>

<span data-ttu-id="75296-158">此外，您可能無法取得此處所列的每個事件。</span><span class="sxs-lookup"><span data-stu-id="75296-158">Also, you might not get every event listed here.</span></span> <span data-ttu-id="75296-159">例如，除非最後一個區段具有 **SequencerTopologyFlags 的 \_ 最後一個** 旗標，否則不會傳送 [MEEndOfPresentation](meendofpresentation.md)和 [MESessionEnded](mesessionended.md)事件。</span><span class="sxs-lookup"><span data-stu-id="75296-159">The [MEEndOfPresentation](meendofpresentation.md) and [MESessionEnded](mesessionended.md) events, for example, are not sent unless the last segment has the **SequencerTopologyFlags\_Last** flag.</span></span>

<span data-ttu-id="75296-160">最後，這份清單並不表示時間。</span><span class="sxs-lookup"><span data-stu-id="75296-160">Finally, this list does not indicate the passage of time.</span></span> <span data-ttu-id="75296-161">從「開始 S1」到「S1 結尾」的時間是 S1 的整個持續時間，這可能是幾秒鐘或數小時，視來源而定。</span><span class="sxs-lookup"><span data-stu-id="75296-161">The time from "start of S1" to "end of S1" is the entire duration of S1, which could be a few seconds or many hours, depending on the source.</span></span>

## <a name="example-2-playback-with-segment-skipping"></a><span data-ttu-id="75296-162">範例2：使用區段略過播放</span><span class="sxs-lookup"><span data-stu-id="75296-162">Example 2: Playback with Segment Skipping</span></span>

<span data-ttu-id="75296-163">在此範例中，應用程式會將相同的區段排入佇列，但在播放區段1時跳到區段3。</span><span class="sxs-lookup"><span data-stu-id="75296-163">In this example, the application queues the same segments, but skips to segment 3 while segment 1 is playing.</span></span> <span data-ttu-id="75296-164">在此情況下，會傳送下列事件：</span><span class="sxs-lookup"><span data-stu-id="75296-164">In this case, the following events are sent:</span></span>

-   <span data-ttu-id="75296-165">應用程式呼叫 [**IMFMediaSession：： SetTopology**](/windows/desktop/api/mfidl/nf-mfidl-imfmediasession-settopology) (S1) </span><span class="sxs-lookup"><span data-stu-id="75296-165">Application calls [**IMFMediaSession::SetTopology**](/windows/desktop/api/mfidl/nf-mfidl-imfmediasession-settopology) (S1)</span></span>
-   <span data-ttu-id="75296-166">[MESessionTopologySet](mesessiontopologyset.md) (S1) </span><span class="sxs-lookup"><span data-stu-id="75296-166">[MESessionTopologySet](mesessiontopologyset.md) (S1)</span></span>
-   <span data-ttu-id="75296-167">[MESessionTopologyStatus](mesessiontopologystatus.md)： **MF \_ TOPOSTATUS \_ READY** (S1) </span><span class="sxs-lookup"><span data-stu-id="75296-167">[MESessionTopologyStatus](mesessiontopologystatus.md): **MF\_TOPOSTATUS\_READY** (S1)</span></span>
-   <span data-ttu-id="75296-168">[MENewPresentation](menewpresentation.md) (S2 預先) </span><span class="sxs-lookup"><span data-stu-id="75296-168">[MENewPresentation](menewpresentation.md) (S2 preroll)</span></span>
-   <span data-ttu-id="75296-169">應用程式呼叫 [**IMFMediaSession：： SetTopology**](/windows/desktop/api/mfidl/nf-mfidl-imfmediasession-settopology) (S2) </span><span class="sxs-lookup"><span data-stu-id="75296-169">Application calls [**IMFMediaSession::SetTopology**](/windows/desktop/api/mfidl/nf-mfidl-imfmediasession-settopology) (S2)</span></span>
-   <span data-ttu-id="75296-170">[MESessionTopologyStatus](mesessiontopologystatus.md)： **MF \_ TOPOSTATUS \_ 啟動 \_ 來源** (S1) 的起點</span><span class="sxs-lookup"><span data-stu-id="75296-170">[MESessionTopologyStatus](mesessiontopologystatus.md): **MF\_TOPOSTATUS\_STARTED\_SOURCE** (start of S1)</span></span>
-   <span data-ttu-id="75296-171">[MESessionTopologySet](mesessiontopologyset.md) (S2) </span><span class="sxs-lookup"><span data-stu-id="75296-171">[MESessionTopologySet](mesessiontopologyset.md) (S2)</span></span>
-   <span data-ttu-id="75296-172">應用程式呼叫 [**IMFMediaSession：： Start**](/windows/desktop/api/mfidl/nf-mfidl-imfmediasession-start) (跳至 S3) </span><span class="sxs-lookup"><span data-stu-id="75296-172">Application calls [**IMFMediaSession::Start**](/windows/desktop/api/mfidl/nf-mfidl-imfmediasession-start) (skip to S3)</span></span>
-   <span data-ttu-id="75296-173">[MENewPresentation](menewpresentation.md) (S3 預先) </span><span class="sxs-lookup"><span data-stu-id="75296-173">[MENewPresentation](menewpresentation.md) (S3 preroll)</span></span>
-   <span data-ttu-id="75296-174">應用程式呼叫 [**IMFMediaSession：： SetTopology**](/windows/desktop/api/mfidl/nf-mfidl-imfmediasession-settopology) (S3) </span><span class="sxs-lookup"><span data-stu-id="75296-174">Application calls [**IMFMediaSession::SetTopology**](/windows/desktop/api/mfidl/nf-mfidl-imfmediasession-settopology) (S3)</span></span>
-   [<span data-ttu-id="75296-175">MESessionStarted</span><span class="sxs-lookup"><span data-stu-id="75296-175">MESessionStarted</span></span>](mesessionstarted.md)
-   <span data-ttu-id="75296-176">[MEEndOfPresentationSegment](meendofpresentationsegment.md) (S1 已取消) </span><span class="sxs-lookup"><span data-stu-id="75296-176">[MEEndOfPresentationSegment](meendofpresentationsegment.md) (S1 canceled)</span></span>
-   <span data-ttu-id="75296-177">[MESessionTopologyStatus](mesessiontopologystatus.md)： **MF \_ TOPOSTATUS \_** (S1) 結束</span><span class="sxs-lookup"><span data-stu-id="75296-177">[MESessionTopologyStatus](mesessiontopologystatus.md): **MF\_TOPOSTATUS\_ENDED** (S1)</span></span>
-   <span data-ttu-id="75296-178">[MESessionTopologySet](mesessiontopologyset.md) (S3) </span><span class="sxs-lookup"><span data-stu-id="75296-178">[MESessionTopologySet](mesessiontopologyset.md) (S3)</span></span>
-   <span data-ttu-id="75296-179">[MESessionTopologyStatus](mesessiontopologystatus.md)： **MF \_ TOPOSTATUS \_ 接收 \_ 切換** (轉換至 S2) </span><span class="sxs-lookup"><span data-stu-id="75296-179">[MESessionTopologyStatus](mesessiontopologystatus.md): **MF\_TOPOSTATUS\_SINK\_SWITCHED** (transition to S2)</span></span>
-   <span data-ttu-id="75296-180">[MESessionTopologyStatus](mesessiontopologystatus.md)： **MF \_ TOPOSTATUS \_ READY** (S2) </span><span class="sxs-lookup"><span data-stu-id="75296-180">[MESessionTopologyStatus](mesessiontopologystatus.md): **MF\_TOPOSTATUS\_READY** (S2)</span></span>
-   <span data-ttu-id="75296-181">[MESessionTopologyStatus](mesessiontopologystatus.md)： **MF \_ TOPOSTATUS \_ 已啟動 \_ 來源** (S2) </span><span class="sxs-lookup"><span data-stu-id="75296-181">[MESessionTopologyStatus](mesessiontopologystatus.md): **MF\_TOPOSTATUS\_STARTED\_SOURCE** (S2)</span></span>
-   <span data-ttu-id="75296-182">[MEEndOfPresentationSegment](meendofpresentationsegment.md) (S2 已取消) </span><span class="sxs-lookup"><span data-stu-id="75296-182">[MEEndOfPresentationSegment](meendofpresentationsegment.md) (S2 canceled)</span></span>
-   <span data-ttu-id="75296-183">[MESessionTopologyStatus](mesessiontopologystatus.md)： **MF \_ TOPOSTATUS \_ 結束** (S2) </span><span class="sxs-lookup"><span data-stu-id="75296-183">[MESessionTopologyStatus](mesessiontopologystatus.md): **MF\_TOPOSTATUS\_ENDED** (S2)</span></span>
-   <span data-ttu-id="75296-184">[MESessionTopologyStatus](mesessiontopologystatus.md)： **MF \_ TOPOSTATUS \_ 接收 \_ 切換** (轉換至 S3) </span><span class="sxs-lookup"><span data-stu-id="75296-184">[MESessionTopologyStatus](mesessiontopologystatus.md): **MF\_TOPOSTATUS\_SINK\_SWITCHED** (transition to S3)</span></span>
-   <span data-ttu-id="75296-185">[MESessionTopologyStatus](mesessiontopologystatus.md)： **TOPOSTATUS \_ READY** (S3) </span><span class="sxs-lookup"><span data-stu-id="75296-185">[MESessionTopologyStatus](mesessiontopologystatus.md): **TOPOSTATUS\_READY** (S3)</span></span>
-   <span data-ttu-id="75296-186">[MESessionTopologyStatus](mesessiontopologystatus.md)： **MF \_ TOPOSTATUS \_ 已啟動 \_ 來源** (S3) </span><span class="sxs-lookup"><span data-stu-id="75296-186">[MESessionTopologyStatus](mesessiontopologystatus.md): **MF\_TOPOSTATUS\_STARTED\_SOURCE** (S3)</span></span>

<span data-ttu-id="75296-187">當應用程式呼叫 [**開始**](/windows/desktop/api/mfidl/nf-mfidl-imfmediasession-start) 跳到區段3時，sequencer 來源會取消區段1（仍在播放）。</span><span class="sxs-lookup"><span data-stu-id="75296-187">When the application calls [**Start**](/windows/desktop/api/mfidl/nf-mfidl-imfmediasession-start) to skip to segment 3, the sequencer source cancels segment 1, which is still playing.</span></span> <span data-ttu-id="75296-188">此區段的 [MEEndOfPresentationSegment](meendofpresentationsegment.md) 事件包含 [ [**MF \_ 事件 \_ 來源 \_ 拓撲 \_ 已取消**](mf-event-source-topology-canceled-attribute.md) ] 屬性，表示區段因為已取消而結束。</span><span class="sxs-lookup"><span data-stu-id="75296-188">The [MEEndOfPresentationSegment](meendofpresentationsegment.md) event for this segment contains the [**MF\_EVENT\_SOURCE\_TOPOLOGY\_CANCELED**](mf-event-source-topology-canceled-attribute.md) attribute, indicating that the segment ended because it was canceled.</span></span> <span data-ttu-id="75296-189">然後，由於區段2已經預先匯總，因此會啟動該區段，但是會立即取消。</span><span class="sxs-lookup"><span data-stu-id="75296-189">Then, because segment 2 is already pre-rolled, that segment is started but then immediately canceled.</span></span> <span data-ttu-id="75296-190">區段2的 MEEndOfPresentationSegment 事件也包含 **MF \_ 事件 \_ 來源 \_ 拓撲 \_ 取消** 屬性。</span><span class="sxs-lookup"><span data-stu-id="75296-190">The MEEndOfPresentationSegment event for segment 2 also contains the **MF\_EVENT\_SOURCE\_TOPOLOGY\_CANCELED** attribute.</span></span> <span data-ttu-id="75296-191">然後，會話可以切換到區段3並正常播放。</span><span class="sxs-lookup"><span data-stu-id="75296-191">The session can then switch to segment 3 and play it normally.</span></span>

## <a name="related-topics"></a><span data-ttu-id="75296-192">相關主題</span><span class="sxs-lookup"><span data-stu-id="75296-192">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="75296-193">關於 Sequencer 來源</span><span class="sxs-lookup"><span data-stu-id="75296-193">About the Sequencer Source</span></span>](about-the-sequencer-source.md)
</dt> <dt>

[<span data-ttu-id="75296-194">Sequencer 來源</span><span class="sxs-lookup"><span data-stu-id="75296-194">Sequencer Source</span></span>](sequencer-source.md)
</dt> </dl>

 

 




