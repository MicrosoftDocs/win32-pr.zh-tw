---
description: 使用影片混音器控制項
ms.assetid: 475996c6-a205-4133-8882-f55beaf9f8fd
title: 使用影片混音器控制項
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 0a8a062c6f984e0eac0128bd67c72bf691c95af6
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/07/2021
ms.locfileid: "104026527"
---
# <a name="using-the-video-mixer-controls"></a><span data-ttu-id="d105a-103">使用影片混音器控制項</span><span class="sxs-lookup"><span data-stu-id="d105a-103">Using the Video Mixer Controls</span></span>

<span data-ttu-id="d105a-104">EVR 混音器提供數個介面，可讓應用程式用來控制混音器處理影片的方式。</span><span class="sxs-lookup"><span data-stu-id="d105a-104">The EVR mixer provides several interfaces that an application can use to control how the mixer processes video.</span></span> <span data-ttu-id="d105a-105">這些介面可用於 DirectShow 或媒體基礎。</span><span class="sxs-lookup"><span data-stu-id="d105a-105">These interfaces can be used in either DirectShow or Media Foundation.</span></span>



| <span data-ttu-id="d105a-106">介面</span><span class="sxs-lookup"><span data-stu-id="d105a-106">Interface</span></span>                                                      | <span data-ttu-id="d105a-107">描述</span><span class="sxs-lookup"><span data-stu-id="d105a-107">Description</span></span>                                                                                                                                                                                                                                 |
|----------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="d105a-108">[**IMFVideoMixerBitmap**](/windows/desktop/api/evr9/nn-evr9-imfvideomixerbitmap) 介面</span><span class="sxs-lookup"><span data-stu-id="d105a-108">[**IMFVideoMixerBitmap**](/windows/desktop/api/evr9/nn-evr9-imfvideomixerbitmap) interface</span></span>   | <span data-ttu-id="d105a-109">Alpha-將靜態點陣圖影像混合到影片上。</span><span class="sxs-lookup"><span data-stu-id="d105a-109">Alpha-blends a static bitmap image onto the video.</span></span>                                                                                                                                                                                          |
| <span data-ttu-id="d105a-110">[**IMFVideoMixerControl**](/windows/desktop/api/evr/nn-evr-imfvideomixercontrol) 介面</span><span class="sxs-lookup"><span data-stu-id="d105a-110">[**IMFVideoMixerControl**](/windows/desktop/api/evr/nn-evr-imfvideomixercontrol) interface</span></span> | <span data-ttu-id="d105a-111">控制 EVR 混合影片子串流的方式。</span><span class="sxs-lookup"><span data-stu-id="d105a-111">Controls how the EVR mixes video substreams.</span></span>                                                                                                                                                                                                |
| <span data-ttu-id="d105a-112">[**IMFVideoProcessor**](/windows/desktop/api/evr9/nn-evr9-imfvideoprocessor) 介面</span><span class="sxs-lookup"><span data-stu-id="d105a-112">[**IMFVideoProcessor**](/windows/desktop/api/evr9/nn-evr9-imfvideoprocessor) interface</span></span>       | <span data-ttu-id="d105a-113">控制色彩調整、影像篩選和其他影片處理功能。</span><span class="sxs-lookup"><span data-stu-id="d105a-113">Controls color adjustment, image filters, and other video processing capabilities.</span></span> <span data-ttu-id="d105a-114">這個介面可讓您存取圖形驅動程式所執行的功能，因此確切的功能將取決於使用者的圖形驅動程式。</span><span class="sxs-lookup"><span data-stu-id="d105a-114">This interface provides access to functionality implemented by the graphics driver, so the exact capabilities will depend on the user's graphics driver.</span></span> |



 

<span data-ttu-id="d105a-115">取得這些介面指標的正確方式，取決於您使用的是 EVR 的 DirectShow 版本或媒體基礎版本。</span><span class="sxs-lookup"><span data-stu-id="d105a-115">The correct way to get pointers to these interfaces depends on whether you are using the DirectShow version of the EVR or the Media Foundation version.</span></span> <span data-ttu-id="d105a-116">針對媒體基礎 EVR，它也取決於您是直接使用 EVR 或透過 [媒體會話](media-session.md)使用。</span><span class="sxs-lookup"><span data-stu-id="d105a-116">For the Media Foundation EVR, it also depends on whether you are using the EVR directly or using it through the [Media Session](media-session.md).</span></span> <span data-ttu-id="d105a-117"> (，應用程式通常會透過媒體會話使用 EVR，而不是直接) 。</span><span class="sxs-lookup"><span data-stu-id="d105a-117">(Typically an application will use the EVR through the Media Session, not directly).</span></span>

<span data-ttu-id="d105a-118">若要取得這些介面的指標，請執行下列動作：</span><span class="sxs-lookup"><span data-stu-id="d105a-118">To get a pointer to any of these interfaces, do the following:</span></span>

1.  <span data-ttu-id="d105a-119">取得 EVR 上 [**IMFGetService**](/windows/desktop/api/mfidl/nn-mfidl-imfgetservice) 介面的指標。</span><span class="sxs-lookup"><span data-stu-id="d105a-119">Get a pointer to the [**IMFGetService**](/windows/desktop/api/mfidl/nn-mfidl-imfgetservice) interface on the EVR.</span></span>

    -   <span data-ttu-id="d105a-120">如果您使用的是 DirectShow EVR 篩選器，請在篩選器上呼叫 **QueryInterface** 。</span><span class="sxs-lookup"><span data-stu-id="d105a-120">If you are using the DirectShow EVR filter, call **QueryInterface** on the filter.</span></span>

    -   <span data-ttu-id="d105a-121">如果您直接使用 EVR 媒體接收，請在媒體接收器上呼叫 **QueryInterface** 。</span><span class="sxs-lookup"><span data-stu-id="d105a-121">If you are using the EVR media sink directly, call **QueryInterface** on the media sink.</span></span>

    -   <span data-ttu-id="d105a-122">如果您使用媒體會話，請呼叫媒體會話上的 **QueryInterface** 。</span><span class="sxs-lookup"><span data-stu-id="d105a-122">If you are using the Media Session, call **QueryInterface** on the Media Session.</span></span>

2.  <span data-ttu-id="d105a-123">如果您使用媒體會話，請等候媒體會話傳送 [MESessionTopologyStatus](mesessiontopologystatus.md) 事件，其狀態值為 [已就緒的 MF TOPOSTATUS] \_ \_ 。</span><span class="sxs-lookup"><span data-stu-id="d105a-123">If you are using the Media Session, wait for the Media Session to send the [MESessionTopologyStatus](mesessiontopologystatus.md) event with a status value of MF\_TOPOSTATUS\_READY.</span></span> <span data-ttu-id="d105a-124">如果您不是使用媒體會話， (略過此步驟。 ) </span><span class="sxs-lookup"><span data-stu-id="d105a-124">(Skip this step if you are not using the Media Session.)</span></span>

3.  <span data-ttu-id="d105a-125">呼叫 [**IMFGetService：： GetService**](/windows/desktop/api/mfidl/nf-mfidl-imfgetservice-getservice) 以取得混音器介面。</span><span class="sxs-lookup"><span data-stu-id="d105a-125">Call [**IMFGetService::GetService**](/windows/desktop/api/mfidl/nf-mfidl-imfgetservice-getservice) to get the mixer interface.</span></span> <span data-ttu-id="d105a-126">使用服務識別碼 MR 的 \_ 影片 \_ 混音器 \_ 服務。</span><span class="sxs-lookup"><span data-stu-id="d105a-126">Use the service identifier MR\_VIDEO\_MIXER\_SERVICE.</span></span>

## <a name="alpha-blending-a-bitmap-onto-the-video"></a><span data-ttu-id="d105a-127">將點陣圖混合到影片上的 Alpha</span><span class="sxs-lookup"><span data-stu-id="d105a-127">Alpha Blending a Bitmap onto the Video</span></span>

<span data-ttu-id="d105a-128">您可以在播放期間使用 [**IMFVideoMixerBitmap**](/windows/desktop/api/evr9/nn-evr9-imfvideomixerbitmap) 介面，將靜態點陣圖帶到影片上。</span><span class="sxs-lookup"><span data-stu-id="d105a-128">You can use the [**IMFVideoMixerBitmap**](/windows/desktop/api/evr9/nn-evr9-imfvideomixerbitmap) interface to alpha blend a static bitmap onto the video during playback.</span></span> <span data-ttu-id="d105a-129">您可以在 Direct3D 介面中儲存點陣圖，並將其指定為 **IDirect3DSurface9** 指標，或使用 GDI 點陣圖。</span><span class="sxs-lookup"><span data-stu-id="d105a-129">You can store the bitmap in a Direct3D surface, specified as an **IDirect3DSurface9** pointer, or use a GDI bitmap.</span></span>

<span data-ttu-id="d105a-130">如果您使用適用于點陣圖的 Direct3D 介面，此介面可包含每圖元的 Alpha 資料，而這會在混音器 Alpha-混合影像時使用。</span><span class="sxs-lookup"><span data-stu-id="d105a-130">If you use a Direct3D surface for the bitmap, the surface can contain per-pixel alpha data, which will be used when the mixer alpha-blends the image.</span></span> <span data-ttu-id="d105a-131">或者，您可以定義色彩索引鍵，也就是在點陣圖中出現的任何地方都是透明的單一色彩。</span><span class="sxs-lookup"><span data-stu-id="d105a-131">Alternatively, you can define a color key—that is, a single color that will be transparent wherever it appears in the bitmap.</span></span> <span data-ttu-id="d105a-132">此外，您也可以指定將套用至整個影像的 Alpha 值。</span><span class="sxs-lookup"><span data-stu-id="d105a-132">Also, you can specify an alpha value that will be applied to the entire image.</span></span> <span data-ttu-id="d105a-133">您也可以設定來源矩形來裁剪點陣圖，並設定目的地矩形以將點陣圖放置於影片框架內。</span><span class="sxs-lookup"><span data-stu-id="d105a-133">You can also set a source rectangle to crop the bitmap, and a destination rectangle to position the bitmap within the video frame.</span></span>

<span data-ttu-id="d105a-134">若要設定點陣圖，請呼叫 [**IMFVideoMixerBitmap：： SetAlphaBitmap**](/windows/desktop/api/evr9/nf-evr9-imfvideomixerbitmap-setalphabitmap)。</span><span class="sxs-lookup"><span data-stu-id="d105a-134">To set the bitmap, call [**IMFVideoMixerBitmap::SetAlphaBitmap**](/windows/desktop/api/evr9/nf-evr9-imfvideomixerbitmap-setalphabitmap).</span></span> <span data-ttu-id="d105a-135">這個方法會採用 [**MFVideoAlphaBitmap**](/windows/desktop/api/evr9/ns-evr9-mfvideoalphabitmap) 結構的指標，此結構會指定點陣圖和 Alpha 混合參數。</span><span class="sxs-lookup"><span data-stu-id="d105a-135">This method takes a pointer to an [**MFVideoAlphaBitmap**](/windows/desktop/api/evr9/ns-evr9-mfvideoalphabitmap) structure that specifies the bitmap and the alpha-blending parameters.</span></span> <span data-ttu-id="d105a-136">如需範例程式碼，請參閱 **SetAlphaBitmap** 方法的參考主題。</span><span class="sxs-lookup"><span data-stu-id="d105a-136">For example code, see the reference topic for the **SetAlphaBitmap** method.</span></span>

<span data-ttu-id="d105a-137">設定點陣圖之後，您可以藉由呼叫 [**IMFVideoMixerBitmap：： UpdateAlphaBitmapParameters**](/windows/desktop/api/evr9/nf-evr9-imfvideomixerbitmap-updatealphabitmapparameters)來更新混合參數，包括來源和目的地 recangles。</span><span class="sxs-lookup"><span data-stu-id="d105a-137">After you set the bitmap, you can update the blending parameters, including the source and destination recangles, by calling [**IMFVideoMixerBitmap::UpdateAlphaBitmapParameters**](/windows/desktop/api/evr9/nf-evr9-imfvideomixerbitmap-updatealphabitmapparameters).</span></span> <span data-ttu-id="d105a-138">更新會在下一個影片畫面上生效。</span><span class="sxs-lookup"><span data-stu-id="d105a-138">The update takes effect on the next video frame.</span></span> <span data-ttu-id="d105a-139">必須播放影片，才能進行更新。</span><span class="sxs-lookup"><span data-stu-id="d105a-139">The video must be playing for the update to occur.</span></span> <span data-ttu-id="d105a-140">您可以使用這個方法，在點陣圖上執行簡單的動畫。</span><span class="sxs-lookup"><span data-stu-id="d105a-140">You can use this method to perform simple animations on the bitmap.</span></span> <span data-ttu-id="d105a-141"> (如果您需要更複雜的效果，請考慮撰寫自訂的 EVR 混音器。 ) </span><span class="sxs-lookup"><span data-stu-id="d105a-141">(If you need more sophisticated effects, consider writing a custom EVR mixer.)</span></span>

<span data-ttu-id="d105a-142">若要清除點陣圖，請呼叫 [**IMFVideoMixerBitmap：： ClearAlphaBitmap**](/windows/desktop/api/evr9/nf-evr9-imfvideomixerbitmap-clearalphabitmap)。</span><span class="sxs-lookup"><span data-stu-id="d105a-142">To clear the bitmap, call [**IMFVideoMixerBitmap::ClearAlphaBitmap**](/windows/desktop/api/evr9/nf-evr9-imfvideomixerbitmap-clearalphabitmap).</span></span>

## <a name="controlling-substreams"></a><span data-ttu-id="d105a-143">控制子串流</span><span class="sxs-lookup"><span data-stu-id="d105a-143">Controlling Substreams</span></span>

<span data-ttu-id="d105a-144">EVR 可將一或多個影片子串流混合到主要影片串流。</span><span class="sxs-lookup"><span data-stu-id="d105a-144">The EVR can mix one or more video substreams onto the primary video stream.</span></span> <span data-ttu-id="d105a-145">若要控制子流混合，請使用 [**IMFVideoMixerControl**](/windows/desktop/api/evr/nn-evr-imfvideomixercontrol) 介面。</span><span class="sxs-lookup"><span data-stu-id="d105a-145">To control substream mixing, use the [**IMFVideoMixerControl**](/windows/desktop/api/evr/nn-evr-imfvideomixercontrol) interface.</span></span>

-   <span data-ttu-id="d105a-146">呼叫 [**IMFVideoMixerControl：： SetStreamOutputRect**](/windows/desktop/api/evr/nf-evr-imfvideomixercontrol-setstreamoutputrect) ，在複合的影片框架內設定子串流的位置。</span><span class="sxs-lookup"><span data-stu-id="d105a-146">Call [**IMFVideoMixerControl::SetStreamOutputRect**](/windows/desktop/api/evr/nf-evr-imfvideomixercontrol-setstreamoutputrect) to set the position of a substream within the composited video frame.</span></span>

-   <span data-ttu-id="d105a-147">呼叫 [**IMFVideoMixerControl：： SetStreamZOrder**](/windows/desktop/api/evr/nf-evr-imfvideomixercontrol-setstreamzorder) 來設定子串流的迭置順序。</span><span class="sxs-lookup"><span data-stu-id="d105a-147">Call [**IMFVideoMixerControl::SetStreamZOrder**](/windows/desktop/api/evr/nf-evr-imfvideomixercontrol-setstreamzorder) to set the z-order for the substreams.</span></span> <span data-ttu-id="d105a-148">EVR 會以其 z 順序值的順序（從零開始）繪製影片串流。</span><span class="sxs-lookup"><span data-stu-id="d105a-148">The EVR draws the video streams in the order of their z-order values, starting with zero.</span></span> <span data-ttu-id="d105a-149">主要影片資料流程一律會先以 z 順序排列。</span><span class="sxs-lookup"><span data-stu-id="d105a-149">The primary video stream is always first in the z-order.</span></span>

## <a name="video-processor-settings"></a><span data-ttu-id="d105a-150">視頻處理器設定</span><span class="sxs-lookup"><span data-stu-id="d105a-150">Video Processor Settings</span></span>

<span data-ttu-id="d105a-151">EVR 混音器使用 DirectX Video 加速 (DXVA) 在輸入串流上執行影片處理。</span><span class="sxs-lookup"><span data-stu-id="d105a-151">The EVR mixer uses DirectX Video Acceleration (DXVA) to perform video processing on the input streams.</span></span> <span data-ttu-id="d105a-152">確切的處理功能取決於圖形驅動程式。</span><span class="sxs-lookup"><span data-stu-id="d105a-152">The exact processing capabilities depend on the graphics driver.</span></span> <span data-ttu-id="d105a-153">影片處理功能是使用 [**DXVA2 \_ VideoProcessorCaps**](/windows/desktop/api/dxva2api/ns-dxva2api-dxva2_videoprocessorcaps) 結構來描述。</span><span class="sxs-lookup"><span data-stu-id="d105a-153">Video processing capabilities are described by using the [**DXVA2\_VideoProcessorCaps**](/windows/desktop/api/dxva2api/ns-dxva2api-dxva2_videoprocessorcaps) structure.</span></span> <span data-ttu-id="d105a-154">一組特定的功能稱為「 *影片處理模式*」，每個模式都是由 GUID 所識別。</span><span class="sxs-lookup"><span data-stu-id="d105a-154">A particular set of capabilities is called a *video processing mode*, each mode being identified by a GUID.</span></span> <span data-ttu-id="d105a-155">如需預先定義的 Guid 清單，請參閱 [**IDirectXVideoProcessorService：： GetVideoProcessorDeviceGuids**](/windows/desktop/api/dxva2api/nf-dxva2api-idirectxvideoprocessorservice-getvideoprocessordeviceguids)。</span><span class="sxs-lookup"><span data-stu-id="d105a-155">For a list of predefined GUIDs, see [**IDirectXVideoProcessorService::GetVideoProcessorDeviceGuids**](/windows/desktop/api/dxva2api/nf-dxva2api-idirectxvideoprocessorservice-getvideoprocessordeviceguids).</span></span> <span data-ttu-id="d105a-156">驅動程式可能會定義其他廠商專屬的 Guid，以代表不同的功能組合。</span><span class="sxs-lookup"><span data-stu-id="d105a-156">The driver might define additional vendor-specific GUIDs, representing different combinations of capabilities.</span></span>

<span data-ttu-id="d105a-157">若要尋找支援的模式及每種模式的功能，請執行下列動作：</span><span class="sxs-lookup"><span data-stu-id="d105a-157">To find the supported modes and the capabilities of each mode, do the following:</span></span>

1.  <span data-ttu-id="d105a-158">呼叫 [**IMFGetService：： GetService**](/windows/desktop/api/mfidl/nf-mfidl-imfgetservice-getservice) ，以取得混音器 [**IMFVideoProcessor**](/windows/desktop/api/evr9/nn-evr9-imfvideoprocessor) 介面的指標。</span><span class="sxs-lookup"><span data-stu-id="d105a-158">Call [**IMFGetService::GetService**](/windows/desktop/api/mfidl/nf-mfidl-imfgetservice-getservice) to get a pointer to the mixer's [**IMFVideoProcessor**](/windows/desktop/api/evr9/nn-evr9-imfvideoprocessor) interface.</span></span>

2.  <span data-ttu-id="d105a-159">呼叫 [**IMFVideoProcessor：： GetAvailableVideoProcessorModes**](/windows/desktop/api/evr9/nf-evr9-imfvideoprocessor-getavailablevideoprocessormodes)。</span><span class="sxs-lookup"><span data-stu-id="d105a-159">Call [**IMFVideoProcessor::GetAvailableVideoProcessorModes**](/windows/desktop/api/evr9/nf-evr9-imfvideoprocessor-getavailablevideoprocessormodes).</span></span> <span data-ttu-id="d105a-160">這個方法會傳回 Guid 陣列，識別可用的視頻處理器模式。</span><span class="sxs-lookup"><span data-stu-id="d105a-160">This method returns an array of GUIDs, which identify the available video processor modes.</span></span> <span data-ttu-id="d105a-161">清單會以遞減的品質順序傳回，最高品質的模式會先出現在清單中。</span><span class="sxs-lookup"><span data-stu-id="d105a-161">The list is returned in descending quality order, the mode with the highest quality appearing first in the list.</span></span> <span data-ttu-id="d105a-162">清單可以根據影片的格式而變更。</span><span class="sxs-lookup"><span data-stu-id="d105a-162">The list can change depending on the format of the video.</span></span>

3.  <span data-ttu-id="d105a-163">針對清單中的每個 GUID，呼叫 [**IMFVideoProcessor：： GetVideoProcessorCaps**](/windows/desktop/api/evr9/nf-evr9-imfvideoprocessor-getvideoprocessorcaps) 以找出對應的視頻處理器模式的功能。</span><span class="sxs-lookup"><span data-stu-id="d105a-163">For each GUID in the list, call [**IMFVideoProcessor::GetVideoProcessorCaps**](/windows/desktop/api/evr9/nf-evr9-imfvideoprocessor-getvideoprocessorcaps) to find the capabilities of the corresponding video processor mode.</span></span> <span data-ttu-id="d105a-164">方法會以功能的描述填入 [**DXVA2 的 \_ VideoProcessorCaps**](/windows/desktop/api/dxva2api/ns-dxva2api-dxva2_videoprocessorcaps) 結構。</span><span class="sxs-lookup"><span data-stu-id="d105a-164">The method fills a [**DXVA2\_VideoProcessorCaps**](/windows/desktop/api/dxva2api/ns-dxva2api-dxva2_videoprocessorcaps) structure with a description of the capabilities.</span></span>

4.  <span data-ttu-id="d105a-165">若要選取模式，請呼叫 [**IMFVideoProcessor：： SetVideoProcessorMode**](/windows/desktop/api/evr9/nf-evr9-imfvideoprocessor-setvideoprocessormode)。</span><span class="sxs-lookup"><span data-stu-id="d105a-165">To select a mode, call [**IMFVideoProcessor::SetVideoProcessorMode**](/windows/desktop/api/evr9/nf-evr9-imfvideoprocessor-setvideoprocessormode).</span></span> <span data-ttu-id="d105a-166">否則，EVR 會在串流處理開始時自動選取模式。</span><span class="sxs-lookup"><span data-stu-id="d105a-166">Otherwise, the EVR automatically selects a mode when streaming begins.</span></span> <span data-ttu-id="d105a-167">在這種情況下，您可以呼叫 [**IMFVideoProcessor：： GetVideoProcessorMode**](/windows/desktop/api/evr9/nf-evr9-imfvideoprocessor-getvideoprocessormode) 來找出選取的模式。</span><span class="sxs-lookup"><span data-stu-id="d105a-167">In that case, you can call [**IMFVideoProcessor::GetVideoProcessorMode**](/windows/desktop/api/evr9/nf-evr9-imfvideoprocessor-getvideoprocessormode) to find which mode was selected.</span></span>

<span data-ttu-id="d105a-168">[**DXVA2 \_ VideoProcessorCaps**](/windows/desktop/api/dxva2api/ns-dxva2api-dxva2_videoprocessorcaps)結構中大部分的欄位都會描述低層級的驅動程式行為，而且在一般應用程式中並不感興趣。</span><span class="sxs-lookup"><span data-stu-id="d105a-168">Most of the fields in the [**DXVA2\_VideoProcessorCaps**](/windows/desktop/api/dxva2api/ns-dxva2api-dxva2_videoprocessorcaps) structure describe low-level driver behavior and are not of interest in a typical application.</span></span> <span data-ttu-id="d105a-169">以下是最有可能感興趣的欄位：</span><span class="sxs-lookup"><span data-stu-id="d105a-169">The following fields are most likely to be of interest:</span></span>

-   <span data-ttu-id="d105a-170">**DeviceCaps**。</span><span class="sxs-lookup"><span data-stu-id="d105a-170">**DeviceCaps**.</span></span> <span data-ttu-id="d105a-171">此欄位指出影片處理是否在硬體或軟體中執行，以及圖形驅動程式是否為較舊的 DXVA 1.0 驅動程式。</span><span class="sxs-lookup"><span data-stu-id="d105a-171">This field indicates whether video processing is performed in hardware or software, and whether the graphics driver is an older DXVA 1.0 driver.</span></span>

-   <span data-ttu-id="d105a-172">**DeinterlaceTechnology**。</span><span class="sxs-lookup"><span data-stu-id="d105a-172">**DeinterlaceTechnology**.</span></span> <span data-ttu-id="d105a-173">如果來源影片是交錯的，則此欄位可提供您預期的去交錯品質層級的指示。</span><span class="sxs-lookup"><span data-stu-id="d105a-173">This field provides some indication of what level of deinterlacing quality you can expect if the source video is interlaced.</span></span>

-   <span data-ttu-id="d105a-174">**ProcAmpControlCaps**。</span><span class="sxs-lookup"><span data-stu-id="d105a-174">**ProcAmpControlCaps**.</span></span> <span data-ttu-id="d105a-175">此欄位會指定可用的色彩調整控制項。</span><span class="sxs-lookup"><span data-stu-id="d105a-175">This field specifies which color adjustment controls are available.</span></span> <span data-ttu-id="d105a-176">如需可能的色彩調整清單，請參閱 [ProcAmp 設定](procamp-settings.md)。</span><span class="sxs-lookup"><span data-stu-id="d105a-176">For a list of possible color adjustments, see [ProcAmp Settings](procamp-settings.md).</span></span> <span data-ttu-id="d105a-177">如果驅動程式無法執行色彩調整，則此欄位為零。</span><span class="sxs-lookup"><span data-stu-id="d105a-177">If the driver cannot perform color adjustment, this field is zero.</span></span>

-   <span data-ttu-id="d105a-178">**VideoProcessorOperations**。</span><span class="sxs-lookup"><span data-stu-id="d105a-178">**VideoProcessorOperations**.</span></span> <span data-ttu-id="d105a-179">此欄位包含描述其他影片處理功能的旗標。</span><span class="sxs-lookup"><span data-stu-id="d105a-179">This field contains flags that describe miscellaneous video processing capabilities.</span></span> <span data-ttu-id="d105a-180">特定重要性的兩個旗標是 DXVA2 \_ VideoProcess \_ 子串流旗標和 DXVA2 \_ VideoProcess \_ 子串流旗標。</span><span class="sxs-lookup"><span data-stu-id="d105a-180">Two flags of particular importance are the DXVA2\_VideoProcess\_SubStreams flag and the DXVA2\_VideoProcess\_SubStreams flag.</span></span> <span data-ttu-id="d105a-181">EVR 必須至少有其中一個旗標，才能將子串流混合到參考影片串流。</span><span class="sxs-lookup"><span data-stu-id="d105a-181">At least one of these flags must be present for the EVR to mix substreams onto the reference video stream.</span></span> <span data-ttu-id="d105a-182">如果兩個旗標都不存在，則 EVR 會限制為一個影片串流。</span><span class="sxs-lookup"><span data-stu-id="d105a-182">If neither flag is present, the EVR is limited to one video stream.</span></span>

-   <span data-ttu-id="d105a-183">**NoiseFilterTechnology**。</span><span class="sxs-lookup"><span data-stu-id="d105a-183">**NoiseFilterTechnology**.</span></span> <span data-ttu-id="d105a-184">此欄位指出圖形驅動程式支援哪些雜訊篩選。</span><span class="sxs-lookup"><span data-stu-id="d105a-184">This field indicates which noise filters are supported by the graphics driver.</span></span> <span data-ttu-id="d105a-185">如果驅動程式不支援雜訊篩選，則此值為不 \_ 支援的 DXVA2 NoiseFilterTech \_ 。</span><span class="sxs-lookup"><span data-stu-id="d105a-185">If the driver does not support noise filtering, the value is DXVA2\_NoiseFilterTech\_Unsupported.</span></span>

-   <span data-ttu-id="d105a-186">**DetailFilterTechnology**。</span><span class="sxs-lookup"><span data-stu-id="d105a-186">**DetailFilterTechnology**.</span></span> <span data-ttu-id="d105a-187">此欄位會指出圖形驅動程式支援的詳細資料篩選。</span><span class="sxs-lookup"><span data-stu-id="d105a-187">This field indicates which detail filters are supported by the graphics driver.</span></span> <span data-ttu-id="d105a-188">如果驅動程式不支援雜訊篩選，則此值為不 \_ 支援的 DXVA2 DetailFilterTech \_ 。</span><span class="sxs-lookup"><span data-stu-id="d105a-188">If the driver does not support noise filtering, the value is DXVA2\_DetailFilterTech\_Unsupported.</span></span>

## <a name="color-adjustment-and-image-filtering"></a><span data-ttu-id="d105a-189">色彩調整和影像篩選</span><span class="sxs-lookup"><span data-stu-id="d105a-189">Color Adjustment and Image Filtering</span></span>

<span data-ttu-id="d105a-190">圖形驅動程式可能支援色彩調整 (也稱為「 *處理放大* 」或單純 *ProcAmp*) 和影像篩選。</span><span class="sxs-lookup"><span data-stu-id="d105a-190">The graphics driver might support color adjustment (also called *process amplification* or simply *ProcAmp*) and image filtering.</span></span> <span data-ttu-id="d105a-191">當 GPU 執行時，可以即時完成色彩調整和影像篩選，而不會產生 CPU 額外負荷。</span><span class="sxs-lookup"><span data-stu-id="d105a-191">When performed by the GPU, color adjustment and image filtering can be done in real time with no CPU overhead.</span></span>

<span data-ttu-id="d105a-192">若要使用這些功能，請執行下列步驟：</span><span class="sxs-lookup"><span data-stu-id="d105a-192">To use these features, perform the following steps:</span></span>

1.  <span data-ttu-id="d105a-193">選取影片處理模式，如上一節所述。</span><span class="sxs-lookup"><span data-stu-id="d105a-193">Select a video processing mode as described in the previous section.</span></span>

2.  <span data-ttu-id="d105a-194">如前一節所述，呼叫 [**IMFVideoProcessor：： GetVideoProcessorCaps**](/windows/desktop/api/evr9/nf-evr9-imfvideoprocessor-getvideoprocessorcaps) 來尋找影片處理功能。</span><span class="sxs-lookup"><span data-stu-id="d105a-194">Call [**IMFVideoProcessor::GetVideoProcessorCaps**](/windows/desktop/api/evr9/nf-evr9-imfvideoprocessor-getvideoprocessorcaps) to find the video processing capabilities as described in the previous section.</span></span> <span data-ttu-id="d105a-195">方法會填入描述功能的 [**DXVA2 \_ VideoProcessorCaps**](/windows/desktop/api/dxva2api/ns-dxva2api-dxva2_videoprocessorcaps) 結構，包括驅動程式是否支援色彩調整和影像篩選。</span><span class="sxs-lookup"><span data-stu-id="d105a-195">The method fills in a [**DXVA2\_VideoProcessorCaps**](/windows/desktop/api/dxva2api/ns-dxva2api-dxva2_videoprocessorcaps) structure which describes the capabilities, including whether the driver supports color adjustment and image filter.</span></span>

3.  <span data-ttu-id="d105a-196">針對驅動程式所支援的每個色彩調整，呼叫 [**IMFVideoProcessor：： GetProcAmpRange**](/windows/desktop/api/evr9/nf-evr9-imfvideoprocessor-getprocamprange) 來尋找該設定的可能值範圍。</span><span class="sxs-lookup"><span data-stu-id="d105a-196">For each color adjustment that is supported by driver, call [**IMFVideoProcessor::GetProcAmpRange**](/windows/desktop/api/evr9/nf-evr9-imfvideoprocessor-getprocamprange) to find the possible range of value for that setting.</span></span> <span data-ttu-id="d105a-197">這個方法也會傳回設定的預設值。</span><span class="sxs-lookup"><span data-stu-id="d105a-197">This method also returns the default value for the setting.</span></span> <span data-ttu-id="d105a-198">呼叫 [**IMFVideoProcessor：： GetProcAmpValues**](/windows/desktop/api/evr9/nf-evr9-imfvideoprocessor-getprocampvalues) 來尋找設定的目前值。</span><span class="sxs-lookup"><span data-stu-id="d105a-198">Call [**IMFVideoProcessor::GetProcAmpValues**](/windows/desktop/api/evr9/nf-evr9-imfvideoprocessor-getprocampvalues) to find the current value of the settings.</span></span> <span data-ttu-id="d105a-199">值沒有指定的單位。</span><span class="sxs-lookup"><span data-stu-id="d105a-199">The values do not have specified units.</span></span> <span data-ttu-id="d105a-200">驅動程式是由驅動程式來定義值的範圍。</span><span class="sxs-lookup"><span data-stu-id="d105a-200">It is up to the driver to define the range of values.</span></span>

4.  <span data-ttu-id="d105a-201">呼叫 [**IMFVideoProcessor：： SetFilteringValue**](/windows/desktop/api/evr9/nf-evr9-imfvideoprocessor-setfilteringvalue) 來設定色彩調整值。</span><span class="sxs-lookup"><span data-stu-id="d105a-201">Call [**IMFVideoProcessor::SetFilteringValue**](/windows/desktop/api/evr9/nf-evr9-imfvideoprocessor-setfilteringvalue) to set a color adjustment value.</span></span>

5.  <span data-ttu-id="d105a-202">如果驅動程式支援影像篩選，則每個篩選器類型 (雜訊和詳細資料) 支援三個設定（層級、半徑和臨界值），兩者都是在色度和 luma 中。</span><span class="sxs-lookup"><span data-stu-id="d105a-202">If the driver supports image filtering, then each filter type (noise and detail) supports three settings—level, radius, and threshold—in both chroma and luma.</span></span> <span data-ttu-id="d105a-203"> (參閱 [DXVA 影像篩選設定](dxva-image-filter-settings.md)。針對每個設定 ) ，呼叫 [**IMFVideoProcessor：： GetFilteringRange**](/windows/desktop/api/evr9/nf-evr9-imfvideoprocessor-getfilteringrange) 以取得可能值的範圍，並呼叫 [**IMFVideoProcessor：： GetFilteringValue**](/windows/desktop/api/evr9/nf-evr9-imfvideoprocessor-getfilteringvalue) 來取得目前的值。</span><span class="sxs-lookup"><span data-stu-id="d105a-203">(See [DXVA Image Filter Settings](dxva-image-filter-settings.md).) For each setting, call [**IMFVideoProcessor::GetFilteringRange**](/windows/desktop/api/evr9/nf-evr9-imfvideoprocessor-getfilteringrange) to get the range of possible values and call [**IMFVideoProcessor::GetFilteringValue**](/windows/desktop/api/evr9/nf-evr9-imfvideoprocessor-getfilteringvalue) to get the current value.</span></span>

6.  <span data-ttu-id="d105a-204">若要變更影像篩選設定，請呼叫 [**IMFVideoProcessor：： SetFilteringValue**](/windows/desktop/api/evr9/nf-evr9-imfvideoprocessor-setfilteringvalue)。</span><span class="sxs-lookup"><span data-stu-id="d105a-204">To change an image filter setting, call [**IMFVideoProcessor::SetFilteringValue**](/windows/desktop/api/evr9/nf-evr9-imfvideoprocessor-setfilteringvalue).</span></span>

## <a name="related-topics"></a><span data-ttu-id="d105a-205">相關主題</span><span class="sxs-lookup"><span data-stu-id="d105a-205">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="d105a-206">增強的影片轉譯器</span><span class="sxs-lookup"><span data-stu-id="d105a-206">Enhanced Video Renderer</span></span>](enhanced-video-renderer.md)
</dt> </dl>

 

 



