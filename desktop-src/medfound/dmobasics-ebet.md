---
description: SQL-DMO 基本概念
ms.assetid: eaf453d2-69f8-432a-8a58-1ed70778f182
title: 'SQL-DMO 基本 (Microsoft 媒體基礎) '
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 44b1aca2fcd7e70cf78e2e95135aee73c454b910
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/07/2021
ms.locfileid: "104191056"
---
# <a name="dmo-basics-microsoft-media-foundation"></a><span data-ttu-id="902ce-103">SQL-DMO 基本 (Microsoft 媒體基礎) </span><span class="sxs-lookup"><span data-stu-id="902ce-103">DMO Basics (Microsoft Media Foundation)</span></span>

<span data-ttu-id="902ce-104">本主題提供 DMOs 的簡短總覽，因為它們與 Windows Media 編解碼器相關。</span><span class="sxs-lookup"><span data-stu-id="902ce-104">This topic provides a brief overview of DMOs as they relate to Windows Media Codecs.</span></span> <span data-ttu-id="902ce-105">如需 DMOs 的詳細資訊，請參閱 [DirectX 媒體物件](../directshow/directx-media-objects.md)。</span><span class="sxs-lookup"><span data-stu-id="902ce-105">For more information about DMOs, see [DirectX Media Objects](../directshow/directx-media-objects.md).</span></span>

<span data-ttu-id="902ce-106">SQL-DMO 是轉換資料的 COM 物件。</span><span class="sxs-lookup"><span data-stu-id="902ce-106">A DMO is a COM object that transforms data.</span></span> <span data-ttu-id="902ce-107">您將資料傳遞給它，它會傳回已轉換的資料。</span><span class="sxs-lookup"><span data-stu-id="902ce-107">You pass data to it, and it returns the transformed data.</span></span> <span data-ttu-id="902ce-108">在編解碼器編碼器的案例中，您會輸入未壓縮的媒體資料，而是會提供壓縮的媒體資料。</span><span class="sxs-lookup"><span data-stu-id="902ce-108">In the case of a codec encoder DMO, you input uncompressed media data and the DMO delivers compressed media data.</span></span> <span data-ttu-id="902ce-109">使用 DMOs 的主要優點是它們都是採用相同的基底介面 [**IMediaObject**](/previous-versions/windows/desktop/api/mediaobj/nn-mediaobj-imediaobject)，因為您可以使用相同的物件，而不考慮正在執行的轉換類型。</span><span class="sxs-lookup"><span data-stu-id="902ce-109">The primary advantage of using DMOs is that they all implement the same base interface, [**IMediaObject**](/previous-versions/windows/desktop/api/mediaobj/nn-mediaobj-imediaobject), which simplifies working with them because you can use the same object, regardless of the type of transformation being performed.</span></span>

<span data-ttu-id="902ce-110">因為任何類型的資料轉換都有相關的變數，所以音訊和影片轉換必須考慮各種可能的媒體配置。</span><span class="sxs-lookup"><span data-stu-id="902ce-110">Because there are variables involved in any sort of data transformation, audio and video transformation must take into account the wide range of possible media configurations.</span></span> <span data-ttu-id="902ce-111">Windows Media 音訊和影片編解碼器也支援一些您必須能夠使用 SQL-DMO 設定的特殊功能。</span><span class="sxs-lookup"><span data-stu-id="902ce-111">The Windows Media Audio and Video codecs also support a number of special features that you must be able to configure by using the DMO.</span></span>

<span data-ttu-id="902ce-112">一般而言，編解碼器 DMOs 壓縮和解壓縮數位媒體所需的變數資訊，會以下列三種方式之一進行傳達：</span><span class="sxs-lookup"><span data-stu-id="902ce-112">In general, the variable information that is needed by the codec DMOs to compress and decompress digital media is conveyed in one of three ways:</span></span>

-   <span data-ttu-id="902ce-113">在 SQL-DMO 上設定輸入類型，以傳達您傳遞給編碼器的未壓縮媒體的特性，以及您傳遞給解碼器的壓縮媒體特性。</span><span class="sxs-lookup"><span data-stu-id="902ce-113">Set the input type on the DMO to convey the characteristics of the uncompressed media that you pass to an encoder DMO, and the characteristics of the compressed media that you pass to a decoder DMO.</span></span>
-   <span data-ttu-id="902ce-114">將 [輸出類型] 設定為 [中]，以傳達由編碼器的已壓縮媒體的特性，以及由解碼器的非壓縮媒體的特性。</span><span class="sxs-lookup"><span data-stu-id="902ce-114">Set the output type on the DMO to convey the characteristics of the compressed media that are delivered by an encoder DMO, and the characteristics of the uncompressed media that are delivered by a decoder DMO.</span></span>
-   <span data-ttu-id="902ce-115">使用 **IPropertyBag** 介面的方法，將支援編解碼器 DMOs 各項功能的其他設定設定為屬性。</span><span class="sxs-lookup"><span data-stu-id="902ce-115">Using the methods of the **IPropertyBag** interface, configure other settings that support the various features of the codec DMOs as properties.</span></span> <span data-ttu-id="902ce-116">**IPropertyBag** 是所有編解碼器 DMOs 都支援的標準 COM 介面。</span><span class="sxs-lookup"><span data-stu-id="902ce-116">**IPropertyBag** is a standard COM interface that is supported by all of the codec DMOs.</span></span>

<span data-ttu-id="902ce-117">此外，某些編解碼器功能是使用編解碼器 DMOs 特定的其他介面來管理。</span><span class="sxs-lookup"><span data-stu-id="902ce-117">Additionally, some codec features are managed by using other interfaces that are specific to the codec DMOs.</span></span> <span data-ttu-id="902ce-118">在 [編解碼器物件](codecobjects.md)的區段中，會列出每個編解碼器的這些介面。</span><span class="sxs-lookup"><span data-stu-id="902ce-118">These interfaces are listed for each codec in the section [Codec Objects](codecobjects.md).</span></span>

<span data-ttu-id="902ce-119">輸入和輸出類型是輸入和輸出資料流程特有的。</span><span class="sxs-lookup"><span data-stu-id="902ce-119">Input and output types are specific to input and output streams.</span></span> <span data-ttu-id="902ce-120">每個串流都代表內容的離散標記法。</span><span class="sxs-lookup"><span data-stu-id="902ce-120">Each stream represents a discrete representation of the content.</span></span> <span data-ttu-id="902ce-121">例如，Windows Media 視訊的編碼器 SQL-DMO 有一個輸入資料流程，以及兩個輸出資料流程。</span><span class="sxs-lookup"><span data-stu-id="902ce-121">For example, the Windows Media Video encoder DMO has a single input stream, and two output streams.</span></span> <span data-ttu-id="902ce-122">輸入資料流程接受未壓縮的影片範例。</span><span class="sxs-lookup"><span data-stu-id="902ce-122">The input stream accepts uncompressed video samples.</span></span> <span data-ttu-id="902ce-123">這兩個輸出資料流程中的第一個會提供壓縮的範例;另一個則提供未壓縮的範例。</span><span class="sxs-lookup"><span data-stu-id="902ce-123">The first of the two output streams delivers compressed samples; the other provides uncompressed samples.</span></span> <span data-ttu-id="902ce-124">一個輸出資料流程中的個別樣本表示與另一個資料流程中對應樣本相同的內容，但每個資料流程會以不同的格式傳遞這些範例。</span><span class="sxs-lookup"><span data-stu-id="902ce-124">The individual samples in one output stream represent the same content as the corresponding samples in the other stream, but each stream delivers those samples in a different format.</span></span>

<span data-ttu-id="902ce-125">每個資料流程 (輸入或輸出) 支援一或多種類型的媒體。</span><span class="sxs-lookup"><span data-stu-id="902ce-125">Each stream (input or output) supports one or more types of media.</span></span> <span data-ttu-id="902ce-126">媒體類型或格式是由一種媒體 [**\_ \_ 類型**](/previous-versions/windows/desktop/api/mediaobj/ns-mediaobj-dmo_media_type) 結構所描述。</span><span class="sxs-lookup"><span data-stu-id="902ce-126">A media type, or format, is described by a [**DMO\_MEDIA\_TYPE**](/previous-versions/windows/desktop/api/mediaobj/ns-mediaobj-dmo_media_type) structure.</span></span> <span data-ttu-id="902ce-127">您可以藉由呼叫 [**IMediaObject：： GetOutputType**](/previous-versions/windows/desktop/api/mediaobj/nf-mediaobj-imediaobject-getoutputtype)，針對輸出資料流程所支援的類型來查詢 sql-dmo。</span><span class="sxs-lookup"><span data-stu-id="902ce-127">You can query the DMO for the types that are supported by an output stream by calling [**IMediaObject::GetOutputType**](/previous-versions/windows/desktop/api/mediaobj/nf-mediaobj-imediaobject-getoutputtype).</span></span> <span data-ttu-id="902ce-128">在某些情況下，這個方法會傳回有效的 (，但在某些情況下，該資料流程) 輸出類型部分不完整。</span><span class="sxs-lookup"><span data-stu-id="902ce-128">This method returns a valid (though in some cases partially incomplete) output type for that stream.</span></span> <span data-ttu-id="902ce-129">您可以對 **GetOutputType** 進行重複呼叫，藉此列舉輸出資料流程支援的媒體類型，並在每次呼叫時遞增類型參數。</span><span class="sxs-lookup"><span data-stu-id="902ce-129">You can enumerate the supported media types for an output stream by making repeated calls to **GetOutputType**, incrementing the type parameter with each call.</span></span> <span data-ttu-id="902ce-130">當您傳遞的型別索引超出範圍時，此方法會傳回 **Sql-dmo \_ E \_ NO \_ 其他 \_ 專案**。</span><span class="sxs-lookup"><span data-stu-id="902ce-130">When the type index that you pass is out of bounds, the method returns **DMO\_E\_NO\_MORE\_ITEMS**.</span></span> <span data-ttu-id="902ce-131">您可以使用 [**IMediaObject：： GetInputType**](/previous-versions/windows/desktop/api/mediaobj/nf-mediaobj-imediaobject-getinputtype) 方法，以相同的方式列舉輸入格式。</span><span class="sxs-lookup"><span data-stu-id="902ce-131">Input formats can be enumerated in the same way by using the [**IMediaObject::GetInputType**](/previous-versions/windows/desktop/api/mediaobj/nf-mediaobj-imediaobject-getinputtype) method.</span></span>

<span data-ttu-id="902ce-132">由 SQL-DMO 列舉的型別只是「慣用」類型，不過，也可以支援其他類型。</span><span class="sxs-lookup"><span data-stu-id="902ce-132">The types that are enumerated by the DMO are only the "preferred" types, however, other types may be supported.</span></span> <span data-ttu-id="902ce-133">您可以藉由呼叫 [**IMediaObject：： SetOutputType**](/previous-versions/windows/desktop/api/mediaobj/nf-mediaobj-imediaobject-setoutputtype)來驗證輸出類型。</span><span class="sxs-lookup"><span data-stu-id="902ce-133">You can validate an output type by calling [**IMediaObject::SetOutputType**](/previous-versions/windows/desktop/api/mediaobj/nf-mediaobj-imediaobject-setoutputtype).</span></span> <span data-ttu-id="902ce-134">使用 [**IMediaObject：： SetInputType**](/previous-versions/windows/desktop/api/mediaobj/nf-mediaobj-imediaobject-setinputtype) 來驗證輸入類型。</span><span class="sxs-lookup"><span data-stu-id="902ce-134">Use [**IMediaObject::SetInputType**](/previous-versions/windows/desktop/api/mediaobj/nf-mediaobj-imediaobject-setinputtype) to validate an input type.</span></span> <span data-ttu-id="902ce-135">如果您傳遞的 [**Sql-dmo \_ 媒體 \_ 類型**](/previous-versions/windows/desktop/api/mediaobj/ns-mediaobj-dmo_media_type)結構無效，這兩種方法都會傳回 [ **\_ \_ \_ 不 \_ 接受**]。</span><span class="sxs-lookup"><span data-stu-id="902ce-135">Both methods will return **DMO\_E\_TYPE\_NOT\_ACCEPTED** if the [**DMO\_MEDIA\_TYPE**](/previous-versions/windows/desktop/api/mediaobj/ns-mediaobj-dmo_media_type) structure you passed is invalid.</span></span> <span data-ttu-id="902ce-136">某些 DMOs 會要求您在列舉任何輸入類型之前，先設定輸出類型。</span><span class="sxs-lookup"><span data-stu-id="902ce-136">Some DMOs require you to set an output type before enumerating any input types.</span></span> <span data-ttu-id="902ce-137">Windows Media 音訊和 Video 編解碼器 DMOs 都具有具有相互依存驗證的輸入和輸出。</span><span class="sxs-lookup"><span data-stu-id="902ce-137">The Windows Media Audio and Video codec DMOs all have inputs and outputs that have interdependent validation.</span></span> <span data-ttu-id="902ce-138">也就是說，您設定的輸出類型將會設定輸入類型的驗證準則。</span><span class="sxs-lookup"><span data-stu-id="902ce-138">That is, the output type you set will set the validation criteria for the input type.</span></span> <span data-ttu-id="902ce-139">另外還有一些屬性，會在設定時改變有效的輸入和輸出類型。</span><span class="sxs-lookup"><span data-stu-id="902ce-139">There are also some properties that, when set, alter the valid input and output types.</span></span> <span data-ttu-id="902ce-140">基於這個理由，您應該先將所有想要的屬性設定在您的列舉類型之前。</span><span class="sxs-lookup"><span data-stu-id="902ce-140">For this reason, you should set all of the desired properties on the DMO before enumerating types.</span></span>

<span data-ttu-id="902ce-141">當您設定了 SQL-DMO 的輸出和輸入類型時，就可以開始處理範例。</span><span class="sxs-lookup"><span data-stu-id="902ce-141">When you have set the output and input types for the DMO, you can begin processing samples.</span></span> <span data-ttu-id="902ce-142">每個輸入範例都會使用 [**IMediaObject：:P rocessinput**](/previous-versions/windows/desktop/api/mediaobj/nf-mediaobj-imediaobject-processinput)的呼叫傳遞給編解碼器，而當您呼叫 [**IMediaObject：:P rocessoutput**](/previous-versions/windows/desktop/api/mediaobj/nf-mediaobj-imediaobject-processoutput)時，每個輸出範例都會由編解碼器傳遞。</span><span class="sxs-lookup"><span data-stu-id="902ce-142">Each input sample is passed to the codec using a call to [**IMediaObject::ProcessInput**](/previous-versions/windows/desktop/api/mediaobj/nf-mediaobj-imediaobject-processinput), and each output sample is delivered by the codec when you make a call to [**IMediaObject::ProcessOutput**](/previous-versions/windows/desktop/api/mediaobj/nf-mediaobj-imediaobject-processoutput).</span></span>

## <a name="related-topics"></a><span data-ttu-id="902ce-143">相關主題</span><span class="sxs-lookup"><span data-stu-id="902ce-143">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="902ce-144">使用編解碼器 DMOs</span><span class="sxs-lookup"><span data-stu-id="902ce-144">Working with Codec DMOs</span></span>](workingwithcodecdmos.md)
</dt> </dl>

 

 
