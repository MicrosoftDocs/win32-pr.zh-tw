---
description: 增強型影片轉譯器 (EVR) 是在使用者監視器上顯示影片的元件。
ms.assetid: 1c985558-d25d-4f51-978a-58c05943dab9
title: 增強的影片轉譯器
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 1ab0881da0827e6cc757a0ea855bcb51864dd98e
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/07/2021
ms.locfileid: "104317972"
---
# <a name="enhanced-video-renderer"></a><span data-ttu-id="91dca-103">增強的影片轉譯器</span><span class="sxs-lookup"><span data-stu-id="91dca-103">Enhanced Video Renderer</span></span>

<span data-ttu-id="91dca-104">增強型影片轉譯器 (EVR) 是在使用者的監視器上顯示影片的元件。</span><span class="sxs-lookup"><span data-stu-id="91dca-104">The enhanced video renderer (EVR) is a component that displays video on the user's monitor.</span></span> <span data-ttu-id="91dca-105">有兩個版本的 EVR 存在：</span><span class="sxs-lookup"><span data-stu-id="91dca-105">Two versions of the EVR exist:</span></span>

-   <span data-ttu-id="91dca-106">EVR 媒體接收，適用于媒體基礎應用程式。</span><span class="sxs-lookup"><span data-stu-id="91dca-106">The EVR media sink, for Media Foundation applications.</span></span>
-   <span data-ttu-id="91dca-107">EVR 篩選器，適用于 DirectShow 應用程式。</span><span class="sxs-lookup"><span data-stu-id="91dca-107">The EVR filter, for DirectShow applications.</span></span>

<span data-ttu-id="91dca-108">這兩個版本都使用相同的內建物件來轉譯影片，並共用許多相同的介面。</span><span class="sxs-lookup"><span data-stu-id="91dca-108">Both versions use the same internal objects to render video, and they share many of the same interfaces.</span></span>

<span data-ttu-id="91dca-109">EVR 最多可以混合16個影片串流。</span><span class="sxs-lookup"><span data-stu-id="91dca-109">The EVR can mix up to 16 video streams.</span></span> <span data-ttu-id="91dca-110">第一個輸入資料流程稱為 *參考資料流*。</span><span class="sxs-lookup"><span data-stu-id="91dca-110">The first input stream is called the *reference stream*.</span></span> <span data-ttu-id="91dca-111">參考資料流一律會先出現在 z 順序中。</span><span class="sxs-lookup"><span data-stu-id="91dca-111">The reference stream always appears first in the z-order.</span></span> <span data-ttu-id="91dca-112">任何額外的資料流程都稱為 *子串流*，而且會在參考資料流上方混合。</span><span class="sxs-lookup"><span data-stu-id="91dca-112">Any additional streams are called *substreams*, and are mixed on top of the reference stream.</span></span> <span data-ttu-id="91dca-113">應用程式可以變更子串流的迭置順序，但不能先以迭置順序來進行子流。</span><span class="sxs-lookup"><span data-stu-id="91dca-113">The application can change the z-order of the substreams, but no substream can be first in the z-order.</span></span>

<span data-ttu-id="91dca-114">圖形驅動程式會決定支援的影片格式，但通常僅限於下列各項：</span><span class="sxs-lookup"><span data-stu-id="91dca-114">The graphics driver determines which video formats are supported, but typically they are limited to the following:</span></span>

-   <span data-ttu-id="91dca-115">參考資料流：不含每圖元 Alpha (（例如 NV12 或 YUY2) ;）的漸進式或交錯式 YUV或漸進式 RGB。</span><span class="sxs-lookup"><span data-stu-id="91dca-115">Reference stream: Progressive or interlaced YUV with no per-pixel alpha (such as NV12 or YUY2); or progressive RGB.</span></span>
-   <span data-ttu-id="91dca-116">子串流：每圖元 Alpha 的漸進 YUV，例如 AYUV 或 AI44。</span><span class="sxs-lookup"><span data-stu-id="91dca-116">Substreams: Progressive YUV with per-pixel-alpha, such as AYUV or AI44.</span></span>

<span data-ttu-id="91dca-117">可用的子資料流程格式可能取決於參考資料流的格式。</span><span class="sxs-lookup"><span data-stu-id="91dca-117">The available substream formats might depend on the format of the reference stream.</span></span> <span data-ttu-id="91dca-118">如需詳細資訊，請參閱 [EVR 媒體類型的協商](evr-media-type-negotiation.md)。</span><span class="sxs-lookup"><span data-stu-id="91dca-118">For more information, see [EVR Media Type Negotiation](evr-media-type-negotiation.md).</span></span>

<span data-ttu-id="91dca-119">就內部而言，EVR 會使用稱為「 *混音* 器」的物件，將輸入資料流程中的畫面合成至一個介面以進行轉譯。</span><span class="sxs-lookup"><span data-stu-id="91dca-119">Internally, the EVR uses an object called the *mixer* to composite the frames from the input streams onto one surface for rendering.</span></span> <span data-ttu-id="91dca-120">混音器也會執行去交錯和色彩校正。</span><span class="sxs-lookup"><span data-stu-id="91dca-120">The mixer also performs deinterlacing and color correction.</span></span> <span data-ttu-id="91dca-121">混音器的輸出是最後一個合成的影片畫面。</span><span class="sxs-lookup"><span data-stu-id="91dca-121">The output from the mixer is the final composited video frame.</span></span> <span data-ttu-id="91dca-122">第二個物件，稱為「展示 *者* 」會將影片畫面轉譯為顯示畫面。</span><span class="sxs-lookup"><span data-stu-id="91dca-122">A second object called the *presenter* renders the video frame to the display.</span></span> <span data-ttu-id="91dca-123">展示者會在轉譯和管理 Direct3D 裝置時進行排程。</span><span class="sxs-lookup"><span data-stu-id="91dca-123">The presenter schedules when the frames are rendered and manages the Direct3D device.</span></span> <span data-ttu-id="91dca-124">應用程式可以提供混音器或展示者的自訂執行。</span><span class="sxs-lookup"><span data-stu-id="91dca-124">An application can provide a custom implementation of either the mixer or the presenter.</span></span>

<span data-ttu-id="91dca-125">輸出畫面播放速率會鎖定到參考資料流。</span><span class="sxs-lookup"><span data-stu-id="91dca-125">The output frame rate is locked to the reference stream.</span></span> <span data-ttu-id="91dca-126">每當子串流收到新的框架時，混音器就會保留在其上。</span><span class="sxs-lookup"><span data-stu-id="91dca-126">Whenever the substreams receive new frames, the mixer holds onto them.</span></span> <span data-ttu-id="91dca-127">當參考資料流收到新的框架時，會以子資料流程框架組成的混音器複合。</span><span class="sxs-lookup"><span data-stu-id="91dca-127">When the reference stream receives a new frame, the mixer composites that frame with the substream frames.</span></span> <span data-ttu-id="91dca-128"> (如果參考資料流是交錯的，則完整的參考框架可能需要一個以上的媒體範例 ) 。當混音器等待參考框架時，子資料流程可能會接收多個框架。</span><span class="sxs-lookup"><span data-stu-id="91dca-128">(If the reference stream is interlaced, a complete reference frame may require more than one media sample.) It is possible for a substream to receive more than one frame while the mixer is waiting for a reference frame.</span></span> <span data-ttu-id="91dca-129">在這種情況下，混音器只會捨棄先前的子串流框架。</span><span class="sxs-lookup"><span data-stu-id="91dca-129">In that case, the mixer simply discards the previous substream frame.</span></span>

<span data-ttu-id="91dca-130">由於展示者會建立 Direct3D 裝置，因此它也會負責與其他需要存取 DirectX Video 加速 (DXVA) 服務的管線物件共用裝置。</span><span class="sxs-lookup"><span data-stu-id="91dca-130">Because the presenter creates the Direct3D device, it is also responsible for sharing the device with other pipeline objects that need to access DirectX Video Acceleration (DXVA) services.</span></span> <span data-ttu-id="91dca-131">尤其是，EVR 混音器會使用 DXVA video 處理服務來逐行處理和混合影片。</span><span class="sxs-lookup"><span data-stu-id="91dca-131">In particular, the EVR mixer uses the DXVA video processing services to deinterlace and mix the video.</span></span> <span data-ttu-id="91dca-132">在 EVR 的外部，軟體解碼器可能會使用 DXVA 來進行加速影片解碼。</span><span class="sxs-lookup"><span data-stu-id="91dca-132">External to the EVR, software decoders may use DXVA for accelerated video decoding.</span></span> <span data-ttu-id="91dca-133">展示者透過 [direct3d 裝置管理員](direct3d-device-manager.md)共用 direct3d 裝置。</span><span class="sxs-lookup"><span data-stu-id="91dca-133">The presenter shares the Direct3D device by means of the [Direct3D Device Manager](direct3d-device-manager.md).</span></span> <span data-ttu-id="91dca-134">下圖顯示 EVR 的內部架構。</span><span class="sxs-lookup"><span data-stu-id="91dca-134">The following diagram shows the internal architecture of the EVR.</span></span> <span data-ttu-id="91dca-135"> (軟體解碼器（以灰色陰影呈現）不屬於 EVR。 ) </span><span class="sxs-lookup"><span data-stu-id="91dca-135">(The software decoder, shaded in gray, is not part of the EVR.)</span></span>

![顯示 evr 的架構圖表。](images/5d4a1fd9-25ff-4cc5-a486-0d22f34bbfd7.gif)

## <a name="evr-interfaces"></a><span data-ttu-id="91dca-137">EVR 介面</span><span class="sxs-lookup"><span data-stu-id="91dca-137">EVR Interfaces</span></span>

<span data-ttu-id="91dca-138">EVR 支援下列介面。</span><span class="sxs-lookup"><span data-stu-id="91dca-138">The EVR supports the following interfaces.</span></span> <span data-ttu-id="91dca-139">這些介面中有些是由混音器或展示者所執行。</span><span class="sxs-lookup"><span data-stu-id="91dca-139">Some of these interfaces are implemented by the mixer or presenter.</span></span> <span data-ttu-id="91dca-140">針對每個介面，參考主題描述如何取得介面的指標。</span><span class="sxs-lookup"><span data-stu-id="91dca-140">For each interface, the reference topic describes how to get a pointer to the interface.</span></span>

| <span data-ttu-id="91dca-141">介面</span><span class="sxs-lookup"><span data-stu-id="91dca-141">Interface</span></span>                                                    | <span data-ttu-id="91dca-142">描述</span><span class="sxs-lookup"><span data-stu-id="91dca-142">Description</span></span>                                                                                       |
|--------------------------------------------------------------|---------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="91dca-143">**IEVRFilterConfig**</span><span class="sxs-lookup"><span data-stu-id="91dca-143">**IEVRFilterConfig**</span></span>](/windows/desktop/api/evr/nn-evr-ievrfilterconfig)                 | <span data-ttu-id="91dca-144">將 EVR 篩選器上的輸入圖釘數目設定 (DirectShow 僅) 。</span><span class="sxs-lookup"><span data-stu-id="91dca-144">Sets the number of input pins on the EVR filter (DirectShow only).</span></span>                                |
| [<span data-ttu-id="91dca-145">**IEVRFilterConfigEx**</span><span class="sxs-lookup"><span data-stu-id="91dca-145">**IEVRFilterConfigEx**</span></span>](/windows/desktop/api/evr/nn-evr-ievrfilterconfigex)             | <span data-ttu-id="91dca-146">將 EVR 濾波器設定 (DirectShow 僅) 。</span><span class="sxs-lookup"><span data-stu-id="91dca-146">Configures the EVR filter (DirectShow only).</span></span>                                                      |
| [<span data-ttu-id="91dca-147">**IEVRTrustedVideoPlugin**</span><span class="sxs-lookup"><span data-stu-id="91dca-147">**IEVRTrustedVideoPlugin**</span></span>](/windows/desktop/api/evr/nn-evr-ievrtrustedvideoplugin)     | <span data-ttu-id="91dca-148">讓 EVR 外掛程式轉譯受保護的影片。</span><span class="sxs-lookup"><span data-stu-id="91dca-148">Enables an EVR plug-in to render protected video.</span></span>                                                 |
| [<span data-ttu-id="91dca-149">**IMFDesiredSample**</span><span class="sxs-lookup"><span data-stu-id="91dca-149">**IMFDesiredSample**</span></span>](/windows/desktop/api/evr/nn-evr-imfdesiredsample)                 | <span data-ttu-id="91dca-150">讓 EVR 展示者向混音器要求特定的畫面格。</span><span class="sxs-lookup"><span data-stu-id="91dca-150">Enables the EVR presenter to request a specific frame from the mixer.</span></span>                             |
| [<span data-ttu-id="91dca-151">**IMFQualityAdvise**</span><span class="sxs-lookup"><span data-stu-id="91dca-151">**IMFQualityAdvise**</span></span>](/windows/desktop/api/mfidl/nn-mfidl-imfqualityadvise)                 | <span data-ttu-id="91dca-152">可讓品質管制員調整 EVR 的影片品質。</span><span class="sxs-lookup"><span data-stu-id="91dca-152">Enables the quality manager to adjust the EVR video quality.</span></span>                                      |
| [<span data-ttu-id="91dca-153">**IMFTopologyServiceLookup**</span><span class="sxs-lookup"><span data-stu-id="91dca-153">**IMFTopologyServiceLookup**</span></span>](/windows/desktop/api/evr/nn-evr-imftopologyservicelookup) | <span data-ttu-id="91dca-154">讓自訂混音器或展示者從 EVR 取得介面指標。</span><span class="sxs-lookup"><span data-stu-id="91dca-154">Enables a custom mixer or presenter to get interface pointers from the EVR.</span></span>                       |
| [<span data-ttu-id="91dca-155">**IMFVideoDeviceID**</span><span class="sxs-lookup"><span data-stu-id="91dca-155">**IMFVideoDeviceID**</span></span>](/windows/desktop/api/evr/nn-evr-imfvideodeviceid)                 | <span data-ttu-id="91dca-156">傳回 EVR 混音器或展示者的裝置識別碼。</span><span class="sxs-lookup"><span data-stu-id="91dca-156">Returns the device identifier of an EVR mixer or presenter.</span></span>                                       |
| [<span data-ttu-id="91dca-157">**IMFVideoDisplayControl**</span><span class="sxs-lookup"><span data-stu-id="91dca-157">**IMFVideoDisplayControl**</span></span>](/windows/desktop/api/evr/nn-evr-imfvideodisplaycontrol)     | <span data-ttu-id="91dca-158">控制 EVR 顯示影片的方式。</span><span class="sxs-lookup"><span data-stu-id="91dca-158">Controls how the EVR displays video.</span></span>                                                              |
| [<span data-ttu-id="91dca-159">**IMFVideoMixerBitmap**</span><span class="sxs-lookup"><span data-stu-id="91dca-159">**IMFVideoMixerBitmap**</span></span>](/windows/desktop/api/evr9/nn-evr9-imfvideomixerbitmap)           | <span data-ttu-id="91dca-160">Alpha-將靜態點陣圖影像與影片混合。</span><span class="sxs-lookup"><span data-stu-id="91dca-160">Alpha-blends a static bitmap image with the video.</span></span>                                                |
| [<span data-ttu-id="91dca-161">**IMFVideoMixerControl**</span><span class="sxs-lookup"><span data-stu-id="91dca-161">**IMFVideoMixerControl**</span></span>](/windows/desktop/api/evr/nn-evr-imfvideomixercontrol)         | <span data-ttu-id="91dca-162">控制增強型影片轉譯器 (EVR) 如何混合影片子串流。</span><span class="sxs-lookup"><span data-stu-id="91dca-162">Controls how the Enhanced Video Renderer (EVR) mixes video substreams.</span></span>                            |
| [<span data-ttu-id="91dca-163">**IMFVideoMixerControl2**</span><span class="sxs-lookup"><span data-stu-id="91dca-163">**IMFVideoMixerControl2**</span></span>](/windows/desktop/api/evr/nn-evr-imfvideomixercontrol2)       | <span data-ttu-id="91dca-164">控制影片去交錯的喜好設定。</span><span class="sxs-lookup"><span data-stu-id="91dca-164">Controls preferences for video deinterlacing.</span></span>                                                     |
| [<span data-ttu-id="91dca-165">**IMFVideoPositionMapper**</span><span class="sxs-lookup"><span data-stu-id="91dca-165">**IMFVideoPositionMapper**</span></span>](/windows/desktop/api/evr/nn-evr-imfvideopositionmapper)     | <span data-ttu-id="91dca-166">將輸入影片串流上的位置對應到輸出影片資料流程上的對應位置。</span><span class="sxs-lookup"><span data-stu-id="91dca-166">Maps a position on an input video stream to the corresponding position on an output video stream.</span></span> |
| [<span data-ttu-id="91dca-167">**IMFVideoPresenter**</span><span class="sxs-lookup"><span data-stu-id="91dca-167">**IMFVideoPresenter**</span></span>](/windows/desktop/api/evr/nn-evr-imfvideopresenter)               | <span data-ttu-id="91dca-168">由 EVR 展示者公開。</span><span class="sxs-lookup"><span data-stu-id="91dca-168">Exposed by the EVR presenter.</span></span>                                                                     |
| [<span data-ttu-id="91dca-169">**IMFVideoProcessor**</span><span class="sxs-lookup"><span data-stu-id="91dca-169">**IMFVideoProcessor**</span></span>](/windows/desktop/api/evr9/nn-evr9-imfvideoprocessor)               | <span data-ttu-id="91dca-170">控制影片處理，包括調整、雜訊篩選和詳細資料篩選。</span><span class="sxs-lookup"><span data-stu-id="91dca-170">Controls video processing, including adjustment, noise filters, and detail filters.</span></span>               |
| [<span data-ttu-id="91dca-171">**IMFVideoRenderer**</span><span class="sxs-lookup"><span data-stu-id="91dca-171">**IMFVideoRenderer**</span></span>](/windows/desktop/api/evr/nn-evr-imfvideorenderer)                 | <span data-ttu-id="91dca-172">在 EVR 上設定混音器或展示者。</span><span class="sxs-lookup"><span data-stu-id="91dca-172">Sets a mixer or presenter on the EVR.</span></span>                                                             |
| [<span data-ttu-id="91dca-173">**IMFVideoSampleAllocator**</span><span class="sxs-lookup"><span data-stu-id="91dca-173">**IMFVideoSampleAllocator**</span></span>](/windows/desktop/api/mfidl/nn-mfidl-imfvideosampleallocator)   | <span data-ttu-id="91dca-174">配置影片範例。</span><span class="sxs-lookup"><span data-stu-id="91dca-174">Allocates video samples.</span></span>                                                                          |



 

## <a name="in-this-section"></a><span data-ttu-id="91dca-175">本節內容</span><span class="sxs-lookup"><span data-stu-id="91dca-175">In This Section</span></span>



| <span data-ttu-id="91dca-176">主題</span><span class="sxs-lookup"><span data-stu-id="91dca-176">Topic</span></span>                                                                    | <span data-ttu-id="91dca-177">描述</span><span class="sxs-lookup"><span data-stu-id="91dca-177">Description</span></span>                                                                           |
|--------------------------------------------------------------------------|---------------------------------------------------------------------------------------|
| [<span data-ttu-id="91dca-178">使用 DirectShow EVR 篩選器</span><span class="sxs-lookup"><span data-stu-id="91dca-178">Using the DirectShow EVR Filter</span></span>](using-the-directshow-evr-filter.md)   | <span data-ttu-id="91dca-179">如何在 DirectShow 應用程式中使用 EVR。</span><span class="sxs-lookup"><span data-stu-id="91dca-179">How to use the EVR in a DirectShow application.</span></span>                                       |
| [<span data-ttu-id="91dca-180">使用 EVR 媒體接收</span><span class="sxs-lookup"><span data-stu-id="91dca-180">Using the EVR Media Sink</span></span>](using-the-evr-media-sink.md)                 | <span data-ttu-id="91dca-181">如何在媒體基礎應用程式中使用 EVR。</span><span class="sxs-lookup"><span data-stu-id="91dca-181">How to use the EVR in a Media Foundation application.</span></span>                                 |
| [<span data-ttu-id="91dca-182">使用影片顯示控制項</span><span class="sxs-lookup"><span data-stu-id="91dca-182">Using the Video Display Controls</span></span>](using-the-video-display-controls.md) | <span data-ttu-id="91dca-183">如何控制 EVR 在應用程式視窗內顯示影片的方式。</span><span class="sxs-lookup"><span data-stu-id="91dca-183">How to control the way in which the EVR displays video inside the application window.</span></span> |
| [<span data-ttu-id="91dca-184">使用影片混音器控制項</span><span class="sxs-lookup"><span data-stu-id="91dca-184">Using the Video Mixer Controls</span></span>](using-the-video-mixer-controls.md)     | <span data-ttu-id="91dca-185">如何控制 EVR 混音器的運作方式。</span><span class="sxs-lookup"><span data-stu-id="91dca-185">How to control the way in which the EVR mixer operates.</span></span>                               |
| [<span data-ttu-id="91dca-186">EVR 媒體類型的協商</span><span class="sxs-lookup"><span data-stu-id="91dca-186">EVR Media Type Negotiation</span></span>](evr-media-type-negotiation.md)             | <span data-ttu-id="91dca-187">描述 EVR 如何決定可接受哪些影片格式做為輸入。</span><span class="sxs-lookup"><span data-stu-id="91dca-187">Describes how the EVR determines which video formats it can accept as input.</span></span>          |
| [<span data-ttu-id="91dca-188">自訂 Mixers</span><span class="sxs-lookup"><span data-stu-id="91dca-188">Custom Mixers</span></span>](custom-mixers.md)                                       | <span data-ttu-id="91dca-189">如何為 EVR 撰寫自訂混音器。</span><span class="sxs-lookup"><span data-stu-id="91dca-189">How to write a custom mixer for the EVR.</span></span>                                              |
| [<span data-ttu-id="91dca-190">如何撰寫 EVR 展示者</span><span class="sxs-lookup"><span data-stu-id="91dca-190">How to Write an EVR Presenter</span></span>](how-to-write-an-evr-presenter.md)       | <span data-ttu-id="91dca-191">如何撰寫 EVR 的自訂展示者。</span><span class="sxs-lookup"><span data-stu-id="91dca-191">How to write a custom presenter for the EVR.</span></span>                                          |



 

## <a name="related-topics"></a><span data-ttu-id="91dca-192">相關主題</span><span class="sxs-lookup"><span data-stu-id="91dca-192">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="91dca-193">音訊/視訊播放</span><span class="sxs-lookup"><span data-stu-id="91dca-193">Audio/Video Playback</span></span>](audio-video-playback.md)
</dt> </dl>

 

 



