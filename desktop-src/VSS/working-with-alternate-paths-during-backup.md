---
description: 在某些情況下，要備份的檔案不是這些檔案的預設位置。
ms.assetid: b9e96827-a678-45ca-8ede-4508a406f071
title: 在備份期間使用替代路徑
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: a98e93af4d12b804032a64841542e731ff77e048
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/07/2021
ms.locfileid: "106973470"
---
# <a name="working-with-alternate-paths-during-backup"></a><span data-ttu-id="52023-103">在備份期間使用替代路徑</span><span class="sxs-lookup"><span data-stu-id="52023-103">Working with Alternate Paths during Backup</span></span>

<span data-ttu-id="52023-104">在某些情況下，要備份的檔案不是這些檔案的預設位置。</span><span class="sxs-lookup"><span data-stu-id="52023-104">There are certain circumstances where the files to be backed up are not the default location for those files.</span></span>

<span data-ttu-id="52023-105">例如，有些寫入器無法保證在 [*凍結*](vssgloss-f.md) 和 [*解除*](vssgloss-t.md) 凍結事件之間的時間範圍內，將其資料排清。</span><span class="sxs-lookup"><span data-stu-id="52023-105">For example, some writers cannot guarantee to have flushed of their data within the time window between [*Freeze*](vssgloss-f.md) and [*Thaw*](vssgloss-t.md) events.</span></span> <span data-ttu-id="52023-106">這類寫入器可能會選擇在非預設的來原始目錄或 [*替代路徑*](vssgloss-a.md)中，產生包含最後一次已知正確設定的重複檔案。</span><span class="sxs-lookup"><span data-stu-id="52023-106">Such writers may choose to generate duplicate files containing a last known good configuration in a non-default source directory, or [*alternate path*](vssgloss-a.md).</span></span>

<span data-ttu-id="52023-107">與 VSS 搭配使用的「替代路徑」詞彙不應該與「 [*替代位置對應*](vssgloss-a.md)」這一詞混淆。</span><span class="sxs-lookup"><span data-stu-id="52023-107">The term alternate path, as used with VSS, should not be confused with the term [*alternate location mapping*](vssgloss-a.md).</span></span> <span data-ttu-id="52023-108">替代路徑只會在備份作業期間使用，並參考要備份的來源替代來源。</span><span class="sxs-lookup"><span data-stu-id="52023-108">Alternate paths are used only during backup operations, and refer to an alternate source from which to back up.</span></span> <span data-ttu-id="52023-109">替代位置對應只會在還原作業期間使用，並參考還原作業的替代目的地。</span><span class="sxs-lookup"><span data-stu-id="52023-109">Alternate location mappings are used only during restore operations, and refer to an alternate destination for restore operations.</span></span>

<span data-ttu-id="52023-110">**在備份期間使用替代路徑**</span><span class="sxs-lookup"><span data-stu-id="52023-110">**To use an alternate path during backup**</span></span>

1.  <span data-ttu-id="52023-111">在備份作業的探索階段 (請參閱 [備份探索階段的總覽](overview-of-the-backup-discovery-phase.md)) 要求者會使用 [**IVssExamineWriterMetadata：： GetComponent**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssexaminewritermetadata-getcomponent) 檢查每個寫入器的元件資料，並取得 [**IVssWMComponent**](/windows/desktop/api/VsBackup/nl-vsbackup-ivsswmcomponent) 介面的實例。</span><span class="sxs-lookup"><span data-stu-id="52023-111">During the discovery phase of a backup operation (see [Overview of the Backup Discovery Phase](overview-of-the-backup-discovery-phase.md)) a requester would examine each writer's component data using [**IVssExamineWriterMetadata::GetComponent**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssexaminewritermetadata-getcomponent) and get instances of the [**IVssWMComponent**](/windows/desktop/api/VsBackup/nl-vsbackup-ivsswmcomponent) interface.</span></span>
2.  <span data-ttu-id="52023-112">然後，要求者會藉由呼叫 [**IVssWMComponent：： GetFile**](/windows/desktop/api/VsBackup/nf-vsbackup-ivsswmcomponent-getfile)方法，取得每個元件所管理的檔案 [*集*](vssgloss-f.md)（由 [**IVssWMFiledesc**](/windows/desktop/api/VsWriter/nl-vswriter-ivsswmfiledesc)介面的實例表示）。</span><span class="sxs-lookup"><span data-stu-id="52023-112">A requester then obtains the [*file set*](vssgloss-f.md) managed by each component, represented by instances of the [**IVssWMFiledesc**](/windows/desktop/api/VsWriter/nl-vswriter-ivsswmfiledesc) interface, by calling the [**IVssWMComponent::GetFile**](/windows/desktop/api/VsBackup/nf-vsbackup-ivsswmcomponent-getfile) method.</span></span>
3.  <span data-ttu-id="52023-113">除了路徑 ([**IVssWMFiledesc：： GetPath**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswmfiledesc-getpath)) 、檔案規格 ([**IVssWMFiledesc：： GetFilespec**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswmfiledesc-getfilespec)) ，以及 ([**IVssWMFiledesc：： GetRecursive**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswmfiledesc-getrecursive)) 的遞迴旗標， [**IVssWMFiledesc**](/windows/desktop/api/VsWriter/nl-vswriter-ivsswmfiledesc) 物件可能會包含替代的位置 (做為備份作業的替代路徑，而使用 [**IVssWMFiledesc：： GetAlternateLocation**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswmfiledesc-getalternatelocation) 方法) 還原作業的替代位置對應。</span><span class="sxs-lookup"><span data-stu-id="52023-113">In addition to a path ([**IVssWMFiledesc::GetPath**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswmfiledesc-getpath)), a file specification ([**IVssWMFiledesc::GetFilespec**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswmfiledesc-getfilespec)), and a recursion flag ([**IVssWMFiledesc::GetRecursive**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswmfiledesc-getrecursive)), a [**IVssWMFiledesc**](/windows/desktop/api/VsWriter/nl-vswriter-ivsswmfiledesc) object may contain an alternate location (used as an alternate path for backup operations and an alternate location mapping for restore operations) by using the [**IVssWMFiledesc::GetAlternateLocation**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswmfiledesc-getalternatelocation) method.</span></span>
4.  <span data-ttu-id="52023-114">如果 [**IVssWMFiledesc：： GetAlternateLocation**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswmfiledesc-getalternatelocation) 所傳回的值為非 Null，則備份應用程式會使用該值，而不是從 [**IVssWMFiledesc：： GetPath**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswmfiledesc-getpath) 取得的值，以選取並尋找要備份的檔案。</span><span class="sxs-lookup"><span data-stu-id="52023-114">If the value returned by [**IVssWMFiledesc::GetAlternateLocation**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswmfiledesc-getalternatelocation) is non-NULL, backup applications use that value instead of the value obtained from [**IVssWMFiledesc::GetPath**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswmfiledesc-getpath) to select and locate files to back up.</span></span>
5.  <span data-ttu-id="52023-115">儘管使用替代路徑，要求者仍應遵守 [**IVssWMFiledesc：： GetFilespec**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswmfiledesc-getfilespec) 和 [**IVssWMFiledesc：： GetRecursive**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswmfiledesc-getrecursive)所傳回的檔案規格和遞迴設定。</span><span class="sxs-lookup"><span data-stu-id="52023-115">Despite using an alternate path, requesters should still respect the file specification and recursive settings returned by [**IVssWMFiledesc::GetFilespec**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswmfiledesc-getfilespec) and [**IVssWMFiledesc::GetRecursive**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswmfiledesc-getrecursive).</span></span>

<span data-ttu-id="52023-116">請注意，在還原時，不會在還原期間使用任何替代路徑，也就是 [**IVssWMFiledesc：： GetAlternateLocation**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswmfiledesc-getalternatelocation) 實例所傳回的替代位置，而此實例是從 [**IVssWMComponent**](/windows/desktop/api/VsBackup/nl-vsbackup-ivsswmcomponent)的實例取得，而後者則是從取得已儲存的寫入器元資料檔案的 [**IVssExamineWriterMetadata**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssexaminewritermetadata) 實例取得。</span><span class="sxs-lookup"><span data-stu-id="52023-116">Note that on restore, any alternate path—that is, an alternate location returned by an instance of [**IVssWMFiledesc::GetAlternateLocation**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswmfiledesc-getalternatelocation) gotten from an instance of [**IVssWMComponent**](/windows/desktop/api/VsBackup/nl-vsbackup-ivsswmcomponent), which in turn was obtained from an instance of [**IVssExamineWriterMetadata**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssexaminewritermetadata) gotten by retrieving a stored Writer Metadata Document—is not used during restoration.</span></span>

<span data-ttu-id="52023-117">相同 [**IVssWMFiledesc**](/windows/desktop/api/VsWriter/nl-vswriter-ivsswmfiledesc)實例之 [**GetPath**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswmfiledesc-getpath)方法所傳回的預設路徑 () 用來定義還原位置，或使用 [**IVssWMFiledesc：： GetAlternateLocation**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswmfiledesc-getalternatelocation)方法找到的替代位置對應，表示要還原檔案的位置 (請參閱 [還原期間使用替代位置](working-with-alternate-locations-during-restore.md)) 。</span><span class="sxs-lookup"><span data-stu-id="52023-117">Either the default path (returned by the [**GetPath**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswmfiledesc-getpath) method of the same instance of [**IVssWMFiledesc**](/windows/desktop/api/VsWriter/nl-vswriter-ivsswmfiledesc)) is used to define a restore location, or an alternate location mapping—found by using the [**IVssWMFiledesc::GetAlternateLocation**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswmfiledesc-getalternatelocation) method—indicates where a file is to be restored (see [Working with Alternate Locations during Restore](working-with-alternate-locations-during-restore.md)).</span></span>

 

 



