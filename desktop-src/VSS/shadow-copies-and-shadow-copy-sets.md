---
description: 陰影複製是磁片區的快照集，該磁片區會在一段妥善定義的瞬間內，複製該磁片區上保留的所有資料。 VSS 會依持續性 GUID 來識別每個陰影複製。
ms.assetid: 8ef2478a-c8bc-4517-9a14-e1d9226ec4cd
title: 陰影複製和陰影複製集
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 18709842b1fb0fbf6d6cce2557b51042dfb024ea
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/07/2021
ms.locfileid: "106993081"
---
# <a name="shadow-copies-and-shadow-copy-sets"></a>陰影複製和陰影複製集

[*陰影複製*](vssgloss-s.md)是磁片區的快照集，該磁片區會在一段妥善定義的瞬間內，複製該磁片區上保留的所有資料。 VSS 會依持續性 GUID 來識別每個陰影複製。

[*陰影複製組*](vssgloss-s.md)是所有不同磁片區的陰影複製集合，全都採用相同的時間。 VSS 會依持續性 GUID 來識別每個陰影複製集。

特定硬體或軟體廠商選擇如何選擇執行陰影複製，完全是自行決定。 一旦建立陰影複製，系統就會有可供系統使用的陰影複製磁片區的兩個映射：可供使用的原始磁片區;也可以透過 VSS API 來存取複製的資料。

如此一來，就可以同時執行兩組活動：

-   系統上的一般應用程式可以使用原始磁片區快速繼續或繼續，並更新磁片上的資料。
-   使用 VSS 要求者 API 來存取陰影複製之磁片區的應用程式，可以執行備份或類似的作業。

針對每個檔案、目錄或磁片區，不需要以相同的方式來執行陰影複製。 不同的陰影複製機制執行 ([*提供者*](vssgloss-p.md)) 可能會使用不同的方法來建立陰影複製。 不過，對於使用 VSS API 的所有應用程式，所有陰影複製都應該相同。

如需預設 Windows 提供者執行的詳細資訊，請參閱 [系統提供者](providers.md)。

## <a name="default-shadow-copy-state"></a>預設陰影複製狀態

雖然檔案系統會在建立陰影複製之前排清所有 i/o 緩衝區，但這並不確定已正確處理未完成的 i/o。

因此，假設系統沒有具備 VSS 功能的應用程式，則陰影複製中的資料會被視為處於損 [*毀一致的狀態*](vssgloss-c.md)。 處於損毀一致狀態的陰影複製包含磁片的映射，這與在嚴重系統關機後仍存在的磁片映射相同。 所有開啟的檔案仍會存在於磁片區，但不保證不會有不完整的 i/o 作業或資料損毀。

雖然當機時保持一致的狀態不會完全處理與定義穩定備份組相關的所有問題 (請參閱 [常見的磁片區備份問題](common-volume-backup-issues.md)) ，它有幾個優點，是傳統備份作業必須使用的備份組：

-   包含在陰影複製中的磁片區（即使處於損毀一致狀態）仍會包含所有檔案。 建立時不含陰影複製的備份組，將不會包含在備份時開啟的所有檔案。 備份作業會從備份中排除在備份作業時保持開啟的檔案。
-   磁片區的陰影複製會在一段時間內立即建立，而不是藉由找出使用中的檔案系統，這通常需要更多時間。

系統上不是 VSS 感知的應用程式（字處理器、編輯器等等）可能會使其檔案處於損毀一致的狀態。 不過， (寫入器的 VSS 感知應用程式) 可以協調其動作，讓陰影複製中的檔案狀態妥善定義且一致。

## <a name="shadow-copy-freeze-and-thaw"></a>陰影複製凍結和解除凍結

建立每個 VSS 陰影複製作業的方式都是由 [*凍結*](vssgloss-f.md) 和 [*解除凍結*](vssgloss-t.md) 事件括住，而寫入器會在陰影複製之前用來將檔案放在穩定的狀態。

將凍結和解除凍結事件作為 VSS 模型的一部分，表示：

-   處理凍結事件表示開發寫入者的使用者在備份週期中必須有清楚的分隔點，以確保磁片的所有寫入作業都已停止，且檔案處於妥善定義的備份狀態。
-   處理解除凍結事件提供了一種機制，讓寫入器繼續寫入磁片，並清除任何暫存檔或其他與陰影複製建立關聯的暫時狀態資訊。
-   凍結和解除凍結事件之間的預設視窗很短 (通常是60秒) ;因此，寫入器提供的任何服務實際中斷都可以最小化。
-    (的其他事件（例如 PrepareForSnapshot) 前面和後續的凍結和解除凍結事件），提供必要的彈性，讓寫入器能夠完成複雜的作業以支援陰影複製。

 

 



