---
description: 邏輯路徑可用來將寫入器管理的元件組織成定義完善的群組。
ms.assetid: 663c8ca9-8f5b-48bd-af2d-b2d90de9e492
title: 元件的邏輯路徑
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 9a591f3eec0e00257740dbbd24ab7c609c53c27a
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/07/2021
ms.locfileid: "106989347"
---
# <a name="logical-pathing-of-components"></a><span data-ttu-id="d13ab-103">元件的邏輯路徑</span><span class="sxs-lookup"><span data-stu-id="d13ab-103">Logical Pathing of Components</span></span>

<span data-ttu-id="d13ab-104">[*邏輯路徑*](vssgloss-l.md) 可用來將寫入器管理的元件組織成定義完善的群組。</span><span class="sxs-lookup"><span data-stu-id="d13ab-104">[*Logical pathing*](vssgloss-l.md) is used to organize components managed by a writer into well-defined groups.</span></span>

<span data-ttu-id="d13ab-105">邏輯路徑類似于傳統檔案路徑的結構，使用反斜線 " \\ " 來分隔路徑中的元素。</span><span class="sxs-lookup"><span data-stu-id="d13ab-105">The logical path is analogous in structure to traditional file pathing, using the backslash "\\" to separate elements in the path.</span></span> <span data-ttu-id="d13ab-106">與檔案路徑不同的是，邏輯路徑的根目錄是 **Null**，而不是 " \\ "。</span><span class="sxs-lookup"><span data-stu-id="d13ab-106">Unlike file paths, the root of a logical path is **NULL**, instead of "\\".</span></span>

<span data-ttu-id="d13ab-107">邏輯路徑會以以 **Null** 結尾的字串表示，而且路徑可以包含的字元沒有其他限制。</span><span class="sxs-lookup"><span data-stu-id="d13ab-107">The logical path is expressed as a **NULL**-terminated string, and there are no other restrictions on the characters the path can contain.</span></span>

<span data-ttu-id="d13ab-108">邏輯路徑的最重要用途是定義 [*元件集*](vssgloss-c.md)，其中一個可選取元件的備份或還原作業中所 [*包含的明確元件*](vssgloss-e.md) ，需要包含一些其他元件， ([*子*](vssgloss-s.md) 元件) 。</span><span class="sxs-lookup"><span data-stu-id="d13ab-108">The most important use of logical pathing is in defining [*component sets*](vssgloss-c.md), where the [*explicit component inclusion*](vssgloss-e.md) in a backup or restore operation of one selectable component requires the inclusion of a number of other components ([*subcomponent*](vssgloss-s.md)).</span></span> <span data-ttu-id="d13ab-109">元件集之定義元件的邏輯路徑是其子元件邏輯路徑的父系，以及：</span><span class="sxs-lookup"><span data-stu-id="d13ab-109">The logical path of the defining component of a component set is a parent to the logical paths of its subcomponents and:</span></span>

-   <span data-ttu-id="d13ab-110">子元件必須以根路徑的形式共用，可選取元件的邏輯路徑，以定義元件集。</span><span class="sxs-lookup"><span data-stu-id="d13ab-110">Subcomponents must share as a root path the logical path of the selectable component that defines the component set.</span></span>
-   <span data-ttu-id="d13ab-111">**Null** 的根路徑有效。</span><span class="sxs-lookup"><span data-stu-id="d13ab-111">A root path of **NULL** is valid.</span></span>
-   <span data-ttu-id="d13ab-112">定義可選取元件的名稱必須是元件集之每個其子元件的根路徑之後的第一個邏輯路徑元素。</span><span class="sxs-lookup"><span data-stu-id="d13ab-112">The name of the defining selectable component must be the first logical path element after the root path for every nonselectable subcomponent of the component set.</span></span>
-   <span data-ttu-id="d13ab-113">元件集可以嵌套。</span><span class="sxs-lookup"><span data-stu-id="d13ab-113">Component sets can be nested.</span></span>
-   <span data-ttu-id="d13ab-114">邏輯路徑和元件名稱的組合在 [*寫入器類別*](vssgloss-w.md)的所有實例中必須是唯一的。</span><span class="sxs-lookup"><span data-stu-id="d13ab-114">The combination of logical path and component name must be unique across all instances of a [*writer class*](vssgloss-w.md).</span></span>

<span data-ttu-id="d13ab-115">以下定義的邏輯路徑結構之寫入器 *MyWriter* 的假設範例說明邏輯路徑。</span><span class="sxs-lookup"><span data-stu-id="d13ab-115">The hypothetical example of a writer *MyWriter* with a logical path structure defined below illustrates logical pathing.</span></span>



| <span data-ttu-id="d13ab-116">元件名稱</span><span class="sxs-lookup"><span data-stu-id="d13ab-116">Component name</span></span> | <span data-ttu-id="d13ab-117">邏輯路徑</span><span class="sxs-lookup"><span data-stu-id="d13ab-117">Logical path</span></span>            | <span data-ttu-id="d13ab-118">可選取以進行備份</span><span class="sxs-lookup"><span data-stu-id="d13ab-118">Selectable for backup</span></span> |
|----------------|-------------------------|-----------------------|
| <span data-ttu-id="d13ab-119">執行</span><span class="sxs-lookup"><span data-stu-id="d13ab-119">"Executables"</span></span>  | <span data-ttu-id="d13ab-120">""</span><span class="sxs-lookup"><span data-stu-id="d13ab-120">""</span></span>                      | <span data-ttu-id="d13ab-121">N</span><span class="sxs-lookup"><span data-stu-id="d13ab-121">N</span></span>                     |
| <span data-ttu-id="d13ab-122">"ConfigFiles"</span><span class="sxs-lookup"><span data-stu-id="d13ab-122">"ConfigFiles"</span></span>  | <span data-ttu-id="d13ab-123">執行</span><span class="sxs-lookup"><span data-stu-id="d13ab-123">"Executables"</span></span>           | <span data-ttu-id="d13ab-124">N</span><span class="sxs-lookup"><span data-stu-id="d13ab-124">N</span></span>                     |
| <span data-ttu-id="d13ab-125">"LicenseInfo"</span><span class="sxs-lookup"><span data-stu-id="d13ab-125">"LicenseInfo"</span></span>  | <span data-ttu-id="d13ab-126">""</span><span class="sxs-lookup"><span data-stu-id="d13ab-126">""</span></span>                      | <span data-ttu-id="d13ab-127">Y</span><span class="sxs-lookup"><span data-stu-id="d13ab-127">Y</span></span>                     |
| <span data-ttu-id="d13ab-128">"Security"</span><span class="sxs-lookup"><span data-stu-id="d13ab-128">"Security"</span></span>     | <span data-ttu-id="d13ab-129">""</span><span class="sxs-lookup"><span data-stu-id="d13ab-129">""</span></span>                      | <span data-ttu-id="d13ab-130">Y</span><span class="sxs-lookup"><span data-stu-id="d13ab-130">Y</span></span>                     |
| <span data-ttu-id="d13ab-131">使用者</span><span class="sxs-lookup"><span data-stu-id="d13ab-131">"UserInfo"</span></span>     | <span data-ttu-id="d13ab-132">"Security"</span><span class="sxs-lookup"><span data-stu-id="d13ab-132">"Security"</span></span>              | <span data-ttu-id="d13ab-133">N</span><span class="sxs-lookup"><span data-stu-id="d13ab-133">N</span></span>                     |
| <span data-ttu-id="d13ab-134">數位憑證</span><span class="sxs-lookup"><span data-stu-id="d13ab-134">"Certificates"</span></span> | <span data-ttu-id="d13ab-135">"Security"</span><span class="sxs-lookup"><span data-stu-id="d13ab-135">"Security"</span></span>              | <span data-ttu-id="d13ab-136">N</span><span class="sxs-lookup"><span data-stu-id="d13ab-136">N</span></span>                     |
| <span data-ttu-id="d13ab-137">"writerData"</span><span class="sxs-lookup"><span data-stu-id="d13ab-137">"writerData"</span></span>   | <span data-ttu-id="d13ab-138">""</span><span class="sxs-lookup"><span data-stu-id="d13ab-138">""</span></span>                      | <span data-ttu-id="d13ab-139">Y</span><span class="sxs-lookup"><span data-stu-id="d13ab-139">Y</span></span>                     |
| <span data-ttu-id="d13ab-140">Set1</span><span class="sxs-lookup"><span data-stu-id="d13ab-140">"Set1"</span></span>         | <span data-ttu-id="d13ab-141">"writerData"</span><span class="sxs-lookup"><span data-stu-id="d13ab-141">"writerData"</span></span>            | <span data-ttu-id="d13ab-142">N</span><span class="sxs-lookup"><span data-stu-id="d13ab-142">N</span></span>                     |
| <span data-ttu-id="d13ab-143">Jan</span><span class="sxs-lookup"><span data-stu-id="d13ab-143">"Jan"</span></span>          | <span data-ttu-id="d13ab-144">"writerData \\ Set1"</span><span class="sxs-lookup"><span data-stu-id="d13ab-144">"writerData\\Set1"</span></span>      | <span data-ttu-id="d13ab-145">N</span><span class="sxs-lookup"><span data-stu-id="d13ab-145">N</span></span>                     |
| <span data-ttu-id="d13ab-146">年</span><span class="sxs-lookup"><span data-stu-id="d13ab-146">"Dec"</span></span>          | <span data-ttu-id="d13ab-147">"writerData \\ Set1"</span><span class="sxs-lookup"><span data-stu-id="d13ab-147">"writerData\\Set1"</span></span>      | <span data-ttu-id="d13ab-148">N</span><span class="sxs-lookup"><span data-stu-id="d13ab-148">N</span></span>                     |
| <span data-ttu-id="d13ab-149">Set2</span><span class="sxs-lookup"><span data-stu-id="d13ab-149">"Set2"</span></span>         | <span data-ttu-id="d13ab-150">"writerData"</span><span class="sxs-lookup"><span data-stu-id="d13ab-150">"writerData"</span></span>            | <span data-ttu-id="d13ab-151">N</span><span class="sxs-lookup"><span data-stu-id="d13ab-151">N</span></span>                     |
| <span data-ttu-id="d13ab-152">Jan</span><span class="sxs-lookup"><span data-stu-id="d13ab-152">"Jan"</span></span>          | <span data-ttu-id="d13ab-153">\\"writerData</span><span class="sxs-lookup"><span data-stu-id="d13ab-153">"writerData\\Set2"</span></span>      | <span data-ttu-id="d13ab-154">N</span><span class="sxs-lookup"><span data-stu-id="d13ab-154">N</span></span>                     |
| <span data-ttu-id="d13ab-155">年</span><span class="sxs-lookup"><span data-stu-id="d13ab-155">"Dec"</span></span>          | <span data-ttu-id="d13ab-156">\\"writerData</span><span class="sxs-lookup"><span data-stu-id="d13ab-156">"writerData\\Set2"</span></span>      | <span data-ttu-id="d13ab-157">N</span><span class="sxs-lookup"><span data-stu-id="d13ab-157">N</span></span>                     |
| <span data-ttu-id="d13ab-158">查詢</span><span class="sxs-lookup"><span data-stu-id="d13ab-158">"Query"</span></span>        | <span data-ttu-id="d13ab-159">"writerData \\ QueryLogs"</span><span class="sxs-lookup"><span data-stu-id="d13ab-159">"writerData\\QueryLogs"</span></span> | <span data-ttu-id="d13ab-160">N</span><span class="sxs-lookup"><span data-stu-id="d13ab-160">N</span></span>                     |
| <span data-ttu-id="d13ab-161">用法</span><span class="sxs-lookup"><span data-stu-id="d13ab-161">"Usage"</span></span>        | <span data-ttu-id="d13ab-162">"writerData"</span><span class="sxs-lookup"><span data-stu-id="d13ab-162">"writerData"</span></span>            | <span data-ttu-id="d13ab-163">Y</span><span class="sxs-lookup"><span data-stu-id="d13ab-163">Y</span></span>                     |
| <span data-ttu-id="d13ab-164">Jan</span><span class="sxs-lookup"><span data-stu-id="d13ab-164">"Jan"</span></span>          | <span data-ttu-id="d13ab-165">"writerData \\ Usage"</span><span class="sxs-lookup"><span data-stu-id="d13ab-165">"writerData\\Usage"</span></span>     | <span data-ttu-id="d13ab-166">N</span><span class="sxs-lookup"><span data-stu-id="d13ab-166">N</span></span>                     |
| <span data-ttu-id="d13ab-167">年</span><span class="sxs-lookup"><span data-stu-id="d13ab-167">"Dec"</span></span>          | <span data-ttu-id="d13ab-168">"writerData \\ Usage"</span><span class="sxs-lookup"><span data-stu-id="d13ab-168">"writerData\\Usage"</span></span>     | <span data-ttu-id="d13ab-169">N</span><span class="sxs-lookup"><span data-stu-id="d13ab-169">N</span></span>                     |



 

<span data-ttu-id="d13ab-170">請注意，「可執行檔」和「中」元件有父子式關聯性，但兩者都是其。</span><span class="sxs-lookup"><span data-stu-id="d13ab-170">Note that the components "Executables" and "ConfigFile" have a parent-child relationship, but both are nonselectable.</span></span> <span data-ttu-id="d13ab-171">因此，它們不會形成元件集。</span><span class="sxs-lookup"><span data-stu-id="d13ab-171">Therefore, they do not form a component set.</span></span> <span data-ttu-id="d13ab-172">每當備份或還原寫入器 *MyWriter* 時，這兩個元件就必須 [*明確包含*](vssgloss-e.md) 在作業中。</span><span class="sxs-lookup"><span data-stu-id="d13ab-172">Whenever the writer *MyWriter* is backed up or restored, these two components will have to be [*explicitly included*](vssgloss-e.md) in the operation.</span></span>

<span data-ttu-id="d13ab-173">元件 "LicenseInfo" 可供選擇，而不是上階或子系。</span><span class="sxs-lookup"><span data-stu-id="d13ab-173">The component "LicenseInfo" is selectable with neither ancestor nor descendant.</span></span> <span data-ttu-id="d13ab-174">在備份或還原作業中，可以明確地將它包含在備份或還原作業中。</span><span class="sxs-lookup"><span data-stu-id="d13ab-174">It can be explicitly included, or not, in a backup or restore operation at the discretion of the requester.</span></span>

<span data-ttu-id="d13ab-175">元件「安全性」會定義簡單元件集，其中不包含任何元件集。</span><span class="sxs-lookup"><span data-stu-id="d13ab-175">The component "Security" defines a simple component set, containing no component sets beneath it.</span></span>

<span data-ttu-id="d13ab-176">元件 "writerData" 會定義元件集，其中包含一個複雜的元件集合，其中包含幾個定義完善的邏輯路徑階層。</span><span class="sxs-lookup"><span data-stu-id="d13ab-176">The component "writerData" defines a component set, which contains a complex collection of components with several well-defined logical path hierarchies beneath it.</span></span>

<span data-ttu-id="d13ab-177">一個子元件（「使用量」）是可選取的，而且會定義元件集。</span><span class="sxs-lookup"><span data-stu-id="d13ab-177">One subcomponent, "Usage", is selectable and defines a component set.</span></span>

<span data-ttu-id="d13ab-178">有幾個元件具有相同的名稱，並依其邏輯路徑來區分。</span><span class="sxs-lookup"><span data-stu-id="d13ab-178">Several components have the same name and are distinguished by their logical paths.</span></span> <span data-ttu-id="d13ab-179">其元件 "Dec" 和 "Jan" 的實例存在於元件其元件 "Set1" 和 ""，以及在可選取的子元件 "Usage" 下。</span><span class="sxs-lookup"><span data-stu-id="d13ab-179">Instances of the nonselectable components "Dec" and "Jan" exist under the components nonselectable components "Set1" and "Set2" and under the selectable subcomponent "Usage".</span></span>

<span data-ttu-id="d13ab-180">如果在備份或還原中明確包含元件 "writerData"，則其所有子元件（即使是以 "Usage" 定義之嵌套元件集中的子元件）都會 [*隱含*](vssgloss-e.md)[*地包含在作業*](vssgloss-i.md) 中。</span><span class="sxs-lookup"><span data-stu-id="d13ab-180">If the component "writerData" is explicitly included in a backup or restore, then all of its subcomponents—even those in the nested component set defined by "Usage"—will be [*implicitly included*](vssgloss-e.md)[*implicitly included*](vssgloss-i.md) in the operation.</span></span>

<span data-ttu-id="d13ab-181">如果 "writerData" 定義的元件集未明確包含在備份或還原中，則 "Set1"、"QueryLogs" 和 "" 元件 (以及其子元件 "Dec" 和 "Jan" ) 的實例將不會以隱含方式包含在備份或還原作業中。</span><span class="sxs-lookup"><span data-stu-id="d13ab-181">If the component set defined by "writerData" is not explicitly included in a backup or restore, components "Set1", "Set2", and "QueryLogs" (and their instances of subcomponents "Dec" and "Jan") will not be included implicitly in the backup or restore operation.</span></span>

<span data-ttu-id="d13ab-182">但是，即使作業中沒有包含 "writerData"，元件「使用方式」仍可供選擇，而且仍可明確地包含在備份或還原作業中。</span><span class="sxs-lookup"><span data-stu-id="d13ab-182">However, even if "writerData" is not included in the operation, the component "Usage" is still selectable, and it can still be explicitly included in a backup or restore operation.</span></span> <span data-ttu-id="d13ab-183">如果是，則會隱含包含其子元件 "Jan" 和 "Dec"。</span><span class="sxs-lookup"><span data-stu-id="d13ab-183">If it is, then its subcomponents "Jan" and "Dec" will be implicitly included.</span></span>

<span data-ttu-id="d13ab-184">值得注意的其他幾點：</span><span class="sxs-lookup"><span data-stu-id="d13ab-184">Other points worthy of note:</span></span>

-   <span data-ttu-id="d13ab-185">可選取的元件 "LicenseInfo" 和 "writerData" 和其元件「可執行檔」全都位於 *MyWriter* 邏輯路徑階層中的相同層級：全部都具有相同的邏輯路徑 **Null** 或 ""，也就是根邏輯路徑。</span><span class="sxs-lookup"><span data-stu-id="d13ab-185">The selectable components "LicenseInfo" and "writerData" and the nonselectable component "Executables" are all at the same level in *MyWriter*'s logical path hierarchy: all have the same logical path of **NULL** or "", the root logical path.</span></span>
-   <span data-ttu-id="d13ab-186">如果可選取的父系 ( "writerData" ) 已明確包含在備份或還原作業中，則不應明確地將可選取的元件包含在備份中。</span><span class="sxs-lookup"><span data-stu-id="d13ab-186">The selectable component "Usage" should never be explicitly included in a backup, if its selectable parent ("writerData") is explicitly included in a backup or restore operation.</span></span>
-   <span data-ttu-id="d13ab-187">定義元件集的元件可能只是為了組織的原因而存在。</span><span class="sxs-lookup"><span data-stu-id="d13ab-187">Components that define component sets may exist simply for organizational reasons.</span></span> <span data-ttu-id="d13ab-188">例如，"writerData" 或 "Usage" 元件，或兩者都是空的;也就是說，使用 [**IVssCreateWriterMetadata：： AddFilesToFileGroup**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-addfilestofilegroup)， [**IVssCreateWriterMetadata：： AddDatabaseFiles**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-adddatabasefiles)或 [**IVssCreateWriterMetadata：： AddDatabaseLogFiles**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-adddatabaselogfiles)方法不會將任何檔案 [*集*](vssgloss-f.md)加入至其中。</span><span class="sxs-lookup"><span data-stu-id="d13ab-188">For instance, either the "writerData" or the "Usage" component, or both, might be empty; that is, no [*file sets*](vssgloss-f.md) were added to them using the [**IVssCreateWriterMetadata::AddFilesToFileGroup**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-addfilestofilegroup), [**IVssCreateWriterMetadata::AddDatabaseFiles**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-adddatabasefiles) or [**IVssCreateWriterMetadata::AddDatabaseLogFiles**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-adddatabaselogfiles) method.</span></span> <span data-ttu-id="d13ab-189">元件仍會定義元件集。</span><span class="sxs-lookup"><span data-stu-id="d13ab-189">The components still define a component set.</span></span>

 

 



