---
description: 使用隱含選取的元件需要存取備份元件檔和寫入器元資料檔案。
ms.assetid: ede51931-be50-4286-818b-0e6122247bdd
title: Selectability 和使用元件屬性
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 83d06683bafb02802d84f152f1ceb662eb7491f2
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/07/2021
ms.locfileid: "104115141"
---
# <a name="selectability-and-working-with-component-properties"></a><span data-ttu-id="b33fd-103">Selectability 和使用元件屬性</span><span class="sxs-lookup"><span data-stu-id="b33fd-103">Selectability and Working with Component Properties</span></span>

<span data-ttu-id="b33fd-104">使用隱含選取的元件需要存取備份元件檔和寫入器元資料檔案。</span><span class="sxs-lookup"><span data-stu-id="b33fd-104">Working with implicitly selected components requires access to both the Backup Components Document and Writer Metadata Documents.</span></span>

<span data-ttu-id="b33fd-105">不這麼做的原因有兩個：</span><span class="sxs-lookup"><span data-stu-id="b33fd-105">There are two reasons for this:</span></span>

-   <span data-ttu-id="b33fd-106">儲存在備份元件檔中的元件資料 (由 [**>ivsscomponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) 介面表示，) 缺乏元件檔案集資訊（檔案規格、路徑和遞迴旗標）的存取權。</span><span class="sxs-lookup"><span data-stu-id="b33fd-106">The component data stored in the Backup Components Document (represented by the [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) interface) lacks access to component file set information—file specification, path, and recursion flag.</span></span> <span data-ttu-id="b33fd-107"> (參閱 [使用備份元件檔](working-with-the-backup-components-document.md)。 ) </span><span class="sxs-lookup"><span data-stu-id="b33fd-107">(See [Working with the Backup Components Document](working-with-the-backup-components-document.md).)</span></span>
-   <span data-ttu-id="b33fd-108">在備份期間，只有在備份元件檔中 [*明確包含*](vssgloss-e.md) 的元件會將其資訊直接儲存在備份元件檔中。</span><span class="sxs-lookup"><span data-stu-id="b33fd-108">Only components that are [*included explicitly*](vssgloss-e.md) in the Backup Components Document during backup have their information directly stored in the Backup Components Document.</span></span> <span data-ttu-id="b33fd-109">要求者和寫入器必須使用可透過 [**>ivsscomponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) 介面取得的資訊，以及 [*邏輯路徑*](vssgloss-l.md) 資訊和寫入器元資料檔案來取得的相關資訊，以及設定 [*隱含包含*](vssgloss-i.md) 元件的屬性。</span><span class="sxs-lookup"><span data-stu-id="b33fd-109">Requesters and writers must use the information available through the [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) interface, in conjunction with [*logical path*](vssgloss-l.md) information and Writer Metadata Documents to obtain information about, and set properties of, [*implicitly included*](vssgloss-i.md) components.</span></span>

<span data-ttu-id="b33fd-110">在 [元件的邏輯路徑](logical-pathing-of-components.md) 中討論的「MyWriter」案例可用來說明備份的 selectability。</span><span class="sxs-lookup"><span data-stu-id="b33fd-110">The "MyWriter" case discussed in [Logical Pathing of Components](logical-pathing-of-components.md) can be used to illustrate selectability for backup.</span></span>



| <span data-ttu-id="b33fd-111">元件名稱</span><span class="sxs-lookup"><span data-stu-id="b33fd-111">Component name</span></span> | <span data-ttu-id="b33fd-112">邏輯路徑</span><span class="sxs-lookup"><span data-stu-id="b33fd-112">Logical path</span></span>            | <span data-ttu-id="b33fd-113">可選取以進行備份</span><span class="sxs-lookup"><span data-stu-id="b33fd-113">Selectable for backup</span></span> | <span data-ttu-id="b33fd-114">可選取以進行還原</span><span class="sxs-lookup"><span data-stu-id="b33fd-114">Selectable for restore</span></span> | <span data-ttu-id="b33fd-115">明確包含</span><span class="sxs-lookup"><span data-stu-id="b33fd-115">Explicitly included</span></span> |
|----------------|-------------------------|-----------------------|------------------------|---------------------|
| <span data-ttu-id="b33fd-116">執行</span><span class="sxs-lookup"><span data-stu-id="b33fd-116">"Executables"</span></span>  | <span data-ttu-id="b33fd-117">""</span><span class="sxs-lookup"><span data-stu-id="b33fd-117">""</span></span>                      | <span data-ttu-id="b33fd-118">N</span><span class="sxs-lookup"><span data-stu-id="b33fd-118">N</span></span>                     | <span data-ttu-id="b33fd-119">N</span><span class="sxs-lookup"><span data-stu-id="b33fd-119">N</span></span>                      | <span data-ttu-id="b33fd-120">Y</span><span class="sxs-lookup"><span data-stu-id="b33fd-120">Y</span></span>                   |
| <span data-ttu-id="b33fd-121">"ConfigFiles"</span><span class="sxs-lookup"><span data-stu-id="b33fd-121">"ConfigFiles"</span></span>  | <span data-ttu-id="b33fd-122">執行</span><span class="sxs-lookup"><span data-stu-id="b33fd-122">"Executables"</span></span>           | <span data-ttu-id="b33fd-123">N</span><span class="sxs-lookup"><span data-stu-id="b33fd-123">N</span></span>                     | <span data-ttu-id="b33fd-124">N</span><span class="sxs-lookup"><span data-stu-id="b33fd-124">N</span></span>                      | <span data-ttu-id="b33fd-125">Y</span><span class="sxs-lookup"><span data-stu-id="b33fd-125">Y</span></span>                   |
| <span data-ttu-id="b33fd-126">"LicenseInfo"</span><span class="sxs-lookup"><span data-stu-id="b33fd-126">"LicenseInfo"</span></span>  | <span data-ttu-id="b33fd-127">""</span><span class="sxs-lookup"><span data-stu-id="b33fd-127">""</span></span>                      | <span data-ttu-id="b33fd-128">Y</span><span class="sxs-lookup"><span data-stu-id="b33fd-128">Y</span></span>                     | <span data-ttu-id="b33fd-129">N</span><span class="sxs-lookup"><span data-stu-id="b33fd-129">N</span></span>                      | <span data-ttu-id="b33fd-130">Y</span><span class="sxs-lookup"><span data-stu-id="b33fd-130">Y</span></span>                   |
| <span data-ttu-id="b33fd-131">"Security"</span><span class="sxs-lookup"><span data-stu-id="b33fd-131">"Security"</span></span>     | <span data-ttu-id="b33fd-132">""</span><span class="sxs-lookup"><span data-stu-id="b33fd-132">""</span></span>                      | <span data-ttu-id="b33fd-133">Y</span><span class="sxs-lookup"><span data-stu-id="b33fd-133">Y</span></span>                     | <span data-ttu-id="b33fd-134">N</span><span class="sxs-lookup"><span data-stu-id="b33fd-134">N</span></span>                      | <span data-ttu-id="b33fd-135">Y</span><span class="sxs-lookup"><span data-stu-id="b33fd-135">Y</span></span>                   |
| <span data-ttu-id="b33fd-136">使用者</span><span class="sxs-lookup"><span data-stu-id="b33fd-136">"UserInfo"</span></span>     | <span data-ttu-id="b33fd-137">"Security"</span><span class="sxs-lookup"><span data-stu-id="b33fd-137">"Security"</span></span>              | <span data-ttu-id="b33fd-138">N</span><span class="sxs-lookup"><span data-stu-id="b33fd-138">N</span></span>                     | <span data-ttu-id="b33fd-139">N</span><span class="sxs-lookup"><span data-stu-id="b33fd-139">N</span></span>                      | <span data-ttu-id="b33fd-140">N</span><span class="sxs-lookup"><span data-stu-id="b33fd-140">N</span></span>                   |
| <span data-ttu-id="b33fd-141">數位憑證</span><span class="sxs-lookup"><span data-stu-id="b33fd-141">"Certificates"</span></span> | <span data-ttu-id="b33fd-142">"Security"</span><span class="sxs-lookup"><span data-stu-id="b33fd-142">"Security"</span></span>              | <span data-ttu-id="b33fd-143">N</span><span class="sxs-lookup"><span data-stu-id="b33fd-143">N</span></span>                     | <span data-ttu-id="b33fd-144">N</span><span class="sxs-lookup"><span data-stu-id="b33fd-144">N</span></span>                      | <span data-ttu-id="b33fd-145">N</span><span class="sxs-lookup"><span data-stu-id="b33fd-145">N</span></span>                   |
| <span data-ttu-id="b33fd-146">"writerData"</span><span class="sxs-lookup"><span data-stu-id="b33fd-146">"writerData"</span></span>   | <span data-ttu-id="b33fd-147">""</span><span class="sxs-lookup"><span data-stu-id="b33fd-147">""</span></span>                      | <span data-ttu-id="b33fd-148">Y</span><span class="sxs-lookup"><span data-stu-id="b33fd-148">Y</span></span>                     | <span data-ttu-id="b33fd-149">Y</span><span class="sxs-lookup"><span data-stu-id="b33fd-149">Y</span></span>                      | <span data-ttu-id="b33fd-150">Y</span><span class="sxs-lookup"><span data-stu-id="b33fd-150">Y</span></span>                   |
| <span data-ttu-id="b33fd-151">Set1</span><span class="sxs-lookup"><span data-stu-id="b33fd-151">"Set1"</span></span>         | <span data-ttu-id="b33fd-152">"writerData"</span><span class="sxs-lookup"><span data-stu-id="b33fd-152">"writerData"</span></span>            | <span data-ttu-id="b33fd-153">N</span><span class="sxs-lookup"><span data-stu-id="b33fd-153">N</span></span>                     | <span data-ttu-id="b33fd-154">Y</span><span class="sxs-lookup"><span data-stu-id="b33fd-154">Y</span></span>                      | <span data-ttu-id="b33fd-155">N</span><span class="sxs-lookup"><span data-stu-id="b33fd-155">N</span></span>                   |
| <span data-ttu-id="b33fd-156">Jan</span><span class="sxs-lookup"><span data-stu-id="b33fd-156">"Jan"</span></span>          | <span data-ttu-id="b33fd-157">"writerData \\ Set1"</span><span class="sxs-lookup"><span data-stu-id="b33fd-157">"writerData\\Set1"</span></span>      | <span data-ttu-id="b33fd-158">N</span><span class="sxs-lookup"><span data-stu-id="b33fd-158">N</span></span>                     | <span data-ttu-id="b33fd-159">N</span><span class="sxs-lookup"><span data-stu-id="b33fd-159">N</span></span>                      | <span data-ttu-id="b33fd-160">N</span><span class="sxs-lookup"><span data-stu-id="b33fd-160">N</span></span>                   |
| <span data-ttu-id="b33fd-161">年</span><span class="sxs-lookup"><span data-stu-id="b33fd-161">"Dec"</span></span>          | <span data-ttu-id="b33fd-162">"writerData \\ Set1"</span><span class="sxs-lookup"><span data-stu-id="b33fd-162">"writerData\\Set1"</span></span>      | <span data-ttu-id="b33fd-163">N</span><span class="sxs-lookup"><span data-stu-id="b33fd-163">N</span></span>                     | <span data-ttu-id="b33fd-164">N</span><span class="sxs-lookup"><span data-stu-id="b33fd-164">N</span></span>                      | <span data-ttu-id="b33fd-165">N</span><span class="sxs-lookup"><span data-stu-id="b33fd-165">N</span></span>                   |
| <span data-ttu-id="b33fd-166">Set2</span><span class="sxs-lookup"><span data-stu-id="b33fd-166">"Set2"</span></span>         | <span data-ttu-id="b33fd-167">"writerData"</span><span class="sxs-lookup"><span data-stu-id="b33fd-167">"writerData"</span></span>            | <span data-ttu-id="b33fd-168">N</span><span class="sxs-lookup"><span data-stu-id="b33fd-168">N</span></span>                     | <span data-ttu-id="b33fd-169">Y</span><span class="sxs-lookup"><span data-stu-id="b33fd-169">Y</span></span>                      | <span data-ttu-id="b33fd-170">N</span><span class="sxs-lookup"><span data-stu-id="b33fd-170">N</span></span>                   |
| <span data-ttu-id="b33fd-171">Jan</span><span class="sxs-lookup"><span data-stu-id="b33fd-171">"Jan"</span></span>          | <span data-ttu-id="b33fd-172">\\"writerData</span><span class="sxs-lookup"><span data-stu-id="b33fd-172">"writerData\\Set2"</span></span>      | <span data-ttu-id="b33fd-173">N</span><span class="sxs-lookup"><span data-stu-id="b33fd-173">N</span></span>                     | <span data-ttu-id="b33fd-174">N</span><span class="sxs-lookup"><span data-stu-id="b33fd-174">N</span></span>                      | <span data-ttu-id="b33fd-175">N</span><span class="sxs-lookup"><span data-stu-id="b33fd-175">N</span></span>                   |
| <span data-ttu-id="b33fd-176">年</span><span class="sxs-lookup"><span data-stu-id="b33fd-176">"Dec"</span></span>          | <span data-ttu-id="b33fd-177">\\"writerData</span><span class="sxs-lookup"><span data-stu-id="b33fd-177">"writerData\\Set2"</span></span>      | <span data-ttu-id="b33fd-178">N</span><span class="sxs-lookup"><span data-stu-id="b33fd-178">N</span></span>                     | <span data-ttu-id="b33fd-179">N</span><span class="sxs-lookup"><span data-stu-id="b33fd-179">N</span></span>                      | <span data-ttu-id="b33fd-180">N</span><span class="sxs-lookup"><span data-stu-id="b33fd-180">N</span></span>                   |
| <span data-ttu-id="b33fd-181">查詢</span><span class="sxs-lookup"><span data-stu-id="b33fd-181">"Query"</span></span>        | <span data-ttu-id="b33fd-182">"writerData \\ QueryLogs"</span><span class="sxs-lookup"><span data-stu-id="b33fd-182">"writerData\\QueryLogs"</span></span> | <span data-ttu-id="b33fd-183">N</span><span class="sxs-lookup"><span data-stu-id="b33fd-183">N</span></span>                     | <span data-ttu-id="b33fd-184">N</span><span class="sxs-lookup"><span data-stu-id="b33fd-184">N</span></span>                      | <span data-ttu-id="b33fd-185">N</span><span class="sxs-lookup"><span data-stu-id="b33fd-185">N</span></span>                   |
| <span data-ttu-id="b33fd-186">用法</span><span class="sxs-lookup"><span data-stu-id="b33fd-186">"Usage"</span></span>        | <span data-ttu-id="b33fd-187">"writerData"</span><span class="sxs-lookup"><span data-stu-id="b33fd-187">"writerData"</span></span>            | <span data-ttu-id="b33fd-188">Y</span><span class="sxs-lookup"><span data-stu-id="b33fd-188">Y</span></span>                     | <span data-ttu-id="b33fd-189">Y</span><span class="sxs-lookup"><span data-stu-id="b33fd-189">Y</span></span>                      | <span data-ttu-id="b33fd-190">N</span><span class="sxs-lookup"><span data-stu-id="b33fd-190">N</span></span>                   |
| <span data-ttu-id="b33fd-191">Jan</span><span class="sxs-lookup"><span data-stu-id="b33fd-191">"Jan"</span></span>          | <span data-ttu-id="b33fd-192">"writerData \\ Usage"</span><span class="sxs-lookup"><span data-stu-id="b33fd-192">"writerData\\Usage"</span></span>     | <span data-ttu-id="b33fd-193">N</span><span class="sxs-lookup"><span data-stu-id="b33fd-193">N</span></span>                     | <span data-ttu-id="b33fd-194">N</span><span class="sxs-lookup"><span data-stu-id="b33fd-194">N</span></span>                      | <span data-ttu-id="b33fd-195">N</span><span class="sxs-lookup"><span data-stu-id="b33fd-195">N</span></span>                   |
| <span data-ttu-id="b33fd-196">年</span><span class="sxs-lookup"><span data-stu-id="b33fd-196">"Dec"</span></span>          | <span data-ttu-id="b33fd-197">"writerData \\ Usage"</span><span class="sxs-lookup"><span data-stu-id="b33fd-197">"writerData\\Usage"</span></span>     | <span data-ttu-id="b33fd-198">N</span><span class="sxs-lookup"><span data-stu-id="b33fd-198">N</span></span>                     | <span data-ttu-id="b33fd-199">N</span><span class="sxs-lookup"><span data-stu-id="b33fd-199">N</span></span>                      | <span data-ttu-id="b33fd-200">N</span><span class="sxs-lookup"><span data-stu-id="b33fd-200">N</span></span>                   |



 

## <a name="implicitly-included-components-in-the-backup-set"></a><span data-ttu-id="b33fd-201">備份組中隱含包含的元件</span><span class="sxs-lookup"><span data-stu-id="b33fd-201">Implicitly Included Components in the Backup Set</span></span>

<span data-ttu-id="b33fd-202">檢查寫入器的寫入器元資料檔案時 (請參閱 [**>ivssbackupcomponents：： GetWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-getwritermetadata)) 在備份期間，要求者應儲存所有元件的清單、其 [*邏輯路徑*](vssgloss-l.md)及其檔案集資訊。</span><span class="sxs-lookup"><span data-stu-id="b33fd-202">While examining a writer's Writer Metadata Document (see [**IVssBackupComponents::GetWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-getwritermetadata)) during backup, a requester should be storing a list of all components, their [*logical paths*](vssgloss-l.md), and their file set information.</span></span>

<span data-ttu-id="b33fd-203">需要檔案集和排除的檔案資訊，才能明確或隱含) 包含的元件，判斷任何 (的檔案清單。</span><span class="sxs-lookup"><span data-stu-id="b33fd-203">File set and excluded file information will be needed to determine a list of files for any (explicitly or implicitly) included component.</span></span>

<span data-ttu-id="b33fd-204">針對沒有可選取的備份元件的其，以及未定義 [*元件集*](vssgloss-c.md)的備份元件可選取的專案，因為這些元件不會定義子元件，所以只需要檔案集和排除的檔案資訊來識別所有元件的候選備份。</span><span class="sxs-lookup"><span data-stu-id="b33fd-204">For nonselectable for backup components with no selectable for backup ancestors and selectable for backup components that do not define a [*component set*](vssgloss-c.md), only file set and excluded file information will be needed to identify all the component's candidates for backup, because these components do not define subcomponents.</span></span>

<span data-ttu-id="b33fd-205">若要針對定義元件集的備份元件明確包含可選取的，則必須使用檔案設定和排除定義元件和所有 [*子元件*](vssgloss-s.md) 的檔案資訊，以選取要備份的檔案。</span><span class="sxs-lookup"><span data-stu-id="b33fd-205">For explicitly included selectable for backup components that define a component set, the file sets and exclude file information both for the defining component and all [*subcomponents*](vssgloss-s.md) needs to be used to select files for backup.</span></span>

<span data-ttu-id="b33fd-206">這表示只有使用 [**IVssWMComponent**](/windows/desktop/api/VsBackup/nl-vsbackup-ivsswmcomponent) 介面的實例檢查這些元件的寫入器中繼資料，才能找到元件 "可執行檔"、"ConfigFiles" 和 "LicenseInfo" 的備份組。</span><span class="sxs-lookup"><span data-stu-id="b33fd-206">This means that backup sets for the components "Executables", "ConfigFiles", and "LicenseInfo" can be found only by examining the writer metadata for just these components using their instances of the [**IVssWMComponent**](/windows/desktop/api/VsBackup/nl-vsbackup-ivsswmcomponent) interface.</span></span>

<span data-ttu-id="b33fd-207">但是，如果 writerData 明確包含在備份中，您就必須檢查其 [**IVssWMComponent**](/windows/desktop/api/VsBackup/nl-vsbackup-ivsswmcomponent) 介面的實例，以及 "Set1"、"Jan" (邏輯路徑 "writerData \\ Set1" ) "的實例。 Dec" (的邏輯路徑 "writerData \\ Set1" ) ，"WriterData '，" Jan " (具有邏輯路徑" \\ ' ) ，"Dec" (，邏輯路徑 "writerData ) ' (\\ ，" Query "，" Usage "，" Jan " \\ \\ ) 具有邏輯路徑" writerData usage " (，" ") 具有邏輯路徑" writerData usage "。</span><span class="sxs-lookup"><span data-stu-id="b33fd-207">However, if writerData is explicitly included in the backup, you must examine its instance of the [**IVssWMComponent**](/windows/desktop/api/VsBackup/nl-vsbackup-ivsswmcomponent) interface and those for "Set1", "Jan" (with logical path "writerData\\Set1"), "Dec" (with logical path "writerData\\Set1"), "Set2", "Jan" (with logical path "writerData\\Set2"), "Dec" (with logical path "writerData\\Set2"), "Query", "Usage", "Jan" (with logical path "writerData\\Usage"), and "Dec" (with logical path "writerData\\Usage").</span></span>

<span data-ttu-id="b33fd-208">若要這樣做，要求者必須先找出元件 "writerData" (邏輯路徑 "" ) 是可選取的。</span><span class="sxs-lookup"><span data-stu-id="b33fd-208">To do this, a requester will have to first identify that the component "writerData" (logical path "") is selectable.</span></span> <span data-ttu-id="b33fd-209">然後，它必須掃描寫入器所管理的所有其他元件，以判斷其邏輯路徑中的第一個元素是否為 "writerData"。</span><span class="sxs-lookup"><span data-stu-id="b33fd-209">It will then have to scan all the other components managed by the writer to determine whether the first element in their logical path is "writerData".</span></span> <span data-ttu-id="b33fd-210">以 "writerData" 作為邏輯路徑前置成員的元件會被識別為 "writerData" 的子元件，並在明確選取時隱含地選取。</span><span class="sxs-lookup"><span data-stu-id="b33fd-210">Those components that have "writerData" as the leading members of their logical path are identified as being subcomponents of "writerData" and are implicitly selected when it is explicitly selected.</span></span>

<span data-ttu-id="b33fd-211">事實上，需要進行類似的掃描以判斷沒有任何元件以「LicenseInfo」作為其邏輯路徑的主要成員，因此「LicenseInfo」沒有子元件。</span><span class="sxs-lookup"><span data-stu-id="b33fd-211">In fact, a similar scan will need to be made to determine that no component has "LicenseInfo" as the leading member of its logical path, and thus that "LicenseInfo" has no subcomponents.</span></span>

<span data-ttu-id="b33fd-212">由於 VSS 中的這項機制複雜度，許多要求者寫入器可能會發現建立自己的結構來儲存明確和隱含新增元件的元件和備份組資訊，會很有説明。</span><span class="sxs-lookup"><span data-stu-id="b33fd-212">Because of the complexity of this mechanism in VSS, many requester writers may find it useful to create their own structures for storing component and backup set information for both explicitly and implicitly added components.</span></span>

## <a name="properties-of-implicitly-included-components"></a><span data-ttu-id="b33fd-213">隱含包含元件的屬性</span><span class="sxs-lookup"><span data-stu-id="b33fd-213">Properties of Implicitly Included Components</span></span>

<span data-ttu-id="b33fd-214">在還原和備份作業期間，會使用 [**>ivsscomponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) 和 [**>ivssbackupcomponents**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssbackupcomponents) 介面的實例來取出元件的相關資訊，以及設定或變更元件屬性。</span><span class="sxs-lookup"><span data-stu-id="b33fd-214">During restore and backup operations, instances of the [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) and [**IVssBackupComponents**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssbackupcomponents) interfaces are used both to retrieve information about components, and to set or change component properties.</span></span> <span data-ttu-id="b33fd-215">不過，只有明確包含的元件會有 **>ivsscomponent** 介面的實例，或可供 **>ivssbackupcomponents** 介面存取。</span><span class="sxs-lookup"><span data-stu-id="b33fd-215">However, only components explicitly included will have instances of the **IVssComponent** interface or be accessible to the **IVssBackupComponents** interface.</span></span>

<span data-ttu-id="b33fd-216">某些屬性在範圍內是全元件集。</span><span class="sxs-lookup"><span data-stu-id="b33fd-216">Some properties are component-set-wide in scope.</span></span> <span data-ttu-id="b33fd-217">這些屬性包括下列各項：</span><span class="sxs-lookup"><span data-stu-id="b33fd-217">These properties include the following:</span></span>

-   <span data-ttu-id="b33fd-218">備份與還原狀態：</span><span class="sxs-lookup"><span data-stu-id="b33fd-218">Backup and restore status:</span></span> <dl>

[<span data-ttu-id="b33fd-219">**>ivssbackupcomponents：： SetBackupSucceeded**</span><span class="sxs-lookup"><span data-stu-id="b33fd-219">**IVssBackupComponents::SetBackupSucceeded**</span></span>](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupsucceeded)  
    [<span data-ttu-id="b33fd-220">**>ivsscomponent：： GetBackupSucceeded**</span><span class="sxs-lookup"><span data-stu-id="b33fd-220">**IVssComponent::GetBackupSucceeded**</span></span>](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getbackupsucceeded)  
    [<span data-ttu-id="b33fd-221">**>ivssbackupcomponents：： SetFileRestoreStatus**</span><span class="sxs-lookup"><span data-stu-id="b33fd-221">**IVssBackupComponents::SetFileRestoreStatus**</span></span>](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setfilerestorestatus)  
    [<span data-ttu-id="b33fd-222">**>ivsscomponent：： GetFileRestoreStatus**</span><span class="sxs-lookup"><span data-stu-id="b33fd-222">**IVssComponent::GetFileRestoreStatus**</span></span>](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getfilerestorestatus)  
    </dl>
-   <span data-ttu-id="b33fd-223">備份和還原選項：</span><span class="sxs-lookup"><span data-stu-id="b33fd-223">Backup and restore options:</span></span> <dl>

[<span data-ttu-id="b33fd-224">**>ivssbackupcomponents：： SetBackupOptions**</span><span class="sxs-lookup"><span data-stu-id="b33fd-224">**IVssBackupComponents::SetBackupOptions**</span></span>](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupoptions)  
    [<span data-ttu-id="b33fd-225">**>ivsscomponent：： GetBackupOptions**</span><span class="sxs-lookup"><span data-stu-id="b33fd-225">**IVssComponent::GetBackupOptions**</span></span>](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getbackupoptions)  
    [<span data-ttu-id="b33fd-226">**>ivssbackupcomponents：： SetRestoreOptions**</span><span class="sxs-lookup"><span data-stu-id="b33fd-226">**IVssBackupComponents::SetRestoreOptions**</span></span>](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setrestoreoptions)  
    [<span data-ttu-id="b33fd-227">**>ivsscomponent：： GetRestoreOptions**</span><span class="sxs-lookup"><span data-stu-id="b33fd-227">**IVssComponent::GetRestoreOptions**</span></span>](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getrestoreoptions)  
    </dl>
-   <span data-ttu-id="b33fd-228">失敗訊息：</span><span class="sxs-lookup"><span data-stu-id="b33fd-228">Failure messages:</span></span> <dl>

[<span data-ttu-id="b33fd-229">**>ivsscomponent：： SetPostRestoreFailureMsg**</span><span class="sxs-lookup"><span data-stu-id="b33fd-229">**IVssComponent::SetPostRestoreFailureMsg**</span></span>](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setpostrestorefailuremsg)  
    [<span data-ttu-id="b33fd-230">**>ivsscomponent：： SetPreRestoreFailureMsg**</span><span class="sxs-lookup"><span data-stu-id="b33fd-230">**IVssComponent::SetPreRestoreFailureMsg**</span></span>](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setprerestorefailuremsg)  
    [<span data-ttu-id="b33fd-231">**>ivsscomponent：： SetPostRestoreFailureMsg**</span><span class="sxs-lookup"><span data-stu-id="b33fd-231">**IVssComponent::SetPostRestoreFailureMsg**</span></span>](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setpostrestorefailuremsg)  
    [<span data-ttu-id="b33fd-232">**>ivsscomponent：： SetPreRestoreFailureMsg**</span><span class="sxs-lookup"><span data-stu-id="b33fd-232">**IVssComponent::SetPreRestoreFailureMsg**</span></span>](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setprerestorefailuremsg)  
    </dl>
-   <span data-ttu-id="b33fd-233">還原目標：</span><span class="sxs-lookup"><span data-stu-id="b33fd-233">Restore targets:</span></span> <dl>

[<span data-ttu-id="b33fd-234">**>ivsscomponent：： SetRestoreTarget**</span><span class="sxs-lookup"><span data-stu-id="b33fd-234">**IVssComponent::SetRestoreTarget**</span></span>](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setrestoretarget)  
    [<span data-ttu-id="b33fd-235">**>ivsscomponent：： GetRestoreTarget**</span><span class="sxs-lookup"><span data-stu-id="b33fd-235">**IVssComponent::GetRestoreTarget**</span></span>](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getrestoretarget)  
    </dl>
-   <span data-ttu-id="b33fd-236">備份戳記：</span><span class="sxs-lookup"><span data-stu-id="b33fd-236">Backup stamps:</span></span> <dl>

[<span data-ttu-id="b33fd-237">**>ivsscomponent：： SetBackupStamp**</span><span class="sxs-lookup"><span data-stu-id="b33fd-237">**IVssComponent::SetBackupStamp**</span></span>](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setbackupstamp)  
    [<span data-ttu-id="b33fd-238">**>ivsscomponent：： GetBackupStamp**</span><span class="sxs-lookup"><span data-stu-id="b33fd-238">**IVssComponent::GetBackupStamp**</span></span>](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getbackupstamp)  
    </dl>
-   <span data-ttu-id="b33fd-239">其他中繼資料：</span><span class="sxs-lookup"><span data-stu-id="b33fd-239">Additional metadata:</span></span> <dl>

[<span data-ttu-id="b33fd-240">**>ivsscomponent：： SetRestoreMetadata**</span><span class="sxs-lookup"><span data-stu-id="b33fd-240">**IVssComponent::SetRestoreMetadata**</span></span>](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setrestoremetadata)  
    [<span data-ttu-id="b33fd-241">**>ivsscomponent：： GetRestoreMetadata**</span><span class="sxs-lookup"><span data-stu-id="b33fd-241">**IVssComponent::GetRestoreMetadata**</span></span>](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getrestoremetadata)  
    [<span data-ttu-id="b33fd-242">**>ivsscomponent：： SetBackupMetadata**</span><span class="sxs-lookup"><span data-stu-id="b33fd-242">**IVssComponent::SetBackupMetadata**</span></span>](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setbackupmetadata)  
    [<span data-ttu-id="b33fd-243">**>ivsscomponent：： GetBackupMetadata**</span><span class="sxs-lookup"><span data-stu-id="b33fd-243">**IVssComponent::GetBackupMetadata**</span></span>](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getbackupmetadata)  
    </dl>

<span data-ttu-id="b33fd-244">因此，您可以使用元件集之定義成員的 [**>ivsscomponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) 介面實例，或使用定義成員的名稱、類型和邏輯路徑與 [**>ivssbackupcomponents**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssbackupcomponents) 方法，來設定或抓取所有元件集成員的屬性。</span><span class="sxs-lookup"><span data-stu-id="b33fd-244">Therefore, you use the instance of the [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) interface of a component set's defining member or use the defining member's name, type, and logical path with an [**IVssBackupComponents**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssbackupcomponents) method to set or retrieve properties for all the component set's members.</span></span>

<span data-ttu-id="b33fd-245">基於這個理由，元件集會被視為單位。</span><span class="sxs-lookup"><span data-stu-id="b33fd-245">For this reason, component sets are treated as units.</span></span> <span data-ttu-id="b33fd-246">比方說，只有在所有元件的所有檔案集都成功備份時，元件集的備份才會成功。</span><span class="sxs-lookup"><span data-stu-id="b33fd-246">For instance, a backup of a component set is successful only if the backup of all of the file sets of all of its components is successful.</span></span>

<span data-ttu-id="b33fd-247">在上述範例中，假設元件 "Jan" (中的一個檔案具有邏輯路徑 "writerData '， \\ ) 是" writerData "所定義之元件集的成員。</span><span class="sxs-lookup"><span data-stu-id="b33fd-247">In the preceding example, suppose one file in the component "Jan" (with logical path "writerData\\Set2") is a member of the component set defined by "writerData".</span></span> <span data-ttu-id="b33fd-248">如果 "Jan" 的檔案中有一個無法備份，要求者會使用 "writerData" 的資訊 (其名稱 "writerData"、其路徑 ""，以及其元件類型) 做為引數，在設定 [**>ivssbackupcomponents：： SetBackupSucceeded**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupsucceeded) 與 **false** 以表示元件集失敗時。</span><span class="sxs-lookup"><span data-stu-id="b33fd-248">If one of "Jan"'s files failed to back up, a requester would use "writerData"'s information (its name "writerData", its path "", and its component type) as arguments when setting [**IVssBackupComponents::SetBackupSucceeded**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupsucceeded) with **false** to indicate the component set's failure.</span></span>

<span data-ttu-id="b33fd-249">同樣地， [**>ivsscomponent：： GetBackupSucceeded**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getbackupsucceeded) 針對 [**>ivsscomponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) 介面的實例所傳回的狀態，不只適用于 "writerData"，也適用于其所有子元件。</span><span class="sxs-lookup"><span data-stu-id="b33fd-249">Similarly, the state returned by [**IVssComponent::GetBackupSucceeded**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getbackupsucceeded) for "writerData"'s instance of the [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) interface applies not just to "writerData" but to all its subcomponents as well.</span></span>

<span data-ttu-id="b33fd-250">此外，如果寫入器選擇使用 "writerData" 之 [**>ivsscomponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent)實例的 [**>ivsscomponent：： SetRestoreTarget**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setrestoretarget)來變更還原目標，則會變更所有 "writerData" 子元件的所有檔案集的還原目標。</span><span class="sxs-lookup"><span data-stu-id="b33fd-250">In addition, if a writer chose to change the restore target using [**IVssComponent::SetRestoreTarget**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setrestoretarget) of "writerData"'s instance of [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent), that would change the restore target for all the file sets of all of "writerData"'s subcomponents.</span></span>

<span data-ttu-id="b33fd-251">下列屬性不適用於全元件，而是套用至特定檔案或檔案集：</span><span class="sxs-lookup"><span data-stu-id="b33fd-251">The following properties apply not component-wide, but to particular files or file sets:</span></span>

-   <span data-ttu-id="b33fd-252">替代位置對應：</span><span class="sxs-lookup"><span data-stu-id="b33fd-252">Alternate location mappings:</span></span> <dl>

[<span data-ttu-id="b33fd-253">**>ivssbackupcomponents：： AddAlternativeLocationMapping**</span><span class="sxs-lookup"><span data-stu-id="b33fd-253">**IVssBackupComponents::AddAlternativeLocationMapping**</span></span>](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addalternativelocationmapping)  
    [<span data-ttu-id="b33fd-254">**>ivsscomponent：： GetAlternateLocationMapping**</span><span class="sxs-lookup"><span data-stu-id="b33fd-254">**IVssComponent::GetAlternateLocationMapping**</span></span>](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getalternatelocationmapping)  
    [<span data-ttu-id="b33fd-255">**>ivsscomponent：： GetAlternateLocationMappingCount**</span><span class="sxs-lookup"><span data-stu-id="b33fd-255">**IVssComponent::GetAlternateLocationMappingCount**</span></span>](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getalternatelocationmappingcount)  
    </dl>
-   <span data-ttu-id="b33fd-256">差異檔案：</span><span class="sxs-lookup"><span data-stu-id="b33fd-256">Differenced files:</span></span> <dl>

[<span data-ttu-id="b33fd-257">**>ivsscomponent：： AddDifferencedFilesByLastModifyTime**</span><span class="sxs-lookup"><span data-stu-id="b33fd-257">**IVssComponent::AddDifferencedFilesByLastModifyTime**</span></span>](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-adddifferencedfilesbylastmodifytime)  
    [<span data-ttu-id="b33fd-258">**>ivsscomponent：： GetDifferencedFile**</span><span class="sxs-lookup"><span data-stu-id="b33fd-258">**IVssComponent::GetDifferencedFile**</span></span>](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getdifferencedfile)  
    [<span data-ttu-id="b33fd-259">**>ivsscomponent：： GetDifferencedFilesCount**</span><span class="sxs-lookup"><span data-stu-id="b33fd-259">**IVssComponent::GetDifferencedFilesCount**</span></span>](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getdifferencedfilescount)  
    </dl>
-   <span data-ttu-id="b33fd-260">部分檔案：</span><span class="sxs-lookup"><span data-stu-id="b33fd-260">Partial files:</span></span> <dl>

[<span data-ttu-id="b33fd-261">**>ivsscomponent：： AddPartialFile**</span><span class="sxs-lookup"><span data-stu-id="b33fd-261">**IVssComponent::AddPartialFile**</span></span>](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-addpartialfile)  
    [<span data-ttu-id="b33fd-262">**>ivsscomponent：： GetPartialFile**</span><span class="sxs-lookup"><span data-stu-id="b33fd-262">**IVssComponent::GetPartialFile**</span></span>](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getpartialfile)  
    [<span data-ttu-id="b33fd-263">**>ivsscomponent：： GetPartialFileCount**</span><span class="sxs-lookup"><span data-stu-id="b33fd-263">**IVssComponent::GetPartialFileCount**</span></span>](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getpartialfilecount)  
    </dl>
-   <span data-ttu-id="b33fd-264">導向的目標：</span><span class="sxs-lookup"><span data-stu-id="b33fd-264">Directed targets:</span></span> <dl>

[<span data-ttu-id="b33fd-265">**>ivsscomponent：： AddDirectedTarget**</span><span class="sxs-lookup"><span data-stu-id="b33fd-265">**IVssComponent::AddDirectedTarget**</span></span>](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-adddirectedtarget)  
    [<span data-ttu-id="b33fd-266">**>ivsscomponent：： GetDirectedTarget**</span><span class="sxs-lookup"><span data-stu-id="b33fd-266">**IVssComponent::GetDirectedTarget**</span></span>](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getdirectedtarget)  
    [<span data-ttu-id="b33fd-267">**>ivsscomponent：： GetDirectedTargetCount**</span><span class="sxs-lookup"><span data-stu-id="b33fd-267">**IVssComponent::GetDirectedTargetCount**</span></span>](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getdirectedtargetcount)  
    </dl>
-   <span data-ttu-id="b33fd-268">新目標：</span><span class="sxs-lookup"><span data-stu-id="b33fd-268">New targets:</span></span> <dl>

[<span data-ttu-id="b33fd-269">**>ivssbackupcomponents：： AddNewTarget**</span><span class="sxs-lookup"><span data-stu-id="b33fd-269">**IVssBackupComponents::AddNewTarget**</span></span>](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addnewtarget)  
    [<span data-ttu-id="b33fd-270">**>ivsscomponent：： GetNewTarget**</span><span class="sxs-lookup"><span data-stu-id="b33fd-270">**IVssComponent::GetNewTarget**</span></span>](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getnewtarget)  
    [<span data-ttu-id="b33fd-271">**>ivsscomponent：： GetNewTargetCount**</span><span class="sxs-lookup"><span data-stu-id="b33fd-271">**IVssComponent::GetNewTargetCount**</span></span>](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getnewtargetcount)  
    </dl>

<span data-ttu-id="b33fd-272">當要求者使用 [**>ivssbackupcomponents**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssbackupcomponents) 介面來存取子元件的這些功能時，它會使用元件集定義元件的元件資訊，但會使用元件的檔案或檔案集資訊。</span><span class="sxs-lookup"><span data-stu-id="b33fd-272">When a requester accesses these features for a subcomponent using the [**IVssBackupComponents**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssbackupcomponents) interface, it uses the component information for the component set's defining component, but the file or file set information for the subcomponent.</span></span>

<span data-ttu-id="b33fd-273">同樣地，如果屬性可透過 [**>ivsscomponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) 介面存取，則會使用對應至定義子元件的實例，但會從子元件取得檔案或檔案集引數。</span><span class="sxs-lookup"><span data-stu-id="b33fd-273">Likewise, if the property is accessible through the [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) interface, the instance corresponding to the defining subcomponent is used, but the file or file set arguments are taken from the subcomponent.</span></span>

<span data-ttu-id="b33fd-274">比方說，假設子元件 "Jan" (邏輯路徑 "writerData \\ '： '，) 具有路徑為" c： fred "的檔案 \\ （檔案規格為" \* .dat "），且遞迴旗標為 **true** 可能必須還原至替代位置。</span><span class="sxs-lookup"><span data-stu-id="b33fd-274">For instance, suppose the subcomponent "Jan" (with logical path "writerData\\Set2") had a file set with a path of "c:\\fred", a file specification of "\*.dat", and a recursive flag of **true** might have to be restored to an alternate location.</span></span>

<span data-ttu-id="b33fd-275">如果發生這種情況，要求者會呼叫 [**>ivssbackupcomponents：： AddAlternativeLocationMapping**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addalternativelocationmapping)，並使用 "writerData" 的資訊 (元件類型、"writeData" 的元件名稱，以及 "" ) 的邏輯路徑以及 "Jan" 的檔案集資訊 (路徑 "c： \\ fred"、檔案規格 " \* .dat" 和遞迴等於 **true**) 。</span><span class="sxs-lookup"><span data-stu-id="b33fd-275">If this was the case, a requester would call [**IVssBackupComponents::AddAlternativeLocationMapping**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addalternativelocationmapping), using "writerData"'s information (component type, a component name of "writeData", and a logical path of "") along with "Jan"'s file set information (path "c:\\fred", file specification "\*.dat", and recursion equals **true**).</span></span>

<span data-ttu-id="b33fd-276">請注意，在此情況下，檔案集資訊必須完全符合 [**IVssCreateWriterMetadata：： AddFilesToFileGroup**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-addfilestofilegroup)、 [**IVssCreateWriterMetadata：： AddDatabaseFiles**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-adddatabasefiles)或 [**IVssCreateWriterMetadata：： AddDatabaseLogFiles**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-adddatabaselogfiles) 用來將檔案新增至 Jan 的檔案集資訊。</span><span class="sxs-lookup"><span data-stu-id="b33fd-276">Note that in this case the file set information must exactly match the file set information used by [**IVssCreateWriterMetadata::AddFilesToFileGroup**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-addfilestofilegroup), [**IVssCreateWriterMetadata::AddDatabaseFiles**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-adddatabasefiles), or [**IVssCreateWriterMetadata::AddDatabaseLogFiles**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-adddatabaselogfiles) to add files to Jan.</span></span>

<span data-ttu-id="b33fd-277">同樣地，如果寫入器想要將導向的目標新增至路徑為 "c： ethel" 且名稱為 "lucy" 的檔案，且該檔案具有 \\ 邏輯路徑 "writerData ' ) 所管理的" jan " (\\ ，則會使用對應于" writerData "的 [**>ivsscomponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) 實例，但" jan "的檔案資訊。</span><span class="sxs-lookup"><span data-stu-id="b33fd-277">Similarly, if a writer wanted to add a directed target to a file with a path of "c:\\ethel" and name "lucy.dat" managed by "Jan" (with logical path "writerData\\Set2"), it would use the [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) instance corresponding to "writerData", but "Jan"'s file information.</span></span>

## <a name="implicitly-included-components-in-the-restore-set"></a><span data-ttu-id="b33fd-278">還原集中隱含包含的元件</span><span class="sxs-lookup"><span data-stu-id="b33fd-278">Implicitly Included Components in the Restore Set</span></span>

<span data-ttu-id="b33fd-279">如果已隱含包含在備份中的元件，可以在還原時明確包含在還原中。</span><span class="sxs-lookup"><span data-stu-id="b33fd-279">Components that were implicitly included in a backup can be explicitly included in a restore if they are selectable for restore.</span></span> <span data-ttu-id="b33fd-280">如同使用 [Selectability 進行還原和子元件](working-with-selectability-for-restore-and-subcomponents.md)所述，這類元件會使用 [**>ivssbackupcomponents：： AddRestoreSubcomponent**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addrestoresubcomponent) 方法加入至備份元件檔。</span><span class="sxs-lookup"><span data-stu-id="b33fd-280">As noted in [Working with Selectability for Restore and Subcomponents](working-with-selectability-for-restore-and-subcomponents.md), such components are added to the Backup Components Document using the [**IVssBackupComponents::AddRestoreSubcomponent**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addrestoresubcomponent) method.</span></span>

<span data-ttu-id="b33fd-281">不過，這不會建立 [**>ivsscomponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) 介面的新實例，也不會直接透過 [**>ivssbackupcomponents**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssbackupcomponents) 介面存取元件。</span><span class="sxs-lookup"><span data-stu-id="b33fd-281">However, this does not create a new instance of the [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) interface, nor is the component directly accessible through the [**IVssBackupComponents**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssbackupcomponents) interface.</span></span>

<span data-ttu-id="b33fd-282">相反地，明確包含用於還原的元件，但隱含包含在備份中的元件，必須透過 [**>ivsscomponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) 介面的實例來存取，而該介面會對應到在備份時定義其所屬元件的元件集。</span><span class="sxs-lookup"><span data-stu-id="b33fd-282">Instead, a component explicitly included for restore, but implicitly included for backup, must be accessed through an instance of the [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) interface corresponding to the component that defined the component set of which it was a member upon backup.</span></span>

<span data-ttu-id="b33fd-283">例如，若要明確地包含 restore "Set1" （可選取的子元件為 "writerData"），您可以藉由呼叫 [**writerData**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent)介面之 ">ivsscomponent" 實例的 [**>ivsscomponent：： GetRestoreSubcomponent**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getrestoresubcomponent)方法，取得其相關資訊。</span><span class="sxs-lookup"><span data-stu-id="b33fd-283">For example, to explicitly include for restore "Set1", a subcomponent of the selectable for backup component "writerData", you would obtain information about it by calling the [**IVssComponent::GetRestoreSubcomponent**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getrestoresubcomponent) method of "writerData"'s instance of the [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) interface.</span></span>

 

 



