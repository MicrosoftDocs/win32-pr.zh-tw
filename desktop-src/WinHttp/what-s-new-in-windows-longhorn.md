---
description: 從 Windows Server 2008 和 Windows Vista 開始，WinHTTP API 已經過增強，可包含下列功能。
ms.assetid: b47a2e38-67bd-4d43-936c-8781641cb7f6
title: Windows Server 2008 和 Windows Vista 的新功能
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: fac0f274b45e1db79fb79340b7f490de96f57e8f
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/07/2021
ms.locfileid: "104469084"
---
# <a name="whats-new-in-windows-server-2008-and-windows-vista"></a><span data-ttu-id="898b9-103">Windows Server 2008 和 Windows Vista 的新功能</span><span class="sxs-lookup"><span data-stu-id="898b9-103">What's New in Windows Server 2008 and Windows Vista</span></span>

<span data-ttu-id="898b9-104">從 Windows Server 2008 和 Windows Vista 開始，WinHTTP API 已經過增強，可包含下列功能。</span><span class="sxs-lookup"><span data-stu-id="898b9-104">Starting in Windows Server 2008 and Windows Vista, the WinHTTP API has been enhanced to include the following features.</span></span>

## <a name="greater-than-4-gb-upload"></a><span data-ttu-id="898b9-105">大於 4 GB 的上傳。</span><span class="sxs-lookup"><span data-stu-id="898b9-105">Greater Than 4-GB Upload.</span></span>

<span data-ttu-id="898b9-106">[**WinHttpSendRequest**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpsendrequest) 只能傳送 4 GB 的資料，因為 DWORD 總長度參數的大小有所限制。</span><span class="sxs-lookup"><span data-stu-id="898b9-106">[**WinHttpSendRequest**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpsendrequest) can send only 4 GB of data because of limitations in the size of the DWORD total length parameter.</span></span> <span data-ttu-id="898b9-107">若要讓應用程式傳送超過 4 GB 的資料，則會將內容長度標頭新增至要求，並將資料指定為大型 \_ 整數 (2 ^ 64 位元組) 。</span><span class="sxs-lookup"><span data-stu-id="898b9-107">To enable applications to send more than 4 GB of data, the Content-Length header is added to the request specifying data as large as a LARGE\_INTEGER (2^64 bytes).</span></span> <span data-ttu-id="898b9-108">如需詳細資訊，請參閱 **WinHttpSendRequest**。</span><span class="sxs-lookup"><span data-stu-id="898b9-108">For more information, see **WinHttpSendRequest**.</span></span> <span data-ttu-id="898b9-109">[**IWinHttpRequest**](iwinhttprequest-interface.md) COM 物件不支援這項功能。</span><span class="sxs-lookup"><span data-stu-id="898b9-109">This feature is not supported on the [**IWinHttpRequest**](iwinhttprequest-interface.md) COM object.</span></span>

## <a name="transfer-encoding-header"></a><span data-ttu-id="898b9-110">Transfer-Encoding 標頭</span><span class="sxs-lookup"><span data-stu-id="898b9-110">Transfer-Encoding Header</span></span>

<span data-ttu-id="898b9-111">Transfer-Encoding 標頭可讓應用程式將區塊資料傳送至伺服器。</span><span class="sxs-lookup"><span data-stu-id="898b9-111">The Transfer-Encoding header enables applications to send chunked data to the server.</span></span> <span data-ttu-id="898b9-112">當要求中有 Transfer-Encoding 標頭時，應用程式會在呼叫 [**WinHttpSendRequest**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpsendrequest)時，將長度為零的實體主體傳送給要求。</span><span class="sxs-lookup"><span data-stu-id="898b9-112">When the Transfer-Encoding header is present on the request, the application sends the request with a zero length entity body in the call to [**WinHttpSendRequest**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpsendrequest).</span></span> <span data-ttu-id="898b9-113">實體主體會在後續的 [**WinHttpWriteData**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpwritedata)呼叫中傳送。</span><span class="sxs-lookup"><span data-stu-id="898b9-113">The entity body is sent in subsequent calls to [**WinHttpWriteData**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpwritedata).</span></span> <span data-ttu-id="898b9-114">[**IWinHttpRequest**](iwinhttprequest-interface.md) COM 物件不支援這項功能。</span><span class="sxs-lookup"><span data-stu-id="898b9-114">This feature is not supported on the [**IWinHttpRequest**](iwinhttprequest-interface.md) COM object.</span></span>

## <a name="ssl-client-certificate-issuer-list-retrieval"></a><span data-ttu-id="898b9-115">SSL 用戶端憑證簽發者清單抓取</span><span class="sxs-lookup"><span data-stu-id="898b9-115">SSL Client Certificate Issuer List Retrieval</span></span>

<span data-ttu-id="898b9-116">應用程式可以在 [**WinHttpSendRequest**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpsendrequest) 失敗時取得 SSL 用戶端憑證簽發者清單，且 **需要錯誤的 \_ WINHTTP \_ 用戶端 \_ 驗證 \_ \_** 憑證。</span><span class="sxs-lookup"><span data-stu-id="898b9-116">The application can retrieve the SSL client certificate Issuer List when [**WinHttpSendRequest**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpsendrequest) fails with an **ERROR\_WINHTTP\_CLIENT\_AUTH\_CERT\_NEEDED**.</span></span> <span data-ttu-id="898b9-117">**WINHTTP \_ 選項 \_ 用戶端憑證 \_ \_ 簽發者 \_ 清單** 是新的選項，可讓應用程式取出憑證簽發者清單，並篩選清單以取得最佳憑證。</span><span class="sxs-lookup"><span data-stu-id="898b9-117">A new option, **WINHTTP\_OPTION\_CLIENT\_CERT\_ISSUER\_LIST**, allows applications to retrieve the certificate Issuer List and filter the list for the optimal certificate.</span></span> <span data-ttu-id="898b9-118">如需詳細資訊，請參閱「 [SSL 用戶端驗證](ssl-in-winhttp.md)的 [**選項旗標**](option-flags.md)和簽發者清單抓取」主題。</span><span class="sxs-lookup"><span data-stu-id="898b9-118">For more information, see the [**Option Flags**](option-flags.md) and [Issuer List Retrieval for SSL Client Authentication](ssl-in-winhttp.md) topics.</span></span> <span data-ttu-id="898b9-119">[**IWinHttpRequest**](iwinhttprequest-interface.md) COM 物件不支援這項功能。</span><span class="sxs-lookup"><span data-stu-id="898b9-119">This feature is not supported on the [**IWinHttpRequest**](iwinhttprequest-interface.md) COM object.</span></span>

## <a name="optional-client-certificates"></a><span data-ttu-id="898b9-120">選用用戶端憑證</span><span class="sxs-lookup"><span data-stu-id="898b9-120">Optional Client Certificates</span></span>

<span data-ttu-id="898b9-121">當 [**WinHttpSendRequest**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpsendrequest) 失敗並出現 **錯誤， \_ WINHTTP \_ 用戶端 \_ 驗證憑證 \_ \_ 需要** 時，伺服器可能不需要 SSL 用戶端憑證。</span><span class="sxs-lookup"><span data-stu-id="898b9-121">When [**WinHttpSendRequest**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpsendrequest) fails with an **ERROR\_WINHTTP\_CLIENT\_AUTH\_CERT\_NEEDED**, the server may not require the SSL client certificate.</span></span> <span data-ttu-id="898b9-122">伺服器可以還原成另一種形式的驗證，或允許用戶端繼續進行匿名存取。</span><span class="sxs-lookup"><span data-stu-id="898b9-122">The server may be able to revert to another form of authentication, or allow the client to proceed with anonymous access.</span></span> <span data-ttu-id="898b9-123">應用程式會設定 **winHTTP \_ 選項 [ \_ 用戶端憑證 \_ \_ 內容** ] 選項，並指定 winHTTP 用來判斷是否需要用戶端憑證的宏。</span><span class="sxs-lookup"><span data-stu-id="898b9-123">The application sets the **WINHTTP\_OPTION\_CLIENT\_CERT\_CONTEXT** option and specifies a macro that WinHttp uses to determine if the client certificate is required.</span></span> <span data-ttu-id="898b9-124">如需詳細資訊，請參閱 [**選項旗標**](option-flags.md)。</span><span class="sxs-lookup"><span data-stu-id="898b9-124">For more information, see [**Option Flags**](option-flags.md).</span></span> <span data-ttu-id="898b9-125">[**IWinHttpRequest**](iwinhttprequest-interface.md) COM 物件不支援這項功能。</span><span class="sxs-lookup"><span data-stu-id="898b9-125">This feature is not supported on the [**IWinHttpRequest**](iwinhttprequest-interface.md) COM object.</span></span>

## <a name="source-and-destination-ip-addresses"></a><span data-ttu-id="898b9-126">來源和目的地 IP 位址</span><span class="sxs-lookup"><span data-stu-id="898b9-126">Source and Destination IP Addresses</span></span>

<span data-ttu-id="898b9-127">當 [**WinHttpReceiveResponse**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpreceiveresponse) 完成時，應用程式可以取出產生回應之要求的來源和目的地 IP 位址和埠。</span><span class="sxs-lookup"><span data-stu-id="898b9-127">When [**WinHttpReceiveResponse**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpreceiveresponse) completes, the application can retrieve the source and destination IP address and port of the request that generated the response.</span></span> <span data-ttu-id="898b9-128">當設定 **WINHTTP \_ 選項 \_ 連接 \_ 資訊** 選項時，會提供新的結構來接收來源和目的地位址。</span><span class="sxs-lookup"><span data-stu-id="898b9-128">A new structure is provided to receive the source and destination addresses when the **WINHTTP\_OPTION\_CONNECTION\_INFO** option is set.</span></span> <span data-ttu-id="898b9-129">如需詳細資訊，請參閱 [**選項旗標**](option-flags.md)。</span><span class="sxs-lookup"><span data-stu-id="898b9-129">For more information, see [**Option Flags**](option-flags.md).</span></span> <span data-ttu-id="898b9-130">[**IWinHttpRequest**](iwinhttprequest-interface.md) COM 物件不支援這項功能。</span><span class="sxs-lookup"><span data-stu-id="898b9-130">This feature is not supported on the [**IWinHttpRequest**](iwinhttprequest-interface.md) COM object.</span></span>

## <a name="additional-ssl-client-authentication-errors"></a><span data-ttu-id="898b9-131">其他 SSL 用戶端驗證錯誤</span><span class="sxs-lookup"><span data-stu-id="898b9-131">Additional SSL Client Authentication Errors</span></span>

<span data-ttu-id="898b9-132">額外的 SSL 用戶端驗證錯誤會提供 SSL 用戶端憑證的詳細資訊。</span><span class="sxs-lookup"><span data-stu-id="898b9-132">Additional SSL client authentication errors provide more information about the SSL Client certificate.</span></span> <span data-ttu-id="898b9-133">**錯誤 \_WINHTTP \_ 用戶端憑證 \_ \_ 沒有 \_ 私密金鑰 \_** 和 **錯誤 \_ WINHTTP \_ 憑證 \_ 沒有 \_ 存取 \_ 私密金鑰 \_** 用戶端憑證錯誤是 windows Server 2008 和 windows Vista 的新錯誤。</span><span class="sxs-lookup"><span data-stu-id="898b9-133">**ERROR\_WINHTTP\_CLIENT\_CERT\_NO\_PRIVATE\_KEY** and **ERROR\_WINHTTP\_CERT\_NO\_ACCESS\_PRIVATE\_KEY** client certificate errors are new for Windows Server 2008 and Windows Vista.</span></span> <span data-ttu-id="898b9-134">[**IWinHttpRequest**](iwinhttprequest-interface.md) COM 物件會以 HRESULT 傳回這些錯誤。</span><span class="sxs-lookup"><span data-stu-id="898b9-134">The [**IWinHttpRequest**](iwinhttprequest-interface.md) COM object returns these errors in an HRESULT.</span></span>

 

 



