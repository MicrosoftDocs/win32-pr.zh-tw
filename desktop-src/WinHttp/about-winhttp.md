---
description: Microsoft Windows HTTP Services (WinHTTP) 提供伺服器支援的高階介面給 HTTP/2 和1.1 的網際網路通訊協定。
ms.assetid: 8337f699-3ec0-4397-acc2-6dc813f7542d
title: 關於 WinHTTP
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 150c829410a1601a3ede7f115f4594276af7fead
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/08/2021
ms.locfileid: "107000145"
---
# <a name="about-winhttp"></a><span data-ttu-id="6fa82-103">關於 WinHTTP</span><span class="sxs-lookup"><span data-stu-id="6fa82-103">About WinHTTP</span></span>

> [!NOTE]
> <span data-ttu-id="6fa82-104">針對應用程式容器和系統服務，自 Windows 10，版本1709，HTTP/2 (請參閱 [RFC7540](https://tools.ietf.org/html/rfc7540)) 預設為開啟。</span><span class="sxs-lookup"><span data-stu-id="6fa82-104">For app containers and system services since Windows 10, version 1709, HTTP/2 (see [RFC7540](https://tools.ietf.org/html/rfc7540)) is on by default.</span></span>

<span data-ttu-id="6fa82-105">Microsoft Windows HTTP Services (WinHTTP) 提供伺服器支援的高階介面給 HTTP/2 和1.1 的網際網路通訊協定。</span><span class="sxs-lookup"><span data-stu-id="6fa82-105">Microsoft Windows HTTP Services (WinHTTP) provides you with a server-supported, high-level interface to the HTTP/2 and 1.1 Internet protocols.</span></span> <span data-ttu-id="6fa82-106">在與 HTTP 伺服器通訊的伺服器應用程式中，WinHTTP 的設計主要是用於以伺服器為基礎的案例中。</span><span class="sxs-lookup"><span data-stu-id="6fa82-106">WinHTTP is designed to be used primarily in server-based scenarios by server applications that communicate with HTTP servers.</span></span>

<span data-ttu-id="6fa82-107">[WinINet](/windows/desktop/WinInet/portal) 是設計為互動式桌面應用程式的 HTTP 用戶端平臺。</span><span class="sxs-lookup"><span data-stu-id="6fa82-107">[WinINet](/windows/desktop/WinInet/portal) was designed as an HTTP client platform for interactive desktop applications.</span></span> <span data-ttu-id="6fa82-108">WinINet 會顯示某些作業的使用者介面，例如收集使用者認證。</span><span class="sxs-lookup"><span data-stu-id="6fa82-108">WinINet displays a user interface for some operations such as collecting user credentials.</span></span> <span data-ttu-id="6fa82-109">但是，WinHTTP 會以程式設計的方式處理這些作業。</span><span class="sxs-lookup"><span data-stu-id="6fa82-109">WinHTTP, however, handles these operations programmatically.</span></span> <span data-ttu-id="6fa82-110">需要 HTTP 用戶端服務的伺服器應用程式應該使用 WinHTTP 而非 WinINet。</span><span class="sxs-lookup"><span data-stu-id="6fa82-110">Server applications that require HTTP client services should use WinHTTP instead of WinINet.</span></span> <span data-ttu-id="6fa82-111">如需詳細資訊，請參閱 [將 WinINet 應用程式移植到 WinHTTP](porting-wininet-applications-to-winhttp.md)。</span><span class="sxs-lookup"><span data-stu-id="6fa82-111">For more information, see [Porting WinINet Applications to WinHTTP](porting-wininet-applications-to-winhttp.md).</span></span>

<span data-ttu-id="6fa82-112">WinHTTP 也設計成用於系統服務和 HTTP 型用戶端應用程式。</span><span class="sxs-lookup"><span data-stu-id="6fa82-112">WinHTTP is also designed for use in system services and HTTP-based client applications.</span></span> <span data-ttu-id="6fa82-113">不過，需要 FTP 通訊協定功能、cookie 持續性、快取、自動認證對話處理、Internet Explorer 相容性或舊版平臺支援的單一使用者應用程式，應該考慮使用 [WinINet](/windows/desktop/WinInet/portal)。</span><span class="sxs-lookup"><span data-stu-id="6fa82-113">However, single-user applications that require FTP protocol functionality, cookie persistence, caching, automatic credential dialog handling, Internet Explorer compatibility, or downlevel platform support should consider using [WinINet](/windows/desktop/WinInet/portal).</span></span>

<span data-ttu-id="6fa82-114">您可以使用 (API) 的 WinHTTP 應用程式設計介面，或使用 [**IWinHttpRequest**](iwinhttprequest-interface.md) 和 [**IWinHttpRequestEvents**](iwinhttprequestevents-interface.md) 介面，從 C/c + + 存取這個介面。</span><span class="sxs-lookup"><span data-stu-id="6fa82-114">This interface is accessible from C/C++ by using either the WinHTTP application programming interface (API), or by using the [**IWinHttpRequest**](iwinhttprequest-interface.md) and [**IWinHttpRequestEvents**](iwinhttprequestevents-interface.md) interfaces.</span></span> <span data-ttu-id="6fa82-115">WinHTTP 也可從腳本和 Microsoft Visual Basic 透過 WinHTTP 物件來存取。</span><span class="sxs-lookup"><span data-stu-id="6fa82-115">WinHTTP is also accessible from script and Microsoft Visual Basic through the WinHTTP object.</span></span> <span data-ttu-id="6fa82-116">如需個別函式的詳細資訊和描述，請參閱適用于特定語言的 WinHTTP 函數參考。</span><span class="sxs-lookup"><span data-stu-id="6fa82-116">For more information and descriptions of the individual functions, see the WinHTTP functions reference for the specific language.</span></span>

<span data-ttu-id="6fa82-117">從 Windows 8 開始，WinHTTP 提供 Api 來啟用使用 [WebSocket 通訊協定](https://tools.ietf.org/html/rfc6455)l 的連接，例如 [**WinHttpWebSocketSend**](/windows/desktop/api/winhttp/nf-winhttp-winhttpwebsocketsend) 和 [**WinHttpWebSocketReceive**](/windows/desktop/api/winhttp/nf-winhttp-winhttpwebsocketreceive)。</span><span class="sxs-lookup"><span data-stu-id="6fa82-117">Starting with Windows 8, WinHTTP provides APIs to enable connections using the [WebSocket Protocol](https://tools.ietf.org/html/rfc6455)l, such as [**WinHttpWebSocketSend**](/windows/desktop/api/winhttp/nf-winhttp-winhttpwebsocketsend) and [**WinHttpWebSocketReceive**](/windows/desktop/api/winhttp/nf-winhttp-winhttpwebsocketreceive).</span></span>

> [!Caution]  
> <span data-ttu-id="6fa82-118">除非在非同步完成回呼期間，否則 WinHTTP 不可重新進入。</span><span class="sxs-lookup"><span data-stu-id="6fa82-118">WinHTTP is not reentrant except during asynchronous completion callback.</span></span> <span data-ttu-id="6fa82-119">也就是說，當執行緒呼叫其中一個 WinHTTP 函式（例如 WinHttpSendRequest、WinHttpReceiveResponse、WinHttpQueryDataAvailable、WinHttpSendData 或 WinHttpWriteData）時，它永遠不會在第一次呼叫完成之前，第二次呼叫 WinHTTP。</span><span class="sxs-lookup"><span data-stu-id="6fa82-119">That is, while a thread has a call pending to one of the WinHTTP functions such as WinHttpSendRequest, WinHttpReceiveResponse, WinHttpQueryDataAvailable, WinHttpSendData, or WinHttpWriteData, it must never call WinHTTP a second time until the first call has completed.</span></span> <span data-ttu-id="6fa82-120">發生第二次呼叫的其中一個案例如下：如果應用程式將非同步程序呼叫排入佇列， (APC) 至呼叫 WinHTTP 的執行緒，而且如果 WinHTTP 在內部執行可提供警示等候，則可以執行 APC。</span><span class="sxs-lookup"><span data-stu-id="6fa82-120">One scenario under which a second call could occur is as follows: If an application queues an Asynchronous Procedure Call (APC) to the thread that calls into WinHTTP, and if WinHTTP performs an alertable wait internally, the APC can run.</span></span> <span data-ttu-id="6fa82-121">如果 APC 常式也會呼叫 WinHTTP，它會重新進入 WinHTTP API，而 WinHTTP 的內部狀態可能會損毀。</span><span class="sxs-lookup"><span data-stu-id="6fa82-121">If the APC routine happens also to call WinHTTP, it reenters the WinHTTP API, and the internal state of WinHTTP can be corrupted.</span></span>

## <a name="winhttp-51-features"></a><span data-ttu-id="6fa82-122">WinHTTP 5.1 功能</span><span class="sxs-lookup"><span data-stu-id="6fa82-122">WinHTTP 5.1 Features</span></span>

<span data-ttu-id="6fa82-123">下列功能已新增至5.1 版的 WinHTTP：</span><span class="sxs-lookup"><span data-stu-id="6fa82-123">The following features were added in version 5.1 of WinHTTP:</span></span>

-   <span data-ttu-id="6fa82-124">IPv6 支援。</span><span class="sxs-lookup"><span data-stu-id="6fa82-124">IPv6 support.</span></span>
-   <span data-ttu-id="6fa82-125">自動代理功能。</span><span class="sxs-lookup"><span data-stu-id="6fa82-125">AutoProxy capabilities.</span></span>
-   <span data-ttu-id="6fa82-126">HTTP/1.0 通訊協定，包括支援 keep-alive (持續性) 連線和會話 cookie。</span><span class="sxs-lookup"><span data-stu-id="6fa82-126">HTTP/1.0 protocol, including support for keep-alive (persistent) connections and session cookies.</span></span>
-   <span data-ttu-id="6fa82-127">Http/1.1 區塊傳輸支援 HTTP 回應。</span><span class="sxs-lookup"><span data-stu-id="6fa82-127">HTTP/1.1 chunked transfer support for HTTP responses.</span></span>
-   <span data-ttu-id="6fa82-128">在會話之間保持匿名連接的保持運作狀態。</span><span class="sxs-lookup"><span data-stu-id="6fa82-128">Keep-alive pooling of anonymous connections across sessions.</span></span>
-   <span data-ttu-id="6fa82-129">安全通訊端層 (SSL) 功能，包括用戶端憑證。</span><span class="sxs-lookup"><span data-stu-id="6fa82-129">Secure Sockets Layer (SSL) functionality, including client certificates.</span></span> <span data-ttu-id="6fa82-130">支援的 SSL 通訊協定包括下列各項： SSL 2.0、SSL 3.0 和傳輸層安全性 (TLS) 1.0。</span><span class="sxs-lookup"><span data-stu-id="6fa82-130">Supported SSL protocols include the following: SSL 2.0, SSL 3.0, and Transport Layer Security (TLS) 1.0.</span></span>
-   <span data-ttu-id="6fa82-131">支援伺服器和 proxy 驗證，包括 Microsoft Passport 1.4 與 Negotiate/ [Kerberos](../com/kerberos-v5-protocol.md) 封裝的整合式支援。</span><span class="sxs-lookup"><span data-stu-id="6fa82-131">Support for server and proxy authentication, including integrated support for Microsoft Passport 1.4 and the Negotiate/ [Kerberos](../com/kerberos-v5-protocol.md) package.</span></span>
-   <span data-ttu-id="6fa82-132">除非隱藏，否則重新導向的自動處理。</span><span class="sxs-lookup"><span data-stu-id="6fa82-132">Automatic handling of redirects unless suppressed.</span></span>
-   <span data-ttu-id="6fa82-133">可編寫腳本的介面，以及 API。</span><span class="sxs-lookup"><span data-stu-id="6fa82-133">Scriptable interface in addition to the API.</span></span>
-   <span data-ttu-id="6fa82-134">有助於疑難排解問題的追蹤公用程式。</span><span class="sxs-lookup"><span data-stu-id="6fa82-134">Trace utility to help troubleshoot problems.</span></span>

<span data-ttu-id="6fa82-135">WinHTTP 中不支援許多 [WinINet](/windows/desktop/WinInet/portal) 功能，包括 URL 快取和持續性 cookie、自動代理程式、autodialing、離線支援，以及檔案傳輸通訊協定 (FTP) 。</span><span class="sxs-lookup"><span data-stu-id="6fa82-135">A number of [WinINet](/windows/desktop/WinInet/portal) features are not supported in WinHTTP, including URL caching and persistent cookies, autoproxy, autodialing, offline support, and File Transfer Protocol (FTP).</span></span>

<span data-ttu-id="6fa82-136">如需5.1 版中所引進之變更的詳細資訊，請參閱 [WinHTTP 5.1 中的新功能](what-s-new-in-winhttp-5-1.md)。</span><span class="sxs-lookup"><span data-stu-id="6fa82-136">For more information about changes introduced in version 5.1, see [What's New in WinHTTP 5.1](what-s-new-in-winhttp-5-1.md).</span></span>

## <a name="getting-started-with-winhttp"></a><span data-ttu-id="6fa82-137">使用 WinHTTP 開始使用</span><span class="sxs-lookup"><span data-stu-id="6fa82-137">Getting Started with WinHTTP</span></span>

<span data-ttu-id="6fa82-138">如需 WinHTTP 的詳細資訊，請參閱下列主題。</span><span class="sxs-lookup"><span data-stu-id="6fa82-138">For more information about WinHTTP, see the following topics.</span></span>

* <span data-ttu-id="6fa82-139">[WinINet 與 WinHTTP](/windows/desktop/wininet/wininet-vs-winhttp) 比較兩種用來存取 HTTP 的技術。</span><span class="sxs-lookup"><span data-stu-id="6fa82-139">[WinINet vs. WinHTTP](/windows/desktop/wininet/wininet-vs-winhttp) compares the two technologies for accessing HTTP.</span></span>
* <span data-ttu-id="6fa82-140">[WinHTTP 版本](winhttp-versions.md) 說明 winHTTP 的版本歷程記錄。</span><span class="sxs-lookup"><span data-stu-id="6fa82-140">[WinHTTP Versions](winhttp-versions.md) describes the version history of WinHTTP.</span></span>
* <span data-ttu-id="6fa82-141">[WinHTTP 5.1 的新](what-s-new-in-winhttp-5-1.md) 功能說明 winHTTP 5.1 中的變更和新功能。</span><span class="sxs-lookup"><span data-stu-id="6fa82-141">[What's New in WinHTTP 5.1](what-s-new-in-winhttp-5-1.md) describes changes and new features in WinHTTP 5.1.</span></span>
* <span data-ttu-id="6fa82-142">[網路術語](network-terminology.md) 描述一般與網路功能相關的實用概念和術語，尤其是 HTTP 通訊協定。</span><span class="sxs-lookup"><span data-stu-id="6fa82-142">[Network Terminology](network-terminology.md) describes useful concepts and terminology relating to networking in general and the HTTP protocol in particular.</span></span>
* <span data-ttu-id="6fa82-143">[選擇 WinHTTP 介面](choosing-a-winhttp-interface.md) 會描述適用于 WinHTTP 的 C/c + + API 和 COM 介面。</span><span class="sxs-lookup"><span data-stu-id="6fa82-143">[Choosing a WinHTTP Interface](choosing-a-winhttp-interface.md) describes the C/C++ API and the COM interface for WinHTTP.</span></span>
* <span data-ttu-id="6fa82-144">[WinHTTP 安全性考慮](winhttp-security-considerations.md) 說明使用 winHTTP 時要注意的安全性問題。</span><span class="sxs-lookup"><span data-stu-id="6fa82-144">[WinHTTP Security Considerations](winhttp-security-considerations.md) describes security issues to be aware of when using WinHTTP.</span></span>
* <span data-ttu-id="6fa82-145">[將 WinINet 應用程式移植到 winHTTP](porting-wininet-applications-to-winhttp.md) ，說明如何修改現有的 [WinINet](/windows/desktop/WinInet/portal) 應用程式以使用 WinHTTP API。</span><span class="sxs-lookup"><span data-stu-id="6fa82-145">[Porting WinINet Applications to WinHTTP](porting-wininet-applications-to-winhttp.md) describes how to modify your existing [WinINet](/windows/desktop/WinInet/portal) applications to use the WinHTTP API.</span></span>
