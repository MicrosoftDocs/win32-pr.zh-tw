---
description: 本節說明訊息和訊息佇列，以及如何在您的應用程式中使用它們。
ms.assetid: vs|winui|~\winui\windowsuserinterface\windowing\messagesandmessagequeues.htm
title: 訊息和訊息佇列
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: d0233af932d1aa9a4130e244af002d6180fdf055
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/08/2021
ms.locfileid: "106985456"
---
# <a name="messages-and-message-queues"></a><span data-ttu-id="2b549-103">訊息和訊息佇列</span><span class="sxs-lookup"><span data-stu-id="2b549-103">Messages and Message Queues</span></span>

<span data-ttu-id="2b549-104">本節說明訊息和訊息佇列，以及如何在您的應用程式中使用它們。</span><span class="sxs-lookup"><span data-stu-id="2b549-104">This section describes messages and message queues and how to use them in your applications.</span></span>

### <a name="in-this-section"></a><span data-ttu-id="2b549-105">本節內容</span><span class="sxs-lookup"><span data-stu-id="2b549-105">In This Section</span></span>



| <span data-ttu-id="2b549-106">Name</span><span class="sxs-lookup"><span data-stu-id="2b549-106">Name</span></span>                                                                       | <span data-ttu-id="2b549-107">描述</span><span class="sxs-lookup"><span data-stu-id="2b549-107">Description</span></span>                                                                                                                                |
|----------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="2b549-108">關於訊息和訊息佇列</span><span class="sxs-lookup"><span data-stu-id="2b549-108">About Messages and Message Queues</span></span>](about-messages-and-message-queues.md) | <span data-ttu-id="2b549-109">本節討論 Windows 訊息和訊息佇列。</span><span class="sxs-lookup"><span data-stu-id="2b549-109">This section discusses Windows messages and message queues.</span></span><br/>                                                                     |
| [<span data-ttu-id="2b549-110">使用訊息和訊息佇列</span><span class="sxs-lookup"><span data-stu-id="2b549-110">Using Messages and Message Queues</span></span>](using-messages-and-message-queues.md) | <span data-ttu-id="2b549-111">下列程式碼範例示範如何執行與 Windows 訊息和訊息佇列相關聯的下列工作。</span><span class="sxs-lookup"><span data-stu-id="2b549-111">The following code examples demonstrate how to perform the following tasks associated with Windows messages and message queues.</span></span><br/> |
| [<span data-ttu-id="2b549-112">訊息參考</span><span class="sxs-lookup"><span data-stu-id="2b549-112">Message Reference</span></span>](message-and-message-queue-reference.md)               | <span data-ttu-id="2b549-113">包含 API 參考。</span><span class="sxs-lookup"><span data-stu-id="2b549-113">Contains the API reference.</span></span><br/>                                                                                                     |



 

### <a name="system-provided-messages"></a><span data-ttu-id="2b549-114">System-Provided 訊息</span><span class="sxs-lookup"><span data-stu-id="2b549-114">System-Provided Messages</span></span>

<span data-ttu-id="2b549-115">如需系統提供之訊息的清單，請參閱 [系統定義的訊息](about-messages-and-message-queues.md)。</span><span class="sxs-lookup"><span data-stu-id="2b549-115">For lists of the system-provided messages, see [System-Defined Messages](about-messages-and-message-queues.md).</span></span>

### <a name="message-functions"></a><span data-ttu-id="2b549-116">訊息函數</span><span class="sxs-lookup"><span data-stu-id="2b549-116">Message Functions</span></span>



| <span data-ttu-id="2b549-117">Name</span><span class="sxs-lookup"><span data-stu-id="2b549-117">Name</span></span>                                                         | <span data-ttu-id="2b549-118">描述</span><span class="sxs-lookup"><span data-stu-id="2b549-118">Description</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|--------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="2b549-119">**BroadcastSystemMessage**</span><span class="sxs-lookup"><span data-stu-id="2b549-119">**BroadcastSystemMessage**</span></span>](/windows/win32/api/winuser/nf-winuser-broadcastsystemmessage)     | <span data-ttu-id="2b549-120">將訊息傳送給指定的收件者。</span><span class="sxs-lookup"><span data-stu-id="2b549-120">Sends a message to the specified recipients.</span></span> <span data-ttu-id="2b549-121">收件者可以是應用程式、可安裝的驅動程式、網路驅動程式、系統層級的設備磁碟機，或這些系統元件的任何組合。</span><span class="sxs-lookup"><span data-stu-id="2b549-121">The recipients can be applications, installable drivers, network drivers, system-level device drivers, or any combination of these system components.</span></span> <br/> <span data-ttu-id="2b549-122">若要在定義要求時接收其他資訊，請使用 [**BroadcastSystemMessageEx**](/windows/win32/api/winuser/nf-winuser-broadcastsystemmessageexa) 函數。</span><span class="sxs-lookup"><span data-stu-id="2b549-122">To receive additional information if the request is defined, use the [**BroadcastSystemMessageEx**](/windows/win32/api/winuser/nf-winuser-broadcastsystemmessageexa) function.</span></span><br/>                                                                                                                                                                                                                                  |
| [<span data-ttu-id="2b549-123">**BroadcastSystemMessageEx**</span><span class="sxs-lookup"><span data-stu-id="2b549-123">**BroadcastSystemMessageEx**</span></span>](/windows/win32/api/winuser/nf-winuser-broadcastsystemmessageexa) | <span data-ttu-id="2b549-124">將訊息傳送給指定的收件者。</span><span class="sxs-lookup"><span data-stu-id="2b549-124">Sends a message to the specified recipients.</span></span> <span data-ttu-id="2b549-125">收件者可以是應用程式、可安裝的驅動程式、網路驅動程式、系統層級的設備磁碟機，或這些系統元件的任何組合。</span><span class="sxs-lookup"><span data-stu-id="2b549-125">The recipients can be applications, installable drivers, network drivers, system-level device drivers, or any combination of these system components.</span></span> <br/> <span data-ttu-id="2b549-126">此函式類似于 [**BroadcastSystemMessage**](/windows/win32/api/winuser/nf-winuser-broadcastsystemmessage) ，不過這個函式可以從收件者傳回更多資訊。</span><span class="sxs-lookup"><span data-stu-id="2b549-126">This function is similar to [**BroadcastSystemMessage**](/windows/win32/api/winuser/nf-winuser-broadcastsystemmessage) except that this function can return more information from the recipients.</span></span><br/>                                                                                                                                                                                                              |
| [<span data-ttu-id="2b549-127">**DispatchMessage**</span><span class="sxs-lookup"><span data-stu-id="2b549-127">**DispatchMessage**</span></span>](/windows/win32/api/winuser/nf-winuser-dispatchmessage)                   | <span data-ttu-id="2b549-128">將訊息分派至視窗程式。</span><span class="sxs-lookup"><span data-stu-id="2b549-128">Dispatches a message to a window procedure.</span></span> <span data-ttu-id="2b549-129">它通常用來分派 [**GetMessage**](/windows/win32/api/winuser/nf-winuser-getmessage) 函式所取出的訊息。</span><span class="sxs-lookup"><span data-stu-id="2b549-129">It is typically used to dispatch a message retrieved by the [**GetMessage**](/windows/win32/api/winuser/nf-winuser-getmessage) function.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| [<span data-ttu-id="2b549-130">**GetInputState**</span><span class="sxs-lookup"><span data-stu-id="2b549-130">**GetInputState**</span></span>](/windows/win32/api/winuser/nf-winuser-getinputstate)                       | <span data-ttu-id="2b549-131">判斷呼叫執行緒的訊息佇列中是否有滑鼠按鍵或鍵盤訊息。</span><span class="sxs-lookup"><span data-stu-id="2b549-131">Determines whether there are mouse-button or keyboard messages in the calling thread's message queue.</span></span> <br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| [<span data-ttu-id="2b549-132">**GetMessage**</span><span class="sxs-lookup"><span data-stu-id="2b549-132">**GetMessage**</span></span>](/windows/win32/api/winuser/nf-winuser-getmessage)                             | <span data-ttu-id="2b549-133">從呼叫執行緒的訊息佇列抓取訊息。</span><span class="sxs-lookup"><span data-stu-id="2b549-133">Retrieves a message from the calling thread's message queue.</span></span> <span data-ttu-id="2b549-134">函數會分派傳入的傳送訊息，直到張貼的訊息可供抓取為止。</span><span class="sxs-lookup"><span data-stu-id="2b549-134">The function dispatches incoming sent messages until a posted message is available for retrieval.</span></span> <br/> <span data-ttu-id="2b549-135">不同于 [**GetMessage**](/windows/win32/api/winuser/nf-winuser-getmessage)， [**PeekMessage**](/windows/win32/api/winuser/nf-winuser-peekmessagea) 函式不會在傳回訊息之前等候訊息張貼。</span><span class="sxs-lookup"><span data-stu-id="2b549-135">Unlike [**GetMessage**](/windows/win32/api/winuser/nf-winuser-getmessage), the [**PeekMessage**](/windows/win32/api/winuser/nf-winuser-peekmessagea) function does not wait for a message to be posted before returning.</span></span><br/>                                                                                                                                                                                                                                                              |
| [<span data-ttu-id="2b549-136">**GetMessageExtraInfo**</span><span class="sxs-lookup"><span data-stu-id="2b549-136">**GetMessageExtraInfo**</span></span>](/windows/win32/api/winuser/nf-winuser-getmessageextrainfo)           | <span data-ttu-id="2b549-137">抓取目前線程的額外訊息資訊。</span><span class="sxs-lookup"><span data-stu-id="2b549-137">Retrieves the extra message information for the current thread.</span></span> <span data-ttu-id="2b549-138">額外的訊息資訊是與目前線程訊息佇列相關聯的應用程式或驅動程式定義值。</span><span class="sxs-lookup"><span data-stu-id="2b549-138">Extra message information is an application- or driver-defined value associated with the current thread's message queue.</span></span> <br/>                                                                                                                                                                                                                                                                                                                                                                                                   |
| [<span data-ttu-id="2b549-139">**GetMessagePos**</span><span class="sxs-lookup"><span data-stu-id="2b549-139">**GetMessagePos**</span></span>](/windows/win32/api/winuser/nf-winuser-getmessagepos)                       | <span data-ttu-id="2b549-140">抓取 [**GetMessage**](/windows/win32/api/winuser/nf-winuser-getmessage) 函數抓取之最後一個訊息的資料指標位置。</span><span class="sxs-lookup"><span data-stu-id="2b549-140">Retrieves the cursor position for the last message retrieved by the [**GetMessage**](/windows/win32/api/winuser/nf-winuser-getmessage) function.</span></span> <br/> <span data-ttu-id="2b549-141">若要判斷資料指標目前的位置，請使用 [**GetCursorPos**](/windows/desktop/api/winuser/nf-winuser-getcursorpos) 函數。</span><span class="sxs-lookup"><span data-stu-id="2b549-141">To determine the current position of the cursor, use the [**GetCursorPos**](/windows/desktop/api/winuser/nf-winuser-getcursorpos) function.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                       |
| [<span data-ttu-id="2b549-142">**GetMessageTime**</span><span class="sxs-lookup"><span data-stu-id="2b549-142">**GetMessageTime**</span></span>](/windows/win32/api/winuser/nf-winuser-getmessagetime)                     | <span data-ttu-id="2b549-143">抓取 [**GetMessage**](/windows/win32/api/winuser/nf-winuser-getmessage) 函式所抓取之最後一則訊息的訊息時間。</span><span class="sxs-lookup"><span data-stu-id="2b549-143">Retrieves the message time for the last message retrieved by the [**GetMessage**](/windows/win32/api/winuser/nf-winuser-getmessage) function.</span></span> <span data-ttu-id="2b549-144">時間是長整數，指定從系統開始到建立訊息的時間（以毫秒為單位）， (也就是放線上程的訊息佇列) 。</span><span class="sxs-lookup"><span data-stu-id="2b549-144">The time is a long integer that specifies the elapsed time, in milliseconds, from the time the system was started to the time the message was created (that is, placed in the thread's message queue).</span></span> <br/>                                                                                                                                                                                                                                                                         |
| [<span data-ttu-id="2b549-145">**GetQueueStatus**</span><span class="sxs-lookup"><span data-stu-id="2b549-145">**GetQueueStatus**</span></span>](/windows/win32/api/winuser/nf-winuser-getqueuestatus)                     | <span data-ttu-id="2b549-146">表示在呼叫執行緒訊息佇列中找到的訊息類型。</span><span class="sxs-lookup"><span data-stu-id="2b549-146">Indicates the type of messages found in the calling thread's message queue.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| [<span data-ttu-id="2b549-147">**InSendMessage**</span><span class="sxs-lookup"><span data-stu-id="2b549-147">**InSendMessage**</span></span>](/windows/win32/api/winuser/nf-winuser-insendmessage)                       | <span data-ttu-id="2b549-148">判斷目前的視窗程式是否正在處理從另一個執行緒 (在相同進程中傳送的訊息，或呼叫 [**SendMessage**](/windows/win32/api/winuser/nf-winuser-sendmessage) 函數) 的不同進程。</span><span class="sxs-lookup"><span data-stu-id="2b549-148">Determines whether the current window procedure is processing a message that was sent from another thread (in the same process or a different process) by a call to the [**SendMessage**](/windows/win32/api/winuser/nf-winuser-sendmessage) function.</span></span> <br/> <span data-ttu-id="2b549-149">若要取得有關如何傳送訊息的其他資訊，請使用 [**InSendMessageEx**](/windows/win32/api/winuser/nf-winuser-insendmessageex) 函數。</span><span class="sxs-lookup"><span data-stu-id="2b549-149">To obtain additional information about how the message was sent, use the [**InSendMessageEx**](/windows/win32/api/winuser/nf-winuser-insendmessageex) function.</span></span><br/>                                                                                                                                                                                                                              |
| [<span data-ttu-id="2b549-150">**InSendMessageEx**</span><span class="sxs-lookup"><span data-stu-id="2b549-150">**InSendMessageEx**</span></span>](/windows/win32/api/winuser/nf-winuser-insendmessageex)                   | <span data-ttu-id="2b549-151">判斷目前的視窗程式是否正在處理從另一個執行緒 (在相同進程或不同進程) 中傳送的訊息。</span><span class="sxs-lookup"><span data-stu-id="2b549-151">Determines whether the current window procedure is processing a message that was sent from another thread (in the same process or a different process).</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| [<span data-ttu-id="2b549-152">**PeekMessage**</span><span class="sxs-lookup"><span data-stu-id="2b549-152">**PeekMessage**</span></span>](/windows/win32/api/winuser/nf-winuser-peekmessagea)                           | <span data-ttu-id="2b549-153">分派傳入的已傳送訊息、檢查已張貼訊息的執行緒訊息佇列，以及抓取訊息 (如果有任何) 存在的話。</span><span class="sxs-lookup"><span data-stu-id="2b549-153">Dispatches incoming sent messages, checks the thread message queue for a posted message, and retrieves the message (if any exist).</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| [<span data-ttu-id="2b549-154">**PostMessage**</span><span class="sxs-lookup"><span data-stu-id="2b549-154">**PostMessage**</span></span>](/windows/win32/api/winuser/nf-winuser-postmessagea)                           | <span data-ttu-id="2b549-155">將訊息張貼在與建立指定視窗的執行緒相關聯的訊息佇列中，並傳回，而不等候執行緒訊息。</span><span class="sxs-lookup"><span data-stu-id="2b549-155">Posts a message in the message queue associated with the thread that created the specified window and returns without waiting for the thread to process the message.</span></span> <br/> <span data-ttu-id="2b549-156">若要在與執行緒相關聯的訊息佇列中公佈訊息，請使用 [**PostThreadMessage**](/windows/win32/api/winuser/nf-winuser-postthreadmessagea) 函數。</span><span class="sxs-lookup"><span data-stu-id="2b549-156">To post a message in the message queue associated with a thread, use the [**PostThreadMessage**](/windows/win32/api/winuser/nf-winuser-postthreadmessagea) function.</span></span><br/>                                                                                                                                                                                                                                                                          |
| [<span data-ttu-id="2b549-157">**PostQuitMessage**</span><span class="sxs-lookup"><span data-stu-id="2b549-157">**PostQuitMessage**</span></span>](/windows/win32/api/winuser/nf-winuser-postquitmessage)                   | <span data-ttu-id="2b549-158">向系統表示執行緒已發出終止 (結束) 的要求。</span><span class="sxs-lookup"><span data-stu-id="2b549-158">Indicates to the system that a thread has made a request to terminate (quit).</span></span> <span data-ttu-id="2b549-159">它通常用於回應 [**WM \_**](wm-destroy.md) 終結訊息。</span><span class="sxs-lookup"><span data-stu-id="2b549-159">It is typically used in response to a [**WM\_DESTROY**](wm-destroy.md) message.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                              |
| [<span data-ttu-id="2b549-160">**PostThreadMessage**</span><span class="sxs-lookup"><span data-stu-id="2b549-160">**PostThreadMessage**</span></span>](/windows/win32/api/winuser/nf-winuser-postthreadmessagea)               | <span data-ttu-id="2b549-161">將訊息張貼到指定之執行緒的訊息佇列。</span><span class="sxs-lookup"><span data-stu-id="2b549-161">Posts a message to the message queue of the specified thread.</span></span> <span data-ttu-id="2b549-162">它會返回，而不會等候執行緒訊息。</span><span class="sxs-lookup"><span data-stu-id="2b549-162">It returns without waiting for the thread to process the message.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| [<span data-ttu-id="2b549-163">**RegisterWindowMessage**</span><span class="sxs-lookup"><span data-stu-id="2b549-163">**RegisterWindowMessage**</span></span>](/windows/win32/api/winuser/nf-winuser-registerwindowmessagea)       | <span data-ttu-id="2b549-164">定義在整個系統中保證是唯一的新視窗訊息。</span><span class="sxs-lookup"><span data-stu-id="2b549-164">Defines a new window message that is guaranteed to be unique throughout the system.</span></span> <span data-ttu-id="2b549-165">傳送或張貼訊息時，可以使用訊息值。</span><span class="sxs-lookup"><span data-stu-id="2b549-165">The message value can be used when sending or posting messages.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| [<span data-ttu-id="2b549-166">**ReplyMessage**</span><span class="sxs-lookup"><span data-stu-id="2b549-166">**ReplyMessage**</span></span>](/windows/win32/api/winuser/nf-winuser-replymessage)                         | <span data-ttu-id="2b549-167">回復透過 [**SendMessage**](/windows/win32/api/winuser/nf-winuser-sendmessage) 函式傳送的訊息，而不將控制權傳回給呼叫 **SendMessage** 的函式。</span><span class="sxs-lookup"><span data-stu-id="2b549-167">Replies to a message sent through the [**SendMessage**](/windows/win32/api/winuser/nf-winuser-sendmessage) function without returning control to the function that called **SendMessage**.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| [<span data-ttu-id="2b549-168">*SendAsyncProc*</span><span class="sxs-lookup"><span data-stu-id="2b549-168">*SendAsyncProc*</span></span>](/windows/win32/api/winuser/nc-winuser-sendasyncproc)                         | <span data-ttu-id="2b549-169">搭配 [**SendMessageCallback**](/windows/win32/api/winuser/nf-winuser-sendmessagecallbacka) 函式使用的應用程式定義回呼函數。</span><span class="sxs-lookup"><span data-stu-id="2b549-169">An application-defined callback function used with the [**SendMessageCallback**](/windows/win32/api/winuser/nf-winuser-sendmessagecallbacka) function.</span></span> <span data-ttu-id="2b549-170">系統將訊息傳遞至目的地視窗程式之後，系統會將訊息傳遞給回呼函式。</span><span class="sxs-lookup"><span data-stu-id="2b549-170">The system passes the message to the callback function after passing the message to the destination window procedure.</span></span> <span data-ttu-id="2b549-171">**SENDASYNCPROC** 型別定義此回呼函數的指標。</span><span class="sxs-lookup"><span data-stu-id="2b549-171">The **SENDASYNCPROC** type defines a pointer to this callback function.</span></span> <span data-ttu-id="2b549-172">[*SendAsyncProc*](/windows/win32/api/winuser/nc-winuser-sendasyncproc) 是應用程式定義函數名稱的預留位置。</span><span class="sxs-lookup"><span data-stu-id="2b549-172">[*SendAsyncProc*](/windows/win32/api/winuser/nc-winuser-sendasyncproc) is a placeholder for the application-defined function name.</span></span><br/>                                                                                                                                                                          |
| [<span data-ttu-id="2b549-173">**SendMessage**</span><span class="sxs-lookup"><span data-stu-id="2b549-173">**SendMessage**</span></span>](/windows/win32/api/winuser/nf-winuser-sendmessage)                           | <span data-ttu-id="2b549-174">將指定的訊息傳送至視窗或視窗。</span><span class="sxs-lookup"><span data-stu-id="2b549-174">Sends the specified message to a window or windows.</span></span> <span data-ttu-id="2b549-175">[**SendMessage**](/windows/win32/api/winuser/nf-winuser-sendmessage)函式會呼叫指定視窗的視窗程式，且在視窗程式處理訊息之前不會傳回。</span><span class="sxs-lookup"><span data-stu-id="2b549-175">The [**SendMessage**](/windows/win32/api/winuser/nf-winuser-sendmessage) function calls the window procedure for the specified window and does not return until the window procedure has processed the message.</span></span> <br/> <span data-ttu-id="2b549-176">若要傳送訊息並立即傳回，請使用 [**SendMessageCallback**](/windows/win32/api/winuser/nf-winuser-sendmessagecallbacka) 或 [**SendNotifyMessage**](/windows/win32/api/winuser/nf-winuser-sendnotifymessagea) 函數。</span><span class="sxs-lookup"><span data-stu-id="2b549-176">To send a message and return immediately, use the [**SendMessageCallback**](/windows/win32/api/winuser/nf-winuser-sendmessagecallbacka) or [**SendNotifyMessage**](/windows/win32/api/winuser/nf-winuser-sendnotifymessagea) function.</span></span> <span data-ttu-id="2b549-177">若要將訊息張貼至執行緒的訊息佇列並立即傳回，請使用 [**PostMessage**](/windows/win32/api/winuser/nf-winuser-postmessagea) 或 [**PostThreadMessage**](/windows/win32/api/winuser/nf-winuser-postthreadmessagea) 函數。</span><span class="sxs-lookup"><span data-stu-id="2b549-177">To post a message to a thread's message queue and return immediately, use the [**PostMessage**](/windows/win32/api/winuser/nf-winuser-postmessagea) or [**PostThreadMessage**](/windows/win32/api/winuser/nf-winuser-postthreadmessagea) function.</span></span><br/> |
| [<span data-ttu-id="2b549-178">**SendMessageCallback**</span><span class="sxs-lookup"><span data-stu-id="2b549-178">**SendMessageCallback**</span></span>](/windows/win32/api/winuser/nf-winuser-sendmessagecallbacka)           | <span data-ttu-id="2b549-179">將指定的訊息傳送至視窗或視窗。</span><span class="sxs-lookup"><span data-stu-id="2b549-179">Sends the specified message to a window or windows.</span></span> <span data-ttu-id="2b549-180">它會呼叫指定視窗的視窗程式，並立即傳回。</span><span class="sxs-lookup"><span data-stu-id="2b549-180">It calls the window procedure for the specified window and returns immediately.</span></span> <span data-ttu-id="2b549-181">在視窗程式處理訊息之後，系統會呼叫指定的回呼函式，並將訊息處理的結果和應用程式定義的值傳遞至回呼函式。</span><span class="sxs-lookup"><span data-stu-id="2b549-181">After the window procedure processes the message, the system calls the specified callback function, passing the result of the message processing and an application-defined value to the callback function.</span></span><br/>                                                                                                                                                                                                                                             |
| [<span data-ttu-id="2b549-182">**SendMessageTimeout**</span><span class="sxs-lookup"><span data-stu-id="2b549-182">**SendMessageTimeout**</span></span>](/windows/win32/api/winuser/nf-winuser-sendmessagetimeouta)             | <span data-ttu-id="2b549-183">將指定的訊息傳送到其中一個視窗。</span><span class="sxs-lookup"><span data-stu-id="2b549-183">Sends the specified message to one of more windows.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| [<span data-ttu-id="2b549-184">**SendNotifyMessage**</span><span class="sxs-lookup"><span data-stu-id="2b549-184">**SendNotifyMessage**</span></span>](/windows/win32/api/winuser/nf-winuser-sendnotifymessagea)               | <span data-ttu-id="2b549-185">將指定的訊息傳送至視窗或視窗。</span><span class="sxs-lookup"><span data-stu-id="2b549-185">Sends the specified message to a window or windows.</span></span> <span data-ttu-id="2b549-186">如果視窗是由呼叫執行緒所建立， [**SendNotifyMessage**](/windows/win32/api/winuser/nf-winuser-sendnotifymessagea) 會呼叫視窗的視窗程式，且在視窗程式處理訊息之前不會傳回。</span><span class="sxs-lookup"><span data-stu-id="2b549-186">If the window was created by the calling thread, [**SendNotifyMessage**](/windows/win32/api/winuser/nf-winuser-sendnotifymessagea) calls the window procedure for the window and does not return until the window procedure has processed the message.</span></span> <span data-ttu-id="2b549-187">如果視窗是由不同的執行緒所建立， **SendNotifyMessage** 會將訊息傳遞至視窗程式，並立即傳回。它不會等候視窗程式完成訊息的處理。</span><span class="sxs-lookup"><span data-stu-id="2b549-187">If the window was created by a different thread, **SendNotifyMessage** passes the message to the window procedure and returns immediately; it does not wait for the window procedure to finish processing the message.</span></span><br/>                                                                                              |
| [<span data-ttu-id="2b549-188">**SetMessageExtraInfo**</span><span class="sxs-lookup"><span data-stu-id="2b549-188">**SetMessageExtraInfo**</span></span>](/windows/win32/api/winuser/nf-winuser-setmessageextrainfo)           | <span data-ttu-id="2b549-189">設定目前線程的額外訊息資訊。</span><span class="sxs-lookup"><span data-stu-id="2b549-189">Sets the extra message information for the current thread.</span></span> <span data-ttu-id="2b549-190">額外的訊息資訊是與目前線程訊息佇列相關聯的應用程式或驅動程式定義值。</span><span class="sxs-lookup"><span data-stu-id="2b549-190">Extra message information is an application- or driver-defined value associated with the current thread's message queue.</span></span> <span data-ttu-id="2b549-191">應用程式可以使用 [**GetMessageExtraInfo**](/windows/win32/api/winuser/nf-winuser-getmessageextrainfo) 函式來取出執行緒的額外訊息資訊。</span><span class="sxs-lookup"><span data-stu-id="2b549-191">An application can use the [**GetMessageExtraInfo**](/windows/win32/api/winuser/nf-winuser-getmessageextrainfo) function to retrieve a thread's extra message information.</span></span><br/>                                                                                                                                                                                                                                                                |
| [<span data-ttu-id="2b549-192">**TranslateMessage**</span><span class="sxs-lookup"><span data-stu-id="2b549-192">**TranslateMessage**</span></span>](/windows/win32/api/winuser/nf-winuser-translatemessage)                 | <span data-ttu-id="2b549-193">將虛擬金鑰訊息轉譯為字元訊息。</span><span class="sxs-lookup"><span data-stu-id="2b549-193">Translates virtual-key messages into character messages.</span></span> <span data-ttu-id="2b549-194">系統會將字元訊息張貼至呼叫執行緒的訊息佇列，以在下次執行緒呼叫 [**GetMessage**](/windows/win32/api/winuser/nf-winuser-getmessage) 或 [**PeekMessage**](/windows/win32/api/winuser/nf-winuser-peekmessagea) 函數時讀取。</span><span class="sxs-lookup"><span data-stu-id="2b549-194">The character messages are posted to the calling thread's message queue, to be read the next time the thread calls the [**GetMessage**](/windows/win32/api/winuser/nf-winuser-getmessage) or [**PeekMessage**](/windows/win32/api/winuser/nf-winuser-peekmessagea) function.</span></span><br/>                                                                                                                                                                                                                                                                                                                            |
| [<span data-ttu-id="2b549-195">**WaitMessage**</span><span class="sxs-lookup"><span data-stu-id="2b549-195">**WaitMessage**</span></span>](/windows/win32/api/winuser/nf-winuser-waitmessage)                           | <span data-ttu-id="2b549-196">當執行緒在其訊息佇列中沒有其他訊息時，會將控制項產生給其他執行緒。</span><span class="sxs-lookup"><span data-stu-id="2b549-196">Yields control to other threads when a thread has no other messages in its message queue.</span></span> <span data-ttu-id="2b549-197">[**WaitMessage**](/windows/win32/api/winuser/nf-winuser-waitmessage)函式會暫停執行緒，並且在將新訊息放入執行緒的訊息佇列之前不會傳回。</span><span class="sxs-lookup"><span data-stu-id="2b549-197">The [**WaitMessage**](/windows/win32/api/winuser/nf-winuser-waitmessage) function suspends the thread and does not return until a new message is placed in the thread's message queue.</span></span><br/>                                                                                                                                                                                                                                                                                                                                              |



 

### <a name="message-constants"></a><span data-ttu-id="2b549-198">訊息常數</span><span class="sxs-lookup"><span data-stu-id="2b549-198">Message Constants</span></span>



| <span data-ttu-id="2b549-199">Name</span><span class="sxs-lookup"><span data-stu-id="2b549-199">Name</span></span>                             | <span data-ttu-id="2b549-200">描述</span><span class="sxs-lookup"><span data-stu-id="2b549-200">Description</span></span>                                                                    |
|----------------------------------|--------------------------------------------------------------------------------|
| [<span data-ttu-id="2b549-201">**OCM \_ \_ 基底**</span><span class="sxs-lookup"><span data-stu-id="2b549-201">**OCM\_\_BASE**</span></span>](ocm--base.md) | <span data-ttu-id="2b549-202">用來定義私用訊息供私用視窗類別使用。</span><span class="sxs-lookup"><span data-stu-id="2b549-202">Used to define private messages for use by private window classes.</span></span> <br/> |
| [<span data-ttu-id="2b549-203">**WM \_ 應用程式**</span><span class="sxs-lookup"><span data-stu-id="2b549-203">**WM\_APP**</span></span>](wm-app.md)        | <span data-ttu-id="2b549-204">用來定義私用訊息。</span><span class="sxs-lookup"><span data-stu-id="2b549-204">Used to define private messages.</span></span> <br/>                                   |
| [<span data-ttu-id="2b549-205">**WM \_ 使用者**</span><span class="sxs-lookup"><span data-stu-id="2b549-205">**WM\_USER**</span></span>](wm-user.md)      | <span data-ttu-id="2b549-206">使用 todefine 私用訊息以供私用視窗類別使用。</span><span class="sxs-lookup"><span data-stu-id="2b549-206">Used todefine private messages for use by private window classes.</span></span> <br/>  |



 

### <a name="message-structures"></a><span data-ttu-id="2b549-207">訊息結構</span><span class="sxs-lookup"><span data-stu-id="2b549-207">Message Structures</span></span>



| <span data-ttu-id="2b549-208">Name</span><span class="sxs-lookup"><span data-stu-id="2b549-208">Name</span></span>                       | <span data-ttu-id="2b549-209">描述</span><span class="sxs-lookup"><span data-stu-id="2b549-209">Description</span></span>                                                                                                                              |
|----------------------------|------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="2b549-210">**BSMINFO**</span><span class="sxs-lookup"><span data-stu-id="2b549-210">**BSMINFO**</span></span>](/windows/win32/api/winuser/ns-winuser-bsminfo) | <span data-ttu-id="2b549-211">包含拒絕 [**BroadcastSystemMessageEx**](/windows/win32/api/winuser/nf-winuser-broadcastsystemmessageexa)要求的視窗相關資訊。</span><span class="sxs-lookup"><span data-stu-id="2b549-211">Contains information about a window that denied a request from [**BroadcastSystemMessageEx**](/windows/win32/api/winuser/nf-winuser-broadcastsystemmessageexa).</span></span> <br/> |
| [<span data-ttu-id="2b549-212">**味精**</span><span class="sxs-lookup"><span data-stu-id="2b549-212">**MSG**</span></span>](/windows/win32/api/winuser/ns-winuser-msg)         | <span data-ttu-id="2b549-213">包含來自執行緒之訊息佇列的訊息資訊。</span><span class="sxs-lookup"><span data-stu-id="2b549-213">Contains message information from a thread's message queue.</span></span> <br/>                                                                  |



 

 

