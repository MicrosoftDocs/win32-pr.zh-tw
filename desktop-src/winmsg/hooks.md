---
description: 本節討論勾點。 攔截是系統訊息處理機制中的一個點，可讓應用程式安裝副程式來監視訊息流量。
ms.assetid: vs|winui|~\winui\windowsuserinterface\windowing\hooks.htm
title: 鉤
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 74057d25e3152c8782c2be364688bb971b08ddf5
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/08/2021
ms.locfileid: "104194564"
---
# <a name="hooks"></a><span data-ttu-id="524d0-104">鉤</span><span class="sxs-lookup"><span data-stu-id="524d0-104">Hooks</span></span>

<span data-ttu-id="524d0-105">攔截是系統訊息處理機制中的一個點，應用程式可以在其中安裝副程式來監視系統中的訊息流量，並在到達目標視窗程式之前處理特定類型的訊息。</span><span class="sxs-lookup"><span data-stu-id="524d0-105">A hook is a point in the system message-handling mechanism where an application can install a subroutine to monitor the message traffic in the system and process certain types of messages before they reach the target window procedure.</span></span>

### <a name="in-this-section"></a><span data-ttu-id="524d0-106">本節內容</span><span class="sxs-lookup"><span data-stu-id="524d0-106">In This Section</span></span>



| <span data-ttu-id="524d0-107">Name</span><span class="sxs-lookup"><span data-stu-id="524d0-107">Name</span></span>                                 | <span data-ttu-id="524d0-108">描述</span><span class="sxs-lookup"><span data-stu-id="524d0-108">Description</span></span>                                                         |
|--------------------------------------|---------------------------------------------------------------------|
| [<span data-ttu-id="524d0-109">勾點總覽</span><span class="sxs-lookup"><span data-stu-id="524d0-109">Hook Overview</span></span>](about-hooks.md)     | <span data-ttu-id="524d0-110">討論如何使用勾點。</span><span class="sxs-lookup"><span data-stu-id="524d0-110">Discusses how hooks should be used.</span></span><br/>                      |
| [<span data-ttu-id="524d0-111">使用攔截</span><span class="sxs-lookup"><span data-stu-id="524d0-111">Using Hooks</span></span>](using-hooks.md)       | <span data-ttu-id="524d0-112">示範如何執行與攔截相關聯的工作。</span><span class="sxs-lookup"><span data-stu-id="524d0-112">Demonstrates how to perform tasks associated with hooks.</span></span><br/> |
| [<span data-ttu-id="524d0-113">勾點參考</span><span class="sxs-lookup"><span data-stu-id="524d0-113">Hook Reference</span></span>](hook-reference.md) | <span data-ttu-id="524d0-114">包含 API 參考。</span><span class="sxs-lookup"><span data-stu-id="524d0-114">Contains the API reference.</span></span><br/>                              |



 

### <a name="hook-functions"></a><span data-ttu-id="524d0-115">攔截函式</span><span class="sxs-lookup"><span data-stu-id="524d0-115">Hook Functions</span></span>



| <span data-ttu-id="524d0-116">Name</span><span class="sxs-lookup"><span data-stu-id="524d0-116">Name</span></span>                                               | <span data-ttu-id="524d0-117">描述</span><span class="sxs-lookup"><span data-stu-id="524d0-117">Description</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|----------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="524d0-118">**CallMsgFilter**</span><span class="sxs-lookup"><span data-stu-id="524d0-118">**CallMsgFilter**</span></span>](/windows/win32/api/winuser/nf-winuser-callmsgfiltera)             | <span data-ttu-id="524d0-119">將指定的訊息和攔截程式碼傳遞給與 [**WH \_ SYSMSGFILTER**](about-hooks.md) 和 **WH \_ MSGFILTER** 攔截程式相關聯的攔截程式。</span><span class="sxs-lookup"><span data-stu-id="524d0-119">Passes the specified message and hook code to the hook procedures associated with the [**WH\_SYSMSGFILTER**](about-hooks.md) and **WH\_MSGFILTER** hook procedures.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                      |
| [<span data-ttu-id="524d0-120">**CallNextHookEx**</span><span class="sxs-lookup"><span data-stu-id="524d0-120">**CallNextHookEx**</span></span>](/windows/win32/api/winuser/nf-winuser-callnexthookex)           | <span data-ttu-id="524d0-121">將攔截資訊傳遞給目前攔截鏈中的下一個勾點程式。</span><span class="sxs-lookup"><span data-stu-id="524d0-121">Passes the hook information to the next hook procedure in the current hook chain.</span></span> <span data-ttu-id="524d0-122">攔截程式可以在處理勾點資訊之前或之後呼叫此函式。</span><span class="sxs-lookup"><span data-stu-id="524d0-122">A hook procedure can call this function either before or after processing the hook information.</span></span> <br/>                                                                                                                                                                                                                                                                                                                                                                                                         |
| <span data-ttu-id="524d0-123">[*CallWndProc*](/previous-versions/windows/desktop/legacy/ms644975(v=vs.85))</span><span class="sxs-lookup"><span data-stu-id="524d0-123">[*CallWndProc*](/previous-versions/windows/desktop/legacy/ms644975(v=vs.85))</span></span>                   | <span data-ttu-id="524d0-124">搭配 [**SetWindowsHookEx**](/windows/win32/api/winuser/nf-winuser-setwindowshookexa) 函式使用的應用程式定義或程式庫定義的回呼函數。</span><span class="sxs-lookup"><span data-stu-id="524d0-124">An application-defined or library-defined callback function used with the [**SetWindowsHookEx**](/windows/win32/api/winuser/nf-winuser-setwindowshookexa) function.</span></span> <span data-ttu-id="524d0-125">系統會在呼叫視窗程式之前呼叫這個函式，以處理傳送至執行緒的訊息。</span><span class="sxs-lookup"><span data-stu-id="524d0-125">The system calls this function before calling the window procedure to process a message sent to the thread.</span></span><br/>                                                                                                                                                                                                                                                                                                                                               |
| [<span data-ttu-id="524d0-126">*CallWndRetProc*</span><span class="sxs-lookup"><span data-stu-id="524d0-126">*CallWndRetProc*</span></span>](/windows/win32/api/winuser/nc-winuser-hookproc)             | <span data-ttu-id="524d0-127">搭配 [**SetWindowsHookEx**](/windows/win32/api/winuser/nf-winuser-setwindowshookexa) 函式使用的應用程式定義或程式庫定義的回呼函數。</span><span class="sxs-lookup"><span data-stu-id="524d0-127">An application-defined or library-defined callback function used with the [**SetWindowsHookEx**](/windows/win32/api/winuser/nf-winuser-setwindowshookexa) function.</span></span> <span data-ttu-id="524d0-128">系統會在呼叫 [**SendMessage**](/windows/win32/api/winuser/nf-winuser-sendmessage) 函式之後呼叫這個函數。</span><span class="sxs-lookup"><span data-stu-id="524d0-128">The system calls this function after the [**SendMessage**](/windows/win32/api/winuser/nf-winuser-sendmessage) function is called.</span></span> <span data-ttu-id="524d0-129">攔截程式可以檢查訊息;它無法加以修改。</span><span class="sxs-lookup"><span data-stu-id="524d0-129">The hook procedure can examine the message; it cannot modify it.</span></span> <br/>                                                                                                                                                                                                                                                                                         |
| <span data-ttu-id="524d0-130">[*CBTProc*](/previous-versions/windows/desktop/legacy/ms644977(v=vs.85))</span><span class="sxs-lookup"><span data-stu-id="524d0-130">[*CBTProc*](/previous-versions/windows/desktop/legacy/ms644977(v=vs.85))</span></span>                           | <span data-ttu-id="524d0-131">搭配 [**SetWindowsHookEx**](/windows/win32/api/winuser/nf-winuser-setwindowshookexa) 函式使用的應用程式定義或程式庫定義的回呼函數。</span><span class="sxs-lookup"><span data-stu-id="524d0-131">An application-defined or library-defined callback function used with the [**SetWindowsHookEx**](/windows/win32/api/winuser/nf-winuser-setwindowshookexa) function.</span></span> <span data-ttu-id="524d0-132">系統會先呼叫此函式，再啟用、建立、終結、最小化、最大化、移動或調整視窗大小;完成系統命令之前，從系統訊息佇列移除滑鼠或鍵盤事件之前，設定鍵盤焦點之前：或在與系統訊息佇列同步處理之前。</span><span class="sxs-lookup"><span data-stu-id="524d0-132">The system calls this function before activating, creating, destroying, minimizing, maximizing, moving, or sizing a window; before completing a system command; before removing a mouse or keyboard event from the system message queue; before setting the keyboard focus; or before synchronizing with the system message queue.</span></span> <span data-ttu-id="524d0-133">以電腦為基礎的訓練 (CBT) 應用程式會使用此攔截程式從系統接收有用的通知。</span><span class="sxs-lookup"><span data-stu-id="524d0-133">A computer-based training (CBT) application uses this hook procedure to receive useful notifications from the system.</span></span> <br/> |
| <span data-ttu-id="524d0-134">[*DebugProc*](/previous-versions/windows/desktop/legacy/ms644978(v=vs.85))</span><span class="sxs-lookup"><span data-stu-id="524d0-134">[*DebugProc*](/previous-versions/windows/desktop/legacy/ms644978(v=vs.85))</span></span>                       | <span data-ttu-id="524d0-135">搭配 [**SetWindowsHookEx**](/windows/win32/api/winuser/nf-winuser-setwindowshookexa) 函式使用的應用程式定義或程式庫定義的回呼函數。</span><span class="sxs-lookup"><span data-stu-id="524d0-135">An application-defined or library-defined callback function used with the [**SetWindowsHookEx**](/windows/win32/api/winuser/nf-winuser-setwindowshookexa) function.</span></span> <span data-ttu-id="524d0-136">系統會先呼叫此函式，然後再呼叫與任何類型之攔截相關的攔截程式。</span><span class="sxs-lookup"><span data-stu-id="524d0-136">The system calls this function before calling the hook procedures associated with any type of hook.</span></span> <span data-ttu-id="524d0-137">系統會將要呼叫之攔截的相關資訊傳遞給 [*DebugProc*](/previous-versions/windows/desktop/legacy/ms644978(v=vs.85)) 攔截程式，以檢查資訊並判斷是否允許呼叫攔截。</span><span class="sxs-lookup"><span data-stu-id="524d0-137">The system passes information about the hook to be called to the [*DebugProc*](/previous-versions/windows/desktop/legacy/ms644978(v=vs.85)) hook procedure, which examines the information and determines whether to allow the hook to be called.</span></span> <br/>                                                                                                                                                  |
| <span data-ttu-id="524d0-138">[*ForegroundIdleProc*](/previous-versions/windows/desktop/legacy/ms644980(v=vs.85))</span><span class="sxs-lookup"><span data-stu-id="524d0-138">[*ForegroundIdleProc*](/previous-versions/windows/desktop/legacy/ms644980(v=vs.85))</span></span>     | <span data-ttu-id="524d0-139">搭配 [**SetWindowsHookEx**](/windows/win32/api/winuser/nf-winuser-setwindowshookexa) 函式使用的應用程式定義或程式庫定義的回呼函數。</span><span class="sxs-lookup"><span data-stu-id="524d0-139">An application-defined or library-defined callback function used with the [**SetWindowsHookEx**](/windows/win32/api/winuser/nf-winuser-setwindowshookexa) function.</span></span> <span data-ttu-id="524d0-140">只要前景執行緒即將變成閒置狀態，系統就會呼叫這個函數。</span><span class="sxs-lookup"><span data-stu-id="524d0-140">The system calls this function whenever the foreground thread is about to become idle.</span></span> <br/>                                                                                                                                                                                                                                                                                                                                                                   |
| <span data-ttu-id="524d0-141">[*GetMsgProc*](/previous-versions/windows/desktop/legacy/ms644981(v=vs.85))</span><span class="sxs-lookup"><span data-stu-id="524d0-141">[*GetMsgProc*](/previous-versions/windows/desktop/legacy/ms644981(v=vs.85))</span></span>                     | <span data-ttu-id="524d0-142">搭配 [**SetWindowsHookEx**](/windows/win32/api/winuser/nf-winuser-setwindowshookexa) 函式使用的應用程式定義或程式庫定義的回呼函數。</span><span class="sxs-lookup"><span data-stu-id="524d0-142">An application-defined or library-defined callback function used with the [**SetWindowsHookEx**](/windows/win32/api/winuser/nf-winuser-setwindowshookexa) function.</span></span> <span data-ttu-id="524d0-143">每當 [**GetMessage**](/windows/win32/api/winuser/nf-winuser-getmessage) 或 [**PeekMessage**](/windows/win32/api/winuser/nf-winuser-peekmessagea) 函式從應用程式訊息佇列抓取訊息時，系統就會呼叫這個函式。</span><span class="sxs-lookup"><span data-stu-id="524d0-143">The system calls this function whenever the [**GetMessage**](/windows/win32/api/winuser/nf-winuser-getmessage) or [**PeekMessage**](/windows/win32/api/winuser/nf-winuser-peekmessagea) function has retrieved a message from an application message queue.</span></span> <span data-ttu-id="524d0-144">將抓取的訊息傳回給呼叫者之前，系統會將訊息傳遞至攔截程式。</span><span class="sxs-lookup"><span data-stu-id="524d0-144">Before returning the retrieved message to the caller, the system passes the message to the hook procedure.</span></span> <br/>                                                                                                                                                        |
| <span data-ttu-id="524d0-145">[*JournalPlaybackProc*](/previous-versions/windows/desktop/legacy/ms644982(v=vs.85))</span><span class="sxs-lookup"><span data-stu-id="524d0-145">[*JournalPlaybackProc*](/previous-versions/windows/desktop/legacy/ms644982(v=vs.85))</span></span>   | <span data-ttu-id="524d0-146">搭配 [**SetWindowsHookEx**](/windows/win32/api/winuser/nf-winuser-setwindowshookexa) 函式使用的應用程式定義或程式庫定義的回呼函數。</span><span class="sxs-lookup"><span data-stu-id="524d0-146">An application-defined or library-defined callback function used with the [**SetWindowsHookEx**](/windows/win32/api/winuser/nf-winuser-setwindowshookexa) function.</span></span> <span data-ttu-id="524d0-147">一般而言，應用程式會使用此函式來播放一系列 [*JournalRecordProc*](/previous-versions/windows/desktop/legacy/ms644983(v=vs.85)) 攔截程式先前錄製的滑鼠和鍵盤訊息。</span><span class="sxs-lookup"><span data-stu-id="524d0-147">Typically, an application uses this function to play back a series of mouse and keyboard messages recorded previously by the [*JournalRecordProc*](/previous-versions/windows/desktop/legacy/ms644983(v=vs.85)) hook procedure.</span></span> <span data-ttu-id="524d0-148">只要安裝了 [*JournalPlaybackProc*](/previous-versions/windows/desktop/legacy/ms644982(v=vs.85)) 勾點程式，就會停用一般的滑鼠和鍵盤輸入。</span><span class="sxs-lookup"><span data-stu-id="524d0-148">As long as a [*JournalPlaybackProc*](/previous-versions/windows/desktop/legacy/ms644982(v=vs.85)) hook procedure is installed, regular mouse and keyboard input is disabled.</span></span> <br/>                                                                                                                       |
| <span data-ttu-id="524d0-149">[*JournalRecordProc*](/previous-versions/windows/desktop/legacy/ms644983(v=vs.85))</span><span class="sxs-lookup"><span data-stu-id="524d0-149">[*JournalRecordProc*](/previous-versions/windows/desktop/legacy/ms644983(v=vs.85))</span></span>       | <span data-ttu-id="524d0-150">搭配 [**SetWindowsHookEx**](/windows/win32/api/winuser/nf-winuser-setwindowshookexa) 函式使用的應用程式定義或程式庫定義的回呼函數。</span><span class="sxs-lookup"><span data-stu-id="524d0-150">An application-defined or library-defined callback function used with the [**SetWindowsHookEx**](/windows/win32/api/winuser/nf-winuser-setwindowshookexa) function.</span></span> <span data-ttu-id="524d0-151">此函數會記錄系統從系統訊息佇列中移除的訊息。</span><span class="sxs-lookup"><span data-stu-id="524d0-151">The function records messages the system removes from the system message queue.</span></span> <span data-ttu-id="524d0-152">之後，應用程式可以使用 [*JournalPlaybackProc*](/previous-versions/windows/desktop/legacy/ms644982(v=vs.85)) 勾點來播放訊息。</span><span class="sxs-lookup"><span data-stu-id="524d0-152">Later, an application can use a [*JournalPlaybackProc*](/previous-versions/windows/desktop/legacy/ms644982(v=vs.85)) hook procedure to play back the messages.</span></span> <br/>                                                                                                                                                                                                                                               |
| <span data-ttu-id="524d0-153">[*KeyboardProc*](/previous-versions/windows/desktop/legacy/ms644984(v=vs.85))</span><span class="sxs-lookup"><span data-stu-id="524d0-153">[*KeyboardProc*](/previous-versions/windows/desktop/legacy/ms644984(v=vs.85))</span></span>                 | <span data-ttu-id="524d0-154">搭配 [**SetWindowsHookEx**](/windows/win32/api/winuser/nf-winuser-setwindowshookexa) 函式使用的應用程式定義或程式庫定義的回呼函數。</span><span class="sxs-lookup"><span data-stu-id="524d0-154">An application-defined or library-defined callback function used with the [**SetWindowsHookEx**](/windows/win32/api/winuser/nf-winuser-setwindowshookexa) function.</span></span> <span data-ttu-id="524d0-155">每當應用程式呼叫 [**GetMessage**](/windows/win32/api/winuser/nf-winuser-getmessage) 或 [**PeekMessage**](/windows/win32/api/winuser/nf-winuser-peekmessagea) 函式時，系統就會呼叫這個函式，而) 要處理的鍵盤訊息 ([**wm \_ KEYUP**](/windows/desktop/inputdev/wm-keyup) 或 [**WM \_ KEYDOWN**](/windows/desktop/inputdev/wm-keydown) 。</span><span class="sxs-lookup"><span data-stu-id="524d0-155">The system calls this function whenever an application calls the [**GetMessage**](/windows/win32/api/winuser/nf-winuser-getmessage) or [**PeekMessage**](/windows/win32/api/winuser/nf-winuser-peekmessagea) function and there is a keyboard message ([**WM\_KEYUP**](/windows/desktop/inputdev/wm-keyup) or [**WM\_KEYDOWN**](/windows/desktop/inputdev/wm-keydown)) to be processed.</span></span> <br/>                                                                                                                                                                         |
| <span data-ttu-id="524d0-156">[*LowLevelKeyboardProc*](/previous-versions/windows/desktop/legacy/ms644985(v=vs.85))</span><span class="sxs-lookup"><span data-stu-id="524d0-156">[*LowLevelKeyboardProc*](/previous-versions/windows/desktop/legacy/ms644985(v=vs.85))</span></span> | <span data-ttu-id="524d0-157">搭配 [**SetWindowsHookEx**](/windows/win32/api/winuser/nf-winuser-setwindowshookexa) 函式使用的應用程式定義或程式庫定義的回呼函數。</span><span class="sxs-lookup"><span data-stu-id="524d0-157">An application-defined or library-defined callback function used with the [**SetWindowsHookEx**](/windows/win32/api/winuser/nf-winuser-setwindowshookexa) function.</span></span> <span data-ttu-id="524d0-158">每次有新的鍵盤輸入事件張貼到執行緒輸入佇列時，系統就會呼叫這個函式。</span><span class="sxs-lookup"><span data-stu-id="524d0-158">The system calls this function every time a new keyboard input event is about to be posted into a thread input queue.</span></span><br/>                                                                                                                                                                                                                                                                                                                                     |
| <span data-ttu-id="524d0-159">[*LowLevelMouseProc*](/previous-versions/windows/desktop/legacy/ms644986(v=vs.85))</span><span class="sxs-lookup"><span data-stu-id="524d0-159">[*LowLevelMouseProc*](/previous-versions/windows/desktop/legacy/ms644986(v=vs.85))</span></span>       | <span data-ttu-id="524d0-160">搭配 [**SetWindowsHookEx**](/windows/win32/api/winuser/nf-winuser-setwindowshookexa) 函式使用的應用程式定義或程式庫定義的回呼函數。</span><span class="sxs-lookup"><span data-stu-id="524d0-160">An application-defined or library-defined callback function used with the [**SetWindowsHookEx**](/windows/win32/api/winuser/nf-winuser-setwindowshookexa) function.</span></span> <span data-ttu-id="524d0-161">每次有新的滑鼠輸入事件張貼到執行緒輸入佇列時，系統就會呼叫這個函數。</span><span class="sxs-lookup"><span data-stu-id="524d0-161">The system calls this function every time a new mouse input event is about to be posted into a thread input queue.</span></span><br/>                                                                                                                                                                                                                                                                                                                                        |
| <span data-ttu-id="524d0-162">[*MessageProc*](/previous-versions/windows/desktop/legacy/ms644987(v=vs.85))</span><span class="sxs-lookup"><span data-stu-id="524d0-162">[*MessageProc*](/previous-versions/windows/desktop/legacy/ms644987(v=vs.85))</span></span>                   | <span data-ttu-id="524d0-163">搭配 [**SetWindowsHookEx**](/windows/win32/api/winuser/nf-winuser-setwindowshookexa) 函式使用的應用程式定義或程式庫定義的回呼函數。</span><span class="sxs-lookup"><span data-stu-id="524d0-163">An application-defined or library-defined callback function used with the [**SetWindowsHookEx**](/windows/win32/api/winuser/nf-winuser-setwindowshookexa) function.</span></span> <span data-ttu-id="524d0-164">系統會在對話方塊、訊息方塊、功能表或捲軸中發生輸入事件之後，但在輸入事件所產生的訊息之前，呼叫此函式。</span><span class="sxs-lookup"><span data-stu-id="524d0-164">The system calls this function after an input event occurs in a dialog box, message box, menu, or scroll bar, but before the message generated by the input event is processed.</span></span> <span data-ttu-id="524d0-165">攔截程式可以監視特定應用程式或所有應用程式所建立之對話方塊、訊息方塊、功能表或捲軸的訊息。</span><span class="sxs-lookup"><span data-stu-id="524d0-165">The hook procedure can monitor messages for a dialog box, message box, menu, or scroll bar created by a particular application or all applications.</span></span><br/>                                                                                                                       |
| <span data-ttu-id="524d0-166">[*MouseProc*](/previous-versions/windows/desktop/legacy/ms644988(v=vs.85))</span><span class="sxs-lookup"><span data-stu-id="524d0-166">[*MouseProc*](/previous-versions/windows/desktop/legacy/ms644988(v=vs.85))</span></span>                       | <span data-ttu-id="524d0-167">搭配 [**SetWindowsHookEx**](/windows/win32/api/winuser/nf-winuser-setwindowshookexa) 函式使用的應用程式定義或程式庫定義的回呼函數。</span><span class="sxs-lookup"><span data-stu-id="524d0-167">An application-defined or library-defined callback function used with the [**SetWindowsHookEx**](/windows/win32/api/winuser/nf-winuser-setwindowshookexa) function.</span></span> <span data-ttu-id="524d0-168">每當應用程式呼叫 [**GetMessage**](/windows/win32/api/winuser/nf-winuser-getmessage) 或 [**PeekMessage**](/windows/win32/api/winuser/nf-winuser-peekmessagea) 函式，且有要處理的滑鼠訊息時，系統就會呼叫這個函式。</span><span class="sxs-lookup"><span data-stu-id="524d0-168">The system calls this function whenever an application calls the [**GetMessage**](/windows/win32/api/winuser/nf-winuser-getmessage) or [**PeekMessage**](/windows/win32/api/winuser/nf-winuser-peekmessagea) function and there is a mouse message to be processed.</span></span> <br/>                                                                                                                                                                                                                                                           |
| [<span data-ttu-id="524d0-169">**SetWindowsHookEx**</span><span class="sxs-lookup"><span data-stu-id="524d0-169">**SetWindowsHookEx**</span></span>](/windows/win32/api/winuser/nf-winuser-setwindowshookexa)       | <span data-ttu-id="524d0-170">將應用程式定義的勾點程式安裝到勾點。</span><span class="sxs-lookup"><span data-stu-id="524d0-170">Installs an application-defined hook procedure into a hook chain.</span></span> <span data-ttu-id="524d0-171">您可以安裝攔截程式，以監視特定事件種類的系統。</span><span class="sxs-lookup"><span data-stu-id="524d0-171">You would install a hook procedure to monitor the system for certain types of events.</span></span> <span data-ttu-id="524d0-172">這些事件會與特定的執行緒或相同桌面上的所有線程相關聯，做為呼叫的執行緒。</span><span class="sxs-lookup"><span data-stu-id="524d0-172">These events are associated either with a specific thread or with all threads in the same desktop as the calling thread.</span></span><br/>                                                                                                                                                                                                                                                                                                           |
| <span data-ttu-id="524d0-173">[*ShellProc*](/previous-versions/windows/desktop/legacy/ms644991(v=vs.85))</span><span class="sxs-lookup"><span data-stu-id="524d0-173">[*ShellProc*](/previous-versions/windows/desktop/legacy/ms644991(v=vs.85))</span></span>                       | <span data-ttu-id="524d0-174">搭配 [**SetWindowsHookEx**](/windows/win32/api/winuser/nf-winuser-setwindowshookexa) 函式使用的應用程式定義或程式庫定義的回呼函數。</span><span class="sxs-lookup"><span data-stu-id="524d0-174">An application-defined or library-defined callback function used with the [**SetWindowsHookEx**](/windows/win32/api/winuser/nf-winuser-setwindowshookexa) function.</span></span> <span data-ttu-id="524d0-175">函式會從系統接收 Shell 事件的通知。</span><span class="sxs-lookup"><span data-stu-id="524d0-175">The function receives notifications of Shell events from the system.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                      |
| <span data-ttu-id="524d0-176">[*SysMsgProc*](/previous-versions/windows/desktop/legacy/ms644992(v=vs.85))</span><span class="sxs-lookup"><span data-stu-id="524d0-176">[*SysMsgProc*](/previous-versions/windows/desktop/legacy/ms644992(v=vs.85))</span></span>                     | <span data-ttu-id="524d0-177">搭配 [**SetWindowsHookEx**](/windows/win32/api/winuser/nf-winuser-setwindowshookexa) 函式使用的應用程式定義或程式庫定義的回呼函數。</span><span class="sxs-lookup"><span data-stu-id="524d0-177">An application-defined or library-defined callback function used with the [**SetWindowsHookEx**](/windows/win32/api/winuser/nf-winuser-setwindowshookexa) function.</span></span> <span data-ttu-id="524d0-178">系統會在對話方塊、訊息方塊、功能表或捲軸中發生輸入事件之後，但在輸入事件所產生的訊息之前，呼叫此函式。</span><span class="sxs-lookup"><span data-stu-id="524d0-178">The system calls this function after an input event occurs in a dialog box, message box, menu, or scroll bar, but before the message generated by the input event is processed.</span></span> <span data-ttu-id="524d0-179">函數可以監視系統中任何對話方塊、訊息方塊、功能表或捲軸的訊息。</span><span class="sxs-lookup"><span data-stu-id="524d0-179">The function can monitor messages for any dialog box, message box, menu, or scroll bar in the system.</span></span> <br/>                                                                                                                                                                    |
| [<span data-ttu-id="524d0-180">**UnhookWindowsHookEx**</span><span class="sxs-lookup"><span data-stu-id="524d0-180">**UnhookWindowsHookEx**</span></span>](/windows/win32/api/winuser/nf-winuser-unhookwindowshookex) | <span data-ttu-id="524d0-181">移除 [**SetWindowsHookEx**](/windows/win32/api/winuser/nf-winuser-setwindowshookexa) 函式在勾點中安裝的勾點程式。</span><span class="sxs-lookup"><span data-stu-id="524d0-181">Removes a hook procedure installed in a hook chain by the [**SetWindowsHookEx**](/windows/win32/api/winuser/nf-winuser-setwindowshookexa) function.</span></span> <br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |



 

### <a name="hook-notifications"></a><span data-ttu-id="524d0-182">攔截通知</span><span class="sxs-lookup"><span data-stu-id="524d0-182">Hook Notifications</span></span>



| <span data-ttu-id="524d0-183">Name</span><span class="sxs-lookup"><span data-stu-id="524d0-183">Name</span></span>                                          | <span data-ttu-id="524d0-184">描述</span><span class="sxs-lookup"><span data-stu-id="524d0-184">Description</span></span>                                                                                                                                                                         |
|-----------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="524d0-185">**WM \_ CANCELJOURNAL**</span><span class="sxs-lookup"><span data-stu-id="524d0-185">**WM\_CANCELJOURNAL**</span></span>](wm-canceljournal.md) | <span data-ttu-id="524d0-186">當使用者取消應用程式的日誌活動時，張貼至應用程式。</span><span class="sxs-lookup"><span data-stu-id="524d0-186">Posted to an application when a user cancels the application's journaling activities.</span></span> <span data-ttu-id="524d0-187">訊息是以 **Null** 視窗控制碼張貼。</span><span class="sxs-lookup"><span data-stu-id="524d0-187">The message is posted with a **NULL** window handle.</span></span> <br/>                              |
| [<span data-ttu-id="524d0-188">**WM \_ QUEUESYNC**</span><span class="sxs-lookup"><span data-stu-id="524d0-188">**WM\_QUEUESYNC**</span></span>](wm-queuesync.md)         | <span data-ttu-id="524d0-189">由 CBT 應用程式傳送，以分隔使用者輸入訊息與透過 [**WH \_ JOURNALPLAYBACK**](about-hooks.md) 程式傳送的其他訊息。</span><span class="sxs-lookup"><span data-stu-id="524d0-189">Sent by a CBT application to separate user-input messages from other messages sent through the [**WH\_JOURNALPLAYBACK**](about-hooks.md) procedure.</span></span> <br/> |



 

### <a name="hook-structures"></a><span data-ttu-id="524d0-190">攔截結構</span><span class="sxs-lookup"><span data-stu-id="524d0-190">Hook Structures</span></span>



| <span data-ttu-id="524d0-191">Name</span><span class="sxs-lookup"><span data-stu-id="524d0-191">Name</span></span>                                           | <span data-ttu-id="524d0-192">描述</span><span class="sxs-lookup"><span data-stu-id="524d0-192">Description</span></span>                                                                                                                                                                                                                 |
|------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="524d0-193">**CBT \_ CREATEWND**</span><span class="sxs-lookup"><span data-stu-id="524d0-193">**CBT\_CREATEWND**</span></span>](/windows/win32/api/winuser/ns-winuser-cbt_createwnda)        | <span data-ttu-id="524d0-194">包含在建立視窗之前傳遞給 **WH \_ CBT** 攔截程式 [*CBTProc*](/previous-versions/windows/desktop/legacy/ms644977(v=vs.85))的資訊。</span><span class="sxs-lookup"><span data-stu-id="524d0-194">Contains information passed to a **WH\_CBT** hook procedure, [*CBTProc*](/previous-versions/windows/desktop/legacy/ms644977(v=vs.85)), before a window is created.</span></span><br/>                                                                                               |
| [<span data-ttu-id="524d0-195">**CBTACTI加值稅ESTRUCT**</span><span class="sxs-lookup"><span data-stu-id="524d0-195">**CBTACTIVATESTRUCT**</span></span>](/windows/win32/api/winuser/ns-winuser-cbtactivatestruct) | <span data-ttu-id="524d0-196">包含在啟動視窗之前傳遞給 **WH \_ CBT** 攔截程式 [*CBTProc*](/previous-versions/windows/desktop/legacy/ms644977(v=vs.85))的資訊。</span><span class="sxs-lookup"><span data-stu-id="524d0-196">Contains information passed to a **WH\_CBT** hook procedure, [*CBTProc*](/previous-versions/windows/desktop/legacy/ms644977(v=vs.85)), before a window is activated.</span></span> <br/>                                                                                            |
| [<span data-ttu-id="524d0-197">**CWPRETSTRUCT**</span><span class="sxs-lookup"><span data-stu-id="524d0-197">**CWPRETSTRUCT**</span></span>](/windows/win32/api/winuser/ns-winuser-cwpretstruct)           | <span data-ttu-id="524d0-198">定義傳遞至 **WH \_ CALLWNDPROCRET** 攔截程式 [*CallWndRetProc*](/windows/win32/api/winuser/nc-winuser-hookproc)的訊息參數。</span><span class="sxs-lookup"><span data-stu-id="524d0-198">Defines the message parameters passed to a **WH\_CALLWNDPROCRET** hook procedure, [*CallWndRetProc*](/windows/win32/api/winuser/nc-winuser-hookproc).</span></span> <br/>                                                                                       |
| [<span data-ttu-id="524d0-199">**CWPSTRUCT**</span><span class="sxs-lookup"><span data-stu-id="524d0-199">**CWPSTRUCT**</span></span>](/windows/win32/api/winuser/ns-winuser-cwpstruct)                 | <span data-ttu-id="524d0-200">定義傳遞至 **WH \_ CALLWNDPROC** 攔截程式 [*CALLWNDPROC*](/previous-versions/windows/desktop/legacy/ms644975(v=vs.85))的訊息參數。</span><span class="sxs-lookup"><span data-stu-id="524d0-200">Defines the message parameters passed to a **WH\_CALLWNDPROC** hook procedure, [*CallWndProc*](/previous-versions/windows/desktop/legacy/ms644975(v=vs.85)).</span></span> <br/>                                                                                                |
| [<span data-ttu-id="524d0-201">**DEBUGHOOKINFO**</span><span class="sxs-lookup"><span data-stu-id="524d0-201">**DEBUGHOOKINFO**</span></span>](/windows/win32/api/winuser/ns-winuser-debughookinfo)         | <span data-ttu-id="524d0-202">包含傳遞至 **WH \_ DEBUG** 攔截程式 [*DebugProc*](/previous-versions/windows/desktop/legacy/ms644978(v=vs.85))的偵錯工具資訊。</span><span class="sxs-lookup"><span data-stu-id="524d0-202">Contains debugging information passed to a **WH\_DEBUG** hook procedure, [*DebugProc*](/previous-versions/windows/desktop/legacy/ms644978(v=vs.85)).</span></span> <br/>                                                                                                          |
| [<span data-ttu-id="524d0-203">**EVENTMSG**</span><span class="sxs-lookup"><span data-stu-id="524d0-203">**EVENTMSG**</span></span>](/windows/win32/api/winuser/ns-winuser-eventmsg)                   | <span data-ttu-id="524d0-204">包含傳送至系統訊息佇列之硬體訊息的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="524d0-204">Contains information about a hardware message sent to the system message queue.</span></span> <span data-ttu-id="524d0-205">這個結構是用來儲存 [*JournalPlaybackProc*](/previous-versions/windows/desktop/legacy/ms644982(v=vs.85)) 回呼函數的訊息資訊。</span><span class="sxs-lookup"><span data-stu-id="524d0-205">This structure is used to store message information for the [*JournalPlaybackProc*](/previous-versions/windows/desktop/legacy/ms644982(v=vs.85)) callback function.</span></span> <br/> |
| [<span data-ttu-id="524d0-206">**KBDLLHOOKSTRUCT**</span><span class="sxs-lookup"><span data-stu-id="524d0-206">**KBDLLHOOKSTRUCT**</span></span>](/windows/win32/api/winuser/ns-winuser-kbdllhookstruct)     | <span data-ttu-id="524d0-207">包含低層級鍵盤輸入事件的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="524d0-207">Contains information about a low-level keyboard input event.</span></span> <br/>                                                                                                                                                    |
| [<span data-ttu-id="524d0-208">**MOUSEHOOKSTRUCT**</span><span class="sxs-lookup"><span data-stu-id="524d0-208">**MOUSEHOOKSTRUCT**</span></span>](/windows/win32/api/winuser/ns-winuser-mousehookstruct)     | <span data-ttu-id="524d0-209">包含傳遞至 **WH \_ 滑鼠** 掛勾程式 [*MouseProc*](/previous-versions/windows/desktop/legacy/ms644988(v=vs.85))的滑鼠事件相關資訊。</span><span class="sxs-lookup"><span data-stu-id="524d0-209">Contains information about a mouse event passed to a **WH\_MOUSE** hook procedure, [*MouseProc*](/previous-versions/windows/desktop/legacy/ms644988(v=vs.85)).</span></span> <br/>                                                                                                |
| [<span data-ttu-id="524d0-210">**MOUSEHOOKSTRUCTEX**</span><span class="sxs-lookup"><span data-stu-id="524d0-210">**MOUSEHOOKSTRUCTEX**</span></span>](/windows/win32/api/winuser/ns-winuser-mousehookstructex) | <span data-ttu-id="524d0-211">包含傳遞至 **WH \_ 滑鼠** 掛勾程式 [*MouseProc*](/previous-versions/windows/desktop/legacy/ms644988(v=vs.85))的滑鼠事件相關資訊。</span><span class="sxs-lookup"><span data-stu-id="524d0-211">Contains information about a mouse event passed to a **WH\_MOUSE** hook procedure, [*MouseProc*](/previous-versions/windows/desktop/legacy/ms644988(v=vs.85)).</span></span> <br/>                                                                                                |
| [<span data-ttu-id="524d0-212">**MSLLHOOKSTRUCT**</span><span class="sxs-lookup"><span data-stu-id="524d0-212">**MSLLHOOKSTRUCT**</span></span>](/windows/win32/api/winuser/ns-winuser-msllhookstruct)       | <span data-ttu-id="524d0-213">包含低層級滑鼠輸入事件的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="524d0-213">Contains information about a low-level mouse input event.</span></span> <br/>                                                                                                                                                       |



 

## <a name="related-topics"></a><span data-ttu-id="524d0-214">相關主題</span><span class="sxs-lookup"><span data-stu-id="524d0-214">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="524d0-215">**SetWinEventHook**</span><span class="sxs-lookup"><span data-stu-id="524d0-215">**SetWinEventHook**</span></span>](/windows/desktop/api/winuser/nf-winuser-setwineventhook)
</dt> </dl>

 

