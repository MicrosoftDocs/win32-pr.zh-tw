---
description: 本節討論 Windows 訊息和訊息佇列。
ms.assetid: 21a4d40b-52da-49e4-a374-afc4927e96e8
title: 關於訊息和訊息佇列
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 7f0bcf68dbacaae868de3aea1fdc4a5d11290821
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/08/2021
ms.locfileid: "106988458"
---
# <a name="about-messages-and-message-queues"></a><span data-ttu-id="30184-103">關於訊息和訊息佇列</span><span class="sxs-lookup"><span data-stu-id="30184-103">About Messages and Message Queues</span></span>

<span data-ttu-id="30184-104">與以 MS-DOS 為基礎的應用程式不同的是，以 Windows 為基礎的應用程式是事件驅動的應用程式。</span><span class="sxs-lookup"><span data-stu-id="30184-104">Unlike MS-DOS-based applications, Windows-based applications are event-driven.</span></span> <span data-ttu-id="30184-105">它們不會進行明確的函式呼叫 (例如 C 執行時間程式庫呼叫) 來取得輸入。</span><span class="sxs-lookup"><span data-stu-id="30184-105">They do not make explicit function calls (such as C run-time library calls) to obtain input.</span></span> <span data-ttu-id="30184-106">相反地，它們會等待系統將輸入傳遞給它們。</span><span class="sxs-lookup"><span data-stu-id="30184-106">Instead, they wait for the system to pass input to them.</span></span>

<span data-ttu-id="30184-107">系統會將應用程式的所有輸入傳遞至應用程式中的各種視窗。</span><span class="sxs-lookup"><span data-stu-id="30184-107">The system passes all input for an application to the various windows in the application.</span></span> <span data-ttu-id="30184-108">每個視窗都有一個稱為「視窗程式」的函式，每當系統有視窗的輸入時，系統就會呼叫這個函式。</span><span class="sxs-lookup"><span data-stu-id="30184-108">Each window has a function, called a window procedure, that the system calls whenever it has input for the window.</span></span> <span data-ttu-id="30184-109">視窗程式會處理輸入，並將控制權傳回系統。</span><span class="sxs-lookup"><span data-stu-id="30184-109">The window procedure processes the input and returns control to the system.</span></span> <span data-ttu-id="30184-110">如需視窗程式的詳細資訊，請參閱 [視窗程式](window-procedures.md)。</span><span class="sxs-lookup"><span data-stu-id="30184-110">For more information about window procedures, see [Window Procedures](window-procedures.md).</span></span>

<span data-ttu-id="30184-111">如果最上層視窗停止回應訊息超過數秒鐘，系統會將視窗視為沒有回應。</span><span class="sxs-lookup"><span data-stu-id="30184-111">If a top-level window stops responding to messages for more than several seconds, the system considers the window to be not responding.</span></span> <span data-ttu-id="30184-112">在此情況下，系統會隱藏視窗，並將它取代為具有相同 Z 順序、位置、大小和視覺屬性的准刪除視窗。</span><span class="sxs-lookup"><span data-stu-id="30184-112">In this case, the system hides the window and replaces it with a ghost window that has the same Z order, location, size, and visual attributes.</span></span> <span data-ttu-id="30184-113">這可讓使用者移動、調整其大小，甚至關閉應用程式。</span><span class="sxs-lookup"><span data-stu-id="30184-113">This allows the user to move it, resize it, or even close the application.</span></span> <span data-ttu-id="30184-114">不過，這些是唯一可用的動作，因為應用程式實際上沒有回應。</span><span class="sxs-lookup"><span data-stu-id="30184-114">However, these are the only actions available because the application is actually not responding.</span></span> <span data-ttu-id="30184-115">在偵錯工具模式中，系統不會產生幻影視窗。</span><span class="sxs-lookup"><span data-stu-id="30184-115">When in the debugger mode, the system does not generate a ghost window.</span></span>

<span data-ttu-id="30184-116">本節將討論下列主題：</span><span class="sxs-lookup"><span data-stu-id="30184-116">This section discusses the following topics:</span></span>

-   [<span data-ttu-id="30184-117">Windows 訊息</span><span class="sxs-lookup"><span data-stu-id="30184-117">Windows Messages</span></span>](#windows-messages)
-   [<span data-ttu-id="30184-118">訊息類型</span><span class="sxs-lookup"><span data-stu-id="30184-118">Message Types</span></span>](#message-types)
    -   [<span data-ttu-id="30184-119">系統定義的訊息</span><span class="sxs-lookup"><span data-stu-id="30184-119">System-Defined Messages</span></span>](#system-defined-messages)
    -   [<span data-ttu-id="30184-120">應用程式定義的訊息</span><span class="sxs-lookup"><span data-stu-id="30184-120">Application-Defined Messages</span></span>](#application-defined-messages)
-   [<span data-ttu-id="30184-121">訊息路由</span><span class="sxs-lookup"><span data-stu-id="30184-121">Message Routing</span></span>](#message-routing)
    -   [<span data-ttu-id="30184-122">佇列的訊息</span><span class="sxs-lookup"><span data-stu-id="30184-122">Queued Messages</span></span>](#queued-messages)
    -   [<span data-ttu-id="30184-123">Nonqueued 訊息</span><span class="sxs-lookup"><span data-stu-id="30184-123">Nonqueued Messages</span></span>](#nonqueued-messages)
-   [<span data-ttu-id="30184-124">訊息處理</span><span class="sxs-lookup"><span data-stu-id="30184-124">Message Handling</span></span>](#message-handling)
    -   [<span data-ttu-id="30184-125">訊息迴圈</span><span class="sxs-lookup"><span data-stu-id="30184-125">Message Loop</span></span>](#message-loop)
    -   [<span data-ttu-id="30184-126">視窗程式</span><span class="sxs-lookup"><span data-stu-id="30184-126">Window Procedure</span></span>](#window-procedure)
-   [<span data-ttu-id="30184-127">訊息篩選</span><span class="sxs-lookup"><span data-stu-id="30184-127">Message Filtering</span></span>](#message-filtering)
-   [<span data-ttu-id="30184-128">張貼和傳送訊息</span><span class="sxs-lookup"><span data-stu-id="30184-128">Posting and Sending Messages</span></span>](#posting-and-sending-messages)
    -   [<span data-ttu-id="30184-129">張貼訊息</span><span class="sxs-lookup"><span data-stu-id="30184-129">Posting Messages</span></span>](#posting-messages)
    -   [<span data-ttu-id="30184-130">傳送訊息</span><span class="sxs-lookup"><span data-stu-id="30184-130">Sending Messages</span></span>](#sending-messages)
-   [<span data-ttu-id="30184-131">訊息鎖死</span><span class="sxs-lookup"><span data-stu-id="30184-131">Message Deadlocks</span></span>](#message-deadlocks)
-   [<span data-ttu-id="30184-132">廣播訊息</span><span class="sxs-lookup"><span data-stu-id="30184-132">Broadcasting Messages</span></span>](#broadcasting-messages)
-   [<span data-ttu-id="30184-133">查詢訊息</span><span class="sxs-lookup"><span data-stu-id="30184-133">Query Messages</span></span>](#query-messages)

## <a name="windows-messages"></a><span data-ttu-id="30184-134">Windows 訊息</span><span class="sxs-lookup"><span data-stu-id="30184-134">Windows Messages</span></span>

<span data-ttu-id="30184-135">系統會以 *訊息* 的形式，將輸入傳遞至視窗程式。</span><span class="sxs-lookup"><span data-stu-id="30184-135">The system passes input to a window procedure in the form of a *message*.</span></span> <span data-ttu-id="30184-136">訊息是由系統和應用程式所產生。</span><span class="sxs-lookup"><span data-stu-id="30184-136">Messages are generated by both the system and applications.</span></span> <span data-ttu-id="30184-137">系統會在每個輸入事件（例如，當使用者輸入、移動滑鼠或按一下捲軸等控制項）時，產生一則訊息。</span><span class="sxs-lookup"><span data-stu-id="30184-137">The system generates a message at each input event—for example, when the user types, moves the mouse, or clicks a control such as a scroll bar.</span></span> <span data-ttu-id="30184-138">系統也會產生訊息，以回應應用程式所帶來的系統變更，例如當應用程式變更系統字型資源的集區，或調整其中一個視窗的大小時。</span><span class="sxs-lookup"><span data-stu-id="30184-138">The system also generates messages in response to changes in the system brought about by an application, such as when an application changes the pool of system font resources or resizes one of its windows.</span></span> <span data-ttu-id="30184-139">應用程式可以產生訊息，以導向自己的視窗來執行工作，或與其他應用程式中的 windows 進行通訊。</span><span class="sxs-lookup"><span data-stu-id="30184-139">An application can generate messages to direct its own windows to perform tasks or to communicate with windows in other applications.</span></span>

<span data-ttu-id="30184-140">系統會將訊息傳送至具有四個參數集合的視窗程式：視窗控制碼、訊息識別碼，以及兩個稱為 *訊息參數* 的值。</span><span class="sxs-lookup"><span data-stu-id="30184-140">The system sends a message to a window procedure with a set of four parameters: a window handle, a message identifier, and two values called *message parameters*.</span></span> <span data-ttu-id="30184-141">*視窗控制碼* 會識別訊息適用的視窗。</span><span class="sxs-lookup"><span data-stu-id="30184-141">The *window handle* identifies the window for which the message is intended.</span></span> <span data-ttu-id="30184-142">系統會使用它來判斷哪個視窗程式應該接收訊息。</span><span class="sxs-lookup"><span data-stu-id="30184-142">The system uses it to determine which window procedure should receive the message.</span></span>

<span data-ttu-id="30184-143">*訊息識別碼* 是識別訊息目的的命名常數。</span><span class="sxs-lookup"><span data-stu-id="30184-143">A *message identifier* is a named constant that identifies the purpose of a message.</span></span> <span data-ttu-id="30184-144">當視窗程式收到訊息時，它會使用訊息識別碼來判斷如何處理訊息。</span><span class="sxs-lookup"><span data-stu-id="30184-144">When a window procedure receives a message, it uses a message identifier to determine how to process the message.</span></span> <span data-ttu-id="30184-145">例如，訊息識別碼 [**WM \_ 油漆**](/windows/desktop/gdi/wm-paint) 會告知視窗程式，視窗的工作區已變更，必須重新繪製。</span><span class="sxs-lookup"><span data-stu-id="30184-145">For example, the message identifier [**WM\_PAINT**](/windows/desktop/gdi/wm-paint) tells the window procedure that the window's client area has changed and must be repainted.</span></span>

<span data-ttu-id="30184-146">訊息參數會指定資料或視窗程式在處理訊息時所使用的資料位置。</span><span class="sxs-lookup"><span data-stu-id="30184-146">Message parameters specify data or the location of data used by a window procedure when processing a message.</span></span> <span data-ttu-id="30184-147">訊息參數的意義和值取決於訊息。</span><span class="sxs-lookup"><span data-stu-id="30184-147">The meaning and value of the message parameters depend on the message.</span></span> <span data-ttu-id="30184-148">Message 參數可以包含整數、封裝的位旗標、包含其他資料之結構的指標等等。</span><span class="sxs-lookup"><span data-stu-id="30184-148">A message parameter can contain an integer, packed bit flags, a pointer to a structure containing additional data, and so on.</span></span> <span data-ttu-id="30184-149">當訊息未使用訊息參數時，通常會將其設定為 **Null**。</span><span class="sxs-lookup"><span data-stu-id="30184-149">When a message does not use message parameters, they are typically set to **NULL**.</span></span> <span data-ttu-id="30184-150">視窗程式必須檢查訊息識別碼，以判斷如何解讀訊息參數。</span><span class="sxs-lookup"><span data-stu-id="30184-150">A window procedure must check the message identifier to determine how to interpret the message parameters.</span></span>

## <a name="message-types"></a><span data-ttu-id="30184-151">訊息類型</span><span class="sxs-lookup"><span data-stu-id="30184-151">Message Types</span></span>

<span data-ttu-id="30184-152">本節說明兩種類型的訊息：</span><span class="sxs-lookup"><span data-stu-id="30184-152">This section describes the two types of messages:</span></span>

-   [<span data-ttu-id="30184-153">系統定義的訊息</span><span class="sxs-lookup"><span data-stu-id="30184-153">System-Defined Messages</span></span>](#system-defined-messages)
-   [<span data-ttu-id="30184-154">應用程式定義的訊息</span><span class="sxs-lookup"><span data-stu-id="30184-154">Application-Defined Messages</span></span>](#application-defined-messages)

### <a name="system-defined-messages"></a><span data-ttu-id="30184-155">System-Defined 訊息</span><span class="sxs-lookup"><span data-stu-id="30184-155">System-Defined Messages</span></span>

<span data-ttu-id="30184-156">系統在與應用程式通訊時，系統會傳送或張貼 *系統定義的訊息* 。</span><span class="sxs-lookup"><span data-stu-id="30184-156">The system sends or posts a *system-defined message* when it communicates with an application.</span></span> <span data-ttu-id="30184-157">它會使用這些訊息來控制應用程式的作業，並提供輸入和其他資訊讓應用程式進行處理。</span><span class="sxs-lookup"><span data-stu-id="30184-157">It uses these messages to control the operations of applications and to provide input and other information for applications to process.</span></span> <span data-ttu-id="30184-158">應用程式也可以傳送或張貼系統定義的訊息。</span><span class="sxs-lookup"><span data-stu-id="30184-158">An application can also send or post system-defined messages.</span></span> <span data-ttu-id="30184-159">應用程式通常會使用這些訊息來控制使用預先註冊視窗類別所建立之控制項視窗的操作。</span><span class="sxs-lookup"><span data-stu-id="30184-159">Applications generally use these messages to control the operation of control windows created by using preregistered window classes.</span></span>

<span data-ttu-id="30184-160">每個系統定義的訊息都有唯一的訊息識別碼和對應的符號常數 (在軟體發展工具組中定義， (SDK) 標頭檔) ，指出訊息的目的。</span><span class="sxs-lookup"><span data-stu-id="30184-160">Each system-defined message has a unique message identifier and a corresponding symbolic constant (defined in the software development kit (SDK) header files) that states the purpose of the message.</span></span> <span data-ttu-id="30184-161">例如， [**WM \_ 油漆**](/windows/desktop/gdi/wm-paint) 常數要求視窗繪製其內容。</span><span class="sxs-lookup"><span data-stu-id="30184-161">For example, the [**WM\_PAINT**](/windows/desktop/gdi/wm-paint) constant requests that a window paint its contents.</span></span>

<span data-ttu-id="30184-162">符號常數指定系統定義的訊息所屬的分類。</span><span class="sxs-lookup"><span data-stu-id="30184-162">Symbolic constants specify the category to which system-defined messages belong.</span></span> <span data-ttu-id="30184-163">常數的前置詞會識別可解讀和處理訊息的視窗類型。</span><span class="sxs-lookup"><span data-stu-id="30184-163">The prefix of the constant identifies the type of window that can interpret and process the message.</span></span> <span data-ttu-id="30184-164">以下是首碼及其相關的訊息類別。</span><span class="sxs-lookup"><span data-stu-id="30184-164">Following are the prefixes and their related message categories.</span></span>



| <span data-ttu-id="30184-165">前置詞</span><span class="sxs-lookup"><span data-stu-id="30184-165">Prefix</span></span>                               | <span data-ttu-id="30184-166">訊息類別</span><span class="sxs-lookup"><span data-stu-id="30184-166">Message category</span></span>             | <span data-ttu-id="30184-167">文件</span><span class="sxs-lookup"><span data-stu-id="30184-167">Documentation</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|--------------------------------------|------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="30184-168">**ABM** 和 **ABN**</span><span class="sxs-lookup"><span data-stu-id="30184-168">**ABM** and **ABN**</span></span>                  | <span data-ttu-id="30184-169">應用程式桌面工具列</span><span class="sxs-lookup"><span data-stu-id="30184-169">Application desktop toolbar</span></span>  | [<span data-ttu-id="30184-170">Shell 訊息和通知</span><span class="sxs-lookup"><span data-stu-id="30184-170">Shell Messages and Notifications</span></span>](/windows/desktop/shell/control-panel-applications)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| <span data-ttu-id="30184-171"> **ACN**</span><span class="sxs-lookup"><span data-stu-id="30184-171">**ACM** and **ACN**</span></span>                  | <span data-ttu-id="30184-172">動畫控制項</span><span class="sxs-lookup"><span data-stu-id="30184-172">Animation control</span></span>            | <span data-ttu-id="30184-173">[動畫控制項訊息](/windows/desktop/Controls/bumper-animation-control-reference-messages) 和 [動畫控制項通知](/windows/desktop/Controls/bumper-animation-control-reference-notifications)</span><span class="sxs-lookup"><span data-stu-id="30184-173">[Animation Control Messages](/windows/desktop/Controls/bumper-animation-control-reference-messages) and [Animation Control Notifications](/windows/desktop/Controls/bumper-animation-control-reference-notifications)</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| <span data-ttu-id="30184-174">**BCM**、 **BCN**、 **BM** 和 **BN**</span><span class="sxs-lookup"><span data-stu-id="30184-174">**BCM**, **BCN**, **BM**, and **BN**</span></span> | <span data-ttu-id="30184-175">Button 控制項</span><span class="sxs-lookup"><span data-stu-id="30184-175">Button control</span></span>               | <span data-ttu-id="30184-176">[按鈕控制項訊息](/windows/desktop/Controls/bumper-button-control-reference-messages) 和 [按鈕控制項通知](/windows/desktop/Controls/bumper-button-control-reference-notifications)</span><span class="sxs-lookup"><span data-stu-id="30184-176">[Button Control Messages](/windows/desktop/Controls/bumper-button-control-reference-messages) and [Button Control Notifications](/windows/desktop/Controls/bumper-button-control-reference-notifications)</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| <span data-ttu-id="30184-177">**CB** 和 **CBN**</span><span class="sxs-lookup"><span data-stu-id="30184-177">**CB** and **CBN**</span></span>                   | <span data-ttu-id="30184-178">ComboBox 控制項</span><span class="sxs-lookup"><span data-stu-id="30184-178">ComboBox control</span></span>             | <span data-ttu-id="30184-179">[Combobox 控制項訊息](/windows/desktop/Controls/bumper-combobox-control-reference-messages) 和 [combobox 控制項通知](/windows/desktop/Controls/bumper-combobox-control-reference-notifications)</span><span class="sxs-lookup"><span data-stu-id="30184-179">[ComboBox Control Messages](/windows/desktop/Controls/bumper-combobox-control-reference-messages) and [ComboBox Control Notifications](/windows/desktop/Controls/bumper-combobox-control-reference-notifications)</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| <span data-ttu-id="30184-180">**CBEM** 和 **CBEN**</span><span class="sxs-lookup"><span data-stu-id="30184-180">**CBEM** and **CBEN**</span></span>                | <span data-ttu-id="30184-181">ComboBoxEx 控制項</span><span class="sxs-lookup"><span data-stu-id="30184-181">ComboBoxEx control</span></span>           | <span data-ttu-id="30184-182">[ComboBoxEx 訊息](/windows/desktop/Controls/bumper-comboboxex-control-reference-messages) 和 [ComboBoxEx 通知](/windows/desktop/Controls/bumper-comboboxex-control-reference-notifications)</span><span class="sxs-lookup"><span data-stu-id="30184-182">[ComboBoxEx Messages](/windows/desktop/Controls/bumper-comboboxex-control-reference-messages) and [ComboBoxEx Notifications](/windows/desktop/Controls/bumper-comboboxex-control-reference-notifications)</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| <span data-ttu-id="30184-183">**Ccm**</span><span class="sxs-lookup"><span data-stu-id="30184-183">**CCM**</span></span>                              | <span data-ttu-id="30184-184">一般控制項</span><span class="sxs-lookup"><span data-stu-id="30184-184">General control</span></span>              | [<span data-ttu-id="30184-185">控制訊息</span><span class="sxs-lookup"><span data-stu-id="30184-185">Control Messages</span></span>](/windows/desktop/Controls/bumper-general-control-reference-messages)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| <span data-ttu-id="30184-186">**CDM**</span><span class="sxs-lookup"><span data-stu-id="30184-186">**CDM**</span></span>                              | <span data-ttu-id="30184-187">通用對話方塊</span><span class="sxs-lookup"><span data-stu-id="30184-187">Common dialog box</span></span>            | [<span data-ttu-id="30184-188">一般對話方塊訊息</span><span class="sxs-lookup"><span data-stu-id="30184-188">Common Dialog Box Messages</span></span>](/windows/desktop/dlgbox/common-dialog-box-messages)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| <span data-ttu-id="30184-189">**Dfm**</span><span class="sxs-lookup"><span data-stu-id="30184-189">**DFM**</span></span>                              | <span data-ttu-id="30184-190">預設內容功能表</span><span class="sxs-lookup"><span data-stu-id="30184-190">Default context menu</span></span>         | [<span data-ttu-id="30184-191">Shell 訊息和通知</span><span class="sxs-lookup"><span data-stu-id="30184-191">Shell Messages and Notifications</span></span>](/windows/desktop/shell/control-panel-applications)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| <span data-ttu-id="30184-192">**DL**</span><span class="sxs-lookup"><span data-stu-id="30184-192">**DL**</span></span>                               | <span data-ttu-id="30184-193">拖曳清單方塊</span><span class="sxs-lookup"><span data-stu-id="30184-193">Drag list box</span></span>                | <span data-ttu-id="30184-194">[拖曳清單方塊通知](/previous-versions//ff485914(v=vs.85))</span><span class="sxs-lookup"><span data-stu-id="30184-194">[Drag List Box Notifications](/previous-versions//ff485914(v=vs.85))</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| <span data-ttu-id="30184-195">**DM**</span><span class="sxs-lookup"><span data-stu-id="30184-195">**DM**</span></span>                               | <span data-ttu-id="30184-196">預設的推播按鈕控制項</span><span class="sxs-lookup"><span data-stu-id="30184-196">Default push button control</span></span>  | [<span data-ttu-id="30184-197">對話方塊訊息</span><span class="sxs-lookup"><span data-stu-id="30184-197">Dialog Box Messages</span></span>](/windows/desktop/dlgbox/dialog-box-messages)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| <span data-ttu-id="30184-198">**DTM** 和 **DTN**</span><span class="sxs-lookup"><span data-stu-id="30184-198">**DTM** and **DTN**</span></span>                  | <span data-ttu-id="30184-199">日期和時間選擇器控制項</span><span class="sxs-lookup"><span data-stu-id="30184-199">Date and time picker control</span></span> | <span data-ttu-id="30184-200">[日期和時間選擇器訊息](/windows/desktop/Controls/bumper-date-and-time-picker-control-reference-messages) 和 [日期和時間選擇器通知](/windows/desktop/Controls/bumper-date-and-time-picker-control-reference-notifications)</span><span class="sxs-lookup"><span data-stu-id="30184-200">[Date and Time Picker Messages](/windows/desktop/Controls/bumper-date-and-time-picker-control-reference-messages) and [Date and Time Picker Notifications](/windows/desktop/Controls/bumper-date-and-time-picker-control-reference-notifications)</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| <span data-ttu-id="30184-201">**EM** 和 **EN**</span><span class="sxs-lookup"><span data-stu-id="30184-201">**EM** and **EN**</span></span>                    | <span data-ttu-id="30184-202">編輯控制項</span><span class="sxs-lookup"><span data-stu-id="30184-202">Edit control</span></span>                 | <span data-ttu-id="30184-203">[編輯控制訊息](/windows/desktop/Controls/bumper-edit-control-reference-messages)、 [編輯控制項通知](/windows/desktop/Controls/bumper-edit-control-reference-notifications)、 [豐富的編輯訊息](/windows/desktop/Controls/bumper-rich-edit-control-reference-messages)，以及 [豐富的編輯通知](/windows/desktop/Controls/bumper-rich-edit-control-reference-notifications)</span><span class="sxs-lookup"><span data-stu-id="30184-203">[Edit Control Messages](/windows/desktop/Controls/bumper-edit-control-reference-messages), [Edit Control Notifications](/windows/desktop/Controls/bumper-edit-control-reference-notifications), [Rich Edit Messages](/windows/desktop/Controls/bumper-rich-edit-control-reference-messages), and [Rich Edit Notifications](/windows/desktop/Controls/bumper-rich-edit-control-reference-notifications)</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| <span data-ttu-id="30184-204">**HDM** 和 **HDN**</span><span class="sxs-lookup"><span data-stu-id="30184-204">**HDM** and **HDN**</span></span>                  | <span data-ttu-id="30184-205">標題控制項</span><span class="sxs-lookup"><span data-stu-id="30184-205">Header control</span></span>               | <span data-ttu-id="30184-206">[標題控制項訊息](/windows/desktop/Controls/bumper-header-control-reference-messages) 和 [標頭控制項通知](/windows/desktop/Controls/bumper-header-control-reference-notifications)</span><span class="sxs-lookup"><span data-stu-id="30184-206">[Header Control Messages](/windows/desktop/Controls/bumper-header-control-reference-messages) and [Header Control Notifications](/windows/desktop/Controls/bumper-header-control-reference-notifications)</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| <span data-ttu-id="30184-207">**HKM**</span><span class="sxs-lookup"><span data-stu-id="30184-207">**HKM**</span></span>                              | <span data-ttu-id="30184-208">快速鍵控制項</span><span class="sxs-lookup"><span data-stu-id="30184-208">Hot key control</span></span>              | [<span data-ttu-id="30184-209">快速鍵控制訊息</span><span class="sxs-lookup"><span data-stu-id="30184-209">Hot Key Control Messages</span></span>](/windows/desktop/Controls/bumper-hot-key-control-reference-messages)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| <span data-ttu-id="30184-210">**IPM** 和 **IPN**</span><span class="sxs-lookup"><span data-stu-id="30184-210">**IPM** and **IPN**</span></span>                  | <span data-ttu-id="30184-211">IP 位址控制項</span><span class="sxs-lookup"><span data-stu-id="30184-211">IP address control</span></span>           | <span data-ttu-id="30184-212">[Ip 位址消息](/windows/desktop/Controls/bumper-ip-address-control-reference-messages) 和 [ip 位址通知](/windows/desktop/Controls/bumper-ip-address-control-reference-notifications)</span><span class="sxs-lookup"><span data-stu-id="30184-212">[IP Address Messages](/windows/desktop/Controls/bumper-ip-address-control-reference-messages) and [IP Address Notifications](/windows/desktop/Controls/bumper-ip-address-control-reference-notifications)</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| <span data-ttu-id="30184-213">**LB** 和 **LBN**</span><span class="sxs-lookup"><span data-stu-id="30184-213">**LB** and **LBN**</span></span>                   | <span data-ttu-id="30184-214">清單方塊控制項</span><span class="sxs-lookup"><span data-stu-id="30184-214">List box control</span></span>             | <span data-ttu-id="30184-215">[清單方塊訊息](/windows/desktop/Controls/bumper-list-box-control-reference-messages) 和 [清單方塊通知](/windows/desktop/Controls/bumper-list-box-control-reference-notifications)</span><span class="sxs-lookup"><span data-stu-id="30184-215">[List Box Messages](/windows/desktop/Controls/bumper-list-box-control-reference-messages) and [List Box Notifications](/windows/desktop/Controls/bumper-list-box-control-reference-notifications)</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| <span data-ttu-id="30184-216">**LM**</span><span class="sxs-lookup"><span data-stu-id="30184-216">**LM**</span></span>                               | <span data-ttu-id="30184-217">SysLink 控制項</span><span class="sxs-lookup"><span data-stu-id="30184-217">SysLink control</span></span>              | [<span data-ttu-id="30184-218">SysLink 控制訊息</span><span class="sxs-lookup"><span data-stu-id="30184-218">SysLink Control Messages</span></span>](/windows/desktop/Controls/bumper-syslink-control-reference-messages)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| <span data-ttu-id="30184-219">**LVM** 和 **LVN**</span><span class="sxs-lookup"><span data-stu-id="30184-219">**LVM** and **LVN**</span></span>                  | <span data-ttu-id="30184-220">清單視圖控制項</span><span class="sxs-lookup"><span data-stu-id="30184-220">List view control</span></span>            | <span data-ttu-id="30184-221">[列出視圖訊息](/windows/desktop/Controls/bumper-list-view-control-reference-messages) 和 [清單視圖通知](/windows/desktop/Controls/bumper-list-view-control-reference-notifications)</span><span class="sxs-lookup"><span data-stu-id="30184-221">[List View Messages](/windows/desktop/Controls/bumper-list-view-control-reference-messages) and [List View Notifications](/windows/desktop/Controls/bumper-list-view-control-reference-notifications)</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| <span data-ttu-id="30184-222">**MCM** 和 **MCN**</span><span class="sxs-lookup"><span data-stu-id="30184-222">**MCM** and **MCN**</span></span>                  | <span data-ttu-id="30184-223">月曆控制項</span><span class="sxs-lookup"><span data-stu-id="30184-223">Month calendar control</span></span>       | <span data-ttu-id="30184-224">月曆的[電子郵件](/windows/desktop/Controls/bumper-month-calendar-control-reference-messages)和[月份行事曆通知](/windows/desktop/Controls/bumper-month-calendar-control-reference-notifications)</span><span class="sxs-lookup"><span data-stu-id="30184-224">[Month Calendar Messages](/windows/desktop/Controls/bumper-month-calendar-control-reference-messages) and [Month Calendar Notifications](/windows/desktop/Controls/bumper-month-calendar-control-reference-notifications)</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| <span data-ttu-id="30184-225">**PBM**</span><span class="sxs-lookup"><span data-stu-id="30184-225">**PBM**</span></span>                              | <span data-ttu-id="30184-226">進度列</span><span class="sxs-lookup"><span data-stu-id="30184-226">Progress bar</span></span>                 | [<span data-ttu-id="30184-227">進度列訊息</span><span class="sxs-lookup"><span data-stu-id="30184-227">Progress Bar Messages</span></span>](/windows/desktop/Controls/bumper-progress-bar-control-reference-messages)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| <span data-ttu-id="30184-228">**PGM** 和 **PGN**</span><span class="sxs-lookup"><span data-stu-id="30184-228">**PGM** and **PGN**</span></span>                  | <span data-ttu-id="30184-229">呼機控制項</span><span class="sxs-lookup"><span data-stu-id="30184-229">Pager control</span></span>                | <span data-ttu-id="30184-230">[呼機控制訊息](/windows/desktop/Controls/bumper-pager-control-reference-messages) 和頁面 [控制項通知](/windows/desktop/Controls/bumper-pager-control-reference-notifications)</span><span class="sxs-lookup"><span data-stu-id="30184-230">[Pager Control Messages](/windows/desktop/Controls/bumper-pager-control-reference-messages) and [Pager Control Notifications](/windows/desktop/Controls/bumper-pager-control-reference-notifications)</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| <span data-ttu-id="30184-231">**PSM** 和 **PSN**</span><span class="sxs-lookup"><span data-stu-id="30184-231">**PSM** and **PSN**</span></span>                  | <span data-ttu-id="30184-232">屬性工作表</span><span class="sxs-lookup"><span data-stu-id="30184-232">Property sheet</span></span>               | <span data-ttu-id="30184-233">[屬性工作表訊息](/windows/desktop/Controls/bumper-property-sheets-reference-messages) 和 [屬性工作表通知](/windows/desktop/Controls/bumper-property-sheets-reference-notifications)</span><span class="sxs-lookup"><span data-stu-id="30184-233">[Property Sheet Messages](/windows/desktop/Controls/bumper-property-sheets-reference-messages) and [Property Sheet Notifications](/windows/desktop/Controls/bumper-property-sheets-reference-notifications)</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| <span data-ttu-id="30184-234">**RB** 和 **RBN**</span><span class="sxs-lookup"><span data-stu-id="30184-234">**RB** and **RBN**</span></span>                   | <span data-ttu-id="30184-235">Rebar 控制項</span><span class="sxs-lookup"><span data-stu-id="30184-235">Rebar control</span></span>                | <span data-ttu-id="30184-236">[Rebar 控制項訊息](/windows/desktop/Controls/bumper-rebar-control-reference-messages) 和 [Rebar 控制項通知](/windows/desktop/Controls/bumper-rebar-control-reference-notifications)</span><span class="sxs-lookup"><span data-stu-id="30184-236">[Rebar Control Messages](/windows/desktop/Controls/bumper-rebar-control-reference-messages) and [Rebar Control Notifications](/windows/desktop/Controls/bumper-rebar-control-reference-notifications)</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| <span data-ttu-id="30184-237">**SB** 和 **SBN**</span><span class="sxs-lookup"><span data-stu-id="30184-237">**SB** and **SBN**</span></span>                   | <span data-ttu-id="30184-238">狀態列視窗</span><span class="sxs-lookup"><span data-stu-id="30184-238">Status bar window</span></span>            | <span data-ttu-id="30184-239">[狀態列訊息](/windows/desktop/Controls/bumper-status-bars-reference-messages) 和 [狀態列通知](/windows/desktop/Controls/bumper-status-bars-reference-notifications)</span><span class="sxs-lookup"><span data-stu-id="30184-239">[Status Bar Messages](/windows/desktop/Controls/bumper-status-bars-reference-messages) and [Status Bar Notifications](/windows/desktop/Controls/bumper-status-bars-reference-notifications)</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| <span data-ttu-id="30184-240">**SBM**</span><span class="sxs-lookup"><span data-stu-id="30184-240">**SBM**</span></span>                              | <span data-ttu-id="30184-241">捲軸控制項</span><span class="sxs-lookup"><span data-stu-id="30184-241">Scroll bar control</span></span>           | [<span data-ttu-id="30184-242">捲軸訊息</span><span class="sxs-lookup"><span data-stu-id="30184-242">Scroll Bar Messages</span></span>](/windows/desktop/Controls/bumper-scroll-bars-reference-messages)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| <span data-ttu-id="30184-243">**Smc**</span><span class="sxs-lookup"><span data-stu-id="30184-243">**SMC**</span></span>                              | <span data-ttu-id="30184-244">Shell 功能表</span><span class="sxs-lookup"><span data-stu-id="30184-244">Shell menu</span></span>                   | [<span data-ttu-id="30184-245">Shell 訊息和通知</span><span class="sxs-lookup"><span data-stu-id="30184-245">Shell Messages and Notifications</span></span>](/windows/desktop/shell/control-panel-applications)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| <span data-ttu-id="30184-246">**STM** 和 **STN**</span><span class="sxs-lookup"><span data-stu-id="30184-246">**STM** and **STN**</span></span>                  | <span data-ttu-id="30184-247">靜態控制項</span><span class="sxs-lookup"><span data-stu-id="30184-247">Static control</span></span>               | <span data-ttu-id="30184-248">[靜態控制訊息](/windows/desktop/Controls/bumper-static-control-reference-messages) 和 [靜態控制項通知](/windows/desktop/Controls/bumper-static-control-reference-notifications)</span><span class="sxs-lookup"><span data-stu-id="30184-248">[Static Control Messages](/windows/desktop/Controls/bumper-static-control-reference-messages) and [Static Control Notifications](/windows/desktop/Controls/bumper-static-control-reference-notifications)</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| <span data-ttu-id="30184-249">**TB** 和 **TBN**</span><span class="sxs-lookup"><span data-stu-id="30184-249">**TB** and **TBN**</span></span>                   | <span data-ttu-id="30184-250">工具列</span><span class="sxs-lookup"><span data-stu-id="30184-250">Toolbar</span></span>                      | <span data-ttu-id="30184-251">[Toolbar 控制項訊息](/windows/desktop/Controls/bumper-toolbar-control-reference-messages) 和 [工具列控制項通知](/windows/desktop/Controls/bumper-toolbar-control-reference-notifications)</span><span class="sxs-lookup"><span data-stu-id="30184-251">[Toolbar Control Messages](/windows/desktop/Controls/bumper-toolbar-control-reference-messages) and [Toolbar Control Notifications](/windows/desktop/Controls/bumper-toolbar-control-reference-notifications)</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| <span data-ttu-id="30184-252">**TBM** 和 **TRBN**</span><span class="sxs-lookup"><span data-stu-id="30184-252">**TBM** and **TRBN**</span></span>                 | <span data-ttu-id="30184-253">[控制項] 控制項</span><span class="sxs-lookup"><span data-stu-id="30184-253">Trackbar control</span></span>             | <span data-ttu-id="30184-254">[[資訊管理] 控制項訊息](/windows/desktop/Controls/bumper-trackbar-control-reference-messages)和 [[跟蹤] 控制項通知](/windows/desktop/Controls/bumper-trackbar-control-reference-notifications)</span><span class="sxs-lookup"><span data-stu-id="30184-254">[Trackbar Control Messages](/windows/desktop/Controls/bumper-trackbar-control-reference-messages) and [Trackbar Control Notifications](/windows/desktop/Controls/bumper-trackbar-control-reference-notifications)</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| <span data-ttu-id="30184-255">**TCM** 和 **TCN**</span><span class="sxs-lookup"><span data-stu-id="30184-255">**TCM** and **TCN**</span></span>                  | <span data-ttu-id="30184-256">索引標籤控制項</span><span class="sxs-lookup"><span data-stu-id="30184-256">Tab control</span></span>                  | <span data-ttu-id="30184-257">[選項卡控制訊息](/windows/desktop/Controls/bumper-tab-control-reference-messages) 和 [索引標籤控制項通知](/windows/desktop/Controls/bumper-tab-control-reference-notifications)</span><span class="sxs-lookup"><span data-stu-id="30184-257">[Tab Control Messages](/windows/desktop/Controls/bumper-tab-control-reference-messages) and [Tab Control Notifications](/windows/desktop/Controls/bumper-tab-control-reference-notifications)</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| <span data-ttu-id="30184-258">**TDM** 和 **TDN**</span><span class="sxs-lookup"><span data-stu-id="30184-258">**TDM** and **TDN**</span></span>                  | <span data-ttu-id="30184-259">工作對話方塊</span><span class="sxs-lookup"><span data-stu-id="30184-259">Task dialog</span></span>                  | <span data-ttu-id="30184-260">工作[對話方塊訊息](/windows/desktop/Controls/bumper-task-dialogs-reference-messages)和工作[對話方塊通知](/windows/desktop/Controls/bumper-task-dialogs-reference-notifications)</span><span class="sxs-lookup"><span data-stu-id="30184-260">[Task Dialog Messages](/windows/desktop/Controls/bumper-task-dialogs-reference-messages) and [Task Dialog Notifications](/windows/desktop/Controls/bumper-task-dialogs-reference-notifications)</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| <span data-ttu-id="30184-261">**TTM** 和 **TTN**</span><span class="sxs-lookup"><span data-stu-id="30184-261">**TTM** and **TTN**</span></span>                  | <span data-ttu-id="30184-262">Tooltip 控制項</span><span class="sxs-lookup"><span data-stu-id="30184-262">Tooltip control</span></span>              | <span data-ttu-id="30184-263">[工具提示控制項訊息](/windows/desktop/Controls/bumper-tooltip-control-reference-messages) 和 [工具提示控制項通知](/windows/desktop/Controls/bumper-tooltip-control-reference-notifications)</span><span class="sxs-lookup"><span data-stu-id="30184-263">[Tooltip Control Messages](/windows/desktop/Controls/bumper-tooltip-control-reference-messages) and [Tooltip Control Notifications](/windows/desktop/Controls/bumper-tooltip-control-reference-notifications)</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| <span data-ttu-id="30184-264">**TVM** 和 **izdebski**</span><span class="sxs-lookup"><span data-stu-id="30184-264">**TVM** and **TVN**</span></span>                  | <span data-ttu-id="30184-265">樹狀檢視控制項</span><span class="sxs-lookup"><span data-stu-id="30184-265">Tree-view control</span></span>            | <span data-ttu-id="30184-266">[樹狀檢視訊息](/windows/desktop/Controls/bumper-tree-view-control-reference-messages) 和 [樹狀檢視通知](/windows/desktop/Controls/bumper-tree-view-control-reference-notifications)</span><span class="sxs-lookup"><span data-stu-id="30184-266">[Tree View Messages](/windows/desktop/Controls/bumper-tree-view-control-reference-messages) and [Tree View Notifications](/windows/desktop/Controls/bumper-tree-view-control-reference-notifications)</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| <span data-ttu-id="30184-267">**UDM** 和 **UDN**</span><span class="sxs-lookup"><span data-stu-id="30184-267">**UDM** and **UDN**</span></span>                  | <span data-ttu-id="30184-268">由上而下控制項</span><span class="sxs-lookup"><span data-stu-id="30184-268">Up-down control</span></span>              | <span data-ttu-id="30184-269">[由上而下的訊息](/windows/desktop/Controls/bumper-up-down-control-reference-messages) 和 [向上通知](/windows/desktop/Controls/bumper-up-down-control-reference-notifications)</span><span class="sxs-lookup"><span data-stu-id="30184-269">[Up-Down Messages](/windows/desktop/Controls/bumper-up-down-control-reference-messages) and [Up-Down Notifications](/windows/desktop/Controls/bumper-up-down-control-reference-notifications)</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| <span data-ttu-id="30184-270">**Wm**</span><span class="sxs-lookup"><span data-stu-id="30184-270">**WM**</span></span>                               | <span data-ttu-id="30184-271">一般</span><span class="sxs-lookup"><span data-stu-id="30184-271">General</span></span>                      | <dl> <span data-ttu-id="30184-272"><dt>[剪貼簿訊息](/windows/desktop/dataxchg/clipboard-messages)</dt><dt>[剪貼簿通知](/windows/desktop/dataxchg/clipboard-notifications)</dt><dt>[一般對話方塊](/windows/desktop/dlgbox/common-dialog-box-notifications)</dt>通知資料<dt>[指標](/windows/desktop/menurc/cursor-notifications)</dt>通知<dt>[資料](/windows/desktop/dataxchg/wm-copydata)</dt><dt>[裝置管理訊息](/windows/desktop/DevIO/device-management-messages)</dt><dt>[對話方塊通知](/windows/desktop/dlgbox/dialog-box-notifications)</dt>的<dt>[桌面視窗管理員訊息](/windows/desktop/dwm/dwm-messages)</dt><dt>[動態資料交換訊息](/windows/desktop/dataxchg/dynamic-data-exchange-messages)</dt><dt>[動態資料交換通知](/windows/desktop/dataxchg/dynamic-data-exchange-notifications)</dt>攔截<dt>[通知](hook-notifications.md)</dt><dt>[鍵盤快捷](/windows/desktop/menurc/keyboard-accelerator-messages)</dt>功能表通知鍵盤<dt>[快捷](/windows/desktop/menurc/keyboard-accelerator-notifications)</dt>功能表通知<dt>[鍵盤輸入訊息](/windows/desktop/inputdev/keyboard-input-messages)</dt><dt>[鍵盤輸入](/windows/desktop/inputdev/keyboard-input-notifications)</dt>通知<dt>[功能表通知](/windows/desktop/menurc/menu-notifications)</dt><dt>[滑鼠輸入通知](/windows/desktop/inputdev/mouse-input-notifications)</dt><dt>[多個檔介面訊息](multiple-document-interface-messages.md)</dt><dt>[原始輸入通知](/windows/desktop/inputdev/raw-input-notifications)</dt><dt>[捲軸通知](/windows/desktop/Controls/bumper-scroll-bars-reference-notifications)</dt><dt>[計時器通知](timer-notifications.md)</dt><dt>[視窗訊息](window-messages.md)</dt><dt>[視窗通知](window-notifications.md)</dt></span><span class="sxs-lookup"><span data-stu-id="30184-272"><dt>[Clipboard Messages](/windows/desktop/dataxchg/clipboard-messages)</dt> <dt>[Clipboard Notifications](/windows/desktop/dataxchg/clipboard-notifications)</dt> <dt>[Common Dialog Box Notifications](/windows/desktop/dlgbox/common-dialog-box-notifications)</dt> <dt>[Cursor Notifications](/windows/desktop/menurc/cursor-notifications)</dt> <dt>[Data Copy Message](/windows/desktop/dataxchg/wm-copydata)</dt> <dt>[Desktop Window Manager Messages](/windows/desktop/dwm/dwm-messages)</dt> <dt>[Device Management Messages](/windows/desktop/DevIO/device-management-messages)</dt> <dt>[Dialog Box Notifications](/windows/desktop/dlgbox/dialog-box-notifications)</dt> <dt>[Dynamic Data Exchange Messages](/windows/desktop/dataxchg/dynamic-data-exchange-messages)</dt> <dt>[Dynamic Data Exchange Notifications](/windows/desktop/dataxchg/dynamic-data-exchange-notifications)</dt> <dt>[Hook Notifications](hook-notifications.md)</dt> <dt>[Keyboard Accelerator Messages](/windows/desktop/menurc/keyboard-accelerator-messages)</dt> <dt>[Keyboard Accelerator Notifications](/windows/desktop/menurc/keyboard-accelerator-notifications)</dt> <dt>[Keyboard Input Messages](/windows/desktop/inputdev/keyboard-input-messages)</dt> <dt>[Keyboard Input Notifications](/windows/desktop/inputdev/keyboard-input-notifications)</dt> <dt>[Menu Notifications](/windows/desktop/menurc/menu-notifications)</dt> <dt>[Mouse Input Notifications](/windows/desktop/inputdev/mouse-input-notifications)</dt> <dt>[Multiple Document Interface Messages](multiple-document-interface-messages.md)</dt> <dt>[Raw Input Notifications](/windows/desktop/inputdev/raw-input-notifications)</dt> <dt>[Scroll Bar Notifications](/windows/desktop/Controls/bumper-scroll-bars-reference-notifications)</dt> <dt>[Timer Notifications](timer-notifications.md)</dt> <dt>[Window Messages](window-messages.md)</dt> <dt>[Window Notifications](window-notifications.md)</dt></span></span> </dl> |



 

<span data-ttu-id="30184-273">一般視窗訊息涵蓋範圍廣泛的資訊和要求，包括滑鼠和鍵盤輸入的訊息、功能表和對話方塊輸入、視窗建立和管理，以及動態資料交換 (的 DDE) 。</span><span class="sxs-lookup"><span data-stu-id="30184-273">General window messages cover a wide range of information and requests, including messages for mouse and keyboard input, menu and dialog box input, window creation and management, and Dynamic Data Exchange (DDE).</span></span>

### <a name="application-defined-messages"></a><span data-ttu-id="30184-274">Application-Defined 訊息</span><span class="sxs-lookup"><span data-stu-id="30184-274">Application-Defined Messages</span></span>

<span data-ttu-id="30184-275">應用程式可以建立訊息，供自己的視窗使用，或與其他進程中的 windows 進行通訊。</span><span class="sxs-lookup"><span data-stu-id="30184-275">An application can create messages to be used by its own windows or to communicate with windows in other processes.</span></span> <span data-ttu-id="30184-276">如果應用程式建立自己的訊息，接收這些訊息的視窗程式必須解讀訊息並提供適當的處理。</span><span class="sxs-lookup"><span data-stu-id="30184-276">If an application creates its own messages, the window procedure that receives them must interpret the messages and provide appropriate processing.</span></span>

<span data-ttu-id="30184-277">訊息識別碼值的使用方式如下：</span><span class="sxs-lookup"><span data-stu-id="30184-277">Message-identifier values are used as follows:</span></span>

-   <span data-ttu-id="30184-278">系統會將訊息識別碼值保留在0x0000 到0x03FF 的範圍中， (系統定義之訊息的 [**WM \_ USER**](wm-user.md)  – 1) 的值。</span><span class="sxs-lookup"><span data-stu-id="30184-278">The system reserves message-identifier values in the range 0x0000 through 0x03FF (the value of [**WM\_USER**](wm-user.md)  – 1) for system-defined messages.</span></span> <span data-ttu-id="30184-279">應用程式無法將這些值用於私用訊息。</span><span class="sxs-lookup"><span data-stu-id="30184-279">Applications cannot use these values for private messages.</span></span>
-   <span data-ttu-id="30184-280">範圍0x0400 中的值 ([**WM \_ 使用者**](wm-user.md)) 到0x7FFF 的值，適用于私用視窗類別的訊息識別碼。</span><span class="sxs-lookup"><span data-stu-id="30184-280">Values in the range 0x0400 (the value of [**WM\_USER**](wm-user.md)) through 0x7FFF are available for message identifiers for private window classes.</span></span>
-   <span data-ttu-id="30184-281">如果您的應用程式標示為4.0 版，您可以在私用訊息的0xBFFF 中，使用位於 0x8000 ([**WM \_ 應用程式**](wm-app.md)) 範圍內的訊息識別碼值。</span><span class="sxs-lookup"><span data-stu-id="30184-281">If your application is marked version 4.0, you can use message-identifier values in the range 0x8000 ([**WM\_APP**](wm-app.md)) through 0xBFFF for private messages.</span></span>
-   <span data-ttu-id="30184-282">當應用程式呼叫 [**RegisterWindowMessage**](/windows/win32/api/winuser/nf-winuser-registerwindowmessagea) 函式來註冊訊息時，系統會傳回0XC000 至0xffff 範圍內的訊息識別碼。</span><span class="sxs-lookup"><span data-stu-id="30184-282">The system returns a message identifier in the range 0xC000 through 0xFFFF when an application calls the [**RegisterWindowMessage**](/windows/win32/api/winuser/nf-winuser-registerwindowmessagea) function to register a message.</span></span> <span data-ttu-id="30184-283">在整個系統中，此函式所傳回的訊息識別碼保證是唯一的。</span><span class="sxs-lookup"><span data-stu-id="30184-283">The message identifier returned by this function is guaranteed to be unique throughout the system.</span></span> <span data-ttu-id="30184-284">使用此函式可防止當其他應用程式基於不同用途使用相同的訊息識別碼時，可能發生的衝突。</span><span class="sxs-lookup"><span data-stu-id="30184-284">Use of this function prevents conflicts that can arise if other applications use the same message identifier for different purposes.</span></span>

## <a name="message-routing"></a><span data-ttu-id="30184-285">訊息路由</span><span class="sxs-lookup"><span data-stu-id="30184-285">Message Routing</span></span>

<span data-ttu-id="30184-286">系統會使用兩種方法來將訊息路由傳送至視窗程式：將訊息張貼至先進先出佇列（稱為 *訊息佇列*）、系統定義的記憶體物件，以暫時儲存訊息，以及將訊息直接傳送至視窗程式。</span><span class="sxs-lookup"><span data-stu-id="30184-286">The system uses two methods to route messages to a window procedure: posting messages to a first-in, first-out queue called a *message queue*, a system-defined memory object that temporarily stores messages, and sending messages directly to a window procedure.</span></span>

<span data-ttu-id="30184-287">張貼到訊息佇列的訊息稱為 *佇列訊息*。</span><span class="sxs-lookup"><span data-stu-id="30184-287">A messages that is posted to a message queue is called a *queued message*.</span></span> <span data-ttu-id="30184-288">這些主要是透過滑鼠或鍵盤輸入使用者輸入的結果，例如 [**wm \_ MOUSEMOVE**](/windows/desktop/inputdev/wm-mousemove)、 [**wm \_ LBUTTONDOWN**](/windows/desktop/inputdev/wm-lbuttondown)、 [**wm \_ KEYDOWN**](/windows/desktop/inputdev/wm-keydown)和 [**wm \_ 字元**](/windows/desktop/inputdev/wm-char) 訊息。</span><span class="sxs-lookup"><span data-stu-id="30184-288">These are primarily the result of user input entered through the mouse or keyboard, such as [**WM\_MOUSEMOVE**](/windows/desktop/inputdev/wm-mousemove), [**WM\_LBUTTONDOWN**](/windows/desktop/inputdev/wm-lbuttondown), [**WM\_KEYDOWN**](/windows/desktop/inputdev/wm-keydown), and [**WM\_CHAR**](/windows/desktop/inputdev/wm-char) messages.</span></span> <span data-ttu-id="30184-289">其他已排入佇列的訊息包括計時器、油漆和結束訊息： [**wm \_ 計時器**](wm-timer.md)、 [**WM \_ 油漆**](/windows/desktop/gdi/wm-paint)和 [**wm \_ quit**](wm-quit.md)。</span><span class="sxs-lookup"><span data-stu-id="30184-289">Other queued messages include the timer, paint, and quit messages: [**WM\_TIMER**](wm-timer.md), [**WM\_PAINT**](/windows/desktop/gdi/wm-paint), and [**WM\_QUIT**](wm-quit.md).</span></span> <span data-ttu-id="30184-290">大部分會直接傳送至視窗程式的其他訊息稱為 *nonqueued 訊息*。</span><span class="sxs-lookup"><span data-stu-id="30184-290">Most other messages, which are sent directly to a window procedure, are called *nonqueued messages*.</span></span>

-   [<span data-ttu-id="30184-291">佇列的訊息</span><span class="sxs-lookup"><span data-stu-id="30184-291">Queued Messages</span></span>](#queued-messages)
-   [<span data-ttu-id="30184-292">Nonqueued 訊息</span><span class="sxs-lookup"><span data-stu-id="30184-292">Nonqueued Messages</span></span>](#nonqueued-messages)

### <a name="queued-messages"></a><span data-ttu-id="30184-293">佇列的訊息</span><span class="sxs-lookup"><span data-stu-id="30184-293">Queued Messages</span></span>

<span data-ttu-id="30184-294">系統一次可以顯示任意數目的視窗。</span><span class="sxs-lookup"><span data-stu-id="30184-294">The system can display any number of windows at a time.</span></span> <span data-ttu-id="30184-295">若要將滑鼠和鍵盤輸入路由傳送至適當的視窗，系統會使用訊息佇列。</span><span class="sxs-lookup"><span data-stu-id="30184-295">To route mouse and keyboard input to the appropriate window, the system uses message queues.</span></span>

<span data-ttu-id="30184-296">系統會為每個 GUI 執行緒維護單一系統訊息佇列和一個執行緒特定訊息佇列。</span><span class="sxs-lookup"><span data-stu-id="30184-296">The system maintains a single system message queue and one thread-specific message queue for each GUI thread.</span></span> <span data-ttu-id="30184-297">為了避免針對非 GUI 執行緒建立訊息佇列的額外負荷，一開始會建立所有線程，而不會有訊息佇列。</span><span class="sxs-lookup"><span data-stu-id="30184-297">To avoid the overhead of creating a message queue for non–GUI threads, all threads are created initially without a message queue.</span></span> <span data-ttu-id="30184-298">只有當執行緒在第一次呼叫其中一個特定使用者函式時，系統才會建立執行緒特定的訊息佇列;沒有 GUI 函式呼叫會導致建立訊息佇列。</span><span class="sxs-lookup"><span data-stu-id="30184-298">The system creates a thread-specific message queue only when the thread makes its first call to one of the specific user functions; no GUI function calls result in the creation of a message queue.</span></span>

<span data-ttu-id="30184-299">每當使用者移動滑鼠、按一下滑鼠按鍵或鍵盤上的類型時，滑鼠或鍵盤的設備磁碟機都會將輸入轉換為訊息，並將它們放在系統訊息佇列中。</span><span class="sxs-lookup"><span data-stu-id="30184-299">Whenever the user moves the mouse, clicks the mouse buttons, or types on the keyboard, the device driver for the mouse or keyboard converts the input into messages and places them in the system message queue.</span></span> <span data-ttu-id="30184-300">系統會從系統訊息佇列一次移除一則訊息，檢查它們以判斷目的地視窗，然後將它們張貼至建立目的地視窗之執行緒的訊息佇列。</span><span class="sxs-lookup"><span data-stu-id="30184-300">The system removes the messages, one at a time, from the system message queue, examines them to determine the destination window, and then posts them to the message queue of the thread that created the destination window.</span></span> <span data-ttu-id="30184-301">執行緒的訊息佇列會接收執行緒所建立之視窗的所有滑鼠和鍵盤訊息。</span><span class="sxs-lookup"><span data-stu-id="30184-301">A thread's message queue receives all mouse and keyboard messages for the windows created by the thread.</span></span> <span data-ttu-id="30184-302">執行緒會從佇列中移除訊息，並指示系統將訊息傳送至適當的視窗程式進行處理。</span><span class="sxs-lookup"><span data-stu-id="30184-302">The thread removes messages from its queue and directs the system to send them to the appropriate window procedure for processing.</span></span>

<span data-ttu-id="30184-303">除了 [**wm \_ 油漆**](/windows/desktop/gdi/wm-paint) 訊息、 [**Wm \_ 計時器**](wm-timer.md) 訊息和 [**wm \_**](wm-quit.md) 結束訊息之外，系統一律會在訊息佇列的結尾張貼訊息。</span><span class="sxs-lookup"><span data-stu-id="30184-303">With the exception of the [**WM\_PAINT**](/windows/desktop/gdi/wm-paint) message, the [**WM\_TIMER**](wm-timer.md) message, and the [**WM\_QUIT**](wm-quit.md) message, the system always posts messages at the end of a message queue.</span></span> <span data-ttu-id="30184-304">這可確保視窗先在中的第一個，先出 (FIFO) 序列中，就會收到其輸入訊息。</span><span class="sxs-lookup"><span data-stu-id="30184-304">This ensures that a window receives its input messages in the proper first in, first out (FIFO) sequence.</span></span> <span data-ttu-id="30184-305">不過， **wm \_ 油漆** 訊息、 **Wm \_ 計時器** 訊息和 wm 結束 **\_** 訊息都會保留在佇列中，而且只有當佇列不包含其他訊息時，才會將它轉送至視窗程式。</span><span class="sxs-lookup"><span data-stu-id="30184-305">The **WM\_PAINT** message, the **WM\_TIMER** message, and the **WM\_QUIT** message, however, are kept in the queue and are forwarded to the window procedure only when the queue contains no other messages.</span></span> <span data-ttu-id="30184-306">此外，相同視窗的多個 **wm \_ 油漆** 訊息會合並成單一 **WM \_ 油漆** 訊息，將用戶端區域的所有無效部分合併到單一區域。</span><span class="sxs-lookup"><span data-stu-id="30184-306">In addition, multiple **WM\_PAINT** messages for the same window are combined into a single **WM\_PAINT** message, consolidating all invalid parts of the client area into a single area.</span></span> <span data-ttu-id="30184-307">結合 **WM \_ 油漆** 訊息可減少視窗必須重繪其工作區內容的次數。</span><span class="sxs-lookup"><span data-stu-id="30184-307">Combining **WM\_PAINT** messages reduces the number of times a window must redraw the contents of its client area.</span></span>

<span data-ttu-id="30184-308">系統會填入 [**訊息結構，**](/windows/win32/api/winuser/ns-winuser-msg) 然後將它複製到訊息佇列，以將訊息張貼到執行緒的訊息佇列。</span><span class="sxs-lookup"><span data-stu-id="30184-308">The system posts a message to a thread's message queue by filling an [**MSG**](/windows/win32/api/winuser/ns-winuser-msg) structure and then copying it to the message queue.</span></span> <span data-ttu-id="30184-309">訊息中 **的** 資訊包括：適用訊息的視窗控制碼、訊息識別碼、兩個訊息參數、訊息張貼時間，以及滑鼠游標位置。</span><span class="sxs-lookup"><span data-stu-id="30184-309">Information in **MSG** includes: the handle of the window for which the message is intended, the message identifier, the two message parameters, the time the message was posted, and the mouse cursor position.</span></span> <span data-ttu-id="30184-310">執行緒可以使用 [**PostMessage**](/windows/win32/api/winuser/nf-winuser-postmessagea) 或 [**PostThreadMessage**](/windows/win32/api/winuser/nf-winuser-postthreadmessagea) 函數，將訊息張貼至本身的訊息佇列或另一個執行緒的佇列。</span><span class="sxs-lookup"><span data-stu-id="30184-310">A thread can post a message to its own message queue or to the queue of another thread by using the [**PostMessage**](/windows/win32/api/winuser/nf-winuser-postmessagea) or [**PostThreadMessage**](/windows/win32/api/winuser/nf-winuser-postthreadmessagea) function.</span></span>

<span data-ttu-id="30184-311">應用程式可以使用 [**GetMessage**](/windows/win32/api/winuser/nf-winuser-getmessage) 函數，從佇列中移除訊息。</span><span class="sxs-lookup"><span data-stu-id="30184-311">An application can remove a message from its queue by using the [**GetMessage**](/windows/win32/api/winuser/nf-winuser-getmessage) function.</span></span> <span data-ttu-id="30184-312">若要檢查訊息，而不將它從佇列中移除，應用程式可以使用 [**PeekMessage**](/windows/win32/api/winuser/nf-winuser-peekmessagea) 函數。</span><span class="sxs-lookup"><span data-stu-id="30184-312">To examine a message without removing it from its queue, an application can use the [**PeekMessage**](/windows/win32/api/winuser/nf-winuser-peekmessagea) function.</span></span> <span data-ttu-id="30184-313">此函式 [**會以訊息的相關**](/windows/win32/api/winuser/ns-winuser-msg) 資訊填滿訊息。</span><span class="sxs-lookup"><span data-stu-id="30184-313">This function fills [**MSG**](/windows/win32/api/winuser/ns-winuser-msg) with information about the message.</span></span>

<span data-ttu-id="30184-314">從佇列中移除訊息之後，應用程式可以使用 [**DispatchMessage**](/windows/win32/api/winuser/nf-winuser-dispatchmessage) 函式來指示系統將訊息傳送至視窗程式進行處理。</span><span class="sxs-lookup"><span data-stu-id="30184-314">After removing a message from its queue, an application can use the [**DispatchMessage**](/windows/win32/api/winuser/nf-winuser-dispatchmessage) function to direct the system to send the message to a window procedure for processing.</span></span> <span data-ttu-id="30184-315">**DispatchMessage** 會採用對 [**GetMessage**](/windows/win32/api/winuser/nf-winuser-getmessage)或 [**PeekMessage**](/windows/win32/api/winuser/nf-winuser-peekmessagea)函式的先前呼叫所填妥之 [**訊息的指標**](/windows/win32/api/winuser/ns-winuser-msg)。</span><span class="sxs-lookup"><span data-stu-id="30184-315">**DispatchMessage** takes a pointer to [**MSG**](/windows/win32/api/winuser/ns-winuser-msg) that was filled by a previous call to the [**GetMessage**](/windows/win32/api/winuser/nf-winuser-getmessage) or [**PeekMessage**](/windows/win32/api/winuser/nf-winuser-peekmessagea) function.</span></span> <span data-ttu-id="30184-316">**DispatchMessage** 會將視窗控制碼、訊息識別碼和兩個訊息參數傳遞給視窗程式，但不會傳遞訊息張貼的時間或滑鼠游標位置。</span><span class="sxs-lookup"><span data-stu-id="30184-316">**DispatchMessage** passes the window handle, the message identifier, and the two message parameters to the window procedure, but it does not pass the time the message was posted or mouse cursor position.</span></span> <span data-ttu-id="30184-317">應用程式可以在處理訊息時呼叫 [**GetMessageTime**](/windows/win32/api/winuser/nf-winuser-getmessagetime) 和 [**GetMessagePos**](/windows/win32/api/winuser/nf-winuser-getmessagepos) 函式，以取得這項資訊。</span><span class="sxs-lookup"><span data-stu-id="30184-317">An application can retrieve this information by calling the [**GetMessageTime**](/windows/win32/api/winuser/nf-winuser-getmessagetime) and [**GetMessagePos**](/windows/win32/api/winuser/nf-winuser-getmessagepos) functions while processing a message.</span></span>

<span data-ttu-id="30184-318">當執行緒在其訊息佇列中沒有任何訊息時，可以使用 [**WaitMessage**](/windows/win32/api/winuser/nf-winuser-waitmessage) 函式將控制權交給其他執行緒。</span><span class="sxs-lookup"><span data-stu-id="30184-318">A thread can use the [**WaitMessage**](/windows/win32/api/winuser/nf-winuser-waitmessage) function to yield control to other threads when it has no messages in its message queue.</span></span> <span data-ttu-id="30184-319">函式會暫止執行緒，並且在將新訊息放置於執行緒的訊息佇列之前不會傳回。</span><span class="sxs-lookup"><span data-stu-id="30184-319">The function suspends the thread and does not return until a new message is placed in the thread's message queue.</span></span>

<span data-ttu-id="30184-320">您可以呼叫 [**SetMessageExtraInfo**](/windows/win32/api/winuser/nf-winuser-setmessageextrainfo) 函數，將值與目前線程的訊息佇列產生關聯。</span><span class="sxs-lookup"><span data-stu-id="30184-320">You can call the [**SetMessageExtraInfo**](/windows/win32/api/winuser/nf-winuser-setmessageextrainfo) function to associate a value with the current thread's message queue.</span></span> <span data-ttu-id="30184-321">然後呼叫 [**GetMessageExtraInfo**](/windows/win32/api/winuser/nf-winuser-getmessageextrainfo) 函數，以取得與 [**GetMessage**](/windows/win32/api/winuser/nf-winuser-getmessage) 或 [**PeekMessage**](/windows/win32/api/winuser/nf-winuser-peekmessagea) 函數所抓取之最後一個訊息相關聯的值。</span><span class="sxs-lookup"><span data-stu-id="30184-321">Then call the [**GetMessageExtraInfo**](/windows/win32/api/winuser/nf-winuser-getmessageextrainfo) function to get the value associated with the last message retrieved by the [**GetMessage**](/windows/win32/api/winuser/nf-winuser-getmessage) or [**PeekMessage**](/windows/win32/api/winuser/nf-winuser-peekmessagea) function.</span></span>

### <a name="nonqueued-messages"></a><span data-ttu-id="30184-322">Nonqueued 訊息</span><span class="sxs-lookup"><span data-stu-id="30184-322">Nonqueued Messages</span></span>

<span data-ttu-id="30184-323">Nonqueued 訊息會立即傳送至目的地視窗程式，略過系統訊息佇列和執行緒訊息佇列。</span><span class="sxs-lookup"><span data-stu-id="30184-323">Nonqueued messages are sent immediately to the destination window procedure, bypassing the system message queue and thread message queue.</span></span> <span data-ttu-id="30184-324">系統通常會傳送 nonqueued 訊息，以通知視窗有影響它的事件。</span><span class="sxs-lookup"><span data-stu-id="30184-324">The system typically sends nonqueued messages to notify a window of events that affect it.</span></span> <span data-ttu-id="30184-325">例如，當使用者啟動新的應用程式視窗時，系統會傳送一系列訊息給視窗，包括 [**WM \_ 啟用**](/windows/desktop/inputdev/wm-activate)、 [**wm \_ SETFOCUS**](/windows/desktop/inputdev/wm-setfocus)和 [**wm \_ SETCURSOR**](/windows/desktop/menurc/wm-setcursor)。</span><span class="sxs-lookup"><span data-stu-id="30184-325">For example, when the user activates a new application window, the system sends the window a series of messages, including [**WM\_ACTIVATE**](/windows/desktop/inputdev/wm-activate), [**WM\_SETFOCUS**](/windows/desktop/inputdev/wm-setfocus), and [**WM\_SETCURSOR**](/windows/desktop/menurc/wm-setcursor).</span></span> <span data-ttu-id="30184-326">這些訊息會通知視窗它已啟用，該鍵盤輸入將被導向至視窗，而且滑鼠游標已移至視窗的框線內。</span><span class="sxs-lookup"><span data-stu-id="30184-326">These messages notify the window that it has been activated, that keyboard input is being directed to the window, and that the mouse cursor has been moved within the borders of the window.</span></span> <span data-ttu-id="30184-327">當應用程式呼叫某些系統函數時，也會產生 Nonqueued 訊息。</span><span class="sxs-lookup"><span data-stu-id="30184-327">Nonqueued messages can also result when an application calls certain system functions.</span></span> <span data-ttu-id="30184-328">例如，系統會在應用程式使用 [**SetWindowPos**](/windows/win32/api/winuser/nf-winuser-setwindowpos)函式來移動視窗之後傳送 [**WM \_ WINDOWPOSCHANGED**](wm-windowposchanged.md)訊息。</span><span class="sxs-lookup"><span data-stu-id="30184-328">For example, the system sends the [**WM\_WINDOWPOSCHANGED**](wm-windowposchanged.md) message after an application uses the [**SetWindowPos**](/windows/win32/api/winuser/nf-winuser-setwindowpos) function to move a window.</span></span>

<span data-ttu-id="30184-329">傳送 nonqueued 訊息的一些函數是 [**BroadcastSystemMessage**](/windows/win32/api/winuser/nf-winuser-broadcastsystemmessage)、 [**BroadcastSystemMessageEx**](/windows/win32/api/winuser/nf-winuser-broadcastsystemmessageexa)、 [**SendMessage**](/windows/win32/api/winuser/nf-winuser-sendmessage)、 [**SendMessageTimeout**](/windows/win32/api/winuser/nf-winuser-sendmessagetimeouta)和 [**SendNotifyMessage**](/windows/win32/api/winuser/nf-winuser-sendnotifymessagea)。</span><span class="sxs-lookup"><span data-stu-id="30184-329">Some functions that send nonqueued messages are [**BroadcastSystemMessage**](/windows/win32/api/winuser/nf-winuser-broadcastsystemmessage), [**BroadcastSystemMessageEx**](/windows/win32/api/winuser/nf-winuser-broadcastsystemmessageexa), [**SendMessage**](/windows/win32/api/winuser/nf-winuser-sendmessage), [**SendMessageTimeout**](/windows/win32/api/winuser/nf-winuser-sendmessagetimeouta), and [**SendNotifyMessage**](/windows/win32/api/winuser/nf-winuser-sendnotifymessagea).</span></span>

## <a name="message-handling"></a><span data-ttu-id="30184-330">訊息處理</span><span class="sxs-lookup"><span data-stu-id="30184-330">Message Handling</span></span>

<span data-ttu-id="30184-331">應用程式必須移除並處理張貼至其執行緒訊息佇列的訊息。</span><span class="sxs-lookup"><span data-stu-id="30184-331">An application must remove and process messages posted to the message queues of its threads.</span></span> <span data-ttu-id="30184-332">單一執行緒應用程式通常會在其 [**WinMain**](/windows/win32/api/winbase/nf-winbase-winmain)函式中使用 *訊息迴圈*，以移除訊息，並將訊息傳送至適當的視窗程式進行處理。</span><span class="sxs-lookup"><span data-stu-id="30184-332">A single-threaded application usually uses a *message loop* in its [**WinMain**](/windows/win32/api/winbase/nf-winbase-winmain) function to remove and send messages to the appropriate window procedures for processing.</span></span> <span data-ttu-id="30184-333">具有多個執行緒的應用程式可以在每個建立視窗的執行緒中包含訊息迴圈。</span><span class="sxs-lookup"><span data-stu-id="30184-333">Applications with multiple threads can include a message loop in each thread that creates a window.</span></span> <span data-ttu-id="30184-334">下列各節說明訊息迴圈的運作方式，並說明視窗程式的角色：</span><span class="sxs-lookup"><span data-stu-id="30184-334">The following sections describe how a message loop works and explain the role of a window procedure:</span></span>

-   [<span data-ttu-id="30184-335">訊息迴圈</span><span class="sxs-lookup"><span data-stu-id="30184-335">Message Loop</span></span>](#message-loop)
-   [<span data-ttu-id="30184-336">視窗程式</span><span class="sxs-lookup"><span data-stu-id="30184-336">Window Procedure</span></span>](#window-procedure)

### <a name="message-loop"></a><span data-ttu-id="30184-337">訊息迴圈</span><span class="sxs-lookup"><span data-stu-id="30184-337">Message Loop</span></span>

<span data-ttu-id="30184-338">簡單的訊息迴圈包含對這三個函式的其中一個函式呼叫： [**GetMessage**](/windows/win32/api/winuser/nf-winuser-getmessage)、 [**TranslateMessage**](/windows/win32/api/winuser/nf-winuser-translatemessage)和 [**DispatchMessage**](/windows/win32/api/winuser/nf-winuser-dispatchmessage)。</span><span class="sxs-lookup"><span data-stu-id="30184-338">A simple message loop consists of one function call to each of these three functions: [**GetMessage**](/windows/win32/api/winuser/nf-winuser-getmessage), [**TranslateMessage**](/windows/win32/api/winuser/nf-winuser-translatemessage), and [**DispatchMessage**](/windows/win32/api/winuser/nf-winuser-dispatchmessage).</span></span> <span data-ttu-id="30184-339">請注意，如果發生錯誤， **GetMessage** 會傳回-1，因此需要進行特殊測試。</span><span class="sxs-lookup"><span data-stu-id="30184-339">Note that if there is an error, **GetMessage** returns –1, thus the need for the special testing.</span></span>


```
MSG msg;
BOOL bRet;

while( (bRet = GetMessage( &msg, NULL, 0, 0 )) != 0)
{ 
    if (bRet == -1)
    {
        // handle the error and possibly exit
    }
    else
    {
        TranslateMessage(&msg); 
        DispatchMessage(&msg); 
    }
}
```



<span data-ttu-id="30184-340">[**GetMessage**](/windows/win32/api/winuser/nf-winuser-getmessage)函式會從佇列中取出訊息，並將它複製到類型為 [**MSG**](/windows/win32/api/winuser/ns-winuser-msg)的結構。</span><span class="sxs-lookup"><span data-stu-id="30184-340">The [**GetMessage**](/windows/win32/api/winuser/nf-winuser-getmessage) function retrieves a message from the queue and copies it to a structure of type [**MSG**](/windows/win32/api/winuser/ns-winuser-msg).</span></span> <span data-ttu-id="30184-341">它會傳回非零值，除非它遇到 [**WM \_**](wm-quit.md) 結束訊息，在這種情況下，它會傳回 **FALSE** 並結束迴圈。</span><span class="sxs-lookup"><span data-stu-id="30184-341">It returns a nonzero value, unless it encounters the [**WM\_QUIT**](wm-quit.md) message, in which case it returns **FALSE** and ends the loop.</span></span> <span data-ttu-id="30184-342">在單一執行緒應用程式中，結束訊息迴圈通常是關閉應用程式的第一個步驟。</span><span class="sxs-lookup"><span data-stu-id="30184-342">In a single-threaded application, ending the message loop is often the first step in closing the application.</span></span> <span data-ttu-id="30184-343">應用程式可以使用 [**PostQuitMessage**](/windows/win32/api/winuser/nf-winuser-postquitmessage) 函式來結束自己的迴圈，通常是在應用程式主視窗的視窗程式中回應 [**WM \_ 摧毀**](wm-destroy.md) 訊息。</span><span class="sxs-lookup"><span data-stu-id="30184-343">An application can end its own loop by using the [**PostQuitMessage**](/windows/win32/api/winuser/nf-winuser-postquitmessage) function, typically in response to the [**WM\_DESTROY**](wm-destroy.md) message in the window procedure of the application's main window.</span></span>

<span data-ttu-id="30184-344">如果您將視窗控制碼指定為 [**GetMessage**](/windows/win32/api/winuser/nf-winuser-getmessage)的第二個參數，則只會從佇列中取出指定視窗的訊息。</span><span class="sxs-lookup"><span data-stu-id="30184-344">If you specify a window handle as the second parameter of [**GetMessage**](/windows/win32/api/winuser/nf-winuser-getmessage), only messages for the specified window are retrieved from the queue.</span></span> <span data-ttu-id="30184-345">**GetMessage** 也可以篩選佇列中的訊息，只抓取落在指定範圍內的訊息。</span><span class="sxs-lookup"><span data-stu-id="30184-345">**GetMessage** can also filter messages in the queue, retrieving only those messages that fall within a specified range.</span></span> <span data-ttu-id="30184-346">如需篩選訊息的詳細資訊，請參閱 [訊息篩選](#message-filtering)。</span><span class="sxs-lookup"><span data-stu-id="30184-346">For more information about filtering messages, see [Message Filtering](#message-filtering).</span></span>

<span data-ttu-id="30184-347">如果執行緒要接收來自鍵盤的字元輸入，執行緒的訊息迴圈必須包含 [**TranslateMessage**](/windows/win32/api/winuser/nf-winuser-translatemessage) 。</span><span class="sxs-lookup"><span data-stu-id="30184-347">A thread's message loop must include [**TranslateMessage**](/windows/win32/api/winuser/nf-winuser-translatemessage) if the thread is to receive character input from the keyboard.</span></span> <span data-ttu-id="30184-348">系統會在每次使用者按下按鍵時，產生 ([**WM \_ KEYDOWN**](/windows/desktop/inputdev/wm-keydown) 和 [**wm \_ KEYUP**](/windows/desktop/inputdev/wm-keyup)) 的虛擬金鑰訊息。</span><span class="sxs-lookup"><span data-stu-id="30184-348">The system generates virtual-key messages ([**WM\_KEYDOWN**](/windows/desktop/inputdev/wm-keydown) and [**WM\_KEYUP**](/windows/desktop/inputdev/wm-keyup)) each time the user presses a key.</span></span> <span data-ttu-id="30184-349">虛擬機器碼訊息包含用來識別已按下哪個按鍵的虛擬金鑰，而不是其字元值。</span><span class="sxs-lookup"><span data-stu-id="30184-349">A virtual-key message contains a virtual-key code that identifies which key was pressed, but not its character value.</span></span> <span data-ttu-id="30184-350">若要取得此值，訊息迴圈必須包含 **TranslateMessage**，這會將虛擬機器碼訊息轉譯為 ([**WM \_ CHAR**](/windows/desktop/inputdev/wm-char)) 的字元訊息，並將它放回應用程式訊息佇列。</span><span class="sxs-lookup"><span data-stu-id="30184-350">To retrieve this value, the message loop must contain **TranslateMessage**, which translates the virtual-key message into a character message ([**WM\_CHAR**](/windows/desktop/inputdev/wm-char)) and places it back into the application message queue.</span></span> <span data-ttu-id="30184-351">然後，您可以在後續的訊息迴圈反復專案中移除字元訊息，並分派至視窗程式。</span><span class="sxs-lookup"><span data-stu-id="30184-351">The character message can then be removed upon a subsequent iteration of the message loop and dispatched to a window procedure.</span></span>

<span data-ttu-id="30184-352">[**DispatchMessage**](/windows/win32/api/winuser/nf-winuser-dispatchmessage)函式會將訊息傳送至與 [**訊息結構中指定的視窗**](/windows/win32/api/winuser/ns-winuser-msg)控制碼相關聯的視窗程式。</span><span class="sxs-lookup"><span data-stu-id="30184-352">The [**DispatchMessage**](/windows/win32/api/winuser/nf-winuser-dispatchmessage) function sends a message to the window procedure associated with the window handle specified in the [**MSG**](/windows/win32/api/winuser/ns-winuser-msg) structure.</span></span> <span data-ttu-id="30184-353">如果視窗控制碼是 **HWND \_ 最上層**，則 **DispatchMessage** 會將訊息傳送到系統中所有最上層視窗的視窗程式。</span><span class="sxs-lookup"><span data-stu-id="30184-353">If the window handle is **HWND\_TOPMOST**, **DispatchMessage** sends the message to the window procedures of all top-level windows in the system.</span></span> <span data-ttu-id="30184-354">如果視窗控制碼為 **Null**，則 **DispatchMessage** 不會對訊息執行任何動作。</span><span class="sxs-lookup"><span data-stu-id="30184-354">If the window handle is **NULL**, **DispatchMessage** does nothing with the message.</span></span>

<span data-ttu-id="30184-355">應用程式的主執行緒會在初始化應用程式之後啟動其訊息迴圈，並至少建立一個視窗。</span><span class="sxs-lookup"><span data-stu-id="30184-355">An application's main thread starts its message loop after initializing the application and creating at least one window.</span></span> <span data-ttu-id="30184-356">啟動之後，訊息迴圈會繼續從執行緒的訊息佇列取出訊息，並將訊息分派至適當的視窗。</span><span class="sxs-lookup"><span data-stu-id="30184-356">After it is started, the message loop continues to retrieve messages from the thread's message queue and to dispatch them to the appropriate windows.</span></span> <span data-ttu-id="30184-357">當 [**GetMessage**](/windows/win32/api/winuser/nf-winuser-getmessage) 函式從訊息佇列移除 WM 結束 [**\_**](wm-quit.md) 訊息時，訊息迴圈就會結束。</span><span class="sxs-lookup"><span data-stu-id="30184-357">The message loop ends when the [**GetMessage**](/windows/win32/api/winuser/nf-winuser-getmessage) function removes the [**WM\_QUIT**](wm-quit.md) message from the message queue.</span></span>

<span data-ttu-id="30184-358">訊息佇列只需要一個訊息迴圈，即使應用程式包含許多視窗也是如此。</span><span class="sxs-lookup"><span data-stu-id="30184-358">Only one message loop is needed for a message queue, even if an application contains many windows.</span></span> <span data-ttu-id="30184-359">[**DispatchMessage**](/windows/win32/api/winuser/nf-winuser-dispatchmessage) 一律會將訊息分派至適當的視窗;這是因為佇列中的每個訊息都是包含訊息所屬視窗控制碼的 [**MSG**](/windows/win32/api/winuser/ns-winuser-msg) 結構。</span><span class="sxs-lookup"><span data-stu-id="30184-359">[**DispatchMessage**](/windows/win32/api/winuser/nf-winuser-dispatchmessage) always dispatches the message to the proper window; this is because each message in the queue is an [**MSG**](/windows/win32/api/winuser/ns-winuser-msg) structure that contains the handle of the window to which the message belongs.</span></span>

<span data-ttu-id="30184-360">您可以用各種方式修改訊息迴圈。</span><span class="sxs-lookup"><span data-stu-id="30184-360">You can modify a message loop in a variety of ways.</span></span> <span data-ttu-id="30184-361">例如，您可以從佇列中取出訊息，而不需要將訊息分派至視窗。</span><span class="sxs-lookup"><span data-stu-id="30184-361">For example, you can retrieve messages from the queue without dispatching them to a window.</span></span> <span data-ttu-id="30184-362">這對於張貼未指定視窗之訊息的應用程式很有用。</span><span class="sxs-lookup"><span data-stu-id="30184-362">This is useful for applications that post messages not specifying a window.</span></span> <span data-ttu-id="30184-363">您也可以指示 [**GetMessage**](/windows/win32/api/winuser/nf-winuser-getmessage) 搜尋特定訊息，讓其他訊息留在佇列中。</span><span class="sxs-lookup"><span data-stu-id="30184-363">You can also direct [**GetMessage**](/windows/win32/api/winuser/nf-winuser-getmessage) to search for specific messages, leaving other messages in the queue.</span></span> <span data-ttu-id="30184-364">如果您必須暫時略過訊息佇列的一般 FIFO 順序，這就很有用。</span><span class="sxs-lookup"><span data-stu-id="30184-364">This is useful if you must temporarily bypass the usual FIFO order of the message queue.</span></span>

<span data-ttu-id="30184-365">使用快速鍵的應用程式必須能夠將鍵盤訊息轉譯成命令訊息。</span><span class="sxs-lookup"><span data-stu-id="30184-365">An application that uses accelerator keys must be able to translate keyboard messages into command messages.</span></span> <span data-ttu-id="30184-366">若要這樣做，應用程式的訊息迴圈必須包含對 [**TranslateAccelerator**](/windows/desktop/api/winuser/nf-winuser-translateacceleratora) 函數的呼叫。</span><span class="sxs-lookup"><span data-stu-id="30184-366">To do this, the application's message loop must include a call to the [**TranslateAccelerator**](/windows/desktop/api/winuser/nf-winuser-translateacceleratora) function.</span></span> <span data-ttu-id="30184-367">如需快速鍵的詳細資訊，請參閱 [鍵盤](/windows/desktop/menurc/keyboard-accelerators)快速鍵。</span><span class="sxs-lookup"><span data-stu-id="30184-367">For more information about accelerator keys, see [Keyboard Accelerators](/windows/desktop/menurc/keyboard-accelerators).</span></span>

<span data-ttu-id="30184-368">如果執行緒使用非強制回應對話方塊，訊息迴圈必須包含 [**IsDialogMessage**](/windows/desktop/api/winuser/nf-winuser-isdialogmessagea) 函式，讓對話方塊可以接收鍵盤輸入。</span><span class="sxs-lookup"><span data-stu-id="30184-368">If a thread uses a modeless dialog box, the message loop must include the [**IsDialogMessage**](/windows/desktop/api/winuser/nf-winuser-isdialogmessagea) function so that the dialog box can receive keyboard input.</span></span>

### <a name="window-procedure"></a><span data-ttu-id="30184-369">視窗程式</span><span class="sxs-lookup"><span data-stu-id="30184-369">Window Procedure</span></span>

<span data-ttu-id="30184-370">視窗程式是一種函式，可接收和處理傳送至視窗的所有訊息。</span><span class="sxs-lookup"><span data-stu-id="30184-370">A window procedure is a function that receives and processes all messages sent to the window.</span></span> <span data-ttu-id="30184-371">每個視窗類別都有一個視窗程式，而使用該類別建立的每個視窗都使用相同的視窗程式來回應訊息。</span><span class="sxs-lookup"><span data-stu-id="30184-371">Every window class has a window procedure, and every window created with that class uses that same window procedure to respond to messages.</span></span>

<span data-ttu-id="30184-372">系統會將訊息資料當作引數傳遞至程式，以將訊息傳送至視窗程式。</span><span class="sxs-lookup"><span data-stu-id="30184-372">The system sends a message to a window procedure by passing the message data as arguments to the procedure.</span></span> <span data-ttu-id="30184-373">接著，視窗程式會對訊息執行適當的動作。它會檢查訊息識別碼，而在處理訊息時，會使用訊息參數所指定的資訊。</span><span class="sxs-lookup"><span data-stu-id="30184-373">The window procedure then performs an appropriate action for the message; it checks the message identifier and, while processing the message, uses the information specified by the message parameters.</span></span>

<span data-ttu-id="30184-374">視窗程式通常不會忽略訊息。</span><span class="sxs-lookup"><span data-stu-id="30184-374">A window procedure does not usually ignore a message.</span></span> <span data-ttu-id="30184-375">如果它不會處理訊息，則必須將訊息傳回給系統以進行預設處理。</span><span class="sxs-lookup"><span data-stu-id="30184-375">If it does not process a message, it must send the message back to the system for default processing.</span></span> <span data-ttu-id="30184-376">視窗程式會藉由呼叫 [**DefWindowProc**](/windows/desktop/api/winuser/nf-winuser-defwindowproca) 函式來執行這項操作，此函式會執行預設動作並傳回訊息結果。</span><span class="sxs-lookup"><span data-stu-id="30184-376">The window procedure does this by calling the [**DefWindowProc**](/windows/desktop/api/winuser/nf-winuser-defwindowproca) function, which performs a default action and returns a message result.</span></span> <span data-ttu-id="30184-377">然後，視窗程式必須將此值傳回為它自己的訊息結果。</span><span class="sxs-lookup"><span data-stu-id="30184-377">The window procedure must then return this value as its own message result.</span></span> <span data-ttu-id="30184-378">大部分的視窗程式只會處理一些訊息，並藉由呼叫 **DefWindowProc** 將其他訊息傳遞至系統。</span><span class="sxs-lookup"><span data-stu-id="30184-378">Most window procedures process just a few messages and pass the others on to the system by calling **DefWindowProc**.</span></span>

<span data-ttu-id="30184-379">由於視窗程式是由屬於相同類別的所有視窗所共用，因此它可以處理數個不同視窗的訊息。</span><span class="sxs-lookup"><span data-stu-id="30184-379">Because a window procedure is shared by all windows belonging to the same class, it can process messages for several different windows.</span></span> <span data-ttu-id="30184-380">為了識別受訊息影響的特定視窗，視窗程式可以檢查與訊息一起傳遞的視窗控制碼。</span><span class="sxs-lookup"><span data-stu-id="30184-380">To identify the specific window affected by the message, a window procedure can examine the window handle passed with a message.</span></span> <span data-ttu-id="30184-381">如需視窗程式的詳細資訊，請參閱 [視窗程式](window-procedures.md)。</span><span class="sxs-lookup"><span data-stu-id="30184-381">For more information about window procedures, see [Window Procedures](window-procedures.md).</span></span>

## <a name="message-filtering"></a><span data-ttu-id="30184-382">訊息篩選</span><span class="sxs-lookup"><span data-stu-id="30184-382">Message Filtering</span></span>

<span data-ttu-id="30184-383">應用程式可以選擇要從訊息佇列取出的特定訊息 (同時忽略其他訊息，) 使用 [**GetMessage**](/windows/win32/api/winuser/nf-winuser-getmessage) 或 [**PeekMessage**](/windows/win32/api/winuser/nf-winuser-peekmessagea) 函數來指定訊息篩選器。</span><span class="sxs-lookup"><span data-stu-id="30184-383">An application can choose specific messages to retrieve from the message queue (while ignoring other messages) by using the [**GetMessage**](/windows/win32/api/winuser/nf-winuser-getmessage) or [**PeekMessage**](/windows/win32/api/winuser/nf-winuser-peekmessagea) function to specify a message filter.</span></span> <span data-ttu-id="30184-384">篩選是由第一個和最後一個識別碼) 、視窗控制碼或兩者指定的訊息識別碼範圍 (。</span><span class="sxs-lookup"><span data-stu-id="30184-384">The filter is a range of message identifiers (specified by a first and last identifier), a window handle, or both.</span></span> <span data-ttu-id="30184-385">**GetMessage** 和 **PeekMessage** 使用訊息篩選器來選取要從佇列中取出的訊息。</span><span class="sxs-lookup"><span data-stu-id="30184-385">**GetMessage** and **PeekMessage** use a message filter to select which messages to retrieve from the queue.</span></span> <span data-ttu-id="30184-386">如果應用程式必須在訊息佇列中搜尋稍後在佇列中抵達的訊息，訊息篩選就很有用。</span><span class="sxs-lookup"><span data-stu-id="30184-386">Message filtering is useful if an application must search the message queue for messages that have arrived later in the queue.</span></span> <span data-ttu-id="30184-387">如果應用程式必須在處理張貼的訊息之前處理輸入 (硬體) 訊息，它也很有用。</span><span class="sxs-lookup"><span data-stu-id="30184-387">It is also useful if an application must process input (hardware) messages before processing posted messages.</span></span>

<span data-ttu-id="30184-388">您可以使用 **wm \_ KEYFIRST** 和 **wm \_ KEYLAST** 常數作為篩選值，以抓取所有鍵盤訊息; 也可以使用 **wm \_ MOUSEFIRST** 和 **wm \_ MOUSELAST** 常數來取出所有的滑鼠訊息。</span><span class="sxs-lookup"><span data-stu-id="30184-388">The **WM\_KEYFIRST** and **WM\_KEYLAST** constants can be used as filter values to retrieve all keyboard messages; the **WM\_MOUSEFIRST** and **WM\_MOUSELAST** constants can be used to retrieve all mouse messages.</span></span>

<span data-ttu-id="30184-389">任何篩選訊息的應用程式都必須確保能夠張貼滿足訊息篩選準則的訊息。</span><span class="sxs-lookup"><span data-stu-id="30184-389">Any application that filters messages must ensure that a message satisfying the message filter can be posted.</span></span> <span data-ttu-id="30184-390">例如，如果應用程式在未收到鍵盤輸入的視窗中篩選了 [**WM \_ 字元**](/windows/desktop/inputdev/wm-char) 訊息，則 [**GetMessage**](/windows/win32/api/winuser/nf-winuser-getmessage) 函式不會傳回。</span><span class="sxs-lookup"><span data-stu-id="30184-390">For example, if an application filters for a [**WM\_CHAR**](/windows/desktop/inputdev/wm-char) message in a window that does not receive keyboard input, the [**GetMessage**](/windows/win32/api/winuser/nf-winuser-getmessage) function does not return.</span></span> <span data-ttu-id="30184-391">這實際上會「停止回應」應用程式。</span><span class="sxs-lookup"><span data-stu-id="30184-391">This effectively "hangs" the application.</span></span>

## <a name="posting-and-sending-messages"></a><span data-ttu-id="30184-392">張貼和傳送訊息</span><span class="sxs-lookup"><span data-stu-id="30184-392">Posting and Sending Messages</span></span>

<span data-ttu-id="30184-393">任何應用程式都可以張貼和傳送訊息。</span><span class="sxs-lookup"><span data-stu-id="30184-393">Any application can post and send messages.</span></span> <span data-ttu-id="30184-394">就像系統一樣，應用程式會將訊息複製到訊息佇列，並藉由將訊息資料當作引數傳遞至視窗程式來傳送訊息，以張貼訊息。</span><span class="sxs-lookup"><span data-stu-id="30184-394">Like the system, an application posts a message by copying it to a message queue and sends a message by passing the message data as arguments to a window procedure.</span></span> <span data-ttu-id="30184-395">若要張貼訊息，應用程式會使用 [**PostMessage**](/windows/win32/api/winuser/nf-winuser-postmessagea) 函數。</span><span class="sxs-lookup"><span data-stu-id="30184-395">To post messages, an application uses the [**PostMessage**](/windows/win32/api/winuser/nf-winuser-postmessagea) function.</span></span> <span data-ttu-id="30184-396">應用程式可以藉由呼叫 [**SendMessage**](/windows/win32/api/winuser/nf-winuser-sendmessage)、 [**BroadcastSystemMessage**](/windows/win32/api/winuser/nf-winuser-broadcastsystemmessage)、 [**SendMessageCallback**](/windows/win32/api/winuser/nf-winuser-sendmessagecallbacka)、 [**SendMessageTimeout**](/windows/win32/api/winuser/nf-winuser-sendmessagetimeouta)、 [**SendNotifyMessage**](/windows/win32/api/winuser/nf-winuser-sendnotifymessagea)或 [**SendDlgItemMessage**](/windows/desktop/api/winuser/nf-winuser-senddlgitemmessagea) 函數來傳送訊息。</span><span class="sxs-lookup"><span data-stu-id="30184-396">An application can send a message by calling the [**SendMessage**](/windows/win32/api/winuser/nf-winuser-sendmessage), [**BroadcastSystemMessage**](/windows/win32/api/winuser/nf-winuser-broadcastsystemmessage), [**SendMessageCallback**](/windows/win32/api/winuser/nf-winuser-sendmessagecallbacka), [**SendMessageTimeout**](/windows/win32/api/winuser/nf-winuser-sendmessagetimeouta), [**SendNotifyMessage**](/windows/win32/api/winuser/nf-winuser-sendnotifymessagea), or [**SendDlgItemMessage**](/windows/desktop/api/winuser/nf-winuser-senddlgitemmessagea) function.</span></span>

### <a name="posting-messages"></a><span data-ttu-id="30184-397">張貼訊息</span><span class="sxs-lookup"><span data-stu-id="30184-397">Posting Messages</span></span>

<span data-ttu-id="30184-398">應用程式通常會張貼訊息來通知特定視窗，以執行工作。</span><span class="sxs-lookup"><span data-stu-id="30184-398">An application typically posts a message to notify a specific window to perform a task.</span></span> <span data-ttu-id="30184-399">[**PostMessage**](/windows/win32/api/winuser/nf-winuser-postmessagea) 會建立 [**訊息的訊息結構，**](/windows/win32/api/winuser/ns-winuser-msg) 並將訊息複製到訊息佇列。</span><span class="sxs-lookup"><span data-stu-id="30184-399">[**PostMessage**](/windows/win32/api/winuser/nf-winuser-postmessagea) creates an [**MSG**](/windows/win32/api/winuser/ns-winuser-msg) structure for the message and copies the message to the message queue.</span></span> <span data-ttu-id="30184-400">應用程式的訊息迴圈最後會取出訊息，並將訊息分派至適當的視窗程式。</span><span class="sxs-lookup"><span data-stu-id="30184-400">The application's message loop eventually retrieves the message and dispatches it to the appropriate window procedure.</span></span>

<span data-ttu-id="30184-401">應用程式可以在不指定視窗的情況下張貼訊息。</span><span class="sxs-lookup"><span data-stu-id="30184-401">An application can post a message without specifying a window.</span></span> <span data-ttu-id="30184-402">如果應用程式在呼叫 [**PostMessage**](/windows/win32/api/winuser/nf-winuser-postmessagea)時提供 **Null** 視窗控制碼，則會將訊息張貼至與目前線程相關聯的佇列。</span><span class="sxs-lookup"><span data-stu-id="30184-402">If the application supplies a **NULL** window handle when calling [**PostMessage**](/windows/win32/api/winuser/nf-winuser-postmessagea), the message is posted to the queue associated with the current thread.</span></span> <span data-ttu-id="30184-403">由於未指定視窗控制碼，因此應用程式必須處理訊息迴圈中的訊息。</span><span class="sxs-lookup"><span data-stu-id="30184-403">Because no window handle is specified, the application must process the message in the message loop.</span></span> <span data-ttu-id="30184-404">這是建立套用至整個應用程式的訊息，而不是特定視窗的一種方式。</span><span class="sxs-lookup"><span data-stu-id="30184-404">This is one way to create a message that applies to the entire application, instead of to a specific window.</span></span>

<span data-ttu-id="30184-405">有時候，您可能會想要將訊息張貼至系統中的所有最上層視窗。</span><span class="sxs-lookup"><span data-stu-id="30184-405">Occasionally, you may want to post a message to all top-level windows in the system.</span></span> <span data-ttu-id="30184-406">應用程式可以在 *hwnd* 參數中呼叫 [**PostMessage**](/windows/win32/api/winuser/nf-winuser-postmessagea)並指定 **hwnd \_ 最上層**，以將訊息張貼到所有最上層視窗。</span><span class="sxs-lookup"><span data-stu-id="30184-406">An application can post a message to all top-level windows by calling [**PostMessage**](/windows/win32/api/winuser/nf-winuser-postmessagea) and specifying **HWND\_TOPMOST** in the *hwnd* parameter.</span></span>

<span data-ttu-id="30184-407">常見的程式設計錯誤是假設 [**PostMessage**](/windows/win32/api/winuser/nf-winuser-postmessagea) 函式一律會張貼訊息。</span><span class="sxs-lookup"><span data-stu-id="30184-407">A common programming error is to assume that the [**PostMessage**](/windows/win32/api/winuser/nf-winuser-postmessagea) function always posts a message.</span></span> <span data-ttu-id="30184-408">當訊息佇列已滿時，就不會發生這種情況。</span><span class="sxs-lookup"><span data-stu-id="30184-408">This is not true when the message queue is full.</span></span> <span data-ttu-id="30184-409">應用程式應該檢查 **PostMessage** 函式的傳回值，以判斷訊息是否已張貼，如果尚未傳送，則重新張貼它。</span><span class="sxs-lookup"><span data-stu-id="30184-409">An application should check the return value of the **PostMessage** function to determine whether the message has been posted and, if it has not been, repost it.</span></span>

### <a name="sending-messages"></a><span data-ttu-id="30184-410">傳送訊息</span><span class="sxs-lookup"><span data-stu-id="30184-410">Sending Messages</span></span>

<span data-ttu-id="30184-411">應用程式通常會傳送訊息，以通知視窗程式立即執行工作。</span><span class="sxs-lookup"><span data-stu-id="30184-411">An application typically sends a message to notify a window procedure to perform a task immediately.</span></span> <span data-ttu-id="30184-412">[**SendMessage**](/windows/win32/api/winuser/nf-winuser-sendmessage)函式會將訊息傳送至對應至指定視窗的視窗程式。</span><span class="sxs-lookup"><span data-stu-id="30184-412">The [**SendMessage**](/windows/win32/api/winuser/nf-winuser-sendmessage) function sends the message to the window procedure corresponding to the given window.</span></span> <span data-ttu-id="30184-413">函數會等到視窗程式完成處理，然後傳回訊息結果為止。</span><span class="sxs-lookup"><span data-stu-id="30184-413">The function waits until the window procedure completes processing and then returns the message result.</span></span> <span data-ttu-id="30184-414">父和子視窗通常會藉由傳送訊息給彼此來進行通訊。</span><span class="sxs-lookup"><span data-stu-id="30184-414">Parent and child windows often communicate by sending messages to each other.</span></span> <span data-ttu-id="30184-415">例如，具有編輯控制項做為其子視窗的父視窗可以藉由傳送訊息給控制項來設定控制項的文字。</span><span class="sxs-lookup"><span data-stu-id="30184-415">For example, a parent window that has an edit control as its child window can set the text of the control by sending a message to it.</span></span> <span data-ttu-id="30184-416">控制項可以將訊息傳送回父系，以通知父視窗對使用者所執行的文字所做的變更。</span><span class="sxs-lookup"><span data-stu-id="30184-416">The control can notify the parent window of changes to the text that are carried out by the user by sending messages back to the parent.</span></span>

<span data-ttu-id="30184-417">[**SendMessageCallback**](/windows/win32/api/winuser/nf-winuser-sendmessagecallbacka)函式也會將訊息傳送至對應至指定視窗的視窗程式。</span><span class="sxs-lookup"><span data-stu-id="30184-417">The [**SendMessageCallback**](/windows/win32/api/winuser/nf-winuser-sendmessagecallbacka) function also sends a message to the window procedure corresponding to the given window.</span></span> <span data-ttu-id="30184-418">不過，此函數會立即傳回。</span><span class="sxs-lookup"><span data-stu-id="30184-418">However, this function returns immediately.</span></span> <span data-ttu-id="30184-419">在視窗程式處理訊息之後，系統會呼叫指定的回呼函數。</span><span class="sxs-lookup"><span data-stu-id="30184-419">After the window procedure processes the message, the system calls the specified callback function.</span></span> <span data-ttu-id="30184-420">如需回呼函數的詳細資訊，請參閱 [**SendAsyncProc**](/windows/win32/api/winuser/nc-winuser-sendasyncproc) 函數。</span><span class="sxs-lookup"><span data-stu-id="30184-420">For more information about the callback function, see the [**SendAsyncProc**](/windows/win32/api/winuser/nc-winuser-sendasyncproc) function.</span></span>

<span data-ttu-id="30184-421">有時候，您可能會想要將訊息傳送至系統中的所有最上層視窗。</span><span class="sxs-lookup"><span data-stu-id="30184-421">Occasionally, you may want to send a message to all top-level windows in the system.</span></span> <span data-ttu-id="30184-422">例如，如果應用程式變更系統時間，它必須傳送 [**WM \_ TIMECHANGE**](../sysinfo/wm-timechange.md) 訊息來通知所有最上層 windows 的變更。</span><span class="sxs-lookup"><span data-stu-id="30184-422">For example, if the application changes the system time, it must notify all top-level windows about the change by sending a [**WM\_TIMECHANGE**](../sysinfo/wm-timechange.md) message.</span></span> <span data-ttu-id="30184-423">應用程式可以在 *hwnd* 參數中呼叫 [**SendMessage**](/windows/win32/api/winuser/nf-winuser-sendmessage)並指定 **hwnd \_ 最上層**，以將訊息傳送至所有最上層視窗。</span><span class="sxs-lookup"><span data-stu-id="30184-423">An application can send a message to all top-level windows by calling [**SendMessage**](/windows/win32/api/winuser/nf-winuser-sendmessage) and specifying **HWND\_TOPMOST** in the *hwnd* parameter.</span></span> <span data-ttu-id="30184-424">您也可以藉由呼叫 [**BroadcastSystemMessage**](/windows/win32/api/winuser/nf-winuser-broadcastsystemmessage)函式，並在 *lpdwRecipients* 參數中指定 **BSM \_ 應用程式**，將訊息廣播至所有應用程式。</span><span class="sxs-lookup"><span data-stu-id="30184-424">You can also broadcast a message to all applications by calling the [**BroadcastSystemMessage**](/windows/win32/api/winuser/nf-winuser-broadcastsystemmessage) function and specifying **BSM\_APPLICATIONS** in the *lpdwRecipients* parameter.</span></span>

<span data-ttu-id="30184-425">藉由使用 [**InSendMessage**](/windows/win32/api/winuser/nf-winuser-insendmessage) 或 [**InSendMessageEx**](/windows/win32/api/winuser/nf-winuser-insendmessageex) 函式，視窗程式可以判斷它是否正在處理由另一個執行緒所傳送的訊息。</span><span class="sxs-lookup"><span data-stu-id="30184-425">By using the [**InSendMessage**](/windows/win32/api/winuser/nf-winuser-insendmessage) or [**InSendMessageEx**](/windows/win32/api/winuser/nf-winuser-insendmessageex) function, a window procedure can determine whether it is processing a message sent by another thread.</span></span> <span data-ttu-id="30184-426">當訊息處理相依于訊息的來源時，這項功能就很有用。</span><span class="sxs-lookup"><span data-stu-id="30184-426">This capability is useful when message processing depends on the origin of the message.</span></span>

## <a name="message-deadlocks"></a><span data-ttu-id="30184-427">訊息鎖死</span><span class="sxs-lookup"><span data-stu-id="30184-427">Message Deadlocks</span></span>

<span data-ttu-id="30184-428">呼叫 [**SendMessage**](/windows/win32/api/winuser/nf-winuser-sendmessage) 函式以將訊息傳送至另一個執行緒的執行緒，在接收訊息的視窗程式傳回之前，無法繼續執行。</span><span class="sxs-lookup"><span data-stu-id="30184-428">A thread that calls the [**SendMessage**](/windows/win32/api/winuser/nf-winuser-sendmessage) function to send a message to another thread cannot continue executing until the window procedure that receives the message returns.</span></span> <span data-ttu-id="30184-429">如果接收端執行緒在處理訊息時產生控制，則傳送執行緒無法繼續執行，因為它正在等待 **SendMessage** 傳回。</span><span class="sxs-lookup"><span data-stu-id="30184-429">If the receiving thread yields control while processing the message, the sending thread cannot continue executing, because it is waiting for **SendMessage** to return.</span></span> <span data-ttu-id="30184-430">如果接收端執行緒附加至與傳送者相同的佇列，可能會導致應用程式鎖死發生。</span><span class="sxs-lookup"><span data-stu-id="30184-430">If the receiving thread is attached to the same queue as the sender, it can cause an application deadlock to occur.</span></span> <span data-ttu-id="30184-431"> (注意到，日誌會將執行緒附加至相同的佇列。 ) </span><span class="sxs-lookup"><span data-stu-id="30184-431">(Note that journal hooks attach threads to the same queue.)</span></span>

<span data-ttu-id="30184-432">請注意，接收執行緒不需要明確地產生控制權;呼叫下列任何函式可能會導致執行緒隱含地產生控制。</span><span class="sxs-lookup"><span data-stu-id="30184-432">Note that the receiving thread need not yield control explicitly; calling any of the following functions can cause a thread to yield control implicitly.</span></span>

-   [<span data-ttu-id="30184-433">**對話方塊**</span><span class="sxs-lookup"><span data-stu-id="30184-433">**DialogBox**</span></span>](/windows/desktop/api/winuser/nf-winuser-dialogboxa)
-   [<span data-ttu-id="30184-434">**DialogBoxIndirect**</span><span class="sxs-lookup"><span data-stu-id="30184-434">**DialogBoxIndirect**</span></span>](/windows/desktop/api/winuser/nf-winuser-dialogboxindirecta)
-   [<span data-ttu-id="30184-435">**DialogBoxIndirectParam**</span><span class="sxs-lookup"><span data-stu-id="30184-435">**DialogBoxIndirectParam**</span></span>](/windows/desktop/api/winuser/nf-winuser-dialogboxindirectparama)
-   [<span data-ttu-id="30184-436">**DialogBoxParam**</span><span class="sxs-lookup"><span data-stu-id="30184-436">**DialogBoxParam**</span></span>](/windows/desktop/api/winuser/nf-winuser-dialogboxparama)
-   [<span data-ttu-id="30184-437">**GetMessage**</span><span class="sxs-lookup"><span data-stu-id="30184-437">**GetMessage**</span></span>](/windows/win32/api/winuser/nf-winuser-getmessage)
-   [<span data-ttu-id="30184-438">**MessageBox**</span><span class="sxs-lookup"><span data-stu-id="30184-438">**MessageBox**</span></span>](/windows/desktop/api/winuser/nf-winuser-messagebox)
-   [<span data-ttu-id="30184-439">**PeekMessage**</span><span class="sxs-lookup"><span data-stu-id="30184-439">**PeekMessage**</span></span>](/windows/win32/api/winuser/nf-winuser-peekmessagea)
-   [<span data-ttu-id="30184-440">**SendMessage**</span><span class="sxs-lookup"><span data-stu-id="30184-440">**SendMessage**</span></span>](/windows/win32/api/winuser/nf-winuser-sendmessage)

<span data-ttu-id="30184-441">若要避免您的應用程式發生可能的鎖死，請考慮使用 [**SendNotifyMessage**](/windows/win32/api/winuser/nf-winuser-sendnotifymessagea) 或 [**SendMessageTimeout**](/windows/win32/api/winuser/nf-winuser-sendmessagetimeouta) 函數。</span><span class="sxs-lookup"><span data-stu-id="30184-441">To avoid potential deadlocks in your application, consider using the [**SendNotifyMessage**](/windows/win32/api/winuser/nf-winuser-sendnotifymessagea) or [**SendMessageTimeout**](/windows/win32/api/winuser/nf-winuser-sendmessagetimeouta) functions.</span></span> <span data-ttu-id="30184-442">否則，視窗程式可以藉由呼叫 [**InSendMessage**](/windows/win32/api/winuser/nf-winuser-insendmessage) 或 [**InSendMessageEx**](/windows/win32/api/winuser/nf-winuser-insendmessageex) 函式，來判斷其所接收的訊息是否由另一個執行緒傳送。</span><span class="sxs-lookup"><span data-stu-id="30184-442">Otherwise, a window procedure can determine whether a message it has received was sent by another thread by calling the [**InSendMessage**](/windows/win32/api/winuser/nf-winuser-insendmessage) or [**InSendMessageEx**](/windows/win32/api/winuser/nf-winuser-insendmessageex) function.</span></span> <span data-ttu-id="30184-443">在處理訊息時，呼叫上述清單中的任何函式之前，視窗程式應先呼叫 **InSendMessage** 或 **InSendMessageEx**。</span><span class="sxs-lookup"><span data-stu-id="30184-443">Before calling any of the functions in the preceding list while processing a message, the window procedure should first call **InSendMessage** or **InSendMessageEx**.</span></span> <span data-ttu-id="30184-444">如果此函式傳回 **TRUE**，則視窗程式必須在導致執行緒產生控制權的任何函式之前呼叫 [**ReplyMessage**](/windows/win32/api/winuser/nf-winuser-replymessage) 函數。</span><span class="sxs-lookup"><span data-stu-id="30184-444">If this function returns **TRUE**, the window procedure must call the [**ReplyMessage**](/windows/win32/api/winuser/nf-winuser-replymessage) function before any function that causes the thread to yield control.</span></span>

## <a name="broadcasting-messages"></a><span data-ttu-id="30184-445">廣播訊息</span><span class="sxs-lookup"><span data-stu-id="30184-445">Broadcasting Messages</span></span>

<span data-ttu-id="30184-446">每個訊息都包含一個訊息識別碼和兩個參數： *wParam* 和 *lParam*。</span><span class="sxs-lookup"><span data-stu-id="30184-446">Each message consists of a message identifier and two parameters, *wParam* and *lParam*.</span></span> <span data-ttu-id="30184-447">訊息識別碼是指定訊息用途的唯一值。</span><span class="sxs-lookup"><span data-stu-id="30184-447">The message identifier is a unique value that specifies the message purpose.</span></span> <span data-ttu-id="30184-448">參數會提供特定訊息的其他資訊，但 *wParam* 參數通常是提供訊息詳細資訊的型別值。</span><span class="sxs-lookup"><span data-stu-id="30184-448">The parameters provide additional information that is message-specific, but the *wParam* parameter is generally a type value that provides more information about the message.</span></span>

<span data-ttu-id="30184-449">*訊息廣播* 只是將訊息傳送到系統中的多個收件者。</span><span class="sxs-lookup"><span data-stu-id="30184-449">A *message broadcast* is simply the sending of a message to multiple recipients in the system.</span></span> <span data-ttu-id="30184-450">若要從應用程式廣播訊息，請使用 [**BroadcastSystemMessage**](/windows/win32/api/winuser/nf-winuser-broadcastsystemmessage) 函數，並指定訊息的收件者。</span><span class="sxs-lookup"><span data-stu-id="30184-450">To broadcast a message from an application, use the [**BroadcastSystemMessage**](/windows/win32/api/winuser/nf-winuser-broadcastsystemmessage) function, specifying the recipients of the message.</span></span> <span data-ttu-id="30184-451">您必須指定一或多個收件者類型，而不是指定個別的收件者。</span><span class="sxs-lookup"><span data-stu-id="30184-451">Rather than specify individual recipients, you must specify one or more types of recipients.</span></span> <span data-ttu-id="30184-452">這些類型包括應用程式、可安裝的驅動程式、網路驅動程式和系統層級的設備磁碟機。</span><span class="sxs-lookup"><span data-stu-id="30184-452">These types are applications, installable drivers, network drivers, and system-level device drivers.</span></span> <span data-ttu-id="30184-453">系統會將廣播訊息傳送給每個指定類型的所有成員。</span><span class="sxs-lookup"><span data-stu-id="30184-453">The system sends broadcast messages to all members of each specified type.</span></span>

<span data-ttu-id="30184-454">系統通常會廣播訊息，以回應系統層級設備磁碟機或相關元件中發生的變更。</span><span class="sxs-lookup"><span data-stu-id="30184-454">The system typically broadcasts messages in response to changes that take place within system-level device drivers or related components.</span></span> <span data-ttu-id="30184-455">驅動程式或相關元件會將訊息廣播至應用程式和其他元件，以通知他們變更。</span><span class="sxs-lookup"><span data-stu-id="30184-455">The driver or related component broadcasts the message to applications and other components to notify them of the change.</span></span> <span data-ttu-id="30184-456">例如，當磁片磁碟機的設備磁碟機偵測到媒體的變更時（例如當使用者將磁片插入磁片磁碟機時），負責磁片磁碟機的元件會廣播訊息。</span><span class="sxs-lookup"><span data-stu-id="30184-456">For example, the component responsible for disk drives broadcasts a message whenever the device driver for the floppy disk drive detects a change of media such as when the user inserts a disk in the drive.</span></span>

<span data-ttu-id="30184-457">系統會依下列順序將訊息廣播給收件者：系統層級的設備磁碟機、網路驅動程式、可安裝的驅動程式和應用程式。</span><span class="sxs-lookup"><span data-stu-id="30184-457">The system broadcasts messages to recipients in this order: system-level device drivers, network drivers, installable drivers, and applications.</span></span> <span data-ttu-id="30184-458">這表示系統層級的設備磁碟機（如果被選為收件者）一律會獲得第一個回應訊息的機會。</span><span class="sxs-lookup"><span data-stu-id="30184-458">This means that system-level device drivers, if chosen as recipients, always get the first opportunity to respond to a message.</span></span> <span data-ttu-id="30184-459">在指定的收件者類型內，不保證任何驅動程式會在任何其他驅動程式之前接收指定的訊息。</span><span class="sxs-lookup"><span data-stu-id="30184-459">Within a given recipient type, no driver is guaranteed to receive a given message before any other driver.</span></span> <span data-ttu-id="30184-460">這表示適用于特定驅動程式的訊息必須有全域唯一的訊息識別碼，如此一來，其他驅動程式就不會不慎處理它。</span><span class="sxs-lookup"><span data-stu-id="30184-460">This means that a message intended for a specific driver must have a globally-unique message identifier so that no other driver unintentionally processes it.</span></span>

<span data-ttu-id="30184-461">您也可以在 [**SendMessage**](/windows/win32/api/winuser/nf-winuser-sendmessage)、 [**SendMessageCallback**](/windows/win32/api/winuser/nf-winuser-sendmessagecallbacka)、 [**SendMessageTimeout**](/windows/win32/api/winuser/nf-winuser-sendmessagetimeouta)或 [**SendNotifyMessage**](/windows/win32/api/winuser/nf-winuser-sendnotifymessagea)函式中指定 **HWND \_ 廣播**，以將訊息廣播到所有最上層視窗。</span><span class="sxs-lookup"><span data-stu-id="30184-461">You can also broadcast messages to all top-level windows by specifying **HWND\_BROADCAST** in the [**SendMessage**](/windows/win32/api/winuser/nf-winuser-sendmessage), [**SendMessageCallback**](/windows/win32/api/winuser/nf-winuser-sendmessagecallbacka), [**SendMessageTimeout**](/windows/win32/api/winuser/nf-winuser-sendmessagetimeouta), or [**SendNotifyMessage**](/windows/win32/api/winuser/nf-winuser-sendnotifymessagea) function.</span></span>

<span data-ttu-id="30184-462">應用程式會透過其最上層視窗的視窗程式來接收訊息。</span><span class="sxs-lookup"><span data-stu-id="30184-462">Applications receive messages through the window procedure of their top-level windows.</span></span> <span data-ttu-id="30184-463">訊息不會傳送至子視窗。</span><span class="sxs-lookup"><span data-stu-id="30184-463">Messages are not sent to child windows.</span></span> <span data-ttu-id="30184-464">服務可以透過視窗程式或其服務控制處理常式來接收訊息。</span><span class="sxs-lookup"><span data-stu-id="30184-464">Services can receive messages through a window procedure or their service control handlers.</span></span>

> [!Note]  
> <span data-ttu-id="30184-465">系統層級設備磁碟機會使用相關的系統層級功能來廣播系統訊息。</span><span class="sxs-lookup"><span data-stu-id="30184-465">System-level device drivers use a related, system-level function to broadcast system messages.</span></span>

 

## <a name="query-messages"></a><span data-ttu-id="30184-466">查詢訊息</span><span class="sxs-lookup"><span data-stu-id="30184-466">Query Messages</span></span>

<span data-ttu-id="30184-467">您可以建立自己的自訂訊息，並使用它們來協調您的應用程式與系統中其他元件之間的活動。</span><span class="sxs-lookup"><span data-stu-id="30184-467">You can create your own custom messages and use them to coordinate activities between your applications and other components in the system.</span></span> <span data-ttu-id="30184-468">如果您已建立自己的可安裝驅動程式或系統層級設備磁碟機，這項功能特別有用。</span><span class="sxs-lookup"><span data-stu-id="30184-468">This is especially useful if you have created your own installable drivers or system-level device drivers.</span></span> <span data-ttu-id="30184-469">您的自訂訊息可以在您的驅動程式和使用驅動程式的應用程式之間攜帶資訊。</span><span class="sxs-lookup"><span data-stu-id="30184-469">Your custom messages can carry information to and from your driver and the applications that use the driver.</span></span>

<span data-ttu-id="30184-470">若要輪詢收件者的許可權以執行指定的動作，請使用 *查詢訊息*。</span><span class="sxs-lookup"><span data-stu-id="30184-470">To poll recipients for permission to carry out a given action, use a *query message*.</span></span> <span data-ttu-id="30184-471">您可以在呼叫 [**BroadcastSystemMessage**](/windows/win32/api/winuser/nf-winuser-broadcastsystemmessage)時，在 *dwFlags* 參數中設定 **BSF \_ 查詢** 值，以產生您自己的查詢訊息。</span><span class="sxs-lookup"><span data-stu-id="30184-471">You can generate your own query messages by setting the **BSF\_QUERY** value in the *dwFlags* parameter when calling [**BroadcastSystemMessage**](/windows/win32/api/winuser/nf-winuser-broadcastsystemmessage).</span></span> <span data-ttu-id="30184-472">查詢訊息的每個收件者都必須傳回 **TRUE** ，函數才能將訊息傳送給下一個收件者。</span><span class="sxs-lookup"><span data-stu-id="30184-472">Each recipient of the query message must return **TRUE** for the function to send the message to the next recipient.</span></span> <span data-ttu-id="30184-473">如果有任何收件者傳回 **廣播 \_ 查詢 \_ 拒絕**，則廣播會立即結束，且此函式會傳回零。</span><span class="sxs-lookup"><span data-stu-id="30184-473">If any recipient returns **BROADCAST\_QUERY\_DENY**, the broadcast ends immediately and the function returns a zero.</span></span>

 

 
