---
description: 多重文件介面中的每份檔 (MDI) 應用程式會顯示在應用程式主視窗工作區的個別子視窗中。
ms.assetid: 35dff281-3b11-4954-85cf-a0f1c9ed346a
title: 關於多重文件介面
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: a0397127d7ec343ebdb7696c2dd7d57204a5d5ae
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/08/2021
ms.locfileid: "106982747"
---
# <a name="about-the-multiple-document-interface"></a><span data-ttu-id="8f901-103">關於多重文件介面</span><span class="sxs-lookup"><span data-stu-id="8f901-103">About the Multiple Document Interface</span></span>

<span data-ttu-id="8f901-104">多重文件介面中的每份檔 (MDI) 應用程式會顯示在應用程式主視窗工作區的個別子視窗中。</span><span class="sxs-lookup"><span data-stu-id="8f901-104">Each document in an multiple-document interface (MDI) application is displayed in a separate child window within the client area of the application's main window.</span></span> <span data-ttu-id="8f901-105">一般的 MDI 應用程式包括文字處理應用程式，可讓使用者使用多個文字檔，以及允許使用者使用多個圖表和試算表的試算表應用程式。</span><span class="sxs-lookup"><span data-stu-id="8f901-105">Typical MDI applications include word-processing applications that allow the user to work with multiple text documents, and spreadsheet applications that allow the user to work with multiple charts and spreadsheets.</span></span> <span data-ttu-id="8f901-106">如需詳細資訊，請參閱下列主題。</span><span class="sxs-lookup"><span data-stu-id="8f901-106">For more information, see the following topics.</span></span>

-   [<span data-ttu-id="8f901-107">框架、用戶端和子視窗</span><span class="sxs-lookup"><span data-stu-id="8f901-107">Frame, Client, and Child Windows</span></span>](#frame-client-and-child-windows)
-   [<span data-ttu-id="8f901-108">子視窗建立</span><span class="sxs-lookup"><span data-stu-id="8f901-108">Child Window Creation</span></span>](#child-window-creation)
-   [<span data-ttu-id="8f901-109">子視窗啟用</span><span class="sxs-lookup"><span data-stu-id="8f901-109">Child Window Activation</span></span>](#child-window-activation)
-   [<span data-ttu-id="8f901-110">多個檔功能表</span><span class="sxs-lookup"><span data-stu-id="8f901-110">Multiple Document Menus</span></span>](#multiple-document-menus)
-   [<span data-ttu-id="8f901-111">多個檔加速器</span><span class="sxs-lookup"><span data-stu-id="8f901-111">Multiple Document Accelerators</span></span>](#multiple-document-accelerators)
-   [<span data-ttu-id="8f901-112">子視窗大小和相片順序</span><span class="sxs-lookup"><span data-stu-id="8f901-112">Child Window Size and Arrangement</span></span>](#child-window-size-and-arrangement)
-   [<span data-ttu-id="8f901-113">圖示標題視窗</span><span class="sxs-lookup"><span data-stu-id="8f901-113">Icon Title Windows</span></span>](#icon-title-windows)
-   [<span data-ttu-id="8f901-114">子視窗資料</span><span class="sxs-lookup"><span data-stu-id="8f901-114">Child Window Data</span></span>](#child-window-data)
    -   [<span data-ttu-id="8f901-115">視窗結構</span><span class="sxs-lookup"><span data-stu-id="8f901-115">Window Structure</span></span>](#window-structure)
    -   [<span data-ttu-id="8f901-116">視窗屬性</span><span class="sxs-lookup"><span data-stu-id="8f901-116">Window Properties</span></span>](#window-properties)

## <a name="frame-client-and-child-windows"></a><span data-ttu-id="8f901-117">框架、用戶端和子視窗</span><span class="sxs-lookup"><span data-stu-id="8f901-117">Frame, Client, and Child Windows</span></span>

<span data-ttu-id="8f901-118">MDI 應用程式有三種視窗：框架視窗、MDI 用戶端視窗，以及許多子視窗。</span><span class="sxs-lookup"><span data-stu-id="8f901-118">An MDI application has three kinds of windows: a frame window, an MDI client window, as well as a number of child windows.</span></span> <span data-ttu-id="8f901-119">*框架視窗* 就像是應用程式的主視窗：它具有調整大小框線、標題列、視窗功能表、最小化按鈕，以及最大化按鈕。</span><span class="sxs-lookup"><span data-stu-id="8f901-119">The *frame window* is like the main window of the application: it has a sizing border, a title bar, a window menu, a minimize button, and a maximize button.</span></span> <span data-ttu-id="8f901-120">應用程式必須為框架視窗註冊視窗類別，並提供視窗程式來支援它。</span><span class="sxs-lookup"><span data-stu-id="8f901-120">The application must register a window class for the frame window and provide a window procedure to support it.</span></span>

<span data-ttu-id="8f901-121">MDI 應用程式不會在框架視窗的工作區中顯示輸出。</span><span class="sxs-lookup"><span data-stu-id="8f901-121">An MDI application does not display output in the client area of the frame window.</span></span> <span data-ttu-id="8f901-122">相反地，它會顯示 MDI 用戶端視窗。</span><span class="sxs-lookup"><span data-stu-id="8f901-122">Instead, it displays the MDI client window.</span></span> <span data-ttu-id="8f901-123">*MDI 用戶端視窗* 是一種特殊類型的子視窗，屬於預先註冊視窗類別 **MDICLIENT**。</span><span class="sxs-lookup"><span data-stu-id="8f901-123">An *MDI client window* is a special type of child window belonging to the preregistered window class **MDICLIENT**.</span></span> <span data-ttu-id="8f901-124">用戶端視窗是框架視窗的子系;它是子視窗的背景。</span><span class="sxs-lookup"><span data-stu-id="8f901-124">The client window is a child of the frame window; it serves as the background for child windows.</span></span> <span data-ttu-id="8f901-125">它也提供建立和操作子視窗的支援。</span><span class="sxs-lookup"><span data-stu-id="8f901-125">It also provides support for creating and manipulating child windows.</span></span> <span data-ttu-id="8f901-126">例如，MDI 應用程式可以藉由將訊息傳送至 MDI 用戶端視窗，來建立、啟動或最大化子視窗。</span><span class="sxs-lookup"><span data-stu-id="8f901-126">For example, an MDI application can create, activate, or maximize child windows by sending messages to the MDI client window.</span></span>

<span data-ttu-id="8f901-127">當使用者開啟或建立檔時，用戶端視窗會建立檔的子視窗。</span><span class="sxs-lookup"><span data-stu-id="8f901-127">When the user opens or creates a document, the client window creates a child window for the document.</span></span> <span data-ttu-id="8f901-128">用戶端視窗是應用程式中所有 MDI 子視窗的父視窗。</span><span class="sxs-lookup"><span data-stu-id="8f901-128">The client window is the parent window of all MDI child windows in the application.</span></span> <span data-ttu-id="8f901-129">每個子視窗都有調整框線、標題列、視窗功能表、最小化按鈕，以及最大化按鈕。</span><span class="sxs-lookup"><span data-stu-id="8f901-129">Each child window has a sizing border, a title bar, a window menu, a minimize button, and a maximize button.</span></span> <span data-ttu-id="8f901-130">因為子視窗被裁剪，所以會限制在用戶端視窗之外，而且不能出現在其外部。</span><span class="sxs-lookup"><span data-stu-id="8f901-130">Because a child window is clipped, it is confined to the client window and cannot appear outside it.</span></span>

<span data-ttu-id="8f901-131">MDI 應用程式可以支援一種以上的檔。</span><span class="sxs-lookup"><span data-stu-id="8f901-131">An MDI application can support more than one kind of document.</span></span> <span data-ttu-id="8f901-132">例如，一般試算表應用程式可讓使用者同時使用圖表和試算表。</span><span class="sxs-lookup"><span data-stu-id="8f901-132">For example, a typical spreadsheet application enables the user to work with both charts and spreadsheets.</span></span> <span data-ttu-id="8f901-133">針對每一種支援的檔案類型，MDI 應用程式必須註冊子視窗類別，並提供視窗程式來支援屬於該類別的 windows。</span><span class="sxs-lookup"><span data-stu-id="8f901-133">For each type of document that it supports, an MDI application must register a child window class and provide a window procedure to support the windows belonging to that class.</span></span> <span data-ttu-id="8f901-134">如需視窗類別的詳細資訊，請參閱 [視窗類別](window-classes.md)。</span><span class="sxs-lookup"><span data-stu-id="8f901-134">For more information about window classes, see [Window Classes](window-classes.md).</span></span> <span data-ttu-id="8f901-135">如需視窗程式的詳細資訊，請參閱 [視窗程式](window-procedures.md)。</span><span class="sxs-lookup"><span data-stu-id="8f901-135">For more information about window procedures, see [Window Procedures](window-procedures.md).</span></span>

<span data-ttu-id="8f901-136">以下是一般的 MDI 應用程式。</span><span class="sxs-lookup"><span data-stu-id="8f901-136">Following is a typical MDI application.</span></span> <span data-ttu-id="8f901-137">它會命名為 Multipad。</span><span class="sxs-lookup"><span data-stu-id="8f901-137">It is named Multipad.</span></span>

![multipad mdi 應用程式框架視窗和用戶端視窗](images/csmdi-01.png)

## <a name="child-window-creation"></a><span data-ttu-id="8f901-139">子視窗建立</span><span class="sxs-lookup"><span data-stu-id="8f901-139">Child Window Creation</span></span>

<span data-ttu-id="8f901-140">若要建立子視窗，MDI 應用程式可以呼叫 [**CreateMDIWindow**](/windows/win32/api/winuser/nf-winuser-createmdiwindowa) 函式，或將 [**WM \_ MDICREATE**](wm-mdicreate.md) 訊息傳送至 MDI 用戶端視窗。</span><span class="sxs-lookup"><span data-stu-id="8f901-140">To create a child window, an MDI application either calls the [**CreateMDIWindow**](/windows/win32/api/winuser/nf-winuser-createmdiwindowa) function or sends the [**WM\_MDICREATE**](wm-mdicreate.md) message to the MDI client window.</span></span> <span data-ttu-id="8f901-141">更有效率的建立 MDI 子視窗的方式是呼叫 [**CreateWindowEx**](/windows/win32/api/winuser/nf-winuser-createwindowexa) 函式，並指定 **WS \_ EX \_ MDICHILD** 延伸樣式。</span><span class="sxs-lookup"><span data-stu-id="8f901-141">A more efficient way to create an MDI child window is to call the [**CreateWindowEx**](/windows/win32/api/winuser/nf-winuser-createwindowexa) function, specifying the **WS\_EX\_MDICHILD** extended style.</span></span>

<span data-ttu-id="8f901-142">為了終結子視窗，MDI 應用程式會將 [**WM \_ MDIDESTROY**](wm-mdidestroy.md) 訊息傳送至 mdi 用戶端視窗。</span><span class="sxs-lookup"><span data-stu-id="8f901-142">To destroy a child window, an MDI application sends a [**WM\_MDIDESTROY**](wm-mdidestroy.md) message to the MDI client window.</span></span>

## <a name="child-window-activation"></a><span data-ttu-id="8f901-143">子視窗啟用</span><span class="sxs-lookup"><span data-stu-id="8f901-143">Child Window Activation</span></span>

<span data-ttu-id="8f901-144">任何數目的子視窗都可以在用戶端視窗中一次出現，但只能有一個作用中。</span><span class="sxs-lookup"><span data-stu-id="8f901-144">Any number of child windows can appear in the client window at any one time, but only one can be active.</span></span> <span data-ttu-id="8f901-145">作用中的子視窗位於所有其他子視窗的前方，而且其框線會反白顯示。</span><span class="sxs-lookup"><span data-stu-id="8f901-145">The active child window is positioned in front of all other child windows, and its border is highlighted.</span></span>

<span data-ttu-id="8f901-146">使用者可以按一下非使用中的子視窗來加以啟用。</span><span class="sxs-lookup"><span data-stu-id="8f901-146">The user can activate an inactive child window by clicking it.</span></span> <span data-ttu-id="8f901-147">MDI 應用程式會將 [**WM \_ MDIACTI加值稅E**](wm-mdiactivate.md) 訊息傳送至 MDI 用戶端視窗，以啟動子視窗。</span><span class="sxs-lookup"><span data-stu-id="8f901-147">An MDI application activates a child window by sending a [**WM\_MDIACTIVATE**](wm-mdiactivate.md) message to the MDI client window.</span></span> <span data-ttu-id="8f901-148">當用戶端視窗處理此訊息時，它會將 **WM \_ MDIACTI加值稅E** 訊息傳送至要啟動之子視窗的視窗程式，以及要停用之子視窗的視窗程式。</span><span class="sxs-lookup"><span data-stu-id="8f901-148">As the client window processes this message, it sends a **WM\_MDIACTIVATE** message to the window procedure of the child window to be activated and to the window procedure of the child window being deactivated.</span></span>

<span data-ttu-id="8f901-149">若要防止子視窗啟動，請傳回 **FALSE**，以將 [**WM \_ NCACTI加值稅E**](wm-ncactivate.md)訊息處理至子視窗。</span><span class="sxs-lookup"><span data-stu-id="8f901-149">To prevent a child window from activating, handle the [**WM\_NCACTIVATE**](wm-ncactivate.md) message to the child window by returning **FALSE**.</span></span>

<span data-ttu-id="8f901-150">系統會在重迭視窗的堆疊中追蹤每個子視窗的位置。</span><span class="sxs-lookup"><span data-stu-id="8f901-150">The system keeps track of each child window's position in the stack of overlapping windows.</span></span> <span data-ttu-id="8f901-151">此堆疊稱為 [Z 順序](window-features.md)。</span><span class="sxs-lookup"><span data-stu-id="8f901-151">This stacking is known as the [Z-Order](window-features.md).</span></span> <span data-ttu-id="8f901-152">使用者可以從使用中視窗中的 [視窗] 功能表按一下 [ **下一步** ]，以 Z 順序啟動下一個子視窗。</span><span class="sxs-lookup"><span data-stu-id="8f901-152">The user can activate the next child window in the Z order by clicking **Next** from the window menu in the active window.</span></span> <span data-ttu-id="8f901-153">應用程式會藉由將 [**WM \_ MDINEXT**](wm-mdinext.md) 訊息傳送至用戶端視窗，來啟動 Z 順序中的下一個 (或先前) 子視窗。</span><span class="sxs-lookup"><span data-stu-id="8f901-153">An application activates the next (or previous) child window in the Z order by sending a [**WM\_MDINEXT**](wm-mdinext.md) message to the client window.</span></span>

<span data-ttu-id="8f901-154">為了取得作用中子視窗的控制碼，MDI 應用程式會將 [**WM \_ MDIGETACTIVE**](wm-mdigetactive.md) 訊息傳送至用戶端視窗。</span><span class="sxs-lookup"><span data-stu-id="8f901-154">To retrieve the handle to the active child window, the MDI application sends a [**WM\_MDIGETACTIVE**](wm-mdigetactive.md) message to the client window.</span></span>

## <a name="multiple-document-menus"></a><span data-ttu-id="8f901-155">多個檔功能表</span><span class="sxs-lookup"><span data-stu-id="8f901-155">Multiple Document Menus</span></span>

<span data-ttu-id="8f901-156">MDI 應用程式的框架視窗應該包含具有視窗功能表的功能表列。</span><span class="sxs-lookup"><span data-stu-id="8f901-156">The frame window of an MDI application should include a menu bar with a window menu.</span></span> <span data-ttu-id="8f901-157">[視窗] 功能表應該包含在用戶端視窗中排列子視窗，或關閉所有子視窗的專案。</span><span class="sxs-lookup"><span data-stu-id="8f901-157">The window menu should include items that arrange the child windows within the client window or that close all child windows.</span></span> <span data-ttu-id="8f901-158">一般 MDI 應用程式的 [視窗] 功能表可能包含下表中的專案。</span><span class="sxs-lookup"><span data-stu-id="8f901-158">The window menu of a typical MDI application might include the items in the following table.</span></span>



| <span data-ttu-id="8f901-159">功能表項目</span><span class="sxs-lookup"><span data-stu-id="8f901-159">Menu item</span></span>         | <span data-ttu-id="8f901-160">目的</span><span class="sxs-lookup"><span data-stu-id="8f901-160">Purpose</span></span>                                                                                                                  |
|-------------------|--------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="8f901-161">**磚**</span><span class="sxs-lookup"><span data-stu-id="8f901-161">**Tile**</span></span>          | <span data-ttu-id="8f901-162">以磚格式排列子視窗，使其在用戶端視窗中全部出現。</span><span class="sxs-lookup"><span data-stu-id="8f901-162">Arranges child windows in a tile format so that each appears in its entirety in the client window.</span></span>                       |
| <span data-ttu-id="8f901-163">**級 聯**</span><span class="sxs-lookup"><span data-stu-id="8f901-163">**Cascade**</span></span>       | <span data-ttu-id="8f901-164">以 cascade 格式排列子視窗。</span><span class="sxs-lookup"><span data-stu-id="8f901-164">Arranges child windows in a cascade format.</span></span> <span data-ttu-id="8f901-165">子視窗彼此重迭，但每個的標題列都是可見的。</span><span class="sxs-lookup"><span data-stu-id="8f901-165">The child windows overlap one another, but the title bar of each is visible.</span></span> |
| <span data-ttu-id="8f901-166">**排列圖示**</span><span class="sxs-lookup"><span data-stu-id="8f901-166">**Arrange Icons**</span></span> | <span data-ttu-id="8f901-167">在用戶端視窗底部排列最小化子視窗的圖示。</span><span class="sxs-lookup"><span data-stu-id="8f901-167">Arranges the icons of minimized child windows along the bottom of the client window.</span></span>                                     |
| <span data-ttu-id="8f901-168">**全部關閉**</span><span class="sxs-lookup"><span data-stu-id="8f901-168">**Close All**</span></span>     | <span data-ttu-id="8f901-169">關閉所有子視窗。</span><span class="sxs-lookup"><span data-stu-id="8f901-169">Closes all child windows.</span></span>                                                                                                |



 

<span data-ttu-id="8f901-170">每當建立子視窗時，系統會自動將新的功能表項目附加至 [視窗] 功能表。</span><span class="sxs-lookup"><span data-stu-id="8f901-170">Whenever a child window is created, the system automatically appends a new menu item to the window menu.</span></span> <span data-ttu-id="8f901-171">功能表項目的文字與新子視窗的功能表列上的文字相同。</span><span class="sxs-lookup"><span data-stu-id="8f901-171">The text of the menu item is the same as the text on the menu bar of the new child window.</span></span> <span data-ttu-id="8f901-172">藉由按一下功能表項目，使用者可以啟動對應的子視窗。</span><span class="sxs-lookup"><span data-stu-id="8f901-172">By clicking the menu item, the user can activate the corresponding child window.</span></span> <span data-ttu-id="8f901-173">當子視窗損毀時，系統會自動從 [視窗] 功能表中移除對應的功能表項目。</span><span class="sxs-lookup"><span data-stu-id="8f901-173">When a child window is destroyed, the system automatically removes the corresponding menu item from the window menu.</span></span>

<span data-ttu-id="8f901-174">系統最多可將十個功能表項目新增至 [視窗] 功能表。</span><span class="sxs-lookup"><span data-stu-id="8f901-174">The system can add up to ten menu items to the window menu.</span></span> <span data-ttu-id="8f901-175">當第十個子視窗建立時，系統會將 [ **其他視窗** ] 專案加入至 [視窗] 功能表。</span><span class="sxs-lookup"><span data-stu-id="8f901-175">When the tenth child window is created, the system adds the **More Windows** item to the window menu.</span></span> <span data-ttu-id="8f901-176">按一下這個專案，就會顯示 [ **選取視窗** ] 對話方塊。</span><span class="sxs-lookup"><span data-stu-id="8f901-176">Clicking this item displays the **Select Window** dialog box.</span></span> <span data-ttu-id="8f901-177">此對話方塊包含清單方塊，其中包含目前可用的所有 MDI 子視窗的標題。</span><span class="sxs-lookup"><span data-stu-id="8f901-177">The dialog box contains a list box with the titles of all MDI child windows currently available.</span></span> <span data-ttu-id="8f901-178">使用者可以在清單方塊中按一下其標題，以啟用子視窗。</span><span class="sxs-lookup"><span data-stu-id="8f901-178">The user can activate a child window by clicking its title in the list box.</span></span>

<span data-ttu-id="8f901-179">如果您的 MDI 應用程式支援數種類型的子視窗，請調整功能表列，以反映與使用中視窗相關聯的作業。</span><span class="sxs-lookup"><span data-stu-id="8f901-179">If your MDI application supports several types of child windows, tailor the menu bar to reflect the operations associated with the active window.</span></span> <span data-ttu-id="8f901-180">若要這樣做，請為應用程式支援的每個子視窗類型提供個別的功能表資源。</span><span class="sxs-lookup"><span data-stu-id="8f901-180">To do this, provide separate menu resources for each type of child window the application supports.</span></span> <span data-ttu-id="8f901-181">當啟用新的子視窗類型時，應用程式應該將 [**WM \_ MDISETMENU**](wm-mdisetmenu.md) 訊息傳送至用戶端視窗，並將控制碼傳遞至對應的功能表。</span><span class="sxs-lookup"><span data-stu-id="8f901-181">When a new type of child window is activated, the application should send a [**WM\_MDISETMENU**](wm-mdisetmenu.md) message to the client window, passing to it the handle to the corresponding menu.</span></span>

<span data-ttu-id="8f901-182">當沒有子視窗存在時，功能表列應該只包含用來建立或開啟檔的專案。</span><span class="sxs-lookup"><span data-stu-id="8f901-182">When no child window exists, the menu bar should contain only items used to create or open a document.</span></span>

<span data-ttu-id="8f901-183">當使用者使用游標按鍵流覽 MDI 應用程式的功能表時，索引鍵的行為會與使用者流覽一般應用程式功能表時的行為不同。</span><span class="sxs-lookup"><span data-stu-id="8f901-183">When the user is navigating through an MDI application's menus by using cursor keys, the keys behave differently than when the user is navigating through a typical application's menus.</span></span> <span data-ttu-id="8f901-184">在 MDI 應用程式中，控制權會從應用程式的 [視窗] 功能表移至 [作用中子視窗] 的 [視窗] 功能表，然後再傳遞至功能表列上的第一個專案。</span><span class="sxs-lookup"><span data-stu-id="8f901-184">In an MDI application, control passes from the application's window menu to the window menu of the active child window, and then to the first item on the menu bar.</span></span>

## <a name="multiple-document-accelerators"></a><span data-ttu-id="8f901-185">多個檔加速器</span><span class="sxs-lookup"><span data-stu-id="8f901-185">Multiple Document Accelerators</span></span>

<span data-ttu-id="8f901-186">若要接收和處理其子視窗的快速鍵，MDI 應用程式必須在其訊息迴圈中包含 [**TranslateMDISysAccel**](/windows/win32/api/winuser/nf-winuser-translatemdisysaccel) 函式。</span><span class="sxs-lookup"><span data-stu-id="8f901-186">To receive and process accelerator keys for its child windows, an MDI application must include the [**TranslateMDISysAccel**](/windows/win32/api/winuser/nf-winuser-translatemdisysaccel) function in its message loop.</span></span> <span data-ttu-id="8f901-187">迴圈必須先呼叫 **TranslateMDISysAccel** ，然後再呼叫 [**TranslateAccelerator**](/windows/desktop/api/winuser/nf-winuser-translateacceleratora) 或 [**DispatchMessage**](/windows/win32/api/winuser/nf-winuser-dispatchmessage) 函數。</span><span class="sxs-lookup"><span data-stu-id="8f901-187">The loop must call **TranslateMDISysAccel** before calling the [**TranslateAccelerator**](/windows/desktop/api/winuser/nf-winuser-translateacceleratora) or [**DispatchMessage**](/windows/win32/api/winuser/nf-winuser-dispatchmessage) function.</span></span>

<span data-ttu-id="8f901-188">MDI 子視窗的 [視窗] 功能表上的快速鍵會與非 MDI 子視窗的快速鍵不同。</span><span class="sxs-lookup"><span data-stu-id="8f901-188">Accelerator keys on the window menu for an MDI child window are different from those for a non-MDI child window.</span></span> <span data-ttu-id="8f901-189">在 MDI 子視窗中，ALT + – (減號) 按鍵組合會開啟 [視窗] 功能表、CTRL + F4 按鍵組合會關閉作用中的子視窗，而 CTRL + F6 按鍵組合會啟動下一個子視窗。</span><span class="sxs-lookup"><span data-stu-id="8f901-189">In an MDI child window, the ALT+ – (minus) key combination opens the window menu, the CTRL+F4 key combination closes the active child window, and the CTRL+F6 key combination activates the next child window.</span></span>

## <a name="child-window-size-and-arrangement"></a><span data-ttu-id="8f901-190">子視窗大小和相片順序</span><span class="sxs-lookup"><span data-stu-id="8f901-190">Child Window Size and Arrangement</span></span>

<span data-ttu-id="8f901-191">MDI 應用程式會藉由將訊息傳送至 MDI 用戶端視窗，來控制其子視窗的大小和位置。</span><span class="sxs-lookup"><span data-stu-id="8f901-191">An MDI application controls the size and position of its child windows by sending messages to the MDI client window.</span></span> <span data-ttu-id="8f901-192">為了最大化作用中的子視窗，此應用程式會將 [**WM \_ MDIMAXIMIZE**](wm-mdimaximize.md) 訊息傳送至用戶端視窗。</span><span class="sxs-lookup"><span data-stu-id="8f901-192">To maximize the active child window, the application sends the [**WM\_MDIMAXIMIZE**](wm-mdimaximize.md) message to the client window.</span></span> <span data-ttu-id="8f901-193">當子視窗最大化時，其用戶端區域就會完全填滿 MDI 用戶端視窗。</span><span class="sxs-lookup"><span data-stu-id="8f901-193">When a child window is maximized, its client area completely fills the MDI client window.</span></span> <span data-ttu-id="8f901-194">此外，系統會自動隱藏子視窗的標題列，並將子視窗的 [視窗] 功能表圖示和 [還原] 按鈕加入至 MDI 應用程式的功能表列。</span><span class="sxs-lookup"><span data-stu-id="8f901-194">In addition, the system automatically hides the child window's title bar, and adds the child window's window menu icon and Restore button to the MDI application's menu bar.</span></span> <span data-ttu-id="8f901-195">應用程式可以將用戶端視窗還原至其原始 (premaximized) 大小和位置，方法是將用戶端視窗傳送至 [**WM \_ MDIRESTORE**](wm-mdirestore.md) 訊息。</span><span class="sxs-lookup"><span data-stu-id="8f901-195">The application can restore the client window to its original (premaximized) size and position by sending the client window a [**WM\_MDIRESTORE**](wm-mdirestore.md) message.</span></span>

<span data-ttu-id="8f901-196">MDI 應用程式可以使用 cascade 或圖格格式來排列其子視窗。</span><span class="sxs-lookup"><span data-stu-id="8f901-196">An MDI application can arrange its child windows in either a cascade or tile format.</span></span> <span data-ttu-id="8f901-197">當子視窗進行串聯時，視窗會出現在堆疊中。</span><span class="sxs-lookup"><span data-stu-id="8f901-197">When the child windows are cascaded, the windows appear in a stack.</span></span> <span data-ttu-id="8f901-198">堆疊底部的視窗會佔用畫面的左上角，其餘視窗則會垂直和水準位移，讓每個子視窗的左邊框線和標題列都可以看見。</span><span class="sxs-lookup"><span data-stu-id="8f901-198">The window on the bottom of the stack occupies the upper left corner of the screen, and the remaining windows are offset vertically and horizontally so that the left border and title bar of each child window is visible.</span></span> <span data-ttu-id="8f901-199">為了以串聯格式排列子視窗，MDI 應用程式會傳送 [**WM \_ MDICASCADE**](wm-mdicascade.md) 訊息。</span><span class="sxs-lookup"><span data-stu-id="8f901-199">To arrange child windows in the cascade format, an MDI application sends the [**WM\_MDICASCADE**](wm-mdicascade.md) message.</span></span> <span data-ttu-id="8f901-200">一般情況下，當使用者按一下 [視窗] 功能表上的 [ **Cascade** ] 時，應用程式就會傳送此訊息。</span><span class="sxs-lookup"><span data-stu-id="8f901-200">Typically, the application sends this message when the user clicks **Cascade** on the window menu.</span></span>

<span data-ttu-id="8f901-201">將子視窗並排顯示時，系統會將每個子視窗全部顯示，而不會重迭任何視窗。</span><span class="sxs-lookup"><span data-stu-id="8f901-201">When the child windows are tiled, the system displays each child window in its entirety — overlapping none of the windows.</span></span> <span data-ttu-id="8f901-202">所有視窗都是根據需要調整，以符合用戶端視窗的大小。</span><span class="sxs-lookup"><span data-stu-id="8f901-202">All of the windows are sized, as necessary, to fit within the client window.</span></span> <span data-ttu-id="8f901-203">為了排列磚格式的子視窗，MDI 應用程式會將 [**WM \_ MDITILE**](wm-mditile.md) 訊息傳送至用戶端視窗。</span><span class="sxs-lookup"><span data-stu-id="8f901-203">To arrange child windows in the tile format, an MDI application sends a [**WM\_MDITILE**](wm-mditile.md) message to the client window.</span></span> <span data-ttu-id="8f901-204">一般來說，當使用者按一下 [視窗] 功能表上的 [ **圖** 格] 時，應用程式就會傳送此訊息。</span><span class="sxs-lookup"><span data-stu-id="8f901-204">Typically, the application sends this message when the user clicks **Tile** on the window menu.</span></span>

<span data-ttu-id="8f901-205">MDI 應用程式應該為其支援的每個子視窗類型提供不同的圖示。</span><span class="sxs-lookup"><span data-stu-id="8f901-205">An MDI application should provide a different icon for each type of child window it supports.</span></span> <span data-ttu-id="8f901-206">應用程式會在註冊子視窗類別時，指定一個圖示。</span><span class="sxs-lookup"><span data-stu-id="8f901-206">The application specifies an icon when registering the child window class.</span></span> <span data-ttu-id="8f901-207">當子視窗最小化時，系統會自動在用戶端視窗的下半部顯示子視窗的圖示。</span><span class="sxs-lookup"><span data-stu-id="8f901-207">The system automatically displays a child window's icon in the lower portion of the client window when the child window is minimized.</span></span> <span data-ttu-id="8f901-208">MDI 應用程式會將 [**WM \_ MDIICONARRANGE**](wm-mdiiconarrange.md) 訊息傳送至用戶端視窗，以指示系統排列子視窗圖示。</span><span class="sxs-lookup"><span data-stu-id="8f901-208">An MDI application directs the system to arrange child window icons by sending a [**WM\_MDIICONARRANGE**](wm-mdiiconarrange.md) message to the client window.</span></span> <span data-ttu-id="8f901-209">一般情況下，應用程式會在使用者按一下 [視窗] 功能表上的 [ **排列圖示** ] 時傳送此訊息。</span><span class="sxs-lookup"><span data-stu-id="8f901-209">Typically, the application sends this message when the user clicks **Arrange Icons** on the window menu.</span></span>

## <a name="icon-title-windows"></a><span data-ttu-id="8f901-210">圖示標題視窗</span><span class="sxs-lookup"><span data-stu-id="8f901-210">Icon Title Windows</span></span>

<span data-ttu-id="8f901-211">由於 MDI 子視窗可能會最小化，因此 MDI 應用程式必須避免將圖示標題視窗視為一般的 MDI 子視窗來操作。</span><span class="sxs-lookup"><span data-stu-id="8f901-211">Because MDI child windows may be minimized, an MDI application must avoid manipulating icon title windows as if they were normal MDI child windows.</span></span> <span data-ttu-id="8f901-212">當應用程式列舉 MDI 用戶端視窗的子視窗時，就會出現圖示標題視窗。</span><span class="sxs-lookup"><span data-stu-id="8f901-212">Icon title windows appear when the application enumerates child windows of the MDI client window.</span></span> <span data-ttu-id="8f901-213">圖示標題視窗與其他子視窗不同，但它們是由 MDI 子視窗所擁有。</span><span class="sxs-lookup"><span data-stu-id="8f901-213">Icon title windows differ from other child windows, however, in that they are owned by an MDI child window.</span></span>

<span data-ttu-id="8f901-214">若要判斷子視窗是否為圖示標題視窗，請使用 [**GetWindow**](/windows/win32/api/winuser/nf-winuser-getwindow) 函式搭配 GW \_ 擁有者索引。</span><span class="sxs-lookup"><span data-stu-id="8f901-214">To determine whether a child window is an icon title window, use the [**GetWindow**](/windows/win32/api/winuser/nf-winuser-getwindow) function with the GW\_OWNER index.</span></span> <span data-ttu-id="8f901-215">非標題視窗傳回 **Null**。</span><span class="sxs-lookup"><span data-stu-id="8f901-215">Non-title windows return **NULL**.</span></span> <span data-ttu-id="8f901-216">請注意，此測試不適用於最上層視窗，因為功能表和對話方塊是擁有的視窗。</span><span class="sxs-lookup"><span data-stu-id="8f901-216">Note that this test is insufficient for top-level windows, because menus and dialog boxes are owned windows.</span></span>

## <a name="child-window-data"></a><span data-ttu-id="8f901-217">子視窗資料</span><span class="sxs-lookup"><span data-stu-id="8f901-217">Child Window Data</span></span>

<span data-ttu-id="8f901-218">由於子視窗的數目視使用者開啟的檔數目而異，因此 MDI 應用程式必須能夠將資料 (例如，目前檔案的名稱與每個子視窗) 。</span><span class="sxs-lookup"><span data-stu-id="8f901-218">Because the number of child windows varies depending on how many documents the user opens, an MDI application must be able to associate data (for example, the name of the current file) with each child window.</span></span> <span data-ttu-id="8f901-219">作法有二：</span><span class="sxs-lookup"><span data-stu-id="8f901-219">There are two ways to do this:</span></span>

-   <span data-ttu-id="8f901-220">將子視窗資料儲存在視窗結構中。</span><span class="sxs-lookup"><span data-stu-id="8f901-220">Store child window data in the window structure.</span></span>
-   <span data-ttu-id="8f901-221">使用視窗屬性。</span><span class="sxs-lookup"><span data-stu-id="8f901-221">Use window properties.</span></span>

### <a name="window-structure"></a><span data-ttu-id="8f901-222">視窗結構</span><span class="sxs-lookup"><span data-stu-id="8f901-222">Window Structure</span></span>

<span data-ttu-id="8f901-223">當 MDI 應用程式註冊視窗類別時，它可能會在視窗結構中保留額外的空間，以供此特定 windows 類別專用的應用程式資料使用。</span><span class="sxs-lookup"><span data-stu-id="8f901-223">When an MDI application registers a window class, it may reserve extra space in the window structure for application data specific to this particular class of windows.</span></span> <span data-ttu-id="8f901-224">若要在這個額外的空間中儲存和取出資料，應用程式會使用 [**GetWindowLong**](/windows/win32/api/winuser/nf-winuser-getwindowlonga) 和 [**SetWindowLong**](/windows/win32/api/winuser/nf-winuser-setwindowlonga) 函數。</span><span class="sxs-lookup"><span data-stu-id="8f901-224">To store and retrieve data in this extra space, the application uses the [**GetWindowLong**](/windows/win32/api/winuser/nf-winuser-getwindowlonga) and [**SetWindowLong**](/windows/win32/api/winuser/nf-winuser-setwindowlonga) functions.</span></span>

<span data-ttu-id="8f901-225">若要維護子視窗的大量資料，應用程式可以配置資料結構的記憶體，然後將此控制碼儲存在與子視窗相關聯的額外空間中，包含結構的記憶體。</span><span class="sxs-lookup"><span data-stu-id="8f901-225">To maintain a large amount of data for a child window, an application can allocate memory for a data structure and then store the handle to the memory containing the structure in the extra space associated with the child window.</span></span>

### <a name="window-properties"></a><span data-ttu-id="8f901-226">視窗屬性</span><span class="sxs-lookup"><span data-stu-id="8f901-226">Window Properties</span></span>

<span data-ttu-id="8f901-227">MDI 應用程式也可以使用視窗屬性來儲存每一份檔的資料。</span><span class="sxs-lookup"><span data-stu-id="8f901-227">An MDI application can also store per-document data by using window properties.</span></span> <span data-ttu-id="8f901-228">*每一檔資料* 是特定子視窗中包含之檔案類型的特定資料。</span><span class="sxs-lookup"><span data-stu-id="8f901-228">*Per-document data* is data specific to the type of document contained in a particular child window.</span></span> <span data-ttu-id="8f901-229">屬性與視窗結構中的額外空間不同，因為在註冊視窗類別時，您不需要配置額外的空間。</span><span class="sxs-lookup"><span data-stu-id="8f901-229">Properties are different from extra space in the window structure in that you need not allocate extra space when registering the window class.</span></span> <span data-ttu-id="8f901-230">視窗可以有任意數目的屬性。</span><span class="sxs-lookup"><span data-stu-id="8f901-230">A window can have any number of properties.</span></span> <span data-ttu-id="8f901-231">此外，使用位移來存取視窗結構中的額外空間時，屬性是由字串名稱所參考。</span><span class="sxs-lookup"><span data-stu-id="8f901-231">Also, where offsets are used to access the extra space in window structures, properties are referred to by string names.</span></span> <span data-ttu-id="8f901-232">如需有關視窗屬性的詳細資訊，請參閱 [視窗屬性](window-properties.md)。</span><span class="sxs-lookup"><span data-stu-id="8f901-232">For more information about window properties, see [Window Properties](window-properties.md).</span></span>

 

 
