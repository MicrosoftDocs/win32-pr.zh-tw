---
description: 列出針對 WSDAPI 應用程式進行疑難排解時要使用的診斷程式。
ms.assetid: befe4234-8d3a-4fc5-9a7d-faca94964af6
title: 針對其他 WSDAPI 應用程式進行疑難排解
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 28a421f26237cc14d07a43e00faeb6d8bf49aa02
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/07/2021
ms.locfileid: "106996625"
---
# <a name="troubleshooting-other-wsdapi-applications"></a><span data-ttu-id="efe18-103">針對其他 WSDAPI 應用程式進行疑難排解</span><span class="sxs-lookup"><span data-stu-id="efe18-103">Troubleshooting Other WSDAPI Applications</span></span>

<span data-ttu-id="efe18-104">應用程式可以直接呼叫 WSDAPI 介面和函式來執行裝置探索和中繼資料交換。</span><span class="sxs-lookup"><span data-stu-id="efe18-104">Applications can directly call into WSDAPI interfaces and functions to perform device discovery and metadata exchange.</span></span> <span data-ttu-id="efe18-105">這些應用程式所使用的訊息模式會有所不同。</span><span class="sxs-lookup"><span data-stu-id="efe18-105">The message patterns used by these applications vary.</span></span>

<span data-ttu-id="efe18-106">此疑難排解指南的目標是協助 WSDAPI 應用程式開發人員成功地執行裝置 proxy。</span><span class="sxs-lookup"><span data-stu-id="efe18-106">The goal of this troubleshooting guide is to help WSDAPI application developers successfully implement a device proxy.</span></span> <span data-ttu-id="efe18-107">本指南的目的並非協助您疑難排解 WSDAPI 的所有層面。</span><span class="sxs-lookup"><span data-stu-id="efe18-107">This guide is not intended to help troubleshoot all aspects of WSDAPI.</span></span> <span data-ttu-id="efe18-108">如果已成功建立裝置 proxy，且用戶端和主機可以在網路上看到彼此，則本指南無法解決應用程式的問題。</span><span class="sxs-lookup"><span data-stu-id="efe18-108">If the device proxy has been successfully created and the client and host can see each other on the network, then this guide cannot address the application's problems.</span></span> <span data-ttu-id="efe18-109">若要針對這些應用程式問題進行疑難排解，請遵循 [啟用 WSDAPI 追蹤](enabling-wsdapi-tracing.md) 的指示，並聯絡 Microsoft 支援服務尋求進一步的協助。</span><span class="sxs-lookup"><span data-stu-id="efe18-109">To troubleshoot these application problems, follow the instructions in [Enabling WSDAPI Tracing](enabling-wsdapi-tracing.md) and contact Microsoft support for further assistance.</span></span>

## <a name="troubleshooting-clients-calling-wsdcreatedeviceproxy"></a><span data-ttu-id="efe18-110">針對呼叫 WSDCreateDeviceProxy 的用戶端進行疑難排解</span><span class="sxs-lookup"><span data-stu-id="efe18-110">Troubleshooting clients calling WSDCreateDeviceProxy</span></span>

<span data-ttu-id="efe18-111">應用程式會呼叫 [**WSDCreateDeviceProxy**](/windows/desktop/api/WsdClient/nf-wsdclient-wsdcreatedeviceproxy) 來建立和初始化 [**IWSDDeviceProxy**](/windows/desktop/api/WsdClient/nn-wsdclient-iwsddeviceproxy) 介面的實例。</span><span class="sxs-lookup"><span data-stu-id="efe18-111">Applications call [**WSDCreateDeviceProxy**](/windows/desktop/api/WsdClient/nf-wsdclient-wsdcreatedeviceproxy) to create and initialize an instance of the [**IWSDDeviceProxy**](/windows/desktop/api/WsdClient/nn-wsdclient-iwsddeviceproxy) interface.</span></span> <span data-ttu-id="efe18-112">此裝置 proxy 物件可用來通告裝置上的服務，也可以用來交換中繼資料。</span><span class="sxs-lookup"><span data-stu-id="efe18-112">This device proxy object can be used to advertise services on a device and also to exchange metadata.</span></span>

<span data-ttu-id="efe18-113">呼叫 [**WSDCreateDeviceProxy**](/windows/desktop/api/WsdClient/nf-wsdclient-wsdcreatedeviceproxy) 的應用程式一律會使用下列訊息。</span><span class="sxs-lookup"><span data-stu-id="efe18-113">An application calling [**WSDCreateDeviceProxy**](/windows/desktop/api/WsdClient/nf-wsdclient-wsdcreatedeviceproxy) always uses the following messages.</span></span>

-   [<span data-ttu-id="efe18-114">Get</span><span class="sxs-lookup"><span data-stu-id="efe18-114">Get</span></span>](get--metadata-exchange--http-request-and-message.md)
-   [<span data-ttu-id="efe18-115">GetResponse</span><span class="sxs-lookup"><span data-stu-id="efe18-115">GetResponse</span></span>](getresponse--metadata-exchange--message.md)

<span data-ttu-id="efe18-116">呼叫 [**WSDCreateDeviceProxy**](/windows/desktop/api/WsdClient/nf-wsdclient-wsdcreatedeviceproxy) 的應用程式有時會使用下列訊息。</span><span class="sxs-lookup"><span data-stu-id="efe18-116">An application calling [**WSDCreateDeviceProxy**](/windows/desktop/api/WsdClient/nf-wsdclient-wsdcreatedeviceproxy) sometimes uses the following messages.</span></span>

-   [<span data-ttu-id="efe18-117">解決</span><span class="sxs-lookup"><span data-stu-id="efe18-117">Resolve</span></span>](resolve-message.md)
-   [<span data-ttu-id="efe18-118">ResolveMatches</span><span class="sxs-lookup"><span data-stu-id="efe18-118">ResolveMatches</span></span>](resolvematches-message.md)

<span data-ttu-id="efe18-119">當邏輯裝置位址 (時，會產生 [解析](resolve-message.md)和 [ResolveMatches](resolvematches-message.md)訊息，格式 urn： uuid： {guid} ) 的裝置位址會傳遞至 *pszDeviceId*。</span><span class="sxs-lookup"><span data-stu-id="efe18-119">[Resolve](resolve-message.md) and [ResolveMatches](resolvematches-message.md) messages are generated when a logical device address (that is, a device address of the form urn:uuid:{guid}) is passed to *pszDeviceId*.</span></span> <span data-ttu-id="efe18-120">當實體裝置位址傳遞至 *pszDeviceId* 時，不會產生這些訊息。</span><span class="sxs-lookup"><span data-stu-id="efe18-120">These messages are not generated when a physical device address is passed to *pszDeviceId*.</span></span> <span data-ttu-id="efe18-121">當使用 Resolve 和 ResolveMatches 訊息時，會在 [Get](get--metadata-exchange--http-request-and-message.md) 和 [GetResponse](getresponse--metadata-exchange--message.md) 訊息之前傳送這些訊息。</span><span class="sxs-lookup"><span data-stu-id="efe18-121">When Resolve and ResolveMatches messages are used, they are sent before the [Get](get--metadata-exchange--http-request-and-message.md) and [GetResponse](getresponse--metadata-exchange--message.md) messages.</span></span>

<span data-ttu-id="efe18-122">您應使用下列診斷程式 (順序) ，以協助找出使用實體裝置位址呼叫 [**WSDCreateDeviceProxy**](/windows/desktop/api/WsdClient/nf-wsdclient-wsdcreatedeviceproxy) 的應用程式發生問題。</span><span class="sxs-lookup"><span data-stu-id="efe18-122">The following diagnostic procedures should be used (in order) to help identify problems with an application calling [**WSDCreateDeviceProxy**](/windows/desktop/api/WsdClient/nf-wsdclient-wsdcreatedeviceproxy) with a physical device address.</span></span>

1.  <span data-ttu-id="efe18-123">[檢查介面卡和防火牆設定](inspecting-adapter-and-firewall-settings.md)。</span><span class="sxs-lookup"><span data-stu-id="efe18-123">[Inspect adapter and firewall settings](inspecting-adapter-and-firewall-settings.md).</span></span>
2.  <span data-ttu-id="efe18-124">[使用泛型主機和用戶端進行 HTTP 中繼資料交換](using-a-generic-host-and-client-for-http-metadata-exchange.md)。</span><span class="sxs-lookup"><span data-stu-id="efe18-124">[Use a generic host and client for HTTP metadata exchange](using-a-generic-host-and-client-for-http-metadata-exchange.md).</span></span>
3.  <span data-ttu-id="efe18-125">[使用 WinHTTP 記錄來確認取得流量](using-winhttp-logging-to-verify-get-traffic.md)。</span><span class="sxs-lookup"><span data-stu-id="efe18-125">[Use WinHTTP logging to verify Get traffic](using-winhttp-logging-to-verify-get-traffic.md).</span></span>
4.  <span data-ttu-id="efe18-126">[檢查 HTTP 中繼資料交換的網路追蹤](inspecting-network-traces-for-http-metadata-exchange.md)。</span><span class="sxs-lookup"><span data-stu-id="efe18-126">[Inspect network traces for HTTP metadata exchange](inspecting-network-traces-for-http-metadata-exchange.md).</span></span>

<span data-ttu-id="efe18-127">您應使用下列診斷程式 (順序) ，以協助找出使用邏輯裝置位址呼叫 [**WSDCreateDeviceProxy**](/windows/desktop/api/WsdClient/nf-wsdclient-wsdcreatedeviceproxy) 的應用程式發生問題。</span><span class="sxs-lookup"><span data-stu-id="efe18-127">The following diagnostic procedures should be used (in order) to help identify problems with an application calling [**WSDCreateDeviceProxy**](/windows/desktop/api/WsdClient/nf-wsdclient-wsdcreatedeviceproxy) with a logical device address.</span></span>

1.  <span data-ttu-id="efe18-128">[檢查介面卡和防火牆設定](inspecting-adapter-and-firewall-settings.md)。</span><span class="sxs-lookup"><span data-stu-id="efe18-128">[Inspect adapter and firewall settings](inspecting-adapter-and-firewall-settings.md).</span></span>
2.  <span data-ttu-id="efe18-129">[使用泛型主機和用戶端進行 UDP WS 探索](using-a-generic-host-and-client-for-udp-ws-discovery.md)。</span><span class="sxs-lookup"><span data-stu-id="efe18-129">[Use a generic host and client for UDP WS-Discovery](using-a-generic-host-and-client-for-udp-ws-discovery.md).</span></span>
3.  <span data-ttu-id="efe18-130">[使用 WSD Debug 用戶端來驗證多播流量](using-wsddebug-client-to-verify-multicast-traffic.md)。</span><span class="sxs-lookup"><span data-stu-id="efe18-130">[Use WSD Debug Client to verify multicast traffic](using-wsddebug-client-to-verify-multicast-traffic.md).</span></span>
4.  <span data-ttu-id="efe18-131">[檢查 UDP WS-探索的網路追蹤](inspecting-network-traces-for-udp-ws-discovery.md)。</span><span class="sxs-lookup"><span data-stu-id="efe18-131">[Inspect network traces for UDP WS-Discovery](inspecting-network-traces-for-udp-ws-discovery.md).</span></span>
5.  <span data-ttu-id="efe18-132">[使用泛型主機和用戶端進行 HTTP 中繼資料交換](using-a-generic-host-and-client-for-http-metadata-exchange.md)。</span><span class="sxs-lookup"><span data-stu-id="efe18-132">[Use a generic host and client for HTTP metadata exchange](using-a-generic-host-and-client-for-http-metadata-exchange.md).</span></span>
6.  <span data-ttu-id="efe18-133">[使用 WinHTTP 記錄來確認取得流量](using-winhttp-logging-to-verify-get-traffic.md)。</span><span class="sxs-lookup"><span data-stu-id="efe18-133">[Use WinHTTP logging to verify Get traffic](using-winhttp-logging-to-verify-get-traffic.md).</span></span>
7.  <span data-ttu-id="efe18-134">[檢查 HTTP 中繼資料交換的網路追蹤](inspecting-network-traces-for-http-metadata-exchange.md)。</span><span class="sxs-lookup"><span data-stu-id="efe18-134">[Inspect network traces for HTTP metadata exchange](inspecting-network-traces-for-http-metadata-exchange.md).</span></span>

<span data-ttu-id="efe18-135">確認已產生 [解析](resolve-message.md) 和 [ResolveMatches](resolvematches-message.md) 訊息，並符合流量需求。</span><span class="sxs-lookup"><span data-stu-id="efe18-135">Verify that [Resolve](resolve-message.md) and [ResolveMatches](resolvematches-message.md) messages are generated and meet traffic requirements.</span></span> <span data-ttu-id="efe18-136">不需要在 WSD Debug 用戶端輸出或網路追蹤中尋找 [探查](probe-message.md) 或 [ProbeMatches](probematches-message.md) 訊息。</span><span class="sxs-lookup"><span data-stu-id="efe18-136">It is not necessary to look for [Probe](probe-message.md) or [ProbeMatches](probematches-message.md) messages in the WSD Debug Client output or in the network traces.</span></span>

## <a name="troubleshooting-clients-calling-wsdcreatedeviceproxyadvanced"></a><span data-ttu-id="efe18-137">針對呼叫 WSDCreateDeviceProxyAdvanced 的用戶端進行疑難排解</span><span class="sxs-lookup"><span data-stu-id="efe18-137">Troubleshooting clients calling WSDCreateDeviceProxyAdvanced</span></span>

<span data-ttu-id="efe18-138">應用程式會呼叫 [**WSDCreateDeviceProxyAdvanced**](/windows/desktop/api/WsdClient/nf-wsdclient-wsdcreatedeviceproxyadvanced) 來建立和初始化 [**IWSDDeviceProxy**](/windows/desktop/api/WsdClient/nn-wsdclient-iwsddeviceproxy) 介面的實例。</span><span class="sxs-lookup"><span data-stu-id="efe18-138">Applications call [**WSDCreateDeviceProxyAdvanced**](/windows/desktop/api/WsdClient/nf-wsdclient-wsdcreatedeviceproxyadvanced) to create and initialize an instance of the [**IWSDDeviceProxy**](/windows/desktop/api/WsdClient/nn-wsdclient-iwsddeviceproxy) interface.</span></span> <span data-ttu-id="efe18-139">不同于 [**WSDCreateDeviceProxy**](/windows/desktop/api/WsdClient/nf-wsdclient-wsdcreatedeviceproxy)， **WSDCreateDeviceProxyAdvanced** 具有用來定義裝置傳輸位址的 *pDeviceAddress* 參數。</span><span class="sxs-lookup"><span data-stu-id="efe18-139">Unlike [**WSDCreateDeviceProxy**](/windows/desktop/api/WsdClient/nf-wsdclient-wsdcreatedeviceproxy), **WSDCreateDeviceProxyAdvanced** has a *pDeviceAddress* parameter that is used to define the device transport address.</span></span> <span data-ttu-id="efe18-140">如果指定此傳輸位址，則不需要邏輯位址解析，且不會產生 [解析](resolve-message.md) 和 [ResolveMatches](resolvematches-message.md) 訊息。</span><span class="sxs-lookup"><span data-stu-id="efe18-140">If this transport address is specified, then logical address resolution is not required and [Resolve](resolve-message.md) and [ResolveMatches](resolvematches-message.md) messages are not generated.</span></span>

<span data-ttu-id="efe18-141">如果 *pDeviceAddress* 設定為 **Null** ，而 *pszDeviceId* 是邏輯位址，則需要解決位址，而且會產生 [解析](resolve-message.md) 和 [ResolveMatches](resolvematches-message.md) 訊息。</span><span class="sxs-lookup"><span data-stu-id="efe18-141">If *pDeviceAddress* is set to **NULL** and *pszDeviceId* is a logical address, then address resolution is required and [Resolve](resolve-message.md) and [ResolveMatches](resolvematches-message.md) messages are generated.</span></span>

<span data-ttu-id="efe18-142">下列診斷程式應依序 (使用) ，以協助找出使用非 **Null**_PDeviceAddress_ 參數呼叫 [**WSDCreateDeviceProxyAdvanced**](/windows/desktop/api/WsdClient/nf-wsdclient-wsdcreatedeviceproxyadvanced)的應用程式問題。</span><span class="sxs-lookup"><span data-stu-id="efe18-142">The following diagnostic procedures should be used (in order) to help identify problems with an application calling [**WSDCreateDeviceProxyAdvanced**](/windows/desktop/api/WsdClient/nf-wsdclient-wsdcreatedeviceproxyadvanced) with a non-**NULL**_pDeviceAddress_ parameter.</span></span> <span data-ttu-id="efe18-143">當 *pDeviceAddress* 為 **Null** 且 *pszDeviceId* 是實體位址時，也可以使用這些程式。</span><span class="sxs-lookup"><span data-stu-id="efe18-143">These procedures can also be used when *pDeviceAddress* is **NULL** and *pszDeviceId* is a physical address.</span></span>

1.  <span data-ttu-id="efe18-144">[檢查介面卡和防火牆設定](inspecting-adapter-and-firewall-settings.md)。</span><span class="sxs-lookup"><span data-stu-id="efe18-144">[Inspect adapter and firewall settings](inspecting-adapter-and-firewall-settings.md).</span></span>
2.  <span data-ttu-id="efe18-145">[使用泛型主機和用戶端進行 HTTP 中繼資料交換](using-a-generic-host-and-client-for-http-metadata-exchange.md)。</span><span class="sxs-lookup"><span data-stu-id="efe18-145">[Use a generic host and client for HTTP metadata exchange](using-a-generic-host-and-client-for-http-metadata-exchange.md).</span></span>
3.  <span data-ttu-id="efe18-146">[使用 WinHTTP 記錄來確認取得流量](using-winhttp-logging-to-verify-get-traffic.md)。</span><span class="sxs-lookup"><span data-stu-id="efe18-146">[Use WinHTTP logging to verify Get traffic](using-winhttp-logging-to-verify-get-traffic.md).</span></span>
4.  <span data-ttu-id="efe18-147">[檢查 HTTP 中繼資料交換的網路追蹤](inspecting-network-traces-for-http-metadata-exchange.md)。</span><span class="sxs-lookup"><span data-stu-id="efe18-147">[Inspect network traces for HTTP metadata exchange](inspecting-network-traces-for-http-metadata-exchange.md).</span></span>

<span data-ttu-id="efe18-148">您應使用下列診斷程式 (順序) ，以協助找出應用程式的問題，並將 *pDeviceAddress* 設定為 **Null** ，並將 *pszDeviceId* 設定為邏輯位址，以找出呼叫 [**WSDCreateDeviceProxyAdvanced**](/windows/desktop/api/WsdClient/nf-wsdclient-wsdcreatedeviceproxyadvanced)的應用程式問題。</span><span class="sxs-lookup"><span data-stu-id="efe18-148">The following diagnostic procedures should be used (in order) to help identify problems with an application calling [**WSDCreateDeviceProxyAdvanced**](/windows/desktop/api/WsdClient/nf-wsdclient-wsdcreatedeviceproxyadvanced) with *pDeviceAddress* set to **NULL** and with *pszDeviceId* set to a logical address.</span></span>

1.  <span data-ttu-id="efe18-149">[檢查介面卡和防火牆設定](inspecting-adapter-and-firewall-settings.md)。</span><span class="sxs-lookup"><span data-stu-id="efe18-149">[Inspect adapter and firewall settings](inspecting-adapter-and-firewall-settings.md).</span></span>
2.  <span data-ttu-id="efe18-150">[使用泛型主機和用戶端進行 UDP WS 探索](using-a-generic-host-and-client-for-udp-ws-discovery.md)。</span><span class="sxs-lookup"><span data-stu-id="efe18-150">[Use a generic host and client for UDP WS-Discovery](using-a-generic-host-and-client-for-udp-ws-discovery.md).</span></span>
3.  <span data-ttu-id="efe18-151">[使用 WSD Debug 用戶端來驗證多播流量](using-wsddebug-client-to-verify-multicast-traffic.md)。</span><span class="sxs-lookup"><span data-stu-id="efe18-151">[Use WSD Debug Client to verify multicast traffic](using-wsddebug-client-to-verify-multicast-traffic.md).</span></span>
4.  <span data-ttu-id="efe18-152">[檢查 UDP WS-探索的網路追蹤](inspecting-network-traces-for-udp-ws-discovery.md)。</span><span class="sxs-lookup"><span data-stu-id="efe18-152">[Inspect network traces for UDP WS-Discovery](inspecting-network-traces-for-udp-ws-discovery.md).</span></span>
5.  <span data-ttu-id="efe18-153">[使用泛型主機和用戶端進行 HTTP 中繼資料交換](using-a-generic-host-and-client-for-http-metadata-exchange.md)。</span><span class="sxs-lookup"><span data-stu-id="efe18-153">[Use a generic host and client for HTTP metadata exchange](using-a-generic-host-and-client-for-http-metadata-exchange.md).</span></span>
6.  <span data-ttu-id="efe18-154">[使用 WinHTTP 記錄來確認取得流量](using-winhttp-logging-to-verify-get-traffic.md)。</span><span class="sxs-lookup"><span data-stu-id="efe18-154">[Use WinHTTP logging to verify Get traffic](using-winhttp-logging-to-verify-get-traffic.md).</span></span>
7.  <span data-ttu-id="efe18-155">[檢查 HTTP 中繼資料交換的網路追蹤](inspecting-network-traces-for-http-metadata-exchange.md)。</span><span class="sxs-lookup"><span data-stu-id="efe18-155">[Inspect network traces for HTTP metadata exchange](inspecting-network-traces-for-http-metadata-exchange.md).</span></span>

<span data-ttu-id="efe18-156">確認已產生 [解析](resolve-message.md) 和 [ResolveMatches](resolvematches-message.md) 訊息，並符合流量需求。</span><span class="sxs-lookup"><span data-stu-id="efe18-156">Verify that [Resolve](resolve-message.md) and [ResolveMatches](resolvematches-message.md) messages are generated and meet traffic requirements.</span></span> <span data-ttu-id="efe18-157">不需要在 WSD Debug 用戶端輸出或網路追蹤中尋找 [探查](probe-message.md) 或 [ProbeMatches](probematches-message.md) 訊息。</span><span class="sxs-lookup"><span data-stu-id="efe18-157">It is not necessary to look for [Probe](probe-message.md) or [ProbeMatches](probematches-message.md) messages in the WSD Debug Client output or in the network traces.</span></span>

## <a name="troubleshooting-clients-using-the-iwsdiscoveryprovider-interface"></a><span data-ttu-id="efe18-158">使用 IWSDiscoveryProvider 介面疑難排解用戶端</span><span class="sxs-lookup"><span data-stu-id="efe18-158">Troubleshooting clients using the IWSDiscoveryProvider interface</span></span>

<span data-ttu-id="efe18-159">呼叫 [**IWSDiscoveryProvider**](/windows/desktop/api/WsdDisco/nn-wsddisco-iwsdiscoveryprovider) 介面的應用程式不會執行中繼資料交換。</span><span class="sxs-lookup"><span data-stu-id="efe18-159">Applications calling into the [**IWSDiscoveryProvider**](/windows/desktop/api/WsdDisco/nn-wsddisco-iwsdiscoveryprovider) interface do not perform metadata exchange.</span></span> <span data-ttu-id="efe18-160">這個介面僅供探索之用。</span><span class="sxs-lookup"><span data-stu-id="efe18-160">This interface is only used for discovery.</span></span> <span data-ttu-id="efe18-161">**IWSDiscoveryProvider** 介面上呼叫的每個方法都有不同的訊息模式和疑難排解程式。</span><span class="sxs-lookup"><span data-stu-id="efe18-161">The message patterns and troubleshooting procedures are different for each method called on the **IWSDiscoveryProvider** interface.</span></span>

<span data-ttu-id="efe18-162">當應用程式呼叫 [**IWSDiscoveryProvider：： SearchByType**](/windows/desktop/api/WsdDisco/nf-wsddisco-iwsdiscoveryprovider-searchbytype)時，會產生 [探查](probe-message.md) 訊息。</span><span class="sxs-lookup"><span data-stu-id="efe18-162">When an application calls [**IWSDiscoveryProvider::SearchByType**](/windows/desktop/api/WsdDisco/nf-wsddisco-iwsdiscoveryprovider-searchbytype), a [Probe](probe-message.md) message is generated.</span></span> <span data-ttu-id="efe18-163">探查訊息會由 UDP 多播傳送到埠3702。</span><span class="sxs-lookup"><span data-stu-id="efe18-163">The Probe message is sent by UDP multicast to port 3702.</span></span> <span data-ttu-id="efe18-164">會產生 [ProbeMatches](probematches-message.md) 訊息以回應。</span><span class="sxs-lookup"><span data-stu-id="efe18-164">A [ProbeMatches](probematches-message.md) message is generated in response.</span></span> <span data-ttu-id="efe18-165">ProbeMatches 訊息是由 UDP 單播傳送，且來自埠3702。</span><span class="sxs-lookup"><span data-stu-id="efe18-165">The ProbeMatches message is sent by UDP unicast and it originates from port 3702.</span></span>

<span data-ttu-id="efe18-166">當應用程式呼叫 [**IWSDiscoveryProvider：： SearchById**](/windows/desktop/api/WsdDisco/nf-wsddisco-iwsdiscoveryprovider-searchbyid)時，會產生 [解析](resolve-message.md) 訊息。</span><span class="sxs-lookup"><span data-stu-id="efe18-166">When an application calls [**IWSDiscoveryProvider::SearchById**](/windows/desktop/api/WsdDisco/nf-wsddisco-iwsdiscoveryprovider-searchbyid), a [Resolve](resolve-message.md) message is generated.</span></span> <span data-ttu-id="efe18-167">UDP 多播會將解析訊息傳送到埠3702。</span><span class="sxs-lookup"><span data-stu-id="efe18-167">A Resolve message is sent by UDP multicast to port 3702.</span></span> <span data-ttu-id="efe18-168">會產生 [ResolveMatches](resolvematches-message.md) 訊息以回應。</span><span class="sxs-lookup"><span data-stu-id="efe18-168">A [ResolveMatches](resolvematches-message.md) message is generated in response.</span></span> <span data-ttu-id="efe18-169">ResolveMatches 是由 UDP 單播傳送，且來自埠3702。</span><span class="sxs-lookup"><span data-stu-id="efe18-169">The ResolveMatches is sent by UDP unicast and it originates from port 3702.</span></span>

<span data-ttu-id="efe18-170">下列診斷程式應依序 (使用) ，以協助識別呼叫 [**IWSDiscoveryProvider：： SearchByType**](/windows/desktop/api/WsdDisco/nf-wsddisco-iwsdiscoveryprovider-searchbytype) 或 [**IWSDiscoveryProvider：： SearchById**](/windows/desktop/api/WsdDisco/nf-wsddisco-iwsdiscoveryprovider-searchbyid)的應用程式發生問題。</span><span class="sxs-lookup"><span data-stu-id="efe18-170">The following diagnostic procedures should be used (in order) to help identify problems with an application calling [**IWSDiscoveryProvider::SearchByType**](/windows/desktop/api/WsdDisco/nf-wsddisco-iwsdiscoveryprovider-searchbytype) or [**IWSDiscoveryProvider::SearchById**](/windows/desktop/api/WsdDisco/nf-wsddisco-iwsdiscoveryprovider-searchbyid).</span></span> <span data-ttu-id="efe18-171">確認所呼叫 API 所產生的訊息符合流量需求。</span><span class="sxs-lookup"><span data-stu-id="efe18-171">Verify that the messages generated by the called API satisfy the traffic requirements.</span></span>

1.  <span data-ttu-id="efe18-172">[檢查介面卡和防火牆設定](inspecting-adapter-and-firewall-settings.md)。</span><span class="sxs-lookup"><span data-stu-id="efe18-172">[Inspect adapter and firewall settings](inspecting-adapter-and-firewall-settings.md).</span></span>
2.  <span data-ttu-id="efe18-173">[使用泛型主機和用戶端進行 UDP WS 探索](using-a-generic-host-and-client-for-udp-ws-discovery.md)。</span><span class="sxs-lookup"><span data-stu-id="efe18-173">[Use a generic host and client for UDP WS-Discovery](using-a-generic-host-and-client-for-udp-ws-discovery.md).</span></span>
3.  <span data-ttu-id="efe18-174">[使用 WSD Debug 用戶端來驗證多播流量](using-wsddebug-client-to-verify-multicast-traffic.md)。</span><span class="sxs-lookup"><span data-stu-id="efe18-174">[Use WSD Debug Client to verify multicast traffic](using-wsddebug-client-to-verify-multicast-traffic.md).</span></span>
4.  <span data-ttu-id="efe18-175">[檢查 UDP WS-探索的網路追蹤](inspecting-network-traces-for-udp-ws-discovery.md)。</span><span class="sxs-lookup"><span data-stu-id="efe18-175">[Inspect network traces for UDP WS-Discovery](inspecting-network-traces-for-udp-ws-discovery.md).</span></span>

<span data-ttu-id="efe18-176">如果應用程式呼叫 [**IWSDiscoveryProvider：： SearchByAddress**](/windows/desktop/api/WsdDisco/nf-wsddisco-iwsdiscoveryprovider-searchbyaddress)，則它是導向的探索應用程式。</span><span class="sxs-lookup"><span data-stu-id="efe18-176">If an application calls [**IWSDiscoveryProvider::SearchByAddress**](/windows/desktop/api/WsdDisco/nf-wsddisco-iwsdiscoveryprovider-searchbyaddress), then it is a directed discovery application.</span></span> <span data-ttu-id="efe18-177">如需疑難排解的詳細資訊，請參閱 [使用導向探索來疑難排解應用程式](troubleshooting-applications-using-directed-discovery.md)。</span><span class="sxs-lookup"><span data-stu-id="efe18-177">For more troubleshooting information, see [Troubleshooting Applications Using Directed Discovery](troubleshooting-applications-using-directed-discovery.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="efe18-178">相關主題</span><span class="sxs-lookup"><span data-stu-id="efe18-178">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="efe18-179">使用 WSDAPI 進行疑難排解的開始使用</span><span class="sxs-lookup"><span data-stu-id="efe18-179">Getting Started with WSDAPI Troubleshooting</span></span>](getting-started-with-wsdapi-troubleshooting.md)
</dt> </dl>

 

 



