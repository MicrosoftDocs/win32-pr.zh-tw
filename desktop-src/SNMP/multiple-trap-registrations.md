---
title: 多重陷阱註冊
description: 當 WinSNMP 應用程式註冊用於陷阱或通知的 WinSNMP 會話時，有數個選項可供使用。
ms.assetid: 76a4095f-ab5c-4f7a-9b60-a383a632fd65
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 81aebf94d60ca26f39bcd53b26cb1f794f43af0d
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 09/16/2019
ms.locfileid: "104301556"
---
# <a name="multiple-trap-registrations"></a><span data-ttu-id="7ea5a-103">多重陷阱註冊</span><span class="sxs-lookup"><span data-stu-id="7ea5a-103">Multiple Trap Registrations</span></span>

<span data-ttu-id="7ea5a-104">當 WinSNMP 應用程式註冊用於陷阱或通知的 WinSNMP 會話時，有數個選項可供使用。</span><span class="sxs-lookup"><span data-stu-id="7ea5a-104">Several options are available when a WinSNMP application registers a WinSNMP session for traps or notifications.</span></span> <span data-ttu-id="7ea5a-105">因此，應用程式可以多次呼叫 [**SnmpRegister**](/windows/desktop/api/Winsnmp/nf-winsnmp-snmpregister) 函式，實際上會定義接收陷阱和通知的自訂篩選準則。</span><span class="sxs-lookup"><span data-stu-id="7ea5a-105">Because of this, an application can call the [**SnmpRegister**](/windows/desktop/api/Winsnmp/nf-winsnmp-snmpregister) function multiple times, in effect defining a custom filter for the reception of traps and notifications.</span></span> <span data-ttu-id="7ea5a-106">例如，您可以註冊某一種陷阱或通知，或針對所有陷阱和通知，視 *通知* 參數的值而定。</span><span class="sxs-lookup"><span data-stu-id="7ea5a-106">For example, you can register for one type of trap or notification, or for all traps and notifications, depending on the value of the *notification* parameter.</span></span> <span data-ttu-id="7ea5a-107">此外，應用程式可以在 **SnmpRegister** 函式的其他參數中指定值，以進一步定義應到達應用程式的陷阱和通知。</span><span class="sxs-lookup"><span data-stu-id="7ea5a-107">Additionally, the application can specify values in other parameters to the **SnmpRegister** function to further define the traps and notifications that should reach an application.</span></span> <span data-ttu-id="7ea5a-108">如需詳細資訊，請參閱 [管理陷阱和通知](managing-traps-and-notifications.md)。</span><span class="sxs-lookup"><span data-stu-id="7ea5a-108">For more information, see [Managing Traps and Notifications](managing-traps-and-notifications.md).</span></span>

<span data-ttu-id="7ea5a-109">以下是多個 **SnmpRegister** 呼叫是多餘的實例。</span><span class="sxs-lookup"><span data-stu-id="7ea5a-109">Following are instances in which multiple calls to **SnmpRegister** are redundant.</span></span> <span data-ttu-id="7ea5a-110">在這些情況 \_ 下，如果函式順利完成，SNMPREGISTER 會傳回 SNMPAPI SUCCESS，但多餘的註冊會失效。</span><span class="sxs-lookup"><span data-stu-id="7ea5a-110">In these instances **SnmpRegister** returns SNMPAPI\_SUCCESS if the function completes successfully, but the redundant registration is ineffective.</span></span>

1.  <span data-ttu-id="7ea5a-111">呼叫 [**SnmpRegister**](/windows/desktop/api/Winsnmp/nf-winsnmp-snmpregister) 函式，在上一次呼叫 **SnmpRegister** 要求傳遞所有陷阱和通知 (未篩選的傳遞) 之後，要求將已篩選的陷阱和通知傳遞至會話。</span><span class="sxs-lookup"><span data-stu-id="7ea5a-111">A call to the [**SnmpRegister**](/windows/desktop/api/Winsnmp/nf-winsnmp-snmpregister) function requesting filtered delivery of traps and notifications to the session, after a previous call to **SnmpRegister** requesting delivery of all traps and notifications (unfiltered delivery).</span></span> <span data-ttu-id="7ea5a-112">此呼叫是重複的，因為會話已經接收所有陷阱和通知，包括篩選所定義的單一類型。</span><span class="sxs-lookup"><span data-stu-id="7ea5a-112">This call is redundant because the session is already receiving all traps and notifications, including the single type defined by the filter.</span></span>
2.  <span data-ttu-id="7ea5a-113">對 **SnmpRegister** 的重複呼叫，或其中一個參數清單與先前呼叫中對該會話之 **SnmpRegister** 的參數清單相同。</span><span class="sxs-lookup"><span data-stu-id="7ea5a-113">A duplicate call to **SnmpRegister**, or one in which the parameter list is identical to the parameter list in a previous call to **SnmpRegister** for the session.</span></span>
3.  <span data-ttu-id="7ea5a-114">[**SnmpRegister**](/windows/desktop/api/Winsnmp/nf-winsnmp-snmpregister)函式的呼叫會根據物件識別碼 (OID，要求篩選的陷阱和通知傳遞，) 其前置詞為先前對 **SnmpRegister** 的呼叫中指定的 oid。</span><span class="sxs-lookup"><span data-stu-id="7ea5a-114">A call to the [**SnmpRegister**](/windows/desktop/api/Winsnmp/nf-winsnmp-snmpregister) function requesting filtered delivery of traps and notifications based on an object identifier (OID) whose prefix is an OID specified in a previous call to **SnmpRegister**.</span></span> <span data-ttu-id="7ea5a-115">例如，您可以在 *通知* 參數中指定 "1.3.6.1.4.1.311."，以接收來自任何 Microsoft SNMP 代理程式實體的通知。</span><span class="sxs-lookup"><span data-stu-id="7ea5a-115">For example, you can specify "1.3.6.1.4.1.311" in the *notification* parameter to receive notifications originating from any Microsoft SNMP agent entity.</span></span> <span data-ttu-id="7ea5a-116">如果您再次呼叫 **SnmpRegister** 並指定 "1.3.6.1.4.1.311.1"，則第二個呼叫是重複的，因為會話已經接收到所有包含 OID 首碼 "1.3.6.1.4.1.311." 的陷阱和通知。</span><span class="sxs-lookup"><span data-stu-id="7ea5a-116">If you call **SnmpRegister** again and specify "1.3.6.1.4.1.311.1", the second call is redundant because the session is already receiving all traps and notifications that contain the OID prefix "1.3.6.1.4.1.311".</span></span>

<span data-ttu-id="7ea5a-117">若要取消註冊會話，您必須符合 [**SnmpRegister**](/windows/desktop/api/Winsnmp/nf-winsnmp-snmpregister) 函式的每個唯一註冊呼叫。</span><span class="sxs-lookup"><span data-stu-id="7ea5a-117">To unregister the session, you must match each unique registration call to the [**SnmpRegister**](/windows/desktop/api/Winsnmp/nf-winsnmp-snmpregister) function.</span></span> <span data-ttu-id="7ea5a-118">呼叫 **SnmpRegister** 以取消註冊會話，並確定 **SnmpRegister** 的前五個參數與初始註冊呼叫中的參數相同。</span><span class="sxs-lookup"><span data-stu-id="7ea5a-118">Call **SnmpRegister** to unregister the session, and ensure that the first five parameters to **SnmpRegister** are identical to those in the initial registration call.</span></span> <span data-ttu-id="7ea5a-119">初始呼叫和取消註冊呼叫之間的唯一差異在於，當您註冊時，您必須 \_ 在 *status* 參數中指定 SNMPAPI 的值，而且當您呼叫函式以取消註冊時，您必須指定 SNMPAPI \_ OFF。</span><span class="sxs-lookup"><span data-stu-id="7ea5a-119">The only difference between the initial call and the unregistering call is that when registering you must specify the value SNMPAPI\_ON in the *status* parameter, and when you call the function to unregister, you must specify SNMPAPI\_OFF.</span></span> <span data-ttu-id="7ea5a-120">您不需要比對 **SnmpRegister** 函式的重複註冊呼叫。</span><span class="sxs-lookup"><span data-stu-id="7ea5a-120">You do not need to match redundant registration calls to the **SnmpRegister** function.</span></span> <span data-ttu-id="7ea5a-121">您只需要符合第一個唯一的註冊電話。</span><span class="sxs-lookup"><span data-stu-id="7ea5a-121">You need only match the first unique registration call.</span></span>

<span data-ttu-id="7ea5a-122">若要變更篩選準則，應用程式可能需要先取消註冊並停用特定陷阱或通知的傳遞。</span><span class="sxs-lookup"><span data-stu-id="7ea5a-122">To change filtering criteria, it may be necessary for an application to first unregister and disable delivery of certain traps or notifications.</span></span> <span data-ttu-id="7ea5a-123">然後，應用程式可以藉由呼叫 [**SnmpRegister**](/windows/desktop/api/Winsnmp/nf-winsnmp-snmpregister)並傳遞適當的值來建立新的篩選準則。</span><span class="sxs-lookup"><span data-stu-id="7ea5a-123">Then the application can create a new filter by calling [**SnmpRegister**](/windows/desktop/api/Winsnmp/nf-winsnmp-snmpregister), passing appropriate values.</span></span>

 

 




