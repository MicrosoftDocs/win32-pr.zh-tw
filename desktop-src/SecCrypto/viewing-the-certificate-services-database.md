---
description: 適當授權的用戶端會使用 ICertView 介面來查看憑證服務資料庫。
ms.assetid: c8f316dd-186b-4e4a-b0ce-561a23b266cb
title: 查看憑證服務資料庫
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 43c553cee2f64c3096e733d588c9e0ad3d08ceb4
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/08/2021
ms.locfileid: "104115608"
---
# <a name="viewing-the-certificate-services-database"></a><span data-ttu-id="ed69a-103">查看憑證服務資料庫</span><span class="sxs-lookup"><span data-stu-id="ed69a-103">Viewing the Certificate Services Database</span></span>

<span data-ttu-id="ed69a-104">適當授權的用戶端會使用 [**ICertView**](/windows/desktop/api/Certview/nn-certview-icertview) 介面來查看憑證服務資料庫。</span><span class="sxs-lookup"><span data-stu-id="ed69a-104">The [**ICertView**](/windows/desktop/api/Certview/nn-certview-icertview) interface is used by properly authorized clients to view the Certificate Services database.</span></span> <span data-ttu-id="ed69a-105">請注意，在隨附的產品中，憑證授權單位單位 MMC 嵌入式管理單元可以用來查看憑證服務資料庫。</span><span class="sxs-lookup"><span data-stu-id="ed69a-105">It should be noted that, as part of the shipped product, the Certification Authority MMC snap-in can be used to view the Certificate Services database.</span></span> <span data-ttu-id="ed69a-106">[**ICertView**](/windows/desktop/api/Certview/nn-certview-icertview) 是提供來以程式設計方式查看資料庫。</span><span class="sxs-lookup"><span data-stu-id="ed69a-106">[**ICertView**](/windows/desktop/api/Certview/nn-certview-icertview) is provided for programmatically viewing the database.</span></span> <span data-ttu-id="ed69a-107">從 Windows XP 開始支援 **ICertView** 介面。</span><span class="sxs-lookup"><span data-stu-id="ed69a-107">Support for the **ICertView** interface begins with Windows XP.</span></span>

<span data-ttu-id="ed69a-108">經適當授權的用戶端是指已被授與許可權來查看憑證服務資料庫的使用者;您可以使用「憑證授權單位單位」 MMC 嵌入式管理單元來授與或限制存取權，以在 [*憑證授權單位*](../secgloss/c-gly.md)單位的 [內容 **] 下查看** 資料庫 (，請按一下 [**安全性**] 索引標籤) 。</span><span class="sxs-lookup"><span data-stu-id="ed69a-108">A properly authorized client means a user who has been granted permission to view the Certificate Services database; the Certification Authority MMC snap-in can be used to grant or restrict access to view the database (under **Properties** for the [*certification authority*](../secgloss/c-gly.md), click the **Security** tab).</span></span> <span data-ttu-id="ed69a-109">此外，若要使用 [**ICertView**](/windows/desktop/api/Certview/nn-certview-icertview) 物件，用戶端工作站必須已安裝憑證服務用戶端元件。</span><span class="sxs-lookup"><span data-stu-id="ed69a-109">Additionally, to use the [**ICertView**](/windows/desktop/api/Certview/nn-certview-icertview) object, the client workstation is required to have installed the Certificate Services client components.</span></span>

<span data-ttu-id="ed69a-110">雖然使用 [**ICertView**](/windows/desktop/api/Certview/nn-certview-icertview) 及其相關介面的案例有很多種，但以下說明了一個可能的順序，可根據 **ICertView** 來開發用戶端應用程式：</span><span class="sxs-lookup"><span data-stu-id="ed69a-110">Although there are various scenarios for using [**ICertView**](/windows/desktop/api/Certview/nn-certview-icertview) and its related interfaces, the following depicts one possible sequence for developing a client application based on **ICertView**:</span></span>

<span data-ttu-id="ed69a-111">**若要查看憑證服務資料庫**</span><span class="sxs-lookup"><span data-stu-id="ed69a-111">**To view the Certificate Services database**</span></span>

1.  <span data-ttu-id="ed69a-112">取得 [**ICertView**](/windows/desktop/api/Certview/nn-certview-icertview) 物件的實例之後，請呼叫 [**ICertView：： OpenConnection**](/windows/desktop/api/Certview/nf-certview-icertview-openconnection) ，以與特定電腦上的 [*憑證授權單位*](../secgloss/c-gly.md) 單位進行通訊。</span><span class="sxs-lookup"><span data-stu-id="ed69a-112">After obtaining an instance of the [**ICertView**](/windows/desktop/api/Certview/nn-certview-icertview) object, call [**ICertView::OpenConnection**](/windows/desktop/api/Certview/nf-certview-icertview-openconnection) to communicate with a [*certification authority*](../secgloss/c-gly.md) on a specific computer.</span></span>
2.  <span data-ttu-id="ed69a-113">呼叫 [**ICertView：： SetResultColumnCount**](/windows/desktop/api/Certview/nf-certview-icertview-setresultcolumncount) 來指定 view 中的資料行數目;此呼叫也用來指定預設的視圖。</span><span class="sxs-lookup"><span data-stu-id="ed69a-113">Call [**ICertView::SetResultColumnCount**](/windows/desktop/api/Certview/nf-certview-icertview-setresultcolumncount) to specify the number of columns in the view; this call is also used to specify a default view.</span></span> <span data-ttu-id="ed69a-114">如果未在呼叫中指定預設視圖，則呼叫端必須針對要包含在視圖中的每個資料行呼叫 [**ICertView：： SetResultColumn**](/windows/desktop/api/Certview/nf-certview-icertview-setresultcolumn) 。</span><span class="sxs-lookup"><span data-stu-id="ed69a-114">If a default view is not specified in the call, the caller must call [**ICertView::SetResultColumn**](/windows/desktop/api/Certview/nf-certview-icertview-setresultcolumn) for each of the columns to be contained in the view.</span></span>
3.  <span data-ttu-id="ed69a-115">選擇性。</span><span class="sxs-lookup"><span data-stu-id="ed69a-115">Optional.</span></span> <span data-ttu-id="ed69a-116">藉由呼叫 [**ICertView：： SetRestriction**](/windows/desktop/api/Certview/nf-certview-icertview-setrestriction) 函數，指定資料庫查詢的排序準則和/或限定準則。</span><span class="sxs-lookup"><span data-stu-id="ed69a-116">Specify sorting criteria and/or qualifying criteria for the database query by calling the [**ICertView::SetRestriction**](/windows/desktop/api/Certview/nf-certview-icertview-setrestriction) function.</span></span> <span data-ttu-id="ed69a-117">符合條件的條件包括：告知視圖要根據限定詞（例如大於、小於、等於等）來取出資料。</span><span class="sxs-lookup"><span data-stu-id="ed69a-117">Qualifying criteria consists of informing the view to retrieve data based on qualifiers such as Greater Than, Less Than, Equal To, and so on.</span></span>
4.  <span data-ttu-id="ed69a-118">呼叫 [**ICertView：： OpenView**](/windows/desktop/api/Certview/nf-certview-icertview-openview) 以取出 view 中的資料;此視圖的資料將由 [**ICertView：： SetResultColumnCount**](/windows/desktop/api/Certview/nf-certview-icertview-setresultcolumncount) (所要求的資料行所組成，而且如果未指定預設 View， [**ICertView：： SetResultColumn**](/windows/desktop/api/Certview/nf-certview-icertview-setresultcolumn)) 。</span><span class="sxs-lookup"><span data-stu-id="ed69a-118">Call [**ICertView::OpenView**](/windows/desktop/api/Certview/nf-certview-icertview-openview) to retrieve the data in the view; the view's data will consist of the columns requested by means of [**ICertView::SetResultColumnCount**](/windows/desktop/api/Certview/nf-certview-icertview-setresultcolumncount) (and if a default view was not specified, [**ICertView::SetResultColumn**](/windows/desktop/api/Certview/nf-certview-icertview-setresultcolumn)).</span></span> <span data-ttu-id="ed69a-119">如果呼叫 [**ICertView：： SetRestriction**](/windows/desktop/api/Certview/nf-certview-icertview-setrestriction) ，資料行中的資料將會排序及/或限定。</span><span class="sxs-lookup"><span data-stu-id="ed69a-119">If [**ICertView::SetRestriction**](/windows/desktop/api/Certview/nf-certview-icertview-setrestriction) was called, data in the columns will be sorted and/or qualified.</span></span> <span data-ttu-id="ed69a-120">**ICertView：： OpenView** 會建立 [**IEnumCERTVIEWROW**](/windows/desktop/api/Certview/nn-certview-ienumcertviewrow) 物件，可用來列舉視圖的資料列。</span><span class="sxs-lookup"><span data-stu-id="ed69a-120">**ICertView::OpenView** creates a [**IEnumCERTVIEWROW**](/windows/desktop/api/Certview/nn-certview-ienumcertviewrow) object, which can be used to enumerate the view's rows.</span></span>
5.  <span data-ttu-id="ed69a-121">使用 [**IEnumCERTVIEWROW**](/windows/desktop/api/Certview/nn-certview-ienumcertviewrow) 方法 [**IEnumCERTVIEWROW：： EnumCertViewAttribute**](/windows/desktop/api/Certview/nf-certview-ienumcertviewrow-enumcertviewattribute)、 [**IEnumCERTVIEWROW：： EnumCertViewColumn**](/windows/desktop/api/Certview/nf-certview-ienumcertviewrow-enumcertviewcolumn)和 [**IEnumCERTVIEWROW：： EnumCertViewExtension**](/windows/desktop/api/Certview/nf-certview-ienumcertviewrow-enumcertviewextension) ，視需要取出屬性、資料行和延伸資料。</span><span class="sxs-lookup"><span data-stu-id="ed69a-121">Use the [**IEnumCERTVIEWROW**](/windows/desktop/api/Certview/nn-certview-ienumcertviewrow) methods [**IEnumCERTVIEWROW::EnumCertViewAttribute**](/windows/desktop/api/Certview/nf-certview-ienumcertviewrow-enumcertviewattribute), [**IEnumCERTVIEWROW::EnumCertViewColumn**](/windows/desktop/api/Certview/nf-certview-ienumcertviewrow-enumcertviewcolumn), and [**IEnumCERTVIEWROW::EnumCertViewExtension**](/windows/desktop/api/Certview/nf-certview-ienumcertviewrow-enumcertviewextension) to retrieve attribute, column, and extension data as desired.</span></span>

 

 
