---
description: 列出 CryptoAPI 提供的函數。
ms.assetid: 9a65f73d-6f8c-4271-a2d0-d91ad952f9c6
title: 密碼編譯函式
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f91338c4a1cea62e2ecc4a2fa1f7254f303ef9b2
ms.sourcegitcommit: de72a1294df274b0a71dc0fdc42d757e5f6df0f3
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 03/05/2021
ms.locfileid: "104116089"
---
# <a name="cryptography-functions"></a><span data-ttu-id="8a1fc-103">密碼編譯函式</span><span class="sxs-lookup"><span data-stu-id="8a1fc-103">Cryptography Functions</span></span>

<span data-ttu-id="8a1fc-104">加密函式會根據使用方式進行分類，如下所示：</span><span class="sxs-lookup"><span data-stu-id="8a1fc-104">Cryptography functions are categorized according to usage as follows:</span></span>

-   [<span data-ttu-id="8a1fc-105">CryptXML 函式</span><span class="sxs-lookup"><span data-stu-id="8a1fc-105">CryptXML Functions</span></span>](#cryptxml-functions)
-   [<span data-ttu-id="8a1fc-106">簽署者函式</span><span class="sxs-lookup"><span data-stu-id="8a1fc-106">Signer Functions</span></span>](#signer-functions)
-   [<span data-ttu-id="8a1fc-107">基礎密碼編譯功能</span><span class="sxs-lookup"><span data-stu-id="8a1fc-107">Base Cryptography Functions</span></span>](#base-cryptography-functions)
    -   [<span data-ttu-id="8a1fc-108">服務提供者函數</span><span class="sxs-lookup"><span data-stu-id="8a1fc-108">Service Provider Functions</span></span>](#service-provider-functions)
    -   [<span data-ttu-id="8a1fc-109">金鑰產生和交換功能</span><span class="sxs-lookup"><span data-stu-id="8a1fc-109">Key Generation and Exchange Functions</span></span>](#key-generation-and-exchange-functions)
    -   [<span data-ttu-id="8a1fc-110">物件編碼和解碼函數</span><span class="sxs-lookup"><span data-stu-id="8a1fc-110">Object Encoding and Decoding Functions</span></span>](#object-encoding-and-decoding-functions)
    -   [<span data-ttu-id="8a1fc-111">資料加密和解密功能</span><span class="sxs-lookup"><span data-stu-id="8a1fc-111">Data Encryption and Decryption Functions</span></span>](#data-encryption-and-decryption-functions)
    -   [<span data-ttu-id="8a1fc-112">雜湊和數位簽章函式</span><span class="sxs-lookup"><span data-stu-id="8a1fc-112">Hash and Digital Signature Functions</span></span>](#hash-and-digital-signature-functions)
-   [<span data-ttu-id="8a1fc-113">憑證和憑證存放區功能</span><span class="sxs-lookup"><span data-stu-id="8a1fc-113">Certificate and Certificate Store Functions</span></span>](#certificate-and-certificate-store-functions)
    -   [<span data-ttu-id="8a1fc-114">憑證存放區功能</span><span class="sxs-lookup"><span data-stu-id="8a1fc-114">Certificate Store Functions</span></span>](#certificate-and-certificate-store-functions)
    -   [<span data-ttu-id="8a1fc-115">憑證和憑證存放區維護功能</span><span class="sxs-lookup"><span data-stu-id="8a1fc-115">Certificate and Certificate Store Maintenance Functions</span></span>](#certificate-and-certificate-store-maintenance-functions)
    -   [<span data-ttu-id="8a1fc-116">憑證函數</span><span class="sxs-lookup"><span data-stu-id="8a1fc-116">Certificate Functions</span></span>](#certificate-functions)
    -   [<span data-ttu-id="8a1fc-117">憑證撤銷清單函式</span><span class="sxs-lookup"><span data-stu-id="8a1fc-117">Certificate Revocation List Functions</span></span>](#certificate-revocation-list-functions)
    -   [<span data-ttu-id="8a1fc-118">憑證信任清單函式</span><span class="sxs-lookup"><span data-stu-id="8a1fc-118">Certificate Trust List Functions</span></span>](#certificate-trust-list-functions)
    -   [<span data-ttu-id="8a1fc-119">擴充屬性函式</span><span class="sxs-lookup"><span data-stu-id="8a1fc-119">Extended Property Functions</span></span>](#extended-property-functions)
-   [<span data-ttu-id="8a1fc-120">MakeCert 函式</span><span class="sxs-lookup"><span data-stu-id="8a1fc-120">MakeCert Functions</span></span>](#makecert-functions)
-   [<span data-ttu-id="8a1fc-121">憑證驗證功能</span><span class="sxs-lookup"><span data-stu-id="8a1fc-121">Certificate Verification Functions</span></span>](#certificate-verification-functions)
    -   [<span data-ttu-id="8a1fc-122">使用 Ctl 的驗證函數</span><span class="sxs-lookup"><span data-stu-id="8a1fc-122">Verification Functions Using CTLs</span></span>](#verification-functions-using-ctls)
    -   [<span data-ttu-id="8a1fc-123">憑證鏈驗證功能</span><span class="sxs-lookup"><span data-stu-id="8a1fc-123">Certificate Chain Verification Functions</span></span>](#certificate-chain-verification-functions)
-   [<span data-ttu-id="8a1fc-124">訊息函數</span><span class="sxs-lookup"><span data-stu-id="8a1fc-124">Message Functions</span></span>](#message-functions)
    -   [<span data-ttu-id="8a1fc-125">低層級訊息函數</span><span class="sxs-lookup"><span data-stu-id="8a1fc-125">Low-level Message Functions</span></span>](#low-level-message-functions)
    -   [<span data-ttu-id="8a1fc-126">簡化的訊息函數</span><span class="sxs-lookup"><span data-stu-id="8a1fc-126">Simplified Message Functions</span></span>](#simplified-message-functions)
-   [<span data-ttu-id="8a1fc-127">輔助函式</span><span class="sxs-lookup"><span data-stu-id="8a1fc-127">Auxiliary Functions</span></span>](#auxiliary-functions)
    -   [<span data-ttu-id="8a1fc-128">資料管理函式</span><span class="sxs-lookup"><span data-stu-id="8a1fc-128">Data Management Functions</span></span>](#data-management-functions)
    -   [<span data-ttu-id="8a1fc-129">資料轉換函數</span><span class="sxs-lookup"><span data-stu-id="8a1fc-129">Data Conversion Functions</span></span>](#data-conversion-functions)
    -   [<span data-ttu-id="8a1fc-130">增強金鑰使用方法功能</span><span class="sxs-lookup"><span data-stu-id="8a1fc-130">Enhanced Key Usage Functions</span></span>](#enhanced-key-usage-functions)
    -   [<span data-ttu-id="8a1fc-131">金鑰識別碼函數</span><span class="sxs-lookup"><span data-stu-id="8a1fc-131">Key Identifier Functions</span></span>](#key-identifier-functions)
    -   [<span data-ttu-id="8a1fc-132">OID 支援函式</span><span class="sxs-lookup"><span data-stu-id="8a1fc-132">OID Support Functions</span></span>](#oid-support-functions)
    -   [<span data-ttu-id="8a1fc-133">遠端物件抓取函式</span><span class="sxs-lookup"><span data-stu-id="8a1fc-133">Remote Object Retrieval Functions</span></span>](#remote-object-retrieval-functions)
    -   [<span data-ttu-id="8a1fc-134">PFX 函數</span><span class="sxs-lookup"><span data-stu-id="8a1fc-134">PFX Functions</span></span>](#pfx-functions)
-   [<span data-ttu-id="8a1fc-135">憑證服務備份和還原功能</span><span class="sxs-lookup"><span data-stu-id="8a1fc-135">Certificate Services Backup and Restore Functions</span></span>](#certificate-services-backup-and-restore-functions)
-   [<span data-ttu-id="8a1fc-136">回呼函式</span><span class="sxs-lookup"><span data-stu-id="8a1fc-136">Callback Functions</span></span>](#callback-functions)
-   [<span data-ttu-id="8a1fc-137">目錄定義函數</span><span class="sxs-lookup"><span data-stu-id="8a1fc-137">Catalog Definition Functions</span></span>](#catalog-definition-functions)
-   [<span data-ttu-id="8a1fc-138">目錄函式</span><span class="sxs-lookup"><span data-stu-id="8a1fc-138">Catalog Functions</span></span>](#catalog-functions)
-   [<span data-ttu-id="8a1fc-139">WinTrust 函式</span><span class="sxs-lookup"><span data-stu-id="8a1fc-139">WinTrust Functions</span></span>](#wintrust-functions)
-   [<span data-ttu-id="8a1fc-140">物件定位器函數</span><span class="sxs-lookup"><span data-stu-id="8a1fc-140">Object Locator Functions</span></span>](#object-locator-functions)

## <a name="cryptxml-functions"></a><span data-ttu-id="8a1fc-141">CryptXML 函式</span><span class="sxs-lookup"><span data-stu-id="8a1fc-141">CryptXML Functions</span></span>

<span data-ttu-id="8a1fc-142">密碼編譯 XML 函式提供 API，可讓您使用 XML 格式化資料來建立和表示數位簽章。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-142">The cryptographic XML functions provide an API for creating and representing digital signatures by using XML formatted data.</span></span> <span data-ttu-id="8a1fc-143">如需 XML 格式化簽章的詳細資訊，請參閱中的 XML-Signature 語法和處理規格 <https://go.microsoft.com/fwlink/p/?linkid=139649> 。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-143">For information about XML formatted signatures, see the XML-Signature Syntax and Processing specification at <https://go.microsoft.com/fwlink/p/?linkid=139649>.</span></span>



| <span data-ttu-id="8a1fc-144">函式</span><span class="sxs-lookup"><span data-stu-id="8a1fc-144">Function</span></span>                                                                          | <span data-ttu-id="8a1fc-145">描述</span><span class="sxs-lookup"><span data-stu-id="8a1fc-145">Description</span></span>                                                                                                                                                                                                                                                                                                      |
|-----------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="8a1fc-146">**\_SHAFinal**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-146">**A\_SHAFinal**</span></span>](a-shafinal.md)                                                 | <span data-ttu-id="8a1fc-147">計算 MD5Update 函數所輸入之資料的最終雜湊。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-147">Computes the final hash of the data entered by the MD5Update function.</span></span>                                                                                                                                                                                                                                           |
| [<span data-ttu-id="8a1fc-148">**\_SHAInit**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-148">**A\_SHAInit**</span></span>](a-shainit.md)                                                   | <span data-ttu-id="8a1fc-149">起始資料流程的雜湊。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-149">Initiates the hashing of a stream of data.</span></span>                                                                                                                                                                                                                                                                       |
| [<span data-ttu-id="8a1fc-150">**\_SHAUpdate**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-150">**A\_SHAUpdate**</span></span>](a-shaupdate.md)                                               | <span data-ttu-id="8a1fc-151">將資料加入至指定的雜湊物件。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-151">Adds data to a specified hash object.</span></span>                                                                                                                                                                                                                                                                            |
| [<span data-ttu-id="8a1fc-152">**CryptXmlCreateReference**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-152">**CryptXmlCreateReference**</span></span>](/windows/desktop/api/Cryptxml/nf-cryptxml-cryptxmlcreatereference)                        | <span data-ttu-id="8a1fc-153">建立 XML 簽章的參考。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-153">Creates a reference to an XML signature.</span></span>                                                                                                                                                                                                                                                                         |
| [<span data-ttu-id="8a1fc-154">**CryptXmlAddObject**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-154">**CryptXmlAddObject**</span></span>](/windows/desktop/api/Cryptxml/nf-cryptxml-cryptxmladdobject)                                    | <span data-ttu-id="8a1fc-155">將 **物件** 專案加入至開啟以進行編碼的檔內容中的簽章。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-155">Adds the **Object** element to the Signature in the Document Context opened for encoding.</span></span>                                                                                                                                                                                                                        |
| [<span data-ttu-id="8a1fc-156">**CryptXmlClose**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-156">**CryptXmlClose**</span></span>](/windows/desktop/api/Cryptxml/nf-cryptxml-cryptxmlclose)                                            | <span data-ttu-id="8a1fc-157">關閉密碼編譯 XML 物件控制碼。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-157">Closes a cryptographic XML object handle.</span></span>                                                                                                                                                                                                                                                                        |
| [<span data-ttu-id="8a1fc-158">**CryptXmlDigestReference**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-158">**CryptXmlDigestReference**</span></span>](/windows/desktop/api/Cryptxml/nf-cryptxml-cryptxmldigestreference)                        | <span data-ttu-id="8a1fc-159">由應用程式用來摘要解析的參考。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-159">Used by an application to digest the resolved reference.</span></span> <span data-ttu-id="8a1fc-160">此函數會在更新摘要之前套用轉換。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-160">This function applies transforms before updating the digest.</span></span>                                                                                                                                                                                            |
| [<span data-ttu-id="8a1fc-161">**CryptXmlDllCloseDigest**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-161">**CryptXmlDllCloseDigest**</span></span>](/windows/win32/api/cryptxml/nc-cryptxml-cryptxmldllclosedigest)                          | <span data-ttu-id="8a1fc-162">釋放 CryptXmlDllCreateDigest 函數所配置的 CRYPT \_ XML \_ 摘要。 [](/windows/win32/api/cryptxml/nc-cryptxml-cryptxmldllcreatedigest)</span><span class="sxs-lookup"><span data-stu-id="8a1fc-162">Frees the CRYPT\_XML\_DIGEST allocated by the [**CryptXmlDllCreateDigest**](/windows/win32/api/cryptxml/nc-cryptxml-cryptxmldllcreatedigest) function.</span></span>                                                                                                                                                                                               |
| [<span data-ttu-id="8a1fc-163">**CryptXmlDllCreateDigest**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-163">**CryptXmlDllCreateDigest**</span></span>](/windows/win32/api/cryptxml/nc-cryptxml-cryptxmldllcreatedigest)                        | <span data-ttu-id="8a1fc-164">為指定的方法建立摘要物件。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-164">Creates a digest object for the specified method.</span></span>                                                                                                                                                                                                                                                                |
| [<span data-ttu-id="8a1fc-165">**CryptXmlDllCreateKey**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-165">**CryptXmlDllCreateKey**</span></span>](/windows/win32/api/cryptxml/nc-cryptxml-cryptxmldllcreatekey)                              | <span data-ttu-id="8a1fc-166">剖析 **KeyValue** 元素並建立密碼編譯 API：新一代 (CNG) BCrypt 金鑰控制碼來驗證簽章。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-166">Parses the **KeyValue** element and creates a Cryptography API: Next Generation (CNG) BCrypt key handle to verify a signature.</span></span>                                                                                                                                                                                   |
| [<span data-ttu-id="8a1fc-167">**CryptXmlDllDigestData**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-167">**CryptXmlDllDigestData**</span></span>](/windows/win32/api/cryptxml/nc-cryptxml-cryptxmldlldigestdata)                            | <span data-ttu-id="8a1fc-168">將資料放入摘要。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-168">Puts data into the digest.</span></span>                                                                                                                                                                                                                                                                                       |
| [<span data-ttu-id="8a1fc-169">**CryptXmlDllEncodeAlgorithm**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-169">**CryptXmlDllEncodeAlgorithm**</span></span>](/windows/win32/api/cryptxml/nc-cryptxml-cryptxmldllencodealgorithm)                  | <span data-ttu-id="8a1fc-170">使用預設參數為 agile 演算法編碼 **SignatureMethod** 或 **DigestMethod** 元素。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-170">Encodes **SignatureMethod** or **DigestMethod** elements for agile algorithms with default parameters.</span></span>                                                                                                                                                                                                           |
| [<span data-ttu-id="8a1fc-171">**CryptXmlDllEncodeKeyValue**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-171">**CryptXmlDllEncodeKeyValue**</span></span>](/windows/win32/api/cryptxml/nc-cryptxml-cryptxmldllencodekeyvalue)                    | <span data-ttu-id="8a1fc-172">將 **KeyValue** 元素編碼。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-172">Encodes a **KeyValue** element.</span></span>                                                                                                                                                                                                                                                                                  |
| [<span data-ttu-id="8a1fc-173">**CryptXmlDllFinalizeDigest**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-173">**CryptXmlDllFinalizeDigest**</span></span>](/windows/win32/api/cryptxml/nc-cryptxml-cryptxmldllfinalizedigest)                    | <span data-ttu-id="8a1fc-174">抓取摘要值。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-174">Retrieves the digest value.</span></span>                                                                                                                                                                                                                                                                                      |
| [<span data-ttu-id="8a1fc-175">**CryptXmlDllGetAlgorithmInfo**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-175">**CryptXmlDllGetAlgorithmInfo**</span></span>](/windows/win32/api/cryptxml/nc-cryptxml-cryptxmldllgetalgorithminfo)                | <span data-ttu-id="8a1fc-176">對 XML 演算法進行解碼，並傳回演算法的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-176">Decodes the XML algorithm and returns information about the algorithm.</span></span>                                                                                                                                                                                                                                           |
| [<span data-ttu-id="8a1fc-177">**CryptXmlDllGetInterface**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-177">**CryptXmlDllGetInterface**</span></span>](/windows/win32/api/cryptxml/nc-cryptxml-cryptxmldllgetinterface)                        | <span data-ttu-id="8a1fc-178">針對指定的演算法抓取密碼編譯延伸模組函式的指標。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-178">Retrieves a pointer to the cryptographic extension functions for the specified algorithm.</span></span>                                                                                                                                                                                                                        |
| [<span data-ttu-id="8a1fc-179">**CryptXmlDllSignData**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-179">**CryptXmlDllSignData**</span></span>](/windows/win32/api/cryptxml/nc-cryptxml-cryptxmldllsigndata)                                | <span data-ttu-id="8a1fc-180">簽署資料。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-180">Signs data.</span></span>                                                                                                                                                                                                                                                                                                      |
| [<span data-ttu-id="8a1fc-181">**CryptXmlDllVerifySignature**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-181">**CryptXmlDllVerifySignature**</span></span>](/windows/win32/api/cryptxml/nc-cryptxml-cryptxmldllverifysignature)                  | <span data-ttu-id="8a1fc-182">驗證簽章。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-182">Verifies a signature.</span></span>                                                                                                                                                                                                                                                                                            |
| [<span data-ttu-id="8a1fc-183">**CryptXmlEncode**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-183">**CryptXmlEncode**</span></span>](/windows/desktop/api/Cryptxml/nf-cryptxml-cryptxmlencode)                                          | <span data-ttu-id="8a1fc-184">使用提供的 XML 寫入器回呼函數來編碼簽章資料。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-184">Encodes signature data by using the supplied XML writer callback function.</span></span>                                                                                                                                                                                                                                       |
| [<span data-ttu-id="8a1fc-185">**CryptXmlGetAlgorithmInfo**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-185">**CryptXmlGetAlgorithmInfo**</span></span>](/windows/desktop/api/Cryptxml/nf-cryptxml-cryptxmlgetalgorithminfo)                      | <span data-ttu-id="8a1fc-186">解碼 CRYPT \_ XML \_ 演算法結構，並傳回演算法的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-186">Decodes the CRYPT\_XML\_ALGORITHM structure and returns information about the algorithm.</span></span>                                                                                                                                                                                                                         |
| [<span data-ttu-id="8a1fc-187">**CryptXmlGetDocCoNtext**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-187">**CryptXmlGetDocContext**</span></span>](/windows/desktop/api/Cryptxml/nf-cryptxml-cryptxmlgetdoccontext)                            | <span data-ttu-id="8a1fc-188">傳回所提供之控制碼所指定的檔內容。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-188">Returns the document context specified by the supplied handle.</span></span>                                                                                                                                                                                                                                                   |
| [<span data-ttu-id="8a1fc-189">**CryptXmlGetReference**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-189">**CryptXmlGetReference**</span></span>](/windows/desktop/api/Cryptxml/nf-cryptxml-cryptxmlgetreference)                              | <span data-ttu-id="8a1fc-190">傳回所提供之控制碼所指定的 **參考** 元素。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-190">Returns the **Reference** element specified by the supplied handle.</span></span>                                                                                                                                                                                                                                              |
| [<span data-ttu-id="8a1fc-191">**CryptXmlGetSignature**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-191">**CryptXmlGetSignature**</span></span>](/windows/desktop/api/Cryptxml/nf-cryptxml-cryptxmlgetsignature)                              | <span data-ttu-id="8a1fc-192">傳回 XML **Signature** 元素。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-192">Returns an XML **Signature** element.</span></span>                                                                                                                                                                                                                                                                            |
| [<span data-ttu-id="8a1fc-193">**CryptXmlGetStatus**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-193">**CryptXmlGetStatus**</span></span>](/windows/desktop/api/Cryptxml/nf-cryptxml-cryptxmlgetstatus)                                    | <span data-ttu-id="8a1fc-194">傳回 [**CRYPT \_ XML \_ 狀態**](/windows/desktop/api/Cryptxml/ns-cryptxml-crypt_xml_status) 結構，其中包含有關所提供之控制碼所指定之物件的狀態資訊。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-194">Returns a [**CRYPT\_XML\_STATUS**](/windows/desktop/api/Cryptxml/ns-cryptxml-crypt_xml_status) structure that contains status information about the object specified by the supplied handle.</span></span>                                                                                                                                                           |
| [<span data-ttu-id="8a1fc-195">**CryptXmlGetTransforms**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-195">**CryptXmlGetTransforms**</span></span>](/windows/desktop/api/Cryptxml/nf-cryptxml-cryptxmlgettransforms)                            | <span data-ttu-id="8a1fc-196">傳回預設轉換鏈引擎的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-196">Returns information about the default transform chain engine.</span></span>                                                                                                                                                                                                                                                    |
| [<span data-ttu-id="8a1fc-197">**CryptXmlImportPublicKey**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-197">**CryptXmlImportPublicKey**</span></span>](/windows/desktop/api/Cryptxml/nf-cryptxml-cryptxmlimportpublickey)                        | <span data-ttu-id="8a1fc-198">匯入所提供之控制碼所指定的公開金鑰。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-198">Imports the public key specified by the supplied handle.</span></span>                                                                                                                                                                                                                                                         |
| [<span data-ttu-id="8a1fc-199">**CryptXmlOpenToEncode**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-199">**CryptXmlOpenToEncode**</span></span>](/windows/desktop/api/Cryptxml/nf-cryptxml-cryptxmlopentoencode)                              | <span data-ttu-id="8a1fc-200">開啟 XML 數位簽章以進行編碼，並 **傳回開啟之** 簽章元素的控制碼。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-200">Opens an XML digital signature to encode and returns a handle of the opened **Signature** element.</span></span> <span data-ttu-id="8a1fc-201">控制碼會封裝具有單一 [**CRYPT \_ XML \_**](/windows/desktop/api/Cryptxml/ns-cryptxml-crypt_xml_signature) 簽章結構的檔內容，並保持開啟狀態，直到呼叫 [**CryptXmlClose**](/windows/desktop/api/Cryptxml/nf-cryptxml-cryptxmlclose) 函式為止。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-201">The handle encapsulates a document context with a single [**CRYPT\_XML\_SIGNATURE**](/windows/desktop/api/Cryptxml/ns-cryptxml-crypt_xml_signature) structure and remains open until the [**CryptXmlClose**](/windows/desktop/api/Cryptxml/nf-cryptxml-cryptxmlclose) function is called.</span></span> |
| [<span data-ttu-id="8a1fc-202">**CryptXmlOpenToDecode**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-202">**CryptXmlOpenToDecode**</span></span>](/windows/desktop/api/Cryptxml/nf-cryptxml-cryptxmlopentodecode)                              | <span data-ttu-id="8a1fc-203">開啟 XML 數位簽章以進行解碼，並傳回封裝 [**CRYPT \_ XML \_**](/windows/desktop/api/Cryptxml/ns-cryptxml-crypt_xml_signature) 簽章結構的檔內容控制碼。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-203">Opens an XML digital signature to decode and returns the handle of the document context that encapsulates a [**CRYPT\_XML\_SIGNATURE**](/windows/desktop/api/Cryptxml/ns-cryptxml-crypt_xml_signature) structure.</span></span> <span data-ttu-id="8a1fc-204">檔內容可以包含一個 **或多個** 簽章元素。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-204">The document context can include one or more **Signature** elements.</span></span>                                                                 |
| [<span data-ttu-id="8a1fc-205">**CryptXmlSetHMACSecret**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-205">**CryptXmlSetHMACSecret**</span></span>](/windows/desktop/api/Cryptxml/nf-cryptxml-cryptxmlsethmacsecret)                            | <span data-ttu-id="8a1fc-206">在呼叫 [**CryptXmlSign**](/windows/desktop/api/Cryptxml/nf-cryptxml-cryptxmlsign) 或 [**CryptXmlVerify**](/windows/desktop/api/Cryptxml/nf-cryptxml-cryptxmlverifysignature) 函式之前，先在控制碼上設定 HMAC 秘密。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-206">Sets the HMAC secret on the handle before calling the [**CryptXmlSign**](/windows/desktop/api/Cryptxml/nf-cryptxml-cryptxmlsign) or [**CryptXmlVerify**](/windows/desktop/api/Cryptxml/nf-cryptxml-cryptxmlverifysignature) function.</span></span>                                                                                                                                                        |
| [<span data-ttu-id="8a1fc-207">**CryptXmlSign**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-207">**CryptXmlSign**</span></span>](/windows/desktop/api/Cryptxml/nf-cryptxml-cryptxmlsign)                                              | <span data-ttu-id="8a1fc-208">建立 **SignedInfo** 元素的密碼編譯簽章。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-208">Creates a cryptographic signature of a **SignedInfo** element.</span></span>                                                                                                                                                                                                                                                   |
| [<span data-ttu-id="8a1fc-209">**CryptXmlVerifySignature**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-209">**CryptXmlVerifySignature**</span></span>](/windows/desktop/api/Cryptxml/nf-cryptxml-cryptxmlverifysignature)                        | <span data-ttu-id="8a1fc-210">執行 **SignedInfo** 元素的密碼編譯簽章驗證。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-210">Performs a cryptographic signature validation of a **SignedInfo** element.</span></span>                                                                                                                                                                                                                                       |
| [<span data-ttu-id="8a1fc-211">*PFN \_ CRYPT \_ XML \_ 寫入 \_ 回呼*</span><span class="sxs-lookup"><span data-stu-id="8a1fc-211">*PFN\_CRYPT\_XML\_WRITE\_CALLBACK*</span></span>](/windows/desktop/api/Cryptxml/nc-cryptxml-pfn_crypt_xml_write_callback)            | <span data-ttu-id="8a1fc-212">建立指定之資料提供者的轉換。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-212">Creates a transform for a specified data provider.</span></span>                                                                                                                                                                                                                                                               |
| [<span data-ttu-id="8a1fc-213">*PFN \_ CRYPT \_ XML \_ CREATE \_ 轉換*</span><span class="sxs-lookup"><span data-stu-id="8a1fc-213">*PFN\_CRYPT\_XML\_CREATE\_TRANSFORM*</span></span>](/windows/desktop/api/Cryptxml/nc-cryptxml-pfn_crypt_xml_create_transform)        | <span data-ttu-id="8a1fc-214">寫入密碼編譯 XML 資料。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-214">Writes cryptographic XML data.</span></span>                                                                                                                                                                                                                                                                                   |
| [<span data-ttu-id="8a1fc-215">*PFN \_ CRYPT \_ XML \_ 資料 \_ 提供者 \_ 讀取*</span><span class="sxs-lookup"><span data-stu-id="8a1fc-215">*PFN\_CRYPT\_XML\_DATA\_PROVIDER\_READ*</span></span>](/windows/desktop/api/Cryptxml/nc-cryptxml-pfn_crypt_xml_data_provider_read)   | <span data-ttu-id="8a1fc-216">讀取密碼編譯 XML 資料。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-216">Reads cryptographic XML data.</span></span>                                                                                                                                                                                                                                                                                    |
| [<span data-ttu-id="8a1fc-217">*PFN \_ CRYPT \_ XML \_ 資料 \_ 提供者 \_ 關閉*</span><span class="sxs-lookup"><span data-stu-id="8a1fc-217">*PFN\_CRYPT\_XML\_DATA\_PROVIDER\_CLOSE*</span></span>](/windows/desktop/api/Cryptxml/nc-cryptxml-pfn_crypt_xml_data_provider_close) | <span data-ttu-id="8a1fc-218">釋放密碼編譯 XML 資料提供者。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-218">Releases the cryptographic XML data provider.</span></span>                                                                                                                                                                                                                                                                    |
| [<span data-ttu-id="8a1fc-219">*PFN \_ CRYPT \_ XML \_ 列舉 \_ ALG \_ 資訊*</span><span class="sxs-lookup"><span data-stu-id="8a1fc-219">*PFN\_CRYPT\_XML\_ENUM\_ALG\_INFO*</span></span>](/windows/desktop/api/Cryptxml/nc-cryptxml-pfn_crypt_xml_enum_alg_info)             | <span data-ttu-id="8a1fc-220">列舉預先定義和註冊的 [**CRYPT \_ XML \_ 演算法 \_ 資訊**](/windows/desktop/api/Cryptxml/ns-cryptxml-crypt_xml_algorithm_info) 專案。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-220">Enumerates predefined and registered [**CRYPT\_XML\_ALGORITHM\_INFO**](/windows/desktop/api/Cryptxml/ns-cryptxml-crypt_xml_algorithm_info) entries.</span></span>                                                                                                                                                                                                    |



 

## <a name="signer-functions"></a><span data-ttu-id="8a1fc-221">簽署者函式</span><span class="sxs-lookup"><span data-stu-id="8a1fc-221">Signer Functions</span></span>

<span data-ttu-id="8a1fc-222">提供函數來簽署和時間戳記資料。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-222">Provides functions to sign and time stamp data.</span></span>



| <span data-ttu-id="8a1fc-223">函式</span><span class="sxs-lookup"><span data-stu-id="8a1fc-223">Function</span></span>                                                   | <span data-ttu-id="8a1fc-224">描述</span><span class="sxs-lookup"><span data-stu-id="8a1fc-224">Description</span></span>                                                                                                                                                                                                                                                                                                                                                                                                         |
|------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="8a1fc-225">**SignerFreeSignerCoNtext**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-225">**SignerFreeSignerContext**</span></span>](signerfreesignercontext.md) | <span data-ttu-id="8a1fc-226">釋放先前呼叫 [**SignerSignEx**](signersignex.md)函式所配置的 [**簽署者 \_ 內容**](signer-context.md)結構。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-226">Frees a [**SIGNER\_CONTEXT**](signer-context.md) structure allocated by a previous call to the [**SignerSignEx**](signersignex.md) function.</span></span>                                                                                                                                                                                                                                                                      |
| [<span data-ttu-id="8a1fc-227">**SignError**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-227">**SignError**</span></span>](signerror.md)                             | <span data-ttu-id="8a1fc-228">呼叫 [**GetLastError**](/windows/win32/api/errhandlingapi/nf-errhandlingapi-getlasterror) 函數，並將傳回碼轉換成 **HRESULT**。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-228">Calls the [**GetLastError**](/windows/win32/api/errhandlingapi/nf-errhandlingapi-getlasterror) function and converts the return code to an **HRESULT**.</span></span>                                                                                                                                                                                                                                                                                                            |
| [<span data-ttu-id="8a1fc-229">**SignerSign**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-229">**SignerSign**</span></span>](signersign.md)                           | <span data-ttu-id="8a1fc-230">簽署指定的檔案。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-230">Signs the specified file.</span></span>                                                                                                                                                                                                                                                                                                                                                                                           |
| [<span data-ttu-id="8a1fc-231">**SignerSignEx**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-231">**SignerSignEx**</span></span>](signersignex.md)                       | <span data-ttu-id="8a1fc-232">簽署指定的檔案，並傳回已簽署資料的指標。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-232">Signs the specified file and returns a pointer to the signed data.</span></span>                                                                                                                                                                                                                                                                                                                                                  |
| [<span data-ttu-id="8a1fc-233">**SignerSignEx2**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-233">**SignerSignEx2**</span></span>](signersignex2.md)                     | <span data-ttu-id="8a1fc-234">簽署和時間戳記指定的檔案，允許多個嵌套的簽章。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-234">Signs and time stamps the specified file, allowing multiple nested signatures.</span></span>                                                                                                                                                                                                                                                                                                                                      |
| [<span data-ttu-id="8a1fc-235">**SignerTimeStamp**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-235">**SignerTimeStamp**</span></span>](signertimestamp.md)                 | <span data-ttu-id="8a1fc-236">時間戳記指定的主體。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-236">Time stamps the specified subject.</span></span> <span data-ttu-id="8a1fc-237">此函數支援 Authenticode 時間戳記。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-237">This function supports Authenticode time stamping.</span></span> <span data-ttu-id="8a1fc-238">若要執行 x.509 公開金鑰基礎結構 (RFC 3161) 時間戳記，請使用 [**SignerTimeStampEx2**](signertimestampex2.md) 函數。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-238">To perform X.509 Public Key Infrastructure (RFC 3161) time stamping, use the [**SignerTimeStampEx2**](signertimestampex2.md) function.</span></span>                                                                                                                                                                                       |
| [<span data-ttu-id="8a1fc-239">**SignerTimeStampEx**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-239">**SignerTimeStampEx**</span></span>](signertimestampex.md)             | <span data-ttu-id="8a1fc-240">時間戳記指定的主體，並選擇性地傳回包含 [*BLOB*](../secgloss/b-gly.md)指標之 [**簽署者 \_ 內容**](signer-context.md)結構的指標。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-240">Time stamps the specified subject and optionally returns a pointer to a [**SIGNER\_CONTEXT**](signer-context.md) structure that contains a pointer to a [*BLOB*](../secgloss/b-gly.md).</span></span> <span data-ttu-id="8a1fc-241">此函數支援 Authenticode 時間戳記。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-241">This function supports Authenticode time stamping.</span></span> <span data-ttu-id="8a1fc-242">若要執行 x.509 公開金鑰基礎結構 (RFC 3161) 時間戳記，請使用 [**SignerTimeStampEx2**](signertimestampex2.md) 函數。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-242">To perform X.509 Public Key Infrastructure (RFC 3161) time stamping, use the [**SignerTimeStampEx2**](signertimestampex2.md) function.</span></span> |
| [<span data-ttu-id="8a1fc-243">**SignerTimeStampEx2**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-243">**SignerTimeStampEx2**</span></span>](signertimestampex2.md)           | <span data-ttu-id="8a1fc-244">時間戳記指定的主體，並選擇性地傳回包含 [*BLOB*](../secgloss/b-gly.md)指標之 [**簽署者 \_ 內容**](signer-context.md)結構的指標。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-244">Time stamps the specified subject and optionally returns a pointer to a [**SIGNER\_CONTEXT**](signer-context.md) structure that contains a pointer to a [*BLOB*](../secgloss/b-gly.md).</span></span> <span data-ttu-id="8a1fc-245">您可以使用此函式來執行 x.509 公開金鑰基礎結構、RFC 3161 相容的時間戳記。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-245">This function can be used to perform X.509 Public Key Infrastructure, RFC 3161–compliant, time stamps.</span></span>                                                                                     |
| [<span data-ttu-id="8a1fc-246">**SignerTimeStampEx3**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-246">**SignerTimeStampEx3**</span></span>](signertimestampex3.md)           | <span data-ttu-id="8a1fc-247">時間戳記指定的主體，並支援在多個簽章上設定時間戳記。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-247">Time stamps the specified subject and supports setting time stamps on multiple signatures.</span></span>                                                                                                                                                                                                                                                                                                                          |



 

## <a name="base-cryptography-functions"></a><span data-ttu-id="8a1fc-248">基礎密碼編譯功能</span><span class="sxs-lookup"><span data-stu-id="8a1fc-248">Base Cryptography Functions</span></span>

<span data-ttu-id="8a1fc-249">基底加密函式提供最具彈性的方法來開發加密應用程式。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-249">Base cryptographic functions provide the most flexible means of developing cryptography applications.</span></span> <span data-ttu-id="8a1fc-250">所有與 [*密碼編譯服務提供者*](../secgloss/c-gly.md) (CSP) 的通訊都是透過這些函式進行。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-250">All communication with a [*cryptographic service provider*](../secgloss/c-gly.md) (CSP) occurs through these functions.</span></span>

<span data-ttu-id="8a1fc-251">CSP 是執行所有密碼編譯作業的獨立模組。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-251">A CSP is an independent module that performs all cryptographic operations.</span></span> <span data-ttu-id="8a1fc-252">每個使用密碼編譯功能的應用程式都必須至少有一個 CSP。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-252">At least one CSP is required with each application that uses cryptographic functions.</span></span> <span data-ttu-id="8a1fc-253">單一應用程式偶爾會使用一個以上的 CSP。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-253">A single application can occasionally use more than one CSP.</span></span>

<span data-ttu-id="8a1fc-254">如果使用多個 CSP，則可以在 CryptoAPI 密碼編譯函式呼叫中指定要使用的 CSP。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-254">If more than one CSP is used, the one to use can be specified in the CryptoAPI cryptographic function calls.</span></span> <span data-ttu-id="8a1fc-255">其中一個 CSP （Microsoft 基底密碼編譯提供者）與 [*CryptoAPI*](../secgloss/c-gly.md)配套。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-255">One CSP, the Microsoft Base Cryptographic Provider, is bundled with the [*CryptoAPI*](../secgloss/c-gly.md).</span></span> <span data-ttu-id="8a1fc-256">如果未指定其他 CSP，則會使用此 CSP 作為許多 CryptoAPI 函數的預設提供者。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-256">This CSP is used as a default provider by many of the CryptoAPI functions if no other CSP is specified.</span></span>

<span data-ttu-id="8a1fc-257">每個 CSP 都提供針對 CryptoAPI 提供的密碼編譯支援不同的實作為。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-257">Each CSP provides a different implementation of the cryptographic support provided to CryptoAPI.</span></span> <span data-ttu-id="8a1fc-258">有些提供更強的密碼編譯演算法;其他則包含硬體元件，例如 [*智慧卡*](../secgloss/s-gly.md)。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-258">Some provide stronger cryptographic algorithms; others contain hardware components, such as [*smart cards*](../secgloss/s-gly.md).</span></span> <span data-ttu-id="8a1fc-259">此外，某些 Csp 有時可以直接與使用者通訊，例如使用使用者的簽章 [*私密金鑰*](../secgloss/s-gly.md)來執行 [*數位簽章*](../secgloss/d-gly.md)。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-259">In addition, some CSPs can occasionally communicate directly with users, such as when [*digital signatures*](../secgloss/d-gly.md) are performed by using the user's [*signature private key*](../secgloss/s-gly.md).</span></span>

<span data-ttu-id="8a1fc-260">基底加密函式位於下列廣泛的群組中：</span><span class="sxs-lookup"><span data-stu-id="8a1fc-260">Base cryptographic functions are in the following broad groups:</span></span>

-   <span data-ttu-id="8a1fc-261">服務提供者函數</span><span class="sxs-lookup"><span data-stu-id="8a1fc-261">Service Provider Functions</span></span>
-   <span data-ttu-id="8a1fc-262">金鑰產生和交換功能</span><span class="sxs-lookup"><span data-stu-id="8a1fc-262">Key Generation and Exchange Functions</span></span>
-   <span data-ttu-id="8a1fc-263">物件編碼和解碼函數</span><span class="sxs-lookup"><span data-stu-id="8a1fc-263">Object Encoding and Decoding Functions</span></span>
-   <span data-ttu-id="8a1fc-264">資料加密和解密功能</span><span class="sxs-lookup"><span data-stu-id="8a1fc-264">Data Encryption and Decryption Functions</span></span>
-   <span data-ttu-id="8a1fc-265">雜湊和數位簽章函式</span><span class="sxs-lookup"><span data-stu-id="8a1fc-265">Hash and Digital Signature Functions</span></span>

### <a name="service-provider-functions"></a><span data-ttu-id="8a1fc-266">服務提供者函數</span><span class="sxs-lookup"><span data-stu-id="8a1fc-266">Service Provider Functions</span></span>

<span data-ttu-id="8a1fc-267">應用程式會使用下列服務功能來連接 [*加密服務提供者*](../secgloss/c-gly.md) (CSP) 並中斷連線。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-267">Applications use the following service functions to connect and disconnect a [*cryptographic service provider*](../secgloss/c-gly.md) (CSP).</span></span>

<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th><span data-ttu-id="8a1fc-268">函式</span><span class="sxs-lookup"><span data-stu-id="8a1fc-268">Function</span></span></th>
<th><span data-ttu-id="8a1fc-269">描述</span><span class="sxs-lookup"><span data-stu-id="8a1fc-269">Description</span></span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span data-ttu-id="8a1fc-270"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptacquirecontexta"><strong>CryptAcquireCoNtext</strong></a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-270"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptacquirecontexta"><strong>CryptAcquireContext</strong></a></span></span></td>
<td><blockquote>
[!Important]<br />
<span data-ttu-id="8a1fc-271">此 API 即將淘汰。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-271">This API is deprecated.</span></span> <span data-ttu-id="8a1fc-272">新的和現有的軟體應該開始使用 <a href="/windows/desktop/SecCNG/cng-portal">新一代密碼編譯 api。</a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-272">New and existing software should start using <a href="/windows/desktop/SecCNG/cng-portal">Cryptography Next Generation APIs.</a></span></span> <span data-ttu-id="8a1fc-273">Microsoft 可能會在未來的版本中移除此 API。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-273">Microsoft may remove this API in future releases.</span></span>
</blockquote>
<br/> <span data-ttu-id="8a1fc-274">取得特定 CSP 內目前使用者 <a href="/windows/desktop/SecGloss/k-gly"><em>金鑰容器</em></a> 的控制碼。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-274">Acquires a handle to the current user's <a href="/windows/desktop/SecGloss/k-gly"><em>key container</em></a> within a particular CSP.</span></span></td>
</tr>
<tr class="even">
<td><span data-ttu-id="8a1fc-275"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptcontextaddref"><strong>CryptCoNtextAddRef</strong></a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-275"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptcontextaddref"><strong>CryptContextAddRef</strong></a></span></span></td>
<td><blockquote>
[!Important]<br />
<span data-ttu-id="8a1fc-276">此 API 即將淘汰。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-276">This API is deprecated.</span></span> <span data-ttu-id="8a1fc-277">新的和現有的軟體應該開始使用 <a href="/windows/desktop/SecCNG/cng-portal">新一代密碼編譯 api。</a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-277">New and existing software should start using <a href="/windows/desktop/SecCNG/cng-portal">Cryptography Next Generation APIs.</a></span></span> <span data-ttu-id="8a1fc-278">Microsoft 可能會在未來的版本中移除此 API。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-278">Microsoft may remove this API in future releases.</span></span>
</blockquote>
<br/> <span data-ttu-id="8a1fc-279">遞增<a href="hcryptprov.md"><strong>HCRYPTPROV</strong></a>控制碼上的<a href="/windows/desktop/SecGloss/r-gly"><em>參考計數</em></a>。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-279">Increments the <a href="/windows/desktop/SecGloss/r-gly"><em>reference count</em></a> on an <a href="hcryptprov.md"><strong>HCRYPTPROV</strong></a> handle.</span></span></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="8a1fc-280"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptenumprovidersa"><strong>CryptEnumProviders</strong></a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-280"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptenumprovidersa"><strong>CryptEnumProviders</strong></a></span></span></td>
<td><blockquote>
[!Important]<br />
<span data-ttu-id="8a1fc-281">此 API 即將淘汰。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-281">This API is deprecated.</span></span> <span data-ttu-id="8a1fc-282">新的和現有的軟體應該開始使用 <a href="/windows/desktop/SecCNG/cng-portal">新一代密碼編譯 api。</a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-282">New and existing software should start using <a href="/windows/desktop/SecCNG/cng-portal">Cryptography Next Generation APIs.</a></span></span> <span data-ttu-id="8a1fc-283">Microsoft 可能會在未來的版本中移除此 API。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-283">Microsoft may remove this API in future releases.</span></span>
</blockquote>
<br/> <span data-ttu-id="8a1fc-284">列舉電腦上的提供者。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-284">Enumerates the providers on a computer.</span></span></td>
</tr>
<tr class="even">
<td><span data-ttu-id="8a1fc-285"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptenumprovidertypesa"><strong>CryptEnumProviderTypes</strong></a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-285"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptenumprovidertypesa"><strong>CryptEnumProviderTypes</strong></a></span></span></td>
<td><blockquote>
[!Important]<br />
<span data-ttu-id="8a1fc-286">此 API 即將淘汰。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-286">This API is deprecated.</span></span> <span data-ttu-id="8a1fc-287">新的和現有的軟體應該開始使用 <a href="/windows/desktop/SecCNG/cng-portal">新一代密碼編譯 api。</a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-287">New and existing software should start using <a href="/windows/desktop/SecCNG/cng-portal">Cryptography Next Generation APIs.</a></span></span> <span data-ttu-id="8a1fc-288">Microsoft 可能會在未來的版本中移除此 API。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-288">Microsoft may remove this API in future releases.</span></span>
</blockquote>
<br/> <span data-ttu-id="8a1fc-289">列舉電腦上支援的提供者類型。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-289">Enumerates the types of providers supported on the computer.</span></span></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="8a1fc-290"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptgetdefaultprovidera"><strong>CryptGetDefaultProvider</strong></a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-290"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptgetdefaultprovidera"><strong>CryptGetDefaultProvider</strong></a></span></span></td>
<td><blockquote>
[!Important]<br />
<span data-ttu-id="8a1fc-291">此 API 即將淘汰。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-291">This API is deprecated.</span></span> <span data-ttu-id="8a1fc-292">新的和現有的軟體應該開始使用 <a href="/windows/desktop/SecCNG/cng-portal">新一代密碼編譯 api。</a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-292">New and existing software should start using <a href="/windows/desktop/SecCNG/cng-portal">Cryptography Next Generation APIs.</a></span></span> <span data-ttu-id="8a1fc-293">Microsoft 可能會在未來的版本中移除此 API。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-293">Microsoft may remove this API in future releases.</span></span>
</blockquote>
<br/> <span data-ttu-id="8a1fc-294">針對目前使用者或電腦的指定提供者類型，決定預設的 CSP。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-294">Determines the default CSP either for the current user or for the computer for a specified provider type.</span></span></td>
</tr>
<tr class="even">
<td><span data-ttu-id="8a1fc-295"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptgetprovparam"><strong>CryptGetProvParam</strong></a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-295"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptgetprovparam"><strong>CryptGetProvParam</strong></a></span></span></td>
<td><blockquote>
[!Important]<br />
<span data-ttu-id="8a1fc-296">此 API 即將淘汰。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-296">This API is deprecated.</span></span> <span data-ttu-id="8a1fc-297">新的和現有的軟體應該開始使用 <a href="/windows/desktop/SecCNG/cng-portal">新一代密碼編譯 api。</a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-297">New and existing software should start using <a href="/windows/desktop/SecCNG/cng-portal">Cryptography Next Generation APIs.</a></span></span> <span data-ttu-id="8a1fc-298">Microsoft 可能會在未來的版本中移除此 API。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-298">Microsoft may remove this API in future releases.</span></span>
</blockquote>
<br/> <span data-ttu-id="8a1fc-299">抓取管理 CSP 作業的參數。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-299">Retrieves the parameters that govern the operations of a CSP.</span></span></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="8a1fc-300"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptinstalldefaultcontext"><strong>CryptInstallDefaultCoNtext</strong></a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-300"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptinstalldefaultcontext"><strong>CryptInstallDefaultContext</strong></a></span></span></td>
<td><blockquote>
[!Important]<br />
<span data-ttu-id="8a1fc-301">此 API 即將淘汰。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-301">This API is deprecated.</span></span> <span data-ttu-id="8a1fc-302">新的和現有的軟體應該開始使用 <a href="/windows/desktop/SecCNG/cng-portal">新一代密碼編譯 api。</a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-302">New and existing software should start using <a href="/windows/desktop/SecCNG/cng-portal">Cryptography Next Generation APIs.</a></span></span> <span data-ttu-id="8a1fc-303">Microsoft 可能會在未來的版本中移除此 API。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-303">Microsoft may remove this API in future releases.</span></span>
</blockquote>
<br/> <span data-ttu-id="8a1fc-304">安裝先前取得的 <a href="hcryptprov.md"><strong>HCRYPTPROV</strong></a> 內容，作為預設內容使用。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-304">Installs a previously acquired <a href="hcryptprov.md"><strong>HCRYPTPROV</strong></a> context to be used as a default context.</span></span></td>
</tr>
<tr class="even">
<td><span data-ttu-id="8a1fc-305"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptreleasecontext"><strong>CryptReleaseCoNtext</strong></a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-305"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptreleasecontext"><strong>CryptReleaseContext</strong></a></span></span></td>
<td><blockquote>
[!Important]<br />
<span data-ttu-id="8a1fc-306">此 API 即將淘汰。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-306">This API is deprecated.</span></span> <span data-ttu-id="8a1fc-307">新的和現有的軟體應該開始使用 <a href="/windows/desktop/SecCNG/cng-portal">新一代密碼編譯 api。</a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-307">New and existing software should start using <a href="/windows/desktop/SecCNG/cng-portal">Cryptography Next Generation APIs.</a></span></span> <span data-ttu-id="8a1fc-308">Microsoft 可能會在未來的版本中移除此 API。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-308">Microsoft may remove this API in future releases.</span></span>
</blockquote>
<br/> <span data-ttu-id="8a1fc-309">釋放 <a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptacquirecontexta"><strong>CryptAcquireCoNtext</strong></a> 函數所取得的控制碼。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-309">Releases the handle acquired by the <a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptacquirecontexta"><strong>CryptAcquireContext</strong></a> function.</span></span></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="8a1fc-310"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptsetprovidera"><strong>CryptSetProvider</strong></a>和<a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptsetproviderexa"> <strong>CryptSetProviderEx</strong></a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-310"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptsetprovidera"><strong>CryptSetProvider</strong></a> and <a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptsetproviderexa"><strong>CryptSetProviderEx</strong></a></span></span></td>
<td><blockquote>
[!Important]<br />
<span data-ttu-id="8a1fc-311">此 API 即將淘汰。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-311">This API is deprecated.</span></span> <span data-ttu-id="8a1fc-312">新的和現有的軟體應該開始使用 <a href="/windows/desktop/SecCNG/cng-portal">新一代密碼編譯 api。</a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-312">New and existing software should start using <a href="/windows/desktop/SecCNG/cng-portal">Cryptography Next Generation APIs.</a></span></span> <span data-ttu-id="8a1fc-313">Microsoft 可能會在未來的版本中移除此 API。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-313">Microsoft may remove this API in future releases.</span></span>
</blockquote>
<br/> <span data-ttu-id="8a1fc-314">指定特定 CSP 類型的使用者預設 CSP。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-314">Specifies the user default CSP for a particular CSP type.</span></span></td>
</tr>
<tr class="even">
<td><span data-ttu-id="8a1fc-315"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptsetprovparam"><strong>CryptSetProvParam</strong></a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-315"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptsetprovparam"><strong>CryptSetProvParam</strong></a></span></span></td>
<td><blockquote>
[!Important]<br />
<span data-ttu-id="8a1fc-316">此 API 即將淘汰。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-316">This API is deprecated.</span></span> <span data-ttu-id="8a1fc-317">新的和現有的軟體應該開始使用 <a href="/windows/desktop/SecCNG/cng-portal">新一代密碼編譯 api。</a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-317">New and existing software should start using <a href="/windows/desktop/SecCNG/cng-portal">Cryptography Next Generation APIs.</a></span></span> <span data-ttu-id="8a1fc-318">Microsoft 可能會在未來的版本中移除此 API。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-318">Microsoft may remove this API in future releases.</span></span>
</blockquote>
<br/> <span data-ttu-id="8a1fc-319">指定 CSP 的屬性。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-319">Specifies attributes of a CSP.</span></span></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="8a1fc-320"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptuninstalldefaultcontext"><strong>CryptUninstallDefaultCoNtext</strong></a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-320"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptuninstalldefaultcontext"><strong>CryptUninstallDefaultContext</strong></a></span></span></td>
<td><blockquote>
[!Important]<br />
<span data-ttu-id="8a1fc-321">此 API 即將淘汰。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-321">This API is deprecated.</span></span> <span data-ttu-id="8a1fc-322">新的和現有的軟體應該開始使用 <a href="/windows/desktop/SecCNG/cng-portal">新一代密碼編譯 api。</a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-322">New and existing software should start using <a href="/windows/desktop/SecCNG/cng-portal">Cryptography Next Generation APIs.</a></span></span> <span data-ttu-id="8a1fc-323">Microsoft 可能會在未來的版本中移除此 API。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-323">Microsoft may remove this API in future releases.</span></span>
</blockquote>
<br/> <span data-ttu-id="8a1fc-324">移除 <a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptinstalldefaultcontext"><strong>CryptInstallDefaultCoNtext</strong></a>先前安裝的預設內容。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-324">Removes a default context previously installed by <a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptinstalldefaultcontext"><strong>CryptInstallDefaultContext</strong></a>.</span></span></td>
</tr>
<tr class="even">
<td><span data-ttu-id="8a1fc-325"><a href="freecryptprovfromcertex.md"><strong>FreeCryptProvFromCertEx</strong></a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-325"><a href="freecryptprovfromcertex.md"><strong>FreeCryptProvFromCertEx</strong></a></span></span></td>
<td><span data-ttu-id="8a1fc-326">將控制碼釋放給 <a href="/windows/desktop/SecGloss/c-gly"><em>密碼編譯服務提供者</em></a> (CSP) 或密碼編譯 API：新一代 (CNG) 金鑰。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-326">Releases the handle either to a <a href="/windows/desktop/SecGloss/c-gly"><em>cryptographic service provider</em></a> (CSP) or to a Cryptography API: Next Generation (CNG) key.</span></span></td>
</tr>
</tbody>
</table>



 

### <a name="key-generation-and-exchange-functions"></a><span data-ttu-id="8a1fc-327">金鑰產生和交換功能</span><span class="sxs-lookup"><span data-stu-id="8a1fc-327">Key Generation and Exchange Functions</span></span>

<span data-ttu-id="8a1fc-328">金鑰產生和 exchange 功能會與其他使用者 [*交換金鑰*](../secgloss/e-gly.md) ，以及建立、設定和終結 [*密碼編譯金鑰*](../secgloss/c-gly.md)。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-328">Key generation and exchange functions [*exchange keys*](../secgloss/e-gly.md) with other users and create, configure, and destroy [*cryptographic keys*](../secgloss/c-gly.md).</span></span>

<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th><span data-ttu-id="8a1fc-329">函式</span><span class="sxs-lookup"><span data-stu-id="8a1fc-329">Function</span></span></th>
<th><span data-ttu-id="8a1fc-330">描述</span><span class="sxs-lookup"><span data-stu-id="8a1fc-330">Description</span></span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span data-ttu-id="8a1fc-331"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptderivekey"><strong>CryptDeriveKey</strong></a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-331"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptderivekey"><strong>CryptDeriveKey</strong></a></span></span></td>
<td><blockquote>
[!Important]<br />
<span data-ttu-id="8a1fc-332">此 API 即將淘汰。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-332">This API is deprecated.</span></span> <span data-ttu-id="8a1fc-333">新的和現有的軟體應該開始使用 <a href="/windows/desktop/SecCNG/cng-portal">新一代密碼編譯 api。</a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-333">New and existing software should start using <a href="/windows/desktop/SecCNG/cng-portal">Cryptography Next Generation APIs.</a></span></span> <span data-ttu-id="8a1fc-334">Microsoft 可能會在未來的版本中移除此 API。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-334">Microsoft may remove this API in future releases.</span></span>
</blockquote>
<br/> <span data-ttu-id="8a1fc-335">建立從密碼衍生的金鑰。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-335">Creates a key derived from a password.</span></span></td>
</tr>
<tr class="even">
<td><span data-ttu-id="8a1fc-336"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptdestroykey"><strong>CryptDestroyKey</strong></a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-336"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptdestroykey"><strong>CryptDestroyKey</strong></a></span></span></td>
<td><blockquote>
[!Important]<br />
<span data-ttu-id="8a1fc-337">此 API 即將淘汰。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-337">This API is deprecated.</span></span> <span data-ttu-id="8a1fc-338">新的和現有的軟體應該開始使用 <a href="/windows/desktop/SecCNG/cng-portal">新一代密碼編譯 api。</a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-338">New and existing software should start using <a href="/windows/desktop/SecCNG/cng-portal">Cryptography Next Generation APIs.</a></span></span> <span data-ttu-id="8a1fc-339">Microsoft 可能會在未來的版本中移除此 API。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-339">Microsoft may remove this API in future releases.</span></span>
</blockquote>
<br/> <span data-ttu-id="8a1fc-340">終結金鑰。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-340">Destroys a key.</span></span></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="8a1fc-341"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptduplicatekey"><strong>CryptDuplicateKey</strong></a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-341"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptduplicatekey"><strong>CryptDuplicateKey</strong></a></span></span></td>
<td><blockquote>
[!Important]<br />
<span data-ttu-id="8a1fc-342">此 API 即將淘汰。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-342">This API is deprecated.</span></span> <span data-ttu-id="8a1fc-343">新的和現有的軟體應該開始使用 <a href="/windows/desktop/SecCNG/cng-portal">新一代密碼編譯 api。</a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-343">New and existing software should start using <a href="/windows/desktop/SecCNG/cng-portal">Cryptography Next Generation APIs.</a></span></span> <span data-ttu-id="8a1fc-344">Microsoft 可能會在未來的版本中移除此 API。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-344">Microsoft may remove this API in future releases.</span></span>
</blockquote>
<br/> <span data-ttu-id="8a1fc-345">建立金鑰的完整複本，包括金鑰的 <a href="/windows/desktop/SecGloss/s-gly"><em>狀態</em></a> 。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-345">Makes an exact copy of a key, including the <a href="/windows/desktop/SecGloss/s-gly"><em>state</em></a> of the key.</span></span></td>
</tr>
<tr class="even">
<td><span data-ttu-id="8a1fc-346"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptexportkey"><strong>CryptExportKey</strong></a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-346"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptexportkey"><strong>CryptExportKey</strong></a></span></span></td>
<td><blockquote>
[!Important]<br />
<span data-ttu-id="8a1fc-347">此 API 即將淘汰。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-347">This API is deprecated.</span></span> <span data-ttu-id="8a1fc-348">新的和現有的軟體應該開始使用 <a href="/windows/desktop/SecCNG/cng-portal">新一代密碼編譯 api。</a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-348">New and existing software should start using <a href="/windows/desktop/SecCNG/cng-portal">Cryptography Next Generation APIs.</a></span></span> <span data-ttu-id="8a1fc-349">Microsoft 可能會在未來的版本中移除此 API。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-349">Microsoft may remove this API in future releases.</span></span>
</blockquote>
<br/> <span data-ttu-id="8a1fc-350">從 CSP 將金鑰傳輸到應用程式記憶體空間中的 <a href="/windows/desktop/SecGloss/k-gly"><em>金鑰 BLOB</em></a> 。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-350">Transfers a key from the CSP into a <a href="/windows/desktop/SecGloss/k-gly"><em>key BLOB</em></a> in the application's memory space.</span></span></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="8a1fc-351"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptgenkey"><strong>CryptGenKey</strong></a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-351"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptgenkey"><strong>CryptGenKey</strong></a></span></span></td>
<td><blockquote>
[!Important]<br />
<span data-ttu-id="8a1fc-352">此 API 即將淘汰。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-352">This API is deprecated.</span></span> <span data-ttu-id="8a1fc-353">新的和現有的軟體應該開始使用 <a href="/windows/desktop/SecCNG/cng-portal">新一代密碼編譯 api。</a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-353">New and existing software should start using <a href="/windows/desktop/SecCNG/cng-portal">Cryptography Next Generation APIs.</a></span></span> <span data-ttu-id="8a1fc-354">Microsoft 可能會在未來的版本中移除此 API。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-354">Microsoft may remove this API in future releases.</span></span>
</blockquote>
<br/> <span data-ttu-id="8a1fc-355">建立隨機索引鍵。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-355">Creates a random key.</span></span></td>
</tr>
<tr class="even">
<td><span data-ttu-id="8a1fc-356"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptgenrandom"><strong>CryptGenRandom</strong></a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-356"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptgenrandom"><strong>CryptGenRandom</strong></a></span></span></td>
<td><blockquote>
[!Important]<br />
<span data-ttu-id="8a1fc-357">此 API 即將淘汰。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-357">This API is deprecated.</span></span> <span data-ttu-id="8a1fc-358">新的和現有的軟體應該開始使用 <a href="/windows/desktop/SecCNG/cng-portal">新一代密碼編譯 api。</a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-358">New and existing software should start using <a href="/windows/desktop/SecCNG/cng-portal">Cryptography Next Generation APIs.</a></span></span> <span data-ttu-id="8a1fc-359">Microsoft 可能會在未來的版本中移除此 API。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-359">Microsoft may remove this API in future releases.</span></span>
</blockquote>
<br/> <span data-ttu-id="8a1fc-360">產生亂數據。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-360">Generates random data.</span></span></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="8a1fc-361"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptgetkeyparam"><strong>CryptGetKeyParam</strong></a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-361"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptgetkeyparam"><strong>CryptGetKeyParam</strong></a></span></span></td>
<td><blockquote>
[!Important]<br />
<span data-ttu-id="8a1fc-362">此 API 即將淘汰。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-362">This API is deprecated.</span></span> <span data-ttu-id="8a1fc-363">新的和現有的軟體應該開始使用 <a href="/windows/desktop/SecCNG/cng-portal">新一代密碼編譯 api。</a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-363">New and existing software should start using <a href="/windows/desktop/SecCNG/cng-portal">Cryptography Next Generation APIs.</a></span></span> <span data-ttu-id="8a1fc-364">Microsoft 可能會在未來的版本中移除此 API。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-364">Microsoft may remove this API in future releases.</span></span>
</blockquote>
<br/> <span data-ttu-id="8a1fc-365">捕獲金鑰的參數。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-365">Retrieves a key's parameters.</span></span></td>
</tr>
<tr class="even">
<td><span data-ttu-id="8a1fc-366"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptgetuserkey"><strong>CryptGetUserKey</strong></a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-366"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptgetuserkey"><strong>CryptGetUserKey</strong></a></span></span></td>
<td><blockquote>
[!Important]<br />
<span data-ttu-id="8a1fc-367">此 API 即將淘汰。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-367">This API is deprecated.</span></span> <span data-ttu-id="8a1fc-368">新的和現有的軟體應該開始使用 <a href="/windows/desktop/SecCNG/cng-portal">新一代密碼編譯 api。</a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-368">New and existing software should start using <a href="/windows/desktop/SecCNG/cng-portal">Cryptography Next Generation APIs.</a></span></span> <span data-ttu-id="8a1fc-369">Microsoft 可能會在未來的版本中移除此 API。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-369">Microsoft may remove this API in future releases.</span></span>
</blockquote>
<br/> <span data-ttu-id="8a1fc-370">取得金鑰交換或簽章金鑰的控制碼。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-370">Gets a handle to the key exchange or signature key.</span></span></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="8a1fc-371"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptimportkey"><strong>CryptImportKey</strong></a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-371"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptimportkey"><strong>CryptImportKey</strong></a></span></span></td>
<td><blockquote>
[!Important]<br />
<span data-ttu-id="8a1fc-372">此 API 即將淘汰。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-372">This API is deprecated.</span></span> <span data-ttu-id="8a1fc-373">新的和現有的軟體應該開始使用 <a href="/windows/desktop/SecCNG/cng-portal">新一代密碼編譯 api。</a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-373">New and existing software should start using <a href="/windows/desktop/SecCNG/cng-portal">Cryptography Next Generation APIs.</a></span></span> <span data-ttu-id="8a1fc-374">Microsoft 可能會在未來的版本中移除此 API。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-374">Microsoft may remove this API in future releases.</span></span>
</blockquote>
<br/> <span data-ttu-id="8a1fc-375">從 <a href="/windows/desktop/SecGloss/k-gly"><em>金鑰 BLOB</em></a> 將金鑰傳輸至 CSP。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-375">Transfers a key from a <a href="/windows/desktop/SecGloss/k-gly"><em>key BLOB</em></a> to a CSP.</span></span></td>
</tr>
<tr class="even">
<td><span data-ttu-id="8a1fc-376"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptsetkeyparam"><strong>CryptSetKeyParam</strong></a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-376"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptsetkeyparam"><strong>CryptSetKeyParam</strong></a></span></span></td>
<td><blockquote>
[!Important]<br />
<span data-ttu-id="8a1fc-377">此 API 即將淘汰。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-377">This API is deprecated.</span></span> <span data-ttu-id="8a1fc-378">新的和現有的軟體應該開始使用 <a href="/windows/desktop/SecCNG/cng-portal">新一代密碼編譯 api。</a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-378">New and existing software should start using <a href="/windows/desktop/SecCNG/cng-portal">Cryptography Next Generation APIs.</a></span></span> <span data-ttu-id="8a1fc-379">Microsoft 可能會在未來的版本中移除此 API。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-379">Microsoft may remove this API in future releases.</span></span>
</blockquote>
<br/> <span data-ttu-id="8a1fc-380">指定索引鍵的參數。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-380">Specifies a key's parameters.</span></span></td>
</tr>
</tbody>
</table>



 

### <a name="object-encoding-and-decoding-functions"></a><span data-ttu-id="8a1fc-381">物件編碼和解碼函數</span><span class="sxs-lookup"><span data-stu-id="8a1fc-381">Object Encoding and Decoding Functions</span></span>

<span data-ttu-id="8a1fc-382">這些是一般化的編碼和解碼功能。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-382">These are generalized encoding and decoding functions.</span></span> <span data-ttu-id="8a1fc-383">它們可用來編碼和解碼 [*憑證*](../secgloss/c-gly.md)、 [*憑證撤銷清單*](../secgloss/c-gly.md) (crl) 、 [*憑證要求*](../secgloss/c-gly.md)和憑證延伸。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-383">They are used to encode and decode [*certificates*](../secgloss/c-gly.md), [*certificate revocation lists*](../secgloss/c-gly.md) (CRLs), [*certificate requests*](../secgloss/c-gly.md), and certificate extensions.</span></span>

| <span data-ttu-id="8a1fc-384">函式</span><span class="sxs-lookup"><span data-stu-id="8a1fc-384">Function</span></span>                                           | <span data-ttu-id="8a1fc-385">描述</span><span class="sxs-lookup"><span data-stu-id="8a1fc-385">Description</span></span>                                                                                                                                      |
|----------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="8a1fc-386">**CryptDecodeObject**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-386">**CryptDecodeObject**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptdecodeobject)     | <span data-ttu-id="8a1fc-387">解碼 *lpszStructType* 型別的結構。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-387">Decodes a structure of type *lpszStructType*.</span></span>                                                                                                    |
| [<span data-ttu-id="8a1fc-388">**CryptDecodeObjectEx**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-388">**CryptDecodeObjectEx**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptdecodeobjectex) | <span data-ttu-id="8a1fc-389">解碼 *lpszStructType* 型別的結構。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-389">Decodes a structure of type *lpszStructType*.</span></span> <span data-ttu-id="8a1fc-390">[**CryptDecodeObjectEx**](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptdecodeobjectex) 支援一次傳遞記憶體配置選項。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-390">[**CryptDecodeObjectEx**](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptdecodeobjectex) supports the one-pass memory allocation option.</span></span> |
| [<span data-ttu-id="8a1fc-391">**CryptEncodeObject**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-391">**CryptEncodeObject**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptencodeobject)     | <span data-ttu-id="8a1fc-392">將 *lpszStructType* 類型的結構編碼。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-392">Encodes a structure of type *lpszStructType*.</span></span>                                                                                                    |
| [<span data-ttu-id="8a1fc-393">**CryptEncodeObjectEx**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-393">**CryptEncodeObjectEx**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptencodeobjectex) | <span data-ttu-id="8a1fc-394">將 *lpszStructType* 類型的結構編碼。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-394">Encodes a structure of type *lpszStructType*.</span></span> <span data-ttu-id="8a1fc-395">[**CryptEncodeObjectEx**](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptencodeobjectex) 支援一次傳遞記憶體配置選項。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-395">[**CryptEncodeObjectEx**](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptencodeobjectex) supports the one-pass memory allocation option.</span></span> |



 

### <a name="data-encryption-and-decryption-functions"></a><span data-ttu-id="8a1fc-396">資料加密和解密功能</span><span class="sxs-lookup"><span data-stu-id="8a1fc-396">Data Encryption and Decryption Functions</span></span>

<span data-ttu-id="8a1fc-397">下列函數支援加密和解密作業。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-397">The following functions support encryption and decryption operations.</span></span> <span data-ttu-id="8a1fc-398">[**CryptEncrypt**](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptencrypt) 和 [**CryptDecrypt**](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptdecrypt) 在呼叫之前需要 [*密碼編譯金鑰*](../secgloss/c-gly.md) 。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-398">[**CryptEncrypt**](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptencrypt) and [**CryptDecrypt**](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptdecrypt) require a [*cryptographic key*](../secgloss/c-gly.md) before being called.</span></span> <span data-ttu-id="8a1fc-399">這是使用 [**CryptGenKey**](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptgenkey)、 [**CryptDeriveKey**](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptderivekey)或 [**CryptImportKey**](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptimportkey) 函數來完成。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-399">This is done by using the [**CryptGenKey**](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptgenkey), [**CryptDeriveKey**](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptderivekey), or [**CryptImportKey**](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptimportkey) function.</span></span> <span data-ttu-id="8a1fc-400">建立金鑰時，會指定加密演算法。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-400">The encryption algorithm is specified when the key is created.</span></span> <span data-ttu-id="8a1fc-401">[**CryptSetKeyParam**](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptsetkeyparam) 可以設定額外的加密參數。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-401">[**CryptSetKeyParam**](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptsetkeyparam) can set additional encryption parameters.</span></span>

<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th><span data-ttu-id="8a1fc-402">函式</span><span class="sxs-lookup"><span data-stu-id="8a1fc-402">Function</span></span></th>
<th><span data-ttu-id="8a1fc-403">描述</span><span class="sxs-lookup"><span data-stu-id="8a1fc-403">Description</span></span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span data-ttu-id="8a1fc-404"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptdecrypt"><strong>CryptDecrypt</strong></a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-404"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptdecrypt"><strong>CryptDecrypt</strong></a></span></span></td>
<td><blockquote>
[!Important]<br />
<span data-ttu-id="8a1fc-405">此 API 即將淘汰。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-405">This API is deprecated.</span></span> <span data-ttu-id="8a1fc-406">新的和現有的軟體應該開始使用 <a href="/windows/desktop/SecCNG/cng-portal">新一代密碼編譯 api。</a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-406">New and existing software should start using <a href="/windows/desktop/SecCNG/cng-portal">Cryptography Next Generation APIs.</a></span></span> <span data-ttu-id="8a1fc-407">Microsoft 可能會在未來的版本中移除此 API。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-407">Microsoft may remove this API in future releases.</span></span>
</blockquote>
<br/> <span data-ttu-id="8a1fc-408">使用指定的加密金鑰來解密 <a href="/windows/desktop/SecGloss/c-gly"><em>加密</em></a> 文字區段。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-408">Decrypts a section of <a href="/windows/desktop/SecGloss/c-gly"><em>ciphertext</em></a> by using the specified encryption key.</span></span></td>
</tr>
<tr class="even">
<td><span data-ttu-id="8a1fc-409"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptencrypt"><strong>CryptEncrypt</strong></a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-409"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptencrypt"><strong>CryptEncrypt</strong></a></span></span></td>
<td><blockquote>
[!Important]<br />
<span data-ttu-id="8a1fc-410">此 API 即將淘汰。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-410">This API is deprecated.</span></span> <span data-ttu-id="8a1fc-411">新的和現有的軟體應該開始使用 <a href="/windows/desktop/SecCNG/cng-portal">新一代密碼編譯 api。</a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-411">New and existing software should start using <a href="/windows/desktop/SecCNG/cng-portal">Cryptography Next Generation APIs.</a></span></span> <span data-ttu-id="8a1fc-412">Microsoft 可能會在未來的版本中移除此 API。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-412">Microsoft may remove this API in future releases.</span></span>
</blockquote>
<br/> <span data-ttu-id="8a1fc-413">使用指定的加密金鑰來加密 <a href="/windows/desktop/SecGloss/p-gly"><em>純文字</em></a> 區段。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-413">Encrypts a section of <a href="/windows/desktop/SecGloss/p-gly"><em>plaintext</em></a> by using the specified encryption key.</span></span></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="8a1fc-414"><a href="/windows/desktop/api/Dpapi/nf-dpapi-cryptprotectdata"><strong>CryptProtectData</strong></a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-414"><a href="/windows/desktop/api/Dpapi/nf-dpapi-cryptprotectdata"><strong>CryptProtectData</strong></a></span></span></td>
<td><span data-ttu-id="8a1fc-415">針對 <a href="/previous-versions/windows/desktop/legacy/aa381414(v=vs.85)"><strong>DATA_BLOB</strong></a> 結構中的資料執行加密。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-415">Performs encryption on the data in a <a href="/previous-versions/windows/desktop/legacy/aa381414(v=vs.85)"><strong>DATA_BLOB</strong></a> structure.</span></span></td>
</tr>
<tr class="even">
<td><span data-ttu-id="8a1fc-416"><a href="/windows/desktop/api/Dpapi/nf-dpapi-cryptprotectmemory"><strong>CryptProtectMemory</strong></a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-416"><a href="/windows/desktop/api/Dpapi/nf-dpapi-cryptprotectmemory"><strong>CryptProtectMemory</strong></a></span></span></td>
<td><span data-ttu-id="8a1fc-417">加密記憶體以保護機密資訊。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-417">Encrypts memory to protect sensitive information.</span></span></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="8a1fc-418"><a href="/windows/desktop/api/Dpapi/nf-dpapi-cryptunprotectdata"><strong>CryptUnprotectData</strong></a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-418"><a href="/windows/desktop/api/Dpapi/nf-dpapi-cryptunprotectdata"><strong>CryptUnprotectData</strong></a></span></span></td>
<td><span data-ttu-id="8a1fc-419">在 <a href="/previous-versions/windows/desktop/legacy/aa381414(v=vs.85)"><strong>DATA_BLOB</strong></a>中執行資料的解密和完整性檢查。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-419">Performs a decryption and integrity check of the data in a <a href="/previous-versions/windows/desktop/legacy/aa381414(v=vs.85)"><strong>DATA_BLOB</strong></a>.</span></span></td>
</tr>
<tr class="even">
<td><span data-ttu-id="8a1fc-420"><a href="/windows/desktop/api/Dpapi/nf-dpapi-cryptunprotectmemory"><strong>CryptUnprotectMemory</strong></a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-420"><a href="/windows/desktop/api/Dpapi/nf-dpapi-cryptunprotectmemory"><strong>CryptUnprotectMemory</strong></a></span></span></td>
<td><span data-ttu-id="8a1fc-421">解密使用 <a href="/windows/desktop/api/Dpapi/nf-dpapi-cryptprotectmemory"><strong>CryptProtectMemory</strong></a>加密的記憶體。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-421">Decrypts memory that was encrypted using <a href="/windows/desktop/api/Dpapi/nf-dpapi-cryptprotectmemory"><strong>CryptProtectMemory</strong></a>.</span></span></td>
</tr>
</tbody>
</table>



 

### <a name="hash-and-digital-signature-functions"></a><span data-ttu-id="8a1fc-422">雜湊和數位簽章函式</span><span class="sxs-lookup"><span data-stu-id="8a1fc-422">Hash and Digital Signature Functions</span></span>

<span data-ttu-id="8a1fc-423">這些函數會計算資料的 [*雜湊*](../secgloss/h-gly.md) ，也會建立並驗證 [*數位簽章*](../secgloss/d-gly.md)。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-423">These functions compute [*hashes*](../secgloss/h-gly.md) of data and also create and verify [*digital signatures*](../secgloss/d-gly.md).</span></span> <span data-ttu-id="8a1fc-424">雜湊也稱為訊息摘要。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-424">Hashes are also known as message digests.</span></span>

<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th><span data-ttu-id="8a1fc-425">函式</span><span class="sxs-lookup"><span data-stu-id="8a1fc-425">Function</span></span></th>
<th><span data-ttu-id="8a1fc-426">描述</span><span class="sxs-lookup"><span data-stu-id="8a1fc-426">Description</span></span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span data-ttu-id="8a1fc-427"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptcreatehash"><strong>CryptCreateHash</strong></a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-427"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptcreatehash"><strong>CryptCreateHash</strong></a></span></span></td>
<td><blockquote>
[!Important]<br />
<span data-ttu-id="8a1fc-428">此 API 即將淘汰。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-428">This API is deprecated.</span></span> <span data-ttu-id="8a1fc-429">新的和現有的軟體應該開始使用 <a href="/windows/desktop/SecCNG/cng-portal">新一代密碼編譯 api。</a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-429">New and existing software should start using <a href="/windows/desktop/SecCNG/cng-portal">Cryptography Next Generation APIs.</a></span></span> <span data-ttu-id="8a1fc-430">Microsoft 可能會在未來的版本中移除此 API。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-430">Microsoft may remove this API in future releases.</span></span>
</blockquote>
<br/> <span data-ttu-id="8a1fc-431">建立空的雜湊物件。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-431">Creates an empty hash object.</span></span></td>
</tr>
<tr class="even">
<td><span data-ttu-id="8a1fc-432"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptdestroyhash"><strong>CryptDestroyHash</strong></a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-432"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptdestroyhash"><strong>CryptDestroyHash</strong></a></span></span></td>
<td><blockquote>
[!Important]<br />
<span data-ttu-id="8a1fc-433">此 API 即將淘汰。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-433">This API is deprecated.</span></span> <span data-ttu-id="8a1fc-434">新的和現有的軟體應該開始使用 <a href="/windows/desktop/SecCNG/cng-portal">新一代密碼編譯 api。</a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-434">New and existing software should start using <a href="/windows/desktop/SecCNG/cng-portal">Cryptography Next Generation APIs.</a></span></span> <span data-ttu-id="8a1fc-435">Microsoft 可能會在未來的版本中移除此 API。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-435">Microsoft may remove this API in future releases.</span></span>
</blockquote>
<br/> <span data-ttu-id="8a1fc-436">終結雜湊物件。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-436">Destroys a hash object.</span></span></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="8a1fc-437"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptduplicatehash"><strong>CryptDuplicateHash</strong></a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-437"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptduplicatehash"><strong>CryptDuplicateHash</strong></a></span></span></td>
<td><span data-ttu-id="8a1fc-438">複製雜湊物件。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-438">Duplicates a hash object.</span></span></td>
</tr>
<tr class="even">
<td><span data-ttu-id="8a1fc-439"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptgethashparam"><strong>CryptGetHashParam</strong></a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-439"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptgethashparam"><strong>CryptGetHashParam</strong></a></span></span></td>
<td><span data-ttu-id="8a1fc-440">抓取雜湊物件參數。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-440">Retrieves a hash object parameter.</span></span></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="8a1fc-441"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-crypthashdata"><strong>CryptHashData</strong></a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-441"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-crypthashdata"><strong>CryptHashData</strong></a></span></span></td>
<td><blockquote>
[!Important]<br />
<span data-ttu-id="8a1fc-442">此 API 即將淘汰。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-442">This API is deprecated.</span></span> <span data-ttu-id="8a1fc-443">新的和現有的軟體應該開始使用 <a href="/windows/desktop/SecCNG/cng-portal">新一代密碼編譯 api。</a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-443">New and existing software should start using <a href="/windows/desktop/SecCNG/cng-portal">Cryptography Next Generation APIs.</a></span></span> <span data-ttu-id="8a1fc-444">Microsoft 可能會在未來的版本中移除此 API。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-444">Microsoft may remove this API in future releases.</span></span>
</blockquote>
<br/> <span data-ttu-id="8a1fc-445">雜湊資料區塊，並將其加入至指定的雜湊物件。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-445">Hashes a block of data, adding it to the specified hash object.</span></span></td>
</tr>
<tr class="even">
<td><span data-ttu-id="8a1fc-446"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-crypthashsessionkey"><strong>CryptHashSessionKey</strong></a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-446"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-crypthashsessionkey"><strong>CryptHashSessionKey</strong></a></span></span></td>
<td><blockquote>
[!Important]<br />
<span data-ttu-id="8a1fc-447">此 API 即將淘汰。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-447">This API is deprecated.</span></span> <span data-ttu-id="8a1fc-448">新的和現有的軟體應該開始使用 <a href="/windows/desktop/SecCNG/cng-portal">新一代密碼編譯 api。</a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-448">New and existing software should start using <a href="/windows/desktop/SecCNG/cng-portal">Cryptography Next Generation APIs.</a></span></span> <span data-ttu-id="8a1fc-449">Microsoft 可能會在未來的版本中移除此 API。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-449">Microsoft may remove this API in future releases.</span></span>
</blockquote>
<br/> <span data-ttu-id="8a1fc-450">雜湊工作階段金鑰，並將它加入至指定的雜湊物件。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-450">Hashes a session key, adding it to the specified hash object.</span></span></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="8a1fc-451"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptsethashparam"><strong>CryptSetHashParam</strong></a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-451"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptsethashparam"><strong>CryptSetHashParam</strong></a></span></span></td>
<td><blockquote>
[!Important]<br />
<span data-ttu-id="8a1fc-452">此 API 即將淘汰。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-452">This API is deprecated.</span></span> <span data-ttu-id="8a1fc-453">新的和現有的軟體應該開始使用 <a href="/windows/desktop/SecCNG/cng-portal">新一代密碼編譯 api。</a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-453">New and existing software should start using <a href="/windows/desktop/SecCNG/cng-portal">Cryptography Next Generation APIs.</a></span></span> <span data-ttu-id="8a1fc-454">Microsoft 可能會在未來的版本中移除此 API。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-454">Microsoft may remove this API in future releases.</span></span>
</blockquote>
<br/> <span data-ttu-id="8a1fc-455">設定雜湊物件參數。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-455">Sets a hash object parameter.</span></span></td>
</tr>
<tr class="even">
<td><span data-ttu-id="8a1fc-456"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptsignhasha"><strong>CryptSignHash</strong></a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-456"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptsignhasha"><strong>CryptSignHash</strong></a></span></span></td>
<td><blockquote>
[!Important]<br />
<span data-ttu-id="8a1fc-457">此 API 即將淘汰。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-457">This API is deprecated.</span></span> <span data-ttu-id="8a1fc-458">新的和現有的軟體應該開始使用 <a href="/windows/desktop/SecCNG/cng-portal">新一代密碼編譯 api。</a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-458">New and existing software should start using <a href="/windows/desktop/SecCNG/cng-portal">Cryptography Next Generation APIs.</a></span></span> <span data-ttu-id="8a1fc-459">Microsoft 可能會在未來的版本中移除此 API。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-459">Microsoft may remove this API in future releases.</span></span>
</blockquote>
<br/> <span data-ttu-id="8a1fc-460">簽署指定的雜湊物件。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-460">Signs the specified hash object.</span></span></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="8a1fc-461"><a href="/windows/desktop/api/Cryptuiapi/nf-cryptuiapi-cryptuiwizdigitalsign"><strong>CryptUIWizDigitalSign</strong></a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-461"><a href="/windows/desktop/api/Cryptuiapi/nf-cryptuiapi-cryptuiwizdigitalsign"><strong>CryptUIWizDigitalSign</strong></a></span></span></td>
<td><span data-ttu-id="8a1fc-462">顯示以數位方式簽署檔或 <a href="/windows/desktop/SecGloss/b-gly"><em>BLOB</em></a>的 wizard。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-462">Displays a wizard that digitally signs a document or a <a href="/windows/desktop/SecGloss/b-gly"><em>BLOB</em></a>.</span></span></td>
</tr>
<tr class="even">
<td><span data-ttu-id="8a1fc-463"><a href="/windows/desktop/api/Cryptuiapi/nf-cryptuiapi-cryptuiwizfreedigitalsigncontext"><strong>CryptUIWizFreeDigitalSignCoNtext</strong></a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-463"><a href="/windows/desktop/api/Cryptuiapi/nf-cryptuiapi-cryptuiwizfreedigitalsigncontext"><strong>CryptUIWizFreeDigitalSignContext</strong></a></span></span></td>
<td><span data-ttu-id="8a1fc-464">釋放 <a href="/windows/desktop/api/Cryptuiapi/ns-cryptuiapi-cryptui_wiz_digital_sign_context"><strong>CRYPTUI_WIZ_DIGITAL_SIGN_CONTEXT</strong></a> 結構的指標。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-464">Releases a pointer to a <a href="/windows/desktop/api/Cryptuiapi/ns-cryptuiapi-cryptui_wiz_digital_sign_context"><strong>CRYPTUI_WIZ_DIGITAL_SIGN_CONTEXT</strong></a> structure.</span></span></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="8a1fc-465"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptverifysignaturea"><strong>CryptVerifySignature</strong></a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-465"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptverifysignaturea"><strong>CryptVerifySignature</strong></a></span></span></td>
<td><blockquote>
[!Important]<br />
<span data-ttu-id="8a1fc-466">此 API 即將淘汰。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-466">This API is deprecated.</span></span> <span data-ttu-id="8a1fc-467">新的和現有的軟體應該開始使用 <a href="/windows/desktop/SecCNG/cng-portal">新一代密碼編譯 api。</a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-467">New and existing software should start using <a href="/windows/desktop/SecCNG/cng-portal">Cryptography Next Generation APIs.</a></span></span> <span data-ttu-id="8a1fc-468">Microsoft 可能會在未來的版本中移除此 API。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-468">Microsoft may remove this API in future releases.</span></span>
</blockquote>
<br/> <span data-ttu-id="8a1fc-469">在指定雜湊物件的控制碼的情況下，驗證數位簽章。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-469">Verifies a digital signature, given a handle to the hash object.</span></span></td>
</tr>
<tr class="even">
<td><span data-ttu-id="8a1fc-470"><a href="/windows/desktop/api/Cryptuiapi/nc-cryptuiapi-pfncfilterproc"><strong>PFNCFILTERPROC</strong></a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-470"><a href="/windows/desktop/api/Cryptuiapi/nc-cryptuiapi-pfncfilterproc"><strong>PFNCFILTERPROC</strong></a></span></span></td>
<td><span data-ttu-id="8a1fc-471">篩選出現在 <a href="/windows/desktop/api/Cryptuiapi/nf-cryptuiapi-cryptuiwizdigitalsign"><strong>CryptUIWizDigitalSign</strong></a> 函式所顯示的數位簽章 wizard 中的憑證。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-471">Filters the certificates that appear in the digital signature wizard displayed by the <a href="/windows/desktop/api/Cryptuiapi/nf-cryptuiapi-cryptuiwizdigitalsign"><strong>CryptUIWizDigitalSign</strong></a> function.</span></span></td>
</tr>
</tbody>
</table>



 

## <a name="certificate-and-certificate-store-functions"></a><span data-ttu-id="8a1fc-472">憑證和憑證存放區功能</span><span class="sxs-lookup"><span data-stu-id="8a1fc-472">Certificate and Certificate Store Functions</span></span>

<span data-ttu-id="8a1fc-473">憑證和憑證存放區功能會管理 [*憑證*](../secgloss/c-gly.md)的使用、儲存和抓取、 [*憑證撤銷清單*](../secgloss/c-gly.md) (crl) ，以及 (ctl) 的 [*憑證信任清單*](../secgloss/c-gly.md) 。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-473">Certificate and certificate store functions manage the use, storage, and retrieval of [*certificates*](../secgloss/c-gly.md), [*certificate revocation lists*](../secgloss/c-gly.md) (CRLs), and [*certificate trust lists*](../secgloss/c-gly.md) (CTLs).</span></span> <span data-ttu-id="8a1fc-474">這些函數分為下列群組：</span><span class="sxs-lookup"><span data-stu-id="8a1fc-474">These functions are divided into the following groups:</span></span>

-   <span data-ttu-id="8a1fc-475">憑證存放區功能</span><span class="sxs-lookup"><span data-stu-id="8a1fc-475">Certificate Store Functions</span></span>
-   <span data-ttu-id="8a1fc-476">憑證和憑證存放區維護功能</span><span class="sxs-lookup"><span data-stu-id="8a1fc-476">Certificate and Certificate Store Maintenance Functions</span></span>
-   <span data-ttu-id="8a1fc-477">憑證函數</span><span class="sxs-lookup"><span data-stu-id="8a1fc-477">Certificate Functions</span></span>
-   <span data-ttu-id="8a1fc-478">憑證撤銷清單函式</span><span class="sxs-lookup"><span data-stu-id="8a1fc-478">Certificate Revocation List Functions</span></span>
-   <span data-ttu-id="8a1fc-479">憑證信任清單函式</span><span class="sxs-lookup"><span data-stu-id="8a1fc-479">Certificate Trust List Functions</span></span>
-   <span data-ttu-id="8a1fc-480">擴充屬性函式</span><span class="sxs-lookup"><span data-stu-id="8a1fc-480">Extended Property Functions</span></span>
-   <span data-ttu-id="8a1fc-481">MakeCert 函式</span><span class="sxs-lookup"><span data-stu-id="8a1fc-481">MakeCert Functions</span></span>

### <a name="certificate-store-functions"></a><span data-ttu-id="8a1fc-482">憑證存放區功能</span><span class="sxs-lookup"><span data-stu-id="8a1fc-482">Certificate Store Functions</span></span>

<span data-ttu-id="8a1fc-483">使用者網站可以經過一段時間，收集許多憑證。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-483">A user site can, over time, collect many certificates.</span></span> <span data-ttu-id="8a1fc-484">網站通常會有網站使用者的憑證，以及其他憑證來描述使用者所傳達的個人和實體。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-484">Typically, a site has certificates for the user of the site as well as other certificates that describe those individuals and entities with whom the user communicates.</span></span> <span data-ttu-id="8a1fc-485">每個實體都可以有一個以上的憑證。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-485">For each entity, there can be more than one certificate.</span></span> <span data-ttu-id="8a1fc-486">對於每個個別的憑證，都應該有一鏈驗證憑證，可提供回受信任 [*根憑證*](../secgloss/r-gly.md)的線索。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-486">For each individual certificate, there should be a chain of verifying certificates that provides a trail back to a trusted [*root certificate*](../secgloss/r-gly.md).</span></span> <span data-ttu-id="8a1fc-487">[*憑證存放區*](../secgloss/c-gly.md) 與其相關功能提供儲存、抓取、列舉、驗證和使用儲存在憑證中之資訊的功能。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-487">[*Certificate stores*](../secgloss/c-gly.md) and their related functions provide functionality to store, retrieve, enumerate, verify, and use the information stored in the certificates.</span></span>

| <span data-ttu-id="8a1fc-488">函式</span><span class="sxs-lookup"><span data-stu-id="8a1fc-488">Function</span></span>                                                               | <span data-ttu-id="8a1fc-489">描述</span><span class="sxs-lookup"><span data-stu-id="8a1fc-489">Description</span></span>                                                                                                                                                                                                                                                                                                                               |
|------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="8a1fc-490">**CertAddStoreToCollection**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-490">**CertAddStoreToCollection**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-certaddstoretocollection)           | <span data-ttu-id="8a1fc-491">將同一個憑證存放區新增至集合憑證存放區。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-491">Adds a sibling certificate store to a collection certificate store.</span></span>                                                                                                                                                                                                                                                                       |
| [<span data-ttu-id="8a1fc-492">**CertCloseStore**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-492">**CertCloseStore**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-certclosestore)                               | <span data-ttu-id="8a1fc-493">關閉憑證存放區控制碼。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-493">Closes a certificate store handle.</span></span>                                                                                                                                                                                                                                                                                                        |
| [<span data-ttu-id="8a1fc-494">**CertControlStore**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-494">**CertControlStore**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-certcontrolstore)                           | <span data-ttu-id="8a1fc-495">允許應用程式在快取存放區的內容與保存到儲存體的存放區內容之間有差異時收到通知。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-495">Allows an application to be notified when there is a difference between the contents of a cached store and the contents of the store that is persisted to storage.</span></span> <span data-ttu-id="8a1fc-496">它也提供快取存放區的 desynchronization （如有必要），並提供將快取存放區中所做的變更認可至保存儲存體的方法。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-496">It also provides desynchronization of the cached store, if necessary, and provides a means to commit changes made in the cached store to persisted storage.</span></span><br/> |
| [<span data-ttu-id="8a1fc-497">**CertDuplicateStore**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-497">**CertDuplicateStore**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-certduplicatestore)                       | <span data-ttu-id="8a1fc-498">藉由遞增 [*參考計數*](../secgloss/r-gly.md)來複製存放區控制碼。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-498">Duplicates a store handle by incrementing the [*reference count*](../secgloss/r-gly.md).</span></span>                                                                                                                                                                                            |
| [<span data-ttu-id="8a1fc-499">**CertEnumPhysicalStore**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-499">**CertEnumPhysicalStore**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-certenumphysicalstore)                 | <span data-ttu-id="8a1fc-500">列舉指定系統存放區的實體存放區。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-500">Enumerates the physical stores for a specified system store.</span></span>                                                                                                                                                                                                                                                                              |
| [<span data-ttu-id="8a1fc-501">**CertEnumSystemStore**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-501">**CertEnumSystemStore**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-certenumsystemstore)                     | <span data-ttu-id="8a1fc-502">列舉所有可用的系統存放區。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-502">Enumerates all available system stores.</span></span>                                                                                                                                                                                                                                                                                                   |
| [<span data-ttu-id="8a1fc-503">**CertEnumSystemStoreLocation**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-503">**CertEnumSystemStoreLocation**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-certenumsystemstorelocation)     | <span data-ttu-id="8a1fc-504">列舉所有具有可用系統存放區的位置。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-504">Enumerates all of the locations that have an available system store.</span></span>                                                                                                                                                                                                                                                                      |
| [<span data-ttu-id="8a1fc-505">**CertGetStoreProperty**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-505">**CertGetStoreProperty**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-certgetstoreproperty)                   | <span data-ttu-id="8a1fc-506">取得存放區屬性。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-506">Gets a store property.</span></span>                                                                                                                                                                                                                                                                                                                    |
| [<span data-ttu-id="8a1fc-507">**CertOpenStore**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-507">**CertOpenStore**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-certopenstore)                                 | <span data-ttu-id="8a1fc-508">使用指定的存放區提供者類型，開啟憑證存放區。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-508">Opens a certificate store using a specified store provider type.</span></span>                                                                                                                                                                                                                                                                          |
| [<span data-ttu-id="8a1fc-509">**CertOpenSystemStore**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-509">**CertOpenSystemStore**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-certopensystemstorea)                     | <span data-ttu-id="8a1fc-510">開啟以子系統通訊協定為基礎的系統憑證存放區。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-510">Opens a system certificate store based on a subsystem protocol.</span></span>                                                                                                                                                                                                                                                                           |
| [<span data-ttu-id="8a1fc-511">**CertRegisterPhysicalStore**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-511">**CertRegisterPhysicalStore**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-certregisterphysicalstore)         | <span data-ttu-id="8a1fc-512">將實體存放區新增至登錄系統存放區集合。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-512">Adds a physical store to a registry system store collection.</span></span>                                                                                                                                                                                                                                                                              |
| [<span data-ttu-id="8a1fc-513">**CertRegisterSystemStore**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-513">**CertRegisterSystemStore**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-certregistersystemstore)             | <span data-ttu-id="8a1fc-514">註冊系統存放區。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-514">Registers a system store.</span></span>                                                                                                                                                                                                                                                                                                                 |
| [<span data-ttu-id="8a1fc-515">**CertRemoveStoreFromCollection**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-515">**CertRemoveStoreFromCollection**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-certremovestorefromcollection) | <span data-ttu-id="8a1fc-516">從集合存放區中移除同一個憑證存放區。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-516">Removes a sibling certificate store from a collection store.</span></span>                                                                                                                                                                                                                                                                              |
| [<span data-ttu-id="8a1fc-517">**CertSaveStore**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-517">**CertSaveStore**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-certsavestore)                                 | <span data-ttu-id="8a1fc-518">儲存憑證存放區。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-518">Saves the certificate store.</span></span>                                                                                                                                                                                                                                                                                                              |
| [<span data-ttu-id="8a1fc-519">**CertSetStoreProperty**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-519">**CertSetStoreProperty**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-certsetstoreproperty)                   | <span data-ttu-id="8a1fc-520">設定存放區屬性。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-520">Sets a store property.</span></span>                                                                                                                                                                                                                                                                                                                    |
| [<span data-ttu-id="8a1fc-521">**CertUnregisterPhysicalStore**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-521">**CertUnregisterPhysicalStore**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-certunregisterphysicalstore)     | <span data-ttu-id="8a1fc-522">從指定的系統存放區集合中移除實體存放區。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-522">Removes a physical store from a specified system store collection.</span></span>                                                                                                                                                                                                                                                                        |
| [<span data-ttu-id="8a1fc-523">**CertUnregisterSystemStore**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-523">**CertUnregisterSystemStore**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-certunregistersystemstore)         | <span data-ttu-id="8a1fc-524">取消註冊指定的系統存放區。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-524">Unregisters a specified system store.</span></span>                                                                                                                                                                                                                                                                                                     |
| [<span data-ttu-id="8a1fc-525">**CryptUIWizExport**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-525">**CryptUIWizExport**</span></span>](/windows/desktop/api/Cryptuiapi/nf-cryptuiapi-cryptuiwizexport)                           | <span data-ttu-id="8a1fc-526">提供一個可匯出憑證、憑證信任清單 (CTL) 、憑證撤銷清單 (CRL) 或憑證存放區的 wizard。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-526">Presents a wizard that exports a certificate, certificate trust list (CTL), certificate revocation list (CRL), or certificate store.</span></span>                                                                                                                                                                                                      |
| [<span data-ttu-id="8a1fc-527">**CryptUIWizImport**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-527">**CryptUIWizImport**</span></span>](/windows/desktop/api/Cryptuiapi/nf-cryptuiapi-cryptuiwizimport)                           | <span data-ttu-id="8a1fc-528">提供一個可匯入憑證、憑證信任清單 (CTL) 、憑證撤銷清單 (CRL) 或憑證存放區的 wizard。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-528">Presents a wizard that imports a certificate, certificate trust list (CTL), certificate revocation list (CRL), or certificate store.</span></span>                                                                                                                                                                                                      |



 

### <a name="certificate-and-certificate-store-maintenance-functions"></a><span data-ttu-id="8a1fc-529">憑證和憑證存放區維護功能</span><span class="sxs-lookup"><span data-stu-id="8a1fc-529">Certificate and Certificate Store Maintenance Functions</span></span>

<span data-ttu-id="8a1fc-530">CryptoAPI 提供一組一般憑證和憑證存放區維護功能。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-530">CryptoAPI provides a set of general certificate and certificate store maintenance functions.</span></span>

| <span data-ttu-id="8a1fc-531">函式</span><span class="sxs-lookup"><span data-stu-id="8a1fc-531">Function</span></span>                                                                                                                              | <span data-ttu-id="8a1fc-532">描述</span><span class="sxs-lookup"><span data-stu-id="8a1fc-532">Description</span></span>                                                                                    |
|---------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="8a1fc-533">**CertAddSerializedElementToStore**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-533">**CertAddSerializedElementToStore**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-certaddserializedelementtostore)                                                            | <span data-ttu-id="8a1fc-534">將序列化的憑證或 CRL 元素新增至存放區。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-534">Adds the serialized certificate or CRL element to the store.</span></span>                                   |
| [<span data-ttu-id="8a1fc-535">**CertCreateCoNtext**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-535">**CertCreateContext**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-certcreatecontext)                                                                                        | <span data-ttu-id="8a1fc-536">從編碼的位元組建立指定的內容。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-536">Creates the specified context from the encoded bytes.</span></span> <span data-ttu-id="8a1fc-537">新的內容不會放在存放區中。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-537">The new context is not put into a store.</span></span> |
| [<span data-ttu-id="8a1fc-538">**CertEnumSubjectInSortedCTL**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-538">**CertEnumSubjectInSortedCTL**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-certenumsubjectinsortedctl)                                                                      | <span data-ttu-id="8a1fc-539">列舉已排序 CTL 內容中的 TrustedSubjects。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-539">Enumerates the TrustedSubjects in a sorted CTL context.</span></span>                                        |
| [<span data-ttu-id="8a1fc-540">**CertFindSubjectInCTL**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-540">**CertFindSubjectInCTL**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-certfindsubjectinctl)                                                                                  | <span data-ttu-id="8a1fc-541">在 CTL 中尋找指定的主體。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-541">Finds the specified subject in a CTL.</span></span>                                                          |
| [<span data-ttu-id="8a1fc-542">**CertFindSubjectInSortedCTL**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-542">**CertFindSubjectInSortedCTL**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-certfindsubjectinsortedctl)                                                                      | <span data-ttu-id="8a1fc-543">在排序的 CTL 中尋找指定的主體。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-543">Finds the specified subject in a sorted CTL.</span></span>                                                   |
| <span data-ttu-id="8a1fc-544">[**OpenPersonalTrustDBDialog**](/windows/desktop/api/wintrust/nf-wintrust-openpersonaltrustdbdialog)和 [ **OpenPersonalTrustDBDialogEx**](/windows/desktop/api/wintrust/nf-wintrust-openpersonaltrustdbdialogex)</span><span class="sxs-lookup"><span data-stu-id="8a1fc-544">[**OpenPersonalTrustDBDialog**](/windows/desktop/api/wintrust/nf-wintrust-openpersonaltrustdbdialog) and [**OpenPersonalTrustDBDialogEx**](/windows/desktop/api/wintrust/nf-wintrust-openpersonaltrustdbdialogex)</span></span> | <span data-ttu-id="8a1fc-545">顯示 [ **憑證** ] 對話方塊。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-545">Displays the **Certificates** dialog box.</span></span>                                                      |



 

### <a name="certificate-functions"></a><span data-ttu-id="8a1fc-546">憑證函數</span><span class="sxs-lookup"><span data-stu-id="8a1fc-546">Certificate Functions</span></span>

<span data-ttu-id="8a1fc-547">大部分的 [*憑證*](../secgloss/c-gly.md) 函數都有相關的函式來處理 [*crl*](../secgloss/c-gly.md) 和 [*ctl*](../secgloss/c-gly.md)。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-547">Most [*Certificate*](../secgloss/c-gly.md) functions have related functions to deal with [*CRLs*](../secgloss/c-gly.md) and [*CTLs*](../secgloss/c-gly.md).</span></span> <span data-ttu-id="8a1fc-548">如需相關 CRL 和 CTL 函數的詳細資訊，請參閱憑證撤銷清單函式和憑證信任清單函式。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-548">For more information about related CRL and CTL functions, see Certificate Revocation List Functions and Certificate Trust List Functions.</span></span>

| <span data-ttu-id="8a1fc-549">函式</span><span class="sxs-lookup"><span data-stu-id="8a1fc-549">Function</span></span>                                                                             | <span data-ttu-id="8a1fc-550">描述</span><span class="sxs-lookup"><span data-stu-id="8a1fc-550">Description</span></span>                                                                                                                                                                                                                                     |
|--------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="8a1fc-551">**CertAddCertificateCoNtextToStore**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-551">**CertAddCertificateContextToStore**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-certaddcertificatecontexttostore)         | <span data-ttu-id="8a1fc-552">將憑證內容新增至憑證存放區。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-552">Adds a certificate context to the certificate store.</span></span>                                                                                                                                                                                            |
| [<span data-ttu-id="8a1fc-553">**CertAddCertificateLinkToStore**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-553">**CertAddCertificateLinkToStore**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-certaddcertificatelinktostore)               | <span data-ttu-id="8a1fc-554">將憑證存放區中的連結新增至不同存放區中的憑證內容。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-554">Adds a link in a certificate store to a certificate context in a different store.</span></span>                                                                                                                                                               |
| [<span data-ttu-id="8a1fc-555">**CertAddEncodedCertificateToStore**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-555">**CertAddEncodedCertificateToStore**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-certaddencodedcertificatetostore)         | <span data-ttu-id="8a1fc-556">將編碼的憑證轉換成憑證內容，然後將內容新增至憑證存放區。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-556">Converts the encoded certificate to a certificate context, and then adds the context to the certificate store.</span></span>                                                                                                                                  |
| [<span data-ttu-id="8a1fc-557">**CertAddRefServerOcspResponse**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-557">**CertAddRefServerOcspResponse**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-certaddrefserverocspresponse)                 | <span data-ttu-id="8a1fc-558">遞增 **HCERT \_ 伺服器 \_ OCSP \_ 回應** 控制碼的參考計數。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-558">Increments the reference count for an **HCERT\_SERVER\_OCSP\_RESPONSE** handle.</span></span>                                                                                                                                                                 |
| [<span data-ttu-id="8a1fc-559">**CertAddRefServerOcspResponseCoNtext**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-559">**CertAddRefServerOcspResponseContext**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-certaddrefserverocspresponsecontext)   | <span data-ttu-id="8a1fc-560">遞增 [**CERT \_ SERVER \_ OCSP \_ 回應 \_ 內容**](/windows/desktop/api/Wincrypt/ns-wincrypt-cert_server_ocsp_response_context) 結構的參考計數。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-560">Increments the reference count for a [**CERT\_SERVER\_OCSP\_RESPONSE\_CONTEXT**](/windows/desktop/api/Wincrypt/ns-wincrypt-cert_server_ocsp_response_context) structure.</span></span>                                                                                                              |
| [<span data-ttu-id="8a1fc-561">**CertCloseServerOcspResponse**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-561">**CertCloseServerOcspResponse**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-certcloseserverocspresponse)                   | <span data-ttu-id="8a1fc-562">關閉 [*線上憑證狀態通訊協定*](../secgloss/o-gly.md) (OCSP) server 回應控制碼。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-562">Closes an [*online certificate status protocol*](../secgloss/o-gly.md) (OCSP) server response handle.</span></span>                                               |
| [<span data-ttu-id="8a1fc-563">**CertCreateCertificateCoNtext**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-563">**CertCreateCertificateContext**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-certcreatecertificatecontext)                 | <span data-ttu-id="8a1fc-564">從編碼的憑證建立憑證內容。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-564">Creates a certificate context from an encoded certificate.</span></span> <span data-ttu-id="8a1fc-565">建立的內容不會放在憑證存放區中。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-565">The created context is not put in a certificate store.</span></span>                                                                                                                               |
| [<span data-ttu-id="8a1fc-566">**CertCreateSelfSignCertificate**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-566">**CertCreateSelfSignCertificate**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-certcreateselfsigncertificate)               | <span data-ttu-id="8a1fc-567">建立自我簽署憑證。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-567">Creates a self-signed certificate.</span></span>                                                                                                                                                                                                              |
| [<span data-ttu-id="8a1fc-568">**CertDeleteCertificateFromStore**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-568">**CertDeleteCertificateFromStore**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-certdeletecertificatefromstore)             | <span data-ttu-id="8a1fc-569">從憑證存放區刪除憑證。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-569">Deletes a certificate from the certificate store.</span></span>                                                                                                                                                                                               |
| [<span data-ttu-id="8a1fc-570">**CertDuplicateCertificateCoNtext**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-570">**CertDuplicateCertificateContext**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-certduplicatecertificatecontext)           | <span data-ttu-id="8a1fc-571">藉由遞增其 [*參考計數*](../secgloss/r-gly.md)來複製憑證內容。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-571">Duplicates a certificate context by incrementing its [*reference count*](../secgloss/r-gly.md).</span></span>                                                                                           |
| [<span data-ttu-id="8a1fc-572">**CertEnumCertificatesInStore**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-572">**CertEnumCertificatesInStore**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-certenumcertificatesinstore)                   | <span data-ttu-id="8a1fc-573">列舉憑證存放區中的憑證內容。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-573">Enumerates the certificate contexts in the certificate store.</span></span>                                                                                                                                                                                   |
| [<span data-ttu-id="8a1fc-574">**CertFindCertificateInStore**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-574">**CertFindCertificateInStore**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-certfindcertificateinstore)                     | <span data-ttu-id="8a1fc-575">在憑證存放區中尋找符合搜尋準則的第一個或下一個憑證內容。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-575">Finds the first, or next, certificate context in the certificate store that meets a search criterion.</span></span>                                                                                                                                           |
| [<span data-ttu-id="8a1fc-576">**CertFreeCertificateCoNtext**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-576">**CertFreeCertificateContext**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-certfreecertificatecontext)                     | <span data-ttu-id="8a1fc-577">釋出憑證內容。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-577">Frees a certificate context.</span></span>                                                                                                                                                                                                                    |
| [<span data-ttu-id="8a1fc-578">**CertGetIssuerCertificateFromStore**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-578">**CertGetIssuerCertificateFromStore**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-certgetissuercertificatefromstore)       | <span data-ttu-id="8a1fc-579">從憑證存放區取得指定之主體憑證的第一個或下一個發行者的憑證內容。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-579">Gets a certificate context from the certificate store for the first, or next, issuer of the specified subject certificate.</span></span>                                                                                                                      |
| [<span data-ttu-id="8a1fc-580">**CertGetServerOcspResponseCoNtext**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-580">**CertGetServerOcspResponseContext**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-certgetserverocspresponsecontext)         | <span data-ttu-id="8a1fc-581">抓取未封鎖、時間有效的 [*線上憑證狀態通訊協定*](../secgloss/o-gly.md) (指定之控制碼的 OCSP) 回應內容。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-581">Retrieves a non-blocking, time valid [*online certificate status protocol*](../secgloss/o-gly.md) (OCSP) response context for the specified handle.</span></span> |
| [<span data-ttu-id="8a1fc-582">**CertGetSubjectCertificateFromStore**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-582">**CertGetSubjectCertificateFromStore**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-certgetsubjectcertificatefromstore)     | <span data-ttu-id="8a1fc-583">從憑證存放區取得主體憑證內容，此內容是由其簽發者和序號來唯一識別。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-583">Gets from the certificate store the subject certificate context, which is uniquely identified by its issuer and serial number.</span></span>                                                                                                                  |
| [<span data-ttu-id="8a1fc-584">**CertGetValidUsages**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-584">**CertGetValidUsages**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-certgetvalidusages)                                     | <span data-ttu-id="8a1fc-585">傳回使用方式的陣列，其中包含憑證陣列中所有憑證的有效使用方式交集。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-585">Returns an array of usages that consist of the intersection of the valid usages for all certificates in an array of certificates.</span></span>                                                                                                               |
| [<span data-ttu-id="8a1fc-586">**CertOpenServerOcspResponse**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-586">**CertOpenServerOcspResponse**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-certopenserverocspresponse)                     | <span data-ttu-id="8a1fc-587">開啟 [*線上憑證狀態通訊協定*](../secgloss/o-gly.md) 的控制碼， (與伺服器憑證鏈相關聯的 OCSP) 回應。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-587">Opens a handle to an [*online certificate status protocol*](../secgloss/o-gly.md) (OCSP) response associated with a server certificate chain.</span></span>       |
| [<span data-ttu-id="8a1fc-588">**CertRetrieveLogoOrBiometricInfo**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-588">**CertRetrieveLogoOrBiometricInfo**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-certretrievelogoorbiometricinfo)           | <span data-ttu-id="8a1fc-589">針對 **szOID \_ 商標 \_ ext** 或 **szOID \_ 生物特徵辨識 \_ EXT** 憑證延伸模組中指定的標誌或生物特徵辨識資訊執行 URL 抓取。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-589">Performs a URL retrieval of logo or biometric information specified in either the **szOID\_LOGOTYPE\_EXT** or **szOID\_BIOMETRIC\_EXT** certificate extension.</span></span>                                                                                  |
| [<span data-ttu-id="8a1fc-590">**CertSelectCertificate**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-590">**CertSelectCertificate**</span></span>](/windows/win32/api/cryptdlg/nf-cryptdlg-certselectcertificatea)                               | <span data-ttu-id="8a1fc-591">提供一個對話方塊，可讓使用者從符合指定準則的一組憑證中選取憑證。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-591">Presents a dialog box that allows the user to select certificates from a set of certificates that match a given criteria.</span></span>                                                                                                                       |
| [<span data-ttu-id="8a1fc-592">**CertSelectCertificateChains**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-592">**CertSelectCertificateChains**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-certselectcertificatechains)                   | <span data-ttu-id="8a1fc-593">根據指定的選取準則來抓取證書鏈。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-593">Retrieves certificate chains based on specified selection criteria.</span></span>                                                                                                                                                                             |
| [<span data-ttu-id="8a1fc-594">**CertSelectionGetSerializedBlob**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-594">**CertSelectionGetSerializedBlob**</span></span>](/windows/desktop/api/Cryptuiapi/nf-cryptuiapi-certselectiongetserializedblob)             | <span data-ttu-id="8a1fc-595">Helper 函式，用來從 [**CERT \_ SELECTUI \_ 輸入**](/windows/desktop/api/Cryptuiapi/ns-cryptuiapi-cert_selectui_input)結構中取出序列化的憑證 [*BLOB*](../secgloss/b-gly.md) 。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-595">A helper function used to retrieve a serialized certificate [*BLOB*](../secgloss/b-gly.md) from a [**CERT\_SELECTUI\_INPUT**](/windows/desktop/api/Cryptuiapi/ns-cryptuiapi-cert_selectui_input) structure.</span></span>                                               |
| [<span data-ttu-id="8a1fc-596">**CertSerializeCertificateStoreElement**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-596">**CertSerializeCertificateStoreElement**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-certserializecertificatestoreelement) | <span data-ttu-id="8a1fc-597">序列化憑證內容的編碼憑證，以及其屬性的編碼標記法。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-597">Serializes a certificate context's encoded certificate and an encoded representation of its properties.</span></span>                                                                                                                                         |
| [<span data-ttu-id="8a1fc-598">**CertVerifySubjectCertificateCoNtext**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-598">**CertVerifySubjectCertificateContext**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-certverifysubjectcertificatecontext)   | <span data-ttu-id="8a1fc-599">使用簽發者對主體憑證執行啟用的驗證檢查。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-599">Performs the enabled verification checks on the subject certificate using the issuer.</span></span>                                                                                                                                                           |
| [<span data-ttu-id="8a1fc-600">**CryptUIDlgCertMgr**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-600">**CryptUIDlgCertMgr**</span></span>](/windows/desktop/api/Cryptuiapi/nf-cryptuiapi-cryptuidlgcertmgr)                                       | <span data-ttu-id="8a1fc-601">顯示允許使用者管理憑證的對話方塊。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-601">Displays a dialog box that allows the user to manage certificates.</span></span>                                                                                                                                                                              |
| [<span data-ttu-id="8a1fc-602">**CryptUIDlgSelectCertificate**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-602">**CryptUIDlgSelectCertificate**</span></span>](cryptuidlgselectcertificate.md)                   | <span data-ttu-id="8a1fc-603">顯示允許使用者選取憑證的對話方塊。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-603">Displays a dialog box that allows a user to select a certificate.</span></span>                                                                                                                                                                               |
| [<span data-ttu-id="8a1fc-604">**CryptUIDlgSelectCertificateFromStore**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-604">**CryptUIDlgSelectCertificateFromStore**</span></span>](/windows/desktop/api/Cryptuiapi/nf-cryptuiapi-cryptuidlgselectcertificatefromstore) | <span data-ttu-id="8a1fc-605">顯示允許從指定的存放區選取憑證的對話方塊。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-605">Displays a dialog box that allows the selection of a certificate from a specified store.</span></span>                                                                                                                                                        |
| [<span data-ttu-id="8a1fc-606">**CryptUIDlgViewCertificate**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-606">**CryptUIDlgViewCertificate**</span></span>](/windows/desktop/api/Cryptuiapi/nf-cryptuiapi-cryptuidlgviewcertificatea)                       | <span data-ttu-id="8a1fc-607">提供顯示指定憑證的對話方塊。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-607">Presents a dialog box that displays a specified certificate.</span></span>                                                                                                                                                                                    |
| [<span data-ttu-id="8a1fc-608">**CryptUIDlgViewCoNtext**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-608">**CryptUIDlgViewContext**</span></span>](/windows/desktop/api/Cryptuiapi/nf-cryptuiapi-cryptuidlgviewcontext)                               | <span data-ttu-id="8a1fc-609">顯示憑證、CRL 或 CTL。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-609">Displays a certificate, CRL, or CTL.</span></span>                                                                                                                                                                                                            |
| [<span data-ttu-id="8a1fc-610">**CryptUIDlgViewSignerInfo**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-610">**CryptUIDlgViewSignerInfo**</span></span>](cryptuidlgviewsignerinfo.md)                         | <span data-ttu-id="8a1fc-611">顯示對話方塊，其中包含已簽署訊息的簽署者資訊。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-611">Displays a dialog box that contains the signer information for a signed message.</span></span>                                                                                                                                                                |
| [<span data-ttu-id="8a1fc-612">**GetFriendlyNameOfCert**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-612">**GetFriendlyNameOfCert**</span></span>](/windows/desktop/api/CryptDlg/nf-cryptdlg-getfriendlynameofcerta)                               | <span data-ttu-id="8a1fc-613">捕獲憑證的顯示名稱。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-613">Retrieves the display name for a certificate.</span></span>                                                                                                                                                                                                   |
| [<span data-ttu-id="8a1fc-614">**RKeyCloseKeyService**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-614">**RKeyCloseKeyService**</span></span>](rkeyclosekeyservice.md)                                   | <span data-ttu-id="8a1fc-615">關閉金鑰服務控制碼。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-615">Closes a key service handle.</span></span>                                                                                                                                                                                                                    |
| [<span data-ttu-id="8a1fc-616">**RKeyOpenKeyService**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-616">**RKeyOpenKeyService**</span></span>](rkeyopenkeyservice.md)                                     | <span data-ttu-id="8a1fc-617">在遠端電腦上開啟金鑰服務控制碼。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-617">Opens a key service handle on a remote computer.</span></span>                                                                                                                                                                                                |
| [<span data-ttu-id="8a1fc-618">**RKeyPFXInstall**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-618">**RKeyPFXInstall**</span></span>](rkeypfxinstall.md)                                             | <span data-ttu-id="8a1fc-619">在遠端電腦上安裝憑證。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-619">Installs a certificate on a remote computer.</span></span>                                                                                                                                                                                                    |



 

### <a name="certificate-revocation-list-functions"></a><span data-ttu-id="8a1fc-620">憑證撤銷清單函式</span><span class="sxs-lookup"><span data-stu-id="8a1fc-620">Certificate Revocation List Functions</span></span>

<span data-ttu-id="8a1fc-621">這些函式會管理 (Crl) 的 [*憑證撤銷清單*](../secgloss/c-gly.md) 的儲存和抓取。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-621">These functions manage the storage and retrieval of [*certificate revocation lists*](../secgloss/c-gly.md) (CRLs).</span></span>

| <span data-ttu-id="8a1fc-622">函式</span><span class="sxs-lookup"><span data-stu-id="8a1fc-622">Function</span></span>                                                             | <span data-ttu-id="8a1fc-623">描述</span><span class="sxs-lookup"><span data-stu-id="8a1fc-623">Description</span></span>                                                                                                                                                                           |
|----------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="8a1fc-624">**CertAddCRLCoNtextToStore**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-624">**CertAddCRLContextToStore**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-certaddcrlcontexttostore)         | <span data-ttu-id="8a1fc-625">將 CRL 內容新增至憑證存放區。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-625">Adds a CRL context to the certificate store.</span></span>                                                                                                                                          |
| [<span data-ttu-id="8a1fc-626">**CertAddCRLLinkToStore**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-626">**CertAddCRLLinkToStore**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-certaddcrllinktostore)               | <span data-ttu-id="8a1fc-627">將存放區中的連結新增至不同存放區中的 CRL 內容。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-627">Adds a link in a store to a CRL context in a different store.</span></span>                                                                                                                         |
| [<span data-ttu-id="8a1fc-628">**CertAddEncodedCRLToStore**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-628">**CertAddEncodedCRLToStore**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-certaddencodedcrltostore)         | <span data-ttu-id="8a1fc-629">將編碼的 CRL 轉換成 CRL 內容，然後將內容新增至憑證存放區。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-629">Converts the encoded CRL to a CRL context, and then adds the context to the certificate store.</span></span>                                                                                        |
| [<span data-ttu-id="8a1fc-630">**CertCreateCRLCoNtext**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-630">**CertCreateCRLContext**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-certcreatecrlcontext)                 | <span data-ttu-id="8a1fc-631">從編碼的 CRL 建立 CRL 內容。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-631">Creates a CRL context from an encoded CRL.</span></span> <span data-ttu-id="8a1fc-632">建立的內容不會放在憑證存放區中。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-632">The created context is not put in a certificate store.</span></span>                                                                                     |
| [<span data-ttu-id="8a1fc-633">**CertDeleteCRLFromStore**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-633">**CertDeleteCRLFromStore**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-certdeletecrlfromstore)             | <span data-ttu-id="8a1fc-634">刪除憑證存放區中的 CRL。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-634">Deletes a CRL from the certificate store.</span></span>                                                                                                                                             |
| [<span data-ttu-id="8a1fc-635">**CertDuplicateCRLCoNtext**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-635">**CertDuplicateCRLContext**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-certduplicatecrlcontext)           | <span data-ttu-id="8a1fc-636">藉由遞增 [*參考計數*](../secgloss/r-gly.md)來複製 CRL 內容。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-636">Duplicates a CRL context by incrementing the [*reference count*](../secgloss/r-gly.md).</span></span>                                         |
| [<span data-ttu-id="8a1fc-637">**CertEnumCRLsInStore**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-637">**CertEnumCRLsInStore**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-certenumcrlsinstore)                   | <span data-ttu-id="8a1fc-638">列舉存放區中的 CRL 內容。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-638">Enumerates the CRL contexts in a store.</span></span>                                                                                                                                               |
| [<span data-ttu-id="8a1fc-639">**CertFindCertificateInCRL**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-639">**CertFindCertificateInCRL**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-certfindcertificateincrl)         | <span data-ttu-id="8a1fc-640">搜尋指定憑證 (CRL) 的 [*憑證撤銷清單*](../secgloss/c-gly.md) 。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-640">Searches the [*certificate revocation list*](../secgloss/c-gly.md) (CRL) for the specified certificate.</span></span> |
| [<span data-ttu-id="8a1fc-641">**CertFindCRLInStore**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-641">**CertFindCRLInStore**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-certfindcrlinstore)                     | <span data-ttu-id="8a1fc-642">在憑證存放區中尋找符合特定準則的第一個或下一個 CRL 內容。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-642">Finds the first, or next, CRL context in the certificate store that matches a specific criterion.</span></span>                                                                                     |
| [<span data-ttu-id="8a1fc-643">**CertFreeCRLCoNtext**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-643">**CertFreeCRLContext**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-certfreecrlcontext)                     | <span data-ttu-id="8a1fc-644">釋放 CRL 內容。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-644">Frees a CRL context.</span></span>                                                                                                                                                                  |
| [<span data-ttu-id="8a1fc-645">**CertGetCRLFromStore**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-645">**CertGetCRLFromStore**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-certgetcrlfromstore)                   | <span data-ttu-id="8a1fc-646">針對指定的簽發者憑證，取得憑證存放區中的第一個或下一個 CRL 內容。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-646">Gets the first, or next, CRL context from the certificate store for the specified issuer certificate.</span></span>                                                                                 |
| [<span data-ttu-id="8a1fc-647">**CertSerializeCRLStoreElement**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-647">**CertSerializeCRLStoreElement**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-certserializecrlstoreelement) | <span data-ttu-id="8a1fc-648">序列化 CRL 內容的編碼 CRL 和其屬性。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-648">Serializes the CRL context's encoded CRL and its properties.</span></span>                                                                                                                          |



 

### <a name="certificate-trust-list-functions"></a><span data-ttu-id="8a1fc-649">憑證信任清單函式</span><span class="sxs-lookup"><span data-stu-id="8a1fc-649">Certificate Trust List Functions</span></span>

<span data-ttu-id="8a1fc-650">這些函式會管理 [*憑證信任清單*](../secgloss/c-gly.md) (ctl) 的儲存和抓取。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-650">These functions manage the storage and retrieval of [*certificate trust lists*](../secgloss/c-gly.md) (CTLs).</span></span>

| <span data-ttu-id="8a1fc-651">函式</span><span class="sxs-lookup"><span data-stu-id="8a1fc-651">Function</span></span>                                                               | <span data-ttu-id="8a1fc-652">描述</span><span class="sxs-lookup"><span data-stu-id="8a1fc-652">Description</span></span>                                                                                                          |
|------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="8a1fc-653">**CertAddCTLCoNtextToStore**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-653">**CertAddCTLContextToStore**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-certaddctlcontexttostore)           | <span data-ttu-id="8a1fc-654">將 CTL 內容新增至憑證存放區。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-654">Adds a CTL context to the certificate store.</span></span>                                                                         |
| [<span data-ttu-id="8a1fc-655">**CertAddCTLLinkToStore**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-655">**CertAddCTLLinkToStore**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-certaddctllinktostore)                 | <span data-ttu-id="8a1fc-656">將存放區中的連結新增至不同存放區中的 CRL 內容。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-656">Adds a link in a store to a CRL context in a different store.</span></span>                                                        |
| [<span data-ttu-id="8a1fc-657">**CertAddEncodedCTLToStore**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-657">**CertAddEncodedCTLToStore**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-certaddencodedctltostore)           | <span data-ttu-id="8a1fc-658">將編碼的 CTL 轉換為 CTL 內容，然後將內容新增至憑證存放區。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-658">Converts the encoded CTL to a CTL context, and then adds the context to the certificate store.</span></span>                       |
| [<span data-ttu-id="8a1fc-659">**CertCreateCTLCoNtext**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-659">**CertCreateCTLContext**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-certcreatectlcontext)                   | <span data-ttu-id="8a1fc-660">從編碼的憑證信任清單建立 CTL 內容。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-660">Creates a CTL context from an encoded certificate trust list.</span></span> <span data-ttu-id="8a1fc-661">建立的內容不會放在憑證存放區中。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-661">The created context is not put in a certificate store.</span></span> |
| [<span data-ttu-id="8a1fc-662">**CertDeleteCTLFromStore**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-662">**CertDeleteCTLFromStore**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-certdeletectlfromstore)               | <span data-ttu-id="8a1fc-663">從憑證存放區刪除 CTL。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-663">Deletes a CTL from the certificate store.</span></span>                                                                            |
| [<span data-ttu-id="8a1fc-664">**CertDuplicateCTLCoNtext**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-664">**CertDuplicateCTLContext**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-certduplicatectlcontext)             | <span data-ttu-id="8a1fc-665">藉由遞增參考計數來複製 CTL 內容。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-665">Duplicates a CTL context by incrementing the reference count.</span></span>                                                        |
| [<span data-ttu-id="8a1fc-666">**CertEnumCTLsInStore**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-666">**CertEnumCTLsInStore**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-certenumctlsinstore)                     | <span data-ttu-id="8a1fc-667">列舉憑證存放區中的 CTL 內容。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-667">Enumerates the CTL contexts in the certificate store.</span></span>                                                                |
| [<span data-ttu-id="8a1fc-668">**CertFindCTLInStore**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-668">**CertFindCTLInStore**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-certfindctlinstore)                       | <span data-ttu-id="8a1fc-669">在憑證存放區中尋找符合特定準則的第一個或下一個 CTL 內容。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-669">Finds the first, or next, CTL context in the certificate store that matches a specific criteria.</span></span>                     |
| [<span data-ttu-id="8a1fc-670">**CertFreeCTLCoNtext**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-670">**CertFreeCTLContext**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-certfreectlcontext)                       | <span data-ttu-id="8a1fc-671">釋出 CTL 內容。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-671">Frees a CTL context.</span></span>                                                                                                 |
| [<span data-ttu-id="8a1fc-672">**CertModifyCertificatesToTrust**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-672">**CertModifyCertificatesToTrust**</span></span>](/windows/desktop/api/CryptDlg/nf-cryptdlg-certmodifycertificatestotrust) | <span data-ttu-id="8a1fc-673">針對特定用途修改 CTL 中的憑證集。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-673">Modifies the set of certificates in a CTL for a given purpose.</span></span>                                                       |
| [<span data-ttu-id="8a1fc-674">**CertSerializeCTLStoreElement**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-674">**CertSerializeCTLStoreElement**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-certserializectlstoreelement)   | <span data-ttu-id="8a1fc-675">將 CTL 內容的編碼 CTL 和其屬性序列化。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-675">Serializes the CTL context's encoded CTL and its properties.</span></span>                                                         |



 

### <a name="extended-property-functions"></a><span data-ttu-id="8a1fc-676">擴充屬性函式</span><span class="sxs-lookup"><span data-stu-id="8a1fc-676">Extended Property Functions</span></span>

<span data-ttu-id="8a1fc-677">下列函式適用于憑證、Crl 和 Ctl 的擴充屬性。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-677">The following functions work with extended properties of certificates, CRLs, and CTLs.</span></span>

| <span data-ttu-id="8a1fc-678">函式</span><span class="sxs-lookup"><span data-stu-id="8a1fc-678">Function</span></span>                                                                             | <span data-ttu-id="8a1fc-679">描述</span><span class="sxs-lookup"><span data-stu-id="8a1fc-679">Description</span></span>                                                      |
|--------------------------------------------------------------------------------------|------------------------------------------------------------------|
| [<span data-ttu-id="8a1fc-680">**CertEnumCertificateCoNtextProperties**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-680">**CertEnumCertificateContextProperties**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-certenumcertificatecontextproperties) | <span data-ttu-id="8a1fc-681">列舉指定之憑證內容的屬性。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-681">Enumerates the properties for the specified certificate context.</span></span> |
| [<span data-ttu-id="8a1fc-682">**CertEnumCRLCoNtextProperties**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-682">**CertEnumCRLContextProperties**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-certenumcrlcontextproperties)                 | <span data-ttu-id="8a1fc-683">列舉指定之 CRL 內容的屬性。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-683">Enumerates the properties for the specified CRL context.</span></span>         |
| [<span data-ttu-id="8a1fc-684">**CertEnumCTLCoNtextProperties**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-684">**CertEnumCTLContextProperties**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-certenumctlcontextproperties)                 | <span data-ttu-id="8a1fc-685">列舉所指定 CTL 內容的屬性。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-685">Enumerates the properties for the specified CTL context.</span></span>         |
| [<span data-ttu-id="8a1fc-686">**CertGetCertificateCoNtextProperty**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-686">**CertGetCertificateContextProperty**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-certgetcertificatecontextproperty)       | <span data-ttu-id="8a1fc-687">捕獲憑證屬性。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-687">Retrieves certificate properties.</span></span>                                |
| [<span data-ttu-id="8a1fc-688">**CertGetCRLCoNtextProperty**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-688">**CertGetCRLContextProperty**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-certgetcrlcontextproperty)                       | <span data-ttu-id="8a1fc-689">捕獲 CRL 屬性。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-689">Retrieves CRL properties.</span></span>                                        |
| [<span data-ttu-id="8a1fc-690">**CertGetCTLCoNtextProperty**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-690">**CertGetCTLContextProperty**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-certgetctlcontextproperty)                       | <span data-ttu-id="8a1fc-691">抓取 CTL 屬性。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-691">Retrieves CTL properties.</span></span>                                        |
| [<span data-ttu-id="8a1fc-692">**CertSetCertificateCoNtextProperty**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-692">**CertSetCertificateContextProperty**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-certsetcertificatecontextproperty)       | <span data-ttu-id="8a1fc-693">設定憑證屬性。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-693">Sets certificate properties.</span></span>                                     |
| [<span data-ttu-id="8a1fc-694">**CertSetCRLCoNtextProperty**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-694">**CertSetCRLContextProperty**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-certsetcrlcontextproperty)                       | <span data-ttu-id="8a1fc-695">設定 CRL 屬性。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-695">Sets CRL properties.</span></span>                                             |
| [<span data-ttu-id="8a1fc-696">**CertSetCTLCoNtextProperty**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-696">**CertSetCTLContextProperty**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-certsetctlcontextproperty)                       | <span data-ttu-id="8a1fc-697">設定 CTL 屬性。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-697">Sets CTL properties.</span></span>                                             |



 

## <a name="makecert-functions"></a><span data-ttu-id="8a1fc-698">MakeCert 函式</span><span class="sxs-lookup"><span data-stu-id="8a1fc-698">MakeCert Functions</span></span>

<span data-ttu-id="8a1fc-699">下列函數支援 [MakeCert](makecert.md) 工具。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-699">The following functions support the [MakeCert](makecert.md) tool.</span></span>



| <span data-ttu-id="8a1fc-700">函式</span><span class="sxs-lookup"><span data-stu-id="8a1fc-700">Function</span></span>                                                                               | <span data-ttu-id="8a1fc-701">描述</span><span class="sxs-lookup"><span data-stu-id="8a1fc-701">Description</span></span>                                                                                                                                                                                                                                                                                              |
|----------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="8a1fc-702">**FreeCryptProvFromCert**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-702">**FreeCryptProvFromCert**</span></span>](freecryptprovfromcert.md)                                 | <span data-ttu-id="8a1fc-703">將 [*密碼編譯服務提供者*](../secgloss/c-gly.md) 的控制碼釋放 (CSP) ，並選擇性地刪除 [**GetCryptProvFromCert**](getcryptprovfromcert.md) 函式所建立的暫存容器。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-703">Releases the handle to a [*cryptographic service provider*](../secgloss/c-gly.md) (CSP) and optionally deletes the temporary container created by the [**GetCryptProvFromCert**](getcryptprovfromcert.md) function.</span></span> |
| [<span data-ttu-id="8a1fc-704">**GetCryptProvFromCert**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-704">**GetCryptProvFromCert**</span></span>](getcryptprovfromcert.md)                                   | <span data-ttu-id="8a1fc-705">取得 CSP 的控制碼和憑證內容的金鑰規格。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-705">Gets a handle to a CSP and a key specification for a certificate context.</span></span>                                                                                                                                                                                                                                |
| [<span data-ttu-id="8a1fc-706">**PvkFreeCryptProv**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-706">**PvkFreeCryptProv**</span></span>](pvkfreecryptprov.md)                                           | <span data-ttu-id="8a1fc-707">釋放 CSP 的控制碼，並選擇性地刪除 [**PvkGetCryptProv**](pvkgetcryptprov.md) 函式所建立的暫存容器。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-707">Releases the handle to a CSP and optionally deletes the temporary container created by the [**PvkGetCryptProv**](pvkgetcryptprov.md) function.</span></span>                                                                                                                                                          |
| [<span data-ttu-id="8a1fc-708">**PvkGetCryptProv**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-708">**PvkGetCryptProv**</span></span>](pvkgetcryptprov.md)                                             | <span data-ttu-id="8a1fc-709">根據 [*私密金鑰*](../secgloss/p-gly.md) 檔案名或金鑰容器名稱，取得 CSP 的控制碼。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-709">Gets a handle to a CSP based on either a [*private key*](../secgloss/p-gly.md) file name or a key container name.</span></span>                                                                                                                                          |
| [<span data-ttu-id="8a1fc-710">**PvkPrivateKeyAcquireCoNtextFromMemory**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-710">**PvkPrivateKeyAcquireContextFromMemory**</span></span>](pvkprivatekeyacquirecontextfrommemory.md) | <span data-ttu-id="8a1fc-711">在 CSP 中建立暫存容器，並從記憶體將私密金鑰載入至容器。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-711">Creates a temporary container in the CSP and loads a private key from memory into the container.</span></span>                                                                                                                                                                                                         |
| [<span data-ttu-id="8a1fc-712">**PvkPrivateKeySave**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-712">**PvkPrivateKeySave**</span></span>](pvkprivatekeysave.md)                                         | <span data-ttu-id="8a1fc-713">將私密金鑰和其對應的 [*公開金鑰*](../secgloss/p-gly.md) 儲存至指定的檔案。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-713">Saves a private key and its corresponding [*public key*](../secgloss/p-gly.md) to a specified file.</span></span>                                                                                                                                                          |
| [<span data-ttu-id="8a1fc-714">**SignError**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-714">**SignError**</span></span>](signerror.md)                                                         | <span data-ttu-id="8a1fc-715">呼叫 [**GetLastError**](/windows/win32/api/errhandlingapi/nf-errhandlingapi-getlasterror) ，並將傳回碼轉換成 **HRESULT**。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-715">Calls [**GetLastError**](/windows/win32/api/errhandlingapi/nf-errhandlingapi-getlasterror) and converts the return code to an **HRESULT**.</span></span>                                                                                                                                                                                                              |



 

## <a name="certificate-verification-functions"></a><span data-ttu-id="8a1fc-716">憑證驗證功能</span><span class="sxs-lookup"><span data-stu-id="8a1fc-716">Certificate Verification Functions</span></span>

<span data-ttu-id="8a1fc-717">憑證會使用 [*ctl*](../secgloss/c-gly.md) 或憑證鏈進行驗證。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-717">Certificates are verified using [*CTLs*](../secgloss/c-gly.md) or certificate chains.</span></span> <span data-ttu-id="8a1fc-718">這兩個函式都有提供：</span><span class="sxs-lookup"><span data-stu-id="8a1fc-718">Functions are provided for both of these:</span></span>

-   <span data-ttu-id="8a1fc-719">使用 Ctl 的驗證函數</span><span class="sxs-lookup"><span data-stu-id="8a1fc-719">Verification Functions Using CTLs</span></span>
-   <span data-ttu-id="8a1fc-720">憑證鏈驗證功能</span><span class="sxs-lookup"><span data-stu-id="8a1fc-720">Certificate Chain Verification Functions</span></span>

### <a name="verification-functions-using-ctls"></a><span data-ttu-id="8a1fc-721">使用 Ctl 的驗證函數</span><span class="sxs-lookup"><span data-stu-id="8a1fc-721">Verification Functions Using CTLs</span></span>

<span data-ttu-id="8a1fc-722">這些函數會在驗證程式中使用 Ctl。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-722">These functions use CTLs in the verification process.</span></span> <span data-ttu-id="8a1fc-723">您可以在憑證信任清單函式和擴充屬性函式中，找到使用 Ctl 的其他函數。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-723">Additional functions for working with CTLs can be found in Certificate Trust List Functions and Extended Property Functions.</span></span>

<span data-ttu-id="8a1fc-724">下列函式會直接使用 Ctl 進行驗證。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-724">The following functions use CTLs directly for verification.</span></span>

| <span data-ttu-id="8a1fc-725">函式</span><span class="sxs-lookup"><span data-stu-id="8a1fc-725">Function</span></span>                                                         | <span data-ttu-id="8a1fc-726">描述</span><span class="sxs-lookup"><span data-stu-id="8a1fc-726">Description</span></span>                                  |
|------------------------------------------------------------------|----------------------------------------------|
| [<span data-ttu-id="8a1fc-727">**CertVerifyCTLUsage**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-727">**CertVerifyCTLUsage**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-certverifyctlusage)                 | <span data-ttu-id="8a1fc-728">驗證 CTL 的使用方式。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-728">Verifies the usage of a CTL.</span></span>                 |
| [<span data-ttu-id="8a1fc-729">**CryptMsgEncodeAndSignCTL**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-729">**CryptMsgEncodeAndSignCTL**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptmsgencodeandsignctl)     | <span data-ttu-id="8a1fc-730">將 CTL 編碼並簽署為訊息。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-730">Encodes and signs a CTL as a message.</span></span>        |
| [<span data-ttu-id="8a1fc-731">**CryptMsgGetAndVerifySigner**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-731">**CryptMsgGetAndVerifySigner**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptmsggetandverifysigner) | <span data-ttu-id="8a1fc-732">從訊息中抓取和驗證 CTL。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-732">Retrieves and verifies a CTL from a message.</span></span> |
| [<span data-ttu-id="8a1fc-733">**CryptMsgSignCTL**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-733">**CryptMsgSignCTL**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptmsgsignctl)                       | <span data-ttu-id="8a1fc-734">簽署包含 CTL 的訊息。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-734">Signs a message that contains a CTL.</span></span>         |



 

### <a name="certificate-chain-verification-functions"></a><span data-ttu-id="8a1fc-735">憑證鏈驗證功能</span><span class="sxs-lookup"><span data-stu-id="8a1fc-735">Certificate Chain Verification Functions</span></span>

<span data-ttu-id="8a1fc-736">建立憑證鏈，以提供有關個別憑證的信任資訊。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-736">Certificate chains are built to provide trust information about individual certificates.</span></span>

| <span data-ttu-id="8a1fc-737">函數名稱</span><span class="sxs-lookup"><span data-stu-id="8a1fc-737">Function Name</span></span>                                                                                                    | <span data-ttu-id="8a1fc-738">Description</span><span class="sxs-lookup"><span data-stu-id="8a1fc-738">Description</span></span>                                                                                                                                                                                                         |
|------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="8a1fc-739">**CertCreateCertificateChainEngine**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-739">**CertCreateCertificateChainEngine**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-certcreatecertificatechainengine)                                     | <span data-ttu-id="8a1fc-740">為應用程式建立新的非預設的鏈引擎。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-740">Creates a new, nondefault chain engine for an application.</span></span>                                                                                                                                                          |
| [<span data-ttu-id="8a1fc-741">**CertCreateCTLEntryFromCertificateCoNtextProperties**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-741">**CertCreateCTLEntryFromCertificateContextProperties**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-certcreatectlentryfromcertificatecontextproperties) | <span data-ttu-id="8a1fc-742">建立 CTL 專案，其屬性為憑證內容的屬性。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-742">Creates a CTL entry whose attributes are the certificate context's properties.</span></span>                                                                                                                                      |
| [<span data-ttu-id="8a1fc-743">**CertDuplicateCertificateChain**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-743">**CertDuplicateCertificateChain**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-certduplicatecertificatechain)                                           | <span data-ttu-id="8a1fc-744">藉由遞增鏈的 [*參考計數*](../secgloss/r-gly.md) ，並將指標傳回給鏈，來複製憑證鏈。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-744">Duplicates a certificate chain by incrementing the chain's [*reference count*](../secgloss/r-gly.md) and returning a pointer to the chain.</span></span>                    |
| [<span data-ttu-id="8a1fc-745">**CertFindChainInStore**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-745">**CertFindChainInStore**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-certfindchaininstore)                                                             | <span data-ttu-id="8a1fc-746">尋找存放區中的第一個或下一個憑證連結內容。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-746">Finds the first, or next, certificate chain context in a store.</span></span>                                                                                                                                                     |
| [<span data-ttu-id="8a1fc-747">**CertFreeCertificateChain**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-747">**CertFreeCertificateChain**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-certfreecertificatechain)                                                     | <span data-ttu-id="8a1fc-748">藉由減少其參考計數來釋出憑證鏈。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-748">Frees a certificate chain by reducing its reference count.</span></span>                                                                                                                                                          |
| [<span data-ttu-id="8a1fc-749">**CertFreeCertificateChainEngine**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-749">**CertFreeCertificateChainEngine**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-certfreecertificatechainengine)                                         | <span data-ttu-id="8a1fc-750">釋出非預設的憑證鏈引擎。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-750">Frees a nondefault certificate chain engine.</span></span>                                                                                                                                                                        |
| [<span data-ttu-id="8a1fc-751">**CertFreeCertificateChainList**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-751">**CertFreeCertificateChainList**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-certfreecertificatechainlist)                                             | <span data-ttu-id="8a1fc-752">釋放鏈內容指標的陣列。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-752">Frees the array of pointers to chain contexts.</span></span>                                                                                                                                                                      |
| [<span data-ttu-id="8a1fc-753">**CertGetCertificateChain**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-753">**CertGetCertificateChain**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-certgetcertificatechain)                                                       | <span data-ttu-id="8a1fc-754">在可能的情況下，從結束憑證開始並回到受信任的 [*根憑證*](../secgloss/r-gly.md)。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-754">Builds a chain context starting from an end certificate and going back to a trusted [*root certificate*](../secgloss/r-gly.md), if possible.</span></span>                |
| [<span data-ttu-id="8a1fc-755">**CertIsValidCRLForCertificate**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-755">**CertIsValidCRLForCertificate**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-certisvalidcrlforcertificate)                                             | <span data-ttu-id="8a1fc-756">檢查 [*CRL*](../secgloss/c-gly.md) 來判斷是否要在憑證被撤銷時包含特定的憑證。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-756">Checks a [*CRL*](../secgloss/c-gly.md) to determine whether it would include a specific certificate if that certificate were revoked.</span></span> |
| [<span data-ttu-id="8a1fc-757">**CertSetCertificateCoNtextPropertiesFromCTLEntry**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-757">**CertSetCertificateContextPropertiesFromCTLEntry**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-certsetcertificatecontextpropertiesfromctlentry)       | <span data-ttu-id="8a1fc-758">使用 CTL 專案中的屬性，設定憑證內容上的屬性。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-758">Sets properties on the certificate context using the attributes in the CTL entry.</span></span>                                                                                                                                   |
| [<span data-ttu-id="8a1fc-759">**CertVerifyCertificateChainPolicy**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-759">**CertVerifyCertificateChainPolicy**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-certverifycertificatechainpolicy)                                     | <span data-ttu-id="8a1fc-760">檢查憑證鏈來確認其有效性，包括其符合任何指定的有效原則準則。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-760">Checks a certificate chain to verify its validity, including its compliance with any specified validity policy criteria.</span></span>                                                                                            |



 

## <a name="message-functions"></a><span data-ttu-id="8a1fc-761">訊息函數</span><span class="sxs-lookup"><span data-stu-id="8a1fc-761">Message Functions</span></span>

<span data-ttu-id="8a1fc-762">[*CryptoAPI*](../secgloss/c-gly.md) 訊息函式包含兩個函式群組：低層級訊息函數和 [*簡化的訊息函數*](../secgloss/s-gly.md)。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-762">[*CryptoAPI*](../secgloss/c-gly.md) message functions consist of two groups of functions: low-level message functions and [*simplified message functions*](../secgloss/s-gly.md).</span></span>

<span data-ttu-id="8a1fc-763">低層級的訊息函式會直接建立並使用 PKCS \# 7 訊息。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-763">Low-level message functions create and work directly with PKCS \#7 messages.</span></span> <span data-ttu-id="8a1fc-764">這些函式會編碼 PKCS \# 7 資料，以傳輸和解碼收到的 pkcs \# 7 資料。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-764">These functions encode PKCS \#7 data for transmission and decode PKCS \#7 data received.</span></span> <span data-ttu-id="8a1fc-765">它們也會解密並驗證已接收訊息的簽章。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-765">They also decrypt and verify the signatures of received messages.</span></span> <span data-ttu-id="8a1fc-766">如需 PKCS \# 7 標準和低層級訊息的總覽，請參閱 [低層級的訊息](low-level-messages.md)。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-766">For an overview of the PKCS \#7 standard and low-level messages, see [Low-level Messages](low-level-messages.md).</span></span>

<span data-ttu-id="8a1fc-767">簡化的訊息函式在較高的層級，並將數個低層級的訊息函式和憑證函式包裝成單一函式，以特定方式執行特定工作。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-767">Simplified message functions are at a higher level and wrap several low-level message functions and certificate functions into single functions that perform a specific task in a specific manner.</span></span> <span data-ttu-id="8a1fc-768">這些函式可減少完成工作所需的函式呼叫數目，進而簡化 CryptoAPI 的使用。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-768">These functions reduce the number of function calls needed to accomplish a task, thereby simplifying CryptoAPI use.</span></span> <span data-ttu-id="8a1fc-769">如需簡化訊息的總覽，請參閱 [簡化的訊息](simplified-messages.md)。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-769">For an overview of simplified messages, see [Simplified Messages](simplified-messages.md).</span></span>

-   <span data-ttu-id="8a1fc-770">低層級訊息函數</span><span class="sxs-lookup"><span data-stu-id="8a1fc-770">Low-level Message Functions</span></span>
-   <span data-ttu-id="8a1fc-771">簡化的訊息函數</span><span class="sxs-lookup"><span data-stu-id="8a1fc-771">Simplified Message Functions</span></span>

### <a name="low-level-message-functions"></a><span data-ttu-id="8a1fc-772">低層級訊息函數</span><span class="sxs-lookup"><span data-stu-id="8a1fc-772">Low-level Message Functions</span></span>

<span data-ttu-id="8a1fc-773">低層級訊息函式提供將資料編碼以進行傳輸，以及解碼所收到的 PKCS 7 訊息所需的功能 \# 。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-773">Low-level message functions provide the functionality necessary to encode data for transmission and to decode PKCS \#7 messages received.</span></span> <span data-ttu-id="8a1fc-774">也提供功能來解密和驗證已接收訊息的簽章。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-774">Functionality is also provided to decrypt and verify the signatures of received messages.</span></span> <span data-ttu-id="8a1fc-775">不建議在大部分的應用程式中使用這些低層級的訊息函數。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-775">Use of these low-level message functions in most applications is not recommended.</span></span> <span data-ttu-id="8a1fc-776">針對大部分的應用程式，最好使用簡化的訊息函式，將數個低層級訊息函式包裝成單一函式呼叫。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-776">For most applications, the use of Simplified Message Functions, which wrap several low-level message functions into a single function call, is preferred.</span></span>

| <span data-ttu-id="8a1fc-777">函式</span><span class="sxs-lookup"><span data-stu-id="8a1fc-777">Function</span></span>                                                                                   | <span data-ttu-id="8a1fc-778">描述</span><span class="sxs-lookup"><span data-stu-id="8a1fc-778">Description</span></span>                                                                                                                                                                                                                    |
|--------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="8a1fc-779">**CryptMsgCalculateEncodedLength**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-779">**CryptMsgCalculateEncodedLength**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptmsgcalculateencodedlength)                   | <span data-ttu-id="8a1fc-780">計算編碼的密碼編譯訊息的長度。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-780">Calculates the length of an encoded cryptographic message.</span></span>                                                                                                                                                                     |
| [<span data-ttu-id="8a1fc-781">**CryptMsgClose**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-781">**CryptMsgClose**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptmsgclose)                                                     | <span data-ttu-id="8a1fc-782">關閉密碼編譯訊息的控制碼。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-782">Closes a handle of a cryptographic message.</span></span>                                                                                                                                                                                    |
| [<span data-ttu-id="8a1fc-783">**CryptMsgControl**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-783">**CryptMsgControl**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptmsgcontrol)                                                 | <span data-ttu-id="8a1fc-784">在最後 [**CryptMsgUpdate**](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptmsgupdate) 已編碼或已解碼的密碼編譯訊息之後，執行特殊的控制函數。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-784">Performs a special control function after the final [**CryptMsgUpdate**](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptmsgupdate) of an encoded or decoded cryptographic message.</span></span>                                                                                   |
| [<span data-ttu-id="8a1fc-785">**CryptMsgCountersign**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-785">**CryptMsgCountersign**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptmsgcountersign)                                         | <span data-ttu-id="8a1fc-786">來副署已存在於訊息中的簽章。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-786">Countersigns an already existing signature in a message.</span></span>                                                                                                                                                                       |
| [<span data-ttu-id="8a1fc-787">**CryptMsgCountersignEncoded**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-787">**CryptMsgCountersignEncoded**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptmsgcountersignencoded)                           | <span data-ttu-id="8a1fc-788">來副署已存在的簽章 (編碼 SignerInfo，如 PKCS \# 7) 所定義。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-788">Countersigns an already existing signature (encoded SignerInfo, as defined by PKCS \#7).</span></span>                                                                                                                                       |
| [<span data-ttu-id="8a1fc-789">**CryptMsgDuplicate**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-789">**CryptMsgDuplicate**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptmsgduplicate)                                             | <span data-ttu-id="8a1fc-790">藉由遞增 [*參考計數*](../secgloss/r-gly.md)來複製密碼編譯訊息控制碼。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-790">Duplicates a cryptographic message handle by incrementing the [*reference count*](../secgloss/r-gly.md).</span></span> <span data-ttu-id="8a1fc-791">參考計數會持續追蹤訊息的存留期。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-791">The reference count keeps track of the lifetime of the message.</span></span> |
| [<span data-ttu-id="8a1fc-792">**CryptMsgGetParam**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-792">**CryptMsgGetParam**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptmsggetparam)                                               | <span data-ttu-id="8a1fc-793">在編碼或解碼密碼編譯訊息之後取得參數。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-793">Acquires a parameter after encoding or decoding a cryptographic message.</span></span>                                                                                                                                                       |
| [<span data-ttu-id="8a1fc-794">**CryptMsgOpenToDecode**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-794">**CryptMsgOpenToDecode**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptmsgopentodecode)                                       | <span data-ttu-id="8a1fc-795">開啟解碼的密碼編譯訊息。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-795">Opens a cryptographic message for decoding.</span></span>                                                                                                                                                                                    |
| [<span data-ttu-id="8a1fc-796">**CryptMsgOpenToEncode**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-796">**CryptMsgOpenToEncode**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptmsgopentoencode)                                       | <span data-ttu-id="8a1fc-797">開啟編碼的密碼編譯訊息。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-797">Opens a cryptographic message for encoding.</span></span>                                                                                                                                                                                    |
| [<span data-ttu-id="8a1fc-798">**CryptMsgUpdate**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-798">**CryptMsgUpdate**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptmsgupdate)                                                   | <span data-ttu-id="8a1fc-799">更新密碼編譯訊息的內容。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-799">Updates the contents of a cryptographic message.</span></span>                                                                                                                                                                               |
| [<span data-ttu-id="8a1fc-800">**CryptMsgVerifyCountersignatureEncoded**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-800">**CryptMsgVerifyCountersignatureEncoded**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptmsgverifycountersignatureencoded)     | <span data-ttu-id="8a1fc-801">依據 PKCS 7) 所定義 (SignerInfo 結構來驗證 [*副署*](../secgloss/c-gly.md) \# 。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-801">Verifies a [*countersignature*](../secgloss/c-gly.md) in terms of the SignerInfo structure (as defined by PKCS \#7).</span></span>                                                   |
| [<span data-ttu-id="8a1fc-802">**CryptMsgVerifyCountersignatureEncodedEx**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-802">**CryptMsgVerifyCountersignatureEncodedEx**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptmsgverifycountersignatureencodedex) | <span data-ttu-id="8a1fc-803">確認 *pbSignerInfoCounterSignature* 參數包含 *pbSignerInfo* 參數結構之 **encryptedDigest** 欄位的加密 [*雜湊*](../secgloss/h-gly.md)。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-803">Verifies that the *pbSignerInfoCounterSignature* parameter contains the encrypted [*hash*](../secgloss/h-gly.md) of the **encryptedDigest** field of the *pbSignerInfo* parameter structure.</span></span>   |



 

### <a name="simplified-message-functions"></a><span data-ttu-id="8a1fc-804">簡化的訊息函數</span><span class="sxs-lookup"><span data-stu-id="8a1fc-804">Simplified Message Functions</span></span>

<span data-ttu-id="8a1fc-805">[*簡化的訊息*](../secgloss/s-gly.md) 函式會將低層級的訊息函式包裝成單一函式，以完成指定的工作。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-805">[*simplified message functions*](../secgloss/s-gly.md) wrap Low-level Message Functions into a single function to accomplish a specified task.</span></span>

| <span data-ttu-id="8a1fc-806">函式</span><span class="sxs-lookup"><span data-stu-id="8a1fc-806">Function</span></span>                                                                               | <span data-ttu-id="8a1fc-807">描述</span><span class="sxs-lookup"><span data-stu-id="8a1fc-807">Description</span></span>                                                                                                                                                                                                                                                                  |
|----------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="8a1fc-808">**CryptDecodeMessage**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-808">**CryptDecodeMessage**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptdecodemessage)                                       | <span data-ttu-id="8a1fc-809">解碼密碼編譯訊息。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-809">Decodes a cryptographic message.</span></span>                                                                                                                                                                                                                                             |
| [<span data-ttu-id="8a1fc-810">**CryptDecryptAndVerifyMessageSignature**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-810">**CryptDecryptAndVerifyMessageSignature**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptdecryptandverifymessagesignature) | <span data-ttu-id="8a1fc-811">解密指定的訊息，並驗證簽署人。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-811">Decrypts the specified message, and verifies the signer.</span></span>                                                                                                                                                                                                                     |
| [<span data-ttu-id="8a1fc-812">**CryptDecryptMessage**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-812">**CryptDecryptMessage**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptdecryptmessage)                                     | <span data-ttu-id="8a1fc-813">解密指定的訊息。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-813">Decrypts the specified message.</span></span>                                                                                                                                                                                                                                              |
| [<span data-ttu-id="8a1fc-814">**CryptEncryptMessage**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-814">**CryptEncryptMessage**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptencryptmessage)                                     | <span data-ttu-id="8a1fc-815">加密收件者或收件者的訊息。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-815">Encrypts the message for the recipient or recipients.</span></span>                                                                                                                                                                                                                        |
| [<span data-ttu-id="8a1fc-816">**CryptGetMessageCertificates**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-816">**CryptGetMessageCertificates**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptgetmessagecertificates)                     | <span data-ttu-id="8a1fc-817">傳回包含訊息憑證和 [*crl*](../secgloss/c-gly.md)的 [*憑證存放區*](../secgloss/c-gly.md)。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-817">Returns the [*certificate store*](../secgloss/c-gly.md) that contains the message's certificates and [*CRLs*](../secgloss/c-gly.md).</span></span> |
| [<span data-ttu-id="8a1fc-818">**CryptGetMessageSignerCount**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-818">**CryptGetMessageSignerCount**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptgetmessagesignercount)                       | <span data-ttu-id="8a1fc-819">傳回已簽署訊息中的簽署者計數。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-819">Returns the count of signers in the signed message.</span></span>                                                                                                                                                                                                                          |
| [<span data-ttu-id="8a1fc-820">**CryptHashMessage**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-820">**CryptHashMessage**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-crypthashmessage)                                           | <span data-ttu-id="8a1fc-821">建立訊息的雜湊。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-821">Creates a hash of the message.</span></span>                                                                                                                                                                                                                                               |
| [<span data-ttu-id="8a1fc-822">**CryptSignAndEncryptMessage**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-822">**CryptSignAndEncryptMessage**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptsignandencryptmessage)                       | <span data-ttu-id="8a1fc-823">簽署訊息，然後針對收件者或收件者進行加密。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-823">Signs the message, and then encrypts it for the recipient or recipients.</span></span>                                                                                                                                                                                                     |
| [<span data-ttu-id="8a1fc-824">**CryptSignMessageWithKey**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-824">**CryptSignMessageWithKey**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptsignmessagewithkey)                             | <span data-ttu-id="8a1fc-825">使用函式的參數中指定的 CSP 私密金鑰來簽署訊息。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-825">Signs a message using a CSP's private key specified in the parameters to the function.</span></span>                                                                                                                                                                                       |
| [<span data-ttu-id="8a1fc-826">**CryptSignMessage**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-826">**CryptSignMessage**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptsignmessage)                                           | <span data-ttu-id="8a1fc-827">簽署訊息。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-827">Signs the message.</span></span>                                                                                                                                                                                                                                                           |
| [<span data-ttu-id="8a1fc-828">**CryptVerifyDetachedMessageHash**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-828">**CryptVerifyDetachedMessageHash**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptverifydetachedmessagehash)               | <span data-ttu-id="8a1fc-829">驗證封裝含已卸離之雜湊的雜湊訊息。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-829">Verifies a hashed message that contains a detached hash.</span></span>                                                                                                                                                                                                                     |
| [<span data-ttu-id="8a1fc-830">**CryptVerifyDetachedMessageSignature**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-830">**CryptVerifyDetachedMessageSignature**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptverifydetachedmessagesignature)     | <span data-ttu-id="8a1fc-831">驗證封裝含已卸離之簽章或簽章的已簽署訊息。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-831">Verifies a signed message that contains a detached signature or signatures.</span></span>                                                                                                                                                                                                  |
| [<span data-ttu-id="8a1fc-832">**CryptVerifyMessageHash**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-832">**CryptVerifyMessageHash**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptverifymessagehash)                               | <span data-ttu-id="8a1fc-833">確認雜湊的訊息。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-833">Verifies a hashed message.</span></span>                                                                                                                                                                                                                                                   |
| [<span data-ttu-id="8a1fc-834">**CryptVerifyMessageSignature**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-834">**CryptVerifyMessageSignature**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptverifymessagesignature)                     | <span data-ttu-id="8a1fc-835">驗證已簽署的訊息。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-835">Verifies a signed message.</span></span>                                                                                                                                                                                                                                                   |
| [<span data-ttu-id="8a1fc-836">**CryptVerifyMessageSignatureWithKey**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-836">**CryptVerifyMessageSignatureWithKey**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptverifymessagesignaturewithkey)       | <span data-ttu-id="8a1fc-837">使用指定的公開金鑰資訊來驗證已簽署訊息的簽章。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-837">Verifies a signed message's signature by using specified public key information.</span></span>                                                                                                                                                                                             |



 

## <a name="auxiliary-functions"></a><span data-ttu-id="8a1fc-838">輔助函式</span><span class="sxs-lookup"><span data-stu-id="8a1fc-838">Auxiliary Functions</span></span>

<span data-ttu-id="8a1fc-839">協助工具的分組方式如下：</span><span class="sxs-lookup"><span data-stu-id="8a1fc-839">The auxiliary functions are grouped as follows:</span></span>

-   <span data-ttu-id="8a1fc-840">資料管理函式</span><span class="sxs-lookup"><span data-stu-id="8a1fc-840">Data Management Functions</span></span>
-   <span data-ttu-id="8a1fc-841">資料轉換函數</span><span class="sxs-lookup"><span data-stu-id="8a1fc-841">Data Conversion Functions</span></span>
-   <span data-ttu-id="8a1fc-842">增強金鑰使用方法功能</span><span class="sxs-lookup"><span data-stu-id="8a1fc-842">Enhanced Key Usage Functions</span></span>
-   <span data-ttu-id="8a1fc-843">金鑰識別碼函數</span><span class="sxs-lookup"><span data-stu-id="8a1fc-843">Key Identifier Functions</span></span>
-   <span data-ttu-id="8a1fc-844">OID 支援函式</span><span class="sxs-lookup"><span data-stu-id="8a1fc-844">OID Support Functions</span></span>
-   <span data-ttu-id="8a1fc-845">遠端物件抓取函式</span><span class="sxs-lookup"><span data-stu-id="8a1fc-845">Remote Object Retrieval Functions</span></span>
-   <span data-ttu-id="8a1fc-846">PFX 函數</span><span class="sxs-lookup"><span data-stu-id="8a1fc-846">PFX Functions</span></span>

### <a name="data-management-functions"></a><span data-ttu-id="8a1fc-847">資料管理函式</span><span class="sxs-lookup"><span data-stu-id="8a1fc-847">Data Management Functions</span></span>

<span data-ttu-id="8a1fc-848">下列 CryptoAPI 函數會管理資料和憑證。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-848">The following CryptoAPI functions manage data and certificates.</span></span>

<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th><span data-ttu-id="8a1fc-849">函式</span><span class="sxs-lookup"><span data-stu-id="8a1fc-849">Function</span></span></th>
<th><span data-ttu-id="8a1fc-850">描述</span><span class="sxs-lookup"><span data-stu-id="8a1fc-850">Description</span></span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span data-ttu-id="8a1fc-851"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certcomparecertificate"><strong>CertCompareCertificate</strong></a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-851"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certcomparecertificate"><strong>CertCompareCertificate</strong></a></span></span></td>
<td><span data-ttu-id="8a1fc-852">比較兩個憑證，以判斷它們是否相同。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-852">Compares two certificates to determine whether they are identical.</span></span></td>
</tr>
<tr class="even">
<td><span data-ttu-id="8a1fc-853"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certcomparecertificatename"><strong>CertCompareCertificateName</strong></a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-853"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certcomparecertificatename"><strong>CertCompareCertificateName</strong></a></span></span></td>
<td><span data-ttu-id="8a1fc-854">比較兩個憑證名稱，以判斷它們是否相同。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-854">Compares two certificate names to determine whether they are identical.</span></span></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="8a1fc-855"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certcompareintegerblob"><strong>CertCompareIntegerBlob</strong></a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-855"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certcompareintegerblob"><strong>CertCompareIntegerBlob</strong></a></span></span></td>
<td><span data-ttu-id="8a1fc-856">比較兩個整數 <a href="/windows/desktop/SecGloss/b-gly"><em>blob</em></a>。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-856">Compares two integer <a href="/windows/desktop/SecGloss/b-gly"><em>BLOBs</em></a>.</span></span></td>
</tr>
<tr class="even">
<td><span data-ttu-id="8a1fc-857"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certcomparepublickeyinfo"><strong>CertComparePublicKeyInfo</strong></a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-857"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certcomparepublickeyinfo"><strong>CertComparePublicKeyInfo</strong></a></span></span></td>
<td><span data-ttu-id="8a1fc-858">比較兩個 <a href="/windows/desktop/SecGloss/p-gly"><em>公開金鑰</em></a> ，判斷它們是否相同。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-858">Compares two <a href="/windows/desktop/SecGloss/p-gly"><em>public keys</em></a> to determine whether they are identical.</span></span></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="8a1fc-859"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certfindattribute"><strong>CertFindAttribute</strong></a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-859"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certfindattribute"><strong>CertFindAttribute</strong></a></span></span></td>
<td><span data-ttu-id="8a1fc-860">尋找 (OID) 的 <a href="/windows/desktop/SecGloss/o-gly"><em>物件識別碼</em></a> 所識別的第一個屬性。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-860">Finds the first attribute identified by its <a href="/windows/desktop/SecGloss/o-gly"><em>object identifier</em></a> (OID).</span></span></td>
</tr>
<tr class="even">
<td><span data-ttu-id="8a1fc-861"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certfindextension"><strong>CertFindExtension</strong></a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-861"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certfindextension"><strong>CertFindExtension</strong></a></span></span></td>
<td><span data-ttu-id="8a1fc-862">尋找其 OID 所識別的第一個延伸模組。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-862">Finds the first extension identified by its OID.</span></span></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="8a1fc-863"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certfindrdnattr"><strong>CertFindRDNAttr</strong></a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-863"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certfindrdnattr"><strong>CertFindRDNAttr</strong></a></span></span></td>
<td><span data-ttu-id="8a1fc-864">在<em>相對分辨名稱</em>的名稱清單中尋找其 OID 所識別的第一個<a href="/windows/desktop/SecGloss/r-gly"><em>RDN</em></a>屬性。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-864">Finds the first <a href="/windows/desktop/SecGloss/r-gly"><em>RDN</em></a> attribute identified by its OID in the name list of the <em>Relative Distinguished Names</em>.</span></span></td>
</tr>
<tr class="even">
<td><span data-ttu-id="8a1fc-865"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certgetintendedkeyusage"><strong>CertGetIntendedKeyUsage</strong></a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-865"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certgetintendedkeyusage"><strong>CertGetIntendedKeyUsage</strong></a></span></span></td>
<td><span data-ttu-id="8a1fc-866">從憑證取得預定的金鑰使用方式位元組。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-866">Acquires the intended key usage bytes from the certificate.</span></span></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="8a1fc-867"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certgetpublickeylength"><strong>CertGetPublicKeyLength</strong></a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-867"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certgetpublickeylength"><strong>CertGetPublicKeyLength</strong></a></span></span></td>
<td><span data-ttu-id="8a1fc-868">從 <a href="/windows/desktop/SecGloss/p-gly"><em>公開金鑰 BLOB</em></a>取得公開/私用金鑰的位長度。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-868">Acquires the public/private key's bit length from the <a href="/windows/desktop/SecGloss/p-gly"><em>public key BLOB</em></a>.</span></span></td>
</tr>
<tr class="even">
<td><span data-ttu-id="8a1fc-869"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certisrdnattrsincertificatename"><strong>CertIsRDNAttrsInCertificateName</strong></a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-869"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certisrdnattrsincertificatename"><strong>CertIsRDNAttrsInCertificateName</strong></a></span></span></td>
<td><span data-ttu-id="8a1fc-870">將 <a href="/windows/desktop/SecGloss/c-gly"><em>憑證名稱</em></a> 中的屬性與指定的 <a href="/windows/desktop/api/Wincrypt/ns-wincrypt-cert_rdn"><strong>CERT_RDN</strong></a> 進行比較，以判斷是否在其中包含所有屬性。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-870">Compares the attributes in the <a href="/windows/desktop/SecGloss/c-gly"><em>certificate name</em></a> with the specified <a href="/windows/desktop/api/Wincrypt/ns-wincrypt-cert_rdn"><strong>CERT_RDN</strong></a> to determine whether all attributes are included there.</span></span></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="8a1fc-871"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certisstronghashtosign"><strong>CertIsStrongHashToSign</strong></a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-871"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certisstronghashtosign"><strong>CertIsStrongHashToSign</strong></a></span></span></td>
<td><span data-ttu-id="8a1fc-872">判斷指定的雜湊演算法和簽署憑證中的公開金鑰是否可以用來執行強式簽署。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-872">Determines whether the specified hash algorithm and the public key in the signing certificate can be used to perform strong signing.</span></span></td>
</tr>
<tr class="even">
<td><span data-ttu-id="8a1fc-873"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certverifycrlrevocation"><strong>CertVerifyCRLRevocation</strong></a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-873"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certverifycrlrevocation"><strong>CertVerifyCRLRevocation</strong></a></span></span></td>
<td><span data-ttu-id="8a1fc-874">確認主體憑證不在 (CRL) 的 <a href="/windows/desktop/SecGloss/c-gly"><em>憑證撤銷清單</em></a> 中。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-874">Verifies that the subject certificate is not on the <a href="/windows/desktop/SecGloss/c-gly"><em>certificate revocation list</em></a> (CRL).</span></span></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="8a1fc-875"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certverifycrltimevalidity"><strong>CertVerifyCRLTimeValidity</strong></a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-875"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certverifycrltimevalidity"><strong>CertVerifyCRLTimeValidity</strong></a></span></span></td>
<td><span data-ttu-id="8a1fc-876">確認 CRL 的時間有效性。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-876">Verifies the time validity of a CRL.</span></span></td>
</tr>
<tr class="even">
<td><span data-ttu-id="8a1fc-877"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certverifyrevocation"><strong>CertVerifyRevocation</strong></a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-877"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certverifyrevocation"><strong>CertVerifyRevocation</strong></a></span></span></td>
<td><span data-ttu-id="8a1fc-878">確認主體憑證不在 CRL 上。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-878">Verifies that the subject certificate is not on the CRL.</span></span></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="8a1fc-879"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certverifytimevalidity"><strong>CertVerifyTimeValidity</strong></a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-879"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certverifytimevalidity"><strong>CertVerifyTimeValidity</strong></a></span></span></td>
<td><span data-ttu-id="8a1fc-880">確認憑證的時間有效性。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-880">Verifies the time validity of a certificate.</span></span></td>
</tr>
<tr class="even">
<td><span data-ttu-id="8a1fc-881"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certverifyvaliditynesting"><strong>CertVerifyValidityNesting</strong></a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-881"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-certverifyvaliditynesting"><strong>CertVerifyValidityNesting</strong></a></span></span></td>
<td><span data-ttu-id="8a1fc-882">確認主體的時間有效性會嵌套在簽發者的時間有效性內。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-882">Verifies that the subject's time validity nests within the issuer's time validity.</span></span></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="8a1fc-883"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptexportpkcs8"><strong>CryptExportPKCS8</strong></a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-883"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptexportpkcs8"><strong>CryptExportPKCS8</strong></a></span></span></td>
<td><span data-ttu-id="8a1fc-884"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptexportpkcs8ex"><strong>CryptExportPKCS8Ex</strong></a>函式會取代此函數。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-884">This function is superseded by the <a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptexportpkcs8ex"><strong>CryptExportPKCS8Ex</strong></a> function.</span></span></td>
</tr>
<tr class="even">
<td><span data-ttu-id="8a1fc-885"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptexportpkcs8ex"><strong>CryptExportPKCS8Ex</strong></a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-885"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptexportpkcs8ex"><strong>CryptExportPKCS8Ex</strong></a></span></span></td>
<td><span data-ttu-id="8a1fc-886">以 PKCS #8 格式匯出私密金鑰。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-886">Exports the private key in PKCS #8 format.</span></span></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="8a1fc-887"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptexportpublickeyinfo"><strong>CryptExportPublicKeyInfo</strong></a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-887"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptexportpublickeyinfo"><strong>CryptExportPublicKeyInfo</strong></a></span></span></td>
<td><span data-ttu-id="8a1fc-888">匯出與提供者對應之私密金鑰相關聯的公開金鑰資訊。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-888">Exports the public key information associated with the provider's corresponding private key.</span></span></td>
</tr>
<tr class="even">
<td><span data-ttu-id="8a1fc-889"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptexportpublickeyinfoex"><strong>CryptExportPublicKeyInfoEx</strong></a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-889"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptexportpublickeyinfoex"><strong>CryptExportPublicKeyInfoEx</strong></a></span></span></td>
<td><span data-ttu-id="8a1fc-890">匯出與提供者對應之私密金鑰相關聯的公開金鑰資訊。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-890">Exports the public key information associated with the provider's corresponding private key.</span></span> <span data-ttu-id="8a1fc-891">此函式與 <a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptexportpublickeyinfo"><strong>CryptExportPublicKeyInfo</strong></a> 不同之處在于，使用者可以指定公開金鑰演算法，進而覆寫 CSP 所提供的預設值。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-891">This function differs from <a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptexportpublickeyinfo"><strong>CryptExportPublicKeyInfo</strong></a> in that the user can specify the public key algorithm, thereby overriding the default provided by the CSP.</span></span></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="8a1fc-892"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptexportpublickeyinfofrombcryptkeyhandle"><strong>CryptExportPublicKeyInfoFromBCryptKeyHandle</strong></a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-892"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptexportpublickeyinfofrombcryptkeyhandle"><strong>CryptExportPublicKeyInfoFromBCryptKeyHandle</strong></a></span></span></td>
<td><span data-ttu-id="8a1fc-893">匯出與提供者對應之私密金鑰相關聯的公開金鑰資訊。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-893">Exports the public key info associated with a provider's corresponding private key.</span></span></td>
</tr>
<tr class="even">
<td><span data-ttu-id="8a1fc-894"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptfindcertificatekeyprovinfo"><strong>CryptFindCertificateKeyProvInfo</strong></a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-894"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptfindcertificatekeyprovinfo"><strong>CryptFindCertificateKeyProvInfo</strong></a></span></span></td>
<td><span data-ttu-id="8a1fc-895">列舉密碼編譯提供者及其 <a href="/windows/desktop/SecGloss/k-gly"><em>金鑰容器</em></a> ，以尋找與憑證公開金鑰對應的私密金鑰。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-895">Enumerates the cryptographic providers and their <a href="/windows/desktop/SecGloss/k-gly"><em>key containers</em></a> to find the private key that corresponds to a certificate's public key.</span></span></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="8a1fc-896"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptfindlocalizedname"><strong>CryptFindLocalizedName</strong></a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-896"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptfindlocalizedname"><strong>CryptFindLocalizedName</strong></a></span></span></td>
<td><span data-ttu-id="8a1fc-897">尋找指定名稱的當地語系化名稱，例如，尋找根系統存放區名稱的當地語系化名稱。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-897">Finds the localized name for a specified name, for example, finds the localized name for the store name of the Root system.</span></span></td>
</tr>
<tr class="even">
<td><span data-ttu-id="8a1fc-898"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-crypthashcertificate"><strong>CryptHashCertificate</strong></a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-898"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-crypthashcertificate"><strong>CryptHashCertificate</strong></a></span></span></td>
<td><blockquote>
[!Important]<br />
<span data-ttu-id="8a1fc-899">此 API 即將淘汰。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-899">This API is deprecated.</span></span> <span data-ttu-id="8a1fc-900">新的和現有的軟體應該開始使用 <a href="/windows/desktop/SecCNG/cng-portal">新一代密碼編譯 api。</a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-900">New and existing software should start using <a href="/windows/desktop/SecCNG/cng-portal">Cryptography Next Generation APIs.</a></span></span> <span data-ttu-id="8a1fc-901">Microsoft 可能會在未來的版本中移除此 API。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-901">Microsoft may remove this API in future releases.</span></span>
</blockquote>
<br/> <span data-ttu-id="8a1fc-902">雜湊編碼的內容。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-902">Hashes the encoded content.</span></span></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="8a1fc-903"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-crypthashcertificate2"><strong>CryptHashCertificate2</strong></a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-903"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-crypthashcertificate2"><strong>CryptHashCertificate2</strong></a></span></span></td>
<td><span data-ttu-id="8a1fc-904">使用密碼編譯 API：新一代 (CNG) 雜湊提供者來雜湊資料區塊。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-904">Hashes a block of data by using a Cryptography API: Next Generation (CNG) hash provider.</span></span></td>
</tr>
<tr class="even">
<td><span data-ttu-id="8a1fc-905"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-crypthashpublickeyinfo"><strong>CryptHashPublicKeyInfo</strong></a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-905"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-crypthashpublickeyinfo"><strong>CryptHashPublicKeyInfo</strong></a></span></span></td>
<td><blockquote>
[!Important]<br />
<span data-ttu-id="8a1fc-906">此 API 即將淘汰。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-906">This API is deprecated.</span></span> <span data-ttu-id="8a1fc-907">新的和現有的軟體應該開始使用 <a href="/windows/desktop/SecCNG/cng-portal">新一代密碼編譯 api。</a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-907">New and existing software should start using <a href="/windows/desktop/SecCNG/cng-portal">Cryptography Next Generation APIs.</a></span></span> <span data-ttu-id="8a1fc-908">Microsoft 可能會在未來的版本中移除此 API。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-908">Microsoft may remove this API in future releases.</span></span>
</blockquote>
<br/> <span data-ttu-id="8a1fc-909">計算已編碼公開金鑰資訊的雜湊。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-909">Computes the hash of the encoded public key information.</span></span></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="8a1fc-910"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-crypthashtobesigned"><strong>CryptHashToBeSigned</strong></a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-910"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-crypthashtobesigned"><strong>CryptHashToBeSigned</strong></a></span></span></td>
<td><blockquote>
[!Important]<br />
<span data-ttu-id="8a1fc-911">此 API 即將淘汰。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-911">This API is deprecated.</span></span> <span data-ttu-id="8a1fc-912">新的和現有的軟體應該開始使用 <a href="/windows/desktop/SecCNG/cng-portal">新一代密碼編譯 api。</a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-912">New and existing software should start using <a href="/windows/desktop/SecCNG/cng-portal">Cryptography Next Generation APIs.</a></span></span> <span data-ttu-id="8a1fc-913">Microsoft 可能會在未來的版本中移除此 API。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-913">Microsoft may remove this API in future releases.</span></span>
</blockquote>
<br/> <span data-ttu-id="8a1fc-914">將的雜湊計算 &quot; 為編碼的 &quot; 已簽署內容 (<a href="/windows/desktop/api/Wincrypt/ns-wincrypt-cert_signed_content_info"><strong>CERT_SIGNED_CONTENT_INFO</strong></a>) 中簽署的資訊。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-914">Computes the hash of the &quot;to be signed&quot; information in the encoded signed content (<a href="/windows/desktop/api/Wincrypt/ns-wincrypt-cert_signed_content_info"><strong>CERT_SIGNED_CONTENT_INFO</strong></a>).</span></span></td>
</tr>
<tr class="even">
<td><span data-ttu-id="8a1fc-915"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptimportpkcs8"><strong>CryptImportPKCS8</strong></a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-915"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptimportpkcs8"><strong>CryptImportPKCS8</strong></a></span></span></td>
<td><blockquote>
[!Important]<br />
<span data-ttu-id="8a1fc-916">此 API 即將淘汰。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-916">This API is deprecated.</span></span> <span data-ttu-id="8a1fc-917">新的和現有的軟體應該開始使用 <a href="/windows/desktop/SecCNG/cng-portal">新一代密碼編譯 api。</a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-917">New and existing software should start using <a href="/windows/desktop/SecCNG/cng-portal">Cryptography Next Generation APIs.</a></span></span> <span data-ttu-id="8a1fc-918">Microsoft 可能會在未來的版本中移除此 API。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-918">Microsoft may remove this API in future releases.</span></span>
</blockquote>
<br/> <span data-ttu-id="8a1fc-919">將 PKCS #8 格式的 <a href="/windows/desktop/SecGloss/p-gly"><em>私密金鑰</em></a> 匯入至 <a href="/windows/desktop/SecGloss/c-gly"><em>密碼編譯服務提供者</em></a> (CSP) 。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-919">Imports the <a href="/windows/desktop/SecGloss/p-gly"><em>private key</em></a> in PKCS #8 format to a <a href="/windows/desktop/SecGloss/c-gly"><em>cryptographic service provider</em></a> (CSP).</span></span></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="8a1fc-920"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptimportpublickeyinfo"><strong>CryptImportPublicKeyInfo</strong></a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-920"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptimportpublickeyinfo"><strong>CryptImportPublicKeyInfo</strong></a></span></span></td>
<td><blockquote>
[!Important]<br />
<span data-ttu-id="8a1fc-921">此 API 即將淘汰。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-921">This API is deprecated.</span></span> <span data-ttu-id="8a1fc-922">新的和現有的軟體應該開始使用 <a href="/windows/desktop/SecCNG/cng-portal">新一代密碼編譯 api。</a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-922">New and existing software should start using <a href="/windows/desktop/SecCNG/cng-portal">Cryptography Next Generation APIs.</a></span></span> <span data-ttu-id="8a1fc-923">Microsoft 可能會在未來的版本中移除此 API。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-923">Microsoft may remove this API in future releases.</span></span>
</blockquote>
<br/> <span data-ttu-id="8a1fc-924">將公開金鑰資訊轉換並匯入提供者，並傳回公開金鑰的控制碼。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-924">Converts and imports public key information into the provider, and returns a handle of the public key.</span></span></td>
</tr>
<tr class="even">
<td><span data-ttu-id="8a1fc-925"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptimportpublickeyinfoex"><strong>CryptImportPublicKeyInfoEx</strong></a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-925"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptimportpublickeyinfoex"><strong>CryptImportPublicKeyInfoEx</strong></a></span></span></td>
<td><blockquote>
[!Important]<br />
<span data-ttu-id="8a1fc-926">此 API 即將淘汰。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-926">This API is deprecated.</span></span> <span data-ttu-id="8a1fc-927">新的和現有的軟體應該開始使用 <a href="/windows/desktop/SecCNG/cng-portal">新一代密碼編譯 api。</a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-927">New and existing software should start using <a href="/windows/desktop/SecCNG/cng-portal">Cryptography Next Generation APIs.</a></span></span> <span data-ttu-id="8a1fc-928">Microsoft 可能會在未來的版本中移除此 API。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-928">Microsoft may remove this API in future releases.</span></span>
</blockquote>
<br/> <span data-ttu-id="8a1fc-929">將公開金鑰資訊轉換並匯入提供者，並傳回公開金鑰的控制碼。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-929">Converts and imports the public key information into the provider, and returns a handle of the public key.</span></span> <span data-ttu-id="8a1fc-930">您可以使用 <a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptimportpublickeyinfo"><strong>CryptImportPublicKeyInfo</strong></a>) 所指定的其他參數 (，這些參數可用來覆寫預設值，以提供補充 <a href="/windows/desktop/api/Wincrypt/ns-wincrypt-cert_public_key_info"><strong>CERT_PUBLIC_KEY_INFO</strong></a>。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-930">Additional parameters (over those specified by <a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptimportpublickeyinfo"><strong>CryptImportPublicKeyInfo</strong></a>) that can be used to override defaults are provided to supplement <a href="/windows/desktop/api/Wincrypt/ns-wincrypt-cert_public_key_info"><strong>CERT_PUBLIC_KEY_INFO</strong></a>.</span></span></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="8a1fc-931"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptimportpublickeyinfoex2"><strong>CryptImportPublicKeyInfoEx2</strong></a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-931"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptimportpublickeyinfoex2"><strong>CryptImportPublicKeyInfoEx2</strong></a></span></span></td>
<td><span data-ttu-id="8a1fc-932">將公開金鑰匯入至 CNG 非對稱提供者。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-932">Imports a public key into a CNG asymmetric provider.</span></span></td>
</tr>
<tr class="even">
<td><span data-ttu-id="8a1fc-933"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptmemalloc"><strong>CryptMemAlloc</strong></a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-933"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptmemalloc"><strong>CryptMemAlloc</strong></a></span></span></td>
<td><span data-ttu-id="8a1fc-934">配置緩衝區的記憶體。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-934">Allocates memory for a buffer.</span></span> <span data-ttu-id="8a1fc-935">所有傳回已配置緩衝區的 Crypt32.dll .lib 函數都會使用此記憶體。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-935">This memory is used by all Crypt32.lib functions that return allocated buffers.</span></span></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="8a1fc-936"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptmemfree"><strong>CryptMemFree</strong></a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-936"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptmemfree"><strong>CryptMemFree</strong></a></span></span></td>
<td><span data-ttu-id="8a1fc-937">釋放 <a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptmemalloc"><strong>CryptMemAlloc</strong></a> 或 <a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptmemrealloc"><strong>CryptMemRealloc</strong></a>所配置的記憶體。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-937">Frees memory allocated by <a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptmemalloc"><strong>CryptMemAlloc</strong></a> or <a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptmemrealloc"><strong>CryptMemRealloc</strong></a>.</span></span></td>
</tr>
<tr class="even">
<td><span data-ttu-id="8a1fc-938"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptmemrealloc"><strong>CryptMemRealloc</strong></a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-938"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptmemrealloc"><strong>CryptMemRealloc</strong></a></span></span></td>
<td><span data-ttu-id="8a1fc-939">釋出目前為緩衝區配置的記憶體，並為新的緩衝區配置記憶體。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-939">Frees memory currently allocated for a buffer, and allocates memory for a new buffer.</span></span></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="8a1fc-940"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptqueryobject"><strong>CryptQueryObject</strong></a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-940"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptqueryobject"><strong>CryptQueryObject</strong></a></span></span></td>
<td><blockquote>
[!Important]<br />
<span data-ttu-id="8a1fc-941">此 API 即將淘汰。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-941">This API is deprecated.</span></span> <span data-ttu-id="8a1fc-942">新的和現有的軟體應該開始使用 <a href="/windows/desktop/SecCNG/cng-portal">新一代密碼編譯 api。</a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-942">New and existing software should start using <a href="/windows/desktop/SecCNG/cng-portal">Cryptography Next Generation APIs.</a></span></span> <span data-ttu-id="8a1fc-943">Microsoft 可能會在未來的版本中移除此 API。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-943">Microsoft may remove this API in future releases.</span></span>
</blockquote>
<br/> <span data-ttu-id="8a1fc-944">捕獲 BLOB 或檔案內容的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-944">Retrieves information about the content of a BLOB or a file.</span></span></td>
</tr>
<tr class="even">
<td><span data-ttu-id="8a1fc-945"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptsignandencodecertificate"><strong>CryptSignAndEncodeCertificate</strong></a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-945"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptsignandencodecertificate"><strong>CryptSignAndEncodeCertificate</strong></a></span></span></td>
<td><span data-ttu-id="8a1fc-946">將編碼 &quot; 為簽署的資訊 &quot; 、簽署此編碼的資訊，然後將產生的帶正負號編碼資訊編碼。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-946">Encodes the &quot;to be signed&quot; information, signs this encoded information, and encodes the resulting signed, encoded information.</span></span></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="8a1fc-947"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptsigncertificate"><strong>CryptSignCertificate</strong></a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-947"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptsigncertificate"><strong>CryptSignCertificate</strong></a></span></span></td>
<td><span data-ttu-id="8a1fc-948">將簽署的 &quot; 資訊簽 &quot; 入已編碼、簽署的內容中。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-948">Signs the &quot;to be signed&quot; information in the encoded, signed content.</span></span></td>
</tr>
<tr class="even">
<td><span data-ttu-id="8a1fc-949"><a href="/windows/desktop/api/Mssip/nf-mssip-cryptsipaddprovider"><strong>CryptSIPAddProvider</strong></a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-949"><a href="/windows/desktop/api/Mssip/nf-mssip-cryptsipaddprovider"><strong>CryptSIPAddProvider</strong></a></span></span></td>
<td><span data-ttu-id="8a1fc-950">將主體介面套件新增 (SIP) 。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-950">Adds a Subject Interface Package (SIP).</span></span></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="8a1fc-951"><a href="/windows/desktop/api/Mssip/nf-mssip-cryptsipcreateindirectdata"><strong>CryptSIPCreateIndirectData</strong></a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-951"><a href="/windows/desktop/api/Mssip/nf-mssip-cryptsipcreateindirectdata"><strong>CryptSIPCreateIndirectData</strong></a></span></span></td>
<td><span data-ttu-id="8a1fc-952">傳回<a href="/windows/win32/api/mssip/ns-mssip-sip_indirect_data"><strong>SIP_INDIRECT_DATA</strong></a>結構，其中包含提供的<a href="/windows/win32/api/mssip/ns-mssip-sip_subjectinfo"><strong>SIP_SUBJECTINFO</strong></a>結構、摘要演算法和編碼屬性的<a href="/windows/desktop/SecGloss/h-gly"><em>雜湊</em></a>。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-952">Returns a <a href="/windows/win32/api/mssip/ns-mssip-sip_indirect_data"><strong>SIP_INDIRECT_DATA</strong></a> structure that contains a <a href="/windows/desktop/SecGloss/h-gly"><em>hash</em></a> of the supplied <a href="/windows/win32/api/mssip/ns-mssip-sip_subjectinfo"><strong>SIP_SUBJECTINFO</strong></a> structure, the digest algorithm, and an encoding attribute.</span></span> <span data-ttu-id="8a1fc-953">雜湊可以當做資料的間接參考使用。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-953">The hash can be used as an indirect reference to the data.</span></span></td>
</tr>
<tr class="even">
<td><span data-ttu-id="8a1fc-954"><a href="/windows/desktop/api/Mssip/nf-mssip-cryptsipgetcaps"><strong>CryptSIPGetCaps</strong></a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-954"><a href="/windows/desktop/api/Mssip/nf-mssip-cryptsipgetcaps"><strong>CryptSIPGetCaps</strong></a></span></span></td>
<td><span data-ttu-id="8a1fc-955">捕獲 SIP 的功能。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-955">Retrieves the capabilities of an SIP.</span></span></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="8a1fc-956"><a href="/windows/desktop/api/Mssip/nf-mssip-cryptsipgetsigneddatamsg"><strong>CryptSIPGetSignedDataMsg</strong></a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-956"><a href="/windows/desktop/api/Mssip/nf-mssip-cryptsipgetsigneddatamsg"><strong>CryptSIPGetSignedDataMsg</strong></a></span></span></td>
<td><span data-ttu-id="8a1fc-957">從檔案抓取 Authenticode 簽章。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-957">Retrieves an Authenticode signature from the file.</span></span></td>
</tr>
<tr class="even">
<td><span data-ttu-id="8a1fc-958"><a href="/windows/desktop/api/Mssip/nf-mssip-cryptsipload"><strong>CryptSIPLoad</strong></a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-958"><a href="/windows/desktop/api/Mssip/nf-mssip-cryptsipload"><strong>CryptSIPLoad</strong></a></span></span></td>
<td><span data-ttu-id="8a1fc-959">載入動態連結程式庫，此程式庫會執行主體介面套件，並將適當的程式庫匯出函數指派給 <a href="/windows/win32/api/mssip/ns-mssip-sip_dispatch_info"><strong>SIP_DISPATCH_INFO</strong></a> 結構。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-959">Loads the dynamic link library that implements a subject interface package and assigns appropriate library export functions to a <a href="/windows/win32/api/mssip/ns-mssip-sip_dispatch_info"><strong>SIP_DISPATCH_INFO</strong></a> structure.</span></span></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="8a1fc-960"><a href="/windows/desktop/api/Mssip/nf-mssip-cryptsipputsigneddatamsg"><strong>CryptSIPPutSignedDataMsg</strong></a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-960"><a href="/windows/desktop/api/Mssip/nf-mssip-cryptsipputsigneddatamsg"><strong>CryptSIPPutSignedDataMsg</strong></a></span></span></td>
<td><span data-ttu-id="8a1fc-961">將 Authenticode 簽章儲存在目標檔案中。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-961">Stores an Authenticode Signature in the target file.</span></span></td>
</tr>
<tr class="even">
<td><span data-ttu-id="8a1fc-962"><a href="/windows/desktop/api/Mssip/nf-mssip-cryptsipremoveprovider"><strong>CryptSIPRemoveProvider</strong></a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-962"><a href="/windows/desktop/api/Mssip/nf-mssip-cryptsipremoveprovider"><strong>CryptSIPRemoveProvider</strong></a></span></span></td>
<td><span data-ttu-id="8a1fc-963">移除先前對 <a href="/windows/desktop/api/Mssip/nf-mssip-cryptsipaddprovider"><strong>CryptSIPAddProvider</strong></a> 函式的呼叫所加入的 SIP。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-963">Removes a SIP added by a previous call to the <a href="/windows/desktop/api/Mssip/nf-mssip-cryptsipaddprovider"><strong>CryptSIPAddProvider</strong></a> function.</span></span></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="8a1fc-964"><a href="/windows/desktop/api/Mssip/nf-mssip-cryptsipremovesigneddatamsg"><strong>CryptSIPRemoveSignedDataMsg</strong></a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-964"><a href="/windows/desktop/api/Mssip/nf-mssip-cryptsipremovesigneddatamsg"><strong>CryptSIPRemoveSignedDataMsg</strong></a></span></span></td>
<td><span data-ttu-id="8a1fc-965">移除指定的 Authenticode 簽章。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-965">Removes a specified Authenticode signature.</span></span></td>
</tr>
<tr class="even">
<td><span data-ttu-id="8a1fc-966"><a href="/windows/desktop/api/Mssip/nf-mssip-cryptsipretrievesubjectguid"><strong>CryptSIPRetrieveSubjectGuid</strong></a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-966"><a href="/windows/desktop/api/Mssip/nf-mssip-cryptsipretrievesubjectguid"><strong>CryptSIPRetrieveSubjectGuid</strong></a></span></span></td>
<td><span data-ttu-id="8a1fc-967">根據指定檔案中的標頭資訊來抓取 GUID。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-967">Retrieves a GUID based on the header information in a specified file.</span></span></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="8a1fc-968"><a href="/windows/desktop/api/Mssip/nf-mssip-cryptsipretrievesubjectguidforcatalogfile"><strong>CryptSIPRetrieveSubjectGuidForCatalogFile</strong></a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-968"><a href="/windows/desktop/api/Mssip/nf-mssip-cryptsipretrievesubjectguidforcatalogfile"><strong>CryptSIPRetrieveSubjectGuidForCatalogFile</strong></a></span></span></td>
<td><span data-ttu-id="8a1fc-969">抓取與指定檔案相關聯的主體 GUID。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-969">Retrieves the subject GUID associated with the specified file.</span></span></td>
</tr>
<tr class="even">
<td><span data-ttu-id="8a1fc-970"><a href="/windows/desktop/api/Mssip/nf-mssip-cryptsipverifyindirectdata"><strong>CryptSIPVerifyIndirectData</strong></a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-970"><a href="/windows/desktop/api/Mssip/nf-mssip-cryptsipverifyindirectdata"><strong>CryptSIPVerifyIndirectData</strong></a></span></span></td>
<td><span data-ttu-id="8a1fc-971">針對提供的主體驗證間接雜湊資料。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-971">Validates the indirect hashed data against the supplied subject.</span></span></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="8a1fc-972"><a href="/windows/desktop/api/Dpapi/nf-dpapi-cryptupdateprotectedstate"><strong>CryptUpdateProtectedState</strong></a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-972"><a href="/windows/desktop/api/Dpapi/nf-dpapi-cryptupdateprotectedstate"><strong>CryptUpdateProtectedState</strong></a></span></span></td>
<td><span data-ttu-id="8a1fc-973">在使用者的 <a href="/windows/desktop/SecGloss/s-gly"><em>安全識別碼</em></a> (SID) 變更之後，遷移目前使用者的主要金鑰。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-973">Migrates the current user's master keys after the user's <a href="/windows/desktop/SecGloss/s-gly"><em>security identifier</em></a> (SID) has changed.</span></span></td>
</tr>
<tr class="even">
<td><span data-ttu-id="8a1fc-974"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptverifycertificatesignature"><strong>CryptVerifyCertificateSignature</strong></a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-974"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptverifycertificatesignature"><strong>CryptVerifyCertificateSignature</strong></a></span></span></td>
<td><span data-ttu-id="8a1fc-975">使用公開金鑰資訊來驗證主體憑證或 <a href="/windows/desktop/SecGloss/c-gly"><em>CRL</em></a> 的簽章。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-975">Verifies the signature of a subject certificate or a <a href="/windows/desktop/SecGloss/c-gly"><em>CRL</em></a> by using the public key information.</span></span></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="8a1fc-976"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptverifycertificatesignatureex"><strong>CryptVerifyCertificateSignatureEx</strong></a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-976"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptverifycertificatesignatureex"><strong>CryptVerifyCertificateSignatureEx</strong></a></span></span></td>
<td><span data-ttu-id="8a1fc-977"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptverifycertificatesignature"><strong>CryptVerifyCertificateSignature</strong></a>的擴充版本。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-977">An extended version of <a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptverifycertificatesignature"><strong>CryptVerifyCertificateSignature</strong></a>.</span></span></td>
</tr>
<tr class="even">
<td><span data-ttu-id="8a1fc-978"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-getencschannel"><strong>GetEncSChannel</strong></a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-978"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-getencschannel"><strong>GetEncSChannel</strong></a></span></span></td>
<td><span data-ttu-id="8a1fc-979">將加密的 Schannel DLL 內容儲存在記憶體中。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-979">Stores the encrypted Schannel DLL contents in memory.</span></span></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="8a1fc-980"><a href="/windows/desktop/api/Mssip/nc-mssip-pcryptsipgetcaps"><strong>pCryptSIPGetCaps</strong></a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-980"><a href="/windows/desktop/api/Mssip/nc-mssip-pcryptsipgetcaps"><strong>pCryptSIPGetCaps</strong></a></span></span></td>
<td><span data-ttu-id="8a1fc-981">由 SIP 執行以報告功能。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-981">Implemented by an SIP to report capabilities.</span></span></td>
</tr>
</tbody>
</table>



 

### <a name="data-conversion-functions"></a><span data-ttu-id="8a1fc-982">資料轉換函數</span><span class="sxs-lookup"><span data-stu-id="8a1fc-982">Data Conversion Functions</span></span>

<span data-ttu-id="8a1fc-983">下列 CryptoAPI 函數會將憑證結構成員轉換成不同的表單。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-983">The following CryptoAPI functions convert certificate structure members to different forms.</span></span>

| <span data-ttu-id="8a1fc-984">函式</span><span class="sxs-lookup"><span data-stu-id="8a1fc-984">Function</span></span>                                           | <span data-ttu-id="8a1fc-985">描述</span><span class="sxs-lookup"><span data-stu-id="8a1fc-985">Description</span></span>                                                                                                                                                                                                                                                                                                                  |
|----------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="8a1fc-986">**CertAlgIdToOID**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-986">**CertAlgIdToOID**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-certalgidtooid)           | <span data-ttu-id="8a1fc-987">將 CryptoAPI 演算法識別碼 (ALG 識別碼 \_) 轉換成 [*抽象語法標記法 (一)*](../secgloss/a-gly.md) ([*asn.1)*](../secgloss/o-gly.md) OID (字串。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-987">Converts a CryptoAPI algorithm identifier (ALG\_ID) to an [*Abstract Syntax Notation One*](../secgloss/a-gly.md) (ASN.1) [*object identifier*](../secgloss/o-gly.md) (OID) string.</span></span> |
| [<span data-ttu-id="8a1fc-988">**CertGetNameString**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-988">**CertGetNameString**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-certgetnamestringa)     | <span data-ttu-id="8a1fc-989">從憑證取得主體或簽發者名稱，並將其轉換為以 null 結束的字元字串。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-989">Acquires the subject or issuer name from a certificate, and converts it to a null-terminated character string.</span></span>                                                                                                                                                                                                               |
| [<span data-ttu-id="8a1fc-990">**CertNameToStr**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-990">**CertNameToStr**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-certnametostra)             | <span data-ttu-id="8a1fc-991">將憑證名稱 [*BLOB*](../secgloss/b-gly.md) 轉換為以零結尾的字串。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-991">Converts a certificate name [*BLOB*](../secgloss/b-gly.md) to a zero-terminated string.</span></span>                                                                                                                                                                                                      |
| [<span data-ttu-id="8a1fc-992">**CertOIDToAlgId**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-992">**CertOIDToAlgId**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-certoidtoalgid)           | <span data-ttu-id="8a1fc-993">將 ASN. 1 物件識別碼字串轉換為 CSP 演算法識別碼。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-993">Converts the ASN.1 Object Identifier string to the CSP algorithm identifier.</span></span>                                                                                                                                                                                                                                                 |
| [<span data-ttu-id="8a1fc-994">**CertRDNValueToStr**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-994">**CertRDNValueToStr**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-certrdnvaluetostra)     | <span data-ttu-id="8a1fc-995">將名稱值轉換為以 null 結束的字串。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-995">Converts a Name Value to a null-terminated string.</span></span>                                                                                                                                                                                                                                                                           |
| [<span data-ttu-id="8a1fc-996">**CertStrToName**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-996">**CertStrToName**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-certstrtonamea)             | <span data-ttu-id="8a1fc-997">將以 null 終止的 [*X. 500*](../secgloss/x-gly.md) 字串轉換成編碼的憑證名稱。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-997">Converts a null-terminated [*X.500*](../secgloss/x-gly.md) string to an encoded certificate name.</span></span>                                                                                                                                                                                          |
| [<span data-ttu-id="8a1fc-998">**CryptBinaryToString**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-998">**CryptBinaryToString**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptbinarytostringa) | <span data-ttu-id="8a1fc-999">將二進位序列轉換成格式化的字串。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-999">Converts a binary sequence into a formatted string.</span></span>                                                                                                                                                                                                                                                                          |
| [<span data-ttu-id="8a1fc-1000">**CryptFormatObject**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1000">**CryptFormatObject**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptformatobject)     | <span data-ttu-id="8a1fc-1001">格式化編碼的資料，並傳回 Unicode 字串。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1001">Formats encoded data, and returns a Unicode string.</span></span>                                                                                                                                                                                                                                                                          |
| [<span data-ttu-id="8a1fc-1002">**CryptStringToBinary**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1002">**CryptStringToBinary**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptstringtobinarya) | <span data-ttu-id="8a1fc-1003">將格式化字串轉換成二進位序列。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1003">Converts a formatted string to a binary sequence.</span></span>                                                                                                                                                                                                                                                                            |



 

### <a name="enhanced-key-usage-functions"></a><span data-ttu-id="8a1fc-1004">增強金鑰使用方法功能</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1004">Enhanced Key Usage Functions</span></span>

<span data-ttu-id="8a1fc-1005">下列函式會處理 [*增強金鑰使用*](../secgloss/e-gly.md) 方法 (EKU) 擴充功能和憑證的 eku 擴充屬性。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1005">The following functions deal with the [*enhanced key usage*](../secgloss/e-gly.md) (EKU) extension and the EKU extended property of certificates.</span></span> <span data-ttu-id="8a1fc-1006">EKU 延伸模組和擴充屬性指定並限制憑證的有效使用。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1006">The EKU extension and extended property specify and limit the valid uses of a certificate.</span></span> <span data-ttu-id="8a1fc-1007">延伸模組是憑證本身的一部分。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1007">The extensions are part of the certificate itself.</span></span> <span data-ttu-id="8a1fc-1008">它們是由憑證的簽發者所設定，而且是唯讀的。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1008">They are set by the issuer of the certificate and are read-only.</span></span> <span data-ttu-id="8a1fc-1009">憑證擴充的屬性是與可以在應用程式中設定的憑證相關聯的值。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1009">Certificate-extended properties are values associated with a certificate that can be set in an application.</span></span>

| <span data-ttu-id="8a1fc-1010">函式</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1010">Function</span></span>                                                                             | <span data-ttu-id="8a1fc-1011">描述</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1011">Description</span></span>                                                                    |
|--------------------------------------------------------------------------------------|--------------------------------------------------------------------------------|
| [<span data-ttu-id="8a1fc-1012">**CertAddEnhancedKeyUsageIdentifier**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1012">**CertAddEnhancedKeyUsageIdentifier**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-certaddenhancedkeyusageidentifier)       | <span data-ttu-id="8a1fc-1013">將使用識別碼新增至憑證的 EKU 屬性。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1013">Adds a usage identifier to a certificate's EKU property.</span></span>                       |
| [<span data-ttu-id="8a1fc-1014">**CertGetEnhancedKeyUsage**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1014">**CertGetEnhancedKeyUsage**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-certgetenhancedkeyusage)                           | <span data-ttu-id="8a1fc-1015">從憑證取得 EKU 延伸模組或屬性的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1015">Acquires, from a certificate, information about the EKU extension or property.</span></span> |
| [<span data-ttu-id="8a1fc-1016">**CertRemoveEnhancedKeyUsageIdentifier**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1016">**CertRemoveEnhancedKeyUsageIdentifier**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-certremoveenhancedkeyusageidentifier) | <span data-ttu-id="8a1fc-1017">從憑證的 EKU 擴充屬性移除使用識別碼。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1017">Removes the usage identifier from a certificate's EKU extended property.</span></span>       |
| [<span data-ttu-id="8a1fc-1018">**CertSetEnhancedKeyUsage**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1018">**CertSetEnhancedKeyUsage**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-certsetenhancedkeyusage)                           | <span data-ttu-id="8a1fc-1019">設定憑證的 EKU 屬性。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1019">Sets the EKU property for a certificate.</span></span>                                       |



 

### <a name="key-identifier-functions"></a><span data-ttu-id="8a1fc-1020">金鑰識別碼函數</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1020">Key Identifier Functions</span></span>

<span data-ttu-id="8a1fc-1021">金鑰識別碼函數可讓使用者建立、設定、抓取或尋找金鑰識別碼或其屬性。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1021">Key identifier functions allow the user to create, set, retrieve, or locate a key identifier or its properties.</span></span>

<span data-ttu-id="8a1fc-1022">金鑰識別碼是 [*公開/私密金鑰*](../secgloss/p-gly.md)組的唯一識別碼。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1022">A key identifier is the unique identifier of a [*public/private key pair*](../secgloss/p-gly.md).</span></span> <span data-ttu-id="8a1fc-1023">它可以是任何唯一的識別碼，但通常是編碼憑證 [**\_ 公開金鑰 \_ \_ 資訊**](/windows/desktop/api/Wincrypt/ns-wincrypt-cert_public_key_info) 結構的20位元組 SHA1 雜湊。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1023">It can be any unique identifier but is usually the 20-byte SHA1 hash of an encoded [**CERT\_PUBLIC\_KEY\_INFO**](/windows/desktop/api/Wincrypt/ns-wincrypt-cert_public_key_info) structure.</span></span> <span data-ttu-id="8a1fc-1024">金鑰識別碼可透過憑證的憑證 \_ 金鑰 \_ 識別碼識別碼（ID）來取得 \_ \_ 。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1024">A key identifier can be obtained through the certificate's CERT\_KEY\_IDENTIFIER\_PROP\_ID.</span></span> <span data-ttu-id="8a1fc-1025">金鑰識別碼可讓您使用該 [*金鑰*](../secgloss/k-gly.md) 組來加密或解密訊息，而不需要使用憑證。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1025">The key identifier allows the use of that [*key pair*](../secgloss/k-gly.md) to encrypt or decrypt messages without using the certificate.</span></span>

<span data-ttu-id="8a1fc-1026">金鑰識別碼未與 [*crl*](../secgloss/c-gly.md) 或 [*ctl*](../secgloss/c-gly.md)相關聯。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1026">Key identifiers are not associated with [*CRLs*](../secgloss/c-gly.md) or [*CTLs*](../secgloss/c-gly.md).</span></span>

<span data-ttu-id="8a1fc-1027">金鑰識別碼可擁有與憑證內容相同的屬性。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1027">A key identifier can have the same properties as a certificate context.</span></span> <span data-ttu-id="8a1fc-1028">如需詳細資訊，請參閱 [**CertCreateCoNtext**](/windows/desktop/api/Wincrypt/nf-wincrypt-certcreatecontext)。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1028">For more information, see [**CertCreateContext**](/windows/desktop/api/Wincrypt/nf-wincrypt-certcreatecontext).</span></span>

<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th><span data-ttu-id="8a1fc-1029">函式</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1029">Function</span></span></th>
<th><span data-ttu-id="8a1fc-1030">描述</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1030">Description</span></span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span data-ttu-id="8a1fc-1031"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptcreatekeyidentifierfromcsp"><strong>CryptCreateKeyIdentifierFromCSP</strong></a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-1031"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptcreatekeyidentifierfromcsp"><strong>CryptCreateKeyIdentifierFromCSP</strong></a></span></span></td>
<td><blockquote>
[!Important]<br />
<span data-ttu-id="8a1fc-1032">此 API 即將淘汰。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1032">This API is deprecated.</span></span> <span data-ttu-id="8a1fc-1033">新的和現有的軟體應該開始使用 <a href="/windows/desktop/SecCNG/cng-portal">新一代密碼編譯 api。</a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-1033">New and existing software should start using <a href="/windows/desktop/SecCNG/cng-portal">Cryptography Next Generation APIs.</a></span></span> <span data-ttu-id="8a1fc-1034">Microsoft 可能會在未來的版本中移除此 API。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1034">Microsoft may remove this API in future releases.</span></span>
</blockquote>
<br/> <span data-ttu-id="8a1fc-1035">從 CSP 的 <a href="/windows/desktop/SecGloss/p-gly"><em>公開金鑰 BLOB</em></a>建立金鑰識別碼。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1035">Creates a key identifier from a CSP's <a href="/windows/desktop/SecGloss/p-gly"><em>public key BLOB</em></a>.</span></span></td>
</tr>
<tr class="even">
<td><span data-ttu-id="8a1fc-1036"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptenumkeyidentifierproperties"><strong>CryptEnumKeyIdentifierProperties</strong></a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-1036"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptenumkeyidentifierproperties"><strong>CryptEnumKeyIdentifierProperties</strong></a></span></span></td>
<td><span data-ttu-id="8a1fc-1037">列舉金鑰識別碼及其屬性。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1037">Enumerates key identifiers and their properties.</span></span></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="8a1fc-1038"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptgetkeyidentifierproperty"><strong>CryptGetKeyIdentifierProperty</strong></a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-1038"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptgetkeyidentifierproperty"><strong>CryptGetKeyIdentifierProperty</strong></a></span></span></td>
<td><blockquote>
[!Important]<br />
<span data-ttu-id="8a1fc-1039">此 API 即將淘汰。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1039">This API is deprecated.</span></span> <span data-ttu-id="8a1fc-1040">新的和現有的軟體應該開始使用 <a href="/windows/desktop/SecCNG/cng-portal">新一代密碼編譯 api。</a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-1040">New and existing software should start using <a href="/windows/desktop/SecCNG/cng-portal">Cryptography Next Generation APIs.</a></span></span> <span data-ttu-id="8a1fc-1041">Microsoft 可能會在未來的版本中移除此 API。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1041">Microsoft may remove this API in future releases.</span></span>
</blockquote>
<br/> <span data-ttu-id="8a1fc-1042">從指定的金鑰識別碼取得特定屬性。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1042">Acquires a specific property from a specified key identifier.</span></span></td>
</tr>
<tr class="even">
<td><span data-ttu-id="8a1fc-1043"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptsetkeyidentifierproperty"><strong>CryptSetKeyIdentifierProperty</strong></a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-1043"><a href="/windows/desktop/api/Wincrypt/nf-wincrypt-cryptsetkeyidentifierproperty"><strong>CryptSetKeyIdentifierProperty</strong></a></span></span></td>
<td><blockquote>
[!Important]<br />
<span data-ttu-id="8a1fc-1044">此 API 即將淘汰。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1044">This API is deprecated.</span></span> <span data-ttu-id="8a1fc-1045">新的和現有的軟體應該開始使用 <a href="/windows/desktop/SecCNG/cng-portal">新一代密碼編譯 api。</a></span><span class="sxs-lookup"><span data-stu-id="8a1fc-1045">New and existing software should start using <a href="/windows/desktop/SecCNG/cng-portal">Cryptography Next Generation APIs.</a></span></span> <span data-ttu-id="8a1fc-1046">Microsoft 可能會在未來的版本中移除此 API。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1046">Microsoft may remove this API in future releases.</span></span>
</blockquote>
<br/> <span data-ttu-id="8a1fc-1047">設定指定之金鑰識別碼的屬性。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1047">Sets a property of a specified key identifier.</span></span></td>
</tr>
</tbody>
</table>



 

### <a name="oid-support-functions"></a><span data-ttu-id="8a1fc-1048">OID 支援函式</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1048">OID Support Functions</span></span>

<span data-ttu-id="8a1fc-1049">這些函式會提供 [*物件識別碼*](../secgloss/o-gly.md) (OID) 支援。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1049">These functions provide [*object identifier*](../secgloss/o-gly.md) (OID) support.</span></span> <span data-ttu-id="8a1fc-1050">這些函式會安裝、註冊和分派至 OID，以及編碼類型特定的函式。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1050">These functions install, register, and dispatch to OID and encoding type-specific functions.</span></span>

<span data-ttu-id="8a1fc-1051">下列 CryptoAPI 函數會使用這些 OID 支援函式：</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1051">The following CryptoAPI functions use these OID support functions:</span></span>

-   [<span data-ttu-id="8a1fc-1052">**CryptEncodeObject**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1052">**CryptEncodeObject**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptencodeobject)
-   [<span data-ttu-id="8a1fc-1053">**CryptEncodeObjectEx**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1053">**CryptEncodeObjectEx**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptencodeobjectex)
-   [<span data-ttu-id="8a1fc-1054">**CryptDecodeObject**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1054">**CryptDecodeObject**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptdecodeobject)
-   [<span data-ttu-id="8a1fc-1055">**CryptDecodeObjectEx**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1055">**CryptDecodeObjectEx**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptdecodeobjectex)
-   [<span data-ttu-id="8a1fc-1056">**CertVerifyRevocation**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1056">**CertVerifyRevocation**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-certverifyrevocation)
-   [<span data-ttu-id="8a1fc-1057">**CertOpenStore**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1057">**CertOpenStore**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-certopenstore)

<span data-ttu-id="8a1fc-1058">如需此流程的總覽，請參閱 [擴充 CryptoAPI 功能](extending-cryptoapi-functionality.md)。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1058">For an overview of this process, see [Extending CryptoAPI Functionality](extending-cryptoapi-functionality.md).</span></span>

<span data-ttu-id="8a1fc-1059">下列函式適用于 Oid。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1059">The following functions work with OIDs.</span></span>

| <span data-ttu-id="8a1fc-1060">函式</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1060">Function</span></span>                                                                       | <span data-ttu-id="8a1fc-1061">描述</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1061">Description</span></span>                                                                                                                                                                                                        |
|--------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="8a1fc-1062">**CryptEnumOIDFunction**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1062">**CryptEnumOIDFunction**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptenumoidfunction)                           | <span data-ttu-id="8a1fc-1063">列舉以其編碼類型、函式名稱和 OID 識別的已註冊 OID 函數。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1063">Enumerates the registered OID functions identified by their encoding type, function name, and OID.</span></span>                                                                                                                 |
| [<span data-ttu-id="8a1fc-1064">**CryptEnumOIDInfo**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1064">**CryptEnumOIDInfo**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptenumoidinfo)                                   | <span data-ttu-id="8a1fc-1065">列舉其群組識別的已註冊 OID 資訊，並呼叫 *pfnEnumOIDInfo* 以取得相符專案。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1065">Enumerates the registered OID information identified by their group, and calls *pfnEnumOIDInfo* for matches.</span></span>                                                                                                       |
| [<span data-ttu-id="8a1fc-1066">**CryptFindOIDInfo**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1066">**CryptFindOIDInfo**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptfindoidinfo)                                   | <span data-ttu-id="8a1fc-1067">使用指定的索引鍵和群組來尋找 OID 資訊。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1067">Uses the specified key and group to find OID information.</span></span>                                                                                                                                                          |
| [<span data-ttu-id="8a1fc-1068">**CryptFreeOIDFunctionAddress**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1068">**CryptFreeOIDFunctionAddress**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptfreeoidfunctionaddress)             | <span data-ttu-id="8a1fc-1069">釋放 [**CryptGetOIDFunctionAddress**](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptgetoidfunctionaddress) 或 [**CryptGetDefaultOIDFunctionAddress**](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptgetdefaultoidfunctionaddress)所遞增和傳回的控制碼計數。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1069">Releases the handle count that was incremented and returned by [**CryptGetOIDFunctionAddress**](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptgetoidfunctionaddress) or [**CryptGetDefaultOIDFunctionAddress**](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptgetdefaultoidfunctionaddress).</span></span> |
| [<span data-ttu-id="8a1fc-1070">**CryptGetDefaultOIDDllList**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1070">**CryptGetDefaultOIDDllList**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptgetdefaultoiddlllist)                 | <span data-ttu-id="8a1fc-1071">取得指定之函式集和編碼類型的已註冊預設 DLL 專案清單。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1071">Acquires the list of registered default DLL entries for the specified function set and encoding type.</span></span>                                                                                                              |
| [<span data-ttu-id="8a1fc-1072">**CryptGetDefaultOIDFunctionAddress**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1072">**CryptGetDefaultOIDFunctionAddress**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptgetdefaultoidfunctionaddress) | <span data-ttu-id="8a1fc-1073">取得第一個或下一個安裝的預設函數，或載入包含預設函式的 DLL。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1073">Either acquires the first or next installed default function, or loads the DLL that contains the default function.</span></span>                                                                                                 |
| [<span data-ttu-id="8a1fc-1074">**CryptGetOIDFunctionAddress**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1074">**CryptGetOIDFunctionAddress**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptgetoidfunctionaddress)               | <span data-ttu-id="8a1fc-1075">搜尋已安裝的函式清單，以取得編碼類型和 OID 相符的功能。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1075">Searches the list of installed functions for an encoding type and OID match.</span></span> <span data-ttu-id="8a1fc-1076">如果找不到相符的結果，則會搜尋相符的登錄。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1076">If a match is not found there, the registry is searched for a match.</span></span>                                                                  |
| [<span data-ttu-id="8a1fc-1077">**CryptGetOIDFunctionValue**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1077">**CryptGetOIDFunctionValue**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptgetoidfunctionvalue)                   | <span data-ttu-id="8a1fc-1078">取得指定之編碼類型、函式名稱、OID 和值名稱的值。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1078">Acquires the value for the specified encoding type, function name, OID, and value name.</span></span>                                                                                                                            |
| [<span data-ttu-id="8a1fc-1079">**CryptInitOIDFunctionSet**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1079">**CryptInitOIDFunctionSet**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptinitoidfunctionset)                     | <span data-ttu-id="8a1fc-1080">初始化並傳回由提供的函式名稱所識別之 OID 函數集的控制碼。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1080">Initializes and returns a handle of the OID function set identified by the function name supplied.</span></span>                                                                                                                 |
| [<span data-ttu-id="8a1fc-1081">**CryptInstallOIDFunctionAddress**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1081">**CryptInstallOIDFunctionAddress**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptinstalloidfunctionaddress)       | <span data-ttu-id="8a1fc-1082">安裝一組可呼叫的 OID 函數位址。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1082">Installs a set of callable OID function addresses.</span></span>                                                                                                                                                                 |
| [<span data-ttu-id="8a1fc-1083">**CryptRegisterDefaultOIDFunction**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1083">**CryptRegisterDefaultOIDFunction**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptregisterdefaultoidfunction)     | <span data-ttu-id="8a1fc-1084">註冊包含要針對指定的編碼類型和函式名稱呼叫之預設函式的 DLL。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1084">Registers the DLL that contains the default function to be called for the specified encoding type and function name.</span></span>                                                                                               |
| [<span data-ttu-id="8a1fc-1085">**CryptRegisterOIDFunction**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1085">**CryptRegisterOIDFunction**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptregisteroidfunction)                   | <span data-ttu-id="8a1fc-1086">註冊包含要針對指定的編碼類型、函式名稱和 OID 呼叫之函式的 DLL。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1086">Registers the DLL that contains the function to be called for the specified encoding type, function name, and OID.</span></span>                                                                                                 |
| [<span data-ttu-id="8a1fc-1087">**CryptRegisterOIDInfo**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1087">**CryptRegisterOIDInfo**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptregisteroidinfo)                           | <span data-ttu-id="8a1fc-1088">註冊 [**CRYPT \_ oid \_ 資訊**](/windows/desktop/api/Wincrypt/ns-wincrypt-crypt_oid_info) 結構中指定的 oid 資訊，並將其保存到登錄中。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1088">Registers the OID information specified in the [**CRYPT\_OID\_INFO**](/windows/desktop/api/Wincrypt/ns-wincrypt-crypt_oid_info) structure, persisting it to the registry.</span></span>                                                                                |
| [<span data-ttu-id="8a1fc-1089">**CryptSetOIDFunctionValue**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1089">**CryptSetOIDFunctionValue**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptsetoidfunctionvalue)                   | <span data-ttu-id="8a1fc-1090">設定指定之編碼類型、函式名稱、OID 和值名稱的值。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1090">Sets the value for the specified encoding type, function name, OID, and value name.</span></span>                                                                                                                                |
| [<span data-ttu-id="8a1fc-1091">**CryptUnregisterDefaultOIDFunction**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1091">**CryptUnregisterDefaultOIDFunction**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptunregisterdefaultoidfunction) | <span data-ttu-id="8a1fc-1092">移除包含要針對指定的編碼類型和函式名稱呼叫之預設函式之 DLL 的註冊。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1092">Removes the registration for the DLL that contains the default function to be called for the specified encoding type and function name.</span></span>                                                                            |
| [<span data-ttu-id="8a1fc-1093">**CryptUnregisterOIDFunction**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1093">**CryptUnregisterOIDFunction**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptunregisteroidfunction)               | <span data-ttu-id="8a1fc-1094">移除包含要針對指定的編碼類型、函式名稱和 OID 呼叫之函式之 DLL 的註冊。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1094">Removes the registration for the DLL that contains the function to be called for the specified encoding type, function name, and OID.</span></span>                                                                              |
| [<span data-ttu-id="8a1fc-1095">**CryptUnregisterOIDInfo**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1095">**CryptUnregisterOIDInfo**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptunregisteroidinfo)                       | <span data-ttu-id="8a1fc-1096">移除指定之 OID 資訊的註冊。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1096">Removes the registration for the specified OID information.</span></span>                                                                                                                                                        |



 

### <a name="remote-object-retrieval-functions"></a><span data-ttu-id="8a1fc-1097">遠端物件抓取函式</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1097">Remote Object Retrieval Functions</span></span>

<span data-ttu-id="8a1fc-1098">下列函式可讓使用者 (PKI) 物件取得公開金鑰基礎結構、取得憑證、CTL 或 CRL 的 URL，或從物件解壓縮 URL。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1098">The following functions allow the user to retrieve a Public Key Infrastructure (PKI) object, acquire the URL of a certificate, CTL, or CRL, or to extract a URL from an object.</span></span>

| <span data-ttu-id="8a1fc-1099">函式</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1099">Function</span></span>                                                     | <span data-ttu-id="8a1fc-1100">描述</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1100">Description</span></span>                                                            |
|--------------------------------------------------------------|------------------------------------------------------------------------|
| [<span data-ttu-id="8a1fc-1101">**CryptGetObjectUrl**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1101">**CryptGetObjectUrl**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptgetobjecturl)               | <span data-ttu-id="8a1fc-1102">從憑證、CTL 或 CRL 取得遠端物件的 URL。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1102">Acquires the URL of the remote object from a certificate, CTL, or CRL.</span></span> |
| [<span data-ttu-id="8a1fc-1103">**CryptRetrieveObjectByUrl**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1103">**CryptRetrieveObjectByUrl**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptretrieveobjectbyurla) | <span data-ttu-id="8a1fc-1104">從 URL 指定的位置抓取 PKI 物件。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1104">Retrieves the PKI object from a location specified by a URL.</span></span>           |



 

### <a name="pfx-functions"></a><span data-ttu-id="8a1fc-1105">PFX 函數</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1105">PFX Functions</span></span>

<span data-ttu-id="8a1fc-1106">下列功能支援 (PFX) 格式 [*blob*](../secgloss/b-gly.md)的個人資訊交換。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1106">The following functions support Personal Information Exchange (PFX) format [*BLOBs*](../secgloss/b-gly.md).</span></span>

| <span data-ttu-id="8a1fc-1107">函式</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1107">Function</span></span>                                             | <span data-ttu-id="8a1fc-1108">描述</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1108">Description</span></span>                                                                                                                                                                                                                                                                  |
|------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="8a1fc-1109">**PFXExportCertStore**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1109">**PFXExportCertStore**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-pfxexportcertstore)     | <span data-ttu-id="8a1fc-1110">從參考的 [*憑證存放區*](../secgloss/c-gly.md) 匯出憑證，以及其相關聯的 [*私密金鑰*](../secgloss/p-gly.md)（如果有的話）。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1110">Exports from the referenced [*certificate store*](../secgloss/c-gly.md) the certificates and, if available, their associated [*private keys*](../secgloss/p-gly.md).</span></span> |
| [<span data-ttu-id="8a1fc-1111">**PFXExportCertStoreEx**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1111">**PFXExportCertStoreEx**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-pfxexportcertstoreex) | <span data-ttu-id="8a1fc-1112">從參考的憑證存放區匯出憑證，以及其相關聯的私密金鑰（如果有的話）。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1112">Exports from the referenced certificate store the certificates and, if available, their associated private keys.</span></span>                                                                                                                                                             |
| [<span data-ttu-id="8a1fc-1113">**PFXImportCertStore**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1113">**PFXImportCertStore**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-pfximportcertstore)     | <span data-ttu-id="8a1fc-1114">匯入 PFX BLOB，並傳回存放區的控制碼，其中包含憑證和任何相關聯的私密金鑰。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1114">Imports a PFX BLOB, and returns the handle of a store that contains certificates and any associated private keys.</span></span>                                                                                                                                                            |
| [<span data-ttu-id="8a1fc-1115">**PFXIsPFXBlob**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1115">**PFXIsPFXBlob**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-pfxispfxblob)                 | <span data-ttu-id="8a1fc-1116">嘗試將 BLOB 的外部層解碼為 PFX 封包。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1116">Attempts to decode the outer layer of a BLOB as a PFX packet.</span></span>                                                                                                                                                                                                                |
| [<span data-ttu-id="8a1fc-1117">**PFXVerifyPassword**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1117">**PFXVerifyPassword**</span></span>](/windows/desktop/api/Wincrypt/nf-wincrypt-pfxverifypassword)       | <span data-ttu-id="8a1fc-1118">嘗試將 BLOB 的外部層解碼為 PFX 封包，並使用指定的密碼將它解密。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1118">Attempts to decode the outer layer of a BLOB as a PFX packet and to decrypt it with the given password.</span></span>                                                                                                                                                                      |



 

## <a name="certificate-services-backup-and-restore-functions"></a><span data-ttu-id="8a1fc-1119">憑證服務備份和還原功能</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1119">Certificate Services Backup and Restore Functions</span></span>

<span data-ttu-id="8a1fc-1120">憑證服務包含用來備份和還原憑證服務資料庫的功能。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1120">Certificate Services includes functions for backing up and restoring the Certificate Services database.</span></span> <span data-ttu-id="8a1fc-1121">這些憑證服務備份和還原功能都包含在 Certadm.dll 中。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1121">These Certificate Services backup and restore functions are contained in Certadm.dll.</span></span> <span data-ttu-id="8a1fc-1122">不同于與憑證服務相關聯的其他 API 元素，這些函式不會封裝在可以用來呼叫類別方法的物件中。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1122">Unlike the other API elements associated with Certificate Services, these functions are not encapsulated in an object that can be used to call class methods.</span></span> <span data-ttu-id="8a1fc-1123">相反地，藉由呼叫 [**LoadLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya) ，然後藉由呼叫 [**GetProcAddress**](/windows/win32/api/libloaderapi/nf-libloaderapi-getprocaddress)來判斷函式的位址，藉 Certadm.dll 以呼叫備份和還原 api。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1123">Instead, the backup and restore APIs are called by first loading the Certadm.dll library into memory by calling [**LoadLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya) and then determining the address of the functions by calling [**GetProcAddress**](/windows/win32/api/libloaderapi/nf-libloaderapi-getprocaddress).</span></span> <span data-ttu-id="8a1fc-1124">當您完成呼叫憑證服務備份和還原函式時，請呼叫 [**FreeLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-freelibrary) ，以從記憶體釋放 Certadm.dll 資源。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1124">When you have finished calling the Certificate Services backup and restore functions, call [**FreeLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-freelibrary) to free Certadm.dll resources from memory.</span></span>

> [!Note]
> <span data-ttu-id="8a1fc-1125">Certadm.dll 所提供的備份和還原功能不會備份或還原憑證服務的 [*私密金鑰*](../secgloss/p-gly.md)。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1125">Backup and restore functions provided by Certadm.dll do not backup or restore the Certificate Service's [*private keys*](../secgloss/p-gly.md).</span></span> <span data-ttu-id="8a1fc-1126">如需備份憑證服務私密金鑰的詳細資訊，請參閱 [備份和還原憑證服務私密金鑰](backing-up-and-restoring-the-certificate-services-private-key.md)。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1126">For information about backing up the Certificate Services private keys, see [Backing Up and Restoring the Certificate Services Private Key](backing-up-and-restoring-the-certificate-services-private-key.md).</span></span>
> 
> <span data-ttu-id="8a1fc-1127">若要呼叫備份和還原功能，您必須擁有備份和還原 [*許可權*](../secgloss/p-gly.md)。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1127">To call the backup and restore functions, you must have backup and restore [*privileges*](../secgloss/p-gly.md).</span></span> <span data-ttu-id="8a1fc-1128">如需詳細資訊，請參閱 [設定備份和還原許可權](setting-the-backup-and-restore-privileges.md)。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1128">For details, see [Setting the Backup and Restore Privileges](setting-the-backup-and-restore-privileges.md).</span></span>

 

> [!Note]  
> <span data-ttu-id="8a1fc-1129">如果先前是在用來呼叫憑證服務備份和還原 Api 的相同執行緒中呼叫 **CoInitializeEx** ，則必須將 COINIT \_ APARTMENTTHREADED 旗標傳遞到 **CoInitializeEx**。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1129">If **CoInitializeEx** was previously called in the same thread used to call the Certificate Services backup and restore APIs, the COINIT\_APARTMENTTHREADED flag must have been passed to **CoInitializeEx**.</span></span> <span data-ttu-id="8a1fc-1130">也就是說，當您使用相同的執行緒時，如果執行緒先前在呼叫 CoInitializeEx 時傳入了 COINIT \_ 多執行緒旗標，您就無法呼叫憑證服務備份和還原API。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1130">That is, when using the same thread, you cannot call the Certificate Services backup and restore API if the thread has previously passed in the COINIT\_MULTITHREADED flag in a call to **CoInitializeEx**.</span></span>

 

<span data-ttu-id="8a1fc-1131">憑證服務備份 Api 定義于 Certbcli 中。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1131">The Certificate Services Backup APIs are defined in Certbcli.h.</span></span> <span data-ttu-id="8a1fc-1132">但是，當您建立程式時，請使用 Certsrv 作為 include 檔。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1132">However, when you create your program, use Certsrv.h as the include file.</span></span>

<span data-ttu-id="8a1fc-1133">Certadm.dll 會匯出下列 Api。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1133">The following APIs are exported by Certadm.dll.</span></span>

| <span data-ttu-id="8a1fc-1134">函式</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1134">Function</span></span>                                                                         | <span data-ttu-id="8a1fc-1135">描述</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1135">Description</span></span>                                                                                                           |
|----------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="8a1fc-1136">**CertSrvBackupClose**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1136">**CertSrvBackupClose**</span></span>](/windows/desktop/api/Certbcli/nf-certbcli-certsrvbackupclose)                                 | <span data-ttu-id="8a1fc-1137">關閉開啟的檔案。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1137">Closes an opened file.</span></span>                                                                                                |
| [<span data-ttu-id="8a1fc-1138">**CertSrvBackupEnd**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1138">**CertSrvBackupEnd**</span></span>](/windows/desktop/api/Certbcli/nf-certbcli-certsrvbackupend)                                     | <span data-ttu-id="8a1fc-1139">結束備份會話。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1139">Ends a backup session.</span></span>                                                                                                |
| [<span data-ttu-id="8a1fc-1140">**CertSrvBackupFree**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1140">**CertSrvBackupFree**</span></span>](/windows/desktop/api/Certbcli/nf-certbcli-certsrvbackupfree)                                   | <span data-ttu-id="8a1fc-1141">釋放由備份和還原 Api 所配置的緩衝區。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1141">Frees a buffer allocated by the backup and restore APIs.</span></span>                                                              |
| [<span data-ttu-id="8a1fc-1142">**CertSrvBackupGetBackupLogs**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1142">**CertSrvBackupGetBackupLogs**</span></span>](/windows/desktop/api/Certbcli/nf-certbcli-certsrvbackupgetbackuplogsw)                 | <span data-ttu-id="8a1fc-1143">傳回需要備份的記錄檔清單。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1143">Returns a list of log files that need to be backed up.</span></span>                                                                |
| [<span data-ttu-id="8a1fc-1144">**CertSrvBackupGetDatabaseNames**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1144">**CertSrvBackupGetDatabaseNames**</span></span>](/windows/desktop/api/Certbcli/nf-certbcli-certsrvbackupgetdatabasenamesw)           | <span data-ttu-id="8a1fc-1145">傳回需要備份的資料庫檔案清單。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1145">Returns a list of database files that need to be backed up.</span></span>                                                           |
| [<span data-ttu-id="8a1fc-1146">**CertSrvBackupGetDynamicFileList**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1146">**CertSrvBackupGetDynamicFileList**</span></span>](/windows/desktop/api/Certbcli/nf-certbcli-certsrvbackupgetdynamicfilelistw)       | <span data-ttu-id="8a1fc-1147">抓取需要針對指定的備份內容備份的憑證服務動態檔案名清單。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1147">Retrieves the list of Certificate Services dynamic file names that need to be backed up for the given backup context.</span></span> |
| [<span data-ttu-id="8a1fc-1148">**CertSrvBackupOpenFile**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1148">**CertSrvBackupOpenFile**</span></span>](/windows/desktop/api/Certbcli/nf-certbcli-certsrvbackupopenfilew)                           | <span data-ttu-id="8a1fc-1149">開啟檔案以準備進行備份。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1149">Opens a file in preparation for backing it up.</span></span>                                                                        |
| [<span data-ttu-id="8a1fc-1150">**CertSrvBackupPrepare**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1150">**CertSrvBackupPrepare**</span></span>](/windows/desktop/api/Certbcli/nf-certbcli-certsrvbackuppreparew)                             | <span data-ttu-id="8a1fc-1151">準備資料庫以進行線上備份。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1151">Prepares the database for the online backup.</span></span>                                                                          |
| [<span data-ttu-id="8a1fc-1152">**CertSrvBackupRead**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1152">**CertSrvBackupRead**</span></span>](/windows/desktop/api/Certbcli/nf-certbcli-certsrvbackupread)                                   | <span data-ttu-id="8a1fc-1153">讀取已開啟檔案的內容。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1153">Reads the contents of an opened file.</span></span>                                                                                 |
| [<span data-ttu-id="8a1fc-1154">**CertSrvBackupTruncateLogs**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1154">**CertSrvBackupTruncateLogs**</span></span>](/windows/desktop/api/Certbcli/nf-certbcli-certsrvbackuptruncatelogs)                   | <span data-ttu-id="8a1fc-1155">截斷記錄檔。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1155">Truncates the log files.</span></span>                                                                                              |
| [<span data-ttu-id="8a1fc-1156">**CertSrvIsServerOnline**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1156">**CertSrvIsServerOnline**</span></span>](/windows/desktop/api/Certbcli/nf-certbcli-certsrvisserveronlinew)                           | <span data-ttu-id="8a1fc-1157">判斷憑證服務伺服器是否在線上 (主動執行) 。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1157">Determines whether a Certificate Services server is online (actively running).</span></span>                                        |
| [<span data-ttu-id="8a1fc-1158">**CertSrvRestoreEnd**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1158">**CertSrvRestoreEnd**</span></span>](/windows/desktop/api/Certbcli/nf-certbcli-certsrvrestoreend)                                   | <span data-ttu-id="8a1fc-1159">結束還原會話。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1159">Ends a restore session.</span></span>                                                                                               |
| [<span data-ttu-id="8a1fc-1160">**CertSrvRestoreGetDatabaseLocations**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1160">**CertSrvRestoreGetDatabaseLocations**</span></span>](/windows/desktop/api/Certbcli/nf-certbcli-certsrvrestoregetdatabaselocationsw) | <span data-ttu-id="8a1fc-1161">取得 (用於備份和還原案例) 的資料庫位置。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1161">Retrieves database locations (used for both backup and restore scenarios).</span></span>                                            |
| [<span data-ttu-id="8a1fc-1162">**CertSrvRestorePrepare**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1162">**CertSrvRestorePrepare**</span></span>](/windows/desktop/api/Certbcli/nf-certbcli-certsrvrestorepreparew)                           | <span data-ttu-id="8a1fc-1163">開始還原會話。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1163">Begins a restore session.</span></span>                                                                                             |
| [<span data-ttu-id="8a1fc-1164">**CertSrvRestoreRegister**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1164">**CertSrvRestoreRegister**</span></span>](/windows/desktop/api/Certbcli/nf-certbcli-certsrvrestoreregisterw)                         | <span data-ttu-id="8a1fc-1165">註冊還原作業。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1165">Registers a restore operation.</span></span>                                                                                        |
| [<span data-ttu-id="8a1fc-1166">**CertSrvRestoreRegisterComplete**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1166">**CertSrvRestoreRegisterComplete**</span></span>](/windows/desktop/api/Certbcli/nf-certbcli-certsrvrestoreregistercomplete)         | <span data-ttu-id="8a1fc-1167">完成先前註冊的還原作業。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1167">Completes a previously registered restore operation.</span></span>                                                                  |
| [<span data-ttu-id="8a1fc-1168">**CertSrvRestoreRegisterThroughFile**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1168">**CertSrvRestoreRegisterThroughFile**</span></span>](/windows/desktop/api/Certbcli/nf-certbcli-certsrvrestoreregisterthroughfile)   | <span data-ttu-id="8a1fc-1169">註冊還原作業。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1169">Registers a restore operation.</span></span>                                                                                        |
| [<span data-ttu-id="8a1fc-1170">**CertSrvServerControl**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1170">**CertSrvServerControl**</span></span>](/windows/desktop/api/Certbcli/nf-certbcli-certsrvservercontrolw)                             | <span data-ttu-id="8a1fc-1171">將控制命令傳送到憑證服務實例。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1171">Sends a control command to the Certificate Services instance.</span></span>                                                         |



 

## <a name="callback-functions"></a><span data-ttu-id="8a1fc-1172">回呼函式</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1172">Callback Functions</span></span>

<span data-ttu-id="8a1fc-1173">本節中的回呼函式是用來註冊或安裝應用程式定義的 [*憑證存放區*](../secgloss/c-gly.md) 提供者，以及透過回呼函式提供相關的功能。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1173">The callback functions in this section are used to register or install application-defined [*certificate store*](../secgloss/c-gly.md) providers and to provide related functionality through callback functions.</span></span> <span data-ttu-id="8a1fc-1174">回呼函式是由應用程式所執行，而且是由 [*CryptoAPI*](../secgloss/c-gly.md) 函式所呼叫。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1174">Callback functions are implemented by an application and are called by [*CryptoAPI*](../secgloss/c-gly.md) functions.</span></span> <span data-ttu-id="8a1fc-1175">回呼函數可讓應用程式控制 CryptoAPI 函式運算元據的方式。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1175">Callback functions enable the application to control, in part, the way that CryptoAPI functions manipulate data.</span></span>

| <span data-ttu-id="8a1fc-1176">回呼函數</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1176">Callback function</span></span>                                                                                                        | <span data-ttu-id="8a1fc-1177">使用</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1177">Use</span></span>                                                                                                                                                                                                                                                                                                                                           |
|--------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="8a1fc-1178">**CertChainFindByIssuerCallback**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1178">**CertChainFindByIssuerCallback**</span></span>](/windows/desktop/api/Wincrypt/nc-wincrypt-pfn_cert_chain_find_by_issuer_callback)                                                   | <span data-ttu-id="8a1fc-1179">應用程式定義的回呼函式，可讓應用程式篩選可能會新增至憑證鏈的憑證。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1179">An application-defined callback function that allows the application to filter certificates that might be added to the certificate chain.</span></span>                                                                                                                                                                                                     |
| [<span data-ttu-id="8a1fc-1180">**CertDllOpenStoreProv**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1180">**CertDllOpenStoreProv**</span></span>](/windows/desktop/api/Wincrypt/nc-wincrypt-pfn_cert_dll_open_store_prov_func)                                                                     | <span data-ttu-id="8a1fc-1181">定義存放區提供者 open 函數。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1181">Defines the store provider open function.</span></span>                                                                                                                                                                                                                                                                                                     |
| [<span data-ttu-id="8a1fc-1182">**CertEnumPhysicalStoreCallback**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1182">**CertEnumPhysicalStoreCallback**</span></span>](/windows/desktop/api/Wincrypt/nc-wincrypt-pfn_cert_enum_physical_store)                                                   | <span data-ttu-id="8a1fc-1183">[**CertEnumPhysicalStore**](/windows/desktop/api/Wincrypt/nf-wincrypt-certenumphysicalstore)函式所使用的回呼函式，用來格式化和呈現每個找到的實體存放區的資訊。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1183">Callback function used by the [**CertEnumPhysicalStore**](/windows/desktop/api/Wincrypt/nf-wincrypt-certenumphysicalstore) function to format and present information on each physical store found.</span></span>                                                                                                                                                                                 |
| [<span data-ttu-id="8a1fc-1184">**CertEnumSystemStoreCallback**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1184">**CertEnumSystemStoreCallback**</span></span>](/windows/desktop/api/Wincrypt/nc-wincrypt-pfn_cert_enum_system_store)                                                       | <span data-ttu-id="8a1fc-1185">[**CertEnumSystemStore**](/windows/desktop/api/Wincrypt/nf-wincrypt-certenumsystemstore)函式所使用的回呼函式，用來格式化和呈現每個找到的實體存放區的資訊。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1185">Callback function used by the [**CertEnumSystemStore**](/windows/desktop/api/Wincrypt/nf-wincrypt-certenumsystemstore) function to format and present information on each physical store found.</span></span>                                                                                                                                                                                     |
| [<span data-ttu-id="8a1fc-1186">**CertEnumSystemStoreLocationCallback**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1186">**CertEnumSystemStoreLocationCallback**</span></span>](/windows/desktop/api/Wincrypt/nc-wincrypt-pfn_cert_enum_system_store_location)                                       | <span data-ttu-id="8a1fc-1187">[**CertEnumSystemStoreLocation**](/windows/desktop/api/Wincrypt/nf-wincrypt-certenumsystemstorelocation)函式所使用的回呼函式，用來格式化和呈現每個找到的實體存放區的資訊。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1187">Callback function used by the [**CertEnumSystemStoreLocation**](/windows/desktop/api/Wincrypt/nf-wincrypt-certenumsystemstorelocation) function to format and present information on each physical store found.</span></span>                                                                                                                                                                     |
| [<span data-ttu-id="8a1fc-1188">**CertStoreProvCloseCallback**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1188">**CertStoreProvCloseCallback**</span></span>](/windows/desktop/api/Wincrypt/nc-wincrypt-pfn_cert_store_prov_close)                                                         | <span data-ttu-id="8a1fc-1189">決定當開啟存放區的 [*參考計數*](../secgloss/r-gly.md) 變成零時，會發生什麼事。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1189">Determines what happens when an open store's [*reference count*](../secgloss/r-gly.md) becomes zero.</span></span>                                                                                                                                                                                    |
| [<span data-ttu-id="8a1fc-1190">**CertStoreProvControl**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1190">**CertStoreProvControl**</span></span>](/windows/win32/api/wincrypt/nc-wincrypt-pfn_cert_store_prov_control)                                                                     | <span data-ttu-id="8a1fc-1191">允許應用程式在使用中的快取存放區內容和存放區保存儲存時的內容有差異時，收到通知。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1191">Allows an application to be notified when there is a difference between the contents of a cached store in use and the contents of that store as it is persisted to storage.</span></span>                                                                                                                                                                   |
| [<span data-ttu-id="8a1fc-1192">**CertStoreProvDeleteCertCallback**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1192">**CertStoreProvDeleteCertCallback**</span></span>](/windows/desktop/api/Wincrypt/nc-wincrypt-pfn_cert_store_prov_delete_cert)                                               | <span data-ttu-id="8a1fc-1193">決定從憑證存放區刪除憑證之前所要採取的動作。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1193">Determines actions to be taken before a certificate is deleted from a certificate store.</span></span>                                                                                                                                                                                                                                                      |
| [<span data-ttu-id="8a1fc-1194">**CertStoreProvDeleteCRLCallback**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1194">**CertStoreProvDeleteCRLCallback**</span></span>](/windows/desktop/api/Wincrypt/nc-wincrypt-pfn_cert_store_prov_delete_crl)                                                 | <span data-ttu-id="8a1fc-1195">決定從憑證存放區刪除 [*憑證撤銷清單*](../secgloss/c-gly.md) (CRL) 之後要採取的動作。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1195">Determines actions to be taken before a [*certificate revocation list*](../secgloss/c-gly.md) (CRL) is deleted from a certificate store.</span></span>                                                                                                                        |
| [<span data-ttu-id="8a1fc-1196">**CertStoreProvDeleteCTL**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1196">**CertStoreProvDeleteCTL**</span></span>](certstoreprovdeletectl.md)                                                                 | <span data-ttu-id="8a1fc-1197">判斷是否可刪除 CTL。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1197">Determines whether a CTL can be deleted.</span></span>                                                                                                                                                                                                                                                                                                      |
| [<span data-ttu-id="8a1fc-1198">**CertStoreProvFindCert**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1198">**CertStoreProvFindCert**</span></span>](certstoreprovfindcert.md)                                                                   | <span data-ttu-id="8a1fc-1199">在存放區中尋找符合指定準則的第一個或下一個憑證。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1199">Finds the first, or next, certificate in a store that matches specified criteria.</span></span>                                                                                                                                                                                                                                                             |
| [<span data-ttu-id="8a1fc-1200">**CertStoreProvFindCRL**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1200">**CertStoreProvFindCRL**</span></span>](certstoreprovfindcrl.md)                                                                     | <span data-ttu-id="8a1fc-1201">在存放區中尋找符合指定準則的第一個或下一個 CRL。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1201">Finds the first, or next, CRL in a store that matches specified criteria.</span></span>                                                                                                                                                                                                                                                                     |
| [<span data-ttu-id="8a1fc-1202">**CertStoreProvFindCTL**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1202">**CertStoreProvFindCTL**</span></span>](certstoreprovfindctl.md)                                                                     | <span data-ttu-id="8a1fc-1203">在存放區中尋找符合指定準則的第一個或下一個 CTL。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1203">Finds the first, or next, CTL in a store that matches specified criteria.</span></span>                                                                                                                                                                                                                                                                     |
| [<span data-ttu-id="8a1fc-1204">**CertStoreProvFreeFindCert**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1204">**CertStoreProvFreeFindCert**</span></span>](certstoreprovfreefindcert.md)                                                           | <span data-ttu-id="8a1fc-1205">釋出先前找到的憑證內容。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1205">Frees a previously found certificate context.</span></span>                                                                                                                                                                                                                                                                                                 |
| [<span data-ttu-id="8a1fc-1206">**CertStoreProvFreeFindCRL**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1206">**CertStoreProvFreeFindCRL**</span></span>](certstoreprovfreefindcrl.md)                                                             | <span data-ttu-id="8a1fc-1207">釋出先前找到的 CRL 內容。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1207">Frees a previously found CRL context.</span></span>                                                                                                                                                                                                                                                                                                         |
| [<span data-ttu-id="8a1fc-1208">**CertStoreProvFreeFindCTL**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1208">**CertStoreProvFreeFindCTL**</span></span>](certstoreprovfreefindctl.md)                                                             | <span data-ttu-id="8a1fc-1209">釋放先前找到的 CTL 內容。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1209">Frees a previously found CTL context.</span></span>                                                                                                                                                                                                                                                                                                         |
| [<span data-ttu-id="8a1fc-1210">**CertStoreProvGetCertProperty**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1210">**CertStoreProvGetCertProperty**</span></span>](certstoreprovgetcertproperty.md)                                                     | <span data-ttu-id="8a1fc-1211">抓取憑證的指定屬性。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1211">Retrieves a specified property of a certificate.</span></span>                                                                                                                                                                                                                                                                                              |
| [<span data-ttu-id="8a1fc-1212">**CertStoreProvGetCRLProperty**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1212">**CertStoreProvGetCRLProperty**</span></span>](certstoreprovgetcrlproperty.md)                                                       | <span data-ttu-id="8a1fc-1213">抓取 CRL 的指定屬性。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1213">Retrieves a specified property of a CRL.</span></span>                                                                                                                                                                                                                                                                                                      |
| [<span data-ttu-id="8a1fc-1214">**CertStoreProvGetCTLProperty**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1214">**CertStoreProvGetCTLProperty**</span></span>](certstoreprovgetctlproperty.md)                                                       | <span data-ttu-id="8a1fc-1215">抓取 CTL 的指定屬性。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1215">Retrieves a specified property of a CTL.</span></span>                                                                                                                                                                                                                                                                                                      |
| [<span data-ttu-id="8a1fc-1216">**CertStoreProvReadCertCallback**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1216">**CertStoreProvReadCertCallback**</span></span>](/windows/desktop/api/Wincrypt/nc-wincrypt-pfn_cert_store_prov_read_cert)                                                   | <span data-ttu-id="8a1fc-1217">目前未使用，但可能會匯出至未來的 Csp。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1217">Currently not used but might be exported to future CSPs.</span></span>                                                                                                                                                                                                                                                                                      |
| [<span data-ttu-id="8a1fc-1218">**CertStoreProvReadCRLCallback**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1218">**CertStoreProvReadCRLCallback**</span></span>](/windows/desktop/api/Wincrypt/nc-wincrypt-pfn_cert_store_prov_read_crl)                                                     | <span data-ttu-id="8a1fc-1219">目前未使用，但可能會匯出至未來的 Csp。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1219">Currently not used but might be exported to future CSPs.</span></span>                                                                                                                                                                                                                                                                                      |
| [<span data-ttu-id="8a1fc-1220">**CertStoreProvReadCTL**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1220">**CertStoreProvReadCTL**</span></span>](/windows/win32/api/wincrypt/nc-wincrypt-pfn_cert_store_prov_read_ctl)                                                                     | <span data-ttu-id="8a1fc-1221">讀取提供者的 CTL 內容複本，如果存在，請建立新的 CTL 內容。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1221">Read the provider's copy of the CTL context, and, if it exists, create a new CTL context.</span></span>                                                                                                                                                                                                                                                     |
| [<span data-ttu-id="8a1fc-1222">**CertStoreProvSetCertPropertyCallback**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1222">**CertStoreProvSetCertPropertyCallback**</span></span>](/windows/desktop/api/Wincrypt/nc-wincrypt-pfn_cert_store_prov_set_cert_property)                                     | <span data-ttu-id="8a1fc-1223">決定在呼叫 [**CertSetCertificateCoNtextProperty**](/windows/desktop/api/Wincrypt/nf-wincrypt-certsetcertificatecontextproperty) 或 [**CertGetCertificateCoNtextProperty**](/windows/desktop/api/Wincrypt/nf-wincrypt-certgetcertificatecontextproperty)之前所要採取的動作。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1223">Determines actions to be taken before a call to [**CertSetCertificateContextProperty**](/windows/desktop/api/Wincrypt/nf-wincrypt-certsetcertificatecontextproperty) or [**CertGetCertificateContextProperty**](/windows/desktop/api/Wincrypt/nf-wincrypt-certgetcertificatecontextproperty).</span></span>                                                                                                                             |
| [<span data-ttu-id="8a1fc-1224">**CertStoreProvSetCRLPropertyCallback**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1224">**CertStoreProvSetCRLPropertyCallback**</span></span>](/windows/desktop/api/Wincrypt/nc-wincrypt-pfn_cert_store_prov_set_crl_property)                                       | <span data-ttu-id="8a1fc-1225">決定在呼叫 [**CertSetCRLCoNtextProperty**](/windows/desktop/api/Wincrypt/nf-wincrypt-certsetcrlcontextproperty) 或 [**CertGetCRLCoNtextProperty**](/windows/desktop/api/Wincrypt/nf-wincrypt-certgetcrlcontextproperty)之前所要採取的動作。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1225">Determines actions to be taken before a call to [**CertSetCRLContextProperty**](/windows/desktop/api/Wincrypt/nf-wincrypt-certsetcrlcontextproperty) or [**CertGetCRLContextProperty**](/windows/desktop/api/Wincrypt/nf-wincrypt-certgetcrlcontextproperty).</span></span>                                                                                                                                                             |
| [<span data-ttu-id="8a1fc-1226">**CertStoreProvSetCTLProperty**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1226">**CertStoreProvSetCTLProperty**</span></span>](/windows/desktop/api/Wincrypt/nc-wincrypt-pfn_cert_store_prov_set_ctl_property)                                                       | <span data-ttu-id="8a1fc-1227">判斷是否可以在 CTL 上設定屬性。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1227">Determines whether a property can be set on a CTL.</span></span>                                                                                                                                                                                                                                                                                            |
| [<span data-ttu-id="8a1fc-1228">**CertStoreProvWriteCertCallback**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1228">**CertStoreProvWriteCertCallback**</span></span>](/windows/desktop/api/Wincrypt/nc-wincrypt-pfn_cert_store_prov_write_cert)                                                 | <span data-ttu-id="8a1fc-1229">決定將憑證新增至存放區之前所要採取的動作。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1229">Determines actions to be taken before adding a certificate to a store.</span></span>                                                                                                                                                                                                                                                                        |
| [<span data-ttu-id="8a1fc-1230">**CertStoreProvWriteCRLCallback**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1230">**CertStoreProvWriteCRLCallback**</span></span>](/windows/desktop/api/Wincrypt/nc-wincrypt-pfn_cert_store_prov_write_crl)                                                   | <span data-ttu-id="8a1fc-1231">決定將 CRL 新增至存放區之前所要採取的動作。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1231">Determines actions to be taken before adding a CRL to a store.</span></span>                                                                                                                                                                                                                                                                                |
| [<span data-ttu-id="8a1fc-1232">**CertStoreProvWriteCTL**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1232">**CertStoreProvWriteCTL**</span></span>](/windows/desktop/api/Wincrypt/nc-wincrypt-pfn_cert_store_prov_write_ctl)                                                                   | <span data-ttu-id="8a1fc-1233">判斷是否可以將 CTL 新增至存放區。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1233">Determines whether a CTL can be added to the store.</span></span>                                                                                                                                                                                                                                                                                           |
| [<span data-ttu-id="8a1fc-1234">**CRYPT \_ 列舉 \_ KEYID \_**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1234">**CRYPT\_ENUM\_KEYID\_PROP**</span></span>](/windows/desktop/api/Wincrypt/nc-wincrypt-pfn_crypt_enum_keyid_prop)                                                                | <span data-ttu-id="8a1fc-1235">[**CryptEnumKeyIdentifierProperties**](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptenumkeyidentifierproperties)函式所使用的回呼函數。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1235">Callback function used by the [**CryptEnumKeyIdentifierProperties**](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptenumkeyidentifierproperties) function.</span></span>                                                                                                                                                                                                                          |
| [<span data-ttu-id="8a1fc-1236">**CRYPT \_ 列舉 \_ OID \_ 函數**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1236">**CRYPT\_ENUM\_OID\_FUNCTION**</span></span>](/windows/desktop/api/Wincrypt/nc-wincrypt-pfn_crypt_enum_oid_func)                                                            | <span data-ttu-id="8a1fc-1237">[**CryptEnumOIDFunction**](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptenumoidfunction)函式所使用的回呼函數。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1237">Callback function used by the [**CryptEnumOIDFunction**](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptenumoidfunction) function.</span></span>                                                                                                                                                                                                                                                  |
| [<span data-ttu-id="8a1fc-1238">**CRYPT \_ 列舉 \_ OID \_ 資訊**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1238">**CRYPT\_ENUM\_OID\_INFO**</span></span>](/windows/desktop/api/Wincrypt/nc-wincrypt-pfn_crypt_enum_oid_info)                                                                    | <span data-ttu-id="8a1fc-1239">[**CryptEnumOIDInfo**](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptenumoidinfo)函式所使用的回呼函數。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1239">Callback function used by the [**CryptEnumOIDInfo**](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptenumoidinfo) function.</span></span>                                                                                                                                                                                                                                                          |
| [<span data-ttu-id="8a1fc-1240">**CryptGetSignerCertificateCallback**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1240">**CryptGetSignerCertificateCallback**</span></span>](/windows/desktop/api/Wincrypt/nc-wincrypt-pfn_crypt_get_signer_certificate)                                           | <span data-ttu-id="8a1fc-1241">搭配 [**CRYPT \_ 驗證 \_ 訊息 \_ 段落**](/windows/desktop/api/Wincrypt/ns-wincrypt-crypt_verify_message_para) 結構使用的回呼函式，以取得並驗證訊息簽署者的憑證。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1241">Callback function used with the [**CRYPT\_VERIFY\_MESSAGE\_PARA**](/windows/desktop/api/Wincrypt/ns-wincrypt-crypt_verify_message_para) structure to get and verify a message signer's certificate.</span></span>                                                                                                                                                                                 |
| [<span data-ttu-id="8a1fc-1242">**PCRYPT \_ 解密 \_ 私用 \_ 金鑰 \_ FUNC**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1242">**PCRYPT\_DECRYPT\_PRIVATE\_KEY\_FUNC**</span></span>](/windows/win32/api/wincrypt/nc-wincrypt-pcrypt_decrypt_private_key_func)                                           | <span data-ttu-id="8a1fc-1243">[**CryptImportPKCS8**](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptimportpkcs8)函式所使用的回呼函數。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1243">Callback function used by the [**CryptImportPKCS8**](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptimportpkcs8) function.</span></span>                                                                                                                                                                                                                                                          |
| [<span data-ttu-id="8a1fc-1244">**PCRYPT \_ 加密 \_ 私用 \_ 金鑰 \_ FUNC**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1244">**PCRYPT\_ENCRYPT\_PRIVATE\_KEY\_FUNC**</span></span>](/windows/win32/api/wincrypt/nc-wincrypt-pcrypt_encrypt_private_key_func)                                           | <span data-ttu-id="8a1fc-1245">建立 [**CRYPT \_ 加密的 \_ 私密金鑰 \_ \_ 資訊**](/windows/desktop/api/Wincrypt/ns-wincrypt-crypt_encrypted_private_key_info) 結構時所使用的回呼函數。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1245">Callback function used when creating the [**CRYPT\_ENCRYPTED\_PRIVATE\_KEY\_INFO**](/windows/desktop/api/Wincrypt/ns-wincrypt-crypt_encrypted_private_key_info) structure.</span></span>                                                                                                                                                                                                          |
| [<span data-ttu-id="8a1fc-1246">**PCRYPT \_ RESOLVE \_ HCRYPTPROV \_ FUNC**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1246">**PCRYPT\_RESOLVE\_HCRYPTPROV\_FUNC**</span></span>](/windows/win32/api/wincrypt/nc-wincrypt-pcrypt_resolve_hcryptprov_func)                                              | <span data-ttu-id="8a1fc-1247">[**CryptImportPKCS8**](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptimportpkcs8)函式所使用的回呼函數。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1247">Callback function used by the [**CryptImportPKCS8**](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptimportpkcs8) function.</span></span>                                                                                                                                                                                                                                                          |
| [<span data-ttu-id="8a1fc-1248">**PFN \_ CDF \_ 剖析 \_ 錯誤 \_ 回呼**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1248">**PFN\_CDF\_PARSE\_ERROR\_CALLBACK**</span></span>](/windows/win32/api/mscat/nc-mscat-pfn_cdf_parse_error_callback)                                                 | <span data-ttu-id="8a1fc-1249">剖析目錄定義檔 (CDF) 時，針對目錄定義函式所呼叫的使用者定義函數錯誤。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1249">A user-defined function called for Catalog Definition Function errors while parsing a catalog definition file (CDF).</span></span>                                                                                                                                                                                                                          |
| [<span data-ttu-id="8a1fc-1250">**PFN \_ CERT \_ CREATE \_ 內容 \_ 排序 \_ FUNC**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1250">**PFN\_CERT\_CREATE\_CONTEXT\_SORT\_FUNC**</span></span>](/windows/win32/api/wincrypt/nc-wincrypt-pfn_cert_create_context_sort_func)                                      | <span data-ttu-id="8a1fc-1251">在建立內容時針對每個已排序的內容專案呼叫。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1251">Called for each sorted context entry when a context is created.</span></span>                                                                                                                                                                                                                                                                               |
| [<span data-ttu-id="8a1fc-1252">**PFN \_ CMSG \_ CNG 匯 \_ 入 \_ 內容 \_ 加密 \_ 金鑰**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1252">**PFN\_CMSG\_CNG\_IMPORT\_CONTENT\_ENCRYPT\_KEY**</span></span>](/windows/win32/api/wincrypt/nc-wincrypt-pfn_cmsg_cng_import_content_encrypt_key)                         | <span data-ttu-id="8a1fc-1253">CNG [*物件識別碼*](../secgloss/o-gly.md) (OID) 可安裝的函式，以匯入已解密的內容加密金鑰 (CEK) 。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1253">A CNG [*object identifier*](../secgloss/o-gly.md) (OID) installable function for import of an already decrypted content encryption key (CEK).</span></span>                                                                                                                                       |
| [<span data-ttu-id="8a1fc-1254">**PFN \_ CMSG \_ CNG 匯 \_ 入 \_ 金鑰 \_ 同意**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1254">**PFN\_CMSG\_CNG\_IMPORT\_KEY\_AGREE**</span></span>](/windows/win32/api/wincrypt/nc-wincrypt-pfn_cmsg_cng_import_key_agree)                                              | <span data-ttu-id="8a1fc-1255">匯入封包訊息的金鑰傳輸收件者的內容加密金鑰。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1255">Imports a content encryption key for a key transport recipient of an enveloped message.</span></span>                                                                                                                                                                                                                                                       |
| [<span data-ttu-id="8a1fc-1256">**PFN \_ CMSG \_ CNG 匯 \_ 入 \_ 金鑰 \_ 交易**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1256">**PFN\_CMSG\_CNG\_IMPORT\_KEY\_TRANS**</span></span>](/windows/win32/api/wincrypt/nc-wincrypt-pfn_cmsg_cng_import_key_trans)                                              | <span data-ttu-id="8a1fc-1257">CNG OID 可安裝的函式，用於匯入和 [*解密*](../secgloss/d-gly.md) 金鑰-傳輸-收件者、加密、內容 [*加密*](../secgloss/e-gly.md) 金鑰 (CEK) 。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1257">A CNG OID installable function for import and [*decryption*](../secgloss/d-gly.md) of a key-transport-recipient, encrypted, content [*encryption*](../secgloss/e-gly.md) key (CEK).</span></span>                                                                   |
| [<span data-ttu-id="8a1fc-1258">**PFN \_ CMSG \_ 匯出 \_ 金鑰 \_ 同意**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1258">**PFN\_CMSG\_EXPORT\_KEY\_AGREE**</span></span>](/windows/win32/api/wincrypt/nc-wincrypt-pfn_cmsg_export_key_agree)                                                       | <span data-ttu-id="8a1fc-1259">針對封包訊息的重要合約收件者，加密及匯出內容加密金鑰。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1259">Encrypts and exports the content encryption key for a key agreement recipient of an enveloped message.</span></span>                                                                                                                                                                                                                                        |
| [<span data-ttu-id="8a1fc-1260">**PFN \_ CMSG \_ 匯出 \_ 金鑰 \_ 交易**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1260">**PFN\_CMSG\_EXPORT\_KEY\_TRANS**</span></span>](/windows/win32/api/wincrypt/nc-wincrypt-pfn_cmsg_export_key_trans)                                                       | <span data-ttu-id="8a1fc-1261">為封包訊息的金鑰傳輸收件者加密及匯出內容加密金鑰。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1261">Encrypts and exports the content encryption key for a key transport recipient of an enveloped message.</span></span>                                                                                                                                                                                                                                        |
| [<span data-ttu-id="8a1fc-1262">**PFN \_ CMSG \_ 匯出 \_ 郵寄清單 \_**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1262">**PFN\_CMSG\_EXPORT\_MAIL\_LIST**</span></span>](/windows/win32/api/wincrypt/nc-wincrypt-pfn_cmsg_export_mail_list)                                                       | <span data-ttu-id="8a1fc-1263">為封包訊息的郵寄清單收件者加密及匯出內容加密金鑰。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1263">Encrypts and exports the content encryption key for a mailing list recipient of an enveloped message.</span></span>                                                                                                                                                                                                                                         |
| [<span data-ttu-id="8a1fc-1264">**PFN \_ CMSG \_ GEN \_ CONTENT \_ 加密 \_ 金鑰**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1264">**PFN\_CMSG\_GEN\_CONTENT\_ENCRYPT\_KEY**</span></span>](/windows/win32/api/wincrypt/nc-wincrypt-pfn_cmsg_gen_content_encrypt_key)                                        | <span data-ttu-id="8a1fc-1265">產生用來加密封包訊息之內容的 [*對稱金鑰*](../secgloss/s-gly.md) 。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1265">Generates the [*symmetric key*](../secgloss/s-gly.md) used to encrypt content for an enveloped message.</span></span>                                                                                                                                                                                     |
| [<span data-ttu-id="8a1fc-1266">**PFN \_ CMSG 匯 \_ 入 \_ 金鑰 \_ 同意**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1266">**PFN\_CMSG\_IMPORT\_KEY\_AGREE**</span></span>](/windows/win32/api/wincrypt/nc-wincrypt-pfn_cmsg_import_key_agree)                                                       | <span data-ttu-id="8a1fc-1267">匯入封包訊息的金鑰傳輸收件者的內容加密金鑰。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1267">Imports a content encryption key for a key transport recipient of an enveloped message.</span></span>                                                                                                                                                                                                                                                       |
| [<span data-ttu-id="8a1fc-1268">**PFN \_ CMSG 匯 \_ 入 \_ 金鑰 \_ 交易**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1268">**PFN\_CMSG\_IMPORT\_KEY\_TRANS**</span></span>](/windows/win32/api/wincrypt/nc-wincrypt-pfn_cmsg_import_key_trans)                                                       | <span data-ttu-id="8a1fc-1269">匯入封包訊息的金鑰傳輸收件者的內容加密金鑰。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1269">Imports a content encryption key for a key transport recipient of an enveloped message.</span></span>                                                                                                                                                                                                                                                       |
| [<span data-ttu-id="8a1fc-1270">**PFN \_ CMSG \_ 匯 \_ 入 \_ 郵寄清單**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1270">**PFN\_CMSG\_IMPORT\_MAIL\_LIST**</span></span>](/windows/win32/api/wincrypt/nc-wincrypt-pfn_cmsg_import_mail_list)                                                       | <span data-ttu-id="8a1fc-1271">匯入封包訊息的金鑰傳輸收件者的內容加密金鑰。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1271">Imports a content encryption key for a key transport recipient of an enveloped message.</span></span>                                                                                                                                                                                                                                                       |
| [<span data-ttu-id="8a1fc-1272">**PFN \_ CRYPT \_ 匯出 \_ 公開金鑰 \_ \_ 資訊 \_ EX2 \_ FUNC**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1272">**PFN\_CRYPT\_EXPORT\_PUBLIC\_KEY\_INFO\_EX2\_FUNC**</span></span>](/windows/win32/api/wincrypt/nc-wincrypt-pfn_crypt_export_public_key_info_ex2_func)                    | <span data-ttu-id="8a1fc-1273">由 [**CryptExportPublicKeyInfoEx**](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptexportpublickeyinfoex) 呼叫，以匯出公開金鑰 BLOB 並進行編碼。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1273">Called by [**CryptExportPublicKeyInfoEx**](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptexportpublickeyinfoex) to export a public key BLOB and encode it.</span></span>                                                                                                                                                                                                                         |
| [<span data-ttu-id="8a1fc-1274">**PFN CRYPT 將編碼的簽章 \_ \_ \_ \_ \_ 參數 \_ FUNC 解壓縮**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1274">**PFN\_CRYPT\_EXTRACT\_ENCODED\_SIGNATURE\_PARAMETERS\_FUNC**</span></span>](/windows/win32/api/wincrypt/nc-wincrypt-pfn_crypt_extract_encoded_signature_parameters_func) | <span data-ttu-id="8a1fc-1275">呼叫以解碼和傳回雜湊演算法識別碼，並選擇性地傳回簽章參數。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1275">Called to decode and return the hash algorithm identifier and optionally the signature parameters.</span></span>                                                                                                                                                                                                                                            |
| [<span data-ttu-id="8a1fc-1276">**PFN \_ CRYPT \_ 正負號 \_ 和 \_ 編碼 \_ 雜湊 \_ FUNC**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1276">**PFN\_CRYPT\_SIGN\_AND\_ENCODE\_HASH\_FUNC**</span></span>](/windows/win32/api/wincrypt/nc-wincrypt-pfn_crypt_sign_and_encode_hash_func)                                 | <span data-ttu-id="8a1fc-1277">呼叫以簽署及編碼計算的雜湊。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1277">Called to sign and encode a computed hash.</span></span>                                                                                                                                                                                                                                                                                                    |
| [<span data-ttu-id="8a1fc-1278">**PFN \_ CRYPT \_ 驗證編碼的簽章 \_ \_ \_ FUNC**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1278">**PFN\_CRYPT\_VERIFY\_ENCODED\_SIGNATURE\_FUNC**</span></span>](/windows/win32/api/wincrypt/nc-wincrypt-pfn_crypt_verify_encoded_signature_func)                          | <span data-ttu-id="8a1fc-1279">呼叫以解密編碼的簽章，並將其與計算的雜湊進行比較。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1279">Called to decrypt an encoded signature and compare it to a computed hash.</span></span>                                                                                                                                                                                                                                                                     |
| [<span data-ttu-id="8a1fc-1280">**PFN \_ 匯 \_ 入 \_ 公開金鑰 \_ 資訊 \_ EX2 \_ FUNC**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1280">**PFN\_IMPORT\_PUBLIC\_KEY\_INFO\_EX2\_FUNC**</span></span>](/windows/win32/api/wincrypt/nc-wincrypt-pfn_import_public_key_info_ex2_func)                                 | <span data-ttu-id="8a1fc-1281">由 [**CryptImportPublicKeyInfoEx2**](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptimportpublickeyinfoex2) 呼叫以解碼 [*公開金鑰演算法*](../secgloss/p-gly.md) 識別碼、載入演算法提供者，以及匯入 [*金鑰*](../secgloss/k-gly.md)組。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1281">Called by [**CryptImportPublicKeyInfoEx2**](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptimportpublickeyinfoex2) to decode the [*public key algorithm*](../secgloss/p-gly.md) identifier, load the algorithm provider, and import the [*key pair*](../secgloss/k-gly.md).</span></span> |
| [<span data-ttu-id="8a1fc-1282">**PFNCCERTDISPLAYPROC**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1282">**PFNCCERTDISPLAYPROC**</span></span>](pfnccertdisplayproc.md)                                                                       | <span data-ttu-id="8a1fc-1283">使用者定義的回呼函式，可讓 [**CryptUIDlgSelectCertificate**](cryptuidlgselectcertificate.md) 函式的呼叫者處理使用者選取要查看的憑證顯示。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1283">A user-defined callback function that allows the caller of the [**CryptUIDlgSelectCertificate**](cryptuidlgselectcertificate.md) function to handle the display of certificates that the user selects to view.</span></span>                                                                                                                               |
| [<span data-ttu-id="8a1fc-1284">**PFNCMFILTERPROC**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1284">**PFNCMFILTERPROC**</span></span>](/windows/desktop/api/CryptDlg/nc-cryptdlg-pfncmfilterproc)                                                                               | <span data-ttu-id="8a1fc-1285">篩選每個憑證，以決定它是否會顯示在 [**CertSelectCertificate**](/windows/win32/api/cryptdlg/nf-cryptdlg-certselectcertificatea) 函式所顯示的憑證選取對話方塊中。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1285">Filters each certificate to decide if it will appear in the certificate selection dialog box displayed by the [**CertSelectCertificate**](/windows/win32/api/cryptdlg/nf-cryptdlg-certselectcertificatea) function.</span></span>                                                                                                                                                                |
| [<span data-ttu-id="8a1fc-1286">**PFNCMHOOKPROC**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1286">**PFNCMHOOKPROC**</span></span>](/windows/desktop/api/CryptDlg/nc-cryptdlg-pfncmhookproc)                                                                                   | <span data-ttu-id="8a1fc-1287">在 [**CertSelectCertificate**](/windows/win32/api/cryptdlg/nf-cryptdlg-certselectcertificatea) 函式所產生的憑證選取對話方塊處理訊息之前呼叫。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1287">Called before messages are processed by the certificate selection dialog box produced by the [**CertSelectCertificate**](/windows/win32/api/cryptdlg/nf-cryptdlg-certselectcertificatea) function.</span></span>                                                                                                                                                                                 |



 

## <a name="catalog-definition-functions"></a><span data-ttu-id="8a1fc-1288">目錄定義函數</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1288">Catalog Definition Functions</span></span>

<span data-ttu-id="8a1fc-1289">這些函數用來建立目錄。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1289">These functions are used to create a catalog.</span></span> <span data-ttu-id="8a1fc-1290">所有這些函式都是由 [MakeCat](makecat.md)呼叫。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1290">All of these functions are called by [MakeCat](makecat.md).</span></span>

| <span data-ttu-id="8a1fc-1291">函式</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1291">Function</span></span>                                                                           | <span data-ttu-id="8a1fc-1292">描述</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1292">Description</span></span>                                                                                                               |
|------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="8a1fc-1293">**CryptCATCDFClose**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1293">**CryptCATCDFClose**</span></span>](/windows/desktop/api/Mscat/nf-mscat-cryptcatcdfclose)                                       | <span data-ttu-id="8a1fc-1294">關閉目錄定義檔，並釋放對應 [**CRYPTCATCDF**](/windows/win32/api/mscat/ns-mscat-cryptcatcdf) 結構的記憶體。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1294">Closes a catalog definition file and frees the memory for the corresponding [**CRYPTCATCDF**](/windows/win32/api/mscat/ns-mscat-cryptcatcdf) structure.</span></span> |
| [<span data-ttu-id="8a1fc-1295">**CryptCATCDFEnumAttributesWithCDFTag**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1295">**CryptCATCDFEnumAttributesWithCDFTag**</span></span>](cryptcatcdfenumattributeswithcdftag.md) | <span data-ttu-id="8a1fc-1296">列舉 CDF **CatalogFiles** 區段中成員檔案的屬性。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1296">Enumerates the attributes of member files in the **CatalogFiles** section of a CDF.</span></span>                                       |
| [<span data-ttu-id="8a1fc-1297">**CryptCATCDFEnumCatAttributes**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1297">**CryptCATCDFEnumCatAttributes**</span></span>](/windows/desktop/api/Mscat/nf-mscat-cryptcatcdfenumcatattributes)               | <span data-ttu-id="8a1fc-1298">列舉 CDF **CatalogHeader** 區段內的目錄層級屬性。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1298">Enumerates catalog-level attributes within the **CatalogHeader** section of a CDF.</span></span>                                        |
| [<span data-ttu-id="8a1fc-1299">**CryptCATCDFEnumMembersByCDFTagEx**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1299">**CryptCATCDFEnumMembersByCDFTagEx**</span></span>](cryptcatcdfenummembersbycdftagex.md)       | <span data-ttu-id="8a1fc-1300">列舉 CDF **CatalogFiles** 區段中的個別檔案成員。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1300">Enumerates the individual file members in the **CatalogFiles** section of a CDF.</span></span>                                          |
| [<span data-ttu-id="8a1fc-1301">**CryptCATCDFOpen**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1301">**CryptCATCDFOpen**</span></span>](/windows/desktop/api/Mscat/nf-mscat-cryptcatcdfopen)                                         | <span data-ttu-id="8a1fc-1302">開啟現有的 CDF 以讀取和初始化 [**CRYPTCATCDF**](/windows/win32/api/mscat/ns-mscat-cryptcatcdf) 結構。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1302">Opens an existing CDF for reading and initializes a [**CRYPTCATCDF**](/windows/win32/api/mscat/ns-mscat-cryptcatcdf) structure.</span></span>                         |



 

## <a name="catalog-functions"></a><span data-ttu-id="8a1fc-1303">目錄函式</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1303">Catalog Functions</span></span>

<span data-ttu-id="8a1fc-1304">這些函數用來管理目錄。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1304">These functions are used to manage a catalog.</span></span>

| <span data-ttu-id="8a1fc-1305">函式</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1305">Function</span></span>                                                                             | <span data-ttu-id="8a1fc-1306">描述</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1306">Description</span></span>                                                                                                                                                                                                                                                                                                                        |
|--------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="8a1fc-1307">**CryptCATAdminAcquireCoNtext**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1307">**CryptCATAdminAcquireContext**</span></span>](/windows/desktop/api/Mscat/nf-mscat-cryptcatadminacquirecontext)                   | <span data-ttu-id="8a1fc-1308">取得目錄管理員內容的控制碼。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1308">Acquires a handle to a catalog administrator context.</span></span> <span data-ttu-id="8a1fc-1309">後續呼叫 [**CryptCATAdminAddCatalog**](/windows/desktop/api/Mscat/nf-mscat-cryptcatadminaddcatalog)、 [**CryptCATAdminEnumCatalogFromHash**](/windows/desktop/api/Mscat/nf-mscat-cryptcatadminenumcatalogfromhash)和 [**CryptCATAdminRemoveCatalog**](/windows/desktop/api/Mscat/nf-mscat-cryptcatadminremovecatalog) 函式時，可以使用這個控制碼。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1309">This handle can be used by subsequent calls to the [**CryptCATAdminAddCatalog**](/windows/desktop/api/Mscat/nf-mscat-cryptcatadminaddcatalog), [**CryptCATAdminEnumCatalogFromHash**](/windows/desktop/api/Mscat/nf-mscat-cryptcatadminenumcatalogfromhash), and [**CryptCATAdminRemoveCatalog**](/windows/desktop/api/Mscat/nf-mscat-cryptcatadminremovecatalog) functions.</span></span> |
| [<span data-ttu-id="8a1fc-1310">**CryptCATAdminAcquireCoNtext2**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1310">**CryptCATAdminAcquireContext2**</span></span>](/windows/desktop/api/Mscat/nf-mscat-cryptcatadminacquirecontext2)                 | <span data-ttu-id="8a1fc-1311">取得指定雜湊演算法和雜湊原則的目錄管理員內容控制碼。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1311">Acquires a handle to a catalog administrator context for a given hash algorithm and hash policy.</span></span>                                                                                                                                                                                                                                   |
| [<span data-ttu-id="8a1fc-1312">**CryptCATAdminAddCatalog**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1312">**CryptCATAdminAddCatalog**</span></span>](/windows/desktop/api/Mscat/nf-mscat-cryptcatadminaddcatalog)                           | <span data-ttu-id="8a1fc-1313">將目錄新增至目錄資料庫。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1313">Adds a catalog to the catalog database.</span></span>                                                                                                                                                                                                                                                                                            |
| [<span data-ttu-id="8a1fc-1314">**CryptCATAdminCalcHashFromFileHandle**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1314">**CryptCATAdminCalcHashFromFileHandle**</span></span>](/windows/desktop/api/Mscat/nf-mscat-cryptcatadmincalchashfromfilehandle)   | <span data-ttu-id="8a1fc-1315">計算檔案的雜湊。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1315">Calculates the hash for a file.</span></span>                                                                                                                                                                                                                                                                                                    |
| [<span data-ttu-id="8a1fc-1316">**CryptCATAdminCalcHashFromFileHandle2**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1316">**CryptCATAdminCalcHashFromFileHandle2**</span></span>](/windows/desktop/api/Mscat/nf-mscat-cryptcatadmincalchashfromfilehandle2) | <span data-ttu-id="8a1fc-1317">使用指定的演算法來計算檔案的雜湊。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1317">Calculates the hash for a file by using the specified algorithm.</span></span>                                                                                                                                                                                                                                                                   |
| [<span data-ttu-id="8a1fc-1318">**CryptCATAdminEnumCatalogFromHash**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1318">**CryptCATAdminEnumCatalogFromHash**</span></span>](/windows/desktop/api/Mscat/nf-mscat-cryptcatadminenumcatalogfromhash)         | <span data-ttu-id="8a1fc-1319">列舉包含指定雜湊的目錄。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1319">Enumerates the catalogs that contain a specified hash.</span></span>                                                                                                                                                                                                                                                                             |
| [<span data-ttu-id="8a1fc-1320">**CryptCATAdminReleaseCatalogCoNtext**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1320">**CryptCATAdminReleaseCatalogContext**</span></span>](/windows/desktop/api/Mscat/nf-mscat-cryptcatadminreleasecatalogcontext)     | <span data-ttu-id="8a1fc-1321">釋放 [**CryptCATAdminAddCatalog**](/windows/desktop/api/Mscat/nf-mscat-cryptcatadminaddcatalog) 函式先前所傳回的目錄內容控制碼。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1321">Releases a handle to a catalog context previously returned by the [**CryptCATAdminAddCatalog**](/windows/desktop/api/Mscat/nf-mscat-cryptcatadminaddcatalog) function.</span></span>                                                                                                                                                                                             |
| [<span data-ttu-id="8a1fc-1322">**CryptCATAdminReleaseCoNtext**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1322">**CryptCATAdminReleaseContext**</span></span>](/windows/desktop/api/Mscat/nf-mscat-cryptcatadminreleasecontext)                   | <span data-ttu-id="8a1fc-1323">釋放 [**CryptCATAdminAcquireCoNtext**](/windows/desktop/api/Mscat/nf-mscat-cryptcatadminacquirecontext) 函式先前所指派的控制碼。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1323">Releases the handle previously assigned by the [**CryptCATAdminAcquireContext**](/windows/desktop/api/Mscat/nf-mscat-cryptcatadminacquirecontext) function.</span></span>                                                                                                                                                                                                        |
| [<span data-ttu-id="8a1fc-1324">**CryptCATAdminRemoveCatalog**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1324">**CryptCATAdminRemoveCatalog**</span></span>](/windows/desktop/api/Mscat/nf-mscat-cryptcatadminremovecatalog)                     | <span data-ttu-id="8a1fc-1325">刪除類別目錄檔案，並從 Windows 目錄資料庫移除該目錄的專案。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1325">Deletes a catalog file and removes that catalog's entry from the Windows catalog database.</span></span>                                                                                                                                                                                                                                         |
| [<span data-ttu-id="8a1fc-1326">**CryptCATAdminResolveCatalogPath**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1326">**CryptCATAdminResolveCatalogPath**</span></span>](/windows/desktop/api/Mscat/nf-mscat-cryptcatadminresolvecatalogpath)           | <span data-ttu-id="8a1fc-1327">抓取指定之目錄的完整路徑。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1327">Retrieves the fully qualified path of the specified catalog.</span></span>                                                                                                                                                                                                                                                                       |
| [<span data-ttu-id="8a1fc-1328">**CryptCATCatalogInfoFromCoNtext**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1328">**CryptCATCatalogInfoFromContext**</span></span>](/windows/desktop/api/Mscat/nf-mscat-cryptcatcataloginfofromcontext)             | <span data-ttu-id="8a1fc-1329">從指定的目錄內容抓取目錄資訊。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1329">Retrieves catalog information from a specified catalog context.</span></span>                                                                                                                                                                                                                                                                    |
| [<span data-ttu-id="8a1fc-1330">**CryptCATClose**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1330">**CryptCATClose**</span></span>](/windows/desktop/api/Mscat/nf-mscat-cryptcatclose)                                               | <span data-ttu-id="8a1fc-1331">關閉 [**CryptCATOpen**](/windows/desktop/api/Mscat/nf-mscat-cryptcatopen) 函數先前開啟的目錄控制碼。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1331">Closes a catalog handle opened previously by the [**CryptCATOpen**](/windows/desktop/api/Mscat/nf-mscat-cryptcatopen) function.</span></span>                                                                                                                                                                                                                                    |
| [<span data-ttu-id="8a1fc-1332">**CryptCATEnumerateAttr**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1332">**CryptCATEnumerateAttr**</span></span>](/windows/desktop/api/Mscat/nf-mscat-cryptcatenumerateattr)                               | <span data-ttu-id="8a1fc-1333">列舉與目錄成員相關聯的屬性。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1333">Enumerates the attributes associated with a member of a catalog.</span></span>                                                                                                                                                                                                                                                                   |
| [<span data-ttu-id="8a1fc-1334">**CryptCATEnumerateCatAttr**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1334">**CryptCATEnumerateCatAttr**</span></span>](/windows/desktop/api/Mscat/nf-mscat-cryptcatenumeratecatattr)                         | <span data-ttu-id="8a1fc-1335">列舉與目錄相關聯的屬性。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1335">Enumerates the attributes associated with a catalog.</span></span>                                                                                                                                                                                                                                                                               |
| [<span data-ttu-id="8a1fc-1336">**CryptCATEnumerateMember**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1336">**CryptCATEnumerateMember**</span></span>](/windows/desktop/api/Mscat/nf-mscat-cryptcatenumeratemember)                           | <span data-ttu-id="8a1fc-1337">列舉目錄的成員。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1337">Enumerates the members of a catalog.</span></span>                                                                                                                                                                                                                                                                                               |
| [<span data-ttu-id="8a1fc-1338">**CryptCATGetAttrInfo**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1338">**CryptCATGetAttrInfo**</span></span>](/windows/desktop/api/Mscat/nf-mscat-cryptcatgetattrinfo)                                   | <span data-ttu-id="8a1fc-1339">抓取目錄成員之屬性的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1339">Retrieves information about an attribute of a member of a catalog.</span></span>                                                                                                                                                                                                                                                                 |
| [<span data-ttu-id="8a1fc-1340">**CryptCATGetMemberInfo**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1340">**CryptCATGetMemberInfo**</span></span>](/windows/desktop/api/Mscat/nf-mscat-cryptcatgetmemberinfo)                               | <span data-ttu-id="8a1fc-1341">從目錄的 PKCS 7 捕獲成員資訊 \# 。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1341">Retrieves member information from the catalog's PKCS \#7.</span></span> <span data-ttu-id="8a1fc-1342">除了針對指定的參考標記來取得成員資訊之外，此函式也會開啟成員內容。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1342">In addition to retrieving the member information for a specified reference tag, this function opens a member context.</span></span>                                                                                                                                                    |
| [<span data-ttu-id="8a1fc-1343">**CryptCATOpen**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1343">**CryptCATOpen**</span></span>](/windows/desktop/api/Mscat/nf-mscat-cryptcatopen)                                                 | <span data-ttu-id="8a1fc-1344">開啟目錄，並將內容控制碼傳回至開啟的目錄。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1344">Opens a catalog, and returns a context handle to the open catalog.</span></span>                                                                                                                                                                                                                                                                 |
| [<span data-ttu-id="8a1fc-1345">**IsCatalogFile**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1345">**IsCatalogFile**</span></span>](/windows/desktop/api/Mscat/nf-mscat-iscatalogfile)                                               | <span data-ttu-id="8a1fc-1346">抓取布林值，指出指定的檔案是否為類別目錄檔案。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1346">Retrieves a Boolean value that indicates whether the specified file is a catalog file.</span></span>                                                                                                                                                                                                                                             |



 

## <a name="wintrust-functions"></a><span data-ttu-id="8a1fc-1347">WinTrust 函式</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1347">WinTrust Functions</span></span>

<span data-ttu-id="8a1fc-1348">下列函式可用來執行各種信任作業。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1348">The following functions are used to perform various trust operations.</span></span>

| <span data-ttu-id="8a1fc-1349">函式</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1349">Function</span></span>                                                                               | <span data-ttu-id="8a1fc-1350">描述</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1350">Description</span></span>                                                                                                                                                          |
|----------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="8a1fc-1351">**WintrustAddActionID**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1351">**WintrustAddActionID**</span></span>](/windows/desktop/api/Wintrust/nf-wintrust-wintrustaddactionid)                                     | <span data-ttu-id="8a1fc-1352">將信任提供者動作加入使用者的系統中。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1352">Adds a trust provider action to the user's system.</span></span>                                                                                                                   |
| [<span data-ttu-id="8a1fc-1353">**WintrustGetRegPolicyFlags**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1353">**WintrustGetRegPolicyFlags**</span></span>](/windows/desktop/api/Wintrust/nf-wintrust-wintrustgetregpolicyflags)                         | <span data-ttu-id="8a1fc-1354">捕獲原則提供者的原則旗標。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1354">Retrieves policy flags for a policy provider.</span></span>                                                                                                                        |
| [<span data-ttu-id="8a1fc-1355">**WintrustAddDefaultForUsage**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1355">**WintrustAddDefaultForUsage**</span></span>](/windows/desktop/api/Wintrust/nf-wintrust-wintrustadddefaultforusage)                       | <span data-ttu-id="8a1fc-1356">指定提供者的預設使用識別碼和回呼資訊</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1356">Specifies the default usage identifier and callback information for a provider</span></span>                                                                                       |
| [<span data-ttu-id="8a1fc-1357">**WintrustGetDefaultForUsage**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1357">**WintrustGetDefaultForUsage**</span></span>](/windows/desktop/api/Wintrust/nf-wintrust-wintrustgetdefaultforusage)                       | <span data-ttu-id="8a1fc-1358">抓取預設使用識別碼和回呼資訊。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1358">Retrieves the default usage identifier and callback information.</span></span>                                                                                                     |
| [<span data-ttu-id="8a1fc-1359">**WintrustLoadFunctionPointers**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1359">**WintrustLoadFunctionPointers**</span></span>](/windows/desktop/api/Wintrust/nf-wintrust-wintrustloadfunctionpointers)                   | <span data-ttu-id="8a1fc-1360">載入指定動作 GUID 的函式進入點。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1360">Loads function entry points for a specified action GUID.</span></span>                                                                                                             |
| [<span data-ttu-id="8a1fc-1361">**WintrustRemoveActionID**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1361">**WintrustRemoveActionID**</span></span>](/windows/desktop/api/Wintrust/nf-wintrust-wintrustremoveactionid)                               | <span data-ttu-id="8a1fc-1362">移除 [**WintrustAddActionID**](/windows/desktop/api/Wintrust/nf-wintrust-wintrustaddactionid) 函數所加入的動作。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1362">Removes an action added by the [**WintrustAddActionID**](/windows/desktop/api/Wintrust/nf-wintrust-wintrustaddactionid) function.</span></span>                                                                          |
| [<span data-ttu-id="8a1fc-1363">**WintrustSetDefaultIncludePEPageHashes**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1363">**WintrustSetDefaultIncludePEPageHashes**</span></span>](/windows/desktop/api/Wintrust/nf-wintrust-wintrustsetdefaultincludepepagehashes) | <span data-ttu-id="8a1fc-1364">設定預設設定，這個設定會決定建立主體介面封裝時是否包含分頁雜湊， (SIP) 可攜式可執行檔的間接資料。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1364">Sets the default setting that determines whether page hashes are included when creating subject interface package (SIP) indirect data for portable executable files.</span></span> |
| [<span data-ttu-id="8a1fc-1365">**WintrustSetRegPolicyFlags**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1365">**WintrustSetRegPolicyFlags**</span></span>](/windows/desktop/api/Wintrust/nf-wintrust-wintrustsetregpolicyflags)                         | <span data-ttu-id="8a1fc-1366">設定原則提供者的原則旗標。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1366">Sets policy flags for a policy provider.</span></span>                                                                                                                             |
| [<span data-ttu-id="8a1fc-1367">**WinVerifyTrust**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1367">**WinVerifyTrust**</span></span>](/windows/desktop/api/Wintrust/nf-wintrust-winverifytrust)                                               | <span data-ttu-id="8a1fc-1368">在指定的物件上執行信任驗證動作。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1368">Performs a trust verification action on a specified object.</span></span>                                                                                                          |
| [<span data-ttu-id="8a1fc-1369">**WinVerifyTrustEx**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1369">**WinVerifyTrustEx**</span></span>](/windows/desktop/api/Wintrust/nf-wintrust-winverifytrustex)                                           | <span data-ttu-id="8a1fc-1370">在指定的物件上執行信任驗證動作，並採用 WINTRUST \_ 資料結構的指標。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1370">Performs a trust verification action on a specified object and takes a pointer to a WINTRUST\_DATA structure.</span></span>                                                        |
| [<span data-ttu-id="8a1fc-1371">**WTHelperCertCheckValidSignature**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1371">**WTHelperCertCheckValidSignature**</span></span>](/windows/desktop/api/Wintrust/nf-wintrust-wthelpercertcheckvalidsignature)             | <span data-ttu-id="8a1fc-1372">檢查簽章是否有效。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1372">Checks whether a signature is valid.</span></span>                                                                                                                                 |
| [<span data-ttu-id="8a1fc-1373">**WTHelperCertFindIssuerCertificate**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1373">**WTHelperCertFindIssuerCertificate**</span></span>](wthelpercertfindissuercertificate.md)         | <span data-ttu-id="8a1fc-1374">從指定的憑證存放區尋找符合指定主體憑證的簽發者憑證。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1374">Finds an issuer certificate from the specified certificate stores that matches the specified subject certificate.</span></span>                                                    |
| [<span data-ttu-id="8a1fc-1375">**WTHelperCertIsSelfSigned**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1375">**WTHelperCertIsSelfSigned**</span></span>](/windows/desktop/api/Wintrust/nf-wintrust-wthelpercertisselfsigned)                           | <span data-ttu-id="8a1fc-1376">檢查憑證是否為自我簽署。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1376">Checks whether a certificate is self-signed.</span></span>                                                                                                                         |
| [<span data-ttu-id="8a1fc-1377">**WTHelperGetFileHash**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1377">**WTHelperGetFileHash**</span></span>](wthelpergetfilehash.md)                                     | <span data-ttu-id="8a1fc-1378">驗證已簽署檔案的簽章，並取得檔案的雜湊值和演算法識別碼。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1378">Verifies the signature of a signed file and obtains the hash value and algorithm identifier for the file.</span></span>                                                            |
| [<span data-ttu-id="8a1fc-1379">**WTHelperGetProvCertFromChain**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1379">**WTHelperGetProvCertFromChain**</span></span>](/windows/desktop/api/Wintrust/nf-wintrust-wthelpergetprovcertfromchain)                   | <span data-ttu-id="8a1fc-1380">從憑證鏈抓取信任提供者憑證。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1380">Retrieves a trust provider certificate from the certificate chain.</span></span>                                                                                                   |
| [<span data-ttu-id="8a1fc-1381">**WTHelperGetProvPrivateDataFromChain**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1381">**WTHelperGetProvPrivateDataFromChain**</span></span>](/windows/desktop/api/Wintrust/nf-wintrust-wthelpergetprovprivatedatafromchain)     | <span data-ttu-id="8a1fc-1382">使用提供者識別碼，從連結收 [**CRYPT \_ 提供者 \_ PRIVDATA**](/windows/desktop/api/Wintrust/ns-wintrust-crypt_provider_privdata) 結構。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1382">Receives a [**CRYPT\_PROVIDER\_PRIVDATA**](/windows/desktop/api/Wintrust/ns-wintrust-crypt_provider_privdata) structure from the chain by using the provider ID.</span></span>                                           |
| [<span data-ttu-id="8a1fc-1383">**WTHelperGetProvSignerFromChain**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1383">**WTHelperGetProvSignerFromChain**</span></span>](/windows/desktop/api/Wintrust/nf-wintrust-wthelpergetprovsignerfromchain)               | <span data-ttu-id="8a1fc-1384">從鏈中依索引抓取簽署者或 countersigner。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1384">Retrieves a signer or countersigner by index from the chain.</span></span>                                                                                                         |
| [<span data-ttu-id="8a1fc-1385">**WTHelperProvDataFromStateData**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1385">**WTHelperProvDataFromStateData**</span></span>](/windows/desktop/api/Wintrust/nf-wintrust-wthelperprovdatafromstatedata)                 | <span data-ttu-id="8a1fc-1386">從指定的控制碼抓取信任提供者資訊。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1386">Retrieves trust provider information from a specified handle.</span></span>                                                                                                        |



 

## <a name="object-locator-functions"></a><span data-ttu-id="8a1fc-1387">物件定位器函數</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1387">Object Locator Functions</span></span>

<span data-ttu-id="8a1fc-1388">下列回呼函式可以由安全通道所要呼叫的自訂提供者來執行 (Schannel) 安全性封裝以取得憑證。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1388">The following callback functions can be implemented by a custom provider that is intended to be called by the Secure Channel (Schannel) security package to retrieve certificates.</span></span>



| <span data-ttu-id="8a1fc-1389">函式</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1389">Function</span></span>                                                                                                             | <span data-ttu-id="8a1fc-1390">描述</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1390">Description</span></span>                                             |
|----------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------|
| [<span data-ttu-id="8a1fc-1391">**PFN \_ CRYPT \_ 物件 \_ 定位器 \_ 提供者 \_ 排清**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1391">**PFN\_CRYPT\_OBJECT\_LOCATOR\_PROVIDER\_FLUSH**</span></span>](/windows/desktop/api/Wincrypt/nc-wincrypt-pfn_crypt_object_locator_provider_flush)                      | <span data-ttu-id="8a1fc-1392">指定物件已經變更。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1392">Specifies that an object has changed.</span></span>                   |
| [<span data-ttu-id="8a1fc-1393">**PFN \_ CRYPT \_ 物件 \_ 定位器 \_ 提供者 \_ GET**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1393">**PFN\_CRYPT\_OBJECT\_LOCATOR\_PROVIDER\_GET**</span></span>](/windows/desktop/api/Wincrypt/nc-wincrypt-pfn_crypt_object_locator_provider_get)                          | <span data-ttu-id="8a1fc-1394">抓取物件。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1394">Retrieves an object.</span></span>                                    |
| [<span data-ttu-id="8a1fc-1395">**PFN \_ CRYPT \_ 物件 \_ 定位器 \_ 提供者 \_ 版本**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1395">**PFN\_CRYPT\_OBJECT\_LOCATOR\_PROVIDER\_RELEASE**</span></span>](/windows/desktop/api/Wincrypt/nc-wincrypt-pfn_crypt_object_locator_provider_release)                  | <span data-ttu-id="8a1fc-1396">釋放提供者。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1396">Releases the provider.</span></span>                                  |
| [<span data-ttu-id="8a1fc-1397">**PFN \_ CRYPT \_ 物件 \_ 定位器 \_ 提供者 \_ 可用 \_ 密碼**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1397">**PFN\_CRYPT\_OBJECT\_LOCATOR\_PROVIDER\_FREE\_PASSWORD**</span></span>](/windows/desktop/api/Wincrypt/nc-wincrypt-pfn_crypt_object_locator_provider_free_password)     | <span data-ttu-id="8a1fc-1398">釋放用來加密 PFX 位元組陣列的密碼。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1398">Releases the password used to encrypt a PFX byte array.</span></span> |
| [<span data-ttu-id="8a1fc-1399">**PFN \_ CRYPT \_ OBJECT \_ 定位器 \_ PROVIDER \_ FREE**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1399">**PFN\_CRYPT\_OBJECT\_LOCATOR\_PROVIDER\_FREE**</span></span>](/windows/desktop/api/Wincrypt/nc-wincrypt-pfn_crypt_object_locator_provider_free)                        | <span data-ttu-id="8a1fc-1400">釋放提供者所傳回的物件。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1400">Releases the object returned by the provider.</span></span>           |
| [<span data-ttu-id="8a1fc-1401">**PFN \_ CRYPT \_ 物件 \_ 定位器 \_ 提供者 \_ 可用 \_ 識別碼**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1401">**PFN\_CRYPT\_OBJECT\_LOCATOR\_PROVIDER\_FREE\_IDENTIFIER**</span></span>](/windows/desktop/api/Wincrypt/nc-wincrypt-pfn_crypt_object_locator_provider_free_identifier) | <span data-ttu-id="8a1fc-1402">釋放物件識別碼的記憶體。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1402">Releases memory for an object identifier.</span></span>               |
| [<span data-ttu-id="8a1fc-1403">**PFN \_ CRYPT \_ 物件 \_ 定位器 \_ 提供者 \_ 初始化**</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1403">**PFN\_CRYPT\_OBJECT\_LOCATOR\_PROVIDER\_INITIALIZE**</span></span>](/windows/desktop/api/Wincrypt/nc-wincrypt-pfn_crypt_object_locator_provider_initialize)            | <span data-ttu-id="8a1fc-1404">將提供者初始化。</span><span class="sxs-lookup"><span data-stu-id="8a1fc-1404">Initializes the provider.</span></span>                               |



 

 

 
