---
description: 密碼編譯工具提供了命令列工具，可用於程式碼簽署、簽章驗證和其他密碼編譯工作。
ms.assetid: 21adbcfb-fadd-4818-9dc5-23bfd526b525
title: 密碼編譯工具
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 8003bb002bd8d203547779c96bc15491a5418169
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/07/2021
ms.locfileid: "106966699"
---
# <a name="cryptography-tools"></a><span data-ttu-id="2cc2f-103">密碼編譯工具</span><span class="sxs-lookup"><span data-stu-id="2cc2f-103">Cryptography Tools</span></span>

<span data-ttu-id="2cc2f-104">密碼編譯工具提供了命令列工具，可用於程式碼簽署、簽章驗證和其他密碼編譯工作。</span><span class="sxs-lookup"><span data-stu-id="2cc2f-104">Cryptography tools provide command-line tools for code signing, signature verification, and other cryptography tasks.</span></span>

## <a name="introduction-to-code-signing"></a><span data-ttu-id="2cc2f-105">程式碼簽署簡介</span><span class="sxs-lookup"><span data-stu-id="2cc2f-105">Introduction to Code Signing</span></span>

<span data-ttu-id="2cc2f-106">軟體產業必須提供使用者信任程式碼的方法，包括在網際網路上發佈的程式碼。</span><span class="sxs-lookup"><span data-stu-id="2cc2f-106">The software industry must provide users with the means to trust code including code published on the Internet.</span></span> <span data-ttu-id="2cc2f-107">許多網頁都只包含可下載的靜態資訊，而且幾乎沒有風險。</span><span class="sxs-lookup"><span data-stu-id="2cc2f-107">Many webpages contain only static information that can be downloaded with little risk.</span></span> <span data-ttu-id="2cc2f-108">不過，有些頁面包含要在使用者電腦上下載及執行的控制項和應用程式。</span><span class="sxs-lookup"><span data-stu-id="2cc2f-108">Some pages, however, contain controls and applications to be downloaded and run on a user's computer.</span></span> <span data-ttu-id="2cc2f-109">這些可執行檔可能會有風險，可供下載和執行。</span><span class="sxs-lookup"><span data-stu-id="2cc2f-109">These executable files can be risky to download and run.</span></span>

<span data-ttu-id="2cc2f-110">封裝的軟體使用商標與受信任的銷售輸出，確保使用者的完整性，但在網際網路上傳輸程式碼時無法使用這些保證。</span><span class="sxs-lookup"><span data-stu-id="2cc2f-110">Packaged software uses branding and trusted sales outlets to assure users of its integrity, but these guarantees are not available when code is transmitted on the Internet.</span></span> <span data-ttu-id="2cc2f-111">此外，網際網路本身也無法提供軟體建立者身分識別的任何保證。</span><span class="sxs-lookup"><span data-stu-id="2cc2f-111">Additionally, the Internet itself cannot provide any guarantee about the identity of the software creator.</span></span> <span data-ttu-id="2cc2f-112">也不能保證下載的任何軟體在建立之後都不會改變。</span><span class="sxs-lookup"><span data-stu-id="2cc2f-112">Nor can it guarantee that any software downloaded was not altered after its creation.</span></span> <span data-ttu-id="2cc2f-113">瀏覽器可能會顯示警告訊息，說明下載任何種類資料的可能危險，但瀏覽器無法驗證程式代碼是否為其所宣稱的結果。</span><span class="sxs-lookup"><span data-stu-id="2cc2f-113">Browsers can exhibit a warning message that explains the possible dangers of downloading data of any kind, but browsers cannot verify that code is what it claims to be.</span></span> <span data-ttu-id="2cc2f-114">您必須採取更主動的方法，讓網際網路成為發佈軟體的可靠媒體。</span><span class="sxs-lookup"><span data-stu-id="2cc2f-114">A more active approach must be taken to make the Internet a reliable medium for distributing software.</span></span>

<span data-ttu-id="2cc2f-115">有一種方法可保證檔案的真實性和 [*完整性*](../secgloss/i-gly.md) ，會將 [*數位簽章*](../secgloss/d-gly.md) 附加至這些檔案。</span><span class="sxs-lookup"><span data-stu-id="2cc2f-115">One approach to providing guarantees of the authenticity and [*integrity*](../secgloss/i-gly.md) of files is attaching [*digital signatures*](../secgloss/d-gly.md) to those files.</span></span> <span data-ttu-id="2cc2f-116">附加至檔案的數位簽章會以正確的身分識別該檔案的散發者，並確保建立簽章之後，檔案的內容不會變更。</span><span class="sxs-lookup"><span data-stu-id="2cc2f-116">A digital signature attached to a file positively identifies the distributor of that file and ensures that the contents of the file were not changed after the signature was created.</span></span>

<span data-ttu-id="2cc2f-117">您可以使用 Microsoft 的密碼編譯 Api 來建立和驗證數位簽章。</span><span class="sxs-lookup"><span data-stu-id="2cc2f-117">Digital signatures can be created and verified by using Microsoft's cryptography APIs.</span></span> <span data-ttu-id="2cc2f-118">如需密碼編譯和 [*CryptoAPI*](../secgloss/c-gly.md) 函數的背景資訊，請參閱 [密碼編譯基本](cryptography-essentials.md)資訊。</span><span class="sxs-lookup"><span data-stu-id="2cc2f-118">For background information on cryptography and the [*CryptoAPI*](../secgloss/c-gly.md) functions, see [Cryptography Essentials](cryptography-essentials.md).</span></span>

<span data-ttu-id="2cc2f-119">如需 [*數位簽章*](../secgloss/d-gly.md)、 [*憑證*](../secgloss/c-gly.md)和 [*憑證存放區*](../secgloss/c-gly.md)的詳細資訊，請參閱下列主題：</span><span class="sxs-lookup"><span data-stu-id="2cc2f-119">For detailed information on [*digital signatures*](../secgloss/d-gly.md), [*certificates*](../secgloss/c-gly.md), and [*certificate stores*](../secgloss/c-gly.md), see the following topics:</span></span>

-   [<span data-ttu-id="2cc2f-120">雜湊和數位簽章</span><span class="sxs-lookup"><span data-stu-id="2cc2f-120">Hashes and Digital Signatures</span></span>](hashes-and-digital-signatures.md)
-   [<span data-ttu-id="2cc2f-121">數位憑證</span><span class="sxs-lookup"><span data-stu-id="2cc2f-121">Digital Certificates</span></span>](digital-certificates.md)
-   [<span data-ttu-id="2cc2f-122">使用憑證存放區管理憑證</span><span class="sxs-lookup"><span data-stu-id="2cc2f-122">Managing Certificates with Certificate Stores</span></span>](managing-certificates-with-certificate-stores.md)
-   [<span data-ttu-id="2cc2f-123">憑證信任驗證</span><span class="sxs-lookup"><span data-stu-id="2cc2f-123">Certificate Trust Verification</span></span>](certificate-trust-verification.md)

<span data-ttu-id="2cc2f-124">目前，CryptoAPI 工具支援 Microsoft Authenticode 技術，方法是允許軟體廠商簽署下列類型的檔案進行 Authenticode 驗證。</span><span class="sxs-lookup"><span data-stu-id="2cc2f-124">Currently, CryptoAPI Tools supports Microsoft Authenticode technology by allowing software vendors to sign the following types of files for Authenticode verification.</span></span>



| <span data-ttu-id="2cc2f-125">副檔名</span><span class="sxs-lookup"><span data-stu-id="2cc2f-125">File name extension</span></span>                             | <span data-ttu-id="2cc2f-126">目錄</span><span class="sxs-lookup"><span data-stu-id="2cc2f-126">Contents</span></span>                                                                                                                                                                                                                              |
|-------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="2cc2f-127">.appx</span><span class="sxs-lookup"><span data-stu-id="2cc2f-127">.appx</span></span><br/>                                | <span data-ttu-id="2cc2f-128">Windows Store 裝置應用程式的安裝程式檔案。</span><span class="sxs-lookup"><span data-stu-id="2cc2f-128">Installer files for a Windows Store device app.</span></span><br/>                                                                                                                                                                            |
| <span data-ttu-id="2cc2f-129">.cab</span><span class="sxs-lookup"><span data-stu-id="2cc2f-129">.cab</span></span><br/>                                 | <span data-ttu-id="2cc2f-130">獨立檔案，用於應用程式安裝和設定。</span><span class="sxs-lookup"><span data-stu-id="2cc2f-130">Self-contained files used for application installation and setup.</span></span> <span data-ttu-id="2cc2f-131">在封包檔中，會將多個檔案壓縮成一個檔案。</span><span class="sxs-lookup"><span data-stu-id="2cc2f-131">In a cabinet file, multiple files are compressed into one file.</span></span> <span data-ttu-id="2cc2f-132">它們通常位於 Microsoft 軟體散發磁片上。</span><span class="sxs-lookup"><span data-stu-id="2cc2f-132">They are commonly found on Microsoft software distribution disks.</span></span><br/>                        |
| <span data-ttu-id="2cc2f-133">.cat</span><span class="sxs-lookup"><span data-stu-id="2cc2f-133">.cat</span></span><br/>                                 | <span data-ttu-id="2cc2f-134">檔案，其中包含數個檔案的數位 [*指紋*](../secgloss/t-gly.md) 。</span><span class="sxs-lookup"><span data-stu-id="2cc2f-134">Files that contain digital [*thumbprints*](../secgloss/t-gly.md) of several files.</span></span> <span data-ttu-id="2cc2f-135">.Cat 檔案可以用來確保其包含其指紋的檔案完整性。</span><span class="sxs-lookup"><span data-stu-id="2cc2f-135">A .cat file can be used to ensure the integrity of the files whose thumbprints it includes.</span></span><br/> |
| <span data-ttu-id="2cc2f-136">.dll</span><span class="sxs-lookup"><span data-stu-id="2cc2f-136">.dll</span></span><br/>                                 | <span data-ttu-id="2cc2f-137">包含可執行檔的檔案。</span><span class="sxs-lookup"><span data-stu-id="2cc2f-137">Files that contain executable functions.</span></span><br/>                                                                                                                                                                                   |
| <span data-ttu-id="2cc2f-138">.exe</span><span class="sxs-lookup"><span data-stu-id="2cc2f-138">.exe</span></span><br/>                                 | <span data-ttu-id="2cc2f-139">包含可執行程式的檔案。</span><span class="sxs-lookup"><span data-stu-id="2cc2f-139">Files that contain executable programs.</span></span><br/>                                                                                                                                                                                    |
| <span data-ttu-id="2cc2f-140">.js</span><span class="sxs-lookup"><span data-stu-id="2cc2f-140">.js</span></span><br/> <span data-ttu-id="2cc2f-141">.vbs</span><span class="sxs-lookup"><span data-stu-id="2cc2f-141">.vbs</span></span><br/> <span data-ttu-id="2cc2f-142">.wsf</span><span class="sxs-lookup"><span data-stu-id="2cc2f-142">.wsf</span></span><br/>  | <span data-ttu-id="2cc2f-143">JScript 或 Microsoft Visual Basic Scripting Edition (VBScript) 的 Windows shell 檔案。</span><span class="sxs-lookup"><span data-stu-id="2cc2f-143">Windows shell files for JScript or Microsoft Visual Basic Scripting Edition (VBScript).</span></span><br/>                                                                                                                                    |
| <span data-ttu-id="2cc2f-144">.msi</span><span class="sxs-lookup"><span data-stu-id="2cc2f-144">.msi</span></span><br/> <span data-ttu-id="2cc2f-145">.msp</span><span class="sxs-lookup"><span data-stu-id="2cc2f-145">.msp</span></span><br/> <span data-ttu-id="2cc2f-146">.mst</span><span class="sxs-lookup"><span data-stu-id="2cc2f-146">.mst</span></span><br/> | <span data-ttu-id="2cc2f-147">Windows installer 檔案。</span><span class="sxs-lookup"><span data-stu-id="2cc2f-147">Windows installer files.</span></span><br/>                                                                                                                                                                                                   |
| <span data-ttu-id="2cc2f-148">.ocx</span><span class="sxs-lookup"><span data-stu-id="2cc2f-148">.ocx</span></span><br/>                                 | <span data-ttu-id="2cc2f-149">包含 Microsoft ActiveX 控制項的檔案。</span><span class="sxs-lookup"><span data-stu-id="2cc2f-149">Files that contain Microsoft ActiveX controls.</span></span><br/>                                                                                                                                                                             |
| <span data-ttu-id="2cc2f-150">.ps1</span><span class="sxs-lookup"><span data-stu-id="2cc2f-150">.ps1</span></span><br/>                                 | <span data-ttu-id="2cc2f-151">包含 PowerShell 腳本的檔案。</span><span class="sxs-lookup"><span data-stu-id="2cc2f-151">Files that contain PowerShell scripts.</span></span><br/>                                                                                                                                                                                     |
| <span data-ttu-id="2cc2f-152">stl</span><span class="sxs-lookup"><span data-stu-id="2cc2f-152">.stl</span></span><br/>                                 | <span data-ttu-id="2cc2f-153">包含 [*憑證信任清單*](../secgloss/c-gly.md) (CTL) 的檔案。</span><span class="sxs-lookup"><span data-stu-id="2cc2f-153">Files that contain a [*certificate trust list*](../secgloss/c-gly.md) (CTL).</span></span><br/>                                                                           |
| <span data-ttu-id="2cc2f-154">.sys</span><span class="sxs-lookup"><span data-stu-id="2cc2f-154">.sys</span></span><br/>                                 | <span data-ttu-id="2cc2f-155">包含驅動程式二進位檔的檔案。</span><span class="sxs-lookup"><span data-stu-id="2cc2f-155">Files that contain driver binaries.</span></span><br/>                                                                                                                                                                                        |



 

<span data-ttu-id="2cc2f-156">如需有關數位簽章的詳細資訊，請參閱下列檔：</span><span class="sxs-lookup"><span data-stu-id="2cc2f-156">For information about digital signing, see the following documents:</span></span>

-   <span data-ttu-id="2cc2f-157">CCITT、推薦的 x.509、 *Directory-Authentication 架構*、諮詢委員會、國際電話和電報、國際電信聯集、Geneva、1989。</span><span class="sxs-lookup"><span data-stu-id="2cc2f-157">CCITT, Recommendation X.509, *The Directory-Authentication Framework*, Consultation Committee, International Telephone and Telegraph, International Telecommunications Union, Geneva, 1989.</span></span>
-   <span data-ttu-id="2cc2f-158">RSA 實驗室、 *PKCS \# 7：密碼編譯訊息語法標準*。</span><span class="sxs-lookup"><span data-stu-id="2cc2f-158">RSA Laboratories, *PKCS \#7: Cryptographic Message Syntax Standard*.</span></span> <span data-ttu-id="2cc2f-159">1.5、11月、1993版。</span><span class="sxs-lookup"><span data-stu-id="2cc2f-159">Version 1.5, November, 1993.</span></span>
-   <span data-ttu-id="2cc2f-160">Schneier、Bruce、套用的 *密碼* 編譯、2d ed。</span><span class="sxs-lookup"><span data-stu-id="2cc2f-160">Schneier, Bruce, *Applied Cryptography*, 2d ed.</span></span> <span data-ttu-id="2cc2f-161">紐約： John Wiley & 兒子，1996。</span><span class="sxs-lookup"><span data-stu-id="2cc2f-161">New York: John Wiley & Sons, 1996.</span></span>
-   [https://www.rsa.com](https://www.rsa.com/)

> [!Note]  
> <span data-ttu-id="2cc2f-162">這些資源可能無法在某些語言及國家/地區中使用。</span><span class="sxs-lookup"><span data-stu-id="2cc2f-162">These resources may not be available in some languages and countries or regions.</span></span>

 

## <a name="microsoft-cryptography-tools"></a><span data-ttu-id="2cc2f-163">Microsoft 密碼編譯工具</span><span class="sxs-lookup"><span data-stu-id="2cc2f-163">Microsoft Cryptography Tools</span></span>

<span data-ttu-id="2cc2f-164">發行工具和簽署 DLL 安裝在 \\ MICROSOFT SDK 安裝的 Bin 目錄中。</span><span class="sxs-lookup"><span data-stu-id="2cc2f-164">The publishing tools and the signing DLL are installed in the \\Bin directory of your Microsoft SDK installation.</span></span> <span data-ttu-id="2cc2f-165">其中包含下列檔案。</span><span class="sxs-lookup"><span data-stu-id="2cc2f-165">They include the following files.</span></span>



| <span data-ttu-id="2cc2f-166">檔案名稱</span><span class="sxs-lookup"><span data-stu-id="2cc2f-166">File name</span></span>                    | <span data-ttu-id="2cc2f-167">備註</span><span class="sxs-lookup"><span data-stu-id="2cc2f-167">Remarks</span></span>                                                                                                                                                                                             |
|------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="2cc2f-168">Cert2SPC.exe</span><span class="sxs-lookup"><span data-stu-id="2cc2f-168">Cert2SPC.exe</span></span>](cert2spc.md) | <span data-ttu-id="2cc2f-169">只針對測試目的，建立 (SPC) 的 [*軟體發行者憑證*](../secgloss/s-gly.md) 。</span><span class="sxs-lookup"><span data-stu-id="2cc2f-169">Creates an [*Software Publisher Certificate*](../secgloss/s-gly.md) (SPC) for testing purposes only.</span></span><br/> |
| [<span data-ttu-id="2cc2f-170">CertMgr.exe</span><span class="sxs-lookup"><span data-stu-id="2cc2f-170">CertMgr.exe</span></span>](certmgr.md)   | <span data-ttu-id="2cc2f-171">)  (Crl 來管理憑證、Ctl 和 [*憑證撤銷清單*](../secgloss/c-gly.md) 。</span><span class="sxs-lookup"><span data-stu-id="2cc2f-171">Manages certificates, CTLs, and [*certificate revocation lists*](../secgloss/c-gly.md) (CRLs).</span></span><br/>             |
| [<span data-ttu-id="2cc2f-172">MakeCat.exe</span><span class="sxs-lookup"><span data-stu-id="2cc2f-172">MakeCat.exe</span></span>](makecat.md)   | <span data-ttu-id="2cc2f-173">建立未簽署的類別目錄檔案，其中包含一組檔案的雜湊以及每個檔案的相關屬性。</span><span class="sxs-lookup"><span data-stu-id="2cc2f-173">Creates an unsigned catalog file that contains the hashes of a set of files along with associated attributes of each file.</span></span><br/>                                                               |
| [<span data-ttu-id="2cc2f-174">MakeCert.exe</span><span class="sxs-lookup"><span data-stu-id="2cc2f-174">MakeCert.exe</span></span>](makecert.md) | <span data-ttu-id="2cc2f-175">建立僅供測試用途的 [*x.509*](../secgloss/x-gly.md) 憑證。</span><span class="sxs-lookup"><span data-stu-id="2cc2f-175">Creates an [*X.509*](../secgloss/x-gly.md) certificate for testing purposes only.</span></span><br/>                                                                      |
| <span data-ttu-id="2cc2f-176">Pvk2pfx.exe</span><span class="sxs-lookup"><span data-stu-id="2cc2f-176">Pvk2pfx.exe</span></span>                  | <span data-ttu-id="2cc2f-177">將軟體發行者憑證檔案 ( .spc) 或私密金鑰檔案 (. pvk) 轉換成個人資訊交換 (PFX) 檔案格式。</span><span class="sxs-lookup"><span data-stu-id="2cc2f-177">Converts a software publisher certificate file (.spc) or a private key file (.pvk) to Personal Information Exchange (PFX) file format.</span></span><br/>                                                   |
| [<span data-ttu-id="2cc2f-178">SetReg.exe</span><span class="sxs-lookup"><span data-stu-id="2cc2f-178">SetReg.exe</span></span>](setreg.md)     | <span data-ttu-id="2cc2f-179">設定控制憑證驗證的登錄機碼。</span><span class="sxs-lookup"><span data-stu-id="2cc2f-179">Sets registry keys that control certificate verification.</span></span><br/>                                                                                                                                |
| [<span data-ttu-id="2cc2f-180">SignTool.exe</span><span class="sxs-lookup"><span data-stu-id="2cc2f-180">SignTool.exe</span></span>](signtool.md) | <span data-ttu-id="2cc2f-181">簽署檔案並為其加上時間戳記。</span><span class="sxs-lookup"><span data-stu-id="2cc2f-181">Signs and time stamps a file.</span></span> <span data-ttu-id="2cc2f-182">此外，也會檢查檔案的簽章。</span><span class="sxs-lookup"><span data-stu-id="2cc2f-182">Additionally, checks the signature of a file.</span></span><br/>                                                                                                              |



 

 

 
