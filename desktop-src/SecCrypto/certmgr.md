---
description: Certmgr.msc
ms.assetid: c9b68a81-c4f7-4754-9b47-c83f3679f0e3
title: Certmgr.msc
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 9b0e248aef1f726b16d8f17098cfc9642393b963
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/07/2021
ms.locfileid: "104115321"
---
# <a name="certmgr"></a>Certmgr.msc

Certmgr.msc 工具會取代 DumpCert。 它包含管理 [*憑證*](../secgloss/c-gly.md)、 [*憑證信任清單*](../secgloss/c-gly.md) (ctl) 和 [*憑證撤銷清單*](../secgloss/c-gly.md) (crl) 的新功能。 此工具會安裝在 \\ Microsoft Windows 軟體開發套件 (SDK) 安裝路徑的 Bin 資料夾中。

Certmgr.msc 可做為 Windows SDK 的一部分，可供您下載 <https://go.microsoft.com/fwlink/p/?linkid=84091> 。

Certmgr.msc 會根據命令中指出的動作，執行四個函式的其中一個。

**Certmgr.msc** \[**-新增** \|**-del** \|**-put** \]\[  \] 選項 \[**-s** \[**-r** *RegistryLocation* \] \]  \[  \[  *RegistryLocation* \] \] \[ *DestinationName*\]

下表指出 Certmgr.msc 工具的基本動作。



| 動作旗標 | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|-------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 無        | 顯示憑證、Crl 或 Ctl。沒有動作旗標 (若只顯示 *) ，則* [狀態識別碼] 是包含要顯示之專案的憑證存放區或檔案的名稱。 存放區可以是 (StoreFile) 或系統存放區的 [*序列化*](../secgloss/s-gly.md) 存放區。 根據預設，Certmgr.msc 會顯示憑證存放區或檔案中的所有憑證、Ctl 或 Crl。 *DestinationName* 不會用來顯示。<br/>                                                                                                                                                                                                                                                                                                                                  |
| -新增        | 將憑證、Ctl 和 Crl 複製到憑證存放區。當使用 **-add** 時 *，不會* 是包含現有憑證、ctl 和 crl 的來源憑證存放區。 *DestinationName* 是將新增憑證、Ctl 和 crl 的目的地憑證存放區。 除非使用 **-7** 選項，否則目的地存放區會儲存為 [*序列化*](../secgloss/s-gly.md)存放區，這會將存放區儲存為 [*PKCS*](../secgloss/p-gly.md) \# 7 檔案。 請注意，當目的地存放區是系統存放區時，不能使用 **-7** 選項。<br/>                                                                                                                          |
| -del        | 從憑證存放區刪除憑證、Ctl 和 Crl。使用 **-del***時，不* 會發生的情況是包含現有憑證、ctl 和 crl 的來源憑證存放區。 *DestinationName* 是目的地憑證存放區，它會在指定的專案被刪除後，包含其餘憑證、Ctl 和 crl 的複本。 如果未指定 *DestinationName* ，則也會作為目的地存放區， (*它將)* 修改。 除非使用 **-7** 選項，否則目的地存放區會儲存為 [*序列化*](../secgloss/s-gly.md)存放區，這會將存放區儲存為 PKCS \# 7 檔案。 請注意，當目的地存放區是系統存放區時，不能使用 **-7** 選項。<br/> |
| -put        | 將 [*x.509*](../secgloss/x-gly.md) 編碼的憑證、CTL 或 CRL 儲存至檔案。當使用 **-put** 時 *，不會* 是包含現有憑證、ctl 和 crl 的來源憑證存放區。 *DestinationName* 是將儲存 [*x.509*](../secgloss/x-gly.md) 編碼憑證、CTL 和 CRL 的檔案名稱。 如果使用 **-7** 選項，檔案將會儲存為 PKCS \# 7 檔案。<br/>                                                                                                                                                                                                                                                                                             |



 

## <a name="options"></a>選項

下列選項適用于所有的 Certmgr.msc 函式，除非有注明。



| 選項                     | 動作旗標                                 | Description                                                                                                                                                                                                                                        |
|----------------------------|---------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| **-v**                     | 無 (僅顯示)                          | 詳細資訊模式。 顯示憑證、Ctl 和 Crl 的詳細資訊。 預設值是顯示簡短資訊。                                                                                                                       |
| **-c**                     | all                                         | 僅使用憑證。                                                                                                                                                                                                                             |
| **-CTL**                   | all                                         | 僅使用 Ctl。                                                                                                                                                                                                                                     |
| **-CRL**                   | all                                         | 僅使用 Crl。                                                                                                                                                                                                                                     |
| **-all**                   | **-add-del**<br/> **-put**<br/> | 加入所選類型的所有專案。                                                                                                                                                                                                               |
| **-e** *edi.encodingtype*      | all                                         | 憑證 [*編碼類型*](../secgloss/e-gly.md)。                                                                                                                                             |
| **-y** *storeProviderType* | all                                         | 存放區提供者類型。                                                                                                                                                                                                                               |
| **-7**                     | **-add-del**<br/> **-put**<br/> | 將目的地存放區儲存為 PKCS \# 7 檔案。                                                                                                                                                                                                    |
| **-f** *dwFlags*           | all                                         | 儲存開啟旗標。 這是傳遞至 [**CertOpenStore**](/windows/desktop/api/Wincrypt/nf-wincrypt-certopenstore)的 *dwFlags* 參數。 預設值為 [CERT \_ SYSTEM \_ STORE \_ 目前 \_ 使用者]。 只有在設定 **-y** 時才有意義。 如需詳細資訊，請參閱 **CertOpenStore**。         |
| **-n** *commonNameString*  | **-add-del**<br/> **-put**<br/> | 憑證的一般名稱。 只能搭配憑證使用。                                                                                                                                                                                |
| **-sha1** *sha1Hash*       | **-add-del**<br/> **-put**<br/> | 要複製、刪除或儲存的憑證、CTL 或 CRL 的 SHA1 雜湊。                                                                                                                                                                         |
| **-s**                     | all                                         | 指出存放區是系統存放區。                                                                                                                                                                                                        |
| **-r** *registryLocation*  | all                                         | 系統憑證存放區的登錄位置。 只有在設定 **-s** 時才有意義。 必須設定為 *currentUser* (登錄機碼 HKEY \_ 目前 \_ 的使用者) 或 *LOCALMACHINE* (登錄機碼 HKEY \_ 本機 \_ 電腦) 。 預設值為 *currentUser* 。 |
| **-?**                     | all                                         | 顯示所有選項。                                                                                                                                                                                                                          |



 

## <a name="remarks"></a>備註

只有 Internet Explorer 4.0 或更新版本才支援 Certmgr.msc。

Certmgr.msc 可以複製、刪除或儲存一或多個憑證、Ctl 或 Crl。 如果其中一個類別目錄中有多個專案，則使用者有三個選項：

-   使用 **-all** 選項來複製、刪除或儲存指定類別中的所有專案。
-   使用 **-n** 和 **-sha1** 選項來唯一識別要複製、刪除或儲存的專案。
-   如果未指定 **-all** 或 **-n** 和 **-sha1** ，certmgr.msc 會提示使用者提供要複製、刪除或儲存的專案清單。 使用者會輸入要複製、刪除或儲存之專案的索引，以進行回應。

Certmgr.msc 的動作會使用稍微變化的語法和選項。 必須使用動作特定的語法和選項。

Certmgr.msc 適用于兩種類型的憑證存放區： StoreFile 和系統存放區。 StoreFile 可以是下列其中一種檔案類型：

-   編碼的 CTL/CRL/憑證檔案 (可以是以64為基礎的編碼) 
-   PKCS \# 7 檔案
-   簽署的檔
-   序列化的 StoreFile

不需要指定 StoreFile 的類型。 Certmgr.msc 可以決定 StoreFile 類型，並採取適當的動作。

系統存放區是通常位於 **currentUser** 下的登錄中的憑證存放區。 使用者可以藉由只提供名稱來參考系統存放區。 不需要指定憑證存放區提供者類型。 根據 StoreFile 或系統存放區的類型而定，Certmgr.msc 會選擇對應的存放區提供者類型。

## <a name="related-topics"></a>相關主題

<dl> <dt>

[使用 Certmgr.msc](using-certmgr.md)
</dt> </dl>

 

 
