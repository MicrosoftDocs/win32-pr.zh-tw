---
description: ISCrdEnr 所引進的方法如下表所示。
ms.assetid: 471d47c9-8d5a-41f0-9dd1-b6cf1631fed1
title: ISCrdEnr 的方法
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: ce9fe9875b4544201fadaf1287c42a16fd445d38
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/07/2021
ms.locfileid: "106974059"
---
# <a name="methods-of-iscrdenr"></a><span data-ttu-id="ac7d0-103">ISCrdEnr 的方法</span><span class="sxs-lookup"><span data-stu-id="ac7d0-103">Methods of ISCrdEnr</span></span>

<span data-ttu-id="ac7d0-104">[**ISCrdEnr**](iscrdenr.md)所引進的方法如下表所示。</span><span class="sxs-lookup"><span data-stu-id="ac7d0-104">The methods introduced by [**ISCrdEnr**](iscrdenr.md) are listed in the following table.</span></span>



| <span data-ttu-id="ac7d0-105">方法</span><span class="sxs-lookup"><span data-stu-id="ac7d0-105">Method</span></span>                                                                    | <span data-ttu-id="ac7d0-106">描述</span><span class="sxs-lookup"><span data-stu-id="ac7d0-106">Description</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|---------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="ac7d0-107">[**註冊**](/previous-versions/windows/desktop/legacy/aa386564(v=vs.85))</span><span class="sxs-lookup"><span data-stu-id="ac7d0-107">[**enroll**](/previous-versions/windows/desktop/legacy/aa386564(v=vs.85))</span></span>                                         | <span data-ttu-id="ac7d0-108">代表使用者要求憑證，並將產生的 [*憑證*](../secgloss/c-gly.md) 儲存在使用者的 [*智慧卡*](../secgloss/s-gly.md)上。</span><span class="sxs-lookup"><span data-stu-id="ac7d0-108">Requests a certificate on behalf of the user and stores the resulting [*certificate*](../secgloss/c-gly.md) on the user's [*smart card*](../secgloss/s-gly.md).</span></span>                                                                                                                                                                                                                                                    |
| [<span data-ttu-id="ac7d0-109">**enumCAName**</span><span class="sxs-lookup"><span data-stu-id="ac7d0-109">**enumCAName**</span></span>](iscrdenr-enumcaname.md)                                 | <span data-ttu-id="ac7d0-110">針對指定的憑證範本名稱，列舉 (Ca) 的 [*憑證授權單位*](../secgloss/c-gly.md) 單位名稱。</span><span class="sxs-lookup"><span data-stu-id="ac7d0-110">Enumerates the names of the [*certification authorities*](../secgloss/c-gly.md) (CAs) for a given certificate template name.</span></span>                                                                                                                                                                                                                                                                                                           |
| [<span data-ttu-id="ac7d0-111">**enumCertTemplateName**</span><span class="sxs-lookup"><span data-stu-id="ac7d0-111">**enumCertTemplateName**</span></span>](iscrdenr-enumcerttemplatename.md)             | <span data-ttu-id="ac7d0-112">列舉憑證範本名稱。</span><span class="sxs-lookup"><span data-stu-id="ac7d0-112">Enumerates the certificate template names.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| [<span data-ttu-id="ac7d0-113">**enumCSPName**</span><span class="sxs-lookup"><span data-stu-id="ac7d0-113">**enumCSPName**</span></span>](iscrdenr-enumcspname.md)                               | <span data-ttu-id="ac7d0-114">列舉 (Csp) 的可用 [*密碼編譯服務提供者*](../secgloss/c-gly.md) 的名稱。</span><span class="sxs-lookup"><span data-stu-id="ac7d0-114">Enumerates the name of the available [*cryptographic service providers*](../secgloss/c-gly.md) (CSPs).</span></span>                                                                                                                                                                                                                                                                                                                   |
| [<span data-ttu-id="ac7d0-115">**getCACount**</span><span class="sxs-lookup"><span data-stu-id="ac7d0-115">**getCACount**</span></span>](iscrdenr-getcacount.md)                                 | <span data-ttu-id="ac7d0-116">傳回 (Ca 的 [*憑證授權單位*](../secgloss/c-gly.md) 單位數目) 願意根據指定的憑證範本頒發證書。</span><span class="sxs-lookup"><span data-stu-id="ac7d0-116">Returns the number of [*certification authorities*](../secgloss/c-gly.md) (CAs) willing to issue a certificate based on the specified certificate template.</span></span>                                                                                                                                                                                                                                                                            |
| [<span data-ttu-id="ac7d0-117">**getCAName**</span><span class="sxs-lookup"><span data-stu-id="ac7d0-117">**getCAName**</span></span>](iscrdenr-getcaname.md)                                   | <span data-ttu-id="ac7d0-118">取得指定憑證範本的指定 CA 名稱。</span><span class="sxs-lookup"><span data-stu-id="ac7d0-118">Retrieves the name of the specified CA for a given certificate template.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| [<span data-ttu-id="ac7d0-119">**getCertTemplateCount**</span><span class="sxs-lookup"><span data-stu-id="ac7d0-119">**getCertTemplateCount**</span></span>](iscrdenr-getcerttemplatecount.md)             | <span data-ttu-id="ac7d0-120">抓取憑證範本的數目。</span><span class="sxs-lookup"><span data-stu-id="ac7d0-120">Retrieves the number of certificate templates.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| [<span data-ttu-id="ac7d0-121">**getCertTemplateName**</span><span class="sxs-lookup"><span data-stu-id="ac7d0-121">**getCertTemplateName**</span></span>](iscrdenr-getcerttemplatename.md)               | <span data-ttu-id="ac7d0-122">抓取憑證範本的名稱。</span><span class="sxs-lookup"><span data-stu-id="ac7d0-122">Retrieves the name of the certificate template.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| [<span data-ttu-id="ac7d0-123">**getCertTemplateSMIME**</span><span class="sxs-lookup"><span data-stu-id="ac7d0-123">**getCertTemplateSMIME**</span></span>](iscrdenr-getcerttemplatesmime.md)             | <span data-ttu-id="ac7d0-124">判斷憑證範本是否包含 szOID PKIX 的 \_ \_ \_ 電子郵件 \_ 保護金鑰使用方式。</span><span class="sxs-lookup"><span data-stu-id="ac7d0-124">Determines if a certificate template contains the szOID\_PKIX\_KP\_EMAIL\_PROTECTION key usage.</span></span> <span data-ttu-id="ac7d0-125">如果此金鑰使用方式是憑證範本的一部分，憑證範本支援 [*安全/多用途網際網路郵件延伸*](../secgloss/s-gly.md) (S/MIME) 作業。</span><span class="sxs-lookup"><span data-stu-id="ac7d0-125">If this key usage is part of the certificate template, the certificate template supports [*Secure/Multipurpose Internet Mail Extensions*](../secgloss/s-gly.md) (S/MIME) operations.</span></span>                                                                                                         |
| [<span data-ttu-id="ac7d0-126">**getEnrolledCertificateName**</span><span class="sxs-lookup"><span data-stu-id="ac7d0-126">**getEnrolledCertificateName**</span></span>](iscrdenr-getenrolledcertificatename.md) | <span data-ttu-id="ac7d0-127">抓取 [**ISCrdEnr：：註冊**](/previous-versions/windows/desktop/legacy/aa386564(v=vs.85))的先前成功呼叫所產生的憑證名稱。</span><span class="sxs-lookup"><span data-stu-id="ac7d0-127">Retrieves the name of the certificate resulting from an earlier successful call to [**ISCrdEnr::enroll**](/previous-versions/windows/desktop/legacy/aa386564(v=vs.85)).</span></span> <span data-ttu-id="ac7d0-128">這個方法也可以用來在對話方塊中顯示憑證。</span><span class="sxs-lookup"><span data-stu-id="ac7d0-128">This method can also be used to display the certificate in a dialog box.</span></span> <span data-ttu-id="ac7d0-129">這個方法會呼叫 [*CryptoAPI*](../secgloss/c-gly.md) 函數 [**CertGetNameString**](/windows/desktop/api/Wincrypt/nf-wincrypt-certgetnamestringa)。</span><span class="sxs-lookup"><span data-stu-id="ac7d0-129">This method calls the [*CryptoAPI*](../secgloss/c-gly.md) function [**CertGetNameString**](/windows/desktop/api/Wincrypt/nf-wincrypt-certgetnamestringa).</span></span>                                                                                                                                        |
| [<span data-ttu-id="ac7d0-130">**getSigningCertificateName**</span><span class="sxs-lookup"><span data-stu-id="ac7d0-130">**getSigningCertificateName**</span></span>](iscrdenr-getsigningcertificatename.md)   | <span data-ttu-id="ac7d0-131">從簽署憑證抓取主體名稱。</span><span class="sxs-lookup"><span data-stu-id="ac7d0-131">Retrieves the subject name from the signing certificate.</span></span> <span data-ttu-id="ac7d0-132">這個方法也可以用來在對話方塊中顯示憑證。</span><span class="sxs-lookup"><span data-stu-id="ac7d0-132">This method can also be used to display the certificate in a dialog box.</span></span> <span data-ttu-id="ac7d0-133">這個方法會呼叫 [*CryptoAPI*](../secgloss/c-gly.md) 函數 [**CertGetNameString**](/windows/desktop/api/Wincrypt/nf-wincrypt-certgetnamestringa)。</span><span class="sxs-lookup"><span data-stu-id="ac7d0-133">This method calls the [*CryptoAPI*](../secgloss/c-gly.md) function [**CertGetNameString**](/windows/desktop/api/Wincrypt/nf-wincrypt-certgetnamestringa).</span></span>                                                                                                                                                                                                               |
| [<span data-ttu-id="ac7d0-134">**getUserName**</span><span class="sxs-lookup"><span data-stu-id="ac7d0-134">**getUserName**</span></span>](iscrdenr-getusername.md)                               | <span data-ttu-id="ac7d0-135">抓取要作為憑證註冊目標之使用者的名稱。</span><span class="sxs-lookup"><span data-stu-id="ac7d0-135">Retrieves the name of the user on whose behalf the certificate enrollment is intended.</span></span> <span data-ttu-id="ac7d0-136">在呼叫這個方法之前，您必須在 [**ISCrdEnr：： selectUserName**](iscrdenr-selectusername.md) 或 [**ISCrdEnr：： setUserName**](iscrdenr-setusername.md)的呼叫中指定使用者名稱。</span><span class="sxs-lookup"><span data-stu-id="ac7d0-136">Before calling this method, you must specify the user name in a call to [**ISCrdEnr::selectUserName**](iscrdenr-selectusername.md) or [**ISCrdEnr::setUserName**](iscrdenr-setusername.md).</span></span>                                                                                                                                                                                                                         |
| [<span data-ttu-id="ac7d0-137">**resetUser**</span><span class="sxs-lookup"><span data-stu-id="ac7d0-137">**resetUser**</span></span>](iscrdenr-resetuser.md)                                   | <span data-ttu-id="ac7d0-138">從智慧卡控制項清除使用者名稱。</span><span class="sxs-lookup"><span data-stu-id="ac7d0-138">Clears the user name from the smart card control.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| [<span data-ttu-id="ac7d0-139">**selectSigningCertificate**</span><span class="sxs-lookup"><span data-stu-id="ac7d0-139">**selectSigningCertificate**</span></span>](iscrdenr-selectsigningcertificate.md)     | <span data-ttu-id="ac7d0-140">顯示 [ **選取憑證** ] 對話方塊，允許簽署憑證 (也稱為 *註冊代理程式憑證*) 選取。</span><span class="sxs-lookup"><span data-stu-id="ac7d0-140">Displays a **Select Certificate** dialog box, allowing a signing certificate (also known as the *enrollment agent certificate*) to be selected.</span></span> <span data-ttu-id="ac7d0-141">代表使用者註冊之前，您必須先選取簽署憑證。</span><span class="sxs-lookup"><span data-stu-id="ac7d0-141">Before enrolling on behalf of users, you must select a signing certificate.</span></span> <span data-ttu-id="ac7d0-142">與此簽署憑證相關聯的 [*私密金鑰*](../secgloss/p-gly.md) 會用來簽署 PKCS \# 7 要求。</span><span class="sxs-lookup"><span data-stu-id="ac7d0-142">The [*private key*](../secgloss/p-gly.md) associated with this signing certificate is used to sign a PKCS \#7 request.</span></span> <span data-ttu-id="ac7d0-143">PKCS \# 7 接著會包含使用者的 pkcs \# 10 要求 (使用) 的使用者私密金鑰進行簽署。</span><span class="sxs-lookup"><span data-stu-id="ac7d0-143">The PKCS \#7, in turn, contains the user's PKCS \#10 request (which is signed with the user's private key).</span></span> |
| [<span data-ttu-id="ac7d0-144">**selectUserName**</span><span class="sxs-lookup"><span data-stu-id="ac7d0-144">**selectUserName**</span></span>](iscrdenr-selectusername.md)                         | <span data-ttu-id="ac7d0-145">顯示 **選取的使用者** 介面，允許選取使用者名稱。</span><span class="sxs-lookup"><span data-stu-id="ac7d0-145">Displays a **Select User** interface, allowing a user name to be selected.</span></span> <span data-ttu-id="ac7d0-146">使用者名稱會套用至代表憑證註冊的使用者。</span><span class="sxs-lookup"><span data-stu-id="ac7d0-146">The user name applies to the user on whose behalf the certificate enrollment is intended.</span></span>                                                                                                                                                                                                                                                                                                                                         |
| [<span data-ttu-id="ac7d0-147">**setCAName**</span><span class="sxs-lookup"><span data-stu-id="ac7d0-147">**setCAName**</span></span>](iscrdenr-setcaname.md)                                   | <span data-ttu-id="ac7d0-148">指定 CA 的名稱。</span><span class="sxs-lookup"><span data-stu-id="ac7d0-148">Specifies the name of the CA.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| [<span data-ttu-id="ac7d0-149">**setCertTemplateName**</span><span class="sxs-lookup"><span data-stu-id="ac7d0-149">**setCertTemplateName**</span></span>](iscrdenr-setcerttemplatename.md)               | <span data-ttu-id="ac7d0-150">指定憑證範本的名稱。</span><span class="sxs-lookup"><span data-stu-id="ac7d0-150">Specifies the name of the certificate template.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| [<span data-ttu-id="ac7d0-151">**setSigningCertificate**</span><span class="sxs-lookup"><span data-stu-id="ac7d0-151">**setSigningCertificate**</span></span>](iscrdenr-setsigningcertificate.md)           | <span data-ttu-id="ac7d0-152">指定簽署憑證 (也稱為 *註冊代理程式憑證*) 。</span><span class="sxs-lookup"><span data-stu-id="ac7d0-152">Specifies a signing certificate (also known as the *enrollment agent certificate*).</span></span> <span data-ttu-id="ac7d0-153">代表使用者註冊之前，您必須選取或設定簽署憑證。</span><span class="sxs-lookup"><span data-stu-id="ac7d0-153">Before enrolling on behalf of users, you must select or set a signing certificate.</span></span> <span data-ttu-id="ac7d0-154">與此簽署憑證相關聯的 [*私密金鑰*](../secgloss/p-gly.md) 會用來簽署 PKCS \# 7 要求。</span><span class="sxs-lookup"><span data-stu-id="ac7d0-154">The [*private key*](../secgloss/p-gly.md) associated with this signing certificate is used to sign a PKCS \#7 request.</span></span> <span data-ttu-id="ac7d0-155">PKCS \# 7 接著會包含使用者的 pkcs \# 10 要求 (使用) 的使用者私密金鑰進行簽署。</span><span class="sxs-lookup"><span data-stu-id="ac7d0-155">The PKCS \#7, in turn, contains the user's PKCS \#10 request (which is signed with the user's private key).</span></span>                                                      |
| [<span data-ttu-id="ac7d0-156">**setUserName**</span><span class="sxs-lookup"><span data-stu-id="ac7d0-156">**setUserName**</span></span>](iscrdenr-setusername.md)                               | <span data-ttu-id="ac7d0-157">指定要在其上註冊憑證的使用者名稱。</span><span class="sxs-lookup"><span data-stu-id="ac7d0-157">Specifies the name of the user on whose behalf the certificate enrollment is intended.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                       |



 

 

 
