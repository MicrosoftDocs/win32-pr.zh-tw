---
description: 憑證註冊控制項可供必須要求將憑證發行至已命名主體的應用程式使用。
ms.assetid: ce6661b0-7ed2-452f-a54c-6705d14f3298
title: 憑證註冊控制項
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e417a9db7984cbb58b7c2e3b51d828b6d61a97b6
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/07/2021
ms.locfileid: "106971195"
---
# <a name="certificate-enrollment-control"></a><span data-ttu-id="b8aba-103">憑證註冊控制項</span><span class="sxs-lookup"><span data-stu-id="b8aba-103">Certificate Enrollment Control</span></span>

<span data-ttu-id="b8aba-104">憑證註冊控制項可供必須要求將憑證發行至已命名主體的應用程式使用。</span><span class="sxs-lookup"><span data-stu-id="b8aba-104">Certificate Enrollment Control can be used by an application that must request that a certificate be issued to a named subject.</span></span> <span data-ttu-id="b8aba-105">它是設計來接受二進位字串格式的資料， (BSTR) 。</span><span class="sxs-lookup"><span data-stu-id="b8aba-105">It is designed to accept data in the form of a binary string (BSTR).</span></span> <span data-ttu-id="b8aba-106">資料可能來自于網頁，或是來自 Visual Basic 或 Visual C++ 開發系統的使用者介面。</span><span class="sxs-lookup"><span data-stu-id="b8aba-106">The data can come from a webpage or from the user interface of the Visual Basic or Visual C++ development system.</span></span> <span data-ttu-id="b8aba-107">憑證註冊控制項的輸出是 PKCS \# 10 憑證要求，可 (CA) 傳送給 [*憑證授權單位*](../secgloss/c-gly.md) 單位。</span><span class="sxs-lookup"><span data-stu-id="b8aba-107">The output from the Certificate Enrollment Control is a PKCS \#10 certificate request that can be sent on to a [*certification authority*](../secgloss/c-gly.md) (CA).</span></span>

![憑證註冊控制項](images/xen-arch.png)

<span data-ttu-id="b8aba-109">有關使用者的必要資訊（憑證主體）是由消費者介面所收集。</span><span class="sxs-lookup"><span data-stu-id="b8aba-109">Necessary information about the user, the certificate subject, is collected by the User Interface.</span></span> <span data-ttu-id="b8aba-110">這項資訊是以 BSTR 輸入的形式提供給憑證註冊控制項。</span><span class="sxs-lookup"><span data-stu-id="b8aba-110">This information is provided as a BSTR input to the Certificate Enrollment Control.</span></span> <span data-ttu-id="b8aba-111">憑證註冊控制項會產生適當的簽章金鑰、金鑰交換金鑰或這兩個金鑰組。</span><span class="sxs-lookup"><span data-stu-id="b8aba-111">The Certificate Enrollment Control generates the appropriate signature key, key exchange key, or both key pairs.</span></span> <span data-ttu-id="b8aba-112">然後，控制項會 \# 使用產生的 [*私密金鑰*](../secgloss/p-gly.md)來產生和簽署 PKCS 10 [*憑證要求*](../secgloss/c-gly.md)。</span><span class="sxs-lookup"><span data-stu-id="b8aba-112">The control then generates and signs a PKCS \#10 [*certificate request*](../secgloss/c-gly.md) by using the generated [*private key*](../secgloss/p-gly.md).</span></span> <span data-ttu-id="b8aba-113">憑證註冊控制項會將金鑰組連結至暫存的虛擬憑證，該憑證會儲存在要求存放區，直到從憑證授權單位單位傳回發行的憑證為止。</span><span class="sxs-lookup"><span data-stu-id="b8aba-113">The Certificate Enrollment Control then links the key pair to a temporary dummy certificate which is stored in the request store until the issued certificate is returned from a certification authority.</span></span> <span data-ttu-id="b8aba-114">最後，應用程式會將 PKCS \# 10 憑證要求傳送給 CA。</span><span class="sxs-lookup"><span data-stu-id="b8aba-114">Finally, the application sends the PKCS \#10 certificate request to a CA.</span></span>

<span data-ttu-id="b8aba-115">如果 CA 核准憑證要求，CA 就會建立包含公開金鑰的憑證。</span><span class="sxs-lookup"><span data-stu-id="b8aba-115">If the CA approves the certificate request, the CA creates a certificate containing the public key.</span></span> <span data-ttu-id="b8aba-116">CA 也會簽署並傳回憑證。</span><span class="sxs-lookup"><span data-stu-id="b8aba-116">The CA also signs and returns the certificate.</span></span>

<span data-ttu-id="b8aba-117">從 CA 傳回所要求的憑證時，應用程式會將 PKCS \# 7 訊息傳回給憑證註冊控制項，其中憑證或憑證鏈會從 PKCS \# 7 訊息解壓縮。</span><span class="sxs-lookup"><span data-stu-id="b8aba-117">When the requested certificate is returned from the CA, the application passes the PKCS \#7 message back to the Certificate Enrollment Control where the certificate or chain of certificates is extracted from the PKCS \#7 message.</span></span> <span data-ttu-id="b8aba-118">憑證和信任鏈中的任何其他憑證都會儲存在 [*憑證存放區*](../secgloss/c-gly.md)中。</span><span class="sxs-lookup"><span data-stu-id="b8aba-118">The certificate and any other certificates in the chain of trust are stored in a [*certificate store*](../secgloss/c-gly.md).</span></span> <span data-ttu-id="b8aba-119">傳回的憑證不會以任何方式修改。</span><span class="sxs-lookup"><span data-stu-id="b8aba-119">The returned certificate is not modified in any way.</span></span> <span data-ttu-id="b8aba-120">任何憑證感知的應用程式現在都可以從存放區存取此憑證。</span><span class="sxs-lookup"><span data-stu-id="b8aba-120">Any certificate-aware application can now access this certificate from the store.</span></span>

<span data-ttu-id="b8aba-121">系統管理員會使用智慧卡註冊控制來代表智慧卡使用者進行註冊。</span><span class="sxs-lookup"><span data-stu-id="b8aba-121">Smart Card Enrollment Control is used by an administrator to enroll on behalf of smart card users.</span></span> <span data-ttu-id="b8aba-122">註冊程式會導致發行的憑證儲存在使用者的智慧卡上。</span><span class="sxs-lookup"><span data-stu-id="b8aba-122">The enrollment process results in a certificate being issued that is stored on a user's smart card.</span></span>

<span data-ttu-id="b8aba-123">智慧卡註冊控制項包含在 Scrdenrl.dll 中，其中包含一個 **SCrdEnr** 的物件。</span><span class="sxs-lookup"><span data-stu-id="b8aba-123">The Smart Card Enrollment Control is contained in Scrdenrl.dll and consists of one object, **SCrdEnr**.</span></span> <span data-ttu-id="b8aba-124">Scrdenrl.dll 中不包含其他物件。</span><span class="sxs-lookup"><span data-stu-id="b8aba-124">No other objects are included in Scrdenrl.dll.</span></span> <span data-ttu-id="b8aba-125">此智慧卡註冊物件可以與指令碼語言搭配使用，例如 Visual Basic Scripting Edition (VBScript) 。</span><span class="sxs-lookup"><span data-stu-id="b8aba-125">This Smart Card Enrollment object can be used with a script language, such as Visual Basic Scripting Edition (VBScript).</span></span>

<span data-ttu-id="b8aba-126">執行智慧卡註冊控制項的電腦上必須安裝 [*智慧卡讀卡機*](../secgloss/r-gly.md) 。</span><span class="sxs-lookup"><span data-stu-id="b8aba-126">A [*smart card reader*](../secgloss/r-gly.md) must be installed on the computer running the Smart Card Enrollment Control.</span></span>

<span data-ttu-id="b8aba-127">此外，智慧卡簽發者必須取得以 "EnrollmentAgent" 憑證範本為基礎的簽署憑證。</span><span class="sxs-lookup"><span data-stu-id="b8aba-127">Additionally, the smart card issuer must have obtained a signing certificate based on the "EnrollmentAgent" certificate template.</span></span> <span data-ttu-id="b8aba-128">此簽署憑證將用來代表智慧卡收件者簽署產生的憑證要求。</span><span class="sxs-lookup"><span data-stu-id="b8aba-128">This signing certificate will be used to sign the certificate request generated on behalf of the smart card recipient.</span></span> <span data-ttu-id="b8aba-129">根據預設，網域系統管理員會被授與根據「註冊代理程式」範本要求憑證的許可權。</span><span class="sxs-lookup"><span data-stu-id="b8aba-129">By default, domain administrators are granted permission to request a certificate based on the "Enrollment Agent" template.</span></span> <span data-ttu-id="b8aba-130">另一位使用者也可以透過 Active Directory 網站和服務 MMC 嵌入式管理單元) ，授與註冊「EnrollmentAgent」憑證 (的許可權;不過，這樣做可讓這位使用者使用網域系統管理員許可權自行發出智慧卡。</span><span class="sxs-lookup"><span data-stu-id="b8aba-130">Another user can be granted permission to enroll for an "EnrollmentAgent" certificate (by means of the Active Directory Sites and Services MMC snap-in); doing so, however, allows this user to self-issue a smart card with domain administrator privileges.</span></span>

 

 
