---
description: 媒介會與用戶端應用程式通訊，以允許它們提交憑證要求，並 (假設要求產生已發行的憑證) 將發行的憑證下載至用戶端。
ms.assetid: c696f09e-98d3-4cea-8ea1-cd8f40b74f12
title: 媒介
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 040e79abb03bd0363d37fdad79f7311412b0ffe2
ms.sourcegitcommit: c16214e53680dc71d1c07111b51f72b82a4512d8
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 03/03/2021
ms.locfileid: "106976625"
---
# <a name="intermediaries"></a><span data-ttu-id="bfdd9-103">媒介</span><span class="sxs-lookup"><span data-stu-id="bfdd9-103">Intermediaries</span></span>

<span data-ttu-id="bfdd9-104">媒介會與用戶端應用程式通訊，以允許它們提交 [*憑證要求*](../secgloss/c-gly.md)，並 (假設要求產生已發行的憑證) 將發行的憑證下載至用戶端。</span><span class="sxs-lookup"><span data-stu-id="bfdd9-104">Intermediaries communicate with client applications to allow them to submit [*certificate requests*](../secgloss/c-gly.md), and (assuming that the request results in an issued certificate) to download the issued certificate to the client.</span></span> <span data-ttu-id="bfdd9-105">每個傳輸層通訊協定都需要自己的媒介。</span><span class="sxs-lookup"><span data-stu-id="bfdd9-105">Each transport layer protocol requires its own intermediary.</span></span>

<span data-ttu-id="bfdd9-106">Microsoft 憑證服務隨附的中繼 () for HTTP 的網頁註冊頁面。</span><span class="sxs-lookup"><span data-stu-id="bfdd9-106">Microsoft Certificate Services ships with an intermediary (the web enrollment pages) for HTTP.</span></span> <span data-ttu-id="bfdd9-107">媒介的另一個範例是 Microsoft Windows 憑證 MMC 嵌入式管理單元， (可讓您) 叫用憑證要求 Wizard。</span><span class="sxs-lookup"><span data-stu-id="bfdd9-107">Another example of an intermediary is the Microsoft Windows Certificates MMC snap-in (which allows the Certificate Request Wizard to be invoked).</span></span> <span data-ttu-id="bfdd9-108">如果有其他傳輸層通訊協定與憑證服務搭配使用，開發人員可以為每個所需的傳輸層通訊協定建立媒介。</span><span class="sxs-lookup"><span data-stu-id="bfdd9-108">If other transport layer protocols are to be used with Certificate Services, a developer can create an intermediary for each desired transport layer protocol.</span></span>

<span data-ttu-id="bfdd9-109">媒介會使用伺服器引擎所提供的 [**ICertRequest**](/windows/desktop/api/Certcli/nn-certcli-icertrequest) 和 [**ICertConfig**](/windows/desktop/api/Certcli/nn-certcli-icertconfig) 介面，與憑證服務進行通訊。</span><span class="sxs-lookup"><span data-stu-id="bfdd9-109">Intermediaries communicate with Certificate Services using the [**ICertRequest**](/windows/desktop/api/Certcli/nn-certcli-icertrequest) and [**ICertConfig**](/windows/desktop/api/Certcli/nn-certcli-icertconfig) interfaces provided by the server engine.</span></span> <span data-ttu-id="bfdd9-110">[**ICertRequest：： submit**](/windows/desktop/api/Certcli/nf-certcli-icertrequest-submit)方法可用來提交 [*憑證要求*](../secgloss/c-gly.md)，而 [**ICertRequest：： GetCertificate**](/windows/desktop/api/Certcli/nf-certcli-icertrequest-getcertificate)用來取得所產生的已發行憑證。</span><span class="sxs-lookup"><span data-stu-id="bfdd9-110">The [**ICertRequest::Submit**](/windows/desktop/api/Certcli/nf-certcli-icertrequest-submit) method is used to submit a [*certificate request*](../secgloss/c-gly.md), and [**ICertRequest::GetCertificate**](/windows/desktop/api/Certcli/nf-certcli-icertrequest-getcertificate) is used to get the resulting issued certificate.</span></span> <span data-ttu-id="bfdd9-111">同樣地， [**ICertConfig：： GetConfig**](/windows/desktop/api/Certcli/nf-certcli-icertconfig-getconfig) 可用來判斷可用來發行憑證的憑證授權單位單位。</span><span class="sxs-lookup"><span data-stu-id="bfdd9-111">Similarly, [**ICertConfig::GetConfig**](/windows/desktop/api/Certcli/nf-certcli-icertconfig-getconfig) is used to determine which certification authority can be used to issue the certificate.</span></span>

<span data-ttu-id="bfdd9-112">媒介與語言無關。</span><span class="sxs-lookup"><span data-stu-id="bfdd9-112">An intermediary is not language-dependent.</span></span> <span data-ttu-id="bfdd9-113">它可能是以 c + +、Visual Basic、JAVA、腳本或其他語言撰寫的程式。</span><span class="sxs-lookup"><span data-stu-id="bfdd9-113">It may be a program written in C++, Visual Basic, Java, script, or another language.</span></span>

<span data-ttu-id="bfdd9-114">除了從用戶端收集資料以建立憑證要求之外，媒介還可以指定要求屬性。</span><span class="sxs-lookup"><span data-stu-id="bfdd9-114">In addition to gathering data from the client to build a certificate request, an intermediary may specify request attributes.</span></span> <span data-ttu-id="bfdd9-115">提交給執行企業原則模組之 [*憑證授權單位*](../secgloss/c-gly.md) 單位的要求，必須透過在要求本身中指定 "CertificateTemplate" 屬性或憑證範本延伸來指出所要求的憑證類型。</span><span class="sxs-lookup"><span data-stu-id="bfdd9-115">Requests submitted to a [*certification authority*](../secgloss/c-gly.md) running the enterprise policy module must indicate the type of certificate requested by specifying either a "CertificateTemplate" attribute or a Certificate Template extension in the request itself.</span></span>

<span data-ttu-id="bfdd9-116">請注意，在建立憑證要求期間，開發人員 (和媒介) 負責維護私密金鑰的密碼。</span><span class="sxs-lookup"><span data-stu-id="bfdd9-116">Note that during the creation of a certificate request, developers (and intermediaries) are responsible for maintaining the secrecy of the private key.</span></span> <span data-ttu-id="bfdd9-117">私密金鑰遭入侵之後 (遺失其秘密) ，就沒有用處。</span><span class="sxs-lookup"><span data-stu-id="bfdd9-117">After a private key has been compromised (lost its secrecy), it is useless.</span></span>

<span data-ttu-id="bfdd9-118">憑證服務網頁註冊頁面會使用 [憑證註冊介面](cryptography-interfaces.md)，藉由在工作站上產生金鑰來保護私密金鑰。</span><span class="sxs-lookup"><span data-stu-id="bfdd9-118">The Certificate Services web enrollment pages use the [Certificate Enrollment Interfaces](cryptography-interfaces.md), which protects private keys by generating them on the workstation.</span></span> <span data-ttu-id="bfdd9-119">除了維護私密金鑰的密碼，憑證註冊控制項還允許媒介指定密碼編譯服務提供者、金鑰規格、金鑰強度和雜湊演算法。</span><span class="sxs-lookup"><span data-stu-id="bfdd9-119">In addition to maintaining the secrecy of the private key, the Certificate Enrollment Control allows an intermediary to specify the Cryptographic Service Provider, key specification, key strength, and hash algorithm.</span></span>

<span data-ttu-id="bfdd9-120">憑證 MMC 嵌入式管理單元也會使用憑證註冊控制項 (Xenroll.dll) 。</span><span class="sxs-lookup"><span data-stu-id="bfdd9-120">The Certificates MMC snap-in also uses the Certificate Enrollment Control (Xenroll.dll).</span></span> <span data-ttu-id="bfdd9-121">但是，憑證服務網頁註冊頁面會在需要時將憑證註冊控制資源 (Xenroll.dll) 下載至用戶端，而憑證 MMC 嵌入式管理單元則是在 Xenroll.dll 已是可用資源的環境中執行。</span><span class="sxs-lookup"><span data-stu-id="bfdd9-121">However, where the Certificate Services web enrollment pages cause the Certificate Enrollment Control resource (Xenroll.dll) to be downloaded to the client if needed, the Certificates MMC snap-in runs in an environment where Xenroll.dll is already an available resource.</span></span>

<span data-ttu-id="bfdd9-122">除了 [**ICertRequest**](/windows/desktop/api/Certcli/nn-certcli-icertrequest) 和 [**ICertConfig**](/windows/desktop/api/Certcli/nn-certcli-icertconfig)，仲介的開發人員也可能會發現 [憑證註冊介面](cryptography-interfaces.md) 和 [智慧卡註冊控制項](certificate-enrollment-control.md) 都很有用。</span><span class="sxs-lookup"><span data-stu-id="bfdd9-122">In addition to [**ICertRequest**](/windows/desktop/api/Certcli/nn-certcli-icertrequest) and [**ICertConfig**](/windows/desktop/api/Certcli/nn-certcli-icertconfig), developers of intermediaries may find the [Certificate Enrollment Interfaces](cryptography-interfaces.md) and the [Smart Card Enrollment Control](certificate-enrollment-control.md) to be useful.</span></span>

 

 
