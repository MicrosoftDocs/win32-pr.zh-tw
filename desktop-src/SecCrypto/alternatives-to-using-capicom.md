---
description: 使用 CAPICOM 的建議替代方法。
ms.assetid: 8f74ff84-6165-46a3-976b-36c7f70546be
title: 使用 CAPICOM 的替代方案
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e2518f527555bbae0dc02f0234074fd657aa7bdc
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/08/2021
ms.locfileid: "106997985"
---
# <a name="alternatives-to-using-capicom"></a>使用 CAPICOM 的替代方案

\[CAPICOM 是僅限32位的元件，可用於下列作業系統： Windows Server 2008、Windows Vista、Windows XP。 相反地，請使用 .NET Framework 來執行安全性功能。 如需詳細資訊，請參閱下面所列的替代方案。\]

> [!IMPORTANT]
> CAPICOM 的替代方案沒有提供腳本的解決方案;因此，您必須撰寫自己的 ActiveX 控制項。 如需詳細資訊，請參閱 [ActiveX 控制項](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa751968(v=vs.85))。

 

-   [憑證存放區物件](#certificate-store-objects)
-   [數位簽章物件](#digital-signature-objects)
-   [封裝的資料物件](#enveloped-data-objects)
-   [資料加密物件](#data-encryption-objects)
-   [輔助物件](#auxiliary-objects)

## <a name="certificate-store-objects"></a>憑證存放區物件

建議您使用下列替代方案來處理 [*憑證存放區*](../secgloss/c-gly.md) 和這些存放區中的憑證。



| Object                                             | 替代函式                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
|----------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [**憑證**](certificate.md)                 | [**憑證**](certificate.md)物件可在 [需求] 區段中指定的作業系統中使用。 請改為使用 [**system.security.cryptography.x509certificates.x509certificate2**](/previous-versions/windows/)命名空間中的 [**X509Certificate2 類別**](/dotnet/api/system.security.cryptography.x509certificates.x509certificate2?view=netcore-3.1)。<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                |
| [**CertificatePolicies**](certificatepolicies.md) | [**CertificatePolicies**](certificatepolicies.md)物件可用於 [需求] 區段中指定的作業系統。 相反地，請在 [**system.security.cryptography.x509certificates.x509certificate2**](/previous-versions/windows/)命名空間中使用 [**X509Extension 類別**](/dotnet/api/system.security.cryptography.x509certificates.x509extension?view=netcore-3.1)，方法是呼叫採用 OID 作為參數的函式，然後使用憑證原則的 oid 來取得憑證原則。<br/>                                                                                                                                                                                                                                                                      |
| [**憑證**](certificates.md)               | [ [**憑證**](certificates.md) ] 物件可用於 [需求] 區段中指定的作業系統。 請改為使用 [**system.security.cryptography.x509certificates.x509certificate2**](/previous-versions/windows/)命名空間中的 [**X509Certificate2Collection 類別**](/dotnet/api/system.security.cryptography.x509certificates.x509certificate2collection?view=netcore-3.1)。<br/>                                                                                                                                                                                                                                                                                                                                                                                                          |
| [**CertificateStatus**](certificatestatus.md)     | [**CertificateStatus**](certificatestatus.md)物件可用於 [需求] 區段中指定的作業系統。 相反地，請使用 [**system.security.cryptography.x509certificates.x509certificate2**](/previous-versions/windows/)命名空間中的 [**X509ChainStatus 結構**](/dotnet/api/system.security.cryptography.x509certificates.x509chainstatus?view=netcore-3.1)。<br/>                                                                                                                                                                                                                                                                                                                                                                                                                  |
| [**鏈**](chain.md)                             | [**Chain**](chain.md)物件可在 [需求] 區段中指定的作業系統中使用。 請改為使用 [**system.security.cryptography.x509certificates.x509certificate2**](/previous-versions/windows/)命名空間中的 [**X509Chain 類別**](/dotnet/api/system.security.cryptography.x509certificates.x509chain?view=netcore-3.1)。<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| [**ExtendedProperties**](extendedproperties.md)   | [**ExtendedProperties**](extendedproperties.md)物件可用於 [需求] 區段中指定的作業系統。 相反地，請使用 (PInvoke) 的平台叫用服務來呼叫 WIN32 API 函式 [**CertGetCertificateCoNtextProperty**](/windows/desktop/api/Wincrypt/nf-wincrypt-certgetcertificatecontextproperty) 並取得屬性。 如需 PInvoke 的詳細資訊，請參閱 [平台叫用教學](https://msdn.microsoft.com/library/aa288468.aspx)課程。 [.Net 和 cryptoapi Via p/invoke：第1部分](/previous-versions/ms867087(v=msdn.10)#netcryptoapi_topic5)和[.net，以及透過 p/invoke](/previous-versions/ms867087(v=msdn.10)#netcryptoapi_topic6)叫用的 cryptoapi：[利用 CAPICOM 和 p/invoke 擴充 .net 密碼](/previous-versions/ms867087(v=msdn.10))編譯的第二部分，可能也很有用。<br/> |
| [**ExtendedProperty**](extendedproperty.md)       | [**ExtendedProperty**](extendedproperty.md)物件可用於 [需求] 區段中指定的作業系統。 相反地，請使用 (PInvoke) 的平台叫用服務來呼叫 WIN32 API 函式 [**CertGetCertificateCoNtextProperty**](/windows/desktop/api/Wincrypt/nf-wincrypt-certgetcertificatecontextproperty) 並取得屬性。 如需 PInvoke 的詳細資訊，請參閱 [平台叫用教學](https://msdn.microsoft.com/library/aa288468.aspx)課程。 [.Net 和 cryptoapi Via p/invoke：第1部分](/previous-versions/ms867087(v=msdn.10)#netcryptoapi_topic5)和[.net，以及透過 p/invoke](/previous-versions/ms867087(v=msdn.10)#netcryptoapi_topic6)叫用的 cryptoapi：[利用 CAPICOM 和 p/invoke 擴充 .net 密碼](/previous-versions/ms867087(v=msdn.10))編譯的第二部分，可能也很有用。<br/>     |
| [**延伸模組**](extension.md)                     | [**擴充**](extension.md)物件可在 [需求] 區段中指定的作業系統中使用。 請改為使用 [**system.security.cryptography.x509certificates.x509certificate2**](/previous-versions/windows/)命名空間中的 [**X509Extension 類別**](/dotnet/api/system.security.cryptography.x509certificates.x509extension?view=netcore-3.1)。<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| [**延伸模組**](extensions.md)                   | [**擴充**](extensions.md)物件可在 [需求] 區段中指定的作業系統中使用。 請改為使用 [**system.security.cryptography.x509certificates.x509certificate2**](/previous-versions/windows/)命名空間中的 [**X509ExtensionCollection 類別**](/dotnet/api/system.security.cryptography.x509certificates.x509extensioncollection?view=netcore-3.1)。<br/>                                                                                                                                                                                                                                                                                                                                                                                                                    |
| [**PrivateKey**](privatekey.md)                   | [**PrivateKey**](privatekey.md)物件可用於 [需求] 區段中指定的作業系統。 請改為使用 [**system.security.cryptography.x509certificates.x509certificate2**](/previous-versions/windows/)命名空間中的 [**X509Certificate2. PrivateKey 屬性**](/dotnet/api/system.security.cryptography.x509certificates.x509certificate2.privatekey?view=netcore-3.1)。<br/>                                                                                                                                                                                                                                                                                                                                                                                                 |
| [**PublicKey**](publickey.md)                     | [**PublicKey**](publickey.md)物件可用於 [需求] 區段中指定的作業系統。 請改為使用 [**system.security.cryptography.x509certificates.x509certificate2**](/previous-versions/windows/)命名空間中的 [**X509Certificate2. PublicKey 屬性**](/dotnet/api/system.security.cryptography.x509certificates.x509certificate2.publickey?view=netcore-3.1)。<br/>                                                                                                                                                                                                                                                                                                                                                                                                     |
| [**市集**](store.md)                             | [**Store**](store.md)物件可在 [需求] 區段中指定的作業系統中使用。 請改為使用 [**system.security.cryptography.x509certificates.x509certificate2**](/previous-versions/windows/)命名空間中的 [**system.security.cryptography.x509certificates.x509store 類別**](/previous-versions/windows/embedded/hh424027(v=msdn.10))。<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| [**範本**](template.md)                       | [**範本**](template.md)物件可在 [需求] 區段中指定的作業系統中使用。 相反地，請使用 [**system.security.cryptography.x509certificates.x509certificate2**](/previous-versions/windows/)命名空間中的 [**X509Extension 類別**](/dotnet/api/system.security.cryptography.x509certificates.x509extension?view=netcore-3.1)，方法是呼叫接受 OID 作為參數的函式，然後使用憑證範本的 oid 來取得憑證延伸範本。<br/>                                                                                                                                                                                                                                                                                  |



 

## <a name="digital-signature-objects"></a>數位簽章物件

我們建議下列替代方式，以數位方式簽署資料和驗證數位簽章。



| Object                           | 替代函式                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|----------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [**SignedCode**](signedcode.md) | [**SignedCode**](signedcode.md)物件可用於 [需求] 區段中指定的作業系統。 相反地，請使用平台叫用服務 (PInvoke) 呼叫 WIN32 API [**SignerSignEx**](signersignex.md)、 [**SignerTimeStampEx**](signertimestampex.md)和 [**WinVerifyTrust**](/windows/desktop/api/Wintrust/nf-wintrust-winverifytrust) 函式，以使用 Authenticode 數位簽章簽署內容。 如需 PInvoke 的詳細資訊，請參閱 [平台叫用教學](https://msdn.microsoft.com/library/aa288468.aspx)課程。 [.Net 和 cryptoapi Via p/invoke：第1部分](/previous-versions/ms867087(v=msdn.10)#netcryptoapi_topic5)和[.net，以及透過 p/invoke](/previous-versions/ms867087(v=msdn.10)#netcryptoapi_topic6)叫用的 cryptoapi：[利用 CAPICOM 和 p/invoke 擴充 .net 密碼](/previous-versions/ms867087(v=msdn.10))編譯的第二部分，可能也很有用。<br/> |
| [**SignedData**](signeddata.md) | [**SignedData**](signeddata.md)物件可用於 [需求] 區段中指定的作業系統。 相反地，請使用 [**SignedCms 類別**](/dotnet/api/system.security.cryptography.pkcs.signedcms?view=dotnet-plat-ext-3.1&preserve-view=true)，以使用 [**system.servicemodel 命名空間。**](/dotnet/api/system.security.cryptography.pkcs?view=dotnet-plat-ext-3.1&preserve-view=true)<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| [**簽署者**](signer.md)         | [**簽署者**](signer.md)物件可在 [需求] 區段中指定的作業系統中使用。 相反地，請使用 [**CmsSigner 類別**](/dotnet/api/system.security.cryptography.pkcs.cmssigner?view=dotnet-plat-ext-3.1&preserve-view=true)，以使用 [**system.servicemodel 命名空間。**](/dotnet/api/system.security.cryptography.pkcs?view=dotnet-plat-ext-3.1&preserve-view=true)<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| [**簽名**](signers.md)       | [**簽署**](signers.md)者物件可在 [需求] 區段中指定的作業系統中使用。 相反地，請使用 CmsSigner 物件的集合。 For more information, see the [**CmsSigner Class**](/dotnet/api/system.security.cryptography.pkcs.cmssigner?view=dotnet-plat-ext-3.1&preserve-view=true) in the [**System.Security.Cryptography.Pkcs**](/dotnet/api/system.security.cryptography.pkcs?view=dotnet-plat-ext-3.1&preserve-view=true) namespace.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |



 

## <a name="enveloped-data-objects"></a>封裝的資料物件

我們建議下列替代方案，以建立用於隱私權的封包資料訊息，以及解密封包訊息中的資料。



| Object                                 | 描述                                                                                                                                                                                                                                                                                                                                                |
|----------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [**EnvelopedData**](envelopeddata.md) | [**EnvelopedData**](envelopeddata.md)物件可用於 [需求] 區段中指定的作業系統。 相反地，請使用 [**EnvelopedCms 類別**](/dotnet/api/system.security.cryptography.pkcs.envelopedcms?view=dotnet-plat-ext-3.1&preserve-view=true)，以使用 [**system.servicemodel 命名空間。**](/dotnet/api/system.security.cryptography.pkcs?view=dotnet-plat-ext-3.1&preserve-view=true)<br/>               |
| [**收件者**](recipients.md)       | [收件者 [**] 物件可**](recipients.md) 用於 [需求] 區段中指定的作業系統。 相反地，請使用 [**CmsRecipientCollection 類別**](/dotnet/api/system.security.cryptography.pkcs.cmsrecipientcollection?view=dotnet-plat-ext-3.1&preserve-view=true)，以使用 [**system.servicemodel 命名空間。**](/dotnet/api/system.security.cryptography.pkcs?view=dotnet-plat-ext-3.1&preserve-view=true)<br/> |



 

## <a name="data-encryption-objects"></a>資料加密物件

我們建議下列替代方案，以加密隱私權的任意資料和解密加密資料。



| Object                                 | 描述                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|----------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [**A**](encrypteddata.md) | [**A**](encrypteddata.md)物件可用於 [需求] 區段中指定的作業系統。 相反地，請使用 (PInvoke) 的平台叫用服務來呼叫 WIN32 API 函式 [**CryptEncryptMessage**](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptencryptmessage) 和 [**CryptDecryptMessage**](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptdecryptmessage) ，以加密和解密訊息。 如需 PInvoke 的詳細資訊，請參閱 [平台叫用教學](https://msdn.microsoft.com/library/aa288468.aspx)課程。 [.Net 和 cryptoapi Via p/invoke：第1部分](/previous-versions/ms867087(v=msdn.10)#netcryptoapi_topic5)和[.net，以及透過 p/invoke](/previous-versions/ms867087(v=msdn.10)#netcryptoapi_topic6)叫用的 cryptoapi：[利用 CAPICOM 和 p/invoke 擴充 .net 密碼](/previous-versions/ms867087(v=msdn.10))編譯的第二部分，可能也很有用。<br/> |



 

## <a name="auxiliary-objects"></a>輔助物件

建議您利用下列替代方案來變更其他物件的預設行為，以及管理憑證、憑證存放區和訊息。



| Object                                         | 描述                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [**演算法**](algorithm.md)                 | 演算法物件可在 [需求 [**]**](algorithm.md) 區段中指定的作業系統中使用。 相反地，請使用 [**AlgorithmIdentifier 類別**](/dotnet/api/system.security.cryptography.pkcs.algorithmidentifier?view=dotnet-plat-ext-3.1&preserve-view=true)，以使用 [**system.servicemodel 命名空間。**](/dotnet/api/system.security.cryptography.pkcs?view=dotnet-plat-ext-3.1&preserve-view=true)<br/>                                                                                                                                                                                                                                          |
| [**屬性**](attribute.md)                 | [**Attribute**](attribute.md)物件可在 [需求] 區段中指定的作業系統中使用。 請改用 [**system.string 命名空間中的**](/previous-versions/windows/) [**CryptographicAttributeObject 類別**](/dotnet/api/system.security.cryptography.cryptographicattributeobject?view=dotnet-plat-ext-3.1&preserve-view=true)。<br/>                                                                                                                                                                                                                                      |
| [**屬性**](attributes.md)               | [ [**屬性**](attributes.md) ] 物件可用於 [需求] 區段中指定的作業系統。 請改用 [**system.string 命名空間中的**](/previous-versions/windows/) [**CryptographicAttributeObjectCollection 類別**](/dotnet/api/system.security.cryptography.cryptographicattributeobjectcollection?view=dotnet-plat-ext-3.1&preserve-view=true)。<br/>                                                                                                                                                                                                                |
| [**BasicConstraints**](basicconstraints.md)   | [**BasicConstraints**](basicconstraints.md)物件可用於 [需求] 區段中指定的作業系統。 請改為使用 [**system.security.cryptography.x509certificates.x509certificate2**](/previous-versions/windows/)命名空間中的 [**X509BasicConstraintsExtension 類別**](/dotnet/api/system.security.cryptography.x509certificates.x509basicconstraintsextension?view=netcore-3.1)。<br/>                                                                                                                                                                    |
| [**EKU**](eku.md)                             | [**EKU**](eku.md)物件可在 [需求] 區段中指定的作業系統中使用。 請改為使用 [**system.security.cryptography.x509certificates.x509certificate2**](/previous-versions/windows/)命名空間中的 [**X509EnhancedKeyUsageExtension 類別**](/dotnet/api/system.security.cryptography.x509certificates.x509enhancedkeyusageextension?view=netcore-3.1)。<br/>                                                                                                                                                                                              |
| [**Eku**](ekus.md)                           | 您可以在 [需求] 區段中指定的作業系統中使用 [**eku**](ekus.md) 物件。 請改為使用 [**system.security.cryptography.x509certificates.x509certificate2**](/previous-versions/windows/)命名空間中的 [**X509ExtensionCollection 類別**](/dotnet/api/system.security.cryptography.x509certificates.x509extensioncollection?view=netcore-3.1)。<br/>                                                                                                                                                                                                        |
| [**EncodedData**](encodeddata.md)             | [**EncodedData**](encodeddata.md)物件可用於 [需求] 區段中指定的作業系統。 請改用 [**system.string 命名空間中的**](/previous-versions/windows/) [**AsnEncodedData 類別**](/dotnet/api/system.security.cryptography.asnencodeddata?view=netcore-3.1)。<br/>                                                                                                                                                                                                                                                              |
| [**ExtendedKeyUsage**](extendedkeyusage.md)   | [**ExtendedKeyUsage**](extendedkeyusage.md)物件可用於 [需求] 區段中指定的作業系統。 請改為使用 [**system.security.cryptography.x509certificates.x509certificate2**](/previous-versions/windows/)命名空間中的 [**X509EnhancedKeyUsageExtension 類別**](/dotnet/api/system.security.cryptography.x509certificates.x509enhancedkeyusageextension?view=netcore-3.1)。<br/>                                                                                                                                                                    |
| [**HashedData**](hasheddata.md)               | [**HashedData**](hasheddata.md)物件可用於 [需求] 區段中指定的作業系統。 請改用 [**system.string 命名空間中的**](/previous-versions/windows/) [**HashAlgorithm 類別**](/previous-versions/windows/)。<br/>                                                                                                                                                                                                                                                                  |
| [**KeyUsage**](keyusage.md)                   | [**KeyUsage**](keyusage.md)物件可用於 [需求] 區段中指定的作業系統。 請改為使用 [**system.security.cryptography.x509certificates.x509certificate2**](/previous-versions/windows/)命名空間中的 [**X509EnhancedKeyUsageExtension 類別**](/dotnet/api/system.security.cryptography.x509certificates.x509enhancedkeyusageextension?view=netcore-3.1)。<br/>                                                                                                                                                                                    |
| [**NoticeNumbers**](noticenumbers.md)         | [**NoticeNumbers**](noticenumbers.md)物件可用於 [需求] 區段中指定的作業系統。 如需詳細資訊，請參閱 [**限定詞**](qualifier.md)。<br/>                                                                                                                                                                                                                                                                                                                                                                                 |
| [**老**](oid.md)                             | [**OID**](oid.md)物件可在 [需求] 區段中指定的作業系統中使用。 相反地，請在 [**system.object**](/previous-versions/windows/)命名空間中使用 [**Oid 類別**](/dotnet/api/system.security.cryptography.oid?view=netcore-3.1)。<br/>                                                                                                                                                                                                                                                                                                    |
| [**Oid**](oids.md)                           | [**Oid**](oids.md)物件可在 [需求] 區段中指定的作業系統中使用。 請改用 [**system.string 命名空間中的**](/previous-versions/windows/) [**OidCollection 類別**](/dotnet/api/system.security.cryptography.oidcollection?view=netcore-3.1)。<br/>                                                                                                                                                                                                                                                                              |
| [**PolicyInformation**](policyinformation.md) | [**PolicyInformation**](policyinformation.md)物件可用於 [需求] 區段中指定的作業系統。 相反地，請在 [**system.security.cryptography.x509certificates.x509certificate2**](/previous-versions/windows/)命名空間中使用 [**X509Extension 類別**](/dotnet/api/system.security.cryptography.x509certificates.x509extension?view=netcore-3.1)，方法是呼叫採用 OID 作為參數的函式，然後使用憑證原則的 oid 來處理憑證原則延伸中的原則資訊。<br/>                   |
| [**Qualifier**](qualifier.md)                 | [**限定詞**](qualifier.md)物件可在 [需求] 區段中指定的作業系統中使用。 相反地，請在 [**system.security.cryptography.x509certificates.x509certificate2**](/previous-versions/windows/)命名空間中使用 [**X509Extension 類別**](/dotnet/api/system.security.cryptography.x509certificates.x509extension?view=netcore-3.1)，方法是呼叫採用 OID 作為參數的函式，然後使用憑證原則的 Oid 來處理憑證原則延伸中屬於原則資訊的限定詞。<br/>   |
| [**限定詞**](qualifiers.md)               | [**限定詞**](qualifiers.md)物件可在 [需求] 區段中指定的作業系統中使用。 相反地，請在 [**system.security.cryptography.x509certificates.x509certificate2**](/previous-versions/windows/)命名空間中使用 [**X509Extension 類別**](/dotnet/api/system.security.cryptography.x509certificates.x509extension?view=netcore-3.1)，方法是呼叫採用 OID 作為參數的函式，然後使用憑證原則的 Oid 來處理憑證原則延伸中屬於原則資訊的限定詞。<br/> |
| [**設定**](settings.md)                   | 沒有其他可用的替代方案。<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| [**公用程式**](utilities.md)                 | 沒有其他可用的替代方案。<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |



 

 

 
