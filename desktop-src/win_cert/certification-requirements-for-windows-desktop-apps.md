---
title: 桌面認證需求
description: 檔版本10Document 日期：2015This 檔包含傳統型應用程式必須滿足的技術需求和資格資格，才能參與 Windows 10 的桌面應用程式認證計畫。
ms.assetid: 0F19774E-5258-4152-BBD7-9C37A05C7F69
ms.topic: article
ms.date: 05/31/2018
topic_type:
- kbArticle
api_name: ''
api_type: ''
api_location: ''
ms.openlocfilehash: ab03c15c6e72e4854ecf64d067d268c3ca4c775f
ms.sourcegitcommit: 099ecdda1e83618b844387405da0db0ebda93a65
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 06/04/2021
ms.locfileid: "111444169"
---
# <a name="certification-requirements-for-windows-desktop-apps"></a><span data-ttu-id="2f27a-103">Windows 桌面應用程式的認證需求</span><span class="sxs-lookup"><span data-stu-id="2f27a-103">Certification requirements for Windows Desktop Apps</span></span>

<span data-ttu-id="2f27a-104">**檔版本：** 10</span><span class="sxs-lookup"><span data-stu-id="2f27a-104">**Document version:** 10</span></span>

<span data-ttu-id="2f27a-105">**檔日期：** 2015年7月29日</span><span class="sxs-lookup"><span data-stu-id="2f27a-105">**Document date:** July 29, 2015</span></span>

<span data-ttu-id="2f27a-106">本檔包含傳統型應用程式必須滿足的技術需求和資格資格，才能參與 Windows 10 的桌面應用程式認證計畫。</span><span class="sxs-lookup"><span data-stu-id="2f27a-106">This document contains the technical requirements and eligibility qualifications that a desktop app must meet in order to participate in the Windows 10 Desktop App Certification Program.</span></span>

## <a name="welcome"></a><span data-ttu-id="2f27a-107">歡迎！</span><span class="sxs-lookup"><span data-stu-id="2f27a-107">Welcome!</span></span>

<span data-ttu-id="2f27a-108">Windows 平臺支援各式各樣的產品與合作夥伴生態系統。</span><span class="sxs-lookup"><span data-stu-id="2f27a-108">The Windows platform supports a broad ecosystem of products and partners.</span></span> <span data-ttu-id="2f27a-109">在您的產品上顯示 Windows 標誌代表 Microsoft 與貴公司之間的關聯性和共同的品質承諾。</span><span class="sxs-lookup"><span data-stu-id="2f27a-109">Displaying the Windows logo on your product represents a relationship and a shared commitment to quality between Microsoft and your company.</span></span> <span data-ttu-id="2f27a-110">客戶信任您產品上的 Windows 品牌，因為它可確保它符合相容性標準，並在 Windows 平臺上順利執行。</span><span class="sxs-lookup"><span data-stu-id="2f27a-110">Customers trust the Windows brand on your product because it ensures that it meets compatibility standards and performs well on the Windows platform.</span></span> <span data-ttu-id="2f27a-111">成功通過 Windows 應用程式認證可讓您的應用程式在 Windows 相容性中心內展示，而且您可能會在您的網站上顯示認證標誌。</span><span class="sxs-lookup"><span data-stu-id="2f27a-111">Successfully passing Windows App Certification allows for your app to be showcased in the Windows Compatibility Center and you may display the certification logo on your site.</span></span>

<span data-ttu-id="2f27a-112">Windows 應用程式認證計畫是由程式和技術需求所組成，可協助確保攜帶 Windows 品牌的協力廠商應用程式在執行 Windows 的電腦上很容易安裝和可靠。</span><span class="sxs-lookup"><span data-stu-id="2f27a-112">The Windows App Certification Program is made up of program and technical requirements to help ensure that third-party apps carrying the Windows brand are both easy to install and reliable on PCs running Windows.</span></span> <span data-ttu-id="2f27a-113">客戶在購買的系統中有價值的穩定性、相容性、可靠性、效能和品質。</span><span class="sxs-lookup"><span data-stu-id="2f27a-113">Customers value stability, compatibility, reliability, performance, and quality in the systems they purchase.</span></span> <span data-ttu-id="2f27a-114">Microsoft 的投資，是為了滿足專為電腦上的 Windows 平臺上執行而設計的軟體應用程式需求。</span><span class="sxs-lookup"><span data-stu-id="2f27a-114">Microsoft focuses its investments to meet these requirements for software apps designed to run on the Windows platform for PCs.</span></span> <span data-ttu-id="2f27a-115">這些工作包括在執行 Windows 軟體的電腦上進行一致的體驗、改善效能，以及加強安全性的相容性測試。</span><span class="sxs-lookup"><span data-stu-id="2f27a-115">These efforts include compatibility tests for consistency of experience, improved performance, and enhanced security on PCs running Windows software.</span></span> <span data-ttu-id="2f27a-116">Microsoft 相容性測試是與業界合作夥伴合作設計，並且持續改進以回應產業開發和消費者需求。</span><span class="sxs-lookup"><span data-stu-id="2f27a-116">Microsoft compatibility tests have been designed in collaboration with industry partners and are continuously improved in response to industry developments and consumer demand.</span></span>

<span data-ttu-id="2f27a-117">Windows 應用程式認證套件用來驗證這些需求是否符合規範，並取代任何先前的套件版本，用來驗證 Windows 7、Windows 8 或 Windows 8.1。</span><span class="sxs-lookup"><span data-stu-id="2f27a-117">The Windows App Certification Kit is used to validate compliance with these requirements and replaces the any previous versions of the kit used to validate on Windows 7, Windows 8 or Windows 8.1.</span></span> <span data-ttu-id="2f27a-118">Windows 應用程式認證套件是 Windows 軟體開發套件 (SDK) 中包含的其中一個元件，適用于 Windows 10。</span><span class="sxs-lookup"><span data-stu-id="2f27a-118">The Windows App Certification Kit is one of the components included in the Windows Software Development Kit (SDK) for Windows 10.</span></span>

## <a name="app-eligibility"></a><span data-ttu-id="2f27a-119">應用程式資格</span><span class="sxs-lookup"><span data-stu-id="2f27a-119">App eligibility</span></span>

<span data-ttu-id="2f27a-120">若要讓應用程式符合 Windows 10 傳統型應用程式認證的資格，則必須符合下列準則和本檔中所列的所有技術需求。</span><span class="sxs-lookup"><span data-stu-id="2f27a-120">For an app to qualify for Windows 10 Desktop App Certification it must meet the following criteria and all the technical requirements listed in this document.</span></span>

-   <span data-ttu-id="2f27a-121">它必須是獨立應用程式</span><span class="sxs-lookup"><span data-stu-id="2f27a-121">It must be a standalone app</span></span>
-   <span data-ttu-id="2f27a-122">它必須在本機 Windows 10 電腦上執行</span><span class="sxs-lookup"><span data-stu-id="2f27a-122">It must run on a local Windows 10 PC</span></span>
-   <span data-ttu-id="2f27a-123">它可以是經認證的 Windows Server 應用程式的用戶端元件</span><span class="sxs-lookup"><span data-stu-id="2f27a-123">It can be a client component of a certified Windows Server app</span></span>
-   <span data-ttu-id="2f27a-124">它必須是程式碼並已完成功能</span><span class="sxs-lookup"><span data-stu-id="2f27a-124">It must be code and feature complete</span></span>
-   <span data-ttu-id="2f27a-125">它不能透過本機機制與 Windows Store 應用程式進行通訊，包括透過檔案和登錄機碼，但支援的企業案例除外</span><span class="sxs-lookup"><span data-stu-id="2f27a-125">It must not communicate with Windows Store apps via local mechanisms, including via files and registry keys, except in the supported enterprise scenarios</span></span>
-   <span data-ttu-id="2f27a-126">它不能危及或危及 Windows 系統的安全性或功能</span><span class="sxs-lookup"><span data-stu-id="2f27a-126">It must not jeopardize or compromise the security or functionality of the Windows system</span></span>
-   <span data-ttu-id="2f27a-127">它必須有唯一的名稱，而且不得由其他人商標</span><span class="sxs-lookup"><span data-stu-id="2f27a-127">It must have a unique name and must not be trademarked by others</span></span>
-   <span data-ttu-id="2f27a-128">所有外部元件都必須分開認證或符合 Windows 應用程式認證套件</span><span class="sxs-lookup"><span data-stu-id="2f27a-128">All external components must be certified separately or be compliant with the Windows App Certification Kit</span></span>
-   <span data-ttu-id="2f27a-129">針對任何配套的應用程式，它必須有退出選項</span><span class="sxs-lookup"><span data-stu-id="2f27a-129">It must have an opt-out option for any bundled apps</span></span>

<span data-ttu-id="2f27a-130">如果桌面應用程式提交到防毒軟體及/或防間諜軟體 (也就是反惡意程式碼) products 類別，則必須遵守反惡意程式碼平臺的指導方針。</span><span class="sxs-lookup"><span data-stu-id="2f27a-130">If the desktop app is submitted to the anti-virus and/or anti-spyware (i.e., antimalware) products category, it must comply with the ANTIMALWARE PLATFORM GUIDELINES.</span></span> <span data-ttu-id="2f27a-131">WINDOWS 10 反惡意程式碼 API 授權和清單合約必須已簽署並在提交前生效。</span><span class="sxs-lookup"><span data-stu-id="2f27a-131">The WINDOWS 10 ANTIMALWARE API LICENSE AND LISTING AGREEMENT must have been signed and in effect before submission.</span></span> <span data-ttu-id="2f27a-132">夥伴必須是的成員，或讓研究人員必須是的成員，而且在合約中列出的組織中也是如此。</span><span class="sxs-lookup"><span data-stu-id="2f27a-132">The partner must be a member of, or have researchers that are members of and in good standing in one the organizations listed in the agreement.</span></span> <span data-ttu-id="2f27a-133">這項功能必須透過合約中列出的組織 Windows 10 認證。</span><span class="sxs-lookup"><span data-stu-id="2f27a-133">The functionality must be certified on Windows 10 by one the organizations listed in the agreement.</span></span> <span data-ttu-id="2f27a-134">在過去12個月內，應用程式必須至少經過測試一次，並通過偵測和清除的認證。</span><span class="sxs-lookup"><span data-stu-id="2f27a-134">The app must have been tested at least once in the last 12 months, and certified for detection and cleaning.</span></span>

## <a name="1-apps-are-compatible-and-resilient"></a><span data-ttu-id="2f27a-135">1. 應用程式相容且具有復原能力</span><span class="sxs-lookup"><span data-stu-id="2f27a-135">1. Apps are compatible and resilient</span></span>

<span data-ttu-id="2f27a-136">應用程式損毀或停止回應的時間會導致使用者挫折。</span><span class="sxs-lookup"><span data-stu-id="2f27a-136">The times when an app crashes or stops responding cause much user frustration.</span></span> <span data-ttu-id="2f27a-137">應用程式應該具有復原能力和穩定性，並消除這類失敗有助於確保軟體的可預測性、可維護性、效能和值得信賴。</span><span class="sxs-lookup"><span data-stu-id="2f27a-137">Apps are expected to be resilient and stable and eliminating such failures helps ensure that software is more predictable, maintainable, performant and trustworthy.</span></span><dl> <span data-ttu-id="2f27a-138">1.1 您的應用程式不得相依于 Windows 相容性模式、AppHelp 訊息和或任何其他相容性修正程式</span><span class="sxs-lookup"><span data-stu-id="2f27a-138">1.1 Your app must not take a dependency on Windows compatibility modes, AppHelp message, and or any other compatibility fixes</span></span>  
<span data-ttu-id="2f27a-139">1.2 您的應用程式必須有相容性資訊清單，並針對支援的 Windows 版本使用適當的 Guid</span><span class="sxs-lookup"><span data-stu-id="2f27a-139">1.2 Your app must have a compatibility manifest, and use the appropriate GUIDs for the supported versions of Windows</span></span>  
<span data-ttu-id="2f27a-140">1.3 您的應用程式必須是 DPI 感知，方法是使用應用程式的組件資訊清單，而不是呼叫 SetProcessDPIAware</span><span class="sxs-lookup"><span data-stu-id="2f27a-140">1.3 Your app must be DPI-aware by using the application's assembly manifest rather than by calling SetProcessDPIAware</span></span>  
<span data-ttu-id="2f27a-141">1.4 您的應用程式不得依賴 VB6 執行時間</span><span class="sxs-lookup"><span data-stu-id="2f27a-141">1.4 Your app must not take a dependency on the VB6 runtime</span></span>  
<span data-ttu-id="2f27a-142">1.5 您的應用程式不能載入任意 Dll 來攔截 WIN32 API 呼叫，使用 HKLM \\ Software \\ Microsoft \\ Windows NT \\ CurrentVersion \\ Windows AppInit \_ dll。</span><span class="sxs-lookup"><span data-stu-id="2f27a-142">1.5 Your app must not load arbitrary DLLs to intercept Win32 API calls using HKLM\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Windows AppInit\_dlls.</span></span>  
</dl>

## <a name="2-apps-must-adhere-to-windows-security-best-practices"></a><span data-ttu-id="2f27a-143">2. 應用程式必須遵守 Windows 安全性最佳作法</span><span class="sxs-lookup"><span data-stu-id="2f27a-143">2. Apps must adhere to Windows security best practices</span></span>

<span data-ttu-id="2f27a-144">使用 Windows 安全性最佳作法有助於避免建立 Windows 攻擊面的風險。</span><span class="sxs-lookup"><span data-stu-id="2f27a-144">Using Windows security best practices will help avoid creating exposure to Windows attack surfaces.</span></span> <span data-ttu-id="2f27a-145">攻擊面是惡意攻擊者利用目標軟體中的弱點來惡意探索作業系統的進入點。</span><span class="sxs-lookup"><span data-stu-id="2f27a-145">Attack surfaces are the entry points that a malicious attacker could use to exploit the operating system by taking advantage of vulnerabilities in the target software.</span></span> <span data-ttu-id="2f27a-146">其中一個最糟的安全性弱點是權限提高。</span><span class="sxs-lookup"><span data-stu-id="2f27a-146">One of the worst security vulnerabilities is the elevation of privilege.</span></span>

<span data-ttu-id="2f27a-147">請注意，測試 2.1 2.6 僅適用于在 Windows 7、Windows 8 或 Windows 8.1 上測試的桌面應用程式。</span><span class="sxs-lookup"><span data-stu-id="2f27a-147">Note that tests 2.1   2.6 are applicable only for desktop apps tested on Windows 7, Windows 8 or Windows 8.1.</span></span><dl> <span data-ttu-id="2f27a-148">2.1 您的應用程式必須使用強式和適當的 [acl](/windows/desktop/SecAuthZ/access-control-lists) 來保護可執行檔</span><span class="sxs-lookup"><span data-stu-id="2f27a-148">2.1 Your app must use strong and appropriate [ACLs](/windows/desktop/SecAuthZ/access-control-lists) to secure executable files</span></span>  
<span data-ttu-id="2f27a-149">2.2 您的應用程式必須使用強式和適當的 [acl](/windows/desktop/SecAuthZ/access-control-lists) 來保護目錄的安全</span><span class="sxs-lookup"><span data-stu-id="2f27a-149">2.2 Your app must use strong and appropriate [ACLs](/windows/desktop/SecAuthZ/access-control-lists) to secure directories</span></span>  
<span data-ttu-id="2f27a-150">2.3 您的應用程式必須使用強式和適當的 [acl](/windows/desktop/SecAuthZ/access-control-lists) 來保護登錄機碼</span><span class="sxs-lookup"><span data-stu-id="2f27a-150">2.3 Your app must use strong and appropriate [ACLs](/windows/desktop/SecAuthZ/access-control-lists) to secure registry keys</span></span>  
<span data-ttu-id="2f27a-151">2.4 您的應用程式必須使用強式和適當的 [acl](/windows/desktop/SecAuthZ/access-control-lists) 來保護包含物件的目錄</span><span class="sxs-lookup"><span data-stu-id="2f27a-151">2.4 Your app must use strong and appropriate [ACLs](/windows/desktop/SecAuthZ/access-control-lists) to secure directories that contain objects</span></span>  
<span data-ttu-id="2f27a-152">2.5 您的應用程式必須將非系統管理員存取權減少到易受到篡改的服務</span><span class="sxs-lookup"><span data-stu-id="2f27a-152">2.5 Your app must reduce non-administrator access to services that are vulnerable to tampering</span></span>  
<span data-ttu-id="2f27a-153">2.6 您的應用程式必須防止具有快速重新開機的服務，每24小時重新開機超過兩次</span><span class="sxs-lookup"><span data-stu-id="2f27a-153">2.6 Your app must prevent services with fast restarts from restarting more than twice every 24 hours</span></span>  
</dl>

<span data-ttu-id="2f27a-154">**注意：只能將存取權授與需要它的實體。**</span><span class="sxs-lookup"><span data-stu-id="2f27a-154">**Note: Access should only be granted to the entities that require it.**</span></span>

<span data-ttu-id="2f27a-155">Windows 應用程式認證計畫會確認 Acl 和服務是否以不會讓 Windows 系統面臨風險的方式來執行，藉此驗證是否未公開 Windows 攻擊面。</span><span class="sxs-lookup"><span data-stu-id="2f27a-155">The Windows App Certification Program will verify that Windows Attack Surfaces are not exposed by verifying that ACLs and Services are implemented in a way that does not put the Windows system at risk.</span></span>

## <a name="3-apps-support-windows-security-features"></a><span data-ttu-id="2f27a-156">3. 應用程式支援 Windows 安全性功能</span><span class="sxs-lookup"><span data-stu-id="2f27a-156">3. Apps support Windows security features</span></span>

<span data-ttu-id="2f27a-157">Windows 作業系統有許多支援系統安全性和隱私權的功能。</span><span class="sxs-lookup"><span data-stu-id="2f27a-157">The Windows operating system has many features that support system security and privacy.</span></span> <span data-ttu-id="2f27a-158">應用程式必須支援這些功能，才能維持作業系統的完整性。</span><span class="sxs-lookup"><span data-stu-id="2f27a-158">Apps must support these features to maintain the integrity of the operating system.</span></span> <span data-ttu-id="2f27a-159">編譯不當的應用程式可能會造成緩衝區溢位，進而導致拒絕服務或允許惡意程式碼執行。</span><span class="sxs-lookup"><span data-stu-id="2f27a-159">Improperly compiled apps could cause buffer overruns that can, in turn, cause denial of service or allow malicious code execute.</span></span> <dl> <span data-ttu-id="2f27a-160">3.1 您的應用程式不能使用 AllowPartiallyTrustedCallersAttribute (APTCA) 來確保安全地存取強式名稱的元件</span><span class="sxs-lookup"><span data-stu-id="2f27a-160">3.1 Your app must not use AllowPartiallyTrustedCallersAttribute (APTCA) to ensure secure access to strong-named assemblies</span></span>  
<span data-ttu-id="2f27a-161">3.2 您的應用程式必須使用/SafeSEH 旗標進行編譯，以確保安全的例外狀況處理</span><span class="sxs-lookup"><span data-stu-id="2f27a-161">3.2 Your app must be compiled using the /SafeSEH flag to ensure safe exceptions handling</span></span>  
<span data-ttu-id="2f27a-162">3.3 您的應用程式必須使用/NXCOMPAT 旗標進行編譯，以防止資料執行</span><span class="sxs-lookup"><span data-stu-id="2f27a-162">3.3 Your app must be compiled using the /NXCOMPAT flag to prevent data execution</span></span>  
<span data-ttu-id="2f27a-163">3.4 您的應用程式必須使用/DYNAMICBASE 旗標（位址空間配置隨機載入 (ASLR）進行編譯) </span><span class="sxs-lookup"><span data-stu-id="2f27a-163">3.4 Your app must be compiled using the /DYNAMICBASE flag for address space layout randomization (ASLR)</span></span>  
<span data-ttu-id="2f27a-164">3.5 您的應用程式不得讀取/寫入共用的 PE 區段</span><span class="sxs-lookup"><span data-stu-id="2f27a-164">3.5 Your app must not Read/Write the Shared PE Sections</span></span>  
</dl>

## <a name="4-apps-must-adhere-to-system-restart-manager-messages"></a><span data-ttu-id="2f27a-165">4. 應用程式必須遵守系統重新開機管理員訊息</span><span class="sxs-lookup"><span data-stu-id="2f27a-165">4. Apps must adhere to system restart manager messages</span></span>

<span data-ttu-id="2f27a-166">當使用者啟動關機時，通常會有強烈的願望可以看到關機成功;他們可能會在離開辦公室的同時，只想要讓電腦關閉。</span><span class="sxs-lookup"><span data-stu-id="2f27a-166">When users initiate shutdown, they usually have a strong desire to see shutdown succeed; they may be in a hurry to leave the office and just want their computers to turn off.</span></span> <span data-ttu-id="2f27a-167">應用程式必須遵守此需求，而不會封鎖關機。</span><span class="sxs-lookup"><span data-stu-id="2f27a-167">Apps must respect this desire by not blocking shutdown.</span></span> <span data-ttu-id="2f27a-168">雖然在大部分情況下，關閉可能不會很重要，但應用程式必須針對重大關機的可能性做好準備。</span><span class="sxs-lookup"><span data-stu-id="2f27a-168">While in most cases, a shutdown may not be critical, apps must be prepared for the possibility of a critical shutdown.</span></span><dl> <span data-ttu-id="2f27a-169">4.1 您的應用程式必須適當地處理重大關機</span><span class="sxs-lookup"><span data-stu-id="2f27a-169">4.1 Your app must handle critical shutdowns appropriately</span></span> <dl> <span data-ttu-id="2f27a-170">在重大關機中，傳回 FALSE 到 WM QUERYENDSESSION 的應用程式 \_ 將會傳送至 wm \_ ENDSESSION 且已關閉，而這些應用程式將會 \_ 被終止。</span><span class="sxs-lookup"><span data-stu-id="2f27a-170">In a critical shutdown, apps that return FALSE to WM\_QUERYENDSESSION will be sent WM\_ENDSESSION and closed, while those that time out in response to WM\_QUERYENDSESSION will be terminated.</span></span>  
</dl> </dd> 4.2 A GUI app must return TRUE immediately in preparation for a restart <dl> <span data-ttu-id="2f27a-171">\_具有 LPARAM = ENDSESSION \_ CLOSEAPP (0x1) 的 WM QUERYENDSESSION。</span><span class="sxs-lookup"><span data-stu-id="2f27a-171">WM\_QUERYENDSESSION with LPARAM = ENDSESSION\_CLOSEAPP(0x1).</span></span>  
<span data-ttu-id="2f27a-172">主控台應用程式可以呼叫 SetConsoleCtrlHandler 來指定將處理關機通知的函數。</span><span class="sxs-lookup"><span data-stu-id="2f27a-172">Console apps can call SetConsoleCtrlHandler to specify the function that will handle shutdown notifications.</span></span> <span data-ttu-id="2f27a-173">服務應用程式可以呼叫 RegisterServiceCtrlHandlerEx 來指定將會接收關機通知的函數。</span><span class="sxs-lookup"><span data-stu-id="2f27a-173">Service apps can call RegisterServiceCtrlHandlerEx to specify the function that will receive shutdown notifications.</span></span>  
</dl> </dd> 4.3 Your app must return 0 within 30 seconds and shut down <dl> <span data-ttu-id="2f27a-174">\_具有 LPARAM = ENDSESSION \_ CLOSEAPP (0x1) 的 WM ENDSESSION。</span><span class="sxs-lookup"><span data-stu-id="2f27a-174">WM\_ENDSESSION with LPARAM = ENDSESSION\_CLOSEAPP(0x1).</span></span>  
<span data-ttu-id="2f27a-175">應用程式至少應儲存任何使用者資料，並在重新開機之後指出所需的資訊，來做好準備。</span><span class="sxs-lookup"><span data-stu-id="2f27a-175">At a minimum, app should prepare by saving any user data and state the information that is needed after a restart.</span></span>  
</dl> <span data-ttu-id="2f27a-176"></dd> 4.4 Console apps that receive the CTRL\_C\_EVENT notification should shut down immediately  
4.5 Drivers must not veto a system shutdown event  
</dl>
<strong>注意：因為無法中斷的作業而必須封鎖關機的應用程式應該會解釋使用者的原因。</strong></span><span class="sxs-lookup"><span data-stu-id="2f27a-176"></dd> 4.4 Console apps that receive the CTRL\_C\_EVENT notification should shut down immediately  
4.5 Drivers must not veto a system shutdown event  
</dl>
<strong>Note: Apps that must block shutdown because of an operation that cannot be interrupted should explain the reason to the user.</strong></span></span> <span data-ttu-id="2f27a-177">使用 ShutdownBlockReasonCreate 來註冊說明使用者原因的字串。</span><span class="sxs-lookup"><span data-stu-id="2f27a-177">Use ShutdownBlockReasonCreate to register a string that explains the reason to the user.</span></span> <span data-ttu-id="2f27a-178">當作業完成時，應用程式應該呼叫 ShutdownBlockReasonDestroy 來指示系統可以關機。</span><span class="sxs-lookup"><span data-stu-id="2f27a-178">When the operation has completed, the app should call ShutdownBlockReasonDestroy to indicate that the system can be shut down.</span></span>

## <a name="5-apps-must-support-a-clean-reversible-installation"></a><span data-ttu-id="2f27a-179">5. 應用程式必須支援乾淨且可還原的安裝</span><span class="sxs-lookup"><span data-stu-id="2f27a-179">5. Apps must support a clean, reversible installation</span></span>

<span data-ttu-id="2f27a-180">乾淨、可還原的安裝可讓使用者順利管理 (在其系統上部署和移除) 應用程式。</span><span class="sxs-lookup"><span data-stu-id="2f27a-180">A clean, reversible, installation allows users to successfully manage (deploy and remove) apps on their systems.</span></span><dl> <span data-ttu-id="2f27a-181">5.1 您的應用程式必須正確地執行乾淨且可還原的安裝</span><span class="sxs-lookup"><span data-stu-id="2f27a-181">5.1 Your app must properly implement a clean, reversible installation</span></span> <dl> <span data-ttu-id="2f27a-182">如果安裝失敗，應用程式應該要能夠回復，並將機器還原成先前的狀態。</span><span class="sxs-lookup"><span data-stu-id="2f27a-182">If the installation fails, the app should be able to roll it back and restore the machine to its previous state.</span></span>  
</dl> </dd> 5.2 Your app must never force the user to restart the computer immediately <dl> <span data-ttu-id="2f27a-183">在安裝、卸載或更新結束時，重新開機電腦絕對不應該是唯一的選項。</span><span class="sxs-lookup"><span data-stu-id="2f27a-183">Restarting the computer should never be the only option at the end of an install, uninstall or update.</span></span> <span data-ttu-id="2f27a-184">使用者應該有機會稍後重新開機。</span><span class="sxs-lookup"><span data-stu-id="2f27a-184">Users should have the opportunity to restart later.</span></span>  
</dl> </dd> 5.3 Your app must never be dependent on 8.3 short file names (SFN)  
5.4 Your app must never block silent install/uninstall  
5.5 Your app installer must create the correct registry entries to allow successful detection and uninstalls <dl> <span data-ttu-id="2f27a-185">Windows 清查工具和遙測工具需要已安裝應用程式的完整資訊。</span><span class="sxs-lookup"><span data-stu-id="2f27a-185">Windows inventory tools and telemetry tools require complete information about installed apps.</span></span> <span data-ttu-id="2f27a-186">如果您使用以 MSI 為基礎的安裝程式，MSI 會自動建立下面的登錄專案。</span><span class="sxs-lookup"><span data-stu-id="2f27a-186">If you are using an MSI-based installer, MSI automatically creates the registry entries below.</span></span> <span data-ttu-id="2f27a-187">如果您不是使用 MSI 安裝程式，則安裝模組必須在安裝期間建立下列登錄專案：</span><span class="sxs-lookup"><span data-stu-id="2f27a-187">If you are not using an MSI installer, the installation module must create the following registry entries during installation:</span></span>  
</dl>

-   <span data-ttu-id="2f27a-188">DisplayName</span><span class="sxs-lookup"><span data-stu-id="2f27a-188">DisplayName</span></span>
-   <span data-ttu-id="2f27a-189">InstallLocation</span><span class="sxs-lookup"><span data-stu-id="2f27a-189">InstallLocation</span></span>
-   <span data-ttu-id="2f27a-190">Publisher</span><span class="sxs-lookup"><span data-stu-id="2f27a-190">Publisher</span></span>
-   <span data-ttu-id="2f27a-191">UninstallString</span><span class="sxs-lookup"><span data-stu-id="2f27a-191">UninstallString</span></span>
-   <span data-ttu-id="2f27a-192">VersionMajor 或 MajorVersion</span><span class="sxs-lookup"><span data-stu-id="2f27a-192">VersionMajor or MajorVersion</span></span>
-   <span data-ttu-id="2f27a-193">VersionMinor 或 MinorVersion</span><span class="sxs-lookup"><span data-stu-id="2f27a-193">VersionMinor or MinorVersion</span></span>

</dd> 5.6 The app must remove all of its entries from Add/ Remove Programs upon uninstall  
</dl>

## <a name="6-apps-must-digitally-sign-files-and-drivers"></a><span data-ttu-id="2f27a-194">6. 應用程式必須數位簽署檔案和驅動程式</span><span class="sxs-lookup"><span data-stu-id="2f27a-194">6. Apps must digitally sign files and drivers</span></span>

<span data-ttu-id="2f27a-195">Authenticode 數位簽章可讓使用者確認軟體是否為正版。</span><span class="sxs-lookup"><span data-stu-id="2f27a-195">An Authenticode digital signature allows users to be sure that the software is genuine.</span></span> <span data-ttu-id="2f27a-196">它也可讓您偵測檔案是否已遭篡改，例如是否受病毒感染。</span><span class="sxs-lookup"><span data-stu-id="2f27a-196">It also allows one to detect whether a file has been tampered with, such as if it has been infected by a virus.</span></span> <span data-ttu-id="2f27a-197">核心模式程式碼簽署強制是一項稱為程式碼完整性 (CI) 的 Windows 功能，可在每次將檔案映射載入記憶體時驗證檔案的完整性，藉此改善作業系統的安全性。</span><span class="sxs-lookup"><span data-stu-id="2f27a-197">Kernel-mode code signing enforcement is a Windows feature known as code integrity (CI), which improves the security of the operating system by verifying the integrity of a file each time the image of the file is loaded into memory.</span></span> <span data-ttu-id="2f27a-198">CI 會偵測惡意程式碼是否已修改系統二進位檔案。</span><span class="sxs-lookup"><span data-stu-id="2f27a-198">CI detects whether malicious code has modified a system binary file.</span></span> <span data-ttu-id="2f27a-199">當核心模組的簽章無法正確確認時，也會產生診斷和系統審核記錄事件。</span><span class="sxs-lookup"><span data-stu-id="2f27a-199">Also generates a diagnostic and system-audit log event when the signature of a kernel module fails to verify correctly.</span></span> <dl> <span data-ttu-id="2f27a-200">6.1 所有可執行檔 (.exe、.dll、.ocx、.sys、.cpl、winspool.drv、scr) 都必須使用 Authenticode 憑證進行簽署</span><span class="sxs-lookup"><span data-stu-id="2f27a-200">6.1 All executable files (.exe, .dll, .ocx, .sys, .cpl, .drv, .scr) must be signed with an Authenticode certificate</span></span>  
<span data-ttu-id="2f27a-201">6.2 應用程式安裝的所有核心模式驅動程式都必須具備透過 Windows 硬體認證計畫取得的 Microsoft 簽章。</span><span class="sxs-lookup"><span data-stu-id="2f27a-201">6.2 All kernel mode drivers installed by the app must have a Microsoft signature obtained through the Windows Hardware Certification program.</span></span> <span data-ttu-id="2f27a-202">所有檔案系統篩選器驅動程式都必須由 Microsoft 簽署。</span><span class="sxs-lookup"><span data-stu-id="2f27a-202">All File System filter drivers must be signed by Microsoft.</span></span>  
<span data-ttu-id="2f27a-203">6.3 例外狀況和豁免</span><span class="sxs-lookup"><span data-stu-id="2f27a-203">6.3 Exceptions and Waivers</span></span> <dl> <span data-ttu-id="2f27a-204">只有未簽署的協力廠商可轉散發套件（不含驅動程式）才會考慮豁免。</span><span class="sxs-lookup"><span data-stu-id="2f27a-204">Waivers will be considered only for unsigned third-party redistributables, excluding drivers.</span></span> <span data-ttu-id="2f27a-205">若要授與此棄權的要求，必須對要求籤署版本的可轉散發套件 () s 進行通訊證明。</span><span class="sxs-lookup"><span data-stu-id="2f27a-205">A proof of communication requesting a signed version of the redistributable(s) is required for this waiver to be granted.</span></span>  
</dl> </dd> </dl>

## <a name="7-apps-dont-block-installation-or-app-launch-based-on-an-operating-system-version-check"></a><span data-ttu-id="2f27a-206">7. 應用程式不會根據作業系統版本檢查封鎖安裝或應用程式啟動</span><span class="sxs-lookup"><span data-stu-id="2f27a-206">7. Apps don't block installation or app launch based on an operating system version check</span></span>

<span data-ttu-id="2f27a-207">當客戶沒有技術限制時，請務必讓客戶無法安裝或執行其應用程式。</span><span class="sxs-lookup"><span data-stu-id="2f27a-207">It is important that customers are not artificially blocked from installing or running their app when there are no technical limitations.</span></span> <span data-ttu-id="2f27a-208">一般而言，如果應用程式是針對 Windows Vista 或更新版本的 Windows 所撰寫，則不需要檢查作業系統版本。</span><span class="sxs-lookup"><span data-stu-id="2f27a-208">In general, if apps were written for Windows Vista or later versions of Windows, they should not have to check the operating system version.</span></span><dl> <span data-ttu-id="2f27a-209">7.1 您的應用程式不能執行版本檢查是否相等</span><span class="sxs-lookup"><span data-stu-id="2f27a-209">7.1 Your app must not perform version checks for equality</span></span> <dl> <span data-ttu-id="2f27a-210">如果您需要特定功能，請檢查功能本身是否可用。</span><span class="sxs-lookup"><span data-stu-id="2f27a-210">If you need a specific feature, check whether the feature itself is available.</span></span> <span data-ttu-id="2f27a-211">如果您需要 Windows 7，請檢查 Windows 7 或更新版本的 (>= 6.2) 。</span><span class="sxs-lookup"><span data-stu-id="2f27a-211">If you need Windows 7, check for Windows 7 or later (>= 6.2).</span></span> <span data-ttu-id="2f27a-212">如此一來，您的偵測程式碼將繼續在未來的 Windows 版本上運作。</span><span class="sxs-lookup"><span data-stu-id="2f27a-212">This way, your detection code will continue to work on future versions of Windows.</span></span> <span data-ttu-id="2f27a-213">驅動程式安裝程式和卸載模組絕對不應該檢查作業系統版本。</span><span class="sxs-lookup"><span data-stu-id="2f27a-213">Driver installers and uninstall modules should never check the operating system version.</span></span>  
</dl> </dd> 7.2 Exceptions and Waivers will be considered for apps meeting the criteria below:

-   <span data-ttu-id="2f27a-214">以一個套件的形式傳遞的應用程式也會在 Windows 7、Windows 8 和 Windows 8.1 上執行，而且需要檢查作業系統版本，以判斷要在指定的作業系統上安裝哪些元件。</span><span class="sxs-lookup"><span data-stu-id="2f27a-214">Apps that are delivered as one package that also run on Windows 7, Windows 8, and Windows 8.1, and need to check the operating system version to determine which components to install on a given operating system.</span></span>
-   <span data-ttu-id="2f27a-215">只會在安裝期間檢查作業系統的最小版本 (的應用程式，而不是只使用核准的 API 呼叫在執行時間) ，而且會正確地列出應用程式資訊清單中的最低版本需求。</span><span class="sxs-lookup"><span data-stu-id="2f27a-215">Apps that check only the minimum version of the operating system (during install only, not at runtime) by using only the approved API calls, and that properly list the minimum version requirement in the app manifest.</span></span>
-   <span data-ttu-id="2f27a-216">安全性應用程式 (防毒軟體、防火牆等 ) 、系統公用程式 (例如，使用已核准的 API 呼叫檢查作業系統版本的磁碟重組、備份及診斷工具) 。</span><span class="sxs-lookup"><span data-stu-id="2f27a-216">Security apps (antivirus, firewall, etc.), system utilities (for example, defrag, backups, and diagnostics tools) that check the operating system version by using only the approved API calls.</span></span>


</dl>

## <a name="8-apps-dont-load-services-or-drivers-in-safe-mode"></a><span data-ttu-id="2f27a-217">8. 應用程式不會以安全模式載入服務或驅動程式</span><span class="sxs-lookup"><span data-stu-id="2f27a-217">8. Apps don't load services or drivers in safe mode</span></span>

<span data-ttu-id="2f27a-218">安全模式可讓使用者診斷和疑難排解 Windows。</span><span class="sxs-lookup"><span data-stu-id="2f27a-218">Safe mode allows users to diagnose and troubleshoot Windows.</span></span> <span data-ttu-id="2f27a-219">驅動程式和服務不可設定為以安全模式載入，除非基本系統作業需要這些驅動程式和服務，例如存放裝置磁碟機或診斷和復原用途，例如防病毒掃描程式。</span><span class="sxs-lookup"><span data-stu-id="2f27a-219">Drivers and services must not be set to load in safe mode unless they are needed for basic system operations of such as storage device drivers or for diagnostic and recovery purposes, such as anti-virus scanners,.</span></span> <span data-ttu-id="2f27a-220">根據預設，當 Windows 處於安全模式時，只會啟動隨 Windows 預先安裝的驅動程式和服務。</span><span class="sxs-lookup"><span data-stu-id="2f27a-220">By default, when Windows is in safe mode, it starts only the drivers and services that came preinstalled with Windows.</span></span>

-   <span data-ttu-id="2f27a-221">8.1 例外狀況和豁免</span><span class="sxs-lookup"><span data-stu-id="2f27a-221">8.1 Exceptions and Waivers</span></span> <dl> <span data-ttu-id="2f27a-222">必須以安全模式啟動的驅動程式和服務需要棄權。</span><span class="sxs-lookup"><span data-stu-id="2f27a-222">Drivers and services that must be started in safe mode require a waiver.</span></span> <span data-ttu-id="2f27a-223">棄權要求必須包含每個適用的驅動程式或寫入安全開機登錄機碼的服務，並描述應用程式或服務必須在安全模式中執行的技術原因。</span><span class="sxs-lookup"><span data-stu-id="2f27a-223">The waiver request must include each applicable driver or service writing to the SafeBoot registry keys, and describe the technical reasons why the app or service must run in safe mode.</span></span> <span data-ttu-id="2f27a-224">應用程式安裝程式必須使用下列登錄機碼註冊所有這類驅動程式和服務：</span><span class="sxs-lookup"><span data-stu-id="2f27a-224">The app installer must register all such drivers and services using these registry keys:</span></span>  
    </dl>
    -   HKLM/System/CurrentControlSet/Control/SafeBoot/Minimal
    -   HKLM/System/CurrentControlSet/Control/SafeBoot/Network

<span data-ttu-id="2f27a-225">**注意：** 您必須測試這些驅動程式和服務，以確保它們在安全模式下運作，而不會發生任何錯誤。</span><span class="sxs-lookup"><span data-stu-id="2f27a-225">**Note:** You must test these drivers and services to ensure that they function in safe mode without any errors.</span></span>

## <a name="9-apps-must-follow-user-account-control-guidelines"></a><span data-ttu-id="2f27a-226">9. 應用程式必須遵循使用者帳戶控制指導方針</span><span class="sxs-lookup"><span data-stu-id="2f27a-226">9. Apps must follow User Account Control guidelines</span></span>

<span data-ttu-id="2f27a-227">某些 Windows 應用程式會在系統管理員帳戶的安全性內容中執行，而應用程式通常會要求過多的使用者權限和 Windows 許可權。</span><span class="sxs-lookup"><span data-stu-id="2f27a-227">Some Windows apps run in the security context of an administrator account, and apps often request excessive user rights and Windows privileges.</span></span> <span data-ttu-id="2f27a-228">控制對資源的存取可讓使用者控制其系統，並防止不必要的變更。</span><span class="sxs-lookup"><span data-stu-id="2f27a-228">Controlling access to resources enables users to be in control of their systems and protect them against unwanted changes.</span></span> <span data-ttu-id="2f27a-229">不必要的變更可能是惡意的，例如控制電腦的 rootkit，或是由許可權有限的人員所做的動作結果。</span><span class="sxs-lookup"><span data-stu-id="2f27a-229">An unwanted change can be malicious, such as a rootkit taking control of the computer, or be the result of an action made by people who have limited privileges..</span></span> <span data-ttu-id="2f27a-230">控制資源存取最重要的規則就是提供使用者執行其必要工作所需的最少量存取標準使用者內容。</span><span class="sxs-lookup"><span data-stu-id="2f27a-230">The most important rule for controlling access to resources is to provide the least amount of access  standard user context  necessary for a user to perform his or her necessary tasks.</span></span> <span data-ttu-id="2f27a-231">遵循使用者帳戶控制 (UAC) 指導方針會提供應用程式所需的必要許可權，而不會讓系統持續暴露于安全性風險。</span><span class="sxs-lookup"><span data-stu-id="2f27a-231">Following user account control (UAC) guidelines provides an app with the necessary permissions when they are needed by the app, without leaving the system constantly exposed to security risks.</span></span> <span data-ttu-id="2f27a-232">大部分的應用程式在執行時間並不需要系統管理員許可權，而且應該是以標準使用者身分執行。</span><span class="sxs-lookup"><span data-stu-id="2f27a-232">Most apps do not require administrator privileges at run time, and should be just fine running as a standard-user.</span></span><dl> <span data-ttu-id="2f27a-233">9.1 您的應用程式必須有定義執行層級的資訊清單，並告知操作系統應用程式需要哪些許可權才能執行</span><span class="sxs-lookup"><span data-stu-id="2f27a-233">9.1 Your app must have a manifest that defines execution levels and tells the operating system what privileges the app requires in order to run</span></span> <dl> <span data-ttu-id="2f27a-234">應用程式資訊清單標記僅適用于 Exe （而不是 Dll）。</span><span class="sxs-lookup"><span data-stu-id="2f27a-234">The app manifest marking only applies to EXEs, not DLLs.</span></span> <span data-ttu-id="2f27a-235">這是因為在處理常式建立期間，UAC 並不會檢查 Dll。</span><span class="sxs-lookup"><span data-stu-id="2f27a-235">This is because UAC does not inspect DLLs during process creation.</span></span> <span data-ttu-id="2f27a-236">另外值得注意的是，UAC 規則並不適用于 Microsoft 服務。</span><span class="sxs-lookup"><span data-stu-id="2f27a-236">It is also worth noting that UAC rules do not apply to Microsoft services.</span></span> <span data-ttu-id="2f27a-237">資訊清單可以是內嵌或外部。</span><span class="sxs-lookup"><span data-stu-id="2f27a-237">The manifest can be either embedded or external.</span></span>  
<span data-ttu-id="2f27a-238">若要建立資訊清單，請建立名為 <應用程式 \_ 名稱 # C1.exe 的檔案，並將它儲存在與 EXE 相同的目錄中。</span><span class="sxs-lookup"><span data-stu-id="2f27a-238">To create a manifest, create a file with the name <app\_name>.exe.manifest and store it in the same directory as the EXE.</span></span> <span data-ttu-id="2f27a-239">請注意，如果應用程式具有內部資訊清單，則會忽略任何外部資訊清單。</span><span class="sxs-lookup"><span data-stu-id="2f27a-239">Note that any external manifest is ignored if the app has an internal manifest.</span></span> <span data-ttu-id="2f27a-240">例如︰</span><span class="sxs-lookup"><span data-stu-id="2f27a-240">For example:</span></span>  
<span data-ttu-id="2f27a-241"><並無 requestedexecutionlevel level = "" asInvoker \| highestAvailable \| requireAdministrator "" uiAccess = "" true \| false ""/></span><span class="sxs-lookup"><span data-stu-id="2f27a-241"><requestedExecutionLevel level=""asInvoker \| highestAvailable \| requireAdministrator"" uiAccess=""true\|false""/></span></span>  
</dl> </dd> 9.2 Your app s main process must be run as a standard user (asInvoker). <dl> <span data-ttu-id="2f27a-242">任何系統管理功能都必須移至以系統管理許可權執行的個別進程。</span><span class="sxs-lookup"><span data-stu-id="2f27a-242">Any administrative features must be moved into a separate process that runs with administrative privileges.</span></span> <span data-ttu-id="2f27a-243">使用者面向的應用程式，例如可透過 [開始] 功能表上的程式群組存取的應用程式，以及需要提高許可權的應用程式，都必須經過 Authenticode 簽署。</span><span class="sxs-lookup"><span data-stu-id="2f27a-243">User facing apps, such as those accessible through the program group on the Start-Menu, and requiring elevation must be Authenticode signed.</span></span>  
</dl> </dd> 9.3 Exceptions and Waivers <dl> <span data-ttu-id="2f27a-244">以更高的許可權執行其主要進程的應用程式需要棄權 (requireAdministrator 或 highestAvailable) 。</span><span class="sxs-lookup"><span data-stu-id="2f27a-244">A waiver is required for apps that run their main process with elevated privileges (requireAdministrator or highestAvailable).</span></span> <span data-ttu-id="2f27a-245">主要進程會識別為應用程式的使用者進入點。</span><span class="sxs-lookup"><span data-stu-id="2f27a-245">The main process is identified as the user s entry point to the app.</span></span> <span data-ttu-id="2f27a-246">在下列案例中，將會考慮棄權：</span><span class="sxs-lookup"><span data-stu-id="2f27a-246">Waivers will be considered for the following scenarios:</span></span>

-   <span data-ttu-id="2f27a-247">執行層級設為 highestAvailable 和/或 requireAdministrator 的系統管理或系統工具</span><span class="sxs-lookup"><span data-stu-id="2f27a-247">Administrative or system tools with execution level set to highestAvailable, and/or requireAdministrator</span></span>
-   <span data-ttu-id="2f27a-248">只有協助工具或 UI 自動化架構應用程式會將 uiAccess 旗標設為 true，以略過使用者介面許可權隔離 (UIPI) 。</span><span class="sxs-lookup"><span data-stu-id="2f27a-248">Only Accessibility or UI automation framework app sets the uiAccess flag to true to bypass the user interface privilege isolation (UIPI).</span></span> <span data-ttu-id="2f27a-249">若要適當地開始使用應用程式，此旗標必須經過 Authenticode 簽署，而且必須位於檔案系統中受保護的位置，也就是 Program Files。</span><span class="sxs-lookup"><span data-stu-id="2f27a-249">To properly start app utilization, this flag must be Authenticode signed, and must reside in a protected location in the file system, namely Program Files.</span></span>


</dl> </dd> </dl>

## <a name="10-apps-must-install-to-the-correct-folders-by-default"></a><span data-ttu-id="2f27a-250">10. 根據預設，應用程式必須安裝到正確的資料夾</span><span class="sxs-lookup"><span data-stu-id="2f27a-250">10. Apps must install to the correct folders by default</span></span>

<span data-ttu-id="2f27a-251">使用者的預設安裝位置應該具有一致且安全的體驗，同時維持在其選擇的位置安裝應用程式的選項。</span><span class="sxs-lookup"><span data-stu-id="2f27a-251">Users should have a consistent and secure experience with the default installation location of files, while maintaining the option to install an app in the location of their choice.</span></span> <span data-ttu-id="2f27a-252">此外，您也必須將應用程式資料儲存在正確的位置，以允許多人使用同一部電腦，而不會損毀或覆寫彼此的資料和設定。</span><span class="sxs-lookup"><span data-stu-id="2f27a-252">It is also necessary to store app data in the correct location to allow several people to use the same computer without corrupting or overwriting each other's data and settings.</span></span> <span data-ttu-id="2f27a-253">Windows 提供檔案系統中的特定位置，以儲存程式和軟體元件、共用應用程式資料，以及使用者專屬的應用程式資料</span><span class="sxs-lookup"><span data-stu-id="2f27a-253">Windows provides specific locations in the file system to store programs and software components, shared app data, and app data specific to a user</span></span><dl> <span data-ttu-id="2f27a-254">10.1 您的應用程式預設必須安裝在 Program Files 資料夾中</span><span class="sxs-lookup"><span data-stu-id="2f27a-254">10.1 Your app must be installed in the Program Files folder by default</span></span> <dl> <span data-ttu-id="2f27a-255">適用于% ProgramFiles% 中的原生32位和64位應用程式，以及在 x64 上執行32位應用程式的% ProgramFiles (x86) %。</span><span class="sxs-lookup"><span data-stu-id="2f27a-255">For native 32-bit and 64-bit apps in %ProgramFiles%, and %ProgramFiles(x86)% for 32-bit apps running on x64.</span></span> <span data-ttu-id="2f27a-256">因為此資料夾所設定的安全性許可權，所以使用者資料或應用程式資料永遠不會儲存在此位置。</span><span class="sxs-lookup"><span data-stu-id="2f27a-256">User data or app data must never be stored in this location because of the security permissions configured for this folder.</span></span>  
</dl> </dd> 10.2 Your app must avoid starting automatically on startup <dl> <span data-ttu-id="2f27a-257">例如，您的應用程式不應設定下列任何一項;</span><span class="sxs-lookup"><span data-stu-id="2f27a-257">For example, your app should not set any of the following;</span></span>  
</dl>

-   <span data-ttu-id="2f27a-258">登錄執行金鑰 HKLM、或軟體 \\ Microsoft \\ Windows \\ CURRENTVERSION 下的 HKCU</span><span class="sxs-lookup"><span data-stu-id="2f27a-258">Registry run keys HKLM and, or HKCU under Software\\Microsoft\\Windows\\CurrentVersion</span></span>
-   <span data-ttu-id="2f27a-259">登錄執行金鑰 HKLM 和或 HKCU 下的 Software \\ Wow6432Node \\ Microsoft \\ windows \\ CurrentVersion</span><span class="sxs-lookup"><span data-stu-id="2f27a-259">Registry run keys HKLM, and or HKCU under Software\\Wow6432Node\\Microsoft\\windows\\CurrentVersion</span></span>
-   <span data-ttu-id="2f27a-260">開始功能表 AllPrograms > 啟動</span><span class="sxs-lookup"><span data-stu-id="2f27a-260">Start Menu AllPrograms > STARTUP</span></span>

<span data-ttu-id="2f27a-261"></dd> 10.3 Your app data, which must be shared among users on the computer, should be stored within ProgramData  
10.4 Your app s data that is exclusive to a specific user and that is not to be shared with other users of the computer, must be stored in Users\\<username>\\AppData</span><span class="sxs-lookup"><span data-stu-id="2f27a-261"></dd> 10.3 Your app data, which must be shared among users on the computer, should be stored within ProgramData  
10.4 Your app s data that is exclusive to a specific user and that is not to be shared with other users of the computer, must be stored in Users\\<username>\\AppData</span></span>  
<span data-ttu-id="2f27a-262">10.5 您的應用程式絕不能直接寫入 "Windows" 目錄和或子目錄</span><span class="sxs-lookup"><span data-stu-id="2f27a-262">10.5 Your app must never write directly to the "Windows" directory and or subdirectories</span></span> <dl> <span data-ttu-id="2f27a-263">使用正確的方法來安裝檔案，例如字型或驅動程式。</span><span class="sxs-lookup"><span data-stu-id="2f27a-263">Use the correct methods for installing files, such as fonts or drivers.</span></span>  
</dl> </dd> 10.6 Your app must write user data at first run and not during the installation in  per-machine  installations <dl> <span data-ttu-id="2f27a-264">當應用程式安裝完成時，將不會有正確的使用者位置來儲存資料。</span><span class="sxs-lookup"><span data-stu-id="2f27a-264">When the app is installed, there is no correct user location in which to store data.</span></span> <span data-ttu-id="2f27a-265">在安裝之後，應用程式嘗試修改電腦層級的預設關聯線為將會失敗。</span><span class="sxs-lookup"><span data-stu-id="2f27a-265">Attempts by an app to modify default association behaviors at a machine level after installation will be unsuccessful.</span></span> <span data-ttu-id="2f27a-266">相反地，預設值必須在每個使用者層級宣告，如此可防止多個使用者覆寫彼此的預設值。</span><span class="sxs-lookup"><span data-stu-id="2f27a-266">Instead, defaults must be claimed on a per-user level, which prevents multiple users from overwriting each other's defaults.</span></span>  
</dl> </dd> 10.7 Exceptions and Waivers <dl> <span data-ttu-id="2f27a-267">寫入全域組件快取 (GAC 的應用程式必須要有棄權) .NET 應用程式應該將元件相依性保留為私用，並將其儲存在應用程式目錄中，除非明確需要共用元件。</span><span class="sxs-lookup"><span data-stu-id="2f27a-267">A waiver is required for apps that write to the global assembly cache (GAC) .NET apps should keep assembly dependencies private, and store it in the app directory unless sharing an assembly is explicitly required.</span></span>  
</dl> </dd> </dl>

## <a name="11-apps-must-support-multi-user-sessions"></a><span data-ttu-id="2f27a-268">11. 應用程式必須支援多個使用者會話</span><span class="sxs-lookup"><span data-stu-id="2f27a-268">11. Apps must support multi-user sessions</span></span>

<span data-ttu-id="2f27a-269">Windows 使用者應該能夠在不發生衝突或中斷的情況下執行並行會話。</span><span class="sxs-lookup"><span data-stu-id="2f27a-269">Windows users should be able to run concurrent sessions without conflict or disruption.</span></span><dl> <span data-ttu-id="2f27a-270">11.1 您的應用程式必須確保在本機或遠端執行多個會話時，應用程式的一般功能不會受到負面影響</span><span class="sxs-lookup"><span data-stu-id="2f27a-270">11.1 Your app must ensure that when running in multiple sessions either locally or remotely, the normal functionality of the app is not adversely affected</span></span>  
<span data-ttu-id="2f27a-271">11.2 您的應用程式設定和資料檔案不能跨使用者保存</span><span class="sxs-lookup"><span data-stu-id="2f27a-271">11.2 Your app s settings and data files must not persist across users</span></span>  
<span data-ttu-id="2f27a-272">11.3 使用者的隱私權和喜好設定必須與使用者會話隔離</span><span class="sxs-lookup"><span data-stu-id="2f27a-272">11.3 A user s privacy and preferences must be isolated to the user s session</span></span>  
<span data-ttu-id="2f27a-273">11.4 您的應用程式實例必須彼此隔離</span><span class="sxs-lookup"><span data-stu-id="2f27a-273">11.4 Your app s instances must be isolated from each other</span></span> <dl> <span data-ttu-id="2f27a-274">這表示應用程式的另一個實例看不到來自某個實例的使用者資料。</span><span class="sxs-lookup"><span data-stu-id="2f27a-274">This means that user data from one instance is not visible to another instance of the app.</span></span> <span data-ttu-id="2f27a-275">非作用中使用者會話中的音效不應該在使用中的使用者會話中聽到。</span><span class="sxs-lookup"><span data-stu-id="2f27a-275">Sound in an inactive user session should not be heard in an active user session.</span></span> <span data-ttu-id="2f27a-276">在多個應用程式實例使用共用資源的情況下，應用程式必須確保不會發生衝突。</span><span class="sxs-lookup"><span data-stu-id="2f27a-276">In cases where multiple app instances use shared resources, the app must ensure that there is not a conflict.</span></span>  
</dl> </dd> 11.5 Apps that are installed for multiple users must store data in the correct folder(s) and registry locations <dl> <span data-ttu-id="2f27a-277">請參閱 UAC 需求。</span><span class="sxs-lookup"><span data-stu-id="2f27a-277">Refer to the UAC requirements.</span></span>  
</dl> <span data-ttu-id="2f27a-278"></dd> 11.6 User apps must be able to run in multiple user sessions (Fast User Switching) for both local and remote access  
11.7 Your app must check other terminal service (TS) sessions for existing instances of the app  
</dl>
<strong>注意：</strong> 如果應用程式不支援多個使用者會話或遠端存取，從這類會話啟動時，它必須明確陳述這一點。</span><span class="sxs-lookup"><span data-stu-id="2f27a-278"></dd> 11.6 User apps must be able to run in multiple user sessions (Fast User Switching) for both local and remote access  
11.7 Your app must check other terminal service (TS) sessions for existing instances of the app  
</dl>
<strong>Note:</strong> If an app does not support multiple user sessions or remote access, it must clearly state this when launched from this kind of session.</span></span>

## <a name="12-apps-must-support-x64-versions-of-windows"></a><span data-ttu-id="2f27a-279">12. 應用程式必須支援 x64 版本的 Windows</span><span class="sxs-lookup"><span data-stu-id="2f27a-279">12. Apps must support x64 versions of Windows</span></span>

<span data-ttu-id="2f27a-280">隨著64位硬體變得更常見，使用者期望應用程式開發人員將其應用程式遷移至64位，或應用程式的32位版本在 Windows 的64位版本下執行，以利用64位架構的優點。</span><span class="sxs-lookup"><span data-stu-id="2f27a-280">As 64-bit hardware becomes more common, users expect app developers to take advantage of the benefits of 64-bit architecture by migrating their apps to 64-bit, or that 32-bit versions of the app run well under 64-bit versions of Windows.</span></span><dl> <span data-ttu-id="2f27a-281">12.1 您的應用程式必須以原生方式支援64位，或者，至少32位的 Windows 應用程式必須在64位系統上順暢地執行，以維持與 Windows 的64位版本的相容性。</span><span class="sxs-lookup"><span data-stu-id="2f27a-281">12.1 Your app must natively support 64-bit or, at a minimum, 32-bit Windows-based apps must run seamlessly on 64-bit systems to maintain compatibility with 64-bit versions of Windows</span></span>  
<span data-ttu-id="2f27a-282">12.2 您的應用程式及其安裝程式不得包含任何16位程式碼，或依賴任何16位元件</span><span class="sxs-lookup"><span data-stu-id="2f27a-282">12.2 Your app and its installers must not contain any 16-bit code or rely on any 16-bit component</span></span>  
<span data-ttu-id="2f27a-283">12.3 您的應用程式安裝程式必須偵測並安裝適用于64位架構的適當驅動程式和元件</span><span class="sxs-lookup"><span data-stu-id="2f27a-283">12.3 Your app s setup must detect and install the proper drivers and components for the 64-bit architecture</span></span>  
<span data-ttu-id="2f27a-284">12.4 任何 shell 外掛程式都必須在64位版本的 Windows 上執行</span><span class="sxs-lookup"><span data-stu-id="2f27a-284">12.4 Any shell plug-ins must run on 64-bit versions of Windows</span></span>  
<span data-ttu-id="2f27a-285">在 WoW64 模擬器下執行的12.5 應用程式不應嘗試破壞或略過 Wow64 虛擬化機制</span><span class="sxs-lookup"><span data-stu-id="2f27a-285">12.5 App running under the WoW64 emulator should not attempt to subvert or bypass Wow64 virtualization mechanisms</span></span> <dl> <span data-ttu-id="2f27a-286">如果有特定案例，應用程式必須偵測它們是否正在 WoW64 模擬器下執行，則應該呼叫 IsWow64Process 來執行此動作。</span><span class="sxs-lookup"><span data-stu-id="2f27a-286">If there are specific scenarios where apps need to detect whether they are running under the WoW64 emulator, they should do so by calling IsWow64Process.</span></span>  
</dl> </dd> </dl>

## <a name="conclusion"></a><span data-ttu-id="2f27a-287">結論</span><span class="sxs-lookup"><span data-stu-id="2f27a-287">Conclusion</span></span>

<span data-ttu-id="2f27a-288">當這些需求演進時，我們會注意以下修訂歷程記錄中的變更。</span><span class="sxs-lookup"><span data-stu-id="2f27a-288">As these requirements evolve, we will note the changes in the revision history below.</span></span> <span data-ttu-id="2f27a-289">穩定的需求是執行最佳工作的關鍵，因此我們的目標是要確保我們所做的變更具有持續性，並持續保護和強化您的應用程式。</span><span class="sxs-lookup"><span data-stu-id="2f27a-289">Stable requirements are critical to doing your best work, so we will aim to ensure the changes we do make are sustainable and continue to protect and enhance your apps.</span></span>

<span data-ttu-id="2f27a-290">再次感謝您參與我們的承諾，以提供絕佳的客戶體驗。</span><span class="sxs-lookup"><span data-stu-id="2f27a-290">Thank you again for joining in our commitment to delivering great customer experiences.</span></span>

## <a name="revision-history"></a><span data-ttu-id="2f27a-291">修訂歷程記錄</span><span class="sxs-lookup"><span data-stu-id="2f27a-291">Revision history</span></span>



| <span data-ttu-id="2f27a-292">日期</span><span class="sxs-lookup"><span data-stu-id="2f27a-292">Date</span></span>          | <span data-ttu-id="2f27a-293">版本</span><span class="sxs-lookup"><span data-stu-id="2f27a-293">Version</span></span> | <span data-ttu-id="2f27a-294">修訂描述</span><span class="sxs-lookup"><span data-stu-id="2f27a-294">Revision description</span></span>                   | <span data-ttu-id="2f27a-295">文件連結</span><span class="sxs-lookup"><span data-stu-id="2f27a-295">Link to document</span></span>                                                                 |
|---------------|---------|----------------------------------------|----------------------------------------------------------------------------------|
| <span data-ttu-id="2f27a-296">2011年12月20日</span><span class="sxs-lookup"><span data-stu-id="2f27a-296">Dec 20, 2011</span></span>  | <span data-ttu-id="2f27a-297">1.0</span><span class="sxs-lookup"><span data-stu-id="2f27a-297">1.0</span></span>     | <span data-ttu-id="2f27a-298">預覽的檔初稿。</span><span class="sxs-lookup"><span data-stu-id="2f27a-298">Initial draft of document for Preview.</span></span> |                                                                                  |
| <span data-ttu-id="2f27a-299">2012年1月26日</span><span class="sxs-lookup"><span data-stu-id="2f27a-299">Jan 26, 2012</span></span>  | <span data-ttu-id="2f27a-300">1.1</span><span class="sxs-lookup"><span data-stu-id="2f27a-300">1.1</span></span>     | <span data-ttu-id="2f27a-301">更新為第 \# 2 節。</span><span class="sxs-lookup"><span data-stu-id="2f27a-301">Update to section \#2.</span></span>                 | [<span data-ttu-id="2f27a-302">1.1</span><span class="sxs-lookup"><span data-stu-id="2f27a-302">1.1</span></span>](archive--certification-requirements-for-windows-desktop-apps-v1-1.md)     |
| <span data-ttu-id="2f27a-303">2012年5月31日</span><span class="sxs-lookup"><span data-stu-id="2f27a-303">May 31, 2012</span></span>  | <span data-ttu-id="2f27a-304">1.2</span><span class="sxs-lookup"><span data-stu-id="2f27a-304">1.2</span></span>     | <span data-ttu-id="2f27a-305">已新增摘要測試結果</span><span class="sxs-lookup"><span data-stu-id="2f27a-305">Added summary test results</span></span>             | [<span data-ttu-id="2f27a-306">1.2</span><span class="sxs-lookup"><span data-stu-id="2f27a-306">1.2</span></span>](archive--certification-requirements-for-windows-desktop-apps-v1-2.md)     |
| <span data-ttu-id="2f27a-307">2012年6月29日</span><span class="sxs-lookup"><span data-stu-id="2f27a-307">Jun 29, 2012</span></span>  | <span data-ttu-id="2f27a-308">3.0</span><span class="sxs-lookup"><span data-stu-id="2f27a-308">3.0</span></span>     | <span data-ttu-id="2f27a-309">Windows 8 最終檔</span><span class="sxs-lookup"><span data-stu-id="2f27a-309">Windows 8 final document</span></span>               | [<span data-ttu-id="2f27a-310">3.0</span><span class="sxs-lookup"><span data-stu-id="2f27a-310">3.0</span></span>](archive--certification-requirements-for-windows-desktop-apps-v3-0.md)     |
| <span data-ttu-id="2f27a-311">2013年6月18日</span><span class="sxs-lookup"><span data-stu-id="2f27a-311">Jun 18, 2013</span></span>  | <span data-ttu-id="2f27a-312">3.1</span><span class="sxs-lookup"><span data-stu-id="2f27a-312">3.1</span></span>     | <span data-ttu-id="2f27a-313">Windows 8.1 檔</span><span class="sxs-lookup"><span data-stu-id="2f27a-313">Windows 8.1 document</span></span>                   | [<span data-ttu-id="2f27a-314">3.1</span><span class="sxs-lookup"><span data-stu-id="2f27a-314">3.1</span></span>](archive--certification-requirements-for-windows-desktop-apps-v3-1.md)     |
| <span data-ttu-id="2f27a-315">2014年2月20日</span><span class="sxs-lookup"><span data-stu-id="2f27a-315">Feb 20, 2014</span></span>  | <span data-ttu-id="2f27a-316">3.2</span><span class="sxs-lookup"><span data-stu-id="2f27a-316">3.2</span></span>     | <span data-ttu-id="2f27a-317">內部更新</span><span class="sxs-lookup"><span data-stu-id="2f27a-317">Internal update</span></span>                        |                                                                                  |
| <span data-ttu-id="2f27a-318">2014年3月18日</span><span class="sxs-lookup"><span data-stu-id="2f27a-318">Mar 18, 2014</span></span>  | <span data-ttu-id="2f27a-319">3.3</span><span class="sxs-lookup"><span data-stu-id="2f27a-319">3.3</span></span>     | <span data-ttu-id="2f27a-320">Windows 8.1 更新版1</span><span class="sxs-lookup"><span data-stu-id="2f27a-320">Windows 8.1 Update 1</span></span>                   | [<span data-ttu-id="2f27a-321">3.3</span><span class="sxs-lookup"><span data-stu-id="2f27a-321">3.3</span></span>](https://www.bing.com/search?q=3.3) |
| <span data-ttu-id="2f27a-322">2015 年 7 月 29 日</span><span class="sxs-lookup"><span data-stu-id="2f27a-322">July 29, 2015</span></span> | <span data-ttu-id="2f27a-323">10</span><span class="sxs-lookup"><span data-stu-id="2f27a-323">10</span></span>      | <span data-ttu-id="2f27a-324">Windows 10 更新</span><span class="sxs-lookup"><span data-stu-id="2f27a-324">Windows 10 Update</span></span>                      | <span data-ttu-id="2f27a-325">10</span><span class="sxs-lookup"><span data-stu-id="2f27a-325">10</span></span>                                                                               |





## <a name="learn-more-about-desktop-app-certification"></a><span data-ttu-id="2f27a-326">深入瞭解傳統型應用程式認證</span><span class="sxs-lookup"><span data-stu-id="2f27a-326">Learn more about desktop app certification</span></span>



<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<tbody>
<tr class="odd">
<td><span data-ttu-id="2f27a-327">需求</span><span class="sxs-lookup"><span data-stu-id="2f27a-327">Requirement</span></span></td>
<td><span data-ttu-id="2f27a-328">描述</span><span class="sxs-lookup"><span data-stu-id="2f27a-328">Description</span></span></td>
</tr>
<tr class="even">
<td><span data-ttu-id="2f27a-329">相容性與復原能力</span><span class="sxs-lookup"><span data-stu-id="2f27a-329">Compatibility and resiliency</span></span></td>
<td><span data-ttu-id="2f27a-330">當機 & 當機時，會導致使用者嚴重中斷，並導致挫折。</span><span class="sxs-lookup"><span data-stu-id="2f27a-330">Crashes & hangs are a major disruption to users and cause frustration.</span></span> <span data-ttu-id="2f27a-331">應用程式應該具有復原能力和穩定性，消除這類失敗有助於確保軟體的可預測性、可維護性、效能和可信度。</span><span class="sxs-lookup"><span data-stu-id="2f27a-331">Apps are expected to be resilient and stable, eliminating such failures helps ensure that software is more predictable, maintainable, performant and trustworthy.</span></span><br/> <span data-ttu-id="2f27a-332">使用者面向的應用程式進入點必須針對相容性進行資訊清單，以及宣告正確的 GUID。</span><span class="sxs-lookup"><span data-stu-id="2f27a-332">User facing app entry point must be manifested for compatibility, as well as declaring the right GUID.</span></span> <br/> <span data-ttu-id="2f27a-333">使用者面向的應用程式進入點必須針對高 DPI 感知來提供，而且會呼叫適當的 Api 來支援高 DPI。</span><span class="sxs-lookup"><span data-stu-id="2f27a-333">User facing app entry points must be manifested for HIGH-DPI awareness and that the proper APIs are being called to support HIGH-DPI.</span></span><br/> <span data-ttu-id="2f27a-334">如需詳細資訊，請參閱：</span><span class="sxs-lookup"><span data-stu-id="2f27a-334">For more information see:</span></span>
<ul>
<li><span data-ttu-id="2f27a-335"><a href="https://support.microsoft.com/kb/197571">AppInit Dll</a></span><span class="sxs-lookup"><span data-stu-id="2f27a-335"><a href="https://support.microsoft.com/kb/197571">AppInit DLLs</a></span></span></li>
<li><span data-ttu-id="2f27a-336"><a href="/windows/desktop/w8cookbook/application--executable--manifest">應用程式 (可執行檔) 資訊清單</a></span><span class="sxs-lookup"><span data-stu-id="2f27a-336"><a href="/windows/desktop/w8cookbook/application--executable--manifest">App (executable) manifest</a></span></span></li>
<li><span data-ttu-id="2f27a-337"><a href="/windows/desktop/hidpi/high-dpi-desktop-application-development-on-windows">撰寫高 DPI 的 Win32 應用程式</a></span><span class="sxs-lookup"><span data-stu-id="2f27a-337"><a href="/windows/desktop/hidpi/high-dpi-desktop-application-development-on-windows">Writing High-DPI Win32 Applications</a></span></span></li>
</ul>
<br/></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="2f27a-338">遵循 Windows 安全性的最佳作法</span><span class="sxs-lookup"><span data-stu-id="2f27a-338">Adhere to Windows Security Best Practices</span></span></td>
<td><span data-ttu-id="2f27a-339">使用 Windows 安全性最佳作法有助於避免建立 Windows 攻擊面的風險。</span><span class="sxs-lookup"><span data-stu-id="2f27a-339">Using Windows security best practices will help avoid creating exposure to Windows attack surfaces.</span></span> <span data-ttu-id="2f27a-340">攻擊面是惡意攻擊者利用目標軟體中的弱點來惡意探索作業系統的進入點。</span><span class="sxs-lookup"><span data-stu-id="2f27a-340">Attack surfaces are the entry points that a malicious attacker could use to exploit the operating system by taking advantage of vulnerabilities in the target software.</span></span> <span data-ttu-id="2f27a-341">其中一個最糟的安全性弱點是權限提高。</span><span class="sxs-lookup"><span data-stu-id="2f27a-341">One of the worst security vulnerabilities is the elevation of privilege.</span></span><br/> <span data-ttu-id="2f27a-342">如需詳細資訊，請參閱：</span><span class="sxs-lookup"><span data-stu-id="2f27a-342">For more information see:</span></span>
<ul>
<li><span data-ttu-id="2f27a-343"><a href="https://technet.microsoft.com/security/gg749821">Attack Surface Analyzer</a></span><span class="sxs-lookup"><span data-stu-id="2f27a-343"><a href="https://technet.microsoft.com/security/gg749821">Attack Surface Analyzer</a></span></span></li>
<li><span data-ttu-id="2f27a-344"><a href="/windows/desktop/SecAuthZ/access-control-lists">存取控制清單</a></span><span class="sxs-lookup"><span data-stu-id="2f27a-344"><a href="/windows/desktop/SecAuthZ/access-control-lists">Access Control Lists</a></span></span></li>
</ul>
<br/></td>
</tr>
<tr class="even">
<td><span data-ttu-id="2f27a-345">支援 Windows 安全性功能</span><span class="sxs-lookup"><span data-stu-id="2f27a-345">Support Windows Security Features</span></span></td>
<td><span data-ttu-id="2f27a-346">Windows 作業系統已實行許多措施來支援系統安全性和隱私權。</span><span class="sxs-lookup"><span data-stu-id="2f27a-346">The Windows operating system has implemented many measures to support system security and privacy.</span></span> <span data-ttu-id="2f27a-347">應用程式必須支援這些措施，才能維持作業系統的完整性。</span><span class="sxs-lookup"><span data-stu-id="2f27a-347">Applications must support these measures to maintain the integrity of the OS.</span></span> <span data-ttu-id="2f27a-348">編譯不當的應用程式可能會導致緩衝區溢位，進而導致拒絕服務或執行惡意程式碼。</span><span class="sxs-lookup"><span data-stu-id="2f27a-348">Improperly compiled applications could cause buffer overruns that in turn could cause denial of service or make malicious code execute.</span></span> <span data-ttu-id="2f27a-349">如需詳細資訊，請參閱 <a href="https://blogs.microsoft.com/cybertrust/2012/08/15/microsofts-free-security-tools-binscope-binary-analyzer/">BinScope tool 參考</a>。</span><span class="sxs-lookup"><span data-stu-id="2f27a-349">For more information see the <a href="https://blogs.microsoft.com/cybertrust/2012/08/15/microsofts-free-security-tools-binscope-binary-analyzer/">BinScope tool reference</a>.</span></span></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="2f27a-350">遵守系統重新開機管理員訊息</span><span class="sxs-lookup"><span data-stu-id="2f27a-350">Adhere to System Restart Manager Messages</span></span></td>
<td><span data-ttu-id="2f27a-351">當使用者啟動關機時，在大部分的情況下，他們都強烈希望能夠看到關機成功;他們可能會在離開辦公室的同時， &quot; 只想要讓 &quot; 電腦關閉。</span><span class="sxs-lookup"><span data-stu-id="2f27a-351">When users initiate shutdown, in the vast majority of cases, they have a strong desire to see shutdown succeed; they may be in a hurry to leave the office and &quot;just want&quot; their computers to turn off.</span></span> <span data-ttu-id="2f27a-352">應用程式必須遵守此需求，而不會封鎖關機。</span><span class="sxs-lookup"><span data-stu-id="2f27a-352">Apps must respect this desire by not blocking shutdown.</span></span> <span data-ttu-id="2f27a-353">雖然在大部分情況下，關閉可能不會很重要，但應用程式必須針對重大關機的可能性做好準備。</span><span class="sxs-lookup"><span data-stu-id="2f27a-353">While in most cases, a shutdown may not be critical, apps must be prepared for the possibility of a critical shutdown.</span></span></td>
</tr>
<tr class="even">
<td><span data-ttu-id="2f27a-354">乾淨的可還原安裝</span><span class="sxs-lookup"><span data-stu-id="2f27a-354">Clean Reversible Installation</span></span></td>
<td><span data-ttu-id="2f27a-355">乾淨、可還原的安裝可讓使用者順利管理 (在其系統上部署和移除) 應用程式。</span><span class="sxs-lookup"><span data-stu-id="2f27a-355">A clean, reversible, installation allows users to successfully manage (deploy and remove) apps on their systems.</span></span> <span data-ttu-id="2f27a-356">如需詳細資訊，請參閱 <a href="/visualstudio/deployment/how-to-install-prerequisites-with-a-clickonce-application?view=vs-2015">如何：使用 ClickOnce 應用程式安裝必要條件</a>。</span><span class="sxs-lookup"><span data-stu-id="2f27a-356">For more information see, <a href="/visualstudio/deployment/how-to-install-prerequisites-with-a-clickonce-application?view=vs-2015">How to: Install Prerequisites with a ClickOnce Application</a>.</span></span></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="2f27a-357">數位簽署檔案和驅動程式</span><span class="sxs-lookup"><span data-stu-id="2f27a-357">Digitally sign files and drivers</span></span></td>
<td><span data-ttu-id="2f27a-358">Authenticode 數位簽章可讓使用者確認軟體是否為正版。</span><span class="sxs-lookup"><span data-stu-id="2f27a-358">An Authenticode digital signature allows users to be sure that the software is genuine.</span></span> <span data-ttu-id="2f27a-359">它也可讓您偵測檔案是否已遭篡改，例如，是否已受到病毒感染。</span><span class="sxs-lookup"><span data-stu-id="2f27a-359">It also allows one to detect whether a file has been tampered with, for example, if it has been infected by a virus.</span></span> <span data-ttu-id="2f27a-360">核心模式程式碼簽署強制是一項稱為程式碼完整性 (CI) 的 Windows 功能，可在每次將檔案映射載入記憶體時驗證檔案的完整性，藉此改善作業系統的安全性。</span><span class="sxs-lookup"><span data-stu-id="2f27a-360">Kernel-mode code signing enforcement is a Windows feature known as code integrity (CI), which improves the security of the operating system by verifying the integrity of a file each time the image of the file is loaded into memory.</span></span> <span data-ttu-id="2f27a-361">CI 會偵測惡意程式碼是否已修改系統二進位檔案。</span><span class="sxs-lookup"><span data-stu-id="2f27a-361">CI detects whether malicious code has modified a system binary file.</span></span> <span data-ttu-id="2f27a-362">當核心模組的簽章無法正確確認時，也會產生診斷和系統審核記錄事件。</span><span class="sxs-lookup"><span data-stu-id="2f27a-362">Also generates a diagnostic and system-audit log event when the signature of a kernel module fails to verify correctly.</span></span><br/></td>
</tr>
<tr class="even">
<td><span data-ttu-id="2f27a-363">請勿根據作業系統版本檢查封鎖安裝或應用程式啟動</span><span class="sxs-lookup"><span data-stu-id="2f27a-363">Do not block installation or app launch based on operating system version check</span></span></td>
<td><span data-ttu-id="2f27a-364">當客戶沒有技術限制時，請務必讓客戶無法安裝或執行其應用程式。</span><span class="sxs-lookup"><span data-stu-id="2f27a-364">It is important that customers are not artificially blocked from installing or running their app when there are no technical limitations.</span></span> <span data-ttu-id="2f27a-365">一般來說，如果應用程式是針對 Windows Vista 或更新版本所撰寫，則應該沒有理由檢查作業系統版本。</span><span class="sxs-lookup"><span data-stu-id="2f27a-365">In general, if apps were written for Windows Vista or later releases, they should have no reason to check the operating system version.</span></span> <span data-ttu-id="2f27a-366">如需詳細資訊，請參閱 <a href="/windows/desktop/Win7AppQual/operating-system-versioning">作業系統版本控制</a>。</span><span class="sxs-lookup"><span data-stu-id="2f27a-366">For more information see, <a href="/windows/desktop/Win7AppQual/operating-system-versioning">Operating System Versioning</a>.</span></span></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="2f27a-367">請勿以安全模式載入服務和驅動程式</span><span class="sxs-lookup"><span data-stu-id="2f27a-367">Do not load Services and Drivers in Safe Mode</span></span></td>
<td><span data-ttu-id="2f27a-368">安全模式可讓使用者診斷和疑難排解 Windows。</span><span class="sxs-lookup"><span data-stu-id="2f27a-368">Safe mode allows users to diagnose and troubleshoot Windows.</span></span> <span data-ttu-id="2f27a-369">除非系統的基本作業需要 (例如，儲存設備磁碟機) 或用於診斷和復原用途 (例如，防毒程式) 、驅動程式和服務不得設定為以安全模式載入。</span><span class="sxs-lookup"><span data-stu-id="2f27a-369">Unless needed for basic operations of the system (for example, storage device drivers) or for diagnostic and recovery purposes (for example, anti-virus scanners), drivers and services must not be set to load in safe mode.</span></span> <span data-ttu-id="2f27a-370">根據預設，安全模式不會啟動大部分未預先安裝 Windows 的驅動程式和服務。</span><span class="sxs-lookup"><span data-stu-id="2f27a-370">By default, the safe mode does not start most drivers and services that did not come preinstalled with Windows.</span></span> <span data-ttu-id="2f27a-371">除非系統需要它們進行基本作業或用於診斷和復原，否則應保持停用。</span><span class="sxs-lookup"><span data-stu-id="2f27a-371">They should remain disabled unless the system requires them for basic operations or for diagnostic and recovery purposes.</span></span><br/> <span data-ttu-id="2f27a-372">如需詳細資訊，請參閱：</span><span class="sxs-lookup"><span data-stu-id="2f27a-372">For more information see:</span></span>
<ul>
<li><span data-ttu-id="2f27a-373"><a href="/windows-hardware/drivers/kernel/determining-whether-the-operating-system-is-running-in-safe-mode">判斷作業系統是否以安全模式執行</a></span><span class="sxs-lookup"><span data-stu-id="2f27a-373"><a href="/windows-hardware/drivers/kernel/determining-whether-the-operating-system-is-running-in-safe-mode">Determining Whether the Operating System Is Running in Safe Mode</a></span></span></li>
<li><span data-ttu-id="2f27a-374"><a href="https://support.microsoft.com/kb/837643">如何判斷系統是否從設備磁碟機以安全模式執行</a></span><span class="sxs-lookup"><span data-stu-id="2f27a-374"><a href="https://support.microsoft.com/kb/837643">How to determine whether the system is running in Safe Mode from a device driver</a></span></span></li>
</ul>
<br/></td>
</tr>
<tr class="even">
<td><span data-ttu-id="2f27a-375">遵循使用者帳戶控制 (UAC) 指導方針</span><span class="sxs-lookup"><span data-stu-id="2f27a-375">Follow User Account Control (UAC) Guidelines</span></span></td>
<td><span data-ttu-id="2f27a-376">某些 Windows 應用程式會在系統管理員帳戶的安全性內容中執行，而許多應用程式需要過多的使用者權限和 Windows 許可權。</span><span class="sxs-lookup"><span data-stu-id="2f27a-376">Some Windows app run in the security context of an administrator account, and many require excessive user rights and Windows privileges.</span></span> <span data-ttu-id="2f27a-377">控制資源的存取權，可讓使用者控制其系統免于不必要的變更 (不必要的變更可能是惡意的，例如接管電腦的 rootkit 暗中;，或是具有有限許可權之人員的動作，例如，將禁止的軟體安裝在工作電腦上的員工) 。</span><span class="sxs-lookup"><span data-stu-id="2f27a-377">Controlling access to resources enables users to be in control of their systems against unwanted changes (An unwanted change can be malicious, such as a rootkit stealthily taking over the machine, or an action from people who have limited privileges, for example, an employee installing prohibited software on a work computer).</span></span> <span data-ttu-id="2f27a-378">控制資源存取最重要的規則就是提供使用者執行其必要工作所需的最少量存取標準使用者內容。</span><span class="sxs-lookup"><span data-stu-id="2f27a-378">The most important rule for controlling access to resources is to provide the least amount of access  standard user context  necessary for a user to perform his or her necessary tasks.</span></span> <span data-ttu-id="2f27a-379">遵循 UAC 指導方針可在需要時提供應用程式必要的許可權，而不會讓系統持續暴露于安全性風險。</span><span class="sxs-lookup"><span data-stu-id="2f27a-379">Following UAC guidelines provides app with the necessary permissions when needed, without leaving the system constantly exposed to security risks.</span></span><br/> <span data-ttu-id="2f27a-380">如需詳細資訊，請參閱：</span><span class="sxs-lookup"><span data-stu-id="2f27a-380">For more information see:</span></span>
<ul>
<li><span data-ttu-id="2f27a-381"><a href="/windows/desktop/uxguide/winenv-uac">使用者帳戶控制</a></span><span class="sxs-lookup"><span data-stu-id="2f27a-381"><a href="/windows/desktop/uxguide/winenv-uac">User Account Control</a></span></span></li>
<li><span data-ttu-id="2f27a-382"><a href="/previous-versions/aa480152(v=msdn.10)">UAC：應用程式更新指導方針</a></span><span class="sxs-lookup"><span data-stu-id="2f27a-382"><a href="/previous-versions/aa480152(v=msdn.10)">UAC: Application Update Guidelines</a></span></span></li>
</ul>
<br/></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="2f27a-383">依預設安裝到正確的資料夾</span><span class="sxs-lookup"><span data-stu-id="2f27a-383">Install to the Correct Folders by Default</span></span></td>
<td><span data-ttu-id="2f27a-384">使用者的預設安裝位置應該具有一致且安全的體驗，同時保有將應用程式安裝至所選位置的選項。</span><span class="sxs-lookup"><span data-stu-id="2f27a-384">Users should have a consistent and secure experience with the default installation location of files, while maintaining the option to install an app to the location they choose.</span></span> <span data-ttu-id="2f27a-385">此外，您也必須將應用程式資料儲存在正確的位置，以允許多人使用同一部電腦，而不會損毀或覆寫彼此的資料和設定。</span><span class="sxs-lookup"><span data-stu-id="2f27a-385">It is also necessary to store app data in the correct location to allow several people to use the same computer without corrupting or overwriting each other's data and settings.</span></span> <span data-ttu-id="2f27a-386">如需詳細資訊，請參閱 <a href="/previous-versions/ms954376(v=msdn.10)">安裝/卸載需求的摘要</a>。</span><span class="sxs-lookup"><span data-stu-id="2f27a-386">For more information see, <a href="/previous-versions/ms954376(v=msdn.10)">Summary of Install/Uninstall Requirements</a>.</span></span></td>
</tr>
<tr class="even">
<td><span data-ttu-id="2f27a-387">支援多使用者會話</span><span class="sxs-lookup"><span data-stu-id="2f27a-387">Support Multi-User Sessions</span></span></td>
<td><span data-ttu-id="2f27a-388">Windows 使用者應該能夠在不發生衝突或中斷的情況下執行並行會話。</span><span class="sxs-lookup"><span data-stu-id="2f27a-388">Windows users should be able to run concurrent sessions without conflict or disruption.</span></span> <span data-ttu-id="2f27a-389">如需詳細資訊，請參閱 <a href="/windows/desktop/TermServ/terminal-services-programming-guidelines">遠端桌面服務程式設計指導方針</a>。</span><span class="sxs-lookup"><span data-stu-id="2f27a-389">For more information see, <a href="/windows/desktop/TermServ/terminal-services-programming-guidelines">Remote Desktop Services Programming Guidelines</a>.</span></span></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="2f27a-390">支援 x64 版本的 Windows</span><span class="sxs-lookup"><span data-stu-id="2f27a-390">Support x64 versions of Windows</span></span></td>
<td><span data-ttu-id="2f27a-391">隨著64位硬體越來越普及，使用者期望應用程式開發人員將其應用程式遷移至64位，或應用程式的32位版本在 Windows 的64位版本下執行，以利用64位架構的優點。</span><span class="sxs-lookup"><span data-stu-id="2f27a-391">As 64-bit hardware becomes more prevalent, users expect app developers to take advantage of the benefits of 64-bit architecture by migrating their apps to 64-bit, or that 32-bit versions of the app run well under 64-bit versions of Windows.</span></span></td>
</tr>
</tbody>
</table>





## <a name="see-also"></a><span data-ttu-id="2f27a-392">另請參閱</span><span class="sxs-lookup"><span data-stu-id="2f27a-392">See also</span></span>

-   <span data-ttu-id="2f27a-393">[Windows 硬體認證計畫](/previous-versions/windows/hardware/hck/jj124227(v=vs.85))</span><span class="sxs-lookup"><span data-stu-id="2f27a-393">[Windows Hardware Certification Program](/previous-versions/windows/hardware/hck/jj124227(v=vs.85))</span></span>
-   [<span data-ttu-id="2f27a-394">如何使用 Windows 應用程式認證套件</span><span class="sxs-lookup"><span data-stu-id="2f27a-394">How to use the Windows App Certification Kit</span></span>](./using-the-windows-app-certification-kit.md)