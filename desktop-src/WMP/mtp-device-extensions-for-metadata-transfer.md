---
title: 適用于中繼資料傳輸的 MTP 裝置擴充功能
description: 適用于中繼資料傳輸的 MTP 裝置擴充功能
ms.assetid: 9cf68373-e84f-4568-a9da-16ddee0fc4e9
keywords:
- Windows Media Player，MTP 裝置擴充功能
- Windows Media Player、裝置擴充功能
- Windows Media Player、延伸模組
- Windows Media Player，中繼資料
- 'Windows Media Player，媒體傳輸通訊協定 (MTP) '
- '媒體傳輸通訊協定 (MTP) '
- 'MTP (媒體傳輸通訊協定) '
- 中繼資料、MTP 裝置延伸模組
- 中繼資料，裝置延伸模組
- 中繼資料，延伸模組
- 裝置延伸模組，中繼資料傳輸
- 延伸模組，中繼資料傳輸
- 適用于中繼資料傳輸的 MTP 裝置擴充功能
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f64ff16fd97f135d7f8c902af823b967079408fb
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 09/16/2019
ms.locfileid: "104020772"
---
# <a name="mtp-device-extensions-for-metadata-transfer"></a><span data-ttu-id="1df6a-116">適用于中繼資料傳輸的 MTP 裝置擴充功能</span><span class="sxs-lookup"><span data-stu-id="1df6a-116">MTP Device Extensions for Metadata Transfer</span></span>

<span data-ttu-id="1df6a-117">媒體傳輸通訊協定 (MTP) 是為便攜媒體裝置設計的通訊協定。</span><span class="sxs-lookup"><span data-stu-id="1df6a-117">Media Transfer Protocol (MTP) is a protocol designed for portable media devices.</span></span> <span data-ttu-id="1df6a-118">此通訊協定的主要目的是提供通用通訊協定，以便在電腦和便攜媒體裝置之間交換資料。</span><span class="sxs-lookup"><span data-stu-id="1df6a-118">The primary purpose of this protocol is to provide a common protocol for exchanging data between a computer and a portable media device.</span></span> <span data-ttu-id="1df6a-119">這包括接收和傳送媒體物件，以及列舉裝置的內容和功能。</span><span class="sxs-lookup"><span data-stu-id="1df6a-119">This includes receiving and sending media objects and enumerating the contents and capabilities of the device.</span></span>

<span data-ttu-id="1df6a-120">MTP 使用持續性的唯一物件識別碼 (PUOIDs) 來唯一識別 (的數位媒體專案，以及) 儲存在裝置上的其他物件。</span><span class="sxs-lookup"><span data-stu-id="1df6a-120">MTP uses persistent unique object identifiers (PUOIDs) to uniquely identify digital media items (and other objects) stored on a device.</span></span> <span data-ttu-id="1df6a-121">當您交換有關裝置上已發生之變更的資訊時，裝置和 Windows Media Player 會使用 PUOIDs 來識別已變更的物件。</span><span class="sxs-lookup"><span data-stu-id="1df6a-121">When exchanging information about changes that have occurred on a device that supports MTP, the device and Windows Media Player use PUOIDs to identify which objects have changed.</span></span>

<span data-ttu-id="1df6a-122">名為 wmpdevices 的標頭檔（安裝為 Windows Media Player SDK 的一部分）會定義支援 Windows Media Player 裝置延伸模組所需的結構和常數。</span><span class="sxs-lookup"><span data-stu-id="1df6a-122">The header file named wmpdevices.h, which is installed as part of the Windows Media Player SDK, defines the structures and constants needed to support Windows Media Player device extensions.</span></span>

<span data-ttu-id="1df6a-123">若要將裝置辨識為支援透過 Windows Media Player MTP 裝置延伸模組進行的中繼資料傳輸，必須將下列資訊包含在 DeviceInfo 資料集中。</span><span class="sxs-lookup"><span data-stu-id="1df6a-123">For a device to be recognized as supporting metadata transfer through the Windows Media Player MTP device extension set, it must include the following information in the DeviceInfo dataset.</span></span> <span data-ttu-id="1df6a-124"> (如需此資料集的詳細資訊，請參閱 MTP 規格的4.6.1 一節。 ) </span><span class="sxs-lookup"><span data-stu-id="1df6a-124">(For more information about this dataset, see section 4.6.1 of the MTP specification.)</span></span>



| <span data-ttu-id="1df6a-125">資料集欄位</span><span class="sxs-lookup"><span data-stu-id="1df6a-125">Dataset field</span></span>          | <span data-ttu-id="1df6a-126">欄位順序</span><span class="sxs-lookup"><span data-stu-id="1df6a-126">Field order</span></span> | <span data-ttu-id="1df6a-127">資料類型</span><span class="sxs-lookup"><span data-stu-id="1df6a-127">Data type</span></span>  | <span data-ttu-id="1df6a-128">值</span><span class="sxs-lookup"><span data-stu-id="1df6a-128">Value</span></span>                       |
|------------------------|-------------|------------|-----------------------------|
| <span data-ttu-id="1df6a-129">VendorExtensionID</span><span class="sxs-lookup"><span data-stu-id="1df6a-129">VendorExtensionID</span></span>      | <span data-ttu-id="1df6a-130">2</span><span class="sxs-lookup"><span data-stu-id="1df6a-130">2</span></span>           | <span data-ttu-id="1df6a-131">**UINT32**</span><span class="sxs-lookup"><span data-stu-id="1df6a-131">**UINT32**</span></span> | <span data-ttu-id="1df6a-132">0x00000006</span><span class="sxs-lookup"><span data-stu-id="1df6a-132">0x00000006</span></span>                  |
| <span data-ttu-id="1df6a-133">VendorExtensionVersion</span><span class="sxs-lookup"><span data-stu-id="1df6a-133">VendorExtensionVersion</span></span> | <span data-ttu-id="1df6a-134">3</span><span class="sxs-lookup"><span data-stu-id="1df6a-134">3</span></span>           | <span data-ttu-id="1df6a-135">**UINT16**</span><span class="sxs-lookup"><span data-stu-id="1df6a-135">**UINT16**</span></span> | <span data-ttu-id="1df6a-136">0x0064 (100) </span><span class="sxs-lookup"><span data-stu-id="1df6a-136">0x0064 (100)</span></span>                |
| <span data-ttu-id="1df6a-137">VendorExtensionDesc</span><span class="sxs-lookup"><span data-stu-id="1df6a-137">VendorExtensionDesc</span></span>    | <span data-ttu-id="1df6a-138">4</span><span class="sxs-lookup"><span data-stu-id="1df6a-138">4</span></span>           | <span data-ttu-id="1df6a-139">**String**</span><span class="sxs-lookup"><span data-stu-id="1df6a-139">**String**</span></span> | <span data-ttu-id="1df6a-140">"microsoft.com/WMPPD： 10.0"</span><span class="sxs-lookup"><span data-stu-id="1df6a-140">"microsoft.com/WMPPD: 10.0"</span></span> |



 

<span data-ttu-id="1df6a-141">下表提供有關加速中繼資料傳輸之 MTP 作業的詳細資料。</span><span class="sxs-lookup"><span data-stu-id="1df6a-141">The following table provides details about the MTP operation for accelerated metadata transfer.</span></span>



| <span data-ttu-id="1df6a-142">項目</span><span class="sxs-lookup"><span data-stu-id="1df6a-142">Item</span></span>                  | <span data-ttu-id="1df6a-143">描述</span><span class="sxs-lookup"><span data-stu-id="1df6a-143">Description</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|-----------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="1df6a-144">操作程式碼</span><span class="sxs-lookup"><span data-stu-id="1df6a-144">Operation Code</span></span>        | <span data-ttu-id="1df6a-145">0x9201</span><span class="sxs-lookup"><span data-stu-id="1df6a-145">0x9201</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| <span data-ttu-id="1df6a-146">Operation 參數1</span><span class="sxs-lookup"><span data-stu-id="1df6a-146">Operation Parameter 1</span></span> | <span data-ttu-id="1df6a-147">裝置在上一個會話期間提供的交易識別碼。</span><span class="sxs-lookup"><span data-stu-id="1df6a-147">The transaction ID supplied by the device during the previous session.</span></span> <span data-ttu-id="1df6a-148">第一個會話的這個值是零。</span><span class="sxs-lookup"><span data-stu-id="1df6a-148">This value is zero for the first session.</span></span>                                                                                                                                                                                                                                                                                                                                                                                       |
| <span data-ttu-id="1df6a-149">Operation 參數2</span><span class="sxs-lookup"><span data-stu-id="1df6a-149">Operation Parameter 2</span></span> | <span data-ttu-id="1df6a-150">正在開始索引。</span><span class="sxs-lookup"><span data-stu-id="1df6a-150">Starting index.</span></span> <span data-ttu-id="1df6a-151">會話的第一次呼叫時，這個值一律為零。</span><span class="sxs-lookup"><span data-stu-id="1df6a-151">This value is always zero on the first call of a session.</span></span> <span data-ttu-id="1df6a-152">在相同同步處理會話中的後續呼叫上，此值會增加先前回應資料中已修改的計數和已刪除專案的總和。</span><span class="sxs-lookup"><span data-stu-id="1df6a-152">On subsequent calls within the same synchronization session, this value increases by the sum of the count of the modified and the deleted items from the previous response data.</span></span>                                                                                                                                                                                                                                             |
| <span data-ttu-id="1df6a-153">Operation 參數3</span><span class="sxs-lookup"><span data-stu-id="1df6a-153">Operation Parameter 3</span></span> | <span data-ttu-id="1df6a-154">0x10000.</span><span class="sxs-lookup"><span data-stu-id="1df6a-154">0x10000.</span></span> <span data-ttu-id="1df6a-155">這個常數定義于 wmpdevices 中，這是可在回應中傳回的最大 PUOIDs 數。</span><span class="sxs-lookup"><span data-stu-id="1df6a-155">This constant, defined in wmpdevices.h, is the maximum number of PUOIDs that can be returned in the response.</span></span> <span data-ttu-id="1df6a-156">請注意，這個常數的值可能會在此標頭檔的未來版本中修訂。</span><span class="sxs-lookup"><span data-stu-id="1df6a-156">Note that the value of this constant may be revised in future releases of this header file.</span></span>                                                                                                                                                                                                                                                                                     |
| <span data-ttu-id="1df6a-157">Operation 參數4</span><span class="sxs-lookup"><span data-stu-id="1df6a-157">Operation Parameter 4</span></span> | <span data-ttu-id="1df6a-158">0</span><span class="sxs-lookup"><span data-stu-id="1df6a-158">0</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| <span data-ttu-id="1df6a-159">Operation 參數5</span><span class="sxs-lookup"><span data-stu-id="1df6a-159">Operation Parameter 5</span></span> | <span data-ttu-id="1df6a-160">0</span><span class="sxs-lookup"><span data-stu-id="1df6a-160">0</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| <span data-ttu-id="1df6a-161">資料</span><span class="sxs-lookup"><span data-stu-id="1df6a-161">Data</span></span>                  | <span data-ttu-id="1df6a-162">裝置會傳回兩個連續的 MTP 陣列，其中包含 PUOIDs。</span><span class="sxs-lookup"><span data-stu-id="1df6a-162">The device returns two contiguous MTP arrays containing PUOIDs.</span></span> <span data-ttu-id="1df6a-163">每個 MTP 陣列的開頭都是 **DWORD** 值，指出陣列中專案的計數，後面接著專案的陣列。</span><span class="sxs-lookup"><span data-stu-id="1df6a-163">Each MTP array begins with a **DWORD** value indicating the count of items in the array, followed by the array of elements.</span></span> <span data-ttu-id="1df6a-164">第一個 MTP 陣列包含已新增或變更的 PUOIDs 清單。</span><span class="sxs-lookup"><span data-stu-id="1df6a-164">The first MTP array contains the list of PUOIDs that have been added or changed.</span></span> <span data-ttu-id="1df6a-165">第二個 MTP 陣列包含已從可攜式裝置刪除的 PUOIDs 清單。請注意，兩個數組中的 PUOID 計數總和不得超過作業參數3中傳遞的值。</span><span class="sxs-lookup"><span data-stu-id="1df6a-165">The second MTP array contains the list of PUOIDs that have been deleted from the portable device.Note that the sum of PUOID count in the two arrays must not exceed the value passed in Operation Parameter 3.</span></span><br/> |
| <span data-ttu-id="1df6a-166">資料方向</span><span class="sxs-lookup"><span data-stu-id="1df6a-166">Data Direction</span></span>        | <span data-ttu-id="1df6a-167">R->I</span><span class="sxs-lookup"><span data-stu-id="1df6a-167">R->I</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| <span data-ttu-id="1df6a-168">回應碼選項</span><span class="sxs-lookup"><span data-stu-id="1df6a-168">Response Code Options</span></span> | <span data-ttu-id="1df6a-169">**MTP \_回應 \_ 正常** (0x2001) 或有效的錯誤回應碼。</span><span class="sxs-lookup"><span data-stu-id="1df6a-169">**MTP\_RESPONSE\_OK** (0x2001) or valid error response code.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| <span data-ttu-id="1df6a-170">回應參數1</span><span class="sxs-lookup"><span data-stu-id="1df6a-170">Response Parameter 1</span></span>  | <span data-ttu-id="1df6a-171">裝置目前的交易識別碼。</span><span class="sxs-lookup"><span data-stu-id="1df6a-171">The device's current transaction ID.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| <span data-ttu-id="1df6a-172">回應參數2</span><span class="sxs-lookup"><span data-stu-id="1df6a-172">Response Parameter 2</span></span>  | <span data-ttu-id="1df6a-173">未來要求所剩餘的 PUOIDs 數目。</span><span class="sxs-lookup"><span data-stu-id="1df6a-173">The number of PUOIDs that remain to be retrieved by future requests.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| <span data-ttu-id="1df6a-174">回應參數3</span><span class="sxs-lookup"><span data-stu-id="1df6a-174">Response Parameter 3</span></span>  | <span data-ttu-id="1df6a-175">包含狀態資訊的 **DWORD** 。</span><span class="sxs-lookup"><span data-stu-id="1df6a-175">**DWORD** containing status information.</span></span> <span data-ttu-id="1df6a-176">狀態會以位方式表示。</span><span class="sxs-lookup"><span data-stu-id="1df6a-176">Status is indicated in a bitwise fashion.</span></span> <span data-ttu-id="1df6a-177">如需所要使用之旗標的詳細資訊，請參閱備註。</span><span class="sxs-lookup"><span data-stu-id="1df6a-177">See Remarks for information about flags to use.</span></span>                                                                                                                                                                                                                                                                                                                                                                     |
| <span data-ttu-id="1df6a-178">回應參數4</span><span class="sxs-lookup"><span data-stu-id="1df6a-178">Response Parameter 4</span></span>  | <span data-ttu-id="1df6a-179">0</span><span class="sxs-lookup"><span data-stu-id="1df6a-179">0</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| <span data-ttu-id="1df6a-180">回應參數5</span><span class="sxs-lookup"><span data-stu-id="1df6a-180">Response Parameter 5</span></span>  | <span data-ttu-id="1df6a-181">0</span><span class="sxs-lookup"><span data-stu-id="1df6a-181">0</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |



 

## <a name="remarks"></a><span data-ttu-id="1df6a-182">備註</span><span class="sxs-lookup"><span data-stu-id="1df6a-182">Remarks</span></span>

<span data-ttu-id="1df6a-183">狀態是透過使用下列旗標，以位方式透過回應參數3來表示。</span><span class="sxs-lookup"><span data-stu-id="1df6a-183">Status is indicated through Response Parameter 3 in a bitwise fashion by using the following flags.</span></span>



| <span data-ttu-id="1df6a-184">旗標</span><span class="sxs-lookup"><span data-stu-id="1df6a-184">Flag</span></span>                                             | <span data-ttu-id="1df6a-185">值</span><span class="sxs-lookup"><span data-stu-id="1df6a-185">Value</span></span> | <span data-ttu-id="1df6a-186">描述</span><span class="sxs-lookup"><span data-stu-id="1df6a-186">Description</span></span>                                                                                                                                                                                                                          |
|--------------------------------------------------|-------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="1df6a-187">**WMP \_ MDRT \_ 旗標未 \_ 報告的 \_ 已刪除 \_ 專案**</span><span class="sxs-lookup"><span data-stu-id="1df6a-187">**WMP\_MDRT\_FLAGS\_UNREPORTED\_DELETED\_ITEMS**</span></span> | <span data-ttu-id="1df6a-188">0x1</span><span class="sxs-lookup"><span data-stu-id="1df6a-188">0x1</span></span>   | <span data-ttu-id="1df6a-189">專案已在報告第一個物件路徑名稱之前刪除。</span><span class="sxs-lookup"><span data-stu-id="1df6a-189">Items were deleted before the first object path name being reported.</span></span> <span data-ttu-id="1df6a-190">這通常表示裝置已重新格式化。</span><span class="sxs-lookup"><span data-stu-id="1df6a-190">This often indicates that the device was reformatted.</span></span>                                                                                                           |
| <span data-ttu-id="1df6a-191">**WMP \_ MDRT \_ 旗 \_ 標 \_ 已新增的 \_ 專案**</span><span class="sxs-lookup"><span data-stu-id="1df6a-191">**WMP\_MDRT\_FLAGS\_UNREPORTED\_ADDED\_ITEMS**</span></span>   | <span data-ttu-id="1df6a-192">0x2</span><span class="sxs-lookup"><span data-stu-id="1df6a-192">0x2</span></span>   | <span data-ttu-id="1df6a-193">裝置包含一些無法在 PUOIDS 清單中傳回的新增專案。</span><span class="sxs-lookup"><span data-stu-id="1df6a-193">The device contains some added items that cannot be returned in the list of PUOIDS.</span></span> <span data-ttu-id="1df6a-194">請注意，此旗標不是重複的回應參數2。</span><span class="sxs-lookup"><span data-stu-id="1df6a-194">Note that this flag is not redundant with Response Parameter 2.</span></span> <span data-ttu-id="1df6a-195">只有當裝置無法傳回的要求專案時，才設定此旗標。</span><span class="sxs-lookup"><span data-stu-id="1df6a-195">Set this flag only when there are requested items that the device cannot return.</span></span> |



 

<span data-ttu-id="1df6a-196">Bits 2 到31保留供日後使用。</span><span class="sxs-lookup"><span data-stu-id="1df6a-196">Bits 2 through 31 are reserved for future use.</span></span> <span data-ttu-id="1df6a-197">這些位應設定為零。</span><span class="sxs-lookup"><span data-stu-id="1df6a-197">These bits should be set to zero.</span></span>

<span data-ttu-id="1df6a-198">Windows Media Player 在傳送媒體檔案之前，于同步處理會話開始時，將 MTP 命令傳送到裝置。</span><span class="sxs-lookup"><span data-stu-id="1df6a-198">Windows Media Player sends the MTP command to a device at the start of a synchronization session before media files are transferred.</span></span> <span data-ttu-id="1df6a-199">裝置應該儘快傳回其回應，以避免同步處理作業的延遲。</span><span class="sxs-lookup"><span data-stu-id="1df6a-199">The device should return its response as quickly as possible to avoid delays in the synchronization operation.</span></span>

<span data-ttu-id="1df6a-200">Windows Media Player 會針對回應中所傳回之每個修改 POUID 的 [中繼資料](about-the-metadata.md) ，要求所列屬性的值。</span><span class="sxs-lookup"><span data-stu-id="1df6a-200">Windows Media Player will request values for the attributes listed in [About the Metadata](about-the-metadata.md) for each modified POUID returned in the response.</span></span> <span data-ttu-id="1df6a-201">Windows Media Player 可能會在後續命令中，將這些屬性的更新值傳送至裝置。</span><span class="sxs-lookup"><span data-stu-id="1df6a-201">Windows Media Player might send updated values for these attributes to the device in subsequent commands.</span></span>

<span data-ttu-id="1df6a-202">如果使用者的設定需要，則可以將回報為已從裝置移除的檔案再次複製到裝置。</span><span class="sxs-lookup"><span data-stu-id="1df6a-202">Files reported as having been removed from the device can be copied to the device again if the user's settings require it.</span></span>

## <a name="related-topics"></a><span data-ttu-id="1df6a-203">相關主題</span><span class="sxs-lookup"><span data-stu-id="1df6a-203">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="1df6a-204">**加速中繼資料傳輸的裝置擴充功能**</span><span class="sxs-lookup"><span data-stu-id="1df6a-204">**Device Extensions for Accelerated Metadata Transfer**</span></span>](device-extensions-for-accelerated-metadata-transfer.md)
</dt> </dl>

 

 





