---
title: 預設值
description: 預設值
ms.assetid: fb2ccd8b-eda2-414a-870c-85b658f40eb9
keywords:
- 視覺效果，預設
- 自訂視覺效果，預設
- 視覺效果、橫條圖預設值
- 自訂視覺效果，橫條圖預設值
- 視覺效果、Wave 預設值
- 自訂視覺效果，Wave 預設值
- 視覺效果，轉譯函數
- 自訂視覺效果，轉譯函數
- 轉譯函數，預設
- 視覺效果，GetPresetTitle 函式
- 自訂視覺效果，GetPresetTitle 函式
- GetPresetTitle 函式
- 列舉，視覺效果預設
- 視覺效果，列舉
- 自訂視覺效果，列舉
- 視覺效果、資源標頭和字串
- 自訂視覺效果、資源標頭和字串
- 視覺效果中的預設值，橫條圖預設
- 視覺效果中的預設值，Wave 預設
- 視覺效果中的預設值，關於
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e024427d19da0a30f54d9ebc0590feedb8d0f97f
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 09/16/2019
ms.locfileid: "104183357"
---
# <a name="presets"></a><span data-ttu-id="70bb9-123">預設值</span><span class="sxs-lookup"><span data-stu-id="70bb9-123">Presets</span></span>

<span data-ttu-id="70bb9-124">預設會提供一種方式，讓來自相同視覺效果的不同效果。</span><span class="sxs-lookup"><span data-stu-id="70bb9-124">Presets are provided as a way to have different effects coming from the same visualization.</span></span> <span data-ttu-id="70bb9-125">例如，您可以建立一個程式碼區塊所產生的光暈效果，但使用預設值來判斷光暈的色彩。</span><span class="sxs-lookup"><span data-stu-id="70bb9-125">For example, you could create a glow effect that was generated by one block of code, but use a preset to determine the color of the glow.</span></span> <span data-ttu-id="70bb9-126">您的預設名稱可能是紅色、綠色和藍色。</span><span class="sxs-lookup"><span data-stu-id="70bb9-126">Your preset names might be Red, Green, and Blue.</span></span>

<span data-ttu-id="70bb9-127">Wizard 會為它產生的程式碼定義兩個預設值。</span><span class="sxs-lookup"><span data-stu-id="70bb9-127">The wizard defines two presets for the code it generates.</span></span> <span data-ttu-id="70bb9-128">其中一個稱為橫條圖，另一個稱為 Wave。</span><span class="sxs-lookup"><span data-stu-id="70bb9-128">One is called Bars and the other is called Wave.</span></span> <span data-ttu-id="70bb9-129">[橫條圖] 預設會顯示在音訊頻譜中顯示活動的橫條，並使用波形資料。</span><span class="sxs-lookup"><span data-stu-id="70bb9-129">The Bars preset displays bars that show the activity in the audio spectrum, and use the waveform data.</span></span> <span data-ttu-id="70bb9-130">Wave 預設值會顯示 wiggling 線，以顯示波形的音訊電源。</span><span class="sxs-lookup"><span data-stu-id="70bb9-130">The Wave preset displays a wiggling line that shows the audio power of the waveform.</span></span>

<span data-ttu-id="70bb9-131">如果您變更任何預設資訊，您也必須變更所產生程式碼的下列部分。</span><span class="sxs-lookup"><span data-stu-id="70bb9-131">If you change any of the preset information, you must also change the following parts of the generated code.</span></span>

## <a name="render-function"></a><span data-ttu-id="70bb9-132">Render 函數</span><span class="sxs-lookup"><span data-stu-id="70bb9-132">Render function</span></span>

<span data-ttu-id="70bb9-133">**IWMPEffects：： Render** 函式位於檔案 *名稱*.cpp 中，其中 *專案* 名稱是您在執行嚮導時所選擇的專案名稱。</span><span class="sxs-lookup"><span data-stu-id="70bb9-133">The **IWMPEffects::Render** function is in the file *projectname*.cpp, where *projectname* is the project name you chose when you ran the wizard.</span></span>

<span data-ttu-id="70bb9-134">轉譯 **函數中產生的程式** 代碼會使用 switch 語句，在兩個預設值之間進行選擇。</span><span class="sxs-lookup"><span data-stu-id="70bb9-134">The generated code in the **Render** function uses a switch statement to choose between two presets.</span></span> <span data-ttu-id="70bb9-135">目前的預設值是使用者在 Windows Media Player 中選取的任何內容。</span><span class="sxs-lookup"><span data-stu-id="70bb9-135">The current preset is whatever the user selects in Windows Media Player.</span></span> <span data-ttu-id="70bb9-136">如果您想要變更特定預設值所執行的程式碼，或加入或減去預設值，請據以修改 switch 語句。</span><span class="sxs-lookup"><span data-stu-id="70bb9-136">If you want to change which code runs for a particular preset or add or subtract a preset, modify the switch statement accordingly.</span></span>

<span data-ttu-id="70bb9-137">這兩個預設值是由預設列和 **預設 \_ 範圍** 列舉所定義。 **\_**</span><span class="sxs-lookup"><span data-stu-id="70bb9-137">The two presets are defined by the **PRESET\_BARS** and **PRESET\_SCOPE** enumerations.</span></span> <span data-ttu-id="70bb9-138">將呼叫預設值的選項是由 m nPreset 所定義 \_ 。</span><span class="sxs-lookup"><span data-stu-id="70bb9-138">The choice of which preset will be called is defined by m\_nPreset.</span></span>

## <a name="getpresettitle"></a><span data-ttu-id="70bb9-139">GetPresetTitle</span><span class="sxs-lookup"><span data-stu-id="70bb9-139">GetPresetTitle</span></span>

<span data-ttu-id="70bb9-140">**IWMPEffects：： GetPresetTitle** 函式位於檔案 *名稱*.cpp 中，其中 *專案* 名稱是您在執行嚮導時所選擇的專案名稱。</span><span class="sxs-lookup"><span data-stu-id="70bb9-140">The **IWMPEffects::GetPresetTitle** function is in the file *projectname*.cpp, where *projectname* is the project name you chose when you ran the wizard.</span></span>

<span data-ttu-id="70bb9-141">**GetPresetTitle** 函數會設定預設列舉和字串資源之間的關聯性。</span><span class="sxs-lookup"><span data-stu-id="70bb9-141">The **GetPresetTitle** function sets up the relationships between the preset enumerations and the string resources.</span></span> <span data-ttu-id="70bb9-142">預設會由嚮導產生列舉預設 **列和 \_ 預設** **\_ 範圍** ，並使用字串資源識別碼 \_ BARSPRESETNAME 和 id \_ SCOPEPRESETNAME。</span><span class="sxs-lookup"><span data-stu-id="70bb9-142">The enumerations **PRESET\_BARS** and **PRESET\_SCOPE** are generated by the wizard and are using the string resources IDS\_BARSPRESETNAME and IDS\_SCOPEPRESETNAME.</span></span>

<span data-ttu-id="70bb9-143">如果您加入、減去或變更預設值，則需要變更列舉和字串資源。</span><span class="sxs-lookup"><span data-stu-id="70bb9-143">You need to change the enumerations and string resources if you add, subtract, or change presets.</span></span>

## <a name="preset-enumerations"></a><span data-ttu-id="70bb9-144">預設列舉值</span><span class="sxs-lookup"><span data-stu-id="70bb9-144">Preset Enumerations</span></span>

<span data-ttu-id="70bb9-145">預設的列舉是在檔案 *名稱*.h 中定義，其中 *專案* 名稱是您在執行嚮導時所選擇的專案名稱。</span><span class="sxs-lookup"><span data-stu-id="70bb9-145">The preset enumeration is defined in the file *projectname*.h, where *projectname* is the project name you chose when you ran the wizard.</span></span>

<span data-ttu-id="70bb9-146">列舉會定義目前的兩個預設值和計數。</span><span class="sxs-lookup"><span data-stu-id="70bb9-146">The enumeration defines the current two presets and the count.</span></span> <span data-ttu-id="70bb9-147">如果您加入或減少預設值或變更列舉，請務必變更此列舉，使預設值的計數和順序正確無誤。</span><span class="sxs-lookup"><span data-stu-id="70bb9-147">If you add or subtract presets or change the enumeration, be sure you change this enumeration so that the count and order of presets is correct.</span></span> <span data-ttu-id="70bb9-148">這個列舉是用來確保您會在 **轉譯函數中呼叫正確的預設** 值。</span><span class="sxs-lookup"><span data-stu-id="70bb9-148">This enumeration is used to make sure that you call the correct preset in the **Render** function.</span></span>

## <a name="resource-header"></a><span data-ttu-id="70bb9-149">資源標頭</span><span class="sxs-lookup"><span data-stu-id="70bb9-149">Resource Header</span></span>

<span data-ttu-id="70bb9-150">您必須在資源 .h 標頭檔中設定預設名稱的資源。</span><span class="sxs-lookup"><span data-stu-id="70bb9-150">You must set the resources for names of your preset in the resource.h header file.</span></span> <span data-ttu-id="70bb9-151">目前的預設值定義為：</span><span class="sxs-lookup"><span data-stu-id="70bb9-151">The current presets are defined as:</span></span>


```C++
#define IDS_BARSPRESETNAME              102
#define IDS_SCOPEPRESETNAME             103
```



<span data-ttu-id="70bb9-152">如果您新增或減少預設值，您必須變更資源標頭和其數目。</span><span class="sxs-lookup"><span data-stu-id="70bb9-152">If you add or subtract presets, you must change the resource header and the numbers for them.</span></span>

## <a name="resource-strings"></a><span data-ttu-id="70bb9-153">資源字串</span><span class="sxs-lookup"><span data-stu-id="70bb9-153">Resource Strings</span></span>

<span data-ttu-id="70bb9-154">預設的實際名稱會定義在資源檔 *專案* 名稱的 .dll 中 *，其中，專案名稱* 是您在執行嚮導時所選擇的專案名稱。</span><span class="sxs-lookup"><span data-stu-id="70bb9-154">The actual names of the presets are defined in the resource file *projectname* dll.rc, where *projectname* is the project name you chose when you ran the wizard.</span></span> <span data-ttu-id="70bb9-155">您可以手動編輯此檔案，或使用 Microsoft Visual C++ 隨附的資源編輯器。</span><span class="sxs-lookup"><span data-stu-id="70bb9-155">You can edit this file by hand or use the resource editor included with Microsoft Visual C++.</span></span>

<span data-ttu-id="70bb9-156">產生的名稱是視覺效果的名稱加上特定的預設值。</span><span class="sxs-lookup"><span data-stu-id="70bb9-156">The names generated are the name of the visualization plus the specific preset.</span></span> <span data-ttu-id="70bb9-157">產生之程式碼的資源檔會將它們定義為：</span><span class="sxs-lookup"><span data-stu-id="70bb9-157">The resource file for the generated code will define them as:</span></span>


```C++
IDS_BARSPRESETNAME      "projectname Bars"
IDS_SCOPEPRESETNAME     "projectname Wave"
```



<span data-ttu-id="70bb9-158">其中 *專案名稱是* 您在執行嚮導時所選擇的專案名稱。</span><span class="sxs-lookup"><span data-stu-id="70bb9-158">where *projectname* is the name of the project name you chose when you ran the wizard.</span></span> <span data-ttu-id="70bb9-159">這是您將變更預設預設名稱的位置，而這就是 Windows Media Player 將其參考及顯示的方式。</span><span class="sxs-lookup"><span data-stu-id="70bb9-159">This is where you will change the actual names of the presets and this is how they will be referred to and displayed by Windows Media Player.</span></span>

## <a name="related-topics"></a><span data-ttu-id="70bb9-160">相關主題</span><span class="sxs-lookup"><span data-stu-id="70bb9-160">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="70bb9-161">**執行您的程式碼**</span><span class="sxs-lookup"><span data-stu-id="70bb9-161">**Implementing Your Code**</span></span>](implementing-your-code.md)
</dt> </dl>

 

 




