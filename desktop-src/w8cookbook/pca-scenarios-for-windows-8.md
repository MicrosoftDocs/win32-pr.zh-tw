---
title: Windows 8 的程式相容性助理案例
description: Windows 8 的程式相容性助理案例
ms.assetid: C61BF746-63EE-4F4E-81D3-52947FD4954D
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 1ebada2ca5115d24f260808a1c9ae899963184a8
ms.sourcegitcommit: ee06501cc29132927ade9813e0888aaa4decc487
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/28/2021
ms.locfileid: "104565227"
---
# <a name="program-compatibility-assistant-scenarios-for-windows-8"></a><span data-ttu-id="7d2d1-103">Windows 8 的程式相容性助理案例</span><span class="sxs-lookup"><span data-stu-id="7d2d1-103">Program Compatibility Assistant scenarios for Windows 8</span></span>

## <a name="platforms"></a><span data-ttu-id="7d2d1-104">平台</span><span class="sxs-lookup"><span data-stu-id="7d2d1-104">Platforms</span></span>

<span data-ttu-id="7d2d1-105">**客戶** 端-windows XP \| windows Vista \| windows 7 \| Windows 8</span><span class="sxs-lookup"><span data-stu-id="7d2d1-105">**Clients** - Windows XP \| Windows Vista \| Windows 7 \| Windows 8</span></span>  

## <a name="description"></a><span data-ttu-id="7d2d1-106">Description</span><span class="sxs-lookup"><span data-stu-id="7d2d1-106">Description</span></span>

<span data-ttu-id="7d2d1-107">程式相容性助理 (PCA) 是 Windows 8 中的一項功能，可協助使用者執行專為舊版 Windows 設計的桌面應用程式。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-107">Program Compatibility Assistant (PCA) is a feature in Windows 8 that helps end users to run desktop apps designed for earlier Windows versions.</span></span> <span data-ttu-id="7d2d1-108">Windows 8 有絕佳的內建應用程式相容性，可讓針對 Windows 7 或更早版本的 Windows 所設計的應用程式自動在 Windows 8 上順利運作。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-108">Windows 8 has great built in app compatibility that enables apps designed for Windows 7 or earlier Windows versions to work great on Windows 8 automatically.</span></span> <span data-ttu-id="7d2d1-109">不過，有少數的應用程式在執行時可能會發生問題，而不需要介入。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-109">However, there are a small number of apps that can have trouble running without intervention.</span></span>

<span data-ttu-id="7d2d1-110">當使用者執行應用程式時，PCA 會追蹤應用程式，並識別 Windows 8 中特定已知相容性問題的任何徵兆。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-110">When a user runs an app, PCA tracks the app and identifies any symptoms of certain known compatibility issues in Windows 8.</span></span> <span data-ttu-id="7d2d1-111">當它偵測到任何問題的徵兆時，它會讓使用者有機會套用建議的修正，以協助在 Windows 8 上執行更好的應用程式。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-111">When it detects any issue symptoms, it provides the user an opportunity to apply a recommended fix that will help run the app better on Windows 8.</span></span>

## <a name="scenarios"></a><span data-ttu-id="7d2d1-112">案例</span><span class="sxs-lookup"><span data-stu-id="7d2d1-112">Scenarios</span></span>

<span data-ttu-id="7d2d1-113">PCA 會追蹤 Windows 8 中已知相容性問題集的應用程式。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-113">PCA tracks apps for a set of known compatibility issues in Windows 8.</span></span> <span data-ttu-id="7d2d1-114">PCA 會追蹤問題、識別修正程式，並提供對話方塊給使用者，指示如何套用建議的修正。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-114">PCA tracks the issues, identifies the fixes, and provides a dialog to the user with instructions to apply a recommended fix.</span></span> <span data-ttu-id="7d2d1-115">使用者可以決定套用建議的修正，或選擇不執行任何動作，並取消建議。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-115">The user can decide to apply the recommended fixes, or choose to do nothing and cancel out of the recommendation.</span></span> <span data-ttu-id="7d2d1-116">如果使用者取消，PCA 將不會再追蹤該應用程式。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-116">If the user cancels out, PCA will no longer track that app.</span></span>

<span data-ttu-id="7d2d1-117">PCA 通常會套用三個 Windows 相容性模式的其中一種（Windows XP SP3、Windows Vista SP2 或 Windows 7），取決於程式 (或其安裝) 的編寫時間。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-117">PCA generally applies one of three Windows compatibility modes – Windows XP SP3, Windows Vista SP2, or Windows 7, depending on when the program (or its setup) was authored.</span></span> <span data-ttu-id="7d2d1-118">PCA 使用程式的連結 \_ 日期和子系統版本屬性，以及可執行檔資訊清單的 TRUSTINFO 與相容性章節，以判斷哪一種模式是相關的，並套用 WINDOWS XP SP3 (分別包含系統管理許可權) 、Windows VISTA SP2 或 windows 7。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-118">PCA uses the LINK\_DATE and SUBSYSTEM VERSION attributes of the program and the executable file manifest’s TRUSTINFO and COMPATIBILITY sections to determine which of the modes is relevant and applies Windows XP SP3 (includes administrative privilege), Windows Vista SP2, or Windows 7 respectively.</span></span> <span data-ttu-id="7d2d1-119">檔結尾的詞彙會列出 PCA 所套用的每個相容性模式及其描述。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-119">A glossary at the end of the document lists each of the compatibility modes that PCA applies and its description.</span></span>

<span data-ttu-id="7d2d1-120">針對下列所有案例，PCA 會在套用修正之後的第二次追蹤應用程式。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-120">For all scenarios listed below, PCA tracks apps for a second time after a fix is applied.</span></span> <span data-ttu-id="7d2d1-121">如果應用程式即使在套用相容性修正之後仍以相同的方式進行失敗，PCA 仍會還原修正。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-121">If the app continues to fail in the same way even after a compatibility fix is applied, PCA revert the fix.</span></span> <span data-ttu-id="7d2d1-122">PCA 接著會永久停止追蹤失敗的特定應用程式。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-122">PCA will then permanently stop tracking the specific app that failed.</span></span>

<span data-ttu-id="7d2d1-123">當 PCA 追蹤許多潛在的問題時，並非所有問題都會實際導致應用程式失敗。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-123">While PCA tracks many potential issues, not all of the issues will actually cause app failures.</span></span> <span data-ttu-id="7d2d1-124">PCA 建議只有在應用程式因為 Windows 相容性原因而發生失敗的情況時，才會進行修正。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-124">PCA recommends fixes only in situations where there is a high probability that the app failure is due to Windows compatibility reasons.</span></span> <span data-ttu-id="7d2d1-125">下列各節會在 Windows 8 中開發的每個 PCA 案例上展開。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-125">The sections below expand on each of the PCA scenarios developed in Windows 8.</span></span> <span data-ttu-id="7d2d1-126">每個章節都會說明問題案例和 PCA 提供的建議，以允許應用程式在 Windows 8 上繼續正常運作。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-126">Each section describes the problem scenario and the recommendations that PCA provides to allow the app to continue working properly on Windows 8.</span></span>

<span data-ttu-id="7d2d1-127">若要深入瞭解 Windows 8 中的相容性變更，請參閱 *Windows 8 相容性操作手冊* 中的其他主題。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-127">To learn more about compatibility changes in Windows 8, refer to the other topics in the *Windows 8 Compatibility Cookbook*.</span></span>

<span data-ttu-id="7d2d1-128">PCA 追蹤和建議修正的案例如下：</span><span class="sxs-lookup"><span data-stu-id="7d2d1-128">The scenarios that PCA tracks and recommends fixes to are:</span></span>

-   <span data-ttu-id="7d2d1-129">應用程式無法安裝或卸載</span><span class="sxs-lookup"><span data-stu-id="7d2d1-129">App fails to Install or Uninstall</span></span>
-   <span data-ttu-id="7d2d1-130">應用程式無法使用 Windows 版本檢查訊息執行</span><span class="sxs-lookup"><span data-stu-id="7d2d1-130">App fails to run with a Windows version check message</span></span>
-   <span data-ttu-id="7d2d1-131">應用程式因系統管理許可權而無法啟動</span><span class="sxs-lookup"><span data-stu-id="7d2d1-131">App fails to launch due to administrative privilege</span></span>
-   <span data-ttu-id="7d2d1-132">應用程式因為特定的記憶體問題而損毀</span><span class="sxs-lookup"><span data-stu-id="7d2d1-132">App crashes due to specific memory problems</span></span>
-   <span data-ttu-id="7d2d1-133">應用程式因系統檔案不相符而失敗</span><span class="sxs-lookup"><span data-stu-id="7d2d1-133">App fails due to mismatched system files</span></span>
-   <span data-ttu-id="7d2d1-134">應用程式因64位 Windows 上發生未處理的錯誤而失敗</span><span class="sxs-lookup"><span data-stu-id="7d2d1-134">App fails due to Unhandled Errors on 64-bit Windows</span></span>
-   <span data-ttu-id="7d2d1-135">應用程式在嘗試刪除受保護的非 Windows 檔案時失敗</span><span class="sxs-lookup"><span data-stu-id="7d2d1-135">App fails while attempting to delete protected non-Windows files</span></span>
-   <span data-ttu-id="7d2d1-136">應用程式在嘗試修改 Windows 檔案時失敗</span><span class="sxs-lookup"><span data-stu-id="7d2d1-136">App fails while attempting to modify Windows files</span></span>
-   <span data-ttu-id="7d2d1-137">應用程式因使用8或16位色彩模式而失敗</span><span class="sxs-lookup"><span data-stu-id="7d2d1-137">App fails due to using 8- or 16-bit color modes</span></span>
-   <span data-ttu-id="7d2d1-138">應用程式因圖形和顯示器問題而失敗</span><span class="sxs-lookup"><span data-stu-id="7d2d1-138">App fails due to graphics and display issues</span></span>
-   <span data-ttu-id="7d2d1-139">應用程式無法宣告 DPI 感知</span><span class="sxs-lookup"><span data-stu-id="7d2d1-139">App fails to declare DPI awareness</span></span>
-   <span data-ttu-id="7d2d1-140">應用程式因遺失 Windows 功能而失敗</span><span class="sxs-lookup"><span data-stu-id="7d2d1-140">App fails due to missing Windows features</span></span>
-   <span data-ttu-id="7d2d1-141">應用程式因64位的未簽署驅動程式而失敗 Windows 8</span><span class="sxs-lookup"><span data-stu-id="7d2d1-141">App fails due to unsigned drivers on 64-bit Windows 8</span></span>
-   <span data-ttu-id="7d2d1-142">透過相容性設定來追蹤安裝的應用程式</span><span class="sxs-lookup"><span data-stu-id="7d2d1-142">Tracking apps installed through compatibility settings</span></span>
-   <span data-ttu-id="7d2d1-143">應用程式無法啟動安裝程式或更新程式</span><span class="sxs-lookup"><span data-stu-id="7d2d1-143">App fails to launch installers or updaters</span></span>
-   <span data-ttu-id="7d2d1-144">需要以系統管理許可權執行的應用程式安裝程式</span><span class="sxs-lookup"><span data-stu-id="7d2d1-144">App installers that need to run with administrative privilege</span></span>
-   <span data-ttu-id="7d2d1-145">需要以系統管理許可權執行的舊版主控台 applet</span><span class="sxs-lookup"><span data-stu-id="7d2d1-145">Legacy Control Panel applets that need to run with administrative privilege</span></span>

<span data-ttu-id="7d2d1-146">以下是每個案例的擴充：</span><span class="sxs-lookup"><span data-stu-id="7d2d1-146">Each of these scenarios is expanded below:</span></span>

<span data-ttu-id="7d2d1-147">**應用程式無法安裝或卸載**</span><span class="sxs-lookup"><span data-stu-id="7d2d1-147">**App fails to Install or Uninstall**</span></span>

<span data-ttu-id="7d2d1-148">在應用程式安裝期間，最常見的應用程式失敗類型之一。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-148">One of the most common types of app failures occurs during the installation of the app.</span></span> <span data-ttu-id="7d2d1-149">舊版安裝程式最常見的失敗方式有兩種：</span><span class="sxs-lookup"><span data-stu-id="7d2d1-149">Older Setup programs most commonly fail in two ways:</span></span>

-   <span data-ttu-id="7d2d1-150">安裝程式不知道 Windows 8 中 (UAC) 功能的使用者帳戶控制，因此，它可能不會以對受保護區域進行系統變更所需的完整許可權來執行 Windows 8</span><span class="sxs-lookup"><span data-stu-id="7d2d1-150">The setup program is not aware of the User Account Control (UAC) features in Windows 8, so, it may not run with the full privileges needed to make system changes to the protected areas of Windows 8</span></span>
-   <span data-ttu-id="7d2d1-151">安裝程式會檢查 Windows 版本，並在版本高於預期的版本時封鎖本身</span><span class="sxs-lookup"><span data-stu-id="7d2d1-151">The setup program checks for the Windows version and blocks itself from running if the version is higher than what it expects</span></span>

<span data-ttu-id="7d2d1-152">這些失敗狀況是安裝程式中最常見的兩種相容性失敗類型。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-152">These failure conditions are two of the most common types of compatibility failures in setup.</span></span> <span data-ttu-id="7d2d1-153">PCA 可協助各種其他 Windows 元件（例如 UAC），並在啟動時偵測安裝程式，並在安裝結束時追蹤安裝程式。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-153">PCA, with the help of various other Windows components such as UAC, detects Setup programs at launch and tracks them to the end of the install.</span></span> <span data-ttu-id="7d2d1-154">如果安裝程式無法新增檔案，或在 Windows [控制台] 的 [新增移除程式] 部分新增有效的專案，PCA 會將安裝程式視為失敗。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-154">If the Setup program either fails to add files or to add a valid entry in the ‘Add Remove Programs’ part of the Windows control panel, then PCA considers the setup to have failed.</span></span>

<span data-ttu-id="7d2d1-155">在此情況下，PCA 建議適用于應用程式的相容性模式。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-155">In this case, PCA recommends a compatibility mode appropriate for the app.</span></span> <span data-ttu-id="7d2d1-156">相容性模式可讓安裝程式以設計的 Windows 模式執行，也可確保應用程式以系統管理許可權執行。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-156">The compatibility mode allows the setup program to run in the Windows mode it was designed for and also ensures that the app runs with administrative privileges.</span></span> <span data-ttu-id="7d2d1-157">PCA 會套用 RUNASADMIN 相容性模式以及適當的 Windows XP、Windows Vista 或 Windows 7 相容性模式。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-157">PCA applies the RUNASADMIN compatibility mode along with the appropriate Windows XP, Windows Vista, or Windows 7 compatibility mode.</span></span> <span data-ttu-id="7d2d1-158">當使用者在安裝失敗時，將會看到含有 PCA 建議的對話方塊：</span><span class="sxs-lookup"><span data-stu-id="7d2d1-158">The user, at the end of the failed install, will see a dialog with the PCA recommendation:</span></span>

![應用程式無法安裝或卸載對話方塊](images/pcafigure1.png)

<span data-ttu-id="7d2d1-160">然後，使用者可以選擇：</span><span class="sxs-lookup"><span data-stu-id="7d2d1-160">The user can then choose to:</span></span>

-   <span data-ttu-id="7d2d1-161">使用相容性設定 (建議選項來執行程式) ，之後 PCA 會將建議的設定套用 (相容性模式) 、重新開機安裝程式，並在安裝程式成功完成之前追蹤</span><span class="sxs-lookup"><span data-stu-id="7d2d1-161">Run the program using the compatibility settings (recommended option), after which PCA will apply the recommended setting (compatibility mode), restart the setup program, and track it till the setup completes successfully</span></span>
-   <span data-ttu-id="7d2d1-162">指出程式已正確安裝，在這種情況下，PCA 將不會新增任何設定，而且會停止追蹤安裝程式</span><span class="sxs-lookup"><span data-stu-id="7d2d1-162">Indicate that the program installed correctly, in which case PCA will not add any settings and will stop tracking the setup</span></span>
-   <span data-ttu-id="7d2d1-163">按一下 [關閉]，在此情況下，PCA 將不會新增任何設定，而且會停止追蹤此設定</span><span class="sxs-lookup"><span data-stu-id="7d2d1-163">Click Close, in which case PCA will not add any settings and will stop tracking this setup</span></span>

<span data-ttu-id="7d2d1-164">當使用者嘗試從 Windows 的 [新增移除程式] 區段或從應用程式的卸載程式快捷方式卸載應用程式時，也會使用相同的機制來協助應用程式卸載。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-164">The same mechanism is used to help the app’s uninstallation when a user tries to uninstall the app either from the ‘Add Remove Programs’ section in Windows, or from the app’s uninstaller shortcut.</span></span>

<span data-ttu-id="7d2d1-165">**應用程式無法使用 Windows 版本檢查訊息執行**</span><span class="sxs-lookup"><span data-stu-id="7d2d1-165">**App fails to run with a Windows version check message**</span></span>

<span data-ttu-id="7d2d1-166">應用程式執行時間中的其中一個較常見的相容性失敗，是因為 Windows 版本檢查。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-166">One of the more common compatibility failures in app runtime is due to the Windows version check.</span></span> <span data-ttu-id="7d2d1-167">許多應用程式在啟動時，請檢查 Windows 版本;如果它們無法辨識版本，即使應用程式可能已執行且沒有任何問題，它們仍會封鎖。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-167">Many apps, upon launch check the Windows version; if they do not recognize the version, they block themselves even if the app could have run without issues.</span></span>

<span data-ttu-id="7d2d1-168">一般而言，這類檢查會與 PCA 追蹤的兩個條件相關聯：</span><span class="sxs-lookup"><span data-stu-id="7d2d1-168">Generally, such checks are associated with two conditions that the PCA tracks:</span></span>

<span data-ttu-id="7d2d1-169">應用程式會顯示警告使用者的訊息方塊。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-169">The app displays a message box that warns the user.</span></span> <span data-ttu-id="7d2d1-170">範例如下：</span><span class="sxs-lookup"><span data-stu-id="7d2d1-170">An example is below:</span></span>

![應用程式無法使用 windows 版本檢查訊息對話方塊來執行](images/pcafigure2.png)

-   <span data-ttu-id="7d2d1-172">應用程式會立即終止或當機</span><span class="sxs-lookup"><span data-stu-id="7d2d1-172">The app terminates immediately or crashes</span></span>

<span data-ttu-id="7d2d1-173">如果 PCA 針對應用程式識別這兩個條件，則會為使用者提供建議。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-173">If PCA identifies both of these conditions for an app, it will provide a recommendation to the user.</span></span> <span data-ttu-id="7d2d1-174">PCA 可讓使用者重新執行具有相容性設定的應用程式。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-174">PCA will allow the user to re-run the app with compatibility settings.</span></span> <span data-ttu-id="7d2d1-175">PCA 會根據應用程式套用適當的 Windows XP、Windows Vista 或 Windows 7 相容性模式。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-175">PCA will apply the appropriate Windows XP, Windows Vista, or Windows 7 compatibility mode based on the app.</span></span> <span data-ttu-id="7d2d1-176">如同在任何案例中，使用者可以將應用程式正確執行，或按一下 [關閉] 按鈕退出建議的設定。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-176">As in any of the scenarios, the user can tell PCA that the app ran correctly, or opt out of the recommended settings by clicking the close button.</span></span> <span data-ttu-id="7d2d1-177">提供的範例對話方塊如下所示：</span><span class="sxs-lookup"><span data-stu-id="7d2d1-177">An example dialog is provided as below:</span></span>

![應用程式無法使用 windows 版本檢查訊息選項對話方塊來執行](images/pcafigure3.png)

<span data-ttu-id="7d2d1-179">**應用程式因系統管理許可權而無法啟動或執行**</span><span class="sxs-lookup"><span data-stu-id="7d2d1-179">**App fails to launch or run due to administrative privilege**</span></span>

<span data-ttu-id="7d2d1-180">有些應用程式需要系統管理許可權，才能執行和執行其功能。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-180">Some apps need administrative privilege to run and execute their functionality.</span></span> <span data-ttu-id="7d2d1-181">不過，在與 Windows 7 和 Windows Vista 類似的 Windows 8 中，應用程式預設會以較低許可權層級執行，因為 UAC。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-181">However, in Windows 8, similar to Windows 7 and Windows Vista, apps run in lower privilege levels by default due to UAC.</span></span> <span data-ttu-id="7d2d1-182">針對 Windows Vista 和更新版本所設計的較新應用程式，通常會使用 EXE 資訊清單的 TRUSTINFO 區段來宣告其執行所需的許可權層級。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-182">Newer apps designed for Windows Vista and above will generally declare the privilege level they need to run at using the EXE manifest’s TRUSTINFO section.</span></span> <span data-ttu-id="7d2d1-183">不過，較舊的應用程式通常會以兩種方式失敗：</span><span class="sxs-lookup"><span data-stu-id="7d2d1-183">However, older apps generally fail in two ways:</span></span>

-   <span data-ttu-id="7d2d1-184">應用程式會顯示訊息給使用者，指出它需要系統管理許可權，如下列範例所示：</span><span class="sxs-lookup"><span data-stu-id="7d2d1-184">App displays a message to the user that it requires administrative privilege, as below example:</span></span>

![應用程式因系統管理許可權對話方塊啟動或執行失敗](images/pcafigure4a.png)

-   <span data-ttu-id="7d2d1-186">應用程式會立即終止或當機</span><span class="sxs-lookup"><span data-stu-id="7d2d1-186">App either terminates immediately or crashes</span></span>

<span data-ttu-id="7d2d1-187">如果 PCA 針對應用程式識別這兩個條件，則會為使用者提供建議。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-187">If PCA identifies both of these conditions for an app, it will provide a recommendation to the user.</span></span> <span data-ttu-id="7d2d1-188">PCA 可讓使用者以系統管理許可權重新執行應用程式 (PCA 會將 RUNASHIGHEST 相容性模式套用) 。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-188">PCA will allow the user to re-run the app with administrative privileges (PCA applies the RUNASHIGHEST compatibility mode).</span></span> <span data-ttu-id="7d2d1-189">當應用程式重新執行時，使用者會收到 UAC 提示。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-189">The user will get a UAC prompt when the app re-runs.</span></span> <span data-ttu-id="7d2d1-190">如同在任何情況下，使用者都可以選擇使用建議的設定重新執行，或按一下 [關閉] 退出建議的設定。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-190">As in any of the scenarios, the user can choose to re-run with the recommended setting, or opt out of the recommended settings by clicking Close.</span></span> <span data-ttu-id="7d2d1-191">提供的範例對話方塊如下所示：</span><span class="sxs-lookup"><span data-stu-id="7d2d1-191">An example dialog is provided as below:</span></span>

![因為系統管理許可權選項對話方塊，所以無法啟動或執行應用程式](images/pcafigure5.png)

<span data-ttu-id="7d2d1-193">**應用程式因為特定的記憶體問題而損毀**</span><span class="sxs-lookup"><span data-stu-id="7d2d1-193">**App crashes due to specific memory problems**</span></span>

<span data-ttu-id="7d2d1-194">某些應用程式由於已知的記憶體問題而損毀。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-194">Some apps crash due to a well-known memory problem.</span></span> <span data-ttu-id="7d2d1-195">應用程式會從記憶體中取消參考 DLL，然後呼叫函式以在相同的 DLL 中執行程式碼。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-195">The app de-references a DLL from memory, and then calls a function to execute code in the same DLL.</span></span> <span data-ttu-id="7d2d1-196">這會導致應用程式立即損毀。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-196">This causes an immediate crash of the app.</span></span> <span data-ttu-id="7d2d1-197">雖然這個問題不是因為 Windows 8 的相容性變更，但這是在各種應用程式中看到的較常見問題。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-197">While this problem is not due to Windows 8 compatibility changes, it is a relatively common problem seen in a wide variety of apps.</span></span> <span data-ttu-id="7d2d1-198">PCA 會追蹤此問題，讓使用者有機會更可靠地執行他們的應用程式。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-198">PCA tracks this issue to give users a chance to run their app more reliably.</span></span>

<span data-ttu-id="7d2d1-199">針對這些應用程式，PCA 會自動以無訊息模式自動套用 PINDLL 相容性模式。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-199">For these apps, PCA automatically applies the PINDLL compatibility mode silently.</span></span> <span data-ttu-id="7d2d1-200">PCA 所叫用的相容性模式可防止應用程式釋放記憶體的 DLL。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-200">The compatibility mode invoked by PCA prevents the app from freeing the DLL from memory.</span></span> <span data-ttu-id="7d2d1-201">因此，應用程式對 DLL 的函式呼叫將會運作，以防止應用程式損毀，並允許它繼續正常運作。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-201">So, the function call into the DLL by the app will work, preventing the app from crashing and allowing it to continue to function properly.</span></span>

<span data-ttu-id="7d2d1-202">**應用程式因系統檔案不相符而失敗**</span><span class="sxs-lookup"><span data-stu-id="7d2d1-202">**App fails due to mismatched system files**</span></span>

<span data-ttu-id="7d2d1-203">某些專為 Windows XP 和先前設計的應用程式會包含 Windows 系統 Dll 的複本及其安裝程式。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-203">Some apps designed for Windows XP and prior include copies of Windows system DLLs along with their installers.</span></span> <span data-ttu-id="7d2d1-204">安裝這類應用程式時，應用程式會在它自己的資料夾中同時有 DLL 的較舊複本，以及 Windows 系統資料夾中的最新 DLL 版本。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-204">When such apps are installed, the app has both an older copy of the DLL in its own folder as well as the latest version of the DLL that is in the Windows system folders.</span></span>

<span data-ttu-id="7d2d1-205">在 Windows Vista 和更新版本上，這種情況可能會導致應用程式在嘗試載入本機 DLL 時失敗，因為這個 DLL 無法與其余的目前 Windows 系統 Dll 妥善搭配運作。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-205">On Windows Vista and later, this condition can cause the app to fail when it tries to load the local DLL, since this DLL will not work well with the rest of the current Windows system DLLs.</span></span> <span data-ttu-id="7d2d1-206">由於應用程式通常不會察覺到這個 DLL 的較新版本，因此無法正常運作。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-206">Since the app is generally not aware of the newer versions of this DLL, it fails to work properly.</span></span>

<span data-ttu-id="7d2d1-207">當 PCA 偵測到 DLL 無法正確載入時，它會套用相容性設定，讓 Windows 從 Windows 系統資料夾載入最新版本的 DLL，讓應用程式可以正常執行。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-207">When PCA detects that the DLL failed to load properly, it will applies a compatibility setting that allows Windows to load the latest version of the DLL from the Windows system folder so the app can run properly.</span></span>

<span data-ttu-id="7d2d1-208">在應用程式第一次執行失敗的結束時，使用者會看到 PCA 對話方塊，通知其套用的設定，如下所示：</span><span class="sxs-lookup"><span data-stu-id="7d2d1-208">At the end of the first failed run of the app, users will see the PCA dialog that notifies them of the applied setting as below:</span></span>

![應用程式因系統檔案不相符而失敗對話方塊](images/pcafigure6.png)

<span data-ttu-id="7d2d1-210">**應用程式因64位 Windows 上發生未處理的錯誤而失敗**</span><span class="sxs-lookup"><span data-stu-id="7d2d1-210">**App fails due to Unhandled Errors on 64-bit Windows**</span></span>

<span data-ttu-id="7d2d1-211">在64位版本的 Windows 8 上，訊息迴圈回呼機制已啟用新的例外狀況。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-211">On 64-bit version of Windows 8, a new exception was enabled to the message loop callback mechanism.</span></span> <span data-ttu-id="7d2d1-212">雖然此例外狀況是在 Windows 7 中首次引進的，但並不是處理此錯誤的必要項。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-212">While this exception was first introduced in Windows 7, it was not mandatory to handle this error.</span></span> <span data-ttu-id="7d2d1-213">在 Windows 8 中，使用訊息迴圈的應用程式必須處理這個新的例外狀況。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-213">In Windows 8, apps that use message loops must handle this new exception.</span></span> <span data-ttu-id="7d2d1-214">如果沒有，則會損毀。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-214">If they do not, they will crash.</span></span> <span data-ttu-id="7d2d1-215">針對較舊的 Windows 版本所設計的應用程式可能不會察覺到這個例外狀況，因此可能無法正確地 (例外狀況) 來處理此錯誤。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-215">Apps designed for older Windows versions may not be aware of this exception, and hence may not handle this error (exception) properly.</span></span>

<span data-ttu-id="7d2d1-216">PCA 會偵測由於此未處理的錯誤而失敗的應用程式，並自動套用應用程式的 DISABLEUSERCALLBACKEXCEPTION 相容性模式。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-216">PCA detects apps that fail due to this unhandled error, and automatically applies the DISABLEUSERCALLBACKEXCEPTION compatibility mode for the app.</span></span> <span data-ttu-id="7d2d1-217">在執行結束之後套用設定之後，使用者會收到如下的通知。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-217">After the setting is applied at the end of the run, the user is notified as below.</span></span> <span data-ttu-id="7d2d1-218">應用程式將會在下一次執行時取得模式，並且可以避免此錯誤。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-218">The app will get the mode on the next run, and will be able to avoid this error.</span></span>

![應用程式因64位 windows 對話方塊上發生未處理的錯誤而失敗](images/pcafigure7.png)

<span data-ttu-id="7d2d1-220">**應用程式在嘗試刪除受保護的非 Windows 檔案時失敗**</span><span class="sxs-lookup"><span data-stu-id="7d2d1-220">**App fails while attempting to delete protected non-Windows files**</span></span>

<span data-ttu-id="7d2d1-221">某些專為 Windows XP 和之前設計的應用程式會假設它們通常會以完整的系統管理許可權執行。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-221">Some apps designed for Windows XP and prior assume that they usually run with full administrative privileges.</span></span> <span data-ttu-id="7d2d1-222">在正常的應用程式行為的過程中，他們可能會嘗試在 [program files] 或 [Windows 資料夾]) 中刪除受保護的非 Windows 檔案 (。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-222">As a course of normal app behavior, they may try to delete protected non-Windows files (either in program files or Windows folders).</span></span> <span data-ttu-id="7d2d1-223">當刪除作業失敗時，許多這類應用程式可能會損毀。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-223">When the delete operation fails many such apps can crash.</span></span>

<span data-ttu-id="7d2d1-224">PCA 會偵測無法刪除受保護檔案和當機的應用程式，並為使用者提供建議。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-224">PCA detects these apps that fail to delete protected files and crash, and provides a recommendation to the user.</span></span> <span data-ttu-id="7d2d1-225">PCA 可讓使用者重新執行具有相容性設定的應用程式。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-225">PCA will allow the user to re-run the app with compatibility settings.</span></span> <span data-ttu-id="7d2d1-226">如同在任何案例中，使用者可以將應用程式正確執行，或按一下 [關閉] 按鈕退出建議的設定。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-226">As in any of the scenarios, the user can tell PCA that the app ran correctly, or opt out of the recommended settings by clicking the close button.</span></span> <span data-ttu-id="7d2d1-227">在此情況下，PCA 會套用 VIRTUALIZEDELETE 相容性模式。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-227">In this case PCA applies the VIRTUALIZEDELETE compatibility mode.</span></span> <span data-ttu-id="7d2d1-228">提供的範例對話方塊如下所示：</span><span class="sxs-lookup"><span data-stu-id="7d2d1-228">An example dialog is provided as below:</span></span>

![應用程式在嘗試刪除受保護的非 windows 檔案對話方塊時失敗](images/pcafigure8.png)

<span data-ttu-id="7d2d1-230">**應用程式在嘗試修改 Windows 檔案或登錄機碼時失敗**</span><span class="sxs-lookup"><span data-stu-id="7d2d1-230">**App fails while attempting to modify Windows files or registry keys**</span></span>

<span data-ttu-id="7d2d1-231">某些專為 Windows XP 和之前設計的應用程式會假設它們通常會以完整的系統管理許可權執行。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-231">Some apps designed for Windows XP and prior assume that they usually run with full administrative privileges.</span></span> <span data-ttu-id="7d2d1-232">在正常的應用程式行為的過程中，他們可能會嘗試修改、刪除或寫入 windows 受保護的檔案 (在 [program files] 或 [Windows 資料夾] 中，) 或 Windows 所擁有的登錄機碼。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-232">As a course of normal app behavior, they may try to modify, delete or write Windows protected files (either in program files or Windows folders) or Registry keys owned by Windows.</span></span> <span data-ttu-id="7d2d1-233">當檔案或登錄機碼的任何寫入、刪除或修改作業失敗時，許多這類應用程式可能會損毀或失敗。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-233">When any of the write, delete or modify operation for a file or a registry key fails many such apps can crash or fail badly.</span></span>

<span data-ttu-id="7d2d1-234">PCA 會偵測這些應用程式無法寫入受保護的 Windows 檔案或登錄機碼，並在應用程式結束時為使用者提供建議。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-234">PCA detects these apps that fail to write to protected Windows files or registry keys, and provides a recommendation to the user when the app quits.</span></span> <span data-ttu-id="7d2d1-235">PCA 可讓使用者重新執行具有相容性設定的應用程式。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-235">PCA will allow the user to re-run the app with compatibility settings.</span></span> <span data-ttu-id="7d2d1-236">如同在任何案例中，使用者可以將應用程式正確執行，或按一下 [關閉] 按鈕退出建議的設定。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-236">As in any of the scenarios, the user can tell PCA that the app ran correctly, or opt out of the recommended settings by clicking the Close button.</span></span> <span data-ttu-id="7d2d1-237">在此情況下，PCA 會套用 WRPMITIGATION 相容性模式。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-237">In this case PCA applies the WRPMITIGATION compatibility mode.</span></span> <span data-ttu-id="7d2d1-238">提供的範例對話方塊如下所示：</span><span class="sxs-lookup"><span data-stu-id="7d2d1-238">An example dialog is provided as below:</span></span>

![應用程式在嘗試修改 windows 檔案或登錄機碼對話方塊時失敗](images/pcafigure9.png)

<span data-ttu-id="7d2d1-240">**應用程式因使用8或16位色彩模式而失敗**</span><span class="sxs-lookup"><span data-stu-id="7d2d1-240">**App fails due to using 8- or 16-bit color modes**</span></span>

<span data-ttu-id="7d2d1-241">作為 Windows Store 應用程式的重創 Windows 8 的一部分，其中一項重要變更是桌面視窗管理員 (DWM) 現在只會在 Windows 8 中支援32位色彩。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-241">As part of reimagining Windows 8 for Windows Store apps, one of the key changes is that the Desktop Window Manager (DWM) will now support only 32-bit colors in Windows 8.</span></span> <span data-ttu-id="7d2d1-242">現在會模擬較低的色彩模式。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-242">Lower color modes are now simulated.</span></span>

<span data-ttu-id="7d2d1-243">許多專為 Windows XP 設計的繼承應用程式和遊戲，或在使用8位或16位色彩模式之前。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-243">Many older apps and games designed for Windows XP or before use 8-bit or 16-bit color modes.</span></span> <span data-ttu-id="7d2d1-244">由於不會有任何風險降低，因此這些應用程式可能無法在 Windows 8 上執行。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-244">With no mitigation, these apps could fail to execute on Windows 8.</span></span> <span data-ttu-id="7d2d1-245">不過，當這些應用程式列舉或嘗試使用任何8位或16位色彩模式來顯示時，PCA 會立即找出問題以及 DWM 的協助，以確保應用程式可在模擬的色彩模式下正常運作。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-245">However, when these apps enumerate or try to use any of the 8-bit or 16-bit color modes for display, PCA immediately identifies the issue and with the help of DWM, ensures that the app will work properly with the simulated color mode.</span></span>

<span data-ttu-id="7d2d1-246">請注意，這會在應用程式要求低色彩模式，且對使用者而言是透明的情況下發生。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-246">Note that this happens as soon as the app requests the low color modes and is transparent to the user.</span></span> <span data-ttu-id="7d2d1-247">使用者不需要重新開機應用程式就能降低此風險，因為一律需要此修正，以確保應用程式能夠正常運作。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-247">The user does not have to restart the app to get this mitigation because this fix is always needed to ensure that the app works properly.</span></span>

<span data-ttu-id="7d2d1-248">**應用程式因圖形和顯示器問題而失敗**</span><span class="sxs-lookup"><span data-stu-id="7d2d1-248">**Application fails due to graphics and display issues**</span></span>

<span data-ttu-id="7d2d1-249">因為桌面視窗管理員 (DWM) 一律在 Windows 8 中，所以如果應用程式使用混合模式圖形 Api，則某些較舊的 Windows XP 紀元應用程式可能會失敗，例如，使用 GDI 和 DirectX Api 來繪製到螢幕 (較舊的遊戲) ，並嘗試使用全螢幕模式：</span><span class="sxs-lookup"><span data-stu-id="7d2d1-249">Since Desktop Window Manager (DWM) is always on in Windows 8, some older Windows XP era apps can fail if the app uses mixed mode graphics APIs, as in using both GDI and DirectX APIs to draw to the screen (mostly older games), and tries to use full screen mode:</span></span>

-   <span data-ttu-id="7d2d1-250">DWM 會防止直接繪製至桌面，而遊戲或應用程式可能會失敗，或在桌面上繪製黑色畫面，且不會顯示任何圖形。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-250">DWM will prevent painting directly to the desktop and the game or app will either fail, or draw a black screen on to the desktop and none of the graphics will be visible</span></span>
-   <span data-ttu-id="7d2d1-251">在這種情況下，當應用程式結束時，Windows 會偵測到應用程式或遊戲有全螢幕模式的問題，並套用 DXMAXIMIZEDWINDOWEDMODE 相容性模式，讓應用程式或遊戲以最大化的視窗模式執行，而非全螢幕模式。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-251">In such cases, when the app quits, Windows detects that the app or game has a problem with full screen mode, and applies the DXMAXIMIZEDWINDOWEDMODE compatibility mode that allows the app or game to run in a maximized windowed mode instead of a full screen mode</span></span>
-   <span data-ttu-id="7d2d1-252">在執行結束之後套用設定之後，PCA 會通知使用者，如下所示：應用程式會在下一次執行時取得相容性模式，而且將能正常執行</span><span class="sxs-lookup"><span data-stu-id="7d2d1-252">After the setting is applied at the end of the run, the user is notified by PCA as shown below; the app will get the compatibility mode on the next run, and will be able run properly</span></span>

![應用程式因圖形和顯示問題對話方塊而失敗](images/pcafigure10.png)

<span data-ttu-id="7d2d1-254">**應用程式無法宣告 DPI 感知**</span><span class="sxs-lookup"><span data-stu-id="7d2d1-254">**App fails to declare DPI awareness**</span></span>

<span data-ttu-id="7d2d1-255">當 Windows 和應用程式在高 DPI 模式中執行時，會發生其他許多繼承應用程式的另一個常見顯示問題，但應用程式不會透過其 EXE 資訊清單宣告其高 DPI 的認知。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-255">Another typical display problem with many older apps happens when Windows and the app run in high DPI mode, but the app does not declare its awareness of High DPI through its EXE manifest.</span></span> <span data-ttu-id="7d2d1-256">由於這項設定不相符而可能發生的常見問題，會裁剪 UI 元素或文字和不正確的字型大小。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-256">Among the common problems that can occur due to this mismatch in settings are clipped UI elements or text and incorrect font size.</span></span> <span data-ttu-id="7d2d1-257">如需有關問題的詳細資訊，請參閱 [這裡](/previous-versions//dd464660(v=vs.85))的連結。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-257">For more details on the issues, see this link [here](/previous-versions//dd464660(v=vs.85)).</span></span>

<span data-ttu-id="7d2d1-258">在這種情況下，Windows 會偵測到應用程式是高 DPI 感知，並在第一次執行結束時將 HIGHDPIAWARE 相容性模式套用至應用程式。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-258">In such cases, Windows detects that the app is high DPI aware, and applies the HIGHDPIAWARE compatibility mode to the app at the end of the first run.</span></span> <span data-ttu-id="7d2d1-259">PCA 接著會通知使用者，如下所示：</span><span class="sxs-lookup"><span data-stu-id="7d2d1-259">PCA will then inform the user about this as shown below:</span></span>

![應用程式無法宣告 DPI 感知對話方塊](images/pcafigure11.png)

<span data-ttu-id="7d2d1-261">**應用程式因遺失 Windows 功能而失敗**</span><span class="sxs-lookup"><span data-stu-id="7d2d1-261">**Application fails due to missing Windows features**</span></span>

<span data-ttu-id="7d2d1-262">有些應用程式相依于 windows Vista 之後已移除的 Windows 功能。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-262">Some apps depend on Windows features that have been removed since Windows Vista.</span></span> <span data-ttu-id="7d2d1-263">當這些應用程式嘗試載入遺失的 Dll 或 COM 元件時，它們就無法運作。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-263">When these apps try to load the missing DLLs or COM components, they fail to work.</span></span>

<span data-ttu-id="7d2d1-264">PCA 會偵測應用程式嘗試載入遺失的 Windows 功能，並提供下載這些元件的建議，並在應用程式終止之後加以安裝。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-264">PCA detects apps when they try to load the missing Windows features, and provides a recommendation to download these components and install them after the app terminates.</span></span> <span data-ttu-id="7d2d1-265">使用者可以按一下 [線上取得說明] 以尋找替代選項，或下載並安裝該功能。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-265">The user can click on ‘get Help Online’ to find either an alternative or to download the feature and install it.</span></span> <span data-ttu-id="7d2d1-266">如有需要，使用者可以按一下 [關閉] 來選擇不執行任何動作。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-266">If needed, the user can choose to do nothing by clicking Close.</span></span>

![應用程式因為遺失 windows 功能對話方塊而失敗](images/pcafigure12.png)

<span data-ttu-id="7d2d1-268">**應用程式因64位的未簽署驅動程式而失敗 Windows 8**</span><span class="sxs-lookup"><span data-stu-id="7d2d1-268">**App fails due to unsigned drivers on 64-bit Windows 8**</span></span>

<span data-ttu-id="7d2d1-269">自 Windows Vista 起，64位 Windows 有必要的數位簽章驅動程式 (SYS 檔案) 。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-269">64-bit Windows has required digitally signed drivers (SYS files) since Windows Vista.</span></span> <span data-ttu-id="7d2d1-270">不過，繼承應用程式是在發行 Windows Vista 隨附的驅動程式之前所設計，但尚未經過數位簽署。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-270">However, older apps designed prior to the release of Windows Vista shipped drivers that were not digitally signed.</span></span> <span data-ttu-id="7d2d1-271">如果安裝這類未簽署的驅動程式，Windows 將不會載入它們。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-271">If such an unsigned driver is installed, Windows will not load them.</span></span> <span data-ttu-id="7d2d1-272">在罕見的情況下，如果這類驅動程式標示為開機時間驅動程式，則可能不會啟動 Windows。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-272">In rare cases, it is possible that Windows will not start if such drivers are marked as boot-time drivers.</span></span>

<span data-ttu-id="7d2d1-273">某些較舊的應用程式會安裝未在64位 Windows 上簽署的驅動程式。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-273">Some older apps install drivers that are not signed on 64-bit Windows.</span></span> <span data-ttu-id="7d2d1-274">任何嘗試使用此驅動程式的裝置或應用程式可能會失敗或導致系統損毀。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-274">Any device or app that tries to use this driver may fail or result in a system crash.</span></span> <span data-ttu-id="7d2d1-275">為了避免這種情況，PCA 會在安裝未簽署的驅動程式時偵測應用程式，並停用它標示為開機時間驅動程式的驅動程式。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-275">To prevent such a scenario, PCA detects apps when they install unsigned drivers, and disables the driver it is marked as a boot-time driver.</span></span>

<span data-ttu-id="7d2d1-276">它也會指示使用者取得經過數位簽署的驅動程式，讓應用程式正常運作。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-276">It also instructs the user to acquire a digitally signed driver for the app to work properly.</span></span> <span data-ttu-id="7d2d1-277">此訊息是因為安裝驅動程式，以及安裝應用程式的結果所顯示。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-277">The message is shown as a result of the installation of the driver, and as a result of the installation of the app.</span></span> <span data-ttu-id="7d2d1-278">如果另一個應用程式安裝相同的驅動程式，該應用程式也會取得相同的訊息。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-278">If another app installs the same driver, that app will get the same message as well.</span></span>

![應用程式因64位 windows 8 對話方塊上未簽署的驅動程式而失敗](images/pcafigure13.png)

<span data-ttu-id="7d2d1-280">**透過相容性設定來追蹤安裝的應用程式**</span><span class="sxs-lookup"><span data-stu-id="7d2d1-280">**Tracking apps installed through compatibility settings**</span></span>

<span data-ttu-id="7d2d1-281">當安裝程式失敗時，PCA 會根據失敗的類型，協助安裝程式使用各種相容性模式。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-281">When an installer fails, PCA helps the installer with various compatibility modes depending on the type of failure.</span></span> <span data-ttu-id="7d2d1-282">當安裝程式成功使用相容性設定之後，PCA 將會追蹤安裝程式新增的快捷方式。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-282">Once the installer succeeds with compatibility settings, PCA will track the shortcuts that the installer added.</span></span> <span data-ttu-id="7d2d1-283">這樣做的目的是要追蹤已安裝的應用程式是否也需要套用到其安裝程式的相容性設定。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-283">This is done to track if the apps that were installed may also need the compatibility settings applied to their installer.</span></span>

<span data-ttu-id="7d2d1-284">當使用者啟動這類應用程式時，PCA 會提示使用者詢問應用程式是否正常運作。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-284">When a user launches such an app, PCA prompts the user to ask if the app worked properly.</span></span> <span data-ttu-id="7d2d1-285">如果使用者回答「是」，PCA 會停止追蹤應用程式。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-285">If the user answers, ‘Yes,’ the PCA stops tracking the app.</span></span> <span data-ttu-id="7d2d1-286">如果使用者回答「否」，則會套用套用至應用程式安裝程式的相同相容性模式，然後重新執行應用程式並套用相容性模式。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-286">If the user answers ‘No,’ then it applies the same compatibility mode that was applied to the app’s installer, and re-runs the app with the compatibility mode applied.</span></span>

<span data-ttu-id="7d2d1-287">**應用程式無法啟動安裝程式或更新程式**</span><span class="sxs-lookup"><span data-stu-id="7d2d1-287">**App fails to launch installers or updaters**</span></span>

<span data-ttu-id="7d2d1-288">應用程式有時會啟動需要以系統管理員身分執行的副程式。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-288">Apps sometimes launch child programs that need to run as administrators.</span></span> <span data-ttu-id="7d2d1-289">當應用程式嘗試啟動其更新程式軟體以檢查並安裝新的應用程式更新時，通常會發生這種情況。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-289">This is typically the case when an app tries to launch its updater software to check and install new updates to the app.</span></span> <span data-ttu-id="7d2d1-290">當應用程式直接執行這類副程式時，副程式可能無法啟動，因為應用程式本身沒有系統管理許可權，或因為未正確地使用 UAC 資訊清單將副程式標示為提高許可權。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-290">When apps directly run such child programs, the child program can fail to launch because the app itself did not have administrative privileges, or because the child program was not properly marked for elevation with the UAC manifest.</span></span>

<span data-ttu-id="7d2d1-291">PCA 會追蹤這些錯誤，當主要應用程式關閉時，它會自動套用 ELE加值稅ECREATEPROCESS 相容性模式，以協助副程式正確執行。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-291">PCA tracks these errors and when the primary app closes, it automatically applies the ELEVATECREATEPROCESS compatibility mode that will help the child programs run correctly.</span></span> <span data-ttu-id="7d2d1-292">當應用程式在後續執行時啟動子應用程式時，使用者會看到副程式的 UAC 對話方塊。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-292">When the app launches the child app on subsequent runs, the user will see a UAC dialog for the child program.</span></span>

<span data-ttu-id="7d2d1-293">PCA 對話方塊的範例如下所示：</span><span class="sxs-lookup"><span data-stu-id="7d2d1-293">An Example of the PCA dialog is shown below:</span></span>

![應用程式無法啟動安裝程式或更新程式對話方塊](images/pcafigure14.png)

<span data-ttu-id="7d2d1-295">**需要以系統管理許可權執行的應用程式安裝程式**</span><span class="sxs-lookup"><span data-stu-id="7d2d1-295">**App installers that need to run with administrative privilege**</span></span>

<span data-ttu-id="7d2d1-296">Windows 桌面應用程式的安裝程式需要系統管理許可權，因為它們會將檔案、資料夾和登錄專案寫入受保護的系統區域。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-296">Installers of Windows desktop apps require administrative privileges since they write files, folders, and registry entries to protected system areas.</span></span> <span data-ttu-id="7d2d1-297">Windows (UAC) 具有偵測到安裝程式執行時所用的偵測邏輯，並且會立即提示使用者透過 UAC 對話方塊提供系統管理許可權。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-297">Windows (UAC) has detection logic to identify when an installer is run, and immediately prompts the user to provide administrative privileges through the UAC dialog.</span></span> <span data-ttu-id="7d2d1-298">不過，在某些情況下，此邏輯將無法判斷應用程式確實是安裝程式，而且可能無法取得系統管理許可權。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-298">However, in some cases, this logic will not be able to determine that an app was indeed an installer, and may not get administrative privileges.</span></span> <span data-ttu-id="7d2d1-299">這些通常是自訂的安裝程式，這些安裝程式不使用知名的安裝技術，例如 Windows Installer 或安裝盾牌。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-299">These are generally custom made installers that do not use well known install technologies such as Windows Installer or Install Shield.</span></span>

<span data-ttu-id="7d2d1-300">在這種情況下，PCA 會偵測到安裝程式無法寫入其檔案。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-300">In such cases, PCA detects that the installer failed to write its files.</span></span> <span data-ttu-id="7d2d1-301">如果安裝失敗，PCA 將提供套用相容性設定的建議。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-301">At the end if the failed install, PCA will provide a recommendation to apply compatibility settings.</span></span> <span data-ttu-id="7d2d1-302">如果使用者選擇按一下 [執行程式]，PCA 會套用 RUNASADMIN 相容性模式，然後重新執行安裝程式。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-302">If the user chooses to click ‘Run Program,’ PCA will apply the RUNASADMIN compatibility mode, and re-run the installer.</span></span> <span data-ttu-id="7d2d1-303">如果使用者選擇關閉，則不會套用任何設定。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-303">If the user chooses to close, then no setting will be applied.</span></span> <span data-ttu-id="7d2d1-304">範例 PCA 對話方塊如下所示：</span><span class="sxs-lookup"><span data-stu-id="7d2d1-304">An example PCA dialog is shown below:</span></span>

![顯示需要以系統管理許可權執行的應用程式安裝程式之對話方塊範例的螢幕擷取畫面。](images/pcafigure15.png)

<span data-ttu-id="7d2d1-306">需要以系統管理許可權的控制台 applet 來執行的舊版主控台 applet 通常會變更系統設定，而且需要執行 ad 系統管理員的能力。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-306">Legacy Control Panel applets that need to run with administrative privilege Control panel applets generally change system settings and need the ability to run ad administrator.</span></span> <span data-ttu-id="7d2d1-307">不過，在 Windows Vista 之前撰寫的程式不會有 EXE 資訊清單，或沒有宣告所需許可權層級的 TRUSTINFO 區段。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-307">However, those written before Windows Vista either do not have an EXE manifest or do not have the TRUSTINFO section that declares the privilege level they require.</span></span> <span data-ttu-id="7d2d1-308">執行這類 applet 時，PCA 會偵測到它們，並在第一次執行結束時，提供使用系統管理設定執行的建議。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-308">When such applets are run, PCA detects them, and at the end of the first run, provides a recommendation to run with administrative settings.</span></span> <span data-ttu-id="7d2d1-309">如果使用者選擇按一下 [執行程式]，PCA 會套用 RUNASADMIN 相容性模式，然後重新執行安裝程式。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-309">If the user chooses to click ‘Run Program,’ PCA applies the RUNASADMIN compatibility mode, and re-runs the installer.</span></span> <span data-ttu-id="7d2d1-310">如果使用者選擇關閉，則不會套用任何設定。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-310">If the user chooses to close, then no settings will be applied.</span></span> <span data-ttu-id="7d2d1-311">範例 PCA 對話方塊如下所示：</span><span class="sxs-lookup"><span data-stu-id="7d2d1-311">An example PCA dialog is shown below:</span></span>

![需要以系統管理許可權執行對話方塊的應用程式安裝程式](images/pcafigure16.png)

<span data-ttu-id="7d2d1-313">**透過使用者意見反應驗證建議的設定**</span><span class="sxs-lookup"><span data-stu-id="7d2d1-313">**Verifying the recommended settings through user feedback**</span></span>

<span data-ttu-id="7d2d1-314">在每個案例的結尾 (使用建議的相容性) 設定來執行應用程式之後，PCA 會詢問使用者一個簡單的問題：</span><span class="sxs-lookup"><span data-stu-id="7d2d1-314">At the end of each of the scenarios (after the app is run with recommended compatibility settings), PCA will ask the user a simple question:</span></span>

![透過使用者意見反應對話方塊驗證建議的設定](images/pcafigure17.png)

<span data-ttu-id="7d2d1-316">如果應用程式在相容性設定上運作或失敗，則使用者可以提供意見反應。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-316">The user can provide feedback if the app worked or failed with the compatibility setting.</span></span> <span data-ttu-id="7d2d1-317">此資料將會以匿名方式傳送給 Microsoft。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-317">This data will be sent anonymously to Microsoft.</span></span> <span data-ttu-id="7d2d1-318">這有助於確保這類修正程式可透過 Windows update 程式內建在 Windows 8 中，如此一來，Windows 8 的未來使用者將不再遇到應用程式失敗，而 PCA 將不再需要追蹤應用程式是否發生失敗。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-318">This helps to ensure that such fixes can be built into Windows 8 through Windows update process, so that future users of Windows 8 will no longer encounter the app failure, and PCA will no longer need to track the app for the failure.</span></span>

<span data-ttu-id="7d2d1-319">**追蹤沒有任何建議的問題**</span><span class="sxs-lookup"><span data-stu-id="7d2d1-319">**Tracking issues that have no recommendations**</span></span>

<span data-ttu-id="7d2d1-320">基於相容性的原因，應用程式可能會以許多不同的方式失敗。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-320">Apps may fail in many different ways for compatibility reasons.</span></span> <span data-ttu-id="7d2d1-321">PCA 會追蹤比上述案例中所列出的更多相容性問題。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-321">PCA tracks many more compatibility issues than what is listed in the above scenarios.</span></span> <span data-ttu-id="7d2d1-322">在這些情況下，問題的表現取決於應用程式。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-322">In these cases, many times, the issue manifestation depends on the app.</span></span> <span data-ttu-id="7d2d1-323">這表示，有些應用程式會正常地處理這類問題，而其他應用程式則不會加以復原。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-323">This means that some apps handle such issues gracefully and recover from it, while others may not.</span></span> <span data-ttu-id="7d2d1-324">因此，在此情況下，當 PCA 仍在追蹤應用程式時，它不會提供修正的直接建議。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-324">So, for such issues, while PCA still tracks the app, it does not provide a direct recommendation for a fix.</span></span>

<span data-ttu-id="7d2d1-325">PCA 追蹤沒有建議設定或對話方塊的問題，包括下列應用程式：</span><span class="sxs-lookup"><span data-stu-id="7d2d1-325">The issues that PCA tracks that do not have a recommended setting or a dialog include apps that:</span></span>

-   <span data-ttu-id="7d2d1-326">具有非常短的執行時間–應用程式執行超過三秒</span><span class="sxs-lookup"><span data-stu-id="7d2d1-326">Have a very short runtime – Apps run for no more than three seconds</span></span>
-   <span data-ttu-id="7d2d1-327">建立不具系統管理許可權的全域記憶體物件</span><span class="sxs-lookup"><span data-stu-id="7d2d1-327">Create global memory objects without administrative privileges</span></span>
-   <span data-ttu-id="7d2d1-328">啟動時)  (Win32 例外狀況</span><span class="sxs-lookup"><span data-stu-id="7d2d1-328">Have an error (Win32 exception) on launch</span></span>
-   <span data-ttu-id="7d2d1-329">檢查系統管理許可權 (但可能不會失敗) </span><span class="sxs-lookup"><span data-stu-id="7d2d1-329">Check for administrative privilege (but may not fail)</span></span>
-   <span data-ttu-id="7d2d1-330">使用 Windows Vista (淘汰的 Indeo 編解碼器) </span><span class="sxs-lookup"><span data-stu-id="7d2d1-330">Use Indeo codecs (deprecated from Windows Vista)</span></span>
-   <span data-ttu-id="7d2d1-331">嘗試寫入或刪除受保護登錄位置（例如 HKLM）中的金鑰</span><span class="sxs-lookup"><span data-stu-id="7d2d1-331">Try to write or delete keys from protected registry locations such as HKLM</span></span>
-   <span data-ttu-id="7d2d1-332">啟動時損毀</span><span class="sxs-lookup"><span data-stu-id="7d2d1-332">Crash on launch</span></span>

<span data-ttu-id="7d2d1-333">**透過 [相容性] 索引標籤和相容性疑難排解員套用修正程式**</span><span class="sxs-lookup"><span data-stu-id="7d2d1-333">**Applying fixes through the compatibility tab and compatibility troubleshooter**</span></span>

<span data-ttu-id="7d2d1-334">如先前所述，應用程式可能會因為各種不同的相容性原因而失敗。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-334">As mentioned above, apps can fail for a variety of compatibility reasons.</span></span> <span data-ttu-id="7d2d1-335">並非所有這些都有明確的 PCA 建議，因為設定與應用程式相依。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-335">Not all of these have clear PCA recommendation since the settings are app dependent.</span></span> <span data-ttu-id="7d2d1-336">不過，使用者可以移至相容性疑難排解員或 [相容性] 索引標籤，以套用某些常見的修正程式，以嘗試讓失敗的應用程式在 Windows 8 上正常運作。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-336">However, users can go to the Compatibility Troubleshooter or the Compatibility Tab to apply certain common fixes to try to get their failing app to work properly on Windows 8.</span></span> <span data-ttu-id="7d2d1-337">在這種情況下，在套用修正程式之前和之後，PCA 仍會追蹤應用程式的相容性問題。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-337">In such cases, PCA will still track the app for compatibility issues, before and after the fix is applied.</span></span> <span data-ttu-id="7d2d1-338">執行應用程式並套用修正之後，PCA 會詢問使用者是否已完成修正。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-338">After the app is run with the fix applied, PCA will ask the user if the fix worked.</span></span> <span data-ttu-id="7d2d1-339">一旦使用者回答問題，資料就會透過遙測以匿名方式傳送至 Microsoft。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-339">Once the user answers the question, the data is sent anonymously through telemetry to Microsoft.</span></span> <span data-ttu-id="7d2d1-340">這項資料是由許多使用者收集，並經過分析，然後透過 Windows update 將合格的修正程式廣泛散發給所有 Windows 8 使用者。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-340">This data is collected from many users and analyzed, and the qualifying fixes are then broadly distributed to all Windows 8 users through Windows update.</span></span>

<span data-ttu-id="7d2d1-341">**使用相容性疑難排解員**</span><span class="sxs-lookup"><span data-stu-id="7d2d1-341">**Using the Compatibility Troubleshooter**</span></span>

<span data-ttu-id="7d2d1-342">相容性疑難排解員是 Windows 中的一種機制，可讓您診斷應用程式的問題，並套用建議的修正程式，讓它們正常運作。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-342">The Compatibility Troubleshooter is a mechanism in Windows that allows you diagnose problems with apps and apply recommended fixes to get them working properly.</span></span> <span data-ttu-id="7d2d1-343">只有當 PCA 不提供應用程式的任何建議時，才需要此項。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-343">This is needed only when PCA does not to provide any recommendation for the app.</span></span>

<span data-ttu-id="7d2d1-344">疑難排解員可讓使用者逐步解說和回答一組問題，並根據回復來套用一組修正程式，並允許使用者測試其應用程式並驗證修正。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-344">The troubleshooter allows users to walk through and answer a set of questions, and based on the replies, it will apply a set of fixes and allow the users to test their apps and verify the fixes.</span></span> <span data-ttu-id="7d2d1-345">經過驗證之後，就會將修正程式永久套用至應用程式，使其在 Windows 8 上的效果更好。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-345">Once verified, the fixes will be applied permanently to the apps to make them work better on Windows 8.</span></span>

<span data-ttu-id="7d2d1-346">以下顯示疑難排解員 UI，供您參考：</span><span class="sxs-lookup"><span data-stu-id="7d2d1-346">The Troubleshooter UI is shown below for reference:</span></span>

![使用相容性疑難排解員對話方塊](images/pcafigure18.png)

<span data-ttu-id="7d2d1-348">您可以透過兩種方式來啟動相容性疑難排解員：</span><span class="sxs-lookup"><span data-stu-id="7d2d1-348">You can start the Compatibility Troubleshooter in two ways:</span></span>

<span data-ttu-id="7d2d1-349">**從 [開始] 畫面：**</span><span class="sxs-lookup"><span data-stu-id="7d2d1-349">**From the start screen:**</span></span>

1.  <span data-ttu-id="7d2d1-350">類型：相容性疑難排解員</span><span class="sxs-lookup"><span data-stu-id="7d2d1-350">Type: compatibility troubleshooter</span></span>
2.  <span data-ttu-id="7d2d1-351">在 [設定] 區段下，按一下 [執行舊版 Windows 所做的程式] 磚</span><span class="sxs-lookup"><span data-stu-id="7d2d1-351">Under the settings section, click the ‘Run programs made for previous version of Windows’ tile</span></span>

  
<span data-ttu-id="7d2d1-352">**從應用程式圖格：**</span><span class="sxs-lookup"><span data-stu-id="7d2d1-352">**From the app tile:**</span></span>

1.  <span data-ttu-id="7d2d1-353">在開始畫面中，以滑鼠右鍵按一下應用程式磚</span><span class="sxs-lookup"><span data-stu-id="7d2d1-353">From the Start screen, right click the app tile</span></span>
2.  <span data-ttu-id="7d2d1-354">按一下 [開啟檔案位置] (僅限桌面應用程式) </span><span class="sxs-lookup"><span data-stu-id="7d2d1-354">Click ‘Open File Location’ (Desktop apps only)</span></span>
3.  <span data-ttu-id="7d2d1-355">從 Explorer 功能區中，按一下 [應用程式] 索引標籤</span><span class="sxs-lookup"><span data-stu-id="7d2d1-355">From the Explorer ribbon, click the ‘App tab’</span></span>
4.  <span data-ttu-id="7d2d1-356">選擇 [疑難排解相容性]</span><span class="sxs-lookup"><span data-stu-id="7d2d1-356">Choose ‘Troubleshoot Compatibility’</span></span>

  


<span data-ttu-id="7d2d1-357">**使用 [相容性] 索引標籤**</span><span class="sxs-lookup"><span data-stu-id="7d2d1-357">**Using the Compatibility Tab**</span></span>

<span data-ttu-id="7d2d1-358">請注意，這僅適用于嘗試不同相容性設定之專家的使用者。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-358">Note that this is recommended only for users who are experts in trying different compatibility settings.</span></span> <span data-ttu-id="7d2d1-359">這個方法不會提供要套用至應用程式之修正類型的任何建議。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-359">This method does not provide any recommendation of the type of fix to apply to apps.</span></span> <span data-ttu-id="7d2d1-360">在此，使用者應該知道可以套用哪些修正程式才能讓應用程式運作。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-360">Here the user is expected to know what fixes can be applied to make the app work.</span></span> <span data-ttu-id="7d2d1-361">如果您不確定修正問題，請使用相容性疑難排解員找出應用程式的修正程式。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-361">If you are unsure of the fixes, please use the Compatibility Troubleshooter to find a fix for the app.</span></span>

<span data-ttu-id="7d2d1-362">若要存取 [相容性] 索引標籤：</span><span class="sxs-lookup"><span data-stu-id="7d2d1-362">To access the Compatibility Tab:</span></span>

 <span data-ttu-id="7d2d1-363">**從 [開始] 畫面：**</span><span class="sxs-lookup"><span data-stu-id="7d2d1-363">**From the start screen:**</span></span>

1.  <span data-ttu-id="7d2d1-364">以滑鼠右鍵按一下應用程式磚</span><span class="sxs-lookup"><span data-stu-id="7d2d1-364">Right click the app tile</span></span>
2.  <span data-ttu-id="7d2d1-365">僅) 開啟檔案位置 (桌面應用程式</span><span class="sxs-lookup"><span data-stu-id="7d2d1-365">Open file location (desktop apps only)</span></span>

  
<span data-ttu-id="7d2d1-366">**從 [Explorer] 功能區：**</span><span class="sxs-lookup"><span data-stu-id="7d2d1-366">**From the Explorer ribbon:**</span></span>

1.  <span data-ttu-id="7d2d1-367">按一下 [內容]</span><span class="sxs-lookup"><span data-stu-id="7d2d1-367">Click Properties</span></span>
2.  <span data-ttu-id="7d2d1-368">流覽至 [相容性] 索引標籤</span><span class="sxs-lookup"><span data-stu-id="7d2d1-368">Navigate to the Compatibility Tab</span></span>
3.  <span data-ttu-id="7d2d1-369">選取相容性修正程式</span><span class="sxs-lookup"><span data-stu-id="7d2d1-369">Select the compatibility fixes</span></span>
4.  <span data-ttu-id="7d2d1-370">重新執行應用程式</span><span class="sxs-lookup"><span data-stu-id="7d2d1-370">Re-run the app</span></span>
    > [!Note]  
    > <span data-ttu-id="7d2d1-371">您也可以再次回到相同位置，以變更或移除修正程式。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-371">You can come back to the same place again to change or remove the fixes as well.</span></span> <span data-ttu-id="7d2d1-372">您也可以使用索引標籤中提供的按鈕，將修正程式套用到電腦上的所有使用者。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-372">You can also apply the fixes to all users on the machine using the button provided in the tab.</span></span>

     

  


![使用 [相容性] 索引標籤](images/pcafigure19.png)

<span data-ttu-id="7d2d1-374">**已知相容性問題的應用程式**</span><span class="sxs-lookup"><span data-stu-id="7d2d1-374">**Apps with known compatibility issues**</span></span>

<span data-ttu-id="7d2d1-375">除了上面所列的執行時間問題偵測案例之外，如果應用程式有已知的相容性問題，PCA 也會在應用程式啟動時通知使用者。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-375">Apart from the runtime issues detection scenarios listed above, PCA also informs users at app startup if the app has known compatibility issues.</span></span> <span data-ttu-id="7d2d1-376">此清單會儲存在系統應用程式相容性資料庫中。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-376">The list is stored in the System app compatibility database.</span></span> <span data-ttu-id="7d2d1-377">這些訊息有兩種類型：</span><span class="sxs-lookup"><span data-stu-id="7d2d1-377">There are two types of these messages:</span></span>

-   <span data-ttu-id="7d2d1-378">**硬封鎖訊息**-如果已知應用程式不相容，而且如果允許應用程式執行，將會對系統造成嚴重的影響 (例如，Windows 損毀或在安裝) 之後無法開機，則會顯示如下所示的封鎖訊息</span><span class="sxs-lookup"><span data-stu-id="7d2d1-378">**Hard Block Messages**—if the app is known to be incompatible and if allowing the app to run will result in severe impact to the system (for example, a Windows crash or being unable to boot after the installation), a blocking message as shown below will be displayed</span></span>

![具有已知相容性問題的應用程式-[硬封鎖訊息] 對話方塊](images/pcafigure20.png)

-   <span data-ttu-id="7d2d1-380">**軟封鎖訊息**-如果應用程式有已知的相容性問題，而且可能無法正常運作，則會顯示此訊息：</span><span class="sxs-lookup"><span data-stu-id="7d2d1-380">**Soft Block Messages**— If the app has a known compatibility issue and may not work properly, then this message is shown:</span></span>

![具有已知相容性問題的應用程式-軟封鎖訊息對話方塊](images/pcafigure21.png)

<span data-ttu-id="7d2d1-382">在這兩種情況下，[取得線上協助] 選項都會傳送 Windows 錯誤報告，以取得 Microsoft 的線上回應並向使用者顯示。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-382">In both cases, the ‘Get help Online’ option sends a Windows Error Report to get an online response from Microsoft and display it to the user.</span></span> <span data-ttu-id="7d2d1-383">回應通常會將使用者指向三種資源類型的其中一種：</span><span class="sxs-lookup"><span data-stu-id="7d2d1-383">Typically the responses will point the user to one of three types of resources:</span></span>

-   <span data-ttu-id="7d2d1-384">應用程式廠商的更新</span><span class="sxs-lookup"><span data-stu-id="7d2d1-384">An update from the app vendor</span></span>
-   <span data-ttu-id="7d2d1-385">應用程式廠商的網站以取得詳細資訊</span><span class="sxs-lookup"><span data-stu-id="7d2d1-385">An app vendor’s website for more info</span></span>
-   <span data-ttu-id="7d2d1-386">如需詳細資訊，請參閱 Microsoft 知識庫文章</span><span class="sxs-lookup"><span data-stu-id="7d2d1-386">A Microsoft Knowledge base article for more info</span></span>

<span data-ttu-id="7d2d1-387">**PCA 的遙測**</span><span class="sxs-lookup"><span data-stu-id="7d2d1-387">**Telemetry for PCA**</span></span>

<span data-ttu-id="7d2d1-388">當 PCA 解決 Windows 8 機上的任何應用程式問題，並取得所有使用者意見反應之後，它會收集應用程式、安裝程式、偵測到的問題以及套用至應用程式的相容性設定的匿名資料，然後將其傳回給 Microsoft。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-388">After PCA addresses any app issues on a Windows 8 machine and gets all the user feedback, it collects anonymous data about the app, the installer, the issues detected, and the compatibility settings applied to the app, and send it back to Microsoft.</span></span> <span data-ttu-id="7d2d1-389">這項資料是從任何願意透過客戶經驗改進計畫-CEIP) 提供這類匿名資料 (的使用者進行收集。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-389">This data is collected from any user who is willing to provide such anonymous data (through the Customer Experience Improvement Program - CEIP).</span></span> <span data-ttu-id="7d2d1-390">一旦收集這項資料，就會分析應用程式失敗和修正程式，然後透過 Windows Update 機制，將修正程式散發至整個 Windows 生態系統，讓應用程式的任何使用者在未來都能自動從修正中獲益。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-390">Once this data is collected, the app failures and fixes are analyzed, and the fixes are then distributed to the entire Windows ecosystem through the Windows Update mechanism so that any user of the app in the future benefits from the fix automatically.</span></span>

<span data-ttu-id="7d2d1-391">**管理控制項和管理 PCA 設定**</span><span class="sxs-lookup"><span data-stu-id="7d2d1-391">**Administrative controls and managing PCA settings**</span></span>

<span data-ttu-id="7d2d1-392">IT 系統管理員可以透過兩種方式來控制 PCA 行為：</span><span class="sxs-lookup"><span data-stu-id="7d2d1-392">IT administrators can control PCA behavior in two ways:</span></span>

-   <span data-ttu-id="7d2d1-393">**關閉 pca** –此設定可讓 IT 系統管理員關閉 pca 向使用者顯示的對話方塊;PCA 仍會追蹤及偵測問題，並傳回遙測資料</span><span class="sxs-lookup"><span data-stu-id="7d2d1-393">**Turn off PCA** – this setting allows IT administrators to turn off the dialogs that PCA shows to the users; PCA will still track and detect issues and send back telemetry</span></span>
-   <span data-ttu-id="7d2d1-394">關閉 **應用程式遙測**-這項設定將會依 PCA 關閉任何收集和傳送遙測資料</span><span class="sxs-lookup"><span data-stu-id="7d2d1-394">**Turn off App telemetry** – this setting will turn off any collection and sending of telemetry data by PCA</span></span>
    > [!Note]  
    > <span data-ttu-id="7d2d1-395">如果已關閉 CEIP，此設定不會有任何影響。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-395">If CEIP is turned off, this setting has no impact.</span></span>

     

<span data-ttu-id="7d2d1-396">**設計應用程式以使用 PCA**</span><span class="sxs-lookup"><span data-stu-id="7d2d1-396">**Designing apps to work with PCA**</span></span>

<span data-ttu-id="7d2d1-397">開發人員必須確保其應用程式在上述所有相容性案例中都能順利運作。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-397">Developers need to ensure that their apps will work well across all of the compatibility scenarios described above.</span></span> <span data-ttu-id="7d2d1-398">開發人員必須針對上述各案例測試及驗證其應用程式，並確保不會有任何相容性問題。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-398">Developers must test and validate their apps for each of the above scenarios and ensure that there are no compatibility issues.</span></span> <span data-ttu-id="7d2d1-399">如果識別出相容性問題，開發人員應該對其應用程式進行修正，以確保相容性問題已解決。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-399">If compatibility issues are identified, developers should make the fixes to their apps necessary to ensure that the compatibility issue is resolved.</span></span> <span data-ttu-id="7d2d1-400">開發人員應該進行的一些常見修正包括：</span><span class="sxs-lookup"><span data-stu-id="7d2d1-400">Some of the common fixes that developers should make include:</span></span>

-   <span data-ttu-id="7d2d1-401">在安裝和執行時間排除 Windows 作業系統版本檢查</span><span class="sxs-lookup"><span data-stu-id="7d2d1-401">Eliminate Windows operating system version checks at install and runtime</span></span>
-   <span data-ttu-id="7d2d1-402">排除許可權檢查 (檢查系統管理員存取權) ;使用 EXE 資訊清單來宣告所需的正確許可權層級</span><span class="sxs-lookup"><span data-stu-id="7d2d1-402">Eliminate privilege check (checking for administrator access); use the EXE manifest to declare the right level of privilege needed</span></span>
-   <span data-ttu-id="7d2d1-403">確定應用程式安裝程式中未隨附 Windows 二進位檔</span><span class="sxs-lookup"><span data-stu-id="7d2d1-403">Ensure that Windows binaries are not shipped within the app installer</span></span>
-   <span data-ttu-id="7d2d1-404">消除寫入受保護區域 (登錄、資料夾) 或寫入受保護的檔案</span><span class="sxs-lookup"><span data-stu-id="7d2d1-404">Eliminate writing to protected areas (registry, folders) or writing over protected files</span></span>
-   <span data-ttu-id="7d2d1-405">以數位方式簽署所有二進位檔 (EXE、DLL、SYS 檔案) </span><span class="sxs-lookup"><span data-stu-id="7d2d1-405">Digitally sign all binaries (EXE, DLL, SYS files)</span></span>
-   <span data-ttu-id="7d2d1-406">針對安裝程式，請確定已新增適當的 [新增/移除程式] 專案;此應用程式中繼資料專案至少應該包含應用程式名稱、發行者、版本字串和支援的語言。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-406">For installers, ensure that proper ‘Add/Remove programs’ entry is added; at a minimum, this app metadata entry should include the app name, publisher, Version string, and supported language.</span></span> <span data-ttu-id="7d2d1-407">這會向 PCA 指出安裝程式已順利完成，而且也會提供便利的方式讓使用者卸載應用程式</span><span class="sxs-lookup"><span data-stu-id="7d2d1-407">This will indicate to PCA that the installer completed successfully and will also provide a convenient way for users to uninstall the app</span></span>

<span data-ttu-id="7d2d1-408">確定應用程式的 [TRUSTINFO] 和 [相容性] 區段已更新 Windows 8 相容性操作手冊中所列出的 (可執行檔) 資訊清單，可讓 PCA 知道應用程式是針對 Windows 8 所設計，而且也可確保應用程式一律以原生方式執行，而不會套用任何相容性模式。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-408">Ensuring that the TRUSTINFO and COMPATIBILITY section of the app (executable) manifest is updated as listed in the Windows 8 Compatibility Cookbook will let PCA know that the app was designed for Windows 8, and will also ensure that the app always runs natively without any compatibility modes applied to it.</span></span>

<span data-ttu-id="7d2d1-409">為了確保 PCA 會將應用程式視為針對 Windows 8 所設計：</span><span class="sxs-lookup"><span data-stu-id="7d2d1-409">To ensure that PCA considers the app to be designed for Windows 8:</span></span>

-   <span data-ttu-id="7d2d1-410">所有 Exe (安裝程式或執行時間) 都必須針對 Windows 8 的 TRUSTINFO 和相容性區段進行說明。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-410">The all EXEs (installer or runtime) must be manifested for TRUSTINFO and COMPATIBILITY sections for Windows 8</span></span>
-   <span data-ttu-id="7d2d1-411">安裝程式應新增 [新增/移除程式] 專案</span><span class="sxs-lookup"><span data-stu-id="7d2d1-411">The installer should add an ‘Add/Remove programs’ entry</span></span>

<span data-ttu-id="7d2d1-412">**詞彙**</span><span class="sxs-lookup"><span data-stu-id="7d2d1-412">**Glossary**</span></span>

<span data-ttu-id="7d2d1-413">PCA 所使用的相容性模式如下所示，其中包含模式所能啟用的簡短描述。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-413">The compatibility modes used by PCA are listed below with a brief description of what the mode enables.</span></span>



| <span data-ttu-id="7d2d1-414">[模式]</span><span class="sxs-lookup"><span data-stu-id="7d2d1-414">Mode</span></span>                         | <span data-ttu-id="7d2d1-415">描述</span><span class="sxs-lookup"><span data-stu-id="7d2d1-415">Description</span></span>                                                                                                                                                      |
|------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="7d2d1-416">Windows7RTM</span><span class="sxs-lookup"><span data-stu-id="7d2d1-416">Windows7RTM</span></span>                  | <span data-ttu-id="7d2d1-417">此模式會模擬常見的 Windows 7 行為，包括作業系統版本號碼6。1</span><span class="sxs-lookup"><span data-stu-id="7d2d1-417">This mode emulates common Windows 7 behavior including the operating system version number 6.1</span></span>                                                                   |
| <span data-ttu-id="7d2d1-418">WindowsVistaSP2</span><span class="sxs-lookup"><span data-stu-id="7d2d1-418">WindowsVistaSP2</span></span>              | <span data-ttu-id="7d2d1-419">此模式會模擬常見的 Windows 7 行為，包括作業系統版本號碼6。1</span><span class="sxs-lookup"><span data-stu-id="7d2d1-419">This mode emulates common Windows 7 behavior including the operating system version number 6.1</span></span>                                                                   |
| <span data-ttu-id="7d2d1-420">WindowsXPSp3</span><span class="sxs-lookup"><span data-stu-id="7d2d1-420">WindowsXPSp3</span></span>                 | <span data-ttu-id="7d2d1-421">此模式會模擬常見的 Windows XP SP3 行為，包括作業系統版本號碼5.1。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-421">This mode emulates common Windows XP SP3 behavior including the operating system version number 5.1.</span></span> <span data-ttu-id="7d2d1-422">這也包含 RUNASHIGHEST 模式</span><span class="sxs-lookup"><span data-stu-id="7d2d1-422">This also includes the RUNASHIGHEST mode</span></span>                    |
| <span data-ttu-id="7d2d1-423">RUNASHIGHEST</span><span class="sxs-lookup"><span data-stu-id="7d2d1-423">RUNASHIGHEST</span></span>                 | <span data-ttu-id="7d2d1-424">此模式會提示使用者以最高的可用許可權來執行應用程式。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-424">This mode prompts the user to run the app with the highest available privilege.</span></span> <span data-ttu-id="7d2d1-425">具有系統管理許可權的使用者將會看到應用程式的 UAC 提高許可權提示</span><span class="sxs-lookup"><span data-stu-id="7d2d1-425">Users with administrative privileges will see a UAC elevation prompt for the app</span></span> |
| <span data-ttu-id="7d2d1-426">RUNASADMIN</span><span class="sxs-lookup"><span data-stu-id="7d2d1-426">RUNASADMIN</span></span>                   | <span data-ttu-id="7d2d1-427">此模式一律會提示使用者以系統管理許可權執行應用程式;使用此模式的應用程式一律會取得 UAC 提高許可權提示</span><span class="sxs-lookup"><span data-stu-id="7d2d1-427">This mode always prompts the user to run the app with administrative privileges; apps with this mode will always get the UAC elevation prompt</span></span>                    |
| <span data-ttu-id="7d2d1-428">ELE加值稅ECREATEPROCESS</span><span class="sxs-lookup"><span data-stu-id="7d2d1-428">ELEVATECREATEPROCESS</span></span>         | <span data-ttu-id="7d2d1-429">此模式會讓主要應用程式的子進程以系統管理許可權執行;子進程會取得 UAC 提高許可權對話方塊</span><span class="sxs-lookup"><span data-stu-id="7d2d1-429">This mode makes child processes of the main app run with administrative privileges; the child processes will get a UAC elevation dialog</span></span>                          |
| <span data-ttu-id="7d2d1-430">PINDLL</span><span class="sxs-lookup"><span data-stu-id="7d2d1-430">PINDLL</span></span>                       | <span data-ttu-id="7d2d1-431">即使應用程式卸載 DLL，此模式仍會強制 DLL 位於應用程式的記憶體中</span><span class="sxs-lookup"><span data-stu-id="7d2d1-431">This mode forces a DLL to be in memory for an app even if the app unloads the DLL</span></span>                                                                                |
| <span data-ttu-id="7d2d1-432">DISABLEUSERCALLBACKEXCEPTION</span><span class="sxs-lookup"><span data-stu-id="7d2d1-432">DISABLEUSERCALLBACKEXCEPTION</span></span> | <span data-ttu-id="7d2d1-433">此模式會攔截使用者回撥例外狀況，並允許應用程式繼續執行，而不需要處理例外狀況</span><span class="sxs-lookup"><span data-stu-id="7d2d1-433">This mode intercepts user call back exceptions and allows the app to continue on without having to handle the exception</span></span>                                          |
| <span data-ttu-id="7d2d1-434">VIRTUALIZEDELETE</span><span class="sxs-lookup"><span data-stu-id="7d2d1-434">VIRTUALIZEDELETE</span></span>             | <span data-ttu-id="7d2d1-435">此模式會攔截受保護檔案的刪除作業，並防止應用程式因為刪除作業發生未處理的例外狀況而失敗</span><span class="sxs-lookup"><span data-stu-id="7d2d1-435">This mode intercepts delete operations on protected files and prevents apps from failing due to unhandled exceptions from the delete operation</span></span>                   |
| <span data-ttu-id="7d2d1-436">WRPMITIGATION</span><span class="sxs-lookup"><span data-stu-id="7d2d1-436">WRPMITIGATION</span></span>                | <span data-ttu-id="7d2d1-437">當應用程式嘗試寫入、修改或刪除 Windows 受保護的檔案或登錄專案 (但未實際完成作業時，此模式會傳回成功) </span><span class="sxs-lookup"><span data-stu-id="7d2d1-437">This mode returns success when an app tries to write, modify, or delete Windows protected files or registry entries (without actually completing the operation)</span></span>  |
| <span data-ttu-id="7d2d1-438">DXMAXIMIZEDWINDOWEDMODE</span><span class="sxs-lookup"><span data-stu-id="7d2d1-438">DXMAXIMIZEDWINDOWEDMODE</span></span>      | <span data-ttu-id="7d2d1-439">此模式會識別進入全螢幕模式的應用程式，並將它們重新導向至最大化的視窗模式</span><span class="sxs-lookup"><span data-stu-id="7d2d1-439">This mode identifies apps that go into full screen mode and redirects them into a maximized Window mode</span></span>                                                          |
| <span data-ttu-id="7d2d1-440">HIGHDPIAWARE</span><span class="sxs-lookup"><span data-stu-id="7d2d1-440">HIGHDPIAWARE</span></span>                 | <span data-ttu-id="7d2d1-441">這種模式可讓其餘的 Windows 知道應用程式是高 DPI 感知，並且有助於適當地呈現 UI 元素、文字、字型等等。</span><span class="sxs-lookup"><span data-stu-id="7d2d1-441">This mode lets the rest of Windows know that the app is High DPI aware, and helps proper rendering of UI elements, text, font, etc.</span></span>                              |



 

 

 