---
title: Windows 8 的程式相容性助理案例
description: Windows 8 的程式相容性助理案例
ms.assetid: C61BF746-63EE-4F4E-81D3-52947FD4954D
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: d63fbd912e14ac682ffe820ad140b2cad6a487dfbac833aa419c53389a9339ad
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/11/2021
ms.locfileid: "117852538"
---
# <a name="program-compatibility-assistant-scenarios-for-windows-8"></a>Windows 8 的程式相容性助理案例

## <a name="platforms"></a>平台

**客戶** 端-Windows XP \| Windows Vista \| Windows 7 \| Windows 8  

## <a name="description"></a>描述

程式相容性助理 (PCA) 是 Windows 8 中的一項功能，可協助使用者執行專為舊版 Windows 版本所設計的桌面應用程式。 Windows 8 有絕佳的內建應用程式相容性，可讓專為 Windows 7 或更早版本 Windows 的應用程式自動在 Windows 8 上運作。 不過，有少數的應用程式在執行時可能會發生問題，而不需要介入。

當使用者執行應用程式時，PCA 會追蹤應用程式，並識別 Windows 8 中特定已知相容性問題的任何徵兆。 當它偵測到任何問題的徵兆時，它會讓使用者有機會套用建議的修正，以協助在 Windows 8 上執行更好的應用程式。

## <a name="scenarios"></a>案例

PCA 會追蹤 Windows 8 中已知相容性問題集的應用程式。 PCA 會追蹤問題、識別修正程式，並提供對話方塊給使用者，指示如何套用建議的修正。 使用者可以決定套用建議的修正，或選擇不執行任何動作，並取消建議。 如果使用者取消，PCA 將不會再追蹤該應用程式。

PCA 通常會套用三個 Windows 相容性模式的其中一種： Windows XP SP3、Windows Vista SP2 或 Windows 7，取決於程式 (或其安裝程式) 的編寫時間。 PCA 使用程式的連結 \_ 日期和子系統版本屬性，以及可執行檔資訊清單的 TRUSTINFO 與相容性章節，以判斷哪一種模式是相關的，並套用 Windows XP SP3 (包括系統管理許可權) 、Windows Vista SP2 或 Windows 7。 檔結尾的詞彙會列出 PCA 所套用的每個相容性模式及其描述。

針對下列所有案例，PCA 會在套用修正之後的第二次追蹤應用程式。 如果應用程式即使在套用相容性修正之後仍以相同的方式進行失敗，PCA 仍會還原修正。 PCA 接著會永久停止追蹤失敗的特定應用程式。

當 PCA 追蹤許多潛在的問題時，並非所有問題都會實際導致應用程式失敗。 PCA 建議只有在應用程式因為 Windows 相容性原因而發生問題很高的情況時，才會進行修正。 下列各節會在 Windows 8 中開發的每個 PCA 案例上展開。 每個章節都會說明問題案例和 PCA 提供的建議，以允許應用程式在 Windows 8 上繼續正常運作。

若要深入瞭解 Windows 8 中的相容性變更，請參閱 *Windows 8 相容性操作手冊* 中的其他主題。

PCA 追蹤和建議修正的案例如下：

-   應用程式無法安裝或卸載
-   應用程式無法使用 Windows 版本檢查訊息執行
-   應用程式因系統管理許可權而無法啟動
-   應用程式因為特定的記憶體問題而損毀
-   應用程式因系統檔案不相符而失敗
-   應用程式因64位的未處理錯誤而失敗 Windows
-   嘗試刪除受保護的非 Windows 檔案時，應用程式失敗
-   嘗試修改 Windows 檔案時，應用程式失敗
-   應用程式因使用8或16位色彩模式而失敗
-   應用程式因圖形和顯示器問題而失敗
-   應用程式無法宣告 DPI 感知
-   應用程式因缺少 Windows 功能而失敗
-   應用程式因64位的未簽署驅動程式而失敗 Windows 8
-   透過相容性設定來追蹤安裝的應用程式
-   應用程式無法啟動安裝程式或更新程式
-   需要以系統管理許可權執行的應用程式安裝程式
-   需要以系統管理許可權執行的舊版主控台 applet

以下是每個案例的擴充：

**應用程式無法安裝或卸載**

在應用程式安裝期間，最常見的應用程式失敗類型之一。 舊版安裝程式最常見的失敗方式有兩種：

-   安裝程式不知道 Windows 8 中 (UAC) 功能的使用者帳戶控制，因此，它可能不會以對受保護區域進行系統變更所需的完整許可權來執行 Windows 8
-   安裝程式會檢查 Windows 版本，並在版本高於預期的版本時封鎖本身

這些失敗狀況是安裝程式中最常見的兩種相容性失敗類型。 PCA 可協助不同的其他 Windows 元件（例如 UAC）在啟動時偵測安裝程式，並將其追蹤到安裝結束。 如果安裝程式無法新增檔案，或在 Windows 控制台的 [新增移除程式] 部分中新增有效的專案，PCA 會將安裝程式視為失敗。

在此情況下，PCA 建議適用于應用程式的相容性模式。 相容性模式可讓安裝程式在其所設計的 Windows 模式下執行，也可確保應用程式會以系統管理許可權執行。 PCA 會套用 RUNASADMIN 相容性模式，以及適當的 Windows XP、Windows Vista 或 Windows 7 相容性模式。 當使用者在安裝失敗時，將會看到含有 PCA 建議的對話方塊：

![應用程式無法安裝或卸載對話方塊](images/pcafigure1.png)

然後，使用者可以選擇：

-   使用相容性設定 (建議選項來執行程式) ，之後 PCA 會將建議的設定套用 (相容性模式) 、重新開機安裝程式，並在安裝程式成功完成之前追蹤
-   指出程式已正確安裝，在這種情況下，PCA 將不會新增任何設定，而且會停止追蹤安裝程式
-   按一下 [關閉]，在此情況下，PCA 將不會新增任何設定，而且會停止追蹤此設定

當使用者嘗試從 Windows 中的 [新增移除程式] 區段或從應用程式的卸載程式快捷方式卸載應用程式時，會使用相同的機制來協助應用程式卸載。

**應用程式無法使用 Windows 版本檢查訊息執行**

應用程式執行時間中的其中一個較常見的相容性失敗是因為 Windows 版本檢查。 許多應用程式在啟動時，請檢查 Windows 版本;如果它們無法辨識版本，即使應用程式可能已執行且沒有任何問題，它們仍會封鎖。

一般而言，這類檢查會與 PCA 追蹤的兩個條件相關聯：

應用程式會顯示警告使用者的訊息方塊。 範例如下：

![應用程式無法使用 windows 版本檢查訊息對話方塊來執行](images/pcafigure2.png)

-   應用程式會立即終止或當機

如果 PCA 針對應用程式識別這兩個條件，則會為使用者提供建議。 PCA 可讓使用者重新執行具有相容性設定的應用程式。 PCA 會根據應用程式套用適當的 Windows XP、Windows Vista 或 Windows 7 相容性模式。 如同在任何案例中，使用者可以將應用程式正確執行，或按一下 [關閉] 按鈕退出建議的設定。 提供的範例對話方塊如下所示：

![應用程式無法使用 windows 版本檢查訊息選項對話方塊來執行](images/pcafigure3.png)

**應用程式因系統管理許可權而無法啟動或執行**

有些應用程式需要系統管理許可權，才能執行和執行其功能。 不過，在 Windows 8 中，類似于 Windows 7 和 Windows Vista，應用程式預設會以較低許可權層級執行，因為 UAC。 針對 Windows Vista 和更新版本所設計的較新應用程式，通常會使用 EXE 資訊清單的 TRUSTINFO 區段來宣告其執行所需的許可權層級。 不過，較舊的應用程式通常會以兩種方式失敗：

-   應用程式會顯示訊息給使用者，指出它需要系統管理許可權，如下列範例所示：

![應用程式因系統管理許可權對話方塊啟動或執行失敗](images/pcafigure4a.png)

-   應用程式會立即終止或當機

如果 PCA 針對應用程式識別這兩個條件，則會為使用者提供建議。 PCA 可讓使用者以系統管理許可權重新執行應用程式 (PCA 會將 RUNASHIGHEST 相容性模式套用) 。 當應用程式重新執行時，使用者會收到 UAC 提示。 如同在任何情況下，使用者都可以選擇使用建議的設定重新執行，或按一下 [關閉] 退出建議的設定。 提供的範例對話方塊如下所示：

![因為系統管理許可權選項對話方塊，所以無法啟動或執行應用程式](images/pcafigure5.png)

**應用程式因為特定的記憶體問題而損毀**

某些應用程式由於已知的記憶體問題而損毀。 應用程式會從記憶體中取消參考 DLL，然後呼叫函式以在相同的 DLL 中執行程式碼。 這會導致應用程式立即損毀。 雖然這個問題不是因為 Windows 8 的相容性變更，但這是在各種應用程式中看到的較常見問題。 PCA 會追蹤此問題，讓使用者有機會更可靠地執行他們的應用程式。

針對這些應用程式，PCA 會自動以無訊息模式自動套用 PINDLL 相容性模式。 PCA 所叫用的相容性模式可防止應用程式釋放記憶體的 DLL。 因此，應用程式對 DLL 的函式呼叫將會運作，以防止應用程式損毀，並允許它繼續正常運作。

**應用程式因系統檔案不相符而失敗**

某些專為 Windows XP 和先前設計的應用程式，包含 Windows 系統 dll 及其安裝程式的複本。 安裝這類應用程式時，應用程式會在自己的資料夾中同時有 dll 的較舊複本，以及 Windows 系統資料夾中的最新 dll 版本。

在 Windows Vista 和更新版本上，這種情況可能會導致應用程式在嘗試載入本機 dll 時失敗，因為這個 dll 無法與其余的目前 Windows 系統 dll 搭配運作。 由於應用程式通常不會察覺到這個 DLL 的較新版本，因此無法正常運作。

當 PCA 偵測到 DLL 無法正確載入時，它會套用相容性設定，讓 Windows 從 Windows 系統資料夾載入最新版本的 dll，讓應用程式可以正常執行。

在應用程式第一次執行失敗的結束時，使用者會看到 PCA 對話方塊，通知其套用的設定，如下所示：

![應用程式因系統檔案不相符而失敗對話方塊](images/pcafigure6.png)

**應用程式因64位的未處理錯誤而失敗 Windows**

在64位版本的 Windows 8 上，訊息迴圈回呼機制已啟用新的例外狀況。 雖然此例外狀況是在 Windows 7 中首次引進，但不一定要處理此錯誤。 在 Windows 8 中，使用訊息迴圈的應用程式必須處理這個新的例外狀況。 如果沒有，則會損毀。 針對較舊的 Windows 版本所設計的應用程式可能不會察覺到這個例外狀況，因此可能無法 (例外狀況) 正確地處理此錯誤。

PCA 會偵測由於此未處理的錯誤而失敗的應用程式，並自動套用應用程式的 DISABLEUSERCALLBACKEXCEPTION 相容性模式。 在執行結束之後套用設定之後，使用者會收到如下的通知。 應用程式將會在下一次執行時取得模式，並且可以避免此錯誤。

![應用程式因64位 windows 對話方塊上發生未處理的錯誤而失敗](images/pcafigure7.png)

**嘗試刪除受保護的非 Windows 檔案時，應用程式失敗**

某些專為 Windows XP 和之前設計的應用程式會假設它們通常是以完整的系統管理許可權來執行。 在正常的應用程式行為的過程中，他們可能會嘗試在 [program files] 或 [Windows 資料夾]) 中刪除受保護的非 Windows 檔案 (。 當刪除作業失敗時，許多這類應用程式可能會損毀。

PCA 會偵測無法刪除受保護檔案和當機的應用程式，並為使用者提供建議。 PCA 可讓使用者重新執行具有相容性設定的應用程式。 如同在任何案例中，使用者可以將應用程式正確執行，或按一下 [關閉] 按鈕退出建議的設定。 在此情況下，PCA 會套用 VIRTUALIZEDELETE 相容性模式。 提供的範例對話方塊如下所示：

![應用程式在嘗試刪除受保護的非 windows 檔案對話方塊時失敗](images/pcafigure8.png)

**嘗試修改 Windows 檔案或登錄機碼時，應用程式失敗**

某些專為 Windows XP 和之前設計的應用程式會假設它們通常是以完整的系統管理許可權來執行。 在一般應用程式行為的過程中，他們可能會嘗試修改、刪除或寫入 Windows 受保護的檔案 (在 [program files] 或 [Windows 資料夾]) 或 Windows 所擁有的登錄機碼中。 當檔案或登錄機碼的任何寫入、刪除或修改作業失敗時，許多這類應用程式可能會損毀或失敗。

PCA 會偵測這些應用程式無法寫入受保護的 Windows 檔案或登錄機碼，並會在應用程式結束時提供對使用者的建議。 PCA 可讓使用者重新執行具有相容性設定的應用程式。 如同在任何案例中，使用者可以將應用程式正確執行，或按一下 [關閉] 按鈕退出建議的設定。 在此情況下，PCA 會套用 WRPMITIGATION 相容性模式。 提供的範例對話方塊如下所示：

![應用程式在嘗試修改 windows 檔案或登錄機碼對話方塊時失敗](images/pcafigure9.png)

**應用程式因使用8或16位色彩模式而失敗**

作為 Windows Store 應用程式的重創 Windows 8 的一部分，其中一項重要變更是桌面視窗管理員 (DWM) 現在只會在 Windows 8 中支援32位色彩。 現在會模擬較低的色彩模式。

許多專為 Windows XP 設計的繼承應用程式和遊戲，或在使用8位或16位色彩模式之前所設計。 由於不會有任何風險降低，因此這些應用程式可能無法在 Windows 8 上執行。 不過，當這些應用程式列舉或嘗試使用任何8位或16位色彩模式來顯示時，PCA 會立即找出問題以及 DWM 的協助，以確保應用程式可在模擬的色彩模式下正常運作。

請注意，這會在應用程式要求低色彩模式，且對使用者而言是透明的情況下發生。 使用者不需要重新開機應用程式就能降低此風險，因為一律需要此修正，以確保應用程式能夠正常運作。

**應用程式因圖形和顯示器問題而失敗**

因為桌面視窗管理員 (DWM) 一律會在 Windows 8 中開啟，所以如果應用程式使用混合模式圖形 api，某些較舊的 Windows XP 紀元應用程式可能會失敗，例如，使用 GDI 和 DirectX api 來繪製到螢幕 (大部分較舊的遊戲) ，並嘗試使用全螢幕模式：

-   DWM 會防止直接繪製至桌面，而遊戲或應用程式可能會失敗，或在桌面上繪製黑色畫面，且不會顯示任何圖形。
-   在這種情況下，當應用程式結束時，Windows 會偵測到應用程式或遊戲有全螢幕模式的問題，並套用 DXMAXIMIZEDWINDOWEDMODE 相容性模式，允許應用程式或遊戲以最大化的視窗模式執行，而非全螢幕模式
-   在執行結束之後套用設定之後，PCA 會通知使用者，如下所示：應用程式會在下一次執行時取得相容性模式，而且將能正常執行

![應用程式因圖形和顯示問題對話方塊而失敗](images/pcafigure10.png)

**應用程式無法宣告 DPI 感知**

當 Windows 和應用程式在高 DPI 模式下執行時，會發生其他許多繼承應用程式的另一個常見顯示問題，但應用程式不會透過其 EXE 資訊清單宣告其高 DPI 的認知。 由於這項設定不相符而可能發生的常見問題，會裁剪 UI 元素或文字和不正確的字型大小。 如需有關問題的詳細資訊，請參閱 [這裡](/previous-versions//dd464660(v=vs.85))的連結。

在這種情況下，Windows 會偵測到應用程式為高 DPI 感知，並在第一次執行結束時將 HIGHDPIAWARE 相容性模式套用至應用程式。 PCA 接著會通知使用者，如下所示：

![應用程式無法宣告 DPI 感知對話方塊](images/pcafigure11.png)

**應用程式因缺少 Windows 功能而失敗**

某些應用程式相依于 Windows Vista 之後移除的 Windows 功能。 當這些應用程式嘗試載入遺失的 Dll 或 COM 元件時，它們就無法運作。

PCA 會在應用程式嘗試載入缺少的 Windows 功能時偵測應用程式，並提供下載這些元件的建議，並在應用程式終止之後加以安裝。 使用者可以按一下 [線上取得說明] 以尋找替代選項，或下載並安裝該功能。 如有需要，使用者可以按一下 [關閉] 來選擇不執行任何動作。

![應用程式因為遺失 windows 功能對話方塊而失敗](images/pcafigure12.png)

**應用程式因64位的未簽署驅動程式而失敗 Windows 8**

64位 Windows 有 (SYS 檔案) 自 Windows Vista 起的必要數位簽章驅動程式。 不過，繼承應用程式是在發行 Windows Vista 隨附的驅動程式之前所設計，而這些驅動程式尚未經過數位簽署。 如果安裝這類未簽署的驅動程式，Windows 將不會載入它們。 在罕見的情況下，如果這類驅動程式標示為開機時間驅動程式，則可能會無法啟動 Windows。

某些較舊的應用程式會安裝未在64位 Windows 上簽署的驅動程式。 任何嘗試使用此驅動程式的裝置或應用程式可能會失敗或導致系統損毀。 為了避免這種情況，PCA 會在安裝未簽署的驅動程式時偵測應用程式，並停用它標示為開機時間驅動程式的驅動程式。

它也會指示使用者取得經過數位簽署的驅動程式，讓應用程式正常運作。 此訊息是因為安裝驅動程式，以及安裝應用程式的結果所顯示。 如果另一個應用程式安裝相同的驅動程式，該應用程式也會取得相同的訊息。

![應用程式因64位 windows 8 對話方塊上未簽署的驅動程式而失敗](images/pcafigure13.png)

**透過相容性設定來追蹤安裝的應用程式**

當安裝程式失敗時，PCA 會根據失敗的類型，協助安裝程式使用各種相容性模式。 當安裝程式成功使用相容性設定之後，PCA 將會追蹤安裝程式新增的快捷方式。 這樣做的目的是要追蹤已安裝的應用程式是否也需要套用到其安裝程式的相容性設定。

當使用者啟動這類應用程式時，PCA 會提示使用者詢問應用程式是否正常運作。 如果使用者回答「是」，PCA 會停止追蹤應用程式。 如果使用者回答「否」，則會套用套用至應用程式安裝程式的相同相容性模式，然後重新執行應用程式並套用相容性模式。

**應用程式無法啟動安裝程式或更新程式**

應用程式有時會啟動需要以系統管理員身分執行的副程式。 當應用程式嘗試啟動其更新程式軟體以檢查並安裝新的應用程式更新時，通常會發生這種情況。 當應用程式直接執行這類副程式時，副程式可能無法啟動，因為應用程式本身沒有系統管理許可權，或因為未正確地使用 UAC 資訊清單將副程式標示為提高許可權。

PCA 會追蹤這些錯誤，當主要應用程式關閉時，它會自動套用 ELE加值稅ECREATEPROCESS 相容性模式，以協助副程式正確執行。 當應用程式在後續執行時啟動子應用程式時，使用者會看到副程式的 UAC 對話方塊。

PCA 對話方塊的範例如下所示：

![應用程式無法啟動安裝程式或更新程式對話方塊](images/pcafigure14.png)

**需要以系統管理許可權執行的應用程式安裝程式**

Windows 桌面應用程式的安裝程式需要系統管理許可權，因為它們會將檔案、資料夾和登錄專案寫入受保護的系統區域。 Windows (uac) 具有偵測邏輯來識別安裝程式執行的時間，並會立即提示使用者透過 UAC 對話方塊提供系統管理許可權。 不過，在某些情況下，此邏輯將無法判斷應用程式確實是安裝程式，而且可能無法取得系統管理許可權。 這些通常是自訂的安裝程式，這些安裝程式不使用知名的安裝技術，例如 Windows Installer 或安裝盾牌。

在這種情況下，PCA 會偵測到安裝程式無法寫入其檔案。 如果安裝失敗，PCA 將提供套用相容性設定的建議。 如果使用者選擇按一下 [執行程式]，PCA 會套用 RUNASADMIN 相容性模式，然後重新執行安裝程式。 如果使用者選擇關閉，則不會套用任何設定。 範例 PCA 對話方塊如下所示：

![顯示需要以系統管理許可權執行的應用程式安裝程式之對話方塊範例的螢幕擷取畫面。](images/pcafigure15.png)

需要以系統管理許可權的控制台 applet 來執行的舊版主控台 applet 通常會變更系統設定，而且需要執行 ad 系統管理員的能力。 不過，在 Windows Vista 之前所撰寫的程式不會有 EXE 資訊清單，或沒有宣告所需許可權層級的 TRUSTINFO 區段。 執行這類 applet 時，PCA 會偵測到它們，並在第一次執行結束時，提供使用系統管理設定執行的建議。 如果使用者選擇按一下 [執行程式]，PCA 會套用 RUNASADMIN 相容性模式，然後重新執行安裝程式。 如果使用者選擇關閉，則不會套用任何設定。 範例 PCA 對話方塊如下所示：

![需要以系統管理許可權執行對話方塊的應用程式安裝程式](images/pcafigure16.png)

**透過使用者意見反應驗證建議的設定**

在每個案例的結尾 (使用建議的相容性) 設定來執行應用程式之後，PCA 會詢問使用者一個簡單的問題：

![透過使用者意見反應對話方塊驗證建議的設定](images/pcafigure17.png)

如果應用程式在相容性設定上運作或失敗，則使用者可以提供意見反應。 此資料將會以匿名方式傳送給 Microsoft。 這有助於確保這類修正程式可透過 Windows 更新程式內建在 Windows 8 中，如此一來，Windows 8 的未來使用者將不再遇到應用程式失敗，而 PCA 將不再需要追蹤應用程式的失敗狀況。

**追蹤沒有任何建議的問題**

基於相容性的原因，應用程式可能會以許多不同的方式失敗。 PCA 會追蹤比上述案例中所列出的更多相容性問題。 在這些情況下，問題的表現取決於應用程式。 這表示，有些應用程式會正常地處理這類問題，而其他應用程式則不會加以復原。 因此，在此情況下，當 PCA 仍在追蹤應用程式時，它不會提供修正的直接建議。

PCA 追蹤沒有建議設定或對話方塊的問題，包括下列應用程式：

-   具有非常短的執行時間–應用程式執行超過三秒
-   建立不具系統管理許可權的全域記憶體物件
-   啟動時)  (Win32 例外狀況
-   檢查系統管理許可權 (但可能不會失敗) 
-   使用 Windows Vista (淘汰的 Indeo 編解碼器) 
-   嘗試寫入或刪除受保護登錄位置（例如 HKLM）中的金鑰
-   啟動時損毀

**透過 [相容性] 索引標籤和相容性疑難排解員套用修正程式**

如先前所述，應用程式可能會因為各種不同的相容性原因而失敗。 並非所有這些都有明確的 PCA 建議，因為設定與應用程式相依。 不過，使用者可以移至相容性疑難排解員或 [相容性] 索引標籤，以套用某些常見的修正程式，以嘗試讓失敗的應用程式在 Windows 8 上正常運作。 在這種情況下，在套用修正程式之前和之後，PCA 仍會追蹤應用程式的相容性問題。 執行應用程式並套用修正之後，PCA 會詢問使用者是否已完成修正。 一旦使用者回答問題，資料就會透過遙測以匿名方式傳送至 Microsoft。 這項資料是由許多使用者收集，並經過分析，然後透過 Windows 更新，將合格的修正程式廣泛地散發給所有的 Windows 8 使用者。

**使用相容性疑難排解員**

相容性疑難排解員是 Windows 中的一項機制，可讓您診斷應用程式的問題，並套用建議的修正程式，讓它們正常運作。 只有當 PCA 不提供應用程式的任何建議時，才需要此項。

疑難排解員可讓使用者逐步解說和回答一組問題，並根據回復來套用一組修正程式，並允許使用者測試其應用程式並驗證修正。 經過驗證之後，就會將修正程式永久套用至應用程式，使其在 Windows 8 上的效果更好。

以下顯示疑難排解員 UI，供您參考：

![使用相容性疑難排解員對話方塊](images/pcafigure18.png)

您可以透過兩種方式來啟動相容性疑難排解員：

**從 [開始] 畫面：**

1.  類型：相容性疑難排解員
2.  在 [設定] 區段下，按一下 [執行針對舊版 Windows 執行的程式] 磚

  
**從應用程式圖格：**

1.  在開始畫面中，以滑鼠右鍵按一下應用程式磚
2.  按一下 [開啟檔案位置] (僅限桌面應用程式) 
3.  從 Explorer 功能區中，按一下 [應用程式] 索引標籤
4.  選擇 [疑難排解相容性]

  


**使用 [相容性] 索引標籤**

請注意，這僅適用于嘗試不同相容性設定之專家的使用者。 這個方法不會提供要套用至應用程式之修正類型的任何建議。 在此，使用者應該知道可以套用哪些修正程式才能讓應用程式運作。 如果您不確定修正問題，請使用相容性疑難排解員找出應用程式的修正程式。

若要存取 [相容性] 索引標籤：

 **從 [開始] 畫面：**

1.  以滑鼠右鍵按一下應用程式磚
2.  僅) 開啟檔案位置 (桌面應用程式

  
**從 [Explorer] 功能區：**

1.  按一下 [內容]
2.  流覽至 [相容性] 索引標籤
3.  選取相容性修正程式
4.  重新執行應用程式
    > [!Note]  
    > 您也可以再次回到相同位置，以變更或移除修正程式。 您也可以使用索引標籤中提供的按鈕，將修正程式套用到電腦上的所有使用者。

     

  


![使用 [相容性] 索引標籤](images/pcafigure19.png)

**已知相容性問題的應用程式**

除了上面所列的執行時間問題偵測案例之外，如果應用程式有已知的相容性問題，PCA 也會在應用程式啟動時通知使用者。 此清單會儲存在系統應用程式相容性資料庫中。 這些訊息有兩種類型：

-   **硬封鎖訊息**-如果已知應用程式不相容，而且如果允許應用程式執行，將會對系統造成嚴重的影響 (例如，Windows 損毀或在安裝) 之後無法開機，則會顯示如下所示的封鎖訊息

![具有已知相容性問題的應用程式-[硬封鎖訊息] 對話方塊](images/pcafigure20.png)

-   **軟封鎖訊息**-如果應用程式有已知的相容性問題，而且可能無法正常運作，則會顯示此訊息：

![具有已知相容性問題的應用程式-軟封鎖訊息對話方塊](images/pcafigure21.png)

在這兩種情況下，[取得線上協助] 選項都會傳送 Windows 錯誤報表，以取得 Microsoft 的線上回應並向使用者顯示。 回應通常會將使用者指向三種資源類型的其中一種：

-   應用程式廠商的更新
-   應用程式廠商的網站以取得詳細資訊
-   如需詳細資訊，請參閱 Microsoft 知識庫文章

**PCA 的遙測**

當 PCA 解決 Windows 8 機上的任何應用程式問題，並取得所有使用者意見反應之後，它會收集應用程式、安裝程式、偵測到的問題以及套用至應用程式的相容性設定的匿名資料，然後將其傳回給 Microsoft。 這項資料是從任何願意透過客戶經驗改進計畫-CEIP) 提供這類匿名資料 (的使用者進行收集。 收集這項資料之後，會分析應用程式失敗和修正程式，然後透過 Windows Update 機制將修正程式散發至整個 Windows 生態系統，讓應用程式在未來的任何使用者都能自動從修正中獲益。

**管理控制項和管理 PCA 設定**

IT 系統管理員可以透過兩種方式來控制 PCA 行為：

-   **關閉 pca** –此設定可讓 IT 系統管理員關閉 pca 向使用者顯示的對話方塊;PCA 仍會追蹤及偵測問題，並傳回遙測資料
-   關閉 **應用程式遙測**-這項設定將會依 PCA 關閉任何收集和傳送遙測資料
    > [!Note]  
    > 如果已關閉 CEIP，此設定不會有任何影響。

     

**設計應用程式以使用 PCA**

開發人員必須確保其應用程式在上述所有相容性案例中都能順利運作。 開發人員必須針對上述各案例測試及驗證其應用程式，並確保不會有任何相容性問題。 如果識別出相容性問題，開發人員應該對其應用程式進行修正，以確保相容性問題已解決。 開發人員應該進行的一些常見修正包括：

-   在安裝和執行時間消除作業系統版本檢查 Windows
-   排除許可權檢查 (檢查系統管理員存取權) ;使用 EXE 資訊清單來宣告所需的正確許可權層級
-   確定應用程式安裝程式中未隨附 Windows 二進位檔
-   消除寫入受保護區域 (登錄、資料夾) 或寫入受保護的檔案
-   以數位方式簽署所有二進位檔 (EXE、DLL、SYS 檔案) 
-   針對安裝程式，請確定已新增適當的 [新增/移除程式] 專案;此應用程式中繼資料專案至少應該包含應用程式名稱、發行者、版本字串和支援的語言。 這會向 PCA 指出安裝程式已順利完成，而且也會提供便利的方式讓使用者卸載應用程式

確定應用程式的 [TRUSTINFO] 和 [相容性] 區段已更新 Windows 8 相容性操作手冊中所列出的 (可執行檔) 資訊清單，可讓 PCA 知道應用程式是針對 Windows 8 所設計，而且也可確保應用程式一律以原生方式執行，而不會套用任何相容性模式。

為了確保 PCA 會將應用程式視為針對 Windows 8 所設計：

-   所有 Exe (安裝程式或執行時間) 都必須針對 Windows 8 的 TRUSTINFO 和相容性區段進行說明。
-   安裝程式應新增 [新增/移除程式] 專案

**詞彙**

PCA 所使用的相容性模式如下所示，其中包含模式所能啟用的簡短描述。



| [模式]                         | 描述                                                                                                                                                      |
|------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Windows7RTM                  | 此模式會模擬常見的 Windows 7 行為，包括作業系統版本號碼6。1                                                                   |
| WindowsVistaSP2              | 此模式會模擬常見的 Windows 7 行為，包括作業系統版本號碼6。1                                                                   |
| WindowsXPSp3                 | 此模式會模擬常見的 Windows XP SP3 行為，包括作業系統版本號碼5.1。 這也包含 RUNASHIGHEST 模式                    |
| RUNASHIGHEST                 | 此模式會提示使用者以最高的可用許可權來執行應用程式。 具有系統管理許可權的使用者將會看到應用程式的 UAC 提高許可權提示 |
| RUNASADMIN                   | 此模式一律會提示使用者以系統管理許可權執行應用程式;使用此模式的應用程式一律會取得 UAC 提高許可權提示                    |
| ELE加值稅ECREATEPROCESS         | 此模式會讓主要應用程式的子進程以系統管理許可權執行;子進程會取得 UAC 提高許可權對話方塊                          |
| PINDLL                       | 即使應用程式卸載 DLL，此模式仍會強制 DLL 位於應用程式的記憶體中                                                                                |
| DISABLEUSERCALLBACKEXCEPTION | 此模式會攔截使用者回撥例外狀況，並允許應用程式繼續執行，而不需要處理例外狀況                                          |
| VIRTUALIZEDELETE             | 此模式會攔截受保護檔案的刪除作業，並防止應用程式因為刪除作業發生未處理的例外狀況而失敗                   |
| WRPMITIGATION                | 當應用程式嘗試寫入、修改或刪除 Windows 受保護的檔案或登錄 (專案時，此模式會傳回成功，但不會實際完成作業)   |
| DXMAXIMIZEDWINDOWEDMODE      | 此模式會識別進入全螢幕模式的應用程式，並將它們重新導向至最大化的視窗模式                                                          |
| HIGHDPIAWARE                 | 這種模式可讓 Windows 的其餘部分知道應用程式是高 DPI 感知，並且有助於適當地呈現 UI 元素、文字、字型等等。                              |



 

 

 