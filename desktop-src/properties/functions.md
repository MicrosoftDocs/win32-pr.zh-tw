---
description: 本節說明 Windows 屬性系統函數。
ms.assetid: ce8336cd-d9aa-4b93-ab47-30edd7518dab
title: 函式 (Windows 屬性系統)
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 9239967f4c8c4bc13babf7281a5f72b80d843d25b03272d1a48d0568f484bad5
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/11/2021
ms.locfileid: "118970997"
---
# <a name="functions-windows-property-system"></a>函式 (Windows 屬性系統)

本節說明 Windows 屬性系統函數。



| 主題                                                                                                | 目錄                                                                                                                                                                                                                                                                                                                                                                                                     |
|------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [PROPVARIANT 和 VARIANT 函式](./functions-propvarutil.md)                                     | 本節說明一組搭配 [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant)和 [**VARIANT**](/windows/win32/api/oaidl/ns-oaidl-variant)類型使用的 Windows 屬性系統轉換和 helper 函數。                                                                                                                                                                                                          |
| [屬性包函數](property-bag-functions.md)                                                 | 本節說明一組與 [**IPropertyBag**](/windows/win32/api/oaidl/nn-oaidl-ipropertybag)物件搭配使用的 Windows helper 函數。                                                                                                                                                                                                                                                                             |
| [**PifMgr \_ CloseProperties**](/windows/desktop/api/Shlobj_core/nf-shlobj_core-pifmgr_closeproperties)                                            | 關閉使用 [**PifMgr \_ OpenProperties**](/windows/desktop/api/Shlobj_core/nf-shlobj_core-pifmgr_openproperties)開啟的應用程式屬性。<br/>                                                                                                                                                                                                                                                                                      |
| [**PifMgr \_ GetProperties**](/windows/desktop/api/Shlobj_core/nf-shlobj_core-pifmgr_getproperties)                                                | 從 pif 檔案傳回指定的資料區塊。<br/>                                                                                                                                                                                                                                                                                                                                               |
| [**PifMgr \_ OpenProperties**](/windows/desktop/api/Shlobj_core/nf-shlobj_core-pifmgr_openproperties)                                              | 開啟與 Microsoft MS-DOS 應用程式相關聯的 pif 檔案，並將控制碼傳回給應用程式的屬性。<br/>                                                                                                                                                                                                                                                                         |
| [**PifMgr \_ SetProperties**](/windows/desktop/api/Shlobj_core/nf-shlobj_core-pifmgr_setproperties)                                                | 從 pif 檔將值指派給資料區塊。<br/>                                                                                                                                                                                                                                                                                                                                               |
| [**PSCoerceToCanonicalValue**](/windows/win32/api/propsys/nf-propsys-pscoercetocanonicalvalue)                                       | 根據屬性描述，將屬性的值轉換為標準值。<br/>                                                                                                                                                                                                                                                                                                   |
| [**PSCreateAdapterFromPropertyStore**](/windows/win32/api/propsys/nf-propsys-pscreateadapterfrompropertystore)                       | 從 [**IPropertyStore**](/windows/win32/api/propsys/nn-propsys-ipropertystore)建立介面卡。<br/>                                                                                                                                                                                                                                                                                                                            |
| [**PSCreateDelayedMultiplexPropertyStore**](/windows/win32/api/propsys/nf-propsys-pscreatedelayedmultiplexpropertystore)             | 建立包含多個屬性存放區的唯讀、延遲系結屬性存放區。<br/>                                                                                                                                                                                                                                                                                                       |
| [**PSCreateMemoryPropertyStore**](/windows/win32/api/propsys/nf-propsys-pscreatememorypropertystore)                                 | 建立記憶體中的屬性存放區。<br/>                                                                                                                                                                                                                                                                                                                                                              |
| [**PSCreateMultiplexPropertyStore**](/windows/win32/api/propsys/nf-propsys-pscreatemultiplexpropertystore)                           | 建立包含多個屬性存放區的唯讀屬性存放區，其中每個都必須支援 [**IPropertyStore**](/windows/win32/api/propsys/nn-propsys-ipropertystore) 或 [**IPropertySetStorage**](/windows/win32/api/propidl/nn-propidl-ipropertysetstorage)。<br/>                                                                                                                                                                                    |
| [**PSCreatePropertyChangeArray**](/windows/win32/api/propsys/nf-propsys-pscreatepropertychangearray)                                 | 建立一組 [**IPropertyChange**](/windows/win32/api/propsys/nn-propsys-ipropertychange) 物件的容器。 此容器可與 [**IFileOperation**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifileoperation) 搭配使用，以將一組屬性變更套用到一組檔案。<br/>                                                                                                                                                                           |
| [**PSCreatePropertyStoreFromObject**](/windows/win32/api/propsys/nf-propsys-pscreatepropertystorefromobject)                         | 接受支援 [**IPropertyStore**](/windows/win32/api/propsys/nn-propsys-ipropertystore)或 [**IPropertySetStorage**](/windows/win32/api/propidl/nn-propidl-ipropertysetstorage)之物件的 [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown)介面。 如果物件支援 **IPropertySetStorage**，則會將它包裝成支援 **IPropertyStore**。<br/>                                                                                                             |
| [**PSCreatePropertyStoreFromPropertySetStorage**](/windows/win32/api/propsys/nf-propsys-pscreatepropertystorefrompropertysetstorage) | 在 [**IPropertyStore**](/windows/win32/api/propsys/nn-propsys-ipropertystore)介面中包裝 [**IPropertySetStorage**](/windows/win32/api/propidl/nn-propidl-ipropertysetstorage)介面。<br/>                                                                                                                                                                                                                                                                 |
| [**PSCreateSimplePropertyChange**](/windows/win32/api/propsys/nf-propsys-pscreatesimplepropertychange)                               | 建立簡單的屬性變更。<br/>                                                                                                                                                                                                                                                                                                                                                                 |
| [**PSEnumeratePropertyDescriptions**](/windows/win32/api/propsys/nf-propsys-psenumeratepropertydescriptions)                         | 呼叫架構子系統 [**IPropertySystem：： EnumeratePropertyDescriptions**](/windows/win32/api/propsys/nf-propsys-ipropertysystem-enumeratepropertydescriptions)的包裝函式 API。 此函式會抓取 [**IPropertyDescriptionList**](/windows/win32/api/propsys/nn-propsys-ipropertydescriptionlist)的子系統物件實例，以取得整個清單或系統中屬性描述的部分清單。<br/> |
| [**PSFormatForDisplay**](/windows/win32/api/propsys/nf-propsys-psformatfordisplay)                                                   | 取得 [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) 結構中所儲存之屬性值的格式化 Unicode 字串表示。 呼叫端負責配置輸出緩衝區。<br/>                                                                                                                                                                                                         |
| [**PSFormatForDisplayAlloc**](/windows/win32/api/propsys/nf-propsys-psformatfordisplayalloc)                                         | 取得 [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) 結構中所儲存之屬性值的格式化 Unicode 字串表示。 此函數會配置輸出字串的記憶體。<br/>                                                                                                                                                                                                               |
| [**PSFormatPropertyValue**](/windows/win32/api/propsys/nf-propsys-psformatpropertyvalue)                                             | 取得格式化的 Unicode 字串表示，屬性值儲存在屬性存放區中。 此函數會配置輸出字串的記憶體。<br/>                                                                                                                                                                                                                                             |
| [**PSGetImageReferenceForValue**](/windows/win32/api/propsys/nf-propsys-psgetimagereferenceforvalue)                                 | 取得指定之屬性的屬性描述介面實例。<br/>                                                                                                                                                                                                                                                                                                                    |
| [**PSGetItemPropertyHandler**](/windows/win32/api/propsys/nf-propsys-psgetitempropertyhandler)                                       | 抓取 Shell 專案的屬性處理常式。<br/>                                                                                                                                                                                                                                                                                                                                                    |
| [**PSGetItemPropertyHandlerWithCreateObject**](/windows/win32/api/propsys/nf-propsys-psgetitempropertyhandlerwithcreateobject)       | 抓取 Shell 專案的屬性處理常式。<br/>                                                                                                                                                                                                                                                                                                                                                    |
| [**PSGetNamedPropertyFromPropertyStorage**](/windows/win32/api/propsys/nf-propsys-psgetnamedpropertyfrompropertystorage)             | 依據屬性名稱取得序列化屬性儲存區中的值。<br/>                                                                                                                                                                                                                                                                                                                                   |
| [**PSGetNameFromPropertyKey**](/windows/win32/api/propsys/nf-propsys-psgetnamefrompropertykey)                                       | 根據給定的 [**PROPERTYKEY**](/windows/win32/api/wtypes/ns-wtypes-propertykey)，抓取屬性的正式名稱。<br/>                                                                                                                                                                                                                                                                                                     |
| [**PSGetPropertyDescription**](/windows/win32/api/propsys/nf-propsys-psgetpropertydescription)                                       | 針對 [**PROPERTYKEY**](/windows/win32/api/wtypes/ns-wtypes-propertykey) 結構所指定的屬性，取得屬性描述介面的實例。<br/>                                                                                                                                                                                                                                                                |
| [**PSGetPropertyDescriptionByName**](/windows/win32/api/propsys/nf-propsys-psgetpropertydescriptionbyname)                           | 取得指定之屬性名稱的屬性描述介面實例。<br/>                                                                                                                                                                                                                                                                                                               |
| [**PSGetPropertyDescriptionListFromString**](/windows/win32/api/propsys/nf-propsys-psgetpropertydescriptionlistfromstring)           | 取得指定之屬性清單的屬性描述清單介面實例。<br/>                                                                                                                                                                                                                                                                                                          |
| [**PSGetPropertyFromPropertyStorage**](/windows/win32/api/propsys/nf-propsys-psgetpropertyfrompropertystorage)                       | 取得儲存在序列化屬性儲存區中的屬性值。<br/>                                                                                                                                                                                                                                                                                                                            |
| [**PSGetPropertyKeyFromName**](/windows/win32/api/propsys/nf-propsys-psgetpropertykeyfromname)                                       | 取得標準屬性名稱的屬性索引鍵。<br/>                                                                                                                                                                                                                                                                                                                                              |
| [**PSGetPropertySystem**](/windows/win32/api/propsys/nf-propsys-psgetpropertysystem)                                                 | 取得執行 [**IPropertySystem**](/windows/win32/api/propsys/nn-propsys-ipropertysystem)之子系統物件的實例。<br/>                                                                                                                                                                                                                                                                                            |
| [**PSGetPropertyValue**](/windows/win32/api/propsys/nf-propsys-psgetpropertyvalue)                                                   | 從屬性存放區取得屬性值。<br/>                                                                                                                                                                                                                                                                                                                                                      |
| [**PSLookupPropertyHandlerCLSID**](/windows/win32/api/propsys/nf-propsys-pslookuppropertyhandlerclsid)                               | 取得每一電腦的已註冊檔案屬性處理常式 (CLSID) 的類別識別碼。<br/>                                                                                                                                                                                                                                                                                                            |
| [**PSPropertyBag \_ 刪除**](/windows/win32/api/propsys/nf-propsys-pspropertybag_delete)                                              | 從屬性包中刪除屬性。<br/>                                                                                                                                                                                                                                                                                                                                                           |
| [**PSPropertyBag \_ ReadBOOL**](/windows/win32/api/propsys/nf-propsys-pspropertybag_readbool)                                          | 讀取屬性包中屬性的 **BOOL** 資料值。<br/>                                                                                                                                                                                                                                                                                                                                    |
| [**PSPropertyBag \_ ReadBSTR**](/windows/win32/api/propsys/nf-propsys-pspropertybag_readbstr)                                          | 從屬性包中的屬性讀取 **BSTR** 資料值。<br/>                                                                                                                                                                                                                                                                                                                                    |
| [**PSPropertyBag \_ ReadDWORD**](/windows/win32/api/propsys/nf-propsys-pspropertybag_readdword)                                        | 從屬性包中的屬性讀取 **DWORD** 資料值。<br/>                                                                                                                                                                                                                                                                                                                                     |
| [**PSPropertyBag \_ ReadGUID**](/windows/win32/api/propsys/nf-propsys-pspropertybag_readguid)                                          | 從屬性包中的屬性讀取 GUID 資料值。<br/>                                                                                                                                                                                                                                                                                                                                      |
| [**PSPropertyBag \_ ReadInt**](/windows/win32/api/propsys/nf-propsys-pspropertybag_readint)                                            | 從屬性包中的屬性讀取 **int** 資料值。<br/>                                                                                                                                                                                                                                                                                                                                     |
| [**PSPropertyBag \_ ReadLONG**](/windows/win32/api/propsys/nf-propsys-pspropertybag_readlong)                                          | 從屬性包中的屬性讀取 **長** 資料值。<br/>                                                                                                                                                                                                                                                                                                                                    |
| [**PSPropertyBag \_ ReadPOINTL**](/windows/win32/api/propsys/nf-propsys-pspropertybag_readpointl)                                      | 抓取儲存在指定屬性包所包含之屬性中的座標。<br/>                                                                                                                                                                                                                                                                                                             |
| [**PSPropertyBag \_ ReadPOINTS**](/windows/win32/api/propsys/nf-propsys-pspropertybag_readpoints)                                      | 抓取儲存在指定屬性包所包含之屬性中的座標。<br/>                                                                                                                                                                                                                                                                                                             |
| [**PSPropertyBag \_ ReadPropertyKey**](/windows/win32/api/propsys/nf-propsys-pspropertybag_readpropertykey)                            | 讀取指定屬性包中屬性的屬性索引鍵。<br/>                                                                                                                                                                                                                                                                                                                                 |
| [**PSPropertyBag \_ ReadRECTL**](/windows/win32/api/propsys/nf-propsys-pspropertybag_readrectl)                                        | 抓取儲存在指定屬性包所包含之屬性中的矩形座標。<br/>                                                                                                                                                                                                                                                                                              |
| [**PSPropertyBag \_ ReadSHORT**](/windows/win32/api/propsys/nf-propsys-pspropertybag_readshort)                                        | 讀取屬性包中屬性的 **簡短** 資料值。<br/>                                                                                                                                                                                                                                                                                                                                   |
| [**PSPropertyBag \_ ReadStr**](/windows/win32/api/propsys/nf-propsys-pspropertybag_readstr)                                            | 讀取屬性包中屬性的字串資料值。<br/>                                                                                                                                                                                                                                                                                                                                      |
| [**PSPropertyBag \_ ReadStrAlloc**](/windows/win32/api/propsys/nf-propsys-pspropertybag_readstralloc)                                  | 針對儲存在指定屬性包所包含的屬性中的字串，取得記憶體配置或釋放記憶體的詳細資料。<br/>                                                                                                                                                                                                                                                    |
| [**PSPropertyBag \_ ReadStream**](/windows/win32/api/propsys/nf-propsys-pspropertybag_readstream)                                      | 讀取儲存在指定屬性包中所包含之指定屬性的資料流程。<br/>                                                                                                                                                                                                                                                                                                           |
| [**PSPropertyBag \_ ReadType**](/windows/win32/api/propsys/nf-propsys-pspropertybag_readtype)                                          | 讀取屬性包中所儲存之屬性的資料數值型別。<br/>                                                                                                                                                                                                                                                                                                                      |
| [**PSPropertyBag \_ ReadULONGLONG**](/windows/win32/api/propsys/nf-propsys-pspropertybag_readulonglong)                                | 從屬性包中的屬性讀取 **ULONGLONG** 資料值。<br/>                                                                                                                                                                                                                                                                                                                               |
| [**PSPropertyBag \_ ReadUnknown**](/windows/win32/api/propsys/nf-propsys-pspropertybag_readunknown)                                    | 讀取屬性包中未知資料值的指定屬性。<br/>                                                                                                                                                                                                                                                                                                                                |
| [**PSPropertyBag \_ WriteBOOL**](/windows/win32/api/propsys/nf-propsys-pspropertybag_writebool)                                        | 設定屬性包中屬性的 **布林** 值。<br/>                                                                                                                                                                                                                                                                                                                                          |
| [**PSPropertyBag \_ WriteBSTR**](/windows/win32/api/propsys/nf-propsys-pspropertybag_writebstr)                                        | 設定屬性包中屬性的 **BSTR** 值。<br/>                                                                                                                                                                                                                                                                                                                                          |
| [**PSPropertyBag \_ WriteDWORD**](/windows/win32/api/propsys/nf-propsys-pspropertybag_writedword)                                      | 設定屬性包中屬性的 **DWORD** 值。<br/>                                                                                                                                                                                                                                                                                                                                         |
| [**PSPropertyBag \_ WriteGUID**](/windows/win32/api/propsys/nf-propsys-pspropertybag_writeguid)                                        | 設定屬性包中屬性的 GUID 值。<br/>                                                                                                                                                                                                                                                                                                                                              |
| [**PSPropertyBag \_ WriteInt**](/windows/win32/api/propsys/nf-propsys-pspropertybag_writeint)                                          | 設定屬性包中屬性的 **int** 值。<br/>                                                                                                                                                                                                                                                                                                                                           |
| [**PSPropertyBag \_ WriteLONG**](/windows/win32/api/propsys/nf-propsys-pspropertybag_writelong)                                        | 設定屬性包中屬性的 **完整** 值。<br/>                                                                                                                                                                                                                                                                                                                                          |
| [**PSPropertyBag \_ WritePOINTL**](/windows/win32/api/propsys/nf-propsys-pspropertybag_writepointl)                                    | 在屬性包的屬性中儲存點的座標。<br/>                                                                                                                                                                                                                                                                                                                                |
| [**PSPropertyBag \_ WritePOINTS**](/windows/win32/api/propsys/nf-propsys-pspropertybag_writepoints)                                    | 在屬性包的屬性中儲存點的座標。<br/>                                                                                                                                                                                                                                                                                                                                |
| [**PSPropertyBag \_ WritePropertyKey**](/windows/win32/api/propsys/nf-propsys-pspropertybag_writepropertykey)                          | 設定屬性包中屬性的屬性索引鍵值。<br/>                                                                                                                                                                                                                                                                                                                                      |
| [**PSPropertyBag \_ WriteRECTL**](/windows/win32/api/propsys/nf-propsys-pspropertybag_writerectl)                                      | 將矩形的座標儲存在屬性包的屬性中。<br/>                                                                                                                                                                                                                                                                                                                            |
| [**PSPropertyBag \_ WriteSHORT**](/windows/win32/api/propsys/nf-propsys-pspropertybag_writeshort)                                      | 設定屬性包中屬性的 **簡短** 值。<br/>                                                                                                                                                                                                                                                                                                                                         |
| [**PSPropertyBag \_ WriteStr**](/windows/win32/api/propsys/nf-propsys-pspropertybag_writestr)                                          | 設定屬性包中屬性的字串值。<br/>                                                                                                                                                                                                                                                                                                                                            |
| [**PSPropertyBag \_ WriteStream**](/windows/win32/api/propsys/nf-propsys-pspropertybag_writestream)                                    | 將資料流程寫入屬性包中的屬性。<br/>                                                                                                                                                                                                                                                                                                                                             |
| [**PSPropertyBag \_ WriteULONGLONG**](/windows/win32/api/propsys/nf-propsys-pspropertybag_writeulonglong)                              | 設定屬性包中屬性的 **ULONGLONG** 值。<br/>                                                                                                                                                                                                                                                                                                                                     |
| [**PSPropertyBag \_ WriteUnknown**](/windows/win32/api/propsys/nf-propsys-pspropertybag_writeunknown)                                  | 讀取屬性包中未知資料值的屬性。 <br/>                                                                                                                                                                                                                                                                                                                                     |
| [**PSPropertyKeyFromString**](/windows/win32/api/propsys/nf-propsys-pspropertykeyfromstring)                                         | 將字串轉換成 [**PROPERTYKEY**](/windows/win32/api/wtypes/ns-wtypes-propertykey) 結構。<br/>                                                                                                                                                                                                                                                                                                                            |
| [**PSRefreshPropertySchema**](/windows/win32/api/propsys/nf-propsys-psrefreshpropertyschema)                                         | 目前不支援。<br/>                                                                                                                                                                                                                                                                                                                                                                          |
| [**PSRegisterPropertySchema**](/windows/win32/api/propsys/nf-propsys-psregisterpropertyschema)                                       | 告知架構子系統加入屬性描述架構檔案的程式。<br/>                                                                                                                                                                                                                                                                                                               |
| [**PSSetPropertyValue**](/windows/win32/api/propsys/nf-propsys-pssetpropertyvalue)                                                   | 設定屬性存放區中的屬性值。<br/>                                                                                                                                                                                                                                                                                                                                                 |
| [**PSStringFromPropertyKey**](/windows/win32/api/propsys/nf-propsys-psstringfrompropertykey)                                         | 建立從該屬性的索引鍵識別屬性的字串。<br/>                                                                                                                                                                                                                                                                                                                             |
| [**PSUnregisterPropertySchema**](/windows/win32/api/propsys/nf-propsys-psunregisterpropertyschema)                                   | 告知刪除屬性描述架構檔案的架構子系統。<br/>                                                                                                                                                                                                                                                                                                                |
| [**SHAddDefaultPropertiesByExt**](/windows/desktop/api/Shobjidl/nf-shobjidl-shadddefaultpropertiesbyext)                                   | 將預設屬性新增至屬性存放區，以註冊指定的副檔名。<br/>                                                                                                                                                                                                                                                                                                     |
| [**SHGetPropertyStoreForWindow**](/windows/desktop/api/Shellapi/nf-shellapi-shgetpropertystoreforwindow)                                   | 抓取物件，該物件表示特定視窗的屬性集合，這些屬性可讓您查詢或設定這些屬性。<br/>                                                                                                                                                                                                                                                             |
| [**SHGetPropertyStoreFromIDList**](/windows/desktop/api/Shobjidl_core/nf-shobjidl_core-shgetpropertystorefromidlist)                                 | 從 (PIDL) 之專案識別碼清單的指標，抓取支援 [**IPropertyStore**](/windows/win32/api/propsys/nn-propsys-ipropertystore) 或相關介面的物件。<br/>                                                                                                                                                                                                                                              |
| [**SHGetPropertyStoreFromParsingName**](/windows/desktop/api/Shobjidl_core/nf-shobjidl_core-shgetpropertystorefromparsingname)                       | 指定路徑或剖析名稱時，傳回專案的屬性存放區。<br/>                                                                                                                                                                                                                                                                                                                               |
| [**SHPropStgCreate**](/windows/desktop/api/Shlobj_core/nf-shlobj_core-shpropstgcreate)                                                           | 確保針對要求的屬性集作業適當地處理字碼頁抓取或指派。<br/>                                                                                                                                                                                                                                                                                            |
| [**SHPropStgReadMultiple**](/windows/desktop/api/Shlobj_core/nf-shlobj_core-shpropstgreadmultiple)                                               | 包裝 [**IPropertyStorage：： ReadMultiple**](/windows/win32/api/propidlbase/nf-propidlbase-ipropertystorage-readmultiple) 函式，以確保正確處理已被取代之屬性集的 ANSI 和 Unicode 翻譯。<br/>                                                                                                                                                                                                        |
| [**SHPropStgWriteMultiple**](/windows/desktop/api/Shlobj_core/nf-shlobj_core-shpropstgwritemultiple)                                             | 包裝 [**IPropertyStorage：： WriteMultiple**](/windows/win32/api/propidlbase/nf-propidlbase-ipropertystorage-writemultiple) 函式，以確保正確處理已被取代之屬性集的 ANSI 和 Unicode 翻譯。<br/>                                                                                                                                                                                                      |



 

## <a name="related-topics"></a>相關主題

<dl> <dt>

[Windows 屬性](props.md)
</dt> <dt>

[屬性描述架構](property-description-schema.md)
</dt> <dt>

[屬性集](property-sets.md)
</dt> <dt>

[介面](interfaces.md)
</dt> <dt>

[結構](structures.md)
</dt> <dt>

[常數、列舉和旗標](constants--enumerations--and-flags.md)
</dt> </dl>

 

 
