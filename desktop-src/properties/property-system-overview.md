---
description: Windows 屬性系統是資料定義的可擴充讀取/寫入系統，可提供統一的方式來表示 Shell 專案的中繼資料。
ms.assetid: eb2dc2be-fc53-40aa-81f6-f353ab1d3a57
title: 屬性系統概觀
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: dab3a17eacdbaa9a5d0255004ba544b7c3f7ff2b
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/07/2021
ms.locfileid: "106977838"
---
# <a name="property-system-overview"></a><span data-ttu-id="41b1a-103">屬性系統概觀</span><span class="sxs-lookup"><span data-stu-id="41b1a-103">Property System Overview</span></span>

<span data-ttu-id="41b1a-104">Windows 屬性系統是資料定義的可擴充讀取/寫入系統，可提供統一的方式來表示 Shell 專案的中繼資料。</span><span class="sxs-lookup"><span data-stu-id="41b1a-104">The Windows Property System is an extensible read/write system of data definitions that provides a uniform way of expressing metadata about Shell items.</span></span> <span data-ttu-id="41b1a-105">Windows Vista 和更新版本中的 Windows 屬性系統可讓您儲存和取得 Shell 專案的中繼資料。</span><span class="sxs-lookup"><span data-stu-id="41b1a-105">The Windows Property system in Windows Vista and later enables you to store and retrieve metadata for Shell items.</span></span> <span data-ttu-id="41b1a-106">Shell 專案是任何一段內容，例如檔案、資料夾、電子郵件或連絡人。</span><span class="sxs-lookup"><span data-stu-id="41b1a-106">A Shell item is any single piece of content, such as a file, folder, email, or contact.</span></span> <span data-ttu-id="41b1a-107">屬性是與 Shell 專案相關聯之中繼資料的個別部分。</span><span class="sxs-lookup"><span data-stu-id="41b1a-107">A property is an individual piece of metadata associated with a Shell item.</span></span> <span data-ttu-id="41b1a-108">屬性值會以 [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) 結構表示。</span><span class="sxs-lookup"><span data-stu-id="41b1a-108">Property values are expressed as a [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) structure.</span></span>

<span data-ttu-id="41b1a-109">本主題的組織方式如下：</span><span class="sxs-lookup"><span data-stu-id="41b1a-109">This topic is organized as follows:</span></span>

-   [<span data-ttu-id="41b1a-110">簡介</span><span class="sxs-lookup"><span data-stu-id="41b1a-110">Introduction</span></span>](#introduction)
-   [<span data-ttu-id="41b1a-111">開發案例</span><span class="sxs-lookup"><span data-stu-id="41b1a-111">Development Scenarios</span></span>](#development-scenarios)
-   [<span data-ttu-id="41b1a-112">屬性和 Windows Search</span><span class="sxs-lookup"><span data-stu-id="41b1a-112">Properties and Windows Search</span></span>](#properties-and-windows-search)
-   [<span data-ttu-id="41b1a-113">實施者注意事項</span><span class="sxs-lookup"><span data-stu-id="41b1a-113">Note to Implementers</span></span>](#note-to-implementers)
-   [<span data-ttu-id="41b1a-114">Windows 屬性系統檔</span><span class="sxs-lookup"><span data-stu-id="41b1a-114">Windows Property System Documentation</span></span>](#windows-property-system-documentation)
-   [<span data-ttu-id="41b1a-115">其他資源</span><span class="sxs-lookup"><span data-stu-id="41b1a-115">Additional Resources</span></span>](#additional-resources)
-   [<span data-ttu-id="41b1a-116">相關主題</span><span class="sxs-lookup"><span data-stu-id="41b1a-116">Related topics</span></span>](#related-topics)

## <a name="introduction"></a><span data-ttu-id="41b1a-117">簡介</span><span class="sxs-lookup"><span data-stu-id="41b1a-117">Introduction</span></span>

<span data-ttu-id="41b1a-118">屬性是由其正式名稱唯一識別 (例如 `System.Document.LastAuthor`) 和屬性索引鍵 (例如 `PKEY_Document_LastAuthor`) 。</span><span class="sxs-lookup"><span data-stu-id="41b1a-118">Properties are uniquely identified by their canonical name (such as `System.Document.LastAuthor`) and property key (such as `PKEY_Document_LastAuthor`).</span></span> <span data-ttu-id="41b1a-119">屬性索引鍵 (PKEY) 是名稱/值組的名稱部分，其包含 PKEY/PROPVARIANT 或字串/PROPVARIANT，其中字串是 PKEY (的正式名稱，例如 `System.Document.LastAuthor`) 。</span><span class="sxs-lookup"><span data-stu-id="41b1a-119">A property key (PKEY) is the name portion of a name-value pair that consists of a PKEY/PROPVARIANT or a string/PROPVARIANT, where the string is the canonical name of the PKEY (such as `System.Document.LastAuthor`).</span></span> <span data-ttu-id="41b1a-120">PKEY 是一種定義，可告知屬性系統它需要知道屬性的所有專案，而值則是屬性的實際實例。</span><span class="sxs-lookup"><span data-stu-id="41b1a-120">A PKEY is a definition that tells the property system everything it needs to know about the property, whereas the value is an actual instance of the property.</span></span> <span data-ttu-id="41b1a-121">PKEY 內部包含 formatID 和 propID。</span><span class="sxs-lookup"><span data-stu-id="41b1a-121">A PKEY internally contains a formatID and propID.</span></span>

<span data-ttu-id="41b1a-122">個別屬性包含下列三個部分：</span><span class="sxs-lookup"><span data-stu-id="41b1a-122">An individual property consists of the following three pieces:</span></span>

-   <span data-ttu-id="41b1a-123">標準名稱，例如 `System.Music.Artist` 。</span><span class="sxs-lookup"><span data-stu-id="41b1a-123">A canonical name, such as `System.Music.Artist`.</span></span>
-   <span data-ttu-id="41b1a-124">架構描述（以 propdesc XML 檔案格式指定），並以程式設計方式透過 [**IPropertyDescription**](/windows/desktop/api/Propsys/nn-propsys-ipropertydescription)表示。</span><span class="sxs-lookup"><span data-stu-id="41b1a-124">A schema description, which is specified in the .propdesc XML file format and expressed programmatically through [**IPropertyDescription**](/windows/desktop/api/Propsys/nn-propsys-ipropertydescription).</span></span>
-   <span data-ttu-id="41b1a-125">值，例如 singer 的名稱。</span><span class="sxs-lookup"><span data-stu-id="41b1a-125">A value, such as the name of a singer.</span></span>

<span data-ttu-id="41b1a-126">架構描述包含屬性的相關資訊，例如屬性名稱、資料類型、條件約束、屬性如何與視圖和搜尋系統互動的相關資訊等等。</span><span class="sxs-lookup"><span data-stu-id="41b1a-126">The schema description consists of information about the property, such as the property name, data type, constraints, information on how the property interacts with views and the search system, and so forth.</span></span> <span data-ttu-id="41b1a-127">名稱和架構描述是全域定義的，而且所有專案和類型都相同。</span><span class="sxs-lookup"><span data-stu-id="41b1a-127">The name and schema description are defined globally, and are the same for all items and types.</span></span> <span data-ttu-id="41b1a-128">值是個別專案的特定值。</span><span class="sxs-lookup"><span data-stu-id="41b1a-128">A value is specific to an individual item.</span></span> <span data-ttu-id="41b1a-129">也就是說， `System.Music.Artist` 屬性一律定義為多重值字串，但可能會有不同的值 (或每個專案的所有) 都沒有值。</span><span class="sxs-lookup"><span data-stu-id="41b1a-129">That is, the `System.Music.Artist` property is always defined as a multi-value string, but may have a different value (or no value at all) for each item.</span></span>

<span data-ttu-id="41b1a-130">屬性處理常式會將儲存在檔案中的資料轉譯成可辨識的結構化架構，並且可由 Windows 檔案總管、Windows Search 和其他應用程式存取。</span><span class="sxs-lookup"><span data-stu-id="41b1a-130">A property handler translates data stored in a file into a structured schema that is recognized by and can be accessed by Windows Explorer, Windows Search, and other applications.</span></span> <span data-ttu-id="41b1a-131">這些系統接著可以與屬性處理常式互動，以在檔案中寫入和讀取屬性。</span><span class="sxs-lookup"><span data-stu-id="41b1a-131">These systems can then interact with the property handler to write and read properties to and from the file.</span></span> <span data-ttu-id="41b1a-132">轉譯的資料會以程式設計方式公開，並透過 Windows 檔案總管在各種內容中顯示，包括詳細資料檢視、提示、詳細資料窗格、屬性頁等等。</span><span class="sxs-lookup"><span data-stu-id="41b1a-132">The translated data is exposed programmatically and shown to the user through Windows Explorer in a variety of contexts including details view, infotips, details pane, property pages, and so forth.</span></span> <span data-ttu-id="41b1a-133">每個屬性處理常式都與特定檔案類型相關聯，該檔案類型是由副檔名來識別。</span><span class="sxs-lookup"><span data-stu-id="41b1a-133">Each property handler is associated with a particular file type, which is identified by the file name extension.</span></span> <span data-ttu-id="41b1a-134">開發人員應該採用產生和取用其檔案類型原生格式（例如 .jpg 或 .png）的屬性處理常式，或使用 In-Memory 屬性儲存區，它會產生和取用 MS PROPSTORE 二進位格式。</span><span class="sxs-lookup"><span data-stu-id="41b1a-134">Developers should implement a property handler that produces and consumes their file type's native format, such as .jpg or .png, or use the In-Memory Property Store, which produces and consumes the MS-PROPSTORE binary format.</span></span>

<span data-ttu-id="41b1a-135">Windows 屬性系統會建立從個別檔案格式提供抽象層級的抽象資料模型。</span><span class="sxs-lookup"><span data-stu-id="41b1a-135">The Windows Property System creates an abstract data model that provides a level of abstraction from individual file formats.</span></span> <span data-ttu-id="41b1a-136">Windows 屬性系統所提供的抽象資料模型是一種方法，用來讀取和寫入與 Shell 專案相關聯之可延伸的命名值集。</span><span class="sxs-lookup"><span data-stu-id="41b1a-136">The abstract data model provided by the Windows Property System is a method for reading and writing an extensible set of named values that are associated with a Shell item.</span></span> <span data-ttu-id="41b1a-137">值運算式具有彈性，可支援許多資料類型，而且可延伸，可讓任意資料 (**VT \_ BLOB**) 和物件以值表示。</span><span class="sxs-lookup"><span data-stu-id="41b1a-137">The value expression is flexible, supporting many data types, and is extensible, enabling arbitrary data (**VT\_BLOB**) and objects to be expressed as a value.</span></span>

<span data-ttu-id="41b1a-138">由於抽象概念，您可以查詢任何專案的屬性或中繼資料。</span><span class="sxs-lookup"><span data-stu-id="41b1a-138">Due to the abstraction, you can query the attributes or metadata of any item.</span></span> <span data-ttu-id="41b1a-139">可以抽象化的專案範例包括 Microsoft Office 檔、ID3 標記、AutoCAD 和其他協力廠商專屬軟體。</span><span class="sxs-lookup"><span data-stu-id="41b1a-139">Examples of items that can be abstracted include Microsoft Office documents, ID3 tags, and AutoCAD and other third-party proprietary software.</span></span> <span data-ttu-id="41b1a-140">同樣地，如果您有一個 jpeg 檔案，您可以使用 jpeg 和 EXIF 編解碼器來讀取檔案的位元組，以找出影像的維度。</span><span class="sxs-lookup"><span data-stu-id="41b1a-140">Similarly, if you have a .jpeg file, you can use the .jpeg and EXIF codecs to read the bytes of the file to discover what the dimensions of the image are.</span></span> <span data-ttu-id="41b1a-141">如果您改為使用 .png 檔案，則需要不同的編解碼器和不同的程式碼。</span><span class="sxs-lookup"><span data-stu-id="41b1a-141">If you have a .png file instead, you need a different codec and different code to do so.</span></span> <span data-ttu-id="41b1a-142">使用 Windows 屬性系統可避免這類問題。</span><span class="sxs-lookup"><span data-stu-id="41b1a-142">Using the Windows Property System avoids this sort of problem.</span></span> <span data-ttu-id="41b1a-143">如果您要執行新的檔案類型，您可以選擇插入 Windows 屬性系統所提供的統一抽象概念，並指定如何讓您的中繼資料可供使用。</span><span class="sxs-lookup"><span data-stu-id="41b1a-143">If you implement a new file type, you have the option to plug into the uniform abstraction offered by the Windows Property System and specify how to make your metadata consumable.</span></span> <span data-ttu-id="41b1a-144">基於這些理由，最好是使用 Windows 屬性系統所提供的通用平臺。</span><span class="sxs-lookup"><span data-stu-id="41b1a-144">For these reasons, it is always preferable to use the common platform provided by the Windows Property System.</span></span>

## <a name="development-scenarios"></a><span data-ttu-id="41b1a-145">開發案例</span><span class="sxs-lookup"><span data-stu-id="41b1a-145">Development Scenarios</span></span>

<span data-ttu-id="41b1a-146">屬性是由生產者和取用者表示。</span><span class="sxs-lookup"><span data-stu-id="41b1a-146">Properties are expressed by producers and by consumers.</span></span> <span data-ttu-id="41b1a-147">在此內容中，生產者是 Windows 屬性系統中的屬性發明者之一該項，而取用者是應用程式 (和其開發人員) 取用此系統中的屬性資訊。</span><span class="sxs-lookup"><span data-stu-id="41b1a-147">In this context, producers are the inventors of properties in the Windows Property System and consumers are applications (and their developers) that consume property information from this system.</span></span> <span data-ttu-id="41b1a-148">下表指出 Windows 屬性系統中的和參與者的用法。</span><span class="sxs-lookup"><span data-stu-id="41b1a-148">Uses of and participants in the Windows Property System are identified in the following table.</span></span>



| <span data-ttu-id="41b1a-149">使用 Windows 屬性系統</span><span class="sxs-lookup"><span data-stu-id="41b1a-149">Use of the Windows Property System</span></span>                                                                                                                                                                                            | <span data-ttu-id="41b1a-150">參與者</span><span class="sxs-lookup"><span data-stu-id="41b1a-150">Participant</span></span> |
|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------|
| <span data-ttu-id="41b1a-151">一個建立區塊，可提供屬性描述的可延伸登錄、記憶體內部屬性存放區的執行，以及用來系結至屬性處理常式、轉換型別和序列化屬性存放區的服務。</span><span class="sxs-lookup"><span data-stu-id="41b1a-151">A building block that provides an extensible registry of property descriptions, an in-memory property store implementation, and services for binding to property handlers, converting types, and serializing property stores.</span></span> | <span data-ttu-id="41b1a-152">消費者</span><span class="sxs-lookup"><span data-stu-id="41b1a-152">Consumer</span></span>    |
| <span data-ttu-id="41b1a-153">想要以抽象的方式讀取和寫入屬性的應用程式。</span><span class="sxs-lookup"><span data-stu-id="41b1a-153">Applications that want to read and write properties in an abstract way.</span></span>                                                                                                                                                       | <span data-ttu-id="41b1a-154">消費者</span><span class="sxs-lookup"><span data-stu-id="41b1a-154">Consumer</span></span>    |
| <span data-ttu-id="41b1a-155">屬性發明者之一該項，定義自訂屬性架構並開發自己的屬性處理常式，藉此定義屬性系統的新屬性。</span><span class="sxs-lookup"><span data-stu-id="41b1a-155">Property inventors who define new properties for the property system by defining custom property schemas and developing their own property handlers.</span></span>                                                                          | <span data-ttu-id="41b1a-156">產生器 (producer)</span><span class="sxs-lookup"><span data-stu-id="41b1a-156">Producer</span></span>    |
| <span data-ttu-id="41b1a-157">檔案格式擁有者，想要啟用其自訂檔案格式所儲存之屬性的存取權。</span><span class="sxs-lookup"><span data-stu-id="41b1a-157">File format owners who want to enable access to the properties stored in their custom file formats.</span></span>                                                                                                                           | <span data-ttu-id="41b1a-158">產生器 (producer)</span><span class="sxs-lookup"><span data-stu-id="41b1a-158">Producer</span></span>    |



 

<span data-ttu-id="41b1a-159">取用者會使用現有的屬性、架構和屬性處理常式。</span><span class="sxs-lookup"><span data-stu-id="41b1a-159">Consumers consume existing properties, schemas, and property handlers.</span></span> <span data-ttu-id="41b1a-160">可用的屬性包括支援的檔案類型的屬性處理常式的讀取/寫入屬性，也可能包含一些自訂屬性。</span><span class="sxs-lookup"><span data-stu-id="41b1a-160">Properties available for consumption include read/write properties from property handlers for supported file types and may also include some custom properties.</span></span> <span data-ttu-id="41b1a-161">可用的架構也包含至少系統架構，有時也包含其他架構。</span><span class="sxs-lookup"><span data-stu-id="41b1a-161">Available schemas include at least the system schema, and sometimes others, too.</span></span> <span data-ttu-id="41b1a-162">取用者可以建立應用程式來取用中繼資料，並根據演出者建立視圖，而不論專案儲存在哪些資料夾中。</span><span class="sxs-lookup"><span data-stu-id="41b1a-162">A consumer can create an application to consume metadata and build a view based on artist, regardless of what folders the items are stored in.</span></span> <span data-ttu-id="41b1a-163">檔案資料夾階層是不相關的。</span><span class="sxs-lookup"><span data-stu-id="41b1a-163">The file folder hierarchy is irrelevant.</span></span> <span data-ttu-id="41b1a-164">例如，您可以指定特定 singer 的所有歌曲專案，而不需要擔心這類專案的位置。</span><span class="sxs-lookup"><span data-stu-id="41b1a-164">For example, you can specify all song items by a particular singer without being concerned about the location of such items.</span></span> <span data-ttu-id="41b1a-165">這種複雜的端對端案例不限於 Windows 屬性系統，但牽涉到數個不同的元件，例如編制索引和搜尋資料夾。</span><span class="sxs-lookup"><span data-stu-id="41b1a-165">This complex, end-to-end scenario is not limited to the Windows Property System, but involves several different components, such as the indexing and search folders.</span></span>

<span data-ttu-id="41b1a-166">屬性發明者之一該項（或協力廠商開發人員）是 Windows 屬性系統中的生產者。</span><span class="sxs-lookup"><span data-stu-id="41b1a-166">Property inventors, or third-party developers, are producers in the Windows Property System.</span></span> <span data-ttu-id="41b1a-167">準備定義新的屬性時，請先檢查 Windows 定義的屬性集。</span><span class="sxs-lookup"><span data-stu-id="41b1a-167">When preparing to define a new property, first inspect the set of properties that Windows defines.</span></span> <span data-ttu-id="41b1a-168">如果您發現符合您需求的型別和語義符合您的需要，請使用該屬性，而且不會建立新的屬性。</span><span class="sxs-lookup"><span data-stu-id="41b1a-168">If you find one that meets your needs, of the type and semantics that match your required use, use that property and do not invent a new one.</span></span> <span data-ttu-id="41b1a-169">如果您要定義新的自訂內容，請嘗試與其他開發人員取得合約，這些開發人員可能會想要使用該屬性併發布該合約的結果，讓他們可以加入該屬性的使用者群。</span><span class="sxs-lookup"><span data-stu-id="41b1a-169">If you are defining a new custom property, try to obtain agreement with other developers that might want to use it and publish the result of that agreement so that they can join the community of users of that property.</span></span>

<span data-ttu-id="41b1a-170">生產者可以利用 Windows 檔案總管的功能。</span><span class="sxs-lookup"><span data-stu-id="41b1a-170">Producers can take advantage of Windows Explorer functionality.</span></span> <span data-ttu-id="41b1a-171">例如，如果您要撰寫新的影像格式，並執行屬性處理常式，您的新檔案格式會在 Windows 檔案總管中變成可用。</span><span class="sxs-lookup"><span data-stu-id="41b1a-171">For example, if you are writing a new image format, and implement a property handler, your new file format becomes available in Windows Explorer.</span></span> <span data-ttu-id="41b1a-172">然後，使用者可以根據 Windows 屬性系統中的任何屬性，標記相片並將其相片集合資料透視。</span><span class="sxs-lookup"><span data-stu-id="41b1a-172">Users can then tag their photographs and pivot their collection of photographs based on any property in the Windows Property System.</span></span> <span data-ttu-id="41b1a-173">事實上，Shell 針對屬性所執行的任何動作，協力廠商開發人員都可以在自己的應用程式中執行。</span><span class="sxs-lookup"><span data-stu-id="41b1a-173">In fact, anything that Shell does with properties, third-party developers can do in their own applications.</span></span> <span data-ttu-id="41b1a-174">這包括群組、排序、查詢及顯示完整屬性。</span><span class="sxs-lookup"><span data-stu-id="41b1a-174">This includes grouping, sorting, querying, and displaying full properties.</span></span> <span data-ttu-id="41b1a-175">Windows 檔案總管提供的使用者體驗，大部分都是由具有公開可用 Api 的協力廠商所執行。</span><span class="sxs-lookup"><span data-stu-id="41b1a-175">The user experience that Windows Explorer provides can be largely implemented by third parties with publically available APIs.</span></span> <span data-ttu-id="41b1a-176">您可以使用這些 Api 來取代或擴充 Windows 檔案總管。</span><span class="sxs-lookup"><span data-stu-id="41b1a-176">Windows Explorer can be replaced or extended using these APIs.</span></span>

<span data-ttu-id="41b1a-177">從使用 Shell 資料模型的應用程式觀點來看，有許多案例都牽涉到使用 Windows 屬性系統。</span><span class="sxs-lookup"><span data-stu-id="41b1a-177">From the point of view of an application that uses the Shell data model, there are a huge variety of scenarios that involve the use of the Windows property system.</span></span> <span data-ttu-id="41b1a-178">媒體管理應用程式是很重要的範例。</span><span class="sxs-lookup"><span data-stu-id="41b1a-178">Media management applications are a prominent example.</span></span> <span data-ttu-id="41b1a-179">核心屬性系統案例包括讀取相片的關鍵字屬性或設定 datetaken 屬性等案例。</span><span class="sxs-lookup"><span data-stu-id="41b1a-179">Core property system scenarios include scenarios such as reading the keyword property of a photograph or setting the datetaken property.</span></span> <span data-ttu-id="41b1a-180">Windows 屬性系統啟用的端對端整合案例範例，但需要其他數個元件才能運作，包括顯示所有圖片，或尋找包含關鍵字的檔。</span><span class="sxs-lookup"><span data-stu-id="41b1a-180">Examples of end-to-end integration scenarios that the Windows Property System enables, but that require several other components to function, include showing all pictures, or finding a document that contains a keyword.</span></span>

## <a name="properties-and-windows-search"></a><span data-ttu-id="41b1a-181">屬性和 Windows Search</span><span class="sxs-lookup"><span data-stu-id="41b1a-181">Properties and Windows Search</span></span>

<span data-ttu-id="41b1a-182">當生產者和取用者與 Windows Search 和編制索引進行互動時，這些屬性會提供服務。</span><span class="sxs-lookup"><span data-stu-id="41b1a-182">Properties serve both producers and consumers when they interface with Windows Search and indexing.</span></span> <span data-ttu-id="41b1a-183">Windows Search 具有屬性值的快取，這些值是用於 Windows Search 服務 (WSS) 的執行。</span><span class="sxs-lookup"><span data-stu-id="41b1a-183">Windows Search has a cache of property values that are used in the implementation of the Windows Search Service (WSS).</span></span> <span data-ttu-id="41b1a-184">您可以使用 Windows Search OLE DB 提供者或透過 [**ISearchFolderItemFactory**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-isearchfolderitemfactory)（代表搜尋結果和查詢型視圖中的專案），以程式設計方式查詢這些屬性值。</span><span class="sxs-lookup"><span data-stu-id="41b1a-184">These property values can be programmatically queried by using the Windows Search OLE DB provider, or through [**ISearchFolderItemFactory**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-isearchfolderitemfactory), which represents items in search results and query-based views.</span></span> <span data-ttu-id="41b1a-185">然後，Windows Search 會在建立檔（例如 Word 檔）的索引時，收集並儲存由篩選處理常式或屬性處理常式所發出的屬性。</span><span class="sxs-lookup"><span data-stu-id="41b1a-185">Windows Search then collects and stores properties emitted by filter handlers or property handlers when an item such as a Word document is indexed.</span></span> <span data-ttu-id="41b1a-186">重建索引時，會捨棄並重建此存放區。</span><span class="sxs-lookup"><span data-stu-id="41b1a-186">This store is discarded and rebuilt when the index is rebuilt.</span></span>

> [!Note]  
> <span data-ttu-id="41b1a-187">請記住，當您重新註冊架構時，索引子可能不會遵守先前定義之屬性的屬性變更。</span><span class="sxs-lookup"><span data-stu-id="41b1a-187">Remember that when you reregister a schema, changes made to attributes of previously defined properties may not be respected by the indexer.</span></span> <span data-ttu-id="41b1a-188">解決方法是重建索引，或引進新的屬性來反映變更，而不是更新舊的屬性 (不建議) 。</span><span class="sxs-lookup"><span data-stu-id="41b1a-188">The solution is either to rebuild the index, or introduce new properties that reflect the changes instead of updating old ones (not recommended).</span></span> <span data-ttu-id="41b1a-189">如需詳細資訊，請參閱本主題稍後的「提供 [者注意](#note-to-implementers) 」。</span><span class="sxs-lookup"><span data-stu-id="41b1a-189">For more information, see [Note to Implementers](#note-to-implementers) later in this topic.</span></span>

 

<span data-ttu-id="41b1a-190">例如，建立媒體應用程式的開發人員想要顯示特定演出者的應用程式使用者所有可用的音樂。</span><span class="sxs-lookup"><span data-stu-id="41b1a-190">For example, a developer creating a media application wants to show users of the application all available music by a particular artist.</span></span> <span data-ttu-id="41b1a-191">應用程式會為使用者提供可用的演出者清單，然後由使用者選取的演出者產生所有可用音樂的清單。</span><span class="sxs-lookup"><span data-stu-id="41b1a-191">The application would provide the user with a list of available artists, and then generate a list of all available music by the artist that the user selects.</span></span> <span data-ttu-id="41b1a-192">或者，使用者可能會想要對？演出者： Beethoven？進行查詢，並在其 searche 過程中公開給可用屬性的完整清單。</span><span class="sxs-lookup"><span data-stu-id="41b1a-192">Or an end user might want to do a query for ?artist:Beethoven?, and be exposed to the full list of available properties in the course of their searche.</span></span> <span data-ttu-id="41b1a-193">此範例牽涉到使用 Shell 命名空間、屬性處理常式，以及/或透過下列其中一種方式來查詢索引：</span><span class="sxs-lookup"><span data-stu-id="41b1a-193">This example involves the use of the Shell namespace, property handlers, and/or querying the index through one of the following:</span></span>

-   <span data-ttu-id="41b1a-194">Shell 資料來源。</span><span class="sxs-lookup"><span data-stu-id="41b1a-194">A Shell data source.</span></span>
-   <span data-ttu-id="41b1a-195">OLE DB 提供者。</span><span class="sxs-lookup"><span data-stu-id="41b1a-195">An OLE DB provider.</span></span>
-   <span data-ttu-id="41b1a-196">已儲存的搜尋檔案 (. 搜尋-ms) ，藉由流覽至 Windows 檔案總管中的搜尋檔案，或以程式設計方式系結至 [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) 來起始查詢。</span><span class="sxs-lookup"><span data-stu-id="41b1a-196">A Saved Search file (.search-ms) that is used to initiate a query by navigating to the search file in Windows Explorer or binding to [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) programmatically.</span></span>

> [!Note]  
> <span data-ttu-id="41b1a-197">雖然 `System.Kind` 屬性不會參與此媒體應用程式案例，但它可用來建立查詢，以傳回特定範圍中的所有. 搜尋-ms 檔案。</span><span class="sxs-lookup"><span data-stu-id="41b1a-197">Although the `System.Kind` property does not participate in this media application scenario, it could be used to build a query that would return all of the .search-ms files in a particular scope.</span></span>

 

<span data-ttu-id="41b1a-198">存取搜尋 Api 和建立 Windows Search 應用程式的慣用方法是透過 Shell 資料來源。</span><span class="sxs-lookup"><span data-stu-id="41b1a-198">The preferred way to access the Search APIs and create Windows Search applications is through a Shell data source.</span></span> <span data-ttu-id="41b1a-199">[**ISearchFolderItemFactory**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-isearchfolderitemfactory) 是一種元件，可建立搜尋資料夾資料來源的實例，這是由 shell 所提供的一種「虛擬」資料來源，可對 shell 命名空間中的其他資料來源執行查詢並列舉結果。</span><span class="sxs-lookup"><span data-stu-id="41b1a-199">[**ISearchFolderItemFactory**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-isearchfolderitemfactory) is a component that can create instances of the Search folder data source, which is a sort of "virtual" data source provided by the Shell that can execute queries over other data sources in the Shell namespace and enumerate results.</span></span> <span data-ttu-id="41b1a-200">它可以藉由使用索引子，或手動列舉和檢查指定範圍中的專案來完成。</span><span class="sxs-lookup"><span data-stu-id="41b1a-200">It can do so either by using the indexer, or by manually enumerating and inspecting items in the specified scopes.</span></span>

<span data-ttu-id="41b1a-201">協力廠商開發人員可以建立應用程式，以透過程式設計方式查詢來取用索引中的資料，而且可以在索引中擴充自訂檔案和專案類型的資料，以 Windows Search 來編制索引。</span><span class="sxs-lookup"><span data-stu-id="41b1a-201">Third-party developers can create applications that consume the data in the index through programmatic queries, and can extend the data in the index for custom file and item types to be indexed by Windows Search.</span></span> <span data-ttu-id="41b1a-202">如果您想要在 Windows 檔案總管中顯示查詢結果，您必須先執行 Shell 資料來源，才能建立通訊協定處理常式來擴充索引。</span><span class="sxs-lookup"><span data-stu-id="41b1a-202">If you want to show query results in Windows Explorer, you must implement a Shell data source before you can create a protocol handler to extend the index.</span></span> <span data-ttu-id="41b1a-203">但是，如果所有查詢都是以程式設計方式 (透過 OLE DB 例如) ，並由應用程式的程式碼（而非 Shell）所解釋，則會優先使用 Shell 命名空間，但不是必要的。</span><span class="sxs-lookup"><span data-stu-id="41b1a-203">However, if all queries will be programmatic (through OLE DB for example) and interpreted by the application?s code rather than the Shell, then a Shell namespace is still preferred but not required.</span></span> <span data-ttu-id="41b1a-204">需要有通訊協定處理常式，Windows 才能取得檔案內容的相關資訊，例如資料庫或自訂檔案類型中的專案。</span><span class="sxs-lookup"><span data-stu-id="41b1a-204">A protocol handler is required for Windows to obtain information about file contents, such as items in databases or custom file types.</span></span> <span data-ttu-id="41b1a-205">雖然 Windows Search 可以為檔案的名稱和屬性編制索引，但 Windows 沒有檔案內容的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="41b1a-205">While Windows Search can index the name and properties of the file, Windows has no information about the content of the file.</span></span> <span data-ttu-id="41b1a-206">如此一來，就無法在 Windows Shell 中建立索引或公開這類專案。</span><span class="sxs-lookup"><span data-stu-id="41b1a-206">As a result, such items cannot be indexed or exposed in the Windows Shell.</span></span> <span data-ttu-id="41b1a-207">藉由執行自訂通訊協定處理常式，您可以公開這些專案。</span><span class="sxs-lookup"><span data-stu-id="41b1a-207">By implementing a custom protocol handler, you can expose these items.</span></span> <span data-ttu-id="41b1a-208">如需您嘗試達成之開發人員案例所識別的處理常式清單，請參閱 Windows Search 中的「處理常式總覽」 [作為開發平臺](../search/-search-3x-wds-development-ovr.md)。</span><span class="sxs-lookup"><span data-stu-id="41b1a-208">For a list of handlers identified by the developer scenario you are trying to achieve, see "Overview of Handlers" in [Windows Search as a Development Platform](../search/-search-3x-wds-development-ovr.md).</span></span>

> [!Note]  
> <span data-ttu-id="41b1a-209">Shell 資料來源有時也稱為 Shell 命名空間延伸模組。</span><span class="sxs-lookup"><span data-stu-id="41b1a-209">A Shell data source is sometimes known as a Shell namespace extension.</span></span> <span data-ttu-id="41b1a-210">處理常式有時也稱為 Shell 擴充或 Shell 擴充處理常式。</span><span class="sxs-lookup"><span data-stu-id="41b1a-210">A handler is sometimes known as a Shell extension or a Shell extension handler.</span></span>

 

## <a name="note-to-implementers"></a><span data-ttu-id="41b1a-211">實施者注意事項</span><span class="sxs-lookup"><span data-stu-id="41b1a-211">Note to Implementers</span></span>

<span data-ttu-id="41b1a-212">由於索引子在取用屬性系統架構時可能會遇到的問題，因此您必須謹慎地定義屬性，並策略性地針對第一版的架構來定義屬性。</span><span class="sxs-lookup"><span data-stu-id="41b1a-212">Due to potential difficulties that the indexer may have when consuming the property system's schema, it is critical that you define attributes carefully and strategically for the first release of the schema.</span></span> <span data-ttu-id="41b1a-213">在架構註冊之後，資料庫的任何變更 (類型、資料行寬度、indexible) 是否都不會反映在資料庫中。</span><span class="sxs-lookup"><span data-stu-id="41b1a-213">Any changes to attributes (type, column width, whether indexible) will not be reflected in the database after a schema has been registered.</span></span> <span data-ttu-id="41b1a-214">當架構在系統上註冊一次之後，唯一可辨識這些變更的方法就是重建索引，然後註冊新的架構，或是註冊架構，然後為每個後續的版本建立新的屬性。例如， `PKEY_GroupName_PropertyNameV2` `PKEY_GroupName_PropertyNameV3` 和等等。</span><span class="sxs-lookup"><span data-stu-id="41b1a-214">The only ways to have these changes recognized after the schema has been registered once on a system would be either to rebuild the index and then register the new schema, or to register the schema and then create a new property for each subsequent release; for example `PKEY_GroupName_PropertyNameV2`, `PKEY_GroupName_PropertyNameV3`, and so forth.</span></span> <span data-ttu-id="41b1a-215">我們不建議以這種方式建立新的屬性，因為多個額外的資料行可能會影響系統效能。</span><span class="sxs-lookup"><span data-stu-id="41b1a-215">We do not recommend creating new properties in this manner, because multiple extraneous columns may impact system performance.</span></span>

## <a name="windows-property-system-documentation"></a><span data-ttu-id="41b1a-216">Windows 屬性系統檔</span><span class="sxs-lookup"><span data-stu-id="41b1a-216">Windows Property System Documentation</span></span>

<span data-ttu-id="41b1a-217">本檔的其餘部分包含下列各節：</span><span class="sxs-lookup"><span data-stu-id="41b1a-217">The remainder of this documentation contains the following sections:</span></span>

-   [<span data-ttu-id="41b1a-218">Windows 屬性系統開發人員指南</span><span class="sxs-lookup"><span data-stu-id="41b1a-218">Windows Property System Developer's Guide</span></span>](property-system-developer-s-guide.md)

    <span data-ttu-id="41b1a-219">詳細說明如何使用 Windows 屬性系統來執行主要開發案例。</span><span class="sxs-lookup"><span data-stu-id="41b1a-219">Describes in detail how to implement the main development scenarios using the Windows Property System.</span></span>

-   [<span data-ttu-id="41b1a-220">屬性系統參考</span><span class="sxs-lookup"><span data-stu-id="41b1a-220">Property System Reference</span></span>](property-system-reference.md)

    <span data-ttu-id="41b1a-221">記錄 Windows 屬性系統的 [Windows 屬性](props.md)、 [屬性描述架構](property-description-schema.md)、 [介面](interfaces.md)、 [函數](functions.md)、 [結構](structures.md)和 [常數、列舉和旗標](constants--enumerations--and-flags.md) 。</span><span class="sxs-lookup"><span data-stu-id="41b1a-221">Documents the [Windows Properties](props.md), [Property Description Schema](property-description-schema.md), [Interfaces](interfaces.md), [Functions](functions.md), [Structures](structures.md), and [Constants, Enumerations, and Flags](constants--enumerations--and-flags.md) of the Windows Property System.</span></span>

-   [<span data-ttu-id="41b1a-222">屬性系統程式碼範例</span><span class="sxs-lookup"><span data-stu-id="41b1a-222">Property System Code Samples</span></span>](property-system-code-samples.md)

    <span data-ttu-id="41b1a-223">描述示範如何使用 Windows 屬性系統的範例。</span><span class="sxs-lookup"><span data-stu-id="41b1a-223">Describes samples that demonstrate how to use the Windows Property System.</span></span>

## <a name="additional-resources"></a><span data-ttu-id="41b1a-224">其他資源</span><span class="sxs-lookup"><span data-stu-id="41b1a-224">Additional Resources</span></span>

-   <span data-ttu-id="41b1a-225">如需重複使用 In-Memory 屬性儲存區的詳細資訊，請參閱 [初始化屬性處理常式](building-property-handlers-property-handlers.md) 和 [**PSCreateMemoryPropertyStore**](/windows/desktop/api/Propsys/nf-propsys-pscreatememorypropertystore)。</span><span class="sxs-lookup"><span data-stu-id="41b1a-225">For information about reusing the In-Memory Property Store, see [Initializing Property Handlers](building-property-handlers-property-handlers.md) and [**PSCreateMemoryPropertyStore**](/windows/desktop/api/Propsys/nf-propsys-pscreatememorypropertystore).</span></span>
-   <span data-ttu-id="41b1a-226">如需 Microsoft 屬性儲存區二進位檔案格式的規格，請參閱[ \[ MS \_ PROPSTORE \] ](/openspecs/windows_protocols/ms-propstore/39ea873f-7af5-44dd-92f9-bc1f293852cc)。</span><span class="sxs-lookup"><span data-stu-id="41b1a-226">For a specification of the Microsoft Property Store Binary File Format, see [\[MS\_PROPSTORE\]](/openspecs/windows_protocols/ms-propstore/39ea873f-7af5-44dd-92f9-bc1f293852cc).</span></span>
-   <span data-ttu-id="41b1a-227">Windows Search 與編制索引之間的關聯性，以及如何擴充索引，會在 Windows Search 的下列主題中說明：</span><span class="sxs-lookup"><span data-stu-id="41b1a-227">The relationship between Windows Search and indexing, and how to extend the index, are explained in the following topics in Windows Search:</span></span>
    -   [<span data-ttu-id="41b1a-228">針對 Windows Search 開發篩選處理常式</span><span class="sxs-lookup"><span data-stu-id="41b1a-228">Developing Filter Handlers for Windows Search</span></span>](../search/-search-ifilter-conceptual.md)
    -   [<span data-ttu-id="41b1a-229">開發 Windows Search 的通訊協定處理常式</span><span class="sxs-lookup"><span data-stu-id="41b1a-229">Developing Protocol Handlers for Windows Search</span></span>](../search/-search-3x-wds-phaddins.md)
    -   [<span data-ttu-id="41b1a-230">開發 Windows Search 的屬性處理常式</span><span class="sxs-lookup"><span data-stu-id="41b1a-230">Developing Property Handlers for Windows Search</span></span>](../search/-search-3x-wds-extidx-propertyhandlers.md)
    -   <span data-ttu-id="41b1a-231">若為 Windows 7 或更新版 Windows Vista SDK 下載，請參閱 [Windows SDK](https://msdn.microsoft.com/windowsvista/bb980924.aspx)。</span><span class="sxs-lookup"><span data-stu-id="41b1a-231">For the Windows 7 or updated Windows Vista SDK download, see the [Windows SDK](https://msdn.microsoft.com/windowsvista/bb980924.aspx).</span></span>

## <a name="related-topics"></a><span data-ttu-id="41b1a-232">相關主題</span><span class="sxs-lookup"><span data-stu-id="41b1a-232">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="41b1a-233">Windows 屬性系統開發人員指南</span><span class="sxs-lookup"><span data-stu-id="41b1a-233">Windows Property System Developer's Guide</span></span>](property-system-developer-s-guide.md)
</dt> <dt>

[<span data-ttu-id="41b1a-234">屬性系統參考</span><span class="sxs-lookup"><span data-stu-id="41b1a-234">Property System Reference</span></span>](property-system-reference.md)
</dt> <dt>

[<span data-ttu-id="41b1a-235">屬性系統程式碼範例</span><span class="sxs-lookup"><span data-stu-id="41b1a-235">Property System Code Samples</span></span>](property-system-code-samples.md)
</dt> </dl>

 

 
