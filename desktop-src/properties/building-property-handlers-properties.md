---
description: 屬性是由稱為屬性識別碼 (Pid) 的識別碼來表示。
ms.assetid: a773c7b3-a1a2-4cce-ae5f-b54217ea06f4
title: 瞭解屬性處理常式
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 564d6f8bd325e649ff1356869932521d8c1cd885
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/07/2021
ms.locfileid: "104192147"
---
# <a name="understanding-property-handlers"></a>瞭解屬性處理常式

屬性是由稱為屬性識別碼 (Pid) 的識別碼來表示。 每個屬性都必須有全域唯一識別碼 (GUID) 。 此識別碼是由 GUID 所組成，表示稱為屬性集的屬性集合，加上字串或32位整數，以識別集合中的屬性。 如果使用整數形式的識別碼，則會將0x00000000、0xFFFFFFFF 和0xFFFFFFFE 值視為無效。 廠商可以將屬性放在自己的 Guid 所定義的屬性集中，以保證其屬性是唯一的定義。

> [!IMPORTANT]
> 您必須謹慎且策略性地定義第一版架構的屬性。 自訂屬性的任何變更 (例如資料行寬度或屬性類型) ，在架構註冊之後，將不會反映在資料庫中。 在系統上註冊架構一次之後，可辨識這些變更的唯一方法就是重建索引，然後註冊新的架構，或註冊架構，然後建立新的屬性 (，其中包含每個 subequent 版本的正式名稱和 PKEY) 。例如 `PKEY_GroupName_PropertyNameV2` ，等 `PKEY_GroupName_PropertyNameV3`) 。 我們不建議以這種方式建立新的屬性，因為多個額外的資料行可能會影響系統效能。

 

本主題的組織方式如下：

-   [中繼資料](#metadata)
    -   [開啟中繼資料](#open-metadata)
-   [關於屬性處理常式](#about-property-handlers)
-   [舊版技術](#legacy-technology)
-   [相關主題](#related-topics)

## <a name="metadata"></a>中繼資料

在 Windows Vista 和更新版本中，以中繼資料為基礎的新屬性系統是組織專案（例如檔案、電子郵件和連絡人）的核心。 在這個新的屬性系統中，可以根據專案的中繼資料來搜尋專案，而且使用者可以讀取或寫入該中繼資料。 這個系統中的中繼資料是以實作為名稱/值組的可延伸 *屬性* 集來表示。

在 Windows Vista 和更新版本中，有一組廣泛的屬性涵蓋了相片、音樂、檔、郵件、連絡人和檔案等專案的細節。 獨立軟體廠商 (Isv) 如果沒有任何現有的屬性符合需求，就可以將自己的屬性引入平臺。

### <a name="open-metadata"></a>開啟中繼資料

Windows Vista 和更新版本中的屬性系統是開放式中繼資料系統。 檔案格式會儲存任何指派給它的屬性，並在查詢時公開該值，無論相關性或意義為何。 這可讓協力廠商開發人員將額外的屬性附加至檔案，而不需要變更與其相關聯的屬性處理常式。 開放式中繼資料是一種強大的概念。 如需有關如何支援以 XML 為基礎的檔案格式開啟中繼資料的詳細資訊，請參閱 [初始化屬性處理常式](./building-property-handlers-property-handlers.md)中的「支援開放中繼資料」。

> [!Note]  
> 屬性處理常式一律會與特定檔案類型相關聯;因此，如果您的檔案格式包含需要自訂屬性處理常式的屬性，您應該一律為每個檔案格式註冊唯一的副檔名。

 

## <a name="about-property-handlers"></a>關於屬性處理常式

在 Windows Vista 和更新版本中，Windows 具有可延伸的屬性系統，可在您存取的檔案和資料項目中儲存和取得中繼資料。 Windows 檔案總管和 Windows Search 系統以及其他應用程式，請使用屬性處理常式來讀取和修改此中繼資料。 如果您是擁有特定檔案類型的開發人員，您應該註冊屬性處理常式，以授與屬性系統對您檔案中中繼資料的存取權。 在某些情況下，您可以使用現有的屬性處理常式，該處理常式可以讀取及瞭解您的檔案格式及其屬性;在其他情況下，您可能需要為您的檔案類型開發新的屬性處理常式。

撰寫屬性處理常式的第一步是考慮您的檔案類型所支援的屬性。 屬性值會儲存在檔案資料流程中，主要是用來啟用可傳送性。 當屬性值儲存在檔案本身時（如同在此系統中），使用者可以將檔案複製到另一部電腦、USB 快閃磁片磁碟機或其他檔案系統，或以電子郵件附件的形式傳送檔案，這些屬性會隨著檔案移動，且永遠不會遺失或遺失。 因此，如果檔案格式支援儲存額外的資訊，最好將屬性儲存在檔案本身。

下一步是判斷檔案應提供哪些屬性。 您可能一開始會認為一組有限的屬性已足夠。 音訊檔案只能支援音訊相關屬性，並在該處結束。 不過，該音訊檔案可能是由法律事務所所封存之法院的會話記錄。 在這種情況下，法律事務所肯定會想要將其他非音訊屬性與這個檔案相關聯，例如案例號碼。 音訊檔案格式的提供者不可能決定將使用其格式的所有案例。 因此，它們應該考慮啟用屬性系統所支援之任何任意屬性的總儲存體。

## <a name="legacy-technology"></a>舊版技術

Microsoft Windows NT 檔案系統 (NTFS) 次要串流技術的開發目的，是為了支援透過檔案系統層上的替代資料流程設定，在檔案中保存額外的資訊。 您可能會想知道為何這些次要資料流程不是用來儲存屬性的主要方法，尤其是開啟的中繼資料支援。 主要原因是此額外資訊的可傳送性。 可惜的是，在許多情況下都會移除這些替代資料流程，包括用戶端快取支援 (CSC) 、將檔案當作附件傳送，以及將檔案複製到非 NTFS 存放區。

次要資料流程不提供健全的解決方案，可保證屬性與檔案一起移動，因此 Windows Vista 屬性系統不提供可利用次要 NTFS 資料流程進行屬性儲存的內建機制。 Isv 也不建議您建立屬性處理常式，以使用次要串流來儲存屬性。 當然，在某些情況下，NTFS 次要資料流程是適當的，特別是當應用程式可保證其處理的檔案一律儲存在 NTFS 磁片區中，而且不會因為使用者互動而移動。

## <a name="related-topics"></a>相關主題

<dl> <dt>

[使用種類名稱](./building-property-handlers-user-friendly-kind-names.md)
</dt> <dt>

[使用屬性清單](./building-property-handlers-property-lists.md)
</dt> <dt>

[初始化屬性處理常式](./building-property-handlers-property-handlers.md)
</dt> <dt>

[註冊和散發屬性處理常式](./prophand-reg-dist.md)
</dt> <dt>

[屬性處理常式的最佳作法和常見問題](./prophand-bestprac-faq.md)
</dt> </dl>

 

 
