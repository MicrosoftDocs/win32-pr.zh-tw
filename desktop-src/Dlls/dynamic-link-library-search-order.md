---
description: 應用程式可以藉由指定完整路徑或使用其他機制（例如資訊清單），來控制載入 DLL 的位置。 如果未使用這些方法，系統會在載入時搜尋 DLL，如本主題中所述。
ms.assetid: 44228cf2-6306-466c-8f16-f513cd3ba8b5
title: Dynamic-Link 程式庫搜尋順序
ms.topic: article
ms.date: 09/11/2020
ms.custom: contperf-fy21q1
ms.openlocfilehash: 928cf9030e24c91145ae95e1eed680017bf68533
ms.sourcegitcommit: f374b50b37160b683da16b59ac9340282a8f50a5
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/04/2021
ms.locfileid: "104509744"
---
# <a name="dynamic-link-library-search-order"></a><span data-ttu-id="8053b-104">Dynamic-Link 程式庫搜尋順序</span><span class="sxs-lookup"><span data-stu-id="8053b-104">Dynamic-Link Library Search Order</span></span>

<span data-ttu-id="8053b-105">系統可以將相同動態連結程式庫的多個版本包含 (DLL) 。</span><span class="sxs-lookup"><span data-stu-id="8053b-105">A system can contain multiple versions of the same dynamic-link library (DLL).</span></span> <span data-ttu-id="8053b-106">應用程式可以藉由指定完整路徑或使用其他機制（例如資訊清單），來控制載入 DLL 的位置。</span><span class="sxs-lookup"><span data-stu-id="8053b-106">Applications can control the location from which a DLL is loaded by specifying a full path or using another mechanism such as a manifest.</span></span> <span data-ttu-id="8053b-107">如果未使用這些方法，系統會在載入時搜尋 DLL，如本主題中所述。</span><span class="sxs-lookup"><span data-stu-id="8053b-107">If these methods are not used, the system searches for the DLL at load time as described in this topic.</span></span>

-   [<span data-ttu-id="8053b-108">影響搜尋的因素</span><span class="sxs-lookup"><span data-stu-id="8053b-108">Factors That Affect Searching</span></span>](#factors-that-affect-searching)
-   [<span data-ttu-id="8053b-109">UWP 應用程式的搜尋順序</span><span class="sxs-lookup"><span data-stu-id="8053b-109">Search Order for UWP Apps</span></span>](#search-order-for-uwp-apps)
    -   [<span data-ttu-id="8053b-110">UWP 應用程式的標準搜尋順序</span><span class="sxs-lookup"><span data-stu-id="8053b-110">Standard Search Order for UWP Apps</span></span>](#standard-search-order-for-uwp-apps)
    -   [<span data-ttu-id="8053b-111">UWP 應用程式的替代搜尋順序</span><span class="sxs-lookup"><span data-stu-id="8053b-111">Alternate Search Order for UWP Apps</span></span>](#alternate-search-order-for-uwp-apps)
-   [<span data-ttu-id="8053b-112">桌面應用程式的搜尋順序</span><span class="sxs-lookup"><span data-stu-id="8053b-112">Search Order for Desktop Applications</span></span>](#search-order-for-desktop-applications)
    -   [<span data-ttu-id="8053b-113">桌面應用程式的標準搜尋順序</span><span class="sxs-lookup"><span data-stu-id="8053b-113">Standard Search Order for Desktop Applications</span></span>](#standard-search-order-for-desktop-applications)
    -   [<span data-ttu-id="8053b-114">桌面應用程式的替代搜尋順序</span><span class="sxs-lookup"><span data-stu-id="8053b-114">Alternate Search Order for Desktop Applications</span></span>](#alternate-search-order-for-desktop-applications)
    -   [<span data-ttu-id="8053b-115">使用載入連結 **\_ 庫 \_ 搜尋** 旗標搜尋順序</span><span class="sxs-lookup"><span data-stu-id="8053b-115">Search Order Using **LOAD\_LIBRARY\_SEARCH** Flags</span></span>](/windows)
-   [<span data-ttu-id="8053b-116">相關主題</span><span class="sxs-lookup"><span data-stu-id="8053b-116">Related topics</span></span>](#related-topics)

## <a name="factors-that-affect-searching"></a><span data-ttu-id="8053b-117">影響搜尋的因素</span><span class="sxs-lookup"><span data-stu-id="8053b-117">Factors That Affect Searching</span></span>

<span data-ttu-id="8053b-118">下列因素會影響系統是否搜尋 DLL：</span><span class="sxs-lookup"><span data-stu-id="8053b-118">The following factors affect whether the system searches for a DLL:</span></span>

-   <span data-ttu-id="8053b-119">如果已在記憶體中載入具有相同模組名稱的 DLL，則系統只會檢查重新導向和資訊清單，然後再解析成載入的 DLL，而不論其所在的目錄為何。</span><span class="sxs-lookup"><span data-stu-id="8053b-119">If a DLL with the same module name is already loaded in memory, the system checks only for redirection and a manifest before resolving to the loaded DLL, no matter which directory it is in.</span></span> <span data-ttu-id="8053b-120">系統不會搜尋 DLL。</span><span class="sxs-lookup"><span data-stu-id="8053b-120">The system does not search for the DLL.</span></span>
-   <span data-ttu-id="8053b-121">如果 DLL 是在執行應用程式之 Windows 版本的已知 Dll 清單上，則系統會使用其已知 DLL 的複本 (以及已知 DLL 的相依 Dll （如果有任何) ，而不是搜尋 DLL）。</span><span class="sxs-lookup"><span data-stu-id="8053b-121">If the DLL is on the list of known DLLs for the version of Windows on which the application is running, the system uses its copy of the known DLL (and the known DLL's dependent DLLs, if any) instead of searching for the DLL.</span></span> <span data-ttu-id="8053b-122">如需目前系統上已知 Dll 的清單，請參閱下列登錄機碼： **HKEY \_ LOCAL \_ MACHINE \\ System \\ CurrentControlSet \\ Control \\ Session Manager \\ KnownDLLs**。</span><span class="sxs-lookup"><span data-stu-id="8053b-122">For a list of known DLLs on the current system, see the following registry key: **HKEY\_LOCAL\_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\KnownDLLs**.</span></span>
-   <span data-ttu-id="8053b-123">如果 DLL 具有相依性，系統就會搜尋相依的 Dll，如同它們是以其模組名稱載入一樣。</span><span class="sxs-lookup"><span data-stu-id="8053b-123">If a DLL has dependencies, the system searches for the dependent DLLs as if they were loaded with just their module names.</span></span> <span data-ttu-id="8053b-124">即使是藉由指定完整路徑來載入第一個 DLL，也是如此。</span><span class="sxs-lookup"><span data-stu-id="8053b-124">This is true even if the first DLL was loaded by specifying a full path.</span></span>

## <a name="search-order-for-uwp-apps"></a><span data-ttu-id="8053b-125">UWP 應用程式的搜尋順序</span><span class="sxs-lookup"><span data-stu-id="8053b-125">Search Order for UWP apps</span></span>

<span data-ttu-id="8053b-126">當 Windows 10 (的 UWP 應用程式或適用于 Windows 8 的商店應用程式) 透過呼叫 [**>loadpackagedlibrary**](/windows/desktop/api/Winbase/nf-winbase-loadpackagedlibrary) 函式來載入封裝的模組時，DLL 必須在進程的封裝相依性圖形中。</span><span class="sxs-lookup"><span data-stu-id="8053b-126">When a UWP app for Windows 10 (or a Store app for Windows 8.x) loads a packaged module by calling the [**LoadPackagedLibrary**](/windows/desktop/api/Winbase/nf-winbase-loadpackagedlibrary) function, the DLL must be in the package dependency graph of the process.</span></span> <span data-ttu-id="8053b-127">如需詳細資訊，請參閱 **>loadpackagedlibrary**。</span><span class="sxs-lookup"><span data-stu-id="8053b-127">For more information, see **LoadPackagedLibrary**.</span></span> <span data-ttu-id="8053b-128">當 UWP 應用程式以其他方式載入模組，但未指定完整路徑時，系統會在載入時搜尋 DLL 和其相依性，如本節所述。</span><span class="sxs-lookup"><span data-stu-id="8053b-128">When a UWP app loads a module by other means and does not specify a full path, the system searches for the DLL and its dependencies at load time as described in this section.</span></span>

<span data-ttu-id="8053b-129">在系統搜尋 DLL 之前，它會檢查下列各項：</span><span class="sxs-lookup"><span data-stu-id="8053b-129">Before the system searches for a DLL, it checks the following:</span></span>

-   <span data-ttu-id="8053b-130">如果已在記憶體中載入具有相同模組名稱的 DLL，系統就會使用載入的 DLL，而不論其所在的目錄為何。</span><span class="sxs-lookup"><span data-stu-id="8053b-130">If a DLL with the same module name is already loaded in memory, the system uses the loaded DLL, no matter which directory it is in.</span></span> <span data-ttu-id="8053b-131">系統不會搜尋 DLL。</span><span class="sxs-lookup"><span data-stu-id="8053b-131">The system does not search for the DLL.</span></span>
-   <span data-ttu-id="8053b-132">如果 DLL 是在執行應用程式之 Windows 版本的已知 Dll 清單上，則系統會使用其已知 DLL 的複本 (以及已知 DLL 的相依 Dll （如果有任何) ）。</span><span class="sxs-lookup"><span data-stu-id="8053b-132">If the DLL is on the list of known DLLs for the version of Windows on which the application is running, the system uses its copy of the known DLL (and the known DLL's dependent DLLs, if any).</span></span> <span data-ttu-id="8053b-133">系統不會搜尋 DLL。</span><span class="sxs-lookup"><span data-stu-id="8053b-133">The system does not search for the DLL.</span></span> <span data-ttu-id="8053b-134">如需目前系統上已知 Dll 的清單，請參閱下列登錄機碼： **HKEY \_ LOCAL \_ MACHINE \\ System \\ CurrentControlSet \\ Control \\ Session Manager \\ KnownDLLs**。</span><span class="sxs-lookup"><span data-stu-id="8053b-134">For a list of known DLLs on the current system, see the following registry key: **HKEY\_LOCAL\_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\KnownDLLs**.</span></span>

<span data-ttu-id="8053b-135">如果系統必須搜尋模組或其相依性，即使相依性不是 UWP 應用程式程式碼，它一律會使用 UWP 應用程式的搜尋順序。</span><span class="sxs-lookup"><span data-stu-id="8053b-135">If the system must search for a module or its dependencies, it always uses the search order for UWP apps even if a dependency is not UWP app code.</span></span>

### <a name="standard-search-order-for-uwp-apps"></a><span data-ttu-id="8053b-136">UWP 應用程式的標準搜尋順序</span><span class="sxs-lookup"><span data-stu-id="8053b-136">Standard Search Order for UWP apps</span></span>

<span data-ttu-id="8053b-137">如果模組尚未載入或在已知 Dll 的清單上，系統會依下列順序搜尋這些位置：</span><span class="sxs-lookup"><span data-stu-id="8053b-137">If the module is not already loaded or on the list of known DLLs, the system searches these locations in this order:</span></span>

1.  <span data-ttu-id="8053b-138">進程的封裝相依性圖形。</span><span class="sxs-lookup"><span data-stu-id="8053b-138">The package dependency graph of the process.</span></span> <span data-ttu-id="8053b-139">這是應用程式的套件，以及 `<PackageDependency>` 在 `<Dependencies>` 應用程式套件資訊清單區段中指定的任何相依性。</span><span class="sxs-lookup"><span data-stu-id="8053b-139">This is the application's package plus any dependencies specified as `<PackageDependency>` in the `<Dependencies>` section of the application's package manifest.</span></span> <span data-ttu-id="8053b-140">系統會依資訊清單中出現的順序來搜尋相依性。</span><span class="sxs-lookup"><span data-stu-id="8053b-140">Dependencies are searched in the order they appear in the manifest.</span></span>
2.  <span data-ttu-id="8053b-141">從中載入呼叫進程的目錄。</span><span class="sxs-lookup"><span data-stu-id="8053b-141">The directory the calling process was loaded from.</span></span>
3.  <span data-ttu-id="8053b-142">系統目錄 (% SystemRoot% \\ system32) 。</span><span class="sxs-lookup"><span data-stu-id="8053b-142">The system directory (%SystemRoot%\\system32).</span></span>

<span data-ttu-id="8053b-143">如果 DLL 具有相依性，系統就會搜尋相依的 Dll，如同它們是以其模組名稱載入一樣。</span><span class="sxs-lookup"><span data-stu-id="8053b-143">If a DLL has dependencies, the system searches for the dependent DLLs as if they were loaded with just their module names.</span></span> <span data-ttu-id="8053b-144">即使是藉由指定完整路徑來載入第一個 DLL，也是如此。</span><span class="sxs-lookup"><span data-stu-id="8053b-144">This is true even if the first DLL was loaded by specifying a full path.</span></span>

### <a name="alternate-search-order-for-uwp-apps"></a><span data-ttu-id="8053b-145">UWP 應用程式的替代搜尋順序</span><span class="sxs-lookup"><span data-stu-id="8053b-145">Alternate Search Order for UWP apps</span></span>

<span data-ttu-id="8053b-146">如果模組變更標準搜尋順序，方法是使用已 **\_ \_ 改變 \_ 搜尋 \_ 路徑的載入** 來呼叫 [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa)函式，系統會在目錄中搜尋指定模組的載入來原始目錄，而不是呼叫進程的目錄。</span><span class="sxs-lookup"><span data-stu-id="8053b-146">If a module changes the standard search order by calling the [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa) function with **LOAD\_WITH\_ALTERED\_SEARCH\_PATH**, the system searches the directory the specified module was loaded from instead of the directory of the calling process.</span></span> <span data-ttu-id="8053b-147">系統會依下列順序搜尋這些位置：</span><span class="sxs-lookup"><span data-stu-id="8053b-147">The system searches these locations in this order:</span></span>

1.  <span data-ttu-id="8053b-148">進程的封裝相依性圖形。</span><span class="sxs-lookup"><span data-stu-id="8053b-148">The package dependency graph of the process.</span></span> <span data-ttu-id="8053b-149">這是應用程式的套件，以及 `<PackageDependency>` 在 `<Dependencies>` 應用程式套件資訊清單區段中指定的任何相依性。</span><span class="sxs-lookup"><span data-stu-id="8053b-149">This is the application's package plus any dependencies specified as `<PackageDependency>` in the `<Dependencies>` section of the application's package manifest.</span></span> <span data-ttu-id="8053b-150">系統會依資訊清單中出現的順序來搜尋相依性。</span><span class="sxs-lookup"><span data-stu-id="8053b-150">Dependencies are searched in the order they appear in the manifest.</span></span>
2.  <span data-ttu-id="8053b-151">從中載入指定模組的目錄。</span><span class="sxs-lookup"><span data-stu-id="8053b-151">The directory the specified module was loaded from.</span></span>
3.  <span data-ttu-id="8053b-152">系統目錄 (% SystemRoot% \\ system32) 。</span><span class="sxs-lookup"><span data-stu-id="8053b-152">The system directory (%SystemRoot%\\system32).</span></span>

## <a name="search-order-for-desktop-applications"></a><span data-ttu-id="8053b-153">桌面應用程式的搜尋順序</span><span class="sxs-lookup"><span data-stu-id="8053b-153">Search Order for Desktop Applications</span></span>

<span data-ttu-id="8053b-154">桌面應用程式可以藉由指定完整路徑、使用 [DLL](dynamic-link-library-redirection.md)重新導向或使用 [資訊清單](/windows/desktop/SbsCs/manifests)，來控制載入 DLL 的位置。</span><span class="sxs-lookup"><span data-stu-id="8053b-154">Desktop applications can control the location from which a DLL is loaded by specifying a full path, using [DLL redirection](dynamic-link-library-redirection.md), or by using a [manifest](/windows/desktop/SbsCs/manifests).</span></span> <span data-ttu-id="8053b-155">如果未使用這些方法，系統會在載入時搜尋 DLL，如本節所述。</span><span class="sxs-lookup"><span data-stu-id="8053b-155">If none of these methods are used, the system searches for the DLL at load time as described in this section.</span></span>

<span data-ttu-id="8053b-156">在系統搜尋 DLL 之前，它會檢查下列各項：</span><span class="sxs-lookup"><span data-stu-id="8053b-156">Before the system searches for a DLL, it checks the following:</span></span>

-   <span data-ttu-id="8053b-157">如果已在記憶體中載入具有相同模組名稱的 DLL，系統就會使用載入的 DLL，而不論其所在的目錄為何。</span><span class="sxs-lookup"><span data-stu-id="8053b-157">If a DLL with the same module name is already loaded in memory, the system uses the loaded DLL, no matter which directory it is in.</span></span> <span data-ttu-id="8053b-158">系統不會搜尋 DLL。</span><span class="sxs-lookup"><span data-stu-id="8053b-158">The system does not search for the DLL.</span></span>
-   <span data-ttu-id="8053b-159">如果 DLL 是在執行應用程式之 Windows 版本的已知 Dll 清單上，則系統會使用其已知 DLL 的複本 (以及已知 DLL 的相依 Dll （如果有任何) ）。</span><span class="sxs-lookup"><span data-stu-id="8053b-159">If the DLL is on the list of known DLLs for the version of Windows on which the application is running, the system uses its copy of the known DLL (and the known DLL's dependent DLLs, if any).</span></span> <span data-ttu-id="8053b-160">系統不會搜尋 DLL。</span><span class="sxs-lookup"><span data-stu-id="8053b-160">The system does not search for the DLL.</span></span> <span data-ttu-id="8053b-161">如需目前系統上已知 Dll 的清單，請參閱下列登錄機碼： **HKEY \_ LOCAL \_ MACHINE \\ System \\ CurrentControlSet \\ Control \\ Session Manager \\ KnownDLLs**。</span><span class="sxs-lookup"><span data-stu-id="8053b-161">For a list of known DLLs on the current system, see the following registry key: **HKEY\_LOCAL\_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\KnownDLLs**.</span></span>

<span data-ttu-id="8053b-162">如果 DLL 具有相依性，系統就會搜尋相依的 Dll，如同它們是以其模組名稱載入一樣。</span><span class="sxs-lookup"><span data-stu-id="8053b-162">If a DLL has dependencies, the system searches for the dependent DLLs as if they were loaded with just their module names.</span></span> <span data-ttu-id="8053b-163">即使是藉由指定完整路徑來載入第一個 DLL，也是如此。</span><span class="sxs-lookup"><span data-stu-id="8053b-163">This is true even if the first DLL was loaded by specifying a full path.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="8053b-164">如果攻擊者取得所搜尋之其中一個目錄的控制權，就可以在該目錄中放置 DLL 的惡意複本。</span><span class="sxs-lookup"><span data-stu-id="8053b-164">If an attacker gains control of one of the directories that is searched, it can place a malicious copy of the DLL in that directory.</span></span> <span data-ttu-id="8053b-165">如需協助防止這類攻擊的方法，請參閱 [動態連結程式庫安全性](dynamic-link-library-security.md)。</span><span class="sxs-lookup"><span data-stu-id="8053b-165">For ways to help prevent such attacks, see [Dynamic-Link Library Security](dynamic-link-library-security.md).</span></span>

### <a name="standard-search-order-for-desktop-applications"></a><span data-ttu-id="8053b-166">桌面應用程式的標準搜尋順序</span><span class="sxs-lookup"><span data-stu-id="8053b-166">Standard Search Order for Desktop Applications</span></span>

<span data-ttu-id="8053b-167">系統所使用的標準 DLL 搜尋順序取決於是否啟用或停用安全 DLL 搜尋模式。</span><span class="sxs-lookup"><span data-stu-id="8053b-167">The standard DLL search order used by the system depends on whether safe DLL search mode is enabled or disabled.</span></span> <span data-ttu-id="8053b-168">安全的 DLL 搜尋模式會將使用者的目前目錄放在搜尋順序後面。</span><span class="sxs-lookup"><span data-stu-id="8053b-168">Safe DLL search mode places the user's current directory later in the search order.</span></span>

<span data-ttu-id="8053b-169">預設會啟用安全的 DLL 搜尋模式。</span><span class="sxs-lookup"><span data-stu-id="8053b-169">Safe DLL search mode is enabled by default.</span></span> <span data-ttu-id="8053b-170">若要停用此功能，請建立 **HKEY \_ LOCAL \_ MACHINE \\ System \\ CurrentControlSet \\ Control \\ Session Manager** \\ **SafeDllSearchMode** 登錄值，並將它設定為0。</span><span class="sxs-lookup"><span data-stu-id="8053b-170">To disable this feature, create the **HKEY\_LOCAL\_MACHINE\\System\\CurrentControlSet\\Control\\Session Manager**\\**SafeDllSearchMode** registry value and set it to 0.</span></span> <span data-ttu-id="8053b-171">呼叫 [**SetDllDirectory**](/windows/desktop/api/winbase/nf-winbase-setdlldirectorya) 函式會在指定目錄位於搜尋路徑中時，有效地停用 **SafeDllSearchMode** ，並變更搜尋順序，如本主題中所述。</span><span class="sxs-lookup"><span data-stu-id="8053b-171">Calling the [**SetDllDirectory**](/windows/desktop/api/winbase/nf-winbase-setdlldirectorya) function effectively disables **SafeDllSearchMode** while the specified directory is in the search path and changes the search order as described in this topic.</span></span>

<span data-ttu-id="8053b-172">如果已啟用 **SafeDllSearchMode** ，則搜尋順序如下所示：</span><span class="sxs-lookup"><span data-stu-id="8053b-172">If **SafeDllSearchMode** is enabled, the search order is as follows:</span></span>

1.  <span data-ttu-id="8053b-173">應用程式載入的來原始目錄。</span><span class="sxs-lookup"><span data-stu-id="8053b-173">The directory from which the application loaded.</span></span>
2.  <span data-ttu-id="8053b-174">系統目錄。</span><span class="sxs-lookup"><span data-stu-id="8053b-174">The system directory.</span></span> <span data-ttu-id="8053b-175">使用 [**GetSystemDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getsystemdirectorya) 函式來取得此目錄的路徑。</span><span class="sxs-lookup"><span data-stu-id="8053b-175">Use the [**GetSystemDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getsystemdirectorya) function to get the path of this directory.</span></span>
3.  <span data-ttu-id="8053b-176">16位系統目錄。</span><span class="sxs-lookup"><span data-stu-id="8053b-176">The 16-bit system directory.</span></span> <span data-ttu-id="8053b-177">沒有可取得此目錄路徑的函式，但會進行搜尋。</span><span class="sxs-lookup"><span data-stu-id="8053b-177">There is no function that obtains the path of this directory, but it is searched.</span></span>
4.  <span data-ttu-id="8053b-178">Windows 目錄。</span><span class="sxs-lookup"><span data-stu-id="8053b-178">The Windows directory.</span></span> <span data-ttu-id="8053b-179">使用 [**GetWindowsDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getwindowsdirectorya) 函式來取得此目錄的路徑。</span><span class="sxs-lookup"><span data-stu-id="8053b-179">Use the [**GetWindowsDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getwindowsdirectorya) function to get the path of this directory.</span></span>
5.  <span data-ttu-id="8053b-180">目前的目錄。</span><span class="sxs-lookup"><span data-stu-id="8053b-180">The current directory.</span></span>
6.  <span data-ttu-id="8053b-181">PATH 環境變數中所列的目錄。</span><span class="sxs-lookup"><span data-stu-id="8053b-181">The directories that are listed in the PATH environment variable.</span></span> <span data-ttu-id="8053b-182">請注意，這不包括 **應用程式路徑** 登錄機碼所指定的每個應用程式路徑。</span><span class="sxs-lookup"><span data-stu-id="8053b-182">Note that this does not include the per-application path specified by the **App Paths** registry key.</span></span> <span data-ttu-id="8053b-183">計算 DLL 搜尋路徑時，不會使用 **應用程式路徑** 索引鍵。</span><span class="sxs-lookup"><span data-stu-id="8053b-183">The **App Paths** key is not used when computing the DLL search path.</span></span>

<span data-ttu-id="8053b-184">如果 **SafeDllSearchMode** 已停用，則搜尋順序如下所示：</span><span class="sxs-lookup"><span data-stu-id="8053b-184">If **SafeDllSearchMode** is disabled, the search order is as follows:</span></span>

1.  <span data-ttu-id="8053b-185">應用程式載入的來原始目錄。</span><span class="sxs-lookup"><span data-stu-id="8053b-185">The directory from which the application loaded.</span></span>
2.  <span data-ttu-id="8053b-186">目前的目錄。</span><span class="sxs-lookup"><span data-stu-id="8053b-186">The current directory.</span></span>
3.  <span data-ttu-id="8053b-187">系統目錄。</span><span class="sxs-lookup"><span data-stu-id="8053b-187">The system directory.</span></span> <span data-ttu-id="8053b-188">使用 [**GetSystemDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getsystemdirectorya) 函式來取得此目錄的路徑。</span><span class="sxs-lookup"><span data-stu-id="8053b-188">Use the [**GetSystemDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getsystemdirectorya) function to get the path of this directory.</span></span>
4.  <span data-ttu-id="8053b-189">16位系統目錄。</span><span class="sxs-lookup"><span data-stu-id="8053b-189">The 16-bit system directory.</span></span> <span data-ttu-id="8053b-190">沒有可取得此目錄路徑的函式，但會進行搜尋。</span><span class="sxs-lookup"><span data-stu-id="8053b-190">There is no function that obtains the path of this directory, but it is searched.</span></span>
5.  <span data-ttu-id="8053b-191">Windows 目錄。</span><span class="sxs-lookup"><span data-stu-id="8053b-191">The Windows directory.</span></span> <span data-ttu-id="8053b-192">使用 [**GetWindowsDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getwindowsdirectorya) 函式來取得此目錄的路徑。</span><span class="sxs-lookup"><span data-stu-id="8053b-192">Use the [**GetWindowsDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getwindowsdirectorya) function to get the path of this directory.</span></span>
6.  <span data-ttu-id="8053b-193">PATH 環境變數中所列的目錄。</span><span class="sxs-lookup"><span data-stu-id="8053b-193">The directories that are listed in the PATH environment variable.</span></span> <span data-ttu-id="8053b-194">請注意，這不包括 **應用程式路徑** 登錄機碼所指定的每個應用程式路徑。</span><span class="sxs-lookup"><span data-stu-id="8053b-194">Note that this does not include the per-application path specified by the **App Paths** registry key.</span></span> <span data-ttu-id="8053b-195">計算 DLL 搜尋路徑時，不會使用 **應用程式路徑** 索引鍵。</span><span class="sxs-lookup"><span data-stu-id="8053b-195">The **App Paths** key is not used when computing the DLL search path.</span></span>

### <a name="alternate-search-order-for-desktop-applications"></a><span data-ttu-id="8053b-196">桌面應用程式的替代搜尋順序</span><span class="sxs-lookup"><span data-stu-id="8053b-196">Alternate Search Order for Desktop Applications</span></span>

<span data-ttu-id="8053b-197">藉由呼叫 [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa) 函式與 **\_ 具有 \_ 改變 \_ 搜尋 \_ 路徑的載入**，即可變更系統所使用的標準搜尋順序。</span><span class="sxs-lookup"><span data-stu-id="8053b-197">The standard search order used by the system can be changed by calling the [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa) function with **LOAD\_WITH\_ALTERED\_SEARCH\_PATH**.</span></span> <span data-ttu-id="8053b-198">您也可以藉由呼叫 [**SetDllDirectory**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya) 函數來變更標準搜尋順序。</span><span class="sxs-lookup"><span data-stu-id="8053b-198">The standard search order can also be changed by calling the [**SetDllDirectory**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya) function.</span></span>

> [!NOTE]
> <span data-ttu-id="8053b-199">進程的標準搜尋順序也會受到影響，方法是在目前進程開始之前，先在父進程中呼叫 [**SetDllDirectory**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya) 函數。</span><span class="sxs-lookup"><span data-stu-id="8053b-199">The standard search order of the process will also be affected by calling the [**SetDllDirectory**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya) function in the parent process before start of the current process.</span></span>

<span data-ttu-id="8053b-200">如果您指定替代的搜尋策略，其行為會持續，直到所有相關聯的可執行檔模組都已找到為止。</span><span class="sxs-lookup"><span data-stu-id="8053b-200">If you specify an alternate search strategy, its behavior continues until all associated executable modules have been located.</span></span> <span data-ttu-id="8053b-201">系統開始處理 DLL 初始化常式之後，系統會還原為標準搜尋策略。</span><span class="sxs-lookup"><span data-stu-id="8053b-201">After the system starts processing DLL initialization routines, the system reverts to the standard search strategy.</span></span>

<span data-ttu-id="8053b-202">如果呼叫指定 **\_ 具有 \_ 改變 \_ 搜尋 \_ 路徑的載入**，而 *LpFileName* 參數指定絕對路徑，則 [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa)函式支援替代搜尋順序。</span><span class="sxs-lookup"><span data-stu-id="8053b-202">The [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa) function supports an alternate search order if the call specifies **LOAD\_WITH\_ALTERED\_SEARCH\_PATH** and the *lpFileName* parameter specifies an absolute path.</span></span>

<span data-ttu-id="8053b-203">請注意，標準搜尋策略和 [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa) 所指定的其他搜尋策略，與具有 **改變之 \_ \_ \_ 搜尋 \_ 路徑的負載有** 不同之處：標準搜尋開始于呼叫應用程式的目錄中，而替代搜尋則是在 **LoadLibraryEx** 載入的可執行模組的目錄中開始。</span><span class="sxs-lookup"><span data-stu-id="8053b-203">Note that the standard search strategy and the alternate search strategy specified by [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa) with **LOAD\_WITH\_ALTERED\_SEARCH\_PATH** differ in just one way: The standard search begins in the calling application's directory, and the alternate search begins in the directory of the executable module that **LoadLibraryEx** is loading.</span></span>

<span data-ttu-id="8053b-204">如果已啟用 **SafeDllSearchMode** ，則替代搜尋順序如下所示：</span><span class="sxs-lookup"><span data-stu-id="8053b-204">If **SafeDllSearchMode** is enabled, the alternate search order is as follows:</span></span>

1.  <span data-ttu-id="8053b-205">*LpFileName* 所指定的目錄。</span><span class="sxs-lookup"><span data-stu-id="8053b-205">The directory specified by *lpFileName*.</span></span>
2.  <span data-ttu-id="8053b-206">系統目錄。</span><span class="sxs-lookup"><span data-stu-id="8053b-206">The system directory.</span></span> <span data-ttu-id="8053b-207">使用 [**GetSystemDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getsystemdirectorya) 函式來取得此目錄的路徑。</span><span class="sxs-lookup"><span data-stu-id="8053b-207">Use the [**GetSystemDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getsystemdirectorya) function to get the path of this directory.</span></span>
3.  <span data-ttu-id="8053b-208">16位系統目錄。</span><span class="sxs-lookup"><span data-stu-id="8053b-208">The 16-bit system directory.</span></span> <span data-ttu-id="8053b-209">沒有可取得此目錄路徑的函式，但會進行搜尋。</span><span class="sxs-lookup"><span data-stu-id="8053b-209">There is no function that obtains the path of this directory, but it is searched.</span></span>
4.  <span data-ttu-id="8053b-210">Windows 目錄。</span><span class="sxs-lookup"><span data-stu-id="8053b-210">The Windows directory.</span></span> <span data-ttu-id="8053b-211">使用 [**GetWindowsDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getwindowsdirectorya) 函式來取得此目錄的路徑。</span><span class="sxs-lookup"><span data-stu-id="8053b-211">Use the [**GetWindowsDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getwindowsdirectorya) function to get the path of this directory.</span></span>
5.  <span data-ttu-id="8053b-212">目前的目錄。</span><span class="sxs-lookup"><span data-stu-id="8053b-212">The current directory.</span></span>
6.  <span data-ttu-id="8053b-213">PATH 環境變數中所列的目錄。</span><span class="sxs-lookup"><span data-stu-id="8053b-213">The directories that are listed in the PATH environment variable.</span></span> <span data-ttu-id="8053b-214">請注意，這不包括 **應用程式路徑** 登錄機碼所指定的每個應用程式路徑。</span><span class="sxs-lookup"><span data-stu-id="8053b-214">Note that this does not include the per-application path specified by the **App Paths** registry key.</span></span> <span data-ttu-id="8053b-215">計算 DLL 搜尋路徑時，不會使用 **應用程式路徑** 索引鍵。</span><span class="sxs-lookup"><span data-stu-id="8053b-215">The **App Paths** key is not used when computing the DLL search path.</span></span>

<span data-ttu-id="8053b-216">如果 **SafeDllSearchMode** 已停用，則替代搜尋順序如下所示：</span><span class="sxs-lookup"><span data-stu-id="8053b-216">If **SafeDllSearchMode** is disabled, the alternate search order is as follows:</span></span>

1.  <span data-ttu-id="8053b-217">*LpFileName* 所指定的目錄。</span><span class="sxs-lookup"><span data-stu-id="8053b-217">The directory specified by *lpFileName*.</span></span>
2.  <span data-ttu-id="8053b-218">目前的目錄。</span><span class="sxs-lookup"><span data-stu-id="8053b-218">The current directory.</span></span>
3.  <span data-ttu-id="8053b-219">系統目錄。</span><span class="sxs-lookup"><span data-stu-id="8053b-219">The system directory.</span></span> <span data-ttu-id="8053b-220">使用 [**GetSystemDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getsystemdirectorya) 函式來取得此目錄的路徑。</span><span class="sxs-lookup"><span data-stu-id="8053b-220">Use the [**GetSystemDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getsystemdirectorya) function to get the path of this directory.</span></span>
4.  <span data-ttu-id="8053b-221">16位系統目錄。</span><span class="sxs-lookup"><span data-stu-id="8053b-221">The 16-bit system directory.</span></span> <span data-ttu-id="8053b-222">沒有可取得此目錄路徑的函式，但會進行搜尋。</span><span class="sxs-lookup"><span data-stu-id="8053b-222">There is no function that obtains the path of this directory, but it is searched.</span></span>
5.  <span data-ttu-id="8053b-223">Windows 目錄。</span><span class="sxs-lookup"><span data-stu-id="8053b-223">The Windows directory.</span></span> <span data-ttu-id="8053b-224">使用 [**GetWindowsDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getwindowsdirectorya) 函式來取得此目錄的路徑。</span><span class="sxs-lookup"><span data-stu-id="8053b-224">Use the [**GetWindowsDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getwindowsdirectorya) function to get the path of this directory.</span></span>
6.  <span data-ttu-id="8053b-225">PATH 環境變數中所列的目錄。</span><span class="sxs-lookup"><span data-stu-id="8053b-225">The directories that are listed in the PATH environment variable.</span></span> <span data-ttu-id="8053b-226">請注意，這不包括 **應用程式路徑** 登錄機碼所指定的每個應用程式路徑。</span><span class="sxs-lookup"><span data-stu-id="8053b-226">Note that this does not include the per-application path specified by the **App Paths** registry key.</span></span> <span data-ttu-id="8053b-227">計算 DLL 搜尋路徑時，不會使用 **應用程式路徑** 索引鍵。</span><span class="sxs-lookup"><span data-stu-id="8053b-227">The **App Paths** key is not used when computing the DLL search path.</span></span>

<span data-ttu-id="8053b-228">如果 *lpPathName* 參數指定路徑， [**SetDllDirectory**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya)函式支援替代搜尋順序。</span><span class="sxs-lookup"><span data-stu-id="8053b-228">The [**SetDllDirectory**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya) function supports an alternate search order if the *lpPathName* parameter specifies a path.</span></span> <span data-ttu-id="8053b-229">替代搜尋順序如下所示：</span><span class="sxs-lookup"><span data-stu-id="8053b-229">The alternate search order is as follows:</span></span>

1.  <span data-ttu-id="8053b-230">應用程式載入的來原始目錄。</span><span class="sxs-lookup"><span data-stu-id="8053b-230">The directory from which the application loaded.</span></span>
2.  <span data-ttu-id="8053b-231">[**SetDllDirectory**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya)的 *lpPathName* 參數所指定的目錄。</span><span class="sxs-lookup"><span data-stu-id="8053b-231">The directory specified by the *lpPathName* parameter of [**SetDllDirectory**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya).</span></span>
3.  <span data-ttu-id="8053b-232">系統目錄。</span><span class="sxs-lookup"><span data-stu-id="8053b-232">The system directory.</span></span> <span data-ttu-id="8053b-233">使用 [**GetSystemDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getsystemdirectorya) 函式來取得此目錄的路徑。</span><span class="sxs-lookup"><span data-stu-id="8053b-233">Use the [**GetSystemDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getsystemdirectorya) function to get the path of this directory.</span></span> <span data-ttu-id="8053b-234">此目錄的名稱為 System32。</span><span class="sxs-lookup"><span data-stu-id="8053b-234">The name of this directory is System32.</span></span>
4.  <span data-ttu-id="8053b-235">16位系統目錄。</span><span class="sxs-lookup"><span data-stu-id="8053b-235">The 16-bit system directory.</span></span> <span data-ttu-id="8053b-236">沒有可取得此目錄路徑的函式，但會進行搜尋。</span><span class="sxs-lookup"><span data-stu-id="8053b-236">There is no function that obtains the path of this directory, but it is searched.</span></span> <span data-ttu-id="8053b-237">此目錄的名稱為 System。</span><span class="sxs-lookup"><span data-stu-id="8053b-237">The name of this directory is System.</span></span>
5.  <span data-ttu-id="8053b-238">Windows 目錄。</span><span class="sxs-lookup"><span data-stu-id="8053b-238">The Windows directory.</span></span> <span data-ttu-id="8053b-239">使用 [**GetWindowsDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getwindowsdirectorya) 函式來取得此目錄的路徑。</span><span class="sxs-lookup"><span data-stu-id="8053b-239">Use the [**GetWindowsDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getwindowsdirectorya) function to get the path of this directory.</span></span>
6.  <span data-ttu-id="8053b-240">PATH 環境變數中所列的目錄。</span><span class="sxs-lookup"><span data-stu-id="8053b-240">The directories that are listed in the PATH environment variable.</span></span> <span data-ttu-id="8053b-241">請注意，這不包括 **應用程式路徑** 登錄機碼所指定的每個應用程式路徑。</span><span class="sxs-lookup"><span data-stu-id="8053b-241">Note that this does not include the per-application path specified by the **App Paths** registry key.</span></span> <span data-ttu-id="8053b-242">計算 DLL 搜尋路徑時，不會使用 **應用程式路徑** 索引鍵。</span><span class="sxs-lookup"><span data-stu-id="8053b-242">The **App Paths** key is not used when computing the DLL search path.</span></span>

<span data-ttu-id="8053b-243">如果 *lpPathName* 參數是空字串，則呼叫會從搜尋順序中移除目前的目錄。</span><span class="sxs-lookup"><span data-stu-id="8053b-243">If the *lpPathName* parameter is an empty string, the call removes the current directory from the search order.</span></span>

<span data-ttu-id="8053b-244">當指定的目錄在搜尋路徑中時， [**SetDllDirectory**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya)會有效地停用安全 DLL 搜尋模式。</span><span class="sxs-lookup"><span data-stu-id="8053b-244">[**SetDllDirectory**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya) effectively disables safe DLL search mode while the specified directory is in the search path.</span></span> <span data-ttu-id="8053b-245">若要根據 **SafeDllSearchMode** 登錄值還原安全的 DLL 搜尋模式，並將目前的目錄還原到搜尋順序，請以 *lpPathName* 為 Null 來呼叫 **SetDllDirectory** 。</span><span class="sxs-lookup"><span data-stu-id="8053b-245">To restore safe DLL search mode based on the **SafeDllSearchMode** registry value and restore the current directory to the search order, call **SetDllDirectory** with *lpPathName* as NULL.</span></span>

### <a name="search-order-using-load_library_search-flags"></a><span data-ttu-id="8053b-246">使用載入連結 **\_ 庫 \_ 搜尋** 旗標搜尋順序</span><span class="sxs-lookup"><span data-stu-id="8053b-246">Search Order Using **LOAD\_LIBRARY\_SEARCH** Flags</span></span>

<span data-ttu-id="8053b-247">應用程式可以使用一或多個 **載入連結 \_ 庫 \_ 搜尋** 旗標搭配 [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa) 函式來指定搜尋順序。</span><span class="sxs-lookup"><span data-stu-id="8053b-247">An application can specify a search order by using one or more **LOAD\_LIBRARY\_SEARCH** flags with the [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa) function.</span></span> <span data-ttu-id="8053b-248">應用程式也可以使用 **載入連結 \_ 庫 \_ 搜尋** 旗標搭配 [**SetDefaultDllDirectories**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-setdefaultdlldirectories) 函式來建立進程的 DLL 搜尋順序。</span><span class="sxs-lookup"><span data-stu-id="8053b-248">An application can also use **LOAD\_LIBRARY\_SEARCH** flags with the [**SetDefaultDllDirectories**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-setdefaultdlldirectories) function to establish a DLL search order for a process.</span></span> <span data-ttu-id="8053b-249">應用程式可以使用 [**AddDllDirectory**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-adddlldirectory) 或 [**SetDllDirectory**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya) 函式，指定進程 DLL 搜尋順序的其他目錄。</span><span class="sxs-lookup"><span data-stu-id="8053b-249">The application can specify additional directories for the process DLL search order by using the [**AddDllDirectory**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-adddlldirectory) or [**SetDllDirectory**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya) functions.</span></span>

<span data-ttu-id="8053b-250">搜尋的目錄取決於使用 [**SetDefaultDllDirectories**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-setdefaultdlldirectories) 或 [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa)所指定的旗標。</span><span class="sxs-lookup"><span data-stu-id="8053b-250">The directories that are searched depend on the flags specified with [**SetDefaultDllDirectories**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-setdefaultdlldirectories) or [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa).</span></span> <span data-ttu-id="8053b-251">如果使用一個以上的旗標，則會以下列順序搜尋對應的目錄：</span><span class="sxs-lookup"><span data-stu-id="8053b-251">If more than one flag is used, the corresponding directories are searched in the following order:</span></span>

1.  <span data-ttu-id="8053b-252">包含 DLL (**載入連結 \_ 庫 \_ 搜尋 \_ dll \_ 載入 \_ 目錄**) 的目錄。</span><span class="sxs-lookup"><span data-stu-id="8053b-252">The directory that contains the DLL (**LOAD\_LIBRARY\_SEARCH\_DLL\_LOAD\_DIR**).</span></span> <span data-ttu-id="8053b-253">此目錄只會搜尋要載入之 DLL 的相依性。</span><span class="sxs-lookup"><span data-stu-id="8053b-253">This directory is searched only for dependencies of the DLL to be loaded.</span></span>
2.  <span data-ttu-id="8053b-254">應用程式目錄 (**載入連結 \_ 庫 \_ 搜尋 \_ 應用程式 \_** 目錄) 。</span><span class="sxs-lookup"><span data-stu-id="8053b-254">The application directory (**LOAD\_LIBRARY\_SEARCH\_APPLICATION\_DIR**).</span></span>
3.  <span data-ttu-id="8053b-255">使用 [**AddDllDirectory**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-adddlldirectory) 函式明確新增的路徑 (**載入連結 \_ 庫 \_ 搜尋 \_ 使用者 \_ 目錄**) 或 [**SetDllDirectory**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya) 函數。</span><span class="sxs-lookup"><span data-stu-id="8053b-255">Paths explicitly added with the [**AddDllDirectory**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-adddlldirectory) function (**LOAD\_LIBRARY\_SEARCH\_USER\_DIRS**) or the [**SetDllDirectory**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya) function.</span></span> <span data-ttu-id="8053b-256">如果新增了一個以上的路徑，則不會指定搜尋路徑的順序。</span><span class="sxs-lookup"><span data-stu-id="8053b-256">If more than one path has been added, the order in which the paths are searched is unspecified.</span></span>
4.  <span data-ttu-id="8053b-257">系統目錄 (**載入連結 \_ 庫 \_ 搜尋 \_ SYSTEM32**) 。</span><span class="sxs-lookup"><span data-stu-id="8053b-257">The System directory (**LOAD\_LIBRARY\_SEARCH\_SYSTEM32**).</span></span>

<span data-ttu-id="8053b-258">如果應用程式未使用任何 **載入連結 \_ 庫 \_ 搜尋** 旗標來呼叫 [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa) ，或建立進程的 dll 搜尋順序，系統會使用標準搜尋順序或替代搜尋順序來搜尋 dll。</span><span class="sxs-lookup"><span data-stu-id="8053b-258">If the application does not call [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa) with any **LOAD\_LIBRARY\_SEARCH** flags or establish a DLL search order for the process, the system searches for DLLs using either the standard search order or the alternate search order.</span></span>

## <a name="related-topics"></a><span data-ttu-id="8053b-259">相關主題</span><span class="sxs-lookup"><span data-stu-id="8053b-259">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="8053b-260">**AddDllDirectory**</span><span class="sxs-lookup"><span data-stu-id="8053b-260">**AddDllDirectory**</span></span>](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-adddlldirectory)
</dt> <dt>

[<span data-ttu-id="8053b-261">應用程式註冊</span><span class="sxs-lookup"><span data-stu-id="8053b-261">Application Registration</span></span>](/windows/desktop/shell/app-registration)
</dt> <dt>

[<span data-ttu-id="8053b-262">動態連結程式庫重新導向</span><span class="sxs-lookup"><span data-stu-id="8053b-262">Dynamic-Link Library Redirection</span></span>](dynamic-link-library-redirection.md)
</dt> <dt>

[<span data-ttu-id="8053b-263">動態連結程式庫安全性</span><span class="sxs-lookup"><span data-stu-id="8053b-263">Dynamic-Link Library Security</span></span>](dynamic-link-library-security.md)
</dt> <dt>

[<span data-ttu-id="8053b-264">**LoadLibrary**</span><span class="sxs-lookup"><span data-stu-id="8053b-264">**LoadLibrary**</span></span>](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya)
</dt> <dt>

[<span data-ttu-id="8053b-265">**LoadLibraryEx**</span><span class="sxs-lookup"><span data-stu-id="8053b-265">**LoadLibraryEx**</span></span>](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa)
</dt> <dt>

[<span data-ttu-id="8053b-266">**>loadpackagedlibrary**</span><span class="sxs-lookup"><span data-stu-id="8053b-266">**LoadPackagedLibrary**</span></span>](/windows/desktop/api/Winbase/nf-winbase-loadpackagedlibrary)
</dt> <dt>

[<span data-ttu-id="8053b-267">**SetDefaultDllDirectories**</span><span class="sxs-lookup"><span data-stu-id="8053b-267">**SetDefaultDllDirectories**</span></span>](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-setdefaultdlldirectories)
</dt> <dt>

[<span data-ttu-id="8053b-268">**SetDllDirectory**</span><span class="sxs-lookup"><span data-stu-id="8053b-268">**SetDllDirectory**</span></span>](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya)
</dt> <dt>

[<span data-ttu-id="8053b-269">並存元件</span><span class="sxs-lookup"><span data-stu-id="8053b-269">Side-by-side Components</span></span>](/windows/desktop/SbsCs/isolated-applications-and-side-by-side-assemblies-portal)
</dt> </dl>

 

 