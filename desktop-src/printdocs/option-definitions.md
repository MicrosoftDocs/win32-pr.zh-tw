---
description: 瞭解 PrintCapabilities 架構中的選項定義。 本主題並非最新的。 如需最新資訊，請參閱列印架構規格。
ms.assetid: e81068db-ab8e-420c-a0be-93bc92f3df6f
title: 選項定義
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: fdc7dddb4840de8bc91c7f9ab127fd31319e5399
ms.sourcegitcommit: 998d50f6def8a25850fc113fc8a2df903c829c5e
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 07/09/2021
ms.locfileid: "113549366"
---
# <a name="option-definitions"></a><span data-ttu-id="417b7-105">選項定義</span><span class="sxs-lookup"><span data-stu-id="417b7-105">Option Definitions</span></span>

<span data-ttu-id="417b7-106">本主題並非最新的。</span><span class="sxs-lookup"><span data-stu-id="417b7-106">This topic is not current.</span></span> <span data-ttu-id="417b7-107">如需最新資訊，請參閱 [列印架構規格](https://download.microsoft.com/download/D/E/C/DECA6E6B-3E81-48E7-B7EF-6D92A547D03C/print-schema-spec-2-0.zip)。</span><span class="sxs-lookup"><span data-stu-id="417b7-107">For the most current information, see the [Print Schema Specification](https://download.microsoft.com/download/D/E/C/DECA6E6B-3E81-48E7-B7EF-6D92A547D03C/print-schema-spec-2-0.zip).</span></span>

<span data-ttu-id="417b7-108">當您定義選項時，最重要的考慮就是這麼做，因為它可以有意義的方式，相較于相同功能中包含的其他選項實例。</span><span class="sxs-lookup"><span data-stu-id="417b7-108">The key consideration when you define an Option is to do so in such a way that it can be meaningfully compared to other Option instances contained in the same Feature.</span></span> <span data-ttu-id="417b7-109">比較必須有意義，因為選項實例是用來定義不只是裝置的設定，而不是與用於建立設定的裝置或 PrintCapabilities 無關的工作。</span><span class="sxs-lookup"><span data-stu-id="417b7-109">The comparison must be meaningful because the Option instance is used to define the configuration not just of the device, but of the job, independent of the device or PrintCapabilities that were used to create the configuration.</span></span> <span data-ttu-id="417b7-110">這項功能中的其他選項實例可能會出現在相同的 PrintCapabilities 檔中，或是另一個代表不同裝置的 PrintCapabilities 檔中，另一個合作物件所定義的 PrintCapabilities 檔會獨立運作。</span><span class="sxs-lookup"><span data-stu-id="417b7-110">The other Option instances in the Feature can appear either in the same PrintCapabilities document, or in another PrintCapabilities document that represents a different device, a PrintCapabilities document that is defined by another party working independently.</span></span> <span data-ttu-id="417b7-111">在用戶端選取用來轉譯作業或檔的裝置設定之後，通常會以 PrintTicket 的形式儲存該設定以及作業或檔。</span><span class="sxs-lookup"><span data-stu-id="417b7-111">After a client selects the device configuration to be used to render a job or document, that configuration typically is saved, along with the job or document, in the form of a PrintTicket.</span></span> <span data-ttu-id="417b7-112">PrintTicket 包含一組選項實例，通常是 PrintCapabilities 檔中所定義之每項功能的一組。</span><span class="sxs-lookup"><span data-stu-id="417b7-112">The PrintTicket contains a set of Option instances, typically one for each Feature defined in the PrintCapabilities document.</span></span> <span data-ttu-id="417b7-113">選項實例必須是可移植的，而且必須保留列印意圖，如此一來，當這個 PrintTicket 提供給不同的裝置時，就可以傳達意圖，即使有不同的作者所撰寫的不同 PrintCapabilities 檔也是如此。</span><span class="sxs-lookup"><span data-stu-id="417b7-113">Option instances must be portable and must preserve printing intent, so that the intent can be communicated when this PrintTicket is given to a different device, even one that has a different PrintCapabilities document that was written by a different author.</span></span> <span data-ttu-id="417b7-114">這種可攜性的主要優點是，如果不同的裝置並未特別支援 PrintTicket 中包含的選項，設備磁碟機或子系統就能識別並選取最接近功能的選項。</span><span class="sxs-lookup"><span data-stu-id="417b7-114">The primary benefit of this portability is that if a different device does not specifically support an Option contained in the PrintTicket, the device driver or subsystem is able to identify and select the Option that is the closest in functionality.</span></span>

<span data-ttu-id="417b7-115">其中一個驅動程式的主要 PrintTicket 函數是識別 PrintCapabilities 檔中最符合 PrintTicket 所列特定選項的 [裝置] 選項。</span><span class="sxs-lookup"><span data-stu-id="417b7-115">One of the driver's main PrintTicket functions is to identify the device Option in the PrintCapabilities document that most closely matches a particular Option listed in the PrintTicket.</span></span> <span data-ttu-id="417b7-116">在這個比對或設備磁碟機定義評分程式期間，PrintTicket 中的選項稱為 *參考* 選項，而 PrintCapabilities 檔中的選項則稱為 *候選* 選項。</span><span class="sxs-lookup"><span data-stu-id="417b7-116">During this matching or device driver defined scoring process, the Option in the PrintTicket is referred to as the *reference* Option, while the Option in the PrintCapabilities document is referred to as the *candidate* Option.</span></span> <span data-ttu-id="417b7-117">一般比對度量是候選和參考選項實例中相符的 ScoredProperty 實例數目;較多的相符專案通常表示較妥善保留列印意圖。</span><span class="sxs-lookup"><span data-stu-id="417b7-117">The general matching metric is the number of matching ScoredProperty instances in the candidate and reference Option instances; a greater number of matches usually indicates better preservation of printing intent.</span></span> <span data-ttu-id="417b7-118">在您的評分流程中，您可能會選擇對某些 ScoredProperty 元素提供較高的權數，而非其他專案。</span><span class="sxs-lookup"><span data-stu-id="417b7-118">In your scoring process you might choose to give greater weight to some ScoredProperty elements than to others.</span></span>

<span data-ttu-id="417b7-119">您可以藉由確保屬於相同功能的所有選項實例都有一個或多個 ScoredProperty *元素*，讓您可以移植選項實例。</span><span class="sxs-lookup"><span data-stu-id="417b7-119">You can make Option instances portable by ensuring that all Option instances that belong to the same Feature have one or more ScoredProperty *elements in common*.</span></span> <span data-ttu-id="417b7-120">這表示每個選項實例中都會出現一組 ScoredProperty 元素， (屬於相同的功能) 。</span><span class="sxs-lookup"><span data-stu-id="417b7-120">This means that there is a set of ScoredProperty elements that appears in every Option instance (belonging to the same Feature).</span></span> <span data-ttu-id="417b7-121">例如，如果每個選項實例都包含定義內建 PageMediaSize 屬性的 ScoredProperty 元素，則 PageMediaSize 功能的選項實例可以是可移植的： MediaSizeWidth 和 MediaSizeHeight。</span><span class="sxs-lookup"><span data-stu-id="417b7-121">For example, Option instances for the PageMediaSize Feature can be portable if every Option instance contains ScoredProperty elements that define the intrinsic PageMediaSize properties: MediaSizeWidth and MediaSizeHeight.</span></span> <span data-ttu-id="417b7-122">然後，設備磁碟機或子系統程式碼可以藉由比較這些 ScoredProperty 值的差異來判斷兩個選項實例的同意程度。</span><span class="sxs-lookup"><span data-stu-id="417b7-122">The device driver or subsystem code can then determine how closely two Option instances agree by comparing the differences in these ScoredProperty values.</span></span> <span data-ttu-id="417b7-123">如果 PrintCapabilities 檔中沒有完全符合 PrintTicket 中的選項，設備磁碟機可以輕鬆地判斷並選取具有最相符媒體維度的選項。</span><span class="sxs-lookup"><span data-stu-id="417b7-123">If there is no Option in the PrintCapabilities document that exactly matches the one in the PrintTicket, the device driver can easily determine and select the Option that has the closest matching media dimensions.</span></span>

<span data-ttu-id="417b7-124">在此情況下， (選項實例的兩個物件) 說，如果滿足下列三個條件，就會有 *相同* 的專案，或同等 *的元素。*</span><span class="sxs-lookup"><span data-stu-id="417b7-124">Two objects (Option instances in this case) are said to have *elements in common*, or equivalently, have *corresponding elements*, if the following three conditions are satisfied.</span></span>

1.  <span data-ttu-id="417b7-125">這兩個元素屬於相同的元素類型。</span><span class="sxs-lookup"><span data-stu-id="417b7-125">The two elements are of the same element type.</span></span>

2.  <span data-ttu-id="417b7-126">這兩個元素的 name 屬性相同 (或兩個專案都不包含名稱屬性) 。</span><span class="sxs-lookup"><span data-stu-id="417b7-126">The name attributes of the two elements are identical (or neither element contains a name attribute).</span></span>

3.  <span data-ttu-id="417b7-127">要比較之元素的父系鏈（由所考慮的兩個物件）必須滿足條件1和2。</span><span class="sxs-lookup"><span data-stu-id="417b7-127">The chain of parents of the elements being compared, up through the two objects under consideration, must satisfy conditions 1 and 2.</span></span>

<span data-ttu-id="417b7-128">例如，假設有兩個選項實例，其中每個都包含一個 ScoredProperty 實例，而且每個 ScoredProperty 實例都包含一個屬性實例。</span><span class="sxs-lookup"><span data-stu-id="417b7-128">For example, consider a situation in which there are two Option instances, where each contains a ScoredProperty instance, and that each of these ScoredProperty instances contains a Property instance.</span></span> <span data-ttu-id="417b7-129">明確地說，第一個條件的滿足 (兩個屬性實例的類型) 相同，而第三個條件的一部分符合 (屬性實例的父系是相同類型 ScoredProperty，而這些專案的父系也是相同類型) 的選項實例。</span><span class="sxs-lookup"><span data-stu-id="417b7-129">Clearly, the first condition is satisfied (the two Property instances are the same type), and part of the third condition is satisfied (the parents of the Property instances are the same type, ScoredProperty, and the parents of those elements are the Option instances, which are also of the same type).</span></span> <span data-ttu-id="417b7-130">如果分別是屬性實例、ScoredProperty 實例和選項實例的名稱屬性，則兩個選項實例都有共通的元素。</span><span class="sxs-lookup"><span data-stu-id="417b7-130">If the name attributes of, respectively, the Property instances, the ScoredProperty instances, and the Option instances are either identical or are not supplied, the two Option instances have elements in common.</span></span>

<span data-ttu-id="417b7-131">上述步驟中，建立選項實例的第一個步驟是定義一組存在於大部分或所有選項實例中的 ScoredProperty 元素。</span><span class="sxs-lookup"><span data-stu-id="417b7-131">From the foregoing, the first step in creating Option instances is to define a set of ScoredProperty elements that are present in most or all of the Option instances.</span></span> <span data-ttu-id="417b7-132">如果您的裝置設定屬性可以用標準功能表示， ([列印架構關鍵字]) 中所列的專案，請注意標準選項實例中常見的 ScoredProperty 元素。</span><span class="sxs-lookup"><span data-stu-id="417b7-132">If your device configuration attribute can be represented by a standard Feature (one listed in the Print Schema Keywords), note the ScoredProperty elements in common in the standard Option instances.</span></span> <span data-ttu-id="417b7-133">您應確定您引入的任何新選項實例也都包含這些 ScoredProperty 元素。</span><span class="sxs-lookup"><span data-stu-id="417b7-133">You should ensure that any new Option instances that you introduce also contain these ScoredProperty elements.</span></span> <span data-ttu-id="417b7-134">您隨時都可以視需要新增其他 ScoredProperty 元素，以區分您的選項實例與標準選項實例。</span><span class="sxs-lookup"><span data-stu-id="417b7-134">You are always free to add additional ScoredProperty elements as needed to differentiate your Option instances from the standard Option instances.</span></span> <span data-ttu-id="417b7-135">如果有原因，您甚至可能會刪除一或多個常見的 ScoredProperty 元素，雖然這樣可以減少這類選項的可攜性。</span><span class="sxs-lookup"><span data-stu-id="417b7-135">You may even delete one or more of the ScoredProperty elements in common if there is good reason, although that reduces the portability of such an Option.</span></span> <span data-ttu-id="417b7-136">當然，可攜性考慮建議使用未修改的標準選項實例，除非您的選項與標準選項實例之間有一些內部差異，而且必須反映在新的選項實例中。</span><span class="sxs-lookup"><span data-stu-id="417b7-136">Of course, portability considerations suggest using the unmodified standard Option instances unless there is some intrinsic difference between your Option and the standard Option instance that must be reflected in the new Option instance.</span></span>

<span data-ttu-id="417b7-137">下列範例說明您可能想要將 ScoredProperty 元素加入至選項實例的情況。</span><span class="sxs-lookup"><span data-stu-id="417b7-137">The following example illustrates a situation for which you might wish to add a ScoredProperty element to an Option instance.</span></span> <span data-ttu-id="417b7-138">PageMediaSize 功能的所有標準選項實例都有共同的 MediaSizeWidth 和 MediaSizeHeight ScoredProperty 元素。</span><span class="sxs-lookup"><span data-stu-id="417b7-138">All of the standard Option instances for the PageMediaSize Feature have the MediaSizeWidth and MediaSizeHeight ScoredProperty elements in common.</span></span> <span data-ttu-id="417b7-139">假設您的裝置可以透過將紙張 transversely (LongEdgeFirst) 或 longitudinally (ShortEdgeFirst) ，來支援其中一種標準信件媒體大小。</span><span class="sxs-lookup"><span data-stu-id="417b7-139">Suppose that your device can support one of the standard Letter media sizes by feeding the paper either transversely (LongEdgeFirst) or longitudinally (ShortEdgeFirst).</span></span> <span data-ttu-id="417b7-140">假設您不想要引入新的摘要方向功能來公開這種程度的自由度，可以改為修改字母的兩個 PageMediaSize 選項實例，以納入紙紙方向。</span><span class="sxs-lookup"><span data-stu-id="417b7-140">Assuming that you do not wish to introduce a new feed direction Feature to expose this degree of freedom, you can instead modify the two PageMediaSize Option instances for Letter to incorporate the paper feed orientation.</span></span> <span data-ttu-id="417b7-141">針對這兩個字母選項實例，請從標準 PageMediaSize 選項實例開始，然後加入新的 ScoredProperty 專案來代表 FeedDirection。</span><span class="sxs-lookup"><span data-stu-id="417b7-141">For these two Letter Option instances, start with the standard PageMediaSize Option instance and add a new ScoredProperty element to represent the FeedDirection.</span></span> <span data-ttu-id="417b7-142">在一個選項實例中，將 FeedDirection ScoredProperty 設定為 LongEdgeFirst;在另一個選項實例中，將 FeedDirection 設定為 ShortEdgeFirst。</span><span class="sxs-lookup"><span data-stu-id="417b7-142">In one Option instance, set the FeedDirection ScoredProperty to LongEdgeFirst; in the other Option instance, set FeedDirection to ShortEdgeFirst.</span></span> <span data-ttu-id="417b7-143">請注意，這些新的選項實例會維持其可攜性。</span><span class="sxs-lookup"><span data-stu-id="417b7-143">Notice that these new Option instances maintain their portability.</span></span> <span data-ttu-id="417b7-144">如果代表字母的選項，ShortEdgeFirst 會儲存至 PrintTicket，而選取的不同裝置僅支援字母標準選項，以轉譯作業，選項比對程式碼可以快速判斷標準選項字母是否最符合選項字母、ShortEdgeFirst。</span><span class="sxs-lookup"><span data-stu-id="417b7-144">If the Option representing Letter, ShortEdgeFirst is saved to a PrintTicket and a different device that supports only the Letter standard Option is selected to render the Job, the Option-matching code can quickly determine that the standard Option Letter is the best match to the Option Letter, ShortEdgeFirst.</span></span> <span data-ttu-id="417b7-145">這是最符合的原因，就是所有的 ScoredProperty 實例都同意，但不存在於字母標準選項中的 FeedDirection ScoredProperty 除外。</span><span class="sxs-lookup"><span data-stu-id="417b7-145">The reason that this is the best match is that all of the ScoredProperty instances agree, with the exception of the FeedDirection ScoredProperty, which does not exist in the Letter standard Option.</span></span>

<span data-ttu-id="417b7-146">您也可能會遇到選項的修改實際變更意義，因此修改過的選項不會再被視為原始案例的特殊情況。</span><span class="sxs-lookup"><span data-stu-id="417b7-146">You might also encounter cases where the modifications to the Option actually change the meaning so much that the modified Option can no longer be considered a specialized case of the original.</span></span> <span data-ttu-id="417b7-147">在這種情況下，您應該變更選項的名稱，以反映修改過的選項實例與未修改的選項實例之間的差異。</span><span class="sxs-lookup"><span data-stu-id="417b7-147">In such cases, you should change the name of the Option to reflect the difference between the modified Option instance and the unmodified one.</span></span> <span data-ttu-id="417b7-148">只有特定裝置的 PrintCapabilities 檔作者可以決定裝置所提供的選項是否與標準選項實例有足夠的差異，以保證不相容的定義。</span><span class="sxs-lookup"><span data-stu-id="417b7-148">Only the author of the PrintCapabilities document for a particular device can decide whether the Option offered by the device differs sufficiently from a standard Option instance to warrant an incompatible definition.</span></span>

<span data-ttu-id="417b7-149">現在請考慮您裝置的裝置設定屬性未對應到任何標準功能實例的情況。</span><span class="sxs-lookup"><span data-stu-id="417b7-149">Now consider the case where your device has a device configuration attribute that does not correspond to any of the standard Feature instances.</span></span> <span data-ttu-id="417b7-150">在此情況下，您不能依賴標準選項實例來提供共同 ScoredProperty 元素的清單。</span><span class="sxs-lookup"><span data-stu-id="417b7-150">In this case you cannot rely on the standard Option instances to provide the list of ScoredProperty elements in common.</span></span> <span data-ttu-id="417b7-151">當您建立 ScoredProperty 實例時，您的主要目標是要區分功能中其他選項的每個選項，並說明為何使用者會選擇另一個選項。</span><span class="sxs-lookup"><span data-stu-id="417b7-151">When you create a ScoredProperty instance, your main objective is to differentiate each Option from the others in the Feature, and describe why a user would select one Option over another.</span></span> <span data-ttu-id="417b7-152">基準是以唯一的 name 屬性來描述每個選項，而且保存 name 屬性的 ScoredProperty 會變成用來判斷通用元素的。</span><span class="sxs-lookup"><span data-stu-id="417b7-152">The baseline is to characterize each Option with a unique name attribute, and the ScoredProperty that holds the name attribute becomes the one used for determining elements in common.</span></span>

<span data-ttu-id="417b7-153">一旦建立了一組共通的 ScoredProperty 元素之後，將適當的值指派給每個 ScoredProperty，以建立每個選項是很簡單的事。</span><span class="sxs-lookup"><span data-stu-id="417b7-153">After a set of ScoredProperty elements in common has been established, it is a simple matter to assign appropriate values to each ScoredProperty to create each Option.</span></span> <span data-ttu-id="417b7-154">如同上述範例，針對特定的選項實例，您可能需要新增其他 ScoredProperty 實例，或刪除一些通用的元素，以建立適當的選項實例。</span><span class="sxs-lookup"><span data-stu-id="417b7-154">As in the previous example, for certain Option instances, you might need to add additional ScoredProperty instances or delete some of the elements in common to create an appropriate Option instance.</span></span>

<span data-ttu-id="417b7-155">請注意，列印架構會要求 ScoredProperty 實例、其位置以及指派給選項中每個 ScoredProperty 的值，都必須保持不變，而不受設定影響。</span><span class="sxs-lookup"><span data-stu-id="417b7-155">It should be noted that the Print Schema requires that the set of ScoredProperty instances, their locations, and the values assigned to each ScoredProperty in an Option must remain constant, independent of the configuration.</span></span> <span data-ttu-id="417b7-156">列印架構的整個概念依賴選項實例，這些實例具有在許多裝置間共用的固定、可辨識的屬性和 ScoredProperty 實例。</span><span class="sxs-lookup"><span data-stu-id="417b7-156">The entire concept of the Print Schema relies on Option instances having fixed, identifiable Property and ScoredProperty instances that are shared across many devices.</span></span>

## <a name="related-topics"></a><span data-ttu-id="417b7-157">相關主題</span><span class="sxs-lookup"><span data-stu-id="417b7-157">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="417b7-158">列印架構規格</span><span class="sxs-lookup"><span data-stu-id="417b7-158">Print Schema Specification</span></span>](https://download.microsoft.com/download/D/E/C/DECA6E6B-3E81-48E7-B7EF-6D92A547D03C/print-schema-spec-2-0.zip)
</dt> </dl>

 

 



