---
description: DocumentEvent 函數是與列印檔案相關聯之事件的事件處理常式。
ms.assetid: 1250116e-55c7-470f-97f6-36f27a31a841
title: 'DocumentEvent 函式 (Winspool.drv) '
ms.topic: reference
ms.date: 05/31/2018
topic_type:
- APIRef
- kbSyntax
api_name:
- DocumentEvent
- DocumentEventA
- DocumentEventW
api_type:
- HeaderDef
api_location:
- Winspool.h
ms.openlocfilehash: aa80e5fe17047eceacdc30e2a40a4a629088d89f
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/07/2021
ms.locfileid: "104513333"
---
# <a name="documentevent-function"></a><span data-ttu-id="1c884-103">DocumentEvent 函式</span><span class="sxs-lookup"><span data-stu-id="1c884-103">DocumentEvent function</span></span>

<span data-ttu-id="1c884-104">**DocumentEvent** 函數是與列印檔案相關聯之事件的事件處理常式。</span><span class="sxs-lookup"><span data-stu-id="1c884-104">The **DocumentEvent** function is an event handler for events associated with printing a document.</span></span>

## <a name="syntax"></a><span data-ttu-id="1c884-105">語法</span><span class="sxs-lookup"><span data-stu-id="1c884-105">Syntax</span></span>


```C++
HRESULT DocumentEvent(
  _In_  HANDLE hPrinter,
  _In_  HDC    hdc,
        INT    iEsc,
        ULONG  cbIn,
  _In_  PVOID  pvIn,
        ULONG  cbOut,
  _Out_ PVOID  pvOut
);
```



## <a name="parameters"></a><span data-ttu-id="1c884-106">參數</span><span class="sxs-lookup"><span data-stu-id="1c884-106">Parameters</span></span>

<dl> <dt>

<span data-ttu-id="1c884-107">*hPrinter* \[在\]</span><span class="sxs-lookup"><span data-stu-id="1c884-107">*hPrinter* \[in\]</span></span>
</dt> <dd>

<span data-ttu-id="1c884-108">印表機物件的控制碼。</span><span class="sxs-lookup"><span data-stu-id="1c884-108">A handle to a printer object.</span></span> <span data-ttu-id="1c884-109">使用 [**OpenPrinter**](openprinter.md) 或 [**interactivesession.addprinter**](addprinter.md) 函式來取出印表機控制碼。</span><span class="sxs-lookup"><span data-stu-id="1c884-109">Use the [**OpenPrinter**](openprinter.md) or [**AddPrinter**](addprinter.md) function to retrieve a printer handle.</span></span>

</dd> <dt>

<span data-ttu-id="1c884-110">*hdc* \[在\]</span><span class="sxs-lookup"><span data-stu-id="1c884-110">*hdc* \[in\]</span></span>
</dt> <dd>

<span data-ttu-id="1c884-111">由呼叫 [**CreateDC**](/windows/desktop/api/wingdi/nf-wingdi-createdca)所產生的裝置內容控制碼。</span><span class="sxs-lookup"><span data-stu-id="1c884-111">A device context handle that is generated by a call of [**CreateDC**](/windows/desktop/api/wingdi/nf-wingdi-createdca).</span></span> <span data-ttu-id="1c884-112">如果 *iEsc* 設為 DOCUMENTEVENT CREATEDCPRE，則為零 \_ 。</span><span class="sxs-lookup"><span data-stu-id="1c884-112">This is zero if *iEsc* is set to DOCUMENTEVENT\_CREATEDCPRE.</span></span> <span data-ttu-id="1c884-113">如需在64位版本的 Windows 上從32位應用程式列印的限制，請參閱備註。</span><span class="sxs-lookup"><span data-stu-id="1c884-113">For restrictions on printing from a 32-bit application on a 64-bit version of Windows, see Remarks.</span></span>

</dd> <dt>

<span data-ttu-id="1c884-114">*iEsc*</span><span class="sxs-lookup"><span data-stu-id="1c884-114">*iEsc*</span></span> 
</dt> <dd>

<span data-ttu-id="1c884-115">用來識別要處理之事件的轉義碼。</span><span class="sxs-lookup"><span data-stu-id="1c884-115">An escape code that identifies the event to be handled.</span></span> <span data-ttu-id="1c884-116">這個參數可以是下列其中一個整數常數。</span><span class="sxs-lookup"><span data-stu-id="1c884-116">This parameter can be one of the following integer constants.</span></span>



| <span data-ttu-id="1c884-117">常數</span><span class="sxs-lookup"><span data-stu-id="1c884-117">Constant</span></span>                                                                                                                                                                                                                                                                                                                                               | <span data-ttu-id="1c884-118">事件</span><span class="sxs-lookup"><span data-stu-id="1c884-118">Event</span></span>                                                                                                                                                                                                                                                                                                           |
|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span id="DOCUMENTEVENT_ABORTDOC"></span><span id="documentevent_abortdoc"></span><dl> <span data-ttu-id="1c884-119"><dt>**DOCUMENTEVENT \_ ABORTDOC**</dt></span><span class="sxs-lookup"><span data-stu-id="1c884-119"><dt>**DOCUMENTEVENT\_ABORTDOC**</dt></span></span> </dl>                                                                                                                                                               | <span data-ttu-id="1c884-120">GDI 即將處理其 [**AbortDoc**](/windows/desktop/api/Wingdi/nf-wingdi-abortdoc) 函式的呼叫。</span><span class="sxs-lookup"><span data-stu-id="1c884-120">GDI is about to process a call to its [**AbortDoc**](/windows/desktop/api/Wingdi/nf-wingdi-abortdoc) function.</span></span><br/>                                                                                                                                                                                                                         |
| <span id="DOCUMENTEVENT_CREATEDCPOST"></span><span id="documentevent_createdcpost"></span><dl> <span data-ttu-id="1c884-121"><dt>**DOCUMENTEVENT \_ CREATEDCPOST**</dt></span><span class="sxs-lookup"><span data-stu-id="1c884-121"><dt>**DOCUMENTEVENT\_CREATEDCPOST**</dt></span></span> </dl>                                                                                                                                                   | <span data-ttu-id="1c884-122">GDI 剛剛處理過其 [**CreateDC**](/windows/desktop/api/wingdi/nf-wingdi-createdca) 或 [**CreateIC**](/windows/desktop/api/wingdi/nf-wingdi-createica) 函數的呼叫。</span><span class="sxs-lookup"><span data-stu-id="1c884-122">GDI has just processed a call to its [**CreateDC**](/windows/desktop/api/wingdi/nf-wingdi-createdca) or [**CreateIC**](/windows/desktop/api/wingdi/nf-wingdi-createica) function.</span></span><br/> <span data-ttu-id="1c884-123">除非先前已呼叫 **DocumentEvent** 並將 *IESC* 設為 DocumentEvent CREATEDCPRE，否則不應使用此 escape 程式碼 \_ 。</span><span class="sxs-lookup"><span data-stu-id="1c884-123">This escape code should not be used unless there has been a previous call to **DocumentEvent** with *iEsc* set to DOCUMENTEVENT\_CREATEDCPRE.</span></span><br/>                                 |
| <span id="DOCUMENTEVENT_CREATEDCPRE"></span><span id="documentevent_createdcpre"></span><dl> <span data-ttu-id="1c884-124"><dt>**DOCUMENTEVENT \_ CREATEDCPRE**</dt></span><span class="sxs-lookup"><span data-stu-id="1c884-124"><dt>**DOCUMENTEVENT\_CREATEDCPRE**</dt></span></span> </dl>                                                                                                                                                      | <span data-ttu-id="1c884-125">GDI 即將處理其 [**CreateDC**](/windows/desktop/api/wingdi/nf-wingdi-createdca) 或 [**CreateIC**](/windows/desktop/api/wingdi/nf-wingdi-createica) 函數的呼叫。</span><span class="sxs-lookup"><span data-stu-id="1c884-125">GDI is about to process a call to its [**CreateDC**](/windows/desktop/api/wingdi/nf-wingdi-createdca) or [**CreateIC**](/windows/desktop/api/wingdi/nf-wingdi-createica) function.</span></span><br/>                                                                                                                                                                                         |
| <span id="DOCUMENTEVENT_DELETEDC"></span><span id="documentevent_deletedc"></span><dl> <span data-ttu-id="1c884-126"><dt>**DOCUMENTEVENT \_ DELETEDC**</dt></span><span class="sxs-lookup"><span data-stu-id="1c884-126"><dt>**DOCUMENTEVENT\_DELETEDC**</dt></span></span> </dl>                                                                                                                                                               | <span data-ttu-id="1c884-127">GDI 即將處理其 [**DeleteDC**](/windows/desktop/api/wingdi/nf-wingdi-deletedc) 函式的呼叫。</span><span class="sxs-lookup"><span data-stu-id="1c884-127">GDI is about to process a call to its [**DeleteDC**](/windows/desktop/api/wingdi/nf-wingdi-deletedc) function.</span></span><br/>                                                                                                                                                                                                                         |
| <span id="DOCUMENTEVENT_ENDDOCPOST"></span><span id="documentevent_enddocpost"></span><dl> <span data-ttu-id="1c884-128"><dt>**DOCUMENTEVENT \_ ENDDOCPOST**</dt></span><span class="sxs-lookup"><span data-stu-id="1c884-128"><dt>**DOCUMENTEVENT\_ENDDOCPOST**</dt></span></span> </dl>                                                                                                                                                         | <span data-ttu-id="1c884-129">GDI 剛剛已處理其 [**EndDoc**](/windows/desktop/api/Wingdi/nf-wingdi-enddoc) 函式的呼叫。</span><span class="sxs-lookup"><span data-stu-id="1c884-129">GDI has just processed a call to its [**EndDoc**](/windows/desktop/api/Wingdi/nf-wingdi-enddoc) function.</span></span><br/>                                                                                                                                                                                                                              |
| <span id="DOCUMENTEVENT_ENDDOCPRE_or_DOCUMENTEVENT_ENDDOC"></span><span id="documentevent_enddocpre_or_documentevent_enddoc"></span><span id="DOCUMENTEVENT_ENDDOCPRE_OR_DOCUMENTEVENT_ENDDOC"></span><dl> <span data-ttu-id="1c884-130"><dt>**DOCUMENTEVENT \_ ENDDOCPRE 或 DOCUMENTEVENT \_ ENDDOC**</dt></span><span class="sxs-lookup"><span data-stu-id="1c884-130"><dt>**DOCUMENTEVENT\_ENDDOCPRE or DOCUMENTEVENT\_ENDDOC**</dt></span></span> </dl>                 | <span data-ttu-id="1c884-131">GDI 即將處理其 [**EndDoc**](/windows/desktop/api/Wingdi/nf-wingdi-enddoc) 函式的呼叫。</span><span class="sxs-lookup"><span data-stu-id="1c884-131">GDI is about to process a call to its [**EndDoc**](/windows/desktop/api/Wingdi/nf-wingdi-enddoc) function.</span></span><br/>                                                                                                                                                                                                                             |
| <span id="DOCUMENTEVENT_ENDPAGE"></span><span id="documentevent_endpage"></span><dl> <span data-ttu-id="1c884-132"><dt>**DOCUMENTEVENT \_ ENDPAGE**</dt></span><span class="sxs-lookup"><span data-stu-id="1c884-132"><dt>**DOCUMENTEVENT\_ENDPAGE**</dt></span></span> </dl>                                                                                                                                                                  | <span data-ttu-id="1c884-133">GDI 即將處理其 [**EndPage**](/windows/desktop/api/Wingdi/nf-wingdi-endpage) 函式的呼叫。</span><span class="sxs-lookup"><span data-stu-id="1c884-133">GDI is about to process a call to its [**EndPage**](/windows/desktop/api/Wingdi/nf-wingdi-endpage) function.</span></span><br/>                                                                                                                                                                                                                           |
| <span id="DOCUMENTEVENT_ESCAPE"></span><span id="documentevent_escape"></span><dl> <span data-ttu-id="1c884-134"><dt>**DOCUMENTEVENT \_ ESCAPE**</dt></span><span class="sxs-lookup"><span data-stu-id="1c884-134"><dt>**DOCUMENTEVENT\_ESCAPE**</dt></span></span> </dl>                                                                                                                                                                     | <span data-ttu-id="1c884-135">GDI 即將處理其 [**ExtEscape**](/windows/desktop/api/Wingdi/nf-wingdi-extescape) 函式的呼叫。</span><span class="sxs-lookup"><span data-stu-id="1c884-135">GDI is about to process a call to its [**ExtEscape**](/windows/desktop/api/Wingdi/nf-wingdi-extescape) function.</span></span><br/>                                                                                                                                                                                                                       |
| <span id="DOCUMENTEVENT_QUERYFILTER"></span><span id="documentevent_queryfilter"></span><dl> <span data-ttu-id="1c884-136"><dt>**DOCUMENTEVENT \_ QUERYFILTER**</dt></span><span class="sxs-lookup"><span data-stu-id="1c884-136"><dt>**DOCUMENTEVENT\_QUERYFILTER**</dt></span></span> </dl>                                                                                                                                                      | <span data-ttu-id="1c884-137">DOCUMENTEVENT \_ QUERYFILTER 事件代表一個機會，讓多工緩衝處理器查詢驅動程式，以取得 \_ 驅動程式將回應的 DOCUMENTEVENT *XXX* 事件清單。</span><span class="sxs-lookup"><span data-stu-id="1c884-137">The DOCUMENTEVENT\_QUERYFILTER event represents an opportunity for the spooler to query the driver for a list of the DOCUMENTEVENT\_ *XXX* events to which the driver will respond.</span></span> <span data-ttu-id="1c884-138">此事件會在呼叫傳遞 DOCUMENTEVENT CREATEDCPRE 事件的 **DocumentEvent** 之前發出 \_ 。</span><span class="sxs-lookup"><span data-stu-id="1c884-138">This event is issued just prior to a call to **DocumentEvent** that passes the DOCUMENTEVENT\_CREATEDCPRE event.</span></span><br/> |
| <span id="DOCUMENTEVENT_RESETDCPOST"></span><span id="documentevent_resetdcpost"></span><dl> <span data-ttu-id="1c884-139"><dt>**DOCUMENTEVENT \_ RESETDCPOST**</dt></span><span class="sxs-lookup"><span data-stu-id="1c884-139"><dt>**DOCUMENTEVENT\_RESETDCPOST**</dt></span></span> </dl>                                                                                                                                                      | <span data-ttu-id="1c884-140">GDI 剛剛已處理其 [**ResetDC**](/windows/desktop/api/wingdi/nf-wingdi-resetdca) 函式的呼叫。</span><span class="sxs-lookup"><span data-stu-id="1c884-140">GDI has just processed a call to its [**ResetDC**](/windows/desktop/api/wingdi/nf-wingdi-resetdca) function.</span></span><br/> <span data-ttu-id="1c884-141">除非先前已呼叫 **DocumentEvent** 並將 *IESC* 設為 DocumentEvent RESETDCPRE，否則不應使用此 escape 程式碼 \_ 。</span><span class="sxs-lookup"><span data-stu-id="1c884-141">This escape code should not be used unless there has been a previous call to **DocumentEvent** with *iEsc* set to DOCUMENTEVENT\_RESETDCPRE.</span></span><br/>                                                                    |
| <span id="DOCUMENTEVENT_RESETDCPRE"></span><span id="documentevent_resetdcpre"></span><dl> <span data-ttu-id="1c884-142"><dt>**DOCUMENTEVENT \_ RESETDCPRE**</dt></span><span class="sxs-lookup"><span data-stu-id="1c884-142"><dt>**DOCUMENTEVENT\_RESETDCPRE**</dt></span></span> </dl>                                                                                                                                                         | <span data-ttu-id="1c884-143">GDI 即將處理其 [**ResetDC**](/windows/desktop/api/wingdi/nf-wingdi-resetdca) 函式的呼叫。</span><span class="sxs-lookup"><span data-stu-id="1c884-143">GDI is about to process a call to its [**ResetDC**](/windows/desktop/api/wingdi/nf-wingdi-resetdca) function.</span></span><br/>                                                                                                                                                                                                                           |
| <span id="DOCUMENTEVENT_STARTDOCPOST"></span><span id="documentevent_startdocpost"></span><dl> <span data-ttu-id="1c884-144"><dt>**DOCUMENTEVENT \_ STARTDOCPOST**</dt></span><span class="sxs-lookup"><span data-stu-id="1c884-144"><dt>**DOCUMENTEVENT\_STARTDOCPOST**</dt></span></span> </dl>                                                                                                                                                   | <span data-ttu-id="1c884-145">GDI 剛剛已處理其 [**StartDoc**](/windows/desktop/api/Wingdi/nf-wingdi-startdoca) 函式的呼叫。</span><span class="sxs-lookup"><span data-stu-id="1c884-145">GDI has just processed a call to its [**StartDoc**](/windows/desktop/api/Wingdi/nf-wingdi-startdoca) function.</span></span><br/>                                                                                                                                                                                                                          |
| <span id="DOCUMENTEVENT_STARTDOCPRE_or_DOCUMENTEVENT_STARTDOC"></span><span id="documentevent_startdocpre_or_documentevent_startdoc"></span><span id="DOCUMENTEVENT_STARTDOCPRE_OR_DOCUMENTEVENT_STARTDOC"></span><dl> <span data-ttu-id="1c884-146"><dt>**DOCUMENTEVENT \_ STARTDOCPRE 或 DOCUMENTEVENT \_ STARTDOC**</dt></span><span class="sxs-lookup"><span data-stu-id="1c884-146"><dt>**DOCUMENTEVENT\_STARTDOCPRE or DOCUMENTEVENT\_STARTDOC**</dt></span></span> </dl> | <span data-ttu-id="1c884-147">GDI 即將處理其 [**StartDoc**](/windows/desktop/api/Wingdi/nf-wingdi-startdoca) 函式的呼叫。</span><span class="sxs-lookup"><span data-stu-id="1c884-147">GDI is about to process a call to its [**StartDoc**](/windows/desktop/api/Wingdi/nf-wingdi-startdoca) function.</span></span><br/>                                                                                                                                                                                                                         |
| <span id="DOCUMENTEVENT_STARTPAGE"></span><span id="documentevent_startpage"></span><dl> <span data-ttu-id="1c884-148"><dt>**DOCUMENTEVENT \_ STARTPAGE**</dt></span><span class="sxs-lookup"><span data-stu-id="1c884-148"><dt>**DOCUMENTEVENT\_STARTPAGE**</dt></span></span> </dl>                                                                                                                                                            | <span data-ttu-id="1c884-149">GDI 即將處理其 [**StartPage**](/windows/desktop/api/Wingdi/nf-wingdi-startpage) 函數的呼叫。</span><span class="sxs-lookup"><span data-stu-id="1c884-149">GDI is about to process a call to its [**StartPage**](/windows/desktop/api/Wingdi/nf-wingdi-startpage) function.</span></span><br/>                                                                                                                                                                                                                       |



 

</dd> <dt>

<span data-ttu-id="1c884-150">*cbIn*</span><span class="sxs-lookup"><span data-stu-id="1c884-150">*cbIn*</span></span> 
</dt> <dd>

<span data-ttu-id="1c884-151">*PvIn* 所指向之緩衝區的大小（以位元組為單位）。</span><span class="sxs-lookup"><span data-stu-id="1c884-151">The size, in bytes, of the buffer pointed to by *pvIn*.</span></span>

</dd> <dt>

<span data-ttu-id="1c884-152">*pvIn* \[在\]</span><span class="sxs-lookup"><span data-stu-id="1c884-152">*pvIn* \[in\]</span></span>
</dt> <dd>

<span data-ttu-id="1c884-153">緩衝區的指標。</span><span class="sxs-lookup"><span data-stu-id="1c884-153">A pointer to a buffer.</span></span> <span data-ttu-id="1c884-154">緩衝區所包含的內容，取決於 *iEsc* 的值，如下表所示。</span><span class="sxs-lookup"><span data-stu-id="1c884-154">What the buffer contains depends on the value of *iEsc*, as shown in the following table.</span></span>



| <span data-ttu-id="1c884-155">常數</span><span class="sxs-lookup"><span data-stu-id="1c884-155">Constant</span></span>                                                                                                                                                                                                                                                                                                                                               | <span data-ttu-id="1c884-156">pvin 內容</span><span class="sxs-lookup"><span data-stu-id="1c884-156">pvin Contents</span></span>                                                                                                                                                                                                                                 |
|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span id="DOCUMENTEVENT_ABORTDOC"></span><span id="documentevent_abortdoc"></span><dl> <span data-ttu-id="1c884-157"><dt>**DOCUMENTEVENT \_ ABORTDOC**</dt></span><span class="sxs-lookup"><span data-stu-id="1c884-157"><dt>**DOCUMENTEVENT\_ABORTDOC**</dt></span></span> </dl>                                                                                                                                                               | <span data-ttu-id="1c884-158">未使用。</span><span class="sxs-lookup"><span data-stu-id="1c884-158">Not used.</span></span><br/>                                                                                                                                                                                                                          |
| <span id="DOCUMENTEVENT_CREATEDCPOST"></span><span id="documentevent_createdcpost"></span><dl> <span data-ttu-id="1c884-159"><dt>**DOCUMENTEVENT \_ CREATEDCPOST**</dt></span><span class="sxs-lookup"><span data-stu-id="1c884-159"><dt>**DOCUMENTEVENT\_CREATEDCPOST**</dt></span></span> </dl>                                                                                                                                                   | <span data-ttu-id="1c884-160">*pvIn* 包含對這個函式的前一個呼叫中， *pvOut* 參數所指定的 [**DEVMODE**](/windows/win32/api/wingdi/ns-wingdi-devmodea)結構之指標的位址，其 *iEsc* 參數已設定為 DOCUMENTEVENT \_ CREATEDCPRE。</span><span class="sxs-lookup"><span data-stu-id="1c884-160">*pvIn* contains the address of a pointer to the [**DEVMODE**](/windows/win32/api/wingdi/ns-wingdi-devmodea) structure specified in the *pvOut* parameter in a previous call to this function, for which the *iEsc* parameter was set to DOCUMENTEVENT\_CREATEDCPRE.</span></span><br/> |
| <span id="DOCUMENTEVENT_CREATEDCPRE"></span><span id="documentevent_createdcpre"></span><dl> <span data-ttu-id="1c884-161"><dt>**DOCUMENTEVENT \_ CREATEDCPRE**</dt></span><span class="sxs-lookup"><span data-stu-id="1c884-161"><dt>**DOCUMENTEVENT\_CREATEDCPRE**</dt></span></span> </dl>                                                                                                                                                      | <span data-ttu-id="1c884-162">*pvIn* 指向 \_ [Windows 驅動程式開發工具組](https://msdn.microsoft.com/windows/hardware/gg487428)中記載的 DOCEVENT CREATEDCPRE 結構。</span><span class="sxs-lookup"><span data-stu-id="1c884-162">*pvIn* points to a DOCEVENT\_CREATEDCPRE structure which is documented in the [Windows Driver Development Kit](https://msdn.microsoft.com/windows/hardware/gg487428).</span></span><br/>                                                                   |
| <span id="DOCUMENTEVENT_DELETEDC"></span><span id="documentevent_deletedc"></span><dl> <span data-ttu-id="1c884-163"><dt>**DOCUMENTEVENT \_ DELETEDC**</dt></span><span class="sxs-lookup"><span data-stu-id="1c884-163"><dt>**DOCUMENTEVENT\_DELETEDC**</dt></span></span> </dl>                                                                                                                                                               | <span data-ttu-id="1c884-164">未使用。</span><span class="sxs-lookup"><span data-stu-id="1c884-164">Not used.</span></span><br/>                                                                                                                                                                                                                          |
| <span id="DOCUMENTEVENT_ENDDOCPOST"></span><span id="documentevent_enddocpost"></span><dl> <span data-ttu-id="1c884-165"><dt>**DOCUMENTEVENT \_ ENDDOCPOST**</dt></span><span class="sxs-lookup"><span data-stu-id="1c884-165"><dt>**DOCUMENTEVENT\_ENDDOCPOST**</dt></span></span> </dl>                                                                                                                                                         | <span data-ttu-id="1c884-166">未使用。</span><span class="sxs-lookup"><span data-stu-id="1c884-166">Not used.</span></span><br/>                                                                                                                                                                                                                          |
| <span id="DOCUMENTEVENT_ENDDOCPRE_or_DOCUMENTEVENT_ENDDOC"></span><span id="documentevent_enddocpre_or_documentevent_enddoc"></span><span id="DOCUMENTEVENT_ENDDOCPRE_OR_DOCUMENTEVENT_ENDDOC"></span><dl> <span data-ttu-id="1c884-167"><dt>**DOCUMENTEVENT \_ ENDDOCPRE 或 DOCUMENTEVENT \_ ENDDOC**</dt></span><span class="sxs-lookup"><span data-stu-id="1c884-167"><dt>**DOCUMENTEVENT\_ENDDOCPRE or DOCUMENTEVENT\_ENDDOC**</dt></span></span> </dl>                 | <span data-ttu-id="1c884-168">未使用。</span><span class="sxs-lookup"><span data-stu-id="1c884-168">Not used.</span></span><br/>                                                                                                                                                                                                                          |
| <span id="DOCUMENTEVENT_ENDPAGE"></span><span id="documentevent_endpage"></span><dl> <span data-ttu-id="1c884-169"><dt>**DOCUMENTEVENT \_ ENDPAGE**</dt></span><span class="sxs-lookup"><span data-stu-id="1c884-169"><dt>**DOCUMENTEVENT\_ENDPAGE**</dt></span></span> </dl>                                                                                                                                                                  | <span data-ttu-id="1c884-170">未使用。</span><span class="sxs-lookup"><span data-stu-id="1c884-170">Not used.</span></span><br/>                                                                                                                                                                                                                          |
| <span id="DOCUMENTEVENT_ESCAPE"></span><span id="documentevent_escape"></span><dl> <span data-ttu-id="1c884-171"><dt>**DOCUMENTEVENT \_ ESCAPE**</dt></span><span class="sxs-lookup"><span data-stu-id="1c884-171"><dt>**DOCUMENTEVENT\_ESCAPE**</dt></span></span> </dl>                                                                                                                                                                     | <span data-ttu-id="1c884-172">*pvIn* 指向 \_ [Windows 驅動程式開發工具組](https://msdn.microsoft.com/windows/hardware/gg487428)中記載的 DOCEVENT ESCAPE 結構。</span><span class="sxs-lookup"><span data-stu-id="1c884-172">*pvIn* points to a DOCEVENT\_ESCAPE structure which is documented in the [Windows Driver Development Kit](https://msdn.microsoft.com/windows/hardware/gg487428).</span></span><br/>                                                                        |
| <span id="DOCUMENTEVENT_QUERYFILTER"></span><span id="documentevent_queryfilter"></span><dl> <span data-ttu-id="1c884-173"><dt>**DOCUMENTEVENT \_ QUERYFILTER**</dt></span><span class="sxs-lookup"><span data-stu-id="1c884-173"><dt>**DOCUMENTEVENT\_QUERYFILTER**</dt></span></span> </dl>                                                                                                                                                      | <span data-ttu-id="1c884-174">與 DOCUMENTEVENT CREATEDCPRE 相同 \_ 。</span><span class="sxs-lookup"><span data-stu-id="1c884-174">Same as for DOCUMENTEVENT\_CREATEDCPRE.</span></span><br/>                                                                                                                                                                                            |
| <span id="DOCUMENTEVENT_RESETDCPOST"></span><span id="documentevent_resetdcpost"></span><dl> <span data-ttu-id="1c884-175"><dt>**DOCUMENTEVENT \_ RESETDCPOST**</dt></span><span class="sxs-lookup"><span data-stu-id="1c884-175"><dt>**DOCUMENTEVENT\_RESETDCPOST**</dt></span></span> </dl>                                                                                                                                                      | <span data-ttu-id="1c884-176">*pvIn* 包含對這個函式的前一個呼叫中， *pvOut* 參數所指定的 [**DEVMODE**](/windows/win32/api/wingdi/ns-wingdi-devmodea)結構之指標的位址，其 *iEsc* 參數已設定為 DOCUMENTEVENT \_ RESETDCPRE。</span><span class="sxs-lookup"><span data-stu-id="1c884-176">*pvIn* contains the address of a pointer to the [**DEVMODE**](/windows/win32/api/wingdi/ns-wingdi-devmodea) structure specified in the *pvOut* parameter in a previous call to this function, for which the *iEsc* parameter was set to DOCUMENTEVENT\_RESETDCPRE.</span></span><br/>  |
| <span id="DOCUMENTEVENT_RESETDCPRE"></span><span id="documentevent_resetdcpre"></span><dl> <span data-ttu-id="1c884-177"><dt>**DOCUMENTEVENT \_ RESETDCPRE**</dt></span><span class="sxs-lookup"><span data-stu-id="1c884-177"><dt>**DOCUMENTEVENT\_RESETDCPRE**</dt></span></span> </dl>                                                                                                                                                         | <span data-ttu-id="1c884-178">*pvIn* 包含 [**ResetDC**](/windows/desktop/api/wingdi/nf-wingdi-resetdca)呼叫端所提供的 [**DEVMODE**](/windows/win32/api/wingdi/ns-wingdi-devmodea)結構之指標的位址。</span><span class="sxs-lookup"><span data-stu-id="1c884-178">*pvIn* contains the address of a pointer to the [**DEVMODE**](/windows/win32/api/wingdi/ns-wingdi-devmodea) structure supplied by the caller of [**ResetDC**](/windows/desktop/api/wingdi/nf-wingdi-resetdca).</span></span><br/>                                                                                         |
| <span id="DOCUMENTEVENT_STARTDOCPOST"></span><span id="documentevent_startdocpost"></span><dl> <span data-ttu-id="1c884-179"><dt>**DOCUMENTEVENT \_ STARTDOCPOST**</dt></span><span class="sxs-lookup"><span data-stu-id="1c884-179"><dt>**DOCUMENTEVENT\_STARTDOCPOST**</dt></span></span> </dl>                                                                                                                                                   | <span data-ttu-id="1c884-180">*pvIn* 會指向 LONG，以指定 [**StartDoc**](/windows/desktop/api/Wingdi/nf-wingdi-startdoca)所傳回的列印工作識別碼。</span><span class="sxs-lookup"><span data-stu-id="1c884-180">*pvIn* points to a LONG that specifies the print job identifier returned by [**StartDoc**](/windows/desktop/api/Wingdi/nf-wingdi-startdoca).</span></span><br/>                                                                                                                          |
| <span id="DOCUMENTEVENT_STARTDOCPRE_or_DOCUMENTEVENT_STARTDOC"></span><span id="documentevent_startdocpre_or_documentevent_startdoc"></span><span id="DOCUMENTEVENT_STARTDOCPRE_OR_DOCUMENTEVENT_STARTDOC"></span><dl> <span data-ttu-id="1c884-181"><dt>**DOCUMENTEVENT \_ STARTDOCPRE 或 DOCUMENTEVENT \_ STARTDOC**</dt></span><span class="sxs-lookup"><span data-stu-id="1c884-181"><dt>**DOCUMENTEVENT\_STARTDOCPRE or DOCUMENTEVENT\_STARTDOC**</dt></span></span> </dl> | <span data-ttu-id="1c884-182">*pvIn* 包含 [**StartDoc**](/windows/desktop/api/Wingdi/nf-wingdi-startdoca)之呼叫者所提供之 [**DOCINFO**](/windows/desktop/api/Wingdi/ns-wingdi-docinfoa)結構的指標位址。</span><span class="sxs-lookup"><span data-stu-id="1c884-182">*pvIn* contains the address of a pointer to a [**DOCINFO**](/windows/desktop/api/Wingdi/ns-wingdi-docinfoa) structure supplied by the caller of [**StartDoc**](/windows/desktop/api/Wingdi/nf-wingdi-startdoca).</span></span><br/>                                                                                         |
| <span id="DOCUMENTEVENT_STARTPAGE"></span><span id="documentevent_startpage"></span><dl> <span data-ttu-id="1c884-183"><dt>**DOCUMENTEVENT \_ STARTPAGE**</dt></span><span class="sxs-lookup"><span data-stu-id="1c884-183"><dt>**DOCUMENTEVENT\_STARTPAGE**</dt></span></span> </dl>                                                                                                                                                            | <span data-ttu-id="1c884-184">未使用。</span><span class="sxs-lookup"><span data-stu-id="1c884-184">Not used.</span></span><br/>                                                                                                                                                                                                                          |



 

<span data-ttu-id="1c884-185"></dd> <dt>*cbOut*</dt> </span><span class="sxs-lookup"><span data-stu-id="1c884-185"></dd> <dt>*cbOut* </dt> </span></span><dd> 

| <span data-ttu-id="1c884-186">值</span><span class="sxs-lookup"><span data-stu-id="1c884-186">Value</span></span>                       | <span data-ttu-id="1c884-187">意義</span><span class="sxs-lookup"><span data-stu-id="1c884-187">Meaning</span></span>                                                                              |
|-----------------------------|--------------------------------------------------------------------------------------|
| <span data-ttu-id="1c884-188">IDOCUMENTEVENT \_ QUERYFILTER</span><span class="sxs-lookup"><span data-stu-id="1c884-188">IDOCUMENTEVENT\_QUERYFILTER</span></span> | <span data-ttu-id="1c884-189">*PvOut* 之緩衝區指標的大小（以位元組為單位）。</span><span class="sxs-lookup"><span data-stu-id="1c884-189">The size, in bytes, of the buffer pointer to by *pvOut*.</span></span>                             |
| <span data-ttu-id="1c884-190">DOCUMENTEVENT \_ ESCAPE</span><span class="sxs-lookup"><span data-stu-id="1c884-190">DOCUMENTEVENT\_ESCAPE</span></span>       | <span data-ttu-id="1c884-191">值，用來做為 [**ExtEscape**](/windows/desktop/api/Wingdi/nf-wingdi-extescape)的 *cbOutput* 參數。</span><span class="sxs-lookup"><span data-stu-id="1c884-191">A value that is used as the *cbOutput* parameter for [**ExtEscape**](/windows/desktop/api/Wingdi/nf-wingdi-extescape).</span></span> |
| <span data-ttu-id="1c884-192">適用于所有其他值</span><span class="sxs-lookup"><span data-stu-id="1c884-192">For all other values</span></span>        | <span data-ttu-id="1c884-193">未使用 *iEsc* 。</span><span class="sxs-lookup"><span data-stu-id="1c884-193">*iEsc* is not used.</span></span>                                                                  |



 

</dd> <dt>

<span data-ttu-id="1c884-194">*pvOut* \[擴展\]</span><span class="sxs-lookup"><span data-stu-id="1c884-194">*pvOut* \[out\]</span></span>
</dt> <dd>

<span data-ttu-id="1c884-195">緩衝區的指標。</span><span class="sxs-lookup"><span data-stu-id="1c884-195">A pointer to a buffer.</span></span> <span data-ttu-id="1c884-196">緩衝區的內容取決於提供給 *iEsc* 的值，如下表所示。</span><span class="sxs-lookup"><span data-stu-id="1c884-196">The contents of the buffer depend on the value supplied for *iEsc*, as shown in the following table.</span></span>



| <span data-ttu-id="1c884-197">常數</span><span class="sxs-lookup"><span data-stu-id="1c884-197">Constant</span></span>                                                                                                                                                                                          | <span data-ttu-id="1c884-198">pvOut 內容</span><span class="sxs-lookup"><span data-stu-id="1c884-198">pvOut Contents</span></span>                                                                                                                                                                                                                |
|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span id="DOCUMENTEVENT_CREATEDCPRE"></span><span id="documentevent_createdcpre"></span><dl> <span data-ttu-id="1c884-199"><dt>**DOCUMENTEVENT \_ CREATEDCPRE**</dt></span><span class="sxs-lookup"><span data-stu-id="1c884-199"><dt>**DOCUMENTEVENT\_CREATEDCPRE**</dt></span></span> </dl> | <span data-ttu-id="1c884-200">以驅動程式提供的 DEVMODE 結構指標，GDI 會使用此結構，而不是 [**CreateDC**](/windows/desktop/api/wingdi/nf-wingdi-createdca)呼叫端所提供的 [**DEVMODE**](/windows/win32/api/wingdi/ns-wingdi-devmodea)結構。</span><span class="sxs-lookup"><span data-stu-id="1c884-200">A pointer to a driver-supplied [**DEVMODE**](/windows/win32/api/wingdi/ns-wingdi-devmodea) structure, which GDI uses instead of the one supplied by the [**CreateDC**](/windows/desktop/api/wingdi/nf-wingdi-createdca) caller.</span></span> <span data-ttu-id="1c884-201"> (如果是 **Null**，GDI 會使用呼叫端提供的結構。 ) </span><span class="sxs-lookup"><span data-stu-id="1c884-201">(If **NULL**, GDI uses the caller-supplied structure.)</span></span><br/> |
| <span id="DOCUMENTEVENT_ESCAPE"></span><span id="documentevent_escape"></span><dl> <span data-ttu-id="1c884-202"><dt>**DOCUMENTEVENT \_ ESCAPE**</dt></span><span class="sxs-lookup"><span data-stu-id="1c884-202"><dt>**DOCUMENTEVENT\_ESCAPE**</dt></span></span> </dl>                | <span data-ttu-id="1c884-203">用來當做 [**ExtEscape**](/windows/desktop/api/Wingdi/nf-wingdi-extescape)之 *lpszOutData* 參數的緩衝區指標。</span><span class="sxs-lookup"><span data-stu-id="1c884-203">A pointer to a buffer that is used as the *lpszOutData* parameter for [**ExtEscape**](/windows/desktop/api/Wingdi/nf-wingdi-extescape).</span></span><br/>                                                                                                              |
| <span id="DOCUMENTEVENT_QUERYFILTER"></span><span id="documentevent_queryfilter"></span><dl> <span data-ttu-id="1c884-204"><dt>**DOCUMENTEVENT \_ QUERYFILTER**</dt></span><span class="sxs-lookup"><span data-stu-id="1c884-204"><dt>**DOCUMENTEVENT\_QUERYFILTER**</dt></span></span> </dl> | <span data-ttu-id="1c884-205">包含 DOCEVENT 篩選結構的緩衝區指標，該 \_ 結構記載于 [Windows 驅動程式開發工具組](https://msdn.microsoft.com/windows/hardware/gg487428)中。</span><span class="sxs-lookup"><span data-stu-id="1c884-205">A pointer to buffer containing a DOCEVENT\_FILTER structure which is documented in the [Windows Driver Development Kit](https://msdn.microsoft.com/windows/hardware/gg487428).</span></span><br/>                                          |
| <span id="DOCUMENTEVENT_RESETDCPRE"></span><span id="documentevent_resetdcpre"></span><dl> <span data-ttu-id="1c884-206"><dt>**DOCUMENTEVENT \_ RESETDCPRE**</dt></span><span class="sxs-lookup"><span data-stu-id="1c884-206"><dt>**DOCUMENTEVENT\_RESETDCPRE**</dt></span></span> </dl>    | <span data-ttu-id="1c884-207">以驅動程式提供的 DEVMODE 結構指標，GDI 會使用此結構，而不是 [**ResetDC**](/windows/desktop/api/wingdi/nf-wingdi-resetdca)呼叫端所提供的 [**DEVMODE**](/windows/win32/api/wingdi/ns-wingdi-devmodea)結構。</span><span class="sxs-lookup"><span data-stu-id="1c884-207">A pointer to a driver-supplied [**DEVMODE**](/windows/win32/api/wingdi/ns-wingdi-devmodea) structure, which GDI uses instead of the one supplied by the [**ResetDC**](/windows/desktop/api/wingdi/nf-wingdi-resetdca) caller.</span></span> <span data-ttu-id="1c884-208"> (如果是 **Null**，GDI 會使用呼叫端提供的結構。 ) </span><span class="sxs-lookup"><span data-stu-id="1c884-208">(If **NULL**, GDI uses the caller-supplied structure.)</span></span><br/>   |



 

</dd> </dl>

## <a name="return-value"></a><span data-ttu-id="1c884-209">傳回值</span><span class="sxs-lookup"><span data-stu-id="1c884-209">Return value</span></span>

<span data-ttu-id="1c884-210">函數的傳回值相依于為 *iEsc* 提供的 escape。</span><span class="sxs-lookup"><span data-stu-id="1c884-210">The function's return value is dependent on the escape supplied for *iEsc*.</span></span> <span data-ttu-id="1c884-211">某些 escape 程式碼不會使用傳回值 (請參閱以下) 。</span><span class="sxs-lookup"><span data-stu-id="1c884-211">For some escape codes, the return value is not used (see below).</span></span> <span data-ttu-id="1c884-212">如果函式提供傳回值，則必須是下列其中一項。</span><span class="sxs-lookup"><span data-stu-id="1c884-212">If the function supplies a return value, it must be one of the following.</span></span>



| <span data-ttu-id="1c884-213">傳回值</span><span class="sxs-lookup"><span data-stu-id="1c884-213">Return Value</span></span>               | <span data-ttu-id="1c884-214">意義</span><span class="sxs-lookup"><span data-stu-id="1c884-214">Meaning</span></span>                                                                           |
|----------------------------|-----------------------------------------------------------------------------------|
| <span data-ttu-id="1c884-215">DOCUMENTEVENT \_ 失敗</span><span class="sxs-lookup"><span data-stu-id="1c884-215">DOCUMENTEVENT\_FAILURE</span></span>     | <span data-ttu-id="1c884-216">驅動程式支援 *iEsc* 所識別的 escape 程式碼，但發生失敗。</span><span class="sxs-lookup"><span data-stu-id="1c884-216">The driver supports the escape code identified by *iEsc*, but a failure occurred.</span></span> |
| <span data-ttu-id="1c884-217">DOCUMENTEVENT \_ 成功</span><span class="sxs-lookup"><span data-stu-id="1c884-217">DOCUMENTEVENT\_SUCCESS</span></span>     | <span data-ttu-id="1c884-218">驅動程式已成功處理 *iEsc* 所識別的 escape 程式碼。</span><span class="sxs-lookup"><span data-stu-id="1c884-218">The driver successfully handled the escape code identified by *iEsc*.</span></span>             |
| <span data-ttu-id="1c884-219">\_不支援 DOCUMENTEVENT</span><span class="sxs-lookup"><span data-stu-id="1c884-219">DOCUMENTEVENT\_UNSUPPORTED</span></span> | <span data-ttu-id="1c884-220">驅動程式不支援 *iEsc* 所識別的 escape 程式碼。</span><span class="sxs-lookup"><span data-stu-id="1c884-220">The driver does not support the escape code identified by *iEsc*.</span></span>                 |



 

<span data-ttu-id="1c884-221">下列清單指出哪些 escape 程式碼需要傳回值，哪些不是，並說明 DOCUMENTEVENT \_ SUCCESS、DOCUMENTEVENT \_ 失敗和 DOCUMENTEVENT 不支援的傳回碼的意義 \_ 。</span><span class="sxs-lookup"><span data-stu-id="1c884-221">The following list indicates which escape codes that require a return value and which do not, and explains the meaning of the DOCUMENTEVENT\_SUCCESS, DOCUMENTEVENT\_FAILURE, and DOCUMENTEVENT\_UNSUPPORTED return codes.</span></span>



| <span data-ttu-id="1c884-222">傳回值</span><span class="sxs-lookup"><span data-stu-id="1c884-222">Return Value</span></span>                                          | <span data-ttu-id="1c884-223">意義</span><span class="sxs-lookup"><span data-stu-id="1c884-223">Meaning</span></span>                                                                                                                                                                                    |
|-------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="1c884-224">DOCUMENTEVENT \_ ABORTDOC</span><span class="sxs-lookup"><span data-stu-id="1c884-224">DOCUMENTEVENT\_ABORTDOC</span></span>                               | <span data-ttu-id="1c884-225">不會使用傳回值，也不應讀取。</span><span class="sxs-lookup"><span data-stu-id="1c884-225">The return value is not used and should not be read.</span></span>                                                                                                                                       |
| <span data-ttu-id="1c884-226">DOCUMENTEVENT \_ CREATEDCPOST</span><span class="sxs-lookup"><span data-stu-id="1c884-226">DOCUMENTEVENT\_CREATEDCPOST</span></span>                           | <span data-ttu-id="1c884-227">不會使用傳回值，也不應讀取。</span><span class="sxs-lookup"><span data-stu-id="1c884-227">The return value is not used and should not be read.</span></span>                                                                                                                                       |
| <span data-ttu-id="1c884-228">DOCUMENTEVENT \_ CREATEDCPRE</span><span class="sxs-lookup"><span data-stu-id="1c884-228">DOCUMENTEVENT\_CREATEDCPRE</span></span>                            | <span data-ttu-id="1c884-229">DOCUMENTEVENT \_ 失敗-GDI 不會建立裝置內容或資訊內容，而且會針對 [**CreateDC**](/windows/desktop/api/wingdi/nf-wingdi-createdca) 或 [**CreateIC**](/windows/desktop/api/wingdi/nf-wingdi-createica)提供0的傳回值。</span><span class="sxs-lookup"><span data-stu-id="1c884-229">DOCUMENTEVENT\_FAILURE - GDI does not create the device context or information context, and provides a return value of 0 for [**CreateDC**](/windows/desktop/api/wingdi/nf-wingdi-createdca) or [**CreateIC**](/windows/desktop/api/wingdi/nf-wingdi-createica).</span></span> |
| <span data-ttu-id="1c884-230">DOCUMENTEVENT \_ DELETEDC</span><span class="sxs-lookup"><span data-stu-id="1c884-230">DOCUMENTEVENT\_DELETEDC</span></span>                               | <span data-ttu-id="1c884-231">不會使用傳回值，也不應讀取。</span><span class="sxs-lookup"><span data-stu-id="1c884-231">The return value is not used and should not be read.</span></span>                                                                                                                                       |
| <span data-ttu-id="1c884-232">DOCUMENTEVENT \_ ENDDOCPOST</span><span class="sxs-lookup"><span data-stu-id="1c884-232">DOCUMENTEVENT\_ENDDOCPOST</span></span>                             | <span data-ttu-id="1c884-233">不會使用傳回值，也不應讀取。</span><span class="sxs-lookup"><span data-stu-id="1c884-233">The return value is not used and should not be read.</span></span>                                                                                                                                       |
| <span data-ttu-id="1c884-234">DOCUMENTEVENT \_ ENDDOCPRE 或 DOCUMENTEVENT \_ ENDDOC</span><span class="sxs-lookup"><span data-stu-id="1c884-234">DOCUMENTEVENT\_ENDDOCPRE or DOCUMENTEVENT\_ENDDOC</span></span>     | <span data-ttu-id="1c884-235">不會使用傳回值，也不應讀取。</span><span class="sxs-lookup"><span data-stu-id="1c884-235">The return value is not used and should not be read.</span></span>                                                                                                                                       |
| <span data-ttu-id="1c884-236">DOCUMENTEVENT \_ ENDPAGE</span><span class="sxs-lookup"><span data-stu-id="1c884-236">DOCUMENTEVENT\_ENDPAGE</span></span>                                | <span data-ttu-id="1c884-237">不會使用傳回值，也不應讀取。</span><span class="sxs-lookup"><span data-stu-id="1c884-237">The return value is not used and should not be read.</span></span>                                                                                                                                       |
| <span data-ttu-id="1c884-238">DOCUMENTEVENT \_ ESCAPE</span><span class="sxs-lookup"><span data-stu-id="1c884-238">DOCUMENTEVENT\_ESCAPE</span></span>                                 | <span data-ttu-id="1c884-239">不會使用傳回值，也不應讀取。</span><span class="sxs-lookup"><span data-stu-id="1c884-239">The return value is not used and should not be read.</span></span>                                                                                                                                       |
| <span data-ttu-id="1c884-240">DOCUMENTEVENT \_ QUERYFILTER</span><span class="sxs-lookup"><span data-stu-id="1c884-240">DOCUMENTEVENT\_QUERYFILTER</span></span>                            | <span data-ttu-id="1c884-241">請參閱＜備註＞。</span><span class="sxs-lookup"><span data-stu-id="1c884-241">See Remarks.</span></span>                                                                                                                                                                               |
| <span data-ttu-id="1c884-242">DOCUMENTEVENT \_ RESETDCPOST</span><span class="sxs-lookup"><span data-stu-id="1c884-242">DOCUMENTEVENT\_RESETDCPOST</span></span>                            | <span data-ttu-id="1c884-243">不會使用傳回值，也不應讀取。</span><span class="sxs-lookup"><span data-stu-id="1c884-243">The return value is not used and should not be read.</span></span>                                                                                                                                       |
| <span data-ttu-id="1c884-244">DOCUMENTEVENT \_ RESETDCPRE</span><span class="sxs-lookup"><span data-stu-id="1c884-244">DOCUMENTEVENT\_RESETDCPRE</span></span>                             | <span data-ttu-id="1c884-245">DOCUMENTEVENT \_ 失敗-GDI 不會重設裝置內容，並為 [**ResetDC**](/windows/desktop/api/wingdi/nf-wingdi-resetdca)提供傳回值0。</span><span class="sxs-lookup"><span data-stu-id="1c884-245">DOCUMENTEVENT\_FAILURE - GDI does not reset the device context, and provides a return value of 0 for [**ResetDC**](/windows/desktop/api/wingdi/nf-wingdi-resetdca).</span></span>                                                           |
| <span data-ttu-id="1c884-246">DOCUMENTEVENT \_ STARTDOCPOST</span><span class="sxs-lookup"><span data-stu-id="1c884-246">DOCUMENTEVENT\_STARTDOCPOST</span></span>                           | <span data-ttu-id="1c884-247">DOCUMENTEVENT \_ 失敗-GDI 會呼叫 [**AbortDoc**](/windows/desktop/api/Wingdi/nf-wingdi-abortdoc) 來停止檔，然後 \_ 針對 [**StartDoc**](/windows/desktop/api/Wingdi/nf-wingdi-startdoca)提供 SP ERROR 的傳回值。</span><span class="sxs-lookup"><span data-stu-id="1c884-247">DOCUMENTEVENT\_FAILURE - GDI calls [**AbortDoc**](/windows/desktop/api/Wingdi/nf-wingdi-abortdoc) to stop the document, and then provides a return value of SP\_ERROR for [**StartDoc**](/windows/desktop/api/Wingdi/nf-wingdi-startdoca).</span></span>                      |
| <span data-ttu-id="1c884-248">DOCUMENTEVENT \_ STARTDOCPRE 或 DOCUMENTEVENT \_ STARTDOC</span><span class="sxs-lookup"><span data-stu-id="1c884-248">DOCUMENTEVENT\_STARTDOCPRE or DOCUMENTEVENT\_STARTDOC</span></span> | <span data-ttu-id="1c884-249">DOCUMENTEVENT \_ 失敗-GDI 不會開機檔案，並且針對 StartDoc 提供 SP ERROR 的傳回值 \_ 。 [](/windows/desktop/api/Wingdi/nf-wingdi-startdoca)</span><span class="sxs-lookup"><span data-stu-id="1c884-249">DOCUMENTEVENT\_FAILURE - GDI does not start the document, and provides a return value of SP\_ERROR for [**StartDoc**](/windows/desktop/api/Wingdi/nf-wingdi-startdoca).</span></span>                                                       |
| <span data-ttu-id="1c884-250">DOCUMENTEVENT \_ STARTPAGE</span><span class="sxs-lookup"><span data-stu-id="1c884-250">DOCUMENTEVENT\_STARTPAGE</span></span>                              | <span data-ttu-id="1c884-251">DOCUMENTEVENT \_ 失敗-GDI 不會啟動頁面，而且會針對 StartPage 提供傳回值的 SP \_ ERROR [\*\*\*\*](/windows/desktop/api/Wingdi/nf-wingdi-startpage)。</span><span class="sxs-lookup"><span data-stu-id="1c884-251">DOCUMENTEVENT\_FAILURE - GDI does not start the page, and provides a return value of SP\_ERROR for [**StartPage**](/windows/desktop/api/Wingdi/nf-wingdi-startpage).</span></span>                                                         |



 

## <a name="remarks"></a><span data-ttu-id="1c884-252">備註</span><span class="sxs-lookup"><span data-stu-id="1c884-252">Remarks</span></span>

<span data-ttu-id="1c884-253">針對 DOCUMENTEVENT QUERYFILTER 的 *iEsc* 值 \_ ，多工緩衝處理器可以 \_ 用兩種方式來解讀 **DOCUMENTEVENT** 所傳回的 DOCUMENTEVENT SUCCESS 值，這取決於驅動程式是否修改了 DOCEVENT 篩選結構的特定成員 \_ (，其記載于 [Windows 驅動程式開發工具組](https://msdn.microsoft.com/windows/hardware/gg487428) ) 中。</span><span class="sxs-lookup"><span data-stu-id="1c884-253">For an *iEsc* value of DOCUMENTEVENT\_QUERYFILTER, the spooler can interpret a DOCUMENTEVENT\_SUCCESS value returned by **DocumentEvent** in two ways, depending on whether the driver modified certain members of the DOCEVENT\_FILTER structure (which is documented in the [Windows Driver Development Kit](https://msdn.microsoft.com/windows/hardware/gg487428) ).</span></span> <span data-ttu-id="1c884-254"> (*pvOut* 參數指向此結構。當多工緩衝處理器為此類型的結構配置記憶體時，) 它會將此結構的兩個成員（ **cElementsReturned** 和 **cElementsNeeded**）初始化為已知的值。</span><span class="sxs-lookup"><span data-stu-id="1c884-254">(The *pvOut* parameter points to this structure.) When the spooler allocates memory for a structure of this type, it initializes two members of this structure, **cElementsReturned** and **cElementsNeeded**, to known values.</span></span> <span data-ttu-id="1c884-255">**DocumentEvent** 傳回之後，多工緩衝處理器會判斷這些成員的值是否已變更，並使用該資訊來解讀 **DocumentEvent** 傳回值。</span><span class="sxs-lookup"><span data-stu-id="1c884-255">After **DocumentEvent** returns, the spooler determines whether the values of these members have changed, and uses that information to interpret the **DocumentEvent** return value.</span></span> <span data-ttu-id="1c884-256">下表摘要說明這種情況。</span><span class="sxs-lookup"><span data-stu-id="1c884-256">The following table summarizes this situation.</span></span>



| <span data-ttu-id="1c884-257">傳回值</span><span class="sxs-lookup"><span data-stu-id="1c884-257">Return Value</span></span>                          | <span data-ttu-id="1c884-258">CElementsReturned 和 cElementsNeeded 的狀態</span><span class="sxs-lookup"><span data-stu-id="1c884-258">Status of cElementsReturned and cElementsNeeded</span></span>    | <span data-ttu-id="1c884-259">意義</span><span class="sxs-lookup"><span data-stu-id="1c884-259">Meaning</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|---------------------------------------|----------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="1c884-260">DOCUMENTEVENT \_ 成功</span><span class="sxs-lookup"><span data-stu-id="1c884-260">DOCUMENTEVENT\_SUCCESS</span></span><br/>     | <span data-ttu-id="1c884-261">驅動程式對任一成員都沒有任何變更。</span><span class="sxs-lookup"><span data-stu-id="1c884-261">Driver made no change to either member.</span></span><br/> | <span data-ttu-id="1c884-262">多工緩衝處理器會將此傳回值解釋為相當於 \_ 不支援的 DOCUMENTEVENT。</span><span class="sxs-lookup"><span data-stu-id="1c884-262">The spooler interprets this return value as equivalent to DOCUMENTEVENT\_UNSUPPORTED.</span></span> <span data-ttu-id="1c884-263">多工緩衝處理器無法從驅動程式抓取事件篩選器，因此它會持續呼叫所有事件的 **DocumentEvent** 。</span><span class="sxs-lookup"><span data-stu-id="1c884-263">The spooler is unable to retrieve the event filter from the driver, so it persists in calling **DocumentEvent** for all events.</span></span><br/>                                                                                                                                                                                                                         |
| <span data-ttu-id="1c884-264">DOCUMENTEVENT \_ 成功</span><span class="sxs-lookup"><span data-stu-id="1c884-264">DOCUMENTEVENT\_SUCCESS</span></span><br/>     | <span data-ttu-id="1c884-265">驅動程式已寫入一個或兩個成員。</span><span class="sxs-lookup"><span data-stu-id="1c884-265">Driver wrote to one or both members.</span></span><br/>    | <span data-ttu-id="1c884-266">多工緩衝處理器會接受此傳回值而不需要解讀。</span><span class="sxs-lookup"><span data-stu-id="1c884-266">The spooler accepts this return value without interpretation.</span></span> <span data-ttu-id="1c884-267">如果驅動程式只寫入其中一個 **cElementsNeeded** 和 **cElementsReturned**，則多工緩衝處理器會將未變更的成員視為值為零。</span><span class="sxs-lookup"><span data-stu-id="1c884-267">If the driver wrote to only one of **cElementsNeeded** and **cElementsReturned**, the spooler considers the unchanged member to have a value of zero.</span></span><br/> <span data-ttu-id="1c884-268">多工緩衝處理器會篩選出 DOCEVENT 篩選 (的 **aDocEventCall** 成員中列出的所有事件， \_ 這些事件記載于 [Windows 驅動程式開發工具組](https://msdn.microsoft.com/windows/hardware/gg487428) ) 中。</span><span class="sxs-lookup"><span data-stu-id="1c884-268">The spooler filters out all events listed in the **aDocEventCall** member of DOCEVENT\_FILTER (which is documented in the [Windows Driver Development Kit](https://msdn.microsoft.com/windows/hardware/gg487428) ).</span></span><br/> |
| <span data-ttu-id="1c884-269">\_不支援 DOCUMENTEVENT</span><span class="sxs-lookup"><span data-stu-id="1c884-269">DOCUMENTEVENT\_UNSUPPORTED</span></span><br/> | <span data-ttu-id="1c884-270">不適用</span><span class="sxs-lookup"><span data-stu-id="1c884-270">Not applicable</span></span><br/>                          | <span data-ttu-id="1c884-271">驅動程式不支援 DOCUMENTEVENT \_ QUERYFILTER。</span><span class="sxs-lookup"><span data-stu-id="1c884-271">The driver does not support DOCUMENTEVENT\_QUERYFILTER.</span></span><br/> <span data-ttu-id="1c884-272">多工緩衝處理器無法從驅動程式抓取事件篩選器，因此它會持續呼叫所有事件的 **DocumentEvent** 。</span><span class="sxs-lookup"><span data-stu-id="1c884-272">The spooler is unable to retrieve the event filter from the driver, so it persists in calling **DocumentEvent** for all events.</span></span><br/>                                                                                                                                                                                                                                            |
| <span data-ttu-id="1c884-273">DOCUMENTEVENT \_ 失敗</span><span class="sxs-lookup"><span data-stu-id="1c884-273">DOCUMENTEVENT\_FAILURE</span></span><br/>     | <span data-ttu-id="1c884-274">不適用</span><span class="sxs-lookup"><span data-stu-id="1c884-274">Not applicable</span></span><br/>                          | <span data-ttu-id="1c884-275">驅動程式支援 DOCUMENTEVENT \_ QUERYFILTER，但遇到內部錯誤。</span><span class="sxs-lookup"><span data-stu-id="1c884-275">The driver supports DOCUMENTEVENT\_QUERYFILTER, but encountered an internal error.</span></span><br/> <span data-ttu-id="1c884-276">多工緩衝處理器無法從驅動程式抓取事件篩選器，因此它會持續呼叫所有事件的 **DocumentEvent** 。</span><span class="sxs-lookup"><span data-stu-id="1c884-276">The spooler is unable to retrieve the event filter from the driver, so it persists in calling **DocumentEvent** for all events.</span></span><br/>                                                                                                                                                                                                                 |



 

<span data-ttu-id="1c884-277">如果 *iEsc* 參數中提供的 escape 程式碼為 DOCUMENTEVENT \_ CREATEDCPRE，則適用下列規則：</span><span class="sxs-lookup"><span data-stu-id="1c884-277">If the escape code supplied in the *iEsc* parameter is DOCUMENTEVENT\_CREATEDCPRE, the following rules apply:</span></span>

-   <span data-ttu-id="1c884-278">如果作業是直接傳送到印表機而不需要進行幕後處理，>pvIn 會指向印表機名稱。</span><span class="sxs-lookup"><span data-stu-id="1c884-278">If the job is being sent directly to the printer without spooling, pvIn->pszDevice points to the printer name.</span></span> <span data-ttu-id="1c884-279"> (需詳細資訊，請參閱 \_ [Windows 驅動程式開發工具組](https://msdn.microsoft.com/windows/hardware/gg487428)中的 DOCEVENT CREATEDCPRE 結構檔。 ) </span><span class="sxs-lookup"><span data-stu-id="1c884-279">(For more information, see the documentation for the DOCEVENT\_CREATEDCPRE structure in the [Windows Driver Development Kit](https://msdn.microsoft.com/windows/hardware/gg487428).)</span></span>
-   <span data-ttu-id="1c884-280">如果作業正在進行多工緩衝處理，pvIn >pszDevice 會指向印表機埠名稱。</span><span class="sxs-lookup"><span data-stu-id="1c884-280">If the job is being spooled, pvIn->pszDevice points to the printer port name.</span></span>

> [!Note]  
> <span data-ttu-id="1c884-281">在64位版本的 Windows 上執行32位應用程式時，適用下列限制。</span><span class="sxs-lookup"><span data-stu-id="1c884-281">The following restrictions apply when running a 32-bit application on a 64-bit version of Windows.</span></span> <span data-ttu-id="1c884-282">**DocumentEvent** 應該呼叫的唯一 GDI 函數是 [**ExtEscape**](/windows/desktop/api/Wingdi/nf-wingdi-extescape)，而且只應使用私用的轉義。</span><span class="sxs-lookup"><span data-stu-id="1c884-282">The only GDI function that **DocumentEvent** should call is [**ExtEscape**](/windows/desktop/api/Wingdi/nf-wingdi-extescape), and only private escapes should be used.</span></span> <span data-ttu-id="1c884-283">**DocumentEvent** 對其他 GDI 函數的呼叫可能會產生未定義的行為。</span><span class="sxs-lookup"><span data-stu-id="1c884-283">**DocumentEvent** calls to other GDI functions may produce undefined behavior.</span></span>

 

## <a name="requirements"></a><span data-ttu-id="1c884-284">規格需求</span><span class="sxs-lookup"><span data-stu-id="1c884-284">Requirements</span></span>



| <span data-ttu-id="1c884-285">需求</span><span class="sxs-lookup"><span data-stu-id="1c884-285">Requirement</span></span> | <span data-ttu-id="1c884-286">值</span><span class="sxs-lookup"><span data-stu-id="1c884-286">Value</span></span> |
|-------------------------------------|-----------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="1c884-287">最低支援的用戶端</span><span class="sxs-lookup"><span data-stu-id="1c884-287">Minimum supported client</span></span><br/> | <span data-ttu-id="1c884-288">\[僅限 Windows Vista 桌面應用程式\]</span><span class="sxs-lookup"><span data-stu-id="1c884-288">Windows Vista \[desktop apps only\]</span></span><br/>                                                            |
| <span data-ttu-id="1c884-289">最低支援的伺服器</span><span class="sxs-lookup"><span data-stu-id="1c884-289">Minimum supported server</span></span><br/> | <span data-ttu-id="1c884-290">僅限 Windows Server 2008 \[ desktop 應用程式\]</span><span class="sxs-lookup"><span data-stu-id="1c884-290">Windows Server 2008 \[desktop apps only\]</span></span><br/>                                                      |
| <span data-ttu-id="1c884-291">標頭</span><span class="sxs-lookup"><span data-stu-id="1c884-291">Header</span></span><br/>                   | <dl> <span data-ttu-id="1c884-292"><dt>Winspool.drv (包含) 的 Windows。h </dt></span><span class="sxs-lookup"><span data-stu-id="1c884-292"><dt>Winspool.h (include Windows.h)</dt></span></span> </dl> |
| <span data-ttu-id="1c884-293">Unicode 與 ANSI 名稱</span><span class="sxs-lookup"><span data-stu-id="1c884-293">Unicode and ANSI names</span></span><br/>   | <span data-ttu-id="1c884-294">**DocumentEventW** (Unicode) 和 **DocumentEventA** (ANSI) </span><span class="sxs-lookup"><span data-stu-id="1c884-294">**DocumentEventW** (Unicode) and **DocumentEventA** (ANSI)</span></span><br/>                                     |



## <a name="see-also"></a><span data-ttu-id="1c884-295">另請參閱</span><span class="sxs-lookup"><span data-stu-id="1c884-295">See also</span></span>

<dl> <dt>

[<span data-ttu-id="1c884-296">列印</span><span class="sxs-lookup"><span data-stu-id="1c884-296">Printing</span></span>](printdocs-printing.md)
</dt> <dt>

[<span data-ttu-id="1c884-297">列印多工緩衝處理器 API 函式</span><span class="sxs-lookup"><span data-stu-id="1c884-297">Print Spooler API Functions</span></span>](printing-and-print-spooler-functions.md)
</dt> <dt>

[<span data-ttu-id="1c884-298">Windows 驅動程式開發工具組</span><span class="sxs-lookup"><span data-stu-id="1c884-298">Windows Driver Development Kit</span></span>](https://msdn.microsoft.com/windows/hardware/gg487428)
</dt> </dl>

 

