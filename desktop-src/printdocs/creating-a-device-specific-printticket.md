---
description: 本主題並非最新的。 如需最新資訊，請參閱列印架構規格。
ms.assetid: 487f294f-dfe0-48f8-9077-06c55c3af8f1
title: 建立 Device-Specific 的 PrintTicket
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: d31644f25f231f7121e2e492bc3f41a81b82d0b4
ms.sourcegitcommit: de72a1294df274b0a71dc0fdc42d757e5f6df0f3
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 03/05/2021
ms.locfileid: "106989135"
---
# <a name="creating-a-device-specific-printticket"></a><span data-ttu-id="5ddce-104">建立 Device-Specific 的 PrintTicket</span><span class="sxs-lookup"><span data-stu-id="5ddce-104">Creating a Device-Specific PrintTicket</span></span>

<span data-ttu-id="5ddce-105">本主題並非最新的。</span><span class="sxs-lookup"><span data-stu-id="5ddce-105">This topic is not current.</span></span> <span data-ttu-id="5ddce-106">如需最新資訊，請參閱 [列印架構規格](https://download.microsoft.com/download/D/E/C/DECA6E6B-3E81-48E7-B7EF-6D92A547D03C/print-schema-spec-2-0.zip)。</span><span class="sxs-lookup"><span data-stu-id="5ddce-106">For the most current information, see the [Print Schema Specification](https://download.microsoft.com/download/D/E/C/DECA6E6B-3E81-48E7-B7EF-6D92A547D03C/print-schema-spec-2-0.zip).</span></span>

<span data-ttu-id="5ddce-107">裝置特定的 PrintTicket 以特定的裝置為目標，因此通常不會在多個裝置上移植。</span><span class="sxs-lookup"><span data-stu-id="5ddce-107">A device-specific PrintTicket targets a particular device and is therefore not generally portable across multiple devices.</span></span>

<span data-ttu-id="5ddce-108">當您建立裝置特定的 PrintTicket 時，應使用下列清單所示的步驟。</span><span class="sxs-lookup"><span data-stu-id="5ddce-108">The steps shown in the following list should be used when you create a device-specific PrintTicket.</span></span>

1.  <span data-ttu-id="5ddce-109">取得僅包含裝置相關功能實例的 PrintCapabilities 檔。</span><span class="sxs-lookup"><span data-stu-id="5ddce-109">Obtain a PrintCapabilities document containing only the relevant Feature instances for the device.</span></span> <span data-ttu-id="5ddce-110">要求預設的 PrintCapabilities 檔。</span><span class="sxs-lookup"><span data-stu-id="5ddce-110">Request a default PrintCapabilities document.</span></span> <span data-ttu-id="5ddce-111">這不需要您指定輸入 PrintTicket，因為裝置屬性 (功能和用來建立 PrintTicket 的選項實例和參數) ，與設定無關。</span><span class="sxs-lookup"><span data-stu-id="5ddce-111">This does not require you to specify an input PrintTicket because the device attributes (Feature and Option instances and parameters) that are used to construct the PrintTicket are independent of the configuration.</span></span>

2.  <span data-ttu-id="5ddce-112">建立空白的 XML 檔，其中包含 PrintTicket 根。</span><span class="sxs-lookup"><span data-stu-id="5ddce-112">Create an empty XML document containing the PrintTicket root.</span></span> <span data-ttu-id="5ddce-113">將命名空間前置詞指派給列印架構命名空間，並指派 PrintTicket 將使用的所有其他命名空間的前置詞。</span><span class="sxs-lookup"><span data-stu-id="5ddce-113">Assign a namespace prefix to the Print Schema namespace, and assign prefixes for all other namespaces that will be used by the PrintTicket.</span></span> <span data-ttu-id="5ddce-114">指定 PrintTicket 架構版本。</span><span class="sxs-lookup"><span data-stu-id="5ddce-114">Specify the PrintTicket Schema version.</span></span>

3.  <span data-ttu-id="5ddce-115">您可以針對 PrintCapabilities 檔中報告的每個功能和 ParameterDef 實例定義 PrintTicket 中的設定，或僅針對您感興趣的設定。</span><span class="sxs-lookup"><span data-stu-id="5ddce-115">You may define settings in the PrintTicket for every Feature and ParameterDef instance reported in the PrintCapabilities document, or only those of interest to you.</span></span> <span data-ttu-id="5ddce-116">如果將部分的 PrintTicket 呈現給 PrintTicket 介面，在 PrintTicket 驗證期間，會自動為省略的功能和 ParameterDef 實例提供預設值。</span><span class="sxs-lookup"><span data-stu-id="5ddce-116">If a partial PrintTicket is presented to the PrintTicket interface, defaults are automatically provided for omitted Feature and ParameterDef instances during PrintTicket validation.</span></span>

4.  <span data-ttu-id="5ddce-117">檢查 PrintCapabilities 檔中的功能實例，並判斷您想要在 PrintTicket 中定義哪些。</span><span class="sxs-lookup"><span data-stu-id="5ddce-117">Examine the PrintCapabilities document for Feature instances and determine which of these you want defined in your PrintTicket.</span></span> <span data-ttu-id="5ddce-118">將這些功能實例加入至 PrintTicket，但不要將功能實例的內容傳送至您的 PrintTicket。</span><span class="sxs-lookup"><span data-stu-id="5ddce-118">Add these Feature instances to the PrintTicket, but do not transfer the contents of the Feature instances to your PrintTicket.</span></span> <span data-ttu-id="5ddce-119">如果您傳輸 subfeature，也必須傳送父功能，而且必須在 PrintTicket 中保留父子式關聯性。</span><span class="sxs-lookup"><span data-stu-id="5ddce-119">If you transfer a subfeature, the parent Feature must also be transferred, and the parent-child relationship must be preserved in the PrintTicket.</span></span>

    <span data-ttu-id="5ddce-120">針對您傳送的每個功能，判斷哪些選項實例適用于您的 PrintTicket。</span><span class="sxs-lookup"><span data-stu-id="5ddce-120">For each Feature that you transfer, determine which Option instances are applicable to your PrintTicket.</span></span> <span data-ttu-id="5ddce-121">傳送 PrintCapabilities 檔中定義的整個選項，然後移除任何存在的屬性實例。</span><span class="sxs-lookup"><span data-stu-id="5ddce-121">Transfer the entire Option as defined in the PrintCapabilities document, and then remove any Property instances that are present.</span></span> <span data-ttu-id="5ddce-122">屬性實例用於 PrintCapabilities 檔中，但在 PrintTicket 中沒有任何用途。</span><span class="sxs-lookup"><span data-stu-id="5ddce-122">The Property instances are used within PrintCapabilities documents, but serve no purpose in the PrintTicket.</span></span> <span data-ttu-id="5ddce-123">保留所有 ScoredProperty 實例，並確定您保留其位置;它們是選項定義的內建部分。</span><span class="sxs-lookup"><span data-stu-id="5ddce-123">Keep all of the ScoredProperty instances, making sure that you preserve their location; they are an intrinsic part of the Option definition.</span></span>

5.  <span data-ttu-id="5ddce-124">您也可以將屬性實例加入至任何 ScoredProperty 實例。</span><span class="sxs-lookup"><span data-stu-id="5ddce-124">You may also add Property instances to any ScoredProperty instance.</span></span> <span data-ttu-id="5ddce-125">只有當 PrintTicket 提供者明確支援其使用時，才會使用屬性實例。</span><span class="sxs-lookup"><span data-stu-id="5ddce-125">Property instances are used only if the PrintTicket provider explicitly supports their use.</span></span> <span data-ttu-id="5ddce-126">每個提供者都應記錄所有支援之屬性實例的用途和用法。</span><span class="sxs-lookup"><span data-stu-id="5ddce-126">Each provider should document the purpose and use of all supported Property instances.</span></span> <span data-ttu-id="5ddce-127">請注意，在驗證期間，除非目標 PrintCapabilities 或 PrintTicket 提供者可辨識屬性的命名空間，而且在 PrintCapabilities 檔中找到 ScoredProperty 實例完全符合參考選項中所定義的屬性實例，否則會將該選項實例中包含的任何屬性實例移除。</span><span class="sxs-lookup"><span data-stu-id="5ddce-127">Note that during validation, any Property instances contained within an Option instance are stripped off, unless the namespace of the Property is recognized by the target PrintCapabilities or PrintTicket provider, and a candidate Option is found in the PrintCapabilities document whose ScoredProperty instances perfectly match those defined in the reference Option.</span></span>

6.  <span data-ttu-id="5ddce-128">如果 Print Schema 關鍵字將特定功能的 SelectionType 屬性設定為 PickMany，您可以為該功能選取一個以上的選項，但前提是指定為 IdentityOption 的選項不是選取的選項之一。</span><span class="sxs-lookup"><span data-stu-id="5ddce-128">If the Print Schema Keywords set the SelectionType Property to PickMany for a particular Feature, you may select more than one Option for that Feature, provided that the Option designated as IdentityOption is not one of those selected.</span></span> <span data-ttu-id="5ddce-129">列印架構中的 IdentityOption 與 Postscript PPD 檔案和 Unidrv GPD 檔案中的 [無] 選項有相同的效果;它是一種無作業的服務。</span><span class="sxs-lookup"><span data-stu-id="5ddce-129">IdentityOption in the Print Schema has the same effect as the None option in Postscript PPD files and Unidrv GPD files; it serves as a no-op.</span></span>

7.  <span data-ttu-id="5ddce-130">檢查您的 PrintTicket 中應設定之 ParameterDef 實例的 PrintCapabilities 檔。</span><span class="sxs-lookup"><span data-stu-id="5ddce-130">Examine the PrintCapabilities document for ParameterDef instances that should be set in your PrintTicket.</span></span> <span data-ttu-id="5ddce-131">針對每個這類 ParameterDef 實例，選取要在 PrintTicket 的 ParameterInit 實例中使用的值。</span><span class="sxs-lookup"><span data-stu-id="5ddce-131">For each such ParameterDef instance, select a Value to be used in the ParameterInit instance in the PrintTicket.</span></span> <span data-ttu-id="5ddce-132">這個值必須是正確的資料類型，而且必須落在 ParameterDef 實例中定義的範圍內，而且必須符合 ParameterDef 實例中指定的所有其他需求。</span><span class="sxs-lookup"><span data-stu-id="5ddce-132">This Value must be of the correct data type and must fall within the range defined in the ParameterDef instance, and must meet all of the other requirements specified in the ParameterDef instance.</span></span> <span data-ttu-id="5ddce-133">使用 ParameterInit 實例將參數初始化為您所選取的值。</span><span class="sxs-lookup"><span data-stu-id="5ddce-133">Use a ParameterInit instance to initialize the parameter to the Value you have selected.</span></span>

8.  <span data-ttu-id="5ddce-134">檢查 ParameterRef 實例出現的 PrintTicket 中，每個選項實例的內容。</span><span class="sxs-lookup"><span data-stu-id="5ddce-134">Examine the contents of each Option instance that appears in the PrintTicket for occurrences of ParameterRef instances.</span></span> <span data-ttu-id="5ddce-135">如果對應的 ParameterInit 實例尚未出現在 PrintTicket 中，請依照上一個步驟在 PrintTicket 中建立 ParameterInit 實例。</span><span class="sxs-lookup"><span data-stu-id="5ddce-135">If a corresponding ParameterInit instance does not already appear in the PrintTicket, follow the previous step to create a ParameterInit instance in the PrintTicket.</span></span> <span data-ttu-id="5ddce-136">這個 ParameterInit 實例的目的是要初始化 ParameterRef 實例所參考的參數。</span><span class="sxs-lookup"><span data-stu-id="5ddce-136">The purpose of this ParameterInit instance is to initialize the parameter referenced by the ParameterRef instance.</span></span>

9.  <span data-ttu-id="5ddce-137">請記住，條件約束衝突可能會導致裝置無法套用您在 PrintTicket 中指定的設定。</span><span class="sxs-lookup"><span data-stu-id="5ddce-137">Keep in mind that constraint conflicts might prevent the device from applying the configuration you have specified in the PrintTicket.</span></span> <span data-ttu-id="5ddce-138">如有必要，驗證程式會將 PrintTicket 中定義的設定修改為無衝突的設定。</span><span class="sxs-lookup"><span data-stu-id="5ddce-138">If necessary, the validation process modifies the configuration defined in the PrintTicket to one that is free of conflicts.</span></span>

10. <span data-ttu-id="5ddce-139">檢查必須存在於您的 PrintTicket 中之屬性實例的列印架構關鍵字。</span><span class="sxs-lookup"><span data-stu-id="5ddce-139">Examine the Print Schema Keywords for Property instances that must be present in your PrintTicket.</span></span> <span data-ttu-id="5ddce-140">針對所需的每個專案，將屬性實例加入至您的 PrintTicket，並使用 Value 元素類型為其提供適當的值。</span><span class="sxs-lookup"><span data-stu-id="5ddce-140">Add a Property instance to your PrintTicket for each that is required, and provide a suitable value for it using the Value element type.</span></span> <span data-ttu-id="5ddce-141">請確定屬性實例正確地放在 PrintTicket 內。</span><span class="sxs-lookup"><span data-stu-id="5ddce-141">Make sure that Property instances are located properly within the PrintTicket.</span></span>

11. <span data-ttu-id="5ddce-142">檢查 PrintTicket 架構中的選擇性屬性實例。</span><span class="sxs-lookup"><span data-stu-id="5ddce-142">Examine the optional Property instances in the PrintTicket Schema.</span></span> <span data-ttu-id="5ddce-143">如果您的 PrintTicket 中有任何這類屬性實例，請在您的 PrintTicket 中建立它們。</span><span class="sxs-lookup"><span data-stu-id="5ddce-143">If there are any such Property instances that should be in your PrintTicket, create them in your PrintTicket.</span></span>

12. <span data-ttu-id="5ddce-144">您也可以在根層級或任何功能、選項或屬性實例中，新增私用定義的屬性實例。</span><span class="sxs-lookup"><span data-stu-id="5ddce-144">You may also add privately-defined Property instances at the root level, or to any Feature, Option, or Property instance.</span></span> <span data-ttu-id="5ddce-145">不過請注意，除非目標 PrintCapabilities 或 PrintTicket 提供者可以辨識這些私用的屬性實例，否則在驗證期間會將它們移除。</span><span class="sxs-lookup"><span data-stu-id="5ddce-145">Note however, that these privately-defined Property instances are stripped off during validation, unless the namespace they belong to is recognized by the target PrintCapabilities or PrintTicket provider.</span></span> <span data-ttu-id="5ddce-146">此外，除非 PrintCapabilities 檔包含完全相符的選項，否則在驗證期間會移除出現在選項實例內任何位置的屬性實例。</span><span class="sxs-lookup"><span data-stu-id="5ddce-146">In addition, Property instances that appear anywhere within an Option instance are stripped off during validation, unless the PrintCapabilities document contains an Option that is a perfect match.</span></span> <span data-ttu-id="5ddce-147">如果某個選項實例中的每個 ScoredProperty 都有相對應的 ScoredProperty，而 ScoredProperty 實例的值相同，則兩個選項實例是完全相符的。</span><span class="sxs-lookup"><span data-stu-id="5ddce-147">Two Option instances are a perfect match if every ScoredProperty in one Option instance has a corresponding ScoredProperty in the other, and the Values of the ScoredProperty instances are the same.</span></span> <span data-ttu-id="5ddce-148">請參閱 PrintTicket 提供者的私用架構，以取得可辨識之私用屬性實例及其用法的清單。</span><span class="sxs-lookup"><span data-stu-id="5ddce-148">Consult the PrintTicket provider's Private Schema for a list of recognized private Property instances and their uses.</span></span>

13. <span data-ttu-id="5ddce-149">相同專案類型的子系不可嵌套至超過10個元素的深度。</span><span class="sxs-lookup"><span data-stu-id="5ddce-149">Children of the same element type may not nest to a depth of more than 10 elements.</span></span> <span data-ttu-id="5ddce-150">這項規則會獨立套用到每個可定義的元素類型。</span><span class="sxs-lookup"><span data-stu-id="5ddce-150">This rule applies independently to each type of element that can be defined.</span></span>

> [!Note]  
> <span data-ttu-id="5ddce-151">必須使用 UTF-8 或 UTF-16 來編碼 PrintTicket XML 內容。</span><span class="sxs-lookup"><span data-stu-id="5ddce-151">PrintTicket XML content MUST be encoded using either UTF-8 or UTF-16.</span></span>

 

## <a name="related-topics"></a><span data-ttu-id="5ddce-152">相關主題</span><span class="sxs-lookup"><span data-stu-id="5ddce-152">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="5ddce-153">列印架構規格</span><span class="sxs-lookup"><span data-stu-id="5ddce-153">Print Schema Specification</span></span>](https://download.microsoft.com/download/D/E/C/DECA6E6B-3E81-48E7-B7EF-6D92A547D03C/print-schema-spec-2-0.zip)
</dt> </dl>

 

 



