---
description: 本主題說明如何將列印工作進度顯示給使用者，並提供選項來取消目前進行中的列印工作。
ms.assetid: 2b7a0ab7-bf7e-473d-ab43-8b79478d4453
title: 如何：顯示列印工作進度
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 9effc778f6affaba5b53cbd96a7a428ea5554d8c
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/07/2021
ms.locfileid: "106997126"
---
# <a name="how-to-display-the-print-job-progress"></a>如何：顯示列印工作進度

本主題說明如何將列印工作進度顯示給使用者，並提供選項來取消目前進行中的列印工作。

## <a name="overview"></a>概觀

列印進度對話方塊程式通常會執行下列功能。

-   向使用者顯示列印工作進度。
-   啟動列印處理執行緒。
-   顯示 [ **取消** ] 按鈕，讓使用者可以在列印工作完成之前予以停止。

嚴格來說，列印進度對話方塊程式必須執行的工作，就是將列印工作進度顯示給使用者。 不過，因為上述清單中的其他兩個函式是密切相關的，所以也已包含在此課程模組中。

## <a name="displaying-print-job-progress"></a>顯示列印工作進度

列印進度對話方塊程式會處理下列視窗訊息。

-   **WM \_ INITDIALOG**

    初始化對話方塊使用的控制項。

-   **WM \_ SETCURSOR**

    當使用者可以取消列印工作時，將游標設定為指標，而當列印工作處於無法取消的時間點時，則為等候游標。

-   **使用者 \_ 列印 \_ 開始 \_ 列印**

    設定列印工作的進度列參數，並建立列印執行緒來開始處理列印工作。

    這是應用程式特定的視窗訊息。

-   **WM \_ 命令-IDCANCEL**

    設定取消事件，以指示列印處理執行緒取消列印工作。

-   **使用者 \_ 列印 \_ 狀態 \_ 更新**

    更新進度列和狀態文字，以顯示列印工作的目前狀態。

    這是應用程式特定的視窗訊息。

-   **使用者 \_ 列印 \_ 關閉**

    在 [進度] 對話方塊中設定關閉狀態文字，表示列印工作正在關閉。

    這是應用程式特定的視窗訊息。

-   **使用者 \_ 列印 \_ 完成**

    向使用者顯示「列印工作完成」訊息，並釋放此列印工作中使用的控制碼和事件。

    這是應用程式特定的視窗訊息。

 

 



