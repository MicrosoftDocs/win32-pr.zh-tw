---
description: 列出 (Api) Windows Vista 中引進的列印應用程式設計介面。
ms.assetid: 7a4eb5d7-b37d-4090-aea4-7274daa1e15c
title: Windows Vista 中的列印功能新功能
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 3b8648d57f48623e6db0f6311bb07ae24ac15d96
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/08/2021
ms.locfileid: "106989478"
---
# <a name="whats-new-for-printing-in-windows-vista"></a><span data-ttu-id="188c8-103">Windows Vista 中的列印功能新功能</span><span class="sxs-lookup"><span data-stu-id="188c8-103">What's New for Printing in Windows Vista</span></span>

<span data-ttu-id="188c8-104">列出 (Api) Windows Vista 中引進的列印應用程式設計介面。</span><span class="sxs-lookup"><span data-stu-id="188c8-104">Lists the printing application programming interfaces (APIs) introduced in Windows Vista.</span></span>

<span data-ttu-id="188c8-105">下列函數和列舉是用來管理列印票證。</span><span class="sxs-lookup"><span data-stu-id="188c8-105">The following functions and enumerations are used to manage print tickets.</span></span>



| <span data-ttu-id="188c8-106">函式</span><span class="sxs-lookup"><span data-stu-id="188c8-106">Function</span></span>                                                               | <span data-ttu-id="188c8-107">描述</span><span class="sxs-lookup"><span data-stu-id="188c8-107">Description</span></span>                                                                                                                                   | <span data-ttu-id="188c8-108">標頭</span><span class="sxs-lookup"><span data-stu-id="188c8-108">Header</span></span>    | <span data-ttu-id="188c8-109">程式庫</span><span class="sxs-lookup"><span data-stu-id="188c8-109">Library</span></span>     |
|------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------|-----------|-------------|
| [<span data-ttu-id="188c8-110">**PTConvertPrintTicketToDevMode**</span><span class="sxs-lookup"><span data-stu-id="188c8-110">**PTConvertPrintTicketToDevMode**</span></span>](/windows/desktop/api/prntvpt/nf-prntvpt-ptconvertprinttickettodevmode) | <span data-ttu-id="188c8-111">將列印票證轉換成 [**DEVMODE**](/windows/win32/api/wingdi/ns-wingdi-devmodea) 結構。</span><span class="sxs-lookup"><span data-stu-id="188c8-111">Converts a print ticket to a [**DEVMODE**](/windows/win32/api/wingdi/ns-wingdi-devmodea) structure.</span></span>                                                                            | <span data-ttu-id="188c8-112">Prntvpt。h</span><span class="sxs-lookup"><span data-stu-id="188c8-112">Prntvpt.h</span></span> | <span data-ttu-id="188c8-113">Prntvpt .lib</span><span class="sxs-lookup"><span data-stu-id="188c8-113">Prntvpt.lib</span></span> |
| [<span data-ttu-id="188c8-114">**PTConvertDevModeToPrintTicket**</span><span class="sxs-lookup"><span data-stu-id="188c8-114">**PTConvertDevModeToPrintTicket**</span></span>](/windows/desktop/api/prntvpt/nf-prntvpt-ptconvertdevmodetoprintticket) | <span data-ttu-id="188c8-115">將 [**DEVMODE**](/windows/win32/api/wingdi/ns-wingdi-devmodea) 轉換為列印票證。</span><span class="sxs-lookup"><span data-stu-id="188c8-115">Converts a [**DEVMODE**](/windows/win32/api/wingdi/ns-wingdi-devmodea) to a print ticket.</span></span>                                                                                      | <span data-ttu-id="188c8-116">Prntvpt。h</span><span class="sxs-lookup"><span data-stu-id="188c8-116">Prntvpt.h</span></span> | <span data-ttu-id="188c8-117">Prntvpt .lib</span><span class="sxs-lookup"><span data-stu-id="188c8-117">Prntvpt.lib</span></span> |
| [<span data-ttu-id="188c8-118">**PTReleaseMemory**</span><span class="sxs-lookup"><span data-stu-id="188c8-118">**PTReleaseMemory**</span></span>](/windows/desktop/api/prntvpt/nf-prntvpt-ptreleasememory)                             | <span data-ttu-id="188c8-119">釋放特定列印票證管理功能所建立的緩衝區。</span><span class="sxs-lookup"><span data-stu-id="188c8-119">Releases buffers created by certain print ticket management functions.</span></span>                                                                        | <span data-ttu-id="188c8-120">Prntvpt。h</span><span class="sxs-lookup"><span data-stu-id="188c8-120">Prntvpt.h</span></span> | <span data-ttu-id="188c8-121">Prntvpt .lib</span><span class="sxs-lookup"><span data-stu-id="188c8-121">Prntvpt.lib</span></span> |
| [<span data-ttu-id="188c8-122">**PTMergeAndValidatePrintTicket**</span><span class="sxs-lookup"><span data-stu-id="188c8-122">**PTMergeAndValidatePrintTicket**</span></span>](/windows/desktop/api/prntvpt/nf-prntvpt-ptmergeandvalidateprintticket) | <span data-ttu-id="188c8-123">驗證兩個列印票證，並將其合併成可行的列印票證。</span><span class="sxs-lookup"><span data-stu-id="188c8-123">Validates and merges two print tickets into a viable print ticket.</span></span>                                                                            | <span data-ttu-id="188c8-124">Prntvpt。h</span><span class="sxs-lookup"><span data-stu-id="188c8-124">Prntvpt.h</span></span> | <span data-ttu-id="188c8-125">Prntvpt .lib</span><span class="sxs-lookup"><span data-stu-id="188c8-125">Prntvpt.lib</span></span> |
| [<span data-ttu-id="188c8-126">**PTGetPrintCapabilities**</span><span class="sxs-lookup"><span data-stu-id="188c8-126">**PTGetPrintCapabilities**</span></span>](/windows/desktop/api/prntvpt/nf-prntvpt-ptgetprintcapabilities)               | <span data-ttu-id="188c8-127">取得印表機功能的帳戶。</span><span class="sxs-lookup"><span data-stu-id="188c8-127">Gets an account of the printer's capabilities.</span></span>                                                                                                | <span data-ttu-id="188c8-128">Prntvpt。h</span><span class="sxs-lookup"><span data-stu-id="188c8-128">Prntvpt.h</span></span> | <span data-ttu-id="188c8-129">Prntvpt .lib</span><span class="sxs-lookup"><span data-stu-id="188c8-129">Prntvpt.lib</span></span> |
| [<span data-ttu-id="188c8-130">**PTOpenProvider**</span><span class="sxs-lookup"><span data-stu-id="188c8-130">**PTOpenProvider**</span></span>](/windows/desktop/api/prntvpt/nf-prntvpt-ptopenprovider)                               | <span data-ttu-id="188c8-131">開啟列印票證提供者。</span><span class="sxs-lookup"><span data-stu-id="188c8-131">Opens a print ticket provider.</span></span>                                                                                                                | <span data-ttu-id="188c8-132">Prntvpt。h</span><span class="sxs-lookup"><span data-stu-id="188c8-132">Prntvpt.h</span></span> | <span data-ttu-id="188c8-133">Prntvpt .lib</span><span class="sxs-lookup"><span data-stu-id="188c8-133">Prntvpt.lib</span></span> |
| [<span data-ttu-id="188c8-134">**PTOpenProviderEx**</span><span class="sxs-lookup"><span data-stu-id="188c8-134">**PTOpenProviderEx**</span></span>](/windows/desktop/api/prntvpt/nf-prntvpt-ptopenproviderex)                           | <span data-ttu-id="188c8-135">開啟列印票證提供者，即使它不支援慣用的 [列印架構](./print-schema.md)版本。</span><span class="sxs-lookup"><span data-stu-id="188c8-135">Opens a print ticket provider, even if it does not support the preferred version of the [Print Schema](./print-schema.md).</span></span> | <span data-ttu-id="188c8-136">Prntvpt。h</span><span class="sxs-lookup"><span data-stu-id="188c8-136">Prntvpt.h</span></span> | <span data-ttu-id="188c8-137">Prntvpt .lib</span><span class="sxs-lookup"><span data-stu-id="188c8-137">Prntvpt.lib</span></span> |
| [<span data-ttu-id="188c8-138">**PTCloseProvider**</span><span class="sxs-lookup"><span data-stu-id="188c8-138">**PTCloseProvider**</span></span>](/windows/desktop/api/prntvpt/nf-prntvpt-ptcloseprovider)                             | <span data-ttu-id="188c8-139">關閉列印票證提供者。</span><span class="sxs-lookup"><span data-stu-id="188c8-139">Closes a print ticket provider.</span></span>                                                                                                               | <span data-ttu-id="188c8-140">Prntvpt。h</span><span class="sxs-lookup"><span data-stu-id="188c8-140">Prntvpt.h</span></span> | <span data-ttu-id="188c8-141">Prntvpt .lib</span><span class="sxs-lookup"><span data-stu-id="188c8-141">Prntvpt.lib</span></span> |
| [<span data-ttu-id="188c8-142">**PTQuerySchemaVersionSupport**</span><span class="sxs-lookup"><span data-stu-id="188c8-142">**PTQuerySchemaVersionSupport**</span></span>](/windows/desktop/api/prntvpt/nf-prntvpt-ptqueryschemaversionsupport)     | <span data-ttu-id="188c8-143">取得指定印表機支援的 [列印架構](./print-schema.md) 最新版本。</span><span class="sxs-lookup"><span data-stu-id="188c8-143">Gets the latest version of the [Print Schema](./print-schema.md) that a specified printer supports.</span></span>                        | <span data-ttu-id="188c8-144">Prntvpt。h</span><span class="sxs-lookup"><span data-stu-id="188c8-144">Prntvpt.h</span></span> | <span data-ttu-id="188c8-145">Prntvpt .lib</span><span class="sxs-lookup"><span data-stu-id="188c8-145">Prntvpt.lib</span></span> |



 



| <span data-ttu-id="188c8-146">列舉型別</span><span class="sxs-lookup"><span data-stu-id="188c8-146">Enumeration</span></span>                                        | <span data-ttu-id="188c8-147">描述</span><span class="sxs-lookup"><span data-stu-id="188c8-147">Description</span></span>                                                                                                                                                                               | <span data-ttu-id="188c8-148">標頭</span><span class="sxs-lookup"><span data-stu-id="188c8-148">Header</span></span>    |
|----------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------|
| [<span data-ttu-id="188c8-149">**EDefaultDevmodeType**</span><span class="sxs-lookup"><span data-stu-id="188c8-149">**EDefaultDevmodeType**</span></span>](/windows/win32/api/prntvpt/ne-prntvpt-edefaultdevmodetype) | <span data-ttu-id="188c8-150">當列印票證未指定任何可能在 **DEVMODE** 中的設定時，可讓呼叫者指定要使用哪一個 [**DEVMODE**](/windows/win32/api/wingdi/ns-wingdi-devmodea)作為預設值的來源。</span><span class="sxs-lookup"><span data-stu-id="188c8-150">Enables callers to specify which [**DEVMODE**](/windows/win32/api/wingdi/ns-wingdi-devmodea) is used as the source of default values when a print ticket does not specify all the settings that might be in a **DEVMODE**.</span></span> | <span data-ttu-id="188c8-151">Prntvpt。h</span><span class="sxs-lookup"><span data-stu-id="188c8-151">Prntvpt.h</span></span> |
| [<span data-ttu-id="188c8-152">**EPrintTicketScope**</span><span class="sxs-lookup"><span data-stu-id="188c8-152">**EPrintTicketScope**</span></span>](/windows/desktop/api/prntvpt/ne-prntvpt-eprintticketscope)     | <span data-ttu-id="188c8-153">指定列印票證的範圍。</span><span class="sxs-lookup"><span data-stu-id="188c8-153">Specifies the scope of a print ticket.</span></span>                                                                                                                                                    | <span data-ttu-id="188c8-154">Prntvpt。h</span><span class="sxs-lookup"><span data-stu-id="188c8-154">Prntvpt.h</span></span> |



 

<span data-ttu-id="188c8-155">以下是用來安裝印表機驅動程式的功能。</span><span class="sxs-lookup"><span data-stu-id="188c8-155">The following functions are used to install printer drivers.</span></span>



| <span data-ttu-id="188c8-156">函式</span><span class="sxs-lookup"><span data-stu-id="188c8-156">Function</span></span>                                                                   | <span data-ttu-id="188c8-157">描述</span><span class="sxs-lookup"><span data-stu-id="188c8-157">Description</span></span>                                                                                                                                                                 | <span data-ttu-id="188c8-158">標頭</span><span class="sxs-lookup"><span data-stu-id="188c8-158">Header</span></span>     | <span data-ttu-id="188c8-159">程式庫</span><span class="sxs-lookup"><span data-stu-id="188c8-159">Library</span></span>      |
|----------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------|--------------|
| [<span data-ttu-id="188c8-160">**CorePrinterDriverInstalled**</span><span class="sxs-lookup"><span data-stu-id="188c8-160">**CorePrinterDriverInstalled**</span></span>](coreprinterdriverinstalled.md)           | <span data-ttu-id="188c8-161">報告是否已安裝具有指定之 GUID、日期和版本的核心印表機驅動程式。</span><span class="sxs-lookup"><span data-stu-id="188c8-161">Reports whether a core printer driver with a specified GUID, date, and version is installed.</span></span>                                                                                | <span data-ttu-id="188c8-162">Winspool.drv。h</span><span class="sxs-lookup"><span data-stu-id="188c8-162">Winspool.h</span></span> | <span data-ttu-id="188c8-163">Winspool.drv .lib</span><span class="sxs-lookup"><span data-stu-id="188c8-163">Winspool.lib</span></span> |
| [<span data-ttu-id="188c8-164">**DeletePrinterDriverPackage**</span><span class="sxs-lookup"><span data-stu-id="188c8-164">**DeletePrinterDriverPackage**</span></span>](deleteprinterdriverpackage.md)           | <span data-ttu-id="188c8-165">從驅動程式存放區刪除印表機驅動程式套件。</span><span class="sxs-lookup"><span data-stu-id="188c8-165">Deletes a printer driver package from the driver store.</span></span>                                                                                                                     | <span data-ttu-id="188c8-166">Winspool.drv。h</span><span class="sxs-lookup"><span data-stu-id="188c8-166">Winspool.h</span></span> | <span data-ttu-id="188c8-167">Winspool.drv .lib</span><span class="sxs-lookup"><span data-stu-id="188c8-167">Winspool.lib</span></span> |
| [<span data-ttu-id="188c8-168">**GetCorePrinterDrivers**</span><span class="sxs-lookup"><span data-stu-id="188c8-168">**GetCorePrinterDrivers**</span></span>](getcoreprinterdrivers.md)                     | <span data-ttu-id="188c8-169">取得指定之核心印表機驅動程式的 GUID、版本和日期，以及其套件的路徑。</span><span class="sxs-lookup"><span data-stu-id="188c8-169">Gets the GUID, version, and date of the specified core printer drivers and the path to their packages.</span></span>                                                                      | <span data-ttu-id="188c8-170">Winspool.drv。h</span><span class="sxs-lookup"><span data-stu-id="188c8-170">Winspool.h</span></span> | <span data-ttu-id="188c8-171">Winspool.drv .lib</span><span class="sxs-lookup"><span data-stu-id="188c8-171">Winspool.lib</span></span> |
| [<span data-ttu-id="188c8-172">**GetPrinterDriverPackagePath**</span><span class="sxs-lookup"><span data-stu-id="188c8-172">**GetPrinterDriverPackagePath**</span></span>](getprinterdriverpackagepath.md)         | <span data-ttu-id="188c8-173">取得列印伺服器上指定之印表機驅動程式套件的路徑。</span><span class="sxs-lookup"><span data-stu-id="188c8-173">Gets the path to the specified printer driver package on a print server.</span></span>                                                                                                    | <span data-ttu-id="188c8-174">Winspool.drv。h</span><span class="sxs-lookup"><span data-stu-id="188c8-174">Winspool.h</span></span> | <span data-ttu-id="188c8-175">Winspool.drv .lib</span><span class="sxs-lookup"><span data-stu-id="188c8-175">Winspool.lib</span></span> |
| [<span data-ttu-id="188c8-176">**InstallPrinterDriverFromPackage**</span><span class="sxs-lookup"><span data-stu-id="188c8-176">**InstallPrinterDriverFromPackage**</span></span>](installprinterdriverfrompackage.md) | <span data-ttu-id="188c8-177">從列印伺服器的驅動程式存放區中的驅動程式套件安裝印表機驅動程式。</span><span class="sxs-lookup"><span data-stu-id="188c8-177">Installs a printer driver from a driver package in the print server's driver store.</span></span>                                                                                         | <span data-ttu-id="188c8-178">Winspool.drv。h</span><span class="sxs-lookup"><span data-stu-id="188c8-178">Winspool.h</span></span> | <span data-ttu-id="188c8-179">Winspool.drv .lib</span><span class="sxs-lookup"><span data-stu-id="188c8-179">Winspool.lib</span></span> |
| [<span data-ttu-id="188c8-180">**UploadPrinterDriverPackage**</span><span class="sxs-lookup"><span data-stu-id="188c8-180">**UploadPrinterDriverPackage**</span></span>](uploadprinterdriverpackage.md)           | <span data-ttu-id="188c8-181">將印表機驅動程式上傳至列印伺服器的驅動程式存放區，使其可與 [**InstallPrinterDriverFromPackage**](installprinterdriverfrompackage.md)一起安裝。</span><span class="sxs-lookup"><span data-stu-id="188c8-181">Uploads a printer driver to the driver store of a print server so that it can be installed with [**InstallPrinterDriverFromPackage**](installprinterdriverfrompackage.md).</span></span> | <span data-ttu-id="188c8-182">Winspool.drv。h</span><span class="sxs-lookup"><span data-stu-id="188c8-182">Winspool.h</span></span> | <span data-ttu-id="188c8-183">Winspool.drv .lib</span><span class="sxs-lookup"><span data-stu-id="188c8-183">Winspool.lib</span></span> |



 

<span data-ttu-id="188c8-184">下列函式、列舉和結構可用於列印以及管理印表機和印表機連接。</span><span class="sxs-lookup"><span data-stu-id="188c8-184">The following functions, enumerations, and structures are used for printing and to manage printers and printer connections.</span></span>



| <span data-ttu-id="188c8-185">函式</span><span class="sxs-lookup"><span data-stu-id="188c8-185">Function</span></span>                                               | <span data-ttu-id="188c8-186">描述</span><span class="sxs-lookup"><span data-stu-id="188c8-186">Description</span></span>                                                                                                                                              | <span data-ttu-id="188c8-187">標頭</span><span class="sxs-lookup"><span data-stu-id="188c8-187">Header</span></span>     | <span data-ttu-id="188c8-188">程式庫</span><span class="sxs-lookup"><span data-stu-id="188c8-188">Library</span></span>      |
|--------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------|------------|--------------|
| [<span data-ttu-id="188c8-189">**AddPrinterConnection2**</span><span class="sxs-lookup"><span data-stu-id="188c8-189">**AddPrinterConnection2**</span></span>](addprinterconnection2.md) | <span data-ttu-id="188c8-190">將連接加入至指定的印表機，以供目前的使用者使用。</span><span class="sxs-lookup"><span data-stu-id="188c8-190">Adds a connection to the specified printer for the current user.</span></span>                                                                                         | <span data-ttu-id="188c8-191">Winspool.drv。h</span><span class="sxs-lookup"><span data-stu-id="188c8-191">Winspool.h</span></span> | <span data-ttu-id="188c8-192">Winspool.drv .lib</span><span class="sxs-lookup"><span data-stu-id="188c8-192">Winspool.lib</span></span> |
| [<span data-ttu-id="188c8-193">**OpenPrinter2**</span><span class="sxs-lookup"><span data-stu-id="188c8-193">**OpenPrinter2**</span></span>](openprinter2.md)                   | <span data-ttu-id="188c8-194">在設定部分印表機選項時，抓取指定印表機或列印伺服器的控制碼，或列印子系統中其他類型的控制碼。</span><span class="sxs-lookup"><span data-stu-id="188c8-194">Retrieves a handle to the specified printer or print server or other types of handles in the print subsystem, while setting some of the printer options.</span></span> | <span data-ttu-id="188c8-195">Winspool.drv。h</span><span class="sxs-lookup"><span data-stu-id="188c8-195">Winspool.h</span></span> | <span data-ttu-id="188c8-196">Winspool.drv .lib</span><span class="sxs-lookup"><span data-stu-id="188c8-196">Winspool.lib</span></span> |



 



| <span data-ttu-id="188c8-197">列舉型別</span><span class="sxs-lookup"><span data-stu-id="188c8-197">Enumeration</span></span>                                            | <span data-ttu-id="188c8-198">描述</span><span class="sxs-lookup"><span data-stu-id="188c8-198">Description</span></span>                                                                                       | <span data-ttu-id="188c8-199">標頭</span><span class="sxs-lookup"><span data-stu-id="188c8-199">Header</span></span>     |
|--------------------------------------------------------|---------------------------------------------------------------------------------------------------|------------|
| [<span data-ttu-id="188c8-200">**印表機 \_ 選項 \_ 旗標**</span><span class="sxs-lookup"><span data-stu-id="188c8-200">**PRINTER\_OPTION\_FLAGS**</span></span>](printer-option-flags.md) | <span data-ttu-id="188c8-201">指定以 [**OpenPrinter2**](openprinter2.md)開啟之印表機的控制碼快取。</span><span class="sxs-lookup"><span data-stu-id="188c8-201">Specifies the caching of a handle for a printer opened with [**OpenPrinter2**](openprinter2.md).</span></span> | <span data-ttu-id="188c8-202">Winspool.drv。h</span><span class="sxs-lookup"><span data-stu-id="188c8-202">Winspool.h</span></span> |



 



| <span data-ttu-id="188c8-203">結構</span><span class="sxs-lookup"><span data-stu-id="188c8-203">Structure</span></span>                                                         | <span data-ttu-id="188c8-204">描述</span><span class="sxs-lookup"><span data-stu-id="188c8-204">Description</span></span>                                                                            | <span data-ttu-id="188c8-205">標頭</span><span class="sxs-lookup"><span data-stu-id="188c8-205">Header</span></span>     |
|-------------------------------------------------------------------|----------------------------------------------------------------------------------------|------------|
| [<span data-ttu-id="188c8-206">**核心 \_ 印表機 \_ 驅動程式**</span><span class="sxs-lookup"><span data-stu-id="188c8-206">**CORE\_PRINTER\_DRIVER**</span></span>](core-printer-driver.md)              | <span data-ttu-id="188c8-207">代表其他印表機驅動程式相依的印表機驅動程式。</span><span class="sxs-lookup"><span data-stu-id="188c8-207">Represents a printer driver on which other printer drivers are dependent.</span></span>              | <span data-ttu-id="188c8-208">Winspool.drv。h</span><span class="sxs-lookup"><span data-stu-id="188c8-208">Winspool.h</span></span> |
| [<span data-ttu-id="188c8-209">**驅動程式 \_ 資訊 \_ 8**</span><span class="sxs-lookup"><span data-stu-id="188c8-209">**DRIVER\_INFO\_8**</span></span>](driver-info-8.md)                          | <span data-ttu-id="188c8-210">代表印表機驅動程式。</span><span class="sxs-lookup"><span data-stu-id="188c8-210">Represents a printer driver.</span></span>                                                           | <span data-ttu-id="188c8-211">Winspool.drv。h</span><span class="sxs-lookup"><span data-stu-id="188c8-211">Winspool.h</span></span> |
| [<span data-ttu-id="188c8-212">**表單 \_ 資訊 \_ 2**</span><span class="sxs-lookup"><span data-stu-id="188c8-212">**FORM\_INFO\_2**</span></span>](form-info-2.md)                              | <span data-ttu-id="188c8-213">代表可當地語系化之列印表單的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="188c8-213">Represents information about a localizable print form.</span></span>                                 | <span data-ttu-id="188c8-214">Winspool.drv。h</span><span class="sxs-lookup"><span data-stu-id="188c8-214">Winspool.h</span></span> |
| [<span data-ttu-id="188c8-215">**作業 \_ 資訊 \_ 4**</span><span class="sxs-lookup"><span data-stu-id="188c8-215">**JOB\_INFO\_4**</span></span>](job-info-4.md)                                | <span data-ttu-id="188c8-216">表示與作業相關聯的一組完整值，並支援64位多工緩衝處理檔案。</span><span class="sxs-lookup"><span data-stu-id="188c8-216">Represents a full set of values associated with a job and supports 64 bit spool files.</span></span> | <span data-ttu-id="188c8-217">Winspool.drv。h</span><span class="sxs-lookup"><span data-stu-id="188c8-217">Winspool.h</span></span> |
| [<span data-ttu-id="188c8-218">**印表機 \_ 連接 \_ 資訊 \_ 1**</span><span class="sxs-lookup"><span data-stu-id="188c8-218">**PRINTER\_CONNECTION\_INFO\_1**</span></span>](printer-connection-info-1.md) | <span data-ttu-id="188c8-219">代表印表機連接的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="188c8-219">Represents information about a connection to a printer.</span></span>                                | <span data-ttu-id="188c8-220">Winspool.drv。h</span><span class="sxs-lookup"><span data-stu-id="188c8-220">Winspool.h</span></span> |
| [<span data-ttu-id="188c8-221">**印表機 \_ 選項**</span><span class="sxs-lookup"><span data-stu-id="188c8-221">**PRINTER\_OPTIONS**</span></span>](printer-options.md)                       | <span data-ttu-id="188c8-222">代表印表機選項。</span><span class="sxs-lookup"><span data-stu-id="188c8-222">Represents printer options.</span></span>                                                            | <span data-ttu-id="188c8-223">Winspool.drv。h</span><span class="sxs-lookup"><span data-stu-id="188c8-223">Winspool.h</span></span> |
| [<span data-ttu-id="188c8-224">**PRINTPROCESSOR \_ CAPS \_ 2**</span><span class="sxs-lookup"><span data-stu-id="188c8-224">**PRINTPROCESSOR\_CAPS\_2**</span></span>](printprocessor-caps-2.md)          | <span data-ttu-id="188c8-225">代表印表機功能資訊。</span><span class="sxs-lookup"><span data-stu-id="188c8-225">Represents printer capability information.</span></span>                                             | <span data-ttu-id="188c8-226">Winspool.drv。h</span><span class="sxs-lookup"><span data-stu-id="188c8-226">Winspool.h</span></span> |



 

<span data-ttu-id="188c8-227">下列函數、列舉和介面可用來執行新的非同步列印通知系統。</span><span class="sxs-lookup"><span data-stu-id="188c8-227">The following functions, enumerations, and interfaces are used to implement a new asynchronous printing notification system.</span></span>



| <span data-ttu-id="188c8-228">函式</span><span class="sxs-lookup"><span data-stu-id="188c8-228">Function</span></span>                                                                             | <span data-ttu-id="188c8-229">描述</span><span class="sxs-lookup"><span data-stu-id="188c8-229">Description</span></span>                                                                                                                                                                                       | <span data-ttu-id="188c8-230">標頭</span><span class="sxs-lookup"><span data-stu-id="188c8-230">Header</span></span>     | <span data-ttu-id="188c8-231">程式庫</span><span class="sxs-lookup"><span data-stu-id="188c8-231">Library</span></span>      |
|--------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------|--------------|
| [<span data-ttu-id="188c8-232">**CreatePrintAsyncNotifyChannel**</span><span class="sxs-lookup"><span data-stu-id="188c8-232">**CreatePrintAsyncNotifyChannel**</span></span>](/windows/desktop/api/prnasnot/nf-prnasnot-createprintasyncnotifychannel)               | <span data-ttu-id="188c8-233">在多工緩衝處理器裝載的列印元件之間建立通道，例如列印驅動程式或埠監視器，以及需要從元件接收通知的應用程式。</span><span class="sxs-lookup"><span data-stu-id="188c8-233">Creates a communication channel between the spooler-hosted printing component, such as a print driver or port monitor, and an application that needs to receive notifications from the component.</span></span> | <span data-ttu-id="188c8-234">Prnasnot。h</span><span class="sxs-lookup"><span data-stu-id="188c8-234">Prnasnot.h</span></span> | <span data-ttu-id="188c8-235">Winspool.drv .lib</span><span class="sxs-lookup"><span data-stu-id="188c8-235">Winspool.lib</span></span> |
| [<span data-ttu-id="188c8-236">**RegisterForPrintAsyncNotifications**</span><span class="sxs-lookup"><span data-stu-id="188c8-236">**RegisterForPrintAsyncNotifications**</span></span>](/windows/desktop/api/prnasnot/nf-prnasnot-registerforprintasyncnotifications)     | <span data-ttu-id="188c8-237">註冊應用程式，以接收來自多工緩衝處理器主控元件的通知，例如印表機驅動程式、列印處理器和埠監視器。</span><span class="sxs-lookup"><span data-stu-id="188c8-237">Registers an application to receive notifications from spooler-hosted components such as printer drivers, print processors, and port monitors.</span></span>                                                    | <span data-ttu-id="188c8-238">Prnasnot。h</span><span class="sxs-lookup"><span data-stu-id="188c8-238">Prnasnot.h</span></span> | <span data-ttu-id="188c8-239">Winspool.drv .lib</span><span class="sxs-lookup"><span data-stu-id="188c8-239">Winspool.lib</span></span> |
| [<span data-ttu-id="188c8-240">**UnRegisterForPrintAsyncNotifications**</span><span class="sxs-lookup"><span data-stu-id="188c8-240">**UnRegisterForPrintAsyncNotifications**</span></span>](/windows/desktop/api/prnasnot/nf-prnasnot-unregisterforprintasyncnotifications) | <span data-ttu-id="188c8-241">啟用已註冊的應用程式，以接收來自多工緩衝處理器的列印元件的通知，以結束其對通知的訂閱。</span><span class="sxs-lookup"><span data-stu-id="188c8-241">Enables an application that has registered to receive notifications from spooler-hosted printing components to end its subscription to the notifications.</span></span>                                         | <span data-ttu-id="188c8-242">Prnasnot。h</span><span class="sxs-lookup"><span data-stu-id="188c8-242">Prnasnot.h</span></span> | <span data-ttu-id="188c8-243">Winspool.drv .lib</span><span class="sxs-lookup"><span data-stu-id="188c8-243">Winspool.lib</span></span> |



 



| <span data-ttu-id="188c8-244">列舉型別</span><span class="sxs-lookup"><span data-stu-id="188c8-244">Enumeration</span></span>                                                                    | <span data-ttu-id="188c8-245">描述</span><span class="sxs-lookup"><span data-stu-id="188c8-245">Description</span></span>                                                                                                                                                                                                          | <span data-ttu-id="188c8-246">標頭</span><span class="sxs-lookup"><span data-stu-id="188c8-246">Header</span></span>     |
|--------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------|
| [<span data-ttu-id="188c8-247">**PrintAsyncNotifyConversationStyle**</span><span class="sxs-lookup"><span data-stu-id="188c8-247">**PrintAsyncNotifyConversationStyle**</span></span>](/windows/desktop/api/prnasnot/ne-prnasnot-printasyncnotifyconversationstyle) | <span data-ttu-id="188c8-248">指定應用程式和列印多工緩衝處理器裝載的元件（如印表機驅動程式、列印處理器和埠監視器）之間的通訊是否為雙向或單向。</span><span class="sxs-lookup"><span data-stu-id="188c8-248">Specifies whether communication between applications and Print Spooler-hosted components, such as printer drivers, print processors, and port monitors, is bidirectional or unidirectional.</span></span>                          | <span data-ttu-id="188c8-249">Prnasnot。h</span><span class="sxs-lookup"><span data-stu-id="188c8-249">Prnasnot.h</span></span> |
| [<span data-ttu-id="188c8-250">**PrintAsyncNotifyError**</span><span class="sxs-lookup"><span data-stu-id="188c8-250">**PrintAsyncNotifyError**</span></span>](/windows/desktop/api/prnasnot/ne-prnasnot-printasyncnotifyerror)                         | <span data-ttu-id="188c8-251">指定非同步通知交易中的錯誤。</span><span class="sxs-lookup"><span data-stu-id="188c8-251">Specifies an error in an asynchronous notification transaction.</span></span>                                                                                                                                                      | <span data-ttu-id="188c8-252">Prnasnot。h</span><span class="sxs-lookup"><span data-stu-id="188c8-252">Prnasnot.h</span></span> |
| [<span data-ttu-id="188c8-253">**PrintAsyncNotifyUserFilter**</span><span class="sxs-lookup"><span data-stu-id="188c8-253">**PrintAsyncNotifyUserFilter**</span></span>](/windows/desktop/api/prnasnot/ne-prnasnot-printasyncnotifyuserfilter)               | <span data-ttu-id="188c8-254">指定通知是否只會傳送給與「列印多工緩衝處理器」主控的寄件者相關聯的應用程式，或是否要移至一組更廣泛的接聽應用程式。</span><span class="sxs-lookup"><span data-stu-id="188c8-254">Specifies whether notifications will go only to listening applications that are associated with the same user as the Print Spooler-hosted sender or whether they will go to a broader set of listening applications.</span></span> | <span data-ttu-id="188c8-255">Prnasnot。h</span><span class="sxs-lookup"><span data-stu-id="188c8-255">Prnasnot.h</span></span> |



 



| <span data-ttu-id="188c8-256">介面和方法</span><span class="sxs-lookup"><span data-stu-id="188c8-256">Interface and method</span></span>                                                                                                      | <span data-ttu-id="188c8-257">描述</span><span class="sxs-lookup"><span data-stu-id="188c8-257">Description</span></span>                                                                                                                                                   | <span data-ttu-id="188c8-258">標頭</span><span class="sxs-lookup"><span data-stu-id="188c8-258">Header</span></span>     | <span data-ttu-id="188c8-259">程式庫</span><span class="sxs-lookup"><span data-stu-id="188c8-259">Library</span></span>      |
|---------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------|------------|--------------|
| [<span data-ttu-id="188c8-260">**IPrintAsyncNotifyCallback::ChannelClosed**</span><span class="sxs-lookup"><span data-stu-id="188c8-260">**IPrintAsyncNotifyCallback::ChannelClosed**</span></span>](/windows/desktop/api/prnasnot/nf-prnasnot-iprintasyncnotifycallback-channelclosed)    | <span data-ttu-id="188c8-261">由通道的一個成員用來通知另一個要關閉通道的成員。</span><span class="sxs-lookup"><span data-stu-id="188c8-261">Used by one member of a communication channel to advise the other member that the channel is being closed.</span></span>                                                    | <span data-ttu-id="188c8-262">Prnasnot。h</span><span class="sxs-lookup"><span data-stu-id="188c8-262">Prnasnot.h</span></span> | <span data-ttu-id="188c8-263">Winspool.drv .lib</span><span class="sxs-lookup"><span data-stu-id="188c8-263">Winspool.lib</span></span> |
| [<span data-ttu-id="188c8-264">**IPrintAsyncNotifyCallback::OnEventNotify**</span><span class="sxs-lookup"><span data-stu-id="188c8-264">**IPrintAsyncNotifyCallback::OnEventNotify**</span></span>](/windows/desktop/api/prnasnot/nf-prnasnot-iprintasyncnotifycallback-oneventnotify)    | <span data-ttu-id="188c8-265">由列印多工緩衝處理器呼叫，以警示接聽程式，通知可用於指定的通道。</span><span class="sxs-lookup"><span data-stu-id="188c8-265">Called by the Print Spooler to alert a listener that a notification is available on a specified channel.</span></span>                                                      | <span data-ttu-id="188c8-266">Prnasnot。h</span><span class="sxs-lookup"><span data-stu-id="188c8-266">Prnasnot.h</span></span> | <span data-ttu-id="188c8-267">Winspool.drv .lib</span><span class="sxs-lookup"><span data-stu-id="188c8-267">Winspool.lib</span></span> |
| [<span data-ttu-id="188c8-268">**IPrintAsyncNotifyChannel::CloseChannel**</span><span class="sxs-lookup"><span data-stu-id="188c8-268">**IPrintAsyncNotifyChannel::CloseChannel**</span></span>](/windows/desktop/api/prnasnot/nf-prnasnot-iprintasyncnotifychannel-closechannel)         | <span data-ttu-id="188c8-269">關閉通道。</span><span class="sxs-lookup"><span data-stu-id="188c8-269">Closes a communication channel.</span></span>                                                                                                                               | <span data-ttu-id="188c8-270">Prnasnot。h</span><span class="sxs-lookup"><span data-stu-id="188c8-270">Prnasnot.h</span></span> | <span data-ttu-id="188c8-271">Winspool.drv .lib</span><span class="sxs-lookup"><span data-stu-id="188c8-271">Winspool.lib</span></span> |
| [<span data-ttu-id="188c8-272">**IPrintAsyncNotifyChannel：： SendNotification**</span><span class="sxs-lookup"><span data-stu-id="188c8-272">**IPrintAsyncNotifyChannel::SendNotification**</span></span>](/windows/desktop/api/prnasnot/nf-prnasnot-iprintasyncnotifychannel-sendnotification) | <span data-ttu-id="188c8-273">將來自「列印多工緩衝處理器」元件的通知傳送至一或多個接聽的應用程式，或將應用程式的回應傳送回元件。</span><span class="sxs-lookup"><span data-stu-id="188c8-273">Sends a notification from a Print Spooler-hosted component to one or more listening applications or sends a response from an application back to a component.</span></span> | <span data-ttu-id="188c8-274">Prnasnot。h</span><span class="sxs-lookup"><span data-stu-id="188c8-274">Prnasnot.h</span></span> | <span data-ttu-id="188c8-275">Winspool.drv .lib</span><span class="sxs-lookup"><span data-stu-id="188c8-275">Winspool.lib</span></span> |
| [<span data-ttu-id="188c8-276">**IPrintAsyncNotifyDataObject::AcquireData**</span><span class="sxs-lookup"><span data-stu-id="188c8-276">**IPrintAsyncNotifyDataObject::AcquireData**</span></span>](/windows/desktop/api/prnasnot/nf-prnasnot-iprintasyncnotifydataobject-acquiredata)  | <span data-ttu-id="188c8-277">將接聽應用程式的端點指向通知資料，以及資料的大小和類型。</span><span class="sxs-lookup"><span data-stu-id="188c8-277">Points listening applications to the notification data as well as the data's size and type.</span></span>                                                                   | <span data-ttu-id="188c8-278">Prnasnot。h</span><span class="sxs-lookup"><span data-stu-id="188c8-278">Prnasnot.h</span></span> | <span data-ttu-id="188c8-279">Winspool.drv .lib</span><span class="sxs-lookup"><span data-stu-id="188c8-279">Winspool.lib</span></span> |
| [<span data-ttu-id="188c8-280">**IPrintAsyncNotifyDataObject::ReleaseData**</span><span class="sxs-lookup"><span data-stu-id="188c8-280">**IPrintAsyncNotifyDataObject::ReleaseData**</span></span>](/windows/desktop/api/prnasnot/nf-prnasnot-iprintasyncnotifydataobject-releasedata)  | <span data-ttu-id="188c8-281">釋放封裝在 [**IPrintAsyncNotifyDataObject**](/windows/desktop/api/prnasnot/nn-prnasnot-iprintasyncnotifydataobject)中的資料所使用的記憶體。</span><span class="sxs-lookup"><span data-stu-id="188c8-281">Releases the memory used by the data encapsulated in the [**IPrintAsyncNotifyDataObject**](/windows/desktop/api/prnasnot/nn-prnasnot-iprintasyncnotifydataobject).</span></span>                                  | <span data-ttu-id="188c8-282">Prnasnot。h</span><span class="sxs-lookup"><span data-stu-id="188c8-282">Prnasnot.h</span></span> | <span data-ttu-id="188c8-283">Winspool.drv .lib</span><span class="sxs-lookup"><span data-stu-id="188c8-283">Winspool.lib</span></span> |



 

<span data-ttu-id="188c8-284">下列列舉和結構會用來叫用 Microsoft XPS 檔轉換器 (MXDC) 將 XML 檔規格 (XPS) 檔寫入至裝置或檔案。</span><span class="sxs-lookup"><span data-stu-id="188c8-284">The following enumeration and structures are used for invoking the Microsoft XPS Document Converter (MXDC) which writes XML Paper Specification (XPS) documents to a device or file.</span></span>



| <span data-ttu-id="188c8-285">列舉型別</span><span class="sxs-lookup"><span data-stu-id="188c8-285">Enumeration</span></span>                                | <span data-ttu-id="188c8-286">描述</span><span class="sxs-lookup"><span data-stu-id="188c8-286">Description</span></span>                                                            | <span data-ttu-id="188c8-287">標頭</span><span class="sxs-lookup"><span data-stu-id="188c8-287">Header</span></span> |
|--------------------------------------------|------------------------------------------------------------------------|--------|
| [<span data-ttu-id="188c8-288">**MxdcS0PageEnums**</span><span class="sxs-lookup"><span data-stu-id="188c8-288">**MxdcS0PageEnums**</span></span>](mxdcs0pageenums.md) | <span data-ttu-id="188c8-289">指定 XPS 頁面上的資源類型，例如字型或影像。</span><span class="sxs-lookup"><span data-stu-id="188c8-289">Specifies types of resources, such as fonts or images, on an XPS page.</span></span> | <span data-ttu-id="188c8-290">Mxdc。h</span><span class="sxs-lookup"><span data-stu-id="188c8-290">Mxdc.h</span></span> |



 



| <span data-ttu-id="188c8-291">結構</span><span class="sxs-lookup"><span data-stu-id="188c8-291">Structure</span></span>                                                          | <span data-ttu-id="188c8-292">描述</span><span class="sxs-lookup"><span data-stu-id="188c8-292">Description</span></span>                                                                                                                                    | <span data-ttu-id="188c8-293">標頭</span><span class="sxs-lookup"><span data-stu-id="188c8-293">Header</span></span> |
|--------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------|--------|
| [<span data-ttu-id="188c8-294">**MxdcEscapeHeader**</span><span class="sxs-lookup"><span data-stu-id="188c8-294">**MxdcEscapeHeader**</span></span>](mxdcescapeheader.md)                       | <span data-ttu-id="188c8-295">表示 MXDC 的指示。</span><span class="sxs-lookup"><span data-stu-id="188c8-295">Represents an instruction to the MXDC.</span></span>                                                                                                         | <span data-ttu-id="188c8-296">Mxdc。h</span><span class="sxs-lookup"><span data-stu-id="188c8-296">Mxdc.h</span></span> |
| [<span data-ttu-id="188c8-297">**MxdcGetFileNameData**</span><span class="sxs-lookup"><span data-stu-id="188c8-297">**MxdcGetFileNameData**</span></span>](mxdcgetfilenamedata.md)                 | <span data-ttu-id="188c8-298">代表 MXDC 輸出檔的完整路徑和名稱。</span><span class="sxs-lookup"><span data-stu-id="188c8-298">Represents the full path and name for an MXDC output file.</span></span>                                                                                     | <span data-ttu-id="188c8-299">Mxdc。h</span><span class="sxs-lookup"><span data-stu-id="188c8-299">Mxdc.h</span></span> |
| [<span data-ttu-id="188c8-300">**MxdcPrintTicketEscape**</span><span class="sxs-lookup"><span data-stu-id="188c8-300">**MxdcPrintTicketEscape**</span></span>](mxdcprintticketescape.md)             | <span data-ttu-id="188c8-301">表示 [**MxdcEscapeHeader**](mxdcescapeheader.md) 和 [**MxdcPrintTicketPassthrough**](mxdcprintticketpassthrough.md)的組合。</span><span class="sxs-lookup"><span data-stu-id="188c8-301">Represents a combination of [**MxdcEscapeHeader**](mxdcescapeheader.md) and [**MxdcPrintTicketPassthrough**](mxdcprintticketpassthrough.md).</span></span> | <span data-ttu-id="188c8-302">Mxdc。h</span><span class="sxs-lookup"><span data-stu-id="188c8-302">Mxdc.h</span></span> |
| [<span data-ttu-id="188c8-303">**MxdcPrintTicketPassthrough**</span><span class="sxs-lookup"><span data-stu-id="188c8-303">**MxdcPrintTicketPassthrough**</span></span>](mxdcprintticketpassthrough.md)   | <span data-ttu-id="188c8-304">代表將與 XPS 檔相關聯的列印票證。</span><span class="sxs-lookup"><span data-stu-id="188c8-304">Represents a print ticket that will be associated with an XPS document.</span></span>                                                                        | <span data-ttu-id="188c8-305">Mxdc。h</span><span class="sxs-lookup"><span data-stu-id="188c8-305">Mxdc.h</span></span> |
| [<span data-ttu-id="188c8-306">**MxdcS0PageData**</span><span class="sxs-lookup"><span data-stu-id="188c8-306">**MxdcS0PageData**</span></span>](mxdcs0pagedata.md)                           | <span data-ttu-id="188c8-307">代表要傳遞給 MXDC 輸出檔的 XPS 格式頁面，而不進行任何處理。</span><span class="sxs-lookup"><span data-stu-id="188c8-307">Represents an XPS-formatted page to be passed to the MXDC output file without any processing.</span></span>                                                  | <span data-ttu-id="188c8-308">Mxdc。h</span><span class="sxs-lookup"><span data-stu-id="188c8-308">Mxdc.h</span></span> |
| [<span data-ttu-id="188c8-309">**MxdcS0PagePassthroughEscape**</span><span class="sxs-lookup"><span data-stu-id="188c8-309">**MxdcS0PagePassthroughEscape**</span></span>](mxdcs0pagepassthroughescape.md) | <span data-ttu-id="188c8-310">表示 [**MxdcEscapeHeader**](mxdcescapeheader.md) 和 [**MxdcS0PageData**](mxdcs0pagedata.md)的組合。</span><span class="sxs-lookup"><span data-stu-id="188c8-310">Represents a combination of [**MxdcEscapeHeader**](mxdcescapeheader.md) and [**MxdcS0PageData**](mxdcs0pagedata.md).</span></span>                         | <span data-ttu-id="188c8-311">Mxdc。h</span><span class="sxs-lookup"><span data-stu-id="188c8-311">Mxdc.h</span></span> |
| [<span data-ttu-id="188c8-312">**MxdcS0PageResourceEscape**</span><span class="sxs-lookup"><span data-stu-id="188c8-312">**MxdcS0PageResourceEscape**</span></span>](mxdcs0pageresourceescape.md)       | <span data-ttu-id="188c8-313">表示 [**MxdcEscapeHeader**](mxdcescapeheader.md) 和 [**MxdcS0PageResource**](mxdcs0pageresourceescape.md)的組合。</span><span class="sxs-lookup"><span data-stu-id="188c8-313">Represents a combination of [**MxdcEscapeHeader**](mxdcescapeheader.md) and [**MxdcS0PageResource**](mxdcs0pageresourceescape.md).</span></span>           | <span data-ttu-id="188c8-314">Mxdc。h</span><span class="sxs-lookup"><span data-stu-id="188c8-314">Mxdc.h</span></span> |
| [<span data-ttu-id="188c8-315">**MxdcS0PageResource**</span><span class="sxs-lookup"><span data-stu-id="188c8-315">**MxdcS0PageResource**</span></span>](mxdcs0pageresourceescape.md)             | <span data-ttu-id="188c8-316">代表 MXDC 在 XPS 頁面上包含的資源，例如字型或影像。</span><span class="sxs-lookup"><span data-stu-id="188c8-316">Represents a resource, such as a font or image, that is included on an XPS page by the MXDC.</span></span>                                                   | <span data-ttu-id="188c8-317">Mxdc。h</span><span class="sxs-lookup"><span data-stu-id="188c8-317">Mxdc.h</span></span> |



 

 

 
