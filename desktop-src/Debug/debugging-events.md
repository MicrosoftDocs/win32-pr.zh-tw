---
description: 偵錯工具事件是正在進行調試的進程中，導致系統通知偵錯工具的事件。
ms.assetid: 43ca51f1-ba73-4031-96c3-5815311ce6f6
title: 調試事件
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: bee6d159dded992e56ac05bc1d751246cd051733
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/07/2021
ms.locfileid: "104025821"
---
# <a name="debugging-events"></a>調試事件

偵錯工具事件是正在進行調試的進程中，導致系統通知偵錯工具的事件。 偵錯工具事件包括建立進程、建立執行緒、載入動態連結程式庫 (DLL) 、卸載 DLL、傳送輸出字串，以及產生例外狀況。

如果偵錯工具在等候一個事件時發生，系統會以描述事件的資訊填入 [**WaitForDebugEvent**](/windows/win32/api/debugapi/nf-debugapi-waitfordebugevent)所指定的 [**DEBUG \_ 事件**](/windows/win32/api/minwinbase/ns-minwinbase-debug_event)結構。

當系統通知偵錯工具的偵錯工具時，它也會暫止受影響進程中的所有線程。 除非偵錯工具使用 [**ContinueDebugEvent**](/windows/win32/api/debugapi/nf-debugapi-continuedebugevent)繼續進行偵錯工具，否則執行緒不會繼續執行。 偵錯工具時可能會發生下列偵錯工具事件。



| 調試事件                          | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 建立 \_ 進程的 \_ 偵錯工具 \_ 事件<br/> | 每當在要進行調試的進程中建立新進程時，或每當偵錯工具開始進行已在使用中的進程時，就會產生。 系統會在進程開始以使用者模式執行之前，以及在系統為新的進程產生任何其他的偵測事件之前，先產生此偵錯工具事件。 <br/> [**Debug \_ 事件**](/windows/win32/api/minwinbase/ns-minwinbase-debug_event)結構包含 [**CREATE \_ PROCESS \_ DEBUG \_ INFO**](/windows/win32/api/minwinbase/ns-minwinbase-create_process_debug_info)結構。 此結構包含新進程的控制碼、進程的影像檔控制碼、進程初始執行緒的控制碼，以及其他描述新進程的資訊。<br/> 進程的控制碼具有進程 \_ vm \_ 讀取和處理 \_ vm \_ 寫入存取權。 如果偵錯工具有線程的這些存取類型，則可以使用 [**ReadProcessMemory**](/windows/win32/api/memoryapi/nf-memoryapi-readprocessmemory) 和 [**WriteProcessMemory**](/windows/win32/api/memoryapi/nf-memoryapi-writeprocessmemory) 函式來讀取和寫入進程的記憶體。 如果系統先前回報了「結束 \_ 處理常式」 \_ \_ 事件事件，則當偵錯工具呼叫 [**ContinueDebugEvent**](/windows/win32/api/debugapi/nf-debugapi-continuedebugevent) 函式時，系統會關閉這個控制碼。<br/> 進程之影像檔案的控制碼具有一般 \_ 讀取權限，並且會開啟以供讀取共用。 偵錯工具在處理建立 \_ 進程的偵錯工具時，應該關閉這個控制碼 \_ \_ 。<br/> 進程初始執行緒的控制碼具有線程 \_ GET \_ 內容、執行緒 \_ 集 \_ 內容，以及執行緒暫止 \_ \_ 繼續存取執行緒。 如果偵錯工具有線程的這些存取類型，則可以使用 [**GetThreadCoNtext**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-getthreadcontext) 和 [**SetThreadCoNtext**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-setthreadcontext) 函式來讀取和寫入執行緒的暫存器，並且可以使用 [**SuspendThread**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-suspendthread) 和 [**ResumeThread**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-resumethread) 函式來暫止和繼續執行緒。 如果系統先前回報了「結束 \_ 處理常式」 \_ \_ 事件事件，則當偵錯工具呼叫 [**ContinueDebugEvent**](/windows/win32/api/debugapi/nf-debugapi-continuedebugevent) 函式時，系統會關閉這個控制碼。<br/> |
| 建立 \_ 執行緒 \_ 調試 \_ 事件<br/>  | 每當在要進行調試的進程中建立新的執行緒時，或每當偵錯工具開始進行已在使用中的進程時，就會產生。 在新執行緒開始以使用者模式執行之前，會產生此偵錯工具事件。 <br/> [**Debug \_ 事件**](/windows/win32/api/minwinbase/ns-minwinbase-debug_event)結構包含 [**建立執行緒的 \_ \_ debug \_ 資訊**](/windows/win32/api/minwinbase/ns-minwinbase-create_thread_debug_info)結構。 此結構包含新執行緒的控制碼和執行緒的起始位址。 控制碼具有線程 \_ GET \_ 內容、執行緒 \_ 集 \_ 內容，以及執行緒 \_ 暫止 \_ 繼續存取執行緒。 如果偵錯工具有線程的這些存取類型，則可以使用 [**GetThreadCoNtext**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-getthreadcontext) 和 [**SetThreadCoNtext**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-setthreadcontext) 函式來讀取和寫入執行緒的暫存器，並且可以使用 [**SuspendThread**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-suspendthread) 和 [**ResumeThread**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-resumethread) 函式來暫止和繼續執行緒。<br/> 如果系統先前回報了「結束 \_ 執行緒偵測」 \_ \_ 事件事件，則當偵錯工具呼叫 [**ContinueDebugEvent**](/windows/win32/api/debugapi/nf-debugapi-continuedebugevent) 函式時，系統會關閉新執行緒的控制碼。<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| 例外狀況 \_ 調試 \_ 事件<br/>       | 在所要進行的進程中發生例外狀況時產生。 可能的例外狀況包括嘗試存取無法存取的記憶體、執行中斷點指令、嘗試零除，或 [結構化例外狀況處理](structured-exception-handling.md)中注明的任何其他例外狀況。 <br/> [**Debug \_ 事件**](/windows/win32/api/minwinbase/ns-minwinbase-debug_event)結構包含例外狀況 [**的 \_ 調試 \_ 資訊**](/windows/win32/api/minwinbase/ns-minwinbase-exception_debug_info)結構。 此結構描述造成偵錯工具事件的例外狀況。<br/> 除了標準例外狀況以外，在主控台進程的偵錯工具期間可能會發生額外的例外狀況代碼。 \_ \_ 當 Ctrl + c 是輸入至處理 Ctrl + c 信號且正在進行調試的主控台進程時，系統會產生一個 DBG 控制項 C 例外狀況程式碼。 此例外狀況程式碼不應由應用程式處理。 應用程式絕對不應該使用例外狀況處理常式來處理它。 它只會針對偵錯工具的優點引發，而且只會在偵錯工具連接到主控台進程時使用。<br/> 如果處理常式不在進行中，或偵錯工具 \_ \_ 透過 gn 命令) ，而無法處理 (的 DBG 控制項 C 例外狀況，則會搜尋應用程式函式的清單（如 [**SetConsoleCtrlHandler**](/windows/console/setconsolectrlhandler) 函式所述）。<br/> 如果偵錯工具 \_ \_ 透過 gh 命令) 處理 DBG CONTROL C 例外 (，應用程式將不會注意到 CTRL + C，除非在類似下面的程式碼中。<br/> `while ((inputChar = getchar()) != EOF) ...`<br/> 因此，偵錯工具無法用來停止終止這類程式碼中的讀取等候。<br/>                                                                                                                                                                                                                                                                                                                                                                                                                           |
| 結束 \_ 進程的 \_ 偵錯工具 \_ 事件<br/>   | 每當正在進行的進程中的最後一個執行緒結束時就會產生。 當系統卸載進程的 Dll 並更新進程的結束代碼時，就會立即發生這個偵錯工具事件。 <br/> [**Debug \_ 事件**](/windows/win32/api/minwinbase/ns-minwinbase-debug_event)結構包含可指定結束代碼的結束 [**處理常式 \_ \_ DEBUG \_ 資訊**](/windows/win32/api/minwinbase/ns-minwinbase-exit_process_debug_info)結構。<br/> 偵錯工具會在收到此偵錯工具時，解除配置與進程相關聯的任何內部結構。 系統會關閉偵錯工具對結束進程的控制碼，以及所有進程的執行緒。 偵錯工具不應關閉這些控制碼。<br/> 在接收此事件的偵錯工具呼叫 [**ContinueDebugEvent**](/windows/win32/api/debugapi/nf-debugapi-continuedebugevent)之前，無法完成進程關機的核心模式部分。 在那之前，進程控制碼是開啟的，而且不會釋放虛擬位址空間，因此偵錯工具可以檢查子進程。 若要在處理常式關閉的核心模式部分完成時收到通知，請複製以 CREATE process DEBUG 事件傳回的控制碼 \_ \_ \_ ，然後呼叫 **ContinueDebugEvent**，然後等候重複的進程控制碼收到信號。<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| 結束 \_ 執行緒 \_ 調試 \_ 事件<br/>    | 每次在正在進行調試的進程中的執行緒結束時產生。 系統會在更新執行緒的結束代碼之後，立即產生此偵錯工具事件。 <br/> [**DEBUG \_ 事件**](/windows/win32/api/minwinbase/ns-minwinbase-debug_event)結構包含結束 [**執行緒的 \_ \_ debug \_ 資訊**](/windows/win32/api/minwinbase/ns-minwinbase-exit_thread_debug_info)結構，可指定結束代碼。<br/> 如果結束的執行緒是進程的最後一個執行緒，就不會發生這個偵錯工具事件。 在此情況下，會改為執行「結束處理常式偵錯工具」事件 \_ \_ 偵錯工具 \_ 。<br/> 偵錯工具會在收到此偵錯工具事件時，解除配置與執行緒相關聯的任何內部結構。 系統會關閉偵錯工具對離開執行緒的控制碼。 偵錯工具不應該關閉這個控制碼。<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| 載入 \_ DLL \_ DEBUG \_ 事件<br/>       | 每次正在調試的進程載入 DLL 時產生。 當系統載入器解析 DLL 的連結，或當已調試的進程使用 [**LoadLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya) 函式時，就會發生這個偵錯工具事件。 只有在系統第一次將 DLL 附加至進程的虛擬位址空間時，才會發生這個偵錯工具事件。 <br/> [**Debug \_ 事件**](/windows/win32/api/minwinbase/ns-minwinbase-debug_event)結構包含 [**載入 DLL 的 \_ \_ 調試 \_ 資訊**](/windows/win32/api/minwinbase/ns-minwinbase-load_dll_debug_info)結構。 此結構包含新載入之 DLL 的控制碼、DLL 的基底位址，以及描述 DLL 的其他資訊。 偵錯工具應該在處理載入 \_ dll DEBUG 事件時關閉 DLL 控制碼的控制碼 \_ \_ 。<br/> 一般情況下，偵錯工具會在收到此偵錯工具事件時載入與 DLL 相關聯的符號資料表。<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| 輸出 \_ DEBUG \_ 字串 \_ 事件<br/>  | 在正在進行調試的進程使用時產生 <br/>[**OutputDebugString**](/windows/win32/api/debugapi/nf-debugapi-outputdebugstringa) 函式。 [**Debug \_ 事件**](/windows/win32/api/minwinbase/ns-minwinbase-debug_event)結構包含輸出的 [**\_ debug \_ 字串 \_ 資訊**](/windows/win32/api/minwinbase/ns-minwinbase-output_debug_string_info)結構。 此結構會指定偵錯工具字串的位址、長度和格式。<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| 卸載 \_ DLL \_ DEBUG \_ 事件<br/>     | 每次使用 [**FreeLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-freelibrary) 函式來卸載 DLL 時，就會產生。 這個偵錯工具只會在最後一次從進程的位址空間卸載 DLL 時 (也就是，當 DLL 的使用計數為零) 時。 <br/> [**Debug \_ 事件**](/windows/win32/api/minwinbase/ns-minwinbase-debug_event)結構包含卸載 [**DLL 的 \_ \_ debug \_ 資訊**](/windows/win32/api/minwinbase/ns-minwinbase-unload_dll_debug_info)結構。 此結構會在卸載 DLL 之進程的位址空間中，指定 DLL 的基底位址。<br/> 通常，偵錯工具會在收到此偵錯工具事件時，卸載與 DLL 相關聯的符號資料表。<br/> 當進程結束時，系統會自動卸載進程的 Dll，但不會產生卸載 dll 的 \_ 偵錯工具事件 \_ \_ 。<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| RIP \_ 事件<br/>                    | 每當正在調試的進程在系統偵錯工具的控制範圍外發生時產生。<br/> [**DEBUG \_ 事件**](/windows/win32/api/minwinbase/ns-minwinbase-debug_event)結構包含 [**RIP \_ 資訊**](/windows/win32/api/minwinbase/ns-minwinbase-rip_info)結構。 此結構會指定錯誤和錯誤類型。<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |



 

 

 
