---
title: IIS 主機外掛程式設定
description: Windows 遠端管理 (WinRM) Internet Information Services (IIS) 主機外掛程式設定提供了一種裝載機制，可讓協力廠商 WinRM 外掛程式公開 WinRM 基礎結構內的管理資料。
ms.assetid: 234e6f7b-310f-499a-83e4-699ecf3816f0
ms.tgt_platform: multiple
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 714139c25836f5929ca6cfa3fe6797a90e80dde8
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/20/2020
ms.locfileid: "103933272"
---
# <a name="iis-host-plug-in-configuration"></a><span data-ttu-id="0dcf2-103">IIS 主機外掛程式設定</span><span class="sxs-lookup"><span data-stu-id="0dcf2-103">IIS Host Plug-in Configuration</span></span>

<span data-ttu-id="0dcf2-104">Windows 遠端管理 (WinRM) Internet Information Services (IIS) 主機外掛程式設定提供了一種裝載機制，可讓協力廠商 WinRM 外掛程式公開 WinRM 基礎結構內的管理資料。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-104">The Windows Remote Management (WinRM) Internet Information Services (IIS) host plug-in configuration provides a hosting mechanism that allows third-party WinRM plug-ins to expose management data within the WinRM infrastructure.</span></span>

<span data-ttu-id="0dcf2-105">下列各節說明 IIS 主機外掛程式設定：</span><span class="sxs-lookup"><span data-stu-id="0dcf2-105">The following sections describe IIS host plug-in configuration:</span></span>

-   [<span data-ttu-id="0dcf2-106">IIS 裝載詳細資料</span><span class="sxs-lookup"><span data-stu-id="0dcf2-106">IIS Hosting Details</span></span>](#iis-hosting-details)
-   [<span data-ttu-id="0dcf2-107">IIS 主機配置模型</span><span class="sxs-lookup"><span data-stu-id="0dcf2-107">IIS Host Configuration Model</span></span>](#iis-host-configuration-model)
-   [<span data-ttu-id="0dcf2-108">IIS 主機 (WinRM) 設定設定和詳細資料</span><span class="sxs-lookup"><span data-stu-id="0dcf2-108">IIS Host (WinRM) Configuration Setup and Details</span></span>](/windows)
-   [<span data-ttu-id="0dcf2-109">正在讀取 IIS 主機設定</span><span class="sxs-lookup"><span data-stu-id="0dcf2-109">Reading IIS Host Configuration</span></span>](#reading-iis-host-configuration)
-   [<span data-ttu-id="0dcf2-110">列舉 WinRM 服務上的外掛程式</span><span class="sxs-lookup"><span data-stu-id="0dcf2-110">Enumerating Plug-ins on the WinRM Service</span></span>](#enumerating-plug-ins-on-the-winrm-service)

## <a name="iis-hosting-details"></a><span data-ttu-id="0dcf2-111">IIS 裝載詳細資料</span><span class="sxs-lookup"><span data-stu-id="0dcf2-111">IIS Hosting Details</span></span>

<span data-ttu-id="0dcf2-112">在 IIS 中設定和初始化 WinRM SOAP 處理器的應用程式，將會使用 WS-Management 的通訊協定，直接從另一部電腦上的 WinRM 用戶端接收要求。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-112">An application that configures and initializes the WinRM SOAP processor in IIS will receive requests directly from a WinRM client on another computer using the WS-Management protocol.</span></span> <span data-ttu-id="0dcf2-113">應用程式也必須設定 HTTP 端點，以識別應用程式，以確保所有要求都會直接路由傳送至應用程式特定的外掛程式。應用程式也必須設定要將哪些外掛程式載入至 IIS 主機，以及所需的授權和驗證機制。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-113">The application must also configure an HTTP endpoint that identifies the application to ensure that all requests get routed directly to the application-specific plug-ins. The application must also configure which plug-ins to load in to the IIS host and the authorization and authentication mechanisms that are needed.</span></span> <span data-ttu-id="0dcf2-114">在 IIS 中使用 WinRM 服務時，應該考慮下列因素：</span><span class="sxs-lookup"><span data-stu-id="0dcf2-114">When using the WinRM service within IIS, the following factors should be considered:</span></span>

-   <span data-ttu-id="0dcf2-115">根據預設，IIS 不支援 Kerberos 驗證。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-115">IIS does not support Kerberos authentication by default.</span></span> <span data-ttu-id="0dcf2-116">不過，您可以建立 IIS 模組來支援 Kerberos 驗證。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-116">However, an IIS module can be created to support Kerberos authentication.</span></span>
-   <span data-ttu-id="0dcf2-117">IIS 服務將不會透過 HTTP 接受加密的 WinRM 服務要求。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-117">The IIS service will not accept encrypted WinRM service requests over HTTP.</span></span>
-   <span data-ttu-id="0dcf2-118">設定 IIS 端點之後，您以隱含認證傳送的第一個要求將會失敗;不過，所有後續的要求都會成功。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-118">After you set up an IIS endpoint, the first request you send with implicit credentials will fail; however, all subsequent requests will succeed.</span></span> <span data-ttu-id="0dcf2-119">這是使用預設核心模式驗證所設定的 IIS 網站的已知問題。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-119">This is a known issue with an IIS site configured with the default kernel mode authentication.</span></span> <span data-ttu-id="0dcf2-120">如果這是封鎖問題，建議您關閉核心模式驗證。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-120">If this is a blocking issue, it is recommended that you turn off kernel mode authentication.</span></span>

## <a name="iis-host-configuration-model"></a><span data-ttu-id="0dcf2-121">IIS 主機配置模型</span><span class="sxs-lookup"><span data-stu-id="0dcf2-121">IIS Host Configuration Model</span></span>

<span data-ttu-id="0dcf2-122">在 IIS 中裝載 WinRM 簡單物件存取通訊協定 (SOAP) 處理器的所有應用程式都必須先進行設定，才能運作。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-122">All applications that host a WinRM Simple Object Access Protocol (SOAP) processor in IIS require configuration before they will function.</span></span>

<span data-ttu-id="0dcf2-123">每個應用程式設定與其他應用程式的設定不同。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-123">Each application configuration is separate from that of other applications.</span></span> <span data-ttu-id="0dcf2-124">以下是必要的設定集合，雖然可能並非所有的設定都需要變更，而是透過主要 WinRM 服務完成：</span><span class="sxs-lookup"><span data-stu-id="0dcf2-124">The following sets of configurations are necessary, although possibly not all the configurations need to be changed, and they are done through the main WinRM service:</span></span>

-   <span data-ttu-id="0dcf2-125">一般應用程式設定，包含作業超時。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-125">General application configuration, including operation time-outs.</span></span>
-   <span data-ttu-id="0dcf2-126">授權外掛程式，可授權 LiveID 要求或將 Windows 使用者帳戶對應到更一般的服務帳戶。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-126">An authorization plug-in for authorizing LiveID requests or mapping the Windows user account to a more generic service account.</span></span>
-   <span data-ttu-id="0dcf2-127">WinRM SOAP 處理器要裝載和使用的作業外掛程式，以執行實際的要求。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-127">Operation plug-ins to be hosted and used by the WinRM SOAP processor to carry out the actual requests.</span></span>

<span data-ttu-id="0dcf2-128">下列設定可能需要在 IIS 內設定：</span><span class="sxs-lookup"><span data-stu-id="0dcf2-128">The following configurations might need to be configured within IIS:</span></span>

-   <span data-ttu-id="0dcf2-129">定義埠和位址要接聽要求的接聽 [*程式端點資訊*](windows-remote-management-glossary.md)，以及任何安全通訊端層 (SSL) 憑證。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-129">[*Listener*](windows-remote-management-glossary.md) endpoint information defining what ports and addresses are listening for requests along with any Secure Sockets Layer (SSL) certificates.</span></span>
-   <span data-ttu-id="0dcf2-130">將用戶端憑證對應至使用者帳戶的用戶端憑證對應。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-130">Client certificate mapping to map client certificates to user accounts.</span></span>
-   <span data-ttu-id="0dcf2-131">授權設定，以限制可存取虛擬網站的人員。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-131">Authorization configuration to limit who has access to the virtual site.</span></span>

<span data-ttu-id="0dcf2-132">WinRM 服務預設會向 "wsman" 前置詞註冊埠5985。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-132">The WinRM service registers port 5985 with the "wsman" prefix by default.</span></span> <span data-ttu-id="0dcf2-133">如果相容性 HTTP 接聽程式已啟用，則 WinRM 服務預設會將埠80註冊為 "wsman" 前置詞。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-133">If the compatibility HTTP listener is enabled, the WinRM Service registers port 80 with the "wsman" prefix by default.</span></span> <span data-ttu-id="0dcf2-134">由於 IIS 預設也會在埠80上接聽，因此建議 IIS 主機服務在不同的埠 [*上建立接聽*](windows-remote-management-glossary.md) 程式。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-134">Because IIS also listens on port 80 by default, it is recommended that IIS host services create [*listeners*](windows-remote-management-glossary.md) on a different port.</span></span>

<span data-ttu-id="0dcf2-135">如果 IIS 和 WinRM 服務共用埠80，則需要下列設定才能共用埠：</span><span class="sxs-lookup"><span data-stu-id="0dcf2-135">If both the IIS and the WinRM service share port 80, the following configuration is needed to share the port:</span></span>

-   <span data-ttu-id="0dcf2-136">IIS 主機服務需要在網站下的應用程式上啟用 WinRM。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-136">The IIS host service needs to enable WinRM on an application under the site.</span></span>
-   <span data-ttu-id="0dcf2-137">應用程式名稱必須加入 URI 中。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-137">The application name needs to be added to the URI.</span></span> <span data-ttu-id="0dcf2-138">例如：https://servername/myapplication。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-138">For example: https://servername/myapplication.</span></span>

<span data-ttu-id="0dcf2-139">每個 IIS 主機應用程式都會儲存在 IIS 設定中做為 web.config 檔案，該檔案位於與設定的虛擬目錄對應的實體目錄中。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-139">Each IIS host application is stored in the IIS configuration as a web.config file residing in the physical directory corresponding to the configured virtual directory.</span></span> <span data-ttu-id="0dcf2-140">下一節說明 IIS 設定系統的運作方式，以及如何擴充以支援 WinRM IIS 主機設定。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-140">The following section describes how the IIS configuration system works and how it can be extended to support WinRM IIS host configuration.</span></span>

### <a name="how-iis-configuration-works"></a><span data-ttu-id="0dcf2-141">IIS 設定的運作方式</span><span class="sxs-lookup"><span data-stu-id="0dcf2-141">How IIS Configuration Works</span></span>

<span data-ttu-id="0dcf2-142">IIS 設定基礎結構包含一組用來儲存設定資料的 XML 檔案，以及一組用來驗證透過 IIS 管理 Api 寫入或讀取之資料的架構檔案。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-142">The IIS configuration infrastructure consists of a set of XML files used to store configuration data and a set of schema files used to validate data written to or read through IIS administration APIs.</span></span> <span data-ttu-id="0dcf2-143">在根層級，與 IIS 相同的目錄中會有 ApplicationHost.config 檔案， (通常是% windir% \\ System32 \\ InetSrv \\ Config) 。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-143">At the root level, there is an ApplicationHost.config file in the same directory as IIS (typically, %windir%\\System32\\InetSrv\\Config).</span></span> <span data-ttu-id="0dcf2-144">這是 IIS 的主要設定檔案，其中會儲存網站、應用程式、虛擬目錄、一般設定、記錄、快取等的清單。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-144">This is the main configuration file for IIS, where the list of sites, applications, virtual directories, general settings, logging, caching, and so on are stored.</span></span> <span data-ttu-id="0dcf2-145">設定資料會分成和存取為稱為 **區段** 的獨立實體。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-145">Configuration data is divided into and accessed as independent entities called **sections**.</span></span>

<span data-ttu-id="0dcf2-146">例如，網站、記錄、快取等各有不同的 **區段** 。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-146">For example, there are separate **sections** for sites, logging, caching, and so on.</span></span> <span data-ttu-id="0dcf2-147">ApplicationHost.config 中包含的任何設定資料都會套用至 IIS 內設定的所有網站、應用程式和虛擬目錄。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-147">Any configuration data contained in ApplicationHost.config is applied to all sites, applications, and virtual directories configured within IIS.</span></span> <span data-ttu-id="0dcf2-148">在虛擬目錄層級，web.config 檔案會定義應用程式特定的設定資料，可能會覆寫 ApplicationHost.config 中已定義的其他資料。Web.config 的檔案會儲存在根 (實體目錄) 對應至設定適用的網站、應用程式或虛擬目錄。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-148">At the virtual directory level, a web.config file defines application-specific configuration data, possibly by overriding other data already defined in ApplicationHost.config. Web.config files are stored at the root (physical directory) corresponding to the site, application, or virtual directory the configuration applies to.</span></span>

<span data-ttu-id="0dcf2-149">如需有關 IIS 設定的詳細資訊，請參閱下列各項：</span><span class="sxs-lookup"><span data-stu-id="0dcf2-149">For more information about IIS configuration, see the following:</span></span>

-   <span data-ttu-id="0dcf2-150">[IIS 7.0 設定架構](/previous-versions/iis/settings-schema/aa347559(v=vs.90))</span><span class="sxs-lookup"><span data-stu-id="0dcf2-150">[IIS 7.0 Settings Schema](/previous-versions/iis/settings-schema/aa347559(v=vs.90))</span></span>
-   [<span data-ttu-id="0dcf2-151">/archive/blogs/carlosag/</span><span class="sxs-lookup"><span data-stu-id="0dcf2-151">/archive/blogs/carlosag/</span></span>](/archive/blogs/carlosag/)
-   [https://www.iis.net/articles/view.aspx/IIS7/Use-IIS7-Administration-Tools/Using-XML-Configuration/Deep-Dive-into-IIS7](https://www.iis.net/learn/get-started/planning-your-iis-architecture/deep-dive-into-iis-configuration-with-iis-7-and-iis-8)

<span data-ttu-id="0dcf2-152">用來驗證 IIS 設定資料的 IIS 設定架構是儲存在 IIS 架構目錄中的 XML 檔案 (通常是% windir% \\ System32 \\ InetSrv \\ Config \\ 架構) 。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-152">The IIS configuration schema used to validate IIS configuration data is XML files stored in the IIS schema directory (typically, %windir%\\System32\\InetSrv\\Config\\Schema).</span></span> <span data-ttu-id="0dcf2-153">IIS 設定架構不是 XSD。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-153">The IIS configuration schema is not XSD.</span></span> <span data-ttu-id="0dcf2-154">IIS 設定支援擴充性。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-154">IIS configuration supports extensibility.</span></span> <span data-ttu-id="0dcf2-155">新的設定區段可以直接整合到 IIS 設定系統中，而且可以使用現有的系統管理 Api 來操作 IIS 設定系統的設定。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-155">New configuration sections can be directly integrated into the IIS configuration system, and the IIS configuration system's settings can be manipulated using the existing administration APIs.</span></span>

<span data-ttu-id="0dcf2-156">以下是所涉及的主要步驟：</span><span class="sxs-lookup"><span data-stu-id="0dcf2-156">The following are the main steps involved:</span></span>

-   <span data-ttu-id="0dcf2-157">在 XML 架構檔案中定義新的設定區段。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-157">Define a new configuration section in an XML schema file.</span></span>
-   <span data-ttu-id="0dcf2-158">將檔案放在 IIS 7 架構目錄中 (% windir% \\ System32 \\ InetSrv \\ Config \\ schema) 。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-158">Place the file in the IIS 7 schema directory (%windir%\\System32\\InetSrv\\Config\\Schema).</span></span>
-   <span data-ttu-id="0dcf2-159">在 IIS 全域設定檔 (ApplicationHost.config) 中註冊新的區段。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-159">Register the new section in the IIS global configuration file (ApplicationHost.config).</span></span>

## <a name="iis-host-winrm-configuration-setup-and-details"></a><span data-ttu-id="0dcf2-160">IIS 主機 (WinRM) 設定設定和詳細資料</span><span class="sxs-lookup"><span data-stu-id="0dcf2-160">IIS Host (WinRM) Configuration Setup and Details</span></span>

<span data-ttu-id="0dcf2-161">本節說明在安裝期間要進行整合和初始化 IIS 主機配置的步驟。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-161">This section describes the steps to be taken during setup to integrate and initialize IIS host configuration.</span></span> <span data-ttu-id="0dcf2-162">在這裡，IIS 主機設定是指在 IIS 內執行 WinRM 服務所需的設定資料。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-162">Here, IIS host configuration refers to the configuration data required to run the WinRM service within IIS.</span></span> <span data-ttu-id="0dcf2-163">WinRM IIS 延伸模組是使用 **伺服器管理員** 安裝的選用元件。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-163">The WinRM IIS extension module is an optional component that is installed using the **Server Manager**.</span></span>

<span data-ttu-id="0dcf2-164">定義必要設定的 IIS 設定區段稱為 **system.management.wsmanagement.config**。一般而言，IIS 主機設定是在安裝期間定義。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-164">The IIS configuration section that defines the required configuration is called **system.management.wsmanagement.config**. Typically, the IIS host configuration is defined during setup.</span></span> <span data-ttu-id="0dcf2-165">這可以藉由建立 web.config 檔案並新增適當的 XML 來完成。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-165">This can be done by creating a web.config file and adding the appropriate XML.</span></span> <span data-ttu-id="0dcf2-166">web.config 檔案的任何變更都需要重新開機裝載 WinRM 服務的網站。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-166">Any changes to the web.config file require restarting the site hosting the WinRM service.</span></span>

<span data-ttu-id="0dcf2-167">下列程式將詳細說明如何設定 WinRM IIS 延伸模組。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-167">The following procedure describes setting up the WinRM IIS extension in detail.</span></span>

<span data-ttu-id="0dcf2-168">**安裝 WinRM IIS 擴充功能**</span><span class="sxs-lookup"><span data-stu-id="0dcf2-168">**To install the WinRM IIS extension**</span></span>

1.  <span data-ttu-id="0dcf2-169">在 **伺服器管理員** 的 [**功能摘要**] 區段中，按一下 [**新增功能**]。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-169">In the **Features Summary** section of the **Server Manager**, click **Add Features**.</span></span>
2.  <span data-ttu-id="0dcf2-170">在 [新增功能] 嚮導中，選取 [WinRM IIS 擴充功能]。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-170">In the Add Features Wizard, select WinRM IIS extension.</span></span>
3.  <span data-ttu-id="0dcf2-171">遵循 wizard 的指示，包括安裝必要的軟體（如果有指定的話）。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-171">Follow the wizard instructions, including installing the required software if any is indicated.</span></span> <span data-ttu-id="0dcf2-172">如需使用 [新增功能] 嚮導的詳細資訊，請參閱 **伺服器管理員** 線上說明]。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-172">For more information about using the Add Features Wizard, refer to the **Server Manager** online help.</span></span>

### <a name="initializing-winrm-configuration-for-the-hosted-application"></a><span data-ttu-id="0dcf2-173">正在初始化主控應用程式的 WinRM 設定</span><span class="sxs-lookup"><span data-stu-id="0dcf2-173">Initializing WinRM Configuration for the Hosted Application</span></span>

<span data-ttu-id="0dcf2-174">此步驟包含在 web.config 檔案中定義 IIS 主機設定 XML。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-174">This step involves defining the IIS host configuration XML in the web.config file.</span></span> <span data-ttu-id="0dcf2-175">這個檔案位於與設定裝載應用程式之虛擬目錄對應的實體目錄中。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-175">This file resides in the physical directory corresponding to the virtual directory where the hosted application is configured.</span></span> <span data-ttu-id="0dcf2-176">**system.management.wsmanagement.config** 區段的 XML 內容應符合在於 wsmanconfig.wxsschema.xml 中定義的配置 \_ ，否則 IIS 管理 api 將無法進行處理。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-176">The XML content for the **system.management.wsmanagement.config** section should conform to the scheme defined in wsmanconfig\_schema.xml; otherwise, the IIS Administration APIs will be unable to process it.</span></span> <span data-ttu-id="0dcf2-177">以下是可能包含在 web.config 檔案中的 XML 內容範例：</span><span class="sxs-lookup"><span data-stu-id="0dcf2-177">The following is an example of XML content that could be contained in the web.config file:</span></span>


```XML
<?xml version="1.0" encoding="UTF-8"?>
<configuration>
 <system.webServer>
  <system.management.wsmanagement.config>
   <OperationsConfiguration MaxEnvelopeSizeKB="150" 
                            MaxOperationTimeoutSeconds="60"  
                            MaxEnumerateIdleTimeoutSeconds="60"  
                            MaxSubscribeIdleTimeoutSeconds="60"  
                            MaxShellIdleTimeoutMinutes="15"
                            QuotaRefreshIntervalSeconds="900"
                            QuotaSystemWindowSeconds="2"
                            QuotaSystemWindowOperations-"1000"/>
    <PluginModules>
     <AuthorizationPlugin Name="Auth1" Filename="Auth.dll" SDKVersion="1" SupportsQuota="true"/>
     <OperationsPlugins>
      <Plugin Name="PL1" Filename="PL1.dll" SDKVersion="1" XmlRenderingType="text">
       <InitializationParameters>
        <Param name="myParam1" value="myValue1"/>
       </InitializationParameters>
       <Resources>
        <Resource ResourceUri="myUri1">
        <Capability Type="Shell"/>
        </Resource>
       </Resources>
      </Plugin>
      <Plugin Name="PL2" Filename="PL2.dll" SDKVersion="1" XmlRenderingType="text">
       <InitializationParameters/>
       <Resources>
        <Resource ResourceUri="myUri1">
         <Capability Type="Get"/>
         <Capability Type="Put"/>
         <Capability Type="Delete"/>
        </Resource>
       </Resources>
      </Plugin>
     </OperationsPlugins>
    </PluginModules>
   </OperationsConfiguration>
  </system.management.wsmanagement.config>
 </system.webServer>
</configuration>
```



<span data-ttu-id="0dcf2-178">下列清單會更詳細地說明 XML 元素，後面接著于 wsmanconfig.wxsschema.xml 檔的範例 \_ 。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-178">The following list describes the XML elements in more detail and is followed by an example of a wsmanconfig\_schema.xml file.</span></span>



| <span data-ttu-id="0dcf2-179">元素</span><span class="sxs-lookup"><span data-stu-id="0dcf2-179">Element</span></span>                                                        | <span data-ttu-id="0dcf2-180">描述</span><span class="sxs-lookup"><span data-stu-id="0dcf2-180">Description</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|----------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="0dcf2-181">OperationsConfiguration/MaxEnvelopeSizeKB</span><span class="sxs-lookup"><span data-stu-id="0dcf2-181">OperationsConfiguration/MaxEnvelopeSizeKB</span></span>                      | <span data-ttu-id="0dcf2-182">WinRM 服務將處理的 SOAP 封包大小上限。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-182">The maximum size of the SOAP packets that the WinRM service will process.</span></span> <span data-ttu-id="0dcf2-183">預設值為 150 KB。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-183">The default value is 150 KB.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| <span data-ttu-id="0dcf2-184">OperationsConfiguration/MaxOperationTimeoutSeconds</span><span class="sxs-lookup"><span data-stu-id="0dcf2-184">OperationsConfiguration/MaxOperationTimeoutSeconds</span></span>             | <span data-ttu-id="0dcf2-185">所有作業的最大逾時間隔。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-185">The maximum time-out interval for all operations.</span></span> <span data-ttu-id="0dcf2-186">此值會覆寫 SOAP 封包中收到的任何值。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-186">This value overrides any value that is received in a SOAP packet.</span></span> <span data-ttu-id="0dcf2-187">如果提供者超過此值，則會將超時時間傳送給用戶端，並取消作業。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-187">If a provider exceeds this value, a time-out is sent to the client and the operation will be canceled.</span></span> <span data-ttu-id="0dcf2-188"> (某些作業（例如列舉）可在超時之後讓列舉保持開啟狀態。 ) 預設值為60秒。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-188">(Some operations, like enumerations, can keep an enumeration open after a time-out.) The default is 60 seconds.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| <span data-ttu-id="0dcf2-189">OperationsConfiguration/MaxEnumerationIdleTimeoutSeconds</span><span class="sxs-lookup"><span data-stu-id="0dcf2-189">OperationsConfiguration/MaxEnumerationIdleTimeoutSeconds</span></span>       | <span data-ttu-id="0dcf2-190">列舉的最大逾時間隔。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-190">The maximum time-out interval for enumerations.</span></span> <span data-ttu-id="0dcf2-191">如果列舉要求之間的時間大於這個值，就會取消列舉，而先前發行的列舉內容將不再有效。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-191">If the time between enumeration requests is greater than this value, the enumeration is canceled and the previously issued enumeration context is no longer valid.</span></span> <span data-ttu-id="0dcf2-192">預設值是 60 秒。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-192">The default is 60 seconds.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| <span data-ttu-id="0dcf2-193">OperationsConfiguration/MaxSubscribeIdleTimeoutSeconds</span><span class="sxs-lookup"><span data-stu-id="0dcf2-193">OperationsConfiguration/MaxSubscribeIdleTimeoutSeconds</span></span>         | <span data-ttu-id="0dcf2-194">訂閱作業的最大逾時間隔。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-194">The maximum time-out interval for Subscribe operations.</span></span> <span data-ttu-id="0dcf2-195">預設值是 60 秒。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-195">The default is 60 seconds.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| <span data-ttu-id="0dcf2-196">OperationsConfiguration/MaxShellIdleTimeoutMinutes</span><span class="sxs-lookup"><span data-stu-id="0dcf2-196">OperationsConfiguration/MaxShellIdleTimeoutMinutes</span></span>             | <span data-ttu-id="0dcf2-197">刪除非作用中遠端 shell 之前的最長時間（以分鐘為單位）。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-197">The maximum time in minutes before an inactive remote shell is deleted.</span></span> <span data-ttu-id="0dcf2-198">預設值是 15 分鐘。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-198">The default is 15 minutes.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| <span data-ttu-id="0dcf2-199">OperationsConfiguration/QuotaRefreshIntervalSeconds</span><span class="sxs-lookup"><span data-stu-id="0dcf2-199">OperationsConfiguration/QuotaRefreshIntervalSeconds</span></span>            | <span data-ttu-id="0dcf2-200">重新整理使用者的配額資訊之前的間隔。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-200">The interval before the quota information for a user is refreshed.</span></span> <span data-ttu-id="0dcf2-201">指定使用者的暫止要求會繼續在先前的授權和配額內容下執行，直到重新整理完成為止。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-201">Pending requests for the specified user continue to execute under the previous authorization and quota context until the refresh is completed.</span></span> <span data-ttu-id="0dcf2-202">預設值為900秒。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-202">The default is 900 seconds.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| <span data-ttu-id="0dcf2-203">OperationsConfiguration/QuotaSystemWindowSeconds</span><span class="sxs-lookup"><span data-stu-id="0dcf2-203">OperationsConfiguration/QuotaSystemWindowSeconds</span></span>               | <span data-ttu-id="0dcf2-204">系統節流滑動視窗的持續時間。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-204">The duration of the system throttle sliding window.</span></span> <span data-ttu-id="0dcf2-205">預設值為2秒。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-205">The default is 2 seconds.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| <span data-ttu-id="0dcf2-206">OperationsConfiguration/QuotaSystemWindowOperations</span><span class="sxs-lookup"><span data-stu-id="0dcf2-206">OperationsConfiguration/QuotaSystemWindowOperations</span></span>            | <span data-ttu-id="0dcf2-207">在滑動視窗期間，透過系統節流來許可的作業數目。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-207">The number of operations that are admitted through the system throttle during the sliding window.</span></span> <span data-ttu-id="0dcf2-208">預設值為1000作業。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-208">The default is 1000 operations.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| <span data-ttu-id="0dcf2-209">PlugInModules/AuthorizationPlugin</span><span class="sxs-lookup"><span data-stu-id="0dcf2-209">PlugInModules/AuthorizationPlugin</span></span>                              | <span data-ttu-id="0dcf2-210">這個節點是選擇性的。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-210">This node is optional.</span></span> <span data-ttu-id="0dcf2-211">授權外掛程式可讓您根據不同的驗證配置，以程式設計方式接受或拒絕輸入使用者。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-211">An authorization plug-in allows a programmatic way of accepting or rejecting an inbound user based on different authentication schemes.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| <span data-ttu-id="0dcf2-212">PlugInModules/AuthorizationPlugin/Name</span><span class="sxs-lookup"><span data-stu-id="0dcf2-212">PlugInModules/AuthorizationPlugin/Name</span></span>                         | <span data-ttu-id="0dcf2-213">指定要用於外掛程式的顯示名稱。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-213">Specifies the display name to use for the plug-in.</span></span> <span data-ttu-id="0dcf2-214">如果從外掛程式傳回錯誤，則會將此名稱放入傳回給用戶端應用程式的錯誤 XML。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-214">If an error is returned from the plug-in, this name will be put into the error XML that is returned to the client application.</span></span> <span data-ttu-id="0dcf2-215">名稱不是地區設定特定名稱。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-215">The name is not locale specific.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| <span data-ttu-id="0dcf2-216">PlugInModules/AuthorizationPlugin/Filename</span><span class="sxs-lookup"><span data-stu-id="0dcf2-216">PlugInModules/AuthorizationPlugin/Filename</span></span>                     | <span data-ttu-id="0dcf2-217">指定授權外掛程式的檔案名。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-217">Specifies the file name of the authorization plug-in.</span></span> <span data-ttu-id="0dcf2-218">將會根據 IIS 主機執行所在的身分識別（例如 Network Service）來擴充任何放入此專案的環境變數。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-218">Any environment variables that are put in this entry will be expanded based on the identity that the IIS host is running under, such as Network Service.</span></span> <span data-ttu-id="0dcf2-219">此專案的預設值為空白，表示未使用任何授權外掛程式。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-219">The default value for this entry is empty, which signifies that no authorization plug-in is used.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| <span data-ttu-id="0dcf2-220">PlugInModules/AuthorizationPlugin/SDKVersion</span><span class="sxs-lookup"><span data-stu-id="0dcf2-220">PlugInModules/AuthorizationPlugin/SDKVersion</span></span>                   | <span data-ttu-id="0dcf2-221">指定撰寫特定外掛程式 (SDK) 的軟體發展工具組版本。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-221">Specifies the version of the software development kit (SDK) for which a particular plug-in was written.</span></span> <span data-ttu-id="0dcf2-222">此元素必須設定為1。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-222">This element must be set to 1.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| <span data-ttu-id="0dcf2-223">PlugInModules/AuthorizationPlugin/SupportsQuota</span><span class="sxs-lookup"><span data-stu-id="0dcf2-223">PlugInModules/AuthorizationPlugin/SupportsQuota</span></span>                | <span data-ttu-id="0dcf2-224">指定授權外掛程式是否支援配額。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-224">Specifies whether the authorization plug-in supports quotas.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| <span data-ttu-id="0dcf2-225">PlugInModules/OperationsPlugins/Name</span><span class="sxs-lookup"><span data-stu-id="0dcf2-225">PlugInModules/OperationsPlugins/Name</span></span>                           | <span data-ttu-id="0dcf2-226">指定要用於外掛程式的顯示名稱。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-226">Specifies the display name to use for the plug-in.</span></span> <span data-ttu-id="0dcf2-227">如果從外掛程式傳回錯誤，則會將此名稱放入傳回給用戶端應用程式的錯誤 XML。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-227">If an error is returned from the plug-in, this name will be put into the error XML that is returned to the client application.</span></span> <span data-ttu-id="0dcf2-228">名稱不是地區設定特定名稱。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-228">The name is not locale specific.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| <span data-ttu-id="0dcf2-229">PlugInModules/OperationsPlugins/FileName</span><span class="sxs-lookup"><span data-stu-id="0dcf2-229">PlugInModules/OperationsPlugins/FileName</span></span>                       | <span data-ttu-id="0dcf2-230">指定操作外掛程式的檔案名。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-230">Specifies the file name of the operation plug-in.</span></span> <span data-ttu-id="0dcf2-231">當要求進入時，會在使用者的內容中展開任何放置於此專案中的環境變數。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-231">Any environment variables that are put in this entry will be expanded in the user's context when a request comes in.</span></span> <span data-ttu-id="0dcf2-232">每個使用者可能會有相同環境變數的不同版本，因此每個使用者最後可能會有不同的外掛程式。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-232">Each user could have a different version of the same environment variable, so each user could end up with a different plug-in.</span></span> <span data-ttu-id="0dcf2-233">這個專案不能空白，且必須指向有效的外掛程式。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-233">This entry cannot be blank and must point to a valid plug-in.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| <span data-ttu-id="0dcf2-234">PlugInModules/OperationsPlugins/SDKVersion</span><span class="sxs-lookup"><span data-stu-id="0dcf2-234">PlugInModules/OperationsPlugins/SDKVersion</span></span>                     | <span data-ttu-id="0dcf2-235">指定用來寫入特定外掛程式的 SDK 版本。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-235">Specifies the version of the SDK for which a particular plug-in was written.</span></span> <span data-ttu-id="0dcf2-236">此元素必須設定為1。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-236">This element must be set to 1.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| <span data-ttu-id="0dcf2-237">PlugInModules/OperationsPlugins/XmlRenderingType</span><span class="sxs-lookup"><span data-stu-id="0dcf2-237">PlugInModules/OperationsPlugins/XmlRenderingType</span></span>               | <span data-ttu-id="0dcf2-238">設定 XML 透過 [**WSMAN \_ 資料**](/windows/desktop/api/Wsman/ns-wsman-wsman_data) 物件傳遞至外掛程式的格式。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-238">Configures the format in which XML is passed to plug-ins through the [**WSMAN\_DATA**](/windows/desktop/api/Wsman/ns-wsman-wsman_data) object.</span></span> <span data-ttu-id="0dcf2-239">**XmlRenderingType** 設定為 text。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-239">**XmlRenderingType** is set to text.</span></span> <span data-ttu-id="0dcf2-240">傳入的 XML 資料會包含在 WSMAN \_ 資料 \_ 類型 \_ 文字結構中，這表示 xml 為 **PCWSTR** 記憶體緩衝區。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-240">Incoming XML data is contained in a WSMAN\_DATA\_TYPE\_TEXT structure, which represents the XML as a **PCWSTR** memory buffer.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| <span data-ttu-id="0dcf2-241">PlugInModules/OperationsPlugins/InitializationParameters</span><span class="sxs-lookup"><span data-stu-id="0dcf2-241">PlugInModules/OperationsPlugins/InitializationParameters</span></span>       | <span data-ttu-id="0dcf2-242">這個節點是選擇性的，可讓外掛程式設定將傳遞給 [**WSManPluginStartup**](/windows/desktop/api/Wsman/nc-wsman-wsman_plugin_startup) 方法的額外 XML。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-242">This node is optional and allows a plug-in to configure extra XML that will be passed in to the [**WSManPluginStartup**](/windows/desktop/api/Wsman/nc-wsman-wsman_plugin_startup) method.</span></span> <span data-ttu-id="0dcf2-243">大部分的外掛程式都不需要這項額外的資訊，但如果外掛程式需要在需要不同執行時間語義的多個案例下使用，則此 XML 將會賦予外掛程式彈性。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-243">Most plug-ins will not need this extra information, but if a plug-in needs to be used under more than one scenario that requires different run-time semantics, this XML will give the plug-in the flexibility do this.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| <span data-ttu-id="0dcf2-244">PlugInModules/OperationsPlugins/資源</span><span class="sxs-lookup"><span data-stu-id="0dcf2-244">PlugInModules/OperationsPlugins/Resources</span></span>                      | <span data-ttu-id="0dcf2-245">指定此外掛程式支援的 [*資源 uri*](windows-remote-management-glossary.md) 清單。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-245">Specifies a list of [*resource URIs*](windows-remote-management-glossary.md) that this plug-in supports.</span></span> <span data-ttu-id="0dcf2-246">至少必須指定一個 **ResourceUri** 專案;否則，XML 將會遭到拒絕。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-246">At least one **ResourceUri** entry must be specified; otherwise, the XML will be rejected.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| <span data-ttu-id="0dcf2-247">PlugInModules/OperationsPlugins/Resources/資源</span><span class="sxs-lookup"><span data-stu-id="0dcf2-247">PlugInModules/OperationsPlugins/Resources/Resource</span></span>             | <span data-ttu-id="0dcf2-248">代表單一 [*資源 URI*](windows-remote-management-glossary.md) 設定。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-248">Represents a single [*resource URI*](windows-remote-management-glossary.md) configuration.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| <span data-ttu-id="0dcf2-249">PlugInModules/OperationsPlugins/Resources/Resource/ResourceUri</span><span class="sxs-lookup"><span data-stu-id="0dcf2-249">PlugInModules/OperationsPlugins/Resources/Resource/ResourceUri</span></span> | <span data-ttu-id="0dcf2-250">以 full 或 **ExactMatch** 屬性為基礎的部分相符字串，指定單一 [*資源 URI*](windows-remote-management-glossary.md) 。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-250">Specifies a single [*resource URI*](windows-remote-management-glossary.md) either in full or as a partial match string based on the **ExactMatch** attribute.</span></span> <span data-ttu-id="0dcf2-251">如果 **ExactMatch** 不存在，則會預設為 **False**，這表示 WinRM SOAP 處理器會對 *資源 URI* 的開頭進行部分相符，如果有相符的值，請將它傳遞給外掛程式。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-251">If **ExactMatch** is not present, it defaults to **False**, which means the WinRM SOAP processor will do a partial match to the start of the *resource URI* and, if there is a match, pass it to the plug-in.</span></span> <span data-ttu-id="0dcf2-252">如果允許此 *資源 URI* 傳入任何選項，則可以指定 **SupportsOptions** 屬性。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-252">The **SupportsOptions** attribute can be specified if this *resource URI* is allowed to have any options passed in.</span></span> <span data-ttu-id="0dcf2-253">根據預設，不支援任何選項，如果用戶端要求中有任何選項，則會傳回錯誤。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-253">By default, no options are supported, and if any are present in the client request, an error will be returned.</span></span> <span data-ttu-id="0dcf2-254">如果外掛程式支援選項，則如果有外掛程式無法理解當 **mustUnderstand** 旗標設為 **TRUE** 的選項時，外掛程式就會傳回正確的錯誤，這是很重要的。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-254">If options are supported by the plug-in, it is important that the plug-in returns the correct error if an option is present that the plug-in does not understand when the **mustUnderstand** flag is set to **TRUE**.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| <span data-ttu-id="0dcf2-255">PlugInModules/OperationsPlugins/資源/功能</span><span class="sxs-lookup"><span data-stu-id="0dcf2-255">PlugInModules/OperationsPlugins/Resource/Capability</span></span>            | <span data-ttu-id="0dcf2-256">指定可在此 [*資源 URI*](windows-remote-management-glossary.md)上使用的功能。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-256">Specifies a capability that is available on this [*resource URI*](windows-remote-management-glossary.md).</span></span> <span data-ttu-id="0dcf2-257">它支援的每一種作業類型都會有一個專案。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-257">There will be one entry for each type of operation that it supports.</span></span> <span data-ttu-id="0dcf2-258">可用選項如下：</span><span class="sxs-lookup"><span data-stu-id="0dcf2-258">The following options are available:</span></span><br/> <dl> <span data-ttu-id="0dcf2-259"><dt><span id="Get"></span><span id="get"></span><span id="GET"></span>Get</dt></span><span class="sxs-lookup"><span data-stu-id="0dcf2-259"><dt><span id="Get"></span><span id="get"></span><span id="GET"></span>Get</dt></span></span> <dd> <span data-ttu-id="0dcf2-260">[*資源 URI*](windows-remote-management-glossary.md)支援 Get 作業。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-260">Get operations are supported on the [*resource URI*](windows-remote-management-glossary.md).</span></span> <span data-ttu-id="0dcf2-261">如果 get 作業支援這個概念，就會使用 **SupportFragment** 屬性。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-261">The **SupportFragment** attribute is used if the get operation supports the concept.</span></span> <span data-ttu-id="0dcf2-262">**SupportFiltering** 屬性無效，應設定為 **False**。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-262">The **SupportFiltering** attribute is not valid and should be set to **False**.</span></span> <span data-ttu-id="0dcf2-263">如果也支援 shell 作業，則這項功能對 *資源 URI* 而言是不正確。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-263">This capability is not valid for a *resource URI* if shell operations are also supported.</span></span><br/> </dd> <span data-ttu-id="0dcf2-264"><dt><span id="Put"></span><span id="put"></span><span id="PUT"></span>把</dt></span><span class="sxs-lookup"><span data-stu-id="0dcf2-264"><dt><span id="Put"></span><span id="put"></span><span id="PUT"></span>Put</dt></span></span> <dd> <span data-ttu-id="0dcf2-265">[*資源 URI*](windows-remote-management-glossary.md)支援 Put 作業。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-265">Put operations are supported on the [*resource URI*](windows-remote-management-glossary.md).</span></span> <span data-ttu-id="0dcf2-266">如果 put 作業支援這個概念，就會使用 **SupportFragment** 屬性。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-266">The **SupportFragment** attribute is used if the put operation supports the concept.</span></span> <span data-ttu-id="0dcf2-267">**SupportFiltering** 屬性無效，應設定為 **False**。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-267">The **SupportFiltering** attribute is not valid and should be set to **False**.</span></span> <span data-ttu-id="0dcf2-268">如果也支援 shell 作業，則這項功能對 *資源 URI* 而言是不正確。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-268">This capability is not valid for a *resource URI* if shell operations are also supported.</span></span><br/> </dd> <span data-ttu-id="0dcf2-269"><dt><span id="Create"></span><span id="create"></span><span id="CREATE"></span>建立</dt></span><span class="sxs-lookup"><span data-stu-id="0dcf2-269"><dt><span id="Create"></span><span id="create"></span><span id="CREATE"></span>Create</dt></span></span> <dd> <span data-ttu-id="0dcf2-270">[*資源 URI*](windows-remote-management-glossary.md)支援建立作業。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-270">Create operations are supported on the [*resource URI*](windows-remote-management-glossary.md).</span></span> <span data-ttu-id="0dcf2-271">如果建立作業支援這個概念，就會使用 **SupportFragment** 屬性。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-271">The **SupportFragment** attribute is used if the create operation supports the concept.</span></span> <span data-ttu-id="0dcf2-272">**SupportFiltering** 屬性無效，應設定為 **False**。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-272">The **SupportFiltering** attribute is not valid and should be set to **False**.</span></span> <span data-ttu-id="0dcf2-273">如果也支援 shell 作業，則這項功能對 *資源 URI* 而言是不正確。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-273">This capability is not valid for a *resource URI* if shell operations are also supported.</span></span><br/> </dd> <span data-ttu-id="0dcf2-274"><dt><span id="Delete"></span><span id="delete"></span><span id="DELETE"></span>刪除</dt></span><span class="sxs-lookup"><span data-stu-id="0dcf2-274"><dt><span id="Delete"></span><span id="delete"></span><span id="DELETE"></span>Delete</dt></span></span> <dd> <span data-ttu-id="0dcf2-275">[*資源 URI*](windows-remote-management-glossary.md)支援刪除作業。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-275">Delete operations are supported on the [*resource URI*](windows-remote-management-glossary.md).</span></span> <span data-ttu-id="0dcf2-276">如果刪除作業支援這個概念，就會使用 **SupportFragment** 屬性。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-276">The **SupportFragment** attribute is used if the delete operation supports the concept.</span></span> <span data-ttu-id="0dcf2-277">**SupportFiltering** 屬性無效，應設定為 **False**。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-277">The **SupportFiltering** attribute is not valid and should be set to **False**.</span></span> <span data-ttu-id="0dcf2-278">如果也支援 shell 作業，則這項功能對 *資源 URI* 而言是不正確。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-278">This capability is not valid for a *resource URI* if shell operations are also supported.</span></span><br/> </dd> <span data-ttu-id="0dcf2-279"><dt><span id="Invoke"></span><span id="invoke"></span><span id="INVOKE"></span>調用</dt></span><span class="sxs-lookup"><span data-stu-id="0dcf2-279"><dt><span id="Invoke"></span><span id="invoke"></span><span id="INVOKE"></span>Invoke</dt></span></span> <dd> <span data-ttu-id="0dcf2-280">[*資源 URI*](windows-remote-management-glossary.md)支援 Invoke 作業。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-280">Invoke operations are supported on the [*resource URI*](windows-remote-management-glossary.md).</span></span> <span data-ttu-id="0dcf2-281">Invoke 作業不支援 **SupportFragment** 屬性，應設定為 **False**。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-281">The **SupportFragment** attribute is not supported for invoke operations and should be set to **False**.</span></span> <span data-ttu-id="0dcf2-282">**SupportFiltering** 屬性無效，應設定為 **False**。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-282">The **SupportFiltering** attribute is not valid and should be set to **False**.</span></span> <span data-ttu-id="0dcf2-283">如果也支援 shell 作業，則這項功能對 *資源 URI* 而言是不正確。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-283">This capability is not valid for a *resource URI* if shell operations are also supported.</span></span><br/> </dd> <span data-ttu-id="0dcf2-284"><dt><span id="Enumerate"></span><span id="enumerate"></span><span id="ENUMERATE"></span>列舉</dt></span><span class="sxs-lookup"><span data-stu-id="0dcf2-284"><dt><span id="Enumerate"></span><span id="enumerate"></span><span id="ENUMERATE"></span>Enumerate</dt></span></span> <dd> <span data-ttu-id="0dcf2-285">[*資源 URI*](windows-remote-management-glossary.md)支援列舉作業。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-285">Enumerate operations are supported on the [*resource URI*](windows-remote-management-glossary.md).</span></span> <span data-ttu-id="0dcf2-286">列舉作業不支援 **SupportFragment** 屬性，應設定為 **False**。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-286">The **SupportFragment** attribute is not supported for enumerate operations and should be set to **False**.</span></span> <span data-ttu-id="0dcf2-287">**SupportFiltering** 屬性是有效的，而且如果外掛程式支援篩選，這個屬性應該設定為 **True**。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-287">The **SupportFiltering** attribute is valid, and if the plug-in supports filtering, this attribute should be set to **True**.</span></span> <span data-ttu-id="0dcf2-288">如果也支援 shell 作業，則這項功能對 *資源 URI* 而言是不正確。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-288">This capability is not valid for a *resource URI* if shell operations are also supported.</span></span><br/> </dd> <span data-ttu-id="0dcf2-289"><dt><span id="Subscribe"></span><span id="subscribe"></span><span id="SUBSCRIBE"></span>訂閱</dt></span><span class="sxs-lookup"><span data-stu-id="0dcf2-289"><dt><span id="Subscribe"></span><span id="subscribe"></span><span id="SUBSCRIBE"></span>Subscribe</dt></span></span> <dd> <span data-ttu-id="0dcf2-290">[*資源 URI*](windows-remote-management-glossary.md)支援訂閱作業。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-290">Subscribe operations are supported on the [*resource URI*](windows-remote-management-glossary.md).</span></span> <span data-ttu-id="0dcf2-291">訂閱作業不支援 **SupportFragment** 屬性，應設定為 **False**。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-291">The **SupportFragment** attribute is not supported for subscribe operations and should be set to **False**.</span></span> <span data-ttu-id="0dcf2-292">**SupportFiltering** 屬性無效，應設定為 **False**。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-292">The **SupportFiltering** attribute is not valid and should be set to **False**.</span></span> <span data-ttu-id="0dcf2-293">如果也支援 shell 作業，則這項功能對 *資源 URI* 而言是不正確。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-293">This capability is not valid for a *resource URI* if shell operations are also supported.</span></span><br/> </dd> <span data-ttu-id="0dcf2-294"><dt><span id="Shell"></span><span id="shell"></span><span id="SHELL"></span>殼層</dt></span><span class="sxs-lookup"><span data-stu-id="0dcf2-294"><dt><span id="Shell"></span><span id="shell"></span><span id="SHELL"></span>Shell</dt></span></span> <dd> <span data-ttu-id="0dcf2-295">[*資源 URI*](windows-remote-management-glossary.md)支援 Shell 作業。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-295">Shell operations are supported on the [*resource URI*](windows-remote-management-glossary.md).</span></span> <span data-ttu-id="0dcf2-296">Shell 作業不支援 **SupportFragment** 屬性，應設定為 **False**。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-296">The **SupportFragment** attribute is not supported for shell operations and should be set to **False**.</span></span> <span data-ttu-id="0dcf2-297">**SupportFiltering** 屬性無效，應設定為 **False**。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-297">The **SupportFiltering** attribute is not valid and should be set to **False**.</span></span> <span data-ttu-id="0dcf2-298">如果也支援任何其他作業功能，這項功能對 *資源 URI* 而言是不正確。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-298">This capability is not valid for a *resource URI* if any other operation capability is also supported.</span></span> <span data-ttu-id="0dcf2-299">如果 shell 作業功能設定為 *資源 URI*，則 get、put、create、delete、invoke 和列舉作業會在 WinRM 服務內部處理，以管理 shell。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-299">If a shell operation capability is configured for a *resource URI*, then get, put, create, delete, invoke, and enumerate operations are processed internally within the WinRM service to manage shells.</span></span> <span data-ttu-id="0dcf2-300">因此，外掛程式無法處理作業本身。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-300">As a result, the plug-in cannot deal with the operations itself.</span></span><br/> </dd> </dl> |



 

### <a name="example-wsmanconfig_schemaxml-file"></a><span data-ttu-id="0dcf2-301">範例于 wsmanconfig.wxs \_schema.xml 檔案</span><span class="sxs-lookup"><span data-stu-id="0dcf2-301">Example wsmanconfig\_schema.xml File</span></span>

<span data-ttu-id="0dcf2-302">在設定期間，會將名為schema.xml 于 wsmanconfig.wxs 的 XML 檔案（ \_ 包含下列內容）放在 IIS 架構目錄中：</span><span class="sxs-lookup"><span data-stu-id="0dcf2-302">During set up, an XML file called wsmanconfig\_schema.xml containing the following content is dropped in the IIS schema directory:</span></span>


```XML
<configSchema>
 <sectionSchema name="system.webServer/system.management.wsmanagement.config">
  <element name="OperationsConfiguration">
   <attribute name="MaxEnvelopeSizeKB" 
              type="uint" 
              defaultValue="150" 
              validationType="integerRange" 
              validationParameter="32,4294967295"/>
   <attribute name="MaxOperationTimeoutSeconds" 
              type="uint" 
              defaultValue="60" 
              validationType="integerRange" 
              validationParameter="1,4294967295"/>
   <attribute name="MaxEnumerateIdleTimeoutSeconds" 
              type="uint" 
              defaultValue="60" 
              validationType="integerRange" 
              validationParameter="1,4294967295"/>
   <attribute name="MaxSubscribeIdleTimeoutSeconds" 
              type="uint" 
              defaultValue="60" 
              validationType="integerRange" 
              validationParameter="1,4294967295"/>
   <attribute name="MaxShellIdleTimeoutMinutes" 
              type="uint" 
              defaultValue="15" 
              validationType="integerRange" 
              validationParameter="0,4294967295"/>
   <attribute name="QuotaRefreshIntervalSeconds" 
              type="uint" 
              defaultValue="900" 
              validationType="integerRange" 
              validationParameter="0,4294967295"/>
   <attribute name="QuotaSystemWindowSeconds" 
              type="uint" 
              defaultValue="2" 
              validationType="integerRange" 
              validationParameter="0,4294967295"/>
   <attribute name="QuotaSystemWindowOperations" 
              type="uint" 
              defaultValue="1000" 
              validationType="integerRange" 
              validationParameter="0,4294967295"/>
  </element>
  <element name="PluginModules">
   <collection addElement="AuthorizationPlugin">
    <attribute name="Name" type="string" isUniqueKey="true" required="true" validationType="nonEmptyString"/>
    <attribute name="Filename" type="string" required="true" validationType="nonEmptyString"/>
    <attribute name="SDKVersion" type="uint" required="true"/>
    <attribute name="SupportsQuota" type="bool" defaultValue="false"/>
   </collection>
   <element name="OperationsPlugins">
    <collection addElement="Plugin">
     <attribute name="Name" type="string" isUniqueKey="true" required="true" validationType="nonEmptyString"/>
     <attribute name="Filename" type="string" required="true" validationType="nonEmptyString"/>
     <attribute name="SDKVersion" type="uint" required="true"/>
     <attribute name="XmlRenderingType" type="enum" defaultValue="text">
      <enum name="text" value="1"/>
      <enum name="XmlReader" value="2"/>
     </attribute>
     <attribute name="Enabled" type="bool" defaultValue="true"/>
     <element name="InitializationParameters">
      <collection addElement="Param">
       <attribute name="Name" type="string" isUniqueKey="true" required="true" validationType="nonEmptyString"/>
       <attribute name="Value" type="string" required="true" validationType="nonEmptyString"/>
      </collection>
     </element>
     <element name="Resources">
      <collection addElement="Resource">
       <attribute name="ResourceUri" type="string" isUniqueKey="true" required="true" validationType="nonEmptyString"/>
       <attribute name="SupportsOptions" type="bool" defaultValue="false"/>
       <attribute name="ExactMatch" type="bool" defaultValue="false"/>
       <collection addElement="Capability">
        <attribute name="Type" type="enum" isUniqueKey="true" required="true">
         <enum name="Get" value="1"/>
         <enum name="Put" value="2"/>
         <enum name="Create" value="3"/>
         <enum name="Delete" value="4"/>
         <enum name="Invoke" value="5"/>
         <enum name="Enumerate" value="6"/>
         <enum name="Subscribe" value="7"/>
         <enum name="Shell" value="8"/>
        </attribute>
        <attribute name="SupportsFragment" type="bool" default="false"/>
        <attribute name="SupportsFiltering" type="bool" default="false"/>
       </collection>
      </collection>
     </element>
    </collection>
   </element>
  </element>
 </sectionSchema>
</configSchema>
```



## <a name="reading-iis-host-configuration"></a><span data-ttu-id="0dcf2-303">正在讀取 IIS 主機設定</span><span class="sxs-lookup"><span data-stu-id="0dcf2-303">Reading IIS Host Configuration</span></span>

<span data-ttu-id="0dcf2-304">在主控應用程式的 SOAP 處理器啟動程式期間，會讀取 IIS 主機設定。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-304">The IIS host configuration is read during the SOAP processor startup process in the hosted application.</span></span> <span data-ttu-id="0dcf2-305">因為可以手動編輯 web.config 檔案，因此很容易發生架構驗證錯誤，所以在讀取設定時可能會有問題。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-305">Because web.config files can be manually edited and, therefore, are prone to schema validation errors, there can be issues when a configuration is read.</span></span> <span data-ttu-id="0dcf2-306">在設定讀取或驗證失敗期間，裝載的應用程式將無法啟動，且會將適當的錯誤訊息傳回給用戶端。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-306">During a configuration read or validation failure, the hosted application will fail to start and will return an appropriate error message to the client.</span></span> <span data-ttu-id="0dcf2-307">將會記錄事件，其中包含造成失敗之原因的詳細描述。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-307">An event will be logged containing a detailed description of what caused the failure.</span></span>

<span data-ttu-id="0dcf2-308">常見失敗包含下列各項：</span><span class="sxs-lookup"><span data-stu-id="0dcf2-308">Common failures include the following:</span></span>

-   <span data-ttu-id="0dcf2-309">拒絕存取</span><span class="sxs-lookup"><span data-stu-id="0dcf2-309">Access Denied</span></span>
-   <span data-ttu-id="0dcf2-310">不正確設定 XML</span><span class="sxs-lookup"><span data-stu-id="0dcf2-310">Invalid Configuration XML</span></span>
-   <span data-ttu-id="0dcf2-311">未設定任何外掛程式 (至少需要一個外掛程式) </span><span class="sxs-lookup"><span data-stu-id="0dcf2-311">No plug-in configured (at least one is required)</span></span>

<span data-ttu-id="0dcf2-312">預設不會設定標準外掛程式。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-312">The standard plug-ins are not configured by default.</span></span> <span data-ttu-id="0dcf2-313">它們必須在 web.config 檔案中明確設定，才會開始接收要求。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-313">They need to be explicitly configured in the web.config file before they will start receiving requests.</span></span>

## <a name="enumerating-plug-ins-on-the-winrm-service"></a><span data-ttu-id="0dcf2-314">列舉 WinRM 服務上的外掛程式</span><span class="sxs-lookup"><span data-stu-id="0dcf2-314">Enumerating Plug-ins on the WinRM Service</span></span>

<span data-ttu-id="0dcf2-315">下列命令示範如何使用 winrm 公用程式來判斷 WinRM 服務上有哪些外掛程式： **winrm 列舉 winrm/config/外掛程式-format：很美觀**。</span><span class="sxs-lookup"><span data-stu-id="0dcf2-315">The following command demonstrates how to use the winrm utility to determine which plug-ins are available on the WinRM service: **winrm enumerate winrm/config/plugin -format:pretty**.</span></span>

 

