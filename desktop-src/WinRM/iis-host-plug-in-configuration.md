---
title: IIS 主機外掛程式設定
description: Windows 遠端管理 (winrm) Internet Information Services (IIS) 主機外掛程式設定提供了一種裝載機制，可讓協力廠商 WinRM 外掛程式公開 winrm 基礎結構內的管理資料。
ms.assetid: 234e6f7b-310f-499a-83e4-699ecf3816f0
ms.tgt_platform: multiple
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 9547c96aedc5af23f2194bb9887238525b4ecf6fc6dc0ef8060b1318a960d637
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/11/2021
ms.locfileid: "119997638"
---
# <a name="iis-host-plug-in-configuration"></a>IIS 主機外掛程式設定

Windows 遠端管理 (winrm) Internet Information Services (IIS) 主機外掛程式設定提供了一種裝載機制，可讓協力廠商 WinRM 外掛程式公開 winrm 基礎結構內的管理資料。

下列各節說明 IIS 主機外掛程式設定：

-   [IIS 裝載詳細資料](#iis-hosting-details)
-   [IIS 主機配置模型](#iis-host-configuration-model)
-   [IIS 主機 (WinRM) 設定設定和詳細資料](/windows)
-   [正在讀取 IIS 主機設定](#reading-iis-host-configuration)
-   [列舉 WinRM 服務上的外掛程式](#enumerating-plug-ins-on-the-winrm-service)

## <a name="iis-hosting-details"></a>IIS 裝載詳細資料

在 IIS 中設定和初始化 WinRM SOAP 處理器的應用程式，將會使用 WS-Management 的通訊協定，直接從另一部電腦上的 WinRM 用戶端接收要求。 應用程式也必須設定 HTTP 端點，以識別應用程式，以確保所有要求都會直接路由傳送至應用程式特定的外掛程式。應用程式也必須設定要將哪些外掛程式載入至 IIS 主機，以及所需的授權和驗證機制。 在 IIS 中使用 WinRM 服務時，應該考慮下列因素：

-   根據預設，IIS 不支援 Kerberos 驗證。 不過，您可以建立 IIS 模組來支援 Kerberos 驗證。
-   IIS 服務將不會透過 HTTP 接受加密的 WinRM 服務要求。
-   設定 IIS 端點之後，您以隱含認證傳送的第一個要求將會失敗;不過，所有後續的要求都會成功。 這是使用預設核心模式驗證所設定的 IIS 網站的已知問題。 如果這是封鎖問題，建議您關閉核心模式驗證。

## <a name="iis-host-configuration-model"></a>IIS 主機配置模型

在 IIS 中裝載 WinRM 簡單物件存取通訊協定 (SOAP) 處理器的所有應用程式都必須先進行設定，才能運作。

每個應用程式設定與其他應用程式的設定不同。 以下是必要的設定集合，雖然可能並非所有的設定都需要變更，而是透過主要 WinRM 服務完成：

-   一般應用程式設定，包含作業超時。
-   授權外掛程式，可授權 LiveID 要求或將 Windows 使用者帳戶對應到更一般的服務帳戶。
-   WinRM SOAP 處理器要裝載和使用的作業外掛程式，以執行實際的要求。

下列設定可能需要在 IIS 內設定：

-   定義埠和位址要接聽要求的接聽 [*程式端點資訊*](windows-remote-management-glossary.md)，以及任何安全通訊端層 (SSL) 憑證。
-   將用戶端憑證對應至使用者帳戶的用戶端憑證對應。
-   授權設定，以限制可存取虛擬網站的人員。

WinRM 服務預設會向 "wsman" 前置詞註冊埠5985。 如果相容性 HTTP 接聽程式已啟用，則 WinRM 服務預設會將埠80註冊為 "wsman" 前置詞。 由於 IIS 預設也會在埠80上接聽，因此建議 IIS 主機服務在不同的埠 [*上建立接聽*](windows-remote-management-glossary.md) 程式。

如果 IIS 和 WinRM 服務共用埠80，則需要下列設定才能共用埠：

-   IIS 主機服務需要在網站下的應用程式上啟用 WinRM。
-   應用程式名稱必須加入 URI 中。 例如：https://servername/myapplication。

每個 IIS 主機應用程式都會儲存在 IIS 設定中做為 web.config 檔案，該檔案位於與設定的虛擬目錄對應的實體目錄中。 下一節說明 IIS 設定系統的運作方式，以及如何擴充以支援 WinRM IIS 主機設定。

### <a name="how-iis-configuration-works"></a>IIS 設定的運作方式

IIS 設定基礎結構包含一組用來儲存設定資料的 XML 檔案，以及一組用來驗證透過 IIS 管理 Api 寫入或讀取之資料的架構檔案。 在根層級，與 IIS 相同的目錄中會有 ApplicationHost.config 檔案， (通常是% windir% \\ System32 \\ InetSrv \\ Config) 。 這是 IIS 的主要設定檔案，其中會儲存網站、應用程式、虛擬目錄、一般設定、記錄、快取等的清單。 設定資料會分成和存取為稱為 **區段** 的獨立實體。

例如，網站、記錄、快取等各有不同的 **區段** 。 ApplicationHost.config 中包含的任何設定資料都會套用至 IIS 內設定的所有網站、應用程式和虛擬目錄。 在虛擬目錄層級，web.config 檔案會定義應用程式特定的設定資料，可能會覆寫 ApplicationHost.config 中已定義的其他資料。Web.config 的檔案會儲存在根 (實體目錄) 對應至設定適用的網站、應用程式或虛擬目錄。

如需有關 IIS 設定的詳細資訊，請參閱下列各項：

-   [IIS 7.0 設定架構](/previous-versions/iis/settings-schema/aa347559(v=vs.90))
-   [/archive/blogs/carlosag/](/archive/blogs/carlosag/)
-   [https://www.iis.net/articles/view.aspx/IIS7/Use-IIS7-Administration-Tools/Using-XML-Configuration/Deep-Dive-into-IIS7](https://www.iis.net/learn/get-started/planning-your-iis-architecture/deep-dive-into-iis-configuration-with-iis-7-and-iis-8)

用來驗證 IIS 設定資料的 IIS 設定架構是儲存在 IIS 架構目錄中的 XML 檔案 (通常是% windir% \\ System32 \\ InetSrv \\ Config \\ 架構) 。 IIS 設定架構不是 XSD。 IIS 設定支援擴充性。 新的設定區段可以直接整合到 IIS 設定系統中，而且可以使用現有的系統管理 Api 來操作 IIS 設定系統的設定。

以下是所涉及的主要步驟：

-   在 XML 架構檔案中定義新的設定區段。
-   將檔案放在 IIS 7 架構目錄中 (% windir% \\ System32 \\ InetSrv \\ Config \\ schema) 。
-   在 IIS 全域設定檔 (ApplicationHost.config) 中註冊新的區段。

## <a name="iis-host-winrm-configuration-setup-and-details"></a>IIS 主機 (WinRM) 設定設定和詳細資料

本節說明在安裝期間要進行整合和初始化 IIS 主機配置的步驟。 在這裡，IIS 主機設定是指在 IIS 內執行 WinRM 服務所需的設定資料。 WinRM IIS 延伸模組是使用 **伺服器管理員** 安裝的選用元件。

定義必要設定的 IIS 設定區段稱為 **system.management.wsmanagement.config**。一般而言，IIS 主機設定是在安裝期間定義。 這可以藉由建立 web.config 檔案並新增適當的 XML 來完成。 web.config 檔案的任何變更都需要重新開機裝載 WinRM 服務的網站。

下列程式將詳細說明如何設定 WinRM IIS 延伸模組。

**安裝 WinRM IIS 擴充功能**

1.  在 **伺服器管理員** 的 [**功能摘要**] 區段中，按一下 [**新增功能**]。
2.  在 [新增功能] 嚮導中，選取 [WinRM IIS 擴充功能]。
3.  遵循 wizard 的指示，包括安裝必要的軟體（如果有指定的話）。 如需使用 [新增功能] 嚮導的詳細資訊，請參閱 **伺服器管理員** 線上說明]。

### <a name="initializing-winrm-configuration-for-the-hosted-application"></a>正在初始化主控應用程式的 WinRM 設定

此步驟包含在 web.config 檔案中定義 IIS 主機設定 XML。 這個檔案位於與設定裝載應用程式之虛擬目錄對應的實體目錄中。 **system.management.wsmanagement.config** 區段的 XML 內容應符合在於 wsmanconfig.wxsschema.xml 中定義的配置 \_ ，否則 IIS 管理 api 將無法進行處理。 以下是可能包含在 web.config 檔案中的 XML 內容範例：


```XML
<?xml version="1.0" encoding="UTF-8"?>
<configuration>
 <system.webServer>
  <system.management.wsmanagement.config>
   <OperationsConfiguration MaxEnvelopeSizeKB="150" 
                            MaxOperationTimeoutSeconds="60"  
                            MaxEnumerateIdleTimeoutSeconds="60"  
                            MaxSubscribeIdleTimeoutSeconds="60"  
                            MaxShellIdleTimeoutMinutes="15"
                            QuotaRefreshIntervalSeconds="900"
                            QuotaSystemWindowSeconds="2"
                            QuotaSystemWindowOperations-"1000"/>
    <PluginModules>
     <AuthorizationPlugin Name="Auth1" Filename="Auth.dll" SDKVersion="1" SupportsQuota="true"/>
     <OperationsPlugins>
      <Plugin Name="PL1" Filename="PL1.dll" SDKVersion="1" XmlRenderingType="text">
       <InitializationParameters>
        <Param name="myParam1" value="myValue1"/>
       </InitializationParameters>
       <Resources>
        <Resource ResourceUri="myUri1">
        <Capability Type="Shell"/>
        </Resource>
       </Resources>
      </Plugin>
      <Plugin Name="PL2" Filename="PL2.dll" SDKVersion="1" XmlRenderingType="text">
       <InitializationParameters/>
       <Resources>
        <Resource ResourceUri="myUri1">
         <Capability Type="Get"/>
         <Capability Type="Put"/>
         <Capability Type="Delete"/>
        </Resource>
       </Resources>
      </Plugin>
     </OperationsPlugins>
    </PluginModules>
   </OperationsConfiguration>
  </system.management.wsmanagement.config>
 </system.webServer>
</configuration>
```



下列清單會更詳細地說明 XML 元素，後面接著于 wsmanconfig.wxsschema.xml 檔的範例 \_ 。



| 元素                                                        | 描述                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|----------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| OperationsConfiguration/MaxEnvelopeSizeKB                      | WinRM 服務將處理的 SOAP 封包大小上限。 預設值為 150 KB。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| OperationsConfiguration/MaxOperationTimeoutSeconds             | 所有作業的最大逾時間隔。 此值會覆寫 SOAP 封包中收到的任何值。 如果提供者超過此值，則會將超時時間傳送給用戶端，並取消作業。  (某些作業（例如列舉）可在超時之後讓列舉保持開啟狀態。 ) 預設值為60秒。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| OperationsConfiguration/MaxEnumerationIdleTimeoutSeconds       | 列舉的最大逾時間隔。 如果列舉要求之間的時間大於這個值，就會取消列舉，而先前發行的列舉內容將不再有效。 預設值是 60 秒。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| OperationsConfiguration/MaxSubscribeIdleTimeoutSeconds         | 訂閱作業的最大逾時間隔。 預設值是 60 秒。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| OperationsConfiguration/MaxShellIdleTimeoutMinutes             | 刪除非作用中遠端 shell 之前的最長時間（以分鐘為單位）。 預設值是 15 分鐘。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| OperationsConfiguration/QuotaRefreshIntervalSeconds            | 重新整理使用者的配額資訊之前的間隔。 指定使用者的暫止要求會繼續在先前的授權和配額內容下執行，直到重新整理完成為止。 預設值為900秒。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| OperationsConfiguration/QuotaSystemWindowSeconds               | 系統節流滑動視窗的持續時間。 預設值為2秒。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| OperationsConfiguration/QuotaSystemWindowOperations            | 在滑動視窗期間，透過系統節流來許可的作業數目。 預設值為1000作業。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| PlugInModules/AuthorizationPlugin                              | 這個節點是選擇性的。 授權外掛程式可讓您根據不同的驗證配置，以程式設計方式接受或拒絕輸入使用者。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| PlugInModules/AuthorizationPlugin/Name                         | 指定要用於外掛程式的顯示名稱。 如果從外掛程式傳回錯誤，則會將此名稱放入傳回給用戶端應用程式的錯誤 XML。 名稱不是地區設定特定名稱。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| PlugInModules/AuthorizationPlugin/Filename                     | 指定授權外掛程式的檔案名。 將會根據 IIS 主機執行所在的身分識別（例如 Network Service）來擴充任何放入此專案的環境變數。 此專案的預設值為空白，表示未使用任何授權外掛程式。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| PlugInModules/AuthorizationPlugin/SDKVersion                   | 指定撰寫特定外掛程式 (SDK) 的軟體發展工具組版本。 此元素必須設定為1。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| PlugInModules/AuthorizationPlugin/SupportsQuota                | 指定授權外掛程式是否支援配額。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| PlugInModules/OperationsPlugins/Name                           | 指定要用於外掛程式的顯示名稱。 如果從外掛程式傳回錯誤，則會將此名稱放入傳回給用戶端應用程式的錯誤 XML。 名稱不是地區設定特定名稱。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| PlugInModules/OperationsPlugins/FileName                       | 指定操作外掛程式的檔案名。 當要求進入時，會在使用者的內容中展開任何放置於此專案中的環境變數。 每個使用者可能會有相同環境變數的不同版本，因此每個使用者最後可能會有不同的外掛程式。 這個專案不能空白，且必須指向有效的外掛程式。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| PlugInModules/OperationsPlugins/SDKVersion                     | 指定用來寫入特定外掛程式的 SDK 版本。 此元素必須設定為1。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| PlugInModules/OperationsPlugins/XmlRenderingType               | 設定 XML 透過 [**WSMAN \_ 資料**](/windows/desktop/api/Wsman/ns-wsman-wsman_data) 物件傳遞至外掛程式的格式。 **XmlRenderingType** 設定為 text。 傳入的 XML 資料會包含在 WSMAN \_ 資料 \_ 類型 \_ 文字結構中，這表示 xml 為 **PCWSTR** 記憶體緩衝區。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| PlugInModules/OperationsPlugins/InitializationParameters       | 這個節點是選擇性的，可讓外掛程式設定將傳遞給 [**WSManPluginStartup**](/windows/desktop/api/Wsman/nc-wsman-wsman_plugin_startup) 方法的額外 XML。 大部分的外掛程式都不需要這項額外的資訊，但如果外掛程式需要在需要不同執行時間語義的多個案例下使用，則此 XML 將會賦予外掛程式彈性。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| PlugInModules/OperationsPlugins/資源                      | 指定此外掛程式支援的 [*資源 uri*](windows-remote-management-glossary.md) 清單。 至少必須指定一個 **ResourceUri** 專案;否則，XML 將會遭到拒絕。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| PlugInModules/OperationsPlugins/Resources/資源             | 代表單一 [*資源 URI*](windows-remote-management-glossary.md) 設定。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| PlugInModules/OperationsPlugins/Resources/Resource/ResourceUri | 以 full 或 **ExactMatch** 屬性為基礎的部分相符字串，指定單一 [*資源 URI*](windows-remote-management-glossary.md) 。 如果 **ExactMatch** 不存在，則會預設為 **False**，這表示 WinRM SOAP 處理器會對 *資源 URI* 的開頭進行部分相符，如果有相符的值，請將它傳遞給外掛程式。 如果允許此 *資源 URI* 傳入任何選項，則可以指定 **SupportsOptions** 屬性。 根據預設，不支援任何選項，如果用戶端要求中有任何選項，則會傳回錯誤。 如果外掛程式支援選項，則如果有外掛程式無法理解當 **mustUnderstand** 旗標設為 **TRUE** 的選項時，外掛程式就會傳回正確的錯誤，這是很重要的。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| PlugInModules/OperationsPlugins/資源/功能            | 指定可在此 [*資源 URI*](windows-remote-management-glossary.md)上使用的功能。 它支援的每一種作業類型都會有一個專案。 可用選項如下：<br/> <dl> <dt><span id="Get"></span><span id="get"></span><span id="GET"></span>獲取</dt> <dd> [*資源 URI*](windows-remote-management-glossary.md)支援 Get 作業。 如果 get 作業支援這個概念，就會使用 **SupportFragment** 屬性。 **SupportFiltering** 屬性無效，應設定為 **False**。 如果也支援 shell 作業，則這項功能對 *資源 URI* 而言是不正確。<br/> </dd> <dt><span id="Put"></span><span id="put"></span><span id="PUT"></span>把</dt> <dd> [*資源 URI*](windows-remote-management-glossary.md)支援 Put 作業。 如果 put 作業支援這個概念，就會使用 **SupportFragment** 屬性。 **SupportFiltering** 屬性無效，應設定為 **False**。 如果也支援 shell 作業，則這項功能對 *資源 URI* 而言是不正確。<br/> </dd> <dt><span id="Create"></span><span id="create"></span><span id="CREATE"></span>建立</dt> <dd> [*資源 URI*](windows-remote-management-glossary.md)支援建立作業。 如果建立作業支援這個概念，就會使用 **SupportFragment** 屬性。 **SupportFiltering** 屬性無效，應設定為 **False**。 如果也支援 shell 作業，則這項功能對 *資源 URI* 而言是不正確。<br/> </dd> <dt><span id="Delete"></span><span id="delete"></span><span id="DELETE"></span>刪除</dt> <dd> [*資源 URI*](windows-remote-management-glossary.md)支援刪除作業。 如果刪除作業支援這個概念，就會使用 **SupportFragment** 屬性。 **SupportFiltering** 屬性無效，應設定為 **False**。 如果也支援 shell 作業，則這項功能對 *資源 URI* 而言是不正確。<br/> </dd> <dt><span id="Invoke"></span><span id="invoke"></span><span id="INVOKE"></span>調用</dt> <dd> [*資源 URI*](windows-remote-management-glossary.md)支援 Invoke 作業。 Invoke 作業不支援 **SupportFragment** 屬性，應設定為 **False**。 **SupportFiltering** 屬性無效，應設定為 **False**。 如果也支援 shell 作業，則這項功能對 *資源 URI* 而言是不正確。<br/> </dd> <dt><span id="Enumerate"></span><span id="enumerate"></span><span id="ENUMERATE"></span>列舉</dt> <dd> [*資源 URI*](windows-remote-management-glossary.md)支援列舉作業。 列舉作業不支援 **SupportFragment** 屬性，應設定為 **False**。 **SupportFiltering** 屬性是有效的，而且如果外掛程式支援篩選，這個屬性應該設定為 **True**。 如果也支援 shell 作業，則這項功能對 *資源 URI* 而言是不正確。<br/> </dd> <dt><span id="Subscribe"></span><span id="subscribe"></span><span id="SUBSCRIBE"></span>訂閱</dt> <dd> [*資源 URI*](windows-remote-management-glossary.md)支援訂閱作業。 訂閱作業不支援 **SupportFragment** 屬性，應設定為 **False**。 **SupportFiltering** 屬性無效，應設定為 **False**。 如果也支援 shell 作業，則這項功能對 *資源 URI* 而言是不正確。<br/> </dd> <dt><span id="Shell"></span><span id="shell"></span><span id="SHELL"></span>Shell</dt> <dd> [*資源 URI*](windows-remote-management-glossary.md)支援 Shell 作業。 Shell 作業不支援 **SupportFragment** 屬性，應設定為 **False**。 **SupportFiltering** 屬性無效，應設定為 **False**。 如果也支援任何其他作業功能，這項功能對 *資源 URI* 而言是不正確。 如果 shell 作業功能設定為 *資源 URI*，則 get、put、create、delete、invoke 和列舉作業會在 WinRM 服務內部處理，以管理 shell。 因此，外掛程式無法處理作業本身。<br/> </dd> </dl> |



 

### <a name="example-wsmanconfig_schemaxml-file"></a>範例于 wsmanconfig.wxs \_schema.xml 檔案

在設定期間，會將名為schema.xml 于 wsmanconfig.wxs 的 XML 檔案（ \_ 包含下列內容）放在 IIS 架構目錄中：


```XML
<configSchema>
 <sectionSchema name="system.webServer/system.management.wsmanagement.config">
  <element name="OperationsConfiguration">
   <attribute name="MaxEnvelopeSizeKB" 
              type="uint" 
              defaultValue="150" 
              validationType="integerRange" 
              validationParameter="32,4294967295"/>
   <attribute name="MaxOperationTimeoutSeconds" 
              type="uint" 
              defaultValue="60" 
              validationType="integerRange" 
              validationParameter="1,4294967295"/>
   <attribute name="MaxEnumerateIdleTimeoutSeconds" 
              type="uint" 
              defaultValue="60" 
              validationType="integerRange" 
              validationParameter="1,4294967295"/>
   <attribute name="MaxSubscribeIdleTimeoutSeconds" 
              type="uint" 
              defaultValue="60" 
              validationType="integerRange" 
              validationParameter="1,4294967295"/>
   <attribute name="MaxShellIdleTimeoutMinutes" 
              type="uint" 
              defaultValue="15" 
              validationType="integerRange" 
              validationParameter="0,4294967295"/>
   <attribute name="QuotaRefreshIntervalSeconds" 
              type="uint" 
              defaultValue="900" 
              validationType="integerRange" 
              validationParameter="0,4294967295"/>
   <attribute name="QuotaSystemWindowSeconds" 
              type="uint" 
              defaultValue="2" 
              validationType="integerRange" 
              validationParameter="0,4294967295"/>
   <attribute name="QuotaSystemWindowOperations" 
              type="uint" 
              defaultValue="1000" 
              validationType="integerRange" 
              validationParameter="0,4294967295"/>
  </element>
  <element name="PluginModules">
   <collection addElement="AuthorizationPlugin">
    <attribute name="Name" type="string" isUniqueKey="true" required="true" validationType="nonEmptyString"/>
    <attribute name="Filename" type="string" required="true" validationType="nonEmptyString"/>
    <attribute name="SDKVersion" type="uint" required="true"/>
    <attribute name="SupportsQuota" type="bool" defaultValue="false"/>
   </collection>
   <element name="OperationsPlugins">
    <collection addElement="Plugin">
     <attribute name="Name" type="string" isUniqueKey="true" required="true" validationType="nonEmptyString"/>
     <attribute name="Filename" type="string" required="true" validationType="nonEmptyString"/>
     <attribute name="SDKVersion" type="uint" required="true"/>
     <attribute name="XmlRenderingType" type="enum" defaultValue="text">
      <enum name="text" value="1"/>
      <enum name="XmlReader" value="2"/>
     </attribute>
     <attribute name="Enabled" type="bool" defaultValue="true"/>
     <element name="InitializationParameters">
      <collection addElement="Param">
       <attribute name="Name" type="string" isUniqueKey="true" required="true" validationType="nonEmptyString"/>
       <attribute name="Value" type="string" required="true" validationType="nonEmptyString"/>
      </collection>
     </element>
     <element name="Resources">
      <collection addElement="Resource">
       <attribute name="ResourceUri" type="string" isUniqueKey="true" required="true" validationType="nonEmptyString"/>
       <attribute name="SupportsOptions" type="bool" defaultValue="false"/>
       <attribute name="ExactMatch" type="bool" defaultValue="false"/>
       <collection addElement="Capability">
        <attribute name="Type" type="enum" isUniqueKey="true" required="true">
         <enum name="Get" value="1"/>
         <enum name="Put" value="2"/>
         <enum name="Create" value="3"/>
         <enum name="Delete" value="4"/>
         <enum name="Invoke" value="5"/>
         <enum name="Enumerate" value="6"/>
         <enum name="Subscribe" value="7"/>
         <enum name="Shell" value="8"/>
        </attribute>
        <attribute name="SupportsFragment" type="bool" default="false"/>
        <attribute name="SupportsFiltering" type="bool" default="false"/>
       </collection>
      </collection>
     </element>
    </collection>
   </element>
  </element>
 </sectionSchema>
</configSchema>
```



## <a name="reading-iis-host-configuration"></a>正在讀取 IIS 主機設定

在主控應用程式的 SOAP 處理器啟動程式期間，會讀取 IIS 主機設定。 因為可以手動編輯 web.config 檔案，因此很容易發生架構驗證錯誤，所以在讀取設定時可能會有問題。 在設定讀取或驗證失敗期間，裝載的應用程式將無法啟動，且會將適當的錯誤訊息傳回給用戶端。 將會記錄事件，其中包含造成失敗之原因的詳細描述。

常見失敗包含下列各項：

-   拒絕存取
-   不正確設定 XML
-   未設定任何外掛程式 (至少需要一個外掛程式) 

預設不會設定標準外掛程式。 它們必須在 web.config 檔案中明確設定，才會開始接收要求。

## <a name="enumerating-plug-ins-on-the-winrm-service"></a>列舉 WinRM 服務上的外掛程式

下列命令示範如何使用 winrm 公用程式來判斷 WinRM 服務上有哪些外掛程式： **winrm 列舉 winrm/config/外掛程式-format：很美觀**。

 

