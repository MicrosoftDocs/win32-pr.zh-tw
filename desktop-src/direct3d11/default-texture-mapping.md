---
title: 預設材質對應
description: 使用預設材質對應可減少在 GPU 和 CPU 之間共用映射資料時的複製和記憶體使用量。
ms.assetid: 77AF4BFA-09B5-4181-9408-002764F2A923
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f203c7590c3673d30315250b2b4ce2663e48c9c3
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 09/16/2019
ms.locfileid: "104372198"
---
# <a name="default-texture-mapping"></a><span data-ttu-id="00459-103">預設材質對應</span><span class="sxs-lookup"><span data-stu-id="00459-103">Default Texture Mapping</span></span>

<span data-ttu-id="00459-104">使用預設材質對應可減少在 GPU 和 CPU 之間共用映射資料時的複製和記憶體使用量。</span><span class="sxs-lookup"><span data-stu-id="00459-104">The use of default texture mapping reduces copying and memory usage while sharing image data between the GPU and the CPU.</span></span> <span data-ttu-id="00459-105">不過，它應該只在特定情況下使用。</span><span class="sxs-lookup"><span data-stu-id="00459-105">However, it should only be used in specific situations.</span></span> <span data-ttu-id="00459-106">標準 swizzle 配置可避免複製或 swizzling 多個版面配置中的資料。</span><span class="sxs-lookup"><span data-stu-id="00459-106">The standard swizzle layout avoids copying or swizzling data in multiple layouts.</span></span>

-   [<span data-ttu-id="00459-107">概觀</span><span class="sxs-lookup"><span data-stu-id="00459-107">Overview</span></span>](#overview)
-   [<span data-ttu-id="00459-108">D3D 11.3 Api</span><span class="sxs-lookup"><span data-stu-id="00459-108">D3D11.3 APIs</span></span>](#d3d113-apis)
-   [<span data-ttu-id="00459-109">相關主題</span><span class="sxs-lookup"><span data-stu-id="00459-109">Related topics</span></span>](#related-topics)

## <a name="overview"></a><span data-ttu-id="00459-110">概觀</span><span class="sxs-lookup"><span data-stu-id="00459-110">Overview</span></span>

<span data-ttu-id="00459-111">對應預設紋理不應為開發人員的第一個選擇。</span><span class="sxs-lookup"><span data-stu-id="00459-111">Mapping default textures should not be the first choice for developers.</span></span> <span data-ttu-id="00459-112">開發人員應先以獨立 GPU 易懂的方式撰寫程式碼 (也就是，在大部分的材質中都沒有任何 CPU 存取，並以 [**CopySubresourceRegion1**](/windows/desktop/api/D3D11_1/nf-d3d11_1-id3d11devicecontext1-copysubresourceregion1)) 上傳。</span><span class="sxs-lookup"><span data-stu-id="00459-112">Developers should code in a discrete-GPU friendly way first (that is, do not have any CPU access for the majority of textures and upload with [**CopySubresourceRegion1**](/windows/desktop/api/D3D11_1/nf-d3d11_1-id3d11devicecontext1-copysubresourceregion1)).</span></span> <span data-ttu-id="00459-113">但在某些情況下，CPU 和 GPU 可能會在相同的資料上頻繁地互動，而對應的預設材質會變得很有用，以節省電力，或加速特定介面卡或架構上的特定設計。</span><span class="sxs-lookup"><span data-stu-id="00459-113">But, for certain cases, the CPU and GPU may interact so frequently on the same data, that mapping default textures becomes helpful to save power, or to speed up a particular design on particular adapters or architectures.</span></span> <span data-ttu-id="00459-114">應用程式應該會偵測到這些情況，並將不必要的複本優化。</span><span class="sxs-lookup"><span data-stu-id="00459-114">Applications should detect these cases and optimize out the unnecessary copies.</span></span>

<span data-ttu-id="00459-115">在 D3D 11.3 中，使用 D3D11 材質配置所建立的紋理， \_ \_ \_ ([**D3D11 \_ 材質 \_ 版面**](/windows/desktop/api/D3D11_3/ne-d3d11_3-d3d11_texture_layout) 配置) 列舉的其中一個成員，且沒有 CPU 存取最有效率的是經常進行 GPU 轉譯和取樣。</span><span class="sxs-lookup"><span data-stu-id="00459-115">In D3D11.3, textures created with D3D11\_TEXTURE\_LAYOUT\_UNDEFINED (one member of the [**D3D11\_TEXTURE\_LAYOUT**](/windows/desktop/api/D3D11_3/ne-d3d11_3-d3d11_texture_layout) enum) and no CPU access are the most efficient for frequent GPU rendering and sampling.</span></span> <span data-ttu-id="00459-116">當效能測試時，應該針對 \_ \_ 未定義的 D3D11 紋理配置 \_ 與 cpu 存取進行比較，並使用 D3D11 \_ 材質配置 \_ \_ 64k \_ 標準 SWIZZLE （ \_ 具有 cpu 存取）和 D3D11 \_ 材質版面配置資料 \_ \_ 列 \_ 主要來取得跨介面卡支援。</span><span class="sxs-lookup"><span data-stu-id="00459-116">When performance testing, those textures should be compared against D3D11\_TEXTURE\_LAYOUT\_UNDEFINED with CPU access, and D3D11\_TEXTURE\_LAYOUT\_64K\_STANDARD\_SWIZZLE with CPU access, and D3D11\_TEXTURE\_LAYOUT\_ROW\_MAJOR for cross-adapter support.</span></span>

<span data-ttu-id="00459-117">使用 D3D11 \_ 材質 \_ 版面配置 \_ （未定義 CPU 存取）可讓 [**WriteToSubresource**](/windows/desktop/api/d3d11_3/nf-d3d11_3-id3d11device3-writetosubresource)、 [**ReadFromSubresource**](/windows/desktop/api/d3d11_3/nf-d3d11_3-id3d11device3-readfromsubresource)、 [**Map**](/windows/desktop/api/D3D11/nf-d3d11-id3d11devicecontext-map) (阻止應用程式存取指標) [](/windows/desktop/api/D3D11/nf-d3d11-id3d11devicecontext-unmap)和取消對應，但可能會犧牲 GPU 存取的效率。</span><span class="sxs-lookup"><span data-stu-id="00459-117">Using D3D11\_TEXTURE\_LAYOUT\_UNDEFINED with CPU access enables the methods [**WriteToSubresource**](/windows/desktop/api/d3d11_3/nf-d3d11_3-id3d11device3-writetosubresource), [**ReadFromSubresource**](/windows/desktop/api/d3d11_3/nf-d3d11_3-id3d11device3-readfromsubresource), [**Map**](/windows/desktop/api/D3D11/nf-d3d11-id3d11devicecontext-map) (precluding application access to pointer), and [**Unmap**](/windows/desktop/api/D3D11/nf-d3d11-id3d11devicecontext-unmap); but can sacrifice efficiency of GPU access.</span></span> <span data-ttu-id="00459-118">使用 D3D11 \_ 材質 \_ 配置 \_ 64k \_ STANDARD \_ SWIZZLE 搭配 CPU 存取，可讓 **WriteToSubresource**、 **ReadFromSubresource**、Map (傳回應用程式) 和取消 **對應** 的有效指標。</span><span class="sxs-lookup"><span data-stu-id="00459-118">Using D3D11\_TEXTURE\_LAYOUT\_64K\_STANDARD\_SWIZZLE with CPU access enables **WriteToSubresource**, **ReadFromSubresource**, **Map** (which returns a valid pointer to application), and **Unmap**.</span></span> <span data-ttu-id="00459-119">它也可以犧牲 GPU 存取的效率，而不是透過 \_ \_ \_ CPU 存取未定義的 D3D11 材質版面配置。</span><span class="sxs-lookup"><span data-stu-id="00459-119">It can also sacrifice efficiency of GPU access more than D3D11\_TEXTURE\_LAYOUT\_UNDEFINED with CPU access.</span></span>

<span data-ttu-id="00459-120">一般情況下，應用程式應該將大部分的材質建立為僅適用于 GPU 的可存取，而且 D3D11 \_ 材質配置 \_ \_ 未定義。</span><span class="sxs-lookup"><span data-stu-id="00459-120">In general, applications should create the majority of textures as GPU-only-accessible, and with D3D11\_TEXTURE\_LAYOUT\_UNDEFINED.</span></span>

<span data-ttu-id="00459-121">在對應預設紋理功能的先前，只有一個多維度資料的標準化配置：「線性」，也稱為「資料列主要」。</span><span class="sxs-lookup"><span data-stu-id="00459-121">Previous to the mapping default textures feature, there was only one standardized layout for multi-dimensional data: "linear", also known as "row-major".</span></span> <span data-ttu-id="00459-122">\_當對應預設值可用時，應用程式應該避免使用暫存和使用 \_ 動態紋理。</span><span class="sxs-lookup"><span data-stu-id="00459-122">Applications should avoid USAGE\_STAGING and USAGE\_DYNAMIC textures when map default is available.</span></span> <span data-ttu-id="00459-123">使用方式 \_ 暫存和使用 \_ 動態紋理使用線性版面配置。</span><span class="sxs-lookup"><span data-stu-id="00459-123">The USAGE\_STAGING and USAGE\_DYNAMIC textures use the linear layout.</span></span>

<span data-ttu-id="00459-124">D3D 11.3 (和 D3D12) 引進標準的多維度資料版面配置。</span><span class="sxs-lookup"><span data-stu-id="00459-124">D3D11.3 (and D3D12) introduce a standard multi-dimensional data layout.</span></span> <span data-ttu-id="00459-125">這樣做的目的是為了讓多個處理單位在相同的資料上運作，而不需要複製資料或在多個配置之間 swizzling 資料。</span><span class="sxs-lookup"><span data-stu-id="00459-125">This is done to enable multiple processing units to operate on the same data without copying the data or swizzling the data between multiple layouts.</span></span> <span data-ttu-id="00459-126">標準化配置可讓您透過網路效果提高效率，並允許演算法在採用特定模式時進行短暫的剪下。</span><span class="sxs-lookup"><span data-stu-id="00459-126">A standardized layout enables efficiency gains through network effects and allows algorithms to make short-cuts assuming a particular pattern.</span></span>

<span data-ttu-id="00459-127">不過請注意，這個標準 swizzle 是硬體功能，而且可能不受所有 Gpu 支援。</span><span class="sxs-lookup"><span data-stu-id="00459-127">Note though that this standard swizzle is a hardware feature, and may not be supported by all GPUs.</span></span>

## <a name="d3d113-apis"></a><span data-ttu-id="00459-128">D3D 11.3 Api</span><span class="sxs-lookup"><span data-stu-id="00459-128">D3D11.3 APIs</span></span>

<span data-ttu-id="00459-129">不同于 D3D12，D3D 11.3 預設不支援材質對應，因此您需要查詢 [**D3D11 \_ FEATURE \_ DATA \_ D3D11 \_ OPTIONS2**](/windows/desktop/api/D3D11/ns-d3d11-d3d11_feature_data_d3d11_options2)。</span><span class="sxs-lookup"><span data-stu-id="00459-129">Unlike D3D12, D3D11.3 does not supports texture mapping by default, so you need to query [**D3D11\_FEATURE\_DATA\_D3D11\_OPTIONS2**](/windows/desktop/api/D3D11/ns-d3d11-d3d11_feature_data_d3d11_options2).</span></span> <span data-ttu-id="00459-130">使用 [**ID3D11Device：： CheckFeatureSupport**](/windows/desktop/api/D3D11/nf-d3d11-id3d11device-checkfeaturesupport) 的呼叫以及檢查 `StandardSwizzle64KBSupported` **D3D11 \_ FEATURE \_ DATA \_ D3D11 \_ OPTIONS2** 的欄位時，也需要查詢標準 swizzle。</span><span class="sxs-lookup"><span data-stu-id="00459-130">Standard swizzle will also need to be queried for with a call to [**ID3D11Device::CheckFeatureSupport**](/windows/desktop/api/D3D11/nf-d3d11-id3d11device-checkfeaturesupport) and checking the `StandardSwizzle64KBSupported` field of **D3D11\_FEATURE\_DATA\_D3D11\_OPTIONS2**.</span></span>

<span data-ttu-id="00459-131">下列 Api 參考紋理對應：</span><span class="sxs-lookup"><span data-stu-id="00459-131">The following APIs reference texture mapping:</span></span>

<span data-ttu-id="00459-132">列舉</span><span class="sxs-lookup"><span data-stu-id="00459-132">Enums</span></span>

-   <span data-ttu-id="00459-133">[**D3D11 \_材質 \_**](/windows/desktop/api/D3D11_3/ne-d3d11_3-d3d11_texture_layout) 配置：控制預設材質的 swizzle 模式，並啟用預設材質的地圖支援。</span><span class="sxs-lookup"><span data-stu-id="00459-133">[**D3D11\_TEXTURE\_LAYOUT**](/windows/desktop/api/D3D11_3/ne-d3d11_3-d3d11_texture_layout) : controls the swizzle pattern of default textures and enable map support on default textures.</span></span>
-   <span data-ttu-id="00459-134">[**D3D11 \_功能**](/windows/desktop/api/D3D11/ne-d3d11-d3d11_feature) ：參考 [**D3D11 \_ 功能 \_ 資料 \_ D3D11 \_ OPTIONS2**](/windows/desktop/api/D3D11/ns-d3d11-d3d11_feature_data_d3d11_options2)。</span><span class="sxs-lookup"><span data-stu-id="00459-134">[**D3D11\_FEATURE**](/windows/desktop/api/D3D11/ne-d3d11-d3d11_feature) : references [**D3D11\_FEATURE\_DATA\_D3D11\_OPTIONS2**](/windows/desktop/api/D3D11/ns-d3d11-d3d11_feature_data_d3d11_options2).</span></span>
-   <span data-ttu-id="00459-135">[**D3D11 \_磚 \_ 複製 \_ 旗**](/windows/desktop/api/D3D11_2/ne-d3d11_2-d3d11_tile_copy_flag) 標：包含可將 swizzled 並排顯示的資源複製到線性緩衝區的旗標。</span><span class="sxs-lookup"><span data-stu-id="00459-135">[**D3D11\_TILE\_COPY\_FLAG**](/windows/desktop/api/D3D11_2/ne-d3d11_2-d3d11_tile_copy_flag) : contains flags to copy swizzled tiled resources to and from linear buffers.</span></span>

<span data-ttu-id="00459-136">結構</span><span class="sxs-lookup"><span data-stu-id="00459-136">Structures</span></span>

-   <span data-ttu-id="00459-137">[**D3D11 \_TEXTURE2D \_ DESC1**](/windows/desktop/api/D3D11_3/ns-d3d11_3-cd3d11_texture2d_desc1) ：描述2d 材質。</span><span class="sxs-lookup"><span data-stu-id="00459-137">[**D3D11\_TEXTURE2D\_DESC1**](/windows/desktop/api/D3D11_3/ns-d3d11_3-cd3d11_texture2d_desc1) : describes a 2D texture.</span></span> <span data-ttu-id="00459-138">請注意 CD3D11 \_ TEXTURE2D \_ DESC1 helper 結構。</span><span class="sxs-lookup"><span data-stu-id="00459-138">Note the CD3D11\_TEXTURE2D\_DESC1 helper structure.</span></span>
-   <span data-ttu-id="00459-139">[**D3D11 \_TEXTURE3D \_ DESC1**](/windows/desktop/api/D3D11_3/ns-d3d11_3-cd3d11_texture3d_desc1) ：描述3d 紋理。</span><span class="sxs-lookup"><span data-stu-id="00459-139">[**D3D11\_TEXTURE3D\_DESC1**](/windows/desktop/api/D3D11_3/ns-d3d11_3-cd3d11_texture3d_desc1) : describes a 3D texture.</span></span> <span data-ttu-id="00459-140">請注意 CD3D11 \_ TEXTURE3D \_ DESC1 helper 結構。</span><span class="sxs-lookup"><span data-stu-id="00459-140">Note the CD3D11\_TEXTURE3D\_DESC1 helper structure.</span></span>

<span data-ttu-id="00459-141">方法</span><span class="sxs-lookup"><span data-stu-id="00459-141">Methods</span></span>

-   <span data-ttu-id="00459-142">[**ID3D11Device3：： CreateTexture2D1**](/windows/desktop/api/D3D11_3/nf-d3d11_3-id3d11device3-createtexture2d1) ：建立2d 材質的陣列。</span><span class="sxs-lookup"><span data-stu-id="00459-142">[**ID3D11Device3::CreateTexture2D1**](/windows/desktop/api/D3D11_3/nf-d3d11_3-id3d11device3-createtexture2d1) : creates an array of 2D textures.</span></span>
-   <span data-ttu-id="00459-143">[**ID3D11Device3：： CreateTexture3D1**](/windows/desktop/api/D3D11_3/nf-d3d11_3-id3d11device3-createtexture3d1) ：建立單一3d 紋理。</span><span class="sxs-lookup"><span data-stu-id="00459-143">[**ID3D11Device3::CreateTexture3D1**](/windows/desktop/api/D3D11_3/nf-d3d11_3-id3d11device3-createtexture3d1) : creates a single 3D texture.</span></span>
-   <span data-ttu-id="00459-144">[**ID3D11Device3：： WriteToSubresource**](/windows/desktop/api/d3d11_3/nf-d3d11_3-id3d11device3-writetosubresource) ：會將資料複製到 \_ \_ 使用 [**Map**](/windows/desktop/api/D3D11/nf-d3d11-id3d11devicecontext-map)對應的 D3D11 使用預設材質中。</span><span class="sxs-lookup"><span data-stu-id="00459-144">[**ID3D11Device3::WriteToSubresource**](/windows/desktop/api/d3d11_3/nf-d3d11_3-id3d11device3-writetosubresource) : copies data into a D3D11\_USAGE\_DEFAULT texture which was mapped using [**Map**](/windows/desktop/api/D3D11/nf-d3d11-id3d11devicecontext-map).</span></span>
-   <span data-ttu-id="00459-145">[**ID3D11Device3：： ReadFromSubresource**](/windows/desktop/api/d3d11_3/nf-d3d11_3-id3d11device3-readfromsubresource) ：從 \_ \_ 使用 [**Map**](/windows/desktop/api/D3D11/nf-d3d11-id3d11devicecontext-map)對應的 D3D11 使用量預設材質複製資料。</span><span class="sxs-lookup"><span data-stu-id="00459-145">[**ID3D11Device3::ReadFromSubresource**](/windows/desktop/api/d3d11_3/nf-d3d11_3-id3d11device3-readfromsubresource) : copies data from a D3D11\_USAGE\_DEFAULT texture which was mapped using [**Map**](/windows/desktop/api/D3D11/nf-d3d11-id3d11devicecontext-map).</span></span>
-   <span data-ttu-id="00459-146">[**>id3d11devicecoNtext：： Map**](/windows/desktop/api/D3D11/nf-d3d11-id3d11devicecontext-map) ：取得 subresource 中所含資料的指標，並拒絕該 SUBRESOURCE 的 GPU 存取。</span><span class="sxs-lookup"><span data-stu-id="00459-146">[**ID3D11DeviceContext::Map**](/windows/desktop/api/D3D11/nf-d3d11-id3d11devicecontext-map) : gets a pointer to the data contained in a subresource, and denies the GPU access to that subresource.</span></span>
-   <span data-ttu-id="00459-147">[**>id3d11devicecoNtext：：**](/windows/desktop/api/D3D11/nf-d3d11-id3d11devicecontext-unmap) 取消對應：使資源的指標失效，並 reenables GPU 對該資源的存取權。</span><span class="sxs-lookup"><span data-stu-id="00459-147">[**ID3D11DeviceContext::Unmap**](/windows/desktop/api/D3D11/nf-d3d11-id3d11devicecontext-unmap) : invalidates the pointer to a resource and reenables the GPU's access to that resource.</span></span>
-   <span data-ttu-id="00459-148">[**ID3D11Texture2D1：： GetDesc1**](/windows/desktop/api/D3D11_3/nf-d3d11_3-id3d11texture2d1-getdesc1) ：取得2d 材質資源的屬性。</span><span class="sxs-lookup"><span data-stu-id="00459-148">[**ID3D11Texture2D1::GetDesc1**](/windows/desktop/api/D3D11_3/nf-d3d11_3-id3d11texture2d1-getdesc1) : gets the properties of a 2D texture resource.</span></span>
-   <span data-ttu-id="00459-149">[**ID3D11Texture3D1：： GetDesc1**](/windows/desktop/api/D3D11_3/nf-d3d11_3-id3d11texture3d1-getdesc1) ：取得3d 紋理資源的屬性。</span><span class="sxs-lookup"><span data-stu-id="00459-149">[**ID3D11Texture3D1::GetDesc1**](/windows/desktop/api/D3D11_3/nf-d3d11_3-id3d11texture3d1-getdesc1) : gets the properties of a 3D texture resource.</span></span>

## <a name="related-topics"></a><span data-ttu-id="00459-150">相關主題</span><span class="sxs-lookup"><span data-stu-id="00459-150">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="00459-151">Direct3D 11.3 功能</span><span class="sxs-lookup"><span data-stu-id="00459-151">Direct3D 11.3 Features</span></span>](direct3d-11-3-features.md)
</dt> </dl>

 

 




