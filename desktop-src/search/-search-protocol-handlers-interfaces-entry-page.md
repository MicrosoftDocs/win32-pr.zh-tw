---
description: 此 Windows Search 參考區段包含通訊協定處理常式介面。
ms.assetid: 7089a107-ef3c-4215-aa75-3107815807a1
title: 通訊協定處理常式介面
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 1fa1277fc93ab28a8398a114d9764acba6eab95e
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/07/2021
ms.locfileid: "106973023"
---
# <a name="protocol-handlers-interfaces"></a><span data-ttu-id="c3c21-103">通訊協定處理常式介面</span><span class="sxs-lookup"><span data-stu-id="c3c21-103">Protocol Handlers Interfaces</span></span>

<span data-ttu-id="c3c21-104">此 Windows Search 參考區段包含通訊協定處理常式介面。</span><span class="sxs-lookup"><span data-stu-id="c3c21-104">This Windows Search reference section consists of protocol handler interfaces.</span></span>


## <a name="in-this-section"></a><span data-ttu-id="c3c21-105">本節內容</span><span class="sxs-lookup"><span data-stu-id="c3c21-105">In this section</span></span>



| <span data-ttu-id="c3c21-106">主題</span><span class="sxs-lookup"><span data-stu-id="c3c21-106">Topic</span></span>                                                                                   | <span data-ttu-id="c3c21-107">描述</span><span class="sxs-lookup"><span data-stu-id="c3c21-107">Description</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|-----------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="c3c21-108">**IItemPropertyBag**</span><span class="sxs-lookup"><span data-stu-id="c3c21-108">**IItemPropertyBag**</span></span>](iitempropertybag.md)<br/>                                 | <span data-ttu-id="c3c21-109">定義方法，以取得搜尋專案屬性的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="c3c21-109">Defines methods to obtain information about the properties of a search item.</span></span> <span data-ttu-id="c3c21-110">只有在 Windows XP 和 Windows Server 2003 上才支援這個介面，且不應再使用。</span><span class="sxs-lookup"><span data-stu-id="c3c21-110">This interface is supported only on Windows XP and Windows Server 2003, and should no longer be used.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| [<span data-ttu-id="c3c21-111">**IOpLockStatus**</span><span class="sxs-lookup"><span data-stu-id="c3c21-111">**IOpLockStatus**</span></span>](/windows/desktop/api/Searchapi/nn-searchapi-ioplockstatus)<br/>                               | <span data-ttu-id="c3c21-112">提供在編制索引時，檢查 Microsoft Windows 桌面搜尋 (WDS) 專案所使用之隨機鎖定的方法。</span><span class="sxs-lookup"><span data-stu-id="c3c21-112">Provides methods to check the opportunistic lock that is used by Microsoft Windows Desktop Search (WDS) on items while indexing.</span></span> <span data-ttu-id="c3c21-113">如果另一個進程以不相容的方式鎖定檔案，WDS 將會遺失其鎖定，並允許其他進程擁有該檔案。</span><span class="sxs-lookup"><span data-stu-id="c3c21-113">If another process locks the file in an incompatible manner, WDS will lose its lock and allow the other process to have the file.</span></span> <span data-ttu-id="c3c21-114">這項機制可讓 WDS 在背景中執行。</span><span class="sxs-lookup"><span data-stu-id="c3c21-114">This mechanism allows WDS to run in the background.</span></span> <span data-ttu-id="c3c21-115">因此，WDS 必須檢查其鎖定，以確保在 WDS 編制專案索引時，另一個進程未獲得優先權。</span><span class="sxs-lookup"><span data-stu-id="c3c21-115">Consequently, WDS needs to check its locks to ensure another process has not taken precedence while WDS indexes the item.</span></span> <br/> <span data-ttu-id="c3c21-116">如果基礎資料存放區提供一種機制來追蹤專案的平行存取，則協力廠商 [**IUrlAccessor**](/windows/desktop/api/Searchapi/nn-searchapi-iurlaccessor) 物件可以執行這個介面。</span><span class="sxs-lookup"><span data-stu-id="c3c21-116">A third-party [**IUrlAccessor**](/windows/desktop/api/Searchapi/nn-searchapi-iurlaccessor) object can implement this interface if the underlying data store provides a mechanism to track concurrent access to items.</span></span> <span data-ttu-id="c3c21-117">如果此介面是由 **IUrlAccessor** 所公開，WDS 將會在索引項目目時檢查該存放區的 [**IOpLockStatus**](/windows/desktop/api/Searchapi/nn-searchapi-ioplockstatus) 。</span><span class="sxs-lookup"><span data-stu-id="c3c21-117">If this interface is exposed by **IUrlAccessor**, WDS will check the [**IOpLockStatus**](/windows/desktop/api/Searchapi/nn-searchapi-ioplockstatus) while indexing items from that store.</span></span> <br/> |
| <span data-ttu-id="c3c21-118">[**IProtocolHandlerServices**](/previous-versions/windows/desktop/legacy/bb231447(v=vs.85))</span><span class="sxs-lookup"><span data-stu-id="c3c21-118">[**IProtocolHandlerServices**](/previous-versions/windows/desktop/legacy/bb231447(v=vs.85))</span></span><br/>         |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| [<span data-ttu-id="c3c21-119">**IProtocolHandlerSite**</span><span class="sxs-lookup"><span data-stu-id="c3c21-119">**IProtocolHandlerSite**</span></span>](/windows/desktop/api/Searchapi/nn-searchapi-iprotocolhandlersite)<br/>                 | <span data-ttu-id="c3c21-120">為通訊協定處理常式的 [**IUrlAccessor**](/windows/desktop/api/Searchapi/nn-searchapi-iurlaccessor) 物件提供方法，以查詢篩選背景程式中適當的 URL 專案篩選。</span><span class="sxs-lookup"><span data-stu-id="c3c21-120">Provides methods for a protocol handler's [**IUrlAccessor**](/windows/desktop/api/Searchapi/nn-searchapi-iurlaccessor) object to query the Filter Daemon for the appropriate filter for the URL item.</span></span> <br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| [<span data-ttu-id="c3c21-121">**ISearchProtocol**</span><span class="sxs-lookup"><span data-stu-id="c3c21-121">**ISearchProtocol**</span></span>](/windows/desktop/api/Searchapi/nn-searchapi-isearchprotocol)<br/>                           | <span data-ttu-id="c3c21-122">提供叫用、初始化和管理 [**IUrlAccessor**](/windows/desktop/api/Searchapi/nn-searchapi-iurlaccessor) 物件的方法。</span><span class="sxs-lookup"><span data-stu-id="c3c21-122">Provides methods for invoking, initializing, and managing [**IUrlAccessor**](/windows/desktop/api/Searchapi/nn-searchapi-iurlaccessor) objects.</span></span> <span data-ttu-id="c3c21-123">當處理來自收集程式的 Url 時，通訊協定主機會呼叫此介面中的方法。</span><span class="sxs-lookup"><span data-stu-id="c3c21-123">Methods in this interface are called by the protocol host when processing URLs from the gatherer.</span></span> <br/> <span data-ttu-id="c3c21-124">通訊協定處理常式會執行以原生格式存取內容來源的通訊協定。</span><span class="sxs-lookup"><span data-stu-id="c3c21-124">The protocol handler implements the protocol for accessing a content source in its native format.</span></span> <span data-ttu-id="c3c21-125">您可以使用這個介面來執行自訂的通訊協定處理常式，以展開可編制索引的資料來源。</span><span class="sxs-lookup"><span data-stu-id="c3c21-125">Use this interface to implement a custom protocol handler to expand the data sources that can be indexed.</span></span> <br/>                                                                                                                                                                                                                                                                                                                                                                    |
| [<span data-ttu-id="c3c21-126">**ISearchProtocol2**</span><span class="sxs-lookup"><span data-stu-id="c3c21-126">**ISearchProtocol2**</span></span>](/windows/desktop/api/Searchapi/nn-searchapi-isearchprotocol2)<br/>                         | <span data-ttu-id="c3c21-127">提供叫用、初始化和管理 [**IUrlAccessor**](/windows/desktop/api/Searchapi/nn-searchapi-iurlaccessor) 物件的方法。</span><span class="sxs-lookup"><span data-stu-id="c3c21-127">Provides methods for invoking, initializing, and managing [**IUrlAccessor**](/windows/desktop/api/Searchapi/nn-searchapi-iurlaccessor) objects.</span></span> <span data-ttu-id="c3c21-128">當處理來自收集程式的 Url 時，通訊協定主機會呼叫此介面中的方法。</span><span class="sxs-lookup"><span data-stu-id="c3c21-128">Methods in this interface are called by the protocol host when processing URLs from the gatherer.</span></span> <br/> <span data-ttu-id="c3c21-129">通訊協定處理常式會執行以原生格式存取內容來源的通訊協定。</span><span class="sxs-lookup"><span data-stu-id="c3c21-129">The protocol handler implements the protocol for accessing a content source in its native format.</span></span> <span data-ttu-id="c3c21-130">您可以使用這個介面來執行自訂的通訊協定處理常式，以展開可編制索引的資料來源。</span><span class="sxs-lookup"><span data-stu-id="c3c21-130">Use this interface to implement a custom protocol handler to expand the data sources that can be indexed.</span></span> <br/>                                                                                                                                                                                                                                                                                                                                                                    |
| [<span data-ttu-id="c3c21-131">**ISearchProtocolThreadCoNtext**</span><span class="sxs-lookup"><span data-stu-id="c3c21-131">**ISearchProtocolThreadContext**</span></span>](/windows/desktop/api/Searchapi/nn-searchapi-isearchprotocolthreadcontext)<br/> | <span data-ttu-id="c3c21-132">此選用介面可讓通訊協定處理常式在用來在通訊協定主機中進行篩選的執行緒上執行動作。</span><span class="sxs-lookup"><span data-stu-id="c3c21-132">This optional interface enables the protocol handler to perform an action on the thread used for filtering in the protocol host.</span></span> <span data-ttu-id="c3c21-133">當通訊協定主機啟動時，它會先初始化所有的通訊協定處理常式，然後再) 建立篩選執行緒 (。</span><span class="sxs-lookup"><span data-stu-id="c3c21-133">When the protocol host starts, it first initializes all the protocol handlers, and then it creates the filtering thread(s).</span></span> <span data-ttu-id="c3c21-134">此介面上的方法會啟用通訊協定處理常式，以管理篩選執行緒所使用的資源。</span><span class="sxs-lookup"><span data-stu-id="c3c21-134">The methods on this interface enable protocol handlers to manage their resources that are used by a filtering thread.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                            |
| [<span data-ttu-id="c3c21-135">**ISearchProtocolUI**</span><span class="sxs-lookup"><span data-stu-id="c3c21-135">**ISearchProtocolUI**</span></span>](-search-isearchprotocolui.md)<br/>                       | <span data-ttu-id="c3c21-136">提供叫用 [**ISearchItem**](-search-isearchitem.md) 物件的方法。</span><span class="sxs-lookup"><span data-stu-id="c3c21-136">Provides a method for invoking [**ISearchItem**](-search-isearchitem.md) objects.</span></span> <span data-ttu-id="c3c21-137">當處理來自收集程式的 Url 時，通訊協定主機會呼叫此介面中的方法。</span><span class="sxs-lookup"><span data-stu-id="c3c21-137">Methods in this interface are called by the protocol host when processing URLs from the gatherer.</span></span> <span data-ttu-id="c3c21-138">通訊協定處理常式會執行以原生格式存取內容來源的通訊協定，而此介面會執行自訂的通訊協定處理常式，以展開可編制索引的資料來源。</span><span class="sxs-lookup"><span data-stu-id="c3c21-138">The protocol handler implements the protocol for accessing a content source in its native format, and this interface implements a custom protocol handler to expand the data sources that can be indexed.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                |
| [<span data-ttu-id="c3c21-139">**IUrlAccessor**</span><span class="sxs-lookup"><span data-stu-id="c3c21-139">**IUrlAccessor**</span></span>](/windows/desktop/api/Searchapi/nn-searchapi-iurlaccessor)<br/>                                 | <span data-ttu-id="c3c21-140">提供在內容來源中處理個別專案的方法，該內容來源的 URL 是由收集器提供給篩選主控制項。</span><span class="sxs-lookup"><span data-stu-id="c3c21-140">Provides methods for processing an individual item in a content source whose URL is provided by the gatherer to the filter host.</span></span> <br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| [<span data-ttu-id="c3c21-141">**IUrlAccessor2**</span><span class="sxs-lookup"><span data-stu-id="c3c21-141">**IUrlAccessor2**</span></span>](/windows/desktop/api/Searchapi/nn-searchapi-iurlaccessor2)<br/>                               | <span data-ttu-id="c3c21-142">擴充 [**IUrlAccessor**](/windows/desktop/api/Searchapi/nn-searchapi-iurlaccessor) 介面的功能。</span><span class="sxs-lookup"><span data-stu-id="c3c21-142">Extends functionality of the [**IUrlAccessor**](/windows/desktop/api/Searchapi/nn-searchapi-iurlaccessor) interface.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| [<span data-ttu-id="c3c21-143">**IUrlAccessor3**</span><span class="sxs-lookup"><span data-stu-id="c3c21-143">**IUrlAccessor3**</span></span>](/windows/desktop/api/Searchapi/nn-searchapi-iurlaccessor3)<br/>                               | <span data-ttu-id="c3c21-144">使用 [**IUrlAccessor3：： GetImpersonationSidBlobs**](/windows/desktop/api/Searchapi/nf-searchapi-iurlaccessor3-getimpersonationsidblobs)方法擴充 [**IUrlAccessor2**](/windows/desktop/api/Searchapi/nn-searchapi-iurlaccessor2)介面的功能，以識別指定 URL (sid) 的使用者安全識別碼。</span><span class="sxs-lookup"><span data-stu-id="c3c21-144">Extends the functionality of the [**IUrlAccessor2**](/windows/desktop/api/Searchapi/nn-searchapi-iurlaccessor2) interface with the [**IUrlAccessor3::GetImpersonationSidBlobs**](/windows/desktop/api/Searchapi/nf-searchapi-iurlaccessor3-getimpersonationsidblobs) method to identify user security identifiers (SIDs) for a specified URL.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| [<span data-ttu-id="c3c21-145">**IUrlAccessor4**</span><span class="sxs-lookup"><span data-stu-id="c3c21-145">**IUrlAccessor4**</span></span>](/windows/desktop/api/Searchapi/nn-searchapi-iurlaccessor4)<br/>                               | <span data-ttu-id="c3c21-146">使用 [**IUrlAccessor4：： ShouldIndexItemContent**](/windows/desktop/api/Searchapi/nf-searchapi-iurlaccessor4-shouldindexitemcontent)方法擴充 [**IUrlAccessor3**](/windows/desktop/api/Searchapi/nn-searchapi-iurlaccessor3)介面的功能，以識別專案的內容是否應編制索引。</span><span class="sxs-lookup"><span data-stu-id="c3c21-146">Extends the functionality of the [**IUrlAccessor3**](/windows/desktop/api/Searchapi/nn-searchapi-iurlaccessor3) interface with the [**IUrlAccessor4::ShouldIndexItemContent**](/windows/desktop/api/Searchapi/nf-searchapi-iurlaccessor4-shouldindexitemcontent) method that identifies whether the content of the item should be indexed.</span></span> <br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |



 

 

 
