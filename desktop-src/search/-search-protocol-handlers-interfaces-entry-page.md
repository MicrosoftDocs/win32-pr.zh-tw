---
description: 此 Windows Search 參考區段包含通訊協定處理常式介面。
ms.assetid: 7089a107-ef3c-4215-aa75-3107815807a1
title: 通訊協定處理常式介面
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 8c4f33065c74b1ffc03e465f43842eb8376ac6929c4edf942b99383a406c29a7
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/11/2021
ms.locfileid: "119944708"
---
# <a name="protocol-handlers-interfaces"></a>通訊協定處理常式介面

此 Windows Search 參考區段包含通訊協定處理常式介面。


## <a name="in-this-section"></a>本節內容



| 主題                                                                                   | 描述                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|-----------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [**IItemPropertyBag**](iitempropertybag.md)<br/>                                 | 定義方法，以取得搜尋專案屬性的相關資訊。 只有 Windows XP 和 Windows Server 2003 才支援此介面，因此不應再使用。<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| [**IOpLockStatus**](/windows/desktop/api/Searchapi/nn-searchapi-ioplockstatus)<br/>                               | 提供方法，以檢查在編制索引時，Microsoft Windows Desktop Search (WDS) 專案的隨機鎖定。 如果另一個進程以不相容的方式鎖定檔案，WDS 將會遺失其鎖定，並允許其他進程擁有該檔案。 這項機制可讓 WDS 在背景中執行。 因此，WDS 必須檢查其鎖定，以確保在 WDS 編制專案索引時，另一個進程未獲得優先權。 <br/> 如果基礎資料存放區提供一種機制來追蹤專案的平行存取，則協力廠商 [**IUrlAccessor**](/windows/desktop/api/Searchapi/nn-searchapi-iurlaccessor) 物件可以執行這個介面。 如果此介面是由 **IUrlAccessor** 所公開，WDS 將會在索引項目目時檢查該存放區的 [**IOpLockStatus**](/windows/desktop/api/Searchapi/nn-searchapi-ioplockstatus) 。 <br/> |
| [**IProtocolHandlerServices**](/previous-versions/windows/desktop/legacy/bb231447(v=vs.85))<br/>         |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| [**IProtocolHandlerSite**](/windows/desktop/api/Searchapi/nn-searchapi-iprotocolhandlersite)<br/>                 | 為通訊協定處理常式的 [**IUrlAccessor**](/windows/desktop/api/Searchapi/nn-searchapi-iurlaccessor) 物件提供方法，以查詢篩選背景程式中適當的 URL 專案篩選。 <br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| [**ISearchProtocol**](/windows/desktop/api/Searchapi/nn-searchapi-isearchprotocol)<br/>                           | 提供叫用、初始化和管理 [**IUrlAccessor**](/windows/desktop/api/Searchapi/nn-searchapi-iurlaccessor) 物件的方法。 當處理來自收集程式的 Url 時，通訊協定主機會呼叫此介面中的方法。 <br/> 通訊協定處理常式會執行以原生格式存取內容來源的通訊協定。 您可以使用這個介面來執行自訂的通訊協定處理常式，以展開可編制索引的資料來源。 <br/>                                                                                                                                                                                                                                                                                                                                                                    |
| [**ISearchProtocol2**](/windows/desktop/api/Searchapi/nn-searchapi-isearchprotocol2)<br/>                         | 提供叫用、初始化和管理 [**IUrlAccessor**](/windows/desktop/api/Searchapi/nn-searchapi-iurlaccessor) 物件的方法。 當處理來自收集程式的 Url 時，通訊協定主機會呼叫此介面中的方法。 <br/> 通訊協定處理常式會執行以原生格式存取內容來源的通訊協定。 您可以使用這個介面來執行自訂的通訊協定處理常式，以展開可編制索引的資料來源。 <br/>                                                                                                                                                                                                                                                                                                                                                                    |
| [**ISearchProtocolThreadCoNtext**](/windows/desktop/api/Searchapi/nn-searchapi-isearchprotocolthreadcontext)<br/> | 此選用介面可讓通訊協定處理常式在用來在通訊協定主機中進行篩選的執行緒上執行動作。 當通訊協定主機啟動時，它會先初始化所有的通訊協定處理常式，然後再) 建立篩選執行緒 (。 此介面上的方法會啟用通訊協定處理常式，以管理篩選執行緒所使用的資源。<br/>                                                                                                                                                                                                                                                                                                                                                                                                                            |
| [**ISearchProtocolUI**](-search-isearchprotocolui.md)<br/>                       | 提供叫用 [**ISearchItem**](-search-isearchitem.md) 物件的方法。 當處理來自收集程式的 Url 時，通訊協定主機會呼叫此介面中的方法。 通訊協定處理常式會執行以原生格式存取內容來源的通訊協定，而此介面會執行自訂的通訊協定處理常式，以展開可編制索引的資料來源。<br/>                                                                                                                                                                                                                                                                                                                                                                                                                |
| [**IUrlAccessor**](/windows/desktop/api/Searchapi/nn-searchapi-iurlaccessor)<br/>                                 | 提供在內容來源中處理個別專案的方法，該內容來源的 URL 是由收集器提供給篩選主控制項。 <br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| [**IUrlAccessor2**](/windows/desktop/api/Searchapi/nn-searchapi-iurlaccessor2)<br/>                               | 擴充 [**IUrlAccessor**](/windows/desktop/api/Searchapi/nn-searchapi-iurlaccessor) 介面的功能。<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| [**IUrlAccessor3**](/windows/desktop/api/Searchapi/nn-searchapi-iurlaccessor3)<br/>                               | 使用 [**IUrlAccessor3：： GetImpersonationSidBlobs**](/windows/desktop/api/Searchapi/nf-searchapi-iurlaccessor3-getimpersonationsidblobs)方法擴充 [**IUrlAccessor2**](/windows/desktop/api/Searchapi/nn-searchapi-iurlaccessor2)介面的功能，以識別指定 URL (sid) 的使用者安全識別碼。<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| [**IUrlAccessor4**](/windows/desktop/api/Searchapi/nn-searchapi-iurlaccessor4)<br/>                               | 使用 [**IUrlAccessor4：： ShouldIndexItemContent**](/windows/desktop/api/Searchapi/nf-searchapi-iurlaccessor4-shouldindexitemcontent)方法擴充 [**IUrlAccessor3**](/windows/desktop/api/Searchapi/nn-searchapi-iurlaccessor3)介面的功能，以識別專案的內容是否應編制索引。 <br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |



 

 

 
