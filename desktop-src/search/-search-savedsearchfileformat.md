---
description: Windows 使用者可以將搜尋儲存為搜尋資料夾，這個檔案是由 XML 檔案所產生，該檔案是以可供 Windows 搜尋子系統使用的形式儲存查詢。
ms.assetid: 1c73e220-a999-4243-879c-ac7310151def
title: 儲存的搜尋檔案格式
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: d19cf936f78b045814bf7cba31a123c40d61927a
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/07/2021
ms.locfileid: "104511094"
---
# <a name="saved-search-file-format"></a><span data-ttu-id="d91e4-103">儲存的搜尋檔案格式</span><span class="sxs-lookup"><span data-stu-id="d91e4-103">Saved Search File Format</span></span>

<span data-ttu-id="d91e4-104">在 Windows Vista 和更新版本中，使用者可以將搜尋儲存為搜尋資料夾，這個檔案是由 XML 檔案所產生，該檔案是以可供 Windows 搜尋子系統使用的形式來儲存查詢。</span><span class="sxs-lookup"><span data-stu-id="d91e4-104">In Windows Vista and later, users can save searches as a Search Folder which is generated by an XML file that stores the query in a form that can be used by the Windows search subsystem.</span></span> <span data-ttu-id="d91e4-105">本主題說明 (的檔案格式 \* 。搜尋-ms) ，其中包含下列各節：</span><span class="sxs-lookup"><span data-stu-id="d91e4-105">This topic describes the file format (\*.search-ms) and includes the following sections:</span></span>

- [<span data-ttu-id="d91e4-106">已儲存搜尋的總覽</span><span class="sxs-lookup"><span data-stu-id="d91e4-106">Overview of Saved Searches</span></span>](#overview-of-saved-searches)
- [<span data-ttu-id="d91e4-107">\<viewInfo> 元素</span><span class="sxs-lookup"><span data-stu-id="d91e4-107">\<viewInfo> Element</span></span>](/windows)
  - [<span data-ttu-id="d91e4-108">\<viewInfo> 屬性</span><span class="sxs-lookup"><span data-stu-id="d91e4-108">\<viewInfo> Attributes</span></span>](/windows)
  - [<span data-ttu-id="d91e4-109">\<viewInfo> 子項目</span><span class="sxs-lookup"><span data-stu-id="d91e4-109">\<viewInfo> Child Elements</span></span>](/windows)
- [<span data-ttu-id="d91e4-110">\<query> 元素</span><span class="sxs-lookup"><span data-stu-id="d91e4-110">\<query> Element</span></span>](/windows)
  - [<span data-ttu-id="d91e4-111">\<query> 子項目</span><span class="sxs-lookup"><span data-stu-id="d91e4-111">\<query> Child Elements</span></span>](/windows)
- [<span data-ttu-id="d91e4-112">\<properties> 元素</span><span class="sxs-lookup"><span data-stu-id="d91e4-112">\<properties> Element</span></span>](/windows)
- [<span data-ttu-id="d91e4-113">搜尋-ms 檔案格式的完整規格</span><span class="sxs-lookup"><span data-stu-id="d91e4-113">Full Specification of the search-ms File Format</span></span>](#full-specification-of-the-search-ms-file-format)
- [<span data-ttu-id="d91e4-114">已儲存搜尋的範例</span><span class="sxs-lookup"><span data-stu-id="d91e4-114">Examples of Saved Searches</span></span>](#examples-of-saved-searches)

## <a name="overview-of-saved-searches"></a><span data-ttu-id="d91e4-115">已儲存搜尋的總覽</span><span class="sxs-lookup"><span data-stu-id="d91e4-115">Overview of Saved Searches</span></span>

<span data-ttu-id="d91e4-116">使用者可以將搜尋查詢儲存為搜尋資料夾，Windows 檔案總管顯示在 [搜尋] 資料夾底下的虛擬資料夾。</span><span class="sxs-lookup"><span data-stu-id="d91e4-116">Users can save a search query as a Search Folder, a virtual folder displayed in Windows Explorer under the Searches folder.</span></span> <span data-ttu-id="d91e4-117">開啟搜尋資料夾會執行已儲存的搜尋，並顯示最新的結果。</span><span class="sxs-lookup"><span data-stu-id="d91e4-117">Opening a Search Folder runs the saved search and displays up-to-date results.</span></span> <span data-ttu-id="d91e4-118">儲存的搜尋檔案會以 Windows Search 可採取行動的格式來儲存查詢、指定要搜尋的內容、搜尋位置，以及如何呈現結果。</span><span class="sxs-lookup"><span data-stu-id="d91e4-118">The saved search file stores the query in a format Windows Search can act on, specifying what to search for, where to search, and how to present the results.</span></span>

<span data-ttu-id="d91e4-119">已儲存的搜尋是從 XML 檔案產生， (\* 。搜尋-ms) 在% userprofile% \\ 搜尋資料夾中。</span><span class="sxs-lookup"><span data-stu-id="d91e4-119">The saved search is generated from an XML file (\*.search-ms) in the %userprofile%\\Searches folder.</span></span> <span data-ttu-id="d91e4-120">資料會分成 XML 檔案中的三個主要元素：</span><span class="sxs-lookup"><span data-stu-id="d91e4-120">The data is divided into three primary elements in the XML file:</span></span>

- <span data-ttu-id="d91e4-121">\<viewInfo> 指定簡報資訊</span><span class="sxs-lookup"><span data-stu-id="d91e4-121">\<viewInfo> specifies presentation information</span></span>
- <span data-ttu-id="d91e4-122">\<query> 指定 (搜尋查詢資訊</span><span class="sxs-lookup"><span data-stu-id="d91e4-122">\<query> specifies (search query information</span></span>
- <span data-ttu-id="d91e4-123">\<properties> 指定的屬性 \* 。搜尋-ms 檔案本身</span><span class="sxs-lookup"><span data-stu-id="d91e4-123">\<properties> specifies properties of the \*.search-ms file itself</span></span>

<span data-ttu-id="d91e4-124">下列範例顯示已儲存之搜尋檔案的高階結構。</span><span class="sxs-lookup"><span data-stu-id="d91e4-124">The following example shows the high-level structure of a saved search file.</span></span>

```XML
<?xml version="1.0"?>
<persistedQuery version="1.0">

    <viewInfo ...>
        ...
    </viewInfo>

    <query>
        ...
    </query>

    <properties>
        ...
    </properties>

</persistedQuery>
```

## <a name="viewinfo-element"></a><span data-ttu-id="d91e4-125">\<viewInfo> 項目</span><span class="sxs-lookup"><span data-stu-id="d91e4-125">\<viewInfo> Element</span></span>

<span data-ttu-id="d91e4-126">\<viewInfo>元素會指定如何向使用者呈現結果。</span><span class="sxs-lookup"><span data-stu-id="d91e4-126">The \<viewInfo> element specifies how the results are presented to the end user.</span></span> <span data-ttu-id="d91e4-127">下列範例顯示元素的結構。</span><span class="sxs-lookup"><span data-stu-id="d91e4-127">The following example shows the structure of the element.</span></span>

```XML
...
    <viewInfo viewMode=""
              iconSize=""
              stackIconSize=""
              autoListFlags=""
              folderFlags=""
              taskFlags=""
              displayName="">

        <visibleColumns>
            <column viewField=""/>
        </visibleColumns>

        <frequentlyUsedColumns>
            <column viewField= ""/>
        </frequentlyUsedColumns>

        <columnChooserColumns >
            <column viewField=""/>
        </columnChooserColumns >

        <groupBy viewField=""
                 direction=""/>

        <stackList>
            <stack viewField=""/>
        </stackList>

        <sortList>
            <sort viewField=""
                  direction=""/>
        </sortList>
    </viewInfo>
...
```

### <a name="viewinfo-attributes"></a><span data-ttu-id="d91e4-128">\<viewInfo> 屬性</span><span class="sxs-lookup"><span data-stu-id="d91e4-128">\<viewInfo> Attributes</span></span>

<span data-ttu-id="d91e4-129">下表說明 \<viewInfo> 元素的屬性。</span><span class="sxs-lookup"><span data-stu-id="d91e4-129">The following table describes the attributes of the \<viewInfo> element.</span></span>

| <span data-ttu-id="d91e4-130">屬性</span><span class="sxs-lookup"><span data-stu-id="d91e4-130">Attribute</span></span>     | <span data-ttu-id="d91e4-131">描述</span><span class="sxs-lookup"><span data-stu-id="d91e4-131">Description</span></span>                                                                     | <span data-ttu-id="d91e4-132">值</span><span class="sxs-lookup"><span data-stu-id="d91e4-132">Values</span></span>                     |
|---------------|---------------------------------------------------------------------------------|----------------------------|
| <span data-ttu-id="d91e4-133">viewMode</span><span class="sxs-lookup"><span data-stu-id="d91e4-133">viewMode</span></span>      | <span data-ttu-id="d91e4-134">指定資料夾的視圖。</span><span class="sxs-lookup"><span data-stu-id="d91e4-134">Specifies the folder view.</span></span>                                                      | <span data-ttu-id="d91e4-135">詳細資料 \| 圖示 \| 磚</span><span class="sxs-lookup"><span data-stu-id="d91e4-135">Details \| Icons \| Tiles</span></span>  |
| <span data-ttu-id="d91e4-136">iconSize</span><span class="sxs-lookup"><span data-stu-id="d91e4-136">iconSize</span></span>      | <span data-ttu-id="d91e4-137">控制非堆疊時，專案的圖示和縮圖的預設大小。</span><span class="sxs-lookup"><span data-stu-id="d91e4-137">Controls the default size of the icons and thumbnails for items when not stack.</span></span> | <span data-ttu-id="d91e4-138">介於16到256之間的整數</span><span class="sxs-lookup"><span data-stu-id="d91e4-138">Integer between 16 and 256</span></span> |
| <span data-ttu-id="d91e4-139">stackIconSize</span><span class="sxs-lookup"><span data-stu-id="d91e4-139">stackIconSize</span></span> | <span data-ttu-id="d91e4-140">僅供內部使用。</span><span class="sxs-lookup"><span data-stu-id="d91e4-140">For internal use only.</span></span> <span data-ttu-id="d91e4-141">請勿使用。</span><span class="sxs-lookup"><span data-stu-id="d91e4-141">Do not use.</span></span>                                              | <span data-ttu-id="d91e4-142">n/a</span><span class="sxs-lookup"><span data-stu-id="d91e4-142">n/a</span></span>                        |
| <span data-ttu-id="d91e4-143">displayName</span><span class="sxs-lookup"><span data-stu-id="d91e4-143">displayName</span></span>   | <span data-ttu-id="d91e4-144">僅供內部使用。</span><span class="sxs-lookup"><span data-stu-id="d91e4-144">For internal use only.</span></span> <span data-ttu-id="d91e4-145">請勿使用。</span><span class="sxs-lookup"><span data-stu-id="d91e4-145">Do not use.</span></span>                                              | <span data-ttu-id="d91e4-146">n/a</span><span class="sxs-lookup"><span data-stu-id="d91e4-146">n/a</span></span>                        |
| <span data-ttu-id="d91e4-147">autoListFlags</span><span class="sxs-lookup"><span data-stu-id="d91e4-147">autoListFlags</span></span> | <span data-ttu-id="d91e4-148">僅供內部使用。</span><span class="sxs-lookup"><span data-stu-id="d91e4-148">For internal use only.</span></span> <span data-ttu-id="d91e4-149">請勿使用。</span><span class="sxs-lookup"><span data-stu-id="d91e4-149">Do not use.</span></span>                                              | <span data-ttu-id="d91e4-150">n/a</span><span class="sxs-lookup"><span data-stu-id="d91e4-150">n/a</span></span>                        |
| <span data-ttu-id="d91e4-151">folderFlags</span><span class="sxs-lookup"><span data-stu-id="d91e4-151">folderFlags</span></span>   | <span data-ttu-id="d91e4-152">僅供內部使用。</span><span class="sxs-lookup"><span data-stu-id="d91e4-152">For internal use only.</span></span> <span data-ttu-id="d91e4-153">請勿使用。</span><span class="sxs-lookup"><span data-stu-id="d91e4-153">Do not use.</span></span>                                              | <span data-ttu-id="d91e4-154">n/a</span><span class="sxs-lookup"><span data-stu-id="d91e4-154">n/a</span></span>                        |
| <span data-ttu-id="d91e4-155">taskFlags</span><span class="sxs-lookup"><span data-stu-id="d91e4-155">taskFlags</span></span>     | <span data-ttu-id="d91e4-156">僅供內部使用。</span><span class="sxs-lookup"><span data-stu-id="d91e4-156">For internal use only.</span></span> <span data-ttu-id="d91e4-157">請勿使用。</span><span class="sxs-lookup"><span data-stu-id="d91e4-157">Do not use.</span></span>                                              | <span data-ttu-id="d91e4-158">n/a</span><span class="sxs-lookup"><span data-stu-id="d91e4-158">n/a</span></span>                        |

### <a name="viewinfo-child-elements"></a><span data-ttu-id="d91e4-159">\<viewInfo> 子項目</span><span class="sxs-lookup"><span data-stu-id="d91e4-159">\<viewInfo> Child Elements</span></span>

<span data-ttu-id="d91e4-160">專案的子專案 \<viewInfo> 會指定 Windows 檔案總管搜尋結果中顯示的資料行，以及如何分組和排序結果。</span><span class="sxs-lookup"><span data-stu-id="d91e4-160">The child elements of the \<viewInfo> element specify which columns appear in the Windows Explorer search results and how the results are grouped and sorted.</span></span> <span data-ttu-id="d91e4-161">每個子項目都包含一組已排序的資料行，這些資料行是由系統屬性的標準名稱所識別 (例如，system.servicemodel) 。</span><span class="sxs-lookup"><span data-stu-id="d91e4-161">Each child element contains an ordered set of columns, identified by canonical names of system properties (for example, System.DisplayName).</span></span> <span data-ttu-id="d91e4-162">如果未在儲存的搜尋檔案中定義，搜尋結果會顯示一組預設的資料行，適用于所顯示的檔案類型。</span><span class="sxs-lookup"><span data-stu-id="d91e4-162">If not defined in the saved search file, the search results are presented with a default set of columns appropriate for the file types displayed.</span></span>

| <span data-ttu-id="d91e4-163">元素</span><span class="sxs-lookup"><span data-stu-id="d91e4-163">Element</span></span>               | <span data-ttu-id="d91e4-164">描述</span><span class="sxs-lookup"><span data-stu-id="d91e4-164">Description</span></span>                                                                                        | <span data-ttu-id="d91e4-165">值</span><span class="sxs-lookup"><span data-stu-id="d91e4-165">Values</span></span>                                                       |
|-----------------------|----------------------------------------------------------------------------------------------------|--------------------------------------------------------------|
| <span data-ttu-id="d91e4-166">visibleColumns</span><span class="sxs-lookup"><span data-stu-id="d91e4-166">visibleColumns</span></span>        | <span data-ttu-id="d91e4-167">指定要出現在結果檢視中的已排序資料行清單。</span><span class="sxs-lookup"><span data-stu-id="d91e4-167">Specifies an ordered list of columns to appear in the results view.</span></span> <span data-ttu-id="d91e4-168">使用者可以變更此清單。</span><span class="sxs-lookup"><span data-stu-id="d91e4-168">The user can change this list.</span></span> | <span data-ttu-id="d91e4-169">任何系統屬性。</span><span class="sxs-lookup"><span data-stu-id="d91e4-169">Any system property.</span></span>                                         |
| <span data-ttu-id="d91e4-170">frequentlyUsedColumns</span><span class="sxs-lookup"><span data-stu-id="d91e4-170">frequentlyUsedColumns</span></span> | <span data-ttu-id="d91e4-171">僅供內部使用。</span><span class="sxs-lookup"><span data-stu-id="d91e4-171">For internal use only.</span></span> <span data-ttu-id="d91e4-172">請勿使用。</span><span class="sxs-lookup"><span data-stu-id="d91e4-172">Do not use.</span></span>                                                                 | <span data-ttu-id="d91e4-173">n/a</span><span class="sxs-lookup"><span data-stu-id="d91e4-173">n/a</span></span>                                                          |
| <span data-ttu-id="d91e4-174">columnChooserColumns</span><span class="sxs-lookup"><span data-stu-id="d91e4-174">columnChooserColumns</span></span>  | <span data-ttu-id="d91e4-175">僅供內部使用。</span><span class="sxs-lookup"><span data-stu-id="d91e4-175">For internal use only.</span></span> <span data-ttu-id="d91e4-176">請勿使用。</span><span class="sxs-lookup"><span data-stu-id="d91e4-176">Do not use.</span></span>                                                                 | <span data-ttu-id="d91e4-177">n/a</span><span class="sxs-lookup"><span data-stu-id="d91e4-177">n/a</span></span>                                                          |
| <span data-ttu-id="d91e4-178">groupBy</span><span class="sxs-lookup"><span data-stu-id="d91e4-178">groupBy</span></span>               | <span data-ttu-id="d91e4-179">指定用來將結果分組的單一系統屬性。</span><span class="sxs-lookup"><span data-stu-id="d91e4-179">Specifies a single system property by which to group the results.</span></span> <span data-ttu-id="d91e4-180">使用者可以變更此值。</span><span class="sxs-lookup"><span data-stu-id="d91e4-180">The user can change this value.</span></span>  | <span data-ttu-id="d91e4-181">任何系統屬性。</span><span class="sxs-lookup"><span data-stu-id="d91e4-181">Any system property.</span></span>                                         |
| <span data-ttu-id="d91e4-182">sortList</span><span class="sxs-lookup"><span data-stu-id="d91e4-182">sortList</span></span>              | <span data-ttu-id="d91e4-183">指定排序結果所依據之資料行的排序清單。</span><span class="sxs-lookup"><span data-stu-id="d91e4-183">Specifies an ordered list of columns to sort the results by.</span></span>                                       | <span data-ttu-id="d91e4-184">最多四個系統屬性。</span><span class="sxs-lookup"><span data-stu-id="d91e4-184">Up to four system properties.</span></span> <span data-ttu-id="d91e4-185">使用者可以變更此清單。</span><span class="sxs-lookup"><span data-stu-id="d91e4-185">The user can change this list.</span></span> |
| <span data-ttu-id="d91e4-186">stackList</span><span class="sxs-lookup"><span data-stu-id="d91e4-186">stackList</span></span>             | <span data-ttu-id="d91e4-187">僅供內部使用。</span><span class="sxs-lookup"><span data-stu-id="d91e4-187">For internal use only.</span></span> <span data-ttu-id="d91e4-188">請勿使用。</span><span class="sxs-lookup"><span data-stu-id="d91e4-188">Do not use.</span></span>                                                                 | <span data-ttu-id="d91e4-189">n/a</span><span class="sxs-lookup"><span data-stu-id="d91e4-189">n/a</span></span>                                                          |

## <a name="query-element"></a><span data-ttu-id="d91e4-190">\<query> 項目</span><span class="sxs-lookup"><span data-stu-id="d91e4-190">\<query> Element</span></span>

<span data-ttu-id="d91e4-191">\<query>元素會指定屬性，以定義查詢結果的方式。</span><span class="sxs-lookup"><span data-stu-id="d91e4-191">The \<query> element specifies the attributes which define how the results are queried.</span></span> <span data-ttu-id="d91e4-192">下列範例顯示元素的結構。</span><span class="sxs-lookup"><span data-stu-id="d91e4-192">The following example shows the structure of the element.</span></span>

```XML
...
    <query>
        <providers>
            <provider clsid=""/>    <!-- Do not use -->
        </providers>

        <subQueries>
            <subQuery path=""/>           <!-- Do not use -->
            <subQuery knownSearch=""/>    <!-- Do not use -->
        </subQueries>

        <scope>
            <include path=""        nonRecursive=""/>   <!-- [path of location to include] -->
            <include knownFolder="" nonRecursive=""/>   <!-- Known folder ID  -->
            <exclude path=""        nonRecursive=""/>   <!-- [path of location to exclude] -->
            <exclude knownFolder="" nonRecursive=""/>   <!-- Known folder ID  -->
        </scope>

        <kindList>
            <kind name=""/>     <!-- Kind value -->
        </kindList>

        <conditions>
            <condition type="" ...>     <!-- andCondition | orCondition | notCondition | leafCondition -->
                <attributes>
                    <attribute attributeID="" .../> <!-- Do not use -->
                </attributes>
            </condition>
        </conditions>
    </query>
...
```

### <a name="query-child-elements"></a><span data-ttu-id="d91e4-193">\<query> 子項目</span><span class="sxs-lookup"><span data-stu-id="d91e4-193">\<query> Child Elements</span></span>

<span data-ttu-id="d91e4-194">下表說明 \<scope> 元素的子項目。</span><span class="sxs-lookup"><span data-stu-id="d91e4-194">The following table describes the child elements of the \<scope> element.</span></span>

| <span data-ttu-id="d91e4-195">元素</span><span class="sxs-lookup"><span data-stu-id="d91e4-195">Element</span></span>    | <span data-ttu-id="d91e4-196">描述</span><span class="sxs-lookup"><span data-stu-id="d91e4-196">Description</span></span>                                                                                                               | <span data-ttu-id="d91e4-197">值</span><span class="sxs-lookup"><span data-stu-id="d91e4-197">Value</span></span>                                                                                                                                                                                                                                                          |
|------------|---------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="d91e4-198">提供者</span><span class="sxs-lookup"><span data-stu-id="d91e4-198">providers</span></span>  | <span data-ttu-id="d91e4-199">僅供內部使用。</span><span class="sxs-lookup"><span data-stu-id="d91e4-199">For internal use only.</span></span> <span data-ttu-id="d91e4-200">請勿使用。</span><span class="sxs-lookup"><span data-stu-id="d91e4-200">Do not use.</span></span>                                                                                        | <span data-ttu-id="d91e4-201">n/a</span><span class="sxs-lookup"><span data-stu-id="d91e4-201">n/a</span></span>                                                                                                                                                                                                                                                            |
| <span data-ttu-id="d91e4-202">對子</span><span class="sxs-lookup"><span data-stu-id="d91e4-202">subQueries</span></span> | <span data-ttu-id="d91e4-203">僅供內部使用。</span><span class="sxs-lookup"><span data-stu-id="d91e4-203">For internal use only.</span></span> <span data-ttu-id="d91e4-204">請勿使用。</span><span class="sxs-lookup"><span data-stu-id="d91e4-204">Do not use.</span></span>                                                                                        | <span data-ttu-id="d91e4-205">n/a</span><span class="sxs-lookup"><span data-stu-id="d91e4-205">n/a</span></span>                                                                                                                                                                                                                                                            |
| <span data-ttu-id="d91e4-206">影響範圍</span><span class="sxs-lookup"><span data-stu-id="d91e4-206">Scope</span></span>      | <span data-ttu-id="d91e4-207">識別要在搜尋中包含或排除的位置。</span><span class="sxs-lookup"><span data-stu-id="d91e4-207">Identifies locations to include or exclude in the search.</span></span>                                                                 | <span data-ttu-id="d91e4-208">要包含或排除之位置的路徑或 [已知資料夾識別碼](/windows/win32/api/shobjidl_core/nf-shobjidl_core-iknownfolder-getid) 。</span><span class="sxs-lookup"><span data-stu-id="d91e4-208">Either a path or a [known folder ID](/windows/win32/api/shobjidl_core/nf-shobjidl_core-iknownfolder-getid) of the location to be included or excluded.</span></span> <span data-ttu-id="d91e4-209">此元素也可以指定搜尋是否應包含/排除 (淺層或深層搜尋) 的子路徑。</span><span class="sxs-lookup"><span data-stu-id="d91e4-209">This element can also specify whether the search should include/exclude child paths (a shallow or deep search).</span></span> |
| <span data-ttu-id="d91e4-210">kindList</span><span class="sxs-lookup"><span data-stu-id="d91e4-210">kindList</span></span>   | <span data-ttu-id="d91e4-211">識別要搜尋)  (的檔案類型。</span><span class="sxs-lookup"><span data-stu-id="d91e4-211">Identifies the kind of file(s) to search for.</span></span>                                                                             | <span data-ttu-id="d91e4-212">任何 system.string 值。</span><span class="sxs-lookup"><span data-stu-id="d91e4-212">Any System.Kind value.</span></span>                                                                                                                                                                                                                                         |
| <span data-ttu-id="d91e4-213">條件</span><span class="sxs-lookup"><span data-stu-id="d91e4-213">conditions</span></span> | <span data-ttu-id="d91e4-214">指定篩選結果的規則。</span><span class="sxs-lookup"><span data-stu-id="d91e4-214">Specifies rules for filtering results.</span></span> <span data-ttu-id="d91e4-215">例如，可能會將結果限制為傳送給特定人員或的電子郵件。</span><span class="sxs-lookup"><span data-stu-id="d91e4-215">For example, results could be limited to emails sent by or to a particular person.</span></span> | <span data-ttu-id="d91e4-216">Microsoft.visualstudio.testtools.uitest.extension.andcondition.match、orCondition、notCondition、leafCondition。</span><span class="sxs-lookup"><span data-stu-id="d91e4-216">andCondition, orCondition, notCondition, leafCondition.</span></span>                                                                                                                                                                                                        |

### <a name="scope-element"></a><span data-ttu-id="d91e4-217">\<scope> 項目</span><span class="sxs-lookup"><span data-stu-id="d91e4-217">\<scope> Element</span></span>

<span data-ttu-id="d91e4-218">\<scope>元素會識別要在搜尋中包含或排除的位置。</span><span class="sxs-lookup"><span data-stu-id="d91e4-218">The \<scope> element identifies the locations to include or exclude from the search.</span></span> <span data-ttu-id="d91e4-219">\<scope>元素必須包含至少一個 \<include> 子項目，以及零或多個 \<exclude> 元素。</span><span class="sxs-lookup"><span data-stu-id="d91e4-219">The \<scope> element must contain at least one \<include> child element present and zero or more \<exclude> elements.</span></span> <span data-ttu-id="d91e4-220">您可以將位置指定為支援的路徑 (環境變數) 或作為 [已知的資料夾識別碼](/windows/win32/api/shobjidl_core/nf-shobjidl_core-iknownfolder-getid)。</span><span class="sxs-lookup"><span data-stu-id="d91e4-220">The locations can be specified as either a path (environment variables are supported) or as a [known folder identifier](/windows/win32/api/shobjidl_core/nf-shobjidl_core-iknownfolder-getid).</span></span> <span data-ttu-id="d91e4-221">此外，您可以將非遞迴設定為 "true" 或 "false" (預設為遞迴) ，藉此指定每個位置來搜尋 deep 或淺層。</span><span class="sxs-lookup"><span data-stu-id="d91e4-221">Furthermore, each of these locations can be specified to be searched deep or shallow by setting the nonRecursive to "true" or "false" (default is recursive).</span></span> <span data-ttu-id="d91e4-222">您可以藉由指定 exclude 元素來排除部分內含的位置清單。</span><span class="sxs-lookup"><span data-stu-id="d91e4-222">Parts of the included list of locations can be excluded by specifying exclude elements.</span></span>

<span data-ttu-id="d91e4-223">以下顯示的專案 \<scope> 會搜尋檔特殊資料夾，但不會搜尋其子系、"e：" 磁片區和其子系，而不是 "e： \\ windows" 目錄或其任何子系：</span><span class="sxs-lookup"><span data-stu-id="d91e4-223">The following shows a \<scope> element that will search the documents special folder, but not its children, the "E:" volume and its children, but not "E:\\windows" directory or any of its children:</span></span>

```XML
...
    <query>
        ...
        <scope>
            <include knownFolder="{FDD39AD0-238F-46AF-ADB4-6C85480369C7}" nonRecursive="true"/>
            <include path="E:\"/>
            <exclude path="E:\Windows" nonRecursive="false"/>
        </scope>
        ...
    </query>
...
```

### <a name="kindlist-element"></a><span data-ttu-id="d91e4-224">\<kindList> 項目</span><span class="sxs-lookup"><span data-stu-id="d91e4-224">\<kindList> Element</span></span>

<span data-ttu-id="d91e4-225">這些元素會定義應該出現在程式庫中之專案的「種類」聯集。</span><span class="sxs-lookup"><span data-stu-id="d91e4-225">These elements define the union of the "kind" of items that should appear in the library.</span></span> <span data-ttu-id="d91e4-226">有效值為：</span><span class="sxs-lookup"><span data-stu-id="d91e4-226">The valid values are:</span></span>

- <span data-ttu-id="d91e4-227">行事曆</span><span class="sxs-lookup"><span data-stu-id="d91e4-227">calendar</span></span>
- <span data-ttu-id="d91e4-228">communication</span><span class="sxs-lookup"><span data-stu-id="d91e4-228">communication</span></span>
- <span data-ttu-id="d91e4-229">連絡人</span><span class="sxs-lookup"><span data-stu-id="d91e4-229">contact</span></span>
- <span data-ttu-id="d91e4-230">文件</span><span class="sxs-lookup"><span data-stu-id="d91e4-230">document</span></span>
- <span data-ttu-id="d91e4-231">電子郵件</span><span class="sxs-lookup"><span data-stu-id="d91e4-231">email</span></span>
- <span data-ttu-id="d91e4-232">饋送</span><span class="sxs-lookup"><span data-stu-id="d91e4-232">feed</span></span>
- <span data-ttu-id="d91e4-233">folder</span><span class="sxs-lookup"><span data-stu-id="d91e4-233">folder</span></span>
- <span data-ttu-id="d91e4-234">遊戲</span><span class="sxs-lookup"><span data-stu-id="d91e4-234">game</span></span>
- <span data-ttu-id="d91e4-235">instantmessage</span><span class="sxs-lookup"><span data-stu-id="d91e4-235">instantmessage</span></span>
- <span data-ttu-id="d91e4-236">雜誌</span><span class="sxs-lookup"><span data-stu-id="d91e4-236">journal</span></span>
- <span data-ttu-id="d91e4-237">link</span><span class="sxs-lookup"><span data-stu-id="d91e4-237">link</span></span>
- <span data-ttu-id="d91e4-238">電影</span><span class="sxs-lookup"><span data-stu-id="d91e4-238">movie</span></span>
- <span data-ttu-id="d91e4-239">music</span><span class="sxs-lookup"><span data-stu-id="d91e4-239">music</span></span>
- <span data-ttu-id="d91e4-240">注意</span><span class="sxs-lookup"><span data-stu-id="d91e4-240">note</span></span>
- <span data-ttu-id="d91e4-241">picture</span><span class="sxs-lookup"><span data-stu-id="d91e4-241">picture</span></span>
- <span data-ttu-id="d91e4-242">程式</span><span class="sxs-lookup"><span data-stu-id="d91e4-242">program</span></span>
- <span data-ttu-id="d91e4-243">recordedtv</span><span class="sxs-lookup"><span data-stu-id="d91e4-243">recordedtv</span></span>
- <span data-ttu-id="d91e4-244">searchfolder</span><span class="sxs-lookup"><span data-stu-id="d91e4-244">searchfolder</span></span>
- <span data-ttu-id="d91e4-245">工作 (task)</span><span class="sxs-lookup"><span data-stu-id="d91e4-245">task</span></span>
- <span data-ttu-id="d91e4-246">影片</span><span class="sxs-lookup"><span data-stu-id="d91e4-246">video</span></span>
- <span data-ttu-id="d91e4-247">webhistory</span><span class="sxs-lookup"><span data-stu-id="d91e4-247">webhistory</span></span>
- <span data-ttu-id="d91e4-248">item</span><span class="sxs-lookup"><span data-stu-id="d91e4-248">item</span></span>
- <span data-ttu-id="d91e4-249">其他</span><span class="sxs-lookup"><span data-stu-id="d91e4-249">other</span></span>

### <a name="conditions-element"></a><span data-ttu-id="d91e4-250">\<conditions> 項目</span><span class="sxs-lookup"><span data-stu-id="d91e4-250">\<conditions> Element</span></span>

<span data-ttu-id="d91e4-251">條件是用於比較搜尋結果的篩選準則。</span><span class="sxs-lookup"><span data-stu-id="d91e4-251">Conditions are filters against which search results are compared.</span></span> <span data-ttu-id="d91e4-252">例如，您可以篩選符合特定準則的結果，例如作者名稱或檔案大小。</span><span class="sxs-lookup"><span data-stu-id="d91e4-252">For example, you can filter results that meet certain criteria, like author name or file size.</span></span> <span data-ttu-id="d91e4-253">條件集內建在具有邏輯 AND、OR 和 NOT 分支的單一條件樹狀結構中。</span><span class="sxs-lookup"><span data-stu-id="d91e4-253">The set of conditions are built into a single condition tree with logical AND, OR and NOT branches.</span></span>

<span data-ttu-id="d91e4-254">下列範例顯示元素的結構 \<condition> 。</span><span class="sxs-lookup"><span data-stu-id="d91e4-254">The following example shows the structure of the \<condition> element.</span></span>

```XML
...
    <query>
        ...
        <conditions>
            <condition type="" ...>
                <attributes>
                    <attribute attributeID="" .../>
                </attributes>
            </condition>
        </conditions>
    </query>
...
```

<span data-ttu-id="d91e4-255">條件類型可以是下列其中一項：</span><span class="sxs-lookup"><span data-stu-id="d91e4-255">The condition type can be one of the following:</span></span>

| <span data-ttu-id="d91e4-256">類型</span><span class="sxs-lookup"><span data-stu-id="d91e4-256">Type</span></span>          | <span data-ttu-id="d91e4-257">Description</span><span class="sxs-lookup"><span data-stu-id="d91e4-257">Description</span></span>                                 | <span data-ttu-id="d91e4-258">可用的屬性</span><span class="sxs-lookup"><span data-stu-id="d91e4-258">Available Attributes</span></span>                               |
|---------------|---------------------------------------------|----------------------------------------------------|
| <span data-ttu-id="d91e4-259">Microsoft.visualstudio.testtools.uitest.extension.andcondition.match</span><span class="sxs-lookup"><span data-stu-id="d91e4-259">andCondition</span></span>  | <span data-ttu-id="d91e4-260">結合兩個或多個子條件</span><span class="sxs-lookup"><span data-stu-id="d91e4-260">Conjunction of two or more child conditions</span></span> | <span data-ttu-id="d91e4-261">n/a</span><span class="sxs-lookup"><span data-stu-id="d91e4-261">n/a</span></span>                                                |
| <span data-ttu-id="d91e4-262">orCondition</span><span class="sxs-lookup"><span data-stu-id="d91e4-262">orCondition</span></span>   | <span data-ttu-id="d91e4-263">分離兩個以上的子條件</span><span class="sxs-lookup"><span data-stu-id="d91e4-263">Disjunction of two of more child conditions</span></span> | <span data-ttu-id="d91e4-264">n/a</span><span class="sxs-lookup"><span data-stu-id="d91e4-264">n/a</span></span>                                                |
| <span data-ttu-id="d91e4-265">notCondition</span><span class="sxs-lookup"><span data-stu-id="d91e4-265">notCondition</span></span>  | <span data-ttu-id="d91e4-266">子條件的否定</span><span class="sxs-lookup"><span data-stu-id="d91e4-266">Negation of a child condition</span></span>               | <span data-ttu-id="d91e4-267">n/a</span><span class="sxs-lookup"><span data-stu-id="d91e4-267">n/a</span></span>                                                |
| <span data-ttu-id="d91e4-268">leafCondition</span><span class="sxs-lookup"><span data-stu-id="d91e4-268">leafCondition</span></span> | <span data-ttu-id="d91e4-269">比較屬性與值</span><span class="sxs-lookup"><span data-stu-id="d91e4-269">Compares a property to value</span></span>                | <span data-ttu-id="d91e4-270">property、propertyType、operator、value、valuetype</span><span class="sxs-lookup"><span data-stu-id="d91e4-270">property, propertyType, operator, value, valuetype</span></span> |

<span data-ttu-id="d91e4-271">專案 \<leafCondition> 的屬性會識別要篩選結果的屬性和值。</span><span class="sxs-lookup"><span data-stu-id="d91e4-271">The \<leafCondition> element's attributes identify the properties and values the results are filtered against.</span></span>

### <a name="example-conditions-element"></a><span data-ttu-id="d91e4-272">範例： \<conditions> 元素</span><span class="sxs-lookup"><span data-stu-id="d91e4-272">Example: \<conditions> Element</span></span>

<span data-ttu-id="d91e4-273">下列範例會針對 John 撰寫的所有未讀取專案篩選結果。</span><span class="sxs-lookup"><span data-stu-id="d91e4-273">The following example filters results for all unread items authored by John.</span></span> <span data-ttu-id="d91e4-274">也就是說，IsRead 屬性是 false，而字串 "john" 則出現在 Author 或 ItemAuthors 屬性中。</span><span class="sxs-lookup"><span data-stu-id="d91e4-274">That is, the System.IsRead property is false and the string "john" appears in the System.Author or System.ItemAuthors properties.</span></span>

```XML
...
    <query>
        ...
        <conditions>

            <condition type="andCondition">

                <condition type="leafCondition"
                           property="System.IsRead"
                           operator="eq"
                           value="FALSE"/>

                <condition type="orCondition">

                    <condition type="leafCondition"
                               property="System.Author"
                               propertyType="string"
                               operator="wordmatch"
                               value="John"
                               valueType="System.StructuredQueryType.String"/>

                    <condition type="leafCondition"
                               property="System.ItemAuthors"
                               propertyType="string"
                               operator="wordmatch"
                               value="John"
                               valueType="System.StructuredQueryType.String"/>

                </condition>

            </condition>

        </conditions>

    </query>
...
```

## <a name="properties-element"></a><span data-ttu-id="d91e4-275">\<properties> 項目</span><span class="sxs-lookup"><span data-stu-id="d91e4-275">\<properties> Element</span></span>

<span data-ttu-id="d91e4-276">\<properties>元素會描述已儲存之搜尋本身的屬性。</span><span class="sxs-lookup"><span data-stu-id="d91e4-276">The \<properties> element describes the properties of the saved search itself.</span></span> <span data-ttu-id="d91e4-277">儲存的搜尋檔案支援四個屬性： \<author> 、 \<kind> 、 \<description> 和 \<tags> 。</span><span class="sxs-lookup"><span data-stu-id="d91e4-277">Saved search files support four properties: \<author>, \<kind>, \<description>, and \<tags>.</span></span> <span data-ttu-id="d91e4-278">這些僅供內部使用。</span><span class="sxs-lookup"><span data-stu-id="d91e4-278">These are for internal use only.</span></span>

## <a name="full-specification-of-the-search-ms-file-format"></a><span data-ttu-id="d91e4-279">搜尋-ms 檔案格式的完整規格</span><span class="sxs-lookup"><span data-stu-id="d91e4-279">Full Specification of the search-ms File Format</span></span>

<span data-ttu-id="d91e4-280">以下是已儲存搜尋檔案的完整 XML 範例。</span><span class="sxs-lookup"><span data-stu-id="d91e4-280">The following is an example of the full XML for a saved search file.</span></span>

```XML
<?xml version="1.0"?>

<persistedQuery version="1.0">

    <!-- The viewInfo section defines how results are displayed to the end user -->
    <viewInfo viewMode=""       <!-- details | icons | tiles -->
              iconSize=""       <!-- Integer -->
              stackIconSize=""  <!-- Do not use -->
              displayName=""    <!-- Do not use -->
              folderFlags=""    <!-- Do not use -->
              taskFlags=""      <!-- Do not use -->
              autoListFlags=""> <!-- Do not use -->

        <visibleColumns>
            <column viewField=""/>  <!-- System.[propertyname] -->
        </visibleColumns>

        <frequentlyUsedColumns>
            <column viewField= ""/> <!-- Do not use -->
        </frequentlyUsedColumns>

        <columnChooserColumns >
            <column viewField=""/>  <!-- Do not use -->
        </columnChooserColumns >

        <groupBy viewField=""       <!-- System.[propertyname] -->
                 direction=""/>     <!-- ascending | descending -->

        <stackList>
            <stack viewField=""/>   <!-- Do not use -->
        </stackList>

        <sortList>
            <sort viewField=""      <!-- System.[propertyname] -->
                  direction=""/>    <!-- ascending | descending -->
        </sortList>
    </viewInfo>

    <!-- The query section defines what gets searched (locations, file kinds) -->
    <query>
        <providers>
            <provider clsid=""/>          <!-- Do not use -->
        </providers>

        <subQueries>
            <subQuery path=""/>           <!-- Do not use -->
            <subQuery knownSearch=""/>    <!-- Do not use -->
        </subQueries>

        <scope>
            <include path=""        nonRecursive=""/>   <!-- [path of location to include] -->
            <include knownFolder="" nonRecursive=""/>   <!-- Known folder ID  -->
            <exclude path=""        nonRecursive=""/>   <!-- [path of location to exclude] -->
            <exclude knownFolder="" nonRecursive=""/>   <!-- Known folder ID  -->
        </scope>

        <kindList>
            <kind name=""/>     <!-- Kind value -->
        </kindList>

        <conditions>
            <condition type="" ...>     <!-- andCondition | orCondition | notCondition | leafCondition -->
                <attributes>
                    <attribute attributeID="" .../> <!-- Do not use -->
                </attributes>
            </condition>
        </conditions>
    </query>

    <!-- The properties section identifies properties of the saved search file itself. -->
    <properties>
        ...             <!-- Do not use -->
    </properties>

</persistedQuery>
```

## <a name="examples-of-saved-searches"></a><span data-ttu-id="d91e4-281">已儲存搜尋的範例</span><span class="sxs-lookup"><span data-stu-id="d91e4-281">Examples of Saved Searches</span></span>

<span data-ttu-id="d91e4-282">以下是搜尋 ms 檔案的範例 \* 。</span><span class="sxs-lookup"><span data-stu-id="d91e4-282">The following are examples of \*.search-ms files.</span></span>

### <a name="recent-documentssearch-ms"></a><span data-ttu-id="d91e4-283">最近使用的檔。搜尋-ms</span><span class="sxs-lookup"><span data-stu-id="d91e4-283">Recent Documents.search-ms</span></span>

```XML
<?xml version="1.0"?>
<persistedQuery version="1.0">
    <viewInfo viewMode="details" iconSize="16">
        <sortList>
            <sort viewField="System.DateModified" direction="descending"/>
        </sortList>
    </viewInfo>

    <query>
        <conditions>
            <condition type="leafCondition" valuetype="System.StructuredQueryType.DateTime" property="System.DateModified" operator="imp" value="R00UUUUUUUUZZXD-30NU" propertyType="wstr" />
        </conditions>
        <kindList>
            <kind name="Document"/>
        </kindList>
        <subQueries>
            <subQuery knownSearch="{4f800859-0bd6-4e63-bbdc-38d3b616ca48}"/>
        </subQueries>
    </query>
</persistedQuery>
```

### <a name="recent-musicsearch-ms"></a><span data-ttu-id="d91e4-284">最近的音樂。搜尋-ms</span><span class="sxs-lookup"><span data-stu-id="d91e4-284">Recent Music.search-ms</span></span>

```XML
<?xml version="1.0"?>
<persistedQuery version="1.0">
    <viewInfo viewMode="details" iconSize="16">
        <sortList>
            <sort viewField="System.DateModified" direction="descending"/>
        </sortList>
    </viewInfo>

    <query>
        <conditions>
            <condition type="leafCondition" valuetype="System.StructuredQueryType.DateTime" property="System.DateModified" operator="imp" value="R00UUUUUUUUW-1WNNU" propertyType="wstr"/>
        </conditions>
        <kindList>
            <kind name="Music"/>
        </kindList>
        <subQueries>
            <subQuery knownSearch="{4f800859-0bd6-4e63-bbdc-38d3b616ca48}"/>
        </subQueries>
    </query>
</persistedQuery>
```

### <a name="recently-shared-by-mesearch-ms"></a><span data-ttu-id="d91e4-285">最近由我共用。搜尋-ms</span><span class="sxs-lookup"><span data-stu-id="d91e4-285">Recently Shared by Me.search-ms</span></span>

```XML
<?xml version="1.0"?>
<persistedQuery version="1.0">
    <viewInfo viewMode="details" iconSize="16">
        <visibleColumns>
            <column viewField="System.ItemNameDisplay"/>
            <column viewField="System.DateModified"/>
            <column viewField="System.Keywords"/>
            <column viewField="System.SharedWith"/>
            <column viewField="System.ItemFolderPathDisplayNarrow"/>
        </visibleColumns>
        <frequentlyUsedColumns>
            <column viewField="System.Author"/>
            <column viewField="System.Kind"/>
            <column viewField="System.Size"/>
            <column viewField="System.Title"/>
            <column viewField="System.Rating"/>
        </frequentlyUsedColumns>
        <sortList>
            <sort viewField="System.SharedWith" direction="descending"/>
        </sortList>
    </viewInfo>

    <query>
        <conditions>
            <condition type="andCondition">
                <condition type="leafCondition" property="System.IsShared" operator="eq" value="true"/>
                <condition type="leafCondition" property="System.FileOwner" operator="eq" value="[Me]"/>
            </condition>
        </conditions>
        <kindList>
            <kind name="item"/>
        </kindList>
        <scope>
            <include knownFolder="{5E6C858F-0E22-4760-9AFE-EA3317B67173}"/>
            <include knownFolder="{DFDF76A2-C82A-4D63-906A-5644AC457385}"/>
        </scope>
    </query>
</persistedQuery>
```
