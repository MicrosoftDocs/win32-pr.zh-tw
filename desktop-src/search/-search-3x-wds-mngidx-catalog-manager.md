---
description: ISearchCatalogManager 和 ISearchCatalogManager2 介面提供管理搜尋目錄的方法，例如造成重新編制索引或設定超時時間。
ms.assetid: 8dad7012-d610-4398-8e86-cd319db8c360
title: 使用目錄管理員
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 1295cc9cc76fb334b4687b876fa1959a22e33235
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/07/2021
ms.locfileid: "106971182"
---
# <a name="using-the-catalog-manager"></a><span data-ttu-id="9b808-103">使用目錄管理員</span><span class="sxs-lookup"><span data-stu-id="9b808-103">Using the Catalog Manager</span></span>

<span data-ttu-id="9b808-104">[**ISearchCatalogManager**](/windows/desktop/api/Searchapi/nn-searchapi-isearchcatalogmanager)和 [**ISearchCatalogManager2**](/windows/desktop/api/Searchapi/nn-searchapi-isearchcatalogmanager2)介面提供管理搜尋目錄的方法，例如造成重新編制索引或設定超時時間。</span><span class="sxs-lookup"><span data-stu-id="9b808-104">The [**ISearchCatalogManager**](/windows/desktop/api/Searchapi/nn-searchapi-isearchcatalogmanager) and [**ISearchCatalogManager2**](/windows/desktop/api/Searchapi/nn-searchapi-isearchcatalogmanager2) interfaces provide methods to manage a search catalog, such as causing re-indexing or setting time-outs.</span></span> <span data-ttu-id="9b808-105">雖然 Windows Search 目前只使用一個目錄，但這個介面的設計目的是要讓您以更大的控制來管理多個目錄。</span><span class="sxs-lookup"><span data-stu-id="9b808-105">While Windows Search currently uses only one catalog, this interface was designed to give you greater control for managing multiple catalogs independently.</span></span> <span data-ttu-id="9b808-106">介面會以下列方式管理目錄：</span><span class="sxs-lookup"><span data-stu-id="9b808-106">The interface manages the catalog in the following ways:</span></span>

- <span data-ttu-id="9b808-107">存取其他介面：抓取編目範圍管理員所需的其他搜尋相關介面、資料變更通知，以及 [**ISearchQueryHelper**](/windows/desktop/api/Searchapi/nn-searchapi-isearchqueryhelper) 介面。</span><span class="sxs-lookup"><span data-stu-id="9b808-107">Access to other interfaces — retrieving other search-related interfaces required by the Crawl Scope Manager, data change notifications, and the [**ISearchQueryHelper**](/windows/desktop/api/Searchapi/nn-searchapi-isearchqueryhelper) interface.</span></span>
- <span data-ttu-id="9b808-108">目錄內容：確保新的資料已編制索引，而且其他應用程式和元件可以正常運作，方法是強制重新編制所有或部分類別目錄的索引，或重設整個目錄。</span><span class="sxs-lookup"><span data-stu-id="9b808-108">Catalog contents — ensuring that new data is indexed and that other applications and components work properly by forcing a re-indexing of all or part of the catalog or by resetting the entire catalog.</span></span>
- <span data-ttu-id="9b808-109">目錄屬性：設定屬性，以決定當連接到通訊協定處理常式時，目錄如何管理時間超時，以及如何在搜尋中處理變音符號標記。</span><span class="sxs-lookup"><span data-stu-id="9b808-109">Catalog properties — setting properties that determine how the catalog manages time-outs when connecting to protocol handlers and how diacritical marks are treated in searches.</span></span>
- <span data-ttu-id="9b808-110">目錄狀態-取得目錄的相關資訊，包括狀態、大小和目前的活動狀態。</span><span class="sxs-lookup"><span data-stu-id="9b808-110">Catalog status — getting information about the catalog, including status, size, and current activity state.</span></span>

<span data-ttu-id="9b808-111">本主題的組織方式如下：</span><span class="sxs-lookup"><span data-stu-id="9b808-111">This topic is organized as follows:</span></span>

- [<span data-ttu-id="9b808-112">存取相關介面</span><span class="sxs-lookup"><span data-stu-id="9b808-112">Accessing Related Interfaces</span></span>](#accessing-related-interfaces)
- [<span data-ttu-id="9b808-113">管理目錄內容</span><span class="sxs-lookup"><span data-stu-id="9b808-113">Managing the Catalog Contents</span></span>](#managing-the-catalog-contents)
- [<span data-ttu-id="9b808-114">管理目錄狀態</span><span class="sxs-lookup"><span data-stu-id="9b808-114">Managing Catalog Status</span></span>](#managing-catalog-status)
- [<span data-ttu-id="9b808-115">管理目錄屬性</span><span class="sxs-lookup"><span data-stu-id="9b808-115">Managing Catalog Properties</span></span>](#managing-catalog-properties)
- [<span data-ttu-id="9b808-116">以提高許可權模式執行</span><span class="sxs-lookup"><span data-stu-id="9b808-116">Running in Elevated Mode</span></span>](#running-in-elevated-mode)
- [<span data-ttu-id="9b808-117">相關主題</span><span class="sxs-lookup"><span data-stu-id="9b808-117">Related topics</span></span>](#related-topics)

## <a name="accessing-related-interfaces"></a><span data-ttu-id="9b808-118">存取相關介面</span><span class="sxs-lookup"><span data-stu-id="9b808-118">Accessing Related Interfaces</span></span>

<span data-ttu-id="9b808-119">Windows Search 平臺中的某些實用介面需要目錄管理員的實例，才能使用這些介面。</span><span class="sxs-lookup"><span data-stu-id="9b808-119">Some useful interfaces in the Windows Search platform require an instance of the Catalog Manager before they can be used.</span></span> <span data-ttu-id="9b808-120">若要為指定的目錄建立目錄管理員，請呼叫 [**ISearchManager：： GetCatalog**](/windows/desktop/api/Searchapi/nf-searchapi-isearchmanager-getcatalog) 方法。</span><span class="sxs-lookup"><span data-stu-id="9b808-120">To create a Catalog Manager for a specified catalog, call the [**ISearchManager::GetCatalog**](/windows/desktop/api/Searchapi/nf-searchapi-isearchmanager-getcatalog) method.</span></span> <span data-ttu-id="9b808-121">然後，您可以使用目錄管理員的方法來具現化並傳回以指定目錄為基礎的介面。</span><span class="sxs-lookup"><span data-stu-id="9b808-121">The methods of the Catalog Manager can then be used to instantiate and return interfaces that are based on the specified catalog.</span></span>

| <span data-ttu-id="9b808-122">方法</span><span class="sxs-lookup"><span data-stu-id="9b808-122">Method</span></span>                                                                                               | <span data-ttu-id="9b808-123">描述</span><span class="sxs-lookup"><span data-stu-id="9b808-123">Description</span></span>                                                                                                                                                                                                                                                                                                                                                                        |
|------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="9b808-124">**GetQueryHelper**</span><span class="sxs-lookup"><span data-stu-id="9b808-124">**GetQueryHelper**</span></span>](/windows/desktop/api/Searchapi/nf-searchapi-isearchcatalogmanager-getqueryhelper)                               | <span data-ttu-id="9b808-125">取得目前目錄之 [**ISearchQueryHelper**](/windows/desktop/api/Searchapi/nn-searchapi-isearchqueryhelper) 介面的實例，可讓您輕鬆地建立查詢。</span><span class="sxs-lookup"><span data-stu-id="9b808-125">Gets an instance of the [**ISearchQueryHelper**](/windows/desktop/api/Searchapi/nn-searchapi-isearchqueryhelper) interface for the current catalog, to enable you to build queries easily.</span></span>                                                                                                                                                                                                                         |
| [<span data-ttu-id="9b808-126">**GetCrawlScopeManager**</span><span class="sxs-lookup"><span data-stu-id="9b808-126">**GetCrawlScopeManager**</span></span>](/windows/desktop/api/Searchapi/nf-searchapi-isearchcatalogmanager-getcrawlscopemanager)                   | <span data-ttu-id="9b808-127">取得此搜尋目錄的 [**ISearchCrawlScopeManager**](/windows/desktop/api/Searchapi/nn-searchapi-isearchcrawlscopemanager) 實例，以讓開發人員修改 Windows Search 索引子的編目範圍。</span><span class="sxs-lookup"><span data-stu-id="9b808-127">Gets an instance of [**ISearchCrawlScopeManager**](/windows/desktop/api/Searchapi/nn-searchapi-isearchcrawlscopemanager) for this search catalog, to enable developers to modify the crawl scope of the Windows Search Indexer.</span></span>                                                                                                                                                                                    |
| [<span data-ttu-id="9b808-128">**GetItemsChangedSink**</span><span class="sxs-lookup"><span data-stu-id="9b808-128">**GetItemsChangedSink**</span></span>](/windows/desktop/api/Searchapi/nf-searchapi-isearchcatalogmanager-getitemschangedsink)                     | <span data-ttu-id="9b808-129">取得 [**ISearchItemsChangedSink**](/windows/desktop/api/Searchapi/nn-searchapi-isearchitemschangedsink) 介面的實例，用戶端應用程式會在用戶端想要建立專案的索引狀態資訊以支援提供者管理的通知時，用來通知索引子的變更。</span><span class="sxs-lookup"><span data-stu-id="9b808-129">Gets an instance of the [**ISearchItemsChangedSink**](/windows/desktop/api/Searchapi/nn-searchapi-isearchitemschangedsink) interface, which client applications use to notify the indexer of changes when the client wants indexing status information about the item to support provider-managed notifications.</span></span> <span data-ttu-id="9b808-130">如需詳細資訊，請參閱 [通知索引的變更](-search-3x-wds-notifyingofchanges.md) 。</span><span class="sxs-lookup"><span data-stu-id="9b808-130">See [Notifying the Index of Changes](-search-3x-wds-notifyingofchanges.md) for more information.</span></span> |
| [<span data-ttu-id="9b808-131">**GetPersistentItemsChangedSink**</span><span class="sxs-lookup"><span data-stu-id="9b808-131">**GetPersistentItemsChangedSink**</span></span>](/windows/desktop/api/Searchapi/nf-searchapi-isearchcatalogmanager-getpersistentitemschangedsink) | <span data-ttu-id="9b808-132">取得 [**ISearchPersistentItemsChangedSink**](/windows/desktop/api/Searchapi/nn-searchapi-isearchpersistentitemschangedsink)的實例，用戶端應用程式會在用戶端不想編制索引狀態資訊 (索引子管理的通知) 時，使用此實例來通知索引子的變更。</span><span class="sxs-lookup"><span data-stu-id="9b808-132">Gets an instance of [**ISearchPersistentItemsChangedSink**](/windows/desktop/api/Searchapi/nn-searchapi-isearchpersistentitemschangedsink), which client applications use to notify the indexer of changes when the client does not want indexing status information (indexer-managed notifications).</span></span> <span data-ttu-id="9b808-133">如需詳細資訊，請參閱 [通知索引的變更](-search-3x-wds-notifyingofchanges.md) 。</span><span class="sxs-lookup"><span data-stu-id="9b808-133">See [Notifying the Index of Changes](-search-3x-wds-notifyingofchanges.md) for more information.</span></span>            |

## <a name="managing-the-catalog-contents"></a><span data-ttu-id="9b808-134">管理目錄內容</span><span class="sxs-lookup"><span data-stu-id="9b808-134">Managing the Catalog Contents</span></span>

<span data-ttu-id="9b808-135">有兩個主要工作牽涉到管理目錄：在索引子的編目範圍中重新編制所有或部分 Url 的索引，以及重設整個基礎目錄。</span><span class="sxs-lookup"><span data-stu-id="9b808-135">There are two primary tasks involved in managing the catalog: re-indexing all or some of the URLs in the indexer's crawl scope, and resetting the entire underlying catalog.</span></span> <span data-ttu-id="9b808-136">當您重新建立 Url 的索引時，舊資料會保留在目錄中，直到或取代為新資料。</span><span class="sxs-lookup"><span data-stu-id="9b808-136">When you re-index URLs, old data remains in the catalog until or unless it is replaced by new data.</span></span> <span data-ttu-id="9b808-137">當您重設類別目錄時，會重建整個目錄，並重新編制編目範圍中的所有 Url。</span><span class="sxs-lookup"><span data-stu-id="9b808-137">When you reset the catalog, the entire catalog is rebuilt and all URLs in the crawl scope are re-indexed.</span></span> <span data-ttu-id="9b808-138">此程式可能需要花費很多時間，而且只能做為解決問題（例如可能損毀的索引）的最後手段。</span><span class="sxs-lookup"><span data-stu-id="9b808-138">This process can take a lot of time and should be used only as a last resort for solving issues such as a possibly corrupted index.</span></span>

<span data-ttu-id="9b808-139">當您安裝新的應用程式、通訊協定處理常式或篩選器時，安裝應用程式應該將其目錄或根目錄新增至編目範圍，以確保索引子包含該應用程式資料的位置。</span><span class="sxs-lookup"><span data-stu-id="9b808-139">When you install a new application, protocol handler, or filter, the setup application should add its directory or root to the crawl scope to ensure that the indexer includes the location of that application's data.</span></span> <span data-ttu-id="9b808-140">如果在索引子將編目範圍編目之後，資料未出現在目錄中，您應該先確定資料的位置包含在編目範圍中。</span><span class="sxs-lookup"><span data-stu-id="9b808-140">If the data does not appear in the catalog after the indexer has crawled its crawl scope, then you should first ensure that the location of the data is included in the crawl scope.</span></span> <span data-ttu-id="9b808-141">您可以使用 Windows Search 選項或 [編目範圍管理員](-search-3x-wds-extidx-csm.md)的使用者介面來加入它。</span><span class="sxs-lookup"><span data-stu-id="9b808-141">You can add it by using the user interface for Windows Search options or the [Crawl Scope Manager](-search-3x-wds-extidx-csm.md).</span></span> <span data-ttu-id="9b808-142">如果位置似乎在編目範圍內，您可以使用 [**ISearchCatalogManager**](/windows/desktop/api/Searchapi/nn-searchapi-isearchcatalogmanager) 介面的下列方法，以手動方式在索引子的編目範圍或子集內手動強制重新編制所有 url 的索引。</span><span class="sxs-lookup"><span data-stu-id="9b808-142">If the location appears to be in the crawl scope, you can manually force a re-indexing of all URLs in the indexer's crawl scope or a subset, by using the following methods of the [**ISearchCatalogManager**](/windows/desktop/api/Searchapi/nn-searchapi-isearchcatalogmanager) interface.</span></span>

| <span data-ttu-id="9b808-143">重新編制索引方法</span><span class="sxs-lookup"><span data-stu-id="9b808-143">Re-indexing method</span></span>                                                                                                                                                                                                                | <span data-ttu-id="9b808-144">Description</span><span class="sxs-lookup"><span data-stu-id="9b808-144">Description</span></span>                                                                                                                                                                                                                                                          |
|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="9b808-145">**ISearchCatalogManager：：重新索引**</span><span class="sxs-lookup"><span data-stu-id="9b808-145">**ISearchCatalogManager::Reindex**</span></span>](/windows/desktop/api/Searchapi/nf-searchapi-isearchcatalogmanager-reindex)                                                                                                                                                   | <span data-ttu-id="9b808-146">重新索引目錄中的所有 Url。</span><span class="sxs-lookup"><span data-stu-id="9b808-146">Re-indexes all URLs in the catalog.</span></span> <span data-ttu-id="9b808-147">舊的資訊會一直保留到以新資訊取代。</span><span class="sxs-lookup"><span data-stu-id="9b808-147">The old information will remain until it is replaced by new information.</span></span>                                                                                                                                                         |
| [<span data-ttu-id="9b808-148">**ISearchCatalogManager::ReindexMatchingURLs**</span><span class="sxs-lookup"><span data-stu-id="9b808-148">**ISearchCatalogManager::ReindexMatchingURLs**</span></span>](/windows/desktop/api/Searchapi/nf-searchapi-isearchcatalogmanager-reindexmatchingurls)<br/> [<span data-ttu-id="9b808-149">**ISearchCatalogManager::ReindexSearchRoot**</span><span class="sxs-lookup"><span data-stu-id="9b808-149">**ISearchCatalogManager::ReindexSearchRoot**</span></span>](/windows/desktop/api/Searchapi/nf-searchapi-isearchcatalogmanager-reindexsearchroot)<br/> | <span data-ttu-id="9b808-150">重新編制符合模式的 Url，或從特定的根目錄開始 (例如，file:///C： \\ 資料夾 \\ Subfoldername \\) 。</span><span class="sxs-lookup"><span data-stu-id="9b808-150">Re-indexes URLs that match the pattern or start at a particular root (for example, file:///C:\\Foldername\\Subfoldername\\).</span></span> <span data-ttu-id="9b808-151">這適用于 recrawling 特定目錄中的所有專案，或具有特定副檔名的所有專案，就像安裝應用程式時一樣。</span><span class="sxs-lookup"><span data-stu-id="9b808-151">This is useful for recrawling everything in a particular directory or with a particular extension, as when an application is installed.</span></span> |
| [<span data-ttu-id="9b808-152">**PrioritizeMatchingURLs**</span><span class="sxs-lookup"><span data-stu-id="9b808-152">**PrioritizeMatchingURLs**</span></span>](/windows/desktop/api/Searchapi/nf-searchapi-isearchcatalogmanager2-prioritizematchingurls)                                                                                                                                           | <span data-ttu-id="9b808-153">指示索引子使用符合指定模式的 Url 來排列索引編制專案的優先順序，以完成其他編制索引工作。</span><span class="sxs-lookup"><span data-stu-id="9b808-153">Instructs the indexer to prioritize indexing items with URLs that match a specified pattern over completing other indexing tasks.</span></span>                                                                                                                                    |

<span data-ttu-id="9b808-154">**正在重設索引。**</span><span class="sxs-lookup"><span data-stu-id="9b808-154">**Resetting the Index.**</span></span> <span data-ttu-id="9b808-155">您可以呼叫 [**ISearchCatalogManager：： reset**](/windows/desktop/api/Searchapi/nf-searchapi-isearchcatalogmanager-reset)來重設整個索引。</span><span class="sxs-lookup"><span data-stu-id="9b808-155">You can reset the entire index with a call to [**ISearchCatalogManager::Reset**](/windows/desktop/api/Searchapi/nf-searchapi-isearchcatalogmanager-reset).</span></span> <span data-ttu-id="9b808-156">這會重設基礎目錄，方法是重建資料庫，並執行編目範圍中所有 Url 的完整索引。</span><span class="sxs-lookup"><span data-stu-id="9b808-156">This resets the underlying catalog by rebuilding the databases and performing a full index of all URLs in the crawl scope.</span></span> <span data-ttu-id="9b808-157">此程式可能需要花費很多時間，而且只能做為解決問題（例如可能損毀的索引）的最後手段。</span><span class="sxs-lookup"><span data-stu-id="9b808-157">This process can take a lot of time and should be used only as a last resort for solving issues such as a possibly corrupted index.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="9b808-158">因為這些方法可能會造成索引編制的速度變慢，所以當您嘗試找出索引或類別目錄問題時，應該謹慎使用這些方法。</span><span class="sxs-lookup"><span data-stu-id="9b808-158">Because of the slowdown in indexing that these methods can cause, they should be used carefully when you are trying to identify indexing or catalog problems.</span></span> <span data-ttu-id="9b808-159">首先，請確定已在編目範圍管理員中新增您的搜尋根目錄和範圍規則，然後確定檔案和資料夾已正確設定 FANCI 位 (檔案屬性未編制內容索引) 。</span><span class="sxs-lookup"><span data-stu-id="9b808-159">First, make sure your search roots and scope rules are added in the Crawl Scope Manager, and then make sure that the FANCI bit (File Attribute Not Content Indexed) is set properly for files and folders.</span></span> <span data-ttu-id="9b808-160">如果您已確認這些都是正確的，請先嘗試 ReindexSearchRoot，然後最後再重新編制索引。</span><span class="sxs-lookup"><span data-stu-id="9b808-160">If you have confirmed that these are correct, try ReindexSearchRoot first and Reindex last.</span></span> <span data-ttu-id="9b808-161">如果這兩項工作都沒有，請嘗試重設為最後的手段。</span><span class="sxs-lookup"><span data-stu-id="9b808-161">If neither of these work, then try Reset as a last resort.</span></span>

<span data-ttu-id="9b808-162">如需相關資訊，請參閱使用 ISearchQueryHelper 來[通知索引變更](-search-3x-wds-notifyingofchanges.md)和[查詢索引](-search-3x-wds-qryidx-searchqueryhelper.md)。</span><span class="sxs-lookup"><span data-stu-id="9b808-162">For related information, see [Notifying the Index of Changes](-search-3x-wds-notifyingofchanges.md), and [Querying the Index with ISearchQueryHelper](-search-3x-wds-qryidx-searchqueryhelper.md)</span></span>

## <a name="managing-catalog-status"></a><span data-ttu-id="9b808-163">管理目錄狀態</span><span class="sxs-lookup"><span data-stu-id="9b808-163">Managing Catalog Status</span></span>

<span data-ttu-id="9b808-164">目錄管理員可以用來取得應用程式的目錄狀態，而這些應用程式想要自訂目錄的管理方式 (例如，自訂「目錄狀態」監視應用程式) 。</span><span class="sxs-lookup"><span data-stu-id="9b808-164">The Catalog Manager can be used to get the status of the catalog for applications that want to customize how the catalog is managed (for example, a custom "Catalog Status" monitoring application).</span></span> <span data-ttu-id="9b808-165">但在大部分搜尋相關的開發案例中，通常不需要目錄管理員。</span><span class="sxs-lookup"><span data-stu-id="9b808-165">But the Catalog Manager is not typically required for most search-related development scenarios.</span></span> <span data-ttu-id="9b808-166">常見用途適用于「目錄狀態」監視應用程式或主控台樣式的應用程式。</span><span class="sxs-lookup"><span data-stu-id="9b808-166">Common uses would be for a "Catalog Status" monitoring application or a Control Panel-style application.</span></span>

<span data-ttu-id="9b808-167">下表說明用來管理目錄狀態的 ISearchCatalogManager 方法。</span><span class="sxs-lookup"><span data-stu-id="9b808-167">The following table describes the methods of ISearchCatalogManager used for managing catalog status.</span></span>

<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th><span data-ttu-id="9b808-168">方法</span><span class="sxs-lookup"><span data-stu-id="9b808-168">Method</span></span></th>
<th><span data-ttu-id="9b808-169">描述</span><span class="sxs-lookup"><span data-stu-id="9b808-169">Description</span></span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span data-ttu-id="9b808-170"><a href="/windows/desktop/api/Searchapi/nf-searchapi-isearchcatalogmanager-urlbeingindexed"><strong>URLBeingIndexed</strong></a></span><span class="sxs-lookup"><span data-stu-id="9b808-170"><a href="/windows/desktop/api/Searchapi/nf-searchapi-isearchcatalogmanager-urlbeingindexed"><strong>URLBeingIndexed</strong></a></span></span></td>
<td><span data-ttu-id="9b808-171">取得目前正在編制索引的 URL。</span><span class="sxs-lookup"><span data-stu-id="9b808-171">Gets the URL that is currently being indexed.</span></span> <span data-ttu-id="9b808-172">如果您嘗試識別索引子是否 &quot; 卡 &quot; 在某個專案上，這個方法會很有用。</span><span class="sxs-lookup"><span data-stu-id="9b808-172">This method would be useful if you were trying to identify whether the indexer was &quot;stuck&quot; on an item.</span></span></td>
</tr>
<tr class="even">
<td><span data-ttu-id="9b808-173"><a href="/windows/desktop/api/Searchapi/nf-searchapi-isearchcatalogmanager-numberofitems"><strong>NumberOfItems</strong></a></span><span class="sxs-lookup"><span data-stu-id="9b808-173"><a href="/windows/desktop/api/Searchapi/nf-searchapi-isearchcatalogmanager-numberofitems"><strong>NumberOfItems</strong></a></span></span></td>
<td><span data-ttu-id="9b808-174">取得目錄中的專案數。</span><span class="sxs-lookup"><span data-stu-id="9b808-174">Gets the number of items in the catalog.</span></span></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="9b808-175"><a href="/windows/desktop/api/Searchapi/nf-searchapi-isearchcatalogmanager-numberofitemstoindex"><strong>NumberOfItemsToIndex</strong></a></span><span class="sxs-lookup"><span data-stu-id="9b808-175"><a href="/windows/desktop/api/Searchapi/nf-searchapi-isearchcatalogmanager-numberofitemstoindex"><strong>NumberOfItemsToIndex</strong></a></span></span></td>
<td><span data-ttu-id="9b808-176">抓取下列有關要編制索引之專案的資訊：</span><span class="sxs-lookup"><span data-stu-id="9b808-176">Retrieves the following information about items to be indexed:</span></span>
<ul>
<li><span data-ttu-id="9b808-177">plIncrementalCount-要在下一個增量索引中編制索引的專案數</span><span class="sxs-lookup"><span data-stu-id="9b808-177">plIncrementalCount - the number of items to be indexed in the next incremental index</span></span></li>
<li><span data-ttu-id="9b808-178">plNotificationQueue-通知佇列中的專案數。</span><span class="sxs-lookup"><span data-stu-id="9b808-178">plNotificationQueue - the number of items in the notification queue.</span></span> <span data-ttu-id="9b808-179">這項資訊對於需要檢查索引子是否接收應用程式傳送通知的通知應用程式很有用。</span><span class="sxs-lookup"><span data-stu-id="9b808-179">This information would be useful to a notification application that needed to check whether the indexer is receiving the notifications that the application is sending.</span></span></li>
<li><span data-ttu-id="9b808-180">plHighPriorityQueue-高優先順序佇列中的專案數。</span><span class="sxs-lookup"><span data-stu-id="9b808-180">plHighPriorityQueue - the number of items in the high-priority queue.</span></span> <span data-ttu-id="9b808-181">系統會先編制 plHighPriorityQueue 中的專案的索引。</span><span class="sxs-lookup"><span data-stu-id="9b808-181">Items in the plHighPriorityQueue are indexed first.</span></span></li>
</ul></td>
</tr>
<tr class="even">
<td><span data-ttu-id="9b808-182"><a href="/windows/desktop/api/Searchapi/nf-searchapi-isearchcatalogmanager-getcatalogstatus"><strong>GetCatalogStatus</strong></a></span><span class="sxs-lookup"><span data-stu-id="9b808-182"><a href="/windows/desktop/api/Searchapi/nf-searchapi-isearchcatalogmanager-getcatalogstatus"><strong>GetCatalogStatus</strong></a></span></span></td>
<td><span data-ttu-id="9b808-183">取得目錄的狀態，並傳回可提供目前狀態的列舉值。</span><span class="sxs-lookup"><span data-stu-id="9b808-183">Gets the status of the catalog and returns an enumeration value that gives the current status.</span></span> <span data-ttu-id="9b808-184">以下是可能的目錄狀態：</span><span class="sxs-lookup"><span data-stu-id="9b808-184">The following are possible catalog states:</span></span>
<ul>
<li><span data-ttu-id="9b808-185">閒置：不需要任何索引。</span><span class="sxs-lookup"><span data-stu-id="9b808-185">Idle: No indexing is needed.</span></span></li>
<li><span data-ttu-id="9b808-186">已暫停：索引會因電池電力偏低或高 CPU 使用量而暫停 (，例如) 。</span><span class="sxs-lookup"><span data-stu-id="9b808-186">Paused: Indexing is paused (due to low battery or high CPU usage, for example).</span></span></li>
<li><span data-ttu-id="9b808-187">正在復原：正在復原索引。</span><span class="sxs-lookup"><span data-stu-id="9b808-187">Recovering: Indexing is recovering.</span></span></li>
<li><span data-ttu-id="9b808-188">完整編目：索引子正在執行爬網範圍的完整編目。</span><span class="sxs-lookup"><span data-stu-id="9b808-188">Full crawl: Indexer is performing a full crawl of the crawl scope.</span></span></li>
<li><span data-ttu-id="9b808-189">增量編目：索引子正在執行增量編目。</span><span class="sxs-lookup"><span data-stu-id="9b808-189">Incremental crawl: Indexer is performing an incremental crawl.</span></span></li>
<li><span data-ttu-id="9b808-190">處理通知：索引子正在處理通知。</span><span class="sxs-lookup"><span data-stu-id="9b808-190">Processing notifications: Indexer is processing notifications.</span></span></li>
<li><span data-ttu-id="9b808-191">正在關閉：索引子正在關閉。</span><span class="sxs-lookup"><span data-stu-id="9b808-191">Shutting down: Indexer is shutting down.</span></span></li>
</ul></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="9b808-192"><a href="/windows/desktop/api/Searchapi/nf-searchapi-isearchcatalogmanager-get_name"><strong>get_Name</strong></a></span><span class="sxs-lookup"><span data-stu-id="9b808-192"><a href="/windows/desktop/api/Searchapi/nf-searchapi-isearchcatalogmanager-get_name"><strong>get_Name</strong></a></span></span></td>
<td><span data-ttu-id="9b808-193">取得 <a href="/windows/desktop/api/Searchapi/nf-searchapi-isearchmanager-getcatalog"><strong>ISearchManager：： GetCatalog</strong></a> 方法中指定的目前目錄名稱。</span><span class="sxs-lookup"><span data-stu-id="9b808-193">Gets the name of the current catalog that is specified in the <a href="/windows/desktop/api/Searchapi/nf-searchapi-isearchmanager-getcatalog"><strong>ISearchManager::GetCatalog</strong></a> method.</span></span> <span data-ttu-id="9b808-194">目前唯一支援的目錄是 SystemIndex。</span><span class="sxs-lookup"><span data-stu-id="9b808-194">Currently, the only catalog supported is SystemIndex.</span></span></td>
</tr>
</tbody>
</table>

## <a name="managing-catalog-properties"></a><span data-ttu-id="9b808-195">管理目錄屬性</span><span class="sxs-lookup"><span data-stu-id="9b808-195">Managing Catalog Properties</span></span>

<span data-ttu-id="9b808-196">您可以使用目錄管理員來管理三個目錄屬性：</span><span class="sxs-lookup"><span data-stu-id="9b808-196">There are three catalog properties that you can manage with the Catalog Manager:</span></span>

- <span data-ttu-id="9b808-197">**區分變音符號。**</span><span class="sxs-lookup"><span data-stu-id="9b808-197">**Diacritic sensitivity.**</span></span> <span data-ttu-id="9b808-198">文字標記是新增至字母的重音符號，以表示單字的意義或發音。</span><span class="sxs-lookup"><span data-stu-id="9b808-198">Diacritics are accent marks added to letters to signify a word's meaning or pronunciation.</span></span> <span data-ttu-id="9b808-199">這個屬性會決定目錄是否區分文字元號，而且在您或您的使用者搜尋和編制多種語言的文字索引時很重要。</span><span class="sxs-lookup"><span data-stu-id="9b808-199">This property determines whether the catalog is sensitive to diacritics, and is important when you or your users search and index text in multiple languages.</span></span> <span data-ttu-id="9b808-200">例如，將此屬性設定為 **FALSE** 時，目錄會將 "resume" 和 "resumé" 視為相同的單字。</span><span class="sxs-lookup"><span data-stu-id="9b808-200">For example, with this property set to **FALSE**, the catalog would treat "resume" and "resumé" as if they were the same word.</span></span>
- <span data-ttu-id="9b808-201">**連接逾時。**</span><span class="sxs-lookup"><span data-stu-id="9b808-201">**Connection timeouts.**</span></span> <span data-ttu-id="9b808-202">此屬性代表等待伺服器或資料存放區之連接回應的時間量，以 [**TIMEOUT \_ 資訊**](/windows/desktop/api/Searchapi/ns-searchapi-timeout_info) 結構表示。</span><span class="sxs-lookup"><span data-stu-id="9b808-202">This property represents the amount of time to wait for a connection response from a server or data store, as represented in a [**TIMEOUT\_INFO**](/windows/desktop/api/Searchapi/ns-searchapi-timeout_info) structure.</span></span> <span data-ttu-id="9b808-203">您可以使用這個屬性來微調 Windows Search。</span><span class="sxs-lookup"><span data-stu-id="9b808-203">You can use this property to fine tune Windows Search.</span></span>
- <span data-ttu-id="9b808-204">**資料超時** 這個屬性工作表示等候索引子和通訊協定處理常式或篩選之間的資料交易所需的時間量（以 [**TIMEOUT \_ 資訊**](/windows/desktop/api/Searchapi/ns-searchapi-timeout_info) 結構表示）。</span><span class="sxs-lookup"><span data-stu-id="9b808-204">**Data timeouts** This property represents the amount of time to wait for a data transaction between the indexer and a protocol handler or filter, as represented in a [**TIMEOUT\_INFO**](/windows/desktop/api/Searchapi/ns-searchapi-timeout_info) structure.</span></span> <span data-ttu-id="9b808-205">如果經過這段時間，就會終止篩選背景程式的進程，以防止鎖死和其他資源問題。</span><span class="sxs-lookup"><span data-stu-id="9b808-205">If this time has elapsed, the process from the Filter Daemon is terminated to prevent deadlock and other resource problems.</span></span>

<span data-ttu-id="9b808-206">最後兩個屬性主要用於未來用途。</span><span class="sxs-lookup"><span data-stu-id="9b808-206">The last two properties are intended primarily for future use.</span></span> <span data-ttu-id="9b808-207">每個屬性都有 `get` 和 `put` 方法。</span><span class="sxs-lookup"><span data-stu-id="9b808-207">Each of these properties has `get` and `put` methods.</span></span>

| <span data-ttu-id="9b808-208">方法</span><span class="sxs-lookup"><span data-stu-id="9b808-208">Method</span></span>                                                                                                                                                                                                          | <span data-ttu-id="9b808-209">描述</span><span class="sxs-lookup"><span data-stu-id="9b808-209">Description</span></span>                                                                                                                                                                                                                                     |
|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="9b808-210">[**取得 \_ DiacriticSensitivity**](/windows/desktop/api/Searchapi/nf-searchapi-isearchcatalogmanager-get_diacriticsensitivity) /</span><span class="sxs-lookup"><span data-stu-id="9b808-210">[**get\_DiacriticSensitivity**](/windows/desktop/api/Searchapi/nf-searchapi-isearchcatalogmanager-get_diacriticsensitivity) /</span></span><br/> [<span data-ttu-id="9b808-211">**put \_ DiacriticSensitivity**</span><span class="sxs-lookup"><span data-stu-id="9b808-211">**put\_DiacriticSensitivity**</span></span>](/windows/desktop/api/Searchapi/nf-searchapi-isearchcatalogmanager-put_diacriticsensitivity)<br/> | <span data-ttu-id="9b808-212">如果目錄應以變音符號來區分單字，則為 TRUE。</span><span class="sxs-lookup"><span data-stu-id="9b808-212">TRUE if the catalog should differentiate words with diacritics.</span></span> <span data-ttu-id="9b808-213">如果目錄應該忽略變音符號，則 **為 FALSE** 。</span><span class="sxs-lookup"><span data-stu-id="9b808-213">**FALSE** if the catalog should ignore diacritics.</span></span> <span data-ttu-id="9b808-214">變更此屬性需要重建索引，因為索引的索引鍵可能會變成無效。</span><span class="sxs-lookup"><span data-stu-id="9b808-214">Changing this property requires rebuilding the index because the keys of the index may become invalid.</span></span>                       |
| <span data-ttu-id="9b808-215">[**取得 \_ ConnectTimeout**](/windows/desktop/api/Searchapi/nf-searchapi-isearchcatalogmanager-get_connecttimeout) /</span><span class="sxs-lookup"><span data-stu-id="9b808-215">[**get\_ConnectTimeout**](/windows/desktop/api/Searchapi/nf-searchapi-isearchcatalogmanager-get_connecttimeout) /</span></span><br/> [<span data-ttu-id="9b808-216">**put \_ ConnectTimeout**</span><span class="sxs-lookup"><span data-stu-id="9b808-216">**put\_ConnectTimeout**</span></span>](/windows/desktop/api/Searchapi/nf-searchapi-isearchcatalogmanager-put_connecttimeout)<br/>                         | <span data-ttu-id="9b808-217">索引子應該等待伺服器或資料存放區之連接回應的時間（以秒為單位）。</span><span class="sxs-lookup"><span data-stu-id="9b808-217">The time, in seconds, that the indexer should wait for a connection response from a server or data store.</span></span> <span data-ttu-id="9b808-218">如果有許多網站沒有回應，設定過高可能會導致延遲。</span><span class="sxs-lookup"><span data-stu-id="9b808-218">Setting this too high can cause delays if many sites are unresponsive.</span></span> <span data-ttu-id="9b808-219">設定過低可能會導致某些網站未進行編目。</span><span class="sxs-lookup"><span data-stu-id="9b808-219">Setting it too low can result in some sites not being crawled.</span></span> |
| <span data-ttu-id="9b808-220">[**取得 \_ DataTimeout**](/windows/desktop/api/Searchapi/nf-searchapi-isearchcatalogmanager-get_datatimeout) /</span><span class="sxs-lookup"><span data-stu-id="9b808-220">[**get\_DataTimeout**](/windows/desktop/api/Searchapi/nf-searchapi-isearchcatalogmanager-get_datatimeout) /</span></span><br/> [<span data-ttu-id="9b808-221">**put \_ DataTimeout**</span><span class="sxs-lookup"><span data-stu-id="9b808-221">**put\_DataTimeout**</span></span>](/windows/desktop/api/Searchapi/nf-searchapi-isearchcatalogmanager-put_datatimeout)<br/>                                     | <span data-ttu-id="9b808-222">索引子應該等候資料交易的時間（以秒為單位）。</span><span class="sxs-lookup"><span data-stu-id="9b808-222">The time, in seconds, that the indexer should wait for a data transaction.</span></span>                                                                                                                                                                      |

## <a name="running-in-elevated-mode"></a><span data-ttu-id="9b808-223">以提高許可權模式執行</span><span class="sxs-lookup"><span data-stu-id="9b808-223">Running in Elevated Mode</span></span>

<span data-ttu-id="9b808-224">更新 SystemIndex 的任何方法呼叫都需要提高許可權執行您的應用程式。</span><span class="sxs-lookup"><span data-stu-id="9b808-224">Any method calls that update the SystemIndex require your application to be run elevated.</span></span> <span data-ttu-id="9b808-225">否則，您的應用程式將會失敗，並出現「拒絕存取」錯誤。</span><span class="sxs-lookup"><span data-stu-id="9b808-225">Otherwise, your application will fail with an Access Denied error.</span></span>

## <a name="related-topics"></a><span data-ttu-id="9b808-226">相關主題</span><span class="sxs-lookup"><span data-stu-id="9b808-226">Related topics</span></span>


[<span data-ttu-id="9b808-227">管理索引</span><span class="sxs-lookup"><span data-stu-id="9b808-227">Managing the Index</span></span>](-search-3x-wds-mngidx-overview.md)

[<span data-ttu-id="9b808-228">用於管理索引的介面</span><span class="sxs-lookup"><span data-stu-id="9b808-228">Interfaces for Managing the Index</span></span>](interfaces-for-managing-the-index.md)

[<span data-ttu-id="9b808-229">使用搜尋管理員</span><span class="sxs-lookup"><span data-stu-id="9b808-229">Using the Search Manager</span></span>](-search-3x-wds-mngidx-searchmanager.md)

[<span data-ttu-id="9b808-230">使用編目範圍管理員</span><span class="sxs-lookup"><span data-stu-id="9b808-230">Using the Crawl Scope Manager</span></span>](-search-3x-wds-extidx-csm.md)
