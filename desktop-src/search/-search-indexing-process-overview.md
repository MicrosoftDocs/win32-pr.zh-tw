---
description: 本主題說明索引編制程式的三個階段，以及每個階段中牽涉到的主要元件、說明索引編制活動的時間，並為想要為其資料存放區或檔案格式編制索引的協力廠商開發人員提供一些附注。
ms.assetid: cfba12eb-4123-4b57-8311-d4fc8f9f514e
title: Windows Search 中的編制索引進程
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b819a056b9a3dd44ea799ee56ae6b2e87606f552
ms.sourcegitcommit: b32433cc0394159c7263809ae67615ab5792d40d
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 06/30/2021
ms.locfileid: "113119533"
---
# <a name="indexing-process-in-windows-search"></a><span data-ttu-id="b7630-103">Windows Search 中的編制索引進程</span><span class="sxs-lookup"><span data-stu-id="b7630-103">Indexing Process in Windows Search</span></span>

<span data-ttu-id="b7630-104">本主題說明索引編制程式的三個階段，以及每個階段中牽涉到的主要元件、說明索引編制活動的時間，並為想要為其資料存放區或檔案格式編制索引的協力廠商開發人員提供一些附注。</span><span class="sxs-lookup"><span data-stu-id="b7630-104">This topic describes the three stages of the indexing process and the primary components involved in each, explains the timing of indexing activity, and provides some notes for third-party developers who want their data stores or file formats indexed.</span></span>

<span data-ttu-id="b7630-105">本主題的組織方式如下：</span><span class="sxs-lookup"><span data-stu-id="b7630-105">This topic is organized as follows:</span></span>

- [<span data-ttu-id="b7630-106">概觀</span><span class="sxs-lookup"><span data-stu-id="b7630-106">Overview</span></span>](#overview)
- [<span data-ttu-id="b7630-107">階段1：佇列 Url 以進行索引</span><span class="sxs-lookup"><span data-stu-id="b7630-107">Stage 1: Queuing URLs for Indexing</span></span>](#stage-1-queuing-urls-for-indexing)
- [<span data-ttu-id="b7630-108">階段2：爬網 Url</span><span class="sxs-lookup"><span data-stu-id="b7630-108">Stage 2: Crawling URLs</span></span>](#stage-2-crawling-urls)
- [<span data-ttu-id="b7630-109">階段3：更新索引</span><span class="sxs-lookup"><span data-stu-id="b7630-109">Stage 3: Updating the Index</span></span>](#stage-3-updating-the-index)
- [<span data-ttu-id="b7630-110">如何排程編制索引</span><span class="sxs-lookup"><span data-stu-id="b7630-110">How Indexing is Scheduled</span></span>](#how-indexing-is-scheduled)
- [<span data-ttu-id="b7630-111">給實施者的注意事項</span><span class="sxs-lookup"><span data-stu-id="b7630-111">Notes to Implementers</span></span>](#notes-to-implementers)
- [<span data-ttu-id="b7630-112">相關主題</span><span class="sxs-lookup"><span data-stu-id="b7630-112">Related topics</span></span>](#related-topics)

## <a name="overview"></a><span data-ttu-id="b7630-113">概觀</span><span class="sxs-lookup"><span data-stu-id="b7630-113">Overview</span></span>

<span data-ttu-id="b7630-114">Windows Search 支援從不同檔案格式的檔案編制屬性和內容的索引，例如 .doc 或 jpeg 格式，以及資料存放區，例如檔案系統或 Windows Outlook 信箱。</span><span class="sxs-lookup"><span data-stu-id="b7630-114">Windows Search supports the indexing of properties and content from files of different file formats, such as .doc or .jpeg formats, and data stores, such as the file system or Windows Outlook mailboxes.</span></span> <span data-ttu-id="b7630-115">有兩種類型的索引：值索引，允許依屬性的整個值進行篩選和排序，以及將文字屬性或內容中的單字編制為索引的反向索引。</span><span class="sxs-lookup"><span data-stu-id="b7630-115">There are two kinds of indices: value indices that allow filtering and sorting by the whole value of a property and inverted indices that index words within textual properties or content.</span></span> <span data-ttu-id="b7630-116">如果您有自訂的檔案格式或資料存放區，您必須瞭解 Windows Search 索引，才能讓您的專案正確編制索引。</span><span class="sxs-lookup"><span data-stu-id="b7630-116">If you have a custom file format or data store, you need to understand how Windows Search indexes in order to get your items indexed correctly.</span></span>

<span data-ttu-id="b7630-117">索引程式是由稱為「收集器」 Windows Search 元件所控制的三個階段進行。</span><span class="sxs-lookup"><span data-stu-id="b7630-117">The indexing process happens in three stages controlled by a Windows Search component called the gatherer.</span></span> <span data-ttu-id="b7630-118">在第一個階段中，收集會將 Url 新增至佇列。</span><span class="sxs-lookup"><span data-stu-id="b7630-118">In the first stage, the gatherer adds URLs to queues.</span></span> <span data-ttu-id="b7630-119">這些 Url 會識別要編制索引的專案，而佇列只是 Url 的優先順序清單。</span><span class="sxs-lookup"><span data-stu-id="b7630-119">The URLs identify items to be indexed, and the queues are merely prioritized lists of URLs.</span></span> <span data-ttu-id="b7630-120">在第二個階段中，收集程式會協調其他 Windows Search 和協力廠商元件，以存取專案並收集這些專案的相關資料。</span><span class="sxs-lookup"><span data-stu-id="b7630-120">In the second stage, the gatherer coordinates other Windows Search and third-party components to access the items and collect data about them.</span></span> <span data-ttu-id="b7630-121">最後，在第三個階段中，收集的資料會新增至索引。</span><span class="sxs-lookup"><span data-stu-id="b7630-121">Finally, in the third stage, the data collected is added to the index.</span></span>

<span data-ttu-id="b7630-122">下圖顯示透過索引編制程式的主要元件和資料流程。</span><span class="sxs-lookup"><span data-stu-id="b7630-122">The following diagram shows the principal components and flow of data through the indexing process.</span></span> <span data-ttu-id="b7630-123">收集索引的資料時涉及許多元件。</span><span class="sxs-lookup"><span data-stu-id="b7630-123">A number of components are involved in collecting data for the index.</span></span> <span data-ttu-id="b7630-124">其中有些是 Windows Search 的一部分，有些則來自協力廠商應用程式。</span><span class="sxs-lookup"><span data-stu-id="b7630-124">Some of these are a part of Windows Search, and some come from third-party applications.</span></span> <span data-ttu-id="b7630-125">如果您有自訂資料存放區或檔案格式，Windows Search 會依賴您的通訊協定處理常式，並篩選以存取 Url 和發出屬性來編制索引。</span><span class="sxs-lookup"><span data-stu-id="b7630-125">If you have a custom data store or file format, Windows Search relies on your protocol handler and filter for accessing URLs and emitting properties for indexing.</span></span> <span data-ttu-id="b7630-126">Windows Search 元件會以藍色顯示，而協力廠商元件會以綠色顯示。</span><span class="sxs-lookup"><span data-stu-id="b7630-126">Windows Search components are shown in blue, and third-party components are shown in green.</span></span>

![顯示在編制索引過程中元件之間互動的圖表](images/indexingcompoverview.jpg)

## <a name="stage-1-queuing-urls-for-indexing"></a><span data-ttu-id="b7630-128">階段1：佇列 Url 以進行索引</span><span class="sxs-lookup"><span data-stu-id="b7630-128">Stage 1: Queuing URLs for Indexing</span></span>

<span data-ttu-id="b7630-129">在索引的第一個階段中，收集程式會收集資料存放區更新的相關資訊、將該資訊與已知的編目範圍進行比較，然後建立要進行往返的 Url 佇列以收集索引的資料。</span><span class="sxs-lookup"><span data-stu-id="b7630-129">In the first stage of indexing, the gatherer collects information about updates to data stores, compares that information to the known crawl scope, and then builds a queue of URLs to traverse to collect data for the index.</span></span> <span data-ttu-id="b7630-130">對於不是以通知為基礎的來源（例如 FAT 磁片磁碟機），收集程式會定期起始編目範圍的完整遍歷，讓索引中的資料保持在最新狀態。</span><span class="sxs-lookup"><span data-stu-id="b7630-130">For sources that are not based on notification, such as FAT drives, the gatherer periodically initiates a full traversal of the crawl scope so that the data in the index is kept fresh.</span></span> <span data-ttu-id="b7630-131">針對 NTFS 之類的來源，只有單一編目，而其他專案則是由 [USN 變更日誌](/windows/desktop/FileIO/change-journals)中的通知處理。</span><span class="sxs-lookup"><span data-stu-id="b7630-131">For sources such as NTFS, there is only a single crawl and everything else is handled by notifications from the [USN Change Journal](/windows/desktop/FileIO/change-journals).</span></span> <span data-ttu-id="b7630-132">也不會有 Microsoft Outlook 的爬網。</span><span class="sxs-lookup"><span data-stu-id="b7630-132">There is also no crawl of Microsoft Outlook.</span></span> <span data-ttu-id="b7630-133">下圖顯示非編目索引之佇列進程的高階觀點。</span><span class="sxs-lookup"><span data-stu-id="b7630-133">The following diagram shows a high-level view of the queuing process for non-crawl indexing.</span></span>

![顯示非編目索引之查詢程式的圖表](images/queuingurls.jpg)

<span data-ttu-id="b7630-135">本節的其餘部分將說明 Windows Search 如何判斷要編目的 Url，並在過程中定義一些重要的詞彙。</span><span class="sxs-lookup"><span data-stu-id="b7630-135">The rest of this section explains how Windows Search determines what URLs to crawl, and defines some important terms along the way.</span></span>

<span data-ttu-id="b7630-136">編目 **範圍** 編目範圍是一組 Url，Windows Search 進行收集，以收集使用者想要編制索引以加快搜尋速度的專案相關資料。</span><span class="sxs-lookup"><span data-stu-id="b7630-136">**Crawl Scope**  The crawl scope is a set of URLs that Windows Search traverses to collect data about items that the user wants indexed for faster searches.</span></span> <span data-ttu-id="b7630-137">Windows Search 預設會將某些 Url 新增至編目範圍，例如使用者的 [ **檔** ] 和 [ **圖片** ] 資料夾的路徑。</span><span class="sxs-lookup"><span data-stu-id="b7630-137">Windows Search adds some URLs to the crawl scope by default, like paths to users' **Documents** and **Pictures** folders.</span></span> <span data-ttu-id="b7630-138">其他 Url 可由協力廠商應用程式、使用者和群組原則新增。</span><span class="sxs-lookup"><span data-stu-id="b7630-138">Other URLs can be added by third-party applications, users, and Group Policy.</span></span> <span data-ttu-id="b7630-139">最後，使用者和群組原則都可以明確地排除 Url。</span><span class="sxs-lookup"><span data-stu-id="b7630-139">Finally, both users and Group Policy can explicitly exclude URLs.</span></span> <span data-ttu-id="b7630-140">Windows Search 會取得所有新增的 Url，並移除排除的 Url 來判斷編目範圍。</span><span class="sxs-lookup"><span data-stu-id="b7630-140">Windows Search takes all the added URLs and removes the excluded URLs to determine the crawl scope.</span></span> <span data-ttu-id="b7630-141">這是收集程式開始其工作的一組工作 Url。</span><span class="sxs-lookup"><span data-stu-id="b7630-141">This is the working set of URLs from which the gatherer begins its work.</span></span>

<span data-ttu-id="b7630-142">**收集**  收集器是一種 Windows Search 元件，可收集編目範圍內的 Url 相關資訊，並為索引子建立 Url 的佇列以進行編目。</span><span class="sxs-lookup"><span data-stu-id="b7630-142">**Gatherer**  The gatherer is a Windows Search component that collects information about URLs within the crawl scope and creates a queue of URLs for the indexer to crawl.</span></span> <span data-ttu-id="b7630-143">當您新增、刪除或更新編目範圍中的專案時，系統會通知資料存放區的通知提供者通知收集程式。</span><span class="sxs-lookup"><span data-stu-id="b7630-143">When an item in the crawl scope is added, deleted, or updated, the gatherer is notified by the data store's notifications provider.</span></span> <span data-ttu-id="b7630-144">從編目範圍根開始，有一個初始編目。</span><span class="sxs-lookup"><span data-stu-id="b7630-144">There is an initial crawl where the gatherer starts at the crawl scope root.</span></span> <span data-ttu-id="b7630-145">URL 會傳遞至通訊協定處理常式，然後傳遞至適當的 [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter)。</span><span class="sxs-lookup"><span data-stu-id="b7630-145">The URL is passed to the protocol handler and then to the appropriate [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter).</span></span> <span data-ttu-id="b7630-146">篩選準則通常是產生更多 Url 的目錄列舉。</span><span class="sxs-lookup"><span data-stu-id="b7630-146">The filter is usually a directory enumeration that produces more URLs.</span></span> <span data-ttu-id="b7630-147">通知是穩定狀態。</span><span class="sxs-lookup"><span data-stu-id="b7630-147">Notifications are the steady-state.</span></span> <span data-ttu-id="b7630-148">一般而言，每個資料存放區都有自己的通訊協定處理常式可提供這些通知。</span><span class="sxs-lookup"><span data-stu-id="b7630-148">Typically, each data store has its own protocol handler that provides these notifications.</span></span> <span data-ttu-id="b7630-149">例如，在本機檔案系統上， [USN 變更日誌](/windows/desktop/FileIO/change-journals) 會作為 file://通訊協定下所有 url 的通知提供者。</span><span class="sxs-lookup"><span data-stu-id="b7630-149">For example, on the local file system, the [USN Change Journal](/windows/desktop/FileIO/change-journals) acts as a notifications provider for all URLs under the file:// protocol.</span></span> <span data-ttu-id="b7630-150">同樣地，Microsoft Outlook 作為 mapi://通訊協定下所有 Url 的通知提供者。</span><span class="sxs-lookup"><span data-stu-id="b7630-150">Similarly, Microsoft Outlook acts as a notifications provider for all URLs under the mapi:// protocol.</span></span> <span data-ttu-id="b7630-151">當使用者收到、移動或刪除電子郵件時，Outlook 會通知收集電子郵件的變更狀態。</span><span class="sxs-lookup"><span data-stu-id="b7630-151">When a user receives, moves, or deletes email, Outlook notifies the gatherer of the changed status of the email.</span></span> <span data-ttu-id="b7630-152">在這些通知中，收集程式會建立 Url 的索引佇列以進行編目。</span><span class="sxs-lookup"><span data-stu-id="b7630-152">From these notifications, the gatherer creates indexing queues of URLs to crawl.</span></span>

<span data-ttu-id="b7630-153">**編制佇列索引**  索引佇列是識別需要編制索引或重新編制索引之專案的 Url 清單。</span><span class="sxs-lookup"><span data-stu-id="b7630-153">**Indexing Queues**  The indexing queues are lists of URLs that identify items that need to be indexed or re-indexed.</span></span> <span data-ttu-id="b7630-154">此收集程式會比較它從通知提供者收到的 Url 與編目範圍中的 Url。</span><span class="sxs-lookup"><span data-stu-id="b7630-154">The gatherer compares the URLs it receives from notifications providers to the URLs in the crawl scope.</span></span> <span data-ttu-id="b7630-155">來自編目範圍內通知提供者的每個 URL 都會加入至收集器用來排定接下來要處理哪些 Url 的佇列。</span><span class="sxs-lookup"><span data-stu-id="b7630-155">Every URL from notifications providers that falls within the crawl scope is added to a queue that the gatherer uses to prioritize which URLs to process next.</span></span>

<span data-ttu-id="b7630-156">有三個佇列：高優先順序通知、一般通知和定期編目。</span><span class="sxs-lookup"><span data-stu-id="b7630-156">There are three queues: high priority notifications, normal notifications, and periodic crawls.</span></span> <span data-ttu-id="b7630-157">高優先順序佇列適用于應立即處理的通知。</span><span class="sxs-lookup"><span data-stu-id="b7630-157">The high priority queue is for notifications that should be processed immediately.</span></span> <span data-ttu-id="b7630-158">例如，當使用者變更 Windows 檔案總管中的專案標題屬性時，必須在變更之後立即更新 Windows 檔案總管視圖。</span><span class="sxs-lookup"><span data-stu-id="b7630-158">For example, when a user changes an item's title property in Windows Explorer, the Windows Explorer view needs to be updated immediately after the change.</span></span> <span data-ttu-id="b7630-159">一般通知佇列適用于所有剩餘的變更通知。</span><span class="sxs-lookup"><span data-stu-id="b7630-159">The normal notification queue is for all remaining change notifications.</span></span> <span data-ttu-id="b7630-160">通知佇列會在編目佇列之前處理，因為變更的專案比較可能對使用者感興趣。</span><span class="sxs-lookup"><span data-stu-id="b7630-160">The notification queues are processed before the crawl queue because changed items are more likely to be of interest to a user.</span></span> <span data-ttu-id="b7630-161">收集程式會先在中的每個佇列上的 Url 存取資料，先出 (FIFO) 順序。</span><span class="sxs-lookup"><span data-stu-id="b7630-161">The gatherer accesses data for the URLs on each queue in first in, first out (FIFO) order.</span></span>

<span data-ttu-id="b7630-162">如需 Windows 7 中所引進之優先順序和事件 Api 的詳細資訊，請參閱 [在 windows 7 中編制優先順序和資料列集事件的索引](indexing-prioritization-and-rowset-events.md)。</span><span class="sxs-lookup"><span data-stu-id="b7630-162">For more information on prioritization, and eventing APIs introduced in Windows 7, see [Indexing Prioritization and Rowset Events in Windows 7](indexing-prioritization-and-rowset-events.md).</span></span> <span data-ttu-id="b7630-163">如需編目領域管理和通知的詳細資訊，請參閱 [提供變更通知](-search-3x-wds-notifyingofchanges.md) 和 [使用編目範圍管理員](-search-3x-wds-extidx-csm.md)。</span><span class="sxs-lookup"><span data-stu-id="b7630-163">For more information on crawl scope management and notifications, see [Providing Change Notifications](-search-3x-wds-notifyingofchanges.md) and [Using the Crawl Scope Manager](-search-3x-wds-extidx-csm.md).</span></span>

## <a name="stage-2-crawling-urls"></a><span data-ttu-id="b7630-164">階段2：爬網 Url</span><span class="sxs-lookup"><span data-stu-id="b7630-164">Stage 2: Crawling URLs</span></span>

<span data-ttu-id="b7630-165">在索引的第二個階段中，收集程式會編目佇列、存取資料存放區，以及抓取專案資料流程。</span><span class="sxs-lookup"><span data-stu-id="b7630-165">In the second stage of indexing, the gatherer crawls through the queues, accessing data stores and retrieving item streams.</span></span> <span data-ttu-id="b7630-166">首先，收集程式會為每個 URL 尋找適當的通訊協定處理常式。</span><span class="sxs-lookup"><span data-stu-id="b7630-166">First, the gatherer finds the appropriate protocol handler for each URL.</span></span> <span data-ttu-id="b7630-167">然後，收集程式會將 URL 傳遞至通訊協定處理常式。</span><span class="sxs-lookup"><span data-stu-id="b7630-167">Then, the gatherer passes the URL to the protocol handler.</span></span> <span data-ttu-id="b7630-168">通訊協定處理常式會存取專案，並將專案中繼資料傳回給收集程式。</span><span class="sxs-lookup"><span data-stu-id="b7630-168">The protocol handler accesses the item and passes item metadata back to the gatherer.</span></span> <span data-ttu-id="b7630-169">收集程式會使用中繼資料來識別正確的篩選準則。</span><span class="sxs-lookup"><span data-stu-id="b7630-169">The gatherer uses the metadata to identify the correct filter.</span></span>

<span data-ttu-id="b7630-170">下圖顯示 URL 編目進程的高階觀點。</span><span class="sxs-lookup"><span data-stu-id="b7630-170">The following diagram shows a high-level view of the URL-crawling process.</span></span> <span data-ttu-id="b7630-171">這個階段包含元件之間相當可觀的協調與通訊。</span><span class="sxs-lookup"><span data-stu-id="b7630-171">This stage includes considerable coordination and communication between components.</span></span>

![顯示編目 url 和存取專案之程式的圖表](images/crawlingqueues.jpg)

<span data-ttu-id="b7630-173">本節的其餘部分將說明 Windows Search 如何存取專案以進行索引編制，以及說明每個相關元件的角色。</span><span class="sxs-lookup"><span data-stu-id="b7630-173">The rest of this section describes how Windows Search accesses items for indexing and explains the roles of each of the components involved.</span></span>

<span data-ttu-id="b7630-174">**收集**  在第2階段中，在「編目」階段，收集程式會從高優先順序佇列開始處理佇列中的 Url。</span><span class="sxs-lookup"><span data-stu-id="b7630-174">**Gatherer**  In stage 2, the crawling stage, the gatherer processes the URLs in the queues, beginning with the high priority queue.</span></span> <span data-ttu-id="b7630-175">檢查每個 URL 以識別其通訊協定。</span><span class="sxs-lookup"><span data-stu-id="b7630-175">Each URL is examined to identify its protocol.</span></span> <span data-ttu-id="b7630-176">然後，收集程式會查閱針對該通訊協定註冊的通訊協定處理常式，並在搜尋通訊協定主機進程中將其具現化。</span><span class="sxs-lookup"><span data-stu-id="b7630-176">The gatherer then looks up the protocol handler registered for that protocol and instantiates it in the search protocol host process.</span></span>

<span data-ttu-id="b7630-177">**搜尋通訊協定主機**  搜尋通訊協定主機只是通訊協定處理常式的已封裝主機進程。</span><span class="sxs-lookup"><span data-stu-id="b7630-177">**Search Protocol Host**  The search protocol host is merely a boxed, host process for protocol handlers.</span></span> <span data-ttu-id="b7630-178">一般來說，Windows Search 會建立兩個這類的主機進程，一個在系統安全性內容中執行，另一個在使用者安全性內容中執行。</span><span class="sxs-lookup"><span data-stu-id="b7630-178">Typically, Windows Search creates two such host processes, one that runs in the system security context and one that runs in the user security context.</span></span> <span data-ttu-id="b7630-179">這種分隔可確保使用者特定的資料永遠不會在系統內容中執行。</span><span class="sxs-lookup"><span data-stu-id="b7630-179">This separation ensures that data specific to a user is never run in the system context.</span></span>

<span data-ttu-id="b7630-180">Windows Search 也會使用主機進程，將通訊協定處理常式的實例與其他進程或應用程式隔離。</span><span class="sxs-lookup"><span data-stu-id="b7630-180">Windows Search also uses the host process to isolate an instance of a protocol handler from other processes or applications.</span></span> <span data-ttu-id="b7630-181">如此一來，任何外部應用程式都不能存取該特定的通訊協定處理常式實例，而且如果通訊協定處理常式意外失敗，則只會影響到索引處理常式。</span><span class="sxs-lookup"><span data-stu-id="b7630-181">This way, no outside application can access that specific instance of the protocol handler, and if the protocol handler fails unexpectedly, only the indexing process is affected.</span></span> <span data-ttu-id="b7630-182">因為主機進程會)  (通訊協定處理常式來執行協力廠商程式碼，所以 Windows Search 定期回收程式，將成功攻擊在程式中攻擊資訊的時間降到最低。</span><span class="sxs-lookup"><span data-stu-id="b7630-182">Because the host process runs third party code (protocol handlers), Windows Search periodically recycles the process to minimize the time a successful attack has to exploit information in the process.</span></span> <span data-ttu-id="b7630-183">除此之外，搜尋通訊協定主機不會影響 Url 的編目或專案索引。</span><span class="sxs-lookup"><span data-stu-id="b7630-183">Beyond this, the search protocol host does not affect the crawling of URLs or indexing of items.</span></span>

<span data-ttu-id="b7630-184">**通訊協定處理常式**  通訊協定處理常式可讓您使用資料存放區的通訊協定來存取資料存放區中的專案。</span><span class="sxs-lookup"><span data-stu-id="b7630-184">**Protocol Handlers**  Protocol handlers provide access to items in a data store using the data store's protocol.</span></span> <span data-ttu-id="b7630-185">例如，NTFS 通訊協定處理常式會使用 file://通訊協定來存取本機磁片上的檔案。</span><span class="sxs-lookup"><span data-stu-id="b7630-185">For example, the NTFS protocol handler provides access to files on a local drive using the file:// protocol.</span></span> <span data-ttu-id="b7630-186">通訊協定處理常式知道如何遍歷資料存放區、識別新的或更新的專案，以及通知收集程式。</span><span class="sxs-lookup"><span data-stu-id="b7630-186">The protocol handler knows how to traverse the data store, identify new or updated items, and notify the gatherer.</span></span> <span data-ttu-id="b7630-187">然後，當編目開始時，通訊協定處理常式會提供 [**IUrlAccessor**](/windows/desktop/api/Searchapi/nn-searchapi-iurlaccessor) 物件給收集器，以系結至專案的基礎資料流程，並傳回專案中繼資料，例如安全性限制和上次修改時間。</span><span class="sxs-lookup"><span data-stu-id="b7630-187">Then, when crawling begins, the protocol handler provides an [**IUrlAccessor**](/windows/desktop/api/Searchapi/nn-searchapi-iurlaccessor) object to the gatherer to bind to the item's underlying stream and return item metadata such as security restrictions and last modified time.</span></span>

> [!NOTE]  
> <span data-ttu-id="b7630-188">通訊協定處理常式不 Windows Search 元件;它們是特定通訊協定的元件，以及其設計來存取的資料存放區。</span><span class="sxs-lookup"><span data-stu-id="b7630-188">Protocol handlers are not Windows Search components; they are components of the specific protocol and data store they are designed to access.</span></span> <span data-ttu-id="b7630-189">如果您有想要編制索引的自訂資料存放區，則需要執行通訊協定處理常式。</span><span class="sxs-lookup"><span data-stu-id="b7630-189">If you have a custom data store you want indexed, you need to implement a protocol handler.</span></span> <span data-ttu-id="b7630-190">如需有關通訊協定處理常式以及如何執行的詳細資訊，請參閱 [開發通訊協定處理常式](-search-3x-wds-phaddins.md)。</span><span class="sxs-lookup"><span data-stu-id="b7630-190">For more information on protocol handlers and how to implement one, refer to [Developing Protocol Handlers](-search-3x-wds-phaddins.md).</span></span>

<span data-ttu-id="b7630-191">**中繼資料和資料流程**  使用通訊協定處理常式的 [**IUrlAccessor**](/windows/desktop/api/Searchapi/nn-searchapi-iurlaccessor) 物件所傳回的中繼資料，收集器會識別 URL 的正確篩選。</span><span class="sxs-lookup"><span data-stu-id="b7630-191">**Metadata and Stream**  Using metadata returned by the protocol handler's [**IUrlAccessor**](/windows/desktop/api/Searchapi/nn-searchapi-iurlaccessor) object, the gatherer identifies the correct filter for the URL.</span></span> <span data-ttu-id="b7630-192">此收集程式會剖析專案的副檔名，並查閱針對該擴充功能註冊的篩選準則。</span><span class="sxs-lookup"><span data-stu-id="b7630-192">The gatherer parses the item's file name extension and looks up the filter registered for that extension.</span></span> <span data-ttu-id="b7630-193">如果收集器找不到篩選器，Windows Search 會使用中繼資料來衍生一組最基本的系統屬性資訊， (例如 System.object) 並更新索引。</span><span class="sxs-lookup"><span data-stu-id="b7630-193">If the gatherer is unable to find a filter, Windows Search uses the metadata to derive a minimal set of system property information (like System.ItemName) and updates the index.</span></span> <span data-ttu-id="b7630-194">否則，如果收集器找到篩選器，就會開始進行索引的第三個階段。</span><span class="sxs-lookup"><span data-stu-id="b7630-194">Otherwise, if the gatherer finds the filter, the third stage of indexing begins.</span></span>

## <a name="stage-3-updating-the-index"></a><span data-ttu-id="b7630-195">階段3：更新索引</span><span class="sxs-lookup"><span data-stu-id="b7630-195">Stage 3: Updating the Index</span></span>

<span data-ttu-id="b7630-196">在索引的第三個階段中，收集器會具現化 URL 的正確篩選，並使用來自 [**IUrlAccessor**](/windows/desktop/api/Searchapi/nn-searchapi-iurlaccessor) 物件的資料流程初始化篩選。</span><span class="sxs-lookup"><span data-stu-id="b7630-196">In the third stage of indexing, the gatherer instantiates the correct filter for the URL and initializes the filter with the stream from the [**IUrlAccessor**](/windows/desktop/api/Searchapi/nn-searchapi-iurlaccessor) object.</span></span> <span data-ttu-id="b7630-197">然後，篩選準則會存取專案並傳回索引的內容。</span><span class="sxs-lookup"><span data-stu-id="b7630-197">The filter then accesses the item and returns content for the index.</span></span> <span data-ttu-id="b7630-198">如果您有自訂檔案格式，Windows Search 會依賴您的篩選來存取 Url，併發出內容和屬性以進行索引編制。</span><span class="sxs-lookup"><span data-stu-id="b7630-198">If you have a custom file format, Windows Search relies on your filter to access URLs and emit content and properties for indexing.</span></span>

<span data-ttu-id="b7630-199">下圖顯示資料存取進程的高階觀點。</span><span class="sxs-lookup"><span data-stu-id="b7630-199">The following diagram shows a high-level view of the data access process.</span></span> <span data-ttu-id="b7630-200">這個階段包含元件之間相當可觀的協調與通訊。</span><span class="sxs-lookup"><span data-stu-id="b7630-200">This stage includes considerable coordination and communication between components.</span></span>

![顯示為索引發出之專案資料的圖表](images/filteringdata.jpg)

<span data-ttu-id="b7630-202">本節的其餘部分將說明 Windows Search 如何存取專案資料以進行索引編制，以及說明每個相關元件的角色。</span><span class="sxs-lookup"><span data-stu-id="b7630-202">The rest of this section describes how Windows Search accesses item data for indexing and explains the roles of each of the components involved.</span></span>

<span data-ttu-id="b7630-203">**收集**  在這個階段開始時，收集器的角色是為專案具現化正確的篩選，並將其傳遞至專案資料流程。</span><span class="sxs-lookup"><span data-stu-id="b7630-203">**Gatherer**  At the beginning of this stage, the gatherer's role is to instantiate the correct filter for the item and pass it the item stream.</span></span> <span data-ttu-id="b7630-204">在這個階段結束時，收集器會採用篩選器和屬性處理常式所發出的內容和屬性，並更新索引。</span><span class="sxs-lookup"><span data-stu-id="b7630-204">At the end of this stage, the gatherer takes the content and properties emitted by the filter and property handler and updates the index.</span></span>

<span data-ttu-id="b7630-205">**篩選主機**  篩選主控制項只是篩選器和屬性處理常式的主機進程，而且是與搜尋通訊協定主機類似的用途。</span><span class="sxs-lookup"><span data-stu-id="b7630-205">**Filter Host**  The filter host is merely a host process for filters and property handlers and serves a purpose similar to the search protocol host.</span></span> <span data-ttu-id="b7630-206">主機進程會將篩選器和屬性處理常式與系統的其餘部分隔離，以提供搜尋通訊協定主機進程隔離通訊協定處理常式的相同安全性和穩定性原因。</span><span class="sxs-lookup"><span data-stu-id="b7630-206">The host process isolates filters and property handlers from the rest of the system for the same security and stability reasons that search protocol host processes isolate protocol handlers.</span></span> <span data-ttu-id="b7630-207">主機進程會以最少的許可權執行 (它甚至無法存取檔案系統) ，而且偶爾會被回收以防止安全性攻擊。</span><span class="sxs-lookup"><span data-stu-id="b7630-207">The host process runs with minimal rights (it can't even access the file system) and is occasionally recycled to protect against security attacks.</span></span> <span data-ttu-id="b7630-208">Windows Search 也會監視資源使用方式，因此，如果篩選器耗用太多資源，則會回收主機進程。</span><span class="sxs-lookup"><span data-stu-id="b7630-208">Windows Search also monitors resource use so that if a filter consumes too many resources, the host process is recycled.</span></span>

<span data-ttu-id="b7630-209">**篩選**  篩選是在編制索引程式中發出收集程式專案資訊的重要元件。</span><span class="sxs-lookup"><span data-stu-id="b7630-209">**Filters**  Filters are critical components in the indexing process that emit item information for the gatherer.</span></span> <span data-ttu-id="b7630-210">篩選器會在其執行時所使用的主體介面（ [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) 介面）中命名，因此有時也稱為 ifilter。</span><span class="sxs-lookup"><span data-stu-id="b7630-210">Filters are named after the principal interface used in their implementation, the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) interface, and consequently are sometimes referred to as IFilters.</span></span> <span data-ttu-id="b7630-211">篩選器有兩種：一個與個別專案互動，例如檔案，另一個則與容器（例如資料夾）互動。</span><span class="sxs-lookup"><span data-stu-id="b7630-211">There are two kinds of filters: one that interacts with individual items like files and one that interacts with containers like folders.</span></span> <span data-ttu-id="b7630-212">兩者都提供索引的資料。</span><span class="sxs-lookup"><span data-stu-id="b7630-212">Both provide data for the index.</span></span>

<span data-ttu-id="b7630-213">使用通訊協定處理常式的 [**IUrlAccessor**](/windows/desktop/api/Searchapi/nn-searchapi-iurlaccessor) 物件所傳回的中繼資料，收集器會識別特定 URL 的正確篩選，並將其傳遞至資料流程。</span><span class="sxs-lookup"><span data-stu-id="b7630-213">Using metadata returned by the protocol handler's [**IUrlAccessor**](/windows/desktop/api/Searchapi/nn-searchapi-iurlaccessor) object, the gatherer identifies the correct filter for a particular URL and passes it to the stream.</span></span> <span data-ttu-id="b7630-214">收集器會透過通訊協定處理常式或副檔名、MIME 類型或類別識別碼 (CLSID) 來識別正確的篩選。</span><span class="sxs-lookup"><span data-stu-id="b7630-214">The gatherer identifies the correct filter either through a protocol handler or by the file name extension, MIME type, or class identifier (CLSID).</span></span> <span data-ttu-id="b7630-215">如果 URL 指向容器，則篩選會發出容器的屬性，並列舉容器中 (子 Url) 的專案。</span><span class="sxs-lookup"><span data-stu-id="b7630-215">If the URL points to a container, the filter emits properties for the container and enumerates the items in the container (child URLs).</span></span> <span data-ttu-id="b7630-216">如果 URL 指向某個專案，則篩選準則會傳回文字內容（如果有任何內容讀取，而且比屬性處理常式更複雜）。</span><span class="sxs-lookup"><span data-stu-id="b7630-216">If the URL points to an item, the filter returns the textual content, if any the reading of properties and are more complex than property handlers.</span></span> <span data-ttu-id="b7630-217">一般來說，我們建議篩選準則會在屬性處理常式發出專案屬性時發出專案內容。</span><span class="sxs-lookup"><span data-stu-id="b7630-217">Generally, we recommend that filters emit item contents while property handlers emit item properties.</span></span> <span data-ttu-id="b7630-218">但是，如果您的篩選器需要使用無法辨識屬性處理常式的繼承應用程式，則您也可以執行篩選以發出屬性。</span><span class="sxs-lookup"><span data-stu-id="b7630-218">However, if your filter needs to work with older applications that do not recognize property handlers, you can implement the filter to emit properties as well.</span></span>

> [!NOTE]  
> <span data-ttu-id="b7630-219">篩選準則不 Windows Search 元件;它們是與特定檔案格式或設計來存取的容器相關的元件。</span><span class="sxs-lookup"><span data-stu-id="b7630-219">Filters are not Windows Search components; they are components related to the specific file format or container they are designed to access.</span></span> <span data-ttu-id="b7630-220">如需篩選器的詳細資訊，以及如何針對自訂檔案格式或容器來執行篩選器的詳細資訊，請參閱 [在 Windows Search 中建立篩選處理常式的最佳做法](-search-3x-wds-extidx-filters.md)。</span><span class="sxs-lookup"><span data-stu-id="b7630-220">For more information on filters and how to implement one for a custom file format or container, see [Best Practices for Creating Filter Handlers in Windows Search](-search-3x-wds-extidx-filters.md).</span></span>

<span data-ttu-id="b7630-221">下表列出收集程式從篩選器 ([**IFilter**](/windows/win32/api/filter/nn-filter-ifilter)) 和屬性處理常式接收的結果， (在編制索引過程中) [**IPropertyStore**](/windows/win32/api/propsys/nn-propsys-ipropertystore) 。</span><span class="sxs-lookup"><span data-stu-id="b7630-221">The following table lists the results that the gatherer receives from a filter ([**IFilter**](/windows/win32/api/filter/nn-filter-ifilter)) and property handler ([**IPropertyStore**](/windows/win32/api/propsys/nn-propsys-ipropertystore)) during the indexing process.</span></span>

|                            | [<span data-ttu-id="b7630-222">**IFilter**</span><span class="sxs-lookup"><span data-stu-id="b7630-222">**IFilter**</span></span>](/windows/win32/api/filter/nn-filter-ifilter) | [<span data-ttu-id="b7630-223">**IPropertyStore**</span><span class="sxs-lookup"><span data-stu-id="b7630-223">**IPropertyStore**</span></span>](/windows/win32/api/propsys/nn-propsys-ipropertystore) |
|----------------------------|------------------------------------|-------------------------------------------------|
| <span data-ttu-id="b7630-224">**允許寫入**</span><span class="sxs-lookup"><span data-stu-id="b7630-224">**Allow write**</span></span>                | <span data-ttu-id="b7630-225">否</span><span class="sxs-lookup"><span data-stu-id="b7630-225">No</span></span>                                 | <span data-ttu-id="b7630-226">是</span><span class="sxs-lookup"><span data-stu-id="b7630-226">Yes</span></span>                                             |
| <span data-ttu-id="b7630-227">**混合內容和屬性**</span><span class="sxs-lookup"><span data-stu-id="b7630-227">**Mix content and properties**</span></span> | <span data-ttu-id="b7630-228">是</span><span class="sxs-lookup"><span data-stu-id="b7630-228">Yes</span></span>                                | <span data-ttu-id="b7630-229">否</span><span class="sxs-lookup"><span data-stu-id="b7630-229">No</span></span>                                              |
| <span data-ttu-id="b7630-230">**多 語種**</span><span class="sxs-lookup"><span data-stu-id="b7630-230">**Multilingual**</span></span>               | <span data-ttu-id="b7630-231">是</span><span class="sxs-lookup"><span data-stu-id="b7630-231">Yes</span></span>                                | <span data-ttu-id="b7630-232">否</span><span class="sxs-lookup"><span data-stu-id="b7630-232">No</span></span>                                              |
| <span data-ttu-id="b7630-233">**發出連結**</span><span class="sxs-lookup"><span data-stu-id="b7630-233">**Emit links**</span></span>                 | <span data-ttu-id="b7630-234">是</span><span class="sxs-lookup"><span data-stu-id="b7630-234">Yes</span></span>                                | <span data-ttu-id="b7630-235">否</span><span class="sxs-lookup"><span data-stu-id="b7630-235">No</span></span>                                              |
| <span data-ttu-id="b7630-236">**MIME**</span><span class="sxs-lookup"><span data-stu-id="b7630-236">**MIME**</span></span>                       | <span data-ttu-id="b7630-237">是</span><span class="sxs-lookup"><span data-stu-id="b7630-237">Yes</span></span>                                | <span data-ttu-id="b7630-238">否</span><span class="sxs-lookup"><span data-stu-id="b7630-238">No</span></span>                                              |
| <span data-ttu-id="b7630-239">**文字界限**</span><span class="sxs-lookup"><span data-stu-id="b7630-239">**Text boundaries**</span></span>            | <span data-ttu-id="b7630-240">句子、段落、章節</span><span class="sxs-lookup"><span data-stu-id="b7630-240">Sentence, paragraph, chapter</span></span>       | <span data-ttu-id="b7630-241">無</span><span class="sxs-lookup"><span data-stu-id="b7630-241">None</span></span>                                            |
| <span data-ttu-id="b7630-242">**用戶端/伺服器**</span><span class="sxs-lookup"><span data-stu-id="b7630-242">**Client / server**</span></span>            | <span data-ttu-id="b7630-243">兩者</span><span class="sxs-lookup"><span data-stu-id="b7630-243">Both</span></span>                               | <span data-ttu-id="b7630-244">用戶端</span><span class="sxs-lookup"><span data-stu-id="b7630-244">Client</span></span>                                          |
| <span data-ttu-id="b7630-245">**實作**</span><span class="sxs-lookup"><span data-stu-id="b7630-245">**Implementation**</span></span>             | <span data-ttu-id="b7630-246">Complex</span><span class="sxs-lookup"><span data-stu-id="b7630-246">Complex</span></span>                            | <span data-ttu-id="b7630-247">簡單</span><span class="sxs-lookup"><span data-stu-id="b7630-247">Simple</span></span>                                          |

<span data-ttu-id="b7630-248">**屬性處理常式**  屬性處理常式是針對特定檔案格式讀取和寫入屬性的元件。</span><span class="sxs-lookup"><span data-stu-id="b7630-248">**Property Handlers**  Property handlers are components that read and write properties for a particular file format.</span></span> <span data-ttu-id="b7630-249">他們會以篩選器為內容進行的相同方式，存取專案併發出收集程式的屬性。</span><span class="sxs-lookup"><span data-stu-id="b7630-249">They access items and emit properties for the gatherer in the same way that filters do for content.</span></span> <span data-ttu-id="b7630-250">屬性處理常式比篩選器更容易執行。</span><span class="sxs-lookup"><span data-stu-id="b7630-250">Property handlers are easier to implement than filters.</span></span> <span data-ttu-id="b7630-251">如果以文字為基礎的檔案格式很簡單，或是檔案預期會很小，則屬性處理常式可以同時發出屬性和內容。</span><span class="sxs-lookup"><span data-stu-id="b7630-251">If a text-based file format is very simple or the files are expected to be very small, the property handler can emit both properties and content.</span></span>

> [!NOTE]  
> <span data-ttu-id="b7630-252">屬性處理常式不 Windows Search 元件;它們是設計來存取的特定檔案格式相關元件。</span><span class="sxs-lookup"><span data-stu-id="b7630-252">Property handlers are not Windows Search components; they are components related to the specific file format they are designed to access.</span></span> <span data-ttu-id="b7630-253">如需有關屬性處理常式的詳細資訊，以及如何針對自訂檔案格式來執行它，請參閱 [開發 Windows Search 的屬性處理常式](-search-3x-wds-extidx-propertyhandlers.md)。</span><span class="sxs-lookup"><span data-stu-id="b7630-253">For more information on property handlers and how to implement one for a custom file format, see [Developing Property Handlers for Windows Search](-search-3x-wds-extidx-propertyhandlers.md).</span></span>

<span data-ttu-id="b7630-254">**屬性** Windows Search 提供的 [屬性系統](https://msdn.microsoft.com/library/bb763010(VS.85).aspx) 包含大型的屬性庫。</span><span class="sxs-lookup"><span data-stu-id="b7630-254">**Properties** Windows Search provides a [property system](https://msdn.microsoft.com/library/bb763010(VS.85).aspx) that includes a large library of properties.</span></span> <span data-ttu-id="b7630-255">任何屬性都可以出現在篩選準則或屬性處理常式所定義的任何專案上。</span><span class="sxs-lookup"><span data-stu-id="b7630-255">Any property can appear on any item as defined by the filter or property handler.</span></span> <span data-ttu-id="b7630-256">如果您有自訂的檔案格式，您可以將檔案格式的屬性對應至這些系統屬性，而且您可以建立新的自訂屬性。</span><span class="sxs-lookup"><span data-stu-id="b7630-256">If you have a custom file format, you can map your file format's properties to these system properties, and you can create new custom properties.</span></span> <span data-ttu-id="b7630-257">當您的篩選或屬性處理常式發出這些屬性時，收集程式會更新索引，讓使用者可以使用您的屬性進行搜尋。</span><span class="sxs-lookup"><span data-stu-id="b7630-257">When your filter or property handler emits these properties, the gatherer updates the index so users can search using your properties.</span></span> <span data-ttu-id="b7630-258">如需有關建立和註冊檔案格式之自訂屬性的詳細資訊，請參閱 [屬性系統](../properties/building-property-handlers.md)。</span><span class="sxs-lookup"><span data-stu-id="b7630-258">For more information on creating and registering custom properties for a file format, see [Property System](../properties/building-property-handlers.md).</span></span>

<span data-ttu-id="b7630-259">**SystemIndex**  索引（稱為 SystemIndex）會儲存已編制索引的資料，並由屬性存放區和索引（用於專案屬性的屬性和內容）以及文字內容和屬性的反向索引組成。</span><span class="sxs-lookup"><span data-stu-id="b7630-259">**SystemIndex**  The index, called SystemIndex, stores indexed data and is composed of a property store and indices over the properties and content for item properties, and an inverted index for textual content and properties.</span></span> <span data-ttu-id="b7630-260">在收集器更新索引之後，Windows Search 和其他應用程式就可以查詢索引。</span><span class="sxs-lookup"><span data-stu-id="b7630-260">After the gatherer updates the index, the index can be queried by Windows Search and other applications.</span></span> <span data-ttu-id="b7630-261">如需查詢索引方式的詳細資訊，請參閱 [以程式設計方式查詢索引](-search-3x-wds-qryidx-overview.md)。</span><span class="sxs-lookup"><span data-stu-id="b7630-261">For more information on ways to query the index, see [Querying the Index Programmatically](-search-3x-wds-qryidx-overview.md).</span></span>

> [!NOTE]  
> <span data-ttu-id="b7630-262">請記住，當您重新註冊架構時，索引子可能不會遵守先前定義之屬性的屬性變更。</span><span class="sxs-lookup"><span data-stu-id="b7630-262">Remember that when you re-register a schema, changes made to attributes of previously defined properties may not be respected by the indexer.</span></span> <span data-ttu-id="b7630-263">解決方法是重建索引，或引進新的屬性來反映變更，而不是更新舊的屬性 (不建議) 。</span><span class="sxs-lookup"><span data-stu-id="b7630-263">The solution is either to rebuild the index, or introduce new properties that reflect the changes instead of updating old ones (not recommended).</span></span> <span data-ttu-id="b7630-264">如需詳細資訊，請參閱「[屬性系統](../properties/property-system-overview.md)中的實作者[注意事項](#notes-to-implementers)」。</span><span class="sxs-lookup"><span data-stu-id="b7630-264">For more information, see [Note to Implementers](#notes-to-implementers) in [Properties System Overview](../properties/property-system-overview.md).</span></span>

## <a name="how-indexing-is-scheduled"></a><span data-ttu-id="b7630-265">如何排程編制索引</span><span class="sxs-lookup"><span data-stu-id="b7630-265">How Indexing is Scheduled</span></span>

<span data-ttu-id="b7630-266">當 Windows Search 第一次安裝時，它會執行編目範圍的完整編制索引，並在高 i/o 和使用者活動期間暫停。</span><span class="sxs-lookup"><span data-stu-id="b7630-266">When Windows Search is first installed, it performs a full indexing of the crawl scope, pausing during periods of high I/O and user activity.</span></span> <span data-ttu-id="b7630-267">預設編目範圍是由預設的程式庫位置所組成，例如 **檔**、**音樂**、**圖片** 和 **影片。**</span><span class="sxs-lookup"><span data-stu-id="b7630-267">The default crawl scope consists of the default library locations, such as **Documents**, **Music**, **Pictures**, and **Videos**.</span></span> <span data-ttu-id="b7630-268">即使在初始編目完成之前，也會處理通知。</span><span class="sxs-lookup"><span data-stu-id="b7630-268">Notifications are processed even before the initial crawl is finished.</span></span> <span data-ttu-id="b7630-269">有時候，收集者會從完整編目範圍編目 Url。</span><span class="sxs-lookup"><span data-stu-id="b7630-269">Occasionally, the gatherer crawls the URLs from the full crawl scope.</span></span> <span data-ttu-id="b7630-270">這些完整編目可確保索引中的資料是最新的。</span><span class="sxs-lookup"><span data-stu-id="b7630-270">These full crawls ensure that the data in the index is fresh.</span></span> <span data-ttu-id="b7630-271">例如，如果通知提供者無法傳送通知，或 Windows Search 服務意外終止，則收集程式不知道新的或變更的專案，也不會為這些專案編制索引。</span><span class="sxs-lookup"><span data-stu-id="b7630-271">For example, if a notification provider fails to send notifications or if the Windows Search service is terminated unexpectedly, the gatherer would have no knowledge of new or changed items and would not index these items.</span></span> <span data-ttu-id="b7630-272">來源有兩種：僅通知和已啟用通知。</span><span class="sxs-lookup"><span data-stu-id="b7630-272">There are two kinds of sources: notification only and notification enabled.</span></span> <span data-ttu-id="b7630-273">在這兩個來源中，收集一開始會將索引編目。</span><span class="sxs-lookup"><span data-stu-id="b7630-273">In both sources, the gatherer initially crawls the index.</span></span> <span data-ttu-id="b7630-274">初始編目之後，只有在發生失敗（例如 [USN 變更日誌](/windows/desktop/FileIO/change-journals) 正在復原）的情況下，通知來源才會再次進行完整編目。</span><span class="sxs-lookup"><span data-stu-id="b7630-274">After the initial crawl, the notification-only sources will never do a full crawl again unless there is a failure, such as the [USN Change Journal](/windows/desktop/FileIO/change-journals) rolling over.</span></span> <span data-ttu-id="b7630-275">啟用通知的來源會在索引子啟動時進行累加式編目，但是在執行時接聽通知。</span><span class="sxs-lookup"><span data-stu-id="b7630-275">Notification-enabled sources do an incremental crawl when the indexer is started, but then listen to notifications while running.</span></span> <span data-ttu-id="b7630-276">NTFS 和 Microsoft Outlook 只是通知。</span><span class="sxs-lookup"><span data-stu-id="b7630-276">NTFS and Microsoft Outlook are notification only.</span></span> <span data-ttu-id="b7630-277">Internet Explorer 和 FAT 已啟用通知。</span><span class="sxs-lookup"><span data-stu-id="b7630-277">Internet Explorer and FAT are notification enabled.</span></span>

## <a name="notes-to-implementers"></a><span data-ttu-id="b7630-278">給實施者的注意事項</span><span class="sxs-lookup"><span data-stu-id="b7630-278">Notes to Implementers</span></span>

<span data-ttu-id="b7630-279">索引中的資料品質和索引編制程式的效率，主要取決於您的篩選和屬性處理常式的執行。</span><span class="sxs-lookup"><span data-stu-id="b7630-279">The quality of the data in the index and the efficiency of the indexing process depend largely on your filter and property handler implementation.</span></span> <span data-ttu-id="b7630-280">因為每次 URL 識別您的檔案格式都會呼叫篩選，所以如果您的篩選沒有效率，編制索引程式可能會大幅降低。</span><span class="sxs-lookup"><span data-stu-id="b7630-280">Because the filter is called every time a URL identifies your file format, the indexing process can slow down dramatically if your filter is inefficient.</span></span> <span data-ttu-id="b7630-281">如果您的屬性處理常式未正確地將所有檔案屬性對應到系統屬性，或未正確地發出這些屬性，則索引中的資料會不正確，且稍後搜尋這些屬性將會傳回不正確的結果。</span><span class="sxs-lookup"><span data-stu-id="b7630-281">If your property handler doesn't correctly map all file properties to system properties or doesn't correctly emit these properties, the data in the index will be incorrect and later searches for those properties will return incorrect results.</span></span> <span data-ttu-id="b7630-282">如果您的篩選準則或屬性處理常式失敗，索引子將無法為數據編制索引。</span><span class="sxs-lookup"><span data-stu-id="b7630-282">If your filter or property handler fails, the indexer won't be able to index data.</span></span>

<span data-ttu-id="b7630-283">Windows Search 的應用程式和進程依賴通訊協定處理常式、篩選和屬性處理常式。</span><span class="sxs-lookup"><span data-stu-id="b7630-283">Applications and processes other than Windows Search rely on protocol handlers, filters, and property handlers.</span></span> <span data-ttu-id="b7630-284">您的實施可能會以您預期的方式影響這些應用程式。</span><span class="sxs-lookup"><span data-stu-id="b7630-284">Your implementations can affect those applications in ways you may not expect.</span></span> <span data-ttu-id="b7630-285">《 [Windows Search 開發指南》](-search-developers-guide-entry-page.md) 提供有關設計選擇及測試每個元件的建議。</span><span class="sxs-lookup"><span data-stu-id="b7630-285">The [Windows Search Development Guide](-search-developers-guide-entry-page.md) provides advice on design choices and on testing each of these components.</span></span>

## <a name="related-topics"></a><span data-ttu-id="b7630-286">相關主題</span><span class="sxs-lookup"><span data-stu-id="b7630-286">Related topics</span></span>

[<span data-ttu-id="b7630-287">Windows Search 中的編制索引、查詢和通知</span><span class="sxs-lookup"><span data-stu-id="b7630-287">Indexing, Querying and Notifications in Windows Search</span></span>](-search-3x-wds-included-in-index.md)

[<span data-ttu-id="b7630-288">索引中包含的內容</span><span class="sxs-lookup"><span data-stu-id="b7630-288">What is Included in the Index</span></span>](-search-indexing-process-overview.md)

[<span data-ttu-id="b7630-289">在 Windows Search 中查詢進程</span><span class="sxs-lookup"><span data-stu-id="b7630-289">Querying Process in Windows Search</span></span>](querying-process--windows-search-.md)

[<span data-ttu-id="b7630-290">Windows Search 中的通知處理</span><span class="sxs-lookup"><span data-stu-id="b7630-290">Notifications Process in Windows Search</span></span>](-search-3x-wds-support.md)

[<span data-ttu-id="b7630-291">URL 格式設定需求</span><span class="sxs-lookup"><span data-stu-id="b7630-291">URL Formatting Requirements</span></span>](url-formatting-requirements.md)
