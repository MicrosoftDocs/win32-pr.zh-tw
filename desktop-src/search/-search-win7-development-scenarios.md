---
description: 概述 Windows 7 的程式庫簡介。
ms.assetid: 83c47963-4c8e-45ee-b707-bd45cfe048cd
title: Windows 7 中的 windows Shell 程式庫
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: fb94551d80d0230966626f1bd6499801aff889c4
ms.sourcegitcommit: 3bdf30edb314e0fcd17dc4ddbc70e4ec7d3596e6
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 02/10/2021
ms.locfileid: "106986004"
---
# <a name="windows-shell-libraries-in-windows"></a><span data-ttu-id="352de-103">Windows 中的 windows Shell 程式庫</span><span class="sxs-lookup"><span data-stu-id="352de-103">Windows Shell Libraries in Windows</span></span>

<span data-ttu-id="352de-104">本主題概述 Windows 7 和更新版本的程式庫簡介。</span><span class="sxs-lookup"><span data-stu-id="352de-104">This topic outlines the introduction of libraries for Windows 7 and later.</span></span> <span data-ttu-id="352de-105">程式庫是 Windows Shell 的功能。</span><span class="sxs-lookup"><span data-stu-id="352de-105">Libraries are a Windows Shell feature.</span></span> <span data-ttu-id="352de-106">若要存取 Windows Shell 功能，例如程式庫，Windows Search 應用程式的協力廠商開發人員必須先執行 Shell 資料存放區。</span><span class="sxs-lookup"><span data-stu-id="352de-106">To access Windows Shell functionality, such as libraries, third-party developers of Windows Search applications must first implement a Shell data store.</span></span> <span data-ttu-id="352de-107">如需詳細資訊，請參閱 [執行基本資料夾物件介面](/previous-versions/windows/desktop/legacy/cc144093(v=vs.85))。</span><span class="sxs-lookup"><span data-stu-id="352de-107">For more information, see [Implementing the Basic Folder Object Interfaces](/previous-versions/windows/desktop/legacy/cc144093(v=vs.85)).</span></span>

<span data-ttu-id="352de-108">本主題的組織方式如下：</span><span class="sxs-lookup"><span data-stu-id="352de-108">This topic is organized as follows:</span></span>

- [<span data-ttu-id="352de-109">程式庫</span><span class="sxs-lookup"><span data-stu-id="352de-109">Libraries</span></span>](#libraries)
  - [<span data-ttu-id="352de-110">使用者資料進入點</span><span class="sxs-lookup"><span data-stu-id="352de-110">User Data Entry Points</span></span>](#user-data-entry-points)
  - [<span data-ttu-id="352de-111">資料夾集合</span><span class="sxs-lookup"><span data-stu-id="352de-111">Collections of Folders</span></span>](#collections-of-folders)
  - [<span data-ttu-id="352de-112">程式庫中支援的資料夾</span><span class="sxs-lookup"><span data-stu-id="352de-112">Supported Folders in Libraries</span></span>](#supported-folders-in-libraries)
  - [<span data-ttu-id="352de-113">儲存體支援</span><span class="sxs-lookup"><span data-stu-id="352de-113">Storage-Backed</span></span>](#storage-backed)
  - [<span data-ttu-id="352de-114">非檔案系統 Shell 容器</span><span class="sxs-lookup"><span data-stu-id="352de-114">Non-File System Shell Containers</span></span>](#non-file-system-shell-containers)
  - [<span data-ttu-id="352de-115">程式庫描述</span><span class="sxs-lookup"><span data-stu-id="352de-115">Library Descriptions</span></span>](#library-descriptions)
- [<span data-ttu-id="352de-116">相關主題</span><span class="sxs-lookup"><span data-stu-id="352de-116">Related topics</span></span>](#related-topics)

## <a name="libraries"></a><span data-ttu-id="352de-117">程式庫</span><span class="sxs-lookup"><span data-stu-id="352de-117">Libraries</span></span>

<span data-ttu-id="352de-118">在 Windows 7 和更新版本中，程式庫是使用者資料的預設存放庫。</span><span class="sxs-lookup"><span data-stu-id="352de-118">In Windows 7 and later, libraries are the default repository of user data.</span></span> <span data-ttu-id="352de-119">使用者可以使用與在資料夾中相同的方式流覽檔案，也可以依屬性（例如日期、類型和作者）來查看其檔案。</span><span class="sxs-lookup"><span data-stu-id="352de-119">Users can browse their files the same way they would in a folder, or they can view their files arranged by properties such as date, type, and author.</span></span> <span data-ttu-id="352de-120">與資料夾不同的是，程式庫不會實際儲存專案，而是同時顯示儲存在數個資料夾中的檔案。</span><span class="sxs-lookup"><span data-stu-id="352de-120">Unlike a folder, a library does not actually store items, but displays files that are stored in several folders at the same time.</span></span> <span data-ttu-id="352de-121">程式庫提供單一存取點，而豐富的視圖會對其匯總內容的使用者進行透視。</span><span class="sxs-lookup"><span data-stu-id="352de-121">Libraries provide a single access point and rich view pivots to users of their aggregated content.</span></span> <span data-ttu-id="352de-122">比方說，如果使用者除了 [ **我的音樂** ] 資料夾之外，還在外部磁片磁碟機上的資料夾中有音樂檔案，則他們可以透過「音樂」媒體櫃立即存取所有音樂檔案。</span><span class="sxs-lookup"><span data-stu-id="352de-122">For example, if a user has music files in folders on an external drive in addition to the **My Music** folder, then they are able to immediately access all music files through the Music library.</span></span>

### <a name="user-data-entry-points"></a><span data-ttu-id="352de-123">使用者資料進入點</span><span class="sxs-lookup"><span data-stu-id="352de-123">User Data Entry Points</span></span>

<span data-ttu-id="352de-124">預設程式庫 (例如 **我的檔**、 **我的圖片** 等等) 相當於 [已知資料夾](/previous-versions/windows/desktop/legacy/bb776911(v=vs.85))。</span><span class="sxs-lookup"><span data-stu-id="352de-124">Default libraries (such as **My Documents**, **My Pictures**, and so forth) are the equivalent of [Known Folder](/previous-versions/windows/desktop/legacy/bb776911(v=vs.85)).</span></span> <span data-ttu-id="352de-125">預設程式庫會為使用者提供熟悉的進入點，但由於文件庫內容不限於已知的資料夾內容庫，讓使用者能夠更自由地判斷檔和媒體的儲存位置。</span><span class="sxs-lookup"><span data-stu-id="352de-125">Default libraries provide familiar entry points to users, but because library content is not limited to Known Folder content libraries give users more freedom to determine where documents and media should be stored.</span></span> <span data-ttu-id="352de-126">程式庫會透過 Shell 命名空間 (Shell 資料來源) 公開。</span><span class="sxs-lookup"><span data-stu-id="352de-126">Libraries are exposed through the Shell namespace (Shell data source).</span></span> <span data-ttu-id="352de-127">您的應用程式可以藉由啟用程式庫感知和流覽功能，為使用者提供與資料相同的熟悉進入點。</span><span class="sxs-lookup"><span data-stu-id="352de-127">Your application can provide users with the same familiar entry points to their data by enabling library awareness, and browsing.</span></span>

### <a name="collections-of-folders"></a><span data-ttu-id="352de-128">資料夾集合</span><span class="sxs-lookup"><span data-stu-id="352de-128">Collections of Folders</span></span>

<span data-ttu-id="352de-129">程式庫是使用者定義的內容集合。</span><span class="sxs-lookup"><span data-stu-id="352de-129">Libraries are user-defined collections of content.</span></span> <span data-ttu-id="352de-130">Windows Search 在程式庫中包含資料夾時，將支援的資料夾編制索引。</span><span class="sxs-lookup"><span data-stu-id="352de-130">Windows Search indexes supported folders when they are included in libraries.</span></span> <span data-ttu-id="352de-131">這可讓您立即搜尋，以及程式庫中以屬性為基礎的堆疊排列檢視。</span><span class="sxs-lookup"><span data-stu-id="352de-131">This enables instant search, and property-based stack arrangement views in libraries.</span></span>

### <a name="supported-folders-in-libraries"></a><span data-ttu-id="352de-132">程式庫中支援的資料夾</span><span class="sxs-lookup"><span data-stu-id="352de-132">Supported Folders in Libraries</span></span>

<span data-ttu-id="352de-133">針對程式庫中支援的資料夾，這些檔案必須可在本機電腦上編制索引，並在遠端 Windows 電腦上編制索引，或在伺服器上以 Windows Search 索引的檔案編制索引。</span><span class="sxs-lookup"><span data-stu-id="352de-133">For folders to be supported in libraries, they must be indexable on the local machine, and indexed either on a remote Windows machine, or indexed on a server with files indexed by Windows Search.</span></span>

<span data-ttu-id="352de-134">使用者無法在 [Windows 程式庫管理] 對話方塊中新增不支援的資料夾。</span><span class="sxs-lookup"><span data-stu-id="352de-134">Unsupported folders are blocked from being added by users in the Windows library management dialog.</span></span> <span data-ttu-id="352de-135">如果使用 [IShellLibrary](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishelllibrary) API 將非索引的遠端資料夾新增至程式庫，則程式庫使用者體驗會還原為程式庫 **安全模式**。</span><span class="sxs-lookup"><span data-stu-id="352de-135">If non-indexed remote folders are added to a library using the [IShellLibrary](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishelllibrary) API, then the library user experience will revert to library **Safe Mode**.</span></span> <span data-ttu-id="352de-136">在 **安全模式** 功能（例如屬性型堆疊排列檢視、篩選建議和 [ **開始] 功能表** 搜尋支援）會從受影響的程式庫中移除。</span><span class="sxs-lookup"><span data-stu-id="352de-136">In **Safe Mode** features such as property-based stack arrangement views, filter suggestions, and **Start Menu** search support are removed from the affected library.</span></span>

<span data-ttu-id="352de-137">下表列出使用 Windows 檔案總管程式庫管理對話方塊所包含的程式庫中的資料夾，以及 **安全模式** 中不支援的資料夾：</span><span class="sxs-lookup"><span data-stu-id="352de-137">The following table lists folders included in libraries using the Windows Explorer library management dialog, and folders that are unsupported in **Safe Mode**:</span></span>

| <span data-ttu-id="352de-138">支援的資料夾</span><span class="sxs-lookup"><span data-stu-id="352de-138">Supported Folders</span></span>                                                                                                                            | <span data-ttu-id="352de-139">不支援的資料夾</span><span class="sxs-lookup"><span data-stu-id="352de-139">Unsupported Folders</span></span>                                                                                     |
|----------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="352de-140">固定和外部 NTFS 和 FAT32 硬碟</span><span class="sxs-lookup"><span data-stu-id="352de-140">Fixed and external NTFS and FAT32 hard drives</span></span>                                                                                                | <span data-ttu-id="352de-141">抽取式磁碟機 (例如 thumbdrives 和 SD 卡) </span><span class="sxs-lookup"><span data-stu-id="352de-141">Removable drives (such as thumbdrives and SD cards)</span></span>                                                     |
| <span data-ttu-id="352de-142">由 Windows Search (編制索引的共用，例如部門伺服器，以及執行 Windows 10 的電腦和 Windows 7 Home edition) </span><span class="sxs-lookup"><span data-stu-id="352de-142">Shares that are indexed by Windows Search (such as departmental servers, and on computers running Windows 10, and Windows 7 Home edition)</span></span> | <span data-ttu-id="352de-143">卸除式媒體 (例如 Cd 和 Dvd) </span><span class="sxs-lookup"><span data-stu-id="352de-143">Removable media (such as CDs and DVDs)</span></span>                                                                  |
| <span data-ttu-id="352de-144">可離線 (的共用，例如重新 **導向我的檔**、 **用戶端** 快取) </span><span class="sxs-lookup"><span data-stu-id="352de-144">Shares that are available offline (such as **Redirected My Documents**, **Client Side Cache**)</span></span>                                               | <span data-ttu-id="352de-145">無法離線使用或遠端索引的網路共用 (例如 NAS 磁片磁碟機) </span><span class="sxs-lookup"><span data-stu-id="352de-145">Network shares that are neither available offline nor remotely indexed (such as NAS drives)</span></span>             |
| <span data-ttu-id="352de-146">n/a</span><span class="sxs-lookup"><span data-stu-id="352de-146">n/a</span></span>                                                                                                                                          | <span data-ttu-id="352de-147">其他資料來源 (例如 Microsoft SharePoint、Microsoft Exchange、Microsoft OneDrive 等) </span><span class="sxs-lookup"><span data-stu-id="352de-147">Other data sources (such as Microsoft SharePoint, Microsoft Exchange, Microsoft OneDrive, and so forth)</span></span> |

### <a name="storage-backed"></a><span data-ttu-id="352de-148">Storage-Backed</span><span class="sxs-lookup"><span data-stu-id="352de-148">Storage-Backed</span></span>

<span data-ttu-id="352de-149">程式庫是儲存體資料夾的集合。</span><span class="sxs-lookup"><span data-stu-id="352de-149">Libraries are collections of storage folders.</span></span> <span data-ttu-id="352de-150">使用者可以直接儲存檔案，並將檔案複製到文件庫，因為每個文件庫都有預設的儲存位置，可將這些檔案傳送到其中。</span><span class="sxs-lookup"><span data-stu-id="352de-150">Users can save and copy files to a library directly, since every library has a default save location to send these files to.</span></span> <span data-ttu-id="352de-151">針對預設程式庫，這是包含在程式庫中的使用者已知資料夾 (例如 **我的檔**) ，或新增至自訂程式庫的第一個資料夾。</span><span class="sxs-lookup"><span data-stu-id="352de-151">For default libraries, this is user Known Folder that is included in a library (such as **My Documents**), or the first folder added to a custom library.</span></span> <span data-ttu-id="352de-152">這是當使用者將檔案拖曳至文件庫，或使用 [一般檔案] 對話方塊儲存至程式庫時，檔案的所在資料夾。</span><span class="sxs-lookup"><span data-stu-id="352de-152">This is the folder where files go when a user drags and drops files on to a library or saves to a library with the common file dialog.</span></span> <span data-ttu-id="352de-153">使用者可以在任何時間點變更文件庫的預設儲存位置，但如果她移除預設的儲存位置，則會選取程式庫中的下一個資料夾做為新的儲存位置。</span><span class="sxs-lookup"><span data-stu-id="352de-153">The user may change the default save location of a library at any point, but if she removes the default save location, the next folder in the library will be selected as the new save location.</span></span> <span data-ttu-id="352de-154">使用者可以另外儲存至程式庫中已包含許可權的任何資料夾。</span><span class="sxs-lookup"><span data-stu-id="352de-154">Users can additionally save to any folder they have permissions to that has been included in a library.</span></span>

### <a name="non-file-system-shell-containers"></a><span data-ttu-id="352de-155">非檔案系統 Shell 容器</span><span class="sxs-lookup"><span data-stu-id="352de-155">Non-File System Shell Containers</span></span>

<span data-ttu-id="352de-156">程式庫可以包含檔案系統 Shell 容器（例如 **電腦** 和 **主控台**），但包含檔案系統專案。</span><span class="sxs-lookup"><span data-stu-id="352de-156">Libraries can contain on-file system Shell containers, such as **Computer** and **Control Panel**, but contain file system items.</span></span> <span data-ttu-id="352de-157">您可以使用舊版作業系統中檔案系統檔案和資料夾的 Api 來列舉和存取程式庫資料夾和內容。</span><span class="sxs-lookup"><span data-stu-id="352de-157">Library folders and contents can be enumerated and accessed using APIs for file system files and folders in previous operating systems.</span></span> <span data-ttu-id="352de-158">如果您的應用程式非常依賴檔案系統專屬的 Api，則可以使用 [IShellLibrary](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishelllibrary) API 來取得程式庫中資料夾和檔案的檔案系統路徑。</span><span class="sxs-lookup"><span data-stu-id="352de-158">If your application is heavily dependent on file system specific APIs, then the [IShellLibrary](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishelllibrary) API can be used to obtain the file system paths of folders and files within libraries.</span></span> <span data-ttu-id="352de-159">在大部分情況下，建議您使用 Shell 程式設計模型，以支援多個 Windows 版本和專案彈性。</span><span class="sxs-lookup"><span data-stu-id="352de-159">In most cases it is recommended that you use the Shell programming model to support multiple Windows versions and item flexibility.</span></span> <span data-ttu-id="352de-160">如需詳細資訊，請參閱 [流覽 Shell 命名空間](https://msdn.microsoft.com/library/dd378496(VS.85).aspx)。</span><span class="sxs-lookup"><span data-stu-id="352de-160">For more information, see [Navigating the Shell Namespace](https://msdn.microsoft.com/library/dd378496(VS.85).aspx).</span></span>

### <a name="library-descriptions"></a><span data-ttu-id="352de-161">程式庫描述</span><span class="sxs-lookup"><span data-stu-id="352de-161">Library Descriptions</span></span>

<span data-ttu-id="352de-162">程式庫描述會以 XML 檔案的形式儲存在% appdata% Microsoft \\ Windows library \\ 資料夾 (中，而且可能會以 **FOLDERID 連結 \_ 庫** 的形式儲存在磁片上。</span><span class="sxs-lookup"><span data-stu-id="352de-162">Library descriptions are saved on disk as an XML file in the %appdata%Microsoft\\Windows\\Libraries folder (and potentially as **FOLDERID\_Libraries**.</span></span> <span data-ttu-id="352de-163">如需 FOLDERID 連結 **\_ 庫** 的詳細資訊，請參閱 [KNOWNFOLDERID](/windows/desktop/shell/knownfolderid)。</span><span class="sxs-lookup"><span data-stu-id="352de-163">For more information about **FOLDERID\_Libraries**, see [KNOWNFOLDERID](/windows/desktop/shell/knownfolderid).</span></span>

<span data-ttu-id="352de-164">程式庫說明檔是副檔名為 library-ms 的 XML 檔。</span><span class="sxs-lookup"><span data-stu-id="352de-164">Library description files are XML files with the file name extension .library-ms.</span></span> <span data-ttu-id="352de-165">應用程式永遠不能存取或編輯這些檔案。</span><span class="sxs-lookup"><span data-stu-id="352de-165">They files should never be accessed or edited by applications.</span></span> <span data-ttu-id="352de-166">保存在程式庫描述檔案中的資料夾路徑文字不一定是最新的。</span><span class="sxs-lookup"><span data-stu-id="352de-166">The folder path text persisted to the library description files is not always current.</span></span> <span data-ttu-id="352de-167">程式庫資料夾會以序列化的二進位 [Shell 連結](/windows/desktop/shell/links) 格式保存在程式庫描述檔案中。</span><span class="sxs-lookup"><span data-stu-id="352de-167">Library folders are persisted in the library description file in the serialized binary [Shell Links](/windows/desktop/shell/links) format.</span></span> <span data-ttu-id="352de-168">如需程式庫和程式庫描述架構的詳細資訊，請參閱連結 [庫描述架構](../shell/library-schema-entry.md)。</span><span class="sxs-lookup"><span data-stu-id="352de-168">For more information about libraries and the Library Description schema, see [Library Description Schema](../shell/library-schema-entry.md).</span></span> <span data-ttu-id="352de-169">如需同盟搜尋連接器和搜尋連接器描述架構的詳細資訊，請 [搜尋連接器描述架構](search-sconn-desc-schema-entry.md)。</span><span class="sxs-lookup"><span data-stu-id="352de-169">For more information about federated search connectors and the Search Connector Description schema, [Search Connector Description Schema](search-sconn-desc-schema-entry.md).</span></span>

> <span data-ttu-id="352de-170">[注意]</span><span class="sxs-lookup"><span data-stu-id="352de-170">[NOTE]</span></span>  
> <span data-ttu-id="352de-171">應用程式應該一律使用 Shell 程式設計模型或 [IShellLibrary](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishelllibrary) API 來取用和操作程式庫內容，而且永遠不會嘗試手動存取或編輯程式庫描述檔案。</span><span class="sxs-lookup"><span data-stu-id="352de-171">Applications should always use the Shell programming model or the [IShellLibrary](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishelllibrary) API to consume and manipulate library contents, and never attempt to manually access or edit the library description file.</span></span>

## <a name="related-topics"></a><span data-ttu-id="352de-172">相關主題</span><span class="sxs-lookup"><span data-stu-id="352de-172">Related topics</span></span>

[<span data-ttu-id="352de-173">Windows 7 搜尋</span><span class="sxs-lookup"><span data-stu-id="352de-173">Windows 7 Search</span></span>](./-search-3x-wds-overview.md)

[<span data-ttu-id="352de-174">適用于 Windows 7 搜尋的新</span><span class="sxs-lookup"><span data-stu-id="352de-174">New for Windows 7 Search</span></span>](new-for-windows-7-search.md)

[<span data-ttu-id="352de-175">在 Windows 7 中編制優先順序和資料列集事件的索引</span><span class="sxs-lookup"><span data-stu-id="352de-175">Indexing Prioritization and Rowset Events in Windows 7</span></span>](indexing-prioritization-and-rowset-events.md)