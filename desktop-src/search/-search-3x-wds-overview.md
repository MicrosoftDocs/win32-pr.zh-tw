---
description: Windows Search 是一種桌面搜尋平臺，具有最常見檔案類型和資料類型的即時搜尋功能，而協力廠商開發人員可以將這些功能延伸到新的檔案類型和資料類型。
ms.assetid: 6da601c6-3742-40ad-99f2-8817f7f642b3
title: Windows Search 概觀
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: cee4cde62ce663c47ab4cafac0c74ca220fe6faf
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/07/2021
ms.locfileid: "103847823"
---
# <a name="windows-search-overview"></a><span data-ttu-id="14f7d-103">Windows Search 概觀</span><span class="sxs-lookup"><span data-stu-id="14f7d-103">Windows Search Overview</span></span>

<span data-ttu-id="14f7d-104">Windows Search 是一種桌面搜尋平臺，具有最常見檔案類型和資料類型的即時搜尋功能，而協力廠商開發人員可以將這些功能延伸到新的檔案類型和資料類型。</span><span class="sxs-lookup"><span data-stu-id="14f7d-104">Windows Search is a desktop search platform that has instant search capabilities for most common file types and data types, and third-party developers can extend these capabilities to new file types and data types.</span></span>

<span data-ttu-id="14f7d-105">本主題的組織方式如下：</span><span class="sxs-lookup"><span data-stu-id="14f7d-105">This topic is organized as follows:</span></span>

-   [<span data-ttu-id="14f7d-106">簡介</span><span class="sxs-lookup"><span data-stu-id="14f7d-106">Introduction</span></span>](#introduction)
    -   [<span data-ttu-id="14f7d-107">Windows Search 服務</span><span class="sxs-lookup"><span data-stu-id="14f7d-107">Windows Search Service</span></span>](#windows-search-service)
    -   [<span data-ttu-id="14f7d-108">開發平臺</span><span class="sxs-lookup"><span data-stu-id="14f7d-108">Development Platform</span></span>](#development-platform)
    -   [<span data-ttu-id="14f7d-109">消費者介面</span><span class="sxs-lookup"><span data-stu-id="14f7d-109">User Interface</span></span>](#user-interface)
-   [<span data-ttu-id="14f7d-110">技術性必要條件</span><span class="sxs-lookup"><span data-stu-id="14f7d-110">Technical Prerequisites</span></span>](#technical-prerequisites)
    -   [<span data-ttu-id="14f7d-111">SDK 下載和內容</span><span class="sxs-lookup"><span data-stu-id="14f7d-111">SDK Download and Contents</span></span>](#sdk-download-and-contents)
-   [<span data-ttu-id="14f7d-112">Windows Search SDK 檔</span><span class="sxs-lookup"><span data-stu-id="14f7d-112">Windows Search SDK Documentation</span></span>](#windows-search-sdk-documentation)
-   [<span data-ttu-id="14f7d-113">Windows Search 的歷程記錄</span><span class="sxs-lookup"><span data-stu-id="14f7d-113">History of Windows Search</span></span>](#history-of-windows-search)
-   [<span data-ttu-id="14f7d-114">其他資源</span><span class="sxs-lookup"><span data-stu-id="14f7d-114">Additional Resources</span></span>](#additional-resources)
-   [<span data-ttu-id="14f7d-115">相關主題</span><span class="sxs-lookup"><span data-stu-id="14f7d-115">Related topics</span></span>](#related-topics)

## <a name="introduction"></a><span data-ttu-id="14f7d-116">簡介</span><span class="sxs-lookup"><span data-stu-id="14f7d-116">Introduction</span></span>

<span data-ttu-id="14f7d-117">Windows Search 是 Windows 7 和 Windows Vista 的標準元件，預設為啟用。</span><span class="sxs-lookup"><span data-stu-id="14f7d-117">Windows Search is a standard component of Windows 7 and Windows Vista, and is enabled by default.</span></span> <span data-ttu-id="14f7d-118">Windows Search 取代 Windows 桌面搜尋 (WDS) （以 Windows XP 和 Windows Server 2003 的增益集的形式提供）。</span><span class="sxs-lookup"><span data-stu-id="14f7d-118">Windows Search replaces Windows Desktop Search (WDS), which was available as an add-in for Windows XP and Windows Server 2003.</span></span>

<span data-ttu-id="14f7d-119">Windows Search 是由三個元件所組成：</span><span class="sxs-lookup"><span data-stu-id="14f7d-119">Windows Search is composed of three components:</span></span>

-   <span data-ttu-id="14f7d-120">[Windows Search 服務](#windows-search-service) (WSS) </span><span class="sxs-lookup"><span data-stu-id="14f7d-120">[Windows Search Service](#windows-search-service) (WSS)</span></span>
-   [<span data-ttu-id="14f7d-121">開發平台</span><span class="sxs-lookup"><span data-stu-id="14f7d-121">Development platform</span></span>](#development-platform)
-   <span data-ttu-id="14f7d-122">[User Interface](#user-interface) (使用者介面)</span><span class="sxs-lookup"><span data-stu-id="14f7d-122">[User interface](#user-interface)</span></span>

### <a name="windows-search-service"></a><span data-ttu-id="14f7d-123">Windows Search 服務</span><span class="sxs-lookup"><span data-stu-id="14f7d-123">Windows Search Service</span></span>

<span data-ttu-id="14f7d-124">WSS 會組織檔集合的已解壓縮功能。</span><span class="sxs-lookup"><span data-stu-id="14f7d-124">The WSS organizes the extracted features of a collection of documents.</span></span> <span data-ttu-id="14f7d-125">Windows Search 通訊協定可讓用戶端與裝載 WSS 的伺服器通訊，以發出查詢並讓系統管理員管理索引伺服器。</span><span class="sxs-lookup"><span data-stu-id="14f7d-125">The Windows Search Protocol enables a client to communicate with a server that is hosting a WSS, both to issue queries and to enable an administrator to manage the indexing server.</span></span> <span data-ttu-id="14f7d-126">處理檔案時，WSS 會分析一組檔、解壓縮有用的資訊，然後組織解壓縮的資訊，以便有效率地傳回這些檔的屬性來回應查詢。</span><span class="sxs-lookup"><span data-stu-id="14f7d-126">When processing files, WSS analyzes a set of documents, extracts useful information, and then organizes the extracted information so that properties of those documents can be efficiently returned in response to queries.</span></span>

<span data-ttu-id="14f7d-127">可以查詢的檔集合包含目錄，也就是 Windows Search 中最高層級的組織單位。</span><span class="sxs-lookup"><span data-stu-id="14f7d-127">A collection of documents that can be queried comprises a catalog, which is the highest-level unit of organization in Windows Search.</span></span> <span data-ttu-id="14f7d-128">目錄代表一組可以查詢的索引檔。</span><span class="sxs-lookup"><span data-stu-id="14f7d-128">A catalog represents a set of indexed documents that can be queried.</span></span> <span data-ttu-id="14f7d-129">目錄包含具有文字或值的屬性資料表，以及 (地區設定) 儲存在資料表資料行中的對應位置。</span><span class="sxs-lookup"><span data-stu-id="14f7d-129">A catalog consists of a properties table with the text or value and corresponding location (locale) stored in columns of the table.</span></span> <span data-ttu-id="14f7d-130">資料表的每個資料列都會對應至目錄範圍中的個別檔，而且資料表的每個資料行都會對應至屬性。</span><span class="sxs-lookup"><span data-stu-id="14f7d-130">Each row of the table corresponds to a separate document in the scope of the catalog, and each column of the table corresponds to a property.</span></span> <span data-ttu-id="14f7d-131">目錄可能包含反向的索引 (，以供快速文字比對) 和屬性快取 (快速抓取屬性值) 。</span><span class="sxs-lookup"><span data-stu-id="14f7d-131">A catalog may contain an inverted index (for quick word matching) and a property cache (for quick retrieval of property values).</span></span>

<span data-ttu-id="14f7d-132">索引子進程會實作為在 LocalSystem 帳戶中執行的 Windows 服務，而且一律會為所有使用者執行 (即使沒有任何使用者登入) ，也會允許 Windows Search 完成下列作業：</span><span class="sxs-lookup"><span data-stu-id="14f7d-132">The indexer process is implemented as a Windows service running in the LocalSystem account and is always running for all users (even if no user is logged in), which permits Windows Search to accomplish the following:</span></span>

-   <span data-ttu-id="14f7d-133">維護一個在所有使用者之間共用的索引。</span><span class="sxs-lookup"><span data-stu-id="14f7d-133">Maintain one index that is shared among all users.</span></span>
-   <span data-ttu-id="14f7d-134">維護內容存取的安全性限制。</span><span class="sxs-lookup"><span data-stu-id="14f7d-134">Maintain security restrictions on content access.</span></span>
-   <span data-ttu-id="14f7d-135">從網路上的用戶端電腦處理遠端查詢。</span><span class="sxs-lookup"><span data-stu-id="14f7d-135">Process remote queries from client computers on the network.</span></span>

<span data-ttu-id="14f7d-136">搜尋服務的設計目的是要在編制索引時保護使用者體驗和系統效能。</span><span class="sxs-lookup"><span data-stu-id="14f7d-136">The Search service is designed to protect the user experience and system performance when indexing.</span></span> <span data-ttu-id="14f7d-137">下列情況會導致服務重新節流或暫停索引：</span><span class="sxs-lookup"><span data-stu-id="14f7d-137">The following conditions cause the service to throttle back or pause indexing:</span></span>

-   <span data-ttu-id="14f7d-138">非搜尋相關進程的高 CPU 使用率。</span><span class="sxs-lookup"><span data-stu-id="14f7d-138">High CPU usage by non-search-related processes.</span></span>
-   <span data-ttu-id="14f7d-139">高系統 i/o 速率，包括檔案讀取和寫入、分頁檔案和檔案快取 i/o，以及對應的檔案 i/o。</span><span class="sxs-lookup"><span data-stu-id="14f7d-139">High system I/O rate including file reads and writes, page file and file cache I/O, and mapped file I/O.</span></span>
-   <span data-ttu-id="14f7d-140">記憶體不足的可用性。</span><span class="sxs-lookup"><span data-stu-id="14f7d-140">Low memory availability.</span></span>
-   <span data-ttu-id="14f7d-141">電池壽命偏低。</span><span class="sxs-lookup"><span data-stu-id="14f7d-141">Low battery life.</span></span>
-   <span data-ttu-id="14f7d-142">儲存索引之磁片磁碟機上的磁碟空間不足。</span><span class="sxs-lookup"><span data-stu-id="14f7d-142">Low disk space on the drive that stores the index.</span></span>

### <a name="development-platform"></a><span data-ttu-id="14f7d-143">開發平台</span><span class="sxs-lookup"><span data-stu-id="14f7d-143">Development Platform</span></span>

<span data-ttu-id="14f7d-144">存取搜尋 Api 和建立 Windows Search 應用程式的慣用方法是透過 Shell 資料來源。</span><span class="sxs-lookup"><span data-stu-id="14f7d-144">The preferred way to access the Search APIs and create Windows Search applications is through a Shell data source.</span></span> <span data-ttu-id="14f7d-145">Shell 資料來源是一種元件，用來擴充 Shell 命名空間，並公開資料存放區中的專案。</span><span class="sxs-lookup"><span data-stu-id="14f7d-145">A Shell data source is a component that is used to extend the Shell namespace and expose items in a data store.</span></span> <span data-ttu-id="14f7d-146">資料存放區是資料的儲存機制。</span><span class="sxs-lookup"><span data-stu-id="14f7d-146">A data store is a repository of data.</span></span> <span data-ttu-id="14f7d-147">資料存放區可公開給 Shell 程式設計模型，作為使用 Shell 資料來源的容器。</span><span class="sxs-lookup"><span data-stu-id="14f7d-147">A data store can be exposed to the Shell programming model as a container that uses a Shell data source.</span></span> <span data-ttu-id="14f7d-148">您可以使用通訊協定處理常式，利用 Windows Search 系統為數據存放區中的專案編制索引。</span><span class="sxs-lookup"><span data-stu-id="14f7d-148">The items in a data store can be indexed by the Windows Search system using a protocol handler.</span></span>

<span data-ttu-id="14f7d-149">例如， [ISearchFolderItemFactory](/windows/win32/api/shobjidl_core/nn-shobjidl_core-isearchfolderitemfactory) 是一個元件，可建立搜尋資料夾資料來源的實例，這是由 shell 所提供的一種「虛擬」資料來源，可對 shell 命名空間中的其他資料來源執行查詢並列舉結果。</span><span class="sxs-lookup"><span data-stu-id="14f7d-149">For example, [ISearchFolderItemFactory](/windows/win32/api/shobjidl_core/nn-shobjidl_core-isearchfolderitemfactory) is a component that can create instances of the search folder data source, which is a sort of "virtual" data source provided by the Shell that can execute queries over other data sources in the Shell namespace and enumerate results.</span></span> <span data-ttu-id="14f7d-150">它可以藉由使用索引子，或手動列舉和檢查指定範圍中的專案來完成。</span><span class="sxs-lookup"><span data-stu-id="14f7d-150">It can do so either by using the indexer or by manually enumerating and inspecting items in the specified scopes.</span></span> <span data-ttu-id="14f7d-151">此介面可讓您使用可建立和修改搜尋資料夾的方法來設定搜尋的參數。</span><span class="sxs-lookup"><span data-stu-id="14f7d-151">This interface permits you to set up the parameters of the search by using methods that create and modify search folders.</span></span> <span data-ttu-id="14f7d-152">如果未呼叫這個介面的方法，則會改用預設值。</span><span class="sxs-lookup"><span data-stu-id="14f7d-152">If methods of this interface are not called, default values are used instead.</span></span>

<span data-ttu-id="14f7d-153">最好透過 Shell 資料模型來間接存取 Windows Search 功能，因為它可讓您存取 Shell 資料模型層級的完整 Shell 功能。</span><span class="sxs-lookup"><span data-stu-id="14f7d-153">Accessing the Windows Search capability indirectly through the Shell data model is preferred because it provides access to full Shell functionality at the level of the Shell data model.</span></span> <span data-ttu-id="14f7d-154">例如，您可以將搜尋範圍設定為程式庫 (這是 Windows 7 和更新版本中可用的功能) 使用程式庫資料夾做為查詢的範圍。</span><span class="sxs-lookup"><span data-stu-id="14f7d-154">For example, you can set the scope of a search to a library (which is a feature available in Windows 7 and later) to use the library folders as the scope of the query.</span></span> <span data-ttu-id="14f7d-155">如果資料夾位於不同的電腦) ，Windows Search 接著會匯總這些位置的搜尋結果（如果這些位置位於不同的索引 (）。</span><span class="sxs-lookup"><span data-stu-id="14f7d-155">Windows Search then aggregates the search results from those locations if they are in different indexes (if the folders are on different computers).</span></span> <span data-ttu-id="14f7d-156">Shell 資料層也會建立更完整的專案屬性視圖，合成某些屬性值。</span><span class="sxs-lookup"><span data-stu-id="14f7d-156">The Shell data layer also creates a more complete view of items' properties, synthesizing some property values.</span></span> <span data-ttu-id="14f7d-157">它也可讓您存取未依 Windows Search 編制索引之資料存放區的搜尋功能。</span><span class="sxs-lookup"><span data-stu-id="14f7d-157">It also provides access to search features for data stores that are not indexed by Windows Search.</span></span> <span data-ttu-id="14f7d-158">例如，您可以搜尋通用序列匯流排 (USB) 儲存裝置、使用 MTP 通訊協定的可攜式裝置，或透過可存取這些儲存體系統的 Shell 資料來源檔案傳輸通訊協定 (FTP) 伺服器。</span><span class="sxs-lookup"><span data-stu-id="14f7d-158">For example, you can search a Universal Serial Bus (USB) storage devices, portable device that uses the MTP protocol, or an File Transfer Protocol (FTP) server through the Shell data sources that provides access to those storage systems.</span></span> <span data-ttu-id="14f7d-159">這樣做可確保更好的使用者體驗。</span><span class="sxs-lookup"><span data-stu-id="14f7d-159">Doing so ensures a better user experience.</span></span>

<span data-ttu-id="14f7d-160">Windows Search 具有屬性值的快取，用於在 Windows Search 服務 (WSS) 中執行。</span><span class="sxs-lookup"><span data-stu-id="14f7d-160">Windows Search has a cache of property values that is used in the implementation of the Windows Search Service (WSS).</span></span> <span data-ttu-id="14f7d-161">您可以使用 Windows Search OLE DB 提供者或透過 [ISearchFolderItemFactory](/windows/win32/api/shobjidl_core/nn-shobjidl_core-isearchfolderitemfactory)（代表搜尋結果和查詢型視圖中的專案），以程式設計方式查詢這些屬性值。</span><span class="sxs-lookup"><span data-stu-id="14f7d-161">These property values can be programmatically queried by using the Windows Search OLE DB provider, or through [ISearchFolderItemFactory](/windows/win32/api/shobjidl_core/nn-shobjidl_core-isearchfolderitemfactory), which represents items in search results and query-based views.</span></span> <span data-ttu-id="14f7d-162">然後，Windows Search 會在建立檔（例如 Word 檔）的索引時，收集並儲存由篩選處理常式或屬性處理常式所發出的屬性。</span><span class="sxs-lookup"><span data-stu-id="14f7d-162">Windows Search then collects and stores properties emitted by filter handlers or property handlers when an item such as a Word document is indexed.</span></span> <span data-ttu-id="14f7d-163">重建索引時，會捨棄並重建此存放區。</span><span class="sxs-lookup"><span data-stu-id="14f7d-163">This store is discarded and rebuilt when the index is rebuilt.</span></span>

<span data-ttu-id="14f7d-164">協力廠商開發人員可以建立應用程式，以透過程式設計方式查詢來取用索引中的資料，而且可以在索引中擴充自訂檔案和專案類型的資料，以 Windows Search 來編制索引。</span><span class="sxs-lookup"><span data-stu-id="14f7d-164">Third-party developers can create applications that consume the data in the index through programmatic queries, and can extend the data in the index for custom file and item types to be indexed by Windows Search.</span></span> <span data-ttu-id="14f7d-165">如果您想要在 Windows 檔案總管中顯示查詢結果，您必須先執行 Shell 資料來源，才能建立通訊協定處理常式來擴充索引。</span><span class="sxs-lookup"><span data-stu-id="14f7d-165">If you want to show query results in Windows Explorer, you must implement a Shell data source before you can create a protocol handler to extend the index.</span></span> <span data-ttu-id="14f7d-166">但是，如果所有查詢都是以程式設計方式 (透過 OLE DB 例如) ，並由應用程式的程式碼（而非 Shell）所解釋，則 Shell 命名空間仍是慣用的，但並非必要。</span><span class="sxs-lookup"><span data-stu-id="14f7d-166">However, if all queries are programmatic (through OLE DB for example) and interpreted by the application's code rather than the Shell, a Shell namespace is still preferred but not required.</span></span>

<span data-ttu-id="14f7d-167">需要有通訊協定處理常式，Windows 才能取得檔案內容的相關資訊，例如資料庫或自訂檔案類型中的專案。</span><span class="sxs-lookup"><span data-stu-id="14f7d-167">A protocol handler is required for Windows to obtain information about file contents, such as items in databases or custom file types.</span></span> <span data-ttu-id="14f7d-168">雖然 Windows Search 可以為檔案的名稱和屬性編制索引，但 Windows 沒有檔案內容的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="14f7d-168">While Windows Search can index the name and properties of the file, Windows has no information about the content of the file.</span></span> <span data-ttu-id="14f7d-169">如此一來，就無法在 Windows Shell 中建立索引或公開這類專案。</span><span class="sxs-lookup"><span data-stu-id="14f7d-169">As a result, such items cannot be indexed or exposed in the Windows Shell.</span></span> <span data-ttu-id="14f7d-170">藉由執行自訂通訊協定處理常式，您可以公開這些專案。</span><span class="sxs-lookup"><span data-stu-id="14f7d-170">By implementing a custom protocol handler, you can expose these items.</span></span> <span data-ttu-id="14f7d-171">如需您嘗試達成之開發人員案例所識別的處理常式清單，請參閱 Windows Search 中的「處理常式總覽」 [作為開發平臺](-search-3x-wds-development-ovr.md)。</span><span class="sxs-lookup"><span data-stu-id="14f7d-171">For a list of handlers identified by the developer scenario you are trying to achieve, see "Overview of Handlers" in [Windows Search as a Development Platform](-search-3x-wds-development-ovr.md).</span></span>

> [!Note]  
> <span data-ttu-id="14f7d-172">Shell 資料來源有時也稱為 Shell 命名空間延伸模組。</span><span class="sxs-lookup"><span data-stu-id="14f7d-172">A Shell data source is sometimes known as a Shell namespace extension.</span></span> <span data-ttu-id="14f7d-173">處理常式有時也稱為 Shell 擴充或 Shell 擴充處理常式。</span><span class="sxs-lookup"><span data-stu-id="14f7d-173">A handler is sometimes known as a Shell extension or a Shell extension handler.</span></span>

 

### <a name="user-interface"></a><span data-ttu-id="14f7d-174">使用者介面</span><span class="sxs-lookup"><span data-stu-id="14f7d-174">User Interface</span></span>

<span data-ttu-id="14f7d-175">在 Windows Vista 和更新版本中，Windows Search 已整合到所有 Windows 檔案總管的視窗中，以便立即存取搜尋。</span><span class="sxs-lookup"><span data-stu-id="14f7d-175">In Windows Vista and later, Windows Search is integrated into all Windows Explorer windows for instant access to search.</span></span> <span data-ttu-id="14f7d-176">這可讓使用者依檔案名、屬性和全文檢索內容，快速搜尋檔案和專案。</span><span class="sxs-lookup"><span data-stu-id="14f7d-176">This enables users to quickly search for files and items by file name, properties, and full-text contents.</span></span> <span data-ttu-id="14f7d-177">也可以進一步篩選結果以精簡搜尋。</span><span class="sxs-lookup"><span data-stu-id="14f7d-177">Results can also be filtered further to refine the search.</span></span> <span data-ttu-id="14f7d-178">以下是 Windows Search 的一些功能：</span><span class="sxs-lookup"><span data-stu-id="14f7d-178">Here are some more features of Windows Search:</span></span>

-   <span data-ttu-id="14f7d-179">每個視窗中的 [立即搜尋] 方塊可讓您立即篩選目前正在觀看的所有專案。</span><span class="sxs-lookup"><span data-stu-id="14f7d-179">An instant search box in every window enables instant filtering of all items currently in view.</span></span> <span data-ttu-id="14f7d-180">[立即搜尋] 方塊會出現在 [[開始] 功能表] 中，以搜尋程式或檔案，而且在所有 Windows 檔案總管視窗的右上角，以篩選顯示的結果。</span><span class="sxs-lookup"><span data-stu-id="14f7d-180">Instant search boxes appear in the Start menu to search for programs or files, and in the upper-right corner of all Windows Explorer windows to filter the results shown.</span></span> <span data-ttu-id="14f7d-181">即時搜尋也會整合到一些其他的 Windows 功能（例如 Windows Media Player），以尋找相關的檔案。</span><span class="sxs-lookup"><span data-stu-id="14f7d-181">Instant search is also integrated into some other Windows features, such as Windows Media Player, to find related files.</span></span>
-   <span data-ttu-id="14f7d-182">您可以使用關鍵字標記檔，以依使用者定義的自訂準則將它們分組。</span><span class="sxs-lookup"><span data-stu-id="14f7d-182">Documents can be tagged with keywords to group them by custom criteria that are defined by the user.</span></span> <span data-ttu-id="14f7d-183">標記是使用者或應用程式所指派的中繼資料專案，可讓您更輕鬆地根據可能不在專案名稱或內容中的關鍵字尋找檔案。</span><span class="sxs-lookup"><span data-stu-id="14f7d-183">Tags are metadata items that are assigned by the user or applications to make it easier to find files based on keywords that may not be in the item name or contents.</span></span> <span data-ttu-id="14f7d-184">例如，可能會將一組圖片標示為「亞利桑那州假期2009」，以便在之後藉由搜尋任何包含的文字來快速取回。</span><span class="sxs-lookup"><span data-stu-id="14f7d-184">For example, a set of pictures might be tagged as "Arizona Vacation 2009" to quickly retrieve later by searching for any of the included words.</span></span>
-   <span data-ttu-id="14f7d-185">Windows 檔案總管 views 中增強的資料行標頭可讓您以不同的方式排序和分組檔。</span><span class="sxs-lookup"><span data-stu-id="14f7d-185">Enhanced column headers in Windows Explorer views enable sorting and grouping documents in different ways.</span></span> <span data-ttu-id="14f7d-186">例如，您可以根據名稱、修改日期、類型、大小和標記來排序檔案。</span><span class="sxs-lookup"><span data-stu-id="14f7d-186">For example, files can be sorted according to name, date modified, type, size, and tags.</span></span> <span data-ttu-id="14f7d-187">檔也可以根據這些屬性來分組，而且每個群組可依需要 (隱藏或顯示) 篩選。</span><span class="sxs-lookup"><span data-stu-id="14f7d-187">Documents can also be grouped according to any of these properties and each group can be filtered (hidden or displayed) as desired.</span></span>
-   <span data-ttu-id="14f7d-188">您可以根據名稱、修改日期、類型、大小和標記來堆疊檔。</span><span class="sxs-lookup"><span data-stu-id="14f7d-188">Documents can be stacked according to name, date modified, type, size, and tags.</span></span> <span data-ttu-id="14f7d-189">堆疊包括具有指定屬性的所有檔，並位於所選資料夾的任何子資料夾內。</span><span class="sxs-lookup"><span data-stu-id="14f7d-189">Stacks include all documents that have the specified property and are located within any subfolder of the selected folder.</span></span>
-   <span data-ttu-id="14f7d-190">您可以在 Windows 檔案總管的 [搜尋] 窗格中按一下 [ **儲存搜尋** ] 按鈕，將搜尋儲存 (稍後) 。</span><span class="sxs-lookup"><span data-stu-id="14f7d-190">Searches can be saved (to be retrieved later) by clicking the **Save Search** button in the search pane in Windows Explorer.</span></span> <span data-ttu-id="14f7d-191">結果會在開啟儲存的搜尋時，根據原始準則進行動態重新擴展。</span><span class="sxs-lookup"><span data-stu-id="14f7d-191">The results will be dynamically repopulated based on the original criteria when the saved search is opened.</span></span> <span data-ttu-id="14f7d-192">如需相關指示，請參閱 [儲存您的搜尋結果](https://windows.microsoft.com/windows-vista/Save-your-search-results)。</span><span class="sxs-lookup"><span data-stu-id="14f7d-192">For instructions, see [Save Your Search Results](https://windows.microsoft.com/windows-vista/Save-your-search-results).</span></span>
-   <span data-ttu-id="14f7d-193">預覽處理常式和縮圖處理常式可讓使用者預覽 Windows 檔案總管中的檔，而不需要開啟建立它們的應用程式。</span><span class="sxs-lookup"><span data-stu-id="14f7d-193">Preview handlers and thumbnail handlers enable users to preview documents in Windows Explorer without having to open the application that created them.</span></span>

## <a name="technical-prerequisites"></a><span data-ttu-id="14f7d-194">技術性必要條件</span><span class="sxs-lookup"><span data-stu-id="14f7d-194">Technical Prerequisites</span></span>

<span data-ttu-id="14f7d-195">開始閱讀 Windows Search SDK 檔之前，您應該先對下列概念有基本瞭解：</span><span class="sxs-lookup"><span data-stu-id="14f7d-195">Before you start reading the Windows Search SDK documentation, you should have a fundamental understanding of the following concepts:</span></span>

-   <span data-ttu-id="14f7d-196">如何執行 Shell 資料來源。</span><span class="sxs-lookup"><span data-stu-id="14f7d-196">How to implement a Shell data source.</span></span>
-   <span data-ttu-id="14f7d-197">如何執行處理常式。</span><span class="sxs-lookup"><span data-stu-id="14f7d-197">How to implement a handler.</span></span>
-   <span data-ttu-id="14f7d-198">如何使用原生程式碼。</span><span class="sxs-lookup"><span data-stu-id="14f7d-198">How to work in native code.</span></span>

<span data-ttu-id="14f7d-199">Shell 資料來源是一種元件，用來擴充 Shell 命名空間，並公開資料存放區中的專案。</span><span class="sxs-lookup"><span data-stu-id="14f7d-199">A Shell data source is a component that is used to extend the Shell namespace and expose items in a data store.</span></span> <span data-ttu-id="14f7d-200">在過去，Shell 資料來源稱為 Shell 命名空間延伸模組。</span><span class="sxs-lookup"><span data-stu-id="14f7d-200">In the past, the Shell data source was referred to as the Shell namespace extension.</span></span> <span data-ttu-id="14f7d-201">處理常式是元件物件模型 (COM) 物件，可提供 Shell 專案的功能。</span><span class="sxs-lookup"><span data-stu-id="14f7d-201">A handler is a Component Object Model (COM) object that provides functionality for a Shell item.</span></span> <span data-ttu-id="14f7d-202">如需您嘗試達成之開發人員案例所識別的處理常式清單，請參閱 Windows Search 中的「處理常式總覽」 [作為開發平臺](-search-3x-wds-development-ovr.md)。</span><span class="sxs-lookup"><span data-stu-id="14f7d-202">For a list of handlers identified by the developer scenario you are trying to achieve, see "Overview of Handlers" in [Windows Search as a Development Platform](-search-3x-wds-development-ovr.md).</span></span>

<span data-ttu-id="14f7d-203">如需 Windows Search SDK 互通性元件的詳細資訊，以使用 Windows Search 所公開的 COM 物件以及其他使用 managed 程式碼的程式，請參閱 [使用 managed 程式碼搭配 Shell 資料和 Windows Search](-search-3x-wds-managed-code.md)。</span><span class="sxs-lookup"><span data-stu-id="14f7d-203">For more information about the Windows Search SDK interoperability assembly for working with COM objects that are exposed by Windows Search and other programs that use managed code, see [Using Managed Code with Shell Data and Windows Search](-search-3x-wds-managed-code.md).</span></span> <span data-ttu-id="14f7d-204">不過，請注意，篩選準則、屬性處理常式和通訊協定處理常式必須以機器碼撰寫。</span><span class="sxs-lookup"><span data-stu-id="14f7d-204">However, note that filters, property handlers, and protocol handlers must be written in native code.</span></span> <span data-ttu-id="14f7d-205">這是因為可能的 common language runtime (CLR) 在中執行多個增益集的進程的版本控制問題。</span><span class="sxs-lookup"><span data-stu-id="14f7d-205">This is due to potential common language runtime (CLR) versioning issues with the process that multiple add-ins run in.</span></span> <span data-ttu-id="14f7d-206">剛開始使用 c + + 的開發人員可以從 [Visual C++ 開發人員中心](https://msdn.microsoft.com/vstudio//default.aspx) 和 [Windows 開發開始使用](../desktop-programming.md)開始著手。</span><span class="sxs-lookup"><span data-stu-id="14f7d-206">Developers who are new to C++ can get started with the [Visual C++ Developer Center](https://msdn.microsoft.com/vstudio//default.aspx) and [Windows Development Getting Started](../desktop-programming.md).</span></span>

### <a name="sdk-download-and-contents"></a><span data-ttu-id="14f7d-207">SDK 下載和內容</span><span class="sxs-lookup"><span data-stu-id="14f7d-207">SDK Download and Contents</span></span>

<span data-ttu-id="14f7d-208">除了符合所列的技術先決條件之外，您還必須下載 [Windows SDK](https://msdn.microsoft.com/windowsvista/bb980924.aspx) 以取得 Windows Search 程式庫。</span><span class="sxs-lookup"><span data-stu-id="14f7d-208">In addition to meeting the listed technical prerequirements, you must also download the [Windows SDK](https://msdn.microsoft.com/windowsvista/bb980924.aspx) to get the Windows Search libraries.</span></span> <span data-ttu-id="14f7d-209">[WINDOWS SEARCH SDK 範例](https://www.microsoft.com/downloads/details.aspx?FamilyID=645300AE-5E7A-4CE7-95F0-49793F8F76E8)包含實用的程式碼範例和互通性元件，可供使用 managed 程式碼進行開發。</span><span class="sxs-lookup"><span data-stu-id="14f7d-209">The [Windows Search SDK Samples](https://www.microsoft.com/downloads/details.aspx?FamilyID=645300AE-5E7A-4CE7-95F0-49793F8F76E8) contain useful code samples and an interoperability assembly for developing with managed code.</span></span> <span data-ttu-id="14f7d-210">如需使用程式碼範例的詳細資訊，請參閱 [Windows Search 程式碼範例](-search-3x-wds-sampleentry.md)。</span><span class="sxs-lookup"><span data-stu-id="14f7d-210">For more information on using the code samples, see [Windows Search Code Samples](-search-3x-wds-sampleentry.md).</span></span>

## <a name="windows-search-sdk-documentation"></a><span data-ttu-id="14f7d-211">Windows Search SDK 檔</span><span class="sxs-lookup"><span data-stu-id="14f7d-211">Windows Search SDK Documentation</span></span>

<span data-ttu-id="14f7d-212">Windows Search SDK 檔的內容如下所示：</span><span class="sxs-lookup"><span data-stu-id="14f7d-212">The contents of the Windows Search SDK documentation are as follows:</span></span>

-   [<span data-ttu-id="14f7d-213">Windows Search 做為開發平台</span><span class="sxs-lookup"><span data-stu-id="14f7d-213">Windows Search as a Development Platform</span></span>](-search-3x-wds-development-ovr.md)

    <span data-ttu-id="14f7d-214">概述 Windows Search 中的主要開發案例。</span><span class="sxs-lookup"><span data-stu-id="14f7d-214">Outlines the main development scenarios in Windows Search.</span></span> <span data-ttu-id="14f7d-215">提供您嘗試達成之開發案例所識別的處理常式清單、增益集安裝程式指導方針，以及執行附注。</span><span class="sxs-lookup"><span data-stu-id="14f7d-215">Provides a list of handlers identified by the development scenario you are trying to achieve, add-in installer guidelines, and implementation notes.</span></span>

-   [<span data-ttu-id="14f7d-216">Windows Search 開發人員指南</span><span class="sxs-lookup"><span data-stu-id="14f7d-216">Windows Search Developer's Guide</span></span>](-search-developers-guide-entry-page.md)

    <span data-ttu-id="14f7d-217">提供 [管理索引](-search-3x-wds-mngidx-overview.md)、以程式設計 [方式查詢索引](-search-3x-wds-qryidx-overview.md)、 [擴充索引](-search-3x-wds-extidx-overview.md)，以及 [擴充語言資源](extending-language-resources-in-windows-search.md)的說明。</span><span class="sxs-lookup"><span data-stu-id="14f7d-217">Provides explanations for [Managing the Index](-search-3x-wds-mngidx-overview.md), [Querying the Index Programmatically](-search-3x-wds-qryidx-overview.md), [Extending the Index](-search-3x-wds-extidx-overview.md), and [Extending Language Resources](extending-language-resources-in-windows-search.md).</span></span>

-   [<span data-ttu-id="14f7d-218">Windows Search 參考</span><span class="sxs-lookup"><span data-stu-id="14f7d-218">Windows Search Reference</span></span>](-search-reference-entry-page.md)

    <span data-ttu-id="14f7d-219">記錄下列 Windows Search 介面類別別： [通訊協定處理常式](-search-protocol-handlers-interfaces-entry-page.md)、 [查詢](-search-querying-interfaces-entry-page.md)、編目 [範圍](-search-crawl-scope-interfaces-entry-page.md)、 [資料增益集](-search-data-addins-interfaces-entry-page.md)、 [索引管理](-search-index-mgt-interfaces-entry-page.md)和 [通知](-search-notifications-interfaces-entry-page.md)。</span><span class="sxs-lookup"><span data-stu-id="14f7d-219">Documents the following categories of Windows Search interfaces: [Protocol Handlers](-search-protocol-handlers-interfaces-entry-page.md), [Querying](-search-querying-interfaces-entry-page.md), [Crawl Scope](-search-crawl-scope-interfaces-entry-page.md), [Data Add-ins](-search-data-addins-interfaces-entry-page.md), [Index Management](-search-index-mgt-interfaces-entry-page.md), and [Notifications](-search-notifications-interfaces-entry-page.md).</span></span> <span data-ttu-id="14f7d-220">參考檔也包含 [常數和](-search-constants-and-enumerations-entry-page.md)列舉、 [結構](-search-structures-entry-page.md)、 [屬性](-search-3x-wds-propertymappings.md)對應，以及 [已儲存的搜尋檔案格式](-search-savedsearchfileformat.md)。</span><span class="sxs-lookup"><span data-stu-id="14f7d-220">The reference documentation also includes [Constants and Enumerations](-search-constants-and-enumerations-entry-page.md), [Structures](-search-structures-entry-page.md), [Property Mappings](-search-3x-wds-propertymappings.md), and the [Saved Search File Format](-search-savedsearchfileformat.md).</span></span>

-   [<span data-ttu-id="14f7d-221">Windows Search 程式碼範例</span><span class="sxs-lookup"><span data-stu-id="14f7d-221">Windows Search Code Samples</span></span>](-search-samples-ovw.md)

    <span data-ttu-id="14f7d-222">描述可用的搜尋 API 程式碼範例。</span><span class="sxs-lookup"><span data-stu-id="14f7d-222">Describes the Search API code samples that are available.</span></span>

-   [<span data-ttu-id="14f7d-223">Windows 中的同盟搜尋</span><span class="sxs-lookup"><span data-stu-id="14f7d-223">Federated Search in Windows</span></span>](-search-federated-search-overview.md)

    <span data-ttu-id="14f7d-224">描述 Windows 7 對遠端資料存放區之搜尋同盟的支援搜尋同盟，這些技術可讓使用者從 Windows 檔案總管記憶體取遠端資料並與其互動。</span><span class="sxs-lookup"><span data-stu-id="14f7d-224">Describes Windows 7 support for search federation to remote data stores using OpenSearch technologies that enable users to access and interact with their remote data from within Windows Explorer.</span></span>

-   [<span data-ttu-id="14f7d-225">相關搜尋技術</span><span class="sxs-lookup"><span data-stu-id="14f7d-225">Related Search Technologies</span></span>](-search-3x-wds-sampleentry.md)

    <span data-ttu-id="14f7d-226">列出與 Windows Search 相關的技術：企業搜尋、SharePoint 企業搜尋和繼承應用程式，例如 Windows Desktop Search 2.x 和 Platform SDK：索引服務。</span><span class="sxs-lookup"><span data-stu-id="14f7d-226">Lists technologies related to Windows Search: Enterprise Search, SharePoint Enterprise Search, and legacy applications such as Windows Desktop Search 2.x and Platform SDK: Indexing Service.</span></span>

-   [<span data-ttu-id="14f7d-227">Windows Search 詞彙</span><span class="sxs-lookup"><span data-stu-id="14f7d-227">Windows Search Glossary</span></span>](search-glossary.md)

    <span data-ttu-id="14f7d-228">定義 Windows Search 和 Shell 技術中使用的重要詞彙。</span><span class="sxs-lookup"><span data-stu-id="14f7d-228">Defines essential terms used in Windows Search and Shell technologies.</span></span>

## <a name="history-of-windows-search"></a><span data-ttu-id="14f7d-229">Windows Search 的歷程記錄</span><span class="sxs-lookup"><span data-stu-id="14f7d-229">History of Windows Search</span></span>

<span data-ttu-id="14f7d-230">Windows Search 取代 Windows 桌面搜尋 (WDS) （以 Windows XP 和 Windows Server 2003 的增益集的形式提供）。</span><span class="sxs-lookup"><span data-stu-id="14f7d-230">Windows Search replaces Windows Desktop Search (WDS), which was available as an add-in for Windows XP and Windows Server 2003.</span></span> <span data-ttu-id="14f7d-231">WDS 已從舊版 Windows 取代舊版的索引服務，並增強效能、可用性和擴充性。</span><span class="sxs-lookup"><span data-stu-id="14f7d-231">WDS replaced the legacy Indexing Service from previous versions of Windows with enhancements to performance, usability, and extensibility.</span></span> <span data-ttu-id="14f7d-232">新的開發平臺支援產生更安全且穩定系統的需求。</span><span class="sxs-lookup"><span data-stu-id="14f7d-232">The new development platform supports requirements that produce a more secure and stable system.</span></span> <span data-ttu-id="14f7d-233">雖然新的查詢平臺與 Microsoft Windows 桌面搜尋不相容 (WDS) 2.x，但是針對舊版 WDS 所撰寫的篩選器和通訊協定處理常式可以更新以使用 Windows Search。</span><span class="sxs-lookup"><span data-stu-id="14f7d-233">While the new querying platform is not compatible with Microsoft Windows Desktop Search (WDS) 2.x, filters and protocol handlers written for previous versions of WDS can be updated to work with Windows Search.</span></span> <span data-ttu-id="14f7d-234">Windows Search 也支援新的屬性系統。</span><span class="sxs-lookup"><span data-stu-id="14f7d-234">Windows Search also supports a new property system.</span></span> <span data-ttu-id="14f7d-235">如需篩選、屬性處理常式和通訊協定處理常式的詳細資訊，請參閱 [擴充索引](-search-3x-wds-extidx-overview.md)。</span><span class="sxs-lookup"><span data-stu-id="14f7d-235">For information on filters, property handlers, and protocol handlers, see [Extending the Index](-search-3x-wds-extidx-overview.md).</span></span>

<span data-ttu-id="14f7d-236">Windows Search 內建于 Windows Vista 和更新版本，並可作為 WDS 2.x 的可轉散發套件更新，以支援下列作業系統：</span><span class="sxs-lookup"><span data-stu-id="14f7d-236">Windows Search is built into Windows Vista and later, and is available as a redistributable update to WDS 2.x, to support the following operating systems:</span></span>

-   <span data-ttu-id="14f7d-237">32位版本的 Windows XP Service Pack 2 (SP2) 。</span><span class="sxs-lookup"><span data-stu-id="14f7d-237">32-bit versions of Windows XP with Service Pack 2 (SP2).</span></span>
-   <span data-ttu-id="14f7d-238">所有 x64 型版本的 Windows XP。</span><span class="sxs-lookup"><span data-stu-id="14f7d-238">All x64-based versions of Windows XP.</span></span>
-   <span data-ttu-id="14f7d-239">Windows Server 2003 （含 Service Pack 1） (SP1) 和更新版本。</span><span class="sxs-lookup"><span data-stu-id="14f7d-239">Windows Server 2003 with Service Pack 1 (SP1) and later.</span></span>
-   <span data-ttu-id="14f7d-240">所有 x64 型版本的 Windows Server 2003。</span><span class="sxs-lookup"><span data-stu-id="14f7d-240">All x64-based versions of Windows Server 2003.</span></span>

<span data-ttu-id="14f7d-241">執行這些作業系統的系統必須安裝 Windows Search，才能執行針對 Windows Search 所撰寫的應用程式。</span><span class="sxs-lookup"><span data-stu-id="14f7d-241">Systems running these operating systems must have Windows Search installed in order to run applications written for Windows Search.</span></span> <span data-ttu-id="14f7d-242">如需詳細資訊，請參閱 [知識庫文章917013： Windows 桌面搜尋3.01 的說明和 Windows 桌面搜尋3.01 的多語系消費者介面套件](https://support.microsoft.com/kb/917013)。</span><span class="sxs-lookup"><span data-stu-id="14f7d-242">For more information, see [KB article 917013: Description of Windows Desktop Search 3.01 and the Multilingual User Interface Pack for Windows Desktop Search 3.01](https://support.microsoft.com/kb/917013).</span></span>

## <a name="additional-resources"></a><span data-ttu-id="14f7d-243">其他資源</span><span class="sxs-lookup"><span data-stu-id="14f7d-243">Additional Resources</span></span>

-   <span data-ttu-id="14f7d-244">如需建立 Shell 資料來源的詳細資訊，請參閱 [執行基本資料夾物件介面](/previous-versions//bb776815(v=vs.85))。</span><span class="sxs-lookup"><span data-stu-id="14f7d-244">For information about creating a Shell data source, see [Implementing the Basic Folder Object Interfaces](/previous-versions//bb776815(v=vs.85)).</span></span>
-   <span data-ttu-id="14f7d-245">如需 [ISearchFolderItemFactory](/windows/win32/api/shobjidl_core/nn-shobjidl_core-isearchfolderitemfactory) 和 DB 資料夾資料來源的詳細資訊，請參閱系結 \_ \_ \_ [內容字串索引鍵](../shell/str-constants.md)中的 STR PARSE 與 PROPERTIES 常數的描述。</span><span class="sxs-lookup"><span data-stu-id="14f7d-245">For more information about [ISearchFolderItemFactory](/windows/win32/api/shobjidl_core/nn-shobjidl_core-isearchfolderitemfactory) and the DB folder data source, see the description of the STR\_PARSE\_WITH\_PROPERTIES constant in [Bind Context String Keys](../shell/str-constants.md).</span></span> <span data-ttu-id="14f7d-246">另請參閱 [關聯陣列](/previous-versions/windows/desktop/legacy/ee872122(v=vs.85)) 和 [IPropertySystem：： GetPropertyDescriptionListFromString](/windows/win32/api/propsys/nf-propsys-ipropertysystem-getpropertydescriptionlistfromstring)。</span><span class="sxs-lookup"><span data-stu-id="14f7d-246">See also [Association Arrays](/previous-versions/windows/desktop/legacy/ee872122(v=vs.85)) and [IPropertySystem::GetPropertyDescriptionListFromString](/windows/win32/api/propsys/nf-propsys-ipropertysystem-getpropertydescriptionlistfromstring).</span></span>
-   <span data-ttu-id="14f7d-247">如需 OLE DB 的詳細資訊，請參閱 [OLE DB 程式設計總覽](/cpp/data/oledb/ole-db-programming-overview?view=vs-2019)。</span><span class="sxs-lookup"><span data-stu-id="14f7d-247">For information on OLE DB, see [OLE DB Programming Overview](/cpp/data/oledb/ole-db-programming-overview?view=vs-2019).</span></span> <span data-ttu-id="14f7d-248">如需 OLE DB 之 .NET Framework Data Provider 的詳細資訊，請參閱 system.string [命名空間](/dotnet/api/system.data.oledb?view=dotnet-plat-ext-3.1&preserve-view=true) 檔。</span><span class="sxs-lookup"><span data-stu-id="14f7d-248">For information on the .NET Framework Data Provider for OLE DB, see the [System.Data.OleDb Namespace](/dotnet/api/system.data.oledb?view=dotnet-plat-ext-3.1&preserve-view=true) documentation.</span></span>
-   <span data-ttu-id="14f7d-249">如需檔案類型處理常式的總覽 (也稱為 Shell 擴充處理常式和搜尋處理常式) ，請參閱 [Windows Search 作為開發平臺](-search-3x-wds-development-ovr.md)。</span><span class="sxs-lookup"><span data-stu-id="14f7d-249">For an overview of file type handlers (also known as Shell extension handlers and Search handlers), see [Windows Search as a Development Platform](-search-3x-wds-development-ovr.md).</span></span>
-   <span data-ttu-id="14f7d-250">如需有關搜尋技術的社區支援訊息板，請參閱 [MSDN 論壇： Windows 桌面搜尋開發](https://social.msdn.microsoft.com/Forums/windowsdesktopsearchdevelopment/threads)。</span><span class="sxs-lookup"><span data-stu-id="14f7d-250">For community-supported message boards about Search technologies, see [MSDN Forum: Windows Desktop Search Development](https://social.msdn.microsoft.com/Forums/windowsdesktopsearchdevelopment/threads).</span></span>
-   <span data-ttu-id="14f7d-251">如需相關的程式碼範例，請參閱 [Windows Search 程式碼範例](-search-samples-ovw.md)。</span><span class="sxs-lookup"><span data-stu-id="14f7d-251">For related code samples, see [Windows Search Code Samples](-search-samples-ovw.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="14f7d-252">相關主題</span><span class="sxs-lookup"><span data-stu-id="14f7d-252">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="14f7d-253">Windows Search 做為開發平台</span><span class="sxs-lookup"><span data-stu-id="14f7d-253">Windows Search as a Development Platform</span></span>](-search-3x-wds-development-ovr.md)
</dt> <dt>

[<span data-ttu-id="14f7d-254">Windows Search 支援的語言</span><span class="sxs-lookup"><span data-stu-id="14f7d-254">Languages Supported by Windows Search</span></span>](-search-3x-wds-language-support.md)
</dt> <dt>

[<span data-ttu-id="14f7d-255">搭配 Shell 資料和 Windows Search 使用 Managed 程式碼</span><span class="sxs-lookup"><span data-stu-id="14f7d-255">Using Managed Code with Shell Data and Windows Search</span></span>](-search-3x-wds-managed-code.md)
</dt> </dl>

 

 
