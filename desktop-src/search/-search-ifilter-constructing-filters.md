---
description: 請務必瞭解篩選處理常式的必要 DLL 結構， (IFilter 介面的執行) 。
ms.assetid: a2b5a813-573a-44d3-8780-99603e3246c1
title: 在 Windows Search 中執行篩選處理常式
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: bc5f326440b31b62ff5697274962f4d4a2cfe7c1
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/07/2021
ms.locfileid: "106970383"
---
# <a name="implementing-filter-handlers-in-windows-search"></a><span data-ttu-id="55365-103">在 Windows Search 中執行篩選處理常式</span><span class="sxs-lookup"><span data-stu-id="55365-103">Implementing Filter Handlers in Windows Search</span></span>

<span data-ttu-id="55365-104">請務必瞭解篩選處理常式的必要 DLL 結構， ([**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) 介面的執行) 。</span><span class="sxs-lookup"><span data-stu-id="55365-104">It is important that you understand the required DLL structure of a filter handler (an implementation of the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) interface).</span></span>

<span data-ttu-id="55365-105">本主題的組織方式如下：</span><span class="sxs-lookup"><span data-stu-id="55365-105">This topic is organized as follows:</span></span>

- [<span data-ttu-id="55365-106">執行和匯出 DLL 進入點</span><span class="sxs-lookup"><span data-stu-id="55365-106">Implementing and Exporting the DLL Entry Points</span></span>](#implementing-and-exporting-the-dll-entry-points)
- [<span data-ttu-id="55365-107">執行 IFilter 類別和 Class Factory</span><span class="sxs-lookup"><span data-stu-id="55365-107">Implementing the IFilter Class and Class Factory</span></span>](#implementing-the-ifilter-class-and-class-factory)
- [<span data-ttu-id="55365-108">繼承 COM 介面</span><span class="sxs-lookup"><span data-stu-id="55365-108">Inheriting the COM Interfaces</span></span>](#inheriting-the-com-interfaces)
- [<span data-ttu-id="55365-109">執行 COM 介面方法</span><span class="sxs-lookup"><span data-stu-id="55365-109">Implementing the COM Interface Methods</span></span>](#implementing-the-com-interface-methods)
  - [<span data-ttu-id="55365-110">未執行的 COM 方法</span><span class="sxs-lookup"><span data-stu-id="55365-110">COM Methods that are not Implemented</span></span>](#com-methods-that-are-not-implemented)
- [<span data-ttu-id="55365-111">其他資源</span><span class="sxs-lookup"><span data-stu-id="55365-111">Additional Resources</span></span>](#additional-resources)
- [<span data-ttu-id="55365-112">相關主題</span><span class="sxs-lookup"><span data-stu-id="55365-112">Related topics</span></span>](#related-topics)

## <a name="implementing-and-exporting-the-dll-entry-points"></a><span data-ttu-id="55365-113">執行和匯出 DLL 進入點</span><span class="sxs-lookup"><span data-stu-id="55365-113">Implementing and Exporting the DLL Entry Points</span></span>

<span data-ttu-id="55365-114">此區段中的 Ifilter.dll 所表示的每個 [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) DLL () 必須執行和匯出下列進入點。</span><span class="sxs-lookup"><span data-stu-id="55365-114">Each [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) DLL (denoted by Ifilter.dll in this section) must implement and export the following entry points.</span></span> <span data-ttu-id="55365-115">這些進入點通常會使用 () 的 **IFilter** 介面或使用 **\_ \_ declspec (dllexport)** 關鍵字的模組定義來匯出。</span><span class="sxs-lookup"><span data-stu-id="55365-115">These entry points are typically exported using a module-definition (.def) file for the **IFilter** interface or by using the **\_\_declspec(dllexport)** keyword.</span></span> <span data-ttu-id="55365-116">DLL 檔案可以註冊在任何資料夾中，但通常位於% SystemRoot% \\ system32 資料夾中。</span><span class="sxs-lookup"><span data-stu-id="55365-116">The DLL file can be registered to be in any folder, but it usually resides in the %SystemRoot%\\system32 folder.</span></span>

<span data-ttu-id="55365-117">下表列出並描述 DLL 進入點。</span><span class="sxs-lookup"><span data-stu-id="55365-117">DLL entry points are listed and described in the following table.</span></span>

| <span data-ttu-id="55365-118">DLL 名稱</span><span class="sxs-lookup"><span data-stu-id="55365-118">DLL name</span></span>                                                                                     | <span data-ttu-id="55365-119">DLL 描述</span><span class="sxs-lookup"><span data-stu-id="55365-119">DLL description</span></span>                                                                                                                                                                                                                                                                                                                                                                             |
|----------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="55365-120">DllRegisterServer</span><span class="sxs-lookup"><span data-stu-id="55365-120">DllRegisterServer</span></span>](/windows/win32/api/olectl/nf-olectl-dllregisterserver)            | <span data-ttu-id="55365-121">[DllRegisterServer](/windows/win32/api/olectl/nf-olectl-dllregisterserver)進入點會將 DLL 註冊為登錄中的篩選準則。</span><span class="sxs-lookup"><span data-stu-id="55365-121">The [DllRegisterServer](/windows/win32/api/olectl/nf-olectl-dllregisterserver) entry point registers the DLL as a filter in the registry.</span></span> <span data-ttu-id="55365-122">您可以藉由以 [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) 介面 DLL 檔案名作為引數來執行 regsvr32.exe 程式，以註冊 DLL： `regsvr32.exe %SystemRoot%\system32\Ifilter.dll`</span><span class="sxs-lookup"><span data-stu-id="55365-122">You register the DLL by running the regsvr32.exe program with the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) interface DLL file name as an argument: `regsvr32.exe %SystemRoot%\system32\Ifilter.dll`</span></span>                                              |
| [<span data-ttu-id="55365-123">DllUnregisterServer 函式</span><span class="sxs-lookup"><span data-stu-id="55365-123">DllUnregisterServer Function</span></span>](/windows/win32/api/olectl/nf-olectl-dllunregisterserver) | <span data-ttu-id="55365-124">[DllUnregisterServer](/windows/win32/api/olectl/nf-olectl-dllunregisterserver)函式進入點會移除 DLL 做為登錄中的持續性處理常式。</span><span class="sxs-lookup"><span data-stu-id="55365-124">The [DllUnregisterServer Function](/windows/win32/api/olectl/nf-olectl-dllunregisterserver) entry point removes the DLL as a persistent handler in the registry.</span></span> <span data-ttu-id="55365-125">您可以使用旗標執行 regsvr32.exe 程式，以取消註冊 DLL `/u` ： `regsvr32.exe /u %SystemRoot%\system32\Ifilter.dll`</span><span class="sxs-lookup"><span data-stu-id="55365-125">You unregister the DLL by running the regsvr32.exe program with the `/u` flag: `regsvr32.exe /u %SystemRoot%\system32\Ifilter.dll`</span></span>                                                                                    |
| [<span data-ttu-id="55365-126">DllGetClassObject 函式</span><span class="sxs-lookup"><span data-stu-id="55365-126">DllGetClassObject Function</span></span>](/windows/win32/api/combaseapi/nf-combaseapi-dllgetclassobject)   | <span data-ttu-id="55365-127">內容編制索引用戶端會透過元件物件模型 (COM) 來呼叫 [DllGetClassObject](/windows/win32/api/combaseapi/nf-combaseapi-dllgetclassobject) 函式進入點，以建立 [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) 介面的 class factory 物件，並取得該物件的 class factory 介面指標。</span><span class="sxs-lookup"><span data-stu-id="55365-127">The content indexing client calls the [DllGetClassObject Function](/windows/win32/api/combaseapi/nf-combaseapi-dllgetclassobject) entry point, through Component Object Model (COM), to create a class factory object for the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) interface and to get a pointer to the class factory interface of that object.</span></span>                                               |
| [<span data-ttu-id="55365-128">DllCanUnloadNow 函式</span><span class="sxs-lookup"><span data-stu-id="55365-128">DllCanUnloadNow Function</span></span>](/windows/win32/api/combaseapi/nf-combaseapi-dllcanunloadnow)     | <span data-ttu-id="55365-129">內容索引用戶端會透過 COM 呼叫 [DllCanUnloadNow](/windows/win32/api/combaseapi/nf-combaseapi-dllcanunloadnow) 函式進入點，以判斷是否可以卸載 [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter)  DLL。</span><span class="sxs-lookup"><span data-stu-id="55365-129">The content-indexing client calls the [DllCanUnloadNow Function](/windows/win32/api/combaseapi/nf-combaseapi-dllcanunloadnow) entry point, through COM, to determine whether it is possible to unload the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter)  DLL.</span></span> <span data-ttu-id="55365-130">如果 **IFilter** 介面未使用一段時間，就會卸載，如 FilterIdleTimeOut 登錄值所指定。</span><span class="sxs-lookup"><span data-stu-id="55365-130">The **IFilter** interface is unloaded after it is unused for an interval of time, as specified by the FilterIdleTimeOut registry value.</span></span> |

## <a name="implementing-the-ifilter-class-and-class-factory"></a><span data-ttu-id="55365-131">執行 IFilter 類別和 Class Factory</span><span class="sxs-lookup"><span data-stu-id="55365-131">Implementing the IFilter Class and Class Factory</span></span>

<span data-ttu-id="55365-132">至少有兩個類別（例如 CFilter 和 CFilterCF）通常會由每個 [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) DLL 來執行。</span><span class="sxs-lookup"><span data-stu-id="55365-132">At least two classes, such as CFilter and CFilterCF, are typically implemented by each [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) DLL.</span></span> <span data-ttu-id="55365-133">CFilter 類別會產生可執行內容篩選功能的 **IFilter** 介面物件。</span><span class="sxs-lookup"><span data-stu-id="55365-133">The CFilter class produces the **IFilter** interface object that implements the content-filtering functionality.</span></span> <span data-ttu-id="55365-134">它的成員函式會執行 **IFilter** 介面的介面方法。</span><span class="sxs-lookup"><span data-stu-id="55365-134">Its member functions implement the interface methods of the **IFilter** interface.</span></span> <span data-ttu-id="55365-135">每個 **ifilter** 類別都需要 (CLSID 介面所產生之 CLSID) **的唯一** 類別識別碼。</span><span class="sxs-lookup"><span data-stu-id="55365-135">Each **IFilter** class requires a unique class identifier (CLSID), which the **IFilter** interface implementer generates.</span></span>

<span data-ttu-id="55365-136">CFilterCF 類別會產生 [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) 介面的 class factory 物件。</span><span class="sxs-lookup"><span data-stu-id="55365-136">The CFilterCF class produces the class-factory object for the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) interface.</span></span> <span data-ttu-id="55365-137">藉由 DLL 的[DllGetClassObject](/windows/win32/api/combaseapi/nf-combaseapi-dllgetclassobject)函式進入點，會透過其[IClassFactory 介面](/windows/win32/api/unknwn/nn-unknwn-iclassfactory)介面呼叫 class factory。</span><span class="sxs-lookup"><span data-stu-id="55365-137">The class factory is called, through its [IClassFactory Interface](/windows/win32/api/unknwn/nn-unknwn-iclassfactory) interface, by the [DllGetClassObject Function](/windows/win32/api/combaseapi/nf-combaseapi-dllgetclassobject) entry point of the DLL.</span></span> <span data-ttu-id="55365-138">CFilterCF 類別會建立 CFilter 物件，並將指標傳回至 [IUnknown](/windows/win32/api/unknwn/nn-unknwn-iunknown)。</span><span class="sxs-lookup"><span data-stu-id="55365-138">The CFilterCF class creates the CFilter object and returns a pointer to [IUnknown](/windows/win32/api/unknwn/nn-unknwn-iunknown).</span></span> <span data-ttu-id="55365-139">在更複雜的情況下， **IFilter** 可以執行類別階層來取代單一 CFilter 類別。</span><span class="sxs-lookup"><span data-stu-id="55365-139">In more complex cases, an **IFilter** can implement a class hierarchy in place of the single CFilter class.</span></span>

## <a name="inheriting-the-com-interfaces"></a><span data-ttu-id="55365-140">繼承 COM 介面</span><span class="sxs-lookup"><span data-stu-id="55365-140">Inheriting the COM Interfaces</span></span>

<span data-ttu-id="55365-141">Windows Search 3.0 和更新版本要求您使用 [IPersistStream](/windows/win32/api/objidl/nn-objidl-ipersiststream) 的原因如下：</span><span class="sxs-lookup"><span data-stu-id="55365-141">Windows Search 3.0 and later require that you use [IPersistStream](/windows/win32/api/objidl/nn-objidl-ipersiststream) for the following reasons:</span></span>

- <span data-ttu-id="55365-142">以確保效能和未來的相容性。</span><span class="sxs-lookup"><span data-stu-id="55365-142">To ensure performance and future compatibility.</span></span>
- <span data-ttu-id="55365-143">有助於提高安全性。</span><span class="sxs-lookup"><span data-stu-id="55365-143">To help increase security.</span></span> <span data-ttu-id="55365-144">使用 [IPersistStream](/windows/win32/api/objidl/nn-objidl-ipersiststream) 執行的 ifilter 比較安全，因為 [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) 介面執行所在的內容不需要在磁片上或透過網路開啟檔案的許可權。</span><span class="sxs-lookup"><span data-stu-id="55365-144">IFilters implemented with [IPersistStream](/windows/win32/api/objidl/nn-objidl-ipersiststream) are more secure because the context in which the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) interface runs does not need the rights to open files on the disk or over the network.</span></span>
- <span data-ttu-id="55365-145">雖然 Windows Search 只使用 [IPersistStream](/windows/win32/api/objidl/nn-objidl-ipersiststream)，但 [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) 介面類別別也可以繼承 [IPersistFile 介面](/windows/win32/api/objidl/nn-objidl-ipersistfile) 和/或 [IPersistStorage 介面](/windows/win32/api/objidl/nn-objidl-ipersiststorage) 介面，以提供回溯相容性。</span><span class="sxs-lookup"><span data-stu-id="55365-145">While Windows Search uses only [IPersistStream](/windows/win32/api/objidl/nn-objidl-ipersiststream), the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) interface class can also inherit the [IPersistFile Interface](/windows/win32/api/objidl/nn-objidl-ipersistfile) and/or [IPersistStorage Interface](/windows/win32/api/objidl/nn-objidl-ipersiststorage) interface implementations for backward compatibility.</span></span>

<span data-ttu-id="55365-146">這些介面是在 mssdk include 目錄所包含的檔案中宣告 \\ ，並且具有預先定義的介面識別碼， (iid) 。</span><span class="sxs-lookup"><span data-stu-id="55365-146">These interfaces are declared in files included from the mssdk\\include directory and have pre-defined interface identifiers (IIDs).</span></span> <span data-ttu-id="55365-147">內容編制索引用戶端會透過 [IUnknown](/windows/win32/api/unknwn/nn-unknwn-iunknown)查詢 [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter)介面，以判斷在篩選內容時要使用的介面。</span><span class="sxs-lookup"><span data-stu-id="55365-147">The content-indexing client queries the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) interface through [IUnknown](/windows/win32/api/unknwn/nn-unknwn-iunknown) to determine which of these interfaces to use when filtering content.</span></span>

## <a name="implementing-the-com-interface-methods"></a><span data-ttu-id="55365-148">執行 COM 介面方法</span><span class="sxs-lookup"><span data-stu-id="55365-148">Implementing the COM Interface Methods</span></span>

<span data-ttu-id="55365-149">[**Ifilter**](/windows/win32/api/filter/nn-filter-ifilter)介面會針對 **ifilter** 介面類別別和 **ifilter** 介面 class factory，同時執行 [IUnknown](/windows/win32/api/unknwn/nn-unknwn-iunknown)方法。</span><span class="sxs-lookup"><span data-stu-id="55365-149">The [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) interface implements the [IUnknown](/windows/win32/api/unknwn/nn-unknwn-iunknown) methods for both the **IFilter** interface class and the **IFilter** interface-class factory.</span></span> <span data-ttu-id="55365-150">下表依 vtable 順序列出 **ifilter** 介面所應執行的 **ifilter** 介面特定介面和方法。</span><span class="sxs-lookup"><span data-stu-id="55365-150">The following table lists, in vtable order, the **IFilter** interface-specific interfaces and methods that the **IFilter** interface should implement.</span></span> <span data-ttu-id="55365-151">**IFilter** 介面必須執行至少 [IPersistStream](/windows/win32/api/objidl/nn-objidl-ipersiststream)，但可以執行其他 IPersist 衍生的介面。</span><span class="sxs-lookup"><span data-stu-id="55365-151">The **IFilter** interface must implement at least [IPersistStream](/windows/win32/api/objidl/nn-objidl-ipersiststream), but can implement additional IPersist-derived interfaces.</span></span>

| <span data-ttu-id="55365-152">COM 介面</span><span class="sxs-lookup"><span data-stu-id="55365-152">COM interface</span></span>                                                                             | <span data-ttu-id="55365-153">方法</span><span class="sxs-lookup"><span data-stu-id="55365-153">Method</span></span>                                                                                                                                                                                                                                                                         |
|-------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="55365-154">IClassFactory 介面</span><span class="sxs-lookup"><span data-stu-id="55365-154">IClassFactory Interface</span></span>](/windows/win32/api/unknwn/nn-unknwn-iclassfactory)   | <span data-ttu-id="55365-155">CreateInstance、LockServer</span><span class="sxs-lookup"><span data-stu-id="55365-155">CreateInstance, LockServer</span></span>                                                                                                                                                                                                                                                     |
| [<span data-ttu-id="55365-156">IClassFactory2 介面</span><span class="sxs-lookup"><span data-stu-id="55365-156">IClassFactory2 Interface</span></span>](/windows/win32/api/ocidl/nn-ocidl-iclassfactory2)  | <span data-ttu-id="55365-157">GetLicInfo, RequestLicKey, CreateInstanceLic</span><span class="sxs-lookup"><span data-stu-id="55365-157">GetLicInfo, RequestLicKey, CreateInstanceLic</span></span>                                                                                                                                                                                                                                   |
| [<span data-ttu-id="55365-158">**IFilter**</span><span class="sxs-lookup"><span data-stu-id="55365-158">**IFilter**</span></span>](/windows/win32/api/filter/nn-filter-ifilter)                                                        | <span data-ttu-id="55365-159">[**IFilter：： Init**](/windows/win32/api/filter/nf-filter-ifilter-init)、 [**Ifilter：： GetChunk**](/windows/win32/api/filter/nf-filter-ifilter-getchunk)、 [**IFilter：： GetText**](/windows/win32/api/filter/nf-filter-ifilter-gettext)、 [**IFilter：： GetValue**](/windows/win32/api/filter/nf-filter-ifilter-getvalue)、 [**IFilter：： BindRegion**](/windows/win32/api/filter/nf-filter-ifilter-bindregion)</span><span class="sxs-lookup"><span data-stu-id="55365-159">[**IFilter::Init**](/windows/win32/api/filter/nf-filter-ifilter-init), [**IFilter::GetChunk**](/windows/win32/api/filter/nf-filter-ifilter-getchunk), [**IFilter::GetText**](/windows/win32/api/filter/nf-filter-ifilter-gettext), [**IFilter::GetValue**](/windows/win32/api/filter/nf-filter-ifilter-getvalue), [**IFilter::BindRegion**](/windows/win32/api/filter/nf-filter-ifilter-bindregion)</span></span> |
| [<span data-ttu-id="55365-160">IPersist 介面</span><span class="sxs-lookup"><span data-stu-id="55365-160">IPersist Interface</span></span>](/windows/desktop/api/objidl/nn-objidl-ipersist)               | <span data-ttu-id="55365-161">GetClassID</span><span class="sxs-lookup"><span data-stu-id="55365-161">GetClassID</span></span>                                                                                                                                                                                                                                                                     |
| [<span data-ttu-id="55365-162">IPersistFile 介面</span><span class="sxs-lookup"><span data-stu-id="55365-162">IPersistFile Interface</span></span>](/windows/win32/api/objidl/nn-objidl-ipersistfile)    | <span data-ttu-id="55365-163">IsDirty、Load、Save、SaveCompleted、GetCurFile</span><span class="sxs-lookup"><span data-stu-id="55365-163">IsDirty, Load, Save, SaveCompleted, GetCurFile</span></span>                                                                                                                                                                                                                                 |
| [<span data-ttu-id="55365-164">IPersistStorage 介面</span><span class="sxs-lookup"><span data-stu-id="55365-164">IPersistStorage Interface</span></span>](/windows/win32/api/objidl/nn-objidl-ipersiststorage) | <span data-ttu-id="55365-165">IsDirty、載入、儲存、GetSizeMax</span><span class="sxs-lookup"><span data-stu-id="55365-165">IsDirty, Load, Save, GetSizeMax</span></span>                                                                                                                                                                                                                                                |
| [<span data-ttu-id="55365-166">IPersistStream</span><span class="sxs-lookup"><span data-stu-id="55365-166">IPersistStream</span></span>](/windows/win32/api/objidl/nn-objidl-ipersiststream)            | <span data-ttu-id="55365-167">IsDirty、載入、儲存、GetSizeMax</span><span class="sxs-lookup"><span data-stu-id="55365-167">IsDirty, Load, Save, GetSizeMax</span></span>                                                                                                                                                                                                                                                |

<span data-ttu-id="55365-168">每個方法的參考頁面會指定該方法的參數和功能行為。</span><span class="sxs-lookup"><span data-stu-id="55365-168">The reference page for each method specifies the parameters and functional behavior for that method.</span></span> <span data-ttu-id="55365-169">每個參考頁面也會提供要針對該方法執行的結果碼。</span><span class="sxs-lookup"><span data-stu-id="55365-169">Each reference page also gives the result codes to implement for that method.</span></span> <span data-ttu-id="55365-170">[**IFilter**](/windows/win32/api/filter/nn-filter-ifilter)方法的參考頁面提供 [設備 \_ ITF](../com/codes-in-facility-itf.md)結果碼中所要執行的介面特定程式碼，而內容索引用戶端也可以處理任何一般結果碼，例如設備 \_ Null 和設備 \_ WIN32。</span><span class="sxs-lookup"><span data-stu-id="55365-170">The reference pages for the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) methods give the interface-specific [Codes in FACILITY\_ITF](../com/codes-in-facility-itf.md) result codes to be implemented, and the content-indexing client can also handle any of the generic result codes, such as FACILITY\_NULL and FACILITY\_WIN32.</span></span> <span data-ttu-id="55365-171">如需詳細資訊，請參閱 [COM 錯誤碼的結構](../com/structure-of-com-error-codes.md)。</span><span class="sxs-lookup"><span data-stu-id="55365-171">For more information, see [Structure of COM Error Codes](../com/structure-of-com-error-codes.md).</span></span>

### <a name="com-methods-that-are-not-implemented"></a><span data-ttu-id="55365-172">未執行的 COM 方法</span><span class="sxs-lookup"><span data-stu-id="55365-172">COM Methods that are not Implemented</span></span>

<span data-ttu-id="55365-173">[**IFilter**](/windows/win32/api/filter/nn-filter-ifilter)介面必須執行至少 [IPersistStream](/windows/win32/api/objidl/nn-objidl-ipersiststream)，但不需要執行其他 IPersist 衍生的介面。</span><span class="sxs-lookup"><span data-stu-id="55365-173">The [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) interface must implement at least [IPersistStream](/windows/win32/api/objidl/nn-objidl-ipersiststream), but does not need to implement additional IPersist-derived interfaces.</span></span>

<span data-ttu-id="55365-174">Windows Search 不需要執行下表所列的 COM 方法。</span><span class="sxs-lookup"><span data-stu-id="55365-174">Windows Search does not need to implement the COM methods listed in the following table.</span></span>

| <span data-ttu-id="55365-175">不需要的方法</span><span class="sxs-lookup"><span data-stu-id="55365-175">Method that is not required</span></span>                               | <span data-ttu-id="55365-176">Description</span><span class="sxs-lookup"><span data-stu-id="55365-176">Description</span></span>                       |
|-----------------------------------------------------------|-----------------------------------|
| <span data-ttu-id="55365-177">IPersistStream：： IsDirty</span><span class="sxs-lookup"><span data-stu-id="55365-177">IPersistStream::IsDirty</span></span>                                   | <span data-ttu-id="55365-178">篩選應該會傳回 E \_ >notimpl。</span><span class="sxs-lookup"><span data-stu-id="55365-178">Filters should return E\_NOTIMPL.</span></span> |
| <span data-ttu-id="55365-179">IPersistStream：： Save</span><span class="sxs-lookup"><span data-stu-id="55365-179">IPersistStream::Save</span></span>                                      | <span data-ttu-id="55365-180">篩選應該會傳回 E \_ >notimpl。</span><span class="sxs-lookup"><span data-stu-id="55365-180">Filters should return E\_NOTIMPL.</span></span> |
| <span data-ttu-id="55365-181">IPersistStream：： GetSizeMax</span><span class="sxs-lookup"><span data-stu-id="55365-181">IPersistStream::GetSizeMax</span></span>                                | <span data-ttu-id="55365-182">篩選應該會傳回 E \_ >notimpl。</span><span class="sxs-lookup"><span data-stu-id="55365-182">Filters should return E\_NOTIMPL.</span></span> |
| [<span data-ttu-id="55365-183">**IFilter：： BindRegion**</span><span class="sxs-lookup"><span data-stu-id="55365-183">**IFilter::BindRegion**</span></span>](/windows/win32/api/filter/nf-filter-ifilter-bindregion) | <span data-ttu-id="55365-184">篩選應該會傳回 E \_ >notimpl。</span><span class="sxs-lookup"><span data-stu-id="55365-184">Filters should return E\_NOTIMPL.</span></span> |

## <a name="additional-resources"></a><span data-ttu-id="55365-185">其他資源</span><span class="sxs-lookup"><span data-stu-id="55365-185">Additional Resources</span></span>

- <span data-ttu-id="55365-186">[GitHub](https://github.com/Microsoft/Windows-classic-samples/tree/master/Samples/Win7Samples/winui/WindowsSearch/IFilterSample)上提供的 [IFilterSample](-search-sample-ifiltersample.md)程式碼範例會示範如何建立用來執行 [**ifilter**](/windows/win32/api/filter/nn-filter-ifilter)介面的 ifilter 基礎類別。</span><span class="sxs-lookup"><span data-stu-id="55365-186">The [IFilterSample](-search-sample-ifiltersample.md) code sample, available on [GitHub](https://github.com/Microsoft/Windows-classic-samples/tree/master/Samples/Win7Samples/winui/WindowsSearch/IFilterSample), demonstrates how to create an IFilter base class for implementing the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) interface.</span></span>
- <span data-ttu-id="55365-187">如需索引編制程式的總覽，請參閱 [索引](-search-indexing-process-overview.md)程式。</span><span class="sxs-lookup"><span data-stu-id="55365-187">For an overview of the indexing process, see [The Indexing Process](-search-indexing-process-overview.md).</span></span>
- <span data-ttu-id="55365-188">如需檔案類型的總覽，請參閱 [檔案類型](../shell/fa-file-types.md)。</span><span class="sxs-lookup"><span data-stu-id="55365-188">For an overview of file types, see [File Types](../shell/fa-file-types.md).</span></span>
- <span data-ttu-id="55365-189">若要查詢檔案類型的檔案關聯屬性，請參閱 [PerceivedTypes、SystemFileAssociations 和應用程式註冊](/previous-versions/windows/desktop/legacy/cc144150(v=vs.85))。</span><span class="sxs-lookup"><span data-stu-id="55365-189">To query file association attributes for a file type, see [PerceivedTypes, SystemFileAssociations, and Application Registration](/previous-versions/windows/desktop/legacy/cc144150(v=vs.85)).</span></span>

## <a name="related-topics"></a><span data-ttu-id="55365-190">相關主題</span><span class="sxs-lookup"><span data-stu-id="55365-190">Related topics</span></span>

[<span data-ttu-id="55365-191">開發篩選處理常式</span><span class="sxs-lookup"><span data-stu-id="55365-191">Developing Filter Handlers</span></span>](-search-ifilter-conceptual.md)

[<span data-ttu-id="55365-192">瞭解 Windows Search 中的篩選處理常式</span><span class="sxs-lookup"><span data-stu-id="55365-192">Understanding Filter Handlers in Windows Search</span></span>](-search-ifilter-about.md)

[<span data-ttu-id="55365-193">在 Windows Search 中建立篩選處理常式的最佳作法</span><span class="sxs-lookup"><span data-stu-id="55365-193">Best Practices for Creating Filter Handlers in Windows Search</span></span>](-search-3x-wds-extidx-filters.md)

[<span data-ttu-id="55365-194">從篩選處理常式傳回屬性</span><span class="sxs-lookup"><span data-stu-id="55365-194">Returning Properties from a Filter Handler</span></span>](-search-ifilter-property-filtering.md)

[<span data-ttu-id="55365-195">Windows 隨附的篩選處理常式</span><span class="sxs-lookup"><span data-stu-id="55365-195">Filter Handlers that Ship with Windows</span></span>](-search-ifilter-implementations.md)

[<span data-ttu-id="55365-196">註冊篩選處理常式</span><span class="sxs-lookup"><span data-stu-id="55365-196">Registering Filter Handlers</span></span>](-search-ifilter-registering-filters.md)

[<span data-ttu-id="55365-197">測試篩選處理常式</span><span class="sxs-lookup"><span data-stu-id="55365-197">Testing Filter Handlers</span></span>](-search-ifilter-testing-filters.md)
