---
description: 若要為新檔案格式和資料存放區的內容和屬性編制索引，Microsoft Windows Search 必須使用增益集進行擴充。
ms.assetid: 04ddcd97-c358-44d2-9092-a035436c50c9
title: Windows Search 做為開發平台
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 19041ac23c90006cc2f1b2f6146cb20a6b972fc2
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/07/2021
ms.locfileid: "103689899"
---
# <a name="windows-search-as-a-development-platform"></a><span data-ttu-id="dfb2b-103">Windows Search 做為開發平台</span><span class="sxs-lookup"><span data-stu-id="dfb2b-103">Windows Search as a Development Platform</span></span>

<span data-ttu-id="dfb2b-104">若要為新檔案格式和資料存放區的內容和屬性編制索引，Microsoft Windows Search 必須使用增益集進行擴充。</span><span class="sxs-lookup"><span data-stu-id="dfb2b-104">To index the contents and properties of new file formats and data stores, Microsoft Windows Search must be extended with add-ins.</span></span>

<span data-ttu-id="dfb2b-105">在新檔案格式和資料存放區的協力廠商開發人員之前，您必須先執行下列三項作業，才能讓這些格式和存放區以 Windows 檔案總管的形式出現在查詢結果中：</span><span class="sxs-lookup"><span data-stu-id="dfb2b-105">Before a third-party developer of new file formats and data stores can get those formats and stores to appear in query results in Windows Explorer, the developer must do the following three things:</span></span>

-   <span data-ttu-id="dfb2b-106">執行 Shell 資料來源，以擴充 Shell 命名空間。</span><span class="sxs-lookup"><span data-stu-id="dfb2b-106">Implement a Shell data source to extend the Shell namespace.</span></span>
-   <span data-ttu-id="dfb2b-107">公開資料存放區中的專案 (如果它們正在加入新的資料存放區，因為它需要編制索引) 。</span><span class="sxs-lookup"><span data-stu-id="dfb2b-107">Expose items in a data store (if they are adding a new data store, because it would need to be indexed).</span></span>
-   <span data-ttu-id="dfb2b-108">開發通訊協定處理常式，讓 Windows Search 可以存取用來編制索引的資料。</span><span class="sxs-lookup"><span data-stu-id="dfb2b-108">Develop a protocol handler so that Windows Search can access the data for indexing.</span></span>

<span data-ttu-id="dfb2b-109">本主題的組織方式如下：</span><span class="sxs-lookup"><span data-stu-id="dfb2b-109">This topic is organized as follows:</span></span>

-   [<span data-ttu-id="dfb2b-110">快速入門</span><span class="sxs-lookup"><span data-stu-id="dfb2b-110">Getting Started</span></span>](#getting-started)
-   [<span data-ttu-id="dfb2b-111">搜尋開發案例總覽</span><span class="sxs-lookup"><span data-stu-id="dfb2b-111">Overview of Search Development Scenarios</span></span>](#overview-of-search-development-scenarios)
    -   [<span data-ttu-id="dfb2b-112">新增資料存放區</span><span class="sxs-lookup"><span data-stu-id="dfb2b-112">Adding a New Data Store</span></span>](#adding-a-new-data-store)
    -   [<span data-ttu-id="dfb2b-113">新增檔案格式</span><span class="sxs-lookup"><span data-stu-id="dfb2b-113">Adding a New File Format</span></span>](#adding-a-new-file-format)
    -   [<span data-ttu-id="dfb2b-114">使用 Windows Search 結果</span><span class="sxs-lookup"><span data-stu-id="dfb2b-114">Consuming Windows Search Results</span></span>](#consuming-windows-search-results)
-   [<span data-ttu-id="dfb2b-115">處理常式總覽</span><span class="sxs-lookup"><span data-stu-id="dfb2b-115">Overview of Handlers</span></span>](#overview-of-handlers)
-   [<span data-ttu-id="dfb2b-116">增益集安裝程式指導方針</span><span class="sxs-lookup"><span data-stu-id="dfb2b-116">Add-in Installer Guidelines</span></span>](#add-in-installer-guidelines)
-   [<span data-ttu-id="dfb2b-117">實施者注意事項</span><span class="sxs-lookup"><span data-stu-id="dfb2b-117">Note to Implementers</span></span>](#note-to-implementers)
-   [<span data-ttu-id="dfb2b-118">其他資源</span><span class="sxs-lookup"><span data-stu-id="dfb2b-118">Additional Resources</span></span>](#additional-resources)
-   [<span data-ttu-id="dfb2b-119">相關主題</span><span class="sxs-lookup"><span data-stu-id="dfb2b-119">Related topics</span></span>](#related-topics)

## <a name="getting-started"></a><span data-ttu-id="dfb2b-120">開始使用</span><span class="sxs-lookup"><span data-stu-id="dfb2b-120">Getting Started</span></span>

<span data-ttu-id="dfb2b-121">在您開始建立 Windows Search 應用程式之前，請記住，慣用的方法是透過 Shell 資料來源。</span><span class="sxs-lookup"><span data-stu-id="dfb2b-121">Before you start creating a Windows Search application, remember that the preferred way to do it is through a Shell data source.</span></span> <span data-ttu-id="dfb2b-122">Shell 資料來源會擴充 Shell 命名空間，並公開資料存放區中的專案。</span><span class="sxs-lookup"><span data-stu-id="dfb2b-122">A Shell data source extends the Shell namespace and exposes the items in a data store.</span></span> <span data-ttu-id="dfb2b-123">然後，您可以使用通訊協定處理常式，利用 Windows Search 系統為數據存放區中的專案編制索引。</span><span class="sxs-lookup"><span data-stu-id="dfb2b-123">The items in the data store can then be indexed by the Windows Search system by using a protocol handler.</span></span> <span data-ttu-id="dfb2b-124">建議您藉由實作為 Shell 資料來源來存取 Windows Search 的間接方法，因為它可提供完整 Shell 功能的存取權。</span><span class="sxs-lookup"><span data-stu-id="dfb2b-124">This indirect approach for accessing Windows Search by implementing a Shell data source is preferred because it provides access to full Shell functionality.</span></span> <span data-ttu-id="dfb2b-125">如此一來，即可確保合理的使用者體驗。</span><span class="sxs-lookup"><span data-stu-id="dfb2b-125">Doing it this way ensures a reasonable user experience.</span></span>

<span data-ttu-id="dfb2b-126">如果您希望查詢結果出現在 Windows 檔案總管中，您必須先執行 Shell 資料來源，才能建立通訊協定處理常式來擴充索引。</span><span class="sxs-lookup"><span data-stu-id="dfb2b-126">If you want the query results to appear in Windows Explorer, you must implement a Shell data source before you can create a protocol handler to extend the index.</span></span> <span data-ttu-id="dfb2b-127">但是，如果所有查詢都是以程式設計方式 (透過 OLE DB 例如) ，並由應用程式的程式碼（而非 Shell）所解釋，則會優先使用 Shell 命名空間，但不是必要的。</span><span class="sxs-lookup"><span data-stu-id="dfb2b-127">However, if all queries will be programmatic (through OLE DB for example) and interpreted by the application's code rather than the Shell, a Shell namespace is still preferred but not required.</span></span>

<span data-ttu-id="dfb2b-128">需要有通訊協定處理常式，Windows 才能取得檔案內容的知識，例如資料庫或自訂檔案類型中的專案。</span><span class="sxs-lookup"><span data-stu-id="dfb2b-128">A protocol handler is required for Windows to obtain knowledge of file contents, such as items in databases or custom file types.</span></span> <span data-ttu-id="dfb2b-129">雖然 Windows Search 可以為檔案的名稱和屬性編制索引，但 Windows 並不知道該檔案的內容。</span><span class="sxs-lookup"><span data-stu-id="dfb2b-129">While Windows Search can index the name and properties of the file, Windows has no knowledge of the content of the file.</span></span> <span data-ttu-id="dfb2b-130">如此一來，就無法在 Windows Shell 中建立索引或公開這類專案。</span><span class="sxs-lookup"><span data-stu-id="dfb2b-130">As a result, such items cannot be indexed or exposed in the Windows Shell.</span></span> <span data-ttu-id="dfb2b-131">藉由執行自訂通訊協定處理常式，您可以公開這些專案。</span><span class="sxs-lookup"><span data-stu-id="dfb2b-131">By implementing a custom protocol handler, you can expose these items.</span></span> <span data-ttu-id="dfb2b-132">如需您嘗試達成之開發人員案例所識別的處理常式清單，請參閱 [處理常式的總覽](#overview-of-handlers)。</span><span class="sxs-lookup"><span data-stu-id="dfb2b-132">For a list of handlers identified by the developer scenario you are trying to achieve, see [Overview of Handlers](#overview-of-handlers).</span></span>

## <a name="overview-of-search-development-scenarios"></a><span data-ttu-id="dfb2b-133">搜尋開發案例總覽</span><span class="sxs-lookup"><span data-stu-id="dfb2b-133">Overview of Search Development Scenarios</span></span>

<span data-ttu-id="dfb2b-134">Windows Search 最常見的開發案例如下：</span><span class="sxs-lookup"><span data-stu-id="dfb2b-134">The most common development scenarios in Windows Search are:</span></span>

-   [<span data-ttu-id="dfb2b-135">新增資料存放區</span><span class="sxs-lookup"><span data-stu-id="dfb2b-135">Adding a new data store</span></span>](#adding-a-new-data-store)
-   [<span data-ttu-id="dfb2b-136">新增檔案格式</span><span class="sxs-lookup"><span data-stu-id="dfb2b-136">Adding a new file format</span></span>](#adding-a-new-file-format)
-   [<span data-ttu-id="dfb2b-137">使用 Windows Search 結果</span><span class="sxs-lookup"><span data-stu-id="dfb2b-137">Consuming Windows Search results</span></span>](#consuming-windows-search-results)

### <a name="adding-a-new-data-store"></a><span data-ttu-id="dfb2b-138">新增資料存放區</span><span class="sxs-lookup"><span data-stu-id="dfb2b-138">Adding a New Data Store</span></span>

<span data-ttu-id="dfb2b-139">只有當您要新增要編制索引的新資料存放區時，才需要適用于 Windows Search 的 Shell 資料存放區。</span><span class="sxs-lookup"><span data-stu-id="dfb2b-139">You need a Shell data store for Windows Search only if you are adding a new data store to be indexed.</span></span> <span data-ttu-id="dfb2b-140">資料存放區是資料的儲存機制，可使用 Shell 資料來源，以容器的形式公開給 Shell 程式設計模型。</span><span class="sxs-lookup"><span data-stu-id="dfb2b-140">A data store is a repository of data that can be exposed to the Shell programming model as a container by using a Shell data source.</span></span> <span data-ttu-id="dfb2b-141">然後，您可以使用通訊協定處理常式，利用 Windows Search 系統為數據存放區中的專案編制索引。</span><span class="sxs-lookup"><span data-stu-id="dfb2b-141">The items in a data store can then be indexed by the Windows Search system using a protocol handler.</span></span> <span data-ttu-id="dfb2b-142">通訊協定處理常式會執行以原生格式存取內容來源的通訊協定。</span><span class="sxs-lookup"><span data-stu-id="dfb2b-142">The protocol handler implements the protocol for accessing a content source in its native format.</span></span> <span data-ttu-id="dfb2b-143">[**ISearchProtocol**](/windows/win32/api/Searchapi/nn-searchapi-isearchprotocol)和 [**ISearchProtocol2**](/windows/win32/api/Searchapi/nn-searchapi-isearchprotocol2)介面是用來執行自訂的通訊協定處理常式，以展開可編制索引的資料來源。</span><span class="sxs-lookup"><span data-stu-id="dfb2b-143">The [**ISearchProtocol**](/windows/win32/api/Searchapi/nn-searchapi-isearchprotocol) and [**ISearchProtocol2**](/windows/win32/api/Searchapi/nn-searchapi-isearchprotocol2) interfaces are used to implement a custom protocol handler to expand the data sources that can be indexed.</span></span> <span data-ttu-id="dfb2b-144">如需建立 Shell 資料來源的詳細資訊，請參閱 [執行基本資料夾物件介面](/previous-versions/windows/desktop/legacy/cc144093(v=vs.85))。</span><span class="sxs-lookup"><span data-stu-id="dfb2b-144">For information about creating a Shell data source, see [Implementing the Basic Folder Object Interfaces](/previous-versions/windows/desktop/legacy/cc144093(v=vs.85)).</span></span>

### <a name="adding-a-new-file-format"></a><span data-ttu-id="dfb2b-145">新增檔案格式</span><span class="sxs-lookup"><span data-stu-id="dfb2b-145">Adding a New File Format</span></span>

<span data-ttu-id="dfb2b-146">如果您加入新的自訂檔案格式，則需要開發篩選處理常式或屬性處理常式，但不能同時進行兩者。</span><span class="sxs-lookup"><span data-stu-id="dfb2b-146">If you add a new custom file format, you need to develop either a filter handler or a property handler, but not both.</span></span> <span data-ttu-id="dfb2b-147">篩選是 [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) 介面的實作為。</span><span class="sxs-lookup"><span data-stu-id="dfb2b-147">A filter is an implementation of the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) interface.</span></span> <span data-ttu-id="dfb2b-148">它會開啟特定檔案類型的檔案，並篩選索引子的屬性和文字區塊。</span><span class="sxs-lookup"><span data-stu-id="dfb2b-148">It opens files of a particular file type, and filters properties and chunks of text for the indexer.</span></span> <span data-ttu-id="dfb2b-149">篩選器會與檔案類型相關聯，如副檔名、MIME 類型或類別識別碼所表示 (Clsid) 。</span><span class="sxs-lookup"><span data-stu-id="dfb2b-149">Filters are associated with file types, as denoted by file name extensions, MIME types, or class identifiers (CLSIDs).</span></span> <span data-ttu-id="dfb2b-150">雖然一個篩選器可以處理多個檔案類型，但每個檔案類型只能使用一個篩選準則。</span><span class="sxs-lookup"><span data-stu-id="dfb2b-150">Although one filter can handle multiple file types, each file type works with only one filter.</span></span>

<span data-ttu-id="dfb2b-151">屬性處理常式會將儲存在檔案中的資料轉譯成可辨識的結構化架構，並且可由 Windows 檔案總管、Windows Search 和其他應用程式存取。</span><span class="sxs-lookup"><span data-stu-id="dfb2b-151">A property handler translates data stored in a file into a structured schema that is recognized by and can be accessed by Windows Explorer, Windows Search, and other applications.</span></span> <span data-ttu-id="dfb2b-152">這些系統接著可以與屬性處理常式互動，以在檔案之間進行寫入和讀取屬性。</span><span class="sxs-lookup"><span data-stu-id="dfb2b-152">These systems can then interact with the property handler to write and read properties to and from a file.</span></span> <span data-ttu-id="dfb2b-153">轉譯的資料包含詳細資料檢視、提示、詳細資料窗格、屬性頁等等。</span><span class="sxs-lookup"><span data-stu-id="dfb2b-153">The translated data includes details view, infotips, details pane, property pages, and so forth.</span></span> <span data-ttu-id="dfb2b-154">每個屬性處理常式都與特定檔案類型相關聯，該檔案類型是由副檔名所識別。</span><span class="sxs-lookup"><span data-stu-id="dfb2b-154">Each property handler is associated with a particular file type, identified by the file name extension.</span></span> <span data-ttu-id="dfb2b-155">您需要屬性處理常式來執行下列作業：</span><span class="sxs-lookup"><span data-stu-id="dfb2b-155">You need a property handler to do the following:</span></span>

-   <span data-ttu-id="dfb2b-156">在 UI 中顯示非索引項目目屬性。</span><span class="sxs-lookup"><span data-stu-id="dfb2b-156">Show non-indexed item properties in the UI.</span></span>
-   <span data-ttu-id="dfb2b-157">支援寫入屬性。</span><span class="sxs-lookup"><span data-stu-id="dfb2b-157">Support writing properties.</span></span>

### <a name="consuming-windows-search-results"></a><span data-ttu-id="dfb2b-158">使用 Windows Search 結果</span><span class="sxs-lookup"><span data-stu-id="dfb2b-158">Consuming Windows Search Results</span></span>

<span data-ttu-id="dfb2b-159">下列各節將說明數種使用 Windows Search 結果的方式：</span><span class="sxs-lookup"><span data-stu-id="dfb2b-159">The following sections describe several ways of consuming Windows Search results:</span></span>

-   [<span data-ttu-id="dfb2b-160">查詢資料</span><span class="sxs-lookup"><span data-stu-id="dfb2b-160">Querying data</span></span>](#querying-data)
-   [<span data-ttu-id="dfb2b-161">查詢遠端資料存放區 (同盟搜尋) </span><span class="sxs-lookup"><span data-stu-id="dfb2b-161">Querying remote data stores (Federated Search)</span></span>](#querying-remote-data-stores-federated-search)
-   [<span data-ttu-id="dfb2b-162">編制檔案和專案的索引</span><span class="sxs-lookup"><span data-stu-id="dfb2b-162">Indexing files and items</span></span>](#indexing-files-and-items)
-   [<span data-ttu-id="dfb2b-163">編制資料存放區索引</span><span class="sxs-lookup"><span data-stu-id="dfb2b-163">Indexing a data store</span></span>](#indexing-a-data-store)
-   [<span data-ttu-id="dfb2b-164">管理索引編制程式</span><span class="sxs-lookup"><span data-stu-id="dfb2b-164">Managing the indexing process</span></span>](#managing-the-indexing-process)
-   [<span data-ttu-id="dfb2b-165">將 Windows 屬性系統與 Windows Search 應用程式整合</span><span class="sxs-lookup"><span data-stu-id="dfb2b-165">Integrating the Windows Property System with Windows Search applications</span></span>](#integrating-the-windows-property-system-with-windows-search-applications)

### <a name="querying-data"></a><span data-ttu-id="dfb2b-166">查詢資料</span><span class="sxs-lookup"><span data-stu-id="dfb2b-166">Querying Data</span></span>

<span data-ttu-id="dfb2b-167">在結合的 Windows Search 和 Windows 屬性系統上撰寫應用程式的開發人員，不論應用程式或檔案類型為何，都可以存取檔案和專案。</span><span class="sxs-lookup"><span data-stu-id="dfb2b-167">Developers writing applications on top of the combined Windows Search and Windows property system can access files and items regardless of application or file type.</span></span> <span data-ttu-id="dfb2b-168">有兩種方式可讓應用程式存取索引子資料：</span><span class="sxs-lookup"><span data-stu-id="dfb2b-168">There are two ways for applications to access the indexer data:</span></span>

-   <span data-ttu-id="dfb2b-169">應用程式會將 Windows Search 結構化查詢語言 (SQL)  (SQL) 查詢傳送給 Windows Search OLE DB 提供者，以直接與 OLE DB 通訊，以取得結果。</span><span class="sxs-lookup"><span data-stu-id="dfb2b-169">Applications communicate directly with OLE DB by sending Windows Search Structured Query Language (SQL) queries to the Windows Search OLE DB provider to retrieve results.</span></span> <span data-ttu-id="dfb2b-170">您可以手動建立查詢，也可以使用 [**ISearchQueryHelper**](/windows/win32/api/Searchapi/nn-searchapi-isearchqueryhelper) 介面從搜尋關鍵字產生 SQL，並使用 Advanced Query 語法 (AQS) 。</span><span class="sxs-lookup"><span data-stu-id="dfb2b-170">Queries can be constructed manually or by using the [**ISearchQueryHelper**](/windows/win32/api/Searchapi/nn-searchapi-isearchqueryhelper) interface to generate the SQL from search keywords, and Advanced Query Syntax (AQS).</span></span>
-   <span data-ttu-id="dfb2b-171">應用程式會透過 Shell 層運作。</span><span class="sxs-lookup"><span data-stu-id="dfb2b-171">Applications work through the Shell layer.</span></span> <span data-ttu-id="dfb2b-172">Shell 層的優點是它也支援 grep 之類的其他來源。</span><span class="sxs-lookup"><span data-stu-id="dfb2b-172">The advantage of the Shell layer is that it also supports other sources like grep.</span></span> <span data-ttu-id="dfb2b-173">但缺點是，並非所有索引子功能都可以使用。</span><span class="sxs-lookup"><span data-stu-id="dfb2b-173">However, the disadvantage is that not all indexer features are available.</span></span>

<span data-ttu-id="dfb2b-174">另一個選項是使用 search-ms：//和 search://通訊協定，其會執行透過 Windows 檔案總管轉譯的 URL 式搜尋。</span><span class="sxs-lookup"><span data-stu-id="dfb2b-174">Another option is using the search-ms:// and search:// protocols, which execute URL-based searches rendered through Windows Explorer.</span></span> <span data-ttu-id="dfb2b-175">此選項可啟用最輕量的開發，但不會將結果或使用者選取範圍從結果檢視傳回給呼叫應用程式。</span><span class="sxs-lookup"><span data-stu-id="dfb2b-175">This option enables the lightest-weight development but does not return results or user selections from the results view to the calling application.</span></span> <span data-ttu-id="dfb2b-176">此外，與其他通訊協定一樣，如果應用程式符合所需的功能集，則協力廠商搜尋應用程式可以接管搜尋 ms：//和 search://通訊協定。</span><span class="sxs-lookup"><span data-stu-id="dfb2b-176">Also, like other protocols, third-party search applications can take over the search-ms:// and search:// protocols if the applications conform to the required feature set.</span></span> <span data-ttu-id="dfb2b-177">如需查詢的詳細資訊，請參閱 [Windows Search 中的查詢](querying-process--windows-search-.md) 程式，並以程式設計 [方式查詢索引](-search-3x-wds-qryidx-overview.md)。</span><span class="sxs-lookup"><span data-stu-id="dfb2b-177">For more information on querying, see [Querying Process in Windows Search](querying-process--windows-search-.md) and [Querying the Index Programmatically](-search-3x-wds-qryidx-overview.md).</span></span>

### <a name="querying-remote-data-stores-federated-search"></a><span data-ttu-id="dfb2b-178">查詢遠端資料存放區 (同盟搜尋) </span><span class="sxs-lookup"><span data-stu-id="dfb2b-178">Querying Remote Data Stores (Federated Search)</span></span>

<span data-ttu-id="dfb2b-179">在 Windows 7 和更新版本中，同盟搜尋提供了新的搜尋提供者，可透過 web 伺服器、透過 [OpenSearch](https://github.com/dewitt/opensearch) 通訊協定來查詢遠端資料存放區，並將結果列舉為 RSS 或 Atom XML 摘要。</span><span class="sxs-lookup"><span data-stu-id="dfb2b-179">In Windows 7 and later, federated search offers a new search provider that queries remote data stores through web servers, through the [OpenSearch](https://github.com/dewitt/opensearch) protocol, and enumerates the results as RSS or Atom XML feeds.</span></span> <span data-ttu-id="dfb2b-180">搜尋連接器是使用搜尋提供者模擬資料夾行為的命名空間連接。</span><span class="sxs-lookup"><span data-stu-id="dfb2b-180">Search Connectors are namespace junctions that simulate folder behavior by using a search provider.</span></span> <span data-ttu-id="dfb2b-181">如需有關 Windows 7 中遠端資料存放區之搜尋同盟的詳細資訊，請參閱 [windows 中](-search-federated-search-overview.md)的同盟搜尋。</span><span class="sxs-lookup"><span data-stu-id="dfb2b-181">For more information about search federation to remote data stores in Windows 7, see [Federated Search in Windows](-search-federated-search-overview.md).</span></span>

### <a name="indexing-files-and-items"></a><span data-ttu-id="dfb2b-182">編制檔案和專案的索引</span><span class="sxs-lookup"><span data-stu-id="dfb2b-182">Indexing Files and Items</span></span>

<span data-ttu-id="dfb2b-183">索引的內容是根據 Windows Search 隨附的增益集所支援的檔案和資料類型，以及檔案系統中資料夾的預設包含和排除規則。</span><span class="sxs-lookup"><span data-stu-id="dfb2b-183">The content that is indexed is based on the file and data types supported through add-ins included with Windows Search and the default inclusion and exclusion rules for folders in the file system.</span></span> <span data-ttu-id="dfb2b-184">例如，Windows 搜尋中包含的篩選器支援超過200種常見的資料類型，包括 Microsoft Office 檔、Microsoft Outlook 電子郵件 (與 MAPI 通訊協定處理常式) 、純文字檔、HTML 及其他更多。</span><span class="sxs-lookup"><span data-stu-id="dfb2b-184">For example, the filters included in Window Search support over 200 common types of data, including Microsoft Office documents, Microsoft Outlook email (in conjunction with the MAPI protocol handler), plain-text files, HTML, and many more.</span></span> <span data-ttu-id="dfb2b-185">如需原生支援檔案類型的完整清單，請參閱 [索引中包含的內容](-search-3x-wds-included-in-index.md)。</span><span class="sxs-lookup"><span data-stu-id="dfb2b-185">For a full list of file types natively supported, see [What Is Included in the Index](-search-3x-wds-included-in-index.md).</span></span>

<span data-ttu-id="dfb2b-186">您可以使用屬性處理常式和篩選來擴充索引，以將新檔案格式的內容和屬性公開給索引及 Windows 檔案總管。</span><span class="sxs-lookup"><span data-stu-id="dfb2b-186">The index can be extended with property handlers and filters to expose the content and properties of new file formats to the index and Windows Explorer.</span></span> <span data-ttu-id="dfb2b-187">篩選是 [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) 介面的實作為。</span><span class="sxs-lookup"><span data-stu-id="dfb2b-187">Filters are an implementation of the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) interface.</span></span> <span data-ttu-id="dfb2b-188">篩選器有兩種：一個與個別專案互動，例如檔案，另一個則與容器（例如資料夾）互動。</span><span class="sxs-lookup"><span data-stu-id="dfb2b-188">There are two kinds of filters: one that interacts with individual items such as files and one that interacts with containers such as folders.</span></span> <span data-ttu-id="dfb2b-189">篩選準則有多個用途，因為它們支援區塊化資料、文字內容、某些屬性，以及多種語言。</span><span class="sxs-lookup"><span data-stu-id="dfb2b-189">Filters are multi-purpose in that they support chunking data, text content, some properties, and multiple languages.</span></span>

<span data-ttu-id="dfb2b-190">相反地，屬性處理常式具有更明確的用途：若要公開由副檔名識別的特定檔案類型的屬性。</span><span class="sxs-lookup"><span data-stu-id="dfb2b-190">In contrast, property handlers have a more specific purpose: to expose the properties of specific file types that are identified by file name extensions.</span></span> <span data-ttu-id="dfb2b-191">檔案類型的屬性處理常式可以啟用 get 和 set 屬性，也可以列舉與該檔案類型相關聯的屬性。</span><span class="sxs-lookup"><span data-stu-id="dfb2b-191">A property handler for a file type can enable get and set properties, and can enumerate the properties associated with that file type.</span></span> <span data-ttu-id="dfb2b-192">與篩選準則不同的是，屬性處理常式不支援 chucking 資料或文字內容，而且屬性處理常式無法指出 text 屬性在哪種語言中，除非它們支援寫入屬性。</span><span class="sxs-lookup"><span data-stu-id="dfb2b-192">Unlike filters, property handlers do not support chucking data or text content, and property handlers have no way of indicating what language a text property is in unless they support writing properties.</span></span>

### <a name="indexing-a-data-store"></a><span data-ttu-id="dfb2b-193">編制資料存放區索引</span><span class="sxs-lookup"><span data-stu-id="dfb2b-193">Indexing a Data Store</span></span>

<span data-ttu-id="dfb2b-194">您可以使用通訊協定處理常式來擴充索引，以提供專屬資料存放區的存取權。</span><span class="sxs-lookup"><span data-stu-id="dfb2b-194">The index can be extended with protocol handlers to provide access to proprietary data stores.</span></span> <span data-ttu-id="dfb2b-195">例如，非檔案系統資料存放區中所包含的檔案和專案 (例如資料庫和電子郵件存放區) 需要通訊協定處理常式才能從 URL 對應至資料流程。</span><span class="sxs-lookup"><span data-stu-id="dfb2b-195">For example, files and items contained in non-file-system data stores (such as databases and email stores) require a protocol handler to map from a URL to a stream.</span></span> <span data-ttu-id="dfb2b-196">通訊協定處理常式也可以選擇性地判斷要用來從資料流程中解壓縮資訊的正確篩選器。</span><span class="sxs-lookup"><span data-stu-id="dfb2b-196">Protocol handlers can also optionally determine the correct filters to use for extracting information from a stream.</span></span> <span data-ttu-id="dfb2b-197">篩選會列舉資料存放區 Url。</span><span class="sxs-lookup"><span data-stu-id="dfb2b-197">Filters enumerate the data store URLs.</span></span> <span data-ttu-id="dfb2b-198">然後使用適當的篩選和/或屬性處理常式來個別編制專案的索引。</span><span class="sxs-lookup"><span data-stu-id="dfb2b-198">The items are then individually indexed using the proper filter and/or property handler.</span></span> <span data-ttu-id="dfb2b-199">如需詳細資訊，請參閱 [擴充索引](-search-3x-wds-extidx-overview.md)。</span><span class="sxs-lookup"><span data-stu-id="dfb2b-199">For more information, see [Extending the Index](-search-3x-wds-extidx-overview.md).</span></span>

### <a name="managing-the-indexing-process"></a><span data-ttu-id="dfb2b-200">管理索引編制程式</span><span class="sxs-lookup"><span data-stu-id="dfb2b-200">Managing the Indexing Process</span></span>

<span data-ttu-id="dfb2b-201">應用程式開發人員可以使用各種管理介面來控制 Windows Search 索引的範圍和頻率。</span><span class="sxs-lookup"><span data-stu-id="dfb2b-201">Application developers can control the scope and frequency of Windows Search indexing by using various management interfaces.</span></span> <span data-ttu-id="dfb2b-202">這些介面包括新增和移除索引子掃描變更之目錄的功能、以手動方式通知索引變更資料、檢查索引子的狀態，以及強制重新編制部分或所有資料的索引。</span><span class="sxs-lookup"><span data-stu-id="dfb2b-202">These interfaces include functionality to add and remove the directories that the indexer scans for changes, manually notify the index of changes to data, check the status of the indexer, and force re-indexing of some or all data.</span></span> <span data-ttu-id="dfb2b-203">如需詳細資訊，請參閱 [管理索引](-search-3x-wds-mngidx-overview.md)。</span><span class="sxs-lookup"><span data-stu-id="dfb2b-203">For more information, see [Managing the Index](-search-3x-wds-mngidx-overview.md).</span></span>

### <a name="integrating-the-windows-property-system-with-windows-search-applications"></a><span data-ttu-id="dfb2b-204">將 Windows 屬性系統與 Windows Search 應用程式整合</span><span class="sxs-lookup"><span data-stu-id="dfb2b-204">Integrating the Windows Property System with Windows Search Applications</span></span>

<span data-ttu-id="dfb2b-205">Windows 屬性系統是資料定義的可擴充讀取/寫入系統，可提供統一的方式來表示 Shell 專案的中繼資料。</span><span class="sxs-lookup"><span data-stu-id="dfb2b-205">The Windows Property System is an extensible read/write system of data definitions that provides a uniform way of expressing metadata about Shell items.</span></span> <span data-ttu-id="dfb2b-206">Windows Vista 和更新版本中的 Windows 屬性系統可讓您儲存和取得 Shell 專案的中繼資料。</span><span class="sxs-lookup"><span data-stu-id="dfb2b-206">The Windows Property system in Windows Vista and later enables you to store and retrieve metadata for Shell items.</span></span> <span data-ttu-id="dfb2b-207">Shell 專案是任何一段內容，例如檔案、資料夾、電子郵件或連絡人。</span><span class="sxs-lookup"><span data-stu-id="dfb2b-207">A Shell item is any single piece of content, such as a file, folder, email or contact.</span></span> <span data-ttu-id="dfb2b-208">屬性是與 Shell 專案相關聯之中繼資料的個別部分。</span><span class="sxs-lookup"><span data-stu-id="dfb2b-208">A property is an individual piece of metadata associated with a Shell item.</span></span> <span data-ttu-id="dfb2b-209">屬性值會以 [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) 結構表示。</span><span class="sxs-lookup"><span data-stu-id="dfb2b-209">Property values are expressed as a [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) structure.</span></span>

<span data-ttu-id="dfb2b-210">許多常見的專案類型（例如相片、音樂、檔、郵件、連絡人和檔案）都包含廣泛的通用屬性清單。</span><span class="sxs-lookup"><span data-stu-id="dfb2b-210">An extensive list of common properties is included for a number of common item types such as photos, music, documents, messages, contacts, and files.</span></span> <span data-ttu-id="dfb2b-211">如果沒有任何現有的屬性符合其需求，開發人員也可以將自己的屬性引入平臺。</span><span class="sxs-lookup"><span data-stu-id="dfb2b-211">Developers can also introduce their own properties to the platform if no existing property meets their needs.</span></span> <span data-ttu-id="dfb2b-212">如需將應用程式與 Windows 屬性系統整合的詳細資訊，請參閱 [開發屬性處理常式](-search-3x-wds-extidx-propertyhandlers.md)。</span><span class="sxs-lookup"><span data-stu-id="dfb2b-212">For more information on integrating applications with the Windows property system, see [Developing Property Handlers](-search-3x-wds-extidx-propertyhandlers.md).</span></span>

## <a name="overview-of-handlers"></a><span data-ttu-id="dfb2b-213">處理常式總覽</span><span class="sxs-lookup"><span data-stu-id="dfb2b-213">Overview of Handlers</span></span>

<span data-ttu-id="dfb2b-214">處理常式是元件物件模型 (COM) 物件，可提供 Shell 專案的功能。</span><span class="sxs-lookup"><span data-stu-id="dfb2b-214">A handler is a Component Object Model (COM) object that provides functionality for a Shell item.</span></span> <span data-ttu-id="dfb2b-215">大部分的 Shell 資料來源都會提供可延伸的系統，以便將處理常式系結至專案。</span><span class="sxs-lookup"><span data-stu-id="dfb2b-215">Most Shell data sources offer an extensible system for binding handlers to items.</span></span> <span data-ttu-id="dfb2b-216">例如，檔系統資料夾使用關聯系統來查閱特定檔案類型的處理常式。</span><span class="sxs-lookup"><span data-stu-id="dfb2b-216">For example, the file system folder uses the association system to look up the handlers for a particular file type.</span></span> <span data-ttu-id="dfb2b-217">每個檔案類型都需要特定的處理常式。</span><span class="sxs-lookup"><span data-stu-id="dfb2b-217">A specific handler is required for every file type.</span></span> <span data-ttu-id="dfb2b-218">Adobe Acrobat .pdf 檔案類型需要一個篩選器處理常式，例如，doc 檔案格式需要另一個篩選處理常式等等。</span><span class="sxs-lookup"><span data-stu-id="dfb2b-218">One filter handler is required for the Adobe Acrobat .pdf file type, for example, another filter handler is required for the .doc file format, and so forth.</span></span>

<span data-ttu-id="dfb2b-219">不同的處理常式有一些共同點。</span><span class="sxs-lookup"><span data-stu-id="dfb2b-219">Different handlers have some commonality.</span></span> <span data-ttu-id="dfb2b-220">在 Windows Vista 和更新版本中，所有處理常式都必須使用下列其中一個介面來初始化處理常式： [**IInitializeWithStream**](/windows/win32/api/propsys/nn-propsys-iinitializewithstream)、 [**IInitializeWithItem**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-iinitializewithitem)或 [**IItinitializeWithFile**](/windows/win32/api/propsys/nn-propsys-iinitializewithfile)。</span><span class="sxs-lookup"><span data-stu-id="dfb2b-220">In Windows Vista and later, all handlers must use one of the following interfaces to initialize the handler: [**IInitializeWithStream**](/windows/win32/api/propsys/nn-propsys-iinitializewithstream), [**IInitializeWithItem**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-iinitializewithitem), or [**IItinitializeWithFile**](/windows/win32/api/propsys/nn-propsys-iinitializewithfile).</span></span>

<span data-ttu-id="dfb2b-221">下表列出高階開發人員工作、每項工作所需的處理常式類型，並提供有關如何執行每項工作之概念資訊的連結。</span><span class="sxs-lookup"><span data-stu-id="dfb2b-221">The following table lists high-level developer tasks, the type of handler needed for each task, and provides a link to conceptual information about how to perform each task.</span></span>



| <span data-ttu-id="dfb2b-222">Task</span><span class="sxs-lookup"><span data-stu-id="dfb2b-222">Task</span></span>                                                                                                                                                            | <span data-ttu-id="dfb2b-223">處理常式</span><span class="sxs-lookup"><span data-stu-id="dfb2b-223">Handler</span></span>                          | <span data-ttu-id="dfb2b-224">概念資訊</span><span class="sxs-lookup"><span data-stu-id="dfb2b-224">Conceptual information</span></span>                                                                                                                                                                                 |
|-----------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="dfb2b-225">存取檔案的屬性以進行編制索引</span><span class="sxs-lookup"><span data-stu-id="dfb2b-225">Accessing the properties of a file for indexing</span></span>                                                                                                                 | <span data-ttu-id="dfb2b-226">屬性處理常式</span><span class="sxs-lookup"><span data-stu-id="dfb2b-226">Property handler</span></span>                 | [<span data-ttu-id="dfb2b-227">開發屬性處理常式</span><span class="sxs-lookup"><span data-stu-id="dfb2b-227">Developing Property Handlers</span></span>](-search-3x-wds-extidx-propertyhandlers.md)<br/> [<span data-ttu-id="dfb2b-228">自訂檔案格式的系統定義屬性</span><span class="sxs-lookup"><span data-stu-id="dfb2b-228">System-Defined Properties for Custom File Formats</span></span>](-shell-systemdefinedpropertiesforfileformats.md)<br/> |
| <span data-ttu-id="dfb2b-229">為數據物件新增剪貼簿格式 (專案的 [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject))  (資料物件用於拖放和複製/貼上案例中。 ) </span><span class="sxs-lookup"><span data-stu-id="dfb2b-229">Adding clipboard formats for the data object ([**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject)) of an item (Data objects are used in drag-and-drop and copy/paste scenarios.)</span></span> | <span data-ttu-id="dfb2b-230">資料物件處理常式</span><span class="sxs-lookup"><span data-stu-id="dfb2b-230">Data object handler</span></span>              | <span data-ttu-id="dfb2b-231">[建立資料處理程式](/previous-versions/windows/desktop/legacy/cc144163(v=vs.85))</span><span class="sxs-lookup"><span data-stu-id="dfb2b-231">[Creating Data Handlers](/previous-versions/windows/desktop/legacy/cc144163(v=vs.85))</span></span>                                                                                                                                                          |
| <span data-ttu-id="dfb2b-232">為一般顯示在快捷方式功能表中的專案新增動詞</span><span class="sxs-lookup"><span data-stu-id="dfb2b-232">Adding verbs for an item that are commonly displayed in a shortcut menu</span></span>                                                                                         | <span data-ttu-id="dfb2b-233">快速鍵功能表處理常式</span><span class="sxs-lookup"><span data-stu-id="dfb2b-233">Shortcut menu handler</span></span>            | [<span data-ttu-id="dfb2b-234">建立內容功能表處理常式</span><span class="sxs-lookup"><span data-stu-id="dfb2b-234">Creating Context Menu Handlers</span></span>](../shell/context-menu-handlers.md)<br/> [<span data-ttu-id="dfb2b-235">使用動態動詞自訂快捷方式功能表</span><span class="sxs-lookup"><span data-stu-id="dfb2b-235">Customizing a Shortcut Menu Using Dynamic Verbs</span></span>](../shell/shortcut-menu-using-dynamic-verbs.md)<br/>                         |
| <span data-ttu-id="dfb2b-236">建立檔案類型與特定圖示的關聯</span><span class="sxs-lookup"><span data-stu-id="dfb2b-236">Associating a file type with a specific icon</span></span>                                                                                                                    | <span data-ttu-id="dfb2b-237">圖示處理常式</span><span class="sxs-lookup"><span data-stu-id="dfb2b-237">Icon handler</span></span>                     | [<span data-ttu-id="dfb2b-238">建立圖示處理常式</span><span class="sxs-lookup"><span data-stu-id="dfb2b-238">Creating Icon Handlers</span></span>](../shell/how-to-create-icon-handlers.md)                                                                                                                                                          |
| <span data-ttu-id="dfb2b-239">使用可允許自訂與檔案類型互動的 UI 圖片和控制項來建立屬性工作表</span><span class="sxs-lookup"><span data-stu-id="dfb2b-239">Creating property sheets with UI pictures and controls that permit custom interaction with a file type</span></span>                                                          | <span data-ttu-id="dfb2b-240">屬性工作表處理常式</span><span class="sxs-lookup"><span data-stu-id="dfb2b-240">Property sheet handler</span></span>           | <span data-ttu-id="dfb2b-241">[屬性工作表處理常式](/previous-versions/windows/desktop/legacy/cc144106(v=vs.85))</span><span class="sxs-lookup"><span data-stu-id="dfb2b-241">[Property Sheet Handlers](/previous-versions/windows/desktop/legacy/cc144106(v=vs.85))</span></span>                                                                                                                                                    |
| <span data-ttu-id="dfb2b-242">啟用專案類型以支援拖放和複製/貼上案例</span><span class="sxs-lookup"><span data-stu-id="dfb2b-242">Enabling an item type to support drag-and-drop and copy/paste scenarios</span></span>                                                                                         | <span data-ttu-id="dfb2b-243">捨棄處理常式</span><span class="sxs-lookup"><span data-stu-id="dfb2b-243">Drop handler</span></span>                     | <span data-ttu-id="dfb2b-244">[使用拖放和剪貼簿傳送 Shell 物件](/previous-versions/windows/desktop/legacy/bb776905(v=vs.85))</span><span class="sxs-lookup"><span data-stu-id="dfb2b-244">[Transferring Shell Objects with Drag-and-Drop and the Clipboard](/previous-versions/windows/desktop/legacy/bb776905(v=vs.85))</span></span>                                                                                                                      |
| <span data-ttu-id="dfb2b-245">解壓縮文字和檔案屬性的區塊以進行索引</span><span class="sxs-lookup"><span data-stu-id="dfb2b-245">Extracting chunks of text and document properties for indexing</span></span>                                                                                                  | <span data-ttu-id="dfb2b-246">篩選處理常式</span><span class="sxs-lookup"><span data-stu-id="dfb2b-246">Filter handler</span></span>                   | [<span data-ttu-id="dfb2b-247">開發篩選處理常式</span><span class="sxs-lookup"><span data-stu-id="dfb2b-247">Developing Filter Handlers</span></span>](-search-ifilter-conceptual.md)                                                                                                                                           |
| <span data-ttu-id="dfb2b-248">建立新檔案類型的索引</span><span class="sxs-lookup"><span data-stu-id="dfb2b-248">Indexing a new file type</span></span>                                                                                                                                        | <span data-ttu-id="dfb2b-249">篩選處理常式，屬性處理常式</span><span class="sxs-lookup"><span data-stu-id="dfb2b-249">Filter handler, property handler</span></span> | [<span data-ttu-id="dfb2b-250">開發篩選處理常式</span><span class="sxs-lookup"><span data-stu-id="dfb2b-250">Developing Filter Handlers</span></span>](-search-ifilter-conceptual.md)<br/> [<span data-ttu-id="dfb2b-251">開發屬性處理常式</span><span class="sxs-lookup"><span data-stu-id="dfb2b-251">Developing Property Handlers</span></span>](-search-3x-wds-extidx-propertyhandlers.md)<br/>                                          |
| <span data-ttu-id="dfb2b-252">為數據存放區的內容編制索引</span><span class="sxs-lookup"><span data-stu-id="dfb2b-252">Indexing the contents of a data store</span></span>                                                                                                                           | <span data-ttu-id="dfb2b-253">通訊協定處理常式</span><span class="sxs-lookup"><span data-stu-id="dfb2b-253">Protocol handler</span></span>                 | [<span data-ttu-id="dfb2b-254">開發通訊協定處理常式</span><span class="sxs-lookup"><span data-stu-id="dfb2b-254">Developing Protocol Handlers</span></span>](-search-3x-wds-phaddins.md)                                                                                                                                            |
| <span data-ttu-id="dfb2b-255">在 Windows 檔案總管預覽窗格中預覽 Shell 專案的簡化視圖</span><span class="sxs-lookup"><span data-stu-id="dfb2b-255">Previewing a simplified view of the Shell item in the Windows Explorer preview pane</span></span>                                                                             | <span data-ttu-id="dfb2b-256">預覽處理常式</span><span class="sxs-lookup"><span data-stu-id="dfb2b-256">Preview handler</span></span>                  | [<span data-ttu-id="dfb2b-257">預覽處理常式</span><span class="sxs-lookup"><span data-stu-id="dfb2b-257">Preview Handlers</span></span>](../shell/preview-handlers.md)                                                                                                                                                             |
| <span data-ttu-id="dfb2b-258">當滑鼠停留在 UI 物件上時提供快顯文字</span><span class="sxs-lookup"><span data-stu-id="dfb2b-258">Supplying pop-up text when a mouse hovers over a UI object</span></span>                                                                                                      | <span data-ttu-id="dfb2b-259">資訊提示處理常式</span><span class="sxs-lookup"><span data-stu-id="dfb2b-259">Infotip handler</span></span>                  | <span data-ttu-id="dfb2b-260">[建立 Shell 擴充處理常式](../shell/handlers.md) (提示自訂) </span><span class="sxs-lookup"><span data-stu-id="dfb2b-260">[Creating Shell Extension Handlers](../shell/handlers.md) (Infotip Customization)</span></span>                                                                                                                            |
| <span data-ttu-id="dfb2b-261">提供靜態影像以表示 Shell 專案</span><span class="sxs-lookup"><span data-stu-id="dfb2b-261">Supplying a static image to represent a Shell item</span></span>                                                                                                              | <span data-ttu-id="dfb2b-262">縮圖處理常式</span><span class="sxs-lookup"><span data-stu-id="dfb2b-262">Thumbnail handler</span></span>                | <span data-ttu-id="dfb2b-263">[縮圖處理常式](/previous-versions/windows/desktop/legacy/cc144118(v=vs.85))</span><span class="sxs-lookup"><span data-stu-id="dfb2b-263">[Thumbnail Handlers](/previous-versions/windows/desktop/legacy/cc144118(v=vs.85))</span></span>                                                                                                                                                        |



 

<span data-ttu-id="dfb2b-264">下表列出處理常式的處理常式和介面，以及用來執行每一種處理常式的介面。</span><span class="sxs-lookup"><span data-stu-id="dfb2b-264">The following table lists handlers and the interfaces for implementing each type of handler.</span></span>



| <span data-ttu-id="dfb2b-265">處理常式</span><span class="sxs-lookup"><span data-stu-id="dfb2b-265">Handler</span></span>                | <span data-ttu-id="dfb2b-266">介面</span><span class="sxs-lookup"><span data-stu-id="dfb2b-266">Interfaces</span></span>                                                                                                                                                                                                                                                                                                                                                                |
|------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="dfb2b-267">捨棄處理常式</span><span class="sxs-lookup"><span data-stu-id="dfb2b-267">Drop handler</span></span>           | <span data-ttu-id="dfb2b-268">[**IDropTarget**](/windows/win32/api/oleidl/nn-oleidl-idroptarget)、 [**IDropTargetHelper**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-idroptargethelper)、 [**IPersistFile**](/windows/win32/api/objidl/nn-objidl-ipersistfile)、 [**IShellExtInit**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellextinit)</span><span class="sxs-lookup"><span data-stu-id="dfb2b-268">[**IDropTarget**](/windows/win32/api/oleidl/nn-oleidl-idroptarget), [**IDropTargetHelper**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-idroptargethelper), [**IPersistFile**](/windows/win32/api/objidl/nn-objidl-ipersistfile), [**IShellExtInit**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellextinit)</span></span>                                                                                                                                                                                                      |
| <span data-ttu-id="dfb2b-269">資料物件處理常式</span><span class="sxs-lookup"><span data-stu-id="dfb2b-269">Data object handler</span></span>    | <span data-ttu-id="dfb2b-270">[**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject)、 [ **IPersistFile**](/windows/win32/api/objidl/nn-objidl-ipersistfile)</span><span class="sxs-lookup"><span data-stu-id="dfb2b-270">[**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject), [**IPersistFile**](/windows/win32/api/objidl/nn-objidl-ipersistfile)</span></span>                                                                                                                                                                                                                                                                                                  |
| <span data-ttu-id="dfb2b-271">篩選處理常式</span><span class="sxs-lookup"><span data-stu-id="dfb2b-271">Filter handler</span></span>         | [<span data-ttu-id="dfb2b-272">**IFilter**</span><span class="sxs-lookup"><span data-stu-id="dfb2b-272">**IFilter**</span></span>](/windows/win32/api/filter/nn-filter-ifilter)<br/>                                                                                                                                                                                                                                                                                                                             |
| <span data-ttu-id="dfb2b-273">圖示處理常式</span><span class="sxs-lookup"><span data-stu-id="dfb2b-273">Icon handler</span></span>           | [<span data-ttu-id="dfb2b-274">**IExtractIcon**</span><span class="sxs-lookup"><span data-stu-id="dfb2b-274">**IExtractIcon**</span></span>](/windows/win32/api/shlobj_core/nn-shlobj_core-iextracticona)<br/> <span data-ttu-id="dfb2b-275">選用： [**IPersist**](/windows/win32/api/objidl/nn-objidl-ipersist)、 [**IPersistFile**](/windows/win32/api/objidl/nn-objidl-ipersistfile)</span><span class="sxs-lookup"><span data-stu-id="dfb2b-275">Optional: [**IPersist**](/windows/win32/api/objidl/nn-objidl-ipersist), [**IPersistFile**](/windows/win32/api/objidl/nn-objidl-ipersistfile)</span></span><br/>                                                                                                                                                                                                                                 |
| <span data-ttu-id="dfb2b-276">資訊提示處理常式</span><span class="sxs-lookup"><span data-stu-id="dfb2b-276">Infotip handler</span></span>        | [<span data-ttu-id="dfb2b-277">**IQueryInfo**</span><span class="sxs-lookup"><span data-stu-id="dfb2b-277">**IQueryInfo**</span></span>](/windows/win32/api/shlobj_core/nn-shlobj_core-iqueryinfo)                                                                                                                                                                                                                                                                                                                                        |
| <span data-ttu-id="dfb2b-278">預覽處理常式</span><span class="sxs-lookup"><span data-stu-id="dfb2b-278">Preview handler</span></span>        | [<span data-ttu-id="dfb2b-279">**IPreviewHandler**</span><span class="sxs-lookup"><span data-stu-id="dfb2b-279">**IPreviewHandler**</span></span>](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ipreviewhandler)                                                                                                                                                                                                                                                                                                                              |
| <span data-ttu-id="dfb2b-280">屬性處理常式</span><span class="sxs-lookup"><span data-stu-id="dfb2b-280">Property handler</span></span>       | [<span data-ttu-id="dfb2b-281">**IPropertyStore**</span><span class="sxs-lookup"><span data-stu-id="dfb2b-281">**IPropertyStore**</span></span>](/windows/win32/api/propsys/nn-propsys-ipropertystore)                                                                                                                                                                                                                                                                                                                           |
| <span data-ttu-id="dfb2b-282">通訊協定處理常式</span><span class="sxs-lookup"><span data-stu-id="dfb2b-282">Protocol handler</span></span>       | <span data-ttu-id="dfb2b-283">[**IFilter**](/windows/win32/api/filter/nn-filter-ifilter)、 [**ISearchProtocol**](/windows/win32/api/Searchapi/nn-searchapi-isearchprotocol)、 [**IUrlAccessor**](/windows/win32/api/Searchapi/nn-searchapi-iurlaccessor)</span><span class="sxs-lookup"><span data-stu-id="dfb2b-283">[**IFilter**](/windows/win32/api/filter/nn-filter-ifilter), [**ISearchProtocol**](/windows/win32/api/Searchapi/nn-searchapi-isearchprotocol), [**IUrlAccessor**](/windows/win32/api/Searchapi/nn-searchapi-iurlaccessor)</span></span><br/> <span data-ttu-id="dfb2b-284">選用： [**ISearchProtocol2**](/windows/win32/api/Searchapi/nn-searchapi-isearchprotocol2)、 [**IUrlAccessor2**](/windows/win32/api/Searchapi/nn-searchapi-iurlaccessor2)、 [**IUrlAccessor3**](/windows/win32/api/Searchapi/nn-searchapi-iurlaccessor3)、 [**IUrlAccessor4**](/windows/win32/api/Searchapi/nn-searchapi-iurlaccessor4)</span><span class="sxs-lookup"><span data-stu-id="dfb2b-284">Optional: [**ISearchProtocol2**](/windows/win32/api/Searchapi/nn-searchapi-isearchprotocol2), [**IUrlAccessor2**](/windows/win32/api/Searchapi/nn-searchapi-iurlaccessor2), [**IUrlAccessor3**](/windows/win32/api/Searchapi/nn-searchapi-iurlaccessor3), [**IUrlAccessor4**](/windows/win32/api/Searchapi/nn-searchapi-iurlaccessor4)</span></span><br/> |
| <span data-ttu-id="dfb2b-285">屬性工作表處理常式</span><span class="sxs-lookup"><span data-stu-id="dfb2b-285">Property sheet handler</span></span> | <span data-ttu-id="dfb2b-286">[**IShellExtInit**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellextinit)、 [ **IShellPropSheetExt**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellpropsheetext)</span><span class="sxs-lookup"><span data-stu-id="dfb2b-286">[**IShellExtInit**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellextinit), [**IShellPropSheetExt**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellpropsheetext)</span></span>                                                                                                                                                                                                                                                                              |
| <span data-ttu-id="dfb2b-287">快速鍵功能表處理常式</span><span class="sxs-lookup"><span data-stu-id="dfb2b-287">Shortcut menu handler</span></span>  | <span data-ttu-id="dfb2b-288">[**ICoNtextMenu**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-icontextmenu)、 [**IExplorerCommand**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-iexplorercommand)、 [**IShellExtInit**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellextinit)</span><span class="sxs-lookup"><span data-stu-id="dfb2b-288">[**IContextMenu**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-icontextmenu), [**IExplorerCommand**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-iexplorercommand), [**IShellExtInit**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellextinit)</span></span>                                                                                                                                                                                                                                          |
| <span data-ttu-id="dfb2b-289">縮圖處理常式</span><span class="sxs-lookup"><span data-stu-id="dfb2b-289">Thumbnail handler</span></span>      | [<span data-ttu-id="dfb2b-290">**IThumbnailProvider**</span><span class="sxs-lookup"><span data-stu-id="dfb2b-290">**IThumbnailProvider**</span></span>](/windows/win32/api/thumbcache/nn-thumbcache-ithumbnailprovider)                                                                                                                                                                                                                                                                                                                        |



 

> [!Note]  
> <span data-ttu-id="dfb2b-291">屬性處理常式有時候會 kown 為元資料處理程式。</span><span class="sxs-lookup"><span data-stu-id="dfb2b-291">A property handler is sometimes kown as a metadata handler.</span></span> <span data-ttu-id="dfb2b-292">Shell 資料來源有時也稱為 Shell 命名空間延伸模組。</span><span class="sxs-lookup"><span data-stu-id="dfb2b-292">A Shell data source is sometimes known as a Shell namespace extension.</span></span> <span data-ttu-id="dfb2b-293">檔案類型處理常式有時也稱為 Shell 擴充處理常式或 Shell 延伸模組。</span><span class="sxs-lookup"><span data-stu-id="dfb2b-293">A file type handler is sometimes known as a Shell extension handler or a Shell extension.</span></span>

 

<span data-ttu-id="dfb2b-294">如需建立處理常式的詳細資訊，請參閱 [建立 Shell 擴充處理常式](../shell/handlers.md)。</span><span class="sxs-lookup"><span data-stu-id="dfb2b-294">For more information about creating handlers, see [Creating Shell Extension Handlers](../shell/handlers.md).</span></span> <span data-ttu-id="dfb2b-295">如需屬性的詳細資訊，請參閱 [Windows 屬性系統](../properties/windows-properties-system.md)。</span><span class="sxs-lookup"><span data-stu-id="dfb2b-295">For more information about properties, see [Windows Property System](../properties/windows-properties-system.md).</span></span>

## <a name="add-in-installer-guidelines"></a><span data-ttu-id="dfb2b-296">增益集安裝程式指導方針</span><span class="sxs-lookup"><span data-stu-id="dfb2b-296">Add-in Installer Guidelines</span></span>

<span data-ttu-id="dfb2b-297">建立增益集安裝程式時，請使用下列指導方針：</span><span class="sxs-lookup"><span data-stu-id="dfb2b-297">Use the following guidelines when creating an Add-in installer:</span></span>

-   <span data-ttu-id="dfb2b-298">安裝程式必須使用 EXE 或 MSI 安裝程式。</span><span class="sxs-lookup"><span data-stu-id="dfb2b-298">The installer must use either the EXE or MSI installer.</span></span>
-   <span data-ttu-id="dfb2b-299">必須提供版本資訊。</span><span class="sxs-lookup"><span data-stu-id="dfb2b-299">Release notes must be provided.</span></span>
-   <span data-ttu-id="dfb2b-300">每個安裝的增益集都必須建立 [ **新增/移除程式** ] 專案。</span><span class="sxs-lookup"><span data-stu-id="dfb2b-300">An **Add/Remove Programs** entry must be created for each add-in installed.</span></span>
-   <span data-ttu-id="dfb2b-301">安裝程式必須接管目前增益集所瞭解的特定檔案類型或存放區的所有登錄設定。</span><span class="sxs-lookup"><span data-stu-id="dfb2b-301">The installer must take over all registry settings for the particular file type or store that the current add-in understands.</span></span>
-   <span data-ttu-id="dfb2b-302">如果先前的增益集遭到覆寫，安裝程式應通知使用者。</span><span class="sxs-lookup"><span data-stu-id="dfb2b-302">If a previous add-in is being overwritten, the installer should notify the user.</span></span>
-   <span data-ttu-id="dfb2b-303">如果較新的增益集已覆寫先前的增益集，使用者應該能夠還原先前增益集的功能，並將它再次設為該檔案類型或存放區的預設增益集。</span><span class="sxs-lookup"><span data-stu-id="dfb2b-303">If a newer add-in has overwritten a previous add-in, the user should be able to restore the previous add-in's functionality and make it the default add-in again for that file type or store.</span></span>

## <a name="note-to-implementers"></a><span data-ttu-id="dfb2b-304">實施者注意事項</span><span class="sxs-lookup"><span data-stu-id="dfb2b-304">Note to Implementers</span></span>

<span data-ttu-id="dfb2b-305">建立篩選器或屬性處理常式之前，開發人員應該考慮下列事項：</span><span class="sxs-lookup"><span data-stu-id="dfb2b-305">Before creating a filter or property handler, developers should consider the following:</span></span>

-   <span data-ttu-id="dfb2b-306">這些處理常式是載入至您無法控制之進程的同進程擴充，例如篩選背景程式進程、Windows 檔案總管 (grep 搜尋) 以及 Windows Mail) 等協力廠商主機。</span><span class="sxs-lookup"><span data-stu-id="dfb2b-306">These handlers are in-process extensions that are loaded into processes that you do not control, such as the filter daemon process, Windows Explorer (grep search), and third-party hosts like Windows Mail).</span></span>
-   <span data-ttu-id="dfb2b-307">您必須撰寫穩固的安全程式碼，以處理所建立用來攻擊系統的檔案格式的任意損毀形式。</span><span class="sxs-lookup"><span data-stu-id="dfb2b-307">You must write secure code that is robust enough to handle arbitrarily corrupt forms of your file format that were created to attack the system.</span></span>
-   <span data-ttu-id="dfb2b-308">您的增益集不能洩漏會產生主機進程問題的資源。</span><span class="sxs-lookup"><span data-stu-id="dfb2b-308">Your add-in must not leak resources that will produce problems for the host processes.</span></span>
-   <span data-ttu-id="dfb2b-309">您的增益集不會當機，因為這也會讓主機進程損毀，並減緩篩選進程的速度。</span><span class="sxs-lookup"><span data-stu-id="dfb2b-309">Your add-in must not crash as this will also crash the host processes and slow down the filtering process.</span></span>
-   <span data-ttu-id="dfb2b-310">因為這些處理常式是在背景系統進程中執行，所以它們必須快速執行，而且必須使用最少的 CPU 和 i/o，才能符合系統的效能需求。</span><span class="sxs-lookup"><span data-stu-id="dfb2b-310">Because these handlers are run in a background system process, they must perform quickly with a minimum of CPU and I/O consumed in order to meet the performance requirements of the system.</span></span>

<span data-ttu-id="dfb2b-311">因此，開發人員應該撰寫這些增益集，以建立系統層級程式碼的專業知識。</span><span class="sxs-lookup"><span data-stu-id="dfb2b-311">Thus, these add-ins should be written by developers with expertise in creating system-level code.</span></span>

## <a name="additional-resources"></a><span data-ttu-id="dfb2b-312">其他資源</span><span class="sxs-lookup"><span data-stu-id="dfb2b-312">Additional Resources</span></span>

-   <span data-ttu-id="dfb2b-313">如需建立 Shell 資料來源的詳細資訊，請參閱 [執行基本資料夾物件介面](/previous-versions/windows/desktop/legacy/cc144093(v=vs.85))。</span><span class="sxs-lookup"><span data-stu-id="dfb2b-313">For information about creating a Shell data source, see [Implementing the Basic Folder Object Interfaces](/previous-versions/windows/desktop/legacy/cc144093(v=vs.85)).</span></span>
-   <span data-ttu-id="dfb2b-314">對於需要使用 Shell 預設系統資料夾 View 物件 (DefView) 的資料來源，請參閱 [執行資料夾檢視](../lwef/nse-folderview.md)、 [**SHCreateShellFolderView**](/windows/win32/api/shlobj_core/nf-shlobj_core-shcreateshellfolderview) 函式和 [**SFV \_ CREATE**](/windows/win32/api/shlobj_core/ns-shlobj_core-sfv_create) structure。</span><span class="sxs-lookup"><span data-stu-id="dfb2b-314">For data sources that need to use the Shell Default System Folder View Object (DefView), see [Implementing a Folder View](../lwef/nse-folderview.md), [**SHCreateShellFolderView**](/windows/win32/api/shlobj_core/nf-shlobj_core-shcreateshellfolderview) function, and [**SFV\_CREATE**](/windows/win32/api/shlobj_core/ns-shlobj_core-sfv_create) structure.</span></span> <span data-ttu-id="dfb2b-315">使用 Shell 預設系統資料夾 View 物件 (DefView) 的資料來源必須執行下列一組介面： [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder)、 [**IShellFolder2**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder2)、 [**IPersistFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ipersistfolder)、 [**IPersistFolder2**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ipersistfolder2)和 (選擇性地) [**IPersistFolder3**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ipersistfolder3)。</span><span class="sxs-lookup"><span data-stu-id="dfb2b-315">Data sources that use the Shell Default System Folder View Object (DefView) must implement the following set of interfaces: [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder), [**IShellFolder2**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder2), [**IPersistFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ipersistfolder), [**IPersistFolder2**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ipersistfolder2), and (optionally) [**IPersistFolder3**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ipersistfolder3).</span></span> <span data-ttu-id="dfb2b-316">如果您的 **IShellFolder** 執行不使用 **SHCreateShellFolderView** 來建立 DefView，Shell View 物件可能需要 [**IFolderView**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifolderview)。</span><span class="sxs-lookup"><span data-stu-id="dfb2b-316">If your **IShellFolder** implementation does not use **SHCreateShellFolderView** to create the DefView, the Shell view object may need [**IFolderView**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifolderview).</span></span>
-   <span data-ttu-id="dfb2b-317">[**ISearchFolderItemFactory**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-isearchfolderitemfactory) 是 Shell 資料來源取用者的主要介面，稱為 DBFolder。</span><span class="sxs-lookup"><span data-stu-id="dfb2b-317">[**ISearchFolderItemFactory**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-isearchfolderitemfactory) is the primary interface for consumers of the Shell data source known as DBFolder.</span></span> <span data-ttu-id="dfb2b-318">如需 DBFolder 的詳細資訊，請參閱系結 \_ \_ \_ [**內容字串索引鍵**](../shell/str-constants.md)中的 STR PARSE 與 PROPERTIES 常數的描述。</span><span class="sxs-lookup"><span data-stu-id="dfb2b-318">For more information about DBFolder, see the description of the STR\_PARSE\_WITH\_PROPERTIES constant in [**Bind Context String Keys**](../shell/str-constants.md).</span></span> <span data-ttu-id="dfb2b-319">另請參閱 [關聯陣列](/previous-versions/windows/desktop/legacy/ee872122(v=vs.85)) 和 [**IPropertySystem：： GetPropertyDescriptionListFromString**](/windows/win32/api/propsys/nf-propsys-ipropertysystem-getpropertydescriptionlistfromstring)。</span><span class="sxs-lookup"><span data-stu-id="dfb2b-319">See also [Association Arrays](/previous-versions/windows/desktop/legacy/ee872122(v=vs.85)) and [**IPropertySystem::GetPropertyDescriptionListFromString**](/windows/win32/api/propsys/nf-propsys-ipropertysystem-getpropertydescriptionlistfromstring).</span></span>
-   <span data-ttu-id="dfb2b-320">如需 OLE DB 的詳細資訊，請參閱 [OLE DB 程式設計總覽](https://msdn.microsoft.com/library/5d8sd9we(VS.71).aspx)。</span><span class="sxs-lookup"><span data-stu-id="dfb2b-320">For information on OLE DB, see [OLE DB Programming Overview](https://msdn.microsoft.com/library/5d8sd9we(VS.71).aspx).</span></span> <span data-ttu-id="dfb2b-321">如需 OLE DB 之 .NET Framework Data Provider 的詳細資訊，請參閱 system.string [命名空間](/dotnet/api/system.data.oledb?view=dotnet-plat-ext-3.1) 檔。</span><span class="sxs-lookup"><span data-stu-id="dfb2b-321">For information on the .NET Framework Data Provider for OLE DB, see the [System.Data.OleDb Namespace](/dotnet/api/system.data.oledb?view=dotnet-plat-ext-3.1) documentation.</span></span>
-   <span data-ttu-id="dfb2b-322">如需搜尋技術上支援社區的訊息面板，請參閱 MSDN 上的 [Windows：搜尋論壇](https://social.msdn.microsoft.com/Forums/windowsdesktopsearchdevelopment/threads) （英文）。</span><span class="sxs-lookup"><span data-stu-id="dfb2b-322">For community-supported message boards on Search technologies, see [Windows: Search Forums](https://social.msdn.microsoft.com/Forums/windowsdesktopsearchdevelopment/threads) on MSDN.</span></span>
-   <span data-ttu-id="dfb2b-323">如需相關的程式碼範例，請參閱 [Windows Search 程式碼範例](-search-samples-ovw.md)。</span><span class="sxs-lookup"><span data-stu-id="dfb2b-323">For related code samples, see [Windows Search Code Samples](-search-samples-ovw.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="dfb2b-324">相關主題</span><span class="sxs-lookup"><span data-stu-id="dfb2b-324">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="dfb2b-325">Windows Search 概觀</span><span class="sxs-lookup"><span data-stu-id="dfb2b-325">Windows Search Overview</span></span>](-search-3x-wds-overview.md)
</dt> <dt>

[<span data-ttu-id="dfb2b-326">Windows Search 支援的語言</span><span class="sxs-lookup"><span data-stu-id="dfb2b-326">Languages Supported by Windows Search</span></span>](-search-3x-wds-language-support.md)
</dt> <dt>

[<span data-ttu-id="dfb2b-327">搭配 Shell 資料和 Windows Search 使用 Managed 程式碼</span><span class="sxs-lookup"><span data-stu-id="dfb2b-327">Using Managed Code with Shell Data and Windows Search</span></span>](-search-3x-wds-managed-code.md)
</dt> <dt>

[<span data-ttu-id="dfb2b-328">Windows Search 開發人員指南</span><span class="sxs-lookup"><span data-stu-id="dfb2b-328">Windows Search Developer's Guide</span></span>](-search-developers-guide-entry-page.md)
</dt> </dl>

 

 
