---
description: 儲存在內容索引中的資料行可以有多個值，而且可以使用陣列比較述詞來比較這些多重值資料行。
ms.assetid: bc3de1bd-b833-459d-81a3-c6b08314e26f
title: 多重值 (陣列) 比較
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 043ed6744717ac3156d9dd64f2f6806f2ffc509107f5bcdc8a66980e5cdd0012
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/11/2021
ms.locfileid: "117863367"
---
# <a name="multi-valued-array-comparisons"></a>多重值 (陣列) 比較

儲存在內容索引中的資料行可以有多個值，而且可以使用陣列比較述詞來比較這些多重值資料行。

陣列比較述詞具有下列語法：


```
...WHERE <column> <comp_op> [<quantifier>] <comparison_list>
                
...WHERE <column> <comp_op> <value>
```



如果資料行參考不是多重值資料行，則會傳回錯誤。 資料行資料類型必須與比較清單的元素相容。 如有必要，資料行參考可以 [轉換](-search-sql-castingdatacolumntype.md) 成另一種資料類型。

比較運算子 (的複合 \_ op) 可以是任何一般的比較運算子。 在多重值比較中，比較運算子的意義會因是否使用數量詞而有些許不同。 數量詞會識別是否應針對比較清單中的所有或部分值進行比較。 比較運算子的函式會在描述每個數量詞 (全部的資料表中提供，本檔稍後會有一些) 。

運算子之後的值會指定與多值資料行的所有元素比較的單一常值。 如果有任何專案符合該值，則述詞為 true。

比較清單會指定與多值資料行比較的常值陣列。 比較清單的語法如下：


```
ARRAY '['<literal> [,<literal>]']'
```



> [!IMPORTANT]
> 請留意比較清單語法。 組成比較清單的常值群組必須以方括弧括住。 請勿以方括弧括住比較清單的個別元素。 因此，陣列 \[ 1 \] 和陣列 \[ 1、2、3 \] 是有效的，但陣列 \[ 1 \[ 、2 \] \[ 、3 \] \] 則否。

 

用來判斷多重值比較是否傳回 true 或 false 的方法是由選擇性數量詞所指定。 下列各節描述每個數量詞，以及每個比較運算子在使用數量詞時的運作方式。

## <a name="absent-quantifier"></a>遺漏數量詞

如果未指定數量詞，則比較左邊的每個專案都會與右邊的相同位置中的元素進行比較。 比較是以陣列中的第一個元素為開頭，並進行最後一個元素。 如果左邊的所有元素都相當於右邊的對應專案，則會使用陣列元素的數目來判斷哪個陣列較大。

下表顯示未指定數量詞時，比較運算子的作業，並提供每個量值的簡短描述。



| 運算子       | 描述                                                                                                                                                                                                                                                                                                                                                                           |
|----------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| =              | 當每個左邊專案的值與對應的右邊元素相同，而且這兩個數組具有相同數目的專案時，「等於」就會傳回 true。                                                                                                                                                                                                                     |
| ！ = 或 <> | 當一或多個左邊專案的值與對應的右端元素不同，或左邊和右邊的陣列沒有相同數目的專案時，' Not 等於 ' 會傳回 true。                                                                                                                                                              |
| >           | 當每個左邊專案的值大於對應右邊元素的值時，' 大於 ' 會傳回 true。 如果所有左邊的元素值完全符合對應的右端元素，而左邊的陣列有比右邊陣列更多的元素，則 ' 大於 ' 會傳回 true。                                                     |
| >=          | 當每個左邊專案的值大於或等於相對應右邊元素的值時，' 大於或等於 ' 會傳回 true。 如果所有左邊的元素值等於或大於對應的右端元素，而且左邊的陣列具有和右邊陣列相同或更多的元素，則 ' 大於 ' 會傳回 true。 |
| <           | 當每個左邊專案的值小於對應右邊元素的值時，' 小於 ' 會傳回 true。 當左邊的元素比右邊少時，' 小於 ' 也會傳回 true。                                                                                                                                                  |
| <=          | 當每個左邊專案的值小於或等於相對應右邊元素的值時，' 小於或等於 ' 會傳回 true。 如果所有左邊的元素值等於或小於對應的右端元素，而且左邊的陣列具有和右邊陣列相同或較少的元素，則 ' 大於 ' 會傳回 true。         |



 

## <a name="all-quantifier"></a>所有數量詞

所有數量詞會指定左邊的每個專案都會與右邊的每個元素進行比較。 若要傳回 true，相較于右邊的每個專案，比較對於左邊的每個專案都必須是 true。 左邊和右邊陣列中的元素數目不會影響結果。

下表顯示每個比較運算子如何與所有數量詞搭配使用。



| 運算子       | 描述                                                                                                                           |
|----------------|---------------------------------------------------------------------------------------------------------------------------------------|
| =              | 當每個左邊的元素值與每個右邊的元素值相同時，' 等於 ' 會傳回 true。                              |
| ！ = 或 <> | 當至少有一個左邊的元素值與任何右邊的元素值不同時，' Not 等於 ' 會傳回 true。 |
| >           | 當每個左邊的元素值大於每個右邊的元素值時，' 大於 ' 會傳回 true。                         |
| >=          | 當每個左邊的元素值大於或等於每個右邊的元素值時，' 大於或等於 ' 會傳回 true。 |
| <           | 當每個左邊的元素值小於每個右邊的元素值時，' 小於 ' 會傳回 true。                               |
| <=          | 當每個左邊的元素值小於或等於每個右邊的元素值時，' 小於或等於 ' 會傳回 true。       |



 

## <a name="some-or-any-quantifier"></a>某些 (或任何) 數量詞

某些數量詞和任何數量詞都可以交替使用。 就像所有數量詞一樣，某些數量詞會指定左邊的每個專案都會與右邊的每個元素進行比較。 若要傳回 true，相較于右邊的任何專案，比較必須為左邊的至少一個元素。 左邊和右邊陣列的元素數目不會影響結果。

下表顯示每個比較運算子如何與某個數量詞搭配使用。



| 運算子       | 描述                                                                                                                                                     |
|----------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------|
| =              | 當至少有一個左邊的元素值與任何右邊的元素值相同時，' 等於 ' 會傳回 true。                                  |
| ！ = 或 <> | 如果沒有左邊的元素值與任何右邊的元素值相同，則「不等於」會傳回 true。                                      |
| >           | 當至少有一個左邊的元素值大於任何一個右邊的元素值時，' 大於 ' 會傳回 true。                         |
| >=          | 當至少有一個左邊的元素值大於或等於任一個右邊的元素值時，' 大於或等於 ' 會傳回 true。 |
| <           | 當至少有一個左邊的元素值小於任何一個右邊的元素值時，' 小於 ' 會傳回 true。                               |
| <=          | 當至少有一個左邊的元素值小於或等於右邊的任何一個元素值時，' 小於或等於 ' 會傳回 true。       |



 

## <a name="examples"></a>範例

下列範例會檢查檔是否為「財務」或「規劃」類別：


```
SELECT System.ItemUrl FROM SystemIndex WHERE System.Category =
SOME ARRAY['Finance','Planning']
```



下列比較全部評估為 true。 請記住，在實際使用中，搜尋查詢語法需要左邊為屬性，而不是常值。


```
ARRAY [1,2] > ARRAY [1,1]
ARRAY [1,2] > ARRAY [1,1,2]
ARRAY [1,2] < ARRAY [1,2,3]
ARRAY [1,2] = SOME ARRAY [1,12,27,35,2]
ARRAY [1,1] != ALL ARRAY [1,2]
ARRAY [1,20,21,22] < SOME ARRAY [0,40]
ARRAY [1,20,21,22] < ANY ARRAY [0,40]
```



## <a name="related-topics"></a>相關主題

<dl> <dt>

**參考**
</dt> <dt>

[LIKE 述詞](-search-sql-like.md)
</dt> <dt>

[常值比較](-search-sql-literalvaluecomparison.md)
</dt> <dt>

[Null 述詞](-search-sql-null.md)
</dt> <dt>

**概念**
</dt> <dt>

[全文檢索述詞](-search-sql-fulltextpredicates.md)
</dt> <dt>

[非全文檢索述詞](-search-sql-nonfulltextpredicates.md)
</dt> </dl>

 

 



