---
description: 為了驅動視覺效果更新，應用程式應該使用 IDirectManipulationCompositor。
ms.assetid: 6D8FB359-F52B-43F9-8A62-6BB2AEDE4F2B
title: 撰寫引擎
ms.topic: article
ms.date: 02/03/2020
ms.openlocfilehash: aa4d922893472c1fe235bae60e41a00924d13bba
ms.sourcegitcommit: a47bd86f517de76374e4fff33cfeb613eb259a7e
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/06/2021
ms.locfileid: "104467661"
---
# <a name="composition-engine"></a><span data-ttu-id="f65c2-103">撰寫引擎</span><span class="sxs-lookup"><span data-stu-id="f65c2-103">Composition engine</span></span>

<span data-ttu-id="f65c2-104">為了驅動視覺效果更新，應用程式應該使用 [**IDirectManipulationCompositor**](/windows/win32/api/DirectManipulation/nn-directmanipulation-idirectmanipulationcompositor)。</span><span class="sxs-lookup"><span data-stu-id="f65c2-104">In order to drive visual updates, the application should use [**IDirectManipulationCompositor**](/windows/win32/api/DirectManipulation/nn-directmanipulation-idirectmanipulationcompositor).</span></span> <span data-ttu-id="f65c2-105">此物件負責根據[直接操作](direct-manipulation-portal.md)更新來更新視覺效果、推動慣性更新，並提供組合計時資訊給直接操作，而且應用程式應該使用[直接操作](direct-manipulation-portal.md)所提供的[DCompManipulationCompositor](direct-manipulation-guids.md) ，這將會代表應用程式處理所有的視覺效果更新，並驅動慣性更新。</span><span class="sxs-lookup"><span data-stu-id="f65c2-105">This object is responsible for updating visuals based on [Direct Manipulation](direct-manipulation-portal.md) updates, driving inertia updates forward, and providing composition timing information to Direct Manipulation Furthermore, an application should use the [DCompManipulationCompositor](direct-manipulation-guids.md) provided by [Direct Manipulation](direct-manipulation-portal.md), which will handle all visual updates on behalf of the application and drive inertia updates.</span></span>

<span data-ttu-id="f65c2-106">[DCompManipulationCompositor](direct-manipulation-guids.md)是包裝 [DirectComposition](../directcomp/directcomposition-portal.md)之 [**IDirectManipulationCompositor**](/windows/win32/api/DirectManipulation/nn-directmanipulation-idirectmanipulationcompositor)介面的實作為。</span><span class="sxs-lookup"><span data-stu-id="f65c2-106">The [DCompManipulationCompositor](direct-manipulation-guids.md) is an implementation of the [**IDirectManipulationCompositor**](/windows/win32/api/DirectManipulation/nn-directmanipulation-idirectmanipulationcompositor) interface that wraps [DirectComposition](../directcomp/directcomposition-portal.md).</span></span> <span data-ttu-id="f65c2-107">透過此組合器物件 [直接操作](direct-manipulation-portal.md) 可以直接在 DirectComposition 樹狀結構上設定轉換來套用輸出，而不是讓應用程式套用輸出。</span><span class="sxs-lookup"><span data-stu-id="f65c2-107">Rather than having the application apply the output, through this compositor object [Direct Manipulation](direct-manipulation-portal.md) can apply the output by setting the transforms directly on the DirectComposition tree.</span></span> <span data-ttu-id="f65c2-108">藉由使用此設定，不論 UI 執行緒上的活動為何，都可以處理輸入並套用輸出轉換。</span><span class="sxs-lookup"><span data-stu-id="f65c2-108">By using this configuration, input can be processed and output transforms can be applied, regardless of activity on the UI thread.</span></span>

<span data-ttu-id="f65c2-109">為了在組合引擎的時間提供 [直接操作](direct-manipulation-portal.md) 資訊， [DCompManipulationCompositor](direct-manipulation-guids.md) 類別會執行 [**IDirectManipulationFrameInfoProvider**](/windows/win32/api/DirectManipulation/nn-directmanipulation-idirectmanipulationframeinfoprovider) 介面。</span><span class="sxs-lookup"><span data-stu-id="f65c2-109">To give [Direct Manipulation](direct-manipulation-portal.md) information on the timing of the composition engine, the [DCompManipulationCompositor](direct-manipulation-guids.md) class implements the [**IDirectManipulationFrameInfoProvider**](/windows/win32/api/DirectManipulation/nn-directmanipulation-idirectmanipulationframeinfoprovider) interface.</span></span> <span data-ttu-id="f65c2-110">建立視口時，會針對 **IDirectManipulationFrameInfoProvider** 的實例，對從 [**CoCreateInstance**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance)取得的 [**IDirectManipulationCompositor**](/windows/win32/api/DirectManipulation/nn-directmanipulation-idirectmanipulationcompositor)指標進行 [**QueryInterface**](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) 。</span><span class="sxs-lookup"><span data-stu-id="f65c2-110">When creating a viewport, [**QueryInterface**](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) the [**IDirectManipulationCompositor**](/windows/win32/api/DirectManipulation/nn-directmanipulation-idirectmanipulationcompositor) pointer obtained from [**CoCreateInstance**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance) for an instance of **IDirectManipulationFrameInfoProvider**.</span></span> <span data-ttu-id="f65c2-111">**IDirectManipulationFrameInfoProvider** 指標會傳遞至 [**IDirectManipulationManager：： CreateViewport ()**](/windows/win32/api/DirectManipulation/nf-directmanipulation-idirectmanipulationmanager-createviewport)函式。</span><span class="sxs-lookup"><span data-stu-id="f65c2-111">The **IDirectManipulationFrameInfoProvider** pointer is passed to the [**IDirectManipulationManager::CreateViewport()**](/windows/win32/api/DirectManipulation/nf-directmanipulation-idirectmanipulationmanager-createviewport) function.</span></span>
