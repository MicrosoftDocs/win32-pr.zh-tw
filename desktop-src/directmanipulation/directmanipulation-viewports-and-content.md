---
description: 直接操作會使用 [內容] 和 [連絡人] 來描述 UI 的互動元素。
ms.assetid: 1564F6F2-844F-4392-9EB5-AA46059D514C
title: 區和內容
ms.topic: article
ms.date: 02/03/2020
ms.openlocfilehash: 9cda367067ea860ce6a42a16e81d38393937276a
ms.sourcegitcommit: a47bd86f517de76374e4fff33cfeb613eb259a7e
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/06/2021
ms.locfileid: "104560604"
---
# <a name="viewports-and-content"></a><span data-ttu-id="3df93-103">區和內容</span><span class="sxs-lookup"><span data-stu-id="3df93-103">Viewports and content</span></span>

<span data-ttu-id="3df93-104">[直接操作](direct-manipulation-portal.md) 會 *使用*[ *內容* ] 和 [ *連絡人* ] 來描述 UI 的互動元素。</span><span class="sxs-lookup"><span data-stu-id="3df93-104">[Direct Manipulation](direct-manipulation-portal.md) uses *viewports*, *contents* and *contacts* to describe the interactive elements of the UI.</span></span>

- [<span data-ttu-id="3df93-105">設定視口</span><span class="sxs-lookup"><span data-stu-id="3df93-105">Configuring a viewport</span></span>](#configuring-a-viewport)
- [<span data-ttu-id="3df93-106">對齊點和界限</span><span class="sxs-lookup"><span data-stu-id="3df93-106">Snap points and boundaries</span></span>](#snap-points-and-boundaries)
- [<span data-ttu-id="3df93-107">貼齊點位移和 RTL 情節</span><span class="sxs-lookup"><span data-stu-id="3df93-107">Snap point offset and RTL scenarios</span></span>](#snap-point-offset-and-rtl-scenarios)
- [<span data-ttu-id="3df93-108">行為</span><span class="sxs-lookup"><span data-stu-id="3df93-108">Behaviors</span></span>](#behaviors)
- [<span data-ttu-id="3df93-109">座標系統</span><span class="sxs-lookup"><span data-stu-id="3df93-109">Coordinate system</span></span>](#coordinate-system)
- [<span data-ttu-id="3df93-110">轉換</span><span class="sxs-lookup"><span data-stu-id="3df93-110">Transforms</span></span>](#transforms)
- [<span data-ttu-id="3df93-111">視窗區狀態</span><span class="sxs-lookup"><span data-stu-id="3df93-111">Viewport state</span></span>](#viewport-state)
- [<span data-ttu-id="3df93-112">相關主題</span><span class="sxs-lookup"><span data-stu-id="3df93-112">Related topics</span></span>](#related-topics)

<span data-ttu-id="3df93-113">*區* 是視窗內的區域，可接收和處理使用者互動的輸入。</span><span class="sxs-lookup"><span data-stu-id="3df93-113">A *viewport* is a region within a window that can receive and process input from user interactions.</span></span> <span data-ttu-id="3df93-114">此區代表使用者在指定時間可以看到的內容區域 (也稱為內容剪輯) 。</span><span class="sxs-lookup"><span data-stu-id="3df93-114">The viewport represents the region of the content that can be seen by the end-user at a given time (also called the content clip).</span></span> <span data-ttu-id="3df93-115">此區有數個函數：</span><span class="sxs-lookup"><span data-stu-id="3df93-115">The viewport has several functions:</span></span>

- <span data-ttu-id="3df93-116">它會管理互動狀態 (例如，當內容已準備好進行操作時、內容正在進行操作時、內容處於慣性動畫) ，以及將輸入對應至輸出轉換時。</span><span class="sxs-lookup"><span data-stu-id="3df93-116">It manages the interaction state (for example, when the content is ready to be manipulated, when content is undergoing manipulation, when content is in inertia animation) and maps input to output transforms.</span></span>
- <span data-ttu-id="3df93-117">它包含可移動以回應使用者互動的內容。</span><span class="sxs-lookup"><span data-stu-id="3df93-117">It contains content that moves in response to the user interaction.</span></span> <span data-ttu-id="3df93-118">這可能是 HTML div 元素 (滾動) 、 (Windows 8 開始畫面) 的平移清單，或選取控制項的快顯功能表。</span><span class="sxs-lookup"><span data-stu-id="3df93-118">This might be an HTML div element (scrolling), a pan-able list (the Windows 8 Start screen), or the pop-up menu for a select control.</span></span>

<span data-ttu-id="3df93-119">您可以藉由呼叫 [**CreateViewport**](/windows/win32/api/DirectManipulation/nf-directmanipulation-idirectmanipulationmanager-createviewport)來建立一個視口。</span><span class="sxs-lookup"><span data-stu-id="3df93-119">A viewport is created by calling [**CreateViewport**](/windows/win32/api/DirectManipulation/nf-directmanipulation-idirectmanipulationmanager-createviewport).</span></span> <span data-ttu-id="3df93-120">您可以在單一視窗中建立多個區，以產生豐富的 UI 體驗。</span><span class="sxs-lookup"><span data-stu-id="3df93-120">Multiple viewports can be created in a single window to produce a rich UI experience.</span></span>

<span data-ttu-id="3df93-121">*內容* 代表為了回應互動而轉換的元素。</span><span class="sxs-lookup"><span data-stu-id="3df93-121">*Content* represents the element that gets transformed in response to an interaction.</span></span> <span data-ttu-id="3df93-122">換句話說，內容是隨著使用者移動或 pinches 而移動或調整的內容。</span><span class="sxs-lookup"><span data-stu-id="3df93-122">In other words, the content is what moves or scales as the user pans or pinches.</span></span> <span data-ttu-id="3df93-123">內容有兩種類型：</span><span class="sxs-lookup"><span data-stu-id="3df93-123">There are two types of content:</span></span>

- <span data-ttu-id="3df93-124">*主要內容* 是在回應輸入操作和慣性之視口內的單一內建函式專案。</span><span class="sxs-lookup"><span data-stu-id="3df93-124">*Primary content* is the single, intrinsic element within a viewport that responds to input manipulations and inertia.</span></span> <span data-ttu-id="3df93-125">主要內容會與區在相同時間建立，且無法從區中新增或移除。</span><span class="sxs-lookup"><span data-stu-id="3df93-125">Primary content is created at the same time as the viewport and cannot be added or removed from a viewport.</span></span> <span data-ttu-id="3df93-126">您可以使用 (稍後) 討論的貼齊點來自訂主要內容的行為。</span><span class="sxs-lookup"><span data-stu-id="3df93-126">You can customize behavior of primary content using snap points (discussed later).</span></span>
- <span data-ttu-id="3df93-127">*次要內容* 會相對於主要內容的移動而移動。</span><span class="sxs-lookup"><span data-stu-id="3df93-127">*Secondary content* moves relative to the motion of primary content.</span></span> <span data-ttu-id="3df93-128">次要內容是與區分開建立的，而且可以從視口中新增或移除。</span><span class="sxs-lookup"><span data-stu-id="3df93-128">Secondary content is created separately from the viewport and can be added or removed from a viewport.</span></span> <span data-ttu-id="3df93-129">所有次要內容轉換都是根據主要內容的轉換進行計算。</span><span class="sxs-lookup"><span data-stu-id="3df93-129">All secondary content transforms are calculated based on the primary content’s transform.</span></span> <span data-ttu-id="3df93-130">您可以套用特定規則來變更轉換的計算方式，方法是根據專案的預定用途（由其 CLSID 在建立期間識別）。</span><span class="sxs-lookup"><span data-stu-id="3df93-130">Specific rules can be applied to change how the transform is calculated based on the intended purpose of the element, identified by its CLSID during creation.</span></span>

<span data-ttu-id="3df93-131">在此圖表中顯示平移前後的位置，使用了單一連絡人來平移主要內容。</span><span class="sxs-lookup"><span data-stu-id="3df93-131">In this diagram showing before and after a pan, a single contact has been used to pan primary content.</span></span> <span data-ttu-id="3df93-132">雖然使用者不會直接與 (次要內容) 的移動流覽指標互動，但次要內容會隨著主要內容移動流覽而移動。</span><span class="sxs-lookup"><span data-stu-id="3df93-132">Even though the user isn't directly interacting with the panning indicator (secondary content), the secondary content moves as the primary content is panned.</span></span> <span data-ttu-id="3df93-133">這可提供視覺提示給使用者移動流覽的程度。</span><span class="sxs-lookup"><span data-stu-id="3df93-133">This provides visual cues for how far the user has panned.</span></span>

![顯示平移前後的圖表](images/dm-art-2.png)

## <a name="configuring-a-viewport"></a><span data-ttu-id="3df93-135">設定視口</span><span class="sxs-lookup"><span data-stu-id="3df93-135">Configuring a viewport</span></span>

<span data-ttu-id="3df93-136">建立了視口之後。</span><span class="sxs-lookup"><span data-stu-id="3df93-136">After you've created the viewport.</span></span> <span data-ttu-id="3df93-137">使用 *互動* 設定來設定其行為。</span><span class="sxs-lookup"><span data-stu-id="3df93-137">configure its behavior using an *interaction configuration*.</span></span> <span data-ttu-id="3df93-138">互動設定會指定支援哪些操作（例如移動流覽）。</span><span class="sxs-lookup"><span data-stu-id="3df93-138">The interaction configuration specifies which manipulations, like panning, are supported.</span></span>

<span data-ttu-id="3df93-139">*移動* 流覽會將內容的位置變更為水準或垂直軸，或同時變更為使用者的移動。</span><span class="sxs-lookup"><span data-stu-id="3df93-139">*Panning* changes the position of the content along either the horizontal or vertical axis or both as a user pans.</span></span> <span data-ttu-id="3df93-140">當您在這兩個軸上設定轉譯時，內容會以任何方向自由地移動。</span><span class="sxs-lookup"><span data-stu-id="3df93-140">When you configure translation on both axes, the content moves freely in any direction.</span></span>

<span data-ttu-id="3df93-141">若要限制內容的動作，請設定 *滑軌*，通常在水準和垂直軸上。</span><span class="sxs-lookup"><span data-stu-id="3df93-141">To constrain the motion of content, configure *rails*, typically on both the horizontal and vertical axis.</span></span> <span data-ttu-id="3df93-142">如果使用者的互動主要沿著單一軸， (下圖中的藍色區域表示) ，則平移會變成 *railed* ，而且內容只會沿著 railed 軸移動。</span><span class="sxs-lookup"><span data-stu-id="3df93-142">If a user’s interaction is primarily along a single axis (represented by the blue regions in the next diagram), the pan becomes *railed* and the content only moves along the railed axis.</span></span> <span data-ttu-id="3df93-143">如果使用者已移動流覽，且目前已 railed 並在內容為慣性時執行第二個平移，則會繼續 railed 新的平移。</span><span class="sxs-lookup"><span data-stu-id="3df93-143">If the user has panned and is currently railed and performs a second pan while the content is in inertia, the new pan continues to be railed.</span></span>

![顯示 railed 移動區中的內容的圖表](images/dm-art-3.png)

<span data-ttu-id="3df93-145">範例：為水準和垂直移動設定的視口。</span><span class="sxs-lookup"><span data-stu-id="3df93-145">Example: A viewport is configured for horizontal and vertical panning.</span></span> <span data-ttu-id="3df93-146">在第一個框架中，連絡人會關閉。</span><span class="sxs-lookup"><span data-stu-id="3df93-146">In the first frame, the contact comes down.</span></span> <span data-ttu-id="3df93-147">在第二個情況下，會起始垂直平移，並將連絡人鎖定至垂直滑軌。</span><span class="sxs-lookup"><span data-stu-id="3df93-147">In the second, a vertical pan is initiated and the contact is locked to the vertical rail.</span></span> <span data-ttu-id="3df93-148">最後，一旦 railed 平移，就只會使用對角平移的垂直元件來移動內容。</span><span class="sxs-lookup"><span data-stu-id="3df93-148">Finally, once the pan is railed, only the vertical component of a diagonal pan is used to move the content.</span></span>

<span data-ttu-id="3df93-149">如果使用者以不在滑軌偵測區域中的方式來回移動 (白色區域) ，則會 *unrailed* 平移，而且內容將會在兩個軸中自由移動。</span><span class="sxs-lookup"><span data-stu-id="3df93-149">If the user pans diagonally in a way that they are not in the rails detection regions (the white regions), the pan is *unrailed* and the content will move freely in both axes.</span></span>

![顯示在 unrailed pan 中移動內容的圖表](images/dm-art-4.png)

<span data-ttu-id="3df93-151">當使用者 pinches 或伸展時，*縮放* 會變更內容的縮放比例。</span><span class="sxs-lookup"><span data-stu-id="3df93-151">*Zooming* changes the scale factor of the content as a user pinches or stretches.</span></span> <span data-ttu-id="3df93-152">將內容縮放 (稱為「縮放中心」的點) 是「連絡人」的中心。</span><span class="sxs-lookup"><span data-stu-id="3df93-152">The point around which the content is scaled (called the zoom center) is at the center of the contacts.</span></span> <span data-ttu-id="3df93-153">如果您已設定水準或垂直對齊，縮放中心會變更以保持對齊。</span><span class="sxs-lookup"><span data-stu-id="3df93-153">If you've set horizontal or vertical alignment, the zoom center changes to preserve alignment.</span></span>

![顯示已指定對齊之內容縮放的圖表](images/dm-art-5.png)

<span data-ttu-id="3df93-155">您可以藉由指定 [解除鎖定中心] 來覆寫此行為，這會設定連絡人中心的縮放中心。</span><span class="sxs-lookup"><span data-stu-id="3df93-155">You can override this behavior by specifying unlock center, which sets the zoom center at the center of the contacts.</span></span>

![顯示縮放中心已解除鎖定之內容縮放的圖表](images/dm-art-6.png)

<span data-ttu-id="3df93-157">*慣性* 是在觸控) 或鍵盤/滑鼠輸入 (（例如，按一下捲軸或按下方向鍵) ）之後，操作的漸進速度（移動和 (縮放）。</span><span class="sxs-lookup"><span data-stu-id="3df93-157">*Inertia* is the gradual deceleration of a manipulation, both panning and zooming, after all contacts have been lifted (in the case of touch) or after keyboard/mouse input (such as clicking a scroll bar, or pressing the arrow keys).</span></span> <span data-ttu-id="3df93-158">當使用者操作內容時，此操作不會在連絡人被提起之後立即停止。</span><span class="sxs-lookup"><span data-stu-id="3df93-158">When a user manipulates the content, the manipulation does not immediately stop after the contact is lifted.</span></span> <span data-ttu-id="3df93-159">相反地，內容會以目前的方向和速度繼續進行，速度會逐漸降低。</span><span class="sxs-lookup"><span data-stu-id="3df93-159">Instead, the content continues in the current direction and velocity, slowing gradually to a stop.</span></span>

## <a name="snap-points-and-boundaries"></a><span data-ttu-id="3df93-160">對齊點和界限</span><span class="sxs-lookup"><span data-stu-id="3df93-160">Snap points and boundaries</span></span>

<span data-ttu-id="3df93-161">當手指在觸控) 或鍵盤/滑鼠動作的結果 (例如方向鍵、page up/down、滑鼠滾輪滾動) 等的情況下，在操作結束之後，就會發生慣性動畫 (。</span><span class="sxs-lookup"><span data-stu-id="3df93-161">An inertia animation takes place after the manipulation ends as result of a finger being lifted off the screen (in the case of touch) or as a result of a keyboard/mouse action (such as arrow keys, page up/down, mouse wheel scrolling, etc).</span></span>

<span data-ttu-id="3df93-162">定義慣性動畫的資訊有兩個部分：</span><span class="sxs-lookup"><span data-stu-id="3df93-162">There are two pieces of information that define the inertia animation:</span></span>

- <span data-ttu-id="3df93-163">動畫的 rest 點–特定轉換元件的最終結束位置。</span><span class="sxs-lookup"><span data-stu-id="3df93-163">The rest point of the animation – the final ending position of the particular transform component.</span></span>
- <span data-ttu-id="3df93-164">動畫持續時間（曲線、速度）–這些是由 rest 點的型別所決定。</span><span class="sxs-lookup"><span data-stu-id="3df93-164">The animation duration, curve, velocity – these are determined by the type of the rest point.</span></span>

<span data-ttu-id="3df93-165">慣性動畫會受到對齊點和界限的影響。</span><span class="sxs-lookup"><span data-stu-id="3df93-165">The inertia animation is affected by snap-points and boundaries.</span></span> <span data-ttu-id="3df93-166">界限會指定內容的最大和最小 rest 點數。</span><span class="sxs-lookup"><span data-stu-id="3df93-166">Boundaries specify the maximum and minimum rest points for content.</span></span> <span data-ttu-id="3df93-167">如果內容在慣性期間到達界限，則會套用界限動畫。</span><span class="sxs-lookup"><span data-stu-id="3df93-167">If content reaches a boundary during inertia, a boundary animation will be applied.</span></span> <span data-ttu-id="3df93-168">在主要內容上定義對齊點，以修改 rest 點並修改慣性動畫曲線本身。</span><span class="sxs-lookup"><span data-stu-id="3df93-168">Snap points are defined on the primary content to modify the rest point and modify the inertia animation curve itself.</span></span>

<span data-ttu-id="3df93-169">當內容的間距較近時，您會使用 [**SetSnapInterval**](/windows/win32/api/DirectManipulation/nf-directmanipulation-idirectmanipulationprimarycontent-setsnapinterval) 定義貼齊點，或在內容的間距間距時使用 [**SetSnapPoints**](/windows/win32/api/DirectManipulation/nf-directmanipulation-idirectmanipulationprimarycontent-setsnappoints) 定義貼齊點。</span><span class="sxs-lookup"><span data-stu-id="3df93-169">You define snap points with [**SetSnapInterval**](/windows/win32/api/DirectManipulation/nf-directmanipulation-idirectmanipulationprimarycontent-setsnapinterval) when the content is regularly spaced or with [**SetSnapPoints**](/windows/win32/api/DirectManipulation/nf-directmanipulation-idirectmanipulationprimarycontent-setsnappoints) when the content is unevenly spaced.</span></span> <span data-ttu-id="3df93-170">以下是貼齊點的範例：</span><span class="sxs-lookup"><span data-stu-id="3df93-170">Here is an example of snap points:</span></span>

![圖表顯示內容中設定的貼齊點會如何影響移動](images/dm-snappoint-states-3.png)

<span data-ttu-id="3df93-172">在此圖中，有一系列的內容具有一系列的子內容區塊–新聞讀取器類型應用程式中的新聞專案，或在格線視圖中的專案。</span><span class="sxs-lookup"><span data-stu-id="3df93-172">In the diagram, there is a piece of content with a series of sub-content blocks – news items in a news-reader type app or items in a Grid View.</span></span> <span data-ttu-id="3df93-173">其目的是在慣性結束之後，將專案的左邊緣貼齊至視口的左邊緣。</span><span class="sxs-lookup"><span data-stu-id="3df93-173">The intent is to snap an item’s left edge onto the viewport’s left edge after inertia has ended.</span></span>

<span data-ttu-id="3df93-174">格線類型有兩個群組：</span><span class="sxs-lookup"><span data-stu-id="3df93-174">There are two groups of snap point types:</span></span>

- <span data-ttu-id="3df93-175">*選擇性與強制性*：選擇性的貼齊點只會在慣性 rest 點接近對齊點時，才會貼上慣性動畫。</span><span class="sxs-lookup"><span data-stu-id="3df93-175">*Optional vs. Mandatory*: An optional snap point snaps the inertia animation only if the inertia rest point is near the snap point.</span></span> <span data-ttu-id="3df93-176">強制的貼齊點一律會將慣性動畫貼齊指定的貼齊點。</span><span class="sxs-lookup"><span data-stu-id="3df93-176">A mandatory snap point always snaps the inertia animation to a specified snap point.</span></span>
- <span data-ttu-id="3df93-177">*單一與多個*：多個貼齊點類型可讓內容移動超過許多貼齊點，然後在靠近其自然 rest 點的貼齊點上移至其他貼齊點。</span><span class="sxs-lookup"><span data-stu-id="3df93-177">*Single vs. Multiple*: A multiple snap point type allows the content to move past many snap points before coming to a rest at a snap point close to its natural rest point.</span></span> <span data-ttu-id="3df93-178">單一的貼齊點類型會選擇下一個最接近的貼齊點，作為慣性動畫的 rest 點。</span><span class="sxs-lookup"><span data-stu-id="3df93-178">A single snap point type chooses the next nearest snap point as the rest point for the inertia animation.</span></span>

<span data-ttu-id="3df93-179">下圖將示範對齊點類型如何修改慣性動畫的其餘位置。</span><span class="sxs-lookup"><span data-stu-id="3df93-179">The next diagram demonstrates how snap point types modify the rest position of the inertia animation.</span></span>

![顯示慣性和貼齊點如何互動的圖表](images/dm-snappoint-states-1.png)

<span data-ttu-id="3df93-181">在此圖中，慣性起點會標示為「開始」，而在沒有貼齊點為 ' End ' 的情況下，則會有自然慣性結束位置。</span><span class="sxs-lookup"><span data-stu-id="3df93-181">In this diagram, the inertia start point is labeled as ‘Start’ and the natural inertia end position in the absence of snap points as ‘End’.</span></span> <span data-ttu-id="3df93-182">垂直線會標示不同的貼齊點。</span><span class="sxs-lookup"><span data-stu-id="3df93-182">The vertical lines mark the various snap points.</span></span> <span data-ttu-id="3df93-183">下表說明每種類型的貼齊點將如何影響動畫的結束位置。</span><span class="sxs-lookup"><span data-stu-id="3df93-183">This table describes how each type of snap point will affect the end position of the animation.</span></span>

| <span data-ttu-id="3df93-184">點類型</span><span class="sxs-lookup"><span data-stu-id="3df93-184">Point type</span></span>         | <span data-ttu-id="3df93-185">Description</span><span class="sxs-lookup"><span data-stu-id="3df93-185">Description</span></span>                                                                                |
|--------------------|--------------------------------------------------------------------------------------------|
| <span data-ttu-id="3df93-186">強制單一</span><span class="sxs-lookup"><span data-stu-id="3df93-186">Mandatory single</span></span>   | <span data-ttu-id="3df93-187">因為貼齊點 P1 是慣性方向的第一個貼齊點，所以已選擇</span><span class="sxs-lookup"><span data-stu-id="3df93-187">Snap point P1 is chosen because it is the first snap point in the direction of inertia</span></span>     |
| <span data-ttu-id="3df93-188">強制多重</span><span class="sxs-lookup"><span data-stu-id="3df93-188">Mandatory multiple</span></span> | <span data-ttu-id="3df93-189">因為貼齊點 P2 最接近慣性方向的結束點，所以已選擇</span><span class="sxs-lookup"><span data-stu-id="3df93-189">Snap point P2 is chosen because it is closest to the end point in the direction of inertia</span></span> |
| <span data-ttu-id="3df93-190">選擇性單一</span><span class="sxs-lookup"><span data-stu-id="3df93-190">Optional single</span></span>    | <span data-ttu-id="3df93-191">因為貼齊點 P1 是慣性期間遇到的第一個貼齊點，所以已選擇</span><span class="sxs-lookup"><span data-stu-id="3df93-191">Snap point P1 is chosen because it is the first snap point encountered during inertia</span></span>      |
| <span data-ttu-id="3df93-192">選用多重</span><span class="sxs-lookup"><span data-stu-id="3df93-192">Optional multiple</span></span>  | <span data-ttu-id="3df93-193">因為貼齊點 P2 接近自然結束點，所以已選擇</span><span class="sxs-lookup"><span data-stu-id="3df93-193">Snap point P2 is chosen because it is near the natural end point</span></span>                           |

## <a name="snap-point-offset-and-rtl-scenarios"></a><span data-ttu-id="3df93-194">貼齊點位移和 RTL 情節</span><span class="sxs-lookup"><span data-stu-id="3df93-194">Snap point offset and RTL scenarios</span></span>

![顯示 rtl 貼齊點使用的圖表](images/dm-snappoint-states-2.png)

<span data-ttu-id="3df93-196">您可以使用 [**SetSnapCoordinate**](/windows/win32/api/DirectManipulation/nf-directmanipulation-idirectmanipulationprimarycontent-setsnapcoordinate) API 來套用貼齊點位移和座標系統，這會使用指定的位移/座標系統來位移所有的貼齊點或貼齊間隔。</span><span class="sxs-lookup"><span data-stu-id="3df93-196">You apply the snap point offset and coordinate system using the [**SetSnapCoordinate**](/windows/win32/api/DirectManipulation/nf-directmanipulation-idirectmanipulationprimarycontent-setsnapcoordinate) API – which offsets all the snap points or snap-intervals using the specified offset/coordinate system.</span></span>

<span data-ttu-id="3df93-197">座標系統在 RTL 情節中非常有用，您想要從內容的左邊緣描述反向方向的貼齊點。</span><span class="sxs-lookup"><span data-stu-id="3df93-197">The coordinate system is very useful in RTL scenarios, where you want to describe snap points from the left-edge of the content in the reverse direction.</span></span> <span data-ttu-id="3df93-198">在上圖中， [**SetSnapCoordinate**](/windows/win32/api/DirectManipulation/nf-directmanipulation-idirectmanipulationprimarycontent-setsnapcoordinate) 是與 **DIRECTMANIPULATION \_ 運動 \_ TRANSLATEX** 和 **DIRECTMANIPULATION \_ 座標 \_ 鏡像** 旗標搭配使用，此旗標會自動從內容的左邊位移貼齊點，並以由右至左的順序提供： S1 位於0px，S2 是在 50px (等) 。</span><span class="sxs-lookup"><span data-stu-id="3df93-198">In the previous diagram, [**SetSnapCoordinate**](/windows/win32/api/DirectManipulation/nf-directmanipulation-idirectmanipulationprimarycontent-setsnapcoordinate) is used with the **DIRECTMANIPULATION\_MOTION\_TRANSLATEX** and **DIRECTMANIPULATION\_COORDINATE\_MIRRORED** flag, which automatically offsets the snap points from the left-edge of the content and supplies them in right-to-left order: S1 is at 0px, S2 is at 50px (and so on).</span></span> <span data-ttu-id="3df93-199">任何使用 **SetSnapCoordinate** 設定的位移都會自動從內容的左邊緣位移，包括正確的縮放因數。</span><span class="sxs-lookup"><span data-stu-id="3df93-199">Any offset set using **SetSnapCoordinate** will further offset from this left-edge of the content automatically, including the correct scale-factor.</span></span>

<span data-ttu-id="3df93-200">您幾乎一律會使用 [**SetSnapCoordinate**](/windows/win32/api/DirectManipulation/nf-directmanipulation-idirectmanipulationprimarycontent-setsnapcoordinate) 搭配 *原始* 參數設定，以避免設定內容區域以外的貼齊點。</span><span class="sxs-lookup"><span data-stu-id="3df93-200">You will almost always use [**SetSnapCoordinate**](/windows/win32/api/DirectManipulation/nf-directmanipulation-idirectmanipulationprimarycontent-setsnapcoordinate) with the *origin* parameter set to avoid setting snap points outside of the content area.</span></span>

<span data-ttu-id="3df93-201">例如，如果200x200 的視口和內容是1000x200 的，且介面是 RTL，則在第一次顯示區時，此介面的左邊緣會是 x = 800。</span><span class="sxs-lookup"><span data-stu-id="3df93-201">For example, if the viewport is 200x200 and the content is 1000x200, and the interface is RTL, the viewport will have it's left edge at x=800 when the viewport is first presented.</span></span> <span data-ttu-id="3df93-202">使用呼叫 [**SetSnapCoordinate**](/windows/win32/api/DirectManipulation/nf-directmanipulation-idirectmanipulationprimarycontent-setsnapcoordinate) ， `SetSnapCoordinate(DIRECTMANIPULATION_MOTION_TRANSLATEX, DIRECTMANIPULATION_COORDINATE_MIRRORED, 1000.0)` 以指定從內容的右邊緣開始，從右至左的順序計算對齊點。</span><span class="sxs-lookup"><span data-stu-id="3df93-202">Call [**SetSnapCoordinate**](/windows/win32/api/DirectManipulation/nf-directmanipulation-idirectmanipulationprimarycontent-setsnapcoordinate) with `SetSnapCoordinate(DIRECTMANIPULATION_MOTION_TRANSLATEX, DIRECTMANIPULATION_COORDINATE_MIRRORED, 1000.0)` to specify that the snap points should be calculated from right to left order starting from the RIGHT edge of the content.</span></span>

## <a name="behaviors"></a><span data-ttu-id="3df93-203">行為</span><span class="sxs-lookup"><span data-stu-id="3df93-203">Behaviors</span></span>

<span data-ttu-id="3df93-204">*行為* 是一個物件，可以附加至一個物件區，以修改 [直接操作](direct-manipulation-portal.md)如何處理其主要或次要內容的輸出轉換。</span><span class="sxs-lookup"><span data-stu-id="3df93-204">A *behavior* is an object that can be attached to a viewport in order to modify how [Direct Manipulation](direct-manipulation-portal.md) handles the output transform of a viewport's primary or secondary content.</span></span> <span data-ttu-id="3df93-205">行為物件可能會影響操作的一或多個層面，例如輸入的處理方式或套用慣性動畫的方式。</span><span class="sxs-lookup"><span data-stu-id="3df93-205">A behavior object may affect one or more aspects of a manipulation, such as how input is processed or how the inertia animation is applied.</span></span> <span data-ttu-id="3df93-206">例如，autoscroll 行為會藉由在主要內容的一端執行滾動動畫來影響慣性動畫。</span><span class="sxs-lookup"><span data-stu-id="3df93-206">For example, an autoscroll behavior affects the inertia animation by performing a scrolling animation toward one end of the primary content.</span></span> <span data-ttu-id="3df93-207">跨幻燈片設定行為會影響直接操作輸入處理，以偵測何時執行跨幻燈片動作。</span><span class="sxs-lookup"><span data-stu-id="3df93-207">A cross-slide configuration behavior affects Direct Manipulation input processing which detects when a cross-slide action is being performed.</span></span>

<span data-ttu-id="3df93-208">藉由呼叫 [**CreateBehavior**](/windows/win32/api/DirectManipulation/nf-directmanipulation-idirectmanipulationmanager2-createbehavior)來建立行為物件，並將其加入至物件區，然後以非同步方式設定其行為。</span><span class="sxs-lookup"><span data-stu-id="3df93-208">A behavior object is created by calling [**CreateBehavior**](/windows/win32/api/DirectManipulation/nf-directmanipulation-idirectmanipulationmanager2-createbehavior), added to a viewport and then its behavior is configured asynchronously.</span></span> <span data-ttu-id="3df93-209">從區中移除行為會移除其效果。</span><span class="sxs-lookup"><span data-stu-id="3df93-209">Removing the behavior from the viewport removes its effects.</span></span>

## <a name="coordinate-system"></a><span data-ttu-id="3df93-210">座標系統</span><span class="sxs-lookup"><span data-stu-id="3df93-210">Coordinate system</span></span>

<span data-ttu-id="3df93-211">[直接操作](direct-manipulation-portal.md)採用三種主要座標系統：</span><span class="sxs-lookup"><span data-stu-id="3df93-211">There are three main coordinate systems employed by [Direct Manipulation](direct-manipulation-portal.md):</span></span>

- <span data-ttu-id="3df93-212">用戶端座標系統-描述用戶端視窗的矩形。</span><span class="sxs-lookup"><span data-stu-id="3df93-212">Client coordinate system - describes the rectangle of the client window.</span></span> <span data-ttu-id="3df93-213">單位是以圖元為單位。</span><span class="sxs-lookup"><span data-stu-id="3df93-213">Units are in pixels.</span></span>
- <span data-ttu-id="3df93-214">區座標系統-描述用戶端中可以處理輸入之區域的矩形。</span><span class="sxs-lookup"><span data-stu-id="3df93-214">Viewport coordinate system - describes the rectangle of a region within the client that can process input.</span></span> <span data-ttu-id="3df93-215">單位是使用 [**SetViewportRect**](/windows/win32/api/DirectManipulation/nf-directmanipulation-idirectmanipulationviewport-setviewportrect)) 的應用程式定義 (。</span><span class="sxs-lookup"><span data-stu-id="3df93-215">Units are application-defined (using [**SetViewportRect**](/windows/win32/api/DirectManipulation/nf-directmanipulation-idirectmanipulationviewport-setviewportrect)).</span></span>
- <span data-ttu-id="3df93-216">內容座標系統-描述主要內容的矩形或大小。</span><span class="sxs-lookup"><span data-stu-id="3df93-216">Content coordinate system - describes the rectangle or size of primary content.</span></span> <span data-ttu-id="3df93-217">單位是使用 [**SetContentRect**](/windows/win32/api/DirectManipulation/nf-directmanipulation-idirectmanipulationcontent-setcontentrect)) 的應用程式定義 (。</span><span class="sxs-lookup"><span data-stu-id="3df93-217">Units are application-defined (using [**SetContentRect**](/windows/win32/api/DirectManipulation/nf-directmanipulation-idirectmanipulationcontent-setcontentrect)).</span></span>

<span data-ttu-id="3df93-218">對於這三個系統而言，座標是相對於其各自的左上原點所定義，而且正向右和向下遞增。</span><span class="sxs-lookup"><span data-stu-id="3df93-218">For all three systems, coordinates are defined relative to their respective top-left origin, and are positive increasing to the right and down.</span></span> <span data-ttu-id="3df93-219">下圖說明這些座標系統。</span><span class="sxs-lookup"><span data-stu-id="3df93-219">These coordinate systems are illustrated in the next diagram.</span></span> <span data-ttu-id="3df93-220">只有在 [區域] 矩形內的內容區段可以由終端使用者看見或操作。</span><span class="sxs-lookup"><span data-stu-id="3df93-220">Only the section of the content within the viewport rectangle can be seen or manipulated by the end-user.</span></span>

![顯示內容、用戶端和視口如何協調互動的圖表](images/dm-art-7.png)

## <a name="transforms"></a><span data-ttu-id="3df93-222">轉換</span><span class="sxs-lookup"><span data-stu-id="3df93-222">Transforms</span></span>

<span data-ttu-id="3df93-223">[直接操作](direct-manipulation-portal.md) 會維護數個會對整體顯示輸出造成影響的不同轉換。</span><span class="sxs-lookup"><span data-stu-id="3df93-223">[Direct Manipulation](direct-manipulation-portal.md) maintains several different transforms that contribute to the overall displayed output.</span></span>

- <span data-ttu-id="3df93-224">*內容轉換* –以操作或慣性為基礎的 [直接操作](direct-manipulation-portal.md) 所計算的初始轉換。</span><span class="sxs-lookup"><span data-stu-id="3df93-224">*Content transform* – the initial transform computed by [Direct Manipulation](direct-manipulation-portal.md) based on a manipulation or inertia.</span></span> <span data-ttu-id="3df93-225">它會捕捉貼齊點、railing、預設 overpan (操作) 、預設 overbounce (慣性) 和 ZoomToRect 動畫的效果。</span><span class="sxs-lookup"><span data-stu-id="3df93-225">It captures the effects of snap points, railing, default overpan (manipulation), default overbounce (inertia), and ZoomToRect animations.</span></span>
- <span data-ttu-id="3df93-226">*輸出轉換* -最後的視覺效果或輸出轉換。</span><span class="sxs-lookup"><span data-stu-id="3df93-226">*Output transform* - the final visual or output transform.</span></span> <span data-ttu-id="3df93-227">它是內容和同步轉換的組合。</span><span class="sxs-lookup"><span data-stu-id="3df93-227">It is the combination of both the content as well as the sync transforms.</span></span>
- <span data-ttu-id="3df93-228">*同步轉換* –在您呼叫 [**SyncContentTransform**](/windows/win32/api/DirectManipulation/nf-directmanipulation-idirectmanipulationcontent-synccontenttransform)時計算。</span><span class="sxs-lookup"><span data-stu-id="3df93-228">*Sync transform* – computed when you call [**SyncContentTransform**](/windows/win32/api/DirectManipulation/nf-directmanipulation-idirectmanipulationcontent-synccontenttransform).</span></span> <span data-ttu-id="3df93-229">它可協助 [直接操作](direct-manipulation-portal.md) 套用應用程式所提供的新內容轉換，同時也能維護現有的輸出轉換。</span><span class="sxs-lookup"><span data-stu-id="3df93-229">It helps [Direct Manipulation](direct-manipulation-portal.md) apply a new content transform supplied by the application while also maintaining the existing output transform.</span></span>
- <span data-ttu-id="3df93-230">*顯示轉換* –應用程式在後置處理過程中套用。</span><span class="sxs-lookup"><span data-stu-id="3df93-230">*Display transform* – applied by the application as part of post-processing.</span></span> <span data-ttu-id="3df93-231">如需詳細資訊，請參閱 [**SyncDisplayTransform**](/windows/win32/api/DirectManipulation/nf-directmanipulation-idirectmanipulationviewport-syncdisplaytransform) 。</span><span class="sxs-lookup"><span data-stu-id="3df93-231">See [**SyncDisplayTransform**](/windows/win32/api/DirectManipulation/nf-directmanipulation-idirectmanipulationviewport-syncdisplaytransform) for more details.</span></span>

<span data-ttu-id="3df93-232">因為輸出轉換的目的是要在螢幕上以視覺化方式呈現介面，所以 [直接操作](direct-manipulation-portal.md) 會在輸出轉換元件上執行必要的舍入，讓文字和其他內容一律在整數圖元界限轉譯/合成。</span><span class="sxs-lookup"><span data-stu-id="3df93-232">Because the output transform is intended to offset a surface visually on the screen, [Direct Manipulation](direct-manipulation-portal.md) performs the necessary rounding on the output transform components so that text and other content are always rendered/composited at an integral pixel boundary.</span></span> <span data-ttu-id="3df93-233">舍入機制取決於多個因素，包括動作速度以及遠端桌面是否存在。</span><span class="sxs-lookup"><span data-stu-id="3df93-233">The rounding mechanism depends upon multiple factors, including the velocity of the motion and the presence of Remote Desktop.</span></span> <span data-ttu-id="3df93-234">次要內容的舍入機制符合主要內容，同時考慮兩者之間的動作差異。</span><span class="sxs-lookup"><span data-stu-id="3df93-234">The rounding mechanism for secondary content matches that of the primary content, while taking into account the difference in the motion between the two.</span></span> <span data-ttu-id="3df93-235">[**GetOutputTransform**](/windows/win32/api/DirectManipulation/nf-directmanipulation-idirectmanipulationcontent-getoutputtransform)的用戶端不應該相依于輸出轉換的確切舍入機制，因為有各種因素會影響它。</span><span class="sxs-lookup"><span data-stu-id="3df93-235">Clients of [**GetOutputTransform**](/windows/win32/api/DirectManipulation/nf-directmanipulation-idirectmanipulationcontent-getoutputtransform) should not depend on the exact rounding mechanism of the output transform, as various factors affect it.</span></span>

> [!Note]
>
> <span data-ttu-id="3df93-236">這表示內容轉換的元件可能不是整數，而且可能包含子圖元位移。</span><span class="sxs-lookup"><span data-stu-id="3df93-236">This means that the components of a content transform may not be integral and may contain sub-pixel offsets.</span></span> <span data-ttu-id="3df93-237">建議您使用 [直接操作](direct-manipulation-portal.md) 的用戶端，以在使用手動更新模式時，使用 [**GetOutputTransform**](/windows/win32/api/DirectManipulation/nf-directmanipulation-idirectmanipulationcontent-getoutputtransform) 來計算要套用至內容的正確視覺效果轉換。</span><span class="sxs-lookup"><span data-stu-id="3df93-237">Clients using [Direct Manipulation](direct-manipulation-portal.md) are encouraged to use the [**GetOutputTransform**](/windows/win32/api/DirectManipulation/nf-directmanipulation-idirectmanipulationcontent-getoutputtransform) to compute the correct visual transform to apply on the content when using manual update mode.</span></span> <span data-ttu-id="3df93-238">使用內建的組合器來使用自動更新模式時，直接操作會自動代表用戶端套用此轉換。</span><span class="sxs-lookup"><span data-stu-id="3df93-238">When using automatic update mode using the built in compositor, Direct Manipulation automatically applies this transform on the client’s behalf.</span></span> <span data-ttu-id="3df93-239">這項轉換是由直接操作所產生，以確保在撰寫視覺效果輸出時能以視覺化的方式呈現結果。</span><span class="sxs-lookup"><span data-stu-id="3df93-239">This transform is generated by Direct Manipulation to ensure visually pleasing results when composing the visual output.</span></span>

## <a name="viewport-state"></a><span data-ttu-id="3df93-240">視窗區狀態</span><span class="sxs-lookup"><span data-stu-id="3df93-240">Viewport state</span></span>

<span data-ttu-id="3df93-241">處理輸入時，此區會管理互動狀態以及輸入對應至輸出轉換。</span><span class="sxs-lookup"><span data-stu-id="3df93-241">As input is processed the viewport manages the interaction state and mapping of input to output transforms.</span></span> <span data-ttu-id="3df93-242">藉由呼叫 [**GetStatus**](/windows/win32/api/DirectManipulation/nf-directmanipulation-idirectmanipulationviewport-getstatus)來檢查視口的互動狀態。</span><span class="sxs-lookup"><span data-stu-id="3df93-242">Check the interaction state of the viewport by calling [**GetStatus**](/windows/win32/api/DirectManipulation/nf-directmanipulation-idirectmanipulationviewport-getstatus).</span></span>

![顯示 directmanipulation 互動狀態的圖表](images/dm-states-diagram.png)

- <span data-ttu-id="3df93-244">建築物-正在建立此區，而且還無法處理輸入。</span><span class="sxs-lookup"><span data-stu-id="3df93-244">Building – the viewport is being created and is not yet able to process input.</span></span> <span data-ttu-id="3df93-245">為了處理輸入，請呼叫 [**IDirectManipulationViewport：： Enable**](/windows/win32/api/DirectManipulation/nf-directmanipulation-idirectmanipulationviewport-enable)。</span><span class="sxs-lookup"><span data-stu-id="3df93-245">In order to process input, call [**IDirectManipulationViewport::Enable**](/windows/win32/api/DirectManipulation/nf-directmanipulation-idirectmanipulationviewport-enable).</span></span> <span data-ttu-id="3df93-246">如果未呼叫 **Enable** ，則此區會進入停用狀態。</span><span class="sxs-lookup"><span data-stu-id="3df93-246">If **Enable** is not called, the viewport goes to the Disabled state.</span></span>

    > [!Note]  
    > <span data-ttu-id="3df93-247">這是互動的初始狀態。</span><span class="sxs-lookup"><span data-stu-id="3df93-247">This is the initial state of the interaction.</span></span>

- <span data-ttu-id="3df93-248">已啟用-此區已準備好處理輸入。</span><span class="sxs-lookup"><span data-stu-id="3df93-248">Enabled – the viewport is ready to process input.</span></span> <span data-ttu-id="3df93-249">當連絡人關機時 (會呼叫 [**SetContact**](/windows/win32/api/DirectManipulation/nf-directmanipulation-idirectmanipulationviewport-setcontact)) 並偵測到操作，然後將此視口轉換成正在執行。</span><span class="sxs-lookup"><span data-stu-id="3df93-249">When a contact comes down ([**SetContact**](/windows/win32/api/DirectManipulation/nf-directmanipulation-idirectmanipulationviewport-setcontact) is called) and a manipulation is detected, the viewport transitions to Running.</span></span>

- <span data-ttu-id="3df93-250">正在執行-此區目前正在處理輸入和更新內容。</span><span class="sxs-lookup"><span data-stu-id="3df93-250">Running – the viewport is currently processing input and updating content.</span></span> <span data-ttu-id="3df93-251">當連絡人被提起時，如果已設定，則會轉換成慣性。</span><span class="sxs-lookup"><span data-stu-id="3df93-251">When the contact is lifted, the viewport transitions to Inertia, if configured.</span></span>

- <span data-ttu-id="3df93-252">慣性–內容正在慣性動畫中移動。</span><span class="sxs-lookup"><span data-stu-id="3df93-252">Inertia – the content is moving in an inertia animation.</span></span> <span data-ttu-id="3df93-253">一旦慣性完成，區將會轉換為就緒。</span><span class="sxs-lookup"><span data-stu-id="3df93-253">Once inertia is complete, the viewport will transition to Ready.</span></span> <span data-ttu-id="3df93-254">如果已在功能區上設定自動停用，它會從慣性轉換為就緒，然後再轉換為停用。</span><span class="sxs-lookup"><span data-stu-id="3df93-254">If auto-disable has been set on the viewport, it will transition from Inertia to Ready, and then to Disabled.</span></span>

- <span data-ttu-id="3df93-255">就緒–此區已準備好處理輸入。</span><span class="sxs-lookup"><span data-stu-id="3df93-255">Ready – the viewport is ready to process input.</span></span> <span data-ttu-id="3df93-256">當連絡人關機時 (會呼叫 [**SetContact**](/windows/win32/api/DirectManipulation/nf-directmanipulation-idirectmanipulationviewport-setcontact)) 並偵測到操作，然後將此視口轉換成正在執行。</span><span class="sxs-lookup"><span data-stu-id="3df93-256">When a contact comes down ([**SetContact**](/windows/win32/api/DirectManipulation/nf-directmanipulation-idirectmanipulationviewport-setcontact) is called) and a manipulation is detected, the viewport transitions to Running.</span></span>

- <span data-ttu-id="3df93-257">已暫止–當此區的輸入已升級為 [**SetContact**](/windows/win32/api/DirectManipulation/nf-directmanipulation-idirectmanipulationviewport-setcontact) 鏈中的父系時，可能會暫停。</span><span class="sxs-lookup"><span data-stu-id="3df93-257">Suspended – the viewport may become Suspended when its input has been promoted to a parent in the [**SetContact**](/windows/win32/api/DirectManipulation/nf-directmanipulation-idirectmanipulationviewport-setcontact) chain.</span></span> <span data-ttu-id="3df93-258">這會在多個資料區中更詳細地討論 [：點擊測試和視口](directmanipulation-multiple-vieports.md)階層。</span><span class="sxs-lookup"><span data-stu-id="3df93-258">This is discussed in greater detail in [Multiple viewports: hit testing and viewport hierarchy](directmanipulation-multiple-vieports.md).</span></span>

- <span data-ttu-id="3df93-259">停用-此區將不會處理輸入或進行回呼。</span><span class="sxs-lookup"><span data-stu-id="3df93-259">Disabled – the viewport will not process input or make callbacks.</span></span> <span data-ttu-id="3df93-260">您可以藉由呼叫 [**IDirectManipulationViewport：:D isable**](/windows/win32/api/DirectManipulation/nf-directmanipulation-idirectmanipulationviewport-disable)，從各種狀態中停用視口。</span><span class="sxs-lookup"><span data-stu-id="3df93-260">A viewport may be disabled from various states by calling [**IDirectManipulationViewport::Disable**](/windows/win32/api/DirectManipulation/nf-directmanipulation-idirectmanipulationviewport-disable).</span></span> <span data-ttu-id="3df93-261">如果已在功能區上設定自動停用，則在處理操作之後，它會自動轉換為停用。</span><span class="sxs-lookup"><span data-stu-id="3df93-261">If auto-disable has been set on the viewport, it will transition automatically to Disabled after a manipulation is processed.</span></span> <span data-ttu-id="3df93-262">若要重新啟用已停用的區式，請呼叫 [**IDirectManipulationViewport：： enable**](/windows/win32/api/DirectManipulation/nf-directmanipulation-idirectmanipulationviewport-enable)。</span><span class="sxs-lookup"><span data-stu-id="3df93-262">To re-enable a disabled viewport, call [**IDirectManipulationViewport::Enable**](/windows/win32/api/DirectManipulation/nf-directmanipulation-idirectmanipulationviewport-enable).</span></span>

## <a name="related-topics"></a><span data-ttu-id="3df93-263">相關主題</span><span class="sxs-lookup"><span data-stu-id="3df93-263">Related topics</span></span>

<span data-ttu-id="3df93-264">[多個視窗區：點擊測試和視口](directmanipulation-multiple-vieports.md)階層、 [**ActivateConfiguration**](/windows/win32/api/DirectManipulation/nf-directmanipulation-idirectmanipulationviewport-activateconfiguration)、 [**GetOutputTransform**](/windows/win32/api/DirectManipulation/nf-directmanipulation-idirectmanipulationcontent-getoutputtransform)、 [**SyncDisplayTransform**](/windows/win32/api/DirectManipulation/nf-directmanipulation-idirectmanipulationviewport-syncdisplaytransform)</span><span class="sxs-lookup"><span data-stu-id="3df93-264">[Multiple viewports: hit testing and viewport hierarchy](directmanipulation-multiple-vieports.md), [**ActivateConfiguration**](/windows/win32/api/DirectManipulation/nf-directmanipulation-idirectmanipulationviewport-activateconfiguration), [**GetOutputTransform**](/windows/win32/api/DirectManipulation/nf-directmanipulation-idirectmanipulationcontent-getoutputtransform), [**SyncDisplayTransform**](/windows/win32/api/DirectManipulation/nf-directmanipulation-idirectmanipulationviewport-syncdisplaytransform)</span></span>
