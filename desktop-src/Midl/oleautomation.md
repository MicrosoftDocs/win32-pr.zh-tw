---
title: oleautomation 屬性
description: MIDL oleautomation 屬性和自動化的相容性。
ms.assetid: 4a1c9a02-d637-4595-87b3-5fe903149357
keywords:
- oleautomation 屬性 MIDL
topic_type:
- apiref
api_name:
- oleautomation
api_type:
- NA
ms.topic: reference
ms.date: 05/31/2018
ms.openlocfilehash: b827aba4cb0871f7130e658299c6d8836557a156
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/19/2020
ms.locfileid: "104023457"
---
# <a name="oleautomation-attribute"></a><span data-ttu-id="ab818-104">oleautomation 屬性</span><span class="sxs-lookup"><span data-stu-id="ab818-104">oleautomation attribute</span></span>

<span data-ttu-id="ab818-105">**Oleautomation** 屬性指出介面與 Automation 相容。</span><span class="sxs-lookup"><span data-stu-id="ab818-105">The **oleautomation** attribute indicates that an interface is compatible with Automation.</span></span>

``` syntax
[ 
    oleautomation, 
    uuid(string-uuid)
    [ , interface-attribute-list] 
] 
interface interface-name : base-interface
{
    ...
}
```

## <a name="parameters"></a><span data-ttu-id="ab818-106">參數</span><span class="sxs-lookup"><span data-stu-id="ab818-106">Parameters</span></span>

<dl> <dt>

<span data-ttu-id="ab818-107">*字串-uuid*</span><span class="sxs-lookup"><span data-stu-id="ab818-107">*string-uuid*</span></span> 
</dt> <dd>

<span data-ttu-id="ab818-108">指定 Uuidgen.exe 公用程式所產生的 UUID 字串。</span><span class="sxs-lookup"><span data-stu-id="ab818-108">Specifies a UUID string generated by the Uuidgen utility.</span></span>

</dd> <dt>

<span data-ttu-id="ab818-109">*介面屬性清單*</span><span class="sxs-lookup"><span data-stu-id="ab818-109">*interface-attribute-list*</span></span> 
</dt> <dd>

<span data-ttu-id="ab818-110">指定適用于整個介面的其他屬性。</span><span class="sxs-lookup"><span data-stu-id="ab818-110">Specifies other attributes that apply to the interface as a whole.</span></span>

</dd> <dt>

<span data-ttu-id="ab818-111">*介面-名稱*</span><span class="sxs-lookup"><span data-stu-id="ab818-111">*interface-name*</span></span> 
</dt> <dd>

<span data-ttu-id="ab818-112">指定介面的名稱。</span><span class="sxs-lookup"><span data-stu-id="ab818-112">Specifies the name of the interface.</span></span>

</dd> <dt>

<span data-ttu-id="ab818-113">*基底介面*</span><span class="sxs-lookup"><span data-stu-id="ab818-113">*base-interface*</span></span> 
</dt> <dd>

<span data-ttu-id="ab818-114">指定此衍生介面繼承成員函式、狀態碼和介面屬性之自動化介面的名稱。</span><span class="sxs-lookup"><span data-stu-id="ab818-114">Specifies the name of an Automation interface from which this derived interface inherits member functions, status codes, and interface attributes.</span></span> <span data-ttu-id="ab818-115">所有自動化介面都是衍生自 [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown) 或 [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch)。</span><span class="sxs-lookup"><span data-stu-id="ab818-115">All Automation interfaces are derived from [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown) or [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch).</span></span>

</dd> </dl>

## <a name="remarks"></a><span data-ttu-id="ab818-116">備註</span><span class="sxs-lookup"><span data-stu-id="ab818-116">Remarks</span></span>

<span data-ttu-id="ab818-117">針對 **\[ oleautomation \]** 介面的成員指定的參數和傳回型別必須是自動化相容的，如下表所示。</span><span class="sxs-lookup"><span data-stu-id="ab818-117">The parameters and return types specified for the members of an **\[oleautomation\]** interface must be Automation-compatible, as listed in the following table.</span></span>



| <span data-ttu-id="ab818-118">類型</span><span class="sxs-lookup"><span data-stu-id="ab818-118">Type</span></span>                                            | <span data-ttu-id="ab818-119">Description</span><span class="sxs-lookup"><span data-stu-id="ab818-119">Description</span></span>                                                                                                                                                                                                   |
|-------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="ab818-120">**boolean**</span><span class="sxs-lookup"><span data-stu-id="ab818-120">**boolean**</span></span>                                     | <span data-ttu-id="ab818-121">可以具有值 VARIANT \_ TRUE 或 VARIANT FALSE 的資料項目 \_ 。</span><span class="sxs-lookup"><span data-stu-id="ab818-121">Data item that can have the value VARIANT\_TRUE or VARIANT\_FALSE.</span></span> <span data-ttu-id="ab818-122">大小對應于 VARIANT \_ BOOL。</span><span class="sxs-lookup"><span data-stu-id="ab818-122">The size corresponds to VARIANT\_BOOL.</span></span>                                                                                                     |
| <span data-ttu-id="ab818-123">**unsigned char**</span><span class="sxs-lookup"><span data-stu-id="ab818-123">**unsigned char**</span></span>                               | <span data-ttu-id="ab818-124">8位不帶正負號的資料項目。</span><span class="sxs-lookup"><span data-stu-id="ab818-124">8-bit unsigned data item.</span></span>                                                                                                                                                                                     |
| <span data-ttu-id="ab818-125">**double**</span><span class="sxs-lookup"><span data-stu-id="ab818-125">**double**</span></span>                                      | <span data-ttu-id="ab818-126">64位 IEEE 浮點數。</span><span class="sxs-lookup"><span data-stu-id="ab818-126">64-bit IEEE floating-point number.</span></span>                                                                                                                                                                            |
| <span data-ttu-id="ab818-127">**float**</span><span class="sxs-lookup"><span data-stu-id="ab818-127">**float**</span></span>                                       | <span data-ttu-id="ab818-128">32位 IEEE 浮點數。</span><span class="sxs-lookup"><span data-stu-id="ab818-128">32-bit IEEE floating-point number.</span></span>                                                                                                                                                                            |
| <span data-ttu-id="ab818-129">**int**</span><span class="sxs-lookup"><span data-stu-id="ab818-129">**int**</span></span>                                         | <span data-ttu-id="ab818-130">帶正負號的整數，其大小與系統相依。</span><span class="sxs-lookup"><span data-stu-id="ab818-130">Signed integer, whose size is system dependent.</span></span> <span data-ttu-id="ab818-131">在32位平臺上，MIDL 會將 [**int**](int.md) 視為32位帶正負號的整數。</span><span class="sxs-lookup"><span data-stu-id="ab818-131">On 32-bit platforms, MIDL treats [**int**](int.md) as a 32-bit signed integer.</span></span>                                                                               |
| <span data-ttu-id="ab818-132">**long**</span><span class="sxs-lookup"><span data-stu-id="ab818-132">**long**</span></span>                                        | <span data-ttu-id="ab818-133">32 位元帶正負號的整數。</span><span class="sxs-lookup"><span data-stu-id="ab818-133">32-bit signed integer.</span></span>                                                                                                                                                                                        |
| <span data-ttu-id="ab818-134">**short**</span><span class="sxs-lookup"><span data-stu-id="ab818-134">**short**</span></span>                                       | <span data-ttu-id="ab818-135">16位帶正負號的整數。</span><span class="sxs-lookup"><span data-stu-id="ab818-135">16-bit signed integer.</span></span>                                                                                                                                                                                        |
| <span data-ttu-id="ab818-136">**BSTR**</span><span class="sxs-lookup"><span data-stu-id="ab818-136">**BSTR**</span></span>                                        | <span data-ttu-id="ab818-137">長度前置字串，如 Automation 主題 [BSTR](/previous-versions/windows/desktop/automat/bstr)中所述。</span><span class="sxs-lookup"><span data-stu-id="ab818-137">Length-prefixed string, as described in the Automation topic [BSTR](/previous-versions/windows/desktop/automat/bstr).</span></span>                                                                                                    |
| <span data-ttu-id="ab818-138">**CURRENCY**</span><span class="sxs-lookup"><span data-stu-id="ab818-138">**CURRENCY**</span></span>                                    | <span data-ttu-id="ab818-139">8個位元組的固定浮點數。</span><span class="sxs-lookup"><span data-stu-id="ab818-139">8-byte, fixed floating-point number.</span></span>                                                                                                                                                                          |
| <span data-ttu-id="ab818-140">**DATE**</span><span class="sxs-lookup"><span data-stu-id="ab818-140">**DATE**</span></span>                                        | <span data-ttu-id="ab818-141">64位、浮點數自1899年12月30日起算的小數。</span><span class="sxs-lookup"><span data-stu-id="ab818-141">64-bit, floating point fractional number of days since December 30, 1899.</span></span>                                                                                                                                     |
| <span data-ttu-id="ab818-142">**SCODE**</span><span class="sxs-lookup"><span data-stu-id="ab818-142">**SCODE**</span></span>                                       | <span data-ttu-id="ab818-143">適用于16位系統–對應至 VT 錯誤的內建錯誤類型 \_ 。</span><span class="sxs-lookup"><span data-stu-id="ab818-143">For 16-bit systems–built-in error type that corresponds to VT\_ERROR.</span></span>                                                                                                                                         |
| <span data-ttu-id="ab818-144">**Typedef 列舉** *Myenum*</span><span class="sxs-lookup"><span data-stu-id="ab818-144">**Typedef enum** Â *myenum*</span></span>                      | <span data-ttu-id="ab818-145">帶正負號的整數，其大小與系統相依。</span><span class="sxs-lookup"><span data-stu-id="ab818-145">Signed integer, whose size is system dependent.</span></span>                                                                                                                                                               |
| <span data-ttu-id="ab818-146">**介面 IDispatch \***</span><span class="sxs-lookup"><span data-stu-id="ab818-146">**Interface IDispatch \***</span></span>                      | <span data-ttu-id="ab818-147">[**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch)介面 (VT \_ 分派) 的指標。</span><span class="sxs-lookup"><span data-stu-id="ab818-147">Pointer to the [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) interface (VT\_DISPATCH).</span></span>                                                                                                                |
| <span data-ttu-id="ab818-148">**介面 IUnknown \***</span><span class="sxs-lookup"><span data-stu-id="ab818-148">**Interface IUnknown \***</span></span>                       | <span data-ttu-id="ab818-149">不是衍生自 [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) (VT 未知) 的介面指標 \_ 。</span><span class="sxs-lookup"><span data-stu-id="ab818-149">Pointer to an interface that does not derive from [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) (VT\_UNKNOWN).</span></span> <span data-ttu-id="ab818-150"> (任何 OLE 介面都可由其 [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown) 介面表示。 ) </span><span class="sxs-lookup"><span data-stu-id="ab818-150">(Any OLE interface can be represented by its [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown) interface.)</span></span> |
| <span data-ttu-id="ab818-151">分配 **介面** *Typename \** （& a）</span><span class="sxs-lookup"><span data-stu-id="ab818-151">**dispinterface** Â *Typename \**</span></span>                | <span data-ttu-id="ab818-152">衍生自 [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) (VT 分派) 的介面指標 \_ 。</span><span class="sxs-lookup"><span data-stu-id="ab818-152">Pointer to an interface derived from [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) (VT\_DISPATCH).</span></span>                                                                                                    |
| <span data-ttu-id="ab818-153">**Coclass** *Typename \** （& a）</span><span class="sxs-lookup"><span data-stu-id="ab818-153">**Coclass** Â *Typename \**</span></span>                      | <span data-ttu-id="ab818-154">Coclass 名稱 (VT \_ 未知) 的指標。</span><span class="sxs-lookup"><span data-stu-id="ab818-154">Pointer to a coclass name (VT\_UNKNOWN).</span></span>                                                                                                                                                                      |
| <span data-ttu-id="ab818-155">**\[ oleautomation \] 介面**-  *Typename \**</span><span class="sxs-lookup"><span data-stu-id="ab818-155">**\[oleautomation\] interface** Â  *Typename \**</span></span> | <span data-ttu-id="ab818-156">衍生自 [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown)之介面的指標。</span><span class="sxs-lookup"><span data-stu-id="ab818-156">Pointer to an interface that derives from [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown).</span></span>                                                                                                                                      |
| <span data-ttu-id="ab818-157">**SAFEARRAY** (*TypeName*) </span><span class="sxs-lookup"><span data-stu-id="ab818-157">**SAFEARRAY**(*TypeName*)</span></span>                       | <span data-ttu-id="ab818-158">*TypeName* 是上述任何一種類型。</span><span class="sxs-lookup"><span data-stu-id="ab818-158">*TypeName* is any of the above types.</span></span> <span data-ttu-id="ab818-159">這些類型的陣列。</span><span class="sxs-lookup"><span data-stu-id="ab818-159">Array of these types.</span></span>                                                                                                                                                   |
| <span data-ttu-id="ab818-160">**TypeName \***</span><span class="sxs-lookup"><span data-stu-id="ab818-160">**TypeName \***</span></span>                                 | <span data-ttu-id="ab818-161">*TypeName* 是上述任何一種類型。</span><span class="sxs-lookup"><span data-stu-id="ab818-161">*TypeName* is any of the above types.</span></span> <span data-ttu-id="ab818-162">型別的指標。</span><span class="sxs-lookup"><span data-stu-id="ab818-162">Pointer to a type.</span></span>                                                                                                                                                      |
| <span data-ttu-id="ab818-163">**十進位**</span><span class="sxs-lookup"><span data-stu-id="ab818-163">**Decimal**</span></span>                                     | <span data-ttu-id="ab818-164">96位不帶正負號的二進位整數，以10的可變乘冪來調整。</span><span class="sxs-lookup"><span data-stu-id="ab818-164">96-bit unsigned binary integer scaled by a variable power of 10.</span></span> <span data-ttu-id="ab818-165">十進位資料類型，可提供數位大小和小數位數 (的座標) 。</span><span class="sxs-lookup"><span data-stu-id="ab818-165">A decimal data type that provides a size and a scale for a number (as in coordinates).</span></span>                                                       |



 

<span data-ttu-id="ab818-166">如果參數的類型是與 automation 相容的型別、與 Automation 相容的型別指標，或 Automation 相容型別的 SAFEARRAY，則參數與 Automation 相容。</span><span class="sxs-lookup"><span data-stu-id="ab818-166">A parameter is compatible with Automation if its type is an Automation-compatible type, a pointer to an Automation-compatible type, or a SAFEARRAY of an Automation-compatible type.</span></span>

<span data-ttu-id="ab818-167">如果類型為 HRESULT、SCODE 或 [**void**](void.md)，則傳回類型與 Automation 相容。</span><span class="sxs-lookup"><span data-stu-id="ab818-167">A return type is compatible with Automation if its type is an HRESULT, SCODE or [**void**](void.md).</span></span> <span data-ttu-id="ab818-168">不過，MIDL 要求介面方法會傳回 HRESULT 或 SCODE。</span><span class="sxs-lookup"><span data-stu-id="ab818-168">However, MIDL requires that interface methods return either HRESULT or SCODE.</span></span> <span data-ttu-id="ab818-169">傳回 **void** 會產生編譯器錯誤。</span><span class="sxs-lookup"><span data-stu-id="ab818-169">Returning **void** generates a compiler error.</span></span>

<span data-ttu-id="ab818-170">如果成員的傳回型別及其所有參數都是自動化相容的，則成員與 Automation 相容。</span><span class="sxs-lookup"><span data-stu-id="ab818-170">A member is compatible with Automation if its return type and all its parameters are Automation compatible.</span></span>

<span data-ttu-id="ab818-171">如果介面衍生自 [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch)或 [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown)，介面就會與自動化相容; 它具有 **\[ OLEAUTOMATION \]** 屬性，而且所有的 VTBL 專案都是自動化相容的。</span><span class="sxs-lookup"><span data-stu-id="ab818-171">An interface is compatible with Automation if it is derived from [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) or [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown), it has the **\[oleautomation\]** attribute, and all of its VTBL entries are Automation compatible.</span></span> <span data-ttu-id="ab818-172">若為32位平臺，介面中所有方法的呼叫慣例都必須是 STDCALL。</span><span class="sxs-lookup"><span data-stu-id="ab818-172">For 32-bit platforms, the calling convention for all methods in the interface must be STDCALL.</span></span> <span data-ttu-id="ab818-173">若是16位系統，所有方法都必須有 CDECL 呼叫慣例。</span><span class="sxs-lookup"><span data-stu-id="ab818-173">For 16-bit systems, all methods must have the CDECL calling convention.</span></span>

<span data-ttu-id="ab818-174">每個 [**介面介面**](dispinterface.md) 都有隱含的自動化相容性。</span><span class="sxs-lookup"><span data-stu-id="ab818-174">Every [**dispinterface**](dispinterface.md) is implicitly Automation-compatible.</span></span> <span data-ttu-id="ab818-175">因此，您不應該在 **介面介面** 上使用 **\[ oleautomation \]** 屬性。</span><span class="sxs-lookup"><span data-stu-id="ab818-175">Therefore you should not use the **\[oleautomation\]** attribute on **dispinterface**.</span></span>

<span data-ttu-id="ab818-176">當您使用 MIDL 編譯器 [**/osf**](-osf.md)參數進行編譯時，無法使用 **\[ oleautomation \]** 屬性。</span><span class="sxs-lookup"><span data-stu-id="ab818-176">The **\[oleautomation\]** attribute is not available when you compile using the MIDL compiler [**/osf**](-osf.md) switch.</span></span>

### <a name="flags"></a><span data-ttu-id="ab818-177">Flags</span><span class="sxs-lookup"><span data-stu-id="ab818-177">Flags</span></span>

<span data-ttu-id="ab818-178">TYPEFLAG \_ FOLEAUTOMATION</span><span class="sxs-lookup"><span data-stu-id="ab818-178">TYPEFLAG\_FOLEAUTOMATION</span></span>

## <a name="examples"></a><span data-ttu-id="ab818-179">範例</span><span class="sxs-lookup"><span data-stu-id="ab818-179">Examples</span></span>

``` syntax
library Hello
{
    importlib("stdole32.tlb");
    [
        uuid(12345678-1234-1234-1234-123456789ABC),
        helpstring("Application object for the Hello application."),
        oleautomation,
        dual
    ]
    interface IHello : IDispatch
    {
        // Interface definition statements.
    }

    // Other library definition statements.
}
```

## <a name="see-also"></a><span data-ttu-id="ab818-180">另請參閱</span><span class="sxs-lookup"><span data-stu-id="ab818-180">See also</span></span>

<dl> <dt>

[<span data-ttu-id="ab818-181"> (IDL) 檔案的介面定義</span><span class="sxs-lookup"><span data-stu-id="ab818-181">Interface Definition (IDL) File</span></span>](interface-definition-idl-file.md)
</dt> <dt>

[<span data-ttu-id="ab818-182">使用 MIDL 產生類型程式庫</span><span class="sxs-lookup"><span data-stu-id="ab818-182">Generating a Type Library With MIDL</span></span>](generating-a-type-library-with-midl-2.md)
</dt> <dt>

[<span data-ttu-id="ab818-183">ODL 檔案範例</span><span class="sxs-lookup"><span data-stu-id="ab818-183">ODL File Example</span></span>](/previous-versions/windows/desktop/automat/odl-file-example)
</dt> <dt>

[<span data-ttu-id="ab818-184">ODL 檔語法</span><span class="sxs-lookup"><span data-stu-id="ab818-184">ODL File Syntax</span></span>](/previous-versions/windows/desktop/automat/odl-file-syntax)
</dt> <dt>

[<span data-ttu-id="ab818-185">**/osf**</span><span class="sxs-lookup"><span data-stu-id="ab818-185">**/osf**</span></span>](-osf.md)
</dt> <dt>

[<span data-ttu-id="ab818-186">**uuid**</span><span class="sxs-lookup"><span data-stu-id="ab818-186">**uuid**</span></span>](uuid.md)
</dt> </dl>

 

 