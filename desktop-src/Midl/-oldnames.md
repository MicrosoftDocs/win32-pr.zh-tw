---
title: /oldnames 參數
description: /Oldnames 參數會指示 MIDL 編譯器產生不包含版本號碼的介面名稱。
ms.assetid: 3a79c399-e115-46fd-9559-681b85cd872d
keywords:
- /oldnames 參數 MIDL
topic_type:
- apiref
api_name:
- /oldnames
api_type:
- NA
ms.topic: reference
ms.date: 05/31/2018
ms.openlocfilehash: 44cf861d2bf4f4123d7a1ee103e6966e5d404946
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/19/2020
ms.locfileid: "103681894"
---
# <a name="oldnames-switch"></a><span data-ttu-id="c7f02-104">/oldnames 參數</span><span class="sxs-lookup"><span data-stu-id="c7f02-104">/oldnames switch</span></span>

<span data-ttu-id="c7f02-105">**/Oldnames** 參數會指示 MIDL 編譯器產生不包含版本號碼的介面名稱。</span><span class="sxs-lookup"><span data-stu-id="c7f02-105">The **/oldnames** switch directs the MIDL compiler to generate interface names that do not include the version number.</span></span>

``` syntax
midl /oldnames
```

## <a name="switch-options"></a><span data-ttu-id="c7f02-106">切換選項</span><span class="sxs-lookup"><span data-stu-id="c7f02-106">Switch Options</span></span>

<span data-ttu-id="c7f02-107">此參數沒有任何參數。</span><span class="sxs-lookup"><span data-stu-id="c7f02-107">This switch has no parameters.</span></span>

## <a name="remarks"></a><span data-ttu-id="c7f02-108">備註</span><span class="sxs-lookup"><span data-stu-id="c7f02-108">Remarks</span></span>

<span data-ttu-id="c7f02-109">MIDL 編譯器會將介面的版本號碼併入存根中產生的介面名稱 (例如，iface \_ v1 \_ 0 \_ ServerIfHandle) 。</span><span class="sxs-lookup"><span data-stu-id="c7f02-109">The MIDL compiler incorporates the version number of the interface into the interface name that is generated in the stub (for example, iface\_v1\_0\_ServerIfHandle).</span></span> <span data-ttu-id="c7f02-110">此命名格式與憑證 DCE IDL 編譯器所使用的格式一致。</span><span class="sxs-lookup"><span data-stu-id="c7f02-110">This naming format is consistent with the format used by the OSF DCE IDL compiler.</span></span> <span data-ttu-id="c7f02-111">但是，它與 MIDL 1.0 編譯器所使用的命名格式不同。</span><span class="sxs-lookup"><span data-stu-id="c7f02-111">However, it differs from the naming format used by the MIDL 1.0 compiler.</span></span> <span data-ttu-id="c7f02-112">MIDL 1.0 編譯器不包含介面名稱中的版本號碼 (例如 iface \_ ServerIfHandle) 。</span><span class="sxs-lookup"><span data-stu-id="c7f02-112">The MIDL 1.0 compiler did not include version numbers in interface names (for example, iface\_ServerIfHandle).</span></span> <span data-ttu-id="c7f02-113">**/Oldnames** 參數可讓您指示 MIDL 編譯器產生不包含版本號碼的介面名稱。</span><span class="sxs-lookup"><span data-stu-id="c7f02-113">The **/oldnames** switch allows you to instruct the MIDL compiler to generate interface names which do not include the version number.</span></span> <span data-ttu-id="c7f02-114">如此一來，格式會與 MIDL 1.0 編譯器所產生的名稱一致。</span><span class="sxs-lookup"><span data-stu-id="c7f02-114">In this way, the format is consistent with names generated by the MIDL 1.0 compiler.</span></span>

<span data-ttu-id="c7f02-115">如果您的伺服器應用程式程式碼是以 MIDL 1.0 編譯器產生的存根來使用，而它是指 MIDL 產生的介面名稱 (例如，在 [**RpcServerRegisterIf**](/windows/desktop/api/rpcdce/nf-rpcdce-rpcserverregisterif)) 的呼叫中，您應該將它變更為參考 midl 編譯器2.0 版或更新版本所支援的介面名稱樣式。</span><span class="sxs-lookup"><span data-stu-id="c7f02-115">If you have server application code that was written for use with a stub generated by the MIDL 1.0 compiler and it refers to the MIDL-generated interface name (for example, in a call to [**RpcServerRegisterIf**](/windows/desktop/api/rpcdce/nf-rpcdce-rpcserverregisterif)), you should change it to reference the style of interface name supported by version 2.0 or later of the MIDL compiler.</span></span> <span data-ttu-id="c7f02-116">或者，您可以在叫用 MIDL 編譯器時使用 **/oldnames** 參數。</span><span class="sxs-lookup"><span data-stu-id="c7f02-116">Alternately, you can use the **/oldnames** switch when invoking the MIDL compiler.</span></span>

## <a name="examples"></a><span data-ttu-id="c7f02-117">範例</span><span class="sxs-lookup"><span data-stu-id="c7f02-117">Examples</span></span>

<span data-ttu-id="c7f02-118">**midl/oldnames 檔案名 .idl**</span><span class="sxs-lookup"><span data-stu-id="c7f02-118">**midl /oldnames filename.idl**</span></span>

## <a name="see-also"></a><span data-ttu-id="c7f02-119">另請參閱</span><span class="sxs-lookup"><span data-stu-id="c7f02-119">See also</span></span>

<dl> <dt>

[<span data-ttu-id="c7f02-120">一般 MIDL 命令列語法</span><span class="sxs-lookup"><span data-stu-id="c7f02-120">General MIDL Command-line Syntax</span></span>](general-midl-command-line-syntax.md)
</dt> <dt>

[<span data-ttu-id="c7f02-121"> (IDL) 檔案的介面定義</span><span class="sxs-lookup"><span data-stu-id="c7f02-121">Interface Definition (IDL) File</span></span>](interface-definition-idl-file.md)
</dt> </dl>

 

 