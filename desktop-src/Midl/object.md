---
title: object 屬性
description: '\ Object \ 介面屬性會識別 COM 介面。'
ms.assetid: 51e34ef3-eea7-45f4-b961-a9f742700fe5
keywords:
- 物件屬性 MIDL
topic_type:
- apiref
api_name:
- object
api_type:
- NA
ms.topic: reference
ms.date: 05/31/2018
ms.openlocfilehash: cb2c21246282646dcf6ae488411316e07ab62b2f
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/19/2020
ms.locfileid: "103682116"
---
# <a name="object-attribute"></a><span data-ttu-id="e52e3-104">object 屬性</span><span class="sxs-lookup"><span data-stu-id="e52e3-104">object attribute</span></span>

<span data-ttu-id="e52e3-105">**\[ 物件 \]** 介面屬性會識別 COM 介面。</span><span class="sxs-lookup"><span data-stu-id="e52e3-105">The **\[object\]** interface attribute identifies a COM interface.</span></span> <span data-ttu-id="e52e3-106"> (不包含 **\[ 物件 \]** 屬性的介面屬性清單，表示 DCE RPC 介面。 ) </span><span class="sxs-lookup"><span data-stu-id="e52e3-106">(An interface attribute list that does not include the **\[object\]** attribute indicates a DCE RPC interface.)</span></span>

``` syntax
[ 
    object, 
    uuid(string-uuid)
    [ , interface-attribute-list] 
] 
interface interface-name : base-interface
{
...    
}
```

## <a name="parameters"></a><span data-ttu-id="e52e3-107">參數</span><span class="sxs-lookup"><span data-stu-id="e52e3-107">Parameters</span></span>

<dl> <dt>

<span data-ttu-id="e52e3-108">*字串-uuid*</span><span class="sxs-lookup"><span data-stu-id="e52e3-108">*string-uuid*</span></span> 
</dt> <dd>

<span data-ttu-id="e52e3-109">Uuidgen.exe 公用程式所產生的 UUID 字串。</span><span class="sxs-lookup"><span data-stu-id="e52e3-109">A UUID string generated by the Uuidgen utility.</span></span> <span data-ttu-id="e52e3-110">您可以用引號括住 UUID 字串。</span><span class="sxs-lookup"><span data-stu-id="e52e3-110">You can enclose the UUID string in quotes.</span></span>

</dd> <dt>

<span data-ttu-id="e52e3-111">*介面屬性清單*</span><span class="sxs-lookup"><span data-stu-id="e52e3-111">*interface-attribute-list*</span></span> 
</dt> <dd>

<span data-ttu-id="e52e3-112">適用于整個介面的其他屬性。</span><span class="sxs-lookup"><span data-stu-id="e52e3-112">Other attributes that apply to the interface as a whole.</span></span>

</dd> <dt>

<span data-ttu-id="e52e3-113">*介面-名稱*</span><span class="sxs-lookup"><span data-stu-id="e52e3-113">*interface-name*</span></span> 
</dt> <dd>

<span data-ttu-id="e52e3-114">介面的名稱。</span><span class="sxs-lookup"><span data-stu-id="e52e3-114">The name of the interface.</span></span>

</dd> <dt>

<span data-ttu-id="e52e3-115">*基底介面*</span><span class="sxs-lookup"><span data-stu-id="e52e3-115">*base-interface*</span></span> 
</dt> <dd>

<span data-ttu-id="e52e3-116">從其中衍生這個介面的 COM 介面。</span><span class="sxs-lookup"><span data-stu-id="e52e3-116">The COM interface from which this interface derives.</span></span> <span data-ttu-id="e52e3-117">基底介面必須是 [**iunknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown)、 [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch)或另一個直接或間接衍生自 **iunknown** 或 **idispatch** 的 COM 介面。</span><span class="sxs-lookup"><span data-stu-id="e52e3-117">The base interface must be [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown), [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch), or another COM interface that derives, either directly or indirectly, from **IUnknown** or **IDispatch**.</span></span>

</dd> </dl>

## <a name="remarks"></a><span data-ttu-id="e52e3-118">備註</span><span class="sxs-lookup"><span data-stu-id="e52e3-118">Remarks</span></span>

<span data-ttu-id="e52e3-119">COM 介面的介面屬性清單必須包含 **\[** [**uuid**](uuid.md) **\]** 屬性，但它不能包含 **\[** [**version**](version.md) **\]** 屬性。</span><span class="sxs-lookup"><span data-stu-id="e52e3-119">An interface attribute list for a COM interface must include the **\[**[**uuid**](uuid.md)**\]** attribute, but it cannot include the **\[**[**version**](version.md)**\]** attribute.</span></span>

<span data-ttu-id="e52e3-120">根據預設，使用 MIDL 編譯器編譯 COM 介面會產生建立 proxy DLL 所需的檔案。</span><span class="sxs-lookup"><span data-stu-id="e52e3-120">By default, compiling a COM interface with the MIDL compiler generates the files needed to build a proxy DLL.</span></span> <span data-ttu-id="e52e3-121">此 DLL 包含的程式碼可支援用戶端應用程式和物件服務器使用自訂 COM 介面。</span><span class="sxs-lookup"><span data-stu-id="e52e3-121">This DLL contains the code to support the use of the custom COM interface by both client applications and object servers.</span></span> <span data-ttu-id="e52e3-122">但是，如果 COM 介面的介面屬性清單指定 **\[** [**區域**](local.md) **\]** 屬性，MIDL 編譯器只會產生介面標頭檔。</span><span class="sxs-lookup"><span data-stu-id="e52e3-122">However, if the interface attribute list for a COM interface specifies the **\[**[**local**](local.md)**\]** attribute, the MIDL compiler generates only the interface header file.</span></span>

<span data-ttu-id="e52e3-123">MIDL 編譯器會自動產生 COM 介面的介面資料型別。</span><span class="sxs-lookup"><span data-stu-id="e52e3-123">The MIDL compiler automatically generates an interface data type for a COM interface.</span></span> <span data-ttu-id="e52e3-124">或者，您可以使用 [**typedef**](typedef.md) 搭配 [**interface**](interface.md) 關鍵字來明確定義介面資料類型。</span><span class="sxs-lookup"><span data-stu-id="e52e3-124">As an alternative, you can use [**typedef**](typedef.md) with the [**interface**](interface.md) keyword to explicitly define an interface data type.</span></span> <span data-ttu-id="e52e3-125">然後，介面規格可以在函數參數和傳回值、 [**結構**](struct.md) 和等 [**位成員，**](union.md) 以及其他類型宣告中使用介面資料類型。</span><span class="sxs-lookup"><span data-stu-id="e52e3-125">The interface specification can then use the interface data type in function parameters and return values, [**struct**](struct.md) and [**union**](union.md) members, and other type declarations.</span></span> <span data-ttu-id="e52e3-126">下列範例說明如何使用自動產生的 [**IStream**](/windows/desktop/api/objidl/nn-objidl-istream) 資料類型：</span><span class="sxs-lookup"><span data-stu-id="e52e3-126">The following example illustrates the use of an automatically generated [**IStream**](/windows/desktop/api/objidl/nn-objidl-istream) data type:</span></span>

``` syntax
[
    object, 
    uuid (ABCDEFOO-1234-1234-5678-ABCDEF123456)
] 
interface IStream : IUnknown
{ 
    typedef IStream * LPSTREAM; 
    // Other interface definition statements.
}
```

<span data-ttu-id="e52e3-127">在 COM 介面中，會假設所有介面成員函式都是虛擬函式。</span><span class="sxs-lookup"><span data-stu-id="e52e3-127">In a COM interface, all the interface member functions are assumed to be virtual functions.</span></span> <span data-ttu-id="e52e3-128">虛擬函式將 **this** 指標隱含為第一個參數。</span><span class="sxs-lookup"><span data-stu-id="e52e3-128">A virtual function has an implicit **this** pointer as the first parameter.</span></span> <span data-ttu-id="e52e3-129">虛擬函式資料表包含每個介面成員函式的專案。</span><span class="sxs-lookup"><span data-stu-id="e52e3-129">The virtual function table contains an entry for each interface member function.</span></span>

<span data-ttu-id="e52e3-130">非 **\[** [**區域**](local.md) **\]** 物件介面成員函式必須有 HRESULT 或 SCODE 的傳回值。</span><span class="sxs-lookup"><span data-stu-id="e52e3-130">Non-**\[**[**local**](local.md)**\]** object interface member functions must have a return value of HRESULT or SCODE.</span></span> <span data-ttu-id="e52e3-131"> (請注意，舊版 MIDL 允許的成員函數傳回 [**void**](void.md)。</span><span class="sxs-lookup"><span data-stu-id="e52e3-131">(Note that earlier versions of MIDL allowed member functions to return [**void**](void.md).</span></span> <span data-ttu-id="e52e3-132">不過，從 MIDL 3.0 版開始，傳回 **void** 會產生編譯器錯誤。 ) 具有 HRESULT 或 SCODE 的傳回值表示如果在遠端呼叫期間產生例外狀況，則產生的 proxy 會攔截例外狀況，並傳回傳回值中的例外狀況代碼。</span><span class="sxs-lookup"><span data-stu-id="e52e3-132">However, beginning with MIDL version 3.0, returning **void** generates a compiler error.) Having a return value of HRESULT or SCODE means that if an exception is generated during a remote call, the generated proxies catch the exception and return the exception code in the return value.</span></span> <span data-ttu-id="e52e3-133">如果您的應用程式可以承受忽略遠端程序呼叫期間發生的錯誤，您可以指定 HRESULT 做為傳回型別，而不會在呼叫後檢查傳回值。</span><span class="sxs-lookup"><span data-stu-id="e52e3-133">If your application can afford to ignore errors that occur during a remote procedure call, you can specify HRESULT as the return type without checking the return value after the call.</span></span>

<span data-ttu-id="e52e3-134">如果您要重新編譯舊的應用程式，當伺服器將新引進的結果傳送至用戶端時，變更傳回型別可能會引發回溯相容性問題。</span><span class="sxs-lookup"><span data-stu-id="e52e3-134">If you are recompiling an old application, changing the return types can introduce backward compatibility problems when the server sends the newly introduced result to the client.</span></span> <span data-ttu-id="e52e3-135">除了變更傳回型別之外，您還可以使用 [](void.md)呼叫 as 屬性來標記傳回 void 的函式 **\[** [**\_**](call-as.md) **\]** ，使其成為區域函數。</span><span class="sxs-lookup"><span data-stu-id="e52e3-135">As an alternative to changing the return type, you can label the function that returns [**void**](void.md) with the **\[**[**call\_as**](call-as.md)**\]** attribute, thus making it a local function.</span></span> <span data-ttu-id="e52e3-136">然後使用相同的參數，但以 HRESULT 的傳回型別來定義相關的遠端函式。</span><span class="sxs-lookup"><span data-stu-id="e52e3-136">Then define a related remote function with the same parameters but with the return type of HRESULT.</span></span> <span data-ttu-id="e52e3-137">視需要，區域函式會根據該 HRESULT 值引發例外狀況。</span><span class="sxs-lookup"><span data-stu-id="e52e3-137">The local function can raise an exception based on that HRESULT value, if necessary.</span></span>

<span data-ttu-id="e52e3-138">當您使用 MIDL 編譯器 [**/osf**](-osf.md)參數進行編譯時，無法使用 **\[ 物件 \]** 屬性。</span><span class="sxs-lookup"><span data-stu-id="e52e3-138">The **\[object\]** attribute is not available when you compile using the MIDL compiler [**/osf**](-osf.md) switch.</span></span>

## <a name="examples"></a><span data-ttu-id="e52e3-139">範例</span><span class="sxs-lookup"><span data-stu-id="e52e3-139">Examples</span></span>

``` syntax
[
    uuid(12345678-1234-1234-1234-123456789ABC), 
    object
] 
interface IMyInterface : IUnknown
{
    // Interface definition statements.
}

[
    uuid(87654321-1234-1234-1234-123456789ABC), 
    object, 
    local
] 
interface ILocalInterface : ISomeOldCOMInterface
{
    // Interface definition statements.
}
```

## <a name="see-also"></a><span data-ttu-id="e52e3-140">另請參閱</span><span class="sxs-lookup"><span data-stu-id="e52e3-140">See also</span></span>

<dl> <dt>

[<span data-ttu-id="e52e3-141">**呼叫 \_ as**</span><span class="sxs-lookup"><span data-stu-id="e52e3-141">**call\_as**</span></span>](call-as.md)
</dt> <dt>

[<span data-ttu-id="e52e3-142"> (IDL) 檔案的介面定義</span><span class="sxs-lookup"><span data-stu-id="e52e3-142">Interface Definition (IDL) File</span></span>](interface-definition-idl-file.md)
</dt> <dt>

[<span data-ttu-id="e52e3-143">**iid \_ 為**</span><span class="sxs-lookup"><span data-stu-id="e52e3-143">**iid\_is**</span></span>](iid-is.md)
</dt> <dt>

[<span data-ttu-id="e52e3-144">**介面**</span><span class="sxs-lookup"><span data-stu-id="e52e3-144">**interface**</span></span>](interface.md)
</dt> <dt>

[<span data-ttu-id="e52e3-145">**當地**</span><span class="sxs-lookup"><span data-stu-id="e52e3-145">**local**</span></span>](local.md)
</dt> <dt>

[<span data-ttu-id="e52e3-146">**/osf**</span><span class="sxs-lookup"><span data-stu-id="e52e3-146">**/osf**</span></span>](-osf.md)
</dt> <dt>

[<span data-ttu-id="e52e3-147">**著**</span><span class="sxs-lookup"><span data-stu-id="e52e3-147">**typedef**</span></span>](typedef.md)
</dt> <dt>

[<span data-ttu-id="e52e3-148">**uuid**</span><span class="sxs-lookup"><span data-stu-id="e52e3-148">**uuid**</span></span>](uuid.md)
</dt> <dt>

[<span data-ttu-id="e52e3-149">**版本**</span><span class="sxs-lookup"><span data-stu-id="e52e3-149">**version**</span></span>](version.md)
</dt> </dl>

 

 