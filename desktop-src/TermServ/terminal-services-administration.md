---
title: 遠端桌面服務管理
description: 遠端桌面服務 API 可讓您列舉和管理遠端桌面工作階段主機 (RD 工作階段主機) 伺服器、用戶端會話和進程。
ms.assetid: 85a9ed9d-79d6-4011-93a4-00847c689747
ms.tgt_platform: multiple
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e763a652335c85931225746334bc21db0e6e086d
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/20/2020
ms.locfileid: "106965245"
---
# <a name="remote-desktop-services-administration"></a><span data-ttu-id="69a56-103">遠端桌面服務管理</span><span class="sxs-lookup"><span data-stu-id="69a56-103">Remote Desktop Services Administration</span></span>

<span data-ttu-id="69a56-104">遠端桌面服務 API 可讓您列舉和管理遠端桌面工作階段主機 (RD 工作階段主機) 伺服器、用戶端會話和進程。</span><span class="sxs-lookup"><span data-stu-id="69a56-104">The Remote Desktop Services API enables you to enumerate and manage Remote Desktop Session Host (RD Session Host) servers, client sessions, and processes.</span></span>

<span data-ttu-id="69a56-105">若要取出網域中所有 RD 工作階段主機伺服器的名稱，請呼叫 [**NetServerEnum**](/windows/desktop/api/lmserver/nf-lmserver-netserverenum) 函式來列舉 SV \_ 類型 TERMINALSERVER 類型的伺服器 \_ 。</span><span class="sxs-lookup"><span data-stu-id="69a56-105">To retrieve the names of all the RD Session Host servers in a domain, call the [**NetServerEnum**](/windows/desktop/api/lmserver/nf-lmserver-netserverenum) function to enumerate servers of the SV\_TYPE\_TERMINALSERVER type.</span></span> <span data-ttu-id="69a56-106">若要開啟特定 RD 工作階段主機伺服器的控制碼，請在 [**WTSOpenServer**](/windows/desktop/api/Wtsapi32/nf-wtsapi32-wtsopenservera) 函式的呼叫中傳遞伺服器名稱。</span><span class="sxs-lookup"><span data-stu-id="69a56-106">To open a handle to a specific RD Session Host server, pass the server name in a call to the [**WTSOpenServer**](/windows/desktop/api/Wtsapi32/nf-wtsapi32-wtsopenservera) function.</span></span> <span data-ttu-id="69a56-107">當您完成使用控制碼時，請呼叫 [**WTSCloseServer**](/windows/desktop/api/Wtsapi32/nf-wtsapi32-wtscloseserver) 函式來釋放它。</span><span class="sxs-lookup"><span data-stu-id="69a56-107">When you have finished using the handle, release it by calling the [**WTSCloseServer**](/windows/desktop/api/Wtsapi32/nf-wtsapi32-wtscloseserver) function.</span></span>

<span data-ttu-id="69a56-108">您可以使用 **WTSOpenServer** 所傳回的控制碼，在伺服器上執行下列作業。</span><span class="sxs-lookup"><span data-stu-id="69a56-108">You can use the handle returned by **WTSOpenServer** to perform the following operations on the server.</span></span>



| <span data-ttu-id="69a56-109">函式</span><span class="sxs-lookup"><span data-stu-id="69a56-109">Function</span></span>                                                         | <span data-ttu-id="69a56-110">作業</span><span class="sxs-lookup"><span data-stu-id="69a56-110">Operation</span></span>                                                                                                                                                                                                         |
|------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="69a56-111">**WTSDisconnectSession**</span><span class="sxs-lookup"><span data-stu-id="69a56-111">**WTSDisconnectSession**</span></span>](/windows/desktop/api/Wtsapi32/nf-wtsapi32-wtsdisconnectsession)             | <span data-ttu-id="69a56-112">中斷用戶端與指定會話的連線。</span><span class="sxs-lookup"><span data-stu-id="69a56-112">Disconnects the client from a specified session.</span></span> <span data-ttu-id="69a56-113">會話仍維持使用中狀態，且使用者可以重新登入以連接到相同的會話。</span><span class="sxs-lookup"><span data-stu-id="69a56-113">The session remains active and the user can log on again to connect to the same session.</span></span>                                                                         |
| [<span data-ttu-id="69a56-114">**WTSEnumerateSessions**</span><span class="sxs-lookup"><span data-stu-id="69a56-114">**WTSEnumerateSessions**</span></span>](/windows/desktop/api/Wtsapi32/nf-wtsapi32-wtsenumeratesessionsa)             | <span data-ttu-id="69a56-115">傳回指定 RD 工作階段主機伺服器上的會話清單。</span><span class="sxs-lookup"><span data-stu-id="69a56-115">Returns a list of sessions on the specified RD Session Host server.</span></span>                                                                                                                                               |
| [<span data-ttu-id="69a56-116">**WTSEnumerateProcesses**</span><span class="sxs-lookup"><span data-stu-id="69a56-116">**WTSEnumerateProcesses**</span></span>](/windows/desktop/api/Wtsapi32/nf-wtsapi32-wtsenumerateprocessesa)           | <span data-ttu-id="69a56-117">傳回指定 RD 工作階段主機伺服器上的進程清單。</span><span class="sxs-lookup"><span data-stu-id="69a56-117">Returns a list of processes on the specified RD Session Host server.</span></span>                                                                                                                                              |
| [<span data-ttu-id="69a56-118">**WTSLogoffSession**</span><span class="sxs-lookup"><span data-stu-id="69a56-118">**WTSLogoffSession**</span></span>](/windows/desktop/api/Wtsapi32/nf-wtsapi32-wtslogoffsession)                     | <span data-ttu-id="69a56-119">登出指定的會話。</span><span class="sxs-lookup"><span data-stu-id="69a56-119">Logs off the specified session.</span></span>                                                                                                                                                                                   |
| [<span data-ttu-id="69a56-120">**WTSQuerySessionInformation**</span><span class="sxs-lookup"><span data-stu-id="69a56-120">**WTSQuerySessionInformation**</span></span>](/windows/desktop/api/Wtsapi32/nf-wtsapi32-wtsquerysessioninformationa) | <span data-ttu-id="69a56-121">傳回指定 RD 工作階段主機伺服器上指定之會話的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="69a56-121">Returns information about the specified session on the specified RD Session Host server.</span></span>                                                                                                                          |
| [<span data-ttu-id="69a56-122">**WTSSendMessage**</span><span class="sxs-lookup"><span data-stu-id="69a56-122">**WTSSendMessage**</span></span>](/windows/desktop/api/Wtsapi32/nf-wtsapi32-wtssendmessagea)                         | <span data-ttu-id="69a56-123">在用戶端顯示指定的會話時顯示訊息方塊。</span><span class="sxs-lookup"><span data-stu-id="69a56-123">Shows a message box on the client display of a specified session.</span></span>                                                                                                                                                 |
| [<span data-ttu-id="69a56-124">**WTSShutdownSystem**</span><span class="sxs-lookup"><span data-stu-id="69a56-124">**WTSShutdownSystem**</span></span>](/windows/desktop/api/Wtsapi32/nf-wtsapi32-wtsshutdownsystem)                   | <span data-ttu-id="69a56-125">關閉並選擇性地重新開機指定的 RD 工作階段主機伺服器。</span><span class="sxs-lookup"><span data-stu-id="69a56-125">Shuts down and optionally restarts a specified RD Session Host server.</span></span>                                                                                                                                            |
| [<span data-ttu-id="69a56-126">**WTSTerminateProcess**</span><span class="sxs-lookup"><span data-stu-id="69a56-126">**WTSTerminateProcess**</span></span>](/windows/desktop/api/Wtsapi32/nf-wtsapi32-wtsterminateprocess)               | <span data-ttu-id="69a56-127">終止指定 RD 工作階段主機伺服器上的指定進程。</span><span class="sxs-lookup"><span data-stu-id="69a56-127">Terminates a specified process on a specified RD Session Host server.</span></span>                                                                                                                                             |
| [<span data-ttu-id="69a56-128">**WTSVirtualChannelOpen**</span><span class="sxs-lookup"><span data-stu-id="69a56-128">**WTSVirtualChannelOpen**</span></span>](/windows/desktop/api/Wtsapi32/nf-wtsapi32-wtsvirtualchannelopen)           | <span data-ttu-id="69a56-129">開啟指定虛擬通道之伺服器端的控制碼。</span><span class="sxs-lookup"><span data-stu-id="69a56-129">Opens a handle to the server end of a specified virtual channel.</span></span> <span data-ttu-id="69a56-130">如需虛擬通道的詳細資訊，請參閱 [使用遠端桌面服務虛擬通道](using-terminal-services-virtual-channels.md)。</span><span class="sxs-lookup"><span data-stu-id="69a56-130">For more information about virtual channels, see [Using Remote Desktop Services Virtual Channels](using-terminal-services-virtual-channels.md).</span></span> |
| [<span data-ttu-id="69a56-131">**WTSWaitSystemEvent**</span><span class="sxs-lookup"><span data-stu-id="69a56-131">**WTSWaitSystemEvent**</span></span>](/windows/desktop/api/Wtsapi32/nf-wtsapi32-wtswaitsystemevent)                 | <span data-ttu-id="69a56-132">等候事件，例如建立用戶端會話或登入 RD 工作階段主機 server 的使用者。</span><span class="sxs-lookup"><span data-stu-id="69a56-132">Waits for an event, such as the creation of a client session or a user logging on to the RD Session Host server.</span></span>                                                                                                  |



 

<span data-ttu-id="69a56-133">其中有幾個函式會配置緩衝區，以將資訊傳回給呼叫者。</span><span class="sxs-lookup"><span data-stu-id="69a56-133">Several of these functions allocate buffers to return information to the caller.</span></span> <span data-ttu-id="69a56-134">當您完成使用緩衝區時，請呼叫 [**WTSFreeMemory**](/windows/desktop/api/Wtsapi32/nf-wtsapi32-wtsfreememory) 函式來釋放它。</span><span class="sxs-lookup"><span data-stu-id="69a56-134">When you have finished using the buffer, free it by calling the [**WTSFreeMemory**](/windows/desktop/api/Wtsapi32/nf-wtsapi32-wtsfreememory) function.</span></span>

 

 