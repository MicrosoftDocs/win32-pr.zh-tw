---
description: 命令
ms.assetid: f579745a-5327-4c8b-bfa7-fe81d9657a3b
title: '命令 (WPD API) '
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 974c6b2b68949e53ae778ed56adcfcb10d2edd5d
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/07/2021
ms.locfileid: "104191286"
---
# <a name="commands-wpd-api"></a>命令 (WPD API) 

用戶端應用程式和驅動程式會藉由從用戶端 (透過 User-Mode 驅動程式架構) 透過 Windows 可攜式裝置 API) 傳送至驅動程式 (的命令進行通訊。 命令不一定會包含參數，且不一定會傳回結果。 用戶端可以呼叫 [**IPortableDevice：： SendCommand**](/windows/desktop/api/PortableDeviceApi/nf-portabledeviceapi-iportabledevice-sendcommand) 方法或 **IPortableDeviceService： SendCommand** 方法，或藉由呼叫用戶端介面的任何方法，以明確地傳送命令。 只有一些命令可以明確地傳送;這些會在命令的檔中注明。 命令參考頁面描述命令的用途，以及它預期要接收的參數，以及預期會傳回的參數。

命令是由 **PROPERTYKEY** 結構所識別。 這是由兩個部分所組成： GUID 部分 (*fmtid* 成員) 和 (*pid* 成員) 的 DWORD 部分。 GUID 部分可用來指出命令所屬類別 (相關命令屬於相同的類別，因此將會有相同的 *fmtid*) 。 DWORD 部分表示命令識別碼，用來區別命令類別中的個別命令 (相同類別中命令的 *pid* 值會) 不同。

下表列出 Windows 可攜式裝置所定義命令的類別。 裝置製造商可以藉由建立自己的命令類別和命令識別碼，來定義自己的命令。 不過，製造商不應將命令新增至下列類別，因為這些是由 Microsoft 所保留的類別。

**命令類別目錄**



| 命令類別目錄                         | Description                                                                                                                             |
|------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------|
| **WPD \_ 類別 \_ 通用**                | 所有物件和裝置通用的命令。                                                                                    |
| **WPD \_ 類別 \_ 裝置 \_ 提示**         | 用來取得選擇性裝置資訊的命令，可用來改善終端使用者體驗。                         |
| **WPD \_ 類別 \_ SMS**                   | 用於支援短訊息服務之裝置的命令 (SMS) 功能，這通常會在行動電話上公開。 |
| **WPD \_ 類別 \_ 仍為 \_ 影像 \_ 捕捉** | 用於支援仍為影像捕捉之裝置的命令。                                                                    |
| **WPD \_ 類別 \_ 儲存體**               | 用於儲存功能物件的命令。                                                                                  |



 

下表中會提供針對每個類型定義的特定命令，並依命令類型進行組織。

**WPD \_ 類別 \_ 一般分類**



| 命令                                                                                | 描述        |
|----------------------------------------------------------------------------------------|--------------------|
| [**WPD \_ 命令 \_ 一般 \_ 重設 \_ 裝置**](wpd-command-common-reset-device-command.md) | 重設裝置。 |



 

**WPD \_ 類別 \_ 裝置 \_ 提示分類**



| 命令                                                                                                              | 描述                                                                      |
|----------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------|
| [**WPD \_ 命令 \_ 裝置 \_ 提示 \_ 取得 \_ 內容 \_ 位置**](wpd-command-device-hints-get-content-location-command.md) | 抓取可保存指定類型物件之資料夾的物件識別碼。 |



 

**WPD \_ 類別 \_ 儲存體類別**



| 命令                                                                     | 描述                                                         |
|-----------------------------------------------------------------------------|---------------------------------------------------------------------|
| [**WPD \_ 命令 \_ 儲存體 \_ 退出**](wpd-command-storage-eject-command.md)   | 彈出可由驅動程式從遠端彈出的儲存媒體。 |
| [**WPD \_ 命令 \_ 單元 \_ 格式**](wpd-command-storage-format-command.md) | 將裝置上的儲存功能物件格式化。                  |



 

**WPD \_ 類別目錄 \_ SMS 類別目錄**



| 命令                                                         | 描述                                                          |
|-----------------------------------------------------------------|----------------------------------------------------------------------|
| [**WPD \_ 命令 \_ SMS \_ SEND**](wpd-command-sms-send-command.md) | 起始 sms 功能物件傳送 SMS 訊息。 |



 

**WPD \_ 類別 \_ 仍為 \_ 影像 \_ 捕獲類別**



| 命令                                                                                                   | 描述                                                         |
|-----------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------|
| [**WPD \_ 命令 \_ 仍為 \_ 映射 \_ 捕獲 \_ 起始**](wpd-command-still-image-capture-initiate-command.md) | 使用靜止影像功能物件起始靜止的影像捕捉。 |



 

## <a name="related-topics"></a>相關主題

<dl> <dt>

[**程式設計參考**](programming-reference.md)
</dt> </dl>

 

 



