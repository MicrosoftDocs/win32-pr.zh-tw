---
description: 註冊您的內容功能表處理常式
ms.assetid: 0023004b-b6b3-486a-8b8c-8e63c5731206
title: 註冊您的內容功能表處理常式
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: aafd2798683b4bc291653bca34996f143fc36842
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/08/2021
ms.locfileid: "106971479"
---
# <a name="registering-your-context-menu-handler"></a><span data-ttu-id="480f2-103">註冊您的內容功能表處理常式</span><span class="sxs-lookup"><span data-stu-id="480f2-103">Registering Your Context Menu Handler</span></span>

<span data-ttu-id="480f2-104">為了讓 WPD 命名空間能夠辨識您的內容功能表處理常式，您必須在 Windows 登錄中正確註冊。</span><span class="sxs-lookup"><span data-stu-id="480f2-104">In order for your context menu handler to be recognized by the WPD namespace you must register it properly in the Windows registry.</span></span> <span data-ttu-id="480f2-105">WPD 內容功能表處理常式的註冊專案類似于 shell 的註冊專案，但會將它們註冊為特殊檔案類型。</span><span class="sxs-lookup"><span data-stu-id="480f2-105">The registration entries for a WPD context menu handler are similar to those for the shell, but they are registered as special file types.</span></span> <span data-ttu-id="480f2-106">WPD 操作功能表處理常式會根據它們所代表的內容類型進行註冊。</span><span class="sxs-lookup"><span data-stu-id="480f2-106">WPD context menu handlers are registered according to the content type they represent.</span></span> <span data-ttu-id="480f2-107">以下是 WPD 內容功能表處理常式的範例註冊樹：</span><span class="sxs-lookup"><span data-stu-id="480f2-107">Below is a sample registration tree for a WPD context menu handler:</span></span>


```C++
HKEY_CLASSES_ROOT
 \-- WPDContextMenu.Image
      \-- shellex
           \-- ContextMenuHandlers
                \-- ShImageViewer (Default)  REG_SZ {E847DA7C-1D6A-45F6-B725-CB260C236066}

```



<span data-ttu-id="480f2-108">上述範例會向 WPD 命名空間註冊 shell 影像檢視器。</span><span class="sxs-lookup"><span data-stu-id="480f2-108">The above example registers the shell image viewer with the WPD namespace.</span></span> <span data-ttu-id="480f2-109">當使用者在裝置上按一下滑鼠右鍵或按兩下裝置上的內容時，它會叫用此操作功能表處理常式。</span><span class="sxs-lookup"><span data-stu-id="480f2-109">When a user right-clicks or double-clicks content on a device through the Windows Vista Shell, it invokes this context menu handler.</span></span> <span data-ttu-id="480f2-110">WPD 命名空間會使用 WPD \_ 內容 \_ 類型來決定要載入哪些內容功能表處理常式。</span><span class="sxs-lookup"><span data-stu-id="480f2-110">The WPD namespace uses WPD\_CONTENT\_TYPE to determine which context menu handlers to load.</span></span> <span data-ttu-id="480f2-111">如果 WPD \_ 內容 \_ 類型等於 WPD \_ 內容類型 [ \_ \_ 未指定]、 \_ [WPD 內容類型]、 \_ [一般檔案] \_ \_ 或 \_ [WPD 內容類型] \_ \_ 程式，則 WPD 命名空間會根據所選檔案的副檔名，嘗試尋找最佳的相符專案。</span><span class="sxs-lookup"><span data-stu-id="480f2-111">If WPD\_CONTENT\_TYPE is equal to WPD\_CONTENT\_TYPE\_UNSPECIFIED, WPD\_CONTENT\_TYPE\_GENERIC\_FILE or WPD\_CONTENT\_TYPE\_PROGRAM, then the WPD namespace will try to find the best match based on the extension of the selected file.</span></span> <span data-ttu-id="480f2-112">如果副檔名或內容類型都沒有提供實用的分類，WPD 命名空間會在 **WPDCoNtextMenu. 泛型** 登錄機碼下載入內容功能表處理常式。</span><span class="sxs-lookup"><span data-stu-id="480f2-112">If neither the file extension nor the content type provides a useful classification, the WPD namespace will load the context menu handlers under the **WPDContextMenu.Generic** registry key.</span></span> <span data-ttu-id="480f2-113">下表列出可供內容功能表處理常式使用的所有檔案類別，以及它們所代表的內容類型和副檔名：</span><span class="sxs-lookup"><span data-stu-id="480f2-113">The following table lists all of the file classes available to a context menu handler and what content types and file extensions they represent:</span></span>



| <span data-ttu-id="480f2-114">登錄金鑰</span><span class="sxs-lookup"><span data-stu-id="480f2-114">Registry Key</span></span>                           | <span data-ttu-id="480f2-115">WPD 內容類型</span><span class="sxs-lookup"><span data-stu-id="480f2-115">WPD Content Type</span></span>                                                                                               | <span data-ttu-id="480f2-116">副檔名</span><span class="sxs-lookup"><span data-stu-id="480f2-116">File Extension</span></span>                                                                                           |
|----------------------------------------|----------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="480f2-117">**WPDCoNtextMenu 裝置**</span><span class="sxs-lookup"><span data-stu-id="480f2-117">**WPDContextMenu.Device**</span></span>              | <span data-ttu-id="480f2-118">在此機碼下註冊可在裝置層級啟用您的內容功能表處理常式。</span><span class="sxs-lookup"><span data-stu-id="480f2-118">Registering under this key enables your context menu handler at the device level.</span></span> <span data-ttu-id="480f2-119"> (在裝置上按一下滑鼠右鍵。 ) </span><span class="sxs-lookup"><span data-stu-id="480f2-119">(Right-click on a device.)</span></span>   | <span data-ttu-id="480f2-120">(N/A)</span><span class="sxs-lookup"><span data-stu-id="480f2-120">(N/A)</span></span>                                                                                                    |
| <span data-ttu-id="480f2-121">**WPDCoNtextMenu**</span><span class="sxs-lookup"><span data-stu-id="480f2-121">**WPDContextMenu.Storage**</span></span>             | <span data-ttu-id="480f2-122">在此機碼下註冊可在儲存層級啟用您的內容功能表處理常式。</span><span class="sxs-lookup"><span data-stu-id="480f2-122">Registering under this key enables your context menu handler at the storage level.</span></span> <span data-ttu-id="480f2-123"> (以滑鼠右鍵按一下儲存體。 ) </span><span class="sxs-lookup"><span data-stu-id="480f2-123">(Right-click on a storage.)</span></span> | <span data-ttu-id="480f2-124">(N/A)</span><span class="sxs-lookup"><span data-stu-id="480f2-124">(N/A)</span></span>                                                                                                    |
| <span data-ttu-id="480f2-125">**WPDCoNtextMenu 資料夾**</span><span class="sxs-lookup"><span data-stu-id="480f2-125">**WPDContextMenu.Folder**</span></span>              | <span data-ttu-id="480f2-126">WPD \_ 內容 \_ 類型 \_ 資料夾</span><span class="sxs-lookup"><span data-stu-id="480f2-126">WPD\_CONTENT\_TYPE\_FOLDER</span></span>                                                                                     | <span data-ttu-id="480f2-127">(N/A)</span><span class="sxs-lookup"><span data-stu-id="480f2-127">(N/A)</span></span>                                                                                                    |
| <span data-ttu-id="480f2-128">**WPDCoNtextMenu 影像**</span><span class="sxs-lookup"><span data-stu-id="480f2-128">**WPDContextMenu.Image**</span></span>               | <span data-ttu-id="480f2-129">WPD \_ 內容 \_ 類型 \_ 影像</span><span class="sxs-lookup"><span data-stu-id="480f2-129">WPD\_CONTENT\_TYPE\_IMAGE</span></span>                                                                                      | <span data-ttu-id="480f2-130">.bmp</span><span class="sxs-lookup"><span data-stu-id="480f2-130">.bmp</span></span> <br/> <span data-ttu-id="480f2-131">.gif</span><span class="sxs-lookup"><span data-stu-id="480f2-131">.gif</span></span> <br/> <span data-ttu-id="480f2-132">.png</span><span class="sxs-lookup"><span data-stu-id="480f2-132">.png</span></span> <br/> <span data-ttu-id="480f2-133">.jpg</span><span class="sxs-lookup"><span data-stu-id="480f2-133">.jpg</span></span> <br/> <span data-ttu-id="480f2-134">.jpe</span><span class="sxs-lookup"><span data-stu-id="480f2-134">.jpe</span></span> <br/> <span data-ttu-id="480f2-135">.jpeg</span><span class="sxs-lookup"><span data-stu-id="480f2-135">.jpeg</span></span> <br/>   |
| <span data-ttu-id="480f2-136">**WPDCoNtextMenu 音訊**</span><span class="sxs-lookup"><span data-stu-id="480f2-136">**WPDContextMenu.Audio**</span></span>               | <span data-ttu-id="480f2-137">WPD \_ 內容 \_ 類型 \_ 音訊</span><span class="sxs-lookup"><span data-stu-id="480f2-137">WPD\_CONTENT\_TYPE\_AUDIO</span></span>                                                                                      | <span data-ttu-id="480f2-138">.aiff</span><span class="sxs-lookup"><span data-stu-id="480f2-138">.aiff</span></span> <br/> <span data-ttu-id="480f2-139">.mp3</span><span class="sxs-lookup"><span data-stu-id="480f2-139">.mp3</span></span> <br/> <span data-ttu-id="480f2-140">.wav</span><span class="sxs-lookup"><span data-stu-id="480f2-140">.wav</span></span> <br/> <span data-ttu-id="480f2-141">.wma</span><span class="sxs-lookup"><span data-stu-id="480f2-141">.wma</span></span> <br/>                                     |
| <span data-ttu-id="480f2-142">**WPDCoNtextMenu 影片**</span><span class="sxs-lookup"><span data-stu-id="480f2-142">**WPDContextMenu.Video**</span></span>               | <span data-ttu-id="480f2-143">WPD \_ 內容 \_ 類型 \_ 影片</span><span class="sxs-lookup"><span data-stu-id="480f2-143">WPD\_CONTENT\_TYPE\_VIDEO</span></span>                                                                                      | <span data-ttu-id="480f2-144">.asf</span><span class="sxs-lookup"><span data-stu-id="480f2-144">.asf</span></span><br/> <span data-ttu-id="480f2-145">.avi</span><span class="sxs-lookup"><span data-stu-id="480f2-145">.avi</span></span> <br/> <span data-ttu-id="480f2-146">.dvr-ms</span><span class="sxs-lookup"><span data-stu-id="480f2-146">.dvr-ms</span></span> <br/> <span data-ttu-id="480f2-147">.mpeg</span><span class="sxs-lookup"><span data-stu-id="480f2-147">.mpeg</span></span> <br/> <span data-ttu-id="480f2-148">.mpg</span><span class="sxs-lookup"><span data-stu-id="480f2-148">.mpg</span></span> <br/> <span data-ttu-id="480f2-149">.wmv</span><span class="sxs-lookup"><span data-stu-id="480f2-149">.wmv</span></span> <br/> |
| <span data-ttu-id="480f2-150">**WPDCoNtextMenu 播放清單**</span><span class="sxs-lookup"><span data-stu-id="480f2-150">**WPDContextMenu.Playlist**</span></span><br/> | <span data-ttu-id="480f2-151">WPD \_ 內容 \_ 類型 \_ 播放清單</span><span class="sxs-lookup"><span data-stu-id="480f2-151">WPD\_CONTENT\_TYPE\_PLAYLIST</span></span>                                                                                   | <span data-ttu-id="480f2-152">. .wpl</span><span class="sxs-lookup"><span data-stu-id="480f2-152">.wpl</span></span> <br/> <span data-ttu-id="480f2-153">.m3u</span><span class="sxs-lookup"><span data-stu-id="480f2-153">.m3u</span></span> <br/> <span data-ttu-id="480f2-154">.mpl</span><span class="sxs-lookup"><span data-stu-id="480f2-154">.mpl</span></span> <br/> <span data-ttu-id="480f2-155">.asx</span><span class="sxs-lookup"><span data-stu-id="480f2-155">.asx</span></span> <br/> <span data-ttu-id="480f2-156">. 另外</span><span class="sxs-lookup"><span data-stu-id="480f2-156">.pls</span></span> <br/>                     |
| <span data-ttu-id="480f2-157">**WPDContextMenu.Doc>ument**</span><span class="sxs-lookup"><span data-stu-id="480f2-157">**WPDContextMenu.Document**</span></span>            | <span data-ttu-id="480f2-158">WPD \_ 內容 \_ 類型 \_ 檔</span><span class="sxs-lookup"><span data-stu-id="480f2-158">WPD\_CONTENT\_TYPE\_DOCUMENT</span></span>                                                                                   | <span data-ttu-id="480f2-159">.doc</span><span class="sxs-lookup"><span data-stu-id="480f2-159">.doc</span></span> <br/> <span data-ttu-id="480f2-160">.txt</span><span class="sxs-lookup"><span data-stu-id="480f2-160">.txt</span></span> <br/> <span data-ttu-id="480f2-161">.rtf</span><span class="sxs-lookup"><span data-stu-id="480f2-161">.rtf</span></span> <br/> <span data-ttu-id="480f2-162">.xls</span><span class="sxs-lookup"><span data-stu-id="480f2-162">.xls</span></span> <br/> <span data-ttu-id="480f2-163">.ppt</span><span class="sxs-lookup"><span data-stu-id="480f2-163">.ppt</span></span> <br/>                     |
| <span data-ttu-id="480f2-164">**WPDCoNtextMenu。連絡人**</span><span class="sxs-lookup"><span data-stu-id="480f2-164">**WPDContextMenu.Contact**</span></span><br/>  | <span data-ttu-id="480f2-165">WPD \_ 內容 \_ 類型 \_ 連絡人</span><span class="sxs-lookup"><span data-stu-id="480f2-165">WPD\_CONTENT\_TYPE\_CONTACT</span></span>                                                                                    | <span data-ttu-id="480f2-166">無</span><span class="sxs-lookup"><span data-stu-id="480f2-166">None</span></span>                                                                                                     |
| <span data-ttu-id="480f2-167">**WPDCoNtextMenu.Email**</span><span class="sxs-lookup"><span data-stu-id="480f2-167">**WPDContextMenu.Email**</span></span>               | <span data-ttu-id="480f2-168">WPD \_ 內容 \_ 類型 \_ 電子郵件</span><span class="sxs-lookup"><span data-stu-id="480f2-168">WPD\_CONTENT\_TYPE\_EMAIL</span></span>                                                                                      | <span data-ttu-id="480f2-169">無</span><span class="sxs-lookup"><span data-stu-id="480f2-169">None</span></span>                                                                                                     |
| <span data-ttu-id="480f2-170">**WPDCoNtextMenu 約會**</span><span class="sxs-lookup"><span data-stu-id="480f2-170">**WPDContextMenu.Appointment**</span></span>         | <span data-ttu-id="480f2-171">WPD \_ 內容 \_ 類型 \_ 約會</span><span class="sxs-lookup"><span data-stu-id="480f2-171">WPD\_CONTENT\_TYPE\_APPOINTMENT</span></span>                                                                                | <span data-ttu-id="480f2-172">無</span><span class="sxs-lookup"><span data-stu-id="480f2-172">None</span></span>                                                                                                     |
| <span data-ttu-id="480f2-173">**WPDCoNtextMenu。工作**</span><span class="sxs-lookup"><span data-stu-id="480f2-173">**WPDContextMenu.Task**</span></span>                | <span data-ttu-id="480f2-174">WPD \_ 內容 \_ 類型 \_ 工作</span><span class="sxs-lookup"><span data-stu-id="480f2-174">WPD\_CONTENT\_TYPE\_TASK</span></span>                                                                                       | <span data-ttu-id="480f2-175">無</span><span class="sxs-lookup"><span data-stu-id="480f2-175">None</span></span>                                                                                                     |
| <span data-ttu-id="480f2-176">**WPDCoNtextMenu**</span><span class="sxs-lookup"><span data-stu-id="480f2-176">**WPDContextMenu.Memo**</span></span>                | <span data-ttu-id="480f2-177">WPD \_ 內容 \_ 類型 \_ 備忘錄</span><span class="sxs-lookup"><span data-stu-id="480f2-177">WPD\_CONTENT\_TYPE\_MEMO</span></span>                                                                                       | <span data-ttu-id="480f2-178">無</span><span class="sxs-lookup"><span data-stu-id="480f2-178">None</span></span>                                                                                                     |
| <span data-ttu-id="480f2-179">**WPDCoNtextMenu.ImageAlbum**</span><span class="sxs-lookup"><span data-stu-id="480f2-179">**WPDContextMenu.ImageAlbum**</span></span>          | <span data-ttu-id="480f2-180">WPD \_ 內容 \_ 類型 \_ 影像 \_ 專輯</span><span class="sxs-lookup"><span data-stu-id="480f2-180">WPD\_CONTENT\_TYPE\_IMAGE\_ALBUM</span></span>                                                                               | <span data-ttu-id="480f2-181">無</span><span class="sxs-lookup"><span data-stu-id="480f2-181">None</span></span>                                                                                                     |
| <span data-ttu-id="480f2-182">**WPDCoNtextMenu.AudioAlbum**</span><span class="sxs-lookup"><span data-stu-id="480f2-182">**WPDContextMenu.AudioAlbum**</span></span>          | <span data-ttu-id="480f2-183">WPD \_ 內容 \_ 類型 \_ 音訊 \_ 專輯</span><span class="sxs-lookup"><span data-stu-id="480f2-183">WPD\_CONTENT\_TYPE\_AUDIO\_ALBUM</span></span>                                                                               | <span data-ttu-id="480f2-184">無</span><span class="sxs-lookup"><span data-stu-id="480f2-184">None</span></span>                                                                                                     |
| <span data-ttu-id="480f2-185">**WPDCoNtextMenu.VideoAlbum**</span><span class="sxs-lookup"><span data-stu-id="480f2-185">**WPDContextMenu.VideoAlbum**</span></span>          | <span data-ttu-id="480f2-186">WPD \_ 內容 \_ 類型 \_ 影片 \_ 專輯</span><span class="sxs-lookup"><span data-stu-id="480f2-186">WPD\_CONTENT\_TYPE\_VIDEO\_ALBUM</span></span>                                                                               | <span data-ttu-id="480f2-187">無</span><span class="sxs-lookup"><span data-stu-id="480f2-187">None</span></span>                                                                                                     |
| <span data-ttu-id="480f2-188">**WPDCoNtextMenu.MixedAlbum**</span><span class="sxs-lookup"><span data-stu-id="480f2-188">**WPDContextMenu.MixedAlbum**</span></span>          | <span data-ttu-id="480f2-189">WPD \_ 內容 \_ 類型 \_ 混合式 \_ 內容 \_ 專輯</span><span class="sxs-lookup"><span data-stu-id="480f2-189">WPD\_CONTENT\_TYPE\_MIXED\_CONTENT\_ALBUM</span></span>                                                                      | <span data-ttu-id="480f2-190">無</span><span class="sxs-lookup"><span data-stu-id="480f2-190">None</span></span>                                                                                                     |
| <span data-ttu-id="480f2-191">**WPDCoNtextMenu 泛型**</span><span class="sxs-lookup"><span data-stu-id="480f2-191">**WPDContextMenu.Generic**</span></span>             | <span data-ttu-id="480f2-192">\_ \_ 未指定 WPD 內容類型 \_</span><span class="sxs-lookup"><span data-stu-id="480f2-192">WPD\_CONTENT\_TYPE\_UNSPECIFIED</span></span>                                                                                | <span data-ttu-id="480f2-193">所有其他副檔名</span><span class="sxs-lookup"><span data-stu-id="480f2-193">All other file extensions</span></span>                                                                                |



 

 

 




