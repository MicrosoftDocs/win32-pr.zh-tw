---
description: 當系統在內部使用以 UTC 為基礎的時間時，您的應用程式通常會顯示當地時間，也就是時區的日期和時間。
ms.assetid: a6570ec5-ac77-427a-86d9-32cbecc62e37
title: 當地時間
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c60eb9ca53245a12eba1bc0096b522eae97de75a
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/07/2021
ms.locfileid: "103848229"
---
# <a name="local-time"></a><span data-ttu-id="2159b-103">當地時間</span><span class="sxs-lookup"><span data-stu-id="2159b-103">Local Time</span></span>

<span data-ttu-id="2159b-104">當系統在內部使用以 UTC 為基礎的時間時，您的應用程式通常會顯示 **當地時間**，也就是時區的日期和時間。</span><span class="sxs-lookup"><span data-stu-id="2159b-104">While the system uses UTC-based time internally, your applications will generally display the **local time**, which is the date and time of day for your time zone.</span></span> <span data-ttu-id="2159b-105">因此，若要確保正確的結果，您必須知道函式是否預期接收 UTC 時間或本地時間，以及函式是否傳回以 UTC 為基礎的時間或本地時間。</span><span class="sxs-lookup"><span data-stu-id="2159b-105">Therefore, to ensure correct results, you must be aware of whether a function expects to receive a UTC-based time or a local time, and whether the function returns a UTC-based time or a local time.</span></span>

<span data-ttu-id="2159b-106">目前的時區設定會控制系統在 UTC 和本地時間之間的轉換方式。</span><span class="sxs-lookup"><span data-stu-id="2159b-106">The current time-zone settings control how the system converts between UTC and local time.</span></span> <span data-ttu-id="2159b-107">您可以使用 [**GetTimeZoneInformation**](/windows/win32/api/timezoneapi/nf-timezoneapi-gettimezoneinformation) 函式來取出目前的時區設定。</span><span class="sxs-lookup"><span data-stu-id="2159b-107">You can retrieve the current time-zone settings by using the [**GetTimeZoneInformation**](/windows/win32/api/timezoneapi/nf-timezoneapi-gettimezoneinformation) function.</span></span> <span data-ttu-id="2159b-108">函式會將結果複製到 [**時區 \_ \_ 資訊**](/windows/win32/api/timezoneapi/ns-timezoneapi-time_zone_information) 結構，並傳回值，指出當地時間目前是否為標準時間或日光節約時間 (DST) 。</span><span class="sxs-lookup"><span data-stu-id="2159b-108">The function copies the result to a [**TIME\_ZONE\_INFORMATION**](/windows/win32/api/timezoneapi/ns-timezoneapi-time_zone_information) structure and returns a value indicating whether local time is currently in standard time or daylight saving time (DST).</span></span> <span data-ttu-id="2159b-109">您可以使用 [**SetTimeZoneInformation**](/windows/win32/api/timezoneapi/nf-timezoneapi-settimezoneinformation) 函數來設定時區設定。</span><span class="sxs-lookup"><span data-stu-id="2159b-109">You can set the time-zone settings by using the [**SetTimeZoneInformation**](/windows/win32/api/timezoneapi/nf-timezoneapi-settimezoneinformation) function.</span></span> <span data-ttu-id="2159b-110">若要支援從 year 變更為 year 的日光節約時間範圍，請使用 [**GetTimeZoneInformationForYear**](/windows/win32/api/timezoneapi/nf-timezoneapi-gettimezoneinformationforyear)、 [**GetDynamicTimeZoneInformation**](/windows/win32/api/timezoneapi/nf-timezoneapi-getdynamictimezoneinformation) 和 [**SetDynamicTimeZoneInformation**](/windows/win32/api/timezoneapi/nf-timezoneapi-setdynamictimezoneinformation) 函數。</span><span class="sxs-lookup"><span data-stu-id="2159b-110">To support boundaries for daylight saving time that change from year to year, use the [**GetTimeZoneInformationForYear**](/windows/win32/api/timezoneapi/nf-timezoneapi-gettimezoneinformationforyear), [**GetDynamicTimeZoneInformation**](/windows/win32/api/timezoneapi/nf-timezoneapi-getdynamictimezoneinformation) and [**SetDynamicTimeZoneInformation**](/windows/win32/api/timezoneapi/nf-timezoneapi-setdynamictimezoneinformation) functions.</span></span>

<span data-ttu-id="2159b-111">若要取出本地時間，請使用 [**GetLocalTime**](/windows/win32/api/sysinfoapi/nf-sysinfoapi-getlocaltime) 函數。</span><span class="sxs-lookup"><span data-stu-id="2159b-111">To retrieve the local time, use the [**GetLocalTime**](/windows/win32/api/sysinfoapi/nf-sysinfoapi-getlocaltime) function.</span></span> <span data-ttu-id="2159b-112">**GetLocalTime** 會根據目前的時區設定，將系統時間轉換為當地時間，並將結果複製到 [**SYSTEMTIME**](/windows/win32/api/minwinbase/ns-minwinbase-systemtime) 結構。</span><span class="sxs-lookup"><span data-stu-id="2159b-112">**GetLocalTime** converts the system time to a local time based on the current time-zone settings and copies the result to a [**SYSTEMTIME**](/windows/win32/api/minwinbase/ns-minwinbase-systemtime) structure.</span></span> <span data-ttu-id="2159b-113">您可以使用 [**SetLocalTime**](/windows/win32/api/sysinfoapi/nf-sysinfoapi-setlocaltime) 函數來設定系統時間。</span><span class="sxs-lookup"><span data-stu-id="2159b-113">You can set the system time by using the [**SetLocalTime**](/windows/win32/api/sysinfoapi/nf-sysinfoapi-setlocaltime) function.</span></span> <span data-ttu-id="2159b-114">**SetLocalTime** 會假設您已指定本地時間，並會在設定系統時間之前轉換為 UTC。</span><span class="sxs-lookup"><span data-stu-id="2159b-114">**SetLocalTime** assumes you have specified a local time and converts to UTC before setting the system time.</span></span>

<span data-ttu-id="2159b-115">當您呼叫 [**SetLocalTime**](/windows/win32/api/sysinfoapi/nf-sysinfoapi-setlocaltime)時，系統會使用目前的時區資訊（包括日光節約時間設定）來執行轉換。</span><span class="sxs-lookup"><span data-stu-id="2159b-115">When you call [**SetLocalTime**](/windows/win32/api/sysinfoapi/nf-sysinfoapi-setlocaltime), the system uses the current time zone information, including the daylight saving time setting, to perform the conversion.</span></span> <span data-ttu-id="2159b-116">請注意，系統會使用目前時間的日光節約時間設定，而不是您所設定的新時間。</span><span class="sxs-lookup"><span data-stu-id="2159b-116">Note that the system uses the daylight saving time setting of the current time, not the new time you are setting.</span></span> <span data-ttu-id="2159b-117">因此，若要確保正確的結果，請呼叫 **SetLocalTime** 第二次，現在第一個呼叫已更新日光節約時間設定。</span><span class="sxs-lookup"><span data-stu-id="2159b-117">Therefore, to ensure the correct result, call **SetLocalTime** a second time, now that the first call has updated the daylight saving time setting.</span></span>

<span data-ttu-id="2159b-118">若要將 UTC 時間轉換為當地時間，請使用 [**SystemTimeToTzSpecificLocalTime**](/windows/win32/api/timezoneapi/nf-timezoneapi-systemtimetotzspecificlocaltime) 函數。</span><span class="sxs-lookup"><span data-stu-id="2159b-118">To convert a UTC-based time to a local time, use the [**SystemTimeToTzSpecificLocalTime**](/windows/win32/api/timezoneapi/nf-timezoneapi-systemtimetotzspecificlocaltime) function.</span></span> <span data-ttu-id="2159b-119">若要將當地時間轉換為 UTC 時間，請使用 [**TzSpecificLocalTimeToSystemTime**](/windows/win32/api/timezoneapi/nf-timezoneapi-tzspecificlocaltimetosystemtime) 函數。</span><span class="sxs-lookup"><span data-stu-id="2159b-119">To convert a local time to a UTC-based time, use the [**TzSpecificLocalTimeToSystemTime**](/windows/win32/api/timezoneapi/nf-timezoneapi-tzspecificlocaltimetosystemtime) function.</span></span>

 

 
