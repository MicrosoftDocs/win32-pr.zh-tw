---
description: GDI 物件只支援每個物件一個控制碼。 GDI 物件的控制碼對進程而言是私用的。 也就是說，只有建立 GDI 物件的進程可以使用物件控制碼。
ms.assetid: 699de25c-083d-4be3-a997-67418b7173e1
title: GDI 物件
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c0d57d4a1cfa99c392783dec23a090e7ccf09eb0
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/08/2021
ms.locfileid: "104027594"
---
# <a name="gdi-objects"></a><span data-ttu-id="8542f-105">GDI 物件</span><span class="sxs-lookup"><span data-stu-id="8542f-105">GDI Objects</span></span>

<span data-ttu-id="8542f-106">GDI 物件只支援每個物件一個控制碼。</span><span class="sxs-lookup"><span data-stu-id="8542f-106">GDI objects support only one handle per object.</span></span> <span data-ttu-id="8542f-107">GDI 物件的控制碼對進程而言是私用的。</span><span class="sxs-lookup"><span data-stu-id="8542f-107">Handles to GDI objects are private to a process.</span></span> <span data-ttu-id="8542f-108">也就是說，只有建立 GDI 物件的進程可以使用物件控制碼。</span><span class="sxs-lookup"><span data-stu-id="8542f-108">That is, only the process that created the GDI object can use the object handle.</span></span>

<span data-ttu-id="8542f-109">每個會話都有65536個 GDI 控制碼的理論限制。</span><span class="sxs-lookup"><span data-stu-id="8542f-109">There is a theoretical limit of 65,536 GDI handles per session.</span></span> <span data-ttu-id="8542f-110">不過，每個會話可以開啟的最大 GDI 控制碼數目通常較低，因為它會受到可用記憶體的影響。</span><span class="sxs-lookup"><span data-stu-id="8542f-110">However, the maximum number of GDI handles that can be opened per session is usually lower, since it is affected by available memory.</span></span>

<span data-ttu-id="8542f-111">**Windows 2000：** 每個會話有16384個 GDI 控制碼的限制。</span><span class="sxs-lookup"><span data-stu-id="8542f-111">**Windows 2000:** There is a limit of 16,384 GDI handles per session.</span></span>

<span data-ttu-id="8542f-112">另外還有 GDI 控制碼的預設每一進程限制。</span><span class="sxs-lookup"><span data-stu-id="8542f-112">There is also a default per-process limit of GDI handles.</span></span> <span data-ttu-id="8542f-113">若要變更此限制，請設定下列登錄值：</span><span class="sxs-lookup"><span data-stu-id="8542f-113">To change this limit, set the following registry value:</span></span>

<span data-ttu-id="8542f-114">**HKEY \_本機 \_ 電腦** \\ **軟體** \\ **Microsoft** \\ **Windows NT** \\ **CurrentVersion** \\ **Windows** \\ **GDIProcessHandleQuota**</span><span class="sxs-lookup"><span data-stu-id="8542f-114">**HKEY\_LOCAL\_MACHINE**\\**SOFTWARE**\\**Microsoft**\\**Windows NT**\\**CurrentVersion**\\**Windows**\\**GDIProcessHandleQuota**</span></span>

<span data-ttu-id="8542f-115">這個值可以設定為介於256到65536之間的數位。</span><span class="sxs-lookup"><span data-stu-id="8542f-115">This value can be set to a number between 256 and 65,536.</span></span>

<span data-ttu-id="8542f-116">**Windows 2000：** 這個值可以設定為介於256到16384之間的數位。</span><span class="sxs-lookup"><span data-stu-id="8542f-116">**Windows 2000:** This value can be set to a number between 256 and 16,384.</span></span>

## <a name="managing-gdi-objects"></a><span data-ttu-id="8542f-117">管理 GDI 物件</span><span class="sxs-lookup"><span data-stu-id="8542f-117">Managing GDI Objects</span></span>

<span data-ttu-id="8542f-118">下表列出 GDI 物件，以及每個物件的建立者和 destroyer 函數。</span><span class="sxs-lookup"><span data-stu-id="8542f-118">The following table lists the GDI objects, along with each object's creator and destroyer functions.</span></span> <span data-ttu-id="8542f-119">建立者函式會建立物件和物件控制碼，或只傳回現有的物件控制碼。</span><span class="sxs-lookup"><span data-stu-id="8542f-119">The creator functions either create the object and an object handle or simply return the existing object handle.</span></span> <span data-ttu-id="8542f-120">Destroyer 函式會從記憶體中移除物件，這樣會使物件控制碼失效。</span><span class="sxs-lookup"><span data-stu-id="8542f-120">The destroyer functions remove the object from memory, which invalidates the object handle.</span></span>



| <span data-ttu-id="8542f-121">GDI 物件</span><span class="sxs-lookup"><span data-stu-id="8542f-121">GDI object</span></span>           | <span data-ttu-id="8542f-122">Creator 函數</span><span class="sxs-lookup"><span data-stu-id="8542f-122">Creator function</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | <span data-ttu-id="8542f-123">Destroyer 函式</span><span class="sxs-lookup"><span data-stu-id="8542f-123">Destroyer function</span></span>                                           |
|----------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------|
| <span data-ttu-id="8542f-124">點陣圖</span><span class="sxs-lookup"><span data-stu-id="8542f-124">Bitmap</span></span>               | <span data-ttu-id="8542f-125">[**CreateBitmap**](/windows/desktop/api/wingdi/nf-wingdi-createbitmap)、 [**CreateBitmapIndirect**](/windows/desktop/api/wingdi/nf-wingdi-createbitmapindirect)、 [**CreateCompatibleBitmap**](/windows/desktop/api/wingdi/nf-wingdi-createcompatiblebitmap)、 [**CreateDIBitmap**](/windows/desktop/api/wingdi/nf-wingdi-createdibitmap)、 [**CreateDIBSection**](/windows/desktop/api/wingdi/nf-wingdi-createdibsection)、 [**CreateDiscardableBitmap**](/windows/desktop/api/wingdi/nf-wingdi-creatediscardablebitmap)</span><span class="sxs-lookup"><span data-stu-id="8542f-125">[**CreateBitmap**](/windows/desktop/api/wingdi/nf-wingdi-createbitmap), [**CreateBitmapIndirect**](/windows/desktop/api/wingdi/nf-wingdi-createbitmapindirect), [**CreateCompatibleBitmap**](/windows/desktop/api/wingdi/nf-wingdi-createcompatiblebitmap), [**CreateDIBitmap**](/windows/desktop/api/wingdi/nf-wingdi-createdibitmap), [**CreateDIBSection**](/windows/desktop/api/wingdi/nf-wingdi-createdibsection), [**CreateDiscardableBitmap**](/windows/desktop/api/wingdi/nf-wingdi-creatediscardablebitmap)</span></span>                                                                                                                                                                                 | [<span data-ttu-id="8542f-126">**DeleteObject**</span><span class="sxs-lookup"><span data-stu-id="8542f-126">**DeleteObject**</span></span>](/windows/desktop/api/wingdi/nf-wingdi-deleteobject)                         |
| <span data-ttu-id="8542f-127">筆刷</span><span class="sxs-lookup"><span data-stu-id="8542f-127">Brush</span></span>                | <span data-ttu-id="8542f-128">[**CreateBrushIndirect**](/windows/desktop/api/wingdi/nf-wingdi-createbrushindirect)、 [**CreateDIBPatternBrush**](/windows/desktop/api/wingdi/nf-wingdi-createdibpatternbrush)、 [**CreateDIBPatternBrushPt**](/windows/desktop/api/wingdi/nf-wingdi-createdibpatternbrushpt)、 [**CreateHatchBrush**](/windows/desktop/api/wingdi/nf-wingdi-createhatchbrush)、 [**CreatePatternBrush**](/windows/desktop/api/wingdi/nf-wingdi-createpatternbrush)、 [**CreateSolidBrush**](/windows/desktop/api/wingdi/nf-wingdi-createsolidbrush)</span><span class="sxs-lookup"><span data-stu-id="8542f-128">[**CreateBrushIndirect**](/windows/desktop/api/wingdi/nf-wingdi-createbrushindirect), [**CreateDIBPatternBrush**](/windows/desktop/api/wingdi/nf-wingdi-createdibpatternbrush), [**CreateDIBPatternBrushPt**](/windows/desktop/api/wingdi/nf-wingdi-createdibpatternbrushpt), [**CreateHatchBrush**](/windows/desktop/api/wingdi/nf-wingdi-createhatchbrush), [**CreatePatternBrush**](/windows/desktop/api/wingdi/nf-wingdi-createpatternbrush), [**CreateSolidBrush**](/windows/desktop/api/wingdi/nf-wingdi-createsolidbrush)</span></span>                                                                                                                                                                     | [<span data-ttu-id="8542f-129">**DeleteObject**</span><span class="sxs-lookup"><span data-stu-id="8542f-129">**DeleteObject**</span></span>](/windows/desktop/api/wingdi/nf-wingdi-deleteobject)                         |
| <span data-ttu-id="8542f-130">DC</span><span class="sxs-lookup"><span data-stu-id="8542f-130">DC</span></span>                   | [<span data-ttu-id="8542f-131">**CreateDC**</span><span class="sxs-lookup"><span data-stu-id="8542f-131">**CreateDC**</span></span>](/windows/desktop/api/wingdi/nf-wingdi-createdca)                                                                                                                                                                                                                                                                                                                                                                                                                                                             | <span data-ttu-id="8542f-132">[**DeleteDC**](/windows/desktop/api/wingdi/nf-wingdi-deletedc)、 [ **ReleaseDC**](/windows/desktop/api/winuser/nf-winuser-releasedc)</span><span class="sxs-lookup"><span data-stu-id="8542f-132">[**DeleteDC**](/windows/desktop/api/wingdi/nf-wingdi-deletedc), [**ReleaseDC**](/windows/desktop/api/winuser/nf-winuser-releasedc)</span></span> |
| <span data-ttu-id="8542f-133">增強的中繼檔</span><span class="sxs-lookup"><span data-stu-id="8542f-133">Enhanced metafile</span></span>    | [<span data-ttu-id="8542f-134">**CreateEnhMetaFile**</span><span class="sxs-lookup"><span data-stu-id="8542f-134">**CreateEnhMetaFile**</span></span>](/windows/desktop/api/wingdi/nf-wingdi-createenhmetafilea)                                                                                                                                                                                                                                                                                                                                                                                                                                           | [<span data-ttu-id="8542f-135">**DeleteEnhMetaFile**</span><span class="sxs-lookup"><span data-stu-id="8542f-135">**DeleteEnhMetaFile**</span></span>](/windows/desktop/api/wingdi/nf-wingdi-deleteenhmetafile)               |
| <span data-ttu-id="8542f-136">增強型中繼檔 DC</span><span class="sxs-lookup"><span data-stu-id="8542f-136">Enhanced-metafile DC</span></span> | [<span data-ttu-id="8542f-137">**CreateEnhMetaFile**</span><span class="sxs-lookup"><span data-stu-id="8542f-137">**CreateEnhMetaFile**</span></span>](/windows/desktop/api/wingdi/nf-wingdi-createenhmetafilea)                                                                                                                                                                                                                                                                                                                                                                                                                                           | [<span data-ttu-id="8542f-138">**CloseEnhMetaFile**</span><span class="sxs-lookup"><span data-stu-id="8542f-138">**CloseEnhMetaFile**</span></span>](/windows/desktop/api/wingdi/nf-wingdi-closeenhmetafile)                 |
| <span data-ttu-id="8542f-139">字型</span><span class="sxs-lookup"><span data-stu-id="8542f-139">Font</span></span>                 | <span data-ttu-id="8542f-140">[**CreateFont**](/windows/desktop/api/wingdi/nf-wingdi-createfonta)、 [ **CreateFontIndirect**](/windows/desktop/api/wingdi/nf-wingdi-createfontindirecta)</span><span class="sxs-lookup"><span data-stu-id="8542f-140">[**CreateFont**](/windows/desktop/api/wingdi/nf-wingdi-createfonta), [**CreateFontIndirect**](/windows/desktop/api/wingdi/nf-wingdi-createfontindirecta)</span></span>                                                                                                                                                                                                                                                                                                                                                                                                       | [<span data-ttu-id="8542f-141">**DeleteObject**</span><span class="sxs-lookup"><span data-stu-id="8542f-141">**DeleteObject**</span></span>](/windows/desktop/api/wingdi/nf-wingdi-deleteobject)                         |
| <span data-ttu-id="8542f-142">記憶體 DC</span><span class="sxs-lookup"><span data-stu-id="8542f-142">Memory DC</span></span>            | [<span data-ttu-id="8542f-143">**CreateCompatibleDC**</span><span class="sxs-lookup"><span data-stu-id="8542f-143">**CreateCompatibleDC**</span></span>](/windows/desktop/api/wingdi/nf-wingdi-createcompatibledc)                                                                                                                                                                                                                                                                                                                                                                                                                                         | [<span data-ttu-id="8542f-144">**DeleteDC**</span><span class="sxs-lookup"><span data-stu-id="8542f-144">**DeleteDC**</span></span>](/windows/desktop/api/wingdi/nf-wingdi-deletedc)                                 |
| <span data-ttu-id="8542f-145"> 中繼檔</span><span class="sxs-lookup"><span data-stu-id="8542f-145">Metafile</span></span>             | [<span data-ttu-id="8542f-146">**CreateMetaFile**</span><span class="sxs-lookup"><span data-stu-id="8542f-146">**CreateMetaFile**</span></span>](/windows/desktop/api/wingdi/nf-wingdi-createmetafilea)                                                                                                                                                                                                                                                                                                                                                                                                                                                 | [<span data-ttu-id="8542f-147">**DeleteMetaFile**</span><span class="sxs-lookup"><span data-stu-id="8542f-147">**DeleteMetaFile**</span></span>](/windows/desktop/api/wingdi/nf-wingdi-deletemetafile)                     |
| <span data-ttu-id="8542f-148">中繼檔 DC</span><span class="sxs-lookup"><span data-stu-id="8542f-148">Metafile DC</span></span>          | [<span data-ttu-id="8542f-149">**CreateMetaFile**</span><span class="sxs-lookup"><span data-stu-id="8542f-149">**CreateMetaFile**</span></span>](/windows/desktop/api/wingdi/nf-wingdi-createmetafilea)                                                                                                                                                                                                                                                                                                                                                                                                                                                 | [<span data-ttu-id="8542f-150">**CloseMetaFile**</span><span class="sxs-lookup"><span data-stu-id="8542f-150">**CloseMetaFile**</span></span>](/windows/desktop/api/wingdi/nf-wingdi-closemetafile)                       |
| <span data-ttu-id="8542f-151">調色盤</span><span class="sxs-lookup"><span data-stu-id="8542f-151">Palette</span></span>              | [<span data-ttu-id="8542f-152">**CreatePalette**</span><span class="sxs-lookup"><span data-stu-id="8542f-152">**CreatePalette**</span></span>](/windows/desktop/api/wingdi/nf-wingdi-createpalette)                                                                                                                                                                                                                                                                                                                                                                                                                                                   | [<span data-ttu-id="8542f-153">**DeleteObject**</span><span class="sxs-lookup"><span data-stu-id="8542f-153">**DeleteObject**</span></span>](/windows/desktop/api/wingdi/nf-wingdi-deleteobject)                         |
| <span data-ttu-id="8542f-154">畫筆和延伸畫筆</span><span class="sxs-lookup"><span data-stu-id="8542f-154">Pen and extended pen</span></span> | <span data-ttu-id="8542f-155">[**CreatePen**](/windows/desktop/api/wingdi/nf-wingdi-createpen)、 [**CreatePenIndirect**](/windows/desktop/api/wingdi/nf-wingdi-createpenindirect)、 [**ExtCreatePen**](/windows/desktop/api/wingdi/nf-wingdi-extcreatepen)</span><span class="sxs-lookup"><span data-stu-id="8542f-155">[**CreatePen**](/windows/desktop/api/wingdi/nf-wingdi-createpen), [**CreatePenIndirect**](/windows/desktop/api/wingdi/nf-wingdi-createpenindirect), [**ExtCreatePen**](/windows/desktop/api/wingdi/nf-wingdi-extcreatepen)</span></span>                                                                                                                                                                                                                                                                                                                                                                     | [<span data-ttu-id="8542f-156">**DeleteObject**</span><span class="sxs-lookup"><span data-stu-id="8542f-156">**DeleteObject**</span></span>](/windows/desktop/api/wingdi/nf-wingdi-deleteobject)                         |
| <span data-ttu-id="8542f-157">區域</span><span class="sxs-lookup"><span data-stu-id="8542f-157">Region</span></span>               | <span data-ttu-id="8542f-158">[**CombineRgn**](/windows/desktop/api/wingdi/nf-wingdi-combinergn)、 [**CreateEllipticRgn**](/windows/desktop/api/wingdi/nf-wingdi-createellipticrgn)、 [**CreateEllipticRgnIndirect**](/windows/desktop/api/wingdi/nf-wingdi-createellipticrgnindirect)、 [**CreatePolygonRgn**](/windows/desktop/api/wingdi/nf-wingdi-createpolygonrgn)、 [**CreatePolyPolygonRgn**](/windows/desktop/api/wingdi/nf-wingdi-createpolypolygonrgn)、 [**CreateRectRgn**](/windows/desktop/api/wingdi/nf-wingdi-createrectrgn)、 [**CreateRectRgnIndirect**](/windows/desktop/api/wingdi/nf-wingdi-createrectrgnindirect)、 [**CreateRoundRectRgn**](/windows/desktop/api/wingdi/nf-wingdi-createroundrectrgn)、 [**ExtCreateRegion**](/windows/desktop/api/wingdi/nf-wingdi-extcreateregion)、 [**PathToRegion**](/windows/desktop/api/wingdi/nf-wingdi-pathtoregion)</span><span class="sxs-lookup"><span data-stu-id="8542f-158">[**CombineRgn**](/windows/desktop/api/wingdi/nf-wingdi-combinergn), [**CreateEllipticRgn**](/windows/desktop/api/wingdi/nf-wingdi-createellipticrgn), [**CreateEllipticRgnIndirect**](/windows/desktop/api/wingdi/nf-wingdi-createellipticrgnindirect), [**CreatePolygonRgn**](/windows/desktop/api/wingdi/nf-wingdi-createpolygonrgn), [**CreatePolyPolygonRgn**](/windows/desktop/api/wingdi/nf-wingdi-createpolypolygonrgn), [**CreateRectRgn**](/windows/desktop/api/wingdi/nf-wingdi-createrectrgn), [**CreateRectRgnIndirect**](/windows/desktop/api/wingdi/nf-wingdi-createrectrgnindirect), [**CreateRoundRectRgn**](/windows/desktop/api/wingdi/nf-wingdi-createroundrectrgn), [**ExtCreateRegion**](/windows/desktop/api/wingdi/nf-wingdi-extcreateregion), [**PathToRegion**](/windows/desktop/api/wingdi/nf-wingdi-pathtoregion)</span></span> | [<span data-ttu-id="8542f-159">**DeleteObject**</span><span class="sxs-lookup"><span data-stu-id="8542f-159">**DeleteObject**</span></span>](/windows/desktop/api/wingdi/nf-wingdi-deleteobject)                         |



 

 

 
