---
description: HKEY \_ 類別 \_ ROOT (HKCR) 機碼包含副檔名關聯和 COM 類別註冊資訊，例如 Progid、Clsid 和 iid。 它主要是為了與16位 Windows 中的登錄相容。
ms.assetid: b404875f-11e1-48f2-98d2-0378a0646ed3
title: HKEY_CLASSES_ROOT 金鑰
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 1e7aebe0e59424eb5ff7584fe61c2c5089eb887b
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/08/2021
ms.locfileid: "103852048"
---
# <a name="hkey_classes_root-key"></a><span data-ttu-id="41f99-104">HKEY \_ 類別 \_ 根金鑰</span><span class="sxs-lookup"><span data-stu-id="41f99-104">HKEY\_CLASSES\_ROOT Key</span></span>

<span data-ttu-id="41f99-105">**HKEY \_ 類別 \_ ROOT** (**HKCR**) 機碼包含副檔名關聯和 COM 類別註冊資訊，例如 [progid](../com/-progid--key.md)、 [clsid](../com/clsid-key-hklm.md)和 [iid](../com/interface-key.md)。</span><span class="sxs-lookup"><span data-stu-id="41f99-105">The **HKEY\_CLASSES\_ROOT** (**HKCR**) key contains file name extension associations and COM class registration information such as [ProgIDs](../com/-progid--key.md), [CLSIDs](../com/clsid-key-hklm.md), and [IIDs](../com/interface-key.md).</span></span> <span data-ttu-id="41f99-106">它主要是為了與16位 Windows 中的登錄相容。</span><span class="sxs-lookup"><span data-stu-id="41f99-106">It is primarily intended for compatibility with the registry in 16-bit Windows.</span></span>

<span data-ttu-id="41f99-107">類別註冊和副檔名資訊都會儲存在 **HKEY \_ 本機 \_ 電腦** 和 **HKEY \_ 目前的 \_ 使用者** 金鑰之下。</span><span class="sxs-lookup"><span data-stu-id="41f99-107">Class registration and file name extension information is stored under both the **HKEY\_LOCAL\_MACHINE** and **HKEY\_CURRENT\_USER** keys.</span></span> <span data-ttu-id="41f99-108">**HKEY \_ 本機電腦 \_ \\ 軟體 \\ 類別** 機碼包含可套用至本機電腦上所有使用者的預設設定。</span><span class="sxs-lookup"><span data-stu-id="41f99-108">The **HKEY\_LOCAL\_MACHINE\\Software\\Classes** key contains default settings that can apply to all users on the local computer.</span></span> <span data-ttu-id="41f99-109">**HKEY \_ CURRENT \_ user \\ Software \\** class 機碼包含僅適用于互動式使用者的設定。</span><span class="sxs-lookup"><span data-stu-id="41f99-109">The **HKEY\_CURRENT\_USER\\Software\\Classes** key contains settings that apply only to the interactive user.</span></span> <span data-ttu-id="41f99-110">**HKEY \_ 類別 \_ 根金鑰** 會提供登錄的視圖，以合併這兩個來源的資訊。</span><span class="sxs-lookup"><span data-stu-id="41f99-110">The **HKEY\_CLASSES\_ROOT** key provides a view of the registry that merges the information from these two sources.</span></span> <span data-ttu-id="41f99-111">**HKEY \_類別 \_ 根目錄** 也會針對針對舊版 Windows 設計的應用程式，提供此合併的觀點。</span><span class="sxs-lookup"><span data-stu-id="41f99-111">**HKEY\_CLASSES\_ROOT** also provides this merged view for applications designed for previous versions of Windows.</span></span>

<span data-ttu-id="41f99-112">使用者特定設定的優先順序高於預設設定。</span><span class="sxs-lookup"><span data-stu-id="41f99-112">The user-specific settings have priority over the default settings.</span></span> <span data-ttu-id="41f99-113">例如，預設設定可能會指定特定的應用程式來處理 .doc 檔。</span><span class="sxs-lookup"><span data-stu-id="41f99-113">For example, the default setting might specify a particular application to handle .doc files.</span></span> <span data-ttu-id="41f99-114">但是，使用者可以藉由在登錄中指定不同的應用程式來覆寫此設定。</span><span class="sxs-lookup"><span data-stu-id="41f99-114">But a user can override this setting by specifying a different application in the registry.</span></span>

<span data-ttu-id="41f99-115">諸如 [**RegOpenKeyEx**](/windows/desktop/api/Winreg/nf-winreg-regopenkeyexa) 或 [**RegQueryValueEx**](/windows/desktop/api/Winreg/nf-winreg-regqueryvalueexa) 等登錄功能，可讓您指定 **HKEY \_ 類別 \_ 根金鑰** 。</span><span class="sxs-lookup"><span data-stu-id="41f99-115">Registry functions such as [**RegOpenKeyEx**](/windows/desktop/api/Winreg/nf-winreg-regopenkeyexa) or [**RegQueryValueEx**](/windows/desktop/api/Winreg/nf-winreg-regqueryvalueexa) allow you to specify the **HKEY\_CLASSES\_ROOT** key.</span></span> <span data-ttu-id="41f99-116">當您從在互動式使用者帳戶中執行的進程呼叫這些函式時，系統會將 **HKEY \_ 本機 \_ 電腦 \\ 軟體 \\ 類別** 中的預設設定與 **HKEY \_ 目前 \_ 使用者 \\ 軟體 \\ 類別** 的互動式使用者設定合併。</span><span class="sxs-lookup"><span data-stu-id="41f99-116">When you call these functions from a process running in the interactive user account, the system merges the default settings in **HKEY\_LOCAL\_MACHINE\\Software\\Classes** with the interactive user's settings at **HKEY\_CURRENT\_USER\\Software\\Classes**.</span></span> <span data-ttu-id="41f99-117">如需有關如何合併這些設定的詳細資訊，請參閱 [HKEY \_ 類別 \_ 根目錄的合併觀點](merged-view-of-hkey-classes-root.md)。</span><span class="sxs-lookup"><span data-stu-id="41f99-117">For more information on how these settings are merged, see [Merged View of HKEY\_CLASSES\_ROOT](merged-view-of-hkey-classes-root.md).</span></span>

<span data-ttu-id="41f99-118">若要變更互動式使用者的設定，請將變更儲存在 **HKEY \_ CURRENT \_ user \\ Software \\ 類別** 下，而不是 **HKEY \_ 類別 \_ ROOT**。</span><span class="sxs-lookup"><span data-stu-id="41f99-118">To change the settings for the interactive user, store the changes under **HKEY\_CURRENT\_USER\\Software\\Classes** rather than **HKEY\_CLASSES\_ROOT**.</span></span>

<span data-ttu-id="41f99-119">若要變更預設設定，請在 [ **HKEY \_ 本機 \_ 電腦 \\ 軟體 \\ 類別**] 下儲存變更。</span><span class="sxs-lookup"><span data-stu-id="41f99-119">To change the default settings, store the changes under **HKEY\_LOCAL\_MACHINE\\Software\\Classes**.</span></span> <span data-ttu-id="41f99-120">如果您將金鑰寫入 **HKEY \_ 類別 \_ 根目錄** 下的金鑰，系統會將資訊儲存在 [ **HKEY \_ 本機 \_ 電腦 \\ 軟體 \\ 類別**] 下。</span><span class="sxs-lookup"><span data-stu-id="41f99-120">If you write keys to a key under **HKEY\_CLASSES\_ROOT**, the system stores the information under **HKEY\_LOCAL\_MACHINE\\Software\\Classes**.</span></span> <span data-ttu-id="41f99-121">如果您將值寫入至 **HKEY \_ 類別 \_ 根目錄** 下的索引鍵，而且索引鍵已經存在於 **HKEY 的 \_ 目前 \_ 使用者 \\ 軟體 \\ 類別** 下，則系統會在該處儲存資訊，而不是在 **HKEY \_ 本機 \_ 電腦 \\ 軟體 \\ 類別** 下儲存資訊。</span><span class="sxs-lookup"><span data-stu-id="41f99-121">If you write values to a key under **HKEY\_CLASSES\_ROOT**, and the key already exists under **HKEY\_CURRENT\_USER\\Software\\Classes**, the system will store the information there instead of under **HKEY\_LOCAL\_MACHINE\\Software\\Classes**.</span></span>

<span data-ttu-id="41f99-122">在非互動式使用者的安全性內容中執行的進程，不應該使用 **HKEY \_ 類別 \_ 根金鑰** 搭配登錄函式。</span><span class="sxs-lookup"><span data-stu-id="41f99-122">Processes running in a security context other than that of the interactive user should not use the **HKEY\_CLASSES\_ROOT** key with the registry functions.</span></span> <span data-ttu-id="41f99-123">相反地，這類進程可以明確開啟 [ **HKEY \_ 本機 \_ 電腦 \\ 軟體 \\ 類別] 機** 碼來存取預設設定。</span><span class="sxs-lookup"><span data-stu-id="41f99-123">Instead, such processes can explicitly open the **HKEY\_LOCAL\_MACHINE\\Software\\Classes** key to access the default settings.</span></span> <span data-ttu-id="41f99-124">若要開啟登錄機碼，以將 **HKEY \_ 本機 \_ 電腦 \\ 軟體 \\ 類別** 的內容與指定使用者的設定合併，這些程式可呼叫 [**RegOpenUserClassesRoot**](/windows/desktop/api/Winreg/nf-winreg-regopenuserclassesroot) 函式。</span><span class="sxs-lookup"><span data-stu-id="41f99-124">To open a registry key that merges the contents of **HKEY\_LOCAL\_MACHINE\\Software\\Classes** with the settings for a specified user, these processes can call the [**RegOpenUserClassesRoot**](/windows/desktop/api/Winreg/nf-winreg-regopenuserclassesroot) function.</span></span> <span data-ttu-id="41f99-125">例如，模擬用戶端的執行緒如果需要為模擬的用戶端抓取合併的視圖 [，則可以](/windows/desktop/SecAuthZ/client-impersonation) 呼叫 **RegOpenUserClassesRoot** 。</span><span class="sxs-lookup"><span data-stu-id="41f99-125">For example, a thread that is [impersonating](/windows/desktop/SecAuthZ/client-impersonation) a client can call **RegOpenUserClassesRoot** if it needs to retrieve a merged view for the client being impersonated.</span></span> <span data-ttu-id="41f99-126">請注意，如果指定之使用者的使用者設定檔尚未載入， **RegOpenUserClassesRoot** 就會失敗。</span><span class="sxs-lookup"><span data-stu-id="41f99-126">Note that **RegOpenUserClassesRoot** fails if the user profile for the specified user has not been loaded.</span></span> <span data-ttu-id="41f99-127">系統會在登入時自動載入互動式使用者的設定檔。</span><span class="sxs-lookup"><span data-stu-id="41f99-127">The system automatically loads the profile for the interactive user when logging on.</span></span> <span data-ttu-id="41f99-128">若為其他使用者，您必須呼叫 [**LoadUserProfile**](/windows/win32/api/userenv/nf-userenv-loaduserprofilea) 函式來明確載入使用者的設定檔。</span><span class="sxs-lookup"><span data-stu-id="41f99-128">For other users, you need to call the [**LoadUserProfile**](/windows/win32/api/userenv/nf-userenv-loaduserprofilea) function to explicitly load the user's profile.</span></span>

<span data-ttu-id="41f99-129">如果應用程式是以系統管理員許可權執行，而且已停用 [使用者帳戶控制]，則 COM 執行時間會忽略每一使用者的 COM 設定，並只存取個別電腦的 COM 設定。</span><span class="sxs-lookup"><span data-stu-id="41f99-129">If an application is run with administrator rights and User Account Control is disabled, the COM runtime ignores the per-user COM configuration and accesses only the per-machine COM configuration.</span></span> <span data-ttu-id="41f99-130">需要系統管理員許可權的應用程式應該在安裝期間，將相依的 COM 物件註冊到個別電腦的 COM 設定存放區 (**HKEY \_ 本機 \_ 電腦 \\ 軟體 \\ 類別**) 。</span><span class="sxs-lookup"><span data-stu-id="41f99-130">Applications that require administrator rights should register dependent COM objects during installation to the per-machine COM configuration store (**HKEY\_LOCAL\_MACHINE\\Software\\Classes**).</span></span> <span data-ttu-id="41f99-131">如需詳細資訊，請參閱 [AC： UAC： COM Per-User](/previous-versions/bb756926(v=msdn.10))設定。</span><span class="sxs-lookup"><span data-stu-id="41f99-131">For more information, see [AC: UAC: COM Per-User Configuration](/previous-versions/bb756926(v=msdn.10)).</span></span>

<span data-ttu-id="41f99-132">**Windows Server 2003 和 WINDOWS XP/2000：** 應用程式可以將相依的 COM 物件註冊到個別電腦或個別使用者的 COM 設定存放區 (**HKEY \_ 本機 \_ 電腦 \\ 軟體 \\ 類別** 或 **HKEY 目前的 \_ \_ 使用者 \\ 軟體 \\ 類別**) 。</span><span class="sxs-lookup"><span data-stu-id="41f99-132">**Windows Server 2003 and Windows XP/2000:** Applications can register dependent COM objects to either the per-machine or per-user COM configuration store (**HKEY\_LOCAL\_MACHINE\\Software\\Classes** or **HKEY\_CURRENT\_USER\\Software\\Classes**).</span></span>

## <a name="related-topics"></a><span data-ttu-id="41f99-133">相關主題</span><span class="sxs-lookup"><span data-stu-id="41f99-133">Related topics</span></span>

<dl> <dt>

<span data-ttu-id="41f99-134">[HKEY \_ 類別 \_ 根目錄 (資源套件登錄參考) ](/previous-versions/windows/it-pro/windows-server-2003/cc739822(v=ws.10))</span><span class="sxs-lookup"><span data-stu-id="41f99-134">[HKEY\_CLASSES\_ROOT (Resource Kit Registry Reference)](/previous-versions/windows/it-pro/windows-server-2003/cc739822(v=ws.10))</span></span>
</dt> </dl>

 

 
