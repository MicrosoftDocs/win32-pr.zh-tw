---
description: Windows 安全性模型可讓您控制對登錄機碼的存取。 如需安全性的詳細資訊，請參閱 Access-Control 模型。
ms.assetid: 266d5c8e-1bcd-48e5-bc06-2fbc956d8658
title: 登錄機碼安全性與存取權限
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 73c80f21d296a88425024745d7442847a187cd43
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/08/2021
ms.locfileid: "106980311"
---
# <a name="registry-key-security-and-access-rights"></a><span data-ttu-id="ccbba-104">登錄機碼安全性與存取權限</span><span class="sxs-lookup"><span data-stu-id="ccbba-104">Registry Key Security and Access Rights</span></span>

<span data-ttu-id="ccbba-105">Windows 安全性模型可讓您控制對登錄機碼的存取。</span><span class="sxs-lookup"><span data-stu-id="ccbba-105">The Windows security model enables you to control access to registry keys.</span></span> <span data-ttu-id="ccbba-106">如需安全性的詳細資訊，請參閱 [存取控制模型](/windows/desktop/SecAuthZ/access-control-model)。</span><span class="sxs-lookup"><span data-stu-id="ccbba-106">For more information about security, see [Access-Control Model](/windows/desktop/SecAuthZ/access-control-model).</span></span>

<span data-ttu-id="ccbba-107">當您呼叫 [**RegCreateKeyEx**](/windows/desktop/api/Winreg/nf-winreg-regcreatekeyexa)或 [**RegSetKeySecurity**](/windows/desktop/api/winreg/nf-winreg-regsetkeysecurity)函式時，可以指定登錄機碼的 [安全描述項](/windows/desktop/SecAuthZ/security-descriptors)。</span><span class="sxs-lookup"><span data-stu-id="ccbba-107">You can specify a [security descriptor](/windows/desktop/SecAuthZ/security-descriptors) for a registry key when you call the [**RegCreateKeyEx**](/windows/desktop/api/Winreg/nf-winreg-regcreatekeyexa) or [**RegSetKeySecurity**](/windows/desktop/api/winreg/nf-winreg-regsetkeysecurity) function.</span></span> <span data-ttu-id="ccbba-108">如果您指定 **Null**，索引鍵會取得預設安全描述項。</span><span class="sxs-lookup"><span data-stu-id="ccbba-108">If you specify **NULL**, the key gets a default security descriptor.</span></span> <span data-ttu-id="ccbba-109">金鑰之預設安全描述項中的 Acl 會從其直接父機碼繼承。</span><span class="sxs-lookup"><span data-stu-id="ccbba-109">The ACLs in a default security descriptor for a key are inherited from its direct parent key.</span></span>

<span data-ttu-id="ccbba-110">若要取得登錄機碼的安全描述項，請呼叫 [**RegGetKeySecurity**](/windows/desktop/api/winreg/nf-winreg-reggetkeysecurity)、 [**GetNamedSecurityInfo**](/windows/desktop/api/aclapi/nf-aclapi-getnamedsecurityinfoa)或 [**GetSecurityInfo**](/windows/desktop/api/aclapi/nf-aclapi-getsecurityinfo) 函數。</span><span class="sxs-lookup"><span data-stu-id="ccbba-110">To get the security descriptor of a registry key, call the [**RegGetKeySecurity**](/windows/desktop/api/winreg/nf-winreg-reggetkeysecurity), [**GetNamedSecurityInfo**](/windows/desktop/api/aclapi/nf-aclapi-getnamedsecurityinfoa), or [**GetSecurityInfo**](/windows/desktop/api/aclapi/nf-aclapi-getsecurityinfo) function.</span></span>

<span data-ttu-id="ccbba-111">登錄機碼的有效存取權限包括刪除、讀取 \_ 控制、寫入 \_ DAC，以及寫入 \_ 擁有者 [標準存取權限](/windows/desktop/SecAuthZ/standard-access-rights)。</span><span class="sxs-lookup"><span data-stu-id="ccbba-111">The valid access rights for registry keys include the DELETE, READ\_CONTROL, WRITE\_DAC, and WRITE\_OWNER [standard access rights](/windows/desktop/SecAuthZ/standard-access-rights).</span></span> <span data-ttu-id="ccbba-112">登錄機碼不支援 [同步處理標準] 存取權限。</span><span class="sxs-lookup"><span data-stu-id="ccbba-112">Registry keys do not support the SYNCHRONIZE standard access right.</span></span>

<span data-ttu-id="ccbba-113">下表列出登錄機碼物件的特定存取權限。</span><span class="sxs-lookup"><span data-stu-id="ccbba-113">The following table lists the specific access rights for registry key objects.</span></span>



| <span data-ttu-id="ccbba-114">值</span><span class="sxs-lookup"><span data-stu-id="ccbba-114">Value</span></span>                                         | <span data-ttu-id="ccbba-115">意義</span><span class="sxs-lookup"><span data-stu-id="ccbba-115">Meaning</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|-----------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="ccbba-116">重要的 \_ 所有 \_ 存取 (0xF003F) </span><span class="sxs-lookup"><span data-stu-id="ccbba-116">KEY\_ALL\_ACCESS (0xF003F)</span></span><br/>         | <span data-ttu-id="ccbba-117">結合必要的標準 \_ 許可權 \_ 、金鑰 \_ 查詢 \_ 值、金鑰 \_ 集 \_ 值、金鑰 \_ 建立 \_ 子機 \_ 碼、金鑰列舉子機碼 \_ \_ \_ 、金鑰 \_ 通知，以及金鑰 \_ 建立 \_ 連結存取權限。</span><span class="sxs-lookup"><span data-stu-id="ccbba-117">Combines the STANDARD\_RIGHTS\_REQUIRED, KEY\_QUERY\_VALUE, KEY\_SET\_VALUE, KEY\_CREATE\_SUB\_KEY, KEY\_ENUMERATE\_SUB\_KEYS, KEY\_NOTIFY, and KEY\_CREATE\_LINK access rights.</span></span><br/>                                                                                                                                                                                                                                                                           |
| <span data-ttu-id="ccbba-118">金鑰 \_ 建立 \_ 連結 (0x0020) </span><span class="sxs-lookup"><span data-stu-id="ccbba-118">KEY\_CREATE\_LINK (0x0020)</span></span><br/>         | <span data-ttu-id="ccbba-119">保留供系統使用。</span><span class="sxs-lookup"><span data-stu-id="ccbba-119">Reserved for system use.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| <span data-ttu-id="ccbba-120">金鑰 \_ 建立 \_ 子機碼 \_ (0x0004) </span><span class="sxs-lookup"><span data-stu-id="ccbba-120">KEY\_CREATE\_SUB\_KEY (0x0004)</span></span><br/>     | <span data-ttu-id="ccbba-121">建立登錄機碼的子機碼所需。</span><span class="sxs-lookup"><span data-stu-id="ccbba-121">Required to create a subkey of a registry key.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                             |
| <span data-ttu-id="ccbba-122">\_ \_ \_ (0X0008) 的按鍵列舉子機碼</span><span class="sxs-lookup"><span data-stu-id="ccbba-122">KEY\_ENUMERATE\_SUB\_KEYS (0x0008)</span></span><br/> | <span data-ttu-id="ccbba-123">列舉登錄機碼的子機碼所需。</span><span class="sxs-lookup"><span data-stu-id="ccbba-123">Required to enumerate the subkeys of a registry key.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                       |
| <span data-ttu-id="ccbba-124">金鑰 \_ 執行 (0x20019) </span><span class="sxs-lookup"><span data-stu-id="ccbba-124">KEY\_EXECUTE (0x20019)</span></span><br/>             | <span data-ttu-id="ccbba-125">相當於 \_ 讀取的索引鍵。</span><span class="sxs-lookup"><span data-stu-id="ccbba-125">Equivalent to KEY\_READ.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| <span data-ttu-id="ccbba-126">金鑰 \_ 通知 (0x0010) </span><span class="sxs-lookup"><span data-stu-id="ccbba-126">KEY\_NOTIFY (0x0010)</span></span><br/>               | <span data-ttu-id="ccbba-127">要求登錄機碼或登錄機碼的子機碼變更通知所需。</span><span class="sxs-lookup"><span data-stu-id="ccbba-127">Required to request change notifications for a registry key or for subkeys of a registry key.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                              |
| <span data-ttu-id="ccbba-128">\_ (0x0001) 的索引鍵查詢 \_ 值</span><span class="sxs-lookup"><span data-stu-id="ccbba-128">KEY\_QUERY\_VALUE (0x0001)</span></span><br/>         | <span data-ttu-id="ccbba-129">查詢登錄機碼值的必要項。</span><span class="sxs-lookup"><span data-stu-id="ccbba-129">Required to query the values of a registry key.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                            |
| <span data-ttu-id="ccbba-130">金鑰 \_ 讀取 (0x20019) </span><span class="sxs-lookup"><span data-stu-id="ccbba-130">KEY\_READ (0x20019)</span></span><br/>                | <span data-ttu-id="ccbba-131">結合標準 \_ 許可權 \_ 讀取、金鑰 \_ 查詢 \_ 值、金鑰列舉子機碼 \_ \_ \_ 和金鑰 \_ 通知值。</span><span class="sxs-lookup"><span data-stu-id="ccbba-131">Combines the STANDARD\_RIGHTS\_READ, KEY\_QUERY\_VALUE, KEY\_ENUMERATE\_SUB\_KEYS, and KEY\_NOTIFY values.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                 |
| <span data-ttu-id="ccbba-132">\_ (0x0002) 的索引鍵集 \_ 值</span><span class="sxs-lookup"><span data-stu-id="ccbba-132">KEY\_SET\_VALUE (0x0002)</span></span><br/>           | <span data-ttu-id="ccbba-133">建立、刪除或設定登錄值所需。</span><span class="sxs-lookup"><span data-stu-id="ccbba-133">Required to create, delete, or set a registry value.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                       |
| <span data-ttu-id="ccbba-134">KEY \_ WOW64 \_ 32KEY (0x0200) </span><span class="sxs-lookup"><span data-stu-id="ccbba-134">KEY\_WOW64\_32KEY (0x0200)</span></span><br/>         | <span data-ttu-id="ccbba-135">指出64位 Windows 上的應用程式應該在32位登錄視圖上操作。</span><span class="sxs-lookup"><span data-stu-id="ccbba-135">Indicates that an application on 64-bit Windows should operate on the 32-bit registry view.</span></span> <span data-ttu-id="ccbba-136">32位 Windows 會忽略此旗標。</span><span class="sxs-lookup"><span data-stu-id="ccbba-136">This flag is ignored by 32-bit Windows.</span></span> <span data-ttu-id="ccbba-137">如需詳細資訊，請參閱 [存取替代登錄視圖](/windows/desktop/WinProg64/accessing-an-alternate-registry-view)。</span><span class="sxs-lookup"><span data-stu-id="ccbba-137">For more information, see [Accessing an Alternate Registry View](/windows/desktop/WinProg64/accessing-an-alternate-registry-view).</span></span><br/> <span data-ttu-id="ccbba-138">此旗標必須與下表中其他旗標（查詢或存取登錄值）結合使用 OR 運算子。</span><span class="sxs-lookup"><span data-stu-id="ccbba-138">This flag must be combined using the OR operator with the other flags in this table that either query or access registry values.</span></span><br/> <span data-ttu-id="ccbba-139">**Windows 2000：** 不支援此旗標。</span><span class="sxs-lookup"><span data-stu-id="ccbba-139">**Windows 2000:** This flag is not supported.</span></span><br/> |
| <span data-ttu-id="ccbba-140">KEY \_ WOW64 \_ 64KEY (0x0100) </span><span class="sxs-lookup"><span data-stu-id="ccbba-140">KEY\_WOW64\_64KEY (0x0100)</span></span><br/>         | <span data-ttu-id="ccbba-141">指出64位 Windows 上的應用程式應該在64位登錄視圖上操作。</span><span class="sxs-lookup"><span data-stu-id="ccbba-141">Indicates that an application on 64-bit Windows should operate on the 64-bit registry view.</span></span> <span data-ttu-id="ccbba-142">32位 Windows 會忽略此旗標。</span><span class="sxs-lookup"><span data-stu-id="ccbba-142">This flag is ignored by 32-bit Windows.</span></span> <span data-ttu-id="ccbba-143">如需詳細資訊，請參閱 [存取替代登錄視圖](/windows/desktop/WinProg64/accessing-an-alternate-registry-view)。</span><span class="sxs-lookup"><span data-stu-id="ccbba-143">For more information, see [Accessing an Alternate Registry View](/windows/desktop/WinProg64/accessing-an-alternate-registry-view).</span></span><br/> <span data-ttu-id="ccbba-144">此旗標必須與下表中其他旗標（查詢或存取登錄值）結合使用 OR 運算子。</span><span class="sxs-lookup"><span data-stu-id="ccbba-144">This flag must be combined using the OR operator with the other flags in this table that either query or access registry values.</span></span><br/> <span data-ttu-id="ccbba-145">**Windows 2000：** 不支援此旗標。</span><span class="sxs-lookup"><span data-stu-id="ccbba-145">**Windows 2000:** This flag is not supported.</span></span><br/> |
| <span data-ttu-id="ccbba-146">金鑰 \_ 寫入 (0x20006) </span><span class="sxs-lookup"><span data-stu-id="ccbba-146">KEY\_WRITE (0x20006)</span></span><br/>               | <span data-ttu-id="ccbba-147">結合標準的 \_ 許可權 \_ 寫入、金鑰 \_ 集 \_ 值和金鑰 \_ 建立 \_ 子 \_ 金鑰存取權限。</span><span class="sxs-lookup"><span data-stu-id="ccbba-147">Combines the STANDARD\_RIGHTS\_WRITE, KEY\_SET\_VALUE, and KEY\_CREATE\_SUB\_KEY access rights.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                            |



 

<span data-ttu-id="ccbba-148">當您呼叫 [**RegOpenKeyEx**](/windows/desktop/api/Winreg/nf-winreg-regopenkeyexa) 函數時，系統會根據金鑰的安全描述項來檢查要求的存取權限。</span><span class="sxs-lookup"><span data-stu-id="ccbba-148">When you call the [**RegOpenKeyEx**](/windows/desktop/api/Winreg/nf-winreg-regopenkeyexa) function, the system checks the requested access rights against the key's security descriptor.</span></span> <span data-ttu-id="ccbba-149">如果使用者沒有正確的登錄機碼存取權，則開啟作業會失敗。</span><span class="sxs-lookup"><span data-stu-id="ccbba-149">If the user does not have the correct access to the registry key, the open operation fails.</span></span> <span data-ttu-id="ccbba-150">如果系統管理員需要存取金鑰，解決方案是啟用 SE 取得 \_ \_ 擁有權 \_ 名稱許可權，並使用寫入擁有者存取權開啟登錄機碼 \_ 。</span><span class="sxs-lookup"><span data-stu-id="ccbba-150">If an administrator needs access to the key, the solution is to enable the SE\_TAKE\_OWNERSHIP\_NAME privilege and open the registry key with WRITE\_OWNER access.</span></span> <span data-ttu-id="ccbba-151">如需詳細資訊，請參閱 [啟用和停用許可權](/windows/desktop/SecAuthZ/enabling-and-disabling-privileges-in-c--)。</span><span class="sxs-lookup"><span data-stu-id="ccbba-151">For more information, see [Enabling and Disabling Privileges](/windows/desktop/SecAuthZ/enabling-and-disabling-privileges-in-c--).</span></span>

<span data-ttu-id="ccbba-152">\_ \_ 如果您想要讀取或寫入金鑰的系統存取控制清單 (SACL) ，您可以向登錄機碼要求存取系統安全性存取權。</span><span class="sxs-lookup"><span data-stu-id="ccbba-152">You can request the ACCESS\_SYSTEM\_SECURITY access right to a registry key if you want to read or write the key's system access control list (SACL).</span></span> <span data-ttu-id="ccbba-153">如需詳細資訊，請參閱 (Acl) 和[SACL 訪問](/windows/desktop/SecAuthZ/sacl-access-right)許可權[的存取控制清單](/windows/desktop/SecAuthZ/access-control-lists)。</span><span class="sxs-lookup"><span data-stu-id="ccbba-153">For more information, see [Access-Control Lists (ACLs)](/windows/desktop/SecAuthZ/access-control-lists) and [SACL Access Right](/windows/desktop/SecAuthZ/sacl-access-right).</span></span>

<span data-ttu-id="ccbba-154">若要查看金鑰的目前存取權限，包括預先定義的金鑰，請使用登錄編輯程式 (Regedt32.exe) 。</span><span class="sxs-lookup"><span data-stu-id="ccbba-154">To view the current access rights for a key, including the predefined keys, use the Registry Editor (Regedt32.exe).</span></span> <span data-ttu-id="ccbba-155">流覽至所需的金鑰之後，請移至 [ **編輯** ] 功能表，然後選取 [ **許可權**]。</span><span class="sxs-lookup"><span data-stu-id="ccbba-155">After navigating to the desired key, go to the **Edit** menu and select **Permissions**.</span></span>

 

