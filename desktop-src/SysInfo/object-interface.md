---
description: Windows 所提供的函式會執行下列工作：
ms.assetid: 437419c7-d6c5-4cae-b5d0-d552c75d4448
title: 物件介面
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 9adc85eafdcfe4bb573d3e156b20f9b74dbf0652
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/07/2021
ms.locfileid: "104469209"
---
# <a name="object-interface"></a>物件介面

Windows 所提供的函式會執行下列工作：

-   建立物件
-   取得物件控制碼
-   取得物件的相關資訊
-   設定物件的相關資訊
-   關閉物件控制碼
-   終結物件

每個物件都不需要這些工作的一部分。 某些工作會針對某些物件合併。 例如，應用程式可以建立事件物件。 其他應用程式可以開啟事件，以取得此事件物件的唯一控制碼。 當每個應用程式使用事件完成時，它會關閉其對物件的控制碼。 當事件物件沒有剩餘的開啟控制碼時，系統會終結事件物件。 相反地，應用程式可以取得現有視窗物件的控制碼。 當不再需要視窗物件時，應用程式必須終結物件，使視窗控制碼失效。

有時候，在所有物件控制碼都關閉之後，物件仍會保留在記憶體中。 例如，執行緒可以建立事件物件，並等候事件控制碼。 當執行緒正在等候時，另一個執行緒可以關閉相同的事件物件控制碼。 事件物件會保留在記憶體中（沒有任何事件物件控制碼），直到事件物件設定為信號狀態且等候作業完成為止。 此時，系統會從記憶體中移除物件。

控制碼和物件會耗用記憶體。 因此，若要保留系統效能，您應該在不再需要時立即關閉控制碼和刪除物件。 如果您沒有這樣做，您的應用程式可能會因為分頁檔過度使用而造成系統效能傷害。

當進程結束時，系統會自動關閉處理常式，並刪除進程所建立的物件。 但是，當執行緒終止時，系統通常不會關閉控制碼或刪除物件。 唯一的例外是視窗、攔截、視窗位置和動態資料交換 (DDE) 交談物件;當建立執行緒終止時，這些物件會遭到終結。

 

 



