---
description: 版本 API 協助程式函式是用來判斷目前正在執行的作業系統版本。 如需詳細資訊，請參閱取得系統版本。
ms.assetid: 1a70b1d9-ed66-4201-9921-4e26e4001020
title: 作業系統版本
ms.topic: article
ms.date: 09/15/2020
ms.openlocfilehash: 73eb9a81880f29f9292713af46c5c79a7e9eb2de
ms.sourcegitcommit: 7ea69db68bca2b1592802e676ada8432a2583410
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 09/17/2020
ms.locfileid: "104024275"
---
# <a name="operating-system-version"></a><span data-ttu-id="e6009-104">作業系統版本</span><span class="sxs-lookup"><span data-stu-id="e6009-104">Operating System Version</span></span>

<span data-ttu-id="e6009-105">[版本 API](version-helper-apis.md)協助程式函式是用來判斷目前正在執行的作業系統版本。</span><span class="sxs-lookup"><span data-stu-id="e6009-105">The [Version API Helper functions](version-helper-apis.md) are used to determine the version of the operating system that is currently running.</span></span> <span data-ttu-id="e6009-106">如需詳細資訊，請參閱 [取得系統版本](getting-the-system-version.md)。</span><span class="sxs-lookup"><span data-stu-id="e6009-106">For more information, see [Getting the System Version](getting-the-system-version.md).</span></span>

<span data-ttu-id="e6009-107">下表摘要說明最新的作業系統版本號碼。</span><span class="sxs-lookup"><span data-stu-id="e6009-107">The following table summarizes the most recent operating system version numbers.</span></span>

| <span data-ttu-id="e6009-108">作業系統</span><span class="sxs-lookup"><span data-stu-id="e6009-108">Operating system</span></span> | <span data-ttu-id="e6009-109">版本號碼</span><span class="sxs-lookup"><span data-stu-id="e6009-109">Version number</span></span> |
|------------------|----------------|
| <span data-ttu-id="e6009-110">Windows 10</span><span class="sxs-lookup"><span data-stu-id="e6009-110">Windows 10</span></span>       | <span data-ttu-id="e6009-111">10.0\*</span><span class="sxs-lookup"><span data-stu-id="e6009-111">10.0\*</span></span>         |
| <span data-ttu-id="e6009-112">Windows Server 2019</span><span class="sxs-lookup"><span data-stu-id="e6009-112">Windows Server 2019</span></span> | <span data-ttu-id="e6009-113">10.0\*</span><span class="sxs-lookup"><span data-stu-id="e6009-113">10.0\*</span></span>      |
| <span data-ttu-id="e6009-114">Windows Server 2016</span><span class="sxs-lookup"><span data-stu-id="e6009-114">Windows Server 2016</span></span> | <span data-ttu-id="e6009-115">10.0\*</span><span class="sxs-lookup"><span data-stu-id="e6009-115">10.0\*</span></span>      |
| <span data-ttu-id="e6009-116">Windows 8.1</span><span class="sxs-lookup"><span data-stu-id="e6009-116">Windows 8.1</span></span>      | <span data-ttu-id="e6009-117">6.3\*</span><span class="sxs-lookup"><span data-stu-id="e6009-117">6.3\*</span></span>          |
| <span data-ttu-id="e6009-118">Windows Server 2012 R2</span><span class="sxs-lookup"><span data-stu-id="e6009-118">Windows Server 2012 R2</span></span> | <span data-ttu-id="e6009-119">6.3\*</span><span class="sxs-lookup"><span data-stu-id="e6009-119">6.3\*</span></span>    |
| <span data-ttu-id="e6009-120">Windows 8</span><span class="sxs-lookup"><span data-stu-id="e6009-120">Windows 8</span></span>        | <span data-ttu-id="e6009-121">6.2</span><span class="sxs-lookup"><span data-stu-id="e6009-121">6.2</span></span>            |
| <span data-ttu-id="e6009-122">Windows Server 2012</span><span class="sxs-lookup"><span data-stu-id="e6009-122">Windows Server 2012</span></span> | <span data-ttu-id="e6009-123">6.2</span><span class="sxs-lookup"><span data-stu-id="e6009-123">6.2</span></span>         |
| <span data-ttu-id="e6009-124">Windows 7</span><span class="sxs-lookup"><span data-stu-id="e6009-124">Windows 7</span></span>        | <span data-ttu-id="e6009-125">6.1</span><span class="sxs-lookup"><span data-stu-id="e6009-125">6.1</span></span>            |
| <span data-ttu-id="e6009-126">Windows Server 2008 R2</span><span class="sxs-lookup"><span data-stu-id="e6009-126">Windows Server 2008 R2</span></span> | <span data-ttu-id="e6009-127">6.1</span><span class="sxs-lookup"><span data-stu-id="e6009-127">6.1</span></span>      |
| <span data-ttu-id="e6009-128">Windows Server 2008</span><span class="sxs-lookup"><span data-stu-id="e6009-128">Windows Server 2008</span></span> | <span data-ttu-id="e6009-129">6.0</span><span class="sxs-lookup"><span data-stu-id="e6009-129">6.0</span></span>         |
| <span data-ttu-id="e6009-130">Windows Vista</span><span class="sxs-lookup"><span data-stu-id="e6009-130">Windows Vista</span></span>    | <span data-ttu-id="e6009-131">6.0</span><span class="sxs-lookup"><span data-stu-id="e6009-131">6.0</span></span>            |
| <span data-ttu-id="e6009-132">Windows Server 2003 R2</span><span class="sxs-lookup"><span data-stu-id="e6009-132">Windows Server 2003 R2</span></span> | <span data-ttu-id="e6009-133">5.2</span><span class="sxs-lookup"><span data-stu-id="e6009-133">5.2</span></span>      |
| <span data-ttu-id="e6009-134">Windows Server 2003</span><span class="sxs-lookup"><span data-stu-id="e6009-134">Windows Server 2003</span></span> | <span data-ttu-id="e6009-135">5.2</span><span class="sxs-lookup"><span data-stu-id="e6009-135">5.2</span></span>         |
| <span data-ttu-id="e6009-136">Windows XP 64 位版本</span><span class="sxs-lookup"><span data-stu-id="e6009-136">Windows XP 64-Bit Edition</span></span> | <span data-ttu-id="e6009-137">5.2</span><span class="sxs-lookup"><span data-stu-id="e6009-137">5.2</span></span>   |
| <span data-ttu-id="e6009-138">Windows XP</span><span class="sxs-lookup"><span data-stu-id="e6009-138">Windows XP</span></span> | <span data-ttu-id="e6009-139">5.1</span><span class="sxs-lookup"><span data-stu-id="e6009-139">5.1</span></span>                  |
| <span data-ttu-id="e6009-140">Windows 2000</span><span class="sxs-lookup"><span data-stu-id="e6009-140">Windows 2000</span></span>     | <span data-ttu-id="e6009-141">5.0</span><span class="sxs-lookup"><span data-stu-id="e6009-141">5.0</span></span>            |

<span data-ttu-id="e6009-142">**\*** 適用于已針對 Windows 8.1 或 Windows 10 所列入的應用程式。</span><span class="sxs-lookup"><span data-stu-id="e6009-142">**\*** For applications that have been manifested for Windows 8.1 or Windows 10.</span></span> <span data-ttu-id="e6009-143">未針對 Windows 8.1 或 Windows 10 所找出的應用程式將會傳回 Windows 8 的 OS 版本值 (6.2) 。</span><span class="sxs-lookup"><span data-stu-id="e6009-143">Applications not manifested for Windows 8.1 or Windows 10 will return the Windows 8 OS version value (6.2).</span></span> <span data-ttu-id="e6009-144">若要將您的應用程式 Windows 8.1 或 Windows 10 的資訊清單，請參閱以 [Windows 的應用程式為目標](targeting-your-application-at-windows-8-1.md)。</span><span class="sxs-lookup"><span data-stu-id="e6009-144">To manifest your applications for Windows 8.1 or Windows 10, refer to [Targeting your application for Windows](targeting-your-application-at-windows-8-1.md).</span></span><br/>

<span data-ttu-id="e6009-145">識別目前的作業系統，通常並不是判斷特定作業系統功能是否存在的最佳方式。</span><span class="sxs-lookup"><span data-stu-id="e6009-145">Identifying the current operating system is usually not the best way to determine whether a particular operating system feature is present.</span></span> <span data-ttu-id="e6009-146">這是因為作業系統可能已在可轉散發 DLL 中新增新功能。</span><span class="sxs-lookup"><span data-stu-id="e6009-146">This is because the operating system may have had new features added in a redistributable DLL.</span></span> <span data-ttu-id="e6009-147">您可以測試功能本身是否存在，而不是使用 [版本 API](version-helper-apis.md) 協助程式函式來判斷作業系統平臺或版本號碼。</span><span class="sxs-lookup"><span data-stu-id="e6009-147">Rather than using the [Version API Helper functions](version-helper-apis.md) to determine the operating system platform or version number, test for the presence of the feature itself.</span></span>

<span data-ttu-id="e6009-148">若要判斷測試功能的最佳方式，請參閱感興趣之功能的檔。</span><span class="sxs-lookup"><span data-stu-id="e6009-148">To determine the best way to test for a feature, refer to the documentation for the feature of interest.</span></span> <span data-ttu-id="e6009-149">下列清單討論功能偵測的一些常見技術：</span><span class="sxs-lookup"><span data-stu-id="e6009-149">The following list discusses some common techniques for feature detection:</span></span>

- <span data-ttu-id="e6009-150">您可以測試與功能相關聯的函式是否存在。</span><span class="sxs-lookup"><span data-stu-id="e6009-150">You can test for the presence of the functions associated with a feature.</span></span> <span data-ttu-id="e6009-151">若要測試是否有系統 DLL 中的函式，請呼叫 [**LoadLibrary**](/windows/desktop/api/libloaderapi/nf-libloaderapi-loadlibrarya) 函式以載入 DLL。</span><span class="sxs-lookup"><span data-stu-id="e6009-151">To test for the presence of a function in a system DLL, call the [**LoadLibrary**](/windows/desktop/api/libloaderapi/nf-libloaderapi-loadlibrarya) function to load the DLL.</span></span> <span data-ttu-id="e6009-152">然後呼叫 [**GetProcAddress**](/windows/desktop/api/libloaderapi/nf-libloaderapi-getprocaddress) 函數，判斷是否有感興趣的函式存在於 DLL 中。</span><span class="sxs-lookup"><span data-stu-id="e6009-152">Then call the [**GetProcAddress**](/windows/desktop/api/libloaderapi/nf-libloaderapi-getprocaddress) function to determine whether the function of interest is present in the DLL.</span></span> <span data-ttu-id="e6009-153">使用 **GetProcAddress** 傳回的指標來呼叫函數。</span><span class="sxs-lookup"><span data-stu-id="e6009-153">Use the pointer returned by **GetProcAddress** to call the function.</span></span> <span data-ttu-id="e6009-154">請注意，即使函式存在，也可能是只傳回錯誤碼（例如錯誤 \_ 呼叫未執行）的存根 \_ \_ 。</span><span class="sxs-lookup"><span data-stu-id="e6009-154">Note that even if the function is present, it may be a stub that just returns an error code such as ERROR\_CALL\_NOT\_IMPLEMENTED.</span></span>
- <span data-ttu-id="e6009-155">您可以使用 [**GetSystemMetrics**](/windows/desktop/api/winuser/nf-winuser-getsystemmetrics) 函式來判斷某些功能是否存在。</span><span class="sxs-lookup"><span data-stu-id="e6009-155">You can determine the presence of some features by using the [**GetSystemMetrics**](/windows/desktop/api/winuser/nf-winuser-getsystemmetrics) function.</span></span> <span data-ttu-id="e6009-156">例如，您可以藉由呼叫 **GetSystemMetrics** (SM CMONITORS) 來偵測多個顯示監視器 \_ 。</span><span class="sxs-lookup"><span data-stu-id="e6009-156">For example, you can detect multiple display monitors by calling **GetSystemMetrics**(SM\_CMONITORS).</span></span>
- <span data-ttu-id="e6009-157">有數個版本的可轉散發 Dll 可執行 shell 和通用控制項功能。</span><span class="sxs-lookup"><span data-stu-id="e6009-157">There are several versions of the redistributable DLLs that implement shell and common control features.</span></span> <span data-ttu-id="e6009-158">如需判斷您的應用程式執行所在的系統上有哪些版本的相關資訊，請參閱 [Shell 和通用控制項版本](/previous-versions/windows/desktop/legacy/bb776779(v=vs.85))主題。</span><span class="sxs-lookup"><span data-stu-id="e6009-158">For information about determining which versions are present on the system your application is running on, see the topic [Shell and Common Controls Versions](/previous-versions/windows/desktop/legacy/bb776779(v=vs.85)).</span></span>

<span data-ttu-id="e6009-159">如果您必須要求特定的作業系統，請務必使用它做為最低支援版本，而不是設計一個作業系統的測試。</span><span class="sxs-lookup"><span data-stu-id="e6009-159">If you must require a particular operating system, be sure to use it as a minimum supported version, rather than design the test for the one operating system.</span></span> <span data-ttu-id="e6009-160">如此一來，您的偵測程式碼將繼續在未來的 Windows 版本上運作。</span><span class="sxs-lookup"><span data-stu-id="e6009-160">This way, your detection code will continue to work on future versions of Windows.</span></span>

<span data-ttu-id="e6009-161">請注意，32位應用程式可以藉由呼叫 [**IsWow64Process**](/windows/desktop/api/wow64apiset/nf-wow64apiset-iswow64process) 函式，來偵測它是否正在 WOW64 下執行。</span><span class="sxs-lookup"><span data-stu-id="e6009-161">Note that a 32-bit application can detect whether it is running under WOW64 by calling the [**IsWow64Process**](/windows/desktop/api/wow64apiset/nf-wow64apiset-iswow64process) function.</span></span> <span data-ttu-id="e6009-162">它可以藉由呼叫 [**GetNativeSystemInfo**](/windows/win32/api/sysinfoapi/nf-sysinfoapi-getnativesysteminfo) 函數來取得額外的處理器資訊。</span><span class="sxs-lookup"><span data-stu-id="e6009-162">It can obtain additional processor information by calling the [**GetNativeSystemInfo**](/windows/win32/api/sysinfoapi/nf-sysinfoapi-getnativesysteminfo) function.</span></span>

<span data-ttu-id="e6009-163">如需詳細資訊，請參閱 [Windows 10 版本資訊](/windows/release-information/) 和 [Windows 生命週期事實表](https://support.microsoft.com/help/13853/windows-lifecycle-fact-sheet)。</span><span class="sxs-lookup"><span data-stu-id="e6009-163">For more information, see [Windows 10 release information](/windows/release-information/) and [Windows lifecycle fact sheet](https://support.microsoft.com/help/13853/windows-lifecycle-fact-sheet).</span></span>

