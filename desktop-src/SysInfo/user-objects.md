---
description: 使用者介面物件只支援每個物件一個控制碼。 進程無法繼承或重複使用者物件的控制碼。 某個會話中的進程無法參考另一個會話中的使用者控制碼。
ms.assetid: 07edc049-26d9-4f42-a5e7-e1f4c8435a6c
title: 使用者物件
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: d5ed8afcf0f1d0e4c232cf503bc2c7ba86dca42d
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/07/2021
ms.locfileid: "104553179"
---
# <a name="user-objects"></a><span data-ttu-id="7986c-105">使用者物件</span><span class="sxs-lookup"><span data-stu-id="7986c-105">User Objects</span></span>

<span data-ttu-id="7986c-106">使用者介面物件只支援每個物件一個控制碼。</span><span class="sxs-lookup"><span data-stu-id="7986c-106">User interface objects support only one handle per object.</span></span> <span data-ttu-id="7986c-107">進程無法繼承或重複使用者物件的控制碼。</span><span class="sxs-lookup"><span data-stu-id="7986c-107">Processes cannot inherit or duplicate handles to user objects.</span></span> <span data-ttu-id="7986c-108">某個會話中的進程無法參考另一個會話中的使用者控制碼。</span><span class="sxs-lookup"><span data-stu-id="7986c-108">Processes in one session cannot reference a user handle in another session.</span></span>

<span data-ttu-id="7986c-109">每個會話都有65536個使用者控制碼的理論限制。</span><span class="sxs-lookup"><span data-stu-id="7986c-109">There is a theoretical limit of 65,536 user handles per session.</span></span> <span data-ttu-id="7986c-110">不過，每個會話可以開啟的最大使用者控制碼數目通常較低，因為它會受到可用記憶體的影響。</span><span class="sxs-lookup"><span data-stu-id="7986c-110">However, the maximum number of user handles that can be opened per session is usually lower, since it is affected by available memory.</span></span> <span data-ttu-id="7986c-111">另外還有使用者控制碼的預設每一進程限制。</span><span class="sxs-lookup"><span data-stu-id="7986c-111">There is also a default per-process limit of user handles.</span></span> <span data-ttu-id="7986c-112">若要變更此限制，請設定下列登錄值：</span><span class="sxs-lookup"><span data-stu-id="7986c-112">To change this limit, set the following registry value:</span></span>

<span data-ttu-id="7986c-113">**HKEY \_本機 \_ 電腦** \\ **軟體** \\ **Microsoft** \\ **Windows NT** \\ **CurrentVersion** \\ **Windows** \\ **USERProcessHandleQuota**</span><span class="sxs-lookup"><span data-stu-id="7986c-113">**HKEY\_LOCAL\_MACHINE**\\**SOFTWARE**\\**Microsoft**\\**Windows NT**\\**CurrentVersion**\\**Windows**\\**USERProcessHandleQuota**</span></span>

<span data-ttu-id="7986c-114">這個值可以設定為介於200到18000之間的數位。</span><span class="sxs-lookup"><span data-stu-id="7986c-114">This value can be set to a number between 200 and 18,000.</span></span>

## <a name="handles-to-user-objects"></a><span data-ttu-id="7986c-115">使用者物件的控制碼</span><span class="sxs-lookup"><span data-stu-id="7986c-115">Handles to User Objects</span></span>

<span data-ttu-id="7986c-116">使用者物件的控制碼對所有進程都是公用的。</span><span class="sxs-lookup"><span data-stu-id="7986c-116">Handles to user objects are public to all processes.</span></span> <span data-ttu-id="7986c-117">也就是說，只要進程具有物件的安全性存取權，任何程式都可以使用使用者物件控制碼。</span><span class="sxs-lookup"><span data-stu-id="7986c-117">That is, any process can use the user object handle, provided that the process has security access to the object.</span></span>

<span data-ttu-id="7986c-118">在下圖中，應用程式會建立視窗物件。</span><span class="sxs-lookup"><span data-stu-id="7986c-118">In the following illustration, an application creates a window object.</span></span> <span data-ttu-id="7986c-119">[**CreateWindow**](/windows/win32/api/winuser/nf-winuser-createwindowa)函數會建立視窗物件，並傳回物件控制碼。</span><span class="sxs-lookup"><span data-stu-id="7986c-119">The [**CreateWindow**](/windows/win32/api/winuser/nf-winuser-createwindowa) function creates the window object and returns an object handle.</span></span>

![建立視窗物件的應用程式](images/cshob-01.png)

<span data-ttu-id="7986c-121">建立視窗物件之後，應用程式可以使用視窗控制碼來顯示或變更視窗。</span><span class="sxs-lookup"><span data-stu-id="7986c-121">After the window object has been created, the application can use the window handle to display or change the window.</span></span> <span data-ttu-id="7986c-122">控制碼會維持有效，直到視窗物件終結為止。</span><span class="sxs-lookup"><span data-stu-id="7986c-122">The handle remains valid until the window object is destroyed.</span></span>

<span data-ttu-id="7986c-123">在下一個圖中，應用程式會終結 window 物件。</span><span class="sxs-lookup"><span data-stu-id="7986c-123">In the next illustration, the application destroys the window object.</span></span> <span data-ttu-id="7986c-124">[**DestroyWindow**](/windows/win32/api/winuser/nf-winuser-destroywindow)函式會從記憶體中移除視窗物件，使視窗控制碼失效。</span><span class="sxs-lookup"><span data-stu-id="7986c-124">The [**DestroyWindow**](/windows/win32/api/winuser/nf-winuser-destroywindow) function removes the window object from memory, which invalidates the window handle.</span></span>

![終結視窗物件](images/cshob-02.png)

## <a name="managing-user-objects"></a><span data-ttu-id="7986c-126">管理使用者物件</span><span class="sxs-lookup"><span data-stu-id="7986c-126">Managing User Objects</span></span>

<span data-ttu-id="7986c-127">下表列出使用者物件，以及每個物件的建立者和 destroyer 函數。</span><span class="sxs-lookup"><span data-stu-id="7986c-127">The following table lists the user objects, along with each object's creator and destroyer functions.</span></span> <span data-ttu-id="7986c-128">建立者函式會建立物件和物件控制碼，或只傳回現有的物件控制碼。</span><span class="sxs-lookup"><span data-stu-id="7986c-128">The creator functions either create the object and an object handle or simply return the existing object handle.</span></span> <span data-ttu-id="7986c-129">Destroyer 函式會從記憶體中移除物件，這樣會使物件控制碼失效。</span><span class="sxs-lookup"><span data-stu-id="7986c-129">The destroyer functions remove the object from memory, which invalidates the object handle.</span></span>



| <span data-ttu-id="7986c-130">使用者物件</span><span class="sxs-lookup"><span data-stu-id="7986c-130">User object</span></span>       | <span data-ttu-id="7986c-131">Creator 函數</span><span class="sxs-lookup"><span data-stu-id="7986c-131">Creator function</span></span>                                                                                                                                                                                                                                                              | <span data-ttu-id="7986c-132">Destroyer 函式</span><span class="sxs-lookup"><span data-stu-id="7986c-132">Destroyer function</span></span>                                                                                   |
|-------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="7986c-133">快速鍵對應表</span><span class="sxs-lookup"><span data-stu-id="7986c-133">Accelerator table</span></span> | [<span data-ttu-id="7986c-134">**CreateAcceleratorTable**</span><span class="sxs-lookup"><span data-stu-id="7986c-134">**CreateAcceleratorTable**</span></span>](/windows/win32/api/winuser/nf-winuser-createacceleratortablea)                                                                                                                                                                                                               | [<span data-ttu-id="7986c-135">**DestroyAcceleratorTable**</span><span class="sxs-lookup"><span data-stu-id="7986c-135">**DestroyAcceleratorTable**</span></span>](/windows/win32/api/winuser/nf-winuser-destroyacceleratortable)                                    |
| <span data-ttu-id="7986c-136">插入點</span><span class="sxs-lookup"><span data-stu-id="7986c-136">Caret</span></span>             | [<span data-ttu-id="7986c-137">**CreateCaret**</span><span class="sxs-lookup"><span data-stu-id="7986c-137">**CreateCaret**</span></span>](/windows/win32/api/winuser/nf-winuser-createcaret)                                                                                                                                                                                                                                     | [<span data-ttu-id="7986c-138">**DestroyCaret**</span><span class="sxs-lookup"><span data-stu-id="7986c-138">**DestroyCaret**</span></span>](/windows/win32/api/winuser/nf-winuser-destroycaret)                                                          |
| <span data-ttu-id="7986c-139">資料指標</span><span class="sxs-lookup"><span data-stu-id="7986c-139">Cursor</span></span>            | <span data-ttu-id="7986c-140">[**CreateCursor**](/windows/win32/api/winuser/nf-winuser-createcursor)、 [**LoadCursor**](/windows/win32/api/winuser/nf-winuser-loadcursora)、 [**LoadImage**](/windows/win32/api/winuser/nf-winuser-loadimagea)</span><span class="sxs-lookup"><span data-stu-id="7986c-140">[**CreateCursor**](/windows/win32/api/winuser/nf-winuser-createcursor), [**LoadCursor**](/windows/win32/api/winuser/nf-winuser-loadcursora), [**LoadImage**](/windows/win32/api/winuser/nf-winuser-loadimagea)</span></span>                                                                                                                                                   | [<span data-ttu-id="7986c-141">**DestroyCursor**</span><span class="sxs-lookup"><span data-stu-id="7986c-141">**DestroyCursor**</span></span>](/windows/win32/api/winuser/nf-winuser-destroycursor)                                                        |
| <span data-ttu-id="7986c-142">DDE 交談</span><span class="sxs-lookup"><span data-stu-id="7986c-142">DDE conversation</span></span>  | <span data-ttu-id="7986c-143">[**DdeConnect**](/windows/win32/api/ddeml/nf-ddeml-ddeconnect)、 [ **DdeConnectList**](/windows/win32/api/ddeml/nf-ddeml-ddeconnectlist)</span><span class="sxs-lookup"><span data-stu-id="7986c-143">[**DdeConnect**](/windows/win32/api/ddeml/nf-ddeml-ddeconnect), [**DdeConnectList**](/windows/win32/api/ddeml/nf-ddeml-ddeconnectlist)</span></span>                                                                                                                                                                                      | <span data-ttu-id="7986c-144">[**DdeDisconnect**](/windows/win32/api/ddeml/nf-ddeml-ddedisconnect)、 [ **DdeDisconnectList**](/windows/win32/api/ddeml/nf-ddeml-ddedisconnectlist)</span><span class="sxs-lookup"><span data-stu-id="7986c-144">[**DdeDisconnect**](/windows/win32/api/ddeml/nf-ddeml-ddedisconnect), [**DdeDisconnectList**](/windows/win32/api/ddeml/nf-ddeml-ddedisconnectlist)</span></span> |
| <span data-ttu-id="7986c-145">鉤</span><span class="sxs-lookup"><span data-stu-id="7986c-145">Hook</span></span>              | [<span data-ttu-id="7986c-146">**SetWindowsHookEx**</span><span class="sxs-lookup"><span data-stu-id="7986c-146">**SetWindowsHookEx**</span></span>](/windows/win32/api/winuser/nf-winuser-setwindowshookexa)                                                                                                                                                                                                                           | [<span data-ttu-id="7986c-147">**UnhookWindowsHookEx**</span><span class="sxs-lookup"><span data-stu-id="7986c-147">**UnhookWindowsHookEx**</span></span>](/windows/win32/api/winuser/nf-winuser-unhookwindowshookex)                                            |
| <span data-ttu-id="7986c-148">圖示</span><span class="sxs-lookup"><span data-stu-id="7986c-148">Icon</span></span>              | <span data-ttu-id="7986c-149">[**CreateIconIndirect**](/windows/win32/api/winuser/nf-winuser-createiconindirect)、 [**LoadIcon**](/windows/win32/api/winuser/nf-winuser-loadicona)、 [**LoadImage**](/windows/win32/api/winuser/nf-winuser-loadimagea)</span><span class="sxs-lookup"><span data-stu-id="7986c-149">[**CreateIconIndirect**](/windows/win32/api/winuser/nf-winuser-createiconindirect), [**LoadIcon**](/windows/win32/api/winuser/nf-winuser-loadicona), [**LoadImage**](/windows/win32/api/winuser/nf-winuser-loadimagea)</span></span>                                                                                                                                           | [<span data-ttu-id="7986c-150">**DestroyIcon**</span><span class="sxs-lookup"><span data-stu-id="7986c-150">**DestroyIcon**</span></span>](/windows/win32/api/winuser/nf-winuser-destroyicon)                                                            |
| <span data-ttu-id="7986c-151">功能表</span><span class="sxs-lookup"><span data-stu-id="7986c-151">Menu</span></span>              | <span data-ttu-id="7986c-152">[**CreateMenu**](/windows/win32/api/winuser/nf-winuser-createmenu)、 [**CreatePopupMenu**](/windows/win32/api/winuser/nf-winuser-createpopupmenu)、 [**LoadMenu**](/windows/win32/api/winuser/nf-winuser-loadmenua)、 [**LoadMenuIndirect**](/windows/win32/api/winuser/nf-winuser-loadmenuindirecta)</span><span class="sxs-lookup"><span data-stu-id="7986c-152">[**CreateMenu**](/windows/win32/api/winuser/nf-winuser-createmenu), [**CreatePopupMenu**](/windows/win32/api/winuser/nf-winuser-createpopupmenu), [**LoadMenu**](/windows/win32/api/winuser/nf-winuser-loadmenua), [**LoadMenuIndirect**](/windows/win32/api/winuser/nf-winuser-loadmenuindirecta)</span></span>                                                                                          | [<span data-ttu-id="7986c-153">**DestroyMenu**</span><span class="sxs-lookup"><span data-stu-id="7986c-153">**DestroyMenu**</span></span>](/windows/win32/api/winuser/nf-winuser-destroymenu)                                                            |
| <span data-ttu-id="7986c-154">時間範圍</span><span class="sxs-lookup"><span data-stu-id="7986c-154">Window</span></span>            | <span data-ttu-id="7986c-155">[**CreateWindow**](/windows/win32/api/winuser/nf-winuser-createwindowa)、 [**CreateWindowEx**](/windows/win32/api/winuser/nf-winuser-createwindowexa)、 [**CreateDialogParam**](/windows/win32/api/winuser/nf-winuser-createdialogparama)、 [**CreateDialogIndirectParam**](/windows/win32/api/winuser/nf-winuser-createdialogindirectparama)、 [**CreateMDIWindow**](/windows/win32/api/winuser/nf-winuser-createmdiwindowa)</span><span class="sxs-lookup"><span data-stu-id="7986c-155">[**CreateWindow**](/windows/win32/api/winuser/nf-winuser-createwindowa), [**CreateWindowEx**](/windows/win32/api/winuser/nf-winuser-createwindowexa), [**CreateDialogParam**](/windows/win32/api/winuser/nf-winuser-createdialogparama), [**CreateDialogIndirectParam**](/windows/win32/api/winuser/nf-winuser-createdialogindirectparama), [**CreateMDIWindow**](/windows/win32/api/winuser/nf-winuser-createmdiwindowa)</span></span> | [<span data-ttu-id="7986c-156">**DestroyWindow**</span><span class="sxs-lookup"><span data-stu-id="7986c-156">**DestroyWindow**</span></span>](/windows/win32/api/winuser/nf-winuser-destroywindow)                                                        |
| <span data-ttu-id="7986c-157">視窗位置</span><span class="sxs-lookup"><span data-stu-id="7986c-157">Window position</span></span>   | [<span data-ttu-id="7986c-158">**BeginDeferWindowPos**</span><span class="sxs-lookup"><span data-stu-id="7986c-158">**BeginDeferWindowPos**</span></span>](/windows/win32/api/winuser/nf-winuser-begindeferwindowpos)                                                                                                                                                                                                                     | [<span data-ttu-id="7986c-159">**EndDeferWindowPos**</span><span class="sxs-lookup"><span data-stu-id="7986c-159">**EndDeferWindowPos**</span></span>](/windows/win32/api/winuser/nf-winuser-enddeferwindowpos)                                                |



 

 

 
