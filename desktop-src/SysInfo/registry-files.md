---
description: 應用程式可以將部分登錄儲存在檔案中，然後將檔案的內容載入至登錄中。
ms.assetid: a71a564d-934a-46e8-b555-989a6fa82337
title: 登錄檔
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 44916618946f6541495186aa5843799c9b864fbc
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/08/2021
ms.locfileid: "103944411"
---
# <a name="registry-files"></a><span data-ttu-id="cf0bc-103">登錄檔</span><span class="sxs-lookup"><span data-stu-id="cf0bc-103">Registry Files</span></span>

<span data-ttu-id="cf0bc-104">應用程式可以將部分登錄儲存在檔案中，然後將檔案的內容載入至登錄中。</span><span class="sxs-lookup"><span data-stu-id="cf0bc-104">Applications can save part of the registry in a file and then load the contents of the file back into the registry.</span></span> <span data-ttu-id="cf0bc-105">當正在操作大量資料、在登錄中進行許多專案時，或是當資料是暫時性且必須載入，然後再卸載時，登錄檔會很有用。</span><span class="sxs-lookup"><span data-stu-id="cf0bc-105">A registry file is useful when a large amount of data is being manipulated, when many entries are being made in the registry, or when the data is transitory and must be loaded and then unloaded again.</span></span> <span data-ttu-id="cf0bc-106">備份與還原登錄元件的應用程式很可能會使用登錄檔。</span><span class="sxs-lookup"><span data-stu-id="cf0bc-106">Applications that back up and restore parts of the registry are likely to use registry files.</span></span>

<span data-ttu-id="cf0bc-107">若要將金鑰和其子機碼和值儲存至登錄檔，應用程式可以呼叫 [**RegSaveKey**](/windows/desktop/api/Winreg/nf-winreg-regsavekeya) 或 [**RegSaveKeyEx**](/windows/desktop/api/Winreg/nf-winreg-regsavekeyexa) 函式。</span><span class="sxs-lookup"><span data-stu-id="cf0bc-107">To save a key and its subkeys and values to a registry file, an application can call the [**RegSaveKey**](/windows/desktop/api/Winreg/nf-winreg-regsavekeya) or [**RegSaveKeyEx**](/windows/desktop/api/Winreg/nf-winreg-regsavekeyexa) function.</span></span>

<span data-ttu-id="cf0bc-108">[**RegSaveKey**](/windows/desktop/api/Winreg/nf-winreg-regsavekeya) 和 [**RegSaveKeyEx**](/windows/desktop/api/Winreg/nf-winreg-regsavekeyexa) 會使用封存屬性來建立檔案。</span><span class="sxs-lookup"><span data-stu-id="cf0bc-108">[**RegSaveKey**](/windows/desktop/api/Winreg/nf-winreg-regsavekeya) and [**RegSaveKeyEx**](/windows/desktop/api/Winreg/nf-winreg-regsavekeyexa) create the file with the archive attribute.</span></span> <span data-ttu-id="cf0bc-109">檔案會建立在本機密鑰之進程的目前的目錄中，以及遠端金鑰的% systemroot% \\ system32 目錄中。</span><span class="sxs-lookup"><span data-stu-id="cf0bc-109">The file is created in the current directory of the process for a local key, and in the %systemroot%\\system32 directory for a remote key.</span></span>

<span data-ttu-id="cf0bc-110">登錄檔具有下列兩種格式：標準和最新。</span><span class="sxs-lookup"><span data-stu-id="cf0bc-110">Registry files have the following two formats: standard and latest.</span></span> <span data-ttu-id="cf0bc-111">標準格式是 Windows 2000 所支援的唯一格式。</span><span class="sxs-lookup"><span data-stu-id="cf0bc-111">The standard format is the only format supported by Windows 2000.</span></span> <span data-ttu-id="cf0bc-112">較新的 Windows 版本也支援此功能，以提供回溯相容性。</span><span class="sxs-lookup"><span data-stu-id="cf0bc-112">It is also supported by later versions of Windows for backward compatibility.</span></span> <span data-ttu-id="cf0bc-113">[**RegSaveKey**](/windows/desktop/api/Winreg/nf-winreg-regsavekeya) 會以標準格式建立檔案。</span><span class="sxs-lookup"><span data-stu-id="cf0bc-113">[**RegSaveKey**](/windows/desktop/api/Winreg/nf-winreg-regsavekeya) creates files in the standard format.</span></span>

<span data-ttu-id="cf0bc-114">從 Windows XP 開始支援最新的格式。</span><span class="sxs-lookup"><span data-stu-id="cf0bc-114">The latest format is supported starting with Windows XP.</span></span> <span data-ttu-id="cf0bc-115">以這種格式建立的登錄檔無法在 Windows 2000 上載入。</span><span class="sxs-lookup"><span data-stu-id="cf0bc-115">Registry files that are created in this format cannot be loaded on Windows 2000.</span></span> <span data-ttu-id="cf0bc-116">[**RegSaveKeyEx**](/windows/desktop/api/Winreg/nf-winreg-regsavekeyexa) 可以藉由指定 reg \_ 標準 \_ 格式或 reg \_ 最新格式，以任何一種格式儲存登錄檔 \_ 。</span><span class="sxs-lookup"><span data-stu-id="cf0bc-116">[**RegSaveKeyEx**](/windows/desktop/api/Winreg/nf-winreg-regsavekeyexa) can save registry files in either format by specifying either REG\_STANDARD\_FORMAT or REG\_LATEST\_FORMAT.</span></span> <span data-ttu-id="cf0bc-117">因此，它可以用來將使用標準格式的登錄檔轉換為最新的格式。</span><span class="sxs-lookup"><span data-stu-id="cf0bc-117">Therefore, it can be used to convert registry files that use the standard format to the latest format.</span></span>

<span data-ttu-id="cf0bc-118">若要將登錄檔寫回登錄，應用程式可以使用 [**RegLoadKey**](/windows/desktop/api/Winreg/nf-winreg-regloadkeya)、 [**RegReplaceKey**](/windows/desktop/api/Winreg/nf-winreg-regreplacekeya)或 [**RegRestoreKey**](/windows/desktop/api/Winreg/nf-winreg-regrestorekeya) 功能，如下所示。</span><span class="sxs-lookup"><span data-stu-id="cf0bc-118">To write the registry file back to the registry, an application can use the [**RegLoadKey**](/windows/desktop/api/Winreg/nf-winreg-regloadkeya), [**RegReplaceKey**](/windows/desktop/api/Winreg/nf-winreg-regreplacekeya), or [**RegRestoreKey**](/windows/desktop/api/Winreg/nf-winreg-regrestorekeya) functions as follows.</span></span>

-   <span data-ttu-id="cf0bc-119">**RegLoadKey** 會將指定檔案中的登錄資料，載入至呼叫應用程式電腦或遠端電腦上的 **HKEY \_ USERS** 或 **HKEY \_ LOCAL \_ MACHINE** 下的指定子機碼。</span><span class="sxs-lookup"><span data-stu-id="cf0bc-119">**RegLoadKey** loads registry data from a specified file into a specified subkey under **HKEY\_USERS** or **HKEY\_LOCAL\_MACHINE** on the calling application's computer or on a remote computer.</span></span> <span data-ttu-id="cf0bc-120">如果指定的子機碼不存在，則此函式會建立該子機碼。</span><span class="sxs-lookup"><span data-stu-id="cf0bc-120">The function creates the specified subkey if it does not already exist.</span></span> <span data-ttu-id="cf0bc-121">在呼叫此函式之後，應用程式可以使用 [**RegUnLoadKey**](/windows/desktop/api/Winreg/nf-winreg-regunloadkeya) 函式將登錄還原至先前的狀態。</span><span class="sxs-lookup"><span data-stu-id="cf0bc-121">After calling this function, an application can use the [**RegUnLoadKey**](/windows/desktop/api/Winreg/nf-winreg-regunloadkeya) function to restore the registry to its previous state.</span></span>
-   <span data-ttu-id="cf0bc-122">[**RegReplaceKey**](/windows/desktop/api/Winreg/nf-winreg-regreplacekeya) 會以指定檔案中包含的資料取代登錄中的機碼及其所有子機碼和值。</span><span class="sxs-lookup"><span data-stu-id="cf0bc-122">[**RegReplaceKey**](/windows/desktop/api/Winreg/nf-winreg-regreplacekeya) replaces a key and all its subkeys and values in the registry with the data contained in a specified file.</span></span> <span data-ttu-id="cf0bc-123">新的資料會在系統下次啟動時生效。</span><span class="sxs-lookup"><span data-stu-id="cf0bc-123">The new data takes effect the next time the system is started.</span></span>
-   <span data-ttu-id="cf0bc-124">[**RegRestoreKey**](/windows/desktop/api/Winreg/nf-winreg-regrestorekeya) 會將指定檔案中的登錄資料載入至呼叫應用程式電腦或遠端電腦上的指定機碼。</span><span class="sxs-lookup"><span data-stu-id="cf0bc-124">[**RegRestoreKey**](/windows/desktop/api/Winreg/nf-winreg-regrestorekeya) loads registry data from a specified file into a specified key on the calling application's computer or on a remote computer.</span></span> <span data-ttu-id="cf0bc-125">此函式會將指定索引鍵的子機碼和值取代為檔案中最上層金鑰後面的子機碼和值。</span><span class="sxs-lookup"><span data-stu-id="cf0bc-125">This function replaces the subkeys and values below the specified key with the subkeys and values that follow the top-level key in the file.</span></span>

<span data-ttu-id="cf0bc-126">[**RegConnectRegistry**](/windows/desktop/api/Winreg/nf-winreg-regconnectregistrya)函式會在另一部電腦上建立與預先定義之登錄控制碼的連接。</span><span class="sxs-lookup"><span data-stu-id="cf0bc-126">The [**RegConnectRegistry**](/windows/desktop/api/Winreg/nf-winreg-regconnectregistrya) function establishes a connection to a predefined registry handle on another computer.</span></span> <span data-ttu-id="cf0bc-127">應用程式通常會使用此功能，從網路環境中其他電腦上的遠端登入存取訊號，您也可以使用登錄編輯程式來進行此作業。</span><span class="sxs-lookup"><span data-stu-id="cf0bc-127">An application uses this function primarily to access information from a remote registry on other machines in a network environment, which you can also do by using the Registry Editor.</span></span> <span data-ttu-id="cf0bc-128">您可能會想要存取遠端登入來備份登錄或管制其網路存取。</span><span class="sxs-lookup"><span data-stu-id="cf0bc-128">You might want to access a remote registry to back up a registry or regulate network access to it.</span></span> <span data-ttu-id="cf0bc-129">請注意，您必須具有適當的許可權，才能使用此功能來存取遠端登入。</span><span class="sxs-lookup"><span data-stu-id="cf0bc-129">Note that you must have appropriate permissions to access a remote registry using this function.</span></span>

 

 



