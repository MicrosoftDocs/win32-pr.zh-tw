---
title: 執行 In-Place 啟用
description: 執行 In-Place 啟用
ms.assetid: 5fd67d1c-1dc5-4d83-a41e-b64d84cbf212
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c075f143c772fe34de0c494664227e892b998387
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 09/16/2019
ms.locfileid: "106968231"
---
# <a name="implementing-in-place-activation"></a>執行 In-Place 啟用

就地啟用可讓使用者與内嵌物件互動，而不需要離開容器檔案。 當使用者啟始物件時，由容器應用程式和伺服器應用程式功能表列中的元素組成的 *複合功能表列* ，會取代容器的主功能表列。 這兩個應用程式的命令和功能，可供使用者使用，包括作用中物件的內容相關說明。 當使用者開始使用部分非物件部分的檔時，會停用該物件，使容器檔案的原始功能表取代複合功能表。

這項功能最初是依 *就地編輯* 的名稱。 名稱已變更，因為編輯只是使用者與執行中物件互動的一種方式。 例如，您可以聆聽音效片段，而不是編輯。 影片剪輯可以用來流覽，而不是編輯。 在影片剪輯時，就地啟用特別 apt，因為它可讓它們就地執行，而不需要呼叫另一個視窗。 如果影片是與容器檔案中的相鄰文字資料一起查看，這可能是很重要的。

容器和伺服器應用程式的就地啟用完全是選擇性的。 OLE 仍然支援模型，在此模型中啟始物件會導致伺服器應用程式開啟另一個視窗。 連結化物件一律會在個別的視窗中開啟，以強調它們位於不同的檔中。

就地啟用會從物件開始，以回應 IOleObject：從其容器 [**:D overb**](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-doverb) 呼叫。 此呼叫通常是為了回應使用者按兩下物件，或是從容器應用程式的 [編輯] 功能表中選取命令 (動詞) 。

當内嵌物件為使用中時，就地視窗會接收鍵盤和滑鼠輸入。 當使用者從複合功能表列選取命令時，會將命令和相關聯的功能表訊息傳送至容器或物件應用程式，這取決於所選取的特定下拉式功能表。 透過物件的尺規、工具列或框架裝飾的輸入，會直接移至擁有這些視窗的内嵌物件。

就地啟動的内嵌物件會保持作用中，直到容器將它停用以回應使用者輸入，或物件可主動達成作用中狀態時，例如影片剪輯可能會有作用。 使用者可以在容器檔案內部按一下，但在物件的就地啟用視窗之外，或按一下其他物件來停用物件。 但是，如果使用者按一下容器的標題列、捲軸或特別是功能表列，則就地啟動的物件會維持作用中狀態。

您可以將就地啟始物件伺服器視為同進程伺服器 (DLL) 或本機伺服器 (EXE) 。 在這兩種情況下，複合功能表列包含的專案 (通常是從伺服器和容器進程) 的下拉式功能表。 在同進程伺服器的案例中，就地啟用視窗只是容器的視窗階層中的另一個子視窗，會透過容器應用程式的訊息提取接收其輸入。

在本機伺服器的案例中，就地啟用視窗屬於内嵌物件的伺服器應用程式進程，但其父視窗屬於容器。 就地啟動視窗的輸入會顯示在伺服器的訊息佇列中，並且由伺服器的訊息迴圈分派。 OLE 程式庫會負責查看功能表命令和訊息是否已正確分派。

## <a name="related-topics"></a>相關主題

<dl> <dt>

[複合檔案](compound-documents.md)
</dt> </dl>

 

 




