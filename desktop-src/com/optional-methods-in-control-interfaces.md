---
title: 控制項介面中的選擇性方法
description: 控制項介面中的選擇性方法
ms.assetid: a26f7078-9286-4b21-b924-4b03d3849909
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 1409b1c8d22f85a48829c07155e03379fc79103c
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 09/16/2019
ms.locfileid: "103931994"
---
# <a name="optional-methods-in-control-interfaces"></a><span data-ttu-id="5129a-103">控制項介面中的選擇性方法</span><span class="sxs-lookup"><span data-stu-id="5129a-103">Optional Methods in Control Interfaces</span></span>

<span data-ttu-id="5129a-104">執行介面並不一定表示執行該介面的所有方法，並視需要執行任何動作，而不是傳回 E \_ >notimpl 或 S \_ OK。</span><span class="sxs-lookup"><span data-stu-id="5129a-104">Implementing an interface doesn't necessarily mean implementing all methods of that interface to do anything more than return E\_NOTIMPL or S\_OK as appropriate.</span></span> <span data-ttu-id="5129a-105">下表識別介面的「支援」中所列介面的方法，這 [表示](what-support-for-an-interface-means.md) 控制項可以用這種方式執行的主題。</span><span class="sxs-lookup"><span data-stu-id="5129a-105">The following table identifies the methods of the interfaces listed in the [What Support for an Interface Means](what-support-for-an-interface-means.md) topic that a control may implement in this manner.</span></span> <span data-ttu-id="5129a-106">如果支援介面，則此處未列出的任何方法都必須完全執行。</span><span class="sxs-lookup"><span data-stu-id="5129a-106">Any method not listed here must be fully implemented if the interface is supported.</span></span>



| <span data-ttu-id="5129a-107">IOleControl</span><span class="sxs-lookup"><span data-stu-id="5129a-107">IOleControl</span></span>                                                                                                   | <span data-ttu-id="5129a-108">註解</span><span class="sxs-lookup"><span data-stu-id="5129a-108">Comments</span></span>                                                                       |
|---------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------|
| <span data-ttu-id="5129a-109">[**GetControlInfo**](/windows/desktop/api/OCIdl/nf-ocidl-iolecontrol-getcontrolinfo)、 [ **OnMnemonic**](/windows/desktop/api/OCIdl/nf-ocidl-iolecontrol-onmnemonic)</span><span class="sxs-lookup"><span data-stu-id="5129a-109">[**GetControlInfo**](/windows/desktop/api/OCIdl/nf-ocidl-iolecontrol-getcontrolinfo), [**OnMnemonic**](/windows/desktop/api/OCIdl/nf-ocidl-iolecontrol-onmnemonic)</span></span><br/> | <span data-ttu-id="5129a-110">具有助憶鍵的控制項是必要的。</span><span class="sxs-lookup"><span data-stu-id="5129a-110">Mandatory for controls with mnemonics.</span></span><br/>                              |
| [<span data-ttu-id="5129a-111">**IOleControl：： OnAmbientPropertyChange**</span><span class="sxs-lookup"><span data-stu-id="5129a-111">**IOleControl::OnAmbientPropertyChange**</span></span>](/windows/desktop/api/OCIdl/nf-ocidl-iolecontrol-onambientpropertychange)<br/>                | <span data-ttu-id="5129a-112">使用環境屬性之控制項的必要參數。</span><span class="sxs-lookup"><span data-stu-id="5129a-112">Mandatory for controls that use ambient properties.</span></span><br/>                 |
| [<span data-ttu-id="5129a-113">**IOleControl::FreezeEvents**</span><span class="sxs-lookup"><span data-stu-id="5129a-113">**IOleControl::FreezeEvents**</span></span>](/windows/desktop/api/OCIdl/nf-ocidl-iolecontrol-freezeevents)<br/>                                      | <span data-ttu-id="5129a-114">查看 [事件凍結](event-freezing.md)</span><span class="sxs-lookup"><span data-stu-id="5129a-114">See [Event Freezing](event-freezing.md)</span></span><br/>                            |
| <span data-ttu-id="5129a-115">IOleObject</span><span class="sxs-lookup"><span data-stu-id="5129a-115">IOleObject</span></span>                                                                                                    |                                                                                |
| [<span data-ttu-id="5129a-116">**SetMoniker**</span><span class="sxs-lookup"><span data-stu-id="5129a-116">**SetMoniker**</span></span>](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-setmoniker)<br/>                                                        | <span data-ttu-id="5129a-117">如果控制項未標記為 OLEMISC CANTLINKINSIDE，則為必要項 \_</span><span class="sxs-lookup"><span data-stu-id="5129a-117">Mandatory if the control is not marked with OLEMISC\_CANTLINKINSIDE</span></span><br/> |
| [<span data-ttu-id="5129a-118">**GetMoniker**</span><span class="sxs-lookup"><span data-stu-id="5129a-118">**GetMoniker**</span></span>](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-getmoniker)<br/>                                                        | <span data-ttu-id="5129a-119">如果控制項未標記為 OLEMISC CANTLINKINSIDE，則為必要項 \_</span><span class="sxs-lookup"><span data-stu-id="5129a-119">Mandatory if the control is not marked with OLEMISC\_CANTLINKINSIDE</span></span><br/> |
| [<span data-ttu-id="5129a-120">**InitFromData**</span><span class="sxs-lookup"><span data-stu-id="5129a-120">**InitFromData**</span></span>](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-initfromdata)<br/>                                                    | <span data-ttu-id="5129a-121">選擇性</span><span class="sxs-lookup"><span data-stu-id="5129a-121">Optional</span></span><br/>                                                            |
| [<span data-ttu-id="5129a-122">**GetClipboardData**</span><span class="sxs-lookup"><span data-stu-id="5129a-122">**GetClipboardData**</span></span>](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-getclipboarddata)<br/>                                            | <span data-ttu-id="5129a-123">選擇性</span><span class="sxs-lookup"><span data-stu-id="5129a-123">Optional</span></span><br/>                                                            |
| [<span data-ttu-id="5129a-124">**SetExtent**</span><span class="sxs-lookup"><span data-stu-id="5129a-124">**SetExtent**</span></span>](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-setextent)<br/>                                                          | <span data-ttu-id="5129a-125">只對 >DVASPECT 內容為必要 \_</span><span class="sxs-lookup"><span data-stu-id="5129a-125">Mandatory only for DVASPECT\_CONTENT</span></span><br/>                                |
| [<span data-ttu-id="5129a-126">**GetExtent**</span><span class="sxs-lookup"><span data-stu-id="5129a-126">**GetExtent**</span></span>](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-getextent)<br/>                                                          | <span data-ttu-id="5129a-127">只對 >DVASPECT 內容為必要 \_</span><span class="sxs-lookup"><span data-stu-id="5129a-127">Mandatory only for DVASPECT\_CONTENT</span></span><br/>                                |
| [<span data-ttu-id="5129a-128">**SetColorScheme**</span><span class="sxs-lookup"><span data-stu-id="5129a-128">**SetColorScheme**</span></span>](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-setcolorscheme)<br/>                                                | <span data-ttu-id="5129a-129">選擇性</span><span class="sxs-lookup"><span data-stu-id="5129a-129">Optional</span></span><br/>                                                            |
| [<span data-ttu-id="5129a-130">**DoVerb**</span><span class="sxs-lookup"><span data-stu-id="5129a-130">**DoVerb**</span></span>](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-doverb)<br/>                                                                | <span data-ttu-id="5129a-131">請參閱附注1</span><span class="sxs-lookup"><span data-stu-id="5129a-131">See note 1</span></span><br/>                                                          |
| <span data-ttu-id="5129a-132">IOleInPlaceObject</span><span class="sxs-lookup"><span data-stu-id="5129a-132">IOleInPlaceObject</span></span>                                                                                             |                                                                                |
| [<span data-ttu-id="5129a-133">**CoNtextSensitiveHelp**</span><span class="sxs-lookup"><span data-stu-id="5129a-133">**ContextSensitiveHelp**</span></span>](/windows/desktop/api/OleIdl/nf-oleidl-iolewindow-contextsensitivehelp)<br/>                                    | <span data-ttu-id="5129a-134">選擇性</span><span class="sxs-lookup"><span data-stu-id="5129a-134">Optional</span></span><br/>                                                            |
| [<span data-ttu-id="5129a-135">**ReactivateAndUndo**</span><span class="sxs-lookup"><span data-stu-id="5129a-135">**ReactivateAndUndo**</span></span>](/windows/desktop/api/OleIdl/nf-oleidl-ioleinplaceobject-reactivateandundo)<br/>                                   | <span data-ttu-id="5129a-136">選擇性</span><span class="sxs-lookup"><span data-stu-id="5129a-136">Optional</span></span><br/>                                                            |
| <span data-ttu-id="5129a-137">IOleInPlaceActiveObject</span><span class="sxs-lookup"><span data-stu-id="5129a-137">IOleInPlaceActiveObject</span></span>                                                                                       |                                                                                |
| [<span data-ttu-id="5129a-138">**CoNtextSensitiveHelp**</span><span class="sxs-lookup"><span data-stu-id="5129a-138">**ContextSensitiveHelp**</span></span>](/windows/desktop/api/OleIdl/nf-oleidl-iolewindow-contextsensitivehelp)<br/>                                    | <span data-ttu-id="5129a-139">選擇性</span><span class="sxs-lookup"><span data-stu-id="5129a-139">Optional</span></span><br/>                                                            |
| <span data-ttu-id="5129a-140">IViewObject2</span><span class="sxs-lookup"><span data-stu-id="5129a-140">IViewObject2</span></span>                                                                                                  |                                                                                |
| [<span data-ttu-id="5129a-141">**凍結**</span><span class="sxs-lookup"><span data-stu-id="5129a-141">**Freeze**</span></span>](/windows/desktop/api/OleIdl/nf-oleidl-iviewobject-freeze)<br/>                                                               | <span data-ttu-id="5129a-142">選擇性</span><span class="sxs-lookup"><span data-stu-id="5129a-142">Optional</span></span><br/>                                                            |
| [<span data-ttu-id="5129a-143">**解凍**</span><span class="sxs-lookup"><span data-stu-id="5129a-143">**Unfreeze**</span></span>](/windows/desktop/api/OleIdl/nf-oleidl-iviewobject-unfreeze)<br/>                                                           | <span data-ttu-id="5129a-144">選擇性</span><span class="sxs-lookup"><span data-stu-id="5129a-144">Optional</span></span><br/>                                                            |
| [<span data-ttu-id="5129a-145">**GetColorSet**</span><span class="sxs-lookup"><span data-stu-id="5129a-145">**GetColorSet**</span></span>](/windows/desktop/api/OleIdl/nf-oleidl-iviewobject-getcolorset)<br/>                                                     | <span data-ttu-id="5129a-146">選擇性</span><span class="sxs-lookup"><span data-stu-id="5129a-146">Optional</span></span><br/>                                                            |
| <span data-ttu-id="5129a-147">IPersistStream、IPersistStreamInit、IPersistMemory</span><span class="sxs-lookup"><span data-stu-id="5129a-147">IPersistStream, IPersistStreamInit, IPersistMemory</span></span>                                                            |                                                                                |
| [<span data-ttu-id="5129a-148">**GetSizeMax**</span><span class="sxs-lookup"><span data-stu-id="5129a-148">**GetSizeMax**</span></span>](/windows/desktop/api/ObjIdl/nf-objidl-ipersiststream-getsizemax)<br/>                                                    | <span data-ttu-id="5129a-149">請參閱附註 2</span><span class="sxs-lookup"><span data-stu-id="5129a-149">See note 2</span></span><br/>                                                          |



 

1.  <span data-ttu-id="5129a-150">具有屬性頁的控制項必須支援 OLEIVERB 屬性和 OLEIVERB 主要動詞的 [**IOleObject：:D overb**](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-doverb) \_ \_ 。</span><span class="sxs-lookup"><span data-stu-id="5129a-150">A control with property pages must support [**IOleObject::DoVerb**](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-doverb) for the OLEIVERB\_PROPERTIES and OLEIVERB\_PRIMARY verbs.</span></span> <span data-ttu-id="5129a-151">可以是作用中的控制項必須支援 OLEIVERB \_ INPLACEACTI加值稅E 動詞的 DoVerb。</span><span class="sxs-lookup"><span data-stu-id="5129a-151">A control that can be active must support **DoVerb** for the OLEIVERB\_INPLACEACTIVATE verb.</span></span> <span data-ttu-id="5129a-152">可以是 UI 作用中的控制項也必須支援 OLEIVERB \_ UIACTI加值稅E 動詞的 DoVerb。</span><span class="sxs-lookup"><span data-stu-id="5129a-152">A control that can be UI active must also support **DoVerb** for the OLEIVERB\_UIACTIVATE verb.</span></span>
2.  <span data-ttu-id="5129a-153">如果控制項支援 [**IPersistStream**](/windows/desktop/api/ObjIdl/nn-objidl-ipersiststream) 或 [**IPersistStreamInit**](/windows/desktop/api/OCIdl/nn-ocidl-ipersiststreaminit) ，而且可以傳回精確的值，則應該這麼做。</span><span class="sxs-lookup"><span data-stu-id="5129a-153">If a control supports [**IPersistStream**](/windows/desktop/api/ObjIdl/nn-objidl-ipersiststream) or [**IPersistStreamInit**](/windows/desktop/api/OCIdl/nn-ocidl-ipersiststreaminit) and can return an accurate value, then it should do so.</span></span>

## <a name="related-topics"></a><span data-ttu-id="5129a-154">相關主題</span><span class="sxs-lookup"><span data-stu-id="5129a-154">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="5129a-155">控制項</span><span class="sxs-lookup"><span data-stu-id="5129a-155">Controls</span></span>](controls.md)
</dt> </dl>

 

 





