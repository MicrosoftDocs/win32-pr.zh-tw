---
title: MIDL 編譯器
description: MIDL 編譯器
ms.assetid: ce3d40b7-49fd-4689-9100-fdbad4f0c557
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 9fa57131e31e9c6273270a771f9ba862d73bc142
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/21/2020
ms.locfileid: "103683191"
---
# <a name="midl-compiler"></a><span data-ttu-id="c23b0-103">MIDL 編譯器</span><span class="sxs-lookup"><span data-stu-id="c23b0-103">MIDL Compiler</span></span>

<span data-ttu-id="c23b0-104">MIDL 編譯器會處理 IDL 檔案，以產生類型程式庫和輸出檔案。</span><span class="sxs-lookup"><span data-stu-id="c23b0-104">The MIDL compiler processes an IDL file to generate a type library and output files.</span></span> <span data-ttu-id="c23b0-105">MIDL 編譯器所產生之輸出檔的類型取決於 IDL 檔案的介面屬性清單中指定的屬性。</span><span class="sxs-lookup"><span data-stu-id="c23b0-105">The type of output files generated by the MIDL compiler depends on the attributes specified in the IDL file's interface attribute list.</span></span>

<span data-ttu-id="c23b0-106">如果屬性清單包含 \[ [**object**](/windows/desktop/Midl/object) \] 關鍵字，MIDL 編譯器會產生 COM 介面輸出檔案：介面 proxy 檔案、介面標頭檔，以及介面 (GUID) 檔的全域唯一識別碼。</span><span class="sxs-lookup"><span data-stu-id="c23b0-106">If the attribute list contains the \[[**object**](/windows/desktop/Midl/object)\] keyword, the MIDL compiler generates COM interface output files: an interface proxy file, an interface header file, and a globally unique identifier (GUID) file for the interface.</span></span> <span data-ttu-id="c23b0-107">如果 IDL 檔案包含連結 [**庫**](/windows/desktop/Midl/library) 語句，MIDL 會產生具有 .tlb 副檔名的類型程式庫檔案。</span><span class="sxs-lookup"><span data-stu-id="c23b0-107">If the IDL file contains a [**library**](/windows/desktop/Midl/library) statement, MIDL generates a type library file with the .tlb file name extension.</span></span> <span data-ttu-id="c23b0-108">如果 IDL 檔案中有任何介面沒有 \[ **object** \] 關鍵字，且未包含在連結 **庫** 語句中，MIDL 編譯器會針對遠端程序呼叫產生適當的介面輸出檔， (rpc) ：用戶端 stub 檔案、伺服器 stub 檔案和標頭檔。</span><span class="sxs-lookup"><span data-stu-id="c23b0-108">If there are any interfaces in the IDL file that do not have the \[**object**\] keyword and are not enclosed in a **library** statement, the MIDL compiler generates interface output files appropriate for remote procedure calls (RPCs): a client stub file, a server stub file, and a header file.</span></span> <span data-ttu-id="c23b0-109">如需詳細資訊，請參閱主題 [介面定義和類型程式庫](/windows/desktop/Midl/interface-definitions-and-type-libraries) ，以及 [使用 MIDL 產生類型程式庫](/windows/desktop/Midl/generating-a-type-library-with-midl-2)。</span><span class="sxs-lookup"><span data-stu-id="c23b0-109">For more information, see the topics [Interface Definitions and Type Libraries](/windows/desktop/Midl/interface-definitions-and-type-libraries) and [Generating a Type Library with MIDL](/windows/desktop/Midl/generating-a-type-library-with-midl-2).</span></span>

<span data-ttu-id="c23b0-110">從 IDL 檔案產生類型程式庫和輸出檔案：</span><span class="sxs-lookup"><span data-stu-id="c23b0-110">To generate a type library and output files from an IDL file:</span></span>

-   <span data-ttu-id="c23b0-111">從命令提示字元中，執行</span><span class="sxs-lookup"><span data-stu-id="c23b0-111">From the command prompt, run</span></span>

    <span data-ttu-id="c23b0-112">**midl** *檔案名*</span><span class="sxs-lookup"><span data-stu-id="c23b0-112">**midl** *filename*</span></span>

    <span data-ttu-id="c23b0-113">其中 *filename* 是 IDL 檔案的名稱。</span><span class="sxs-lookup"><span data-stu-id="c23b0-113">where *filename* is the name of the IDL file.</span></span>

<span data-ttu-id="c23b0-114">MIDL 編譯器也支援數個選擇性參數。</span><span class="sxs-lookup"><span data-stu-id="c23b0-114">The MIDL compiler also supports several optional parameters.</span></span> <span data-ttu-id="c23b0-115">如需完整清單，請參閱 Visual C++ 檔中的「MIDL Command-Line 參考」，或執行下列命令列：</span><span class="sxs-lookup"><span data-stu-id="c23b0-115">For a complete list, see "MIDL Command-Line Reference" in the Visual C++ documentation, or run the following command line:</span></span>

<span data-ttu-id="c23b0-116">**midl/？**</span><span class="sxs-lookup"><span data-stu-id="c23b0-116">**midl /?**</span></span>

## <a name="related-topics"></a><span data-ttu-id="c23b0-117">相關主題</span><span class="sxs-lookup"><span data-stu-id="c23b0-117">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="c23b0-118">Microsoft 介面定義語言</span><span class="sxs-lookup"><span data-stu-id="c23b0-118">Microsoft Interface Definition Language</span></span>](/windows/desktop/Midl/midl-start-page)
</dt> <dt>

[<span data-ttu-id="c23b0-119">轉換成 c + +</span><span class="sxs-lookup"><span data-stu-id="c23b0-119">Translating to C++</span></span>](translating-to-c--.md)
</dt> </dl>

 

 