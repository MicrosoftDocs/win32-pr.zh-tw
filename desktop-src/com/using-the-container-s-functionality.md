---
title: 使用容器的功能
description: 使用容器的功能
ms.assetid: c660e529-ba1e-4f8e-a86b-7580fa1f592b
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 3afb03ddef96125db184d6e8774997fccf99063b
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/21/2020
ms.locfileid: "104024180"
---
# <a name="using-the-containers-functionality"></a><span data-ttu-id="d1fb0-103">使用容器的功能</span><span class="sxs-lookup"><span data-stu-id="d1fb0-103">Using the Container's Functionality</span></span>

<span data-ttu-id="d1fb0-104">前幾節已說明 ActiveX 控制項必須具有才能存取其容器某些功能的一些必要呼叫端支援。</span><span class="sxs-lookup"><span data-stu-id="d1fb0-104">The previous sections have described some of the necessary caller-side support that an ActiveX control must have in order to access certain features of its container.</span></span> <span data-ttu-id="d1fb0-105">下表說明控制項使用容器端介面的方式，以及何時會發生這種情況。</span><span class="sxs-lookup"><span data-stu-id="d1fb0-105">The following table describes a control's usage of container-side interfaces and when such usage would occur.</span></span>



| <span data-ttu-id="d1fb0-106">介面</span><span class="sxs-lookup"><span data-stu-id="d1fb0-106">Interface</span></span>                                                     | <span data-ttu-id="d1fb0-107">容器物件</span><span class="sxs-lookup"><span data-stu-id="d1fb0-107">Container Object</span></span>    | <span data-ttu-id="d1fb0-108">使用方式</span><span class="sxs-lookup"><span data-stu-id="d1fb0-108">Usage</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|---------------------------------------------------------------|---------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="d1fb0-109">**IOleClientSite**</span><span class="sxs-lookup"><span data-stu-id="d1fb0-109">**IOleClientSite**</span></span>](/windows/desktop/api/OleIdl/nn-oleidl-ioleclientsite)<br/>           | <span data-ttu-id="d1fb0-110">網站</span><span class="sxs-lookup"><span data-stu-id="d1fb0-110">Site</span></span><br/>     | <span data-ttu-id="d1fb0-111">執行 [**IOleObject**](/windows/desktop/api/OleIdl/nn-oleidl-ioleobject) 的控制項會將 [**IOleClientSite**](/windows/desktop/api/OleIdl/nn-oleidl-ioleclientsite) 方法作為標準 OLE 嵌入通訊協定的一部分，特別是 [**SaveObject**](/windows/desktop/api/OleIdl/nf-oleidl-ioleclientsite-saveobject)、 [**ShowObject**](/windows/desktop/api/OleIdl/nf-oleidl-ioleclientsite-showobject)、 ([**OnShowWindow**](/windows/desktop/api/OleIdl/nf-oleidl-ioleclientsite-onshowwindow) 的方法，只有在支援個別視窗啟用狀態的情況下才會) 、 [**RequestNewObjectLayout**](/windows/desktop/api/OleIdl/nf-oleidl-ioleclientsite-requestnewobjectlayout)和 GetContainer (如果) 需要與其他控制項進行通訊。</span><span class="sxs-lookup"><span data-stu-id="d1fb0-111">Controls that implement [**IOleObject**](/windows/desktop/api/OleIdl/nn-oleidl-ioleobject) call [**IOleClientSite**](/windows/desktop/api/OleIdl/nn-oleidl-ioleclientsite) methods as part of the standard OLE embedding protocol, specifically the methods [**SaveObject**](/windows/desktop/api/OleIdl/nf-oleidl-ioleclientsite-saveobject), [**ShowObject**](/windows/desktop/api/OleIdl/nf-oleidl-ioleclientsite-showobject), [**OnShowWindow**](/windows/desktop/api/OleIdl/nf-oleidl-ioleclientsite-onshowwindow) (only if a separate-window activation state is supported), [**RequestNewObjectLayout**](/windows/desktop/api/OleIdl/nf-oleidl-ioleclientsite-requestnewobjectlayout), and GetContainer (if communication with other controls is desired).</span></span> <span data-ttu-id="d1fb0-112">只有當控制項可以連結至外部時，才會使用 [**GetMoniker**](/windows/desktop/api/OleIdl/nf-oleidl-ioleclientsite-getmoniker) 方法，也就是控制項未標記為 OLEMISC \_ CANTLINKINSIDE。</span><span class="sxs-lookup"><span data-stu-id="d1fb0-112">The [**GetMoniker**](/windows/desktop/api/OleIdl/nf-oleidl-ioleclientsite-getmoniker) method is only used when the control can be linked to externally, that is, the control is not marked with OLEMISC\_CANTLINKINSIDE.</span></span><br/> |
| [<span data-ttu-id="d1fb0-113">**IOleInPlaceSite**</span><span class="sxs-lookup"><span data-stu-id="d1fb0-113">**IOleInPlaceSite**</span></span>](/windows/desktop/api/OleIdl/nn-oleidl-ioleinplacesite)<br/>         | <span data-ttu-id="d1fb0-114">網站</span><span class="sxs-lookup"><span data-stu-id="d1fb0-114">Site</span></span><br/>     | <span data-ttu-id="d1fb0-115">具有就地啟用且可能有 UI 作用中狀態的控制項，將會呼叫 [**IOleInPlaceSite**](/windows/desktop/api/OleIdl/nn-oleidl-ioleinplacesite) 方法， (一般都有 [**CoNtextSensitiveHelp**](/windows/desktop/api/OleIdl/nf-oleidl-iolewindow-contextsensitivehelp)) ，因為這是標準 OLE 就地啟用通訊協定的一部分。</span><span class="sxs-lookup"><span data-stu-id="d1fb0-115">Controls that have an in-place activate and possibly a UI active state will call [**IOleInPlaceSite**](/windows/desktop/api/OleIdl/nn-oleidl-ioleinplacesite) methods (generally all of them with the exception of [**ContextSensitiveHelp**](/windows/desktop/api/OleIdl/nf-oleidl-iolewindow-contextsensitivehelp)) as part of the standard OLE in-place activation protocol.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| [<span data-ttu-id="d1fb0-116">**IAdviseSink**</span><span class="sxs-lookup"><span data-stu-id="d1fb0-116">**IAdviseSink**</span></span>](/windows/desktop/api/ObjIdl/nn-objidl-iadvisesink)<br/>                 | <span data-ttu-id="d1fb0-117">網站</span><span class="sxs-lookup"><span data-stu-id="d1fb0-117">Site</span></span><br/>     | <span data-ttu-id="d1fb0-118">控制項呼叫 [**OnDataChange**](/windows/desktop/api/ObjIdl/nf-objidl-iadvisesink-ondatachange) 如果控制項支援 [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject)、 [**OnViewChange**](/windows/desktop/api/ObjIdl/nf-objidl-iadvisesink-onviewchange) （如果控制項支援 [**IViewObject2**](/windows/desktop/api/OleIdl/nn-oleidl-iviewobject2)）、 [**OnClose**](/windows/desktop/api/ObjIdl/nf-objidl-iadvisesink-onclose)、 [**OnSave**](/windows/desktop/api/ObjIdl/nf-objidl-iadvisesink-onsave)和 [**OnRename**](/windows/desktop/api/ObjIdl/nf-objidl-iadvisesink-onrename) （如果控制項支援 [**IOleObject**](/windows/desktop/api/OleIdl/nn-oleidl-ioleobject)）。</span><span class="sxs-lookup"><span data-stu-id="d1fb0-118">Control calls [**OnDataChange**](/windows/desktop/api/ObjIdl/nf-objidl-iadvisesink-ondatachange) if the control supports [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject), [**OnViewChange**](/windows/desktop/api/ObjIdl/nf-objidl-iadvisesink-onviewchange) if the control supports [**IViewObject2**](/windows/desktop/api/OleIdl/nn-oleidl-iviewobject2), and [**OnClose**](/windows/desktop/api/ObjIdl/nf-objidl-iadvisesink-onclose), [**OnSave**](/windows/desktop/api/ObjIdl/nf-objidl-iadvisesink-onsave), and [**OnRename**](/windows/desktop/api/ObjIdl/nf-objidl-iadvisesink-onrename) if the control supports [**IOleObject**](/windows/desktop/api/OleIdl/nn-oleidl-ioleobject).</span></span><br/>                                                                                                                                                                                                                                                                                                           |
| [<span data-ttu-id="d1fb0-119">**>iolecontrolsite**</span><span class="sxs-lookup"><span data-stu-id="d1fb0-119">**IOleControlSite**</span></span>](/windows/desktop/api/OCIdl/nn-ocidl-iolecontrolsite)<br/>         | <span data-ttu-id="d1fb0-120">網站</span><span class="sxs-lookup"><span data-stu-id="d1fb0-120">Site</span></span><br/>     | <span data-ttu-id="d1fb0-121">如果支援，當助憶鍵變更時，會呼叫 [**OnControlInfoChanged**](/windows/desktop/api/OCIdl/nf-ocidl-iolecontrolsite-oncontrolinfochanged) 、 [**LockInPlaceActive**](/windows/desktop/api/OCIdl/nf-ocidl-iolecontrolsite-lockinplaceactive) 和 [**TransformCoords**](/windows/desktop/api/OCIdl/nf-ocidl-iolecontrolsite-transformcoords) ，而如果 (引發事件，則只會使用第二 [**個方法，**](/windows/desktop/api/OCIdl/nf-ocidl-iolecontrolsite-onfocus) [**而如果**](/windows/desktop/api/OCIdl/nf-ocidl-iolecontrolsite-translateaccelerator) 控制項有 UI 作用中狀態，則會使用第二個方法，而如果控制項要查看延伸控制項 (容器擁有的) 屬性，則會) 使用 [**TranslateAccelerator**](/windows/desktop/api/OCIdl/nf-ocidl-iolecontrolsite-getextendedcontrol) 。</span><span class="sxs-lookup"><span data-stu-id="d1fb0-121">If supported, control calls [**OnControlInfoChanged**](/windows/desktop/api/OCIdl/nf-ocidl-iolecontrolsite-oncontrolinfochanged) when mnemonics change, [**LockInPlaceActive**](/windows/desktop/api/OCIdl/nf-ocidl-iolecontrolsite-lockinplaceactive) and [**TransformCoords**](/windows/desktop/api/OCIdl/nf-ocidl-iolecontrolsite-transformcoords) if events are fired (the latter method is only used if coordinates are passed as event arguments), [**OnFocus**](/windows/desktop/api/OCIdl/nf-ocidl-iolecontrolsite-onfocus) and [**TranslateAccelerator**](/windows/desktop/api/OCIdl/nf-ocidl-iolecontrolsite-translateaccelerator) if the control has a UI active state, and [**GetExtendedControl**](/windows/desktop/api/OCIdl/nf-ocidl-iolecontrolsite-getextendedcontrol) if the control wants to look at extended-control (container-owned) properties.</span></span><br/>                                                                       |
| <span data-ttu-id="d1fb0-122">**IDispatch** (環境屬性) </span><span class="sxs-lookup"><span data-stu-id="d1fb0-122">**IDispatch** (ambient properties)</span></span><br/>                 | <span data-ttu-id="d1fb0-123">網站</span><span class="sxs-lookup"><span data-stu-id="d1fb0-123">Site</span></span><br/>     | <span data-ttu-id="d1fb0-124">用來存取環境屬性。</span><span class="sxs-lookup"><span data-stu-id="d1fb0-124">Used to access ambient properties.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| [<span data-ttu-id="d1fb0-125">**IPropertyNotifySink**</span><span class="sxs-lookup"><span data-stu-id="d1fb0-125">**IPropertyNotifySink**</span></span>](/windows/desktop/api/OCIdl/nn-ocidl-ipropertynotifysink)<br/> | <span data-ttu-id="d1fb0-126">不定</span><span class="sxs-lookup"><span data-stu-id="d1fb0-126">Varies</span></span><br/>   | <span data-ttu-id="d1fb0-127">控制項必須針對標記 [](/windows/desktop/api/OCIdl/nf-ocidl-ipropertynotifysink-onchanged)為可系結和要求的任何控制項屬性，分別產生 OnChanged 和 [**OnRequestEdit**](/windows/desktop/api/OCIdl/nf-ocidl-ipropertynotifysink-onrequestedit) \[ [](/windows/desktop/Midl/bindable) \] \[ [](/windows/desktop/Midl/requestedit) \] 。</span><span class="sxs-lookup"><span data-stu-id="d1fb0-127">A control must generate [**OnChanged**](/windows/desktop/api/OCIdl/nf-ocidl-ipropertynotifysink-onchanged) and [**OnRequestEdit**](/windows/desktop/api/OCIdl/nf-ocidl-ipropertynotifysink-onrequestedit) for any control properties that are marked as \[[**bindable**](/windows/desktop/Midl/bindable)\] and \[[**request**](/windows/desktop/Midl/requestedit)\], respectively.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| <span data-ttu-id="d1fb0-128">其他事件接收介面</span><span class="sxs-lookup"><span data-stu-id="d1fb0-128">Other event sink interfaces</span></span><br/>                        | <span data-ttu-id="d1fb0-129">不定</span><span class="sxs-lookup"><span data-stu-id="d1fb0-129">Varies</span></span><br/>   | <span data-ttu-id="d1fb0-130">具有 [**IPropertyNotifySink**](/windows/desktop/api/OCIdl/nn-ocidl-ipropertynotifysink) 以外輸出介面的控制項將會將正確 IID 的其他介面指標遞交給控制項的 [**IConnectionPoint：： Advise**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpoint-advise) 實 (，通常會在控制項) 的子物件中找到。</span><span class="sxs-lookup"><span data-stu-id="d1fb0-130">A control that has outgoing interfaces other than [**IPropertyNotifySink**](/windows/desktop/api/OCIdl/nn-ocidl-ipropertynotifysink) will be handed other interface pointers of the correct IID to the control's [**IConnectionPoint::Advise**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpoint-advise) implementations (which are usually found in sub-objects of the control).</span></span> <span data-ttu-id="d1fb0-131">控制項一律知道如何呼叫其本身的事件介面，因為控制項會定義這些介面。</span><span class="sxs-lookup"><span data-stu-id="d1fb0-131">A control always knows how to call its own event interfaces because the control defines those interfaces.</span></span><br/>                                                                                                                                                                                                                                                                                                              |
| [<span data-ttu-id="d1fb0-132">**IOleInPlaceFrame**</span><span class="sxs-lookup"><span data-stu-id="d1fb0-132">**IOleInPlaceFrame**</span></span>](/windows/desktop/api/OleIdl/nn-oleidl-ioleinplaceframe)<br/>       | <span data-ttu-id="d1fb0-133">Frame</span><span class="sxs-lookup"><span data-stu-id="d1fb0-133">Frame</span></span><br/>    | <span data-ttu-id="d1fb0-134">當控制項具有需要畫面格層級工具或功能表項目的就地 UI 現用狀態時使用。</span><span class="sxs-lookup"><span data-stu-id="d1fb0-134">Used when a control has an in-place UI active state that requires frame-level tools or menu items.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| [<span data-ttu-id="d1fb0-135">**IOleInPlaceUIWindow**</span><span class="sxs-lookup"><span data-stu-id="d1fb0-135">**IOleInPlaceUIWindow**</span></span>](/windows/desktop/api/OleIdl/nn-oleidl-ioleinplaceuiwindow)<br/> | <span data-ttu-id="d1fb0-136">文件</span><span class="sxs-lookup"><span data-stu-id="d1fb0-136">Document</span></span><br/> | <span data-ttu-id="d1fb0-137">只有當控制項具有需要檔層級或窗格層級 UI 工具的就地 UI 現用狀態時，才會使用。</span><span class="sxs-lookup"><span data-stu-id="d1fb0-137">Used only when a control has an in-place UI active state that requires document-level or pane-level UI tools.</span></span> <span data-ttu-id="d1fb0-138">這種情況很罕見。</span><span class="sxs-lookup"><span data-stu-id="d1fb0-138">This is rare.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |



 

## <a name="related-topics"></a><span data-ttu-id="d1fb0-139">相關主題</span><span class="sxs-lookup"><span data-stu-id="d1fb0-139">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="d1fb0-140">控制項</span><span class="sxs-lookup"><span data-stu-id="d1fb0-140">Controls</span></span>](controls.md)
</dt> </dl>

 

