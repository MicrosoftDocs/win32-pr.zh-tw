---
title: 使用容器的功能
description: 使用容器的功能
ms.assetid: c660e529-ba1e-4f8e-a86b-7580fa1f592b
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 9923db1125b432ca3ccce1187adb8b3fb300750c905aa25e4682f10ce106bcb5
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/11/2021
ms.locfileid: "118308832"
---
# <a name="using-the-containers-functionality"></a>使用容器的功能

前幾節說明了 ActiveX 控制項必須具有才能存取其容器某些功能的一些必要呼叫端支援。 下表說明控制項使用容器端介面的方式，以及何時會發生這種情況。



| 介面                                                     | 容器物件    | 使用方式                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|---------------------------------------------------------------|---------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [**IOleClientSite**](/windows/desktop/api/OleIdl/nn-oleidl-ioleclientsite)<br/>           | 網站<br/>     | 執行 [**IOleObject**](/windows/desktop/api/OleIdl/nn-oleidl-ioleobject) 的控制項會將 [**IOleClientSite**](/windows/desktop/api/OleIdl/nn-oleidl-ioleclientsite) 方法作為標準 OLE 嵌入通訊協定的一部分，特別是 [**SaveObject**](/windows/desktop/api/OleIdl/nf-oleidl-ioleclientsite-saveobject)、 [**ShowObject**](/windows/desktop/api/OleIdl/nf-oleidl-ioleclientsite-showobject)、 ([**OnShowWindow**](/windows/desktop/api/OleIdl/nf-oleidl-ioleclientsite-onshowwindow) 的方法，只有在支援個別視窗啟用狀態的情況下才會) 、 [**RequestNewObjectLayout**](/windows/desktop/api/OleIdl/nf-oleidl-ioleclientsite-requestnewobjectlayout)和 GetContainer (如果) 需要與其他控制項進行通訊。 只有當控制項可以連結至外部時，才會使用 [**GetMoniker**](/windows/desktop/api/OleIdl/nf-oleidl-ioleclientsite-getmoniker) 方法，也就是控制項未標記為 OLEMISC \_ CANTLINKINSIDE。<br/> |
| [**IOleInPlaceSite**](/windows/desktop/api/OleIdl/nn-oleidl-ioleinplacesite)<br/>         | 網站<br/>     | 具有就地啟用且可能有 UI 作用中狀態的控制項，將會呼叫 [**IOleInPlaceSite**](/windows/desktop/api/OleIdl/nn-oleidl-ioleinplacesite) 方法， (一般都有 [**CoNtextSensitiveHelp**](/windows/desktop/api/OleIdl/nf-oleidl-iolewindow-contextsensitivehelp)) ，因為這是標準 OLE 就地啟用通訊協定的一部分。<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| [**IAdviseSink**](/windows/desktop/api/ObjIdl/nn-objidl-iadvisesink)<br/>                 | 網站<br/>     | 控制項呼叫 [**OnDataChange**](/windows/desktop/api/ObjIdl/nf-objidl-iadvisesink-ondatachange) 如果控制項支援 [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject)、 [**OnViewChange**](/windows/desktop/api/ObjIdl/nf-objidl-iadvisesink-onviewchange) （如果控制項支援 [**IViewObject2**](/windows/desktop/api/OleIdl/nn-oleidl-iviewobject2)）、 [**OnClose**](/windows/desktop/api/ObjIdl/nf-objidl-iadvisesink-onclose)、 [**OnSave**](/windows/desktop/api/ObjIdl/nf-objidl-iadvisesink-onsave)和 [**OnRename**](/windows/desktop/api/ObjIdl/nf-objidl-iadvisesink-onrename) （如果控制項支援 [**IOleObject**](/windows/desktop/api/OleIdl/nn-oleidl-ioleobject)）。<br/>                                                                                                                                                                                                                                                                                                           |
| [**>iolecontrolsite**](/windows/desktop/api/OCIdl/nn-ocidl-iolecontrolsite)<br/>         | 網站<br/>     | 如果支援，當助憶鍵變更時，會呼叫 [**OnControlInfoChanged**](/windows/desktop/api/OCIdl/nf-ocidl-iolecontrolsite-oncontrolinfochanged) 、 [**LockInPlaceActive**](/windows/desktop/api/OCIdl/nf-ocidl-iolecontrolsite-lockinplaceactive) 和 [**TransformCoords**](/windows/desktop/api/OCIdl/nf-ocidl-iolecontrolsite-transformcoords) ，而如果 (引發事件，則只會使用第二 [**個方法，**](/windows/desktop/api/OCIdl/nf-ocidl-iolecontrolsite-onfocus) [**而如果**](/windows/desktop/api/OCIdl/nf-ocidl-iolecontrolsite-translateaccelerator) 控制項有 UI 作用中狀態，則會使用第二個方法，而如果控制項要查看延伸控制項 (容器擁有的) 屬性，則會) 使用 [**TranslateAccelerator**](/windows/desktop/api/OCIdl/nf-ocidl-iolecontrolsite-getextendedcontrol) 。<br/>                                                                       |
| **IDispatch** (環境屬性) <br/>                 | 網站<br/>     | 用來存取環境屬性。<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| [**IPropertyNotifySink**](/windows/desktop/api/OCIdl/nn-ocidl-ipropertynotifysink)<br/> | 不定<br/>   | 控制項必須針對標記 [](/windows/desktop/api/OCIdl/nf-ocidl-ipropertynotifysink-onchanged)為可系結和要求的任何控制項屬性，分別產生 OnChanged 和 [**OnRequestEdit**](/windows/desktop/api/OCIdl/nf-ocidl-ipropertynotifysink-onrequestedit) \[ [](/windows/desktop/Midl/bindable) \] \[ [](/windows/desktop/Midl/requestedit) \] 。<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| 其他事件接收介面<br/>                        | 不定<br/>   | 具有 [**IPropertyNotifySink**](/windows/desktop/api/OCIdl/nn-ocidl-ipropertynotifysink) 以外輸出介面的控制項將會將正確 IID 的其他介面指標遞交給控制項的 [**IConnectionPoint：： Advise**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpoint-advise) 實 (，通常會在控制項) 的子物件中找到。 控制項一律知道如何呼叫其本身的事件介面，因為控制項會定義這些介面。<br/>                                                                                                                                                                                                                                                                                                              |
| [**IOleInPlaceFrame**](/windows/desktop/api/OleIdl/nn-oleidl-ioleinplaceframe)<br/>       | Frame<br/>    | 當控制項具有需要畫面格層級工具或功能表項目的就地 UI 現用狀態時使用。<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| [**IOleInPlaceUIWindow**](/windows/desktop/api/OleIdl/nn-oleidl-ioleinplaceuiwindow)<br/> | 文件<br/> | 只有當控制項具有需要檔層級或窗格層級 UI 工具的就地 UI 現用狀態時，才會使用。 這種情況很罕見。<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |



 

## <a name="related-topics"></a>相關主題

<dl> <dt>

[控制項](controls.md)
</dt> </dl>

 

