---
title: Windows XP Service Pack 2 和 Windows Server 2003 Service Pack 1 中的 DCOM 安全性增強功能
description: Windows Server XP Service Pack 2 (SP2) 和 Windows Server 2003 Service Pack 1 (SP1) 為分散式元件物件模型 (DCOM) 引進增強的預設安全性設定。
ms.assetid: 1917834c-5216-4ef3-a0c2-d8ca63cef53d
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e4ad51807e27a9b97e8b05e467d8a84881c3993a
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/21/2020
ms.locfileid: "104093367"
---
# <a name="dcom-security-enhancements-in-windows-xp-service-pack-2-and-windows-server-2003-service-pack-1"></a><span data-ttu-id="95ecb-103">Windows XP Service Pack 2 和 Windows Server 2003 Service Pack 1 中的 DCOM 安全性增強功能</span><span class="sxs-lookup"><span data-stu-id="95ecb-103">DCOM Security Enhancements in Windows XP Service Pack 2 and Windows Server 2003 Service Pack 1</span></span>

<span data-ttu-id="95ecb-104">Windows Server XP Service Pack 2 (SP2) 和 Windows Server 2003 Service Pack 1 (SP1) 為分散式元件物件模型 (DCOM) 引進增強的預設安全性設定。</span><span class="sxs-lookup"><span data-stu-id="95ecb-104">Windows Server XP Service Pack 2 (SP2) and Windows Server 2003 Service Pack 1 (SP1) introduce enhanced default security settings for the Distributed Component Object Model (DCOM).</span></span> <span data-ttu-id="95ecb-105">具體來說，他們引進更細微的許可權，讓系統管理員能夠獨立控制本機和遠端許可權，以啟動、啟用和存取 COM 伺服器。</span><span class="sxs-lookup"><span data-stu-id="95ecb-105">Specifically, they introduce more granular rights that enable an administrator to have independent control over local and remote permissions for launching, activating, and accessing COM servers.</span></span>

## <a name="what-does-dcom-do"></a><span data-ttu-id="95ecb-106">DCOM 有哪些功能？</span><span class="sxs-lookup"><span data-stu-id="95ecb-106">What does DCOM do?</span></span>

<span data-ttu-id="95ecb-107">Microsoft 元件物件模型 (COM) 是一種與平臺無關、分散式、物件導向的系統，可用來建立可互動的二進位軟體元件。</span><span class="sxs-lookup"><span data-stu-id="95ecb-107">The Microsoft Component Object Model (COM) is a platform-independent, distributed, object-oriented system for creating binary software components that can interact.</span></span> <span data-ttu-id="95ecb-108">分散式元件物件模型 (DCOM) 可讓應用程式分散到對您和應用程式最有意義的所有位置。</span><span class="sxs-lookup"><span data-stu-id="95ecb-108">The Distributed Component Object Model (DCOM) allows applications to be distributed across locations that make the most sense to you and to the application.</span></span> <span data-ttu-id="95ecb-109">DCOM 有線通訊協定以透明的方式提供 COM 元件之間可靠、安全且有效率的通訊支援。</span><span class="sxs-lookup"><span data-stu-id="95ecb-109">The DCOM wire protocol transparently provides support for reliable, secure, and efficient communication between COM components.</span></span>

## <a name="who-does-this-feature-apply-to"></a><span data-ttu-id="95ecb-110">這項功能的適用物件為何？</span><span class="sxs-lookup"><span data-stu-id="95ecb-110">Who does this feature apply to?</span></span>

<span data-ttu-id="95ecb-111">如果您只將 COM 用於同進程 COM 元件，這項功能就不適用。</span><span class="sxs-lookup"><span data-stu-id="95ecb-111">If you use COM only for in-process COM components, this feature does not apply to you.</span></span>

<span data-ttu-id="95ecb-112">如果您的 COM 伺服器應用程式符合下列其中一個條件，則此功能適用于您：</span><span class="sxs-lookup"><span data-stu-id="95ecb-112">This feature applies to you if you have a COM server application that meets one of the following criteria:</span></span>

-   <span data-ttu-id="95ecb-113">應用程式的存取權限低於啟動許可權，這是執行應用程式所需的許可權。</span><span class="sxs-lookup"><span data-stu-id="95ecb-113">The access permission for the application is less stringent than the launch permission, which is necessary to run the application.</span></span>
-   <span data-ttu-id="95ecb-114">應用程式通常是由遠端 COM 用戶端啟動，而不需要使用系統管理帳戶。</span><span class="sxs-lookup"><span data-stu-id="95ecb-114">The application is usually activated by a remote COM client without using an administrative account.</span></span>
-   <span data-ttu-id="95ecb-115">應用程式僅供本機使用。</span><span class="sxs-lookup"><span data-stu-id="95ecb-115">The application is meant to be used only locally.</span></span> <span data-ttu-id="95ecb-116">這表示您可以限制 COM 伺服器應用程式，使其無法從遠端存取。</span><span class="sxs-lookup"><span data-stu-id="95ecb-116">This means you can restrict your COM server application so it is not remotely accessible.</span></span>

## <a name="what-new-functionality-is-added-to-this-feature-in-windows-xp-service-pack-2-and-windows-server-2003-service-pack-1"></a><span data-ttu-id="95ecb-117">這項功能在 Windows XP Service Pack 2 和 Windows Server 2003 Service Pack 1 中新增了哪些新功能？</span><span class="sxs-lookup"><span data-stu-id="95ecb-117">What new functionality is added to this feature in Windows XP Service Pack 2 and Windows Server 2003 Service Pack 1?</span></span>

### <a name="computer-wide-restrictions"></a><span data-ttu-id="95ecb-118">全電腦限制</span><span class="sxs-lookup"><span data-stu-id="95ecb-118">Computer-wide restrictions</span></span>

<span data-ttu-id="95ecb-119">COM 中的變更是為了提供全電腦存取控制，可控制電腦上所有呼叫、啟動或啟動要求的存取權。</span><span class="sxs-lookup"><span data-stu-id="95ecb-119">A change has been made in COM to provide computer-wide access controls that govern access to all call, activation, or launch requests on the computer.</span></span> <span data-ttu-id="95ecb-120">要考慮這些存取控制的最簡單方式，就是在電腦上每次呼叫、啟動或啟動任何 COM 伺服器時，對整個電腦的存取控制清單進行的額外 [**AccessCheck**](/windows/desktop/api/securitybaseapi/nf-securitybaseapi-accesscheck) 呼叫 (ACL) 。</span><span class="sxs-lookup"><span data-stu-id="95ecb-120">The simplest way to think about these access controls is as an additional [**AccessCheck**](/windows/desktop/api/securitybaseapi/nf-securitybaseapi-accesscheck) call that is done against a computer-wide access control list (ACL) on each call, activation, or launch of any COM server on the computer.</span></span> <span data-ttu-id="95ecb-121">如果 **AccessCheck** 失敗，則會拒絕呼叫、啟用或啟動要求。</span><span class="sxs-lookup"><span data-stu-id="95ecb-121">If the **AccessCheck** fails, the call, activation, or launch request is denied.</span></span> <span data-ttu-id="95ecb-122">這是針對伺服器特定 Acl 執行的任何 **AccessCheck** 以外的功能。</span><span class="sxs-lookup"><span data-stu-id="95ecb-122">This is in addition to any **AccessCheck** that is run against the server-specific ACLs.</span></span> <span data-ttu-id="95ecb-123">實際上，它會提供必須傳遞來存取電腦上任何 COM 伺服器的最低授權標準。</span><span class="sxs-lookup"><span data-stu-id="95ecb-123">In effect, it provides a minimum authorization standard that must be passed to access any COM server on the computer.</span></span> <span data-ttu-id="95ecb-124">有一部全電腦 ACL 可供啟動許可權，以涵蓋啟用和啟動許可權，以及用來取得存取權限的全電腦 ACL ACL 來涵蓋呼叫權利。</span><span class="sxs-lookup"><span data-stu-id="95ecb-124">There is a computer-wide ACL for launch permissions to cover activate and launch rights, and a computer-wide ACL for access permissions to cover call rights.</span></span> <span data-ttu-id="95ecb-125">您可以透過 [元件服務] Microsoft Management Console (MMC) 來設定這些設定。</span><span class="sxs-lookup"><span data-stu-id="95ecb-125">These can be configured through the Component Services Microsoft Management Console (MMC).</span></span>

<span data-ttu-id="95ecb-126">這些全電腦的 Acl 提供一種方式，可透過 [**CoInitializeSecurity**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializesecurity) 或應用程式特定的安全性設定，覆寫特定應用程式所指定的弱式安全性設定。</span><span class="sxs-lookup"><span data-stu-id="95ecb-126">These computer-wide ACLs provide a way to override weak security settings specified by a specific application through [**CoInitializeSecurity**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializesecurity) or application-specific security settings.</span></span> <span data-ttu-id="95ecb-127">這會提供必須通過的最小安全性標準（不論特定伺服器的設定為何）。</span><span class="sxs-lookup"><span data-stu-id="95ecb-127">This provides a minimum security standard that must be passed, regardless of the settings of the specific server.</span></span>

<span data-ttu-id="95ecb-128">當存取由 RPCSS 公開的介面時，會檢查這些 Acl。</span><span class="sxs-lookup"><span data-stu-id="95ecb-128">These ACLs are checked when the interfaces exposed by RPCSS are accessed.</span></span> <span data-ttu-id="95ecb-129">這會提供控制此系統服務存取權的方法。</span><span class="sxs-lookup"><span data-stu-id="95ecb-129">This provides a method to control access to this system service.</span></span>

<span data-ttu-id="95ecb-130">這些 Acl 提供集中的位置，讓系統管理員可以設定套用至電腦上所有 COM 伺服器的一般授權原則。</span><span class="sxs-lookup"><span data-stu-id="95ecb-130">These ACLs provide a centralized location where an administrator can set general authorization policy that applies to all COM servers on the computer.</span></span>

> [!Note]  
> <span data-ttu-id="95ecb-131">變更整部電腦的安全性設定會影響所有的 COM 伺服器應用程式，且可能會讓它們無法正常運作。</span><span class="sxs-lookup"><span data-stu-id="95ecb-131">Changing the computer-wide security settings will affect all COM server applications, and might prevent them from working properly.</span></span> <span data-ttu-id="95ecb-132">如果有 COM 伺服器應用程式的限制低於全電腦限制，則減少整個電腦的限制可能會將這些應用程式公開給不必要的存取。</span><span class="sxs-lookup"><span data-stu-id="95ecb-132">If there are COM server applications that have restrictions that are less stringent than the computer-wide restrictions, reducing the computer-wide restrictions might expose these applications to unwanted access.</span></span> <span data-ttu-id="95ecb-133">相反地，如果您增加全電腦的限制，則呼叫應用程式可能無法再存取某些 COM 伺服器應用程式。</span><span class="sxs-lookup"><span data-stu-id="95ecb-133">Conversely, if you increase the computer-wide restrictions, some COM server applications might no longer be accessible by calling applications.</span></span>

 

<span data-ttu-id="95ecb-134">依預設，Windows XP SP2 電腦限制設定為：</span><span class="sxs-lookup"><span data-stu-id="95ecb-134">By default, Windows XP SP2 computer restriction settings are:</span></span>



| <span data-ttu-id="95ecb-135">權限</span><span class="sxs-lookup"><span data-stu-id="95ecb-135">Permission</span></span>        | <span data-ttu-id="95ecb-136">系統管理員</span><span class="sxs-lookup"><span data-stu-id="95ecb-136">Administrator</span></span>                                                                                             | <span data-ttu-id="95ecb-137">所有人</span><span class="sxs-lookup"><span data-stu-id="95ecb-137">Everyone</span></span>                                            | <span data-ttu-id="95ecb-138">匿名</span><span class="sxs-lookup"><span data-stu-id="95ecb-138">Anonymous</span></span>               |
|-------------------|-----------------------------------------------------------------------------------------------------------|-----------------------------------------------------|-------------------------|
| <span data-ttu-id="95ecb-139">啟動</span><span class="sxs-lookup"><span data-stu-id="95ecb-139">Launch</span></span><br/> | <span data-ttu-id="95ecb-140">本機啟動</span><span class="sxs-lookup"><span data-stu-id="95ecb-140">Local Launch</span></span><br/> <span data-ttu-id="95ecb-141">本機啟用</span><span class="sxs-lookup"><span data-stu-id="95ecb-141">Local Activation</span></span><br/> <span data-ttu-id="95ecb-142">遠端啟動</span><span class="sxs-lookup"><span data-stu-id="95ecb-142">Remote Launch</span></span><br/> <span data-ttu-id="95ecb-143">遠端啟用</span><span class="sxs-lookup"><span data-stu-id="95ecb-143">Remote Activation</span></span><br/> | <span data-ttu-id="95ecb-144">本機啟動</span><span class="sxs-lookup"><span data-stu-id="95ecb-144">Local Launch</span></span><br/> <span data-ttu-id="95ecb-145">本機啟用</span><span class="sxs-lookup"><span data-stu-id="95ecb-145">Local Activation</span></span><br/> |                         |
| <span data-ttu-id="95ecb-146">Access</span><span class="sxs-lookup"><span data-stu-id="95ecb-146">Access</span></span><br/> |                                                                                                           | <span data-ttu-id="95ecb-147">本機存取</span><span class="sxs-lookup"><span data-stu-id="95ecb-147">Local Access</span></span><br/> <span data-ttu-id="95ecb-148">遠端存取</span><span class="sxs-lookup"><span data-stu-id="95ecb-148">Remote Access</span></span><br/>    | <span data-ttu-id="95ecb-149">本機存取</span><span class="sxs-lookup"><span data-stu-id="95ecb-149">Local Access</span></span><br/> |



 

<span data-ttu-id="95ecb-150">依預設，Windows Server 2003 SP 1 電腦限制設定如下。</span><span class="sxs-lookup"><span data-stu-id="95ecb-150">By default, Windows Server 2003 SP 1 computer restriction settings are as follows.</span></span>



| <span data-ttu-id="95ecb-151">權限</span><span class="sxs-lookup"><span data-stu-id="95ecb-151">Permission</span></span>        | <span data-ttu-id="95ecb-152">系統管理員</span><span class="sxs-lookup"><span data-stu-id="95ecb-152">Administrator</span></span>                                                                                             | <span data-ttu-id="95ecb-153"> (內建群組) 的分散式 COM 使用者</span><span class="sxs-lookup"><span data-stu-id="95ecb-153">Distributed COM Users (Built in Group)</span></span>                                                                    | <span data-ttu-id="95ecb-154">所有人</span><span class="sxs-lookup"><span data-stu-id="95ecb-154">Everyone</span></span>                                            | <span data-ttu-id="95ecb-155">匿名</span><span class="sxs-lookup"><span data-stu-id="95ecb-155">Anonymous</span></span>                                        |
|-------------------|-----------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------|-----------------------------------------------------|--------------------------------------------------|
| <span data-ttu-id="95ecb-156">啟動</span><span class="sxs-lookup"><span data-stu-id="95ecb-156">Launch</span></span><br/> | <span data-ttu-id="95ecb-157">本機啟動</span><span class="sxs-lookup"><span data-stu-id="95ecb-157">Local Launch</span></span><br/> <span data-ttu-id="95ecb-158">本機啟用</span><span class="sxs-lookup"><span data-stu-id="95ecb-158">Local Activation</span></span><br/> <span data-ttu-id="95ecb-159">遠端啟動</span><span class="sxs-lookup"><span data-stu-id="95ecb-159">Remote Launch</span></span><br/> <span data-ttu-id="95ecb-160">遠端啟用</span><span class="sxs-lookup"><span data-stu-id="95ecb-160">Remote Activation</span></span><br/> | <span data-ttu-id="95ecb-161">本機啟動</span><span class="sxs-lookup"><span data-stu-id="95ecb-161">Local Launch</span></span><br/> <span data-ttu-id="95ecb-162">本機啟用</span><span class="sxs-lookup"><span data-stu-id="95ecb-162">Local Activation</span></span><br/> <span data-ttu-id="95ecb-163">遠端啟動</span><span class="sxs-lookup"><span data-stu-id="95ecb-163">Remote Launch</span></span><br/> <span data-ttu-id="95ecb-164">遠端啟用</span><span class="sxs-lookup"><span data-stu-id="95ecb-164">Remote Activation</span></span><br/> | <span data-ttu-id="95ecb-165">本機啟動</span><span class="sxs-lookup"><span data-stu-id="95ecb-165">Local Launch</span></span><br/> <span data-ttu-id="95ecb-166">本機啟用</span><span class="sxs-lookup"><span data-stu-id="95ecb-166">Local Activation</span></span><br/> | <span data-ttu-id="95ecb-167">N/A</span><span class="sxs-lookup"><span data-stu-id="95ecb-167">N/A</span></span><br/>                                   |
| <span data-ttu-id="95ecb-168">Access</span><span class="sxs-lookup"><span data-stu-id="95ecb-168">Access</span></span><br/> | <span data-ttu-id="95ecb-169">N/A</span><span class="sxs-lookup"><span data-stu-id="95ecb-169">N/A</span></span><br/>                                                                                            | <span data-ttu-id="95ecb-170">本機存取</span><span class="sxs-lookup"><span data-stu-id="95ecb-170">Local Access</span></span><br/> <span data-ttu-id="95ecb-171">遠端存取</span><span class="sxs-lookup"><span data-stu-id="95ecb-171">Remote Access</span></span><br/>                                                          | <span data-ttu-id="95ecb-172">本機存取</span><span class="sxs-lookup"><span data-stu-id="95ecb-172">Local Access</span></span><br/> <span data-ttu-id="95ecb-173">遠端存取</span><span class="sxs-lookup"><span data-stu-id="95ecb-173">Remote Access</span></span><br/>    | <span data-ttu-id="95ecb-174">本機存取</span><span class="sxs-lookup"><span data-stu-id="95ecb-174">Local Access</span></span><br/> <span data-ttu-id="95ecb-175">遠端存取</span><span class="sxs-lookup"><span data-stu-id="95ecb-175">Remote Access</span></span><br/> |



 

> [!Note]  
> <span data-ttu-id="95ecb-176">Distributed COM Users 是 Windows Server 2003 SP1 隨附的新內建組，可加速將使用者新增至 DCOM 電腦限制設定的程式。</span><span class="sxs-lookup"><span data-stu-id="95ecb-176">Distributed COM Users is a new built-in group included with Windows Server 2003 SP1 to expedite the process of adding users to the DCOM computer restriction settings.</span></span> <span data-ttu-id="95ecb-177">此群組是 [MachineAccessRestriction](machineaccessrestriction.md) 和 [MachineLaunchRestriction](machinelaunchrestriction.md) 設定所使用 ACL 的一部分，因此從此群組移除使用者將會影響這些設定。</span><span class="sxs-lookup"><span data-stu-id="95ecb-177">This group is part of the ACL used by the [MachineAccessRestriction](machineaccessrestriction.md) and [MachineLaunchRestriction](machinelaunchrestriction.md) settings, so removing users from this group will affect those settings.</span></span>

 

### <a name="why-is-this-change-important-what-threats-does-it-help-mitigate"></a><span data-ttu-id="95ecb-178">為什麼此變更很重要？</span><span class="sxs-lookup"><span data-stu-id="95ecb-178">Why is this change important?</span></span> <span data-ttu-id="95ecb-179">它有助於減輕哪些威脅？</span><span class="sxs-lookup"><span data-stu-id="95ecb-179">What threats does it help mitigate?</span></span>

<span data-ttu-id="95ecb-180">許多 COM 應用程式都包含一些安全性特定的程式碼 (例如，呼叫 [**CoInitializeSecurity**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializesecurity)) ，但使用弱式設定，通常允許未經驗證的進程存取。</span><span class="sxs-lookup"><span data-stu-id="95ecb-180">Many COM applications include some security-specific code (for example, calling [**CoInitializeSecurity**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializesecurity)), but use weak settings, often allowing unauthenticated access to the process.</span></span> <span data-ttu-id="95ecb-181">目前沒有任何方法可讓系統管理員覆寫這些設定，以在舊版 Windows 中強制執行更強的安全性。</span><span class="sxs-lookup"><span data-stu-id="95ecb-181">There is currently no way for an administrator to override these settings to force stronger security in earlier versions of Windows.</span></span>

<span data-ttu-id="95ecb-182">COM 基礎結構包含了 RPCSS，也就是在系統啟動期間執行的系統服務，並且一律會在該時間執行。</span><span class="sxs-lookup"><span data-stu-id="95ecb-182">COM infrastructure includes the RPCSS, a system service that runs during system startup and always runs after that.</span></span> <span data-ttu-id="95ecb-183">它會管理 COM 物件的啟用和執行中的物件表，並提供 helper 服務給 DCOM 遠端處理。</span><span class="sxs-lookup"><span data-stu-id="95ecb-183">It manages activation of COM objects and the running object table and provides helper services to DCOM remoting.</span></span> <span data-ttu-id="95ecb-184">它會公開可從遠端呼叫的 RPC 介面。</span><span class="sxs-lookup"><span data-stu-id="95ecb-184">It exposes RPC interfaces that can be called remotely.</span></span> <span data-ttu-id="95ecb-185">因為某些 COM 伺服器允許未經驗證的遠端存取，所以任何人都可以呼叫這些介面，包括未經驗證的使用者。</span><span class="sxs-lookup"><span data-stu-id="95ecb-185">Because some COM servers allow unauthenticated remote access, these interfaces can be called by anyone, including unauthenticated users.</span></span> <span data-ttu-id="95ecb-186">如此一來，在遠端、未經驗證的電腦上，惡意使用者可能會攻擊 RPCSS。</span><span class="sxs-lookup"><span data-stu-id="95ecb-186">As a result, RPCSS can be attacked by malicious users on remote, unauthenticated computers.</span></span>

<span data-ttu-id="95ecb-187">在舊版的 Windows 中，系統管理員無法瞭解電腦上 COM 伺服器的暴露程度。</span><span class="sxs-lookup"><span data-stu-id="95ecb-187">In earlier versions of Windows, there was no way for an administrator to understand the exposure level of the COM servers on a computer.</span></span> <span data-ttu-id="95ecb-188">系統管理員可以有系統地檢查電腦上所有已註冊 COM 應用程式的已設定安全性設定，但假設 Windows 的預設安裝中有大約150的 COM 伺服器，這項工作會很困難。</span><span class="sxs-lookup"><span data-stu-id="95ecb-188">An administrator got an idea of the exposure level by systematically checking the configured security settings for all the registered COM applications on the computer, but, given that there are about 150 COM servers in a default installation of Windows, that task was daunting.</span></span> <span data-ttu-id="95ecb-189">沒有任何方法可以查看在軟體中納入安全性的伺服器設定，而不需要複習該軟體的原始程式碼。</span><span class="sxs-lookup"><span data-stu-id="95ecb-189">There was no way to view the settings for a server that incorporates security in the software, short of reviewing the source code for that software.</span></span>

<span data-ttu-id="95ecb-190">DCOM 全電腦限制減輕這三個問題。</span><span class="sxs-lookup"><span data-stu-id="95ecb-190">DCOM computer-wide restrictions mitigate these three problems.</span></span> <span data-ttu-id="95ecb-191">它也可讓系統管理員停用連入 DCOM 啟用、啟動和呼叫的功能。</span><span class="sxs-lookup"><span data-stu-id="95ecb-191">It also gives an administrator the capability to disable incoming DCOM activation, launch, and calls.</span></span>

### <a name="what-works-differently"></a><span data-ttu-id="95ecb-192">有哪些不同？</span><span class="sxs-lookup"><span data-stu-id="95ecb-192">What works differently?</span></span>

<span data-ttu-id="95ecb-193">依預設，Everyone 群組會被授與本機啟動、本機啟用和本機存取呼叫許可權。</span><span class="sxs-lookup"><span data-stu-id="95ecb-193">By default, the Everyone group is granted local launch, local activation, and local access call permissions.</span></span> <span data-ttu-id="95ecb-194">如此一來，所有的本機案例都可以在不修改軟體或作業系統的情況下運作。</span><span class="sxs-lookup"><span data-stu-id="95ecb-194">This enables all local scenarios to work without modification to the software or the operating system.</span></span>

<span data-ttu-id="95ecb-195">依預設，在 Windows XP SP2 中，Everyone 群組會被授與遠端存取呼叫許可權。</span><span class="sxs-lookup"><span data-stu-id="95ecb-195">By default, in Windows XP SP2, the Everyone group is granted remote access call permissions.</span></span> <span data-ttu-id="95ecb-196">在 Windows Server 2003 SP1 中，每個人和匿名群組都會被授與遠端存取許可權。</span><span class="sxs-lookup"><span data-stu-id="95ecb-196">In Windows Server 2003 SP1, the Everyone and Anonymous groups are granted remote access permissions.</span></span> <span data-ttu-id="95ecb-197">這會啟用大部分的 COM 用戶端案例，包括 COM 用戶端將本機參考傳遞到遠端伺服器的常見案例，實際上會將用戶端變成伺服器。</span><span class="sxs-lookup"><span data-stu-id="95ecb-197">This enables most COM client scenarios, including the common case where a COM client passes a local reference to a remote server, in effect turning the client into a server.</span></span> <span data-ttu-id="95ecb-198">在 Windows XP SP2 中，這可能會停用需要未經驗證的遠端存取呼叫的案例。</span><span class="sxs-lookup"><span data-stu-id="95ecb-198">In Windows XP SP2, this might disable scenarios that require unauthenticated remote access calls.</span></span>

<span data-ttu-id="95ecb-199">此外，根據預設，只有 Administrators 群組的成員會被授與「遠端啟用」和「啟動」許可權。</span><span class="sxs-lookup"><span data-stu-id="95ecb-199">Also by default, only members of the Administrators group are granted remote activation and launch permissions.</span></span> <span data-ttu-id="95ecb-200">這會禁止非系統管理員對安裝的 COM 伺服器進行遠端啟用。</span><span class="sxs-lookup"><span data-stu-id="95ecb-200">This disables remote activations by non-administrators to installed COM servers.</span></span>

### <a name="how-do-i-resolve-these-issues"></a><span data-ttu-id="95ecb-201">我該如何解決這些問題？</span><span class="sxs-lookup"><span data-stu-id="95ecb-201">How do I resolve these issues?</span></span>

<span data-ttu-id="95ecb-202">如果您執行 COM 伺服器，並預期不會由非系統管理的 COM 用戶端進行遠端啟用，則您應該考慮啟用此程式所產生的風險是否可接受，或者，如果您應該修改您的執行，不需要由非系統管理的 COM 用戶端或遠端未經驗證的呼叫進行遠端啟用。</span><span class="sxs-lookup"><span data-stu-id="95ecb-202">If you implement a COM server and expect to support remote activation by a non-administrative COM client, then you should consider whether the risk associated with enabling this process is acceptable or if you should modify your implementation to not require remote activation by a non-administrative COM client or remote unauthenticated calls.</span></span>

<span data-ttu-id="95ecb-203">如果風險是可接受的，而您想要透過非系統管理的 COM 用戶端或遠端未驗證的呼叫來啟用遠端啟用，則必須變更這項功能的預設設定。</span><span class="sxs-lookup"><span data-stu-id="95ecb-203">If the risk is acceptable and you want to enable remote activation by a non-administrative COM client or remote unauthenticated calls, you must change the default configuration for this feature.</span></span>

> [!Note]  
> <span data-ttu-id="95ecb-204">變更整部電腦的安全性設定會影響所有的 COM 伺服器應用程式，且可能會讓它們無法正常運作。</span><span class="sxs-lookup"><span data-stu-id="95ecb-204">Changing the computer-wide security settings will affect all COM server applications, and might prevent them from working properly.</span></span> <span data-ttu-id="95ecb-205">如果有 COM 伺服器應用程式的限制低於全電腦限制，則減少整個電腦的限制可能會將這些應用程式公開給不必要的存取。</span><span class="sxs-lookup"><span data-stu-id="95ecb-205">If there are COM server applications that have restrictions that are less stringent than the computer-wide restrictions, reducing the computer-wide restrictions may expose these applications to unwanted access.</span></span> <span data-ttu-id="95ecb-206">相反地，如果您增加全電腦的限制，則呼叫應用程式可能無法再存取某些 COM 伺服器應用程式。</span><span class="sxs-lookup"><span data-stu-id="95ecb-206">Conversely, if you increase the computer-wide restrictions, some COM server applications might no longer be accessible by calling applications.</span></span>

 

<span data-ttu-id="95ecb-207">您可以使用 [元件服務 Microsoft Management Console (MMC) 或 Windows 登錄來變更設定設定。</span><span class="sxs-lookup"><span data-stu-id="95ecb-207">You can change the configuration settings using either the Component Services Microsoft Management Console (MMC) or the Windows registry.</span></span>

<span data-ttu-id="95ecb-208">如果您使用 [元件 **服務] mmc** 嵌入式管理單元，可以在您要管理的電腦上，于 [內容] 對話方塊的 [ **COM 安全性**] 索引標籤上設定這些設定。</span><span class="sxs-lookup"><span data-stu-id="95ecb-208">If you use the Component Services MMC snap-in, these settings can be configured on the **COM Security** tab of the **Properties** dialog box for the computer you are managing.</span></span> <span data-ttu-id="95ecb-209">[ **存取權限** ] 區域已經過修改，可讓您除了 COM 伺服器的標準預設設定以外，設定整個電腦的限制。</span><span class="sxs-lookup"><span data-stu-id="95ecb-209">The **Access Permissions** area has been modified to enable you to set computer-wide limits in addition to the standard default settings for COM servers.</span></span> <span data-ttu-id="95ecb-210">此外，您可以在 [限制] 和 [預設值] 下，為本機和遠端存取提供個別的 ACL 設定。</span><span class="sxs-lookup"><span data-stu-id="95ecb-210">Additionally, you can provide separate ACL settings for local and remote access under both limits and defaults.</span></span>

<span data-ttu-id="95ecb-211">在 [ **啟動和啟用許可權** ] 區域中，您可以控制本機和遠端許可權，以及整個電腦的限制和預設值。</span><span class="sxs-lookup"><span data-stu-id="95ecb-211">In the **Launch and Activation Permissions** area, you can control the local and remote permissions as well as the computer-wide limits and the defaults.</span></span> <span data-ttu-id="95ecb-212">您可以單獨指定本機和遠端啟用和啟動許可權。</span><span class="sxs-lookup"><span data-stu-id="95ecb-212">You can specify both local and remote activation and launch permissions independently.</span></span>

<span data-ttu-id="95ecb-213">或者，您也可以使用登錄來設定這些 ACL 設定。</span><span class="sxs-lookup"><span data-stu-id="95ecb-213">Alternatively, you can configure these ACL settings using the registry.</span></span>

<span data-ttu-id="95ecb-214">這些 Acl 會儲存在登錄中的下列位置：</span><span class="sxs-lookup"><span data-stu-id="95ecb-214">These ACLs are stored in the registry at the following locations:</span></span>

``` syntax
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Ole\MachineAccessRestriction=ACL
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Ole\MachineLaunchRestriction=ACL
```

<span data-ttu-id="95ecb-215">這些是型別為 REG BINARY 的值 \_ ，其中包含描述可存取電腦上任何 com 類別或 com 物件之主體 ACL 的資料。</span><span class="sxs-lookup"><span data-stu-id="95ecb-215">These are named values of type REG\_BINARY that contain data that describe the ACL of the principals that can access any COM class or COM object on the computer.</span></span> <span data-ttu-id="95ecb-216">ACL 中的存取權限為：</span><span class="sxs-lookup"><span data-stu-id="95ecb-216">The access rights in the ACL are:</span></span>

``` syntax
COM_RIGHTS_EXECUTE 1
COM_RIGHTS_EXECUTE_LOCAL 2
COM_RIGHTS_EXECUTE_REMOTE 4
COM_RIGHTS_ACTIVATE_LOCAL 8
COM_RIGHTS_ACTIVATE_REMOTE 16
```

<span data-ttu-id="95ecb-217">您可以使用一般安全性功能來建立這些 Acl。</span><span class="sxs-lookup"><span data-stu-id="95ecb-217">These ACLs can be created using normal security functions.</span></span>

> [!Note]  
> <span data-ttu-id="95ecb-218">為了提供回溯相容性，ACL 可以有 Windows XP SP2 和 Windows Server 2003 SP1 之前使用的格式，它只會使用存取權限的許可權 \_ \_ 執行，或者可以存在於 WINDOWS XP SP2 和 windows SERVER 2003 SP1 中使用的新格式，此格式會 \_ \_ 搭配 com 許可權 \_ \_ 執行 \_ 本機、com \_ 許可權 \_ 執行 \_ 遠端、com \_ 許可權 \_ 啟用 \_ 本機和 com \_ 許可權 \_ 啟用 \_ 遠端。</span><span class="sxs-lookup"><span data-stu-id="95ecb-218">To provide backward compatibility, an ACL can exist in the format used before Windows XP SP2 and Windows Server 2003 SP1, which uses only the access right COM\_RIGHTS\_EXECUTE, or it can exist in the new format used in Windows XP SP2 and Windows Server 2003 SP1, which uses COM\_RIGHTS\_EXECUTE together with a combination of COM\_RIGHTS\_EXECUTE\_LOCAL, COM\_RIGHTS\_EXECUTE\_REMOTE, COM\_RIGHTS\_ACTIVATE\_LOCAL, and COM\_RIGHTS\_ACTIVATE\_REMOTE.</span></span> <span data-ttu-id="95ecb-219">請注意，「COM \_ 許可權 \_ 執行」> 一定要存在，但不存在此許可權會產生不正確安全描述項。</span><span class="sxs-lookup"><span data-stu-id="95ecb-219">Note that COM\_RIGHTS\_EXECUTE> must always be present; the absence of this right generates an invalid security descriptor.</span></span> <span data-ttu-id="95ecb-220">另請注意，您不能在單一 ACL 內混用舊格式和新格式; (Ace 的所有存取控制專案) 必須僅授與 COM \_ 許可權 \_ 執行存取權限，或全部都必須授與 com 許可權執行、com rights \_ \_ execute、 \_ \_ \_ com \_ rights \_ execute \_ remote、com \_ rights \_ activate \_ 本機和 com 許可權 \_ \_ 啟用 \_ 遠端的組合。</span><span class="sxs-lookup"><span data-stu-id="95ecb-220">Also note that you must not mix the old format and the new format within a single ACL; either all access control entries (ACEs) must grant only the COM\_RIGHTS\_EXECUTE access right, or they all must grant COM\_RIGHTS\_EXECUTE together with a combination of COM\_RIGHTS\_EXECUTE\_LOCAL, COM\_RIGHTS\_EXECUTE\_REMOTE, COM\_RIGHTS\_ACTIVATE\_LOCAL, and COM\_RIGHTS\_ACTIVATE\_REMOTE.</span></span>

 

> [!Note]  
> <span data-ttu-id="95ecb-221">只有具備系統管理員許可權的使用者可以修改這些設定。</span><span class="sxs-lookup"><span data-stu-id="95ecb-221">Only users with Administrator rights can modify these settings.</span></span>

 

## <a name="what-existing-functionality-is-changing-in-windows-xp-service-pack-2-and-windows-server-2003-service-pack-1"></a><span data-ttu-id="95ecb-222">Windows XP Service Pack 2 和 Windows Server 2003 Service Pack 1 中的現有功能有哪些變更？</span><span class="sxs-lookup"><span data-stu-id="95ecb-222">What existing functionality is changing in Windows XP Service Pack 2 and Windows Server 2003 Service Pack 1?</span></span>

### <a name="rpcss-runs-as-a-network-service"></a><span data-ttu-id="95ecb-223">以網路服務的形式執行 RPCSS</span><span class="sxs-lookup"><span data-stu-id="95ecb-223">RPCSS runs as a network service</span></span>

<span data-ttu-id="95ecb-224">RPCSS 是 RPC 端點對應程式和 DCOM 基礎結構的重要服務。</span><span class="sxs-lookup"><span data-stu-id="95ecb-224">RPCSS is a key service for the RPC Endpoint Mapper and DCOM infrastructure.</span></span> <span data-ttu-id="95ecb-225">這項服務在舊版 Windows 中以本機系統的形式執行。</span><span class="sxs-lookup"><span data-stu-id="95ecb-225">This service ran as Local System in previous versions of Windows.</span></span> <span data-ttu-id="95ecb-226">為了減少 Windows 的受攻擊面並提供深度防禦，RPCSS 服務功能已分割成兩個服務。</span><span class="sxs-lookup"><span data-stu-id="95ecb-226">To reduce the attack surface of Windows and provide defense in depth, the RPCSS service functionality was split into two services.</span></span> <span data-ttu-id="95ecb-227">具有所有原始功能但不需要本機系統許可權的 RPCSS 服務，現在會在 Network Service 帳戶下執行。</span><span class="sxs-lookup"><span data-stu-id="95ecb-227">The RPCSS service with all the original functionality that did not require Local System privileges now runs under the Network Service account.</span></span> <span data-ttu-id="95ecb-228">新的 DCOMLaunch 服務，其中包含需要在本機系統帳戶下執行本機系統許可權的功能。</span><span class="sxs-lookup"><span data-stu-id="95ecb-228">A new DCOMLaunch service that includes functionality that requires Local System privileges runs under the Local System account.</span></span>

### <a name="why-is-this-change-important"></a><span data-ttu-id="95ecb-229">為什麼此變更很重要？</span><span class="sxs-lookup"><span data-stu-id="95ecb-229">Why is this change important?</span></span>

<span data-ttu-id="95ecb-230">這項變更可減少受攻擊面，並為 RPCSS 服務提供深度防禦，因為在 RPCSS 服務中的權限提高現在僅限於 Network Service 許可權。</span><span class="sxs-lookup"><span data-stu-id="95ecb-230">This change reduces the attack surface and provides defense in depth for the RPCSS service because an elevation of privilege in the RPCSS service is now limited to the Network Service privilege.</span></span>

### <a name="what-works-differently"></a><span data-ttu-id="95ecb-231">有哪些不同？</span><span class="sxs-lookup"><span data-stu-id="95ecb-231">What works differently?</span></span>

<span data-ttu-id="95ecb-232">這項變更對使用者來說應該是透明的，因為 RPCSS 和 DCOMLaunch 服務的組合相當於舊版 Windows 中提供的先前的「RPCSS」服務。</span><span class="sxs-lookup"><span data-stu-id="95ecb-232">This change should be transparent to users because the combination of the RPCSS and DCOMLaunch services is equivalent to the previous RPCSS service provided in prior versions of Windows.</span></span>

### <a name="more-specific-com-permissions"></a><span data-ttu-id="95ecb-233">更特定的 COM 許可權</span><span class="sxs-lookup"><span data-stu-id="95ecb-233">More specific COM permissions</span></span>

<span data-ttu-id="95ecb-234">COM 伺服器應用程式有兩種類型的許可權：啟動許可權與存取權限。</span><span class="sxs-lookup"><span data-stu-id="95ecb-234">COM server applications have two types of permissions: launch permissions and access permissions.</span></span> <span data-ttu-id="95ecb-235">如果伺服器尚未執行，請在 COM 啟用期間啟動 COM 伺服器的啟動許可權控制授權。</span><span class="sxs-lookup"><span data-stu-id="95ecb-235">Launch permissions control authorization to start a COM server during COM activation if the server is not already running.</span></span> <span data-ttu-id="95ecb-236">這些許可權定義為登錄設定中所指定的安全描述項。</span><span class="sxs-lookup"><span data-stu-id="95ecb-236">These permissions are defined as security descriptors that are specified in registry settings.</span></span> <span data-ttu-id="95ecb-237">存取權限控制授權，以呼叫執行中的 COM 伺服器。</span><span class="sxs-lookup"><span data-stu-id="95ecb-237">Access permissions control authorization to call a running COM server.</span></span> <span data-ttu-id="95ecb-238">這些許可權是透過 [**CoInitializeSecurity**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializesecurity) API 或使用登錄設定，定義為 COM 基礎結構所提供的安全描述項。</span><span class="sxs-lookup"><span data-stu-id="95ecb-238">These permissions are defined as security descriptors provided to the COM infrastructure through the [**CoInitializeSecurity**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializesecurity) API, or using registry settings.</span></span> <span data-ttu-id="95ecb-239">[啟動] 和 [存取權限] 都可根據主體來允許或拒絕存取，而且與呼叫端是否為伺服器或遠端的本機不區分。</span><span class="sxs-lookup"><span data-stu-id="95ecb-239">Both launch and access permissions allow or deny access based on principals, and make no distinction as to whether the caller is local to the server or remote.</span></span>

<span data-ttu-id="95ecb-240">第一個變更會根據距離來區分 COM 存取權限。</span><span class="sxs-lookup"><span data-stu-id="95ecb-240">The first change distinguishes the COM access rights, based on distance.</span></span> <span data-ttu-id="95ecb-241">這兩個定義的距離是本機和遠端。</span><span class="sxs-lookup"><span data-stu-id="95ecb-241">The two distances that are defined are Local and Remote.</span></span> <span data-ttu-id="95ecb-242">本機 COM 訊息會透過本機遠端程序呼叫來 (LRPC) 通訊協定，而遠端 COM 訊息則是透過遠端過程)  (調用（例如傳輸控制通訊協定 (TCP) ）來送達。</span><span class="sxs-lookup"><span data-stu-id="95ecb-242">A Local COM message arrives by way of the Local Remote Procedure Call (LRPC) protocol, while a Remote COM message arrives by way of a remote procedure call (RPC) host protocol like transmission control protocol (TCP).</span></span>

<span data-ttu-id="95ecb-243">COM 啟動是指在用戶端上呼叫 [**CoCreateInstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance) 或其中一個變體來取得 COM 介面 proxy 的動作。</span><span class="sxs-lookup"><span data-stu-id="95ecb-243">COM activation is the act of getting a COM interface proxy on a client by calling [**CoCreateInstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance) or one of its variants.</span></span> <span data-ttu-id="95ecb-244">這項啟用程式的副作用是，有時候必須啟動 COM 伺服器才能完成用戶端的要求。</span><span class="sxs-lookup"><span data-stu-id="95ecb-244">As a side effect of this activation process, sometimes a COM server must be started to fulfill the client's request.</span></span> <span data-ttu-id="95ecb-245">啟用 COM 伺服器的啟動許可權 ACL 判斷提示。</span><span class="sxs-lookup"><span data-stu-id="95ecb-245">A launch permissions ACL asserts who is allowed to start a COM server.</span></span> <span data-ttu-id="95ecb-246">存取權限 ACL 判斷提示，該物件可在 COM 伺服器已執行之後，啟用 COM 物件或呼叫該物件。</span><span class="sxs-lookup"><span data-stu-id="95ecb-246">An access permissions ACL asserts who is allowed to activate a COM object or call that object once the COM server is already running.</span></span>

<span data-ttu-id="95ecb-247">第二項變更是將呼叫和啟用許可權分開，以反映兩個不同的作業，並將啟用許可權從存取權限 ACL 移至啟動許可權 ACL。</span><span class="sxs-lookup"><span data-stu-id="95ecb-247">The second change is that the call and activation rights are separated to reflect to two distinct operations and to move the activation right from the access permission ACL to the launch permission ACL.</span></span> <span data-ttu-id="95ecb-248">因為啟用和啟動都與取得介面指標相關，所以啟用和啟動存取權限在邏輯上會以單一 ACL 的方式組成。</span><span class="sxs-lookup"><span data-stu-id="95ecb-248">Because activation and launching are both related to acquiring an interface pointer, activation and launch access rights logically belong together in one ACL.</span></span> <span data-ttu-id="95ecb-249">而且，由於您一律透過設定 (指定啟動許可權，相較于以程式設計方式指定的存取權限（通常是以程式設計的方式) ，因此在啟動許可權 ACL 中放置啟用許可權可提供系統管理員對啟用的控制權）。</span><span class="sxs-lookup"><span data-stu-id="95ecb-249">And because you always specify launch permissions through configuration (as compared to access permissions, which are often specified programmatically), putting the activation rights in the launch permission ACL provides the administrator with control over activation.</span></span>

<span data-ttu-id="95ecb-250"> (Ace) 的啟動許可權存取控制專案會分成四個存取權限：</span><span class="sxs-lookup"><span data-stu-id="95ecb-250">The launch permission access control entries (ACEs) are broken into four access rights:</span></span>

-   <span data-ttu-id="95ecb-251">本機啟動 (LL) </span><span class="sxs-lookup"><span data-stu-id="95ecb-251">Local Launch (LL)</span></span>
-   <span data-ttu-id="95ecb-252">遠端啟動 (RL) </span><span class="sxs-lookup"><span data-stu-id="95ecb-252">Remote Launch (RL)</span></span>
-   <span data-ttu-id="95ecb-253">本機啟用 (LA) </span><span class="sxs-lookup"><span data-stu-id="95ecb-253">Local Activate (LA)</span></span>
-   <span data-ttu-id="95ecb-254">遠端啟用 (RA) </span><span class="sxs-lookup"><span data-stu-id="95ecb-254">Remote Activate (RA)</span></span>

<span data-ttu-id="95ecb-255">存取權限安全描述項會分割成兩個存取權限：</span><span class="sxs-lookup"><span data-stu-id="95ecb-255">The access permission security descriptor is split into two access rights:</span></span>

-   <span data-ttu-id="95ecb-256"> (LC) 的本機存取呼叫</span><span class="sxs-lookup"><span data-stu-id="95ecb-256">Local Access Calls (LC)</span></span>
-   <span data-ttu-id="95ecb-257">遠端存取呼叫 (RC) </span><span class="sxs-lookup"><span data-stu-id="95ecb-257">Remote Access Calls (RC)</span></span>

<span data-ttu-id="95ecb-258">這可讓系統管理員套用非常特定的安全性設定。</span><span class="sxs-lookup"><span data-stu-id="95ecb-258">This allows the administrator to apply very specific security configurations.</span></span> <span data-ttu-id="95ecb-259">例如，您可以設定 COM 伺服器，讓它接受來自所有人的本機存取呼叫，而只接受來自系統管理員的遠端存取呼叫。</span><span class="sxs-lookup"><span data-stu-id="95ecb-259">For example, you can configure a COM server so that it accepts local access calls from everyone, while only accepting remote access calls from Administrators.</span></span> <span data-ttu-id="95ecb-260">您可以透過對 COM 許可權安全描述項的變更來指定這些差異。</span><span class="sxs-lookup"><span data-stu-id="95ecb-260">These distinctions can be specified through changes to the COM permissions security descriptors.</span></span>

### <a name="why-is-this-change-important-what-threats-does-it-help-mitigate"></a><span data-ttu-id="95ecb-261">為什麼此變更很重要？</span><span class="sxs-lookup"><span data-stu-id="95ecb-261">Why is this change important?</span></span> <span data-ttu-id="95ecb-262">它有助於減輕哪些威脅？</span><span class="sxs-lookup"><span data-stu-id="95ecb-262">What threats does it help mitigate?</span></span>

<span data-ttu-id="95ecb-263">舊版的 COM 伺服器應用程式無法限制應用程式，使其只能在本機使用，而不需要透過 DCOM 在網路上公開應用程式。</span><span class="sxs-lookup"><span data-stu-id="95ecb-263">Earlier versions of the COM server application have no way to restrict an application so that it can only be used locally without exposing the application on the network by way of DCOM.</span></span> <span data-ttu-id="95ecb-264">當使用者擁有 COM 伺服器應用程式的存取權時，他們就可以存取本機和遠端用途。</span><span class="sxs-lookup"><span data-stu-id="95ecb-264">When a user has access to a COM server application, they have access for both local and remote use.</span></span>

<span data-ttu-id="95ecb-265">COM 伺服器應用程式可能會將本身公開給未經驗證的使用者，以執行 COM 回呼案例。</span><span class="sxs-lookup"><span data-stu-id="95ecb-265">A COM server application might expose itself to unauthenticated users to implement a COM callback scenario.</span></span> <span data-ttu-id="95ecb-266">在此案例中，應用程式也必須對未經驗證的使用者公開啟用，而這可能不是理想的作法。</span><span class="sxs-lookup"><span data-stu-id="95ecb-266">In this scenario, the application must also expose its activation to unauthenticated users, which might not be desirable.</span></span>

<span data-ttu-id="95ecb-267">精確的 COM 許可權可讓系統管理員彈性地控制電腦的 COM 許可權原則。</span><span class="sxs-lookup"><span data-stu-id="95ecb-267">Precise COM permissions give flexibility to the administrator to control a computer's COM permission policy.</span></span> <span data-ttu-id="95ecb-268">這些許可權可針對所述的案例啟用安全性。</span><span class="sxs-lookup"><span data-stu-id="95ecb-268">These permissions enable security for the described scenarios.</span></span>

### <a name="what-works-differently-are-there-any-dependencies"></a><span data-ttu-id="95ecb-269">有哪些不同？</span><span class="sxs-lookup"><span data-stu-id="95ecb-269">What works differently?</span></span> <span data-ttu-id="95ecb-270">有任何依存性嗎？</span><span class="sxs-lookup"><span data-stu-id="95ecb-270">Are there any dependencies?</span></span>

<span data-ttu-id="95ecb-271">為了提供回溯相容性，現有的 COM 安全描述項會被解釋為同時允許或拒絕本機和遠端存取。</span><span class="sxs-lookup"><span data-stu-id="95ecb-271">To provide backward compatibility, existing COM security descriptors are interpreted to allow or deny both local and remote access simultaneously.</span></span> <span data-ttu-id="95ecb-272">也就是說， (ACE 的存取控制專案) 允許本機和遠端，或拒絕本機和遠端。</span><span class="sxs-lookup"><span data-stu-id="95ecb-272">That is, an access control entry (ACE) either allows both local and remote, or denies both local and remote.</span></span>

<span data-ttu-id="95ecb-273">呼叫或啟動許可權沒有回溯相容性問題。</span><span class="sxs-lookup"><span data-stu-id="95ecb-273">There are no backward-compatibility issues for call or launch rights.</span></span> <span data-ttu-id="95ecb-274">不過，有一個啟用許可權相容性問題。</span><span class="sxs-lookup"><span data-stu-id="95ecb-274">There is, however, an activation rights compatibility issue.</span></span> <span data-ttu-id="95ecb-275">如果在 COM 伺服器的現有安全描述項中，所設定的啟動許可權會比存取權限更嚴格，而且比用戶端啟動案例的最低需求更嚴格，則必須修改啟動許可權 ACL，以授與授權的用戶端適當的啟用許可權。</span><span class="sxs-lookup"><span data-stu-id="95ecb-275">If, in the existing security descriptors for a COM server, the configured launch permissions are more restrictive than the access permissions and are more restrictive than what is minimally required for client activation scenarios, then the launch permissions ACL must be modified to give the authorized clients the appropriate activation permissions.</span></span>

<span data-ttu-id="95ecb-276">若是使用預設安全性設定的 COM 應用程式，則不會有任何相容性問題。</span><span class="sxs-lookup"><span data-stu-id="95ecb-276">For COM applications that use the default security settings, there are no compatibility issues.</span></span> <span data-ttu-id="95ecb-277">針對使用 COM 啟用動態啟動的應用程式，大部分的相容性問題都不會有任何相容性問題，因為啟動許可權必須已包含能夠啟始物件的任何人。</span><span class="sxs-lookup"><span data-stu-id="95ecb-277">For applications that are dynamically started using COM activation, most have no compatibility issues, because the launch permissions must already include anyone who is able to activate an object.</span></span> <span data-ttu-id="95ecb-278">否則，這類應用程式即使在套用 Windows XP SP2 或 Windows Server 2003 SP1 之前也會產生啟用失敗，但如果呼叫者沒有啟動許可權，請嘗試啟始物件，且 COM 伺服器尚未執行。</span><span class="sxs-lookup"><span data-stu-id="95ecb-278">Otherwise, such applications generate activation failures even before applying Windows XP SP2 or Windows Server 2003 SP1, when callers without launch permission try to activate an object and the COM server is not already running.</span></span>

<span data-ttu-id="95ecb-279">相容性問題最重要的應用程式是由某些其他機制（例如 Windows 檔案總管或服務控制管理員）啟動的 COM 應用程式。</span><span class="sxs-lookup"><span data-stu-id="95ecb-279">The applications of most concern for compatibility issues are COM applications that are already started by some other mechanism, such as Windows Explorer, or Service Control Manager.</span></span> <span data-ttu-id="95ecb-280">您也可以使用先前的 COM 啟動來啟動這些應用程式，這會覆寫預設存取和啟動許可權，並指定比呼叫許可權更嚴格的啟動許可權。</span><span class="sxs-lookup"><span data-stu-id="95ecb-280">You can also start these applications by a previous COM activation, which overrides the default access and launch permissions and specifies launch permissions that are more restrictive than the call permissions.</span></span> <span data-ttu-id="95ecb-281">如需解決此相容性問題的詳細資訊，請參閱「如何? 解決這些問題？」</span><span class="sxs-lookup"><span data-stu-id="95ecb-281">For more details about addressing this compatibility issue, see "How do I resolve these issues?"</span></span> <span data-ttu-id="95ecb-282">在下一節中。</span><span class="sxs-lookup"><span data-stu-id="95ecb-282">in the next section.</span></span>

<span data-ttu-id="95ecb-283">如果升級至 Windows XP SP2 或 Windows Server 2003 SP1 的系統復原到先前的狀態，則會將已編輯為允許本機存取、遠端存取或兩者的任何 ACE 都解釋為允許本機和遠端存取。</span><span class="sxs-lookup"><span data-stu-id="95ecb-283">If a system that is upgraded to Windows XP SP2 or Windows Server 2003 SP1 is rolled back to an earlier state, any ACE that was edited to allow local access, remote access, or both, is interpreted to allow both local and remote access.</span></span> <span data-ttu-id="95ecb-284">任何已編輯為拒絕本機存取、遠端存取或兩者的 ACE 都會被解釋為拒絕本機和遠端存取。</span><span class="sxs-lookup"><span data-stu-id="95ecb-284">Any ACE that was edited to deny local access, remote access, or both, is interpreted to deny both local and remote access.</span></span> <span data-ttu-id="95ecb-285">只要卸載 service pack，您應該確保沒有新設定的 Ace 會導致應用程式停止運作。</span><span class="sxs-lookup"><span data-stu-id="95ecb-285">Whenever you uninstall a service pack, you should ensure that no newly set ACEs cause applications to stop working.</span></span>

### <a name="how-do-i-resolve-these-issues"></a><span data-ttu-id="95ecb-286">我該如何解決這些問題？</span><span class="sxs-lookup"><span data-stu-id="95ecb-286">How do I resolve these issues?</span></span>

<span data-ttu-id="95ecb-287">如果您執行 COM 伺服器，並覆寫預設安全性設定，請確認應用程式特定的啟動許可權 ACL 授與啟用許可權給適當的使用者。</span><span class="sxs-lookup"><span data-stu-id="95ecb-287">If you implement a COM server and you override the default security settings, confirm that the application-specific launch permissions ACL grants activation permission to appropriate users.</span></span> <span data-ttu-id="95ecb-288">如果沒有，您必須變更應用程式特定的啟動許可權 ACL，以授與適當的使用者啟用許可權，讓使用 DCOM 的應用程式和 Windows 元件不會失敗。</span><span class="sxs-lookup"><span data-stu-id="95ecb-288">If it does not, you must change your application-specific launch permission ACL to give appropriate users activation rights so applications and Windows components that use DCOM do not fail.</span></span> <span data-ttu-id="95ecb-289">這些應用程式特定的啟動許可權會儲存在登錄中。</span><span class="sxs-lookup"><span data-stu-id="95ecb-289">These application-specific launch permissions are stored in the registry.</span></span>

<span data-ttu-id="95ecb-290">您可以使用一般安全性功能來建立或修改 COM Acl。</span><span class="sxs-lookup"><span data-stu-id="95ecb-290">The COM ACLs can be created or modified using normal security functions.</span></span>

## <a name="what-settings-are-added-or-changed-in-windows-xp-service-pack-2"></a><span data-ttu-id="95ecb-291">Windows XP Service Pack 2 中新增或變更了哪些設定？</span><span class="sxs-lookup"><span data-stu-id="95ecb-291">What settings are added or changed in Windows XP Service Pack 2?</span></span>

> [!Caution]  
> <span data-ttu-id="95ecb-292">不當使用這些設定可能會導致使用 DCOM 的應用程式和 Windows 元件失敗。</span><span class="sxs-lookup"><span data-stu-id="95ecb-292">Improper use of these settings can cause applications and Windows components that use DCOM to fail.</span></span>

 

<span data-ttu-id="95ecb-293">在下表中，會使用這些縮寫：</span><span class="sxs-lookup"><span data-stu-id="95ecb-293">In the following table, these abbreviations are used:</span></span>

<span data-ttu-id="95ecb-294">LL-本機啟動</span><span class="sxs-lookup"><span data-stu-id="95ecb-294">LL - Local Launch</span></span>

<span data-ttu-id="95ecb-295">LA-本機啟用</span><span class="sxs-lookup"><span data-stu-id="95ecb-295">LA - Local Activation</span></span>

<span data-ttu-id="95ecb-296">RL-遠端啟動</span><span class="sxs-lookup"><span data-stu-id="95ecb-296">RL - Remote Launch</span></span>

<span data-ttu-id="95ecb-297">RA-遠端啟用</span><span class="sxs-lookup"><span data-stu-id="95ecb-297">RA - Remote Activation</span></span>

<span data-ttu-id="95ecb-298">LC-本機存取呼叫</span><span class="sxs-lookup"><span data-stu-id="95ecb-298">LC - Local Access Calls</span></span>

<span data-ttu-id="95ecb-299">RC-遠端存取呼叫</span><span class="sxs-lookup"><span data-stu-id="95ecb-299">RC - Remote Access Calls</span></span>

<span data-ttu-id="95ecb-300">ACL-存取控制清單</span><span class="sxs-lookup"><span data-stu-id="95ecb-300">ACL - Access Control List</span></span>



| <span data-ttu-id="95ecb-301">設定名稱</span><span class="sxs-lookup"><span data-stu-id="95ecb-301">Setting name</span></span>                                                                                         | <span data-ttu-id="95ecb-302">Location</span><span class="sxs-lookup"><span data-stu-id="95ecb-302">Location</span></span>                                                                                                       | <span data-ttu-id="95ecb-303">先前的預設值</span><span class="sxs-lookup"><span data-stu-id="95ecb-303">Previous default value</span></span>                                                                                                                                                                     | <span data-ttu-id="95ecb-304">預設值</span><span class="sxs-lookup"><span data-stu-id="95ecb-304">Default value</span></span>                                                                                                                                                                                                                                                                                                                                                             | <span data-ttu-id="95ecb-305">可能值</span><span class="sxs-lookup"><span data-stu-id="95ecb-305">Possible values</span></span>                                                                                                                                                                                                              |
|------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="95ecb-306">**MachineLaunchRestriction**</span><span class="sxs-lookup"><span data-stu-id="95ecb-306">**MachineLaunchRestriction**</span></span><br/>                                                              | <span data-ttu-id="95ecb-307">**HKEY \_ 本機 \_ 電腦 \\ 軟體 \\ Microsoft \\ Ole**</span><span class="sxs-lookup"><span data-stu-id="95ecb-307">**HKEY\_LOCAL\_MACHINE\\SOFTWARE\\ Microsoft\\Ole**</span></span><br/>                                                 | <span data-ttu-id="95ecb-308">每個人-LL、LA、RL、RA</span><span class="sxs-lookup"><span data-stu-id="95ecb-308">Everyone - LL, LA, RL, RA</span></span><br/> <span data-ttu-id="95ecb-309">匿名</span><span class="sxs-lookup"><span data-stu-id="95ecb-309">Anonymous -</span></span><br/> <span data-ttu-id="95ecb-310">LL、LA、RL、RA</span><span class="sxs-lookup"><span data-stu-id="95ecb-310">LL, LA, RL, RA</span></span><br/> <span data-ttu-id="95ecb-311"> (這是新的登錄機碼。</span><span class="sxs-lookup"><span data-stu-id="95ecb-311">(This is a new registry key.</span></span> <span data-ttu-id="95ecb-312">根據現有的行為，這些都是有效的值。 ) </span><span class="sxs-lookup"><span data-stu-id="95ecb-312">Based on existing behavior, these are the effective values.)</span></span><br/> | <span data-ttu-id="95ecb-313">系統管理員： LL、LA、RL、RA</span><span class="sxs-lookup"><span data-stu-id="95ecb-313">Administrator: LL, LA, RL, RA</span></span><br/>                                                                                                                                                                                                                                                                                                                                  | <span data-ttu-id="95ecb-314">Acl</span><span class="sxs-lookup"><span data-stu-id="95ecb-314">ACL</span></span><br/>                                                                                                                                                                                                               |
| <span data-ttu-id="95ecb-315">**MachineAccessRestriction**</span><span class="sxs-lookup"><span data-stu-id="95ecb-315">**MachineAccessRestriction**</span></span><br/>                                                              | <span data-ttu-id="95ecb-316">**HKEY \_ 本機 \_ 電腦 \\ 軟體 \\ Microsoft \\ Ole**</span><span class="sxs-lookup"><span data-stu-id="95ecb-316">**HKEY\_LOCAL\_MACHINE\\SOFTWARE\\ Microsoft\\Ole**</span></span><br/>                                                 | <span data-ttu-id="95ecb-317">每個人-LC、RC</span><span class="sxs-lookup"><span data-stu-id="95ecb-317">Everyone - LC, RC</span></span><br/> <span data-ttu-id="95ecb-318">匿名-LC、RC</span><span class="sxs-lookup"><span data-stu-id="95ecb-318">Anonymous - LC, RC</span></span><br/> <span data-ttu-id="95ecb-319"> (這是新的登錄機碼。</span><span class="sxs-lookup"><span data-stu-id="95ecb-319">(This is a new registry key.</span></span> <span data-ttu-id="95ecb-320">根據現有的行為，這些都是有效的值。 ) </span><span class="sxs-lookup"><span data-stu-id="95ecb-320">Based on existing behavior, these are the effective values.)</span></span><br/>                            | <span data-ttu-id="95ecb-321">每個人： LC、RC</span><span class="sxs-lookup"><span data-stu-id="95ecb-321">Everyone: LC, RC</span></span><br/> <span data-ttu-id="95ecb-322">匿名： LC</span><span class="sxs-lookup"><span data-stu-id="95ecb-322">Anonymous: LC</span></span><br/>                                                                                                                                                                                                                                                                                                                      | <span data-ttu-id="95ecb-323">Acl</span><span class="sxs-lookup"><span data-stu-id="95ecb-323">ACL</span></span><br/>                                                                                                                                                                                                               |
| <span data-ttu-id="95ecb-324">**CallFailureLoggingLevel**</span><span class="sxs-lookup"><span data-stu-id="95ecb-324">**CallFailureLoggingLevel**</span></span><br/>                                                               | <span data-ttu-id="95ecb-325">**HKEY \_ 本機 \_ 電腦 \\ 軟體 \\ Microsoft \\ Ole**</span><span class="sxs-lookup"><span data-stu-id="95ecb-325">**HKEY\_LOCAL\_MACHINE\\SOFTWARE\\ Microsoft\\Ole**</span></span><br/>                                                 | <span data-ttu-id="95ecb-326">不適用。</span><span class="sxs-lookup"><span data-stu-id="95ecb-326">Not applicable.</span></span><br/>                                                                                                                                                                 | <span data-ttu-id="95ecb-327">此登錄機碼不存在;不過，遺漏的索引鍵或值會被解釋為2。</span><span class="sxs-lookup"><span data-stu-id="95ecb-327">This registry key is not present; however, a missing key or value is interpreted as 2.</span></span><br/> <span data-ttu-id="95ecb-328">依預設不會記錄此事件。</span><span class="sxs-lookup"><span data-stu-id="95ecb-328">This event is not logged by default.</span></span> <span data-ttu-id="95ecb-329">如果您將此值變更為1以開始記錄這項資訊，以協助您疑難排解問題，請務必監視事件記錄檔的大小，因為這是可以產生大量專案的事件。</span><span class="sxs-lookup"><span data-stu-id="95ecb-329">If you change this value to 1 to start logging this information to help you troubleshoot an issue, be sure to monitor the size of your event log, because this is an event that can generate a large number of entries.</span></span><br/> | <span data-ttu-id="95ecb-330">1-在 COM 伺服器進程的呼叫期間一律記錄事件記錄檔失敗。</span><span class="sxs-lookup"><span data-stu-id="95ecb-330">1 - Always log event log failures during a call in the COM Server process.</span></span><br/> <span data-ttu-id="95ecb-331">2-永遠不會在呼叫伺服器進程的呼叫期間記錄事件記錄檔失敗。</span><span class="sxs-lookup"><span data-stu-id="95ecb-331">2 - Never log event log failures during a call in the call server process.</span></span><br/>                                                  |
| <span data-ttu-id="95ecb-332">**InvalidSecurityDescriptorLoggingLevel**</span><span class="sxs-lookup"><span data-stu-id="95ecb-332">**InvalidSecurityDescriptorLoggingLevel**</span></span><br/>                                                 | <span data-ttu-id="95ecb-333">**HKEY \_ 本機 \_ 電腦 \\ 軟體 \\ Microsoft \\ Ole**</span><span class="sxs-lookup"><span data-stu-id="95ecb-333">**HKEY\_LOCAL\_MACHINE\\SOFTWARE\\ Microsoft\\Ole**</span></span><br/>                                                 | <span data-ttu-id="95ecb-334">不適用。</span><span class="sxs-lookup"><span data-stu-id="95ecb-334">Not applicable.</span></span><br/>                                                                                                                                                                 | <span data-ttu-id="95ecb-335">此登錄機碼不存在;不過，遺漏的索引鍵或值會被解釋為1。</span><span class="sxs-lookup"><span data-stu-id="95ecb-335">This registry key is not present; however, a missing key or value is interpreted as 1.</span></span><br/> <span data-ttu-id="95ecb-336">預設會記錄此事件。</span><span class="sxs-lookup"><span data-stu-id="95ecb-336">This event is logged by default.</span></span> <span data-ttu-id="95ecb-337">這種情況很少發生。</span><span class="sxs-lookup"><span data-stu-id="95ecb-337">It should rarely occur.</span></span><br/>                                                                                                                                                                                                    | <span data-ttu-id="95ecb-338">1-當 COM 基礎結構找到不正確安全描述項時，一律記錄事件記錄檔失敗。</span><span class="sxs-lookup"><span data-stu-id="95ecb-338">1 - Always log event log failures when the COM infrastructure finds an invalid security descriptor.</span></span><br/> <span data-ttu-id="95ecb-339">2-當 COM 基礎結構找不到不正確安全描述項時，永遠不會記錄事件記錄檔失敗。</span><span class="sxs-lookup"><span data-stu-id="95ecb-339">2 - Never log event log failures when the COM infrastructure finds an invalid security descriptor.</span></span><br/> |
| <span data-ttu-id="95ecb-340">DCOM：安全描述項定義語言中的電腦啟動限制 (SDDL) 語法</span><span class="sxs-lookup"><span data-stu-id="95ecb-340">DCOM:Machine Launch Restrictions in Security Descriptor Definition Language (SDDL) Syntax</span></span><br/> | <span data-ttu-id="95ecb-341"> (群組原則物件) 電腦 \\ 設定 Windows 設定 \\ 本機原則 \\ 安全性選項</span><span class="sxs-lookup"><span data-stu-id="95ecb-341">(Group Policy object) Computer Configuration \\Windows Settings\\Local Policies \\Security Options</span></span><br/>  | <span data-ttu-id="95ecb-342">不適用。</span><span class="sxs-lookup"><span data-stu-id="95ecb-342">Not applicable.</span></span><br/>                                                                                                                                                                 | <span data-ttu-id="95ecb-343">未定義</span><span class="sxs-lookup"><span data-stu-id="95ecb-343">Not defined</span></span><br/>                                                                                                                                                                                                                                                                                                                                                    | <span data-ttu-id="95ecb-344">SDDL 格式的存取控制清單。</span><span class="sxs-lookup"><span data-stu-id="95ecb-344">Access control list in SDDL format.</span></span> <span data-ttu-id="95ecb-345">此原則的存在會覆寫 MachineLaunchRestriction 中的值（先前為）。</span><span class="sxs-lookup"><span data-stu-id="95ecb-345">Existence of this policy overrides values in MachineLaunchRestriction, previously.</span></span><br/>                                                                                            |
| <span data-ttu-id="95ecb-346">DCOM：安全描述項定義語言中的電腦存取限制 (SDDL) 語法</span><span class="sxs-lookup"><span data-stu-id="95ecb-346">DCOM:Machine Access Restrictions in Security Descriptor Definition Language (SDDL) Syntax</span></span><br/> | <span data-ttu-id="95ecb-347"> (群組原則物件) 電腦 \\ 設定 Windows 設定 \\ 本機原則 \\ 安全性選項</span><span class="sxs-lookup"><span data-stu-id="95ecb-347">(Group Policy object) Computer Configuration \\Windows Settings \\Local Policies \\Security Options</span></span><br/> | <span data-ttu-id="95ecb-348">不適用。</span><span class="sxs-lookup"><span data-stu-id="95ecb-348">Not applicable.</span></span><br/>                                                                                                                                                                 | <span data-ttu-id="95ecb-349">未定義</span><span class="sxs-lookup"><span data-stu-id="95ecb-349">Not defined</span></span><br/>                                                                                                                                                                                                                                                                                                                                                    | <span data-ttu-id="95ecb-350">SDDL 格式的存取控制清單。</span><span class="sxs-lookup"><span data-stu-id="95ecb-350">Access control list in SDDL format.</span></span> <span data-ttu-id="95ecb-351">此原則的存在會覆寫 MachineAccessRestriction 中的值（先前為）。</span><span class="sxs-lookup"><span data-stu-id="95ecb-351">Existence of this policy overrides values in MachineAccessRestriction, previously.</span></span><br/>                                                                                            |



 

## <a name="what-settings-are-added-or-changed-in-windows-server-2003-service-pack-1"></a><span data-ttu-id="95ecb-352">Windows Server 2003 Service Pack 1 中新增或變更了哪些設定？</span><span class="sxs-lookup"><span data-stu-id="95ecb-352">What settings are added or changed in Windows Server 2003 Service Pack 1?</span></span>

> [!Note]  
> <span data-ttu-id="95ecb-353">不當使用這些設定可能會導致使用 DCOM 的應用程式和 Windows 元件失敗。</span><span class="sxs-lookup"><span data-stu-id="95ecb-353">Improper use of these settings can cause applications and Windows components that use DCOM to fail.</span></span>

 

<span data-ttu-id="95ecb-354">在下表中，會使用這些縮寫：</span><span class="sxs-lookup"><span data-stu-id="95ecb-354">In the following table, these abbreviations are used:</span></span>

<span data-ttu-id="95ecb-355">LL-本機啟動</span><span class="sxs-lookup"><span data-stu-id="95ecb-355">LL - Local Launch</span></span>

<span data-ttu-id="95ecb-356">LA-本機啟用</span><span class="sxs-lookup"><span data-stu-id="95ecb-356">LA - Local Activation</span></span>

<span data-ttu-id="95ecb-357">RL-遠端啟動</span><span class="sxs-lookup"><span data-stu-id="95ecb-357">RL - Remote Launch</span></span>

<span data-ttu-id="95ecb-358">RA-遠端啟用</span><span class="sxs-lookup"><span data-stu-id="95ecb-358">RA - Remote Activation</span></span>

<span data-ttu-id="95ecb-359">LC-本機存取呼叫</span><span class="sxs-lookup"><span data-stu-id="95ecb-359">LC - Local Access Calls</span></span>

<span data-ttu-id="95ecb-360">RC-遠端存取呼叫</span><span class="sxs-lookup"><span data-stu-id="95ecb-360">RC - Remote Access Calls</span></span>

<span data-ttu-id="95ecb-361">ACL-存取控制清單</span><span class="sxs-lookup"><span data-stu-id="95ecb-361">ACL - Access Control List</span></span>



| <span data-ttu-id="95ecb-362">設定名稱</span><span class="sxs-lookup"><span data-stu-id="95ecb-362">Setting name</span></span>                                                                                         | <span data-ttu-id="95ecb-363">Location</span><span class="sxs-lookup"><span data-stu-id="95ecb-363">Location</span></span>                                                                                                       | <span data-ttu-id="95ecb-364">先前的預設值</span><span class="sxs-lookup"><span data-stu-id="95ecb-364">Previous default value</span></span>                                                                                                                                                             | <span data-ttu-id="95ecb-365">預設值</span><span class="sxs-lookup"><span data-stu-id="95ecb-365">Default value</span></span>                                                                                                                                                                                                                                                                                                                                                             | <span data-ttu-id="95ecb-366">可能值</span><span class="sxs-lookup"><span data-stu-id="95ecb-366">Possible values</span></span>                                                                                                                                                                                                              |
|------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="95ecb-367">**MachineLaunchRestriction**</span><span class="sxs-lookup"><span data-stu-id="95ecb-367">**MachineLaunchRestriction**</span></span><br/>                                                              | <span data-ttu-id="95ecb-368">**HKEY \_ 本機 \_ 電腦 \\ 軟體 \\ Microsoft \\ Ole**</span><span class="sxs-lookup"><span data-stu-id="95ecb-368">**HKEY\_LOCAL\_MACHINE\\SOFTWARE\\ Microsoft\\Ole**</span></span><br/>                                                 | <span data-ttu-id="95ecb-369">每個人： LL、LA、RL、RA</span><span class="sxs-lookup"><span data-stu-id="95ecb-369">Everyone: LL, LA, RL, RA</span></span><br/> <span data-ttu-id="95ecb-370">匿名： LL、LA、RL、RA</span><span class="sxs-lookup"><span data-stu-id="95ecb-370">Anonymous: LL, LA, RL, RA</span></span><br/> <span data-ttu-id="95ecb-371"> (這是新的登錄機碼。</span><span class="sxs-lookup"><span data-stu-id="95ecb-371">(This is a new registry key.</span></span> <span data-ttu-id="95ecb-372">根據現有的行為，這些都是有效的值。 ) </span><span class="sxs-lookup"><span data-stu-id="95ecb-372">Based on existing behavior, these would be the effective values.)</span></span><br/> | <span data-ttu-id="95ecb-373">系統管理員： LL、LA、RL、RA</span><span class="sxs-lookup"><span data-stu-id="95ecb-373">Administrator: LL, LA, RL, RA</span></span><br/> <span data-ttu-id="95ecb-374">每個人： LL、LA</span><span class="sxs-lookup"><span data-stu-id="95ecb-374">Everyone: LL, LA</span></span><br/> <span data-ttu-id="95ecb-375">Distributed COM users： LL、LA、RL、RA</span><span class="sxs-lookup"><span data-stu-id="95ecb-375">Distributed COM users: LL, LA, RL, RA</span></span><br/>                                                                                                                                                                                                                                                     | <span data-ttu-id="95ecb-376">Acl</span><span class="sxs-lookup"><span data-stu-id="95ecb-376">ACL</span></span><br/>                                                                                                                                                                                                               |
| <span data-ttu-id="95ecb-377">**MachineAccessRestriction**</span><span class="sxs-lookup"><span data-stu-id="95ecb-377">**MachineAccessRestriction**</span></span><br/>                                                              | <span data-ttu-id="95ecb-378">**HKEY \_ 本機 \_ 電腦 \\ 軟體 \\ Microsoft \\ Ole**</span><span class="sxs-lookup"><span data-stu-id="95ecb-378">**HKEY\_LOCAL\_MACHINE\\SOFTWARE\\ Microsoft\\Ole**</span></span><br/>                                                 | <span data-ttu-id="95ecb-379">每個人： LC、RC</span><span class="sxs-lookup"><span data-stu-id="95ecb-379">Everyone: LC, RC</span></span><br/> <span data-ttu-id="95ecb-380">匿名： LC、RC</span><span class="sxs-lookup"><span data-stu-id="95ecb-380">Anonymous: LC, RC</span></span><br/> <span data-ttu-id="95ecb-381"> (這是新的登錄機碼。</span><span class="sxs-lookup"><span data-stu-id="95ecb-381">(This is a new registry key.</span></span> <span data-ttu-id="95ecb-382">根據現有的行為，這些都是有效的值。 ) </span><span class="sxs-lookup"><span data-stu-id="95ecb-382">Based on existing behavior, these would be the effective values.)</span></span><br/>                 | <span data-ttu-id="95ecb-383">每個人： LC、RC</span><span class="sxs-lookup"><span data-stu-id="95ecb-383">Everyone: LC, RC</span></span><br/> <span data-ttu-id="95ecb-384">匿名： LC、RC</span><span class="sxs-lookup"><span data-stu-id="95ecb-384">Anonymous: LC, RC</span></span><br/>                                                                                                                                                                                                                                                                                                                  | <span data-ttu-id="95ecb-385">Acl</span><span class="sxs-lookup"><span data-stu-id="95ecb-385">ACL</span></span><br/>                                                                                                                                                                                                               |
| <span data-ttu-id="95ecb-386">**CallFailureLoggingLevel**</span><span class="sxs-lookup"><span data-stu-id="95ecb-386">**CallFailureLoggingLevel**</span></span><br/>                                                               | <span data-ttu-id="95ecb-387">**HKEY \_ 本機 \_ 電腦 \\ 軟體 \\ Microsoft \\ Ole**</span><span class="sxs-lookup"><span data-stu-id="95ecb-387">**HKEY\_LOCAL\_MACHINE\\SOFTWARE\\ Microsoft\\Ole**</span></span><br/>                                                 | <span data-ttu-id="95ecb-388">不適用。</span><span class="sxs-lookup"><span data-stu-id="95ecb-388">Not applicable.</span></span><br/>                                                                                                                                                         | <span data-ttu-id="95ecb-389">此登錄機碼不存在;不過，遺漏的索引鍵或值會被解釋為2。</span><span class="sxs-lookup"><span data-stu-id="95ecb-389">This registry key is not present; however, a missing key or value is interpreted as 2.</span></span><br/> <span data-ttu-id="95ecb-390">依預設不會記錄此事件。</span><span class="sxs-lookup"><span data-stu-id="95ecb-390">This event is not logged by default.</span></span> <span data-ttu-id="95ecb-391">如果您將此值變更為1以開始記錄這項資訊，以協助您疑難排解問題，請務必監視事件記錄檔的大小，因為這是可以產生大量專案的事件。</span><span class="sxs-lookup"><span data-stu-id="95ecb-391">If you change this value to 1 to start logging this information to help you troubleshoot an issue, be sure to monitor the size of your event log, because this is an event that can generate a large number of entries.</span></span><br/> | <span data-ttu-id="95ecb-392">1-當 COM 基礎結構找到不正確安全描述項時，一律記錄事件記錄檔失敗。</span><span class="sxs-lookup"><span data-stu-id="95ecb-392">1 - Always log event log failures when the COM infrastructure finds an invalid security descriptor.</span></span><br/> <span data-ttu-id="95ecb-393">2-當 COM 基礎結構找不到不正確安全描述項時，永遠不會記錄事件記錄檔失敗。</span><span class="sxs-lookup"><span data-stu-id="95ecb-393">2 - Never log event log failures when the COM infrastructure finds an invalid security descriptor.</span></span><br/> |
| <span data-ttu-id="95ecb-394">**InvalidSecurityDescriptorLoggingLevel**</span><span class="sxs-lookup"><span data-stu-id="95ecb-394">**InvalidSecurityDescriptorLoggingLevel**</span></span><br/>                                                 | <span data-ttu-id="95ecb-395">**HKEY \_ 本機 \_ 電腦 \\ 軟體 \\ Microsoft \\ Ole**</span><span class="sxs-lookup"><span data-stu-id="95ecb-395">**HKEY\_LOCAL\_MACHINE\\SOFTWARE\\ Microsoft\\Ole**</span></span><br/>                                                 | <span data-ttu-id="95ecb-396">不適用。</span><span class="sxs-lookup"><span data-stu-id="95ecb-396">Not applicable.</span></span><br/>                                                                                                                                                         | <span data-ttu-id="95ecb-397">此登錄機碼不存在;不過，遺漏的索引鍵或值會被解釋為1。</span><span class="sxs-lookup"><span data-stu-id="95ecb-397">This registry key is not present; however, a missing key or value is interpreted as 1.</span></span><br/> <span data-ttu-id="95ecb-398">預設會記錄此事件。</span><span class="sxs-lookup"><span data-stu-id="95ecb-398">This event is logged by default.</span></span> <span data-ttu-id="95ecb-399">這種情況很少發生。</span><span class="sxs-lookup"><span data-stu-id="95ecb-399">It should rarely occur.</span></span><br/>                                                                                                                                                                                                    | <span data-ttu-id="95ecb-400">1-當 COM 基礎結構發現不正確安全描述項時，一律記錄事件記錄檔失敗。</span><span class="sxs-lookup"><span data-stu-id="95ecb-400">1 - Always log event log failures when COM infrastructure finds an invalid security descriptor.</span></span><br/> <span data-ttu-id="95ecb-401">2-當 COM 基礎結構找不到不正確安全描述項時，永遠不會記錄事件記錄檔失敗。</span><span class="sxs-lookup"><span data-stu-id="95ecb-401">2 - Never log event log failures when COM infrastructure finds an invalid security descriptor.</span></span><br/>         |
| <span data-ttu-id="95ecb-402">DCOM：安全描述項定義語言中的電腦啟動限制 (SDDL) 語法</span><span class="sxs-lookup"><span data-stu-id="95ecb-402">DCOM:Machine Launch Restrictions in Security Descriptor Definition Language (SDDL) Syntax</span></span><br/> | <span data-ttu-id="95ecb-403"> (群組原則物件) 電腦 \\ 設定 Windows 設定 \\ 本機原則 \\ 安全性選項</span><span class="sxs-lookup"><span data-stu-id="95ecb-403">(Group Policy object) Computer Configuration \\Windows Settings \\Local Policies \\Security Options</span></span><br/> | <span data-ttu-id="95ecb-404">不適用。</span><span class="sxs-lookup"><span data-stu-id="95ecb-404">Not applicable.</span></span><br/>                                                                                                                                                         | <span data-ttu-id="95ecb-405">未定義。</span><span class="sxs-lookup"><span data-stu-id="95ecb-405">Not defined.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                   | <span data-ttu-id="95ecb-406">SDDL 格式的存取控制清單。</span><span class="sxs-lookup"><span data-stu-id="95ecb-406">Access control list in SDDL format.</span></span> <span data-ttu-id="95ecb-407">此原則的存在會覆寫 MachineLaunchRestriction 中的值（先前為）。</span><span class="sxs-lookup"><span data-stu-id="95ecb-407">Existence of this policy overrides values in MachineLaunchRestriction, previously.</span></span><br/>                                                                                            |
| <span data-ttu-id="95ecb-408">DCOM：安全描述項定義語言中的電腦存取限制 (SDDL) 語法</span><span class="sxs-lookup"><span data-stu-id="95ecb-408">DCOM:Machine Access Restrictions in Security Descriptor Definition Language (SDDL) Syntax</span></span><br/> | <span data-ttu-id="95ecb-409"> (群組原則物件) 電腦 \\ 設定 Windows 設定 \\ 本機原則 \\ 安全性選項</span><span class="sxs-lookup"><span data-stu-id="95ecb-409">(Group Policy object) Computer Configuration \\Windows Settings \\Local Policies \\Security Options</span></span><br/> | <span data-ttu-id="95ecb-410">不適用。</span><span class="sxs-lookup"><span data-stu-id="95ecb-410">Not applicable.</span></span><br/>                                                                                                                                                         | <span data-ttu-id="95ecb-411">未定義。</span><span class="sxs-lookup"><span data-stu-id="95ecb-411">Not defined.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                   | <span data-ttu-id="95ecb-412">SDDL 格式的存取控制清單。</span><span class="sxs-lookup"><span data-stu-id="95ecb-412">Access control list in SDDL format.</span></span> <span data-ttu-id="95ecb-413">此原則的存在會覆寫 MachineAccessRestriction 中的值（先前為）。</span><span class="sxs-lookup"><span data-stu-id="95ecb-413">Existence of this policy overrides values in MachineAccessRestriction, previously.</span></span><br/>                                                                                            |



 

## <a name="related-topics"></a><span data-ttu-id="95ecb-414">相關主題</span><span class="sxs-lookup"><span data-stu-id="95ecb-414">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="95ecb-415">COM 中的安全性</span><span class="sxs-lookup"><span data-stu-id="95ecb-415">Security in COM</span></span>](security-in-com.md)
</dt> </dl>

 

