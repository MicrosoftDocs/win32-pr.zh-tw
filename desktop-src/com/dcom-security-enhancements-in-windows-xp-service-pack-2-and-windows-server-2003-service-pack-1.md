---
title: Windows XP Service Pack 2 和 Windows Server 2003 Service Pack 1 中的 DCOM 安全性增強功能
description: Windows Server XP Service Pack 2 (SP2) 和 Windows Server 2003 Service Pack 1 (SP1) 為分散式元件物件模型 (DCOM) 引進增強的預設安全性設定。
ms.assetid: 1917834c-5216-4ef3-a0c2-d8ca63cef53d
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e4ad51807e27a9b97e8b05e467d8a84881c3993a
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/21/2020
ms.locfileid: "104093367"
---
# <a name="dcom-security-enhancements-in-windows-xp-service-pack-2-and-windows-server-2003-service-pack-1"></a>Windows XP Service Pack 2 和 Windows Server 2003 Service Pack 1 中的 DCOM 安全性增強功能

Windows Server XP Service Pack 2 (SP2) 和 Windows Server 2003 Service Pack 1 (SP1) 為分散式元件物件模型 (DCOM) 引進增強的預設安全性設定。 具體來說，他們引進更細微的許可權，讓系統管理員能夠獨立控制本機和遠端許可權，以啟動、啟用和存取 COM 伺服器。

## <a name="what-does-dcom-do"></a>DCOM 有哪些功能？

Microsoft 元件物件模型 (COM) 是一種與平臺無關、分散式、物件導向的系統，可用來建立可互動的二進位軟體元件。 分散式元件物件模型 (DCOM) 可讓應用程式分散到對您和應用程式最有意義的所有位置。 DCOM 有線通訊協定以透明的方式提供 COM 元件之間可靠、安全且有效率的通訊支援。

## <a name="who-does-this-feature-apply-to"></a>這項功能的適用物件為何？

如果您只將 COM 用於同進程 COM 元件，這項功能就不適用。

如果您的 COM 伺服器應用程式符合下列其中一個條件，則此功能適用于您：

-   應用程式的存取權限低於啟動許可權，這是執行應用程式所需的許可權。
-   應用程式通常是由遠端 COM 用戶端啟動，而不需要使用系統管理帳戶。
-   應用程式僅供本機使用。 這表示您可以限制 COM 伺服器應用程式，使其無法從遠端存取。

## <a name="what-new-functionality-is-added-to-this-feature-in-windows-xp-service-pack-2-and-windows-server-2003-service-pack-1"></a>這項功能在 Windows XP Service Pack 2 和 Windows Server 2003 Service Pack 1 中新增了哪些新功能？

### <a name="computer-wide-restrictions"></a>全電腦限制

COM 中的變更是為了提供全電腦存取控制，可控制電腦上所有呼叫、啟動或啟動要求的存取權。 要考慮這些存取控制的最簡單方式，就是在電腦上每次呼叫、啟動或啟動任何 COM 伺服器時，對整個電腦的存取控制清單進行的額外 [**AccessCheck**](/windows/desktop/api/securitybaseapi/nf-securitybaseapi-accesscheck) 呼叫 (ACL) 。 如果 **AccessCheck** 失敗，則會拒絕呼叫、啟用或啟動要求。 這是針對伺服器特定 Acl 執行的任何 **AccessCheck** 以外的功能。 實際上，它會提供必須傳遞來存取電腦上任何 COM 伺服器的最低授權標準。 有一部全電腦 ACL 可供啟動許可權，以涵蓋啟用和啟動許可權，以及用來取得存取權限的全電腦 ACL ACL 來涵蓋呼叫權利。 您可以透過 [元件服務] Microsoft Management Console (MMC) 來設定這些設定。

這些全電腦的 Acl 提供一種方式，可透過 [**CoInitializeSecurity**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializesecurity) 或應用程式特定的安全性設定，覆寫特定應用程式所指定的弱式安全性設定。 這會提供必須通過的最小安全性標準（不論特定伺服器的設定為何）。

當存取由 RPCSS 公開的介面時，會檢查這些 Acl。 這會提供控制此系統服務存取權的方法。

這些 Acl 提供集中的位置，讓系統管理員可以設定套用至電腦上所有 COM 伺服器的一般授權原則。

> [!Note]  
> 變更整部電腦的安全性設定會影響所有的 COM 伺服器應用程式，且可能會讓它們無法正常運作。 如果有 COM 伺服器應用程式的限制低於全電腦限制，則減少整個電腦的限制可能會將這些應用程式公開給不必要的存取。 相反地，如果您增加全電腦的限制，則呼叫應用程式可能無法再存取某些 COM 伺服器應用程式。

 

依預設，Windows XP SP2 電腦限制設定為：



| 權限        | 系統管理員                                                                                             | 所有人                                            | 匿名               |
|-------------------|-----------------------------------------------------------------------------------------------------------|-----------------------------------------------------|-------------------------|
| 啟動<br/> | 本機啟動<br/> 本機啟用<br/> 遠端啟動<br/> 遠端啟用<br/> | 本機啟動<br/> 本機啟用<br/> |                         |
| Access<br/> |                                                                                                           | 本機存取<br/> 遠端存取<br/>    | 本機存取<br/> |



 

依預設，Windows Server 2003 SP 1 電腦限制設定如下。



| 權限        | 系統管理員                                                                                             |  (內建群組) 的分散式 COM 使用者                                                                    | 所有人                                            | 匿名                                        |
|-------------------|-----------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------|-----------------------------------------------------|--------------------------------------------------|
| 啟動<br/> | 本機啟動<br/> 本機啟用<br/> 遠端啟動<br/> 遠端啟用<br/> | 本機啟動<br/> 本機啟用<br/> 遠端啟動<br/> 遠端啟用<br/> | 本機啟動<br/> 本機啟用<br/> | N/A<br/>                                   |
| Access<br/> | N/A<br/>                                                                                            | 本機存取<br/> 遠端存取<br/>                                                          | 本機存取<br/> 遠端存取<br/>    | 本機存取<br/> 遠端存取<br/> |



 

> [!Note]  
> Distributed COM Users 是 Windows Server 2003 SP1 隨附的新內建組，可加速將使用者新增至 DCOM 電腦限制設定的程式。 此群組是 [MachineAccessRestriction](machineaccessrestriction.md) 和 [MachineLaunchRestriction](machinelaunchrestriction.md) 設定所使用 ACL 的一部分，因此從此群組移除使用者將會影響這些設定。

 

### <a name="why-is-this-change-important-what-threats-does-it-help-mitigate"></a>為什麼此變更很重要？ 它有助於減輕哪些威脅？

許多 COM 應用程式都包含一些安全性特定的程式碼 (例如，呼叫 [**CoInitializeSecurity**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializesecurity)) ，但使用弱式設定，通常允許未經驗證的進程存取。 目前沒有任何方法可讓系統管理員覆寫這些設定，以在舊版 Windows 中強制執行更強的安全性。

COM 基礎結構包含了 RPCSS，也就是在系統啟動期間執行的系統服務，並且一律會在該時間執行。 它會管理 COM 物件的啟用和執行中的物件表，並提供 helper 服務給 DCOM 遠端處理。 它會公開可從遠端呼叫的 RPC 介面。 因為某些 COM 伺服器允許未經驗證的遠端存取，所以任何人都可以呼叫這些介面，包括未經驗證的使用者。 如此一來，在遠端、未經驗證的電腦上，惡意使用者可能會攻擊 RPCSS。

在舊版的 Windows 中，系統管理員無法瞭解電腦上 COM 伺服器的暴露程度。 系統管理員可以有系統地檢查電腦上所有已註冊 COM 應用程式的已設定安全性設定，但假設 Windows 的預設安裝中有大約150的 COM 伺服器，這項工作會很困難。 沒有任何方法可以查看在軟體中納入安全性的伺服器設定，而不需要複習該軟體的原始程式碼。

DCOM 全電腦限制減輕這三個問題。 它也可讓系統管理員停用連入 DCOM 啟用、啟動和呼叫的功能。

### <a name="what-works-differently"></a>有哪些不同？

依預設，Everyone 群組會被授與本機啟動、本機啟用和本機存取呼叫許可權。 如此一來，所有的本機案例都可以在不修改軟體或作業系統的情況下運作。

依預設，在 Windows XP SP2 中，Everyone 群組會被授與遠端存取呼叫許可權。 在 Windows Server 2003 SP1 中，每個人和匿名群組都會被授與遠端存取許可權。 這會啟用大部分的 COM 用戶端案例，包括 COM 用戶端將本機參考傳遞到遠端伺服器的常見案例，實際上會將用戶端變成伺服器。 在 Windows XP SP2 中，這可能會停用需要未經驗證的遠端存取呼叫的案例。

此外，根據預設，只有 Administrators 群組的成員會被授與「遠端啟用」和「啟動」許可權。 這會禁止非系統管理員對安裝的 COM 伺服器進行遠端啟用。

### <a name="how-do-i-resolve-these-issues"></a>我該如何解決這些問題？

如果您執行 COM 伺服器，並預期不會由非系統管理的 COM 用戶端進行遠端啟用，則您應該考慮啟用此程式所產生的風險是否可接受，或者，如果您應該修改您的執行，不需要由非系統管理的 COM 用戶端或遠端未經驗證的呼叫進行遠端啟用。

如果風險是可接受的，而您想要透過非系統管理的 COM 用戶端或遠端未驗證的呼叫來啟用遠端啟用，則必須變更這項功能的預設設定。

> [!Note]  
> 變更整部電腦的安全性設定會影響所有的 COM 伺服器應用程式，且可能會讓它們無法正常運作。 如果有 COM 伺服器應用程式的限制低於全電腦限制，則減少整個電腦的限制可能會將這些應用程式公開給不必要的存取。 相反地，如果您增加全電腦的限制，則呼叫應用程式可能無法再存取某些 COM 伺服器應用程式。

 

您可以使用 [元件服務 Microsoft Management Console (MMC) 或 Windows 登錄來變更設定設定。

如果您使用 [元件 **服務] mmc** 嵌入式管理單元，可以在您要管理的電腦上，于 [內容] 對話方塊的 [ **COM 安全性**] 索引標籤上設定這些設定。 [ **存取權限** ] 區域已經過修改，可讓您除了 COM 伺服器的標準預設設定以外，設定整個電腦的限制。 此外，您可以在 [限制] 和 [預設值] 下，為本機和遠端存取提供個別的 ACL 設定。

在 [ **啟動和啟用許可權** ] 區域中，您可以控制本機和遠端許可權，以及整個電腦的限制和預設值。 您可以單獨指定本機和遠端啟用和啟動許可權。

或者，您也可以使用登錄來設定這些 ACL 設定。

這些 Acl 會儲存在登錄中的下列位置：

``` syntax
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Ole\MachineAccessRestriction=ACL
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Ole\MachineLaunchRestriction=ACL
```

這些是型別為 REG BINARY 的值 \_ ，其中包含描述可存取電腦上任何 com 類別或 com 物件之主體 ACL 的資料。 ACL 中的存取權限為：

``` syntax
COM_RIGHTS_EXECUTE 1
COM_RIGHTS_EXECUTE_LOCAL 2
COM_RIGHTS_EXECUTE_REMOTE 4
COM_RIGHTS_ACTIVATE_LOCAL 8
COM_RIGHTS_ACTIVATE_REMOTE 16
```

您可以使用一般安全性功能來建立這些 Acl。

> [!Note]  
> 為了提供回溯相容性，ACL 可以有 Windows XP SP2 和 Windows Server 2003 SP1 之前使用的格式，它只會使用存取權限的許可權 \_ \_ 執行，或者可以存在於 WINDOWS XP SP2 和 windows SERVER 2003 SP1 中使用的新格式，此格式會 \_ \_ 搭配 com 許可權 \_ \_ 執行 \_ 本機、com \_ 許可權 \_ 執行 \_ 遠端、com \_ 許可權 \_ 啟用 \_ 本機和 com \_ 許可權 \_ 啟用 \_ 遠端。 請注意，「COM \_ 許可權 \_ 執行」> 一定要存在，但不存在此許可權會產生不正確安全描述項。 另請注意，您不能在單一 ACL 內混用舊格式和新格式; (Ace 的所有存取控制專案) 必須僅授與 COM \_ 許可權 \_ 執行存取權限，或全部都必須授與 com 許可權執行、com rights \_ \_ execute、 \_ \_ \_ com \_ rights \_ execute \_ remote、com \_ rights \_ activate \_ 本機和 com 許可權 \_ \_ 啟用 \_ 遠端的組合。

 

> [!Note]  
> 只有具備系統管理員許可權的使用者可以修改這些設定。

 

## <a name="what-existing-functionality-is-changing-in-windows-xp-service-pack-2-and-windows-server-2003-service-pack-1"></a>Windows XP Service Pack 2 和 Windows Server 2003 Service Pack 1 中的現有功能有哪些變更？

### <a name="rpcss-runs-as-a-network-service"></a>以網路服務的形式執行 RPCSS

RPCSS 是 RPC 端點對應程式和 DCOM 基礎結構的重要服務。 這項服務在舊版 Windows 中以本機系統的形式執行。 為了減少 Windows 的受攻擊面並提供深度防禦，RPCSS 服務功能已分割成兩個服務。 具有所有原始功能但不需要本機系統許可權的 RPCSS 服務，現在會在 Network Service 帳戶下執行。 新的 DCOMLaunch 服務，其中包含需要在本機系統帳戶下執行本機系統許可權的功能。

### <a name="why-is-this-change-important"></a>為什麼此變更很重要？

這項變更可減少受攻擊面，並為 RPCSS 服務提供深度防禦，因為在 RPCSS 服務中的權限提高現在僅限於 Network Service 許可權。

### <a name="what-works-differently"></a>有哪些不同？

這項變更對使用者來說應該是透明的，因為 RPCSS 和 DCOMLaunch 服務的組合相當於舊版 Windows 中提供的先前的「RPCSS」服務。

### <a name="more-specific-com-permissions"></a>更特定的 COM 許可權

COM 伺服器應用程式有兩種類型的許可權：啟動許可權與存取權限。 如果伺服器尚未執行，請在 COM 啟用期間啟動 COM 伺服器的啟動許可權控制授權。 這些許可權定義為登錄設定中所指定的安全描述項。 存取權限控制授權，以呼叫執行中的 COM 伺服器。 這些許可權是透過 [**CoInitializeSecurity**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializesecurity) API 或使用登錄設定，定義為 COM 基礎結構所提供的安全描述項。 [啟動] 和 [存取權限] 都可根據主體來允許或拒絕存取，而且與呼叫端是否為伺服器或遠端的本機不區分。

第一個變更會根據距離來區分 COM 存取權限。 這兩個定義的距離是本機和遠端。 本機 COM 訊息會透過本機遠端程序呼叫來 (LRPC) 通訊協定，而遠端 COM 訊息則是透過遠端過程)  (調用（例如傳輸控制通訊協定 (TCP) ）來送達。

COM 啟動是指在用戶端上呼叫 [**CoCreateInstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance) 或其中一個變體來取得 COM 介面 proxy 的動作。 這項啟用程式的副作用是，有時候必須啟動 COM 伺服器才能完成用戶端的要求。 啟用 COM 伺服器的啟動許可權 ACL 判斷提示。 存取權限 ACL 判斷提示，該物件可在 COM 伺服器已執行之後，啟用 COM 物件或呼叫該物件。

第二項變更是將呼叫和啟用許可權分開，以反映兩個不同的作業，並將啟用許可權從存取權限 ACL 移至啟動許可權 ACL。 因為啟用和啟動都與取得介面指標相關，所以啟用和啟動存取權限在邏輯上會以單一 ACL 的方式組成。 而且，由於您一律透過設定 (指定啟動許可權，相較于以程式設計方式指定的存取權限（通常是以程式設計的方式) ，因此在啟動許可權 ACL 中放置啟用許可權可提供系統管理員對啟用的控制權）。

 (Ace) 的啟動許可權存取控制專案會分成四個存取權限：

-   本機啟動 (LL) 
-   遠端啟動 (RL) 
-   本機啟用 (LA) 
-   遠端啟用 (RA) 

存取權限安全描述項會分割成兩個存取權限：

-    (LC) 的本機存取呼叫
-   遠端存取呼叫 (RC) 

這可讓系統管理員套用非常特定的安全性設定。 例如，您可以設定 COM 伺服器，讓它接受來自所有人的本機存取呼叫，而只接受來自系統管理員的遠端存取呼叫。 您可以透過對 COM 許可權安全描述項的變更來指定這些差異。

### <a name="why-is-this-change-important-what-threats-does-it-help-mitigate"></a>為什麼此變更很重要？ 它有助於減輕哪些威脅？

舊版的 COM 伺服器應用程式無法限制應用程式，使其只能在本機使用，而不需要透過 DCOM 在網路上公開應用程式。 當使用者擁有 COM 伺服器應用程式的存取權時，他們就可以存取本機和遠端用途。

COM 伺服器應用程式可能會將本身公開給未經驗證的使用者，以執行 COM 回呼案例。 在此案例中，應用程式也必須對未經驗證的使用者公開啟用，而這可能不是理想的作法。

精確的 COM 許可權可讓系統管理員彈性地控制電腦的 COM 許可權原則。 這些許可權可針對所述的案例啟用安全性。

### <a name="what-works-differently-are-there-any-dependencies"></a>有哪些不同？ 有任何依存性嗎？

為了提供回溯相容性，現有的 COM 安全描述項會被解釋為同時允許或拒絕本機和遠端存取。 也就是說， (ACE 的存取控制專案) 允許本機和遠端，或拒絕本機和遠端。

呼叫或啟動許可權沒有回溯相容性問題。 不過，有一個啟用許可權相容性問題。 如果在 COM 伺服器的現有安全描述項中，所設定的啟動許可權會比存取權限更嚴格，而且比用戶端啟動案例的最低需求更嚴格，則必須修改啟動許可權 ACL，以授與授權的用戶端適當的啟用許可權。

若是使用預設安全性設定的 COM 應用程式，則不會有任何相容性問題。 針對使用 COM 啟用動態啟動的應用程式，大部分的相容性問題都不會有任何相容性問題，因為啟動許可權必須已包含能夠啟始物件的任何人。 否則，這類應用程式即使在套用 Windows XP SP2 或 Windows Server 2003 SP1 之前也會產生啟用失敗，但如果呼叫者沒有啟動許可權，請嘗試啟始物件，且 COM 伺服器尚未執行。

相容性問題最重要的應用程式是由某些其他機制（例如 Windows 檔案總管或服務控制管理員）啟動的 COM 應用程式。 您也可以使用先前的 COM 啟動來啟動這些應用程式，這會覆寫預設存取和啟動許可權，並指定比呼叫許可權更嚴格的啟動許可權。 如需解決此相容性問題的詳細資訊，請參閱「如何? 解決這些問題？」 在下一節中。

如果升級至 Windows XP SP2 或 Windows Server 2003 SP1 的系統復原到先前的狀態，則會將已編輯為允許本機存取、遠端存取或兩者的任何 ACE 都解釋為允許本機和遠端存取。 任何已編輯為拒絕本機存取、遠端存取或兩者的 ACE 都會被解釋為拒絕本機和遠端存取。 只要卸載 service pack，您應該確保沒有新設定的 Ace 會導致應用程式停止運作。

### <a name="how-do-i-resolve-these-issues"></a>我該如何解決這些問題？

如果您執行 COM 伺服器，並覆寫預設安全性設定，請確認應用程式特定的啟動許可權 ACL 授與啟用許可權給適當的使用者。 如果沒有，您必須變更應用程式特定的啟動許可權 ACL，以授與適當的使用者啟用許可權，讓使用 DCOM 的應用程式和 Windows 元件不會失敗。 這些應用程式特定的啟動許可權會儲存在登錄中。

您可以使用一般安全性功能來建立或修改 COM Acl。

## <a name="what-settings-are-added-or-changed-in-windows-xp-service-pack-2"></a>Windows XP Service Pack 2 中新增或變更了哪些設定？

> [!Caution]  
> 不當使用這些設定可能會導致使用 DCOM 的應用程式和 Windows 元件失敗。

 

在下表中，會使用這些縮寫：

LL-本機啟動

LA-本機啟用

RL-遠端啟動

RA-遠端啟用

LC-本機存取呼叫

RC-遠端存取呼叫

ACL-存取控制清單



| 設定名稱                                                                                         | Location                                                                                                       | 先前的預設值                                                                                                                                                                     | 預設值                                                                                                                                                                                                                                                                                                                                                             | 可能值                                                                                                                                                                                                              |
|------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| **MachineLaunchRestriction**<br/>                                                              | **HKEY \_ 本機 \_ 電腦 \\ 軟體 \\ Microsoft \\ Ole**<br/>                                                 | 每個人-LL、LA、RL、RA<br/> 匿名<br/> LL、LA、RL、RA<br/>  (這是新的登錄機碼。 根據現有的行為，這些都是有效的值。 ) <br/> | 系統管理員： LL、LA、RL、RA<br/>                                                                                                                                                                                                                                                                                                                                  | Acl<br/>                                                                                                                                                                                                               |
| **MachineAccessRestriction**<br/>                                                              | **HKEY \_ 本機 \_ 電腦 \\ 軟體 \\ Microsoft \\ Ole**<br/>                                                 | 每個人-LC、RC<br/> 匿名-LC、RC<br/>  (這是新的登錄機碼。 根據現有的行為，這些都是有效的值。 ) <br/>                            | 每個人： LC、RC<br/> 匿名： LC<br/>                                                                                                                                                                                                                                                                                                                      | Acl<br/>                                                                                                                                                                                                               |
| **CallFailureLoggingLevel**<br/>                                                               | **HKEY \_ 本機 \_ 電腦 \\ 軟體 \\ Microsoft \\ Ole**<br/>                                                 | 不適用。<br/>                                                                                                                                                                 | 此登錄機碼不存在;不過，遺漏的索引鍵或值會被解釋為2。<br/> 依預設不會記錄此事件。 如果您將此值變更為1以開始記錄這項資訊，以協助您疑難排解問題，請務必監視事件記錄檔的大小，因為這是可以產生大量專案的事件。<br/> | 1-在 COM 伺服器進程的呼叫期間一律記錄事件記錄檔失敗。<br/> 2-永遠不會在呼叫伺服器進程的呼叫期間記錄事件記錄檔失敗。<br/>                                                  |
| **InvalidSecurityDescriptorLoggingLevel**<br/>                                                 | **HKEY \_ 本機 \_ 電腦 \\ 軟體 \\ Microsoft \\ Ole**<br/>                                                 | 不適用。<br/>                                                                                                                                                                 | 此登錄機碼不存在;不過，遺漏的索引鍵或值會被解釋為1。<br/> 預設會記錄此事件。 這種情況很少發生。<br/>                                                                                                                                                                                                    | 1-當 COM 基礎結構找到不正確安全描述項時，一律記錄事件記錄檔失敗。<br/> 2-當 COM 基礎結構找不到不正確安全描述項時，永遠不會記錄事件記錄檔失敗。<br/> |
| DCOM：安全描述項定義語言中的電腦啟動限制 (SDDL) 語法<br/> |  (群組原則物件) 電腦 \\ 設定 Windows 設定 \\ 本機原則 \\ 安全性選項<br/>  | 不適用。<br/>                                                                                                                                                                 | 未定義<br/>                                                                                                                                                                                                                                                                                                                                                    | SDDL 格式的存取控制清單。 此原則的存在會覆寫 MachineLaunchRestriction 中的值（先前為）。<br/>                                                                                            |
| DCOM：安全描述項定義語言中的電腦存取限制 (SDDL) 語法<br/> |  (群組原則物件) 電腦 \\ 設定 Windows 設定 \\ 本機原則 \\ 安全性選項<br/> | 不適用。<br/>                                                                                                                                                                 | 未定義<br/>                                                                                                                                                                                                                                                                                                                                                    | SDDL 格式的存取控制清單。 此原則的存在會覆寫 MachineAccessRestriction 中的值（先前為）。<br/>                                                                                            |



 

## <a name="what-settings-are-added-or-changed-in-windows-server-2003-service-pack-1"></a>Windows Server 2003 Service Pack 1 中新增或變更了哪些設定？

> [!Note]  
> 不當使用這些設定可能會導致使用 DCOM 的應用程式和 Windows 元件失敗。

 

在下表中，會使用這些縮寫：

LL-本機啟動

LA-本機啟用

RL-遠端啟動

RA-遠端啟用

LC-本機存取呼叫

RC-遠端存取呼叫

ACL-存取控制清單



| 設定名稱                                                                                         | Location                                                                                                       | 先前的預設值                                                                                                                                                             | 預設值                                                                                                                                                                                                                                                                                                                                                             | 可能值                                                                                                                                                                                                              |
|------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| **MachineLaunchRestriction**<br/>                                                              | **HKEY \_ 本機 \_ 電腦 \\ 軟體 \\ Microsoft \\ Ole**<br/>                                                 | 每個人： LL、LA、RL、RA<br/> 匿名： LL、LA、RL、RA<br/>  (這是新的登錄機碼。 根據現有的行為，這些都是有效的值。 ) <br/> | 系統管理員： LL、LA、RL、RA<br/> 每個人： LL、LA<br/> Distributed COM users： LL、LA、RL、RA<br/>                                                                                                                                                                                                                                                     | Acl<br/>                                                                                                                                                                                                               |
| **MachineAccessRestriction**<br/>                                                              | **HKEY \_ 本機 \_ 電腦 \\ 軟體 \\ Microsoft \\ Ole**<br/>                                                 | 每個人： LC、RC<br/> 匿名： LC、RC<br/>  (這是新的登錄機碼。 根據現有的行為，這些都是有效的值。 ) <br/>                 | 每個人： LC、RC<br/> 匿名： LC、RC<br/>                                                                                                                                                                                                                                                                                                                  | Acl<br/>                                                                                                                                                                                                               |
| **CallFailureLoggingLevel**<br/>                                                               | **HKEY \_ 本機 \_ 電腦 \\ 軟體 \\ Microsoft \\ Ole**<br/>                                                 | 不適用。<br/>                                                                                                                                                         | 此登錄機碼不存在;不過，遺漏的索引鍵或值會被解釋為2。<br/> 依預設不會記錄此事件。 如果您將此值變更為1以開始記錄這項資訊，以協助您疑難排解問題，請務必監視事件記錄檔的大小，因為這是可以產生大量專案的事件。<br/> | 1-當 COM 基礎結構找到不正確安全描述項時，一律記錄事件記錄檔失敗。<br/> 2-當 COM 基礎結構找不到不正確安全描述項時，永遠不會記錄事件記錄檔失敗。<br/> |
| **InvalidSecurityDescriptorLoggingLevel**<br/>                                                 | **HKEY \_ 本機 \_ 電腦 \\ 軟體 \\ Microsoft \\ Ole**<br/>                                                 | 不適用。<br/>                                                                                                                                                         | 此登錄機碼不存在;不過，遺漏的索引鍵或值會被解釋為1。<br/> 預設會記錄此事件。 這種情況很少發生。<br/>                                                                                                                                                                                                    | 1-當 COM 基礎結構發現不正確安全描述項時，一律記錄事件記錄檔失敗。<br/> 2-當 COM 基礎結構找不到不正確安全描述項時，永遠不會記錄事件記錄檔失敗。<br/>         |
| DCOM：安全描述項定義語言中的電腦啟動限制 (SDDL) 語法<br/> |  (群組原則物件) 電腦 \\ 設定 Windows 設定 \\ 本機原則 \\ 安全性選項<br/> | 不適用。<br/>                                                                                                                                                         | 未定義。<br/>                                                                                                                                                                                                                                                                                                                                                   | SDDL 格式的存取控制清單。 此原則的存在會覆寫 MachineLaunchRestriction 中的值（先前為）。<br/>                                                                                            |
| DCOM：安全描述項定義語言中的電腦存取限制 (SDDL) 語法<br/> |  (群組原則物件) 電腦 \\ 設定 Windows 設定 \\ 本機原則 \\ 安全性選項<br/> | 不適用。<br/>                                                                                                                                                         | 未定義。<br/>                                                                                                                                                                                                                                                                                                                                                   | SDDL 格式的存取控制清單。 此原則的存在會覆寫 MachineAccessRestriction 中的值（先前為）。<br/>                                                                                            |



 

## <a name="related-topics"></a>相關主題

<dl> <dt>

[COM 中的安全性](security-in-com.md)
</dt> </dl>

 

