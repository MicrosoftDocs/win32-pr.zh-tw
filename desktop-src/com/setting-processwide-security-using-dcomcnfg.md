---
title: 使用 DCOMCNFG 設定 Process-Wide 安全性
description: 如果應用程式的安全性需求與電腦上其他應用程式所需的安全性需求不同，您可能會想要啟用特定應用程式的安全性。
ms.assetid: 04a7f688-78a3-490a-bcfa-862824a05422
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c5ace37c685748983d36b8a1e27a406fb8a81034d82ab793e77c4def960dfa2a
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/11/2021
ms.locfileid: "118309103"
---
# <a name="setting-process-wide-security-using-dcomcnfg"></a>使用 DCOMCNFG 設定 Process-Wide 安全性

如果應用程式的安全性需求與電腦上其他應用程式所需的安全性需求不同，您可能會想要啟用特定應用程式的安全性。 比方說，您可能會決定針對需要低層級安全性的應用程式使用全系統設定，同時為特定應用程式設定更高層級的安全性。

不過，有時不會使用登錄中套用至特定應用程式的安全性設定。 例如，如果用戶端呼叫 [**CoSetProxyBlanket**](/windows/desktop/api/combaseapi/nf-combaseapi-cosetproxyblanket) 來設定特定介面 proxy 的安全性，則會覆寫您在登錄中使用 Dcomcnfg.exe 設定的整個進程設定。 同樣地，如果用戶端或伺服器 (或兩個) 呼叫 [**CoInitializeSecurity**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializesecurity) 來設定處理常式的安全性，則會忽略登錄中的設定，而會改用指定給 **CoInitializeSecurity** 的參數。

啟用應用程式的安全性時，可能需要修改數個設定。 這些包括驗證層級、位置、啟動許可權、存取權限和身分識別。 如需逐步程式，請參閱下列主題：

-   [設定應用程式的驗證層級](#setting-the-authentication-level-for-an-application)
-   [設定應用程式的位置](#setting-the-location-for-an-application)
-   [設定應用程式的啟動許可權](#setting-launch-permissions-for-an-application)
-   [設定應用程式的存取權限](#setting-access-permissions-for-an-application)
-   [設定應用程式的身分識別](#setting-the-identity-for-an-application)
-   [流覽使用者資料庫](#browsing-the-user-database)
-   [Dcomcnfg.exe 和64位應用程式](#dcomcnfgexe-and-64-bit-applications)
-   [相關主題](#related-topics)

## <a name="setting-the-authentication-level-for-an-application"></a>設定應用程式的驗證層級

若要啟用應用程式的安全性，您必須設定 [無] 以外的驗證層級。 驗證層級會告知 COM 需要多少驗證保護，而且其範圍從驗證用戶端的第一個方法呼叫，到完全加密參數狀態。

**若要設定應用程式的驗證層級**

1.  在 Dcomcnfg.exe 的 [ **應用程式** ] 屬性頁上，選取應用程式，然後按一下 [ **屬性** ] 按鈕 (或按兩下選取的應用程式) 。

2.  在 [**一般**] 頁面上，從 [**驗證等級**] 清單方塊中選取 [**無 ()** 以外的驗證等級。

3.  如果您將設定此應用程式的其他屬性，請選擇 [套用 **] 按鈕以** 套用新的驗證層級。 如果您已完成設定此應用程式的屬性，而且您想要套用變更，請按一下 **[確定]** 。

## <a name="setting-the-location-for-an-application"></a>設定應用程式的位置

您為應用程式設定的位置會決定應用程式將執行的電腦。 您可以選擇在資料所在的電腦、用來設定位置的電腦，或指定的電腦上執行您的應用程式。

**若要設定應用程式的位置**

1.  當 Dcomcnfg.exe 執行時，請從 [ **應用程式** ] 頁面中選取應用程式，並選擇 [ **屬性** ] 按鈕 (或按兩下選取的應用程式) 。

2.  在 [ **位置** ] 頁面上，選取一或多個對應至您要執行應用程式之位置的核取方塊。 如果您選取一個以上的核取方塊，COM 會使用第一個套用的核取方塊。 如果 Dcomcnfg.exe 在伺服器電腦上執行，請一律選取 [ **在這部電腦上執行應用程式**]。

3.  如果您將設定此應用程式的其他屬性，請選擇 [套用 **] 按鈕以** 套用新的位置。 如果您已完成設定此應用程式的屬性，而且您想要套用變更，請選擇 **[確定]** 。

## <a name="setting-launch-permissions-for-an-application"></a>設定應用程式的啟動許可權

您可以使用 Dcomcnfg.exe 設定啟動許可權，以控制被授與或拒絕啟動特定伺服器之許可權的使用者清單。 您可以將使用者或群組新增至清單，以指定是否要授與或拒絕存取權限。 您也可以從清單中移除使用者。

**若要設定應用程式的啟動許可權**

1.  當 Dcomcnfg.exe 執行時，請從 [ **應用程式** ] 頁面中選取應用程式，並選擇 [ **屬性** ] 按鈕 (或按兩下選取的應用程式) 。

2.  在 [ **安全性** ] 屬性頁上，選取 [ **使用自訂啟動許可權** ] 選項按鈕，然後選擇相同區域中的 [ **編輯** ] 按鈕。

3.  若要移除使用者或群組，請選取您要移除的使用者或群組，然後選擇 [ **移除** ] 按鈕。 選取的使用者或群組將不會再出現在清單方塊中。 當您完成移除使用者和群組時，請選擇 **[確定]**。

4.  如果您想要新增使用者或群組，請選擇 [ **加入** ] 按鈕。

5.  如果您知道想要新增的完整使用者名稱，請在 [ **加入名稱** ] 文字方塊中輸入。 如果您不知道使用者名稱，您可以流覽使用者資料庫來尋找它 (請參閱下方的流覽使用者資料庫) 。 當您找到使用者名稱時，請從 [ **名稱** ] 清單方塊中選取使用者或群組，然後選擇 [ **加入** ] 按鈕。

6.  在 [ **存取類型** ] 清單方塊中，選取 [ **允許啟動** 或 **拒絕啟動**)  (的存取類型。 若要加入將擁有所選存取類型的其他使用者，請重複步驟5。 當您完成新增所選存取類型的使用者時，請選擇 [ **確定]** 按鈕。

7.  若要加入將擁有不同類型存取權的使用者，請重複步驟5和6。 否則，請選擇 **[確定]** 以套用變更。

## <a name="setting-access-permissions-for-an-application"></a>設定應用程式的存取權限

使用 Dcomcnfg.exe，您可以藉由設定存取權限，來管理被授與或拒絕存取特定伺服器之方法的使用者清單。 您可以將使用者或群組新增至清單，以指定是否要授與或拒絕存取權限。 您也可以從清單中移除使用者。

設定存取權限時，您必須確定系統已包含在被授與存取權的使用者清單中。 如果您已將存取權限授與所有人，系統會隱含地包含。

設定應用程式存取權限的程式與設定啟動許可權類似。 步驟如下所示。

**若要設定應用程式的存取權限**

1.  當 Dcomcnfg.exe 執行時，請從 [ **應用程式** ] 頁面中選取應用程式，並選擇 [ **屬性** ] 按鈕 (或按兩下選取的應用程式) 。

2.  在 [ **安全性** ] 屬性頁上，選取 [ **使用自訂存取權限** ] 選項按鈕，然後選擇相同區域中的 [ **編輯** ] 按鈕。

3.  若要移除使用者或群組，請選取您要移除的使用者或群組，然後選擇 [ **移除** ] 按鈕。 選取的使用者或群組將不會再出現在清單方塊中。 當您完成移除使用者和群組時，請選擇 **[確定]**。

4.  如果您想要新增使用者或群組，請選擇 [ **加入** ] 按鈕。

5.  如果您知道想要新增的完整使用者名稱，請在 [ **加入名稱** ] 文字方塊中輸入。 如果您不知道使用者名稱，您可以流覽使用者資料庫來尋找它。 當您找到使用者名稱時，請從 [ **名稱** ] 清單方塊中選取使用者或群組，然後選擇 [ **加入** ] 按鈕。

6.  在 [ **存取類型** ] 清單方塊中，選取 [ **允許存取** ] 或 [ **拒絕存取** ])  (存取類型。 若要加入將擁有所選存取類型的其他使用者，請重複步驟5。 當您完成新增所選存取類型的使用者時，請選擇 [ **確定]** 按鈕。

7.  若要加入將擁有不同類型存取權的使用者，請重複步驟5和6。 否則，請選擇 **[確定]** 以套用變更。

## <a name="setting-the-identity-for-an-application"></a>設定應用程式的身分識別

應用程式的身分識別是用來執行應用程式的帳戶。 身分識別可以是目前登入 (互動式使用者) 的使用者、啟動伺服器之用戶端進程的使用者帳戶、指定的使用者或服務。 您可以使用 Dcomcnfg.exe 來選擇應用程式的其中一個身分識別。 如需決定要為應用程式設定之身分識別的說明，請參閱 [應用程式識別](application-identity.md)。

**設定應用程式的身分識別**

1.  當 Dcomcnfg.exe 執行時，請從 [ **應用程式** ] 頁面中選取應用程式，並選擇 [ **屬性** ] 按鈕 (或按兩下選取的應用程式) 。

2.  在 [身分 **識別** ] 屬性頁上，選取您要的身分識別的選項按鈕。 如果您選擇 **此使用者**，您必須輸入使用者名稱、密碼和確認的密碼。

3.  如果您將設定此應用程式的其他屬性，請選擇 [套用 **] 按鈕以** 套用新的身分識別。 如果您已完成設定此應用程式的屬性，而且您想要套用變更，請選擇 **[確定]** 。

## <a name="browsing-the-user-database"></a>流覽使用者資料庫

當您需要尋找特定使用者的完整使用者名稱時，請流覽 Dcomcnfg.exe 中的使用者資料庫。 例如，您可以流覽使用者資料庫，找出您想要新增以取得存取權或啟動許可權的使用者。

**流覽使用者資料庫**

1.  在 [ **清單名稱來源** ] 清單方塊中，選取包含您要新增之使用者或群組的網域。

2.  若要查看屬於所選網域的使用者，請選擇 [ **顯示使用者** ] 按鈕。

3.  若要查看特定群組的成員，請在 [ **名稱** ] 清單方塊中選取群組，然後選擇 [ **顯示成員** ] 按鈕。

4.  如果您找不到想要新增的使用者或群組，請選擇 [ **搜尋** ] 按鈕，這會顯示 [ **尋找帳戶** ] 對話方塊。 選取您要搜尋的網域 (或選取 [ **搜尋所有**) ]，輸入您想要尋找的使用者名稱，然後選擇 [ **搜尋** ] 按鈕。

## <a name="dcomcnfgexe-and-64-bit-applications"></a>Dcomcnfg.exe 和64位應用程式

在 x64 作業系統上 Windows XP 到 Windows Server 2008，64位版本的 DCOMCNFG.EXE 不會正確地設定32位的 DCOM 應用程式以進行遠端啟用。 這種行為會導致以遠端方式啟動的元件，而不是在本機啟用。 Windows 7 和 Windows Server 2008 R2 和更新版本中不會發生這種行為。

解決方法是使用32位版本的 DCOMCNFG。 執行 mmc.exe 的32位版本，並使用下列命令列載入32位版本的元件服務嵌入式管理單元。

C： \\ WINDOWS \\ SysWOW64>**mmc comexp.msc services.msc/32**

32位版本的元件服務會正確地註冊32位的 DCOM 應用程式以進行遠端啟用。

## <a name="related-topics"></a>相關主題

<dl> <dt>

[設定 Process-Wide 安全性](setting-processwide-security.md)
</dt> </dl>

 

 




