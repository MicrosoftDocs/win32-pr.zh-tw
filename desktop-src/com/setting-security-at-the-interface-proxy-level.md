---
title: 在介面 Proxy 層級設定安全性
description: 有時候，用戶端需要對特定介面的呼叫安全性進行細微的控制。
ms.assetid: 72925ca2-78c9-47d9-8760-63f6379326d2
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 1b38fe83e8ce8841cc9029808a6947ec67d4eaf4
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/21/2020
ms.locfileid: "106968935"
---
# <a name="setting-security-at-the-interface-proxy-level"></a><span data-ttu-id="47023-103">在介面 Proxy 層級設定安全性</span><span class="sxs-lookup"><span data-stu-id="47023-103">Setting Security at the Interface Proxy Level</span></span>

<span data-ttu-id="47023-104">有時候，用戶端需要對特定介面的呼叫安全性進行細微的控制。</span><span class="sxs-lookup"><span data-stu-id="47023-104">Sometimes the client needs fine-grained control over the security on calls to particular interfaces.</span></span> <span data-ttu-id="47023-105">例如，可能會針對進程設定較低層級的安全性，但對特定介面的呼叫可能需要較高的驗證層級，例如加密。</span><span class="sxs-lookup"><span data-stu-id="47023-105">For example, security might be set at a low level for the process but calls to a particular interface might require a higher authentication level, such as encryption.</span></span> <span data-ttu-id="47023-106">[**IClientSecurity**](/windows/desktop/api/ObjIdl/nn-objidl-iclientsecurity)介面的方法可讓用戶端藉由控制介面 proxy 層級的安全性設定，來變更與特定介面呼叫相關聯的安全性設定。</span><span class="sxs-lookup"><span data-stu-id="47023-106">The methods of the [**IClientSecurity**](/windows/desktop/api/ObjIdl/nn-objidl-iclientsecurity) interface allow the client to change the security settings associated with calls to a particular interface by controlling the security settings at the interface-proxy level.</span></span>

<span data-ttu-id="47023-107">用戶端可以查詢現有的物件以進行 [**IClientSecurity**](/windows/desktop/api/ObjIdl/nn-objidl-iclientsecurity) ，然後呼叫 [**IClientSecurity：： QueryBlanket**](/windows/win32/api/objidl/nf-objidl-iclientsecurity-queryblanket) 方法，找出特定介面 proxy 目前的安全性設定。</span><span class="sxs-lookup"><span data-stu-id="47023-107">The client can query an existing object for [**IClientSecurity**](/windows/desktop/api/ObjIdl/nn-objidl-iclientsecurity) and then call the [**IClientSecurity::QueryBlanket**](/windows/win32/api/objidl/nf-objidl-iclientsecurity-queryblanket) method to find out what the current security settings are for a particular interface proxy.</span></span> <span data-ttu-id="47023-108">[**IClientSecurity：： SetBlanket**](/windows/win32/api/objidl/nf-objidl-iclientsecurity-setblanket)方法可以用來修改物件上個別介面 proxy 的安全性設定，然後再呼叫其中一個介面方法。</span><span class="sxs-lookup"><span data-stu-id="47023-108">The [**IClientSecurity::SetBlanket**](/windows/win32/api/objidl/nf-objidl-iclientsecurity-setblanket) method can be used to modify the security settings for an individual interface proxy on the object before calling one of the interface's methods.</span></span> <span data-ttu-id="47023-109">新的設定會套用到此特定介面的任何未來呼叫者。</span><span class="sxs-lookup"><span data-stu-id="47023-109">The new settings apply to any future callers of this particular interface.</span></span> <span data-ttu-id="47023-110">[**IClientSecurity：： CopyProxy**](/windows/win32/api/objidl/nf-objidl-iclientsecurity-copyproxy)方法提供一種方式，讓用戶端複製介面 proxy，以便後續對複本的 **SetBlanket** 呼叫不會影響原始 proxy 的呼叫端。</span><span class="sxs-lookup"><span data-stu-id="47023-110">The [**IClientSecurity::CopyProxy**](/windows/win32/api/objidl/nf-objidl-iclientsecurity-copyproxy) method provides a way for the client to copy an interface proxy so that subsequent calls to **SetBlanket** on the copy do not affect callers of the original proxy.</span></span>

<span data-ttu-id="47023-111">[**SetBlanket**](/windows/win32/api/objidl/nf-objidl-iclientsecurity-setblanket) 通常用來將特定介面 proxy 的驗證層級提升至更高層級的安全性保護。</span><span class="sxs-lookup"><span data-stu-id="47023-111">[**SetBlanket**](/windows/win32/api/objidl/nf-objidl-iclientsecurity-setblanket) is commonly used to raise the authentication level for a particular interface proxy to a higher level of security protection.</span></span> <span data-ttu-id="47023-112">不過，在某些情況下，降低特定介面 proxy 的驗證層級也會很有説明。</span><span class="sxs-lookup"><span data-stu-id="47023-112">However, in some situations, it might also be helpful to lower the authentication level for a particular interface proxy.</span></span> <span data-ttu-id="47023-113">例如，假設進程的預設驗證層級是 RPC \_ C 驗證層級以外的某個 \_ 值 \_ \_ ，而且用戶端和伺服器位於不信任彼此的不同網域中。</span><span class="sxs-lookup"><span data-stu-id="47023-113">For instance, suppose the default authentication level for the process is some value other than RPC\_C\_AUTHN\_LEVEL\_NONE and the client and server are in separate domains that do not trust each other.</span></span> <span data-ttu-id="47023-114">在此情況下，除非用戶端呼叫 **SetBlanket** 將驗證層級降低至 RPC \_ C \_ 驗證 \_ 層級 NONE，否則對伺服器的呼叫將會失敗 \_ 。</span><span class="sxs-lookup"><span data-stu-id="47023-114">In this case, calls to the server will fail unless the client calls **SetBlanket** to lower the authentication level to RPC\_C\_AUTHN\_LEVEL\_NONE.</span></span>

<span data-ttu-id="47023-115">使用 proxy 管理員所提供之 [**IClientSecurity**](/windows/desktop/api/ObjIdl/nn-objidl-iclientsecurity) 預設實作為的用戶端，可以呼叫 [**CoQueryProxyBlanket**](/windows/desktop/api/combaseapi/nf-combaseapi-coqueryproxyblanket)、 [**CoSetProxyBlanket**](/windows/desktop/api/combaseapi/nf-combaseapi-cosetproxyblanket)和 [**CoCopyProxy**](/windows/desktop/api/combaseapi/nf-combaseapi-cocopyproxy) helper 函式，而不是直接呼叫 **IClientSecurity** 方法。</span><span class="sxs-lookup"><span data-stu-id="47023-115">Clients using the default implementation of [**IClientSecurity**](/windows/desktop/api/ObjIdl/nn-objidl-iclientsecurity) provided by the proxy manager can call the [**CoQueryProxyBlanket**](/windows/desktop/api/combaseapi/nf-combaseapi-coqueryproxyblanket), [**CoSetProxyBlanket**](/windows/desktop/api/combaseapi/nf-combaseapi-cosetproxyblanket), and [**CoCopyProxy**](/windows/desktop/api/combaseapi/nf-combaseapi-cocopyproxy) helper functions instead of calling **IClientSecurity** methods directly.</span></span> <span data-ttu-id="47023-116">Helper 函式可簡化程式碼，但比直接呼叫對應的 **IClientSecurity** 方法稍微低一點。</span><span class="sxs-lookup"><span data-stu-id="47023-116">The helper functions simplify the code but are slightly less efficient than calling the corresponding **IClientSecurity** methods directly.</span></span>

<span data-ttu-id="47023-117">Proxy 管理員會為用戶端在本機執行 [**IClientSecurity**](/windows/desktop/api/ObjIdl/nn-objidl-iclientsecurity) 介面。</span><span class="sxs-lookup"><span data-stu-id="47023-117">The [**IClientSecurity**](/windows/desktop/api/ObjIdl/nn-objidl-iclientsecurity) interface is implemented locally for the client by the proxy manager.</span></span> <span data-ttu-id="47023-118">某些自訂封送處理的物件可能不支援 **IClientSecurity**。</span><span class="sxs-lookup"><span data-stu-id="47023-118">Some custom marshaled objects might not support **IClientSecurity**.</span></span>

<span data-ttu-id="47023-119">[**IClientSecurity**](/windows/desktop/api/ObjIdl/nn-objidl-iclientsecurity) 適用于所有支援的驗證服務 (目前的 NTLMSSP、Schannel 和 Kerberos v5 通訊協定) 。</span><span class="sxs-lookup"><span data-stu-id="47023-119">[**IClientSecurity**](/windows/desktop/api/ObjIdl/nn-objidl-iclientsecurity) works with all supported authentication services (currently NTLMSSP, Schannel, and the Kerberos v5 protocol).</span></span>

## <a name="related-topics"></a><span data-ttu-id="47023-120">相關主題</span><span class="sxs-lookup"><span data-stu-id="47023-120">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="47023-121">設定 COM 應用程式的安全性</span><span class="sxs-lookup"><span data-stu-id="47023-121">Setting Security for COM Applications</span></span>](setting-security-for-com-applications.md)
</dt> </dl>

 

 