---
title: 拖放
description: 拖放指的是使用滑鼠或其他指標裝置來指定資料來源和其目的地的資料傳輸。
ms.assetid: bba0ddf8-fcf9-4827-bf85-7ac597d33b4b
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b388fc6c051fa73c72720d1f349cd50a4fa6902b8f880fbf5ccfb4cf263a4227
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/11/2021
ms.locfileid: "119993158"
---
# <a name="drag-and-drop"></a>拖放

*拖放* 指的是使用滑鼠或其他指標裝置來指定資料來源和其目的地的資料傳輸。 在典型的拖放作業中，使用者會選取要傳送的物件，方法是將滑鼠指標移至該物件，然後按住左鍵或針對此用途指定的其他按鈕。 當繼續按住按鈕時，使用者可以藉由將物件拖曳至其目的地（可以是任何 OLE 容器）來起始轉移。 拖放功能提供與 OLE 剪貼簿複製並貼上完全相同的功能，但新增了視覺效果的意見反應，並免除了功能表的需求。 事實上，如果應用程式支援剪貼簿複製並貼上，則需要額外的額外部分才能支援拖放。

在 OLE 拖放作業期間，會使用下列三個不同的程式碼片段。



| 拖放程式碼來源                               | 執行和使用                                                                                                                                                                      |
|---------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [**IDropSource**](/windows/desktop/api/OleIdl/nn-oleidl-idropsource) 介面<br/> | 由包含拖曳資料的物件所執行，稱為 *拖曳來源*。<br/>                                                                                         |
| [**IDropTarget**](/windows/desktop/api/OleIdl/nn-oleidl-idroptarget) 介面<br/> | 由預期接受卸載的物件所實，稱為「卸載目標」（ *drop target*）。<br/>                                                                                 |
| [**DoDragDrop**](/windows/desktop/api/Ole2/nf-ole2-dodragdrop) 函式<br/>    | 由 OLE 所執行，可用來起始拖放作業。 作業進行之後，它會促進拖曳來源與放置目標之間的通訊。<br/> |



 

[**IDropSource**](/windows/desktop/api/OleIdl/nn-oleidl-idropsource)和 [**IDropTarget**](/windows/desktop/api/OleIdl/nn-oleidl-idroptarget)介面可以在容器或物件應用程式中實作為。 拖曳來源或卸載目標的角色不限於任何一種類型的 OLE 應用程式。

OLE 函式 [**DoDragDrop**](/windows/desktop/api/Ole2/nf-ole2-dodragdrop) 會執行迴圈來追蹤滑鼠和鍵盤的移動，直到拖曳取消或發生卸載時為止。 **DoDragDrop** 是拖放程式中的主要功能，可加速拖曳來源和放置目標之間的通訊。

在拖放作業期間，會向使用者顯示三種類型的意見反應。



| 意見反應類型            | 描述                                                                                                                                                                                                                                                                                                                                                      |
|-----------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 來源意見反應<br/>  | 在拖曳來源提供的情況下，來源意見反應會指出資料正在拖曳，而且在拖曳過程中不會變更。 一般而言，資料會反白顯示，以表示已選取該資料。<br/>                                                                                                                                            |
| 指標意見反應<br/> | 指標意見反應是由拖曳來源提供，指出當滑鼠在任何指定時間放開時，會發生什麼事。 指標意見反應會在使用者移動滑鼠和/或按下輔助按鍵時持續變更。 例如，如果指標移至無法接受 drop 的視窗，指標會變成「不允許」符號。<br/> |
| 目標意見反應<br/>  | 由放置目標提供，目標意見反應會指出放置的發生位置。<br/>                                                                                                                                                                                                                                                                    |



 

如需詳細資訊，請參閱 [拖曳來源責任](drag-source-responsibilities.md)。

## <a name="related-topics"></a>相關主題

<dl> <dt>

[資料轉送](data-transfer.md)
</dt> </dl>

 

 





