---
title: 介面的支援代表
description: 介面的支援代表
ms.assetid: fa5eae0f-2252-43bc-b504-de00b213cb2a
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 1e169ca193a24e1f532d054bf21d5262edef3036
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/21/2020
ms.locfileid: "104508152"
---
# <a name="what-support-for-an-interface-means"></a>介面的支援代表

除了 [**IUnknown**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown) 介面，ActiveX 控制項或 COM 物件也會透過其他介面來表示它所支援的任何選用功能。 這就是說， **IUnknown** 上面不需要其他介面。 最後，下表列出 ActiveX 控制項可能支援的介面，以及支援該介面的意義。



| 介面                                                                                                                                                                                                                                                                                                                                                                       | 批註/支援介面的意義                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [**IOleObject**](/windows/desktop/api/OleIdl/nn-oleidl-ioleobject)<br/>                                                                                                                                                                                                                                                                                                                                     | 如果控制項需要與用戶端網站進行事件以外的其他任何事件 (請參閱 [**IConnectionPointContainer**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpointcontainer)) ，則 [**IOleObject**](/windows/desktop/api/OleIdl/nn-oleidl-ioleobject) 是必要的。 在實作為這個介面時，控制項也必須支援下列方法的語法： [**SetHostNames**](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-sethostnames)、 [**Close**](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-close)、 [**EnumVerbs**](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-enumverbs)、 [**Update**](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-update)、 [**IsUpToDate**](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-isuptodate)、 [**GetUserClassID**](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-getuserclassid)、 [**GetUserType**](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-getusertype)、 [**GetMiscStatus**](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-getmiscstatus)，以及搭配容器 [**Unadvise**](/windows/desktop/api/ObjIdl/nn-objidl-iadvisesink)執行的 [**建議**](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-advise)、 [**EnumAdvise**](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-unadvise)和 [**IAdviseSink**](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-enumadvise)方法。 如果容器提供一個控制項，則執行 **IOleObject** 的控制項必須能夠處理 **IAdviseSink** ;容器可能不會，在此情況下，控制項可確保不會嘗試呼叫不存在的接收。<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| [**IOleInPlaceObject**](/windows/desktop/api/OleIdl/nn-oleidl-ioleinplaceobject)<br/>                                                                                                                                                                                                                                                                                                                       | 表示控制項在就地啟用且可能啟用 UI 的能力。 這個介面表示控制項有某種類型的使用者介面可以啟用，而且也支援 [**IOleInPlaceActiveObject**](/windows/desktop/api/OleIdl/nn-oleidl-ioleinplaceactiveobject) 。 必要的方法為 [**GetWindow**](/windows/desktop/api/OleIdl/nf-oleidl-iolewindow-getwindow)、 [**InPlaceDeactivate**](/windows/desktop/api/OleIdl/nf-oleidl-ioleinplaceobject-inplacedeactivate)、 [**UIDeactivate**](/windows/desktop/api/OleIdl/nf-oleidl-ioleinplaceobject-uideactivate)、 [**SetObjectRects**](/windows/desktop/api/OleIdl/nf-oleidl-ioleinplaceobject-setobjectrects)和 [**ReactivateAndUndo**](/windows/desktop/api/OleIdl/nf-oleidl-ioleinplaceobject-reactivateandundo)。 支援此介面需要 [**IOleObject**](/windows/desktop/api/OleIdl/nn-oleidl-ioleobject)。<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| [**IOleInPlaceActiveObject**](/windows/desktop/api/OleIdl/nn-oleidl-ioleinplaceactiveobject)<br/>                                                                                                                                                                                                                                                                                                           | 支援 [**IOleInPlaceObject**](/windows/desktop/api/OleIdl/nn-oleidl-ioleinplaceobject) 的就地支持對象也必須提供這個介面，雖然控制項本身不一定會直接執行介面。<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| [**IOleControl**](/windows/desktop/api/OCIdl/nn-ocidl-iolecontrol)<br/>                                                                                                                                                                                                                                                                                                                                   | 表示控制項的能力，並想要處理 () 助憶鍵 ([**GetControlInfo**](/windows/desktop/api/OCIdl/nf-ocidl-iolecontrol-getcontrolinfo)、 [**OnMnemonic**](/windows/desktop/api/OCIdl/nf-ocidl-iolecontrol-onmnemonic) 方法) 、 (b) 環境屬性 ([**OnAmbientPropertyChange**](/windows/desktop/api/OCIdl/nf-ocidl-iolecontrol-onambientpropertychange)) 和/或 (c) 事件，控制項要求容器處理 ([**FreezeEvents**](/windows/desktop/api/OCIdl/nf-ocidl-iolecontrol-freezeevents)) 。 請注意，助憶鍵與透過 [**IOleInPlaceActiveObject**](/windows/desktop/api/OleIdl/nn-oleidl-ioleinplaceactiveobject)處理的快速鍵不同：助憶鍵具有相關聯的 ui，即使控制項不是 ui 作用中，也是作用中。 控制項對助憶鍵的支援表示控制項也知道如何使用容器的 [**>iolecontrolsite：： OnControlInfoChanged**](/windows/desktop/api/OCIdl/nf-ocidl-iolecontrolsite-oncontrolinfochanged) 方法。 因為這需要控制項知道容器的網站，所以對助憶鍵的支援也表示支援 [**IOleObject**](/windows/desktop/api/OleIdl/nn-oleidl-ioleobject)。 此外，助憶鍵的知識需要就地支援，因此 [**IOleInPlaceObject**](/windows/desktop/api/OleIdl/nn-oleidl-ioleinplaceobject)。<br/> 如果控制項使用任何容器環境的屬性，則它也必須執行此介面來接收變更通知，因為必須遵循變更的語法。 因為環境屬性僅透過容器網站 **IDispatch** 提供，環境屬性支援表示該控制項支援 [**IOleObject**](/windows/desktop/api/OleIdl/nn-oleidl-ioleobject) (以取得網站) ，以及能夠產生 **IDispatch：： Invoke** 呼叫。<br/> [**FreezeEvents**](/windows/desktop/api/OCIdl/nf-ocidl-iolecontrol-freezeevents)方法對於必須知道容器何時不會處理事件的控制項而言是必要的，這是控制這種情況的唯一方法。 如果 **FreezeEvents** 只需要隔離，則不會執行其他 [**IOleControl**](/windows/desktop/api/OCIdl/nn-ocidl-iolecontrol) 方法，則 **IOleControl** 可以獨立，而不需要 [**IOleObject**](/windows/desktop/api/OleIdl/nn-oleidl-ioleobject) 或 [**IOleInPlaceObject**](/windows/desktop/api/OleIdl/nn-oleidl-ioleinplaceobject)。<br/> |
| [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject)<br/>                                                                                                                                                                                                                                                                                                                                   | 指出控制項可提供至少 (控制項的) 圖形化轉譯 (CF \_ METAFILEPICT 是最小值，如果控制項有任何要提供的屬性，則為控制項在所有) 和/或 (b) 屬性集都有任何視覺效果。 需要 [**QueryGetData**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-querygetdata)、 [**EnumFormatEtc**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-enumformatetc)、 [**DAdvise**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-dadvise)、 [**DUnadvise**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-dunadvise)和 [**EnumDAdvise**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-enumdadvise) [**方法。**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-getdata) CF METAFILEPICT 以外的圖形格式支援 \_ 是選擇性的。<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| [**IViewObject2**](/windows/desktop/api/OleIdl/nn-oleidl-iviewobject2)<br/>                                                                                                                                                                                                                                                                                                                                 | 指出控制項有一些有趣的視覺效果，但未啟用。 如果已執行，則控制項必須支援方法 [**Draw**](/windows/desktop/api/OleIdl/nf-oleidl-iviewobject-draw)、 [**GetAdvise**](/windows/desktop/api/OleIdl/nf-oleidl-iviewobject-getadvise)、 [**SetAdvise**](/windows/desktop/api/OleIdl/nf-oleidl-iviewobject-setadvise)和 [**GetExtent**](/windows/desktop/api/OleIdl/nf-oleidl-iviewobject2-getextent)。<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| **IDispatch**<br/>                                                                                                                                                                                                                                                                                                                                                        | 指出控制項有 () 自訂方法，或 (b) 可透過 **IDispatch：： Invoke** 進行晚期繫結的自訂屬性。 這也需要控制項透過其他 **IDispatch** 方法提供類型資訊。 控制項可能會支援多個 **idispatch** 執行，其中只有一個與 IID \_ IDispatch 相關聯，而其他則必須有自己的唯一的分配介面識別碼。<br/> 建議您為自訂方法和屬性存取提供雙重介面的控制項，但如果有方法和屬性，則這是選擇性的。<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| [**IConnectionPointContainer**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpointcontainer)<br/>                                                                                                                                                                                                                                                                                                       | 指出控制項至少支援一個輸出介面，例如事件或屬性變更通知。 如果有此介面可供使用，則必須實作為此介面的所有方法，包括需要具有 [**IEnumConnectionPoints**](/windows/desktop/api/ocidl/nn-ocidl-ienumconnectionpoints)之個別物件的 [**EnumConnectionPoints**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpointcontainer-enumconnectionpoints) 。<br/> [**IConnectionPointContainer**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpointcontainer)的支援表示物件也支援一或多個具有 [**IConnectionPoint**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpoint)的相關物件，這些物件可透過 **IConnectionPointContainer** 方法取得。 每個連接點物件本身都必須執行完整 **IConnectionPoint** 介面（包括 [**EnumConnections**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpoint-enumconnections)），而此介面需要具有 [**IEnumConnections**](/windows/desktop/api/ocidl/nn-ocidl-ienumconnections) 介面的另一個列舉值物件。<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| [**IProvideClassInfo**](/windows/desktop/api/OCIdl/nn-ocidl-iprovideclassinfo)<br/> [**Iprovideclassinfo2.getguid**](/windows/desktop/api/OCIdl/nn-ocidl-iprovideclassinfo2)<br/>                                                                                                                                                                                                                                                           | 指出物件可以直接透過 [**IProvideClassInfo：： GetClassInfo**](/windows/desktop/api/OCIdl/nf-ocidl-iprovideclassinfo-getclassinfo)提供自己的 coclass 型別資訊。 如果控制項支援較新的變化 [**iprovideclassinfo2.getguid**](/windows/desktop/api/OCIdl/nn-ocidl-iprovideclassinfo2)，它也會指出其透過 [**Iprovideclassinfo2.getguid：： GetGUID**](/windows/desktop/api/OCIdl/nf-ocidl-iprovideclassinfo2-getguid)提供其主要來源 IID 的能力。 此介面的所有方法都必須實作為。<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| [**ISpecifyPropertyPages**](/windows/desktop/api/OCIdl/nn-ocidl-ispecifypropertypages)<br/>                                                                                                                                                                                                                                                                                                               | 指出控制項具有可顯示的屬性頁，讓容器可以在屬性頁針對多重控制項選取專案顯示時，將這個控制項的屬性頁與其他控制項的頁面協調。 當支援存在時，必須執行此介面的所有方法。<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| [**IPerPropertyBrowsing**](/windows/desktop/api/OCIdl/nn-ocidl-iperpropertybrowsing)<br/>                                                                                                                                                                                                                                                                                                                 | 指出控制項可 () 提供屬性的顯示字串， (b) 為其屬性提供預先定義的字串和值，以及/或 (c) 將屬性 dispID 對應至特定的屬性頁。 此介面的支援表示提供了透過 IDispatch 的屬性支援（如上所示）。 如果支援 (c) ，也表示透過 [**IPerPropertyBrowsing：： MapPropertyToPage**](/windows/desktop/api/OCIdl/nf-ocidl-iperpropertybrowsing-mappropertytopage) 對應的物件屬性頁面本身會執行 [**IPropertyPage2**](/windows/desktop/api/OCIdl/nn-ocidl-ipropertypage2) ，而不是基本 [**IPropertyPage**](/windows/desktop/api/OCIdl/nn-ocidl-ipropertypage) 介面。<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| [**IPersistStream**](/windows/desktop/api/ObjIdl/nn-objidl-ipersiststream)<br/> [**IPersistStreamInit**](/windows/desktop/api/OCIdl/nn-ocidl-ipersiststreaminit)<br/> [**IPersistMemory**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa768210(v=vs.85))<br/> [**IPersistStorage**](/windows/desktop/api/ObjIdl/nn-objidl-ipersiststorage)<br/> [**IPersistMoniker**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/ms775042(v=vs.85))<br/> [**IPersistPropertyBag**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa768205(v=vs.85))<br/> | 請參閱 [持續性介面](persistence-interfaces.md)。<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| [**IOleCache**](/windows/desktop/api/OleIdl/nn-oleidl-iolecache)<br/> [**IOleCache2**](/windows/desktop/api/OleIdl/nn-oleidl-iolecache2)<br/>                                                                                                                                                                                                                                                                                           | 指出支援控制項視覺效果的容器快取。 控制項通常會透過 OLE 函數 [**CreateDataCache**](/windows/desktop/api/ObjBase/nf-objbase-createdatacache)取得快取支援。 只有具有有意義之靜態內容的控制項，才能選擇進行這項 (，但) 不需要這麼做。 如果控制項完全支援快取，則應該只匯總資料快取，並從資料快取中公開 [**IOleCache**](/windows/desktop/api/OleIdl/nn-oleidl-iolecache) 和 [**IOleCache2**](/windows/desktop/api/OleIdl/nn-oleidl-iolecache2) 介面。 如果容器提供一個控制項，則執行 [**IOleObject**](/windows/desktop/api/OleIdl/nn-oleidl-ioleobject) 的控制項必須能夠處理 [**IAdviseSink**](/windows/desktop/api/ObjIdl/nn-objidl-iadvisesink) ;容器可能不會，在此情況下，控制項可確保不會嘗試呼叫不存在的接收。<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| [**IExternalConnection**](/windows/win32/api/objidlbase/nn-objidlbase-iexternalconnection)<br/>                                                                                                                                                                                                                                                                                                                   | 指出控制項支援其本身的外部連結;也就是說，控制項不會以 OLEMISC \_ CANTLINKINSIDE 標示，並支援 [**IOleObject：： SetMoniker**](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-setmoniker) 和 [**IOleObject：： GetMoniker**](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-getmoniker)。 容器絕不會查詢這個介面本身，也不會直接呼叫它，因為呼叫是從 OLE 的遠端層內部產生的。<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| [**IRunnableObject**](/windows/desktop/api/ObjIdl/nn-objidl-irunnableobject)<br/>                                                                                                                                                                                                                                                                                                                           | 指出控制項因為某些同進程物件的執行，而區別于正在執行的狀態。<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |



 

## <a name="related-topics"></a>相關主題

<dl> <dt>

[控制項](controls.md)
</dt> </dl>

 

