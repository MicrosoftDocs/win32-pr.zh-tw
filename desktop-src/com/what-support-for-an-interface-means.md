---
title: 介面的支援代表
description: 介面的支援代表
ms.assetid: fa5eae0f-2252-43bc-b504-de00b213cb2a
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 1e169ca193a24e1f532d054bf21d5262edef3036
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/21/2020
ms.locfileid: "104508152"
---
# <a name="what-support-for-an-interface-means"></a><span data-ttu-id="2ec16-103">介面的支援代表</span><span class="sxs-lookup"><span data-stu-id="2ec16-103">What Support for an Interface Means</span></span>

<span data-ttu-id="2ec16-104">除了 [**IUnknown**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown) 介面，ActiveX 控制項或 COM 物件也會透過其他介面來表示它所支援的任何選用功能。</span><span class="sxs-lookup"><span data-stu-id="2ec16-104">Besides the [**IUnknown**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown) interface, an ActiveX Control   or COM Object for that matter   expresses whatever optional functionality it supports through additional interfaces.</span></span> <span data-ttu-id="2ec16-105">這就是說， **IUnknown** 上面不需要其他介面。</span><span class="sxs-lookup"><span data-stu-id="2ec16-105">This is to say that no other interfaces are required above **IUnknown**.</span></span> <span data-ttu-id="2ec16-106">最後，下表列出 ActiveX 控制項可能支援的介面，以及支援該介面的意義。</span><span class="sxs-lookup"><span data-stu-id="2ec16-106">To that end, the following table lists the interfaces that an ActiveX Control might support, and what it means to support that interface.</span></span>



| <span data-ttu-id="2ec16-107">介面</span><span class="sxs-lookup"><span data-stu-id="2ec16-107">Interface</span></span>                                                                                                                                                                                                                                                                                                                                                                       | <span data-ttu-id="2ec16-108">批註/支援介面的意義</span><span class="sxs-lookup"><span data-stu-id="2ec16-108">Comments/What it Means to Support the Interface</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="2ec16-109">**IOleObject**</span><span class="sxs-lookup"><span data-stu-id="2ec16-109">**IOleObject**</span></span>](/windows/desktop/api/OleIdl/nn-oleidl-ioleobject)<br/>                                                                                                                                                                                                                                                                                                                                     | <span data-ttu-id="2ec16-110">如果控制項需要與用戶端網站進行事件以外的其他任何事件 (請參閱 [**IConnectionPointContainer**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpointcontainer)) ，則 [**IOleObject**](/windows/desktop/api/OleIdl/nn-oleidl-ioleobject) 是必要的。</span><span class="sxs-lookup"><span data-stu-id="2ec16-110">If the control requires communication with its client site for anything other than events (see [**IConnectionPointContainer**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpointcontainer)), then [**IOleObject**](/windows/desktop/api/OleIdl/nn-oleidl-ioleobject) is a necessity.</span></span> <span data-ttu-id="2ec16-111">在實作為這個介面時，控制項也必須支援下列方法的語法： [**SetHostNames**](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-sethostnames)、 [**Close**](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-close)、 [**EnumVerbs**](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-enumverbs)、 [**Update**](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-update)、 [**IsUpToDate**](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-isuptodate)、 [**GetUserClassID**](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-getuserclassid)、 [**GetUserType**](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-getusertype)、 [**GetMiscStatus**](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-getmiscstatus)，以及搭配容器 [**Unadvise**](/windows/desktop/api/ObjIdl/nn-objidl-iadvisesink)執行的 [**建議**](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-advise)、 [**EnumAdvise**](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-unadvise)和 [**IAdviseSink**](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-enumadvise)方法。</span><span class="sxs-lookup"><span data-stu-id="2ec16-111">When implementing this interface, the control must also support the semantics of the following methods: [**SetHostNames**](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-sethostnames), [**Close**](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-close), [**EnumVerbs**](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-enumverbs), [**Update**](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-update), [**IsUpToDate**](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-isuptodate), [**GetUserClassID**](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-getuserclassid), [**GetUserType**](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-getusertype), [**GetMiscStatus**](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-getmiscstatus), and the [**Advise**](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-advise), [**Unadvise**](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-unadvise), and [**EnumAdvise**](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-enumadvise) methods that work in conjunction with a container's [**IAdviseSink**](/windows/desktop/api/ObjIdl/nn-objidl-iadvisesink) implementation.</span></span> <span data-ttu-id="2ec16-112">如果容器提供一個控制項，則執行 **IOleObject** 的控制項必須能夠處理 **IAdviseSink** ;容器可能不會，在此情況下，控制項可確保不會嘗試呼叫不存在的接收。</span><span class="sxs-lookup"><span data-stu-id="2ec16-112">A control implementing **IOleObject** must be able to handle **IAdviseSink** if the container provides one; a container may not, in which case a control ensures, of course, that it does not attempt to call a non-existent sink.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| [<span data-ttu-id="2ec16-113">**IOleInPlaceObject**</span><span class="sxs-lookup"><span data-stu-id="2ec16-113">**IOleInPlaceObject**</span></span>](/windows/desktop/api/OleIdl/nn-oleidl-ioleinplaceobject)<br/>                                                                                                                                                                                                                                                                                                                       | <span data-ttu-id="2ec16-114">表示控制項在就地啟用且可能啟用 UI 的能力。</span><span class="sxs-lookup"><span data-stu-id="2ec16-114">Expresses the control's ability to be in-place activated and possibly UI activated.</span></span> <span data-ttu-id="2ec16-115">這個介面表示控制項有某種類型的使用者介面可以啟用，而且也支援 [**IOleInPlaceActiveObject**](/windows/desktop/api/OleIdl/nn-oleidl-ioleinplaceactiveobject) 。</span><span class="sxs-lookup"><span data-stu-id="2ec16-115">This interface means that the control has a user interface of some kind that can be activated, and [**IOleInPlaceActiveObject**](/windows/desktop/api/OleIdl/nn-oleidl-ioleinplaceactiveobject) is supported as well.</span></span> <span data-ttu-id="2ec16-116">必要的方法為 [**GetWindow**](/windows/desktop/api/OleIdl/nf-oleidl-iolewindow-getwindow)、 [**InPlaceDeactivate**](/windows/desktop/api/OleIdl/nf-oleidl-ioleinplaceobject-inplacedeactivate)、 [**UIDeactivate**](/windows/desktop/api/OleIdl/nf-oleidl-ioleinplaceobject-uideactivate)、 [**SetObjectRects**](/windows/desktop/api/OleIdl/nf-oleidl-ioleinplaceobject-setobjectrects)和 [**ReactivateAndUndo**](/windows/desktop/api/OleIdl/nf-oleidl-ioleinplaceobject-reactivateandundo)。</span><span class="sxs-lookup"><span data-stu-id="2ec16-116">Required methods are [**GetWindow**](/windows/desktop/api/OleIdl/nf-oleidl-iolewindow-getwindow), [**InPlaceDeactivate**](/windows/desktop/api/OleIdl/nf-oleidl-ioleinplaceobject-inplacedeactivate), [**UIDeactivate**](/windows/desktop/api/OleIdl/nf-oleidl-ioleinplaceobject-uideactivate), [**SetObjectRects**](/windows/desktop/api/OleIdl/nf-oleidl-ioleinplaceobject-setobjectrects), and [**ReactivateAndUndo**](/windows/desktop/api/OleIdl/nf-oleidl-ioleinplaceobject-reactivateandundo).</span></span> <span data-ttu-id="2ec16-117">支援此介面需要 [**IOleObject**](/windows/desktop/api/OleIdl/nn-oleidl-ioleobject)。</span><span class="sxs-lookup"><span data-stu-id="2ec16-117">Support for this interface requires support for [**IOleObject**](/windows/desktop/api/OleIdl/nn-oleidl-ioleobject).</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| [<span data-ttu-id="2ec16-118">**IOleInPlaceActiveObject**</span><span class="sxs-lookup"><span data-stu-id="2ec16-118">**IOleInPlaceActiveObject**</span></span>](/windows/desktop/api/OleIdl/nn-oleidl-ioleinplaceactiveobject)<br/>                                                                                                                                                                                                                                                                                                           | <span data-ttu-id="2ec16-119">支援 [**IOleInPlaceObject**](/windows/desktop/api/OleIdl/nn-oleidl-ioleinplaceobject) 的就地支持對象也必須提供這個介面，雖然控制項本身不一定會直接執行介面。</span><span class="sxs-lookup"><span data-stu-id="2ec16-119">An in-place capable object that supports [**IOleInPlaceObject**](/windows/desktop/api/OleIdl/nn-oleidl-ioleinplaceobject) must also provide this interface as well, though the control itself doesn't necessarily implement the interface directly.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| [<span data-ttu-id="2ec16-120">**IOleControl**</span><span class="sxs-lookup"><span data-stu-id="2ec16-120">**IOleControl**</span></span>](/windows/desktop/api/OCIdl/nn-ocidl-iolecontrol)<br/>                                                                                                                                                                                                                                                                                                                                   | <span data-ttu-id="2ec16-121">表示控制項的能力，並想要處理 () 助憶鍵 ([**GetControlInfo**](/windows/desktop/api/OCIdl/nf-ocidl-iolecontrol-getcontrolinfo)、 [**OnMnemonic**](/windows/desktop/api/OCIdl/nf-ocidl-iolecontrol-onmnemonic) 方法) 、 (b) 環境屬性 ([**OnAmbientPropertyChange**](/windows/desktop/api/OCIdl/nf-ocidl-iolecontrol-onambientpropertychange)) 和/或 (c) 事件，控制項要求容器處理 ([**FreezeEvents**](/windows/desktop/api/OCIdl/nf-ocidl-iolecontrol-freezeevents)) 。</span><span class="sxs-lookup"><span data-stu-id="2ec16-121">Expresses the control's ability and desire to deal with (a) mnemonics ([**GetControlInfo**](/windows/desktop/api/OCIdl/nf-ocidl-iolecontrol-getcontrolinfo), [**OnMnemonic**](/windows/desktop/api/OCIdl/nf-ocidl-iolecontrol-onmnemonic) methods), (b) ambient properties ([**OnAmbientPropertyChange**](/windows/desktop/api/OCIdl/nf-ocidl-iolecontrol-onambientpropertychange)), and/or (c) events that the control requires the container to handle ([**FreezeEvents**](/windows/desktop/api/OCIdl/nf-ocidl-iolecontrol-freezeevents)).</span></span> <span data-ttu-id="2ec16-122">請注意，助憶鍵與透過 [**IOleInPlaceActiveObject**](/windows/desktop/api/OleIdl/nn-oleidl-ioleinplaceactiveobject)處理的快速鍵不同：助憶鍵具有相關聯的 ui，即使控制項不是 ui 作用中，也是作用中。</span><span class="sxs-lookup"><span data-stu-id="2ec16-122">Note that mnemonics are different than accelerators that are handled through [**IOleInPlaceActiveObject**](/windows/desktop/api/OleIdl/nn-oleidl-ioleinplaceactiveobject): mnemonics have associated UI and are active even when the control is not UI active.</span></span> <span data-ttu-id="2ec16-123">控制項對助憶鍵的支援表示控制項也知道如何使用容器的 [**>iolecontrolsite：： OnControlInfoChanged**](/windows/desktop/api/OCIdl/nf-ocidl-iolecontrolsite-oncontrolinfochanged) 方法。</span><span class="sxs-lookup"><span data-stu-id="2ec16-123">A control's support for mnemonics means that the control also knows how to use the container's [**IOleControlSite::OnControlInfoChanged**](/windows/desktop/api/OCIdl/nf-ocidl-iolecontrolsite-oncontrolinfochanged) method.</span></span> <span data-ttu-id="2ec16-124">因為這需要控制項知道容器的網站，所以對助憶鍵的支援也表示支援 [**IOleObject**](/windows/desktop/api/OleIdl/nn-oleidl-ioleobject)。</span><span class="sxs-lookup"><span data-stu-id="2ec16-124">Because this requires the control to know the container's site, support for mnemonics also means support for [**IOleObject**](/windows/desktop/api/OleIdl/nn-oleidl-ioleobject).</span></span> <span data-ttu-id="2ec16-125">此外，助憶鍵的知識需要就地支援，因此 [**IOleInPlaceObject**](/windows/desktop/api/OleIdl/nn-oleidl-ioleinplaceobject)。</span><span class="sxs-lookup"><span data-stu-id="2ec16-125">In addition, knowledge of mnemonics requires in-place support and thus [**IOleInPlaceObject**](/windows/desktop/api/OleIdl/nn-oleidl-ioleinplaceobject).</span></span><br/> <span data-ttu-id="2ec16-126">如果控制項使用任何容器環境的屬性，則它也必須執行此介面來接收變更通知，因為必須遵循變更的語法。</span><span class="sxs-lookup"><span data-stu-id="2ec16-126">If a control uses any container-ambient properties, then it must also implement this interface to receive change notifications, as following the semantics of changes is required.</span></span> <span data-ttu-id="2ec16-127">因為環境屬性僅透過容器網站 **IDispatch** 提供，環境屬性支援表示該控制項支援 [**IOleObject**](/windows/desktop/api/OleIdl/nn-oleidl-ioleobject) (以取得網站) ，以及能夠產生 **IDispatch：： Invoke** 呼叫。</span><span class="sxs-lookup"><span data-stu-id="2ec16-127">Because ambient properties are only available through the container site's **IDispatch**, ambient property support means that the control supports [**IOleObject**](/windows/desktop/api/OleIdl/nn-oleidl-ioleobject) (to get the site) as well as being able to generate **IDispatch::Invoke** calls.</span></span><br/> <span data-ttu-id="2ec16-128">[**FreezeEvents**](/windows/desktop/api/OCIdl/nf-ocidl-iolecontrol-freezeevents)方法對於必須知道容器何時不會處理事件的控制項而言是必要的，這是控制這種情況的唯一方法。</span><span class="sxs-lookup"><span data-stu-id="2ec16-128">The [**FreezeEvents**](/windows/desktop/api/OCIdl/nf-ocidl-iolecontrol-freezeevents) method is necessary for controls that must know when a container is not going to handle an event this is the only way for control to know this condition.</span></span> <span data-ttu-id="2ec16-129">如果 **FreezeEvents** 只需要隔離，則不會執行其他 [**IOleControl**](/windows/desktop/api/OCIdl/nn-ocidl-iolecontrol) 方法，則 **IOleControl** 可以獨立，而不需要 [**IOleObject**](/windows/desktop/api/OleIdl/nn-oleidl-ioleobject) 或 [**IOleInPlaceObject**](/windows/desktop/api/OleIdl/nn-oleidl-ioleinplaceobject)。</span><span class="sxs-lookup"><span data-stu-id="2ec16-129">If **FreezeEvents** is only necessary in isolation, such that other [**IOleControl**](/windows/desktop/api/OCIdl/nn-ocidl-iolecontrol) methods are not implemented, then **IOleControl** can stand alone without [**IOleObject**](/windows/desktop/api/OleIdl/nn-oleidl-ioleobject) or [**IOleInPlaceObject**](/windows/desktop/api/OleIdl/nn-oleidl-ioleinplaceobject).</span></span><br/> |
| [<span data-ttu-id="2ec16-130">**IDataObject**</span><span class="sxs-lookup"><span data-stu-id="2ec16-130">**IDataObject**</span></span>](/windows/desktop/api/ObjIdl/nn-objidl-idataobject)<br/>                                                                                                                                                                                                                                                                                                                                   | <span data-ttu-id="2ec16-131">指出控制項可提供至少 (控制項的) 圖形化轉譯 (CF \_ METAFILEPICT 是最小值，如果控制項有任何要提供的屬性，則為控制項在所有) 和/或 (b) 屬性集都有任何視覺效果。</span><span class="sxs-lookup"><span data-stu-id="2ec16-131">Indicates that the control can supply at least (a) graphical renderings of the control (CF\_METAFILEPICT is the minimum if the control has any visuals at all) and/or (b) property sets, if the control has any properties to provide.</span></span> <span data-ttu-id="2ec16-132">需要 [**QueryGetData**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-querygetdata)、 [**EnumFormatEtc**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-enumformatetc)、 [**DAdvise**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-dadvise)、 [**DUnadvise**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-dunadvise)和 [**EnumDAdvise**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-enumdadvise) [**方法。**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-getdata)</span><span class="sxs-lookup"><span data-stu-id="2ec16-132">The methods [**GetData**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-getdata), [**QueryGetData**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-querygetdata), [**EnumFormatEtc**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-enumformatetc), [**DAdvise**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-dadvise), [**DUnadvise**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-dunadvise), and [**EnumDAdvise**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-enumdadvise) are required.</span></span> <span data-ttu-id="2ec16-133">CF METAFILEPICT 以外的圖形格式支援 \_ 是選擇性的。</span><span class="sxs-lookup"><span data-stu-id="2ec16-133">Support for graphical formats other than CF\_METAFILEPICT is optional.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| [<span data-ttu-id="2ec16-134">**IViewObject2**</span><span class="sxs-lookup"><span data-stu-id="2ec16-134">**IViewObject2**</span></span>](/windows/desktop/api/OleIdl/nn-oleidl-iviewobject2)<br/>                                                                                                                                                                                                                                                                                                                                 | <span data-ttu-id="2ec16-135">指出控制項有一些有趣的視覺效果，但未啟用。</span><span class="sxs-lookup"><span data-stu-id="2ec16-135">Indicates that the control has some interesting visuals when it is not in-place active.</span></span> <span data-ttu-id="2ec16-136">如果已執行，則控制項必須支援方法 [**Draw**](/windows/desktop/api/OleIdl/nf-oleidl-iviewobject-draw)、 [**GetAdvise**](/windows/desktop/api/OleIdl/nf-oleidl-iviewobject-getadvise)、 [**SetAdvise**](/windows/desktop/api/OleIdl/nf-oleidl-iviewobject-setadvise)和 [**GetExtent**](/windows/desktop/api/OleIdl/nf-oleidl-iviewobject2-getextent)。</span><span class="sxs-lookup"><span data-stu-id="2ec16-136">If implemented, a control must support the methods [**Draw**](/windows/desktop/api/OleIdl/nf-oleidl-iviewobject-draw), [**GetAdvise**](/windows/desktop/api/OleIdl/nf-oleidl-iviewobject-getadvise), [**SetAdvise**](/windows/desktop/api/OleIdl/nf-oleidl-iviewobject-setadvise), and [**GetExtent**](/windows/desktop/api/OleIdl/nf-oleidl-iviewobject2-getextent).</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| <span data-ttu-id="2ec16-137">**IDispatch**</span><span class="sxs-lookup"><span data-stu-id="2ec16-137">**IDispatch**</span></span><br/>                                                                                                                                                                                                                                                                                                                                                        | <span data-ttu-id="2ec16-138">指出控制項有 () 自訂方法，或 (b) 可透過 **IDispatch：： Invoke** 進行晚期繫結的自訂屬性。</span><span class="sxs-lookup"><span data-stu-id="2ec16-138">Indicates that the control has either (a) custom methods, or (b) custom properties that are both available via late-binding through **IDispatch::Invoke**.</span></span> <span data-ttu-id="2ec16-139">這也需要控制項透過其他 **IDispatch** 方法提供類型資訊。</span><span class="sxs-lookup"><span data-stu-id="2ec16-139">This also requires that the control provides type information through other **IDispatch** methods.</span></span> <span data-ttu-id="2ec16-140">控制項可能會支援多個 **idispatch** 執行，其中只有一個與 IID \_ IDispatch 相關聯，而其他則必須有自己的唯一的分配介面識別碼。</span><span class="sxs-lookup"><span data-stu-id="2ec16-140">A control may support multiple **IDispatch** implementations where only one is associated with IID\_IDispatch the others must have their own unique dispinterface identifiers.</span></span><br/> <span data-ttu-id="2ec16-141">建議您為自訂方法和屬性存取提供雙重介面的控制項，但如果有方法和屬性，則這是選擇性的。</span><span class="sxs-lookup"><span data-stu-id="2ec16-141">A control is encouraged to supply dual interfaces for custom method and property access, but this is optional if methods and properties exist.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| [<span data-ttu-id="2ec16-142">**IConnectionPointContainer**</span><span class="sxs-lookup"><span data-stu-id="2ec16-142">**IConnectionPointContainer**</span></span>](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpointcontainer)<br/>                                                                                                                                                                                                                                                                                                       | <span data-ttu-id="2ec16-143">指出控制項至少支援一個輸出介面，例如事件或屬性變更通知。</span><span class="sxs-lookup"><span data-stu-id="2ec16-143">Indicates that a control supports at least one outgoing interface, such as events or property change notifications.</span></span> <span data-ttu-id="2ec16-144">如果有此介面可供使用，則必須實作為此介面的所有方法，包括需要具有 [**IEnumConnectionPoints**](/windows/desktop/api/ocidl/nn-ocidl-ienumconnectionpoints)之個別物件的 [**EnumConnectionPoints**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpointcontainer-enumconnectionpoints) 。</span><span class="sxs-lookup"><span data-stu-id="2ec16-144">All methods of this interface must be implemented if this interface is available at all, including [**EnumConnectionPoints**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpointcontainer-enumconnectionpoints) which requires a separate object with [**IEnumConnectionPoints**](/windows/desktop/api/ocidl/nn-ocidl-ienumconnectionpoints).</span></span><br/> <span data-ttu-id="2ec16-145">[**IConnectionPointContainer**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpointcontainer)的支援表示物件也支援一或多個具有 [**IConnectionPoint**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpoint)的相關物件，這些物件可透過 **IConnectionPointContainer** 方法取得。</span><span class="sxs-lookup"><span data-stu-id="2ec16-145">Support for [**IConnectionPointContainer**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpointcontainer) means that the object also supports one or more related objects with [**IConnectionPoint**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpoint) that are available through **IConnectionPointContainer** methods.</span></span> <span data-ttu-id="2ec16-146">每個連接點物件本身都必須執行完整 **IConnectionPoint** 介面（包括 [**EnumConnections**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpoint-enumconnections)），而此介面需要具有 [**IEnumConnections**](/windows/desktop/api/ocidl/nn-ocidl-ienumconnections) 介面的另一個列舉值物件。</span><span class="sxs-lookup"><span data-stu-id="2ec16-146">Each connection point object itself must implement the full **IConnectionPoint** interface, including [**EnumConnections**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpoint-enumconnections), which requires another enumerator object with the [**IEnumConnections**](/windows/desktop/api/ocidl/nn-ocidl-ienumconnections) interface.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| [<span data-ttu-id="2ec16-147">**IProvideClassInfo**</span><span class="sxs-lookup"><span data-stu-id="2ec16-147">**IProvideClassInfo**</span></span>](/windows/desktop/api/OCIdl/nn-ocidl-iprovideclassinfo)<br/> [<span data-ttu-id="2ec16-148">**Iprovideclassinfo2.getguid**</span><span class="sxs-lookup"><span data-stu-id="2ec16-148">**IProvideClassInfo2**</span></span>](/windows/desktop/api/OCIdl/nn-ocidl-iprovideclassinfo2)<br/>                                                                                                                                                                                                                                                           | <span data-ttu-id="2ec16-149">指出物件可以直接透過 [**IProvideClassInfo：： GetClassInfo**](/windows/desktop/api/OCIdl/nf-ocidl-iprovideclassinfo-getclassinfo)提供自己的 coclass 型別資訊。</span><span class="sxs-lookup"><span data-stu-id="2ec16-149">Indicates that the object can provide its own coclass type information directly through [**IProvideClassInfo::GetClassInfo**](/windows/desktop/api/OCIdl/nf-ocidl-iprovideclassinfo-getclassinfo).</span></span> <span data-ttu-id="2ec16-150">如果控制項支援較新的變化 [**iprovideclassinfo2.getguid**](/windows/desktop/api/OCIdl/nn-ocidl-iprovideclassinfo2)，它也會指出其透過 [**Iprovideclassinfo2.getguid：： GetGUID**](/windows/desktop/api/OCIdl/nf-ocidl-iprovideclassinfo2-getguid)提供其主要來源 IID 的能力。</span><span class="sxs-lookup"><span data-stu-id="2ec16-150">If the control supports the later variation [**IProvideClassInfo2**](/windows/desktop/api/OCIdl/nn-ocidl-iprovideclassinfo2), then it also indicates its ability to provide its primary source IID through [**IProvideClassInfo2::GetGUID**](/windows/desktop/api/OCIdl/nf-ocidl-iprovideclassinfo2-getguid).</span></span> <span data-ttu-id="2ec16-151">此介面的所有方法都必須實作為。</span><span class="sxs-lookup"><span data-stu-id="2ec16-151">All methods of this interface must be implemented.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| [<span data-ttu-id="2ec16-152">**ISpecifyPropertyPages**</span><span class="sxs-lookup"><span data-stu-id="2ec16-152">**ISpecifyPropertyPages**</span></span>](/windows/desktop/api/OCIdl/nn-ocidl-ispecifypropertypages)<br/>                                                                                                                                                                                                                                                                                                               | <span data-ttu-id="2ec16-153">指出控制項具有可顯示的屬性頁，讓容器可以在屬性頁針對多重控制項選取專案顯示時，將這個控制項的屬性頁與其他控制項的頁面協調。</span><span class="sxs-lookup"><span data-stu-id="2ec16-153">Indicates that the control has property pages that it can display such that a container can coordinate this control's property pages with other control's pages when property pages are to be shown for a multi-control selection.</span></span> <span data-ttu-id="2ec16-154">當支援存在時，必須執行此介面的所有方法。</span><span class="sxs-lookup"><span data-stu-id="2ec16-154">All methods of this interface must be implemented when support exists.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| [<span data-ttu-id="2ec16-155">**IPerPropertyBrowsing**</span><span class="sxs-lookup"><span data-stu-id="2ec16-155">**IPerPropertyBrowsing**</span></span>](/windows/desktop/api/OCIdl/nn-ocidl-iperpropertybrowsing)<br/>                                                                                                                                                                                                                                                                                                                 | <span data-ttu-id="2ec16-156">指出控制項可 () 提供屬性的顯示字串， (b) 為其屬性提供預先定義的字串和值，以及/或 (c) 將屬性 dispID 對應至特定的屬性頁。</span><span class="sxs-lookup"><span data-stu-id="2ec16-156">Indicates the control's ability to (a) provide a display string for a property, (b) provide predefined strings and values for its properties and/or (c) map a property dispID to a specific property page.</span></span> <span data-ttu-id="2ec16-157">此介面的支援表示提供了透過 IDispatch 的屬性支援（如上所示）。</span><span class="sxs-lookup"><span data-stu-id="2ec16-157">Support for this interface means that support for properties through IDispatch as above is provided.</span></span> <span data-ttu-id="2ec16-158">如果支援 (c) ，也表示透過 [**IPerPropertyBrowsing：： MapPropertyToPage**](/windows/desktop/api/OCIdl/nf-ocidl-iperpropertybrowsing-mappropertytopage) 對應的物件屬性頁面本身會執行 [**IPropertyPage2**](/windows/desktop/api/OCIdl/nn-ocidl-ipropertypage2) ，而不是基本 [**IPropertyPage**](/windows/desktop/api/OCIdl/nn-ocidl-ipropertypage) 介面。</span><span class="sxs-lookup"><span data-stu-id="2ec16-158">If (c) is supported, then it also means that the object's property pages mapped through [**IPerPropertyBrowsing::MapPropertyToPage**](/windows/desktop/api/OCIdl/nf-ocidl-iperpropertybrowsing-mappropertytopage) themselves implement [**IPropertyPage2**](/windows/desktop/api/OCIdl/nn-ocidl-ipropertypage2) as opposed to the basic [**IPropertyPage**](/windows/desktop/api/OCIdl/nn-ocidl-ipropertypage) interface.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| [<span data-ttu-id="2ec16-159">**IPersistStream**</span><span class="sxs-lookup"><span data-stu-id="2ec16-159">**IPersistStream**</span></span>](/windows/desktop/api/ObjIdl/nn-objidl-ipersiststream)<br/> [<span data-ttu-id="2ec16-160">**IPersistStreamInit**</span><span class="sxs-lookup"><span data-stu-id="2ec16-160">**IPersistStreamInit**</span></span>](/windows/desktop/api/OCIdl/nn-ocidl-ipersiststreaminit)<br/> <span data-ttu-id="2ec16-161">[**IPersistMemory**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa768210(v=vs.85))</span><span class="sxs-lookup"><span data-stu-id="2ec16-161">[**IPersistMemory**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa768210(v=vs.85))</span></span><br/> [<span data-ttu-id="2ec16-162">**IPersistStorage**</span><span class="sxs-lookup"><span data-stu-id="2ec16-162">**IPersistStorage**</span></span>](/windows/desktop/api/ObjIdl/nn-objidl-ipersiststorage)<br/> <span data-ttu-id="2ec16-163">[**IPersistMoniker**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/ms775042(v=vs.85))</span><span class="sxs-lookup"><span data-stu-id="2ec16-163">[**IPersistMoniker**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/ms775042(v=vs.85))</span></span><br/> <span data-ttu-id="2ec16-164">[**IPersistPropertyBag**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa768205(v=vs.85))</span><span class="sxs-lookup"><span data-stu-id="2ec16-164">[**IPersistPropertyBag**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa768205(v=vs.85))</span></span><br/> | <span data-ttu-id="2ec16-165">請參閱 [持續性介面](persistence-interfaces.md)。</span><span class="sxs-lookup"><span data-stu-id="2ec16-165">See [Persistence Interfaces](persistence-interfaces.md).</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| [<span data-ttu-id="2ec16-166">**IOleCache**</span><span class="sxs-lookup"><span data-stu-id="2ec16-166">**IOleCache**</span></span>](/windows/desktop/api/OleIdl/nn-oleidl-iolecache)<br/> [<span data-ttu-id="2ec16-167">**IOleCache2**</span><span class="sxs-lookup"><span data-stu-id="2ec16-167">**IOleCache2**</span></span>](/windows/desktop/api/OleIdl/nn-oleidl-iolecache2)<br/>                                                                                                                                                                                                                                                                                           | <span data-ttu-id="2ec16-168">指出支援控制項視覺效果的容器快取。</span><span class="sxs-lookup"><span data-stu-id="2ec16-168">Indicates support for container caching of control visuals.</span></span> <span data-ttu-id="2ec16-169">控制項通常會透過 OLE 函數 [**CreateDataCache**](/windows/desktop/api/ObjBase/nf-objbase-createdatacache)取得快取支援。</span><span class="sxs-lookup"><span data-stu-id="2ec16-169">A control generally obtains caching support itself through the OLE function [**CreateDataCache**](/windows/desktop/api/ObjBase/nf-objbase-createdatacache).</span></span> <span data-ttu-id="2ec16-170">只有具有有意義之靜態內容的控制項，才能選擇進行這項 (，但) 不需要這麼做。</span><span class="sxs-lookup"><span data-stu-id="2ec16-170">Only controls with meaningful static content should choose to do this (although it is not required).</span></span> <span data-ttu-id="2ec16-171">如果控制項完全支援快取，則應該只匯總資料快取，並從資料快取中公開 [**IOleCache**](/windows/desktop/api/OleIdl/nn-oleidl-iolecache) 和 [**IOleCache2**](/windows/desktop/api/OleIdl/nn-oleidl-iolecache2) 介面。</span><span class="sxs-lookup"><span data-stu-id="2ec16-171">If a control supports caching at all, it should simply aggregate the data cache and expose both [**IOleCache**](/windows/desktop/api/OleIdl/nn-oleidl-iolecache) and [**IOleCache2**](/windows/desktop/api/OleIdl/nn-oleidl-iolecache2) interfaces from the data cache.</span></span> <span data-ttu-id="2ec16-172">如果容器提供一個控制項，則執行 [**IOleObject**](/windows/desktop/api/OleIdl/nn-oleidl-ioleobject) 的控制項必須能夠處理 [**IAdviseSink**](/windows/desktop/api/ObjIdl/nn-objidl-iadvisesink) ;容器可能不會，在此情況下，控制項可確保不會嘗試呼叫不存在的接收。</span><span class="sxs-lookup"><span data-stu-id="2ec16-172">A control implementing [**IOleObject**](/windows/desktop/api/OleIdl/nn-oleidl-ioleobject) must be able to handle [**IAdviseSink**](/windows/desktop/api/ObjIdl/nn-objidl-iadvisesink) if the container provides one; a container may not, in which case a control ensures, of course, that it does not attempt to call a non-existent sink.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| [<span data-ttu-id="2ec16-173">**IExternalConnection**</span><span class="sxs-lookup"><span data-stu-id="2ec16-173">**IExternalConnection**</span></span>](/windows/win32/api/objidlbase/nn-objidlbase-iexternalconnection)<br/>                                                                                                                                                                                                                                                                                                                   | <span data-ttu-id="2ec16-174">指出控制項支援其本身的外部連結;也就是說，控制項不會以 OLEMISC \_ CANTLINKINSIDE 標示，並支援 [**IOleObject：： SetMoniker**](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-setmoniker) 和 [**IOleObject：： GetMoniker**](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-getmoniker)。</span><span class="sxs-lookup"><span data-stu-id="2ec16-174">Indicates that the control supports external links to itself; that is, the control is not marked with OLEMISC\_CANTLINKINSIDE and supports [**IOleObject::SetMoniker**](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-setmoniker) and [**IOleObject::GetMoniker**](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-getmoniker).</span></span> <span data-ttu-id="2ec16-175">容器絕不會查詢這個介面本身，也不會直接呼叫它，因為呼叫是從 OLE 的遠端層內部產生的。</span><span class="sxs-lookup"><span data-stu-id="2ec16-175">A container will never query for this interface itself nor call it directly as calls are generated from inside OLE's remoting layer.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| [<span data-ttu-id="2ec16-176">**IRunnableObject**</span><span class="sxs-lookup"><span data-stu-id="2ec16-176">**IRunnableObject**</span></span>](/windows/desktop/api/ObjIdl/nn-objidl-irunnableobject)<br/>                                                                                                                                                                                                                                                                                                                           | <span data-ttu-id="2ec16-177">指出控制項因為某些同進程物件的執行，而區別于正在執行的狀態。</span><span class="sxs-lookup"><span data-stu-id="2ec16-177">Indicates that the control differentiates being loaded from being running, as some in-process objects do.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |



 

## <a name="related-topics"></a><span data-ttu-id="2ec16-178">相關主題</span><span class="sxs-lookup"><span data-stu-id="2ec16-178">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="2ec16-179">控制項</span><span class="sxs-lookup"><span data-stu-id="2ec16-179">Controls</span></span>](controls.md)
</dt> </dl>

 

