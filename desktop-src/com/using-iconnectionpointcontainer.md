---
title: 使用 IConnectionPointContainer
description: 使用 IConnectionPointContainer
ms.assetid: a87afb25-4d45-4ce2-9b27-840da5107bce
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: d4d0b7c691e1ba6a8445af56978b43a2ccbf33e7
ms.sourcegitcommit: 85688bbfbe5b121bc05ddf112d54c23a469dfbc0
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/29/2020
ms.locfileid: "106994958"
---
# <a name="using-iconnectionpointcontainer"></a><span data-ttu-id="9cb37-103">使用 IConnectionPointContainer</span><span class="sxs-lookup"><span data-stu-id="9cb37-103">Using IConnectionPointContainer</span></span>

<span data-ttu-id="9cb37-104">可連線物件會執行 [**IConnectionPointContainer**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpointcontainer) (並透過 [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)) 公開它) 來指出輸出介面是否存在。</span><span class="sxs-lookup"><span data-stu-id="9cb37-104">A connectable object implements [**IConnectionPointContainer**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpointcontainer) (and exposes it through [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q))) to indicate the existence of outgoing interfaces.</span></span> <span data-ttu-id="9cb37-105">針對每個輸出介面，可連線物件會管理連接點子物件，其本身會執行 [**IConnectionPoint**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpoint)。</span><span class="sxs-lookup"><span data-stu-id="9cb37-105">For each outgoing interface, the connectable object manages a connection point sub-object, which itself implements [**IConnectionPoint**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpoint).</span></span> <span data-ttu-id="9cb37-106">因此，可連接的物件會包含連接點，因此會命名為 **IConnectionPointContainer** 和 **IConnectionPoint**。</span><span class="sxs-lookup"><span data-stu-id="9cb37-106">The connectable object therefore contains the connection points, hence the naming of **IConnectionPointContainer** and **IConnectionPoint**.</span></span>

<span data-ttu-id="9cb37-107">透過 [**IConnectionPointContainer**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpointcontainer)，用戶端可以執行兩個作業。</span><span class="sxs-lookup"><span data-stu-id="9cb37-107">Through [**IConnectionPointContainer**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpointcontainer), a client can perform two operations.</span></span> <span data-ttu-id="9cb37-108">首先，如果用戶端已經有它所支援之輸出介面的 IID，則可以使用 [**IConnectionPointContainer：： FindConnectionPoint**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpointcontainer-findconnectionpoint)找出 iid 的對應連接點。</span><span class="sxs-lookup"><span data-stu-id="9cb37-108">First, if the client already has the IID for an outgoing interface that it supports, it can locate the corresponding connection point for the IID using [**IConnectionPointContainer::FindConnectionPoint**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpointcontainer-findconnectionpoint).</span></span> <span data-ttu-id="9cb37-109">用戶端無法直接查詢連接點，因為可連線物件與其包含的連接點之間的容器/自主關聯性。</span><span class="sxs-lookup"><span data-stu-id="9cb37-109">The client cannot query for the connection point directly because of the container/contained relationship between the connectable object and its contained connection points.</span></span> <span data-ttu-id="9cb37-110">基本上，當用戶端知道 IID 時， **FindConnectionPoint** 就是輸出介面的 [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)) 。</span><span class="sxs-lookup"><span data-stu-id="9cb37-110">Basically, **FindConnectionPoint** is the [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)) for outgoing interfaces when the IID is known to the client.</span></span>

<span data-ttu-id="9cb37-111">其次，用戶端可以透過 [**IConnectionPointContainer：： EnumConnectionPoints**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpointcontainer-enumconnectionpoints)來列舉可連線物件內的所有連接點。</span><span class="sxs-lookup"><span data-stu-id="9cb37-111">Second, the client can enumerate all connection points within the connectable object through [**IConnectionPointContainer::EnumConnectionPoints**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpointcontainer-enumconnectionpoints).</span></span> <span data-ttu-id="9cb37-112">這個方法會傳回個別列舉值物件的 [**IEnumConnectionPoints**](/windows/desktop/api/ocidl/nn-ocidl-ienumconnectionpoints) 介面指標。</span><span class="sxs-lookup"><span data-stu-id="9cb37-112">This method returns an [**IEnumConnectionPoints**](/windows/desktop/api/ocidl/nn-ocidl-ienumconnectionpoints) interface pointer for a separate enumerator object.</span></span> <span data-ttu-id="9cb37-113">透過 [**IEnumConnectionPoints：： Next**](/windows/desktop/api/ocidl/nf-ocidl-ienumconnectionpoints-next)，用戶端可以取得每個連接點的 [**IConnectionPoint**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpoint) 介面指標。</span><span class="sxs-lookup"><span data-stu-id="9cb37-113">Through [**IEnumConnectionPoints::Next**](/windows/desktop/api/ocidl/nf-ocidl-ienumconnectionpoints-next), the client can obtain [**IConnectionPoint**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpoint) interface pointers to each connection point.</span></span>

<span data-ttu-id="9cb37-114">用戶端取得 [**IConnectionPoint**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpoint) 介面之後，必須呼叫 [**IConnectionPoint：： GetConnectionInterface**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpoint-getconnectioninterface) 來判斷每個連接點所支援之輸出介面的 IID。</span><span class="sxs-lookup"><span data-stu-id="9cb37-114">After the client obtains the [**IConnectionPoint**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpoint) interface, it must call [**IConnectionPoint::GetConnectionInterface**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpoint-getconnectioninterface) to determine the IID of the outgoing interface supported by each connection point.</span></span> <span data-ttu-id="9cb37-115">如果用戶端已支援該連出介面，則可以建立連線。</span><span class="sxs-lookup"><span data-stu-id="9cb37-115">If the client already supports that outgoing interface, it can establish a connection.</span></span> <span data-ttu-id="9cb37-116">否則，它仍可支援傳出介面，方法是使用可連線物件類型程式庫中的資訊，在執行時間提供支援。</span><span class="sxs-lookup"><span data-stu-id="9cb37-116">Otherwise, it may still be able to support the outgoing interface by using information from the connectable object's type library to provide support at run time.</span></span> <span data-ttu-id="9cb37-117">這項技術需要可連線物件支援 [**IProvideClassInfo**](/windows/desktop/api/OCIdl/nn-ocidl-iprovideclassinfo) 介面。</span><span class="sxs-lookup"><span data-stu-id="9cb37-117">This technique requires that the connectable object support the [**IProvideClassInfo**](/windows/desktop/api/OCIdl/nn-ocidl-iprovideclassinfo) interface.</span></span> <span data-ttu-id="9cb37-118"> (參閱 [使用 IProvideClassInfo](using-iprovideclassinfo.md)。 ) </span><span class="sxs-lookup"><span data-stu-id="9cb37-118">(See [Using IProvideClassInfo](using-iprovideclassinfo.md).)</span></span>

<span data-ttu-id="9cb37-119">因為列舉值是個別的物件，所以當不再需要列舉值時，用戶端必須呼叫 **IEnumConnectionPoints：： Release** 。</span><span class="sxs-lookup"><span data-stu-id="9cb37-119">Because the enumerator is a separate object, the client must call **IEnumConnectionPoints::Release** when the enumerator is no longer needed.</span></span> <span data-ttu-id="9cb37-120">此外，每個連接點都是一個物件，其中包含來自包含可連線物件的不同參考計數。</span><span class="sxs-lookup"><span data-stu-id="9cb37-120">In addition, each connection point is an object with a separate reference count from the containing connectable object.</span></span> <span data-ttu-id="9cb37-121">因此，用戶端也必須針對透過列舉值或透過 [**FindConnectionPoint**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpointcontainer-findconnectionpoint)存取的每個連接點呼叫 IConnectionPoint：： Release。</span><span class="sxs-lookup"><span data-stu-id="9cb37-121">Therefore, the client must also call IConnectionPoint::Release for each connection point accessed either through the enumerator or through [**FindConnectionPoint**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpointcontainer-findconnectionpoint).</span></span>

## <a name="related-topics"></a><span data-ttu-id="9cb37-122">相關主題</span><span class="sxs-lookup"><span data-stu-id="9cb37-122">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="9cb37-123">可連線物件介面</span><span class="sxs-lookup"><span data-stu-id="9cb37-123">Connectable Object Interfaces</span></span>](connectable-object-interfaces.md)
</dt> </dl>

 

 




