---
title: 資料傳輸介面
description: 資料傳輸介面
ms.assetid: c42e65a4-7b77-4f39-8323-04fa60c5b140
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 448e1a580880c7202ec67d12965f6db7e0be99d0
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/21/2020
ms.locfileid: "106967499"
---
# <a name="data-transfer-interfaces"></a><span data-ttu-id="4275a-103">資料傳輸介面</span><span class="sxs-lookup"><span data-stu-id="4275a-103">Data Transfer Interfaces</span></span>

<span data-ttu-id="4275a-104">[**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject)介面為數據取用者提供了取得及設定物件資料的方法、判斷物件所支援的格式，以及在物件中的資料變更時，註冊和接收通知。</span><span class="sxs-lookup"><span data-stu-id="4275a-104">The [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) interface provides consumers of data with methods for getting and setting an object's data, determining which formats the object supports, and registering for and receiving notifications when data in the object changes.</span></span> <span data-ttu-id="4275a-105">取得資料時，呼叫端可以指定要用來呈現資料的格式。</span><span class="sxs-lookup"><span data-stu-id="4275a-105">When obtaining data, a caller can specify the format in which it wants to render the data.</span></span> <span data-ttu-id="4275a-106">但是，資料的來源會判斷儲存媒體，它會在呼叫端所提供的 out 參數中傳回。</span><span class="sxs-lookup"><span data-stu-id="4275a-106">The source of the data, however, determines the storage medium, which it returns in an out parameter provided by the caller.</span></span>

<span data-ttu-id="4275a-107">[**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject)本身會提供在您的應用程式中執行 Windows 剪貼簿傳輸或複合檔案傳輸所需的所有工具。</span><span class="sxs-lookup"><span data-stu-id="4275a-107">By itself, [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) supplies all the tools you need to implement Windows clipboard transfers or compound document transfers in your applications.</span></span> <span data-ttu-id="4275a-108">如果您也想要支援拖放傳輸，您需要執行 [**IDropSource**](/windows/desktop/api/OleIdl/nn-oleidl-idropsource) 和 [**IDropTarget**](/windows/desktop/api/OleIdl/nn-oleidl-idroptarget) 介面以及 **IDataObject**。</span><span class="sxs-lookup"><span data-stu-id="4275a-108">If you also want to support drag and drop transfers, you need to implement the [**IDropSource**](/windows/desktop/api/OleIdl/nn-oleidl-idropsource) and [**IDropTarget**](/windows/desktop/api/OleIdl/nn-oleidl-idroptarget) interfaces along with **IDataObject**.</span></span>

<span data-ttu-id="4275a-109">[**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject)介面與 OLE 剪貼簿 api 結合，可提供 Windows 剪貼簿 api 的所有功能。</span><span class="sxs-lookup"><span data-stu-id="4275a-109">The [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) interface combined with OLE clipboard APIs provide all the capabilities of the Windows clipboard APIs.</span></span> <span data-ttu-id="4275a-110">通常不需要同時使用剪貼簿 Api。</span><span class="sxs-lookup"><span data-stu-id="4275a-110">It is not generally necessary to use both clipboard APIs.</span></span> <span data-ttu-id="4275a-111">支援拖放傳送或 OLE 複合檔案的資料供應商必須執行 **IDataObject** 介面。</span><span class="sxs-lookup"><span data-stu-id="4275a-111">Data suppliers that support either drag and drop transfers or OLE compound documents must implement the **IDataObject** interface.</span></span> <span data-ttu-id="4275a-112">如果您的應用程式現在僅支援剪貼簿傳送，但您想要在稍後的版本中新增拖放或複合檔案，您可能會想要立即執行 **IDataObject** 和 OLE 剪貼簿 api，以將稍後進行編碼和偵測所花費的時間降到最低。</span><span class="sxs-lookup"><span data-stu-id="4275a-112">If your application supports only clipboard transfers now, but you intend to add drag and drop or compound documents in later releases, you may want to implement **IDataObject** and the OLE clipboard APIs now in order to minimize the amount of time spent recoding and debugging later.</span></span> <span data-ttu-id="4275a-113">您也可能想要執行 **IDataObject** ，以便利用全域記憶體以外的傳輸媒體。</span><span class="sxs-lookup"><span data-stu-id="4275a-113">You may also want to implement **IDataObject** in order to utilize transfer media other than global memory.</span></span>

<span data-ttu-id="4275a-114">下表摘要說明要使用的資料，視您要支援的資料傳輸類型而定：</span><span class="sxs-lookup"><span data-stu-id="4275a-114">The following table summarizes which ones to use, depending on what types of data transfer you want to support:</span></span>



| <span data-ttu-id="4275a-115">若要支援</span><span class="sxs-lookup"><span data-stu-id="4275a-115">To support</span></span>                                                                       | <span data-ttu-id="4275a-116">使用</span><span class="sxs-lookup"><span data-stu-id="4275a-116">Use</span></span>                                                                                                                                                                         |
|----------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="4275a-117">複合檔案</span><span class="sxs-lookup"><span data-stu-id="4275a-117">Compound documents</span></span><br/>                                                    | [<span data-ttu-id="4275a-118">**IDataObject**</span><span class="sxs-lookup"><span data-stu-id="4275a-118">**IDataObject**</span></span>](/windows/desktop/api/ObjIdl/nn-objidl-idataobject)<br/>                                                                                                                               |
| <span data-ttu-id="4275a-119">拖放傳送</span><span class="sxs-lookup"><span data-stu-id="4275a-119">Drag and drop transfers</span></span><br/>                                               | <span data-ttu-id="4275a-120">[**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject)、 [**IDropSource**](/windows/desktop/api/OleIdl/nn-oleidl-idropsource)、 [**IDropTarget**](/windows/desktop/api/OleIdl/nn-oleidl-idroptarget)、 [**DoDragDrop**](/windows/desktop/api/Ole2/nf-ole2-dodragdrop) (或相等的) </span><span class="sxs-lookup"><span data-stu-id="4275a-120">[**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject), [**IDropSource**](/windows/desktop/api/OleIdl/nn-oleidl-idropsource), [**IDropTarget**](/windows/desktop/api/OleIdl/nn-oleidl-idroptarget), [**DoDragDrop**](/windows/desktop/api/Ole2/nf-ole2-dodragdrop) (or the equivalent)</span></span><br/> |
| <span data-ttu-id="4275a-121">以獨佔方式使用全域記憶體傳送剪貼簿</span><span class="sxs-lookup"><span data-stu-id="4275a-121">Clipboard transfers using global memory exclusively</span></span><br/>                   | [<span data-ttu-id="4275a-122">剪貼簿 API</span><span class="sxs-lookup"><span data-stu-id="4275a-122">Clipboard API</span></span>](../dataxchg/clipboard.md)<br/>                                                                                                                            |
| <span data-ttu-id="4275a-123">使用全域記憶體以外的 exchange 媒體傳送剪貼簿。</span><span class="sxs-lookup"><span data-stu-id="4275a-123">Clipboard transfers using exchange mediums other than global memory.</span></span><br/>  | [<span data-ttu-id="4275a-124">**IDataObject**</span><span class="sxs-lookup"><span data-stu-id="4275a-124">**IDataObject**</span></span>](/windows/desktop/api/ObjIdl/nn-objidl-idataobject)<br/>                                                                                                                               |
| <span data-ttu-id="4275a-125">剪貼簿立即傳送，但稍後再拖放或複合檔案</span><span class="sxs-lookup"><span data-stu-id="4275a-125">Clipboard transfers now but drag and drop or compound documents later</span></span><br/> | <span data-ttu-id="4275a-126">[**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) 和上面列出的「拖放傳輸」的介面和功能</span><span class="sxs-lookup"><span data-stu-id="4275a-126">[**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) and the interfaces and function listed above for "Drag and drop transfers"</span></span><br/>                                                    |



 

<span data-ttu-id="4275a-127">當使用者啟動資料傳輸作業時，來源應用程式會建立 [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) 的實例，並透過它來提供一或多個格式的資料。</span><span class="sxs-lookup"><span data-stu-id="4275a-127">When a user initiates a data transfer operation, the source application creates an instance of [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) and through it makes the data available in one or more formats.</span></span> <span data-ttu-id="4275a-128">在「剪貼簿」傳送中，應用程式會呼叫 [**OleSetClipboard**](/windows/desktop/api/Ole2/nf-ole2-olesetclipboard) 函式，將資料物件指標傳遞給 OLE。</span><span class="sxs-lookup"><span data-stu-id="4275a-128">In a clipboard transfer, the application calls the [**OleSetClipboard**](/windows/desktop/api/Ole2/nf-ole2-olesetclipboard) function to pass a data-object pointer to OLE.</span></span> <span data-ttu-id="4275a-129"> (**OleSetClipboard** 也提供 OLE 版本1和非 OLE 應用程式的標準剪貼簿資料格式。在拖放傳輸中 ) ，應用程式會改為呼叫 [**DoDragDrop**](/windows/desktop/api/Ole2/nf-ole2-dodragdrop) 函式。</span><span class="sxs-lookup"><span data-stu-id="4275a-129">(**OleSetClipboard** also offers standard clipboard data formats for both OLE version 1 and non-OLE applications.) In a drag and drop transfer, the application calls the [**DoDragDrop**](/windows/desktop/api/Ole2/nf-ole2-dodragdrop) function instead.</span></span>

<span data-ttu-id="4275a-130">在傳送的接收端，目的地會接收 [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) 指標做為 IDropTarget 的調用的引數 [**：:D Rop**](/windows/desktop/api/OleIdl/nf-oleidl-idroptarget-drop) 或呼叫 [**OleSetClipboard**](/windows/desktop/api/Ole2/nf-ole2-olesetclipboard) 函式，取決於是否透過拖放或剪貼簿來傳送。</span><span class="sxs-lookup"><span data-stu-id="4275a-130">On the receiving side of the transfer, the destination receives the [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) pointer either as an argument to an invocation of [**IDropTarget::Drop**](/windows/desktop/api/OleIdl/nf-oleidl-idroptarget-drop) or by calling the [**OleSetClipboard**](/windows/desktop/api/Ole2/nf-ole2-olesetclipboard) function, depending on whether the transfer is by means of drag and drop or the clipboard.</span></span> <span data-ttu-id="4275a-131">取得此指標之後，目的地會呼叫 [**IDataObject：： EnumFormatEtc**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-enumformatetc) 來瞭解哪些格式可供抓取，以及可以取得哪些類型的媒體。</span><span class="sxs-lookup"><span data-stu-id="4275a-131">Having obtained this pointer, the destination calls [**IDataObject::EnumFormatEtc**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-enumformatetc) to learn what formats are available for retrieval and on what types of media they can be obtained.</span></span> <span data-ttu-id="4275a-132">透過此資訊，接收應用程式會透過呼叫 [**IDataObject：：**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-getdata)來要求資料。</span><span class="sxs-lookup"><span data-stu-id="4275a-132">Armed with this information, the receiving application requests the data with a call to [**IDataObject::GetData**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-getdata).</span></span>

## <a name="related-topics"></a><span data-ttu-id="4275a-133">相關主題</span><span class="sxs-lookup"><span data-stu-id="4275a-133">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="4275a-134">資料轉送</span><span class="sxs-lookup"><span data-stu-id="4275a-134">Data Transfer</span></span>](data-transfer.md)
</dt> </dl>

 

