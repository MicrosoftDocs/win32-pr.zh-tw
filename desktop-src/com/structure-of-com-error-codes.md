---
title: COM 錯誤碼的結構
description: COM 錯誤碼的結構
ms.assetid: 97e68708-eb62-4481-af03-cf8b80304103
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 65953582952ce076028ffcf6652e46356c4cf2afacdd088d546c2fdaafd18a33
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/11/2021
ms.locfileid: "118104018"
---
# <a name="structure-of-com-error-codes"></a>COM 錯誤碼的結構

下圖顯示 [**HRESULT**](/openspecs/windows_protocols/ms-erref/0642cb2f-2075-4469-918c-4441e69c548a) (或 SCODE) 的格式;數位表示位位置：

![顯示 ' H RESULT ' 或 ' CODE ' 的格式，並以數位表示位位置。](images/a5a947d1-7b5a-4474-afed-2a1c58fe2421.png)

**HRESULT** 或 SCODE 中的高序位位會指出傳回值是否代表成功或失敗。 如果設定為0， \_ 則嚴重性成功，值表示成功。 如果設定為1， \_ 則嚴重性錯誤，表示失敗。

R、C、N 和 r 位是保留的。

[設備] 欄位指出負責錯誤的系統服務。 Microsoft 會在必要時配置新的設施代碼。 大部分的 SCODEs 和 **HRESULT** 值會將設備欄位設定為設備 \_ ITF，表示介面方法錯誤。

下表說明常見的設備欄位。



| 設備欄位                | 值        | 描述                                                                                                                                                                                                                                                                                                              |
|-------------------------------|--------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 設備 \_ 分派<br/> | 2<br/> | 針對晚期繫結的 **IDispatch** 介面錯誤。 <br/>                                                                                                                                                                                                                                                             |
| 設施 \_ ITF<br/>      | 4<br/> | 針對從介面方法傳回的大部分狀態碼。 此錯誤的實際意義是由介面所定義。 也就是說，兩個 **HRESULT**（具有完全相同的32位值，從兩個不同的介面傳回）可能會有不同的意義。 <br/>                                                       |
| 設備 \_ Null<br/>     | 0<br/> | 適用于廣泛適用的常見狀態碼，例如 \_ [確定]。 <br/>                                                                                                                                                                                                                                                    |
| 設備 \_ RPC<br/>      | 1<br/> | 適用于遠端程序呼叫所傳回的狀態碼。 <br/>                                                                                                                                                                                                                                                       |
| 設備 \_ 存放區<br/>  | 3<br/> | 針對與結構化儲存相關的 [**IStorage**](/windows/desktop/api/objidl/nn-objidl-istorage) 或 [**IStream**](/windows/desktop/api/objidl/nn-objidl-istream) 方法呼叫所傳回的狀態碼。 其程式碼 (較低16位) 值的狀態碼是在 MS-DOS 錯誤碼的範圍內 (也就是說，小於 256) 與對應的 MS-DOS 錯誤具有相同的意義。 <br/> |
| 設備 \_ WIN32<br/>    | 7<br/> | 用來提供一種方法，用來處理 Windows API 中的函式的錯誤碼，以做為 **HRESULT**。 16位 OLE 中的錯誤碼也已變更為 [設備 \_ WIN32]。 <br/>                                                                                                 |
| 設備 \_ 視窗<br/>  | 8<br/> | 用於 Microsoft 定義介面中的其他錯誤碼。<br/>                                                                                                                                                                                                                                            |



 

[程式碼] 欄位是指派來代表錯誤或警告的唯一數位。

依照慣例， **HRESULT** 值通常具有下列格式的名稱：*設備* \_ *嚴重性* \_ *原因*。

*設備* 可以是設施名稱或其他一些辨別的識別碼; *嚴重性* 是單一字母、S 或 E，表示函式呼叫是否成功 (S) 或產生錯誤 (E) ; *原因* 是描述程式碼意義的識別碼。 例如，狀態碼 STG. \_ E \_ FILENOTFOUND 指出發生儲存體相關的錯誤，特別是要求的檔案不存在。 來自設備的狀態碼 \_ Null 會省略 *設備* \_ 前置詞。

錯誤碼是在介面執行的內容中定義。 一旦定義之後，就無法變更成功碼或加入新的成功碼。 不過，您可以撰寫新的失敗代碼。 Microsoft 保留為設備 \_ ITF 或新設施中所述的介面，定義新的失敗碼 (但不是成功碼) 的權利。

## <a name="related-topics"></a>相關主題

<dl> <dt>

[COM 中的錯誤處理](error-handling-in-com.md)
</dt> <dt>

[Windows通訊協定： HRESULT](/openspecs/windows_protocols/ms-erref/0642cb2f-2075-4469-918c-4441e69c548a)
</dt> </dl>

 

