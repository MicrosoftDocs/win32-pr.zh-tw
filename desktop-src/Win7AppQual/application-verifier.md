---
description: '應用程式驗證器 (Windows 7 和 Windows Server 2008 R2 應用程式品質逐步指南) '
ms.assetid: edf719b7-9bd9-4e23-9bba-d0d7c3c5dbf5
title: '應用程式驗證器 (Windows 7 和 Windows Server 2008 R2 應用程式品質逐步指南) '
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: bac2a8bc900ea9d1f35ae228371226355657b930
ms.sourcegitcommit: 95685061d5b0333bbf9e6ebd208dde8190f97005
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 04/28/2021
ms.locfileid: "108088686"
---
# <a name="application-verifier-windows-7-and-windows-server-2008-r2-application-quality-cookbook"></a><span data-ttu-id="e9377-103">應用程式驗證器 (Windows 7 和 Windows Server 2008 R2 應用程式品質逐步指南) </span><span class="sxs-lookup"><span data-stu-id="e9377-103">Application Verifier (Windows 7 and Windows Server 2008 R2 Application Quality Cookbook)</span></span>

## <a name="affected-platforms"></a><span data-ttu-id="e9377-104">受影響的平臺</span><span class="sxs-lookup"><span data-stu-id="e9377-104">Affected Platforms</span></span>

<span data-ttu-id="e9377-105">**客戶** 端-windows XP、windows Vista、windows 7</span><span class="sxs-lookup"><span data-stu-id="e9377-105">**Clients** - Windows XP, Windows Vista, Windows 7</span></span>  
<span data-ttu-id="e9377-106">**伺服器** -windows server 2003、windows server 2008、windows Server 2008 R2</span><span class="sxs-lookup"><span data-stu-id="e9377-106">**Servers** - Windows Server 2003, Windows Server 2008, Windows Server 2008 R2</span></span>  


## <a name="description"></a><span data-ttu-id="e9377-107">Description</span><span class="sxs-lookup"><span data-stu-id="e9377-107">Description</span></span>

<span data-ttu-id="e9377-108">升級並強制執行應用程式驗證器成為所有開發的品質閘道。</span><span class="sxs-lookup"><span data-stu-id="e9377-108">Promote and enforce Application Verifier as a quality gate for all development.</span></span> <span data-ttu-id="e9377-109">它包含數個改進：</span><span class="sxs-lookup"><span data-stu-id="e9377-109">It includes several improvements:</span></span>

-   <span data-ttu-id="e9377-110">我們已提供額外的檢查，以解決 Windows 錯誤報告團隊線上程集區使用期間發現的問題。</span><span class="sxs-lookup"><span data-stu-id="e9377-110">We have provided additional checks to address issues that the Windows Error Reporting team discovered during thread-pool usage.</span></span>
-   <span data-ttu-id="e9377-111">我們結合了32和64位版本的套件來解決 Windows 7 的變更，包括在64位版本的 Windows 下測試32位元件的需求，以及一般簡化。</span><span class="sxs-lookup"><span data-stu-id="e9377-111">We combined 32- and 64-bit versions of the package to address changes in Windows 7, including the needs for testing 32-bit components under a 64-bit version of Windows, as well as for general simplification.</span></span>
-   <span data-ttu-id="e9377-112">我們已包含多執行緒應用程式的額外檢查、在64位 Windows 上執行32位應用程式，以及許多 bug 修正。</span><span class="sxs-lookup"><span data-stu-id="e9377-112">We have included additional checks for multithreaded applications, running 32-bit applications on 64-bit Windows, as well as many bug fixes.</span></span>

<span data-ttu-id="e9377-113">這些變更對未啟用執行緒檢查的使用者應該不會有負面影響;他們應該會在探索和診斷現有的執行緒集區使用問題時收到額外支援。</span><span class="sxs-lookup"><span data-stu-id="e9377-113">These changes should have no negative impact on users who do not enable the Thread Checks; those who do should receive additional support in discovery and diagnosis of existing thread-pool usage problems.</span></span> <span data-ttu-id="e9377-114">無論您是否啟用執行緒檢查，都將受益于此服務中的其他增強功能和錯誤修正。</span><span class="sxs-lookup"><span data-stu-id="e9377-114">Whether or not you enable Thread Checks, you will benefit from the other improvements and bug fixes in this service.</span></span>

<span data-ttu-id="e9377-115">當使用此服務時，效能層級會稍微降低，因為通常不會在零售環境中執行，因此效能層級應該保持可接受。</span><span class="sxs-lookup"><span data-stu-id="e9377-115">While there is a slight performance penalty when using this service, the performance levels should remain acceptable because it does not typically run in retail environments.</span></span>

## <a name="usage"></a><span data-ttu-id="e9377-116">使用方式</span><span class="sxs-lookup"><span data-stu-id="e9377-116">Usage</span></span>

<span data-ttu-id="e9377-117">**一般資訊**</span><span class="sxs-lookup"><span data-stu-id="e9377-117">**General Information**</span></span>

<span data-ttu-id="e9377-118">提供可靠的 Windows 應用程式：</span><span class="sxs-lookup"><span data-stu-id="e9377-118">To deliver reliable Windows applications:</span></span>

1.  <span data-ttu-id="e9377-119">測試以非受控 (原生) 程式碼撰寫的應用程式，並在偵錯工具下使用應用程式驗證器，並在將它釋出給客戶之前，使用完整頁面堆積</span><span class="sxs-lookup"><span data-stu-id="e9377-119">Test applications written in unmanaged (native) code with Application Verifier under the debugger and with full-page heap before releasing it to customers.</span></span>
2.  <span data-ttu-id="e9377-120">遵循應用程式驗證器所提供的步驟來解決不當條件。</span><span class="sxs-lookup"><span data-stu-id="e9377-120">Follow the steps provided by Application Verifier to resolve errant conditions.</span></span>
3.  <span data-ttu-id="e9377-121">一旦發行您的應用程式之後，請定期監視 Windows 錯誤報告所收集的應用程式失敗報告。</span><span class="sxs-lookup"><span data-stu-id="e9377-121">Once your application is released, regularly monitor the application failure reports collected by Windows Error Reporting.</span></span>

<span data-ttu-id="e9377-122">依預設，會在「基本」檢查標題下啟用執行緒集區檢查。</span><span class="sxs-lookup"><span data-stu-id="e9377-122">Thread-pool checks are enabled by default under the "Basics" check heading.</span></span> <span data-ttu-id="e9377-123">因為這會包含在預設設定中，所以使用者只需要在其程式碼上執行應用程式驗證器，並使用預設設定來利用新的檢查。</span><span class="sxs-lookup"><span data-stu-id="e9377-123">As this is included in the default setting, users need only to run Application Verifier on their code with the default settings to leverage the new checks.</span></span>

<span data-ttu-id="e9377-124">**詳細資料**</span><span class="sxs-lookup"><span data-stu-id="e9377-124">**Details**</span></span>

<span data-ttu-id="e9377-125">您至少應該使用所選的基本設定來執行應用程式驗證器。</span><span class="sxs-lookup"><span data-stu-id="e9377-125">At a minimum, you should run Application Verifier with the Basics setting selected.</span></span> <span data-ttu-id="e9377-126">這是 WinLogo 和 WinQual 的必要項。</span><span class="sxs-lookup"><span data-stu-id="e9377-126">This is required for WinLogo and WinQual.</span></span> <span data-ttu-id="e9377-127">基本設定會檢查下列各項：</span><span class="sxs-lookup"><span data-stu-id="e9377-127">The Basics setting checks for the following:</span></span>

-   <span data-ttu-id="e9377-128">**例外狀況停止詳細資料** -確保應用程式不會使用結構化例外狀況處理來隱藏存取違規</span><span class="sxs-lookup"><span data-stu-id="e9377-128">**Exceptions Stop Details** - Ensures that applications do not hide access violations using structured exception handling</span></span>
-   <span data-ttu-id="e9377-129">**處理停止詳細資料** -測試以確保應用程式不會嘗試使用不正確控制碼</span><span class="sxs-lookup"><span data-stu-id="e9377-129">**Handles Stop Details** - Tests to ensure the application is not attempting to use invalid handles</span></span>
-   <span data-ttu-id="e9377-130">堆積 **停止詳細資料**-檢查堆積中的記憶體損毀問題</span><span class="sxs-lookup"><span data-stu-id="e9377-130">**Heaps Stop Details** - Checks for memory corruptions issues in the heap</span></span>
-   <span data-ttu-id="e9377-131">**輸入/輸出停止詳細資料** -監視非同步 IO 的執行，並執行各種驗證</span><span class="sxs-lookup"><span data-stu-id="e9377-131">**Input/Output Stop Details** - Monitors the execution of asynchronous IO, and performs various validations</span></span>
-   <span data-ttu-id="e9377-132">流失 **停止詳細資料**-藉由追蹤 dll 所產生的資源，而不是 dll 卸載時所釋放的資源，來偵測流失</span><span class="sxs-lookup"><span data-stu-id="e9377-132">**Leak Stop Details** - Detects leaks by tracking the resources made by a dll that are not freed by the time the dll was unloaded</span></span>
-   <span data-ttu-id="e9377-133">**鎖定停止詳細資料** -確認重要區段的正確用法</span><span class="sxs-lookup"><span data-stu-id="e9377-133">**Locks Stop Details** - Verifies the correct usage for critical sections</span></span>
-   <span data-ttu-id="e9377-134">**記憶體停止詳細資料** -確保正確使用虛擬空間操作的 api (例如 VirtualAlloc、MapViewOfFile) </span><span class="sxs-lookup"><span data-stu-id="e9377-134">**Memory Stop Details** - Ensures APIs for virtual space manipulations are used correctly (for example, VirtualAlloc, MapViewOfFile)</span></span>
-   <span data-ttu-id="e9377-135">**TLS 停止詳細資料** -確保正確使用執行緒區域儲存 api</span><span class="sxs-lookup"><span data-stu-id="e9377-135">**TLS Stop Details** - Ensures that Thread Local Storage APIs are used correctly</span></span>
-   <span data-ttu-id="e9377-136">**Threadpool 停止詳細資料** -確保執行緒集區 api 的正確使用，並在回呼後對背景工作執行緒狀態強制執行一致性檢查</span><span class="sxs-lookup"><span data-stu-id="e9377-136">**Threadpool Stop Details** - Ensures correct usage of threadpool APIs and enforces consistency checks on worker-thread-states after a callback</span></span>

<span data-ttu-id="e9377-137">如果您的應用程式是從「Vista 前」應用程式進行遷移，您會想要利用「LuaPriv」 (也稱為 UAC 檢查) 。</span><span class="sxs-lookup"><span data-stu-id="e9377-137">If your application is migrating from a "Pre-Vista" application, you will want to leverage the "LuaPriv" (also known as UAC checks).</span></span> <span data-ttu-id="e9377-138">受限的使用者帳戶許可權預測 (LuaPriv) 有兩個主要目標：</span><span class="sxs-lookup"><span data-stu-id="e9377-138">The Limited User Account Privilege Predictor (LuaPriv) has two primary goals:</span></span>

-   <span data-ttu-id="e9377-139">**預測** 性：執行具有系統管理許可權的應用程式時，如果以較低許可權執行 (通常是一般的使用者) ，請預測該應用程式是否也能運作。</span><span class="sxs-lookup"><span data-stu-id="e9377-139">**Predictive**: While running an application with administrative privilege, predict whether that application would work as well if run with less privilege (generally, as a normal user).</span></span> <span data-ttu-id="e9377-140">例如，如果應用程式寫入僅允許系統管理員存取的檔案，則該應用程式將無法寫入至相同的檔案（如果以非系統管理員身分執行）。</span><span class="sxs-lookup"><span data-stu-id="e9377-140">For example, if the application writes to files that only allow Administrators access, then that application will not be able to write to the same file if run as a non-administrator.</span></span>
-   <span data-ttu-id="e9377-141">**診斷**：在以非系統管理員許可權執行時，識別目前執行可能已存在的潛在問題。</span><span class="sxs-lookup"><span data-stu-id="e9377-141">**Diagnostic**: While running with non-administrator privilege, identify potential problems that may already exist with the current run.</span></span> <span data-ttu-id="e9377-142">繼續先前的範例，如果應用程式嘗試寫入僅授與系統管理員群組成員存取權的檔案，則應用程式將會收到 \_ 拒絕存取錯誤。</span><span class="sxs-lookup"><span data-stu-id="e9377-142">Continuing the previous example, if the application tries to write to a file that grants only Administrator group members access, the application will get an ACCESS\_DENIED error.</span></span> <span data-ttu-id="e9377-143">如果應用程式無法正常運作，此作業可能會是錯誤。</span><span class="sxs-lookup"><span data-stu-id="e9377-143">If the application does not operate correctly, this operation may be the culprit.</span></span>

<span data-ttu-id="e9377-144">LuaPriv 可識別下列類型的問題：</span><span class="sxs-lookup"><span data-stu-id="e9377-144">LuaPriv identifies the following types of problems:</span></span>



| <span data-ttu-id="e9377-145">**潛在問題**</span><span class="sxs-lookup"><span data-stu-id="e9377-145">**Potential Issue**</span></span>       | <span data-ttu-id="e9377-146">**說明**</span><span class="sxs-lookup"><span data-stu-id="e9377-146">**Description**</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|---------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="e9377-147">限制的命名空間</span><span class="sxs-lookup"><span data-stu-id="e9377-147">Restricted Namespaces</span></span>     | <span data-ttu-id="e9377-148">在不含命名空間的情況下， (事件、信號、Mutex 等) 建立未命名的同步處理物件，可能會因為作業系統可能會選擇將物件放在受限制的命名空間中而變得複雜。</span><span class="sxs-lookup"><span data-stu-id="e9377-148">Creating a named synchronization object (Event, Semaphore, Mutex, etc) without a namespace may complicate running without privilege on some operating systems because the operating system may choose to place the object in a restricted namespace.</span></span> <span data-ttu-id="e9377-149">在受限制的命名空間中建立這類物件 (例如全域命名空間) 需要 SeCreateGlobalPrivilege，只授與系統管理員。</span><span class="sxs-lookup"><span data-stu-id="e9377-149">Creating such an object in a restricted namespace (such as the Global namespace) requires SeCreateGlobalPrivilege, which is granted only to administrators.</span></span><br/> <span data-ttu-id="e9377-150">如果偵測到這些問題，LuaPriv 會將這兩個問題旗標。</span><span class="sxs-lookup"><span data-stu-id="e9377-150">LuaPriv flags both these issues if it detects them.</span></span><br/> |
| <span data-ttu-id="e9377-151">硬系統管理員檢查</span><span class="sxs-lookup"><span data-stu-id="e9377-151">Hard Administrator Checks</span></span> | <span data-ttu-id="e9377-152">有些應用程式會詢問使用者的安全性權杖，以找出他/她擁有多少許可權。</span><span class="sxs-lookup"><span data-stu-id="e9377-152">Some applications interrogate the user's security token to find out how much privilege he/she has.</span></span> <span data-ttu-id="e9377-153">在這些情況下，應用程式可能會根據它認為使用者的耗電量來變更其行為。</span><span class="sxs-lookup"><span data-stu-id="e9377-153">In those cases, the application may change its behavior depending on how much power it thinks the user has.</span></span> <br/> <span data-ttu-id="e9377-154">LuaPriv 會將傳回此資訊的旗標 API 呼叫加以旗標。</span><span class="sxs-lookup"><span data-stu-id="e9377-154">LuaPriv flags API calls that return this information.</span></span><br/>                                                                                                                                                                                                |
| <span data-ttu-id="e9377-155">要求許可權</span><span class="sxs-lookup"><span data-stu-id="e9377-155">Requesting Privileges</span></span>     | <span data-ttu-id="e9377-156">應用程式可能會嘗試啟用安全性相關的許可權 (例如 SeTcbPrivilege 或 SeSecurityPrivilege) ，然後再執行需要它的作業。</span><span class="sxs-lookup"><span data-stu-id="e9377-156">An application may attempt to enable a security-relevant privilege (such as SeTcbPrivilege or SeSecurityPrivilege) prior to performing an operation that requires it.</span></span> <br/> <span data-ttu-id="e9377-157">LuaPriv 旗標會嘗試啟用安全性相關的許可權。</span><span class="sxs-lookup"><span data-stu-id="e9377-157">LuaPriv flags attempts to enable security-relevant privileges.</span></span> <br/>                                                                                                                                                                                                                               |
| <span data-ttu-id="e9377-158">缺少許可權</span><span class="sxs-lookup"><span data-stu-id="e9377-158">Missing Privileges</span></span>        | <span data-ttu-id="e9377-159">如果應用程式嘗試啟用使用者沒有的許可權，可能會表示應用程式需要許可權，這可能會導致行為差異。</span><span class="sxs-lookup"><span data-stu-id="e9377-159">If an application attempts to enable a privilege that the user does not have, it probably signals that the application expects the privilege, which can cause behavior differences.</span></span> <br/> <span data-ttu-id="e9377-160">LuaPriv 旗標失敗的許可權要求。</span><span class="sxs-lookup"><span data-stu-id="e9377-160">LuaPriv flags failed privilege requests.</span></span> <br/>                                                                                                                                                                                                                                       |
| <span data-ttu-id="e9377-161">INI-File 作業</span><span class="sxs-lookup"><span data-stu-id="e9377-161">INI-File Operations</span></span>       | <span data-ttu-id="e9377-162">嘗試寫入對應的 INI 檔案 (WritePrivateProfileSection 和類似的 Api) 可能會失敗為非系統管理員使用者。</span><span class="sxs-lookup"><span data-stu-id="e9377-162">Attempts to write to mapped INI files (WritePrivateProfileSection and similar APIs) can fail as a non-administrator user.</span></span> <br/> <span data-ttu-id="e9377-163">LuaPriv 旗標這類作業。</span><span class="sxs-lookup"><span data-stu-id="e9377-163">LuaPriv flags such operations.</span></span><br/>                                                                                                                                                                                                                                                                                                            |
| <span data-ttu-id="e9377-164">拒絕存取</span><span class="sxs-lookup"><span data-stu-id="e9377-164">Access Denied</span></span>             | <span data-ttu-id="e9377-165">如果應用程式嘗試存取 (檔案、登錄機碼等) 的物件，但嘗試因為存取權不足而失敗，則應用程式可能預期會以比它更多的許可權來執行。</span><span class="sxs-lookup"><span data-stu-id="e9377-165">If the application attempts to access an object (File, registry key, etc) but the attempt fails due to insufficient access, then the application probably expects to be running with more privilege than it has.</span></span> <br/> <span data-ttu-id="e9377-166">LuaPriv 會旗標物件-開啟拒絕存取的嘗試 \_ ，以及類似的錯誤。</span><span class="sxs-lookup"><span data-stu-id="e9377-166">LuaPriv flags object-open attempts that fail with ACCESS\_DENIED and similar errors.</span></span><br/>                                                                                                                                                               |
| <span data-ttu-id="e9377-167">Deny Ace</span><span class="sxs-lookup"><span data-stu-id="e9377-167">Deny ACEs</span></span>                 | <span data-ttu-id="e9377-168">如果物件在其 DACL 中有 Deny Ace，則會明確拒絕對特定實體的存取。</span><span class="sxs-lookup"><span data-stu-id="e9377-168">If an object has Deny ACEs in its DACL, then it explicitly denies access to specific entities.</span></span> <br/> <span data-ttu-id="e9377-169">這種情況並不常見，因此很難進行預測，所以 LuaPriv 旗標會在找到時旗標拒絕 Ace。</span><span class="sxs-lookup"><span data-stu-id="e9377-169">This is uncommon, and makes prediction difficult, so LuaPriv flags Deny ACEs when it finds them.</span></span><br/>                                                                                                                                                                                                                                                                     |
| <span data-ttu-id="e9377-170">存取受限</span><span class="sxs-lookup"><span data-stu-id="e9377-170">Access Restricted</span></span>         | <span data-ttu-id="e9377-171">如果應用程式嘗試針對未授與一般使用者的許可權開啟物件 (例如，嘗試寫入只能由系統管理員) 寫入的檔案，則應用程式在以一般使用者的身分執行時，可能不會有相同的運作方式。</span><span class="sxs-lookup"><span data-stu-id="e9377-171">If an application attempts to open an object for rights that are not granted to normal users (for example, trying to write to a file that is only writeable by administrators), then the application probably will not work the same when run as a normal user.</span></span> <br/> <span data-ttu-id="e9377-172">LuaPriv 旗標這類作業。</span><span class="sxs-lookup"><span data-stu-id="e9377-172">LuaPriv flags such operations.</span></span><br/>                                                                                                                                                                      |
| <span data-ttu-id="e9377-173">允許的最大值 \_</span><span class="sxs-lookup"><span data-stu-id="e9377-173">MAXIMUM\_ALLOWED</span></span>          | <span data-ttu-id="e9377-174">如果應用程式針對允許的最大值開啟物件 \_ ，則物件上的實際存取權檢查將會出現在其他地方。</span><span class="sxs-lookup"><span data-stu-id="e9377-174">If an application opens an object for MAXIMUM\_ALLOWED, then the actual access check on the object will occur elsewhere.</span></span> <span data-ttu-id="e9377-175">大部分執行此作業的程式碼都無法正常運作，而且在沒有許可權的情況下執行時幾乎不會有不同的運作方式。</span><span class="sxs-lookup"><span data-stu-id="e9377-175">Most code that does this does not work correctly, and will almost certainly work differently when run without privilege.</span></span> <br/> <span data-ttu-id="e9377-176">因此，LuaPriv 會標示最大允許的所有事件 \_ 。</span><span class="sxs-lookup"><span data-stu-id="e9377-176">LuaPriv thus flags all incidents of MAXIMUM\_ALLOWED.</span></span> <br/>                                                                                                                                                            |



 

<span data-ttu-id="e9377-177">常見的忽略問題會在含糊的其他檢查中捕捉：</span><span class="sxs-lookup"><span data-stu-id="e9377-177">Commonly overlooked issues are captured in the nebulous Misc Checks:</span></span>

-   <span data-ttu-id="e9377-178">危險 Api 停止詳細資料</span><span class="sxs-lookup"><span data-stu-id="e9377-178">Dangerous APIs Stop Details</span></span>
-   <span data-ttu-id="e9377-179">中途堆疊停止詳細資料</span><span class="sxs-lookup"><span data-stu-id="e9377-179">Dirty Stacks Stop Details</span></span>
-   <span data-ttu-id="e9377-180">時間變換</span><span class="sxs-lookup"><span data-stu-id="e9377-180">Time Rollover</span></span>

<span data-ttu-id="e9377-181">我們已加入新的列印驗證器。</span><span class="sxs-lookup"><span data-stu-id="e9377-181">We have added a new Print Verifier.</span></span> <span data-ttu-id="e9377-182">這一層可協助您尋找應用程式呼叫列印子系統時可能產生的問題，並進行疑難排解。</span><span class="sxs-lookup"><span data-stu-id="e9377-182">This layer helps find and troubleshoot issues that may result when an application calls the print subsystem.</span></span> <span data-ttu-id="e9377-183">列印驗證器會以列印子系統的兩層、PrintAPI 層和 PrintDriver 層為目標。</span><span class="sxs-lookup"><span data-stu-id="e9377-183">Print Verifier targets the two layers of the print subsystem, the PrintAPI layer and the PrintDriver layer.</span></span>

<span data-ttu-id="e9377-184">*列印 API 層*</span><span class="sxs-lookup"><span data-stu-id="e9377-184">*Print API Layer*</span></span>

<span data-ttu-id="e9377-185">Print Verifier 會測試程式與 Winspool.drv 之間的介面。 winspool.drv 和 prntvpt.dll，並測試這些 Dll 的介面。</span><span class="sxs-lookup"><span data-stu-id="e9377-185">Print Verifier tests the interface between a program and Winspool.drv and prntvpt.dll and tests the interfaces of those DLLs.</span></span> <span data-ttu-id="e9377-186">您可以在 MSDN [說明] 區段中，針對 winspool.drv. winspool.drv 所匯出的 Api 和 prntvpt.dll，檢查此介面中呼叫函式的規則。</span><span class="sxs-lookup"><span data-stu-id="e9377-186">You can review the rules for calling functions in this interface in the MSDN help section for APIs exported by winspool.drv and prntvpt.dll.</span></span>

<span data-ttu-id="e9377-187">*列印驅動層*</span><span class="sxs-lookup"><span data-stu-id="e9377-187">*Print Driver Layer*</span></span>

<span data-ttu-id="e9377-188">列印驗證器也會測試核心列印驅動程式（例如 UNIDRV.DLL、UNIDRUI.DLL、PSCRIPT5.DLL、PS5UI.DLL 或 MXDWDRV.DLL）與列印驅動程式外掛程式之間的介面。您可以在 MSDN 和 WDK 中找到此介面的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="e9377-188">Print Verifier also tests the interface between a core print driver such as UNIDRV.DLL, UNIDRUI.DLL, PSCRIPT5.DLL, PS5UI.DLL, or MXDWDRV.DLL, and the print driver plug-ins. You can find information about this interface in the MSDN and the WDK.</span></span>

<span data-ttu-id="e9377-189">請注意，其中有些檢查僅適用于 Windows 7，其他檢查則只在 Windows 7 下執行得更好。</span><span class="sxs-lookup"><span data-stu-id="e9377-189">Note that some of these checks are for Windows 7 only, and others will simply perform better under Windows 7.</span></span>

<span data-ttu-id="e9377-190">一般來說，只有 debug 版本會執行應用程式驗證器，因此效能通常不會發生問題。</span><span class="sxs-lookup"><span data-stu-id="e9377-190">Typically, only debug versions run the Application Verifier, so performance is not generally an issue.</span></span> <span data-ttu-id="e9377-191">如果使用這項或任何其他應用程式驗證器檢查產生效能問題，請在執行所有必要的檢查時，一次執行一次檢查。</span><span class="sxs-lookup"><span data-stu-id="e9377-191">If performance issues arise from the use of this, or any other Application Verifier check, run one check at a time until you have performed all needed checks.</span></span>

<span data-ttu-id="e9377-192">在 Windows 系統上，應用程式損毀的將近10% 是因為堆積損毀。</span><span class="sxs-lookup"><span data-stu-id="e9377-192">Nearly 10% of application crashes on Windows systems are due to heap corruption.</span></span> <span data-ttu-id="e9377-193">這些損毀幾乎無法在事實之後進行調試。</span><span class="sxs-lookup"><span data-stu-id="e9377-193">These crashes are nearly impossible to debug after the fact.</span></span> <span data-ttu-id="e9377-194">避免這些問題的最佳方式，就是使用應用程式驗證器中的頁面堆積功能進行測試。</span><span class="sxs-lookup"><span data-stu-id="e9377-194">The best way to avoid these issues is to test with the Page Heap features found in Application Verifier.</span></span> <span data-ttu-id="e9377-195">頁面堆積有兩種類別：「完整」和「淺色」。</span><span class="sxs-lookup"><span data-stu-id="e9377-195">There are two flavors of Page Heap: "Full" and "Light."</span></span> <span data-ttu-id="e9377-196">Full 是預設值;它會強制偵錯工具在偵測到損毀時立即停止。</span><span class="sxs-lookup"><span data-stu-id="e9377-196">Full is the default; it will force a debugger stop instantly upon detecting corruption.</span></span> <span data-ttu-id="e9377-197">這項功能必須在偵錯工具下執行。</span><span class="sxs-lookup"><span data-stu-id="e9377-197">This feature MUST be run while under the debugger.</span></span> <span data-ttu-id="e9377-198">不過，這也是最耗費資源的需求。</span><span class="sxs-lookup"><span data-stu-id="e9377-198">However, it is also the most resource demanding.</span></span> <span data-ttu-id="e9377-199">如果使用者有時間問題，且已在 [完整] 頁面堆積下執行案例，將其設定為 [淺色] 可能會解決這些問題。</span><span class="sxs-lookup"><span data-stu-id="e9377-199">If a user is having timing issues and has already run a scenario under "Full" Page Heap, setting it to "Light" will likely address these issues.</span></span> <span data-ttu-id="e9377-200">此外，在進程結束之前，輕量頁面堆積不會損毀。</span><span class="sxs-lookup"><span data-stu-id="e9377-200">Additionally, Light Page Heap does not crash until the process exits.</span></span> <span data-ttu-id="e9377-201">它確實會提供堆疊追蹤給配置，但使用它的完整對應，可能需要更長的時間來進行診斷。</span><span class="sxs-lookup"><span data-stu-id="e9377-201">It does provide a stack trace to the allocation, but can take considerably longer to diagnose than leveraging its Full counterpart.</span></span>

<span data-ttu-id="e9377-202">透過 Winqual web 入口網站監視應用程式的可靠性狀態。</span><span class="sxs-lookup"><span data-stu-id="e9377-202">Monitor the reliability status of the applications via the Winqual web portal.</span></span> <span data-ttu-id="e9377-203">此入口網站會顯示透過 Windows 錯誤報告收集的錯誤報表，因此很容易就能找出最常見的失敗。</span><span class="sxs-lookup"><span data-stu-id="e9377-203">This portal shows the error reports collected via Windows Error Reporting, so it is easy to identify the most frequent failures.</span></span> <span data-ttu-id="e9377-204">在 Windows 錯誤報告：開始使用瞭解這一點。</span><span class="sxs-lookup"><span data-stu-id="e9377-204">Learn about this at Windows Error Reporting: Getting Started.</span></span> <span data-ttu-id="e9377-205">Microsoft 不會對此服務收費。</span><span class="sxs-lookup"><span data-stu-id="e9377-205">Microsoft does not charge for this service.</span></span>

<span data-ttu-id="e9377-206">若要利用 WinQual，您必須：</span><span class="sxs-lookup"><span data-stu-id="e9377-206">To take advantage of WinQual, you must:</span></span>

1.  <span data-ttu-id="e9377-207">註冊您的公司以進行 WinQual，這需要 VeriSign 識別碼。</span><span class="sxs-lookup"><span data-stu-id="e9377-207">Register your company for WinQual, which requires a VeriSign ID.</span></span> <span data-ttu-id="e9377-208">您可以在開發人員入口網站的 windows Vista SP1 windows Server 2008 下，找到有關 WinQual 的 Windows 7 資訊 \\ 。</span><span class="sxs-lookup"><span data-stu-id="e9377-208">You can find Windows 7 information about WinQual in the developer portal grouped under Windows Vista SP1 \\ Windows Server 2008.</span></span> <span data-ttu-id="e9377-209">它很快就會有 Windows 7 的位置。</span><span class="sxs-lookup"><span data-stu-id="e9377-209">It will have a Windows 7 location soon.</span></span>
2.  <span data-ttu-id="e9377-210">將 ISV 應用程式對應到產品名稱和 ISV 名稱，將失敗報告連結到公司。</span><span class="sxs-lookup"><span data-stu-id="e9377-210">Map the ISV applications to a product name and the ISV name, which links the failure reports to the company.</span></span> <span data-ttu-id="e9377-211">其他 Isv 無法查看您的錯誤報表。</span><span class="sxs-lookup"><span data-stu-id="e9377-211">Other ISVs cannot view your error reports.</span></span>
3.  <span data-ttu-id="e9377-212">使用入口網站來找出最重要的問題。</span><span class="sxs-lookup"><span data-stu-id="e9377-212">Use the portal to identify top issues.</span></span> <span data-ttu-id="e9377-213">Isv 也可以建立回應，通知客戶失敗後應採取的步驟。</span><span class="sxs-lookup"><span data-stu-id="e9377-213">ISVs can also create responses that inform customers what steps to take after a failure.</span></span> <span data-ttu-id="e9377-214">回應系統支援全球超過10種語言。</span><span class="sxs-lookup"><span data-stu-id="e9377-214">The response system supports over 10 languages worldwide.</span></span>

<span data-ttu-id="e9377-215">另外一點要注意：應用程式驗證器只與您執行它的程式碼路徑一樣好。</span><span class="sxs-lookup"><span data-stu-id="e9377-215">One further note: Application Verifier is only as good as the code paths you run it against.</span></span> <span data-ttu-id="e9377-216">將此工具與程式碼涵蓋範圍工具結合的價值無法過。</span><span class="sxs-lookup"><span data-stu-id="e9377-216">The value of combining this tool with a code coverage tool cannot be overstated.</span></span>

## <a name="links-to-other-resources"></a><span data-ttu-id="e9377-217">其他資源的連結</span><span class="sxs-lookup"><span data-stu-id="e9377-217">Links to Other Resources</span></span>

<span data-ttu-id="e9377-218">**適用于 Windows 的偵錯工具：**</span><span class="sxs-lookup"><span data-stu-id="e9377-218">**Debugging Tools for Windows:**</span></span>

-   [<span data-ttu-id="e9377-219">總覽和下載網站</span><span class="sxs-lookup"><span data-stu-id="e9377-219">Overview and download site</span></span>](https://msdn.microsoft.com/windows/hardware/bg127145)
-   [<span data-ttu-id="e9377-220">MSDN 線上檔</span><span class="sxs-lookup"><span data-stu-id="e9377-220">MSDN online documentation</span></span>](/windows-hardware/drivers/debugger/)

<span data-ttu-id="e9377-221">**應用程式驗證器：**</span><span class="sxs-lookup"><span data-stu-id="e9377-221">**Application Verifier:**</span></span>

-   <span data-ttu-id="e9377-222">[概觀](/previous-versions/ms220948(v=vs.80))</span><span class="sxs-lookup"><span data-stu-id="e9377-222">[Overview](/previous-versions/ms220948(v=vs.80))</span></span>
-   [<span data-ttu-id="e9377-223">下載</span><span class="sxs-lookup"><span data-stu-id="e9377-223">Download</span></span>](https://www.microsoft.com/downloads/details.aspx?FamilyID=c4a25ab9-649d-4a1b-b4a7-c9d8b095df18&amp;DisplayLang=en)
-   <span data-ttu-id="e9377-224">[適用于 Microsoft Visual Studio 2008/.NET Framework 3.5 的應用程式驗證器](/previous-versions/ms220948(v=vs.80))</span><span class="sxs-lookup"><span data-stu-id="e9377-224">[Application Verifier for Microsoft Visual Studio 2008/.NET Framework 3.5](/previous-versions/ms220948(v=vs.80))</span></span>

    <span data-ttu-id="e9377-225">**注意：** 隨附于 Visual Studio 的應用程式驗證器版本相當的日期。</span><span class="sxs-lookup"><span data-stu-id="e9377-225">**Note:** the Application Verifier version that ships in Visual Studio is quite dated.</span></span> <span data-ttu-id="e9377-226">可能的話，請改用獨立套件。</span><span class="sxs-lookup"><span data-stu-id="e9377-226">If possible, use the standalone package instead.</span></span> <span data-ttu-id="e9377-227">基於這個理由，未來的 Visual Studio 版本將不再有內嵌應用程式驗證器。</span><span class="sxs-lookup"><span data-stu-id="e9377-227">For this reason, future versions of Visual Studio will no longer have embedded Application Verifier.</span></span>

<span data-ttu-id="e9377-228">**WinQual:**</span><span class="sxs-lookup"><span data-stu-id="e9377-228">**WinQual:**</span></span>

-   [<span data-ttu-id="e9377-229">Windows Quality Online Services (Winqual) </span><span class="sxs-lookup"><span data-stu-id="e9377-229">Windows Quality Online Services (Winqual)</span></span>](/windows-hardware/drivers/dashboard/winqual-submission-tool--winqualexe-)
-   [<span data-ttu-id="e9377-230">Windows 錯誤報告：開始使用</span><span class="sxs-lookup"><span data-stu-id="e9377-230">Windows Error Reporting: Getting Started</span></span>](../wer/using-wer.md)

 

 
