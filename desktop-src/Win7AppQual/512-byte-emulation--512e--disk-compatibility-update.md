---
description: 本主題介紹軟體的先進格式儲存裝置效果、討論應用程式如何協助支援這種類型的媒體，以及討論 Microsoft 在 Windows 7 SP1 和 Windows Server 2008 R2 SP1 引進的基礎結構，讓開發人員能夠支援這些類型的裝置。
ms.assetid: 1D2847A7-15E9-42E0-90EB-7F43E76D3E44
title: 512 位元組模擬 (512e) 磁碟相容性更新
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 74b654473fa8be5fbea997bd063df2c1f898a7d1
ms.sourcegitcommit: 78b64f3865e64768b5319d4f010032ee68924a98
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 04/13/2021
ms.locfileid: "107315001"
---
# <a name="512-byte-emulation-512e-disk-compatibility-update"></a><span data-ttu-id="309de-103">512 位元組模擬 (512e) 磁碟相容性更新</span><span class="sxs-lookup"><span data-stu-id="309de-103">512-byte Emulation (512e) Disk Compatibility Update</span></span>

## <a name="platform"></a><span data-ttu-id="309de-104">平台</span><span class="sxs-lookup"><span data-stu-id="309de-104">Platform</span></span>

 <span data-ttu-id="309de-105">**客戶** 端-windows Vista、windows 7、WINDOWS 7 SP1</span><span class="sxs-lookup"><span data-stu-id="309de-105">**Clients** - Windows Vista, Windows 7, Windows 7 SP1</span></span>  
<span data-ttu-id="309de-106">**伺服器** -windows server 2008、windows Server 2008 R2、windows Server 2008 R2 SP1</span><span class="sxs-lookup"><span data-stu-id="309de-106">**Servers** - Windows Server 2008, Windows Server 2008 R2, Windows Server 2008 R2 SP1</span></span>  

## <a name="feature-impact"></a><span data-ttu-id="309de-107">功能影響</span><span class="sxs-lookup"><span data-stu-id="309de-107">Feature Impact</span></span>

<span data-ttu-id="309de-108">**嚴重性** -高</span><span class="sxs-lookup"><span data-stu-id="309de-108">**Severity** - High</span></span>  
<span data-ttu-id="309de-109">**頻率** -高</span><span class="sxs-lookup"><span data-stu-id="309de-109">**Frequency** - High</span></span>  









## <a name="description"></a><span data-ttu-id="309de-110">描述</span><span class="sxs-lookup"><span data-stu-id="309de-110">Description</span></span>

<span data-ttu-id="309de-111">Areal 密度是每年增加的，而最近一次出現 3 TB 的磁片時，用來處理遞減信號對雜訊比率 (SNR) 的錯誤修正機制會變得沒有效率，也就是為了確保媒體可供使用，需要增加的額外負荷量。</span><span class="sxs-lookup"><span data-stu-id="309de-111">Areal densities are increasing yearly, and with the recent advent of 3 TB disks, the error correction mechanisms used to deal with the decreasing Signal-to-Noise-Ratio (SNR) are becoming space inefficient – that is, an increased amount of overhead is required to ensure the media is usable.</span></span> <span data-ttu-id="309de-112">其中一個用來改善此錯誤修正機制的儲存體產業解決方案，是引進不同的實體媒體格式，其中包含較大的實體磁區大小。</span><span class="sxs-lookup"><span data-stu-id="309de-112">One of the storage industry solutions for improving this error correction mechanism is to introduce a different physical media format that includes a larger physical sector size.</span></span> <span data-ttu-id="309de-113">這種新的實體媒體格式稱為 *Advanced format*。</span><span class="sxs-lookup"><span data-stu-id="309de-113">This new physical media format is called *Advanced Format*.</span></span> <span data-ttu-id="309de-114">因此，若要對新式儲存裝置的磁區大小做出任何假設，開發人員將需要研究其程式碼的基礎，以判斷是否有影響。</span><span class="sxs-lookup"><span data-stu-id="309de-114">Therefore, it is no longer safe to make any assumptions regarding the sector size of modern storage devices, and developers will need to study the assumptions underlying their code to determine if there is an impact.</span></span>

<span data-ttu-id="309de-115">本主題介紹軟體的先進格式儲存裝置效果、討論應用程式如何協助支援此類型的媒體，以及討論可讓開發人員支援這些裝置類型的基礎結構。</span><span class="sxs-lookup"><span data-stu-id="309de-115">This topic introduces the effect of Advanced Format storage devices on software, discusses what applications can do to help support this type of media, and discusses the infrastructure to enable developers to support these types of devices.</span></span> <span data-ttu-id="309de-116">雖然本主題中顯示的內容提供改善與 Advanced Format 磁片相容性的指導方針，但這項資訊通常適用于所有具有 Advanced Format 磁片的系統。</span><span class="sxs-lookup"><span data-stu-id="309de-116">While the material presented in this topic provides guidelines for improving compatibility with Advanced Format disks, the information applies generally to all systems with Advanced Format disks.</span></span> <span data-ttu-id="309de-117">下列 Windows 版本提供查詢實體磁區大小的支援：</span><span class="sxs-lookup"><span data-stu-id="309de-117">The following versions of Windows provide support for querying the physical sector size:</span></span>

-   <span data-ttu-id="309de-118">具有 Microsoft KB 982018 的 Windows 7</span><span class="sxs-lookup"><span data-stu-id="309de-118">Windows 7 with Microsoft KB 982018</span></span>
-   <span data-ttu-id="309de-119">Windows 7 SP1</span><span class="sxs-lookup"><span data-stu-id="309de-119">Windows 7 SP1</span></span>
-   <span data-ttu-id="309de-120">Windows Server 2008 R2 （含 Microsoft KB 982018）</span><span class="sxs-lookup"><span data-stu-id="309de-120">Windows Server 2008 R2 with Microsoft KB 982018</span></span>
-   <span data-ttu-id="309de-121">Windows Server 2008 R2 SP1</span><span class="sxs-lookup"><span data-stu-id="309de-121">Windows Server 2008 R2 SP1</span></span>
-   <span data-ttu-id="309de-122">Windows Vista 與 Microsoft KB 2553708</span><span class="sxs-lookup"><span data-stu-id="309de-122">Windows Vista with Microsoft KB 2553708</span></span>
-   <span data-ttu-id="309de-123">Windows Server 2008 與 Microsoft KB 2553708</span><span class="sxs-lookup"><span data-stu-id="309de-123">Windows Server 2008 with Microsoft KB 2553708</span></span>

<span data-ttu-id="309de-124">如需其他詳細資訊，請參閱 [Windows 中適用于大型磁區磁片磁碟機的 Microsoft 支援原則的相關資訊](https://support.microsoft.com/kb/2510009)。</span><span class="sxs-lookup"><span data-stu-id="309de-124">For additional details, see [Information about Microsoft support policy for large-sector drives in Windows](https://support.microsoft.com/kb/2510009).</span></span>

<span data-ttu-id="309de-125">如需有關 Advanced Format 磁片的詳細資訊，請洽詢您的存放裝置廠商。</span><span class="sxs-lookup"><span data-stu-id="309de-125">For more information about Advanced Format disks, please contact your storage vendor.</span></span>

## <a name="logical-vs-physical-sector-size"></a><span data-ttu-id="309de-126">邏輯與實體磁區大小</span><span class="sxs-lookup"><span data-stu-id="309de-126">Logical vs. Physical Sector Size</span></span>

<span data-ttu-id="309de-127">以媒體格式引進這項變更的其中一項考慮，是與目前市場上目前可用的軟體和硬體相容。</span><span class="sxs-lookup"><span data-stu-id="309de-127">One of the concerns in introducing this change in the media format is compatibility with the software and hardware currently available in the market today.</span></span> <span data-ttu-id="309de-128">做為暫時的解決方案，存放裝置產業最初推出的磁片會模擬一般的512位元組磁區磁片，但透過標準 ATA 和 SCSI 命令，提供真正磁區大小的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="309de-128">As a temporary solution, the storage industry is initially introducing disks that emulate a regular 512-byte sector disk, but make available information about the true sector size through standard ATA and SCSI commands.</span></span> <span data-ttu-id="309de-129">這種模擬的結果有兩個磁區大小：</span><span class="sxs-lookup"><span data-stu-id="309de-129">As a result of this emulation, there are two sector sizes:</span></span>

-   <span data-ttu-id="309de-130">**邏輯磁區**：用於邏輯區塊定址媒體的單位。</span><span class="sxs-lookup"><span data-stu-id="309de-130">**Logical Sector**: The unit that is used for logical block addressing for the media.</span></span> <span data-ttu-id="309de-131">我們也可以將它視為儲存體可接受的最小寫入單位。</span><span class="sxs-lookup"><span data-stu-id="309de-131">We can also think of it as the smallest unit of write that the storage can accept.</span></span> <span data-ttu-id="309de-132">這是模擬。</span><span class="sxs-lookup"><span data-stu-id="309de-132">This is the emulation.</span></span>

-   <span data-ttu-id="309de-133">**實體磁區**：裝置的讀取和寫入作業會在單一作業中完成的單位。</span><span class="sxs-lookup"><span data-stu-id="309de-133">**Physical Sector**: The unit for which read and write operations to the device are completed in a single operation.</span></span> <span data-ttu-id="309de-134">這是不可部分完成的寫入單位。</span><span class="sxs-lookup"><span data-stu-id="309de-134">This is the unit of atomic write.</span></span>

<span data-ttu-id="309de-135">大部分目前的 Windows Api （例如 **IOCTL \_ 磁片 \_ 取得 \_ 磁片磁碟機 \_ 幾何**）都會傳回邏輯磁區大小，但可透過 [IOCTL \_ 儲存體 \_ 查詢 \_ 屬性](/windows-hardware/drivers/ddi/content/ntddstor/ni-ntddstor-ioctl_storage_query_property)控制項程式碼抓取實體磁區大小，並以 [儲存體 \_ 存取 \_ 對齊 \_ 描述](/windows/desktop/api/winioctl/ns-winioctl-storage_access_alignment_descriptor)元結構中的 **BytesPerPhysicalSector** 欄位包含相關資訊。</span><span class="sxs-lookup"><span data-stu-id="309de-135">Most current Windows APIs, such as **IOCTL\_DISK\_GET\_DRIVE\_GEOMETRY** will return the logical sector size, but the physical sector size can be retrieved through the [IOCTL\_STORAGE\_QUERY\_PROPERTY](/windows-hardware/drivers/ddi/content/ntddstor/ni-ntddstor-ioctl_storage_query_property) control code, with the relevant information contained in the **BytesPerPhysicalSector** field in the [STORAGE\_ACCESS\_ALIGNMENT\_DESCRIPTOR](/windows/desktop/api/winioctl/ns-winioctl-storage_access_alignment_descriptor) structure.</span></span> <span data-ttu-id="309de-136">本文稍後會更詳細地討論。</span><span class="sxs-lookup"><span data-stu-id="309de-136">This is discussed in more detail later in the article.</span></span>

## <a name="initial-types-of-large-sector-media"></a><span data-ttu-id="309de-137">大型磁區媒體的初始類型</span><span class="sxs-lookup"><span data-stu-id="309de-137">Initial Types of Large Sector Media</span></span>

<span data-ttu-id="309de-138">存放裝置產業很快就能針對具有 4 KB 實體磁區大小的媒體轉換成這種新的先進格式儲存體。</span><span class="sxs-lookup"><span data-stu-id="309de-138">The storage industry is quickly ramping up efforts to transition to this new Advanced Format type of storage for media with 4 KB physical sector sizes.</span></span> <span data-ttu-id="309de-139">有兩種類型的媒體會發佈到市場：</span><span class="sxs-lookup"><span data-stu-id="309de-139">Two types of media will be released to the market:</span></span>

-   <span data-ttu-id="309de-140">**4 KB 原生**：此媒體沒有模擬層，並且會直接公開 4 KB 作為其邏輯和實體磁區大小。</span><span class="sxs-lookup"><span data-stu-id="309de-140">**4 KB Native**: This media has no emulation layer and directly exposes 4 KB as its logical and physical sector size.</span></span> <span data-ttu-id="309de-141">Windows 和大部分其他作業系統目前不支援此媒體。</span><span class="sxs-lookup"><span data-stu-id="309de-141">This media is currently not supported by Windows and most other operating systems.</span></span> <span data-ttu-id="309de-142">不過，Microsoft 會在未來的 Windows 版本中，針對支援這類媒體的可行性進行調查，並在適當時發出知識庫文章。</span><span class="sxs-lookup"><span data-stu-id="309de-142">However, Microsoft is conducting an investigation into the feasibility of supporting this type of media in a future version of Windows and will issue a Knowledge Base article when appropriate.</span></span>
-   <span data-ttu-id="309de-143">**512-位元組模擬 (512e)**：此媒體具有如上一節所討論的模擬層，並公開512位元組做為其邏輯磁區大小 (類似於今日的一般磁片) ，但讓其實體磁區大小資訊 (4 KB) 可用。</span><span class="sxs-lookup"><span data-stu-id="309de-143">**512-byte Emulation (512e)**: This media has an emulation layer as discussed in the previous section and exposes 512-bytes as its logical sector size (similar to a regular disk today), but makes its physical sector size information (4 KB) available.</span></span> <span data-ttu-id="309de-144">這是我們目前為市場推出的數個儲存體廠商。</span><span class="sxs-lookup"><span data-stu-id="309de-144">This is what several storage vendors are currently introducing to the market.</span></span> <span data-ttu-id="309de-145">這種新型媒體的整體問題是，大部分的應用程式和作業系統都不了解實體磁區大小是否存在，這可能會導致一些問題，如下所述。</span><span class="sxs-lookup"><span data-stu-id="309de-145">This overall issue with this new type of media is that the majority of application and operating systems do not understand the existence of the physical sector size, which can result in a number of issues as will be discussed below.</span></span>

## <a name="how-emulation-works-read-modify-write-rmw"></a><span data-ttu-id="309de-146">模擬的運作方式：讀取-修改-寫入 (RMW) </span><span class="sxs-lookup"><span data-stu-id="309de-146">How Emulation Works: Read-Modify-Write (RMW)</span></span>

<span data-ttu-id="309de-147">儲存媒體具有可在其中修改實體媒體的特定單位。</span><span class="sxs-lookup"><span data-stu-id="309de-147">A storage medium has a certain unit within which the physical medium can be modified.</span></span> <span data-ttu-id="309de-148">也就是說，媒體只能以實體磁區大小的單位來寫入或重寫。</span><span class="sxs-lookup"><span data-stu-id="309de-148">That is, the media can only be written, or rewritten, in units of the physical sector size.</span></span> <span data-ttu-id="309de-149">因此，不會在此單元層級執行的寫入會需要額外的步驟，我們將在下列範例中逐步解說。</span><span class="sxs-lookup"><span data-stu-id="309de-149">Thus, writes that are not performed at this unit level would require additional steps, which we will walk through in the following example.</span></span>

<span data-ttu-id="309de-150">在此案例中，應用程式必須更新位於512位元組邏輯磁區內的 Datastor 記錄內容。</span><span class="sxs-lookup"><span data-stu-id="309de-150">In this scenario, an application needs to update the contents of a Datastor record located within a 512-byte logical sector.</span></span> <span data-ttu-id="309de-151">下圖說明存放裝置完成寫入所需的步驟：</span><span class="sxs-lookup"><span data-stu-id="309de-151">The following diagram illustrates the steps necessary for the storage device to complete the write:</span></span>

![在512位元組邏輯磁區內升級 datastor 記錄所需的步驟](images/512ermwsteps.png)

<span data-ttu-id="309de-153">如上所示，此程式牽涉到可能導致效能遺失的儲存裝置一些工作。</span><span class="sxs-lookup"><span data-stu-id="309de-153">As illustrated above, this process involves some work by the storage device that can result in a performance loss.</span></span> <span data-ttu-id="309de-154">若要避免這項額外的工作，必須更新應用程式，以執行下列動作：</span><span class="sxs-lookup"><span data-stu-id="309de-154">To avoid this additional work, applications must be updated to do the following:</span></span>

-   <span data-ttu-id="309de-155">查詢實體磁區大小。</span><span class="sxs-lookup"><span data-stu-id="309de-155">Query for the physical sector size.</span></span>
-   <span data-ttu-id="309de-156">請確定寫入與該報告的實體磁區大小一致。</span><span class="sxs-lookup"><span data-stu-id="309de-156">Ensure writes are aligned to that reported physical sector size.</span></span>

## <a name="the-resiliency-impact-of-read-modify-write"></a><span data-ttu-id="309de-157">讀取-修改-寫入的復原影響</span><span class="sxs-lookup"><span data-stu-id="309de-157">The Resiliency Impact of Read-Modify-Write</span></span>

<span data-ttu-id="309de-158">復原是指應用程式在會話之間復原狀態的能力。</span><span class="sxs-lookup"><span data-stu-id="309de-158">Resiliency speaks of the ability for an application to recover state between sessions.</span></span> <span data-ttu-id="309de-159">我們已瞭解512e 儲存體裝置在執行512位元組磁區寫入（讀取-修改-寫入迴圈）時所需的內容。</span><span class="sxs-lookup"><span data-stu-id="309de-159">We have seen what is necessary for a 512e storage device to perform a 512-byte sector write – the Read-Modify-Write cycle.</span></span> <span data-ttu-id="309de-160">讓我們看看覆寫媒體上先前實體磁區的程式中斷時，會發生什麼事。</span><span class="sxs-lookup"><span data-stu-id="309de-160">Let’s look at what would happen if the process of overwriting the previous physical sector on the media was interrupted.</span></span> <span data-ttu-id="309de-161">結果是什麼？</span><span class="sxs-lookup"><span data-stu-id="309de-161">What would be the consequences?</span></span>

-   <span data-ttu-id="309de-162">因為大部分的硬碟磁片磁碟機都有就地更新，所以實體磁區（也就是實體磁區所在的媒體部分）可能會因為部分覆寫而損毀，但不完整的資訊。</span><span class="sxs-lookup"><span data-stu-id="309de-162">Because most hard disk drives update in place, the physical sector – that is, the portion of the media where the physical sector was located – could have been corrupted with incomplete information due to a partial overwrite.</span></span> <span data-ttu-id="309de-163">換句話說，您可以將它視為可能遺失所有8個邏輯磁區， (實體磁區以邏輯方式包含) 。</span><span class="sxs-lookup"><span data-stu-id="309de-163">Put another way, you can think of it as potentially having lost all 8 logical sectors (which the physical sector logically contains).</span></span>

-   <span data-ttu-id="309de-164">雖然大部分具有資料存放區的應用程式都是設計成能夠從媒體錯誤中復原、遺失八個磁區，或以另一種方式進行，否則可能會導致資料存放區無法正常復原。</span><span class="sxs-lookup"><span data-stu-id="309de-164">While most applications with a data store are designed with the capability to recover from media errors, the loss of eight sectors, or put another way, the loss of eight commit records, can potentially make it impossible for the data store to recover gracefully.</span></span> <span data-ttu-id="309de-165">系統管理員可能需要以手動方式從備份還原資料庫，或甚至可能需要執行冗長的重建。</span><span class="sxs-lookup"><span data-stu-id="309de-165">An administrator may need to manually restore the database from a backup or may even need to perform a lengthy rebuild.</span></span>

-   <span data-ttu-id="309de-166">另一個重要的影響是，另一個應用程式造成讀寫寫入迴圈的動作，可能會導致資料遺失（即使您的應用程式不在執行中）。</span><span class="sxs-lookup"><span data-stu-id="309de-166">One more important impact is that the act of another application causing a Read-Modify-Write cycle can potentially cause your data to be lost – even if your application is not running!</span></span> <span data-ttu-id="309de-167">這只是因為您的資料和其他應用程式的資料都位於相同的實體磁區內。</span><span class="sxs-lookup"><span data-stu-id="309de-167">This is simply because your data and the other application’s data could be located within the same physical sector.</span></span>

<span data-ttu-id="309de-168">記住這一點之後，應用程式軟體必須重新評估程式碼中所採取的任何假設，並留意邏輯實體磁區大小的差異，以及本文稍後討論的一些有趣的客戶案例。</span><span class="sxs-lookup"><span data-stu-id="309de-168">With this in mind, it is important that application software reevaluate any assumptions taken in the code, and be aware of the logical-physical sector size distinction, along with some interesting customer scenarios discussed later in this article.</span></span>

<span data-ttu-id="309de-169">如果您的應用程式依賴記錄結構資料存放區，則可能會發生這個問題。</span><span class="sxs-lookup"><span data-stu-id="309de-169">This issue is more likely to occur if your application relies on a log structure data store.</span></span>

## <a name="avoiding-read-modify-write"></a><span data-ttu-id="309de-170">避免讀取-修改-寫入</span><span class="sxs-lookup"><span data-stu-id="309de-170">Avoiding Read-Modify-Write</span></span>

<span data-ttu-id="309de-171">雖然有些存放裝置廠商可能會在某些512e 儲存體裝置內引進一些緩和措施，以嘗試並協助您簡化讀寫寫入迴圈的效能和復原問題，但是在工作負載方面只會有很多緩和措施可處理。</span><span class="sxs-lookup"><span data-stu-id="309de-171">While some storage vendors may be introducing some levels of mitigation within certain 512e storage devices to try and help ease the performance and resiliency issues of the Read-Modify-Write cycle, there is only so much any mitigation can handle in terms of workload.</span></span> <span data-ttu-id="309de-172">因此，應用程式不應該依賴這項緩和措施作為長期解決方案。</span><span class="sxs-lookup"><span data-stu-id="309de-172">As such, applications should not rely on this mitigation as a long-term solution.</span></span>

<span data-ttu-id="309de-173">這項解決方案並不是磁片磁碟機的風險降低，而是讓應用程式進行正確的工作集，以避免讀寫寫入迴圈。</span><span class="sxs-lookup"><span data-stu-id="309de-173">The solution to this is not in-drive mitigation, but to have applications do the right set of things to avoid the Read-Modify-Write cycle.</span></span> <span data-ttu-id="309de-174">本節討論應用程式可能會發生大型磁區磁片問題的常見案例，並建議進行調查的途徑，以嘗試解決每個問題。</span><span class="sxs-lookup"><span data-stu-id="309de-174">This section discusses common scenarios where applications may have issues with large sector disks, and suggests an avenue of investigation to try and resolve each issue.</span></span>

### <a name="issue-1-the-partition-is-not-aligned-to-a-physical-sector-boundary"></a><span data-ttu-id="309de-175">問題1：資料分割未對齊實體磁區界限</span><span class="sxs-lookup"><span data-stu-id="309de-175">Issue 1: The partition is not aligned to a physical sector boundary</span></span>

<span data-ttu-id="309de-176">當系統管理員/使用者分割磁片時，第一個磁碟分割可能尚未在對齊的界限上建立。</span><span class="sxs-lookup"><span data-stu-id="309de-176">When the administrator/user partitions the disk, the first partition may not have been created on an aligned boundary.</span></span> <span data-ttu-id="309de-177">這可能會導致所有後續寫入變成未對齊實體磁區界限。</span><span class="sxs-lookup"><span data-stu-id="309de-177">This may cause all subsequent writes to become unaligned to physical sector boundaries.</span></span> <span data-ttu-id="309de-178">從 Windows Vista SP1 和 Windows Server 2008 開始，第一個磁碟分割會放置在磁片 4 GB 或更大的磁片 (的第一個 1024 KB，否則對齊是符合 4 KB 實體磁區界限的 64 KB) 。</span><span class="sxs-lookup"><span data-stu-id="309de-178">As of Windows Vista SP1, and Windows Server 2008, the first partition is placed at the first 1024 KB of the disk (for disks 4GB or larger, otherwise the alignment is 64 KB) that is aligned to a 4 KB physical sector boundary.</span></span> <span data-ttu-id="309de-179">不過，由於 Windows XP 中的預設資料分割、協力廠商分割公用程式或 Windows Api 的使用不正確，因此建立的分割區可能無法對齊實體磁區界限。</span><span class="sxs-lookup"><span data-stu-id="309de-179">However, given the default partitioning in Windows XP, a 3rd party partitioning utility or incorrect usage of Windows APIs, created partitions may not be aligned to a physical sector boundary.</span></span> <span data-ttu-id="309de-180">開發人員必須確保使用正確的 Api 來協助確保對齊。</span><span class="sxs-lookup"><span data-stu-id="309de-180">Developers will need to ensure that the correct APIs are used to help ensure alignment.</span></span> <span data-ttu-id="309de-181">以下列出建議的 Api 以協助確保資料分割對齊。</span><span class="sxs-lookup"><span data-stu-id="309de-181">The recommended APIs to help ensure partition alignment are outlined below.</span></span>

<span data-ttu-id="309de-182">建立新磁片區時， **IVdsPack：： CreateVolume** 和 **IVdsPack2：： CreateVolume2** api 不會使用指定的對齊參數，而是改用作業系統的對齊值預設 (windows vista sp1 將使用63個位元組，而 post windows vista sp1 將使用上述) 的預設值。</span><span class="sxs-lookup"><span data-stu-id="309de-182">The **IVdsPack::CreateVolume** and **IVdsPack2::CreateVolume2** APIs do not use the specified alignment parameter when a new volume is created, and instead use the alignment value default for the operating system (Pre-Windows Vista SP1 will use 63 bytes, and post Windows Vista SP1 will use the defaults stated above).</span></span> <span data-ttu-id="309de-183">因此，建議需要建立分割區的應用程式改用 **IVdsCreatePartitionEx：： CreatePartitionEx** 或 **IVdsAdvancedDisk：： CreatePartition** api，這會使用指定的對齊參數。</span><span class="sxs-lookup"><span data-stu-id="309de-183">Thus, it is recommended that applications that need to create partitions use the **IVdsCreatePartitionEx::CreatePartitionEx** or **IVdsAdvancedDisk::CreatePartition** APIs instead, which use the specified alignment parameter.</span></span>

<span data-ttu-id="309de-184">協助確保對齊正確的最佳方式，就是在一開始建立資料分割時正確地進行。</span><span class="sxs-lookup"><span data-stu-id="309de-184">The best way to help ensure that alignment is correct is to do it right when initially creating the partition.</span></span> <span data-ttu-id="309de-185">否則，您的應用程式在執行寫入時或在初始化時，必須考慮調整帳戶，這可能是非常複雜的事情。</span><span class="sxs-lookup"><span data-stu-id="309de-185">Otherwise your application will need to take alignment into account when performing writes or at initialization – which can be a very complex matter.</span></span> <span data-ttu-id="309de-186">從 Windows Vista SP1 來，這通常不是問題;不過，舊版的 Windows 可以建立未配置的磁碟分割，可能會導致某些 Advanced Format 磁片的效能問題。</span><span class="sxs-lookup"><span data-stu-id="309de-186">As of Windows Vista SP1, this is generally not an issue; however, older versions of Windows can create unaligned partitions that can potentially lead to performance issues with some Advanced Format disks.</span></span>

### <a name="issue-2-unbuffered-writes-not-aligned-to-physical-sector-size"></a><span data-ttu-id="309de-187">問題2：未緩衝的寫入未對齊實體磁區大小</span><span class="sxs-lookup"><span data-stu-id="309de-187">Issue 2: Unbuffered Writes not aligned to Physical Sector Size</span></span>

<span data-ttu-id="309de-188">基本問題是未緩衝的寫入與儲存媒體的回報實體磁區大小不一致，這會在可能導致效能問題的磁片磁碟機中觸發讀寫寫入。</span><span class="sxs-lookup"><span data-stu-id="309de-188">The basic issue is that unbuffered writes are not aligned to the reported physical sector size of the storage media, which triggers a Read-Modify-Write in the drive that can result in performance issues.</span></span> <span data-ttu-id="309de-189">相反地，緩衝的寫入會對齊頁面大小– 4 KB – coincidently 是第一代大型磁區媒體的實體磁區大小。</span><span class="sxs-lookup"><span data-stu-id="309de-189">Buffered writes, on the other hand, are aligned to the page size – 4 KB – which coincidently is the physical sector size of the first generation of large sector media.</span></span> <span data-ttu-id="309de-190">不過，大部分具有資料存放區的應用程式都會執行未緩衝的寫入，因此必須確保這些寫入是以實體磁區大小的單位來執行。</span><span class="sxs-lookup"><span data-stu-id="309de-190">However, most applications with a data store perform unbuffered writes, and thus will need to ensure these writes are performed in units of the physical sector size.</span></span>

<span data-ttu-id="309de-191">若要協助判斷您的應用程式是否發出未緩衝處理的 i/o，請在呼叫 **CreateFile** 函式時，查看 *dwFlagsAndAttributes* 參數中是否包含 **FILE \_ 旗標 \_ 無 \_ 緩衝** 旗標。</span><span class="sxs-lookup"><span data-stu-id="309de-191">To help determine if your application issues unbuffered I/O, check to see that you include the **FILE\_FLAG\_NO\_BUFFERING** flag in the *dwFlagsAndAttributes* parameter when you are calling the **CreateFile** function.</span></span>

<span data-ttu-id="309de-192">此外，如果您目前正在調整寫入至磁區大小，則此磁區大小很可能只是 *邏輯* 磁區大小，因為查詢媒體磁區大小的大部分現有 api 其實只會查詢定址單位（也就是邏輯磁區的大小）。</span><span class="sxs-lookup"><span data-stu-id="309de-192">Moreover, if you are currently aligning the writes to the sector size, this sector size is most likely just the *logical* sector size, as most existing APIs that query for the sector size of the media really just query the unit of addressing – that is, the logical sector size.</span></span> <span data-ttu-id="309de-193">這裡的磁區大小是實體磁區大小，也就是不可部分完成項的實際單位。</span><span class="sxs-lookup"><span data-stu-id="309de-193">The sector size of interest here is the physical sector size, which is the real unit of atomicity.</span></span> <span data-ttu-id="309de-194">一些可取得邏輯磁區大小的 Api 範例如下：</span><span class="sxs-lookup"><span data-stu-id="309de-194">Some examples of APIs that retrieve the logical sector size are:</span></span>

-   <span data-ttu-id="309de-195">**GetDiskFreeSpace**、 **GetDiskFreeSpaceEx**</span><span class="sxs-lookup"><span data-stu-id="309de-195">**GetDiskFreeSpace**, **GetDiskFreeSpaceEx**</span></span>
-   <span data-ttu-id="309de-196">**FileFsVolumeInformation**</span><span class="sxs-lookup"><span data-stu-id="309de-196">**FileFsVolumeInformation**</span></span>
-   <span data-ttu-id="309de-197">**IOCTL \_磁片 \_ 取得磁片 \_ 磁碟機 \_ 幾何**、 **IOCTL \_ 磁片取得磁片 \_ \_ 磁碟機 \_ 幾何 \_ 例如**</span><span class="sxs-lookup"><span data-stu-id="309de-197">**IOCTL\_DISK\_GET\_DRIVE\_GEOMETRY**, **IOCTL\_DISK\_GET\_DRIVE\_GEOMETRY\_EX**</span></span>
-   <span data-ttu-id="309de-198">**IVdsDisk：： GetProperties**、 **IVdsDisk3：： GetProperties2**</span><span class="sxs-lookup"><span data-stu-id="309de-198">**IVdsDisk::GetProperties**, **IVdsDisk3::GetProperties2**</span></span>

<span data-ttu-id="309de-199">**如何查詢實體磁區大小**</span><span class="sxs-lookup"><span data-stu-id="309de-199">**How to Query for the Physical Sector Size**</span></span>

<span data-ttu-id="309de-200">Microsoft 在 MSDN 上提供了程式碼範例，詳述應用程式如何查詢磁片區的實體磁區大小。</span><span class="sxs-lookup"><span data-stu-id="309de-200">Microsoft has provided a code sample on MSDN detailing how an application can query for the physical sector size of the volume.</span></span> <span data-ttu-id="309de-201">程式碼範例位於 <https://msdn.microsoft.com/library/ff800831.aspx> 。</span><span class="sxs-lookup"><span data-stu-id="309de-201">The code sample is located at <https://msdn.microsoft.com/library/ff800831.aspx>.</span></span>

<span data-ttu-id="309de-202">雖然上面的程式碼範例可讓您取得磁片區的實體磁區大小，但您應該在使用之前先對所報告的實體磁區大小執行一些基本的健全檢查，因為觀察到某些驅動程式可能不會傳回格式正確的資料：</span><span class="sxs-lookup"><span data-stu-id="309de-202">While the code sample above allows you to get the physical sector size of the volume, you should do some basic sanity checking on the reported physical sector size before using it, as it has been observed that some drivers may not return correctly formatted data:</span></span>

-   <span data-ttu-id="309de-203">請確定回報的實體磁區大小 >= 回報的邏輯磁區大小。</span><span class="sxs-lookup"><span data-stu-id="309de-203">Make sure that the reported physical sector size is >= the reported logical sector size.</span></span> <span data-ttu-id="309de-204">如果不是，則您的應用程式應該使用等於所報告邏輯磁區大小的實體磁區大小。</span><span class="sxs-lookup"><span data-stu-id="309de-204">If it is not, your application should use a physical sector size equal to the reported logical sector size.</span></span>
-   <span data-ttu-id="309de-205">確定所報告的實體磁區大小是2的乘冪。</span><span class="sxs-lookup"><span data-stu-id="309de-205">Make sure that the reported physical sector size is a power of two.</span></span> <span data-ttu-id="309de-206">如果不是，則您的應用程式應該使用等於所報告邏輯磁區大小的實體磁區大小。</span><span class="sxs-lookup"><span data-stu-id="309de-206">If it is not, your application should use a physical sector size equal to the reported logical sector size.</span></span>
-   <span data-ttu-id="309de-207">如果實體磁區大小是介於 512-個位元組和 4 KB 之間的2個值，您應該考慮將實體磁區大小舍入至報告的邏輯磁區大小。</span><span class="sxs-lookup"><span data-stu-id="309de-207">If the physical sector size is a power-of-two value between 512-bytes and 4 KB, you should consider using a physical sector size rounded down to the reported logical sector size.</span></span>
-   <span data-ttu-id="309de-208">如果實體磁區大小是大於 4 KB 的兩個值，您應該先評估應用程式處理此案例的能力，然後再使用該值。</span><span class="sxs-lookup"><span data-stu-id="309de-208">If the physical sector size is a power-of-two value greater than 4 KB, you should evaluate your application’s ability to handle this scenario before using that value.</span></span> <span data-ttu-id="309de-209">否則，您應該考慮使用舍入至 4 KB 的實體磁區大小。</span><span class="sxs-lookup"><span data-stu-id="309de-209">Otherwise, you should consider using a physical sector size rounded down to 4 KB.</span></span>

<span data-ttu-id="309de-210">使用這個 IOCTL 來取得實體磁區大小有幾項限制：</span><span class="sxs-lookup"><span data-stu-id="309de-210">Using this IOCTL to get the physical sector size does have several limitations:</span></span>

-   <span data-ttu-id="309de-211">需要更高的許可權。</span><span class="sxs-lookup"><span data-stu-id="309de-211">Requires elevated privilege.</span></span> <span data-ttu-id="309de-212">如果您的應用程式未以許可權執行，您可能需要撰寫 Windows 服務應用程式，如上面所述。</span><span class="sxs-lookup"><span data-stu-id="309de-212">If your application is not running with privilege, you may need to write a Windows Service Application as noted above.</span></span>

-   <span data-ttu-id="309de-213">不支援 SMB 磁片區。</span><span class="sxs-lookup"><span data-stu-id="309de-213">Does not support SMB volumes.</span></span> <span data-ttu-id="309de-214">您也可能需要撰寫 Windows 服務應用程式，以支援在這些磁片區上進行實體磁區大小的查詢。</span><span class="sxs-lookup"><span data-stu-id="309de-214">You may also need to write a Windows Service Application to support physical sector size querying on these volumes.</span></span>

-   <span data-ttu-id="309de-215">無法發行至任何檔案控制代碼 (必須將 IOCTL 發出至磁片區控制碼) 。</span><span class="sxs-lookup"><span data-stu-id="309de-215">Cannot be issued to any file handle (the IOCTL must be issued to a Volume Handle).</span></span>

-   <span data-ttu-id="309de-216">只有本文開頭所列的 Windows 版本才支援。</span><span class="sxs-lookup"><span data-stu-id="309de-216">Supported only in Windows versions listed near the beginning of this article.</span></span>

<span data-ttu-id="309de-217">**認可記錄會填補至512個位元組的磁區**</span><span class="sxs-lookup"><span data-stu-id="309de-217">**Commit records are padded to 512-byte sectors**</span></span>

<span data-ttu-id="309de-218">具有資料存放區的應用程式通常會有某種形式的認可記錄，其中會維護中繼資料變更的相關資訊，或維護資料存放區的結構。</span><span class="sxs-lookup"><span data-stu-id="309de-218">Applications with a data store typically have some form of commit record that either maintains information about metadata changes or maintains the structure of the data store.</span></span> <span data-ttu-id="309de-219">為了確保遺失磁區不會影響多筆記錄，此認可記錄通常會填補至磁區大小。</span><span class="sxs-lookup"><span data-stu-id="309de-219">In order to ensure that the loss of a sector does not affect multiple records, this commit record is typically padded out to a sector size.</span></span> <span data-ttu-id="309de-220">使用具有較大實體磁區大小的磁片時，應用程式將需要查詢實體磁區大小（如上一節所示），並確保每個認可記錄都會填補至該大小。</span><span class="sxs-lookup"><span data-stu-id="309de-220">With a disk with a larger physical sector size, the application will need to query for the physical sector size as shown in the prior section, and ensure each commit record is padded to that size.</span></span> <span data-ttu-id="309de-221">這並不只會避免讀取-修改-寫入迴圈，它有助於確保在遺失實體磁區的情況下，只有一個認可記錄會遺失。</span><span class="sxs-lookup"><span data-stu-id="309de-221">Not only does this avoid the Read-Modify-Write cycle, it helps ensure that in case a physical sector was lost, only one Commit Record would be lost.</span></span>

<span data-ttu-id="309de-222">**記錄檔會以未對齊的區塊寫入**</span><span class="sxs-lookup"><span data-stu-id="309de-222">**Log files are written to in unaligned chunks**</span></span>

<span data-ttu-id="309de-223">當更新或附加至記錄檔時，通常會使用未緩衝的 i/o。</span><span class="sxs-lookup"><span data-stu-id="309de-223">Unbuffered I/O is typically used when updating or appending to a log file.</span></span> <span data-ttu-id="309de-224">有幾種方式可協助確保這些更新已正確對齊：</span><span class="sxs-lookup"><span data-stu-id="309de-224">There are several ways to help ensure these updates are correctly aligned:</span></span>

-   <span data-ttu-id="309de-225">在內部將記錄更新緩衝至作業媒體的回報實體磁區大小，並只在實體磁區單位已滿時發出記錄檔寫入</span><span class="sxs-lookup"><span data-stu-id="309de-225">Internally buffer log updates to the reported physical sector size of the operating media, and issue log writes only when a physical sector unit is full</span></span>
-   <span data-ttu-id="309de-226">使用緩衝 i/o</span><span class="sxs-lookup"><span data-stu-id="309de-226">Use buffered I/O</span></span>

### <a name="issue-3-file-formats-relying-on-512-byte-sectors"></a><span data-ttu-id="309de-227">問題3：依賴512位元組磁區的檔案格式</span><span class="sxs-lookup"><span data-stu-id="309de-227">Issue 3: File Formats relying on 512-byte Sectors</span></span>

<span data-ttu-id="309de-228">有些具有標準檔案格式 (例如 VHD 1.0) 的應用程式可能會以硬式編碼的方式，來採用512位元組的磁區大小。</span><span class="sxs-lookup"><span data-stu-id="309de-228">Some applications with standard file formats (such as VHD 1.0) may have these files hard-coded to assume a 512-byte sector size.</span></span> <span data-ttu-id="309de-229">因此，對此檔案所做的更新和寫入會導致裝置上的讀取-修改-寫入迴圈，這可能會導致客戶的效能和復原問題。</span><span class="sxs-lookup"><span data-stu-id="309de-229">Thus, updates and writes to this file would result in a Read-Modify-Write cycle on the device– which will potentially result in performance and resiliency concerns for your customers.</span></span> <span data-ttu-id="309de-230">不過，有一些方法可讓應用程式支援在這種類型的媒體上操作，例如：</span><span class="sxs-lookup"><span data-stu-id="309de-230">However, there are ways for an application to provide support for operating on this type of media, for example:</span></span>

-   <span data-ttu-id="309de-231">使用緩衝來確保寫入是以實體磁區大小的單位來執行</span><span class="sxs-lookup"><span data-stu-id="309de-231">Use buffering to ensure that writes are performed in units of the physical sector size</span></span>
-   <span data-ttu-id="309de-232">執行內部讀寫寫入，以協助確保以所報告的實體磁區大小單位來執行更新</span><span class="sxs-lookup"><span data-stu-id="309de-232">Implement an internal Read-Modify-Write that can help ensure that updates are performed in units of the reported physical sector size</span></span>
-   <span data-ttu-id="309de-233">可能的話，請將記錄填補至實體磁區，以將填補視為空白空間</span><span class="sxs-lookup"><span data-stu-id="309de-233">If possible, pad records out to a physical sector, in such a way that the padding would be interpreted as empty space</span></span>
-   <span data-ttu-id="309de-234">請考慮重新設計新版本的應用程式資料結構，並支援較大的磁區</span><span class="sxs-lookup"><span data-stu-id="309de-234">Consider redesigning a new version of the application data structure with support for larger sectors</span></span>

### <a name="issue-4-the-reported-physical-sector-size-can-change-between-sessions"></a><span data-ttu-id="309de-235">問題4：回報的實體磁區大小可能會在會話之間變更</span><span class="sxs-lookup"><span data-stu-id="309de-235">Issue 4: The reported Physical Sector size can change between sessions</span></span>

<span data-ttu-id="309de-236">在許多案例中，裝載 Datastor 的基礎儲存體所報告的實體磁區大小可能會變更。</span><span class="sxs-lookup"><span data-stu-id="309de-236">There are many scenarios where the reported physical sector size of the underlying storage that hosts the Datastor may change.</span></span> <span data-ttu-id="309de-237">最常見的情況是將 Datastor 遷移到另一個磁片區，或甚至是在網路上。</span><span class="sxs-lookup"><span data-stu-id="309de-237">The most common of these is when you migrate the Datastor to another volume, or even across the network.</span></span> <span data-ttu-id="309de-238">針對許多應用程式，報告的實體磁區大小變更可能是未預期的事件，而且可能會導致某些應用程式甚至無法重新初始化。</span><span class="sxs-lookup"><span data-stu-id="309de-238">A change in the reported physical sector size may be an unexpected event for many applications and can potentially result in some applications even failing to re-initialize.</span></span>

<span data-ttu-id="309de-239">這不是最簡單的支援案例，在此將其視為諮詢。</span><span class="sxs-lookup"><span data-stu-id="309de-239">This is not the easiest scenario to support, and is mentioned here as an advisory.</span></span> <span data-ttu-id="309de-240">您應考慮客戶的行動性需求，並據此調整您的支援，以協助確保客戶不會受到使用512e 媒體的負面影響。</span><span class="sxs-lookup"><span data-stu-id="309de-240">You should consider the mobility requirements of your customers and adjust your support accordingly to help ensure customers are not negatively impacted by using 512e media.</span></span>

## <a name="4-kb-native-media"></a><span data-ttu-id="309de-241">4 KB 原生媒體</span><span class="sxs-lookup"><span data-stu-id="309de-241">4 KB Native Media</span></span>

<span data-ttu-id="309de-242">512位元組模擬媒體的目的是要在512位元組原生和 4 KB 原生媒體之間進行轉換，而且我們預期會在512e 可供使用後立即發行 4 KB 的原生媒體。</span><span class="sxs-lookup"><span data-stu-id="309de-242">512-byte emulation media is meant as a transitional step between 512-byte native and 4 KB-native media, and we expect to see 4 KB-native media released soon after 512e is available.</span></span> <span data-ttu-id="309de-243">此媒體有幾個重要的含意應注意：</span><span class="sxs-lookup"><span data-stu-id="309de-243">There are several important implications with this media which should be noted:</span></span>

-   <span data-ttu-id="309de-244">邏輯和實體磁區大小都是 4 KB</span><span class="sxs-lookup"><span data-stu-id="309de-244">The logical and physical sector sizes are both 4 KB</span></span>
-   <span data-ttu-id="309de-245">因為沒有模擬層，所以儲存體將會失敗未對齊的寫入</span><span class="sxs-lookup"><span data-stu-id="309de-245">Because there is no emulation layer, unaligned writes will be failed by the storage</span></span>
-   <span data-ttu-id="309de-246">沒有隱藏的恢復功能-應用程式可以運作或無法運作</span><span class="sxs-lookup"><span data-stu-id="309de-246">No hidden resiliency hit – applications either work or they don’t work</span></span>

<span data-ttu-id="309de-247">雖然 Microsoft 目前正在調查未來版本的 Windows 中支援這些類型的媒體，但在適當的情況下，應用程式開發人員應考慮事先提供這些類型媒體的支援。</span><span class="sxs-lookup"><span data-stu-id="309de-247">Although Microsoft is currently investigating support for these types of media in a future version of Windows and will issue a KB article when appropriate, application developers should consider preemptively providing support for these types of media.</span></span>

## <a name="closing"></a><span data-ttu-id="309de-248">關閉</span><span class="sxs-lookup"><span data-stu-id="309de-248">Closing</span></span>

<span data-ttu-id="309de-249">在本文中，我們討論了大型磁區媒體在許多常見部署案例中引進的影響。</span><span class="sxs-lookup"><span data-stu-id="309de-249">In this article we have discussed the affects that large sector media introduces with many common deployment scenarios.</span></span> <span data-ttu-id="309de-250">我們已經看過讀寫寫入的效能和復原效應、此媒體可引進的一些有趣案例，以及它們可能會造成的問題組合（最終會影響使用者）。</span><span class="sxs-lookup"><span data-stu-id="309de-250">We have seen the performance and resiliency impact of Read-Modify-Write, some of the interesting scenarios that this media can introduce, and the set of issues they can potentially cause with software, which ultimately affects the end-user.</span></span> <span data-ttu-id="309de-251">儲存產業正在以較大的磁區大小快速轉換至媒體，而且很快的客戶將無法購買具有傳統512位元組磁區大小的磁片。</span><span class="sxs-lookup"><span data-stu-id="309de-251">The storage industry is rapidly transitioning to media with larger sector sizes, and very soon customers will not be able to purchase disks with traditional 512-byte sector sizes.</span></span>

<span data-ttu-id="309de-252">這是一份即時檔，旨在協助開發人員協助您瞭解這項轉換。</span><span class="sxs-lookup"><span data-stu-id="309de-252">This is a living document, and is meant as an aid for developers to help understand this transition.</span></span> <span data-ttu-id="309de-253">您應該與您的個別組織開始交談，讓客戶、IT 專業人員和您的硬體廠商討論大型磁區的轉換，以及它如何影響對您很重要的案例。</span><span class="sxs-lookup"><span data-stu-id="309de-253">You should start a conversation with your respective organizations, with customers, IT Pros, and your hardware vendors to talk about the large sector transition and how it affects the scenarios that are important to you.</span></span>

## <a name="links-to-other-resources"></a><span data-ttu-id="309de-254">其他資源的連結</span><span class="sxs-lookup"><span data-stu-id="309de-254">Links to Other Resources</span></span>

-   <span data-ttu-id="309de-255">**Windows 一般支援聲明**： <https://support.microsoft.com/kb/2510009></span><span class="sxs-lookup"><span data-stu-id="309de-255">**Windows General Support Statement**: <https://support.microsoft.com/kb/2510009></span></span>
-   <span data-ttu-id="309de-256">**適用于 windows 7 和 Windows Server 2008 R2 的修正程式**： <https://support.microsoft.com/kb/982018></span><span class="sxs-lookup"><span data-stu-id="309de-256">**Hotfix for Windows 7 and Windows Server 2008 R2**: <https://support.microsoft.com/kb/982018></span></span>
-   <span data-ttu-id="309de-257">**Windows Vista 和 Windows Server 2008 的修正程式**： <https://support.microsoft.com/kb/2470478></span><span class="sxs-lookup"><span data-stu-id="309de-257">**Hotfix for Windows Vista and Windows Server 2008**: <https://support.microsoft.com/kb/2470478></span></span>
-   <span data-ttu-id="309de-258">**HyperV 支援聲明**： <https://support.microsoft.com/kb/2515143></span><span class="sxs-lookup"><span data-stu-id="309de-258">**HyperV Support Statement**: <https://support.microsoft.com/kb/2515143></span></span>
-   <span data-ttu-id="309de-259">**關於 IOCTL \_ 的一般資訊儲存體 \_ 查詢 \_ 屬性控制項程式碼**： [https://msdn.microsoft.com/library/ff560590.aspx](/windows-hardware/drivers/ddi/ntddstor/ni-ntddstor-ioctl_storage_query_property)</span><span class="sxs-lookup"><span data-stu-id="309de-259">**General information about the IOCTL\_STORAGE\_QUERY\_PROPERTY control code**: [https://msdn.microsoft.com/library/ff560590.aspx](/windows-hardware/drivers/ddi/ntddstor/ni-ntddstor-ioctl_storage_query_property)</span></span>
-   <span data-ttu-id="309de-260">**IOCTL \_儲存體 \_ 查詢 \_ 屬性控制項程式碼**： [https://msdn.microsoft.com/library/ff800830.aspx](/windows/win32/api/winioctl/ni-winioctl-ioctl_storage_query_property)</span><span class="sxs-lookup"><span data-stu-id="309de-260">**IOCTL\_STORAGE\_QUERY\_PROPERTY Control Code**: [https://msdn.microsoft.com/library/ff800830.aspx](/windows/win32/api/winioctl/ni-winioctl-ioctl_storage_query_property)</span></span>
-   <span data-ttu-id="309de-261">**儲存體 \_ 的一般資訊存取 \_ 對齊 \_ 描述元結構**： [https://msdn.microsoft.com/library/ff566344.aspx](/windows-hardware/drivers/ddi/ntddstor/ns-ntddstor-_storage_access_alignment_descriptor)</span><span class="sxs-lookup"><span data-stu-id="309de-261">**General information about the STORAGE\_ACCESS\_ALIGNMENT\_DESCRIPTOR structure**: [https://msdn.microsoft.com/library/ff566344.aspx](/windows-hardware/drivers/ddi/ntddstor/ns-ntddstor-_storage_access_alignment_descriptor)</span></span>
-   <span data-ttu-id="309de-262">**描述 Microsoft 軟體更新所用標準術語的描述**： <https://support.microsoft.com/kb/824684/></span><span class="sxs-lookup"><span data-stu-id="309de-262">**Description of the standard terminology used to describe Microsoft software updates**: <https://support.microsoft.com/kb/824684/></span></span>
-   <span data-ttu-id="309de-263">**WDK 範例程式碼**，其中包含如何在呼叫 **IOCTL \_ 儲存體 \_ 查詢 \_ 屬性** 控制項程式碼時，從 **儲存體 \_ 存取 \_ 對齊 \_ 描述** 元結構中將回報的儲存體存取調整資訊解壓縮的詳細資訊： [/windows/desktop/api/winioctl/ns-winioctl-storage_access_alignment_descriptor](/windows/desktop/api/winioctl/ns-winioctl-storage_access_alignment_descriptor)</span><span class="sxs-lookup"><span data-stu-id="309de-263">**WDK sample code** with details for how to extract the reported storage access alignment information from the **STORAGE\_ACCESS\_ALIGNMENT\_DESCRIPTOR** structure when making a call to the **IOCTL\_STORAGE\_QUERY\_PROPERTY** control code: [/windows/desktop/api/winioctl/ns-winioctl-storage_access_alignment_descriptor](/windows/desktop/api/winioctl/ns-winioctl-storage_access_alignment_descriptor)</span></span>
-   <span data-ttu-id="309de-264">**有關 ImageX Command-Line 選項的一般資訊**： <https://technet.microsoft.com/library/dd799302(WS.10).aspx></span><span class="sxs-lookup"><span data-stu-id="309de-264">**General information about ImageX Command-Line Options**: <https://technet.microsoft.com/library/dd799302(WS.10).aspx></span></span>
-   <span data-ttu-id="309de-265">**支援 4 KB 磁區磁片磁碟機的 Intel 晶片組驅動程式需求**： <https://www.intel.com/support/chipsets/imsm/sb/CS-031502.htm></span><span class="sxs-lookup"><span data-stu-id="309de-265">**Intel Chipset driver requirements to support 4 KB Sector Drives**: <https://www.intel.com/support/chipsets/imsm/sb/CS-031502.htm></span></span>
-   <span data-ttu-id="309de-266">如需有關 Advanced Format 磁片的詳細資訊，請造訪下列 IDEMA 網站：</span><span class="sxs-lookup"><span data-stu-id="309de-266">For more information on Advanced Format Disks, visit the following IDEMA websites:</span></span>
    -   <http://idema.org/?page_id=2172>
    -   <http://idema.org/?download=7926>

 

 
