---
description: 提供者物件會為負責儲存管理的程式進行模型處理。
ms.assetid: 131e927d-d32a-44f6-8aae-28839cfa9e7d
title: 提供者物件
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: fb36517f0091776b9429911212610134f31077a2
ms.sourcegitcommit: 37f276b5d887a3aad04b1ba86e390dea9d87e591
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 02/04/2021
ms.locfileid: "104571660"
---
# <a name="provider-object"></a><span data-ttu-id="9735d-103">提供者物件</span><span class="sxs-lookup"><span data-stu-id="9735d-103">Provider Object</span></span>

<span data-ttu-id="9735d-104">\[從 Windows 8 和 Windows Server 2012 開始， [虛擬磁碟服務](virtual-disk-service-portal.md) COM 介面會被 [Windows 儲存體管理 API](/previous-versions/windows/desktop/stormgmt/windows-storage-management-api-portal)取代。\]</span><span class="sxs-lookup"><span data-stu-id="9735d-104">\[Beginning with Windows 8 and Windows Server 2012, the [Virtual Disk Service](virtual-disk-service-portal.md) COM interface is superseded by the [Windows Storage Management API](/previous-versions/windows/desktop/stormgmt/windows-storage-management-api-portal).\]</span></span>

<span data-ttu-id="9735d-105">提供者物件會為負責儲存管理的程式進行模型處理。</span><span class="sxs-lookup"><span data-stu-id="9735d-105">The provider object models the program that is responsible for storage management.</span></span> <span data-ttu-id="9735d-106">此物件可讓您存取軟體提供者和硬體提供者功能。</span><span class="sxs-lookup"><span data-stu-id="9735d-106">This object provides access to both software provider and hardware provider functionality.</span></span> <span data-ttu-id="9735d-107">提供者程式會在軟體裝置上執行作業 (磁片區和磁片) 和硬體裝置 (儲存子系統和 RAID 控制器) 後方的磁片磁碟機陣列。</span><span class="sxs-lookup"><span data-stu-id="9735d-107">Provider programs execute operations on software devices (volumes and disks) and hardware devices (storage subsystems and arrays of drives behind RAID controllers).</span></span>

<span data-ttu-id="9735d-108">VDS 會將提供者物件註冊為 Windows 登錄中的 COM 物件，並使用包含的介面 (非匯總) 來執行其餘的物件、包裝所有介面和方法，並有條件地新增功能。</span><span class="sxs-lookup"><span data-stu-id="9735d-108">VDS registers a provider object as a COM object in the Windows Registry and uses contained interfaces (not aggregation) to implement the remaining objects, wrapping all the interfaces and methods and conditionally adding functionality.</span></span> <span data-ttu-id="9735d-109">由提供者物件包裝的物件和介面，會根據提供者類型而有所不同。</span><span class="sxs-lookup"><span data-stu-id="9735d-109">The objects and interfaces that are wrapped by the provider object differ depending on the provider type.</span></span>

<span data-ttu-id="9735d-110">您無法直接從您的應用程式具現化提供者物件。</span><span class="sxs-lookup"><span data-stu-id="9735d-110">You cannot instantiate a provider object directly from your application.</span></span> <span data-ttu-id="9735d-111">相反地，您必須啟動 VDS、取得服務物件的指標，然後使用服務物件來查詢主機已知的提供者。</span><span class="sxs-lookup"><span data-stu-id="9735d-111">Instead, you must start up VDS, obtain a pointer to a service object, and use the service object to query for the providers known to the host.</span></span> <span data-ttu-id="9735d-112">如需有關載入 VDS 的指示，請參閱 [啟動和服務物件](startup-and-service-objects.md)。</span><span class="sxs-lookup"><span data-stu-id="9735d-112">For instructions on loading VDS, see [Startup and Service Objects](startup-and-service-objects.md).</span></span>

<span data-ttu-id="9735d-113">使用 [**IVdsService：： QueryProviders**](/windows/desktop/api/Vds/nf-vds-ivdsservice-queryproviders) 方法來列舉主機上已註冊的提供者程式。</span><span class="sxs-lookup"><span data-stu-id="9735d-113">Use the [**IVdsService::QueryProviders**](/windows/desktop/api/Vds/nf-vds-ivdsservice-queryproviders) method to enumerate the registered provider programs on a host.</span></span> <span data-ttu-id="9735d-114">方法的第一個參數可讓您僅指定軟體提供者、僅限硬體提供者，或兩者。</span><span class="sxs-lookup"><span data-stu-id="9735d-114">The first parameter of the method enables you to specify software providers only, hardware providers only, or both.</span></span> <span data-ttu-id="9735d-115">您可以使用提供者物件，對該提供者所管理的物件執行作業。</span><span class="sxs-lookup"><span data-stu-id="9735d-115">With a provider object, you can perform operations on the objects managed by that provider.</span></span> <span data-ttu-id="9735d-116">如下圖所示，您可以使用 [**IVdsSwProvider**](/windows/desktop/api/Vds/nn-vds-ivdsswprovider) 介面所公開的方法，來建立和查詢與軟體提供者相關聯的套件物件。</span><span class="sxs-lookup"><span data-stu-id="9735d-116">As the following illustration shows, you can use the methods that are exposed by the [**IVdsSwProvider**](/windows/desktop/api/Vds/nn-vds-ivdsswprovider) interface to create and query pack objects that are associated with software providers.</span></span> <span data-ttu-id="9735d-117">同樣地，您可以使用 [**IVdsHwProvider**](/windows/desktop/api/Vds/nn-vds-ivdshwprovider) 介面上的方法，與與硬體提供者相關聯的子系統物件進行互動。</span><span class="sxs-lookup"><span data-stu-id="9735d-117">Likewise, you can use the methods on the [**IVdsHwProvider**](/windows/desktop/api/Vds/nn-vds-ivdshwprovider) interface to interact with the subsystem objects that are associated with hardware providers.</span></span>

![顯示「應用程式」分支至「提供者」、「套件」或「子系統」以及「主軸」的圖表。](images/vdsproviderobject.png)

<span data-ttu-id="9735d-119">物件屬性包含持續性的 GUID 物件識別碼，表示特定提供者和第二個代表提供者版本的 GUID。</span><span class="sxs-lookup"><span data-stu-id="9735d-119">Object properties include a persistent GUID object identifier that represents a specific provider and a second GUID that represents the provider version.</span></span> <span data-ttu-id="9735d-120">請注意，VDS 物件模型中的其他物件識別碼是非持續性的。</span><span class="sxs-lookup"><span data-stu-id="9735d-120">Note that other object identifiers in the VDS object model are non-persistent.</span></span> <span data-ttu-id="9735d-121">此物件的其餘屬性包含提供者名稱、其他版本資訊、提供者類型軟體或硬體) 、各種旗標，以及只適用于軟體提供者的重建優先順序設定。</span><span class="sxs-lookup"><span data-stu-id="9735d-121">The remaining properties for this object include a provider name, additional version information, the provider type software or hardware), various flags, and a rebuild-priority setting that applies only to software providers.</span></span>

<span data-ttu-id="9735d-122">下表列出相關的介面、列舉和結構</span><span class="sxs-lookup"><span data-stu-id="9735d-122">The following table lists related interfaces, enumerations, and structures</span></span> 

| <span data-ttu-id="9735d-123">類型</span><span class="sxs-lookup"><span data-stu-id="9735d-123">Type</span></span>                                                                                         | <span data-ttu-id="9735d-124">元素</span><span class="sxs-lookup"><span data-stu-id="9735d-124">Element</span></span>                                                                                                                                                                                                                                                                                        |
|----------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="9735d-125">一律由這個物件公開的介面</span><span class="sxs-lookup"><span data-stu-id="9735d-125">Interfaces that are always exposed by this object</span></span>                                            | [<span data-ttu-id="9735d-126">**IVdsProvider**</span><span class="sxs-lookup"><span data-stu-id="9735d-126">**IVdsProvider**</span></span>](/windows/desktop/api/Vds/nn-vds-ivdsprovider)                                                                                                                                                                                                                                                           |
| <span data-ttu-id="9735d-127">一律由軟體提供者公開的介面</span><span class="sxs-lookup"><span data-stu-id="9735d-127">Interfaces that are always exposed by software providers only</span></span>                                | [<span data-ttu-id="9735d-128">**IVdsSwProvider**</span><span class="sxs-lookup"><span data-stu-id="9735d-128">**IVdsSwProvider**</span></span>](/windows/desktop/api/Vds/nn-vds-ivdsswprovider)                                                                                                                                                                                                                                                       |
| <span data-ttu-id="9735d-129">一律由硬體提供者公開的介面</span><span class="sxs-lookup"><span data-stu-id="9735d-129">Interfaces that are always exposed by hardware providers only</span></span>                                | [<span data-ttu-id="9735d-130">**IVdsHwProvider**</span><span class="sxs-lookup"><span data-stu-id="9735d-130">**IVdsHwProvider**</span></span>](/windows/desktop/api/Vds/nn-vds-ivdshwprovider)                                                                                                                                                                                                                                                       |
| <span data-ttu-id="9735d-131">此物件可能公開的介面</span><span class="sxs-lookup"><span data-stu-id="9735d-131">Interfaces that may be exposed by this object</span></span>                                                | [<span data-ttu-id="9735d-132">**IVdsProviderSupport**</span><span class="sxs-lookup"><span data-stu-id="9735d-132">**IVdsProviderSupport**</span></span>](/windows/desktop/api/Vds/nn-vds-ivdsprovidersupport)                                                                                                                                                                                                                                             |
| <span data-ttu-id="9735d-133">僅可由硬體提供者公開的介面</span><span class="sxs-lookup"><span data-stu-id="9735d-133">Interfaces that may be exposed by hardware providers only</span></span>                                    | <span data-ttu-id="9735d-134">[**IVdsHwProviderType**](/windows/desktop/api/Vds/nn-vds-ivdshwprovidertype)、 [**IVdsHwProviderStoragePools**](/windows/desktop/api/Vds/nn-vds-ivdshwproviderstoragepools)**Windows server 2008、windows Vista 和 windows Server 2003：** 不支援 [**IVdsHwProviderStoragePools**](/windows/desktop/api/Vds/nn-vds-ivdshwproviderstoragepools) 介面。</span><span class="sxs-lookup"><span data-stu-id="9735d-134">[**IVdsHwProviderType**](/windows/desktop/api/Vds/nn-vds-ivdshwprovidertype), [**IVdsHwProviderStoragePools**](/windows/desktop/api/Vds/nn-vds-ivdshwproviderstoragepools)**Windows Server 2008, Windows Vista, and Windows Server 2003:** The [**IVdsHwProviderStoragePools**](/windows/desktop/api/Vds/nn-vds-ivdshwproviderstoragepools) interface is not supported.</span></span><br/> |
| <span data-ttu-id="9735d-135">一律會執行但不會對應用程式公開的介面</span><span class="sxs-lookup"><span data-stu-id="9735d-135">Interfaces that are always implemented but not exposed to applications</span></span>                       | [<span data-ttu-id="9735d-136">**IVdsProviderPrivate**</span><span class="sxs-lookup"><span data-stu-id="9735d-136">**IVdsProviderPrivate**</span></span>](/windows/desktop/api/VdsHwPrv/nn-vdshwprv-ivdsproviderprivate)                                                                                                                                                                                                                                             |
| <span data-ttu-id="9735d-137">一律由硬體提供者執行但未公開給應用程式的介面</span><span class="sxs-lookup"><span data-stu-id="9735d-137">Interfaces that are always implemented by hardware providers but not exposed to applications</span></span> | [<span data-ttu-id="9735d-138">**IVdsHwProviderPrivate**</span><span class="sxs-lookup"><span data-stu-id="9735d-138">**IVdsHwProviderPrivate**</span></span>](/windows/desktop/api/VdsHwPrv/nn-vdshwprv-ivdshwproviderprivate)                                                                                                                                                                                                                                         |
| <span data-ttu-id="9735d-139">可能由硬體提供者執行但未公開給應用程式的介面</span><span class="sxs-lookup"><span data-stu-id="9735d-139">Interfaces that may be implemented by hardware providers but not exposed to applications</span></span>     | [<span data-ttu-id="9735d-140">**IVdsHwProviderPrivateMpio**</span><span class="sxs-lookup"><span data-stu-id="9735d-140">**IVdsHwProviderPrivateMpio**</span></span>](/windows/desktop/api/VdsHwPrv/nn-vdshwprv-ivdshwproviderprivatempio)                                                                                                                                                                                                                                 |
| <span data-ttu-id="9735d-141">相關聯的列舉</span><span class="sxs-lookup"><span data-stu-id="9735d-141">Associated enumerations</span></span>                                                                      | <span data-ttu-id="9735d-142">[**VDS \_提供者 \_ 旗**](/windows/desktop/api/Vds/ne-vds-vds_provider_flag)標、 [**vds \_ 查詢 \_ 提供者 \_ 旗**](/windows/desktop/api/Vds/ne-vds-vds_query_provider_flag)標，以及 [**vds \_ 提供者 \_ 類型**](/windows/desktop/api/Vds/ne-vds-vds_provider_type)。</span><span class="sxs-lookup"><span data-stu-id="9735d-142">[**VDS\_PROVIDER\_FLAG**](/windows/desktop/api/Vds/ne-vds-vds_provider_flag), [**VDS\_QUERY\_PROVIDER\_FLAG**](/windows/desktop/api/Vds/ne-vds-vds_query_provider_flag), and [**VDS\_PROVIDER\_TYPE**](/windows/desktop/api/Vds/ne-vds-vds_provider_type).</span></span>                                                                                                                         |
| <span data-ttu-id="9735d-143">相關聯的結構</span><span class="sxs-lookup"><span data-stu-id="9735d-143">Associated structures</span></span>                                                                        | <span data-ttu-id="9735d-144">無。</span><span class="sxs-lookup"><span data-stu-id="9735d-144">None.</span></span>                                                                                                                                                                                                                                                                                          |



 

## <a name="related-topics"></a><span data-ttu-id="9735d-145">相關主題</span><span class="sxs-lookup"><span data-stu-id="9735d-145">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="9735d-146">VDS 物件模型</span><span class="sxs-lookup"><span data-stu-id="9735d-146">VDS Object Model</span></span>](vds-object-model.md)
</dt> <dt>

[<span data-ttu-id="9735d-147">Startup 和 Service 物件</span><span class="sxs-lookup"><span data-stu-id="9735d-147">Startup and Service Objects</span></span>](startup-and-service-objects.md)
</dt> <dt>

[<span data-ttu-id="9735d-148">**IVdsService::QueryProviders**</span><span class="sxs-lookup"><span data-stu-id="9735d-148">**IVdsService::QueryProviders**</span></span>](/windows/desktop/api/Vds/nf-vds-ivdsservice-queryproviders)
</dt> <dt>

[<span data-ttu-id="9735d-149">**IVdsSwProvider**</span><span class="sxs-lookup"><span data-stu-id="9735d-149">**IVdsSwProvider**</span></span>](/windows/desktop/api/Vds/nn-vds-ivdsswprovider)
</dt> <dt>

[<span data-ttu-id="9735d-150">**IVdsHwProvider**</span><span class="sxs-lookup"><span data-stu-id="9735d-150">**IVdsHwProvider**</span></span>](/windows/desktop/api/Vds/nn-vds-ivdshwprovider)
</dt> </dl>

 

