---
description: Windows 作業系統提供的機制，可促進應用程式之間的通訊和資料共用。 這些機制所啟用的活動統稱為「處理序間通訊」 (IPC) 。
ms.assetid: ad3fb0d9-d0ab-479e-b9a6-22a463b6728c
title: 處理序間通訊
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 5ca9789da756ae5449e77237c1140386a6f5cfd9
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/08/2021
ms.locfileid: "103849526"
---
# <a name="interprocess-communications"></a>處理序間通訊

Windows 作業系統提供的機制，可促進應用程式之間的通訊和資料共用。 這些機制所啟用的活動統稱為「 *處理序間通訊* 」 (IPC) 。 某些形式的 IPC 有助於在數個特製化程式之間劃分人力。 其他形式的 IPC 有助於網路上電腦之間的人力劃分。

一般來說，應用程式可以使用以 IPC 分類的用戶端或伺服器。 *用戶端* 是從其他應用程式或進程要求服務的應用程式或進程。 *伺服器* 是回應用戶端要求的應用程式或處理常式。 許多應用程式都可作為用戶端和伺服器，視情況而定。 例如，文字處理應用程式可能會做為用戶端，以從作為伺服器的試算表應用程式要求製造成本的摘要資料表。 接著，試算表應用程式可能會做為用戶端，以從自動清查控制應用程式要求最新的清查層級。

在您決定讓應用程式受益于 IPC 之後，您必須決定要使用哪一種可用的 IPC 方法。 應用程式很可能會使用數個 IPC 機制。 這些問題的答案會決定應用程式是否可以使用一或多個 IPC 機制來獲益。

-   應用程式應該能夠與其他電腦上執行的其他應用程式通訊，還是足以讓應用程式與本機電腦上的應用程式進行通訊？
-   應用程式是否能夠與其他電腦上執行的應用程式進行通訊，這些電腦可能會在不同的作業系統 (例如16位 Windows 或 UNIX) ？
-   應用程式的使用者是否必須選擇與應用程式通訊的其他應用程式，或應用程式是否可以隱含地找到其共同合作的夥伴？
-   應用程式是否應該以一般方式與許多不同的應用程式通訊，例如允許與任何其他應用程式進行剪下和貼上作業，或其通訊需求受限於與特定其他應用程式的一組有限互動？
-   效能是否為應用程式的重要層面？ 所有 IPC 機制都包含一些額外負荷。
-   應用程式應該是 GUI 應用程式還是主控台應用程式？ 某些 IPC 機制需要 GUI 應用程式。

Windows 支援下列 IPC 機制：

-   [剪貼簿](#using-the-clipboard-for-ipc)
-   [COM](#using-com-for-ipc)
-   [資料複製](#using-data-copy-for-ipc)
-   [DDE](#using-dde-for-ipc)
-   [檔案對應](#using-a-file-mapping-for-ipc)
-   [Mailslots](#using-a-mailslot-for-ipc)
-   [管道](#using-pipes-for-ipc)
-   [RPC](#using-rpc-for-ipc)
-   [Windows Sockets](#using-windows-sockets-for-ipc)

## <a name="using-the-clipboard-for-ipc"></a>針對 IPC 使用剪貼簿

剪貼簿可作為應用程式之間共用資料的中央 depository。 當使用者在應用程式中執行剪下或複製作業時，應用程式會以一或多個標準或應用程式定義的格式，將選取的資料放在剪貼簿上。 然後，任何其他應用程式都可以從剪貼簿取出資料，並從其瞭解的可用格式中進行選擇。 剪貼簿是非常鬆散的結合 exchange 媒體，其中的應用程式只需要同意資料格式。 這些應用程式可以位於相同的電腦或網路上的不同電腦上。

**關鍵點：** 所有應用程式都應該支援剪貼簿，以瞭解這些資料格式。 例如，文字編輯器或文字處理器至少應該能夠以純文字格式產生和接受剪貼簿資料。 如需詳細資訊，請參閱 [剪貼](../dataxchg/clipboard.md)簿。

## <a name="using-com-for-ipc"></a>使用 COM 進行 IPC

使用 OLE 管理 *複合檔案* 的應用程式，也就是由各種不同應用程式的資料組成的檔。 OLE 提供的服務可讓應用程式輕鬆地在其他應用程式上呼叫以進行資料編輯。 例如，使用 OLE 的字處理器可以從試算表內嵌圖形。 使用者可選擇內嵌的圖表進行編輯，以自動從字組處理器內啟動試算表。 OLE 會負責啟動試算表，並呈現圖形來進行編輯。 當使用者結束試算表時，圖表將會在原始的字處理器檔中更新。 試算表會顯示為「字處理器」的延伸。

OLE 的基礎是 (COM) 的元件物件模型。 使用 COM 的軟體元件可以與各種不同的元件進行通訊，甚至是尚未寫入的元件。 元件會以物件和用戶端互動。 分散式 COM 擴充 COM 程式設計模型，使其可在網路上運作。

**關鍵點：** OLE 支援複合檔案，並且可讓應用程式包含內嵌或連結的資料，在選擇時，會自動啟動另一個應用程式以進行資料編輯。 這可讓使用 OLE 的任何其他應用程式擴充應用程式。 COM 物件透過一或多組相關函數（稱為 *介面*）提供物件資料的存取權。 如需詳細資訊，請參閱 COM 和 ActiveX 物件服務。

## <a name="using-data-copy-for-ipc"></a>使用 Data Copy 進行 IPC

資料複製可讓應用程式使用 [**WM \_ COPYDATA**](../dataxchg/wm-copydata.md) 訊息將資訊傳送到另一個應用程式。 這種方法需要傳送應用程式與接收應用程式之間的合作。 接收的應用程式必須知道資訊的格式，而且能夠識別寄件者。 傳送應用程式無法修改任何指標所參考的記憶體。

**關鍵點：** 您可以使用資料複製，使用 Windows 訊息快速將資訊傳送到另一個應用程式。 如需詳細資訊，請參閱 [資料複製](../dataxchg/data-copy.md)。

## <a name="using-dde-for-ipc"></a>針對 IPC 使用 DDE

DDE 是一種通訊協定，可讓應用程式以各種不同的格式交換資料。 應用程式可以使用 DDE 進行單次資料交換或進行中的交換，讓應用程式在有新資料可用時，更新另一個。

DDE 所使用的資料格式與剪貼簿所使用的資料格式相同。 您可以將 DDE 視為剪貼簿機制的延伸。 剪貼簿幾乎一律會用於使用者命令的一次性回應，例如從功能表中選擇 [貼上] 命令。 DDE 通常也是由使用者命令起始，但它通常會繼續運作，而不需要進一步的使用者互動。 您也可以為應用程式之間的特殊用途 IPC 定義自訂 DDE 資料格式，以提供更緊密結合的通訊需求。

在同一部電腦上或網路上的不同電腦上執行的應用程式之間，可能會發生 DDE 交換。

**關鍵點：** DDE 與較新技術的效率並不高。 但是，如果其他 IPC 機制不適用，或您必須與僅支援 DDE 的現有應用程式進行介面，您仍然可以使用 DDE。 如需詳細資訊，請參閱 [動態資料交換](../dataxchg/dynamic-data-exchange.md) 和 [動態資料交換管理程式庫](../dataxchg/dynamic-data-exchange-management-library.md)。

## <a name="using-a-file-mapping-for-ipc"></a>針對 IPC 使用檔案對應

檔案 *對應* 可讓進程將檔案的內容視為進程位址空間中的記憶體區塊。 此程式可以使用簡單的指標作業來檢查和修改檔案的內容。 當有兩個以上的進程存取相同的檔案對應時，每個進程都會收到其本身位址空間中記憶體的指標，以便用來讀取或修改檔案的內容。 處理常式必須使用同步處理物件（例如信號）來防止多工環境中的資料損毀。

您可以使用特殊的檔案對應案例，在進程之間提供 *命名的共用記憶體* 。 如果您在建立檔案對應物件時指定系統交換檔案，則會將檔案對應物件視為共用記憶體區塊。 其他進程可以開啟相同的檔案對應物件來存取相同的記憶體區塊。

檔案對應很有效率，而且也提供作業系統支援的安全性屬性，可協助防止未經授權的資料損毀。 檔案對應只能用在本機電腦上的進程之間;它無法在網路上使用。

**關鍵點：** 檔案對應是讓同一部電腦上的兩個或多個處理常式共用資料的有效方式，但您必須在處理常式之間提供同步處理。 如需詳細資訊，請參閱檔案 [對應](/windows/desktop/Memory/file-mapping) 和 [同步](/windows/desktop/Sync/synchronization)處理。

## <a name="using-a-mailslot-for-ipc"></a>針對 IPC 使用 Mailslot

Mailslots 可提供單向通訊。 任何建立郵筒的進程都是一 *台伺服器*。 其他進程（稱為 *郵筒用戶端*）會將訊息寫入郵件提供者，以將訊息傳送至郵件伺服器。 內送訊息一律會附加到信箱。 郵筒會儲存訊息，直到郵件伺服器已讀取郵件為止。 一個處理常式可以是信箱伺服器和郵筒用戶端，因此可以使用多個 mailslots 進行雙向通訊。

信箱用戶端可以將訊息傳送至本機電腦上的信箱、另一部電腦上的信箱，或是指定網路網域中所有電腦的所有 mailslots 都有相同的名稱。 將訊息廣播到網域上的所有 mailslots 時，不能超過400個位元組，而傳送至單一郵筒的訊息只會受限於郵筒伺服器在建立郵件提供者時所指定的訊息大小上限。

**關鍵點：** Mailslots 提供簡單的方法，讓應用程式傳送和接收簡短的訊息。 它們也提供在網路網域中的所有電腦上廣播訊息的功能。 如需詳細資訊，請參閱 [Mailslots](mailslots.md)。

## <a name="using-pipes-for-ipc"></a>使用管道進行 IPC

雙向通訊有兩種類型的管道：匿名管道和具名管道。 *匿名管道* 可讓相關進程互相傳輸資訊。 一般而言，匿名管道會用來重新導向子進程的標準輸入或輸出，讓它可以與父進程交換資料。 若要雙向交換資料 (雙工操作) ，您必須建立兩個匿名管道。 父進程會使用其寫入控制碼將資料寫入至一個管道，而子進程會使用其讀取控制碼，從該管道讀取資料。 同樣地，子進程會將資料寫入另一個管道，而父進程會從它讀取資料。 匿名管道無法在網路上使用，也無法在不相關的進程之間使用。

*具名管道* 可用來在不相關進程的進程之間以及不同電腦之間的進程之間傳輸資料。 一般而言，具名管道伺服器進程會使用已知名稱或要傳達給其用戶端的名稱，建立具名管道。 知道管道名稱的具名管道用戶端進程可以開啟它的另一端，受具名管道伺服器進程指定的存取限制所約束。 當伺服器和用戶端都連接到管道之後，就可以在管道上執行讀取和寫入作業來交換資料。

**關鍵點：** 匿名管道可提供有效的方式，將標準輸入或輸出重新導向至同一部電腦上的子處理常式。 具名管道提供簡單的程式設計介面，可在兩個進程之間傳輸資料，不論它們是位於同一部電腦或透過網路。 如需詳細資訊，請參閱 [管道](pipes.md)。

## <a name="using-rpc-for-ipc"></a>使用 RPC 進行 IPC

RPC 可讓應用程式從遠端呼叫函數。 因此，RPC 會將 IPC 與呼叫函式一樣簡單。 RPC 會在單一電腦上的進程或網路上的不同電腦之間運作。

Windows 提供的 RPC 符合 Open Software Foundation (憑證) 分散式運算環境 (DCE) 。 這表示使用 RPC 的應用程式能夠與其他支援 DCE 的作業系統所執行的應用程式進行通訊。 RPC 會自動支援資料轉換，以考慮不同的硬體架構，以及不同環境之間的位元組順序。

RPC 用戶端和伺服器會緊密結合，但仍維持高效能。 系統廣泛使用 RPC 來加速作業系統不同部分之間的用戶端/伺服器關聯性。

**關鍵點：** RPC 是一種函式層級介面，可支援自動資料轉換，以及與其他作業系統進行通訊。 您可以使用 RPC 來建立高效能、緊密結合的分散式應用程式。 如需詳細資訊，請參閱 [MICROSOFT RPC 元件](/windows/desktop/Rpc/microsoft-rpc-components)。

## <a name="using-windows-sockets-for-ipc"></a>使用 Windows 通訊端進行 IPC

Windows 通訊端是與通訊協定無關的介面。 它會利用基礎通訊協定的通訊功能。 在 Windows 通訊端2中，可以選擇性地使用通訊端控制碼作為標準檔案 i/o 函數的檔案控制代碼。

Windows 通訊端是根據 Berkeley 軟體散發 (BSD) 的通訊端第一個普及化。 使用 Windows 通訊端的應用程式可以與其他類型系統上的其他通訊端執行通訊。 不過，並非所有的傳輸服務提供者都支援所有可用的選項。

**關鍵點：** Windows 通訊端是一種通訊協定獨立介面，能夠支援目前和新興的網路功能。 如需詳細資訊，請參閱 [Windows 通訊端 2](/windows/desktop/WinSock/windows-sockets-start-page-2)。

 

 
