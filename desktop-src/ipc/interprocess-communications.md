---
description: Windows 作業系統提供的機制，可促進應用程式之間的通訊和資料共用。 這些機制所啟用的活動統稱為「處理序間通訊」 (IPC) 。
ms.assetid: ad3fb0d9-d0ab-479e-b9a6-22a463b6728c
title: 處理序間通訊
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 5ca9789da756ae5449e77237c1140386a6f5cfd9
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/08/2021
ms.locfileid: "103849526"
---
# <a name="interprocess-communications"></a><span data-ttu-id="b7c22-104">處理序間通訊</span><span class="sxs-lookup"><span data-stu-id="b7c22-104">Interprocess Communications</span></span>

<span data-ttu-id="b7c22-105">Windows 作業系統提供的機制，可促進應用程式之間的通訊和資料共用。</span><span class="sxs-lookup"><span data-stu-id="b7c22-105">The Windows operating system provides mechanisms for facilitating communications and data sharing between applications.</span></span> <span data-ttu-id="b7c22-106">這些機制所啟用的活動統稱為「 *處理序間通訊* 」 (IPC) 。</span><span class="sxs-lookup"><span data-stu-id="b7c22-106">Collectively, the activities enabled by these mechanisms are called *interprocess communications* (IPC).</span></span> <span data-ttu-id="b7c22-107">某些形式的 IPC 有助於在數個特製化程式之間劃分人力。</span><span class="sxs-lookup"><span data-stu-id="b7c22-107">Some forms of IPC facilitate the division of labor among several specialized processes.</span></span> <span data-ttu-id="b7c22-108">其他形式的 IPC 有助於網路上電腦之間的人力劃分。</span><span class="sxs-lookup"><span data-stu-id="b7c22-108">Other forms of IPC facilitate the division of labor among computers on a network.</span></span>

<span data-ttu-id="b7c22-109">一般來說，應用程式可以使用以 IPC 分類的用戶端或伺服器。</span><span class="sxs-lookup"><span data-stu-id="b7c22-109">Typically, applications can use IPC categorized as clients or servers.</span></span> <span data-ttu-id="b7c22-110">*用戶端* 是從其他應用程式或進程要求服務的應用程式或進程。</span><span class="sxs-lookup"><span data-stu-id="b7c22-110">A *client* is an application or a process that requests a service from some other application or process.</span></span> <span data-ttu-id="b7c22-111">*伺服器* 是回應用戶端要求的應用程式或處理常式。</span><span class="sxs-lookup"><span data-stu-id="b7c22-111">A *server* is an application or a process that responds to a client request.</span></span> <span data-ttu-id="b7c22-112">許多應用程式都可作為用戶端和伺服器，視情況而定。</span><span class="sxs-lookup"><span data-stu-id="b7c22-112">Many applications act as both a client and a server, depending on the situation.</span></span> <span data-ttu-id="b7c22-113">例如，文字處理應用程式可能會做為用戶端，以從作為伺服器的試算表應用程式要求製造成本的摘要資料表。</span><span class="sxs-lookup"><span data-stu-id="b7c22-113">For example, a word processing application might act as a client in requesting a summary table of manufacturing costs from a spreadsheet application acting as a server.</span></span> <span data-ttu-id="b7c22-114">接著，試算表應用程式可能會做為用戶端，以從自動清查控制應用程式要求最新的清查層級。</span><span class="sxs-lookup"><span data-stu-id="b7c22-114">The spreadsheet application, in turn, might act as a client in requesting the latest inventory levels from an automated inventory control application.</span></span>

<span data-ttu-id="b7c22-115">在您決定讓應用程式受益于 IPC 之後，您必須決定要使用哪一種可用的 IPC 方法。</span><span class="sxs-lookup"><span data-stu-id="b7c22-115">After you decide that your application would benefit from IPC, you must decide which of the available IPC methods to use.</span></span> <span data-ttu-id="b7c22-116">應用程式很可能會使用數個 IPC 機制。</span><span class="sxs-lookup"><span data-stu-id="b7c22-116">It is likely that an application will use several IPC mechanisms.</span></span> <span data-ttu-id="b7c22-117">這些問題的答案會決定應用程式是否可以使用一或多個 IPC 機制來獲益。</span><span class="sxs-lookup"><span data-stu-id="b7c22-117">The answers to these questions determine whether an application can benefit by using one or more IPC mechanisms.</span></span>

-   <span data-ttu-id="b7c22-118">應用程式應該能夠與其他電腦上執行的其他應用程式通訊，還是足以讓應用程式與本機電腦上的應用程式進行通訊？</span><span class="sxs-lookup"><span data-stu-id="b7c22-118">Should the application be able to communicate with other applications running on other computers on a network, or is it sufficient for the application to communicate only with applications on the local computer?</span></span>
-   <span data-ttu-id="b7c22-119">應用程式是否能夠與其他電腦上執行的應用程式進行通訊，這些電腦可能會在不同的作業系統 (例如16位 Windows 或 UNIX) ？</span><span class="sxs-lookup"><span data-stu-id="b7c22-119">Should the application be able to communicate with applications running on other computers that may be running under different operating systems (such as 16-bit Windows or UNIX)?</span></span>
-   <span data-ttu-id="b7c22-120">應用程式的使用者是否必須選擇與應用程式通訊的其他應用程式，或應用程式是否可以隱含地找到其共同合作的夥伴？</span><span class="sxs-lookup"><span data-stu-id="b7c22-120">Should the user of the application have to choose the other applications with which the application communicates, or can the application implicitly find its cooperating partners?</span></span>
-   <span data-ttu-id="b7c22-121">應用程式是否應該以一般方式與許多不同的應用程式通訊，例如允許與任何其他應用程式進行剪下和貼上作業，或其通訊需求受限於與特定其他應用程式的一組有限互動？</span><span class="sxs-lookup"><span data-stu-id="b7c22-121">Should the application communicate with many different applications in a general way, such as allowing cut-and-paste operations with any other application, or should its communications requirements be limited to a restricted set of interactions with specific other applications?</span></span>
-   <span data-ttu-id="b7c22-122">效能是否為應用程式的重要層面？</span><span class="sxs-lookup"><span data-stu-id="b7c22-122">Is performance a critical aspect of the application?</span></span> <span data-ttu-id="b7c22-123">所有 IPC 機制都包含一些額外負荷。</span><span class="sxs-lookup"><span data-stu-id="b7c22-123">All IPC mechanisms include some amount of overhead.</span></span>
-   <span data-ttu-id="b7c22-124">應用程式應該是 GUI 應用程式還是主控台應用程式？</span><span class="sxs-lookup"><span data-stu-id="b7c22-124">Should the application be a GUI application or a console application?</span></span> <span data-ttu-id="b7c22-125">某些 IPC 機制需要 GUI 應用程式。</span><span class="sxs-lookup"><span data-stu-id="b7c22-125">Some IPC mechanisms require a GUI application.</span></span>

<span data-ttu-id="b7c22-126">Windows 支援下列 IPC 機制：</span><span class="sxs-lookup"><span data-stu-id="b7c22-126">The following IPC mechanisms are supported by Windows:</span></span>

-   [<span data-ttu-id="b7c22-127">剪貼簿</span><span class="sxs-lookup"><span data-stu-id="b7c22-127">Clipboard</span></span>](#using-the-clipboard-for-ipc)
-   [<span data-ttu-id="b7c22-128">COM</span><span class="sxs-lookup"><span data-stu-id="b7c22-128">COM</span></span>](#using-com-for-ipc)
-   [<span data-ttu-id="b7c22-129">資料複製</span><span class="sxs-lookup"><span data-stu-id="b7c22-129">Data Copy</span></span>](#using-data-copy-for-ipc)
-   [<span data-ttu-id="b7c22-130">DDE</span><span class="sxs-lookup"><span data-stu-id="b7c22-130">DDE</span></span>](#using-dde-for-ipc)
-   [<span data-ttu-id="b7c22-131">檔案對應</span><span class="sxs-lookup"><span data-stu-id="b7c22-131">File Mapping</span></span>](#using-a-file-mapping-for-ipc)
-   [<span data-ttu-id="b7c22-132">Mailslots</span><span class="sxs-lookup"><span data-stu-id="b7c22-132">Mailslots</span></span>](#using-a-mailslot-for-ipc)
-   [<span data-ttu-id="b7c22-133">管道</span><span class="sxs-lookup"><span data-stu-id="b7c22-133">Pipes</span></span>](#using-pipes-for-ipc)
-   [<span data-ttu-id="b7c22-134">RPC</span><span class="sxs-lookup"><span data-stu-id="b7c22-134">RPC</span></span>](#using-rpc-for-ipc)
-   [<span data-ttu-id="b7c22-135">Windows Sockets</span><span class="sxs-lookup"><span data-stu-id="b7c22-135">Windows Sockets</span></span>](#using-windows-sockets-for-ipc)

## <a name="using-the-clipboard-for-ipc"></a><span data-ttu-id="b7c22-136">針對 IPC 使用剪貼簿</span><span class="sxs-lookup"><span data-stu-id="b7c22-136">Using the Clipboard for IPC</span></span>

<span data-ttu-id="b7c22-137">剪貼簿可作為應用程式之間共用資料的中央 depository。</span><span class="sxs-lookup"><span data-stu-id="b7c22-137">The clipboard acts as a central depository for data sharing among applications.</span></span> <span data-ttu-id="b7c22-138">當使用者在應用程式中執行剪下或複製作業時，應用程式會以一或多個標準或應用程式定義的格式，將選取的資料放在剪貼簿上。</span><span class="sxs-lookup"><span data-stu-id="b7c22-138">When a user performs a cut or copy operation in an application, the application puts the selected data on the clipboard in one or more standard or application-defined formats.</span></span> <span data-ttu-id="b7c22-139">然後，任何其他應用程式都可以從剪貼簿取出資料，並從其瞭解的可用格式中進行選擇。</span><span class="sxs-lookup"><span data-stu-id="b7c22-139">Any other application can then retrieve the data from the clipboard, choosing from the available formats that it understands.</span></span> <span data-ttu-id="b7c22-140">剪貼簿是非常鬆散的結合 exchange 媒體，其中的應用程式只需要同意資料格式。</span><span class="sxs-lookup"><span data-stu-id="b7c22-140">The clipboard is a very loosely coupled exchange medium, where applications need only agree on the data format.</span></span> <span data-ttu-id="b7c22-141">這些應用程式可以位於相同的電腦或網路上的不同電腦上。</span><span class="sxs-lookup"><span data-stu-id="b7c22-141">The applications can reside on the same computer or on different computers on a network.</span></span>

<span data-ttu-id="b7c22-142">**關鍵點：** 所有應用程式都應該支援剪貼簿，以瞭解這些資料格式。</span><span class="sxs-lookup"><span data-stu-id="b7c22-142">**Key Point:** All applications should support the clipboard for those data formats that they understand.</span></span> <span data-ttu-id="b7c22-143">例如，文字編輯器或文字處理器至少應該能夠以純文字格式產生和接受剪貼簿資料。</span><span class="sxs-lookup"><span data-stu-id="b7c22-143">For example, a text editor or word processor should at least be able to produce and accept clipboard data in pure text format.</span></span> <span data-ttu-id="b7c22-144">如需詳細資訊，請參閱 [剪貼](../dataxchg/clipboard.md)簿。</span><span class="sxs-lookup"><span data-stu-id="b7c22-144">For more information, see [Clipboard](../dataxchg/clipboard.md).</span></span>

## <a name="using-com-for-ipc"></a><span data-ttu-id="b7c22-145">使用 COM 進行 IPC</span><span class="sxs-lookup"><span data-stu-id="b7c22-145">Using COM for IPC</span></span>

<span data-ttu-id="b7c22-146">使用 OLE 管理 *複合檔案* 的應用程式，也就是由各種不同應用程式的資料組成的檔。</span><span class="sxs-lookup"><span data-stu-id="b7c22-146">Applications that use OLE manage *compound documents*—that is, documents made up of data from a variety of different applications.</span></span> <span data-ttu-id="b7c22-147">OLE 提供的服務可讓應用程式輕鬆地在其他應用程式上呼叫以進行資料編輯。</span><span class="sxs-lookup"><span data-stu-id="b7c22-147">OLE provides services that make it easy for applications to call on other applications for data editing.</span></span> <span data-ttu-id="b7c22-148">例如，使用 OLE 的字處理器可以從試算表內嵌圖形。</span><span class="sxs-lookup"><span data-stu-id="b7c22-148">For example, a word processor that uses OLE could embed a graph from a spreadsheet.</span></span> <span data-ttu-id="b7c22-149">使用者可選擇內嵌的圖表進行編輯，以自動從字組處理器內啟動試算表。</span><span class="sxs-lookup"><span data-stu-id="b7c22-149">The user could start the spreadsheet automatically from within the word processor by choosing the embedded chart for editing.</span></span> <span data-ttu-id="b7c22-150">OLE 會負責啟動試算表，並呈現圖形來進行編輯。</span><span class="sxs-lookup"><span data-stu-id="b7c22-150">OLE takes care of starting the spreadsheet and presenting the graph for editing.</span></span> <span data-ttu-id="b7c22-151">當使用者結束試算表時，圖表將會在原始的字處理器檔中更新。</span><span class="sxs-lookup"><span data-stu-id="b7c22-151">When the user quit the spreadsheet, the graph would be updated in the original word processor document.</span></span> <span data-ttu-id="b7c22-152">試算表會顯示為「字處理器」的延伸。</span><span class="sxs-lookup"><span data-stu-id="b7c22-152">The spreadsheet appears to be an extension of the word processor.</span></span>

<span data-ttu-id="b7c22-153">OLE 的基礎是 (COM) 的元件物件模型。</span><span class="sxs-lookup"><span data-stu-id="b7c22-153">The foundation of OLE is the Component Object Model (COM).</span></span> <span data-ttu-id="b7c22-154">使用 COM 的軟體元件可以與各種不同的元件進行通訊，甚至是尚未寫入的元件。</span><span class="sxs-lookup"><span data-stu-id="b7c22-154">A software component that uses COM can communicate with a wide variety of other components, even those that have not yet been written.</span></span> <span data-ttu-id="b7c22-155">元件會以物件和用戶端互動。</span><span class="sxs-lookup"><span data-stu-id="b7c22-155">The components interact as objects and clients.</span></span> <span data-ttu-id="b7c22-156">分散式 COM 擴充 COM 程式設計模型，使其可在網路上運作。</span><span class="sxs-lookup"><span data-stu-id="b7c22-156">Distributed COM extends the COM programming model so that it works across a network.</span></span>

<span data-ttu-id="b7c22-157">**關鍵點：** OLE 支援複合檔案，並且可讓應用程式包含內嵌或連結的資料，在選擇時，會自動啟動另一個應用程式以進行資料編輯。</span><span class="sxs-lookup"><span data-stu-id="b7c22-157">**Key Point:** OLE supports compound documents and enables an application to include embedded or linked data that, when chosen, automatically starts another application for data editing.</span></span> <span data-ttu-id="b7c22-158">這可讓使用 OLE 的任何其他應用程式擴充應用程式。</span><span class="sxs-lookup"><span data-stu-id="b7c22-158">This enables the application to be extended by any other application that uses OLE.</span></span> <span data-ttu-id="b7c22-159">COM 物件透過一或多組相關函數（稱為 *介面*）提供物件資料的存取權。</span><span class="sxs-lookup"><span data-stu-id="b7c22-159">COM objects provide access to an object's data through one or more sets of related functions, known as *interfaces*.</span></span> <span data-ttu-id="b7c22-160">如需詳細資訊，請參閱 COM 和 ActiveX 物件服務。</span><span class="sxs-lookup"><span data-stu-id="b7c22-160">For more information, see COM and ActiveX Object Services.</span></span>

## <a name="using-data-copy-for-ipc"></a><span data-ttu-id="b7c22-161">使用 Data Copy 進行 IPC</span><span class="sxs-lookup"><span data-stu-id="b7c22-161">Using Data Copy for IPC</span></span>

<span data-ttu-id="b7c22-162">資料複製可讓應用程式使用 [**WM \_ COPYDATA**](../dataxchg/wm-copydata.md) 訊息將資訊傳送到另一個應用程式。</span><span class="sxs-lookup"><span data-stu-id="b7c22-162">Data copy enables an application to send information to another application using the [**WM\_COPYDATA**](../dataxchg/wm-copydata.md) message.</span></span> <span data-ttu-id="b7c22-163">這種方法需要傳送應用程式與接收應用程式之間的合作。</span><span class="sxs-lookup"><span data-stu-id="b7c22-163">This method requires cooperation between the sending application and the receiving application.</span></span> <span data-ttu-id="b7c22-164">接收的應用程式必須知道資訊的格式，而且能夠識別寄件者。</span><span class="sxs-lookup"><span data-stu-id="b7c22-164">The receiving application must know the format of the information and be able to identify the sender.</span></span> <span data-ttu-id="b7c22-165">傳送應用程式無法修改任何指標所參考的記憶體。</span><span class="sxs-lookup"><span data-stu-id="b7c22-165">The sending application cannot modify the memory referenced by any pointers.</span></span>

<span data-ttu-id="b7c22-166">**關鍵點：** 您可以使用資料複製，使用 Windows 訊息快速將資訊傳送到另一個應用程式。</span><span class="sxs-lookup"><span data-stu-id="b7c22-166">**Key Point:** Data copy can be used to quickly send information to another application using Windows messaging.</span></span> <span data-ttu-id="b7c22-167">如需詳細資訊，請參閱 [資料複製](../dataxchg/data-copy.md)。</span><span class="sxs-lookup"><span data-stu-id="b7c22-167">For more information, see [Data Copy](../dataxchg/data-copy.md).</span></span>

## <a name="using-dde-for-ipc"></a><span data-ttu-id="b7c22-168">針對 IPC 使用 DDE</span><span class="sxs-lookup"><span data-stu-id="b7c22-168">Using DDE for IPC</span></span>

<span data-ttu-id="b7c22-169">DDE 是一種通訊協定，可讓應用程式以各種不同的格式交換資料。</span><span class="sxs-lookup"><span data-stu-id="b7c22-169">DDE is a protocol that enables applications to exchange data in a variety of formats.</span></span> <span data-ttu-id="b7c22-170">應用程式可以使用 DDE 進行單次資料交換或進行中的交換，讓應用程式在有新資料可用時，更新另一個。</span><span class="sxs-lookup"><span data-stu-id="b7c22-170">Applications can use DDE for one-time data exchanges or for ongoing exchanges in which the applications update one another as new data becomes available.</span></span>

<span data-ttu-id="b7c22-171">DDE 所使用的資料格式與剪貼簿所使用的資料格式相同。</span><span class="sxs-lookup"><span data-stu-id="b7c22-171">The data formats used by DDE are the same as those used by the clipboard.</span></span> <span data-ttu-id="b7c22-172">您可以將 DDE 視為剪貼簿機制的延伸。</span><span class="sxs-lookup"><span data-stu-id="b7c22-172">DDE can be thought of as an extension of the clipboard mechanism.</span></span> <span data-ttu-id="b7c22-173">剪貼簿幾乎一律會用於使用者命令的一次性回應，例如從功能表中選擇 [貼上] 命令。</span><span class="sxs-lookup"><span data-stu-id="b7c22-173">The clipboard is almost always used for a one-time response to a user command, such as choosing the Paste command from a menu.</span></span> <span data-ttu-id="b7c22-174">DDE 通常也是由使用者命令起始，但它通常會繼續運作，而不需要進一步的使用者互動。</span><span class="sxs-lookup"><span data-stu-id="b7c22-174">DDE is also usually initiated by a user command, but it often continues to function without further user interaction.</span></span> <span data-ttu-id="b7c22-175">您也可以為應用程式之間的特殊用途 IPC 定義自訂 DDE 資料格式，以提供更緊密結合的通訊需求。</span><span class="sxs-lookup"><span data-stu-id="b7c22-175">You can also define custom DDE data formats for special-purpose IPC between applications with more tightly coupled communications requirements.</span></span>

<span data-ttu-id="b7c22-176">在同一部電腦上或網路上的不同電腦上執行的應用程式之間，可能會發生 DDE 交換。</span><span class="sxs-lookup"><span data-stu-id="b7c22-176">DDE exchanges can occur between applications running on the same computer or on different computers on a network.</span></span>

<span data-ttu-id="b7c22-177">**關鍵點：** DDE 與較新技術的效率並不高。</span><span class="sxs-lookup"><span data-stu-id="b7c22-177">**Key Point:** DDE is not as efficient as newer technologies.</span></span> <span data-ttu-id="b7c22-178">但是，如果其他 IPC 機制不適用，或您必須與僅支援 DDE 的現有應用程式進行介面，您仍然可以使用 DDE。</span><span class="sxs-lookup"><span data-stu-id="b7c22-178">However, you can still use DDE if other IPC mechanisms are not suitable or if you must interface with an existing application that only supports DDE.</span></span> <span data-ttu-id="b7c22-179">如需詳細資訊，請參閱 [動態資料交換](../dataxchg/dynamic-data-exchange.md) 和 [動態資料交換管理程式庫](../dataxchg/dynamic-data-exchange-management-library.md)。</span><span class="sxs-lookup"><span data-stu-id="b7c22-179">For more information, see [Dynamic Data Exchange](../dataxchg/dynamic-data-exchange.md) and [Dynamic Data Exchange Management Library](../dataxchg/dynamic-data-exchange-management-library.md).</span></span>

## <a name="using-a-file-mapping-for-ipc"></a><span data-ttu-id="b7c22-180">針對 IPC 使用檔案對應</span><span class="sxs-lookup"><span data-stu-id="b7c22-180">Using a File Mapping for IPC</span></span>

<span data-ttu-id="b7c22-181">檔案 *對應* 可讓進程將檔案的內容視為進程位址空間中的記憶體區塊。</span><span class="sxs-lookup"><span data-stu-id="b7c22-181">*File mapping* enables a process to treat the contents of a file as if they were a block of memory in the process's address space.</span></span> <span data-ttu-id="b7c22-182">此程式可以使用簡單的指標作業來檢查和修改檔案的內容。</span><span class="sxs-lookup"><span data-stu-id="b7c22-182">The process can use simple pointer operations to examine and modify the contents of the file.</span></span> <span data-ttu-id="b7c22-183">當有兩個以上的進程存取相同的檔案對應時，每個進程都會收到其本身位址空間中記憶體的指標，以便用來讀取或修改檔案的內容。</span><span class="sxs-lookup"><span data-stu-id="b7c22-183">When two or more processes access the same file mapping, each process receives a pointer to memory in its own address space that it can use to read or modify the contents of the file.</span></span> <span data-ttu-id="b7c22-184">處理常式必須使用同步處理物件（例如信號）來防止多工環境中的資料損毀。</span><span class="sxs-lookup"><span data-stu-id="b7c22-184">The processes must use a synchronization object, such as a semaphore, to prevent data corruption in a multitasking environment.</span></span>

<span data-ttu-id="b7c22-185">您可以使用特殊的檔案對應案例，在進程之間提供 *命名的共用記憶體* 。</span><span class="sxs-lookup"><span data-stu-id="b7c22-185">You can use a special case of file mapping to provide *named shared memory* between processes.</span></span> <span data-ttu-id="b7c22-186">如果您在建立檔案對應物件時指定系統交換檔案，則會將檔案對應物件視為共用記憶體區塊。</span><span class="sxs-lookup"><span data-stu-id="b7c22-186">If you specify the system swapping file when creating a file-mapping object, the file-mapping object is treated as a shared memory block.</span></span> <span data-ttu-id="b7c22-187">其他進程可以開啟相同的檔案對應物件來存取相同的記憶體區塊。</span><span class="sxs-lookup"><span data-stu-id="b7c22-187">Other processes can access the same block of memory by opening the same file-mapping object.</span></span>

<span data-ttu-id="b7c22-188">檔案對應很有效率，而且也提供作業系統支援的安全性屬性，可協助防止未經授權的資料損毀。</span><span class="sxs-lookup"><span data-stu-id="b7c22-188">File mapping is quite efficient and also provides operating-system–supported security attributes that can help prevent unauthorized data corruption.</span></span> <span data-ttu-id="b7c22-189">檔案對應只能用在本機電腦上的進程之間;它無法在網路上使用。</span><span class="sxs-lookup"><span data-stu-id="b7c22-189">File mapping can be used only between processes on a local computer; it cannot be used over a network.</span></span>

<span data-ttu-id="b7c22-190">**關鍵點：** 檔案對應是讓同一部電腦上的兩個或多個處理常式共用資料的有效方式，但您必須在處理常式之間提供同步處理。</span><span class="sxs-lookup"><span data-stu-id="b7c22-190">**Key Point:** File mapping is an efficient way for two or more processes on the same computer to share data, but you must provide synchronization between the processes.</span></span> <span data-ttu-id="b7c22-191">如需詳細資訊，請參閱檔案 [對應](/windows/desktop/Memory/file-mapping) 和 [同步](/windows/desktop/Sync/synchronization)處理。</span><span class="sxs-lookup"><span data-stu-id="b7c22-191">For more information, see [File Mapping](/windows/desktop/Memory/file-mapping) and [Synchronization](/windows/desktop/Sync/synchronization).</span></span>

## <a name="using-a-mailslot-for-ipc"></a><span data-ttu-id="b7c22-192">針對 IPC 使用 Mailslot</span><span class="sxs-lookup"><span data-stu-id="b7c22-192">Using a Mailslot for IPC</span></span>

<span data-ttu-id="b7c22-193">Mailslots 可提供單向通訊。</span><span class="sxs-lookup"><span data-stu-id="b7c22-193">Mailslots provide one-way communication.</span></span> <span data-ttu-id="b7c22-194">任何建立郵筒的進程都是一 *台伺服器*。</span><span class="sxs-lookup"><span data-stu-id="b7c22-194">Any process that creates a mailslot is a *mailslot server*.</span></span> <span data-ttu-id="b7c22-195">其他進程（稱為 *郵筒用戶端*）會將訊息寫入郵件提供者，以將訊息傳送至郵件伺服器。</span><span class="sxs-lookup"><span data-stu-id="b7c22-195">Other processes, called *mailslot clients*, send messages to the mailslot server by writing a message to its mailslot.</span></span> <span data-ttu-id="b7c22-196">內送訊息一律會附加到信箱。</span><span class="sxs-lookup"><span data-stu-id="b7c22-196">Incoming messages are always appended to the mailslot.</span></span> <span data-ttu-id="b7c22-197">郵筒會儲存訊息，直到郵件伺服器已讀取郵件為止。</span><span class="sxs-lookup"><span data-stu-id="b7c22-197">The mailslot saves the messages until the mailslot server has read them.</span></span> <span data-ttu-id="b7c22-198">一個處理常式可以是信箱伺服器和郵筒用戶端，因此可以使用多個 mailslots 進行雙向通訊。</span><span class="sxs-lookup"><span data-stu-id="b7c22-198">A process can be both a mailslot server and a mailslot client, so two-way communication is possible using multiple mailslots.</span></span>

<span data-ttu-id="b7c22-199">信箱用戶端可以將訊息傳送至本機電腦上的信箱、另一部電腦上的信箱，或是指定網路網域中所有電腦的所有 mailslots 都有相同的名稱。</span><span class="sxs-lookup"><span data-stu-id="b7c22-199">A mailslot client can send a message to a mailslot on its local computer, to a mailslot on another computer, or to all mailslots with the same name on all computers in a specified network domain.</span></span> <span data-ttu-id="b7c22-200">將訊息廣播到網域上的所有 mailslots 時，不能超過400個位元組，而傳送至單一郵筒的訊息只會受限於郵筒伺服器在建立郵件提供者時所指定的訊息大小上限。</span><span class="sxs-lookup"><span data-stu-id="b7c22-200">Messages broadcast to all mailslots on a domain can be no longer than 400 bytes, whereas messages sent to a single mailslot are limited only by the maximum message size specified by the mailslot server when it created the mailslot.</span></span>

<span data-ttu-id="b7c22-201">**關鍵點：** Mailslots 提供簡單的方法，讓應用程式傳送和接收簡短的訊息。</span><span class="sxs-lookup"><span data-stu-id="b7c22-201">**Key Point:** Mailslots offer an easy way for applications to send and receive short messages.</span></span> <span data-ttu-id="b7c22-202">它們也提供在網路網域中的所有電腦上廣播訊息的功能。</span><span class="sxs-lookup"><span data-stu-id="b7c22-202">They also provide the ability to broadcast messages across all computers in a network domain.</span></span> <span data-ttu-id="b7c22-203">如需詳細資訊，請參閱 [Mailslots](mailslots.md)。</span><span class="sxs-lookup"><span data-stu-id="b7c22-203">For more information, see [Mailslots](mailslots.md).</span></span>

## <a name="using-pipes-for-ipc"></a><span data-ttu-id="b7c22-204">使用管道進行 IPC</span><span class="sxs-lookup"><span data-stu-id="b7c22-204">Using Pipes for IPC</span></span>

<span data-ttu-id="b7c22-205">雙向通訊有兩種類型的管道：匿名管道和具名管道。</span><span class="sxs-lookup"><span data-stu-id="b7c22-205">There are two types of pipes for two-way communication: anonymous pipes and named pipes.</span></span> <span data-ttu-id="b7c22-206">*匿名管道* 可讓相關進程互相傳輸資訊。</span><span class="sxs-lookup"><span data-stu-id="b7c22-206">*Anonymous pipes* enable related processes to transfer information to each other.</span></span> <span data-ttu-id="b7c22-207">一般而言，匿名管道會用來重新導向子進程的標準輸入或輸出，讓它可以與父進程交換資料。</span><span class="sxs-lookup"><span data-stu-id="b7c22-207">Typically, an anonymous pipe is used for redirecting the standard input or output of a child process so that it can exchange data with its parent process.</span></span> <span data-ttu-id="b7c22-208">若要雙向交換資料 (雙工操作) ，您必須建立兩個匿名管道。</span><span class="sxs-lookup"><span data-stu-id="b7c22-208">To exchange data in both directions (duplex operation), you must create two anonymous pipes.</span></span> <span data-ttu-id="b7c22-209">父進程會使用其寫入控制碼將資料寫入至一個管道，而子進程會使用其讀取控制碼，從該管道讀取資料。</span><span class="sxs-lookup"><span data-stu-id="b7c22-209">The parent process writes data to one pipe using its write handle, while the child process reads the data from that pipe using its read handle.</span></span> <span data-ttu-id="b7c22-210">同樣地，子進程會將資料寫入另一個管道，而父進程會從它讀取資料。</span><span class="sxs-lookup"><span data-stu-id="b7c22-210">Similarly, the child process writes data to the other pipe and the parent process reads from it.</span></span> <span data-ttu-id="b7c22-211">匿名管道無法在網路上使用，也無法在不相關的進程之間使用。</span><span class="sxs-lookup"><span data-stu-id="b7c22-211">Anonymous pipes cannot be used over a network, nor can they be used between unrelated processes.</span></span>

<span data-ttu-id="b7c22-212">*具名管道* 可用來在不相關進程的進程之間以及不同電腦之間的進程之間傳輸資料。</span><span class="sxs-lookup"><span data-stu-id="b7c22-212">*Named pipes* are used to transfer data between processes that are not related processes and between processes on different computers.</span></span> <span data-ttu-id="b7c22-213">一般而言，具名管道伺服器進程會使用已知名稱或要傳達給其用戶端的名稱，建立具名管道。</span><span class="sxs-lookup"><span data-stu-id="b7c22-213">Typically, a named-pipe server process creates a named pipe with a well-known name or a name that is to be communicated to its clients.</span></span> <span data-ttu-id="b7c22-214">知道管道名稱的具名管道用戶端進程可以開啟它的另一端，受具名管道伺服器進程指定的存取限制所約束。</span><span class="sxs-lookup"><span data-stu-id="b7c22-214">A named-pipe client process that knows the name of the pipe can open its other end, subject to access restrictions specified by named-pipe server process.</span></span> <span data-ttu-id="b7c22-215">當伺服器和用戶端都連接到管道之後，就可以在管道上執行讀取和寫入作業來交換資料。</span><span class="sxs-lookup"><span data-stu-id="b7c22-215">After both the server and client have connected to the pipe, they can exchange data by performing read and write operations on the pipe.</span></span>

<span data-ttu-id="b7c22-216">**關鍵點：** 匿名管道可提供有效的方式，將標準輸入或輸出重新導向至同一部電腦上的子處理常式。</span><span class="sxs-lookup"><span data-stu-id="b7c22-216">**Key Point:** Anonymous pipes provide an efficient way to redirect standard input or output to child processes on the same computer.</span></span> <span data-ttu-id="b7c22-217">具名管道提供簡單的程式設計介面，可在兩個進程之間傳輸資料，不論它們是位於同一部電腦或透過網路。</span><span class="sxs-lookup"><span data-stu-id="b7c22-217">Named pipes provide a simple programming interface for transferring data between two processes, whether they reside on the same computer or over a network.</span></span> <span data-ttu-id="b7c22-218">如需詳細資訊，請參閱 [管道](pipes.md)。</span><span class="sxs-lookup"><span data-stu-id="b7c22-218">For more information, see [Pipes](pipes.md).</span></span>

## <a name="using-rpc-for-ipc"></a><span data-ttu-id="b7c22-219">使用 RPC 進行 IPC</span><span class="sxs-lookup"><span data-stu-id="b7c22-219">Using RPC for IPC</span></span>

<span data-ttu-id="b7c22-220">RPC 可讓應用程式從遠端呼叫函數。</span><span class="sxs-lookup"><span data-stu-id="b7c22-220">RPC enables applications to call functions remotely.</span></span> <span data-ttu-id="b7c22-221">因此，RPC 會將 IPC 與呼叫函式一樣簡單。</span><span class="sxs-lookup"><span data-stu-id="b7c22-221">Therefore, RPC makes IPC as easy as calling a function.</span></span> <span data-ttu-id="b7c22-222">RPC 會在單一電腦上的進程或網路上的不同電腦之間運作。</span><span class="sxs-lookup"><span data-stu-id="b7c22-222">RPC operates between processes on a single computer or on different computers on a network.</span></span>

<span data-ttu-id="b7c22-223">Windows 提供的 RPC 符合 Open Software Foundation (憑證) 分散式運算環境 (DCE) 。</span><span class="sxs-lookup"><span data-stu-id="b7c22-223">The RPC provided by Windows is compliant with the Open Software Foundation (OSF) Distributed Computing Environment (DCE).</span></span> <span data-ttu-id="b7c22-224">這表示使用 RPC 的應用程式能夠與其他支援 DCE 的作業系統所執行的應用程式進行通訊。</span><span class="sxs-lookup"><span data-stu-id="b7c22-224">This means that applications that use RPC are able to communicate with applications running with other operating systems that support DCE.</span></span> <span data-ttu-id="b7c22-225">RPC 會自動支援資料轉換，以考慮不同的硬體架構，以及不同環境之間的位元組順序。</span><span class="sxs-lookup"><span data-stu-id="b7c22-225">RPC automatically supports data conversion to account for different hardware architectures and for byte-ordering between dissimilar environments.</span></span>

<span data-ttu-id="b7c22-226">RPC 用戶端和伺服器會緊密結合，但仍維持高效能。</span><span class="sxs-lookup"><span data-stu-id="b7c22-226">RPC clients and servers are tightly coupled but still maintain high performance.</span></span> <span data-ttu-id="b7c22-227">系統廣泛使用 RPC 來加速作業系統不同部分之間的用戶端/伺服器關聯性。</span><span class="sxs-lookup"><span data-stu-id="b7c22-227">The system makes extensive use of RPC to facilitate a client/server relationship between different parts of the operating system.</span></span>

<span data-ttu-id="b7c22-228">**關鍵點：** RPC 是一種函式層級介面，可支援自動資料轉換，以及與其他作業系統進行通訊。</span><span class="sxs-lookup"><span data-stu-id="b7c22-228">**Key Point:** RPC is a function-level interface, with support for automatic data conversion and for communications with other operating systems.</span></span> <span data-ttu-id="b7c22-229">您可以使用 RPC 來建立高效能、緊密結合的分散式應用程式。</span><span class="sxs-lookup"><span data-stu-id="b7c22-229">Using RPC, you can create high-performance, tightly coupled distributed applications.</span></span> <span data-ttu-id="b7c22-230">如需詳細資訊，請參閱 [MICROSOFT RPC 元件](/windows/desktop/Rpc/microsoft-rpc-components)。</span><span class="sxs-lookup"><span data-stu-id="b7c22-230">For more information, see [Microsoft RPC Components](/windows/desktop/Rpc/microsoft-rpc-components).</span></span>

## <a name="using-windows-sockets-for-ipc"></a><span data-ttu-id="b7c22-231">使用 Windows 通訊端進行 IPC</span><span class="sxs-lookup"><span data-stu-id="b7c22-231">Using Windows Sockets for IPC</span></span>

<span data-ttu-id="b7c22-232">Windows 通訊端是與通訊協定無關的介面。</span><span class="sxs-lookup"><span data-stu-id="b7c22-232">Windows Sockets is a protocol-independent interface.</span></span> <span data-ttu-id="b7c22-233">它會利用基礎通訊協定的通訊功能。</span><span class="sxs-lookup"><span data-stu-id="b7c22-233">It takes advantage of the communication capabilities of the underlying protocols.</span></span> <span data-ttu-id="b7c22-234">在 Windows 通訊端2中，可以選擇性地使用通訊端控制碼作為標準檔案 i/o 函數的檔案控制代碼。</span><span class="sxs-lookup"><span data-stu-id="b7c22-234">In Windows Sockets 2, a socket handle can optionally be used as a file handle with the standard file I/O functions.</span></span>

<span data-ttu-id="b7c22-235">Windows 通訊端是根據 Berkeley 軟體散發 (BSD) 的通訊端第一個普及化。</span><span class="sxs-lookup"><span data-stu-id="b7c22-235">Windows Sockets are based on the sockets first popularized by Berkeley Software Distribution (BSD).</span></span> <span data-ttu-id="b7c22-236">使用 Windows 通訊端的應用程式可以與其他類型系統上的其他通訊端執行通訊。</span><span class="sxs-lookup"><span data-stu-id="b7c22-236">An application that uses Windows Sockets can communicate with other socket implementation on other types of systems.</span></span> <span data-ttu-id="b7c22-237">不過，並非所有的傳輸服務提供者都支援所有可用的選項。</span><span class="sxs-lookup"><span data-stu-id="b7c22-237">However, not all transport service providers support all available options.</span></span>

<span data-ttu-id="b7c22-238">**關鍵點：** Windows 通訊端是一種通訊協定獨立介面，能夠支援目前和新興的網路功能。</span><span class="sxs-lookup"><span data-stu-id="b7c22-238">**Key Point:** Windows Sockets is a protocol-independent interface capable of supporting current and emerging networking capabilities.</span></span> <span data-ttu-id="b7c22-239">如需詳細資訊，請參閱 [Windows 通訊端 2](/windows/desktop/WinSock/windows-sockets-start-page-2)。</span><span class="sxs-lookup"><span data-stu-id="b7c22-239">For more information, see [Windows Sockets 2](/windows/desktop/WinSock/windows-sockets-start-page-2).</span></span>

 

 
