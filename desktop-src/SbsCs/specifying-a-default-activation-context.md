---
description: 指定預設啟用內容
ms.assetid: 4d9a8552-7098-458d-a592-45524871cce5
title: 指定預設啟用內容
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 32cf0225a8e4290a09f7e6524a4b3ef47f9c4c4e
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/08/2021
ms.locfileid: "103945046"
---
# <a name="specifying-a-default-activation-context"></a><span data-ttu-id="332ce-103">指定預設啟用內容</span><span class="sxs-lookup"><span data-stu-id="332ce-103">Specifying a Default Activation Context</span></span>

<span data-ttu-id="332ce-104">當您的應用程式或元件建立新的進程時，Windows 會搜尋預設的應用程式資訊清單。</span><span class="sxs-lookup"><span data-stu-id="332ce-104">When your application or component creates a new process, Windows searches for a default application manifest.</span></span> <span data-ttu-id="332ce-105">請注意，在應用程式中包含為資源的資訊清單優先于外部資訊清單。</span><span class="sxs-lookup"><span data-stu-id="332ce-105">Note that a manifest included as a resource in the application takes precedence over an external manifest.</span></span> <span data-ttu-id="332ce-106">預設啟用內容是啟用任何其他啟動內容之前的第一個啟用內容。</span><span class="sxs-lookup"><span data-stu-id="332ce-106">The default activation context is the first activation context that is active before any other activation context has been activated.</span></span> <span data-ttu-id="332ce-107">除非您啟用其他內容，否則此啟用內容一律為使用中狀態。</span><span class="sxs-lookup"><span data-stu-id="332ce-107">This activation context is always active unless you activate other contexts.</span></span> <span data-ttu-id="332ce-108">如果您在 \_ \_ 編譯應用程式或元件時定義啟用隔離感知，則像是 [**CoCreateInstance**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance)、 [**LoadLibrary**](/windows/desktop/api/libloaderapi/nf-libloaderapi-loadlibrarya)和 [**CreateWindow**](/windows/win32/api/winuser/nf-winuser-createwindowa) 的呼叫可以執行自動內容管理。</span><span class="sxs-lookup"><span data-stu-id="332ce-108">If you define ISOLATION\_AWARE\_ENABLED when you compile your application or component, calls like [**CoCreateInstance**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance), [**LoadLibrary**](/windows/desktop/api/libloaderapi/nf-libloaderapi-loadlibrarya), and [**CreateWindow**](/windows/win32/api/winuser/nf-winuser-createwindowa) can perform automatic context management.</span></span>

<span data-ttu-id="332ce-109">載入器可讓應用程式透過兩種方法來指定其預設啟用內容。</span><span class="sxs-lookup"><span data-stu-id="332ce-109">The loader allows an application to specify its default activation context by two methods.</span></span> <span data-ttu-id="332ce-110">您可以將資訊清單檔案放入可執行檔的資源中，而載入器會找到它。</span><span class="sxs-lookup"><span data-stu-id="332ce-110">You can put the manifest file in the resources of the executable and the loader will find it.</span></span> <span data-ttu-id="332ce-111">這等同于將資訊清單檔案放入可執行檔的資源資料表中。</span><span class="sxs-lookup"><span data-stu-id="332ce-111">This is the same as putting the manifest file in the executable's resource table.</span></span> <span data-ttu-id="332ce-112">您可以將資訊清單放在名為 *Myapp* 的檔案中。資訊清單在和 *myapp.exe* 相同的目錄中，而載入器會在尋找 *myapp* 時尋找它。</span><span class="sxs-lookup"><span data-stu-id="332ce-112">You can place the manifest in a file named *Myapp*.exe.Manifest in the same directory as *Myapp*.exe, and the loader finds it while looking for *Myapp*.exe.</span></span>

<span data-ttu-id="332ce-113">如果您不使用上述任何一種方法，應用程式就會從系統預設啟用內容開始，其中包含最基本的元件集。</span><span class="sxs-lookup"><span data-stu-id="332ce-113">If you use none of these methods, the application starts with the system default activation context, which contains a minimal set of assemblies.</span></span>

<span data-ttu-id="332ce-114">使用自動內容管理的較佳方式是編譯已定義隔離感知的應用程式 \_ \_ 。</span><span class="sxs-lookup"><span data-stu-id="332ce-114">A better way of using automatic context management is by compiling your application with ISOLATION\_AWARE\_ENABLED defined.</span></span> <span data-ttu-id="332ce-115">建議的方法是在編譯器的命令列上針對正在建立的整個專案進行設定，而不是在個別原始程式檔或標頭中設定此選項。</span><span class="sxs-lookup"><span data-stu-id="332ce-115">The recommended method is to set this on the compiler's command line for the entire project being built rather than being set in individual source files or headers.</span></span> <span data-ttu-id="332ce-116">這使得大部分的 Win32 Api 都知道啟用內容以及如何管理它們。</span><span class="sxs-lookup"><span data-stu-id="332ce-116">This makes most Win32 APIs aware of activation contexts and how to manage them.</span></span> <span data-ttu-id="332ce-117">不需要自行進行啟用內容管理，您只需要在資源識別碼 ISOLATIONAWARE 資訊清單資源識別碼的資源識別碼 \_ 資訊清單 \_ 資源 \_ 識別碼 (數值 2) ，其類型為 RT \_ 資訊清單 (數值24。 ) 的函式（例如， [**CreateWindow**](/windows/win32/api/winuser/nf-winuser-createwindowa)、 [**CoCreateInstance**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance)和 [**SendMessage**](/windows/win32/api/winuser/nf-winuser-sendmessage) ）則會在進行實際呼叫之前自動啟動此內容。</span><span class="sxs-lookup"><span data-stu-id="332ce-117">Instead of having to do your own activation context management, you simply need to place a manifest in your resource table at resource ID ISOLATIONAWARE\_MANIFEST\_RESOURCE\_ID (numeric value 2), of type RT\_MANIFEST (numeric value 24.) Functions such as [**CreateWindow**](/windows/win32/api/winuser/nf-winuser-createwindowa), [**CoCreateInstance**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance), and [**SendMessage**](/windows/win32/api/winuser/nf-winuser-sendmessage) then automatically activate this context before making the actual call.</span></span>

<span data-ttu-id="332ce-118">請注意，如果您 \_ 已定義啟用隔離感知的編譯 \_ ，您也不能自行進行啟用內容管理。</span><span class="sxs-lookup"><span data-stu-id="332ce-118">Note that if you compile with ISOLATION\_AWARE\_ENABLED defined, you cannot also do your own activation context management.</span></span> <span data-ttu-id="332ce-119">\_在定義隔離感知的情況 \_ 下，Windows 會忽略您的應用程式可能會嘗試在 [**ActivateActCtx**](/windows/desktop/api/Winbase/nf-winbase-activateactctx)和 [**CreateWindow**](/windows/win32/api/winuser/nf-winuser-createwindowa)呼叫之間進行的任何動態啟用內容建立。</span><span class="sxs-lookup"><span data-stu-id="332ce-119">With ISOLATION\_AWARE\_ENABLED defined, Windows ignores any dynamic activation context creation your application may attempt to do between [**ActivateActCtx**](/windows/desktop/api/Winbase/nf-winbase-activateactctx) and [**CreateWindow**](/windows/win32/api/winuser/nf-winuser-createwindowa) calls.</span></span> <span data-ttu-id="332ce-120">這表示當您的應用程式使用隔離 \_ 感知功能時， \_ 您必須確定資訊清單包含元件所需之所有元件的完整清單。</span><span class="sxs-lookup"><span data-stu-id="332ce-120">This means that when your application uses ISOLATION\_AWARE\_ENABLED you must make sure that the manifest contains a complete list of all assemblies that your component requires.</span></span>

 

 
