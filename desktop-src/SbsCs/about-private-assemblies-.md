---
description: 私用元件是與應用程式一起部署的元件，可用於該應用程式的獨佔用途。
ms.assetid: 5E0E7423-85BD-4ED0-9149-9541F4D2371F
title: 關於私用元件
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 7c7ccfe8c63a8435a33085f607c2040a0a42345c
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/07/2021
ms.locfileid: "106978952"
---
# <a name="about-private-assemblies"></a><span data-ttu-id="f85b6-103">關於私用元件</span><span class="sxs-lookup"><span data-stu-id="f85b6-103">About Private Assemblies</span></span>

<span data-ttu-id="f85b6-104">私用元件是與應用程式一起部署的元件，可用於該應用程式的獨佔用途。</span><span class="sxs-lookup"><span data-stu-id="f85b6-104">A private assembly is an assembly that is deployed with an application and is available for the exclusive use of that application.</span></span> <span data-ttu-id="f85b6-105">亦即，其他應用程式不會共用私用元件。</span><span class="sxs-lookup"><span data-stu-id="f85b6-105">That is, other applications do not share the private assembly.</span></span> <span data-ttu-id="f85b6-106">私用元件是可以用來建立 [隔離應用程式](isolated-applications.md)的其中一個方法。</span><span class="sxs-lookup"><span data-stu-id="f85b6-106">Private assemblies are one of the methods that can be used to create [isolated applications](isolated-applications.md).</span></span> <span data-ttu-id="f85b6-107">如需詳細資訊，請參閱 [關於隔離應用程式和並存元件](about-isolated-applications-and-side-by-side-assemblies.md)。</span><span class="sxs-lookup"><span data-stu-id="f85b6-107">For more information, see [About Isolated Applications and Side-by-Side Assemblies](about-isolated-applications-and-side-by-side-assemblies.md).</span></span>

<span data-ttu-id="f85b6-108">私用元件必須設計成與系統上的其他元件版本並存運作。</span><span class="sxs-lookup"><span data-stu-id="f85b6-108">Private assemblies must be designed to work side-by-side with other versions of the assembly on the system.</span></span> <span data-ttu-id="f85b6-109">如需詳細資訊，請參閱 [建立並存元件的指導方針](guidelines-for-creating-side-by-side-assemblies.md)。</span><span class="sxs-lookup"><span data-stu-id="f85b6-109">For more information, see [Guidelines for Creating Side-by-side Assemblies](guidelines-for-creating-side-by-side-assemblies.md).</span></span>

<span data-ttu-id="f85b6-110">私用元件必須伴隨著 [組件資訊清單](assembly-manifests.md)。</span><span class="sxs-lookup"><span data-stu-id="f85b6-110">Private assemblies must be accompanied by an [assembly manifest](assembly-manifests.md).</span></span> <span data-ttu-id="f85b6-111">請注意，當封裝 DLL 做為私用元件以容納 Windows 搜尋私用元件的方式時，就適用名稱限制。</span><span class="sxs-lookup"><span data-stu-id="f85b6-111">Note that name restrictions apply when packaging a DLL as a private assembly to accommodate the way in which Windows searches for private assemblies.</span></span> <span data-ttu-id="f85b6-112">搜尋私用元件時，建議的方法是在 DLL 中包含組件資訊清單做為資源。</span><span class="sxs-lookup"><span data-stu-id="f85b6-112">When searching for private assemblies, the recommended method is to include the assembly manifest in the DLL as a resource.</span></span> <span data-ttu-id="f85b6-113">在此情況下，資源識別碼必須等於1，而且私用元件的名稱可能與 DLL 的名稱相同。</span><span class="sxs-lookup"><span data-stu-id="f85b6-113">In this case, the resource ID must equal 1 and the name of the private assembly may be the same as the name of the DLL.</span></span> <span data-ttu-id="f85b6-114">例如，如果 DLL 的名稱是 MICROSOFT.WINDOWS.MYSAMPLE.DLL，資訊清單之 **assemblyIdentity** 專案中所使用的 name 屬性（attribute）值也可以是 mysample。</span><span class="sxs-lookup"><span data-stu-id="f85b6-114">For example, if the name of the DLL is MICROSOFT.WINDOWS.MYSAMPLE.DLL, the value of the name attribute used in the **assemblyIdentity** element of the manifest may also be Microsoft.Windows.mysample.</span></span> <span data-ttu-id="f85b6-115">搜尋私用元件的另一種方法是在不同的檔案中提供組件資訊清單。</span><span class="sxs-lookup"><span data-stu-id="f85b6-115">An alternate method of searching for private assemblies is to provide the assembly manifest in a separate file.</span></span> <span data-ttu-id="f85b6-116">在此情況下，元件的名稱及其資訊清單必須與 DLL 的名稱不同。</span><span class="sxs-lookup"><span data-stu-id="f85b6-116">In this case, the name of the assembly and its manifest must be different than the name of the DLL.</span></span> <span data-ttu-id="f85b6-117">例如，mysampleAsm、mysampleAsm，以及 Microsoft.Windows.mysample.dll 的範例中。</span><span class="sxs-lookup"><span data-stu-id="f85b6-117">For example, Microsoft.Windows.mysampleAsm, Microsoft.Windows.mysampleAsm.manifest, and Microsoft.Windows.mysample.dll.</span></span> <span data-ttu-id="f85b6-118">如需如何並存搜尋私用元件的詳細資訊，請參閱 [元件搜尋序列](assembly-searching-sequence.md)。</span><span class="sxs-lookup"><span data-stu-id="f85b6-118">For more information about how side-by-side searches for private assemblies see [Assembly Searching Sequence](assembly-searching-sequence.md).</span></span>

<span data-ttu-id="f85b6-119">私用元件會安裝在應用程式目錄結構的資料夾中。</span><span class="sxs-lookup"><span data-stu-id="f85b6-119">Private assemblies are installed in a folder of the application's directory structure.</span></span> <span data-ttu-id="f85b6-120">通常，這是包含應用程式可執行檔的資料夾。</span><span class="sxs-lookup"><span data-stu-id="f85b6-120">Typically, this is the folder containing the application's executable file.</span></span> <span data-ttu-id="f85b6-121">私用元件可以部署在與應用程式相同的資料夾中、與元件同名的資料夾中，或是在與元件同名的特定語言子資料夾中。</span><span class="sxs-lookup"><span data-stu-id="f85b6-121">Private assemblies may be deployed in the same folder as the application, in a folder with the same name as the assembly, or in a language specific subfolder with the same name as the assembly.</span></span> <span data-ttu-id="f85b6-122">例如，您可以使用下列其中一個目錄結構來部署私用元件，也就是未指定任何語言的工具。</span><span class="sxs-lookup"><span data-stu-id="f85b6-122">For example, use one of the following directory structures to deploy a private assembly, Microsoft.tools.pop, with no language specified.</span></span>



| <span data-ttu-id="f85b6-123">目錄結構</span><span class="sxs-lookup"><span data-stu-id="f85b6-123">Directory structure</span></span>                                       | <span data-ttu-id="f85b6-124">Description</span><span class="sxs-lookup"><span data-stu-id="f85b6-124">Description</span></span>                                                                                            |
|-----------------------------------------------------------|--------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="f85b6-125">APPDIR \\MICROSOFT.TOOLS.POP.DLL</span><span class="sxs-lookup"><span data-stu-id="f85b6-125">APPDIR\\MICROSOFT.TOOLS.POP.DLL</span></span>                           | <span data-ttu-id="f85b6-126">資訊清單會部署為 DLL 中的資源。</span><span class="sxs-lookup"><span data-stu-id="f85b6-126">The manifest is deployed as a resource in the DLL.</span></span>                                                     |
| <span data-ttu-id="f85b6-127">Appdir \\ Microsoft. 資訊清單</span><span class="sxs-lookup"><span data-stu-id="f85b6-127">Appdir\\Microsoft.Tools.Pop.MANIFEST</span></span>                      | <span data-ttu-id="f85b6-128">資訊清單會部署為個別的檔案。</span><span class="sxs-lookup"><span data-stu-id="f85b6-128">The manifest is deployed as a separate file.</span></span>                                                           |
| <span data-ttu-id="f85b6-129">APPDIR \\ MICROSOFT。工具。POP \\MICROSOFT.TOOLS.POP.DLL</span><span class="sxs-lookup"><span data-stu-id="f85b6-129">APPDIR\\MICROSOFT.TOOLS.POP\\MICROSOFT.TOOLS.POP.DLL</span></span>      | <span data-ttu-id="f85b6-130">資訊清單會部署為 DLL 中的資源，該 DLL 位於具有元件名稱的子資料夾中。</span><span class="sxs-lookup"><span data-stu-id="f85b6-130">The manifest is deployed as a resource in the DLL, which is in a subfolder having the assembly's name.</span></span> |
| <span data-ttu-id="f85b6-131">Appdir microsoft 工具。 pop \\ \\ 。</span><span class="sxs-lookup"><span data-stu-id="f85b6-131">Appdir\\Microsoft.Tools.Pop\\Microsoft.Tools.Pop.MANIFEST</span></span> | <span data-ttu-id="f85b6-132">資訊清單會在具有元件名稱的子資料夾中部署為個別的檔案。</span><span class="sxs-lookup"><span data-stu-id="f85b6-132">The manifest is deployed as a separate file in a subfolder having the assembly's name.</span></span>                 |



 

> [!IMPORTANT]
>
> <span data-ttu-id="f85b6-133">針對 Windows 7 和 Windows Server 2008 R2 之前的 Windows 作業系統版本，必須將原生私用元件部署在包含應用程式可執行檔的資料夾中。</span><span class="sxs-lookup"><span data-stu-id="f85b6-133">For versions of the Windows operating system before Windows 7 and Windows Server 2008 R2, native private assemblies must be deployed in the folder that contains the application's executable file.</span></span> <span data-ttu-id="f85b6-134">原生私用元件不支援安裝在特定語言的資料夾或與元件同名的資料夾中。</span><span class="sxs-lookup"><span data-stu-id="f85b6-134">Installation in a language specific folder or in the folder with same name as assembly is not supported for native private assemblies.</span></span>

 

<span data-ttu-id="f85b6-135">您可以使用下列其中一個目錄結構，以指定的語言部署私用元件。</span><span class="sxs-lookup"><span data-stu-id="f85b6-135">Use one of the following directory structures to deploy a private assembly, Microsoft.tools.pop, with a specified language.</span></span> <span data-ttu-id="f85b6-136">在下列範例中，Microsoft 所使用的語言是英文 (美國) ，而語言代碼則是 en-us。</span><span class="sxs-lookup"><span data-stu-id="f85b6-136">In the following example, the language used by Microsoft.Tools.Pop is English (United States) and the language code is en-us.</span></span> <span data-ttu-id="f85b6-137">您應以正確的 DHTML 語言代碼取代您的元件。</span><span class="sxs-lookup"><span data-stu-id="f85b6-137">You should substitute the correct DHTML language code for your assembly.</span></span>

``` syntax
appdir\en-us\Microsoft.tools.pop.DLL
appdir\en-us\Microsoft.tools.pop.MANIFEST
appdir\en-us\Microsoft.tools.pop\Microsoft.tools.pop.DLL
appdir\en-us\Microsoft.tools.pop\Microsoft.tools.pop.MANIFEST
```

<span data-ttu-id="f85b6-138">可以將元件的檔案複製到這個資料夾中的任何安裝方法（例如 **xcopy** 命令）來安裝私用元件。</span><span class="sxs-lookup"><span data-stu-id="f85b6-138">Private assemblies can be installed by any installation method that can copy the assembly's file into this folder, such as the **xcopy** command.</span></span> <span data-ttu-id="f85b6-139">如需有關如何使用 Windows Installer 安裝私用元件的詳細資訊，請參閱 [Win32 元件的安裝](../msi/installation-of-win32-assemblies.md)。</span><span class="sxs-lookup"><span data-stu-id="f85b6-139">For more information about how to install private assemblies using the Windows Installer, see [Installation of Win32 Assemblies](../msi/installation-of-win32-assemblies.md).</span></span>

<span data-ttu-id="f85b6-140">私用元件也可以安裝在 Windows XP 之前的作業系統上。</span><span class="sxs-lookup"><span data-stu-id="f85b6-140">Private assemblies can also be installed on operating systems earlier than Windows XP.</span></span> <span data-ttu-id="f85b6-141">在此情況下，必須在這些作業系統上註冊元件，而不會使用資訊清單。</span><span class="sxs-lookup"><span data-stu-id="f85b6-141">In this case, the assembly must be registered and on these operating systems the manifest is not used.</span></span> <span data-ttu-id="f85b6-142">私用元件的複本會安裝到私人資料夾中，以供應用程式專用使用。</span><span class="sxs-lookup"><span data-stu-id="f85b6-142">A copy of the private assembly is installed into a private folder for the exclusive use of the application.</span></span> <span data-ttu-id="f85b6-143">另一個版本的元件可以在系統上全域登錄，並且可供任何系結至該元件的應用程式使用。</span><span class="sxs-lookup"><span data-stu-id="f85b6-143">Another version of the assembly can be globally registered on the system and available to any application that binds to it.</span></span> <span data-ttu-id="f85b6-144">元件的全域版本可能是隨應用程式安裝的版本，或是較早的版本。</span><span class="sxs-lookup"><span data-stu-id="f85b6-144">The global version of the assembly may be the version installed with the application or an earlier version.</span></span> <span data-ttu-id="f85b6-145">如需詳細資訊，請參閱 [Windows 上的 DLL/COM](dll-com-redirection-on-windows.md)重新導向。</span><span class="sxs-lookup"><span data-stu-id="f85b6-145">For more information, see [DLL/COM Redirection on Windows](dll-com-redirection-on-windows.md).</span></span> <span data-ttu-id="f85b6-146">元件也可以安裝為共用元件，供多個應用程式使用。</span><span class="sxs-lookup"><span data-stu-id="f85b6-146">An assembly can also be installed as a shared assembly for use by multiple applications.</span></span> <span data-ttu-id="f85b6-147">如需詳細資訊，請參閱 [共用的元件](/windows/desktop/Msi/shared-assemblies)。</span><span class="sxs-lookup"><span data-stu-id="f85b6-147">For more information, see [Shared Assemblies](/windows/desktop/Msi/shared-assemblies).</span></span>

<span data-ttu-id="f85b6-148">請注意，建立私用元件的步驟與建立共用元件的步驟相同，但有兩個例外：</span><span class="sxs-lookup"><span data-stu-id="f85b6-148">Note that the steps for creating a private assembly are identical to those for creating a shared assembly with two exceptions:</span></span>

-   <span data-ttu-id="f85b6-149">不需要簽署私用元件，也不需要在組件資訊清單的 **assemblyIdentity** 元素中使用 **publickeyToken** 。</span><span class="sxs-lookup"><span data-stu-id="f85b6-149">A private assembly is not required to be signed, and **publickeyToken** is not required in the **assemblyIdentity** element of the assembly manifest.</span></span>
-   <span data-ttu-id="f85b6-150">您可以使用任何安裝技術，將私用元件安裝到應用程式的資料夾中。</span><span class="sxs-lookup"><span data-stu-id="f85b6-150">Private assemblies can be installed into the application's folder using any installation technology.</span></span> <span data-ttu-id="f85b6-151">私用元件不需要使用 Windows Installer 安裝。</span><span class="sxs-lookup"><span data-stu-id="f85b6-151">Private assemblies are not required to be installed using the Windows Installer.</span></span>

 

 
