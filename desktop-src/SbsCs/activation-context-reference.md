---
description: 啟用內容函式和結構會搭配並存元件使用。
ms.assetid: b53b30e0-948e-406c-9fb4-9681dc3c5670
title: 啟用內容參考
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 0d6f8225b4db8b22227edf2b779ed9e1b50da7a3
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/07/2021
ms.locfileid: "104026713"
---
# <a name="activation-context-reference"></a><span data-ttu-id="baba0-103">啟用內容參考</span><span class="sxs-lookup"><span data-stu-id="baba0-103">Activation Context Reference</span></span>

<span data-ttu-id="baba0-104">啟用內容函式和結構會搭配並存元件使用。</span><span class="sxs-lookup"><span data-stu-id="baba0-104">The activation context functions and structures are used with side-by-side assemblies.</span></span>

<span data-ttu-id="baba0-105">下表列出啟用內容函數。</span><span class="sxs-lookup"><span data-stu-id="baba0-105">The following table lists the activation context functions.</span></span>



| <span data-ttu-id="baba0-106">函式</span><span class="sxs-lookup"><span data-stu-id="baba0-106">Function</span></span>                                                   | <span data-ttu-id="baba0-107">描述</span><span class="sxs-lookup"><span data-stu-id="baba0-107">Description</span></span>                                                                                                                                             |
|------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="baba0-108">**ActivateActCtx**</span><span class="sxs-lookup"><span data-stu-id="baba0-108">**ActivateActCtx**</span></span>](/windows/desktop/api/Winbase/nf-winbase-activateactctx)                   | <span data-ttu-id="baba0-109">啟用指定的啟用內容。</span><span class="sxs-lookup"><span data-stu-id="baba0-109">Activates the specified activation context.</span></span>                                                                                                             |
| [<span data-ttu-id="baba0-110">**AddRefActCtx**</span><span class="sxs-lookup"><span data-stu-id="baba0-110">**AddRefActCtx**</span></span>](/windows/desktop/api/Winbase/nf-winbase-addrefactctx)                       | <span data-ttu-id="baba0-111">遞增指定之啟用內容的參考計數。</span><span class="sxs-lookup"><span data-stu-id="baba0-111">Increments the reference count of the specified activation context.</span></span>                                                                                     |
| [<span data-ttu-id="baba0-112">**CreateActCtx**</span><span class="sxs-lookup"><span data-stu-id="baba0-112">**CreateActCtx**</span></span>](/windows/desktop/api/Winbase/nf-winbase-createactctxa)                       | <span data-ttu-id="baba0-113">建立啟用內容。</span><span class="sxs-lookup"><span data-stu-id="baba0-113">Creates an activation context.</span></span>                                                                                                                          |
| [<span data-ttu-id="baba0-114">**DeactivateActCtx**</span><span class="sxs-lookup"><span data-stu-id="baba0-114">**DeactivateActCtx**</span></span>](/windows/desktop/api/Winbase/nf-winbase-deactivateactctx)               | <span data-ttu-id="baba0-115">停用指定的啟用內容。</span><span class="sxs-lookup"><span data-stu-id="baba0-115">Deactivates the specified activation context.</span></span>                                                                                                           |
| [<span data-ttu-id="baba0-116">**FindActCtxSectionGuid**</span><span class="sxs-lookup"><span data-stu-id="baba0-116">**FindActCtxSectionGuid**</span></span>](/windows/desktop/api/Winbase/nf-winbase-findactctxsectionguid)     | <span data-ttu-id="baba0-117">傳回 [**ACTCTX 區段中所包含 \_ \_ \_**](/windows/win32/api/winbase/ns-winbase-actctx_section_keyed_data) 的資料，此資料結構與指定的 GUID 對應。</span><span class="sxs-lookup"><span data-stu-id="baba0-117">Returns data contained in the [**ACTCTX\_SECTION\_KEYED\_DATA**](/windows/win32/api/winbase/ns-winbase-actctx_section_keyed_data) structure that corresponds to the specified GUID.</span></span>   |
| [<span data-ttu-id="baba0-118">**FindActCtxSectionString**</span><span class="sxs-lookup"><span data-stu-id="baba0-118">**FindActCtxSectionString**</span></span>](/windows/desktop/api/Winbase/nf-winbase-findactctxsectionstringa) | <span data-ttu-id="baba0-119">傳回 [**ACTCTX 區段中所包含 \_ \_ \_**](/windows/win32/api/winbase/ns-winbase-actctx_section_keyed_data) 的資料，此資料結構與指定的字串對應。</span><span class="sxs-lookup"><span data-stu-id="baba0-119">Returns data contained in the [**ACTCTX\_SECTION\_KEYED\_DATA**](/windows/win32/api/winbase/ns-winbase-actctx_section_keyed_data) structure that corresponds to the specified string.</span></span> |
| [<span data-ttu-id="baba0-120">**GetCurrentActCtx**</span><span class="sxs-lookup"><span data-stu-id="baba0-120">**GetCurrentActCtx**</span></span>](/windows/desktop/api/Winbase/nf-winbase-getcurrentactctx)               | <span data-ttu-id="baba0-121">傳回目前的啟用內容。</span><span class="sxs-lookup"><span data-stu-id="baba0-121">Returns the current activation context.</span></span>                                                                                                                 |
| <span data-ttu-id="baba0-122">[**IsolationAwareCleanup**](/previous-versions/windows/desktop/legacy/aa375204(v=vs.85))</span><span class="sxs-lookup"><span data-stu-id="baba0-122">[**IsolationAwareCleanup**](/previous-versions/windows/desktop/legacy/aa375204(v=vs.85))</span></span>     | <span data-ttu-id="baba0-123">確保在載入、卸載和重載資訊清單時，會釋放記憶體。</span><span class="sxs-lookup"><span data-stu-id="baba0-123">Ensures that memory is freed when a manifest is loaded, unloaded, and reloaded.</span></span>                                                                         |
| [<span data-ttu-id="baba0-124">**QueryActCtxW**</span><span class="sxs-lookup"><span data-stu-id="baba0-124">**QueryActCtxW**</span></span>](/windows/desktop/api/Winbase/nf-winbase-queryactctxw)                       | <span data-ttu-id="baba0-125">查詢啟用內容以取得元件或檔案的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="baba0-125">Queries the activation context for information about an assembly or file.</span></span>                                                                               |
| [<span data-ttu-id="baba0-126">**QueryActCtxSettingsW**</span><span class="sxs-lookup"><span data-stu-id="baba0-126">**QueryActCtxSettingsW**</span></span>](/windows/desktop/api/Winbase/nf-winbase-queryactctxsettingsw)       | <span data-ttu-id="baba0-127">指定要查詢之屬性的命名空間和屬性名稱。</span><span class="sxs-lookup"><span data-stu-id="baba0-127">Specifies the namespace and attribute name of the attribute that is to be queried.</span></span>                                                                      |
| [<span data-ttu-id="baba0-128">**ReleaseActCtx**</span><span class="sxs-lookup"><span data-stu-id="baba0-128">**ReleaseActCtx**</span></span>](/windows/desktop/api/Winbase/nf-winbase-releaseactctx)                     | <span data-ttu-id="baba0-129">遞減指定之啟用內容的參考計數。</span><span class="sxs-lookup"><span data-stu-id="baba0-129">Decrements the reference count of the specified activation context.</span></span>                                                                                     |
| [<span data-ttu-id="baba0-130">**ZombifyActCtx**</span><span class="sxs-lookup"><span data-stu-id="baba0-130">**ZombifyActCtx**</span></span>](/windows/desktop/api/Winbase/nf-winbase-zombifyactctx)                     | <span data-ttu-id="baba0-131">停用指定的啟用內容，但不將它解除配置。</span><span class="sxs-lookup"><span data-stu-id="baba0-131">Deactivates the specified activation context, but does not deallocate it.</span></span>                                                                               |



 

<span data-ttu-id="baba0-132">下表列出啟用內容結構。</span><span class="sxs-lookup"><span data-stu-id="baba0-132">The following table lists activation context structures.</span></span>



| <span data-ttu-id="baba0-133">結構</span><span class="sxs-lookup"><span data-stu-id="baba0-133">Structure</span></span>                                                                                                        | <span data-ttu-id="baba0-134">Description</span><span class="sxs-lookup"><span data-stu-id="baba0-134">Description</span></span>                                                                                                                                                                                                                                                                                                                                                                                  |
|------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="baba0-135">**啟用 \_ 內容 \_ 元件 \_ 詳細 \_ 資訊**</span><span class="sxs-lookup"><span data-stu-id="baba0-135">**ACTIVATION\_CONTEXT\_ASSEMBLY\_DETAILED\_INFORMATION**</span></span>](/windows/desktop/api/Winnt/ns-winnt-activation_context_assembly_detailed_information) | <span data-ttu-id="baba0-136">包含啟用內容的詳細資訊。</span><span class="sxs-lookup"><span data-stu-id="baba0-136">Contains detailed information about the activation context.</span></span>                                                                                                                                                                                                                                                                                                                                  |
| [<span data-ttu-id="baba0-137">**啟用 \_ 內容 \_ 詳細 \_ 資訊**</span><span class="sxs-lookup"><span data-stu-id="baba0-137">**ACTIVATION\_CONTEXT\_DETAILED\_INFORMATION**</span></span>](/windows/desktop/api/Winnt/ns-winnt-activation_context_detailed_information)                    | <span data-ttu-id="baba0-138">包含啟用內容中元件的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="baba0-138">Contains information about the assembly in the activation context.</span></span>                                                                                                                                                                                                                                                                                                                           |
| [<span data-ttu-id="baba0-139">**啟用 \_ 內容 \_ 查詢 \_ 索引**</span><span class="sxs-lookup"><span data-stu-id="baba0-139">**ACTIVATION\_CONTEXT\_QUERY\_INDEX**</span></span>](/windows/desktop/api/Winnt/ns-winnt-activation_context_query_index)                                      | <span data-ttu-id="baba0-140">包含啟用內容中的元件，以及元件內檔案的索引。</span><span class="sxs-lookup"><span data-stu-id="baba0-140">Contains the assembly within the activation context and the index of the file within the assembly.</span></span>                                                                                                                                                                                                                                                                                           |
| [<span data-ttu-id="baba0-141">**ACTCTX**</span><span class="sxs-lookup"><span data-stu-id="baba0-141">**ACTCTX**</span></span>](/windows/win32/api/winbase/ns-winbase-actctxa)                                                                                     | <span data-ttu-id="baba0-142">包含描述特定啟用內容的資訊。</span><span class="sxs-lookup"><span data-stu-id="baba0-142">Contains information that describes a specific activation context.</span></span>                                                                                                                                                                                                                                                                                                                           |
| [<span data-ttu-id="baba0-143">**ACTCTX \_ 區段 \_ 索引 \_ 資料**</span><span class="sxs-lookup"><span data-stu-id="baba0-143">**ACTCTX\_SECTION\_KEYED\_DATA**</span></span>](/windows/win32/api/winbase/ns-winbase-actctx_section_keyed_data)                                            | <span data-ttu-id="baba0-144">傳回啟用內容資訊以及 GUID 或32位整數標記的啟用內容區段。</span><span class="sxs-lookup"><span data-stu-id="baba0-144">Returns the activation context information along with either the GUID or 32-bit integer-tagged activation context section.</span></span>                                                                                                                                                                                                                                                                   |
| [<span data-ttu-id="baba0-145">**元件 \_ 檔 \_ 詳細 \_ 資訊**</span><span class="sxs-lookup"><span data-stu-id="baba0-145">**ASSEMBLY\_FILE\_DETAILED\_INFORMATION**</span></span>](/windows/desktop/api/Winnt/ns-winnt-assembly_file_detailed_information)                              | <span data-ttu-id="baba0-146">包含啟用內容中元件檔案的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="baba0-146">Contains information about a file of the assembly in the activation context.</span></span>                                                                                                                                                                                                                                                                                                                 |
| [<span data-ttu-id="baba0-147">**啟用 \_ 內容 \_ 執行 \_ 層級 \_ 資訊**</span><span class="sxs-lookup"><span data-stu-id="baba0-147">**ACTIVATION\_CONTEXT\_RUN\_LEVEL\_INFORMATION**</span></span>](/windows/desktop/api/Winnt/ns-winnt-activation_context_run_level_information)                 | <span data-ttu-id="baba0-148">由 [**QueryActCtxW**](/windows/desktop/api/Winbase/nf-winbase-queryactctxw) 函式使用。</span><span class="sxs-lookup"><span data-stu-id="baba0-148">Used by the [**QueryActCtxW**](/windows/desktop/api/Winbase/nf-winbase-queryactctxw) function.</span></span><br/> <span data-ttu-id="baba0-149">**Windows Server 2003 和 WINDOWS XP：** 無法使用此結構。</span><span class="sxs-lookup"><span data-stu-id="baba0-149">**Windows Server 2003 and Windows XP:** This structure is not available.</span></span><br/>                                                                                                                                                                                                                                    |
| [<span data-ttu-id="baba0-150">**相容性 \_ 內容 \_ 元素**</span><span class="sxs-lookup"><span data-stu-id="baba0-150">**COMPATIBILITY\_CONTEXT\_ELEMENT**</span></span>](/windows/desktop/api/Winnt/ns-winnt-compatibility_context_element)                                         | <span data-ttu-id="baba0-151">供 [**QueryActCtxW**](/windows/desktop/api/Winbase/nf-winbase-queryactctxw) 函式使用，作為 [**啟用 \_ 內容 \_ 相容性 \_ 資訊**](/windows/desktop/api/Winnt/ns-winnt-activation_context_compatibility_information) 結構的一部分。</span><span class="sxs-lookup"><span data-stu-id="baba0-151">Used by the [**QueryActCtxW**](/windows/desktop/api/Winbase/nf-winbase-queryactctxw) function as part of the [**ACTIVATION\_CONTEXT\_COMPATIBILITY\_INFORMATION**](/windows/desktop/api/Winnt/ns-winnt-activation_context_compatibility_information) structure.</span></span> <br/> <span data-ttu-id="baba0-152">**Windows Server 2008 及更早版本，以及 Windows Vista 及更早版本：** 無法使用此結構。</span><span class="sxs-lookup"><span data-stu-id="baba0-152">**Windows Server 2008 and earlier, and Windows Vista and earlier:** This structure is not available.</span></span> <span data-ttu-id="baba0-153">從 Windows Server 2008 R2 和 Windows 7 開始也有提供。</span><span class="sxs-lookup"><span data-stu-id="baba0-153">It is available beginning with Windows Server 2008 R2 and Windows 7.</span></span><br/> |
| [<span data-ttu-id="baba0-154">**啟用 \_ 內容 \_ 相容性 \_ 資訊**</span><span class="sxs-lookup"><span data-stu-id="baba0-154">**ACTIVATION\_CONTEXT\_COMPATIBILITY\_INFORMATION**</span></span>](/windows/desktop/api/Winnt/ns-winnt-activation_context_compatibility_information)          | <span data-ttu-id="baba0-155">由 [**QueryActCtxW**](/windows/desktop/api/Winbase/nf-winbase-queryactctxw) 函式使用。</span><span class="sxs-lookup"><span data-stu-id="baba0-155">Used by the [**QueryActCtxW**](/windows/desktop/api/Winbase/nf-winbase-queryactctxw) function.</span></span><br/> <span data-ttu-id="baba0-156">**Windows Server 2008 及更早版本，以及 Windows Vista 及更早版本：** 無法使用此結構。</span><span class="sxs-lookup"><span data-stu-id="baba0-156">**Windows Server 2008 and earlier, and Windows Vista and earlier:** This structure is not available.</span></span> <span data-ttu-id="baba0-157">從 Windows Server 2008 R2 和 Windows 7 開始也有提供。</span><span class="sxs-lookup"><span data-stu-id="baba0-157">It is available beginning with Windows Server 2008 R2 and Windows 7.</span></span><br/>                                                                                                                                   |



 

<span data-ttu-id="baba0-158">下表列出啟用內容列舉。</span><span class="sxs-lookup"><span data-stu-id="baba0-158">The following table lists activation context enumerations.</span></span>

| <span data-ttu-id="baba0-159">列舉型別</span><span class="sxs-lookup"><span data-stu-id="baba0-159">Enumeration</span></span>                                                                       | <span data-ttu-id="baba0-160">描述</span><span class="sxs-lookup"><span data-stu-id="baba0-160">Description</span></span>                                                                                                                                                                                                                                            |
|-----------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="baba0-161">**ACTCTX \_ 要求的 \_ 執行 \_ 層級**</span><span class="sxs-lookup"><span data-stu-id="baba0-161">**ACTCTX\_REQUESTED\_RUN\_LEVEL**</span></span>](/windows/desktop/api/Winnt/ne-winnt-actctx_requested_run_level)               | <span data-ttu-id="baba0-162">描述啟用內容所要求的執行層級。**Windows Server 2003 和 WINDOWS XP：** 無法使用這個列舉。</span><span class="sxs-lookup"><span data-stu-id="baba0-162">Describes the requested run level of the activation context.**Windows Server 2003 and Windows XP:** This enumeration is not available.</span></span><br/>                                                                                                      |
| [<span data-ttu-id="baba0-163">**ACTCTX \_ 相容性 \_ 元素 \_ 類型**</span><span class="sxs-lookup"><span data-stu-id="baba0-163">**ACTCTX\_COMPATIBILITY\_ELEMENT\_TYPE**</span></span>](/windows/desktop/api/Winnt/ne-winnt-actctx_compatibility_element_type) | <span data-ttu-id="baba0-164">描述應用程式資訊清單中的相容性元素。**Windows Server 2008 及更早版本，以及 Windows Vista 及更早版本：** 無法使用這個列舉。</span><span class="sxs-lookup"><span data-stu-id="baba0-164">Describes the compatibility element in the application manifest.**Windows Server 2008 and earlier, and Windows Vista and earlier:** This enumeration is not available.</span></span> <span data-ttu-id="baba0-165">從 Windows Server 2008 R2 和 Windows 7 開始也有提供。</span><span class="sxs-lookup"><span data-stu-id="baba0-165">It is available beginning with Windows Server 2008 R2 and Windows 7.</span></span><br/> |



 

 

