---
title: 通用對話方塊程式庫
description: 本節討論通用對話方塊程式庫。 通用對話方塊程式庫包含一組用來執行一般工作的對話方塊，例如開啟檔案和列印檔案。
ms.assetid: 28573019-f0bd-4a8e-a1a1-48559f658a81
keywords:
- 通用對話方塊程式庫
- 通用對話方塊
- 預先定義的對話方塊
- 對話方塊、通用對話方塊程式庫
- 開啟對話方塊
- '[另存新檔] 對話方塊'
- 尋找對話方塊
- 取代對話方塊
- 列印對話方塊
- '[列印設定] 對話方塊'
- '[列印屬性工作表] 對話方塊'
- 版面設定對話方塊
- '[色彩] 對話方塊'
- 字型對話方塊
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 984b5ff5bb89c27cb78cf87007dde74bfba6ae73
ms.sourcegitcommit: 56f8e4d5119e5018363fa2dc3472cdff203c6913
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 11/19/2020
ms.locfileid: "104316944"
---
# <a name="common-dialog-box-library"></a><span data-ttu-id="93c4c-118">通用對話方塊程式庫</span><span class="sxs-lookup"><span data-stu-id="93c4c-118">Common Dialog Box Library</span></span>

<span data-ttu-id="93c4c-119">通用對話方塊程式庫包含一組用來執行一般應用程式工作的對話方塊，例如開啟檔案、選擇色彩值，以及列印檔案。</span><span class="sxs-lookup"><span data-stu-id="93c4c-119">The Common Dialog Box Library contains a set of dialog boxes for performing common application tasks, such as opening files, choosing color values, and printing documents.</span></span> <span data-ttu-id="93c4c-120">一般對話方塊可讓您對應用程式的使用者介面執行一致的方法。</span><span class="sxs-lookup"><span data-stu-id="93c4c-120">The common dialog boxes allow you to implement a consistent approach to your application's user interface.</span></span> <span data-ttu-id="93c4c-121">這可減少使用者針對您的應用程式學慣用戶介面行為所花費的工作量。</span><span class="sxs-lookup"><span data-stu-id="93c4c-121">This reduces the amount of effort that users spend in learning user interface behavior for your application.</span></span>

<span data-ttu-id="93c4c-122">本章節描述包含 [ **開啟** ] 和 [ **另存** 新檔] 對話方塊的通用對話方塊;[ **尋找** 和 **取代** 編輯] 對話方塊; **列印**、 **列印設定**、 **列印屬性工作表** 和版面 **設定** 列印對話方塊;和 [ **色彩** ] 和 [ **字型** ] 對話方塊。</span><span class="sxs-lookup"><span data-stu-id="93c4c-122">This section describes the common dialog boxes which include the **Open** and **Save As** file dialog boxes; the **Find** and **Replace** editing dialog boxes; the **Print**, **Print Setup**, **Print Property Sheet**, and **Page Setup** printing dialog boxes; and the **Color** and **Font** dialog boxes.</span></span>

> [!Note]  
> <span data-ttu-id="93c4c-123">從 Windows Vista 開始，[[一般專案] 對話方塊](/previous-versions/windows/desktop/legacy/bb776913(v=vs.85))已取代 [**開啟**] 和 [**另存** 新檔] 對話方塊。</span><span class="sxs-lookup"><span data-stu-id="93c4c-123">Starting with Windows Vista, the **Open** and **Save As** common dialog boxes have been superseded by the [Common Item Dialog](/previous-versions/windows/desktop/legacy/bb776913(v=vs.85)).</span></span> <span data-ttu-id="93c4c-124">我們建議您從通用對話方塊程式庫使用通用專案對話方塊 API，而不是這些對話方塊。</span><span class="sxs-lookup"><span data-stu-id="93c4c-124">We recommended that you use the Common Item Dialog API instead of these dialog boxes from the Common Dialog Box Library.</span></span>

 

### <a name="in-this-section"></a><span data-ttu-id="93c4c-125">本節內容</span><span class="sxs-lookup"><span data-stu-id="93c4c-125">In This Section</span></span>



| <span data-ttu-id="93c4c-126">Name</span><span class="sxs-lookup"><span data-stu-id="93c4c-126">Name</span></span>                                                                                 | <span data-ttu-id="93c4c-127">描述</span><span class="sxs-lookup"><span data-stu-id="93c4c-127">Description</span></span>                                                                                           |
|--------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="93c4c-128">一般對話方塊類型</span><span class="sxs-lookup"><span data-stu-id="93c4c-128">Common Dialog Box Types</span></span>](dialog-box-types.md)                                      | <span data-ttu-id="93c4c-129">討論不同的對話方塊。</span><span class="sxs-lookup"><span data-stu-id="93c4c-129">Discusses the different dialog boxes.</span></span><br/>                                                      |
| [<span data-ttu-id="93c4c-130">通用對話方塊初始化旗標</span><span class="sxs-lookup"><span data-stu-id="93c4c-130">Common Dialog Box Initialization Flags</span></span>](common-dialog-box-initialization-flags.md) | <span data-ttu-id="93c4c-131">討論如何使用旗標來修改通用對話方塊的行為和外觀。</span><span class="sxs-lookup"><span data-stu-id="93c4c-131">Discusses how flags are used to modify the behavior and appearance of a common dialog box.</span></span><br/> |
| [<span data-ttu-id="93c4c-132">自訂通用對話方塊</span><span class="sxs-lookup"><span data-stu-id="93c4c-132">Customizing Common Dialog Boxes</span></span>](customizing-common-dialog-boxes.md)               | <span data-ttu-id="93c4c-133">討論如何使用通用對話方塊。</span><span class="sxs-lookup"><span data-stu-id="93c4c-133">Discusses how to use common dialog boxes.</span></span><br/>                                                  |
| [<span data-ttu-id="93c4c-134">使用通用對話方塊</span><span class="sxs-lookup"><span data-stu-id="93c4c-134">Using Common Dialog Boxes</span></span>](using-common-dialog-boxes.md)                           | <span data-ttu-id="93c4c-135">涵蓋叫用通用對話方塊的工作。</span><span class="sxs-lookup"><span data-stu-id="93c4c-135">Covers tasks that invoke common dialog boxes.</span></span><br/>                                              |
| [<span data-ttu-id="93c4c-136">通用對話方塊參考</span><span class="sxs-lookup"><span data-stu-id="93c4c-136">Common Dialog Box Reference</span></span>](common-dialog-box-reference.md)                       | <span data-ttu-id="93c4c-137">包含 API 參考。</span><span class="sxs-lookup"><span data-stu-id="93c4c-137">Contains the API reference.</span></span><br/>                                                                |



 

### <a name="functions"></a><span data-ttu-id="93c4c-138">函式</span><span class="sxs-lookup"><span data-stu-id="93c4c-138">Functions</span></span>



| <span data-ttu-id="93c4c-139">Name</span><span class="sxs-lookup"><span data-stu-id="93c4c-139">Name</span></span>                                                 | <span data-ttu-id="93c4c-140">描述</span><span class="sxs-lookup"><span data-stu-id="93c4c-140">Description</span></span>                                                                                                                                                                                                                                                                                                                                                               |
|------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="93c4c-141">*CCHookProc*</span><span class="sxs-lookup"><span data-stu-id="93c4c-141">*CCHookProc*</span></span>](/windows/win32/api/commdlg/nc-commdlg-lpcchookproc)                       | <span data-ttu-id="93c4c-142">接收適用于 [ **色彩** ] 對話方塊之預設對話方塊程式的訊息或通知。</span><span class="sxs-lookup"><span data-stu-id="93c4c-142">Receives messages or notifications intended for the default dialog box procedure of the **Color** dialog box.</span></span> <span data-ttu-id="93c4c-143">這是應用程式定義的或程式庫定義的回呼函式，可搭配 [**ChooseColor**](/previous-versions/windows/desktop/legacy/ms646912(v=vs.85)) 函式使用。</span><span class="sxs-lookup"><span data-stu-id="93c4c-143">This is an application-defined or library-defined callback function that is used with the [**ChooseColor**](/previous-versions/windows/desktop/legacy/ms646912(v=vs.85)) function.</span></span><br/>                                                                                                           |
| [<span data-ttu-id="93c4c-144">*CFHookProc*</span><span class="sxs-lookup"><span data-stu-id="93c4c-144">*CFHookProc*</span></span>](/windows/win32/api/commdlg/nc-commdlg-lpcfhookproc)                       | <span data-ttu-id="93c4c-145">接收適用于 [ **字型** ] 對話方塊之預設對話方塊程式的訊息或通知。</span><span class="sxs-lookup"><span data-stu-id="93c4c-145">Receives messages or notifications intended for the default dialog box procedure of the **Font** dialog box.</span></span> <span data-ttu-id="93c4c-146">這是應用程式定義的或程式庫定義的回呼程式，可搭配 [**ChooseFont**](/windows/win32/api/commdlg/ns-commdlg-choosefonta) 函式使用。</span><span class="sxs-lookup"><span data-stu-id="93c4c-146">This is an application-defined or library-defined callback procedure that is used with the [**ChooseFont**](/windows/win32/api/commdlg/ns-commdlg-choosefonta) function.</span></span><br/>                                                                                                             |
| <span data-ttu-id="93c4c-147">[**ChooseColor**](/previous-versions/windows/desktop/legacy/ms646912(v=vs.85))</span><span class="sxs-lookup"><span data-stu-id="93c4c-147">[**ChooseColor**](/previous-versions/windows/desktop/legacy/ms646912(v=vs.85))</span></span>                   | <span data-ttu-id="93c4c-148">建立可讓使用者選取色彩的 [ **色彩** ] 對話方塊。</span><span class="sxs-lookup"><span data-stu-id="93c4c-148">Creates a **Color** dialog box that enables the user to select a color.</span></span><br/>                                                                                                                                                                                                                                                                                        |
| [<span data-ttu-id="93c4c-149">**ChooseFont**</span><span class="sxs-lookup"><span data-stu-id="93c4c-149">**ChooseFont**</span></span>](/windows/win32/api/commdlg/ns-commdlg-choosefonta)                     | <span data-ttu-id="93c4c-150">建立可讓使用者選擇邏輯字型屬性的 [ **字型** ] 對話方塊。</span><span class="sxs-lookup"><span data-stu-id="93c4c-150">Creates a **Font** dialog box that enables the user to choose attributes for a logical font.</span></span> <span data-ttu-id="93c4c-151">這些屬性包括字型系列和相關聯的字型樣式、點大小、效果 (底線、刪除線和文字色彩) ，以及腳本 (或字元集) 。</span><span class="sxs-lookup"><span data-stu-id="93c4c-151">These attributes include a font family and associated font style, a point size, effects (underline, strikeout, and text color), and a script (or character set).</span></span><br/>                                                                                                  |
| [<span data-ttu-id="93c4c-152">**CommDlgExtendedError**</span><span class="sxs-lookup"><span data-stu-id="93c4c-152">**CommDlgExtendedError**</span></span>](/windows/desktop/api/Commdlg/nf-commdlg-commdlgextendederror) | <span data-ttu-id="93c4c-153">傳回通用對話方塊錯誤碼。</span><span class="sxs-lookup"><span data-stu-id="93c4c-153">Returns a common dialog box error code.</span></span> <span data-ttu-id="93c4c-154">此程式碼表示執行其中一個常見對話方塊函式時，最新的錯誤。</span><span class="sxs-lookup"><span data-stu-id="93c4c-154">This code indicates the most recent error to occur during the execution of one of the common dialog box functions.</span></span><br/>                                                                                                                                                                                                     |
| [<span data-ttu-id="93c4c-155">**FindText**</span><span class="sxs-lookup"><span data-stu-id="93c4c-155">**FindText**</span></span>](/windows/desktop/api/Commdlg/nf-commdlg-findtexta)                         | <span data-ttu-id="93c4c-156">建立系統定義的無模式 [ **尋找** ] 對話方塊，可讓使用者指定要搜尋的字串，以及搜尋檔中的文字時要使用的選項。</span><span class="sxs-lookup"><span data-stu-id="93c4c-156">Creates a system-defined modeless **Find** dialog box that lets the user specify a string to search for and options to use when searching for text in a document.</span></span><br/>                                                                                                                                                                                              |
| [<span data-ttu-id="93c4c-157">*FRHookProc*</span><span class="sxs-lookup"><span data-stu-id="93c4c-157">*FRHookProc*</span></span>](/windows/win32/api/commdlg/nc-commdlg-lpfrhookproc)                       | <span data-ttu-id="93c4c-158">接收訊息或通知，其適用于 [ **尋找** 或 **取代** ] 對話方塊的預設對話方塊程式。</span><span class="sxs-lookup"><span data-stu-id="93c4c-158">Receives messages or notifications intended for the default dialog box procedure of the **Find** or **Replace** dialog box.</span></span> <span data-ttu-id="93c4c-159">這是應用程式定義的或程式庫定義的回呼函式，可搭配 [**FindText**](/windows/desktop/api/Commdlg/nf-commdlg-findtexta) 或 [**replacer.replacetext**](/windows/desktop/api/Commdlg/nf-commdlg-replacetexta) 函數使用。</span><span class="sxs-lookup"><span data-stu-id="93c4c-159">This is an application-defined or library-defined callback function that is used with the [**FindText**](/windows/desktop/api/Commdlg/nf-commdlg-findtexta) or [**ReplaceText**](/windows/desktop/api/Commdlg/nf-commdlg-replacetexta) function.</span></span><br/>                                                             |
| [<span data-ttu-id="93c4c-160">**GetFileTitle**</span><span class="sxs-lookup"><span data-stu-id="93c4c-160">**GetFileTitle**</span></span>](/windows/desktop/api/Commdlg/nf-commdlg-getfiletitlea)                 | <span data-ttu-id="93c4c-161">抓取指定檔案的名稱。</span><span class="sxs-lookup"><span data-stu-id="93c4c-161">Retrieves the name of the specified file.</span></span><br/>                                                                                                                                                                                                                                                                                                                      |
| [<span data-ttu-id="93c4c-162">**GetOpenFileName**</span><span class="sxs-lookup"><span data-stu-id="93c4c-162">**GetOpenFileName**</span></span>](/windows/desktop/api/Commdlg/nf-commdlg-getopenfilenamea)           | <span data-ttu-id="93c4c-163">建立 [ **開啟** ] 對話方塊，讓使用者指定要開啟之檔案或檔案集合的磁片磁碟機、目錄和名稱。</span><span class="sxs-lookup"><span data-stu-id="93c4c-163">Creates an **Open** dialog box that lets the user specify the drive, directory, and the name of a file or set of files to open.</span></span><br/>                                                                                                                                                                                                                                |
| [<span data-ttu-id="93c4c-164">**GetSaveFileName**</span><span class="sxs-lookup"><span data-stu-id="93c4c-164">**GetSaveFileName**</span></span>](/windows/desktop/api/Commdlg/nf-commdlg-getsavefilenamea)           | <span data-ttu-id="93c4c-165">建立可讓使用者指定要儲存的磁片磁碟機、目錄和檔案名的 [ **儲存** ] 對話方塊。</span><span class="sxs-lookup"><span data-stu-id="93c4c-165">Creates a **Save** dialog box that lets the user specify the drive, directory, and name of a file to save.</span></span><br/>                                                                                                                                                                                                                                                     |
| [<span data-ttu-id="93c4c-166">*OFNHookProc*</span><span class="sxs-lookup"><span data-stu-id="93c4c-166">*OFNHookProc*</span></span>](/windows/win32/api/commdlg/nc-commdlg-lpofnhookproc)                     | <span data-ttu-id="93c4c-167">接收從對話方塊傳送的通知訊息。</span><span class="sxs-lookup"><span data-stu-id="93c4c-167">Receives notification messages sent from the dialog box.</span></span> <span data-ttu-id="93c4c-168">函式也會接收您藉由指定子對話方塊範本所定義的任何其他控制項的訊息。</span><span class="sxs-lookup"><span data-stu-id="93c4c-168">The function also receives messages for any additional controls that you defined by specifying a child dialog template.</span></span> <span data-ttu-id="93c4c-169">這是應用程式定義的或程式庫定義的回呼函式，可搭配 Explorer 樣式的 [ **開啟** ] 和 [ **另存** 新檔] 對話方塊使用。</span><span class="sxs-lookup"><span data-stu-id="93c4c-169">This is an application-defined or library-defined callback function that is used with the Explorer-style **Open** and **Save As** dialog boxes.</span></span><br/>                               |
| <span data-ttu-id="93c4c-170">[*OFNHookProcOldStyle*](/previous-versions/windows/desktop/legacy/ms646932(v=vs.85))</span><span class="sxs-lookup"><span data-stu-id="93c4c-170">[*OFNHookProcOldStyle*](/previous-versions/windows/desktop/legacy/ms646932(v=vs.85))</span></span>  | <span data-ttu-id="93c4c-171">接收適用于對話方塊程式的訊息或通知。</span><span class="sxs-lookup"><span data-stu-id="93c4c-171">Receives messages or notifications intended for the dialog box procedure.</span></span> <span data-ttu-id="93c4c-172">這是應用程式定義的或程式庫定義的回呼函式，可搭配 [ **開啟** ] 和 [ **另存** 新檔] 對話方塊使用。</span><span class="sxs-lookup"><span data-stu-id="93c4c-172">This is an application-defined or library-defined callback function that is used with the **Open** and **Save As** dialog boxes.</span></span><br/>                                                                                                                                                     |
| [<span data-ttu-id="93c4c-173">*PagePaintHook*</span><span class="sxs-lookup"><span data-stu-id="93c4c-173">*PagePaintHook*</span></span>](/windows/win32/api/commdlg/nc-commdlg-lppagepainthook)                 | <span data-ttu-id="93c4c-174">接收訊息，讓您在 [版面 **設定** ] 對話方塊中自訂範例頁面的繪圖。</span><span class="sxs-lookup"><span data-stu-id="93c4c-174">Receives messages that allow you to customize drawing of the sample page in the **Page Setup** dialog box.</span></span> <span data-ttu-id="93c4c-175">這是與 [**PageSetupDlg**](/previous-versions/windows/desktop/legacy/ms646937(v=vs.85)) 函數搭配使用的應用程式定義或程式庫定義的回呼函式。</span><span class="sxs-lookup"><span data-stu-id="93c4c-175">This is an application-defined or library-defined callback function used with the [**PageSetupDlg**](/previous-versions/windows/desktop/legacy/ms646937(v=vs.85)) function.</span></span><br/>                                                                                                                    |
| <span data-ttu-id="93c4c-176">[**PageSetupDlg**](/previous-versions/windows/desktop/legacy/ms646937(v=vs.85))</span><span class="sxs-lookup"><span data-stu-id="93c4c-176">[**PageSetupDlg**](/previous-versions/windows/desktop/legacy/ms646937(v=vs.85))</span></span>                 | <span data-ttu-id="93c4c-177">建立 [版面 **設定** ] 對話方塊，可讓使用者指定列印頁面的屬性。</span><span class="sxs-lookup"><span data-stu-id="93c4c-177">Creates a **Page Setup** dialog box that enables the user to specify the attributes of a printed page.</span></span> <span data-ttu-id="93c4c-178">這些屬性包括紙張大小和來源、 (縱向或橫向) 的頁面方向，以及頁面邊界的寬度。</span><span class="sxs-lookup"><span data-stu-id="93c4c-178">These attributes include the paper size and source, the page orientation (portrait or landscape), and the width of the page margins.</span></span><br/>                                                                                                                    |
| [<span data-ttu-id="93c4c-179">*PageSetupHook*</span><span class="sxs-lookup"><span data-stu-id="93c4c-179">*PageSetupHook*</span></span>](/windows/win32/api/commdlg/nc-commdlg-lppagesetuphook)                 | <span data-ttu-id="93c4c-180">接收適用于 [版面設定] 對話方塊之預設對話方塊 **程式** 的訊息或通知。</span><span class="sxs-lookup"><span data-stu-id="93c4c-180">Receives messages or notifications intended for the default dialog box procedure of the **Page Setup** dialog box.</span></span> <span data-ttu-id="93c4c-181">這是與 [**PageSetupDlg**](/previous-versions/windows/desktop/legacy/ms646937(v=vs.85))函數搭配使用的應用程式定義或程式庫定義的回呼函式。</span><span class="sxs-lookup"><span data-stu-id="93c4c-181">This is an application-defined or library-defined callback function used with the [**PageSetupDlg**](/previous-versions/windows/desktop/legacy/ms646937(v=vs.85))function.</span></span><br/>                                                                                                              |
| <span data-ttu-id="93c4c-182">[**PrintDlg**](/previous-versions/windows/desktop/legacy/ms646940(v=vs.85))</span><span class="sxs-lookup"><span data-stu-id="93c4c-182">[**PrintDlg**](/previous-versions/windows/desktop/legacy/ms646940(v=vs.85))</span></span>                         | <span data-ttu-id="93c4c-183">顯示 [[列印] 對話方塊](print-dialog-box.md)。</span><span class="sxs-lookup"><span data-stu-id="93c4c-183">Displays a[Print Dialog Box](print-dialog-box.md).</span></span> <span data-ttu-id="93c4c-184">[ **列印** ] 對話方塊可讓使用者指定特定列印工作的屬性。</span><span class="sxs-lookup"><span data-stu-id="93c4c-184">The **Print** dialog box enables the user to specify the properties of a particular print job.</span></span><br/>                                                                                                                                                                                                             |
| <span data-ttu-id="93c4c-185">[**PrintDlgEx**](/previous-versions/windows/desktop/legacy/ms646942(v=vs.85))</span><span class="sxs-lookup"><span data-stu-id="93c4c-185">[**PrintDlgEx**](/previous-versions/windows/desktop/legacy/ms646942(v=vs.85))</span></span>                     | <span data-ttu-id="93c4c-186">顯示 **列印** 屬性工作表，可讓使用者指定特定列印工作的屬性。**列印** 屬性工作表具有 **[一般** ] 頁面，其中包含與 [ **列印** ] 對話方塊類似的控制項。</span><span class="sxs-lookup"><span data-stu-id="93c4c-186">Displays a **Print** property sheet that enables the user to specify the properties of a particular print job.A **Print** property sheet has a **General** page that contains controls similar to the **Print** dialog box.</span></span> <span data-ttu-id="93c4c-187">屬性工作表也可以有其他的應用程式特定和驅動程式特定的屬性頁，以及 **一般** 頁面。</span><span class="sxs-lookup"><span data-stu-id="93c4c-187">The property sheet can also have additional application-specific and driver-specific property pages as well as the **General** page.</span></span><br/> |
| [<span data-ttu-id="93c4c-188">*PrintHookProc*</span><span class="sxs-lookup"><span data-stu-id="93c4c-188">*PrintHookProc*</span></span>](/windows/win32/api/commdlg/nc-commdlg-lpprinthookproc)                 | <span data-ttu-id="93c4c-189">接收適用于 [ **列印** ] 對話方塊之預設對話方塊程式的訊息或通知。</span><span class="sxs-lookup"><span data-stu-id="93c4c-189">Receives messages or notifications intended for the default dialog box procedure of the **Print** dialog box.</span></span> <span data-ttu-id="93c4c-190">這是應用程式定義的或程式庫定義的回呼函式，可搭配 [**PrintDlg**](/previous-versions/windows/desktop/legacy/ms646940(v=vs.85)) 函式使用。</span><span class="sxs-lookup"><span data-stu-id="93c4c-190">This is an application-defined or library-defined callback function that is used with the [**PrintDlg**](/previous-versions/windows/desktop/legacy/ms646940(v=vs.85)) function.</span></span><br/>                                                                                                                 |
| [<span data-ttu-id="93c4c-191">**Replacer.replacetext**</span><span class="sxs-lookup"><span data-stu-id="93c4c-191">**ReplaceText**</span></span>](/windows/desktop/api/Commdlg/nf-commdlg-replacetexta)                   | <span data-ttu-id="93c4c-192">建立系統定義的非強制回應對話方塊，讓使用者指定要搜尋的字串和取代字串，以及控制尋找和取代作業的選項。</span><span class="sxs-lookup"><span data-stu-id="93c4c-192">Creates a system-defined modeless dialog box that lets the user specify a string to search for and a replacement string, as well as options to control the find and replace operations.</span></span><br/>                                                                                                                                                                        |
| [<span data-ttu-id="93c4c-193">*SetupHookProc*</span><span class="sxs-lookup"><span data-stu-id="93c4c-193">*SetupHookProc*</span></span>](/windows/win32/api/commdlg/nc-commdlg-lpsetuphookproc)                 | <span data-ttu-id="93c4c-194">搭配 [**PrintDlg**](/previous-versions/windows/desktop/legacy/ms646940(v=vs.85)) 函式使用的應用程式定義或程式庫定義的回呼函數。</span><span class="sxs-lookup"><span data-stu-id="93c4c-194">An application-defined or library-defined callback function used with the [**PrintDlg**](/previous-versions/windows/desktop/legacy/ms646940(v=vs.85)) function.</span></span> <span data-ttu-id="93c4c-195">攔截程式會接收適用于 [ **列印設定** ] 對話方塊之預設對話方塊程式的訊息或通知。</span><span class="sxs-lookup"><span data-stu-id="93c4c-195">The hook procedure receives messages or notifications intended for the default dialog box procedure of the **Print Setup** dialog box.</span></span><br/>                                                                                                        |



 

### <a name="interfaces"></a><span data-ttu-id="93c4c-196">介面</span><span class="sxs-lookup"><span data-stu-id="93c4c-196">Interfaces</span></span>



| <span data-ttu-id="93c4c-197">Name</span><span class="sxs-lookup"><span data-stu-id="93c4c-197">Name</span></span>                                                 | <span data-ttu-id="93c4c-198">描述</span><span class="sxs-lookup"><span data-stu-id="93c4c-198">Description</span></span>                                                                                                                                                                                                              |
|------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="93c4c-199">**IPrintDialogCallback**</span><span class="sxs-lookup"><span data-stu-id="93c4c-199">**IPrintDialogCallback**</span></span>](/windows/win32/api/commdlg/nn-commdlg-iprintdialogcallback) | <span data-ttu-id="93c4c-200">提供可讓應用程式在顯示 [列印屬性工作表](print-property-sheet.md)時，從 [**PrintDlgEx**](/previous-versions/windows/desktop/legacy/ms646942(v=vs.85))函式接收通知和訊息的方法。</span><span class="sxs-lookup"><span data-stu-id="93c4c-200">Provides methods that enable an application to receive notifications and messages from the [**PrintDlgEx**](/previous-versions/windows/desktop/legacy/ms646942(v=vs.85)) function while the [Print Property Sheet](print-property-sheet.md) is displayed.</span></span><br/> |
| [<span data-ttu-id="93c4c-201">**IPrintDialogServices**</span><span class="sxs-lookup"><span data-stu-id="93c4c-201">**IPrintDialogServices**</span></span>](/windows/win32/api/commdlg/nn-commdlg-iprintdialogservices) | <span data-ttu-id="93c4c-202">提供的方法，可讓使用 [**PrintDlgEx**](/previous-versions/windows/desktop/legacy/ms646942(v=vs.85)) 函式的應用程式取得目前所選印表機的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="93c4c-202">Provides methods that enable an application using the [**PrintDlgEx**](/previous-versions/windows/desktop/legacy/ms646942(v=vs.85)) function to retrieve information about the currently selected printer.</span></span><br/>                                                 |



 

### <a name="messages"></a><span data-ttu-id="93c4c-203">訊息</span><span class="sxs-lookup"><span data-stu-id="93c4c-203">Messages</span></span>



| <span data-ttu-id="93c4c-204">Name</span><span class="sxs-lookup"><span data-stu-id="93c4c-204">Name</span></span>                                                           | <span data-ttu-id="93c4c-205">描述</span><span class="sxs-lookup"><span data-stu-id="93c4c-205">Description</span></span>                                                                                                                                                                                                                                                                 |
|----------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="93c4c-206">**CDM \_ GETFILEPATH**</span><span class="sxs-lookup"><span data-stu-id="93c4c-206">**CDM\_GETFILEPATH**</span></span>](cdm-getfilepath.md)                    | <span data-ttu-id="93c4c-207">在 Explorer 樣式的 [ **開啟** ] 或 [ **另存** 新檔] 對話方塊中，抓取所選取檔案的路徑和檔案名。</span><span class="sxs-lookup"><span data-stu-id="93c4c-207">Retrieves the path and file name of the selected file in an Explorer-style **Open** or **Save As** dialog box.</span></span> <span data-ttu-id="93c4c-208">您必須使用 OFN EXPLORER 旗標建立對話方塊 \_ ; 否則，訊息會失敗。</span><span class="sxs-lookup"><span data-stu-id="93c4c-208">The dialog box must have been created with the OFN\_EXPLORER flag; otherwise, the message fails.</span></span><br/>                                                  |
| [<span data-ttu-id="93c4c-209">**CDM \_ GETFOLDERIDLIST**</span><span class="sxs-lookup"><span data-stu-id="93c4c-209">**CDM\_GETFOLDERIDLIST**</span></span>](cdm-getfolderidlist.md)            | <span data-ttu-id="93c4c-210">抓取對應于目前開啟之 [Explorer 樣式 **開啟** ] 或 [ **另存** 新檔] 對話方塊之資料夾的專案識別碼清單位址。</span><span class="sxs-lookup"><span data-stu-id="93c4c-210">Retrieves the address of the item identifier list corresponding to the folder that an Explorer-style **Open** or **Save As** dialog box currently has open.</span></span> <span data-ttu-id="93c4c-211">您必須使用 **OFN \_ EXPLORER** 旗標建立對話方塊; 否則，訊息會失敗。</span><span class="sxs-lookup"><span data-stu-id="93c4c-211">The dialog box must have been created with the **OFN\_EXPLORER** flag; otherwise, the message fails.</span></span><br/> |
| [<span data-ttu-id="93c4c-212">**CDM \_ GETFOLDERPATH**</span><span class="sxs-lookup"><span data-stu-id="93c4c-212">**CDM\_GETFOLDERPATH**</span></span>](cdm-getfolderpath.md)                | <span data-ttu-id="93c4c-213">抓取 Explorer 樣式 [ **開啟** ] 或 [ **另存** 新檔] 對話方塊中目前開啟之資料夾或目錄的路徑。</span><span class="sxs-lookup"><span data-stu-id="93c4c-213">Retrieves the path of the currently open folder or directory for an Explorer-style **Open** or **Save As** dialog box.</span></span> <span data-ttu-id="93c4c-214">您必須使用 **OFN \_ EXPLORER** 旗標建立對話方塊; 否則，訊息會失敗。</span><span class="sxs-lookup"><span data-stu-id="93c4c-214">The dialog box must have been created with the **OFN\_EXPLORER** flag; otherwise, the message fails.</span></span><br/>                                      |
| [<span data-ttu-id="93c4c-215">**CDM \_ GETSPEC**</span><span class="sxs-lookup"><span data-stu-id="93c4c-215">**CDM\_GETSPEC**</span></span>](cdm-getspec.md)                            | <span data-ttu-id="93c4c-216">抓取檔案名 (不包含在 Explorer 樣式的 [ **開啟** ] 或 [ **另存** 新檔] 對話方塊中目前選取之檔案的路徑) 。</span><span class="sxs-lookup"><span data-stu-id="93c4c-216">Retrieves the file name (not including the path) of the currently selected file in an Explorer-style **Open** or **Save As** dialog box.</span></span> <span data-ttu-id="93c4c-217">您必須使用 **OFN \_ EXPLORER** 旗標建立對話方塊; 否則，訊息會失敗。</span><span class="sxs-lookup"><span data-stu-id="93c4c-217">The dialog box must have been created with the **OFN\_EXPLORER** flag; otherwise, the message fails.</span></span><br/>                    |
| [<span data-ttu-id="93c4c-218">**CDM \_ HIDECONTROL**</span><span class="sxs-lookup"><span data-stu-id="93c4c-218">**CDM\_HIDECONTROL**</span></span>](cdm-hidecontrol.md)                    | <span data-ttu-id="93c4c-219">在 Explorer 樣式的 [ **開啟** ] 或 [ **另存** 新檔] 對話方塊中隱藏指定的控制項。</span><span class="sxs-lookup"><span data-stu-id="93c4c-219">Hides the specified control in an Explorer-style **Open** or **Save As** dialog box.</span></span> <span data-ttu-id="93c4c-220">您必須使用 **OFN \_ EXPLORER** 旗標建立對話方塊; 否則，訊息會失敗。</span><span class="sxs-lookup"><span data-stu-id="93c4c-220">The dialog box must have been created with the **OFN\_EXPLORER** flag; otherwise, the message fails.</span></span><br/>                                                                        |
| [<span data-ttu-id="93c4c-221">**CDM \_ SETCONTROLTEXT**</span><span class="sxs-lookup"><span data-stu-id="93c4c-221">**CDM\_SETCONTROLTEXT**</span></span>](cdm-setcontroltext.md)              | <span data-ttu-id="93c4c-222">在 Explorer 樣式的 [ **開啟** ] 或 [ **另存** 新檔] 對話方塊中，設定指定之控制項的文字。</span><span class="sxs-lookup"><span data-stu-id="93c4c-222">Sets the text for the specified control in an Explorer-style **Open** or **Save As** dialog box.</span></span> <span data-ttu-id="93c4c-223">您必須使用 **OFN \_ EXPLORER** 旗標建立對話方塊; 否則，訊息會失敗。</span><span class="sxs-lookup"><span data-stu-id="93c4c-223">The dialog box must have been created with the **OFN\_EXPLORER** flag; otherwise, the message fails.</span></span><br/>                                                            |
| [<span data-ttu-id="93c4c-224">**CDM \_ SETDEFEXT**</span><span class="sxs-lookup"><span data-stu-id="93c4c-224">**CDM\_SETDEFEXT**</span></span>](cdm-setdefext.md)                        | <span data-ttu-id="93c4c-225">設定 Explorer 樣式 [ **開啟** ] 或 [ **另存** 新檔] 對話方塊的預設副檔名。</span><span class="sxs-lookup"><span data-stu-id="93c4c-225">Sets the default file name extension for an Explorer-style **Open** or **Save As** dialog box.</span></span> <span data-ttu-id="93c4c-226">您必須使用 **OFN \_ EXPLORER** 旗標建立對話方塊; 否則，訊息會失敗。</span><span class="sxs-lookup"><span data-stu-id="93c4c-226">The dialog box must have been created with the **OFN\_EXPLORER** flag; otherwise, the message fails.</span></span><br/>                                                              |
| [<span data-ttu-id="93c4c-227">**SETRGBSTRING**</span><span class="sxs-lookup"><span data-stu-id="93c4c-227">**SETRGBSTRING**</span></span>](setrgbstring.md)                           | <span data-ttu-id="93c4c-228">[ **色彩** ] 對話方塊（ [*CCHookProc*](/windows/win32/api/commdlg/nc-commdlg-lpcchookproc)）的 [攔截程式] 可以將已註冊的 [**SETRGBSTRING**](setrgbstring.md) 訊息傳送至對話方塊，以設定目前的色彩選取範圍。</span><span class="sxs-lookup"><span data-stu-id="93c4c-228">The hook procedure of a **Color** dialog box, [*CCHookProc*](/windows/win32/api/commdlg/nc-commdlg-lpcchookproc), can send the [**SETRGBSTRING**](setrgbstring.md) registered message to the dialog box to set the current color selection.</span></span> <br/>                                                        |
| [<span data-ttu-id="93c4c-229">**WM \_ CHOOSEFONT \_ GETLOGFONT**</span><span class="sxs-lookup"><span data-stu-id="93c4c-229">**WM\_CHOOSEFONT\_GETLOGFONT**</span></span>](wm-choosefont-getlogfont.md) | <span data-ttu-id="93c4c-230">應用程式會將 [**WM \_ CHOOSEFONT \_ GETLOGFONT**](wm-choosefont-getlogfont.md) 訊息傳送至 [ **字型** ] 對話方塊，以取得使用者目前字型選取專案的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="93c4c-230">An application sends the [**WM\_CHOOSEFONT\_GETLOGFONT**](wm-choosefont-getlogfont.md) message to a **Font** dialog box to retrieve information about the user's current font selections.</span></span> <br/>                                                                      |
| [<span data-ttu-id="93c4c-231">**WM \_ CHOOSEFONT \_ SETFLAGS**</span><span class="sxs-lookup"><span data-stu-id="93c4c-231">**WM\_CHOOSEFONT\_SETFLAGS**</span></span>](wm-choosefont-setflags.md)     | <span data-ttu-id="93c4c-232">應用程式會將 [**WM \_ CHOOSEFONT \_ SETFLAGS**](wm-choosefont-setflags.md) 訊息傳送至 [ **字型** ] 對話方塊，以設定對話方塊的顯示選項。</span><span class="sxs-lookup"><span data-stu-id="93c4c-232">An application sends the [**WM\_CHOOSEFONT\_SETFLAGS**](wm-choosefont-setflags.md) message to a **Font** dialog box to set the display options for the dialog box.</span></span><br/>                                                                                              |
| [<span data-ttu-id="93c4c-233">**WM \_ CHOOSEFONT \_ SETLOGFONT**</span><span class="sxs-lookup"><span data-stu-id="93c4c-233">**WM\_CHOOSEFONT\_SETLOGFONT**</span></span>](wm-choosefont-setlogfont.md) | <span data-ttu-id="93c4c-234">應用程式會將 [**WM \_ CHOOSEFONT \_ SETLOGFONT**](wm-choosefont-setlogfont.md) 訊息傳送至 [ **字型** ] 對話方塊，以設定目前的邏輯字型資訊。</span><span class="sxs-lookup"><span data-stu-id="93c4c-234">An application sends the [**WM\_CHOOSEFONT\_SETLOGFONT**](wm-choosefont-setlogfont.md) message to a **Font** dialog box to set the current logical font information.</span></span> <br/>                                                                                           |



 

### <a name="notifications"></a><span data-ttu-id="93c4c-235">通知</span><span class="sxs-lookup"><span data-stu-id="93c4c-235">Notifications</span></span>



| <span data-ttu-id="93c4c-236">Name</span><span class="sxs-lookup"><span data-stu-id="93c4c-236">Name</span></span>                                                     | <span data-ttu-id="93c4c-237">描述</span><span class="sxs-lookup"><span data-stu-id="93c4c-237">Description</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                  |
|----------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="93c4c-238">**CDN \_ FILEOK**</span><span class="sxs-lookup"><span data-stu-id="93c4c-238">**CDN\_FILEOK**</span></span>](cdn-fileok.md)                        | <span data-ttu-id="93c4c-239">當使用者指定檔案名，並按一下 [**確定**] 按鈕時，由 Explorer 樣式的 [**開啟**] 或 [**另存** 新檔] 對話方塊傳送。</span><span class="sxs-lookup"><span data-stu-id="93c4c-239">Sent by an Explorer-style **Open** or **Save As** dialog box when the user specifies a file name and clicks the **OK** button.</span></span> <br/>                                                                                                                                                                                                                                                                                   |
| [<span data-ttu-id="93c4c-240">**CDN \_ FOLDERCHANGE**</span><span class="sxs-lookup"><span data-stu-id="93c4c-240">**CDN\_FOLDERCHANGE**</span></span>](cdn-folderchange.md)            | <span data-ttu-id="93c4c-241">開啟新資料夾時，由 Explorer 樣式的 [ **開啟** ] 或 [ **另存** 新檔] 對話方塊傳送。</span><span class="sxs-lookup"><span data-stu-id="93c4c-241">Sent by an Explorer-style **Open** or **Save As** dialog box when a new folder is opened.</span></span> <br/>                                                                                                                                                                                                                                                                                                                        |
| [<span data-ttu-id="93c4c-242">**CDN \_ 說明**</span><span class="sxs-lookup"><span data-stu-id="93c4c-242">**CDN\_HELP**</span></span>](cdn-help.md)                            | <span data-ttu-id="93c4c-243">當使用者按一下 [說明 **] 按鈕時，由** Explorer 樣式的 [**開啟**] 或 [**另存** 新檔] 對話方塊傳送。</span><span class="sxs-lookup"><span data-stu-id="93c4c-243">Sent by an Explorer-style **Open** or **Save As** dialog box when the user clicks the **Help** button.</span></span> <br/>                                                                                                                                                                                                                                                                                                           |
| [<span data-ttu-id="93c4c-244">**CDN \_ INCLUDEITEM**</span><span class="sxs-lookup"><span data-stu-id="93c4c-244">**CDN\_INCLUDEITEM**</span></span>](cdn-includeitem.md)              | <span data-ttu-id="93c4c-245">由 [ **開啟** ] 或 [ **另存** 新檔] 對話方塊傳送，以判斷對話方塊是否應在 shell 資料夾的專案清單中顯示專案。</span><span class="sxs-lookup"><span data-stu-id="93c4c-245">Sent by an **Open** or **Save As** dialog box to determine whether the dialog box should display an item in a shell folder's item list.</span></span> <span data-ttu-id="93c4c-246">當使用者開啟資料夾時，對話方塊會為資料夾中的每個專案傳送 [**CDN \_ INCLUDEITEM**](cdn-includeitem.md) 通知。</span><span class="sxs-lookup"><span data-stu-id="93c4c-246">When the user opens a folder, the dialog box sends a [**CDN\_INCLUDEITEM**](cdn-includeitem.md) notification for each item in the folder.</span></span> <span data-ttu-id="93c4c-247">只有在建立對話方塊時設定了 **OFN \_ ENABLEINCLUDENOTIFY** 旗標，對話方塊才會傳送此通知。</span><span class="sxs-lookup"><span data-stu-id="93c4c-247">The dialog box sends this notification only if the **OFN\_ENABLEINCLUDENOTIFY** flag was set when the dialog box was created.</span></span> <br/> |
| [<span data-ttu-id="93c4c-248">**CDN \_ INITDONE**</span><span class="sxs-lookup"><span data-stu-id="93c4c-248">**CDN\_INITDONE**</span></span>](cdn-initdone.md)                    | <span data-ttu-id="93c4c-249">當系統完成對話方塊中的控制項排列時，由 Explorer 樣式的 [ **開啟** ] 或 [ **另存** 新檔] 對話方塊傳送。</span><span class="sxs-lookup"><span data-stu-id="93c4c-249">Sent by an Explorer-style **Open** or **Save As** dialog box when the system has finished arranging the controls in the dialog box.</span></span> <span data-ttu-id="93c4c-250">系統會移動標準控制項，以騰出空間給子對話方塊的控制項。</span><span class="sxs-lookup"><span data-stu-id="93c4c-250">The system moves the standard controls to make room for the controls of the child dialog box.</span></span> <br/>                                                                                                                                                                                |
| [<span data-ttu-id="93c4c-251">**CDN \_ SELCHANGE**</span><span class="sxs-lookup"><span data-stu-id="93c4c-251">**CDN\_SELCHANGE**</span></span>](cdn-selchange.md)                  | <span data-ttu-id="93c4c-252">當清單方塊中顯示目前開啟的資料夾或目錄的內容時，由 Explorer 樣式的 [ **開啟** ] 或 [ **另存** 新檔] 對話方塊所傳送。</span><span class="sxs-lookup"><span data-stu-id="93c4c-252">Sent by an Explorer-style **Open** or **Save As** dialog box when the selection changes in the list box that displays the contents of the currently opened folder or directory.</span></span> <br/>                                                                                                                                                                                                                                  |
| [<span data-ttu-id="93c4c-253">**CDN \_ SHAREVIOLATION**</span><span class="sxs-lookup"><span data-stu-id="93c4c-253">**CDN\_SHAREVIOLATION**</span></span>](cdn-shareviolation.md)        | <span data-ttu-id="93c4c-254">當使用者按一下 [**確定]** 按鈕時，由 Explorer 樣式的 [**開啟**] 或 [**另存** 新檔] 對話方塊傳送，表示選取的檔案發生網路共用違規。</span><span class="sxs-lookup"><span data-stu-id="93c4c-254">Sent by an Explorer-style **Open** or **Save As** dialog box when the user clicks the **OK** button and a network sharing violation occurs for the selected file.</span></span> <br/>                                                                                                                                                                                                                                                |
| [<span data-ttu-id="93c4c-255">**CDN \_ TYPECHANGE**</span><span class="sxs-lookup"><span data-stu-id="93c4c-255">**CDN\_TYPECHANGE**</span></span>](cdn-typechange.md)                | <span data-ttu-id="93c4c-256">當使用者從 [檔案類型] 下拉式方塊中選取新的檔案類型時，由 Explorer 樣式的 [ **開啟** ] 或 [ **另存** 新檔] 對話方塊傳送。</span><span class="sxs-lookup"><span data-stu-id="93c4c-256">Sent by an Explorer-style **Open** or **Save As** dialog box when the user selects a new file type from the file types combo box.</span></span> <br/>                                                                                                                                                                                                                                                                                |
| [<span data-ttu-id="93c4c-257">**COLOROKSTRING**</span><span class="sxs-lookup"><span data-stu-id="93c4c-257">**COLOROKSTRING**</span></span>](colorokstring.md)                   | <span data-ttu-id="93c4c-258">當使用者選取色彩，然後按一下 [**確定]** 按鈕時，[**色彩**] 對話方塊會將已註冊的 [**COLOROKSTRING**](colorokstring.md)訊息傳送至您的掛勾程式 [*CCHookProc*](/windows/win32/api/commdlg/nc-commdlg-lpcchookproc)。</span><span class="sxs-lookup"><span data-stu-id="93c4c-258">A **Color** dialog box sends the [**COLOROKSTRING**](colorokstring.md) registered message to your hook procedure, [*CCHookProc*](/windows/win32/api/commdlg/nc-commdlg-lpcchookproc), when the user selects a color and clicks the **OK** button.</span></span> <span data-ttu-id="93c4c-259">攔截程式可以接受色彩，並允許對話方塊關閉或拒絕色彩，然後強制對話方塊保持開啟狀態。</span><span class="sxs-lookup"><span data-stu-id="93c4c-259">The hook procedure can accept the color and allow the dialog box to close, or reject the color and force the dialog box to remain open.</span></span> <br/>                                                           |
| [<span data-ttu-id="93c4c-260">**FILEOKSTRING**</span><span class="sxs-lookup"><span data-stu-id="93c4c-260">**FILEOKSTRING**</span></span>](fileokstring.md)                     | <span data-ttu-id="93c4c-261">當使用者指定檔案名，然後按一下 [**確定]** 按鈕時，[**開啟**] 或 [**另存** 新檔] 對話方塊會將已註冊的 [**FILEOKSTRING**](fileokstring.md)訊息傳送至您的攔截程式 [*OFNHookProc*](/windows/win32/api/commdlg/nc-commdlg-lpofnhookproc)。</span><span class="sxs-lookup"><span data-stu-id="93c4c-261">An **Open** or **Save As** dialog box sends the [**FILEOKSTRING**](fileokstring.md) registered message to your hook procedure, [*OFNHookProc*](/windows/win32/api/commdlg/nc-commdlg-lpofnhookproc), when the user specifies a file name and clicks the **OK** button.</span></span> <span data-ttu-id="93c4c-262">攔截程式可以接受檔案名，並允許對話方塊關閉或拒絕檔案名，並強制對話方塊維持開啟狀態。</span><span class="sxs-lookup"><span data-stu-id="93c4c-262">The hook procedure can accept the file name and allow the dialog box to close, or reject the file name and force the dialog box to remain open.</span></span> <br/>                              |
| [<span data-ttu-id="93c4c-263">**FINDMSGSTRING**</span><span class="sxs-lookup"><span data-stu-id="93c4c-263">**FINDMSGSTRING**</span></span>](findmsgstring.md)                   | <span data-ttu-id="93c4c-264">當使用者按一下 [**尋找下一個**]、[**取代**] 或 [**全部取代**] 按鈕，或關閉對話方塊時，[**尋找** 或 **取代**] 對話方塊會將 [**FINDMSGSTRING**](findmsgstring.md)註冊的訊息傳送至其擁有者視窗的視窗程式。</span><span class="sxs-lookup"><span data-stu-id="93c4c-264">A **Find** or **Replace** dialog box sends the [**FINDMSGSTRING**](findmsgstring.md) registered message to the window procedure of its owner window when the user clicks the **Find Next**, **Replace**, or **Replace All** button, or closes the dialog box.</span></span> <br/>                                                                                                                                                   |
| [<span data-ttu-id="93c4c-265">**HELPMSGSTRING**</span><span class="sxs-lookup"><span data-stu-id="93c4c-265">**HELPMSGSTRING**</span></span>](helpmsgstring.md)                   | <span data-ttu-id="93c4c-266">當使用者按一下 [說明 **] 按鈕時**，通用的對話方塊會將已註冊的 [**HELPMSGSTRING**](helpmsgstring.md)訊息傳送至其擁有者視窗的視窗程式。</span><span class="sxs-lookup"><span data-stu-id="93c4c-266">A common dialog box sends the [**HELPMSGSTRING**](helpmsgstring.md) registered message to the window procedure of its owner window when the user clicks the **Help** button.</span></span><br/>                                                                                                                                                                                                                                     |
| [<span data-ttu-id="93c4c-267">**LBSELCHSTRING**</span><span class="sxs-lookup"><span data-stu-id="93c4c-267">**LBSELCHSTRING**</span></span>](lbselchstring.md)                   | <span data-ttu-id="93c4c-268">[ **開啟** ] 或 [ **另存** 新檔] 對話方塊會在對話方塊的任何清單方塊或下拉式方塊中選取的專案變更時，將已註冊的 [**LBSELCHSTRING**](lbselchstring.md) 訊息傳送至您的勾點程式。</span><span class="sxs-lookup"><span data-stu-id="93c4c-268">An **Open** or **Save As** dialog box sends the [**LBSELCHSTRING**](lbselchstring.md) registered message to your hook procedure when the selection changes in any of the list boxes or combo boxes of the dialog box.</span></span><br/>                                                                                                                                                                                            |
| [<span data-ttu-id="93c4c-269">**SHAREVISTRING**</span><span class="sxs-lookup"><span data-stu-id="93c4c-269">**SHAREVISTRING**</span></span>](sharevistring.md)                   | <span data-ttu-id="93c4c-270">[ **開啟** ] 或 [ **另存** 新檔] 對話方塊會將已註冊的 [**SHAREVISTRING**](sharevistring.md) 訊息傳送至您的攔截程式 [*OFNHookProc*](/windows/win32/api/commdlg/nc-commdlg-lpofnhookproc)，如果當使用者按一下 [ **確定]** 按鈕時，所選取的檔案發生共用違規。</span><span class="sxs-lookup"><span data-stu-id="93c4c-270">An **Open** or **Save As** dialog box sends the [**SHAREVISTRING**](sharevistring.md) registered message to your hook procedure, [*OFNHookProc*](/windows/win32/api/commdlg/nc-commdlg-lpofnhookproc), if a sharing violation occurs for the selected file when the user clicks the **OK** button.</span></span><br/>                                                                                                                                                   |
| [<span data-ttu-id="93c4c-271">**WM \_ PSD \_ ENVSTAMPRECT**</span><span class="sxs-lookup"><span data-stu-id="93c4c-271">**WM\_PSD\_ENVSTAMPRECT**</span></span>](wm-psd-envstamprect.md)     | <span data-ttu-id="93c4c-272">通知 [版面設定] 對話方塊 [*PagePaintHook*](/windows/win32/api/commdlg/nc-commdlg-lppagepainthook)的攔截 **程式**，對話方塊即將繪製範例頁面的信封戳記矩形。</span><span class="sxs-lookup"><span data-stu-id="93c4c-272">Notifies the hook procedure of a **Page Setup** dialog box, [*PagePaintHook*](/windows/win32/api/commdlg/nc-commdlg-lppagepainthook), that the dialog box is about to draw the envelope-stamp rectangle of the sample page.</span></span> <br/>                                                                                                                                                                                                                          |
| [<span data-ttu-id="93c4c-273">**WM \_ PSD \_ FULLPAGERECT**</span><span class="sxs-lookup"><span data-stu-id="93c4c-273">**WM\_PSD\_FULLPAGERECT**</span></span>](wm-psd-fullpagerect.md)     | <span data-ttu-id="93c4c-274">在 [版面設定] 對話方塊中，通知範例頁面矩形座標的 [*PagePaintHook*](/windows/win32/api/commdlg/nc-commdlg-lppagepainthook) 勾點 **程式** 。</span><span class="sxs-lookup"><span data-stu-id="93c4c-274">Notifies a [*PagePaintHook*](/windows/win32/api/commdlg/nc-commdlg-lppagepainthook) hook procedure of the coordinates of the sample page rectangle in the **Page Setup** dialog box.</span></span> <span data-ttu-id="93c4c-275">當此對話方塊即將繪製範例頁面的內容時，就會傳送此訊息。</span><span class="sxs-lookup"><span data-stu-id="93c4c-275">The dialog box sends this message when it is about to draw the contents of the sample page.</span></span><br/>                                                                                                                                                                      |
| [<span data-ttu-id="93c4c-276">**WM \_ PSD \_ GREEKTEXTRECT**</span><span class="sxs-lookup"><span data-stu-id="93c4c-276">**WM\_PSD\_GREEKTEXTRECT**</span></span>](wm-psd-greektextrect.md)   | <span data-ttu-id="93c4c-277">通知 **頁面設定** 對話方塊 [*PagePaintHook*](/windows/win32/api/commdlg/nc-commdlg-lppagepainthook)的攔截程式，對話方塊即將在範例頁面的邊界矩形內繪製希臘文文字。</span><span class="sxs-lookup"><span data-stu-id="93c4c-277">Notifies the hook procedure of a **Page Setup** dialog box, [*PagePaintHook*](/windows/win32/api/commdlg/nc-commdlg-lppagepainthook), that the dialog box is about to draw Greek text inside the margin rectangle of the sample page.</span></span> <br/>                                                                                                                                                                                                                |
| [<span data-ttu-id="93c4c-278">**WM \_ PSD \_ MARGINRECT**</span><span class="sxs-lookup"><span data-stu-id="93c4c-278">**WM\_PSD\_MARGINRECT**</span></span>](wm-psd-marginrect.md)         | <span data-ttu-id="93c4c-279">通知 **頁面設定** 對話方塊（ [*PagePaintHook*](/windows/win32/api/commdlg/nc-commdlg-lppagepainthook)）的攔截程式，對話方塊即將繪製範例頁面的邊界矩形。</span><span class="sxs-lookup"><span data-stu-id="93c4c-279">Notifies the hook procedure of a **Page Setup** dialog box, [*PagePaintHook*](/windows/win32/api/commdlg/nc-commdlg-lppagepainthook), that the dialog box is about to draw the margin rectangle of the sample page.</span></span> <br/>                                                                                                                                                                                                                                  |
| [<span data-ttu-id="93c4c-280">**WM \_ PSD \_ MINMARGINRECT**</span><span class="sxs-lookup"><span data-stu-id="93c4c-280">**WM\_PSD\_MINMARGINRECT**</span></span>](wm-psd-minmarginrect.md)   | <span data-ttu-id="93c4c-281">通知範例頁面中邊界矩形座標的 [*PagePaintHook*](/windows/win32/api/commdlg/nc-commdlg-lppagepainthook) 勾點程式。</span><span class="sxs-lookup"><span data-stu-id="93c4c-281">Notifies a [*PagePaintHook*](/windows/win32/api/commdlg/nc-commdlg-lppagepainthook) hook procedure of the coordinates of the margin rectangle in the sample page.</span></span> <span data-ttu-id="93c4c-282">當 [版面 **設定** ] 對話方塊即將繪製範例頁面的內容時，就會傳送此訊息。</span><span class="sxs-lookup"><span data-stu-id="93c4c-282">A **Page Setup** dialog box sends this message when it is about to draw the contents of the sample page.</span></span><br/>                                                                                                                                                                            |
| [<span data-ttu-id="93c4c-283">**WM \_ PSD \_ PAGESETUPDLG**</span><span class="sxs-lookup"><span data-stu-id="93c4c-283">**WM\_PSD\_PAGESETUPDLG**</span></span>](wm-psd-pagesetupdlg.md)     | <span data-ttu-id="93c4c-284">通知 [*PagePaintHook*](/windows/win32/api/commdlg/nc-commdlg-lppagepainthook) 勾點程式，[版面 **設定** ] 對話方塊即將繪製範例頁面的內容。</span><span class="sxs-lookup"><span data-stu-id="93c4c-284">Notifies a [*PagePaintHook*](/windows/win32/api/commdlg/nc-commdlg-lppagepainthook) hook procedure that the **Page Setup** dialog box is about to draw the contents of the sample page.</span></span> <span data-ttu-id="93c4c-285">攔截程式可以使用此訊息來執行與繪製範例頁面內容相關的初始化工作。</span><span class="sxs-lookup"><span data-stu-id="93c4c-285">The hook procedure can use this message to carry out initialization tasks related to drawing the contents of the sample page.</span></span><br/>                                                                                                                                 |
| [<span data-ttu-id="93c4c-286">**WM \_ PSD \_ YAFULLPAGERECT**</span><span class="sxs-lookup"><span data-stu-id="93c4c-286">**WM\_PSD\_YAFULLPAGERECT**</span></span>](wm-psd-yafullpagerect.md) | <span data-ttu-id="93c4c-287">通知 [*PagePaintHook*](/windows/win32/api/commdlg/nc-commdlg-lppagepainthook)**頁面設定** 對話方塊的攔截程式，此對話方塊即將繪製信封範例頁面的傳回位址部分。</span><span class="sxs-lookup"><span data-stu-id="93c4c-287">Notifies the hook procedure of a **Page Setup** dialog box, [*PagePaintHook*](/windows/win32/api/commdlg/nc-commdlg-lppagepainthook), that the dialog box is about to draw the return address portion of an envelope sample page.</span></span> <br/>                                                                                                                                                                                                                    |



 

### <a name="structures"></a><span data-ttu-id="93c4c-288">結構</span><span class="sxs-lookup"><span data-stu-id="93c4c-288">Structures</span></span>



| <span data-ttu-id="93c4c-289">Name</span><span class="sxs-lookup"><span data-stu-id="93c4c-289">Name</span></span>                                              | <span data-ttu-id="93c4c-290">描述</span><span class="sxs-lookup"><span data-stu-id="93c4c-290">Description</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|---------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="93c4c-291">**CHOOSECOLOR**</span><span class="sxs-lookup"><span data-stu-id="93c4c-291">**CHOOSECOLOR**</span></span>](/windows/win32/api/commdlg/ns-commdlg-choosecolora-r1)            | <span data-ttu-id="93c4c-292">包含 [**ChooseColor**](/previous-versions/windows/desktop/legacy/ms646912(v=vs.85)) 函數用來初始化 [ **色彩** ] 對話方塊的資訊。</span><span class="sxs-lookup"><span data-stu-id="93c4c-292">Contains information the [**ChooseColor**](/previous-versions/windows/desktop/legacy/ms646912(v=vs.85)) function uses to initialize the **Color** dialog box.</span></span> <span data-ttu-id="93c4c-293">使用者關閉對話方塊之後，系統會傳回使用者在此結構中選取專案的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="93c4c-293">After the user closes the dialog box, the system returns information about the user's selection in this structure.</span></span> <br/>                                                                                                                                                                                                                  |
| [<span data-ttu-id="93c4c-294">**CHOOSEFONT**</span><span class="sxs-lookup"><span data-stu-id="93c4c-294">**CHOOSEFONT**</span></span>](/windows/win32/api/commdlg/ns-commdlg-choosefonta)              | <span data-ttu-id="93c4c-295">包含 [**ChooseFont**](/windows/win32/api/commdlg/ns-commdlg-choosefonta) 函數用來初始化 **字型** 對話方塊的資訊。</span><span class="sxs-lookup"><span data-stu-id="93c4c-295">Contains information that the [**ChooseFont**](/windows/win32/api/commdlg/ns-commdlg-choosefonta) function uses to initialize the **Font** dialog box.</span></span> <span data-ttu-id="93c4c-296">使用者關閉對話方塊之後，系統會傳回使用者在此結構中選取專案的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="93c4c-296">After the user closes the dialog box, the system returns information about the user's selection in this structure.</span></span> <br/>                                                                                                                                                                                                                |
| [<span data-ttu-id="93c4c-297">**DEVNAMES**</span><span class="sxs-lookup"><span data-stu-id="93c4c-297">**DEVNAMES**</span></span>](/windows/win32/api/commdlg/ns-commdlg-devnames)                  | <span data-ttu-id="93c4c-298">包含可識別印表機之驅動程式、裝置和輸出埠名稱的字串。</span><span class="sxs-lookup"><span data-stu-id="93c4c-298">Contains strings that identify the driver, device, and output port names for a printer.</span></span> <span data-ttu-id="93c4c-299">[**PrintDlgEx**](/previous-versions/windows/desktop/legacy/ms646942(v=vs.85))和 [**PrintDlg**](/previous-versions/windows/desktop/legacy/ms646940(v=vs.85))函數會使用這些字串來初始化系統定義的 [[列印屬性工作表](print-property-sheet.md)] 或 [[列印] 對話方塊](print-dialog-box.md)。</span><span class="sxs-lookup"><span data-stu-id="93c4c-299">The [**PrintDlgEx**](/previous-versions/windows/desktop/legacy/ms646942(v=vs.85)) and [**PrintDlg**](/previous-versions/windows/desktop/legacy/ms646940(v=vs.85)) functions use these strings to initialize the system-defined [Print Property Sheet](print-property-sheet.md) or [Print Dialog Box](print-dialog-box.md).</span></span> <span data-ttu-id="93c4c-300">當使用者關閉屬性工作表或對話方塊時，就會在此結構中傳回所選印表機的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="93c4c-300">When the user closes the property sheet or dialog box, information about the selected printer is returned in this structure.</span></span> <br/> |
| [<span data-ttu-id="93c4c-301">**FINDREPLACE**</span><span class="sxs-lookup"><span data-stu-id="93c4c-301">**FINDREPLACE**</span></span>](/windows/win32/api/commdlg/ns-commdlg-findreplacea)            | <span data-ttu-id="93c4c-302">包含 [**FindText**](/windows/desktop/api/Commdlg/nf-commdlg-findtexta) 和 [**replacer.replacetext**](/windows/desktop/api/Commdlg/nf-commdlg-replacetexta) 函數用來初始化 [ **尋找** 和 **取代** ] 對話方塊的資訊。</span><span class="sxs-lookup"><span data-stu-id="93c4c-302">Contains information that the [**FindText**](/windows/desktop/api/Commdlg/nf-commdlg-findtexta) and [**ReplaceText**](/windows/desktop/api/Commdlg/nf-commdlg-replacetexta) functions use to initialize the **Find** and **Replace** dialog boxes.</span></span> <span data-ttu-id="93c4c-303">[**FINDMSGSTRING**](findmsgstring.md)註冊的訊息會使用此結構，將使用者的搜尋或取代輸入傳遞至 [**尋找** 或 **取代**] 對話方塊的 [主控視窗] 視窗。</span><span class="sxs-lookup"><span data-stu-id="93c4c-303">The [**FINDMSGSTRING**](findmsgstring.md) registered message uses this structure to pass the user's search or replacement input to the owner window of a **Find** or **Replace** dialog box.</span></span><br/>                                                                                 |
| [<span data-ttu-id="93c4c-304">**OFNOTIFY**</span><span class="sxs-lookup"><span data-stu-id="93c4c-304">**OFNOTIFY**</span></span>](/windows/desktop/api/Commdlg/ns-commdlg-ofnotifya)                  | <span data-ttu-id="93c4c-305">針對 [**開啟**] 或 [**另存** 新檔] 對話方塊，包含傳送至 [*OFNHookProc*](/windows/win32/api/commdlg/nc-commdlg-lpofnhookproc)攔截程式之 [**WM \_ 通知**](../controls/wm-notify.md)訊息的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="93c4c-305">Ccontains information about a [**WM\_NOTIFY**](../controls/wm-notify.md) message sent to an [*OFNHookProc*](/windows/win32/api/commdlg/nc-commdlg-lpofnhookproc) hook procedure for an **Open** or **Save As** dialog box.</span></span> <span data-ttu-id="93c4c-306">**WM \_ 通知** 訊息的 *LParam* 參數是指向 [**OFNOTIFY**](/windows/desktop/api/Commdlg/ns-commdlg-ofnotifya)結構的指標。</span><span class="sxs-lookup"><span data-stu-id="93c4c-306">The *lParam* parameter of the **WM\_NOTIFY** message is a pointer to an [**OFNOTIFY**](/windows/desktop/api/Commdlg/ns-commdlg-ofnotifya) structure.</span></span> <br/>                                                                                                                                                    |
| [<span data-ttu-id="93c4c-307">**OFNOTIFYEX**</span><span class="sxs-lookup"><span data-stu-id="93c4c-307">**OFNOTIFYEX**</span></span>](/windows/desktop/api/Commdlg/ns-commdlg-ofnotifyexa)              | <span data-ttu-id="93c4c-308">包含 [**CDN \_ INCLUDEITEM**](cdn-includeitem.md) 通知訊息的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="93c4c-308">Contains information about a [**CDN\_INCLUDEITEM**](cdn-includeitem.md) notification message.</span></span> <br/>                                                                                                                                                                                                                                                                                                                                                        |
| [<span data-ttu-id="93c4c-309">**OPENFILENAME**</span><span class="sxs-lookup"><span data-stu-id="93c4c-309">**OPENFILENAME**</span></span>](/windows/win32/api/commdlg/ns-commdlg-openfilenamea)          | <span data-ttu-id="93c4c-310">包含 [**GetOpenFileName**](/windows/desktop/api/Commdlg/nf-commdlg-getopenfilenamea) 和 [**GetSaveFileName**](/windows/desktop/api/Commdlg/nf-commdlg-getsavefilenamea) 函數用來初始化 [ **開啟** ] 或 [ **另存** 新檔] 對話方塊的資訊。</span><span class="sxs-lookup"><span data-stu-id="93c4c-310">Contains information that the [**GetOpenFileName**](/windows/desktop/api/Commdlg/nf-commdlg-getopenfilenamea) and [**GetSaveFileName**](/windows/desktop/api/Commdlg/nf-commdlg-getsavefilenamea) functions use to initialize an **Open** or **Save As** dialog box.</span></span> <span data-ttu-id="93c4c-311">使用者關閉對話方塊之後，系統會傳回使用者在此結構中選取專案的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="93c4c-311">After the user closes the dialog box, the system returns information about the user's selection in this structure.</span></span><br/>                                                                                                                                          |
| [<span data-ttu-id="93c4c-312">**OPENFILENAME \_ NT4**</span><span class="sxs-lookup"><span data-stu-id="93c4c-312">**OPENFILENAME\_NT4**</span></span>](/windows/win32/api/commdlg/ns-commdlg-openfilename_nt4a) | <span data-ttu-id="93c4c-313">和[](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) \_ WIN32 \_ WINNT 設定為0x0400 的 OPENFILENAME 相同。</span><span class="sxs-lookup"><span data-stu-id="93c4c-313">Identical to [**OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) with \_WIN32\_WINNT set to 0x0400.</span></span> <br/>                                                                                                                                                                                                                                                                                                                                                              |
| [<span data-ttu-id="93c4c-314">**PAGESETUPDLG**</span><span class="sxs-lookup"><span data-stu-id="93c4c-314">**PAGESETUPDLG**</span></span>](/windows/win32/api/commdlg/ns-commdlg-pagesetupdlga)          | <span data-ttu-id="93c4c-315">包含 [**PageSetupDlg**](/previous-versions/windows/desktop/legacy/ms646937(v=vs.85)) 函數用來初始化 [版面 **設定** ] 對話方塊的資訊。</span><span class="sxs-lookup"><span data-stu-id="93c4c-315">Contains information the [**PageSetupDlg**](/previous-versions/windows/desktop/legacy/ms646937(v=vs.85)) function uses to initialize the **Page Setup** dialog box.</span></span> <span data-ttu-id="93c4c-316">使用者關閉對話方塊之後，系統會傳回這個結構中使用者定義頁面參數的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="93c4c-316">After the user closes the dialog box, the system returns information about the user-defined page parameters in this structure.</span></span> <br/>                                                                                                                                                                                               |
| [<span data-ttu-id="93c4c-317">**PRINTDLG**</span><span class="sxs-lookup"><span data-stu-id="93c4c-317">**PRINTDLG**</span></span>](/windows/win32/api/commdlg/ns-commdlg-printdlga)                  | <span data-ttu-id="93c4c-318">包含 [**PrintDlg**](/previous-versions/windows/desktop/legacy/ms646940(v=vs.85)) 函數用來初始化 [ [列印] 對話方塊](print-dialog-box.md)的資訊。</span><span class="sxs-lookup"><span data-stu-id="93c4c-318">Contains information that the [**PrintDlg**](/previous-versions/windows/desktop/legacy/ms646940(v=vs.85)) function uses to initialize the [Print Dialog Box](print-dialog-box.md).</span></span> <span data-ttu-id="93c4c-319">在使用者關閉對話方塊之後，系統會使用此結構來傳回使用者選取專案的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="93c4c-319">After the user closes the dialog box, the system uses this structure to return information about the user's selections.</span></span><br/>                                                                                                                                                                                           |
| [<span data-ttu-id="93c4c-320">**PRINTDLGEX**</span><span class="sxs-lookup"><span data-stu-id="93c4c-320">**PRINTDLGEX**</span></span>](/windows/win32/api/commdlg/ns-commdlg-printdlgexa)              | <span data-ttu-id="93c4c-321">包含 [**PrintDlgEx**](/previous-versions/windows/desktop/legacy/ms646942(v=vs.85)) 函數用來初始化 [列印屬性工作表](print-property-sheet.md)的資訊。</span><span class="sxs-lookup"><span data-stu-id="93c4c-321">Contains information that the [**PrintDlgEx**](/previous-versions/windows/desktop/legacy/ms646942(v=vs.85)) function uses to initialize the [Print property sheet](print-property-sheet.md).</span></span> <span data-ttu-id="93c4c-322">在使用者關閉屬性工作表之後，系統會使用此結構來傳回使用者選取專案的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="93c4c-322">After the user closes the property sheet, the system uses this structure to return information about the user's selections.</span></span><br/>                                                                                                                                                                           |
| [<span data-ttu-id="93c4c-323">**PRINTPAGERANGE**</span><span class="sxs-lookup"><span data-stu-id="93c4c-323">**PRINTPAGERANGE**</span></span>](/windows/win32/api/commdlg/ns-commdlg-printpagerange)      | <span data-ttu-id="93c4c-324">指定列印工作中的頁面範圍。</span><span class="sxs-lookup"><span data-stu-id="93c4c-324">Specifies a range of pages in a print job.</span></span> <span data-ttu-id="93c4c-325">列印工作可以有一個以上的頁面範圍。</span><span class="sxs-lookup"><span data-stu-id="93c4c-325">A print job can have more than one page range.</span></span> <span data-ttu-id="93c4c-326">呼叫 [**PRINTDLGEX**](/previous-versions/windows/desktop/legacy/ms646942(v=vs.85))函式時，會在 [**PRINTDLGEX**](/windows/win32/api/commdlg/ns-commdlg-printdlgexa)結構中提供這項資訊。</span><span class="sxs-lookup"><span data-stu-id="93c4c-326">This information is supplied in the [**PRINTDLGEX**](/windows/win32/api/commdlg/ns-commdlg-printdlgexa) structure when calling the [**PrintDlgEx**](/previous-versions/windows/desktop/legacy/ms646942(v=vs.85)) function.</span></span><br/>                                                                                                                                                                                                               |



 

 

