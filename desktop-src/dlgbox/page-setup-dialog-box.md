---
title: 版面設定對話方塊
description: 顯示模式對話方塊，可讓使用者選擇包含紙張類型、紙張來源、頁面方向和頁面邊界寬度的設定。
ms.assetid: debde0a0-07d4-46ed-a936-e517eab1852d
keywords:
- Windows 消費者介面，使用者輸入
- Windows 消費者介面、通用對話方塊程式庫
- 使用者輸入、通用對話方塊程式庫
- 正在捕獲使用者輸入，通用對話方塊程式庫
- 通用對話方塊程式庫
- 通用對話方塊
- 版面設定對話方塊
- 自訂版面設定對話方塊
- 頁面設定對話方塊、掛勾
- 預先定義的對話方塊
- 對話方塊，頁面設定
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: a4b9a8f7f30a8313017dc3a124cdccb7d00c872b
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/20/2020
ms.locfileid: "104093259"
---
# <a name="page-setup-dialog-box"></a><span data-ttu-id="48635-114">版面設定對話方塊</span><span class="sxs-lookup"><span data-stu-id="48635-114">Page Setup Dialog Box</span></span>

<span data-ttu-id="48635-115">顯示模式對話方塊，讓使用者可以設定列印頁面的下列屬性：</span><span class="sxs-lookup"><span data-stu-id="48635-115">Displays a modal dialog box that allows the user to set the following attributes of the printed page:</span></span>

-   <span data-ttu-id="48635-116">紙張類型 (信封、法律、信件等等) </span><span class="sxs-lookup"><span data-stu-id="48635-116">The paper type (envelope, legal, letter, and so on)</span></span>
-   <span data-ttu-id="48635-117">紙張來源 (手動摘要、車紙、紙器紙、紙器等等) </span><span class="sxs-lookup"><span data-stu-id="48635-117">The paper source (manual feed, tractor feed, sheet feeder, and so on)</span></span>
-   <span data-ttu-id="48635-118">頁面方向 (縱向或橫向) </span><span class="sxs-lookup"><span data-stu-id="48635-118">The page orientation (portrait or landscape)</span></span>
-   <span data-ttu-id="48635-119">頁面邊界的寬度</span><span class="sxs-lookup"><span data-stu-id="48635-119">The width of the page margins</span></span>

<span data-ttu-id="48635-120">您可以藉由初始化 [**PAGESETUPDLG**](/windows/win32/api/commdlg/ns-commdlg-pagesetupdlga)結構並將結構傳遞至 [**PAGESETUPDLG**](/previous-versions/windows/desktop/legacy/ms646937(v=vs.85))函式，來建立和顯示 [版面 **設定**] 對話方塊。</span><span class="sxs-lookup"><span data-stu-id="48635-120">You create and display a **Page Setup** dialog box by initializing a [**PAGESETUPDLG**](/windows/win32/api/commdlg/ns-commdlg-pagesetupdlga) structure and passing the structure to the [**PageSetupDlg**](/previous-versions/windows/desktop/legacy/ms646937(v=vs.85)) function.</span></span> <span data-ttu-id="48635-121">不過，根據印表機的功能而定，對話方塊中顯示的屬性會有所不同。</span><span class="sxs-lookup"><span data-stu-id="48635-121">However, the attributes presented in the dialog box vary, depending on the capabilities of the printer.</span></span> <span data-ttu-id="48635-122">下圖顯示一般的 [版面 **設定** ] 對話方塊。</span><span class="sxs-lookup"><span data-stu-id="48635-122">The following illustration shows a typical **Page Setup** dialog box.</span></span>

![版面設定對話方塊](images/pagesetupdialogboxxp.png)

<span data-ttu-id="48635-124">如果使用者按一下 [**確定]** 按鈕， [**PageSetupDlg**](/previous-versions/windows/desktop/legacy/ms646937(v=vs.85))會在 [**PageSetupDlg**](/windows/win32/api/commdlg/ns-commdlg-pagesetupdlga)結構中設定各種成員以指定使用者的選取專案之後傳回 **TRUE** 。</span><span class="sxs-lookup"><span data-stu-id="48635-124">If the user clicks the **OK** button, [**PageSetupDlg**](/previous-versions/windows/desktop/legacy/ms646937(v=vs.85)) returns **TRUE** after setting various members in the [**PAGESETUPDLG**](/windows/win32/api/commdlg/ns-commdlg-pagesetupdlga) structure to specify the user's selections.</span></span> <span data-ttu-id="48635-125">**PtPaperSize** 和 **rtMargin** 成員包含使用者指定的值。</span><span class="sxs-lookup"><span data-stu-id="48635-125">The **ptPaperSize** and **rtMargin** members contain the values specified by the user.</span></span> <span data-ttu-id="48635-126">**HDevMode** 和 **HDevNames** 成員包含 [**DEVMODE**](/windows/win32/api/wingdi/ns-wingdi-devmodea)和 [**DEVNAMES**](/windows/win32/api/commdlg/ns-commdlg-devnames)結構的全域記憶體控制碼。</span><span class="sxs-lookup"><span data-stu-id="48635-126">The **hDevMode** and **hDevNames** members contain global memory handles for the [**DEVMODE**](/windows/win32/api/wingdi/ns-wingdi-devmodea) and [**DEVNAMES**](/windows/win32/api/commdlg/ns-commdlg-devnames) structures.</span></span> <span data-ttu-id="48635-127">這些結構包含其他頁面資訊，以及印表機的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="48635-127">These structures contain additional page information as well as information about the printer.</span></span> <span data-ttu-id="48635-128">您可以使用這份資訊來準備要傳送到所選印表機的輸出。</span><span class="sxs-lookup"><span data-stu-id="48635-128">You can use this information to prepare the output to be sent to the selected printer.</span></span>

<span data-ttu-id="48635-129">如果使用者取消 [版面 **設定** ] 對話方塊或發生錯誤， [**PageSetupDlg**](/previous-versions/windows/desktop/legacy/ms646937(v=vs.85)) 會傳回 **FALSE**。</span><span class="sxs-lookup"><span data-stu-id="48635-129">If the user cancels the **Page Setup** dialog box or an error occurs, [**PageSetupDlg**](/previous-versions/windows/desktop/legacy/ms646937(v=vs.85)) returns **FALSE**.</span></span> <span data-ttu-id="48635-130">若要判斷錯誤的原因，請呼叫 [**CommDlgExtendedError**](/windows/desktop/api/Commdlg/nf-commdlg-commdlgextendederror) 函式來取出擴充的錯誤值。</span><span class="sxs-lookup"><span data-stu-id="48635-130">To determine the cause of the error, call the [**CommDlgExtendedError**](/windows/desktop/api/Commdlg/nf-commdlg-commdlgextendederror) function to retrieve the extended error value.</span></span>

<span data-ttu-id="48635-131">本節將討論下列主題。</span><span class="sxs-lookup"><span data-stu-id="48635-131">This section discusses the following topics.</span></span>

-   [<span data-ttu-id="48635-132">初始化頁面設定對話方塊</span><span class="sxs-lookup"><span data-stu-id="48635-132">Initializing the Page Setup Dialog Box</span></span>](#initializing-the-page-setup-dialog-box)
-   [<span data-ttu-id="48635-133">自訂版面設定對話方塊</span><span class="sxs-lookup"><span data-stu-id="48635-133">Customizing the Page Setup Dialog Box</span></span>](#customizing-the-page-setup-dialog-box)
-   [<span data-ttu-id="48635-134">自訂範例頁面</span><span class="sxs-lookup"><span data-stu-id="48635-134">Customizing the Sample Page</span></span>](#customizing-the-sample-page)

## <a name="initializing-the-page-setup-dialog-box"></a><span data-ttu-id="48635-135">初始化頁面設定對話方塊</span><span class="sxs-lookup"><span data-stu-id="48635-135">Initializing the Page Setup Dialog Box</span></span>

<span data-ttu-id="48635-136">依預設，[版面 **設定** ] 對話方塊會顯示目前預設印表機的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="48635-136">By default, the **Page Setup** dialog box displays information about the current default printer.</span></span> <span data-ttu-id="48635-137">若要指示對話方塊顯示特定印表機的相關資訊，請設定 [**DEVMODE**](/windows/win32/api/wingdi/ns-wingdi-devmodea) 或 [**DEVNAMES**](/windows/win32/api/commdlg/ns-commdlg-devnames) 結構的成員，並將這些結構的全域記憶體控制碼指派給 [**PAGESETUPDLG**](/windows/win32/api/commdlg/ns-commdlg-pagesetupdlga)中的對應成員。</span><span class="sxs-lookup"><span data-stu-id="48635-137">To direct the dialog box to display information about a specific printer, set the members of a [**DEVMODE**](/windows/win32/api/wingdi/ns-wingdi-devmodea) or [**DEVNAMES**](/windows/win32/api/commdlg/ns-commdlg-devnames) structure and assign the global memory handles of these structures to the corresponding member in [**PAGESETUPDLG**](/windows/win32/api/commdlg/ns-commdlg-pagesetupdlga).</span></span> <span data-ttu-id="48635-138">如果您指定目前未安裝之印表機的名稱，對話方塊會顯示錯誤訊息。</span><span class="sxs-lookup"><span data-stu-id="48635-138">If you specify the name of a printer that is not currently installed, the dialog box displays an error message.</span></span> <span data-ttu-id="48635-139">若要避免對話方塊顯示錯誤訊息，請使用 **PSD \_ NOWARNING** 值。</span><span class="sxs-lookup"><span data-stu-id="48635-139">To prevent the dialog box from displaying error messages, use the **PSD\_NOWARNING** value.</span></span> <span data-ttu-id="48635-140">若要在不顯示 [版面 **設定** ] 對話方塊的情況下取出預設印表機的相關資訊，請使用 [ **PSD \_ RETURNDEFAULT** ] 值。</span><span class="sxs-lookup"><span data-stu-id="48635-140">To retrieve information about the default printer without displaying the **Page Setup** dialog box, use the **PSD\_RETURNDEFAULT** value.</span></span>

<span data-ttu-id="48635-141">如果預設測量系統為英寸，則對話方塊會使用萬分之一作為預設測量單位。</span><span class="sxs-lookup"><span data-stu-id="48635-141">If the default measurement system is inches, the dialog box uses thousandths of inches as the default unit of measurement.</span></span> <span data-ttu-id="48635-142">如果預設測量系統為計量，此對話方塊會使用百分之一毫米作為預設測量單位。</span><span class="sxs-lookup"><span data-stu-id="48635-142">If the default measurement system is metric, the dialog box uses hundredths of millimeters as the default unit of measurement.</span></span> <span data-ttu-id="48635-143">若要覆寫預設的度量單位，請在 [**PAGESETUPDLG**](/windows/win32/api/commdlg/ns-commdlg-pagesetupdlga)結構的 **旗標** 成員中設定 **psd \_ INHUNDREDTHSOFMILLIMETERS** 或 **psd \_ INTHOUSANDTHSOFINCHES** 旗標。</span><span class="sxs-lookup"><span data-stu-id="48635-143">To override the default unit of measurement, set the **PSD\_INHUNDREDTHSOFMILLIMETERS** or **PSD\_INTHOUSANDTHSOFINCHES** flag in the **Flags** member of the [**PAGESETUPDLG**](/windows/win32/api/commdlg/ns-commdlg-pagesetupdlga) structure.</span></span>

<span data-ttu-id="48635-144">根據預設，邊界的初始值為1英寸。</span><span class="sxs-lookup"><span data-stu-id="48635-144">The initial values for the margins are one inch, by default.</span></span> <span data-ttu-id="48635-145">如果您設定 [ **PSD \_ 邊界** ] 旗標，此對話方塊會顯示 **rtMargin** 成員中指定的初始邊界值。</span><span class="sxs-lookup"><span data-stu-id="48635-145">If you set the **PSD\_MARGINS** flag, the dialog box displays the initial margin values specified in the **rtMargin** member.</span></span> <span data-ttu-id="48635-146">使用者可以為邊界指定的預設最小值是印表機允許的最小邊界。</span><span class="sxs-lookup"><span data-stu-id="48635-146">The default minimum values that the user can specify for the margins are the minimum margins allowed by the printer.</span></span> <span data-ttu-id="48635-147">如果您設定了 **PSD \_ MINMARGINS** 旗標，此對話方塊會強制執行 **rtMinMargin** 成員中指定的最小邊界。</span><span class="sxs-lookup"><span data-stu-id="48635-147">If you set the **PSD\_MINMARGINS** flag, the dialog box enforces the minimum margins specified in the **rtMinMargin** member.</span></span>

<span data-ttu-id="48635-148">若要防止使用者選取特定選項，請設定下列旗標的任何組合，以停用對應的控制項。</span><span class="sxs-lookup"><span data-stu-id="48635-148">To prevent users from selecting certain options, set any combination of the following flags to disable the corresponding controls.</span></span>



| <span data-ttu-id="48635-149">旗標</span><span class="sxs-lookup"><span data-stu-id="48635-149">Flag</span></span>                        | <span data-ttu-id="48635-150">意義</span><span class="sxs-lookup"><span data-stu-id="48635-150">Meaning</span></span>                                                                  |
|-----------------------------|--------------------------------------------------------------------------|
| <span data-ttu-id="48635-151">**PSD \_ DISABLEMARGINS**</span><span class="sxs-lookup"><span data-stu-id="48635-151">**PSD\_DISABLEMARGINS**</span></span>     | <span data-ttu-id="48635-152">停用使用者在其中輸入邊界設定的編輯控制項。</span><span class="sxs-lookup"><span data-stu-id="48635-152">Disables the edit controls in which the user enters the margin settings.</span></span> |
| <span data-ttu-id="48635-153">**PSD \_ DISABLEORIENTATION**</span><span class="sxs-lookup"><span data-stu-id="48635-153">**PSD\_DISABLEORIENTATION**</span></span> | <span data-ttu-id="48635-154">停用 **[直** 向] 和 [ **橫向** ] 選項按鈕。</span><span class="sxs-lookup"><span data-stu-id="48635-154">Disables the **Portrait** and **Landscape** radio buttons.</span></span>               |
| <span data-ttu-id="48635-155">**PSD \_ DISABLEPAPER**</span><span class="sxs-lookup"><span data-stu-id="48635-155">**PSD\_DISABLEPAPER**</span></span>       | <span data-ttu-id="48635-156">停用選取紙張大小和紙張來源的控制項。</span><span class="sxs-lookup"><span data-stu-id="48635-156">Disables the controls for selecting the paper size and paper source.</span></span>     |
| <span data-ttu-id="48635-157">**PSD \_ DISABLEPRINTER**</span><span class="sxs-lookup"><span data-stu-id="48635-157">**PSD\_DISABLEPRINTER**</span></span>     | <span data-ttu-id="48635-158">停用 **印表機** 按鈕。</span><span class="sxs-lookup"><span data-stu-id="48635-158">Disables the **Printer** button.</span></span>                                         |



 

## <a name="customizing-the-page-setup-dialog-box"></a><span data-ttu-id="48635-159">自訂版面設定對話方塊</span><span class="sxs-lookup"><span data-stu-id="48635-159">Customizing the Page Setup Dialog Box</span></span>

<span data-ttu-id="48635-160">您可以提供 [版面 **設定** ] 對話方塊的自訂範本，例如，如果您想要包含應用程式特有的其他控制項。</span><span class="sxs-lookup"><span data-stu-id="48635-160">You can provide a custom template for the **Page Setup** dialog box, for example, if you want to include additional controls that are unique to your application.</span></span> <span data-ttu-id="48635-161">[**PageSetupDlg**](/previous-versions/windows/desktop/legacy/ms646937(v=vs.85))函式會使用您的自訂範本來取代預設範本。</span><span class="sxs-lookup"><span data-stu-id="48635-161">The [**PageSetupDlg**](/previous-versions/windows/desktop/legacy/ms646937(v=vs.85)) function uses your custom template in place of the default template.</span></span>

<span data-ttu-id="48635-162">**提供 [版面設定] 對話方塊的自訂範本**</span><span class="sxs-lookup"><span data-stu-id="48635-162">**To provide a custom template for the Page Setup dialog box**</span></span>

1.  <span data-ttu-id="48635-163">藉由修改 Prnsetup 檔案中指定的預設範本來建立自訂範本。</span><span class="sxs-lookup"><span data-stu-id="48635-163">Create the custom template by modifying the default template specified in the Prnsetup.dlg file.</span></span> <span data-ttu-id="48635-164">預設的 [版面 **設定** ] 對話方塊範本中使用的控制項識別碼會定義于 Dlgs .h 檔案中。</span><span class="sxs-lookup"><span data-stu-id="48635-164">The control identifiers used in the default **Page Setup** dialog template are defined in the Dlgs.h file.</span></span>
2.  <span data-ttu-id="48635-165">使用 [**PAGESETUPDLG**](/windows/win32/api/commdlg/ns-commdlg-pagesetupdlga) 結構來啟用範本，如下所示：</span><span class="sxs-lookup"><span data-stu-id="48635-165">Use the [**PAGESETUPDLG**](/windows/win32/api/commdlg/ns-commdlg-pagesetupdlga) structure to enable the template as follows:</span></span>
    -   -   <span data-ttu-id="48635-166">如果您的自訂範本是應用程式或動態連結程式庫中的資源，請在 **旗標** 成員中設定 **PSD \_ ENABLEPAGESETUPTEMPLATE** 旗標。</span><span class="sxs-lookup"><span data-stu-id="48635-166">If your custom template is a resource in an application or dynamic-link library, set the **PSD\_ENABLEPAGESETUPTEMPLATE** flag in the **Flags** member.</span></span> <span data-ttu-id="48635-167">使用結構的 **hInstance** 和 **lpPageSetupTemplateName** 成員來識別模組和資源名稱。</span><span class="sxs-lookup"><span data-stu-id="48635-167">Use the **hInstance** and **lpPageSetupTemplateName** members of the structure to identify the module and resource name.</span></span>

            <span data-ttu-id="48635-168">-或者-</span><span class="sxs-lookup"><span data-stu-id="48635-168">-Or-</span></span>

        -   <span data-ttu-id="48635-169">如果您的自訂範本已在記憶體中，請設定 **PSD \_ ENABLEPAGESETUPTEMPLATEHANDLE** 旗標。</span><span class="sxs-lookup"><span data-stu-id="48635-169">If your custom template is already in memory, set the **PSD\_ENABLEPAGESETUPTEMPLATEHANDLE** flag.</span></span> <span data-ttu-id="48635-170">您可以使用 **hPageSetupTemplate** 成員來識別包含範本的記憶體物件。</span><span class="sxs-lookup"><span data-stu-id="48635-170">Use the **hPageSetupTemplate** member to identify the memory object that contains the template.</span></span>

<span data-ttu-id="48635-171">若要篩選傳送至對話方塊程式的訊息，您可以提供 [**PageSetupHook**](/windows/win32/api/commdlg/nc-commdlg-lppagesetuphook) 攔截程式。</span><span class="sxs-lookup"><span data-stu-id="48635-171">To filter messages sent to the dialog box procedure, you can provide a [**PageSetupHook**](/windows/win32/api/commdlg/nc-commdlg-lppagesetuphook) hook procedure.</span></span> <span data-ttu-id="48635-172">如果您使用自訂範本來定義其他控制項，您必須提供 **PageSetupHook** 勾點程式來處理控制項的輸入。</span><span class="sxs-lookup"><span data-stu-id="48635-172">If you use a custom template to define additional controls, you must provide a **PageSetupHook** hook procedure to process input for your controls.</span></span> <span data-ttu-id="48635-173">此外，您可以提供 [**PagePaintHook**](/windows/win32/api/commdlg/nc-commdlg-lppagepainthook) 攔截程式，以自訂 [版面 **設定** ] 對話方塊所顯示的範例頁面內容。</span><span class="sxs-lookup"><span data-stu-id="48635-173">In addition, you can provide a [**PagePaintHook**](/windows/win32/api/commdlg/nc-commdlg-lppagepainthook) hook procedure to customize the contents of the sample page displayed by the **Page Setup** dialog box.</span></span> <span data-ttu-id="48635-174">如需有關 **PagePaintHook** 攔截程式的詳細資訊，請參閱 [自訂範例頁面](#customizing-the-sample-page)。</span><span class="sxs-lookup"><span data-stu-id="48635-174">For more information about the **PagePaintHook** hook procedure, see [Customizing the Sample Page](#customizing-the-sample-page).</span></span>

<span data-ttu-id="48635-175">**啟用 PageSetupHook 勾點程式**</span><span class="sxs-lookup"><span data-stu-id="48635-175">**To enable a PageSetupHook hook procedure**</span></span>

1.  <span data-ttu-id="48635-176">在 [**PAGESETUPDLG**](/windows/win32/api/commdlg/ns-commdlg-pagesetupdlga)結構的 Flags 成員中設定 **PSD \_ ENABLEPAGESETUPHOOK** 旗 **標**。</span><span class="sxs-lookup"><span data-stu-id="48635-176">Set the **PSD\_ENABLEPAGESETUPHOOK** flag in the **Flags** member of the [**PAGESETUPDLG**](/windows/win32/api/commdlg/ns-commdlg-pagesetupdlga) structure.</span></span>
2.  <span data-ttu-id="48635-177">在 **lpfnPageSetupHook** 成員中指定攔截程式的位址。</span><span class="sxs-lookup"><span data-stu-id="48635-177">Specify the address of the hook procedure in the **lpfnPageSetupHook** member.</span></span>

<span data-ttu-id="48635-178">處理其 [**WM \_ INITDIALOG**](wm-initdialog.md) 訊息之後，對話方塊程式會將 **wm \_ INITDIALOG** 訊息傳送至 [**PageSetupHook**](/windows/win32/api/commdlg/nc-commdlg-lppagesetuphook) 攔截程式。</span><span class="sxs-lookup"><span data-stu-id="48635-178">After processing its [**WM\_INITDIALOG**](wm-initdialog.md) message, the dialog box procedure sends a **WM\_INITDIALOG** message to the [**PageSetupHook**](/windows/win32/api/commdlg/nc-commdlg-lppagesetuphook) hook procedure.</span></span> <span data-ttu-id="48635-179">此訊息的 *lParam* 參數是用來初始化對話方塊之 [**PAGESETUPDLG**](/windows/win32/api/commdlg/ns-commdlg-pagesetupdlga) 結構的指標。</span><span class="sxs-lookup"><span data-stu-id="48635-179">The *lParam* parameter of this message is a pointer to the [**PAGESETUPDLG**](/windows/win32/api/commdlg/ns-commdlg-pagesetupdlga) structure used to initialize the dialog box.</span></span>

## <a name="customizing-the-sample-page"></a><span data-ttu-id="48635-180">自訂範例頁面</span><span class="sxs-lookup"><span data-stu-id="48635-180">Customizing the Sample Page</span></span>

<span data-ttu-id="48635-181">[版面 **設定** ] 對話方塊包含範例頁面的影像，其中顯示使用者的選取專案如何影響列印輸出的外觀。</span><span class="sxs-lookup"><span data-stu-id="48635-181">The **Page Setup** dialog box includes an image of a sample page that shows how the user's selections affect the appearance of the printed output.</span></span> <span data-ttu-id="48635-182">影像包含表示所選紙張或信封類型的矩形，以及表示目前邊界的虛線矩形，以及部分 (希臘文文字) 字元來顯示文字在列印頁面上的外觀。</span><span class="sxs-lookup"><span data-stu-id="48635-182">The image consists of a rectangle that represents the selected paper or envelope type, with a dotted-line rectangle representing the current margins, and partial (Greek text) characters to show how text looks on the printed page.</span></span>

<span data-ttu-id="48635-183">當您呼叫 [**PageSetupDlg**](/previous-versions/windows/desktop/legacy/ms646937(v=vs.85)) 函式時，您可以提供 [**PagePaintHook**](/windows/win32/api/commdlg/nc-commdlg-lppagepainthook) 攔截程式以自訂範例頁面的外觀。</span><span class="sxs-lookup"><span data-stu-id="48635-183">When you call the [**PageSetupDlg**](/previous-versions/windows/desktop/legacy/ms646937(v=vs.85)) function, you can provide a [**PagePaintHook**](/windows/win32/api/commdlg/nc-commdlg-lppagepainthook) hook procedure to customize the appearance of the sample page.</span></span>

<span data-ttu-id="48635-184">**啟用 PagePaintHook 勾點程式**</span><span class="sxs-lookup"><span data-stu-id="48635-184">**To enable a PagePaintHook hook procedure**</span></span>

1.  <span data-ttu-id="48635-185">在 [**PAGESETUPDLG**](/windows/win32/api/commdlg/ns-commdlg-pagesetupdlga)結構的 Flags 成員中設定 **PSD \_ ENABLEPAGEPAINTHOOK** 旗 **標**。</span><span class="sxs-lookup"><span data-stu-id="48635-185">Set the **PSD\_ENABLEPAGEPAINTHOOK** flag in the **Flags** member of the [**PAGESETUPDLG**](/windows/win32/api/commdlg/ns-commdlg-pagesetupdlga) structure.</span></span>
2.  <span data-ttu-id="48635-186">在 **lpfnPagePaintHook** 成員中指定攔截程式的位址。</span><span class="sxs-lookup"><span data-stu-id="48635-186">Specify the address of the hook procedure in the **lpfnPagePaintHook** member.</span></span>

<span data-ttu-id="48635-187">每當對話方塊即將繪製範例頁面的內容時，攔截程式就會依照列出的順序接收下列訊息。</span><span class="sxs-lookup"><span data-stu-id="48635-187">Whenever the dialog box is about to draw the contents of the sample page, the hook procedure receives the following messages in the order in which they are listed.</span></span>



| <span data-ttu-id="48635-188">訊息</span><span class="sxs-lookup"><span data-stu-id="48635-188">Message</span></span>                                                  | <span data-ttu-id="48635-189">意義</span><span class="sxs-lookup"><span data-stu-id="48635-189">Meaning</span></span>                                                                                                                                          |
|----------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="48635-190">**WM \_ PSD \_ PAGESETUPDLG**</span><span class="sxs-lookup"><span data-stu-id="48635-190">**WM\_PSD\_PAGESETUPDLG**</span></span>](wm-psd-pagesetupdlg.md)     | <span data-ttu-id="48635-191">對話方塊即將繪製範例頁面。</span><span class="sxs-lookup"><span data-stu-id="48635-191">The dialog box is about to draw the sample page.</span></span> <span data-ttu-id="48635-192">攔截程式可以使用此訊息來準備繪製範例頁面的內容。</span><span class="sxs-lookup"><span data-stu-id="48635-192">The hook procedure can use this message to prepare to draw the contents of the sample page.</span></span>     |
| [<span data-ttu-id="48635-193">**WM \_ PSD \_ FULLPAGERECT**</span><span class="sxs-lookup"><span data-stu-id="48635-193">**WM\_PSD\_FULLPAGERECT**</span></span>](wm-psd-fullpagerect.md)     | <span data-ttu-id="48635-194">對話方塊即將繪製範例頁面。</span><span class="sxs-lookup"><span data-stu-id="48635-194">The dialog box is about to draw the sample page.</span></span> <span data-ttu-id="48635-195">此訊息指定範例頁面的周框。</span><span class="sxs-lookup"><span data-stu-id="48635-195">This message specifies the bounding rectangle of the sample page.</span></span>                               |
| [<span data-ttu-id="48635-196">**WM \_ PSD \_ MINMARGINRECT**</span><span class="sxs-lookup"><span data-stu-id="48635-196">**WM\_PSD\_MINMARGINRECT**</span></span>](wm-psd-minmarginrect.md)   | <span data-ttu-id="48635-197">對話方塊即將繪製範例頁面。</span><span class="sxs-lookup"><span data-stu-id="48635-197">The dialog box is about to draw the sample page.</span></span> <span data-ttu-id="48635-198">此訊息會指定邊界矩形。</span><span class="sxs-lookup"><span data-stu-id="48635-198">This message specifies the margin rectangle.</span></span>                                                    |
| [<span data-ttu-id="48635-199">**WM \_ PSD \_ MARGINRECT**</span><span class="sxs-lookup"><span data-stu-id="48635-199">**WM\_PSD\_MARGINRECT**</span></span>](wm-psd-marginrect.md)         | <span data-ttu-id="48635-200">對話方塊即將繪製邊界矩形。</span><span class="sxs-lookup"><span data-stu-id="48635-200">The dialog box is about to draw the margin rectangle.</span></span>                                                                                            |
| [<span data-ttu-id="48635-201">**WM \_ PSD \_ GREEKTEXTRECT**</span><span class="sxs-lookup"><span data-stu-id="48635-201">**WM\_PSD\_GREEKTEXTRECT**</span></span>](wm-psd-greektextrect.md)   | <span data-ttu-id="48635-202">對話方塊即將在邊界矩形內繪製希臘文文字。</span><span class="sxs-lookup"><span data-stu-id="48635-202">The dialog box is about to draw the Greek text inside the margin rectangle.</span></span>                                                                      |
| [<span data-ttu-id="48635-203">**WM \_ PSD \_ ENVSTAMPRECT**</span><span class="sxs-lookup"><span data-stu-id="48635-203">**WM\_PSD\_ENVSTAMPRECT**</span></span>](wm-psd-envstamprect.md)     | <span data-ttu-id="48635-204">對話方塊即將在信封範例頁面的信封戳記矩形中繪製。</span><span class="sxs-lookup"><span data-stu-id="48635-204">The dialog box is about to draw in the envelope-stamp rectangle of an envelope sample page.</span></span> <span data-ttu-id="48635-205">這則訊息只會傳送給信封。</span><span class="sxs-lookup"><span data-stu-id="48635-205">This message is sent for envelopes only.</span></span>             |
| [<span data-ttu-id="48635-206">**WM \_ PSD \_ YAFULLPAGERECT**</span><span class="sxs-lookup"><span data-stu-id="48635-206">**WM\_PSD\_YAFULLPAGERECT**</span></span>](wm-psd-yafullpagerect.md) | <span data-ttu-id="48635-207">對話方塊即將繪製信封範例頁面的傳回位址部分。</span><span class="sxs-lookup"><span data-stu-id="48635-207">The dialog box is about to draw the return address portion of an envelope sample page.</span></span> <span data-ttu-id="48635-208">傳送信封和其他紙張大小的訊息。</span><span class="sxs-lookup"><span data-stu-id="48635-208">This message is sent for envelopes and other paper sizes.</span></span> |



 

<span data-ttu-id="48635-209">如果此攔截程式針對繪製順序的前三個訊息中的任一個傳回 **TRUE** ([**WM \_ psd \_ PAGESETUPDLG**](wm-psd-pagesetupdlg.md)、 [**wm \_ psd \_ FULLPAGERECT**](wm-psd-fullpagerect.md)或 [**WM \_ psd \_ MINMARGINRECT**](wm-psd-minmarginrect.md)) 對話方塊不會傳送其他訊息，也不會在範例頁面中繪製，直到下次系統需要重新繪製範例頁面為止。</span><span class="sxs-lookup"><span data-stu-id="48635-209">If the hook procedure returns **TRUE** for any of the first three messages of a drawing sequence ([**WM\_PSD\_PAGESETUPDLG**](wm-psd-pagesetupdlg.md), [**WM\_PSD\_FULLPAGERECT**](wm-psd-fullpagerect.md), or [**WM\_PSD\_MINMARGINRECT**](wm-psd-minmarginrect.md)) the dialog box sends no more messages and does not draw in the sample page until the next time the system needs to redraw the sample page.</span></span> <span data-ttu-id="48635-210">如果這三個訊息的攔截程式都傳回 **FALSE** ，則對話方塊會傳送繪圖順序的其餘訊息。</span><span class="sxs-lookup"><span data-stu-id="48635-210">If the hook procedure returns **FALSE** for all three messages, the dialog box sends the remaining messages of the drawing sequence.</span></span>

<span data-ttu-id="48635-211">如果此攔截程式針對繪圖順序中的任何其餘訊息傳回 **TRUE** ，對話方塊就不會繪製範例頁面的對應部分。</span><span class="sxs-lookup"><span data-stu-id="48635-211">If the hook procedure returns **TRUE** for any of the remaining messages in a drawing sequence, the dialog box does not draw the corresponding portion of the sample page.</span></span> <span data-ttu-id="48635-212">如果攔截程式針對上述任何訊息傳回 **FALSE** ，則對話方塊會繪製範例頁面的該部分。</span><span class="sxs-lookup"><span data-stu-id="48635-212">If the hook procedure returns **FALSE** for any of these messages, the dialog box draws that portion of the sample page.</span></span>

<span data-ttu-id="48635-213">若要防止對話方塊繪製範例頁面的內容，您可以設定 **PSD \_ DISABLEPAGEPAINTING** 旗標。</span><span class="sxs-lookup"><span data-stu-id="48635-213">To prevent the dialog box from drawing the contents of the sample page, you can set the **PSD\_DISABLEPAGEPAINTING** flag.</span></span> <span data-ttu-id="48635-214">此旗標不會影響您的 [**PagePaintHook**](/windows/win32/api/commdlg/nc-commdlg-lppagepainthook)攔截程式，它仍會接收所有的 **WM \_ PSD \_ \*** 訊息，並且可以繪製範例頁面內容。</span><span class="sxs-lookup"><span data-stu-id="48635-214">This flag does not affect your [**PagePaintHook**](/windows/win32/api/commdlg/nc-commdlg-lppagepainthook) hook procedure, which still receives all the **WM\_PSD\_\*** messages and can draw the sample page contents.</span></span>

 

 