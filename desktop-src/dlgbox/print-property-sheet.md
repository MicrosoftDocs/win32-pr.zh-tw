---
title: 列印屬性工作表
description: '[列印] 屬性工作表是標準使用者介面，可讓使用者指定特定列印工作的屬性。'
ms.assetid: b52b71cc-a583-4a21-8a53-501ab442e6f8
keywords:
- Windows 消費者介面，使用者輸入
- Windows 消費者介面、通用對話方塊程式庫
- 使用者輸入、通用對話方塊程式庫
- 正在捕獲使用者輸入，通用對話方塊程式庫
- 通用對話方塊程式庫
- 通用對話方塊
- '[列印屬性工作表] 對話方塊'
- 自訂列印屬性工作表對話方塊
- 預先定義的對話方塊
- 對話方塊、列印屬性工作表
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 20905f76af290b3978bec828a382604147297998
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/20/2020
ms.locfileid: "104024062"
---
# <a name="print-property-sheet"></a><span data-ttu-id="b1990-113">列印屬性工作表</span><span class="sxs-lookup"><span data-stu-id="b1990-113">Print Property Sheet</span></span>

<span data-ttu-id="b1990-114">[ **列印** ] 屬性工作表是標準使用者介面，可讓使用者指定特定列印工作的屬性。</span><span class="sxs-lookup"><span data-stu-id="b1990-114">The **Print** property sheet is a standard user interface that enables the user to specify the properties of a particular print job.</span></span> <span data-ttu-id="b1990-115">屬性工作表是由印表機或應用程式一組不同的屬性頁所組成。</span><span class="sxs-lookup"><span data-stu-id="b1990-115">The property sheet is composed of a set of property pages that varies by printer or application.</span></span> <span data-ttu-id="b1990-116">在標準 Windows 屬性頁的子集，某些印表機可能會新增驅動程式特定的屬性頁，而某些應用程式可能會新增應用程式特定的屬性頁。</span><span class="sxs-lookup"><span data-stu-id="b1990-116">To a subset of standard Windows property pages, some printers might add driver-specific property pages and some applications might add application-specific property pages.</span></span>

<span data-ttu-id="b1990-117">若要建立和顯示 **列印** 屬性工作表，請初始化 [**PRINTDLGEX**](/windows/win32/api/commdlg/ns-commdlg-printdlgexa) 結構，並將結構傳遞至 [**PRINTDLGEX**](/previous-versions/windows/desktop/legacy/ms646942(v=vs.85)) 函數。</span><span class="sxs-lookup"><span data-stu-id="b1990-117">To create and display a **Print** property sheet, initialize a [**PRINTDLGEX**](/windows/win32/api/commdlg/ns-commdlg-printdlgexa) structure and pass the structure to the [**PrintDlgEx**](/previous-versions/windows/desktop/legacy/ms646942(v=vs.85)) function.</span></span>

<span data-ttu-id="b1990-118">下圖顯示典型的 **列印** 屬性工作表。</span><span class="sxs-lookup"><span data-stu-id="b1990-118">The following illustration shows a typical **Print** property sheet.</span></span>

![印表機屬性工作表](images/printerpropertypagexp.png)

<span data-ttu-id="b1990-120">[**PRINTDLGEX**](/windows/win32/api/commdlg/ns-commdlg-printdlgexa)結構的大部分成員都與 [**PRINTDLG**](/windows/win32/api/commdlg/ns-commdlg-printdlga)結構的成員相同。</span><span class="sxs-lookup"><span data-stu-id="b1990-120">Most members of the [**PRINTDLGEX**](/windows/win32/api/commdlg/ns-commdlg-printdlgexa) structure are identical to those of the [**PRINTDLG**](/windows/win32/api/commdlg/ns-commdlg-printdlga) structure.</span></span> <span data-ttu-id="b1990-121">如需如何使用通用結構成員與對話方塊控制項互動的說明，請參閱 [ [列印] 對話方塊](print-dialog-box.md)。</span><span class="sxs-lookup"><span data-stu-id="b1990-121">For descriptions of how to use the common structure members to interact with the dialog box controls, see [Print Dialog Box](print-dialog-box.md).</span></span> <span data-ttu-id="b1990-122">本主題的其餘部分將描述不同于 [**列印**] 對話方塊的 **列印** 屬性工作表功能。</span><span class="sxs-lookup"><span data-stu-id="b1990-122">The remainder of this topic describes the **Print** property sheet features that differ from the **Print** dialog box.</span></span>

<span data-ttu-id="b1990-123">您可以在 [**一般**] 頁面的下半部指定自訂對話方塊範本，並指定其他屬性頁以遵循 [**一般**] 頁面，以自訂 **列印** 屬性工作表。</span><span class="sxs-lookup"><span data-stu-id="b1990-123">You can customize a **Print** property sheet by specifying a custom dialog box template for the lower portion of the **General** page and by specifying additional property pages to follow the **General** page.</span></span> <span data-ttu-id="b1990-124">如需詳細資訊，請參閱 [自訂列印屬性工作表](#customizing-the-print-property-sheet)。</span><span class="sxs-lookup"><span data-stu-id="b1990-124">For more information, see [Customizing the Print Property Sheet](#customizing-the-print-property-sheet).</span></span>

<span data-ttu-id="b1990-125">您可以執行回呼物件，以在顯示內容表時，從 [**PrintDlgEx**](/previous-versions/windows/desktop/legacy/ms646942(v=vs.85)) 函式接收通知和訊息。</span><span class="sxs-lookup"><span data-stu-id="b1990-125">You can implement a callback object to receive notifications and messages from the [**PrintDlgEx**](/previous-versions/windows/desktop/legacy/ms646942(v=vs.85)) function while the property sheet is displayed.</span></span> <span data-ttu-id="b1990-126">提供自訂範本或其他頁面的應用程式會使用回呼物件與屬性工作表進行通訊。</span><span class="sxs-lookup"><span data-stu-id="b1990-126">Applications that provide custom templates or additional pages use the callback object to communicate with the property sheet.</span></span> <span data-ttu-id="b1990-127">如需詳細資訊，請參閱 [Print 屬性工作表的回呼物件](#callback-object-for-the-print-property-sheet)。</span><span class="sxs-lookup"><span data-stu-id="b1990-127">For more information, see [Callback Object for the Print Property Sheet](#callback-object-for-the-print-property-sheet).</span></span>

<span data-ttu-id="b1990-128">[ **列印** ] 屬性工作表提供將多個非連續頁面範圍指定為列印的支援。</span><span class="sxs-lookup"><span data-stu-id="b1990-128">The **Print** property sheet provides support for specifying multiple, noncontiguous page ranges to print.</span></span> <span data-ttu-id="b1990-129">[**PRINTDLGEX**](/windows/win32/api/commdlg/ns-commdlg-printdlgexa)結構的 **lpPageRanges** 成員會指定 [**PRINTPAGERANGE**](/windows/win32/api/commdlg/ns-commdlg-printpagerange)結構的陣列，其中每個結構都指定一個頁面範圍。</span><span class="sxs-lookup"><span data-stu-id="b1990-129">The **lpPageRanges** member of the [**PRINTDLGEX**](/windows/win32/api/commdlg/ns-commdlg-printdlgexa) structure specifies an array of [**PRINTPAGERANGE**](/windows/win32/api/commdlg/ns-commdlg-printpagerange) structures in which each structure specifies a page range.</span></span>

<span data-ttu-id="b1990-130">[**列印** 屬性工作表] 會在選項按鈕群組的 [**頁面範圍**] 群組中顯示 [**目前的頁面**] 選項按鈕。</span><span class="sxs-lookup"><span data-stu-id="b1990-130">The **Print** property sheet displays a **Current Page** radio button as part of the **Page Range** group of radio buttons.</span></span> <span data-ttu-id="b1990-131">若要控制 **目前的頁面** 選項按鈕，請在 [**PRINTDLGEX**](/windows/win32/api/commdlg/ns-commdlg-printdlgexa)結構的 **旗標** 成員中使用 **pd \_ CURRENTPAGE** 和 **pd \_ NOCURRENTPAGE** 旗標。</span><span class="sxs-lookup"><span data-stu-id="b1990-131">To control the **Current Page** radio button, use the **PD\_CURRENTPAGE** and **PD\_NOCURRENTPAGE** flags in the **Flags** member of the [**PRINTDLGEX**](/windows/win32/api/commdlg/ns-commdlg-printdlgexa) structure.</span></span>

<span data-ttu-id="b1990-132">本節將討論下列主題。</span><span class="sxs-lookup"><span data-stu-id="b1990-132">This section discusses the following topics.</span></span>

-   [<span data-ttu-id="b1990-133">自訂列印屬性工作表</span><span class="sxs-lookup"><span data-stu-id="b1990-133">Customizing the Print Property Sheet</span></span>](#customizing-the-print-property-sheet)
-   [<span data-ttu-id="b1990-134">列印屬性工作表的回呼物件</span><span class="sxs-lookup"><span data-stu-id="b1990-134">Callback Object for the Print Property Sheet</span></span>](#callback-object-for-the-print-property-sheet)

## <a name="customizing-the-print-property-sheet"></a><span data-ttu-id="b1990-135">自訂列印屬性工作表</span><span class="sxs-lookup"><span data-stu-id="b1990-135">Customizing the Print Property Sheet</span></span>

<span data-ttu-id="b1990-136">您可以透過下列方式自訂 **列印** 屬性工作表：</span><span class="sxs-lookup"><span data-stu-id="b1990-136">You can customize the **Print** property sheet in the following ways:</span></span>

-   <span data-ttu-id="b1990-137">提供 [ **一般** ] 頁面下半部的自訂範本。</span><span class="sxs-lookup"><span data-stu-id="b1990-137">Provide a custom template for the lower portion of the **General** page.</span></span> <span data-ttu-id="b1990-138">這可讓您包含應用程式特有的其他控制項。</span><span class="sxs-lookup"><span data-stu-id="b1990-138">This allows you to include additional controls that are unique to your application.</span></span> <span data-ttu-id="b1990-139">[**PrintDlgEx**](/previous-versions/windows/desktop/legacy/ms646942(v=vs.85))函式會使用您的自訂範本來取代預設範本。</span><span class="sxs-lookup"><span data-stu-id="b1990-139">The [**PrintDlgEx**](/previous-versions/windows/desktop/legacy/ms646942(v=vs.85)) function uses your custom template in place of the default template.</span></span>
-   <span data-ttu-id="b1990-140">提供其他屬性頁以遵循 [ **一般** ] 頁面。</span><span class="sxs-lookup"><span data-stu-id="b1990-140">Provide additional property pages to follow the **General** page.</span></span>
-   <span data-ttu-id="b1990-141">提供回呼物件。</span><span class="sxs-lookup"><span data-stu-id="b1990-141">Provide a callback object.</span></span> <span data-ttu-id="b1990-142">如需詳細資訊，請參閱 [Print 屬性工作表的回呼物件](#callback-object-for-the-print-property-sheet)。</span><span class="sxs-lookup"><span data-stu-id="b1990-142">For more information, see [Callback Object for the Print Property Sheet](#callback-object-for-the-print-property-sheet).</span></span>

<span data-ttu-id="b1990-143">您無法變更 [ **一般** ] 頁面的上半部。</span><span class="sxs-lookup"><span data-stu-id="b1990-143">You cannot change the upper portion of the **General** page.</span></span> <span data-ttu-id="b1990-144">您無法變更印表機驅動程式所提供的屬性頁。</span><span class="sxs-lookup"><span data-stu-id="b1990-144">You cannot change property pages provided by the printer driver.</span></span>

<span data-ttu-id="b1990-145">提供 [一般] 頁面的自訂範本：</span><span class="sxs-lookup"><span data-stu-id="b1990-145">To provide a custom template for the General page:</span></span>

1.  <span data-ttu-id="b1990-146">藉由修改 Prnsetup 檔案中指定的 PRINTDLGEXORD 範本，為 [ **一般** ] 頁面的下半部建立自訂範本。</span><span class="sxs-lookup"><span data-stu-id="b1990-146">Create a custom template for the lower portion of the **General** page by modifying the PRINTDLGEXORD template specified in the Prnsetup.dlg file.</span></span> <span data-ttu-id="b1990-147">一般而言，自訂範本的大小必須與預設範本相同。</span><span class="sxs-lookup"><span data-stu-id="b1990-147">Typically, the custom template must be the same size as the default template.</span></span> <span data-ttu-id="b1990-148">但是，如果您指定 **PD \_ USELARGETEMPLATE** 旗標來建立較大的 **一般** 頁面，就可以放大自訂範本。</span><span class="sxs-lookup"><span data-stu-id="b1990-148">However, you can enlarge the custom template if you specify the **PD\_USELARGETEMPLATE** flag to create a larger **General** page.</span></span> <span data-ttu-id="b1990-149">預設 [ **列印** ] 對話方塊範本中使用的控制項識別碼是在 Dlgs 檔中定義。</span><span class="sxs-lookup"><span data-stu-id="b1990-149">The control identifiers used in the default **Print** dialog template are defined in the Dlgs.h file.</span></span>
2.  <span data-ttu-id="b1990-150">使用 [**PRINTDLGEX**](/windows/win32/api/commdlg/ns-commdlg-printdlgexa) 結構來啟用範本，如下所示：</span><span class="sxs-lookup"><span data-stu-id="b1990-150">Use the [**PRINTDLGEX**](/windows/win32/api/commdlg/ns-commdlg-printdlgexa) structure to enable the template as follows:</span></span>
    -   <span data-ttu-id="b1990-151">如果您的自訂範本是應用程式或動態連結程式庫中的資源，請在 **旗標** 成員中設定 **PD \_ ENABLEPRINTTEMPLATE** 旗標。</span><span class="sxs-lookup"><span data-stu-id="b1990-151">If your custom template is a resource in an application or dynamic-link library, set the **PD\_ENABLEPRINTTEMPLATE** flag in the **Flags** member.</span></span> <span data-ttu-id="b1990-152">使用結構的 **hInstance** 和 **lpPrintTemplateName** 成員來識別模組和資源名稱。</span><span class="sxs-lookup"><span data-stu-id="b1990-152">Use the **hInstance** and **lpPrintTemplateName** members of the structure to identify the module and resource name.</span></span>

        <span data-ttu-id="b1990-153">-或者-</span><span class="sxs-lookup"><span data-stu-id="b1990-153">-Or-</span></span>

    -   <span data-ttu-id="b1990-154">如果您的自訂範本已在記憶體中，請設定 **PD \_ ENABLEPRINTTEMPLATEHANDLE** 旗標。</span><span class="sxs-lookup"><span data-stu-id="b1990-154">If your custom template is already in memory, set the **PD\_ENABLEPRINTTEMPLATEHANDLE** flag.</span></span> <span data-ttu-id="b1990-155">您可以使用 **hInstance** 成員來識別包含範本的記憶體物件。</span><span class="sxs-lookup"><span data-stu-id="b1990-155">Use the **hInstance** member to identify the memory object that contains the template.</span></span>

3.  <span data-ttu-id="b1990-156">如果您使用自訂範本來定義其他控制項，您必須提供回呼物件來處理控制項的輸入。</span><span class="sxs-lookup"><span data-stu-id="b1990-156">If you use a custom template to define additional controls, you must provide a callback object to process input for your controls.</span></span> <span data-ttu-id="b1990-157">回呼物件會執行 [**IPrintDialogCallback：： HandleMessage**](/windows/win32/api/commdlg/nf-commdlg-iprintdialogcallback-handlemessage) 方法，以接收傳送至自訂對話方塊的訊息。</span><span class="sxs-lookup"><span data-stu-id="b1990-157">The callback object implements a [**IPrintDialogCallback::HandleMessage**](/windows/win32/api/commdlg/nf-commdlg-iprintdialogcallback-handlemessage) method which receives messages sent to the custom dialog box.</span></span>

<span data-ttu-id="b1990-158">若要提供其他屬性頁</span><span class="sxs-lookup"><span data-stu-id="b1990-158">To provide additional property pages</span></span>

1.  <span data-ttu-id="b1990-159">使用函式來建立額外的頁面。</span><span class="sxs-lookup"><span data-stu-id="b1990-159">Use the function to create the additional pages.</span></span>
2.  <span data-ttu-id="b1990-160">您可以使用 [**PRINTDLGEX**](/windows/win32/api/commdlg/ns-commdlg-printdlgexa)結構的 **lphPropertyPages** 成員，指定其他頁面的控制碼陣列。</span><span class="sxs-lookup"><span data-stu-id="b1990-160">Use the **lphPropertyPages** member of the [**PRINTDLGEX**](/windows/win32/api/commdlg/ns-commdlg-printdlgexa) structure to specify an array of handles to the additional pages.</span></span>

    <span data-ttu-id="b1990-161">當您建立每個頁面處理傳送至頁面的訊息時，所指定的對話方塊程式。</span><span class="sxs-lookup"><span data-stu-id="b1990-161">The dialog box procedures specified when you created each page process messages sent to the pages.</span></span>

3.  <span data-ttu-id="b1990-162">您可能會想要提供可執行介面的回呼物件。</span><span class="sxs-lookup"><span data-stu-id="b1990-162">You might want to provide a callback object that implements the interface.</span></span> <span data-ttu-id="b1990-163">[**PrintDlgEx**](/previous-versions/windows/desktop/legacy/ms646942(v=vs.85))函式會使用此介面，將指向 [**IPrintDialogServices**](/windows/win32/api/commdlg/nn-commdlg-iprintdialogservices)介面的指標傳遞至應用程式。</span><span class="sxs-lookup"><span data-stu-id="b1990-163">The [**PrintDlgEx**](/previous-versions/windows/desktop/legacy/ms646942(v=vs.85)) function uses this interface to pass to the application a pointer to an [**IPrintDialogServices**](/windows/win32/api/commdlg/nn-commdlg-iprintdialogservices) interface.</span></span> <span data-ttu-id="b1990-164">其他屬性頁的對話方塊程式可以使用此介面來取得目前所選印表機的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="b1990-164">The dialog box procedures for the additional property pages can use this interface to retrieve information about the currently selected printer.</span></span>

## <a name="callback-object-for-the-print-property-sheet"></a><span data-ttu-id="b1990-165">列印屬性工作表的回呼物件</span><span class="sxs-lookup"><span data-stu-id="b1990-165">Callback Object for the Print Property Sheet</span></span>

<span data-ttu-id="b1990-166">顯示 **列印** 屬性工作表的應用程式可以執行回呼物件，以在顯示內容表時，從 [**PrintDlgEx**](/previous-versions/windows/desktop/legacy/ms646942(v=vs.85)) 函式接收通知和訊息。</span><span class="sxs-lookup"><span data-stu-id="b1990-166">An application that displays a **Print** property sheet can implement a callback object to receive notifications and messages from the [**PrintDlgEx**](/previous-versions/windows/desktop/legacy/ms646942(v=vs.85)) function while the property sheet is displayed.</span></span> <span data-ttu-id="b1990-167">若要提供回呼物件，請在 [**PRINTDLGEX**](/windows/win32/api/commdlg/ns-commdlg-printdlgexa)結構的 **lpCallback** 成員中指定物件的指標。</span><span class="sxs-lookup"><span data-stu-id="b1990-167">To provide a callback object, specify a pointer to the object in the **lpCallback** member of the [**PRINTDLGEX**](/windows/win32/api/commdlg/ns-commdlg-printdlgexa) structure.</span></span>

<span data-ttu-id="b1990-168">回呼物件必須執行 [**IPrintDialogCallback**](/windows/win32/api/commdlg/nn-commdlg-iprintdialogcallback) 介面。</span><span class="sxs-lookup"><span data-stu-id="b1990-168">The callback object must implement the [**IPrintDialogCallback**](/windows/win32/api/commdlg/nn-commdlg-iprintdialogcallback) interface.</span></span> <span data-ttu-id="b1990-169">[**PrintDlgEx**](/previous-versions/windows/desktop/legacy/ms646942(v=vs.85))函數會在下列情況下呼叫 **IPrintDialogCallback** 方法：</span><span class="sxs-lookup"><span data-stu-id="b1990-169">The [**PrintDlgEx**](/previous-versions/windows/desktop/legacy/ms646942(v=vs.85)) function calls **IPrintDialogCallback** methods in the following situations:</span></span>

-   <span data-ttu-id="b1990-170">當對話方塊已初始化時</span><span class="sxs-lookup"><span data-stu-id="b1990-170">When the dialog box has been initialized</span></span>
-   <span data-ttu-id="b1990-171">當使用者從屬性工作表所顯示的已安裝印表機清單中選取不同的印表機時</span><span class="sxs-lookup"><span data-stu-id="b1990-171">When the user selects a different printer from the list of installed printers displayed by the property sheet</span></span>
-   <span data-ttu-id="b1990-172">當它在屬性工作表的 **[一般** ] 頁面的下半部收到子對話方塊的訊息時</span><span class="sxs-lookup"><span data-stu-id="b1990-172">When it receives messages for the child dialog box in the lower portion of the property sheet's **General** page</span></span>

<span data-ttu-id="b1990-173">回呼物件也應該執行 [**IObjectWithSite**](/windows/win32/api/ocidl/nn-ocidl-iobjectwithsite) 介面。</span><span class="sxs-lookup"><span data-stu-id="b1990-173">The callback object should also implement the [**IObjectWithSite**](/windows/win32/api/ocidl/nn-ocidl-iobjectwithsite) interface.</span></span> <span data-ttu-id="b1990-174">[**PrintDlgEx**](/previous-versions/windows/desktop/legacy/ms646942(v=vs.85))函式會呼叫方法，以將 [**IPrintDialogServices**](/windows/win32/api/commdlg/nn-commdlg-iprintdialogservices)介面的指標傳遞至應用程式。</span><span class="sxs-lookup"><span data-stu-id="b1990-174">The [**PrintDlgEx**](/previous-versions/windows/desktop/legacy/ms646942(v=vs.85)) function calls the method to pass a pointer to an [**IPrintDialogServices**](/windows/win32/api/commdlg/nn-commdlg-iprintdialogservices) interface to an application.</span></span> <span data-ttu-id="b1990-175">[**IPrintDialogCallback**](/windows/win32/api/commdlg/nn-commdlg-iprintdialogcallback)方法可以使用 **IPrintDialogServices** 介面來取得目前所選印表機的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="b1990-175">The [**IPrintDialogCallback**](/windows/win32/api/commdlg/nn-commdlg-iprintdialogcallback) methods can use the **IPrintDialogServices** interface to retrieve information about the currently selected printer.</span></span> <span data-ttu-id="b1990-176">**IPrintDialogServices** 介面也適用于建立其他頁面的應用程式，以遵循 [**列印** 屬性工作表] 的 **[一般**] 頁面。</span><span class="sxs-lookup"><span data-stu-id="b1990-176">The **IPrintDialogServices** interface is also useful for applications that create additional pages to follow the **General** page of the **Print** property sheet.</span></span> <span data-ttu-id="b1990-177">其他頁面的對話方塊程式可以呼叫 **IPrintDialogServices** 方法。</span><span class="sxs-lookup"><span data-stu-id="b1990-177">The dialog box procedures for the additional pages can call **IPrintDialogServices** methods.</span></span>

 

 