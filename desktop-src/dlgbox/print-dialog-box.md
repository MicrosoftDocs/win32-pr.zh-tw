---
title: 列印對話方塊
description: '[列印] 對話方塊可讓使用者選取特定列印工作的選項。'
ms.assetid: 34f69b25-8a89-4322-af4c-a80b85a4a973
keywords:
- Windows 消費者介面，使用者輸入
- Windows 消費者介面、通用對話方塊程式庫
- 使用者輸入、通用對話方塊程式庫
- 正在捕獲使用者輸入，通用對話方塊程式庫
- 通用對話方塊程式庫
- 通用對話方塊
- 列印對話方塊
- '[列印設定] 對話方塊'
- 自訂列印對話方塊
- 預先定義的對話方塊
- 對話方塊、列印
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 4fae1dd244391ea16478a0cb4f10803cf622dc64
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/20/2020
ms.locfileid: "104093256"
---
# <a name="print-dialog-box"></a><span data-ttu-id="3b16f-114">列印對話方塊</span><span class="sxs-lookup"><span data-stu-id="3b16f-114">Print Dialog Box</span></span>

<span data-ttu-id="3b16f-115">[ **列印** ] 對話方塊可讓使用者選取特定列印工作的選項。</span><span class="sxs-lookup"><span data-stu-id="3b16f-115">The **Print** dialog box lets the user select options for a particular print job.</span></span> <span data-ttu-id="3b16f-116">例如，使用者可以指定要使用的印表機、要列印的頁面範圍，以及份數。</span><span class="sxs-lookup"><span data-stu-id="3b16f-116">For example, the user can specify the printer to use, the range of pages to print, and the number of copies.</span></span>

<span data-ttu-id="3b16f-117">您可以使用 [**PrintDlgEx**](/previous-versions/windows/desktop/legacy/ms646942(v=vs.85)) 函式來顯示 [列印屬性工作表，該工作表](print-property-sheet.md)的 **[一般** ] 頁面中包含與 [ **列印** ] 對話方塊類似的控制項。</span><span class="sxs-lookup"><span data-stu-id="3b16f-117">You can use the [**PrintDlgEx**](/previous-versions/windows/desktop/legacy/ms646942(v=vs.85)) function to display a [Print Property Sheet](print-property-sheet.md), which has a **General** page containing controls similar to the **Print** dialog box.</span></span> <span data-ttu-id="3b16f-118">在 [ **一般** ] 頁面之後，屬性工作表也可以有其他的應用程式特定和驅動程式特定的屬性頁。</span><span class="sxs-lookup"><span data-stu-id="3b16f-118">The property sheet can also have additional application-specific and driver-specific property pages following the **General** page.</span></span>

<span data-ttu-id="3b16f-119">您可以藉由初始化 [**PRINTDLG**](/windows/win32/api/commdlg/ns-commdlg-printdlga)結構並將結構傳遞至 [**PRINTDLG**](/previous-versions/windows/desktop/legacy/ms646940(v=vs.85))函式，來建立和顯示 [**列印**] 對話方塊。</span><span class="sxs-lookup"><span data-stu-id="3b16f-119">You create and display a **Print** dialog box by initializing a [**PRINTDLG**](/windows/win32/api/commdlg/ns-commdlg-printdlga) structure and passing the structure to the [**PrintDlg**](/previous-versions/windows/desktop/legacy/ms646940(v=vs.85)) function.</span></span>

<span data-ttu-id="3b16f-120">下圖顯示典型的 [ **列印** ] 對話方塊。</span><span class="sxs-lookup"><span data-stu-id="3b16f-120">The following illustration shows a typical **Print** dialog box.</span></span>

![[列印] 對話方塊](images/printdialogboxxp.png)

<span data-ttu-id="3b16f-122">如果使用者按一下 [ **確定]** 按鈕， [**PrintDlg**](/previous-versions/windows/desktop/legacy/ms646940(v=vs.85)) 會傳回 **TRUE** ，並使用 [**PrintDlg**](/windows/win32/api/commdlg/ns-commdlg-printdlga) 結構來傳回使用者選取專案的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="3b16f-122">If the user clicks the **OK** button, [**PrintDlg**](/previous-versions/windows/desktop/legacy/ms646940(v=vs.85)) returns **TRUE** and uses the [**PRINTDLG**](/windows/win32/api/commdlg/ns-commdlg-printdlga) structure to return information about the user's selections.</span></span> <span data-ttu-id="3b16f-123">例如， **hDevMode** 和 **hDevNames** 成員通常會傳回和 [**DEVNAMES**](/windows/win32/api/commdlg/ns-commdlg-devnames) 結構的全域記憶體控制碼。</span><span class="sxs-lookup"><span data-stu-id="3b16f-123">For example, the **hDevMode** and **hDevNames** members typically return global memory handles for and [**DEVNAMES**](/windows/win32/api/commdlg/ns-commdlg-devnames) structures.</span></span> <span data-ttu-id="3b16f-124">您可以使用這些結構中的資訊，建立所選印表機的裝置內容或資訊內容。</span><span class="sxs-lookup"><span data-stu-id="3b16f-124">You can use the information in these structures to create a device context or an information context for the selected printer.</span></span>

<span data-ttu-id="3b16f-125">如果使用者取消 [ **列印** ] 對話方塊或發生錯誤， [**PrintDlg**](/previous-versions/windows/desktop/legacy/ms646940(v=vs.85)) 會傳回 **FALSE**。</span><span class="sxs-lookup"><span data-stu-id="3b16f-125">If the user cancels the **Print** dialog box or an error occurs, [**PrintDlg**](/previous-versions/windows/desktop/legacy/ms646940(v=vs.85)) returns **FALSE**.</span></span> <span data-ttu-id="3b16f-126">您可以使用 [**CommDlgExtendedError**](/windows/desktop/api/Commdlg/nf-commdlg-commdlgextendederror) 函式來取出擴充的錯誤值，以判斷錯誤的原因。</span><span class="sxs-lookup"><span data-stu-id="3b16f-126">You can determine the cause of an error by using the [**CommDlgExtendedError**](/windows/desktop/api/Commdlg/nf-commdlg-commdlgextendederror) function to retrieve the extended error value.</span></span>

<span data-ttu-id="3b16f-127">[ **列印** ] 對話方塊包含一組選項按鈕的 **列印範圍** ，指出使用者是否想要列印所有頁面、頁面範圍，或只列印選取的文字。</span><span class="sxs-lookup"><span data-stu-id="3b16f-127">The **Print** dialog box includes a **Print Range** group of radio buttons that indicate whether the user wants to print all pages, a range of pages, or only the selected text.</span></span> <span data-ttu-id="3b16f-128">在呼叫 [**PrintDlg**](/previous-versions/windows/desktop/legacy/ms646940(v=vs.85))之前，您可以設定其中一個 **PD \_ allpages 提出要求**、 **pd \_ 選取專案** 或 **pd \_ PAGENUMS** 旗標，以指出一開始選取哪一個按鈕。</span><span class="sxs-lookup"><span data-stu-id="3b16f-128">Before calling [**PrintDlg**](/previous-versions/windows/desktop/legacy/ms646940(v=vs.85)), you can set one of the **PD\_ALLPAGES**, **PD\_SELECTION**, or **PD\_PAGENUMS** flags to indicate which button is initially selected.</span></span> <span data-ttu-id="3b16f-129">當 **PrintDlg** 傳回 **TRUE** 時，函式會設定其中一個旗標來表示使用者的選取專案。</span><span class="sxs-lookup"><span data-stu-id="3b16f-129">When **PrintDlg** returns **TRUE**, the function sets one of these flags to indicate the user's selections.</span></span> <span data-ttu-id="3b16f-130">如果設定了 **PD \_ PAGENUMS** ， [**PRINTDLG**](/windows/win32/api/commdlg/ns-commdlg-printdlga)結構的 **nFromPage** 和 **nToPage** 成員就會包含使用者所指定的起始和結束頁面。</span><span class="sxs-lookup"><span data-stu-id="3b16f-130">If **PD\_PAGENUMS** is set, the **nFromPage** and **nToPage** members of the [**PRINTDLG**](/windows/win32/api/commdlg/ns-commdlg-printdlga) structure contain the starting and ending pages specified by the user.</span></span> <span data-ttu-id="3b16f-131">若要停 **用**[**頁面**] 選項按鈕與其相關聯的和 **來** 編輯控制項，請設定 **PD \_ NOPAGENUMS** 旗標。</span><span class="sxs-lookup"><span data-stu-id="3b16f-131">To disable the **Pages** radio button and its associated **From** and **To** edit controls, set the **PD\_NOPAGENUMS** flag.</span></span> <span data-ttu-id="3b16f-132">若要停用 **選取範圍** 選項按鈕，請設定 **PD \_ NOSELECTION** 旗標。</span><span class="sxs-lookup"><span data-stu-id="3b16f-132">To disable the **Selection** radio button, set the **PD\_NOSELECTION** flag.</span></span>

<span data-ttu-id="3b16f-133">對話方塊中包含編輯控制項，使用者可在其中輸入要列印的份數。</span><span class="sxs-lookup"><span data-stu-id="3b16f-133">The dialog box includes an edit control in which the user can type the number of copies to print.</span></span> <span data-ttu-id="3b16f-134">如果 [**PRINTDLG**](/windows/win32/api/commdlg/ns-commdlg-printdlga)結構的 **hDevMode** 成員為非 **Null**，則結構的 **dmCopies** 成員會指定此編輯控制項的初始值。</span><span class="sxs-lookup"><span data-stu-id="3b16f-134">If the **hDevMode** member of the [**PRINTDLG**](/windows/win32/api/commdlg/ns-commdlg-printdlga) structure is non-**NULL**, the **dmCopies** member of the structure specifies the initial value for this edit control.</span></span> <span data-ttu-id="3b16f-135">如果 **hDevMode** 為 **Null**，則 **PRINTDLG** 結構的 **nCopies** 成員會指定初始值。</span><span class="sxs-lookup"><span data-stu-id="3b16f-135">If **hDevMode** is **NULL**, the **nCopies** member of the **PRINTDLG** structure specifies the initial value.</span></span> <span data-ttu-id="3b16f-136">當 [**PrintDlg**](/previous-versions/windows/desktop/legacy/ms646940(v=vs.85)) 傳回時， **nCopies** 通常表示使用者指定的複本數目。</span><span class="sxs-lookup"><span data-stu-id="3b16f-136">When [**PrintDlg**](/previous-versions/windows/desktop/legacy/ms646940(v=vs.85)) returns, **nCopies** typically indicates the number of copies specified by the user.</span></span> <span data-ttu-id="3b16f-137">但是，如果您在建立對話方塊時設定了 **PD \_ USEDEVMODECOPIESANDCOLLATE** 旗標，則 **nCopies** 在 return 時一律會設為1，而 [**DEVMODE**](/windows/win32/api/wingdi/ns-wingdi-devmodea)的 **dmCopies** 成員則表示要列印的份數。</span><span class="sxs-lookup"><span data-stu-id="3b16f-137">However, if you set the **PD\_USEDEVMODECOPIESANDCOLLATE** flag when you create the dialog box, **nCopies** is always set to 1 on return and the **dmCopies** member of [**DEVMODE**](/windows/win32/api/wingdi/ns-wingdi-devmodea) indicates the number of copies to print.</span></span>

<span data-ttu-id="3b16f-138">[ **Collate** ] 核取方塊指出如果列印多份副本，使用者是否想要 Collate 頁面。</span><span class="sxs-lookup"><span data-stu-id="3b16f-138">The **Collate** check box indicates whether the user wants to collate the pages if multiple copies are being printed.</span></span> <span data-ttu-id="3b16f-139">如果已選取 [ **collate** ] 核取方塊，則會設定 **PD \_ collate** 旗標。</span><span class="sxs-lookup"><span data-stu-id="3b16f-139">The **PD\_COLLATE** flag is set if the **Collate** check box is selected.</span></span> <span data-ttu-id="3b16f-140">如果您的應用程式不支援多個複本或模擬定序，請在 [**PRINTDLG**](/windows/win32/api/commdlg/ns-commdlg-printdlga)結構的 Flags 成員中設定 **PD \_ USEDEVMODECOPIESANDCOLLATE** 旗 **標**。</span><span class="sxs-lookup"><span data-stu-id="3b16f-140">If your application does not support multiple copies or simulated collation, set the **PD\_USEDEVMODECOPIESANDCOLLATE** flag in the **Flags** member of the [**PRINTDLG**](/windows/win32/api/commdlg/ns-commdlg-printdlga) structure.</span></span> <span data-ttu-id="3b16f-141">除非印表機驅動程式支援多個複本和定序，否則此選項會停用 [ **Collate** ] 核取方塊和 [複製] 編輯控制項的 **數目** 。</span><span class="sxs-lookup"><span data-stu-id="3b16f-141">This disables the **Collate** check box and the **Number of Copies** edit control unless the printer driver supports multiple copies and collation.</span></span>

<span data-ttu-id="3b16f-142">[ **列印到** 檔案] 核取方塊會指出使用者是否想要將輸出傳送至檔案，而不是傳送至印表機。</span><span class="sxs-lookup"><span data-stu-id="3b16f-142">The **Print To File** check box indicates whether the user wants to send output to a file rather than to a printer.</span></span> <span data-ttu-id="3b16f-143">您可以設定 **PD \_ PRINTTOFILE** 旗標，如此一來，一開始就會選取此核取方塊。</span><span class="sxs-lookup"><span data-stu-id="3b16f-143">You can set the **PD\_PRINTTOFILE** flag so the check box is initially selected.</span></span> <span data-ttu-id="3b16f-144">若要隱藏此核取方塊，請設定 **PD \_ HIDEPRINTTOFILE** 旗標。</span><span class="sxs-lookup"><span data-stu-id="3b16f-144">To hide the check box, set the **PD\_HIDEPRINTTOFILE** flag.</span></span> <span data-ttu-id="3b16f-145">若要停用，請設定 **PD \_ DISABLEPRINTTOFILE** 旗標。</span><span class="sxs-lookup"><span data-stu-id="3b16f-145">To disable it, set the **PD\_DISABLEPRINTTOFILE** flag.</span></span> <span data-ttu-id="3b16f-146">如果使用者選取 [**列印到** 檔案] 選項， [**PrintDlg**](/previous-versions/windows/desktop/legacy/ms646940(v=vs.85))會設定 **PD \_ PRINTTOFILE** 旗標，並在 [**DEVNAMES**](/windows/win32/api/commdlg/ns-commdlg-devnames)結構的 **wOutputOffset** 成員所指定的位移處傳回 "File："。</span><span class="sxs-lookup"><span data-stu-id="3b16f-146">If the user selects the **Print To File** option, [**PrintDlg**](/previous-versions/windows/desktop/legacy/ms646940(v=vs.85)) sets the **PD\_PRINTTOFILE** flag and returns "FILE:" at the offset indicated by the **wOutputOffset** member of the [**DEVNAMES**](/windows/win32/api/commdlg/ns-commdlg-devnames) structure.</span></span> <span data-ttu-id="3b16f-147">當您呼叫函式來開始列印工作時，請在結構的 **lpszOutput** 成員中指定這個 "FILE：" 字串。</span><span class="sxs-lookup"><span data-stu-id="3b16f-147">When you call the function to start the printing operation, specify this "FILE:" string in the **lpszOutput** member of the structure.</span></span> <span data-ttu-id="3b16f-148">指定這個字串會導致列印子系統查詢使用者輸入輸出檔的名稱。</span><span class="sxs-lookup"><span data-stu-id="3b16f-148">Specifying this string causes the print subsystem to query the user for the name of the output file.</span></span>

<span data-ttu-id="3b16f-149">依預設，[ **列印** ] 對話方塊一開始會顯示目前預設印表機的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="3b16f-149">By default, the **Print** dialog box initially displays information about the current default printer.</span></span> <span data-ttu-id="3b16f-150">若要顯示另一個已安裝之印表機的資訊，請初始化和 [**DEVNAMES**](/windows/win32/api/commdlg/ns-commdlg-devnames) 結構，並將全域記憶體控制碼指派給 **hDevMode** 和 **hDevNames** 成員的結構。</span><span class="sxs-lookup"><span data-stu-id="3b16f-150">To display information for another installed printer, initialize a and a [**DEVNAMES**](/windows/win32/api/commdlg/ns-commdlg-devnames) structure and assign the global memory handle to the structure to the **hDevMode** and **hDevNames** members.</span></span> <span data-ttu-id="3b16f-151">您在 [**DEVMODE**](/windows/win32/api/wingdi/ns-wingdi-devmodea)結構的 **dmDeviceName** 成員中指定的裝置名稱和 **DEVNAMES** 結構的 **wDriverOffset** 成員，都必須識別也列在 Win.ini 檔案的 [裝置] 區段中的印表機裝置 \[ \] 。</span><span class="sxs-lookup"><span data-stu-id="3b16f-151">The device name you specify in the **dmDeviceName** member of the [**DEVMODE**](/windows/win32/api/wingdi/ns-wingdi-devmodea) structure and in the **wDriverOffset** member of the **DEVNAMES** structure must identify a printer device that is also listed in the \[Devices\] section of the Win.ini file.</span></span> <span data-ttu-id="3b16f-152">如果未列出裝置， [**PrintDlg**](/previous-versions/windows/desktop/legacy/ms646940(v=vs.85)) 會傳回錯誤。</span><span class="sxs-lookup"><span data-stu-id="3b16f-152">If the device is not listed, [**PrintDlg**](/previous-versions/windows/desktop/legacy/ms646940(v=vs.85)) returns an error.</span></span>

<span data-ttu-id="3b16f-153">您可以藉由在 [**PrintDlg**](/windows/win32/api/commdlg/ns-commdlg-printdlga)結構的 **旗標** 成員中設定 **pd \_ RETURNDC** 或 **pd \_ RETURNIC** 旗標，指示 [**PrintDlg**](/previous-versions/windows/desktop/legacy/ms646940(v=vs.85))建立印表機的裝置內容或資訊內容。</span><span class="sxs-lookup"><span data-stu-id="3b16f-153">You can direct [**PrintDlg**](/previous-versions/windows/desktop/legacy/ms646940(v=vs.85)) to create a device context or information context for the printer by setting the **PD\_RETURNDC** or **PD\_RETURNIC** flag in the **Flags** member of the [**PRINTDLG**](/windows/win32/api/commdlg/ns-commdlg-printdlga) structure.</span></span> <span data-ttu-id="3b16f-154">函數會將控制碼傳回給 **hDC** 成員中的裝置內容或資訊內容。</span><span class="sxs-lookup"><span data-stu-id="3b16f-154">The function returns a handle to the device context or information context in the **hDC** member.</span></span> <span data-ttu-id="3b16f-155">如果您使用 **PD \_ RETURNDC** 旗標，您可以使用裝置內容來產生印表機的輸出。</span><span class="sxs-lookup"><span data-stu-id="3b16f-155">If you use the **PD\_RETURNDC** flag, you can use the device context to generate output for the printer.</span></span>

<span data-ttu-id="3b16f-156">若要取出預設印表機的相關資訊，而不顯示 [ **列印** ] 對話方塊，請設定 [ **PD \_ RETURNDEFAULT** 旗標]。</span><span class="sxs-lookup"><span data-stu-id="3b16f-156">To retrieve information about the default printer without displaying the **Print** dialog box, set the **PD\_RETURNDEFAULT** flag.</span></span> <span data-ttu-id="3b16f-157">在此情況下， [**PrintDlg**](/previous-versions/windows/desktop/legacy/ms646940(v=vs.85)) 會在將 **hDevMode** 和 **hDevNames** 成員設定為包含資訊之結構的控制碼之後立即傳回。</span><span class="sxs-lookup"><span data-stu-id="3b16f-157">In this case, [**PrintDlg**](/previous-versions/windows/desktop/legacy/ms646940(v=vs.85)) returns immediately after setting the **hDevMode** and **hDevNames** members to handles for structures containing the information.</span></span>

<span data-ttu-id="3b16f-158">依預設， [**PrintDlg**](/previous-versions/windows/desktop/legacy/ms646940(v=vs.85)) 會在發生錯誤時顯示訊息方塊。</span><span class="sxs-lookup"><span data-stu-id="3b16f-158">By default, [**PrintDlg**](/previous-versions/windows/desktop/legacy/ms646940(v=vs.85)) displays message boxes when errors occur.</span></span> <span data-ttu-id="3b16f-159">例如，如果沒有安裝印表機，此函式會顯示錯誤訊息。</span><span class="sxs-lookup"><span data-stu-id="3b16f-159">For example, the function displays an error message if no printers are installed.</span></span> <span data-ttu-id="3b16f-160">若要防止函式顯示這些警告訊息，請設定 **PD \_ NOWARNING** 旗標。</span><span class="sxs-lookup"><span data-stu-id="3b16f-160">To prevent the function from displaying these warning messages, set the **PD\_NOWARNING** flag.</span></span>

<span data-ttu-id="3b16f-161">本節將討論下列主題。</span><span class="sxs-lookup"><span data-stu-id="3b16f-161">The following topics are discussed in this section.</span></span>

-   [<span data-ttu-id="3b16f-162">自訂列印對話方塊</span><span class="sxs-lookup"><span data-stu-id="3b16f-162">Customizing the Print Dialog Box</span></span>](#customizing-the-print-dialog-box)
-   <span data-ttu-id="3b16f-163">[[列印設定] 對話方塊](#print-setup-dialog-box)</span><span class="sxs-lookup"><span data-stu-id="3b16f-163">[Print Setup Dialog Box](#print-setup-dialog-box)</span></span>

## <a name="customizing-the-print-dialog-box"></a><span data-ttu-id="3b16f-164">自訂列印對話方塊</span><span class="sxs-lookup"><span data-stu-id="3b16f-164">Customizing the Print Dialog Box</span></span>

<span data-ttu-id="3b16f-165">您可以提供 [ **列印** ] 對話方塊的自訂範本，例如，如果您想要包含應用程式特有的其他控制項。</span><span class="sxs-lookup"><span data-stu-id="3b16f-165">You can provide a custom template for the **Print** dialog box, for example, if you want to include additional controls that are unique to your application.</span></span> <span data-ttu-id="3b16f-166">[**PrintDlg**](/previous-versions/windows/desktop/legacy/ms646940(v=vs.85))函式會使用您的自訂範本來取代預設範本。</span><span class="sxs-lookup"><span data-stu-id="3b16f-166">The [**PrintDlg**](/previous-versions/windows/desktop/legacy/ms646940(v=vs.85)) function uses your custom template in place of the default template.</span></span>

<span data-ttu-id="3b16f-167">若要提供 [ **列印** ] 對話方塊的自訂範本：</span><span class="sxs-lookup"><span data-stu-id="3b16f-167">To provide a custom template for the **Print** dialog box:</span></span>

1.  <span data-ttu-id="3b16f-168">藉由修改 Prnsetup 檔案中指定的預設範本來建立自訂範本。</span><span class="sxs-lookup"><span data-stu-id="3b16f-168">Create the custom template by modifying the default template specified in the Prnsetup.dlg file.</span></span> <span data-ttu-id="3b16f-169">預設 [ **列印** ] 對話方塊範本中使用的控制項識別碼是在 Dlgs 檔中定義。</span><span class="sxs-lookup"><span data-stu-id="3b16f-169">The control identifiers used in the default **Print** dialog template are defined in the Dlgs.h file.</span></span>
2.  <span data-ttu-id="3b16f-170">使用 [**PRINTDLG**](/windows/win32/api/commdlg/ns-commdlg-printdlga) 結構來啟用範本，如下所示：</span><span class="sxs-lookup"><span data-stu-id="3b16f-170">Use the [**PRINTDLG**](/windows/win32/api/commdlg/ns-commdlg-printdlga) structure to enable the template as follows:</span></span>
    -   <span data-ttu-id="3b16f-171">如果您的自訂範本是應用程式或動態連結程式庫中的資源，請在 **旗標** 成員中設定 **PD \_ ENABLEPRINTTEMPLATE** 旗標。</span><span class="sxs-lookup"><span data-stu-id="3b16f-171">If your custom template is a resource in an application or dynamic-link library, set the **PD\_ENABLEPRINTTEMPLATE** flag in the **Flags** member.</span></span> <span data-ttu-id="3b16f-172">使用結構的 **hInstance** 和 **lpPrintTemplateName** 成員來識別模組和資源名稱。</span><span class="sxs-lookup"><span data-stu-id="3b16f-172">Use the **hInstance** and **lpPrintTemplateName** members of the structure to identify the module and resource name.</span></span>

        <span data-ttu-id="3b16f-173">-或者-</span><span class="sxs-lookup"><span data-stu-id="3b16f-173">-Or-</span></span>

    -   <span data-ttu-id="3b16f-174">如果您的自訂範本已在記憶體中，請設定 **PD \_ ENABLEPRINTTEMPLATEHANDLE** 旗標。</span><span class="sxs-lookup"><span data-stu-id="3b16f-174">If your custom template is already in memory, set the **PD\_ENABLEPRINTTEMPLATEHANDLE** flag.</span></span> <span data-ttu-id="3b16f-175">您可以使用 **hPrintTemplate** 成員來識別包含範本的記憶體物件。</span><span class="sxs-lookup"><span data-stu-id="3b16f-175">Use the **hPrintTemplate** member to identify the memory object that contains the template.</span></span>

<span data-ttu-id="3b16f-176">您可以為 [**列印**] 對話方塊提供 [**PrintHookProc**](/windows/win32/api/commdlg/nc-commdlg-lpprinthookproc)攔截程式。</span><span class="sxs-lookup"><span data-stu-id="3b16f-176">You can provide a [**PrintHookProc**](/windows/win32/api/commdlg/nc-commdlg-lpprinthookproc) hook procedure for the **Print** dialog box.</span></span> <span data-ttu-id="3b16f-177">攔截程式可以處理傳送至對話方塊的訊息。</span><span class="sxs-lookup"><span data-stu-id="3b16f-177">The hook procedure can process messages sent to the dialog box.</span></span> <span data-ttu-id="3b16f-178">它也可以將訊息傳送至對話方塊。</span><span class="sxs-lookup"><span data-stu-id="3b16f-178">It can also send messages to the dialog box.</span></span> <span data-ttu-id="3b16f-179">如果您使用自訂範本來定義其他控制項，您必須提供攔截程式來處理控制項的輸入。</span><span class="sxs-lookup"><span data-stu-id="3b16f-179">If you use a custom template to define additional controls, you must provide a hook procedure to process input for your controls.</span></span>

<span data-ttu-id="3b16f-180">若要針對 [ **列印** ] 對話方塊啟用攔截程式：</span><span class="sxs-lookup"><span data-stu-id="3b16f-180">To enable a hook procedure for the **Print** dialog box:</span></span>

1.  <span data-ttu-id="3b16f-181">在 [**PRINTDLG**](/windows/win32/api/commdlg/ns-commdlg-printdlga)結構的 Flags 成員中設定 **PD \_ ENABLEPRINTHOOK** 旗 **標**。</span><span class="sxs-lookup"><span data-stu-id="3b16f-181">Set the **PD\_ENABLEPRINTHOOK** flag in the **Flags** member of the [**PRINTDLG**](/windows/win32/api/commdlg/ns-commdlg-printdlga) structure.</span></span>
2.  <span data-ttu-id="3b16f-182">在 **lpfnPrintHook** 成員中指定攔截程式的位址。</span><span class="sxs-lookup"><span data-stu-id="3b16f-182">Specify the address of the hook procedure in the **lpfnPrintHook** member.</span></span>

<span data-ttu-id="3b16f-183">處理其 [**WM \_ INITDIALOG**](wm-initdialog.md) 訊息之後，對話方塊程式會將 **wm \_ INITDIALOG** 訊息傳送到攔截程式。</span><span class="sxs-lookup"><span data-stu-id="3b16f-183">After processing its [**WM\_INITDIALOG**](wm-initdialog.md) message, the dialog box procedure sends a **WM\_INITDIALOG** message to the hook procedure.</span></span> <span data-ttu-id="3b16f-184">此訊息的 *lParam* 參數是用來初始化對話方塊之 [**PRINTDLG**](/windows/win32/api/commdlg/ns-commdlg-printdlga) 結構的指標。</span><span class="sxs-lookup"><span data-stu-id="3b16f-184">The *lParam* parameter of this message is a pointer to the [**PRINTDLG**](/windows/win32/api/commdlg/ns-commdlg-printdlga) structure used to initialize the dialog box.</span></span>

## <a name="print-setup-dialog-box"></a><span data-ttu-id="3b16f-185">[列印設定] 對話方塊</span><span class="sxs-lookup"><span data-stu-id="3b16f-185">Print Setup Dialog Box</span></span>

<span data-ttu-id="3b16f-186">您可以藉由在 [**PrintDlg**](/previous-versions/windows/desktop/legacy/ms646940(v=vs.85))函式的呼叫中設定 **PD \_ PRINTSETUP** 旗標，來建立和顯示 [**列印設定**] 對話方塊。</span><span class="sxs-lookup"><span data-stu-id="3b16f-186">You can create and display a **Print Setup** dialog box by setting the **PD\_PRINTSETUP** flag in a call to the [**PrintDlg**](/previous-versions/windows/desktop/legacy/ms646940(v=vs.85)) function.</span></span> <span data-ttu-id="3b16f-187">不過，[ **列印設定** ] 對話方塊已被 [版面 **設定** ] 對話方塊取代，而且不應該用於新的應用程式。</span><span class="sxs-lookup"><span data-stu-id="3b16f-187">However, the **Print Setup** dialog box has been superseded by the **Page Setup** dialog box and should not be used in new applications.</span></span>

<span data-ttu-id="3b16f-188">下列旗標只適用于 [ **列印設定** ] 對話方塊：</span><span class="sxs-lookup"><span data-stu-id="3b16f-188">The following flags apply only to the **Print Setup** dialog box:</span></span>

-   <span data-ttu-id="3b16f-189">**PD \_ ENABLESETUPHOOK**</span><span class="sxs-lookup"><span data-stu-id="3b16f-189">**PD\_ENABLESETUPHOOK**</span></span>
-   <span data-ttu-id="3b16f-190">**PD \_ ENABLESETUPTEMPLATE**</span><span class="sxs-lookup"><span data-stu-id="3b16f-190">**PD\_ENABLESETUPTEMPLATE**</span></span>
-   <span data-ttu-id="3b16f-191">**PD \_ ENABLESETUPTEMPLATEHANDLE**</span><span class="sxs-lookup"><span data-stu-id="3b16f-191">**PD\_ENABLESETUPTEMPLATEHANDLE**</span></span>

 

 