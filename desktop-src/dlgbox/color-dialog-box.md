---
title: 色彩對話方塊
description: 顯示模式對話方塊，讓使用者可以選擇特定的色彩值。
ms.assetid: 248586b5-5068-4021-8407-56eb79243789
keywords:
- 使用者輸入、通用對話方塊程式庫
- 正在捕獲使用者輸入，通用對話方塊程式庫
- 通用對話方塊程式庫
- 通用對話方塊
- '[色彩] 對話方塊'
- 部分色彩對話方塊
- '[完整色彩] 對話方塊'
- 自訂色彩對話方塊
- RGB 色彩模型
- HSL 色彩模型
- '色調飽和度亮度 (HSL) '
- 'HSL (色調飽和度亮度) '
- 'RGB (red 綠 blue) '
- '紅色綠色藍色 (RGB) '
- '[勾點]，[色彩] 對話方塊'
- 預先定義的對話方塊
- 對話方塊、色彩
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 4bb90150f49ea7bed4edac53af40ba89e0459946
ms.sourcegitcommit: 56f8e4d5119e5018363fa2dc3472cdff203c6913
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 11/19/2020
ms.locfileid: "104553497"
---
# <a name="color-dialog-box"></a><span data-ttu-id="34404-120">色彩對話方塊</span><span class="sxs-lookup"><span data-stu-id="34404-120">Color Dialog Box</span></span>

<span data-ttu-id="34404-121">顯示模式對話方塊，讓使用者可以選擇特定的色彩值。</span><span class="sxs-lookup"><span data-stu-id="34404-121">Displays a modal dialog box that allows the user to choose a specific color value.</span></span> <span data-ttu-id="34404-122">使用者可以從一組基本或自訂調色盤中選擇色彩。</span><span class="sxs-lookup"><span data-stu-id="34404-122">The user can choose a color from either a set of basic or custom color palettes.</span></span> <span data-ttu-id="34404-123">或者，使用者也可以藉由修改對話方塊使用者介面的 RGB 或色調、飽和度、亮度 (HSL) 色彩值來產生色彩值。</span><span class="sxs-lookup"><span data-stu-id="34404-123">Alternatively, the user can generate a color value by modifying the RGB or hue, saturation, luminosity (HSL) color values of the dialog box user interface.</span></span> <span data-ttu-id="34404-124">[ **色彩** ] 對話方塊會傳回使用者所選取之色彩的 RGB 值。</span><span class="sxs-lookup"><span data-stu-id="34404-124">The **Color** dialog box returns the RGB value of the color selected by the user.</span></span>

<span data-ttu-id="34404-125">您可以藉由初始化 [**CHOOSECOLOR**](/windows/win32/api/commdlg/ns-commdlg-choosecolora-r1)結構並將結構傳遞至 [**CHOOSECOLOR**](/previous-versions/windows/desktop/legacy/ms646912(v=vs.85))函式，來建立和顯示 [**色彩**] 對話方塊。</span><span class="sxs-lookup"><span data-stu-id="34404-125">You create and display a **Color** dialog box by initializing a [**CHOOSECOLOR**](/windows/win32/api/commdlg/ns-commdlg-choosecolora-r1) structure and passing the structure to the [**ChooseColor**](/previous-versions/windows/desktop/legacy/ms646912(v=vs.85)) function.</span></span> <span data-ttu-id="34404-126">藉由為 **CHOOSECOLOR** 結構設定不同的參數值，您可以影響 [色彩] 對話方塊的顯示方式。</span><span class="sxs-lookup"><span data-stu-id="34404-126">By setting different parameter values for the **CHOOSECOLOR** structure, you can affect how the Color dialog box appears.</span></span> <span data-ttu-id="34404-127">例如，您可以顯示對話方塊的完整或部分使用者介面版本。</span><span class="sxs-lookup"><span data-stu-id="34404-127">For example, you can display either a full or partial user interface version of the dialog box.</span></span> <span data-ttu-id="34404-128">下圖顯示 [ **色彩** ] 對話方塊的完整使用者介面版本。</span><span class="sxs-lookup"><span data-stu-id="34404-128">The following illustration shows the full user interface version of the **Color** dialog box.</span></span>

![色彩對話方塊](images/colordialogboxxp.png)

<span data-ttu-id="34404-130">如果使用者按一下 [ **確定]** 按鈕， [**ChooseColor**](/previous-versions/windows/desktop/legacy/ms646912(v=vs.85)) 會傳回 **TRUE**。</span><span class="sxs-lookup"><span data-stu-id="34404-130">If the user clicks the **OK** button, [**ChooseColor**](/previous-versions/windows/desktop/legacy/ms646912(v=vs.85)) returns **TRUE**.</span></span> <span data-ttu-id="34404-131">[**CHOOSECOLOR**](/windows/win32/api/commdlg/ns-commdlg-choosecolora-r1)結構的 **rgbResult** 成員包含使用者所選取之色彩的 RGB 色彩值。</span><span class="sxs-lookup"><span data-stu-id="34404-131">The **rgbResult** member of the [**CHOOSECOLOR**](/windows/win32/api/commdlg/ns-commdlg-choosecolora-r1) structure contains the RGB color value of the color selected by the user.</span></span> <span data-ttu-id="34404-132">RGB 色彩值會指定組成所選色彩之個別紅色、綠色和藍色色彩的濃度。</span><span class="sxs-lookup"><span data-stu-id="34404-132">The RGB color value specifies the intensities of the individual red, green, and blue colors that make up the selected color.</span></span> <span data-ttu-id="34404-133">個別的值範圍從0到255。</span><span class="sxs-lookup"><span data-stu-id="34404-133">The individual values range from 0 through 255.</span></span> <span data-ttu-id="34404-134">使用 [**GetRValue**](/windows/desktop/api/wingdi/nf-wingdi-getrvalue)、 [**GetGValue**](/windows/desktop/api/wingdi/nf-wingdi-getgvalue)和 [**GetBValue**](/windows/desktop/api/wingdi/nf-wingdi-getbvalue) 宏從 RGB 色彩值解壓縮個別色彩。</span><span class="sxs-lookup"><span data-stu-id="34404-134">Use the [**GetRValue**](/windows/desktop/api/wingdi/nf-wingdi-getrvalue), [**GetGValue**](/windows/desktop/api/wingdi/nf-wingdi-getgvalue), and [**GetBValue**](/windows/desktop/api/wingdi/nf-wingdi-getbvalue) macros to extract individual colors from an RGB color value.</span></span>

<span data-ttu-id="34404-135">如果使用者取消 [ **色彩** ] 對話方塊或發生錯誤， [**ChooseColor**](/previous-versions/windows/desktop/legacy/ms646912(v=vs.85)) 會傳回 **FALSE** ，且不會定義 **rgbResult** 成員。</span><span class="sxs-lookup"><span data-stu-id="34404-135">If the user cancels the **Color** dialog box or an error occurs, [**ChooseColor**](/previous-versions/windows/desktop/legacy/ms646912(v=vs.85)) returns **FALSE** and the **rgbResult** member is not defined.</span></span> <span data-ttu-id="34404-136">若要判斷錯誤的原因，請呼叫 [**CommDlgExtendedError**](/windows/desktop/api/Commdlg/nf-commdlg-commdlgextendederror) 函式來取出擴充的錯誤值。</span><span class="sxs-lookup"><span data-stu-id="34404-136">To determine the cause of the error, call the [**CommDlgExtendedError**](/windows/desktop/api/Commdlg/nf-commdlg-commdlgextendederror) function to retrieve the extended error value.</span></span>

<span data-ttu-id="34404-137">本節涵蓋下列主題</span><span class="sxs-lookup"><span data-stu-id="34404-137">The following subjects are covered in this section</span></span>

-   [<span data-ttu-id="34404-138">完整和部分色彩對話方塊</span><span class="sxs-lookup"><span data-stu-id="34404-138">Full and Partial Color Dialog Boxes</span></span>](#full-and-partial-color-dialog-boxes)
-   [<span data-ttu-id="34404-139">自訂色彩對話方塊</span><span class="sxs-lookup"><span data-stu-id="34404-139">Customizing the Color Dialog Box</span></span>](#customizing-the-color-dialog-box)
    -   <span data-ttu-id="34404-140">[提供 [色彩] 對話方塊的自訂範本](#to-provide-a-custom-template-for-the-color-dialog-box)</span><span class="sxs-lookup"><span data-stu-id="34404-140">[To provide a custom template for the Color dialog box](#to-provide-a-custom-template-for-the-color-dialog-box)</span></span>
    -   <span data-ttu-id="34404-141">[若要啟用 [色彩] 對話方塊的勾點程式](#to-enable-a-hook-procedure-for-the-color-dialog-box)</span><span class="sxs-lookup"><span data-stu-id="34404-141">[To enable a hook procedure for the Color dialog box](#to-enable-a-hook-procedure-for-the-color-dialog-box)</span></span>
-   [<span data-ttu-id="34404-142">色彩對話方塊所使用的色彩模型</span><span class="sxs-lookup"><span data-stu-id="34404-142">Color Models Used by the Color Dialog Box</span></span>](#color-models-used-by-the-color-dialog-box)
    -   [<span data-ttu-id="34404-143">RGB 色彩模型</span><span class="sxs-lookup"><span data-stu-id="34404-143">RGB Color Model</span></span>](#rgb-color-model)
    -   [<span data-ttu-id="34404-144">HSL 色彩模型</span><span class="sxs-lookup"><span data-stu-id="34404-144">HSL Color Model</span></span>](#hsl-color-model)
    -   [<span data-ttu-id="34404-145">將 HSL 值轉換為 RGB 值</span><span class="sxs-lookup"><span data-stu-id="34404-145">Converting HSL Values to RGB Values</span></span>](#converting-hsl-values-to-rgb-values)

## <a name="full-and-partial-color-dialog-boxes"></a><span data-ttu-id="34404-146">完整和部分色彩對話方塊</span><span class="sxs-lookup"><span data-stu-id="34404-146">Full and Partial Color Dialog Boxes</span></span>

<span data-ttu-id="34404-147">[色彩] 對話方塊具有完整的版本和部分的使用者介面版本。</span><span class="sxs-lookup"><span data-stu-id="34404-147">The Color dialog box has a full version and a partial version of the user interface.</span></span> <span data-ttu-id="34404-148">完整版本包含基本控制項，而且具有可讓使用者建立自訂色彩的其他控制項。</span><span class="sxs-lookup"><span data-stu-id="34404-148">The full version includes the basic controls and has additional controls that allow the user to create custom colors.</span></span> <span data-ttu-id="34404-149">部分版本具有可顯示基本和自訂色彩調色板的控制項，使用者可以從中選取色彩值。</span><span class="sxs-lookup"><span data-stu-id="34404-149">The partial version has controls that display the basic and custom color palettes from which the user can select a color value.</span></span>

<span data-ttu-id="34404-150">[色彩] 對話方塊的部分版本包含 [ **定義自訂色彩** ] 按鈕。</span><span class="sxs-lookup"><span data-stu-id="34404-150">The partial version of the Color dialog box includes a **Define Custom Colors** button.</span></span> <span data-ttu-id="34404-151">使用者可以按一下此按鈕以顯示完整的版本。</span><span class="sxs-lookup"><span data-stu-id="34404-151">The user can click this button to display the full version.</span></span> <span data-ttu-id="34404-152">您可以藉由在 [**CHOOSECOLOR**](/windows/win32/api/commdlg/ns-commdlg-choosecolora-r1)結構的 **旗標** 成員中設定 **CC \_ FULLOPEN** 旗標，指示 [色彩] 對話方塊一律顯示完整版本。</span><span class="sxs-lookup"><span data-stu-id="34404-152">You can direct the Color dialog box to always display the full version by setting the **CC\_FULLOPEN** flag in the **Flags** member of the [**CHOOSECOLOR**](/windows/win32/api/commdlg/ns-commdlg-choosecolora-r1) structure.</span></span> <span data-ttu-id="34404-153">若要防止使用者建立自訂色彩，您可以設定 **CC \_ PREVENTFULLOPEN** 旗標來停用 [ **定義自訂色彩** ] 按鈕。</span><span class="sxs-lookup"><span data-stu-id="34404-153">To prevent the user from creating custom colors, you can set the **CC\_PREVENTFULLOPEN** flag to disable the **Define Custom Colors** button.</span></span>

<span data-ttu-id="34404-154">基本色彩代表指定裝置上可用的色彩選項。</span><span class="sxs-lookup"><span data-stu-id="34404-154">The basic colors represent a selection of the colors available on the specified device.</span></span> <span data-ttu-id="34404-155">實際顯示的色彩數目是由顯示驅動程式所決定。</span><span class="sxs-lookup"><span data-stu-id="34404-155">The actual number of colors displayed is determined by the display driver.</span></span> <span data-ttu-id="34404-156">例如，VGA 驅動程式會顯示48色彩，而單色顯示驅動程式只會顯示16。</span><span class="sxs-lookup"><span data-stu-id="34404-156">For example, a VGA driver displays 48 colors, and a monochrome display driver displays only 16.</span></span>

<span data-ttu-id="34404-157">自訂色彩是您指定或使用者建立的色彩。</span><span class="sxs-lookup"><span data-stu-id="34404-157">The custom colors are those that you specify or that the user creates.</span></span> <span data-ttu-id="34404-158">當您建立 [色彩] 對話方塊時，您必須使用 [**CHOOSECOLOR**](/windows/win32/api/commdlg/ns-commdlg-choosecolora-r1)結構的 **lpCustColors** 成員來指定16個自訂色彩的初始值。</span><span class="sxs-lookup"><span data-stu-id="34404-158">When you create a Color dialog box, you must use the **lpCustColors** member of the [**CHOOSECOLOR**](/windows/win32/api/commdlg/ns-commdlg-choosecolora-r1) structure to specify the initial values for the 16 custom colors.</span></span> <span data-ttu-id="34404-159">如果已開啟 [色彩] 對話方塊的完整版本，則使用者可以使用下列其中一種方法來建立自訂色彩：</span><span class="sxs-lookup"><span data-stu-id="34404-159">If the full version of the Color dialog box is open, the user can create a custom color by one the following methods:</span></span>

-   <span data-ttu-id="34404-160">將游標移至色譜控制項和亮度投影片控制項</span><span class="sxs-lookup"><span data-stu-id="34404-160">Moving the cursor in the color spectrum control and the luminosity slide control</span></span>
-   <span data-ttu-id="34404-161">在 **紅色**、 **綠色** 和 **藍色** 編輯控制項中輸入 RGB 值</span><span class="sxs-lookup"><span data-stu-id="34404-161">Typing RGB values in the **Red**, **Green**, and **Blue** edit controls</span></span>
-   <span data-ttu-id="34404-162">在 **色調**、 **飽和度** 和 **亮度** 編輯控制項中輸入 HSL 值</span><span class="sxs-lookup"><span data-stu-id="34404-162">Typing HSL values in the **Hue**, **Sat**, and **Lum** edit controls</span></span>

<span data-ttu-id="34404-163">若要將新的自訂色彩加入自訂色彩顯示，使用者可以按一下 [ **加入自訂色彩** ] 按鈕。</span><span class="sxs-lookup"><span data-stu-id="34404-163">To add a new custom color to the custom colors display, the user can click the **Add to Custom Colors** button.</span></span> <span data-ttu-id="34404-164">這也會讓對話方塊將新色彩的 RGB 值複製到 **lpCustColors** 成員所指向陣列中的對應元素。</span><span class="sxs-lookup"><span data-stu-id="34404-164">This also causes the dialog box to copy the RGB value of the new color to the corresponding element in the array pointed to by the **lpCustColors** member.</span></span> <span data-ttu-id="34404-165">若要在呼叫 [**ChooseColor**](/previous-versions/windows/desktop/legacy/ms646912(v=vs.85))之間保留新的自訂色彩，您應該為數組配置靜態記憶體。</span><span class="sxs-lookup"><span data-stu-id="34404-165">To preserve new custom colors between calls to [**ChooseColor**](/previous-versions/windows/desktop/legacy/ms646912(v=vs.85)), you should allocate static memory for the array.</span></span> <span data-ttu-id="34404-166">如需 RGB 和 HSL 色彩模型的詳細資訊，請參閱 [[色彩] 對話方塊所使用的色彩模型](#color-models-used-by-the-color-dialog-box)。</span><span class="sxs-lookup"><span data-stu-id="34404-166">For more information about the RGB and HSL color models, see [Color Models Used by the Color Dialog Box](#color-models-used-by-the-color-dialog-box).</span></span>

## <a name="customizing-the-color-dialog-box"></a><span data-ttu-id="34404-167">自訂色彩對話方塊</span><span class="sxs-lookup"><span data-stu-id="34404-167">Customizing the Color Dialog Box</span></span>

<span data-ttu-id="34404-168">若要自訂 [色彩] 對話方塊，您可以使用下列任何一種方法：</span><span class="sxs-lookup"><span data-stu-id="34404-168">To customize a Color dialog box, you can use any of the following methods:</span></span>

-   <span data-ttu-id="34404-169">當您建立對話方塊時，在 [**CHOOSECOLOR**](/windows/win32/api/commdlg/ns-commdlg-choosecolora-r1) 結構中指定值</span><span class="sxs-lookup"><span data-stu-id="34404-169">Specify values in the [**CHOOSECOLOR**](/windows/win32/api/commdlg/ns-commdlg-choosecolora-r1) structure when you create the dialog box</span></span>
-   <span data-ttu-id="34404-170">提供自訂範本</span><span class="sxs-lookup"><span data-stu-id="34404-170">Provide a custom template</span></span>
-   <span data-ttu-id="34404-171">提供勾點程式</span><span class="sxs-lookup"><span data-stu-id="34404-171">Provide a hook procedure</span></span>

<span data-ttu-id="34404-172">您可以在 [**CHOOSECOLOR**](/windows/win32/api/commdlg/ns-commdlg-choosecolora-r1)結構的 **旗標** 成員中設定旗標，以修改 [色彩] 對話方塊的外觀和行為。</span><span class="sxs-lookup"><span data-stu-id="34404-172">You can modify the appearance and behavior of the Color dialog box by setting flags in the **Flags** member of the [**CHOOSECOLOR**](/windows/win32/api/commdlg/ns-commdlg-choosecolora-r1) structure.</span></span> <span data-ttu-id="34404-173">例如，您可以設定 **CC \_ SOLIDCOLOR** 旗標，指示對話方塊只顯示純色。</span><span class="sxs-lookup"><span data-stu-id="34404-173">For example, you can set the **CC\_SOLIDCOLOR** flag to direct the dialog box to display only solid colors.</span></span> <span data-ttu-id="34404-174">若要讓對話方塊一開始選取黑色以外的色彩，請設定 **CC \_ RGBINIT** 旗標，並在 **rgbResult** 成員中指定色彩。</span><span class="sxs-lookup"><span data-stu-id="34404-174">To cause the dialog box to initially select a color other than black, set the **CC\_RGBINIT** flag and specify a color in the **rgbResult** member.</span></span>

<span data-ttu-id="34404-175">您可以提供 [色彩] 對話方塊的自訂範本，例如，如果您想要包含應用程式特有的其他控制項。</span><span class="sxs-lookup"><span data-stu-id="34404-175">You can provide a custom template for the Color dialog box, for example, if you want to include additional controls that are unique to your application.</span></span> <span data-ttu-id="34404-176">[**ChooseColor**](/previous-versions/windows/desktop/legacy/ms646912(v=vs.85))函式會使用您的自訂範本來取代預設範本。</span><span class="sxs-lookup"><span data-stu-id="34404-176">The [**ChooseColor**](/previous-versions/windows/desktop/legacy/ms646912(v=vs.85)) function uses your custom template in place of the default template.</span></span>

### <a name="to-provide-a-custom-template-for-the-color-dialog-box"></a><span data-ttu-id="34404-177">提供 [色彩] 對話方塊的自訂範本</span><span class="sxs-lookup"><span data-stu-id="34404-177">To provide a custom template for the Color dialog box</span></span>

1.  <span data-ttu-id="34404-178">藉由修改在 $. d 檔案中指定的預設範本來建立自訂範本。</span><span class="sxs-lookup"><span data-stu-id="34404-178">Create the custom template by modifying the default template specified in the Color.dlg file.</span></span> <span data-ttu-id="34404-179">在 [預設色彩] 對話方塊範本中使用的控制項識別碼是在 [中] 檔案中定義。</span><span class="sxs-lookup"><span data-stu-id="34404-179">The control identifiers used in the default Color dialog template are defined in the Color.dlg file.</span></span>
2.  <span data-ttu-id="34404-180">使用 [**CHOOSECOLOR**](/windows/win32/api/commdlg/ns-commdlg-choosecolora-r1) 結構來啟用範本，如下所示：</span><span class="sxs-lookup"><span data-stu-id="34404-180">Use the [**CHOOSECOLOR**](/windows/win32/api/commdlg/ns-commdlg-choosecolora-r1) structure to enable the template as follows:</span></span>
    -   <span data-ttu-id="34404-181">如果您的自訂範本是應用程式或動態連結程式庫中的資源，請在 **旗標** 成員中設定 **CC \_ ENABLETEMPLATE** 旗標。</span><span class="sxs-lookup"><span data-stu-id="34404-181">If your custom template is a resource in an application or dynamic link library, set the **CC\_ENABLETEMPLATE** flag in the **Flags** member.</span></span> <span data-ttu-id="34404-182">使用結構的 **hInstance** 和 **lpTemplateName** 成員來識別模組和資源名稱。</span><span class="sxs-lookup"><span data-stu-id="34404-182">Use the **hInstance** and **lpTemplateName** members of the structure to identify the module and resource name.</span></span>

        <span data-ttu-id="34404-183">-或者-</span><span class="sxs-lookup"><span data-stu-id="34404-183">-Or-</span></span>

    -   <span data-ttu-id="34404-184">如果您的自訂範本已在記憶體中，請設定 **CC \_ ENABLETEMPLATEHANDLE** 旗標。</span><span class="sxs-lookup"><span data-stu-id="34404-184">If your custom template is already in memory, set the **CC\_ENABLETEMPLATEHANDLE** flag.</span></span> <span data-ttu-id="34404-185">您可以使用 **hInstance** 成員來識別包含範本的記憶體物件。</span><span class="sxs-lookup"><span data-stu-id="34404-185">Use the **hInstance** member to identify the memory object that contains the template.</span></span>

<span data-ttu-id="34404-186">您可以針對 [色彩] 對話方塊提供 [**CCHookProc**](/windows/win32/api/commdlg/nc-commdlg-lpcchookproc) 的勾點程式。</span><span class="sxs-lookup"><span data-stu-id="34404-186">You can provide a [**CCHookProc**](/windows/win32/api/commdlg/nc-commdlg-lpcchookproc) hook procedure for the Color dialog box.</span></span> <span data-ttu-id="34404-187">攔截程式可以處理傳送至對話方塊的訊息。</span><span class="sxs-lookup"><span data-stu-id="34404-187">The hook procedure can process messages sent to the dialog box.</span></span> <span data-ttu-id="34404-188">它也可以使用已註冊的訊息來控制對話方塊的行為。</span><span class="sxs-lookup"><span data-stu-id="34404-188">It can also use registered messages to control the behavior of the dialog box.</span></span> <span data-ttu-id="34404-189">如果您使用自訂範本來定義其他控制項，您必須提供攔截程式來處理控制項的輸入。</span><span class="sxs-lookup"><span data-stu-id="34404-189">If you use a custom template to define additional controls, you must provide a hook procedure to process input for your controls.</span></span>

### <a name="to-enable-a-hook-procedure-for-the-color-dialog-box"></a><span data-ttu-id="34404-190">若要啟用 [色彩] 對話方塊的勾點程式</span><span class="sxs-lookup"><span data-stu-id="34404-190">To enable a hook procedure for the Color dialog box</span></span>

1.  <span data-ttu-id="34404-191">在 [**CHOOSECOLOR**](/windows/win32/api/commdlg/ns-commdlg-choosecolora-r1)結構的 **旗標** 成員中設定 **CC \_ ENABLEHOOK** 旗標。</span><span class="sxs-lookup"><span data-stu-id="34404-191">Set the **CC\_ENABLEHOOK** flag in the **Flags** member of the [**CHOOSECOLOR**](/windows/win32/api/commdlg/ns-commdlg-choosecolora-r1) structure.</span></span>
2.  <span data-ttu-id="34404-192">在 **lpfnHook** 成員中指定攔截程式的位址。</span><span class="sxs-lookup"><span data-stu-id="34404-192">Specify the address of the hook procedure in the **lpfnHook** member.</span></span>

<span data-ttu-id="34404-193">處理其 [**WM \_ INITDIALOG**](wm-initdialog.md) 訊息之後，對話方塊程式會將 **wm \_ INITDIALOG** 訊息傳送到攔截程式。</span><span class="sxs-lookup"><span data-stu-id="34404-193">After processing its [**WM\_INITDIALOG**](wm-initdialog.md) message, the dialog box procedure sends a **WM\_INITDIALOG** message to the hook procedure.</span></span> <span data-ttu-id="34404-194">此訊息的 *lParam* 參數是用來初始化對話方塊之 [**CHOOSECOLOR**](/windows/win32/api/commdlg/ns-commdlg-choosecolora-r1) 結構的指標。</span><span class="sxs-lookup"><span data-stu-id="34404-194">The *lParam* parameter of this message is a pointer to the [**CHOOSECOLOR**](/windows/win32/api/commdlg/ns-commdlg-choosecolora-r1) structure used to initialize the dialog box.</span></span>

<span data-ttu-id="34404-195">當使用者按一下 [**確定]** 按鈕時，對話方塊會將已註冊的 [**COLOROKSTRING**](colorokstring.md)訊息傳送到攔截程式。</span><span class="sxs-lookup"><span data-stu-id="34404-195">The dialog box sends the [**COLOROKSTRING**](colorokstring.md) registered message to the hook procedure when the user clicks the **OK** button.</span></span> <span data-ttu-id="34404-196">攔截程式可拒絕選取的色彩，並在收到此訊息時，強制對話方塊維持開啟狀態。</span><span class="sxs-lookup"><span data-stu-id="34404-196">The hook procedure can reject the selected color and force the dialog box to remain open by returning zero when it receives this message.</span></span> <span data-ttu-id="34404-197">攔截程式可以將 [**SETRGBSTRING**](setrgbstring.md) 註冊的訊息傳送至對話方塊，強制對話方塊選取特定的色彩。</span><span class="sxs-lookup"><span data-stu-id="34404-197">The hook procedure can force the dialog box to select a particular color by sending the [**SETRGBSTRING**](setrgbstring.md) registered message to the dialog box.</span></span> <span data-ttu-id="34404-198">若要使用這些已註冊的訊息，您必須將 **COLOROKSTRING** 和 **SETRGBSTRING** 常數傳遞給 [**RegisterWindowMessage**](/windows/desktop/api/winuser/nf-winuser-registerwindowmessagea) 函式，以取得訊息識別碼。</span><span class="sxs-lookup"><span data-stu-id="34404-198">To use these registered messages, you must pass the **COLOROKSTRING** and **SETRGBSTRING** constants to the [**RegisterWindowMessage**](/windows/desktop/api/winuser/nf-winuser-registerwindowmessagea) function to get a message identifier.</span></span> <span data-ttu-id="34404-199">然後，您可以使用識別碼來偵測和處理從對話方塊傳送的訊息，或將訊息傳送至對話方塊。</span><span class="sxs-lookup"><span data-stu-id="34404-199">You can then use the identifier to detect and process messages sent from the dialog box, or to send messages to the dialog box.</span></span>

## <a name="color-models-used-by-the-color-dialog-box"></a><span data-ttu-id="34404-200">色彩對話方塊所使用的色彩模型</span><span class="sxs-lookup"><span data-stu-id="34404-200">Color Models Used by the Color Dialog Box</span></span>

<span data-ttu-id="34404-201">[色彩] 對話方塊的自訂色彩延伸，可讓使用者使用 RGB 或 HSL 值來指定色彩。</span><span class="sxs-lookup"><span data-stu-id="34404-201">The custom colors extension of the Color dialog box allows the user to specify a color using RGB or HSL values.</span></span> <span data-ttu-id="34404-202">不過， [**CHOOSECOLOR**](/windows/win32/api/commdlg/ns-commdlg-choosecolora-r1) 結構只使用 RGB 值來報告使用者所建立或選取的色彩。</span><span class="sxs-lookup"><span data-stu-id="34404-202">However, the [**CHOOSECOLOR**](/windows/win32/api/commdlg/ns-commdlg-choosecolora-r1) structure uses only RGB values to report the colors created or selected by the user.</span></span>

-   [<span data-ttu-id="34404-203">RGB 色彩模型</span><span class="sxs-lookup"><span data-stu-id="34404-203">RGB Color Model</span></span>](#rgb-color-model)
-   [<span data-ttu-id="34404-204">HSL 色彩模型</span><span class="sxs-lookup"><span data-stu-id="34404-204">HSL Color Model</span></span>](#hsl-color-model)
-   [<span data-ttu-id="34404-205">將 HSL 值轉換為 RGB 值</span><span class="sxs-lookup"><span data-stu-id="34404-205">Converting HSL Values to RGB Values</span></span>](#converting-hsl-values-to-rgb-values)

### <a name="rgb-color-model"></a><span data-ttu-id="34404-206">RGB 色彩模型</span><span class="sxs-lookup"><span data-stu-id="34404-206">RGB Color Model</span></span>

<span data-ttu-id="34404-207">RGB 模型是用來指定顯示器的色彩，以及發出燈光的其他裝置。</span><span class="sxs-lookup"><span data-stu-id="34404-207">The RGB model is used to designate colors for displays and other devices that emit light.</span></span> <span data-ttu-id="34404-208">有效的紅色、綠色及藍色值的範圍是從0到255，0表示最小強度和255，表示最大濃度。</span><span class="sxs-lookup"><span data-stu-id="34404-208">Valid red, green, and blue values range from 0 through 255, with 0 indicating minimum intensity and 255 indicating maximum intensity.</span></span> <span data-ttu-id="34404-209">下圖顯示如何結合紅色、綠色和藍色的主要色彩，以產生四個額外的色彩。</span><span class="sxs-lookup"><span data-stu-id="34404-209">The following illustration shows how the primary colors red, green, and blue can be combined to produce four additional colors.</span></span> <span data-ttu-id="34404-210">針對顯示裝置 (，當紅色、綠色和藍色值設定為0時，會顯示黑色色彩結果。</span><span class="sxs-lookup"><span data-stu-id="34404-210">(For display devices, the color black results when the red, green, and blue values are set to 0.</span></span> <span data-ttu-id="34404-211">在顯示技術中，黑色是所有色彩都沒有。 ) </span><span class="sxs-lookup"><span data-stu-id="34404-211">In display technology, black is the absence of all colors.)</span></span>

![重迭的紅色、綠色和藍色圓形](images/rgbcolormodel.png)

<span data-ttu-id="34404-213">下表列出 RGB 模型的八種色彩及其相關聯的 RGB 值。</span><span class="sxs-lookup"><span data-stu-id="34404-213">The following table lists eight colors of the RGB model and their associated RGB values.</span></span>



| <span data-ttu-id="34404-214">Color</span><span class="sxs-lookup"><span data-stu-id="34404-214">Color</span></span>   | <span data-ttu-id="34404-215">RGB 值</span><span class="sxs-lookup"><span data-stu-id="34404-215">RGB values</span></span>    |
|---------|---------------|
| <span data-ttu-id="34404-216">紅色</span><span class="sxs-lookup"><span data-stu-id="34404-216">Red</span></span>     | <span data-ttu-id="34404-217">255、0、0</span><span class="sxs-lookup"><span data-stu-id="34404-217">255, 0, 0</span></span>     |
| <span data-ttu-id="34404-218">綠色</span><span class="sxs-lookup"><span data-stu-id="34404-218">Green</span></span>   | <span data-ttu-id="34404-219">0、255、0</span><span class="sxs-lookup"><span data-stu-id="34404-219">0, 255, 0</span></span>     |
| <span data-ttu-id="34404-220">藍色</span><span class="sxs-lookup"><span data-stu-id="34404-220">Blue</span></span>    | <span data-ttu-id="34404-221">0、0、255</span><span class="sxs-lookup"><span data-stu-id="34404-221">0, 0, 255</span></span>     |
| <span data-ttu-id="34404-222">11：青色</span><span class="sxs-lookup"><span data-stu-id="34404-222">Cyan</span></span>    | <span data-ttu-id="34404-223">0、255、255</span><span class="sxs-lookup"><span data-stu-id="34404-223">0, 255, 255</span></span>   |
| <span data-ttu-id="34404-224">桃紅色</span><span class="sxs-lookup"><span data-stu-id="34404-224">Magenta</span></span> | <span data-ttu-id="34404-225">255、0、255</span><span class="sxs-lookup"><span data-stu-id="34404-225">255, 0, 255</span></span>   |
| <span data-ttu-id="34404-226">黃色</span><span class="sxs-lookup"><span data-stu-id="34404-226">Yellow</span></span>  | <span data-ttu-id="34404-227">255、255、0</span><span class="sxs-lookup"><span data-stu-id="34404-227">255, 255, 0</span></span>   |
| <span data-ttu-id="34404-228">白色</span><span class="sxs-lookup"><span data-stu-id="34404-228">White</span></span>   | <span data-ttu-id="34404-229">255、255、255</span><span class="sxs-lookup"><span data-stu-id="34404-229">255, 255, 255</span></span> |
| <span data-ttu-id="34404-230">黑色</span><span class="sxs-lookup"><span data-stu-id="34404-230">Black</span></span>   | <span data-ttu-id="34404-231">0, 0, 0</span><span class="sxs-lookup"><span data-stu-id="34404-231">0, 0, 0</span></span>       |



 

<span data-ttu-id="34404-232">系統會以32位 RGB 值儲存內部色彩，其十六進位形式如下：0x00bbggrr。</span><span class="sxs-lookup"><span data-stu-id="34404-232">The system stores internal colors as 32-bit RGB values that have the following hexadecimal form: 0x00bbggrr.</span></span>

<span data-ttu-id="34404-233">低序位位元組包含相對強度的紅色值;第二個位元組包含綠色的值;第三個位元組包含藍色的值。</span><span class="sxs-lookup"><span data-stu-id="34404-233">The low-order byte contains a value for the relative intensity of red; the second byte contains a value for green; and the third byte contains a value for blue.</span></span> <span data-ttu-id="34404-234">高序位位元組必須為零。</span><span class="sxs-lookup"><span data-stu-id="34404-234">The high-order byte must be zero.</span></span>

<span data-ttu-id="34404-235">您可以使用 [**rgb**](/windows/desktop/api/wingdi/nf-wingdi-rgb) 宏來取得以紅色、綠色和藍色元件的指定濃度為基礎的 rgb 值。</span><span class="sxs-lookup"><span data-stu-id="34404-235">You can use the [**RGB**](/windows/desktop/api/wingdi/nf-wingdi-rgb) macro to get an RGB value based on specified intensities for the red, green, and blue components.</span></span> <span data-ttu-id="34404-236">使用 [**GetRValue**](/windows/desktop/api/wingdi/nf-wingdi-getrvalue)、 [**GetBValue**](/windows/desktop/api/wingdi/nf-wingdi-getbvalue)和 [**GetGValue**](/windows/desktop/api/wingdi/nf-wingdi-getgvalue) 宏從 RGB 色彩值解壓縮個別色彩。</span><span class="sxs-lookup"><span data-stu-id="34404-236">Use the [**GetRValue**](/windows/desktop/api/wingdi/nf-wingdi-getrvalue), [**GetBValue**](/windows/desktop/api/wingdi/nf-wingdi-getbvalue), and [**GetGValue**](/windows/desktop/api/wingdi/nf-wingdi-getgvalue) macros to extract individual colors from an RGB color value.</span></span>

### <a name="hsl-color-model"></a><span data-ttu-id="34404-237">HSL 色彩模型</span><span class="sxs-lookup"><span data-stu-id="34404-237">HSL Color Model</span></span>

<span data-ttu-id="34404-238">[色彩] 對話方塊會提供用來指定 HSL 值的控制項。</span><span class="sxs-lookup"><span data-stu-id="34404-238">The Color dialog box provides controls for specifying HSL values.</span></span> <span data-ttu-id="34404-239">下圖顯示色彩範圍控制項，以及顯示在 [色彩] 對話方塊中的亮度投影片控制項。</span><span class="sxs-lookup"><span data-stu-id="34404-239">The following illustration shows the color spectrum control and the luminosity slide control that appear in the Color dialog box.</span></span> <span data-ttu-id="34404-240">此圖也會顯示使用者可使用這些控制項指定的值範圍。</span><span class="sxs-lookup"><span data-stu-id="34404-240">The illustration also shows the ranges of values the user can specify with these controls.</span></span>

![色譜和亮度比例](images/colordialogranges.png)

<span data-ttu-id="34404-242">在 [色彩] 對話方塊中，[飽和度] 和 [亮度] 值的範圍必須介於0到240之間，而色相值必須在0到239的範圍內。</span><span class="sxs-lookup"><span data-stu-id="34404-242">In the Color dialog box, the saturation and luminosity values must be in the range 0 through 240, and the hue value must be in the range 0 through 239.</span></span>

### <a name="converting-hsl-values-to-rgb-values"></a><span data-ttu-id="34404-243">將 HSL 值轉換為 RGB 值</span><span class="sxs-lookup"><span data-stu-id="34404-243">Converting HSL Values to RGB Values</span></span>

<span data-ttu-id="34404-244">在 [色彩] 對話方塊的 [Comdlg32.dll 中提供的對話方塊套裝程式含程式碼，可將 HSL 值轉換成對應的 RGB 值。</span><span class="sxs-lookup"><span data-stu-id="34404-244">The dialog box procedure provided in Comdlg32.dll for the Color dialog box contains code that converts HSL values to the corresponding RGB values.</span></span> <span data-ttu-id="34404-245">下表列出 RGB 模型的八種色彩，以及其相關聯的 HSL 和 RGB 值。</span><span class="sxs-lookup"><span data-stu-id="34404-245">The following table lists eight colors of the RGB model and their associated HSL and RGB values.</span></span>



| <span data-ttu-id="34404-246">Color</span><span class="sxs-lookup"><span data-stu-id="34404-246">Color</span></span>   | <span data-ttu-id="34404-247">HSL 值</span><span class="sxs-lookup"><span data-stu-id="34404-247">HSL values</span></span>      | <span data-ttu-id="34404-248">RGB 值</span><span class="sxs-lookup"><span data-stu-id="34404-248">RGB values</span></span>      |
|---------|-----------------|-----------------|
| <span data-ttu-id="34404-249">紅色</span><span class="sxs-lookup"><span data-stu-id="34404-249">Red</span></span>     | <span data-ttu-id="34404-250"> (0、240、120) </span><span class="sxs-lookup"><span data-stu-id="34404-250">(0, 240, 120)</span></span>   | <span data-ttu-id="34404-251">(255, 0, 0)</span><span class="sxs-lookup"><span data-stu-id="34404-251">(255, 0, 0)</span></span>     |
| <span data-ttu-id="34404-252">黃色</span><span class="sxs-lookup"><span data-stu-id="34404-252">Yellow</span></span>  | <span data-ttu-id="34404-253"> (40、240、120) </span><span class="sxs-lookup"><span data-stu-id="34404-253">(40, 240, 120)</span></span>  | <span data-ttu-id="34404-254"> (255、255、0) </span><span class="sxs-lookup"><span data-stu-id="34404-254">(255, 255, 0)</span></span>   |
| <span data-ttu-id="34404-255">綠色</span><span class="sxs-lookup"><span data-stu-id="34404-255">Green</span></span>   | <span data-ttu-id="34404-256"> (80、240、120) </span><span class="sxs-lookup"><span data-stu-id="34404-256">(80, 240, 120)</span></span>  | <span data-ttu-id="34404-257"> (0、255、0) </span><span class="sxs-lookup"><span data-stu-id="34404-257">(0, 255, 0)</span></span>     |
| <span data-ttu-id="34404-258">11：青色</span><span class="sxs-lookup"><span data-stu-id="34404-258">Cyan</span></span>    | <span data-ttu-id="34404-259"> (120、240、120) </span><span class="sxs-lookup"><span data-stu-id="34404-259">(120, 240, 120)</span></span> | <span data-ttu-id="34404-260"> (0、255、255) </span><span class="sxs-lookup"><span data-stu-id="34404-260">(0, 255, 255)</span></span>   |
| <span data-ttu-id="34404-261">藍色</span><span class="sxs-lookup"><span data-stu-id="34404-261">Blue</span></span>    | <span data-ttu-id="34404-262"> (160、240、120) </span><span class="sxs-lookup"><span data-stu-id="34404-262">(160, 240, 120)</span></span> | <span data-ttu-id="34404-263"> (0、0、255) </span><span class="sxs-lookup"><span data-stu-id="34404-263">(0, 0, 255)</span></span>     |
| <span data-ttu-id="34404-264">桃紅色</span><span class="sxs-lookup"><span data-stu-id="34404-264">Magenta</span></span> | <span data-ttu-id="34404-265"> (200、240、120) </span><span class="sxs-lookup"><span data-stu-id="34404-265">(200, 240, 120)</span></span> | <span data-ttu-id="34404-266"> (255、0、255) </span><span class="sxs-lookup"><span data-stu-id="34404-266">(255, 0, 255)</span></span>   |
| <span data-ttu-id="34404-267">白色</span><span class="sxs-lookup"><span data-stu-id="34404-267">White</span></span>   | <span data-ttu-id="34404-268"> (0、0、240) </span><span class="sxs-lookup"><span data-stu-id="34404-268">(0, 0, 240)</span></span>     | <span data-ttu-id="34404-269"> (255、255、255) </span><span class="sxs-lookup"><span data-stu-id="34404-269">(255, 255, 255)</span></span> |
| <span data-ttu-id="34404-270">黑色</span><span class="sxs-lookup"><span data-stu-id="34404-270">Black</span></span>   | <span data-ttu-id="34404-271">(0, 0, 0)</span><span class="sxs-lookup"><span data-stu-id="34404-271">(0, 0, 0)</span></span>       | <span data-ttu-id="34404-272">(0, 0, 0)</span><span class="sxs-lookup"><span data-stu-id="34404-272">(0, 0, 0)</span></span>       |



 

 

 
