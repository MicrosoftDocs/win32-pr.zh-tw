---
title: 自訂通用對話方塊
description: 本主題討論如何使用通用對話方塊。
ms.assetid: 31ba9deb-32e6-455c-be0e-ff8bcc691c80
keywords:
- 通用對話方塊程式庫，自訂
- 通用對話方塊，自訂
- 自訂通用對話方塊
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b7eaa71c4f6fc6aa038ef150eb53935f6b3ec280
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/20/2020
ms.locfileid: "104382646"
---
# <a name="customizing-common-dialog-boxes"></a><span data-ttu-id="6844e-106">自訂通用對話方塊</span><span class="sxs-lookup"><span data-stu-id="6844e-106">Customizing Common Dialog Boxes</span></span>

<span data-ttu-id="6844e-107">您可以使用其標準格式的通用對話方塊，也可以自訂對話方塊。</span><span class="sxs-lookup"><span data-stu-id="6844e-107">You can use the common dialog boxes in their standard form, or you can customize them.</span></span> <span data-ttu-id="6844e-108">從使用者的觀點來看，通用對話方塊的主要優點是它與應用程式之間的外觀和功能一致。</span><span class="sxs-lookup"><span data-stu-id="6844e-108">From the user's perspective, the chief benefit of the common dialog box is its consistent appearance and functionality from application to application.</span></span> <span data-ttu-id="6844e-109">因此，只有在應用程式絕對必要時，才需要自訂通用對話方塊，是很重要的。</span><span class="sxs-lookup"><span data-stu-id="6844e-109">Therefore, it is important that you customize a common dialog box only when it is absolutely necessary for an application.</span></span> <span data-ttu-id="6844e-110">否則，就會遺失一致的外觀和簡單的程式碼介面。</span><span class="sxs-lookup"><span data-stu-id="6844e-110">Otherwise, the consistent appearance and simple coding interface are lost.</span></span> <span data-ttu-id="6844e-111">適當的自訂會盡可能保持不變的原始控制項數目。</span><span class="sxs-lookup"><span data-stu-id="6844e-111">Appropriate customizations leave intact as many of the original controls as possible.</span></span> <span data-ttu-id="6844e-112">增加對話方塊的大小或在對話方塊中已提供的空間中加入新控制項，是適當的自訂。</span><span class="sxs-lookup"><span data-stu-id="6844e-112">Increasing the size of the dialog box or adding new controls in the space already available in the dialog box is an appropriate customization.</span></span> <span data-ttu-id="6844e-113">隱藏原始控制項，或以其他方式變更原始控制項的預期功能，是較不適當的自訂。</span><span class="sxs-lookup"><span data-stu-id="6844e-113">Hiding original controls or otherwise changing the intended functionality of the original controls is a less appropriate customization.</span></span>

<span data-ttu-id="6844e-114">本節討論自訂通用對話方塊的下列方法：</span><span class="sxs-lookup"><span data-stu-id="6844e-114">This section discusses the following methods for customizing a common dialog box:</span></span>

-   [<span data-ttu-id="6844e-115">自訂範本</span><span class="sxs-lookup"><span data-stu-id="6844e-115">Custom Templates</span></span>](#custom-templates)
-   [<span data-ttu-id="6844e-116">一般對話方塊的掛勾程式</span><span class="sxs-lookup"><span data-stu-id="6844e-116">Hook Procedures for Common Dialog Boxes</span></span>](#hook-procedures-for-common-dialog-boxes)
-   [<span data-ttu-id="6844e-117">常見的對話訊息</span><span class="sxs-lookup"><span data-stu-id="6844e-117">Common Dialog Messages</span></span>](#common-dialog-messages)
-   [<span data-ttu-id="6844e-118">說明支援</span><span class="sxs-lookup"><span data-stu-id="6844e-118">Help Support</span></span>](#help-support)
    -   [<span data-ttu-id="6844e-119">即時線上說明</span><span class="sxs-lookup"><span data-stu-id="6844e-119">Context-Sensitive Help</span></span>](#context-sensitive-help)
    -   <span data-ttu-id="6844e-120">[[說明] 按鈕](#the-help-button)</span><span class="sxs-lookup"><span data-stu-id="6844e-120">[The Help Button](#the-help-button)</span></span>

## <a name="custom-templates"></a><span data-ttu-id="6844e-121">自訂範本</span><span class="sxs-lookup"><span data-stu-id="6844e-121">Custom Templates</span></span>

<span data-ttu-id="6844e-122">一般對話方塊有預設範本，可在對話方塊中定義標準控制項的數目、類型和位置。</span><span class="sxs-lookup"><span data-stu-id="6844e-122">Common dialog boxes have default templates that define the number, type, and position of the standard controls in the dialog box.</span></span> <span data-ttu-id="6844e-123">您可以定義自訂範本，讓使用者存取您應用程式特有的其他控制項。</span><span class="sxs-lookup"><span data-stu-id="6844e-123">You can define a custom template to give users access to additional controls that are unique to your application.</span></span>

<span data-ttu-id="6844e-124">除了 Explorer 樣式 [ **開啟** ] 和 [ **另存** 新檔] 對話方塊以外的所有通用對話方塊中，您可以修改預設範本，以建立可取代預設範本的自訂範本。</span><span class="sxs-lookup"><span data-stu-id="6844e-124">For all common dialog boxes except the Explorer-style **Open** and **Save As** dialog boxes, you modify the default template to create a custom template that replaces the default template.</span></span> <span data-ttu-id="6844e-125">自訂範本會定義標準控制項的類型和位置，以及任何其他控制項。</span><span class="sxs-lookup"><span data-stu-id="6844e-125">The custom template defines the type and position of the standard controls as well as any additional controls.</span></span>

<span data-ttu-id="6844e-126">當您藉由修改預設對話方塊範本來建立自訂對話方塊範本時，請確定任何已加入控制項的識別碼都是唯一的，而且不會與標準控制項的識別碼衝突。</span><span class="sxs-lookup"><span data-stu-id="6844e-126">When you create a custom dialog box template by modifying the default dialog box template, make sure the identifiers for any added controls are unique and do not conflict with the identifiers of the standard controls.</span></span> <span data-ttu-id="6844e-127">下表列出預設範本檔案的名稱，以及每個通用對話方塊類型的 include 檔。</span><span class="sxs-lookup"><span data-stu-id="6844e-127">The following table lists the name of the default template file and include file for each of the common dialog box types.</span></span>



| <span data-ttu-id="6844e-128">對話方塊類型</span><span class="sxs-lookup"><span data-stu-id="6844e-128">Dialog box type</span></span>               | <span data-ttu-id="6844e-129">範本檔案</span><span class="sxs-lookup"><span data-stu-id="6844e-129">Template file</span></span> | <span data-ttu-id="6844e-130">包含檔案</span><span class="sxs-lookup"><span data-stu-id="6844e-130">Include file</span></span> |
|-------------------------------|---------------|--------------|
| <span data-ttu-id="6844e-131">**色彩**</span><span class="sxs-lookup"><span data-stu-id="6844e-131">**Color**</span></span>                     | <span data-ttu-id="6844e-132">Color. d</span><span class="sxs-lookup"><span data-stu-id="6844e-132">Color.dlg</span></span>     | <span data-ttu-id="6844e-133">ColorDlg。h</span><span class="sxs-lookup"><span data-stu-id="6844e-133">ColorDlg.h</span></span>   |
| <span data-ttu-id="6844e-134">**Find**</span><span class="sxs-lookup"><span data-stu-id="6844e-134">**Find**</span></span>                      | <span data-ttu-id="6844e-135">Findtext，d</span><span class="sxs-lookup"><span data-stu-id="6844e-135">Findtext.dlg</span></span>  | <span data-ttu-id="6844e-136">Dlgs。h</span><span class="sxs-lookup"><span data-stu-id="6844e-136">Dlgs.h</span></span>       |
| <span data-ttu-id="6844e-137">**字型**</span><span class="sxs-lookup"><span data-stu-id="6844e-137">**Font**</span></span>                      | <span data-ttu-id="6844e-138">字型. d</span><span class="sxs-lookup"><span data-stu-id="6844e-138">Font.dlg</span></span>      | <span data-ttu-id="6844e-139">Dlgs。h</span><span class="sxs-lookup"><span data-stu-id="6844e-139">Dlgs.h</span></span>       |
| <span data-ttu-id="6844e-140">**開啟** (多重選取) </span><span class="sxs-lookup"><span data-stu-id="6844e-140">**Open** (multiple selection)</span></span> | <span data-ttu-id="6844e-141">Fileopen，d</span><span class="sxs-lookup"><span data-stu-id="6844e-141">Fileopen.dlg</span></span>  | <span data-ttu-id="6844e-142">Dlgs。h</span><span class="sxs-lookup"><span data-stu-id="6844e-142">Dlgs.h</span></span>       |
| <span data-ttu-id="6844e-143">**開啟** (單一選取) </span><span class="sxs-lookup"><span data-stu-id="6844e-143">**Open** (single selection)</span></span>   | <span data-ttu-id="6844e-144">Fileopen，d</span><span class="sxs-lookup"><span data-stu-id="6844e-144">Fileopen.dlg</span></span>  | <span data-ttu-id="6844e-145">Dlgs。h</span><span class="sxs-lookup"><span data-stu-id="6844e-145">Dlgs.h</span></span>       |
| <span data-ttu-id="6844e-146">**設定列印格式**</span><span class="sxs-lookup"><span data-stu-id="6844e-146">**Page Setup**</span></span>                | <span data-ttu-id="6844e-147">Prnsetup，d</span><span class="sxs-lookup"><span data-stu-id="6844e-147">Prnsetup.dlg</span></span>  | <span data-ttu-id="6844e-148">Dlgs。h</span><span class="sxs-lookup"><span data-stu-id="6844e-148">Dlgs.h</span></span>       |
| <span data-ttu-id="6844e-149">**Print**</span><span class="sxs-lookup"><span data-stu-id="6844e-149">**Print**</span></span>                     | <span data-ttu-id="6844e-150">Prnsetup，d</span><span class="sxs-lookup"><span data-stu-id="6844e-150">Prnsetup.dlg</span></span>  | <span data-ttu-id="6844e-151">Dlgs。h</span><span class="sxs-lookup"><span data-stu-id="6844e-151">Dlgs.h</span></span>       |
| <span data-ttu-id="6844e-152"> (淘汰) **列印安裝程式**</span><span class="sxs-lookup"><span data-stu-id="6844e-152">**Print Setup** (obsolete)</span></span>    | <span data-ttu-id="6844e-153">Prnsetup，d</span><span class="sxs-lookup"><span data-stu-id="6844e-153">Prnsetup.dlg</span></span>  | <span data-ttu-id="6844e-154">Dlgs。h</span><span class="sxs-lookup"><span data-stu-id="6844e-154">Dlgs.h</span></span>       |
| <span data-ttu-id="6844e-155">**Replace**</span><span class="sxs-lookup"><span data-stu-id="6844e-155">**Replace**</span></span>                   | <span data-ttu-id="6844e-156">Findtext，d</span><span class="sxs-lookup"><span data-stu-id="6844e-156">Findtext.dlg</span></span>  | <span data-ttu-id="6844e-157">Dlgs。h</span><span class="sxs-lookup"><span data-stu-id="6844e-157">Dlgs.h</span></span>       |



 

<span data-ttu-id="6844e-158">若要啟用自訂範本，您必須在對話方塊的對應結構的 **旗標** 成員中設定旗標。</span><span class="sxs-lookup"><span data-stu-id="6844e-158">To enable a custom template, you must set a flag in the **Flags** member of the corresponding structure for the dialog box.</span></span> <span data-ttu-id="6844e-159">如果範本是應用程式或動態連結程式庫中的資源，請在 **旗標** 成員中設定 **ENABLETEMPLATE** 旗標，並使用該結構的 **hInstance** 和 **lpTemplateName** 成員來識別模組和資源名稱。</span><span class="sxs-lookup"><span data-stu-id="6844e-159">If the template is a resource in an application or dynamic-link library, set an **ENABLETEMPLATE** flag in the **Flags** member, and use the **hInstance** and **lpTemplateName** members of the structure to identify the module and resource name.</span></span> <span data-ttu-id="6844e-160">如果範本已在記憶體中，請在 **旗標** 成員中設定 **ENABLETEMPLATEHANDLE** 旗標，並使用 **hInstance** 成員來識別包含範本的記憶體物件。</span><span class="sxs-lookup"><span data-stu-id="6844e-160">If the template is already in memory, set an **ENABLETEMPLATEHANDLE** flag in the **Flags** member, and use the **hInstance** member to identify the memory object that contains the template.</span></span>

<span data-ttu-id="6844e-161">在大多數情況下，您也必須啟用對話方塊的攔截程式，以支援和處理自訂範本中其他控制項的輸入。</span><span class="sxs-lookup"><span data-stu-id="6844e-161">In most cases, you must also enable a hook procedure for the dialog box to support and process input for the additional controls in your custom template.</span></span>

<span data-ttu-id="6844e-162">若為 Explorer 樣式的 [ **開啟** ] 和 [ **另存** 新檔] 對話方塊，則無法使用預設範本進行修改。</span><span class="sxs-lookup"><span data-stu-id="6844e-162">For the Explorer-style **Open** and **Save As** dialog boxes, the default templates are not available for modification.</span></span> <span data-ttu-id="6844e-163">相反地，您的自訂範本會定義子對話方塊，其中只包含要加入至標準對話方塊的專案。</span><span class="sxs-lookup"><span data-stu-id="6844e-163">Instead, your custom template defines a child dialog box that includes only the items to be added to the standard dialog box.</span></span> <span data-ttu-id="6844e-164">自訂範本也可以定義靜態控制項，以指定子對話方塊中標準控制項的群集位置。</span><span class="sxs-lookup"><span data-stu-id="6844e-164">The custom template can also define a static control that specifies the location of the cluster of standard controls in the child dialog box.</span></span> <span data-ttu-id="6844e-165">如需詳細資訊，請參閱 [Explorer 樣式的自訂範本](open-and-save-as-dialog-boxes.md)。</span><span class="sxs-lookup"><span data-stu-id="6844e-165">For more information, see [Explorer-Style Custom Templates](open-and-save-as-dialog-boxes.md).</span></span>

## <a name="hook-procedures-for-common-dialog-boxes"></a><span data-ttu-id="6844e-166">一般對話方塊的掛勾程式</span><span class="sxs-lookup"><span data-stu-id="6844e-166">Hook Procedures for Common Dialog Boxes</span></span>

<span data-ttu-id="6844e-167">您可以針對每個通用對話方塊啟用攔截程式，以便處理來自預設對話方塊程式的訊息。</span><span class="sxs-lookup"><span data-stu-id="6844e-167">For each of the common dialog boxes, you can enable a hook procedure to process messages from the default dialog box procedure.</span></span> <span data-ttu-id="6844e-168">常見的對話攔截程式有兩種一般類型：</span><span class="sxs-lookup"><span data-stu-id="6844e-168">There are two general types of common dialog hook procedures:</span></span>

-   <span data-ttu-id="6844e-169">最常見的對話方塊所使用的標準勾點程式</span><span class="sxs-lookup"><span data-stu-id="6844e-169">The standard hook procedure used with most common dialog boxes</span></span>
-   <span data-ttu-id="6844e-170">[ **開啟** ] 和 [ **另存** 新檔] 對話方塊所支援的 Explorer 樣式攔截程式</span><span class="sxs-lookup"><span data-stu-id="6844e-170">The Explorer-style hook procedure supported by the **Open** and **Save As** dialog boxes</span></span>

<span data-ttu-id="6844e-171">當您針對其中一個通用對話方塊提供標準攔截程式時，預設的對話方塊程式會處理其訊息，如下所示。</span><span class="sxs-lookup"><span data-stu-id="6844e-171">When you provide a standard hook procedure for one of the common dialog boxes, the default dialog box procedure handles its messages as follows.</span></span>



| <span data-ttu-id="6844e-172">訊息</span><span class="sxs-lookup"><span data-stu-id="6844e-172">Message</span></span>                                 | <span data-ttu-id="6844e-173">處理</span><span class="sxs-lookup"><span data-stu-id="6844e-173">Handling</span></span>                                                                                                                                                                                                             |
|-----------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="6844e-174">**WM \_ INITDIALOG**</span><span class="sxs-lookup"><span data-stu-id="6844e-174">**WM\_INITDIALOG**</span></span>](wm-initdialog.md) | <span data-ttu-id="6844e-175">預設對話方塊程式會先處理訊息，然後再將訊息傳遞至攔截程式。</span><span class="sxs-lookup"><span data-stu-id="6844e-175">The default dialog box procedure processes the message before passing it to the hook procedure.</span></span> <span data-ttu-id="6844e-176">訊息的 *lParam* 參數是建立對話方塊時所指定之初始化結構的指標。</span><span class="sxs-lookup"><span data-stu-id="6844e-176">The message's *lParam* parameter is a pointer to the initialization structure specified when the dialog was created.</span></span> |
| <span data-ttu-id="6844e-177">所有其他訊息</span><span class="sxs-lookup"><span data-stu-id="6844e-177">All other messages</span></span>                      | <span data-ttu-id="6844e-178">攔截程式會先接收訊息。</span><span class="sxs-lookup"><span data-stu-id="6844e-178">The hook procedure receives the message first.</span></span> <span data-ttu-id="6844e-179">然後，攔截程式的傳回值會決定預設的對話方塊程式是要處理訊息，還是忽略它。</span><span class="sxs-lookup"><span data-stu-id="6844e-179">Then, the return value of the hook procedure determines whether the default dialog procedure processes the message or ignores it.</span></span>                                     |



 

<span data-ttu-id="6844e-180">若為 Explorer 樣式的 [ **開啟** ] 和 [ **另存** 新檔] 對話方塊，攔截程式就不會在對話方塊中收到標準控制項所需的訊息。</span><span class="sxs-lookup"><span data-stu-id="6844e-180">For the Explorer-style **Open** and **Save As** dialog boxes, the hook procedure does not receive messages intended for the standard controls in the dialog box.</span></span> <span data-ttu-id="6844e-181">相反地，它會從對話方塊接收通知訊息，並針對您在自訂範本中定義的任何其他控制項接收訊息。</span><span class="sxs-lookup"><span data-stu-id="6844e-181">Instead, it receives notification messages from the dialog box and messages for any additional controls that you defined in a custom template.</span></span> <span data-ttu-id="6844e-182">如需詳細資訊，請參閱 [Explorer 樣式的勾點程式](open-and-save-as-dialog-boxes.md)。</span><span class="sxs-lookup"><span data-stu-id="6844e-182">For more information, see [Explorer-Style Hook Procedures](open-and-save-as-dialog-boxes.md).</span></span>

<span data-ttu-id="6844e-183">若要啟用攔截程式，請在對話方塊的對應結構的 **旗標** 成員中設定 **ENABLEHOOK** 值。</span><span class="sxs-lookup"><span data-stu-id="6844e-183">To enable a hook procedure, set an **ENABLEHOOK** value in the **Flags** member of the corresponding structure for the dialog box.</span></span> <span data-ttu-id="6844e-184">如果設定了 **ENABLEHOOK** 旗標，則結構的 **lpfnHook** 成員必須指定攔截程式的位址。</span><span class="sxs-lookup"><span data-stu-id="6844e-184">If an **ENABLEHOOK** flag is set, an **lpfnHook** member of the structure must specify the address of the hook procedure.</span></span>

<span data-ttu-id="6844e-185">下表顯示每個通用對話方塊所提供的攔截程式類型。</span><span class="sxs-lookup"><span data-stu-id="6844e-185">The following table shows the type of hook procedure to provide for each of the common dialog boxes.</span></span>



| <span data-ttu-id="6844e-186">對話方塊類型</span><span class="sxs-lookup"><span data-stu-id="6844e-186">Dialog box type</span></span>                          | <span data-ttu-id="6844e-187">攔截程式</span><span class="sxs-lookup"><span data-stu-id="6844e-187">Hook procedure</span></span>                                      |
|------------------------------------------|-----------------------------------------------------|
| <span data-ttu-id="6844e-188">**色彩**</span><span class="sxs-lookup"><span data-stu-id="6844e-188">**Color**</span></span>                                | [<span data-ttu-id="6844e-189">*CCHookProc*</span><span class="sxs-lookup"><span data-stu-id="6844e-189">*CCHookProc*</span></span>](/windows/win32/api/commdlg/nc-commdlg-lpcchookproc)                      |
| <span data-ttu-id="6844e-190">**尋找** 或 **取代**</span><span class="sxs-lookup"><span data-stu-id="6844e-190">**Find** or **Replace**</span></span>                  | [<span data-ttu-id="6844e-191">*FRHookProc*</span><span class="sxs-lookup"><span data-stu-id="6844e-191">*FRHookProc*</span></span>](/windows/win32/api/commdlg/nc-commdlg-lpfrhookproc)                      |
| <span data-ttu-id="6844e-192">**字型**</span><span class="sxs-lookup"><span data-stu-id="6844e-192">**Font**</span></span>                                 | [<span data-ttu-id="6844e-193">*CFHookProc*</span><span class="sxs-lookup"><span data-stu-id="6844e-193">*CFHookProc*</span></span>](/windows/win32/api/commdlg/nc-commdlg-lpcfhookproc)                      |
| <span data-ttu-id="6844e-194">**開啟** 或 **另存為** (Explorer 樣式的) </span><span class="sxs-lookup"><span data-stu-id="6844e-194">**Open** or **Save As** (Explorer-style)</span></span> | [<span data-ttu-id="6844e-195">*OFNHookProc*</span><span class="sxs-lookup"><span data-stu-id="6844e-195">*OFNHookProc*</span></span>](/windows/win32/api/commdlg/nc-commdlg-lpofnhookproc)                    |
| <span data-ttu-id="6844e-196">**開啟** 或 **另存為** (舊樣式的) </span><span class="sxs-lookup"><span data-stu-id="6844e-196">**Open** or **Save As** (Old-style)</span></span>      | <span data-ttu-id="6844e-197">[*OFNHookProcOldStyle*](/previous-versions/windows/desktop/legacy/ms646932(v=vs.85))</span><span class="sxs-lookup"><span data-stu-id="6844e-197">[*OFNHookProcOldStyle*](/previous-versions/windows/desktop/legacy/ms646932(v=vs.85))</span></span> |
| <span data-ttu-id="6844e-198">**Print**</span><span class="sxs-lookup"><span data-stu-id="6844e-198">**Print**</span></span>                                | [<span data-ttu-id="6844e-199">*PrintHookProc*</span><span class="sxs-lookup"><span data-stu-id="6844e-199">*PrintHookProc*</span></span>](/windows/win32/api/commdlg/nc-commdlg-lpprinthookproc)                |
| <span data-ttu-id="6844e-200">**設定列印格式**</span><span class="sxs-lookup"><span data-stu-id="6844e-200">**Page Setup**</span></span>                           | [<span data-ttu-id="6844e-201">*PageSetupHook*</span><span class="sxs-lookup"><span data-stu-id="6844e-201">*PageSetupHook*</span></span>](/windows/win32/api/commdlg/nc-commdlg-lppagesetuphook)                |



 

<span data-ttu-id="6844e-202">在 [版面設定] 對話方塊中，您也可以指定 [*PagePaintHook*](/windows/win32/api/commdlg/nc-commdlg-lppagepainthook)勾點 **程式**。</span><span class="sxs-lookup"><span data-stu-id="6844e-202">For the **Page Setup** dialog box, you can also specify a [*PagePaintHook*](/windows/win32/api/commdlg/nc-commdlg-lppagepainthook) hook procedure.</span></span> <span data-ttu-id="6844e-203">這是您可以用來自訂 [版面 **設定** ] 對話方塊所顯示之範例頁面外觀的特殊攔截程式。</span><span class="sxs-lookup"><span data-stu-id="6844e-203">This is a special hook procedure that you can use to customize the appearance of the sample page displayed by the **Page Setup** dialog box.</span></span>

> [!Note]  
> <span data-ttu-id="6844e-204">[ **列印設定** ] 對話方塊已由 [版面 **設定** ] 對話方塊取代。</span><span class="sxs-lookup"><span data-stu-id="6844e-204">The **Print Setup** dialog box has been superseded by the **Page Setup** dialog box.</span></span> <span data-ttu-id="6844e-205">應用程式應該使用 [版面 **設定** ] 對話方塊。</span><span class="sxs-lookup"><span data-stu-id="6844e-205">Applications should use the **Page Setup** dialog box.</span></span> <span data-ttu-id="6844e-206">不過，為了相容性， [**PrintDlg**](/previous-versions/windows/desktop/legacy/ms646940(v=vs.85)) 函式會繼續支援顯示 [ **列印設定** ] 對話方塊。</span><span class="sxs-lookup"><span data-stu-id="6844e-206">However, for compatibility, the [**PrintDlg**](/previous-versions/windows/desktop/legacy/ms646940(v=vs.85)) function continues to support display of the **Print Setup** dialog box.</span></span> <span data-ttu-id="6844e-207">您可以為 [**列印設定**] 對話方塊提供 [*SetupHookProc*](/windows/win32/api/commdlg/nc-commdlg-lpsetuphookproc)攔截程式。</span><span class="sxs-lookup"><span data-stu-id="6844e-207">You can provide a [*SetupHookProc*](/windows/win32/api/commdlg/nc-commdlg-lpsetuphookproc) hook procedure for the **Print Setup** dialog box.</span></span>

 

## <a name="common-dialog-messages"></a><span data-ttu-id="6844e-208">常見的對話訊息</span><span class="sxs-lookup"><span data-stu-id="6844e-208">Common Dialog Messages</span></span>

<span data-ttu-id="6844e-209">一般對話方塊會使用訊息，在特定事件發生時通知您的視窗程式或攔截程式。</span><span class="sxs-lookup"><span data-stu-id="6844e-209">Common dialog boxes use messages to notify your window procedure or hook procedure when certain events occur.</span></span> <span data-ttu-id="6844e-210">此外，您還可以傳送訊息給通用對話方塊，以抓取資訊或控制對話方塊的行為或外觀。</span><span class="sxs-lookup"><span data-stu-id="6844e-210">In addition, there are messages that you can send to a common dialog box to retrieve information or to control the behavior or appearance of the dialog box.</span></span> <span data-ttu-id="6844e-211">本章節描述 [**RegisterWindowMessage**](/windows/desktop/api/winuser/nf-winuser-registerwindowmessagea) 函式所註冊的一般對話訊息、[ **字型** ] 對話方塊和 [版面 **設定** ] 對話方塊所使用的訊息，以及 Explorer 樣式 [ **開啟** ] 和 [ **另存** 新檔] 對話方塊所使用的訊息。</span><span class="sxs-lookup"><span data-stu-id="6844e-211">This section describes the common dialog messages registered by the [**RegisterWindowMessage**](/windows/desktop/api/winuser/nf-winuser-registerwindowmessagea) function, messages used by the **Font** dialog box and **Page Setup** dialog box, and messages used by the Explorer-style **Open** and **Save As** dialog boxes.</span></span>

<span data-ttu-id="6844e-212">通用對話方塊程式庫會定義一組訊息字串。</span><span class="sxs-lookup"><span data-stu-id="6844e-212">The Common Dialog Box Library defines a set of message strings.</span></span> <span data-ttu-id="6844e-213">您可以將與其中一個訊息字串相關聯的常數傳遞給 [**RegisterWindowMessage**](/windows/desktop/api/winuser/nf-winuser-registerwindowmessagea) ，以取得訊息識別碼。</span><span class="sxs-lookup"><span data-stu-id="6844e-213">You can pass a constant associated with one of these message strings to [**RegisterWindowMessage**](/windows/desktop/api/winuser/nf-winuser-registerwindowmessagea) to get a message identifier.</span></span> <span data-ttu-id="6844e-214">然後，您可以使用識別碼來偵測和處理從通用對話方塊傳送的訊息，或將訊息傳送至通用對話方塊。</span><span class="sxs-lookup"><span data-stu-id="6844e-214">You can then use the identifier to detect and process messages sent from a common dialog box, or to send messages to a common dialog box.</span></span> <span data-ttu-id="6844e-215">下表顯示訊息常數，並說明其用法。</span><span class="sxs-lookup"><span data-stu-id="6844e-215">The following table shows the message constants and describes their use.</span></span>



| <span data-ttu-id="6844e-216">Contants</span><span class="sxs-lookup"><span data-stu-id="6844e-216">Contants</span></span>                               | <span data-ttu-id="6844e-217">使用</span><span class="sxs-lookup"><span data-stu-id="6844e-217">Use</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                    |
|----------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="6844e-218">**COLOROKSTRING**</span><span class="sxs-lookup"><span data-stu-id="6844e-218">**COLOROKSTRING**</span></span>](colorokstring.md) | <span data-ttu-id="6844e-219">當使用者選取色彩，然後按一下 [**確定]** 按鈕時，[**色彩**] 對話方塊會將此訊息傳送至攔截程式。</span><span class="sxs-lookup"><span data-stu-id="6844e-219">A **Color** dialog box sends this message to the hook procedure when the user selects a color and clicks the **OK** button.</span></span> <span data-ttu-id="6844e-220">攔截程式可以接受色彩或拒絕它，並強制對話方塊維持開啟狀態。</span><span class="sxs-lookup"><span data-stu-id="6844e-220">The hook procedure can accept the color, or reject it and force the dialog box to remain open.</span></span>                                                                                                                                                                                             |
| [<span data-ttu-id="6844e-221">**FILEOKSTRING**</span><span class="sxs-lookup"><span data-stu-id="6844e-221">**FILEOKSTRING**</span></span>](fileokstring.md)   | <span data-ttu-id="6844e-222">當使用者選取檔案名，然後按一下 [確定] 按鈕時，[**開啟**] 或 **[** **另存** 新檔] 對話方塊會將此訊息傳送到攔截程式。</span><span class="sxs-lookup"><span data-stu-id="6844e-222">An **Open** or **Save As** dialog box sends this message to the hook procedure when the user selects a file name and clicks the **OK** button.</span></span> <span data-ttu-id="6844e-223">攔截程式可以接受檔案名，或將它拒絕，然後強制對話方塊保持開啟狀態。</span><span class="sxs-lookup"><span data-stu-id="6844e-223">The hook procedure can accept the file name, or reject it and force the dialog box to remain open.</span></span> <span data-ttu-id="6844e-224">若為 Explorer 樣式的 [ **開啟** ] 和 [ **另存** 新檔] 對話方塊，此訊息已由 [**CDN \_ FILEOK**](cdn-fileok.md) 通知訊息取代。</span><span class="sxs-lookup"><span data-stu-id="6844e-224">For Explorer-style **Open** and **Save As** dialog boxes, this message has been superseded by the [**CDN\_FILEOK**](cdn-fileok.md) notification message.</span></span><br/> |
| [<span data-ttu-id="6844e-225">**FINDMSGSTRING**</span><span class="sxs-lookup"><span data-stu-id="6844e-225">**FINDMSGSTRING**</span></span>](findmsgstring.md) | <span data-ttu-id="6844e-226">當使用者按一下 [**尋找下一個**]、[**取代**] 或 [**全部取代**]，或關閉對話方塊時，[**尋找** 或 **取代**] 對話方塊會將此訊息傳送至其父視窗的視窗程式。</span><span class="sxs-lookup"><span data-stu-id="6844e-226">A **Find** or **Replace** dialog box sends this message to the window procedure of its parent window when the user clicks the **Find Next**, **Replace**, or **Replace All**, or closes the dialog box.</span></span> <span data-ttu-id="6844e-227">訊息的 *lParam* 參數是 [**FINDREPLACE**](/windows/win32/api/commdlg/ns-commdlg-findreplacea) 結構的指標，其中包含使用者的輸入。</span><span class="sxs-lookup"><span data-stu-id="6844e-227">The message's *lParam* parameter is a pointer to a [**FINDREPLACE**](/windows/win32/api/commdlg/ns-commdlg-findreplacea) structure containing the user's input.</span></span>                                                                               |
| [<span data-ttu-id="6844e-228">**HELPMSGSTRING**</span><span class="sxs-lookup"><span data-stu-id="6844e-228">**HELPMSGSTRING**</span></span>](helpmsgstring.md) | <span data-ttu-id="6844e-229">當使用者按一下 [說明] 按鈕 **時，所有** 通用對話方塊都會將此訊息傳送至其父視窗的視窗程式。</span><span class="sxs-lookup"><span data-stu-id="6844e-229">All common dialog boxes send this message to the window procedure of their parent window when the user clicks the **Help** button.</span></span> <span data-ttu-id="6844e-230">針對 Explorer 樣式的 [ **開啟** ] 和 [ **另存** 新檔] 對話方塊，此訊息已由 [**CDN \_ 說明通知**](cdn-help.md) 訊息取代。</span><span class="sxs-lookup"><span data-stu-id="6844e-230">For Explorer-style **Open** and **Save As** dialog boxes, this message has been superseded by the [**CDN\_HELP**](cdn-help.md) notification message.</span></span><br/>                                                                                                                    |
| [<span data-ttu-id="6844e-231">**LBSELCHSTRING**</span><span class="sxs-lookup"><span data-stu-id="6844e-231">**LBSELCHSTRING**</span></span>](lbselchstring.md) | <span data-ttu-id="6844e-232">[ **開啟** ] 或 [ **另存** 新檔] 對話方塊會在使用者變更 [ **檔案名** ] 清單方塊中的選取專案時，將此訊息傳送到攔截程式。</span><span class="sxs-lookup"><span data-stu-id="6844e-232">An **Open** or **Save As** dialog box sends this message to the hook procedure when the user changes the selection in the **File Name** list box.</span></span> <span data-ttu-id="6844e-233">若為 Explorer 樣式的 [ **開啟** ] 和 [ **另存** 新檔] 對話方塊，此訊息已由 [**CDN \_ SELCHANGE**](cdn-selchange.md) 通知訊息取代。</span><span class="sxs-lookup"><span data-stu-id="6844e-233">For Explorer-style **Open** and **Save As** dialog boxes, this message has been superseded by the [**CDN\_SELCHANGE**](cdn-selchange.md) notification message.</span></span><br/>                                                                                           |
| [<span data-ttu-id="6844e-234">**SETRGBSTRING**</span><span class="sxs-lookup"><span data-stu-id="6844e-234">**SETRGBSTRING**</span></span>](setrgbstring.md)   | <span data-ttu-id="6844e-235">攔截程式可以將此訊息傳送至 [ **色彩** ] 對話方塊，以設定目前的色彩選取範圍。</span><span class="sxs-lookup"><span data-stu-id="6844e-235">A hook procedure can send this message to a **Color** dialog box to set the current color selection.</span></span>                                                                                                                                                                                                                                                                                                                   |
| [<span data-ttu-id="6844e-236">**SHAREVISTRING**</span><span class="sxs-lookup"><span data-stu-id="6844e-236">**SHAREVISTRING**</span></span>](sharevistring.md) | <span data-ttu-id="6844e-237">當使用者按一下 [**確定]** 按鈕時，如果選取的檔案發生共用違規，[**開啟**] 或 [**另存** 新檔] 對話方塊會將此訊息傳送至攔截程式。</span><span class="sxs-lookup"><span data-stu-id="6844e-237">An **Open** or **Save As** dialog box sends this message to the hook procedure if a sharing violation occurs for the selected file when the user clicks the **OK** button.</span></span> <span data-ttu-id="6844e-238">若為 Explorer 樣式的 [ **開啟** ] 和 [ **另存** 新檔] 對話方塊，此訊息已由 [**CDN \_ SHAREVIOLATION**](cdn-shareviolation.md) 通知訊息取代。</span><span class="sxs-lookup"><span data-stu-id="6844e-238">For Explorer-style **Open** and **Save As** dialog boxes, this message has been superseded by the [**CDN\_SHAREVIOLATION**](cdn-shareviolation.md) notification message.</span></span><br/>                                                        |



 

<span data-ttu-id="6844e-239">某些常見的對話方塊會傳送和接收其他視窗訊息。</span><span class="sxs-lookup"><span data-stu-id="6844e-239">Some common dialog boxes send and receive other window messages.</span></span> <span data-ttu-id="6844e-240">[**字型**] 對話方塊的 [攔截程式] 可將任何 **WM \_ CHOOSEFONT \_ \*** 訊息傳送至 [**字型**] 對話方塊。</span><span class="sxs-lookup"><span data-stu-id="6844e-240">The hook procedure for a **Font** dialog box can send any of the **WM\_CHOOSEFONT\_\*** messages to the **Font** dialog box.</span></span> <span data-ttu-id="6844e-241">如需詳細資訊，請參閱 [ [字型] 對話方塊](font-dialog-box.md)。</span><span class="sxs-lookup"><span data-stu-id="6844e-241">For more information, see [Font Dialog Box](font-dialog-box.md).</span></span> <span data-ttu-id="6844e-242">如果您已啟用 [*PagePaintHook*](/windows/win32/api/commdlg/nc-commdlg-lppagepainthook)攔截 **程式**，則 [版面設定] 對話方塊會傳送 **WM \_ PSD \_ \*** 訊息。</span><span class="sxs-lookup"><span data-stu-id="6844e-242">The **Page Setup** dialog box sends the **WM\_PSD\_\*** messages if you have enabled a [*PagePaintHook*](/windows/win32/api/commdlg/nc-commdlg-lppagepainthook) hook procedure.</span></span> <span data-ttu-id="6844e-243">如需詳細資訊，請參閱版面 [設定對話方塊](page-setup-dialog-box.md)。</span><span class="sxs-lookup"><span data-stu-id="6844e-243">For more information, see [Page Setup Dialog Box](page-setup-dialog-box.md).</span></span>

<span data-ttu-id="6844e-244">Explorer 樣式的 [ **開啟** ] 和 [ **另存** 新檔] 對話方塊支援一組預先定義的訊息。</span><span class="sxs-lookup"><span data-stu-id="6844e-244">The Explorer-style **Open** and **Save As** dialog boxes support a set of predefined messages.</span></span> <span data-ttu-id="6844e-245">其中包括以 [**WM \_ 通知**](../controls/wm-notify.md) 訊息形式傳送至您的攔截程式訊息的通知訊息，以及您的攔截程式可傳送至對話方塊的訊息。</span><span class="sxs-lookup"><span data-stu-id="6844e-245">These include notification messages sent in the form of a [**WM\_NOTIFY**](../controls/wm-notify.md) message to your hook procedure, and messages that your hook procedure can send to the dialog box.</span></span> <span data-ttu-id="6844e-246">如需這些訊息的完整清單，請參閱 [Explorer 樣式的勾點程式](open-and-save-as-dialog-boxes.md)。</span><span class="sxs-lookup"><span data-stu-id="6844e-246">For a complete list of these messages, see [Explorer-Style Hook Procedures](open-and-save-as-dialog-boxes.md).</span></span>

## <a name="help-support"></a><span data-ttu-id="6844e-247">說明支援</span><span class="sxs-lookup"><span data-stu-id="6844e-247">Help Support</span></span>

<span data-ttu-id="6844e-248">通用對話方塊可提供對話方塊之標準控制項的即時線上說明。</span><span class="sxs-lookup"><span data-stu-id="6844e-248">Common dialog boxes provide context-sensitive help for the standard controls of the dialog box.</span></span> <span data-ttu-id="6844e-249">若要提供通用對話方塊的其他說明，您可以在使用者按下按鈕時，顯示 [說明 **] 按鈕並處理產生的訊息** 。</span><span class="sxs-lookup"><span data-stu-id="6844e-249">To provide additional help for a common dialog box, you can display a **Help** button and process messages generated when the user clicks the button.</span></span> <span data-ttu-id="6844e-250">[說明] 按鈕是預設即時線上說明的 **補充資訊。**</span><span class="sxs-lookup"><span data-stu-id="6844e-250">The **Help** button is a supplement to the default context-sensitive help.</span></span> <span data-ttu-id="6844e-251">[說明 **] 按鈕適用** 于描述對話方塊套用至應用程式時的一般用途。</span><span class="sxs-lookup"><span data-stu-id="6844e-251">The **Help** button is useful for describing the general purpose of the dialog box as it applies to your application.</span></span>

-   [<span data-ttu-id="6844e-252">即時線上說明</span><span class="sxs-lookup"><span data-stu-id="6844e-252">Context-Sensitive Help</span></span>](#context-sensitive-help)
-   <span data-ttu-id="6844e-253">[[說明] 按鈕](#the-help-button)</span><span class="sxs-lookup"><span data-stu-id="6844e-253">[The Help Button](#the-help-button)</span></span>

### <a name="context-sensitive-help"></a><span data-ttu-id="6844e-254">Context-Sensitive 說明</span><span class="sxs-lookup"><span data-stu-id="6844e-254">Context-Sensitive Help</span></span>

<span data-ttu-id="6844e-255">所有通用對話方塊都提供對話方塊之標準控制項的即時線上說明。</span><span class="sxs-lookup"><span data-stu-id="6844e-255">All common dialog boxes provide context-sensitive help for the standard controls of the dialog box.</span></span> <span data-ttu-id="6844e-256">使用者可以使用下列任一種方法來顯示個別控制項的說明：</span><span class="sxs-lookup"><span data-stu-id="6844e-256">The user can display help for individual controls by any of the following methods:</span></span>

-   <span data-ttu-id="6844e-257">選取控制項，然後按下 F1 鍵。</span><span class="sxs-lookup"><span data-stu-id="6844e-257">Selecting the control and pressing the F1 key.</span></span>
-   <span data-ttu-id="6844e-258">按一下 **？**</span><span class="sxs-lookup"><span data-stu-id="6844e-258">Clicking the **?**</span></span> <span data-ttu-id="6844e-259">按鈕，然後再按一下控制項。</span><span class="sxs-lookup"><span data-stu-id="6844e-259">button in the title bar and subsequently clicking on a control.</span></span>
-   <span data-ttu-id="6844e-260">在控制項上按一下滑鼠右鍵。</span><span class="sxs-lookup"><span data-stu-id="6844e-260">Clicking the right mouse button over a control.</span></span>

<span data-ttu-id="6844e-261">如果您加入新控制項來自訂對話方塊，您也必須藉由處理攔截程式中的 [說明] 要求，擴充這些控制項的 [說明] 支援。</span><span class="sxs-lookup"><span data-stu-id="6844e-261">If you customize a dialog box by adding new controls, you must also extend help support for these controls by processing requests for help in the hook procedure.</span></span> <span data-ttu-id="6844e-262">當使用者要求協助時，攔截程式會收到下列訊息。</span><span class="sxs-lookup"><span data-stu-id="6844e-262">The hook procedure receives the following messages when the user requests help.</span></span>



| <span data-ttu-id="6844e-263">使用者動作</span><span class="sxs-lookup"><span data-stu-id="6844e-263">User action</span></span>                                                           | <span data-ttu-id="6844e-264">訊息</span><span class="sxs-lookup"><span data-stu-id="6844e-264">Message</span></span>                                      |
|-----------------------------------------------------------------------|----------------------------------------------|
| <span data-ttu-id="6844e-265">在控制項上按一下滑鼠右鍵。</span><span class="sxs-lookup"><span data-stu-id="6844e-265">Click the right mouse button over a control.</span></span>                          | [<span data-ttu-id="6844e-266">**WM \_ CONTEXTMENU**</span><span class="sxs-lookup"><span data-stu-id="6844e-266">**WM\_CONTEXTMENU**</span></span>](/windows/desktop/menurc/wm-contextmenu) |
| <span data-ttu-id="6844e-267">按下 F1 鍵。</span><span class="sxs-lookup"><span data-stu-id="6844e-267">Pressed the F1 key.</span></span>                                                   | [<span data-ttu-id="6844e-268">**WM \_ 說明**</span><span class="sxs-lookup"><span data-stu-id="6844e-268">**WM\_HELP**</span></span>](../shell/wm-help.md)               |
| <span data-ttu-id="6844e-269">按一下 [ **？** ]</span><span class="sxs-lookup"><span data-stu-id="6844e-269">Clicked the **?**</span></span> <span data-ttu-id="6844e-270">按鈕，然後按一下控制項。</span><span class="sxs-lookup"><span data-stu-id="6844e-270">button on the title bar and then clicked a control.</span></span> | [<span data-ttu-id="6844e-271">**WM \_ 說明**</span><span class="sxs-lookup"><span data-stu-id="6844e-271">**WM\_HELP**</span></span>](../shell/wm-help.md)               |



 

<span data-ttu-id="6844e-272">您應該針對已加入的控制項處理這些訊息，但讓預設對話方塊程式處理標準控制項的訊息。</span><span class="sxs-lookup"><span data-stu-id="6844e-272">You should process these messages for the controls you have added, but let the default dialog box procedure process the messages for the standard controls.</span></span> <span data-ttu-id="6844e-273">如需如何處理這些訊息的詳細資訊，請 [參閱說明](/previous-versions/windows/desktop/legacy/bb776786(v=vs.85))。</span><span class="sxs-lookup"><span data-stu-id="6844e-273">For more information about how to process these messages, see [Help](/previous-versions/windows/desktop/legacy/bb776786(v=vs.85)).</span></span>

### <a name="the-help-button"></a><span data-ttu-id="6844e-274">[說明] 按鈕</span><span class="sxs-lookup"><span data-stu-id="6844e-274">The Help Button</span></span>

<span data-ttu-id="6844e-275">您可以在對話方塊的初始化結構的 **旗標** 成員中設定 **SHOWHELP** 值，以在任何通用對話方塊中顯示 [說明 **] 按鈕。**</span><span class="sxs-lookup"><span data-stu-id="6844e-275">You can display a **Help** button in any of the common dialog boxes by setting a **SHOWHELP** value in the **Flags** member of the initialization structure for the dialog box.</span></span> <span data-ttu-id="6844e-276">如果您顯示 [說明 **] 按鈕，** 就必須處理使用者的 [說明] 要求。</span><span class="sxs-lookup"><span data-stu-id="6844e-276">If you display the **Help** button, you must process the user's request for help.</span></span> <span data-ttu-id="6844e-277">您可以在其中一個應用程式的視窗程式中，或在對話方塊的勾點程式中完成處理。</span><span class="sxs-lookup"><span data-stu-id="6844e-277">The processing can be done either in one of your application's window procedures or in a hook procedure for the dialog box.</span></span> <span data-ttu-id="6844e-278">一般來說，您會呼叫 [**WinHelp**](/windows/win32/api/winuser/nf-winuser-winhelpa) 函式來處理要求以取得協助。</span><span class="sxs-lookup"><span data-stu-id="6844e-278">Typically, you would process the request for help by calling the [**WinHelp**](/windows/win32/api/winuser/nf-winuser-winhelpa) function.</span></span>

<span data-ttu-id="6844e-279">若要在其中一個視窗程式中處理說明訊息，您必須取得 [**HELPMSGSTRING**](helpmsgstring.md) 值所定義之字串的訊息識別碼，並識別要接收訊息的視窗。</span><span class="sxs-lookup"><span data-stu-id="6844e-279">To process help messages in one of your window procedures, you must get a message identifier for the string defined by the [**HELPMSGSTRING**](helpmsgstring.md) value and identify the window to receive messages.</span></span> <span data-ttu-id="6844e-280">若要取得訊息識別碼，請在 [**RegisterWindowMessage**](/windows/desktop/api/winuser/nf-winuser-registerwindowmessagea)函數的呼叫中指定 **HELPMSGSTRING** 做為參數。</span><span class="sxs-lookup"><span data-stu-id="6844e-280">To get the message identifier, specify **HELPMSGSTRING** as the parameter in a call to the [**RegisterWindowMessage**](/windows/desktop/api/winuser/nf-winuser-registerwindowmessagea) function.</span></span> <span data-ttu-id="6844e-281">當您建立對話方塊時，請使用對話方塊初始化結構的 **hwndOwner** 成員來識別要接收訊息的視窗。</span><span class="sxs-lookup"><span data-stu-id="6844e-281">When you create the dialog box, use the **hwndOwner** member of the dialog box initialization structure to identify the window that is to receive the messages.</span></span> <span data-ttu-id="6844e-282">每次使用者按一下 [說明 **] 按鈕時** ，對話方塊程式就會將訊息傳送至視窗程式。</span><span class="sxs-lookup"><span data-stu-id="6844e-282">The dialog box procedure sends the message to the window procedure whenever the user clicks the **Help** button.</span></span>

<span data-ttu-id="6844e-283">若要處理攔截程式中的說明訊息，您應該處理 [**WM \_ 命令**](/windows/desktop/menurc/wm-command) 訊息。</span><span class="sxs-lookup"><span data-stu-id="6844e-283">To process help messages in a hook procedure, you should process the [**WM\_COMMAND**](/windows/desktop/menurc/wm-command) message.</span></span> <span data-ttu-id="6844e-284">如果此訊息的 *wParam* 參數指出使用者按下 [說明 **] 按鈕，** 攔截程式就會提供協助。</span><span class="sxs-lookup"><span data-stu-id="6844e-284">The hook procedure provides help if the *wParam* parameter of this message indicates that the user clicked the **Help** button.</span></span> <span data-ttu-id="6844e-285">**[說明] 按鈕的** 識別碼是 Dlgs .h 檔中定義的 **pshHelp** 常數。</span><span class="sxs-lookup"><span data-stu-id="6844e-285">The identifier of the **Help** button is the **pshHelp** constant defined in the Dlgs.h file.</span></span>

<span data-ttu-id="6844e-286">針對 [Explorer 樣式 **開啟**] 和 [**另存** 新檔] 對話方塊的 [掛上] 程式，不會收到 [說明 **] 按鈕的** [**WM \_ 命令**](/windows/desktop/menurc/wm-command)訊息。</span><span class="sxs-lookup"><span data-stu-id="6844e-286">Hook procedures for the Explorer-style **Open** and **Save As** dialog boxes do not receive [**WM\_COMMAND**](/windows/desktop/menurc/wm-command) messages for the **Help** button.</span></span> <span data-ttu-id="6844e-287">相反地，當您按一下 [說明 **] 按鈕時**，對話方塊會將 [**CDN \_ 說明**](cdn-help.md)通知訊息傳送到攔截程式。</span><span class="sxs-lookup"><span data-stu-id="6844e-287">Instead, the dialog box sends a [**CDN\_HELP**](cdn-help.md) notification message to the hook procedure when the **Help** button is clicked.</span></span>

 

