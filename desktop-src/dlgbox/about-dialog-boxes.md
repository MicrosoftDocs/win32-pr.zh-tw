---
title: 關於對話方塊
description: 本主題討論如何使用對話方塊來建立應用程式的使用者介面。
ms.assetid: 51960c28-a178-4ad3-b45e-426fec42a945
keywords:
- 對話方塊，關於
- 對話方塊、使用時機
- 強制回應對話方塊
- 非強制回應對話方塊
- 對話方塊，強制回應
- 對話方塊、非模式
- 對話方塊、範本
- 對話方塊、擁有者視窗
- 對話方塊、訊息方塊
- 對話方塊程式
- 訊息方塊
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 45dd78713c3b87e54e8a992ea9415577c522fc9e
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/20/2020
ms.locfileid: "104023856"
---
# <a name="about-dialog-boxes"></a><span data-ttu-id="2d18e-114">關於對話方塊</span><span class="sxs-lookup"><span data-stu-id="2d18e-114">About Dialog Boxes</span></span>

<span data-ttu-id="2d18e-115">有許多功能、訊息和預先定義的控制項可協助您建立和管理對話方塊，因此可讓您更輕鬆地開發應用程式的使用者介面。</span><span class="sxs-lookup"><span data-stu-id="2d18e-115">There are many functions, messages, and predefined controls to help create and manage dialog boxes, thus making it easier to develop the user interface for an application.</span></span> <span data-ttu-id="2d18e-116">本總覽描述對話方塊函式和訊息，並說明如何使用它們來建立和使用對話方塊。</span><span class="sxs-lookup"><span data-stu-id="2d18e-116">This overview describes the dialog box functions and messages and explains how to use them to create and use dialog boxes.</span></span>

<span data-ttu-id="2d18e-117">本總覽包含下列主題：</span><span class="sxs-lookup"><span data-stu-id="2d18e-117">This overview includes the following topics:</span></span>

-   [<span data-ttu-id="2d18e-118">使用對話方塊的時機</span><span class="sxs-lookup"><span data-stu-id="2d18e-118">When to Use a Dialog Box</span></span>](#when-to-use-a-dialog-box)
-   [<span data-ttu-id="2d18e-119">對話方塊擁有者視窗</span><span class="sxs-lookup"><span data-stu-id="2d18e-119">Dialog Box Owner Window</span></span>](#dialog-box-owner-window)
-   [<span data-ttu-id="2d18e-120">訊息方塊</span><span class="sxs-lookup"><span data-stu-id="2d18e-120">Message Boxes</span></span>](#message-boxes)
-   [<span data-ttu-id="2d18e-121">強制回應對話方塊</span><span class="sxs-lookup"><span data-stu-id="2d18e-121">Modal Dialog Boxes</span></span>](#modal-dialog-boxes)
-   [<span data-ttu-id="2d18e-122">非強制回應對話方塊</span><span class="sxs-lookup"><span data-stu-id="2d18e-122">Modeless Dialog Boxes</span></span>](#modeless-dialog-boxes)
-   [<span data-ttu-id="2d18e-123">對話方塊範本</span><span class="sxs-lookup"><span data-stu-id="2d18e-123">Dialog Box Templates</span></span>](#dialog-box-templates)
    -   [<span data-ttu-id="2d18e-124">對話方塊範本樣式</span><span class="sxs-lookup"><span data-stu-id="2d18e-124">Dialog Box Template Styles</span></span>](#dialog-box-template-styles)
    -   [<span data-ttu-id="2d18e-125">對話方塊度量</span><span class="sxs-lookup"><span data-stu-id="2d18e-125">Dialog Box Measurements</span></span>](#dialog-box-measurements)
    -   [<span data-ttu-id="2d18e-126">對話方塊控制項</span><span class="sxs-lookup"><span data-stu-id="2d18e-126">Dialog Box Controls</span></span>](#dialog-box-controls)
    -   [<span data-ttu-id="2d18e-127">對話方塊視窗功能表</span><span class="sxs-lookup"><span data-stu-id="2d18e-127">Dialog Box Window Menu</span></span>](#dialog-box-window-menu)
    -   [<span data-ttu-id="2d18e-128">對話方塊字型</span><span class="sxs-lookup"><span data-stu-id="2d18e-128">Dialog Box Fonts</span></span>](#dialog-box-fonts)
    -   [<span data-ttu-id="2d18e-129">記憶體中的範本</span><span class="sxs-lookup"><span data-stu-id="2d18e-129">Templates in Memory</span></span>](#templates-in-memory)

<span data-ttu-id="2d18e-130">如需通用對話方塊的詳細資訊，請參閱 [通用對話方塊程式庫](common-dialog-box-library.md)。</span><span class="sxs-lookup"><span data-stu-id="2d18e-130">For more information about the common dialog boxes, see [Common Dialog Box Library](common-dialog-box-library.md).</span></span>

## <a name="when-to-use-a-dialog-box"></a><span data-ttu-id="2d18e-131">使用對話方塊的時機</span><span class="sxs-lookup"><span data-stu-id="2d18e-131">When to Use a Dialog Box</span></span>

<span data-ttu-id="2d18e-132">大部分的應用程式會使用對話方塊來提示需要使用者輸入的功能表項目的其他資訊。</span><span class="sxs-lookup"><span data-stu-id="2d18e-132">Most applications use dialog boxes to prompt for additional information for menu items that require user input.</span></span> <span data-ttu-id="2d18e-133">使用對話方塊是應用程式取得輸入的唯一建議方式。</span><span class="sxs-lookup"><span data-stu-id="2d18e-133">Using a dialog box is the only recommended way for an application to retrieve the input.</span></span> <span data-ttu-id="2d18e-134">例如，一般的 **開啟** 功能表項目需要開啟的檔案名，因此應用程式應該使用對話方塊來提示使用者輸入名稱。</span><span class="sxs-lookup"><span data-stu-id="2d18e-134">For example, a typical **Open** menu item requires the name of a file to open, so an application should use a dialog box to prompt the user for the name.</span></span> <span data-ttu-id="2d18e-135">在這種情況下，應用程式會在使用者按一下功能表項目時建立對話方塊，並在使用者提供資訊之後立即終結對話方塊。</span><span class="sxs-lookup"><span data-stu-id="2d18e-135">In such cases, the application creates the dialog box when the user clicks the menu item and destroys the dialog box immediately after the user supplies the information.</span></span>

<span data-ttu-id="2d18e-136">當使用者在另一個視窗中工作時，許多應用程式也會使用對話方塊來顯示資訊或選項。</span><span class="sxs-lookup"><span data-stu-id="2d18e-136">Many applications also use dialog boxes to display information or options while the user works in another window.</span></span> <span data-ttu-id="2d18e-137">例如，文字處理應用程式通常會使用具有文字搜尋選項的對話方塊。</span><span class="sxs-lookup"><span data-stu-id="2d18e-137">For example, word processing applications often use a dialog box with a text-search option.</span></span> <span data-ttu-id="2d18e-138">當應用程式搜尋文字時，對話方塊會留在螢幕上。</span><span class="sxs-lookup"><span data-stu-id="2d18e-138">While the application searches for the text, the dialog box remains on the screen.</span></span> <span data-ttu-id="2d18e-139">然後，使用者可以返回對話方塊，然後再次搜尋相同的單字;或者，使用者可以變更對話方塊中的專案，並搜尋新的單字。</span><span class="sxs-lookup"><span data-stu-id="2d18e-139">The user can then return to the dialog box and search for the same word again; or the user can change the entry in the dialog box and search for a new word.</span></span> <span data-ttu-id="2d18e-140">以這種方式使用對話方塊的應用程式通常會在使用者按一下功能表項目時建立一個，並在應用程式執行時或使用者明確關閉對話方塊之前，繼續顯示該專案。</span><span class="sxs-lookup"><span data-stu-id="2d18e-140">Applications that use dialog boxes in this way typically create one when the user clicks the menu item and continue to display it for as long as the application runs or until the user explicitly closes the dialog box.</span></span>

<span data-ttu-id="2d18e-141">為了支援應用程式使用對話方塊的不同方式，有兩種類型的對話方塊：強制回應和非模式。</span><span class="sxs-lookup"><span data-stu-id="2d18e-141">To support the different ways applications use dialog boxes, there are two types of dialog box: modal and modeless.</span></span> <span data-ttu-id="2d18e-142">*強制回應對話方塊* 會要求使用者提供資訊或取消對話方塊，才能允許應用程式繼續進行。</span><span class="sxs-lookup"><span data-stu-id="2d18e-142">A *modal dialog box* requires the user to supply information or cancel the dialog box before allowing the application to continue.</span></span> <span data-ttu-id="2d18e-143">應用程式會使用強制回應對話方塊搭配需要額外資訊的功能表項目，才能繼續進行。</span><span class="sxs-lookup"><span data-stu-id="2d18e-143">Applications use modal dialog boxes in conjunction with menu items that require additional information before they can proceed.</span></span> <span data-ttu-id="2d18e-144">非 *強制回應對話方塊* 可讓使用者提供資訊，並回到上一個工作，而不需要關閉對話方塊。</span><span class="sxs-lookup"><span data-stu-id="2d18e-144">A *modeless dialog box* allows the user to supply information and return to the previous task without closing the dialog box.</span></span> <span data-ttu-id="2d18e-145">強制回應對話方塊比非強制回應對話方塊更容易管理，因為它們是建立的、執行其工作，並藉由呼叫單一函式終結。</span><span class="sxs-lookup"><span data-stu-id="2d18e-145">Modal dialog boxes are simpler to manage than modeless dialog boxes because they are created, perform their task, and are destroyed by calling a single function.</span></span>

<span data-ttu-id="2d18e-146">若要建立強制回應或非強制回應對話方塊，應用程式必須提供對話方塊範本以描述對話方塊樣式和內容;應用程式也必須提供對話方塊程式來執行工作。</span><span class="sxs-lookup"><span data-stu-id="2d18e-146">To create either a modal or modeless dialog box, an application must supply a dialog box template to describe the dialog box style and content; the application must also supply a dialog box procedure to carry out tasks.</span></span> <span data-ttu-id="2d18e-147">*對話方塊範本* 是對話方塊和它所包含之控制項的二進位描述。</span><span class="sxs-lookup"><span data-stu-id="2d18e-147">The *dialog box template* is a binary description of the dialog box and the controls it contains.</span></span> <span data-ttu-id="2d18e-148">開發人員可以建立此範本作為資源，以從應用程式的可執行檔載入，或在應用程式執行時在記憶體中建立。</span><span class="sxs-lookup"><span data-stu-id="2d18e-148">The developer can create this template as a resource to be loaded from the application's executable file, or created in memory while the application runs.</span></span> <span data-ttu-id="2d18e-149">*對話方塊* 程式是一種應用程式定義的回呼函式，當系統有輸入對話方塊或對話方塊的工作要執行時，系統就會呼叫這個函式。雖然對話方塊程式類似于視窗程式，但它並沒有相同的責任。</span><span class="sxs-lookup"><span data-stu-id="2d18e-149">The *dialog box procedure* is an application-defined callback function that the system calls when it has input for the dialog box or tasks for the dialog box to carry out. Although a dialog box procedure is similar to a window procedure, it does not have the same responsibilities.</span></span>

<span data-ttu-id="2d18e-150">應用程式通常會使用 [**對話方塊**](/windows/desktop/api/Winuser/nf-winuser-dialogboxa) 或 [**CreateDialog**](/windows/desktop/api/Winuser/nf-winuser-createdialoga) 函數來建立對話方塊。</span><span class="sxs-lookup"><span data-stu-id="2d18e-150">An application typically creates a dialog box by using either the [**DialogBox**](/windows/desktop/api/Winuser/nf-winuser-dialogboxa) or [**CreateDialog**](/windows/desktop/api/Winuser/nf-winuser-createdialoga) function.</span></span> <span data-ttu-id="2d18e-151">**對話方塊** 會建立強制回應對話方塊; **CreateDialog** 會建立非強制回應對話方塊。</span><span class="sxs-lookup"><span data-stu-id="2d18e-151">**DialogBox** creates a modal dialog box; **CreateDialog** creates a modeless dialog box.</span></span> <span data-ttu-id="2d18e-152">這兩個函式會從應用程式的可執行檔中載入對話方塊範本，並建立符合範本規格的快顯視窗。</span><span class="sxs-lookup"><span data-stu-id="2d18e-152">These two functions load a dialog box template from the application's executable file and create a pop-up window that matches the template's specifications.</span></span> <span data-ttu-id="2d18e-153">另外還有其他函式會使用記憶體中的範本來建立對話方塊;他們會在對話方塊建立時，將其他資訊傳遞給對話方塊程式。</span><span class="sxs-lookup"><span data-stu-id="2d18e-153">There are other functions that create a dialog box by using templates in memory; they pass additional information to the dialog box procedure as the dialog box is created.</span></span>

<span data-ttu-id="2d18e-154">對話方塊通常屬於預先定義、專屬的視窗類別。</span><span class="sxs-lookup"><span data-stu-id="2d18e-154">Dialog boxes usually belong to a predefined, exclusive window class.</span></span> <span data-ttu-id="2d18e-155">系統會針對強制回應和非強制回應對話方塊使用此視窗類別和其對應的視窗程式。</span><span class="sxs-lookup"><span data-stu-id="2d18e-155">The system uses this window class and its corresponding window procedure for both modal and modeless dialog boxes.</span></span> <span data-ttu-id="2d18e-156">呼叫函式時，它會建立對話方塊的視窗，以及對話方塊中控制項的視窗，然後將選取的訊息傳送至對話方塊程式。</span><span class="sxs-lookup"><span data-stu-id="2d18e-156">When the function is called, it creates the window for the dialog box, as well as the windows for the controls in the dialog box, then sends selected messages to the dialog box procedure.</span></span> <span data-ttu-id="2d18e-157">當對話方塊顯示時，預先定義的視窗程式會管理所有訊息、處理一些訊息，並將其他訊息傳遞至對話方塊程式，讓程式可以執行工作。</span><span class="sxs-lookup"><span data-stu-id="2d18e-157">While the dialog box is visible, the predefined window procedure manages all messages, processing some messages and passing others to the dialog box procedure so that the procedure can carry out tasks.</span></span> <span data-ttu-id="2d18e-158">應用程式無法直接存取預先定義的視窗類別或視窗程式，但是可以使用對話方塊範本和對話方塊程式來修改對話方塊的樣式和行為。</span><span class="sxs-lookup"><span data-stu-id="2d18e-158">Applications do not have direct access to the predefined window class or window procedure, but they can use the dialog box template and dialog box procedure to modify the style and behavior of a dialog box.</span></span>

## <a name="dialog-box-owner-window"></a><span data-ttu-id="2d18e-159">對話方塊擁有者視窗</span><span class="sxs-lookup"><span data-stu-id="2d18e-159">Dialog Box Owner Window</span></span>

<span data-ttu-id="2d18e-160">大部分的對話方塊都有擁有者視窗 (或更簡單的) 擁有者。</span><span class="sxs-lookup"><span data-stu-id="2d18e-160">Most dialog boxes have an owner window (or more simply, an owner).</span></span> <span data-ttu-id="2d18e-161">建立對話方塊時，應用程式會藉由指定擁有者的視窗控制碼來設定擁有者。</span><span class="sxs-lookup"><span data-stu-id="2d18e-161">When creating the dialog box, the application sets the owner by specifying the owner's window handle.</span></span> <span data-ttu-id="2d18e-162">系統會使用擁有者來判斷對話方塊在 Z 順序中的位置，讓對話方塊永遠定位於其擁有者的上方。</span><span class="sxs-lookup"><span data-stu-id="2d18e-162">The system uses the owner to determine the position of the dialog box in the Z order so that the dialog box is always positioned above its owner.</span></span> <span data-ttu-id="2d18e-163">此外，系統也可以將訊息傳送至擁有者的視窗程式，在對話方塊中通知事件。</span><span class="sxs-lookup"><span data-stu-id="2d18e-163">Also, the system can send messages to the window procedure of the owner, notifying it of events in the dialog box.</span></span>

<span data-ttu-id="2d18e-164">只要隱藏或終結其擁有者，系統就會自動隱藏或終結對話方塊。</span><span class="sxs-lookup"><span data-stu-id="2d18e-164">The system automatically hides or destroys the dialog box whenever its owner is hidden or destroyed.</span></span> <span data-ttu-id="2d18e-165">這表示對話方塊程式不需要任何特殊的處理，就能偵測擁有者視窗的狀態變更。</span><span class="sxs-lookup"><span data-stu-id="2d18e-165">This means the dialog box procedure requires no special processing to detect changes to the state of the owner window.</span></span>

<span data-ttu-id="2d18e-166">由於一般對話方塊會與功能表項目一起使用，因此擁有者視窗通常是包含功能表的視窗。</span><span class="sxs-lookup"><span data-stu-id="2d18e-166">Because the typical dialog box is used in conjunction with a menu item, the owner window is usually the window containing the menu.</span></span> <span data-ttu-id="2d18e-167">雖然可以建立沒有擁有者的對話方塊，但不建議您這樣做。</span><span class="sxs-lookup"><span data-stu-id="2d18e-167">Although it is possible to create a dialog box that has no owner, it is not recommended.</span></span> <span data-ttu-id="2d18e-168">例如，當強制回應對話方塊沒有擁有者時，系統不會停用任何應用程式的其他視窗，而且可讓使用者繼續在其他視窗中執行工作，失去強制回應對話方塊的用途。</span><span class="sxs-lookup"><span data-stu-id="2d18e-168">For example, when a modal dialog box has no owner, the system does not disable any of the application's other windows and allows the user to continue to carry out work in the other windows, defeating the purpose of the modal dialog box.</span></span>

<span data-ttu-id="2d18e-169">當非強制回應對話方塊沒有擁有者時，系統不會在應用程式中的其他視窗隱藏或損毀時隱藏或終結對話方塊。</span><span class="sxs-lookup"><span data-stu-id="2d18e-169">When a modeless dialog box has no owner, the system neither hides nor destroys the dialog box when other windows in the application are hidden or destroyed.</span></span> <span data-ttu-id="2d18e-170">雖然這不會破壞非強制回應對話方塊的用途，但應用程式需要執行特殊處理，以確保對話方塊在適當的時間隱藏並終結。</span><span class="sxs-lookup"><span data-stu-id="2d18e-170">Although this does not defeat the purpose of the modeless dialog box, it requires that the application carry out special processing to ensure the dialog box is hidden and destroyed at appropriate times.</span></span>

## <a name="message-boxes"></a><span data-ttu-id="2d18e-171">訊息方塊</span><span class="sxs-lookup"><span data-stu-id="2d18e-171">Message Boxes</span></span>

<span data-ttu-id="2d18e-172">訊息方塊是一個特殊對話方塊，可讓應用程式用來顯示訊息並提示輸入簡單的輸入。</span><span class="sxs-lookup"><span data-stu-id="2d18e-172">A message box is a special dialog box that an application can use to display messages and prompt for simple input.</span></span> <span data-ttu-id="2d18e-173">訊息方塊通常包含文字訊息和一或多個按鈕。</span><span class="sxs-lookup"><span data-stu-id="2d18e-173">A message box typically contains a text message and one or more buttons.</span></span> <span data-ttu-id="2d18e-174">應用程式會使用 [**MessageBox**](/windows/desktop/api/Winuser/nf-winuser-messagebox) 或 [**MessageBoxEx**](/windows/desktop/api/Winuser/nf-winuser-messageboxexa) 函式來建立訊息方塊，並指定要顯示的文字和按鈕的數目和類型。</span><span class="sxs-lookup"><span data-stu-id="2d18e-174">An application creates the message box by using the [**MessageBox**](/windows/desktop/api/Winuser/nf-winuser-messagebox) or [**MessageBoxEx**](/windows/desktop/api/Winuser/nf-winuser-messageboxexa) function, specifying the text and the number and types of buttons to display.</span></span> <span data-ttu-id="2d18e-175">請注意， **MessageBox** 和 **MessageBoxEx** 的運作方式目前沒有任何差異。</span><span class="sxs-lookup"><span data-stu-id="2d18e-175">Note that currently there is no difference between how **MessageBox** and **MessageBoxEx** work.</span></span>

<span data-ttu-id="2d18e-176">雖然訊息方塊是對話方塊，但系統會完全掌控訊息方塊的建立和管理。</span><span class="sxs-lookup"><span data-stu-id="2d18e-176">Although the message box is a dialog box, the system takes complete control of the creation and management of the message box.</span></span> <span data-ttu-id="2d18e-177">這表示應用程式不會提供對話方塊範本和對話方塊程式。</span><span class="sxs-lookup"><span data-stu-id="2d18e-177">This means the application does not provide a dialog box template and dialog box procedure.</span></span> <span data-ttu-id="2d18e-178">系統會根據針對訊息方塊所指定的文字和按鈕來建立自己的範本，並提供自己的對話方塊程式。</span><span class="sxs-lookup"><span data-stu-id="2d18e-178">The system creates its own template based on the text and buttons specified for the message box and supplies its own dialog box procedure.</span></span>

<span data-ttu-id="2d18e-179">訊息方塊是強制回應對話方塊，系統會使用 [**對話方塊**](/windows/desktop/api/Winuser/nf-winuser-dialogboxa) 所使用的相同內建函式來建立它。</span><span class="sxs-lookup"><span data-stu-id="2d18e-179">A message box is a modal dialog box and the system creates it by using the same internal functions that [**DialogBox**](/windows/desktop/api/Winuser/nf-winuser-dialogboxa) uses.</span></span> <span data-ttu-id="2d18e-180">如果應用程式在呼叫 [**MessageBox**](/windows/desktop/api/Winuser/nf-winuser-messagebox) 或 [**MessageBoxEx**](/windows/desktop/api/Winuser/nf-winuser-messageboxexa)時指定擁有者視窗，系統會停用擁有者。</span><span class="sxs-lookup"><span data-stu-id="2d18e-180">If the application specifies an owner window when calling [**MessageBox**](/windows/desktop/api/Winuser/nf-winuser-messagebox) or [**MessageBoxEx**](/windows/desktop/api/Winuser/nf-winuser-messageboxexa), the system disables the owner.</span></span> <span data-ttu-id="2d18e-181">應用程式也可以指示系統停用所有屬於目前線程的最上層視窗，方法是在建立對話方塊時指定 **MB \_ TASKMODAL** 值。</span><span class="sxs-lookup"><span data-stu-id="2d18e-181">An application can also direct the system to disable all top-level windows belonging to the current thread by specifying the **MB\_TASKMODAL** value when creating the dialog box.</span></span>

<span data-ttu-id="2d18e-182">系統可以將訊息傳送給擁有者，例如 [**wm \_ CANCELMODE**](/windows/desktop/winmsg/wm-cancelmode) 和 [**wm \_ 啟用**](/windows/desktop/winmsg/wm-enable)，就像在建立強制回應對話方塊時一樣。</span><span class="sxs-lookup"><span data-stu-id="2d18e-182">The system can send messages to the owner, such as [**WM\_CANCELMODE**](/windows/desktop/winmsg/wm-cancelmode) and [**WM\_ENABLE**](/windows/desktop/winmsg/wm-enable), just as it does when creating a modal dialog box.</span></span> <span data-ttu-id="2d18e-183">擁有者視窗應該執行這些訊息所要求的任何動作。</span><span class="sxs-lookup"><span data-stu-id="2d18e-183">The owner window should carry out any actions requested by these messages.</span></span>

## <a name="modal-dialog-boxes"></a><span data-ttu-id="2d18e-184">強制回應對話方塊</span><span class="sxs-lookup"><span data-stu-id="2d18e-184">Modal Dialog Boxes</span></span>

<span data-ttu-id="2d18e-185">強制回應對話方塊應該是具有視窗功能表、標題列和粗框線的快顯視窗。也就是說，對話方塊範本應該指定 **ws \_ 快顯視窗**、 **ws \_ SYSMENU**、 **ws \_ 標題** 和 **DS \_ MODALFRAME** 樣式。</span><span class="sxs-lookup"><span data-stu-id="2d18e-185">A modal dialog box should be a pop-up window having a window menu, a title bar, and a thick border; that is, the dialog box template should specify the **WS\_POPUP**, **WS\_SYSMENU**, **WS\_CAPTION**, and **DS\_MODALFRAME** styles.</span></span> <span data-ttu-id="2d18e-186">雖然應用程式可以指定 **ws \_ 可見** 樣式，但是無論對話方塊範本是否指定 **ws \_ 可見** 樣式，系統一律會顯示模式對話方塊。</span><span class="sxs-lookup"><span data-stu-id="2d18e-186">Although an application can designate the **WS\_VISIBLE** style, the system always displays a modal dialog box regardless of whether the dialog box template specifies the **WS\_VISIBLE** style.</span></span> <span data-ttu-id="2d18e-187">應用程式不能建立具有 **WS \_ 子** 樣式的強制回應對話方塊。</span><span class="sxs-lookup"><span data-stu-id="2d18e-187">An application must not create a modal dialog box having the **WS\_CHILD** style.</span></span> <span data-ttu-id="2d18e-188">具有此樣式的強制回應對話方塊會自行停用，防止任何後續的輸入到達應用程式。</span><span class="sxs-lookup"><span data-stu-id="2d18e-188">A modal dialog box with this style disables itself, preventing any subsequent input from reaching the application.</span></span>

<span data-ttu-id="2d18e-189">應用程式會使用 [**對話方塊**](/windows/desktop/api/Winuser/nf-winuser-dialogboxa) 或 [**DialogBoxIndirect**](/windows/desktop/api/Winuser/nf-winuser-dialogboxindirecta) 函數來建立強制回應對話方塊。</span><span class="sxs-lookup"><span data-stu-id="2d18e-189">An application creates a modal dialog box by using either the [**DialogBox**](/windows/desktop/api/Winuser/nf-winuser-dialogboxa) or [**DialogBoxIndirect**](/windows/desktop/api/Winuser/nf-winuser-dialogboxindirecta) function.</span></span> <span data-ttu-id="2d18e-190">**對話方塊** 需要包含對話方塊範本之資源的名稱或識別碼; **DialogBoxIndirect** 需要包含對話方塊範本的記憶體物件控制碼。</span><span class="sxs-lookup"><span data-stu-id="2d18e-190">**DialogBox** requires the name or identifier of a resource containing a dialog box template; **DialogBoxIndirect** requires a handle to a memory object containing a dialog box template.</span></span> <span data-ttu-id="2d18e-191">[**DialogBoxParam**](/windows/desktop/api/Winuser/nf-winuser-dialogboxparama)和 [**DialogBoxIndirectParam**](/windows/desktop/api/Winuser/nf-winuser-dialogboxindirectparama)函數也會建立強制回應對話方塊;它們與先前所述的函式相同，但在建立對話方塊時，會將指定的參數傳遞至對話方塊程式。</span><span class="sxs-lookup"><span data-stu-id="2d18e-191">The [**DialogBoxParam**](/windows/desktop/api/Winuser/nf-winuser-dialogboxparama) and [**DialogBoxIndirectParam**](/windows/desktop/api/Winuser/nf-winuser-dialogboxindirectparama) functions also create modal dialog boxes; they are identical to the previously mentioned functions but pass a specified parameter to the dialog box procedure when the dialog box is created.</span></span>

<span data-ttu-id="2d18e-192">建立強制回應對話方塊時，系統會讓它成為使用中視窗。</span><span class="sxs-lookup"><span data-stu-id="2d18e-192">When creating the modal dialog box, the system makes it the active window.</span></span> <span data-ttu-id="2d18e-193">此對話方塊會保持作用中，直到對話方塊程式呼叫 [**EndDialog**](/windows/desktop/api/Winuser/nf-winuser-enddialog) 函式，或系統在另一個應用程式中啟用視窗為止。</span><span class="sxs-lookup"><span data-stu-id="2d18e-193">The dialog box remains active until the dialog box procedure calls the [**EndDialog**](/windows/desktop/api/Winuser/nf-winuser-enddialog) function or the system activates a window in another application.</span></span> <span data-ttu-id="2d18e-194">使用者和應用程式都不能讓擁有者視窗變成作用中，直到強制回應對話方塊終結為止。</span><span class="sxs-lookup"><span data-stu-id="2d18e-194">Neither the user nor the application can make the owner window active until the modal dialog box is destroyed.</span></span>

<span data-ttu-id="2d18e-195">當擁有者視窗尚未停用時，系統會在建立強制回應對話方塊時，自動停用視窗和任何屬於該視窗的子視窗。</span><span class="sxs-lookup"><span data-stu-id="2d18e-195">When the owner window is not already disabled, the system automatically disables the window and any child windows belonging to it when it creates the modal dialog box.</span></span> <span data-ttu-id="2d18e-196">擁有者視窗會保持停用，直到對話方塊損毀為止。</span><span class="sxs-lookup"><span data-stu-id="2d18e-196">The owner window remains disabled until the dialog box is destroyed.</span></span> <span data-ttu-id="2d18e-197">雖然對話方塊程式可能會隨時啟用 [擁有者] 視窗，但讓擁有者無法通過模式對話方塊的目的，也不建議使用。</span><span class="sxs-lookup"><span data-stu-id="2d18e-197">Although a dialog box procedure could potentially enable the owner window at any time, enabling the owner defeats the purpose of the modal dialog box and is not recommended.</span></span> <span data-ttu-id="2d18e-198">當對話方塊程式損毀時，系統會再次啟用 [擁有者] 視窗，但只有在強制回應對話方塊造成停用擁有者時才會這樣做。</span><span class="sxs-lookup"><span data-stu-id="2d18e-198">When the dialog box procedure is destroyed, the system enables the owner window again, but only if the modal dialog box caused the owner to be disabled.</span></span>

<span data-ttu-id="2d18e-199">當系統建立強制回應對話方塊時，它會將 [**WM \_ CANCELMODE**](/windows/desktop/winmsg/wm-cancelmode) 訊息傳送到視窗 (如果有任何) 正在捕捉滑鼠輸入。</span><span class="sxs-lookup"><span data-stu-id="2d18e-199">As the system creates the modal dialog box, it sends the [**WM\_CANCELMODE**](/windows/desktop/winmsg/wm-cancelmode) message to the window (if any) currently capturing mouse input.</span></span> <span data-ttu-id="2d18e-200">接收此訊息的應用程式應該放開滑鼠捕捉，讓使用者可以將滑鼠移至強制回應對話方塊。</span><span class="sxs-lookup"><span data-stu-id="2d18e-200">An application that receives this message should release the mouse capture so that the user can move the mouse in the modal dialog box.</span></span> <span data-ttu-id="2d18e-201">由於系統會停用擁有者視窗，如果擁有者無法在收到此訊息時放開滑鼠，則所有的滑鼠輸入都會遺失。</span><span class="sxs-lookup"><span data-stu-id="2d18e-201">Because the system disables the owner window, all mouse input is lost if the owner fails to release the mouse upon receiving this message.</span></span>

<span data-ttu-id="2d18e-202">為了處理強制回應對話方塊的訊息，系統會啟動自己的訊息迴圈，並暫時控制整個應用程式的訊息佇列。</span><span class="sxs-lookup"><span data-stu-id="2d18e-202">To process messages for the modal dialog box, the system starts its own message loop, taking temporary control of the message queue for the entire application.</span></span> <span data-ttu-id="2d18e-203">當系統抓取未針對此對話方塊明確的訊息時，它會將訊息分派至適當的視窗。</span><span class="sxs-lookup"><span data-stu-id="2d18e-203">When the system retrieves a message that is not explicitly for the dialog box, it dispatches the message to the appropriate window.</span></span> <span data-ttu-id="2d18e-204">如果它抓取了 [**WM \_**](/windows/desktop/winmsg/wm-quit) 結束訊息，它會將訊息張貼回應用程式訊息佇列，讓應用程式的主要訊息迴圈最後可以取得訊息。</span><span class="sxs-lookup"><span data-stu-id="2d18e-204">If it retrieves a [**WM\_QUIT**](/windows/desktop/winmsg/wm-quit) message, it posts the message back to the application message queue so that the application's main message loop can eventually retrieve the message.</span></span>

<span data-ttu-id="2d18e-205">只要應用程式訊息佇列是空的，系統就會將 [**WM \_ ENTERIDLE**](wm-enteridle.md) 訊息傳送給擁有者視窗。</span><span class="sxs-lookup"><span data-stu-id="2d18e-205">The system sends the [**WM\_ENTERIDLE**](wm-enteridle.md) message to the owner window whenever the application message queue is empty.</span></span> <span data-ttu-id="2d18e-206">應用程式可以使用此訊息來執行背景工作，而對話方塊則會留在螢幕上。</span><span class="sxs-lookup"><span data-stu-id="2d18e-206">The application can use this message to carry out a background task while the dialog box remains on the screen.</span></span> <span data-ttu-id="2d18e-207">當應用程式以這種方式使用訊息時，應用程式必須經常產生控制 (例如，使用 [**PeekMessage**](/windows/desktop/api/winuser/nf-winuser-peekmessagea) 函數) ，讓強制回應對話方塊可以接收任何使用者輸入。</span><span class="sxs-lookup"><span data-stu-id="2d18e-207">When an application uses the message in this way, the application must frequently yield control (for example, by using the [**PeekMessage**](/windows/desktop/api/winuser/nf-winuser-peekmessagea) function) so that the modal dialog box can receive any user input.</span></span> <span data-ttu-id="2d18e-208">為了防止強制回應對話方塊傳送 **WM \_ ENTERIDLE** 訊息，應用程式可以在 \_ 建立對話方塊時指定 DS NOIDLEMSG 樣式。</span><span class="sxs-lookup"><span data-stu-id="2d18e-208">To prevent the modal dialog box from sending the **WM\_ENTERIDLE** messages, the application can specify the DS\_NOIDLEMSG style when creating the dialog box.</span></span>

<span data-ttu-id="2d18e-209">應用程式會使用 [**EndDialog**](/windows/desktop/api/Winuser/nf-winuser-enddialog) 函數來終結強制回應對話方塊。</span><span class="sxs-lookup"><span data-stu-id="2d18e-209">An application destroys a modal dialog box by using the [**EndDialog**](/windows/desktop/api/Winuser/nf-winuser-enddialog) function.</span></span> <span data-ttu-id="2d18e-210">在大多數情況下，當使用者從對話方塊的 [視窗] 功能表按一下 [**關閉**]，或按一下對話方塊中的 [**確定]** 或 [**取消**] 按鈕時，對話方塊程式就會呼叫 **EndDialog** 。</span><span class="sxs-lookup"><span data-stu-id="2d18e-210">In most cases, the dialog box procedure calls **EndDialog** when the user clicks **Close** from the dialog box's window menu or clicks the **OK** or **Cancel** button in the dialog box.</span></span> <span data-ttu-id="2d18e-211">此對話方塊可以透過 [**對話方塊**](/windows/desktop/api/Winuser/nf-winuser-dialogboxa) 函數 (或其他) 建立函式傳回值，方法是在呼叫 **EndDialog** 函數時指定值。</span><span class="sxs-lookup"><span data-stu-id="2d18e-211">The dialog box can return a value through the [**DialogBox**](/windows/desktop/api/Winuser/nf-winuser-dialogboxa) function (or other creation functions) by specifying a value when calling the **EndDialog** function.</span></span> <span data-ttu-id="2d18e-212">終結對話方塊之後，系統會傳回這個值。</span><span class="sxs-lookup"><span data-stu-id="2d18e-212">The system returns this value after destroying the dialog box.</span></span> <span data-ttu-id="2d18e-213">大部分的應用程式會使用這個傳回值來判斷對話方塊是否已順利完成其工作，或使用者已取消。</span><span class="sxs-lookup"><span data-stu-id="2d18e-213">Most applications use this return value to determine whether the dialog box completed its task successfully or was canceled by the user.</span></span> <span data-ttu-id="2d18e-214">系統不會從建立對話方塊的函數傳回控制權，直到對話方塊程式呼叫 **EndDialog** 函式為止。</span><span class="sxs-lookup"><span data-stu-id="2d18e-214">The system does not return control from the function that creates the dialog box until the dialog box procedure has called the **EndDialog** function.</span></span>

## <a name="modeless-dialog-boxes"></a><span data-ttu-id="2d18e-215">非強制回應對話方塊</span><span class="sxs-lookup"><span data-stu-id="2d18e-215">Modeless Dialog Boxes</span></span>

<span data-ttu-id="2d18e-216">非強制回應對話方塊應該是具有視窗功能表、標題列和細框線的快顯視窗。也就是說，對話方塊範本應該指定 **ws \_ 快顯視窗**、 **ws \_ 標題**、 **ws \_ 框線** 和 **ws \_ SYSMENU** 樣式。</span><span class="sxs-lookup"><span data-stu-id="2d18e-216">A modeless dialog box should be a pop-up window having a window menu, a title bar, and a thin border; that is, the dialog box template should specify the **WS\_POPUP**, **WS\_CAPTION**, **WS\_BORDER**, and **WS\_SYSMENU** styles.</span></span> <span data-ttu-id="2d18e-217">除非範本指定 **WS \_ 可見** 樣式，否則系統不會自動顯示對話方塊。</span><span class="sxs-lookup"><span data-stu-id="2d18e-217">The system does not automatically display the dialog box unless the template specifies the **WS\_VISIBLE** style.</span></span>

<span data-ttu-id="2d18e-218">應用程式會使用 [**CreateDialog**](/windows/desktop/api/Winuser/nf-winuser-createdialoga) 或 [**CreateDialogIndirect**](/windows/desktop/api/Winuser/nf-winuser-createdialogindirecta) 函數來建立非強制回應對話方塊。</span><span class="sxs-lookup"><span data-stu-id="2d18e-218">An application creates a modeless dialog box by using the [**CreateDialog**](/windows/desktop/api/Winuser/nf-winuser-createdialoga) or [**CreateDialogIndirect**](/windows/desktop/api/Winuser/nf-winuser-createdialogindirecta) function.</span></span> <span data-ttu-id="2d18e-219">**CreateDialog** 需要包含對話方塊範本之資源的名稱或識別碼; **CreateDialogIndirect** 需要包含對話方塊範本的記憶體物件控制碼。</span><span class="sxs-lookup"><span data-stu-id="2d18e-219">**CreateDialog** requires the name or identifier of a resource containing a dialog box template; **CreateDialogIndirect** requires a handle to a memory object containing a dialog box template.</span></span> <span data-ttu-id="2d18e-220">另外兩個函式 [**CreateDialogParam**](/windows/desktop/api/Winuser/nf-winuser-createdialogparama) 和 [**CreateDialogIndirectParam**](/windows/desktop/api/Winuser/nf-winuser-createdialogindirectparama)，也建立非強制回應對話方塊;當建立對話方塊時，它們會將指定的參數傳遞至對話方塊程式。</span><span class="sxs-lookup"><span data-stu-id="2d18e-220">Two other functions, [**CreateDialogParam**](/windows/desktop/api/Winuser/nf-winuser-createdialogparama) and [**CreateDialogIndirectParam**](/windows/desktop/api/Winuser/nf-winuser-createdialogindirectparama), also create modeless dialog boxes; they pass a specified parameter to the dialog box procedure when the dialog box is created.</span></span>

<span data-ttu-id="2d18e-221">[**CreateDialog**](/windows/desktop/api/Winuser/nf-winuser-createdialoga) 和其他建立函數會傳回視窗控制碼給對話方塊。</span><span class="sxs-lookup"><span data-stu-id="2d18e-221">[**CreateDialog**](/windows/desktop/api/Winuser/nf-winuser-createdialoga) and other creation functions return a window handle to the dialog box.</span></span> <span data-ttu-id="2d18e-222">應用程式和對話方塊程式可以使用此控制碼來管理對話方塊。</span><span class="sxs-lookup"><span data-stu-id="2d18e-222">The application and the dialog box procedure can use this handle to manage the dialog box.</span></span> <span data-ttu-id="2d18e-223">例如，如果對話方塊範本中未指定 [ **WS \_ VISIBLE** ]，則應用程式可以將視窗控制碼傳遞至 [**ShowWindow**](/windows/desktop/api/winuser/nf-winuser-showwindow) 函式來顯示對話方塊。</span><span class="sxs-lookup"><span data-stu-id="2d18e-223">For example, if **WS\_VISIBLE** is not specified in the dialog box template, the application can display the dialog box by passing the window handle to the [**ShowWindow**](/windows/desktop/api/winuser/nf-winuser-showwindow) function.</span></span>

<span data-ttu-id="2d18e-224">非強制回應對話方塊不會停用擁有者視窗，也不會將訊息傳送給它。</span><span class="sxs-lookup"><span data-stu-id="2d18e-224">A modeless dialog box neither disables the owner window nor sends messages to it.</span></span> <span data-ttu-id="2d18e-225">建立對話方塊時，系統會將它變成使用中視窗，但是使用者或應用程式可以隨時變更使用中視窗。</span><span class="sxs-lookup"><span data-stu-id="2d18e-225">When creating the dialog box, the system makes it the active window, but the user or the application can change the active window at any time.</span></span> <span data-ttu-id="2d18e-226">如果對話方塊變成非使用中，即使擁有者視窗為使用中，它仍會以 Z 順序維持在 [擁有者] 視窗的上方。</span><span class="sxs-lookup"><span data-stu-id="2d18e-226">If the dialog box does become inactive, it remains above the owner window in the Z order, even if the owner window is active.</span></span>

<span data-ttu-id="2d18e-227">應用程式會負責將輸入訊息取出並分派至對話方塊。</span><span class="sxs-lookup"><span data-stu-id="2d18e-227">The application is responsible for retrieving and dispatching input messages to the dialog box.</span></span> <span data-ttu-id="2d18e-228">大部分的應用程式會使用主要訊息迴圈。</span><span class="sxs-lookup"><span data-stu-id="2d18e-228">Most applications use the main message loop for this.</span></span> <span data-ttu-id="2d18e-229">不過，若要允許使用者使用鍵盤移至並選取控制項，應用程式必須呼叫 [**IsDialogMessage**](/windows/desktop/api/Winuser/nf-winuser-isdialogmessagea) 函數。</span><span class="sxs-lookup"><span data-stu-id="2d18e-229">To permit the user to move to and select controls by using the keyboard, however, the application must call the [**IsDialogMessage**](/windows/desktop/api/Winuser/nf-winuser-isdialogmessagea) function.</span></span> <span data-ttu-id="2d18e-230">如需此函數的詳細資訊，請參閱 [對話方塊鍵盤介面](dlgbox-programming-considerations.md)。</span><span class="sxs-lookup"><span data-stu-id="2d18e-230">For more information about this function, see [Dialog Box Keyboard Interface](dlgbox-programming-considerations.md).</span></span>

<span data-ttu-id="2d18e-231">非強制回應對話方塊不能將值當作強制回應對話方塊傳回給應用程式，但是對話方塊程式可以使用 [**SendMessage**](/windows/desktop/api/winuser/nf-winuser-sendmessage) 函數，將資訊傳送至主控視窗。</span><span class="sxs-lookup"><span data-stu-id="2d18e-231">A modeless dialog box cannot return a value to the application as a modal dialog box does, but the dialog box procedure can send information to the owner window by using the [**SendMessage**](/windows/desktop/api/winuser/nf-winuser-sendmessage) function.</span></span>

<span data-ttu-id="2d18e-232">應用程式必須在結束之前終結所有非強制回應對話方塊。</span><span class="sxs-lookup"><span data-stu-id="2d18e-232">An application must destroy all modeless dialog boxes before terminating.</span></span> <span data-ttu-id="2d18e-233">它可以使用 [**DestroyWindow**](/windows/desktop/api/winuser/nf-winuser-destroywindow) 函數來終結非強制回應對話方塊。</span><span class="sxs-lookup"><span data-stu-id="2d18e-233">It can destroy a modeless dialog box by using the [**DestroyWindow**](/windows/desktop/api/winuser/nf-winuser-destroywindow) function.</span></span> <span data-ttu-id="2d18e-234">在大多數情況下，對話方塊程式都會呼叫 **DestroyWindow** 來回應使用者輸入，例如按一下 [ **取消** ] 按鈕。</span><span class="sxs-lookup"><span data-stu-id="2d18e-234">In most cases, the dialog box procedure calls **DestroyWindow** in response to user input, such as clicking the **Cancel** button.</span></span> <span data-ttu-id="2d18e-235">如果使用者永遠不會以這種方式關閉對話方塊，則應用程式必須呼叫 **DestroyWindow**。</span><span class="sxs-lookup"><span data-stu-id="2d18e-235">If the user never closes the dialog box in this way, the application must call **DestroyWindow**.</span></span>

<span data-ttu-id="2d18e-236">[**DestroyWindow**](/windows/desktop/api/winuser/nf-winuser-destroywindow) 會讓對話方塊的視窗控制碼失效，因此任何後續呼叫使用控制碼的函式都會傳回錯誤值。</span><span class="sxs-lookup"><span data-stu-id="2d18e-236">[**DestroyWindow**](/windows/desktop/api/winuser/nf-winuser-destroywindow) invalidates the window handle to the dialog box, so any subsequent calls to functions that use the handle return error values.</span></span> <span data-ttu-id="2d18e-237">若要避免錯誤，對話方塊程式應通知擁有者已終結對話方塊。</span><span class="sxs-lookup"><span data-stu-id="2d18e-237">To prevent errors, the dialog box procedure should notify the owner that the dialog box has been destroyed.</span></span> <span data-ttu-id="2d18e-238">許多應用程式會維護包含對話方塊控制碼的全域變數。</span><span class="sxs-lookup"><span data-stu-id="2d18e-238">Many applications maintain a global variable containing the handle to the dialog box.</span></span> <span data-ttu-id="2d18e-239">當對話方塊程式終結對話方塊時，它也會將全域變數設定為 **Null**，表示對話方塊已不再有效。</span><span class="sxs-lookup"><span data-stu-id="2d18e-239">When the dialog box procedure destroys the dialog box, it also sets the global variable to **NULL**, indicating that the dialog box is no longer valid.</span></span>

<span data-ttu-id="2d18e-240">對話方塊程式不能呼叫 [**EndDialog**](/windows/desktop/api/Winuser/nf-winuser-enddialog) 函數來終結非強制回應對話方塊。</span><span class="sxs-lookup"><span data-stu-id="2d18e-240">The dialog box procedure must not call the [**EndDialog**](/windows/desktop/api/Winuser/nf-winuser-enddialog) function to destroy a modeless dialog box.</span></span>

## <a name="dialog-box-templates"></a><span data-ttu-id="2d18e-241">對話方塊範本</span><span class="sxs-lookup"><span data-stu-id="2d18e-241">Dialog Box Templates</span></span>

<span data-ttu-id="2d18e-242">對話方塊範本是描述對話方塊、定義其高度、寬度、樣式，以及它所包含之控制項的二進位資料。</span><span class="sxs-lookup"><span data-stu-id="2d18e-242">A dialog box template is binary data that describes the dialog box, defining its height, width, style, and the controls it contains.</span></span> <span data-ttu-id="2d18e-243">若要建立對話方塊，系統會從應用程式的可執行檔中的資源載入對話方塊範本，或使用應用程式在全域記憶體中傳遞給它的範本。</span><span class="sxs-lookup"><span data-stu-id="2d18e-243">To create a dialog box, the system either loads a dialog box template from the resources in the application's executable file or uses the template passed to it in global memory by the application.</span></span> <span data-ttu-id="2d18e-244">無論是哪一種情況，應用程式都必須在建立對話方塊時提供範本。</span><span class="sxs-lookup"><span data-stu-id="2d18e-244">In either case, the application must supply a template when creating a dialog box.</span></span>

<span data-ttu-id="2d18e-245">開發人員會使用資源編譯器或對話方塊編輯器來建立範本資源。</span><span class="sxs-lookup"><span data-stu-id="2d18e-245">A developer creates template resources by using a resource compiler or a dialog box editor.</span></span> <span data-ttu-id="2d18e-246">資源編譯器會將文字描述轉換成二進位資源，而對話方塊編輯器會將以互動方式建立的對話方塊儲存為二進位資源。</span><span class="sxs-lookup"><span data-stu-id="2d18e-246">A resource compiler converts a text description into a binary resource, and a dialog box editor saves an interactively constructed dialog box as a binary resource.</span></span>

> [!Note]  
> <span data-ttu-id="2d18e-247">有關如何建立範本資源並將其新增至應用程式可執行檔的說明，已超出此總覽的範圍。</span><span class="sxs-lookup"><span data-stu-id="2d18e-247">An explanation of how to create template resources and add them to the application's executable file is beyond the scope of this overview.</span></span> <span data-ttu-id="2d18e-248">如需建立範本資源並將其新增至可執行檔的詳細資訊，請參閱應用程式開發工具所提供的檔。</span><span class="sxs-lookup"><span data-stu-id="2d18e-248">For more information about creating template resources and adding them to an executable file, see the documentation provided with your application development tools.</span></span>

 

<span data-ttu-id="2d18e-249">若要建立不使用範本資源的對話方塊，您必須在記憶體中建立範本，並將它傳遞至 [**CreateDialogIndirectParam**](/windows/desktop/api/Winuser/nf-winuser-createdialogindirectparama) 或 [**DialogBoxIndirectParam**](/windows/desktop/api/Winuser/nf-winuser-dialogboxindirectparama) 函式，或傳遞至 [**CreateDialogIndirect**](/windows/desktop/api/Winuser/nf-winuser-createdialogindirecta) 或 [**DialogBoxIndirect**](/windows/desktop/api/Winuser/nf-winuser-dialogboxindirecta) 宏。</span><span class="sxs-lookup"><span data-stu-id="2d18e-249">To create a dialog box without using template resources, you must create a template in memory and pass it to the [**CreateDialogIndirectParam**](/windows/desktop/api/Winuser/nf-winuser-createdialogindirectparama) or [**DialogBoxIndirectParam**](/windows/desktop/api/Winuser/nf-winuser-dialogboxindirectparama) function, or to the [**CreateDialogIndirect**](/windows/desktop/api/Winuser/nf-winuser-createdialogindirecta) or [**DialogBoxIndirect**](/windows/desktop/api/Winuser/nf-winuser-dialogboxindirecta) macro.</span></span>

<span data-ttu-id="2d18e-250">記憶體中的對話方塊範本是由描述對話方塊的標頭所組成，後面接著一個或多個其他區塊的資料，以描述對話方塊中的每個控制項。</span><span class="sxs-lookup"><span data-stu-id="2d18e-250">A dialog box template in memory consists of a header that describes the dialog box, followed by one or more additional blocks of data that describe each of the controls in the dialog box.</span></span> <span data-ttu-id="2d18e-251">範本可以使用標準格式或延伸格式。</span><span class="sxs-lookup"><span data-stu-id="2d18e-251">The template can use either the standard format or the extended format.</span></span> <span data-ttu-id="2d18e-252">在標準範本中，標頭是 [**DLGTEMPLATE**](/windows/desktop/api/Winuser/ns-winuser-dlgtemplate) 結構，後面接著額外的可變長度陣列;每個控制項的資料都包含 [**DLGITEMTEMPLATE**](/windows/desktop/api/Winuser/ns-winuser-dlgitemtemplate) 結構，後面接著額外的可變長度陣列。</span><span class="sxs-lookup"><span data-stu-id="2d18e-252">In a standard template, the header is a [**DLGTEMPLATE**](/windows/desktop/api/Winuser/ns-winuser-dlgtemplate) structure followed by additional variable-length arrays; and the data for each control consists of a [**DLGITEMTEMPLATE**](/windows/desktop/api/Winuser/ns-winuser-dlgitemtemplate) structure followed by additional variable-length arrays.</span></span> <span data-ttu-id="2d18e-253">在擴充的對話方塊範本中，標頭會使用 [**DLGTEMPLATEEX**](dlgtemplateex.md) 格式，而控制項定義會使用 [**DLGITEMTEMPLATEEX**](dlgitemtemplateex.md) 格式。</span><span class="sxs-lookup"><span data-stu-id="2d18e-253">In an extended dialog box template, the header uses the [**DLGTEMPLATEEX**](dlgtemplateex.md) format and the control definitions use the [**DLGITEMTEMPLATEEX**](dlgitemtemplateex.md) format.</span></span>

<span data-ttu-id="2d18e-254">您可以建立記憶體範本，方法是配置全域記憶體物件，並將它填入標準或擴充的標頭和控制項定義。</span><span class="sxs-lookup"><span data-stu-id="2d18e-254">You can create a memory template by allocating a global memory object and filling it with the standard or extended header and control definitions.</span></span> <span data-ttu-id="2d18e-255">範本資源的表單和內容中的記憶體範本完全相同。</span><span class="sxs-lookup"><span data-stu-id="2d18e-255">A memory template is identical in form and content to a template resource.</span></span> <span data-ttu-id="2d18e-256">許多使用記憶體範本的應用程式會先使用 [**LoadResource**](/windows/desktop/api/libloaderapi/nf-libloaderapi-loadresource) 函式將範本資源載入至記憶體中，然後修改載入的資源以建立新的記憶體範本。</span><span class="sxs-lookup"><span data-stu-id="2d18e-256">Many applications that use memory templates first use the [**LoadResource**](/windows/desktop/api/libloaderapi/nf-libloaderapi-loadresource) function to load a template resource into memory, then modify the loaded resource to create a new memory template.</span></span> <span data-ttu-id="2d18e-257">如需有關在記憶體中建立對話方塊範本的詳細資訊，請參閱 [記憶體中的範本](#templates-in-memory)。</span><span class="sxs-lookup"><span data-stu-id="2d18e-257">For more information about creating a dialog box template in memory, see [Templates in Memory](#templates-in-memory).</span></span>

<span data-ttu-id="2d18e-258">下列各節描述對話方塊範本中使用的樣式、測量和其他值。</span><span class="sxs-lookup"><span data-stu-id="2d18e-258">The following sections describe the styles, measurements, and other values used in a dialog box template.</span></span>

-   [<span data-ttu-id="2d18e-259">對話方塊範本樣式</span><span class="sxs-lookup"><span data-stu-id="2d18e-259">Dialog Box Template Styles</span></span>](#dialog-box-template-styles)
-   [<span data-ttu-id="2d18e-260">對話方塊度量</span><span class="sxs-lookup"><span data-stu-id="2d18e-260">Dialog Box Measurements</span></span>](#dialog-box-measurements)
-   [<span data-ttu-id="2d18e-261">對話方塊控制項</span><span class="sxs-lookup"><span data-stu-id="2d18e-261">Dialog Box Controls</span></span>](#dialog-box-controls)
-   [<span data-ttu-id="2d18e-262">對話方塊視窗功能表</span><span class="sxs-lookup"><span data-stu-id="2d18e-262">Dialog Box Window Menu</span></span>](#dialog-box-window-menu)
-   [<span data-ttu-id="2d18e-263">對話方塊字型</span><span class="sxs-lookup"><span data-stu-id="2d18e-263">Dialog Box Fonts</span></span>](#dialog-box-fonts)
-   [<span data-ttu-id="2d18e-264">記憶體中的範本</span><span class="sxs-lookup"><span data-stu-id="2d18e-264">Templates in Memory</span></span>](#templates-in-memory)

### <a name="dialog-box-template-styles"></a><span data-ttu-id="2d18e-265">對話方塊範本樣式</span><span class="sxs-lookup"><span data-stu-id="2d18e-265">Dialog Box Template Styles</span></span>

<span data-ttu-id="2d18e-266">每個對話方塊範本都會指定樣式值的組合，以定義對話方塊的外觀和功能。</span><span class="sxs-lookup"><span data-stu-id="2d18e-266">Every dialog box template specifies a combination of style values that define the appearance and features of the dialog box.</span></span> <span data-ttu-id="2d18e-267">樣式值可以是視窗樣式，例如 **WS \_ POPUP** 和 **ws \_ SYSMENU**，以及對話方塊樣式，例如 **DS \_ MODALFRAME**。</span><span class="sxs-lookup"><span data-stu-id="2d18e-267">The style values can be window styles, such as **WS\_POPUP** and **WS\_SYSMENU**, and dialog box styles, such as **DS\_MODALFRAME**.</span></span> <span data-ttu-id="2d18e-268">範本的樣式數目和類型取決於對話方塊的類型和用途。</span><span class="sxs-lookup"><span data-stu-id="2d18e-268">The number and type of styles for a template depends on the type and purpose of the dialog box.</span></span> <span data-ttu-id="2d18e-269">如需值清單，請參閱 [**對話方塊樣式**](dialog-box-styles.md)。</span><span class="sxs-lookup"><span data-stu-id="2d18e-269">For a list of values, see [**Dialog Box Styles**](dialog-box-styles.md).</span></span>

<span data-ttu-id="2d18e-270">當您建立對話方塊時，系統會將範本中指定的所有視窗樣式傳遞給 [**CreateWindowEx**](/windows/desktop/api/winuser/nf-winuser-createwindowexa) 函式。</span><span class="sxs-lookup"><span data-stu-id="2d18e-270">The system passes all window styles specified in the template to the [**CreateWindowEx**](/windows/desktop/api/winuser/nf-winuser-createwindowexa) function when creating the dialog box.</span></span> <span data-ttu-id="2d18e-271">系統可能會根據指定的對話方塊樣式，傳遞一或多個擴充樣式。</span><span class="sxs-lookup"><span data-stu-id="2d18e-271">The system may pass one or more extended styles depending on the specified dialog box styles.</span></span> <span data-ttu-id="2d18e-272">例如，當範本指定 **DS \_ MODALFRAME** 時，系統會在建立對話方塊時使用 **WS \_ EX \_ DLGMODALFRAME** 。</span><span class="sxs-lookup"><span data-stu-id="2d18e-272">For example, when the template specifies **DS\_MODALFRAME**, the system uses **WS\_EX\_DLGMODALFRAME** when creating the dialog box.</span></span>

<span data-ttu-id="2d18e-273">大部分的對話方塊都是具有視窗功能表和標題列的快顯視窗。</span><span class="sxs-lookup"><span data-stu-id="2d18e-273">Most dialog boxes are pop-up windows that have a window menu and a title bar.</span></span> <span data-ttu-id="2d18e-274">因此，一般範本會指定 **ws \_ POPUP**、 **ws \_ SYSMENU** 和 **ws \_ 標題** 樣式。</span><span class="sxs-lookup"><span data-stu-id="2d18e-274">Therefore, the typical template specifies the **WS\_POPUP**, **WS\_SYSMENU**, and **WS\_CAPTION** styles.</span></span> <span data-ttu-id="2d18e-275">此範本也會指定框線樣式：非強制回應對話方塊的 **WS \_ 框線** ，以及用於強制回應對話方塊的 **DS \_ MODALFRAME** 。</span><span class="sxs-lookup"><span data-stu-id="2d18e-275">The template also specifies a border style: **WS\_BORDER** for modeless dialog boxes, and **DS\_MODALFRAME** for modal dialog boxes.</span></span> <span data-ttu-id="2d18e-276">範本可以指定快顯 (的視窗類型，例如 WS 重迭) **\_** （如果它建立自訂的視窗，而不是對話方塊）。</span><span class="sxs-lookup"><span data-stu-id="2d18e-276">A template may specify a window type other than pop-up (such as **WS\_OVERLAPPED**) if it creates a customized window instead of a dialog box.</span></span>

<span data-ttu-id="2d18e-277">無論是否指定了 **WS \_ VISIBLE** 樣式，系統一律會顯示模式對話方塊。</span><span class="sxs-lookup"><span data-stu-id="2d18e-277">The system always displays a modal dialog box regardless of whether the **WS\_VISIBLE** style is specified.</span></span> <span data-ttu-id="2d18e-278">當非強制回應對話方塊的範本指定 **WS \_ 可見** 樣式時，系統會在建立時自動顯示對話方塊。</span><span class="sxs-lookup"><span data-stu-id="2d18e-278">When the template for a modeless dialog box specifies the **WS\_VISIBLE** style, the system automatically displays the dialog box when it is created.</span></span> <span data-ttu-id="2d18e-279">否則，應用程式會負責使用 [**ShowWindow**](/windows/desktop/api/winuser/nf-winuser-showwindow) 函數來顯示對話方塊。</span><span class="sxs-lookup"><span data-stu-id="2d18e-279">Otherwise, the application is responsible for displaying the dialog box by using the [**ShowWindow**](/windows/desktop/api/winuser/nf-winuser-showwindow) function.</span></span>

### <a name="dialog-box-measurements"></a><span data-ttu-id="2d18e-280">對話方塊度量</span><span class="sxs-lookup"><span data-stu-id="2d18e-280">Dialog Box Measurements</span></span>

<span data-ttu-id="2d18e-281">每個對話方塊範本都包含指定對話方塊位置、寬度和高度的度量，以及它所包含之控制項的位置、寬度和高度。</span><span class="sxs-lookup"><span data-stu-id="2d18e-281">Every dialog box template contains measurements that specify the position, width, and height of the dialog box and the controls it contains.</span></span> <span data-ttu-id="2d18e-282">這些測量與裝置無關，因此應用程式可以使用單一範本，為所有類型的顯示裝置建立相同的對話方塊。</span><span class="sxs-lookup"><span data-stu-id="2d18e-282">These measurements are device independent, so an application can use a single template to create the same dialog box for all types of display devices.</span></span> <span data-ttu-id="2d18e-283">這可確保在畫面之間有不同解析度和外觀比例的所有螢幕上，對話方塊的比例和外觀也相同。</span><span class="sxs-lookup"><span data-stu-id="2d18e-283">This ensures that a dialog box will have the same proportions and appearance on all screens despite differing resolutions and aspect ratios between screens.</span></span>

<span data-ttu-id="2d18e-284">對話方塊範本中的度量是在對話方塊範本單位中指定。</span><span class="sxs-lookup"><span data-stu-id="2d18e-284">The measurements in a dialog box template are specified in dialog template units.</span></span> <span data-ttu-id="2d18e-285">若要將度量從對話方塊範本單位轉換為螢幕單位 (圖元) ，請使用 [**MapDialogRect**](/windows/desktop/api/Winuser/nf-winuser-mapdialogrect) 函式，此函式會將對話方塊所使用的字型納入考慮，並將矩形從對話方塊範本單位正確轉換成圖元。</span><span class="sxs-lookup"><span data-stu-id="2d18e-285">To convert measurements from dialog template units to screen units (pixels), use the [**MapDialogRect**](/windows/desktop/api/Winuser/nf-winuser-mapdialogrect) function, which takes into account the font used by the dialog box and correctly converts a rectangle from dialog template units into pixels.</span></span> <span data-ttu-id="2d18e-286">針對使用系統字型的對話方塊，您可以使用 [**GetDialogBaseUnits**](/windows/desktop/api/Winuser/nf-winuser-getdialogbaseunits) 函式來自行執行轉換計算，雖然使用 **MapDialogRect** 比較簡單。</span><span class="sxs-lookup"><span data-stu-id="2d18e-286">For dialog boxes that use the system font, you can use the [**GetDialogBaseUnits**](/windows/desktop/api/Winuser/nf-winuser-getdialogbaseunits) function to perform the conversion calculations yourself, although using **MapDialogRect** is simpler.</span></span>

<span data-ttu-id="2d18e-287">範本必須指定對話方塊左上角的初始座標。</span><span class="sxs-lookup"><span data-stu-id="2d18e-287">The template must specify the initial coordinates of the upper left corner of the dialog box.</span></span> <span data-ttu-id="2d18e-288">座標通常是相對於擁有者視窗工作區的左上角。</span><span class="sxs-lookup"><span data-stu-id="2d18e-288">Usually the coordinates are relative to the upper left corner of the owner window's client area.</span></span> <span data-ttu-id="2d18e-289">當範本指定 DS \_ ABSALIGN 樣式，或對話方塊沒有擁有者時，此位置會相對於畫面的左上角。</span><span class="sxs-lookup"><span data-stu-id="2d18e-289">When the template specifies the DS\_ABSALIGN style or the dialog box has no owner, the position is relative to the upper left corner of the screen.</span></span> <span data-ttu-id="2d18e-290">系統會在建立對話方塊時設定此初始位置，但允許應用程式在顯示對話方塊之前，調整位置。</span><span class="sxs-lookup"><span data-stu-id="2d18e-290">The system sets this initial position when creating the dialog box, but permits an application to adjust the position before displaying the dialog box.</span></span> <span data-ttu-id="2d18e-291">例如，應用程式可以取出擁有者視窗的維度、計算在主控視窗中將對話方塊置中的新位置，然後使用 [**SetWindowPos**](/windows/desktop/api/winuser/nf-winuser-setwindowpos) 函數來設定位置。</span><span class="sxs-lookup"><span data-stu-id="2d18e-291">For example, an application can retrieve the dimensions of the owner window, calculate a new position that centers the dialog box in the owner window, and then set the position by using the [**SetWindowPos**](/windows/desktop/api/winuser/nf-winuser-setwindowpos) function.</span></span>

<span data-ttu-id="2d18e-292">範本應該指定不超過畫面寬度和高度的對話方塊寬度和高度，並確保所有控制項都在對話方塊的工作區中。</span><span class="sxs-lookup"><span data-stu-id="2d18e-292">The template should specify a dialog box width and height that does not exceed the width and height of the screen and ensures that all controls are within the client area of the dialog box.</span></span> <span data-ttu-id="2d18e-293">雖然系統允許對話方塊的大小不限，但建立太小或太大的對話方塊可能會使使用者無法提供輸入，失去對話方塊的用途。</span><span class="sxs-lookup"><span data-stu-id="2d18e-293">Although the system permits a dialog box to be any size, creating one that is too small or too large can prevent the user from providing input, defeating the purpose of the dialog box.</span></span> <span data-ttu-id="2d18e-294">許多應用程式在有大量的控制項時，會使用多個對話方塊。</span><span class="sxs-lookup"><span data-stu-id="2d18e-294">Many applications use more than one dialog box when there are a large number of controls.</span></span> <span data-ttu-id="2d18e-295">在這種情況下，初始對話方塊通常會包含一或多個按鈕，讓使用者可以選擇顯示下一個對話方塊。</span><span class="sxs-lookup"><span data-stu-id="2d18e-295">In such cases, the initial dialog box usually contains one or more buttons that the user can choose to display the next dialog box.</span></span>

### <a name="dialog-box-controls"></a><span data-ttu-id="2d18e-296">對話方塊控制項</span><span class="sxs-lookup"><span data-stu-id="2d18e-296">Dialog Box Controls</span></span>

<span data-ttu-id="2d18e-297">此範本會針對對話方塊中的每個控制項，指定位置、寬度、高度、樣式、識別碼和視窗類別。</span><span class="sxs-lookup"><span data-stu-id="2d18e-297">The template specifies the position, width, height, style, identifier, and window class for each control in the dialog box.</span></span> <span data-ttu-id="2d18e-298">系統會將此資料傳遞至 [**CreateWindowEx**](/windows/desktop/api/winuser/nf-winuser-createwindowexa) 函式，以建立每個控制項。</span><span class="sxs-lookup"><span data-stu-id="2d18e-298">The system creates each control by passing this data to the [**CreateWindowEx**](/windows/desktop/api/winuser/nf-winuser-createwindowexa) function.</span></span> <span data-ttu-id="2d18e-299">系統會依照在範本中指定的順序來建立控制項。</span><span class="sxs-lookup"><span data-stu-id="2d18e-299">Controls are created in the order they are specified in the template.</span></span> <span data-ttu-id="2d18e-300">範本應該指定適當的數目、類型和控制項順序，以確保使用者可以輸入完成與對話方塊相關聯之工作所需的輸入。</span><span class="sxs-lookup"><span data-stu-id="2d18e-300">The template should specify the appropriate number, type, and order of controls to ensure that the user can enter the input needed to complete the task associated with the dialog box.</span></span>

<span data-ttu-id="2d18e-301">針對每個控制項，範本會指定定義控制面板和操作的樣式值。</span><span class="sxs-lookup"><span data-stu-id="2d18e-301">For each control, the template specifies style values that define the appearance and operation of the control.</span></span> <span data-ttu-id="2d18e-302">每個控制項都是子視窗，因此必須具有 **WS \_ 子** 樣式。</span><span class="sxs-lookup"><span data-stu-id="2d18e-302">Every control is a child window and therefore must have the **WS\_CHILD** style.</span></span> <span data-ttu-id="2d18e-303">為了確保在對話方塊顯示時可以看到控制項，每個控制項也都必須有 **WS \_ 可見** 的樣式。</span><span class="sxs-lookup"><span data-stu-id="2d18e-303">To ensure that the control is visible when the dialog box is displayed, each control must also have the **WS\_VISIBLE** style.</span></span> <span data-ttu-id="2d18e-304">其他常用的視窗樣式為具有選用框線的控制項的 **ws \_ 框線** 、 **已 \_ 停用** 的控制項（在對話方塊一開始建立時應停用），以及可使用鍵盤存取之控制項的 **ws \_ TABSTOP** 和 **ws \_ 群組** 。</span><span class="sxs-lookup"><span data-stu-id="2d18e-304">Other commonly used window styles are **WS\_BORDER** for controls that have optional borders, **WS\_DISABLED** for controls that should be disabled when the dialog box is initially created, and **WS\_TABSTOP** and **WS\_GROUP** for controls that can be accessed using the keyboard.</span></span> <span data-ttu-id="2d18e-305">**Ws \_ TABSTOP** 和 **ws \_ GROUP** 樣式會與本主題稍後所述的對話方塊鍵盤介面一起使用。</span><span class="sxs-lookup"><span data-stu-id="2d18e-305">The **WS\_TABSTOP** and **WS\_GROUP** styles are used in conjunction with the dialog keyboard interface described later in this topic.</span></span>

<span data-ttu-id="2d18e-306">此範本也可以指定控制項視窗類別特定的控制項樣式。</span><span class="sxs-lookup"><span data-stu-id="2d18e-306">The template may also specify control styles specific to the control's window class.</span></span> <span data-ttu-id="2d18e-307">例如，指定按鈕控制項的範本必須提供按鈕控制項樣式，例如 **BS \_** 按鈕或 [ **BS \_ ] 核取方塊**。</span><span class="sxs-lookup"><span data-stu-id="2d18e-307">For example, a template that specifies a button control must give a button control style such as **BS\_PUSHBUTTON** or **BS\_CHECKBOX**.</span></span> <span data-ttu-id="2d18e-308">系統會透過 [**WM \_ 建立**](/windows/desktop/winmsg/wm-create) 訊息，將控制項樣式傳遞給控制視窗程式，讓程式能夠調整控制項的外觀和操作。</span><span class="sxs-lookup"><span data-stu-id="2d18e-308">The system passes the control styles to the control window procedure through the [**WM\_CREATE**](/windows/desktop/winmsg/wm-create) message, allowing the procedure to adapt the appearance and operation of the control.</span></span>

<span data-ttu-id="2d18e-309">系統會將位置座標和寬度和高度度量從對話方塊基底單位轉換成圖元，然後再將它們傳遞給 [**CreateWindowEx**](/windows/desktop/api/winuser/nf-winuser-createwindowexa)。</span><span class="sxs-lookup"><span data-stu-id="2d18e-309">The system converts the position coordinates and the width and height measurements from dialog base units to pixels, before passing these to [**CreateWindowEx**](/windows/desktop/api/winuser/nf-winuser-createwindowexa).</span></span> <span data-ttu-id="2d18e-310">當系統建立控制項時，它會將對話方塊指定為父視窗。</span><span class="sxs-lookup"><span data-stu-id="2d18e-310">When the system creates a control, it specifies the dialog box as the parent window.</span></span> <span data-ttu-id="2d18e-311">這表示系統一律會將控制項的位置座標視為用戶端座標（相對於對話方塊的工作區左上角）。</span><span class="sxs-lookup"><span data-stu-id="2d18e-311">This means the system always interprets the position coordinates of the control as client coordinates, relative to the upper left corner of the dialog box's client area.</span></span>

<span data-ttu-id="2d18e-312">範本會指定每個控制項的視窗類別。</span><span class="sxs-lookup"><span data-stu-id="2d18e-312">The template specifies the window class for each control.</span></span> <span data-ttu-id="2d18e-313">一般的對話方塊包含屬於預先定義之控制項視窗類別的控制項，例如按鈕和編輯控制項視窗類別。</span><span class="sxs-lookup"><span data-stu-id="2d18e-313">A typical dialog box contains controls belonging to the predefined control window classes, such as the button and edit control window classes.</span></span> <span data-ttu-id="2d18e-314">在此情況下，範本會藉由提供類別的對應預先定義 atom 值，來指定視窗類別。</span><span class="sxs-lookup"><span data-stu-id="2d18e-314">In this case, the template specifies window classes by supplying the corresponding predefined atom values for the classes.</span></span> <span data-ttu-id="2d18e-315">當對話方塊包含屬於自訂控制項視窗類別的控制項時，此範本會提供該已註冊視窗類別的名稱，或目前與該名稱相關聯的 atom 值。</span><span class="sxs-lookup"><span data-stu-id="2d18e-315">When a dialog box contains a control belonging to a custom control window class, the template gives the name of that registered window class or the atom value currently associated with the name.</span></span>

<span data-ttu-id="2d18e-316">對話方塊中的每個控制項都必須有唯一的識別碼，才能與其他控制項區別。</span><span class="sxs-lookup"><span data-stu-id="2d18e-316">Each control in a dialog box must have a unique identifier to distinguish it from other controls.</span></span> <span data-ttu-id="2d18e-317">控制項會透過 [**WM \_ 命令**](/windows/desktop/menurc/wm-command) 訊息，將資訊傳送至對話方塊程式，因此，程式必須有控制項識別碼，才能判斷哪個控制項傳送了指定的訊息。</span><span class="sxs-lookup"><span data-stu-id="2d18e-317">Controls send information to the dialog box procedure through [**WM\_COMMAND**](/windows/desktop/menurc/wm-command) messages, so the control identifiers are essential for the procedure to determine which control sent a specified message.</span></span> <span data-ttu-id="2d18e-318">此規則的唯一例外狀況是靜態控制項的控制項識別碼。</span><span class="sxs-lookup"><span data-stu-id="2d18e-318">The only exception to this rule are control identifiers for static controls.</span></span> <span data-ttu-id="2d18e-319">靜態控制項不需要唯一的識別碼，因為它們不會傳送任何 **WM \_ 命令** 訊息。</span><span class="sxs-lookup"><span data-stu-id="2d18e-319">Static controls do not require unique identifiers because they send no **WM\_COMMAND** messages.</span></span>

<span data-ttu-id="2d18e-320">若要允許使用者關閉對話方塊，範本至少應指定一個 push 按鈕，並為其提供控制項識別碼 **IDCANCEL**。</span><span class="sxs-lookup"><span data-stu-id="2d18e-320">To permit the user to close the dialog box, the template should specify at least one push button and give it the control identifier **IDCANCEL**.</span></span> <span data-ttu-id="2d18e-321">若要允許使用者在完成或取消與對話方塊相關聯的工作之間進行選擇，範本應該分別指定兩個按下的 **[確定] 和 [** **取消**] 按鈕，分別具有 **IDOK** 和 **IDCANCEL** 的控制項識別碼。</span><span class="sxs-lookup"><span data-stu-id="2d18e-321">To permit the user to choose between completing or canceling the task associated with the dialog box, the template should specify two push buttons, labeled **OK** and **Cancel**, with control identifiers of **IDOK** and **IDCANCEL**, respectively.</span></span>

<span data-ttu-id="2d18e-322">範本也會指定控制項的選擇性文字和建立資料。</span><span class="sxs-lookup"><span data-stu-id="2d18e-322">A template also specifies optional text and creation data for a control.</span></span> <span data-ttu-id="2d18e-323">文字通常會提供按鈕控制項的標籤，或指定靜態文字控制項的初始內容。</span><span class="sxs-lookup"><span data-stu-id="2d18e-323">The text typically provides labels for button controls or specifies the initial content of a static text control.</span></span> <span data-ttu-id="2d18e-324">建立資料是一個或多個位元組的資料，系統會在建立控制項時，將該資料傳遞給控制項視窗程式。</span><span class="sxs-lookup"><span data-stu-id="2d18e-324">The creation data is one or more bytes of data that the system passes to the control window procedure when creating the control.</span></span> <span data-ttu-id="2d18e-325">如果控制項需要的初始內容或樣式的詳細資訊比其他資料所指定的更多，則建立資料非常有用。</span><span class="sxs-lookup"><span data-stu-id="2d18e-325">Creation data is useful for controls that require more information about their initial content or style than is specified by other data.</span></span> <span data-ttu-id="2d18e-326">例如，應用程式可以使用建立資料來設定捲軸控制項的初始設定和範圍。</span><span class="sxs-lookup"><span data-stu-id="2d18e-326">For example, an application can use creation data to set the initial setting and range for a scroll bar control.</span></span>

### <a name="dialog-box-window-menu"></a><span data-ttu-id="2d18e-327">對話方塊視窗功能表</span><span class="sxs-lookup"><span data-stu-id="2d18e-327">Dialog Box Window Menu</span></span>

<span data-ttu-id="2d18e-328">當範本指定 **WS \_ SYSMENU** 樣式時，系統會在視窗功能表中提供一個對話方塊。</span><span class="sxs-lookup"><span data-stu-id="2d18e-328">The system gives a dialog box a window menu when the template specifies the **WS\_SYSMENU** style.</span></span> <span data-ttu-id="2d18e-329">為了避免不適當的輸入，系統會自動停用功能表中的所有專案，但 **Move** 和 **Close** 除外。</span><span class="sxs-lookup"><span data-stu-id="2d18e-329">To prevent inappropriate input, the system automatically disables all items in the menu except **Move** and **Close**.</span></span> <span data-ttu-id="2d18e-330">使用者可以按一下 [ **移動** ] 來移動對話方塊。</span><span class="sxs-lookup"><span data-stu-id="2d18e-330">The user can click **Move** to move the dialog box.</span></span> <span data-ttu-id="2d18e-331">當使用者按一下 [ **關閉**] 時，系統會將 [**WM \_ 命令**](/windows/desktop/menurc/wm-command) 訊息傳送至對話方塊程式，並將 *wParam* 參數設定為 **IDCANCEL**。</span><span class="sxs-lookup"><span data-stu-id="2d18e-331">When the user clicks **Close**, the system sends a [**WM\_COMMAND**](/windows/desktop/menurc/wm-command) message to the dialog box procedure with the *wParam* parameter set to **IDCANCEL**.</span></span> <span data-ttu-id="2d18e-332">這等同于使用者按一下 [ **取消** ] 按鈕時所傳送的訊息。</span><span class="sxs-lookup"><span data-stu-id="2d18e-332">This is identical to the message sent by the **Cancel** button when the user clicks it.</span></span> <span data-ttu-id="2d18e-333">此訊息的建議動作是關閉對話方塊，並取消要求的工作。</span><span class="sxs-lookup"><span data-stu-id="2d18e-333">The recommended action for this message is to close the dialog box and cancel the requested task.</span></span>

<span data-ttu-id="2d18e-334">雖然不建議對話方塊中的其他功能表，但是對話方塊範本可以藉由提供功能表資源的識別碼或名稱來指定功能表。</span><span class="sxs-lookup"><span data-stu-id="2d18e-334">Although other menus in dialog boxes are not recommended, a dialog box template can specify a menu by supplying the identifier or the name of a menu resource.</span></span> <span data-ttu-id="2d18e-335">在此情況下，系統會載入資源並建立對話方塊的功能表。</span><span class="sxs-lookup"><span data-stu-id="2d18e-335">In this case, the system loads the resource and creates the menu for the dialog box.</span></span> <span data-ttu-id="2d18e-336">使用範本來建立自訂視窗而非對話方塊時，應用程式通常會在範本中使用功能表識別碼或名稱。</span><span class="sxs-lookup"><span data-stu-id="2d18e-336">Applications typically use menu identifiers or names in templates when using the templates to create custom windows rather than dialog boxes.</span></span>

### <a name="dialog-box-fonts"></a><span data-ttu-id="2d18e-337">對話方塊字型</span><span class="sxs-lookup"><span data-stu-id="2d18e-337">Dialog Box Fonts</span></span>

<span data-ttu-id="2d18e-338">系統會使用對話方塊字型的平均字元寬度來計算對話方塊的位置和維度。</span><span class="sxs-lookup"><span data-stu-id="2d18e-338">The system uses the average character width of the dialog box font to calculate the position and dimensions of the dialog box.</span></span> <span data-ttu-id="2d18e-339">根據預設，系統會使用 **系統 \_ 字型** 字型來繪製對話方塊中的所有文字。</span><span class="sxs-lookup"><span data-stu-id="2d18e-339">By default, the system draws all text in a dialog box using the **SYSTEM\_FONT** font.</span></span>

<span data-ttu-id="2d18e-340">若要針對預設值以外的對話方塊指定字型，您必須使用對話方塊範本建立對話方塊。</span><span class="sxs-lookup"><span data-stu-id="2d18e-340">To specify a font for a dialog box other than the default, you must create the dialog box using a dialog box template.</span></span> <span data-ttu-id="2d18e-341">在範本資源中，使用 [FONT 語句](../menurc/font-statement.md)。</span><span class="sxs-lookup"><span data-stu-id="2d18e-341">In a template resource, use the [FONT Statement](../menurc/font-statement.md).</span></span> <span data-ttu-id="2d18e-342">在對話方塊範本中，設定 **ds \_ SETFONT** 或 **ds \_ SHELLFONT** 樣式，並指定點大小和字樣名稱。</span><span class="sxs-lookup"><span data-stu-id="2d18e-342">In a dialog box template, set the **DS\_SETFONT** or **DS\_SHELLFONT** style and specify a point size and a typeface name.</span></span> <span data-ttu-id="2d18e-343">即使對話方塊範本以這種方式指定字型，系統一律會使用對話方塊標題和對話方塊功能表的系統字型。</span><span class="sxs-lookup"><span data-stu-id="2d18e-343">Even if a dialog box template specifies a font in this manner, the system always uses the system font for the dialog box title and dialog box menus.</span></span>

<span data-ttu-id="2d18e-344">當對話方塊具有 **ds \_ SETFONT** 或 **ds \_ SHELLFONT** 樣式時，系統會將 [**WM \_ SETFONT**](/windows/desktop/winmsg/wm-setfont) 訊息傳送至對話方塊程式，並在建立控制項時將其傳送至每個控制項。</span><span class="sxs-lookup"><span data-stu-id="2d18e-344">When the dialog box has the **DS\_SETFONT** or **DS\_SHELLFONT** style, the system sends a [**WM\_SETFONT**](/windows/desktop/winmsg/wm-setfont) message to the dialog box procedure and to each control as it creates the control.</span></span> <span data-ttu-id="2d18e-345">對話方塊程式會負責儲存以 **WM \_ SETFONT** 訊息傳遞的字型控制碼，並在每次將文字寫入視窗時，選取顯示裝置內容的控點。</span><span class="sxs-lookup"><span data-stu-id="2d18e-345">The dialog box procedure is responsible for saving the font handle passed with the **WM\_SETFONT** message and selecting the handle into the display device context whenever it writes text to the window.</span></span> <span data-ttu-id="2d18e-346">預先定義的控制項預設會這樣做。</span><span class="sxs-lookup"><span data-stu-id="2d18e-346">Predefined controls do this by default.</span></span>

<span data-ttu-id="2d18e-347">不同版本的 Windows 可能會有不同的系統字型。</span><span class="sxs-lookup"><span data-stu-id="2d18e-347">The system font can vary between different versions of Windows.</span></span> <span data-ttu-id="2d18e-348">若要讓您的應用程式使用系統字型（不論其執行所在的系統），請使用 **DS \_ SHELLFONT** 搭配字型 MS Shell Dlg，並使用 [DIALOGEX 資源](../menurc/dialogex-resource.md) ，而不是 [對話方塊資源](../menurc/dialog-resource.md)。</span><span class="sxs-lookup"><span data-stu-id="2d18e-348">To have your application use the system font no matter which system it is running on, use **DS\_SHELLFONT** with the typeface MS Shell Dlg, and use the [DIALOGEX Resource](../menurc/dialogex-resource.md) instead of the [DIALOG Resource](../menurc/dialog-resource.md).</span></span> <span data-ttu-id="2d18e-349">系統會對應此字樣，讓您的對話方塊使用 Tahoma 字型。</span><span class="sxs-lookup"><span data-stu-id="2d18e-349">The system maps this typeface such that your dialog box will use the Tahoma font.</span></span> <span data-ttu-id="2d18e-350">請注意，如果字樣不是 MS Shell Dlg， **DS \_ SHELLFONT** 不會有任何作用。</span><span class="sxs-lookup"><span data-stu-id="2d18e-350">Note that **DS\_SHELLFONT** has no effect if the typeface is not MS Shell Dlg.</span></span>

### <a name="templates-in-memory"></a><span data-ttu-id="2d18e-351">記憶體中的範本</span><span class="sxs-lookup"><span data-stu-id="2d18e-351">Templates in Memory</span></span>

<span data-ttu-id="2d18e-352">記憶體中的對話方塊範本是由描述對話方塊的標頭所組成，後面接著一個或多個其他區塊的資料，以描述對話方塊中的每個控制項。</span><span class="sxs-lookup"><span data-stu-id="2d18e-352">A dialog box template in memory consists of a header that describes the dialog box, followed by one or more additional blocks of data that describe each of the controls in the dialog box.</span></span> <span data-ttu-id="2d18e-353">範本可以使用標準格式或延伸格式。</span><span class="sxs-lookup"><span data-stu-id="2d18e-353">The template can use either the standard format or the extended format.</span></span> <span data-ttu-id="2d18e-354">在標準範本中，標頭是 [**DLGTEMPLATE**](/windows/desktop/api/Winuser/ns-winuser-dlgtemplate) 結構，後面接著額外的可變長度陣列。</span><span class="sxs-lookup"><span data-stu-id="2d18e-354">In a standard template, the header is a [**DLGTEMPLATE**](/windows/desktop/api/Winuser/ns-winuser-dlgtemplate) structure followed by additional variable-length arrays.</span></span> <span data-ttu-id="2d18e-355">每個控制項的資料包含 [**DLGITEMTEMPLATE**](/windows/desktop/api/Winuser/ns-winuser-dlgitemtemplate) 結構，後面接著額外的可變長度陣列。</span><span class="sxs-lookup"><span data-stu-id="2d18e-355">The data for each control consists of a [**DLGITEMTEMPLATE**](/windows/desktop/api/Winuser/ns-winuser-dlgitemtemplate) structure followed by additional variable-length arrays.</span></span> <span data-ttu-id="2d18e-356">在擴充的對話方塊範本中，標頭會使用 [**DLGTEMPLATEEX**](dlgtemplateex.md) 格式，而控制項定義會使用 [**DLGITEMTEMPLATEEX**](dlgitemtemplateex.md) 格式。</span><span class="sxs-lookup"><span data-stu-id="2d18e-356">In an extended dialog box template, the header uses the [**DLGTEMPLATEEX**](dlgtemplateex.md) format and the control definitions use the [**DLGITEMTEMPLATEEX**](dlgitemtemplateex.md) format.</span></span>

<span data-ttu-id="2d18e-357">若要區分標準範本和延伸範本，請檢查對話方塊範本的前16位。</span><span class="sxs-lookup"><span data-stu-id="2d18e-357">To distinguish between a standard template and an extended template, check the first 16-bits of a dialog box template.</span></span> <span data-ttu-id="2d18e-358">在擴充的範本中，第一個 **單字** 是 0xffff;任何其他值則表示標準範本。</span><span class="sxs-lookup"><span data-stu-id="2d18e-358">In an extended template, the first **WORD** is 0xFFFF; any other value indicates a standard template.</span></span>

<span data-ttu-id="2d18e-359">如果您在記憶體中建立對話方塊範本，您必須確定每個 [**DLGITEMTEMPLATE**](/windows/desktop/api/Winuser/ns-winuser-dlgitemtemplate) 或 [**DLGITEMTEMPLATEEX**](dlgitemtemplateex.md) 控制項定義都在 **DWORD** 界限上對齊。</span><span class="sxs-lookup"><span data-stu-id="2d18e-359">If you create a dialog template in memory, you must ensure that the each of the [**DLGITEMTEMPLATE**](/windows/desktop/api/Winuser/ns-winuser-dlgitemtemplate) or [**DLGITEMTEMPLATEEX**](dlgitemtemplateex.md) control definitions are aligned on **DWORD** boundaries.</span></span> <span data-ttu-id="2d18e-360">此外，任何遵循控制項定義的建立資料都必須對齊 **DWORD** 界限。</span><span class="sxs-lookup"><span data-stu-id="2d18e-360">In addition, any creation data that follows a control definition must be aligned on a **DWORD** boundary.</span></span> <span data-ttu-id="2d18e-361">對話方塊範本中的所有其他可變長度陣列都必須對齊 **字** 邊界。</span><span class="sxs-lookup"><span data-stu-id="2d18e-361">All of the other variable-length arrays in a dialog box template must be aligned on **WORD** boundaries.</span></span>

### <a name="template-header"></a><span data-ttu-id="2d18e-362">範本標頭</span><span class="sxs-lookup"><span data-stu-id="2d18e-362">Template Header</span></span>

<span data-ttu-id="2d18e-363">在對話方塊的標準和延伸範本中，標頭包含下列一般資訊：</span><span class="sxs-lookup"><span data-stu-id="2d18e-363">In both the standard and extended templates for dialog boxes, the header includes the following general information:</span></span>

-   <span data-ttu-id="2d18e-364">對話方塊的位置和維度</span><span class="sxs-lookup"><span data-stu-id="2d18e-364">The location and dimensions of the dialog box</span></span>
-   <span data-ttu-id="2d18e-365">對話方塊的視窗和對話方塊樣式</span><span class="sxs-lookup"><span data-stu-id="2d18e-365">The window and dialog box styles for the dialog box</span></span>
-   <span data-ttu-id="2d18e-366">對話方塊中的控制項數目。</span><span class="sxs-lookup"><span data-stu-id="2d18e-366">The number of controls in the dialog box.</span></span> <span data-ttu-id="2d18e-367">此值會決定範本中的 [**DLGITEMTEMPLATE**](/windows/desktop/api/Winuser/ns-winuser-dlgitemtemplate) 或 [**DLGITEMTEMPLATEEX**](dlgitemtemplateex.md) 控制項定義數目。</span><span class="sxs-lookup"><span data-stu-id="2d18e-367">This value determines the number of [**DLGITEMTEMPLATE**](/windows/desktop/api/Winuser/ns-winuser-dlgitemtemplate) or [**DLGITEMTEMPLATEEX**](dlgitemtemplateex.md) control definitions in the template.</span></span>
-   <span data-ttu-id="2d18e-368">對話方塊的選擇性功能表資源。</span><span class="sxs-lookup"><span data-stu-id="2d18e-368">An optional menu resource for the dialog box.</span></span> <span data-ttu-id="2d18e-369">範本可能會指出對話方塊沒有功能表，或者可以指定序數值或以 null 終止的 Unicode 字串，以識別可執行檔中的功能表資源。</span><span class="sxs-lookup"><span data-stu-id="2d18e-369">The template can indicate that the dialog box does not have a menu, or it can specify an ordinal value or null-terminated Unicode string that identifies a menu resource in an executable file.</span></span>
-   <span data-ttu-id="2d18e-370">對話方塊的視窗類別。</span><span class="sxs-lookup"><span data-stu-id="2d18e-370">The window class of the dialog box.</span></span> <span data-ttu-id="2d18e-371">這可以是預先定義的對話方塊類別，或是識別已註冊視窗類別的序數值或以 null 終止的 Unicode 字串。</span><span class="sxs-lookup"><span data-stu-id="2d18e-371">This can be either the predefined dialog box class, or an ordinal value or null-terminated Unicode string that identifies a registered window class.</span></span>
-   <span data-ttu-id="2d18e-372">以 null 結束的 Unicode 字串，指定對話方塊視窗的標題。</span><span class="sxs-lookup"><span data-stu-id="2d18e-372">A null-terminated Unicode string that specifies the title for the dialog box window.</span></span> <span data-ttu-id="2d18e-373">如果字串是空的，則對話方塊的標題列是空白的。</span><span class="sxs-lookup"><span data-stu-id="2d18e-373">If the string is empty, the title bar of the dialog box is blank.</span></span> <span data-ttu-id="2d18e-374">如果對話方塊沒有 **WS \_ 標題** 樣式，系統會將標題設定為指定的字串，但不會顯示它。</span><span class="sxs-lookup"><span data-stu-id="2d18e-374">If the dialog box does not have the **WS\_CAPTION** style, the system sets the title to the specified string but does not display it.</span></span>
-   <span data-ttu-id="2d18e-375">如果對話方塊具有 **DS \_ SETFONT** 樣式，則標頭會指定字型的點大小和字樣名稱，以用於工作區中的文字以及對話方塊的控制項。</span><span class="sxs-lookup"><span data-stu-id="2d18e-375">If the dialog box has the **DS\_SETFONT** style, the header specifies the point size and typeface name of the font to use for the text in the client area and controls of the dialog box.</span></span>

<span data-ttu-id="2d18e-376">在擴充的範本中， [**DLGTEMPLATEEX**](dlgtemplateex.md) 標頭也會指定下列其他資訊：</span><span class="sxs-lookup"><span data-stu-id="2d18e-376">In an extended template, the [**DLGTEMPLATEEX**](dlgtemplateex.md) header also specifies the following additional information:</span></span>

-   <span data-ttu-id="2d18e-377">當系統傳送 [**WM \_**](../shell/wm-help.md) 說明訊息時，對話方塊視窗的說明內容識別碼。</span><span class="sxs-lookup"><span data-stu-id="2d18e-377">The help context identifier of the dialog box window when the system sends a [**WM\_HELP**](../shell/wm-help.md) message.</span></span>
-   <span data-ttu-id="2d18e-378">如果對話方塊具有 **ds \_ SETFONT** 或 **ds \_ SHELLFONT** 樣式，則標頭會指定字型粗細，並指出字型是否為斜體。</span><span class="sxs-lookup"><span data-stu-id="2d18e-378">If the dialog box has the **DS\_SETFONT** or **DS\_SHELLFONT** style, the header specifies the font weight and indicates whether the font is italic.</span></span>

### <a name="control-definitions"></a><span data-ttu-id="2d18e-379">控制項定義</span><span class="sxs-lookup"><span data-stu-id="2d18e-379">Control Definitions</span></span>

<span data-ttu-id="2d18e-380">在範本標頭之後，會有一或多個控制項定義描述對話方塊的控制項。</span><span class="sxs-lookup"><span data-stu-id="2d18e-380">Following the template header is one or more control definitions that describe the controls of the dialog box.</span></span> <span data-ttu-id="2d18e-381">在標準和延伸範本中，對話方塊標頭都有一個成員，指出範本中的控制項定義數目。</span><span class="sxs-lookup"><span data-stu-id="2d18e-381">In both the standard and extended templates, the dialog box header has a member that indicates the number of control definitions in the template.</span></span> <span data-ttu-id="2d18e-382">在標準範本中，每個控制項定義都包含一個 [**DLGITEMTEMPLATE**](/windows/desktop/api/Winuser/ns-winuser-dlgitemtemplate) 結構，後面接著額外的可變長度陣列。</span><span class="sxs-lookup"><span data-stu-id="2d18e-382">In a standard template, each control definition consists of a [**DLGITEMTEMPLATE**](/windows/desktop/api/Winuser/ns-winuser-dlgitemtemplate) structure followed by additional variable-length arrays.</span></span> <span data-ttu-id="2d18e-383">在擴充的範本中，控制項定義會使用 [**DLGITEMTEMPLATEEX**](dlgitemtemplateex.md) 格式。</span><span class="sxs-lookup"><span data-stu-id="2d18e-383">In an extended template, the control definitions use the [**DLGITEMTEMPLATEEX**](dlgitemtemplateex.md) format.</span></span>

<span data-ttu-id="2d18e-384">在標準和延伸範本中，控制項定義包含下列資訊：</span><span class="sxs-lookup"><span data-stu-id="2d18e-384">In both the standard and extended templates, the control definition includes the following information:</span></span>

-   <span data-ttu-id="2d18e-385">控制項的位置和維度。</span><span class="sxs-lookup"><span data-stu-id="2d18e-385">The location and dimensions of the control.</span></span>
-   <span data-ttu-id="2d18e-386">控制項的視窗和控制項樣式。</span><span class="sxs-lookup"><span data-stu-id="2d18e-386">The window and control styles for the control.</span></span>
-   <span data-ttu-id="2d18e-387">控制項識別碼。</span><span class="sxs-lookup"><span data-stu-id="2d18e-387">The control identifier.</span></span>
-   <span data-ttu-id="2d18e-388">控制項的視窗類別。</span><span class="sxs-lookup"><span data-stu-id="2d18e-388">The window class of the control.</span></span> <span data-ttu-id="2d18e-389">這可以是預先定義之系統類別的序數值，或是指定已註冊視窗類別名稱的以 null 結束的 Unicode 字串。</span><span class="sxs-lookup"><span data-stu-id="2d18e-389">This can be either the ordinal value of a predefined system class or a null-terminated Unicode string that specifies the name of a registered window class.</span></span>
-   <span data-ttu-id="2d18e-390">以 null 結束的 Unicode 字串，這個字串會指定控制項的初始文字，或是在可執行檔中識別資源的序數值（例如圖示）。</span><span class="sxs-lookup"><span data-stu-id="2d18e-390">A null-terminated Unicode string that specifies the initial text of the control, or an ordinal value that identifies a resource, such as an icon, in an executable file.</span></span>
-   <span data-ttu-id="2d18e-391">選用的可變長度區塊建立資料。</span><span class="sxs-lookup"><span data-stu-id="2d18e-391">An optional variable-length block of creation data.</span></span> <span data-ttu-id="2d18e-392">當系統建立控制項時，它會在傳送至控制項之 [**WM \_ 建立**](/windows/desktop/winmsg/wm-create)訊息的 *lParam* 參數中，傳遞此資料的指標。</span><span class="sxs-lookup"><span data-stu-id="2d18e-392">When the system creates the control, it passes a pointer to this data in the *lParam* parameter of the [**WM\_CREATE**](/windows/desktop/winmsg/wm-create) message that it sends to the control.</span></span>

<span data-ttu-id="2d18e-393">在擴充的範本中，當系統傳送 [**WM \_**](../shell/wm-help.md) 說明訊息時，控制項定義也會指定控制項的說明內容識別碼。</span><span class="sxs-lookup"><span data-stu-id="2d18e-393">In an extended template, the control definition also specifies a help context identifier for the control when the system sends a [**WM\_HELP**](../shell/wm-help.md) message.</span></span>

 

 