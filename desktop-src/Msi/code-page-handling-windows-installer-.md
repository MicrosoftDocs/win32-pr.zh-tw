---
description: Windows Installer 會將所有資料庫字串儲存在單一共用字串集區中，以減少資料庫的大小，並提升效能。 如需數值字碼頁的清單，請參閱當地語系化錯誤和 ActionText 資料表。
ms.assetid: 5d413fb7-99da-49f3-ace3-ec285df2e634
title: '程式字碼頁處理 (Windows Installer) '
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 6db2788a1bfc6bdb49ec1402d5bba8a1a2594b30
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/07/2021
ms.locfileid: "106972682"
---
# <a name="code-page-handling-windows-installer"></a><span data-ttu-id="90d8d-104">程式字碼頁處理 (Windows Installer) </span><span class="sxs-lookup"><span data-stu-id="90d8d-104">Code Page Handling (Windows Installer)</span></span>

<span data-ttu-id="90d8d-105">Windows Installer 會將所有資料庫字串儲存在單一共用字串集區中，以減少資料庫的大小，並提升效能。</span><span class="sxs-lookup"><span data-stu-id="90d8d-105">The Windows Installer stores all database strings in a single shared string pool to reduce the size of the database, and to improve performance.</span></span> <span data-ttu-id="90d8d-106">如需數值字碼頁的清單，請參閱 [當地語系化錯誤和 ActionText 資料表](localizing-the-error-and-actiontext-tables.md)。</span><span class="sxs-lookup"><span data-stu-id="90d8d-106">For a list of numeric code pages, see [Localizing the Error and ActionText Tables](localizing-the-error-and-actiontext-tables.md).</span></span>

<span data-ttu-id="90d8d-107">如需詳細資訊，請 [判斷安裝資料庫的字碼頁](determining-an-installation-database-s-code-page.md)。</span><span class="sxs-lookup"><span data-stu-id="90d8d-107">For more information, [Determining an Installation Database's Code Page](determining-an-installation-database-s-code-page.md).</span></span>

<span data-ttu-id="90d8d-108">Windows Installer 使用 [**IsValidCodePage**](/windows/desktop/api/winnls/nf-winnls-isvalidcodepage) 來判斷字碼頁是否有效。</span><span class="sxs-lookup"><span data-stu-id="90d8d-108">Windows Installer uses [**IsValidCodePage**](/windows/desktop/api/winnls/nf-winnls-isvalidcodepage) to determine whether the code page is valid.</span></span>

### <a name="localizing-a-windows-installer-package"></a><span data-ttu-id="90d8d-109">當地語系化 Windows Installer 套件</span><span class="sxs-lookup"><span data-stu-id="90d8d-109">Localizing a Windows Installer Package</span></span>

<span data-ttu-id="90d8d-110">如果您將 Windows Installer 封裝當地語系化，它可能會涉及修改資料庫資料表中的資訊、將資料表匯出為 ANSI 文字封存檔案，然後將封存檔匯入正在當地語系化的資料庫中。</span><span class="sxs-lookup"><span data-stu-id="90d8d-110">If you localize a Windows Installer package, it may involve modifying information in database tables, exporting the tables to ANSI text archive files, and then importing the archive files into the database that is being localized.</span></span> <span data-ttu-id="90d8d-111">您也可以使用資料庫資料表編輯器或 [資料庫函數](database-functions.md)，將當地語系化變更加入至資料庫。</span><span class="sxs-lookup"><span data-stu-id="90d8d-111">You can also add localization changes to a database by using a database table editor or the [Database Functions](database-functions.md).</span></span> <span data-ttu-id="90d8d-112">在對資料庫進行任何當地語系化變更之前，請務必先設定要當地語系化之資料庫的字碼頁。</span><span class="sxs-lookup"><span data-stu-id="90d8d-112">It is important to set the code page of the database that is being localized before you make any localization changes to the database.</span></span> <span data-ttu-id="90d8d-113">將資料庫當地語系化之後，請不要設定資料庫的字碼頁，因為這樣可能會損毀擴充的字元。</span><span class="sxs-lookup"><span data-stu-id="90d8d-113">Do not set the code page of the database after localizing the database, because this can corrupt extended characters.</span></span> <span data-ttu-id="90d8d-114">如需詳細資訊，請參閱 [設定資料庫的字碼頁](setting-the-code-page-of-a-database.md)。</span><span class="sxs-lookup"><span data-stu-id="90d8d-114">For more information, see [Setting the Code Page of a Database](setting-the-code-page-of-a-database.md).</span></span>

<span data-ttu-id="90d8d-115">處理字碼頁的建議方法是撰寫一個中性資料庫，其中只包含可轉譯成任何字碼頁的字元。</span><span class="sxs-lookup"><span data-stu-id="90d8d-115">The recommended approach for handling code pages is to author a neutral database that only contains characters that can be translated into any code page.</span></span> <span data-ttu-id="90d8d-116">如需詳細資訊，請參閱 [使用中性程式碼建立資料庫頁面](creating-a-database-with-a-neutral-code-page.md)。</span><span class="sxs-lookup"><span data-stu-id="90d8d-116">For more information, see [Creating a Database with a Neutral Code Page](creating-a-database-with-a-neutral-code-page.md).</span></span>

<span data-ttu-id="90d8d-117">如果您使用資料庫封存檔案加入當地語系化資訊，您可以使用 [**MsiDatabaseExport**](/windows/desktop/api/Msiquery/nf-msiquery-msidatabaseexporta) 將包含當地語系化變更的資料庫中的資料表匯出至 ANSI 文字封存檔案，然後將這些資料表匯入到以 [**MsiDatabaseImport**](/windows/desktop/api/Msiquery/nf-msiquery-msidatabaseimporta)當地語系化的資料庫中。</span><span class="sxs-lookup"><span data-stu-id="90d8d-117">If you add localization information with database archive files, you can use [**MsiDatabaseExport**](/windows/desktop/api/Msiquery/nf-msiquery-msidatabaseexporta) to export tables from a database that contains localization changes to ANSI text archive files, and then import these into the database being localized with [**MsiDatabaseImport**](/windows/desktop/api/Msiquery/nf-msiquery-msidatabaseimporta).</span></span> <span data-ttu-id="90d8d-118">匯出封存檔案的字碼頁一律與其父資料庫相同。</span><span class="sxs-lookup"><span data-stu-id="90d8d-118">The code page of an exported archive file is always the same as its parent database.</span></span> <span data-ttu-id="90d8d-119">匯入檔案的字碼頁和接收檔案的資料庫必須相同，或至少有兩個字碼頁必須是中立的。</span><span class="sxs-lookup"><span data-stu-id="90d8d-119">The code pages of an imported file and the database that is receiving the file must be identical, or at least one of the two code pages must be neutral.</span></span> <span data-ttu-id="90d8d-120">如需詳細資訊，請參閱匯 [入和匯出資料表的字碼頁處理](code-page-handling-of-imported-and-exported-tables.md)。</span><span class="sxs-lookup"><span data-stu-id="90d8d-120">For more information, see [Code Page Handling of Imported and Exported Tables](code-page-handling-of-imported-and-exported-tables.md).</span></span>

<span data-ttu-id="90d8d-121">如果您使用文字編輯器加入當地語系化資訊，或 [資料庫](database-functions.md) 函式小心只將字串參數傳遞至使用當地語系化資料庫之字碼頁的 Windows Installer API。</span><span class="sxs-lookup"><span data-stu-id="90d8d-121">If you add localization information with a text editor or the [Database Functions](database-functions.md) be careful to only pass string parameters to the Windows Installer API that uses the code page of the database that is being localized.</span></span> <span data-ttu-id="90d8d-122">如果字串參數包含資料庫字碼頁未表示的字元，呼叫 [**MsiDatabaseCommit**](/windows/desktop/api/Msiquery/nf-msiquery-msidatabasecommit)時就會發生錯誤。</span><span class="sxs-lookup"><span data-stu-id="90d8d-122">If a string parameter contains characters not represented by the code page of the database, an error occurs when calling [**MsiDatabaseCommit**](/windows/desktop/api/Msiquery/nf-msiquery-msidatabasecommit).</span></span> <span data-ttu-id="90d8d-123">如需詳細資訊，請參閱 [參數字串的字碼頁處理](code-page-handling-of-parameter-strings.md)。</span><span class="sxs-lookup"><span data-stu-id="90d8d-123">For more information, see [Code Page Handling of Parameter Strings](code-page-handling-of-parameter-strings.md).</span></span>

<span data-ttu-id="90d8d-124">如果有一個封裝用來安裝產品的多個語言版本，則用來將字串當地語系化的轉換也可以變更資料庫的字碼頁。</span><span class="sxs-lookup"><span data-stu-id="90d8d-124">If one package is used to install multiple language versions of a product, the transform that is used to localize strings can also change the code page of the database.</span></span>

 

 
