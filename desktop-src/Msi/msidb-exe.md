---
description: Msidb.exe 會使用 MsiDatabaseImport 和 MsiDatabaseExport 來匯入和匯出資料庫資料表和資料流程。
ms.assetid: 2eee535f-e7f6-4e1a-9667-df4b8067b132
title: Msidb.exe
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 86f2e1fa6a1cf1a9dc8a01b9f9d6542607dd9275
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/08/2021
ms.locfileid: "106978002"
---
# <a name="msidbexe"></a><span data-ttu-id="b8f96-103">Msidb.exe</span><span class="sxs-lookup"><span data-stu-id="b8f96-103">Msidb.exe</span></span>

<span data-ttu-id="b8f96-104">Msidb.exe 會使用 [**MsiDatabaseImport**](/windows/desktop/api/Msiquery/nf-msiquery-msidatabaseimporta) 和 [**MsiDatabaseExport**](/windows/desktop/api/Msiquery/nf-msiquery-msidatabaseexporta) 來匯入和匯出 [資料庫資料表](database-tables.md) 和資料流程。</span><span class="sxs-lookup"><span data-stu-id="b8f96-104">Msidb.exe uses [**MsiDatabaseImport**](/windows/desktop/api/Msiquery/nf-msiquery-msidatabaseimporta) and [**MsiDatabaseExport**](/windows/desktop/api/Msiquery/nf-msiquery-msidatabaseexporta) to import and export [database tables](database-tables.md) and streams.</span></span>

<span data-ttu-id="b8f96-105">如果在命令列上指定了模式、資料夾、資料庫和資料表清單，Msidb.exe 不會顯示任何使用者介面，而是以無訊息命令列公用程式的形式運作，以用於組建腳本。</span><span class="sxs-lookup"><span data-stu-id="b8f96-105">If the mode, folder, database and table list are specified on the command line, Msidb.exe does not bring up any user interface and operates as a silent command-line utility suitable for build script.</span></span>

## <a name="syntax"></a><span data-ttu-id="b8f96-106">Syntax</span><span class="sxs-lookup"><span data-stu-id="b8f96-106">Syntax</span></span>

<span data-ttu-id="b8f96-107">**MsiDb** \*{option} \***...**_{option}_*_..._* \* {table} \***...**_{table}_</span><span class="sxs-lookup"><span data-stu-id="b8f96-107">**MsiDb** *{option}\***...**_{option}_*_..._\* \*{table}\***...**_{table}_</span></span>

## <a name="command-line-options"></a><span data-ttu-id="b8f96-108">命令列選項</span><span class="sxs-lookup"><span data-stu-id="b8f96-108">Command Line Options</span></span>

<span data-ttu-id="b8f96-109">Msidb.exe 會使用下列不區分大小寫的命令列選項。</span><span class="sxs-lookup"><span data-stu-id="b8f96-109">Msidb.exe uses the following case-insensitive command line options.</span></span> <span data-ttu-id="b8f96-110">斜線分隔符號也可以用來取代虛線。</span><span class="sxs-lookup"><span data-stu-id="b8f96-110">A slash delimiter may also be used in place of a dash.</span></span>



| <span data-ttu-id="b8f96-111">選項</span><span class="sxs-lookup"><span data-stu-id="b8f96-111">Option</span></span> | <span data-ttu-id="b8f96-112">Description</span><span class="sxs-lookup"><span data-stu-id="b8f96-112">Description</span></span>                                                                                                                                                                                                                                                                                                                         |
|--------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="b8f96-113">-i</span><span class="sxs-lookup"><span data-stu-id="b8f96-113">-i</span></span>     | <span data-ttu-id="b8f96-114">從資料夾將文字封存檔匯入至資料庫。</span><span class="sxs-lookup"><span data-stu-id="b8f96-114">Import text archive files from folder into database.</span></span> <span data-ttu-id="b8f96-115">匯入資料表名稱的檔案名為8個字元，副檔名為 "idt"。</span><span class="sxs-lookup"><span data-stu-id="b8f96-115">Table names for import are file names 8 characters long with an ".idt" extension.</span></span> <span data-ttu-id="b8f96-116">如果匯入命令提供了較長的名稱，則會截斷為8個字元。</span><span class="sxs-lookup"><span data-stu-id="b8f96-116">Longer names are truncated to 8 characters if supplied by command for import.</span></span> <span data-ttu-id="b8f96-117">您可以使用標準萬用字元規格。</span><span class="sxs-lookup"><span data-stu-id="b8f96-117">Standard wild card specifications may be used.</span></span>                                                                 |
| <span data-ttu-id="b8f96-118">-E</span><span class="sxs-lookup"><span data-stu-id="b8f96-118">-e</span></span>     | <span data-ttu-id="b8f96-119">將選取的資料表從資料庫匯出至資料夾中的文字保存檔案。</span><span class="sxs-lookup"><span data-stu-id="b8f96-119">Export selected tables from database into text archive files in folder.</span></span> <span data-ttu-id="b8f96-120">匯出的資料表名稱是資料表名稱。</span><span class="sxs-lookup"><span data-stu-id="b8f96-120">Table names for export are table names.</span></span> <span data-ttu-id="b8f96-121">只可以使用萬用字元規格 " \* "。</span><span class="sxs-lookup"><span data-stu-id="b8f96-121">Only the wildcard specification, "\*", may be used.</span></span> <span data-ttu-id="b8f96-122">資料表可以從唯讀資料庫匯出。</span><span class="sxs-lookup"><span data-stu-id="b8f96-122">Tables may be exported from a read only database.</span></span>                                                                                                               |
| <span data-ttu-id="b8f96-123">-c</span><span class="sxs-lookup"><span data-stu-id="b8f96-123">-c</span></span>     | <span data-ttu-id="b8f96-124">建立新的資料庫檔案，並匯入資料表。</span><span class="sxs-lookup"><span data-stu-id="b8f96-124">Creates a new database file and imports tables.</span></span> <span data-ttu-id="b8f96-125">覆寫現有的資料庫檔案。</span><span class="sxs-lookup"><span data-stu-id="b8f96-125">Overwrites an existing database file.</span></span>                                                                                                                                                                                                                                               |
| <span data-ttu-id="b8f96-126">-f</span><span class="sxs-lookup"><span data-stu-id="b8f96-126">-f</span></span>     | <span data-ttu-id="b8f96-127">指定包含資料表和資料流程之文字封存檔案的資料夾。</span><span class="sxs-lookup"><span data-stu-id="b8f96-127">Specifies the folder containing the text archive files for tables and streams.</span></span> <span data-ttu-id="b8f96-128">如果未指定包含文字封存檔案的資料夾，則公用程式會提示使用者輸入資料夾。</span><span class="sxs-lookup"><span data-stu-id="b8f96-128">If the folder containing the text archive files is not specified, the utility prompts the user for the folder.</span></span>                                                                                                                                       |
| <span data-ttu-id="b8f96-129">-d</span><span class="sxs-lookup"><span data-stu-id="b8f96-129">-d</span></span>     | <span data-ttu-id="b8f96-130">資料庫檔案的完整路徑。</span><span class="sxs-lookup"><span data-stu-id="b8f96-130">Fully qualified path to the database file.</span></span>                                                                                                                                                                                                                                                                                          |
| <span data-ttu-id="b8f96-131">-M</span><span class="sxs-lookup"><span data-stu-id="b8f96-131">-m</span></span>     | <span data-ttu-id="b8f96-132">要合併之資料庫的完整路徑。</span><span class="sxs-lookup"><span data-stu-id="b8f96-132">Fully qualified path to the database that is to be merged in.</span></span> <span data-ttu-id="b8f96-133">此選項僅適用于無訊息命令列模式。</span><span class="sxs-lookup"><span data-stu-id="b8f96-133">This option is available only in silent command line mode.</span></span> <span data-ttu-id="b8f96-134">此選項的多個實例最多可能會有10個。</span><span class="sxs-lookup"><span data-stu-id="b8f96-134">Multiple instances of this option may occur to a maximum of 10.</span></span> <span data-ttu-id="b8f96-135">如果未在命令列上指定資料庫，公用程式會提示使用者輸入資料庫。</span><span class="sxs-lookup"><span data-stu-id="b8f96-135">If the database is not specified on the command-line, the utility prompts the user for the database.</span></span>                                       |
| <span data-ttu-id="b8f96-136">-t</span><span class="sxs-lookup"><span data-stu-id="b8f96-136">-t</span></span>     | <span data-ttu-id="b8f96-137">要套用之轉換的完整路徑。</span><span class="sxs-lookup"><span data-stu-id="b8f96-137">Fully qualified path to the transform to be applied.</span></span> <span data-ttu-id="b8f96-138">此選項僅適用于無訊息命令列模式。</span><span class="sxs-lookup"><span data-stu-id="b8f96-138">This option is available only in silent command line mode.</span></span> <span data-ttu-id="b8f96-139">此選項的多個實例最多可能會有10個。</span><span class="sxs-lookup"><span data-stu-id="b8f96-139">Multiple instances of this option may occur to a maximum of 10.</span></span>                                                                                                                                                     |
| <span data-ttu-id="b8f96-140">-j</span><span class="sxs-lookup"><span data-stu-id="b8f96-140">-j</span></span>     | <span data-ttu-id="b8f96-141">要從資料庫移除的儲存體名稱。</span><span class="sxs-lookup"><span data-stu-id="b8f96-141">Name of storage to remove from the database.</span></span> <span data-ttu-id="b8f96-142">此選項僅適用于無訊息命令列模式。</span><span class="sxs-lookup"><span data-stu-id="b8f96-142">This option is available only in silent command line mode.</span></span> <span data-ttu-id="b8f96-143">此選項的多個實例最多可能會有10個。</span><span class="sxs-lookup"><span data-stu-id="b8f96-143">Multiple instances of this option may occur to a maximum of 10.</span></span>                                                                                                                                                             |
| <span data-ttu-id="b8f96-144">-k</span><span class="sxs-lookup"><span data-stu-id="b8f96-144">-k</span></span>     | <span data-ttu-id="b8f96-145">要從資料庫移除的資料流程名稱。</span><span class="sxs-lookup"><span data-stu-id="b8f96-145">Name of stream to remove from the database.</span></span> <span data-ttu-id="b8f96-146">此選項僅適用于無訊息命令列模式。</span><span class="sxs-lookup"><span data-stu-id="b8f96-146">This option available only in silent command line mode.</span></span> <span data-ttu-id="b8f96-147">此選項的多個實例最多可能會有10個。</span><span class="sxs-lookup"><span data-stu-id="b8f96-147">Multiple instances of this option may occur to a maximum of 10.</span></span>                                                                                                                                                                 |
| <span data-ttu-id="b8f96-148">-X</span><span class="sxs-lookup"><span data-stu-id="b8f96-148">-x</span></span>     | <span data-ttu-id="b8f96-149">要儲存到目前目錄中之磁片檔案的資料流程名稱。</span><span class="sxs-lookup"><span data-stu-id="b8f96-149">Name of stream to save to a disk file in the current directory.</span></span> <span data-ttu-id="b8f96-150">此選項僅適用于無訊息命令列模式。</span><span class="sxs-lookup"><span data-stu-id="b8f96-150">This option is available only in silent command line mode.</span></span> <span data-ttu-id="b8f96-151">二進位資料串流會儲存為副檔名為 ". ibd" 的個別檔案。</span><span class="sxs-lookup"><span data-stu-id="b8f96-151">Binary data streams are stored as separate files with the extension ".ibd".</span></span> <span data-ttu-id="b8f96-152">使用的二進位檔案名是包含資料流程之資料列的主鍵資料。</span><span class="sxs-lookup"><span data-stu-id="b8f96-152">Binary filename used is primary key data for the row containing the stream.</span></span>                                                  |
| <span data-ttu-id="b8f96-153">-w</span><span class="sxs-lookup"><span data-stu-id="b8f96-153">-w</span></span>     | <span data-ttu-id="b8f96-154">要儲存到目前的目錄中之磁片檔案的儲存體名稱。</span><span class="sxs-lookup"><span data-stu-id="b8f96-154">Name of storage to save to a disk file in the current directory.</span></span> <span data-ttu-id="b8f96-155">此選項僅適用于無訊息命令列模式。</span><span class="sxs-lookup"><span data-stu-id="b8f96-155">This option is available only in silent command line mode.</span></span>                                                                                                                                                                                                         |
| <span data-ttu-id="b8f96-156">-a</span><span class="sxs-lookup"><span data-stu-id="b8f96-156">-a</span></span>     | <span data-ttu-id="b8f96-157">要新增至資料庫做為資料流程的檔案名。</span><span class="sxs-lookup"><span data-stu-id="b8f96-157">Name of file to add to the database as a stream.</span></span> <span data-ttu-id="b8f96-158">此選項僅適用于無訊息命令列模式。</span><span class="sxs-lookup"><span data-stu-id="b8f96-158">This option is available only in silent command line mode.</span></span> <span data-ttu-id="b8f96-159">此選項的多個實例最多可能會有10個。</span><span class="sxs-lookup"><span data-stu-id="b8f96-159">Multiple instances of this option may occur to a maximum of 10.</span></span> <span data-ttu-id="b8f96-160">二進位資料串流會儲存為副檔名為 ". ibd" 的個別檔案。</span><span class="sxs-lookup"><span data-stu-id="b8f96-160">Binary data streams are stored as separate files with the extension ".ibd".</span></span> <span data-ttu-id="b8f96-161">使用的二進位檔案名是包含資料流程之資料列的主鍵資料。</span><span class="sxs-lookup"><span data-stu-id="b8f96-161">Binary filename used is primary key data for the row containing the stream.</span></span> |
| <span data-ttu-id="b8f96-162">-r</span><span class="sxs-lookup"><span data-stu-id="b8f96-162">-r</span></span>     | <span data-ttu-id="b8f96-163">要加入至資料庫做為 substorage 的儲存體名稱。</span><span class="sxs-lookup"><span data-stu-id="b8f96-163">Name of storage to add to the database as a substorage.</span></span> <span data-ttu-id="b8f96-164">此選項僅適用于無訊息命令列模式。</span><span class="sxs-lookup"><span data-stu-id="b8f96-164">This option available only in silent command line mode.</span></span> <span data-ttu-id="b8f96-165">此選項的多個實例最多可能會有10個。</span><span class="sxs-lookup"><span data-stu-id="b8f96-165">Multiple instances of this option may occur to a maximum of 10.</span></span>                                                                                                                                                     |
| <span data-ttu-id="b8f96-166">-S</span><span class="sxs-lookup"><span data-stu-id="b8f96-166">-s</span></span>     | <span data-ttu-id="b8f96-167">將資料表名稱截斷為匯出至 idt 的8個字元。</span><span class="sxs-lookup"><span data-stu-id="b8f96-167">Truncate table names to 8 characters on export to an .idt.</span></span> <span data-ttu-id="b8f96-168">資料表名稱會截斷為8個字元，並加入副檔名 ". idt"。</span><span class="sxs-lookup"><span data-stu-id="b8f96-168">The table name is truncated to 8 characters and the extension ".idt" is added.</span></span>                                                                                                                                                                                           |
| <span data-ttu-id="b8f96-169">-?</span><span class="sxs-lookup"><span data-stu-id="b8f96-169">-?</span></span>     | <span data-ttu-id="b8f96-170">顯示命令列說明對話方塊</span><span class="sxs-lookup"><span data-stu-id="b8f96-170">Displays the command line help dialog</span></span>                                                                                                                                                                                                                                                                                               |



 

> [!Note]  
> <span data-ttu-id="b8f96-171">使用含有空格的長檔名時，請使用引號括住。</span><span class="sxs-lookup"><span data-stu-id="b8f96-171">When using long filenames with spaces, use quotes around them.</span></span> <span data-ttu-id="b8f96-172">例如，針對位於 "我的檔" 資料夾的資料庫，請將它指定為「c：我的 \\ 文檔」。</span><span class="sxs-lookup"><span data-stu-id="b8f96-172">For example, for a database that is in the "My Documents" folder, specify it as "c:\\my documents".</span></span>

 

<span data-ttu-id="b8f96-173">此工具僅適用于 [Windows Installer 開發人員的 Windows SDK 元件](platform-sdk-components-for-windows-installer-developers.md)。</span><span class="sxs-lookup"><span data-stu-id="b8f96-173">This tool is only available in the [Windows SDK Components for Windows Installer Developers](platform-sdk-components-for-windows-installer-developers.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="b8f96-174">相關主題</span><span class="sxs-lookup"><span data-stu-id="b8f96-174">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="b8f96-175">Windows Installer 開發工具</span><span class="sxs-lookup"><span data-stu-id="b8f96-175">Windows Installer Development Tools</span></span>](windows-installer-development-tools.md)
</dt> <dt>

[<span data-ttu-id="b8f96-176">已發行的版本、工具和可轉散發套件</span><span class="sxs-lookup"><span data-stu-id="b8f96-176">Released Versions, Tools, and Redistributables</span></span>](released-versions-tools-and-redistributables.md)
</dt> </dl>

 

 



