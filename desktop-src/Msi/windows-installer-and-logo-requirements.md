---
description: 「經 Microsoft Windows 認證」標誌會識別經過獨立測試驗證的產品，以符合 Windows 的應用程式規格。
ms.assetid: d33efb75-1813-40a5-8846-8799e16b368d
title: Windows Installer 和標誌需求
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 7bf86b31442676c358736250e0a2b602488dc852
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/08/2021
ms.locfileid: "104027444"
---
# <a name="windows-installer-and-logo-requirements"></a><span data-ttu-id="cf087-103">Windows Installer 和標誌需求</span><span class="sxs-lookup"><span data-stu-id="cf087-103">Windows Installer and Logo Requirements</span></span>

<span data-ttu-id="cf087-104">「經 Microsoft Windows 認證」標誌會識別經過獨立測試驗證的產品，以符合 Windows 的應用程式規格。</span><span class="sxs-lookup"><span data-stu-id="cf087-104">The Certified for Microsoft Windows Logo identifies products that have been verified through independent testing to comply with the Application Specification for Windows.</span></span> <span data-ttu-id="cf087-105">此規格是由 Microsoft 與客戶和其他開發人員共同合作，以提供藍圖來建立可靠且可管理的應用程式。</span><span class="sxs-lookup"><span data-stu-id="cf087-105">This specification was developed by Microsoft in cooperation with customers and other developers to provide a road map for building reliable and manageable applications.</span></span> <span data-ttu-id="cf087-106">符合規格的軟體供應商符合認證的 Microsoft Windows 標誌資格，然後再授權標誌，以用於產品包裝、廣告、附屬品和其他行銷教材。</span><span class="sxs-lookup"><span data-stu-id="cf087-106">Software vendors who comply with the specification qualify for the Certified for Microsoft Windows logo and then license the logo for use on their product packaging, advertising, collateral, and other marketing materials.</span></span>

<span data-ttu-id="cf087-107">如需適用于您應用程式的 Windows Vista、Windows XP 及 Windows Server 2008 認證的詳細資訊，請參閱 [Microsoft 合作夥伴網路]( https://partner.microsoft.com)。</span><span class="sxs-lookup"><span data-stu-id="cf087-107">For more information about Windows Vista, Windows XP, and Windows Server 2008 certification for your applications, see the [Microsoft Partner Network]( https://partner.microsoft.com).</span></span>

<span data-ttu-id="cf087-108">如需有關應用程式的 Windows Server 2003 和 Windows 2000 認證的詳細資訊，請參閱 [https://msdn.microsoft.com/certification](https://www.microsoft.com/windowsserver2003/partners/isvs/cfw.mspx) 。</span><span class="sxs-lookup"><span data-stu-id="cf087-108">For more information about the Windows Server 2003 and Windows 2000 certification for your applications, see [https://msdn.microsoft.com/certification](https://www.microsoft.com/windowsserver2003/partners/isvs/cfw.mspx).</span></span>

<span data-ttu-id="cf087-109">如果您要為應用程式撰寫安裝套件，您可以利用 Microsoft Windows Installer 的功能，以協助滿足幾項認證需求。</span><span class="sxs-lookup"><span data-stu-id="cf087-109">If you are authoring an installation package for your application, you may take advantage of the capabilities of the Microsoft Windows Installer to help satisfy several of the requirements for certification.</span></span> <span data-ttu-id="cf087-110">下表提供與某些認證需求相關 Windows Installer 檔中的資訊連結。</span><span class="sxs-lookup"><span data-stu-id="cf087-110">The following table provides links to information in Windows Installer documentation pertinent for some of the certification requirements.</span></span> <span data-ttu-id="cf087-111">請注意，在應用程式規格中所討論的憑證不是每個需求都取決於 Windows Installer。</span><span class="sxs-lookup"><span data-stu-id="cf087-111">Note that the not every requirement for certification discussed in the Application Specification is dependent upon Windows Installer.</span></span>



| <span data-ttu-id="cf087-112">認證的需求</span><span class="sxs-lookup"><span data-stu-id="cf087-112">Requirement for Certification</span></span>                                                                                                                                               | <span data-ttu-id="cf087-113">請參閱下列各節</span><span class="sxs-lookup"><span data-stu-id="cf087-113">See the following sections</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="cf087-114">1.1 應用程式應該執行主要功能並維持穩定性。</span><span class="sxs-lookup"><span data-stu-id="cf087-114">1.1 Application should perform primary functionality and maintain stability.</span></span><br/>                                                                                     | <span data-ttu-id="cf087-115">如果您提供安裝套件，您的應用程式可以使用所有32位 Windows 平臺上可用的安裝程式服務。</span><span class="sxs-lookup"><span data-stu-id="cf087-115">If you provide an installation package, your application can use the installer service available on all 32-bit Windows platforms.</span></span> <span data-ttu-id="cf087-116">使用安裝程式可以改善應用程式的功能和穩定性。</span><span class="sxs-lookup"><span data-stu-id="cf087-116">Using the Installer can improve the functionality and stability of your application.</span></span> <span data-ttu-id="cf087-117">請參閱[Windows Installer 的](overview-of-windows-installer.md)[復原](resiliency.md)總覽</span><span class="sxs-lookup"><span data-stu-id="cf087-117">See [Resiliency](resiliency.md)[Overview of Windows Installer](overview-of-windows-installer.md)</span></span><br/> <span data-ttu-id="cf087-118">[Windows Installer 檔的藍圖](roadmap-to-windows-installer-documentation.md)。</span><span class="sxs-lookup"><span data-stu-id="cf087-118">[Roadmap to Windows Installer Documentation](roadmap-to-windows-installer-documentation.md).</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| <span data-ttu-id="cf087-119">1.3 應用程式應支援長檔名和 UNC 路徑</span><span class="sxs-lookup"><span data-stu-id="cf087-119">1.3 Application should support Long File Names and UNC paths</span></span><br/>                                                                                                     | <span data-ttu-id="cf087-120">安裝程式支援從 UNC 和磁片磁碟機網路進行安裝，並一律使用套件中提供的完整檔案名，但前提是已設定 [**SHORTFILENAMES**](shortfilenames.md) 屬性，或目標磁片區不支援長檔名。</span><span class="sxs-lookup"><span data-stu-id="cf087-120">The installer supports installing to and from both UNC and drive network and always uses the long file names provided in your package except if the [**SHORTFILENAMES**](shortfilenames.md) Property is set or if the target volume does not support long file names.</span></span> <span data-ttu-id="cf087-121">請參閱 [Filename](filename.md)、 [File Table](file-table.md)、 [Directory Table](directory-table.md)、 **SHORTFILENAMES** 屬性。</span><span class="sxs-lookup"><span data-stu-id="cf087-121">See [Filename](filename.md), [File Table](file-table.md), [Directory Table](directory-table.md), **SHORTFILENAMES** Property.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| <span data-ttu-id="cf087-122">1.5 應用程式不應讀取或寫入 Win.ini、System.ini、Autoexec.bat 或 Config.sys。</span><span class="sxs-lookup"><span data-stu-id="cf087-122">1.5 The application should not read from or write to Win.ini, System.ini, Autoexec.bat or Config.sys.</span></span><br/>                                                            | <span data-ttu-id="cf087-123">您的安裝程式應該將專案新增至登錄， *而不* 是 Win.ini、System.ini、Autoexec.bat 或 Config.sys。</span><span class="sxs-lookup"><span data-stu-id="cf087-123">Your installation program should add entries to the registry *not* to the Win.ini, System.ini, Autoexec.bat or Config.sys.</span></span> <span data-ttu-id="cf087-124">Windows Installer 支援登錄中的資訊金鑰。</span><span class="sxs-lookup"><span data-stu-id="cf087-124">Windows Installer supports informational keys in the registry.</span></span> <span data-ttu-id="cf087-125">當您的應用程式使用安裝程式時，這些登錄機碼會變成可作為安裝程式屬性。</span><span class="sxs-lookup"><span data-stu-id="cf087-125">When your application uses the installer, these registry keys become available as installer properties.</span></span> <span data-ttu-id="cf087-126">您可以撰寫應用程式的套件，讓您很容易就能檢查和設定這些機碼的值。</span><span class="sxs-lookup"><span data-stu-id="cf087-126">You can author the package for your application such that it is easy to check and set the values of these keys.</span></span> <span data-ttu-id="cf087-127">如果您的應用程式使用不想放入登錄中的資訊，請建立私用初始化檔，並將它放在應用程式的可執行檔所在的目錄中。</span><span class="sxs-lookup"><span data-stu-id="cf087-127">If your application uses information that you do not want to put in the registry, create a private initialization file and place it in the directory with the application's executable files.</span></span> <span data-ttu-id="cf087-128">您可以使用 Windows Installer 安裝您的應用程式，輕鬆地管理私用 .ini 檔案的安裝，以及新增或移除現有 .ini 檔案的資訊。</span><span class="sxs-lookup"><span data-stu-id="cf087-128">You can easily manage the installation of a private .ini file, as well as add or remove information from existing .ini files, by using Windows Installer to install your application.</span></span> <span data-ttu-id="cf087-129">請 [參閱修改](modifying-the-registry.md)登錄、登錄 [資料表群組](registry-tables-group.md)、 [登錄資料表](registry-table.md)、 [RemoveRegistry 表](removeregistry-table.md)、 [WriteRegistryValues 動作](writeregistryvalues-action.md)、 [RemoveRegistryValues 動作](removeregistryvalues-action.md)、 [卸載](uninstall-registry-key.md)登錄機碼、 [屬性](properties.md)、檔案 [資料表](file-table.md)、 [目錄資料表](directory-table.md)、 [使用目錄資料表](using-the-directory-table.md)、 [IniFile 資料表](inifile-table.md)、 [RemoveIniFile 資料表](removeinifile-table.md)、 [IniLocator 資料表](inilocator-table.md)、 [WriteIniValues 動作](writeinivalues-action.md) 、 [RemoveIniValues 動作](removeinivalues-action.md)、 [RemoveIniFile 資料表](removeinifile-table.md)。</span><span class="sxs-lookup"><span data-stu-id="cf087-129">See [Modifying the Registry](modifying-the-registry.md), [Registry Tables Group](registry-tables-group.md), [Registry Table](registry-table.md), [RemoveRegistry Table](removeregistry-table.md), [WriteRegistryValues Action](writeregistryvalues-action.md), [RemoveRegistryValues Action](removeregistryvalues-action.md), [Uninstall Registry Key](uninstall-registry-key.md), [Properties](properties.md), [File Table](file-table.md), [Directory Table](directory-table.md), [Using the Directory Table](using-the-directory-table.md), [IniFile Table](inifile-table.md), [RemoveIniFile Table](removeinifile-table.md), [IniLocator Table](inilocator-table.md), [WriteIniValues Action](writeinivalues-action.md) , [RemoveIniValues Action](removeinivalues-action.md), [RemoveIniFile Table](removeinifile-table.md).</span></span><br/>                                                                                                                                                                                                                                                                         |
| <span data-ttu-id="cf087-130">1.7 應用程式應正確執行 Windows 版本檢查。</span><span class="sxs-lookup"><span data-stu-id="cf087-130">1.7 The application should perform Windows version checking correctly.</span></span><br/>                                                                                           | <span data-ttu-id="cf087-131">當您準備應用程式的安裝套件時，必須包含產品作業系統版本需求的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="cf087-131">When you prepare an installation package for your application, you must include information about the product's operating system version requirements.</span></span> <span data-ttu-id="cf087-132">初始化時，安裝程式會自動將特定的屬性設定為目前作業系統的版本。</span><span class="sxs-lookup"><span data-stu-id="cf087-132">On initialization, the installer automatically sets certain properties to the version of the current operating system.</span></span> <span data-ttu-id="cf087-133">您的安裝程式可以使用這些安裝程式屬性來提供簡單的版本檢查。</span><span class="sxs-lookup"><span data-stu-id="cf087-133">Your setup program can use these installer properties to provide easy version checking.</span></span> <span data-ttu-id="cf087-134">請參閱 [Properties](properties.md)、 [**Version9X**](version9x.md) 屬性 [**、VersionDatabase**](versiondatabase.md) 屬性 [**、VersionNT**](versionnt.md) 屬性、 [**WindowsBuild**](windowsbuild.md) 屬性、 [**ProductCode**](productcode.md) 屬性、 [**ProductName**](productname.md) 屬性、 [**ProductVersion**](productversion.md) 屬性、 [摘要資訊資料流程](summary-information-stream.md)、 [**修訂編號摘要**](revision-number-summary.md) 屬性。</span><span class="sxs-lookup"><span data-stu-id="cf087-134">See [Properties](properties.md), [**Version9X**](version9x.md) Property, [**VersionDatabase**](versiondatabase.md) Property, [**VersionNT**](versionnt.md) Property, [**WindowsBuild**](windowsbuild.md) Property, [**ProductCode**](productcode.md) Property, [**ProductName**](productname.md) Property, [**ProductVersion**](productversion.md) Property, [Summary Information Stream](summary-information-stream.md), [**Revision Number Summary**](revision-number-summary.md) Property.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| <span data-ttu-id="cf087-135">2.1 應用程式應使用通過驗證測試的 Windows Installer 套件進行安裝。</span><span class="sxs-lookup"><span data-stu-id="cf087-135">2.1 The application should install using a Windows Installer package that passes validation testing.</span></span><br/>                                                             | <span data-ttu-id="cf087-136">您可以使用一組稱為 [內部一致性評估](internal-consistency-evaluators-ices.md)工具的特定驗證規則，檢查您的安裝套件是否通過驗證測試。</span><span class="sxs-lookup"><span data-stu-id="cf087-136">You can check that your installation package passes validation testing by using a specific set of validation rules known as [Internal Consistency Evaluators - ICEs](internal-consistency-evaluators-ices.md).</span></span> <span data-ttu-id="cf087-137">這些 Ices-003 包含在檔案標誌中。</span><span class="sxs-lookup"><span data-stu-id="cf087-137">These ICEs are contained in the file Logo.cub.</span></span> <span data-ttu-id="cf087-138">若要符合認證資格，安裝套件在使用這些規則驗證時，不能產生任何錯誤。</span><span class="sxs-lookup"><span data-stu-id="cf087-138">To qualify for certification, an installation package must not produce any errors when validated using these rules.</span></span> <span data-ttu-id="cf087-139">警告是可接受的，但通常應該加以更正。</span><span class="sxs-lookup"><span data-stu-id="cf087-139">Warnings are acceptable, but generally should be corrected.</span></span> <span data-ttu-id="cf087-140">Windows Installer SDK 包含了 .cub、Darice 和 Mergemod 等標誌。</span><span class="sxs-lookup"><span data-stu-id="cf087-140">The Windows Installer SDK includes the Logo.cub, Darice.cub, and Mergemod.cub files.</span></span> <span data-ttu-id="cf087-141">標誌中的 Ices-003 會包含在 Darice 的 .cub 檔案中。</span><span class="sxs-lookup"><span data-stu-id="cf087-141">The ICEs in the Logo.cub file are included in the Darice.cub file.</span></span> <span data-ttu-id="cf087-142">如果您的套件使用 Darice 傳遞驗證，它就會以 .cub 來傳遞。</span><span class="sxs-lookup"><span data-stu-id="cf087-142">If your package passes validation using Darice.cub, it will pass with Logo.cub.</span></span> <span data-ttu-id="cf087-143">如需詳細資訊，請參閱 [封裝驗證](package-validation.md)。</span><span class="sxs-lookup"><span data-stu-id="cf087-143">For more information, see [Package Validation](package-validation.md).</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| <span data-ttu-id="cf087-144">2.2 用來安裝應用程式的安裝套件應遵循建立元件的規則。</span><span class="sxs-lookup"><span data-stu-id="cf087-144">2.2 The installation package used to install the application should follow the rules for creating components.</span></span><br/>                                                    | <span data-ttu-id="cf087-145">安裝程式元件是應用程式的一部分，一律安裝或移除為一個片段。</span><span class="sxs-lookup"><span data-stu-id="cf087-145">An installer component is a part of an application that is always installed or removed as one piece.</span></span> <span data-ttu-id="cf087-146">有一組規則可協助您決定如何以最佳方式將應用程式分割成元件。</span><span class="sxs-lookup"><span data-stu-id="cf087-146">There is a set of rules to help you decide how best to divide your application into components.</span></span> <span data-ttu-id="cf087-147">如果安裝套件中的元件已正確定義，安裝程式可以安全地安裝和移除它們。</span><span class="sxs-lookup"><span data-stu-id="cf087-147">If the components in your installation package are correctly defined, the installer can install and remove them safely.</span></span> <span data-ttu-id="cf087-148">請參閱將 [應用程式組織成元件](organizing-applications-into-components.md)、 [元件和功能](components-and-features.md)、 [變更元件程式碼](changing-the-component-code.md)、 [元件規則中斷時，會發生什麼事？](what-happens-if-the-component-rules-are-broken.md)、 [使用功能和元件](working-with-features-and-components.md)、 [元件表格](component-table.md)。</span><span class="sxs-lookup"><span data-stu-id="cf087-148">See [Organizing Applications into Components](organizing-applications-into-components.md), [Components and Features](components-and-features.md), [Changing the Component Code](changing-the-component-code.md), [What happens if the component rules are broken?](what-happens-if-the-component-rules-are-broken.md), [Working with Features and Components](working-with-features-and-components.md), [Component Table](component-table.md).</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| <span data-ttu-id="cf087-149">2.3 應用程式的安裝套件應該識別共用元件。</span><span class="sxs-lookup"><span data-stu-id="cf087-149">2.3 The application's installation package should identify shared components.</span></span><br/>                                                                                    | <span data-ttu-id="cf087-150">如果您提供安裝套件，將應用程式正確地組織成元件，並在元件資料表中設定 **msidbComponentAttributesSharedDllRefCount** ，Windows Installer 可以使用元件金鑰檔之共用 DLL 登錄中的參考計數來追蹤共用元件。</span><span class="sxs-lookup"><span data-stu-id="cf087-150">If you provide an installation package that correctly organizes your application into components, and set **msidbComponentAttributesSharedDllRefCount** in the Component table, Windows Installer can track shared components using the reference count in the shared DLL registry of the component's key file.</span></span> <span data-ttu-id="cf087-151">如果您未使用安裝程式，則您的應用程式必須藉由遞增 Shareddll 登錄機碼中 DLL 的使用方式計數器，來追蹤其共用 Dll 的使用情形。</span><span class="sxs-lookup"><span data-stu-id="cf087-151">If you do not use the installer, then your application must keep track of its use of shared DLLs by incrementing a usage counter for the DLL in the SharedDLLs registry key.</span></span> <span data-ttu-id="cf087-152">如需詳細資訊，請參閱 [目錄](directory-table.md)資料表（ [使用目錄資料表](using-the-directory-table.md)、 [元件資料表](component-table.md)）。</span><span class="sxs-lookup"><span data-stu-id="cf087-152">For more information, see [Directory Table](directory-table.md), [Using the Directory Table](using-the-directory-table.md), [Component Table](component-table.md).</span></span> <span data-ttu-id="cf087-153">如需 SharedDllRefCount 位的討論，請參閱 [元件資料表](component-table.md)、將 [應用程式組織為元件](organizing-applications-into-components.md)。</span><span class="sxs-lookup"><span data-stu-id="cf087-153">For the discussion of the SharedDllRefCount bit, see [Component Table](component-table.md), [Organizing Applications into Components](organizing-applications-into-components.md).</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| <span data-ttu-id="cf087-154">2.4 應用程式預設應該安裝至 Program Files 資料夾。</span><span class="sxs-lookup"><span data-stu-id="cf087-154">2.4 The application should install to the Program Files folder by default.</span></span><br/>                                                                                       | <span data-ttu-id="cf087-155">初始化時，安裝程式會將屬性設定為 [Program Files] 資料夾的完整路徑。</span><span class="sxs-lookup"><span data-stu-id="cf087-155">On initialization, the installer sets a property to the full path of the Program Files folder.</span></span> <span data-ttu-id="cf087-156">當您準備安裝套件時，可以指定安裝程式依預設會將您的應用程式安裝到此資料夾。</span><span class="sxs-lookup"><span data-stu-id="cf087-156">When you prepare the installation package you can specify that the installer install your application to this folder by default.</span></span> <span data-ttu-id="cf087-157">如果您也在封裝中包含 UI，安裝程式可以提供使用者選取其他安裝位置的選項。</span><span class="sxs-lookup"><span data-stu-id="cf087-157">If you also include a UI in your package, the installer can provide users with an option to select another installation location.</span></span> <span data-ttu-id="cf087-158">如需詳細資訊，請參閱 [目錄資料表](directory-table.md)、 [使用目錄資料表](using-the-directory-table.md)、 [**TARGETDIR**](targetdir.md) 屬性、 [**MsiSetTargetPath**](/windows/desktop/api/Msiquery/nf-msiquery-msisettargetpatha)、 [屬性](properties.md)、 [**ProgramFilesFolder**](programfilesfolder.md) 屬性。</span><span class="sxs-lookup"><span data-stu-id="cf087-158">For more information, see [Directory Table](directory-table.md), [Using the Directory Table](using-the-directory-table.md), [**TARGETDIR**](targetdir.md) Property, [**MsiSetTargetPath**](/windows/desktop/api/Msiquery/nf-msiquery-msisettargetpatha), [Properties](properties.md), [**ProgramFilesFolder**](programfilesfolder.md) Property.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| <span data-ttu-id="cf087-159">2.5 應用程式應正確支援新增/移除程式檔。</span><span class="sxs-lookup"><span data-stu-id="cf087-159">2.5 The application should support Add/Remove Program Files properly.</span></span><br/>                                                                                            | <span data-ttu-id="cf087-160">您可以在應用程式的 Windows Installer 套件中設定特定安裝程式屬性的值，藉以提供主控台中的 [新增/移除程式] 所需的所有資訊。</span><span class="sxs-lookup"><span data-stu-id="cf087-160">You can supply all the information that is needed by Add/Remove Programs in the Control Panel by setting the values of certain installer properties in your application's Windows Installer package.</span></span> <span data-ttu-id="cf087-161">設定這些屬性會自動將對應的值寫入登錄中。</span><span class="sxs-lookup"><span data-stu-id="cf087-161">Setting these properties automatically writes the corresponding values into the registry.</span></span> <span data-ttu-id="cf087-162">請參閱 [屬性](properties.md)、 [必要屬性](required-properties.md)、 [**ProductName**](productname.md) 屬性、 [**ARPINSTALLLOCATION**](arpinstalllocation.md) 屬性、 [**製造商**](manufacturer.md) 屬性、 [**ProductVersion**](productversion.md) 屬性。</span><span class="sxs-lookup"><span data-stu-id="cf087-162">See [Properties](properties.md), [Required Properties](required-properties.md), [**ProductName**](productname.md) Property, [**ARPINSTALLLOCATION**](arpinstalllocation.md) Property, [**Manufacturer**](manufacturer.md) Property, [**ProductVersion**](productversion.md) Property.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| <span data-ttu-id="cf087-163">2.6 應用程式應該確保 Windows Installer 套件支援廣告。</span><span class="sxs-lookup"><span data-stu-id="cf087-163">2.6 The application should ensure that Windows Installer package supports advertising.</span></span><br/>                                                                           | <span data-ttu-id="cf087-164">藉由組織您的應用程式以進行廣告，以及在應用程式的 Windows Installer 套件中包含廣告所需的所有資訊，來支援廣告。</span><span class="sxs-lookup"><span data-stu-id="cf087-164">Support advertising by organizing your application for advertising and by including all the information needed for advertisement in the application's Windows Installer package.</span></span> <span data-ttu-id="cf087-165">如需詳細資訊，請參閱 [公告](advertisement.md)、 [隨選安裝](installation-on-demand.md)、 [發佈產品、功能和元件](publishing-products-features-and-components.md)、 [廣告的平臺支援](platform-support-of-advertisement.md)、 [元件和功能](components-and-features.md)、建議的 [AdvtExecuteSequence](suggested-advtexecutesequence.md)、 [建議的 AdvtUISequence](suggested-advtuisequence.md)、 [**公告屬性**](advertise.md)、 [公告動作](advertise-action.md)、 [PublishProduct 動作](publishproduct-action.md)、 [功能資料表](feature-table.md)、 [快捷方式資料表](shortcut-table.md)、 [類別資料表](class-table.md)、 [延伸模組資料表](extension-table.md)、 [圖示資料表](icon-table.md)、 [MIME 資料表](mime-table.md)、 [ProgId 資料表](progid-table.md)、 [TypeLib 資料表](typelib-table.md)、 [動詞](verb-table.md)資料表、 [**MsiConfigureFeature**](/windows/desktop/api/Msi/nf-msi-msiconfigurefeaturea)、 [**MsiConfigureProduct**](/windows/desktop/api/Msi/nf-msi-msiconfigureproducta)。</span><span class="sxs-lookup"><span data-stu-id="cf087-165">For more information, see [Advertisement](advertisement.md), [Installation-On-Demand](installation-on-demand.md), [Publishing Products, Features, and Components](publishing-products-features-and-components.md), [Platform Support of Advertisement](platform-support-of-advertisement.md), [Components and Features](components-and-features.md), [Suggested AdvtExecuteSequence](suggested-advtexecutesequence.md), [Suggested AdvtUISequence](suggested-advtuisequence.md), [**Advertise Property**](advertise.md), [Advertise Action](advertise-action.md), [PublishProduct Action](publishproduct-action.md), [Feature Table](feature-table.md), [Shortcut Table](shortcut-table.md), [Class Table](class-table.md), [Extension Table](extension-table.md), [Icon Table](icon-table.md), [MIME Table](mime-table.md), [ProgId Table](progid-table.md), [TypeLib Table](typelib-table.md), [Verb Table](verb-table.md), [**MsiConfigureFeature**](/windows/desktop/api/Msi/nf-msi-msiconfigurefeaturea), [**MsiConfigureProduct**](/windows/desktop/api/Msi/nf-msi-msiconfigureproducta).</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| <span data-ttu-id="cf087-166">2.7 應用程式的安裝套件應確定正確的卸載支援。</span><span class="sxs-lookup"><span data-stu-id="cf087-166">2.7 The application's installation package should ensure correct uninstall support.</span></span><br/>                                                                              | <span data-ttu-id="cf087-167">如果您使用安裝程式來安裝應用程式，則不需要建立個別的卸載程式。</span><span class="sxs-lookup"><span data-stu-id="cf087-167">If you use the installer to install your application, you do not need to create a separate uninstaller.</span></span> <span data-ttu-id="cf087-168">您可以撰寫安裝套件，讓安裝程式安裝、卸載和修復您的應用程式。</span><span class="sxs-lookup"><span data-stu-id="cf087-168">You can author an installation package that enables the installer to install, uninstall, and repair your application.</span></span> <span data-ttu-id="cf087-169">請參閱 [Windows Installer 總覽](overview-of-windows-installer.md)、將 [應用程式組織為元件](organizing-applications-into-components.md)、 [標準動作](standard-actions.md)、 [標準動作](about-standard-actions.md)、 [使用標準動作](using-standard-actions.md)、 [標準動作參考](standard-actions-reference.md)、 [安裝應用程式](installing-an-application.md)、 [**MsiInstallProduct**](/windows/desktop/api/Msi/nf-msi-msiinstallproducta)、 [安裝動作](install-action.md)。</span><span class="sxs-lookup"><span data-stu-id="cf087-169">See [Overview of Windows Installer](overview-of-windows-installer.md), [Organizing Applications into Components](organizing-applications-into-components.md), [Standard Actions](standard-actions.md), [About Standard Actions](about-standard-actions.md), [Using Standard Actions](using-standard-actions.md), [Standard Actions Reference](standard-actions-reference.md), [Installing an Application](installing-an-application.md), [**MsiInstallProduct**](/windows/desktop/api/Msi/nf-msi-msiinstallproducta), [INSTALL Action](install-action.md).</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| <span data-ttu-id="cf087-170">3.1 在 Windows 2000 上，不會嘗試取代受 Windows 檔案保護保護的檔案。</span><span class="sxs-lookup"><span data-stu-id="cf087-170">3.1 On Windows 2000 do not attempt to replace files that are protected by Windows File Protection.</span></span><br/>                                                               | <span data-ttu-id="cf087-171">Windows Installer 在 Windows 2000 上安裝基本的系統檔案時，會遵守 Windows 檔案保護 (WFP) 。</span><span class="sxs-lookup"><span data-stu-id="cf087-171">Windows Installer adheres to Windows File Protection (WFP) when installing essential system files on Windows 2000.</span></span> <span data-ttu-id="cf087-172">Windows Installer 永遠不會嘗試安裝或取代受保護的檔案。</span><span class="sxs-lookup"><span data-stu-id="cf087-172">Windows Installer never attempts to install or replace a protected file.</span></span> <span data-ttu-id="cf087-173">如果應用程式的自動安裝修改了受保護的系統檔案，則 WFP 會將檔案還原至已驗證的檔案版本。</span><span class="sxs-lookup"><span data-stu-id="cf087-173">If a protected system file is modified by an unattended installation of an application, WFP restores the file to the verified file version.</span></span> <span data-ttu-id="cf087-174">如需詳細資訊，請參閱 [使用 Windows Installer 和 Windows 資源保護](windows-resource-protection-on-windows-vista.md)。</span><span class="sxs-lookup"><span data-stu-id="cf087-174">For more information, see [Using Windows Installer and Windows Resource Protection](windows-resource-protection-on-windows-vista.md).</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| <span data-ttu-id="cf087-175">3.2 作者撰寫新的可轉散發元件時，必須使用並存的共用技術，才能將其元件安裝至應用程式目錄。</span><span class="sxs-lookup"><span data-stu-id="cf087-175">3.2 Authors writing new redistributable components must use side-by-side sharing techniques so their components can be installed into the application directory.</span></span><br/> | <span data-ttu-id="cf087-176">Windows Installer 套件的作者可以指定安裝程式將共用檔案複製到應用程式的共用檔案 () 通常是應用程式的資料夾，而不是共用位置。</span><span class="sxs-lookup"><span data-stu-id="cf087-176">Authors of Windows Installer packages can specify that the installer copy the shared files (commonly shared DLLs) of an application into the application's folder rather than to a shared location.</span></span> <span data-ttu-id="cf087-177">只有應用程式才會使用這組私用的檔案 (Dll) 。</span><span class="sxs-lookup"><span data-stu-id="cf087-177">This private set of files (DLLs) are then used only by the application.</span></span> <span data-ttu-id="cf087-178">請參閱 [獨立元件](isolated-components.md)。</span><span class="sxs-lookup"><span data-stu-id="cf087-178">See [Isolated Components](isolated-components.md).</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| <span data-ttu-id="cf087-179">3.3 針對 Windows 2000 和 Windows 98 第二版，您的應用程式所依賴的任何並存 Dll 都必須安裝在您的應用程式目錄中：</span><span class="sxs-lookup"><span data-stu-id="cf087-179">3.3 For Windows 2000 and Windows 98 Second Edition, any side-by-side DLLs that your application depends on must be installed into your application directory:</span></span><br/>    | <span data-ttu-id="cf087-180">Windows Installer 套件的作者可以指定安裝程式將共用檔案複製到應用程式的共用檔案 () 通常是應用程式的資料夾，而不是共用位置。</span><span class="sxs-lookup"><span data-stu-id="cf087-180">Authors of Windows Installer packages can specify that the installer copy the shared files (commonly shared DLLs) of an application into the application's folder rather than to a shared location.</span></span> <span data-ttu-id="cf087-181">只有應用程式才會使用這組私用的檔案 (Dll) 。</span><span class="sxs-lookup"><span data-stu-id="cf087-181">This private set of files (DLLs) are then used only by the application.</span></span> <span data-ttu-id="cf087-182">請參閱 [隔離的元件](isolated-components.md) 或 [獨立元件的安裝](installation-of-isolated-components.md)。</span><span class="sxs-lookup"><span data-stu-id="cf087-182">See [Isolated Components](isolated-components.md) or [Installation of Isolated Components](installation-of-isolated-components.md).</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| <span data-ttu-id="cf087-183">4.3 如果拒絕存取，應用程式應該會正常地降級。</span><span class="sxs-lookup"><span data-stu-id="cf087-183">4.3 The application should degrade gracefully if access is denied.</span></span><br/>                                                                                               | <span data-ttu-id="cf087-184">這項需求的目標是要確保如果使用者被拒絕存取資源，應用程式會以維護安全環境的方式失敗。</span><span class="sxs-lookup"><span data-stu-id="cf087-184">The objective of this requirement is to ensure that if the user is denied access to resources, the application fails in a manner that maintains a secure environment.</span></span> <span data-ttu-id="cf087-185">Windows Installer 只會在安裝期間處理許可權。</span><span class="sxs-lookup"><span data-stu-id="cf087-185">Windows Installer handles privileges only during installation.</span></span> <span data-ttu-id="cf087-186">應用程式必須在執行時間處理許可權。</span><span class="sxs-lookup"><span data-stu-id="cf087-186">The application must handle privileges at run time.</span></span> <span data-ttu-id="cf087-187">安裝程式可以將初始化的特定屬性設定為使用者的許可權層級，或設定為系統原則所指定的層級。</span><span class="sxs-lookup"><span data-stu-id="cf087-187">The installer can set certain properties on initialization to the user's privilege level or to a level specified by System Policy.</span></span> <span data-ttu-id="cf087-188">然後，您可以撰寫 Windows Installer 套件，讓安裝程式先檢查使用者的存取權限，再開始安裝。</span><span class="sxs-lookup"><span data-stu-id="cf087-188">You can then author your Windows Installer package such that the installer checks the user's access privileges before installation begins.</span></span><br/> <span data-ttu-id="cf087-189">您可以撰寫安裝套件，讓安裝程式判斷是否有足夠的磁碟空間。</span><span class="sxs-lookup"><span data-stu-id="cf087-189">You can author the installation package so that the installer determines whether there is sufficient disk space.</span></span> <span data-ttu-id="cf087-190">如果您為應用程式套件撰寫 (UI) 的使用者介面，它可以向用盡磁碟空間的使用者顯示選項。</span><span class="sxs-lookup"><span data-stu-id="cf087-190">If you author a user interface (UI) for the application's package, it can display options to users that run out of disk space.</span></span><br/> <span data-ttu-id="cf087-191">如果安裝失敗，安裝程式可以切換到其復原模式，並自動還原電腦的原始狀態。</span><span class="sxs-lookup"><span data-stu-id="cf087-191">If the installation is unsuccessful, the installer can switch into its rollback mode and automatically restore the original state of the computer.</span></span><br/> <span data-ttu-id="cf087-192">如需詳細資訊，請參閱 [Windows Installer](overview-of-windows-installer.md)、 [復原](resiliency.md)、 [來源復原](source-resiliency.md)、具特殊 [**許可權的屬性**](privileged.md)、 [**AdminUser 屬性**](adminuser.md)、 [系統原則](system-policy.md)、 [InstallValidate 動作](installvalidate-action.md)、檔案 [成本](file-costing.md)、 [DiskCost 對話方塊](diskcost-dialog.md)、 [**OutOfDiskSpace 屬性**](outofdiskspace.md)、 [**OutOfNoRbDiskSpace 屬性**](outofnorbdiskspace.md)、 [AllocateRegistrySpace 動作](allocateregistryspace-action.md)、VolumeCostList [控制項](volumecostlist-control.md)、復原、 [安裝機制](installation-mechanism.md)、PROMPTROLLBACKCOST [**屬性**](promptrollbackcost.md)、 [**DISABLEROLLBACK 屬性**](disablerollback.md)、 [EnableRollback ControlEvent](enablerollback-controlevent.md)。</span><span class="sxs-lookup"><span data-stu-id="cf087-192">For more information, see [Overview of Windows Installer](overview-of-windows-installer.md), [Resiliency](resiliency.md), [Source Resiliency](source-resiliency.md), [**Privileged Property**](privileged.md), [**AdminUser Property**](adminuser.md), [System Policy](system-policy.md), [InstallValidate Action](installvalidate-action.md), [File Costing](file-costing.md), [DiskCost Dialog](diskcost-dialog.md), [**OutOfDiskSpace Property**](outofdiskspace.md), [**OutOfNoRbDiskSpace Property**](outofnorbdiskspace.md), [AllocateRegistrySpace Action](allocateregistryspace-action.md), [VolumeCostList Control](volumecostlist-control.md), Rollback, [Installation Mechanism](installation-mechanism.md), [**PROMPTROLLBACKCOST Property**](promptrollbackcost.md), [**DISABLEROLLBACK Property**](disablerollback.md), [EnableRollback ControlEvent](enablerollback-controlevent.md).</span></span><br/> |
| <span data-ttu-id="cf087-193">4.5 應用程式應該遵守系統層級的群組原則設定。</span><span class="sxs-lookup"><span data-stu-id="cf087-193">4.5 The application should adhere to system-level Group Policy settings.</span></span><br/>                                                                                         | <span data-ttu-id="cf087-194">Windows Installer 可以遵循與安裝相關的原則。</span><span class="sxs-lookup"><span data-stu-id="cf087-194">Windows Installer can follow policies pertaining to installation.</span></span> <span data-ttu-id="cf087-195">如需詳細資訊，請參閱 [系統原則](system-policy.md)。</span><span class="sxs-lookup"><span data-stu-id="cf087-195">For more information, see [System Policy](system-policy.md).</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| <span data-ttu-id="cf087-196">7.1 應用程式應該在升級至 Microsoft Windows 2000 Professional 之後繼續運作，而不需要重新安裝</span><span class="sxs-lookup"><span data-stu-id="cf087-196">7.1 Applications should continue to function after upgrade to Microsoft Windows 2000 Professional without reinstall</span></span><br/>                                              | <span data-ttu-id="cf087-197">安裝程式具有元件屬性，可協助您準備應用程式以遷移至 Windows 2000。</span><span class="sxs-lookup"><span data-stu-id="cf087-197">The installer has a component attribute that can facilitate preparation of your application for migration to Windows 2000.</span></span> <span data-ttu-id="cf087-198">如需詳細資訊，請參閱 [使用可轉移的元件](using-transitive-components.md)。</span><span class="sxs-lookup"><span data-stu-id="cf087-198">For more information, see [Using Transitive Components](using-transitive-components.md).</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |



 

 

 




