---
description: 「經 Microsoft Windows 認證」標誌會識別經過獨立測試驗證的產品，以符合 Windows 的應用程式規格。
ms.assetid: d33efb75-1813-40a5-8846-8799e16b368d
title: Windows Installer 和標誌需求
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 7bf86b31442676c358736250e0a2b602488dc852
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/08/2021
ms.locfileid: "104027444"
---
# <a name="windows-installer-and-logo-requirements"></a>Windows Installer 和標誌需求

「經 Microsoft Windows 認證」標誌會識別經過獨立測試驗證的產品，以符合 Windows 的應用程式規格。 此規格是由 Microsoft 與客戶和其他開發人員共同合作，以提供藍圖來建立可靠且可管理的應用程式。 符合規格的軟體供應商符合認證的 Microsoft Windows 標誌資格，然後再授權標誌，以用於產品包裝、廣告、附屬品和其他行銷教材。

如需適用于您應用程式的 Windows Vista、Windows XP 及 Windows Server 2008 認證的詳細資訊，請參閱 [Microsoft 合作夥伴網路]( https://partner.microsoft.com)。

如需有關應用程式的 Windows Server 2003 和 Windows 2000 認證的詳細資訊，請參閱 [https://msdn.microsoft.com/certification](https://www.microsoft.com/windowsserver2003/partners/isvs/cfw.mspx) 。

如果您要為應用程式撰寫安裝套件，您可以利用 Microsoft Windows Installer 的功能，以協助滿足幾項認證需求。 下表提供與某些認證需求相關 Windows Installer 檔中的資訊連結。 請注意，在應用程式規格中所討論的憑證不是每個需求都取決於 Windows Installer。



| 認證的需求                                                                                                                                               | 請參閱下列各節                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 1.1 應用程式應該執行主要功能並維持穩定性。<br/>                                                                                     | 如果您提供安裝套件，您的應用程式可以使用所有32位 Windows 平臺上可用的安裝程式服務。 使用安裝程式可以改善應用程式的功能和穩定性。 請參閱[Windows Installer 的](overview-of-windows-installer.md)[復原](resiliency.md)總覽<br/> [Windows Installer 檔的藍圖](roadmap-to-windows-installer-documentation.md)。<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| 1.3 應用程式應支援長檔名和 UNC 路徑<br/>                                                                                                     | 安裝程式支援從 UNC 和磁片磁碟機網路進行安裝，並一律使用套件中提供的完整檔案名，但前提是已設定 [**SHORTFILENAMES**](shortfilenames.md) 屬性，或目標磁片區不支援長檔名。 請參閱 [Filename](filename.md)、 [File Table](file-table.md)、 [Directory Table](directory-table.md)、 **SHORTFILENAMES** 屬性。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| 1.5 應用程式不應讀取或寫入 Win.ini、System.ini、Autoexec.bat 或 Config.sys。<br/>                                                            | 您的安裝程式應該將專案新增至登錄， *而不* 是 Win.ini、System.ini、Autoexec.bat 或 Config.sys。 Windows Installer 支援登錄中的資訊金鑰。 當您的應用程式使用安裝程式時，這些登錄機碼會變成可作為安裝程式屬性。 您可以撰寫應用程式的套件，讓您很容易就能檢查和設定這些機碼的值。 如果您的應用程式使用不想放入登錄中的資訊，請建立私用初始化檔，並將它放在應用程式的可執行檔所在的目錄中。 您可以使用 Windows Installer 安裝您的應用程式，輕鬆地管理私用 .ini 檔案的安裝，以及新增或移除現有 .ini 檔案的資訊。 請 [參閱修改](modifying-the-registry.md)登錄、登錄 [資料表群組](registry-tables-group.md)、 [登錄資料表](registry-table.md)、 [RemoveRegistry 表](removeregistry-table.md)、 [WriteRegistryValues 動作](writeregistryvalues-action.md)、 [RemoveRegistryValues 動作](removeregistryvalues-action.md)、 [卸載](uninstall-registry-key.md)登錄機碼、 [屬性](properties.md)、檔案 [資料表](file-table.md)、 [目錄資料表](directory-table.md)、 [使用目錄資料表](using-the-directory-table.md)、 [IniFile 資料表](inifile-table.md)、 [RemoveIniFile 資料表](removeinifile-table.md)、 [IniLocator 資料表](inilocator-table.md)、 [WriteIniValues 動作](writeinivalues-action.md) 、 [RemoveIniValues 動作](removeinivalues-action.md)、 [RemoveIniFile 資料表](removeinifile-table.md)。<br/>                                                                                                                                                                                                                                                                         |
| 1.7 應用程式應正確執行 Windows 版本檢查。<br/>                                                                                           | 當您準備應用程式的安裝套件時，必須包含產品作業系統版本需求的相關資訊。 初始化時，安裝程式會自動將特定的屬性設定為目前作業系統的版本。 您的安裝程式可以使用這些安裝程式屬性來提供簡單的版本檢查。 請參閱 [Properties](properties.md)、 [**Version9X**](version9x.md) 屬性 [**、VersionDatabase**](versiondatabase.md) 屬性 [**、VersionNT**](versionnt.md) 屬性、 [**WindowsBuild**](windowsbuild.md) 屬性、 [**ProductCode**](productcode.md) 屬性、 [**ProductName**](productname.md) 屬性、 [**ProductVersion**](productversion.md) 屬性、 [摘要資訊資料流程](summary-information-stream.md)、 [**修訂編號摘要**](revision-number-summary.md) 屬性。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| 2.1 應用程式應使用通過驗證測試的 Windows Installer 套件進行安裝。<br/>                                                             | 您可以使用一組稱為 [內部一致性評估](internal-consistency-evaluators-ices.md)工具的特定驗證規則，檢查您的安裝套件是否通過驗證測試。 這些 Ices-003 包含在檔案標誌中。 若要符合認證資格，安裝套件在使用這些規則驗證時，不能產生任何錯誤。 警告是可接受的，但通常應該加以更正。 Windows Installer SDK 包含了 .cub、Darice 和 Mergemod 等標誌。 標誌中的 Ices-003 會包含在 Darice 的 .cub 檔案中。 如果您的套件使用 Darice 傳遞驗證，它就會以 .cub 來傳遞。 如需詳細資訊，請參閱 [封裝驗證](package-validation.md)。<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| 2.2 用來安裝應用程式的安裝套件應遵循建立元件的規則。<br/>                                                    | 安裝程式元件是應用程式的一部分，一律安裝或移除為一個片段。 有一組規則可協助您決定如何以最佳方式將應用程式分割成元件。 如果安裝套件中的元件已正確定義，安裝程式可以安全地安裝和移除它們。 請參閱將 [應用程式組織成元件](organizing-applications-into-components.md)、 [元件和功能](components-and-features.md)、 [變更元件程式碼](changing-the-component-code.md)、 [元件規則中斷時，會發生什麼事？](what-happens-if-the-component-rules-are-broken.md)、 [使用功能和元件](working-with-features-and-components.md)、 [元件表格](component-table.md)。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| 2.3 應用程式的安裝套件應該識別共用元件。<br/>                                                                                    | 如果您提供安裝套件，將應用程式正確地組織成元件，並在元件資料表中設定 **msidbComponentAttributesSharedDllRefCount** ，Windows Installer 可以使用元件金鑰檔之共用 DLL 登錄中的參考計數來追蹤共用元件。 如果您未使用安裝程式，則您的應用程式必須藉由遞增 Shareddll 登錄機碼中 DLL 的使用方式計數器，來追蹤其共用 Dll 的使用情形。 如需詳細資訊，請參閱 [目錄](directory-table.md)資料表（ [使用目錄資料表](using-the-directory-table.md)、 [元件資料表](component-table.md)）。 如需 SharedDllRefCount 位的討論，請參閱 [元件資料表](component-table.md)、將 [應用程式組織為元件](organizing-applications-into-components.md)。<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| 2.4 應用程式預設應該安裝至 Program Files 資料夾。<br/>                                                                                       | 初始化時，安裝程式會將屬性設定為 [Program Files] 資料夾的完整路徑。 當您準備安裝套件時，可以指定安裝程式依預設會將您的應用程式安裝到此資料夾。 如果您也在封裝中包含 UI，安裝程式可以提供使用者選取其他安裝位置的選項。 如需詳細資訊，請參閱 [目錄資料表](directory-table.md)、 [使用目錄資料表](using-the-directory-table.md)、 [**TARGETDIR**](targetdir.md) 屬性、 [**MsiSetTargetPath**](/windows/desktop/api/Msiquery/nf-msiquery-msisettargetpatha)、 [屬性](properties.md)、 [**ProgramFilesFolder**](programfilesfolder.md) 屬性。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| 2.5 應用程式應正確支援新增/移除程式檔。<br/>                                                                                            | 您可以在應用程式的 Windows Installer 套件中設定特定安裝程式屬性的值，藉以提供主控台中的 [新增/移除程式] 所需的所有資訊。 設定這些屬性會自動將對應的值寫入登錄中。 請參閱 [屬性](properties.md)、 [必要屬性](required-properties.md)、 [**ProductName**](productname.md) 屬性、 [**ARPINSTALLLOCATION**](arpinstalllocation.md) 屬性、 [**製造商**](manufacturer.md) 屬性、 [**ProductVersion**](productversion.md) 屬性。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| 2.6 應用程式應該確保 Windows Installer 套件支援廣告。<br/>                                                                           | 藉由組織您的應用程式以進行廣告，以及在應用程式的 Windows Installer 套件中包含廣告所需的所有資訊，來支援廣告。 如需詳細資訊，請參閱 [公告](advertisement.md)、 [隨選安裝](installation-on-demand.md)、 [發佈產品、功能和元件](publishing-products-features-and-components.md)、 [廣告的平臺支援](platform-support-of-advertisement.md)、 [元件和功能](components-and-features.md)、建議的 [AdvtExecuteSequence](suggested-advtexecutesequence.md)、 [建議的 AdvtUISequence](suggested-advtuisequence.md)、 [**公告屬性**](advertise.md)、 [公告動作](advertise-action.md)、 [PublishProduct 動作](publishproduct-action.md)、 [功能資料表](feature-table.md)、 [快捷方式資料表](shortcut-table.md)、 [類別資料表](class-table.md)、 [延伸模組資料表](extension-table.md)、 [圖示資料表](icon-table.md)、 [MIME 資料表](mime-table.md)、 [ProgId 資料表](progid-table.md)、 [TypeLib 資料表](typelib-table.md)、 [動詞](verb-table.md)資料表、 [**MsiConfigureFeature**](/windows/desktop/api/Msi/nf-msi-msiconfigurefeaturea)、 [**MsiConfigureProduct**](/windows/desktop/api/Msi/nf-msi-msiconfigureproducta)。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| 2.7 應用程式的安裝套件應確定正確的卸載支援。<br/>                                                                              | 如果您使用安裝程式來安裝應用程式，則不需要建立個別的卸載程式。 您可以撰寫安裝套件，讓安裝程式安裝、卸載和修復您的應用程式。 請參閱 [Windows Installer 總覽](overview-of-windows-installer.md)、將 [應用程式組織為元件](organizing-applications-into-components.md)、 [標準動作](standard-actions.md)、 [標準動作](about-standard-actions.md)、 [使用標準動作](using-standard-actions.md)、 [標準動作參考](standard-actions-reference.md)、 [安裝應用程式](installing-an-application.md)、 [**MsiInstallProduct**](/windows/desktop/api/Msi/nf-msi-msiinstallproducta)、 [安裝動作](install-action.md)。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| 3.1 在 Windows 2000 上，不會嘗試取代受 Windows 檔案保護保護的檔案。<br/>                                                               | Windows Installer 在 Windows 2000 上安裝基本的系統檔案時，會遵守 Windows 檔案保護 (WFP) 。 Windows Installer 永遠不會嘗試安裝或取代受保護的檔案。 如果應用程式的自動安裝修改了受保護的系統檔案，則 WFP 會將檔案還原至已驗證的檔案版本。 如需詳細資訊，請參閱 [使用 Windows Installer 和 Windows 資源保護](windows-resource-protection-on-windows-vista.md)。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| 3.2 作者撰寫新的可轉散發元件時，必須使用並存的共用技術，才能將其元件安裝至應用程式目錄。<br/> | Windows Installer 套件的作者可以指定安裝程式將共用檔案複製到應用程式的共用檔案 () 通常是應用程式的資料夾，而不是共用位置。 只有應用程式才會使用這組私用的檔案 (Dll) 。 請參閱 [獨立元件](isolated-components.md)。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| 3.3 針對 Windows 2000 和 Windows 98 第二版，您的應用程式所依賴的任何並存 Dll 都必須安裝在您的應用程式目錄中：<br/>    | Windows Installer 套件的作者可以指定安裝程式將共用檔案複製到應用程式的共用檔案 () 通常是應用程式的資料夾，而不是共用位置。 只有應用程式才會使用這組私用的檔案 (Dll) 。 請參閱 [隔離的元件](isolated-components.md) 或 [獨立元件的安裝](installation-of-isolated-components.md)。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| 4.3 如果拒絕存取，應用程式應該會正常地降級。<br/>                                                                                               | 這項需求的目標是要確保如果使用者被拒絕存取資源，應用程式會以維護安全環境的方式失敗。 Windows Installer 只會在安裝期間處理許可權。 應用程式必須在執行時間處理許可權。 安裝程式可以將初始化的特定屬性設定為使用者的許可權層級，或設定為系統原則所指定的層級。 然後，您可以撰寫 Windows Installer 套件，讓安裝程式先檢查使用者的存取權限，再開始安裝。<br/> 您可以撰寫安裝套件，讓安裝程式判斷是否有足夠的磁碟空間。 如果您為應用程式套件撰寫 (UI) 的使用者介面，它可以向用盡磁碟空間的使用者顯示選項。<br/> 如果安裝失敗，安裝程式可以切換到其復原模式，並自動還原電腦的原始狀態。<br/> 如需詳細資訊，請參閱 [Windows Installer](overview-of-windows-installer.md)、 [復原](resiliency.md)、 [來源復原](source-resiliency.md)、具特殊 [**許可權的屬性**](privileged.md)、 [**AdminUser 屬性**](adminuser.md)、 [系統原則](system-policy.md)、 [InstallValidate 動作](installvalidate-action.md)、檔案 [成本](file-costing.md)、 [DiskCost 對話方塊](diskcost-dialog.md)、 [**OutOfDiskSpace 屬性**](outofdiskspace.md)、 [**OutOfNoRbDiskSpace 屬性**](outofnorbdiskspace.md)、 [AllocateRegistrySpace 動作](allocateregistryspace-action.md)、VolumeCostList [控制項](volumecostlist-control.md)、復原、 [安裝機制](installation-mechanism.md)、PROMPTROLLBACKCOST [**屬性**](promptrollbackcost.md)、 [**DISABLEROLLBACK 屬性**](disablerollback.md)、 [EnableRollback ControlEvent](enablerollback-controlevent.md)。<br/> |
| 4.5 應用程式應該遵守系統層級的群組原則設定。<br/>                                                                                         | Windows Installer 可以遵循與安裝相關的原則。 如需詳細資訊，請參閱 [系統原則](system-policy.md)。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| 7.1 應用程式應該在升級至 Microsoft Windows 2000 Professional 之後繼續運作，而不需要重新安裝<br/>                                              | 安裝程式具有元件屬性，可協助您準備應用程式以遷移至 Windows 2000。 如需詳細資訊，請參閱 [使用可轉移的元件](using-transitive-components.md)。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |



 

 

 




