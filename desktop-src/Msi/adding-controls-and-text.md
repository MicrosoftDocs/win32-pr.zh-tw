---
description: 放在對話方塊和公告欄上的控制項和文字，可讓使用者與安裝程式互動。
ms.assetid: 2c6204c7-535d-4dda-8394-723ddbf46b96
title: 加入控制項和文字
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 706d071741d742205d0df2b19c4416acf355fd7f
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/07/2021
ms.locfileid: "106979107"
---
# <a name="adding-controls-and-text"></a><span data-ttu-id="d8974-103">加入控制項和文字</span><span class="sxs-lookup"><span data-stu-id="d8974-103">Adding Controls and Text</span></span>

<span data-ttu-id="d8974-104">放在對話方塊和公告欄上的控制項和文字，可讓使用者與安裝程式互動。</span><span class="sxs-lookup"><span data-stu-id="d8974-104">Controls and text placed on dialog boxes and billboards enable the user to interact with the installation process.</span></span> <span data-ttu-id="d8974-105">將對話方塊加入至 [對話方塊資料表](dialog-table.md) 中，將它加入至使用者介面，如 [使用消費者介面](using-the-user-interface.md)所述。</span><span class="sxs-lookup"><span data-stu-id="d8974-105">Add a dialog box to the user interface by including it in the [Dialog table](dialog-table.md) as described in [Using the User Interface](using-the-user-interface.md).</span></span> <span data-ttu-id="d8974-106">填入 [控制項資料表](control-table.md) 和 [BBControl 資料表](bbcontrol-table.md)，以填滿對話方塊並公告欄控制項。</span><span class="sxs-lookup"><span data-stu-id="d8974-106">Fill dialog boxes and billboards with controls by populating the [Control table](control-table.md) and [BBControl table](bbcontrol-table.md), respectively.</span></span>

<span data-ttu-id="d8974-107">控制項的初始屬性可以在 [控制資料表](control-table.md)的 [屬性] 資料行中指定。</span><span class="sxs-lookup"><span data-stu-id="d8974-107">The initial attributes of control can be specified in the Attributes column of the [Control table](control-table.md).</span></span> <span data-ttu-id="d8974-108">請參閱 [控制項屬性](control-attributes.md)。</span><span class="sxs-lookup"><span data-stu-id="d8974-108">See [Control Attributes](control-attributes.md).</span></span>

<span data-ttu-id="d8974-109">若要讓控制項屬性相依于條件，請使用 [ControlCondition 資料表](controlcondition-table.md) 來根據屬性或條件陳述式的值來停用、啟用、隱藏或顯示控制項。</span><span class="sxs-lookup"><span data-stu-id="d8974-109">To make control attributes dependent upon a condition, use the [ControlCondition table](controlcondition-table.md) to disable, enable, hide, or show a control according to the value of a property or conditional statement.</span></span> <span data-ttu-id="d8974-110">您也可以使用此資料表來覆寫在 [對話方塊資料表](dialog-table.md)中輸入之預設控制項的規格。</span><span class="sxs-lookup"><span data-stu-id="d8974-110">You can also use this table to override the specification of the default control entered into the [Dialog table](dialog-table.md).</span></span>

<span data-ttu-id="d8974-111">若要讓事件變更控制項屬性，請將控制項訂閱至 [EventMapping 資料表](eventmapping-table.md)中的 ControlEvent。</span><span class="sxs-lookup"><span data-stu-id="d8974-111">To have an event change a control attribute, subscribe the control to a ControlEvent in the [EventMapping table](eventmapping-table.md).</span></span> <span data-ttu-id="d8974-112">ControlEvent 指定安裝程式所要採取的動作，或對話方塊中一或多個控制項的屬性變更。</span><span class="sxs-lookup"><span data-stu-id="d8974-112">A ControlEvent specifies an action to be taken by the installer or a change in the attributes of one or more controls in the dialog box.</span></span> <span data-ttu-id="d8974-113">請參閱 [ControlEvent 總覽](controlevent-overview.md)。</span><span class="sxs-lookup"><span data-stu-id="d8974-113">See [ControlEvent Overview](controlevent-overview.md).</span></span> <span data-ttu-id="d8974-114">在 [屬性] 資料行中輸入屬性的識別碼，並在 [EventMapping 資料表](eventmapping-table.md)的事件資料行中輸入 ControlEvent 的識別碼。</span><span class="sxs-lookup"><span data-stu-id="d8974-114">Enter the attribute's identifier in the Attribute column and the ControlEvent's identifier in the Event column of the [EventMapping table](eventmapping-table.md).</span></span>

<span data-ttu-id="d8974-115">某些控制項有助於收集使用者的資訊。</span><span class="sxs-lookup"><span data-stu-id="d8974-115">Some controls facilitate the collection of information from the user.</span></span> <span data-ttu-id="d8974-116">例如，核取方塊可讓使用者設定屬性的值。</span><span class="sxs-lookup"><span data-stu-id="d8974-116">For example, a check box enables the user to set the value of a property.</span></span> <span data-ttu-id="d8974-117">請參閱 [核取方塊](checkbox-table.md)資料表、 [ComboBox](combobox-table.md)資料表、 [ListBox 資料表](listbox-table.md)、 [選項按鈕資料表](radiobutton-table.md)和 [ListView 資料表](listview-table.md)。</span><span class="sxs-lookup"><span data-stu-id="d8974-117">See the [CheckBox table](checkbox-table.md), the [ComboBox table](combobox-table.md), the [ListBox table](listbox-table.md), the [RadioButton table](radiobutton-table.md), and the [ListView table](listview-table.md).</span></span>

<span data-ttu-id="d8974-118">請注意，基於安全性考慮，使用者與使用者介面互動時，無法變更私用屬性。</span><span class="sxs-lookup"><span data-stu-id="d8974-118">Note that for security reasons, private properties cannot be changed by the user interacting with the user interface.</span></span> <span data-ttu-id="d8974-119">如果屬性是由使用者介面設定，它就必須是公用屬性，而且在全部大寫的情況下都必須有名稱。</span><span class="sxs-lookup"><span data-stu-id="d8974-119">If a property is to be set by the user interface it needs to be a public property and have a name in all upper case.</span></span> <span data-ttu-id="d8974-120">請參閱 [關於屬性](about-properties.md)。</span><span class="sxs-lookup"><span data-stu-id="d8974-120">See [About Properties](about-properties.md).</span></span>

<span data-ttu-id="d8974-121">您可以藉由填入 [ActionText 資料表](actiontext-table.md)，讓對話方塊顯示資訊給使用者，或將其寫入至記錄以回應安裝動作。</span><span class="sxs-lookup"><span data-stu-id="d8974-121">You can either make your dialog box present information to the user or write it to a log in response to installation actions by filling in the [ActionText table](actiontext-table.md).</span></span>

<span data-ttu-id="d8974-122">控制項可以有預先定義的字型樣式。</span><span class="sxs-lookup"><span data-stu-id="d8974-122">Controls can have a predefined font style.</span></span> <span data-ttu-id="d8974-123">若要設定文字字串的字型與字型樣式，請在顯示的字元字串前面加上 { \\ style} 或 {&*style*}。</span><span class="sxs-lookup"><span data-stu-id="d8974-123">To set the font and font style of a text string, prefix the string of displayed characters with {\\style} or {&*style*}.</span></span> <span data-ttu-id="d8974-124">其中 style 是在 [資料行] 資料表的 [樣式 [表單](textstyle-table.md)] 資料行中所列的識別碼。</span><span class="sxs-lookup"><span data-stu-id="d8974-124">Where style is an identifier listed in the TextStyle column of the [TextStyle table](textstyle-table.md).</span></span> <span data-ttu-id="d8974-125">如果這兩個都不存在，但 [**DefaultUIFont**](defaultuifont.md) 屬性定義為有效的文字樣式，則會使用該字型。</span><span class="sxs-lookup"><span data-stu-id="d8974-125">If neither of these are present, but the [**DefaultUIFont**](defaultuifont.md) property is defined as a valid text style, that font will be used.</span></span>

<span data-ttu-id="d8974-126">建議您在 [屬性工作表](property-table.md)中，將每個安裝封裝的 [**DefaultUIFont**](defaultuifont.md)屬性設定為 [[樣式](textstyle-table.md)表單] 中所列的其中一個預先定義樣式。</span><span class="sxs-lookup"><span data-stu-id="d8974-126">It is recommended that the [**DefaultUIFont**](defaultuifont.md) property of every installation package with a UI be set in the [Property table](property-table.md) to one of the predefined styles listed in the [TextStyle table](textstyle-table.md).</span></span> <span data-ttu-id="d8974-127">如果未指定這個屬性，安裝程式會使用系統字型。</span><span class="sxs-lookup"><span data-stu-id="d8974-127">If this property is not specified, the installer uses the System font.</span></span> <span data-ttu-id="d8974-128">如果封裝的字碼頁與使用者的預設 UI 字碼頁不同，這可能會導致安裝程式不正確地顯示文字字串。</span><span class="sxs-lookup"><span data-stu-id="d8974-128">This can cause the installer to improperly display text strings if the package's code page is different from the user's default UI code page.</span></span>

<span data-ttu-id="d8974-129">對於大部分的控制項而言，會使用資料庫字碼頁所指定的字元集來顯示文字。</span><span class="sxs-lookup"><span data-stu-id="d8974-129">For most controls, text is displayed using the character set that is specified by the code page of the database.</span></span> <span data-ttu-id="d8974-130">這可確保使用正確的字元集搭配資料庫中包含的資訊。</span><span class="sxs-lookup"><span data-stu-id="d8974-130">This ensures that the correct character set is used with the information contained in the database.</span></span> <span data-ttu-id="d8974-131">例外狀況是 [編輯](edit-control.md)、 [DirectoryList](directorylist-control.md)、 [PathEdit](pathedit-control.md)和 [DirectoryCombo](directorycombo-control.md) 控制項，一律會使用使用者的預設 UI 字元集來顯示文字。</span><span class="sxs-lookup"><span data-stu-id="d8974-131">The exceptions to this are the [Edit](edit-control.md), [DirectoryList](directorylist-control.md), [PathEdit](pathedit-control.md), and [DirectoryCombo](directorycombo-control.md) controls, which always display text using the user's default UI character set.</span></span> <span data-ttu-id="d8974-132">如果已設定[UsersLanguage 控制項屬性](userslanguage-control-attribute.md)，則[文字](text-control.md)、 [ListBox](listbox-control.md)和[COMBOBOX](combobox-control.md)控制項會使用使用者的預設 UI 字元集。</span><span class="sxs-lookup"><span data-stu-id="d8974-132">The [Text](text-control.md), [ListBox](listbox-control.md), and [ComboBox](combobox-control.md) controls use the user's default UI character set if the [UsersLanguage Control Attribute](userslanguage-control-attribute.md) is set.</span></span>

<span data-ttu-id="d8974-133">在某些情況下，取消對話方塊時可能會不正確地重新繪製控制項。</span><span class="sxs-lookup"><span data-stu-id="d8974-133">In some cases a control may be redrawn incorrectly when canceling out of a dialog box.</span></span> <span data-ttu-id="d8974-134">這必須以控制項 \_ 在移除 [ **取消** ] 對話方塊之後收到 WM 油漆訊息的順序來進行。</span><span class="sxs-lookup"><span data-stu-id="d8974-134">This has to do with the order in which the controls receive WM\_PAINT messages after the **Cancel** dialog box is removed.</span></span> <span data-ttu-id="d8974-135">若要修正此問題，請嘗試變更控制資料表中控制項的順序。</span><span class="sxs-lookup"><span data-stu-id="d8974-135">To fix this, try changing the order of the controls in the Control table.</span></span>

<span data-ttu-id="d8974-136">控制項的大小應該夠大，足以容納整個在所有字型大小設定中看到的文字。</span><span class="sxs-lookup"><span data-stu-id="d8974-136">Controls should be made large enough to accommodate the entire text viewed at all font size settings.</span></span> <span data-ttu-id="d8974-137">如果 UI 中的文字可能會當地語系化，則控制項的大小應該夠大，足以容納整個當地語系化文字。</span><span class="sxs-lookup"><span data-stu-id="d8974-137">Controls should be made large enough to accommodate the entire localized text, if the text in the UI may be localized.</span></span> <span data-ttu-id="d8974-138">較大的字型大小或當地語系化的文字可能需要比原始文字更多的空間，而且可能會被變得太小的控制項截斷。</span><span class="sxs-lookup"><span data-stu-id="d8974-138">Larger font sizes or localized text can require more space than the original text and can become truncated by a control that is made too small.</span></span> <span data-ttu-id="d8974-139">如需當地語系化 UI 文字的詳細資訊，請參閱一節： [當地語系化範例](a-localization-example.md)。</span><span class="sxs-lookup"><span data-stu-id="d8974-139">For more information about localizing UI text see the section: [A Localization Example](a-localization-example.md).</span></span>

 

 



