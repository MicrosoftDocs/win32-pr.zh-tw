---
description: Properties 資料表包含 patch 封裝的全域設定。  ( 的 patch 建立資料庫中必須要有 Properties 資料表) pcp 檔案，而且 UiCreatePatchPackageEx 函數會使用這些屬性。
ms.assetid: 767b97ce-7018-4d2b-bad5-11c18102d743
title: '屬性資料表 (Patchwiz.dll) '
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 36d25da4d9342d237161ec34c045018a728d73cf885985ec3633a5adeaea1b5a
ms.sourcegitcommit: e6600f550f79bddfe58bd4696ac50dd52cb03d7e
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/11/2021
ms.locfileid: "119381218"
---
# <a name="properties-table-patchwizdll"></a>屬性資料表 (Patchwiz.dll) 

Properties 資料表包含 patch 封裝的全域設定。  ( 的 patch 建立資料庫中必須要有 Properties 資料表) pcp 檔案，而且 [UiCreatePatchPackageEx](uicreatepatchpackageex--patchwiz-dll-.md) 函數會使用這些屬性。

Properties 資料表具有下列資料行。



| Column | 類型 | 答案 | Nullable |
|--------|------|-----|----------|
| 名稱   | text | Y   | N        |
| 值  | text |     | Y        |



 

## <a name="columns"></a>資料行

<dl> <dt>

<span id="Name"></span><span id="name"></span><span id="NAME"></span>名字
</dt> <dd>

修補程式建立屬性的名稱。

</dd> <dt>

<span id="Value"></span><span id="value"></span><span id="VALUE"></span>價值
</dt> <dd>

Patch 建立屬性的值。

</dd> </dl>

## <a name="remarks"></a>備註

下表將識別可在 pcp 檔案的 Properties 資料表中輸入的 patch 建立屬性字串。



| 屬性                             | 描述                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|--------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| AllowLaxValidationFlags              | 如果這個屬性設定為1，就會在記錄檔中寫入一個專案，如果無法驗證 [TargetImages 資料表](targetimages-table-patchwiz-dll-.md) 中的 ProductValidateFlags 欄位，就不會傳回任何錯誤。 只有當 patch 作者變更了 ProductValidateFlags 欄位中的值時，才應該設定這個屬性。 這個屬性的預設值為0。 從 Patchwiz.dll 4.0 版開始提供。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| AllowProductCodeMismatches           | 如果 [UpgradedImages 資料表](upgradedimages-table-patchwiz-dll-.md)中所列的升級映射與 [TargetImages 資料表](targetimages-table-patchwiz-dll-.md)中所列的目標映射之間的 [ [**ProductCode**](productcode.md) ] 屬性不同，則設定為 ' 1 ' 表示為 True。 設定為 ' 0 ' 或空白，表示如果產品代碼必須相同，則為 False。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| AllowProductVersionMajorMismatches   | 如果第一個欄位 (主要版本欄位) [**ProductVersion**](productversion.md) 屬性的第一個欄位在升級的影像和目標映射之間可能不同，則設定為 ' 1 ' 表示為 True。 如果主要版本必須相符，請將設定為 ' 0 ' 或空白以表示 False。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| ApiPatchingSymbolFlags               | 8位數的十六進位整數，表示建立二進位檔案修補程式時要使用的 patch 符號使用旗標組合。 預設值為0x00000000。 如需可能修補 \_ 符號 \_ \* 旗標的完整清單，請參閱 Patchapi。 請參閱詞彙以取得符號檔的詳細資訊。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| DontRemoveTempFolderWhenFinished     | 如果在建立修補程式套件之後不會移除包含轉換的暫存資料夾、位元組層級修補程式和整個新檔案，則設定為 ' 1 ' 表示為 True。 這基本上是 .msp 檔案的內容，然後再內嵌至修補套件中。 這對於偵測修補程式可能很有用。 如果要移除暫存資料夾，請將設為 ' 0 ' 或空白以表示 False。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| IncludeWholeFilesOnly                | 如果要變更的檔案會在建立修補程式套件時完整包含在其中，而不是建立二進位檔案修補程式，則設定為 ' 1 ' 表示為 True。 修補檔案的大小會較大，但 API 的執行速度會更快。 如果要建立二進位檔案修補程式，請將設定為 ' 0 ' 或空白以表示 False。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| ListOfPatchGUIDsToReplace            | 沒有分隔符號的 PatchGUID 識別碼清單。 如果在使用者的電腦上找到這些修補程式中的任何一項，並向 Windows Installer 登錄，則會從適當的產品中取消註冊，而且會從與產品相關聯的轉換清單中移除其修補程式轉換。 請注意，移除修補程式並不會影響任何檔案，而只會影響修補程式的註冊。 選擇性。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| ListOfTargetProductCodes             | 可能會收到此修補程式之產品的 [產品代碼](product-codes.md) 清單。 這是以分號分隔的 [ [ProductCode](productcode.md) ] 屬性值清單。 如果清單是以星號開頭，則會從 [TargetImages 資料表](targetimages-table-patchwiz-dll-.md)中所列目標的 .msi 檔案產生產品代碼清單。 如果有任何產品代碼遵循前置星號，則會附加至取代星號的清單。 如果未設定屬性，則會從 [TargetImages 資料表](targetimages-table-patchwiz-dll-.md)中所列目標的 .msi 檔案產生產品代碼清單。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| MsiFileToUseToCreatePatchTables      | 範本 .msi 檔案的完整路徑，用來匯出 [Patch 資料表](patch-table.md) 和 [PatchPackage 資料表](patchpackage-table.md)。 選擇項。 Properties 資料表接受從4.0 版 Patchwiz.dll 開始之路徑的環境變數。 使用環境變數的 Windows 格式，例如%*ENV \_ VAR*%。 請勿使用 [格式化](formatted.md) 資料行資料類型。 <br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| OptimizePatchSizeForLargeFiles       | 當值存在且不是 "0" 時，就會設定這個屬性。 當設定此屬性時，檔案的修補程式可能會變得較小，大小大約 4 MB。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| PatchGUID                            | 此修補封裝的 [GUID](guid.md) 識別碼 ( .msp 檔) 。 每個修補套件都必須有唯一的 PatchGUID 值。 必要。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| PatchOutputPath                      | 要產生之修補程式套件檔案的完整路徑（包括檔案名）。 如果 *szPatchPath* 是由 [UiCreatePatchPackageEx](uicreatepatchpackageex--patchwiz-dll-.md) 函數所傳遞，則會使用傳遞的值。 如果 *szPatchPath* 是 null 或空字串，則需要這個屬性。Properties 資料表會接受從4.0 版 Patchwiz.dll 開始之路徑的環境變數。 使用環境變數的 Windows 格式，例如%*ENV \_ VAR*%。 請勿使用 [格式化](formatted.md) 資料行資料類型。 <br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| PatchSourceList                      | 當本機快取的複本無法使用時，用來尋找修補程式之 .msp 檔的來源。 當修補程式套用至產品時，此值會加入至修補程式的來源清單中。 選擇性。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| MinimumRequiredMsiVersion            | 設定此屬性，以強制 Patchwiz.dll 產生需要特定版本 Windows Installer 的修補程式。 這個屬性值有助於判斷 patch 封裝的 [ [**字數統計摘要**](word-count-summary.md) ] 屬性所要使用的值。 這個屬性的值與安裝套件的 [ [**頁面計數摘要**](page-count-summary.md) ] 屬性的形式相同。 如果 pcp 檔案的 MinimumRequiredMsiVersion 等於200，Patchwiz.dll 將修補封裝的 [ [**字數統計**](word-count-summary.md) ] 屬性設定為3。 這可防止2.0 版之前的 Windows Installer 版本套用修補程式。<br/> 如果 pcp 檔案的 MinimumRequiredMsiVersion 等於300，Patchwiz.dll 將修補程式套件的 [ [**字數統計**](word-count-summary.md) ] 屬性設定為 [4]。 這可防止 Windows Installer 早于3.0 版的版本套用修補程式。<br/> 如果 pcp 檔案的 MinimumRequiredMsiVersion 等於310，Patchwiz.dll 將修補程式套件的 [ [**字數統計**](word-count-summary.md) ] 屬性設定為5。 這可防止 Windows Installer 早于版本3.1 來套用修補程式。<br/> 如果 pcp 檔案的 MinimumRequiredMsiVersion 等於400，Patchwiz.dll 將修補程式套件的 [ [**字數統計**](word-count-summary.md) ] 屬性設定為6。 這可防止 Windows Installer 早于版本4.0 來套用修補程式。<br/> |
| \_ \_ 已啟用 PATCH CACHE                | 將此屬性設定為1，以快取 PATCH \_ cache DIR 屬性所指定之資料夾中的修補程式建立資訊 \_ 。 修補快取可在更新更新映射後重新建立新的修補程式時，增加修補程式建立的速度。 此屬性需要 Windows Installer 2.0 或更新版本中的 Patchwiz.dll。 如需詳細資訊，請參閱 [修補資訊快取 (Patchwiz.dll) ](patch-information-caching-patchwiz-dll-.md)。<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| PATCH \_ CACHE \_ DIR                    | 將此屬性設定為儲存快取修補程式資訊的資料夾名稱。 如有必要，Patchwiz.dll 建立此資料夾。 資料夾應位於磁碟空間足夠的磁片磁碟機上。 只有在 [ \_ 已啟用 PATCH CACHE] \_ 屬性設定為1時，才會使用這個屬性。 Properties 資料表會接受從4.0 版 Patchwiz.dll 開始之路徑的環境變數。 使用環境變數的 Windows 格式，例如%*ENV \_ VAR*%。 請勿使用 [格式化](formatted.md) 資料行資料類型。 <br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| \_ \_ \_ 已停用順序資料產生 | 將此屬性設定為 1 (一個) ，以防止自動產生修補程式排序資訊。 如果這個屬性不存在，則會自動產生並新增排序資訊。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| 順序 \_ 資料 \_ 取代         | 將此屬性設定為 0 (零) 或 1 (一個) ，以便在 [MsiPatchSequence 資料表](msipatchsequence-table.md)中所有資料列的 [屬性] 欄位中寫入該值。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| TrustMsi                             | 在 Properties 資料表中將這個屬性設定為1，以使用 .msi 檔案中提供的檔案版本資訊、大小和雜湊值。 如果已設定此屬性，但 .msi 檔中的資訊不正確，則建立的修補程式可能無法正常運作。 您應使用 [MsiFiler.exe](msifiler-exe.md)來更新目標和升級的 .msi 檔案。 這個屬性的預設值為0。 從 Patchwiz.dll 4.0 版開始提供。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |



 

 

 




