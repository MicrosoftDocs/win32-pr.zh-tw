---
description: UpgradeCode 主要是用來支援主要升級，雖然小型和次要升級修補程式可能會使用 UpgradeCode 進行產品驗證。
ms.assetid: de62bb80-56a0-4652-9509-5d36ed171c69
title: 使用 UpgradeCode
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: caf32d40364653527b9f906e6dd42de64bb9f697
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/07/2021
ms.locfileid: "103848922"
---
# <a name="using-an-upgradecode"></a><span data-ttu-id="57e4b-103">使用 UpgradeCode</span><span class="sxs-lookup"><span data-stu-id="57e4b-103">Using an UpgradeCode</span></span>

<span data-ttu-id="57e4b-104">[**UpgradeCode**](upgradecode.md)主要是用來支援主要升級，雖然小型和次要升級修補程式可能會使用 **UpgradeCode** 進行產品驗證。</span><span class="sxs-lookup"><span data-stu-id="57e4b-104">The [**UpgradeCode**](upgradecode.md) is primarily used for supporting major upgrades, although small and minor upgrade patches may use the **UpgradeCode** for product validation.</span></span> <span data-ttu-id="57e4b-105">在主要升級期間， [FindRelatedProducts](findrelatedproducts-action.md)、 [MigrateFeatureStates](migratefeaturestates-action.md)和 [RemoveExistingProducts](removeexistingproducts-action.md) 動作會偵測、遷移和移除產品的先前版本。</span><span class="sxs-lookup"><span data-stu-id="57e4b-105">During major upgrades, the [FindRelatedProducts](findrelatedproducts-action.md), [MigrateFeatureStates](migratefeaturestates-action.md), and [RemoveExistingProducts](removeexistingproducts-action.md) actions detect, migrate, and remove previous versions of the product.</span></span> <span data-ttu-id="57e4b-106">FindRelatedProducts 動作會根據 **UpgradeCode**、 [**ProductLanguage**](productlanguage.md)和 [**ProductVersion**](productversion.md)，使用準則來搜尋產品。</span><span class="sxs-lookup"><span data-stu-id="57e4b-106">The FindRelatedProducts action searches for products using criteria based upon the **UpgradeCode**, [**ProductLanguage**](productlanguage.md), and [**ProductVersion**](productversion.md).</span></span> <span data-ttu-id="57e4b-107">這些準則是在 [升級](upgrade-table.md) 資料表中指定的。</span><span class="sxs-lookup"><span data-stu-id="57e4b-107">These criteria are specified in the [Upgrade](upgrade-table.md) table.</span></span>

<span data-ttu-id="57e4b-108">根據 [FindRelatedProducts](findrelatedproducts-action.md) 動作所使用的準則，單一產品的不同語言和版本的 [**UpgradeCode**](upgradecode.md) 可能相同。</span><span class="sxs-lookup"><span data-stu-id="57e4b-108">Given the criteria used by the [FindRelatedProducts](findrelatedproducts-action.md) action, the [**UpgradeCode**](upgradecode.md) can be the same for different languages and versions of a single product.</span></span> <span data-ttu-id="57e4b-109">這是因為 [升級](upgrade-table.md) 資料表可讓您在產品版本和語言行之間進行區別。</span><span class="sxs-lookup"><span data-stu-id="57e4b-109">This is because the [Upgrade](upgrade-table.md) table allows for differentiating between products along version and language lines.</span></span>

<span data-ttu-id="57e4b-110">在相同產品的不同版本中，您可能永遠不需要變更 [**UpgradeCode**](upgradecode.md)。</span><span class="sxs-lookup"><span data-stu-id="57e4b-110">Across different versions of the same product, you may never need to change the [**UpgradeCode**](upgradecode.md).</span></span> <span data-ttu-id="57e4b-111">每個獨立產品都應該有自己的 **UpgradeCode**。</span><span class="sxs-lookup"><span data-stu-id="57e4b-111">Each stand-alone product should have its own **UpgradeCode**.</span></span> <span data-ttu-id="57e4b-112">產品套件應該也有自己的 **UpgradeCode**。</span><span class="sxs-lookup"><span data-stu-id="57e4b-112">A product suite should also have its own **UpgradeCode**.</span></span> <span data-ttu-id="57e4b-113">這麼做可讓套件使用 [升級資料表](upgrade-table.md)中的多個資料列，升級舊版的套件或獨立產品。</span><span class="sxs-lookup"><span data-stu-id="57e4b-113">Doing so will allow the suite to upgrade previous versions of the suite or stand-alone products by using multiple rows in the [Upgrade table](upgrade-table.md).</span></span>

<span data-ttu-id="57e4b-114">下列兩個案例說明 [**UpgradeCode**](upgradecode.md)的使用。</span><span class="sxs-lookup"><span data-stu-id="57e4b-114">The following two scenarios illustrate the use of the [**UpgradeCode**](upgradecode.md).</span></span>

-   <span data-ttu-id="57e4b-115">產品 A 和產品 B 隨附于相同的 [**ProductLanguage**](productlanguage.md)、 [**ProductVersion**](productversion.md)和 [**UpgradeCode**](upgradecode.md)。</span><span class="sxs-lookup"><span data-stu-id="57e4b-115">Product A and Product B were shipped with the same [**ProductLanguage**](productlanguage.md), [**ProductVersion**](productversion.md), and [**UpgradeCode**](upgradecode.md).</span></span> <span data-ttu-id="57e4b-116">產品 A 和產品 B 有不同的 [**ProductCodes**](productcode.md)。</span><span class="sxs-lookup"><span data-stu-id="57e4b-116">Product A and Product B have different [**ProductCodes**](productcode.md).</span></span> <span data-ttu-id="57e4b-117">因為產品已獲指派相同的 **UpgradeCode**，所以無法撰寫 [升級](upgrade-table.md) 資料表來區分舊版產品 a 與較舊版本產品 B 的較舊版本。在此情況下，您將無法安裝產品 A 的升級，而忽略產品 B。因為這些是不同的產品，所以應該將不同的 **UpgradeCode** 指派給每個產品。</span><span class="sxs-lookup"><span data-stu-id="57e4b-117">Because the products were assigned the same **UpgradeCode**, the [Upgrade](upgrade-table.md) table cannot be authored to differentiate the older version of Product A from the older version of Product B. In this case, you will be unable to have an upgrade installation of Product A that ignores Product B. Because these were different products, they should have each been assigned a different **UpgradeCode**.</span></span>
-   <span data-ttu-id="57e4b-118">產品 A 的英文和法文版本是隨附于相同的 [**ProductVersion**](productversion.md) 和 [**UpgradeCode**](upgradecode.md)。</span><span class="sxs-lookup"><span data-stu-id="57e4b-118">The English and French versions of Product A were shipped with the same [**ProductVersion**](productversion.md) and [**UpgradeCode**](upgradecode.md).</span></span> <span data-ttu-id="57e4b-119">英文和法文版本的產品 A 具有不同的 [**ProductLanguages**](productlanguage.md) 和 [**ProductCodes**](productcode.md)。</span><span class="sxs-lookup"><span data-stu-id="57e4b-119">Both the English and French versions of Product A have different [**ProductLanguages**](productlanguage.md) and [**ProductCodes**](productcode.md).</span></span> <span data-ttu-id="57e4b-120">雖然英文和法文語言版本都共用相同的 **UpgradeCode**，但是您可以撰寫 [升級](upgrade-table.md) 資料表，使其只會偵測及升級舊版的英文語言，而且會忽略較舊的法文版本。</span><span class="sxs-lookup"><span data-stu-id="57e4b-120">Even though both the English and French language versions share the same **UpgradeCode**, it is possible to author the [Upgrade](upgrade-table.md) table such that only the older English language version will be detected and upgraded and the older French version ignored.</span></span> <span data-ttu-id="57e4b-121">產品的不同語言版本可使用相同的 **UpgradeCode**。</span><span class="sxs-lookup"><span data-stu-id="57e4b-121">Different language versions of a product can use the same **UpgradeCode**.</span></span>

 

 



