---
description: Instmsi.exe 是安裝 Windows Installer 的可轉散發套件&\# 160、2.0 和舊版的 Windows Installer。 請參閱可轉散發套件的 Windows Installer 可轉散發套件，適用于 Windows Installer&\# 160、3.0 和更新版本。
ms.assetid: 74ea4530-3a73-4169-b0b7-f0272229192d
title: Instmsi.exe
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 229d748cda68731627a6af2af992e321755b5ca2
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/08/2021
ms.locfileid: "106980631"
---
# <a name="instmsiexe"></a><span data-ttu-id="4d510-104">Instmsi.exe</span><span class="sxs-lookup"><span data-stu-id="4d510-104">Instmsi.exe</span></span>

<span data-ttu-id="4d510-105">Instmsi.exe 是安裝 Windows Installer 2.0 和舊版 Windows Installer 的可轉散發套件。</span><span class="sxs-lookup"><span data-stu-id="4d510-105">Instmsi.exe is the redistributable package for installing Windows Installer 2.0, and earlier versions of Windows Installer.</span></span> <span data-ttu-id="4d510-106">請參閱 Windows Installer 3.0 和更新版本的可轉散發套件 [Windows Installer](windows-installer-redistributables.md) 可轉散發套件。</span><span class="sxs-lookup"><span data-stu-id="4d510-106">See [Windows Installer Redistributables](windows-installer-redistributables.md) for the redistributables for Windows Installer 3.0 and later versions.</span></span>

<span data-ttu-id="4d510-107">如需作業系統隨附的 Windows Installer 版本的詳細資訊，請參閱 [Windows Installer 的發行](released-versions-of-windows-installer.md)版。</span><span class="sxs-lookup"><span data-stu-id="4d510-107">For more information about which version of the Windows Installer was shipped with your operating system, see [Released Versions of Windows Installer](released-versions-of-windows-installer.md).</span></span>

<span data-ttu-id="4d510-108">某些可轉散發套件不應在特定版本的作業系統上執行。</span><span class="sxs-lookup"><span data-stu-id="4d510-108">Some redistributables should not be run on certain versions of the operating system.</span></span> <span data-ttu-id="4d510-109">下表說明哪些 Instmsi 與哪些作業系統相容。</span><span class="sxs-lookup"><span data-stu-id="4d510-109">The following table describes which Instmsi is compatible on which operating system.</span></span>



| <span data-ttu-id="4d510-110">如果 Instmsi.exe 安裝這個版本的 Windows Installer</span><span class="sxs-lookup"><span data-stu-id="4d510-110">If Instmsi.exe installs this version of the Windows Installer</span></span> | <span data-ttu-id="4d510-111">Instmsi.exe 可以在這些作業系統上執行</span><span class="sxs-lookup"><span data-stu-id="4d510-111">Instmsi.exe can be run on these operating systems</span></span>                    | <span data-ttu-id="4d510-112">Instmsi.exe 不得在這些作業系統上執行</span><span class="sxs-lookup"><span data-stu-id="4d510-112">Instmsi.exe must not be run on these operating systems</span></span>                                        |
|---------------------------------------------------------------|----------------------------------------------------------------------|-----------------------------------------------------------------------------------------------|
| <span data-ttu-id="4d510-113">Windows Installer 版本1。0</span><span class="sxs-lookup"><span data-stu-id="4d510-113">Windows Installer version 1.0</span></span>                                 | <span data-ttu-id="4d510-114">Windows 95、Windows 98、Windows NT 4.0 + SP3</span><span class="sxs-lookup"><span data-stu-id="4d510-114">Windows 95, Windows 98, Windows NT 4.0+SP3</span></span>                           | <span data-ttu-id="4d510-115">Windows Me、Windows 2000、Windows XP、Windows Server 2003、Windows Vista、Windows Server 2008</span><span class="sxs-lookup"><span data-stu-id="4d510-115">Windows Me, Windows 2000, Windows XP, Windows Server 2003, Windows Vista, Windows Server 2008</span></span> |
| <span data-ttu-id="4d510-116">Windows Installer 版本1。1</span><span class="sxs-lookup"><span data-stu-id="4d510-116">Windows Installer version 1.1</span></span>                                 | <span data-ttu-id="4d510-117">Windows 95、Windows 98、Windows NT 4.0 + SP3</span><span class="sxs-lookup"><span data-stu-id="4d510-117">Windows 95, Windows 98, Windows NT 4.0+SP3</span></span>                           | <span data-ttu-id="4d510-118">Windows Me、Windows 2000、Windows XP、Windows Server 2003、Windows Vista、Windows Server 2008</span><span class="sxs-lookup"><span data-stu-id="4d510-118">Windows Me, Windows 2000, Windows XP, Windows Server 2003, Windows Vista, Windows Server 2008</span></span> |
| <span data-ttu-id="4d510-119">Windows Installer 版本1。2</span><span class="sxs-lookup"><span data-stu-id="4d510-119">Windows Installer version 1.2</span></span>                                 | <span data-ttu-id="4d510-120">Windows 95、Windows 98、Windows Me、Windows NT 4.0 + SP3</span><span class="sxs-lookup"><span data-stu-id="4d510-120">Windows 95, Windows 98, Windows Me, Windows NT 4.0+SP3</span></span>               | <span data-ttu-id="4d510-121">Windows 2000、Windows XP、Windows Server 2003、Windows Vista、Windows Server 2008</span><span class="sxs-lookup"><span data-stu-id="4d510-121">Windows 2000, Windows XP, Windows Server 2003, Windows Vista, Windows Server 2008</span></span>             |
| <span data-ttu-id="4d510-122">Windows Installer 版本2。0</span><span class="sxs-lookup"><span data-stu-id="4d510-122">Windows Installer version 2.0</span></span>                                 | <span data-ttu-id="4d510-123">Windows 95、Windows 98、Windows Me、Windows NT 4.0 + SP6、Windows 2000</span><span class="sxs-lookup"><span data-stu-id="4d510-123">Windows 95, Windows 98, Windows Me, Windows NT 4.0+SP6, Windows 2000</span></span> | <span data-ttu-id="4d510-124">Windows XP、Windows Server 2003、Windows Vista、Windows Server 2008</span><span class="sxs-lookup"><span data-stu-id="4d510-124">Windows XP, Windows Server 2003, Windows Vista, Windows Server 2008</span></span>                           |



 

<span data-ttu-id="4d510-125">例如，在執行可轉散發套件之前，重新散發 Windows Installer 版本1.1 的應用程式應該檢查作業系統是否 Windows NT 4.0 SP3 或 Windows 98/95。</span><span class="sxs-lookup"><span data-stu-id="4d510-125">For example, an application that redistributes Windows Installer version 1.1 should check that the operating system is Windows NT 4.0 SP3 or Windows 98/95 before running the redistributable package.</span></span> <span data-ttu-id="4d510-126">使用可轉散發套件的應用程式也應該確保 Windows Installer 的 ANSI 版本是安裝在 Windows 98/95 上，而且 Unicode 版本是安裝在 Windows NT 或 Windows 2000 上。</span><span class="sxs-lookup"><span data-stu-id="4d510-126">Applications using the redistributable package should also ensure that the ANSI version of the Windows Installer is installed on Windows 98/95, and that the Unicode version is installed on Windows NT or Windows 2000.</span></span> <span data-ttu-id="4d510-127">請注意，有些應用程式會將 Unicode 版本重新命名為 InstMsiW。</span><span class="sxs-lookup"><span data-stu-id="4d510-127">Note that some applications rename the Unicode version to InstMsiW.</span></span>

## <a name="syntax"></a><span data-ttu-id="4d510-128">Syntax</span><span class="sxs-lookup"><span data-stu-id="4d510-128">Syntax</span></span>

<span data-ttu-id="4d510-129">**instmsi** *選項*</span><span class="sxs-lookup"><span data-stu-id="4d510-129">**instmsi** *options*</span></span>

## <a name="command-line-options"></a><span data-ttu-id="4d510-130">命令列選項</span><span class="sxs-lookup"><span data-stu-id="4d510-130">Command Line Options</span></span>

<span data-ttu-id="4d510-131">命令列選項不區分大小寫。</span><span class="sxs-lookup"><span data-stu-id="4d510-131">The command line options are case-insensitive.</span></span>



| <span data-ttu-id="4d510-132">選項</span><span class="sxs-lookup"><span data-stu-id="4d510-132">Option</span></span>                     | <span data-ttu-id="4d510-133">Description</span><span class="sxs-lookup"><span data-stu-id="4d510-133">Description</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
|----------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="4d510-134">/q</span><span class="sxs-lookup"><span data-stu-id="4d510-134">/q</span></span>                         | <span data-ttu-id="4d510-135">供應用程式使用，以在啟動載入器應用程式中重新發佈 Windows Installer。</span><span class="sxs-lookup"><span data-stu-id="4d510-135">For use by applications that redistribute the Windows Installer as part of a bootstrapping application.</span></span> <span data-ttu-id="4d510-136">不會向使用者顯示任何 UI。</span><span class="sxs-lookup"><span data-stu-id="4d510-136">No UI is presented to the user.</span></span> <span data-ttu-id="4d510-137">啟動載入應用程式應該會檢查傳回碼，以判斷是否需要重新開機才能完成 Windows Installer 安裝。</span><span class="sxs-lookup"><span data-stu-id="4d510-137">The bootstrapping application should check the return code to determine whether a reboot is needed to complete the installation of the Windows Installer.</span></span>                                                                                                                                                                                                                          |
| <span data-ttu-id="4d510-138">/t</span><span class="sxs-lookup"><span data-stu-id="4d510-138">/t</span></span>                         | <span data-ttu-id="4d510-139">僅供用於偵錯工具用途。</span><span class="sxs-lookup"><span data-stu-id="4d510-139">Used for debugging purposes only.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| <span data-ttu-id="4d510-140">/c： "msiinst/delayreboot"</span><span class="sxs-lookup"><span data-stu-id="4d510-140">/c:"msiinst /delayreboot"</span></span>  | <span data-ttu-id="4d510-141">延遲的重新開機選項。</span><span class="sxs-lookup"><span data-stu-id="4d510-141">The delayed reboot option.</span></span> <span data-ttu-id="4d510-142">防止 Instmsi 提示使用者重新開機，即使它必須取代安裝期間所使用的檔案。</span><span class="sxs-lookup"><span data-stu-id="4d510-142">Prevents Instmsi from prompting the user for a reboot even if it had to replace files that were in use during the installation.</span></span> <span data-ttu-id="4d510-143">如果使用此選項叫用 Instmsi， \_ \_ \_ 如果必須取代使用中的檔案，則會傳回錯誤成功重新開機。</span><span class="sxs-lookup"><span data-stu-id="4d510-143">If Instmsi is invoked with this option, it returns ERROR\_SUCCESS\_REBOOT\_REQUIRED if it had to replace files that were in use.</span></span> <span data-ttu-id="4d510-144">如果不需要取代使用中的檔案，則會傳回錯誤 \_ 成功。</span><span class="sxs-lookup"><span data-stu-id="4d510-144">If it did not have to replace files that were in use, it returns ERROR\_SUCCESS.</span></span> <span data-ttu-id="4d510-145">適用于 Windows Installer 2.0 或更新版本的 Instmsi。</span><span class="sxs-lookup"><span data-stu-id="4d510-145">Available with Instmsi for Windows Installer  2.0 or later.</span></span> <span data-ttu-id="4d510-146">如需延遲重新開機的詳細資訊，請參閱「備註」一節。</span><span class="sxs-lookup"><span data-stu-id="4d510-146">See the remarks section for additional information on delayed reboots.</span></span><br/> |
| <span data-ttu-id="4d510-147">/c： "msiinst/delayrebootq"</span><span class="sxs-lookup"><span data-stu-id="4d510-147">/c:"msiinst /delayrebootq"</span></span> | <span data-ttu-id="4d510-148">延遲重新開機選項的安靜版本。</span><span class="sxs-lookup"><span data-stu-id="4d510-148">The quiet version of the delayed reboot option.</span></span> <span data-ttu-id="4d510-149">它不會向使用者顯示任何 UI。</span><span class="sxs-lookup"><span data-stu-id="4d510-149">It does not present any UI to the user.</span></span> <span data-ttu-id="4d510-150">否則行為會與先前的選項相同。</span><span class="sxs-lookup"><span data-stu-id="4d510-150">Otherwise the behavior is identical to the previous option.</span></span> <span data-ttu-id="4d510-151">適用于 Windows Installer 2.0 或更新版本的 Instmsi。</span><span class="sxs-lookup"><span data-stu-id="4d510-151">Available with Instmsi for Windows Installer 2.0 or later.</span></span> <span data-ttu-id="4d510-152">如需延遲重新開機的詳細資訊，請參閱「備註」一節。</span><span class="sxs-lookup"><span data-stu-id="4d510-152">See the remarks section for additional information on delayed reboots.</span></span><br/>                                                                                                                                                                                                                           |
| <span data-ttu-id="4d510-153">/?</span><span class="sxs-lookup"><span data-stu-id="4d510-153">/?</span></span>                         | <span data-ttu-id="4d510-154">顯示說明。</span><span class="sxs-lookup"><span data-stu-id="4d510-154">Displays help.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |



 

## <a name="remarks"></a><span data-ttu-id="4d510-155">備註</span><span class="sxs-lookup"><span data-stu-id="4d510-155">Remarks</span></span>

<span data-ttu-id="4d510-156">啟動使用 Instmsi.exe 安裝 Windows Installer 與另一個[應用程式的應用程式](bootstrapping.md)，可能需要額外的系統重新開機。</span><span class="sxs-lookup"><span data-stu-id="4d510-156">[Bootstrapping](bootstrapping.md) applications that use Instmsi.exe to install the Windows Installer with another application may require an extra system reboot.</span></span> <span data-ttu-id="4d510-157">這可能是在安裝應用程式所需的任何重新開機以外的額外重新開機。</span><span class="sxs-lookup"><span data-stu-id="4d510-157">This is potentially an extra reboot in addition to any reboots that are needed to install the application.</span></span>

<span data-ttu-id="4d510-158">延遲的重新開機選項只適用于想要消除額外重新開機所造成的額外重新開機的安裝程式開發人員，其安裝應用程式會 Instmsi.exe 使用安裝程式來安裝使用中的檔案。</span><span class="sxs-lookup"><span data-stu-id="4d510-158">The delayed reboot option is only recommended for setup developers who want to eliminate an extra reboot caused by using Instmsi.exe with a setup application that installs files that are in use.</span></span>

<span data-ttu-id="4d510-159">開發人員應在其安裝應用程式中執行下列動作，以使用延遲的重新開機選項。</span><span class="sxs-lookup"><span data-stu-id="4d510-159">Developers should do the following in their setup application to use the delayed reboot option.</span></span> <span data-ttu-id="4d510-160">安裝2.0 版之前的 Windows Installer 版本的 Instmsi.exe 版本，無法使用此選項：</span><span class="sxs-lookup"><span data-stu-id="4d510-160">This option is not available with Instmsi.exe versions that install Window Installer versions earlier than version 2.0:</span></span>

<span data-ttu-id="4d510-161">**使用延遲的重新開機選項**</span><span class="sxs-lookup"><span data-stu-id="4d510-161">**To use the delayed reboot option**</span></span>

1.  <span data-ttu-id="4d510-162">使用其中一個延遲的重新開機命令列選項來呼叫 Instmsi.exe。</span><span class="sxs-lookup"><span data-stu-id="4d510-162">Call Instmsi.exe with one of the delayed reboot command line options.</span></span>
2.  <span data-ttu-id="4d510-163">請將錯誤 \_ 成功或錯誤 \_ 成功重新開機的傳回視為 \_ \_ 成功。</span><span class="sxs-lookup"><span data-stu-id="4d510-163">Treat the return of either ERROR\_SUCCESS or ERROR\_SUCCESS\_REBOOT\_REQUIRED as meaning success.</span></span>
3.  <span data-ttu-id="4d510-164">從以下的 InstallerLocation 值取得包含新安裝 Windows Installer 二進位檔之資料夾的路徑：</span><span class="sxs-lookup"><span data-stu-id="4d510-164">Get the path to the folder containing the newly installed Windows Installer binaries from the InstallerLocation value under:</span></span>

    <span data-ttu-id="4d510-165">**HKEY \_本機 \_ 電腦** \\ **軟體** \\ **Microsoft** \\ **Windows** \\ **CurrentVersion** \\ **安裝程式**</span><span class="sxs-lookup"><span data-stu-id="4d510-165">**HKEY\_LOCAL\_MACHINE**\\**Software**\\**Microsoft**\\**Windows**\\**CurrentVersion**\\**Installer**</span></span>

    <span data-ttu-id="4d510-166">此值的型別為 **REG \_ SZ**。</span><span class="sxs-lookup"><span data-stu-id="4d510-166">This value is of type **REG\_SZ**.</span></span>

4.  <span data-ttu-id="4d510-167">將目前目錄設定為在步驟3中取得的路徑。</span><span class="sxs-lookup"><span data-stu-id="4d510-167">Set the current directory to the path obtained in step 3.</span></span>
5.  <span data-ttu-id="4d510-168">在應用程式的封裝上叫用 Msiexec，並執行應用程式特定的其他安裝程式程式碼。</span><span class="sxs-lookup"><span data-stu-id="4d510-168">Invoke Msiexec on the application's package and run other setup code specific to the application.</span></span> <span data-ttu-id="4d510-169">如果安裝應用程式使用 [**MsiInstallProduct**](/windows/desktop/api/Msi/nf-msi-msiinstallproducta)，則應用程式必須從步驟3取得的位置載入 MSI.DLL。</span><span class="sxs-lookup"><span data-stu-id="4d510-169">If the setup application uses [**MsiInstallProduct**](/windows/desktop/api/Msi/nf-msi-msiinstallproducta), then the application must load MSI.DLL from the location obtained in step 3.</span></span>
    > [!Note]  
    > <span data-ttu-id="4d510-170">在步驟3中取得之位置的新 MSI.DLL 上呼叫 **LoadLibrary** 的應用程式，必須確保進程內尚未載入較舊版本的 MSI.DLL。</span><span class="sxs-lookup"><span data-stu-id="4d510-170">Applications that call **LoadLibrary** on the new MSI.DLL in the location obtained in step 3 must ensure that an older version of MSI.DLL has not already been loaded within the process.</span></span> <span data-ttu-id="4d510-171">如果已在進程中載入舊版 MSI.DLL，則必須在新 MSI.DLL 的 **LoadLibrary** 呼叫之前，從進程位址空間中卸載它。</span><span class="sxs-lookup"><span data-stu-id="4d510-171">If an older version of MSI.DLL was loaded within the process, it must be unloaded from the process address space prior to the **LoadLibrary** call for the new MSI.DLL.</span></span>

     

6.  <span data-ttu-id="4d510-172">如果步驟 (5) 不需要重新開機，且 Instmsi.exe \_ \_ \_ 在步驟 (1) 中傳回錯誤成功重新開機，請提示使用者重新開機，以完成系統上 Windows Installer 二進位檔的設定。</span><span class="sxs-lookup"><span data-stu-id="4d510-172">If step (5) does not require a reboot and if Instmsi.exe had returned ERROR\_SUCCESS\_REBOOT\_REQUIRED in step (1), prompt the user for a reboot to complete the setup of the Windows Installer binaries on the system.</span></span> <span data-ttu-id="4d510-173">但是，如果在步驟 (5) 中發生重新開機，則不需要執行任何其他步驟。</span><span class="sxs-lookup"><span data-stu-id="4d510-173">However, if a reboot occurs in step (5), no additional steps are required.</span></span>

<span data-ttu-id="4d510-174">Instmsi.exe 適用于 [Windows Installer 開發人員 Windows SDK 元件](platform-sdk-components-for-windows-installer-developers.md)。</span><span class="sxs-lookup"><span data-stu-id="4d510-174">Instmsi.exe is available in the [Windows SDK Components for Windows Installer Developers](platform-sdk-components-for-windows-installer-developers.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="4d510-175">相關主題</span><span class="sxs-lookup"><span data-stu-id="4d510-175">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="4d510-176">引導</span><span class="sxs-lookup"><span data-stu-id="4d510-176">Bootstrapping</span></span>](bootstrapping.md)
</dt> <dt>

[<span data-ttu-id="4d510-177">網際網路下載啟動載入</span><span class="sxs-lookup"><span data-stu-id="4d510-177">Internet Download Bootstrapping</span></span>](internet-download-bootstrapping.md)
</dt> <dt>

[<span data-ttu-id="4d510-178">已發行的版本、工具和可轉散發套件</span><span class="sxs-lookup"><span data-stu-id="4d510-178">Released Versions, Tools, and Redistributables</span></span>](released-versions-tools-and-redistributables.md)
</dt> <dt>

[<span data-ttu-id="4d510-179">Windows Installer 開發工具</span><span class="sxs-lookup"><span data-stu-id="4d510-179">Windows Installer Development Tools</span></span>](windows-installer-development-tools.md)
</dt> </dl>

 

 




