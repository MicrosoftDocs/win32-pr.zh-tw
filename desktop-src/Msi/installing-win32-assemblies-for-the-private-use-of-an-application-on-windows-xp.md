---
description: 本主題中的程式會識別如何建立 Windows Installer 套件來安裝 Win32 元件。
ms.assetid: 2d4bc2be-cce6-45e6-b6a7-7ff96d28eb96
title: 在 Windows XP 上安裝 Win32 元件以私用應用程式
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e807e22c9c5dea67ece5ead0ded95f06ab203689
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/07/2021
ms.locfileid: "106974119"
---
# <a name="installing-win32-assemblies-for-the-private-use-of-an-application-on-windows-xp"></a><span data-ttu-id="e13ed-103">在 Windows XP 上安裝 Win32 元件以私用應用程式</span><span class="sxs-lookup"><span data-stu-id="e13ed-103">Installing Win32 Assemblies for the Private Use of an Application on Windows XP</span></span>

<span data-ttu-id="e13ed-104">本主題中的程式會識別如何建立 Windows Installer 套件來安裝 Win32 元件。</span><span class="sxs-lookup"><span data-stu-id="e13ed-104">The procedure in this topic identifies how to create a Windows Installer package to install a Win32 assembly.</span></span> <span data-ttu-id="e13ed-105">封裝會將元件和應用程式資訊清單檔案安裝到應用程式所使用的撰寫資料夾中。</span><span class="sxs-lookup"><span data-stu-id="e13ed-105">The package installs the assembly and an application manifest file into an authored folder that the application uses.</span></span> <span data-ttu-id="e13ed-106">應用程式資訊清單會指定應用程式在私用元件上的相依性。</span><span class="sxs-lookup"><span data-stu-id="e13ed-106">The application manifest specifies the dependence of the application on the private assembly.</span></span> <span data-ttu-id="e13ed-107">安裝封裝之後，私用元件可用於應用程式的專屬用途。</span><span class="sxs-lookup"><span data-stu-id="e13ed-107">After installing the package, the private assembly is available for the exclusive use of the application.</span></span> <span data-ttu-id="e13ed-108">應用程式資訊清單中指定的元件相依性會覆寫此應用程式 (，) 組件資訊清單檔中所指定的任何其他全域程式集相依性。</span><span class="sxs-lookup"><span data-stu-id="e13ed-108">The assembly dependence that is specified in the application manifest overrides (for this application) any other global assembly dependencies that are specified in assembly manifest files.</span></span>

<span data-ttu-id="e13ed-109">繼續進行之前，最好先瞭解如何撰寫不含元件的 Windows Installer 套件。</span><span class="sxs-lookup"><span data-stu-id="e13ed-109">Before you continue, it is a good idea to understand how to author a Windows Installer package without assemblies.</span></span> <span data-ttu-id="e13ed-110">如需詳細資訊，請參閱 [安裝範例](an-installation-example.md)。</span><span class="sxs-lookup"><span data-stu-id="e13ed-110">For more information, see [An Installation Example](an-installation-example.md).</span></span>

<span data-ttu-id="e13ed-111">**在 Windows XP 上安裝私用元件**</span><span class="sxs-lookup"><span data-stu-id="e13ed-111">**To install a private assembly on Windows XP**</span></span>

1.  <span data-ttu-id="e13ed-112">定義包含 Win32 元件和應用程式資訊清單檔的 Windows Installer 元件。</span><span class="sxs-lookup"><span data-stu-id="e13ed-112">Define a Windows Installer component that includes the Win32 assembly and the application manifest file.</span></span> <span data-ttu-id="e13ed-113">此元件可以包含應該一律隨元件一起安裝或移除的其他資源。</span><span class="sxs-lookup"><span data-stu-id="e13ed-113">This component can contain other resources that should always be installed or removed with the assembly.</span></span> <span data-ttu-id="e13ed-114">此程式的其餘步驟說明如何編寫安裝資料庫來安裝此元件。</span><span class="sxs-lookup"><span data-stu-id="e13ed-114">The remaining steps of this procedure describe how to author the installation database to install this component.</span></span>
2.  <span data-ttu-id="e13ed-115">針對包含 Win32 元件和應用程式資訊清單檔的元件，將資料列加入 [元件資料表](component-table.md) 中。</span><span class="sxs-lookup"><span data-stu-id="e13ed-115">Add a row to the [Component table](component-table.md) for the component that contains the Win32 assembly and application manifest file.</span></span> <span data-ttu-id="e13ed-116">輸入此元件程式碼的有效 Windows Installer [GUID](guid.md) 。</span><span class="sxs-lookup"><span data-stu-id="e13ed-116">Enter a valid Windows Installer [GUID](guid.md) for this component code.</span></span> <span data-ttu-id="e13ed-117">如需詳細資訊，請參閱 [變更元件程式碼](changing-the-component-code.md) ，以及 [元件規則是否中斷時會發生什麼事？](what-happens-if-the-component-rules-are-broken.md)</span><span class="sxs-lookup"><span data-stu-id="e13ed-117">For more information, see [Changing the Component Code](changing-the-component-code.md) and [What happens if the component rules are broken?](what-happens-if-the-component-rules-are-broken.md)</span></span>
3.  <span data-ttu-id="e13ed-118">安裝程式會將組件資訊清單檔複製到包含 MsiAssembly 資料表的 [檔應用程式] 欄位中所指定之檔案的資料夾中 \_ 。 [](msiassembly-table.md)</span><span class="sxs-lookup"><span data-stu-id="e13ed-118">The installer copies the assembly manifest file into the folder that contains the file specified in the File\_Application field of the [MsiAssembly table](msiassembly-table.md).</span></span>
4.  <span data-ttu-id="e13ed-119">將資料列加入至 [FeatureComponents 資料表](featurecomponents-table.md) ，以將元件與 Windows Installer 功能系結。</span><span class="sxs-lookup"><span data-stu-id="e13ed-119">Add a row to the [FeatureComponents table](featurecomponents-table.md) tying the component to a Windows Installer feature.</span></span> <span data-ttu-id="e13ed-120">如需詳細資訊，請參閱 [元件和功能](components-and-features.md)。</span><span class="sxs-lookup"><span data-stu-id="e13ed-120">For more information, see [Components and Features](components-and-features.md).</span></span> <span data-ttu-id="e13ed-121">Windows Installer 的功能應該是使用者可辨識的應用程式功能的一部分。</span><span class="sxs-lookup"><span data-stu-id="e13ed-121">A Windows Installer feature should be a piece of the application functionality that a user can recognize.</span></span> <span data-ttu-id="e13ed-122">當使用者選取這項功能或應用程式發生錯誤時，就會啟動元件。</span><span class="sxs-lookup"><span data-stu-id="e13ed-122">The assembly is activated when this feature is selected by a user or faulted in by an application.</span></span> <span data-ttu-id="e13ed-123">如果元件定義了額外的功能，請在功能 [資料表](feature-table.md) 中為功能屬性新增一個額外的資料列。</span><span class="sxs-lookup"><span data-stu-id="e13ed-123">If the assembly defines an additional feature, then add an additional row to the [Feature table](feature-table.md) for the feature attributes.</span></span> <span data-ttu-id="e13ed-124">如果撰寫合併模組，則不需要此步驟。</span><span class="sxs-lookup"><span data-stu-id="e13ed-124">This step is not required if authoring a merge module.</span></span>
5.  <span data-ttu-id="e13ed-125">針對並存元件，系結和啟用資訊（例如 COM 類別、介面和類型程式庫）會儲存在資訊清單檔中，而不是儲存在登錄中。</span><span class="sxs-lookup"><span data-stu-id="e13ed-125">For side-by-side assemblies, binding and activation information, for example, COM classes, interfaces, and type libraries, is stored in manifest files rather than the registry.</span></span> <span data-ttu-id="e13ed-126">私用元件會將這項資訊儲存在組件資訊清單中。</span><span class="sxs-lookup"><span data-stu-id="e13ed-126">Private assemblies store this information in an assembly manifest.</span></span> <span data-ttu-id="e13ed-127">在支援並存元件的系統上，安裝程式會略過處理 [延伸模組資料表](extension-table.md)、 [動詞資料表](verb-table.md)、 [TypeLib 資料表](typelib-table.md)、 [MIME 資料表](mime-table.md)、 [類別資料表](class-table.md)、 [ProgId 資料表](progid-table.md)和 [AppId 資料表](appid-table.md)中所輸入元件的任何相關資訊。</span><span class="sxs-lookup"><span data-stu-id="e13ed-127">On systems that support side-by-side assemblies, the installer skips processing any information about the component that is entered in the [Extension table](extension-table.md), [Verb table](verb-table.md), [TypeLib table](typelib-table.md), [MIME table](mime-table.md), [Class table](class-table.md), [ProgId table](progid-table.md), and [AppId table](appid-table.md).</span></span> <span data-ttu-id="e13ed-128">您可以在資料表中輸入系結和啟用資訊，以供不支援並存元件共用的系統使用。</span><span class="sxs-lookup"><span data-stu-id="e13ed-128">Binding and activation information can be entered into the tables for use by systems that do not support side-by-side assembly sharing.</span></span>
6.  <span data-ttu-id="e13ed-129">並存安裝不會全域註冊元件。</span><span class="sxs-lookup"><span data-stu-id="e13ed-129">Side-by-side installation does not register the assembly globally.</span></span> <span data-ttu-id="e13ed-130">如果 [SelfReg 資料表](selfreg-table.md)中輸入了任何自我註冊資訊，安裝程式會略過自我註冊元件。</span><span class="sxs-lookup"><span data-stu-id="e13ed-130">The installer skips self-registering the component if any self-registration information is entered in the [SelfReg table](selfreg-table.md).</span></span> <span data-ttu-id="e13ed-131">您可以在 SelfReg 資料表中輸入自我註冊資訊，以便在不支援並存元件共用的系統上自行註冊元件。</span><span class="sxs-lookup"><span data-stu-id="e13ed-131">Self-registration information can be entered into the SelfReg table for self-registration of the component on systems that do not support side-by-side assembly sharing.</span></span>
7.  <span data-ttu-id="e13ed-132">在登錄 [資料表](registry-table.md)、 [RemoveRegistry 資料表](removeregistry-table.md)和 [環境資料表](environment-table.md)中，新增任何其他登錄資訊，包括系結和啟用或自我註冊元件。</span><span class="sxs-lookup"><span data-stu-id="e13ed-132">Add any other registry information, exclusive of binding and activation or self-registration of the component, to the [Registry table](registry-table.md), [RemoveRegistry table](removeregistry-table.md), and [Environment table](environment-table.md).</span></span>
8.  <span data-ttu-id="e13ed-133">安裝程式會在支援並存共用的作業系統上，略過此元件的 [IsolatedComponent 資料表](isolatedcomponent-table.md) 。</span><span class="sxs-lookup"><span data-stu-id="e13ed-133">The installer skips the [IsolatedComponent table](isolatedcomponent-table.md) for this component on operating systems that support side-by-side sharing.</span></span> <span data-ttu-id="e13ed-134">如果您想要元件在支援本機檔案的系統上是私用的，請在這個資料表中輸入資訊。</span><span class="sxs-lookup"><span data-stu-id="e13ed-134">Enter information into this table if you want the assembly to be private on systems that support local files.</span></span>
9.  <span data-ttu-id="e13ed-135">針對包含 Win32 元件的元件，將資料列加入至 [MsiAssembly 資料表](msiassembly-table.md) 。</span><span class="sxs-lookup"><span data-stu-id="e13ed-135">Add a row to the [MsiAssembly table](msiassembly-table.md) for the component that contains the Win32 assembly.</span></span> <span data-ttu-id="e13ed-136">在 MsiAssembly 資料表的 [屬性] 欄位中輸入1的值，以指定這是 Win32 元件。</span><span class="sxs-lookup"><span data-stu-id="e13ed-136">Enter a value of 1 in the Attributes field of the MsiAssembly table to specify that this is a Win32 assembly.</span></span> <span data-ttu-id="e13ed-137">在 MsiAssembly 資料表的 [檔案應用程式] 欄位中，輸入私用元件的檔案索引鍵 \_ 。 [](msiassembly-table.md)</span><span class="sxs-lookup"><span data-stu-id="e13ed-137">Enter the file key of the private assembly in the File\_Application field of the [MsiAssembly table](msiassembly-table.md).</span></span> <span data-ttu-id="e13ed-138">將 [MsiPublishAssemblies 動作](msipublishassemblies-action.md) 加入至 [InstallExecuteSequence 資料表](installexecutesequence-table.md) 或 [AdvtExecuteSequence 資料表](advtexecutesequence-table.md)。</span><span class="sxs-lookup"><span data-stu-id="e13ed-138">Add the [MsiPublishAssemblies action](msipublishassemblies-action.md) to the [InstallExecuteSequence table](installexecutesequence-table.md) or [AdvtExecuteSequence table](advtexecutesequence-table.md).</span></span> <span data-ttu-id="e13ed-139">將 [MsiUnpublishAssemblies 動作](msiunpublishassemblies-action.md) 加入至 InstallExecuteSequence 資料表。</span><span class="sxs-lookup"><span data-stu-id="e13ed-139">Add the [MsiUnpublishAssemblies action](msiunpublishassemblies-action.md) to the InstallExecuteSequence table.</span></span> <span data-ttu-id="e13ed-140">將元件和資訊清單檔案的資料夾製作到 [目錄資料表](directory-table.md)中。</span><span class="sxs-lookup"><span data-stu-id="e13ed-140">Author a folder for the assembly and manifest file into the [Directory table](directory-table.md).</span></span> <span data-ttu-id="e13ed-141">此資料夾應該位於應用程式的根目錄中，並且包含 MsiAssembly 資料表的 [檔應用程式] 欄位中指定的檔案 \_ 。 [](msiassembly-table.md)</span><span class="sxs-lookup"><span data-stu-id="e13ed-141">This folder should be in the application's root directory and contain the file specified in the File\_Application field of the [MsiAssembly table](msiassembly-table.md).</span></span> <span data-ttu-id="e13ed-142">在應用程式安裝期間，安裝程式會解析 [目錄資料表](directory-table.md) 以取得此資料夾的路徑。</span><span class="sxs-lookup"><span data-stu-id="e13ed-142">During the installation of the application, the installer resolves the [Directory table](directory-table.md) for the path to this folder.</span></span> <span data-ttu-id="e13ed-143">如需詳細資訊，請參閱 [使用目錄資料表](using-the-directory-table.md)。</span><span class="sxs-lookup"><span data-stu-id="e13ed-143">For more information, see [Using the Directory Table](using-the-directory-table.md).</span></span>
10. <span data-ttu-id="e13ed-144">將資料列加入至元件的 [MsiAssemblyName 資料表](msiassemblyname-table.md) 。</span><span class="sxs-lookup"><span data-stu-id="e13ed-144">Add rows to the [MsiAssemblyName table](msiassemblyname-table.md) for the component.</span></span> <span data-ttu-id="e13ed-145">針對資訊清單的 assemblyIdentity 區段中指定的每個名稱和值組，各加入一個資料列。</span><span class="sxs-lookup"><span data-stu-id="e13ed-145">Add one row for each name and value pair specified in the assemblyIdentity section of the manifest.</span></span> <span data-ttu-id="e13ed-146">如需詳細資訊，請參閱 [MsiAssemblyName 資料表](msiassemblyname-table.md)。</span><span class="sxs-lookup"><span data-stu-id="e13ed-146">For more information, see [MsiAssemblyName table](msiassemblyname-table.md).</span></span>

 

 



