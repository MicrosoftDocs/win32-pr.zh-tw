---
description: 範例 PUASample.msi 是可安裝在 Windows Server 2008 R2 和 Windows 7 上個別使用者或每部電腦安裝內容中的雙重用途 Windows Installer 5.0 封裝的範例。
ms.assetid: be018e8a-ca5f-4135-a019-970ec4173f23
title: 單一套件撰寫範例
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 0e0ed56b8d7aaf8793416ba3ecab24c1f2a48ffe
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/08/2021
ms.locfileid: "107000148"
---
# <a name="single-package-authoring-example"></a><span data-ttu-id="6bdf6-103">單一套件撰寫範例</span><span class="sxs-lookup"><span data-stu-id="6bdf6-103">Single Package Authoring Example</span></span>

<span data-ttu-id="6bdf6-104">範例 PUASample.msi 是可安裝在 Windows Server 2008 R2 和 Windows 7 上個別使用者或每部電腦 [安裝內容](installation-context.md) 中的雙重用途 Windows Installer 5.0 封裝的範例。</span><span class="sxs-lookup"><span data-stu-id="6bdf6-104">The sample PUASample.msi is an example of a dual-purpose Windows Installer 5.0 package that is capable of being installed in either the per-user or per-machine [installation context](installation-context.md) on Windows Server 2008 R2 and Windows 7.</span></span> <span data-ttu-id="6bdf6-105">此範例套件遵循 [單一封裝撰寫](single-package-authoring.md)中所述的開發指導方針。</span><span class="sxs-lookup"><span data-stu-id="6bdf6-105">This sample package follows the development guidelines described in [Single Package Authoring](single-package-authoring.md).</span></span>

## <a name="obtaining-a-copy-of-the-sample"></a><span data-ttu-id="6bdf6-106">取得範例的複本</span><span class="sxs-lookup"><span data-stu-id="6bdf6-106">Obtaining a copy of the sample</span></span>

<span data-ttu-id="6bdf6-107">此範例的複本和 Windows Installer 資料庫資料表編輯器（Orca.exe）都在 [Windows Installer 開發人員的 Windows SDK 元件](platform-sdk-components-for-windows-installer-developers.md)中。</span><span class="sxs-lookup"><span data-stu-id="6bdf6-107">A copy of this sample and a Windows Installer database table editor, Orca.exe, are in the [Windows SDK Components for Windows Installer Developers](platform-sdk-components-for-windows-installer-developers.md).</span></span> <span data-ttu-id="6bdf6-108">範例和資料表編輯器隨附于 Windows Server 2008 R2 和 Windows 7 的 Windows 軟體開發套件，作為 Windows Installer 安裝檔案 PUASample1.msi 和 Orca.msi。</span><span class="sxs-lookup"><span data-stu-id="6bdf6-108">The sample and table editor are provided with the Windows Software Development Kit for Windows Server 2008 R2 and Windows 7 as the Windows Installer installation files PUASample1.msi and Orca.msi.</span></span>

## <a name="system-requirements"></a><span data-ttu-id="6bdf6-109">系統需求</span><span class="sxs-lookup"><span data-stu-id="6bdf6-109">System Requirements</span></span>

<span data-ttu-id="6bdf6-110">資料庫編輯器（ [Orca.exe](orca-exe.md)）需要 Windows Server 2008 R2 和更早版本以及 windows 7 及更早版本。</span><span class="sxs-lookup"><span data-stu-id="6bdf6-110">The database editor, [Orca.exe](orca-exe.md), requires Windows Server 2008 R2 and earlier and Windows 7 and earlier.</span></span> <span data-ttu-id="6bdf6-111">雙用途封裝（PUASample1.msi）可以安裝在 Windows Server 2008 R2 和 Windows 7 上的每部電腦或每一使用者的 [安裝內容](installation-context.md) 中。</span><span class="sxs-lookup"><span data-stu-id="6bdf6-111">The dual-purpose package, PUASample1.msi, can be installed in either the per-machine or per-user [installation context](installation-context.md) on Windows Server 2008 R2 and Windows 7.</span></span> <span data-ttu-id="6bdf6-112">PUASample1.msi 只能安裝在 Windows Server 2008 及更早版本以及 Windows Vista 及更早版本的個別電腦內容中。</span><span class="sxs-lookup"><span data-stu-id="6bdf6-112">PUASample1.msi can be installed only in the per-machine context on Windows Server 2008 and earlier and Windows Vista and earlier.</span></span> <span data-ttu-id="6bdf6-113">您可以安裝資料庫編輯器來檢查 PUASample1.msi 的內容，而不需要安裝範例。</span><span class="sxs-lookup"><span data-stu-id="6bdf6-113">You can install the database editor to examine the contents of PUASample1.msi without installing the sample.</span></span> <span data-ttu-id="6bdf6-114">若要安裝範例或編輯器套件，請確定 [DisableMSI](disablemsi.md) 原則未設定為封鎖應用程式安裝的值。</span><span class="sxs-lookup"><span data-stu-id="6bdf6-114">To install the sample or editor packages, ensure that the [DisableMSI](disablemsi.md) policy is not set to a value that blocks application installations.</span></span>

## <a name="identifying-a-dual-purpose-package"></a><span data-ttu-id="6bdf6-115">識別 Dual-Purpose 套件</span><span class="sxs-lookup"><span data-stu-id="6bdf6-115">Identifying a Dual-Purpose Package</span></span>

<span data-ttu-id="6bdf6-116">雙用途封裝應該將 [**MSIINSTALLPERUSER**](msiinstallperuser.md) 屬性的值初始化為1。</span><span class="sxs-lookup"><span data-stu-id="6bdf6-116">Dual-purpose packages should initialize the value of the [**MSIINSTALLPERUSER**](msiinstallperuser.md) property to 1.</span></span> <span data-ttu-id="6bdf6-117">這會將套件識別為可安裝在 Windows Server 2008 R2 和 Windows 7 上的每部電腦或每一使用者內容中。</span><span class="sxs-lookup"><span data-stu-id="6bdf6-117">This identifies the package as capable of being installed in either the per-machine or per-user context on Windows Server 2008 R2 and Windows 7.</span></span> <span data-ttu-id="6bdf6-118">只有在撰寫 [單一套件](single-package-authoring.md)時所述的開發指導方針，以及您想要為使用者提供可選擇在每個使用者或每一電腦的內容中安裝封裝的選項時，才在封裝中設定 **MSIINSTALLPERUSER** 屬性。</span><span class="sxs-lookup"><span data-stu-id="6bdf6-118">Set the **MSIINSTALLPERUSER** property in the package only if it has been written following the development guidelines described in [Single Package Authoring](single-package-authoring.md) and if you intend to provide users with the option to install the package in either the per-user or per-machine context.</span></span> <span data-ttu-id="6bdf6-119">雙用途封裝也應該將 [**ALLUSERS**](allusers.md) 屬性的值初始化為2。</span><span class="sxs-lookup"><span data-stu-id="6bdf6-119">A dual-purpose package should also initialize the value of the [**ALLUSERS**](allusers.md) property to 2.</span></span> <span data-ttu-id="6bdf6-120">這會將每位使用者指定為應用程式的預設安裝內容。</span><span class="sxs-lookup"><span data-stu-id="6bdf6-120">This specifies per-user as the default installation context for the application.</span></span> <span data-ttu-id="6bdf6-121">如果 **ALLUSERS** 屬性的值是2以外的任何值，Windows Installer 會忽略 **MSIINSTALLPERUSER** 屬性。</span><span class="sxs-lookup"><span data-stu-id="6bdf6-121">If the value of the **ALLUSERS** property is any value other than 2, Windows Installer ignores the **MSIINSTALLPERUSER** property.</span></span>

<span data-ttu-id="6bdf6-122">使用 Windows Installer 資料庫編輯器（例如 [Orca.exe](orca-exe.md)）來檢查 PUASample1.msi 的內容。</span><span class="sxs-lookup"><span data-stu-id="6bdf6-122">Use a Windows Installer database editor, such as [Orca.exe](orca-exe.md), to examine the contents of PUASample1.msi.</span></span> <span data-ttu-id="6bdf6-123">範例封裝中的 [屬性](property-table.md) 表包含下列兩個專案。</span><span class="sxs-lookup"><span data-stu-id="6bdf6-123">The [Property](property-table.md) table in the sample package contains the following two entries.</span></span>

<span data-ttu-id="6bdf6-124">[屬性](property-table.md) 資料表 (部分) </span><span class="sxs-lookup"><span data-stu-id="6bdf6-124">[Property](property-table.md) Table (partial)</span></span>

| <span data-ttu-id="6bdf6-125">屬性</span><span class="sxs-lookup"><span data-stu-id="6bdf6-125">Property</span></span>          | <span data-ttu-id="6bdf6-126">值</span><span class="sxs-lookup"><span data-stu-id="6bdf6-126">Value</span></span> |
|-------------------|-------|
| <span data-ttu-id="6bdf6-127">ALLUSERS</span><span class="sxs-lookup"><span data-stu-id="6bdf6-127">ALLUSERS</span></span>          | <span data-ttu-id="6bdf6-128">2</span><span class="sxs-lookup"><span data-stu-id="6bdf6-128">2</span></span>     |
| <span data-ttu-id="6bdf6-129">MSIINSTALLPERUSER</span><span class="sxs-lookup"><span data-stu-id="6bdf6-129">MSIINSTALLPERUSER</span></span> | <span data-ttu-id="6bdf6-130">1</span><span class="sxs-lookup"><span data-stu-id="6bdf6-130">1</span></span>     |



 

## <a name="custom-dialog-box-for-installation-context"></a><span data-ttu-id="6bdf6-131">安裝內容的自訂對話方塊</span><span class="sxs-lookup"><span data-stu-id="6bdf6-131">Custom Dialog Box for Installation Context</span></span>

<span data-ttu-id="6bdf6-132">範例套件的 [使用者介面](user-interface.md) 包含自訂對話方塊 VerifyReadyDialog 的範例，可讓使用者在安裝時選取每位使用者或每部電腦的安裝內容。</span><span class="sxs-lookup"><span data-stu-id="6bdf6-132">The [user interface](user-interface.md) of the sample package includes an example of a custom dialog box, VerifyReadyDialog, that enables users to select either the per-user or per-machine installation context at installation time.</span></span> <span data-ttu-id="6bdf6-133">[對話方塊](dialog-table.md)資料表包含描述 VerifyReadyDialog 對話方塊的記錄。</span><span class="sxs-lookup"><span data-stu-id="6bdf6-133">The [Dialog](dialog-table.md) table contains a record that describes the VerifyReadyDialog dialog box.</span></span> <span data-ttu-id="6bdf6-134">在 [屬性] 欄位中輸入的值為39，因為此對話方塊使用 msidbDialogAttributesVisible (1) 、msidbDialogAttributesModal (2) 、msidbDialogAttributesMinimize (4) 和 msidbDialogAttributesTrackDiskSpace (32) [對話方塊樣式位](dialog-style-bits.md)。</span><span class="sxs-lookup"><span data-stu-id="6bdf6-134">The value entered in the Attributes field is 39 because this dialog box uses the msidbDialogAttributesVisible (1), msidbDialogAttributesModal (2), msidbDialogAttributesMinimize (4), and msidbDialogAttributesTrackDiskSpace (32) [dialog style bits](dialog-style-bits.md).</span></span> <span data-ttu-id="6bdf6-135">對話方塊的標題列會顯示 [ [**ProductName**](productname.md) ] 屬性值所提供的標題。</span><span class="sxs-lookup"><span data-stu-id="6bdf6-135">The title bar of the dialog box displays a title given by the value of the [**ProductName**](productname.md) property.</span></span>

<span data-ttu-id="6bdf6-136">[對話方塊](dialog-table.md) 資料表 (部分) </span><span class="sxs-lookup"><span data-stu-id="6bdf6-136">[Dialog](dialog-table.md) Table (partial)</span></span> 

| <span data-ttu-id="6bdf6-137">對話</span><span class="sxs-lookup"><span data-stu-id="6bdf6-137">Dialog</span></span>            | <span data-ttu-id="6bdf6-138">HCentering</span><span class="sxs-lookup"><span data-stu-id="6bdf6-138">HCentering</span></span> | <span data-ttu-id="6bdf6-139">VCentering</span><span class="sxs-lookup"><span data-stu-id="6bdf6-139">VCentering</span></span> | <span data-ttu-id="6bdf6-140">寬度</span><span class="sxs-lookup"><span data-stu-id="6bdf6-140">Width</span></span> | <span data-ttu-id="6bdf6-141">高度</span><span class="sxs-lookup"><span data-stu-id="6bdf6-141">Height</span></span> | <span data-ttu-id="6bdf6-142">屬性</span><span class="sxs-lookup"><span data-stu-id="6bdf6-142">Attributes</span></span> | <span data-ttu-id="6bdf6-143">標題</span><span class="sxs-lookup"><span data-stu-id="6bdf6-143">Title</span></span>           | <span data-ttu-id="6bdf6-144">\_先控制項</span><span class="sxs-lookup"><span data-stu-id="6bdf6-144">Control\_First</span></span> | <span data-ttu-id="6bdf6-145">控制項 \_ 預設值</span><span class="sxs-lookup"><span data-stu-id="6bdf6-145">Control\_Default</span></span> | <span data-ttu-id="6bdf6-146">控制 \_ 取消</span><span class="sxs-lookup"><span data-stu-id="6bdf6-146">Control\_Cancel</span></span> |
|-------------------|------------|------------|-------|--------|------------|-----------------|----------------|------------------|-----------------|
| <span data-ttu-id="6bdf6-147">VerifyReadyDialog</span><span class="sxs-lookup"><span data-stu-id="6bdf6-147">VerifyReadyDialog</span></span> | <span data-ttu-id="6bdf6-148">50</span><span class="sxs-lookup"><span data-stu-id="6bdf6-148">50</span></span>         | <span data-ttu-id="6bdf6-149">50</span><span class="sxs-lookup"><span data-stu-id="6bdf6-149">50</span></span>         | <span data-ttu-id="6bdf6-150">480</span><span class="sxs-lookup"><span data-stu-id="6bdf6-150">480</span></span>   | <span data-ttu-id="6bdf6-151">280</span><span class="sxs-lookup"><span data-stu-id="6bdf6-151">280</span></span>    | <span data-ttu-id="6bdf6-152">39</span><span class="sxs-lookup"><span data-stu-id="6bdf6-152">39</span></span>         | <span data-ttu-id="6bdf6-153">\[ProductName\]</span><span class="sxs-lookup"><span data-stu-id="6bdf6-153">\[ProductName\]</span></span> | <span data-ttu-id="6bdf6-154">InstallPerUser</span><span class="sxs-lookup"><span data-stu-id="6bdf6-154">InstallPerUser</span></span> | <span data-ttu-id="6bdf6-155">下一個</span><span class="sxs-lookup"><span data-stu-id="6bdf6-155">Next</span></span>             | <span data-ttu-id="6bdf6-156">取消</span><span class="sxs-lookup"><span data-stu-id="6bdf6-156">Cancel</span></span>          |



 

<span data-ttu-id="6bdf6-157">[控制](control-table.md)表格包含 [VerifyReadyDialog] 對話方塊所顯示的[控制項](controls.md)專案。</span><span class="sxs-lookup"><span data-stu-id="6bdf6-157">The [Control](control-table.md) table contains entries for the [controls](controls.md) displayed by the VerifyReadyDialog dialog box.</span></span> <span data-ttu-id="6bdf6-158">對話方塊會顯示 [按鈕](pushbutton-control.md) 控制項和 [文字](text-control.md) 控制項。</span><span class="sxs-lookup"><span data-stu-id="6bdf6-158">The dialog box displays [PushButton](pushbutton-control.md) controls and a [Text](text-control.md) control.</span></span> <span data-ttu-id="6bdf6-159">所有控制項都使用 msidbControlAttributesEnabled (2) ，而 msidbControlAttributesVisible (1) [控制項屬性](control-attributes.md)。</span><span class="sxs-lookup"><span data-stu-id="6bdf6-159">All the controls use the msidbControlAttributesEnabled (2) and msidbControlAttributesVisible (1) [control attributes](control-attributes.md).</span></span> <span data-ttu-id="6bdf6-160">InstallPerMachine 控制項也會使用 [ElevationShield](elevationshield-attribute.md) 控制項屬性 msidbControlAttributesElevationShield (8388608。 ) 此控制項屬性會將 [ [*使用者帳戶控制*](u-gly.md) ] (UAC) 提高許可權圖示 (至 InstallPerMachine 控制項，並通知使用者必須要有 uac 認證，才能將應用程式安裝在每部電腦的內容中。</span><span class="sxs-lookup"><span data-stu-id="6bdf6-160">The InstallPerMachine control also uses the [ElevationShield](elevationshield-attribute.md) control attribute, msidbControlAttributesElevationShield (8388608.) This control attribute adds the [*User Account Control*](u-gly.md) (UAC) elevation icon (shield icon) to the InstallPerMachine control and informs the user that UAC credentials are required to install the application in the per-machine context.</span></span> <span data-ttu-id="6bdf6-161">控制資料表文字欄位中的值是控制項所顯示的文字樣式和文字。</span><span class="sxs-lookup"><span data-stu-id="6bdf6-161">The value in the Text field of the Control table is the text-style and text displayed by the control.</span></span> <span data-ttu-id="6bdf6-162">如需使用預先定義樣式將文字新增至控制項的詳細資訊，請參閱控制資料表主題中文字欄位的描述。</span><span class="sxs-lookup"><span data-stu-id="6bdf6-162">See the description of the Text field in the Control table topic for more information about adding text to a control using predefined styles.</span></span>

<span data-ttu-id="6bdf6-163">[控制項](control-table.md) 資料表 (部分) </span><span class="sxs-lookup"><span data-stu-id="6bdf6-163">[Control](control-table.md) Table (partial)</span></span>

| <span data-ttu-id="6bdf6-164">對話\_</span><span class="sxs-lookup"><span data-stu-id="6bdf6-164">Dialog\_</span></span>          | <span data-ttu-id="6bdf6-165">控制</span><span class="sxs-lookup"><span data-stu-id="6bdf6-165">Control</span></span>           | <span data-ttu-id="6bdf6-166">類型</span><span class="sxs-lookup"><span data-stu-id="6bdf6-166">Type</span></span>       | <span data-ttu-id="6bdf6-167">屬性</span><span class="sxs-lookup"><span data-stu-id="6bdf6-167">Attribute</span></span> | <span data-ttu-id="6bdf6-168">Text</span><span class="sxs-lookup"><span data-stu-id="6bdf6-168">Text</span></span>                                                   | <span data-ttu-id="6bdf6-169">控制 \_ 下一步</span><span class="sxs-lookup"><span data-stu-id="6bdf6-169">Control\_Next</span></span>     |
|-------------------|-------------------|------------|-----------|--------------------------------------------------------|-------------------|
| <span data-ttu-id="6bdf6-170">VerifyReadyDialog</span><span class="sxs-lookup"><span data-stu-id="6bdf6-170">VerifyReadyDialog</span></span> | <span data-ttu-id="6bdf6-171">取消</span><span class="sxs-lookup"><span data-stu-id="6bdf6-171">Cancel</span></span>            | <span data-ttu-id="6bdf6-172">按鈕</span><span class="sxs-lookup"><span data-stu-id="6bdf6-172">PushButton</span></span> | <span data-ttu-id="6bdf6-173">3</span><span class="sxs-lookup"><span data-stu-id="6bdf6-173">3</span></span>         | <span data-ttu-id="6bdf6-174">{ \\ Tahoma10} &取消</span><span class="sxs-lookup"><span data-stu-id="6bdf6-174">{\\Tahoma10}&Cancel</span></span>                                    | <span data-ttu-id="6bdf6-175">下一個</span><span class="sxs-lookup"><span data-stu-id="6bdf6-175">Next</span></span>              |
| <span data-ttu-id="6bdf6-176">VerifyReadyDialog</span><span class="sxs-lookup"><span data-stu-id="6bdf6-176">VerifyReadyDialog</span></span> | <span data-ttu-id="6bdf6-177">上一個</span><span class="sxs-lookup"><span data-stu-id="6bdf6-177">Previous</span></span>          | <span data-ttu-id="6bdf6-178">按鈕</span><span class="sxs-lookup"><span data-stu-id="6bdf6-178">PushButton</span></span> | <span data-ttu-id="6bdf6-179">3</span><span class="sxs-lookup"><span data-stu-id="6bdf6-179">3</span></span>         | <span data-ttu-id="6bdf6-180">{ \\ Tahoma10} <<&上一個</span><span class="sxs-lookup"><span data-stu-id="6bdf6-180">{\\Tahoma10}<<&Previous</span></span>                          | <span data-ttu-id="6bdf6-181">取消</span><span class="sxs-lookup"><span data-stu-id="6bdf6-181">Cancel</span></span>            |
| <span data-ttu-id="6bdf6-182">VerifyReadyDialog</span><span class="sxs-lookup"><span data-stu-id="6bdf6-182">VerifyReadyDialog</span></span> | <span data-ttu-id="6bdf6-183">下一個</span><span class="sxs-lookup"><span data-stu-id="6bdf6-183">Next</span></span>              | <span data-ttu-id="6bdf6-184">按鈕</span><span class="sxs-lookup"><span data-stu-id="6bdf6-184">PushButton</span></span> | <span data-ttu-id="6bdf6-185">3</span><span class="sxs-lookup"><span data-stu-id="6bdf6-185">3</span></span>         | <span data-ttu-id="6bdf6-186">{ \\ Tahoma10} &下一個 >></span><span class="sxs-lookup"><span data-stu-id="6bdf6-186">{\\Tahoma10}&Next >></span></span>                             | <span data-ttu-id="6bdf6-187">InstallPerUser</span><span class="sxs-lookup"><span data-stu-id="6bdf6-187">InstallPerUser</span></span>    |
| <span data-ttu-id="6bdf6-188">VerifyReadyDialog</span><span class="sxs-lookup"><span data-stu-id="6bdf6-188">VerifyReadyDialog</span></span> | <span data-ttu-id="6bdf6-189">Text2</span><span class="sxs-lookup"><span data-stu-id="6bdf6-189">Text2</span></span>             | <span data-ttu-id="6bdf6-190">Text</span><span class="sxs-lookup"><span data-stu-id="6bdf6-190">Text</span></span>       | <span data-ttu-id="6bdf6-191">3</span><span class="sxs-lookup"><span data-stu-id="6bdf6-191">3</span></span>         | <span data-ttu-id="6bdf6-192">您是否準備好完成暫停的安裝？</span><span class="sxs-lookup"><span data-stu-id="6bdf6-192">Are you ready to complete your suspended installation?</span></span> |                   |
| <span data-ttu-id="6bdf6-193">VerifyReadyDialog</span><span class="sxs-lookup"><span data-stu-id="6bdf6-193">VerifyReadyDialog</span></span> | <span data-ttu-id="6bdf6-194">InstallPerUser</span><span class="sxs-lookup"><span data-stu-id="6bdf6-194">InstallPerUser</span></span>    | <span data-ttu-id="6bdf6-195">按鈕</span><span class="sxs-lookup"><span data-stu-id="6bdf6-195">PushButton</span></span> | <span data-ttu-id="6bdf6-196">3</span><span class="sxs-lookup"><span data-stu-id="6bdf6-196">3</span></span>         | <span data-ttu-id="6bdf6-197">{ \\ Tahoma10} 僅針對 &我安裝</span><span class="sxs-lookup"><span data-stu-id="6bdf6-197">{\\Tahoma10}Install Only for &Me</span></span>                       | <span data-ttu-id="6bdf6-198">InstallPerMachine</span><span class="sxs-lookup"><span data-stu-id="6bdf6-198">InstallPerMachine</span></span> |
| <span data-ttu-id="6bdf6-199">VerifyReadyDialog</span><span class="sxs-lookup"><span data-stu-id="6bdf6-199">VerifyReadyDialog</span></span> | <span data-ttu-id="6bdf6-200">InstallPerMachine</span><span class="sxs-lookup"><span data-stu-id="6bdf6-200">InstallPerMachine</span></span> | <span data-ttu-id="6bdf6-201">按鈕</span><span class="sxs-lookup"><span data-stu-id="6bdf6-201">PushButton</span></span> | <span data-ttu-id="6bdf6-202">8388611</span><span class="sxs-lookup"><span data-stu-id="6bdf6-202">8388611</span></span>   | <span data-ttu-id="6bdf6-203">{ \\ Tahoma10} 為每個人 &安裝</span><span class="sxs-lookup"><span data-stu-id="6bdf6-203">{\\Tahoma10}Install for &Everyone</span></span>                      | <span data-ttu-id="6bdf6-204">上一個</span><span class="sxs-lookup"><span data-stu-id="6bdf6-204">Previous</span></span>          |
| <span data-ttu-id="6bdf6-205">VerifyReadyDialog</span><span class="sxs-lookup"><span data-stu-id="6bdf6-205">VerifyReadyDialog</span></span> | <span data-ttu-id="6bdf6-206">取消</span><span class="sxs-lookup"><span data-stu-id="6bdf6-206">Cancel</span></span>            | <span data-ttu-id="6bdf6-207">按鈕</span><span class="sxs-lookup"><span data-stu-id="6bdf6-207">PushButton</span></span> | <span data-ttu-id="6bdf6-208">3</span><span class="sxs-lookup"><span data-stu-id="6bdf6-208">3</span></span>         | <span data-ttu-id="6bdf6-209">{ \\ Tahoma10} &取消</span><span class="sxs-lookup"><span data-stu-id="6bdf6-209">{\\Tahoma10}&Cancel</span></span>                                    | <span data-ttu-id="6bdf6-210">下一個</span><span class="sxs-lookup"><span data-stu-id="6bdf6-210">Next</span></span>              |



 

<span data-ttu-id="6bdf6-211">[ControlEvent](controlevent-table.md)資料表會指定使用者與控制項互動時，安裝程式所執行的[事件](control-events.md)（或動作）。</span><span class="sxs-lookup"><span data-stu-id="6bdf6-211">The [ControlEvent](controlevent-table.md) table specifies the [ControlEvents](control-events.md), or actions, the installer performs when the user interacts with a control.</span></span> <span data-ttu-id="6bdf6-212">當使用者啟動 InstallPerUser 按鈕時，如果 [**OutOfDiskSpace**](outofdiskspace.md) 屬性為1，使用者介面會顯示 [OutOfDisk] 對話方塊，將 [ [**MSIINSTALLPERUSER**](msiinstallperuser.md) ] 屬性的值設定為1，將 [**ALLUSERS**](allusers.md) 屬性的值設定為 [2]，將 [ [**MSIFASTINSTALL**](msifastinstall.md) ] 屬性設定為1，然後傳回。</span><span class="sxs-lookup"><span data-stu-id="6bdf6-212">When a user activates the InstallPerUser pushbutton, the user interface displays an OutOfDisk dialog box if the [**OutOfDiskSpace**](outofdiskspace.md) property is 1, sets the value of the [**MSIINSTALLPERUSER**](msiinstallperuser.md) property to 1, sets the value of the [**ALLUSERS**](allusers.md) property to 2, sets the [**MSIFASTINSTALL**](msifastinstall.md) property to 1, and returns .</span></span> <span data-ttu-id="6bdf6-213">因為已設定 **MSIFASTINSTALL** 屬性，所以不會針對安裝產生任何系統還原點。</span><span class="sxs-lookup"><span data-stu-id="6bdf6-213">Because the **MSIFASTINSTALL** property is set, no System Restore point is generated for the installation.</span></span> <span data-ttu-id="6bdf6-214">當使用者啟動 InstallPerMachine 按鈕時，如果 **OutOfDiskSpace** 屬性為1，使用者介面會顯示 [OutOfDisk] 對話方塊，將 **ALLUSERS** 屬性的值設定為1，然後傳回。</span><span class="sxs-lookup"><span data-stu-id="6bdf6-214">When a user activates the InstallPerMachine pushbutton, the user interface displays an OutOfDisk dialog box if the **OutOfDiskSpace** property is 1, sets the value of the **ALLUSERS** property to 1, and returns.</span></span>

<span data-ttu-id="6bdf6-215">[ControlEvent](controlevent-table.md) 資料表 (部分) </span><span class="sxs-lookup"><span data-stu-id="6bdf6-215">[ControlEvent](controlevent-table.md) Table (partial)</span></span> 

| <span data-ttu-id="6bdf6-216">對話\_</span><span class="sxs-lookup"><span data-stu-id="6bdf6-216">Dialog\_</span></span>          | <span data-ttu-id="6bdf6-217">控制項\_</span><span class="sxs-lookup"><span data-stu-id="6bdf6-217">Control\_</span></span>         | <span data-ttu-id="6bdf6-218">事件</span><span class="sxs-lookup"><span data-stu-id="6bdf6-218">Event</span></span>                 | <span data-ttu-id="6bdf6-219">引數</span><span class="sxs-lookup"><span data-stu-id="6bdf6-219">Argument</span></span>  | <span data-ttu-id="6bdf6-220">條件</span><span class="sxs-lookup"><span data-stu-id="6bdf6-220">Condition</span></span>                 | <span data-ttu-id="6bdf6-221">單</span><span class="sxs-lookup"><span data-stu-id="6bdf6-221">Order</span></span> |
|-------------------|-------------------|-----------------------|-----------|---------------------------|-------|
| <span data-ttu-id="6bdf6-222">VerifyReadyDialog</span><span class="sxs-lookup"><span data-stu-id="6bdf6-222">VerifyReadyDialog</span></span> | <span data-ttu-id="6bdf6-223">InstallPerUser</span><span class="sxs-lookup"><span data-stu-id="6bdf6-223">InstallPerUser</span></span>    | <span data-ttu-id="6bdf6-224">SpawnDialog</span><span class="sxs-lookup"><span data-stu-id="6bdf6-224">SpawnDialog</span></span>           | <span data-ttu-id="6bdf6-225">OutOfDisk</span><span class="sxs-lookup"><span data-stu-id="6bdf6-225">OutOfDisk</span></span> | <span data-ttu-id="6bdf6-226">OutOfDiskSpace = 1</span><span class="sxs-lookup"><span data-stu-id="6bdf6-226">OutOfDiskSpace = 1</span></span>        | <span data-ttu-id="6bdf6-227">1</span><span class="sxs-lookup"><span data-stu-id="6bdf6-227">1</span></span>     |
| <span data-ttu-id="6bdf6-228">VerifyReadyDialog</span><span class="sxs-lookup"><span data-stu-id="6bdf6-228">VerifyReadyDialog</span></span> | <span data-ttu-id="6bdf6-229">InstallPerUser</span><span class="sxs-lookup"><span data-stu-id="6bdf6-229">InstallPerUser</span></span>    | <span data-ttu-id="6bdf6-230">EndDialog</span><span class="sxs-lookup"><span data-stu-id="6bdf6-230">EndDialog</span></span>             | <span data-ttu-id="6bdf6-231">傳回</span><span class="sxs-lookup"><span data-stu-id="6bdf6-231">Return</span></span>    | <span data-ttu-id="6bdf6-232">OutOfDiskSpace <> 1</span><span class="sxs-lookup"><span data-stu-id="6bdf6-232">OutOfDiskSpace <> 1</span></span> | <span data-ttu-id="6bdf6-233">5</span><span class="sxs-lookup"><span data-stu-id="6bdf6-233">5</span></span>     |
| <span data-ttu-id="6bdf6-234">VerifyReadyDialog</span><span class="sxs-lookup"><span data-stu-id="6bdf6-234">VerifyReadyDialog</span></span> | <span data-ttu-id="6bdf6-235">InstallPerUser</span><span class="sxs-lookup"><span data-stu-id="6bdf6-235">InstallPerUser</span></span>    | <span data-ttu-id="6bdf6-236">\[MSIINSTALLPERUSER\]</span><span class="sxs-lookup"><span data-stu-id="6bdf6-236">\[MSIINSTALLPERUSER\]</span></span> | <span data-ttu-id="6bdf6-237">1</span><span class="sxs-lookup"><span data-stu-id="6bdf6-237">1</span></span>         | <span data-ttu-id="6bdf6-238">1</span><span class="sxs-lookup"><span data-stu-id="6bdf6-238">1</span></span>                         | <span data-ttu-id="6bdf6-239">2</span><span class="sxs-lookup"><span data-stu-id="6bdf6-239">2</span></span>     |
| <span data-ttu-id="6bdf6-240">VerifyReadyDialog</span><span class="sxs-lookup"><span data-stu-id="6bdf6-240">VerifyReadyDialog</span></span> | <span data-ttu-id="6bdf6-241">InstallPerUser</span><span class="sxs-lookup"><span data-stu-id="6bdf6-241">InstallPerUser</span></span>    | <span data-ttu-id="6bdf6-242">\[ALLUSERS\]</span><span class="sxs-lookup"><span data-stu-id="6bdf6-242">\[ALLUSERS\]</span></span>          | <span data-ttu-id="6bdf6-243">2</span><span class="sxs-lookup"><span data-stu-id="6bdf6-243">2</span></span>         | <span data-ttu-id="6bdf6-244">1</span><span class="sxs-lookup"><span data-stu-id="6bdf6-244">1</span></span>                         | <span data-ttu-id="6bdf6-245">3</span><span class="sxs-lookup"><span data-stu-id="6bdf6-245">3</span></span>     |
| <span data-ttu-id="6bdf6-246">VerifyReadyDialog</span><span class="sxs-lookup"><span data-stu-id="6bdf6-246">VerifyReadyDialog</span></span> | <span data-ttu-id="6bdf6-247">InstallPerMachine</span><span class="sxs-lookup"><span data-stu-id="6bdf6-247">InstallPerMachine</span></span> | <span data-ttu-id="6bdf6-248">SpawnDialog</span><span class="sxs-lookup"><span data-stu-id="6bdf6-248">SpawnDialog</span></span>           | <span data-ttu-id="6bdf6-249">OutOfDisk</span><span class="sxs-lookup"><span data-stu-id="6bdf6-249">OutOfDisk</span></span> | <span data-ttu-id="6bdf6-250">OutOfDiskSpace = 1</span><span class="sxs-lookup"><span data-stu-id="6bdf6-250">OutOfDiskSpace = 1</span></span>        | <span data-ttu-id="6bdf6-251">1</span><span class="sxs-lookup"><span data-stu-id="6bdf6-251">1</span></span>     |
| <span data-ttu-id="6bdf6-252">VerifyReadyDialog</span><span class="sxs-lookup"><span data-stu-id="6bdf6-252">VerifyReadyDialog</span></span> | <span data-ttu-id="6bdf6-253">InstallPerMachine</span><span class="sxs-lookup"><span data-stu-id="6bdf6-253">InstallPerMachine</span></span> | <span data-ttu-id="6bdf6-254">EndDialog</span><span class="sxs-lookup"><span data-stu-id="6bdf6-254">EndDialog</span></span>             | <span data-ttu-id="6bdf6-255">傳回</span><span class="sxs-lookup"><span data-stu-id="6bdf6-255">Return</span></span>    | <span data-ttu-id="6bdf6-256">OutOfDiskSpace <> 1</span><span class="sxs-lookup"><span data-stu-id="6bdf6-256">OutOfDiskSpace <> 1</span></span> | <span data-ttu-id="6bdf6-257">3</span><span class="sxs-lookup"><span data-stu-id="6bdf6-257">3</span></span>     |
| <span data-ttu-id="6bdf6-258">VerifyReadyDialog</span><span class="sxs-lookup"><span data-stu-id="6bdf6-258">VerifyReadyDialog</span></span> | <span data-ttu-id="6bdf6-259">InstallPerMachine</span><span class="sxs-lookup"><span data-stu-id="6bdf6-259">InstallPerMachine</span></span> | <span data-ttu-id="6bdf6-260">\[ALLUSERS\]</span><span class="sxs-lookup"><span data-stu-id="6bdf6-260">\[ALLUSERS\]</span></span>          | <span data-ttu-id="6bdf6-261">1</span><span class="sxs-lookup"><span data-stu-id="6bdf6-261">1</span></span>         | <span data-ttu-id="6bdf6-262">1</span><span class="sxs-lookup"><span data-stu-id="6bdf6-262">1</span></span>                         | <span data-ttu-id="6bdf6-263">2</span><span class="sxs-lookup"><span data-stu-id="6bdf6-263">2</span></span>     |
| <span data-ttu-id="6bdf6-264">VerifyReadyDialog</span><span class="sxs-lookup"><span data-stu-id="6bdf6-264">VerifyReadyDialog</span></span> | <span data-ttu-id="6bdf6-265">InstallPerUser</span><span class="sxs-lookup"><span data-stu-id="6bdf6-265">InstallPerUser</span></span>    | <span data-ttu-id="6bdf6-266">\[MSIFASTINSTALL\]</span><span class="sxs-lookup"><span data-stu-id="6bdf6-266">\[MSIFASTINSTALL\]</span></span>    | <span data-ttu-id="6bdf6-267">1</span><span class="sxs-lookup"><span data-stu-id="6bdf6-267">1</span></span>         | <span data-ttu-id="6bdf6-268">1</span><span class="sxs-lookup"><span data-stu-id="6bdf6-268">1</span></span>                         | <span data-ttu-id="6bdf6-269">4</span><span class="sxs-lookup"><span data-stu-id="6bdf6-269">4</span></span>     |



 

<span data-ttu-id="6bdf6-270">InstallPerUser 控制項應從任何安裝的使用者介面中移除，其使用早于 Windows Installer Windows Installer 5.0 的 Windows Installer 版本。</span><span class="sxs-lookup"><span data-stu-id="6bdf6-270">The InstallPerUser control should be removed from the user interface of any installation using a Windows Installer version earlier than Windows Installer Windows Installer 5.0.</span></span> <span data-ttu-id="6bdf6-271">範例封裝中的 [ControlCondition](controlcondition-table.md) 資料表包含四個專案，如果目前的版本小於 Windows Installer 5.0，則會停用並隱藏 InstallPerUser 控制項。</span><span class="sxs-lookup"><span data-stu-id="6bdf6-271">The [ControlCondition](controlcondition-table.md) table in the sample package contains four entries that disable and hide the InstallPerUser control if the current version is less than Windows Installer 5.0.</span></span> <span data-ttu-id="6bdf6-272">資料表會使用 [**VersionMsi**](versionmsi.md) 屬性的值和 [條件陳述式語法](conditional-statement-syntax.md) 來定義此條件。</span><span class="sxs-lookup"><span data-stu-id="6bdf6-272">The table uses the value of the [**VersionMsi**](versionmsi.md) property and the [conditional statement syntax](conditional-statement-syntax.md) to define this condition.</span></span> <span data-ttu-id="6bdf6-273">只有當條件欄位中的語句為 true 時，才會執行 [動作] 欄位中指定的動作。</span><span class="sxs-lookup"><span data-stu-id="6bdf6-273">The action specified in the Action field is performed only if the statement in the Condition field is true.</span></span>

<span data-ttu-id="6bdf6-274">[ControlCondition](controlcondition-table.md) 資料表 (部分) </span><span class="sxs-lookup"><span data-stu-id="6bdf6-274">[ControlCondition](controlcondition-table.md) Table (partial)</span></span>

| <span data-ttu-id="6bdf6-275">對話\_</span><span class="sxs-lookup"><span data-stu-id="6bdf6-275">Dialog\_</span></span>          | <span data-ttu-id="6bdf6-276">控制項\_</span><span class="sxs-lookup"><span data-stu-id="6bdf6-276">Control\_</span></span>      | <span data-ttu-id="6bdf6-277">動作</span><span class="sxs-lookup"><span data-stu-id="6bdf6-277">Action</span></span>  | <span data-ttu-id="6bdf6-278">條件</span><span class="sxs-lookup"><span data-stu-id="6bdf6-278">Condition</span></span>               |
|-------------------|----------------|---------|-------------------------|
| <span data-ttu-id="6bdf6-279">VerifyReadyDialog</span><span class="sxs-lookup"><span data-stu-id="6bdf6-279">VerifyReadyDialog</span></span> | <span data-ttu-id="6bdf6-280">InstallPerUser</span><span class="sxs-lookup"><span data-stu-id="6bdf6-280">InstallPerUser</span></span> | <span data-ttu-id="6bdf6-281">啟用</span><span class="sxs-lookup"><span data-stu-id="6bdf6-281">Enable</span></span>  | <span data-ttu-id="6bdf6-282">VersionMsi >= "5.00"</span><span class="sxs-lookup"><span data-stu-id="6bdf6-282">VersionMsi >= "5.00"</span></span> |
| <span data-ttu-id="6bdf6-283">VerifyReadyDialog</span><span class="sxs-lookup"><span data-stu-id="6bdf6-283">VerifyReadyDialog</span></span> | <span data-ttu-id="6bdf6-284">InstallPerUser</span><span class="sxs-lookup"><span data-stu-id="6bdf6-284">InstallPerUser</span></span> | <span data-ttu-id="6bdf6-285">停用</span><span class="sxs-lookup"><span data-stu-id="6bdf6-285">Disable</span></span> | <span data-ttu-id="6bdf6-286">VersionMsi < "5.00"</span><span class="sxs-lookup"><span data-stu-id="6bdf6-286">VersionMsi < "5.00"</span></span>  |
| <span data-ttu-id="6bdf6-287">VerifyReadyDialog</span><span class="sxs-lookup"><span data-stu-id="6bdf6-287">VerifyReadyDialog</span></span> | <span data-ttu-id="6bdf6-288">InstallPerUser</span><span class="sxs-lookup"><span data-stu-id="6bdf6-288">InstallPerUser</span></span> | <span data-ttu-id="6bdf6-289">顯示</span><span class="sxs-lookup"><span data-stu-id="6bdf6-289">Show</span></span>    | <span data-ttu-id="6bdf6-290">VersionMsi >= "5.00"</span><span class="sxs-lookup"><span data-stu-id="6bdf6-290">VersionMsi >= "5.00"</span></span> |
| <span data-ttu-id="6bdf6-291">VerifyReadyDialog</span><span class="sxs-lookup"><span data-stu-id="6bdf6-291">VerifyReadyDialog</span></span> | <span data-ttu-id="6bdf6-292">InstallPerUser</span><span class="sxs-lookup"><span data-stu-id="6bdf6-292">InstallPerUser</span></span> | <span data-ttu-id="6bdf6-293">隱藏</span><span class="sxs-lookup"><span data-stu-id="6bdf6-293">Hide</span></span>    | <span data-ttu-id="6bdf6-294">VersionMsi < "5.00"</span><span class="sxs-lookup"><span data-stu-id="6bdf6-294">VersionMsi < "5.00"</span></span>  |



 

## <a name="specifying-directory-structure"></a><span data-ttu-id="6bdf6-295">指定目錄結構</span><span class="sxs-lookup"><span data-stu-id="6bdf6-295">Specifying Directory Structure</span></span>

<span data-ttu-id="6bdf6-296">使用資料庫編輯器來檢查 PUASample1.msi 的 [目錄](directory-table.md) 資料表。</span><span class="sxs-lookup"><span data-stu-id="6bdf6-296">Use the database editor to examine the [Directory](directory-table.md) table of PUASample1.msi.</span></span> <span data-ttu-id="6bdf6-297">目錄資料表的目錄（在其目錄父欄位中具有空字串）， \_ 代表來源和目標目錄樹狀目錄的根目錄。</span><span class="sxs-lookup"><span data-stu-id="6bdf6-297">The record of the Directory Table having an empty string in its Directory\_Parent field represents the root directory of both the source and target directory trees.</span></span> <span data-ttu-id="6bdf6-298">如果未定義 [**TARGETDIR**](targetdir.md) 屬性，安裝程式會在安裝時將其值設定為 [**ROOTDRIVE**](rootdrive.md) 屬性的值。</span><span class="sxs-lookup"><span data-stu-id="6bdf6-298">If the [**TARGETDIR**](targetdir.md) property is undefined, the installer sets its value at installation time to the value of the [**ROOTDRIVE**](rootdrive.md) property.</span></span> <span data-ttu-id="6bdf6-299">如果未定義 [**SourceDir**](sourcedir.md) 屬性，安裝程式會將其值設定為包含 Windows Installer 封裝 ( .msi 檔案的目錄位置。 ) 目錄名稱是使用簡短的 \| long 格式來指定。</span><span class="sxs-lookup"><span data-stu-id="6bdf6-299">If the [**SourceDir**](sourcedir.md) property is undefined, the installer sets its value to the location of the directory containing the Windows Installer package (.msi file.) The directory names are specified using the short\|long format.</span></span>

<span data-ttu-id="6bdf6-300">[目錄](directory-table.md) 資料表 (部分) </span><span class="sxs-lookup"><span data-stu-id="6bdf6-300">[Directory](directory-table.md) Table (partial)</span></span>

| <span data-ttu-id="6bdf6-301">目錄</span><span class="sxs-lookup"><span data-stu-id="6bdf6-301">Directory</span></span>          | <span data-ttu-id="6bdf6-302">目錄 \_ 父系</span><span class="sxs-lookup"><span data-stu-id="6bdf6-302">Directory\_Parent</span></span>  | <span data-ttu-id="6bdf6-303">DefaultDir</span><span class="sxs-lookup"><span data-stu-id="6bdf6-303">DefaultDir</span></span>               |
|--------------------|--------------------|--------------------------|
| <span data-ttu-id="6bdf6-304">TARGETDIR</span><span class="sxs-lookup"><span data-stu-id="6bdf6-304">TARGETDIR</span></span>          |                    | <span data-ttu-id="6bdf6-305">SourceDir</span><span class="sxs-lookup"><span data-stu-id="6bdf6-305">SourceDir</span></span>                |
| <span data-ttu-id="6bdf6-306">ProgramFilesFolder</span><span class="sxs-lookup"><span data-stu-id="6bdf6-306">ProgramFilesFolder</span></span> | <span data-ttu-id="6bdf6-307">TARGETDIR</span><span class="sxs-lookup"><span data-stu-id="6bdf6-307">TARGETDIR</span></span>          | <span data-ttu-id="6bdf6-308">.</span><span class="sxs-lookup"><span data-stu-id="6bdf6-308">.</span></span>                        |
| <span data-ttu-id="6bdf6-309">ProgramMenuFolder</span><span class="sxs-lookup"><span data-stu-id="6bdf6-309">ProgramMenuFolder</span></span>  | <span data-ttu-id="6bdf6-310">TARGETDIR</span><span class="sxs-lookup"><span data-stu-id="6bdf6-310">TARGETDIR</span></span>          | <span data-ttu-id="6bdf6-311">.</span><span class="sxs-lookup"><span data-stu-id="6bdf6-311">.</span></span>                        |
| <span data-ttu-id="6bdf6-312">INSTALLLOCATION</span><span class="sxs-lookup"><span data-stu-id="6bdf6-312">INSTALLLOCATION</span></span>    | <span data-ttu-id="6bdf6-313">MyVendor</span><span class="sxs-lookup"><span data-stu-id="6bdf6-313">MyVendor</span></span>           | <span data-ttu-id="6bdf6-314">Sample1 \| MSDN-PUASample1</span><span class="sxs-lookup"><span data-stu-id="6bdf6-314">Sample1\|MSDN-PUASample1</span></span> |
| <span data-ttu-id="6bdf6-315">MyVendor</span><span class="sxs-lookup"><span data-stu-id="6bdf6-315">MyVendor</span></span>           | <span data-ttu-id="6bdf6-316">ProgramFilesFolder</span><span class="sxs-lookup"><span data-stu-id="6bdf6-316">ProgramFilesFolder</span></span> | <span data-ttu-id="6bdf6-317">Msft \| Microsoft</span><span class="sxs-lookup"><span data-stu-id="6bdf6-317">Msft\|Microsoft</span></span>          |



 

<span data-ttu-id="6bdf6-318">在來源，此 [目錄](directory-table.md) 資料表會解析為下列目錄路徑。</span><span class="sxs-lookup"><span data-stu-id="6bdf6-318">At the source, this [Directory](directory-table.md) table resolves to the following directory paths.</span></span>

<dl> <span data-ttu-id="6bdf6-319">\[SourceDir \] \\ Msft \\ Sample1</span><span class="sxs-lookup"><span data-stu-id="6bdf6-319">\[SourceDir\]\\Msft\\Sample1</span></span>  
<span data-ttu-id="6bdf6-320">\[SourceDir\]</span><span class="sxs-lookup"><span data-stu-id="6bdf6-320">\[SourceDir\]</span></span>  
</dl>

<span data-ttu-id="6bdf6-321">在目標上， [目錄](directory-table.md) 資料表會解析為下表中的路徑。</span><span class="sxs-lookup"><span data-stu-id="6bdf6-321">At the target, the [Directory](directory-table.md) table resolves to the paths in the following table.</span></span> <span data-ttu-id="6bdf6-322">安裝程式會將 [**ProgramFilesFolder**](programfilesfolder.md) 和 [**ProgramMenuFolder**](programmenufolder.md) 屬性的值設定為相依于 [安裝內容](installation-context.md) 的位置，以及系統是否為 Windows Server 2008 R2 和 windows 7 的32位或64位版本。</span><span class="sxs-lookup"><span data-stu-id="6bdf6-322">The installer sets the values of the [**ProgramFilesFolder**](programfilesfolder.md) and [**ProgramMenuFolder**](programmenufolder.md) properties to locations that depend upon the [installation context](installation-context.md) and whether the system is the 32-bit or 64-bit versions of Windows Server 2008 R2 and Windows 7.</span></span> <span data-ttu-id="6bdf6-323">目的檔案夾的路徑取決於使用者選取的是個別使用者或每部電腦的安裝。</span><span class="sxs-lookup"><span data-stu-id="6bdf6-323">The paths to the target folders depend on whether the user selects a per-user or per-machine installation.</span></span>

| <span data-ttu-id="6bdf6-324">安裝內容</span><span class="sxs-lookup"><span data-stu-id="6bdf6-324">Installation Context</span></span> | <span data-ttu-id="6bdf6-325">系統</span><span class="sxs-lookup"><span data-stu-id="6bdf6-325">System</span></span>                                                                              | <span data-ttu-id="6bdf6-326">範例路徑</span><span class="sxs-lookup"><span data-stu-id="6bdf6-326">Example Paths</span></span>                                                                                                                    |
|----------------------|-------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="6bdf6-327">Per-Machine</span><span class="sxs-lookup"><span data-stu-id="6bdf6-327">Per-Machine</span></span>          | <span data-ttu-id="6bdf6-328">Windows Server 2008 R2 與 Windows 7</span><span class="sxs-lookup"><span data-stu-id="6bdf6-328">Windows Server 2008 R2 and Windows 7</span></span><br/> <span data-ttu-id="6bdf6-329">32位版本</span><span class="sxs-lookup"><span data-stu-id="6bdf6-329">32-bit version</span></span><br/>           | <span data-ttu-id="6bdf6-330">% ProgramFiles% \\ Msft \\ Sample1</span><span class="sxs-lookup"><span data-stu-id="6bdf6-330">%ProgramFiles%\\Msft\\Sample1</span></span><br/> <span data-ttu-id="6bdf6-331">% ALLUSERSPROFILE% \\ Microsoft \\ Windows [ \\ 開始] 功能表 \\ 程式</span><span class="sxs-lookup"><span data-stu-id="6bdf6-331">%ALLUSERSPROFILE%\\Microsoft\\Windows\\Start Menu\\Programs</span></span><br/>                  |
| <span data-ttu-id="6bdf6-332">Per-Machine</span><span class="sxs-lookup"><span data-stu-id="6bdf6-332">Per-Machine</span></span>          | <span data-ttu-id="6bdf6-333">Windows Server 2008 R2 與 Windows 7</span><span class="sxs-lookup"><span data-stu-id="6bdf6-333">Windows Server 2008 R2 and Windows 7</span></span><br/> <span data-ttu-id="6bdf6-334">64位版本</span><span class="sxs-lookup"><span data-stu-id="6bdf6-334">64-bit version</span></span><br/>           | <span data-ttu-id="6bdf6-335">% ProgramFiles (x86) % \\ Msft \\ Sample1</span><span class="sxs-lookup"><span data-stu-id="6bdf6-335">%ProgramFiles(x86)%\\Msft\\Sample1</span></span><br/> <span data-ttu-id="6bdf6-336">% ALLUSERSPROFILE% \\ Microsoft \\ Windows [ \\ 開始] 功能表 \\ 程式</span><span class="sxs-lookup"><span data-stu-id="6bdf6-336">%ALLUSERSPROFILE%\\Microsoft\\Windows\\Start Menu\\Programs</span></span><br/>             |
| <span data-ttu-id="6bdf6-337">Per-User</span><span class="sxs-lookup"><span data-stu-id="6bdf6-337">Per-User</span></span>             | <span data-ttu-id="6bdf6-338">Windows Server 2008 R2 與 Windows 7</span><span class="sxs-lookup"><span data-stu-id="6bdf6-338">Windows Server 2008 R2 and Windows 7</span></span><br/> <span data-ttu-id="6bdf6-339">32位或64位版本</span><span class="sxs-lookup"><span data-stu-id="6bdf6-339">32-bit or 64-bit version</span></span><br/> | <span data-ttu-id="6bdf6-340">% USERPROFILE% \\ AppData \\ 本機 \\ 程式 \\ Msft \\ Sample1</span><span class="sxs-lookup"><span data-stu-id="6bdf6-340">%USERPROFILE%\\AppData\\Local\\Programs\\Msft\\Sample1</span></span><br/> <span data-ttu-id="6bdf6-341">% APPDATA% \\ Microsoft \\ Windows [ \\ 開始] 功能表 \\ 程式</span><span class="sxs-lookup"><span data-stu-id="6bdf6-341">%APPDATA%\\Microsoft\\Windows\\Start Menu\\Programs</span></span><br/> |



 

<span data-ttu-id="6bdf6-342">每個使用者的應用程式應該儲存在 [**ProgramFilesFolder**](programfilesfolder.md) 屬性值所指定的 [程式] 資料夾下的子資料夾中。</span><span class="sxs-lookup"><span data-stu-id="6bdf6-342">Per-user applications should be stored in subfolders under the Programs folder specified by the value of [**ProgramFilesFolder**](programfilesfolder.md) property.</span></span> <span data-ttu-id="6bdf6-343">一般而言，應用程式的路徑會採用下列格式。</span><span class="sxs-lookup"><span data-stu-id="6bdf6-343">Typically, the path to the application takes the following form.</span></span>

<span data-ttu-id="6bdf6-344">% LOCALAPPDATA% \\ 程式 \\ *ISV 名稱* \\ *AppName*。</span><span class="sxs-lookup"><span data-stu-id="6bdf6-344">%LOCALAPPDATA%\\Programs\\*ISV name*\\*AppName*.</span></span>

<span data-ttu-id="6bdf6-345">每個使用者的設定資料應儲存在 [**ProgramMenuFolder**](programmenufolder.md) 屬性值所指定的 [程式] 資料夾中。</span><span class="sxs-lookup"><span data-stu-id="6bdf6-345">Per-user configuration data should be stored in the Programs folder specified by the value of the [**ProgramMenuFolder**](programmenufolder.md) property.</span></span> <span data-ttu-id="6bdf6-346">此資料夾通常位於下列路徑。</span><span class="sxs-lookup"><span data-stu-id="6bdf6-346">Typically, this folder is located at the following path.</span></span>

<span data-ttu-id="6bdf6-347">% APPDATA% \\ Microsoft \\ Windows [ \\ 開始] 功能表 \\ 程式</span><span class="sxs-lookup"><span data-stu-id="6bdf6-347">%APPDATA%\\Microsoft\\Windows\\Start Menu\\Programs</span></span>

<span data-ttu-id="6bdf6-348">如果安裝 [32 位 Windows Installer 封裝](32-bit-windows-installer-packages.md)元件，請使用 [目錄](directory-table.md)資料表中的 [**ProgramFilesFolder**](programfilesfolder.md)和 [**CommonFilesFolder**](commonfilesfolder.md)屬性。</span><span class="sxs-lookup"><span data-stu-id="6bdf6-348">If installing [32-bit Windows Installer Package](32-bit-windows-installer-packages.md) components, use the [**ProgramFilesFolder**](programfilesfolder.md) and [**CommonFilesFolder**](commonfilesfolder.md) property in the [Directory](directory-table.md) table.</span></span> <span data-ttu-id="6bdf6-349">如果要安裝 [64 位 Windows Installer 套件](64-bit-windows-installer-packages.md) 元件，請使用 [**ProgramFiles64Folder**](programfiles64folder.md) 和 [**CommonFiles64Folder**](commonfiles64folder.md) 屬性。</span><span class="sxs-lookup"><span data-stu-id="6bdf6-349">If installing [64-bit Windows Installer Package](64-bit-windows-installer-packages.md) components, use the [**ProgramFiles64Folder**](programfiles64folder.md) and [**CommonFiles64Folder**](commonfiles64folder.md) properties.</span></span> <span data-ttu-id="6bdf6-350">如果您的應用程式包含具有相同名稱之相同元件的32位和64位版本，請確定這些版本儲存在不同的目錄中，或提供不同的名稱。</span><span class="sxs-lookup"><span data-stu-id="6bdf6-350">If your application contains 32-bit and 64-bit versions of the same component, with the same name, ensure that these versions are saved in different directories or give them different names.</span></span>

<span data-ttu-id="6bdf6-351">下表提供與封裝相容 [的目錄配置](directory-table.md) 範例，其中包含32位和64位元件，並且包含一些跨應用程式共用的元件。</span><span class="sxs-lookup"><span data-stu-id="6bdf6-351">The following [Directory](directory-table.md) table provides an example of a directory layout compatible with a package that includes 32-bit and 64-bit components and includes some components that are shared across applications.</span></span>

| <span data-ttu-id="6bdf6-352">目錄</span><span class="sxs-lookup"><span data-stu-id="6bdf6-352">Directory</span></span>            | <span data-ttu-id="6bdf6-353">目錄 \_ 父系</span><span class="sxs-lookup"><span data-stu-id="6bdf6-353">Directory\_Parent</span></span>    | <span data-ttu-id="6bdf6-354">DefaultDir</span><span class="sxs-lookup"><span data-stu-id="6bdf6-354">DefaultDir</span></span>                        |
|----------------------|----------------------|-----------------------------------|
| <span data-ttu-id="6bdf6-355">TARGETDIR</span><span class="sxs-lookup"><span data-stu-id="6bdf6-355">TARGETDIR</span></span>            |                      | <span data-ttu-id="6bdf6-356">SourceDir</span><span class="sxs-lookup"><span data-stu-id="6bdf6-356">SourceDir</span></span>                         |
| <span data-ttu-id="6bdf6-357">ProgramFilesFolder</span><span class="sxs-lookup"><span data-stu-id="6bdf6-357">ProgramFilesFolder</span></span>   | <span data-ttu-id="6bdf6-358">TARGETDIR</span><span class="sxs-lookup"><span data-stu-id="6bdf6-358">TARGETDIR</span></span>            | <span data-ttu-id="6bdf6-359">.:P rog32</span><span class="sxs-lookup"><span data-stu-id="6bdf6-359">.:Prog32</span></span>                          |
| <span data-ttu-id="6bdf6-360">ProgramFiles64Folder</span><span class="sxs-lookup"><span data-stu-id="6bdf6-360">ProgramFiles64Folder</span></span> | <span data-ttu-id="6bdf6-361">TARGETDIR</span><span class="sxs-lookup"><span data-stu-id="6bdf6-361">TARGETDIR</span></span>            | <span data-ttu-id="6bdf6-362">.:P rog64</span><span class="sxs-lookup"><span data-stu-id="6bdf6-362">.:Prog64</span></span>                          |
| <span data-ttu-id="6bdf6-363">CommonFilesFolder</span><span class="sxs-lookup"><span data-stu-id="6bdf6-363">CommonFilesFolder</span></span>    | <span data-ttu-id="6bdf6-364">TARGETDIR</span><span class="sxs-lookup"><span data-stu-id="6bdf6-364">TARGETDIR</span></span>            | <span data-ttu-id="6bdf6-365">.:Share32</span><span class="sxs-lookup"><span data-stu-id="6bdf6-365">.:Share32</span></span>                         |
| <span data-ttu-id="6bdf6-366">CommonFiles64Folder</span><span class="sxs-lookup"><span data-stu-id="6bdf6-366">CommonFiles64Folder</span></span>  | <span data-ttu-id="6bdf6-367">TARGETDIR</span><span class="sxs-lookup"><span data-stu-id="6bdf6-367">TARGETDIR</span></span>            | <span data-ttu-id="6bdf6-368">.:Share64</span><span class="sxs-lookup"><span data-stu-id="6bdf6-368">.:Share64</span></span>                         |
| <span data-ttu-id="6bdf6-369">ProgramMenuFolder</span><span class="sxs-lookup"><span data-stu-id="6bdf6-369">ProgramMenuFolder</span></span>    | <span data-ttu-id="6bdf6-370">TARGETDIR</span><span class="sxs-lookup"><span data-stu-id="6bdf6-370">TARGETDIR</span></span>            | <span data-ttu-id="6bdf6-371">.： Sample1 \| MSDN-PUASample1</span><span class="sxs-lookup"><span data-stu-id="6bdf6-371">.:Sample1\|MSDN-PUASample1</span></span>        |
| <span data-ttu-id="6bdf6-372">INSTALLLOCATION</span><span class="sxs-lookup"><span data-stu-id="6bdf6-372">INSTALLLOCATION</span></span>      | <span data-ttu-id="6bdf6-373">MyVendor</span><span class="sxs-lookup"><span data-stu-id="6bdf6-373">MyVendor</span></span>             | <span data-ttu-id="6bdf6-374">Sample1 \| MSDN-PUASample1</span><span class="sxs-lookup"><span data-stu-id="6bdf6-374">Sample1\|MSDN-PUASample1</span></span>          |
| <span data-ttu-id="6bdf6-375">INSTALLLOCATIONX64</span><span class="sxs-lookup"><span data-stu-id="6bdf6-375">INSTALLLOCATIONX64</span></span>   | <span data-ttu-id="6bdf6-376">Vendorx64</span><span class="sxs-lookup"><span data-stu-id="6bdf6-376">Vendorx64</span></span>            | <span data-ttu-id="6bdf6-377">Sample1 \| MSDN-PUASample1</span><span class="sxs-lookup"><span data-stu-id="6bdf6-377">Sample1\|MSDN-PUASample1</span></span>          |
| <span data-ttu-id="6bdf6-378">SHAREDLOCATION</span><span class="sxs-lookup"><span data-stu-id="6bdf6-378">SHAREDLOCATION</span></span>       | <span data-ttu-id="6bdf6-379">ShVendor</span><span class="sxs-lookup"><span data-stu-id="6bdf6-379">ShVendor</span></span>             | <span data-ttu-id="6bdf6-380">Sample1 \| MSDN-PUASample1</span><span class="sxs-lookup"><span data-stu-id="6bdf6-380">Sample1\|MSDN-PUASample1</span></span>          |
| <span data-ttu-id="6bdf6-381">SHAREDLOCATIONX64</span><span class="sxs-lookup"><span data-stu-id="6bdf6-381">SHAREDLOCATIONX64</span></span>    | <span data-ttu-id="6bdf6-382">ShVendorx64</span><span class="sxs-lookup"><span data-stu-id="6bdf6-382">ShVendorx64</span></span>          | <span data-ttu-id="6bdf6-383">Sample1 \| MSDN-PUASample1</span><span class="sxs-lookup"><span data-stu-id="6bdf6-383">Sample1\|MSDN-PUASample1</span></span>          |
| <span data-ttu-id="6bdf6-384">MyVendor</span><span class="sxs-lookup"><span data-stu-id="6bdf6-384">MyVendor</span></span>             | <span data-ttu-id="6bdf6-385">ProgramFilesFolder</span><span class="sxs-lookup"><span data-stu-id="6bdf6-385">ProgramFilesFolder</span></span>   | <span data-ttu-id="6bdf6-386">Msft \| Microsoft</span><span class="sxs-lookup"><span data-stu-id="6bdf6-386">Msft\|Microsoft</span></span>                   |
| <span data-ttu-id="6bdf6-387">Vendorx64</span><span class="sxs-lookup"><span data-stu-id="6bdf6-387">Vendorx64</span></span>            | <span data-ttu-id="6bdf6-388">ProgramFiles64Folder</span><span class="sxs-lookup"><span data-stu-id="6bdf6-388">ProgramFiles64Folder</span></span> | <span data-ttu-id="6bdf6-389">Msft \| Microsoft</span><span class="sxs-lookup"><span data-stu-id="6bdf6-389">Msft\|Microsoft</span></span>                   |
| <span data-ttu-id="6bdf6-390">ShVendor</span><span class="sxs-lookup"><span data-stu-id="6bdf6-390">ShVendor</span></span>             | <span data-ttu-id="6bdf6-391">CommonFilesFolder</span><span class="sxs-lookup"><span data-stu-id="6bdf6-391">CommonFilesFolder</span></span>    | <span data-ttu-id="6bdf6-392">Msft \| Microsoft</span><span class="sxs-lookup"><span data-stu-id="6bdf6-392">Msft\|Microsoft</span></span>                   |
| <span data-ttu-id="6bdf6-393">ShVendorx64</span><span class="sxs-lookup"><span data-stu-id="6bdf6-393">ShVendorx64</span></span>          | <span data-ttu-id="6bdf6-394">CommonFiles64Folder</span><span class="sxs-lookup"><span data-stu-id="6bdf6-394">CommonFiles64Folder</span></span>  | <span data-ttu-id="6bdf6-395">Msft \| Microsoft</span><span class="sxs-lookup"><span data-stu-id="6bdf6-395">Msft\|Microsoft</span></span>                   |
| <span data-ttu-id="6bdf6-396">Shrx86</span><span class="sxs-lookup"><span data-stu-id="6bdf6-396">Shrx86</span></span>               | <span data-ttu-id="6bdf6-397">SHAREDLOCATION</span><span class="sxs-lookup"><span data-stu-id="6bdf6-397">SHAREDLOCATION</span></span>       | <span data-ttu-id="6bdf6-398">x32 \| 32-bit 元件</span><span class="sxs-lookup"><span data-stu-id="6bdf6-398">x32\|32-bit components</span></span>            |
| <span data-ttu-id="6bdf6-399">Shrx64</span><span class="sxs-lookup"><span data-stu-id="6bdf6-399">Shrx64</span></span>               | <span data-ttu-id="6bdf6-400">SHAREDLOCATIONX64</span><span class="sxs-lookup"><span data-stu-id="6bdf6-400">SHAREDLOCATIONX64</span></span>    | <span data-ttu-id="6bdf6-401">x64 \| 64 位元件</span><span class="sxs-lookup"><span data-stu-id="6bdf6-401">x64\|64-bit components</span></span>            |
| <span data-ttu-id="6bdf6-402">Binx86</span><span class="sxs-lookup"><span data-stu-id="6bdf6-402">Binx86</span></span>               | <span data-ttu-id="6bdf6-403">INSTALLLOCATION</span><span class="sxs-lookup"><span data-stu-id="6bdf6-403">INSTALLLOCATION</span></span>      | <span data-ttu-id="6bdf6-404">x32 \| 32-bit 元件</span><span class="sxs-lookup"><span data-stu-id="6bdf6-404">x32\|32-bit components</span></span>            |
| <span data-ttu-id="6bdf6-405">Binx64</span><span class="sxs-lookup"><span data-stu-id="6bdf6-405">Binx64</span></span>               | <span data-ttu-id="6bdf6-406">INSTALLLOCATIONX64</span><span class="sxs-lookup"><span data-stu-id="6bdf6-406">INSTALLLOCATIONX64</span></span>   | <span data-ttu-id="6bdf6-407">x64 \| 64 位元件</span><span class="sxs-lookup"><span data-stu-id="6bdf6-407">x64\|64-bit components</span></span>            |
| <span data-ttu-id="6bdf6-408">App32</span><span class="sxs-lookup"><span data-stu-id="6bdf6-408">App32</span></span>                | <span data-ttu-id="6bdf6-409">Binx86</span><span class="sxs-lookup"><span data-stu-id="6bdf6-409">Binx86</span></span>               | <span data-ttu-id="6bdf6-410">myapp 未 \| 共用的32位元件</span><span class="sxs-lookup"><span data-stu-id="6bdf6-410">myapp\|unshared 32-bit components</span></span> |
| <span data-ttu-id="6bdf6-411">App64</span><span class="sxs-lookup"><span data-stu-id="6bdf6-411">App64</span></span>                | <span data-ttu-id="6bdf6-412">Binx64</span><span class="sxs-lookup"><span data-stu-id="6bdf6-412">Binx64</span></span>               | <span data-ttu-id="6bdf6-413">myapp 未 \| 共用的64位元件</span><span class="sxs-lookup"><span data-stu-id="6bdf6-413">myapp\|unshared 64-bit components</span></span> |
| <span data-ttu-id="6bdf6-414">Share32</span><span class="sxs-lookup"><span data-stu-id="6bdf6-414">Share32</span></span>              | <span data-ttu-id="6bdf6-415">Shrx86</span><span class="sxs-lookup"><span data-stu-id="6bdf6-415">Shrx86</span></span>               | <span data-ttu-id="6bdf6-416">共用 \| 共用的32位元件</span><span class="sxs-lookup"><span data-stu-id="6bdf6-416">shared\|shared 32-bit components</span></span>  |
| <span data-ttu-id="6bdf6-417">Share64</span><span class="sxs-lookup"><span data-stu-id="6bdf6-417">Share64</span></span>              | <span data-ttu-id="6bdf6-418">Shrx64</span><span class="sxs-lookup"><span data-stu-id="6bdf6-418">Shrx64</span></span>               | <span data-ttu-id="6bdf6-419">共用 \| 共用的64位元件</span><span class="sxs-lookup"><span data-stu-id="6bdf6-419">shared\|shared 64-bit components</span></span>  |



 

<span data-ttu-id="6bdf6-420">在來源，此 [目錄](directory-table.md) 資料表會解析為下列目錄路徑。</span><span class="sxs-lookup"><span data-stu-id="6bdf6-420">At the source, this [Directory](directory-table.md) table resolves to the following directory paths.</span></span>

<dl> <span data-ttu-id="6bdf6-421">\[SourceDir \] Prog32 \\ Msft \\ Sample1 \\ x32 \\ myapp</span><span class="sxs-lookup"><span data-stu-id="6bdf6-421">\[SourceDir\]Prog32\\Msft\\Sample1\\x32\\myapp</span></span>  
<span data-ttu-id="6bdf6-422">\[SourceDir \] Share32 \\ Common Files \\ Msft \\ Sample1 \\ x32 \\ shared</span><span class="sxs-lookup"><span data-stu-id="6bdf6-422">\[SourceDir\]Share32\\Common Files\\Msft\\Sample1\\x32\\shared</span></span>  
<span data-ttu-id="6bdf6-423">\[SourceDir \] Prog64 \\ Msft \\ Sample1 \\ x64 \\ myapp</span><span class="sxs-lookup"><span data-stu-id="6bdf6-423">\[SourceDir\]Prog64\\Msft\\Sample1\\x64\\myapp</span></span>  
<span data-ttu-id="6bdf6-424">\[SourceDir \] Share64 \\ Common Files \\ Msft \\ Sample1 \\ x64 \\ shared</span><span class="sxs-lookup"><span data-stu-id="6bdf6-424">\[SourceDir\]Share64\\Common Files\\Msft\\Sample1\\x64\\shared</span></span>  
<span data-ttu-id="6bdf6-425">\[SourceDir \] Sample1</span><span class="sxs-lookup"><span data-stu-id="6bdf6-425">\[SourceDir\]Sample1</span></span>  
</dl>

<span data-ttu-id="6bdf6-426">在目標上，此 [目錄](directory-table.md) 資料表會解析為下列目錄路徑。</span><span class="sxs-lookup"><span data-stu-id="6bdf6-426">At the target, this [Directory](directory-table.md) table resolves to the following directory paths.</span></span> <span data-ttu-id="6bdf6-427">目標路徑取決於 [安裝內容](installation-context.md) 和系統。</span><span class="sxs-lookup"><span data-stu-id="6bdf6-427">The target paths depend on the [installation context](installation-context.md) and system.</span></span>

| <span data-ttu-id="6bdf6-428">安裝內容</span><span class="sxs-lookup"><span data-stu-id="6bdf6-428">Installation Context</span></span> | <span data-ttu-id="6bdf6-429">系統</span><span class="sxs-lookup"><span data-stu-id="6bdf6-429">System</span></span>                                                                              | <span data-ttu-id="6bdf6-430">範例路徑</span><span class="sxs-lookup"><span data-stu-id="6bdf6-430">Example Paths</span></span>                                                                                                                                                                                                                                                                                                                                         |
|----------------------|-------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="6bdf6-431">Per-Machine</span><span class="sxs-lookup"><span data-stu-id="6bdf6-431">Per-Machine</span></span>          | <span data-ttu-id="6bdf6-432">Windows Server 2008 R2 與 Windows 7</span><span class="sxs-lookup"><span data-stu-id="6bdf6-432">Windows Server 2008 R2 and Windows 7</span></span><br/> <span data-ttu-id="6bdf6-433">32位版本</span><span class="sxs-lookup"><span data-stu-id="6bdf6-433">32-bit version</span></span><br/>           | <span data-ttu-id="6bdf6-434">% ProgramFiles% \\ Msft \\ Sample1 \\ x32 \\ myapp</span><span class="sxs-lookup"><span data-stu-id="6bdf6-434">%ProgramFiles%\\Msft\\Sample1\\x32\\myapp</span></span><br/> <span data-ttu-id="6bdf6-435">% ProgramFiles% \\ Common Files \\ Msft \\ Sample1 \\ x32 \\ shared</span><span class="sxs-lookup"><span data-stu-id="6bdf6-435">%ProgramFiles%\\Common Files\\Msft\\Sample1\\x32\\shared</span></span><br/> <span data-ttu-id="6bdf6-436">% ProgramFiles (x86) % \\ Msft \\ Sample1 \\ x64 \\ myapp</span><span class="sxs-lookup"><span data-stu-id="6bdf6-436">%ProgramFiles(x86)%\\Msft\\Sample1\\x64\\myapp</span></span><br/> <span data-ttu-id="6bdf6-437">% ProgramFiles (x86) % \\ Common Files \\ Msft \\ Sample1 \\ x64 \\ shared</span><span class="sxs-lookup"><span data-stu-id="6bdf6-437">%ProgramFiles(x86)%\\Common Files\\Msft\\Sample1\\x64\\shared</span></span><br/> <span data-ttu-id="6bdf6-438">% ProgramData% \\ Microsoft \\ Windows [ \\ 開始] 功能表 \\ 程式 \\ Sample1</span><span class="sxs-lookup"><span data-stu-id="6bdf6-438">%ProgramData%\\Microsoft\\Windows\\Start Menu\\Programs\\Sample1</span></span><br/>               |
| <span data-ttu-id="6bdf6-439">Per-Machine</span><span class="sxs-lookup"><span data-stu-id="6bdf6-439">Per-Machine</span></span>          | <span data-ttu-id="6bdf6-440">Windows Server 2008 R2 與 Windows 7</span><span class="sxs-lookup"><span data-stu-id="6bdf6-440">Windows Server 2008 R2 and Windows 7</span></span><br/> <span data-ttu-id="6bdf6-441">64位版本</span><span class="sxs-lookup"><span data-stu-id="6bdf6-441">64-bit version</span></span><br/>           | <span data-ttu-id="6bdf6-442">% ProgramFiles (x86) % \\ Msft \\ Sample1 \\ x32 \\ myapp</span><span class="sxs-lookup"><span data-stu-id="6bdf6-442">%ProgramFiles(x86)%\\Msft\\Sample1\\x32\\myapp</span></span><br/> <span data-ttu-id="6bdf6-443">% ProgramFiles (x86) % \\ Common Files \\ Msft \\ Sample1 \\ x32 \\ shared</span><span class="sxs-lookup"><span data-stu-id="6bdf6-443">%ProgramFiles(x86)%\\Common Files\\Msft\\Sample1\\x32\\shared</span></span><br/> <span data-ttu-id="6bdf6-444">% ProgramFiles% \\ Msft \\ Sample1 \\ x64 \\ myapp</span><span class="sxs-lookup"><span data-stu-id="6bdf6-444">%ProgramFiles%\\Msft\\Sample1\\x64\\myapp</span></span><br/> <span data-ttu-id="6bdf6-445">% ProgramFiles% \\ Common Files \\ Msft \\ Sample1 \\ x64 \\ shared</span><span class="sxs-lookup"><span data-stu-id="6bdf6-445">%ProgramFiles%\\Common Files\\Msft\\Sample1\\x64\\shared</span></span><br/> <span data-ttu-id="6bdf6-446">% ProgramData% \\ Microsoft \\ Windows [ \\ 開始] 功能表 \\ 程式 \\ Sample1</span><span class="sxs-lookup"><span data-stu-id="6bdf6-446">%ProgramData%\\Microsoft\\Windows\\Start Menu\\Programs\\Sample1</span></span><br/>               |
| <span data-ttu-id="6bdf6-447">Per-User</span><span class="sxs-lookup"><span data-stu-id="6bdf6-447">Per-User</span></span>             | <span data-ttu-id="6bdf6-448">Windows Server 2008 R2 與 Windows 7</span><span class="sxs-lookup"><span data-stu-id="6bdf6-448">Windows Server 2008 R2 and Windows 7</span></span><br/> <span data-ttu-id="6bdf6-449">32位或64位版本</span><span class="sxs-lookup"><span data-stu-id="6bdf6-449">32-bit or 64-bit version</span></span><br/> | <span data-ttu-id="6bdf6-450">% LOCALAPPDATA% \\ 程式 \\ Msft \\ Sample1 \\ x32 \\ myapp</span><span class="sxs-lookup"><span data-stu-id="6bdf6-450">%LOCALAPPDATA%\\Programs\\Msft\\Sample1\\x32\\myapp</span></span><br/> <span data-ttu-id="6bdf6-451">% LOCALAPPDATA% \\ 程式 \\ 常見的 \\ Msft \\ Sample1 \\ x32 \\ 共用</span><span class="sxs-lookup"><span data-stu-id="6bdf6-451">%LOCALAPPDATA%\\Programs\\Common\\Msft\\Sample1\\x32\\shared</span></span><br/> <span data-ttu-id="6bdf6-452">% LOCALAPPDATA% \\ 程式 \\ Msft \\ Sample1 \\ x64 \\ myapp</span><span class="sxs-lookup"><span data-stu-id="6bdf6-452">%LOCALAPPDATA%\\Programs\\Msft\\Sample1\\x64\\myapp</span></span><br/> <span data-ttu-id="6bdf6-453">% LOCALAPPDATA% \\ 程式 \\ 常見的 \\ Msft \\ Sample1 \\ x64 \\ 共用</span><span class="sxs-lookup"><span data-stu-id="6bdf6-453">%LOCALAPPDATA%\\Programs\\Common\\Msft\\Sample1\\x64\\shared</span></span><br/> <span data-ttu-id="6bdf6-454">% APPDATA% \\ Microsoft \\ Windows [ \\ 開始] 功能表 \\ 程式 \\ Sample1</span><span class="sxs-lookup"><span data-stu-id="6bdf6-454">%APPDATA%\\Microsoft\\Windows\\Start Menu\\Programs\\Sample1</span></span><br/> |



 

## <a name="application-registration"></a><span data-ttu-id="6bdf6-455">應用程式註冊</span><span class="sxs-lookup"><span data-stu-id="6bdf6-455">Application Registration</span></span>

<span data-ttu-id="6bdf6-456">PUASample.msi 會將子機碼加入至應用程式的應用程式路徑登錄機碼，並執行註冊，讓應用程式資訊儲存在登錄中的此機碼下。</span><span class="sxs-lookup"><span data-stu-id="6bdf6-456">The PUASample.msi adds a subkey to the App Paths registry key for the application and performs registrations that enable application information to be saved in the registry under this key.</span></span> <span data-ttu-id="6bdf6-457">如需應用程式路徑和應用程式註冊的詳細資訊，請參閱[Shell 開發人員指南](/previous-versions/windows/desktop/legacy/bb776778(v=vs.85))的[shell](https://msdn.microsoft.com/library/bb762762.aspx)擴充性一節中的[PerceivedTypes、SystemFileAssociations 和應用程式註冊](/previous-versions/windows/desktop/legacy/cc144150(v=vs.85))。</span><span class="sxs-lookup"><span data-stu-id="6bdf6-457">For more information about App Paths and application registration, see the [PerceivedTypes, SystemFileAssociations, and Application Registration](/previous-versions/windows/desktop/legacy/cc144150(v=vs.85)) in the [shell extensibility](https://msdn.microsoft.com/library/bb762762.aspx) section of the [Shell Developer's Guide](/previous-versions/windows/desktop/legacy/bb776778(v=vs.85)).</span></span> <span data-ttu-id="6bdf6-458">在安裝時，使用者會決定是否要在每個使用者或每部電腦的安裝內容中安裝應用程式。</span><span class="sxs-lookup"><span data-stu-id="6bdf6-458">At installation time, the user makes the decision to install the application in either the per-user or per-machine installation context.</span></span> <span data-ttu-id="6bdf6-459">撰寫雙重用途套件時，套件開發人員無法得知是否應在 HKEY 本機電腦下執行註冊， \_ \_ 或 HKEY \_ 目前的 \_ 使用者金鑰。</span><span class="sxs-lookup"><span data-stu-id="6bdf6-459">At the time the dual-purpose package is authored, the package developer cannot know if the registrations should be performed under the HKEY\_LOCAL\_MACHINE or HKEY\_CURRENT\_USER keys.</span></span>

<span data-ttu-id="6bdf6-460">封裝開發人員會在 [file](file-table.md) 資料表的 file 欄位中，定義應用程式可執行檔的檔案識別碼。</span><span class="sxs-lookup"><span data-stu-id="6bdf6-460">The package developer defines the file identifier for the application's executable file in the File field of the [File](file-table.md) Table.</span></span>

<span data-ttu-id="6bdf6-461">[](file-table.md)檔案資料表 (部分) </span><span class="sxs-lookup"><span data-stu-id="6bdf6-461">[File](file-table.md) Table (partial)</span></span> 

| <span data-ttu-id="6bdf6-462">檔案</span><span class="sxs-lookup"><span data-stu-id="6bdf6-462">File</span></span>      | <span data-ttu-id="6bdf6-463">元件\_</span><span class="sxs-lookup"><span data-stu-id="6bdf6-463">Component\_</span></span>      | <span data-ttu-id="6bdf6-464">FileName</span><span class="sxs-lookup"><span data-stu-id="6bdf6-464">FileName</span></span>                     | <span data-ttu-id="6bdf6-465">FileSize</span><span class="sxs-lookup"><span data-stu-id="6bdf6-465">FileSize</span></span> | <span data-ttu-id="6bdf6-466">版本</span><span class="sxs-lookup"><span data-stu-id="6bdf6-466">Version</span></span> | <span data-ttu-id="6bdf6-467">語言</span><span class="sxs-lookup"><span data-stu-id="6bdf6-467">Language</span></span> | <span data-ttu-id="6bdf6-468">屬性</span><span class="sxs-lookup"><span data-stu-id="6bdf6-468">Attributes</span></span> | <span data-ttu-id="6bdf6-469">順序</span><span class="sxs-lookup"><span data-stu-id="6bdf6-469">Sequence</span></span> |
|-----------|------------------|------------------------------|----------|---------|----------|------------|----------|
| <span data-ttu-id="6bdf6-470">MyAppFile</span><span class="sxs-lookup"><span data-stu-id="6bdf6-470">MyAppFile</span></span> | <span data-ttu-id="6bdf6-471">ProductComponent</span><span class="sxs-lookup"><span data-stu-id="6bdf6-471">ProductComponent</span></span> | <span data-ttu-id="6bdf6-472">PUASAMP1.EXE\|PUASample1.exe</span><span class="sxs-lookup"><span data-stu-id="6bdf6-472">PUASAMP1.EXE\|PUASample1.exe</span></span> | <span data-ttu-id="6bdf6-473">81920</span><span class="sxs-lookup"><span data-stu-id="6bdf6-473">81920</span></span>    |         |          | <span data-ttu-id="6bdf6-474">0</span><span class="sxs-lookup"><span data-stu-id="6bdf6-474">0</span></span>          | <span data-ttu-id="6bdf6-475">1</span><span class="sxs-lookup"><span data-stu-id="6bdf6-475">1</span></span>        |



 

<span data-ttu-id="6bdf6-476">要儲存在登錄中的值可以在 [登錄資料表的](registry-table.md) [值] 欄位中指定為 [格式化](formatted.md) 字串。</span><span class="sxs-lookup"><span data-stu-id="6bdf6-476">Values to be saved in the registry can be specified in the Value field of the [Registry](registry-table.md) table as a [Formatted](formatted.md) string.</span></span> <span data-ttu-id="6bdf6-477">使用[檔案資料表的](file-table.md)[檔案] 欄位中定義的檔案識別碼，以及 \[ \#  \] 格式化類型的 filekey 慣例，以指定應用程式路徑登錄機碼的預設值。</span><span class="sxs-lookup"><span data-stu-id="6bdf6-477">Use the file identifier defined in the File field of the [File](file-table.md) table, and the \[\#*filekey*\] convention of the Formatted type, to specify the default value for the App Paths registry key.</span></span> <span data-ttu-id="6bdf6-478">最上層 [安裝](install-action.md) 動作會在 [InstallExecuteSequence](installexecutesequence-table.md) 資料表中執行動作。</span><span class="sxs-lookup"><span data-stu-id="6bdf6-478">The top-level [INSTALL](install-action.md) action performs the actions in the [InstallExecuteSequence](installexecutesequence-table.md) table.</span></span> <span data-ttu-id="6bdf6-479">在此資料表中的[CostInitialize](costinitialize-action.md)、 [FileCost](filecost-action.md)和[InstallFinalize](installfinalize-action.md)動作完成之後，Windows Installer 會以 \[ \# \] 應用程式檔的完整路徑取代登錄資料表中格式化的子字串 MyAppFile。</span><span class="sxs-lookup"><span data-stu-id="6bdf6-479">After the [CostInitialize](costinitialize-action.md), [FileCost](filecost-action.md), and [InstallFinalize](installfinalize-action.md) actions in this table have completed, the Windows Installer replaces the formatted substring \[\#MyAppFile\] in the Registry table with the full path to the application file.</span></span>

<span data-ttu-id="6bdf6-480">此範例會定義自訂屬性 RegRoot，以包含根機碼的位置，並使用自訂動作來重設屬性值（如果使用者選擇個別電腦安裝）。</span><span class="sxs-lookup"><span data-stu-id="6bdf6-480">The sample defines a custom property, RegRoot, to contain the location of the root key and uses a custom action to reset the property value if the user chooses a per-machine installation.</span></span> <span data-ttu-id="6bdf6-481">使用自訂屬性 RegRoot，在任何格式的字串值中參考根位置。</span><span class="sxs-lookup"><span data-stu-id="6bdf6-481">Use the custom property, RegRoot, in any formatted string values that reference the root location.</span></span> <span data-ttu-id="6bdf6-482">在 [屬性](property-table.md) 表中，PUASample.msi 套件會定義自訂屬性，並將 RegRoot 的值設定為 HKCU。</span><span class="sxs-lookup"><span data-stu-id="6bdf6-482">In the [Property](property-table.md) table the PUASample.msi package defines the custom property and sets the value of RegRoot to HKCU.</span></span> <span data-ttu-id="6bdf6-483">這會初始化每個使用者安裝內容的屬性值，也就是雙用途封裝的建議預設內容。</span><span class="sxs-lookup"><span data-stu-id="6bdf6-483">This initializes the value of the property for the per-user installation context, the recommended default context for dual-purpose packages.</span></span>

<span data-ttu-id="6bdf6-484">[屬性](property-table.md) 資料表 (部分) </span><span class="sxs-lookup"><span data-stu-id="6bdf6-484">[Property](property-table.md) Table (partial)</span></span>

| <span data-ttu-id="6bdf6-485">屬性</span><span class="sxs-lookup"><span data-stu-id="6bdf6-485">Property</span></span> | <span data-ttu-id="6bdf6-486">值</span><span class="sxs-lookup"><span data-stu-id="6bdf6-486">Value</span></span> |
|----------|-------|
| <span data-ttu-id="6bdf6-487">RegRoot</span><span class="sxs-lookup"><span data-stu-id="6bdf6-487">RegRoot</span></span>  | <span data-ttu-id="6bdf6-488">HKCU</span><span class="sxs-lookup"><span data-stu-id="6bdf6-488">HKCU</span></span>  |



 

<span data-ttu-id="6bdf6-489">在 [CustomAction](customaction-table.md) 資料表中，封裝會定義名為 Set RegRoot HKLM 的自訂動作 \_ \_ 。</span><span class="sxs-lookup"><span data-stu-id="6bdf6-489">In the [CustomAction](customaction-table.md) table the package defines a custom action named Set\_RegRoot\_HKLM.</span></span> <span data-ttu-id="6bdf6-490">[類型] 欄位中的值會將這個值識別為 [自訂動作類型 51](custom-action-type-51.md) 標準自訂動作。</span><span class="sxs-lookup"><span data-stu-id="6bdf6-490">The value in the Type field identifies this as a [Custom Action Type 51](custom-action-type-51.md) standard custom action.</span></span> <span data-ttu-id="6bdf6-491">CustomAction 資料表中的來源和目標欄位的意義取決於自訂動作類型。</span><span class="sxs-lookup"><span data-stu-id="6bdf6-491">The meaning of the Source and Target fields in the CustomAction table depend upon the custom action type.</span></span> <span data-ttu-id="6bdf6-492">如需有關標準自訂動作類型的詳細資訊，請參閱 [自訂動作類型](summary-list-of-all-custom-action-types.md)。</span><span class="sxs-lookup"><span data-stu-id="6bdf6-492">For more information about the standard types of custom actions, see [Custom Action Types](summary-list-of-all-custom-action-types.md).</span></span> <span data-ttu-id="6bdf6-493">Set \_ RegRoot HKLM 自訂動作的 [來源] 欄位 \_ 會指定 RegRoot 屬性的值。</span><span class="sxs-lookup"><span data-stu-id="6bdf6-493">The Source field for the Set\_RegRoot\_HKLM custom action specifies that the value of the RegRoot property.</span></span> <span data-ttu-id="6bdf6-494">如果安裝程式執行 Set \_ RegRoot \_ HKLM 自訂動作，這會將 RegRoot 屬性的值重設為 hklm。</span><span class="sxs-lookup"><span data-stu-id="6bdf6-494">If the installer performs the Set\_RegRoot\_HKLM custom action, this resets the value of the RegRoot property to HKLM.</span></span>

<span data-ttu-id="6bdf6-495">[CustomAction](customaction-table.md) 資料表 (部分) </span><span class="sxs-lookup"><span data-stu-id="6bdf6-495">[CustomAction](customaction-table.md) Table (partial)</span></span>

| <span data-ttu-id="6bdf6-496">動作</span><span class="sxs-lookup"><span data-stu-id="6bdf6-496">Action</span></span>             | <span data-ttu-id="6bdf6-497">類型</span><span class="sxs-lookup"><span data-stu-id="6bdf6-497">Type</span></span> | <span data-ttu-id="6bdf6-498">來源</span><span class="sxs-lookup"><span data-stu-id="6bdf6-498">Source</span></span>      | <span data-ttu-id="6bdf6-499">目標</span><span class="sxs-lookup"><span data-stu-id="6bdf6-499">Target</span></span> |
|--------------------|------|-------------|--------|
| <span data-ttu-id="6bdf6-500">設定 \_ RegRoot \_ HKLM</span><span class="sxs-lookup"><span data-stu-id="6bdf6-500">Set\_RegRoot\_HKLM</span></span> | <span data-ttu-id="6bdf6-501">51</span><span class="sxs-lookup"><span data-stu-id="6bdf6-501">51</span></span>   | <span data-ttu-id="6bdf6-502">\[RegRoot\]</span><span class="sxs-lookup"><span data-stu-id="6bdf6-502">\[RegRoot\]</span></span> | <span data-ttu-id="6bdf6-503">HKLM</span><span class="sxs-lookup"><span data-stu-id="6bdf6-503">HKLM</span></span>   |



 

<span data-ttu-id="6bdf6-504">最上層 [安裝](install-action.md) 動作會以該資料表之 [順序] 欄位中指定的順序，執行 [InstallExecuteSequence](installexecutesequence-table.md) 資料表中的動作。</span><span class="sxs-lookup"><span data-stu-id="6bdf6-504">The top-level [INSTALL](install-action.md) action performs the actions in the [InstallExecuteSequence](installexecutesequence-table.md) table, in the sequence specified in the Sequence field of that table.</span></span> <span data-ttu-id="6bdf6-505">在 Set RegRoot HKLM 自訂動作 (1501) 的 [順序] 欄位中所撰寫的值 \_ \_ 會指定此自訂動作是在 [InstallInitialize](installinitialize-action.md) 動作 (1500) 之前，以及 [ProcessComponents](processcomponents-action.md) 動作 (1600 之前執行。 ) 此順序可確保 \_ \_ 在安裝時評估 Set RegRoot HKLM 自訂動作的記錄。</span><span class="sxs-lookup"><span data-stu-id="6bdf6-505">The value authored in the Sequence field for the Set\_RegRoot\_HKLM custom action (1501) specifies that this custom action be performed after the [InstallInitialize](installinitialize-action.md) action (1500) and before the [ProcessComponents](processcomponents-action.md) action (1600.) This sequence ensures that the record for the Set\_RegRoot\_HKLM custom action is evaluated at installation time.</span></span> <span data-ttu-id="6bdf6-506">如需 InstallExecuteSequence 資料表中建議的動作順序的詳細資訊，請參閱 [建議的 InstallExecuteSequence](suggested-installexecutesequence.md) 主題。</span><span class="sxs-lookup"><span data-stu-id="6bdf6-506">For more information about the recommended sequence of actions in the InstallExecuteSequence table, see the [Suggested InstallExecuteSequence](suggested-installexecutesequence.md) topic.</span></span> <span data-ttu-id="6bdf6-507">在 [條件] 欄位中撰寫的 [條件陳述式語法](conditional-statement-syntax.md) ，指定 \_ \_ 只有當 [**ALLUSERS**](allusers.md) 屬性的值在安裝時評估為1時，才會執行 Set RegRoot HKLM 動作。</span><span class="sxs-lookup"><span data-stu-id="6bdf6-507">The [conditional statement syntax](conditional-statement-syntax.md) authored in the Condition field specifies that the Set\_RegRoot\_HKLM action be performed only if the value of the [**ALLUSERS**](allusers.md) property evaluates to 1 at installation time.</span></span> <span data-ttu-id="6bdf6-508">**ALLUSERS** 屬性值1指定每部電腦安裝。</span><span class="sxs-lookup"><span data-stu-id="6bdf6-508">An **ALLUSERS** property value of 1 specifies a per-machine installation.</span></span>

<span data-ttu-id="6bdf6-509">[InstallExecuteSequence](installexecutesequence-table.md) 資料表 (部分) </span><span class="sxs-lookup"><span data-stu-id="6bdf6-509">[InstallExecuteSequence](installexecutesequence-table.md) Table (partial)</span></span>

| <span data-ttu-id="6bdf6-510">動作</span><span class="sxs-lookup"><span data-stu-id="6bdf6-510">Action</span></span>             | <span data-ttu-id="6bdf6-511">條件</span><span class="sxs-lookup"><span data-stu-id="6bdf6-511">Condition</span></span>  | <span data-ttu-id="6bdf6-512">順序</span><span class="sxs-lookup"><span data-stu-id="6bdf6-512">Sequence</span></span> |
|--------------------|------------|----------|
| <span data-ttu-id="6bdf6-513">設定 \_ RegRoot \_ HKLM</span><span class="sxs-lookup"><span data-stu-id="6bdf6-513">Set\_RegRoot\_HKLM</span></span> | <span data-ttu-id="6bdf6-514">ALLUSERS = 1</span><span class="sxs-lookup"><span data-stu-id="6bdf6-514">ALLUSERS=1</span></span> | <span data-ttu-id="6bdf6-515">1501</span><span class="sxs-lookup"><span data-stu-id="6bdf6-515">1501</span></span>     |



 

<span data-ttu-id="6bdf6-516">如果已安裝 ProductComponent 元件 [，則登錄資料表中](registry-table.md) 的下列記錄會執行註冊。</span><span class="sxs-lookup"><span data-stu-id="6bdf6-516">The following records in the [Registry](registry-table.md) table perform the registrations if the ProductComponent component is installed.</span></span> <span data-ttu-id="6bdf6-517">根欄位中的值-1 是在 HKEY 本機電腦上執行註冊所需的值-1 \_ \_ ，適用于每位使用者安裝，以及在 HKEY 目前使用者下，可 \_ 進行個別 \_ 使用者安裝。</span><span class="sxs-lookup"><span data-stu-id="6bdf6-517">The value -1 in the Root field is required to perform the registration under HKEY\_LOCAL\_MACHINE for a per-user installation and under HKEY\_CURRENT\_USER for a per-user installation.</span></span> <span data-ttu-id="6bdf6-518">登錄欄位中含有空白字串的記錄會在 AppPaths 登錄機碼下新增應用程式的子機碼，並將 " (預設) " 值設定為應用程式可執行檔的完整路徑。</span><span class="sxs-lookup"><span data-stu-id="6bdf6-518">The record with an empty string in the Registry field adds a subkey for the application under the AppPaths registry key and sets the "(Default)" value to the full path of the application's executable file.</span></span> <span data-ttu-id="6bdf6-519">MyAppPathAlias 註冊會將可執行檔對應到應用程式別名，並在使用者于命令列提示字元中輸入別名 "puapct" 時，讓應用程式啟動。</span><span class="sxs-lookup"><span data-stu-id="6bdf6-519">The MyAppPathAlias registration maps the executable file to an application alias and enables the application to be launched if the user types the alias "puapct" at a command line prompt.</span></span> <span data-ttu-id="6bdf6-520">MyAppPathRegistration 註冊會將可執行檔的名稱對應至檔案的完整路徑。</span><span class="sxs-lookup"><span data-stu-id="6bdf6-520">The MyAppPathRegistration registration maps the name of the executable file to the file's full path.</span></span>



| <span data-ttu-id="6bdf6-521">登錄</span><span class="sxs-lookup"><span data-stu-id="6bdf6-521">Registry</span></span>              | <span data-ttu-id="6bdf6-522">Root</span><span class="sxs-lookup"><span data-stu-id="6bdf6-522">Root</span></span> | <span data-ttu-id="6bdf6-523">按鍵</span><span class="sxs-lookup"><span data-stu-id="6bdf6-523">Key</span></span>                                                                     | <span data-ttu-id="6bdf6-524">名稱</span><span class="sxs-lookup"><span data-stu-id="6bdf6-524">Name</span></span> | <span data-ttu-id="6bdf6-525">值</span><span class="sxs-lookup"><span data-stu-id="6bdf6-525">Value</span></span>                                                                            | <span data-ttu-id="6bdf6-526">元件</span><span class="sxs-lookup"><span data-stu-id="6bdf6-526">Component</span></span>        |
|-----------------------|------|-------------------------------------------------------------------------|------|----------------------------------------------------------------------------------|------------------|
|                       | <span data-ttu-id="6bdf6-527">-1</span><span class="sxs-lookup"><span data-stu-id="6bdf6-527">-1</span></span>   | <span data-ttu-id="6bdf6-528">軟體 \\ Microsoft \\ MyAppPathRegistrationLocation</span><span class="sxs-lookup"><span data-stu-id="6bdf6-528">Software\\Microsoft\\MyAppPathRegistrationLocation</span></span>                      |      | <span data-ttu-id="6bdf6-529">\[RegRoot \] \\ Software \\ Microsoft \\ Windows \\ CurrentVersion \\ App Paths \\PUAPCT.exe</span><span class="sxs-lookup"><span data-stu-id="6bdf6-529">\[RegRoot\]\\Software\\Microsoft\\Windows\\CurrentVersion\\App Paths\\PUAPCT.exe</span></span> | <span data-ttu-id="6bdf6-530">ProductComponent</span><span class="sxs-lookup"><span data-stu-id="6bdf6-530">ProductComponent</span></span> |
| <span data-ttu-id="6bdf6-531">MyAppPathAlias</span><span class="sxs-lookup"><span data-stu-id="6bdf6-531">MyAppPathAlias</span></span>        | <span data-ttu-id="6bdf6-532">-1</span><span class="sxs-lookup"><span data-stu-id="6bdf6-532">-1</span></span>   | <span data-ttu-id="6bdf6-533">軟體 \\ Microsoft \\ Windows \\ CurrentVersion \\ 應用程式路徑 \\PUAPCT.exe</span><span class="sxs-lookup"><span data-stu-id="6bdf6-533">Software\\Microsoft\\Windows\\CurrentVersion\\App Paths\\PUAPCT.exe</span></span>     |      | <span data-ttu-id="6bdf6-534">\[\#MyAppFile\]</span><span class="sxs-lookup"><span data-stu-id="6bdf6-534">\[\#MyAppFile\]</span></span>                                                                  | <span data-ttu-id="6bdf6-535">ProductComponent</span><span class="sxs-lookup"><span data-stu-id="6bdf6-535">ProductComponent</span></span> |
| <span data-ttu-id="6bdf6-536">MyAppPathRegistration</span><span class="sxs-lookup"><span data-stu-id="6bdf6-536">MyAppPathRegistration</span></span> | <span data-ttu-id="6bdf6-537">-1</span><span class="sxs-lookup"><span data-stu-id="6bdf6-537">-1</span></span>   | <span data-ttu-id="6bdf6-538">軟體 \\ Microsoft \\ Windows \\ CurrentVersion \\ 應用程式路徑 \\PUASample1.exe</span><span class="sxs-lookup"><span data-stu-id="6bdf6-538">Software\\Microsoft\\Windows\\CurrentVersion\\App Paths\\PUASample1.exe</span></span> |      | <span data-ttu-id="6bdf6-539">\[\#MyAppFile\]</span><span class="sxs-lookup"><span data-stu-id="6bdf6-539">\[\#MyAppFile\]</span></span>                                                                  | <span data-ttu-id="6bdf6-540">ProductComponent</span><span class="sxs-lookup"><span data-stu-id="6bdf6-540">ProductComponent</span></span> |



 

## <a name="autoplay-cancel-registration"></a><span data-ttu-id="6bdf6-541">自動播放取消註冊</span><span class="sxs-lookup"><span data-stu-id="6bdf6-541">AutoPlay Cancel Registration</span></span>

<span data-ttu-id="6bdf6-542">PUASample.msi 會執行註冊，讓應用程式使用者防止 [硬體自動](/previous-versions/windows/desktop/legacy/cc144210(v=vs.85)) 啟動選取的裝置。</span><span class="sxs-lookup"><span data-stu-id="6bdf6-542">The PUASample.msi performs registrations that enable the application user to prevent [Hardware Autoplay](/previous-versions/windows/desktop/legacy/cc144210(v=vs.85)) from launching for selected devices.</span></span> <span data-ttu-id="6bdf6-543">如需有關註冊處理常式以取消自動播放以回應事件的詳細資訊，請參閱[Shell 開發人員指南](/previous-versions/windows/desktop/legacy/bb776778(v=vs.85))的[shell](https://msdn.microsoft.com/library/bb762762.aspx)擴充性一節中的[準備硬體和軟體以供使用自動播放](/previous-versions//cc144208(v=vs.85))主題。</span><span class="sxs-lookup"><span data-stu-id="6bdf6-543">For information about registering a handler to cancel Autoplay in response to an event, see the [Preparing Hardware and Software for Use with AutoPlay](/previous-versions//cc144208(v=vs.85)) topic in the [shell extensibility](https://msdn.microsoft.com/library/bb762762.aspx) section of the [Shell Developer's Guide](/previous-versions/windows/desktop/legacy/bb776778(v=vs.85)).</span></span> <span data-ttu-id="6bdf6-544">下列記錄會在安裝 ProductComponent 元件時，註冊 [名稱] 欄位中指定的處理常式。</span><span class="sxs-lookup"><span data-stu-id="6bdf6-544">The following record registers the handler specified in the Name field when the ProductComponent component is installed.</span></span> <span data-ttu-id="6bdf6-545">根欄位中的值-1 必須指定給 Windows Installer，才能將註冊重新導向至相依于安裝內容的位置。</span><span class="sxs-lookup"><span data-stu-id="6bdf6-545">The value -1 in the Root field is required to specify to the Windows Installer that the registration should be redirected to a location that depends upon the installation context.</span></span>

<span data-ttu-id="6bdf6-546">[](registry-table.md)登錄表</span><span class="sxs-lookup"><span data-stu-id="6bdf6-546">[Registry](registry-table.md) Table</span></span> 

| <span data-ttu-id="6bdf6-547">登錄</span><span class="sxs-lookup"><span data-stu-id="6bdf6-547">Registry</span></span>                     | <span data-ttu-id="6bdf6-548">Root</span><span class="sxs-lookup"><span data-stu-id="6bdf6-548">Root</span></span> | <span data-ttu-id="6bdf6-549">按鍵</span><span class="sxs-lookup"><span data-stu-id="6bdf6-549">Key</span></span>                                                                                             | <span data-ttu-id="6bdf6-550">名稱</span><span class="sxs-lookup"><span data-stu-id="6bdf6-550">Name</span></span>                                 | <span data-ttu-id="6bdf6-551">值</span><span class="sxs-lookup"><span data-stu-id="6bdf6-551">Value</span></span> | <span data-ttu-id="6bdf6-552">元件</span><span class="sxs-lookup"><span data-stu-id="6bdf6-552">Component</span></span>        |
|------------------------------|------|-------------------------------------------------------------------------------------------------|--------------------------------------|-------|------------------|
| <span data-ttu-id="6bdf6-553">MyAutoplayCancelRegistration</span><span class="sxs-lookup"><span data-stu-id="6bdf6-553">MyAutoplayCancelRegistration</span></span> | <span data-ttu-id="6bdf6-554">-1</span><span class="sxs-lookup"><span data-stu-id="6bdf6-554">-1</span></span>   | <span data-ttu-id="6bdf6-555">軟體 \\ Microsoft \\ Windows \\ CurrentVersion \\ Explorer \\ AutoplayHandlers \\ CancelAutoplay \\ CLSID</span><span class="sxs-lookup"><span data-stu-id="6bdf6-555">SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\AutoplayHandlers\\CancelAutoplay\\CLSID</span></span> | <span data-ttu-id="6bdf6-556">66A32FE6-229D-427b-A608-D273F40C034C</span><span class="sxs-lookup"><span data-stu-id="6bdf6-556">66A32FE6-229D-427b-A608-D273F40C034C</span></span> |       | <span data-ttu-id="6bdf6-557">ProductComponent</span><span class="sxs-lookup"><span data-stu-id="6bdf6-557">ProductComponent</span></span> |



 

## <a name="preview-handler-registration"></a><span data-ttu-id="6bdf6-558">預覽處理常式註冊</span><span class="sxs-lookup"><span data-stu-id="6bdf6-558">Preview Handler Registration</span></span>

<span data-ttu-id="6bdf6-559">PUASample.msi 執行安裝 [預覽處理常式](../shell/preview-handlers.md) 所需的註冊，此處理程式會啟用 pua 檔案的唯讀預覽，而不啟動應用程式。</span><span class="sxs-lookup"><span data-stu-id="6bdf6-559">The PUASample.msi performs registrations that are required to install a [preview handler](../shell/preview-handlers.md) that enables a read-only preview of .pua files without launching the application.</span></span> <span data-ttu-id="6bdf6-560">如需註冊預覽處理常式的詳細資訊，請參閱[Shell 開發人員指南](/previous-versions/windows/desktop/legacy/bb776778(v=vs.85))的[shell](https://msdn.microsoft.com/library/bb762762.aspx)擴充性一節中的[註冊預覽處理常式](../shell/how-to-register-a-preview-handler.md)主題。</span><span class="sxs-lookup"><span data-stu-id="6bdf6-560">For information about registering preview handlers, see the [Registering Preview Handlers](../shell/how-to-register-a-preview-handler.md) topic in the [shell extensibility](https://msdn.microsoft.com/library/bb762762.aspx) section of the [Shell Developer's Guide](/previous-versions/windows/desktop/legacy/bb776778(v=vs.85)).</span></span> <span data-ttu-id="6bdf6-561">安裝 ProductComponent 元件 [時，登錄表中](registry-table.md) 的下列記錄會註冊處理常式。</span><span class="sxs-lookup"><span data-stu-id="6bdf6-561">The following records in the [Registry](registry-table.md) table register the handler when the ProductComponent component is installed.</span></span> <span data-ttu-id="6bdf6-562">根欄位中的值-1 必須指定給 Windows Installer，才能將註冊重新導向至相依于安裝內容的位置。</span><span class="sxs-lookup"><span data-stu-id="6bdf6-562">The value -1 in the Root field is required to specify to the Windows Installer that the registration should be redirected to a location that depends upon the installation context.</span></span>

<span data-ttu-id="6bdf6-563">[](registry-table.md)登錄表</span><span class="sxs-lookup"><span data-stu-id="6bdf6-563">[Registry](registry-table.md) Table</span></span>

| <span data-ttu-id="6bdf6-564">登錄</span><span class="sxs-lookup"><span data-stu-id="6bdf6-564">Registry</span></span>                       | <span data-ttu-id="6bdf6-565">Root</span><span class="sxs-lookup"><span data-stu-id="6bdf6-565">Root</span></span> | <span data-ttu-id="6bdf6-566">按鍵</span><span class="sxs-lookup"><span data-stu-id="6bdf6-566">Key</span></span>                                                                              | <span data-ttu-id="6bdf6-567">名稱</span><span class="sxs-lookup"><span data-stu-id="6bdf6-567">Name</span></span>                                   | <span data-ttu-id="6bdf6-568">值</span><span class="sxs-lookup"><span data-stu-id="6bdf6-568">Value</span></span>                                        | <span data-ttu-id="6bdf6-569">元件</span><span class="sxs-lookup"><span data-stu-id="6bdf6-569">Component</span></span>        |
|--------------------------------|------|----------------------------------------------------------------------------------|----------------------------------------|----------------------------------------------|------------------|
| <span data-ttu-id="6bdf6-570">MyPreviewHandlerRegistration1</span><span class="sxs-lookup"><span data-stu-id="6bdf6-570">MyPreviewHandlerRegistration1</span></span>  | <span data-ttu-id="6bdf6-571">-1</span><span class="sxs-lookup"><span data-stu-id="6bdf6-571">-1</span></span>   | <span data-ttu-id="6bdf6-572">軟體 \\ 類別 \\ 。 pua</span><span class="sxs-lookup"><span data-stu-id="6bdf6-572">Software\\Classes\\.pua</span></span>                                                          |                                        | <span data-ttu-id="6bdf6-573">puafile</span><span class="sxs-lookup"><span data-stu-id="6bdf6-573">puafile</span></span>                                      | <span data-ttu-id="6bdf6-574">ProductComponent</span><span class="sxs-lookup"><span data-stu-id="6bdf6-574">ProductComponent</span></span> |
| <span data-ttu-id="6bdf6-575">MyPreviewHandlerRegistration2</span><span class="sxs-lookup"><span data-stu-id="6bdf6-575">MyPreviewHandlerRegistration2</span></span>  | <span data-ttu-id="6bdf6-576">-1</span><span class="sxs-lookup"><span data-stu-id="6bdf6-576">-1</span></span>   | <span data-ttu-id="6bdf6-577">Software \\ Microsoft \\ Windows \\ CurrentVersion \\ PreviewHandlers</span><span class="sxs-lookup"><span data-stu-id="6bdf6-577">Software\\Microsoft\\Windows\\CurrentVersion\\PreviewHandlers</span></span>                    | <span data-ttu-id="6bdf6-578">{1531d583-8375-4d3f-b5fb-d23bbd169f22}</span><span class="sxs-lookup"><span data-stu-id="6bdf6-578">{1531d583-8375-4d3f-b5fb-d23bbd169f22}</span></span> | <span data-ttu-id="6bdf6-579">Microsoft Windows PUA TEST Preview 處理常式</span><span class="sxs-lookup"><span data-stu-id="6bdf6-579">Microsoft Windows PUA TEST Preview Handler</span></span>   | <span data-ttu-id="6bdf6-580">ProductComponent</span><span class="sxs-lookup"><span data-stu-id="6bdf6-580">ProductComponent</span></span> |
| <span data-ttu-id="6bdf6-581">MyPreviewHandlerRegistration3</span><span class="sxs-lookup"><span data-stu-id="6bdf6-581">MyPreviewHandlerRegistration3</span></span>  | <span data-ttu-id="6bdf6-582">-1</span><span class="sxs-lookup"><span data-stu-id="6bdf6-582">-1</span></span>   | <span data-ttu-id="6bdf6-583">軟體 \\ 類別 \\ puafile \\ ShellEx \\ {8895b1c6-b41f-4c1c-a562-0d564250836f}</span><span class="sxs-lookup"><span data-stu-id="6bdf6-583">Software\\Classes\\puafile\\ShellEx\\{8895b1c6-b41f-4c1c-a562-0d564250836f}</span></span>      |                                        | <span data-ttu-id="6bdf6-584">{1531d583-8375-4d3f-b5fb-d23bbd169f22}</span><span class="sxs-lookup"><span data-stu-id="6bdf6-584">{1531d583-8375-4d3f-b5fb-d23bbd169f22}</span></span>       | <span data-ttu-id="6bdf6-585">ProductComponent</span><span class="sxs-lookup"><span data-stu-id="6bdf6-585">ProductComponent</span></span> |
| <span data-ttu-id="6bdf6-586">MyPreviewHandlerRegistration4</span><span class="sxs-lookup"><span data-stu-id="6bdf6-586">MyPreviewHandlerRegistration4</span></span>  | <span data-ttu-id="6bdf6-587">-1</span><span class="sxs-lookup"><span data-stu-id="6bdf6-587">-1</span></span>   | <span data-ttu-id="6bdf6-588">軟體 \\ 類別 \\ CLSID \\ {1531d583-8375-4d3f-b5fb-d23bbd169f22}</span><span class="sxs-lookup"><span data-stu-id="6bdf6-588">Software\\Classes\\CLSID\\{1531d583-8375-4d3f-b5fb-d23bbd169f22}</span></span>                 |                                        | <span data-ttu-id="6bdf6-589">Per-User 應用程式範例1預覽處理常式</span><span class="sxs-lookup"><span data-stu-id="6bdf6-589">Per-User Applicaton Sample 1 Preview Handler</span></span> | <span data-ttu-id="6bdf6-590">ProductComponent</span><span class="sxs-lookup"><span data-stu-id="6bdf6-590">ProductComponent</span></span> |
| <span data-ttu-id="6bdf6-591">MyPreviewHandlerRegistration5</span><span class="sxs-lookup"><span data-stu-id="6bdf6-591">MyPreviewHandlerRegistration5</span></span>  | <span data-ttu-id="6bdf6-592">-1</span><span class="sxs-lookup"><span data-stu-id="6bdf6-592">-1</span></span>   | <span data-ttu-id="6bdf6-593">軟體 \\ 類別 \\ CLSID \\ {1531d583-8375-4d3f-b5fb-d23bbd169f22}</span><span class="sxs-lookup"><span data-stu-id="6bdf6-593">Software\\Classes\\CLSID\\{1531d583-8375-4d3f-b5fb-d23bbd169f22}</span></span>                 | <span data-ttu-id="6bdf6-594">AppID</span><span class="sxs-lookup"><span data-stu-id="6bdf6-594">AppID</span></span>                                  | <span data-ttu-id="6bdf6-595">{6d2b5079-2f0b-48dd-ab7f-97cec514d30b}</span><span class="sxs-lookup"><span data-stu-id="6bdf6-595">{6d2b5079-2f0b-48dd-ab7f-97cec514d30b}</span></span>       | <span data-ttu-id="6bdf6-596">ProductComponent</span><span class="sxs-lookup"><span data-stu-id="6bdf6-596">ProductComponent</span></span> |
| <span data-ttu-id="6bdf6-597">MyPreviewHandlerRegistration6</span><span class="sxs-lookup"><span data-stu-id="6bdf6-597">MyPreviewHandlerRegistration6</span></span>  | <span data-ttu-id="6bdf6-598">-1</span><span class="sxs-lookup"><span data-stu-id="6bdf6-598">-1</span></span>   | <span data-ttu-id="6bdf6-599">軟體 \\ 類別 \\ CLSID \\ {1531d583-8375-4d3f-b5fb-d23bbd169f22}</span><span class="sxs-lookup"><span data-stu-id="6bdf6-599">Software\\Classes\\CLSID\\{1531d583-8375-4d3f-b5fb-d23bbd169f22}</span></span>                 | <span data-ttu-id="6bdf6-600">DisplayName</span><span class="sxs-lookup"><span data-stu-id="6bdf6-600">DisplayName</span></span>                            | <span data-ttu-id="6bdf6-601">@shell32、-38242</span><span class="sxs-lookup"><span data-stu-id="6bdf6-601">@shell32,-38242</span></span>                              | <span data-ttu-id="6bdf6-602">ProductComponent</span><span class="sxs-lookup"><span data-stu-id="6bdf6-602">ProductComponent</span></span> |
| <span data-ttu-id="6bdf6-603">MyPreviewHandlerRegistration7</span><span class="sxs-lookup"><span data-stu-id="6bdf6-603">MyPreviewHandlerRegistration7</span></span>  | <span data-ttu-id="6bdf6-604">-1</span><span class="sxs-lookup"><span data-stu-id="6bdf6-604">-1</span></span>   | <span data-ttu-id="6bdf6-605">軟體 \\ 類別 \\ CLSID \\ {1531d583-8375-4d3f-b5fb-d23bbd169f22}</span><span class="sxs-lookup"><span data-stu-id="6bdf6-605">Software\\Classes\\CLSID\\{1531d583-8375-4d3f-b5fb-d23bbd169f22}</span></span>                 | <span data-ttu-id="6bdf6-606">圖示</span><span class="sxs-lookup"><span data-stu-id="6bdf6-606">Icon</span></span>                                   | <span data-ttu-id="6bdf6-607">notepad.exe，2</span><span class="sxs-lookup"><span data-stu-id="6bdf6-607">notepad.exe,2</span></span>                                | <span data-ttu-id="6bdf6-608">ProductComponent</span><span class="sxs-lookup"><span data-stu-id="6bdf6-608">ProductComponent</span></span> |
| <span data-ttu-id="6bdf6-609">MyPreviewHandlerRegistration8</span><span class="sxs-lookup"><span data-stu-id="6bdf6-609">MyPreviewHandlerRegistration8</span></span>  | <span data-ttu-id="6bdf6-610">-1</span><span class="sxs-lookup"><span data-stu-id="6bdf6-610">-1</span></span>   | <span data-ttu-id="6bdf6-611">軟體 \\ 類別 \\ CLSID \\ {1531d583-8375-4d3f-b5fb-d23bbd169f22} \\ InProcServer32</span><span class="sxs-lookup"><span data-stu-id="6bdf6-611">Software\\Classes\\CLSID\\{1531d583-8375-4d3f-b5fb-d23bbd169f22}\\InProcServer32</span></span> | <span data-ttu-id="6bdf6-612">ThreadingModel</span><span class="sxs-lookup"><span data-stu-id="6bdf6-612">ThreadingModel</span></span>                         | <span data-ttu-id="6bdf6-613">公寓</span><span class="sxs-lookup"><span data-stu-id="6bdf6-613">Apartment</span></span>                                    | <span data-ttu-id="6bdf6-614">ProductComponent</span><span class="sxs-lookup"><span data-stu-id="6bdf6-614">ProductComponent</span></span> |
| <span data-ttu-id="6bdf6-615">MyPreviewHandlerRegistration9</span><span class="sxs-lookup"><span data-stu-id="6bdf6-615">MyPreviewHandlerRegistration9</span></span>  | <span data-ttu-id="6bdf6-616">-1</span><span class="sxs-lookup"><span data-stu-id="6bdf6-616">-1</span></span>   | <span data-ttu-id="6bdf6-617">軟體 \\ 類別 \\ CLSID \\ {1531d583-8375-4d3f-b5fb-d23bbd169f22} \\ InProcServer32</span><span class="sxs-lookup"><span data-stu-id="6bdf6-617">Software\\Classes\\CLSID\\{1531d583-8375-4d3f-b5fb-d23bbd169f22}\\InProcServer32</span></span> |                                        | <span data-ttu-id="6bdf6-618">\#%% SystemRoot% \\ system32 \\shell32.dll</span><span class="sxs-lookup"><span data-stu-id="6bdf6-618">\#%%SystemRoot%\\system32\\shell32.dll</span></span>       | <span data-ttu-id="6bdf6-619">ProductComponent</span><span class="sxs-lookup"><span data-stu-id="6bdf6-619">ProductComponent</span></span> |
| <span data-ttu-id="6bdf6-620">MyPreviewHandlerRegistration10</span><span class="sxs-lookup"><span data-stu-id="6bdf6-620">MyPreviewHandlerRegistration10</span></span> | <span data-ttu-id="6bdf6-621">-1</span><span class="sxs-lookup"><span data-stu-id="6bdf6-621">-1</span></span>   | <span data-ttu-id="6bdf6-622">軟體 \\ 類別 \\ CLSID \\ {1531d583-8375-4d3f-b5fb-d23bbd169f22} \\ InProcServer32</span><span class="sxs-lookup"><span data-stu-id="6bdf6-622">Software\\Classes\\CLSID\\{1531d583-8375-4d3f-b5fb-d23bbd169f22}\\InProcServer32</span></span> | <span data-ttu-id="6bdf6-623">ProgID</span><span class="sxs-lookup"><span data-stu-id="6bdf6-623">ProgID</span></span>                                 | <span data-ttu-id="6bdf6-624">puafile</span><span class="sxs-lookup"><span data-stu-id="6bdf6-624">puafile</span></span>                                      | <span data-ttu-id="6bdf6-625">ProductComponent</span><span class="sxs-lookup"><span data-stu-id="6bdf6-625">ProductComponent</span></span> |



 

 

 
