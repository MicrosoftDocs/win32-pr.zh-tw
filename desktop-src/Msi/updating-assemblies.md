---
description: 本主題中的資訊會識別使用 Windows Installer 修補程式來更新元件的建議指導方針。
ms.assetid: 60c70d48-aae2-4ea5-a880-ac9e2c83c28c
title: 更新組件
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 35b185a9943ba20c81a1fa3431dd590eb05648c9
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/08/2021
ms.locfileid: "104027569"
---
# <a name="updating-assemblies"></a><span data-ttu-id="0d029-103">更新組件</span><span class="sxs-lookup"><span data-stu-id="0d029-103">Updating Assemblies</span></span>

<span data-ttu-id="0d029-104">本主題中的資訊會識別使用 Windows Installer 修補程式來更新元件的建議指導方針。</span><span class="sxs-lookup"><span data-stu-id="0d029-104">The information in this topic identifies the recommended guidelines for updating assemblies using Windows Installer patches.</span></span>

<span data-ttu-id="0d029-105">元件更新的作者可以使用下列指導方針，其適用于所有類型的元件：</span><span class="sxs-lookup"><span data-stu-id="0d029-105">Authors of assembly updates can use the following guidelines, which apply to all types of assemblies:</span></span>

-   <span data-ttu-id="0d029-106">更新元件的建議方法是在 [MsiAssemblyName 資料表](msiassemblyname-table.md)中變更元件的強式名稱。</span><span class="sxs-lookup"><span data-stu-id="0d029-106">The recommended method for updating an assembly is to change the strong name of the assembly in the [MsiAssemblyName table](msiassemblyname-table.md).</span></span> <span data-ttu-id="0d029-107">新元件版本可由新元件或提供舊版本的相同元件提供。</span><span class="sxs-lookup"><span data-stu-id="0d029-107">The new assembly version can be provided by a new component or by the same component that provides the old version.</span></span>
-   <span data-ttu-id="0d029-108">如果新的元件版本是由相同的元件所提供，請勿將元件類型從 .NET Framework 元件變更為 Win32 元件，反之亦然。</span><span class="sxs-lookup"><span data-stu-id="0d029-108">If the new assembly version is provided by the same component, do not change the assembly type from a .NET Framework assembly to a Win32 assembly or vice versa.</span></span>
-   <span data-ttu-id="0d029-109">如果系統上的所有應用程式都必須使用更新的元件，您應該部署原則元件。</span><span class="sxs-lookup"><span data-stu-id="0d029-109">If all applications on the system must use the updated assembly, you should deploy a policy assembly.</span></span> <span data-ttu-id="0d029-110">原則元件可以重新導向系統上的應用程式，以使用新的元件版本。</span><span class="sxs-lookup"><span data-stu-id="0d029-110">A policy assembly can redirect applications on the system to use the new assembly version.</span></span> <span data-ttu-id="0d029-111">您應藉由建立新的元件來提供原則元件。</span><span class="sxs-lookup"><span data-stu-id="0d029-111">Policy assemblies should be provided by creating a new component.</span></span>
-   <span data-ttu-id="0d029-112">需要 Windows Installer 3.0 或更新版本，才能卸載元件更新。</span><span class="sxs-lookup"><span data-stu-id="0d029-112">Windows Installer 3.0 or later is required to uninstall assembly updates.</span></span> <span data-ttu-id="0d029-113">如需詳細資訊，請參閱 [移除修補程式](removing-patches.md)。</span><span class="sxs-lookup"><span data-stu-id="0d029-113">For more information, see [Removing Patches](removing-patches.md).</span></span>
-   <span data-ttu-id="0d029-114">較新版本的元件應該包含先前發行之元件中的相同或更高版本的檔案。</span><span class="sxs-lookup"><span data-stu-id="0d029-114">The newer version of the assembly should contain the same or higher versions of files from previously released assemblies.</span></span>
-   <span data-ttu-id="0d029-115">Windows Installer 3.0 可以透過完整的檔案取代或較小的差異更新來服務 .NET Framework 和 Win32 元件。</span><span class="sxs-lookup"><span data-stu-id="0d029-115">Windows Installer 3.0 can service .NET Framework and Win32 assemblies by a complete file replacement or by a smaller delta update.</span></span> <span data-ttu-id="0d029-116">如需詳細資訊，請參閱 [減少修補程式大小](reducing-patch-size.md)。</span><span class="sxs-lookup"><span data-stu-id="0d029-116">For more information, see [Reducing Patch Size](reducing-patch-size.md).</span></span>
-   <span data-ttu-id="0d029-117">如果您的更新變更元件的強式名稱，則如果 patch 封裝沒有[MsiPatchSequence](msipatchsequence-table.md)資料表，則需要[MsiPatchOldAssemblyFile](msipatcholdassemblyfile-table.md)資料表和[MsiPatchOldAssemblyName](msipatcholdassemblyname-table.md)資料表。</span><span class="sxs-lookup"><span data-stu-id="0d029-117">If your update changes the strong name of the assembly, the [MsiPatchOldAssemblyFile](msipatcholdassemblyfile-table.md) table and [MsiPatchOldAssemblyName](msipatcholdassemblyname-table.md) table are required if the patch package does not have a [MsiPatchSequence](msipatchsequence-table.md) table.</span></span> <span data-ttu-id="0d029-118">如果 patch 封裝在 MsiPatchSequence 資料表中有修補程式的排序資訊，則不需要 MsiPatchOldAssemblyFile 資料表和 MsiPatchOldAssemblyName 資料表。</span><span class="sxs-lookup"><span data-stu-id="0d029-118">The MsiPatchOldAssemblyFile table and MsiPatchOldAssemblyName table are not required if the patch package has patch sequencing information in a MsiPatchSequence table.</span></span>
-   <span data-ttu-id="0d029-119">發行新的修補程式之前，請先將修補程式套用至所有先前發行的修補程式，以測試修補程式。</span><span class="sxs-lookup"><span data-stu-id="0d029-119">Before releasing a new patch, test the patch by applying it with all previously released patches.</span></span>

## <a name="updating-win32-assemblies"></a><span data-ttu-id="0d029-120">更新 Win32 元件</span><span class="sxs-lookup"><span data-stu-id="0d029-120">Updating Win32 Assemblies</span></span>

<span data-ttu-id="0d029-121">當您更新 Win32 元件時，請使用下列指導方針：</span><span class="sxs-lookup"><span data-stu-id="0d029-121">Use the following guidelines when you update Win32 assemblies:</span></span>

-   <span data-ttu-id="0d029-122">變更 [MsiAssemblyName 資料表](msiassemblyname-table.md)中所指定之新元件的強式名稱。</span><span class="sxs-lookup"><span data-stu-id="0d029-122">Change the strong name of the new assembly that is specified in the [MsiAssemblyName table](msiassemblyname-table.md).</span></span>
-   <span data-ttu-id="0d029-123">如果您希望應用程式一律使用新版本的元件，而不會影響系統上其他應用程式所使用的元件版本，請使用相同的元件來包含您用於舊元件版本的新元件版本。</span><span class="sxs-lookup"><span data-stu-id="0d029-123">If you want your application to always use the new version of the assembly without affecting the assembly version used by other applications on the system, use the same component to contain the new assembly version that you used for the old assembly version.</span></span> <span data-ttu-id="0d029-124">在 [元件](component-table.md) 資料表中保留相同的元件。</span><span class="sxs-lookup"><span data-stu-id="0d029-124">Keep the same ComponentId in the [Component](component-table.md) table.</span></span> <span data-ttu-id="0d029-125">當您的應用程式經過修補之後，它只會保存新版元件的參考。</span><span class="sxs-lookup"><span data-stu-id="0d029-125">After your application is patched, it only holds a reference to the new version of the assembly.</span></span> <span data-ttu-id="0d029-126">舊版元件可以保留在全域組件快取中的新版本。</span><span class="sxs-lookup"><span data-stu-id="0d029-126">The old version of the assembly can remain with the new version in the global assembly cache.</span></span> <span data-ttu-id="0d029-127">這不會影響使用舊版元件的系統上的其他應用程式。</span><span class="sxs-lookup"><span data-stu-id="0d029-127">This does not affect other applications on the system that use the old version of the assembly.</span></span> <span data-ttu-id="0d029-128">當相同元件同時用於新舊版本的元件時，您的更新可以是較小的 delta 修補程式。</span><span class="sxs-lookup"><span data-stu-id="0d029-128">When the same component is used for both the new and old versions of the assembly, your update can be a smaller delta patch.</span></span>
-   <span data-ttu-id="0d029-129">如果新版本的元件與您想要安裝應用程式的所有系統不相容，您可以將新舊版本的元件安裝為並存元件。</span><span class="sxs-lookup"><span data-stu-id="0d029-129">If the new version of the assembly is not compatible with all the systems that you want to install your application on, you can install the new and old versions of the assembly as side-by-side assemblies.</span></span> <span data-ttu-id="0d029-130">若要並存安裝這兩個元件版本，請建立新的元件以包含新的元件版本。</span><span class="sxs-lookup"><span data-stu-id="0d029-130">To install both assembly versions side-by-side, create a new component to contain the new assembly version.</span></span> <span data-ttu-id="0d029-131">新元件的 [元件](component-table.md) 資料表中的元件元件應該與舊版元件的元件元件不同。</span><span class="sxs-lookup"><span data-stu-id="0d029-131">The ComponentId in the [Component](component-table.md) table for the new component should be different from the ComponentId of the component with the old version.</span></span> <span data-ttu-id="0d029-132">在您的應用程式修補之後，它會同時保有兩個元件版本的參考。</span><span class="sxs-lookup"><span data-stu-id="0d029-132">After your application is patched, it holds references to both assembly versions.</span></span> <span data-ttu-id="0d029-133">然後，應用程式可以透過資訊清單導向至相容的元件版本。</span><span class="sxs-lookup"><span data-stu-id="0d029-133">Then the application can be directed to the compatible version of the assembly by a manifest.</span></span> <span data-ttu-id="0d029-134">當新舊版本的元件使用不同的元件時，您的更新會使用完整的檔案取代。</span><span class="sxs-lookup"><span data-stu-id="0d029-134">When different components are used for the new and old versions of the assembly, your update uses complete file replacement.</span></span>

## <a name="updating-net-framework-assemblies"></a><span data-ttu-id="0d029-135">更新 .NET Framework 元件</span><span class="sxs-lookup"><span data-stu-id="0d029-135">Updating .NET Framework Assemblies</span></span>

<span data-ttu-id="0d029-136">當您更新 .NET Framework 元件時，請使用下列指導方針。</span><span class="sxs-lookup"><span data-stu-id="0d029-136">Use the following guidelines when you update .NET Framework assemblies.</span></span>

-   <span data-ttu-id="0d029-137">變更 [MsiAssemblyName 資料表](msiassemblyname-table.md)中所指定之新元件的強式名稱。</span><span class="sxs-lookup"><span data-stu-id="0d029-137">Change the strong name of the new assembly that is specified in the [MsiAssemblyName table](msiassemblyname-table.md).</span></span>
-   <span data-ttu-id="0d029-138">如果您想要讓應用程式一律使用新版的元件，而不會影響系統上其他應用程式所使用的元件版本，請變更 [MsiAssemblyName 資料表](msiassemblyname-table.md)中所指定之新元件的強式名稱，並使用相同的元件來包含您用於舊元件版本的新元件版本。</span><span class="sxs-lookup"><span data-stu-id="0d029-138">If you want your application to always use the new version of the assembly without affecting the assembly version used by other applications on the system, change the strong name of the new assembly that is specified in the [MsiAssemblyName table](msiassemblyname-table.md), and use the same component to contain the new assembly version that you used for the old assembly version.</span></span> <span data-ttu-id="0d029-139">在 [元件](component-table.md) 資料表中保留相同的元件。</span><span class="sxs-lookup"><span data-stu-id="0d029-139">Keep the same ComponentId in the [Component](component-table.md) table.</span></span> <span data-ttu-id="0d029-140">當您的應用程式經過修補之後，它只會保存新版元件的參考。</span><span class="sxs-lookup"><span data-stu-id="0d029-140">After your application is patched, it only holds a reference to the new version of the assembly.</span></span> <span data-ttu-id="0d029-141">舊版元件可以保留在全域快取中的新版本。</span><span class="sxs-lookup"><span data-stu-id="0d029-141">The old version of the assembly can remain with the new version in the global cache.</span></span> <span data-ttu-id="0d029-142">這不會影響使用舊版元件的系統上的其他應用程式。</span><span class="sxs-lookup"><span data-stu-id="0d029-142">This does not affect other applications on the system that use the old version of the assembly.</span></span> <span data-ttu-id="0d029-143">當相同元件同時用於新舊版本的元件時，您的更新可以是較小的 delta 修補程式。</span><span class="sxs-lookup"><span data-stu-id="0d029-143">When the same component is used for both the new and old versions of the assembly, your update can be a smaller delta patch.</span></span>
-   <span data-ttu-id="0d029-144">如果新版本的元件與您想要安裝應用程式的所有系統不相容，您可以將新舊版本的元件安裝為並存元件。</span><span class="sxs-lookup"><span data-stu-id="0d029-144">If the new version of the assembly is not compatible with all systems that you want to install your application on, you can install the new and old versions of the assembly as side-by-side assemblies.</span></span> <span data-ttu-id="0d029-145">若要並存安裝這兩個元件版本，請變更 [MsiAssemblyName 資料表](msiassemblyname-table.md)中所指定之新元件的強式名稱，然後建立新的元件以包含新的元件版本。</span><span class="sxs-lookup"><span data-stu-id="0d029-145">To install both assembly versions side-by-side, change the strong name of the new assembly that is specified in the [MsiAssemblyName table](msiassemblyname-table.md), and create a new component to contain the new assembly version.</span></span> <span data-ttu-id="0d029-146">新元件的 [元件](component-table.md) 資料表中的元件元件應該與舊版元件的元件元件不同。</span><span class="sxs-lookup"><span data-stu-id="0d029-146">The ComponentId in the [Component](component-table.md) table for the new component should be different than the ComponentId of the component with the old version.</span></span> <span data-ttu-id="0d029-147">在您的應用程式修補之後，它會同時保有兩個元件版本的參考。</span><span class="sxs-lookup"><span data-stu-id="0d029-147">After your application is patched, it holds references to both assembly versions.</span></span> <span data-ttu-id="0d029-148">然後，應用程式可以透過資訊清單導向至相容的元件版本。</span><span class="sxs-lookup"><span data-stu-id="0d029-148">The application can then be directed to the compatible version of the assembly by a manifest.</span></span> <span data-ttu-id="0d029-149">當新舊版本的元件使用不同的元件時，您的更新會使用完整的檔案取代。</span><span class="sxs-lookup"><span data-stu-id="0d029-149">When different components are used for the new and old versions of the assembly, your update uses complete file replacement.</span></span>
-   <span data-ttu-id="0d029-150">就地更新會覆寫全域組件快取中 .NET Framework 元件的複本。</span><span class="sxs-lookup"><span data-stu-id="0d029-150">An in-place update overwrites the copy of a .NET Framework Assembly in the global assembly cache.</span></span> <span data-ttu-id="0d029-151">這種類型的元件更新不會變更元件的強式名稱。</span><span class="sxs-lookup"><span data-stu-id="0d029-151">This type of assembly update does not change the strong name of the assembly.</span></span> <span data-ttu-id="0d029-152">只有 [MsiAssemblyName 資料表](msiassemblyname-table.md) 的 FileVersion 欄位中的值會變更。</span><span class="sxs-lookup"><span data-stu-id="0d029-152">Only the value in the FileVersion field of the [MsiAssemblyName table](msiassemblyname-table.md) is changed.</span></span> <span data-ttu-id="0d029-153">.NET Framework 元件的就地更新需要 .NET Framework 1.1 SP1 或更新版本。</span><span class="sxs-lookup"><span data-stu-id="0d029-153">The in-place update of a .NET Framework Assembly requires .NET Framework 1.1 SP1 or greater.</span></span>
    > [!Note]  
    > <span data-ttu-id="0d029-154">就地更新類型會覆寫全域快取中的元件複本，而且如果新版本的元件不完全相容，則可能會中斷其他應用程式。</span><span class="sxs-lookup"><span data-stu-id="0d029-154">The in-place type of update overwrites the copy of the assembly in the global cache, and can break other applications if the new version of the assembly is not completely backward compatible.</span></span> <span data-ttu-id="0d029-155">更新元件的建議方法是在 [MsiAssemblyName 資料表](msiassemblyname-table.md)中變更元件的強式名稱。</span><span class="sxs-lookup"><span data-stu-id="0d029-155">The recommended method for updating an assembly is to change the strong name of the assembly in the [MsiAssemblyName table](msiassemblyname-table.md).</span></span>

     

 

 



