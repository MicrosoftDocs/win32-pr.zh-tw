---
description: 任何安裝程式的核心都是檔案的實際安裝。
ms.assetid: e6f6d6a5-bdb0-4866-8d2c-56313d92c94c
title: 檔案版本控制規則
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c8dfda6a909450ba45cc213016a159bbbc8f9a54b958c7d4e37d051fd86935ad
ms.sourcegitcommit: e6600f550f79bddfe58bd4696ac50dd52cb03d7e
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/11/2021
ms.locfileid: "119828978"
---
# <a name="file-versioning-rules"></a>檔案版本控制規則

任何安裝程式的核心都是檔案的實際安裝。 判斷是否要安裝檔案是很複雜的進程。 在最高的層級上，這取決於檔案所屬的元件是否標記為要安裝。 一旦決定要複製檔案之後，如果目的檔案夾中有另一個具有相同名稱的檔案，程式就會很複雜。 在這種情況下，進行判斷需要一組涉及下列屬性的規則：

-   版本
-   日期
-   語言

安裝程式只會在嘗試將檔案安裝至已包含同名檔案的位置時，才會使用這些規則。 在此情況下，Windows Installer 會使用下列規則，所有其他專案都相等，以判斷是否要安裝。

最高版本獲勝—所有其他專案都相等，最高版本的檔案會獲勝，即使電腦上的檔案具有最高版本也是如此。

已建立版本的檔案獲勝—已建立版本的檔案會透過 nonversioned 檔案進行安裝。

偏好產品語言—如果所安裝的檔案與電腦上的檔案具有不同的語言，請使用符合所要安裝產品的語言。 非語言相關的檔案會被視為另一種語言，因此會再次接受安裝的產品。

不相符的多個語言—在將所安裝的檔案和電腦上的檔案中的任何通用語言分解出來之後，會根據所安裝產品所需的語言來偏好任何其他語言。

保留超集合語言：無論檔案是否已在電腦上或正在安裝，都會保留支援多種語言的檔案。

Nonversioned 檔案是使用者資料—如果修改日期晚于電腦上檔案的建立日期，請勿安裝檔案，因為系統會刪除使用者自訂。 如果修改日期和建立日期相同，請安裝檔案。 如果建立日期晚于修改日期，則會將檔案視為未修改，並安裝檔案。

[隨附](companion-files.md)檔案的安裝並不依賴自己的檔案版本設定資訊，而是在其附屬父系的版本控制上。 在隨附檔案的情況下，只有在父檔案的版本較高時，才會略過安裝。 請注意，做為元件之金鑰路徑的檔案不能是隨附的檔案，因為這會導致金鑰路徑檔案的版本設定邏輯是由隨附的父檔案所決定。

使用 [隨附](companion-files.md)檔案的 Nonversioned 檔案-與已建立版本的檔案相關聯的 Nonversioned 檔案，該檔案會使用已建立版本之檔案的規則所遵守的隨附機制來建立關聯的檔案。 唯一的例外狀況是，如果電腦上已建立版本的檔案，且安裝的版本檔案具有相同的版本和語言，但是電腦上遺漏了附屬檔案。 在此情況下，即使使用電腦上已建立版本的檔案，仍會使用所安裝的隨附檔案。 此外，如果 [**REINSTALLMODE**](reinstallmode.md) 屬性包含覆寫舊版選項 ( "o" 或 "e" ) ，而隨附檔案的版本等於已存在於電腦上的檔案，則會安裝使用隨附檔案的 nonversioned 檔案。

規則是全域的，用來決定何時要安裝檔案的規則會位於安裝程式內的一個位置，而且是全域的，這表示它們同樣適用于所有檔案。

如需用於檔案版本之格式的範例，請參閱 [版本](version.md) 資料類型。 如需更具體的資訊，請參閱 [取代現有](replacing-existing-files.md) 的檔案或 [預設檔案版本控制](default-file-versioning.md)。

 

 



