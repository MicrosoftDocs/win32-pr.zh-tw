---
description: Windows Installer 在稱為元件的元件中安裝和移除應用程式或產品。
ms.assetid: 949d8b8c-8f1a-4fde-9a7d-824d33436e62
title: 將應用程式組織成元件
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 0d3fc2db794bef2a29025bf7ebc54c65691145ee
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/07/2021
ms.locfileid: "103848930"
---
# <a name="organizing-applications-into-components"></a><span data-ttu-id="5b4c5-103">將應用程式組織成元件</span><span class="sxs-lookup"><span data-stu-id="5b4c5-103">Organizing Applications into Components</span></span>

<span data-ttu-id="5b4c5-104">Windows Installer 在稱為 [元件的元件](windows-installer-components.md)中安裝和移除應用程式或產品。</span><span class="sxs-lookup"><span data-stu-id="5b4c5-104">Windows Installer installs and removes an application or product in parts referred to as [components](windows-installer-components.md).</span></span> <span data-ttu-id="5b4c5-105">元件是一律以一個單位從使用者的系統中安裝或移除的資源集合。</span><span class="sxs-lookup"><span data-stu-id="5b4c5-105">Components are collections of resources that are always installed or removed as a unit from a user's system.</span></span> <span data-ttu-id="5b4c5-106">資源可以是檔案、登錄機碼、快捷方式，或可能安裝的任何其他檔案。</span><span class="sxs-lookup"><span data-stu-id="5b4c5-106">A resource can be a file, registry key, shortcut, or anything else that may be installed.</span></span> <span data-ttu-id="5b4c5-107">每個元件都會被指派一個唯一的元件程式碼 [GUID](guid.md)。</span><span class="sxs-lookup"><span data-stu-id="5b4c5-107">Every component is assigned a unique component code [GUID](guid.md).</span></span>

<span data-ttu-id="5b4c5-108">安裝套件的作者應該只建立可安裝和移除的元件和元件版本，而不會破壞其他元件。</span><span class="sxs-lookup"><span data-stu-id="5b4c5-108">Authors of installation packages should only create components, and versions of components, that can be installed and removed without damaging other components.</span></span> <span data-ttu-id="5b4c5-109">此外，移除元件時，不應該留下使用者電腦上任何孤立的資源，例如未使用的檔案、登錄機碼或快捷方式。</span><span class="sxs-lookup"><span data-stu-id="5b4c5-109">Also, the removal of a component should not leave behind any orphaned resources on the user's computer, such as unused files, registry keys, or shortcuts.</span></span> <span data-ttu-id="5b4c5-110">為確保這一點，作者在將資源組織成元件時，應遵守下列一般規則：</span><span class="sxs-lookup"><span data-stu-id="5b4c5-110">To ensure this, authors should adhere to the following general rules when organizing resources into components:</span></span>

-   <span data-ttu-id="5b4c5-111">請勿建立兩個元件，以在相同的名稱和目標位置下安裝資源。</span><span class="sxs-lookup"><span data-stu-id="5b4c5-111">Never create two components that install a resource under the same name and target location.</span></span> <span data-ttu-id="5b4c5-112">如果資源必須在多個元件中重複，請在每個元件中變更其名稱或目標位置。</span><span class="sxs-lookup"><span data-stu-id="5b4c5-112">If a resource must be duplicated in multiple components, change its name or target location in each component.</span></span> <span data-ttu-id="5b4c5-113">您應在應用程式、產品、產品版本和公司之間套用此規則。</span><span class="sxs-lookup"><span data-stu-id="5b4c5-113">This rule should be applied across applications, products, product versions, and companies.</span></span>
-   <span data-ttu-id="5b4c5-114">請注意，先前的規則表示兩個元件不得有相同的金鑰路徑檔案。</span><span class="sxs-lookup"><span data-stu-id="5b4c5-114">Note that the previous rule means that two components must not have the same key path file.</span></span> <span data-ttu-id="5b4c5-115">金鑰路徑值指向特定的檔案或資料夾，而該檔案或資料夾屬於安裝程式用來偵測元件的元件。</span><span class="sxs-lookup"><span data-stu-id="5b4c5-115">The key path value points to a particular file or folder belonging to the component that the installer uses to detect the component.</span></span> <span data-ttu-id="5b4c5-116">如果有兩個元件具有相同的金鑰路徑檔案，安裝程式將無法區分安裝的元件。</span><span class="sxs-lookup"><span data-stu-id="5b4c5-116">If two components had the same key path file, the installer would be unable to distinguish which component is installed.</span></span> <span data-ttu-id="5b4c5-117">不過，兩個元件可能會共用金鑰路徑資料夾。</span><span class="sxs-lookup"><span data-stu-id="5b4c5-117">Two components however may share a key path folder.</span></span>
-   <span data-ttu-id="5b4c5-118">請勿建立與所有舊版元件不相容的元件版本。</span><span class="sxs-lookup"><span data-stu-id="5b4c5-118">Do not create a version of a component that is incompatible with all previous versions of the component.</span></span> <span data-ttu-id="5b4c5-119">元件可由其他應用程式、產品、產品版本和公司共用。</span><span class="sxs-lookup"><span data-stu-id="5b4c5-119">The component may be shared by other applications, products, product versions, and companies.</span></span> <span data-ttu-id="5b4c5-120">改為建立新的元件。</span><span class="sxs-lookup"><span data-stu-id="5b4c5-120">Instead create a new component.</span></span>
-   <span data-ttu-id="5b4c5-121">請勿建立包含資源的元件，這些資源必須安裝到使用者系統上的多個目錄中。</span><span class="sxs-lookup"><span data-stu-id="5b4c5-121">Do not create components containing resources that will need to be installed into more than one directory on the user's system.</span></span> <span data-ttu-id="5b4c5-122">安裝程式會將元件中的所有資源都安裝在相同的目錄中。</span><span class="sxs-lookup"><span data-stu-id="5b4c5-122">The installer installs all of the resources in a component into the same directory.</span></span> <span data-ttu-id="5b4c5-123">您無法將部分資源安裝至子目錄。</span><span class="sxs-lookup"><span data-stu-id="5b4c5-123">It is not possible to install some resources into subdirectories.</span></span>
-   <span data-ttu-id="5b4c5-124">每個元件請勿包含一部以上的 COM 伺服器。</span><span class="sxs-lookup"><span data-stu-id="5b4c5-124">Do not include more than one COM server per component.</span></span> <span data-ttu-id="5b4c5-125">如果元件包含 COM 伺服器，這就必須是元件的金鑰路徑。</span><span class="sxs-lookup"><span data-stu-id="5b4c5-125">If a component contains a COM server, this must be the key path for the component.</span></span>
-   <span data-ttu-id="5b4c5-126">請勿將每個元件的一個以上的檔案指定為 [ **開始** ] 功能表或桌面快捷方式的目標。</span><span class="sxs-lookup"><span data-stu-id="5b4c5-126">Do not specify more than one file per component as a target for the **Start** menu or a Desktop shortcut.</span></span>

<span data-ttu-id="5b4c5-127">當您將應用程式組織成元件時，套件作者可能需要在現有安裝中新增、移除或修改資源。</span><span class="sxs-lookup"><span data-stu-id="5b4c5-127">When organizing an application into components, package authors may need to add, remove, or modify the resources in an existing installation.</span></span> <span data-ttu-id="5b4c5-128">在此情況下，作者必須透過引進新元件或修改現有的元件，並將其變更為新版本的元件，來決定是否要提供資源。</span><span class="sxs-lookup"><span data-stu-id="5b4c5-128">In this case, the author must decide whether to provide the resources by introducing a new component or by modifying existing components and changing them into a new version of the component.</span></span> <span data-ttu-id="5b4c5-129">因為引進了新的元件時，必須指派唯一的元件程式碼，所以作者必須判斷其變更是否需要變更元件程式碼。</span><span class="sxs-lookup"><span data-stu-id="5b4c5-129">Because a unique component code must be assigned when a new component is introduced, authors must determine whether their changes require changing the component code.</span></span> <span data-ttu-id="5b4c5-130">如需詳細資訊，請參閱 [變更元件程式碼](changing-the-component-code.md)、 [元件規則中斷時會發生什麼事？](what-happens-if-the-component-rules-are-broken.md)以及 [定義安裝程式元件](defining-installer-components.md)。</span><span class="sxs-lookup"><span data-stu-id="5b4c5-130">For more information, see [Changing the Component Code](changing-the-component-code.md), [What happens if the component rules are broken?](what-happens-if-the-component-rules-are-broken.md), and [Defining Installer Components](defining-installer-components.md).</span></span>

 

 



