---
description: Windows安裝程式會在稱為元件的元件中安裝和移除應用程式或產品。
ms.assetid: 949d8b8c-8f1a-4fde-9a7d-824d33436e62
title: 將應用程式組織成元件
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 1398bbbacbdb15df148576ebf0904f7aec98354a4d417681a81f2195535f08d7
ms.sourcegitcommit: e6600f550f79bddfe58bd4696ac50dd52cb03d7e
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/11/2021
ms.locfileid: "120129188"
---
# <a name="organizing-applications-into-components"></a>將應用程式組織成元件

Windows安裝程式會在稱為[元件的元件](windows-installer-components.md)中安裝和移除應用程式或產品。 元件是一律以一個單位從使用者的系統中安裝或移除的資源集合。 資源可以是檔案、登錄機碼、快捷方式，或可能安裝的任何其他檔案。 每個元件都會被指派一個唯一的元件程式碼 [GUID](guid.md)。

安裝套件的作者應該只建立可安裝和移除的元件和元件版本，而不會破壞其他元件。 此外，移除元件時，不應該留下使用者電腦上任何孤立的資源，例如未使用的檔案、登錄機碼或快捷方式。 為確保這一點，作者在將資源組織成元件時，應遵守下列一般規則：

-   請勿建立兩個元件，以在相同的名稱和目標位置下安裝資源。 如果資源必須在多個元件中重複，請在每個元件中變更其名稱或目標位置。 您應在應用程式、產品、產品版本和公司之間套用此規則。
-   請注意，先前的規則表示兩個元件不得有相同的金鑰路徑檔案。 金鑰路徑值指向特定的檔案或資料夾，而該檔案或資料夾屬於安裝程式用來偵測元件的元件。 如果有兩個元件具有相同的金鑰路徑檔案，安裝程式將無法區分安裝的元件。 不過，兩個元件可能會共用金鑰路徑資料夾。
-   請勿建立與所有舊版元件不相容的元件版本。 元件可由其他應用程式、產品、產品版本和公司共用。 改為建立新的元件。
-   請勿建立包含資源的元件，這些資源必須安裝到使用者系統上的多個目錄中。 安裝程式會將元件中的所有資源都安裝在相同的目錄中。 您無法將部分資源安裝至子目錄。
-   每個元件請勿包含一部以上的 COM 伺服器。 如果元件包含 COM 伺服器，這就必須是元件的金鑰路徑。
-   請勿將每個元件的一個以上的檔案指定為 [ **開始** ] 功能表或桌面快捷方式的目標。

當您將應用程式組織成元件時，套件作者可能需要在現有安裝中新增、移除或修改資源。 在此情況下，作者必須透過引進新元件或修改現有的元件，並將其變更為新版本的元件，來決定是否要提供資源。 因為引進了新的元件時，必須指派唯一的元件程式碼，所以作者必須判斷其變更是否需要變更元件程式碼。 如需詳細資訊，請參閱 [變更元件程式碼](changing-the-component-code.md)、 [元件規則中斷時會發生什麼事？](what-happens-if-the-component-rules-are-broken.md)以及 [定義安裝程式元件](defining-installer-components.md)。

 

 



