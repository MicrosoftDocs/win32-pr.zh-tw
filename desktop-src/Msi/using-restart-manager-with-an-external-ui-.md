---
description: Windows Installer 開發人員可以遵循搭配使用 Windows Installer 與重新開機管理員中所述的指導方針，來準備安裝套件以使用重新開機管理員。
ms.assetid: 777f8864-b3d2-43c7-9296-1118f3595d7b
title: 搭配外部 UI 使用重新開機管理員
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 0f112884669b173b40f3806c48cf8e05308c5b44
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/07/2021
ms.locfileid: "104191372"
---
# <a name="using-restart-manager-with-an-external-ui"></a><span data-ttu-id="510ab-103">搭配外部 UI 使用重新開機管理員</span><span class="sxs-lookup"><span data-stu-id="510ab-103">Using Restart Manager with an External UI</span></span>

<span data-ttu-id="510ab-104">Windows Installer 開發人員可以遵循搭配[使用 Windows Installer 與重新開機管理員](using-windows-installer-with-restart-manager.md)中所述的指導方針，來準備安裝套件以使用[重新開機管理員](../rstmgr/restart-manager-portal.md)。</span><span class="sxs-lookup"><span data-stu-id="510ab-104">Windows Installer developers can prepare their installation package to work with [Restart Manager](../rstmgr/restart-manager-portal.md) by following the guidelines described in [Using Windows Installer with Restart Manager](using-windows-installer-with-restart-manager.md).</span></span>

<span data-ttu-id="510ab-105">\_呼叫 [**MsiSetExternalUI**](/windows/desktop/api/Msi/nf-msi-msisetexternaluia)或 [**MsiSetExternalUIRecord**](/windows/desktop/api/Msi/nf-msi-msisetexternaluirecord)函式來啟用外部使用者介面處理常式時，請指定 INSTALLLOGMODE RMFILESINUSE 訊息類型。</span><span class="sxs-lookup"><span data-stu-id="510ab-105">Specify the INSTALLLOGMODE\_RMFILESINUSE message type when calling the [**MsiSetExternalUI**](/windows/desktop/api/Msi/nf-msi-msisetexternaluia) or [**MsiSetExternalUIRecord**](/windows/desktop/api/Msi/nf-msi-msisetexternaluirecord) function to enable the external user-interface handler.</span></span> <span data-ttu-id="510ab-106">Windows Installer 然後傳送 INSTALLMESSAGE \_ RMFILESINUSE 訊息，以供支援 [重新開機管理員](../rstmgr/restart-manager-portal.md)的外部使用者介面處理常式使用。</span><span class="sxs-lookup"><span data-stu-id="510ab-106">Windows Installer then sends an INSTALLMESSAGE\_RMFILESINUSE message for use by external user-interface handlers that support the [Restart Manager](../rstmgr/restart-manager-portal.md).</span></span>

<span data-ttu-id="510ab-107">您的外部使用者介面處理常式應處理 INSTALLMESSAGE RMFILESINUSE 訊息中包含的資訊 \_ 。</span><span class="sxs-lookup"><span data-stu-id="510ab-107">Your external user-interface handler should handle the information contained in INSTALLMESSAGE\_RMFILESINUSE messages.</span></span> <span data-ttu-id="510ab-108">如果沒有已註冊的或內部使用者介面處理 INSTALLMESSAGE \_ RMFILESINUSE 訊息，Windows Installer 傳送 INSTALLMESSAGE \_ FILESINUSE 訊息，供支援 INSTALLMESSAGE \_ FILESINUSE 訊息和 [FILESINUSE](filesinuse-dialog.md) 對話方塊的現有外部處理常式使用。</span><span class="sxs-lookup"><span data-stu-id="510ab-108">If no registered or internal user-interface handles the INSTALLMESSAGE\_RMFILESINUSE message, Windows Installer sends an INSTALLMESSAGE\_FILESINUSE message for use by existing external handlers that support INSTALLMESSAGE\_FILESINUSE messages and the [FilesInUse](filesinuse-dialog.md) dialog box.</span></span>

<span data-ttu-id="510ab-109">外部使用者介面可以傳回下表所列的值。</span><span class="sxs-lookup"><span data-stu-id="510ab-109">The external user interface can return the values listed in the following table.</span></span>



| <span data-ttu-id="510ab-110">外部 UI 傳回值</span><span class="sxs-lookup"><span data-stu-id="510ab-110">External UI return value</span></span> | <span data-ttu-id="510ab-111">Windows Installer 採取的動作</span><span class="sxs-lookup"><span data-stu-id="510ab-111">Action taken by Windows Installer</span></span>                                                                                                                                                                                                                                                                                                              |
|--------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="510ab-112">IDOK</span><span class="sxs-lookup"><span data-stu-id="510ab-112">IDOK</span></span>                     | <span data-ttu-id="510ab-113">使用者已按下 [ **確定]** 按鈕。</span><span class="sxs-lookup"><span data-stu-id="510ab-113">The **OK** button was pressed by the user.</span></span> <span data-ttu-id="510ab-114">Windows Installer 將要求 [重新開機管理員](../rstmgr/restart-manager-portal.md) 關閉，然後重新開機包含目前使用中之檔案的應用程式。</span><span class="sxs-lookup"><span data-stu-id="510ab-114">The Windows Installer will request that the [Restart Manager](../rstmgr/restart-manager-portal.md) shut down and restart the applications that hold files currently in use.</span></span>                                                                                                                                               |
| <span data-ttu-id="510ab-115">IDCANCEL</span><span class="sxs-lookup"><span data-stu-id="510ab-115">IDCANCEL</span></span>                 | <span data-ttu-id="510ab-116">已按下 [ **取消** ] 按鈕。</span><span class="sxs-lookup"><span data-stu-id="510ab-116">The **CANCEL** button was pressed.</span></span> <span data-ttu-id="510ab-117">取消安裝。</span><span class="sxs-lookup"><span data-stu-id="510ab-117">Cancel the installation.</span></span>                                                                                                                                                                                                                                                                                    |
| <span data-ttu-id="510ab-118">IDIGNORE</span><span class="sxs-lookup"><span data-stu-id="510ab-118">IDIGNORE</span></span>                 | <span data-ttu-id="510ab-119">已按下 [ **忽略** ] 按鈕。</span><span class="sxs-lookup"><span data-stu-id="510ab-119">The **IGNORE** button was pressed.</span></span> <span data-ttu-id="510ab-120">略過並繼續安裝。</span><span class="sxs-lookup"><span data-stu-id="510ab-120">Ignore and continue the installation.</span></span> <span data-ttu-id="510ab-121">安裝結束時將需要重新開機。</span><span class="sxs-lookup"><span data-stu-id="510ab-121">A restart will be required at the end of the installation.</span></span>                                                                                                                                                                                                            |
| <span data-ttu-id="510ab-122">IDNO</span><span class="sxs-lookup"><span data-stu-id="510ab-122">IDNO</span></span>                     | <span data-ttu-id="510ab-123">未按下 [ **否** ] 按鈕。</span><span class="sxs-lookup"><span data-stu-id="510ab-123">The **NO** button was pressed.</span></span> <span data-ttu-id="510ab-124">如果封裝有 [MsiRMFilesInUse](msirmfilesinuse-dialog.md) 對話方塊，請傳送1610訊息。</span><span class="sxs-lookup"><span data-stu-id="510ab-124">If the package has an [MsiRMFilesInUse](msirmfilesinuse-dialog.md) dialog box, send a 1610 message.</span></span> <span data-ttu-id="510ab-125">如需詳細資訊，請參閱 [Windows Installer 錯誤訊息](windows-installer-error-messages.md)。</span><span class="sxs-lookup"><span data-stu-id="510ab-125">For more information, see [Windows Installer Error Messages](windows-installer-error-messages.md).</span></span> <span data-ttu-id="510ab-126">如果封裝沒有 MsiRMFilesInUse 對話方塊，請傳送 INSTALLMESSAGE \_ FILESINUSE 訊息。</span><span class="sxs-lookup"><span data-stu-id="510ab-126">If the package does not have a MsiRMFilesInUse dialog box, send an INSTALLMESSAGE\_FILESINUSE message.</span></span> |
| <span data-ttu-id="510ab-127">IDRETRY</span><span class="sxs-lookup"><span data-stu-id="510ab-127">IDRETRY</span></span>                  | <span data-ttu-id="510ab-128">已按下 [ **重試** ] 按鈕。</span><span class="sxs-lookup"><span data-stu-id="510ab-128">The **RETRY** button was pressed.</span></span> <span data-ttu-id="510ab-129">傳送 INSTALLMESSAGE \_ FILESINUSE 訊息。</span><span class="sxs-lookup"><span data-stu-id="510ab-129">Send the INSTALLMESSAGE\_FILESINUSE message.</span></span>                                                                                                                                                                                                                                                                 |
| <span data-ttu-id="510ab-130">-1</span><span class="sxs-lookup"><span data-stu-id="510ab-130">-1</span></span>                       | <span data-ttu-id="510ab-131">錯誤。</span><span class="sxs-lookup"><span data-stu-id="510ab-131">An error.</span></span> <span data-ttu-id="510ab-132">結束安裝。</span><span class="sxs-lookup"><span data-stu-id="510ab-132">End the installation.</span></span>                                                                                                                                                                                                                                                                                                                |



 

 

 
