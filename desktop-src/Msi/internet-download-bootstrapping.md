---
description: 有了 Windows Installer，適用于) 開發人員的 Windows SDK 元件包含可設定的啟動程式可執行檔 (Setup.exe) 和 configuration tool (Msistuff.exe Windows Installer。
ms.assetid: 478340b4-5ee8-4ae6-b2d4-f53afbf098d9
title: 網際網路下載啟動載入
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 44e051382d425c0e4f99d30e5fa224967127cfff
ms.sourcegitcommit: 6515eef99ca0d1bbe3e27d4575e9986f5255f277
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 03/10/2021
ms.locfileid: "103946028"
---
# <a name="internet-download-bootstrapping"></a>網際網路下載啟動載入

有了 Windows Installer，[適用于Msistuff.exe開發人員的) 元件](platform-sdk-components-for-windows-installer-developers.md)包含可設定的啟動程式可執行檔 (Setup.exe) 和設定工具 ([Windows SDK](msistuff-exe.md) Windows Installer。 藉由使用 Msistuff.exe 設定 Setup.exe 中的資源，開發人員可以輕鬆地建立 Windows Installer 套件的 web 安裝。

啟動程式可執行檔所需的最低安裝程式版本是 Windows Installer 版本2.0。 應用程式可以使用 [**DllGetVersion**](/windows/win32/api/shlwapi/nc-shlwapi-dllgetversionproc)取得安裝程式版本。 如需詳細資訊，請參閱 [判斷 Windows Installer 版本](determining-the-windows-installer-version.md)

Windows Installer SDK 提供的啟動程式可執行檔會執行下列動作：

-   呼叫 [**WinVerifyTrust**](/windows/win32/api/wintrust/nf-wintrust-winverifytrust) 來驗證 .msi 檔案的數位簽章。 Windows Installer 2.0 版和更新版本會提供主體介面套件 (SIP) 來啟用 Windows Installer 套件的簽署。
-   必要時，請升級機器上的 Windows Installer 版本。

您可以使用 [Msistuff.exe](msistuff-exe.md)來顯示或設定 Setup.exe 的下列資源。



| 資源識別碼                  | 描述                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| ISETUPPROPNAME \_ BASEURL      | Setup.exe 的基底 URL 位置。 如果未指定任何值，Setup.exe 的位置預設為卸載式媒體。 只有以 URL 為基礎的安裝受限於 [**WinVerifyTrust**](/windows/win32/api/wintrust/nf-wintrust-winverifytrust)的檢查。 URL 的尾端正斜線是選擇性的。 這是選擇性資源。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| ISETUPPROPNAME \_ 資料庫     | .Msi 檔案的名稱。 這是相對於 Setup.exe 程式位置所指定之 .msi 檔案的相對路徑。 如果未指定資源 ISETUPPROPNAME 修補程式，則需要此資源 \_ 。 \_無法同時指定 ISETUPPROPNAME 資料庫和 ISETUPPROPNAME \_ 修補程式。 只能指定兩個中的一個。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| ISETUPPROPNAME \_ 操作    | 要執行的作業類型。 可能的值為 INSTALL、MINPATCH、MAJPATCH 和 INSTALLUPD。 安裝值等於封裝的第一次安裝。 MINPATCH 值表示 PATCH 屬性中指定的修補程式是小型或次要升級修補程式。 MAJPATCH 值表示 PATCH 屬性中指定的修補程式是重大更新修補程式。 INSTALLUPD 指出安裝可能是第一次安裝或更新。 使用 INSTALLUPD 時，會檢查產品是否存在。 如果產品存在，則會設定重新建立緩存套件旗標，並執行重新安裝;否則，系統會定期執行安裝。 請注意，INSTALLUPD 只能用於未變更產品代碼的小型和次要升級套件。 在主要升級中，不需要重新安裝，因為產品程式碼的變更，基本上是建立全新的產品。 除了 FindRelatedProducts、MigrateFeatureStates 和 RemoveExistingProducts 動作之外，還會針對原始產品的升級進行升級資料表的撰寫。 因此，安裝選項就夠了。 如果缺少此資源，則會假設已撰寫 ISETUPPROPNAME 資料庫屬性，則會假設安裝作業 \_ 。 否則，如果撰寫 ISETUPPROPNAME PATCH 屬性，則會假設為 MINPATCH \_ 。 這是選擇性的值。 |
| ISETUPPROPNAME \_ PRODUCTNAME  | 產品的名稱。 這是在下載的使用者介面中，橫幅文字所使用的名稱。 這是選擇性資源。 如果省略，則名稱預設為 "product"。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| ISETUPPROPNAME \_ 最小 \_ MSI | 所需 Windows Installer 的最小版本。 如果電腦上未安裝 Windows Installer 的最小版本，則會呼叫適當的 [Instmsi.exe](instmsi-exe.md) 來升級 Windows Installer。 這個屬性的值與 PID PAGECOUNT 值具有相同的格式 \_ 。 如需詳細資訊，請參閱 [**頁面計數摘要**](page-count-summary.md) 屬性。 此值必須至少為200，此值會識別 Windows Installer 版本2.0。 這是必要的資源。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| ISETUPPROPNAME \_ INSTLOCATION | Windows Installer 升級可執行檔的基底 URL 位置。 可能會省略此資源。 如果省略此值，升級可執行檔的預設位置就是 Setup.exe 的位置。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| ISETUPPROPNAME \_ INSTMSIA     | Windows Installer 升級可執行檔之 ANSI 版本的名稱。 這是與 ISETUPPROPNAME INSTLOCATION 所指定之位置相對的 ANSI 版本 Instmsi.exe 相對路徑 \_ 。 這是必要的資源。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| ISETUPPROPNAME \_ INSTMSIW     | Windows Installer 升級可執行檔的 Unicode 版本名稱。 這是相對於 ISETUPPROPNAME INSTLOCATION 所指定之位置的 Unicode 版本 Instmsi.exe 相對路徑 \_ 。 這是必要的資源。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| ISETUPPROPNAME \_ 修補程式        | .Msp 檔的名稱。 這是相對於 Setup.exe 程式位置所指定之 .msp 檔的相對路徑。 如果未指定資源 ISETUPPROPNAME 資料庫，則需要此資源 \_ 。 \_無法同時指定 ISETUPPROPNAME 資料庫和 ISETUPPROPNAME \_ 修補程式。 只能指定兩個中的一個。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| ISETUPPROPNAME \_ 屬性   | PROPERTY = 值字串。 這些是要包含在命令列中的屬性 = 值配對。 此選項是選擇性的。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |



 

例如，下列 ISETUPPROPNAME \_ BASEURL 和 ISETUPPROPNAME \_ 資料庫值將用於下列假設的封裝位置。



| 實際的封裝位置                                                                            | 資源值                                                                                                                               |
|----------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------|
| HTTPs： \/ /www.blueyonderairlines.com/Products/Product1/product1.msi                                   | ISETUPPROPNAME \_ BASEURL = HTTPs： \/ /Www.blueyonderairlines.com/Products/Product1 ISETUPPROPNAME \_ DATABASE = product1.msi<br/>              |
| HTTPs： \/ /www.blueyonderairlines.com/Products/Product1/product1.msi                                   | ISETUPPROPNAME \_ BASEURL = HTTPs： \/ /Www.blueyonderairlines.com/Products/Product1 ISETUPPROPNAME \_ DATABASE = .。。/Products1/product1.msi<br/> |
| e： \\product1.msi                                                                                   | 省略 ISETUPPROPNAME \_ BASEURL。 ISETUPPROPNAME \_ 資料庫 = product1.msi<br/>                                                              |
| e： \\ 安裝 \\product1.msi (目前正在執行的 Setup.exe 的位置是 e： \\setup.exe。 ) <br/> | 省略 ISETUPPROPNAME \_ BASEURL。 ISETUPPROPNAME \_ 資料庫 = 安裝 \\product1.msi<br/>                                                       |



 

## <a name="setupexe-command-line-parameters"></a>Setup.exe 命令列參數

下表列出可以與 [Windows Installer 開發人員 Windows SDK 元件](platform-sdk-components-for-windows-installer-developers.md)隨附的 Setup.exe 搭配使用的命令選項。 當叫用時沒有任何命令列選項，Setup.exe 預設為透過設定的資源所指定的行為。 命令列選項是互斥的，一次只能使用其中一個選項。



| 選項 | 使用方式                                                                      | 意義                                                                                                                                                                                                                                                                                                         |
|--------|----------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| **/a** | setup.exe **/a**                                                           | 起始系統管理安裝。 如果 \_ Setup.exe 中設定了 ISETUPPROPNAME 資料庫屬性，則可以使用此選項來執行產品的系統管理安裝。 如果 \_ 已設定 ISETUPPROPNAME 修補程式資源，則不支援此命令列選項。<br/> |
| **/a** | setup.exe **/a** *<現有系統管理安裝>的完整路徑* | 如果 \_ Setup.exe 中設定了 ISETUPPROPNAME PATCH 屬性，則可以使用此選項來修補產品的現有系統管理安裝。 如果已設定 ISETUPPROPNAME 資料庫資源，則不支援此命令列選項 \_ 。                                               |
| **/v** | setup.exe **/v***<full path to a file>*                             | 使用 WinVerifyTrust 驗證檔案上的簽章。 使用這個選項時，不會顯示任何 UI。 在此情況下，信任檢查的結果是從執行 Setup.exe 取得的傳回值。                                                                                                 |
| **/?** |                                                                            | 顯示說明對話方塊，指出有效的引數。 注意：如果提供的引數無效，也會顯示 [說明] 對話方塊。                                                                                                                                                                               |



 

如需詳細資訊，請參閱 [以 URL 為基礎的 Windows Installer 安裝範例](a-url-based-windows-installer-installation-example.md)。

 

 
