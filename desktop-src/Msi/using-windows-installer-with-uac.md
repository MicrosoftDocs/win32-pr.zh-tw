---
description: Windows Installer 符合 Windows Vista 中 (UAC) 的使用者帳戶控制。
ms.assetid: 13955ded-6b7f-475f-bb0f-6530a0b4963f
title: 搭配使用 Windows Installer 與 UAC
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 77a05dcd2fb33eff24fb17702af1cb306f81002d
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/07/2021
ms.locfileid: "104114152"
---
# <a name="using-windows-installer-with-uac"></a><span data-ttu-id="0ec55-103">搭配使用 Windows Installer 與 UAC</span><span class="sxs-lookup"><span data-stu-id="0ec55-103">Using Windows Installer with UAC</span></span>

<span data-ttu-id="0ec55-104">Windows Installer 符合 Windows Vista 中 (UAC) 的 [*使用者帳戶控制*](u-gly.md) 。</span><span class="sxs-lookup"><span data-stu-id="0ec55-104">Windows Installer complies with [*User Account Control*](u-gly.md) (UAC) in Windows Vista.</span></span> <span data-ttu-id="0ec55-105">透過系統管理員的授權，Windows Installer 可以代表可能不是系統管理員群組成員的使用者來安裝應用程式或修補程式。</span><span class="sxs-lookup"><span data-stu-id="0ec55-105">With authorization from an administrator, the Windows Installer can install applications or patches on behalf of a user that may not be a member of the Administrators group.</span></span> <span data-ttu-id="0ec55-106">這稱為提高 [*許可權*](e-gly.md) 的安裝，因為 Windows Installer 會代表使用者對系統進行變更，而使用者直接進行變更時通常不會允許。</span><span class="sxs-lookup"><span data-stu-id="0ec55-106">This is referred to as an [*elevated*](e-gly.md) installation because the Windows Installer makes changes to the system on behalf of the user that would not normally be allowed if the user were making the changes directly.</span></span>

-   <span data-ttu-id="0ec55-107">在公司環境中使用 Windows Vista 時，可以將應用程式指定為受控應用程式。</span><span class="sxs-lookup"><span data-stu-id="0ec55-107">When using Windows Vista in a corporate environment, applications can be designated as managed applications.</span></span> <span data-ttu-id="0ec55-108">系統管理員可以使用應用程式部署和 [群組原則](/previous-versions/windows/desktop/Policy/group-policy-start-page)來鎖定目錄，然後將這些目錄中的受控應用程式指派或發佈給 [*標準使用者*](s-gly.md) ，以進行安裝、修復或移除。</span><span class="sxs-lookup"><span data-stu-id="0ec55-108">Using application deployment and [Group Policy](/previous-versions/windows/desktop/Policy/group-policy-start-page), administrators can lockdown directories and then assign or publish the managed applications in those directories to [*standard users*](s-gly.md) for install, repair, or removal.</span></span> <span data-ttu-id="0ec55-109">受控應用程式會在 **HKEY \_ 本機 \_ 電腦** 登錄 hive 中註冊。</span><span class="sxs-lookup"><span data-stu-id="0ec55-109">Managed applications are registered in the **HKEY\_LOCAL\_MACHINE** registry hive.</span></span> <span data-ttu-id="0ec55-110">一旦將應用程式註冊為受控應用程式，後續的安裝作業一律會以較高的許可權執行。</span><span class="sxs-lookup"><span data-stu-id="0ec55-110">Once an application has been registered as a managed application, subsequent installation operations always run with elevated privileges.</span></span> <span data-ttu-id="0ec55-111">如果使用者是以系統管理員身分執行，則不需要提示以繼續安裝。</span><span class="sxs-lookup"><span data-stu-id="0ec55-111">If the user is running as an administrator, no prompting is required to continue the installation.</span></span> <span data-ttu-id="0ec55-112">如果使用者是以標準使用者的身份執行，而且已指派或發佈該應用程式，則可以在不提示的情況下繼續安裝受控應用程式。</span><span class="sxs-lookup"><span data-stu-id="0ec55-112">If the user is running as a standard user, and the application has already been assigned or published, the installation of the managed application can continue without prompting.</span></span>
-   <span data-ttu-id="0ec55-113">在非企業環境中使用 Windows Vista 時，UAC 會處理應用程式安裝的提高許可權。</span><span class="sxs-lookup"><span data-stu-id="0ec55-113">When using Windows Vista in a non-corporate environment, UAC handles the elevation of application installation.</span></span> <span data-ttu-id="0ec55-114">Windows Installer 4.0 可以 (AIS) 呼叫 [*應用程式資訊服務*](a-gly.md) ，要求系統管理員授權提高安裝的許可權。</span><span class="sxs-lookup"><span data-stu-id="0ec55-114">Windows Installer 4.0 can call to the [*Application Information Service*](a-gly.md) (AIS) to request administrator authorization to elevate an installation.</span></span> <span data-ttu-id="0ec55-115">在識別為需要系統管理員許可權的安裝之前，UAC 會提示使用者是否同意提升安裝的許可權。</span><span class="sxs-lookup"><span data-stu-id="0ec55-115">Before an installation identified as requiring administrator privileges can be run, UAC prompts the user for consent to elevate the installation.</span></span> <span data-ttu-id="0ec55-116">預設會顯示同意提示，即使使用者是本機系統管理員群組的成員，因為系統管理員會以標準使用者身分執行，直到需要系統管理認證的應用程式或系統元件要求執行許可權為止。</span><span class="sxs-lookup"><span data-stu-id="0ec55-116">The consent prompt is displayed by default, even if the user is a member of the local Administrators group, because administrators run as standard users until an application or system component that requires administrative credential requests permission to run.</span></span> <span data-ttu-id="0ec55-117">此使用者體驗稱為「 [*管理核准模式*](a-gly.md) 」 (AAM) 。</span><span class="sxs-lookup"><span data-stu-id="0ec55-117">This user experience is called [*Admin Approval Mode*](a-gly.md) (AAM).</span></span> <span data-ttu-id="0ec55-118">如果標準使用者嘗試安裝應用程式，使用者必須取得具有系統管理員許可權的人員，以提供其系統管理員認證以繼續安裝。</span><span class="sxs-lookup"><span data-stu-id="0ec55-118">If a standard user attempts to install the application, the user has to get a person with administrator privilege to provide them their administrator credentials to continue the installation.</span></span> <span data-ttu-id="0ec55-119">此使用者體驗 [*稱為 (OTS*](o-gly.md)) 認證提示。</span><span class="sxs-lookup"><span data-stu-id="0ec55-119">This user experience is called an [*Over the Shoulder*](o-gly.md) (OTS) credential prompt.</span></span>
-   <span data-ttu-id="0ec55-120">由於 UAC 會在安裝階段限制許可權，因此 Windows Installer 套件的開發人員不應假設其安裝一律可存取系統的所有部分。</span><span class="sxs-lookup"><span data-stu-id="0ec55-120">Because UAC restricts privileges during the stages of an installation, developers of Windows Installer packages should not assume that their installation will always have access to all parts of the system.</span></span> <span data-ttu-id="0ec55-121">因此 Windows Installer 套件開發人員應遵守套件 [指導](guidelines-for-packages.md) 方針中所述的封裝指導方針，以確保其套件適用于 UAC 和 Windows Vista。</span><span class="sxs-lookup"><span data-stu-id="0ec55-121">Windows Installer package developers should therefore adhere to the package guidelines described in [Guidelines for Packages](guidelines-for-packages.md) to ensure their package works with UAC and Windows Vista.</span></span> <span data-ttu-id="0ec55-122">經過撰寫並測試以符合 UAC 的封裝應該包含設定為1的 [**MSIDEPLOYMENTCOMPLIANT**](msideploymentcompliant.md) 屬性。</span><span class="sxs-lookup"><span data-stu-id="0ec55-122">A package that has been authored and tested to comply with UAC should contain the [**MSIDEPLOYMENTCOMPLIANT**](msideploymentcompliant.md) property set to 1.</span></span>
-   <span data-ttu-id="0ec55-123">系統管理員也可以使用一節中所述的方法：以非系統管理員的較 [高許可權安裝封裝](installing-a-package-with-elevated-privileges-for-a-non-admin.md) ，讓非系統管理員使用者可以使用提高的系統許可權安裝應用程式。</span><span class="sxs-lookup"><span data-stu-id="0ec55-123">An administrator can also use the methods described in the section: [Installing a Package with Elevated Privileges for a Non-Admin](installing-a-package-with-elevated-privileges-for-a-non-admin.md) to enable a non-administrator user to install an application with elevated system privileges.</span></span>
-   <span data-ttu-id="0ec55-124">需要許可權才能在每個使用者管理的內容中安裝應用程式，因此後續 Windows Installer 重新安裝或修復應用程式時，安裝程式也會使用較高的許可權來執行。</span><span class="sxs-lookup"><span data-stu-id="0ec55-124">Privileges are required to install an application in the per-user-managed context, and therefore subsequent Windows Installer reinstallations or repairs of the application are also performed by the installer using elevated privileges.</span></span> <span data-ttu-id="0ec55-125">這表示，只有來自信任來源的修補程式才能以每位使用者管理的狀態套用至應用程式。</span><span class="sxs-lookup"><span data-stu-id="0ec55-125">This means that only patches from trusted sources can be applied to an application in the per-user-managed state.</span></span> <span data-ttu-id="0ec55-126">從 Windows Installer 3.0 開始，您可以在修補程式註冊為具有更高許可權之後，將修補程式套用至每位使用者的受控應用程式。</span><span class="sxs-lookup"><span data-stu-id="0ec55-126">Beginning with Windows Installer 3.0, you can apply a patch to a per-user managed application after the patch has been registered as having elevated privileges.</span></span> <span data-ttu-id="0ec55-127">如需詳細資訊，請參閱 [修補 Per-User 受控應用程式](patching-per-user-managed-applications.md)。</span><span class="sxs-lookup"><span data-stu-id="0ec55-127">For information see [Patching Per-User Managed Applications](patching-per-user-managed-applications.md).</span></span>

> [!Note]  
> <span data-ttu-id="0ec55-128">當安裝 Windows Installer 封裝時不需要提高許可權時，套件的作者可以隱藏 UAC 顯示的對話方塊，以提示使用者提供系統管理員授權。</span><span class="sxs-lookup"><span data-stu-id="0ec55-128">When elevated privileges are not required to install a Windows Installer package, the author of the package can suppress the dialog box that UAC displays to prompt users for administrator authorization.</span></span> <span data-ttu-id="0ec55-129">如需詳細資訊，請參閱 [撰寫沒有 UAC 的封裝對話方塊](authoring-packages-without-the-uac-dialog-box.md)。</span><span class="sxs-lookup"><span data-stu-id="0ec55-129">For more information, see [Authoring Packages without the UAC Dialog Box](authoring-packages-without-the-uac-dialog-box.md).</span></span>

 

 

 
