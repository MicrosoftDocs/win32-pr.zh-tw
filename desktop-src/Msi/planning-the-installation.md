---
description: 將現有應用程式的安裝移到其他安裝技術 Windows Installer 時，安裝程式開發人員可能會使用現有安裝的來源和目標檔案映射來開始撰寫 Windows Installer 套件。
ms.assetid: 8b0fb473-e19f-4427-b2a1-d0721cde9d38
title: 規劃安裝
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 5eb98368c5c5c8e13a8f9b03a44805a8cff6e517
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/08/2021
ms.locfileid: "103849968"
---
# <a name="planning-the-installation"></a><span data-ttu-id="2d15c-103">規劃安裝</span><span class="sxs-lookup"><span data-stu-id="2d15c-103">Planning the Installation</span></span>

<span data-ttu-id="2d15c-104">將現有應用程式的安裝移到其他安裝技術 Windows Installer 時，安裝程式開發人員可能會使用現有安裝的來源和目標檔案映射來開始撰寫 Windows Installer 套件。</span><span class="sxs-lookup"><span data-stu-id="2d15c-104">When the installation of an existing application is moved to Windows Installer from another setup technology, the setup developer may start authoring a Windows Installer package using the source and target file images of the existing installation.</span></span> <span data-ttu-id="2d15c-105">在來源和目標上組織檔案和其他資源的詳細計畫，也是針對新應用程式開發封裝的理想起點。</span><span class="sxs-lookup"><span data-stu-id="2d15c-105">A detailed plan of how the files and other resources are organized at the source and target is also a good starting point for developing a package for a new application.</span></span>

<span data-ttu-id="2d15c-106">範例安裝套件會採用下列檔案，這些檔案會儲存在應用程式的來源位置，並將它們安裝到使用者電腦上的目標。</span><span class="sxs-lookup"><span data-stu-id="2d15c-106">The sample installation package takes the following files that are stored at the source location for the application and installs them to the target on the user's computer.</span></span>



| <span data-ttu-id="2d15c-107">檔案</span><span class="sxs-lookup"><span data-stu-id="2d15c-107">File</span></span>         | <span data-ttu-id="2d15c-108">描述</span><span class="sxs-lookup"><span data-stu-id="2d15c-108">Description</span></span>                               | <span data-ttu-id="2d15c-109">來源的路徑</span><span class="sxs-lookup"><span data-stu-id="2d15c-109">Path to source</span></span>                                    | <span data-ttu-id="2d15c-110">目標路徑</span><span class="sxs-lookup"><span data-stu-id="2d15c-110">Path to target</span></span>                                          |
|--------------|-------------------------------------------|---------------------------------------------------|---------------------------------------------------------|
| <span data-ttu-id="2d15c-111">Redpark.exe</span><span class="sxs-lookup"><span data-stu-id="2d15c-111">Redpark.exe</span></span>  | <span data-ttu-id="2d15c-112">文字編輯器可執行檔。</span><span class="sxs-lookup"><span data-stu-id="2d15c-112">Text editor executable file.</span></span>              | <span data-ttu-id="2d15c-113">C： \\ 範例 \\ Notepad \\Redpark.exe</span><span class="sxs-lookup"><span data-stu-id="2d15c-113">C:\\Sample\\Notepad\\Redpark.exe</span></span>                  | <span data-ttu-id="2d15c-114">\[ProgramFilesFolder \] \\ Red \_ 公園 \\Redpark.exe</span><span class="sxs-lookup"><span data-stu-id="2d15c-114">\[ProgramFilesFolder\]\\Red\_Park\\Redpark.exe</span></span>          |
| <span data-ttu-id="2d15c-115">Readme.txt</span><span class="sxs-lookup"><span data-stu-id="2d15c-115">Readme.txt</span></span>   | <span data-ttu-id="2d15c-116">資訊檔。</span><span class="sxs-lookup"><span data-stu-id="2d15c-116">An informational file.</span></span>                    | <span data-ttu-id="2d15c-117">C： \\ 範例 \\ Notepad \\Readme.txt</span><span class="sxs-lookup"><span data-stu-id="2d15c-117">C:\\Sample\\Notepad\\Readme.txt</span></span>                   | <span data-ttu-id="2d15c-118">\[ProgramFilesFolder \] \\ Red \_ 公園 \\Readme.txt</span><span class="sxs-lookup"><span data-stu-id="2d15c-118">\[ProgramFilesFolder\]\\Red\_Park\\Readme.txt</span></span>           |
| <span data-ttu-id="2d15c-119">Help.txt</span><span class="sxs-lookup"><span data-stu-id="2d15c-119">Help.txt</span></span>     | <span data-ttu-id="2d15c-120">協助手動</span><span class="sxs-lookup"><span data-stu-id="2d15c-120">Help manual</span></span>                               | <span data-ttu-id="2d15c-121">C： \\ 範例 \\ Notepad \\Help.txt</span><span class="sxs-lookup"><span data-stu-id="2d15c-121">C:\\Sample\\Notepad\\Help.txt</span></span>                     | <span data-ttu-id="2d15c-122">未安裝。</span><span class="sxs-lookup"><span data-stu-id="2d15c-122">Not installed.</span></span> <span data-ttu-id="2d15c-123">一律從來源執行。</span><span class="sxs-lookup"><span data-stu-id="2d15c-123">Always run-from-source.</span></span>                  |
| <span data-ttu-id="2d15c-124">Baseball.txt</span><span class="sxs-lookup"><span data-stu-id="2d15c-124">Baseball.txt</span></span> | <span data-ttu-id="2d15c-125">2000年的棒球遊戲排程。</span><span class="sxs-lookup"><span data-stu-id="2d15c-125">Baseball game schedule for year 2000.</span></span>     | <span data-ttu-id="2d15c-126">C： \\ 範例 \\ Notepad \\ 事件 \\Baseball.txt</span><span class="sxs-lookup"><span data-stu-id="2d15c-126">C:\\Sample\\Notepad\\Events\\Baseball.txt</span></span>         | <span data-ttu-id="2d15c-127">\[ProgramFilesFolder \] \\ Red \_ 公園 \\ 運動 \\Baseball.txt</span><span class="sxs-lookup"><span data-stu-id="2d15c-127">\[ProgramFilesFolder\]\\Red\_Park\\Sports\\Baseball.txt</span></span> |
| <span data-ttu-id="2d15c-128">Football.txt</span><span class="sxs-lookup"><span data-stu-id="2d15c-128">Football.txt</span></span> | <span data-ttu-id="2d15c-129">年度2000的足球遊戲排程。</span><span class="sxs-lookup"><span data-stu-id="2d15c-129">Football game schedule for year 2000.</span></span>     | <span data-ttu-id="2d15c-130">C： \\ 範例 \\ Notepad \\ 事件 \\Football.txt</span><span class="sxs-lookup"><span data-stu-id="2d15c-130">C:\\Sample\\Notepad\\Events\\Football.txt</span></span>         | <span data-ttu-id="2d15c-131">\[ProgramFilesFolder \] \\ Red \_ 公園 \\ 運動 \\Football.txt</span><span class="sxs-lookup"><span data-stu-id="2d15c-131">\[ProgramFilesFolder\]\\Red\_Park\\Sports\\Football.txt</span></span> |
| <span data-ttu-id="2d15c-132">Dance.txt</span><span class="sxs-lookup"><span data-stu-id="2d15c-132">Dance.txt</span></span>    | <span data-ttu-id="2d15c-133">Dance 年2000的效能。</span><span class="sxs-lookup"><span data-stu-id="2d15c-133">Dance performances for year 2000.</span></span>         | <span data-ttu-id="2d15c-134">C： \\ 範例 \\ Notepad \\ 事件 \\Dance.txt</span><span class="sxs-lookup"><span data-stu-id="2d15c-134">C:\\Sample\\Notepad\\Events\\Dance.txt</span></span>            | <span data-ttu-id="2d15c-135">\[ProgramFilesFolder \] \\ Red \_ 公園 \\ 藝術 \\Dance.txt</span><span class="sxs-lookup"><span data-stu-id="2d15c-135">\[ProgramFilesFolder\]\\Red\_Park\\Arts\\Dance.txt</span></span>      |
| <span data-ttu-id="2d15c-136">Concert.txt</span><span class="sxs-lookup"><span data-stu-id="2d15c-136">Concert.txt</span></span>  | <span data-ttu-id="2d15c-137">年度2000的音樂效能。</span><span class="sxs-lookup"><span data-stu-id="2d15c-137">Music performances for year 2000.</span></span>         | <span data-ttu-id="2d15c-138">C： \\ 範例 \\ Notepad \\ 事件 \\Concert.txt</span><span class="sxs-lookup"><span data-stu-id="2d15c-138">C:\\Sample\\Notepad\\Events\\Concert.txt</span></span>          | <span data-ttu-id="2d15c-139">\[ProgramFilesFolder \] \\ Red \_ 公園 \\ 藝術 \\Concert.txt</span><span class="sxs-lookup"><span data-stu-id="2d15c-139">\[ProgramFilesFolder\]\\Red\_Park\\Arts\\Concert.txt</span></span>    |
| <span data-ttu-id="2d15c-140">January.txt</span><span class="sxs-lookup"><span data-stu-id="2d15c-140">January.txt</span></span>  | <span data-ttu-id="2d15c-141">2000年1月招生。</span><span class="sxs-lookup"><span data-stu-id="2d15c-141">Admissions in January of year 2000.</span></span>       | <span data-ttu-id="2d15c-142">C： \\ 範例 \\ 記事本網 \\ 關 \\January.txt</span><span class="sxs-lookup"><span data-stu-id="2d15c-142">C:\\Sample\\Notepad\\Gate\\January.txt</span></span>            | <span data-ttu-id="2d15c-143">\[ProgramFilesFolder \] \\ Red \_ 公園網 \\ 關 \\January.txt</span><span class="sxs-lookup"><span data-stu-id="2d15c-143">\[ProgramFilesFolder\]\\Red\_Park\\Gate\\January.txt</span></span>    |
| <span data-ttu-id="2d15c-144">NewYears.txt</span><span class="sxs-lookup"><span data-stu-id="2d15c-144">NewYears.txt</span></span> | <span data-ttu-id="2d15c-145">招生於2000年的新年度日。</span><span class="sxs-lookup"><span data-stu-id="2d15c-145">Admissions on New Years Day of year 2000.</span></span> | <span data-ttu-id="2d15c-146">C： \\ 範例 \\ 記事本網 \\ 關的 \\ 假日 \\NewYears.txt</span><span class="sxs-lookup"><span data-stu-id="2d15c-146">C:\\Sample\\Notepad\\Gate\\Holidays\\NewYears.txt</span></span> | <span data-ttu-id="2d15c-147">\[ProgramFilesFolder \] \\ Red \_ 公園網 \\ 關 \\NewYears.txt</span><span class="sxs-lookup"><span data-stu-id="2d15c-147">\[ProgramFilesFolder\]\\Red\_Park\\Gate\\NewYears.txt</span></span>   |



 

<span data-ttu-id="2d15c-148">此範例會在使用者的登錄下，將下列值寫入 **HKEY \_ 本機 \_ 電腦 \\ 軟體 \\ Microsoft \\ 記事本範例**。</span><span class="sxs-lookup"><span data-stu-id="2d15c-148">The sample writes the following values in the user's registry under **HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Notepad Sample**.</span></span>



| <span data-ttu-id="2d15c-149">Name</span><span class="sxs-lookup"><span data-stu-id="2d15c-149">Name</span></span>             | <span data-ttu-id="2d15c-150">值</span><span class="sxs-lookup"><span data-stu-id="2d15c-150">Value</span></span>    |
|------------------|----------|
| <span data-ttu-id="2d15c-151">lfCharSet</span><span class="sxs-lookup"><span data-stu-id="2d15c-151">lfCharSet</span></span>        | <span data-ttu-id="2d15c-152">0</span><span class="sxs-lookup"><span data-stu-id="2d15c-152">0</span></span>        |
| <span data-ttu-id="2d15c-153">lfClipPrecision</span><span class="sxs-lookup"><span data-stu-id="2d15c-153">lfClipPrecision</span></span>  | <span data-ttu-id="2d15c-154">2</span><span class="sxs-lookup"><span data-stu-id="2d15c-154">2</span></span>        |
| <span data-ttu-id="2d15c-155">lfFaceName</span><span class="sxs-lookup"><span data-stu-id="2d15c-155">lfFaceName</span></span>       | <span data-ttu-id="2d15c-156">FixedSys</span><span class="sxs-lookup"><span data-stu-id="2d15c-156">FixedSys</span></span> |
| <span data-ttu-id="2d15c-157">lfItalic</span><span class="sxs-lookup"><span data-stu-id="2d15c-157">lfItalic</span></span>         | <span data-ttu-id="2d15c-158">0</span><span class="sxs-lookup"><span data-stu-id="2d15c-158">0</span></span>        |
| <span data-ttu-id="2d15c-159">lfOrientation</span><span class="sxs-lookup"><span data-stu-id="2d15c-159">lfOrientation</span></span>    | <span data-ttu-id="2d15c-160">0</span><span class="sxs-lookup"><span data-stu-id="2d15c-160">0</span></span>        |
| <span data-ttu-id="2d15c-161">lfOutPrecision</span><span class="sxs-lookup"><span data-stu-id="2d15c-161">lfOutPrecision</span></span>   | <span data-ttu-id="2d15c-162">1</span><span class="sxs-lookup"><span data-stu-id="2d15c-162">1</span></span>        |
| <span data-ttu-id="2d15c-163">fSavePageSetting</span><span class="sxs-lookup"><span data-stu-id="2d15c-163">fSavePageSetting</span></span> | <span data-ttu-id="2d15c-164">0</span><span class="sxs-lookup"><span data-stu-id="2d15c-164">0</span></span>        |
| <span data-ttu-id="2d15c-165">lfPitchAndFamily</span><span class="sxs-lookup"><span data-stu-id="2d15c-165">lfPitchAndFamily</span></span> | <span data-ttu-id="2d15c-166">49</span><span class="sxs-lookup"><span data-stu-id="2d15c-166">49</span></span>       |
| <span data-ttu-id="2d15c-167">iPointSize</span><span class="sxs-lookup"><span data-stu-id="2d15c-167">iPointSize</span></span>       | <span data-ttu-id="2d15c-168">120</span><span class="sxs-lookup"><span data-stu-id="2d15c-168">120</span></span>      |
| <span data-ttu-id="2d15c-169">lfQuality</span><span class="sxs-lookup"><span data-stu-id="2d15c-169">lfQuality</span></span>        | <span data-ttu-id="2d15c-170">2</span><span class="sxs-lookup"><span data-stu-id="2d15c-170">2</span></span>        |
| <span data-ttu-id="2d15c-171">lfStrikeOut</span><span class="sxs-lookup"><span data-stu-id="2d15c-171">lfStrikeOut</span></span>      | <span data-ttu-id="2d15c-172">0</span><span class="sxs-lookup"><span data-stu-id="2d15c-172">0</span></span>        |
| <span data-ttu-id="2d15c-173">lfWeight</span><span class="sxs-lookup"><span data-stu-id="2d15c-173">lfWeight</span></span>         | <span data-ttu-id="2d15c-174">400</span><span class="sxs-lookup"><span data-stu-id="2d15c-174">400</span></span>      |
| <span data-ttu-id="2d15c-175">fWrap</span><span class="sxs-lookup"><span data-stu-id="2d15c-175">fWrap</span></span>            | <span data-ttu-id="2d15c-176">0</span><span class="sxs-lookup"><span data-stu-id="2d15c-176">0</span></span>        |



 

<span data-ttu-id="2d15c-177">此範例會安裝下列快速鍵。</span><span class="sxs-lookup"><span data-stu-id="2d15c-177">The sample installs the following shortcuts.</span></span> <span data-ttu-id="2d15c-178">在安裝過程中，您可以選取其中一個快捷方式作為公告的快捷方式，讓使用者可以視需要安裝棒球功能。</span><span class="sxs-lookup"><span data-stu-id="2d15c-178">One of these shortcuts may be selected during setup as an advertised shortcut so that the user can install-on-demand the Baseball feature.</span></span>



| <span data-ttu-id="2d15c-179">Name</span><span class="sxs-lookup"><span data-stu-id="2d15c-179">Name</span></span>      | <span data-ttu-id="2d15c-180">快捷方式位置</span><span class="sxs-lookup"><span data-stu-id="2d15c-180">Shortcut location</span></span>                         | <span data-ttu-id="2d15c-181">快捷方式目標</span><span class="sxs-lookup"><span data-stu-id="2d15c-181">Shortcut target</span></span>                                         |
|-----------|-------------------------------------------|---------------------------------------------------------|
| <span data-ttu-id="2d15c-182">sNotepad</span><span class="sxs-lookup"><span data-stu-id="2d15c-182">sNotepad</span></span>  | <span data-ttu-id="2d15c-183">\[ProgramFilesFolder \] \\ Red \_ 公園 \\ 功能表</span><span class="sxs-lookup"><span data-stu-id="2d15c-183">\[ProgramFilesFolder\]\\Red\_Park\\Menu</span></span>\\ | <span data-ttu-id="2d15c-184">\[ProgramFilesFolder \] \\ Red \_ 公園 \\Redpark.exe</span><span class="sxs-lookup"><span data-stu-id="2d15c-184">\[ProgramFilesFolder\]\\Red\_Park\\Redpark.exe</span></span>          |
| <span data-ttu-id="2d15c-185">sReadme</span><span class="sxs-lookup"><span data-stu-id="2d15c-185">sReadme</span></span>   | <span data-ttu-id="2d15c-186">\[ProgramFilesFolder \] \\ Red \_ 公園 \\ 功能表</span><span class="sxs-lookup"><span data-stu-id="2d15c-186">\[ProgramFilesFolder\]\\Red\_Park\\Menu</span></span>\\ | <span data-ttu-id="2d15c-187">\[ProgramFilesFolder \] \\ Red \_ 公園 \\Readme.txt</span><span class="sxs-lookup"><span data-stu-id="2d15c-187">\[ProgramFilesFolder\]\\Red\_Park\\Readme.txt</span></span>           |
| <span data-ttu-id="2d15c-188">現成</span><span class="sxs-lookup"><span data-stu-id="2d15c-188">sHelp</span></span>     | <span data-ttu-id="2d15c-189">\[ProgramFilesFolder \] \\ Red \_ 公園 \\ 功能表</span><span class="sxs-lookup"><span data-stu-id="2d15c-189">\[ProgramFilesFolder\]\\Red\_Park\\Menu</span></span>\\ | <span data-ttu-id="2d15c-190">\[ProgramFilesFolder \] \\ 範例 \\ 記事本 \\Help.txt</span><span class="sxs-lookup"><span data-stu-id="2d15c-190">\[ProgramFilesFolder\]\\Sample\\Notepad\\Help.txt</span></span>       |
| <span data-ttu-id="2d15c-191">sBaseball</span><span class="sxs-lookup"><span data-stu-id="2d15c-191">sBaseball</span></span> | <span data-ttu-id="2d15c-192">\[ProgramFilesFolder \] \\ Red \_ 公園 \\ 功能表</span><span class="sxs-lookup"><span data-stu-id="2d15c-192">\[ProgramFilesFolder\]\\Red\_Park\\Menu</span></span>\\ | <span data-ttu-id="2d15c-193">\[ProgramFilesFolder \] \\ Red \_ 公園 \\ 運動 \\Baseball.txt</span><span class="sxs-lookup"><span data-stu-id="2d15c-193">\[ProgramFilesFolder\]\\Red\_Park\\Sports\\Baseball.txt</span></span> |
| <span data-ttu-id="2d15c-194">sFootball</span><span class="sxs-lookup"><span data-stu-id="2d15c-194">sFootball</span></span> | <span data-ttu-id="2d15c-195">\[ProgramFilesFolder \] \\ Red \_ 公園 \\ 功能表</span><span class="sxs-lookup"><span data-stu-id="2d15c-195">\[ProgramFilesFolder\]\\Red\_Park\\Menu</span></span>\\ | <span data-ttu-id="2d15c-196">\[ProgramFilesFolder \] \\ Red \_ 公園 \\ 運動 \\Football.txt</span><span class="sxs-lookup"><span data-stu-id="2d15c-196">\[ProgramFilesFolder\]\\Red\_Park\\Sports\\Football.txt</span></span> |
| <span data-ttu-id="2d15c-197">sDance</span><span class="sxs-lookup"><span data-stu-id="2d15c-197">sDance</span></span>    | <span data-ttu-id="2d15c-198">\[ProgramFilesFolder \] \\ Red \_ 公園 \\ 功能表</span><span class="sxs-lookup"><span data-stu-id="2d15c-198">\[ProgramFilesFolder\]\\Red\_Park\\Menu</span></span>\\ | <span data-ttu-id="2d15c-199">\[ProgramFilesFolder \] \\ Red \_ 公園 \\ 藝術 \\Dance.txt</span><span class="sxs-lookup"><span data-stu-id="2d15c-199">\[ProgramFilesFolder\]\\Red\_Park\\Arts\\Dance.txt</span></span>      |
| <span data-ttu-id="2d15c-200">sConcert</span><span class="sxs-lookup"><span data-stu-id="2d15c-200">sConcert</span></span>  | <span data-ttu-id="2d15c-201">\[ProgramFilesFolder \] \\ Red \_ 公園 \\ 功能表</span><span class="sxs-lookup"><span data-stu-id="2d15c-201">\[ProgramFilesFolder\]\\Red\_Park\\Menu</span></span>\\ | <span data-ttu-id="2d15c-202">\[ProgramFilesFolder \] \\ Red \_ 公園 \\ 藝術 \\Concert.txt</span><span class="sxs-lookup"><span data-stu-id="2d15c-202">\[ProgramFilesFolder\]\\Red\_Park\\Arts\\Concert.txt</span></span>    |
| <span data-ttu-id="2d15c-203">sJanuary</span><span class="sxs-lookup"><span data-stu-id="2d15c-203">sJanuary</span></span>  | <span data-ttu-id="2d15c-204">\[ProgramFilesFolder \] \\ Red \_ 公園 \\ 功能表</span><span class="sxs-lookup"><span data-stu-id="2d15c-204">\[ProgramFilesFolder\]\\Red\_Park\\Menu</span></span>\\ | <span data-ttu-id="2d15c-205">\[ProgramFilesFolder \] \\ Red \_ 公園網 \\ 關 \\January.txt</span><span class="sxs-lookup"><span data-stu-id="2d15c-205">\[ProgramFilesFolder\]\\Red\_Park\\Gate\\January.txt</span></span>    |
| <span data-ttu-id="2d15c-206">sNewYears</span><span class="sxs-lookup"><span data-stu-id="2d15c-206">sNewYears</span></span> | <span data-ttu-id="2d15c-207">\[ProgramFilesFolder \] \\ Red \_ 公園 \\ 功能表</span><span class="sxs-lookup"><span data-stu-id="2d15c-207">\[ProgramFilesFolder\]\\Red\_Park\\Menu</span></span>\\ | <span data-ttu-id="2d15c-208">\[ProgramFilesFolder \] \\ Red \_ 公園網 \\ 關 \\NewYears.txt</span><span class="sxs-lookup"><span data-stu-id="2d15c-208">\[ProgramFilesFolder\]\\Red\_Park\\Gate\\NewYears.txt</span></span>   |



 

<span data-ttu-id="2d15c-209">若要重現範例，請從建立第一個資料表中指定的來原始目錄結構開始。</span><span class="sxs-lookup"><span data-stu-id="2d15c-209">To reproduce the sample, begin by creating the source directory structure given in the first table.</span></span> <span data-ttu-id="2d15c-210">您可以建立系統 Notepad.exe 檔案的複本，然後將此複本重新命名 Redpark.exe。</span><span class="sxs-lookup"><span data-stu-id="2d15c-210">You can make a copy of your system's Notepad.exe file and then rename this copy Redpark.exe.</span></span> <span data-ttu-id="2d15c-211">使用 [記事本編輯器] 來建立其餘的文字檔。</span><span class="sxs-lookup"><span data-stu-id="2d15c-211">Use the Notepad editor to create the remaining text files.</span></span> <span data-ttu-id="2d15c-212">藉由撰寫安裝資料庫，即可新增目標的目錄結構、登錄值和快捷方式。</span><span class="sxs-lookup"><span data-stu-id="2d15c-212">The directory structure of the target, the registry values, and the shortcuts are added by authoring the installation database.</span></span>

[<span data-ttu-id="2d15c-213">繼續</span><span class="sxs-lookup"><span data-stu-id="2d15c-213">Continue</span></span>](importing-a-blank-database.md)

 

 



