---
description: Windows Installer 設定服務、檔案、建立資料夾和登錄專案的存取權限，可協助讓安裝應用程式更安全。
ms.assetid: a25fcecf-f15f-4772-8f41-d03864484cc9
title: 保護資源
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 415fe7b2df343a54aa0819031f4fd22b05857618
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/08/2021
ms.locfileid: "106976943"
---
# <a name="securing-resources"></a><span data-ttu-id="e04ad-103">保護資源</span><span class="sxs-lookup"><span data-stu-id="e04ad-103">Securing Resources</span></span>

<span data-ttu-id="e04ad-104">Windows Installer 設定服務、檔案、建立資料夾和登錄專案的存取權限，可協助讓安裝應用程式更安全。</span><span class="sxs-lookup"><span data-stu-id="e04ad-104">The capability of the Windows Installer to set access permissions on services, files, created folders, and registry entries can help make installation applications more secure.</span></span> <span data-ttu-id="e04ad-105">使用 [MsiLockPermissionsEx](msilockpermissionsex-table.md) 或 [LockPermissions](lockpermissions-table.md) 資料表來保護資源是 [撰寫安全安裝](guidelines-for-authoring-secure-installations.md)的其中一個建議方針。</span><span class="sxs-lookup"><span data-stu-id="e04ad-105">The use of the [MsiLockPermissionsEx](msilockpermissionsex-table.md) or [LockPermissions](lockpermissions-table.md) tables to secure resources is one of the recommended [Guidelines for Authoring Secure Installations](guidelines-for-authoring-secure-installations.md).</span></span> <span data-ttu-id="e04ad-106">MsiLockPermissionsEx 資料表可以讓封裝作者保護資源安全，而不需要撰寫 [自訂動作](custom-actions.md)。</span><span class="sxs-lookup"><span data-stu-id="e04ad-106">The MsiLockPermissionsEx table can enable a package author to secure a resource without having to write a [custom action](custom-actions.md).</span></span>

<span data-ttu-id="e04ad-107">從針對 Windows Installer 5.0 開發的封裝開始， [MsiLockPermissionsEx](msilockpermissionsex-table.md) 資料表應取代 [LockPermissions](lockpermissions-table.md) 資料表的使用。</span><span class="sxs-lookup"><span data-stu-id="e04ad-107">Beginning with packages developed for Windows Installer 5.0, the [MsiLockPermissionsEx](msilockpermissionsex-table.md) table should replace the use of the [LockPermissions](lockpermissions-table.md) table.</span></span> <span data-ttu-id="e04ad-108">MsiLockPermissionsEx 資料表提供的擴充功能可讓封裝保護 Windows [服務](../services/services.md)、檔案、資料夾和登錄機碼。</span><span class="sxs-lookup"><span data-stu-id="e04ad-108">The extended functionality provided by the MsiLockPermissionsEx table enables a package to secure Windows [Services](../services/services.md), files, folders, and registry keys.</span></span> <span data-ttu-id="e04ad-109">封裝不應同時包含 MsiLockPermissionsEx 和 LockPermissions 資料表。</span><span class="sxs-lookup"><span data-stu-id="e04ad-109">A package should not contain both the MsiLockPermissionsEx and the LockPermissions tables.</span></span>

<span data-ttu-id="e04ad-110">Windows Installer 4.5 及更早版本會忽略 [MsiLockPermissionsEx 資料表](msilockpermissionsex-table.md)。</span><span class="sxs-lookup"><span data-stu-id="e04ad-110">Windows Installer 4.5 and earlier ignores the [MsiLockPermissionsEx table](msilockpermissionsex-table.md).</span></span> <span data-ttu-id="e04ad-111">從 Windows Installer 5.0 開始，如果封裝同時包含 [LockPermissions 資料表](lockpermissions-table.md) 和 MsiLockPermissionsEx 資料表，則安裝會失敗，並出現錯誤訊息1941。</span><span class="sxs-lookup"><span data-stu-id="e04ad-111">Beginning with Windows Installer 5.0, the installation fails with an error message 1941 if the package contains both a [LockPermissions table](lockpermissions-table.md) and MsiLockPermissionsEx table.</span></span> <span data-ttu-id="e04ad-112">仍可使用 Windows Installer 5.0 安裝僅包含 LockPermissions 資料表的現有安裝套件。</span><span class="sxs-lookup"><span data-stu-id="e04ad-112">Existing installation packages that contain only the LockPermissions table can be still be installed using Windows Installer 5.0.</span></span>

<span data-ttu-id="e04ad-113">Windows Installer 5.0 會在執行[InstallFiles](installfiles-action.md)、 [InstallServices](installservices-action.md)、 [WriteRegistryValues](writeregistryvalues-action.md)和[CreateFolders](createfolders-action.md)標準動作時，處理[MsiLockPermissionsEx](msilockpermissionsex-table.md)資料表中的資訊。</span><span class="sxs-lookup"><span data-stu-id="e04ad-113">Windows Installer 5.0 processes the information in the [MsiLockPermissionsEx](msilockpermissionsex-table.md) table when it runs the [InstallFiles](installfiles-action.md), [InstallServices](installservices-action.md), [WriteRegistryValues](writeregistryvalues-action.md) and [CreateFolders](createfolders-action.md) standard actions.</span></span> <span data-ttu-id="e04ad-114">您必須安裝或重新安裝安全物件才能受到保護，而且不可能將 [存取控制清單](../secauthz/access-control-lists.md) (ACL) 附加至現有的物件，而不需要重新安裝該物件。</span><span class="sxs-lookup"><span data-stu-id="e04ad-114">A securable object must be installed or reinstalled to be secured and it is not possible to append an [Access Control List](../secauthz/access-control-lists.md) (ACL) to an existing object without reinstalling that object.</span></span>

<span data-ttu-id="e04ad-115">若要指定要保護的服務、檔案、目錄或登錄機碼，請在 [ [MsiLockPermissionsEx](msilockpermissionsex-table.md) ] 資料表的 [LockObject] 和 [資料表] 欄位中輸入識別資訊。</span><span class="sxs-lookup"><span data-stu-id="e04ad-115">To specify the service, file, directory, or registry key that is to be secured, enter the identifying information in the LockObject and Table fields of the [MsiLockPermissionsEx](msilockpermissionsex-table.md) table.</span></span> <span data-ttu-id="e04ad-116">物件是由其在 [ServiceInstall 資料表](serviceinstall-table.md)、檔案 [資料表](file-table.md)、登錄 [資料表](registry-table.md)或 [CreateFolder 資料表](createfolder-table.md)中的主鍵所識別。</span><span class="sxs-lookup"><span data-stu-id="e04ad-116">An object is identified by it's primary key in the [ServiceInstall Table](serviceinstall-table.md), [File Table](file-table.md), [Registry Table](registry-table.md), or [CreateFolder Table](createfolder-table.md).</span></span>

<span data-ttu-id="e04ad-117">若要要求指定的許可權套用至物件，請使用有效的 [安全描述項定義語言](../secauthz/security-descriptor-definition-language.md) (SDDL) ，在 [MsiLockPermissionsEx](msilockpermissionsex-table.md)資料表的 [ *SDDLText* ] 欄位中輸入有效的安全描述項字串。</span><span class="sxs-lookup"><span data-stu-id="e04ad-117">To request that specified permissions apply to an object, enter a valid security descriptor string in the *SDDLText* field of the [MsiLockPermissionsEx](msilockpermissionsex-table.md) table using valid [security descriptor definition language](../secauthz/security-descriptor-definition-language.md) (SDDL).</span></span> <span data-ttu-id="e04ad-118">**MsiLockPermissionsEx** 資料表可以指定拒絕許可權的安全描述項、指定父資源的許可權繼承，或指定新帳戶的許可權。</span><span class="sxs-lookup"><span data-stu-id="e04ad-118">The **MsiLockPermissionsEx** table can specify a security descriptor that denies permissions, specifies inheritance of permissions from a parent resource, or specifies the permissions of a new account.</span></span> <span data-ttu-id="e04ad-119">如需可授與、拒絕或繼承之擁有權限的清單，請參閱 [ACE 字串](../secauthz/ace-strings.md)。</span><span class="sxs-lookup"><span data-stu-id="e04ad-119">For a list of all the permissions that can be granted, denied, or inherited see [ACE Strings](../secauthz/ace-strings.md).</span></span> <span data-ttu-id="e04ad-120">Windows Installer 5.0 會將一組可用的安全識別碼 (Sid 延伸 ) 。如需有效 Sid 的清單，請參閱 [Sid 字串](../secauthz/sid-strings.md)。</span><span class="sxs-lookup"><span data-stu-id="e04ad-120">Windows Installer 5.0 extends the set of available security identifiers (SIDs.) For a list of the valid SIDs, see [SID Strings](../secauthz/sid-strings.md).</span></span>

> [!NOTE]
> <span data-ttu-id="e04ad-121">如果您想要設定父資源的安全描述項，以指定子物件會繼承其許可權，您的安裝程式必須先將許可權套用至父資源，才能建立子物件。</span><span class="sxs-lookup"><span data-stu-id="e04ad-121">If you want to configure the security descriptor of a parent resource to specify that that its permissions be inherited by child objects, your installer must apply permissions to the parent resource before it creates the child objects.</span></span> <span data-ttu-id="e04ad-122">如果您的安裝程式在將可繼承的許可權套用至父資源之前建立子物件，父資源的許可權將不會傳播到子物件。</span><span class="sxs-lookup"><span data-stu-id="e04ad-122">If your installer creates the child objects before it applies the inheritable permissions to the parent resource, the permissions of the parent resource will not propagate to the child objects.</span></span>

<span data-ttu-id="e04ad-123">從 Windows Installer 5.0 開始， [FormattedSDDLText](formattedsddltext.md) 資料類型會擴充 [格式化](formatted.md) 的資料類型。</span><span class="sxs-lookup"><span data-stu-id="e04ad-123">Beginning with Windows Installer 5.0, the [FormattedSDDLText](formattedsddltext.md) data type extends the [Formatted](formatted.md) data type.</span></span> <span data-ttu-id="e04ad-124">Windows Installer 會驗證在 [MsiLockPermissionsEx](msilockpermissionsex-table.md) 資料表的 SDDLText 資料行中輸入的 FormattedSDDLText 字串是否符合 [安全描述項字串格式](../secauthz/security-descriptor-string-format.md)。</span><span class="sxs-lookup"><span data-stu-id="e04ad-124">The Windows Installer validates that the FormattedSDDLText string entered in the SDDLText column of the [MsiLockPermissionsEx](msilockpermissionsex-table.md) table conforms to the [Security Descriptor String Format](../secauthz/security-descriptor-string-format.md).</span></span>

<span data-ttu-id="e04ad-125">**[Windows Installer 4.5 或更早版本](not-supported-in-windows-installer-4-5.md)：** 不支援。</span><span class="sxs-lookup"><span data-stu-id="e04ad-125">**[Windows Installer 4.5 or earlier](not-supported-in-windows-installer-4-5.md):** Not supported.</span></span> <span data-ttu-id="e04ad-126">從 Windows Installer 5.0 開始，可以使用 [MsiLockPermissionsEx](msilockpermissionsex-table.md) 資料表和 [FormattedSDDLText](formattedsddltext.md) 資料類型。</span><span class="sxs-lookup"><span data-stu-id="e04ad-126">The [MsiLockPermissionsEx](msilockpermissionsex-table.md) table and [FormattedSDDLText](formattedsddltext.md) data type are available beginning with Windows Installer 5.0.</span></span>

 

 
