---
description: 若要在您的應用程式中啟用 Windows Installer，您必須使用安裝程式函數。 本主題中的表格會依分類來識別函數。
ms.assetid: 05a16915-6b47-4d51-b62a-5a4d92b87e50
title: 安裝程式函數參考
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 9261789f21bd559e49c4e5718ef68ce9d0bb41c8
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/07/2021
ms.locfileid: "103943451"
---
# <a name="installer-function-reference"></a><span data-ttu-id="6a2c5-104">安裝程式函數參考</span><span class="sxs-lookup"><span data-stu-id="6a2c5-104">Installer Function Reference</span></span>

<span data-ttu-id="6a2c5-105">若要在您的應用程式中啟用 Windows Installer，您必須使用安裝程式函數。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-105">To enable Windows Installer in your application, you must use the installer functions.</span></span> <span data-ttu-id="6a2c5-106">本主題中的表格會依分類來識別函數。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-106">The tables in this topic identify the functions by category.</span></span>

## <a name="user-interface-and-logging-functions"></a><span data-ttu-id="6a2c5-107">消費者介面和記錄功能</span><span class="sxs-lookup"><span data-stu-id="6a2c5-107">User Interface and Logging Functions</span></span>



| <span data-ttu-id="6a2c5-108">Name</span><span class="sxs-lookup"><span data-stu-id="6a2c5-108">Name</span></span>                                                     | <span data-ttu-id="6a2c5-109">描述</span><span class="sxs-lookup"><span data-stu-id="6a2c5-109">Description</span></span>                                                                           |
|----------------------------------------------------------|---------------------------------------------------------------------------------------|
| [<span data-ttu-id="6a2c5-110">**MsiSetInternalUI**</span><span class="sxs-lookup"><span data-stu-id="6a2c5-110">**MsiSetInternalUI**</span></span>](/windows/desktop/api/Msi/nf-msi-msisetinternalui)             | <span data-ttu-id="6a2c5-111">啟用安裝程式的內部使用者介面。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-111">Enables the internal user interface of the installer.</span></span>                                 |
| [<span data-ttu-id="6a2c5-112">**MsiSetExternalUI**</span><span class="sxs-lookup"><span data-stu-id="6a2c5-112">**MsiSetExternalUI**</span></span>](/windows/desktop/api/Msi/nf-msi-msisetexternaluia)             | <span data-ttu-id="6a2c5-113">啟用以字串格式接收訊息的外部使用者介面處理常式。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-113">Enables an external user-interface handler that receives messages in a string format.</span></span> |
| [<span data-ttu-id="6a2c5-114">**MsiSetExternalUIRecord**</span><span class="sxs-lookup"><span data-stu-id="6a2c5-114">**MsiSetExternalUIRecord**</span></span>](/windows/desktop/api/Msi/nf-msi-msisetexternaluirecord) | <span data-ttu-id="6a2c5-115">啟用以記錄格式接收訊息的外部使用者介面處理常式。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-115">Enables an external user-interface handler that receives messages in a record format.</span></span> |
| [<span data-ttu-id="6a2c5-116">**MsiEnableLog**</span><span class="sxs-lookup"><span data-stu-id="6a2c5-116">**MsiEnableLog**</span></span>](/windows/desktop/api/Msi/nf-msi-msienableloga)                     | <span data-ttu-id="6a2c5-117">設定呼叫進程中所有安裝的記錄模式。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-117">Sets the log mode for all installations in the calling process.</span></span>                       |



 

## <a name="handle-management-functions"></a><span data-ttu-id="6a2c5-118">處理管理功能</span><span class="sxs-lookup"><span data-stu-id="6a2c5-118">Handle Management Functions</span></span>



| <span data-ttu-id="6a2c5-119">Name</span><span class="sxs-lookup"><span data-stu-id="6a2c5-119">Name</span></span>                                             | <span data-ttu-id="6a2c5-120">描述</span><span class="sxs-lookup"><span data-stu-id="6a2c5-120">Description</span></span>                                                   |
|--------------------------------------------------|---------------------------------------------------------------|
| [<span data-ttu-id="6a2c5-121">**MsiCloseHandle**</span><span class="sxs-lookup"><span data-stu-id="6a2c5-121">**MsiCloseHandle**</span></span>](/windows/desktop/api/Msi/nf-msi-msiclosehandle)         | <span data-ttu-id="6a2c5-122">關閉開啟的安裝控制碼。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-122">Closes an open installation handle.</span></span>                           |
| [<span data-ttu-id="6a2c5-123">**MsiCloseAllHandles**</span><span class="sxs-lookup"><span data-stu-id="6a2c5-123">**MsiCloseAllHandles**</span></span>](/windows/desktop/api/Msi/nf-msi-msicloseallhandles) | <span data-ttu-id="6a2c5-124">關閉所有開啟的安裝控制碼。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-124">Closes all open installation handles.</span></span> <span data-ttu-id="6a2c5-125">請勿使用進行清除。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-125">Do not use for cleanup.</span></span> |



 

## <a name="installation-and-configuration-functions"></a><span data-ttu-id="6a2c5-126">安裝和設定功能</span><span class="sxs-lookup"><span data-stu-id="6a2c5-126">Installation and Configuration Functions</span></span>



| <span data-ttu-id="6a2c5-127">Name</span><span class="sxs-lookup"><span data-stu-id="6a2c5-127">Name</span></span>                                                                     | <span data-ttu-id="6a2c5-128">描述</span><span class="sxs-lookup"><span data-stu-id="6a2c5-128">Description</span></span>                                                                                                                                                                                                                  |
|--------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="6a2c5-129">**MsiAdvertiseProduct**</span><span class="sxs-lookup"><span data-stu-id="6a2c5-129">**MsiAdvertiseProduct**</span></span>](/windows/desktop/api/Msi/nf-msi-msiadvertiseproducta)                       | <span data-ttu-id="6a2c5-130">通告產品。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-130">Advertises a product.</span></span>                                                                                                                                                                                                        |
| [<span data-ttu-id="6a2c5-131">**MsiAdvertiseProductEx**</span><span class="sxs-lookup"><span data-stu-id="6a2c5-131">**MsiAdvertiseProductEx**</span></span>](/windows/desktop/api/Msi/nf-msi-msiadvertiseproductexa)                   | <span data-ttu-id="6a2c5-132">通告產品。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-132">Advertises a product.</span></span>                                                                                                                                                                                                        |
| [<span data-ttu-id="6a2c5-133">**MsiAdvertiseScript**</span><span class="sxs-lookup"><span data-stu-id="6a2c5-133">**MsiAdvertiseScript**</span></span>](/windows/desktop/api/Msi/nf-msi-msiadvertisescripta)                         | <span data-ttu-id="6a2c5-134">將公告腳本檔案複製到指定的位置。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-134">Copies an advertise script file into specified locations.</span></span>                                                                                                                                                                    |
| [<span data-ttu-id="6a2c5-135">**MsiInstallProduct**</span><span class="sxs-lookup"><span data-stu-id="6a2c5-135">**MsiInstallProduct**</span></span>](/windows/desktop/api/Msi/nf-msi-msiinstallproducta)                           | <span data-ttu-id="6a2c5-136">安裝或移除應用程式或應用程式套件。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-136">Installs or removes an application or application suite.</span></span>                                                                                                                                                                     |
| [<span data-ttu-id="6a2c5-137">**MsiConfigureProduct**</span><span class="sxs-lookup"><span data-stu-id="6a2c5-137">**MsiConfigureProduct**</span></span>](/windows/desktop/api/Msi/nf-msi-msiconfigureproducta)                       | <span data-ttu-id="6a2c5-138">安裝或移除應用程式或應用程式套件。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-138">Installs or removes an application or application suite.</span></span>                                                                                                                                                                     |
| [<span data-ttu-id="6a2c5-139">**MsiConfigureProductEx**</span><span class="sxs-lookup"><span data-stu-id="6a2c5-139">**MsiConfigureProductEx**</span></span>](/windows/desktop/api/Msi/nf-msi-msiconfigureproductexa)                   | <span data-ttu-id="6a2c5-140">安裝或移除應用程式或應用程式套件。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-140">Installs or removes an application or application suite.</span></span> <span data-ttu-id="6a2c5-141">您可以指定產品命令列。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-141">A product command-line can be specified.</span></span>                                                                                                                            |
| [<span data-ttu-id="6a2c5-142">**MsiReinstallProduct**</span><span class="sxs-lookup"><span data-stu-id="6a2c5-142">**MsiReinstallProduct**</span></span>](/windows/desktop/api/Msi/nf-msi-msireinstallproducta)                       | <span data-ttu-id="6a2c5-143">重新安裝或修復安裝。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-143">Reinstalls or repairs an installation.</span></span>                                                                                                                                                                                       |
| [<span data-ttu-id="6a2c5-144">**MsiConfigureFeature**</span><span class="sxs-lookup"><span data-stu-id="6a2c5-144">**MsiConfigureFeature**</span></span>](/windows/desktop/api/Msi/nf-msi-msiconfigurefeaturea)                       | <span data-ttu-id="6a2c5-145">設定功能的已安裝狀態。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-145">Configures the installed state of a feature.</span></span>                                                                                                                                                                                 |
| [<span data-ttu-id="6a2c5-146">**MsiReinstallFeature**</span><span class="sxs-lookup"><span data-stu-id="6a2c5-146">**MsiReinstallFeature**</span></span>](/windows/desktop/api/Msi/nf-msi-msireinstallfeaturea)                       | <span data-ttu-id="6a2c5-147">驗證或修復功能。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-147">Validates or repairs features.</span></span>                                                                                                                                                                                               |
| [<span data-ttu-id="6a2c5-148">**MsiInstallMissingComponent**</span><span class="sxs-lookup"><span data-stu-id="6a2c5-148">**MsiInstallMissingComponent**</span></span>](/windows/desktop/api/Msi/nf-msi-msiinstallmissingcomponenta)         | <span data-ttu-id="6a2c5-149">安裝遺失的元件。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-149">Installs missing components.</span></span>                                                                                                                                                                                                 |
| [<span data-ttu-id="6a2c5-150">**MsiInstallMissingFile**</span><span class="sxs-lookup"><span data-stu-id="6a2c5-150">**MsiInstallMissingFile**</span></span>](/windows/desktop/api/Msi/nf-msi-msiinstallmissingfilea)                   | <span data-ttu-id="6a2c5-151">安裝遺失的檔案。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-151">Installs missing files.</span></span>                                                                                                                                                                                                      |
| [<span data-ttu-id="6a2c5-152">**MsiNotifySidChange**</span><span class="sxs-lookup"><span data-stu-id="6a2c5-152">**MsiNotifySidChange**</span></span>](/windows/desktop/api/Msi/nf-msi-msinotifysidchangea)                         | <span data-ttu-id="6a2c5-153">使用使用者 Sid 的變更，通知並更新 Windows Installer 的內部資訊。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-153">Notifies and updates the Windows Installer internal information with changes to user SIDs.</span></span> <span data-ttu-id="6a2c5-154">從 Windows Installer 3.1 開始提供。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-154">Available beginning with Windows Installer 3.1.</span></span>                                                                                   |
| [<span data-ttu-id="6a2c5-155">**MsiProcessAdvertiseScript**</span><span class="sxs-lookup"><span data-stu-id="6a2c5-155">**MsiProcessAdvertiseScript**</span></span>](/windows/desktop/api/Msi/nf-msi-msiprocessadvertisescripta)           | <span data-ttu-id="6a2c5-156">將公告腳本檔處理至指定的位置。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-156">Processes an advertise script file into specified locations.</span></span>                                                                                                                                                                 |
| [<span data-ttu-id="6a2c5-157">**MsiSourceListAddSource**</span><span class="sxs-lookup"><span data-stu-id="6a2c5-157">**MsiSourceListAddSource**</span></span>](/windows/desktop/api/Msi/nf-msi-msisourcelistaddsourcea)                 | <span data-ttu-id="6a2c5-158">在指定的內容中新增或重新排序修補程式或產品的來源。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-158">Adds or reorders the sources of a patch or product in a specified context.</span></span>                                                                                                                                                   |
| [<span data-ttu-id="6a2c5-159">**MsiSourceListAddSourceEx**</span><span class="sxs-lookup"><span data-stu-id="6a2c5-159">**MsiSourceListAddSourceEx**</span></span>](/windows/desktop/api/Msi/nf-msi-msisourcelistaddsourceexa)             | <span data-ttu-id="6a2c5-160">在指定的內容中新增或重新排序修補程式或產品的來源。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-160">Adds or reorders the sources of a patch or product in a specified context.</span></span> <span data-ttu-id="6a2c5-161">針對不存在於指定內容中的修補程式建立來源清單。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-161">Creates a source list for a patch that does not exist in a specified context.</span></span> <span data-ttu-id="6a2c5-162">適用于 Windows Installer 3.0。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-162">Available in Windows Installer  3.0.</span></span>                                |
| [<span data-ttu-id="6a2c5-163">**MsiSourceListClearSource**</span><span class="sxs-lookup"><span data-stu-id="6a2c5-163">**MsiSourceListClearSource**</span></span>](/windows/desktop/api/Msi/nf-msi-msisourcelistclearsourcea)             | <span data-ttu-id="6a2c5-164">在指定的內容中移除產品或修補程式的現有來源。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-164">Removes an existing source for a product or patch in a specified context.</span></span> <span data-ttu-id="6a2c5-165">適用于 Windows Installer 3.0。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-165">Available in Windows Installer  3.0.</span></span>                                                                                                               |
| [<span data-ttu-id="6a2c5-166">**MsiSourceListClearAll**</span><span class="sxs-lookup"><span data-stu-id="6a2c5-166">**MsiSourceListClearAll**</span></span>](/windows/desktop/api/Msi/nf-msi-msisourcelistclearalla)                   | <span data-ttu-id="6a2c5-167">針對指定的產品實例，移除特定來源類型的所有現有來源。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-167">Removes all the existing sources of a specific source type for a specified product instance.</span></span>                                                                                                                                 |
| [<span data-ttu-id="6a2c5-168">**MsiSourceListClearAllEx**</span><span class="sxs-lookup"><span data-stu-id="6a2c5-168">**MsiSourceListClearAllEx**</span></span>](/windows/desktop/api/Msi/nf-msi-msisourcelistclearallexa)               | <span data-ttu-id="6a2c5-169">針對指定的產品實例，移除特定來源類型的所有現有來源。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-169">Removes all the existing sources of a specific source type for a specified product instance.</span></span> <span data-ttu-id="6a2c5-170">適用于 Windows Installer 3.0。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-170">Available in Windows Installer  3.0.</span></span>                                                                                            |
| [<span data-ttu-id="6a2c5-171">**MsiSourceListForceResolution**</span><span class="sxs-lookup"><span data-stu-id="6a2c5-171">**MsiSourceListForceResolution**</span></span>](/windows/desktop/api/Msi/nf-msi-msisourcelistforceresolutiona)     | <span data-ttu-id="6a2c5-172">移除產品或修補程式目前來源的註冊，該來源會註冊為 "LastUsedSource" 屬性。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-172">Removes the registration of the current source of the product or patch, which is registered as the property "LastUsedSource".</span></span> <span data-ttu-id="6a2c5-173">此函數不會影響已註冊的來源清單。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-173">This function does not affect the registered source list.</span></span>                                      |
| [<span data-ttu-id="6a2c5-174">**MsiSourceListForceResolutionEx**</span><span class="sxs-lookup"><span data-stu-id="6a2c5-174">**MsiSourceListForceResolutionEx**</span></span>](/windows/desktop/api/Msi/nf-msi-msisourcelistforceresolutionexa) | <span data-ttu-id="6a2c5-175">移除產品或修補程式目前來源的註冊，該來源會註冊為 "LastUsedSource" 屬性。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-175">Removes the registration of the current source of the product or patch, which is registered as the property "LastUsedSource".</span></span> <span data-ttu-id="6a2c5-176">此函數不會影響已註冊的來源清單。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-176">This function does not affect the registered source list.</span></span> <span data-ttu-id="6a2c5-177">適用于 Windows Installer 3.0。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-177">Available in Windows Installer  3.0.</span></span> |
| [<span data-ttu-id="6a2c5-178">**MsiSourceListGetInfo**</span><span class="sxs-lookup"><span data-stu-id="6a2c5-178">**MsiSourceListGetInfo**</span></span>](/windows/desktop/api/Msi/nf-msi-msisourcelistgetinfoa)                     | <span data-ttu-id="6a2c5-179">抓取特定內容中產品或修補程式的來源清單相關資訊。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-179">Retrieves information about the source list for a product or patch in a specific context.</span></span>                                                                                                                                    |
| [<span data-ttu-id="6a2c5-180">**MsiSourceListSetInfo**</span><span class="sxs-lookup"><span data-stu-id="6a2c5-180">**MsiSourceListSetInfo**</span></span>](/windows/desktop/api/Msi/nf-msi-msisourcelistsetinfoa)                     | <span data-ttu-id="6a2c5-181">在指定的內容中，設定產品或修補程式最近使用的來源。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-181">Sets the most recently used source for a product or patch in a specified context.</span></span> <span data-ttu-id="6a2c5-182">適用于 Windows Installer 3.0。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-182">Available in Windows Installer  3.0.</span></span>                                                                                                       |
| [<span data-ttu-id="6a2c5-183">**MsiSourceListEnumMediaDisks**</span><span class="sxs-lookup"><span data-stu-id="6a2c5-183">**MsiSourceListEnumMediaDisks**</span></span>](/windows/desktop/api/Msi/nf-msi-msisourcelistenummediadisksa)       | <span data-ttu-id="6a2c5-184">列舉針對修補程式或產品的媒體來源所註冊的磁片清單。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-184">Enumerates the list of disks registered for the media source for a patch or product.</span></span> <span data-ttu-id="6a2c5-185">適用于 Windows Installer 3.0。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-185">Available in Windows Installer  3.0.</span></span>                                                                                                    |
| [<span data-ttu-id="6a2c5-186">**MsiSourceListAddMediaDisk**</span><span class="sxs-lookup"><span data-stu-id="6a2c5-186">**MsiSourceListAddMediaDisk**</span></span>](/windows/desktop/api/Msi/nf-msi-msisourcelistaddmediadiska)           | <span data-ttu-id="6a2c5-187">新增或更新已註冊產品或修補程式之媒體來源的磁片。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-187">Adds or updates a disk of the media source of a registered product or patch.</span></span> <span data-ttu-id="6a2c5-188">適用于 Windows Installer 3.0。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-188">Available in Windows Installer  3.0.</span></span>                                                                                                            |
| [<span data-ttu-id="6a2c5-189">**MsiSourceListClearMediaDisk**</span><span class="sxs-lookup"><span data-stu-id="6a2c5-189">**MsiSourceListClearMediaDisk**</span></span>](/windows/desktop/api/Msi/nf-msi-msisourcelistclearmediadiska)      | <span data-ttu-id="6a2c5-190">針對特定內容中的產品或修補程式，在媒體來源下移除現有的已註冊磁片。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-190">Removes an existing registered disk under the media source for a product or patch in a specific context.</span></span> <span data-ttu-id="6a2c5-191">適用于 Windows Installer 3.0。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-191">Available in Windows Installer  3.0.</span></span>                                                                                |
| [<span data-ttu-id="6a2c5-192">**MsiSourceListEnumSources**</span><span class="sxs-lookup"><span data-stu-id="6a2c5-192">**MsiSourceListEnumSources**</span></span>](/windows/desktop/api/Msi/nf-msi-msisourcelistenumsourcesa)             | <span data-ttu-id="6a2c5-193">列舉指定修補程式或產品的來源清單中的來源。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-193">Enumerates the sources in the source list of a specified patch or product.</span></span> <span data-ttu-id="6a2c5-194">適用于 Windows Installer 3.0。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-194">Available in Windows Installer  3.0.</span></span>                                                                                                              |



 

## <a name="component-specific-functions"></a><span data-ttu-id="6a2c5-195">Component-Specific 函式</span><span class="sxs-lookup"><span data-stu-id="6a2c5-195">Component-Specific Functions</span></span>



| <span data-ttu-id="6a2c5-196">Name</span><span class="sxs-lookup"><span data-stu-id="6a2c5-196">Name</span></span>                                                                     | <span data-ttu-id="6a2c5-197">描述</span><span class="sxs-lookup"><span data-stu-id="6a2c5-197">Description</span></span>                                                                                                                                                                                                                   |
|--------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="6a2c5-198">**MsiProvideAssembly**</span><span class="sxs-lookup"><span data-stu-id="6a2c5-198">**MsiProvideAssembly**</span></span>](/windows/desktop/api/Msi/nf-msi-msiprovideassemblya)                         | <span data-ttu-id="6a2c5-199">安裝並傳回元件的完整元件路徑。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-199">Installs and returns the full component path for an assembly.</span></span>                                                                                                                                                                 |
| [<span data-ttu-id="6a2c5-200">**MsiProvideComponent**</span><span class="sxs-lookup"><span data-stu-id="6a2c5-200">**MsiProvideComponent**</span></span>](/windows/desktop/api/Msi/nf-msi-msiprovidecomponenta)                       | <span data-ttu-id="6a2c5-201">安裝並傳回元件的完整元件路徑。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-201">Installs and returns the full component path of a component.</span></span>                                                                                                                                                                  |
| [<span data-ttu-id="6a2c5-202">**MsiProvideQualifiedComponent**</span><span class="sxs-lookup"><span data-stu-id="6a2c5-202">**MsiProvideQualifiedComponent**</span></span>](/windows/desktop/api/Msi/nf-msi-msiprovidequalifiedcomponenta)     | <span data-ttu-id="6a2c5-203">安裝並傳回合格元件的完整元件路徑。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-203">Installs and returns the full component path of a qualified component.</span></span>                                                                                                                                                        |
| [<span data-ttu-id="6a2c5-204">**MsiProvideQualifiedComponentEx**</span><span class="sxs-lookup"><span data-stu-id="6a2c5-204">**MsiProvideQualifiedComponentEx**</span></span>](/windows/desktop/api/Msi/nf-msi-msiprovidequalifiedcomponentexa) | <span data-ttu-id="6a2c5-205">安裝並傳回產品所發佈之合格元件的完整元件路徑。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-205">Installs and returns the full component path of a qualified component that is published by a product.</span></span>                                                                                                                         |
| [<span data-ttu-id="6a2c5-206">**MsiGetComponentPath**</span><span class="sxs-lookup"><span data-stu-id="6a2c5-206">**MsiGetComponentPath**</span></span>](/windows/desktop/api/Msi/nf-msi-msigetcomponentpatha)                       | <span data-ttu-id="6a2c5-207">傳回已安裝元件的完整路徑或登錄機碼。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-207">Returns the full path or registry key to an installed component.</span></span>                                                                                                                                                              |
| [<span data-ttu-id="6a2c5-208">**MsiGetComponentPathEx**</span><span class="sxs-lookup"><span data-stu-id="6a2c5-208">**MsiGetComponentPathEx**</span></span>](/windows/desktop/api/Msi/nf-msi-msigetcomponentpathexa)                   | <span data-ttu-id="6a2c5-209">將完整路徑或登錄機碼傳給使用者帳戶和安裝內容上已安裝的元件。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-209">Returns the full path or registry key to an installed component across user accounts and installation context.</span></span> <span data-ttu-id="6a2c5-210">**[Windows Installer 4.5 及更早版本](not-supported-in-windows-installer-4-5.md)：** 不支援。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-210">**[Windows Installer 4.5 and earlier](not-supported-in-windows-installer-4-5.md):** Not supported.</span></span><br/> |
| [<span data-ttu-id="6a2c5-211">**MsiLocateComponent**</span><span class="sxs-lookup"><span data-stu-id="6a2c5-211">**MsiLocateComponent**</span></span>](/windows/desktop/api/Msi/nf-msi-msilocatecomponenta)                         | <span data-ttu-id="6a2c5-212">傳回已安裝元件的完整路徑（沒有產品代碼）。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-212">Returns the full path to an installed component without a product code.</span></span>                                                                                                                                                       |
| [<span data-ttu-id="6a2c5-213">**MsiQueryComponentState**</span><span class="sxs-lookup"><span data-stu-id="6a2c5-213">**MsiQueryComponentState**</span></span>](/windows/desktop/api/Msi/nf-msi-msiquerycomponentstatea)                 | <span data-ttu-id="6a2c5-214">傳回元件的已安裝狀態。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-214">Returns the installed state for a component.</span></span> <span data-ttu-id="6a2c5-215">可以查詢在目前使用者以外的使用者帳戶下安裝之產品實例的元件。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-215">Can query components of an instance of a product installed under user accounts other than the current user.</span></span> <span data-ttu-id="6a2c5-216">適用于 Windows Installer 3.0 或更新版本。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-216">Available in Windows Installer  3.0 or later.</span></span>                        |



 

## <a name="application-only-functions"></a><span data-ttu-id="6a2c5-217">Application-Only 函式</span><span class="sxs-lookup"><span data-stu-id="6a2c5-217">Application-Only Functions</span></span>



| <span data-ttu-id="6a2c5-218">Name</span><span class="sxs-lookup"><span data-stu-id="6a2c5-218">Name</span></span>                                             | <span data-ttu-id="6a2c5-219">描述</span><span class="sxs-lookup"><span data-stu-id="6a2c5-219">Description</span></span>                                                            |
|--------------------------------------------------|------------------------------------------------------------------------|
| [<span data-ttu-id="6a2c5-220">**MsiCollectUserInfo**</span><span class="sxs-lookup"><span data-stu-id="6a2c5-220">**MsiCollectUserInfo**</span></span>](/windows/desktop/api/Msi/nf-msi-msicollectuserinfoa) | <span data-ttu-id="6a2c5-221">從安裝精靈儲存使用者資訊。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-221">Stores user information from an installation wizard.</span></span>                   |
| [<span data-ttu-id="6a2c5-222">**MsiUseFeature**</span><span class="sxs-lookup"><span data-stu-id="6a2c5-222">**MsiUseFeature**</span></span>](/windows/desktop/api/Msi/nf-msi-msiusefeaturea)           | <span data-ttu-id="6a2c5-223">遞增功能的使用計數，並指出安裝狀態。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-223">Increments usage count for a feature and indicates installation state.</span></span> |
| [<span data-ttu-id="6a2c5-224">**MsiUseFeatureEx**</span><span class="sxs-lookup"><span data-stu-id="6a2c5-224">**MsiUseFeatureEx**</span></span>](/windows/desktop/api/Msi/nf-msi-msiusefeatureexa)       | <span data-ttu-id="6a2c5-225">遞增功能的使用計數，並指出安裝狀態。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-225">Increments usage count for a feature and indicates installation state.</span></span> |
| [<span data-ttu-id="6a2c5-226">**MsiGetProductCode**</span><span class="sxs-lookup"><span data-stu-id="6a2c5-226">**MsiGetProductCode**</span></span>](/windows/desktop/api/Msi/nf-msi-msigetproductcodea)   | <span data-ttu-id="6a2c5-227">使用元件程式碼傳回產品代碼。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-227">Returns product code using the component code.</span></span>                         |



 

## <a name="system-status-functions"></a><span data-ttu-id="6a2c5-228">系統狀態函數</span><span class="sxs-lookup"><span data-stu-id="6a2c5-228">System Status Functions</span></span>



| <span data-ttu-id="6a2c5-229">Name</span><span class="sxs-lookup"><span data-stu-id="6a2c5-229">Name</span></span>                                                             | <span data-ttu-id="6a2c5-230">描述</span><span class="sxs-lookup"><span data-stu-id="6a2c5-230">Description</span></span>                                                                                                                                                                                                                       |
|------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="6a2c5-231">**MsiEnumProducts**</span><span class="sxs-lookup"><span data-stu-id="6a2c5-231">**MsiEnumProducts**</span></span>](/windows/desktop/api/Msi/nf-msi-msienumproductsa)                       | <span data-ttu-id="6a2c5-232">列舉已公告的產品。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-232">Enumerates advertised products.</span></span>                                                                                                                                                                                                   |
| [<span data-ttu-id="6a2c5-233">**MsiEnumProductsEx**</span><span class="sxs-lookup"><span data-stu-id="6a2c5-233">**MsiEnumProductsEx**</span></span>](/windows/desktop/api/Msi/nf-msi-msienumproductsexa)                   | <span data-ttu-id="6a2c5-234">列舉指定內容中已公告或已安裝產品的所有實例。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-234">Enumerates through all the instances of advertised or installed products in a specified context.</span></span> <span data-ttu-id="6a2c5-235">適用于 Windows Installer 3.0 或更新版本。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-235">Available in Windows Installer  3.0 or later.</span></span>                                                                                    |
| [<span data-ttu-id="6a2c5-236">**MsiEnumRelatedProducts**</span><span class="sxs-lookup"><span data-stu-id="6a2c5-236">**MsiEnumRelatedProducts**</span></span>](/windows/desktop/api/Msi/nf-msi-msienumrelatedproductsa)         | <span data-ttu-id="6a2c5-237">列舉具有指定升級程式碼的目前已安裝產品。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-237">Enumerates currently installed products having a specified upgrade code.</span></span>                                                                                                                                                          |
| [<span data-ttu-id="6a2c5-238">**MsiEnumFeatures**</span><span class="sxs-lookup"><span data-stu-id="6a2c5-238">**MsiEnumFeatures**</span></span>](/windows/desktop/api/Msi/nf-msi-msienumfeaturesa)                       | <span data-ttu-id="6a2c5-239">列舉已發行的功能。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-239">Enumerates published features.</span></span>                                                                                                                                                                                                    |
| [<span data-ttu-id="6a2c5-240">**MsiEnumComponents**</span><span class="sxs-lookup"><span data-stu-id="6a2c5-240">**MsiEnumComponents**</span></span>](/windows/desktop/api/Msi/nf-msi-msienumcomponentsa)                   | <span data-ttu-id="6a2c5-241">列舉已安裝的元件。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-241">Enumerates the installed components.</span></span>                                                                                                                                                                                              |
| [<span data-ttu-id="6a2c5-242">**MsiEnumComponentsEx**</span><span class="sxs-lookup"><span data-stu-id="6a2c5-242">**MsiEnumComponentsEx**</span></span>](/windows/desktop/api/Msi/nf-msi-msienumcomponentsexa)               | <span data-ttu-id="6a2c5-243">列舉跨使用者帳戶和安裝內容的已安裝元件。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-243">Enumerates the installed components across user accounts and installation context.</span></span> <span data-ttu-id="6a2c5-244">**[Windows Installer 4.5 及更早版本](not-supported-in-windows-installer-4-5.md)：** 不支援。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-244">**[Windows Installer 4.5 and earlier](not-supported-in-windows-installer-4-5.md):** Not supported.</span></span><br/>                                 |
| [<span data-ttu-id="6a2c5-245">**MsiEnumClients**</span><span class="sxs-lookup"><span data-stu-id="6a2c5-245">**MsiEnumClients**</span></span>](/windows/desktop/api/Msi/nf-msi-msienumclientsa)                         | <span data-ttu-id="6a2c5-246">列舉已安裝元件的用戶端。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-246">Enumerates the clients of an installed component.</span></span>                                                                                                                                                                                 |
| [<span data-ttu-id="6a2c5-247">**MsiEnumClientsEx**</span><span class="sxs-lookup"><span data-stu-id="6a2c5-247">**MsiEnumClientsEx**</span></span>](/windows/desktop/api/Msi/nf-msi-msienumclientsexa)                     | <span data-ttu-id="6a2c5-248">列舉跨使用者帳戶和安裝內容之已安裝元件的用戶端。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-248">Enumerates the clients of an installed component across user accounts and installation context.</span></span> <span data-ttu-id="6a2c5-249">**[Windows Installer 4.5 及更早版本](not-supported-in-windows-installer-4-5.md)：** 不支援。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-249">**[Windows Installer 4.5 and earlier](not-supported-in-windows-installer-4-5.md):** Not supported.</span></span><br/>                    |
| [<span data-ttu-id="6a2c5-250">**MsiEnumComponentQualifiers**</span><span class="sxs-lookup"><span data-stu-id="6a2c5-250">**MsiEnumComponentQualifiers**</span></span>](/windows/desktop/api/Msi/nf-msi-msienumcomponentqualifiersa) | <span data-ttu-id="6a2c5-251">列舉元件的公告限定詞。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-251">Enumerates the advertised qualifiers for a component.</span></span>                                                                                                                                                                             |
| [<span data-ttu-id="6a2c5-252">**MsiQueryFeatureState**</span><span class="sxs-lookup"><span data-stu-id="6a2c5-252">**MsiQueryFeatureState**</span></span>](/windows/desktop/api/Msi/nf-msi-msiqueryfeaturestatea)             | <span data-ttu-id="6a2c5-253">傳回功能的已安裝狀態。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-253">Returns the installed state of a feature.</span></span>                                                                                                                                                                                         |
| [<span data-ttu-id="6a2c5-254">**MsiQueryFeatureStateEx**</span><span class="sxs-lookup"><span data-stu-id="6a2c5-254">**MsiQueryFeatureStateEx**</span></span>](/windows/desktop/api/Msi/nf-msi-msiqueryfeaturestateexa)         | <span data-ttu-id="6a2c5-255">傳回產品功能的已安裝狀態。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-255">Returns the installed state for a product feature.</span></span> <span data-ttu-id="6a2c5-256">可以查詢在目前使用者以外的使用者帳戶下安裝之產品實例的功能。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-256">Can query features of an instance of a product installed under user accounts other than the current user.</span></span> <span data-ttu-id="6a2c5-257">適用于 Windows Installer 3.0 或更新版本。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-257">Available in Windows Installer  3.0 or later.</span></span>                        |
| [<span data-ttu-id="6a2c5-258">**MsiQueryProductState**</span><span class="sxs-lookup"><span data-stu-id="6a2c5-258">**MsiQueryProductState**</span></span>](/windows/desktop/api/Msi/nf-msi-msiqueryproductstatea)             | <span data-ttu-id="6a2c5-259">傳回應用程式或應用程式套件的已安裝狀態。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-259">Returns the installed state for an application or application suite.</span></span>                                                                                                                                                              |
| [<span data-ttu-id="6a2c5-260">**MsiGetFeatureUsage**</span><span class="sxs-lookup"><span data-stu-id="6a2c5-260">**MsiGetFeatureUsage**</span></span>](/windows/desktop/api/Msi/nf-msi-msigetfeatureusagea)                 | <span data-ttu-id="6a2c5-261">傳回功能的使用計量。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-261">Returns usage metrics for a feature.</span></span>                                                                                                                                                                                              |
| [<span data-ttu-id="6a2c5-262">**MsiGetProductInfo**</span><span class="sxs-lookup"><span data-stu-id="6a2c5-262">**MsiGetProductInfo**</span></span>](/windows/desktop/api/Msi/nf-msi-msigetproductinfoa)                   | <span data-ttu-id="6a2c5-263">傳回已發行和已安裝產品的產品資訊。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-263">Returns product information for published and installed products.</span></span>                                                                                                                                                                 |
| [<span data-ttu-id="6a2c5-264">**MsiGetProductInfoEx**</span><span class="sxs-lookup"><span data-stu-id="6a2c5-264">**MsiGetProductInfoEx**</span></span>](/windows/desktop/api/Msi/nf-msi-msigetproductinfoexa)               | <span data-ttu-id="6a2c5-265">傳回已公告和已安裝產品的產品資訊。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-265">Returns product information for advertised and installed products.</span></span> <span data-ttu-id="6a2c5-266">可以在目前使用者以外的使用者帳戶下，取得所安裝之產品實例的資訊。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-266">Can retrieve information on an instance of a product installed under a user account other than the current user.</span></span> <span data-ttu-id="6a2c5-267">適用于 Windows Installer 3.0 或更新版本。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-267">Available in Windows Installer  3.0 or later.</span></span> |
| [<span data-ttu-id="6a2c5-268">**MsiGetUserInfo**</span><span class="sxs-lookup"><span data-stu-id="6a2c5-268">**MsiGetUserInfo**</span></span>](/windows/desktop/api/Msi/nf-msi-msigetuserinfoa)                         | <span data-ttu-id="6a2c5-269">針對已安裝的產品傳回已註冊的使用者資訊。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-269">Returns registered user information for an installed product.</span></span>                                                                                                                                                                     |



 

## <a name="product-query-functions"></a><span data-ttu-id="6a2c5-270">產品查詢函數</span><span class="sxs-lookup"><span data-stu-id="6a2c5-270">Product Query Functions</span></span>



| <span data-ttu-id="6a2c5-271">Name</span><span class="sxs-lookup"><span data-stu-id="6a2c5-271">Name</span></span>                                                               | <span data-ttu-id="6a2c5-272">描述</span><span class="sxs-lookup"><span data-stu-id="6a2c5-272">Description</span></span>                                                                            |
|--------------------------------------------------------------------|----------------------------------------------------------------------------------------|
| [<span data-ttu-id="6a2c5-273">**MsiOpenProduct**</span><span class="sxs-lookup"><span data-stu-id="6a2c5-273">**MsiOpenProduct**</span></span>](/windows/desktop/api/Msi/nf-msi-msiopenproducta)                           | <span data-ttu-id="6a2c5-274">開啟要與存取資料庫的函數搭配使用的產品。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-274">Opens a product to use with the functions that access the database.</span></span>                    |
| [<span data-ttu-id="6a2c5-275">**MsiOpenPackage**</span><span class="sxs-lookup"><span data-stu-id="6a2c5-275">**MsiOpenPackage**</span></span>](/windows/desktop/api/Msi/nf-msi-msiopenpackagea)                           | <span data-ttu-id="6a2c5-276">開啟要與存取資料庫的函式搭配使用的封裝。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-276">Opens a package to use with the functions that access the database.</span></span>                    |
| [<span data-ttu-id="6a2c5-277">**MsiOpenPackageEx**</span><span class="sxs-lookup"><span data-stu-id="6a2c5-277">**MsiOpenPackageEx**</span></span>](/windows/desktop/api/Msi/nf-msi-msiopenpackageexa)                       | <span data-ttu-id="6a2c5-278">開啟要與存取資料庫的函式搭配使用的封裝。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-278">Opens a package to use with the functions that access the database.</span></span>                    |
| [<span data-ttu-id="6a2c5-279">**MsiIsProductElevated**</span><span class="sxs-lookup"><span data-stu-id="6a2c5-279">**MsiIsProductElevated**</span></span>](/windows/desktop/api/Msi/nf-msi-msiisproductelevateda)               | <span data-ttu-id="6a2c5-280">檢查產品是否以較高的許可權安裝。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-280">Checks whether the product is installed with elevated privileges.</span></span>                      |
| [<span data-ttu-id="6a2c5-281">**MsiGetProductInfoFromScript**</span><span class="sxs-lookup"><span data-stu-id="6a2c5-281">**MsiGetProductInfoFromScript**</span></span>](/windows/desktop/api/Msi/nf-msi-msigetproductinfofromscripta) | <span data-ttu-id="6a2c5-282">傳回安裝程式指令檔的產品資訊。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-282">Returns product information for an installer script file.</span></span>                              |
| [<span data-ttu-id="6a2c5-283">**MsiGetProductProperty**</span><span class="sxs-lookup"><span data-stu-id="6a2c5-283">**MsiGetProductProperty**</span></span>](/windows/desktop/api/Msi/nf-msi-msigetproductpropertya)             | <span data-ttu-id="6a2c5-284">抓取產品資料庫中的屬性。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-284">Retrieves properties in the product database.</span></span>                                          |
| [<span data-ttu-id="6a2c5-285">**MsiGetShortcutTarget**</span><span class="sxs-lookup"><span data-stu-id="6a2c5-285">**MsiGetShortcutTarget**</span></span>](/windows/desktop/api/Msi/nf-msi-msigetshortcuttargeta)               | <span data-ttu-id="6a2c5-286">檢查快捷方式，並傳回其產品、功能名稱和元件（如果有的話）。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-286">Examines a shortcut and returns its product, feature name, and component if available.</span></span> |
| [<span data-ttu-id="6a2c5-287">**MsiGetFeatureInfo**</span><span class="sxs-lookup"><span data-stu-id="6a2c5-287">**MsiGetFeatureInfo**</span></span>](/windows/desktop/api/Msi/nf-msi-msigetfeatureinfoa)                     | <span data-ttu-id="6a2c5-288">傳回功能的描述性資訊。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-288">Returns descriptive information for a feature.</span></span>                                         |
| [<span data-ttu-id="6a2c5-289">**MsiVerifyPackage**</span><span class="sxs-lookup"><span data-stu-id="6a2c5-289">**MsiVerifyPackage**</span></span>](/windows/desktop/api/Msi/nf-msi-msiverifypackagea)                       | <span data-ttu-id="6a2c5-290">確認指定的檔案是安裝套件。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-290">Verifies that a specified file is an installation package.</span></span>                             |



 

## <a name="patching-functions"></a><span data-ttu-id="6a2c5-291">修補函式</span><span class="sxs-lookup"><span data-stu-id="6a2c5-291">Patching Functions</span></span>



| <span data-ttu-id="6a2c5-292">Name</span><span class="sxs-lookup"><span data-stu-id="6a2c5-292">Name</span></span>                                                                   | <span data-ttu-id="6a2c5-293">描述</span><span class="sxs-lookup"><span data-stu-id="6a2c5-293">Description</span></span>                                                                                                                                                        |
|------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="6a2c5-294">**MsiApplyPatch**</span><span class="sxs-lookup"><span data-stu-id="6a2c5-294">**MsiApplyPatch**</span></span>](/windows/desktop/api/Msi/nf-msi-msiapplypatcha)                                 | <span data-ttu-id="6a2c5-295">叫用安裝並套用修補套件。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-295">Invokes an installation and applies a patch package.</span></span>                                                                                                               |
| [<span data-ttu-id="6a2c5-296">**MsiEnumPatches**</span><span class="sxs-lookup"><span data-stu-id="6a2c5-296">**MsiEnumPatches**</span></span>](/windows/desktop/api/Msi/nf-msi-msisourcelistaddmediadiska)                    | <span data-ttu-id="6a2c5-297">傳回套用至產品的每個修補程式的 GUID，以及適用于產品的每個修補程式的轉換清單。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-297">Returns the GUID for each patch that is applied to a product, and a list of transforms from each patch that apply to the product.</span></span>                                  |
| [<span data-ttu-id="6a2c5-298">**MsiGetPatchInfo**</span><span class="sxs-lookup"><span data-stu-id="6a2c5-298">**MsiGetPatchInfo**</span></span>](/windows/desktop/api/Msi/nf-msi-msigetpatchinfoa)                             | <span data-ttu-id="6a2c5-299">傳回修補程式的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-299">Returns information about a patch.</span></span>                                                                                                                                 |
| [<span data-ttu-id="6a2c5-300">**MsiRemovePatches**</span><span class="sxs-lookup"><span data-stu-id="6a2c5-300">**MsiRemovePatches**</span></span>](/windows/desktop/api/Msi/nf-msi-msiremovepatchesa)                           | <span data-ttu-id="6a2c5-301">從產品卸載修補程式。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-301">Uninstalls a patch from a product.</span></span> <span data-ttu-id="6a2c5-302">適用于 Windows Installer 3.0。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-302">Available in Windows Installer 3.0.</span></span>                                                                                             |
| [<span data-ttu-id="6a2c5-303">**MsiDeterminePatchSequence**</span><span class="sxs-lookup"><span data-stu-id="6a2c5-303">**MsiDeterminePatchSequence**</span></span>](/windows/desktop/api/Msi/nf-msi-msideterminepatchsequencea)         | <span data-ttu-id="6a2c5-304">判斷一組修補程式和產品的最佳應用程式順序。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-304">Determines the best application sequence for a set of patches and product.</span></span> <span data-ttu-id="6a2c5-305">適用于 Windows Installer 3.0。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-305">Available in Windows Installer 3.0.</span></span>                                                     |
| [<span data-ttu-id="6a2c5-306">**MsiApplyMultiplePatches**</span><span class="sxs-lookup"><span data-stu-id="6a2c5-306">**MsiApplyMultiplePatches**</span></span>](/windows/desktop/api/Msi/nf-msi-msiapplymultiplepatchesa)             | <span data-ttu-id="6a2c5-307">將一或多個修補程式套用至產品。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-307">Applies one or more patches to products.</span></span> <span data-ttu-id="6a2c5-308">適用于 Windows Installer 3.0。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-308">Available in Windows Installer 3.0.</span></span>                                                                                       |
| [<span data-ttu-id="6a2c5-309">**MsiEnumPatchesEx**</span><span class="sxs-lookup"><span data-stu-id="6a2c5-309">**MsiEnumPatchesEx**</span></span>](/windows/desktop/api/Msi/nf-msi-msienumpatchesexa)                           | <span data-ttu-id="6a2c5-310">列舉針對特定內容中的產品套用的所有修補程式，或在所有內容中套用的所有修補程式。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-310">Enumerates all patches applied for a product in a particular context or across all contexts.</span></span> <span data-ttu-id="6a2c5-311">適用于 Windows Installer 3.0。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-311">Available in Windows Installer 3.0.</span></span>                                   |
| [<span data-ttu-id="6a2c5-312">**MsiGetPatchFileList**</span><span class="sxs-lookup"><span data-stu-id="6a2c5-312">**MsiGetPatchFileList**</span></span>](/windows/desktop/api/Msi/nf-msi-msigetpatchfilelista)                     | <span data-ttu-id="6a2c5-313">當提供 .msp 檔的清單時，此函式會抓取相容修補程式可更新的檔案清單。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-313">When provided a list of .msp files this function retrieves the list of files that can be updated by the patches for the targe.</span></span> <span data-ttu-id="6a2c5-314">適用于 Windows Installer 4.0。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-314">Available in Windows Installer 4.0.</span></span> |
| [<span data-ttu-id="6a2c5-315">**MsiGetPatchInfoEx**</span><span class="sxs-lookup"><span data-stu-id="6a2c5-315">**MsiGetPatchInfoEx**</span></span>](/windows/desktop/api/Msi/nf-msi-msigetpatchinfoexa)                         | <span data-ttu-id="6a2c5-316">查詢指定產品之指定修補程式的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-316">Queries for information about the application of a specified patch to a specified product.</span></span> <span data-ttu-id="6a2c5-317">適用于 Windows Installer 3.0。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-317">Available in Windows Installer 3.0.</span></span>                                     |
| [<span data-ttu-id="6a2c5-318">**MsiExtractPatchXMLData**</span><span class="sxs-lookup"><span data-stu-id="6a2c5-318">**MsiExtractPatchXMLData**</span></span>](/windows/desktop/api/Msi/nf-msi-msiextractpatchxmldataa)               | <span data-ttu-id="6a2c5-319">從修補程式中解壓縮資訊。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-319">Extracts information from a patch.</span></span> <span data-ttu-id="6a2c5-320">適用于 Windows Installer 3.0。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-320">Available in Windows Installer 3.0.</span></span>                                                                                             |
| [<span data-ttu-id="6a2c5-321">**MsiDetermineApplicablePatches**</span><span class="sxs-lookup"><span data-stu-id="6a2c5-321">**MsiDetermineApplicablePatches**</span></span>](/windows/desktop/api/Msi/nf-msi-msidetermineapplicablepatchesa) | <span data-ttu-id="6a2c5-322">決定更新產品或產品集所需的最佳修補集。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-322">Determines the best set of patches required to update a product or set of products.</span></span> <span data-ttu-id="6a2c5-323">適用于 Windows Installer 3.0。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-323">Available in Windows Installer 3.0.</span></span>                                            |



 

## <a name="file-query-functions"></a><span data-ttu-id="6a2c5-324">檔案查詢函數</span><span class="sxs-lookup"><span data-stu-id="6a2c5-324">File Query Functions</span></span>



| <span data-ttu-id="6a2c5-325">Name</span><span class="sxs-lookup"><span data-stu-id="6a2c5-325">Name</span></span>                                                                     | <span data-ttu-id="6a2c5-326">描述</span><span class="sxs-lookup"><span data-stu-id="6a2c5-326">Description</span></span>                                                                                                 |
|--------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="6a2c5-327">**MsiGetFileHash**</span><span class="sxs-lookup"><span data-stu-id="6a2c5-327">**MsiGetFileHash**</span></span>](/windows/desktop/api/Msi/nf-msi-msigetfilehasha)                                 | <span data-ttu-id="6a2c5-328">取得檔案的路徑，並傳回該檔案的128位雜湊。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-328">Takes the path to a file and returns a 128-bit hash of that file.</span></span>                                           |
| [<span data-ttu-id="6a2c5-329">**MsiGetFileSignatureInformation**</span><span class="sxs-lookup"><span data-stu-id="6a2c5-329">**MsiGetFileSignatureInformation**</span></span>](/windows/desktop/api/Msi/nf-msi-msigetfilesignatureinformationa) | <span data-ttu-id="6a2c5-330">採用經過數位簽署的檔案路徑，並傳回檔案的簽署者憑證和雜湊。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-330">Takes the path to a file that has been digitally signed and returns the file's signer certificate and hash.</span></span> |
| [<span data-ttu-id="6a2c5-331">**MsiGetFileVersion**</span><span class="sxs-lookup"><span data-stu-id="6a2c5-331">**MsiGetFileVersion**</span></span>](/windows/desktop/api/Msi/nf-msi-msigetfileversiona)                           | <span data-ttu-id="6a2c5-332">傳回版本字串和語言字串。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-332">Returns the version string and language string.</span></span>                                                             |



 

## <a name="transaction-management-functions"></a><span data-ttu-id="6a2c5-333">交易管理函數</span><span class="sxs-lookup"><span data-stu-id="6a2c5-333">Transaction Management Functions</span></span>



| <span data-ttu-id="6a2c5-334">Name</span><span class="sxs-lookup"><span data-stu-id="6a2c5-334">Name</span></span>                                               | <span data-ttu-id="6a2c5-335">描述</span><span class="sxs-lookup"><span data-stu-id="6a2c5-335">Description</span></span>                                                                                                                                                                                         |
|----------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="6a2c5-336">**MsiBeginTransaction**</span><span class="sxs-lookup"><span data-stu-id="6a2c5-336">**MsiBeginTransaction**</span></span>](/windows/desktop/api/Msi/nf-msi-msibegintransactiona) | <span data-ttu-id="6a2c5-337">啟動多套件安裝的交易處理，並傳回交易的識別碼。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-337">Starts transaction processing of a multiple-package installation and returns an identifier for the transaction.</span></span> <span data-ttu-id="6a2c5-338">從 Windows Installer 4.5 開始，可以使用此函數。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-338">This function is available beginning with Windows Installer 4.5.</span></span>                    |
| [<span data-ttu-id="6a2c5-339">**MsiJoinTransaction**</span><span class="sxs-lookup"><span data-stu-id="6a2c5-339">**MsiJoinTransaction**</span></span>](/windows/desktop/api/Msi/nf-msi-msijointransaction)   | <span data-ttu-id="6a2c5-340">要求 Windows Installer 讓目前的進程成為安裝多套件安裝的交易擁有者。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-340">Requests that the Windows Installer make the current process the owner of the transaction installing a multi-package installation.</span></span> <span data-ttu-id="6a2c5-341">從 Windows Installer 4.5 開始，可以使用此函數。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-341">This function is available beginning with Windows Installer 4.5.</span></span> |
| [<span data-ttu-id="6a2c5-342">**MsiEndTransaction**</span><span class="sxs-lookup"><span data-stu-id="6a2c5-342">**MsiEndTransaction**</span></span>](/windows/desktop/api/Msi/nf-msi-msiendtransaction)     | <span data-ttu-id="6a2c5-343">認可或復原屬於交易的所有安裝。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-343">Commits or rolls back all the installations belonging to the transaction.</span></span> <span data-ttu-id="6a2c5-344">從 Windows Installer 4.5 開始，可以使用此函數。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-344">This function is available beginning with Windows Installer 4.5.</span></span>                                                          |



 

## <a name="database-functions"></a><span data-ttu-id="6a2c5-345">資料庫函數</span><span class="sxs-lookup"><span data-stu-id="6a2c5-345">Database Functions</span></span>

<span data-ttu-id="6a2c5-346">除了上表中所識別的 Windows Installer 函數以外，您還可以使用 [資料庫](database-functions.md) 函式區段中所述的資料庫存取函式，操作安裝資料庫中的資訊。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-346">In addition to the Windows Installer functions identified in the previous tables, you can manipulate information in the installation database by using the database access functions that are described in the [Database Functions](database-functions.md) section.</span></span>

## <a name="installer-structures"></a><span data-ttu-id="6a2c5-347">安裝程式結構</span><span class="sxs-lookup"><span data-stu-id="6a2c5-347">Installer Structures</span></span>

<span data-ttu-id="6a2c5-348">此外，安裝資料庫中的某些資訊是使用 [安裝程式結構](installer-structures.md) 一節中所述的結構來處理。</span><span class="sxs-lookup"><span data-stu-id="6a2c5-348">In addition, some information in the installation database is handled using the structures described in the [Installer Structures](installer-structures.md) section.</span></span>

 

 




