---
description: 在某些情況下，作者可能會決定需要中斷建立元件的規則，如在將應用程式組織為元件及變更元件程式碼中所述。
ms.assetid: 487b6a00-77eb-4c51-8e32-46bcd4493df8
title: 如果元件規則中斷，會發生什麼事？
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e3f830fa402da44be992d74adc957d88a19442dcbb51173a87e79fa2266552a1
ms.sourcegitcommit: e6600f550f79bddfe58bd4696ac50dd52cb03d7e
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/11/2021
ms.locfileid: "119498764"
---
# <a name="what-happens-if-the-component-rules-are-broken"></a>如果元件規則中斷，會發生什麼事？

在某些情況下，作者可能會決定需要中斷建立元件的規則，如在將 [應用程式組織為元件](organizing-applications-into-components.md) 及 [變更元件程式碼](changing-the-component-code.md)中所述。 作者必須留意執行這項操作的可能結果，也必須保證他們的元件絕對不會安裝在使用者系統上的其他應用程式或元件損毀。

下列清單描述作者有時候會中斷建議元件規則和可能結果的方式。

作者將資源新增至元件，而不需要變更元件程式碼。

-   與舊元件一起安裝的產品，不會有其安裝資料庫中所新增資源的相關資訊。
-   如果有新增資源的新產品和舊的產品都安裝在同一部電腦上，則在第一次卸載新產品時，可能會遺留資源。
-   沒有新增資源的舊產品無法修復較新版本的元件。 重新安裝舊的產品並不會還原新增的資源。

作者移除元件中的資源，而不會變更元件程式碼。

-   隨新元件一起安裝的產品，不會有其安裝資料庫中移除之資源的相關資訊。
-   如果舊的產品、具有資源資訊和新產品都安裝在同一部電腦上，則如果先卸載舊的產品，則可以遺留資源。
-   具有已移除資源的新產品無法修復較舊版本的產品。 重新安裝新產品並不會還原移除的資源。

作者包含與舊版不相容的檔案，而不會變更元件程式碼。

如果元件中包含不相容的檔案而不變更元件程式碼，則 [預設檔案版本控制](default-file-versioning.md) 會導致安裝程式以最新的不相容檔案覆寫原始檔案。 這可能會損毀需要原始檔案的舊產品。 它也可能會防止安裝程式修復舊的產品，因為元件的金鑰路徑檔案版本會決定元件的版本。 如果已安裝較新版本的金鑰路徑檔案，安裝程式就不會安裝舊版的元件。 如需詳細資訊，請參閱檔案 [版本控制規則](file-versioning-rules.md)。 在此情況下，必須先移除新的產品，才能重新安裝舊的產品。

-   [預設檔案版本控制](default-file-versioning.md) 會導致安裝程式以最新的不相容檔案覆寫原始檔案。
-   需要原始檔案的舊產品已損毀。
-   它也可能會防止安裝程式修復舊的產品，因為元件的金鑰路徑檔案版本會決定元件的版本。 如果已安裝較新版本的金鑰路徑檔案，安裝程式就不會安裝舊版的元件。 如需詳細資訊，請參閱檔案 [版本控制規則](file-versioning-rules.md)。 在此情況下，必須先移除新的產品，才能重新安裝舊的產品。

作者在兩個不同的元件中包含相同的資源。

如果有兩個元件的資源位於相同的名稱和位置，而且這兩個元件都安裝在相同的資料夾中，則移除任一元件會移除共同的資源，這會破壞其餘的元件。

-   卸載任一元件會移除資源並中斷另一個元件。
-   元件參考計數機制已損毀。

 

 



