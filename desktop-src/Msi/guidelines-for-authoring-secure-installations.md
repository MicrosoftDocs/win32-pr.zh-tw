---
description: 若要在軟體安裝期間協助維護安全的環境，請在撰寫 Windows Installer 套件時遵守這些指導方針。
ms.assetid: 04d91a9b-0528-4acb-8e11-fc817009db1f
title: 撰寫安全安裝的指導方針
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e9d18e66c38480149ddad9e381c6461ffe50cf0b
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/08/2021
ms.locfileid: "106980367"
---
# <a name="guidelines-for-authoring-secure-installations"></a><span data-ttu-id="d927d-103">撰寫安全安裝的指導方針</span><span class="sxs-lookup"><span data-stu-id="d927d-103">Guidelines for Authoring Secure Installations</span></span>

<span data-ttu-id="d927d-104">在撰寫 Windows Installer 套件時遵循下列指導方針，可協助您在安裝期間維護安全的環境：</span><span class="sxs-lookup"><span data-stu-id="d927d-104">Adherence to the following guidelines when authoring a Windows Installer package helps maintain a secure environment during installation:</span></span>

-   <span data-ttu-id="d927d-105">系統管理員應將受管理的應用程式安裝到目標安裝資料夾中，而非系統管理員的使用者沒有變更或修改許可權。</span><span class="sxs-lookup"><span data-stu-id="d927d-105">Administrators should install managed applications into a target installation folder for which non-admin users do not have change or modify privileges.</span></span>
-   <span data-ttu-id="d927d-106">將任何由使用者設定的屬性設為公用屬性。</span><span class="sxs-lookup"><span data-stu-id="d927d-106">Make any property set by the user a public property.</span></span> <span data-ttu-id="d927d-107">使用者與使用者介面互動時，無法變更私用屬性。</span><span class="sxs-lookup"><span data-stu-id="d927d-107">Private properties cannot be changed by the user interacting with the user interface.</span></span> <span data-ttu-id="d927d-108">如需相關資訊，請參閱 [關於屬性](about-properties.md)。</span><span class="sxs-lookup"><span data-stu-id="d927d-108">For information, see [About Properties](about-properties.md).</span></span>
-   <span data-ttu-id="d927d-109">請勿將屬性用於密碼或其他必須保持安全的資訊。</span><span class="sxs-lookup"><span data-stu-id="d927d-109">Do not use properties for passwords or other information that must remain secure.</span></span> <span data-ttu-id="d927d-110">安裝程式可以將撰寫的屬性值寫入至記錄檔或系統登錄 [中，或是](property-table.md)在執行時間建立的屬性值。</span><span class="sxs-lookup"><span data-stu-id="d927d-110">The installer may write the value of a property authored into the [Property table](property-table.md), or created at run time, into a log or the system registry.</span></span> <span data-ttu-id="d927d-111">如需其他資訊，請參閱 [防止機密資訊寫入至記錄](preventing-confidential-information-from-being-written-into-the-log-file.md)檔。</span><span class="sxs-lookup"><span data-stu-id="d927d-111">For additional information, see [Preventing Confidential Information from Being Written into the Log File](preventing-confidential-information-from-being-written-into-the-log-file.md).</span></span>
-   <span data-ttu-id="d927d-112">當安裝需要安裝程式使用較 [*高*](e-gly.md) 的許可權時，請使用 [受限制的公用屬性](restricted-public-properties.md) 來限制使用者可變更的公用屬性。</span><span class="sxs-lookup"><span data-stu-id="d927d-112">When the installation requires the installer to use [*elevated*](e-gly.md) privileges, use [Restricted Public Properties](restricted-public-properties.md) to restrict the public properties a user can change.</span></span> <span data-ttu-id="d927d-113">當安裝要求安裝程式需要使用較 *高* 的許可權時，通常需要一些限制才能維護安全的環境。</span><span class="sxs-lookup"><span data-stu-id="d927d-113">Some restrictions are commonly necessary to maintain a secure environment when the installation requires the installer to use *elevated* privileges.</span></span>
-   <span data-ttu-id="d927d-114">請避免安裝可模擬特定使用者之許可權的服務，因為這可能會將安全性資料寫入至記錄檔或系統登錄。</span><span class="sxs-lookup"><span data-stu-id="d927d-114">Avoid installing services that impersonate the privileges of a particular user because this may write security data into a log or the system registry.</span></span> <span data-ttu-id="d927d-115">這會造成安全性問題、密碼衝突或系統重新開機時遺失設定資料的可能性。</span><span class="sxs-lookup"><span data-stu-id="d927d-115">This creates potential for a security problem, password conflict, or the loss of configuration data when the system is restarted.</span></span> <span data-ttu-id="d927d-116">如需詳細資訊，請參閱 [ServiceInstall 資料表](serviceinstall-table.md)。</span><span class="sxs-lookup"><span data-stu-id="d927d-116">For details, see [ServiceInstall table](serviceinstall-table.md).</span></span>
-   <span data-ttu-id="d927d-117">使用 [LockPermissions 資料表](lockpermissions-table.md) 和 [MsiLockPermissionsEx 資料表](msilockpermissionsex-table.md) ，在鎖定的環境中保護服務、檔案、登錄機碼和建立的資料夾。</span><span class="sxs-lookup"><span data-stu-id="d927d-117">Use the [LockPermissions table](lockpermissions-table.md) and [MsiLockPermissionsEx table](msilockpermissionsex-table.md) to secure services, files, registry keys, and created folders in a locked-down environment.</span></span>
-   <span data-ttu-id="d927d-118">在安裝中新增數位簽章，以確保檔案的完整性。</span><span class="sxs-lookup"><span data-stu-id="d927d-118">Add a digital signatures to the installation to ensure the integrity of the files.</span></span> <span data-ttu-id="d927d-119">如需詳細資訊，請參閱 [數位簽章和 Windows Installer](digital-signatures-and-windows-installer.md) ，並 [撰寫經過完整驗證的已簽署安裝](authoring-a-fully-verified-signed-installation.md)。</span><span class="sxs-lookup"><span data-stu-id="d927d-119">For details, see [Digital Signatures and Windows Installer](digital-signatures-and-windows-installer.md) and [Authoring a Fully Verified Signed Installation](authoring-a-fully-verified-signed-installation.md).</span></span>
-   <span data-ttu-id="d927d-120">撰寫您的 Windows Installer 套件，如此一來，如果使用者被拒絕存取資源，則安裝程式會以維護安全環境的方式失敗。</span><span class="sxs-lookup"><span data-stu-id="d927d-120">Author your Windows Installer package such that if the user is denied access to resources, the setup fails in a manner that maintains a secure environment.</span></span> <span data-ttu-id="d927d-121">檢查使用者的存取權限，並判斷是否有足夠的磁碟空間，然後才開始安裝。</span><span class="sxs-lookup"><span data-stu-id="d927d-121">Check the user's access privileges and determine whether there is sufficient disk space before installation begins.</span></span> <span data-ttu-id="d927d-122">通常，如果目前的使用者是系統管理員，或如果安裝不需要較 [*高*](e-gly.md) 的許可權，安裝程式應該只顯示 [流覽] 對話方塊。</span><span class="sxs-lookup"><span data-stu-id="d927d-122">Commonly, the installer should only display a browse dialog box if the current user is an administrator or if the installation does not require [*elevated*](e-gly.md) privileges.</span></span> <span data-ttu-id="d927d-123">如需詳細資訊，請參閱 [來源復原](source-resiliency.md)。</span><span class="sxs-lookup"><span data-stu-id="d927d-123">For details, see [Source Resiliency](source-resiliency.md).</span></span>
-   <span data-ttu-id="d927d-124">使用 [安全的轉換](secured-transforms.md) 將轉換儲存在使用者電腦本機的安全檔案系統中。</span><span class="sxs-lookup"><span data-stu-id="d927d-124">Use [Secured Transforms](secured-transforms.md) to store transforms in a secure file system locally on the user's computer.</span></span> <span data-ttu-id="d927d-125">這可防止使用者擁有轉換的寫入權限。</span><span class="sxs-lookup"><span data-stu-id="d927d-125">This prevents the user from having write access to the transform.</span></span>
-   <span data-ttu-id="d927d-126">如需如何保護受控應用程式之媒體來源的詳細資訊，請參閱 [來源復原](source-resiliency.md)。</span><span class="sxs-lookup"><span data-stu-id="d927d-126">For information on how to secure media sources of managed applications, see [Source Resiliency](source-resiliency.md).</span></span>
-   <span data-ttu-id="d927d-127">使用 [ [**安全性摘要**](security-summary.md) ] 屬性來指出是否應該以唯讀方式開啟封裝。</span><span class="sxs-lookup"><span data-stu-id="d927d-127">Use the [**Security Summary**](security-summary.md) Property to indicate whether the package should be opened as read-only.</span></span> <span data-ttu-id="d927d-128">這個屬性應該設為唯讀，建議用於安裝資料庫，並針對轉換或修補程式強制唯讀。</span><span class="sxs-lookup"><span data-stu-id="d927d-128">This property should be set to read-only recommended for an installation database and to read-only enforced for a transform or patch.</span></span>
-   <span data-ttu-id="d927d-129">安裝程式預設會以使用者權限執行自訂動作，以限制對系統的自訂動作的存取。</span><span class="sxs-lookup"><span data-stu-id="d927d-129">The installer runs custom actions with user privileges by default in order to limit the access of custom actions to the system.</span></span> <span data-ttu-id="d927d-130">如果正在安裝受管理的應用程式，或已針對較高的許可權指定系統原則，則安裝程式可能會以更 [*高*](e-gly.md) 的許可權執行自訂動作。</span><span class="sxs-lookup"><span data-stu-id="d927d-130">The installer may run custom actions with [*elevated*](e-gly.md) privileges if a managed application is being installed or if the system policy has been specified for elevated privileges.</span></span> <span data-ttu-id="d927d-131">如需詳細資訊，請參閱 [自訂動作安全性](custom-action-security.md)。</span><span class="sxs-lookup"><span data-stu-id="d927d-131">For details, see [Custom Action Security](custom-action-security.md).</span></span>
-   <span data-ttu-id="d927d-132">使用 [DisablePatch](disablepatch.md) 原則，在必須限制修補的環境中提供安全性。</span><span class="sxs-lookup"><span data-stu-id="d927d-132">Use the [DisablePatch](disablepatch.md) policy to provide security in environments where patching must be restricted.</span></span>
-   <span data-ttu-id="d927d-133">使用 [AppId 資料表](appid-table.md) 來註冊 DCOM 物件的一般安全性和設定。</span><span class="sxs-lookup"><span data-stu-id="d927d-133">Use the [AppId table](appid-table.md) to register common security and configuration settings for DCOM objects.</span></span>
-   <span data-ttu-id="d927d-134">如需相關資訊，請參閱 [保護自訂動作的指導方針](guidelines-for-securing-custom-actions.md)。</span><span class="sxs-lookup"><span data-stu-id="d927d-134">For related information, see [Guidelines for Securing Custom Actions](guidelines-for-securing-custom-actions.md).</span></span>
-   <span data-ttu-id="d927d-135">如需相關資訊，請參閱 [在鎖定的電腦上保護套件安全的指導方針](guidelines-for-securing-packages-on-locked-down-computers.md)。</span><span class="sxs-lookup"><span data-stu-id="d927d-135">For related information, see [Guidelines for Securing Packages on Locked-Down Computers](guidelines-for-securing-packages-on-locked-down-computers.md).</span></span>
-   <span data-ttu-id="d927d-136">從 Windows Installer 3.0 開始， [ (UAC) 修補的使用者帳戶控制](user-account-control--uac--patching.md) 可讓非系統管理員使用者修補個別電腦內容中安裝的應用程式。</span><span class="sxs-lookup"><span data-stu-id="d927d-136">Starting with Windows Installer 3.0, [User Account Control (UAC) Patching](user-account-control--uac--patching.md) enables non-administrator users to patch applications installed in the per-machine context.</span></span> <span data-ttu-id="d927d-137">UAC 修補的啟用方式是在 [MsiPatchCertificate](msipatchcertificate-table.md) 資料表中提供簽署者憑證，並使用相同的憑證簽署修補程式。</span><span class="sxs-lookup"><span data-stu-id="d927d-137">UAC patching is enabled by providing a signer certificate in the [MsiPatchCertificate](msipatchcertificate-table.md) table and signing patches with the same certificate.</span></span>
-   <span data-ttu-id="d927d-138">Windows Installer 5.0 的功能來設定服務、檔案、建立資料夾和登錄專案的存取權限，可協助讓安裝應用程式更安全。</span><span class="sxs-lookup"><span data-stu-id="d927d-138">The capability of the Windows Installer 5.0 to set access permissions on services, files, created folders, and registry entries can help make installation applications more secure.</span></span> <span data-ttu-id="d927d-139">如需詳細資訊，請參閱 [保護資源](securing-resources-.md)。</span><span class="sxs-lookup"><span data-stu-id="d927d-139">For information, see [Securing Resources](securing-resources-.md).</span></span>

 

 



