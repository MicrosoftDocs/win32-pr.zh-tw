---
description: ModuleSubstitution 資料表會指定模組資料庫的可設定欄位，並為每個欄位的設定提供範本。
ms.assetid: 8e94c31f-b3a7-4f3a-aec4-32b0e1dd5400
title: ModuleSubstitution 資料表
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 2e27789f723af87e228bada91b79a16d7dc4d2d4
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/08/2021
ms.locfileid: "104195281"
---
# <a name="modulesubstitution-table"></a><span data-ttu-id="b3fa8-103">ModuleSubstitution 資料表</span><span class="sxs-lookup"><span data-stu-id="b3fa8-103">ModuleSubstitution Table</span></span>

<span data-ttu-id="b3fa8-104">ModuleSubstitution 資料表會指定模組資料庫的可設定欄位，並為每個欄位的設定提供範本。</span><span class="sxs-lookup"><span data-stu-id="b3fa8-104">The ModuleSubstitution table specifies the configurable fields of a module database and provides a template for the configuration of each field.</span></span> <span data-ttu-id="b3fa8-105">使用者或合併工具可能會查詢此資料表，以判斷要進行的設定作業。</span><span class="sxs-lookup"><span data-stu-id="b3fa8-105">The user or merge tool may query this table to determine what configuration operations are to take place.</span></span> <span data-ttu-id="b3fa8-106">此資料表不會合並到目標資料庫。</span><span class="sxs-lookup"><span data-stu-id="b3fa8-106">This table is not merged into the target database.</span></span>

<span data-ttu-id="b3fa8-107">下列資料表不能包含可設定的欄位，而且不得列在此資料表中：</span><span class="sxs-lookup"><span data-stu-id="b3fa8-107">The following tables cannot contain configurable fields and must not be listed in this table:</span></span>

<span data-ttu-id="b3fa8-108">ModuleSubstitution 資料表</span><span class="sxs-lookup"><span data-stu-id="b3fa8-108">ModuleSubstitution table</span></span>

[<span data-ttu-id="b3fa8-109">ModuleConfiguration 資料表</span><span class="sxs-lookup"><span data-stu-id="b3fa8-109">ModuleConfiguration table</span></span>](moduleconfiguration-table.md)

[<span data-ttu-id="b3fa8-110">ModuleExclusion 資料表</span><span class="sxs-lookup"><span data-stu-id="b3fa8-110">ModuleExclusion table</span></span>](moduleexclusion-table.md)

[<span data-ttu-id="b3fa8-111">ModuleSignature 資料表</span><span class="sxs-lookup"><span data-stu-id="b3fa8-111">ModuleSignature table</span></span>](modulesignature-table.md)

<span data-ttu-id="b3fa8-112">ModuleSubstitution 資料表具有下列資料行。</span><span class="sxs-lookup"><span data-stu-id="b3fa8-112">The ModuleSubstitution table has the following columns.</span></span>



| <span data-ttu-id="b3fa8-113">Column</span><span class="sxs-lookup"><span data-stu-id="b3fa8-113">Column</span></span> | <span data-ttu-id="b3fa8-114">類型</span><span class="sxs-lookup"><span data-stu-id="b3fa8-114">Type</span></span>                         | <span data-ttu-id="b3fa8-115">答案</span><span class="sxs-lookup"><span data-stu-id="b3fa8-115">Key</span></span> | <span data-ttu-id="b3fa8-116">Nullable</span><span class="sxs-lookup"><span data-stu-id="b3fa8-116">Nullable</span></span> |
|--------|------------------------------|-----|----------|
| <span data-ttu-id="b3fa8-117">資料表</span><span class="sxs-lookup"><span data-stu-id="b3fa8-117">Table</span></span>  | [<span data-ttu-id="b3fa8-118">識別碼</span><span class="sxs-lookup"><span data-stu-id="b3fa8-118">Identifier</span></span>](identifier.md) | <span data-ttu-id="b3fa8-119">Y</span><span class="sxs-lookup"><span data-stu-id="b3fa8-119">Y</span></span>   | <span data-ttu-id="b3fa8-120">N</span><span class="sxs-lookup"><span data-stu-id="b3fa8-120">N</span></span>        |
| <span data-ttu-id="b3fa8-121">資料列</span><span class="sxs-lookup"><span data-stu-id="b3fa8-121">Row</span></span>    | [<span data-ttu-id="b3fa8-122">Text</span><span class="sxs-lookup"><span data-stu-id="b3fa8-122">Text</span></span>](text.md)             | <span data-ttu-id="b3fa8-123">Y</span><span class="sxs-lookup"><span data-stu-id="b3fa8-123">Y</span></span>   | <span data-ttu-id="b3fa8-124">N</span><span class="sxs-lookup"><span data-stu-id="b3fa8-124">N</span></span>        |
| <span data-ttu-id="b3fa8-125">Column</span><span class="sxs-lookup"><span data-stu-id="b3fa8-125">Column</span></span> | [<span data-ttu-id="b3fa8-126">識別碼</span><span class="sxs-lookup"><span data-stu-id="b3fa8-126">Identifier</span></span>](identifier.md) | <span data-ttu-id="b3fa8-127">Y</span><span class="sxs-lookup"><span data-stu-id="b3fa8-127">Y</span></span>   | <span data-ttu-id="b3fa8-128">N</span><span class="sxs-lookup"><span data-stu-id="b3fa8-128">N</span></span>        |
| <span data-ttu-id="b3fa8-129">值</span><span class="sxs-lookup"><span data-stu-id="b3fa8-129">Value</span></span>  | [<span data-ttu-id="b3fa8-130">Text</span><span class="sxs-lookup"><span data-stu-id="b3fa8-130">Text</span></span>](text.md)             | <span data-ttu-id="b3fa8-131">N</span><span class="sxs-lookup"><span data-stu-id="b3fa8-131">N</span></span>   | <span data-ttu-id="b3fa8-132">Y</span><span class="sxs-lookup"><span data-stu-id="b3fa8-132">Y</span></span>        |



 

## <a name="columns"></a><span data-ttu-id="b3fa8-133">資料行</span><span class="sxs-lookup"><span data-stu-id="b3fa8-133">Columns</span></span>

<dl> <dt>

<span data-ttu-id="b3fa8-134"><span id="Table"></span><span id="table"></span><span id="TABLE"></span>表</span><span class="sxs-lookup"><span data-stu-id="b3fa8-134"><span id="Table"></span><span id="table"></span><span id="TABLE"></span>Table</span></span>
</dt> <dd>

<span data-ttu-id="b3fa8-135">此資料行指定要在模組資料庫中修改的資料表名稱。</span><span class="sxs-lookup"><span data-stu-id="b3fa8-135">This column specifies the name of the table being modified in the module database.</span></span>

</dd> <dt>

<span data-ttu-id="b3fa8-136"><span id="Row"></span><span id="row"></span><span id="ROW"></span>行</span><span class="sxs-lookup"><span data-stu-id="b3fa8-136"><span id="Row"></span><span id="row"></span><span id="ROW"></span>Row</span></span>
</dt> <dd>

<span data-ttu-id="b3fa8-137">此欄位會在資料表資料行中指定的資料表中，指定目標資料列的主鍵。</span><span class="sxs-lookup"><span data-stu-id="b3fa8-137">This field specifies the primary keys of the target row in the table named in the Table column.</span></span> <span data-ttu-id="b3fa8-138">多個主鍵會以分號分隔。</span><span class="sxs-lookup"><span data-stu-id="b3fa8-138">Multiple primary keys are separated by semicolons.</span></span> <span data-ttu-id="b3fa8-139">在對目標資料表進行任何變更之前，已選取要修改的目標資料列。</span><span class="sxs-lookup"><span data-stu-id="b3fa8-139">Target rows are selected for modification before any changes are made to the target table.</span></span> <span data-ttu-id="b3fa8-140">如果 ModuleSubstitution 資料表中的一筆記錄變更目標資料列的主鍵欄位，則會根據原始主鍵資料套用 ModuleSubstitution 資料表中的其他記錄，而不是主鍵替代的結果。</span><span class="sxs-lookup"><span data-stu-id="b3fa8-140">If one record in the ModuleSubstitution table changes the primary key field of a target row, other records in the ModuleSubstitution table are applied based on the original primary key data, not the resulting of primary key substitutions.</span></span> <span data-ttu-id="b3fa8-141">資料列替代的順序未定義。</span><span class="sxs-lookup"><span data-stu-id="b3fa8-141">The order of row substitution is undefined.</span></span>

<span data-ttu-id="b3fa8-142">本資料行中的值一律為 [CMSM 的特殊格式](cmsm-special-format.md)。</span><span class="sxs-lookup"><span data-stu-id="b3fa8-142">Values in this column are always in [CMSM special format](cmsm-special-format.md).</span></span> <span data-ttu-id="b3fa8-143">常值分號 ( '; '您可以在字元前面加上反斜線來新增 ) 或等號 ( ' = ' ) 。</span><span class="sxs-lookup"><span data-stu-id="b3fa8-143">A literal semicolon (';') or equal sign ('=') can be added by prefixing the character with a backslash.</span></span> <span data-ttu-id="b3fa8-144">'\\'.</span><span class="sxs-lookup"><span data-stu-id="b3fa8-144">'\\'.</span></span> <span data-ttu-id="b3fa8-145">索引鍵的 null 值會以 null、前置分號、兩個連續分號或尾端分號表示，視 null 值為唯一、第一個、中間或最後一個索引鍵資料行值而定。</span><span class="sxs-lookup"><span data-stu-id="b3fa8-145">A null value for a key is signified by a null, a leading semicolon, two consecutive semicolons, or a trailing semicolon, depending on whether the null value is a sole, first, middle, or final key column value.</span></span>

</dd> <dt>

<span data-ttu-id="b3fa8-146"><span id="Column"></span><span id="column"></span><span id="COLUMN"></span>列</span><span class="sxs-lookup"><span data-stu-id="b3fa8-146"><span id="Column"></span><span id="column"></span><span id="COLUMN"></span>Column</span></span>
</dt> <dd>

<span data-ttu-id="b3fa8-147">此欄位會在 [資料列] 資料行中指定名為的資料列中的目標資料行。</span><span class="sxs-lookup"><span data-stu-id="b3fa8-147">This field specifies the target column in the row named in the Row column.</span></span> <span data-ttu-id="b3fa8-148">如果 ModuleSubstitution 資料表中的多個資料列變更相同目標資料列的不同資料行，則會在將修改的資料列插入資料庫之前，先執行所有資料行替換。</span><span class="sxs-lookup"><span data-stu-id="b3fa8-148">If multiple rows in the ModuleSubstitution table change different columns of the same target row, all the column substitutions are performed before the modified row is inserted into the database.</span></span> <span data-ttu-id="b3fa8-149">資料行替換順序未定義。</span><span class="sxs-lookup"><span data-stu-id="b3fa8-149">The order of column substitution is undefined.</span></span>

</dd> <dt>

<span data-ttu-id="b3fa8-150"><span id="Value"></span><span id="value"></span><span id="VALUE"></span>價值</span><span class="sxs-lookup"><span data-stu-id="b3fa8-150"><span id="Value"></span><span id="value"></span><span id="VALUE"></span>Value</span></span>
</dt> <dd>

<span data-ttu-id="b3fa8-151">此資料行包含字串，可針對要取代為數據表、資料列和資料行所指定之目標欄位的資料，提供格式化範本。</span><span class="sxs-lookup"><span data-stu-id="b3fa8-151">This column contains a string that provides a formatting template for the data being substituted into the target field specified by Table, Row, and Column.</span></span> <span data-ttu-id="b3fa8-152">當遇到 form = ItemA 的替代字串時 \[ \] ，會以可設定的 "ItemA" 的值取代字串（包括括弧字元）。</span><span class="sxs-lookup"><span data-stu-id="b3fa8-152">When a substitution string of the form \[=ItemA\] is encountered, the string, including the bracket characters, is replaced by the value for the configurable "ItemA."</span></span> <span data-ttu-id="b3fa8-153">可設定的專案 "ItemA" 是在 [ModuleConfiguration 資料表](moduleconfiguration-table.md) 的 Name 資料行中指定的，而它的值是由合併工具所提供。</span><span class="sxs-lookup"><span data-stu-id="b3fa8-153">The configurable item "ItemA" is specified in the Name column of the [ModuleConfiguration table](moduleconfiguration-table.md) and its value is provided by the merge tool.</span></span> <span data-ttu-id="b3fa8-154">如果合併工具拒絕在取代字串中提供任何專案的值，則會替代 ModuleConfiguration 資料表的 DefaultValue 資料行中指定的預設值。</span><span class="sxs-lookup"><span data-stu-id="b3fa8-154">If the merge tool declines to provide a value for any item in a replacement string, the default value specified in the DefaultValue column of the ModuleConfiguration Table is substituted.</span></span> <span data-ttu-id="b3fa8-155">如果字串參考不在 ModuleConfiguration 資料表中的專案，則合併會失敗。</span><span class="sxs-lookup"><span data-stu-id="b3fa8-155">If a string references an item not in the ModuleConfiguration table, the merge fails.</span></span>

-   <span data-ttu-id="b3fa8-156">此資料行使用 [CMSM 特殊格式](cmsm-special-format.md)。</span><span class="sxs-lookup"><span data-stu-id="b3fa8-156">This column uses [CMSM special format](cmsm-special-format.md).</span></span> <span data-ttu-id="b3fa8-157">常值分號 ( '; '您可以在字元前面加上反斜線，以將 ) 或等號 ( ' = ) ' 新增至資料表。</span><span class="sxs-lookup"><span data-stu-id="b3fa8-157">A literal semicolon (';') or equals sign ('=') can be added to the table by prefixing the character with a backslash.</span></span> <span data-ttu-id="b3fa8-158">'\\'.</span><span class="sxs-lookup"><span data-stu-id="b3fa8-158">'\\'.</span></span>
-   <span data-ttu-id="b3fa8-159">值欄位可能包含多個替代字串。</span><span class="sxs-lookup"><span data-stu-id="b3fa8-159">The Value field may contain multiple substitution strings.</span></span> <span data-ttu-id="b3fa8-160">例如，"Food1" 和 "Food2" 字串在字串中的設定： " \[ = Food1 \] 是不錯的，但 \[ = Food2 較 \] 好，因為 \[ = Food2 \] 更營養。」</span><span class="sxs-lookup"><span data-stu-id="b3fa8-160">For example, the configuration of items "Food1" and "Food2" in the string: "\[=Food1\] is good, but \[=Food2\] is better because \[=Food2\] is more nutritious."</span></span>
-   <span data-ttu-id="b3fa8-161">取代字串不得進行嵌套。</span><span class="sxs-lookup"><span data-stu-id="b3fa8-161">Replacement strings must not be nested.</span></span> <span data-ttu-id="b3fa8-162">範本 " \[ = AB \[ = CDE \] \] " 無效。</span><span class="sxs-lookup"><span data-stu-id="b3fa8-162">The template "\[=AB\[=CDE\]\]" is invalid.</span></span>
-   <span data-ttu-id="b3fa8-163">如果 [值] 欄位評估為 null，而且目標欄位不可為 null，則合併會失敗，並會建立 msmErrorBadNullSubstitution 類型的錯誤物件，並將其加入至錯誤清單。</span><span class="sxs-lookup"><span data-stu-id="b3fa8-163">If the Value field evaluates to null, and the target field is not nullable, the merge fails and an error object of type msmErrorBadNullSubstitution is created and added to the error list.</span></span> <span data-ttu-id="b3fa8-164">如需詳細資訊，請參閱 [**get \_ Type 函數**](/windows/win32/api/mergemod/nf-mergemod-imsmerror-get_type)中所述的錯誤類型。</span><span class="sxs-lookup"><span data-stu-id="b3fa8-164">For details, see the error types described in [**get\_Type Function**](/windows/win32/api/mergemod/nf-mergemod-imsmerror-get_type).</span></span>
-   <span data-ttu-id="b3fa8-165">如果 [值] 欄位評估為 null GUID： {00000000-0000-0000-0000-000000000000} ，則在將資料列合併至模組之前，會以功能的名稱取代 Null guid。</span><span class="sxs-lookup"><span data-stu-id="b3fa8-165">If the Value field evaluates to the null GUID: {00000000-0000-0000-0000-000000000000}, the null GUID is replaced by the name of the feature before the row is merged into the module.</span></span> <span data-ttu-id="b3fa8-166">如需詳細資訊，請參閱 [合併模組中的參考功能](referencing-features-in-merge-modules.md)。</span><span class="sxs-lookup"><span data-stu-id="b3fa8-166">For details, see [Referencing Features in Merge Modules](referencing-features-in-merge-modules.md).</span></span>
-   <span data-ttu-id="b3fa8-167">值欄位中的範本會在插入目標欄位之前進行評估。</span><span class="sxs-lookup"><span data-stu-id="b3fa8-167">The template in the Value field is evaluated before being inserted into the target field.</span></span> <span data-ttu-id="b3fa8-168">取代任何功能之前，請先完成資料列的替代。</span><span class="sxs-lookup"><span data-stu-id="b3fa8-168">Substitution into a row is done before replacing any features.</span></span>
-   <span data-ttu-id="b3fa8-169">如果 [值] 資料行評估為唯一的整數位符字串 (有選擇性的 + 或-) ，則會將字串轉換成整數格式，然後再將其取代為 [整數格式類型](integer-format-types.md)的目標欄位。</span><span class="sxs-lookup"><span data-stu-id="b3fa8-169">If the Value column evaluates to a string of only integer characters (with an optional + or -), the string is converted into an integer before being substituted into an target field of the [Integer Format Type](integer-format-types.md).</span></span> <span data-ttu-id="b3fa8-170">如果範本評估為不只包含整數個字元的字串 (以及選擇性的 + 或-) 則結果無法替代為整數目標欄位。</span><span class="sxs-lookup"><span data-stu-id="b3fa8-170">If the template evaluates to a string that does not consist only of integer characters (and an optional + or -) the result cannot be substituted into an integer target field.</span></span> <span data-ttu-id="b3fa8-171">嘗試在整數位段中插入非整數會導致合併失敗，並將 msmErrorBadSubstitutionType 錯誤物件加入至錯誤清單。</span><span class="sxs-lookup"><span data-stu-id="b3fa8-171">Attempting to insert a non-integer into an integer field causes the merge to fail and adds a msmErrorBadSubstitutionType error object to the error list.</span></span>
-   <span data-ttu-id="b3fa8-172">如果 [資料表] 和 [資料行] 欄位中指定的目標資料行是 [文字格式類型](text-format-types.md)，而 [值] 欄位的評估結果為 [整數格式類型](integer-format-types.md)，則會在目標文字欄位中插入數位的十進位標記法。</span><span class="sxs-lookup"><span data-stu-id="b3fa8-172">If the target column specified in the Table and Column fields is a [Text Format Type](text-format-types.md), and evaluation of the Value field results in an [Integer Format Type](integer-format-types.md), a decimal representation of the number is inserted into the target text field.</span></span>
-   <span data-ttu-id="b3fa8-173">如果目標欄位是 [整數格式類型](integer-format-types.md)，[值] 欄位包含以位 [格式](bitfield-format-types.md)表示的非分隔專案清單、[目標] 欄位中的值會結合使用位 **and** 運算子與專案中所有遮罩值的反位 **or** ，然後使用位 **or** 運算子搭配其對應的遮罩值進行遮罩處理時，結合每個整數或位專案。</span><span class="sxs-lookup"><span data-stu-id="b3fa8-173">If the target field is an [Integer Format Type](integer-format-types.md), and the Value field consists of a non-delimited list of items in [Bitfield Format](bitfield-format-types.md), the value in the target field is combined using the bitwise **AND** operator with the inverse of the bitwise **OR** of all of the mask values from the items, then combined using the bitwise **OR** operator with each of the integer or bitfield items when masked by their corresponding mask values.</span></span> <span data-ttu-id="b3fa8-174">基本上，這會將屬性中的位明確設定為提供的值，但會保留儲存格中的所有其他位。</span><span class="sxs-lookup"><span data-stu-id="b3fa8-174">Essentially, this explicitly sets the bits from the properties to the provided values but leaves all other bits in the cell alone.</span></span>
-   <span data-ttu-id="b3fa8-175">如果 [值] 欄位評估為索引 [鍵格式類型](key-format-types.md)，而且在使用多個主鍵的資料表中是索引鍵，則專案名稱後面可能會接著分號和整數值，指出以1為基礎的索引，並將組成主鍵的一組值一起組成。</span><span class="sxs-lookup"><span data-stu-id="b3fa8-175">If the Value field evaluates to a [Key Format Type](key-format-types.md), and is a key into a table that uses multiple primary keys, the item name may be followed by a semicolon and an integer value that indicates the 1-based index into the set of values that together make a primary key.</span></span> <span data-ttu-id="b3fa8-176">如果未指定整數，則會使用值1。</span><span class="sxs-lookup"><span data-stu-id="b3fa8-176">If no integer is specified, the value 1 is used.</span></span> <span data-ttu-id="b3fa8-177">例如， [控制資料表](control-table.md) 有兩個主鍵資料行： Dialog \_ 和 Control。</span><span class="sxs-lookup"><span data-stu-id="b3fa8-177">For example, the [Control table](control-table.md) has two primary key columns, Dialog\_ and Control.</span></span> <span data-ttu-id="b3fa8-178">專案 "Item1" 的值是控制資料表中的索引鍵，其格式為 "DialogName;Controlnameinrow "，其中 DialogName 是對話方塊資料表中的值， \_ 而 controlnameinrow 是控制項資料行中的值。</span><span class="sxs-lookup"><span data-stu-id="b3fa8-178">The value of an item "Item1" that is a key into the Control table will be of the form "DialogName;ControlName", where DialogName is the value in the Dialog\_ table and ControlName is the value in the Control column.</span></span> <span data-ttu-id="b3fa8-179">若要以單純的 Controlnameinrow 替代， \[ 應使用替代字串 = Item1; 2 \] 。</span><span class="sxs-lookup"><span data-stu-id="b3fa8-179">To substitute just ControlName, the substitution string \[=Item1;2\] should be used.</span></span>

</dd> </dl>

## <a name="remarks"></a><span data-ttu-id="b3fa8-180">備註</span><span class="sxs-lookup"><span data-stu-id="b3fa8-180">Remarks</span></span>

<span data-ttu-id="b3fa8-181">ModuleSubstition 資料表是由可設定的 [合併模組](configurable-merge-modules.md)所使用。</span><span class="sxs-lookup"><span data-stu-id="b3fa8-181">The ModuleSubstition table is used by [Configurable Merge Modules](configurable-merge-modules.md).</span></span> <span data-ttu-id="b3fa8-182">需要 Mergemod.dll 版本2.0 或更新版本，才能建立可設定的合併模組。</span><span class="sxs-lookup"><span data-stu-id="b3fa8-182">Mergemod.dll version 2.0 or later is required to create a configurable merge module.</span></span>

<span data-ttu-id="b3fa8-183">為了確保相容于2.0 版之前的 Mergemod.dll 版本， [ModuleConfiguration 資料表](moduleconfiguration-table.md) 和 ModuleSubstitution 資料表應該包含在每個模組的 [ModuleIgnoreTable 資料表](moduleignoretable-table.md) 中。</span><span class="sxs-lookup"><span data-stu-id="b3fa8-183">To ensure compatibility with versions of Mergemod.dll earlier than version 2.0, the [ModuleConfiguration table](moduleconfiguration-table.md) and ModuleSubstitution tables should be included in the [ModuleIgnoreTable table](moduleignoretable-table.md) of every module.</span></span>

 

 
