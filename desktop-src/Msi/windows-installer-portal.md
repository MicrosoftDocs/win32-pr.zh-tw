---
description: 用來安裝應用程式或更新或在 Windows 上執行之服務的安裝程式引擎。 設定及修復已安裝的應用程式。 撰寫自訂的 msi 套件，以建立應用程式的 exe 安裝程式或更新或升級。
ms.assetid: c90b8cbe-d7a1-44ad-ae65-80115bd55e4f
title: Windows Installer
ms.topic: article
ms.date: 05/19/2020
ms.openlocfilehash: d818a3decc7cbede527929dc3756ba2edf193421
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/08/2021
ms.locfileid: "106997154"
---
# <a name="windows-installer"></a><span data-ttu-id="6a656-105">Windows Installer</span><span class="sxs-lookup"><span data-stu-id="6a656-105">Windows Installer</span></span>

> [!NOTE]
> <span data-ttu-id="6a656-106">本檔適用于想要使用 Windows Installer 為應用程式建立安裝程式套件的軟體發展人員。</span><span class="sxs-lookup"><span data-stu-id="6a656-106">This documentation is intended for software developers who want to use Windows Installer to build installer packages for applications.</span></span> <span data-ttu-id="6a656-107">如果您要尋找 Windows Installer 4.5 及更早版本的可轉散發套件，請參閱 [這篇文章](windows-installer-redistributables.md)。</span><span class="sxs-lookup"><span data-stu-id="6a656-107">If you're looking for a redistributable for Windows Installer 4.5 and earlier, see [this article](windows-installer-redistributables.md).</span></span> <span data-ttu-id="6a656-108">請注意，Windows Installer 5.0 沒有可轉散發套件。</span><span class="sxs-lookup"><span data-stu-id="6a656-108">Note that there is no redistributable for Windows Installer 5.0.</span></span> <span data-ttu-id="6a656-109">此版本隨附于 Windows 7、Windows Server 2008 R2 和更新版本的用戶端和伺服器版本中的作業系統， (包括 Windows 10) 。</span><span class="sxs-lookup"><span data-stu-id="6a656-109">This version is included with the OS in Windows 7, Windows Server 2008 R2, and later client and server releases (including Windows 10).</span></span>

<span data-ttu-id="6a656-110">Microsoft Windows Installer 是 Windows 所提供的安裝和設定服務。</span><span class="sxs-lookup"><span data-stu-id="6a656-110">Microsoft Windows Installer is an installation and configuration service provided with Windows.</span></span> <span data-ttu-id="6a656-111">安裝程式服務可讓客戶提供更佳的公司部署，並提供元件管理的標準格式。</span><span class="sxs-lookup"><span data-stu-id="6a656-111">The installer service enables customers to provide better corporate deployment and provides a standard format for component management.</span></span> <span data-ttu-id="6a656-112">安裝程式也會根據作業系統來啟用應用程式和功能的公告。</span><span class="sxs-lookup"><span data-stu-id="6a656-112">The installer also enables the advertisement of applications and features according to the operating system.</span></span> <span data-ttu-id="6a656-113">如需詳細資訊，請參閱 [廣告的平臺支援](platform-support-of-advertisement.md)。</span><span class="sxs-lookup"><span data-stu-id="6a656-113">For more information, see [Platform Support of Advertisement](platform-support-of-advertisement.md).</span></span>

<span data-ttu-id="6a656-114">本檔說明 Windows Installer 5.0 及更早版本。</span><span class="sxs-lookup"><span data-stu-id="6a656-114">This documentation describes Windows Installer 5.0 and earlier versions.</span></span> <span data-ttu-id="6a656-115">在較舊的版本中，並非所有 Windows Installer 版本提供的功能都可供使用。</span><span class="sxs-lookup"><span data-stu-id="6a656-115">Not all the capabilities available in later Windows Installer versions are available in earlier versions.</span></span> <span data-ttu-id="6a656-116">本檔不會描述 Windows Installer 2.0 之前的版本。</span><span class="sxs-lookup"><span data-stu-id="6a656-116">This documentation does not describe versions earlier than Windows Installer 2.0.</span></span> <span data-ttu-id="6a656-117">使用 Windows Installer 3.0 和更新版本，仍然可以安裝為 Windows Installer 2.0 建立的安裝套件和修補程式。</span><span class="sxs-lookup"><span data-stu-id="6a656-117">Installation packages and patches that are created for Windows Installer 2.0 can still be installed by using Windows Installer 3.0 and later.</span></span>

<span data-ttu-id="6a656-118">Windows Installer 3.0 和更新版本，可以使用單一交易來安裝多個修補程式，以整合安裝進度、復原和重新開機。</span><span class="sxs-lookup"><span data-stu-id="6a656-118">Windows Installer 3.0 and later, can install multiple patches with a single transaction that integrates installation progress, rollback, and reboots.</span></span> <span data-ttu-id="6a656-119">安裝程式可以依照指定的順序套用修補程式，而不考慮將修補程式提供給系統的順序。</span><span class="sxs-lookup"><span data-stu-id="6a656-119">The installer can apply patches in a specified order regardless of the order that the patches are provided to the system.</span></span> <span data-ttu-id="6a656-120">使用 Windows Installer 3.0 進行修補時，只會更新受修補程式影響的檔案，而且比舊版安裝程式更快。</span><span class="sxs-lookup"><span data-stu-id="6a656-120">Patching using Windows Installer 3.0 only updates files affected by the patch and can be significantly faster than earlier installer versions.</span></span> <span data-ttu-id="6a656-121">您可以依任何順序卸載隨 Windows Installer 3.0 或更新版本安裝的修補程式，讓產品的狀態保持不變，就像從未安裝過修補程式一樣。</span><span class="sxs-lookup"><span data-stu-id="6a656-121">Patches installed with Windows Installer 3.0 or later can be uninstalled in any order to leave the state of the product the same as if the patch was never installed.</span></span> <span data-ttu-id="6a656-122">具有系統管理員許可權的帳戶可以使用 Windows Installer 3.0 和更新版本的 API 來查詢和清查產品、功能、元件和修補程式資訊。</span><span class="sxs-lookup"><span data-stu-id="6a656-122">Accounts with administrator privileges can use the API of Windows Installer 3.0 and later to query and inventory product, feature, component, and patch information.</span></span> <span data-ttu-id="6a656-123">安裝程式可以用來讀取、編輯和取代網路、URL 和媒體來源的來源清單。</span><span class="sxs-lookup"><span data-stu-id="6a656-123">The installer can be used to read, edit, and replace source lists for network, URL, and media sources.</span></span> <span data-ttu-id="6a656-124">系統管理員可以在使用者和安裝內容之間進行列舉，以及管理來自外部進程的來源清單。</span><span class="sxs-lookup"><span data-stu-id="6a656-124">Administrators can enumerate across user and install contexts, and manage source lists from an external process.</span></span>

<span data-ttu-id="6a656-125">Windows Installer 4.5 和更新版本可以使用 [*交易處理*](t-gly.md)來安裝多個安裝套件。</span><span class="sxs-lookup"><span data-stu-id="6a656-125">Windows Installer 4.5 and later can install multiple installation packages using [*transaction processing*](t-gly.md).</span></span> <span data-ttu-id="6a656-126">如果無法順利安裝交易中的所有封裝，或如果使用者取消安裝，Windows Installer 可以復原變更，並將電腦還原為其原始狀態。</span><span class="sxs-lookup"><span data-stu-id="6a656-126">If all the packages in the transaction cannot be installed successfully, or if the user cancels the installation, the Windows Installer can roll back changes and restore the computer to its original state.</span></span> <span data-ttu-id="6a656-127">安裝程式可確保已安裝屬於多封裝交易的所有套件，或未安裝任何套件。</span><span class="sxs-lookup"><span data-stu-id="6a656-127">The installer ensures that all the packages belonging to a multiple-package transaction are installed or none of the packages are installed.</span></span>

<span data-ttu-id="6a656-128">從 Windows Installer 5.0 開始，可以撰寫套件來保護新的帳戶、Windows [服務](../services/services.md)、檔案、資料夾和登錄機碼。</span><span class="sxs-lookup"><span data-stu-id="6a656-128">Beginning with Windows Installer 5.0, a package can be authored to secure new accounts, Windows [Services](../services/services.md), files, folders, and registry keys.</span></span> <span data-ttu-id="6a656-129">封裝可以指定拒絕許可權的安全描述項、指定父資源的許可權繼承，或指定新帳戶的許可權。</span><span class="sxs-lookup"><span data-stu-id="6a656-129">The package can specify a security descriptor that denies permissions, specifies inheritance of permissions from a parent resource, or specifies the permissions of a new account.</span></span> <span data-ttu-id="6a656-130">如需詳細資訊，請參閱 [保護資源](securing-resources-.md)。</span><span class="sxs-lookup"><span data-stu-id="6a656-130">For information, see [Securing Resources](securing-resources-.md).</span></span> <span data-ttu-id="6a656-131">Windows Installer 5.0 服務可以列舉電腦上所安裝的所有元件，並取得元件的金鑰路徑。</span><span class="sxs-lookup"><span data-stu-id="6a656-131">The Windows Installer 5.0 service can enumerate all components installed on the computer and obtain the key path for the component.</span></span> <span data-ttu-id="6a656-132">如需詳細資訊，請參閱 [列舉元件](enumerating-components-.md)。</span><span class="sxs-lookup"><span data-stu-id="6a656-132">For more information, see [Enumerating Components](enumerating-components-.md).</span></span> <span data-ttu-id="6a656-133">藉由 [使用服務](using-services-configuration.md)設定，Windows Installer 5.0 套件可以自訂電腦上的服務。</span><span class="sxs-lookup"><span data-stu-id="6a656-133">By [Using Services Configuration](using-services-configuration.md), Windows Installer 5.0 packages can customize the services on a computer.</span></span> <span data-ttu-id="6a656-134">安裝程式開發人員可以使用 Windows Installer 5.0 和 [單一套件撰寫](single-package-authoring.md) ，以開發可在每部電腦或每個使用者 [安裝內容](installation-context.md)中安裝應用程式的單一安裝套件。</span><span class="sxs-lookup"><span data-stu-id="6a656-134">Setup developers can use Windows Installer 5.0 and [Single Package Authoring](single-package-authoring.md) to develop single installation packages capable of installing an application in either the per-machine or per-user [installation context](installation-context.md).</span></span>

## <a name="where-applicable"></a><span data-ttu-id="6a656-135">適用時</span><span class="sxs-lookup"><span data-stu-id="6a656-135">Where applicable</span></span>

<span data-ttu-id="6a656-136">Windows Installer 可有效地安裝和設定 Windows 上執行的產品和應用程式。</span><span class="sxs-lookup"><span data-stu-id="6a656-136">Windows Installer enables the efficient installation and configuration of your products and applications running on Windows.</span></span> <span data-ttu-id="6a656-137">安裝程式會提供新功能，以在不安裝的情況下通告功能、隨選安裝產品，以及新增使用者自訂。</span><span class="sxs-lookup"><span data-stu-id="6a656-137">The installer provides new capabilities to advertise features without installing them, to install products on demand, and to add user customizations.</span></span>

<span data-ttu-id="6a656-138">在 Windows Server 2012 或 Windows 8 上執行的 Windows Installer 5.0 支援在 Windows RT 上安裝已核准的應用程式。</span><span class="sxs-lookup"><span data-stu-id="6a656-138">Windows Installer 5.0 running on Windows Server 2012 or Windows 8 supports the installation of approved apps on Windows RT.</span></span> <span data-ttu-id="6a656-139">未由 Microsoft 簽署的 Windows Installer 套件、修補程式或轉換，無法安裝在 Windows RT 上。</span><span class="sxs-lookup"><span data-stu-id="6a656-139">A Windows Installer package, patch, or transform that has not been signed by Microsoft cannot be installed on Windows RT.</span></span> <span data-ttu-id="6a656-140">[ [**範本摘要**](template-summary.md) ] 屬性會指出與安裝資料庫相容的平臺，而在此情況下，應該包含 Windows RT 的值。</span><span class="sxs-lookup"><span data-stu-id="6a656-140">The [**Template Summary**](template-summary.md) property indicates the platform that is compatible with an installation database and in this case should include the value for Windows RT.</span></span>

<span data-ttu-id="6a656-141">Windows Installer 適用于桌面樣式應用程式的開發。</span><span class="sxs-lookup"><span data-stu-id="6a656-141">Windows Installer is intended for the development of desktop style applications.</span></span>

## <a name="developer-audience"></a><span data-ttu-id="6a656-142">開發人員對象</span><span class="sxs-lookup"><span data-stu-id="6a656-142">Developer audience</span></span>

<span data-ttu-id="6a656-143">本檔適用于想要讓應用程式使用 Windows Installer 的軟體發展人員。</span><span class="sxs-lookup"><span data-stu-id="6a656-143">This documentation is intended for software developers who want to make applications that use Windows Installer.</span></span> <span data-ttu-id="6a656-144">它提供有關安裝套件和安裝程式服務的一般背景資訊。</span><span class="sxs-lookup"><span data-stu-id="6a656-144">It provides general background information about installation packages and the installer service.</span></span> <span data-ttu-id="6a656-145">它包含應用程式開發介面的完整描述，以及安裝程式資料庫的元素。</span><span class="sxs-lookup"><span data-stu-id="6a656-145">It contains complete descriptions of the application programming interface and elements of the installer database.</span></span> <span data-ttu-id="6a656-146">本檔也包含想要使用資料表編輯器或封裝建立工具來建立或維護安裝之開發人員的補充資訊。</span><span class="sxs-lookup"><span data-stu-id="6a656-146">This documentation also contains supplemental information for developers who want to use a table editor or a package creation tool to make or maintain an installation.</span></span>

## <a name="run-time-requirements"></a><span data-ttu-id="6a656-147">執行階段需求求</span><span class="sxs-lookup"><span data-stu-id="6a656-147">Run-time requirements</span></span>

<span data-ttu-id="6a656-148">、Windows 7、Windows Server 2008 R2 及更新版本中包含 Windows Installer 5.0。</span><span class="sxs-lookup"><span data-stu-id="6a656-148">Windows Installer 5.0 is included with, Windows 7, Windows Server 2008 R2, and later releases.</span></span> <span data-ttu-id="6a656-149">Windows Installer 5.0 沒有可轉散發套件。</span><span class="sxs-lookup"><span data-stu-id="6a656-149">There is no redistributable for Windows Installer 5.0.</span></span>

<span data-ttu-id="6a656-150">早于 Windows Installer 5.0 的版本，已與 Windows Server 2008、Windows Vista、Windows Server 2003、Windows XP 及 Windows 2000 一起發行。</span><span class="sxs-lookup"><span data-stu-id="6a656-150">Versions earlier than Windows Installer 5.0 were released with Windows Server 2008, Windows Vista, Windows Server 2003, Windows XP, and Windows 2000.</span></span> <span data-ttu-id="6a656-151">[Windows Installer](windows-installer-redistributables.md) 可轉散發套件適用于 Windows Installer 4.5 和某些較舊版本。</span><span class="sxs-lookup"><span data-stu-id="6a656-151">[Windows Installer Redistributables](windows-installer-redistributables.md) are available for Windows Installer 4.5 and some earlier versions.</span></span>

* <span data-ttu-id="6a656-152">Windows Installer 4.5 需要 Windows Server 2008、Windows Vista、Windows XP （含 Service Pack 2） (SP2) 和更新版本，以及 Windows Server 2003 （含 Service Pack 1） (SP1) 和更新版本。</span><span class="sxs-lookup"><span data-stu-id="6a656-152">Windows Installer 4.5 requires Windows Server 2008, Windows Vista, Windows XP with Service Pack 2 (SP2) and later, and Windows Server 2003 with Service Pack 1 (SP1) and later.</span></span>

* <span data-ttu-id="6a656-153">Windows Installer 4.0 需要 Windows Vista 或 Windows Server 2008。</span><span class="sxs-lookup"><span data-stu-id="6a656-153">Windows Installer 4.0 requires Windows Vista or Windows Server 2008.</span></span> <span data-ttu-id="6a656-154">在其他作業系統上安裝 Windows Installer 4.0 沒有可轉散發套件。</span><span class="sxs-lookup"><span data-stu-id="6a656-154">There is no redistributable for installing Windows Installer 4.0 on other operating systems.</span></span> <span data-ttu-id="6a656-155">Windows Vista Service Pack 1 (SP1) 和 Windows Server 2008 提供 Windows Installer 4.0 的更新版本，不會新增任何新功能。</span><span class="sxs-lookup"><span data-stu-id="6a656-155">An updated version of Windows Installer 4.0, which does not add any new features, is available in Windows Vista with Service Pack 1 (SP1) and Windows Server 2008.</span></span>

* <span data-ttu-id="6a656-156">Windows Installer 3.1 需要 Windows Server 2003、Windows XP 或 Windows 2000 Service Pack 3 (SP3) 。</span><span class="sxs-lookup"><span data-stu-id="6a656-156">Windows Installer 3.1 requires Windows Server 2003, Windows XP, or Windows 2000 with Service Pack 3 (SP3).</span></span>

* <span data-ttu-id="6a656-157">Windows Installer 3.0 需要 Windows Server 2003、Windows XP 或 Windows 2000 SP3。</span><span class="sxs-lookup"><span data-stu-id="6a656-157">Windows Installer 3.0 requires Windows Server 2003, Windows XP, or Windows 2000 with SP3.</span></span> <span data-ttu-id="6a656-158">Windows Installer 3.0 隨附于 Windows XP Service Pack 2 (SP2) 。</span><span class="sxs-lookup"><span data-stu-id="6a656-158">Windows Installer 3.0 is included in Windows XP with Service Pack 2 (SP2).</span></span> <span data-ttu-id="6a656-159">它是以 Windows 2000 Server Service Pack 3 (SP3) 和 Windows 2000 Server Service Pack 4 (SP4) 、Windows XP RTM 和 Windows XP （含 Service Pack 1） (SP1) 和 Windows Server 2003 RTM 的可轉散發套件。</span><span class="sxs-lookup"><span data-stu-id="6a656-159">It is available as a redistributable for Windows 2000 Server with Service Pack 3 (SP3) and Windows 2000 Server with Service Pack 4 (SP4), Windows XP RTM and Windows XP with Service Pack 1 (SP1), and Windows Server 2003 RTM.</span></span>

* <span data-ttu-id="6a656-160">Windows Installer 2.0 包含在 Windows Server 2003 和 Windows XP 中。</span><span class="sxs-lookup"><span data-stu-id="6a656-160">Windows Installer 2.0 is contained in Windows Server 2003 and Windows XP.</span></span>

* <span data-ttu-id="6a656-161">Windows Installer 2.0 是以封裝的形式提供，可用於安裝或升級至 Windows 2000 上的 Windows Installer 2.0。</span><span class="sxs-lookup"><span data-stu-id="6a656-161">Windows Installer 2.0 is available as a package for installing or upgrading to Windows Installer 2.0 on Windows 2000.</span></span> <span data-ttu-id="6a656-162">此套件不應用來在 Windows Server 2003 和 Windows XP 上安裝或升級 Windows Installer 2.0。</span><span class="sxs-lookup"><span data-stu-id="6a656-162">This package should not be used to install or upgrade Windows Installer 2.0 on Windows Server 2003 and Windows XP.</span></span>

## <a name="in-this-section"></a><span data-ttu-id="6a656-163">本節內容</span><span class="sxs-lookup"><span data-stu-id="6a656-163">In this section</span></span>



| <span data-ttu-id="6a656-164">主題</span><span class="sxs-lookup"><span data-stu-id="6a656-164">Topic</span></span>                                                                                       | <span data-ttu-id="6a656-165">描述</span><span class="sxs-lookup"><span data-stu-id="6a656-165">Description</span></span>                                                  |
|---------------------------------------------------------------------------------------------|--------------------------------------------------------------|
| [<span data-ttu-id="6a656-166">藍圖</span><span class="sxs-lookup"><span data-stu-id="6a656-166">Roadmap</span></span>](roadmap-to-windows-installer-documentation.md)<br/>                        | <span data-ttu-id="6a656-167">Windows Installer 檔的指南。</span><span class="sxs-lookup"><span data-stu-id="6a656-167">A guide to Windows Installer documentation.</span></span><br/>       |
| [<span data-ttu-id="6a656-168">概觀</span><span class="sxs-lookup"><span data-stu-id="6a656-168">Overview</span></span>](about-windows-installer.md)<br/>                                          | <span data-ttu-id="6a656-169">有關安裝程式的一般資訊。</span><span class="sxs-lookup"><span data-stu-id="6a656-169">General information about the installer.</span></span><br/>          |
| [<span data-ttu-id="6a656-170">Windows Installer 的新功能</span><span class="sxs-lookup"><span data-stu-id="6a656-170">What's New in Windows Installer</span></span>](what-s-new-in-windows-installer.md)<br/>           | <span data-ttu-id="6a656-171">列出 Windows Installer 的新增和變更。</span><span class="sxs-lookup"><span data-stu-id="6a656-171">Lists additions and changes to Windows Installer.</span></span><br/> |
| [<span data-ttu-id="6a656-172">參考</span><span class="sxs-lookup"><span data-stu-id="6a656-172">Reference</span></span>](installer-function-reference.md)<br/>                                    | <span data-ttu-id="6a656-173">Windows Installer 功能的檔。</span><span class="sxs-lookup"><span data-stu-id="6a656-173">Documentation of Windows Installer functions.</span></span><br/>     |
| [<span data-ttu-id="6a656-174">Windows Installer 腳本範例</span><span class="sxs-lookup"><span data-stu-id="6a656-174">Windows Installer Scripting Examples</span></span>](windows-installer-scripting-examples.md)<br/> | <span data-ttu-id="6a656-175">使用腳本 Windows Installer 範例。</span><span class="sxs-lookup"><span data-stu-id="6a656-175">Windows Installer examples using script.</span></span><br/>          |



 

 

 
