---
description: View 物件的 Modify 方法會使用 Fetch 方法取得的修改記錄物件來修改資料庫資料列。
ms.assetid: c3c500aa-070f-41d7-90f7-db979452d24f
title: View. Modify 方法
ms.topic: reference
ms.date: 05/31/2018
topic_type:
- APIRef
- kbSyntax
api_name:
- View.Modify
api_type:
- COM
api_location:
- Msi.dll
ms.openlocfilehash: b4dc97f2e3b5f85d472cfcbfad6017ce4e051e4b
ms.sourcegitcommit: c8ec1ded1ffffc364d3c4f560bb2171da0dc5040
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 03/22/2021
ms.locfileid: "106999264"
---
# <a name="viewmodify-method"></a><span data-ttu-id="b8b7d-103">View. Modify 方法</span><span class="sxs-lookup"><span data-stu-id="b8b7d-103">View.Modify method</span></span>

<span data-ttu-id="b8b7d-104">[**View**](view-object.md)物件的 **Modify** 方法會使用 [**Fetch**](view-fetch.md)方法取得的修改 [**記錄**](record-object.md)物件來修改資料庫資料列。</span><span class="sxs-lookup"><span data-stu-id="b8b7d-104">The **Modify** method of the [**View**](view-object.md) object modifies a database row with a modified [**Record**](record-object.md) object obtained by the [**Fetch**](view-fetch.md) method.</span></span>

## <a name="syntax"></a><span data-ttu-id="b8b7d-105">語法</span><span class="sxs-lookup"><span data-stu-id="b8b7d-105">Syntax</span></span>


```JScript
View.Modify(
  action,
  record
)
```



## <a name="parameters"></a><span data-ttu-id="b8b7d-106">參數</span><span class="sxs-lookup"><span data-stu-id="b8b7d-106">Parameters</span></span>

<dl> <dt>

<span data-ttu-id="b8b7d-107">*action*</span><span class="sxs-lookup"><span data-stu-id="b8b7d-107">*action*</span></span> 
</dt> <dd>

<span data-ttu-id="b8b7d-108">需要在資料庫資料列上執行的動作。</span><span class="sxs-lookup"><span data-stu-id="b8b7d-108">Required action to be performed on the database row.</span></span> <span data-ttu-id="b8b7d-109">這是下表所示的動作之一。</span><span class="sxs-lookup"><span data-stu-id="b8b7d-109">This action is one of those shown in the following table.</span></span>



| <span data-ttu-id="b8b7d-110">動作名稱</span><span class="sxs-lookup"><span data-stu-id="b8b7d-110">Action name</span></span>                                                                                                                                                                                                                                                                                                     | <span data-ttu-id="b8b7d-111">意義</span><span class="sxs-lookup"><span data-stu-id="b8b7d-111">Meaning</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span id="msiViewModifySeek"></span><span id="msiviewmodifyseek"></span><span id="MSIVIEWMODIFYSEEK"></span><dl> <span data-ttu-id="b8b7d-112"><dt>**msiViewModifySeek**</dt> <dt>– 1</dt></span><span class="sxs-lookup"><span data-stu-id="b8b7d-112"><dt>**msiViewModifySeek**</dt> <dt>–1</dt></span></span> </dl>                                            | <span data-ttu-id="b8b7d-113">重新整理提供記錄中的資訊，而不變更結果集中的位置，而不會影響後續的提取作業。</span><span class="sxs-lookup"><span data-stu-id="b8b7d-113">Refreshes the information in the supplied record without changing the position in the result set and without affecting subsequent fetch operations.</span></span> <span data-ttu-id="b8b7d-114">然後，記錄可以用於後續的更新、刪除和重新整理。</span><span class="sxs-lookup"><span data-stu-id="b8b7d-114">The record may then be used for subsequent Update, Delete, and Refresh.</span></span> <span data-ttu-id="b8b7d-115">資料表的所有主鍵資料行都必須在查詢中，而且記錄至少必須有與查詢相同的欄位數目。Seek 無法與 multitable 查詢搭配使用。</span><span class="sxs-lookup"><span data-stu-id="b8b7d-115">All primary key columns of the table must be in the query and the record must have at least as many fields as the query.Seek cannot be used with multitable queries.</span></span> <span data-ttu-id="b8b7d-116">請參閱備註。</span><span class="sxs-lookup"><span data-stu-id="b8b7d-116">See the remarks.</span></span> <span data-ttu-id="b8b7d-117">此模式無法與包含聯結的視圖一起使用。</span><span class="sxs-lookup"><span data-stu-id="b8b7d-117">This mode cannot be used with a view containing joins.</span></span><br/>                                                                             |
| <span id="msiViewModifyRefresh"></span><span id="msiviewmodifyrefresh"></span><span id="MSIVIEWMODIFYREFRESH"></span><dl> <span data-ttu-id="b8b7d-118"><dt>**msiViewModifyRefresh**</dt> <dt>0</dt></span><span class="sxs-lookup"><span data-stu-id="b8b7d-118"><dt>**msiViewModifyRefresh**</dt> <dt>0</dt></span></span> </dl>                                 | <span data-ttu-id="b8b7d-119">重新整理記錄中的資訊。</span><span class="sxs-lookup"><span data-stu-id="b8b7d-119">Refreshes the information in the record.</span></span> <span data-ttu-id="b8b7d-120">必須先呼叫具有相同記錄的 [**Fetch**](view-fetch.md) 方法。</span><span class="sxs-lookup"><span data-stu-id="b8b7d-120">Must first call the [**Fetch**](view-fetch.md) method with the same record.</span></span> <span data-ttu-id="b8b7d-121">刪除的資料列失敗。</span><span class="sxs-lookup"><span data-stu-id="b8b7d-121">Fails for a deleted row.</span></span> <span data-ttu-id="b8b7d-122">適用于讀寫和唯讀記錄。</span><span class="sxs-lookup"><span data-stu-id="b8b7d-122">Works with both read-write and read-only records.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                     |
| <span id="msiViewModifyInsert"></span><span id="msiviewmodifyinsert"></span><span id="MSIVIEWMODIFYINSERT"></span><dl> <span data-ttu-id="b8b7d-123"><dt>**msiViewModifyInsert**</dt> <dt>1</dt></span><span class="sxs-lookup"><span data-stu-id="b8b7d-123"><dt>**msiViewModifyInsert**</dt> <dt>1</dt></span></span> </dl>                                     | <span data-ttu-id="b8b7d-124">插入記錄。</span><span class="sxs-lookup"><span data-stu-id="b8b7d-124">Inserts a record.</span></span> <span data-ttu-id="b8b7d-125">如果存在具有相同主鍵的資料列，則會失敗。</span><span class="sxs-lookup"><span data-stu-id="b8b7d-125">Fails if a row with the same primary keys exists.</span></span> <span data-ttu-id="b8b7d-126">使用唯讀資料庫失敗。</span><span class="sxs-lookup"><span data-stu-id="b8b7d-126">Fails with a read-only database.</span></span> <span data-ttu-id="b8b7d-127">此模式無法與包含聯結的視圖一起使用。</span><span class="sxs-lookup"><span data-stu-id="b8b7d-127">This mode cannot be used with a view containing joins.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                          |
| <span id="msiViewModifyUpdate"></span><span id="msiviewmodifyupdate"></span><span id="MSIVIEWMODIFYUPDATE"></span><dl> <span data-ttu-id="b8b7d-128"><dt>**msiViewModifyUpdate**</dt> <dt>2</dt></span><span class="sxs-lookup"><span data-stu-id="b8b7d-128"><dt>**msiViewModifyUpdate**</dt> <dt>2</dt></span></span> </dl>                                     | <span data-ttu-id="b8b7d-129">更新現有的記錄。</span><span class="sxs-lookup"><span data-stu-id="b8b7d-129">Updates an existing record.</span></span> <span data-ttu-id="b8b7d-130">僅限非主要索引鍵。</span><span class="sxs-lookup"><span data-stu-id="b8b7d-130">Non-primary keys only.</span></span> <span data-ttu-id="b8b7d-131">必須先呼叫具有相同記錄的 [**Fetch**](view-fetch.md) 方法。</span><span class="sxs-lookup"><span data-stu-id="b8b7d-131">Must first call the [**Fetch**](view-fetch.md) method with the same record.</span></span> <span data-ttu-id="b8b7d-132">失敗並刪除記錄。</span><span class="sxs-lookup"><span data-stu-id="b8b7d-132">Fails with a deleted record.</span></span> <span data-ttu-id="b8b7d-133">只適用于讀寫記錄。</span><span class="sxs-lookup"><span data-stu-id="b8b7d-133">Works only with read-write records.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                     |
| <span id="msiViewModifyAssign"></span><span id="msiviewmodifyassign"></span><span id="MSIVIEWMODIFYASSIGN"></span><dl> <span data-ttu-id="b8b7d-134"><dt>**msiViewModifyAssign**</dt> <dt>3</dt></span><span class="sxs-lookup"><span data-stu-id="b8b7d-134"><dt>**msiViewModifyAssign**</dt> <dt>3</dt></span></span> </dl>                                     | <span data-ttu-id="b8b7d-135">將資料指標中的目前資料寫入至資料表資料列。</span><span class="sxs-lookup"><span data-stu-id="b8b7d-135">Writes current data in the cursor to a table row.</span></span> <span data-ttu-id="b8b7d-136">如果主鍵符合現有的資料列，則會更新記錄，如果它們不相符，則會插入。</span><span class="sxs-lookup"><span data-stu-id="b8b7d-136">Updates record if the primary keys match an existing row and inserts if they do not match.</span></span> <span data-ttu-id="b8b7d-137">使用唯讀資料庫失敗。</span><span class="sxs-lookup"><span data-stu-id="b8b7d-137">Fails with a read-only database.</span></span> <span data-ttu-id="b8b7d-138">此模式無法與包含聯結的視圖一起使用。</span><span class="sxs-lookup"><span data-stu-id="b8b7d-138">This mode cannot be used with a view containing joins.</span></span><br/>                                                                                                                                                                                                                                                                                                                 |
| <span id="msiViewModifyReplace"></span><span id="msiviewmodifyreplace"></span><span id="MSIVIEWMODIFYREPLACE"></span><dl> <span data-ttu-id="b8b7d-139"><dt>**msiViewModifyReplace**</dt> <dt>4</dt></span><span class="sxs-lookup"><span data-stu-id="b8b7d-139"><dt>**msiViewModifyReplace**</dt> <dt>4</dt></span></span> </dl>                                 | <span data-ttu-id="b8b7d-140">更新或刪除記錄，並將記錄插入資料表中。</span><span class="sxs-lookup"><span data-stu-id="b8b7d-140">Updates or deletes and inserts a record into a table.</span></span> <span data-ttu-id="b8b7d-141">必須先呼叫具有相同記錄的 [**Fetch**](view-fetch.md) 方法。</span><span class="sxs-lookup"><span data-stu-id="b8b7d-141">Must first call the [**Fetch**](view-fetch.md) method with the same record.</span></span> <span data-ttu-id="b8b7d-142">如果主鍵未變更，則會更新記錄。</span><span class="sxs-lookup"><span data-stu-id="b8b7d-142">Updates record if the primary keys are unchanged.</span></span> <span data-ttu-id="b8b7d-143">刪除舊資料列，並在主要索引鍵變更時插入新的。</span><span class="sxs-lookup"><span data-stu-id="b8b7d-143">Deletes old row and inserts new if primary keys have changed.</span></span> <span data-ttu-id="b8b7d-144">使用唯讀資料庫失敗。</span><span class="sxs-lookup"><span data-stu-id="b8b7d-144">Fails with a read-only database.</span></span> <span data-ttu-id="b8b7d-145">此模式無法與包含聯結的視圖一起使用。</span><span class="sxs-lookup"><span data-stu-id="b8b7d-145">This mode cannot be used with a view containing joins.</span></span><br/>                                                                                                                                                                                                           |
| <span id="msiViewModifyMerge"></span><span id="msiviewmodifymerge"></span><span id="MSIVIEWMODIFYMERGE"></span><dl> <span data-ttu-id="b8b7d-146"><dt>**msiViewModifyMerge**</dt> <dt>5</dt></span><span class="sxs-lookup"><span data-stu-id="b8b7d-146"><dt>**msiViewModifyMerge**</dt> <dt>5</dt></span></span> </dl>                                         | <span data-ttu-id="b8b7d-147">在資料表中插入或驗證記錄。</span><span class="sxs-lookup"><span data-stu-id="b8b7d-147">Inserts or validates a record in a table.</span></span> <span data-ttu-id="b8b7d-148">如果主鍵不符合任何資料列，則會插入，並驗證是否有相符的。</span><span class="sxs-lookup"><span data-stu-id="b8b7d-148">Inserts if primary keys do not match any row and validates if there is a match.</span></span> <span data-ttu-id="b8b7d-149">如果記錄與資料表中的資料不相符，則會失敗。</span><span class="sxs-lookup"><span data-stu-id="b8b7d-149">Fails if the record does not match the data in the table.</span></span> <span data-ttu-id="b8b7d-150">如果有重複索引鍵不相同的記錄，則會失敗。</span><span class="sxs-lookup"><span data-stu-id="b8b7d-150">Fails if there is a record with a duplicate key that is not identical.</span></span> <span data-ttu-id="b8b7d-151">只適用于讀寫記錄。</span><span class="sxs-lookup"><span data-stu-id="b8b7d-151">Works only with read-write records.</span></span> <span data-ttu-id="b8b7d-152">此模式無法與包含聯結的視圖一起使用。</span><span class="sxs-lookup"><span data-stu-id="b8b7d-152">This mode cannot be used with a view containing joins.</span></span><br/>                                                                                                                                                                                                |
| <span id="msiViewModifyDelete"></span><span id="msiviewmodifydelete"></span><span id="MSIVIEWMODIFYDELETE"></span><dl> <span data-ttu-id="b8b7d-153"><dt>**msiViewModifyDelete**</dt> <dt>6</dt></span><span class="sxs-lookup"><span data-stu-id="b8b7d-153"><dt>**msiViewModifyDelete**</dt> <dt>6</dt></span></span> </dl>                                     | <span data-ttu-id="b8b7d-154">從資料表中移除資料列。</span><span class="sxs-lookup"><span data-stu-id="b8b7d-154">Removes a row from the table.</span></span> <span data-ttu-id="b8b7d-155">必須先呼叫具有相同記錄的 [**Fetch**](view-fetch.md) 方法。</span><span class="sxs-lookup"><span data-stu-id="b8b7d-155">Must first call the [**Fetch**](view-fetch.md) method with the same record.</span></span> <span data-ttu-id="b8b7d-156">如果資料列已刪除，則會失敗。</span><span class="sxs-lookup"><span data-stu-id="b8b7d-156">Fails if the row has been deleted.</span></span> <span data-ttu-id="b8b7d-157">只適用于讀寫記錄。</span><span class="sxs-lookup"><span data-stu-id="b8b7d-157">Works only with read-write records.</span></span> <span data-ttu-id="b8b7d-158">此模式無法與包含聯結的視圖一起使用。</span><span class="sxs-lookup"><span data-stu-id="b8b7d-158">This mode cannot be used with a view containing joins.</span></span><br/>                                                                                                                                                                                                                                                                                                             |
| <span id="msiViewModifyInsertTemporary"></span><span id="msiviewmodifyinserttemporary"></span><span id="MSIVIEWMODIFYINSERTTEMPORARY"></span><dl> <span data-ttu-id="b8b7d-159"><dt>**msiViewModifyInsertTemporary**</dt> <dt>7</dt></span><span class="sxs-lookup"><span data-stu-id="b8b7d-159"><dt>**msiViewModifyInsertTemporary**</dt> <dt>7</dt></span></span> </dl> | <span data-ttu-id="b8b7d-160">插入暫存記錄。</span><span class="sxs-lookup"><span data-stu-id="b8b7d-160">Inserts a temporary record.</span></span> <span data-ttu-id="b8b7d-161">這項資訊不是持續性的。</span><span class="sxs-lookup"><span data-stu-id="b8b7d-161">The information is not persistent.</span></span> <span data-ttu-id="b8b7d-162">如果存在具有相同主鍵的資料列，則會失敗。</span><span class="sxs-lookup"><span data-stu-id="b8b7d-162">Fails if a row with the same primary key exists.</span></span> <span data-ttu-id="b8b7d-163">只適用于讀寫記錄。</span><span class="sxs-lookup"><span data-stu-id="b8b7d-163">Works only with read-write records.</span></span> <span data-ttu-id="b8b7d-164">此模式無法與包含聯結的視圖一起使用。</span><span class="sxs-lookup"><span data-stu-id="b8b7d-164">This mode cannot be used with a view containing joins.</span></span><br/>                                                                                                                                                                                                                                                                                                                                           |
| <span id="msiViewModifyValidate"></span><span id="msiviewmodifyvalidate"></span><span id="MSIVIEWMODIFYVALIDATE"></span><dl> <span data-ttu-id="b8b7d-165"><dt>**msiViewModifyValidate**</dt> <dt>8</dt></span><span class="sxs-lookup"><span data-stu-id="b8b7d-165"><dt>**msiViewModifyValidate**</dt> <dt>8</dt></span></span> </dl>                             | <span data-ttu-id="b8b7d-166">驗證記錄。</span><span class="sxs-lookup"><span data-stu-id="b8b7d-166">Validates a record.</span></span> <span data-ttu-id="b8b7d-167">不會跨聯結進行驗證。</span><span class="sxs-lookup"><span data-stu-id="b8b7d-167">Does not validate across joins.</span></span> <span data-ttu-id="b8b7d-168">必須先呼叫具有相同記錄的 [**Fetch**](view-fetch.md) 方法。</span><span class="sxs-lookup"><span data-stu-id="b8b7d-168">Must first call the [**Fetch**](view-fetch.md) method with the same record.</span></span> <span data-ttu-id="b8b7d-169">使用 [**GetError**](view-geterror.md) 方法取得驗證錯誤。</span><span class="sxs-lookup"><span data-stu-id="b8b7d-169">Obtain validation errors with [**GetError**](view-geterror.md) method.</span></span> <span data-ttu-id="b8b7d-170">適用于讀寫和唯讀記錄。</span><span class="sxs-lookup"><span data-stu-id="b8b7d-170">Works with read-write and read-only records.</span></span> <span data-ttu-id="b8b7d-171">此模式無法與包含聯結的視圖一起使用。</span><span class="sxs-lookup"><span data-stu-id="b8b7d-171">This mode cannot be used with a view containing joins.</span></span><br/>                                                                                                                                                                                                                                         |
| <span id="msiViewModifyValidateNew"></span><span id="msiviewmodifyvalidatenew"></span><span id="MSIVIEWMODIFYVALIDATENEW"></span><dl> <span data-ttu-id="b8b7d-172"><dt>**msiViewModifyValidateNew**</dt> <dt>9</dt></span><span class="sxs-lookup"><span data-stu-id="b8b7d-172"><dt>**msiViewModifyValidateNew**</dt> <dt>9</dt></span></span> </dl>                 | <span data-ttu-id="b8b7d-173">驗證新的記錄。</span><span class="sxs-lookup"><span data-stu-id="b8b7d-173">Validates a new record.</span></span> <span data-ttu-id="b8b7d-174">不會跨聯結進行驗證。</span><span class="sxs-lookup"><span data-stu-id="b8b7d-174">Does not validate across joins.</span></span> <span data-ttu-id="b8b7d-175">檢查是否有重複的索引鍵。</span><span class="sxs-lookup"><span data-stu-id="b8b7d-175">Checks for duplicate keys.</span></span> <span data-ttu-id="b8b7d-176">藉由呼叫 [**GetError**](view-geterror.md) 方法來取得驗證錯誤。</span><span class="sxs-lookup"><span data-stu-id="b8b7d-176">Obtains validation errors by calling [**GetError**](view-geterror.md) method.</span></span> <span data-ttu-id="b8b7d-177">需要使用修改值來呼叫 [**MsiDatabase。**](database-openview.md)</span><span class="sxs-lookup"><span data-stu-id="b8b7d-177">Requires calling [**MsiDatabase.OpenView**](database-openview.md) method with a modify value.</span></span> <span data-ttu-id="b8b7d-178">適用于讀寫和唯讀記錄。</span><span class="sxs-lookup"><span data-stu-id="b8b7d-178">Works with read-write and read-only records.</span></span> <span data-ttu-id="b8b7d-179">此模式無法與包含聯結的視圖一起使用。</span><span class="sxs-lookup"><span data-stu-id="b8b7d-179">This mode cannot be used with a view containing joins.</span></span><br/>                                                                                                                                                                                 |
| <span id="msiViewModifyValidateField"></span><span id="msiviewmodifyvalidatefield"></span><span id="MSIVIEWMODIFYVALIDATEFIELD"></span><dl> <span data-ttu-id="b8b7d-180"><dt>**msiViewModifyValidateField**</dt> <dt>10</dt></span><span class="sxs-lookup"><span data-stu-id="b8b7d-180"><dt>**msiViewModifyValidateField**</dt> <dt>10</dt></span></span> </dl>        | <span data-ttu-id="b8b7d-181">驗證提取或新記錄的欄位。</span><span class="sxs-lookup"><span data-stu-id="b8b7d-181">Validates fields of a fetched or new record.</span></span> <span data-ttu-id="b8b7d-182">可以驗證一或多個不完整記錄的欄位。</span><span class="sxs-lookup"><span data-stu-id="b8b7d-182">Can validate one or more fields of an incomplete record.</span></span> <span data-ttu-id="b8b7d-183">藉由呼叫 [**GetError**](view-geterror.md) 方法來取得驗證錯誤。</span><span class="sxs-lookup"><span data-stu-id="b8b7d-183">Obtains validation errors by calling [**GetError**](view-geterror.md) method.</span></span> <span data-ttu-id="b8b7d-184">適用于讀寫和唯讀記錄。</span><span class="sxs-lookup"><span data-stu-id="b8b7d-184">Works with read-write and read-only records.</span></span> <span data-ttu-id="b8b7d-185">此模式無法與包含聯結的視圖一起使用。</span><span class="sxs-lookup"><span data-stu-id="b8b7d-185">This mode cannot be used with a view containing joins.</span></span><br/>                                                                                                                                                                                                                                                             |
| <span id="msiViewModifyValidateDelete"></span><span id="msiviewmodifyvalidatedelete"></span><span id="MSIVIEWMODIFYVALIDATEDELETE"></span><dl> <span data-ttu-id="b8b7d-186"><dt>**msiViewModifyValidateDelete**</dt> <dt>11</dt></span><span class="sxs-lookup"><span data-stu-id="b8b7d-186"><dt>**msiViewModifyValidateDelete**</dt> <dt>11</dt></span></span> </dl>    | <span data-ttu-id="b8b7d-187">驗證稍後將刪除的記錄。</span><span class="sxs-lookup"><span data-stu-id="b8b7d-187">Validates a record that will be deleted later.</span></span> <span data-ttu-id="b8b7d-188">必須先呼叫具有相同記錄的 [**Fetch**](view-fetch.md) 方法。</span><span class="sxs-lookup"><span data-stu-id="b8b7d-188">Must first call the [**Fetch**](view-fetch.md) method with the same record.</span></span> <span data-ttu-id="b8b7d-189">如果另一個資料列參考此資料列的主鍵，則會失敗。</span><span class="sxs-lookup"><span data-stu-id="b8b7d-189">Fails if another row refers to the primary keys of this row.</span></span> <span data-ttu-id="b8b7d-190">驗證不會在屬性或字串中檢查此資料列的主鍵是否存在。</span><span class="sxs-lookup"><span data-stu-id="b8b7d-190">Validation does not check for the existence of the primary keys of this row in properties or strings.</span></span> <span data-ttu-id="b8b7d-191">不會檢查資料行是否為多個資料表的外鍵。</span><span class="sxs-lookup"><span data-stu-id="b8b7d-191">Does not check if a column is a foreign key to multiple tables.</span></span> <span data-ttu-id="b8b7d-192">藉由呼叫 [**GetError**](view-geterror.md) 方法來取得驗證錯誤。</span><span class="sxs-lookup"><span data-stu-id="b8b7d-192">Obtain validation errors by calling the [**GetError**](view-geterror.md) method.</span></span> <span data-ttu-id="b8b7d-193">適用于讀寫和唯讀記錄。</span><span class="sxs-lookup"><span data-stu-id="b8b7d-193">Works with read-write and read-only records.</span></span> <span data-ttu-id="b8b7d-194">此模式無法與包含聯結的視圖一起使用。</span><span class="sxs-lookup"><span data-stu-id="b8b7d-194">This mode cannot be used with a view containing joins.</span></span><br/> |



 

</dd> <dt>

<span data-ttu-id="b8b7d-195">*記錄*</span><span class="sxs-lookup"><span data-stu-id="b8b7d-195">*record*</span></span> 
</dt> <dd>

<span data-ttu-id="b8b7d-196">必要。</span><span class="sxs-lookup"><span data-stu-id="b8b7d-196">Required.</span></span> <span data-ttu-id="b8b7d-197">[**Fetch**](view-fetch.md)方法透過修改過的欄位資料所取得的 [**記錄**](record-object.md)物件。</span><span class="sxs-lookup"><span data-stu-id="b8b7d-197">[**Record**](record-object.md) object obtained by the [**Fetch**](view-fetch.md) method with modified field data.</span></span>

</dd> </dl>

## <a name="return-value"></a><span data-ttu-id="b8b7d-198">傳回值</span><span class="sxs-lookup"><span data-stu-id="b8b7d-198">Return value</span></span>

<span data-ttu-id="b8b7d-199">這個方法不會傳回值。</span><span class="sxs-lookup"><span data-stu-id="b8b7d-199">This method does not return a value.</span></span>

## <a name="remarks"></a><span data-ttu-id="b8b7d-200">備註</span><span class="sxs-lookup"><span data-stu-id="b8b7d-200">Remarks</span></span>

<span data-ttu-id="b8b7d-201">您必須在 [**Execute**](view-execute.md) 方法之後呼叫這個方法。</span><span class="sxs-lookup"><span data-stu-id="b8b7d-201">This method must be called after the [**Execute**](view-execute.md) method.</span></span>

<span data-ttu-id="b8b7d-202">若要執行任何 SQL 語句，您必須建立一個 view。</span><span class="sxs-lookup"><span data-stu-id="b8b7d-202">To execute any SQL statement, a view must be created.</span></span> <span data-ttu-id="b8b7d-203">但是，不會建立結果集的視圖（例如 CREATE TABLE 或 INSERT INTO）無法與 **Modify** 方法搭配使用，以透過視圖來更新資料表。</span><span class="sxs-lookup"><span data-stu-id="b8b7d-203">However, a view that does not create a result set, such as CREATE TABLE or INSERT INTO, cannot be used with the **Modify** method to update tables though the view.</span></span>

<span data-ttu-id="b8b7d-204">**Modify** 方法的 MsiViewModifyValidate、MsiViewModifyValidateNew、MsiViewModifyValidateField 和 msiViewModifyValidateDelete 值不會執行實際的更新;它們可確保記錄中的資料是有效的。</span><span class="sxs-lookup"><span data-stu-id="b8b7d-204">The msiViewModifyValidate, msiViewModifyValidateNew, msiViewModifyValidateField, and msiViewModifyValidateDelete values of the **Modify** method do not perform actual updates; they ensure that the data in the record is valid.</span></span> <span data-ttu-id="b8b7d-205">若要使用這些動作，資料庫必須包含[ \_ 驗證資料表](-validation-table.md)。</span><span class="sxs-lookup"><span data-stu-id="b8b7d-205">Use of these actions requires that the database contain a [\_Validation table](-validation-table.md) .</span></span>

<span data-ttu-id="b8b7d-206">您無法從某個資料庫提取包含二進位資料的記錄，然後使用該記錄，將資料插入至完全不同的資料庫。</span><span class="sxs-lookup"><span data-stu-id="b8b7d-206">You cannot fetch a record containing binary data from one database and then use that record to insert the data into a completely different database.</span></span> <span data-ttu-id="b8b7d-207">若要將二進位資料從某個資料庫移到另一個資料庫，您應該將資料匯出至檔案，然後使用 [**Record**](record-object.md)物件的 [**SetStream**](record-setstream.md)方法，將資料匯入至新的資料庫。</span><span class="sxs-lookup"><span data-stu-id="b8b7d-207">To move binary data from one database to another, you should export the data to a file and then import it into the new database using the [**SetStream**](record-setstream.md) method of the [**Record**](record-object.md) object.</span></span> <span data-ttu-id="b8b7d-208">這可確保每個資料庫都有自己的二進位資料複本。</span><span class="sxs-lookup"><span data-stu-id="b8b7d-208">This ensures that each database has its own copy of the binary data.</span></span>

> [!Note]  
> <span data-ttu-id="b8b7d-209">自訂動作只能加入、修改或移除資料庫中的暫存資料列、資料行或資料表。</span><span class="sxs-lookup"><span data-stu-id="b8b7d-209">Custom actions can only add, modify, or remove temporary rows, columns, or tables from a database.</span></span> <span data-ttu-id="b8b7d-210">自訂動作無法修改資料庫中的持續性資料，例如儲存在磁片上的資料庫中的資料。</span><span class="sxs-lookup"><span data-stu-id="b8b7d-210">Custom actions cannot modify persistent data in a database, such as data that is a part of the database stored on disk.</span></span> <span data-ttu-id="b8b7d-211">如需詳細資訊，請參閱 [從自訂動作內部存取目前的安裝程式會話](accessing-the-current-installer-session-from-inside-a-custom-action.md)。</span><span class="sxs-lookup"><span data-stu-id="b8b7d-211">For more information, see [Accessing the Current Installer Session from Inside a Custom Action](accessing-the-current-installer-session-from-inside-a-custom-action.md).</span></span>

 

<span data-ttu-id="b8b7d-212">如果方法失敗，您可以使用 [**LastErrorRecord**](installer-lasterrorrecord.md) 方法來取得擴充的錯誤資訊。</span><span class="sxs-lookup"><span data-stu-id="b8b7d-212">If the method fails, you can obtain extended error information by using the [**LastErrorRecord**](installer-lasterrorrecord.md) method.</span></span>

## <a name="requirements"></a><span data-ttu-id="b8b7d-213">規格需求</span><span class="sxs-lookup"><span data-stu-id="b8b7d-213">Requirements</span></span>



| <span data-ttu-id="b8b7d-214">需求</span><span class="sxs-lookup"><span data-stu-id="b8b7d-214">Requirement</span></span> | <span data-ttu-id="b8b7d-215">值</span><span class="sxs-lookup"><span data-stu-id="b8b7d-215">Value</span></span> |
|--------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="b8b7d-216">版本</span><span class="sxs-lookup"><span data-stu-id="b8b7d-216">Version</span></span><br/> | <span data-ttu-id="b8b7d-217">Windows Server 2012、Windows 8、Windows Server 2008 R2 或 Windows 7 上的 Windows Installer 5.0。</span><span class="sxs-lookup"><span data-stu-id="b8b7d-217">Windows Installer 5.0 on Windows Server 2012, Windows 8, Windows Server 2008 R2 or Windows 7.</span></span> <span data-ttu-id="b8b7d-218">Windows Server 2008 或 Windows Vista 上的 Windows Installer 4.0 或 Windows Installer 4.5。</span><span class="sxs-lookup"><span data-stu-id="b8b7d-218">Windows Installer 4.0 or Windows Installer 4.5 on Windows Server 2008 or Windows Vista.</span></span> <span data-ttu-id="b8b7d-219">Windows Server 2003 或 Windows XP 上的 Windows Installer</span><span class="sxs-lookup"><span data-stu-id="b8b7d-219">Windows Installer on Windows Server 2003 or Windows XP</span></span><br/> |
| <span data-ttu-id="b8b7d-220">DLL</span><span class="sxs-lookup"><span data-stu-id="b8b7d-220">DLL</span></span><br/>     | <dl> <span data-ttu-id="b8b7d-221"><dt>Msi.dll</dt></span><span class="sxs-lookup"><span data-stu-id="b8b7d-221"><dt>Msi.dll</dt></span></span> </dl>                                                                                                                                                                      |
| <span data-ttu-id="b8b7d-222">IID</span><span class="sxs-lookup"><span data-stu-id="b8b7d-222">IID</span></span><br/>     | <span data-ttu-id="b8b7d-223">IID \_ IView 定義為 000C109C-0000-0000-C000-000000000046</span><span class="sxs-lookup"><span data-stu-id="b8b7d-223">IID\_IView is defined as 000C109C-0000-0000-C000-000000000046</span></span><br/>                                                                                                                                                                                |



 

 




