---
description: 本主題會識別您可用來控制自訂動作執行緒的選項旗標。
ms.assetid: a09b3a0e-564e-41aa-af0d-2e46776f291b
title: 自訂動作傳回處理選項
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 2f8664ff489280993a7fc52117f3d19bccb023b6
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/08/2021
ms.locfileid: "103852764"
---
# <a name="custom-action-return-processing-options"></a><span data-ttu-id="94dda-103">自訂動作傳回處理選項</span><span class="sxs-lookup"><span data-stu-id="94dda-103">Custom Action Return Processing Options</span></span>

<span data-ttu-id="94dda-104">本主題會識別您可用來控制自訂動作執行緒的選項旗標。</span><span class="sxs-lookup"><span data-stu-id="94dda-104">This topic identifies the option flags that you can use to control the processing of the custom action thread.</span></span> <span data-ttu-id="94dda-105">旗標是用來指定主要和自訂動作執行緒會以同步方式執行 (Windows Installer 等待自訂動作執行緒完成，再繼續執行主要安裝執行緒) ，或以非同步方式 (Windows Installer 在主要安裝繼續) 時，同時執行自訂動作。</span><span class="sxs-lookup"><span data-stu-id="94dda-105">The flags are used to specify that the main and custom action threads run synchronously (Windows Installer waits for the custom action thread to complete before resuming the main installation thread), or asynchronously (Windows Installer runs the custom action simultaneously while the main installation continues).</span></span>

<span data-ttu-id="94dda-106">若要啟用選項旗標，請將下表所識別的值加入至 [CustomAction 資料表](customaction-table.md)之 [類型] 欄位中的值。</span><span class="sxs-lookup"><span data-stu-id="94dda-106">To enable the option flags, add the value that is identified in the following table to the value in the Type field of the [CustomAction Table](customaction-table.md).</span></span>



| <span data-ttu-id="94dda-107">常數</span><span class="sxs-lookup"><span data-stu-id="94dda-107">Constant</span></span>                                                           | <span data-ttu-id="94dda-108">十六進位</span><span class="sxs-lookup"><span data-stu-id="94dda-108">Hexadecimal</span></span>             | <span data-ttu-id="94dda-109">Decimal</span><span class="sxs-lookup"><span data-stu-id="94dda-109">Decimal</span></span> | <span data-ttu-id="94dda-110">Description</span><span class="sxs-lookup"><span data-stu-id="94dda-110">Description</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|--------------------------------------------------------------------|-------------------------|---------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="94dda-111">(無)</span><span class="sxs-lookup"><span data-stu-id="94dda-111">(none)</span></span>                                                             | <span data-ttu-id="94dda-112">0x00000000</span><span class="sxs-lookup"><span data-stu-id="94dda-112">0x00000000</span></span>              | <span data-ttu-id="94dda-113">+0</span><span class="sxs-lookup"><span data-stu-id="94dda-113">+0</span></span>      | <span data-ttu-id="94dda-114">如果結束代碼不是 0 (零) ，則同步執行會失敗。</span><span class="sxs-lookup"><span data-stu-id="94dda-114">A synchronous execution that fails if the exit code is not 0 (zero).</span></span> <br/> <span data-ttu-id="94dda-115">如果未設定旗標 msidbCustomActionTypeContinue，自訂動作必須傳回 [自訂動作傳回值](custom-action-return-values.md)中所描述的其中一個傳回值。</span><span class="sxs-lookup"><span data-stu-id="94dda-115">If the flag msidbCustomActionTypeContinue is not set, then the custom action must return one of the return values that is described in [Custom Action Return Values](custom-action-return-values.md).</span></span><br/>                                                                                                                                                                                                                             |
| <span data-ttu-id="94dda-116">**msidbCustomActionTypeContinue**</span><span class="sxs-lookup"><span data-stu-id="94dda-116">**msidbCustomActionTypeContinue**</span></span>                                  | <span data-ttu-id="94dda-117">0x00000040</span><span class="sxs-lookup"><span data-stu-id="94dda-117">0x00000040</span></span>              | <span data-ttu-id="94dda-118">+ 64</span><span class="sxs-lookup"><span data-stu-id="94dda-118">+64</span></span>     | <span data-ttu-id="94dda-119">會忽略結束代碼並繼續的同步執行。</span><span class="sxs-lookup"><span data-stu-id="94dda-119">A synchronous execution that ignores exit code and continues.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| <span data-ttu-id="94dda-120">**msidbCustomActionTypeAsync**</span><span class="sxs-lookup"><span data-stu-id="94dda-120">**msidbCustomActionTypeAsync**</span></span>                                     | <span data-ttu-id="94dda-121">0x00000080</span><span class="sxs-lookup"><span data-stu-id="94dda-121">0x00000080</span></span>              | <span data-ttu-id="94dda-122">+ 128</span><span class="sxs-lookup"><span data-stu-id="94dda-122">+128</span></span>    | <span data-ttu-id="94dda-123">在序列結尾等候結束代碼的非同步執行。</span><span class="sxs-lookup"><span data-stu-id="94dda-123">An asynchronous execution that waits for exit code at the end of the sequence.</span></span><br/> <span data-ttu-id="94dda-124">此選項不能與 [並行安裝](concurrent-installations.md)搭配使用、 [復原自訂動作](rollback-custom-actions.md)或 [編寫自訂動作的腳本](scripts.md)。</span><span class="sxs-lookup"><span data-stu-id="94dda-124">This option cannot be used with [Concurrent Installations](concurrent-installations.md), [Rollback Custom Actions](rollback-custom-actions.md), or [Script Custom Actions](scripts.md).</span></span><br/>                                                                                                                                                                                                                                |
| <span data-ttu-id="94dda-125">**msidbCustomActionTypeAsync**  + **msidbCustomActionTypeContinue**</span><span class="sxs-lookup"><span data-stu-id="94dda-125">**msidbCustomActionTypeAsync** + **msidbCustomActionTypeContinue**</span></span> | <span data-ttu-id="94dda-126">0x00000040 + 0x00000080</span><span class="sxs-lookup"><span data-stu-id="94dda-126">0x00000040 + 0x00000080</span></span> | <span data-ttu-id="94dda-127">+192</span><span class="sxs-lookup"><span data-stu-id="94dda-127">+192</span></span>    | <span data-ttu-id="94dda-128">未等候完成的非同步執行。</span><span class="sxs-lookup"><span data-stu-id="94dda-128">An asynchronous execution that does not wait for completion.</span></span><br/> <span data-ttu-id="94dda-129">Windows Installer 終止之後，就會繼續執行。</span><span class="sxs-lookup"><span data-stu-id="94dda-129">Execution continues after Windows Installer terminates.</span></span><br/> <span data-ttu-id="94dda-130">這個選項只可搭配使用的 EXE 類型自訂動作（ [可執行檔](executable-files.md)）使用。</span><span class="sxs-lookup"><span data-stu-id="94dda-130">This option can only be used with the EXE type custom actions that is, [executable files](executable-files.md).</span></span> <br/> <span data-ttu-id="94dda-131">所有其他類型的自訂動作在安裝會話中只能是非同步，而且必須結束安裝才能終止。</span><span class="sxs-lookup"><span data-stu-id="94dda-131">All other types of custom actions can be asynchronous only within the install session, and must end for the installation to terminate.</span></span><br/> <span data-ttu-id="94dda-132">此選項不能與 [並行安裝](concurrent-installations.md)一起使用。</span><span class="sxs-lookup"><span data-stu-id="94dda-132">This option cannot be used with [Concurrent Installations](concurrent-installations.md).</span></span><br/> |



 

 

 




