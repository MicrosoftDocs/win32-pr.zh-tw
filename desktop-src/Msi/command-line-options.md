---
description: 適用于 Windows Installer 3.0 及更早版本之 msiexec.exe 的命令列選項。 提供顯示選項、參數和描述的表格。 顯示如何安裝產品和其他工作的範例。
ms.assetid: a70d8cc8-af47-4472-aabc-97481d97080d
title: 命令列選項
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 46fe56026c21e4120963c86b4de08decc85b2a58
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/08/2021
ms.locfileid: "106979268"
---
# <a name="command-line-options"></a><span data-ttu-id="12cf5-105">命令列選項</span><span class="sxs-lookup"><span data-stu-id="12cf5-105">Command-Line Options</span></span>

<span data-ttu-id="12cf5-106">解釋封裝和安裝產品的可執行程式是 Msiexec.exe。</span><span class="sxs-lookup"><span data-stu-id="12cf5-106">The executable program that interprets packages and installs products is Msiexec.exe.</span></span> <span data-ttu-id="12cf5-107">請注意，Msiexec 也會在傳回時會設定對應至 [系統錯誤碼](/windows/desktop/Debug/system-error-codes)的錯誤層級。</span><span class="sxs-lookup"><span data-stu-id="12cf5-107">Note that Msiexec also sets an error level on return that corresponds to [system error codes](/windows/desktop/Debug/system-error-codes).</span></span> <span data-ttu-id="12cf5-108">命令列選項不區分大小寫。</span><span class="sxs-lookup"><span data-stu-id="12cf5-108">Command-line options are case-insensitive.</span></span>

<span data-ttu-id="12cf5-109">下表中的命令列選項適用于 Windows Installer 3.0 及更早版本。</span><span class="sxs-lookup"><span data-stu-id="12cf5-109">The command-line options in the following table are available with Windows Installer  3.0 and earlier versions.</span></span> <span data-ttu-id="12cf5-110">從 Windows Installer 3.0 開始也提供 [標準安裝程式 Command-Line 選項](standard-installer-command-line-options.md) 。</span><span class="sxs-lookup"><span data-stu-id="12cf5-110">The [Standard Installer Command-Line Options](standard-installer-command-line-options.md) are also available beginning with Windows Installer 3.0.</span></span>



<table>
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="header">
<th><span data-ttu-id="12cf5-111">選項</span><span class="sxs-lookup"><span data-stu-id="12cf5-111">Option</span></span></th>
<th><span data-ttu-id="12cf5-112">參數</span><span class="sxs-lookup"><span data-stu-id="12cf5-112">Parameters</span></span></th>
<th><span data-ttu-id="12cf5-113">意義</span><span class="sxs-lookup"><span data-stu-id="12cf5-113">Meaning</span></span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span data-ttu-id="12cf5-114"><strong>/I</strong></span><span class="sxs-lookup"><span data-stu-id="12cf5-114"><strong>/I</strong></span></span></td>
<td><span data-ttu-id="12cf5-115"><em>套件 |ProductCode</em></span><span class="sxs-lookup"><span data-stu-id="12cf5-115"><em>Package|ProductCode</em></span></span></td>
<td><span data-ttu-id="12cf5-116">安裝或設定產品。</span><span class="sxs-lookup"><span data-stu-id="12cf5-116">Installs or configures a product.</span></span><br/></td>
</tr>
<tr class="even">
<td><span data-ttu-id="12cf5-117"><strong>/f</strong></span><span class="sxs-lookup"><span data-stu-id="12cf5-117"><strong>/f</strong></span></span></td>
<td><span data-ttu-id="12cf5-118">[p | o | e | d | c | a | u | m | s | v]<em>封裝</em> |<em>ProductCode</em></span><span class="sxs-lookup"><span data-stu-id="12cf5-118">[p|o|e|d|c|a|u|m|s|v] <em>Package</em>|<em>ProductCode</em></span></span></td>
<td><span data-ttu-id="12cf5-119">修復產品。</span><span class="sxs-lookup"><span data-stu-id="12cf5-119">Repairs a product.</span></span> <span data-ttu-id="12cf5-120">此選項會忽略在命令列上輸入的任何屬性值。</span><span class="sxs-lookup"><span data-stu-id="12cf5-120">This option ignores any property values entered on the command line.</span></span> <span data-ttu-id="12cf5-121">此選項的預設引數清單是 ' omus reinstall '。</span><span class="sxs-lookup"><span data-stu-id="12cf5-121">The default argument list for this option is 'omus.'</span></span> <span data-ttu-id="12cf5-122">此選項會共用與 <a href="reinstallmode.md"><strong>REINSTALLMODE</strong></a> 屬性相同的引數清單。</span><span class="sxs-lookup"><span data-stu-id="12cf5-122">This option shares the same argument list as the <a href="reinstallmode.md"><strong>REINSTALLMODE</strong></a> property.</span></span><br/> <span data-ttu-id="12cf5-123">p-只有在遺失檔案時才重新安裝。</span><span class="sxs-lookup"><span data-stu-id="12cf5-123">p - Reinstalls only if file is missing.</span></span><br/> <span data-ttu-id="12cf5-124">o-如果遺失檔案或已安裝較舊的版本，則重新安裝。</span><span class="sxs-lookup"><span data-stu-id="12cf5-124">o - Reinstalls if file is missing or an older version is installed.</span></span><br/> <span data-ttu-id="12cf5-125">e-如果遺失檔案或已安裝相同或較舊的版本，則重新安裝。</span><span class="sxs-lookup"><span data-stu-id="12cf5-125">e - Reinstalls if file is missing or an equal or older version is installed.</span></span><br/> <span data-ttu-id="12cf5-126">d-如果遺失檔案或安裝不同的版本，請重新安裝。</span><span class="sxs-lookup"><span data-stu-id="12cf5-126">d - Reinstalls if file is missing or a different version is installed.</span></span><br/> <span data-ttu-id="12cf5-127">c-如果遺失檔案或儲存的總和檢查碼不符合計算值，則重新安裝。</span><span class="sxs-lookup"><span data-stu-id="12cf5-127">c - Reinstalls if file is missing or the stored checksum does not match the calculated value.</span></span> <span data-ttu-id="12cf5-128">只有<a href="file-table.md">在檔案資料表的</a>[屬性] 資料行中，修復具有<strong>msidbFileAttributesChecksum</strong>的檔案。</span><span class="sxs-lookup"><span data-stu-id="12cf5-128">Only repairs files that have <strong>msidbFileAttributesChecksum</strong> in the Attributes column of the <a href="file-table.md">File</a> table.</span></span><br/> <span data-ttu-id="12cf5-129">a-強制重新安裝所有檔案。</span><span class="sxs-lookup"><span data-stu-id="12cf5-129">a - Forces all files to be reinstalled.</span></span><br/> <span data-ttu-id="12cf5-130">u-重寫所有必要的使用者特定登錄專案。</span><span class="sxs-lookup"><span data-stu-id="12cf5-130">u - Rewrites all required user-specific registry entries.</span></span><br/> <span data-ttu-id="12cf5-131">m-重寫所有必要的電腦特定登錄專案。</span><span class="sxs-lookup"><span data-stu-id="12cf5-131">m - Rewrites all required computer-specific registry entries.</span></span><br/> <span data-ttu-id="12cf5-132">s-覆寫所有現有的快捷方式。</span><span class="sxs-lookup"><span data-stu-id="12cf5-132">s - Overwrites all existing shortcuts.</span></span><br/> <span data-ttu-id="12cf5-133">v-從來源執行，然後重新快取本機封裝。</span><span class="sxs-lookup"><span data-stu-id="12cf5-133">v - Runs from source and re-caches the local package.</span></span> <span data-ttu-id="12cf5-134">在第一次安裝應用程式或功能時，請勿使用 [ <strong>v</strong> 重新安裝] 選項。</span><span class="sxs-lookup"><span data-stu-id="12cf5-134">Do not use the <strong>v</strong> reinstall option for the first installation of an application or feature.</span></span><br/></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="12cf5-135"><strong>/a</strong></span><span class="sxs-lookup"><span data-stu-id="12cf5-135"><strong>/a</strong></span></span></td>
<td><span data-ttu-id="12cf5-136"><em>套件</em></span><span class="sxs-lookup"><span data-stu-id="12cf5-136"><em>Package</em></span></span></td>
<td><span data-ttu-id="12cf5-137"><a href="administrative-installation.md">系統管理安裝</a> 選項。</span><span class="sxs-lookup"><span data-stu-id="12cf5-137"><a href="administrative-installation.md">Administrative installation</a> option.</span></span> <span data-ttu-id="12cf5-138">在網路上安裝產品。</span><span class="sxs-lookup"><span data-stu-id="12cf5-138">Installs a product on the network.</span></span><br/></td>
</tr>
<tr class="even">
<td><span data-ttu-id="12cf5-139"><strong>/x</strong></span><span class="sxs-lookup"><span data-stu-id="12cf5-139"><strong>/x</strong></span></span></td>
<td><span data-ttu-id="12cf5-140"><em>套件 |ProductCode</em></span><span class="sxs-lookup"><span data-stu-id="12cf5-140"><em>Package|ProductCode</em></span></span></td>
<td><span data-ttu-id="12cf5-141">卸載產品。</span><span class="sxs-lookup"><span data-stu-id="12cf5-141">Uninstalls a product.</span></span></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="12cf5-142"><strong>/j</strong></span><span class="sxs-lookup"><span data-stu-id="12cf5-142"><strong>/j</strong></span></span></td>
<td><span data-ttu-id="12cf5-143">[u | m]<em>Packageor</em></span><span class="sxs-lookup"><span data-stu-id="12cf5-143">[u|m]<em>Packageor</em></span></span><br/> <span data-ttu-id="12cf5-144">[u | m]<em>封裝</em><strong>/t</strong><em>轉換清單</em></span><span class="sxs-lookup"><span data-stu-id="12cf5-144">[u|m]<em>Package</em><strong>/t</strong><em>Transform List</em></span></span><br/> <span data-ttu-id="12cf5-145"><em>or</em></span><span class="sxs-lookup"><span data-stu-id="12cf5-145"><em>or</em></span></span><br/> <span data-ttu-id="12cf5-146">[u | m]<em>封裝</em><strong>/g</strong><em>LanguageID</em></span><span class="sxs-lookup"><span data-stu-id="12cf5-146">[u|m]<em>Package</em><strong>/g</strong><em>LanguageID</em></span></span><br/></td>
<td><span data-ttu-id="12cf5-147">通告產品。</span><span class="sxs-lookup"><span data-stu-id="12cf5-147">Advertises a product.</span></span> <span data-ttu-id="12cf5-148">此選項會忽略在命令列上輸入的任何屬性值。</span><span class="sxs-lookup"><span data-stu-id="12cf5-148">This option ignores any property values entered on the command line.</span></span><br/> <span data-ttu-id="12cf5-149">u-通告給目前的使用者。</span><span class="sxs-lookup"><span data-stu-id="12cf5-149">u - Advertises to the current user.</span></span><br/> <span data-ttu-id="12cf5-150">m-通告給電腦的所有使用者。</span><span class="sxs-lookup"><span data-stu-id="12cf5-150">m - Advertises to all users of machine.</span></span><br/> <span data-ttu-id="12cf5-151">g 語言識別項。</span><span class="sxs-lookup"><span data-stu-id="12cf5-151">g - Language identifier.</span></span><br/> <span data-ttu-id="12cf5-152">t-將轉換套用至已公告的封裝。</span><span class="sxs-lookup"><span data-stu-id="12cf5-152">t - Applies transform to advertised package.</span></span><br/></td>
</tr>
<tr class="even">
<td><span data-ttu-id="12cf5-153"><strong>/L</strong></span><span class="sxs-lookup"><span data-stu-id="12cf5-153"><strong>/L</strong></span></span></td>
<td><span data-ttu-id="12cf5-154">[i | w | e | a | r | u | c | m | o | p | v | x | + |！ |\*] <em>Logfile</em></span><span class="sxs-lookup"><span data-stu-id="12cf5-154">[i|w|e|a|r|u|c|m|o|p|v|x|+|!|\*] <em>Logfile</em></span></span></td>
<td><span data-ttu-id="12cf5-155">將記錄資訊寫入指定之現有路徑的記錄檔。</span><span class="sxs-lookup"><span data-stu-id="12cf5-155">Writes logging information into a logfile at the specified existing path.</span></span> <span data-ttu-id="12cf5-156">記錄檔位置的路徑必須已經存在。</span><span class="sxs-lookup"><span data-stu-id="12cf5-156">The path to the logfile location must already exist.</span></span> <span data-ttu-id="12cf5-157">安裝程式不會建立記錄檔的目錄結構。</span><span class="sxs-lookup"><span data-stu-id="12cf5-157">The installer does not create the directory structure for the logfile.</span></span> <span data-ttu-id="12cf5-158">旗標會指出要記錄哪些資訊。</span><span class="sxs-lookup"><span data-stu-id="12cf5-158">Flags indicate which information to log.</span></span> <span data-ttu-id="12cf5-159">如果未指定旗標，則預設值為 ' iwearmo '。</span><span class="sxs-lookup"><span data-stu-id="12cf5-159">If no flags are specified, the default is 'iwearmo.'</span></span><br/> <span data-ttu-id="12cf5-160">i-狀態訊息。</span><span class="sxs-lookup"><span data-stu-id="12cf5-160">i - Status messages.</span></span><br/> <span data-ttu-id="12cf5-161">w-非嚴重警告。</span><span class="sxs-lookup"><span data-stu-id="12cf5-161">w - Nonfatal warnings.</span></span><br/> <span data-ttu-id="12cf5-162">e-所有錯誤訊息。</span><span class="sxs-lookup"><span data-stu-id="12cf5-162">e - All error messages.</span></span><br/> <span data-ttu-id="12cf5-163">動作的啟動。</span><span class="sxs-lookup"><span data-stu-id="12cf5-163">a - Start up of actions.</span></span><br/> <span data-ttu-id="12cf5-164">r-動作特定的記錄。</span><span class="sxs-lookup"><span data-stu-id="12cf5-164">r - Action-specific records.</span></span><br/> <span data-ttu-id="12cf5-165">u-使用者要求。</span><span class="sxs-lookup"><span data-stu-id="12cf5-165">u - User requests.</span></span><br/> <span data-ttu-id="12cf5-166">c-初始 UI 參數。</span><span class="sxs-lookup"><span data-stu-id="12cf5-166">c - Initial UI parameters.</span></span><br/> <span data-ttu-id="12cf5-167">m-記憶體不足或嚴重的離開資訊。</span><span class="sxs-lookup"><span data-stu-id="12cf5-167">m - Out-of-memory or fatal exit information.</span></span><br/> <span data-ttu-id="12cf5-168">o-磁碟空間不足的訊息。</span><span class="sxs-lookup"><span data-stu-id="12cf5-168">o - Out-of-disk-space messages.</span></span><br/> <span data-ttu-id="12cf5-169">p-終端機屬性。</span><span class="sxs-lookup"><span data-stu-id="12cf5-169">p - Terminal properties.</span></span><br/> <span data-ttu-id="12cf5-170">v-Verbose 輸出。</span><span class="sxs-lookup"><span data-stu-id="12cf5-170">v - Verbose output.</span></span><br/> <span data-ttu-id="12cf5-171">x-額外的調試資訊。</span><span class="sxs-lookup"><span data-stu-id="12cf5-171">x - Extra debugging information.</span></span> <span data-ttu-id="12cf5-172"><strong>Windows Installer 2.0：</strong> 不支援。</span><span class="sxs-lookup"><span data-stu-id="12cf5-172"><strong>Windows Installer 2.0:</strong> Not supported.</span></span> <span data-ttu-id="12cf5-173">X 選項可 Windows Installer 3.0.3790.2180 版和更新版本中使用。</span><span class="sxs-lookup"><span data-stu-id="12cf5-173">The x option is available with Windows Installer version 3.0.3790.2180 and later.</span></span><br/> <br/> <span data-ttu-id="12cf5-174">+ - 附加至現有的檔案。</span><span class="sxs-lookup"><span data-stu-id="12cf5-174">+ - Append to existing file.</span></span><br/> <span data-ttu-id="12cf5-175">!</span><span class="sxs-lookup"><span data-stu-id="12cf5-175">!</span></span> <span data-ttu-id="12cf5-176">-將每一行排清到記錄檔。</span><span class="sxs-lookup"><span data-stu-id="12cf5-176">- Flush each line to the log.</span></span><br/> <span data-ttu-id="12cf5-177">&quot;*&quot; -萬用字元，記錄除了 v 和 x 選項以外的所有資訊。若要包含 v 和 x 選項，請指定 &quot; /l* vx &quot; 。</span><span class="sxs-lookup"><span data-stu-id="12cf5-177">&quot;*&quot; - Wildcard, log all information except for the v and x options. To include the v and x options, specify &quot;/l* vx&quot;.</span></span><br/>
<blockquote>
[!Note]<br />
<span data-ttu-id="12cf5-178">如需可用於設定記錄模式之所有方法的詳細資訊，請參閱<a href="windows-installer-logging.md">Windows Installer 記錄</a>區段中的<a href="normal-logging.md">一般記錄</a></span><span class="sxs-lookup"><span data-stu-id="12cf5-178">For more information about all the methods that are available for setting the logging mode, see <a href="normal-logging.md">Normal Logging</a> in the <a href="windows-installer-logging.md">Windows Installer Logging</a> section</span></span>
</blockquote>
<br/></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="12cf5-179"><strong>一樣</strong></span><span class="sxs-lookup"><span data-stu-id="12cf5-179"><strong>/m</strong></span></span></td>
<td><span data-ttu-id="12cf5-180"><em>檔案名</em>
</span><span class="sxs-lookup"><span data-stu-id="12cf5-180"><em>filename</em>
</span></span><blockquote>
[!Note]<br />
<span data-ttu-id="12cf5-181"><em>檔案名</em>的長度不能超過8個字元。</span><span class="sxs-lookup"><span data-stu-id="12cf5-181">The length of <em>filename</em> must be no more than eight characters.</span></span>
</blockquote>
<br/></td>
<td><span data-ttu-id="12cf5-182">產生 SMS 狀態的 mif 檔案。</span><span class="sxs-lookup"><span data-stu-id="12cf5-182">Generates an SMS status .mif file.</span></span> <span data-ttu-id="12cf5-183">必須與安裝 (-i) 一起使用、移除 ( x) 、系統管理安裝 (-a) ，或重新安裝 (-f) 選項。</span><span class="sxs-lookup"><span data-stu-id="12cf5-183">Must be used with either the install (-i), remove (-x), administrative installation (-a), or reinstall (-f) options.</span></span> <span data-ttu-id="12cf5-184">ISMIF32.DLL 會安裝為 SMS 的一部分，而且必須在路徑上。</span><span class="sxs-lookup"><span data-stu-id="12cf5-184">The ISMIF32.DLL is installed as part of SMS and must be on the path.</span></span><br/> <span data-ttu-id="12cf5-185">狀態 mif 檔案的欄位會填入下列資訊：</span><span class="sxs-lookup"><span data-stu-id="12cf5-185">The fields of the status mif file are filled with the following information:</span></span><br/> <span data-ttu-id="12cf5-186">製造商- <a href="author-summary.md"><strong>作者</strong></a></span><span class="sxs-lookup"><span data-stu-id="12cf5-186">Manufacturer - <a href="author-summary.md"><strong>Author</strong></a></span></span><br/> <span data-ttu-id="12cf5-187">產品 <a href="revision-number-summary.md"><strong>修訂編號</strong></a></span><span class="sxs-lookup"><span data-stu-id="12cf5-187">Product - <a href="revision-number-summary.md"><strong>Revision Number</strong></a></span></span><br/> <span data-ttu-id="12cf5-188">版本- <a href="subject-summary.md"> <strong></strong>主旨</a></span><span class="sxs-lookup"><span data-stu-id="12cf5-188">Version - <a href="subject-summary.md"><strong>Subject</strong></a></span></span><br/> <span data-ttu-id="12cf5-189">地區設定 <a href="template-summary.md"><strong>範本</strong></a></span><span class="sxs-lookup"><span data-stu-id="12cf5-189">Locale - <a href="template-summary.md"><strong>Template</strong></a></span></span><br/> <span data-ttu-id="12cf5-190">序號-未設定</span><span class="sxs-lookup"><span data-stu-id="12cf5-190">Serial Number - not set</span></span><br/> <span data-ttu-id="12cf5-191">安裝-由 ISMIF32.DLL 設定為 &quot; DateTime&quot;</span><span class="sxs-lookup"><span data-stu-id="12cf5-191">Installation - set by ISMIF32.DLL to &quot;DateTime&quot;</span></span><br/> <span data-ttu-id="12cf5-192">InstallStatus- &quot; 成功 &quot; 或 &quot; 失敗&quot;</span><span class="sxs-lookup"><span data-stu-id="12cf5-192">InstallStatus - &quot;Success&quot; or &quot;Failed&quot;</span></span><br/> <span data-ttu-id="12cf5-193">描述-依下列順序的錯誤訊息： 1) 安裝程式所產生的錯誤訊息。</span><span class="sxs-lookup"><span data-stu-id="12cf5-193">Description - Error messages in the following order: 1) Error messages generated by installer.</span></span> <span data-ttu-id="12cf5-194">如果安裝無法開始或使用者結束，則會從 Msi.dll 2) 資源。</span><span class="sxs-lookup"><span data-stu-id="12cf5-194">2) Resource from Msi.dll if installation could not commence or user exit.</span></span> <span data-ttu-id="12cf5-195">3) 系統錯誤訊息檔。</span><span class="sxs-lookup"><span data-stu-id="12cf5-195">3) System error message file.</span></span> <span data-ttu-id="12cf5-196">4) 格式的訊息： &quot; 安裝程式錯誤% i &quot; ，其中% i 是從 Msi.dll 傳回的錯誤。</span><span class="sxs-lookup"><span data-stu-id="12cf5-196">4) Formatted message: &quot;Installer error %i&quot;, where %i is error returned from Msi.dll.</span></span><br/></td>
</tr>
<tr class="even">
<td><span data-ttu-id="12cf5-197"><strong>/p</strong></span><span class="sxs-lookup"><span data-stu-id="12cf5-197"><strong>/p</strong></span></span></td>
<td><span data-ttu-id="12cf5-198"><em>PatchPackage [;P atchpackage2</em> ]</span><span class="sxs-lookup"><span data-stu-id="12cf5-198"><em>PatchPackage[;patchPackage2</em> ]</span></span></td>
<td><span data-ttu-id="12cf5-199">套用修補程式。</span><span class="sxs-lookup"><span data-stu-id="12cf5-199">Applies a patch.</span></span> <span data-ttu-id="12cf5-200">若要將修補程式套用至已安裝的系統管理映射，您必須合併下列選項：</span><span class="sxs-lookup"><span data-stu-id="12cf5-200">To apply a patch to an installed administrative image you must combine the following options:</span></span><br/> <span data-ttu-id="12cf5-201">/p <em> <PatchPackage> [;p atchpackage2] </em> /a<em><Package></em></span><span class="sxs-lookup"><span data-stu-id="12cf5-201">/p <em><PatchPackage>[;patchPackage2 ]</em> /a <em><Package></em></span></span><br/></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="12cf5-202"><strong>/q</strong></span><span class="sxs-lookup"><span data-stu-id="12cf5-202"><strong>/q</strong></span></span></td>
<td><span data-ttu-id="12cf5-203">n | b | r | f</span><span class="sxs-lookup"><span data-stu-id="12cf5-203">n|b|r|f</span></span></td>
<td><span data-ttu-id="12cf5-204">設定 <a href="user-interface-levels.md">使用者介面層級</a>。</span><span class="sxs-lookup"><span data-stu-id="12cf5-204">Sets <a href="user-interface-levels.md">user interface level</a>.</span></span><br/> <span data-ttu-id="12cf5-205">問： qn-沒有 UI</span><span class="sxs-lookup"><span data-stu-id="12cf5-205">q , qn - No UI</span></span><br/> <span data-ttu-id="12cf5-206">qb- <a href="b-gly.md"><em>基本 UI</em></a>。</span><span class="sxs-lookup"><span data-stu-id="12cf5-206">qb - <a href="b-gly.md"><em>Basic UI</em></a>.</span></span> <span data-ttu-id="12cf5-207">使用 qb！</span><span class="sxs-lookup"><span data-stu-id="12cf5-207">Use qb!</span></span> <span data-ttu-id="12cf5-208">隱藏 [ <strong>取消</strong> ] 按鈕。</span><span class="sxs-lookup"><span data-stu-id="12cf5-208">to hide the <strong>Cancel</strong> button.</span></span><br/> <span data-ttu-id="12cf5-209">在安裝結束時，不顯示任何強制回應對話方塊的 qr <a href="r-gly.md"><em>減少 UI</em></a> 。</span><span class="sxs-lookup"><span data-stu-id="12cf5-209">qr - <a href="r-gly.md"><em>Reduced UI</em></a> with no modal dialog box displayed at the end of the installation.</span></span><br/> <span data-ttu-id="12cf5-210">qf- <a href="f-gly.md"><em>完整 UI</em></a> 和任何撰寫的 <a href="fatalerror-dialog.md">FatalError</a>、 <a href="userexit-dialog.md">UserExit</a>或 <a href="exit-dialog.md">結束</a> 強制回應對話方塊。</span><span class="sxs-lookup"><span data-stu-id="12cf5-210">qf - <a href="f-gly.md"><em>Full UI</em></a> and any authored <a href="fatalerror-dialog.md">FatalError</a>, <a href="userexit-dialog.md">UserExit</a>, or <a href="exit-dialog.md">Exit</a> modal dialog boxes at the end.</span></span><br/> <span data-ttu-id="12cf5-211">qn +-沒有 UI，除了顯示于結尾的強制回應對話方塊。</span><span class="sxs-lookup"><span data-stu-id="12cf5-211">qn+ - No UI except for a modal dialog box displayed at the end.</span></span><br/> <span data-ttu-id="12cf5-212">qb +- <a href="b-gly.md"><em>基本 UI</em></a> ，並在結尾顯示模式對話方塊。</span><span class="sxs-lookup"><span data-stu-id="12cf5-212">qb+ - <a href="b-gly.md"><em>Basic UI</em></a> with a modal dialog box displayed at the end.</span></span> <span data-ttu-id="12cf5-213">如果使用者取消安裝，就不會顯示模式方塊。</span><span class="sxs-lookup"><span data-stu-id="12cf5-213">The modal box is not displayed if the user cancels the installation.</span></span> <span data-ttu-id="12cf5-214">使用 qb +！</span><span class="sxs-lookup"><span data-stu-id="12cf5-214">Use qb+!</span></span> <span data-ttu-id="12cf5-215">或 qb！ + 隱藏 [ <strong>取消</strong> ] 按鈕。</span><span class="sxs-lookup"><span data-stu-id="12cf5-215">or qb!+ to hide the <strong>Cancel</strong> button.</span></span><br/> <span data-ttu-id="12cf5-216">qb--沒有強制回應對話方塊的 <a href="b-gly.md"><em>基本 UI</em></a> 。</span><span class="sxs-lookup"><span data-stu-id="12cf5-216">qb- - <a href="b-gly.md"><em>Basic UI</em></a> with no modal dialog boxes.</span></span> <span data-ttu-id="12cf5-217">請注意，/qb + 不是支援的 UI 層級。</span><span class="sxs-lookup"><span data-stu-id="12cf5-217">Please note that /qb+- is not a supported UI level.</span></span> <span data-ttu-id="12cf5-218">使用 qb-！</span><span class="sxs-lookup"><span data-stu-id="12cf5-218">Use qb-!</span></span> <span data-ttu-id="12cf5-219">或 qb！-隱藏 [ <strong>取消</strong> ] 按鈕。</span><span class="sxs-lookup"><span data-stu-id="12cf5-219">or qb!- to hide the <strong>Cancel</strong> button.</span></span><br/> <span data-ttu-id="12cf5-220">請注意！</span><span class="sxs-lookup"><span data-stu-id="12cf5-220">Note that the !</span></span> <span data-ttu-id="12cf5-221">選項適用于 Windows Installer 2.0，且僅適用于基本 UI。</span><span class="sxs-lookup"><span data-stu-id="12cf5-221">option is available with Windows Installer 2.0 and works only with basic UI.</span></span> <span data-ttu-id="12cf5-222">它對完整的 UI 而言是不正確。</span><span class="sxs-lookup"><span data-stu-id="12cf5-222">It is not valid with full UI.</span></span><br/></td>
</tr>
<tr class="even">
<td><span data-ttu-id="12cf5-223"><strong>/?</strong></span><span class="sxs-lookup"><span data-stu-id="12cf5-223"><strong>/?</strong></span></span> <span data-ttu-id="12cf5-224">或 <strong>/h</strong></span><span class="sxs-lookup"><span data-stu-id="12cf5-224">or <strong>/h</strong></span></span></td>
<td> </td>
<td><span data-ttu-id="12cf5-225">顯示 Windows Installer 的著作權資訊。</span><span class="sxs-lookup"><span data-stu-id="12cf5-225">Displays copyright information for Windows Installer.</span></span><br/></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="12cf5-226"><strong>/y</strong></span><span class="sxs-lookup"><span data-stu-id="12cf5-226"><strong>/y</strong></span></span></td>
<td><span data-ttu-id="12cf5-227"><em>模組</em></span><span class="sxs-lookup"><span data-stu-id="12cf5-227"><em>module</em></span></span></td>
<td><span data-ttu-id="12cf5-228">呼叫系統函數 <strong>DllRegisterServer</strong> ，以在命令列上傳遞的自我註冊模組。</span><span class="sxs-lookup"><span data-stu-id="12cf5-228">Calls the system function <strong>DllRegisterServer</strong> to self-register modules passed in on the command line.</span></span> <span data-ttu-id="12cf5-229">指定 DLL 的完整路徑。</span><span class="sxs-lookup"><span data-stu-id="12cf5-229">Specify the full path to the DLL.</span></span> <span data-ttu-id="12cf5-230">例如，針對目前資料夾中的 MY_FILE.DLL，您可以使用：</span><span class="sxs-lookup"><span data-stu-id="12cf5-230">For example, for MY_FILE.DLL in the current folder you can use:</span></span><br/> <span data-ttu-id="12cf5-231"><strong>msiexec/y .\MY_FILE.DLL</strong></span><span class="sxs-lookup"><span data-stu-id="12cf5-231"><strong>msiexec /y .\MY_FILE.DLL</strong></span></span><br/> <span data-ttu-id="12cf5-232">此選項只會用於無法使用 .msi 檔案的登錄資料表新增的登錄資訊。</span><span class="sxs-lookup"><span data-stu-id="12cf5-232">This option is only used for registry information that cannot be added using the registry tables of the .msi file.</span></span><br/></td>
</tr>
<tr class="even">
<td><span data-ttu-id="12cf5-233"><strong>/z</strong></span><span class="sxs-lookup"><span data-stu-id="12cf5-233"><strong>/z</strong></span></span></td>
<td><span data-ttu-id="12cf5-234"><em>模組</em></span><span class="sxs-lookup"><span data-stu-id="12cf5-234"><em>module</em></span></span></td>
<td><span data-ttu-id="12cf5-235">呼叫系統函數 <strong>DllUnRegisterServer</strong> ，以取消註冊命令列上所傳入的模組。</span><span class="sxs-lookup"><span data-stu-id="12cf5-235">Calls the system function <strong>DllUnRegisterServer</strong> to unregister modules passed in on the command line.</span></span> <span data-ttu-id="12cf5-236">指定 DLL 的完整路徑。</span><span class="sxs-lookup"><span data-stu-id="12cf5-236">Specify the full path to the DLL.</span></span> <span data-ttu-id="12cf5-237">例如，針對目前資料夾中的 MY_FILE.DLL，您可以使用：</span><span class="sxs-lookup"><span data-stu-id="12cf5-237">For example, for MY_FILE.DLL in the current folder you can use:</span></span> <br/> <span data-ttu-id="12cf5-238"><strong>msiexec/z .\MY_FILE.DLL</strong></span><span class="sxs-lookup"><span data-stu-id="12cf5-238"><strong>msiexec /z .\MY_FILE.DLL</strong></span></span><br/> <span data-ttu-id="12cf5-239">此選項只會用於無法使用 .msi 檔案的登錄表移除的登錄資訊。</span><span class="sxs-lookup"><span data-stu-id="12cf5-239">This option is only used for registry information that cannot be removed using the registry tables of the .msi file.</span></span><br/></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="12cf5-240"><strong>/c</strong></span><span class="sxs-lookup"><span data-stu-id="12cf5-240"><strong>/c</strong></span></span></td>

<td><span data-ttu-id="12cf5-241">通告產品的新實例。</span><span class="sxs-lookup"><span data-stu-id="12cf5-241">Advertises a new instance of the product.</span></span> <span data-ttu-id="12cf5-242">必須搭配/t 使用</span><span class="sxs-lookup"><span data-stu-id="12cf5-242">Must be used in conjunction with /t.</span></span> <span data-ttu-id="12cf5-243">從 Windows Server 2003 和 Windows XP Service Pack 1 隨附的 Windows Installer 版本開始提供 (SP1) 。</span><span class="sxs-lookup"><span data-stu-id="12cf5-243">Available starting with the Windows Installer version that is shipped with Windows Server 2003 and Windows XP with Service Pack 1 (SP1).</span></span><br/></td>
</tr>
<tr class="even">
<td><span data-ttu-id="12cf5-244"><strong>n</strong></span><span class="sxs-lookup"><span data-stu-id="12cf5-244"><strong>/n</strong></span></span></td>
<td><span data-ttu-id="12cf5-245"><em>ProductCode</em></span><span class="sxs-lookup"><span data-stu-id="12cf5-245"><em>ProductCode</em></span></span></td>
<td><span data-ttu-id="12cf5-246">指定產品的特定實例。</span><span class="sxs-lookup"><span data-stu-id="12cf5-246">Specifies a particular instance of the product.</span></span> <span data-ttu-id="12cf5-247">用來透過產品程式碼變更轉換，來識別使用多重實例支援所安裝的實例。</span><span class="sxs-lookup"><span data-stu-id="12cf5-247">Used to identify an instance installed using the multiple instance support through a product code changing transforms.</span></span> <span data-ttu-id="12cf5-248">從隨附于 Windows Server 2003 和 Windows XP SP1 的 Windows Installer 版本開始提供。</span><span class="sxs-lookup"><span data-stu-id="12cf5-248">Available starting with the Windows Installer version shipped with Windows Server 2003 and Windows XP with SP1.</span></span> <br/></td>
</tr>
</tbody>
</table>



 

<span data-ttu-id="12cf5-249">Options/i、/x、/f \[ p \| o \| e \| d \| c \| a \| u \| m \| s \| v \] 、/j \[ u \| m \] 、/a、/p、/y 和/z 不應一起使用。</span><span class="sxs-lookup"><span data-stu-id="12cf5-249">The options /i, /x, /f\[p\|o\|e\|d\|c\|a\|u\|m\|s\|v\], /j\[u\|m\], /a, /p, /y and /z should not be used together.</span></span> <span data-ttu-id="12cf5-250">這項規則的唯一例外是修補 [系統管理安裝](administrative-installation.md) 需要同時使用/p 和/a</span><span class="sxs-lookup"><span data-stu-id="12cf5-250">The one exception to this rule is that patching an [administrative installation](administrative-installation.md) requires using both /p and /a.</span></span> <span data-ttu-id="12cf5-251">/T、/c 和/g 選項只能與/j. 搭配使用</span><span class="sxs-lookup"><span data-stu-id="12cf5-251">The options /t, /c and /g should only be used with /j.</span></span> <span data-ttu-id="12cf5-252">/L 和/q 選項可以搭配/i、/x、/f \[ p \| o \| e \| d \| c \| a \| u \| m \| s \| v \] 、/j \[ u \| m \] 、/a 和/p 使用。</span><span class="sxs-lookup"><span data-stu-id="12cf5-252">The options /l and /q can be used with /i, /x, /f\[p\|o\|e\|d\|c\|a\|u\|m\|s\|v\], /j\[u\|m\], /a, and /p.</span></span> <span data-ttu-id="12cf5-253">選項/n 可搭配/i、/f、/x 和/p 使用</span><span class="sxs-lookup"><span data-stu-id="12cf5-253">The option /n can be used with /i, /f, /x and /p.</span></span>

<span data-ttu-id="12cf5-254">若要從：Example.msi 安裝產品 \\ ，請安裝產品，如下所示：</span><span class="sxs-lookup"><span data-stu-id="12cf5-254">To install a product from A:\\Example.msi, install the product as follows:</span></span>

<span data-ttu-id="12cf5-255">**msiexec/i A： \\Example.msi**</span><span class="sxs-lookup"><span data-stu-id="12cf5-255">**msiexec /i A:\\Example.msi**</span></span>

<span data-ttu-id="12cf5-256">您只能使用命令列來修改 [公用屬性](public-properties.md) 。</span><span class="sxs-lookup"><span data-stu-id="12cf5-256">Only [public properties](public-properties.md) can be modified using the command line.</span></span> <span data-ttu-id="12cf5-257">命令列上的所有屬性名稱都會轉譯為大寫，但值會保留區分大小寫。</span><span class="sxs-lookup"><span data-stu-id="12cf5-257">All property names on the command line are interpreted as uppercase but the value retains case sensitivity.</span></span> <span data-ttu-id="12cf5-258">如果您在命令列中輸入 **MyProperty** ，安裝程式會覆寫 MyProperty 的值，而不是屬性工作表中 **MyProperty** 的值。</span><span class="sxs-lookup"><span data-stu-id="12cf5-258">If you enter **MyProperty** at a command line, the installer overrides the value of MYPROPERTY and not the value of **MyProperty** in the Property table.</span></span> <span data-ttu-id="12cf5-259">如需詳細資訊，請參閱 [關於屬性](about-properties.md)。</span><span class="sxs-lookup"><span data-stu-id="12cf5-259">For more information, see [About Properties](about-properties.md).</span></span>

<span data-ttu-id="12cf5-260">若要安裝屬性設定為 VALUE 的產品，請在命令列上使用下列語法。</span><span class="sxs-lookup"><span data-stu-id="12cf5-260">To install a product with PROPERTY set to VALUE, use the following syntax on the command line.</span></span> <span data-ttu-id="12cf5-261">您可以將屬性放在選項和其引數以外的任何位置。</span><span class="sxs-lookup"><span data-stu-id="12cf5-261">You can put the property anywhere except between an option and its argument.</span></span>

<span data-ttu-id="12cf5-262">正確的語法：</span><span class="sxs-lookup"><span data-stu-id="12cf5-262">Correct syntax:</span></span>

<span data-ttu-id="12cf5-263">**msiexec/i A： \\Example.msi PROPERTY = VALUE**</span><span class="sxs-lookup"><span data-stu-id="12cf5-263">**msiexec /i A:\\Example.msi PROPERTY=VALUE**</span></span>

<span data-ttu-id="12cf5-264">語法不正確：</span><span class="sxs-lookup"><span data-stu-id="12cf5-264">Incorrect syntax:</span></span>

<span data-ttu-id="12cf5-265">**msiexec/i PROPERTY = VALUE A： \\Example.msi**</span><span class="sxs-lookup"><span data-stu-id="12cf5-265">**msiexec /i PROPERTY=VALUE A:\\Example.msi**</span></span>

<span data-ttu-id="12cf5-266">屬於常值字串的屬性值必須以引號括住。</span><span class="sxs-lookup"><span data-stu-id="12cf5-266">Property values that are literal strings must be enclosed in quotation marks.</span></span> <span data-ttu-id="12cf5-267">在這些標記之間的字串中包含任何空白字元。</span><span class="sxs-lookup"><span data-stu-id="12cf5-267">Include any white spaces in the string between the marks.</span></span>

<span data-ttu-id="12cf5-268">**msiexec/i A： \\Example.msi PROPERTY = "內嵌式空白字元"**</span><span class="sxs-lookup"><span data-stu-id="12cf5-268">**msiexec /i A:\\Example.msi PROPERTY="Embedded White Space"**</span></span>

<span data-ttu-id="12cf5-269">若要使用命令列清除公用屬性，請將其值設定為空字串。</span><span class="sxs-lookup"><span data-stu-id="12cf5-269">To clear a public property by using the command line, set its value to an empty string.</span></span>

<span data-ttu-id="12cf5-270">**msiexec/i A： \\Example.msi PROPERTY = ""**</span><span class="sxs-lookup"><span data-stu-id="12cf5-270">**msiexec /i A:\\Example.msi PROPERTY=""**</span></span>

<span data-ttu-id="12cf5-271">針對以文字引號分隔的文字區段，使用第二組引號括住區段。</span><span class="sxs-lookup"><span data-stu-id="12cf5-271">For sections of text set apart by literal quotation marks, enclose the section with a second pair of quotation marks.</span></span>

<span data-ttu-id="12cf5-272">**msiexec/i A： \\Example.msi PROPERTY = "Embedded" "引號" "空白字元"**</span><span class="sxs-lookup"><span data-stu-id="12cf5-272">**msiexec /i A:\\Example.msi PROPERTY="Embedded ""Quotes"" White Space"**</span></span>

<span data-ttu-id="12cf5-273">下列範例顯示覆雜的命令列。</span><span class="sxs-lookup"><span data-stu-id="12cf5-273">The following example shows a complicated command line.</span></span>

<span data-ttu-id="12cf5-274">**msiexec/i testdb.msi INSTALLLEVEL = 3/l \* msi. log 的名稱 = "Acme" "widget" "和" "Gizmos" ""**</span><span class="sxs-lookup"><span data-stu-id="12cf5-274">**msiexec /i testdb.msi INSTALLLEVEL=3 /l\* msi.log COMPANYNAME="Acme ""Widgets"" and ""Gizmos."""**</span></span>

<span data-ttu-id="12cf5-275">下列範例顯示公告選項。</span><span class="sxs-lookup"><span data-stu-id="12cf5-275">The following example shows advertisement options.</span></span> <span data-ttu-id="12cf5-276">請注意，參數不區分大小寫。</span><span class="sxs-lookup"><span data-stu-id="12cf5-276">Note that switches are not case-sensitive.</span></span>

<span data-ttu-id="12cf5-277">**msiexec/JM msisample.msi/T 轉換。 mst/LIME logfile.txt**</span><span class="sxs-lookup"><span data-stu-id="12cf5-277">**msiexec /JM msisample.msi /T transform.mst /LIME logfile.txt**</span></span>

<span data-ttu-id="12cf5-278">下列範例示範如何安裝要公告之產品的新實例。</span><span class="sxs-lookup"><span data-stu-id="12cf5-278">The following example shows you how to install a new instance of a product to be advertised.</span></span> <span data-ttu-id="12cf5-279">這項產品的撰寫是為了支援多個實例轉換。</span><span class="sxs-lookup"><span data-stu-id="12cf5-279">This product is authored to support multiple instance transforms.</span></span>

<span data-ttu-id="12cf5-280">**msiexec/JM msisample.msi/T： instance1 .mst; 自訂 .mst/c/LIME logfile.txt**</span><span class="sxs-lookup"><span data-stu-id="12cf5-280">**msiexec /JM msisample.msi /T :instance1.mst;customization.mst /c /LIME logfile.txt**</span></span>

<span data-ttu-id="12cf5-281">下列範例示範如何修補使用多個實例轉換所安裝之產品的實例。</span><span class="sxs-lookup"><span data-stu-id="12cf5-281">The following example shows how to patch an instance of a product that is installed using multiple instance transforms.</span></span>

<span data-ttu-id="12cf5-282">**msiexec/p msipatch .msp; msipatch2 .msp/n {00000001-0002-0000-0000-624474736554} /qb**</span><span class="sxs-lookup"><span data-stu-id="12cf5-282">**msiexec /p msipatch.msp;msipatch2.msp /n {00000001-0002-0000-0000-624474736554} /qb**</span></span>

<span data-ttu-id="12cf5-283">當您將修補程式套用至特定產品時，不能在命令列中同時指定/i 和/p 選項。</span><span class="sxs-lookup"><span data-stu-id="12cf5-283">When you apply patches to a specific product, the /i and /p options cannot be specified together in a command line.</span></span> <span data-ttu-id="12cf5-284">在此情況下，您可以將修補程式套用至產品，如下所示。</span><span class="sxs-lookup"><span data-stu-id="12cf5-284">In this case, you can apply patches to a product as follows.</span></span>

<span data-ttu-id="12cf5-285">**msiexec/i A： \\Example.msi PATCH = msipatch .msp; msipatch2 .msp/qb**</span><span class="sxs-lookup"><span data-stu-id="12cf5-285">**msiexec /i A:\\Example.msi PATCH=msipatch.msp;msipatch2.msp /qb**</span></span>

<span data-ttu-id="12cf5-286">使用/p 選項時，無法在命令列中設定 [**PATCH**](patch.md) 屬性。</span><span class="sxs-lookup"><span data-stu-id="12cf5-286">The [**PATCH**](patch.md) property cannot be set in a command line, when /p option is used.</span></span> <span data-ttu-id="12cf5-287">如果在使用/p 選項時設定 **patch** 屬性， **patch** 屬性的值會被忽略並覆寫。</span><span class="sxs-lookup"><span data-stu-id="12cf5-287">If the **PATCH** property is set when the /p option is used, the value of **PATCH** property is ignored and overwritten.</span></span>

 

