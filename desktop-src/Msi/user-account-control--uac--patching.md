---
description: " (UAC) 修補的使用者帳戶控制可讓 Windows Installer 安裝的作者找出可由非系統管理員使用者未來套用的數位簽章修補程式。"
ms.assetid: f7d64f61-24c8-4037-a10b-d68d0e9e3c42
title: " (UAC) 修補的使用者帳戶控制"
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 6d111a39245ab15b24c1734d278a8e0a477e68a6
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/08/2021
ms.locfileid: "103852716"
---
# <a name="user-account-control-uac-patching"></a><span data-ttu-id="793ed-103"> (UAC) 修補的使用者帳戶控制</span><span class="sxs-lookup"><span data-stu-id="793ed-103">User Account Control (UAC) Patching</span></span>

<span data-ttu-id="793ed-104"> (UAC) 修補的 [*使用者帳戶控制*](u-gly.md)可讓 Windows Installer 安裝的作者找出可由非系統管理員使用者未來套用的數位簽章修補程式。</span><span class="sxs-lookup"><span data-stu-id="793ed-104">[*User Account Control*](u-gly.md) (UAC) patching enables the authors of Windows Installer installations to identify digitally-signed patches that can be applied in the future by non-administrator users.</span></span>

<span data-ttu-id="793ed-105">如果數位簽章與憑證不符，Windows Vista 會在安裝修補程式之前，先顯示一個要求系統管理員授權的 UAC 對話方塊。</span><span class="sxs-lookup"><span data-stu-id="793ed-105">If the digital signature does not match the certificate, Windows Vista displays a UAC dialog box requesting administrator authorization before installing the patch.</span></span> <span data-ttu-id="793ed-106">在 Windows Vista 之前的系統上，安裝程式將不會套用與憑證不符的已簽署修補程式。</span><span class="sxs-lookup"><span data-stu-id="793ed-106">On systems earlier than Windows Vista, the installer will not apply a signed patch that does not match the certificate.</span></span>

<span data-ttu-id="793ed-107">如果非系統管理員嘗試將修補程式套用至應用程式，但未符合下列條件，則 Windows Vista 會在安裝修補程式之前，通知使用者需要系統管理員授權。</span><span class="sxs-lookup"><span data-stu-id="793ed-107">If a non-administrator attempts to apply a patch to an application, and the following conditions have not been met, Windows Vista will notify the user that administrator authorization is required before installing the patch.</span></span> <span data-ttu-id="793ed-108">如果符合下列條件，則非系統管理員可以繼續安裝修補程式，而不需要取得額外的系統管理員授權。</span><span class="sxs-lookup"><span data-stu-id="793ed-108">A non-administrator can continue installing the patch, without needing to obtain additional administrator authorization, provided the following conditions are met.</span></span>

-   <span data-ttu-id="793ed-109">應用程式是使用 Windows Installer 3.0 或更新版本安裝在 Windows Vista 或 Windows XP 上。</span><span class="sxs-lookup"><span data-stu-id="793ed-109">The application was installed on Windows Vista or Windows XP using Windows Installer 3.0 or later.</span></span>

    <span data-ttu-id="793ed-110">**Windows Server 2008：** 不支援。</span><span class="sxs-lookup"><span data-stu-id="793ed-110">**Windows Server 2008:** Not supported.</span></span>

-   <span data-ttu-id="793ed-111">如果應用程式是安裝在 Windows XP 上，則也必須從卸載式媒體（例如 CD-ROM 或 DVD 磁片）安裝應用程式。</span><span class="sxs-lookup"><span data-stu-id="793ed-111">If the application was installed on Windows XP, the application must also have been installed from removable media, such a CD-ROM or DVD disk.</span></span> <span data-ttu-id="793ed-112">如果應用程式是安裝在 Windows Vista 上，則不適用此限制。</span><span class="sxs-lookup"><span data-stu-id="793ed-112">This restriction does not apply if the application was installed on Windows Vista.</span></span>
-   <span data-ttu-id="793ed-113">未從 [系統管理安裝](administrative-installation.md) 來源映射安裝應用程式。</span><span class="sxs-lookup"><span data-stu-id="793ed-113">The application was not installed from an [administrative installation](administrative-installation.md) source image.</span></span>
-   <span data-ttu-id="793ed-114">應用程式原本是依電腦安裝。</span><span class="sxs-lookup"><span data-stu-id="793ed-114">The application was originally installed per-machine.</span></span> <span data-ttu-id="793ed-115">如需有關如何讓非系統管理員在修補程式被系統管理員信任之後，將修補程式套用至個別使用者管理的應用程式的相關資訊，請參閱 [修補 Per-User 受控應用程式](patching-per-user-managed-applications.md)。</span><span class="sxs-lookup"><span data-stu-id="793ed-115">For information about how to enable non-administrators to apply patches to per-user-managed applications after the patch has been approved as trusted by an administrator, see [Patching Per-User Managed Applications](patching-per-user-managed-applications.md).</span></span>
-   <span data-ttu-id="793ed-116">[MsiPatchCertificate 資料表](msipatchcertificate-table.md)會出現在 ( .msi 檔案) 的 windows Installer 封裝中，並包含啟用 UAC 所需的資訊。</span><span class="sxs-lookup"><span data-stu-id="793ed-116">The [MsiPatchCertificate table](msipatchcertificate-table.md) is present in the Window Installer package (.msi file) and contains the information needed to enable UAC.</span></span> <span data-ttu-id="793ed-117">資料表和資訊可能已包含在原始安裝封裝中，或由 Windows Installer patch 檔案新增至封裝， ( .msp 檔案) 。</span><span class="sxs-lookup"><span data-stu-id="793ed-117">The table and information may have been be included in the original installation package or added to the package by a Windows Installer patch file (.msp file).</span></span>
-   <span data-ttu-id="793ed-118">這些修補程式會以 [MsiPatchCertificate 資料表](msipatchcertificate-table.md)中所列的憑證進行數位簽署。</span><span class="sxs-lookup"><span data-stu-id="793ed-118">The patches are digitally signed by a certificate listed in the [MsiPatchCertificate table](msipatchcertificate-table.md).</span></span> <span data-ttu-id="793ed-119">如需數位簽章憑證的詳細資訊，請參閱 [數位簽章和 Windows Installer](digital-signatures-and-windows-installer.md)。</span><span class="sxs-lookup"><span data-stu-id="793ed-119">For more information about digital signature certificates, see [Digital Signatures and Windows Installer](digital-signatures-and-windows-installer.md).</span></span>
-   <span data-ttu-id="793ed-120">修補程式套件上的數位簽章可以針對 [MsiPatchCertificate 資料表](msipatchcertificate-table.md)中的憑證進行驗證。</span><span class="sxs-lookup"><span data-stu-id="793ed-120">The digital signature on the patch package can be verified against the certificate in the [MsiPatchCertificate table](msipatchcertificate-table.md).</span></span> <span data-ttu-id="793ed-121">如需有關使用數位簽章、數位憑證和 [**WinVerifyTrust**](/windows/win32/api/wintrust/nf-wintrust-winverifytrust)的詳細資訊，請參閱 Microsoft WINDOWS 軟體開發套件 (SDK) 的 [安全性](https://msdn.microsoft.com/library/cc527452.aspx) 一節。</span><span class="sxs-lookup"><span data-stu-id="793ed-121">For more information about the use of digital signatures, digital certificates, and [**WinVerifyTrust**](/windows/win32/api/wintrust/nf-wintrust-winverifytrust), see the [Security](https://msdn.microsoft.com/library/cc527452.aspx) section of the Microsoft Windows Software Development Kit (SDK).</span></span>
-   <span data-ttu-id="793ed-122">用來驗證修補程式套件上數位簽章的簽署者憑證是有效的，而且尚未撤銷。</span><span class="sxs-lookup"><span data-stu-id="793ed-122">The signer certificate used to verify the digital signature on the patch package is valid and has not been revoked.</span></span>
    > [!Note]  
    > <span data-ttu-id="793ed-123">雖然您無法使用過期的憑證來簽署修補程式，但如果憑證已過期，則在修補程式上評估數位簽章不會失敗。</span><span class="sxs-lookup"><span data-stu-id="793ed-123">Although you cannot sign a patch using an expired certificate, evaluation of a digital signature on a patch does not fail if the certificate has expired.</span></span> <span data-ttu-id="793ed-124">評估使用目前的 [MsiPatchCertificate 資料表](msipatchcertificate-table.md)，其中包含原始封裝中的 MsiPatchCertificate 資料表，以及在目前的封裝之前排序的修補程式對資料表所做的任何變更。</span><span class="sxs-lookup"><span data-stu-id="793ed-124">Evaluation uses the current [MsiPatchCertificate table](msipatchcertificate-table.md), which consists of the MsiPatchCertificate table in the original package and any changes to the table by patches sequenced prior to the current one.</span></span> <span data-ttu-id="793ed-125">修補程式可以將新的憑證新增至 MsiPatchCertificate 資料表，以評估在目前修補之後排序的修補程式。</span><span class="sxs-lookup"><span data-stu-id="793ed-125">A patch can add new certificates to the MsiPatchCertificate table to evaluate patches sequenced after the current patch.</span></span> <span data-ttu-id="793ed-126">已撤銷的憑證一律會被拒絕。</span><span class="sxs-lookup"><span data-stu-id="793ed-126">A revoked certificate is always rejected.</span></span>

     

-   <span data-ttu-id="793ed-127">未藉由設定 [**MSIDISABLELUAPATCHING**](msidisableluapatching.md) 屬性或 [DisableLUAPatching](disableluapatching.md) 原則來停用最低許可權修補。</span><span class="sxs-lookup"><span data-stu-id="793ed-127">Least-privilege patching has not been disabled by setting the [**MSIDISABLELUAPATCHING**](msidisableluapatching.md) property or the [DisableLUAPatching](disableluapatching.md) policy.</span></span>

<span data-ttu-id="793ed-128">非系統管理員也可以移除使用 UAC 修補套用的修補程式。</span><span class="sxs-lookup"><span data-stu-id="793ed-128">A patch that has been applied using UAC patching can also be removed by a non-administrator.</span></span>

<span data-ttu-id="793ed-129">系統管理員可以將修補程式套用至每部電腦安裝的產品，不論應用程式的 UAC 設定為何。</span><span class="sxs-lookup"><span data-stu-id="793ed-129">Administrators can apply patches to per-machine installed products regardless of the application's UAC setting.</span></span>

<span data-ttu-id="793ed-130">您可以使用 [**MsiGetProductInfoEx**](/windows/desktop/api/Msi/nf-msi-msigetproductinfoexa) 函式來查詢 INSTALLPROPERTY \_ 授權的 \_ LUA \_ 應用程式屬性，或使用 [**ProductInfo**](installer-productinfo.md) 方法來查詢 "AuthorizedLUAApp" 屬性，以判斷應用程式是否已啟用最低許可權修補。</span><span class="sxs-lookup"><span data-stu-id="793ed-130">You can determine whether least-privilege patching is enabled for an application by using the [**MsiGetProductInfoEx**](/windows/desktop/api/Msi/nf-msi-msigetproductinfoexa) function to query for the INSTALLPROPERTY\_AUTHORIZED\_LUA\_APP property, or by using the [**ProductInfo**](installer-productinfo.md) method to query for the "AuthorizedLUAApp" property.</span></span> <span data-ttu-id="793ed-131">如果任一個屬性的值為1，則會為應用程式啟用最低許可權的使用者帳戶修補。</span><span class="sxs-lookup"><span data-stu-id="793ed-131">If the value of either property is 1, the application is enabled for least-privilege user account patching.</span></span>

<span data-ttu-id="793ed-132">系統管理員可以將 [DisableLUAPatching](disableluapatching.md) 原則設定為1，以停用電腦上的最低許可權修補。</span><span class="sxs-lookup"><span data-stu-id="793ed-132">An administrator can disable least-privilege patching on the computer by setting the [DisableLUAPatching](disableluapatching.md) policy to 1.</span></span> <span data-ttu-id="793ed-133">您可以在應用程式的初始安裝期間將 [**MSIDISABLELUAPATCHING**](msidisableluapatching.md) 屬性設定為1，以防止該應用程式的最低許可權修補。</span><span class="sxs-lookup"><span data-stu-id="793ed-133">You can set the [**MSIDISABLELUAPATCHING**](msidisableluapatching.md) property to 1 during the initial installation of an application to prevent least-privilege patching for that application only.</span></span>

<span data-ttu-id="793ed-134">從 Windows Installer 版本3.0 開始，可以使用這項功能。</span><span class="sxs-lookup"><span data-stu-id="793ed-134">This functionality is available beginning with Windows Installer version 3.0.</span></span> <span data-ttu-id="793ed-135"> (UAC) 修補的使用者帳戶控制，在 Windows XP 中被稱為最低許可權的使用者帳戶 (LUA) 修補。</span><span class="sxs-lookup"><span data-stu-id="793ed-135">User Account Control (UAC) patching was called least-privilege user account (LUA) patching in Windows XP.</span></span> <span data-ttu-id="793ed-136">在 Windows 2000 和 Windows Server 2003 上無法使用 LUA 修補。</span><span class="sxs-lookup"><span data-stu-id="793ed-136">LUA patching is not available on Windows 2000 and Windows Server 2003.</span></span>

<span data-ttu-id="793ed-137">如需有關應用程式相容性的詳細資訊，以及如何開發與使用者帳戶控制相容 (UAC) 的應用程式，請參閱 [Microsoft Technet](/previous-versions/windows/it-pro/windows-server-2008-R2-and-2008/cc709691(v=ws.10))上提供的 uac 資訊。</span><span class="sxs-lookup"><span data-stu-id="793ed-137">For more information about application compatibility and developing applications that are compatible with User Account Control (UAC), see the UAC information that is provided on [Microsoft Technet](/previous-versions/windows/it-pro/windows-server-2008-R2-and-2008/cc709691(v=ws.10)).</span></span>

 

 
