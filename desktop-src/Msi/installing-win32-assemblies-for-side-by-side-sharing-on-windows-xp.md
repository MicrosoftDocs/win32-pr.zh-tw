---
description: 以下說明如何建立 Windows Installer 套件來安裝 Win32 元件。
ms.assetid: 1234e904-fc7f-4eb7-8c50-0c959bbf5261
title: 安裝適用于並存共用的 Win32 元件
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: ea72c9bcb7bd85ac38dfc8857030d6b9d6afbf23
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/08/2021
ms.locfileid: "106997937"
---
# <a name="installing-win32-assemblies-for-side-by-side-sharing"></a><span data-ttu-id="b9924-103">安裝適用于並存共用的 Win32 元件</span><span class="sxs-lookup"><span data-stu-id="b9924-103">Installing Win32 Assemblies for Side-by-Side Sharing</span></span>

<span data-ttu-id="b9924-104">以下說明如何建立 Windows Installer 套件來安裝 Win32 元件。</span><span class="sxs-lookup"><span data-stu-id="b9924-104">The following describes how to create a Windows Installer package to install a Win32 assembly.</span></span> <span data-ttu-id="b9924-105">封裝會在 Winsxs 資料夾中安裝並存元件，以供共用應用程式使用。</span><span class="sxs-lookup"><span data-stu-id="b9924-105">The package installs a side-by-side assembly in the Winsxs folder for the shared use of the application.</span></span> <span data-ttu-id="b9924-106">安裝封裝之後，共用的元件可供任何應用程式使用，以指定組件資訊清單檔中元件的相依性。</span><span class="sxs-lookup"><span data-stu-id="b9924-106">After installing the package, the shared assembly is globally available to any application that specifies a dependence on the assembly in an assembly manifest file.</span></span> <span data-ttu-id="b9924-107">安裝程式不會在系統上全域註冊並存元件。</span><span class="sxs-lookup"><span data-stu-id="b9924-107">The installer does not globally register the side-by-side assembly on the system.</span></span>

<span data-ttu-id="b9924-108">請注意，您可以使用 [合併模組](merge-modules.md)安裝共用並存元件。</span><span class="sxs-lookup"><span data-stu-id="b9924-108">Note that you may install shared side-by-side assemblies using [merge modules](merge-modules.md).</span></span>

<span data-ttu-id="b9924-109">繼續之前，您應該瞭解如何撰寫不含元件的 Windows Installer 套件。</span><span class="sxs-lookup"><span data-stu-id="b9924-109">Before continuing you should understand how to author a Windows Installer package without assemblies.</span></span> <span data-ttu-id="b9924-110">如需如何編寫簡單安裝的範例，請參閱 [安裝範例](an-installation-example.md)。</span><span class="sxs-lookup"><span data-stu-id="b9924-110">For an example of how to author a simple installation, see [An Installation Example](an-installation-example.md).</span></span>

<span data-ttu-id="b9924-111">**並存安裝共用元件**</span><span class="sxs-lookup"><span data-stu-id="b9924-111">**To install a shared assembly side-by-side**</span></span>

1.  <span data-ttu-id="b9924-112">定義包含 Win32 元件的 Windows Installer 元件。</span><span class="sxs-lookup"><span data-stu-id="b9924-112">Define a Windows Installer component that includes the Win32 assembly.</span></span> <span data-ttu-id="b9924-113">此元件可能包含應一律隨元件一起安裝或移除的其他資源。</span><span class="sxs-lookup"><span data-stu-id="b9924-113">This component may contain other resources that should always be installed or removed with the assembly.</span></span> <span data-ttu-id="b9924-114">您可以撰寫應用程式的所有其他元件，就像是沒有元件的安裝一樣。</span><span class="sxs-lookup"><span data-stu-id="b9924-114">All the other components of the application can be authored just as for an installation without assemblies.</span></span> <span data-ttu-id="b9924-115">針對包含 Win32 元件的元件，將資料列加入 [元件資料表](component-table.md) 中。</span><span class="sxs-lookup"><span data-stu-id="b9924-115">Add a row to the [Component table](component-table.md) for the component containing the Win32 assembly.</span></span> <span data-ttu-id="b9924-116">輸入此元件程式碼的有效 Windows Installer [GUID](guid.md) 。</span><span class="sxs-lookup"><span data-stu-id="b9924-116">Enter a valid Windows Installer [GUID](guid.md) for this component code.</span></span> <span data-ttu-id="b9924-117">請勿使用資訊清單檔作為此元件的金鑰路徑。</span><span class="sxs-lookup"><span data-stu-id="b9924-117">Do not use the manifest file as the key path for this component.</span></span>
2.  <span data-ttu-id="b9924-118">將資料列加入至 [FeatureComponents 資料表](featurecomponents-table.md) ，以將元件與 Windows Installer 功能系結。</span><span class="sxs-lookup"><span data-stu-id="b9924-118">Add a row to the [FeatureComponents table](featurecomponents-table.md) tying the component to a Windows Installer feature.</span></span> <span data-ttu-id="b9924-119">如需詳細資訊，請參閱 [元件和功能](components-and-features.md)。</span><span class="sxs-lookup"><span data-stu-id="b9924-119">For information see, [Components and Features](components-and-features.md).</span></span> <span data-ttu-id="b9924-120">Windows Installer 的功能應該是可辨識給使用者的應用程式功能部分。</span><span class="sxs-lookup"><span data-stu-id="b9924-120">A Windows Installer feature should be a piece of the application's functionality that is recognizable to a user.</span></span> <span data-ttu-id="b9924-121">當使用者選取這項功能或應用程式發生錯誤時，就會啟動元件。</span><span class="sxs-lookup"><span data-stu-id="b9924-121">The assembly is activated when this feature is selected by a user or faulted in by an application.</span></span> <span data-ttu-id="b9924-122">如果元件定義了額外的功能，請在功能 [資料表](feature-table.md) 中為功能的屬性新增一個額外的資料列。</span><span class="sxs-lookup"><span data-stu-id="b9924-122">If the assembly defines an additional feature, then add an additional row to the [Feature table](feature-table.md) for the feature's attributes.</span></span> <span data-ttu-id="b9924-123">撰寫合併模組時，不需要執行此步驟。</span><span class="sxs-lookup"><span data-stu-id="b9924-123">This step is not needed when authoring a merge module.</span></span>
3.  <span data-ttu-id="b9924-124">針對並存元件，系結和啟用資訊（例如 COM 類別、介面和類型程式庫）會儲存在資訊清單檔中，而不是儲存在登錄中。</span><span class="sxs-lookup"><span data-stu-id="b9924-124">For side-by-side assemblies, binding and activation information, such as COM classes, interfaces, and type libraries, is stored in manifest files rather than the registry.</span></span> <span data-ttu-id="b9924-125">共用的元件會將這項資訊儲存在組件資訊清單中。</span><span class="sxs-lookup"><span data-stu-id="b9924-125">Shared assemblies store this information in an assembly manifest.</span></span> <span data-ttu-id="b9924-126">在支援並存元件的系統上，安裝程式會略過處理 [延伸模組資料表](extension-table.md)、 [動詞資料表](verb-table.md)、 [TypeLib 資料表](typelib-table.md)、 [MIME 資料表](mime-table.md)、 [類別資料表](class-table.md)、 [ProgId 資料表](progid-table.md)和 [AppId 資料表](appid-table.md)中所輸入元件的任何資訊。</span><span class="sxs-lookup"><span data-stu-id="b9924-126">On systems that support side-by-side assemblies, the installer skips processing any information about the component entered in the [Extension table](extension-table.md), [Verb table](verb-table.md), [TypeLib table](typelib-table.md), [MIME table](mime-table.md), [Class table](class-table.md), [ProgId table](progid-table.md), and [AppId table](appid-table.md).</span></span> <span data-ttu-id="b9924-127">您可以在這些資料表中輸入系結和啟用資訊，以供不支援並存元件共用的系統使用。</span><span class="sxs-lookup"><span data-stu-id="b9924-127">Binding and activation information may be entered into these tables for use by systems that do not support side-by-side assembly sharing.</span></span>
4.  <span data-ttu-id="b9924-128">並存安裝不會全域登錄元件，如果在 [SelfReg 資料表](selfreg-table.md)中輸入任何自我註冊資訊，安裝程式會略過自我註冊元件。</span><span class="sxs-lookup"><span data-stu-id="b9924-128">Side-by-side installation does not globally register the assembly, the installer skips self-registering the component if any self-registration information has been entered in the [SelfReg table](selfreg-table.md).</span></span> <span data-ttu-id="b9924-129">您可以在 SelfReg 資料表中輸入自我註冊資訊，以便在不支援並存元件共用的系統上自行註冊元件。</span><span class="sxs-lookup"><span data-stu-id="b9924-129">Self-registration information may be entered into the SelfReg table for self-registration of the component on systems that do not support side-by-side assembly sharing.</span></span>
5.  <span data-ttu-id="b9924-130">在登錄 [資料表](registry-table.md)、 [RemoveRegistry 資料表](removeregistry-table.md)和 [環境資料表](environment-table.md)中，新增任何其他登錄資訊，包括系結和啟用或自我註冊元件。</span><span class="sxs-lookup"><span data-stu-id="b9924-130">Add any other registry information, exclusive of binding and activation or self-registration of the component, to the [Registry table](registry-table.md), [RemoveRegistry table](removeregistry-table.md), and [Environment table](environment-table.md).</span></span>
6.  <span data-ttu-id="b9924-131">因為這是共用的元件，所以不會產生本機檔案。</span><span class="sxs-lookup"><span data-stu-id="b9924-131">Because this is a shared assembly do not generate a .local file.</span></span> <span data-ttu-id="b9924-132">請勿在 [IsolatedComponent 資料表](isolatedcomponent-table.md)中包含此元件的資訊。</span><span class="sxs-lookup"><span data-stu-id="b9924-132">Do not include information for this component in the [IsolatedComponent table](isolatedcomponent-table.md).</span></span> <span data-ttu-id="b9924-133">安裝程式會在支援並存共用的作業系統上，略過此元件的 IsolatedComponent 資料表。</span><span class="sxs-lookup"><span data-stu-id="b9924-133">The installer skips the IsolatedComponent table for this component on operating systems that support side-by-side sharing.</span></span> <span data-ttu-id="b9924-134">如果您希望元件在支援本機檔案的系統上是私用的，請將資訊新增至 IsolatedComponent 資料表。</span><span class="sxs-lookup"><span data-stu-id="b9924-134">Add information to the IsolatedComponent table if you would like the assembly to be private on systems that support .local files.</span></span>
7.  <span data-ttu-id="b9924-135">若要啟用並存共用，必須將 Win32 元件安裝在 Winsxs 資料夾中。</span><span class="sxs-lookup"><span data-stu-id="b9924-135">To enable side-by-side sharing, the Win32 assembly must be installed into the Winsxs folder.</span></span> <span data-ttu-id="b9924-136">這是藉由將元件的 \_ [MsiAssembly 資料表](msiassembly-table.md) 的 File Application 資料行保留為 null 來完成。</span><span class="sxs-lookup"><span data-stu-id="b9924-136">This is accomplished by leaving the File\_Application column of the [MsiAssembly table](msiassembly-table.md) null for the assembly.</span></span> <span data-ttu-id="b9924-137">這會告知安裝程式將元件安裝到 WinSxS 資料夾，而不是元件的資料夾。</span><span class="sxs-lookup"><span data-stu-id="b9924-137">This tells the installer to install the assembly to the WinSxS folder, instead of to the folder of the component.</span></span> <span data-ttu-id="b9924-138">針對包含 Win32 元件的元件，將資料列加入至 [MsiAssembly 資料表](msiassembly-table.md) 。</span><span class="sxs-lookup"><span data-stu-id="b9924-138">Add a row to the [MsiAssembly table](msiassembly-table.md) for the component that contains the Win32 assembly.</span></span> <span data-ttu-id="b9924-139">在 MsiAssembly 資料表的 [屬性] 欄位中輸入1的值，以指定這是 Win32 元件。</span><span class="sxs-lookup"><span data-stu-id="b9924-139">Enter a value of 1 in the Attributes field of the MsiAssembly table to specify that this is a Win32 assembly.</span></span> <span data-ttu-id="b9924-140">若為共用的元件，請將 [檔案 \_ 應用程式] 欄位保留空白。</span><span class="sxs-lookup"><span data-stu-id="b9924-140">For a shared assembly, leave the File\_Application field empty.</span></span> <span data-ttu-id="b9924-141">將 [MsiPublishAssemblies 動作](msipublishassemblies-action.md) 加入至 [InstallExecuteSequence 資料表](installexecutesequence-table.md) 或 [AdvtExecuteSequence 資料表](advtexecutesequence-table.md)。</span><span class="sxs-lookup"><span data-stu-id="b9924-141">Add the [MsiPublishAssemblies action](msipublishassemblies-action.md) to the [InstallExecuteSequence table](installexecutesequence-table.md) or [AdvtExecuteSequence table](advtexecutesequence-table.md).</span></span> <span data-ttu-id="b9924-142">將 [MsiUnpublishAssemblies 動作](msiunpublishassemblies-action.md) 加入至 InstallExecuteSequence 資料表。</span><span class="sxs-lookup"><span data-stu-id="b9924-142">Add the [MsiUnpublishAssemblies action](msiunpublishassemblies-action.md) to the InstallExecuteSequence table.</span></span>
8.  <span data-ttu-id="b9924-143">將資料列加入至元件的 [MsiAssemblyName 資料表](msiassemblyname-table.md) 。</span><span class="sxs-lookup"><span data-stu-id="b9924-143">Add rows to the [MsiAssemblyName table](msiassemblyname-table.md) for the component.</span></span> <span data-ttu-id="b9924-144">針對資訊清單的 assemblyIdentity 區段中指定的每個名稱和值組，各加入一個資料列。</span><span class="sxs-lookup"><span data-stu-id="b9924-144">Add one row for each name and value pair specified in the assemblyIdentity section of the manifest.</span></span> <span data-ttu-id="b9924-145">如需範例，請參閱 [MsiAssemblyName 資料表](msiassemblyname-table.md)。</span><span class="sxs-lookup"><span data-stu-id="b9924-145">For an example, see [MsiAssemblyName table](msiassemblyname-table.md).</span></span>

 

 



