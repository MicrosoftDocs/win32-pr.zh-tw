---
description: 《撰寫條件 &0034 》一節中所述的範例 \# ：請稍候。
ms.assetid: b563e306-6d10-4298-9a71-9e749224ccd2
title: 加入儲存在屬性中的文字
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 1d43910b946db737d2b306d7c75f6683401eee0a
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/07/2021
ms.locfileid: "104386201"
---
# <a name="adding-text-stored-in-a-property"></a><span data-ttu-id="9b688-103">加入儲存在屬性中的文字</span><span class="sxs-lookup"><span data-stu-id="9b688-103">Adding Text Stored in a Property</span></span>

<span data-ttu-id="9b688-104">標題為「撰寫條件式」一節中所述的範例， [請稍候 .。。「訊息方塊](authoring-a-conditional-please-wait-------message-box.md) 會顯示一個對話方塊，其中包含下列文字：「請稍候，磁碟空間的成本已完成」。</span><span class="sxs-lookup"><span data-stu-id="9b688-104">The example described in the section titled [Authoring a Conditional "Please Wait . . . " Message Box](authoring-a-conditional-please-wait-------message-box.md) displays a dialog box with text that reads: "Please wait while disk space costing is completed."</span></span> <span data-ttu-id="9b688-105">只要將 [文字控制項](text-control.md) 放在對話方塊上，然後在 [控制項資料表](control-table.md)的文字資料行中輸入文字字串，就可以完成這項工作。</span><span class="sxs-lookup"><span data-stu-id="9b688-105">This could be done simply by putting a [Text Control](text-control.md) on the dialog box and entering the text string into the Text column of the [Control table](control-table.md).</span></span> <span data-ttu-id="9b688-106">在此情況下，字型樣式的相關資訊必須內嵌在字串中。</span><span class="sxs-lookup"><span data-stu-id="9b688-106">In this case, the information about the font style must be embedded in the string.</span></span> <span data-ttu-id="9b688-107">作者必須在字元字串前面加上 {style} 來設定字型和字型樣式 \\ \*\*。</span><span class="sxs-lookup"><span data-stu-id="9b688-107">The author must set the font and font style by prefixing the character string with {\\*style*}.</span></span> <span data-ttu-id="9b688-108">其中 *style* 是在文字文字 [資料表](textstyle-table.md)的文字資料行中所列的字型樣式識別碼。</span><span class="sxs-lookup"><span data-stu-id="9b688-108">Where *style* is a font style identifier listed in the TextStyle column of the [TextStyle table](textstyle-table.md).</span></span> <span data-ttu-id="9b688-109">在 [安裝範例](an-installation-example.md)中，會說明此新增文字的方法數次。</span><span class="sxs-lookup"><span data-stu-id="9b688-109">This method of adding text is illustrated several times in [An Installation Example](an-installation-example.md).</span></span>

<span data-ttu-id="9b688-110">使用者介面的作者也可以將文字儲存在屬性中。</span><span class="sxs-lookup"><span data-stu-id="9b688-110">An author of a user interface can also store text in a property.</span></span> <span data-ttu-id="9b688-111">下列範例將說明這一點，並顯示如何使用事件顯示替代文字字串。</span><span class="sxs-lookup"><span data-stu-id="9b688-111">The following example illustrates this and shows how ControlEvents can be used to display alternative text strings.</span></span>

<span data-ttu-id="9b688-112">當背景工作正在執行時，此範例中的目標會再次出現 **WaitForCosting** 對話方塊。</span><span class="sxs-lookup"><span data-stu-id="9b688-112">The objective in this example is again to put up a **WaitForCosting** dialog box while a background task is running.</span></span> <span data-ttu-id="9b688-113">與新案例的差異在於，如果使用者取消 [ **WaitForCosting** ] 對話方塊，然後嘗試在背景工作第二次完成之前啟動控制項，則 [ **WaitForCosting** ] 方塊會再次顯示替代訊息：「磁碟空間的成本仍在執行中。</span><span class="sxs-lookup"><span data-stu-id="9b688-113">The difference with the new scenario is that if the user cancels the **WaitForCosting** dialog box and then tries to activate the control before the background task has finished a second time, the **WaitForCosting** box reappears displaying an alternative message: "Disk space costing is still running.</span></span> <span data-ttu-id="9b688-114">您可以繼續等候，或返回主要選取方塊來結束此順序。」</span><span class="sxs-lookup"><span data-stu-id="9b688-114">You can continue to wait or return to the main selection box to exit this sequence."</span></span>

<span data-ttu-id="9b688-115">**顯示顯示替代訊息的 [請稍候] 對話方塊**</span><span class="sxs-lookup"><span data-stu-id="9b688-115">**To display a "Please Wait" dialog box that displays alternative messages**</span></span>

1.  <span data-ttu-id="9b688-116">首先，將 [條件式 **WaitForCosting** ] 對話方塊新增至選取專案對話方塊，如 [撰寫條件式「請稍候」所述：] 訊息方塊](authoring-a-conditional-please-wait-------message-box.md)。</span><span class="sxs-lookup"><span data-stu-id="9b688-116">Begin by adding a conditional **WaitForCosting** dialog box to a Selection dialog box as described in [Authoring a Conditional "Please Wait . . . " Message Box](authoring-a-conditional-please-wait-------message-box.md).</span></span>
2.  <span data-ttu-id="9b688-117">藉由在 [控制資料表](control-table.md)中撰寫記錄，將 [文字控制項](text-control.md)放在 [ **WaitForCosting** ] 對話方塊上。</span><span class="sxs-lookup"><span data-stu-id="9b688-117">Put a [Text Control](text-control.md) on the **WaitForCosting** dialog box by authoring a record in the [Control table](control-table.md).</span></span> <span data-ttu-id="9b688-118">在對話方塊資料行中，輸入 **WaitForCosting** 對話方塊的識別碼 \_ 。</span><span class="sxs-lookup"><span data-stu-id="9b688-118">Enter the identifier of the **WaitForCosting** dialog box into the Dialog\_ column.</span></span> <span data-ttu-id="9b688-119">在控制項資料行中輸入文字控制項的識別碼。</span><span class="sxs-lookup"><span data-stu-id="9b688-119">Enter the identifier of the Text control into the Control column.</span></span> <span data-ttu-id="9b688-120">將控制項的類型指定為類型資料行中的文字。</span><span class="sxs-lookup"><span data-stu-id="9b688-120">Specify the type of control as Text in the Type column.</span></span>
3.  <span data-ttu-id="9b688-121">在[控制資料表](control-table.md)的 X 和 Y 資料行中輸入控制項左上角的水準和垂直座標，以指定文字控制項的[位置控制項屬性](position-control-attribute.md)。</span><span class="sxs-lookup"><span data-stu-id="9b688-121">Specify the [Position control attribute](position-control-attribute.md) for the text control by entering the horizontal and vertical coordinates of the control's upper left corner in the X and Y columns of the [Control table](control-table.md).</span></span> <span data-ttu-id="9b688-122">使用圖元作為距離單位。</span><span class="sxs-lookup"><span data-stu-id="9b688-122">Use pixels as distance units.</span></span>
4.  <span data-ttu-id="9b688-123">在 [控制資料表](control-table.md)的 [寬度] 和 [高度] 資料行中輸入這些維度，以指定文字控制項的寬度和高度。</span><span class="sxs-lookup"><span data-stu-id="9b688-123">Specify the width and height of the text control by entering these dimensions into the Width and Height columns of the [Control table](control-table.md).</span></span> <span data-ttu-id="9b688-124">使用圖元作為長度單位。</span><span class="sxs-lookup"><span data-stu-id="9b688-124">Use pixels as length units.</span></span>
5.  <span data-ttu-id="9b688-125">控制資料表的下一個資料行的屬性和控制 \_ 不會影響文字控制項，在此情況下可以保留空白。</span><span class="sxs-lookup"><span data-stu-id="9b688-125">The Property and Control\_Next columns of the Control table do not affect Text controls and can be left blank in this case.</span></span>
6.  <span data-ttu-id="9b688-126">指定與位旗標相關聯之文字控制項的控制項屬性。</span><span class="sxs-lookup"><span data-stu-id="9b688-126">Specify the control attributes for the Text control that are associated with bit flags.</span></span> <span data-ttu-id="9b688-127">將個別位值加在一起，然後將總計輸入控制資料表的 [屬性] 資料行中。</span><span class="sxs-lookup"><span data-stu-id="9b688-127">Add the individual bit values together and enter the total into the Attributes column of the Control table.</span></span> <span data-ttu-id="9b688-128">這些是 [可見](visible-control-attribute.md)、 [凹陷](sunken-control-attribute.md)、 [啟用](enabled-control-attribute.md)、 [透明](transparent-control-attribute.md)、 [NoWrap](nowrap-control-attribute.md)和 [NoPrefix](noprefix-control-attribute.md) 控制項屬性。</span><span class="sxs-lookup"><span data-stu-id="9b688-128">These are the [Visible](visible-control-attribute.md), [Sunken](sunken-control-attribute.md), [Enabled](enabled-control-attribute.md), [Transparent](transparent-control-attribute.md), [NoWrap](nowrap-control-attribute.md), and [NoPrefix](noprefix-control-attribute.md) control attributes.</span></span> <span data-ttu-id="9b688-129">在不透明背景上顯示文字控制項的位組合，其中換行文字為0，因此輸入0或將 [屬性] 資料行保留空白。</span><span class="sxs-lookup"><span data-stu-id="9b688-129">The combination of bits that display a text control on an opaque background, with wrapping text is 0, therefore enter 0 or leave the Attributes column blank.</span></span>
7.  <span data-ttu-id="9b688-130">控制資料表的文字資料行可以保留空白。</span><span class="sxs-lookup"><span data-stu-id="9b688-130">The Text column of the Control table can be left blank.</span></span> <span data-ttu-id="9b688-131">文字控制項會顯示文字字串，也就是 [文字](text-control-attribute.md) 控制項屬性的值。</span><span class="sxs-lookup"><span data-stu-id="9b688-131">The Text control displays the text string that is the value of the [Text](text-control-attribute.md) control attribute.</span></span> <span data-ttu-id="9b688-132">設定這個屬性的方法會在此程式的後續步驟中描述。</span><span class="sxs-lookup"><span data-stu-id="9b688-132">The method for setting this attribute is described in subsequent steps of this procedure.</span></span>
8.  <span data-ttu-id="9b688-133">在 [屬性資料表](property-table.md) 中加入記錄，以定義 FirstMessage 訊息屬性。</span><span class="sxs-lookup"><span data-stu-id="9b688-133">Add a record in the [Property table](property-table.md) to define the FirstMessage message property.</span></span> <span data-ttu-id="9b688-134">這個屬性是一個字串，其中包含第一個訊息的字型樣式和文字。</span><span class="sxs-lookup"><span data-stu-id="9b688-134">This property is a string containing the font style and text for the first message.</span></span> <span data-ttu-id="9b688-135">在 [屬性] 資料行中輸入名稱 FirstMessage。</span><span class="sxs-lookup"><span data-stu-id="9b688-135">Enter the name FirstMessage in the Property column.</span></span> <span data-ttu-id="9b688-136">在 [值] 欄中，輸入字串： "{ \\ WaitStyle} 請稍候，正在完成磁碟空間的成本。"</span><span class="sxs-lookup"><span data-stu-id="9b688-136">In the Value column, enter the string: "{\\WaitStyle}Please wait while disk space costing is completed."</span></span> <span data-ttu-id="9b688-137">其中 WaitStyle 是文字文字 [資料表](textstyle-table.md)之文字資料行中所列其中一個字型樣式的識別碼。</span><span class="sxs-lookup"><span data-stu-id="9b688-137">Where WaitStyle is an identifier for one of the font styles listed in the TextStyle column of the [TextStyle table](textstyle-table.md).</span></span>
9.  <span data-ttu-id="9b688-138">在 [屬性資料表](property-table.md) 中加入記錄，以定義 SecondMessage 訊息屬性。</span><span class="sxs-lookup"><span data-stu-id="9b688-138">Add a record in the [Property table](property-table.md) to define the SecondMessage message property.</span></span> <span data-ttu-id="9b688-139">這個屬性是一個字串，其中包含第二個訊息的字型樣式和文字。</span><span class="sxs-lookup"><span data-stu-id="9b688-139">This property is a string containing the font style and text for the second message.</span></span> <span data-ttu-id="9b688-140">在 [屬性] 資料行中輸入名稱 SecondMessage。</span><span class="sxs-lookup"><span data-stu-id="9b688-140">Enter the name SecondMessage in the Property column.</span></span> <span data-ttu-id="9b688-141">在 [值] 資料行中，輸入字串： "{ \\ WaitStyle} 磁碟空間的成本仍在執行中。</span><span class="sxs-lookup"><span data-stu-id="9b688-141">In the Value column enter the string: "{\\WaitStyle}Disk space costing is still running.</span></span> <span data-ttu-id="9b688-142">您可以繼續等候，或返回主要選取方塊來結束此順序。」</span><span class="sxs-lookup"><span data-stu-id="9b688-142">You can continue to wait or return to the main selection box to exit this sequence."</span></span>
10. <span data-ttu-id="9b688-143">在 [屬性資料表](property-table.md) 中加入記錄，以定義 WaitMessage 訊息屬性。</span><span class="sxs-lookup"><span data-stu-id="9b688-143">Add a record in the [Property table](property-table.md) to define the WaitMessage message property.</span></span> <span data-ttu-id="9b688-144">這個屬性是一個字串，其中包含 **WaitForCosting** 對話方塊中顯示之訊息的字型樣式和文字（如果使用者嘗試在完成成本之前啟用推播按鈕）。</span><span class="sxs-lookup"><span data-stu-id="9b688-144">This property is a string containing the font style and text for the message displayed in the **WaitForCosting** dialog box if the user tries to activate a push button before costing is completed.</span></span> <span data-ttu-id="9b688-145">在 [屬性] 資料行中輸入名稱 WaitMessage。</span><span class="sxs-lookup"><span data-stu-id="9b688-145">Enter the name WaitMessage in the Property column.</span></span> <span data-ttu-id="9b688-146">在屬性資料表的 [值] 資料行中，輸入： FirstMessage。</span><span class="sxs-lookup"><span data-stu-id="9b688-146">In the Value column of the Property table enter: FirstMessage.</span></span>
11. <span data-ttu-id="9b688-147">將 [SetProperty ControlEvent](setproperty-controlevent.md) 新增至 [ControlEvent 資料表](controlevent-table.md) ，每次開啟 **新的選取** 對話方塊時，就會將 WaitMessage 初始化為 FirstMessage。</span><span class="sxs-lookup"><span data-stu-id="9b688-147">Add a [SetProperty ControlEvent](setproperty-controlevent.md) to the [ControlEvent table](controlevent-table.md) that initializes WaitMessage to FirstMessage each time a **New Selection** dialog box opens.</span></span> <span data-ttu-id="9b688-148">在對話方塊的 [選取範圍] 對話方塊中，輸入對話方塊的識別碼，此對話方塊位於對話方塊資料行中 \_ 。</span><span class="sxs-lookup"><span data-stu-id="9b688-148">Enter the identifier for the dialog box that comes just before the Selection dialog in the dialog box sequence into the Dialog\_ column.</span></span> <span data-ttu-id="9b688-149">在此對話方塊上輸入控制項的識別碼，此對話方塊可用來開啟 [選取範圍] 對話方塊至控制項資料 \_ 行。</span><span class="sxs-lookup"><span data-stu-id="9b688-149">Enter the identifier for the control on this dialog box used to open the Selection dialog box into the Control\_ column.</span></span> <span data-ttu-id="9b688-150">\[ \] 在事件資料行中輸入 WaitMessage。</span><span class="sxs-lookup"><span data-stu-id="9b688-150">Enter \[WaitMessage\] into the Event column.</span></span> <span data-ttu-id="9b688-151">\[ \] 在 [引數] 資料行中輸入 FirstMessage。</span><span class="sxs-lookup"><span data-stu-id="9b688-151">Enter \[FirstMessage\] into the Argument column.</span></span> <span data-ttu-id="9b688-152">在 [條件] 資料行中輸入1，並將 [排序] 資料行保留空白。</span><span class="sxs-lookup"><span data-stu-id="9b688-152">Enter 1 into the Condition column and leave the Ordering column blank.</span></span>
12. <span data-ttu-id="9b688-153">將 [SetProperty ControlEvent](setproperty-controlevent.md) 新增至 [ControlEvent 資料表](controlevent-table.md) ，以將 Waitmessage 設定為 SecondMessage。如果使用者在完成磁碟空間的成本之前關閉 **WaitForCosting** 對話方塊。</span><span class="sxs-lookup"><span data-stu-id="9b688-153">Add a [SetProperty ControlEvent](setproperty-controlevent.md) to the [ControlEvent table](controlevent-table.md) that sets Waitmessage to SecondMessage if the user closes the **WaitForCosting** dialog box before disk space costing has completed.</span></span> <span data-ttu-id="9b688-154">在對話方塊資料行中，輸入 **WaitForCosting** 對話方塊的識別碼 \_ 。</span><span class="sxs-lookup"><span data-stu-id="9b688-154">Enter the identifier for the **WaitForCosting** dialog box into the Dialog\_ column.</span></span> <span data-ttu-id="9b688-155">在控制項資料行中輸入文字控制項的識別碼 \_ 。</span><span class="sxs-lookup"><span data-stu-id="9b688-155">Enter the identifier for the Text control into the Control\_ column.</span></span> <span data-ttu-id="9b688-156">\[ \] 在事件資料行中輸入 WaitMessage。</span><span class="sxs-lookup"><span data-stu-id="9b688-156">Enter \[WaitMessage\] into the Event column.</span></span> <span data-ttu-id="9b688-157">\[ \] 在 [引數] 資料行中輸入 SecondMessage。</span><span class="sxs-lookup"><span data-stu-id="9b688-157">Enter \[SecondMessage\] into the Argument column.</span></span> <span data-ttu-id="9b688-158">在 [條件] 資料行中輸入 NOT [**CostingComplete**](costingcomplete.md) ，並將 [排序] 資料行保留空白。</span><span class="sxs-lookup"><span data-stu-id="9b688-158">Enter NOT [**CostingComplete**](costingcomplete.md) into the Condition column and leave the Ordering column blank.</span></span>
13. <span data-ttu-id="9b688-159">下列步驟會將文字控制項屬性連結至 ControlEvent，以產生 **WaitForCosting** 對話方塊。</span><span class="sxs-lookup"><span data-stu-id="9b688-159">The following step links the Text control attribute to the ControlEvent that spawns the **WaitForCosting** dialog box.</span></span> <span data-ttu-id="9b688-160">這會讓安裝程式在每次使用者開啟 [ **WaitForCosting** ] 對話方塊時，將 WaitMessage 屬性的值傳遞給文字控制項屬性。</span><span class="sxs-lookup"><span data-stu-id="9b688-160">This causes the installer to pass the value of the WaitMessage property to the Text control attribute each time the user opens a **WaitForCosting** dialog box.</span></span>
14. <span data-ttu-id="9b688-161">將文字控制項的文字控制項屬性訂閱至 [SpawnWaitDialog ControlEvent](spawnwaitdialog-controlevent.md) ，藉由將記錄加入 [EventMapping 資料表](eventmapping-table.md)來開啟 [ **WaitForCosting** ] 對話方塊。</span><span class="sxs-lookup"><span data-stu-id="9b688-161">Subscribe the Text control attribute of the Text control to the [SpawnWaitDialog ControlEvent](spawnwaitdialog-controlevent.md) that opens the **WaitForCosting** dialog box by adding a record to the [EventMapping table](eventmapping-table.md).</span></span> <span data-ttu-id="9b688-162">在對話方塊資料行中，輸入 **WaitForCosting** 對話方塊的識別碼 \_ 。</span><span class="sxs-lookup"><span data-stu-id="9b688-162">Enter the identifier for the **WaitForCosting** dialog box in the Dialog\_ column.</span></span> <span data-ttu-id="9b688-163">在控制項資料行中輸入文字控制項的識別碼 \_ 。</span><span class="sxs-lookup"><span data-stu-id="9b688-163">Enter the identifier for the Text control into the Control\_ column.</span></span> <span data-ttu-id="9b688-164">在事件資料行中輸入 SpawnWaitDialog。</span><span class="sxs-lookup"><span data-stu-id="9b688-164">Enter SpawnWaitDialog into the Event column.</span></span> <span data-ttu-id="9b688-165">在 EventMapping 資料表的 [屬性] 資料行中輸入文字（文字控制項屬性的識別碼）。</span><span class="sxs-lookup"><span data-stu-id="9b688-165">Enter Text, the identifier for the Text control attribute, into the Attribute column of the EventMapping table.</span></span>

 

 



