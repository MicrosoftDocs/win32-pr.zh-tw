---
description: 安裝套件的作者應該包含升級其 .msi 檔案中的資訊，以確保其安裝套件可以利用 Microsoft Windows Installer 所提供的完整升級功能。
ms.assetid: 88bb2709-a1bf-4140-a145-ae6bee85dde1
title: 準備應用程式以進行未來的主要升級
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c1e0dc9ccbee10becc39274e91d2fedeb3707028
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/07/2021
ms.locfileid: "106977871"
---
# <a name="preparing-an-application-for-future-major-upgrades"></a><span data-ttu-id="07abe-103">準備應用程式以進行未來的主要升級</span><span class="sxs-lookup"><span data-stu-id="07abe-103">Preparing an Application for Future Major Upgrades</span></span>

<span data-ttu-id="07abe-104">安裝套件的作者應該包含升級其 .msi 檔案中的資訊，以確保其安裝套件可以利用 Microsoft Windows Installer 所提供的完整升級功能。</span><span class="sxs-lookup"><span data-stu-id="07abe-104">Authors of installation packages should include upgrading information in their .msi files to ensure that their installation package can take advantage of the full upgrading functionality available with the Microsoft Windows Installer.</span></span>

<span data-ttu-id="07abe-105">每個應用程式或應用程式套件都應該指派 [**UpgradeCode**](upgradecode.md) 屬性、 [**ProductVersion**](productversion.md) 屬性和 [**ProductLanguage**](productlanguage.md) 屬性。</span><span class="sxs-lookup"><span data-stu-id="07abe-105">Every application, or suite of applications, should be assigned an [**UpgradeCode**](upgradecode.md) Property, [**ProductVersion**](productversion.md) Property, and [**ProductLanguage**](productlanguage.md) Property.</span></span> <span data-ttu-id="07abe-106">[**UpgradeCode**](upgradecode.md)屬性指出由相同產品的不同版本和不同語言版本所組成的一系列相關應用程式。</span><span class="sxs-lookup"><span data-stu-id="07abe-106">The [**UpgradeCode**](upgradecode.md) property indicates a family of related applications consisting of different versions and different language versions of the same product.</span></span> <span data-ttu-id="07abe-107">如需使用 [**UpgradeCode**](upgradecode.md) 屬性的詳細資訊，請參閱 [使用 UpgradeCode](using-an-upgradecode.md)。</span><span class="sxs-lookup"><span data-stu-id="07abe-107">For more information about using the [**UpgradeCode**](upgradecode.md) property, see [Using an UpgradeCode](using-an-upgradecode.md).</span></span>

<span data-ttu-id="07abe-108">**準備應用程式以進行未來的主要升級**</span><span class="sxs-lookup"><span data-stu-id="07abe-108">**Preparing an application for future major upgrades**</span></span>

1.  <span data-ttu-id="07abe-109">判斷應用程式的新套件代碼值。</span><span class="sxs-lookup"><span data-stu-id="07abe-109">Determine a new package code value for the application.</span></span> <span data-ttu-id="07abe-110">如需封裝程式碼的詳細資訊，請參閱 [封裝程式碼](package-codes.md)。</span><span class="sxs-lookup"><span data-stu-id="07abe-110">For more information about package codes, see [Package Codes](package-codes.md).</span></span> <span data-ttu-id="07abe-111">在 [摘要資訊資料流程](summary-information-stream.md)的 [[**修訂編號摘要**](revision-number-summary.md)] 屬性中，輸入新的封裝程式碼。</span><span class="sxs-lookup"><span data-stu-id="07abe-111">Enter the new package code into the [**Revision Number Summary**](revision-number-summary.md) Property of the [Summary Information Stream](summary-information-stream.md).</span></span>
2.  <span data-ttu-id="07abe-112">判斷應用程式的新 [**ProductCode**](productcode.md) 屬性。</span><span class="sxs-lookup"><span data-stu-id="07abe-112">Determine a new [**ProductCode**](productcode.md) property for the application.</span></span> <span data-ttu-id="07abe-113">如需詳細資訊，請參閱 [變更產品代碼](changing-the-product-code.md) 。</span><span class="sxs-lookup"><span data-stu-id="07abe-113">See [Changing the Product Code](changing-the-product-code.md) for more information.</span></span> <span data-ttu-id="07abe-114">在 [屬性資料表](property-table.md)中輸入 [**ProductCode**](productcode.md)和其值。</span><span class="sxs-lookup"><span data-stu-id="07abe-114">Enter [**ProductCode**](productcode.md) and its value into the [Property table](property-table.md).</span></span>
3.  <span data-ttu-id="07abe-115">判斷應用程式的版本與 [**ProductVersion**](productversion.md) 屬性。</span><span class="sxs-lookup"><span data-stu-id="07abe-115">Determine the application's version and the [**ProductVersion**](productversion.md) property.</span></span> <span data-ttu-id="07abe-116">[**ProductVersion**](productversion.md)應該會隨著應用程式的每個新版本而增加。</span><span class="sxs-lookup"><span data-stu-id="07abe-116">The [**ProductVersion**](productversion.md) should increase with each new version of the application.</span></span> <span data-ttu-id="07abe-117">請注意，安裝程式只會使用產品版本的前三個欄位。</span><span class="sxs-lookup"><span data-stu-id="07abe-117">Note that the installer uses only the first three fields of the product version.</span></span> <span data-ttu-id="07abe-118">如果您在產品版本中包含第四個欄位，安裝程式會忽略第四個欄位。</span><span class="sxs-lookup"><span data-stu-id="07abe-118">If you include a fourth field in your product version, the installer ignores the fourth field.</span></span> <span data-ttu-id="07abe-119">在屬性資料表中輸入 [**ProductVersion**](productversion.md) 和其值。</span><span class="sxs-lookup"><span data-stu-id="07abe-119">Enter [**ProductVersion**](productversion.md) and its value into the Property table.</span></span>
4.  <span data-ttu-id="07abe-120">判斷封裝的語言與 [**ProductLanguage**](productlanguage.md) 屬性。</span><span class="sxs-lookup"><span data-stu-id="07abe-120">Determine the language of the package and the [**ProductLanguage**](productlanguage.md) property.</span></span> <span data-ttu-id="07abe-121">這個屬性的值必須是數位語言識別項 (LANGID) 。</span><span class="sxs-lookup"><span data-stu-id="07abe-121">The value of this property must be a numeric language identifier (LANGID).</span></span> <span data-ttu-id="07abe-122">在 [屬性資料表](property-table.md)中輸入 [**ProductLanguage**](productlanguage.md)和其值。</span><span class="sxs-lookup"><span data-stu-id="07abe-122">Enter [**ProductLanguage**](productlanguage.md) and its value into the [Property table](property-table.md).</span></span> <span data-ttu-id="07abe-123">請注意， [FindRelatedProducts 動作](findrelatedproducts-action.md) 會使用 [**MsiGetProductInfo**](/windows/desktop/api/Msi/nf-msi-msigetproductinfoa)所傳回的語言。</span><span class="sxs-lookup"><span data-stu-id="07abe-123">Note that the [FindRelatedProducts action](findrelatedproducts-action.md) uses the language returned by [**MsiGetProductInfo**](/windows/desktop/api/Msi/nf-msi-msigetproductinfoa).</span></span> <span data-ttu-id="07abe-124">若要讓 FindRelatedProducts 正常運作，封裝作者必須確定在屬性工作表中，將 [**ProductLanguage**](productlanguage.md) 屬性設定為 [ [**範本摘要**](template-summary.md) ] 屬性中也列出的語言。</span><span class="sxs-lookup"><span data-stu-id="07abe-124">For FindRelatedProducts to work correctly, the package author must be sure that the [**ProductLanguage**](productlanguage.md) property is set in the Property table to a language that is also listed in the [**Template Summary**](template-summary.md) property.</span></span>
5.  <span data-ttu-id="07abe-125">如果您要撰寫產品第一版的安裝套件，請使用新的 [**UpgradeCode**](upgradecode.md)。</span><span class="sxs-lookup"><span data-stu-id="07abe-125">If you are authoring an installation package for the first version of your product, use a new [**UpgradeCode**](upgradecode.md).</span></span> <span data-ttu-id="07abe-126">如果您的套件適用于現有產品的較新版本，或與不同語言的現有產品版本相同，請使用現有產品的相同 [**UpgradeCode**](upgradecode.md) 。</span><span class="sxs-lookup"><span data-stu-id="07abe-126">If your package is intended for a newer version of an existing product, or is the same version as an existing product in a different language, use the same [**UpgradeCode**](upgradecode.md) as the existing product.</span></span> <span data-ttu-id="07abe-127">沒有兩個具有相同 [**ProductVersion**](productversion.md) 和相同 [**ProductLanguage**](productlanguage.md) 的產品可以有相同的 [**UpgradeCode**](upgradecode.md)，除非其中一個是另一個的 [小型更新](small-updates.md) 。</span><span class="sxs-lookup"><span data-stu-id="07abe-127">No two products with the same [**ProductVersion**](productversion.md) and the same [**ProductLanguage**](productlanguage.md) can have the same [**UpgradeCode**](upgradecode.md), unless one is a [small update](small-updates.md) of the other.</span></span>
6.  <span data-ttu-id="07abe-128">[**UpgradeCode**](upgradecode.md)具有 [GUID](guid.md)的格式。</span><span class="sxs-lookup"><span data-stu-id="07abe-128">The [**UpgradeCode**](upgradecode.md) has the format of a [GUID](guid.md).</span></span> <span data-ttu-id="07abe-129">在屬性資料表中輸入 [**UpgradeCode**](upgradecode.md) GUID。</span><span class="sxs-lookup"><span data-stu-id="07abe-129">Enter the [**UpgradeCode**](upgradecode.md) GUID into the Property table.</span></span>

<span data-ttu-id="07abe-130">如需詳細資訊，請參閱 [防止舊套件安裝在較新的版本上](preventing-an-old-package-from-installing-over-a-newer-version.md)。</span><span class="sxs-lookup"><span data-stu-id="07abe-130">For more information, see [Preventing an Old Package from Installing Over a Newer Version](preventing-an-old-package-from-installing-over-a-newer-version.md).</span></span>

 

 



