---
description: Windows Installer 開發人員 Windows SDK 元件中提供了 VBScript 檔案 WiPolicy.vbs。 此範例說明如何使用腳本來管理系統策略。 系統管理員可以使用群組原則編輯器 (GPE) 來設定原則。
ms.assetid: 17cfed46-503f-4124-9f0e-1655fda153d0
title: 管理原則設定
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: a86684e75e09fa0a588c2d1d0d999488d6e89fae
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/07/2021
ms.locfileid: "106973499"
---
# <a name="manage-policy-settings"></a><span data-ttu-id="d07ef-105">管理原則設定</span><span class="sxs-lookup"><span data-stu-id="d07ef-105">Manage Policy Settings</span></span>

<span data-ttu-id="d07ef-106">[Windows Installer 開發人員 Windows SDK 元件](platform-sdk-components-for-windows-installer-developers.md)中提供了 VBScript 檔案 WiPolicy.vbs。</span><span class="sxs-lookup"><span data-stu-id="d07ef-106">The VBScript file WiPolicy.vbs is provided in the [Windows SDK Components for Windows Installer Developers](platform-sdk-components-for-windows-installer-developers.md).</span></span> <span data-ttu-id="d07ef-107">此範例說明如何使用腳本來管理 [系統原則](system-policy.md)。</span><span class="sxs-lookup"><span data-stu-id="d07ef-107">This sample shows how script can be used to manage [system policy](system-policy.md).</span></span> <span data-ttu-id="d07ef-108">系統管理員可以使用群組原則編輯器 (GPE) 來設定原則。</span><span class="sxs-lookup"><span data-stu-id="d07ef-108">Policy can be configured by an administrator using the Group Policy Editor (GPE).</span></span>

<span data-ttu-id="d07ef-109">此範例示範 Windows Installer 原則。</span><span class="sxs-lookup"><span data-stu-id="d07ef-109">This sample demonstrates the Windows Installer policies.</span></span>

<span data-ttu-id="d07ef-110">使用此範例需要 Windows Script Host 的 CScript.exe 或 WScript.exe 版本。</span><span class="sxs-lookup"><span data-stu-id="d07ef-110">Using this sample requires the CScript.exe or WScript.exe version of Windows Script Host.</span></span> <span data-ttu-id="d07ef-111">若要使用 CScript.exe 執行此範例，請使用下列語法在命令提示字元中輸入命令。</span><span class="sxs-lookup"><span data-stu-id="d07ef-111">To use CScript.exe to run this sample, type a command at the command prompt using the following syntax.</span></span> <span data-ttu-id="d07ef-112">如果第一個引數是/？，則會顯示說明</span><span class="sxs-lookup"><span data-stu-id="d07ef-112">Help is displayed if the first argument is /?</span></span> <span data-ttu-id="d07ef-113">或者，如果指定的引數太少。</span><span class="sxs-lookup"><span data-stu-id="d07ef-113">or if too few arguments are specified.</span></span> <span data-ttu-id="d07ef-114">若要將輸出重新導向至檔案，請以 VBS > 路徑結束命令列 \[  \] 。</span><span class="sxs-lookup"><span data-stu-id="d07ef-114">To redirect the output to a file, end the command line with VBS > \[*path to file*\].</span></span> <span data-ttu-id="d07ef-115">此範例會傳回值0表示成功，如果叫用說明，則傳回 1; 如果腳本失敗，則傳回2。</span><span class="sxs-lookup"><span data-stu-id="d07ef-115">The sample returns a value of 0 for success, 1 if help is invoked, and 2 if the script fails.</span></span>

<span data-ttu-id="d07ef-116">**cscript WiPolicy.vbs \[ 原則 \] \[ 值\]**</span><span class="sxs-lookup"><span data-stu-id="d07ef-116">**cscript WiPolicy.vbs \[policy\]\[value\]**</span></span>

<span data-ttu-id="d07ef-117">如果在命令列上未指定任何引數，此範例會傳回目前的原則設定。</span><span class="sxs-lookup"><span data-stu-id="d07ef-117">If no arguments are specified on the command line, the sample returns the current policy settings.</span></span> <span data-ttu-id="d07ef-118">使用下列識別碼代碼指定要設定的原則。</span><span class="sxs-lookup"><span data-stu-id="d07ef-118">Specify the policy to be set by using the following identifier codes.</span></span> <span data-ttu-id="d07ef-119">指定原則的新值。</span><span class="sxs-lookup"><span data-stu-id="d07ef-119">Specify the new value for the policy.</span></span> <span data-ttu-id="d07ef-120">若要傳回原則的目前值，請將值指定為空字串 ""。</span><span class="sxs-lookup"><span data-stu-id="d07ef-120">To return the current value of a policy, specify an empty string "" for the value.</span></span>



| <span data-ttu-id="d07ef-121">CODE</span><span class="sxs-lookup"><span data-stu-id="d07ef-121">CODE</span></span> | <span data-ttu-id="d07ef-122">Description</span><span class="sxs-lookup"><span data-stu-id="d07ef-122">Description</span></span>                                                                                                                                  |
|------|----------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="d07ef-123">LM</span><span class="sxs-lookup"><span data-stu-id="d07ef-123">LM</span></span>   | <span data-ttu-id="d07ef-124">記錄模式。</span><span class="sxs-lookup"><span data-stu-id="d07ef-124">Logging modes.</span></span> <span data-ttu-id="d07ef-125">如需詳細資訊，請參閱 [記錄](logging.md) 。</span><span class="sxs-lookup"><span data-stu-id="d07ef-125">For more information, see [Logging](logging.md) .</span></span>                                                                            |
| <span data-ttu-id="d07ef-126">DO</span><span class="sxs-lookup"><span data-stu-id="d07ef-126">DO</span></span>   | <span data-ttu-id="d07ef-127">Debug 模式。</span><span class="sxs-lookup"><span data-stu-id="d07ef-127">Debug modes.</span></span> <span data-ttu-id="d07ef-128">如需詳細資訊，請參閱 [Debug](debug.md)。</span><span class="sxs-lookup"><span data-stu-id="d07ef-128">For more information, see [Debug](debug.md).</span></span>                                                                                   |
| <span data-ttu-id="d07ef-129">DI</span><span class="sxs-lookup"><span data-stu-id="d07ef-129">DI</span></span>   | <span data-ttu-id="d07ef-130">停用 Windows Installer 模式。</span><span class="sxs-lookup"><span data-stu-id="d07ef-130">Disable Windows Installer mode.</span></span> <span data-ttu-id="d07ef-131">如需詳細資訊，請參閱 [DisableMsi](disablemsi.md)。</span><span class="sxs-lookup"><span data-stu-id="d07ef-131">For more information, see [DisableMsi](disablemsi.md).</span></span>                                                      |
| <span data-ttu-id="d07ef-132">WT.</span><span class="sxs-lookup"><span data-stu-id="d07ef-132">WT</span></span>   | <span data-ttu-id="d07ef-133">在沒有活動的情況下，以秒為單位的等候時間。</span><span class="sxs-lookup"><span data-stu-id="d07ef-133">Wait timeout in seconds in case of no activity.</span></span> <span data-ttu-id="d07ef-134">**HKLM** \\**軟體** \\**原則** \\**Microsoft** \\**Windows** \\**安裝程式** \\**Timeout**</span><span class="sxs-lookup"><span data-stu-id="d07ef-134">**HKLM**\\**SoftWare**\\**Policies**\\**Microsoft**\\**Windows**\\**Installer**\\**Timeout**</span></span> |
| <span data-ttu-id="d07ef-135">DB</span><span class="sxs-lookup"><span data-stu-id="d07ef-135">DB</span></span>   | <span data-ttu-id="d07ef-136">停用使用者流覽來源位置。</span><span class="sxs-lookup"><span data-stu-id="d07ef-136">Disable user browsing of source locations.</span></span> <span data-ttu-id="d07ef-137">如需詳細資訊，請參閱 [DisableBrowse](disablebrowse.md)。</span><span class="sxs-lookup"><span data-stu-id="d07ef-137">For more information, see [DisableBrowse](disablebrowse.md).</span></span>                                     |
| <span data-ttu-id="d07ef-138">DP</span><span class="sxs-lookup"><span data-stu-id="d07ef-138">DP</span></span>   | <span data-ttu-id="d07ef-139">停用修補。</span><span class="sxs-lookup"><span data-stu-id="d07ef-139">Disable patching.</span></span> <span data-ttu-id="d07ef-140">如需詳細資訊，請參閱 [DisablePatch](disablepatch.md)。</span><span class="sxs-lookup"><span data-stu-id="d07ef-140">For more information, see [DisablePatch](disablepatch.md).</span></span>                                                                |
| <span data-ttu-id="d07ef-141">Uc</span><span class="sxs-lookup"><span data-stu-id="d07ef-141">UC</span></span>   | <span data-ttu-id="d07ef-142">傳送給安裝服務的公用屬性。</span><span class="sxs-lookup"><span data-stu-id="d07ef-142">Public properties sent to install service.</span></span> <span data-ttu-id="d07ef-143">如需詳細資訊，請參閱 [EnableUserControl](enableusercontrol.md)。</span><span class="sxs-lookup"><span data-stu-id="d07ef-143">For more information, see [EnableUserControl](enableusercontrol.md).</span></span>                             |
| <span data-ttu-id="d07ef-144">SS</span><span class="sxs-lookup"><span data-stu-id="d07ef-144">SS</span></span>   | <span data-ttu-id="d07ef-145">從瀏覽器編寫腳本的安全安裝程式。</span><span class="sxs-lookup"><span data-stu-id="d07ef-145">Installer safe for scripting from browser.</span></span> <span data-ttu-id="d07ef-146">如需詳細資訊，請參閱 [SafeForScripting](safeforscripting.md)。</span><span class="sxs-lookup"><span data-stu-id="d07ef-146">For more information, see [SafeForScripting](safeforscripting.md).</span></span>                               |
| <span data-ttu-id="d07ef-147">EM</span><span class="sxs-lookup"><span data-stu-id="d07ef-147">EM</span></span>   | <span data-ttu-id="d07ef-148"> (HKLM) 的系統許可權。</span><span class="sxs-lookup"><span data-stu-id="d07ef-148">System privileges (HKLM).</span></span> <span data-ttu-id="d07ef-149">如需詳細資訊，請參閱 [AlwaysInstallElevated](alwaysinstallelevated.md)。</span><span class="sxs-lookup"><span data-stu-id="d07ef-149">For more information, see [AlwaysInstallElevated](alwaysinstallelevated.md).</span></span>                                      |
| <span data-ttu-id="d07ef-150">EU</span><span class="sxs-lookup"><span data-stu-id="d07ef-150">EU</span></span>   | <span data-ttu-id="d07ef-151"> (HKCU) 的系統許可權。</span><span class="sxs-lookup"><span data-stu-id="d07ef-151">System privileges (HKCU).</span></span> <span data-ttu-id="d07ef-152">如需詳細資訊，請參閱 [AlwaysInstallElevated](alwaysinstallelevated.md)。</span><span class="sxs-lookup"><span data-stu-id="d07ef-152">For more information, see [AlwaysInstallElevated](alwaysinstallelevated.md).</span></span>                                      |
| <span data-ttu-id="d07ef-153">DR</span><span class="sxs-lookup"><span data-stu-id="d07ef-153">DR</span></span>   | <span data-ttu-id="d07ef-154">停用回復原則。</span><span class="sxs-lookup"><span data-stu-id="d07ef-154">Disable rollback policy.</span></span> <span data-ttu-id="d07ef-155">如需詳細資訊，請參閱 [DisableRollback](disablerollback.md)。</span><span class="sxs-lookup"><span data-stu-id="d07ef-155">For more information, see [DisableRollback](disablerollback.md).</span></span>                                                   |
| <span data-ttu-id="d07ef-156">TS</span><span class="sxs-lookup"><span data-stu-id="d07ef-156">TS</span></span>   | <span data-ttu-id="d07ef-157">在來源映射的根目錄中找出轉換。</span><span class="sxs-lookup"><span data-stu-id="d07ef-157">Locate transforms at root of source image.</span></span> <span data-ttu-id="d07ef-158">如需詳細資訊，請參閱 [TransformsAtSource 原則](transformsatsource-policy.md)。</span><span class="sxs-lookup"><span data-stu-id="d07ef-158">For more information, see [TransformsAtSource policy](transformsatsource-policy.md).</span></span>             |
| <span data-ttu-id="d07ef-159">TP</span><span class="sxs-lookup"><span data-stu-id="d07ef-159">TP</span></span>   | <span data-ttu-id="d07ef-160">在用戶端快取中釘選安全會將。</span><span class="sxs-lookup"><span data-stu-id="d07ef-160">Pin secure tranforms in client-side-cache.</span></span> <span data-ttu-id="d07ef-161">如需詳細資訊，請參閱 [TransformsSecure 原則](transformssecure-policy.md)。</span><span class="sxs-lookup"><span data-stu-id="d07ef-161">For more information, see [TransformsSecure policy](transformssecure-policy.md).</span></span>                 |
| <span data-ttu-id="d07ef-162">SO</span><span class="sxs-lookup"><span data-stu-id="d07ef-162">SO</span></span>   | <span data-ttu-id="d07ef-163">來源類型的搜尋順序。</span><span class="sxs-lookup"><span data-stu-id="d07ef-163">Search order of source types.</span></span> <span data-ttu-id="d07ef-164">如需詳細資訊，請參閱 [SearchOrder](searchorder.md)。</span><span class="sxs-lookup"><span data-stu-id="d07ef-164">For more information, see [SearchOrder](searchorder.md).</span></span>                                                      |



 

<span data-ttu-id="d07ef-165">如需其他腳本範例，請參閱 [Windows Installer 腳本範例](windows-installer-scripting-examples.md)。</span><span class="sxs-lookup"><span data-stu-id="d07ef-165">For additional scripting examples, see [Windows Installer Scripting Examples](windows-installer-scripting-examples.md).</span></span> <span data-ttu-id="d07ef-166">如需不需要 Windows Script Host 的範例公用程式，請參閱 [Windows Installer 開發工具](windows-installer-development-tools.md)。</span><span class="sxs-lookup"><span data-stu-id="d07ef-166">For sample utilities that do not require Windows Script Host, see [Windows Installer Development Tools](windows-installer-development-tools.md).</span></span>

 

 



