---
description: MaskedEdit 控制項是編輯欄位控制項，包含控制項文字欄位中的遮罩。 您可以藉由在控制項資料表的屬性資料行中輸入屬性名稱，將控制項與字串值屬性產生關聯。
ms.assetid: 8cc14683-3dbb-404f-87af-09a5f5b90b19
title: MaskedEdit 控制項
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: ee7568df9969ebabab6311e519d0a5a625feb8dd
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/08/2021
ms.locfileid: "106985166"
---
# <a name="maskededit-control"></a><span data-ttu-id="d2214-104">MaskedEdit 控制項</span><span class="sxs-lookup"><span data-stu-id="d2214-104">MaskedEdit Control</span></span>

<span data-ttu-id="d2214-105">MaskedEdit 控制項是編輯欄位控制項，包含控制項文字欄位中的遮罩。</span><span class="sxs-lookup"><span data-stu-id="d2214-105">The MaskedEdit Control is an edit field control that contains a mask in the text field of the control.</span></span> <span data-ttu-id="d2214-106">您可以藉由在 [控制項資料表](control-table.md)的屬性資料行中輸入屬性名稱，將控制項與字串值屬性產生關聯。</span><span class="sxs-lookup"><span data-stu-id="d2214-106">You can associate the control with a string value property by entering the property name into the Property column of the [Control Table](control-table.md).</span></span>

<span data-ttu-id="d2214-107">您可以使用 MaskedEdit 控制項來建立使用者輸入資訊的範本，例如電話號碼或產品識別碼代碼。</span><span class="sxs-lookup"><span data-stu-id="d2214-107">You can use the MaskedEdit Control to create a template for user entry of information such as a telephone number or Product ID code.</span></span> <span data-ttu-id="d2214-108">例如，使用者可以透過將 [**PIDTemplate**](pidtemplate.md)屬性設定為如下所指定之字串的 MaskedEdit 控制項，來輸入 [**PIDKEY**](pidkey.md)屬性：</span><span class="sxs-lookup"><span data-stu-id="d2214-108">For example, the [**PIDKEY**](pidkey.md) Property can be entered by the user through a MaskedEdit Control that is specified by setting the [**PIDTemplate**](pidtemplate.md) Property to a string like the following:</span></span>

<span data-ttu-id="d2214-109">12345<\#\#\# -%%%%%%%>@@@@@</span><span class="sxs-lookup"><span data-stu-id="d2214-109">12345<\#\#\# -%%%%%%%>@@@@@</span></span>

<span data-ttu-id="d2214-110">字串會定義使用者的 [**PIDKEY**](pidkey.md) 屬性之專案的遮罩範本。</span><span class="sxs-lookup"><span data-stu-id="d2214-110">The string defines the masking template for the entry of the [**PIDKEY**](pidkey.md) Property by the user.</span></span> <span data-ttu-id="d2214-111">字串的可見區段會以一對括弧括住 (<>) 個字元。</span><span class="sxs-lookup"><span data-stu-id="d2214-111">The visible segment of the string is enclosed by a pair of bracket (<>) characters.</span></span>

<span data-ttu-id="d2214-112">下表指出遮罩的語法。</span><span class="sxs-lookup"><span data-stu-id="d2214-112">The following table identified the syntax of the mask.</span></span>



| <span data-ttu-id="d2214-113">字元</span><span class="sxs-lookup"><span data-stu-id="d2214-113">Character</span></span> | <span data-ttu-id="d2214-114">意義</span><span class="sxs-lookup"><span data-stu-id="d2214-114">Meaning</span></span>                                                                                                                                                                                                                                                                                     |
|-----------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <      | <span data-ttu-id="d2214-115">範本可見區段的左邊端。</span><span class="sxs-lookup"><span data-stu-id="d2214-115">The left end of the visible segment of the template.</span></span> <span data-ttu-id="d2214-116">此字元及其左邊的所有專案都會隱藏在使用者介面中。</span><span class="sxs-lookup"><span data-stu-id="d2214-116">This character and everything to its left are hidden in the user interface.</span></span> <span data-ttu-id="d2214-117">範本中應該不能有一個以上的此字元實例。</span><span class="sxs-lookup"><span data-stu-id="d2214-117">There should be no more than one instance of this character in the template.</span></span>                                                                               |
| >      | <span data-ttu-id="d2214-118">範本可見區段的右端。</span><span class="sxs-lookup"><span data-stu-id="d2214-118">The right end of the visible segment of the template.</span></span> <span data-ttu-id="d2214-119">此字元及其右邊的所有內容都會隱藏在使用者介面中。</span><span class="sxs-lookup"><span data-stu-id="d2214-119">This character and everything to its right are hidden in the user interface.</span></span> <span data-ttu-id="d2214-120">在驗證期間，此字元會取代為虛線。</span><span class="sxs-lookup"><span data-stu-id="d2214-120">This character is replaced by a dash during validation.</span></span> <span data-ttu-id="d2214-121">如果有可見區段以 < 開頭，則必須以相符的 > 結束。</span><span class="sxs-lookup"><span data-stu-id="d2214-121">If there is a visible segment begins with <, then it must be terminated with a matching >.</span></span> |
| \#        | <span data-ttu-id="d2214-122">此字元可以是數位 (數位。 ) </span><span class="sxs-lookup"><span data-stu-id="d2214-122">This character can be a digit (numeral.)</span></span>                                                                                                                                                                                                                                                    |
| %         | <span data-ttu-id="d2214-123">此字元可以是替代數位 (數位) ，可讓遮罩控制自訂動作如何區分欄位。</span><span class="sxs-lookup"><span data-stu-id="d2214-123">This character can be an alternate digit (numeral) that enables the mask to control the way a custom action differentiates fields.</span></span>                                                                                                                                                          |
| @         | <span data-ttu-id="d2214-124">此字元可以是 (數位的亂數字。 ) 此字元不應該出現在範本的可見部分中。</span><span class="sxs-lookup"><span data-stu-id="d2214-124">This character can be a random digit (numeral.) This character should not appear in the visible part of the template.</span></span>                                                                                                                                                                       |
| &         | <span data-ttu-id="d2214-125">此字元可以是任何字元。</span><span class="sxs-lookup"><span data-stu-id="d2214-125">This character can be any character.</span></span>                                                                                                                                                                                                                                                        |
| ^         | <span data-ttu-id="d2214-126">此字元可以是替代字元，此字元可讓遮罩控制自訂動作與欄位區別的方式。</span><span class="sxs-lookup"><span data-stu-id="d2214-126">This character can be an alternate character that enables the mask to control the way a custom action differentiates fields.</span></span>                                                                                                                                                                |
| <span data-ttu-id="d2214-127">?</span><span class="sxs-lookup"><span data-stu-id="d2214-127">?</span></span>         | <span data-ttu-id="d2214-128">此字元可以是替代字元，此字元可讓遮罩控制自訂動作與欄位區別的方式。</span><span class="sxs-lookup"><span data-stu-id="d2214-128">This character can be an alternate character that enables the mask to control the way a custom action differentiates fields.</span></span>                                                                                                                                                                |
| <span data-ttu-id="d2214-129">\`        |以抑音符 \` 號 (ASCII 值 96) 可以表示替代字元，讓遮罩控制自訂動作區分欄位的方式。</span><span class="sxs-lookup"><span data-stu-id="d2214-129">\`        | Grave accent marks \` (ASCII value 96) can represent an alternate character that enables the mask to control the way a custom action differentiates fields.</span></span>                                                                                                                                 |
| \_        | <span data-ttu-id="d2214-130">此字元是常值底線字元。</span><span class="sxs-lookup"><span data-stu-id="d2214-130">This character is a literal underscore character.</span></span>                                                                                                                                                                                                                                           |
| =         | <span data-ttu-id="d2214-131">此字元是欄位結束字元。</span><span class="sxs-lookup"><span data-stu-id="d2214-131">This character is the field terminator.</span></span> <span data-ttu-id="d2214-132">這必須遵循 a \# 、%、^ 或 \` 。</span><span class="sxs-lookup"><span data-stu-id="d2214-132">This must follow a \#, %, ^, or \`.</span></span> <span data-ttu-id="d2214-133">這會建立一個與先前位置相同類型的輸入位置，然後以 '-' 分隔符號結束欄位。</span><span class="sxs-lookup"><span data-stu-id="d2214-133">This creates one more input position of the same type as the preceding positions and terminates the field with a '-' separator.</span></span>                                                                                 |



 

<span data-ttu-id="d2214-134">任何其他字元都會被視為常值常數。</span><span class="sxs-lookup"><span data-stu-id="d2214-134">Any other character is treated as a literal constant.</span></span>

<span data-ttu-id="d2214-135">針對可編輯的字元，控制項會針對相同類型的每個連續字元區塊，以一個視窗建立個別的編輯視窗。</span><span class="sxs-lookup"><span data-stu-id="d2214-135">For characters that can be edited, the control creates separate edit windows with one window for each block of contiguous characters of the same kind.</span></span>

## <a name="control-attributes"></a><span data-ttu-id="d2214-136">控制項屬性</span><span class="sxs-lookup"><span data-stu-id="d2214-136">Control Attributes</span></span>

<span data-ttu-id="d2214-137">若要變更使用事件的屬性值，請將控制項訂閱至 [EventMapping 資料表](eventmapping-table.md) 中的控制項事件，然後在 [屬性] 資料行中列出屬性識別碼。</span><span class="sxs-lookup"><span data-stu-id="d2214-137">To change the value of an attribute that is using an event, subscribe the control to a Control event in the [EventMapping Table](eventmapping-table.md) and list the attribute identifier in the Attribute column.</span></span> <span data-ttu-id="d2214-138">在 [事件] 資料行中輸入控制項事件的識別碼。</span><span class="sxs-lookup"><span data-stu-id="d2214-138">Enter the identifier of the Control event in the Event column.</span></span> <span data-ttu-id="d2214-139">您可以將下列屬性與 MaskedEdit 控制項搭配使用。</span><span class="sxs-lookup"><span data-stu-id="d2214-139">You can use the following attributes with the MaskedEdit Control.</span></span>



| <span data-ttu-id="d2214-140">屬性</span><span class="sxs-lookup"><span data-stu-id="d2214-140">Attribute</span></span>                                                          | <span data-ttu-id="d2214-141">十六進位位</span><span class="sxs-lookup"><span data-stu-id="d2214-141">Hexadecimal Bit</span></span>                  | <span data-ttu-id="d2214-142">Description</span><span class="sxs-lookup"><span data-stu-id="d2214-142">Description</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|--------------------------------------------------------------------|----------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="d2214-143">IndirectPropertyName</span><span class="sxs-lookup"><span data-stu-id="d2214-143">IndirectPropertyName</span></span>](indirectpropertyname-control-attribute.md) |                                  | <span data-ttu-id="d2214-144">這是與控制項相關聯之間接屬性的名稱。</span><span class="sxs-lookup"><span data-stu-id="d2214-144">This is the name of an indirect property that is associated with the control.</span></span> <span data-ttu-id="d2214-145">如果已設定間接屬性位，控制項會顯示或變更具有這個名稱的屬性值。</span><span class="sxs-lookup"><span data-stu-id="d2214-145">If the indirect attribute bit is set, the control displays or changes the value of the property that has this name.</span></span> <span data-ttu-id="d2214-146">如果設定了間接屬性位，此名稱也會是 [控制資料表](control-table.md)的屬性資料行中所列屬性的值。</span><span class="sxs-lookup"><span data-stu-id="d2214-146">If the indirect attribute bit is set, this name is also the value of the property that is listed in the Property column of the [Control Table](control-table.md).</span></span>                                                                                                                                   |
| [<span data-ttu-id="d2214-147">位置</span><span class="sxs-lookup"><span data-stu-id="d2214-147">Position</span></span>](position-control-attribute.md)                         |                                  | <span data-ttu-id="d2214-148">對話方塊中控制項的位置。</span><span class="sxs-lookup"><span data-stu-id="d2214-148">Position of the control in the dialog box.</span></span> <span data-ttu-id="d2214-149">將控制項左上角的控制項寬度、高度和座標輸入控制項 [資料表](control-table.md)的 Width、Height、X 和 Y 資料行中。</span><span class="sxs-lookup"><span data-stu-id="d2214-149">Enter the control width, height, and coordinates of the control's left corner into the Width, Height, X, and Y columns of the [Control Table](control-table.md).</span></span> <span data-ttu-id="d2214-150">使用 [安裝程式單位](installer-units.md) 來表示長度和距離。</span><span class="sxs-lookup"><span data-stu-id="d2214-150">Use [Installer Units](installer-units.md) for length and distance.</span></span><br/>                                                                                                                                                                                                            |
| [<span data-ttu-id="d2214-151">PropertyName</span><span class="sxs-lookup"><span data-stu-id="d2214-151">PropertyName</span></span>](propertyname-control-attribute.md)                 |                                  | <span data-ttu-id="d2214-152">這是與此控制項相關聯之屬性的名稱。</span><span class="sxs-lookup"><span data-stu-id="d2214-152">This is the name of the property that is associated with this control.</span></span> <span data-ttu-id="d2214-153">如果未設定間接屬性位，控制項會顯示或變更具有這個名稱的屬性值。</span><span class="sxs-lookup"><span data-stu-id="d2214-153">If the indirect attribute bit is not set, the control displays or changes the value of the property that has this name.</span></span> <span data-ttu-id="d2214-154">這個屬性是在 [控制資料表](control-table.md)的屬性資料行中指定。</span><span class="sxs-lookup"><span data-stu-id="d2214-154">This attribute is specified in the Property column of the [Control Table](control-table.md).</span></span>                                                                                                                                                                                                           |
| [<span data-ttu-id="d2214-155">PropertyValue</span><span class="sxs-lookup"><span data-stu-id="d2214-155">PropertyValue</span></span>](propertyvalue-control-attribute.md)               |                                  | <span data-ttu-id="d2214-156">此控制項顯示或變更之屬性的目前值。</span><span class="sxs-lookup"><span data-stu-id="d2214-156">Current value of the property that is displayed or changed by this control.</span></span> <span data-ttu-id="d2214-157">如果未設定間接屬性位，則這是 PropertyName 的值。</span><span class="sxs-lookup"><span data-stu-id="d2214-157">If the indirect attribute bit is not set, this is the value of PropertyName.</span></span> <span data-ttu-id="d2214-158">如果已設定間接屬性位，這就是 IndirectPropertyName 的值。</span><span class="sxs-lookup"><span data-stu-id="d2214-158">If the indirect attribute bit is set, this is the value of IndirectPropertyName.</span></span> <span data-ttu-id="d2214-159">如果屬性變更，控制項就會反映新的值。</span><span class="sxs-lookup"><span data-stu-id="d2214-159">If the attribute changes, the control reflects the new value.</span></span>                                                                                                                                                                                                |
| [<span data-ttu-id="d2214-160">Text</span><span class="sxs-lookup"><span data-stu-id="d2214-160">Text</span></span>](text-control-attribute.md)                                 |                                  | <span data-ttu-id="d2214-161">若要設定文字字串的字型與字型樣式，請在顯示的字元字串前面加上 { \\ style} 或 {&style}。</span><span class="sxs-lookup"><span data-stu-id="d2214-161">To set the font and font style of a text string, prefix the string of displayed characters with {\\style} or {&style}.</span></span> <span data-ttu-id="d2214-162">其中 style 是在樣式 [表單](textstyle-table.md)的 style 資料行中所列的識別碼。</span><span class="sxs-lookup"><span data-stu-id="d2214-162">Where style is an identifier listed in the Style column of the [TextStyle Table](textstyle-table.md).</span></span> <span data-ttu-id="d2214-163">如果這兩個都不存在，但 [**DefaultUIFont**](defaultuifont.md) 屬性定義為有效的文字樣式，則會使用該字型。</span><span class="sxs-lookup"><span data-stu-id="d2214-163">If neither of these are present, but the [**DefaultUIFont**](defaultuifont.md) Property is defined as a valid text style, that font is used.</span></span> <span data-ttu-id="d2214-164">指定遮罩範本的字串會遵循這個前置詞，並使用先前在本主題中所述的語法。</span><span class="sxs-lookup"><span data-stu-id="d2214-164">The string that specifies the masking template follows this prefix and uses the syntax described previously in this topic.</span></span> |
| [<span data-ttu-id="d2214-165">Visible</span><span class="sxs-lookup"><span data-stu-id="d2214-165">Visible</span></span>](visible-control-attribute.md)                           | <span data-ttu-id="d2214-166">0x00000000 0x00000001</span><span class="sxs-lookup"><span data-stu-id="d2214-166">0x00000000 0x00000001</span></span><br/> | <span data-ttu-id="d2214-167">隱藏的控制項。</span><span class="sxs-lookup"><span data-stu-id="d2214-167">Hidden control.</span></span> <span data-ttu-id="d2214-168">可見的控制項。</span><span class="sxs-lookup"><span data-stu-id="d2214-168">Visible control.</span></span><br/> <span data-ttu-id="d2214-169">在 [控制資料表](control-table.md) 中的 [屬性] 資料行的位字組中包含這個位，可在建立控制項時顯示或隱藏控制項。</span><span class="sxs-lookup"><span data-stu-id="d2214-169">Include this bit in the bit word of the Attributes column in the [Control Table](control-table.md) to make the control visible or hidden when it is created.</span></span><br/> <span data-ttu-id="d2214-170">您也可以使用 [ControlCondition 資料表](controlcondition-table.md)來隱藏或顯示控制項。</span><span class="sxs-lookup"><span data-stu-id="d2214-170">You can also hide or show a control by using the [ControlCondition Table](controlcondition-table.md).</span></span><br/>                                                                                                                                                                 |
| [<span data-ttu-id="d2214-171">Enabled</span><span class="sxs-lookup"><span data-stu-id="d2214-171">Enabled</span></span>](enabled-control-attribute.md)                           | <span data-ttu-id="d2214-172">0x00000000 0x00000002</span><span class="sxs-lookup"><span data-stu-id="d2214-172">0x00000000 0x00000002</span></span><br/> | <span data-ttu-id="d2214-173">控制項處於停用狀態。</span><span class="sxs-lookup"><span data-stu-id="d2214-173">Control in a disabled state.</span></span> <span data-ttu-id="d2214-174">控制項處於已啟用狀態。</span><span class="sxs-lookup"><span data-stu-id="d2214-174">Control in an enabled state.</span></span><br/> <span data-ttu-id="d2214-175">在 [控制項資料表](control-table.md) 的 [屬性] 資料行中的位字組中包含這個位，以在建立時啟用控制項。</span><span class="sxs-lookup"><span data-stu-id="d2214-175">Include this bit in the bit word in the Attributes column of the [Control Table](control-table.md) to enable the control on creation.</span></span><br/> <span data-ttu-id="d2214-176">您也可以使用 [ControlCondition 資料表](controlcondition-table.md)來啟用或停用控制項。</span><span class="sxs-lookup"><span data-stu-id="d2214-176">You can also enable or disable a control by using the [ControlCondition Table](controlcondition-table.md).</span></span><br/>                                                                                                                                                          |
| [<span data-ttu-id="d2214-177">沉沒</span><span class="sxs-lookup"><span data-stu-id="d2214-177">Sunken</span></span>](sunken-control-attribute.md)                             | <span data-ttu-id="d2214-178">0x00000000 0x00000004</span><span class="sxs-lookup"><span data-stu-id="d2214-178">0x00000000 0x00000004</span></span><br/> | <span data-ttu-id="d2214-179">顯示預設的視覺化樣式。</span><span class="sxs-lookup"><span data-stu-id="d2214-179">Displays the default visual style.</span></span> <span data-ttu-id="d2214-180">顯示具有凹陷、立體外觀的控制項。</span><span class="sxs-lookup"><span data-stu-id="d2214-180">Displays the control with a sunken, 3-D look.</span></span><br/> <span data-ttu-id="d2214-181">在 [控制項資料表](control-table.md)的 [屬性] 資料行中，將這些位包含在位字中。</span><span class="sxs-lookup"><span data-stu-id="d2214-181">Include these bits in the bit word in the Attributes column of the [Control Table](control-table.md).</span></span><br/>                                                                                                                                                                                                                                                                                          |
| [<span data-ttu-id="d2214-182">間接</span><span class="sxs-lookup"><span data-stu-id="d2214-182">Indirect</span></span>](indirect-control-attribute.md)                         | <span data-ttu-id="d2214-183">0x00000000 0x00000008</span><span class="sxs-lookup"><span data-stu-id="d2214-183">0x00000000 0x00000008</span></span><br/> | <span data-ttu-id="d2214-184">控制項會在 [控制資料表](control-table.md)的屬性資料行中顯示或變更屬性的值。</span><span class="sxs-lookup"><span data-stu-id="d2214-184">The control displays or changes the value of the property in the Property column of the [Control Table](control-table.md).</span></span> <span data-ttu-id="d2214-185">控制項會顯示或變更屬性的值，此屬性的識別碼列于 [控制資料表](control-table.md)的屬性資料行中。</span><span class="sxs-lookup"><span data-stu-id="d2214-185">The control displays or changes the value of the property that has the identifier listed in the Property column of the [Control Table](control-table.md).</span></span><br/> <span data-ttu-id="d2214-186">決定是否要間接參考與此控制項相關聯的屬性。</span><span class="sxs-lookup"><span data-stu-id="d2214-186">Determines if the property that is associated with this control is referenced indirectly.</span></span><br/>                                                                                                 |



 

## <a name="remarks"></a><span data-ttu-id="d2214-187">備註</span><span class="sxs-lookup"><span data-stu-id="d2214-187">Remarks</span></span>

<span data-ttu-id="d2214-188">MaskedEdit 控制項會以 **BS \_ OWNERDRAW** 和 **WS \_ EX \_ CONTROLPARENT** 樣式，建立 **BUTTON** 類別的一個父視窗。</span><span class="sxs-lookup"><span data-stu-id="d2214-188">The MaskedEdit Control creates one parent window of the **BUTTON** class with the **BS\_OWNERDRAW** and **WS\_EX\_CONTROLPARENT** styles.</span></span> <span data-ttu-id="d2214-189">它會在此視窗中建立數個子視窗。</span><span class="sxs-lookup"><span data-stu-id="d2214-189">It creates several child windows to this window.</span></span>

-   <span data-ttu-id="d2214-190">如果是常數文字部分，則會建立具有 **SS \_ LEFT** 和 **WS \_ 子** 樣式的靜態視窗。</span><span class="sxs-lookup"><span data-stu-id="d2214-190">For constant text parts, it creates STATIC windows with the **SS\_LEFT** and **WS\_CHILD** styles.</span></span>
-   <span data-ttu-id="d2214-191">針對可編輯的欄位，它會建立具有 **ws \_ 子** 系、 **ws \_ 框線** 和 **ws \_ TABSTOP** 樣式的編輯視窗。</span><span class="sxs-lookup"><span data-stu-id="d2214-191">For editable fields, it creates an EDIT window with the **WS\_CHILD**, **WS\_BORDER**, and **WS\_TABSTOP** styles.</span></span>
-   <span data-ttu-id="d2214-192">若為數值欄位，視窗也會有 **ES \_ 數位** 樣式。</span><span class="sxs-lookup"><span data-stu-id="d2214-192">For numeric fields, the window also has the **ES\_NUMBER** style.</span></span>

<span data-ttu-id="d2214-193">替代位數、% 和替代的英數位元、^、？和 \` 欄位可讓自訂動作以遮罩可控制的方式區分欄位，例如 ^ 可用於應為大寫的欄位。</span><span class="sxs-lookup"><span data-stu-id="d2214-193">The alternate digit, %, and alternate alphanumeric characters, ^, ?, and \` fields allow custom actions to differentiate between fields in a way that can be controlled by the mask, for example, ^ can be used for fields that should be uppercase.</span></span>

 

 




