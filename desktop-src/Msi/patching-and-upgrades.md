---
description: 因為安裝套件可以包含組成應用程式的檔案，以及其安裝所需的資訊，所以 Windows Installer 可以用來更新應用程式。
ms.assetid: da946739-9efc-4bf0-8a9a-6f6ead3c4a34
title: 修補和升級
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b8cee185461ac14c8eac336a5af0c1315eb5e027
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/07/2021
ms.locfileid: "103944296"
---
# <a name="patching-and-upgrades"></a><span data-ttu-id="a1f3e-103">修補和升級</span><span class="sxs-lookup"><span data-stu-id="a1f3e-103">Patching and Upgrades</span></span>

<span data-ttu-id="a1f3e-104">因為安裝套件可以包含組成應用程式的檔案，以及其安裝所需的資訊，所以 Windows Installer 可以用來更新應用程式。</span><span class="sxs-lookup"><span data-stu-id="a1f3e-104">Because an installation package can contain the files that make up an application as well the information needed for their installation, Windows Installer can be used to update the application.</span></span> <span data-ttu-id="a1f3e-105">安裝程式可以更新安裝套件的下列部分中的資訊：</span><span class="sxs-lookup"><span data-stu-id="a1f3e-105">The installer can update information in the following parts of the installation package:</span></span>

-   <span data-ttu-id="a1f3e-106">.Msi 檔案。</span><span class="sxs-lookup"><span data-stu-id="a1f3e-106">The .msi file.</span></span>
-   <span data-ttu-id="a1f3e-107">應用程式的檔案。</span><span class="sxs-lookup"><span data-stu-id="a1f3e-107">The files of the application.</span></span>
-   <span data-ttu-id="a1f3e-108">Windows Installer 的註冊資訊。</span><span class="sxs-lookup"><span data-stu-id="a1f3e-108">The Windows Installer registration information.</span></span>

<span data-ttu-id="a1f3e-109">更新的類型可以是更新對應用程式產品代碼、產品版本和封裝程式碼所進行的變更。</span><span class="sxs-lookup"><span data-stu-id="a1f3e-109">The type of update can be characterized by the changes the update makes to the application's product code, product version, and package code.</span></span> <span data-ttu-id="a1f3e-110">應用程式的產品版本會儲存在 [**ProductVersion**](productversion.md) 屬性中。</span><span class="sxs-lookup"><span data-stu-id="a1f3e-110">The application's product version is stored in the [**ProductVersion**](productversion.md) property.</span></span> <span data-ttu-id="a1f3e-111">應用程式的產品代碼會儲存在 [ [**ProductCode**](productcode.md) ] 屬性中。</span><span class="sxs-lookup"><span data-stu-id="a1f3e-111">The application's product code is stored in the [**ProductCode**](productcode.md) property.</span></span> <span data-ttu-id="a1f3e-112">應用程式的 [封裝程式碼](package-codes.md) 會儲存在 [ [**修訂編號摘要**](revision-number-summary.md) ] 屬性中。</span><span class="sxs-lookup"><span data-stu-id="a1f3e-112">The application's [package code](package-codes.md) is stored in the [**Revision Number Summary**](revision-number-summary.md) Property.</span></span>

<span data-ttu-id="a1f3e-113">變更應用程式的 [**ProductCode**](productcode.md) 需要將應用程式變更為另一個產品的更新。</span><span class="sxs-lookup"><span data-stu-id="a1f3e-113">An update that changes the application into another product is required to change the [**ProductCode**](productcode.md) of the application.</span></span> <span data-ttu-id="a1f3e-114">如需哪些更新需要變更 **ProductCode** 的詳細資訊，請參閱 [變更產品代碼](changing-the-product-code.md)。</span><span class="sxs-lookup"><span data-stu-id="a1f3e-114">For more information about which updates require changing the **ProductCode** see [Changing the Product Code](changing-the-product-code.md).</span></span> <span data-ttu-id="a1f3e-115">如果未來的應用程式版本需要區分目前產品的更新版本和 nonupdated 版本，則更新可能會變更 [**ProductVersion**](productversion.md) ，並讓 **ProductCode** 保持不變。</span><span class="sxs-lookup"><span data-stu-id="a1f3e-115">The update can change the [**ProductVersion**](productversion.md) and leave the **ProductCode** unchanged if future versions of the application will need to differentiate between the updated and nonupdated versions of the current product.</span></span> <span data-ttu-id="a1f3e-116">[封裝程式碼](package-codes.md)可唯一識別安裝套件，而且每當更新或升級變更安裝套件中的任何資訊時，都應該一律變更。</span><span class="sxs-lookup"><span data-stu-id="a1f3e-116">The [Package Code](package-codes.md) uniquely identifies the installation package and should always be changed whenever update or upgrade changes any information in the installation package.</span></span>

<span data-ttu-id="a1f3e-117">決定是否要變更產品版本時，您應該考慮未來的應用程式版本是否需要區分目前產品的更新版本與 nonupdated 版本。</span><span class="sxs-lookup"><span data-stu-id="a1f3e-117">When deciding whether to change the product version, you should consider If future versions of the application will need to differentiate between the updated and nonupdated versions of the current product.</span></span> <span data-ttu-id="a1f3e-118">為了確保未來的差異，應使用 [次要升級](minor-upgrades.md) ，而不是 [小型更新](small-updates.md)。</span><span class="sxs-lookup"><span data-stu-id="a1f3e-118">To ensure differentiation in the future, a [minor upgrade](minor-upgrades.md) should be used instead of a [small update](small-updates.md).</span></span>

-   <span data-ttu-id="a1f3e-119">如果更新變更 .msi 檔案和應用程式檔，但是未變更 [ [**ProductCode**](productcode.md) ] 屬性或 [ [**ProductVersion**](productversion.md) ] 屬性，則稱為「 [小型更新](small-updates.md)」。</span><span class="sxs-lookup"><span data-stu-id="a1f3e-119">If an update changes the .msi file and application files, but does not change the [**ProductCode**](productcode.md) property or [**ProductVersion**](productversion.md) property, it is termed a [small update](small-updates.md).</span></span>
-   <span data-ttu-id="a1f3e-120">如果更新變更了 [**ProductVersion**](productversion.md)，但是未變更 [**ProductCode**](productcode.md)，則稱為「 [次要升級](minor-upgrades.md)」。</span><span class="sxs-lookup"><span data-stu-id="a1f3e-120">If the update changes the [**ProductVersion**](productversion.md), but does not change the [**ProductCode**](productcode.md), it is termed a [minor upgrade](minor-upgrades.md).</span></span>
-   <span data-ttu-id="a1f3e-121">如果更新將安裝變更為完全不同的產品，則必須變更 [**ProductCode**](productcode.md) ，更新也稱為 [主要升級](major-upgrades.md)。</span><span class="sxs-lookup"><span data-stu-id="a1f3e-121">If the update changes the installation into an entirely different product, the [**ProductCode**](productcode.md) must change and the update is termed a [major upgrade](major-upgrades.md).</span></span>

> [!Note]  
> <span data-ttu-id="a1f3e-122">為了確保未來的產品版本有差異，應該使用 [次要升級](minor-upgrades.md) ，而不是 [小型更新](small-updates.md)。</span><span class="sxs-lookup"><span data-stu-id="a1f3e-122">To ensure differentiation of versions of the current product in the future, a [minor upgrade](minor-upgrades.md) should be used instead of a [small update](small-updates.md).</span></span>

 

<span data-ttu-id="a1f3e-123">下表摘要說明不同類型的更新。</span><span class="sxs-lookup"><span data-stu-id="a1f3e-123">The following table summarizes the different types of updates.</span></span>



| <span data-ttu-id="a1f3e-124">更新類型</span><span class="sxs-lookup"><span data-stu-id="a1f3e-124">Type of update</span></span>                       | <span data-ttu-id="a1f3e-125">Productcode</span><span class="sxs-lookup"><span data-stu-id="a1f3e-125">Productcode</span></span> | <span data-ttu-id="a1f3e-126">ProductVersion</span><span class="sxs-lookup"><span data-stu-id="a1f3e-126">ProductVersion</span></span> | <span data-ttu-id="a1f3e-127">Description</span><span class="sxs-lookup"><span data-stu-id="a1f3e-127">Description</span></span>                                                                                                                                                                                                                                                                                                           |
|--------------------------------------|-------------|----------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="a1f3e-128">Small Update</span><span class="sxs-lookup"><span data-stu-id="a1f3e-128">Small Update</span></span>](small-updates.md)    | <span data-ttu-id="a1f3e-129">沒有變更</span><span class="sxs-lookup"><span data-stu-id="a1f3e-129">No change</span></span>   | <span data-ttu-id="a1f3e-130">沒有變更</span><span class="sxs-lookup"><span data-stu-id="a1f3e-130">No change</span></span>      | <span data-ttu-id="a1f3e-131">對一或多個太小的檔案進行更新，以保證無法變更 [**ProductVersion**](productversion.md)。</span><span class="sxs-lookup"><span data-stu-id="a1f3e-131">An update to one or two files that is too small to warrant changing the [**ProductVersion**](productversion.md).</span></span> <span data-ttu-id="a1f3e-132">[**修訂編號摘要**](revision-number-summary.md)屬性中的封裝程式碼確實有變更。</span><span class="sxs-lookup"><span data-stu-id="a1f3e-132">The package code in the [**Revision Number Summary**](revision-number-summary.md) Property does change.</span></span> <span data-ttu-id="a1f3e-133">可以作為完整的安裝套件或 [修補套件](patch-packages.md)來傳送。</span><span class="sxs-lookup"><span data-stu-id="a1f3e-133">Can be shipped as a full installation package or as a [patch package](patch-packages.md).</span></span> |
| [<span data-ttu-id="a1f3e-134">次要升級</span><span class="sxs-lookup"><span data-stu-id="a1f3e-134">Minor Upgrade</span></span>](minor-upgrades.md)  | <span data-ttu-id="a1f3e-135">沒有變更</span><span class="sxs-lookup"><span data-stu-id="a1f3e-135">No change</span></span>   | <span data-ttu-id="a1f3e-136">已變更</span><span class="sxs-lookup"><span data-stu-id="a1f3e-136">Changed</span></span>        | <span data-ttu-id="a1f3e-137">這項小更新大幅改變，足以保證變更 [**ProductVersion**](productversion.md) 屬性。</span><span class="sxs-lookup"><span data-stu-id="a1f3e-137">A small update making changes significant enough to warrant changing the [**ProductVersion**](productversion.md) property.</span></span> <span data-ttu-id="a1f3e-138">可以作為完整的安裝套件或 [修補套件](patch-packages.md)來傳送。</span><span class="sxs-lookup"><span data-stu-id="a1f3e-138">Can be shipped as a full installation package or as a [patch package](patch-packages.md).</span></span>                                                                                                |
| [<span data-ttu-id="a1f3e-139">主要升級</span><span class="sxs-lookup"><span data-stu-id="a1f3e-139">Major Upgrades</span></span>](major-upgrades.md) | <span data-ttu-id="a1f3e-140">已變更</span><span class="sxs-lookup"><span data-stu-id="a1f3e-140">Changed</span></span>     | <span data-ttu-id="a1f3e-141">已變更</span><span class="sxs-lookup"><span data-stu-id="a1f3e-141">Changed</span></span>        | <span data-ttu-id="a1f3e-142">產品的完整更新會 warranting [ [**ProductCode**](productcode.md) ] 屬性中的變更。</span><span class="sxs-lookup"><span data-stu-id="a1f3e-142">A comprehensive update of the product warranting a change in the [**ProductCode**](productcode.md) property.</span></span> <span data-ttu-id="a1f3e-143">隨附于 [修補套件](patch-packages.md) 或完整產品安裝套件。</span><span class="sxs-lookup"><span data-stu-id="a1f3e-143">Shipped as a [patch package](patch-packages.md) or as a full product installation package.</span></span>                                                                                                             |



 

> [!Note]  
> <span data-ttu-id="a1f3e-144">Windows Installer 可以為電腦的所有使用者安裝應用程式或更新 (個別電腦內容) 或特定使用者 (個別使用者內容) 根據使用者的存取權限、 [**ALLUSERS**](allusers.md) 屬性的值和作業系統的版本而定，。</span><span class="sxs-lookup"><span data-stu-id="a1f3e-144">The Windows Installer can install an application, or an update, for all users of a computer (per-machine context) or for a particular user (per-user context) depending on the access privileges of the user, the value of the [**ALLUSERS**](allusers.md) property, and the version of the operating system.</span></span> <span data-ttu-id="a1f3e-145">應用程式開發人員應該考慮將會安裝內容更新。</span><span class="sxs-lookup"><span data-stu-id="a1f3e-145">Application developers should consider in which context updates will be installed.</span></span> <span data-ttu-id="a1f3e-146">如果應用程式和更新的內容不同，則應用程式可能不會如預期般更新。</span><span class="sxs-lookup"><span data-stu-id="a1f3e-146">If the contexts of the application and update are different, the application may not be updated as expected.</span></span>

 

<span data-ttu-id="a1f3e-147">使用者可以重新安裝應用程式的 Windows Installer 套件，以更新應用程式。</span><span class="sxs-lookup"><span data-stu-id="a1f3e-147">Users can update to an application by reinstalling a Windows Installer package for the application.</span></span> <span data-ttu-id="a1f3e-148">請注意， [次要升級](minor-upgrades.md) 的套用方式與 [小型更新](small-updates.md)相同。</span><span class="sxs-lookup"><span data-stu-id="a1f3e-148">Note that [Minor Upgrades](minor-upgrades.md) can be applied in the same way as [Small Updates](small-updates.md).</span></span> <span data-ttu-id="a1f3e-149">如需重新安裝應用程式以更新應用程式的詳細資訊，請參閱下列各節：</span><span class="sxs-lookup"><span data-stu-id="a1f3e-149">For more information about updating an application by reinstalling the application, see these sections:</span></span>

-   [<span data-ttu-id="a1f3e-150">重新安裝產品以套用小型更新</span><span class="sxs-lookup"><span data-stu-id="a1f3e-150">Applying Small Updates by Reinstalling the Product</span></span>](applying-small-updates-by-reinstalling-the-product.md)
-   [<span data-ttu-id="a1f3e-151">藉由安裝產品來套用主要升級</span><span class="sxs-lookup"><span data-stu-id="a1f3e-151">Applying Major Upgrades by Installing the Product</span></span>](applying-major-upgrades-by-installing-the-product.md)

<span data-ttu-id="a1f3e-152">您可以將應用程式更新提供給使用者，以做為 Windows Installer patch 套件。</span><span class="sxs-lookup"><span data-stu-id="a1f3e-152">An update to an application can be provided to users as a Windows Installer patch package.</span></span> <span data-ttu-id="a1f3e-153">修補程式可包含整個檔案，或只包含更新部分檔案所需的檔案位。</span><span class="sxs-lookup"><span data-stu-id="a1f3e-153">A patch can contain an entire file or only the file bits necessary to update part of a file.</span></span> <span data-ttu-id="a1f3e-154">這表示使用者可以下載的升級修補程式遠小於整個產品，並且可透過升級保留使用者自訂。</span><span class="sxs-lookup"><span data-stu-id="a1f3e-154">This means that the user can download an upgrade patch that is much smaller than the entire product and that preserves user customizations through the upgrade.</span></span> <span data-ttu-id="a1f3e-155">請注意， [次要升級](minor-upgrades.md) 的套用方式與 [小型更新](small-updates.md)相同。</span><span class="sxs-lookup"><span data-stu-id="a1f3e-155">Note that [Minor Upgrades](minor-upgrades.md) can be applied in the same way as [Small Updates](small-updates.md).</span></span> <span data-ttu-id="a1f3e-156">如需有關使用修補程式更新應用程式的詳細資訊，請參閱下列各節：</span><span class="sxs-lookup"><span data-stu-id="a1f3e-156">For more information about updating an application using a patch, see these sections:</span></span>

-   [<span data-ttu-id="a1f3e-157">修補</span><span class="sxs-lookup"><span data-stu-id="a1f3e-157">Patching</span></span>](patching.md)
-   [<span data-ttu-id="a1f3e-158">建立小型更新修補程式</span><span class="sxs-lookup"><span data-stu-id="a1f3e-158">Creating a Small Update Patch</span></span>](creating-a-small-update-patch.md)
-   [<span data-ttu-id="a1f3e-159">藉由修補產品的本機安裝來套用小型更新</span><span class="sxs-lookup"><span data-stu-id="a1f3e-159">Applying Small Updates by Patching the Local Installation of the Product</span></span>](applying-small-updates-by-patching-the-local-installation-of-the-product.md)
-   [<span data-ttu-id="a1f3e-160">藉由修補系統管理映射來套用小型更新</span><span class="sxs-lookup"><span data-stu-id="a1f3e-160">Applying Small Updates by Patching an Administrative Image</span></span>](applying-small-updates-by-patching-an-administrative-image.md)
-   [<span data-ttu-id="a1f3e-161">藉由修補產品的本機安裝來套用主要升級</span><span class="sxs-lookup"><span data-stu-id="a1f3e-161">Applying Major Upgrades by Patching the Local Installation of the Product</span></span>](applying-major-upgrades-by-patching-the-local-installation-of-the-product.md)

 

 



