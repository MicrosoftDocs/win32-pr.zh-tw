---
description: 如需當地語系化的一般資訊，請參閱全球化服務。
ms.assetid: 734961f6-de0a-4c54-9866-ade994c41c7e
title: 當地語系化 Windows Installer 套件
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b325b211302fba632f454f30eefbcb688f30d819
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/07/2021
ms.locfileid: "104113565"
---
# <a name="localizing-a-windows-installer-package"></a><span data-ttu-id="a0b7f-103">當地語系化 Windows Installer 套件</span><span class="sxs-lookup"><span data-stu-id="a0b7f-103">Localizing a Windows Installer Package</span></span>

<span data-ttu-id="a0b7f-104">如需當地語系化的一般資訊，請參閱 [全球化服務](../intl/globalization-services.md)。</span><span class="sxs-lookup"><span data-stu-id="a0b7f-104">For general information about localization, see [Globalization Services](../intl/globalization-services.md).</span></span> <span data-ttu-id="a0b7f-105">當地語系化 Windows Installer 套件需要修改使用者介面所顯示的字串，也可能需要新增或修改產品資源。</span><span class="sxs-lookup"><span data-stu-id="a0b7f-105">Localizing a Windows Installer package requires modifying the strings displayed by the user interface and may also require adding or modifying product resources.</span></span> <span data-ttu-id="a0b7f-106">例如，當地語系化可能包括將國際 Dll 和當地語系化檔案新增至產品。</span><span class="sxs-lookup"><span data-stu-id="a0b7f-106">For example, localization may include the addition of international DLLs and localized files to the product.</span></span>

<span data-ttu-id="a0b7f-107">**當地語系化 Windows Installer 套件**</span><span class="sxs-lookup"><span data-stu-id="a0b7f-107">**To localize a Windows Installer package**</span></span>

1.  <span data-ttu-id="a0b7f-108">撰寫原始安裝套件時，準備進行當地語系化。</span><span class="sxs-lookup"><span data-stu-id="a0b7f-108">Prepare for localization when authoring the original installation package.</span></span> <span data-ttu-id="a0b7f-109">設計當地語系化檔案的版面配置，讓不同的語言版本在使用者的電腦上安裝時可以安全並存。</span><span class="sxs-lookup"><span data-stu-id="a0b7f-109">Design the layout of localized files such that different language versions can safely coexist when installed on the user's computer.</span></span> <span data-ttu-id="a0b7f-110">將需要當地語系化的檔案組織成個別的元件，並將這些檔案安裝在不同的目錄中。</span><span class="sxs-lookup"><span data-stu-id="a0b7f-110">Organize files requiring localization into separate components and install these files into separate directories.</span></span> <span data-ttu-id="a0b7f-111">撰寫具有中立控制頁面的基礎安裝資料庫。</span><span class="sxs-lookup"><span data-stu-id="a0b7f-111">Author a base installation database that has a neutral control page.</span></span> <span data-ttu-id="a0b7f-112">請參閱 [準備 Windows Installer 套件以進行當地語系化](preparing-a-windows-installer-package-for-localization.md)。</span><span class="sxs-lookup"><span data-stu-id="a0b7f-112">See [Preparing a Windows Installer package for localization](preparing-a-windows-installer-package-for-localization.md).</span></span>
2.  <span data-ttu-id="a0b7f-113">請一律先設定要當地語系化之資料庫的字碼頁，再加入任何當地語系化的資料。</span><span class="sxs-lookup"><span data-stu-id="a0b7f-113">Always set the code page of the database being localized prior to adding any localized data.</span></span> <span data-ttu-id="a0b7f-114">如果要當地語系化之資料庫的字碼頁是中性的，請參閱 [設定資料庫的字碼頁](setting-the-code-page-of-a-database.md)。</span><span class="sxs-lookup"><span data-stu-id="a0b7f-114">If the code page of the database being localized is neutral, see [Setting the code page of a database](setting-the-code-page-of-a-database.md).</span></span> <span data-ttu-id="a0b7f-115">若要判斷字碼頁，請參閱 [判斷安裝資料庫的字碼頁](determining-an-installation-database-s-code-page.md)。</span><span class="sxs-lookup"><span data-stu-id="a0b7f-115">To determine the code page see [Determining an installation database's code page](determining-an-installation-database-s-code-page.md).</span></span>
3.  <span data-ttu-id="a0b7f-116">將當地語系化的 [錯誤資料表](error-table.md) 和 [ActionText 資料表](actiontext-table.md) 匯入資料庫中。</span><span class="sxs-lookup"><span data-stu-id="a0b7f-116">Import a localized [Error table](error-table.md) and [ActionText table](actiontext-table.md) into the database.</span></span> <span data-ttu-id="a0b7f-117">如需詳細資訊，請參閱 [當地語系化錯誤和 ActionText 資料表](localizing-the-error-and-actiontext-tables.md) ，以取得 Microsoft WINDOWS 軟體開發套件 (SDK) 所支援的語言清單。</span><span class="sxs-lookup"><span data-stu-id="a0b7f-117">For more information, see [Localizing the Error and ActionText Tables](localizing-the-error-and-actiontext-tables.md) for a list of languages supported by the Microsoft Windows Software Development Kit (SDK).</span></span> <span data-ttu-id="a0b7f-118">您可以使用 Msidb.exe 或 [**MsiDatabaseImport**](/windows/desktop/api/Msiquery/nf-msiquery-msidatabaseimporta)來匯入這些資料表。</span><span class="sxs-lookup"><span data-stu-id="a0b7f-118">You may import these tables using Msidb.exe or [**MsiDatabaseImport**](/windows/desktop/api/Msiquery/nf-msiquery-msidatabaseimporta).</span></span>
4.  <span data-ttu-id="a0b7f-119">使用資料表編輯器或 SQL 查詢，修改資料庫中任何其他可當地語系化的資料行。</span><span class="sxs-lookup"><span data-stu-id="a0b7f-119">Modify any of the other localizable columns in the database using a table editor or SQL queries.</span></span> <span data-ttu-id="a0b7f-120">如需 SQL access 函數，請參閱 [使用查詢](working-with-queries.md)。</span><span class="sxs-lookup"><span data-stu-id="a0b7f-120">For the SQL access functions, see [Working with Queries](working-with-queries.md).</span></span> <span data-ttu-id="a0b7f-121">資料庫資料表的主題會識別可以當地語系化的資料庫資料行。</span><span class="sxs-lookup"><span data-stu-id="a0b7f-121">The topics for the database tables identify which database columns can be localized.</span></span> <span data-ttu-id="a0b7f-122">如需詳細資訊，請參閱 [資料庫資料表](database-tables.md)中的資料表清單。</span><span class="sxs-lookup"><span data-stu-id="a0b7f-122">For more information, see the list of tables in [Database Tables](database-tables.md).</span></span>
5.  <span data-ttu-id="a0b7f-123">將 [屬性工作表](property-table.md)中的 [**ProductLanguage**](productlanguage.md)屬性設定為資料庫的 LANGID。</span><span class="sxs-lookup"><span data-stu-id="a0b7f-123">Set the [**ProductLanguage**](productlanguage.md) property in the [Property table](property-table.md) to the LANGID of the database.</span></span> <span data-ttu-id="a0b7f-124">將封裝編寫為非語言相關時，請將 ProductLanguage 屬性設定為0，並使用 MS Shell Dlg 字型作為所有撰寫之對話方塊的文字樣式。</span><span class="sxs-lookup"><span data-stu-id="a0b7f-124">When authoring a package as language neutral, set the ProductLanguage property to 0 and use the MS Shell Dlg font as the text style for all authored dialog boxes.</span></span> <span data-ttu-id="a0b7f-125">因為某些字型不支援所有字元集，所以您可以使用這個字型來確保文字在所有當地語系化版本的作業系統上都已正確顯示。</span><span class="sxs-lookup"><span data-stu-id="a0b7f-125">Because some fonts do not support all of the character sets, you can ensure that the text is correctly displayed on all localized versions of the operating system by using this font.</span></span>
6.  <span data-ttu-id="a0b7f-126">設定 [ [**範本摘要**](template-summary.md) ] 屬性的 [語言] 欄位，以反映資料庫的 LANGID。</span><span class="sxs-lookup"><span data-stu-id="a0b7f-126">Set the language field of the [**Template Summary**](template-summary.md) property to reflect the LANGID of the database.</span></span>
7.  <span data-ttu-id="a0b7f-127">如果 [摘要資訊資料流程](summary-information-stream.md) 中的文字字串已當地語系化，請將 [字碼頁 [**摘要**](codepage-summary.md) ] 屬性設定為 [字碼頁]。</span><span class="sxs-lookup"><span data-stu-id="a0b7f-127">If the text strings in the [summary information stream](summary-information-stream.md) are localized, set the [**Codepage Summary**](codepage-summary.md) property to the code page.</span></span>
8.  <span data-ttu-id="a0b7f-128">設定 [屬性工作表](property-table.md)中的 [ [**ProductCode**](productcode.md) ] 屬性，並將 [[**修訂編號摘要**](revision-number-summary.md)] 屬性中的封裝程式碼設定為新的封裝程式碼。</span><span class="sxs-lookup"><span data-stu-id="a0b7f-128">Set the [**ProductCode**](productcode.md) property in the [Property table](property-table.md) and set the package code in the [**Revision Number Summary**](revision-number-summary.md) property to a new package code.</span></span> <span data-ttu-id="a0b7f-129">當地語系化的產品會視為不同的產品。</span><span class="sxs-lookup"><span data-stu-id="a0b7f-129">A localized product is considered a different product.</span></span> <span data-ttu-id="a0b7f-130">例如，應用程式的德文和英文版會視為兩個不同的產品，而且必須具有不同的產品代碼。</span><span class="sxs-lookup"><span data-stu-id="a0b7f-130">For example, the German and English versions of an application are considered two different products and must have different product codes.</span></span>
9.  <span data-ttu-id="a0b7f-131">當地語系化可能需要修改已經存在的資源，或是新增資源（例如檔案或登錄機碼）。</span><span class="sxs-lookup"><span data-stu-id="a0b7f-131">Localization may require modifying resources that already exist or the addition of new resources such as files or registry keys.</span></span> <span data-ttu-id="a0b7f-132">檢查並確定已新增新資源的每個現有元件的元件程式碼已變更。</span><span class="sxs-lookup"><span data-stu-id="a0b7f-132">Check to be sure that the component code is changed for every existing component that has had a new resource added.</span></span> <span data-ttu-id="a0b7f-133">其他修改可能也需要變更元件的程式碼。</span><span class="sxs-lookup"><span data-stu-id="a0b7f-133">Other modifications may also require changes to a component's code.</span></span> <span data-ttu-id="a0b7f-134">如需詳細資訊，請參閱 [變更元件代碼](changing-the-component-code.md)。</span><span class="sxs-lookup"><span data-stu-id="a0b7f-134">For more information see [Changing the Component Code](changing-the-component-code.md).</span></span>
10. <span data-ttu-id="a0b7f-135">藉由使用編輯工具或呼叫 [**MsiDatabaseCommit**](/windows/desktop/api/Msiquery/nf-msiquery-msidatabasecommit)儲存封裝，請務必儲存資料庫的當地語系化和其他變更。</span><span class="sxs-lookup"><span data-stu-id="a0b7f-135">Be sure to save localization and other changes to the database by saving the package with the editing tool or by calling [**MsiDatabaseCommit**](/windows/desktop/api/Msiquery/nf-msiquery-msidatabasecommit).</span></span>

<span data-ttu-id="a0b7f-136">如需詳細資訊，請參閱 [當地語系化範例](a-localization-example.md)。</span><span class="sxs-lookup"><span data-stu-id="a0b7f-136">For more information, see [A Localization Example](a-localization-example.md).</span></span>

 

 
