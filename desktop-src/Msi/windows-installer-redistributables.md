---
description: Windows Installer 可轉散發套件是軟體更新套件。
ms.assetid: 8491dfa6-b9be-4e37-8a61-a405c8eb0ab0
title: Windows Installer 可轉散發套件
ms.topic: article
ms.date: 05/19/2020
ms.openlocfilehash: 9fc175a96ae1d2daed9798981b0dbe679505975e
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/08/2021
ms.locfileid: "106983703"
---
# <a name="windows-installer-redistributables"></a>Windows Installer 可轉散發套件

Windows Installer 4.5 及更早版本是以可轉散發軟體更新套件的形式提供。 請參閱 [Windows Installer 的發行版本](released-versions-of-windows-installer.md) 一節，以判斷 Windows Installer 出貨的產品版本。 版本的可轉散發套件更新套件可在發行隨附于特定 Windows Installer 版本的產品之後取得。

> [!NOTE]
> Windows Installer 5.0 沒有可轉散發套件。 此版本隨附于 Windows 7、Windows Server 2008 R2 和更新版本的用戶端和伺服器版本中的作業系統， (包括 Windows 10) 。

## <a name="obtaining-the-windows-installer-redistributable-45-and-earlier"></a>取得 Windows Installer 可轉散發套件 (4.5 及更早版本) 

-   您可以在 [Microsoft 下載中心](https://www.microsoft.com/Downloads/)找到所有可用的 Windows Installer 可轉散發套件。
-   您可以從下列位置取得 [Windows Installer 4.5](https://support.microsoft.com/kb/942288) 可轉散發套件的下載： https://go.microsoft.com/fwlink/p/?LinkID=101159 。
-   在執行 Windows Vista、Windows Vista （含 Service Pack 1） (SP1) 和 Windows Server 2008 的 x86 電腦上安裝 Windows Installer 4.5 的可轉散發套件名稱為 Windows 6.0-KB942288-v2-x86 .MSU。
-   在執行 Windows Vista、Windows Vista SP1 和 Windows Server 2008 的 x64 電腦上安裝 Windows Installer 4.5 的可轉散發套件名稱為 Windows 6.0-KB942288-v2-x64 .MSU。
-   在執行 Windows Vista、Windows Vista SP1 和 Windows Server 2008 的 Itanium-Based 系統電腦上安裝 Windows Installer 4.5 的可轉散發套件名稱為 Windows 6.0-KB942288-v2-ia64 .MSU。
-   在執行 Windows XP （含 Service Pack 2） (SP2) 和 Windows XP （含 Service Pack 3） (SP3) 的 x86 電腦上，安裝 Windows Installer 4.5 的可轉散發套件名稱 WindowsXP-KB942288-v3-x86.exe。
-   在執行 Windows Server 2003 Service Pack 1 (SP1) 和 Windows Server 2003 Service Pack 2 (SP2) 的 x86 電腦上，安裝 Windows Installer 4.5 的可轉散發套件名稱 WindowsServer2003-KB942288-v4-x86.exe。
-   在執行 Windows Server 2003 SP1 和 Windows Server 2003 with SP2 的 x64 電腦上安裝 Windows Installer 4.5 的可轉散發套件名稱是 WindowsServer2003-KB942288-v4-x64.exe。
-   在執行 Windows Server 2003 SP1 和 Windows Server 2003 （含 SP2）的 Itanium-Based 系統電腦上，會 WindowsServer2003-KB942288-v4-ia64.exe 安裝 Windows Installer 4.5 的可轉散發套件名稱。
-   沒有可安裝 Windows Installer 4.0 的可轉散發套件。 這一版的 Windows Installer 隨附于 Windows Vista。
-   Windows Installer 3.1 安裝的可轉散發套件名稱是 WindowsInstaller-KB893803-v2-x86.exe。 您可以從下列位置取得 Windows Installer 3.1 可轉散發套件 [ (v2) ](https://www.microsoft.com/downloads/details.aspx?FamilyID=889482fc-5f56-4a38-b838-de776fd4138c) 套件的下載： https://www.microsoft.com/downloads/details.aspx?FamilyID=889482fc-5f56-4a38-b838-de776fd4138c 。
    > [!Note]  
    > 如果您安裝 Windows Server 2003 SP1 或此可轉散發套件的較舊版本，升級為 Windows Installer 3.1，您可能也需要安裝 [Windows server 2003 Service Pack 1 (KB898715) 的更新 ](https://www.microsoft.com/downloads/details.aspx?FamilyID=8b4e6b93-1886-4d47-a18d-35581c42eca0) ，以取得 Windows Installer 3.1 可轉散發套件 [ (v2) ](https://www.microsoft.com/downloads/details.aspx?FamilyID=889482fc-5f56-4a38-b838-de776fd4138c)中提供的所有更新。

     

-   Windows Installer 3.0 安裝的可轉散發套件是 WindowsInstaller-KB884016-v2-x86.exe。 您可以從下列位置取得 [Windows Installer 3.0](https://www.microsoft.com/downloads/details.aspx?FamilyID=5fbc5470-b259-4733-a914-a956122e08e8) 可轉散發套件的下載： https://www.microsoft.com/downloads/details.aspx?FamilyID=5fbc5470-b259-4733-a914-a956122e08e8 。
-   Windows Installer 2.0 對可轉散發套件： [Instmsi.exe](instmsi-exe.md)使用先前的命名慣例。 在 windows 2000 上安裝或升級至 Windows Installer 2.0 的可轉散發套件不應用來安裝或升級 Windows Server 2003 和 Windows XP 上的 Windows Installer 2.0。

    您可以從下載適用于 [Windows NT 4.0 和 Windows 2000 的 Windows Installer 2.0](https://www.microsoft.com/downloads/details.aspx?FamilyID=4b6140f9-2d36-4977-8fa1-6f8a0f5dca8f) 可轉散發套件 https://www.microsoft.com/downloads/details.aspx?FamilyID=4b6140f9-2d36-4977-8fa1-6f8a0f5dca8f 。

## <a name="installing-the-windows-installer-redistributable-45-and-earlier"></a>安裝 Windows Installer 可轉散發套件 (4.5 及更早版本) 

Windows Installer 4.5 resdistributable 是以 .msu 檔案的形式提供給 Windows Vista 和 Windows Server 2008 作業系統，而且應該使用 [Windows Update 獨立安裝程式](https://support.microsoft.com/kb/934307/) (Wusa.exe 安裝。 ) 

您可以使用下列命令列語法和選項，安裝適用于 Windows XP 和 Windows Server 2003 作業系統的 Windows Installer 4.5 可轉散發套件。

您可以使用下列命令列語法和選項來安裝 Windows Installer 3.1 和 Windows Installer 3.0 可轉散發套件。

### <a name="syntax"></a>Syntax

使用下列語法，在 Windows XP 和 Windows Server 2003 上安裝適用于 Windows Installer 4.5 的可轉散發套件。

```CMD
<Name of the Redistributable>\[<options>\]*
```

### <a name="command-line-options"></a>命令列選項

Windows Installer 可轉散發軟體更新套件使用下列不區分大小寫的命令列選項。



| 選項     | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| /norestart | 防止可轉散發套件要求使用者重新開機，即使它必須取代在安裝期間使用的檔案。 如果使用此選項叫用更新套件，如果必須取代使用中的檔案，則會傳回 **錯誤 \_ 成功 \_ 重新開機 \_** 。<br/> 如果不需要取代使用中的檔案，則會傳回 **錯誤 \_ 成功**。 如需延遲重新開機的詳細資訊，請參閱「備註」一節。<br/> |
| /quiet     | 供應用程式使用，以在啟動載入器應用程式中重新發佈 Windows Installer。 使用者介面 (UI) 不會顯示給使用者。 啟動載入應用程式應該會檢查傳回碼，以判斷是否需要重新開機才能完成 Windows Installer 安裝。<br/>                                                                                                                                                |
| /help      | 顯示所有可用選項的說明。                                                                                                                                                                                                                                                                                                                                                                                                                                     |

### <a name="delayed-restart-on-windows-vista-and-windows-server-2008"></a>Windows Vista 和 Windows Server 2008 上的延遲重新開機

/Norestart 命令列選項可防止 wusa.exe 重新開機電腦。 但是，如果 MSU 封裝正在更新的檔案正在使用中，則在使用者重新開機電腦之前，不會將套件套用到電腦上。 這表示，使用適用于 Windows Vista 和 Windows Server 2008 Windows Installer 4.5 可轉散發套件的應用程式，在重新開機電腦之前，無法使用 Windows Installer 4.5 功能。

### <a name="delayed-restart-on-windows-xp-and-windows-server-2003"></a>Windows XP 和 Windows Server 2003 上的延遲重新開機

建議您在使用更新套件時停止 Windows Installer 服務。 當封裝以完整 UI 模式執行時，它會偵測 Windows Installer 服務是否正在執行，並要求使用者停止服務。 如果使用者在不停止服務的情況下繼續，則更新會取代 Windows Installer。

使用可轉散發套件來安裝 Windows Installer 與其他[應用程式的啟動程式，](bootstrapping.md)除了安裝應用程式所需的重新開機之外，還需要額外的系統重新開機。 延遲的重新開機選項只適用于必須透過安裝使用中的檔案來消除額外重新開機所造成的情況。 開發人員應在其安裝應用程式中執行下列動作，以使用延遲的重新開機選項。

-   使用/norestart 命令列選項呼叫可轉散發套件。
-   請將 **錯誤 \_ 成功** 或 **錯誤 \_ 成功 \_ 重新開機 \_** 的傳回視為成功。
-   在應用程式的封裝上叫用 Msiexec，並執行應用程式特定的其他安裝程式程式碼。 如果安裝應用程式使用 [**MsiInstallProduct**](/windows/desktop/api/Msi/nf-msi-msiinstallproducta)，則應用程式必須從系統目錄載入 MSI.DLL。 如果未進行重新開機，且可轉散發傳回 **錯誤 \_ 成功 \_ 重新開機 \_**，則提示使用者重新開機以完成 Windows Installer 二進位檔的設定。 如果發生重新開機，則不需要其他步驟。
    > [!Note]  
    > 在可轉散發套件 LoadLibrary 之後，在新 MSI.DLL 上呼叫[](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya)的應用程式，必須確定尚未在進程中載入舊版的 MSI.DLL。 如果載入的是舊版 MSI.DLL，則必須先從進程位址空間卸載，然後再呼叫新 MSI.DLL 的 **LoadLibrary** 。

     

如需詳細資訊，請參閱 [Windows Installer](windows-installer-bootstrapping.md)啟動載入。

 

 
