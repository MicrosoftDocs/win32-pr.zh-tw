---
description: 這些章節說明修補 Windows Installer 安裝。
ms.assetid: e3c233bc-4344-449e-9e79-1a3b96ad2d08
title: 修補
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 8c3117723bda1699eeae341fc75db201421f6ae0
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/08/2021
ms.locfileid: "106988472"
---
# <a name="patching"></a><span data-ttu-id="d7246-103">修補</span><span class="sxs-lookup"><span data-stu-id="d7246-103">Patching</span></span>

<span data-ttu-id="d7246-104">使用 Microsoft Windows Installer 安裝的應用程式可以透過將更新的安裝套件重新安裝 () .msi 檔案來進行升級，或將 Windows Installer 修補程式 (.msp 檔) 套用至應用程式。</span><span class="sxs-lookup"><span data-stu-id="d7246-104">An application that has been installed using the Microsoft Windows Installer can be upgraded by reinstalling an updated installation package (.msi file), or by applying a Windows Installer patch (an .msp file) to the application.</span></span>

<span data-ttu-id="d7246-105">Windows Installer 修補程式 ( .msp 檔) 是包含應用程式更新的獨立套件，並描述應用程式可接收修補程式的版本。</span><span class="sxs-lookup"><span data-stu-id="d7246-105">A Windows Installer patch (.msp file) is a self-contained package that contains the updates to the application and describes which versions of the application can receive the patch.</span></span> <span data-ttu-id="d7246-106">修補程式至少包含兩個資料庫轉換，而且可以包含儲存在修補程式套件的封包檔串流中的修補檔案。</span><span class="sxs-lookup"><span data-stu-id="d7246-106">Patches contain at a minimum, two database transforms and can contain patch files that are stored in the cabinet file stream of the patch package.</span></span> <span data-ttu-id="d7246-107">如需 Windows Installer 修補程式套件元件的詳細資訊，請參閱 [修補套件](patch-packages.md)。</span><span class="sxs-lookup"><span data-stu-id="d7246-107">For more information about the parts of a Windows Installer patch package, see [Patch Packages](patch-packages.md).</span></span>

<span data-ttu-id="d7246-108">藉由提供 Windows Installer 修補程式來服務應用程式，而不是更新產品的完整安裝套件，可能有其優點。</span><span class="sxs-lookup"><span data-stu-id="d7246-108">Servicing applications by delivering a Windows Installer patch, rather than a complete installation package for the updated product can have advantages.</span></span> <span data-ttu-id="d7246-109">修補程式可包含整個檔案，或只包含更新部分檔案所需的檔案位。</span><span class="sxs-lookup"><span data-stu-id="d7246-109">A patch can contain an entire file or only the file bits necessary to update part of the file.</span></span> <span data-ttu-id="d7246-110">這可讓使用者下載的升級修補程式，比整個產品的安裝套件小得多。</span><span class="sxs-lookup"><span data-stu-id="d7246-110">This can enable the user to download an upgrade patch that is much smaller than the installation package for the entire product.</span></span> <span data-ttu-id="d7246-111">使用修補程式的更新可以透過升級來保留應用程式的使用者自訂。</span><span class="sxs-lookup"><span data-stu-id="d7246-111">An update using a patch can preserve a user customization of the application through the upgrade.</span></span>

<span data-ttu-id="d7246-112">\* \* Windows Installer 4.5 和更新版本： \* \*</span><span class="sxs-lookup"><span data-stu-id="d7246-112">\*\*Windows Installer 4.5 and later:  \*\*</span></span>

<span data-ttu-id="d7246-113">從 Windows Installer 4.5 開始，開發人員可以使用 [元件資料表](component-table.md)中的 **msidbComponentAttributesUninstallOnSupersedence** 值來標記修補程式中的元件。</span><span class="sxs-lookup"><span data-stu-id="d7246-113">Beginning with Windows Installer 4.5, developers can mark components in a patch with the **msidbComponentAttributesUninstallOnSupersedence** value in the [Component table](component-table.md).</span></span> <span data-ttu-id="d7246-114">如果已安裝後續修補程式，並在其 [MsiPatchSequence 資料表](msipatchsequence-table.md)中標示 **msidbPatchSequenceSupersedeEarlier** 值來取代第一個修補程式，Windows Installer 4.5 和更新版本可以取消註冊並卸載標示為 **msidbComponentAttributesUninstallOnSupersedence** 的元件，以避免在電腦上留下未使用的元件。</span><span class="sxs-lookup"><span data-stu-id="d7246-114">If a subsequent patch is installed, marked with the **msidbPatchSequenceSupersedeEarlier** value in its [MsiPatchSequence table](msipatchsequence-table.md) to supersede the first patch, Windows Installer 4.5 and later can unregister and uninstall components marked **msidbComponentAttributesUninstallOnSupersedence** to prevent leaving behind unused components on the computer.</span></span> <span data-ttu-id="d7246-115">如果元件未以這個位標示，則取代修補程式的安裝可能會在電腦上留下未使用的元件。</span><span class="sxs-lookup"><span data-stu-id="d7246-115">If the component is not marked with with this bit, installation of the superseding patch can leave an unused component on the computer.</span></span> <span data-ttu-id="d7246-116">設定 **MSIUNINSTALLSUPERSEDEDCOMPONENTS** 屬性的效果與設定所有元件的這個位相同。</span><span class="sxs-lookup"><span data-stu-id="d7246-116">Setting the **MSIUNINSTALLSUPERSEDEDCOMPONENTS** property has the same effect as setting this bit for all components.</span></span>

<span data-ttu-id="d7246-117">\* \* Windows Installer 3.0 和更新版本： \* \*</span><span class="sxs-lookup"><span data-stu-id="d7246-117">\*\*Windows Installer 3.0 and later:  \*\*</span></span>

<span data-ttu-id="d7246-118">使用 Windows Installer 3.0 的開發人員，以及撰寫具有 [MsiPatchSequence 資料表](msipatchsequence-table.md) 的 patch 封裝，可以建立可執行下列作業的 patch 封裝：</span><span class="sxs-lookup"><span data-stu-id="d7246-118">Developers who use Windows Installer 3.0, and author patch packages that have the [MsiPatchSequence table](msipatchsequence-table.md) can create patch packages that do the following:</span></span>

-   <span data-ttu-id="d7246-119">使用安裝程式快取的產品基準，更輕鬆地以較小的 delta 修補程式來服務應用程式。</span><span class="sxs-lookup"><span data-stu-id="d7246-119">Use the product baseline cached by the installer to more easily service applications with smaller delta patches.</span></span> <span data-ttu-id="d7246-120">如需使用產品基準的詳細資訊，請參閱 [減少修補程式大小](reducing-patch-size.md)。</span><span class="sxs-lookup"><span data-stu-id="d7246-120">For more information about using the product baseline, see [Reducing Patch Size](reducing-patch-size.md).</span></span>
-   <span data-ttu-id="d7246-121">略過修補程式未修改的特定資料表相關聯的動作。</span><span class="sxs-lookup"><span data-stu-id="d7246-121">Skip actions associated with specific tables that are unmodified by the patch.</span></span> <span data-ttu-id="d7246-122">這可大幅縮短安裝修補程式所需的時間。</span><span class="sxs-lookup"><span data-stu-id="d7246-122">This can significantly reduce the time required to install the patch.</span></span> <span data-ttu-id="d7246-123">如需可略過哪些資料表的詳細資訊，請參閱 [修補程式優化](patch-optimization.md)。</span><span class="sxs-lookup"><span data-stu-id="d7246-123">For more information about which tables can be skipped, see [Patch Optimization](patch-optimization.md).</span></span>
-   <span data-ttu-id="d7246-124">建立並安裝可單獨卸載的修補程式，而不需要卸載並重新安裝整個應用程式和其他修補程式。</span><span class="sxs-lookup"><span data-stu-id="d7246-124">Create and install patches that can be uninstalled singly, and in any order, without having to uninstall and reinstall the entire application and other patches.</span></span> <span data-ttu-id="d7246-125">如需卸載修補程式的詳細資訊，請參閱 [移除修補程式](removing-patches.md)。</span><span class="sxs-lookup"><span data-stu-id="d7246-125">For more information about uninstalling patches, see [Removing Patches](removing-patches.md).</span></span>
-   <span data-ttu-id="d7246-126">以固定順序套用修補程式，而不考慮將修補程式提供給系統的順序。</span><span class="sxs-lookup"><span data-stu-id="d7246-126">Apply patches in a constant order regardless of the order that the patches are provided to the system.</span></span> <span data-ttu-id="d7246-127">如需 Windows Installer 如何決定用來套用修補程式之順序的詳細資訊，請參閱將 [修補程式排序](sequencing-patches.md)。</span><span class="sxs-lookup"><span data-stu-id="d7246-127">For more information about how the Windows Installer determines the sequence used to apply patches, see [Sequencing Patches](sequencing-patches.md).</span></span>
-   <span data-ttu-id="d7246-128">將修補程式套用到已安裝在個別使用者管理內容中的應用程式。</span><span class="sxs-lookup"><span data-stu-id="d7246-128">Apply patches to an application that has been installed in a per-user-managed context.</span></span> <span data-ttu-id="d7246-129">如需詳細資訊，請參閱 [修補 Per-User 受控應用程式](patching-per-user-managed-applications.md)。</span><span class="sxs-lookup"><span data-stu-id="d7246-129">For more information, see [Patching Per-User Managed Applications](patching-per-user-managed-applications.md).</span></span>

<span data-ttu-id="d7246-130">\* \* Windows Installer 2.0： \* \*</span><span class="sxs-lookup"><span data-stu-id="d7246-130">\*\*Windows Installer 2.0:  \*\*</span></span>

<span data-ttu-id="d7246-131">不支援 [MsiPatchSequence 資料表](msipatchsequence-table.md) 。</span><span class="sxs-lookup"><span data-stu-id="d7246-131">The [MsiPatchSequence table](msipatchsequence-table.md) is not supported.</span></span> <span data-ttu-id="d7246-132">從 Windows Installer 3.0 開始，修補套件可以包含描述修補程式順序的資訊，相對於其他更新和其他描述性資訊。</span><span class="sxs-lookup"><span data-stu-id="d7246-132">Beginning with Windows Installer 3.0, patch packages can contain information that describes the patching sequence for the patch relative to other updates and additional descriptive information.</span></span>

<span data-ttu-id="d7246-133">建立修補程式套件的建議方法是使用修補程式建立工具，例如 [Msimsp.exe](msimsp-exe.md) 和 [Patchwiz.dll](patchwiz-dll.md)。</span><span class="sxs-lookup"><span data-stu-id="d7246-133">The recommended method for creating a patch package is to use patch creation tools such as [Msimsp.exe](msimsp-exe.md) and [Patchwiz.dll](patchwiz-dll.md).</span></span> <span data-ttu-id="d7246-134">開發人員可以產生 patch 建立檔案，如「 [建立修補程式套件](creating-a-patch-package.md)」一節所述。</span><span class="sxs-lookup"><span data-stu-id="d7246-134">Developers can generate a patch creation file as described in the section: [Creating a Patch Package](creating-a-patch-package.md).</span></span> <span data-ttu-id="d7246-135">小型更新修補 [範例](a-small-update-patching-example.md)一節會說明如何建立小型更新修補程式。</span><span class="sxs-lookup"><span data-stu-id="d7246-135">The creation of a small update patch is described in the section: [A Small Update Patching Example](a-small-update-patching-example.md).</span></span>

<span data-ttu-id="d7246-136">Microsoft Windows Installer 接受統一資源定位器 (URL) 作為修補程式的有效來源。</span><span class="sxs-lookup"><span data-stu-id="d7246-136">Microsoft Windows Installer accepts a Uniform Resource Locator (URL) as a valid source for a patch.</span></span> <span data-ttu-id="d7246-137">如需如何安裝位於 Web 服務器上之修補程式的詳細資訊，請參閱 [從網際網路下載並安裝修補程式](downloading-and-installing-a-patch-from-the-internet.md)。</span><span class="sxs-lookup"><span data-stu-id="d7246-137">For more information about how to install a patch located on a Web server, see [Downloading and Installing a Patch From the Internet](downloading-and-installing-a-patch-from-the-internet.md).</span></span>

<span data-ttu-id="d7246-138">當您第一次安裝應用程式時，可以將單一 Windows Installer 修補程式 ( .msp 檔) 套用至安裝套件。</span><span class="sxs-lookup"><span data-stu-id="d7246-138">A single Windows Installer patch (.msp file) can be applied to the installation package when installing an application for the first time.</span></span> <span data-ttu-id="d7246-139">如需詳細資訊，請參閱 [修補初始安裝](patching-initial-installations.md)。</span><span class="sxs-lookup"><span data-stu-id="d7246-139">For more information, see [Patching Initial Installations](patching-initial-installations.md).</span></span>

<span data-ttu-id="d7246-140">當修補程式的應用程式可能需要存取原始安裝來源時，不可能消除所有的情況。</span><span class="sxs-lookup"><span data-stu-id="d7246-140">It is not possible to eliminate all circumstances when the application of a patch may require access to the original installation source.</span></span> <span data-ttu-id="d7246-141">不過，若要將修補程式需要存取原始來源的可能性降至最低，請遵循下一節所列的點： [防止 Patch 要求存取原始安裝來源](preventing-a-patch-from-requiring-access-to-the-original-installation-source.md)。</span><span class="sxs-lookup"><span data-stu-id="d7246-141">However, to minimize the possibility that your patch will require access to the original source, adhere to the points listed in the following section: [Preventing a Patch from Requiring Access to the Original Installation Source](preventing-a-patch-from-requiring-access-to-the-original-installation-source.md).</span></span>

<span data-ttu-id="d7246-142">為了將修補程式未因後續自訂轉換而中斷的可能性降至最低，通常會先安裝修補程式，然後再進行自訂。</span><span class="sxs-lookup"><span data-stu-id="d7246-142">To minimize the possibility that your patch is not broken by a subsequent customization transform, typically the patch is installed first, followed by the customization.</span></span> <span data-ttu-id="d7246-143">先安裝自訂轉換，然後再安裝修補程式，可能會中斷自訂作業。</span><span class="sxs-lookup"><span data-stu-id="d7246-143">Installing customization transforms first, and then the patch, may break the customization.</span></span> <span data-ttu-id="d7246-144">如需修補自訂應用程式的詳細資訊，請參閱 [修補自訂應用程式](patching-customized-applications.md)。</span><span class="sxs-lookup"><span data-stu-id="d7246-144">For more information about patching customized applications, see [Patching Customized Applications](patching-customized-applications.md).</span></span>

 

 



