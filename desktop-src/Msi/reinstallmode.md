---
description: REINSTALLMODE 屬性是一個字串，其中包含指定要執行之重新安裝類型的字母。
ms.assetid: 756d2899-2cfe-473a-bebf-a7f7bbe7d229
title: REINSTALLMODE 屬性
ms.topic: reference
ms.date: 05/31/2018
ms.openlocfilehash: ab48043ef92770cbc3a1f5ab92e459128c9945ed
ms.sourcegitcommit: c8ec1ded1ffffc364d3c4f560bb2171da0dc5040
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 03/22/2021
ms.locfileid: "106976091"
---
# <a name="reinstallmode-property"></a><span data-ttu-id="7e14b-103">REINSTALLMODE 屬性</span><span class="sxs-lookup"><span data-stu-id="7e14b-103">REINSTALLMODE property</span></span>

<span data-ttu-id="7e14b-104">**REINSTALLMODE** 屬性是一個字串，其中包含指定要執行之重新安裝類型的字母。</span><span class="sxs-lookup"><span data-stu-id="7e14b-104">The **REINSTALLMODE** property is a string that contains letters specifying the type of reinstall to perform.</span></span> <span data-ttu-id="7e14b-105">選項不區分大小寫，且順序無關。</span><span class="sxs-lookup"><span data-stu-id="7e14b-105">Options are case-insensitive and order-independent.</span></span> <span data-ttu-id="7e14b-106">這個屬性通常一律會與 [**重新安裝**](reinstall.md) 屬性搭配使用。</span><span class="sxs-lookup"><span data-stu-id="7e14b-106">This property should normally always be used in conjunction with the [**REINSTALL**](reinstall.md) property.</span></span> <span data-ttu-id="7e14b-107">不過，在安裝期間也可以使用這個屬性，而不只是重新安裝。</span><span class="sxs-lookup"><span data-stu-id="7e14b-107">However, this property can also be used during installation, not just reinstall.</span></span>

> [!Note]  
> <span data-ttu-id="7e14b-108">Windows Installer 會在 [系統管理安裝](administrative-installation.md)期間忽略 **REINSTALLMODE** 屬性。</span><span class="sxs-lookup"><span data-stu-id="7e14b-108">The Windows Installer ignores the **REINSTALLMODE** property during an [administrative installation](administrative-installation.md).</span></span>

 

## <a name="reinstall-option-codes"></a><span data-ttu-id="7e14b-109">重新安裝選項代碼</span><span class="sxs-lookup"><span data-stu-id="7e14b-109">Reinstall Option Codes</span></span>

<span data-ttu-id="7e14b-110">依預設， **REINSTALLMODE** 為 "omus reinstall"。</span><span class="sxs-lookup"><span data-stu-id="7e14b-110">By default the **REINSTALLMODE** is "omus".</span></span>



| <span data-ttu-id="7e14b-111">程式碼</span><span class="sxs-lookup"><span data-stu-id="7e14b-111">Code</span></span> | <span data-ttu-id="7e14b-112">選項</span><span class="sxs-lookup"><span data-stu-id="7e14b-112">Option</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="7e14b-113">p</span><span class="sxs-lookup"><span data-stu-id="7e14b-113">p</span></span>    | <span data-ttu-id="7e14b-114">只有在檔案遺失時才重新安裝。</span><span class="sxs-lookup"><span data-stu-id="7e14b-114">Reinstall only if the file is missing.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| <span data-ttu-id="7e14b-115">o</span><span class="sxs-lookup"><span data-stu-id="7e14b-115">o</span></span>    | <span data-ttu-id="7e14b-116">如果檔案遺失或較舊的版本，請重新安裝。</span><span class="sxs-lookup"><span data-stu-id="7e14b-116">Reinstall if the file is missing or is an older version.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| <span data-ttu-id="7e14b-117">e</span><span class="sxs-lookup"><span data-stu-id="7e14b-117">e</span></span>    | <span data-ttu-id="7e14b-118">如果檔案遺失或相同或較舊的版本，請重新安裝。</span><span class="sxs-lookup"><span data-stu-id="7e14b-118">Reinstall if the file is missing, or is an equal or older version.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| <span data-ttu-id="7e14b-119">d</span><span class="sxs-lookup"><span data-stu-id="7e14b-119">d</span></span>    | <span data-ttu-id="7e14b-120">如果檔案遺失或有不同的版本，請重新安裝。</span><span class="sxs-lookup"><span data-stu-id="7e14b-120">Reinstall if the file is missing or a different version is present.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| <span data-ttu-id="7e14b-121">c</span><span class="sxs-lookup"><span data-stu-id="7e14b-121">c</span></span>    | <span data-ttu-id="7e14b-122">確認總和檢查碼值，如果檔案遺失或損毀，請重新安裝。</span><span class="sxs-lookup"><span data-stu-id="7e14b-122">Verify the checksum values, and reinstall the file if they are missing or corrupt.</span></span> <span data-ttu-id="7e14b-123">此旗標只會修復檔案 [資料表](file-table.md)的 [屬性] 資料行中有 msidbFileAttributesChecksum 的檔案。</span><span class="sxs-lookup"><span data-stu-id="7e14b-123">This flag only repairs files that have msidbFileAttributesChecksum in the Attributes column of the [File Table](file-table.md).</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| <span data-ttu-id="7e14b-124">a</span><span class="sxs-lookup"><span data-stu-id="7e14b-124">a</span></span>    | <span data-ttu-id="7e14b-125">無論總和檢查碼或版本為何，都強制重新安裝所有檔案。</span><span class="sxs-lookup"><span data-stu-id="7e14b-125">Force all files to be reinstalled, regardless of checksum or version.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| <span data-ttu-id="7e14b-126">u</span><span class="sxs-lookup"><span data-stu-id="7e14b-126">u</span></span>    | <span data-ttu-id="7e14b-127">從登錄 [資料表](registry-table.md) 中，將所有必要的登錄專案重新寫入至 **HKEY \_ 目前 \_ 使用者**</span><span class="sxs-lookup"><span data-stu-id="7e14b-127">Rewrite all required registry entries from the [Registry Table](registry-table.md) that go to the **HKEY\_CURRENT\_USER**</span></span><br/> <span data-ttu-id="7e14b-128">或 **HKEY \_ 使用者**</span><span class="sxs-lookup"><span data-stu-id="7e14b-128">or **HKEY\_USERS**</span></span><br/> <span data-ttu-id="7e14b-129">登錄 hive。</span><span class="sxs-lookup"><span data-stu-id="7e14b-129">registry hive.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| <span data-ttu-id="7e14b-130">m</span><span class="sxs-lookup"><span data-stu-id="7e14b-130">m</span></span>    | <span data-ttu-id="7e14b-131">從移至 **HKEY \_ 本機 \_ 電腦** 的登錄 [資料表](registry-table.md)重寫所有必要的登錄專案</span><span class="sxs-lookup"><span data-stu-id="7e14b-131">Rewrite all required registry entries from the [Registry Table](registry-table.md) that go to the **HKEY\_LOCAL\_MACHINE**</span></span><br/> <span data-ttu-id="7e14b-132">或 **HKEY \_ 類別 \_ 根目錄**</span><span class="sxs-lookup"><span data-stu-id="7e14b-132">or **HKEY\_CLASSES\_ROOT**</span></span><br/> <span data-ttu-id="7e14b-133">登錄 hive。</span><span class="sxs-lookup"><span data-stu-id="7e14b-133">registry hive.</span></span> <span data-ttu-id="7e14b-134">從 [類別資料表](class-table.md)、 [動詞資料表](verb-table.md)、 [PublishComponent 資料表](publishcomponent-table.md)、 [ProgID 資料表](progid-table.md)、 [MIME 資料表](mime-table.md)、 [圖示資料表](icon-table.md)、 [延伸資料表](extension-table.md)和 [AppID 資料表](appid-table.md) 重寫所有資訊，而不論電腦或使用者指派為何。</span><span class="sxs-lookup"><span data-stu-id="7e14b-134">Rewrite all information from the [Class Table](class-table.md), [Verb Table](verb-table.md), [PublishComponent Table](publishcomponent-table.md), [ProgID Table](progid-table.md), [MIME Table](mime-table.md), [Icon Table](icon-table.md), [Extension Table](extension-table.md), and [AppID Table](appid-table.md) regardless of machine or user assignment.</span></span> <span data-ttu-id="7e14b-135">重新安裝所有 [**合格元件。**](/windows/desktop/api/Msi/nf-msi-msiprovidequalifiedcomponenta)重新安裝應用程式時，此選項會執行 [RegisterTypeLibraries](registertypelibraries-action.md) 和 [InstallODBC](installodbc-action.md) 動作。</span><span class="sxs-lookup"><span data-stu-id="7e14b-135">Reinstall all [**qualified components.**](/windows/desktop/api/Msi/nf-msi-msiprovidequalifiedcomponenta)When reinstalling an application, this option runs the [RegisterTypeLibraries](registertypelibraries-action.md) and [InstallODBC](installodbc-action.md) actions.</span></span><br/> |
| <span data-ttu-id="7e14b-136">s</span><span class="sxs-lookup"><span data-stu-id="7e14b-136">s</span></span>    | <span data-ttu-id="7e14b-137">重新安裝所有的快捷方式，並重新快取所有圖示，以覆寫任何現有的快捷方式和圖示。</span><span class="sxs-lookup"><span data-stu-id="7e14b-137">Reinstall all shortcuts and re-cache all icons overwriting any existing shortcuts and icons.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| <span data-ttu-id="7e14b-138">v</span><span class="sxs-lookup"><span data-stu-id="7e14b-138">v</span></span>    | <span data-ttu-id="7e14b-139">使用從來源套件執行，然後重新快取本機封裝。</span><span class="sxs-lookup"><span data-stu-id="7e14b-139">Use to run from the source package and re-cache the local package.</span></span> <span data-ttu-id="7e14b-140">在第一次安裝應用程式或功能時，請勿使用 v 重新安裝選項程式碼。</span><span class="sxs-lookup"><span data-stu-id="7e14b-140">Do not use the v reinstall option code for the first installation of an application or feature.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |



 

<span data-ttu-id="7e14b-141">如果定義 **REINSTALLMODE** 屬性時未同時定義 [**重新安裝**](reinstall.md) 內容，則仍會套用指定的「偵測」模式，並指定一般安裝的「覆寫」模式。</span><span class="sxs-lookup"><span data-stu-id="7e14b-141">If the **REINSTALLMODE** property is defined without also defining the [**REINSTALL**](reinstall.md) property, then the specified "detection" modes still apply and specify the "overwrite" mode for a normal installation.</span></span> <span data-ttu-id="7e14b-142">**REINSTALLMODE** 屬性只會影響一般為安裝所選取的功能。</span><span class="sxs-lookup"><span data-stu-id="7e14b-142">The **REINSTALLMODE** property only affects those features that are selected normally for installation.</span></span> <span data-ttu-id="7e14b-143">**REINSTALLMODE** 屬性的存在並不會重新安裝功能。</span><span class="sxs-lookup"><span data-stu-id="7e14b-143">The presence of the **REINSTALLMODE** property does not reinstall features.</span></span> <span data-ttu-id="7e14b-144">重新安裝功能需要 **重新安裝** 屬性。</span><span class="sxs-lookup"><span data-stu-id="7e14b-144">The reinstallation of features requires the presence of the **REINSTALL** property.</span></span>

<span data-ttu-id="7e14b-145">這個屬性的選項代碼會對應至 [命令列選項](command-line-options.md) '/f '。</span><span class="sxs-lookup"><span data-stu-id="7e14b-145">The option codes for this property correspond to the [command-line option](command-line-options.md) '/f'.</span></span> <span data-ttu-id="7e14b-146">命令列選項的預設值為 ' pecms '。</span><span class="sxs-lookup"><span data-stu-id="7e14b-146">The command-line option has a default value of 'pecms'.</span></span>

> [!Note]  
> <span data-ttu-id="7e14b-147">只會驗證並修復包含總和檢查碼資訊的檔案。</span><span class="sxs-lookup"><span data-stu-id="7e14b-147">Only those files containing checksum information are ever verified and repaired.</span></span> <span data-ttu-id="7e14b-148">\_上述 ccode (的 REINSTALLMODE FILEVERIFY 旗標) 只會修復檔案[資料表](file-table.md)之 [屬性] 資料行中具有 msidbFileAttributesChecksum 的檔案。</span><span class="sxs-lookup"><span data-stu-id="7e14b-148">The REINSTALLMODE\_FILEVERIFY flag (the ccode above) only repairs files that have msidbFileAttributesChecksum in the Attributes column of the [File Table](file-table.md).</span></span>

 

## <a name="requirements"></a><span data-ttu-id="7e14b-149">規格需求</span><span class="sxs-lookup"><span data-stu-id="7e14b-149">Requirements</span></span>



| <span data-ttu-id="7e14b-150">需求</span><span class="sxs-lookup"><span data-stu-id="7e14b-150">Requirement</span></span> | <span data-ttu-id="7e14b-151">值</span><span class="sxs-lookup"><span data-stu-id="7e14b-151">Value</span></span> |
|--------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="7e14b-152">版本</span><span class="sxs-lookup"><span data-stu-id="7e14b-152">Version</span></span><br/> | <span data-ttu-id="7e14b-153">Windows Server 2012、Windows 8、Windows Server 2008 R2 或 Windows 7 上的 Windows Installer 5.0。</span><span class="sxs-lookup"><span data-stu-id="7e14b-153">Windows Installer 5.0 on Windows Server 2012, Windows 8, Windows Server 2008 R2 or Windows 7.</span></span> <span data-ttu-id="7e14b-154">Windows Server 2008 或 Windows Vista 上的 Windows Installer 4.0 或 Windows Installer 4.5。</span><span class="sxs-lookup"><span data-stu-id="7e14b-154">Windows Installer 4.0 or Windows Installer 4.5 on Windows Server 2008 or Windows Vista.</span></span> <span data-ttu-id="7e14b-155">Windows Server 2003 或 Windows XP 上的 Windows Installer。</span><span class="sxs-lookup"><span data-stu-id="7e14b-155">Windows Installer on Windows Server 2003 or Windows XP.</span></span> <span data-ttu-id="7e14b-156">如需 Windows Installer 版本所需的最小 Windows service pack 相關資訊，請參閱 [Windows Installer Run-Time 需求](windows-installer-portal.md) 。</span><span class="sxs-lookup"><span data-stu-id="7e14b-156">See the [Windows Installer Run-Time Requirements](windows-installer-portal.md) for information about the minimum Windows service pack that is required by a Windows Installer version.</span></span><br/> |



## <a name="see-also"></a><span data-ttu-id="7e14b-157">另請參閱</span><span class="sxs-lookup"><span data-stu-id="7e14b-157">See also</span></span>

<dl> <dt>

[<span data-ttu-id="7e14b-158">屬性</span><span class="sxs-lookup"><span data-stu-id="7e14b-158">Properties</span></span>](properties.md)
</dt> </dl>

 

 




