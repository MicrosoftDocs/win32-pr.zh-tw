---
description: 由於不必要的檔案複製會使安裝變慢，Windows Installer 可判斷是否已安裝元件的金鑰檔，然後再嘗試安裝任何元件的檔案。
ms.assetid: 8be734c7-4f16-4f54-93db-bb8efb1ea6da
title: 取代現有的檔案
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f1fb8075aae2c7e217235eb8c84607106efe839bcbfd12ed4b658f4ed5df6182
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/11/2021
ms.locfileid: "117990573"
---
# <a name="replacing-existing-files"></a>取代現有的檔案

由於不必要的檔案複製會使安裝變慢，Windows Installer 可判斷是否已安裝元件的金鑰檔，然後再嘗試安裝任何元件的檔案。 如果安裝程式找到的檔案與安裝在目標位置中的元件金鑰檔名稱相同，則會比較兩個金鑰檔的版本、日期和語言，並使用檔案版本控制規則來判斷是否要安裝封裝所提供的元件。 如果安裝程式判斷需要在金鑰檔上取代元件基底，則會在每個已安裝的檔案上使用檔案版本控制規則，以判斷是否要取代檔案。

請注意，使用已建立版本的檔案撰寫安裝套件時， [檔資料表](file-table.md) 之 [版本] 欄中的版本字串必須一律與封裝隨附的檔案版本相同。

您可以使用 [**REINSTALLMODE**](reinstallmode.md) 屬性來覆寫或修改預設檔案版本控制規則。 安裝、重新安裝或修復檔案時，安裝程式會使用 **REINSTALLMODE** 屬性所指定的檔案版本控制規則。 下列範例顯示安裝程式如何套用預設檔案 [版本控制規則](file-versioning-rules.md)。 **REINSTALLMODE** 屬性的預設值為 "omus reinstall"。

安裝元件之前，系統會先在系統上安裝下列元件金鑰檔。



| 檔案                                    | 版本  | 建立日期 | 修改日期 | 語言    |
|-----------------------------------------|----------|-------------|---------------|-------------|
| >filea.docx                                   | 1.0.0000 | 1/1/99      | 1/1/99        | ENG         |
| >fileb.docx                                   | 2.0.0000 | 1/1/99      | 1/1/99        | ENG         |
| FileC                                   | 1.0.0000 | 1/1/99      | 1/1/99        | ENG         |
| 提交                                   | 1.0.0000 | 1/1/99      | 1/2/99        | ENG         |
| 檔案                                   | 無     | 1/1/99      | 1/1/99        | 無        |
| FileF (修改 > 建立) <br/> | 無     | 1/1/99      | 1/2/99        | 無        |
| FileG                                   | 1.0.0000 | 1/1/99      | 1/1/99        | ENG         |
| FileH                                   | 1.0.0000 | 1/1/99      | 1/1/99        | ENG、FRN、SPN |
| FileI                                   | 1.0.0000 | 1/1/99      | 1/1/99        | ENG、FRN     |
| FileJ                                   | 1.0.0000 | 1/1/99      | 1/1/99        | ENG、GER、ITN |



 

下列元件金鑰檔包含在安裝程式套件中。



| 檔案                               | 版本  | 建立日期 | 修改日期 | 語言    |
|------------------------------------|----------|-------------|---------------|-------------|
| >filea.docx (標示為相同) <br/>     | 1.0.0000 | 1/1/99      | 1/1/99        | ENG         |
| >fileb.docx (舊版) <br/> | 1.0.0000 | 1/1/99      | 1/1/99        | ENG         |
| FileC (更新版本) <br/>   | 2.0.0000 | 1/1/99      | 1/1/99        | ENG         |
|  (更新版本) 的欄位<br/>   | 2.0.0000 | 12/31/98    | 1/10/99       | FRN         |
| 檔案 (標示為相同) <br/>     | 無     | 1/1/99      | 1/1/99        | 無        |
| FileF (new file) <br/>        | 無     | 1/3/99      | 1/3/99        | 無        |
| FileG (新語言) <br/>    | 1.0.0000 | 1/1/99      | 1/1/99        | FRN         |
| FileH (新語言) <br/>    | 1.0.0000 | 1/1/99      | 1/1/99        | ITN，ENG，GER |
| FileI (更多語言) <br/>  | 1.0.0000 | 1/1/99      | 1/1/99        | ENG、FRN、SPN |
| FileJ (的語言較少) <br/> | 1.0.0000 | 1/1/99      | 1/1/99        | 德國         |



 

重新安裝元件之後，系統會在系統上保留下列元件金鑰檔。 金鑰檔的狀態決定元件中任何其他檔案的狀態。



| 檔案                | 版本  | 建立日期 | 修改日期 | 語言    |
|---------------------|----------|-------------|---------------|-------------|
| >filea.docx (原始)     | 1.0.0000 | 1/1/99      | 1/1/99        | ENG         |
| >fileb.docx (原始)     | 2.0.0000 | 1/1/99      | 1/1/99        | ENG         |
| FileC (取代)  | 2.0.0000 | 1/1/99      | 1/1/99        | ENG         |
|  (取代)  | 2.0.0000 | 12/31/98    | 1/10/99       | FRN         |
| 檔案 (取代)  | 無     | 1/1/99      | 1/1/99        | 無        |
| FileF (原始)     | 無     | 1/1/99      | 1/2/99        | 無        |
| FileG (取代)  | 1.0.0000 | 1/1/99      | 1/1/99        | FRN         |
| FileH (取代)  | 1.0.0000 | 1/1/99      | 1/1/99        | ITN，ENG，GER |
| FileI (取代)  | 1.0.0000 | 1/1/99      | 1/1/99        | ENG、FRN、SPN |
| FileJ (原始)     | 1.0.0000 | 1/1/99      | 1/1/99        | ENG、GER、ITN |



 

## <a name="related-topics"></a>相關主題

<dl> <dt>

[安裝期間的 CRC 檢查](crc-checking-during-an-installation.md)
</dt> </dl>

 

 




