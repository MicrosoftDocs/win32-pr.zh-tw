---
description: 搭配 Windows Installer 使用的電腦系統原則。
ms.assetid: af47dc84-2190-4e73-9d87-d5ddb0584ce7
title: 電腦原則
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 2885d2b5ca3c397e3b88f2eb5d38ad5dfbe896d56de397157081d4f08533a183
ms.sourcegitcommit: e6600f550f79bddfe58bd4696ac50dd52cb03d7e
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/11/2021
ms.locfileid: "119692469"
---
# <a name="machine-policies"></a>電腦原則

您可以設定下列電腦原則：

**HKEY \_本機 \_ 電腦** \\ **軟體** \\ **原則** \\ **Microsoft** \\ **Windows** \\ **安裝程式**



| 原則                                                                                    | 值資料類型           | 描述                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|-------------------------------------------------------------------------------------------|---------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [AlwaysInstallElevated](alwaysinstallelevated.md)<br/>                             | **REG \_ DWORD**<br/> | 如果此原則值設定為1，且對應的使用者值也已設定，則安裝程式一律會以較高的許可權進行安裝。<br/> 否則，安裝程式會使用較高的許可權來安裝受控應用程式，並針對未受管理的應用程式使用目前使用者的許可權層級。<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| [AllowLockdownBrowse](allowlockdownbrowse.md)<br/>                                 | **REG \_ DWORD**<br/> | 如果此原則值設定為1，非系統管理使用者可以在以較高的許可權執行安裝時，流覽新的來源。 預設值是只有系統管理員可以在提高許可權的安裝期間流覽來源。 設定此原則也可讓非系統管理使用者在提高許可權的安裝期間，以 LocalSystem 許可權執行程式。<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| [AllowLockdownMedia](allowlockdownmedia.md)<br/>                                   | **REG \_ DWORD**<br/> | 如果此原則值設定為1，非系統管理使用者可以使用媒體來源（例如 CD-ROM），同時以較高的許可權執行安裝。 預設值是只有系統管理員可以在提高許可權的安裝期間使用媒體來源。 設定此原則也可讓非系統管理使用者在提高許可權的安裝期間，以 LocalSystem 許可權執行程式。<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| [AllowLockdownPatch](allowlockdownpatch.md)<br/>                                   | **REG \_ DWORD**<br/> | 如果未設定每部電腦的系統原則值，則只有系統管理員可以修補以較高許可權安裝的現有產品。 如果此原則值設定為1，非系統管理使用者在某些情況下，可以在使用較高的許可權執行安裝時，將修補程式套用至產品。 使用原則設定之後，修補程式就可以在使用較高的許可權執行安裝時，安裝 [次要升級](minor-upgrades.md) ;修補程式無法安裝 [主要升級](major-upgrades.md)。 設定此原則也可讓非系統管理使用者在提高許可權的安裝期間，以 LocalSystem 許可權執行程式。<br/>                                                                                                                                                                                                                                                                                      |
| [偵錯](debug.md)<br/>                                                             | **REG \_ DWORD**<br/> | 如果這個原則值存在且設定為1，則安裝程式會使用 [**OutputDebugString**](/windows/win32/api/debugapi/nf-debugapi-outputdebugstringa) 函式，將一般的偵錯工具訊息寫入至偵錯工具。 如果這個值存在且設定為2，則安裝程式會使用 **OutputDebugString** 函式，將所有有效的偵錯工具訊息寫入至偵錯工具。<br/> 這項原則僅供偵測之用，在未來的 Windows Installer 版本中可能不受支援。<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| [DisableAutomaticApplicationShutdown](disableautomaticapplicationshutdown.md)<br/> | **REG \_ DWORD**<br/> | 如果這個原則值存在且設為1，Windows Installer 不會與[重新開機管理員](../rstmgr/restart-manager-portal.md)互動，但是會使用[FilesInUse 對話方塊](filesinuse-dialog.md)功能。<br/> **[Windows Installer 3.1 及更早版本](not-supported-in-windows-installer-version-3-1.md)：** 不支援。<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| [DisableBrowse](disablebrowse.md)<br/>                                             | **REG \_ DWORD**<br/> | 如果此原則值存在且設為1，則使用者無法流覽以找出安裝程式的來源。 直接輸入的 [從] 下拉式方塊中的 [ **使用功能** ] 已鎖定，而且 [ **流覽]** 按鈕已停用。 如需有關來源流覽的詳細資訊，請參閱 [來源復原](source-resiliency.md)。<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| [DisableFlyWeightPatching](disableflyweightpatching.md)<br/>                       | **REG \_ DWORD**<br/> | 如果每一電腦的系統原則值設定為1，則在安裝期間會關閉所有 [修補程式優化](patch-optimization.md) 選項。<br/> **Windows Installer 2.0：** 不支援。<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| [DisableLUAPatching](disableluapatching.md)<br/>                                   | **REG \_ DWORD**<br/> | 如果每一電腦的系統原則值設定為1，則安裝程式會防止非系統管理員使用最低許可權帳戶 (LUA) 修補至電腦上安裝的任何應用程式。 如果未設定此值或0，非系統管理員可以將 LUA 修補程式套用至啟用 LUA 的應用程式。<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| [DisableMSI](disablemsi.md)<br/>                                                   | **REG \_ DWORD**<br/> | 如果此原則值設定為0、不存在，或1或2以外的任何數位，則對 Windows Installer 的影響取決於作業系統。 在 Windows Server 2003 上，會針對受控應用程式啟用 Windows Installer，並且針對未受管理的應用程式安裝停用。 在 Windows XP 上，會針對所有應用程式啟用 Windows Installer。<br/> 如果此原則值設定為0，則會為所有應用程式啟用 Windows Installer。 允許所有安裝作業。<br/> 如果此原則值設定為1，則會停用非受控應用程式的 Windows Installer，但仍會針對受控應用程式啟用。 系統會封鎖非提高許可權的每個使用者安裝。 允許每位使用者的提高許可權，以及每部電腦的安裝。<br/> 如果此原則值設定為2，則所有應用程式一律會停用 Windows Installer。 不允許安裝，包括修復、重新安裝或隨選安裝。<br/> |
| [DisablePatch](disablepatch.md)<br/>                                               | **REG \_ DWORD**<br/> | 如果此原則值設定為1，安裝程式就不會套用修補程式。 這項原則可以用來在必須限制修補的環境中提供安全性。<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| [DisablePatchUninstall](disablepatchuninstall.md)<br/>                             | **REG \_ DWORD**<br/> | 如果此原則值設定為1，則不能由使用者或系統管理員從電腦移除修補程式。 Windows Installer 仍然可以移除不再適用于產品的修補程式。<br/> **Windows Installer 2.0：** 不支援。<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| [DisableRollback](disablerollback.md)<br/>                                         | **REG \_ DWORD**<br/> | 如果此原則值設定為1，安裝程式就不會在安裝期間儲存復原檔案，而會停用安裝復原。 預設會啟用復原。 除非是絕對必要，否則建議系統管理員不要使用此原則。<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| [DisableSharedComponent](disablesharedcomponent.md)<br/>                           | **REG \_ DWORD**<br/> | 如果每一電腦的 [系統原則](system-policy.md)設定為1，則系統上沒有套件會取得 [元件資料表](component-table.md)中 **msidbComponentAttributesShared** 屬性所啟用的共用元件功能。<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| [DisableUserInstalls](disableuserinstalls.md)<br/>                                 | **REG \_ DWORD**<br/> | 如果未設定此原則值，安裝程式會依下列順序搜尋產品的登錄：已註冊為每位使用者的受控產品、註冊為每位使用者的非受控產品，最後是註冊為每部電腦的產品。<br/> 如果此原則值設定為1，則安裝程式會忽略所有註冊為每個使用者的產品，而且只會搜尋已註冊為每部電腦的產品。 嘗試執行每一使用者的安裝會導致安裝程式顯示錯誤訊息，並停止安裝。<br/>                                                                                                                                                                                                                                                                                                                                                              |
| [EnforceUpgradeComponentRules](enforceupgradecomponentrules.md)<br/>               | **REG \_ DWORD**<br/> | 將此原則值設定為1，在 [小型更新](small-updates.md) 和電腦上所有產品的 [次要升級](minor-upgrades.md) 期間，套用升級元件規則。<br/> **Windows Installer 2.0：** 不支援。<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| [EnableAdminTSRemote](enableadmintsremote.md)<br/>                                 | **REG \_ DWORD**<br/> | 設定此原則可讓系統管理員從執行終端機伺服器角色服務的伺服器用戶端會話執行安裝。<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| [EnableUserControl](enableusercontrol.md)<br/>                                     | **REG \_ DWORD**<br/> | 如果此原則值設定為1，則安裝程式可以在使用較高許可權的受控安裝期間，將所有 [公用屬性](public-properties.md) 傳遞至伺服器端。 設定此原則的效果與設定 [**EnableUserControl**](-enableusercontrol.md) 屬性相同。<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| [LimitSystemRestoreCheckpointing](limitsystemrestorecheckpointing.md)<br/>         | **REG \_ DWORD**<br/> | 此原則會依 Windows Installer 關閉檢查點的建立。<br/> 如果原則值設定為0或不存在，Windows Installer 會進行安裝或卸載的一般檢查點檢查。<br/> 如果原則值設定為1，Windows Installer 不會建立檢查點。<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| [Logging](logging.md)<br/>                                                         | **REG \_ SZ**<br/>    | 只有當 "/L" 命令列選項或 [**MsiEnableLog**](/windows/desktop/api/Msi/nf-msi-msienableloga)未啟用記錄功能時，才會使用此原則值。 如果在此情況下設定了原則，則會在臨時目錄中建立具有隨機名稱的記錄檔： MSI \* 。日誌。 將原則值設定為字元字串，以指定記錄模式。 使用相同的字元，指定 "/L" 命令列選項所使用的記錄模式原則。 如需詳細資訊，請參閱 [命令列選項](command-line-options.md)。 請注意，您不能針對原則使用 "+" 和 " \* "。<br/>                                                                                                                                                                                                                                                                                                                                                                             |
| [MaxPatchCacheSize](maxpatchcachesize.md)<br/>                                     | **REG \_ DWORD**<br/> | 如果此原則值設定為大於0的值，Windows Installer 會將舊版本的已修補檔案儲存在快取中。 將值設定為可用於檔案快取的磁碟空間的最大百分比。 例如，值為15，會將最大值設為15%。 設定為0則不會儲存任何檔案。 若未設定此原則，預設值為10%。<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| [MsiDisableEmbeddedUI](msidisableembeddedui.md)<br/>                               | **REG \_ DWORD**<br/> | 若要停用電腦上的內嵌 UI 處理常式，請將此原則值設定為1。<br/> **[Windows Installer 4.0 及更早版本](not-supported-in-windows-installer-4-0.md)：** 不支援。<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| [SafeForScripting](safeforscripting.md)<br/>                                       | **REG \_ DWORD**<br/> | 如果此原則值設定為1，當腳本在網頁內使用安裝程式自動化時，不會提示使用者。 這可能適用于 Web 型工具，但不需要使用者知識或同意，就能無訊息安裝應用程式。<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| [TransformsSecure 原則](transformssecure-policy.md)<br/>                         | **REG \_ DWORD**<br/> | 將 [TransformsSecure 原則](transformssecure-policy.md) 值設定為1，會通知安裝程式在使用者電腦上的本機電腦上，將轉換快取到使用者沒有寫入存取權的位置。<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| [DisableLoggingFromPackage](disableloggingfrompackage.md)<br/>                     | **REG \_ DWORD**<br/> | 將此原則值設定為1，以停用電腦上所有使用者的 [**MsiLogging**](msilogging.md) 屬性為封裝指定的記錄。<br/> **Windows Installer 3.1 及更早版本：** 不支援。<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| [WinHttpAutoLogonLevel](winhttpautologonlevel.md)<br/>                             | **REG \_ SZ**<br/>    | 自動登入 (自動登入) 原則會決定是否可接受在伺服器的要求中包含預設認證。 **Windows 8 和 Windows Server 2012：** 此原則需要在 Windows 8 或 Windows Server 2012 上執行 Windows Installer，且在所有舊版的 Windows 上無法使用。<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |



 

 

 
