---
description: 目錄資料表會指定安裝的版面配置。
ms.assetid: 3f2e1cc2-6b36-4615-86e6-e78485edd2f7
title: 使用目錄資料表
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 7218fe6f6e2ca36bc0c52e74b564ad07d87053a7
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/08/2021
ms.locfileid: "104193092"
---
# <a name="using-the-directory-table"></a><span data-ttu-id="1ee4d-103">使用目錄資料表</span><span class="sxs-lookup"><span data-stu-id="1ee4d-103">Using the Directory Table</span></span>

<span data-ttu-id="1ee4d-104">[目錄資料表](directory-table.md)會指定安裝的版面配置。</span><span class="sxs-lookup"><span data-stu-id="1ee4d-104">The [Directory table](directory-table.md) specifies the layout of an installation.</span></span> <span data-ttu-id="1ee4d-105">當您在 [CostFinalize 動作](costfinalize-action.md)期間解析目錄時，目錄資料表中的索引鍵會變成將 [屬性](properties.md) 設為目錄路徑。</span><span class="sxs-lookup"><span data-stu-id="1ee4d-105">When the directories are resolved during the [CostFinalize action](costfinalize-action.md), the keys in the Directory table become [properties](properties.md) set to directory paths.</span></span> <span data-ttu-id="1ee4d-106">請注意，安裝程式會將一些標準 [屬性](properties.md) 設定為系統資料夾路徑。</span><span class="sxs-lookup"><span data-stu-id="1ee4d-106">Note that the installer sets a number of standard [properties](properties.md) to system folder paths.</span></span> <span data-ttu-id="1ee4d-107">如需設定為系統資料夾的屬性清單，請參閱 [屬性參考](property-reference.md) 。</span><span class="sxs-lookup"><span data-stu-id="1ee4d-107">See the [Property Reference](property-reference.md) for a list of the properties that are set to system folders.</span></span>

<span data-ttu-id="1ee4d-108">若要指定目錄的目標位置，最好的方式是在安裝套件中撰寫 [目錄表格](directory-table.md) ，以提供本節所述的正確位置。</span><span class="sxs-lookup"><span data-stu-id="1ee4d-108">The best way to specify the target location for a directory is by authoring the [Directory table](directory-table.md) in your installation package to provide the correct location as discussed in this section.</span></span> <span data-ttu-id="1ee4d-109">如果需要在安裝時變更目錄位置，請參閱「[變更目錄的目標位置](changing-the-target-location-for-a-directory.md)」一節。</span><span class="sxs-lookup"><span data-stu-id="1ee4d-109">If it is necessary to change the directory location at the time of the installation see also the section: [Changing the Target Location for a Directory](changing-the-target-location-for-a-directory.md)</span></span>

<span data-ttu-id="1ee4d-110">以下是目錄資料表的範例。</span><span class="sxs-lookup"><span data-stu-id="1ee4d-110">The following is an example of a Directory table.</span></span>



| <span data-ttu-id="1ee4d-111">目錄</span><span class="sxs-lookup"><span data-stu-id="1ee4d-111">Directory</span></span>     | <span data-ttu-id="1ee4d-112">目錄 \_ 父系</span><span class="sxs-lookup"><span data-stu-id="1ee4d-112">Directory\_Parent</span></span> | <span data-ttu-id="1ee4d-113">DefaultDir</span><span class="sxs-lookup"><span data-stu-id="1ee4d-113">DefaultDir</span></span> |
|---------------|-------------------|------------|
| <span data-ttu-id="1ee4d-114">TARGETDIR</span><span class="sxs-lookup"><span data-stu-id="1ee4d-114">TARGETDIR</span></span>     |                   | <span data-ttu-id="1ee4d-115">SourceDir</span><span class="sxs-lookup"><span data-stu-id="1ee4d-115">SourceDir</span></span>  |
| <span data-ttu-id="1ee4d-116">EXEDIR</span><span class="sxs-lookup"><span data-stu-id="1ee4d-116">EXEDIR</span></span>        | <span data-ttu-id="1ee4d-117">TARGETDIR</span><span class="sxs-lookup"><span data-stu-id="1ee4d-117">TARGETDIR</span></span>         | <span data-ttu-id="1ee4d-118">應用程式</span><span class="sxs-lookup"><span data-stu-id="1ee4d-118">App</span></span>        |
| <span data-ttu-id="1ee4d-119">DLLDIR</span><span class="sxs-lookup"><span data-stu-id="1ee4d-119">DLLDIR</span></span>        | <span data-ttu-id="1ee4d-120">EXEDIR</span><span class="sxs-lookup"><span data-stu-id="1ee4d-120">EXEDIR</span></span>            | <span data-ttu-id="1ee4d-121">量化</span><span class="sxs-lookup"><span data-stu-id="1ee4d-121">Bin</span></span>        |
| <span data-ttu-id="1ee4d-122">DesktopFolder</span><span class="sxs-lookup"><span data-stu-id="1ee4d-122">DesktopFolder</span></span> | <span data-ttu-id="1ee4d-123">TARGETDIR</span><span class="sxs-lookup"><span data-stu-id="1ee4d-123">TARGETDIR</span></span>         | <span data-ttu-id="1ee4d-124">桌面</span><span class="sxs-lookup"><span data-stu-id="1ee4d-124">Desktop</span></span>    |



 

<span data-ttu-id="1ee4d-125">目錄資料表的每個資料列都表示來源與目標的目錄。</span><span class="sxs-lookup"><span data-stu-id="1ee4d-125">Each row of the Directory table indicates a directory both at the source and the target.</span></span> <span data-ttu-id="1ee4d-126">例如，假設安裝套件位於 \\ \\ 應用程式 \\ 來源 \\ 。</span><span class="sxs-lookup"><span data-stu-id="1ee4d-126">For example, assume the installation package resides at \\\\applications\\source\\.</span></span> <span data-ttu-id="1ee4d-127">因為 \_ 第一個資料列的目錄父欄位是 Null，所以此記錄會指出來源和目標的根目錄。</span><span class="sxs-lookup"><span data-stu-id="1ee4d-127">Because the Directory\_Parent field of the first row is Null, this record indicates the root directories for both the source and the target.</span></span> <span data-ttu-id="1ee4d-128">針對來源，這個目錄的值是由 DefaultDir 欄位提供。</span><span class="sxs-lookup"><span data-stu-id="1ee4d-128">For the source, the value of this directory is given by the DefaultDir field.</span></span> <span data-ttu-id="1ee4d-129">[**SourceDir**](sourcedir.md)屬性預設為安裝套件的位置。</span><span class="sxs-lookup"><span data-stu-id="1ee4d-129">The [**SourceDir**](sourcedir.md) property defaults to the location of the installation package.</span></span> <span data-ttu-id="1ee4d-130">因此，除非覆寫 **SourceDir** 屬性，否則根目錄來原始目錄是 \\ \\ 應用程式 \\ 來源 \\ 。</span><span class="sxs-lookup"><span data-stu-id="1ee4d-130">Thus, unless the **SourceDir** property is overridden, the root source directory is \\\\applications\\source\\.</span></span>

<span data-ttu-id="1ee4d-131">第一筆記錄的目錄欄位指出根目標目錄的位置。</span><span class="sxs-lookup"><span data-stu-id="1ee4d-131">The Directory field of the first record indicates the location of the root target directory.</span></span> <span data-ttu-id="1ee4d-132">在此情況下， [**TARGETDIR**](targetdir.md) 屬性的值會指出此目錄。</span><span class="sxs-lookup"><span data-stu-id="1ee4d-132">In this case, the value of the [**TARGETDIR**](targetdir.md) property indicates this directory.</span></span> <span data-ttu-id="1ee4d-133">一般而言， **TARGETDIR** 屬性的值是在命令列或透過使用者介面設定。</span><span class="sxs-lookup"><span data-stu-id="1ee4d-133">Typically, the value of the **TARGETDIR** property is set at the command line or through a user interface.</span></span> <span data-ttu-id="1ee4d-134">在此情況下，假設 **TARGETDIR** 屬性設定為 C： \\ Program Files \\ Target \\ 。</span><span class="sxs-lookup"><span data-stu-id="1ee4d-134">In this case, assume the **TARGETDIR** property is set to C:\\Program Files\\Target\\.</span></span>

<span data-ttu-id="1ee4d-135">若為第二筆記錄，目錄 \_ 父欄位不是 Null。</span><span class="sxs-lookup"><span data-stu-id="1ee4d-135">For the second record, the Directory\_Parent field is not Null.</span></span> <span data-ttu-id="1ee4d-136">因此，此記錄表示來源和目標的非根目錄。</span><span class="sxs-lookup"><span data-stu-id="1ee4d-136">Therefore, this record indicates a non-root directory for both the source and the target.</span></span> <span data-ttu-id="1ee4d-137">針對非根目錄來原始目錄，目錄父欄位中所述的記錄所指定的來原始目錄 \_ 是父目錄。</span><span class="sxs-lookup"><span data-stu-id="1ee4d-137">For a non-root source directory, the source directory indicated by the record described in the Directory\_Parent field is the parent directory.</span></span> <span data-ttu-id="1ee4d-138">若為第二筆記錄，則 \_ 會 TARGETDIR 目錄父欄位。</span><span class="sxs-lookup"><span data-stu-id="1ee4d-138">For the second record, the Directory\_Parent field is TARGETDIR.</span></span> <span data-ttu-id="1ee4d-139">如先前所示，TARGETDIR 記錄所指示的來原始目錄已解析為 \\ \\ 應用程式 \\ 來源 \\ 。</span><span class="sxs-lookup"><span data-stu-id="1ee4d-139">As shown earlier, the source directory indicated by the TARGETDIR record resolved to \\\\applications\\source\\.</span></span> <span data-ttu-id="1ee4d-140">因此，第二筆記錄所指出的來原始目錄是 \\ \\ 應用程式 \\ 來源 \\ 應用程式 \\ 。</span><span class="sxs-lookup"><span data-stu-id="1ee4d-140">Thus, the source directory indicated by the second record is \\\\applications\\source\\App\\.</span></span>

<span data-ttu-id="1ee4d-141">類似的進程適用于目標目錄。</span><span class="sxs-lookup"><span data-stu-id="1ee4d-141">A similar process works for the target directory.</span></span> <span data-ttu-id="1ee4d-142">第二筆記錄中所描述之目標目錄的上層目錄值是目錄父欄位所解析的目標目錄 \_ 。</span><span class="sxs-lookup"><span data-stu-id="1ee4d-142">The value of the parent directory for the target directory described in the second record is the target directory resolved by the Directory\_Parent field.</span></span> <span data-ttu-id="1ee4d-143">同樣地，目錄 \_ 父欄位包含值 TARGETDIR。</span><span class="sxs-lookup"><span data-stu-id="1ee4d-143">Again, the Directory\_Parent field contains the value TARGETDIR.</span></span> <span data-ttu-id="1ee4d-144">這表示第一筆記錄會解析為 C： \\ Program Files 目標的目標 \\ 目錄 \\ 。</span><span class="sxs-lookup"><span data-stu-id="1ee4d-144">This indicates the first record that resolves to a target directory of C:\\Program Files\\Target\\.</span></span> <span data-ttu-id="1ee4d-145">目錄欄位包含作者定義的屬性，稱為 EXEDIR。</span><span class="sxs-lookup"><span data-stu-id="1ee4d-145">The Directory field contains an author-defined property called EXEDIR.</span></span> <span data-ttu-id="1ee4d-146">如果設定此屬性，則其值會提供目錄的完整路徑。</span><span class="sxs-lookup"><span data-stu-id="1ee4d-146">If this property is set, then its value gives the full path of the directory.</span></span> <span data-ttu-id="1ee4d-147">因此，如果這個屬性設定為 C： \\ data \\ common，則 \\ 第二筆記錄所指出的目標目錄值為 c： \\ data \\ common \\ 。</span><span class="sxs-lookup"><span data-stu-id="1ee4d-147">Thus, if this property is set to C:\\Data\\Common\\, the value of the target directory indicated by the second record is C:\\Data\\Common\\.</span></span> <span data-ttu-id="1ee4d-148">如果未設定，目標目錄會採用 DefaultDir 欄位所提供的名稱。</span><span class="sxs-lookup"><span data-stu-id="1ee4d-148">If it is not set, the target directory takes the name given by the DefaultDir field.</span></span> <span data-ttu-id="1ee4d-149">在此情況下，目標目錄為 C： \\ Program Files \\ 目標 \\ 應用程式 \\ 。</span><span class="sxs-lookup"><span data-stu-id="1ee4d-149">In this case, the target directory is C:\\Program Files\\Target\\App\\.</span></span>

<span data-ttu-id="1ee4d-150">相同的進程適用于第三筆記錄。</span><span class="sxs-lookup"><span data-stu-id="1ee4d-150">The same process works for the third record.</span></span> <span data-ttu-id="1ee4d-151">如果未設定 EXEDIR 和 DLLDIR，則目標目錄為 C： \\ Program Files \\ 目標應用 \\ 程式 \\ bin，而來原始目錄是 \\ \\ 應用程式 \\ 來源應用程式 \\ \\ bin \\ 。</span><span class="sxs-lookup"><span data-stu-id="1ee4d-151">If EXEDIR and DLLDIR are not set, the target directory is C:\\Program Files\\Target\\App\\Bin, and the source directory is \\\\applications\\source\\App\\Bin\\.</span></span>

<span data-ttu-id="1ee4d-152">第四筆記錄使用 [**DesktopFolder**](desktopfolder.md) 屬性。</span><span class="sxs-lookup"><span data-stu-id="1ee4d-152">The fourth record uses the [**DesktopFolder**](desktopfolder.md) property.</span></span> <span data-ttu-id="1ee4d-153">如果使用者的桌面位置為 C： \\ winnt \\ 設定檔 \\ 使用者 \\ 桌面 \\ ，則目標目錄會解析為 c： \\ winnt \\ 設定檔 \\ 使用者 \\ 桌面 \\ 。</span><span class="sxs-lookup"><span data-stu-id="1ee4d-153">If the location of the user's desktop is C:\\Winnt\\Profiles\\User\\Desktop\\, the target directory resolves to C:\\Winnt\\Profiles\\User\\Desktop\\.</span></span> <span data-ttu-id="1ee4d-154">來原始目錄會解析為 \\ \\ 應用程式 \\ 來源 \\ 桌面 \\ 。</span><span class="sxs-lookup"><span data-stu-id="1ee4d-154">The source directory resolves to \\\\applications\\source\\Desktop\\.</span></span>

<span data-ttu-id="1ee4d-155">目錄資料表的 DefaultDir 資料行中有兩種額外的語法功能可供使用。</span><span class="sxs-lookup"><span data-stu-id="1ee4d-155">There are two additional syntax features that can be used in the DefaultDir column of the Directory table.</span></span> <span data-ttu-id="1ee4d-156">若為非根來原始目錄， (. ) 在 DefaultDir 資料行中輸入，表示該目錄應該位於其上層目錄，而不含子目錄。</span><span class="sxs-lookup"><span data-stu-id="1ee4d-156">For a non-root source directory, a period (.) entered in the DefaultDir column indicates that the directory should be located in its parent directory without a subdirectory.</span></span> <span data-ttu-id="1ee4d-157">若要指定不同的來源和目標目錄路徑，請以冒號分隔 DefaultDir 資料行中的目標和來源路徑，如下所示： \[ targetpath \] ： \[ sourcepath \] 。</span><span class="sxs-lookup"><span data-stu-id="1ee4d-157">To specify different source and target directory paths, separate the target and source paths in the DefaultDir column with a colon as follows: \[targetpath\]:\[sourcepath\].</span></span> <span data-ttu-id="1ee4d-158">這些功能可以一起使用，以將層級新增至單一目錄的來源或目標路徑。</span><span class="sxs-lookup"><span data-stu-id="1ee4d-158">These features can be used together to add levels to either the source or target paths for a single directory.</span></span> <span data-ttu-id="1ee4d-159">請參閱下列目錄資料表範例。</span><span class="sxs-lookup"><span data-stu-id="1ee4d-159">See the following example of a Directory table.</span></span>



| <span data-ttu-id="1ee4d-160">目錄</span><span class="sxs-lookup"><span data-stu-id="1ee4d-160">Directory</span></span>   | <span data-ttu-id="1ee4d-161">目錄 \_ 父系</span><span class="sxs-lookup"><span data-stu-id="1ee4d-161">Directory\_Parent</span></span> | <span data-ttu-id="1ee4d-162">DefaultDir</span><span class="sxs-lookup"><span data-stu-id="1ee4d-162">DefaultDir</span></span> |
|-------------|-------------------|------------|
| <span data-ttu-id="1ee4d-163">TARGETDIR</span><span class="sxs-lookup"><span data-stu-id="1ee4d-163">TARGETDIR</span></span>   |                   | <span data-ttu-id="1ee4d-164">SourceDir</span><span class="sxs-lookup"><span data-stu-id="1ee4d-164">SourceDir</span></span>  |
| <span data-ttu-id="1ee4d-165">MyAppDir</span><span class="sxs-lookup"><span data-stu-id="1ee4d-165">MyAppDir</span></span>    | <span data-ttu-id="1ee4d-166">TARGETDIR</span><span class="sxs-lookup"><span data-stu-id="1ee4d-166">TARGETDIR</span></span>         | <span data-ttu-id="1ee4d-167">MyApp</span><span class="sxs-lookup"><span data-stu-id="1ee4d-167">MyApp</span></span>      |
| <span data-ttu-id="1ee4d-168">BinDir</span><span class="sxs-lookup"><span data-stu-id="1ee4d-168">BinDir</span></span>      | <span data-ttu-id="1ee4d-169">MyAppDir</span><span class="sxs-lookup"><span data-stu-id="1ee4d-169">MyAppDir</span></span>          | <span data-ttu-id="1ee4d-170">量化</span><span class="sxs-lookup"><span data-stu-id="1ee4d-170">Bin</span></span>        |
| <span data-ttu-id="1ee4d-171">Binx86Dir</span><span class="sxs-lookup"><span data-stu-id="1ee4d-171">Binx86Dir</span></span>   | <span data-ttu-id="1ee4d-172">BinDir</span><span class="sxs-lookup"><span data-stu-id="1ee4d-172">BinDir</span></span>            | <span data-ttu-id="1ee4d-173">.： x86</span><span class="sxs-lookup"><span data-stu-id="1ee4d-173">.:x86</span></span>      |
| <span data-ttu-id="1ee4d-174">BinAlphaDir</span><span class="sxs-lookup"><span data-stu-id="1ee4d-174">BinAlphaDir</span></span> | <span data-ttu-id="1ee4d-175">BinDir</span><span class="sxs-lookup"><span data-stu-id="1ee4d-175">BinDir</span></span>            | <span data-ttu-id="1ee4d-176">.： Alpha</span><span class="sxs-lookup"><span data-stu-id="1ee4d-176">.:Alpha</span></span>    |



 

<span data-ttu-id="1ee4d-177">MyAppDir、BinDir、Binx86Dir 和 BinAlphaDir 資料列的來源和目標路徑會解析為，如下所示。</span><span class="sxs-lookup"><span data-stu-id="1ee4d-177">The source and target paths resolve for the MyAppDir, BinDir, Binx86Dir, and BinAlphaDir rows as follows.</span></span>



| <span data-ttu-id="1ee4d-178">Record</span><span class="sxs-lookup"><span data-stu-id="1ee4d-178">Record</span></span>       | <span data-ttu-id="1ee4d-179">目標路徑</span><span class="sxs-lookup"><span data-stu-id="1ee4d-179">Target paths</span></span>            | <span data-ttu-id="1ee4d-180">來源路徑</span><span class="sxs-lookup"><span data-stu-id="1ee4d-180">Source paths</span></span>                   |
|--------------|-------------------------|--------------------------------|
| <span data-ttu-id="1ee4d-181">MyAppDir:</span><span class="sxs-lookup"><span data-stu-id="1ee4d-181">MyAppDir:</span></span>    | <span data-ttu-id="1ee4d-182">\[TARGETDIR \] MyApp</span><span class="sxs-lookup"><span data-stu-id="1ee4d-182">\[TARGETDIR\]MyApp</span></span>      | <span data-ttu-id="1ee4d-183">\[SourceDir \] MyApp</span><span class="sxs-lookup"><span data-stu-id="1ee4d-183">\[SourceDir\]MyApp</span></span>             |
| <span data-ttu-id="1ee4d-184">BinDir:</span><span class="sxs-lookup"><span data-stu-id="1ee4d-184">BinDir:</span></span>      | <span data-ttu-id="1ee4d-185">\[TARGETDIR \] MyApp \\ Bin</span><span class="sxs-lookup"><span data-stu-id="1ee4d-185">\[TARGETDIR\]MyApp\\Bin</span></span> | <span data-ttu-id="1ee4d-186">\[SourceDir \] MyApp \\ Bin</span><span class="sxs-lookup"><span data-stu-id="1ee4d-186">\[SourceDir\]MyApp\\Bin</span></span>        |
| <span data-ttu-id="1ee4d-187">Binx86Dir:</span><span class="sxs-lookup"><span data-stu-id="1ee4d-187">Binx86Dir:</span></span>   | <span data-ttu-id="1ee4d-188">\[TARGETDIR \] MyApp \\ Bin</span><span class="sxs-lookup"><span data-stu-id="1ee4d-188">\[TARGETDIR\]MyApp\\Bin</span></span> | <span data-ttu-id="1ee4d-189">\[SourceDir \] MyApp \\ Bin \\ x86</span><span class="sxs-lookup"><span data-stu-id="1ee4d-189">\[SourceDir\]MyApp\\Bin\\x86</span></span>   |
| <span data-ttu-id="1ee4d-190">BinAlphaDir:</span><span class="sxs-lookup"><span data-stu-id="1ee4d-190">BinAlphaDir:</span></span> | <span data-ttu-id="1ee4d-191">\[TARGETDIR \] MyApp \\ Bin</span><span class="sxs-lookup"><span data-stu-id="1ee4d-191">\[TARGETDIR\]MyApp\\Bin</span></span> | <span data-ttu-id="1ee4d-192">\[SourceDir \] MyApp \\ Bin \\ Alpha</span><span class="sxs-lookup"><span data-stu-id="1ee4d-192">\[SourceDir\]MyApp\\Bin\\Alpha</span></span> |



 

> [!Note]  
> <span data-ttu-id="1ee4d-193">Windows Installer 不支援 Alpha 平臺。</span><span class="sxs-lookup"><span data-stu-id="1ee4d-193">The Alpha platform is not supported by the Windows Installer.</span></span>

 

 

 



