---
description: 本節主要在說明安裝套件開發人員如何使用安裝程式的資料庫和內部 UI)  (UI 來撰寫安裝使用者介面。
ms.assetid: c04e32ba-08a9-49fe-9a4a-db258767f0b3
title: 使用使用者介面
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 714d41ab6b91bb0f3ce519887f7004f919c5c6b2
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/07/2021
ms.locfileid: "104192774"
---
# <a name="using-the-user-interface"></a><span data-ttu-id="a00d2-103">使用使用者介面</span><span class="sxs-lookup"><span data-stu-id="a00d2-103">Using the User Interface</span></span>

<span data-ttu-id="a00d2-104">本節主要在說明安裝套件開發人員如何使用安裝程式的資料庫和內部 UI)  (UI 來撰寫安裝使用者介面。</span><span class="sxs-lookup"><span data-stu-id="a00d2-104">This section is concerned primarily with how developers of installation packages author an installation user interface (UI) using the installer's database and internal UI.</span></span> <span data-ttu-id="a00d2-105">如需內部和外部 UI 之間差異的詳細資訊，請參閱 [關於消費者介面](about-the-user-interface.md)。</span><span class="sxs-lookup"><span data-stu-id="a00d2-105">For more information about the difference between an internal and external UI see [About the User Interface](about-the-user-interface.md).</span></span>

<span data-ttu-id="a00d2-106">若要在安裝期間顯示對話方塊序列或佈告欄，必須在適當的動作順序資料表的 [動作] 資料行中輸入對話方塊的名稱。</span><span class="sxs-lookup"><span data-stu-id="a00d2-106">To display a dialog box sequence or billboard during the installation, the name of the dialog box must be entered into the Action column of the appropriate action sequence table.</span></span> <span data-ttu-id="a00d2-107">對話方塊的名稱必須出現在 [InstallUISequence](installuisequence-table.md) 或 [AdminUISequence 資料表](adminuisequence-table.md) 中，取決於 UI 是否已排程在 [ [安裝](install-action.md)]、[ [公告](advertise-action.md)] 或 [系統 [管理員] 動作](admin-action.md)下執行。</span><span class="sxs-lookup"><span data-stu-id="a00d2-107">The name of the dialog box must appear in the [InstallUISequence](installuisequence-table.md) or [AdminUISequence table](adminuisequence-table.md) depending on whether the UI is scheduled to run under the [INSTALL](install-action.md), [ADVERTISE](advertise-action.md), or [ADMIN action](admin-action.md).</span></span>

<span data-ttu-id="a00d2-108">雖然安裝程式支援撰寫自訂對話方塊和公告欄，但某些對話方塊序列也有一些保留名稱。</span><span class="sxs-lookup"><span data-stu-id="a00d2-108">Although the installer supports the authoring of custom dialog boxes and billboards, there are also a number of reserved names for certain dialog box sequences.</span></span> <span data-ttu-id="a00d2-109">因為安裝程式會在執行某些動作時使用這些名稱，所以這些名稱只能搭配其保留的對話方塊類型使用。</span><span class="sxs-lookup"><span data-stu-id="a00d2-109">Because the installer uses these names when executing certain actions, these names must only be used with the types of dialog boxes for which they are reserved.</span></span> <span data-ttu-id="a00d2-110">這些保留名稱的清單，以及每個特殊對話方塊序列的描述都是在 [對話方塊](dialog-boxes.md)中提供。</span><span class="sxs-lookup"><span data-stu-id="a00d2-110">A list of these reserved names, and a description of each of the special dialog box sequences, is given in [Dialog Boxes](dialog-boxes.md).</span></span>

<span data-ttu-id="a00d2-111">您必須分別在 [對話](dialog-table.md) 和 [佈告欄](billboard-table.md) 資料表中指定 UI 中每個對話方塊或佈告欄的屬性。</span><span class="sxs-lookup"><span data-stu-id="a00d2-111">The properties of each dialog box or billboard in the UI must be specified in the [Dialog](dialog-table.md) and [BillBoard](billboard-table.md) tables, respectively.</span></span> <span data-ttu-id="a00d2-112">您也必須藉由設定 [對話方塊的樣式位](dialog-style-bits.md) 旗標，在對話方塊資料表中指定每個對話方塊的樣式。</span><span class="sxs-lookup"><span data-stu-id="a00d2-112">The style of each dialog box must also be specified in the Dialog table by setting the [dialog's style bit](dialog-style-bits.md) flag.</span></span>

<span data-ttu-id="a00d2-113">控制項和文字必須加入至對話方塊，而且必須系結至 [控制項，才能](controlevent-overview.md)讓使用者與安裝程式互動。</span><span class="sxs-lookup"><span data-stu-id="a00d2-113">Controls and text must be added to the dialog box, and these must be tied to [ControlEvents](controlevent-overview.md), to enable the user to interact with the installation process.</span></span> <span data-ttu-id="a00d2-114">如需如何將控制項加入對話方塊的詳細資訊，請參閱 [加入控制項和文字](adding-controls-and-text.md) 。</span><span class="sxs-lookup"><span data-stu-id="a00d2-114">See [Adding Controls and Text](adding-controls-and-text.md) for more information on how to add controls to a dialog box.</span></span>

<span data-ttu-id="a00d2-115">Windows Installer 內部 UI 處理常式可以選擇性地顯示或隱藏對話方塊，以控制安裝期間使用者互動的層級。</span><span class="sxs-lookup"><span data-stu-id="a00d2-115">Windows Installer internal UI handler can selectively show or hide dialog boxes to control the level of end-user interactivity during the installation.</span></span> <span data-ttu-id="a00d2-116">這些使用者互動層級稱為「完整」、「精簡」、「基本」和「無」。</span><span class="sxs-lookup"><span data-stu-id="a00d2-116">These levels of end-user interactivity are referred to as full, reduced, basic, and none.</span></span> <span data-ttu-id="a00d2-117">請參閱 [消費者介面層級](user-interface-levels.md)。</span><span class="sxs-lookup"><span data-stu-id="a00d2-117">See [User Interface Levels](user-interface-levels.md).</span></span> <span data-ttu-id="a00d2-118">如需這些 UIlevels 的完整說明。</span><span class="sxs-lookup"><span data-stu-id="a00d2-118">for a full description of these UIlevels.</span></span>

<span data-ttu-id="a00d2-119">有兩種方法可以設定 UI 層級。</span><span class="sxs-lookup"><span data-stu-id="a00d2-119">There are two methods to set the UI level.</span></span> <span data-ttu-id="a00d2-120">UI 層級可透過呼叫 [**MsiSetInternalUI**](/windows/desktop/api/Msi/nf-msi-msisetinternalui)，以程式設計方式設定，而 **MsiSetInternalUI** 的第一個參數會指定 ui 層級。</span><span class="sxs-lookup"><span data-stu-id="a00d2-120">The UI level can be set programmatically with a call to [**MsiSetInternalUI**](/windows/desktop/api/Msi/nf-msi-msisetinternalui), and the first parameter of **MsiSetInternalUI** specifies the UI level.</span></span> <span data-ttu-id="a00d2-121">套件開發人員也可以使用 [命令列選項](command-line-options.md) "/q" 來設定 UI 層級。</span><span class="sxs-lookup"><span data-stu-id="a00d2-121">Package developers can also set the UI level using the [command line option](command-line-options.md) "/q".</span></span>

<span data-ttu-id="a00d2-122">每個 UI 層級的行為取決於封裝開發人員撰寫 .msi 檔。</span><span class="sxs-lookup"><span data-stu-id="a00d2-122">The behavior of each of the UI levels is determined by the authoring of the .msi file by the package developer.</span></span> <span data-ttu-id="a00d2-123">內部 UI 的作者對於這些層級對封裝的行為有彈性。</span><span class="sxs-lookup"><span data-stu-id="a00d2-123">The author of an internal UI has flexibility in how these levels behave for a package.</span></span> <span data-ttu-id="a00d2-124">這些層級的可用性取決於撰寫安裝套件。</span><span class="sxs-lookup"><span data-stu-id="a00d2-124">The availability of these levels depends on the authoring of the installation package.</span></span> <span data-ttu-id="a00d2-125">作者必須在對話方塊和控制項資料表的使用者介面中，指定每個對話方塊和控制項。</span><span class="sxs-lookup"><span data-stu-id="a00d2-125">The author must specify every dialog box and control in the user interface in the Dialog and Control tables.</span></span>

-   <span data-ttu-id="a00d2-126">完整的 UI 通常會展示 [使用者介面 wizard 的行為](user-interface-wizard-behavior.md)，例如包含 **下一個>>** 按鈕的序列中的每個對話方塊。</span><span class="sxs-lookup"><span data-stu-id="a00d2-126">A full UI typically exhibits [user interface wizard behavior](user-interface-wizard-behavior.md), such as each dialog box in a sequence containing a **Next>>** button.</span></span> <span data-ttu-id="a00d2-127">這種形式的 UI 對許多使用者來說很熟悉，而且是最常用來建立作者的 UI 類型。</span><span class="sxs-lookup"><span data-stu-id="a00d2-127">This form of UI is familiar to many users and is the most common type of UI for an author to create.</span></span> <span data-ttu-id="a00d2-128">安裝程式會顯示對話方塊的邏輯順序，並提示使用者與位於每個對話方塊的控制項互動。</span><span class="sxs-lookup"><span data-stu-id="a00d2-128">The installer presents a logical sequence of dialog boxes and prompts the user to interact with controls located in each dialog box.</span></span>
-   <span data-ttu-id="a00d2-129">縮減的 UI 通常會抑制 wizard 行為的顯示。</span><span class="sxs-lookup"><span data-stu-id="a00d2-129">A reduced UI typically suppresses the display of wizard behavior.</span></span>
-   <span data-ttu-id="a00d2-130">基本 UI 通常只會顯示使用者的進度訊息。</span><span class="sxs-lookup"><span data-stu-id="a00d2-130">A basic UI typically only displays progress messages to the user.</span></span>
-   <span data-ttu-id="a00d2-131">[無] 的 UI 層級表示無訊息安裝。</span><span class="sxs-lookup"><span data-stu-id="a00d2-131">A UI level of None means a silent installation.</span></span>

<span data-ttu-id="a00d2-132">Windows Installer 在 [ProgressBar 控制項](progressbar-control.md) 中提供唯一的進度列指示器，可向使用者顯示在安裝完成之前剩下的總時間。</span><span class="sxs-lookup"><span data-stu-id="a00d2-132">Windows Installer provides a unique progress bar indicator in the [ProgressBar control](progressbar-control.md) that displays to the user an estimate of the total time remaining until the installation is complete.</span></span> <span data-ttu-id="a00d2-133">如需進度列的詳細資訊，請參閱 [撰寫 ProgressBar 控制項](authoring-a-progressbar-control.md)。</span><span class="sxs-lookup"><span data-stu-id="a00d2-133">For more information about the progress bar, see [Authoring a ProgressBar Control](authoring-a-progressbar-control.md).</span></span>

<span data-ttu-id="a00d2-134">UI 作者應該為所有使用者提供其應用程式或產品的協助工具。</span><span class="sxs-lookup"><span data-stu-id="a00d2-134">UI authors should facilitate the accessibility of their application or product for all users.</span></span> <span data-ttu-id="a00d2-135">若要深入瞭解 Active Accessibility 和 Windows Installer，請參閱 [協助工具](accessibility.md)。</span><span class="sxs-lookup"><span data-stu-id="a00d2-135">To learn more about Active Accessibility and Windows Installer, see [Accessibility](accessibility.md).</span></span>

<span data-ttu-id="a00d2-136">如需撰寫使用者介面的詳細資訊，請參閱 [新增控制項和文字](adding-controls-and-text.md)、 [撰寫 ProgressBar 控制項](authoring-a-progressbar-control.md)、撰寫 [磁片提示訊息](authoring-disk-prompt-messages.md)、 [撰寫條件式「請稍候 ...」訊息方塊](authoring-a-conditional-please-wait-------message-box.md)，並 [預覽消費者介面](previewing-the-user-interface.md)。</span><span class="sxs-lookup"><span data-stu-id="a00d2-136">For more information about authoring a user interface, see [Adding Controls and Text](adding-controls-and-text.md), [Authoring a ProgressBar Control](authoring-a-progressbar-control.md), [Authoring Disk Prompt Messages](authoring-disk-prompt-messages.md), [Authoring a Conditional "Please Wait . . ." Message Box](authoring-a-conditional-please-wait-------message-box.md), and [Previewing the User Interface](previewing-the-user-interface.md).</span></span> <span data-ttu-id="a00d2-137">如需作者公告欄的詳細資訊，請參閱 [在非強制回應對話方塊上顯示公告欄](displaying-billboards-on-a-modeless-dialog.md)</span><span class="sxs-lookup"><span data-stu-id="a00d2-137">For more information about author billboards see [Displaying Billboards on a Modeless Dialog](displaying-billboards-on-a-modeless-dialog.md)</span></span>

<span data-ttu-id="a00d2-138">從 Windows Installer 4.5 開始，自訂使用者介面可以內嵌在 Windows Installer 封裝內。</span><span class="sxs-lookup"><span data-stu-id="a00d2-138">Beginning with Windows Installer 4.5 a custom user interface can be embedded within the Windows Installer package.</span></span> <span data-ttu-id="a00d2-139">如需內嵌自訂 UI 的範例，請參閱 [使用內嵌 ui](using-an-embedded-ui.md)。</span><span class="sxs-lookup"><span data-stu-id="a00d2-139">For an example of an embedded custom UI see [Using an Embedded UI](using-an-embedded-ui.md).</span></span>

 

 



