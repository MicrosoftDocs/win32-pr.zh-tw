---
description: Windows Installer 會安裝和移除稱為 Windows Installer 元件的資源區塊。 如需詳細資訊，請參閱核心資料表群組和元件和功能。
ms.assetid: e51dffed-d1cb-4a12-8615-0c0f612f993b
title: 指定元件
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c98cb254498236b85ab5c2bc0df3bd32892227b1
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/07/2021
ms.locfileid: "103848187"
---
# <a name="specifying-components"></a><span data-ttu-id="b36f0-104">指定元件</span><span class="sxs-lookup"><span data-stu-id="b36f0-104">Specifying Components</span></span>

<span data-ttu-id="b36f0-105">Windows Installer 會安裝和移除稱為 [Windows Installer 元件](windows-installer-components.md)的資源區塊。</span><span class="sxs-lookup"><span data-stu-id="b36f0-105">The Windows Installer installs and removes blocks of resources referred to as [Windows Installer Components](windows-installer-components.md).</span></span> <span data-ttu-id="b36f0-106">如需詳細資訊，請參閱 [核心資料表群組](core-tables-group.md) 和 [元件和功能](components-and-features.md)。</span><span class="sxs-lookup"><span data-stu-id="b36f0-106">For more information, see [Core Tables Group](core-tables-group.md) and [Components and Features](components-and-features.md).</span></span>

<span data-ttu-id="b36f0-107">在本節中，您會將記事本範例所用元件的相關資訊，新增至您在匯[入空白資料庫](importing-a-blank-database.md)時所建立的[元件資料表](component-table.md)中。</span><span class="sxs-lookup"><span data-stu-id="b36f0-107">In this section you add information about the components used by the Notepad example to the [Component Table](component-table.md) you created in [Importing a Blank Database](importing-a-blank-database.md).</span></span> <span data-ttu-id="b36f0-108">如需詳細資訊，請參閱將 [應用程式組織成元件](organizing-applications-into-components.md) 和 [定義安裝程式元件](defining-installer-components.md)。</span><span class="sxs-lookup"><span data-stu-id="b36f0-108">For more information, see [Organizing Applications into Components](organizing-applications-into-components.md) and [Defining Installer Components](defining-installer-components.md).</span></span>

<span data-ttu-id="b36f0-109">「記事本」範例會使用八個元件來控制資源。</span><span class="sxs-lookup"><span data-stu-id="b36f0-109">The Notepad sample uses eight components to control resources.</span></span>



| <span data-ttu-id="b36f0-110">元件</span><span class="sxs-lookup"><span data-stu-id="b36f0-110">Component</span></span> | <span data-ttu-id="b36f0-111">資源</span><span class="sxs-lookup"><span data-stu-id="b36f0-111">Resources</span></span>                                                                                                             |
|-----------|-----------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="b36f0-112">棒球</span><span class="sxs-lookup"><span data-stu-id="b36f0-112">Baseball</span></span>  | <span data-ttu-id="b36f0-113">Baseball.txt、sBaseball</span><span class="sxs-lookup"><span data-stu-id="b36f0-113">Baseball.txt, sBaseball</span></span>                                                                                               |
| <span data-ttu-id="b36f0-114">演唱會</span><span class="sxs-lookup"><span data-stu-id="b36f0-114">Concert</span></span>   | <span data-ttu-id="b36f0-115">Concert.txt、sConcert</span><span class="sxs-lookup"><span data-stu-id="b36f0-115">Concert.txt, sConcert</span></span>                                                                                                 |
| <span data-ttu-id="b36f0-116">舞蹈</span><span class="sxs-lookup"><span data-stu-id="b36f0-116">Dance</span></span>     | <span data-ttu-id="b36f0-117">Dance.txt、sDance</span><span class="sxs-lookup"><span data-stu-id="b36f0-117">Dance.txt, sDance</span></span>                                                                                                     |
| <span data-ttu-id="b36f0-118">足球</span><span class="sxs-lookup"><span data-stu-id="b36f0-118">Football</span></span>  | <span data-ttu-id="b36f0-119">Football.txt、sFootball</span><span class="sxs-lookup"><span data-stu-id="b36f0-119">Football.txt, sFootball</span></span>                                                                                               |
| <span data-ttu-id="b36f0-120">Help</span><span class="sxs-lookup"><span data-stu-id="b36f0-120">Help</span></span>      | <span data-ttu-id="b36f0-121">Help.txt、現成</span><span class="sxs-lookup"><span data-stu-id="b36f0-121">Help.txt, sHelp</span></span>                                                                                                       |
| <span data-ttu-id="b36f0-122">一月</span><span class="sxs-lookup"><span data-stu-id="b36f0-122">January</span></span>   | <span data-ttu-id="b36f0-123">January.txt、sJanuary</span><span class="sxs-lookup"><span data-stu-id="b36f0-123">January.txt, sJanuary</span></span>                                                                                                 |
| <span data-ttu-id="b36f0-124">NewYears</span><span class="sxs-lookup"><span data-stu-id="b36f0-124">NewYears</span></span>  | <span data-ttu-id="b36f0-125">NewYears.txt、sNewYears</span><span class="sxs-lookup"><span data-stu-id="b36f0-125">NewYears.txt, sNewYears</span></span>                                                                                               |
| <span data-ttu-id="b36f0-126">[記事本]</span><span class="sxs-lookup"><span data-stu-id="b36f0-126">Notepad</span></span>   | <span data-ttu-id="b36f0-127">Redpark.exe，Readme.txt，sReadme，sNotepad， **HKEY \_ LOCAL \_ MACHINE** \\ **SOFTWARE** \\ **Microsoft** \\ **Notepad Sample**</span><span class="sxs-lookup"><span data-stu-id="b36f0-127">Redpark.exe, Readme.txt, sReadme, sNotepad, **HKEY\_LOCAL\_MACHINE**\\**SOFTWARE**\\**Microsoft**\\**Notepad Sample**</span></span> |



 

<span data-ttu-id="b36f0-128">每個元件都應該使用唯一的元件識別碼 [GUID](guid.md)來識別。</span><span class="sxs-lookup"><span data-stu-id="b36f0-128">Every component should be identified with a unique component ID [GUID](guid.md).</span></span> <span data-ttu-id="b36f0-129">如果您要重現範例，請不要重複使用下表中的相同元件識別碼 Guid。</span><span class="sxs-lookup"><span data-stu-id="b36f0-129">If you are reproducing the sample, do not reuse the same component ID GUIDs in the following table.</span></span> <span data-ttu-id="b36f0-130">相反地，請使用 Guidgen.exe 之類的公用程式來為您的元件產生新的 Guid。</span><span class="sxs-lookup"><span data-stu-id="b36f0-130">Instead use a utility such as Guidgen.exe to generate new GUIDs for your components.</span></span>

<span data-ttu-id="b36f0-131">請確定您使用的 GUID 字串與 Windows Installer GUID 資料類型一致。</span><span class="sxs-lookup"><span data-stu-id="b36f0-131">Be sure that you use a GUID string consistent with the Windows Installer GUID data type.</span></span> <span data-ttu-id="b36f0-132">如需詳細資訊，請參閱 [變更元件程式碼](changing-the-component-code.md) ，以及 [元件規則是否中斷時會發生什麼事？](what-happens-if-the-component-rules-are-broken.md)</span><span class="sxs-lookup"><span data-stu-id="b36f0-132">For more information, see [Changing the Component Code](changing-the-component-code.md) and [What happens if the component rules are broken?](what-happens-if-the-component-rules-are-broken.md)</span></span>

<span data-ttu-id="b36f0-133">使用 Orca 或其他資料庫編輯器，將下列資料輸入 MNP2000.msi 的空白 [元件資料表](component-table.md) 中。</span><span class="sxs-lookup"><span data-stu-id="b36f0-133">Use Orca or another database editor to enter the following data into the blank [Component Table](component-table.md) of MNP2000.msi.</span></span> <span data-ttu-id="b36f0-134">請勿在範例的 [元件] 資料行中重複使用如下所示的 Guid。</span><span class="sxs-lookup"><span data-stu-id="b36f0-134">Do not reuse the GUIDs shown below in the ComponentId column in your sample.</span></span>



| <span data-ttu-id="b36f0-135">元件</span><span class="sxs-lookup"><span data-stu-id="b36f0-135">Component</span></span> | <span data-ttu-id="b36f0-136">ComponentId</span><span class="sxs-lookup"><span data-stu-id="b36f0-136">ComponentId</span></span>                            | <span data-ttu-id="b36f0-137">目錄\_</span><span class="sxs-lookup"><span data-stu-id="b36f0-137">Directory\_</span></span> | <span data-ttu-id="b36f0-138">屬性</span><span class="sxs-lookup"><span data-stu-id="b36f0-138">Attributes</span></span> | <span data-ttu-id="b36f0-139">條件</span><span class="sxs-lookup"><span data-stu-id="b36f0-139">Condition</span></span> | <span data-ttu-id="b36f0-140">Keypath</span><span class="sxs-lookup"><span data-stu-id="b36f0-140">Keypath</span></span>      |
|-----------|----------------------------------------|-------------|------------|-----------|--------------|
| <span data-ttu-id="b36f0-141">棒球</span><span class="sxs-lookup"><span data-stu-id="b36f0-141">Baseball</span></span>  | <span data-ttu-id="b36f0-142">{F54ABAC0-33F2-11D3-91D7-00C04FD70856}</span><span class="sxs-lookup"><span data-stu-id="b36f0-142">{F54ABAC0-33F2-11D3-91D7-00C04FD70856}</span></span> | <span data-ttu-id="b36f0-143">SPORTDIR</span><span class="sxs-lookup"><span data-stu-id="b36f0-143">SPORTDIR</span></span>    | <span data-ttu-id="b36f0-144">2</span><span class="sxs-lookup"><span data-stu-id="b36f0-144">2</span></span>          |           | <span data-ttu-id="b36f0-145">Baseball.txt</span><span class="sxs-lookup"><span data-stu-id="b36f0-145">Baseball.txt</span></span> |
| <span data-ttu-id="b36f0-146">演唱會</span><span class="sxs-lookup"><span data-stu-id="b36f0-146">Concert</span></span>   | <span data-ttu-id="b36f0-147">{76FA7A80-33F6-11D3-91D8-00C04FD70856}</span><span class="sxs-lookup"><span data-stu-id="b36f0-147">{76FA7A80-33F6-11D3-91D8-00C04FD70856}</span></span> | <span data-ttu-id="b36f0-148">ARTSDIR</span><span class="sxs-lookup"><span data-stu-id="b36f0-148">ARTSDIR</span></span>     | <span data-ttu-id="b36f0-149">2</span><span class="sxs-lookup"><span data-stu-id="b36f0-149">2</span></span>          |           | <span data-ttu-id="b36f0-150">Concert.txt</span><span class="sxs-lookup"><span data-stu-id="b36f0-150">Concert.txt</span></span>  |
| <span data-ttu-id="b36f0-151">舞蹈</span><span class="sxs-lookup"><span data-stu-id="b36f0-151">Dance</span></span>     | <span data-ttu-id="b36f0-152">{CCF834A1-33F8-11D3-91D8-00C04FD70856}</span><span class="sxs-lookup"><span data-stu-id="b36f0-152">{CCF834A1-33F8-11D3-91D8-00C04FD70856}</span></span> | <span data-ttu-id="b36f0-153">ARTSDIR</span><span class="sxs-lookup"><span data-stu-id="b36f0-153">ARTSDIR</span></span>     | <span data-ttu-id="b36f0-154">2</span><span class="sxs-lookup"><span data-stu-id="b36f0-154">2</span></span>          |           | <span data-ttu-id="b36f0-155">Dance.txt</span><span class="sxs-lookup"><span data-stu-id="b36f0-155">Dance.txt</span></span>    |
| <span data-ttu-id="b36f0-156">足球</span><span class="sxs-lookup"><span data-stu-id="b36f0-156">Football</span></span>  | <span data-ttu-id="b36f0-157">{CCF834A0-33F8-11D3-91D8-00C04FD70856}</span><span class="sxs-lookup"><span data-stu-id="b36f0-157">{CCF834A0-33F8-11D3-91D8-00C04FD70856}</span></span> | <span data-ttu-id="b36f0-158">SPORTDIR</span><span class="sxs-lookup"><span data-stu-id="b36f0-158">SPORTDIR</span></span>    | <span data-ttu-id="b36f0-159">2</span><span class="sxs-lookup"><span data-stu-id="b36f0-159">2</span></span>          |           | <span data-ttu-id="b36f0-160">Football.txt</span><span class="sxs-lookup"><span data-stu-id="b36f0-160">Football.txt</span></span> |
| <span data-ttu-id="b36f0-161">Help</span><span class="sxs-lookup"><span data-stu-id="b36f0-161">Help</span></span>      | <span data-ttu-id="b36f0-162">{AD10EB50-33C1-11D3-91D6-00C04FD70856}</span><span class="sxs-lookup"><span data-stu-id="b36f0-162">{AD10EB50-33C1-11D3-91D6-00C04FD70856}</span></span> | <span data-ttu-id="b36f0-163">NOTEPADDIR</span><span class="sxs-lookup"><span data-stu-id="b36f0-163">NOTEPADDIR</span></span>  | <span data-ttu-id="b36f0-164">2</span><span class="sxs-lookup"><span data-stu-id="b36f0-164">2</span></span>          |           | <span data-ttu-id="b36f0-165">Help.txt</span><span class="sxs-lookup"><span data-stu-id="b36f0-165">Help.txt</span></span>     |
| <span data-ttu-id="b36f0-166">一月</span><span class="sxs-lookup"><span data-stu-id="b36f0-166">January</span></span>   | <span data-ttu-id="b36f0-167">{CF0BC690-33C9-11D3-91D6-00C04FD70856}</span><span class="sxs-lookup"><span data-stu-id="b36f0-167">{CF0BC690-33C9-11D3-91D6-00C04FD70856}</span></span> | <span data-ttu-id="b36f0-168">MONDIR</span><span class="sxs-lookup"><span data-stu-id="b36f0-168">MONDIR</span></span>      | <span data-ttu-id="b36f0-169">2</span><span class="sxs-lookup"><span data-stu-id="b36f0-169">2</span></span>          |           | <span data-ttu-id="b36f0-170">January.txt</span><span class="sxs-lookup"><span data-stu-id="b36f0-170">January.txt</span></span>  |
| <span data-ttu-id="b36f0-171">NewYears</span><span class="sxs-lookup"><span data-stu-id="b36f0-171">NewYears</span></span>  | <span data-ttu-id="b36f0-172">{A42D9140-33D8-11D3-91D6-00C04FD70856}</span><span class="sxs-lookup"><span data-stu-id="b36f0-172">{A42D9140-33D8-11D3-91D6-00C04FD70856}</span></span> | <span data-ttu-id="b36f0-173">HOLDIR</span><span class="sxs-lookup"><span data-stu-id="b36f0-173">HOLDIR</span></span>      | <span data-ttu-id="b36f0-174">2</span><span class="sxs-lookup"><span data-stu-id="b36f0-174">2</span></span>          |           | <span data-ttu-id="b36f0-175">NewYears.txt</span><span class="sxs-lookup"><span data-stu-id="b36f0-175">NewYears.txt</span></span> |
| <span data-ttu-id="b36f0-176">[記事本]</span><span class="sxs-lookup"><span data-stu-id="b36f0-176">Notepad</span></span>   | <span data-ttu-id="b36f0-177">{19BED232-30AB-11D3-91D3-00C04FD70856}</span><span class="sxs-lookup"><span data-stu-id="b36f0-177">{19BED232-30AB-11D3-91D3-00C04FD70856}</span></span> | <span data-ttu-id="b36f0-178">NOTEPADDIR</span><span class="sxs-lookup"><span data-stu-id="b36f0-178">NOTEPADDIR</span></span>  | <span data-ttu-id="b36f0-179">2</span><span class="sxs-lookup"><span data-stu-id="b36f0-179">2</span></span>          |           | <span data-ttu-id="b36f0-180">Redpark.exe</span><span class="sxs-lookup"><span data-stu-id="b36f0-180">Redpark.exe</span></span>  |



 

<span data-ttu-id="b36f0-181">每個元件的來源和目標目錄都是由輸入目錄資料行中的值所指定 \_ 。</span><span class="sxs-lookup"><span data-stu-id="b36f0-181">The source and target directories for each component is specified by the value entered into the Directory\_ column.</span></span> <span data-ttu-id="b36f0-182">安裝程式會使用目錄資料表中的資訊來解析此目錄的位置。</span><span class="sxs-lookup"><span data-stu-id="b36f0-182">The installer resolves the location of this directory using the information in the Directory table.</span></span> <span data-ttu-id="b36f0-183">安裝程式會使用 KeyPath 資料行中指定的金鑰路徑檔案來偵測每個元件。</span><span class="sxs-lookup"><span data-stu-id="b36f0-183">The installer uses the key path files specified in the KeyPath column to detect each component.</span></span> <span data-ttu-id="b36f0-184">在範例中會設定遠端執行屬性，讓元件可以從來源執行或在本機執行。</span><span class="sxs-lookup"><span data-stu-id="b36f0-184">The remote execution attributes are set in the sample so that the components can be run-from-source or run-locally.</span></span>

[<span data-ttu-id="b36f0-185">繼續</span><span class="sxs-lookup"><span data-stu-id="b36f0-185">Continue</span></span>](specifying-files-and-file-attributes.md)

 

 



