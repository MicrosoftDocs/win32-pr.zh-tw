---
description: 驗證 MsiServiceConfig 和 MsiServiceConfigFailureActions 資料表。
ms.assetid: 48d8659d-fd10-404a-8310-ef394406f5df
title: ICE 102
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: afee8ae84a9fa022b7bcd2f9de4302976eb760a47dcd5ad9b95eac09dd5a4885
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/11/2021
ms.locfileid: "120044178"
---
# <a name="ice-102"></a>ICE 102

驗證 [MsiServiceConfig](msiserviceconfig-table.md) 和 [MsiServiceConfigFailureActions](msiserviceconfigfailureactions-table.md) 資料表。

確認 [MsiServiceConfig](msiserviceconfig-table.md) 和 [MsiServiceConfigFailureActions](msiserviceconfigfailureactions-table.md) 資料表的事件資料行中的值是 **msidbServiceConfigEventInstall**、 **msidbServiceConfigEventUninstall** 或 **msidbServiceConfigEventReinstall**。 確認 MsiServiceConfig 和 MsiServiceConfigFailureActions 資料表之 Component 資料行中的值， \_ 是否為 [元件資料表](component-table.md)中的有效索引鍵。

確認 [MsiServiceConfig](msiserviceconfig-table.md) 資料表的名稱 configtype 資料行中的值是其中一個允許的值。

確認 [動作] 和 [ [MsiServiceConfigFailureActions](msiserviceconfigfailureactions-table.md) ] 資料表的 [延遲動作] 資料行中的值是以分隔 \[ ~ \] 。 確認 [動作] 資料行中所列的值數目，以及 MsiServiceConfigFailureActions 資料表之每個資料列的 [延遲動作] 資料行中所列的值數目相同。

如果 [MsiServiceConfig 資料表](msiserviceconfig-table.md) 的 [名稱 configtype] 欄位中的值為 [ **服務設定 \_ \_ 延遲 \_ \_** ]，[引數] 欄位中的值必須是0或1。

如果 [MsiServiceConfig 資料表](msiserviceconfig-table.md) 中名稱 configtype 欄位的值為 **服務設定 \_ \_ 所需的 \_ 許可權 \_ 資訊** ，則引數欄位中的值必須包含 **許可權常數** 的有效字串。

如果 [MsiServiceConfig 資料表](msiserviceconfig-table.md) 中名稱 configtype 欄位的值為 **服務設定 \_ \_ 服務 \_ sid \_ 資訊** ，則引數欄位中的值必須是 **服務 \_ Sid \_ 類型 \_ NONE**、 **服務 \_ sid \_ 類型 \_ 限制**，或 **服務 \_ sid 類型不 \_ \_ 受限制**。

如果 [MsiServiceConfig 資料表](msiserviceconfig-table.md) 中名稱 configtype 欄位的值為 **服務設定 \_ \_ PRESHUTDOWN \_ 資訊** ，則 [引數] 欄位中的值必須是正數或空白。 如果 MsiServiceConfig 資料表中名稱 configtype 欄位的值為「服務設定 **\_ 失敗」 \_ \_ 動作 \_** ，則 [引數] 欄位中的值必須包含0或1。

**[Windows Installer 4.5 或更早版本](not-supported-in-windows-installer-4-5.md)：** 不支援。 從 Windows Installer 5.0 開始，可以使用這項冰。

## <a name="result"></a>結果

ICE102 會張貼下列錯誤。



| ICE102 錯誤                                                                                                                                                                                          | 描述                                                                                                                                                                                                                         |
|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 在 MsiServiceConfig 資料表專案中 (MsiServiceConfig = ) \[ 1 \] ，名稱 configtype =% d 不是有效的參數。 其應介於3到7之間。                                                                | [MsiServiceConfig 資料表](msiserviceconfig-table.md)的 Config 欄位未包含其中一個允許的值。                                                                                                            |
| 在 MsiServiceConfig 資料表專案中 (MsiServiceConfig = ) \[ 1 \] ，Argument =% s 不是有效的% s 參數。 它應該是% s。                                                                            | [MsiServiceConfig 資料表](msiserviceconfig-table.md)的引數欄位未包含其中一個允許的值。                                                                                                          |
| 在 MsiServiceConfigFailureActions 資料表專案中 (MsiServiceConfigFailureActions = ) \[ 1 \] ，Actions = \[ 3 \] 不是有效的參數。 它應該是以 null 分隔之非負整數的清單。      | [MsiServiceConfigFailureActions](msiserviceconfigfailureactions-table.md)的 [動作] 欄位不包含正整數的陣列。 分隔陣列中的值 \[ ~ \] 。                                      |
| 在 MsiServiceConfigFailureActions 資料表專案中 (MsiServiceConfigFailureActions = ) \[ 1 \] ，DelayActions = \[ 4 \] 不是有效的參數。 它應該是以 null 分隔之非負整數的清單。 | [MsiServiceConfigFailureActions](msiserviceconfigfailureactions-table.md)的 DelayActions 欄位不包含正整數的陣列。 分隔陣列中的值 \[ ~ \] 。                                 |
| 在 MsiServiceConfigFailureActions 資料表專案中 (MsiServiceConfigFailureActions = ) \[ 1 \] ， (=% d) 的動作數目不等於 DelayActions (=% d) 的數目。 它們應該相等。           | [動作] 和 [ [MsiServiceConfigFailureActions](msiserviceconfigfailureactions-table.md) ] 資料表的 [DelayActions] 欄位中的元素數目不相等。 這些陣列中的元素數目應該相同。 |



 

ICE102 會張貼下列警告。



| ICE104 警告                                                                                                                                            | 描述                                                                                                                                                   |
|-----------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 在 [MsiServiceConfig] 資料表專案中 (MsiServiceConfig = ) \[ 1] \] ，[引數] 欄位保留空白。 將會使用預設的 preshutdown 值180000            | 時間延遲為180000毫秒，因為 [MsiServiceConfig 資料表](msiserviceconfig-table.md) 的引數欄位是空白的。                        |
| 在 MsiServiceConfigFailureActions 資料表專案 (MsiServiceConfigFailureActions = ) \[ 1 中 \] ，ResetPeriod 會保留空白。 它會被無限取代。 | 因為 [MsiServiceConfigFailureActions](msiserviceconfigfailureactions-table.md) 的 ResetPeriod 欄位是空白的，所以永遠不會重設失敗計數。 |



 

 

 



