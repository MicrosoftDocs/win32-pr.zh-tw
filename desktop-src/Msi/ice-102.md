---
description: 驗證 MsiServiceConfig 和 MsiServiceConfigFailureActions 資料表。
ms.assetid: 48d8659d-fd10-404a-8310-ef394406f5df
title: ICE 102
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b997828cbb228b5486a754de13d9a1bcf7b6c5cd
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/08/2021
ms.locfileid: "103693732"
---
# <a name="ice-102"></a><span data-ttu-id="b2f2a-103">ICE 102</span><span class="sxs-lookup"><span data-stu-id="b2f2a-103">ICE 102</span></span>

<span data-ttu-id="b2f2a-104">驗證 [MsiServiceConfig](msiserviceconfig-table.md) 和 [MsiServiceConfigFailureActions](msiserviceconfigfailureactions-table.md) 資料表。</span><span class="sxs-lookup"><span data-stu-id="b2f2a-104">Validates the [MsiServiceConfig](msiserviceconfig-table.md) and [MsiServiceConfigFailureActions](msiserviceconfigfailureactions-table.md) tables.</span></span>

<span data-ttu-id="b2f2a-105">確認 [MsiServiceConfig](msiserviceconfig-table.md) 和 [MsiServiceConfigFailureActions](msiserviceconfigfailureactions-table.md) 資料表的事件資料行中的值是 **msidbServiceConfigEventInstall**、 **msidbServiceConfigEventUninstall** 或 **msidbServiceConfigEventReinstall**。</span><span class="sxs-lookup"><span data-stu-id="b2f2a-105">Verifies that the value in the Event column in the [MsiServiceConfig](msiserviceconfig-table.md) and [MsiServiceConfigFailureActions](msiserviceconfigfailureactions-table.md) tables is **msidbServiceConfigEventInstall**, **msidbServiceConfigEventUninstall**, or **msidbServiceConfigEventReinstall**.</span></span> <span data-ttu-id="b2f2a-106">確認 MsiServiceConfig 和 MsiServiceConfigFailureActions 資料表之 Component 資料行中的值， \_ 是否為 [元件資料表](component-table.md)中的有效索引鍵。</span><span class="sxs-lookup"><span data-stu-id="b2f2a-106">Verifies that the value in the Component\_ column in the MsiServiceConfig and MsiServiceConfigFailureActions tables is a valid key into the [Component Table](component-table.md).</span></span>

<span data-ttu-id="b2f2a-107">確認 [MsiServiceConfig](msiserviceconfig-table.md) 資料表的名稱 configtype 資料行中的值是其中一個允許的值。</span><span class="sxs-lookup"><span data-stu-id="b2f2a-107">Verifies that the values in the ConfigType column of the [MsiServiceConfig](msiserviceconfig-table.md) table is one of the allowed values.</span></span>

<span data-ttu-id="b2f2a-108">確認 [動作] 和 [ [MsiServiceConfigFailureActions](msiserviceconfigfailureactions-table.md) ] 資料表的 [延遲動作] 資料行中的值是以分隔 \[ ~ \] 。</span><span class="sxs-lookup"><span data-stu-id="b2f2a-108">Verifies that the values in the Actions and the Delayed Actions columns of the [MsiServiceConfigFailureActions](msiserviceconfigfailureactions-table.md) table are separated by \[~\].</span></span> <span data-ttu-id="b2f2a-109">確認 [動作] 資料行中所列的值數目，以及 MsiServiceConfigFailureActions 資料表之每個資料列的 [延遲動作] 資料行中所列的值數目相同。</span><span class="sxs-lookup"><span data-stu-id="b2f2a-109">Verifies that the number of values listed in the Actions column and the number of values listed in the Delayed Actions column in each row of the MsiServiceConfigFailureActions table are the same.</span></span>

<span data-ttu-id="b2f2a-110">如果 [MsiServiceConfig 資料表](msiserviceconfig-table.md) 的 [名稱 configtype] 欄位中的值為 [ **服務設定 \_ \_ 延遲 \_ \_** ]，[引數] 欄位中的值必須是0或1。</span><span class="sxs-lookup"><span data-stu-id="b2f2a-110">If the value in the ConfigType field in the [MsiServiceConfig table](msiserviceconfig-table.md) is **SERVICE\_CONFIG\_DELAYED\_AUTO\_START** the value in the Argument field must be 0 or 1.</span></span>

<span data-ttu-id="b2f2a-111">如果 [MsiServiceConfig 資料表](msiserviceconfig-table.md) 中名稱 configtype 欄位的值為 **服務設定 \_ \_ 所需的 \_ 許可權 \_ 資訊** ，則引數欄位中的值必須包含 **許可權常數** 的有效字串。</span><span class="sxs-lookup"><span data-stu-id="b2f2a-111">If the value in the ConfigType field in the [MsiServiceConfig table](msiserviceconfig-table.md) is **SERVICE\_CONFIG\_REQUIRED\_PRIVILEGES\_INFO** the value in the Argument field must contain a valid string of **Privilege Constants**.</span></span>

<span data-ttu-id="b2f2a-112">如果 [MsiServiceConfig 資料表](msiserviceconfig-table.md) 中名稱 configtype 欄位的值為 **服務設定 \_ \_ 服務 \_ sid \_ 資訊** ，則引數欄位中的值必須是 **服務 \_ Sid \_ 類型 \_ NONE**、 **服務 \_ sid \_ 類型 \_ 限制**，或 **服務 \_ sid 類型不 \_ \_ 受限制**。</span><span class="sxs-lookup"><span data-stu-id="b2f2a-112">If the value in the ConfigType field in the [MsiServiceConfig table](msiserviceconfig-table.md) is **SERVICE\_CONFIG\_SERVICE\_SID\_INFO** the value in the Argument field must be **SERVICE\_SID\_TYPE\_NONE**, **SERVICE\_SID\_TYPE\_RESTRICTED**, or **SERVICE\_SID\_TYPE\_UNRESTRICTED**.</span></span>

<span data-ttu-id="b2f2a-113">如果 [MsiServiceConfig 資料表](msiserviceconfig-table.md) 中名稱 configtype 欄位的值為 **服務設定 \_ \_ PRESHUTDOWN \_ 資訊** ，則 [引數] 欄位中的值必須是正數或空白。</span><span class="sxs-lookup"><span data-stu-id="b2f2a-113">If the value in the ConfigType field in the [MsiServiceConfig table](msiserviceconfig-table.md) is **SERVICE\_CONFIG\_PRESHUTDOWN\_INFO** the value in the Argument field must be positive or empty.</span></span> <span data-ttu-id="b2f2a-114">如果 MsiServiceConfig 資料表中名稱 configtype 欄位的值為「服務設定 **\_ 失敗」 \_ \_ 動作 \_** ，則 [引數] 欄位中的值必須包含0或1。</span><span class="sxs-lookup"><span data-stu-id="b2f2a-114">If the value in the ConfigType field in the MsiServiceConfig table is **SERVICE\_CONFIG\_FAILURE\_ACTIONS\_FLAG** the value in the Argument field must contain 0 or 1.</span></span>

<span data-ttu-id="b2f2a-115">**[Windows Installer 4.5 或更早版本](not-supported-in-windows-installer-4-5.md)：** 不支援。</span><span class="sxs-lookup"><span data-stu-id="b2f2a-115">**[Windows Installer 4.5 or earlier](not-supported-in-windows-installer-4-5.md):** Not supported.</span></span> <span data-ttu-id="b2f2a-116">從 Windows Installer 5.0 開始，可以使用這項冰。</span><span class="sxs-lookup"><span data-stu-id="b2f2a-116">This ICE is available beginning with Windows Installer 5.0.</span></span>

## <a name="result"></a><span data-ttu-id="b2f2a-117">結果</span><span class="sxs-lookup"><span data-stu-id="b2f2a-117">Result</span></span>

<span data-ttu-id="b2f2a-118">ICE102 會張貼下列錯誤。</span><span class="sxs-lookup"><span data-stu-id="b2f2a-118">ICE102 posts the following errors.</span></span>



| <span data-ttu-id="b2f2a-119">ICE102 錯誤</span><span class="sxs-lookup"><span data-stu-id="b2f2a-119">ICE102 error</span></span>                                                                                                                                                                                          | <span data-ttu-id="b2f2a-120">Description</span><span class="sxs-lookup"><span data-stu-id="b2f2a-120">Description</span></span>                                                                                                                                                                                                                         |
|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="b2f2a-121">在 MsiServiceConfig 資料表專案中 (MsiServiceConfig = ) \[ 1 \] ，名稱 configtype =% d 不是有效的參數。</span><span class="sxs-lookup"><span data-stu-id="b2f2a-121">In the MsiServiceConfig table entry (MsiServiceConfig = )\[1\], ConfigType =%d is not a valid parameter.</span></span> <span data-ttu-id="b2f2a-122">其應介於3到7之間。</span><span class="sxs-lookup"><span data-stu-id="b2f2a-122">It should be between 3 and 7.</span></span>                                                                | <span data-ttu-id="b2f2a-123">[MsiServiceConfig 資料表](msiserviceconfig-table.md)的 Config 欄位未包含其中一個允許的值。</span><span class="sxs-lookup"><span data-stu-id="b2f2a-123">The Config field of the [MsiServiceConfig table](msiserviceconfig-table.md) does not contain one of the allowed values.</span></span>                                                                                                            |
| <span data-ttu-id="b2f2a-124">在 MsiServiceConfig 資料表專案中 (MsiServiceConfig = ) \[ 1 \] ，Argument =% s 不是有效的% s 參數。</span><span class="sxs-lookup"><span data-stu-id="b2f2a-124">In the MsiServiceConfig table entry (MsiServiceConfig = )\[1\], Argument =%s is not a valid %s parameter.</span></span> <span data-ttu-id="b2f2a-125">它應該是% s。</span><span class="sxs-lookup"><span data-stu-id="b2f2a-125">It should be %s.</span></span>                                                                            | <span data-ttu-id="b2f2a-126">[MsiServiceConfig 資料表](msiserviceconfig-table.md)的引數欄位未包含其中一個允許的值。</span><span class="sxs-lookup"><span data-stu-id="b2f2a-126">The Argument field of the [MsiServiceConfig table](msiserviceconfig-table.md) does not contain one of the allowed values.</span></span>                                                                                                          |
| <span data-ttu-id="b2f2a-127">在 MsiServiceConfigFailureActions 資料表專案中 (MsiServiceConfigFailureActions = ) \[ 1 \] ，Actions = \[ 3 \] 不是有效的參數。</span><span class="sxs-lookup"><span data-stu-id="b2f2a-127">In the MsiServiceConfigFailureActions table entry (MsiServiceConfigFailureActions = )\[1\], Actions=\[3\] is not a valid parameter.</span></span> <span data-ttu-id="b2f2a-128">它應該是以 null 分隔之非負整數的清單。</span><span class="sxs-lookup"><span data-stu-id="b2f2a-128">It should be a list of null-separated non-negative integers.</span></span>      | <span data-ttu-id="b2f2a-129">[MsiServiceConfigFailureActions](msiserviceconfigfailureactions-table.md)的 [動作] 欄位不包含正整數的陣列。</span><span class="sxs-lookup"><span data-stu-id="b2f2a-129">The Actions field of the [MsiServiceConfigFailureActions](msiserviceconfigfailureactions-table.md) does not contain an array of positive integers.</span></span> <span data-ttu-id="b2f2a-130">分隔陣列中的值 \[ ~ \] 。</span><span class="sxs-lookup"><span data-stu-id="b2f2a-130">Separate the values in the array by \[~\].</span></span>                                      |
| <span data-ttu-id="b2f2a-131">在 MsiServiceConfigFailureActions 資料表專案中 (MsiServiceConfigFailureActions = ) \[ 1 \] ，DelayActions = \[ 4 \] 不是有效的參數。</span><span class="sxs-lookup"><span data-stu-id="b2f2a-131">In the MsiServiceConfigFailureActions table entry (MsiServiceConfigFailureActions = )\[1\], DelayActions=\[4\] is not a valid parameter.</span></span> <span data-ttu-id="b2f2a-132">它應該是以 null 分隔之非負整數的清單。</span><span class="sxs-lookup"><span data-stu-id="b2f2a-132">It should be a list of null-separated non-negative integers.</span></span> | <span data-ttu-id="b2f2a-133">[MsiServiceConfigFailureActions](msiserviceconfigfailureactions-table.md)的 DelayActions 欄位不包含正整數的陣列。</span><span class="sxs-lookup"><span data-stu-id="b2f2a-133">The DelayActions field of the [MsiServiceConfigFailureActions](msiserviceconfigfailureactions-table.md) does not contain an array of positive integers.</span></span> <span data-ttu-id="b2f2a-134">分隔陣列中的值 \[ ~ \] 。</span><span class="sxs-lookup"><span data-stu-id="b2f2a-134">Separate the values in the array by \[~\].</span></span>                                 |
| <span data-ttu-id="b2f2a-135">在 MsiServiceConfigFailureActions 資料表專案中 (MsiServiceConfigFailureActions = ) \[ 1 \] ， (=% d) 的動作數目不等於 DelayActions (=% d) 的數目。</span><span class="sxs-lookup"><span data-stu-id="b2f2a-135">In the MsiServiceConfigFailureActions table entry (MsiServiceConfigFailureActions = )\[1\], number of Actions (=%d) is not equal to the number of DelayActions (=%d).</span></span> <span data-ttu-id="b2f2a-136">它們應該相等。</span><span class="sxs-lookup"><span data-stu-id="b2f2a-136">They should be equal.</span></span>           | <span data-ttu-id="b2f2a-137">[動作] 和 [ [MsiServiceConfigFailureActions](msiserviceconfigfailureactions-table.md) ] 資料表的 [DelayActions] 欄位中的元素數目不相等。</span><span class="sxs-lookup"><span data-stu-id="b2f2a-137">The number of elements in the Actions and the DelayActions fields of the [MsiServiceConfigFailureActions](msiserviceconfigfailureactions-table.md) table are not equal.</span></span> <span data-ttu-id="b2f2a-138">這些陣列中的元素數目應該相同。</span><span class="sxs-lookup"><span data-stu-id="b2f2a-138">The number of elements in these arrays should be the same.</span></span> |



 

<span data-ttu-id="b2f2a-139">ICE102 會張貼下列警告。</span><span class="sxs-lookup"><span data-stu-id="b2f2a-139">ICE102 posts the following warnings.</span></span>



| <span data-ttu-id="b2f2a-140">ICE104 警告</span><span class="sxs-lookup"><span data-stu-id="b2f2a-140">ICE104 warning</span></span>                                                                                                                                            | <span data-ttu-id="b2f2a-141">Description</span><span class="sxs-lookup"><span data-stu-id="b2f2a-141">Description</span></span>                                                                                                                                                   |
|-----------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="b2f2a-142">在 [MsiServiceConfig] 資料表專案中 (MsiServiceConfig = ) \[ 1] \] ，[引數] 欄位保留空白。</span><span class="sxs-lookup"><span data-stu-id="b2f2a-142">In the MsiServiceConfig table entry (MsiServiceConfig = )\[1\], Argument field is left blank.</span></span> <span data-ttu-id="b2f2a-143">將會使用預設的 preshutdown 值180000</span><span class="sxs-lookup"><span data-stu-id="b2f2a-143">Default preshutdown value of 180000 will be used</span></span>            | <span data-ttu-id="b2f2a-144">時間延遲為180000毫秒，因為 [MsiServiceConfig 資料表](msiserviceconfig-table.md) 的引數欄位是空白的。</span><span class="sxs-lookup"><span data-stu-id="b2f2a-144">The time delay is 180000 milliseconds because the Argument field of the [MsiServiceConfig table](msiserviceconfig-table.md) is blank.</span></span>                        |
| <span data-ttu-id="b2f2a-145">在 MsiServiceConfigFailureActions 資料表專案 (MsiServiceConfigFailureActions = ) \[ 1 中 \] ，ResetPeriod 會保留空白。</span><span class="sxs-lookup"><span data-stu-id="b2f2a-145">In the MsiServiceConfigFailureActions table entry (MsiServiceConfigFailureActions = )\[1\], ResetPeriod is left blank.</span></span> <span data-ttu-id="b2f2a-146">它會被無限取代。</span><span class="sxs-lookup"><span data-stu-id="b2f2a-146">It will be replaced with INFINITE.</span></span> | <span data-ttu-id="b2f2a-147">因為 [MsiServiceConfigFailureActions](msiserviceconfigfailureactions-table.md) 的 ResetPeriod 欄位是空白的，所以永遠不會重設失敗計數。</span><span class="sxs-lookup"><span data-stu-id="b2f2a-147">The failure count is never be reset because the ResetPeriod field of the [MsiServiceConfigFailureActions](msiserviceconfigfailureactions-table.md) is blank.</span></span> |



 

 

 



