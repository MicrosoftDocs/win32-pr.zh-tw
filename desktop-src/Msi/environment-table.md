---
description: 環境資料表是用來設定環境變數的值。
ms.assetid: f7106ed6-706f-4e57-989f-030066bcecd3
title: 環境資料表
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: d7a4db2e33c01685bdc40475f659e1b03b69b6c6
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/07/2021
ms.locfileid: "106987482"
---
# <a name="environment-table"></a>環境資料表

環境資料表是用來設定環境變數的值。

環境資料表具有下列資料行。



| Column      | 類型                         | 答案 | Nullable |
|-------------|------------------------------|-----|----------|
| 環境 | [識別碼](identifier.md) | Y   | N        |
| Name        | [Text](text.md)             | N   | N        |
| 值       | [格式 化](formatted.md)   | N   | Y        |
| 元件\_ | [識別碼](identifier.md) | N   | N        |



 

## <a name="columns"></a>資料行

<dl> <dt>

<span id="Environment"></span><span id="environment"></span><span id="ENVIRONMENT"></span>環境
</dt> <dd>

這是資料表的主鍵，而且是非當地語系化的標記。

</dd> <dt>

<span id="Name"></span><span id="name"></span><span id="NAME"></span>名字
</dt> <dd>

此資料行是環境變數的可當地語系化名稱。 系統會根據下表中的哪些字元前面加上名稱，來寫入或移除索引鍵值。 前置詞中使用的符號順序不會有任何影響。



| 前置詞                         | 描述                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|--------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| =                              | 如果環境變數不存在，請建立環境變數，然後在安裝期間進行設定。 如果環境變數存在，請在安裝期間進行設定。                                                                                                                                                                                                                                                                                                                                   |
| \+                             | 如果環境變數不存在，請建立環境變數，然後在安裝期間進行設定。 如果環境變數的值已存在，則不會對其產生任何影響。                                                                                                                                                                                                                                                                                                                         |
| \-                             | 移除元件時，移除環境變數。 這個符號可以與任何前置詞結合。                                                                                                                                                                                                                                                                                                                                                                                      |
| !                              | 在安裝期間移除環境變數。 如果變數的名稱和值與環境資料表的 [名稱] 和 [值] 欄位中的專案相符，則安裝程式只會在安裝期間移除環境變數。 如果您想要移除環境變數（不論其值為何），請使用 '！ ' 語法，並將 [值] 欄位保留空白。                                                                                                                    |
| \*                             | 這個前置詞會與 Windows 2000 搭配使用，指出名稱是指系統內容變數。 如果沒有星號存在，安裝程式會將變數寫入使用者的環境。 這個符號可以與任何前置詞結合。 在每一部電腦的 [安裝內容](installation-context.md) 中，用於安裝的封裝應該包含 \* 在名稱資料行中，以將環境變數寫入機器的環境中。 如需詳細資訊，請參閱＜備註＞。 |
| =-                             | 環境變數會在安裝時設定，並在卸載時移除。 這是一般的行為。                                                                                                                                                                                                                                                                                                                                                                                                 |
| !-                             | 在安裝或卸載期間移除環境變數。                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| =+ !+<br/> !=<br/> | 這些不是有效的首碼                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |



 

如果資料表中的 [值] 欄位包含 \[ ~ \] ，則前置詞字元只適用于字串的指定部分。 在以下的 [ \[ ~ \] 值資料行] 區段中描述的用法。

如果資料表的 [值] 欄位是空白的，則會移除環境變數。 因此，在 [值] 欄位中有空白的 = 前置詞會在安裝時刪除環境變數，而-前置詞則會在卸載時刪除任何目前的值。

</dd> <dt>

<span id="Value"></span><span id="value"></span><span id="VALUE"></span>價值
</dt> <dd>

此資料行包含要設定為格式化字串的可當地語系化值。 請參閱 [格式化](formatted.md)。 如果此欄位保留空白，則會移除該變數。 如果欄位是空白的，且 [名稱] 欄位中的字串前面加上-符號，則只有在移除元件時，才會移除該變數。

若要將值附加至現有變數的結尾，請在此欄位中的字串前面加上 Null 字元 \[ ~ \] 和分隔字元。 例如，如果分號是選擇的分隔符號： \[ ~ \] ;*值*。

若要將值的前置詞加到現有變數的前面，請在此欄位中，依分隔符號和 Null 字元附加字串 \[ ~ \] 。 例如，如果分號是選擇的分隔符號： *Value*; \[ ~ \].

如果 \[ ~ \] 欄位中沒有任何，則字串代表要設定或刪除的整個值。

每個資料列只能包含一個值。 例如，專案 *值*;*值* \[ ~ ; \]是一個以上的值，不應使用，因為它會造成無法預期的結果。 專案 *值*; \[ ~ \]只是一個值。

如果名稱前面加上 +，就 \[ ~ \] 不能在 Value 資料行中使用。 這是因為 "+" 和 "" 的意義 \[ ~ \] 明確地彼此互斥。

</dd> <dt>

<span id="Component_"></span><span id="component_"></span><span id="COMPONENT_"></span>元件\_
</dt> <dd>

[元件資料表](component-table.md)第一個資料行的外部索引鍵。 此資料行參考控制環境值安裝的元件。

</dd> </dl>

## <a name="remarks"></a>備註

若要讓安裝程式設定環境變數，必須在[InstallExecuteSequence 資料表](installexecutesequence-table.md)中列出[WriteEnvironmentStrings 動作](writeenvironmentstrings-action.md)和[RemoveEnvironmentStrings 動作](removeenvironmentstrings-action.md)。

請注意，執行 [WriteEnvironmentStrings 動作](writeenvironmentstrings-action.md) 或 [RemoveEnvironmentStrings 動作](removeenvironmentstrings-action.md) 時，環境變數不會變更進行中的安裝。 在 Windows 2000 上，這項資訊會儲存在登錄中，而訊息則會在安裝完成時通知系統變更。 新的進程或另一個檢查這些訊息的程式會使用新的環境變數。

使用環境資料表修改 path 環境變數時，請勿嘗試將整個新路徑明確地輸入到 [值] 欄位中。 請改為將現有的路徑加上首碼或附加值和分隔符號 (; ) \[ ~ \] 。 如果未 \[ ~ \] 出現在 [值] 欄位中，則會遺失現有的路徑資訊，而且安裝 .msi 檔案可能會導致電腦無法開機。 Path 變數通常是使用語法： \[ ~ \] ;價值。

從終端機伺服器執行每部電腦安裝時，安裝程式會將每個使用者的環境變數寫入 **HKU \\ 。預設 \\ 環境**。 因為終端機服務不會複寫登錄的這個區段，所以安裝不會設定每個使用者的環境變數。 針對每部電腦安裝所使用的套件，應該包含在 [名稱] 資料行中，以將環境變數寫入電腦的環境 \* 中。 如果可以為每位使用者或每部電腦安裝封裝，請建立兩個元件： (1) 具有針對使用者設定撰寫之環境資料表專案的每個使用者元件，以及 (2) 個別電腦的元件，以及針對電腦設定所撰寫的環境資料表。 條件：使用具特殊 [**許可權**](privileged.md) 的屬性安裝此元件。

## <a name="validation"></a>驗證

<dl>

[ICE03](ice03.md)  
[ICE06](ice06.md)  
[ICE32](ice32.md)  
[ICE46](ice46.md)  
[ICE65](ice65.md)  
[ICE69](ice69.md)  
[ICE80](ice80.md)  
</dl>

 

 




