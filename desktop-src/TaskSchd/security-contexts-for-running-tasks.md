---
title: 工作的安全性內容
description: 工作會在特定的安全性內容下註冊並執行。
ms.assetid: be86eb9f-f6ec-4dce-afe8-e3314a74062a
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 329f354518daeb11a5f330ae3fdc2c332b66d5c3
ms.sourcegitcommit: 3e70ae762629e244028b437420ed50b5850db4e3
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 02/20/2020
ms.locfileid: "104374598"
---
# <a name="security-contexts-for-tasks"></a><span data-ttu-id="74487-103">工作的安全性內容</span><span class="sxs-lookup"><span data-stu-id="74487-103">Security Contexts for Tasks</span></span>

<span data-ttu-id="74487-104">工作會在特定的安全性內容下註冊並執行。</span><span class="sxs-lookup"><span data-stu-id="74487-104">Tasks are registered and run under a specific security context.</span></span> <span data-ttu-id="74487-105">使用者可以建立成功註冊、更新、刪除或執行工作的應用程式，但使用者必須在註冊工作時提供正確的認證，而且應用程式必須以正確的許可權在進程中執行。</span><span class="sxs-lookup"><span data-stu-id="74487-105">Users can create applications that successfully register, update, delete, or run tasks, but the user must supply the correct credentials when a task is registered and the application must be running in a process with the correct privileges.</span></span>

## <a name="specifying-credentials"></a><span data-ttu-id="74487-106">指定認證</span><span class="sxs-lookup"><span data-stu-id="74487-106">Specifying Credentials</span></span>

<span data-ttu-id="74487-107">您可以指定工作的安全性內容，方法是指定 [**ITaskFolder：： RegisterTask**](/windows/desktop/api/taskschd/nf-taskschd-itaskfolder-registertask)或 [**ITaskFolder：： RegisterTaskDefinition**](/windows/desktop/api/taskschd/nf-taskschd-itaskfolder-registertaskdefinition)中的認證 ([**TaskFolder**](taskfolder-registertask.md)或 [**RegisterTask. TaskFolder**](taskfolder-registertaskdefinition.md) ，以編寫腳本) 方法，或是將主體指派給 RegisterTaskDefinition ([**ITaskDefinition**](taskdefinition-principal.md)的 [**principal 屬性**](/windows/desktop/api/taskschd/nf-taskschd-itaskdefinition-get_principal)) 的主體。</span><span class="sxs-lookup"><span data-stu-id="74487-107">You can specify the security context for a task by specifying credentials in the [**ITaskFolder::RegisterTask**](/windows/desktop/api/taskschd/nf-taskschd-itaskfolder-registertask) or [**ITaskFolder::RegisterTaskDefinition**](/windows/desktop/api/taskschd/nf-taskschd-itaskfolder-registertaskdefinition) ([**TaskFolder.RegisterTask**](taskfolder-registertask.md) or [**TaskFolder.RegisterTaskDefinition**](taskfolder-registertaskdefinition.md) for scripting) methods or by assigning a principal to the [**Principal Property of ITaskDefinition**](/windows/desktop/api/taskschd/nf-taskschd-itaskdefinition-get_principal) ([**TaskDefinition.Principal**](taskdefinition-principal.md) for scripting).</span></span> <span data-ttu-id="74487-108">如果為工作定義建立主體，然後使用 **RegisterTaskDefinition** 方法來註冊工作定義，並在方法參數中指定不同的認證，則在 **RegisterTaskDefinition** 方法中指定的認證將會覆寫主體中的認證。</span><span class="sxs-lookup"><span data-stu-id="74487-108">If a principal is created for a task definition, and then the task definition is registered using the **RegisterTaskDefinition** method with different credentials specified in the method parameters, then the credentials specified in the **RegisterTaskDefinition** method will overwrite the credentials in the principal.</span></span> <span data-ttu-id="74487-109">如果使用 XML 來建立工作定義的主體，然後使用 **RegisterTask** 方法來註冊工作的 xml，並在方法參數中指定不同的認證，則在 **RegisterTask** 方法中指定的認證將會覆寫主體中的認證。</span><span class="sxs-lookup"><span data-stu-id="74487-109">If a principal is created for a task definition using XML, and then the XML for the task is registered using the **RegisterTask** method with different credentials specified in the method parameters, then the credentials specified in the **RegisterTask** method will overwrite the credentials in the principal.</span></span>

<span data-ttu-id="74487-110">您可以在註冊工作或指定工作的原則時，指定使用者帳戶或群組。</span><span class="sxs-lookup"><span data-stu-id="74487-110">You specify a user account or group when registering a task or specifying the principle for a task.</span></span> <span data-ttu-id="74487-111">使用者帳戶或群組的安全性內容會用於工作的安全性內容。</span><span class="sxs-lookup"><span data-stu-id="74487-111">The security context of the user account or group is used for the security context of the task.</span></span> <span data-ttu-id="74487-112">在這些方法和屬性中，您也可以定義登入類型。</span><span class="sxs-lookup"><span data-stu-id="74487-112">In these methods and properties, you also define the logon type.</span></span> <span data-ttu-id="74487-113">登入類型是由工作 [**\_ 登入 \_ 類型**](/windows/desktop/api/taskschd/ne-taskschd-task_logon_type) 列舉中的其中一個常數所定義。</span><span class="sxs-lookup"><span data-stu-id="74487-113">The logon type is defined by one of the constants in the [**TASK\_LOGON\_TYPE**](/windows/desktop/api/taskschd/ne-taskschd-task_logon_type) enumeration.</span></span>

<span data-ttu-id="74487-114">使用工作 \_ 登入 \_ 密碼或工作登入 S4U 旗標注冊的工作， \_ \_ 只會在指定的使用者已啟用 [登入為批次許可權] 時啟動。</span><span class="sxs-lookup"><span data-stu-id="74487-114">Tasks registered with the TASK\_LOGON\_PASSWORD or TASK\_LOGON\_S4U flag will only launch if the specified user has the Logon as Batch privilege enabled.</span></span> <span data-ttu-id="74487-115">系統管理員和備份操作員群組使用者預設會啟用此許可權。</span><span class="sxs-lookup"><span data-stu-id="74487-115">Administrators and Backup Operators group users have this privilege enabled by default.</span></span>

<span data-ttu-id="74487-116">當您呼叫 [**ITaskService：： connect**](/windows/desktop/api/taskschd/nf-taskschd-itaskservice-connect) ([**TaskService**](taskservice-connect.md) ，) 方法的腳本中，任何後續的方法呼叫工作排程器服務都會使用傳遞給 **Connect** 方法的認證。</span><span class="sxs-lookup"><span data-stu-id="74487-116">When you call the [**ITaskService::Connect**](/windows/desktop/api/taskschd/nf-taskschd-itaskservice-connect) ([**TaskService.Connect**](taskservice-connect.md) for scripting) method, any subsequent method calls to the Task Scheduler service will use the credentials that were passed to the **Connect** method.</span></span> <span data-ttu-id="74487-117">使用互動式登入類型註冊工作時，請務必考慮這一點。</span><span class="sxs-lookup"><span data-stu-id="74487-117">This is important to consider when registering tasks with an interactive logon type.</span></span> <span data-ttu-id="74487-118">當您註冊的工作具有等於工作登入互動式權杖的登入類型，而且該工作在工作 \_ \_ 定義的 \_ [**Principal**](/windows/desktop/api/taskschd/nf-taskschd-itaskdefinition-get_principal) 屬性中指定的認證（在要 [**RegisterTaskDefinition**](/windows/desktop/api/taskschd/nf-taskschd-itaskfolder-registertaskdefinition)的參數中指定或在傳遞至 [**RegisterTask**](/windows/desktop/api/taskschd/nf-taskschd-itaskfolder-registertask)的 XML 中指定）時，會使用呼叫 **Connect** 方法的使用者認證來註冊該工作。</span><span class="sxs-lookup"><span data-stu-id="74487-118">When you register a task with the logon type equal to TASK\_LOGON\_INTERACTIVE\_TOKEN and the task does not have credentials specified in the [**Principal**](/windows/desktop/api/taskschd/nf-taskschd-itaskdefinition-get_principal) property of the task definition, specified in the parameters to [**RegisterTaskDefinition**](/windows/desktop/api/taskschd/nf-taskschd-itaskfolder-registertaskdefinition), or specified in the XML that is passed to [**RegisterTask**](/windows/desktop/api/taskschd/nf-taskschd-itaskfolder-registertask), then the task will be registered with the credentials of the user that called the **Connect** method.</span></span>

## <a name="user-account-control-uac-security-for-tasks"></a><span data-ttu-id="74487-119"> (UAC) 安全性的使用者帳戶控制</span><span class="sxs-lookup"><span data-stu-id="74487-119">User Account Control (UAC) Security for Tasks</span></span>

<span data-ttu-id="74487-120"> (UAC) 的[使用者帳戶控制](https://www.microsoft.com/technet/windowsvista/security/uac.mspx)可讓使用者執行一般功能，例如執行程式和儲存和修改資料，而不需要公開系統管理許可權。</span><span class="sxs-lookup"><span data-stu-id="74487-120">[User Account Control](https://www.microsoft.com/technet/windowsvista/security/uac.mspx) (UAC) lets users exercise general functionality such as running programs and saving and modifying data without exposing administrative privileges.</span></span> <span data-ttu-id="74487-121">依預設，當 UAC 開啟時，會以低層級許可權執行工作。</span><span class="sxs-lookup"><span data-stu-id="74487-121">By default, a task runs with low level privileges when UAC is turned on.</span></span> <span data-ttu-id="74487-122">工作可以藉由從 IPrincipal ([**Principal.) RUNLEVEL**](principal-runlevel.md)之 [**RUNLEVEL 屬性**](/windows/desktop/api/taskschd/nf-taskschd-iprincipal-get_runlevel)的工作 [**\_ RUNLEVEL \_**](/windows/win32/api/taskschd/ne-taskschd-task_runlevel_type)別列舉設定許可權等級，來指定要以較高的許可權或低許可權執行這些工作。</span><span class="sxs-lookup"><span data-stu-id="74487-122">Tasks can specify that they will run with elevated privileges or low privileges by setting a privilege level from the [**TASK\_RUNLEVEL\_TYPE**](/windows/win32/api/taskschd/ne-taskschd-task_runlevel_type) enumeration for the [**RunLevel property of IPrincipal**](/windows/desktop/api/taskschd/nf-taskschd-iprincipal-get_runlevel) ([**Principal.RunLevel**](principal-runlevel.md) for scripting).</span></span> <span data-ttu-id="74487-123">**RunLevel** 屬性的值會決定工作的動作將執行的許可權層級。</span><span class="sxs-lookup"><span data-stu-id="74487-123">The value of the **RunLevel** property determines the privilege level at which a task's actions will be run.</span></span> <span data-ttu-id="74487-124">如果工作的動作必須具有較高的許可權才能執行，則您必須將 **RunLevel** 屬性設定為 [ **task \_ RunLevel \_ 最高**]。</span><span class="sxs-lookup"><span data-stu-id="74487-124">If a task's actions must have elevated privileges to run, then you must set the **RunLevel** property to **TASK\_RUNLEVEL\_HIGHEST**.</span></span> <span data-ttu-id="74487-125">如果工作是使用工作安全性內容的 Administrators 群組來註冊的，則您也必須將 [ **RunLevel** ] 屬性設定為 [ **task \_ RunLevel \_** ] （如果您想要執行此工作）。</span><span class="sxs-lookup"><span data-stu-id="74487-125">If a task is registered using the Administrators group for the security context of the task, then you must also set the **RunLevel** property to **TASK\_RUNLEVEL\_HIGHEST** if you want to run the task.</span></span> <span data-ttu-id="74487-126">如果工作是使用內建 \\ 系統管理員帳戶或本機系統或本地服務帳戶來註冊的，則會忽略 **RunLevel** 屬性。</span><span class="sxs-lookup"><span data-stu-id="74487-126">If a task is registered using the Builtin\\Administrator account or the Local System or Local Service accounts, then the **RunLevel** property will be ignored.</span></span> <span data-ttu-id="74487-127">如果已關閉使用者帳戶控制 (UAC) ，也會忽略屬性值。</span><span class="sxs-lookup"><span data-stu-id="74487-127">The property value will also be ignored if User Account Control (UAC) is turned off.</span></span> <span data-ttu-id="74487-128">**RunLevel** 屬性的值不會影響執行或刪除工作所需的許可權。</span><span class="sxs-lookup"><span data-stu-id="74487-128">The value of the **RunLevel** property doesn't affect the permissions needed to run or delete a task.</span></span>

> [!Note]  
> <span data-ttu-id="74487-129">將作業系統從 Windows XP 升級至 Windows Vista 之後， \\ 在 WINDOWS xp 上使用內建系統管理員帳戶註冊的工作會將 [**RunLevel**](/windows/desktop/api/taskschd/nf-taskschd-iprincipal-get_runlevel) 屬性設定為 **TASK \_ RunLevel \_ LUA**。</span><span class="sxs-lookup"><span data-stu-id="74487-129">After upgrading an operating system from Windows XP to Windows Vista, tasks that were registered using the Builtin\\Administrator account on Windows XP will have the [**RunLevel**](/windows/desktop/api/taskschd/nf-taskschd-iprincipal-get_runlevel) property set to **TASK\_RUNLEVEL\_LUA**.</span></span> <span data-ttu-id="74487-130">這可能會導致某些工作失敗。</span><span class="sxs-lookup"><span data-stu-id="74487-130">This might cause some tasks to fail.</span></span> <span data-ttu-id="74487-131">您可以手動更新此屬性，以確保所有工作將會執行。</span><span class="sxs-lookup"><span data-stu-id="74487-131">You can update this property manually to ensure all the tasks will run.</span></span>

 

<span data-ttu-id="74487-132">在低許可權的程式中，您無法註冊 [**RunLevel**](/windows/desktop/api/taskschd/nf-taskschd-iprincipal-get_runlevel)屬性等於 **task \_ RunLevel \_ 最高** 的工作，但您可以使用等於 **task \_ RunLevel \_ LUA** 的 **RunLevel** 屬性來註冊工作。</span><span class="sxs-lookup"><span data-stu-id="74487-132">From a low privilege process, you cannot register a task with the [**RunLevel**](/windows/desktop/api/taskschd/nf-taskschd-iprincipal-get_runlevel) property equal to **TASK\_RUNLEVEL\_HIGHEST**, but you can register a task with the **RunLevel** property equal to **TASK\_RUNLEVEL\_LUA**.</span></span> <span data-ttu-id="74487-133">工作動作將以低許可權執行。</span><span class="sxs-lookup"><span data-stu-id="74487-133">The task actions will be run with low privileges.</span></span> <span data-ttu-id="74487-134">您不能將工作註冊為內建/系統管理員、本機系統或群組。</span><span class="sxs-lookup"><span data-stu-id="74487-134">You are not allowed to register the task as Builtin/Administrator, Local System, or for a group.</span></span>

<span data-ttu-id="74487-135">從提升許可權的程式中，您可以使用等於 **task \_ RunLevel \_ 最高** 或工作 **\_ RunLevel \_ LUA** 的 [**RunLevel**](/windows/desktop/api/taskschd/nf-taskschd-iprincipal-get_runlevel)屬性來註冊工作。</span><span class="sxs-lookup"><span data-stu-id="74487-135">From an elevated privilege process, you can register a task with the [**RunLevel**](/windows/desktop/api/taskschd/nf-taskschd-iprincipal-get_runlevel) property equal to **TASK\_RUNLEVEL\_HIGHEST** or **TASK\_RUNLEVEL\_LUA**.</span></span> <span data-ttu-id="74487-136">除非您使用的是系統管理員帳戶，否則工作會以 **RunLevel** 屬性所決定的許可權層級執行，而在此情況下，工作會以較高的許可權執行。</span><span class="sxs-lookup"><span data-stu-id="74487-136">The task will be run with a privilege level decided by the **RunLevel** property unless you are using the Administrator account, in which case the task is run with elevated privileges.</span></span>

<span data-ttu-id="74487-137">從提升許可權的程式中，您可以註冊工作排程器1.0 工作。</span><span class="sxs-lookup"><span data-stu-id="74487-137">From an elevated process, you can register a Task Scheduler 1.0 task.</span></span> <span data-ttu-id="74487-138">工作排程器服務會將工作的執行層級設定為 [工作 \_ RUNLEVEL] \_ 最高，且工作會以較高的許可權執行。</span><span class="sxs-lookup"><span data-stu-id="74487-138">The Task Scheduler service will set the run level of the task to TASK\_RUNLEVEL\_HIGHEST and the task will run with elevated privileges.</span></span>

<span data-ttu-id="74487-139">從低許可權的程式中，您也可以註冊工作排程器1.0 工作。</span><span class="sxs-lookup"><span data-stu-id="74487-139">From an low privilege process, you can also register a Task Scheduler 1.0 task.</span></span> <span data-ttu-id="74487-140">工作排程器服務會將工作的執行層級設定為 TASK \_ RUNLEVEL \_ LUA，而且工作會以低許可權執行。</span><span class="sxs-lookup"><span data-stu-id="74487-140">The Task Scheduler service will set the run level of the task to TASK\_RUNLEVEL\_LUA, and the task will run with low privileges.</span></span> <span data-ttu-id="74487-141">如果這項工作是從提高許可權的進程更新，工作的執行層級將維持 TASK \_ RUNLEVEL \_ LUA。</span><span class="sxs-lookup"><span data-stu-id="74487-141">If this task is updated from an elevated process, the run level of the task will remain TASK\_RUNLEVEL\_LUA.</span></span>

## <a name="security-for-registering-tasks"></a><span data-ttu-id="74487-142">註冊工作的安全性</span><span class="sxs-lookup"><span data-stu-id="74487-142">Security for Registering Tasks</span></span>

<span data-ttu-id="74487-143">當您從屬於系統管理員群組成員的帳戶註冊工作時，您只需要在下列情況下，于註冊工作時指定密碼：</span><span class="sxs-lookup"><span data-stu-id="74487-143">When you register a task from an account that is a member of the Administrators group, then you only need to specify a password while registering the task in the following situations:</span></span>

-   <span data-ttu-id="74487-144">如果您在帳戶的安全性內容或不同的使用者帳戶下註冊要執行的工作，並在 \_ \_ [**RegisterTask**](/windows/desktop/api/taskschd/nf-taskschd-itaskfolder-registertask) 或 [**RegisterTaskDefinition**](/windows/desktop/api/taskschd/nf-taskschd-itaskfolder-registertaskdefinition) 方法中使用 [工作登入密碼] 旗標。</span><span class="sxs-lookup"><span data-stu-id="74487-144">If you register the task to run under the security context of your account or a different user's account and you use the TASK\_LOGON\_PASSWORD flag in the [**RegisterTask**](/windows/desktop/api/taskschd/nf-taskschd-itaskfolder-registertask) or [**RegisterTaskDefinition**](/windows/desktop/api/taskschd/nf-taskschd-itaskfolder-registertaskdefinition) method.</span></span>
-   <span data-ttu-id="74487-145">如果您註冊要在不同使用者帳戶的安全性內容下執行的工作，並在 \_ \_ [**RegisterTask**](/windows/desktop/api/taskschd/nf-taskschd-itaskfolder-registertask) 或 [**RegisterTaskDefinition**](/windows/desktop/api/taskschd/nf-taskschd-itaskfolder-registertaskdefinition) 方法中使用工作登入 S4U 旗標。</span><span class="sxs-lookup"><span data-stu-id="74487-145">If you register the task to run under the security context of a different user's account and you use the TASK\_LOGON\_S4U flag in the [**RegisterTask**](/windows/desktop/api/taskschd/nf-taskschd-itaskfolder-registertask) or [**RegisterTaskDefinition**](/windows/desktop/api/taskschd/nf-taskschd-itaskfolder-registertaskdefinition) method.</span></span>

<span data-ttu-id="74487-146">當您使用工作 \_ 登入 \_ S4U 旗標或 \_ \_ [**RegisterTask**](/windows/desktop/api/taskschd/nf-taskschd-itaskfolder-registertask) 或 [**RegisterTaskDefinition**](/windows/desktop/api/taskschd/nf-taskschd-itaskfolder-registertaskdefinition) 方法中的工作登入密碼旗標注冊工作時，您無法使用使用者群組做為工作的安全性內容。</span><span class="sxs-lookup"><span data-stu-id="74487-146">You cannot use a user group as the security context of a task when you register the task using the TASK\_LOGON\_S4U flag or the TASK\_LOGON\_PASSWORD flag in the [**RegisterTask**](/windows/desktop/api/taskschd/nf-taskschd-itaskfolder-registertask) or [**RegisterTaskDefinition**](/windows/desktop/api/taskschd/nf-taskschd-itaskfolder-registertaskdefinition) method.</span></span>

<span data-ttu-id="74487-147">當您從不是系統管理員群組成員的使用者帳戶註冊工作時，如果您在帳戶的安全性內容下註冊要執行的工作，而且您使用 S4U 或互動式登入類型，則在註冊工作時，不需要指定密碼。</span><span class="sxs-lookup"><span data-stu-id="74487-147">When you register a task from a user account that is not a member of the Administrators group, then you do not need to specify a password when registering the task if you register the task to run under the security context of your account and you use the S4U or interactive logon type.</span></span> <span data-ttu-id="74487-148">否則，您必須在註冊工作時指定密碼。</span><span class="sxs-lookup"><span data-stu-id="74487-148">Otherwise, you need to specify a password when registering the task.</span></span> <span data-ttu-id="74487-149">此外，您無法使用本地服務帳戶或工作安全性內容的群組來註冊工作。</span><span class="sxs-lookup"><span data-stu-id="74487-149">Also, you cannot register the task using the Local Service account or by using a group for the task's security context.</span></span>

## <a name="security-for-reading-updating-deleting-and-running-tasks"></a><span data-ttu-id="74487-150">讀取、更新、刪除和執行工作的安全性</span><span class="sxs-lookup"><span data-stu-id="74487-150">Security for Reading, Updating, Deleting, and Running Tasks</span></span>

<span data-ttu-id="74487-151">依預設，建立工作的使用者可以讀取、更新、刪除和執行工作。</span><span class="sxs-lookup"><span data-stu-id="74487-151">By default, a user who creates a task can read, update, delete, and run the task.</span></span> <span data-ttu-id="74487-152">使用者必須具有工作檔案的「檔案寫入」許可權，才能更新工作、使用工作檔案的「讀取」許可權來讀取工作、將工作檔案的「刪除」許可權用於刪除工作，以及使用 IRegisteredTask：： Run 或 RunEx 方法來執行工作，以使用 [**：： run**](/windows/desktop/api/taskschd/nf-taskschd-iregisteredtask-run)或 [](/windows/desktop/api/taskschd/nf-taskschd-iregisteredtask-runex)方法來執行工作， ([**RegisteredTask. run**](registeredtask-run.md)和 [**RunEx**](registeredtask-runex.md)編寫腳本) 。</span><span class="sxs-lookup"><span data-stu-id="74487-152">A user must have file write permission on a task file to update a task, file read permission on a task file to read a task, delete permission on a task file to delete a task, and file execute permission on a task to run a task using the [**IRegisteredTask::Run**](/windows/desktop/api/taskschd/nf-taskschd-iregisteredtask-run) or [**RunEx**](/windows/desktop/api/taskschd/nf-taskschd-iregisteredtask-runex) methods ([**RegisteredTask.Run**](registeredtask-run.md) and [**RunEx**](registeredtask-runex.md) for scripting).</span></span> <span data-ttu-id="74487-153">Administrators 群組的成員或系統帳戶可以讀取、更新、刪除和執行任何工作。</span><span class="sxs-lookup"><span data-stu-id="74487-153">Members of the Administrators group or the SYSTEM account can read, update, delete, and run any tasks.</span></span> <span data-ttu-id="74487-154">Users 群組、LocalService 帳戶和 NetworkService 帳戶的成員，只能讀取、更新、刪除和執行他們所建立的工作。</span><span class="sxs-lookup"><span data-stu-id="74487-154">Members of the Users group, the LocalService account, and the NetworkService account can only read, update, delete, and run the tasks that they have created.</span></span> <span data-ttu-id="74487-155">當工作檔案的 DACL 變更時，此預設行為會變更，在此情況下，DACL 會定義哪些使用者具有檔案寫入、讀取、執行和刪除許可權。</span><span class="sxs-lookup"><span data-stu-id="74487-155">This default behavior is changed when the DACL of the task file is changed, in which case the DACL defines which users have file write, read, execute, and delete permission.</span></span> <span data-ttu-id="74487-156">若要設定工作檔的許可權，請使用 IRegisteredTask. SetSecurityDescriptor 方法 (RegisteredTask. SetSecurityDescriptor 來撰寫腳本) 或在使用 [**RegisterTask**](/windows/desktop/api/taskschd/nf-taskschd-itaskfolder-registertask) 或 [**RegisterTaskDefinition**](/windows/desktop/api/taskschd/nf-taskschd-itaskfolder-registertaskdefinition) 方法註冊工作時設定安全描述項。</span><span class="sxs-lookup"><span data-stu-id="74487-156">To set permissions for a task file, use the IRegisteredTask.SetSecurityDescriptor method (RegisteredTask.SetSecurityDescriptor for scripting) or set the security descriptor when you register the task using the [**RegisterTask**](/windows/desktop/api/taskschd/nf-taskschd-itaskfolder-registertask) or [**RegisterTaskDefinition**](/windows/desktop/api/taskschd/nf-taskschd-itaskfolder-registertaskdefinition) methods.</span></span>

<span data-ttu-id="74487-157">如果工作更新需要變更工作的 DACL，則除了讀取/寫入權限之外，使用者還必須具有 WriteDAC 許可權，才能更新工作。</span><span class="sxs-lookup"><span data-stu-id="74487-157">A user must have WriteDAC permission in addition to the read/write permissions to update a task if the task update requires a change to the DACL for the task.</span></span>

## <a name="related-topics"></a><span data-ttu-id="74487-158">相關主題</span><span class="sxs-lookup"><span data-stu-id="74487-158">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="74487-159">工作註冊資訊</span><span class="sxs-lookup"><span data-stu-id="74487-159">Task Registration Information</span></span>](task-registration-information.md)
</dt> <dt>

[<span data-ttu-id="74487-160">關於工作排程器</span><span class="sxs-lookup"><span data-stu-id="74487-160">About The Task Scheduler</span></span>](about-the-task-scheduler.md)
</dt> <dt>

[<span data-ttu-id="74487-161">工作安全性強化</span><span class="sxs-lookup"><span data-stu-id="74487-161">Task Security Hardening</span></span>](task-security-hardening.md)
</dt> <dt>

[<span data-ttu-id="74487-162">**TaskFolder. RegisterTaskDefinition**</span><span class="sxs-lookup"><span data-stu-id="74487-162">**TaskFolder.RegisterTaskDefinition**</span></span>](taskfolder-registertaskdefinition.md)
</dt> <dt>

[<span data-ttu-id="74487-163">**ITaskFolder：： RegisterTaskDefinition**</span><span class="sxs-lookup"><span data-stu-id="74487-163">**ITaskFolder::RegisterTaskDefinition**</span></span>](/windows/desktop/api/taskschd/nf-taskschd-itaskfolder-registertaskdefinition)
</dt> <dt>

[<span data-ttu-id="74487-164">**ITaskDefinition 的 Principal 屬性**</span><span class="sxs-lookup"><span data-stu-id="74487-164">**Principal Property of ITaskDefinition**</span></span>](/windows/desktop/api/taskschd/nf-taskschd-itaskdefinition-get_principal)
</dt> <dt>

[<span data-ttu-id="74487-165">**工作 \_ 登入 \_ 類型**</span><span class="sxs-lookup"><span data-stu-id="74487-165">**TASK\_LOGON\_TYPE**</span></span>](/windows/desktop/api/taskschd/ne-taskschd-task_logon_type)
</dt> </dl>

 

 




