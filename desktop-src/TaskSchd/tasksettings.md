---
title: TaskSettings 物件
description: 提供工作排程器服務用來執行工作之設定的腳本物件。
ms.assetid: f2ba952b-7864-467d-8709-eb6995dd5df5
keywords:
- TaskSettings 物件工作排程器
- TaskSettings 物件工作排程器，說明
topic_type:
- apiref
api_name:
- TaskSettings
api_location:
- taskschd.dll
api_type:
- COM
ms.topic: reference
ms.date: 05/31/2018
ms.openlocfilehash: 4e7690ba59b4794f952ca3b381fc28247f0dfb4e
ms.sourcegitcommit: a1494c819bc5200050696e66057f1020f5b142cb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 12/12/2020
ms.locfileid: "106968744"
---
# <a name="tasksettings-object"></a><span data-ttu-id="31f6b-105">TaskSettings 物件</span><span class="sxs-lookup"><span data-stu-id="31f6b-105">TaskSettings object</span></span>

<span data-ttu-id="31f6b-106">提供工作排程器服務用來執行工作之設定的腳本物件。</span><span class="sxs-lookup"><span data-stu-id="31f6b-106">A scripting object that provides the settings that the Task Scheduler service uses to perform the task.</span></span>

## <a name="members"></a><span data-ttu-id="31f6b-107">成員</span><span class="sxs-lookup"><span data-stu-id="31f6b-107">Members</span></span>

<span data-ttu-id="31f6b-108">**TaskSettings** 物件具有下列類型的成員：</span><span class="sxs-lookup"><span data-stu-id="31f6b-108">The **TaskSettings** object has these types of members:</span></span>

-   [<span data-ttu-id="31f6b-109">屬性</span><span class="sxs-lookup"><span data-stu-id="31f6b-109">Properties</span></span>](#properties)

### <a name="properties"></a><span data-ttu-id="31f6b-110">屬性</span><span class="sxs-lookup"><span data-stu-id="31f6b-110">Properties</span></span>

<span data-ttu-id="31f6b-111">**TaskSettings** 物件具有這些屬性。</span><span class="sxs-lookup"><span data-stu-id="31f6b-111">The **TaskSettings** object has these properties.</span></span>



| <span data-ttu-id="31f6b-112">屬性</span><span class="sxs-lookup"><span data-stu-id="31f6b-112">Property</span></span>                                                                                 | <span data-ttu-id="31f6b-113">存取類型</span><span class="sxs-lookup"><span data-stu-id="31f6b-113">Access type</span></span>           | <span data-ttu-id="31f6b-114">Description</span><span class="sxs-lookup"><span data-stu-id="31f6b-114">Description</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                  |
|:-----------------------------------------------------------------------------------------|:----------------------|:-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="31f6b-115">**AllowDemandStart**</span><span class="sxs-lookup"><span data-stu-id="31f6b-115">**AllowDemandStart**</span></span>](tasksettings-allowdemandstart.md)<br/>                     | <span data-ttu-id="31f6b-116">讀取/寫入</span><span class="sxs-lookup"><span data-stu-id="31f6b-116">Read/write</span></span><br/> | <span data-ttu-id="31f6b-117">取得或設定布林值，這個值表示可以使用 [執行] 命令或內容功能表來啟動工作。</span><span class="sxs-lookup"><span data-stu-id="31f6b-117">Gets or sets a Boolean value that indicates that the task can be started by using either the Run command or the Context menu.</span></span><br/>                                                                                                                                                                                                                                                                                     |
| [<span data-ttu-id="31f6b-118">**AllowHardTerminate**</span><span class="sxs-lookup"><span data-stu-id="31f6b-118">**AllowHardTerminate**</span></span>](tasksettings-allowhardterminate.md)<br/>                 | <span data-ttu-id="31f6b-119">讀取/寫入</span><span class="sxs-lookup"><span data-stu-id="31f6b-119">Read/write</span></span><br/> | <span data-ttu-id="31f6b-120">取得或設定布林值，這個值表示工作可能會使用 [**TerminateProcess**](/windows/desktop/api/processthreadsapi/nf-processthreadsapi-terminateprocess)來終止。</span><span class="sxs-lookup"><span data-stu-id="31f6b-120">Gets or sets a Boolean value that indicates that the task may be terminated by using [**TerminateProcess**](/windows/desktop/api/processthreadsapi/nf-processthreadsapi-terminateprocess).</span></span><br/>                                                                                                                                                                                                                                                                               |
| [<span data-ttu-id="31f6b-121">**相容性**</span><span class="sxs-lookup"><span data-stu-id="31f6b-121">**Compatibility**</span></span>](tasksettings-compatibility.md)<br/>                           | <span data-ttu-id="31f6b-122">讀取/寫入</span><span class="sxs-lookup"><span data-stu-id="31f6b-122">Read/write</span></span><br/> | <span data-ttu-id="31f6b-123">取得或設定整數值，這個值表示與工作相容的工作排程器版本。</span><span class="sxs-lookup"><span data-stu-id="31f6b-123">Gets or sets an integer value that indicates which version of Task Scheduler a task is compatible with.</span></span><br/>                                                                                                                                                                                                                                                                                                           |
| [<span data-ttu-id="31f6b-124">**DeleteExpiredTaskAfter**</span><span class="sxs-lookup"><span data-stu-id="31f6b-124">**DeleteExpiredTaskAfter**</span></span>](tasksettings-deleteexpiredtaskafter.md)<br/>         | <span data-ttu-id="31f6b-125">讀取/寫入</span><span class="sxs-lookup"><span data-stu-id="31f6b-125">Read/write</span></span><br/> | <span data-ttu-id="31f6b-126">取得或設定在工作到期之後，工作排程器將等待的時間量。</span><span class="sxs-lookup"><span data-stu-id="31f6b-126">Gets or sets the amount of time that the Task Scheduler will wait before deleting the task after it expires.</span></span><br/>                                                                                                                                                                                                                                                                                                      |
| [<span data-ttu-id="31f6b-127">**DisallowStartIfOnBatteries**</span><span class="sxs-lookup"><span data-stu-id="31f6b-127">**DisallowStartIfOnBatteries**</span></span>](tasksettings-disallowstartifonbatteries.md)<br/> | <span data-ttu-id="31f6b-128">讀取/寫入</span><span class="sxs-lookup"><span data-stu-id="31f6b-128">Read/write</span></span><br/> | <span data-ttu-id="31f6b-129">取得或設定布林值，指出當電腦以電池電源執行時，不會啟動工作。</span><span class="sxs-lookup"><span data-stu-id="31f6b-129">Gets or sets a Boolean value that indicates that the task will not be started if the computer is running on battery power.</span></span><br/>                                                                                                                                                                                                                                                                                        |
| [<span data-ttu-id="31f6b-130">**啟用**</span><span class="sxs-lookup"><span data-stu-id="31f6b-130">**Enabled**</span></span>](tasksettings-enabled.md)<br/>                                       | <span data-ttu-id="31f6b-131">讀取/寫入</span><span class="sxs-lookup"><span data-stu-id="31f6b-131">Read/write</span></span><br/> | <span data-ttu-id="31f6b-132">取得或設定布林值，指出是否已啟用工作。</span><span class="sxs-lookup"><span data-stu-id="31f6b-132">Gets or sets a Boolean value that indicates that the task is enabled.</span></span> <span data-ttu-id="31f6b-133">只有當這項設定為 True 時，才能執行此工作。</span><span class="sxs-lookup"><span data-stu-id="31f6b-133">The task can be performed only when this setting is True.</span></span><br/>                                                                                                                                                                                                                                                                                   |
| [<span data-ttu-id="31f6b-134">**ExecutionTimeLimit**</span><span class="sxs-lookup"><span data-stu-id="31f6b-134">**ExecutionTimeLimit**</span></span>](tasksettings-executiontimelimit.md)<br/>                 | <span data-ttu-id="31f6b-135">讀取/寫入</span><span class="sxs-lookup"><span data-stu-id="31f6b-135">Read/write</span></span><br/> | <span data-ttu-id="31f6b-136">取得或設定允許完成工作的時間量。</span><span class="sxs-lookup"><span data-stu-id="31f6b-136">Gets or sets the amount of time allowed to complete the task.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                     |
| [<span data-ttu-id="31f6b-137">**Hidden**</span><span class="sxs-lookup"><span data-stu-id="31f6b-137">**Hidden**</span></span>](tasksettings-hidden.md)<br/>                                         | <span data-ttu-id="31f6b-138">讀取/寫入</span><span class="sxs-lookup"><span data-stu-id="31f6b-138">Read/write</span></span><br/> | <span data-ttu-id="31f6b-139">取得或設定布林值，指出工作將不會顯示在 UI 中。</span><span class="sxs-lookup"><span data-stu-id="31f6b-139">Gets or sets a Boolean value that indicates that the task will not be visible in the UI.</span></span> <span data-ttu-id="31f6b-140">不過，系統管理員可以使用「主要交換器」來覆寫這項設定，讓所有工作都顯示在 UI 中。</span><span class="sxs-lookup"><span data-stu-id="31f6b-140">However, administrators can override this setting through the use of a "master switch" that makes all tasks visible in the UI.</span></span><br/>                                                                                                                                                                                           |
| [<span data-ttu-id="31f6b-141">**IdleSettings**</span><span class="sxs-lookup"><span data-stu-id="31f6b-141">**IdleSettings**</span></span>](tasksettings-idlesettings.md)<br/>                             | <span data-ttu-id="31f6b-142">讀取/寫入</span><span class="sxs-lookup"><span data-stu-id="31f6b-142">Read/write</span></span><br/> | <span data-ttu-id="31f6b-143">取得或設定資訊，指定當電腦處於閒置狀態時，工作排程器如何執行工作。</span><span class="sxs-lookup"><span data-stu-id="31f6b-143">Gets or sets the information that specifies how the Task Scheduler performs tasks when the computer is in an idle state.</span></span><br/>                                                                                                                                                                                                                                                                                          |
| [<span data-ttu-id="31f6b-144">**MultipleInstances**</span><span class="sxs-lookup"><span data-stu-id="31f6b-144">**MultipleInstances**</span></span>](tasksettings-multipleinstances.md)<br/>                   | <span data-ttu-id="31f6b-145">讀取/寫入</span><span class="sxs-lookup"><span data-stu-id="31f6b-145">Read/write</span></span><br/> | <span data-ttu-id="31f6b-146">取得或設定原則，此原則會定義工作排程器處理工作之多個實例的方式。</span><span class="sxs-lookup"><span data-stu-id="31f6b-146">Gets or sets the policy that defines how the Task Scheduler deals with multiple instances of the task.</span></span><br/>                                                                                                                                                                                                                                                                                                            |
| [<span data-ttu-id="31f6b-147">**NetworkSettings**</span><span class="sxs-lookup"><span data-stu-id="31f6b-147">**NetworkSettings**</span></span>](tasksettings-networksettings.md)<br/>                       | <span data-ttu-id="31f6b-148">讀取/寫入</span><span class="sxs-lookup"><span data-stu-id="31f6b-148">Read/write</span></span><br/> | <span data-ttu-id="31f6b-149">取得或設定包含網路設定檔識別碼和名稱的網路設定物件。</span><span class="sxs-lookup"><span data-stu-id="31f6b-149">Gets or sets the network settings object that contains a network profile identifier and name.</span></span> <span data-ttu-id="31f6b-150">如果 **TaskSettings** 的 [**RunOnlyIfNetworkAvailable**](tasksettings-runonlyifnetworkavailable.md)屬性為 **True** ，而且 [**NetworkSettings**](tasksettings-networksettings.md)屬性中指定了網路 propfile，則只有在指定的網路設定檔可用時，才會執行此工作。</span><span class="sxs-lookup"><span data-stu-id="31f6b-150">If the [**RunOnlyIfNetworkAvailable**](tasksettings-runonlyifnetworkavailable.md) property of **TaskSettings** is **True** and a network propfile is specified in the [**NetworkSettings**](tasksettings-networksettings.md) property, then the task will run only if the specified network profile is available.</span></span><br/> |
| [<span data-ttu-id="31f6b-151">**優先順序**</span><span class="sxs-lookup"><span data-stu-id="31f6b-151">**Priority**</span></span>](tasksettings-priority.md)<br/>                                     | <span data-ttu-id="31f6b-152">讀取/寫入</span><span class="sxs-lookup"><span data-stu-id="31f6b-152">Read/write</span></span><br/> | <span data-ttu-id="31f6b-153">取得或設定工作的優先權層級。</span><span class="sxs-lookup"><span data-stu-id="31f6b-153">Gets or sets the priority level of the task.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                      |
| [<span data-ttu-id="31f6b-154">**RestartCount**</span><span class="sxs-lookup"><span data-stu-id="31f6b-154">**RestartCount**</span></span>](tasksettings-restartcount.md)<br/>                             | <span data-ttu-id="31f6b-155">讀取/寫入</span><span class="sxs-lookup"><span data-stu-id="31f6b-155">Read/write</span></span><br/> | <span data-ttu-id="31f6b-156">取得或設定工作排程器將嘗試重新開機工作的次數。</span><span class="sxs-lookup"><span data-stu-id="31f6b-156">Gets or sets the number of times that the Task Scheduler will attempt to restart the task.</span></span><br/>                                                                                                                                                                                                                                                                                                                        |
| [<span data-ttu-id="31f6b-157">**RestartInterval**</span><span class="sxs-lookup"><span data-stu-id="31f6b-157">**RestartInterval**</span></span>](tasksettings-restartinterval.md)<br/>                       | <span data-ttu-id="31f6b-158">讀取/寫入</span><span class="sxs-lookup"><span data-stu-id="31f6b-158">Read/write</span></span><br/> | <span data-ttu-id="31f6b-159">取得或設定值，這個值會指定工作排程器嘗試重新開機工作的時間長度。</span><span class="sxs-lookup"><span data-stu-id="31f6b-159">Gets or sets a value that specifies how long the Task Scheduler will attempt to restart the task.</span></span><br/>                                                                                                                                                                                                                                                                                                                 |
| [<span data-ttu-id="31f6b-160">**RunOnlyIfIdle**</span><span class="sxs-lookup"><span data-stu-id="31f6b-160">**RunOnlyIfIdle**</span></span>](tasksettings-runonlyifidle.md)<br/>                           | <span data-ttu-id="31f6b-161">讀取/寫入</span><span class="sxs-lookup"><span data-stu-id="31f6b-161">Read/write</span></span><br/> | <span data-ttu-id="31f6b-162">取得或設定布林值，這個值表示工作排程器只有在電腦處於閒置狀態時，才會執行工作。</span><span class="sxs-lookup"><span data-stu-id="31f6b-162">Gets or sets a Boolean value that indicates that the Task Scheduler will run the task only if the computer is in an idle state.</span></span><br/>                                                                                                                                                                                                                                                                                   |
| [<span data-ttu-id="31f6b-163">**RunOnlyIfNetworkAvailable**</span><span class="sxs-lookup"><span data-stu-id="31f6b-163">**RunOnlyIfNetworkAvailable**</span></span>](tasksettings-runonlyifnetworkavailable.md)<br/>   | <span data-ttu-id="31f6b-164">讀取/寫入</span><span class="sxs-lookup"><span data-stu-id="31f6b-164">Read/write</span></span><br/> | <span data-ttu-id="31f6b-165">取得或設定布林值，這個值表示工作排程器只有在有可用的網路時才會執行工作。</span><span class="sxs-lookup"><span data-stu-id="31f6b-165">Gets or sets a Boolean value that indicates that the Task Scheduler will run the task only when a network is available.</span></span><br/>                                                                                                                                                                                                                                                                                           |
| [<span data-ttu-id="31f6b-166">**StartWhenAvailable**</span><span class="sxs-lookup"><span data-stu-id="31f6b-166">**StartWhenAvailable**</span></span>](tasksettings-startwhenavailable.md)<br/>                 | <span data-ttu-id="31f6b-167">讀取/寫入</span><span class="sxs-lookup"><span data-stu-id="31f6b-167">Read/write</span></span><br/> | <span data-ttu-id="31f6b-168">取得或設定布林值，指出工作排程器可以在經過排程的時間之後隨時啟動工作。</span><span class="sxs-lookup"><span data-stu-id="31f6b-168">Gets or sets a Boolean value that indicates that the Task Scheduler can start the task at any time after its scheduled time has passed.</span></span><br/>                                                                                                                                                                                                                                                                           |
| [<span data-ttu-id="31f6b-169">**StopIfGoingOnBatteries**</span><span class="sxs-lookup"><span data-stu-id="31f6b-169">**StopIfGoingOnBatteries**</span></span>](tasksettings-stopifgoingonbatteries.md)<br/>         | <span data-ttu-id="31f6b-170">讀取/寫入</span><span class="sxs-lookup"><span data-stu-id="31f6b-170">Read/write</span></span><br/> | <span data-ttu-id="31f6b-171">取得或設定布林值，這個值表示當電腦以電池電源執行時，工作將會停止。</span><span class="sxs-lookup"><span data-stu-id="31f6b-171">Gets or sets a Boolean value that indicates that the task will be stopped if the computer begins to run on battery power.</span></span><br/>                                                                                                                                                                                                                                                                                         |
| [<span data-ttu-id="31f6b-172">**WakeToRun**</span><span class="sxs-lookup"><span data-stu-id="31f6b-172">**WakeToRun**</span></span>](tasksettings-waketorun.md)<br/>                                   | <span data-ttu-id="31f6b-173">讀取/寫入</span><span class="sxs-lookup"><span data-stu-id="31f6b-173">Read/write</span></span><br/> | <span data-ttu-id="31f6b-174">取得或設定布林值，這個值表示工作排程器會在執行工作時喚醒電腦。</span><span class="sxs-lookup"><span data-stu-id="31f6b-174">Gets or sets a Boolean value that indicates that the Task Scheduler will wake the computer when it is time to run the task.</span></span><br/>                                                                                                                                                                                                                                                                                       |
| [<span data-ttu-id="31f6b-175">**XmlText**</span><span class="sxs-lookup"><span data-stu-id="31f6b-175">**XmlText**</span></span>](tasksettings-xmltext.md)<br/>                                       | <span data-ttu-id="31f6b-176">讀取/寫入</span><span class="sxs-lookup"><span data-stu-id="31f6b-176">Read/write</span></span><br/> | <span data-ttu-id="31f6b-177">取得或設定工作設定的 XML 格式化定義。</span><span class="sxs-lookup"><span data-stu-id="31f6b-177">Gets or sets an XML-formatted definition of the task settings.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                    |



 

## <a name="remarks"></a><span data-ttu-id="31f6b-178">備註</span><span class="sxs-lookup"><span data-stu-id="31f6b-178">Remarks</span></span>

<span data-ttu-id="31f6b-179">根據預設，工作會在開始執行時停止72小時。</span><span class="sxs-lookup"><span data-stu-id="31f6b-179">By default, a task will be stopped 72 hours after it starts to run.</span></span> <span data-ttu-id="31f6b-180">您可以藉由變更 [**ExecutionTimeLimit**](tasksettings-executiontimelimit.md) 設定來變更。</span><span class="sxs-lookup"><span data-stu-id="31f6b-180">You can change this by changing the [**ExecutionTimeLimit**](tasksettings-executiontimelimit.md) setting.</span></span>

<span data-ttu-id="31f6b-181">讀取或寫入工作的 XML 時，工作設定會定義在工作排程器架構的 [**settings**](taskschedulerschema-settings-tasktype-element.md) 元素中。</span><span class="sxs-lookup"><span data-stu-id="31f6b-181">When reading or writing XML for a task, the task settings are defined in the [**Settings**](taskschedulerschema-settings-tasktype-element.md) element of the Task Scheduler schema.</span></span>

## <a name="examples"></a><span data-ttu-id="31f6b-182">範例</span><span class="sxs-lookup"><span data-stu-id="31f6b-182">Examples</span></span>

<span data-ttu-id="31f6b-183">如需此腳本物件的詳細資訊和程式碼範例，請參閱 [時間觸發程式範例 (腳本) ](time-trigger-example--scripting-.md)。</span><span class="sxs-lookup"><span data-stu-id="31f6b-183">For more information and a code example for this scripting object, see [Time Trigger Example (Scripting)](time-trigger-example--scripting-.md).</span></span>

## <a name="requirements"></a><span data-ttu-id="31f6b-184">規格需求</span><span class="sxs-lookup"><span data-stu-id="31f6b-184">Requirements</span></span>



| <span data-ttu-id="31f6b-185">需求</span><span class="sxs-lookup"><span data-stu-id="31f6b-185">Requirement</span></span> | <span data-ttu-id="31f6b-186">值</span><span class="sxs-lookup"><span data-stu-id="31f6b-186">Value</span></span> |
|-------------------------------------|-----------------------------------------------------------------------------------------|
| <span data-ttu-id="31f6b-187">最低支援的用戶端</span><span class="sxs-lookup"><span data-stu-id="31f6b-187">Minimum supported client</span></span><br/> | <span data-ttu-id="31f6b-188">\[僅限 Windows Vista 桌面應用程式\]</span><span class="sxs-lookup"><span data-stu-id="31f6b-188">Windows Vista \[desktop apps only\]</span></span><br/>                                          |
| <span data-ttu-id="31f6b-189">最低支援的伺服器</span><span class="sxs-lookup"><span data-stu-id="31f6b-189">Minimum supported server</span></span><br/> | <span data-ttu-id="31f6b-190">僅限 Windows Server 2008 \[ desktop 應用程式\]</span><span class="sxs-lookup"><span data-stu-id="31f6b-190">Windows Server 2008 \[desktop apps only\]</span></span><br/>                                    |
| <span data-ttu-id="31f6b-191">類型程式庫</span><span class="sxs-lookup"><span data-stu-id="31f6b-191">Type library</span></span><br/>             | <dl> <span data-ttu-id="31f6b-192"><dt>Taskschd.msc .tlb</dt></span><span class="sxs-lookup"><span data-stu-id="31f6b-192"><dt>Taskschd.tlb</dt></span></span> </dl> |
| <span data-ttu-id="31f6b-193">DLL</span><span class="sxs-lookup"><span data-stu-id="31f6b-193">DLL</span></span><br/>                      | <dl> <span data-ttu-id="31f6b-194"><dt>Taskschd.dll</dt></span><span class="sxs-lookup"><span data-stu-id="31f6b-194"><dt>Taskschd.dll</dt></span></span> </dl> |



## <a name="see-also"></a><span data-ttu-id="31f6b-195">另請參閱</span><span class="sxs-lookup"><span data-stu-id="31f6b-195">See also</span></span>

<dl> <dt>

[<span data-ttu-id="31f6b-196">工作排程器</span><span class="sxs-lookup"><span data-stu-id="31f6b-196">Task Scheduler</span></span>](task-scheduler-start-page.md)
</dt> <dt>

[<span data-ttu-id="31f6b-197">**TaskDefinition**</span><span class="sxs-lookup"><span data-stu-id="31f6b-197">**TaskDefinition**</span></span>](taskdefinition.md)
</dt> <dt>

[<span data-ttu-id="31f6b-198">**NetworkSettings**</span><span class="sxs-lookup"><span data-stu-id="31f6b-198">**NetworkSettings**</span></span>](networksettings.md)
</dt> <dt>

[<span data-ttu-id="31f6b-199">**IdleSettings**</span><span class="sxs-lookup"><span data-stu-id="31f6b-199">**IdleSettings**</span></span>](idlesettings.md)
</dt> </dl>

 

