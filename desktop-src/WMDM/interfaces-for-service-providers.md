---
title: 服務提供者的介面
description: 服務提供者的介面
ms.assetid: bd61c5fa-047c-4d93-bae1-f3433696b95b
keywords:
- Windows Media 裝置管理員、服務提供者介面
- 裝置管理員，服務提供者介面
- 服務提供者，介面
- 程式設計參考，服務提供者介面
- Windows Media 裝置管理員的參考，服務提供者介面
- 服務提供者介面
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 019d31f05674f0d9e492f8a73748500bc1d9d514
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 09/16/2019
ms.locfileid: "103673804"
---
# <a name="interfaces-for-service-providers"></a><span data-ttu-id="210e9-109">服務提供者的介面</span><span class="sxs-lookup"><span data-stu-id="210e9-109">Interfaces for Service Providers</span></span>

<span data-ttu-id="210e9-110">本節說明 Windows Media 裝置管理員 service 提供者所執行的介面。</span><span class="sxs-lookup"><span data-stu-id="210e9-110">This section describes interfaces implemented by Windows Media Device Manager service providers.</span></span> <span data-ttu-id="210e9-111">服務提供者會執行大部分與裝置通訊的實際工作，因為它們會執行應用程式所呼叫的大部分 Windows Media 裝置管理員 SDK 方法。</span><span class="sxs-lookup"><span data-stu-id="210e9-111">Service providers perform most of the actual work of communicating with a device, because they implement most of the Windows Media Device Manager SDK methods called by the application.</span></span>

<span data-ttu-id="210e9-112">服務提供者不需要執行本節所列的所有介面。</span><span class="sxs-lookup"><span data-stu-id="210e9-112">Service providers do not need to implement all of the interfaces listed in this section.</span></span> <span data-ttu-id="210e9-113">例如，沒有機載存放裝置的媒體裝置不會執行用來控制或公開內容的介面。</span><span class="sxs-lookup"><span data-stu-id="210e9-113">For example, a media device that does not have on-board storage does not implement the interfaces that are used to control or expose content.</span></span> <span data-ttu-id="210e9-114">您是否需要在適當的參考頁面上指出方法或介面。</span><span class="sxs-lookup"><span data-stu-id="210e9-114">Whether a method or interface is required is indicated on the appropriate reference page.</span></span>



| <span data-ttu-id="210e9-115">介面或類別</span><span class="sxs-lookup"><span data-stu-id="210e9-115">Interface or class</span></span>                                     | <span data-ttu-id="210e9-116">描述</span><span class="sxs-lookup"><span data-stu-id="210e9-116">Description</span></span>                                                                                                                                                                                                                                                                                                       |
|--------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="210e9-117">CSecureChannelServer</span><span class="sxs-lookup"><span data-stu-id="210e9-117">CSecureChannelServer</span></span>](csecurechannelserver-class.md) | <span data-ttu-id="210e9-118">協助程式類別，可讓服務提供者或安全內容提供者驗證應用程式，並建立安全參數的 MAC 簽章。</span><span class="sxs-lookup"><span data-stu-id="210e9-118">A helper class that enables a service provider or secure content provider to authenticate an application and create MAC signatures for secure parameters.</span></span>                                                                                                                                                         |
| [<span data-ttu-id="210e9-119">**IMDServiceProvider**</span><span class="sxs-lookup"><span data-stu-id="210e9-119">**IMDServiceProvider**</span></span>](/windows/desktop/api/mswmdm/nn-mswmdm-imdserviceprovider)       | <span data-ttu-id="210e9-120">提供用戶端 (通常是 Windows Media 裝置管理員) 具有此服務提供者所支援裝置的裝置枚舉器。</span><span class="sxs-lookup"><span data-stu-id="210e9-120">Provides the client (usually Windows Media Device Manager) with a device enumerator for the devices that this service provider supports.</span></span>                                                                                                                                                                          |
| [<span data-ttu-id="210e9-121">**IMDServiceProvider2**</span><span class="sxs-lookup"><span data-stu-id="210e9-121">**IMDServiceProvider2**</span></span>](/windows/desktop/api/mswmdm/nn-mswmdm-imdserviceprovider2)     | <span data-ttu-id="210e9-122">藉由提供使用裝置路徑建立裝置的方法來擴充 **IMDServiceProvider** 。</span><span class="sxs-lookup"><span data-stu-id="210e9-122">Extends **IMDServiceProvider** by providing a method for creating the device by using the device path.</span></span>                                                                                                                                                                                                            |
| [<span data-ttu-id="210e9-123">**IMDServiceProvider3**</span><span class="sxs-lookup"><span data-stu-id="210e9-123">**IMDServiceProvider3**</span></span>](/windows/desktop/api/mswmdm/nn-mswmdm-imdserviceprovider3)     | <span data-ttu-id="210e9-124">藉由提供設定裝置列舉喜好設定的方法來擴充 **IMDServiceProvider2** 。</span><span class="sxs-lookup"><span data-stu-id="210e9-124">Extends **IMDServiceProvider2** by providing a method for setting the device enumeration preferences.</span></span>                                                                                                                                                                                                             |
| [<span data-ttu-id="210e9-125">**IMDSPDevice**</span><span class="sxs-lookup"><span data-stu-id="210e9-125">**IMDSPDevice**</span></span>](/windows/desktop/api/mswmdm/nn-mswmdm-imdspdevice)                     | <span data-ttu-id="210e9-126">提供與媒體裝置的實例型關聯。</span><span class="sxs-lookup"><span data-stu-id="210e9-126">Provides an instance-based association with a media device.</span></span> <span data-ttu-id="210e9-127">用戶端可以使用此介面來列舉裝置的儲存體媒體列舉值、取得裝置的相關資訊，以及將不透明的 (傳遞) 命令傳送至裝置。</span><span class="sxs-lookup"><span data-stu-id="210e9-127">Using this interface, the client can enumerate the storage media enumerators for the device, get information about the device, and send opaque (pass-through) commands to the device.</span></span>                                                                 |
| [<span data-ttu-id="210e9-128">**IMDSPDevice2**</span><span class="sxs-lookup"><span data-stu-id="210e9-128">**IMDSPDevice2**</span></span>](/windows/desktop/api/mswmdm/nn-mswmdm-imdspdevice2)                   | <span data-ttu-id="210e9-129">擴充 **IMDSPDevice** ，方法是提供取得延伸影片格式的方法、取得隨插即用 (PnP) 裝置名稱、使用屬性頁，以及讓您從其名稱取得儲存媒體的指標。</span><span class="sxs-lookup"><span data-stu-id="210e9-129">Extends **IMDSPDevice** by providing methods for getting extended video formats, getting Plug and Play (PnP) device names, enabling the use of property pages, and making it possible to get a pointer to a storage medium from its name.</span></span> <span data-ttu-id="210e9-130">此介面對服務提供者而言是選擇性的，但建議使用。</span><span class="sxs-lookup"><span data-stu-id="210e9-130">This interface is optional for the service provider but is recommended.</span></span> |
| [<span data-ttu-id="210e9-131">**IMDSPDevice3**</span><span class="sxs-lookup"><span data-stu-id="210e9-131">**IMDSPDevice3**</span></span>](/windows/desktop/api/mswmdm/nn-mswmdm-imdspdevice3)                   | <span data-ttu-id="210e9-132">藉由提供查詢物件格式之裝置屬性和功能的能力，來擴充 **IMDSPDevice2** 。</span><span class="sxs-lookup"><span data-stu-id="210e9-132">Extends **IMDSPDevice2** by providing ability to query properties and capabilities of the device with regard to an object format.</span></span>                                                                                                                                                                                 |
| [<span data-ttu-id="210e9-133">**IMDSPDeviceControl**</span><span class="sxs-lookup"><span data-stu-id="210e9-133">**IMDSPDeviceControl**</span></span>](/windows/desktop/api/mswmdm/nn-mswmdm-imdspdevicecontrol)       | <span data-ttu-id="210e9-134">提供控制裝置的方法。</span><span class="sxs-lookup"><span data-stu-id="210e9-134">Provides methods for controlling devices.</span></span>                                                                                                                                                                                                                                                                         |
| [<span data-ttu-id="210e9-135">**IMDSPDirectTransfer**</span><span class="sxs-lookup"><span data-stu-id="210e9-135">**IMDSPDirectTransfer**</span></span>](/windows/desktop/api/mswmdm/nn-mswmdm-imdspdirecttransfer)     | <span data-ttu-id="210e9-136">可讓 Windows Media 裝置管理員將內容傳輸委派給服務提供者。</span><span class="sxs-lookup"><span data-stu-id="210e9-136">Enables Windows Media Device Manager to delegate content transfer to the service provider.</span></span> <span data-ttu-id="210e9-137">在此情況下，Windows Media 裝置管理員不會在將內容傳送給服務提供者之前，對內容進行任何處理。</span><span class="sxs-lookup"><span data-stu-id="210e9-137">In this case Windows Media Device Manager does not do any processing of the content before sending it to the service provider.</span></span> <span data-ttu-id="210e9-138">服務提供者會取得來源的完全控制權。</span><span class="sxs-lookup"><span data-stu-id="210e9-138">The service provider gets full control of the source.</span></span>                                   |
| [<span data-ttu-id="210e9-139">**IMDSPEnumDevice**</span><span class="sxs-lookup"><span data-stu-id="210e9-139">**IMDSPEnumDevice**</span></span>](/windows/desktop/api/mswmdm/nn-mswmdm-imdspenumdevice)             | <span data-ttu-id="210e9-140">列舉此服務提供者所支援的媒體裝置。</span><span class="sxs-lookup"><span data-stu-id="210e9-140">Enumerates the media devices supported by this service provider.</span></span>                                                                                                                                                                                                                                                  |
| [<span data-ttu-id="210e9-141">**IMDSPEnumStorage**</span><span class="sxs-lookup"><span data-stu-id="210e9-141">**IMDSPEnumStorage**</span></span>](/windows/desktop/api/mswmdm/nn-mswmdm-imdspenumstorage)           | <span data-ttu-id="210e9-142">列舉裝置上的儲存體媒體和儲存媒體上的內容。</span><span class="sxs-lookup"><span data-stu-id="210e9-142">Enumerates the storage media on a device and the contents on a storage medium.</span></span>                                                                                                                                                                                                                                    |
| [<span data-ttu-id="210e9-143">**IMDSPObject**</span><span class="sxs-lookup"><span data-stu-id="210e9-143">**IMDSPObject**</span></span>](/windows/desktop/api/mswmdm/nn-mswmdm-imdspobject)                     | <span data-ttu-id="210e9-144">包含儲存物件上資料傳輸作業的方法。</span><span class="sxs-lookup"><span data-stu-id="210e9-144">Contains methods for data transfer operations on a storage object.</span></span>                                                                                                                                                                                                                                                |
| [<span data-ttu-id="210e9-145">**IMDSPObject2**</span><span class="sxs-lookup"><span data-stu-id="210e9-145">**IMDSPObject2**</span></span>](/windows/desktop/api/mswmdm/nn-mswmdm-imdspobject2)                   | <span data-ttu-id="210e9-146">藉由提供更有效率的 DRM 啟用資料傳輸，來擴充 **IMDSPObject** 。</span><span class="sxs-lookup"><span data-stu-id="210e9-146">Extends **IMDSPObject** by providing more efficient transmission of DRM-enabled data.</span></span>                                                                                                                                                                                                                             |
| [<span data-ttu-id="210e9-147">**IMDSPObjectInfo**</span><span class="sxs-lookup"><span data-stu-id="210e9-147">**IMDSPObjectInfo**</span></span>](/windows/desktop/api/mswmdm/nn-mswmdm-imdspobjectinfo)             | <span data-ttu-id="210e9-148">設定或取得存放裝置媒體上的播放長度、播放位置、播放位移或播放物件的總長度。</span><span class="sxs-lookup"><span data-stu-id="210e9-148">Sets or gets play length, play position, play offset, or total length of playable objects on a storage medium.</span></span>                                                                                                                                                                                                    |
| [<span data-ttu-id="210e9-149">**IMDSPRevoked**</span><span class="sxs-lookup"><span data-stu-id="210e9-149">**IMDSPRevoked**</span></span>](/windows/desktop/api/mswmdm/nn-mswmdm-imdsprevoked)                   | <span data-ttu-id="210e9-150">抓取可從中下載更新元件的 URL。</span><span class="sxs-lookup"><span data-stu-id="210e9-150">Retrieves the URL from which updated components can be downloaded.</span></span>                                                                                                                                                                                                                                                |
| [<span data-ttu-id="210e9-151">**IMDSPStorage**</span><span class="sxs-lookup"><span data-stu-id="210e9-151">**IMDSPStorage**</span></span>](/windows/desktop/api/mswmdm/nn-mswmdm-imdspstorage)                   | <span data-ttu-id="210e9-152">提供與裝置上儲存媒體的實例型關聯。</span><span class="sxs-lookup"><span data-stu-id="210e9-152">Provides an instanced-based association with a storage medium on a device.</span></span> <span data-ttu-id="210e9-153">此介面會建立儲存物件、抓取其相關資訊，並提供 **IMDSPEnumStorage** 介面的存取權，以列舉在目前儲存體中嵌套的子資料夾。</span><span class="sxs-lookup"><span data-stu-id="210e9-153">This interface creates storage objects, retrieves information about them, and provides access to the **IMDSPEnumStorage** interface for enumerating subfolders nested within the current storage.</span></span>                                      |
| [<span data-ttu-id="210e9-154">**IMDSPStorage2**</span><span class="sxs-lookup"><span data-stu-id="210e9-154">**IMDSPStorage2**</span></span>](/windows/desktop/api/mswmdm/nn-mswmdm-imdspstorage2)                 | <span data-ttu-id="210e9-155">藉由取得和設定擴充屬性來擴充 **IMDSPStorage** ，並讓您可以從名稱取得儲存體的指標。</span><span class="sxs-lookup"><span data-stu-id="210e9-155">Extends **IMDSPStorage** by getting and setting extended attributes and making it possible to get a pointer to storage from its name.</span></span>                                                                                                                                                                             |
| [<span data-ttu-id="210e9-156">**IMDSPStorage3**</span><span class="sxs-lookup"><span data-stu-id="210e9-156">**IMDSPStorage3**</span></span>](/windows/desktop/api/mswmdm/nn-mswmdm-imdspstorage3)                 | <span data-ttu-id="210e9-157">藉由支援中繼資料來擴充 **IMDSPStorage2** 。</span><span class="sxs-lookup"><span data-stu-id="210e9-157">Extends **IMDSPStorage2** by supporting metadata.</span></span>                                                                                                                                                                                                                                                                 |
| [<span data-ttu-id="210e9-158">**IMDSPStorage4**</span><span class="sxs-lookup"><span data-stu-id="210e9-158">**IMDSPStorage4**</span></span>](/windows/desktop/api/mswmdm/nn-mswmdm-imdspstorage4)                 | <span data-ttu-id="210e9-159">藉由支援播放清單物件來擴充 **IMDSPStorage3** 。</span><span class="sxs-lookup"><span data-stu-id="210e9-159">Extends **IMDSPStorage3** by supporting playlist objects.</span></span>                                                                                                                                                                                                                                                         |
| [<span data-ttu-id="210e9-160">**IMDSPStorageGlobals**</span><span class="sxs-lookup"><span data-stu-id="210e9-160">**IMDSPStorageGlobals**</span></span>](/windows/desktop/api/mswmdm/nn-mswmdm-imdspstorageglobals)     | <span data-ttu-id="210e9-161">抓取儲存媒體的全域資訊，例如可用空間量和檔案總數。</span><span class="sxs-lookup"><span data-stu-id="210e9-161">Retrieves global information about a storage medium, such as the amount of free space and the total number of files.</span></span>                                                                                                                                                                                              |



 

<span data-ttu-id="210e9-162">下圖顯示如何取得服務提供者所執行的各種介面。</span><span class="sxs-lookup"><span data-stu-id="210e9-162">The following diagram shows how to get the various interfaces implemented by a service provider.</span></span> <span data-ttu-id="210e9-163">在此圖中，衍生介面會顯示在壓縮度的相同標記中，因此 IMDServiceProvider/2/3 會代表三個介面： **IMDServiceProvider**、 **IMDServiceProvider2** 和 **IMDServiceProvider3**。</span><span class="sxs-lookup"><span data-stu-id="210e9-163">In this diagram, derived interfaces are displayed in the same tag for compactness, so IMDServiceProvider/2/3 would represent three interfaces: **IMDServiceProvider**, **IMDServiceProvider2**, and **IMDServiceProvider3**.</span></span> <span data-ttu-id="210e9-164">所顯示的方法只會由其中一個介面擴充。</span><span class="sxs-lookup"><span data-stu-id="210e9-164">Methods shown are extended by only one of these interfaces.</span></span> <span data-ttu-id="210e9-165">衍生介面的取得方式是在所建立物件的基底介面上呼叫 **QueryInterface** 。</span><span class="sxs-lookup"><span data-stu-id="210e9-165">Derived interfaces are obtained by calling **QueryInterface** on the base interface of the created object.</span></span>

![顯示 windows media 裝置管理員如何預期從服務提供者取得介面的圖表。](images/wmdm-sp-interfaces.gif)

## <a name="related-topics"></a><span data-ttu-id="210e9-167">相關主題</span><span class="sxs-lookup"><span data-stu-id="210e9-167">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="210e9-168">**程式設計參考**</span><span class="sxs-lookup"><span data-stu-id="210e9-168">**Programming Reference**</span></span>](programming-reference.md)
</dt> <dt>

[<span data-ttu-id="210e9-169">**Windows Media DRM-Implemented 介面**</span><span class="sxs-lookup"><span data-stu-id="210e9-169">**Windows Media DRM-Implemented Interfaces**</span></span>](windows-media-drm-implemented-interfaces.md)
</dt> </dl>

 

 




