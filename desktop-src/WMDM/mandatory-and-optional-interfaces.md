---
title: 必要和選用介面
description: 必要和選用介面
ms.assetid: 582c9dd5-f8ab-48df-afb3-fba931ee0dea
keywords:
- Windows媒體裝置管理員，介面
- 裝置管理員，介面
- 程式設計指南，介面
- 服務提供者，介面
- 建立服務提供者，介面
- interfaces
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 565f1a930b7dab5491101c16d529e4583bdc8e5588919b06a8118b69ab05d3e3
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/11/2021
ms.locfileid: "119766428"
---
# <a name="mandatory-and-optional-interfaces"></a>必要和選用介面

下表說明服務提供者要執行的必要和選用介面和方法。 必須執行具有一或多個強制方法的所有介面。 強制方法無法傳回 WMDM \_ E \_ NOTSUPPORTED 或 E \_ >notimpl。



| 介面和方法                                                                                                                  | 實選項                                                                                                                                                                                                                              |
|---------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [**IMDServiceProvider::EnumDevices**](/windows/desktop/api/mswmdm/nf-mswmdm-imdserviceprovider-enumdevices)                                                             | Mandatory。                                                                                                                                                                                                                                         |
| [**IMDServiceProvider::GetDeviceCount**](/windows/desktop/api/mswmdm/nf-mswmdm-imdserviceprovider-getdevicecount)                                                       | Mandatory。                                                                                                                                                                                                                                         |
| [**IMDServiceProvider2::CreateDevice**](/windows/desktop/api/mswmdm/nf-mswmdm-imdserviceprovider2-createdevice)                                                         | 選擇性。 此方法必須針對 PnP 和 Windows 檔案總管支援進行實作為。                                                                                                                                                                    |
| [**IMDSPDevice::EnumStorage**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspdevice-enumstorage)                                                                           | Mandatory。                                                                                                                                                                                                                                         |
| [**IMDSPDevice::GetDeviceIcon**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspdevice-getdeviceicon)                                                                       | Mandatory。                                                                                                                                                                                                                                         |
| [**IMDSPDevice::GetFormatSupport**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspdevice-getformatsupport)                                                                 | Mandatory。                                                                                                                                                                                                                                         |
| [**IMDSPDevice::GetManufacturer**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspdevice-getmanufacturer)                                                                   | Mandatory。                                                                                                                                                                                                                                         |
| [**IMDSPDevice：： GetName**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspdevice-getname)                                                                                   | Mandatory。                                                                                                                                                                                                                                         |
| [**IMDSPDevice::GetPowerSource**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspdevice-getpowersource)                                                                     | 選擇性。                                                                                                                                                                                                                                          |
| [**IMDSPDevice::GetSerialNumber**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspdevice-getserialnumber)                                                                   | 選擇性。 針對受保護的內容傳輸，Windows 媒體裝置管理員使用 **IMDSPStorageGlobals：： GetSerialNumber**。                                                                                                                              |
| [**IMDSPDevice：： GetStatus**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspdevice-getstatus)                                                                               | Mandatory。                                                                                                                                                                                                                                         |
| [**IMDSPDevice：： GetType**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspdevice-gettype)                                                                                   | Mandatory。                                                                                                                                                                                                                                         |
| [**IMDSPDevice：： GetVersion**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspdevice-getversion)                                                                             | 選擇性。                                                                                                                                                                                                                                          |
| [**IMDSPDevice::SendOpaqueCommand**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspdevice-sendopaquecommand)                                                               | 選擇性。                                                                                                                                                                                                                                          |
| [**IMDSPDevice2::GetCanonicalName**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspdevice2-getcanonicalname)                                                               | 選擇性。                                                                                                                                                                                                                                          |
| [**IMDSPDevice2::GetFormatSupport2**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspdevice2-getformatsupport2)                                                             | Mandatory。                                                                                                                                                                                                                                         |
| [**IMDSPDevice2::GetSpecifyPropertyPages**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspdevice2-getspecifypropertypages)                                                 | 選擇性。                                                                                                                                                                                                                                          |
| [**IMDSPDevice2::GetStorage**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspdevice2-getstorage)                                                                           | 選擇性。                                                                                                                                                                                                                                          |
| [**IMDSPDeviceControl 介面**](/windows/desktop/api/mswmdm/nn-mswmdm-imdspdevicecontrol)                                                                            | 選擇性。                                                                                                                                                                                                                                          |
| [**IMDSPEnumDevice：： Clone**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspenumdevice-clone)                                                                               | Mandatory。                                                                                                                                                                                                                                         |
| [**IMDSPEnumDevice：： Next**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspenumdevice-next)                                                                                 | Mandatory。                                                                                                                                                                                                                                         |
| [**IMDSPEnumDevice：： Reset**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspenumdevice-reset)                                                                               | Mandatory。                                                                                                                                                                                                                                         |
| [**IMDSPEnumDevice：： Skip**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspenumdevice-skip)                                                                                 | Mandatory。                                                                                                                                                                                                                                         |
| [**IMDSPEnumStorage：： Clone**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspenumstorage-clone)                                                                             | Mandatory。                                                                                                                                                                                                                                         |
| [**IMDSPEnumStorage：： Next**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspenumstorage-next)                                                                               | Mandatory。                                                                                                                                                                                                                                         |
| [**IMDSPEnumStorage：： Reset**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspenumstorage-reset)                                                                             | Mandatory。                                                                                                                                                                                                                                         |
| [**IMDSPEnumStorage：： Skip**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspenumstorage-skip)                                                                               | Mandatory。                                                                                                                                                                                                                                         |
| [**IMDSPObject：： Close**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspobject-close)                                                                                       | Mandatory。                                                                                                                                                                                                                                         |
| [**IMDSPObject：:D elete**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspobject-delete)                                                                                     | Mandatory。                                                                                                                                                                                                                                         |
| [**IMDSPObject：： Move**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspobject-move)                                                                                         | 選擇性。                                                                                                                                                                                                                                          |
| [**IMDSPObject：： Open**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspobject-open)                                                                                         | Mandatory。                                                                                                                                                                                                                                         |
| [**IMDSPObject：： Read**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspobject-read)                                                                                         | 如果需要 Windows Media Player 支援) ，則強制 (。                                                                                                                                                                                            |
| [**IMDSPObject：： Rename**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspobject-rename)                                                                                     | 選擇性。                                                                                                                                                                                                                                          |
| [**IMDSPObject：： Seek**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspobject-seek)                                                                                         | 選擇性。                                                                                                                                                                                                                                          |
| [**IMDSPObject：： Write**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspobject-write)                                                                                       | Mandatory。                                                                                                                                                                                                                                         |
| [**IMDSPObjectInfo 介面**](/windows/desktop/api/mswmdm/nn-mswmdm-imdspobjectinfo)                                                                                  | 選擇性。                                                                                                                                                                                                                                          |
| [**IMDSPRevoked 介面**](/windows/desktop/api/mswmdm/nn-mswmdm-imdsprevoked)                                                                                        | 選擇性。                                                                                                                                                                                                                                          |
| [**IMDSPStorage::CreateStorage**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspstorage-createstorage)                                                                     | 只有當 *dwAttributes* 是 WMDM 檔案 ATTR 檔案時，才是必要的 \_ \_ \_ 。                                                                                                                                                                                        |
| [**IMDSPStorage::EnumStorage**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspstorage-enumstorage)                                                                         | Mandatory。                                                                                                                                                                                                                                         |
| [**IMDSPStorage：： GetAttributes**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspstorage-getattributes)                                                                     | Mandatory。                                                                                                                                                                                                                                         |
| [**IMDSPStorage：： GetDate**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspstorage-getdate)                                                                                 | Mandatory。                                                                                                                                                                                                                                         |
| [**IMDSPStorage：： GetName**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspstorage-getname)                                                                                 | Mandatory。                                                                                                                                                                                                                                         |
| [**IMDSPStorage::GetRights**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspstorage-getrights)                                                                             | 選擇性。                                                                                                                                                                                                                                          |
| [**IMDSPStorage：： GetSize**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspstorage-getsize)                                                                                 | Mandatory。                                                                                                                                                                                                                                         |
| [**IMDSPStorage::GetStorageGlobals**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspstorage-getstorageglobals)                                                             | Mandatory。                                                                                                                                                                                                                                         |
| [**IMDSPStorage::SendOpaqueCommands**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspstorage-sendopaquecommand)                                                           | 選擇性。                                                                                                                                                                                                                                          |
| [**IMDSPStorage：： SetAttributes**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspstorage-setattributes)                                                                     | 選擇性。                                                                                                                                                                                                                                          |
| [**IMDSPStorage2::CreateStorage2**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspstorage2-createstorage2)                                                                 | Mandatory。                                                                                                                                                                                                                                         |
| [**IMDSPStorage2::GetAttributes2**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspstorage2-getattributes2)                                                                 | Mandatory。                                                                                                                                                                                                                                         |
| [**IMDSPStorage2::GetStorage**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspstorage2-getstorage)                                                                         | 選擇性。                                                                                                                                                                                                                                          |
| [**IMDSPStorage2::SetAttributes2**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspstorage2-setattributes2)                                                                 | 選擇性。                                                                                                                                                                                                                                          |
| [**IMDSPStorage3 介面**](/windows/desktop/api/mswmdm/nn-mswmdm-imdspstorage3)                                                                                      | 選擇性。 但是，如果裝置參數 *UseMetadataViews* 設定為1，則必須實作為此介面，而 **IMDSPStorage3：： GetMetadata** 則會變成強制性，雖然 **IMDSPStorage3：： >setmetadata** 仍然是選擇性的。                    |
| [**IMDSPStorageGlobals::GetCapabilities**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspstorageglobals-getcapabilities)                                                   | Mandatory。                                                                                                                                                                                                                                         |
| [**IMDSPStorageGlobals：： GetDevice**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspstorageglobals-getdevice)                                                               | Mandatory。                                                                                                                                                                                                                                         |
| [**IMDSPStorageGlobals::GetRootStorage**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspstorageglobals-getrootstorage)                                                     | Mandatory。                                                                                                                                                                                                                                         |
| [**IMDSPStorageGlobals::GetSerialNumber**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspstorageglobals-getserialnumber)                                                   | 僅限 PDDRM 的必要。 否則為選擇性。                                                                                                                                                                                                      |
| [**IMDSPStorageGlobals：： GetStatus**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspstorageglobals-getstatus)                                                               | Mandatory。                                                                                                                                                                                                                                         |
| [**IMDSPStorageGlobals::GetTotalBad**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspstorageglobals-gettotalbad)                                                           | Mandatory。                                                                                                                                                                                                                                         |
| [**IMDSPStorageGlobals::GetTotalFree**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspstorageglobals-gettotalfree)                                                         | Mandatory。                                                                                                                                                                                                                                         |
| [**IMDSPStorageGlobals::GetTotalSize**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspstorageglobals-gettotalsize)                                                         | Mandatory。                                                                                                                                                                                                                                         |
| [**IMDSPStorageGlobals：： Initialize**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspstorageglobals-initialize)                                                             | 選擇性。 如果裝置支援這種功能，則應該執行此方法。 如果未執行此方法，除了任何其他旗標以外， **IMDSPStorageGlobals：： GetCapabilites** 還必須傳回 WMDM \_ STORAGECAP \_ not \_ add。 |
| [**IMDSPDevice3**](/windows/desktop/api/mswmdm/nn-mswmdm-imdspdevice3)[**IMDSPObject2**](/windows/desktop/api/mswmdm/nn-mswmdm-imdspobject2)<br/> [**IMDSPStorage4**](/windows/desktop/api/mswmdm/nn-mswmdm-imdspstorage4)<br/> | 支援 Windows Media Player 的自動同步處理所需                                                                                                                                                                            |



 

## <a name="related-topics"></a>相關主題

<dl> <dt>

[**建立服務提供者**](creating-a-service-provider.md)
</dt> </dl>

 

 





