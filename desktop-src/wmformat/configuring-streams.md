---
title: 設定資料流程
description: 設定資料流程
ms.assetid: d119362f-e23c-4985-aff5-8c084106df30
keywords:
- Windows Media Format SDK，資料流程
- 設定檔，資料流程
- 資料流程，設定
- 編解碼器，設定資料流程
- 設定檔，IWMStreamConfig 介面
- 資料流程，IWMStreamConfig 介面
- IWMStreamConfig
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 6bc159fbd5390eb430e035db676685153d0cf174
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/20/2020
ms.locfileid: "104463152"
---
# <a name="configuring-streams"></a><span data-ttu-id="e6ca8-110">設定資料流程</span><span class="sxs-lookup"><span data-stu-id="e6ca8-110">Configuring Streams</span></span>

<span data-ttu-id="e6ca8-111">設定檔中唯一需要的就是至少一個資料流程。</span><span class="sxs-lookup"><span data-stu-id="e6ca8-111">The only thing that is required in a profile is at least one stream.</span></span> <span data-ttu-id="e6ca8-112">其他選項可讓您存取更先進的功能，但至少有一個資料流程可讓您建立一個 ASF 檔。</span><span class="sxs-lookup"><span data-stu-id="e6ca8-112">The other options provide access to more advanced features, but with the minimum of one stream you can make an ASF file.</span></span> <span data-ttu-id="e6ca8-113">您必須先瞭解如何設定串流，然後再建立複雜的設定檔。</span><span class="sxs-lookup"><span data-stu-id="e6ca8-113">It is essential that you understand how to configure streams before creating complex profiles.</span></span>

<span data-ttu-id="e6ca8-114">基於設定檔的目的，資料流程可以分為兩種類型：使用 Windows Media 編解碼器壓縮的類型，以及未使用任何編解碼器處理的任意資料流程。</span><span class="sxs-lookup"><span data-stu-id="e6ca8-114">For the purpose of profiles, streams can be divided into two types: those that are compressed with Windows Media codecs and arbitrary streams that are not processed with any codecs.</span></span> <span data-ttu-id="e6ca8-115">音訊串流和影片串流是使用 Windows 媒體編解碼器的類型。</span><span class="sxs-lookup"><span data-stu-id="e6ca8-115">Audio streams and video streams are the types that use the Windows Media codecs.</span></span> <span data-ttu-id="e6ca8-116">當然，串流可以包含使用協力廠商編解碼器壓縮的音訊或影片，但設定這類串流的程式是特殊案例。</span><span class="sxs-lookup"><span data-stu-id="e6ca8-116">Of course, streams can contain audio or video compressed with a third-party codec, but the process of configuring such a stream is a special case.</span></span> <span data-ttu-id="e6ca8-117">如需詳細資訊，請參閱 [使用協力廠商編解碼器建立 ASF](to-create-asf-files-using-third-party-codecs.md)檔案。</span><span class="sxs-lookup"><span data-stu-id="e6ca8-117">For more information, see [To Create ASF Files Using Third-Party Codecs](to-create-asf-files-using-third-party-codecs.md).</span></span>

<span data-ttu-id="e6ca8-118">下列清單摘要說明設定資料流程的流程。</span><span class="sxs-lookup"><span data-stu-id="e6ca8-118">The following list summarizes the process of configuring a stream.</span></span>

1.  <span data-ttu-id="e6ca8-119">取得資料流程的資料流程設定物件。</span><span class="sxs-lookup"><span data-stu-id="e6ca8-119">Obtain a stream configuration object for the stream.</span></span>
    -   <span data-ttu-id="e6ca8-120">如果您要使用其中一種 Windows Media 編解碼器來建立資料流程，您必須使用 [**IWMCodecInfo3**](/previous-versions/windows/desktop/api/wmsdkidl/nn-wmsdkidl-iwmcodecinfo3)方法，以編解碼器格式取得串流設定物件。</span><span class="sxs-lookup"><span data-stu-id="e6ca8-120">If you are creating a stream using one of the Windows Media codecs, you must obtain the stream configuration object as a codec format using the methods of [**IWMCodecInfo3**](/previous-versions/windows/desktop/api/wmsdkidl/nn-wmsdkidl-iwmcodecinfo3).</span></span>
    -   <span data-ttu-id="e6ca8-121">如果資料流程是任意類型，請使用 [**IWMProfile：： CreateNewStream**](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmprofile-createnewstream)取得空的資料流程設定物件。</span><span class="sxs-lookup"><span data-stu-id="e6ca8-121">If the stream is an arbitrary type, get an empty stream configuration object using [**IWMProfile::CreateNewStream**](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmprofile-createnewstream).</span></span>
2.  <span data-ttu-id="e6ca8-122">設定串流以符合您的需求。</span><span class="sxs-lookup"><span data-stu-id="e6ca8-122">Configure the stream to meet your needs.</span></span>
    -   <span data-ttu-id="e6ca8-123">所有類型的資料流程都應該指派名稱、連接名稱和資料流程號碼。</span><span class="sxs-lookup"><span data-stu-id="e6ca8-123">Streams of all types should be assigned a name, connection name, and stream number.</span></span>
    -   <span data-ttu-id="e6ca8-124">使用 Windows 媒體編解碼器的資料流程應該只以編解碼器格式的預先定義方式改變。</span><span class="sxs-lookup"><span data-stu-id="e6ca8-124">Streams using Windows Media codecs should be altered only in predefined ways from the codec format.</span></span> <span data-ttu-id="e6ca8-125">針對音訊串流，只應變更雙階段 VBR (VBR) 設定的變動位元速率。</span><span class="sxs-lookup"><span data-stu-id="e6ca8-125">For audio streams, only variable bit rate (VBR) settings for two-pass VBR should be changed.</span></span> <span data-ttu-id="e6ca8-126">影片串流需要使用所需的框架屬性進行設定。</span><span class="sxs-lookup"><span data-stu-id="e6ca8-126">Video streams need to be configured with the desired frame properties.</span></span>
    -   <span data-ttu-id="e6ca8-127">任意資料流程依類型有不同的設定需求。</span><span class="sxs-lookup"><span data-stu-id="e6ca8-127">Arbitrary streams have varying configuration requirements by type.</span></span> <span data-ttu-id="e6ca8-128">全部都需要位元速率和緩衝區視窗。</span><span class="sxs-lookup"><span data-stu-id="e6ca8-128">All require a bit rate and buffer window.</span></span>
3.  <span data-ttu-id="e6ca8-129">藉由呼叫 [**IWMProfile：： AddStream**](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmprofile-addstream)，將資料流程新增至設定檔。</span><span class="sxs-lookup"><span data-stu-id="e6ca8-129">Add the stream to the profile by calling [**IWMProfile::AddStream**](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmprofile-addstream).</span></span>

<span data-ttu-id="e6ca8-130">所有串流都是使用資料流程設定物件來定義。</span><span class="sxs-lookup"><span data-stu-id="e6ca8-130">All streams are defined using stream configuration objects.</span></span> <span data-ttu-id="e6ca8-131">資料流程設定物件的主要介面是 [**IWMStreamConfig**](/previous-versions/windows/desktop/api/wmsdkidl/nn-wmsdkidl-iwmstreamconfig)，它提供了設定資料流程基本設定的方法，例如串流號碼、位元速率等等。</span><span class="sxs-lookup"><span data-stu-id="e6ca8-131">The main interface for a stream configuration object is [**IWMStreamConfig**](/previous-versions/windows/desktop/api/wmsdkidl/nn-wmsdkidl-iwmstreamconfig), which provides methods for setting the basic settings of a stream, such as the stream number, bit rate, and so on.</span></span> <span data-ttu-id="e6ca8-132">**IWMStreamConfig** 是由較新的介面（ [**IWMStreamConfig2**](/previous-versions/windows/desktop/api/wmsdkidl/nn-wmsdkidl-iwmstreamconfig2) 和 [**IWMStreamConfig3**](/previous-versions/windows/desktop/api/wmsdkidl/nn-wmsdkidl-iwmstreamconfig3)）所繼承。</span><span class="sxs-lookup"><span data-stu-id="e6ca8-132">**IWMStreamConfig** is inherited by the newer interfaces, [**IWMStreamConfig2**](/previous-versions/windows/desktop/api/wmsdkidl/nn-wmsdkidl-iwmstreamconfig2) and [**IWMStreamConfig3**](/previous-versions/windows/desktop/api/wmsdkidl/nn-wmsdkidl-iwmstreamconfig3).</span></span> <span data-ttu-id="e6ca8-133">如同所有編號的介面修訂，您應該一律使用 **QueryInterface** 方法來取得最新版本。</span><span class="sxs-lookup"><span data-stu-id="e6ca8-133">As with all numbered interface revisions, you should always retrieve the most recent version using the **QueryInterface** method.</span></span>

<span data-ttu-id="e6ca8-134">資料流程中的大部分設定都是透過 [**IWMMediaProps**](/previous-versions/windows/desktop/api/wmsdkidl/nn-wmsdkidl-iwmmediaprops)來存取。</span><span class="sxs-lookup"><span data-stu-id="e6ca8-134">Most settings in a stream are accessed through [**IWMMediaProps**](/previous-versions/windows/desktop/api/wmsdkidl/nn-wmsdkidl-iwmmediaprops).</span></span> <span data-ttu-id="e6ca8-135">這些設定會封裝在 [**WM \_ 媒體 \_ 類型**](/previous-versions/windows/desktop/api/wmsdkidl/ns-wmsdkidl-wm_media_type) 結構中。</span><span class="sxs-lookup"><span data-stu-id="e6ca8-135">These settings are encapsulated in a [**WM\_MEDIA\_TYPE**](/previous-versions/windows/desktop/api/wmsdkidl/ns-wmsdkidl-wm_media_type) structure.</span></span> <span data-ttu-id="e6ca8-136">針對音訊和影片， **WM \_ 媒體 \_ 類型** 結構會指向另一個結構，其中包含媒體類型特定的進一步資訊。</span><span class="sxs-lookup"><span data-stu-id="e6ca8-136">For audio and video, the **WM\_MEDIA\_TYPE** structure points to another structure with further information specific to the type of media.</span></span> <span data-ttu-id="e6ca8-137">此次要結構通常是 [**WAVEFORMATEX**](/previous-versions/windows/desktop/legacy/dd757720(v=vs.85)) 音訊和 [**WMVIDEOINFOHEADER**](/previous-versions/windows/desktop/api/wmsdkidl/ns-wmsdkidl-wmvideoinfoheader) 的影片。</span><span class="sxs-lookup"><span data-stu-id="e6ca8-137">This secondary structure is typically [**WAVEFORMATEX**](/previous-versions/windows/desktop/legacy/dd757720(v=vs.85)) for audio and [**WMVIDEOINFOHEADER**](/previous-versions/windows/desktop/api/wmsdkidl/ns-wmsdkidl-wmvideoinfoheader) for video.</span></span> <span data-ttu-id="e6ca8-138">此外，影片串流有三個結構 **BITMAPINFOHEADER**，描述個別影片框架的特性。</span><span class="sxs-lookup"><span data-stu-id="e6ca8-138">In addition, video streams have a tertiary structure, **BITMAPINFOHEADER**, which describes the characteristics of an individual frame of video.</span></span> <span data-ttu-id="e6ca8-139">**BITMAPINFOHEADER** 是常見的結構，可以在 Platform SDK 的圖形裝置介面 (GDI) 區段中找到。</span><span class="sxs-lookup"><span data-stu-id="e6ca8-139">**BITMAPINFOHEADER** is a common structure and can be found in the Graphics Device Interface (GDI) section of the Platform SDK.</span></span>

<span data-ttu-id="e6ca8-140">下列各節說明如何設定資料流程。</span><span class="sxs-lookup"><span data-stu-id="e6ca8-140">The following sections describe how to configure streams.</span></span>



| <span data-ttu-id="e6ca8-141">區段</span><span class="sxs-lookup"><span data-stu-id="e6ca8-141">Section</span></span>                                                                                                          | <span data-ttu-id="e6ca8-142">描述</span><span class="sxs-lookup"><span data-stu-id="e6ca8-142">Description</span></span>                                                                                                                                                     |
|------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="e6ca8-143">所有資料流程通用的設定</span><span class="sxs-lookup"><span data-stu-id="e6ca8-143">Configuration Common to All Streams</span></span>](configuration-common-to-all-streams.md)                                   | <span data-ttu-id="e6ca8-144">描述所有資料流程類型通用的基本資料流程設定。</span><span class="sxs-lookup"><span data-stu-id="e6ca8-144">Describes the basic stream configuration common to all types of streams.</span></span>                                                                                        |
| [<span data-ttu-id="e6ca8-145">從編解碼器取得串流設定資訊</span><span class="sxs-lookup"><span data-stu-id="e6ca8-145">Getting Stream Configuration Information from Codecs</span></span>](getting-stream-configuration-information-from-codecs.md) | <span data-ttu-id="e6ca8-146">說明如何從編解碼器取得串流設定資訊，以確保使用 Windows Media 音訊和影片編解碼器正確設定串流。</span><span class="sxs-lookup"><span data-stu-id="e6ca8-146">Describes how to get stream configuration information from the codecs to ensure proper configuration of streams using the Windows Media Audio and Video codecs.</span></span> |
| [<span data-ttu-id="e6ca8-147">設定音訊串流</span><span class="sxs-lookup"><span data-stu-id="e6ca8-147">Configuring Audio Streams</span></span>](configuring-audio-streams.md)                                                       | <span data-ttu-id="e6ca8-148">說明如何設定音訊串流。</span><span class="sxs-lookup"><span data-stu-id="e6ca8-148">Describes how to configure audio streams.</span></span>                                                                                                                       |
| [<span data-ttu-id="e6ca8-149">設定影片串流</span><span class="sxs-lookup"><span data-stu-id="e6ca8-149">Configuring Video Streams</span></span>](configuring-video-streams.md)                                                       | <span data-ttu-id="e6ca8-150">說明如何設定影片串流。</span><span class="sxs-lookup"><span data-stu-id="e6ca8-150">Describes how to configure video streams.</span></span>                                                                                                                       |
| [<span data-ttu-id="e6ca8-151">設定影片串流以搜尋效能</span><span class="sxs-lookup"><span data-stu-id="e6ca8-151">Configuring Video Streams for Seeking Performance</span></span>](configuring-video-streams-for-seeking-performance.md)       | <span data-ttu-id="e6ca8-152">說明如何設定有效率的搜尋很重要的影片串流。</span><span class="sxs-lookup"><span data-stu-id="e6ca8-152">Describes how to configure video streams for which efficient seeking is important.</span></span>                                                                              |
| [<span data-ttu-id="e6ca8-153">設定畫面抓取資料流程</span><span class="sxs-lookup"><span data-stu-id="e6ca8-153">Configuring Screen Capture Streams</span></span>](configuring-screen-capture-streams.md)                                     | <span data-ttu-id="e6ca8-154">說明如何設定螢幕擷取畫面的影片串流。</span><span class="sxs-lookup"><span data-stu-id="e6ca8-154">Describes how to configure video streams for screen capture.</span></span>                                                                                                    |
| [<span data-ttu-id="e6ca8-155">設定影像串流</span><span class="sxs-lookup"><span data-stu-id="e6ca8-155">Configuring Image Streams</span></span>](configuring-image-streams.md)                                                       | <span data-ttu-id="e6ca8-156">說明如何設定影像串流。</span><span class="sxs-lookup"><span data-stu-id="e6ca8-156">Describes how to configure image streams.</span></span>                                                                                                                       |
| [<span data-ttu-id="e6ca8-157">使用未壓縮的音訊和影片串流</span><span class="sxs-lookup"><span data-stu-id="e6ca8-157">Using Uncompressed Audio and Video Streams</span></span>](using-uncompressed-audio-and-video-streams.md)                     | <span data-ttu-id="e6ca8-158">說明如何設定未壓縮的音訊或影片串流。</span><span class="sxs-lookup"><span data-stu-id="e6ca8-158">Describes how to set up an uncompressed audio or video stream.</span></span>                                                                                                  |
| [<span data-ttu-id="e6ca8-159">設定任意資料流程類型</span><span class="sxs-lookup"><span data-stu-id="e6ca8-159">Configuring Arbitrary Stream Types</span></span>](configuring-arbitrary-stream-types.md)                                     | <span data-ttu-id="e6ca8-160">描述如何將資料流程設定為使用預先定義的任意資料流程類型。</span><span class="sxs-lookup"><span data-stu-id="e6ca8-160">Describes how to configure streams to use the predefined arbitrary stream types.</span></span>                                                                                |
| [<span data-ttu-id="e6ca8-161">設定 VBR 資料流程</span><span class="sxs-lookup"><span data-stu-id="e6ca8-161">Configuring VBR Streams</span></span>](configuring-vbr-streams.md)                                                           | <span data-ttu-id="e6ca8-162">描述如何將資料流程設定為使用變數位元速率編碼 (VBR) 。</span><span class="sxs-lookup"><span data-stu-id="e6ca8-162">Describes how to configure streams to use variable bit rate encoding (VBR).</span></span>                                                                                     |
| [<span data-ttu-id="e6ca8-163">設定資料單位延伸模組</span><span class="sxs-lookup"><span data-stu-id="e6ca8-163">Configuring Data Unit Extensions</span></span>](configuring-data-unit-extensions.md)                                         | <span data-ttu-id="e6ca8-164">描述如何設定資料流程，以便在寫入檔案時附加資料單位延伸模組。</span><span class="sxs-lookup"><span data-stu-id="e6ca8-164">Describes how to configure a stream so that data unit extensions can be attached when the file is written.</span></span>                                                      |
| [<span data-ttu-id="e6ca8-165">重複使用串流設定</span><span class="sxs-lookup"><span data-stu-id="e6ca8-165">Reusing Stream Configurations</span></span>](reusing-stream-configurations.md)                                               | <span data-ttu-id="e6ca8-166">描述您可以使用現有設定檔中的串流設定物件來建立新設定檔的方式。</span><span class="sxs-lookup"><span data-stu-id="e6ca8-166">Describes the ways in which you can use stream configuration objects from existing profiles to make new profiles.</span></span>                                               |



 

## <a name="related-topics"></a><span data-ttu-id="e6ca8-167">相關主題</span><span class="sxs-lookup"><span data-stu-id="e6ca8-167">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="e6ca8-168">**輸入、串流和輸出**</span><span class="sxs-lookup"><span data-stu-id="e6ca8-168">**Inputs, Streams and Outputs**</span></span>](inputs-streams-and-outputs.md)
</dt> <dt>

[<span data-ttu-id="e6ca8-169">**使用設定檔**</span><span class="sxs-lookup"><span data-stu-id="e6ca8-169">**Working with Profiles**</span></span>](working-with-profiles.md)
</dt> </dl>

 

 