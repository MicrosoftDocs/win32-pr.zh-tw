---
title: Windows Media Format SDK 總覽
description: Windows Media Format SDK 總覽
ms.assetid: 9e5d6254-6261-4ca8-84d6-38050c93db22
keywords:
- Windows Media Format SDK、ASF 檔案建立和編輯
- Advanced Systems Format (ASF) 、檔案建立和編輯
- ASF (Advanced 系統格式) 、檔案建立和編輯
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: eb4f58be5d377e44fc0f68c89ad580a554902c58
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 09/16/2019
ms.locfileid: "104300248"
---
# <a name="overview-of-the-windows-media-format-sdk"></a><span data-ttu-id="09077-106">Windows Media Format SDK 總覽</span><span class="sxs-lookup"><span data-stu-id="09077-106">Overview of the Windows Media Format SDK</span></span>

<span data-ttu-id="09077-107">Windows Media Format SDK 包含物件，可在 ASF 檔案的存留期內的三個點執行工作：建立、編輯和播放。</span><span class="sxs-lookup"><span data-stu-id="09077-107">The Windows Media Format SDK contains objects to perform tasks at three points in the life of an ASF file: creation, editing, and playback.</span></span> <span data-ttu-id="09077-108">某些應用程式（尤其是影片編輯的應用程式）會使用 Windows Media Format SDK 的廣泛功能來讀取 ASF 檔案的內容、改變該內容，並將結果寫入至新檔案。</span><span class="sxs-lookup"><span data-stu-id="09077-108">Some applications, notably those for video editing, will use the broad functionality of the Windows Media Format SDK to read the contents of ASF files, alter that content, and write the results to a new file.</span></span> <span data-ttu-id="09077-109">不過，在建立、編輯和播放檔案的三個階段中，最簡單的方式是將此 SDK 視為最簡單的方法。</span><span class="sxs-lookup"><span data-stu-id="09077-109">However, it is easiest to think of this SDK in the three stages of file creation, editing, and playback.</span></span>

## <a name="asf-file-creation-with-the-windows-media-format-sdk"></a><span data-ttu-id="09077-110">使用 Windows Media Format SDK 建立 ASF 檔案</span><span class="sxs-lookup"><span data-stu-id="09077-110">ASF File Creation with the Windows Media Format SDK</span></span>

<span data-ttu-id="09077-111">以 Windows Media Format SDK 撰寫 ASF 檔案的程式，在高階的過程中相當簡單。</span><span class="sxs-lookup"><span data-stu-id="09077-111">The process of writing ASF files with the Windows Media Format SDK is, at a high level, fairly simple.</span></span> <span data-ttu-id="09077-112">檔案建立是由寫入器物件所管理。</span><span class="sxs-lookup"><span data-stu-id="09077-112">File creation is managed by a writer object.</span></span> <span data-ttu-id="09077-113">您可以藉由指定要使用的設定檔物件，告訴寫入器物件您想要建立哪一種類型的檔案。</span><span class="sxs-lookup"><span data-stu-id="09077-113">You tell the writer object what sort of file you want to create by specifying a profile object for it to use.</span></span> <span data-ttu-id="09077-114">每個設定檔物件都包含一個 ASF 檔案的設定。</span><span class="sxs-lookup"><span data-stu-id="09077-114">Each profile object contains the settings for an ASF file.</span></span> <span data-ttu-id="09077-115">部分設定檔包含在此 SDK 中，而設定檔編輯支援是由許多物件提供。</span><span class="sxs-lookup"><span data-stu-id="09077-115">Some profiles are included with this SDK, and profile editing support is provided by a number of objects.</span></span> <span data-ttu-id="09077-116">當您設定要使用之寫入器物件的設定檔時，您可以開始將範例傳遞給寫入器進行處理。</span><span class="sxs-lookup"><span data-stu-id="09077-116">When you have set a profile for the writer object to use, you can begin passing samples to the writer for processing.</span></span> <span data-ttu-id="09077-117">在大部分的情況下，範例是一段未壓縮的音訊或影片，但範例可以是任何類型的資料。</span><span class="sxs-lookup"><span data-stu-id="09077-117">In most cases, a sample is a piece of audio or video that is uncompressed, but a sample can be any type of data.</span></span>

<span data-ttu-id="09077-118">就內部而言，寫入器會執行三項主要工作。</span><span class="sxs-lookup"><span data-stu-id="09077-118">Internally, the writer performs three major tasks.</span></span> <span data-ttu-id="09077-119">首先，如果要壓縮範例所屬的資料流程，寫入器會與編解碼器 (壓縮程式) 的編碼部分進行通訊，以壓縮範例。</span><span class="sxs-lookup"><span data-stu-id="09077-119">First, if the stream that a sample belongs to is to be compressed, the writer communicates with the encoding portion of the codec (compressor/decompressor) to compress the sample.</span></span> <span data-ttu-id="09077-120">一旦範例的格式為設定檔所指定，寫入器就會將範例分成適當大小的封包，以透過網路進行串流處理。</span><span class="sxs-lookup"><span data-stu-id="09077-120">Once the samples are in the form specified by the profile, the writer breaks the samples apart into packets of appropriate size to be streamed over a network.</span></span> <span data-ttu-id="09077-121">最後，來自不同資料流程的資料會進行多工處理，或交錯，讓所有串流中具有類似呈現時間的樣本在 ASF 檔案的資料區段中接近另一個。</span><span class="sxs-lookup"><span data-stu-id="09077-121">Finally, the data from the various streams is multiplexed, or interleaved so that samples with similar presentation times across all streams are close to one another in the data section of the ASF file.</span></span>

<span data-ttu-id="09077-122">寫入器物件不會實際寫入檔案本身。</span><span class="sxs-lookup"><span data-stu-id="09077-122">The writer object does not actually write a file itself.</span></span> <span data-ttu-id="09077-123">它會與一個或多個稱為接收器的物件進行通訊，這會將資料從寫入器傳遞至其目的地。</span><span class="sxs-lookup"><span data-stu-id="09077-123">It communicates with one or more objects called sinks, which deliver the data from the writer to its destination.</span></span> <span data-ttu-id="09077-124">在本機檔案的案例中，檔案接收會管理將資料寫入檔案的程式。</span><span class="sxs-lookup"><span data-stu-id="09077-124">In the case of local files, a file sink manages writing the data to the file.</span></span> <span data-ttu-id="09077-125">您也可以設定網路接收器，以在網路上傳遞 ASF 資料。</span><span class="sxs-lookup"><span data-stu-id="09077-125">You can also configure network sinks to deliver the ASF data across a network.</span></span> <span data-ttu-id="09077-126">通常會使用一個以上的接收。</span><span class="sxs-lookup"><span data-stu-id="09077-126">Commonly, more than one sink is used.</span></span> <span data-ttu-id="09077-127">例如，應用程式可以跨網路串流檔案，並同時將複本儲存為本機磁片上的檔案。</span><span class="sxs-lookup"><span data-stu-id="09077-127">For example, an application can stream a file across a network and save a copy as a file on a local disk simultaneously.</span></span> <span data-ttu-id="09077-128">藉由使用推播接收，您可以將寫入應用程式中的內容廣播到一或多部執行 Windows Media Services 的伺服器，然後將內容發佈給使用者。</span><span class="sxs-lookup"><span data-stu-id="09077-128">By using a push sink, you can broadcast content from your writing application to one or more servers running Windows Media Services, which will then distribute the content to users.</span></span>

## <a name="asf-file-editing-with-the-windows-media-format-sdk-metadata-editing"></a><span data-ttu-id="09077-129">使用 Windows Media Format SDK 進行 ASF 檔案編輯 (中繼資料編輯) </span><span class="sxs-lookup"><span data-stu-id="09077-129">ASF File Editing with the Windows Media Format SDK (Metadata Editing)</span></span>

<span data-ttu-id="09077-130">編輯 ASF 檔案的 [資料] 區段內容包含重寫檔案。</span><span class="sxs-lookup"><span data-stu-id="09077-130">Editing the contents of the data section of an ASF file involves rewriting the file.</span></span> <span data-ttu-id="09077-131">Windows Media Format SDK 不提供任何會就地運算元據區段的物件。</span><span class="sxs-lookup"><span data-stu-id="09077-131">The Windows Media Format SDK does not provide any objects that manipulate the data section in place.</span></span> <span data-ttu-id="09077-132">針對簡單的編輯（例如串連兩個檔案，或從檔案中剪下內容），您可以在不解壓縮範例的情況下讀取範例，然後使用相同的標頭資訊將它們寫入至新檔案。</span><span class="sxs-lookup"><span data-stu-id="09077-132">For simple edits, such as concatenating two files, or cutting content from a file, you can read samples without decompressing them, and then write them to a new file using the same header information.</span></span> <span data-ttu-id="09077-133">更複雜的編輯牽涉到變更用於新檔案的設定檔。</span><span class="sxs-lookup"><span data-stu-id="09077-133">More complicated edits involve making changes to the profile used for the new file.</span></span>

<span data-ttu-id="09077-134">Windows Media Format SDK 支援編輯部分的標頭區段，而不需要重寫檔案。</span><span class="sxs-lookup"><span data-stu-id="09077-134">The Windows Media Format SDK does support editing parts of the header section without rewriting the file.</span></span> <span data-ttu-id="09077-135">ASF 檔案的標頭包含許多不同類型的資料。</span><span class="sxs-lookup"><span data-stu-id="09077-135">The header of an ASF file contains many different types of data.</span></span> <span data-ttu-id="09077-136">最常見的編輯是中繼資料屬性，其為名稱/值組，用來描述內容的各個層面，以及進行相關的人員。</span><span class="sxs-lookup"><span data-stu-id="09077-136">The most commonly edited are metadata attributes, which are name/value pairs that describe aspects of the content and the people involved in making it.</span></span> <span data-ttu-id="09077-137">您可以使用 Windows Media 格式 SDK 的中繼資料編輯器物件來編輯中繼資料。</span><span class="sxs-lookup"><span data-stu-id="09077-137">You can edit metadata using the metadata editor object of the Windows Media Format SDK.</span></span> <span data-ttu-id="09077-138">這個物件會開啟一個 ASF 檔案，讓您變更標頭的部分內容、將變更寫入檔案，然後關閉檔案。</span><span class="sxs-lookup"><span data-stu-id="09077-138">This object will open an ASF file, enable you to change some of the contents of the header, write the changes to the file, and close the file.</span></span> <span data-ttu-id="09077-139">中繼資料編輯非常簡單，只需要簡單的方法呼叫來取得和設定值。</span><span class="sxs-lookup"><span data-stu-id="09077-139">Metadata editing is very straightforward, with simple method calls to retrieve and set values.</span></span>

## <a name="asf-file-reading-with-the-windows-media-format-sdk"></a><span data-ttu-id="09077-140">使用 Windows Media Format SDK 讀取的 ASF 檔案</span><span class="sxs-lookup"><span data-stu-id="09077-140">ASF File Reading with the Windows Media Format SDK</span></span>

<span data-ttu-id="09077-141">Windows Media Format SDK 提供兩個不同的物件來讀取 ASF 檔案： reader 物件和同步讀取器物件。</span><span class="sxs-lookup"><span data-stu-id="09077-141">The Windows Media Format SDK provides two distinct objects for reading ASF files: the reader object and the synchronous reader object.</span></span> <span data-ttu-id="09077-142">讀取器物件可在所有版本的 SDK 中使用，而同步讀取器物件需要 Windows Media Format 9 系列 SDK 或更新版本。</span><span class="sxs-lookup"><span data-stu-id="09077-142">The reader object is available in all versions of the SDK, while the synchronous reader object requires the Windows Media Format 9 Series SDK or a later version.</span></span> <span data-ttu-id="09077-143">兩者之間的主要差異在於，讀取器物件會藉由將事件引發至回呼方法，將範例傳遞給您的應用程式，而同步讀取器會提供個別的範例來回應方法呼叫。</span><span class="sxs-lookup"><span data-stu-id="09077-143">The primary difference between the two is that the reader object delivers samples to your application by firing events to a callback method, while the synchronous reader provides individual samples in response to method calls.</span></span>

<span data-ttu-id="09077-144">若要使用 reader 物件，您必須執行數個回呼方法，以回應讀取器物件的狀態和範例訊息。</span><span class="sxs-lookup"><span data-stu-id="09077-144">To use the reader object, you must implement several callback methods to react to status and sample messages from the reader object.</span></span> <span data-ttu-id="09077-145">您可以設定讀取器來依您的需要傳遞內容、啟動讀取器，並等候範例訊息。</span><span class="sxs-lookup"><span data-stu-id="09077-145">You configure the reader to deliver the content as you like, start the reader, and wait for the sample messages.</span></span> <span data-ttu-id="09077-146">從 ASF 檔案抓取樣本的程式基本上是撰寫程式的反向處理。</span><span class="sxs-lookup"><span data-stu-id="09077-146">The process of retrieving samples from an ASF file is basically the reverse of the writing process.</span></span> <span data-ttu-id="09077-147">讀取器物件會與解碼任何壓縮資料流程所需的編解碼器進行通訊，並將未壓縮的資料傳遞至您的應用程式。</span><span class="sxs-lookup"><span data-stu-id="09077-147">The reader object communicates with the codecs required to decode any compressed streams and delivers uncompressed data to your application.</span></span> <span data-ttu-id="09077-148">您也可以將 reader 物件設定為以其壓縮狀態傳遞範例，讓您可以在新的檔案中包含先前編碼的資料流程。</span><span class="sxs-lookup"><span data-stu-id="09077-148">You can also configure the reader object to deliver samples in their compressed state, so that you can include a previously encoded stream in a new file.</span></span>

<span data-ttu-id="09077-149">同步讀取器物件的運作方式與讀取器物件的方式大致相同。</span><span class="sxs-lookup"><span data-stu-id="09077-149">The synchronous reader object works in much the same way as the reader object.</span></span> <span data-ttu-id="09077-150">但是，您必須個別向同步讀取器要求每個範例，而不是設定回呼。</span><span class="sxs-lookup"><span data-stu-id="09077-150">But instead of configuring callbacks, you must request each sample from the synchronous reader individually.</span></span> <span data-ttu-id="09077-151">使用同步讀取器只需要一個執行緒，而使用讀取器需要多個執行緒。</span><span class="sxs-lookup"><span data-stu-id="09077-151">Using the synchronous reader requires only a single thread, while using the reader requires multiple threads.</span></span> <span data-ttu-id="09077-152">在某些情況下，同步讀取器物件有幾個優點，大部分是針對需要快速存取檔案的不同部分，並在檔案之間複製資料的內容編輯應用程式。</span><span class="sxs-lookup"><span data-stu-id="09077-152">The synchronous reader object has several advantages over the reader object in certain circumstances, mostly for content editing applications that need to quickly access different parts of a file and copy data between files.</span></span> <span data-ttu-id="09077-153">同步讀取器物件更容易使用，並可讓您輕鬆地搜尋 data 區段中的特定位置。</span><span class="sxs-lookup"><span data-stu-id="09077-153">The synchronous reader object is much simpler to use, and makes seeking to specific places in the data section easy.</span></span> <span data-ttu-id="09077-154">但是，同步讀取器不支援透過網路讀取檔案，也不支援數位版權管理。</span><span class="sxs-lookup"><span data-stu-id="09077-154">However, the synchronous reader does not support reading files over a network and does not support digital rights management.</span></span>

## <a name="other-operations-with-the-windows-media-format-sdk"></a><span data-ttu-id="09077-155">Windows Media Format SDK 的其他作業</span><span class="sxs-lookup"><span data-stu-id="09077-155">Other Operations with the Windows Media Format SDK</span></span>

<span data-ttu-id="09077-156">除了上述三個主要功能區之外，Windows Media Format SDK 還具有可執行其他與 ASF 檔案相關之作業的物件。</span><span class="sxs-lookup"><span data-stu-id="09077-156">In addition to the three main functional areas just described, the Windows Media Format SDK has objects to perform other operations relating to ASF files.</span></span> <span data-ttu-id="09077-157">配置檔案管理員物件是用來建立和存取設定檔，並加以儲存。</span><span class="sxs-lookup"><span data-stu-id="09077-157">The profile manager object is used to create and access profiles and to save them.</span></span> <span data-ttu-id="09077-158">索引子物件會在 ASF 檔案中建立索引物件，以允許在影片檔案中搜尋。</span><span class="sxs-lookup"><span data-stu-id="09077-158">The indexer object creates index objects in ASF files that allow seeking in video files.</span></span> <span data-ttu-id="09077-159">最後，reader 物件和寫入器物件支援數位版權管理，以保護內容建立者的智慧權利。</span><span class="sxs-lookup"><span data-stu-id="09077-159">Finally, the reader object and writer object support digital rights management to protect the intellectual rights of content creators.</span></span>

<span data-ttu-id="09077-160">**注意** ASF 檔案結構和這個 SDK 的目的，通常是要產生包含音訊和影片的數位媒體檔案，而且這份檔是以這一段結束的方式撰寫的。</span><span class="sxs-lookup"><span data-stu-id="09077-160">**Note** The intention of the ASF file structure and this SDK in general is to produce digital media files containing audio and video, and this documentation is written with that end in mind.</span></span> <span data-ttu-id="09077-161">不過，ASF 檔案結構也適用于其他類型的內容。</span><span class="sxs-lookup"><span data-stu-id="09077-161">However, the ASF file structure will work for other types of content, too.</span></span> <span data-ttu-id="09077-162">您可能會發現許多與音訊和影片無關的 ASF 檔案應用程式。</span><span class="sxs-lookup"><span data-stu-id="09077-162">You may find many applications for ASF files that are not related to audio and video.</span></span>

## <a name="related-topics"></a><span data-ttu-id="09077-163">相關主題</span><span class="sxs-lookup"><span data-stu-id="09077-163">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="09077-164">**關於 Windows Media Format SDK**</span><span class="sxs-lookup"><span data-stu-id="09077-164">**About the Windows Media Format SDK**</span></span>](about-the-windows-media-format-sdk.md)
</dt> </dl>

 

 




