---
title: 'WM_GET_LICENSE_DATA 結構 (Drmexternals .h) '
description: WM \_ 取得 \_ 授權 \_ 資料結構包含取得 DRM 授權之位置的相關資訊。
ms.assetid: 7e8053d5-f3f5-4519-97f5-6dbd89982f3a
keywords:
- WM_GET_LICENSE_DATA 結構 windows 媒體格式
topic_type:
- apiref
api_name:
- WM_GET_LICENSE_DATA
api_location:
- Drmexternals.h
api_type:
- HeaderDef
ms.topic: reference
ms.date: 05/31/2018
ms.openlocfilehash: 4f238bea29ab7271896dc7516b6424e4cc298f5c
ms.sourcegitcommit: a1494c819bc5200050696e66057f1020f5b142cb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 12/12/2020
ms.locfileid: "104384645"
---
# <a name="wm_get_license_data-structure"></a><span data-ttu-id="7ea1d-104">WM \_ 取得 \_ 授權 \_ 資料結構</span><span class="sxs-lookup"><span data-stu-id="7ea1d-104">WM\_GET\_LICENSE\_DATA structure</span></span>

<span data-ttu-id="7ea1d-105">**WM \_ 取得 \_ 授權 \_ 資料** 結構包含取得 [*DRM*](wmformat-glossary.md) [*授權*](wmformat-glossary.md)之位置的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="7ea1d-105">The **WM\_GET\_LICENSE\_DATA** structure contains information about where to acquire a [*DRM*](wmformat-glossary.md) [*license*](wmformat-glossary.md).</span></span>

## <a name="syntax"></a><span data-ttu-id="7ea1d-106">語法</span><span class="sxs-lookup"><span data-stu-id="7ea1d-106">Syntax</span></span>


```C++
typedef struct _WMGetLicenseData {
  DWORD   dwSize;
  HRESULT hr;
  WCHAR   *wszURL;
  WCHAR   *wszLocalFilename;
  BYTE    *pbPostData;
  DWORD   dwPostDataSize;
} WM_GET_LICENSE_DATA;
```



## <a name="members"></a><span data-ttu-id="7ea1d-107">成員</span><span class="sxs-lookup"><span data-stu-id="7ea1d-107">Members</span></span>

<dl> <dt>

<span data-ttu-id="7ea1d-108">**dwSize**</span><span class="sxs-lookup"><span data-stu-id="7ea1d-108">**dwSize**</span></span>
</dt> <dd>

<span data-ttu-id="7ea1d-109">**DWORD** ，包含 **WM \_ 取得 \_ 授權 \_ 資料** 結構的大小（以位元組為單位）。</span><span class="sxs-lookup"><span data-stu-id="7ea1d-109">**DWORD** containing the size of the **WM\_GET\_LICENSE\_DATA** structure, in bytes.</span></span>

</dd> <dt>

<span data-ttu-id="7ea1d-110">**小時**</span><span class="sxs-lookup"><span data-stu-id="7ea1d-110">**hr**</span></span>
</dt> <dd>

<span data-ttu-id="7ea1d-111">**HRESULT** 傳回碼。</span><span class="sxs-lookup"><span data-stu-id="7ea1d-111">**HRESULT** return code.</span></span>

</dd> <dt>

<span data-ttu-id="7ea1d-112">**wszURL**</span><span class="sxs-lookup"><span data-stu-id="7ea1d-112">**wszURL**</span></span>
</dt> <dd>

<span data-ttu-id="7ea1d-113">寬字元以 null 終止的字串，其中包含授權取得 URL。</span><span class="sxs-lookup"><span data-stu-id="7ea1d-113">Wide-character null-terminated string containing the license acquisition URL.</span></span> <span data-ttu-id="7ea1d-114">在非無訊息授權取得中使用此字串和 **pbPostData** 字串。</span><span class="sxs-lookup"><span data-stu-id="7ea1d-114">Use this string and the **pbPostData** string in non-silent license acquisition.</span></span>

</dd> <dt>

<span data-ttu-id="7ea1d-115">**wszLocalFilename**</span><span class="sxs-lookup"><span data-stu-id="7ea1d-115">**wszLocalFilename**</span></span>
</dt> <dd>

<span data-ttu-id="7ea1d-116">寬字元以 null 終止的字串，其中包含由 DRM 元件產生的本機 HTML 網頁。</span><span class="sxs-lookup"><span data-stu-id="7ea1d-116">Wide-character null-terminated string containing a local HTML page that is generated by the DRM component.</span></span> <span data-ttu-id="7ea1d-117">當此字串載入至瀏覽器時，它會自動將 HTTP 要求重新導向至授權取得 URL，以及必要的 post 資料。</span><span class="sxs-lookup"><span data-stu-id="7ea1d-117">When this string is loaded into a browser, it automatically redirects the HTTP request to the license acquisition URL, along with the necessary post data.</span></span> <span data-ttu-id="7ea1d-118">此本機 URL 的使用現在已被取代。</span><span class="sxs-lookup"><span data-stu-id="7ea1d-118">Use of this local URL is now deprecated.</span></span> <span data-ttu-id="7ea1d-119">建議的方法是使用 **wszURL** 和 **pbPostData** 字串。</span><span class="sxs-lookup"><span data-stu-id="7ea1d-119">The recommended approach is to use the **wszURL** and **pbPostData** strings.</span></span>

</dd> <dt>

<span data-ttu-id="7ea1d-120">**pbPostData**</span><span class="sxs-lookup"><span data-stu-id="7ea1d-120">**pbPostData**</span></span>
</dt> <dd>

<span data-ttu-id="7ea1d-121">位元組陣列的指標，其中包含要張貼到授權取得 URL 的資料。</span><span class="sxs-lookup"><span data-stu-id="7ea1d-121">Pointer to a byte array containing the data to be posted to the license acquisition URL.</span></span> <span data-ttu-id="7ea1d-122">您必須將下列字串加入至 **pbPostData** 字串的開頭： "nonsilent = 1&挑戰 ="。</span><span class="sxs-lookup"><span data-stu-id="7ea1d-122">You must add the following string to the beginning of the **pbPostData** string: "nonsilent=1&challenge=".</span></span> <span data-ttu-id="7ea1d-123">當您形成 HTTP 要求時，結果字串應該附加至 **wszURL** 。</span><span class="sxs-lookup"><span data-stu-id="7ea1d-123">The resulting string should then be appended to **wszURL** when you form the HTTP request.</span></span>

</dd> <dt>

<span data-ttu-id="7ea1d-124">**dwPostDataSize**</span><span class="sxs-lookup"><span data-stu-id="7ea1d-124">**dwPostDataSize**</span></span>
</dt> <dd>

<span data-ttu-id="7ea1d-125">**DWORD** ，指出 **pbPostData** 中未包含 "nonsilent = 1&挑戰 =" 字串的 **pbPostData** 大小。</span><span class="sxs-lookup"><span data-stu-id="7ea1d-125">**DWORD** that indicates the size of **pbPostData** without the "nonsilent=1&challenge=" string referred to in **pbPostData**.</span></span>

</dd> </dl>

## <a name="remarks"></a><span data-ttu-id="7ea1d-126">備註</span><span class="sxs-lookup"><span data-stu-id="7ea1d-126">Remarks</span></span>

<span data-ttu-id="7ea1d-127">如果 **WMT \_ 狀態** 等於 **WMT \_ 沒有任何 \_ 許可權（ \_ 例如** 或 **WMT \_ 取得 \_ 授權**），則會在 [**IWMStatusCallback：： OnStatus**](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmstatuscallback-onstatus)方法的 *pValue* 參數中傳回這個填入的結構。</span><span class="sxs-lookup"><span data-stu-id="7ea1d-127">This filled-in structure is returned in the *pValue* parameter of the [**IWMStatusCallback::OnStatus**](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmstatuscallback-onstatus) method if **WMT\_STATUS** equals **WMT\_NO\_RIGHTS\_EX** or **WMT\_ACQUIRE\_LICENSE**.</span></span> <span data-ttu-id="7ea1d-128">針對 WMT \_ 沒有任何 \_ 許可權的 \_ EX 事件， **hr** 成員將會是 NS \_ e \_ license \_ REQUIRED、ns \_ e \_ license \_ 過期或 ns \_ e \_ 授權 \_ 不正確的 \_ 許可權。</span><span class="sxs-lookup"><span data-stu-id="7ea1d-128">For WMT\_NO\_RIGHTS\_EX events, the **hr** member will be NS\_E\_LICENSE\_REQUIRED, NS\_E\_LICENSE\_OUTOFDATE, or NS\_E\_LICENSE\_INCORRECT\_RIGHTS.</span></span> <span data-ttu-id="7ea1d-129">任何這些錯誤都表示必須藉由流覽至 **wszURL** 成員中的 URL 來取得新的授權。</span><span class="sxs-lookup"><span data-stu-id="7ea1d-129">Any of these errors indicates that a new license must be acquired by navigating to the URL in the **wszURL** member.</span></span>

<span data-ttu-id="7ea1d-130">針對 WMT \_ 取得 \_ 授權事件，如果成功取得授權， **hr** 成員將會傳遞成功的宏。</span><span class="sxs-lookup"><span data-stu-id="7ea1d-130">For WMT\_ACQUIRE\_LICENSE events, the **hr** member will pass the SUCCEEDED macro if a license was successfully acquired.</span></span> <span data-ttu-id="7ea1d-131">如果在嘗試無訊息取得之後收到此事件，且 **hr** 等於 NS \_ E \_ DRM \_ 授權 \_ NOTACQUIRED，則表示此授權的授權伺服器僅支援非無訊息的取得。</span><span class="sxs-lookup"><span data-stu-id="7ea1d-131">If this event is received after an attempt at silent acquisition, and **hr** equals NS\_E\_DRM\_LICENSE\_NOTACQUIRED, it indicates that only non-silent acquisition is supported by the license server for this license.</span></span>

<span data-ttu-id="7ea1d-132">>audioplayer 範例應用程式會示範如何正確地使用此結構中傳回的資訊。</span><span class="sxs-lookup"><span data-stu-id="7ea1d-132">The Audioplayer sample application demonstrates how to correctly use the information returned in this structure.</span></span>

## <a name="requirements"></a><span data-ttu-id="7ea1d-133">規格需求</span><span class="sxs-lookup"><span data-stu-id="7ea1d-133">Requirements</span></span>



| <span data-ttu-id="7ea1d-134">需求</span><span class="sxs-lookup"><span data-stu-id="7ea1d-134">Requirement</span></span> | <span data-ttu-id="7ea1d-135">值</span><span class="sxs-lookup"><span data-stu-id="7ea1d-135">Value</span></span> |
|-------------------------------------|-------------------------------------------------------------------------------------------|
| <span data-ttu-id="7ea1d-136">最低支援的用戶端</span><span class="sxs-lookup"><span data-stu-id="7ea1d-136">Minimum supported client</span></span><br/> | <span data-ttu-id="7ea1d-137">Windows 2000 Professional \[僅限傳統型應用程式\]</span><span class="sxs-lookup"><span data-stu-id="7ea1d-137">Windows 2000 Professional \[desktop apps only\]</span></span><br/>                                |
| <span data-ttu-id="7ea1d-138">最低支援的伺服器</span><span class="sxs-lookup"><span data-stu-id="7ea1d-138">Minimum supported server</span></span><br/> | <span data-ttu-id="7ea1d-139">Windows 2000 Server \[僅限傳統型應用程式\]</span><span class="sxs-lookup"><span data-stu-id="7ea1d-139">Windows 2000 Server \[desktop apps only\]</span></span><br/>                                      |
| <span data-ttu-id="7ea1d-140">版本</span><span class="sxs-lookup"><span data-stu-id="7ea1d-140">Version</span></span><br/>                  | <span data-ttu-id="7ea1d-141">Windows Media Format 7 SDK 或更新版本的 SDK</span><span class="sxs-lookup"><span data-stu-id="7ea1d-141">Windows Media Format 7 SDK, or later versions of the SDK</span></span><br/>                       |
| <span data-ttu-id="7ea1d-142">標頭</span><span class="sxs-lookup"><span data-stu-id="7ea1d-142">Header</span></span><br/>                   | <dl> <span data-ttu-id="7ea1d-143"><dt>Drmexternals。h</dt></span><span class="sxs-lookup"><span data-stu-id="7ea1d-143"><dt>Drmexternals.h</dt></span></span> </dl> |



## <a name="see-also"></a><span data-ttu-id="7ea1d-144">另請參閱</span><span class="sxs-lookup"><span data-stu-id="7ea1d-144">See also</span></span>

<dl> <dt>

[<span data-ttu-id="7ea1d-145">**IWMDRMReader：： AcquireLicense**</span><span class="sxs-lookup"><span data-stu-id="7ea1d-145">**IWMDRMReader::AcquireLicense**</span></span>](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmdrmreader-acquirelicense)
</dt> <dt>

[<span data-ttu-id="7ea1d-146">**結構**</span><span class="sxs-lookup"><span data-stu-id="7ea1d-146">**Structures**</span></span>](structures.md)
</dt> </dl>

 

 





