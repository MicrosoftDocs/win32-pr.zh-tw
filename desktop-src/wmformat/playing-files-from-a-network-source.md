---
title: 從網路來源播放檔案
description: 從網路來源播放檔案
ms.assetid: 72f2d685-56fc-4da2-8372-3774cc65f59d
keywords:
- Windows Media Format SDK，讀取 ASF 資料
- Windows Media Format SDK，從網路來源播放檔案
- Advanced Systems Format (ASF) ，讀取資料
- ASF (Advanced Systems Format) ，讀取資料
- Advanced Systems Format (ASF) ，從網路來源播放檔案
- ASF (Advanced Systems Format) ，播放來自網路來源的檔案
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 8f1e4e41ddf94498ddeddf90e64439c1b11b7ba8
ms.sourcegitcommit: ad672d3a10192c5ccac619ad2524407109266e93
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 05/25/2020
ms.locfileid: "106995149"
---
# <a name="playing-files-from-a-network-source"></a><span data-ttu-id="eb276-109">從網路來源播放檔案</span><span class="sxs-lookup"><span data-stu-id="eb276-109">Playing Files from a Network Source</span></span>

<span data-ttu-id="eb276-110">從網路讀取的本質與讀取本機檔案並不一樣。</span><span class="sxs-lookup"><span data-stu-id="eb276-110">Reading from a network is not fundamentally different from reading a local file.</span></span> <span data-ttu-id="eb276-111">應用程式會將 URL 傳遞給 reader 物件的 [**IWMReader：： Open**](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmreader-open) 方法，而 reader 物件會處理網路通訊協定的詳細資料。</span><span class="sxs-lookup"><span data-stu-id="eb276-111">The application passes the URL to the reader object's [**IWMReader::Open**](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmreader-open) method, and the reader object handles the details of the network protocols.</span></span> <span data-ttu-id="eb276-112">讀取器物件使用智慧型緩衝區管理來提供最順暢的播放。</span><span class="sxs-lookup"><span data-stu-id="eb276-112">The reader object uses intelligent buffer management to provide the smoothest playback possible.</span></span> <span data-ttu-id="eb276-113">如果應用程式需要對讀取器物件的網路設定有更多控制權，可以透過 [**IWMReaderNetworkConfig**](/previous-versions/windows/desktop/api/wmsdkidl/nn-wmsdkidl-iwmreadernetworkconfig) 和 [**IWMReaderNetworkConfig2**](/previous-versions/windows/desktop/api/wmsdkidl/nn-wmsdkidl-iwmreadernetworkconfig2) 介面取得這些設定。</span><span class="sxs-lookup"><span data-stu-id="eb276-113">If the application needs more control over the reader object's network settings, these are available through the [**IWMReaderNetworkConfig**](/previous-versions/windows/desktop/api/wmsdkidl/nn-wmsdkidl-iwmreadernetworkconfig) and [**IWMReaderNetworkConfig2**](/previous-versions/windows/desktop/api/wmsdkidl/nn-wmsdkidl-iwmreadernetworkconfig2) interfaces.</span></span>

<span data-ttu-id="eb276-114">來自網路來源的內容屬於下列兩個類別的其中一種：</span><span class="sxs-lookup"><span data-stu-id="eb276-114">Content from a network source falls into one of the following two categories:</span></span>

-   <span data-ttu-id="eb276-115">流。</span><span class="sxs-lookup"><span data-stu-id="eb276-115">Streaming.</span></span> <span data-ttu-id="eb276-116">資料會及時傳輸，以便在本機電腦上播放。</span><span class="sxs-lookup"><span data-stu-id="eb276-116">The data is transmitted just in time to be played on the local machine.</span></span> <span data-ttu-id="eb276-117">執行 Windows Media Services 的伺服器可以提供串流資料。</span><span class="sxs-lookup"><span data-stu-id="eb276-117">Servers running Windows Media Services can provide streaming data.</span></span> <span data-ttu-id="eb276-118">如果有多個位元速率 (MBR) 內容已串流處理，用戶端可以在串流處理時，從伺服器要求不同的位元速率。</span><span class="sxs-lookup"><span data-stu-id="eb276-118">If multiple bit rate (MBR) content is streamed, the client can request a different bit rate from the server as streaming progresses.</span></span>
-   <span data-ttu-id="eb276-119">下載。</span><span class="sxs-lookup"><span data-stu-id="eb276-119">Downloaded.</span></span> <span data-ttu-id="eb276-120">所有資料都會儘快傳輸，以便在本機電腦上儲存為檔案。</span><span class="sxs-lookup"><span data-stu-id="eb276-120">All the data is transmitted as quickly as possible so that it can be saved as a file on the local machine.</span></span> <span data-ttu-id="eb276-121">Web 服務器提供下載的資料。</span><span class="sxs-lookup"><span data-stu-id="eb276-121">Web servers provide downloaded data.</span></span> <span data-ttu-id="eb276-122">下載開始之後，就不會從用戶端到伺服器之間進行通訊。</span><span class="sxs-lookup"><span data-stu-id="eb276-122">There is no communication from the client to the server after the download begins.</span></span>

<span data-ttu-id="eb276-123">當讀取器物件從 Web 服務器下載檔案時，它會使用稱為漸進式串流處理的技巧，讓播放程式在下載完成之前開始轉譯內容。</span><span class="sxs-lookup"><span data-stu-id="eb276-123">When the reader object downloads a file from a Web server, it uses a technique called progressive streaming, which allows a player to begin rendering the content before downloading is complete.</span></span> <span data-ttu-id="eb276-124">資料會經過緩衝處理，以提供不中斷的資料流程給玩家。</span><span class="sxs-lookup"><span data-stu-id="eb276-124">Data is buffered to provide an uninterrupted flow of data to the player.</span></span> <span data-ttu-id="eb276-125">內容的傳輸速率和持續時間等資訊，會用來決定資料緩衝之前的時間，然後再提供給播放程式。</span><span class="sxs-lookup"><span data-stu-id="eb276-125">Information such as the transfer rate and duration of the content is used to determine how long to buffer the data before giving it to the player.</span></span>

<span data-ttu-id="eb276-126">若要透過網路開啟檔案或資料流程，請使用適當的 URL 呼叫 reader 物件的 **IWMReader：： open** 方法。</span><span class="sxs-lookup"><span data-stu-id="eb276-126">To open a file or stream over a network, call the reader object's **IWMReader::Open** method with the appropriate URL.</span></span> <span data-ttu-id="eb276-127">**Open** 是非同步呼叫，因此它會立即返回。</span><span class="sxs-lookup"><span data-stu-id="eb276-127">**Open** is an asynchronous call, so it returns immediately.</span></span> <span data-ttu-id="eb276-128">當來源準備好進行讀取時，讀取器物件會將 WMT \_ 開啟的通知傳送至應用程式的 [**IWMStatusCallback：： OnStatus**](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmstatuscallback-onstatus) 回呼方法。</span><span class="sxs-lookup"><span data-stu-id="eb276-128">When the source is ready for reading, the reader object sends a WMT\_OPENED notification to the application's [**IWMStatusCallback::OnStatus**](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmstatuscallback-onstatus) callback method.</span></span> <span data-ttu-id="eb276-129">此時，應用程式可以藉由呼叫 [**IWMReaderAdvanced2：： GetPlayMode**](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmreaderadvanced2-getplaymode)來查詢傳遞模式的讀取器。</span><span class="sxs-lookup"><span data-stu-id="eb276-129">At this point, the application can query the reader for the delivery mode by calling [**IWMReaderAdvanced2::GetPlayMode**](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmreaderadvanced2-getplaymode).</span></span> <span data-ttu-id="eb276-130">若為網路內容，此方法將會傳回 WMT \_ 播放 \_ 模式 \_ 下載，指出下載的內容，或 WMT \_ 播放 \_ 模式 \_ 串流，指出已串流處理的內容。</span><span class="sxs-lookup"><span data-stu-id="eb276-130">For network content, this method will return either WMT\_PLAY\_MODE\_DOWNLOAD, indicating downloaded content, or WMT\_PLAY\_MODE\_STREAMING, indicating streamed content.</span></span>

<span data-ttu-id="eb276-131">若要開始讀取檔案或資料流程，請呼叫 [**IWMReader：： Start**](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmreader-start) 方法。</span><span class="sxs-lookup"><span data-stu-id="eb276-131">To begin reading the file or stream, call the [**IWMReader::Start**](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmreader-start) method.</span></span> <span data-ttu-id="eb276-132">當讀取器開始 \_ 緩衝處理內容時，讀取器會傳送 WMT 緩衝 \_ 啟動通知，而 WMT \_ 緩衝處理 \_ 完成時則會停止通知。</span><span class="sxs-lookup"><span data-stu-id="eb276-132">The reader sends a WMT\_BUFFERING\_START notification when it starts to buffer the content, and a WMT\_BUFFERING\_STOP notification when buffering is complete.</span></span> <span data-ttu-id="eb276-133">當讀取器正在緩衝內容 (也就是在這兩個通知) 之間，您可能會想要對使用者顯示緩衝進度。</span><span class="sxs-lookup"><span data-stu-id="eb276-133">While the reader is buffering content (that is, between these two notifications), you might want to display the buffering progress to the user.</span></span> <span data-ttu-id="eb276-134">[**IWMReaderAdvanced2：： GetBufferProgress**](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmreaderadvanced2-getbufferprogress)方法會傳回已緩衝處理的資料百分比，以及剩餘的預估時間。</span><span class="sxs-lookup"><span data-stu-id="eb276-134">The [**IWMReaderAdvanced2::GetBufferProgress**](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmreaderadvanced2-getbufferprogress) method returns the percentage of data that has been buffered and the estimated time that remains.</span></span> <span data-ttu-id="eb276-135">針對下載的內容，您也可以呼叫 [**IWMReaderAdvanced2：： GetDownloadProgress**](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmreaderadvanced2-getdownloadprogress) 來取得下載進度。</span><span class="sxs-lookup"><span data-stu-id="eb276-135">For downloaded content, you can also call [**IWMReaderAdvanced2::GetDownloadProgress**](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmreaderadvanced2-getdownloadprogress) to get the download progress.</span></span> <span data-ttu-id="eb276-136">重複呼叫這些方法以更新您的顯示，直到緩衝處理完成為止。</span><span class="sxs-lookup"><span data-stu-id="eb276-136">Call these methods repeatedly to update your display, until buffering has completed.</span></span> <span data-ttu-id="eb276-137">在播放期間可能會因為網路擁塞等因素而再次發生緩衝。</span><span class="sxs-lookup"><span data-stu-id="eb276-137">Buffering can occur again during playback, due to factors such as network congestion.</span></span> <span data-ttu-id="eb276-138">如果發生這種情況，應用程式會收到另一個 WMT \_ 緩衝處理 \_ 開始通知。</span><span class="sxs-lookup"><span data-stu-id="eb276-138">If this occurs, the application receives another WMT\_BUFFERING\_START notification.</span></span>

<span data-ttu-id="eb276-139">當讀取器物件開始播放內容時，會傳送 WMT \_ 已啟動的通知。</span><span class="sxs-lookup"><span data-stu-id="eb276-139">When the reader object begins to play the content, it sends a WMT\_STARTED notification.</span></span> <span data-ttu-id="eb276-140">當每個範例都經過解碼並可供轉譯時，讀取器會透過 [**IWMReaderCallback：： OnSample**](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmreadercallback-onsample) 回呼方法將它傳遞給應用程式。</span><span class="sxs-lookup"><span data-stu-id="eb276-140">As each sample is decoded and becomes available for rendering, the reader passes it to the application through the [**IWMReaderCallback::OnSample**](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmreadercallback-onsample) callback method.</span></span> <span data-ttu-id="eb276-141">此時，此程式與本機檔案播放的流程相同。</span><span class="sxs-lookup"><span data-stu-id="eb276-141">At this point, the process is the same as it is for local file playback.</span></span> <span data-ttu-id="eb276-142">當播放停止時，讀取器會 \_ \_ \_ 傳送串流通知的 WMT 結束。</span><span class="sxs-lookup"><span data-stu-id="eb276-142">When playback stops, the reader sends a WMT\_END\_OF\_STREAMING notification.</span></span>

## <a name="related-topics"></a><span data-ttu-id="eb276-143">相關主題</span><span class="sxs-lookup"><span data-stu-id="eb276-143">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="eb276-144">**讀取 ASF 檔案**</span><span class="sxs-lookup"><span data-stu-id="eb276-144">**Reading ASF Files**</span></span>](reading-asf-files.md)
</dt> </dl>

 

 




