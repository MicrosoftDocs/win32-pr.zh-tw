---
description: CNG 具有下列功能。
ms.assetid: 400a2b6e-6bbe-4ba4-abde-a2f625007517
title: CNG 功能
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: df40606a255adc90bd36540571979c1c34579611
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/07/2021
ms.locfileid: "106991683"
---
# <a name="cng-features"></a><span data-ttu-id="3e2db-103">CNG 功能</span><span class="sxs-lookup"><span data-stu-id="3e2db-103">CNG Features</span></span>

<span data-ttu-id="3e2db-104">CNG 具有下列功能。</span><span class="sxs-lookup"><span data-stu-id="3e2db-104">CNG has the following features.</span></span>

-   [<span data-ttu-id="3e2db-105">密碼編譯靈活性</span><span class="sxs-lookup"><span data-stu-id="3e2db-105">Cryptographic Agility</span></span>](#cryptographic-agility)
-   [<span data-ttu-id="3e2db-106">認證與合規性</span><span class="sxs-lookup"><span data-stu-id="3e2db-106">Certification and Compliance</span></span>](#certification-and-compliance)
-   [<span data-ttu-id="3e2db-107">Suite B 支援</span><span class="sxs-lookup"><span data-stu-id="3e2db-107">Suite B Support</span></span>](#suite-b-support)
-   [<span data-ttu-id="3e2db-108">舊版支援</span><span class="sxs-lookup"><span data-stu-id="3e2db-108">Legacy Support</span></span>](#legacy-support)
-   [<span data-ttu-id="3e2db-109">核心模式支援</span><span class="sxs-lookup"><span data-stu-id="3e2db-109">Kernel Mode Support</span></span>](#kernel-mode-support)
-   [<span data-ttu-id="3e2db-110">稽核</span><span class="sxs-lookup"><span data-stu-id="3e2db-110">Auditing</span></span>](#auditing)
-   [<span data-ttu-id="3e2db-111">可替換的亂數產生器</span><span class="sxs-lookup"><span data-stu-id="3e2db-111">Replaceable Random Number Generators</span></span>](#replaceable-random-number-generators)
-   [<span data-ttu-id="3e2db-112">執行緒安全性</span><span class="sxs-lookup"><span data-stu-id="3e2db-112">Thread Safety</span></span>](#thread-safety)
-   [<span data-ttu-id="3e2db-113">作業模式</span><span class="sxs-lookup"><span data-stu-id="3e2db-113">Mode of Operation</span></span>](#mode-of-operation)

## <a name="cryptographic-agility"></a><span data-ttu-id="3e2db-114">密碼編譯靈活性</span><span class="sxs-lookup"><span data-stu-id="3e2db-114">Cryptographic Agility</span></span>

<span data-ttu-id="3e2db-115">CNG 的其中一個重要價值主張是密碼編譯的靈活性，有時也稱為密碼編譯 agnosticism。</span><span class="sxs-lookup"><span data-stu-id="3e2db-115">One of the key value propositions of CNG is cryptographic agility, sometimes called cryptographic agnosticism.</span></span> <span data-ttu-id="3e2db-116">不過，將通訊協定（例如 [*安全通訊端層通訊協定*](/windows/desktop/SecGloss/s-gly) (SSL) 或 [*傳輸層安全性*](/windows/desktop/SecGloss/t-gly) (TLS) 、CMS (S/MIME) 、IPsec、Kerberos 等等）轉換成相當重要。</span><span class="sxs-lookup"><span data-stu-id="3e2db-116">Converting implementation of protocols like [*Secure Sockets Layer protocol*](/windows/desktop/SecGloss/s-gly) (SSL) or [*transport layer security*](/windows/desktop/SecGloss/t-gly) (TLS), CMS (S/MIME), IPsec, Kerberos, and so on, to CNG, however, was required to make this ability valuable.</span></span> <span data-ttu-id="3e2db-117">在 CNG 層級上，必須提供所有演算法類型的替代和可探索性 (對稱、非對稱、雜湊函式) 、亂數產生和其他公用程式函數。</span><span class="sxs-lookup"><span data-stu-id="3e2db-117">At the CNG level, it was necessary to provide substitution and discoverability for all the algorithm types (symmetric, asymmetric, hash functions), random number generation, and other utility functions.</span></span> <span data-ttu-id="3e2db-118">通訊協定層級的變更更為重要，因為在許多情況下，通訊協定 Api 需要新增演算法選取專案和其他先前未存在的彈性選項。</span><span class="sxs-lookup"><span data-stu-id="3e2db-118">The protocol-level changes are more significant because in many cases the protocol APIs needed to add algorithm selection and other flexibility options that did not previously exist.</span></span>

<span data-ttu-id="3e2db-119">CNG 是在 Windows Vista 中首次推出，其定位於取代整個 Microsoft 軟體堆疊中的 [*CryptoAPI*](/windows/desktop/SecGloss/c-gly) 現有用途。</span><span class="sxs-lookup"><span data-stu-id="3e2db-119">CNG is first available in Windows Vista and is positioned to replace existing uses of [*CryptoAPI*](/windows/desktop/SecGloss/c-gly) throughout the Microsoft software stack.</span></span> <span data-ttu-id="3e2db-120">協力廠商開發人員會發現 CNG 有許多新功能，包括：</span><span class="sxs-lookup"><span data-stu-id="3e2db-120">Third-party developers will find lots of new features in CNG, including:</span></span>

-   <span data-ttu-id="3e2db-121">新的加密設定系統，支援更佳的密碼編譯靈活性。</span><span class="sxs-lookup"><span data-stu-id="3e2db-121">A new crypto configuration system, supporting better cryptographic agility.</span></span>
-   <span data-ttu-id="3e2db-122">金鑰儲存體 (更精細的抽象概念，以及將儲存體與演算法作業) 分開。</span><span class="sxs-lookup"><span data-stu-id="3e2db-122">Finer-grained abstraction for key storage (and separation of storage from algorithm operations).</span></span>
-   <span data-ttu-id="3e2db-123">使用長期金鑰進行作業的進程隔離。</span><span class="sxs-lookup"><span data-stu-id="3e2db-123">Process isolation for operations with long-term keys.</span></span>
-   <span data-ttu-id="3e2db-124">可替換的亂數產生器。</span><span class="sxs-lookup"><span data-stu-id="3e2db-124">Replaceable random number generators.</span></span>
-   <span data-ttu-id="3e2db-125">從出口簽署限制中降低。</span><span class="sxs-lookup"><span data-stu-id="3e2db-125">Relief from export signing restrictions.</span></span>
-   <span data-ttu-id="3e2db-126">整個堆疊的安全線程。</span><span class="sxs-lookup"><span data-stu-id="3e2db-126">Thread-safety throughout the stack.</span></span>
-   <span data-ttu-id="3e2db-127">核心模式密碼編譯 API。</span><span class="sxs-lookup"><span data-stu-id="3e2db-127">Kernel-mode cryptographic API.</span></span>

<span data-ttu-id="3e2db-128">此外，CNG 還支援所有必要的 Suite B 演算法，包括 (ECC) 的 [*橢圓曲線密碼*](/windows/desktop/SecGloss/e-gly) 編譯。</span><span class="sxs-lookup"><span data-stu-id="3e2db-128">In addition, CNG includes support for all required Suite B algorithms, including [*elliptic curve cryptography*](/windows/desktop/SecGloss/e-gly) (ECC).</span></span> <span data-ttu-id="3e2db-129">現有的 CryptoAPI 應用程式將會繼續運作，因為 CNG 變成可用。</span><span class="sxs-lookup"><span data-stu-id="3e2db-129">Existing CryptoAPI applications will continue to work as CNG becomes available.</span></span>

## <a name="certification-and-compliance"></a><span data-ttu-id="3e2db-130">認證與合規性</span><span class="sxs-lookup"><span data-stu-id="3e2db-130">Certification and Compliance</span></span>

<span data-ttu-id="3e2db-131">CNG 會驗證為聯邦資訊處理標準 (FIPS) 140-2，而且是 Windows 通用準則認證的評估目標的一部分。</span><span class="sxs-lookup"><span data-stu-id="3e2db-131">CNG is validated to Federal Information Processing Standards (FIPS) 140-2 and is part of the Target of Evaluation for the Windows Common Criteria certification.</span></span> <span data-ttu-id="3e2db-132">CNG 的設計目的是要當做 FIPS 層級2驗證系統中的元件使用。</span><span class="sxs-lookup"><span data-stu-id="3e2db-132">CNG was designed to be usable as a component in a FIPS level 2 validated system.</span></span>

<span data-ttu-id="3e2db-133">CNG 符合一般條件需求，方法是在安全的進程中儲存和使用長時間的金鑰。</span><span class="sxs-lookup"><span data-stu-id="3e2db-133">CNG complies with Common Criteria requirements by storing and using long lived keys in a secure process.</span></span>

## <a name="suite-b-support"></a><span data-ttu-id="3e2db-134">Suite B 支援</span><span class="sxs-lookup"><span data-stu-id="3e2db-134">Suite B Support</span></span>

<span data-ttu-id="3e2db-135">CNG 的一項重要功能，就是支援 Suite B 演算法。</span><span class="sxs-lookup"><span data-stu-id="3e2db-135">An important feature of CNG is its support for the Suite B algorithms.</span></span> <span data-ttu-id="3e2db-136">在2005年2月，美國政府機關 (NSA) 宣佈一組對稱式加密、非對稱式加密合約 (也稱為金鑰交換) 、數位簽章和雜湊函式，供未來的美國政府使用，稱為 *Suite B*。NSA 宣佈已通過認證的 Suite B 實施，並且將用來保護指定為最常機密、秘密和私用資訊的資訊，而這些資訊在過去已描述為敏感性但不機密。</span><span class="sxs-lookup"><span data-stu-id="3e2db-136">In February of 2005, the National Security Agency (NSA) of the United States announced a coordinated set of symmetric encryption, asymmetric secret agreement (also known as key exchange), digital signature and hash functions for future U.S. government use called *Suite B*. The NSA has announced that certified Suite B implementations can and will be used for the protection of information designated as Top Secret, Secret, and private information that, in the past was described as Sensitive-But-Unclassified.</span></span> <span data-ttu-id="3e2db-137">因此，對應用程式軟體廠商和系統整合者以及 Microsoft 而言，Suite B 的支援非常重要。</span><span class="sxs-lookup"><span data-stu-id="3e2db-137">Because of this, Suite B support is very important to application software vendors and system integrators as well as to Microsoft.</span></span>

<span data-ttu-id="3e2db-138">所有 Suite B 的演算法都是公開已知的。</span><span class="sxs-lookup"><span data-stu-id="3e2db-138">All Suite B algorithms are publicly known.</span></span> <span data-ttu-id="3e2db-139">這些都是在過去與密碼編譯演算法開發相關聯的政府機密範圍之外進行開發。</span><span class="sxs-lookup"><span data-stu-id="3e2db-139">They have been developed outside the scope of the government secrecy historically associated with cryptographic algorithm development.</span></span> <span data-ttu-id="3e2db-140">在這個相同的時間範圍內，某些歐洲國家和地區也提議相同的 Suite B 需求來保護其資訊。</span><span class="sxs-lookup"><span data-stu-id="3e2db-140">In this same time frame, some European countries and regions have also proposed the same Suite B requirements for protecting their information.</span></span>

<span data-ttu-id="3e2db-141">Suite B 密碼編譯建議在許多現有的通訊協定中使用橢圓曲線 Diffie-Hellman (ECDH) ，例如網際網路金鑰交換 (IKE，主要用於 IPsec) 、 [*傳輸層安全性*](/windows/desktop/SecGloss/t-gly) (TLS) ，以及安全 Mime (S/mime) 。</span><span class="sxs-lookup"><span data-stu-id="3e2db-141">Suite B cryptography recommends use of elliptic curve Diffie-Hellman (ECDH) in many existing protocols such as the Internet Key Exchange (IKE, mainly used in IPsec), [*transport layer security*](/windows/desktop/SecGloss/t-gly) (TLS), and Secure MIME (S/MIME).</span></span>

<span data-ttu-id="3e2db-142">CNG 支援擴充至所有必要演算法的 Suite B： AES (所有金鑰大小) 、SHA-1 系列 (256 SHA-1、sha-1、sha-384 和 SHA-512) （雜湊演算法、ECDH 和橢圓曲線 DSA） (在 NIST 標準的質數曲線 P-256、P-384 和 P-521。</span><span class="sxs-lookup"><span data-stu-id="3e2db-142">CNG includes support for Suite B that extends to all required algorithms: AES (all key sizes), the SHA-2 family (SHA-256, SHA-384 and SHA-512) of hashing algorithms, ECDH, and elliptic curve DSA (ECDSA) over the NIST-standard prime curves P-256, P-384, and P-521.</span></span> <span data-ttu-id="3e2db-143">Windows Vista 隨附的 Microsoft 演算法提供者不支援二進位曲線、Koblitz 曲線、自訂質數曲線，以及橢圓曲線 Menezes-Qu-Vanstone (ECMQV) 。</span><span class="sxs-lookup"><span data-stu-id="3e2db-143">Binary curves, Koblitz curves, custom prime curves, and elliptic curve Menezes-Qu-Vanstone (ECMQV) are not supported by the Microsoft algorithm providers included with Windows Vista.</span></span>

## <a name="legacy-support"></a><span data-ttu-id="3e2db-144">舊版支援</span><span class="sxs-lookup"><span data-stu-id="3e2db-144">Legacy Support</span></span>

<span data-ttu-id="3e2db-145">CNG 可支援 [*CryptoAPI*](/windows/desktop/SecGloss/c-gly) 1.0 中目前的演算法組。</span><span class="sxs-lookup"><span data-stu-id="3e2db-145">CNG provides support for the current set of algorithms in [*CryptoAPI*](/windows/desktop/SecGloss/c-gly) 1.0.</span></span> <span data-ttu-id="3e2db-146">*在 CNG 1.0 中* 目前支援的每個演算法都會繼續受到 CNG 的支援。</span><span class="sxs-lookup"><span data-stu-id="3e2db-146">Every algorithm that is currently supported in *CryptoAPI* 1.0 will continue to be supported in CNG.</span></span>

## <a name="kernel-mode-support"></a><span data-ttu-id="3e2db-147">核心模式支援</span><span class="sxs-lookup"><span data-stu-id="3e2db-147">Kernel Mode Support</span></span>

<span data-ttu-id="3e2db-148">CNG 在核心模式中支援密碼編譯。</span><span class="sxs-lookup"><span data-stu-id="3e2db-148">CNG supports cryptography in kernel mode.</span></span> <span data-ttu-id="3e2db-149">核心和使用者模式都使用相同的 Api，以完整支援密碼編譯功能。</span><span class="sxs-lookup"><span data-stu-id="3e2db-149">The same APIs are used in both kernel and user mode to fully support the cryptography features.</span></span> <span data-ttu-id="3e2db-150">除了將使用 CNG 的開機程式之外，SSL/TLS 和 IPsec 都可在核心模式中運作。</span><span class="sxs-lookup"><span data-stu-id="3e2db-150">Both SSL/TLS and IPsec operate in kernel mode in addition to boot processes that will be using CNG.</span></span> <span data-ttu-id="3e2db-151">並非所有的 CNG 函數都可以從核心模式中呼叫。</span><span class="sxs-lookup"><span data-stu-id="3e2db-151">Not all CNG functions can be called from kernel mode.</span></span> <span data-ttu-id="3e2db-152">無法從核心模式呼叫之函式的參考主題將明確指出無法從核心模式呼叫該函式。</span><span class="sxs-lookup"><span data-stu-id="3e2db-152">The reference topic for the functions that cannot be called from kernel mode will explicitly state that the function cannot be called from kernel mode.</span></span> <span data-ttu-id="3e2db-153">否則，如果呼叫端是以 **被動 \_ 層級** 的 [*IRQL*](/windows/desktop/SecGloss/i-gly)執行，則可以從核心模式呼叫所有的 CNG 函數。</span><span class="sxs-lookup"><span data-stu-id="3e2db-153">Otherwise, all CNG functions can be called from kernel mode if the caller is running at **PASSIVE\_LEVEL** [*IRQL*](/windows/desktop/SecGloss/i-gly).</span></span> <span data-ttu-id="3e2db-154">此外，根據提供者的功能而定，某些核心模式的 CNG 函式可能可在 **分派 \_ 層級的 IRQL** 上呼叫。</span><span class="sxs-lookup"><span data-stu-id="3e2db-154">In addition, some kernel mode CNG functions may be callable at **DISPATCH\_LEVEL IRQL**, depending on the provider's capabilities.</span></span>

<span data-ttu-id="3e2db-155">Microsoft 核心安全性支援提供者介面 (Ksecdd.sys) 是一般用途、軟體型的密碼編譯模組，位於 Windows 的核心模式層級。</span><span class="sxs-lookup"><span data-stu-id="3e2db-155">The Microsoft kernel security support provider interface (Ksecdd.sys) is a general purpose, software-based, cryptographic module residing at the kernel mode level of Windows.</span></span> <span data-ttu-id="3e2db-156">Ksecdd.sys 會以核心模式匯出驅動程式的形式執行，並透過其記載的介面，提供密碼編譯服務給核心元件。</span><span class="sxs-lookup"><span data-stu-id="3e2db-156">Ksecdd.sys runs as a kernel mode export driver, and provides cryptographic services through their documented interfaces to kernel components.</span></span> <span data-ttu-id="3e2db-157">Ksecdd.sys 不支援的內建 Microsoft 提供者演算法是 DSA。</span><span class="sxs-lookup"><span data-stu-id="3e2db-157">The only built-in Microsoft provider algorithm that is not supported by Ksecdd.sys is DSA.</span></span>

<span data-ttu-id="3e2db-158">**Windows Server 2008 和 Windows Vista：** CNG 不支援在核心模式中插入的演算法和提供者。</span><span class="sxs-lookup"><span data-stu-id="3e2db-158">**Windows Server 2008 and Windows Vista:** CNG does not support pluggable algorithms and providers in kernel mode.</span></span> <span data-ttu-id="3e2db-159">核心模式中唯一支援的密碼編譯演算法，是由 Microsoft 透過核心模式 CNG Api 提供的實作為。</span><span class="sxs-lookup"><span data-stu-id="3e2db-159">The only supported cryptographic algorithms available in kernel mode are those implementations provided by Microsoft through the kernel mode CNG APIs.</span></span>

## <a name="auditing"></a><span data-ttu-id="3e2db-160">稽核</span><span class="sxs-lookup"><span data-stu-id="3e2db-160">Auditing</span></span>

<span data-ttu-id="3e2db-161">為了符合一些通用準則需求，除了提供完整的安全性之外，在 Microsoft 軟體金鑰儲存提供者 (KSP) 中會審核 CNG 層中的許多動作。</span><span class="sxs-lookup"><span data-stu-id="3e2db-161">To comply with some of the Common Criteria requirements in addition to providing comprehensive security, many actions that happen in the CNG layer are audited in the Microsoft software key storage provider (KSP).</span></span> <span data-ttu-id="3e2db-162">Microsoft KSP 遵循下列指導方針，在安全性記錄中建立審核記錄：</span><span class="sxs-lookup"><span data-stu-id="3e2db-162">The Microsoft KSP adheres to the following guidelines to create audit records in the security log:</span></span>

-   <span data-ttu-id="3e2db-163">金鑰和金鑰組產生失敗（包括自我測試失敗）必須經過審核。</span><span class="sxs-lookup"><span data-stu-id="3e2db-163">Key and key-pair generation failures, including self-test failures, must be audited.</span></span>
-   <span data-ttu-id="3e2db-164">必須先審核金鑰匯入和匯出。</span><span class="sxs-lookup"><span data-stu-id="3e2db-164">Key import and export must be audited.</span></span>
-   <span data-ttu-id="3e2db-165">必須審核金鑰損毀失敗。</span><span class="sxs-lookup"><span data-stu-id="3e2db-165">Key destruction failures must be audited.</span></span>
-   <span data-ttu-id="3e2db-166">持續性金鑰必須在寫入和讀取檔案時進行審核。</span><span class="sxs-lookup"><span data-stu-id="3e2db-166">Persistent keys need to be audited when they are written to and read from files.</span></span>
-   <span data-ttu-id="3e2db-167">必須對成對的一致性檢查失敗進行審核。</span><span class="sxs-lookup"><span data-stu-id="3e2db-167">Pair-wise consistency check failures must be audited.</span></span>
-   <span data-ttu-id="3e2db-168">秘密金鑰驗證失敗（如果有的話）必須經過審核，例如，3DES 金鑰的同位檢查。</span><span class="sxs-lookup"><span data-stu-id="3e2db-168">Secret key validation failures, if any, must be audited, for example, parity checks on 3DES keys.</span></span>
-   <span data-ttu-id="3e2db-169">必須審核加密、解密、雜湊、簽章、驗證、金鑰交換和亂數產生的失敗。</span><span class="sxs-lookup"><span data-stu-id="3e2db-169">Failures in encryption, decryption, hashing, signature, verification, key exchange, and random number generation must be audited.</span></span>
-   <span data-ttu-id="3e2db-170">必須先審核密碼編譯自我測試。</span><span class="sxs-lookup"><span data-stu-id="3e2db-170">Cryptographic self-tests must be audited.</span></span>

<span data-ttu-id="3e2db-171">一般而言，如果金鑰沒有名稱，則是暫時金鑰。</span><span class="sxs-lookup"><span data-stu-id="3e2db-171">In general, if a key does not have a name, it is an ephemeral key.</span></span> <span data-ttu-id="3e2db-172">暫時金鑰不會保存，而且 Microsoft KSP 不會產生暫時金鑰的審核記錄。</span><span class="sxs-lookup"><span data-stu-id="3e2db-172">An ephemeral key does not persist, and the Microsoft KSP does not generate audit records for ephemeral keys.</span></span> <span data-ttu-id="3e2db-173">Microsoft KSP 只會在 LSA 進程的使用者模式中產生審核記錄。</span><span class="sxs-lookup"><span data-stu-id="3e2db-173">The Microsoft KSP generates audit records in user mode in the LSA process only.</span></span> <span data-ttu-id="3e2db-174">核心模式 CNG 不會產生任何審核記錄。</span><span class="sxs-lookup"><span data-stu-id="3e2db-174">No audit record is generated by kernel mode CNG.</span></span> <span data-ttu-id="3e2db-175">系統管理員必須設定稽核原則，才能從安全性記錄檔取得所有的 KSP 審核記錄。</span><span class="sxs-lookup"><span data-stu-id="3e2db-175">Administrators need to configure the audit policy to obtain all KSP audit logs from the security log.</span></span> <span data-ttu-id="3e2db-176">系統管理員必須執行下列命令列來設定 Ksp 所產生的其他審核：</span><span class="sxs-lookup"><span data-stu-id="3e2db-176">An administrator must run the following command line to configure additional audits generated by KSPs:</span></span>

<span data-ttu-id="3e2db-177">**auditpol/set/subcategory：「其他系統事件」/success： enable/failure： enable**</span><span class="sxs-lookup"><span data-stu-id="3e2db-177">**auditpol /set /subcategory:"other system events" /success:enable /failure:enable**</span></span>

## <a name="replaceable-random-number-generators"></a><span data-ttu-id="3e2db-178">可替換的亂數產生器</span><span class="sxs-lookup"><span data-stu-id="3e2db-178">Replaceable Random Number Generators</span></span>

<span data-ttu-id="3e2db-179">CNG 提供的另一項改進，是取代預設亂數產生器 (RNG) 的能力。</span><span class="sxs-lookup"><span data-stu-id="3e2db-179">Another improvement that CNG provides is the ability to replace the default random number generator (RNG).</span></span> <span data-ttu-id="3e2db-180">在 CryptoAPI 中，可以提供替代的 RNG 做為加密服務提供者 (CSP) 的一部分，但是無法將 Microsoft 基礎 Csp 重新導向為使用其他 RNG。</span><span class="sxs-lookup"><span data-stu-id="3e2db-180">In CryptoAPI, it is possible to provide an alternate RNG as part of a cryptographic service provider (CSP), but it is not possible to redirect the Microsoft Base CSPs to use another RNG.</span></span> <span data-ttu-id="3e2db-181">CNG 可以明確指定特定的 RNG，以便在特定的呼叫中使用。</span><span class="sxs-lookup"><span data-stu-id="3e2db-181">CNG makes it possible to explicitly specify a particular RNG to use within particular calls.</span></span>

## <a name="thread-safety"></a><span data-ttu-id="3e2db-182">執行緒安全性</span><span class="sxs-lookup"><span data-stu-id="3e2db-182">Thread Safety</span></span>

<span data-ttu-id="3e2db-183">當從不同的執行緒呼叫時，任何同時修改相同記憶體區域 (重要) 區段的函式，都不是安全線程。</span><span class="sxs-lookup"><span data-stu-id="3e2db-183">Any functions that modify the same area of memory at the same time (critical sections) when being called from separate threads are not thread safe.</span></span>

## <a name="mode-of-operation"></a><span data-ttu-id="3e2db-184">作業模式</span><span class="sxs-lookup"><span data-stu-id="3e2db-184">Mode of Operation</span></span>

<span data-ttu-id="3e2db-185">CNG 支援五種作業模式，可透過加密 Api 與對稱式封鎖密碼搭配使用。</span><span class="sxs-lookup"><span data-stu-id="3e2db-185">CNG supports five modes of operations that can be used with symmetric block ciphers through the encryption APIs.</span></span> <span data-ttu-id="3e2db-186">下表列出這些模式和其支援能力。</span><span class="sxs-lookup"><span data-stu-id="3e2db-186">These modes and their supportability are listed in the following table.</span></span> <span data-ttu-id="3e2db-187">您可以使用 [**BCryptSetProperty**](/windows/desktop/api/Bcrypt/nf-bcrypt-bcryptsetproperty)函數來設定演算法提供者的 [**BCRYPT \_ 連結 \_ 模式**](cng-property-identifiers.md)屬性，藉以變更作業模式。</span><span class="sxs-lookup"><span data-stu-id="3e2db-187">The mode of operation can be changed by setting the [**BCRYPT\_CHAINING\_MODE**](cng-property-identifiers.md) property for the algorithm provider by using the [**BCryptSetProperty**](/windows/desktop/api/Bcrypt/nf-bcrypt-bcryptsetproperty) function.</span></span>



| <span data-ttu-id="3e2db-188">作業模式</span><span class="sxs-lookup"><span data-stu-id="3e2db-188">Mode of operation</span></span>           | <span data-ttu-id="3e2db-189">BCRYPT \_ 連結 \_ 模式值</span><span class="sxs-lookup"><span data-stu-id="3e2db-189">BCRYPT\_CHAINING\_MODE value</span></span> | <span data-ttu-id="3e2db-190">演算法</span><span class="sxs-lookup"><span data-stu-id="3e2db-190">Algorithms</span></span>              | <span data-ttu-id="3e2db-191">標準</span><span class="sxs-lookup"><span data-stu-id="3e2db-191">Standard</span></span>  |
|-----------------------------|------------------------------|-------------------------|-----------|
| <span data-ttu-id="3e2db-192">ECB (電子 Codebook) </span><span class="sxs-lookup"><span data-stu-id="3e2db-192">ECB (Electronic Codebook)</span></span>   | <span data-ttu-id="3e2db-193">**BCRYPT \_ 鏈 \_ 模式 \_ ECB**</span><span class="sxs-lookup"><span data-stu-id="3e2db-193">**BCRYPT\_CHAIN\_MODE\_ECB**</span></span> | <span data-ttu-id="3e2db-194">對稱式區塊密碼</span><span class="sxs-lookup"><span data-stu-id="3e2db-194">Symmetric block ciphers</span></span> | <span data-ttu-id="3e2db-195">SP800-38A</span><span class="sxs-lookup"><span data-stu-id="3e2db-195">SP800-38A</span></span> |
| <span data-ttu-id="3e2db-196">CBC (加密區塊鏈) </span><span class="sxs-lookup"><span data-stu-id="3e2db-196">CBC (Cipher Block Chaining)</span></span> | <span data-ttu-id="3e2db-197">**BCRYPT \_ 鏈 \_ 模式 \_ CBC**</span><span class="sxs-lookup"><span data-stu-id="3e2db-197">**BCRYPT\_CHAIN\_MODE\_CBC**</span></span> | <span data-ttu-id="3e2db-198">對稱式區塊密碼</span><span class="sxs-lookup"><span data-stu-id="3e2db-198">Symmetric block ciphers</span></span> | <span data-ttu-id="3e2db-199">SP800-38A</span><span class="sxs-lookup"><span data-stu-id="3e2db-199">SP800-38A</span></span> |
| <span data-ttu-id="3e2db-200">CFB (加密的意見反應) </span><span class="sxs-lookup"><span data-stu-id="3e2db-200">CFB (Cipher Feedback)</span></span>       | <span data-ttu-id="3e2db-201">**BCRYPT \_ 鏈 \_ 模式 \_ CFB**</span><span class="sxs-lookup"><span data-stu-id="3e2db-201">**BCRYPT\_CHAIN\_MODE\_CFB**</span></span> | <span data-ttu-id="3e2db-202">對稱式區塊密碼</span><span class="sxs-lookup"><span data-stu-id="3e2db-202">Symmetric block ciphers</span></span> | <span data-ttu-id="3e2db-203">SP800-38A</span><span class="sxs-lookup"><span data-stu-id="3e2db-203">SP800-38A</span></span> |
| <span data-ttu-id="3e2db-204">具有 CBC) 的 CCM (計數器</span><span class="sxs-lookup"><span data-stu-id="3e2db-204">CCM (Counter with CBC)</span></span>      | <span data-ttu-id="3e2db-205">**BCRYPT \_ 鏈 \_ 模式 \_ CCM**</span><span class="sxs-lookup"><span data-stu-id="3e2db-205">**BCRYPT\_CHAIN\_MODE\_CCM**</span></span> | <span data-ttu-id="3e2db-206">AES</span><span class="sxs-lookup"><span data-stu-id="3e2db-206">AES</span></span>                     | <span data-ttu-id="3e2db-207">SP800-38C</span><span class="sxs-lookup"><span data-stu-id="3e2db-207">SP800-38C</span></span> |
| <span data-ttu-id="3e2db-208">GCM (Galois/計數器模式) </span><span class="sxs-lookup"><span data-stu-id="3e2db-208">GCM (Galois/Counter Mode)</span></span>   | <span data-ttu-id="3e2db-209">**BCRYPT \_ 鏈 \_ 模式 \_ GCM**</span><span class="sxs-lookup"><span data-stu-id="3e2db-209">**BCRYPT\_CHAIN\_MODE\_GCM**</span></span> | <span data-ttu-id="3e2db-210">AES</span><span class="sxs-lookup"><span data-stu-id="3e2db-210">AES</span></span>                     | <span data-ttu-id="3e2db-211">SP800-38D</span><span class="sxs-lookup"><span data-stu-id="3e2db-211">SP800-38D</span></span> |



 

> [!Note]  
> <span data-ttu-id="3e2db-212">Windows Vista 中只會定義作業的 ECB、CBC 和 CFB 模式。</span><span class="sxs-lookup"><span data-stu-id="3e2db-212">Only ECB, CBC, and CFB modes of operation are defined in Windows Vista.</span></span> <span data-ttu-id="3e2db-213">GCM 和 CCM 需要 Windows Vista （含 Service Pack 1） (SP1) 或 Windows Server 2008。</span><span class="sxs-lookup"><span data-stu-id="3e2db-213">GCM and CCM require Windows Vista with Service Pack 1 (SP1) or Windows Server 2008.</span></span>

 

 

 
