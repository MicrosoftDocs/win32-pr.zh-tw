---
description: 端點識別碼字串
ms.assetid: 3c955e2d-daaa-4b77-8ca5-890383bb2d39
title: 端點識別碼字串
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f04c07da78b92795ebadd7d8f9731f7188ae8dc3
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/07/2021
ms.locfileid: "106973367"
---
# <a name="endpoint-id-strings"></a><span data-ttu-id="df3ea-103">端點識別碼字串</span><span class="sxs-lookup"><span data-stu-id="df3ea-103">Endpoint ID Strings</span></span>

<span data-ttu-id="df3ea-104">在 Windows Vista 中，系統會產生端點識別碼字串來識別系統中的 [音訊端點裝置](audio-endpoint-devices.md) 。</span><span class="sxs-lookup"><span data-stu-id="df3ea-104">In Windows Vista, the system generates endpoint ID strings to identify the [audio endpoint devices](audio-endpoint-devices.md) in the system.</span></span> <span data-ttu-id="df3ea-105">端點識別碼字串是以 null 結尾的寬字元字串。</span><span class="sxs-lookup"><span data-stu-id="df3ea-105">An endpoint ID string is a null-terminated wide-character string.</span></span> <span data-ttu-id="df3ea-106">特定音訊端點裝置的端點識別碼字串可唯一識別系統中所有音訊端點裝置之間的裝置。</span><span class="sxs-lookup"><span data-stu-id="df3ea-106">The endpoint ID string for a particular audio endpoint device uniquely identifies the device among all audio endpoint devices in the system.</span></span>

<span data-ttu-id="df3ea-107">如果系統包含兩個或多個相同的音訊介面卡裝置，對應的音訊端點裝置將會有相同的易記名稱，但每個端點裝置都會有唯一的端點識別碼字串。</span><span class="sxs-lookup"><span data-stu-id="df3ea-107">If a system contains two or more identical audio adapter devices, the corresponding audio endpoint devices will have identical friendly names, but each endpoint device will have a unique endpoint ID string.</span></span> <span data-ttu-id="df3ea-108">如需取得端點裝置之易記名稱的詳細資訊，請參閱 [裝置屬性](device-properties.md)。</span><span class="sxs-lookup"><span data-stu-id="df3ea-108">For more information about obtaining the friendly name of an endpoint device, see [Device Properties](device-properties.md).</span></span>

<span data-ttu-id="df3ea-109">取得音訊端點裝置的 [**IMMDevice**](/windows/desktop/api/Mmdeviceapi/nn-mmdeviceapi-immdevice) 介面實例之後，用戶端可以呼叫 [**IMMDevice：： GetId**](/windows/desktop/api/Mmdeviceapi/nf-mmdeviceapi-immdevice-getid) 方法來取得裝置的端點識別碼字串。</span><span class="sxs-lookup"><span data-stu-id="df3ea-109">After obtaining an [**IMMDevice**](/windows/desktop/api/Mmdeviceapi/nn-mmdeviceapi-immdevice) interface instance for an audio endpoint device, a client can call the [**IMMDevice::GetId**](/windows/desktop/api/Mmdeviceapi/nf-mmdeviceapi-immdevice-getid) method to obtain the endpoint ID string for the device.</span></span> <span data-ttu-id="df3ea-110">用戶端可以藉由呼叫 [**IMMDeviceEnumerator：： GetDevice**](/windows/desktop/api/Mmdeviceapi/nf-mmdeviceapi-immdeviceenumerator-getdevice) 方法，使用端點識別碼字串來建立音訊端點裝置的實例，或在不同的進程中建立實例。</span><span class="sxs-lookup"><span data-stu-id="df3ea-110">A client can use the endpoint ID string to create an instance of the audio endpoint device at a later time or in a different process by calling the [**IMMDeviceEnumerator::GetDevice**](/windows/desktop/api/Mmdeviceapi/nf-mmdeviceapi-immdeviceenumerator-getdevice) method.</span></span>

<span data-ttu-id="df3ea-111">用戶端可以排列，以在任何音訊端點裝置的狀態變更時接收通知。</span><span class="sxs-lookup"><span data-stu-id="df3ea-111">A client can arrange to receive a notification when the status of any audio endpoint device changes.</span></span> <span data-ttu-id="df3ea-112">若要接收通知，用戶端會執行 [**IMMNotificationClient**](/windows/desktop/api/Mmdeviceapi/nn-mmdeviceapi-immnotificationclient) 介面，並使用 MMDevice API 來註冊該介面。</span><span class="sxs-lookup"><span data-stu-id="df3ea-112">To receive notifications, the client implements an [**IMMNotificationClient**](/windows/desktop/api/Mmdeviceapi/nn-mmdeviceapi-immnotificationclient) interface and registers that interface with the MMDevice API.</span></span> <span data-ttu-id="df3ea-113">當端點裝置的狀態變更時，MMDevice API 會在用戶端的 [**EDataFlow**](/windows/win32/api/mmdeviceapi/ne-mmdeviceapi-edataflow) 介面中呼叫適當的方法。</span><span class="sxs-lookup"><span data-stu-id="df3ea-113">When the status of an endpoint device changes, the MMDevice API calls the appropriate method in the client's [**EDataFlow**](/windows/win32/api/mmdeviceapi/ne-mmdeviceapi-edataflow) interface.</span></span> <span data-ttu-id="df3ea-114">方法的其中一個輸入參數是端點識別碼字串，可識別其狀態已變更的端點裝置。</span><span class="sxs-lookup"><span data-stu-id="df3ea-114">One of the input parameters to the method is the endpoint ID string that identifies the endpoint device whose status has changed.</span></span> <span data-ttu-id="df3ea-115">如需 **EDataFlow** 的詳細資訊，請參閱 [裝置事件](device-events.md)。</span><span class="sxs-lookup"><span data-stu-id="df3ea-115">For more information about **EDataFlow**, see [Device Events](device-events.md).</span></span>

<span data-ttu-id="df3ea-116">舊版音訊 Api （例如 DirectSound 和 Windows 多媒體功能）有自己的介面可用於列舉和識別音訊裝置。</span><span class="sxs-lookup"><span data-stu-id="df3ea-116">Legacy audio APIs such as DirectSound and the Windows multimedia functions have their own interfaces for enumerating and identifying audio devices.</span></span> <span data-ttu-id="df3ea-117">在 Windows Vista 中，這些介面已經過擴充，可提供端點識別碼字串來識別以 Api 呈現之裝置抽象化的端點裝置。</span><span class="sxs-lookup"><span data-stu-id="df3ea-117">In Windows Vista, these interfaces have been extended to supply the endpoint ID strings that identify the endpoint devices that underlie the device abstractions presented by the APIs.</span></span>

<span data-ttu-id="df3ea-118">在 DirectSound 裝置列舉期間，DirectSound 會為其所列舉的每個裝置提供端點識別碼字串。</span><span class="sxs-lookup"><span data-stu-id="df3ea-118">During DirectSound device enumeration, DirectSound supplies the endpoint ID string for each device that it enumerates.</span></span> <span data-ttu-id="df3ea-119">如需詳細資訊，請參閱 [舊版音訊應用程式的音訊事件](audio-events-for-legacy-audio-applications.md)。</span><span class="sxs-lookup"><span data-stu-id="df3ea-119">For more information, see [Audio Events for Legacy Audio Applications](audio-events-for-legacy-audio-applications.md).</span></span>

<span data-ttu-id="df3ea-120">若要取得舊版波形裝置的端點識別碼字串，請使用 [**waveOutMessage**](/previous-versions//dd743865(v=vs.85)) 或 [**waveInMessage**](/previous-versions//dd743846(v=vs.85)) 函式，將 winspool.drv \_ QUERYFUNCTIONINSTANCEID 訊息傳送到波形設備磁碟機。</span><span class="sxs-lookup"><span data-stu-id="df3ea-120">To obtain the endpoint ID string for a legacy waveform device, use the [**waveOutMessage**](/previous-versions//dd743865(v=vs.85)) or [**waveInMessage**](/previous-versions//dd743846(v=vs.85)) function to send a DRV\_QUERYFUNCTIONINSTANCEID message to the waveform device driver.</span></span> <span data-ttu-id="df3ea-121">如需示範如何使用此訊息的程式碼範例，請參閱 [舊版 Windows 多媒體應用程式的裝置角色](device-roles-for-legacy-windows-multimedia-applications.md)。</span><span class="sxs-lookup"><span data-stu-id="df3ea-121">For a code example that shows the use of this message, see [Device Roles for Legacy Windows Multimedia Applications](device-roles-for-legacy-windows-multimedia-applications.md).</span></span>

<span data-ttu-id="df3ea-122">如需使用核心音訊 Api 功能來增強使用舊版音訊 Api 之應用程式的詳細資訊，請參閱 [與舊版音訊 api 的互通性](interoperability-with-legacy-audio-apis.md)。</span><span class="sxs-lookup"><span data-stu-id="df3ea-122">For more information about using the capabilities of the core audio APIs to enhance applications that use legacy audio APIs, see [Interoperability with Legacy Audio APIs](interoperability-with-legacy-audio-apis.md).</span></span>

<span data-ttu-id="df3ea-123">用戶端應將端點識別碼字串的內容視為不透明。</span><span class="sxs-lookup"><span data-stu-id="df3ea-123">Clients should treat the contents of the endpoint ID string as opaque.</span></span> <span data-ttu-id="df3ea-124">也就是說，用戶端不應該嘗試剖析字串的內容，以取得裝置的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="df3ea-124">That is, clients should not attempt to parse the contents of the string to obtain information about the device.</span></span> <span data-ttu-id="df3ea-125">原因是字串格式未定義，而且可能會從一個 MMDevice API 系統模組的執行變更為下一個。</span><span class="sxs-lookup"><span data-stu-id="df3ea-125">The reason is that the string format is undefined and might change from one implementation of the MMDevice API system module to the next.</span></span>

<span data-ttu-id="df3ea-126">端點識別碼字串的存留期會系結至裝置安裝。</span><span class="sxs-lookup"><span data-stu-id="df3ea-126">The lifetime of an endpoint ID string is tied to the device installation.</span></span> <span data-ttu-id="df3ea-127">如果使用者升級設備磁碟機，或使用者卸載裝置，並再次安裝裝置，則裝置的端點識別碼字串會變更。</span><span class="sxs-lookup"><span data-stu-id="df3ea-127">The endpoint ID string of a device changes if the user upgrades the device driver, or if the user uninstalls the device, and installs it again.</span></span> <span data-ttu-id="df3ea-128">不過，在系統重新開機時，端點識別碼字串會維持不變，且如果使用者拔除裝置並將其插回，則 USB 音訊裝置的端點識別碼字串會維持不變。</span><span class="sxs-lookup"><span data-stu-id="df3ea-128">However, the endpoint ID string remains unchanged across system restarts, and the endpoint ID string of a USB audio device remains unchanged if the user unplugs the device and plugs it back in.</span></span>

## <a name="related-topics"></a><span data-ttu-id="df3ea-129">相關主題</span><span class="sxs-lookup"><span data-stu-id="df3ea-129">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="df3ea-130">音訊端點裝置</span><span class="sxs-lookup"><span data-stu-id="df3ea-130">Audio Endpoint Devices</span></span>](audio-endpoint-devices.md)
</dt> </dl>

 

 
