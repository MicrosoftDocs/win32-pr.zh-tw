---
description: 使用裝置角色
ms.assetid: 3b2cb1fe-0f11-4509-a6f3-513d2755cd29
title: 使用裝置角色
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c21ea667a6974634c1f9f0657dd02c13a621641c
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/07/2021
ms.locfileid: "103936051"
---
# <a name="working-with-device-roles"></a><span data-ttu-id="d4706-103">使用裝置角色</span><span class="sxs-lookup"><span data-stu-id="d4706-103">Working with Device Roles</span></span>

<span data-ttu-id="d4706-104">[MMDEVICE API](mmdevice-api.md)支援裝置角色。</span><span class="sxs-lookup"><span data-stu-id="d4706-104">The [MMDevice API](mmdevice-api.md) supports device roles.</span></span> <span data-ttu-id="d4706-105">[**ERole**](/windows/win32/api/mmdeviceapi/ne-mmdeviceapi-erole)列舉會定義 MMDevice API 所支援的裝置角色。</span><span class="sxs-lookup"><span data-stu-id="d4706-105">The [**ERole**](/windows/win32/api/mmdeviceapi/ne-mmdeviceapi-erole) enumeration defines the device roles that are supported by the MMDevice API.</span></span>

> [!Note]  
> <span data-ttu-id="d4706-106">雖然 [MMDEVICE API](mmdevice-api.md) 支援裝置角色，但 Windows Vista 中的使用者介面並不支援此功能。</span><span class="sxs-lookup"><span data-stu-id="d4706-106">Although the [MMDevice API](mmdevice-api.md) supports device roles, the user interface in Windows Vista does not implement support for this feature.</span></span>

 

<span data-ttu-id="d4706-107">應用程式可以透過 [**IMMDeviceEnumerator：： GetDefaultAudioEndpoint**](/windows/desktop/api/Mmdeviceapi/nf-mmdeviceapi-immdeviceenumerator-getdefaultaudioendpoint)和 [**IMMNotificationClient：： OnDefaultDeviceChanged**](/windows/desktop/api/Mmdeviceapi/nf-mmdeviceapi-immnotificationclient-ondefaultdevicechanged)方法，使用 MMDevice API 來支援 [裝置角色](device-roles.md)。</span><span class="sxs-lookup"><span data-stu-id="d4706-107">An application can use MMDevice API to support [device roles](device-roles.md) through the [**IMMDeviceEnumerator::GetDefaultAudioEndpoint**](/windows/desktop/api/Mmdeviceapi/nf-mmdeviceapi-immdeviceenumerator-getdefaultaudioendpoint) and [**IMMNotificationClient::OnDefaultDeviceChanged**](/windows/desktop/api/Mmdeviceapi/nf-mmdeviceapi-immnotificationclient-ondefaultdevicechanged) methods.</span></span> <span data-ttu-id="d4706-108">不過，Windows Vista 中的使用者介面不支援將個別角色指派給不同的裝置。</span><span class="sxs-lookup"><span data-stu-id="d4706-108">However, the user interface in Windows Vista does not support assignment of individual roles to different devices.</span></span> <span data-ttu-id="d4706-109">在 Windows Vista 中，使用者介面可讓使用者選取用於轉譯的預設音訊裝置，以及用於捕捉的預設音訊裝置。</span><span class="sxs-lookup"><span data-stu-id="d4706-109">In Windows Vista, the user interface enables the user to select a default audio device for rendering and a default audio device for capture.</span></span> <span data-ttu-id="d4706-110">當使用者選取預設轉譯或捕獲裝置時，系統會將這三個裝置角色 (eConsole、eMultimedia 和 eCommunications) 指派給該裝置。</span><span class="sxs-lookup"><span data-stu-id="d4706-110">When the user selects a default rendering or capture device, the system assigns all three device roles (eConsole, eMultimedia, and eCommunications) to that device.</span></span> <span data-ttu-id="d4706-111">應用程式無法變更指派給音訊端點裝置的角色。</span><span class="sxs-lookup"><span data-stu-id="d4706-111">Applications cannot change the roles that are assigned to audio endpoint devices.</span></span> <span data-ttu-id="d4706-112">作業系統只允許使用者指派裝置角色。</span><span class="sxs-lookup"><span data-stu-id="d4706-112">The operating system allows only the user to assign device roles.</span></span>

<span data-ttu-id="d4706-113">用戶端可以註冊自己，以在每次將角色指派給音訊端點裝置時，收到來自 MMDevice API 的通知。</span><span class="sxs-lookup"><span data-stu-id="d4706-113">A client can register itself to receive a notification from the MMDevice API each time a change occurs in the assignment of roles to audio endpoint devices.</span></span> <span data-ttu-id="d4706-114">當角色從某個裝置移到另一個裝置時，用戶端可以選擇是否要繼續播放 (或透過相同裝置錄製) 的串流，或將串流切換到其他裝置。</span><span class="sxs-lookup"><span data-stu-id="d4706-114">When a role shifts from one device to another, the client can choose whether to continue playing (or recording) its streams through the same device or to switch the streams to another device.</span></span> <span data-ttu-id="d4706-115">根據預設，資料流程會繼續播放 (或透過原始裝置記錄) 。</span><span class="sxs-lookup"><span data-stu-id="d4706-115">By default, the streams continue to play (or be recorded) through the original device.</span></span> <span data-ttu-id="d4706-116">在 Windows Vista 中，若要將串流切換至另一個裝置，用戶端必須刪除原始裝置上的資料流程，並在新裝置上建立替代串流。</span><span class="sxs-lookup"><span data-stu-id="d4706-116">In Windows Vista, to switch the streams to another device, the client must delete the streams on the original device and create replacement streams on the new device.</span></span> <span data-ttu-id="d4706-117">在 Windows 7 中，用戶端可以接聽新的通知，以在不中斷播放或捕捉會話的情況下，執行無縫切換。</span><span class="sxs-lookup"><span data-stu-id="d4706-117">In Windows 7, the client can listen for new notifications to implement a seamless switch without interrupting the playback or the capture session.</span></span> <span data-ttu-id="d4706-118">如需詳細資訊，請參閱 [資料流程路由](stream-routing.md)。</span><span class="sxs-lookup"><span data-stu-id="d4706-118">For more information, see [Stream Routing](stream-routing.md).</span></span>

<span data-ttu-id="d4706-119">如果您打算使用 Windows Vista 來測試您的應用程式，您可以設定測試環境，以確認當使用者可以將個別裝置角色指派給不同的裝置時，應用程式會如預期般運作。</span><span class="sxs-lookup"><span data-stu-id="d4706-119">If you plan to use Windows Vista to test your application, you can set up a test environment to verify that the application behaves as expected when the user can assign individual device roles to different devices.</span></span> <span data-ttu-id="d4706-120">如需詳細資訊，請傳送電子郵件至：uaa@microsoft.com。</span><span class="sxs-lookup"><span data-stu-id="d4706-120">For more information, send email to uaa@microsoft.com.</span></span>

## <a name="communication-devices"></a><span data-ttu-id="d4706-121">通訊裝置</span><span class="sxs-lookup"><span data-stu-id="d4706-121">Communication Devices</span></span>

<span data-ttu-id="d4706-122">Windows 7 使用者介面具有新增 *通訊裝置* 的功能。</span><span class="sxs-lookup"><span data-stu-id="d4706-122">The Windows 7 user interface has the capability of adding *communications devices*.</span></span> <span data-ttu-id="d4706-123">**音效** 控制台可讓使用者選取預設通訊裝置，以轉譯和捕獲音訊串流。</span><span class="sxs-lookup"><span data-stu-id="d4706-123">The **Sound** control panel enables the user to select a default communication device each for rendering and capturing audio stream.</span></span> <span data-ttu-id="d4706-124">根據預設，當新的裝置連接到電腦時，作業系統會執行自動角色偵測，並判斷裝置是否適合 eCommunication 角色。</span><span class="sxs-lookup"><span data-stu-id="d4706-124">By default, when a new device is connected to the computer, the operating system performs automatic role detecting and determines whether the device is suitable for the eCommunication role.</span></span> <span data-ttu-id="d4706-125">藉由將通訊裝置設為目標，您可以開發使用核心音訊 Api 的應用程式來實行電腦電話通訊解決方案。</span><span class="sxs-lookup"><span data-stu-id="d4706-125">By targeting communication devices, you can develop applications that use Core Audio APIs to implement PC-phone communication solutions.</span></span> <span data-ttu-id="d4706-126">例如，VoIP 應用程式可能會將其語音輸入和輸出串流指派給預設的捕獲，並以 eCommunications 角色呈現端點裝置。</span><span class="sxs-lookup"><span data-stu-id="d4706-126">For example, a VoIP application might assign its voice input and output streams to the default capture and rendering endpoint devices with the eCommunications role.</span></span> <span data-ttu-id="d4706-127">與任何其他串流一樣，通訊應用程式必須藉由呼叫 [**IMMDeviceEnumerator：： GetDefaultAudioEndpoint**](/windows/desktop/api/Mmdeviceapi/nf-mmdeviceapi-immdeviceenumerator-getdefaultaudioendpoint)來取得通訊裝置端點的參考。</span><span class="sxs-lookup"><span data-stu-id="d4706-127">Like any other stream, a communication application must get a reference to the communication device's endpoint by calling [**IMMDeviceEnumerator::GetDefaultAudioEndpoint**](/windows/desktop/api/Mmdeviceapi/nf-mmdeviceapi-immdeviceenumerator-getdefaultaudioendpoint).</span></span> <span data-ttu-id="d4706-128">在此呼叫中，應用程式必須在 *Role* 參數中指定 **eCommunications** 。</span><span class="sxs-lookup"><span data-stu-id="d4706-128">In this call, the application must specify **eCommunications** in the *Role* parameter.</span></span> <span data-ttu-id="d4706-129">在通訊裝置上開啟之資料流程上的 WASAPI 資料流程作業，類似于任何其他音訊串流。</span><span class="sxs-lookup"><span data-stu-id="d4706-129">The WASAPI stream operations on a stream, opened on a communication device, are similar to any other audio stream.</span></span> <span data-ttu-id="d4706-130">通訊應用程式可以藉由處理來自裝置端點的通知，來強化使用者體驗，例如回避。</span><span class="sxs-lookup"><span data-stu-id="d4706-130">The communication application can enhance user experience by implementing behaviors such as ducking by handling notifications from the device endpoint.</span></span> <span data-ttu-id="d4706-131">如需詳細資訊，請參閱 [使用通訊裝置](using-the-communication-device.md)。</span><span class="sxs-lookup"><span data-stu-id="d4706-131">For more information, see [Using a Communication Device](using-the-communication-device.md).</span></span>

## <a name="automatic-device-role-detection"></a><span data-ttu-id="d4706-132">自動裝置角色偵測</span><span class="sxs-lookup"><span data-stu-id="d4706-132">Automatic Device Role Detection</span></span>

<span data-ttu-id="d4706-133">假設電腦具有預設轉譯裝置、喇叭和預設捕獲裝置（麥克風）的情況。</span><span class="sxs-lookup"><span data-stu-id="d4706-133">Consider a scenario in which a computer has a default rendering device, the speakers, and a default capture device, a microphone.</span></span> <span data-ttu-id="d4706-134">使用者將 USB 耳機連接到電腦。</span><span class="sxs-lookup"><span data-stu-id="d4706-134">The user connects a USB headset to the computer.</span></span> <span data-ttu-id="d4706-135">安裝適當的驅動程式之後，作業系統會嘗試偵測要為新的音訊裝置指派的角色。</span><span class="sxs-lookup"><span data-stu-id="d4706-135">After the appropriate drivers are installed, the operating system attempts to detect a role to assign for the new audio device.</span></span>

<span data-ttu-id="d4706-136">在 Windows 7 中，已大幅改善裝置角色偵測功能，以判斷適合音訊裝置的適當角色。</span><span class="sxs-lookup"><span data-stu-id="d4706-136">In Windows 7, the device role detection feature has been improved significantly to determine the appropriate roles suited for audio devices.</span></span> <span data-ttu-id="d4706-137">所有音訊裝置都包含一組由裝置 OEM 填入的設定設定，可協助系統決定如何使用該裝置。</span><span class="sxs-lookup"><span data-stu-id="d4706-137">All audio devices contain a set of configuration settings populated by the device OEM, which help the system decide how to use the device.</span></span> <span data-ttu-id="d4706-138">這些設定包括音訊插座的實體位置、裝置類型、插座子類型，以及偵測功能等資訊，讓系統可以判斷裝置是否已插入。</span><span class="sxs-lookup"><span data-stu-id="d4706-138">These settings include information such as the physical location of the audio jack the device type, the jack subtype, and detection capabilities so that the system can determine whether the device is plugged in.</span></span> <span data-ttu-id="d4706-139">藉由從裝置中取出這些值，作業系統會決定要指派給裝置的角色。</span><span class="sxs-lookup"><span data-stu-id="d4706-139">By retrieving these values from the device, the operating system determines the role to assign to the device.</span></span> <span data-ttu-id="d4706-140">在此案例中，系統已查詢 USB 耳機裝置、執行自動角色偵測，並決定裝置最適合作為通訊裝置。</span><span class="sxs-lookup"><span data-stu-id="d4706-140">In this scenario, the system has queried the USB headset device, performed automatic role detection, and decided that the device is best suited to be a communication device.</span></span>

<span data-ttu-id="d4706-141">應用程式也可以使用核心音訊 Api 來取得插座資訊。</span><span class="sxs-lookup"><span data-stu-id="d4706-141">An application can also get jack information by using the Core Audio APIs.</span></span> <span data-ttu-id="d4706-142">如需詳細資訊，請參閱 [**IKsJackDescription**](/windows/desktop/api/Devicetopology/nn-devicetopology-iksjackdescription) 和 [**IKsJackDescription2**](/windows/desktop/api/Devicetopology/nn-devicetopology-iksjackdescription2)。</span><span class="sxs-lookup"><span data-stu-id="d4706-142">For more information, see [**IKsJackDescription**](/windows/desktop/api/Devicetopology/nn-devicetopology-iksjackdescription) and [**IKsJackDescription2**](/windows/desktop/api/Devicetopology/nn-devicetopology-iksjackdescription2).</span></span>

## <a name="related-topics"></a><span data-ttu-id="d4706-143">相關主題</span><span class="sxs-lookup"><span data-stu-id="d4706-143">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="d4706-144">裝置角色</span><span class="sxs-lookup"><span data-stu-id="d4706-144">Device Roles</span></span>](device-roles.md)
</dt> </dl>

 

 



