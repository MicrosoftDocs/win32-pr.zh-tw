---
description: 音訊端點裝置
ms.assetid: 773714fb-3b00-4f03-988f-05c5835f87cf
title: 音訊端點裝置
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c14d21aa174e34f8cb4ddab520819446a0e0ec89
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/07/2021
ms.locfileid: "103936496"
---
# <a name="audio-endpoint-devices"></a>音訊端點裝置

「 *端點裝置* 」一詞是指在應用程式中源自或終止之資料路徑一端的硬體裝置。 音訊端點裝置的範例有喇叭、耳機、麥克風和 CD 播放機。 沿著資料路徑移動的音訊資料可能會在應用程式與端點裝置之間的旅程期間，于數個軟體和硬體元件之間進行。 雖然這些元件對端點裝置的作業而言是不可或缺的，但使用者通常會看不到這些元件。 使用者比較可能會以端點裝置的方式來思考，而這些裝置會直接操控，而不是端點裝置所插入的裝置，或是在處理流入這些介面卡之音訊串流的軟體元件方面。

為了避免與端點裝置混淆，本檔是指將音訊介面卡上的裝置視為 *介面卡裝置*。

下圖顯示音訊端點裝置與介面卡裝置有何不同。

![音訊端點裝置和介面卡裝置的範例](images/devices.jpg)

在上圖中，下列是端點裝置的範例：

-   Speakers
-   麥克風
-   輔助輸入裝置

以下是介面卡裝置的範例：

-   Wave 輸出裝置 (包含數位轉類比轉換器) 
-   輸出控制項裝置 (包含音量和靜音控制項) 
-   Wave 輸入裝置 (包含類比轉數位轉換器) 
-   輸入控制項裝置 (包含音量控制和多工器) 

一般而言，音訊應用程式的使用者介面會參考音訊端點裝置，而不是介面卡裝置。 Windows Vista 直接支援端點裝置抽象化，以簡化方便使用的應用程式設計。

某些端點裝置可能會永久連接到介面卡裝置。 例如，電腦可能包含已整合至系統底座的內部裝置，例如 CD 播放機、麥克風或喇叭。 一般而言，使用者不會實際移除這些端點裝置。

其他端點裝置可能會透過音訊插孔連接到音訊介面卡。 使用者會插入並拔除這些外部裝置。 例如，像是外部麥克風或耳機的音訊端點裝置位於纜線的一端，另一端則插到介面卡裝置上的一個插座。

介面卡會透過系統匯流排 (通常是 PCI 或 PCI Express) 或支援) 隨插即用 PnP (的外部匯流排 (USB 或 IEEE 1394) 來與系統處理器進行通訊。 在裝置列舉期間，隨插即用 manager 會識別音訊介面卡中的裝置，並註冊這些裝置，使其可供作業系統和應用程式使用。

與介面卡和外部匯流排（例如 USB 或 IEEE 1394 匯流排）之間的連線不同，端點裝置與介面卡裝置之間的連線不支援 PnP 裝置偵測。 不過，某些音訊介面卡支援 *插座存在性偵測*：當插入插入或從插孔移除時，硬體會產生插斷，以通知介面卡驅動程式硬體設定中的變更。 Windows Vista 中的端點管理員可以利用此硬體功能，通知應用程式任何時候都有端點裝置。 如此一來，端點管理員的操作就類似于隨插即用管理員的作業，它會追蹤系統中出現的介面卡裝置。

在 Windows Vista 中，音訊系統會持續追蹤端點裝置和介面卡裝置。 端點管理員會註冊端點裝置，而隨插即用 manager 會註冊介面卡裝置。 註冊端點裝置可讓方便使用的應用程式，讓使用者能夠參考使用者直接操作的端點裝置，而不是參照可能隱藏在電腦底座內的介面卡裝置。 作業系統所報告的端點裝置可讓您在設定具有插座目前狀態偵測的音訊硬體時，即時追蹤其動態變更。 當端點裝置保持插上狀態時，系統會列舉該裝置。 當使用者拔除端點裝置時，系統會停止列舉該裝置。

在舊版的 Windows 中，包括 Windows 98、Windows Me、Windows 2000 和 Windows XP，系統只會將 PnP 裝置明確呈現給應用程式。 因此，應用程式必須推斷端點裝置是否存在。 缺少對端點裝置明確支援的作業系統，會強制用戶端應用程式執行更多工作。 例如，音訊捕獲應用程式必須執行下列步驟，才能從外部麥克風進行捕捉：

1.  列舉所有音訊捕獲裝置 (這些都是 PnP 管理員先前註冊的介面卡裝置) 。
2.  選取擷取裝置之後，請呼叫 **waveInOpen** 函式或使用 **DIRECTSOUNDCAPTURE** 或 DirectShow API，在裝置上開啟 capture 串流。
3.  呼叫 mixerOpen 函式，並使用其他 **mixerXxx** 函式來尋找 \_ \_ \_ 對應至步驟2中所開啟之捕捉裝置的 MIXERLINE COMPONENTTYPE SRC 麥克風行。 這是一項教育的猜測。
4.  從麥克風解除封鎖資料路徑。 如果資料路徑包含靜音節點，則用戶端必須停用來自麥克風的信號靜音。 如果捕捉裝置包含可從數個輸入中選取的多工器，則用戶端必須選取麥克風輸入。

此程式很容易出錯，因為執行這些作業的軟體如果遇到其設計工具不會預期或未進行測試的硬體設定，可能會失敗。

在支援端點裝置的 Windows Vista 中，連接至相同端點裝置的程式更簡單：

1.  從端點裝置的集合中選取麥克風。
2.  在該麥克風上啟動音訊捕獲介面。

作業系統會執行識別和啟用端點裝置所需的所有工作。 例如，如果麥克風的資料路徑包含多工器，系統會自動選取麥克風輸入至多工器。

如果應用程式（而不是執行自己的端點識別演算法）可以 relegate 將端點裝置識別為作業系統的工作，則音訊子系統的行為更可靠且具決定性。 軟體廠商不再需要驗證其端點識別演算法是否可與所有可用的音訊硬體裝置和設定正確搭配運作，而只需依賴作業系統來識別端點。 同樣地，硬體廠商不再需要確認每個相關的用戶端應用程式都可以輕鬆地識別任何連線至其音訊介面卡的端點裝置，只需要確認作業系統可以識別連接至其音訊介面卡的端點裝置。

下列主題提供有關音訊端點裝置的其他資訊：

-   [關於 MMDevice API](mmdevice-api.md)
-   [列舉音訊裝置](enumerating-audio-devices.md)
-   [端點識別碼字串](endpoint-id-strings.md)
-   [裝置內容](device-properties.md)
-   [裝置事件](device-events.md)
-   [裝置角色](device-roles.md)
-   [裝置格式](device-formats.md)

## <a name="related-topics"></a>相關主題

<dl> <dt>

[程式設計指南](programming-guide.md)
</dt> </dl>

 

 



