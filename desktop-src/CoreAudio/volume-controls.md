---
description: 音量控制項
ms.assetid: b1799372-8d2c-4774-995d-e7926a159d0a
title: 音量控制項
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 758fd25d4157030071a47ac8eec26dc0e4d50e4c
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/07/2021
ms.locfileid: "103847376"
---
# <a name="volume-controls"></a><span data-ttu-id="83415-103">音量控制項</span><span class="sxs-lookup"><span data-stu-id="83415-103">Volume Controls</span></span>

<span data-ttu-id="83415-104">管理共用模式資料流程的用戶端通常會使用 [WASAPI](wasapi.md)中的 [**ISimpleAudioVolume**](/windows/desktop/api/Audioclient/nn-audioclient-isimpleaudiovolume)和 [**IAudioSessionEvents**](/windows/desktop/api/Audiopolicy/nn-audiopolicy-iaudiosessionevents)介面，來控制和監視資料流程磁片區的層級。</span><span class="sxs-lookup"><span data-stu-id="83415-104">Clients that manage shared-mode streams typically use the [**ISimpleAudioVolume**](/windows/desktop/api/Audioclient/nn-audioclient-isimpleaudiovolume) and [**IAudioSessionEvents**](/windows/desktop/api/Audiopolicy/nn-audiopolicy-iaudiosessionevents) interfaces in [WASAPI](wasapi.md) to control and monitor the stream volume levels.</span></span> <span data-ttu-id="83415-105">透過 **ISimpleAudioVolume** 介面中的方法，用戶端可以取得和設定共用模式串流所屬 [音訊會話](audio-sessions.md) 的音量層級。</span><span class="sxs-lookup"><span data-stu-id="83415-105">Through the methods in the **ISimpleAudioVolume** interface, the client can get and set the volume levels of the [audio sessions](audio-sessions.md) that the shared-mode streams belong to.</span></span> <span data-ttu-id="83415-106">如果 Sndvol 或其他應用程式變更會話磁片區層級，用戶端可以透過 **IAudioSessionEvents** 介面接收變更的通知。</span><span class="sxs-lookup"><span data-stu-id="83415-106">If Sndvol or another application changes the session volume level, the client can receive notification of the change through the **IAudioSessionEvents** interface.</span></span>

<span data-ttu-id="83415-107">管理獨佔模式資料流程的用戶端通常會使用 [ENDPOINTVOLUME API](endpointvolume-api.md)中的 [**IAudioEndpointVolume**](/windows/desktop/api/Endpointvolume/nn-endpointvolume-iaudioendpointvolume)和 [**IAudioEndpointVolumeCallback**](/windows/desktop/api/Endpointvolume/nn-endpointvolume-iaudioendpointvolumecallback)介面，來控制和監視資料流量層級。</span><span class="sxs-lookup"><span data-stu-id="83415-107">Clients that manage exclusive-mode streams typically use the [**IAudioEndpointVolume**](/windows/desktop/api/Endpointvolume/nn-endpointvolume-iaudioendpointvolume) and [**IAudioEndpointVolumeCallback**](/windows/desktop/api/Endpointvolume/nn-endpointvolume-iaudioendpointvolumecallback) interfaces in the [EndpointVolume API](endpointvolume-api.md) to control and monitor the stream volume levels.</span></span> <span data-ttu-id="83415-108">透過 **IAudioEndpointVolume** 介面中的方法，用戶端可以取得並設定 [音訊端點裝置](audio-endpoint-devices.md)的音量層級。</span><span class="sxs-lookup"><span data-stu-id="83415-108">Through the methods in the **IAudioEndpointVolume** interface, the client can get and set the volume level of an [audio endpoint device](audio-endpoint-devices.md).</span></span> <span data-ttu-id="83415-109">如果 Sndvol 或其他應用程式變更端點裝置的磁片區層級，用戶端可以透過 **IAudioEndpointVolumeCallback** 介面接收變更的通知。</span><span class="sxs-lookup"><span data-stu-id="83415-109">If Sndvol or another application changes the volume level of the endpoint device, the client can receive notification of the change through the **IAudioEndpointVolumeCallback** interface.</span></span>

<span data-ttu-id="83415-110">如同 [音訊課程](audio-sessions.md)中所述，Sndvol 是系統音量控制程式。</span><span class="sxs-lookup"><span data-stu-id="83415-110">As explained in [Audio Sessions](audio-sessions.md), Sndvol is the system volume-control program.</span></span> <span data-ttu-id="83415-111">它會顯示系統中音訊呈現端點裝置的音量控制項。</span><span class="sxs-lookup"><span data-stu-id="83415-111">It displays volume controls for the audio-rendering endpoint devices in the system.</span></span> <span data-ttu-id="83415-112"> (目前不會顯示音訊捕獲端點裝置的音量控制項。 ) 若要查看特定裝置的音量控制項，請按一下功能表列中的 [ **裝置** ]，然後從可用裝置清單中選取裝置名稱。</span><span class="sxs-lookup"><span data-stu-id="83415-112">(Currently, it does not display the volume controls for audio-capture endpoint devices.) To view the volume controls for a particular device, click **Device** in the menu bar and select a device name from the list of available devices.</span></span>

<span data-ttu-id="83415-113">Sndvol 視窗會將裝置的音量控制項分割成兩個群組。</span><span class="sxs-lookup"><span data-stu-id="83415-113">The Sndvol window separates the volume controls for a device into two groups.</span></span> <span data-ttu-id="83415-114">視窗左側的群組方塊會標示為 [ **裝置**]。</span><span class="sxs-lookup"><span data-stu-id="83415-114">The group box on the left side of the window is labeled **Device**.</span></span> <span data-ttu-id="83415-115">[ **裝置** ] 方塊包含由 [**IAudioEndpointVolume**](/windows/desktop/api/Endpointvolume/nn-endpointvolume-iaudioendpointvolume) 介面控制的單一音量控制項。</span><span class="sxs-lookup"><span data-stu-id="83415-115">The **Device** box contains a single volume control that is controlled by the [**IAudioEndpointVolume**](/windows/desktop/api/Endpointvolume/nn-endpointvolume-iaudioendpointvolume) interface.</span></span> <span data-ttu-id="83415-116">使用者對此磁片區控制項進行的變更，可以透過 [**IAudioEndpointVolumeCallback**](/windows/desktop/api/Endpointvolume/nn-endpointvolume-iaudioendpointvolumecallback) 介面進行監視。</span><span class="sxs-lookup"><span data-stu-id="83415-116">Changes that the user makes to this volume control can be monitored through the [**IAudioEndpointVolumeCallback**](/windows/desktop/api/Endpointvolume/nn-endpointvolume-iaudioendpointvolumecallback) interface.</span></span>

<span data-ttu-id="83415-117">Sndvol 視窗右側的群組方塊會標示為 [ **應用程式**]。</span><span class="sxs-lookup"><span data-stu-id="83415-117">The group box on the right side of the Sndvol window is labeled **Applications**.</span></span> <span data-ttu-id="83415-118">[ **應用程式** ] 方塊包含目前共用裝置之應用程式的磁片區控制項。</span><span class="sxs-lookup"><span data-stu-id="83415-118">The **Applications** box contains the volume controls for the applications that currently share the device.</span></span> <span data-ttu-id="83415-119">針對在共用模式中使用裝置的應用程式，磁片區控制項代表 [**ISimpleAudioVolume**](/windows/desktop/api/Audioclient/nn-audioclient-isimpleaudiovolume) 介面所控制的磁片區層級。</span><span class="sxs-lookup"><span data-stu-id="83415-119">For applications that use the device in shared mode, the volume controls represent the volume levels that are controlled by the [**ISimpleAudioVolume**](/windows/desktop/api/Audioclient/nn-audioclient-isimpleaudiovolume) interface.</span></span> <span data-ttu-id="83415-120">使用者對這些磁片區控制項所做的變更，可以透過 [**IAudioSessionEvents**](/windows/desktop/api/Audiopolicy/nn-audiopolicy-iaudiosessionevents) 介面進行監視。</span><span class="sxs-lookup"><span data-stu-id="83415-120">Changes that the user makes to these volume controls can be monitored through the [**IAudioSessionEvents**](/windows/desktop/api/Audiopolicy/nn-audiopolicy-iaudiosessionevents) interface.</span></span>

<span data-ttu-id="83415-121">雖然共用模式應用程式可以使用其 [**IAudioSessionEvents**](/windows/desktop/api/Audiopolicy/nn-audiopolicy-iaudiosessionevents) 介面，來監視使用者在 [Sndvol] 視窗中的 [ **應用程式** ] 方塊中對應用程式音量控制項進行的變更，但應用程式無法監視其他不相關應用程式的磁片區控制項變更。</span><span class="sxs-lookup"><span data-stu-id="83415-121">Although a shared-mode application can use its [**IAudioSessionEvents**](/windows/desktop/api/Audiopolicy/nn-audiopolicy-iaudiosessionevents) interface to monitor changes that the user makes to the application's volume control in the **Applications** box in the Sndvol window, the application cannot monitor changes to the volume controls of other, unrelated applications.</span></span> <span data-ttu-id="83415-122">同樣地，應用程式可以透過 [**ISimpleAudioVolume**](/windows/desktop/api/Audioclient/nn-audioclient-isimpleaudiovolume) 介面變更其音訊會話的音量層級，但無法變更屬於其他、不相關應用程式之會話的音量層級。</span><span class="sxs-lookup"><span data-stu-id="83415-122">Similarly, an application can change the volume levels of its audio sessions through the [**ISimpleAudioVolume**](/windows/desktop/api/Audioclient/nn-audioclient-isimpleaudiovolume) interface, but it cannot change the volume levels of sessions that belong to other, unrelated applications.</span></span>

<span data-ttu-id="83415-123">不過，兩個或多個相關的應用程式 (或相同應用程式的實例) 可以在 Sndvol 視窗的 [ **應用程式** ] 方塊中共用相同的音量控制項，方法是將其音訊串流指派給相同的跨進程會話，或將其各自的會話與相同的群組參數建立關聯。</span><span class="sxs-lookup"><span data-stu-id="83415-123">However, two or more related applications (or instances of the same application) can share the same volume control in the **Applications** box in the Sndvol window either by assigning their audio streams to the same cross-process session or by associating their respective sessions with the same grouping parameter.</span></span> <span data-ttu-id="83415-124">如需詳細資訊，請參閱 [音訊會話](audio-sessions.md) 和 [群組參數](grouping-parameters.md)。</span><span class="sxs-lookup"><span data-stu-id="83415-124">For more information, see [Audio Sessions](audio-sessions.md) and [Grouping Parameters](grouping-parameters.md).</span></span>

<span data-ttu-id="83415-125">WASAPI 提供兩個額外的介面（ [**IChannelAudioVolume**](/windows/desktop/api/Audioclient/nn-audioclient-ichannelaudiovolume) 和 [**IAudioStreamVolume**](/windows/desktop/api/Audioclient/nn-audioclient-iaudiostreamvolume)），以控制共用模式資料流程的磁片區層級。</span><span class="sxs-lookup"><span data-stu-id="83415-125">WASAPI provides two additional interfaces, [**IChannelAudioVolume**](/windows/desktop/api/Audioclient/nn-audioclient-ichannelaudiovolume) and [**IAudioStreamVolume**](/windows/desktop/api/Audioclient/nn-audioclient-iaudiostreamvolume), to control the volume levels of shared-mode streams.</span></span> <span data-ttu-id="83415-126">這些介面主要是供特殊用戶端使用，這些用戶端需要控制會話中的個別通道或會話中個別資料流程的磁片區層級。</span><span class="sxs-lookup"><span data-stu-id="83415-126">These interfaces are mainly used by specialized clients that require control over the volume levels of either individual channels in a session or individual streams in a session.</span></span>

<span data-ttu-id="83415-127">[DEVICETOPOLOGY API](devicetopology-api.md)可讓用戶端存取音訊介面卡拓撲中的音量控制項。</span><span class="sxs-lookup"><span data-stu-id="83415-127">The [DeviceTopology API](devicetopology-api.md) enables clients to access the volume controls in the topologies of audio adapters.</span></span> <span data-ttu-id="83415-128">不過，管理獨佔模式資料流程的用戶端通常會使用 EndpointVolume API，而不是使用 DeviceTopology API 來控制串流磁片區層級。</span><span class="sxs-lookup"><span data-stu-id="83415-128">However, clients that manage exclusive-mode streams typically use the EndpointVolume API instead of the DeviceTopology API to control the stream volume levels.</span></span> <span data-ttu-id="83415-129">EndpointVolume API 會以兩種方式簡化端點裝置的控制量。</span><span class="sxs-lookup"><span data-stu-id="83415-129">The EndpointVolume API simplifies control of the volume of an endpoint device in two ways.</span></span> <span data-ttu-id="83415-130">首先，如果端點裝置會實作為硬體磁片區控制項，則 DeviceTopology API 會要求用戶端在搜尋硬體控制項時，先跨越裝置拓撲。</span><span class="sxs-lookup"><span data-stu-id="83415-130">First, if an endpoint device implements a hardware volume control, the DeviceTopology API requires the client to traverse the device topology in search of the hardware control.</span></span> <span data-ttu-id="83415-131">相反地，EndpointVolume API 會自動尋找用戶端的硬體磁片區控制項。</span><span class="sxs-lookup"><span data-stu-id="83415-131">In contrast, the EndpointVolume API automatically finds the hardware volume control for the client.</span></span> <span data-ttu-id="83415-132">其次，如果端點裝置未執行硬體磁片區控制，DeviceTopology 用戶端必須在軟體中執行磁片區控制。</span><span class="sxs-lookup"><span data-stu-id="83415-132">Second, if the endpoint device does not implement a hardware volume control, a DeviceTopology client must implement a volume control in software.</span></span> <span data-ttu-id="83415-133">相反地，EndpointVolume API 會自動將軟體音量控制項替換為遺漏的硬體控制項。</span><span class="sxs-lookup"><span data-stu-id="83415-133">In contrast, the EndpointVolume API automatically substitutes a software volume control for the missing hardware control.</span></span>

<span data-ttu-id="83415-134">下列各節說明音訊會話和音訊端點裝置的音量控制項：</span><span class="sxs-lookup"><span data-stu-id="83415-134">The following sections describe volume controls for audio sessions and for audio endpoint devices:</span></span>

-   [<span data-ttu-id="83415-135">會話磁片區控制項</span><span class="sxs-lookup"><span data-stu-id="83415-135">Session Volume Controls</span></span>](session-volume-controls.md)
-   [<span data-ttu-id="83415-136">端點磁片區控制項</span><span class="sxs-lookup"><span data-stu-id="83415-136">Endpoint Volume Controls</span></span>](endpoint-volume-controls.md)
-   [<span data-ttu-id="83415-137">EndpointVolume API</span><span class="sxs-lookup"><span data-stu-id="83415-137">EndpointVolume API</span></span>](endpointvolume-api.md)
-   [<span data-ttu-id="83415-138">音訊-錐形音量控制項</span><span class="sxs-lookup"><span data-stu-id="83415-138">Audio-Tapered Volume Controls</span></span>](audio-tapered-volume-controls.md)
-   [<span data-ttu-id="83415-139">尖峰計量</span><span class="sxs-lookup"><span data-stu-id="83415-139">Peak Meters</span></span>](peak-meters.md)

## <a name="related-topics"></a><span data-ttu-id="83415-140">相關主題</span><span class="sxs-lookup"><span data-stu-id="83415-140">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="83415-141">程式設計指南</span><span class="sxs-lookup"><span data-stu-id="83415-141">Programming Guide</span></span>](programming-guide.md)
</dt> </dl>

 

 



