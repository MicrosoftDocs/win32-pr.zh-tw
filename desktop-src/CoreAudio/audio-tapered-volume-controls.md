---
description: Audio-Tapered 的音量控制項
ms.assetid: 3b1adef5-40e9-4527-aa79-5a71f201fdfc
title: Audio-Tapered 的音量控制項
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 0cca0879d27d0eba3d49ca22b019442f882bf917
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/07/2021
ms.locfileid: "103688896"
---
# <a name="audio-tapered-volume-controls"></a><span data-ttu-id="32598-103">Audio-Tapered 的音量控制項</span><span class="sxs-lookup"><span data-stu-id="32598-103">Audio-Tapered Volume Controls</span></span>

<span data-ttu-id="32598-104">[**IAudioEndpointVolume**](/windows/desktop/api/Endpointvolume/nn-endpointvolume-iaudioendpointvolume)介面會管理音訊錐形的音量控制項。</span><span class="sxs-lookup"><span data-stu-id="32598-104">The [**IAudioEndpointVolume**](/windows/desktop/api/Endpointvolume/nn-endpointvolume-iaudioendpointvolume) interface manages volume controls that are audio tapered.</span></span> <span data-ttu-id="32598-105">這些控制項很適合顯示音量滑杆的 Windows 應用程式。</span><span class="sxs-lookup"><span data-stu-id="32598-105">These controls are well suited to Windows applications that display volume sliders.</span></span> <span data-ttu-id="32598-106">針對系結至音訊錐形音量控制項的音量滑杆，滑杆位置中的每個變更都會產生觀察音量的變更，與滑杆移動的距離成正比。</span><span class="sxs-lookup"><span data-stu-id="32598-106">For a volume slider that is tied to an audio-tapered volume control, each change in the position of the slider produces a change in perceived loudness that is proportional to the distance traveled by the slider.</span></span> <span data-ttu-id="32598-107">針對特定的旅遊距離，不論滑杆的移動是否出現在滑杆的移動範圍的下半部或中間部分，觀察音量增加或減少的數量大約相同。</span><span class="sxs-lookup"><span data-stu-id="32598-107">For a particular travel distance, the amount by which the perceived loudness increases or decreases is approximately the same regardless of whether the slider movement occurs in the lower, upper, or middle portion of the slider's range of movement.</span></span> <span data-ttu-id="32598-108">觀察到的音量會隨著音訊信號電力的對數以線性方式大幅變化。</span><span class="sxs-lookup"><span data-stu-id="32598-108">Perceived loudness varies approximately linearly with the logarithm of the audio signal power.</span></span>

<span data-ttu-id="32598-109">「 *音訊* 」一詞最初指的是 potentiometer 中電阻式元素的錐形圖形，用來做為音訊電器裝置中的音量控制項。</span><span class="sxs-lookup"><span data-stu-id="32598-109">The term *audio taper* originally referred to the tapered shape of the resistive element in a potentiometer that is used as a volume control in an audio electronics device.</span></span> <span data-ttu-id="32598-110">音訊錐形電阻式元素最寬于零磁片區的位置，最少則是最大的音量位置。</span><span class="sxs-lookup"><span data-stu-id="32598-110">An audio-tapered resistive element is widest at the zero-volume position and narrowest at the maximum-volume position.</span></span> <span data-ttu-id="32598-111">Potentiometer 會控制裝置透過其喇叭播放之音訊信號的電壓層級。</span><span class="sxs-lookup"><span data-stu-id="32598-111">The potentiometer controls the voltage level of the audio signal that the device plays through its speakers.</span></span> <span data-ttu-id="32598-112">Tapering 的設計目的是要產生 potentiometer 雨刷啟動位置與喇叭上認知音量之間的大約線性關聯性。</span><span class="sxs-lookup"><span data-stu-id="32598-112">The tapering is designed to produce an approximately linear relationship between the position of the potentiometer wiper and the perceived loudness at the speakers.</span></span> <span data-ttu-id="32598-113">雨刷啟動位置與喇叭的電壓之間的關聯性是非線性的。</span><span class="sxs-lookup"><span data-stu-id="32598-113">The relationship between the wiper position and the voltage at the speakers is nonlinear.</span></span>

<span data-ttu-id="32598-114">相反地，具有線性錐度的電阻式元素在 potentiometer 雨刷啟動的移動範圍上具有統一的寬度。</span><span class="sxs-lookup"><span data-stu-id="32598-114">In contrast, a resistive element with a linear taper has a uniform width over the potentiometer wiper's range of movement.</span></span> <span data-ttu-id="32598-115">如此一來，喇叭的電壓就會隨著雨刷啟動位置呈線性變化。</span><span class="sxs-lookup"><span data-stu-id="32598-115">As a result, the voltage at the speakers varies linearly with the wiper position.</span></span> <span data-ttu-id="32598-116">雨刷啟動位置與音量之間的關聯性是非線性的。</span><span class="sxs-lookup"><span data-stu-id="32598-116">The relationship between the wiper position and loudness is nonlinear.</span></span>

<span data-ttu-id="32598-117">同樣地，顯示音量滑杆的 Windows 應用程式會定義喇叭位置與喇叭之間的輸出信號層級之間的關聯性。</span><span class="sxs-lookup"><span data-stu-id="32598-117">Similarly, a Windows application that displays a volume slider defines a relationship between the slider position and the output signal level at the speakers.</span></span> <span data-ttu-id="32598-118">關聯性實際上可以是線性錐形或音訊錐形。</span><span class="sxs-lookup"><span data-stu-id="32598-118">The relationship can, in effect, be linear tapered or audio tapered.</span></span>

<span data-ttu-id="32598-119">下圖顯示滑杆位置與輸出電壓的對應，以及線性錐形音量控制項的認知音量。</span><span class="sxs-lookup"><span data-stu-id="32598-119">The following diagram shows the mapping of slider position to output voltage and to perceived loudness for a linear-tapered volume control.</span></span>

![線性錐形音量控制項的輸出圖表](images/taper1.jpg)

<span data-ttu-id="32598-121">在上圖的左邊，音訊數位轉類比轉換器的輸出電壓層級 (DAC) 會以線性方式增加，因為音量滑杆會從其最小位置 () 標示為最大值的位置， (標示的最大) 。</span><span class="sxs-lookup"><span data-stu-id="32598-121">On the left side of the preceding diagram, the output voltage level of the audio digital-to-analog converter (DAC) increases linearly as the volume slider moves from its minimum position (labeled Min) to its maximum position (labeled Max).</span></span> <span data-ttu-id="32598-122">垂直軸上的標籤 V<sub>FS</sub> 代表完整規模的 DAC 輸出電壓。</span><span class="sxs-lookup"><span data-stu-id="32598-122">The label V<sub>FS</sub> on the vertical axis represents the full-scale DAC output voltage.</span></span>

<span data-ttu-id="32598-123">不過，觀察到的音量會隨著音訊信號的耗電量而有大約的對數，如先前圖表的右側所示。</span><span class="sxs-lookup"><span data-stu-id="32598-123">However, perceived loudness varies approximately as the logarithm of the power of the audio signal, as shown on the right side of the preceding diagram.</span></span> <span data-ttu-id="32598-124">因此，在接近最小值設定的間隔中，移動滑杆會導致觀察音量中有相當大的變更，但在相同寬度接近最大值的間隔中移動滑杆會導致觀察音量的變更變得相對較小。</span><span class="sxs-lookup"><span data-stu-id="32598-124">Thus, movement of the slider over an interval near the minimum setting results in a relatively large change in perceived loudness, but slider movement over an interval of the same width near the maximum setting causes a relatively small change in perceived loudness.</span></span>

<span data-ttu-id="32598-125">在上圖的右側，垂直軸上的音量會以分貝 (dB) 相對於全形電源設定 (以0分貝) 。</span><span class="sxs-lookup"><span data-stu-id="32598-125">On the right side of the preceding diagram, loudness on the vertical axis is measured in decibels (dB) relative to the full-scale power setting (at 0 decibels).</span></span> <span data-ttu-id="32598-126">音量曲線與垂直軸相交于減號無限大，但只有從0分貝到–96分貝的曲線部分才會出現在圖表中。</span><span class="sxs-lookup"><span data-stu-id="32598-126">The loudness curve intersects the vertical axis at minus infinity, but only the portion of the curve from 0 decibels to –96 decibels appears in the diagram.</span></span> <span data-ttu-id="32598-127">決定只顯示曲線的這個部分是很任意的，但96分貝可方便地代表16位 DAC 的最下層輸出層級（相對於完整規模的電源）的電源。</span><span class="sxs-lookup"><span data-stu-id="32598-127">The decision to show only this portion of the curve is somewhat arbitrary, but –96 decibels conveniently represents the power at the next-to-lowest output level of a 16-bit DAC relative to the full-scale power.</span></span> <span data-ttu-id="32598-128">此值的計算方式為 20<sup>。</sup>記錄₁₀ (1/65535) 。</span><span class="sxs-lookup"><span data-stu-id="32598-128">This value is calculated as 20<sup>.</sup>log₁₀(1/65535).</span></span>

<span data-ttu-id="32598-129">由於上圖中接近最小設定的滑杆位置較小變更會導致音量中的大型變更，因此使用者可能會發現該磁片區難以控制此區域。</span><span class="sxs-lookup"><span data-stu-id="32598-129">Because small changes in slider position near the minimum setting in the preceding diagram result in large changes in loudness, the user might find the volume difficult to control over this region.</span></span> <span data-ttu-id="32598-130">相對較小的滑杆移動可以將磁片區的上方或低於所需的層級。</span><span class="sxs-lookup"><span data-stu-id="32598-130">Relatively small slider movements can push the volume well above or below the desired level.</span></span> <span data-ttu-id="32598-131">改良的音量控制項可提供滑杆位置和音量之間更線性的關聯性。</span><span class="sxs-lookup"><span data-stu-id="32598-131">An improved volume control would provide a more linear relationship between slider position and loudness.</span></span>

<span data-ttu-id="32598-132">下圖顯示滑杆位置與輸出電壓的對應，以及音訊錐形音量控制項的認知音量。</span><span class="sxs-lookup"><span data-stu-id="32598-132">The following diagram shows the mapping of slider position to output voltage and to perceived loudness for an audio-tapered volume control.</span></span>

![音訊-錐形音量控制的輸出圖表](images/taper2.jpg)

<span data-ttu-id="32598-134">如上圖右邊所示，觀察到的音量會隨著滑杆位置的變更而以線性方式變化。</span><span class="sxs-lookup"><span data-stu-id="32598-134">As shown on the right side of the preceding diagram, perceived loudness varies approximately linearly with changes in slider position.</span></span> <span data-ttu-id="32598-135">若要這樣做，DAC 電壓必須隨著位置而改變 nonlinearly，如圖左邊所示。</span><span class="sxs-lookup"><span data-stu-id="32598-135">For this to occur, the DAC voltage must vary nonlinearly with position, as shown on the left side of the diagram.</span></span> <span data-ttu-id="32598-136">[曲線] asymptotically 會將0伏的方法，從最大值設定往左移動。</span><span class="sxs-lookup"><span data-stu-id="32598-136">The curve asymptotically approaches 0 volts as the slider moves toward the left from the maximum setting.</span></span> <span data-ttu-id="32598-137">最小滑杆位置的電壓很小，但可能不會剛好為零。</span><span class="sxs-lookup"><span data-stu-id="32598-137">The voltage at the minimum slider position is very small, but it might not be exactly zero.</span></span>

<span data-ttu-id="32598-138">**IAudioEndpointVolume** 介面中的下列方法會使用以分貝測量的磁片區設定：</span><span class="sxs-lookup"><span data-stu-id="32598-138">The following methods in the **IAudioEndpointVolume** interface use volume settings that are measured in decibels:</span></span>

-   [<span data-ttu-id="32598-139">**IAudioEndpointVolume::GetChannelVolumeLevel**</span><span class="sxs-lookup"><span data-stu-id="32598-139">**IAudioEndpointVolume::GetChannelVolumeLevel**</span></span>](/windows/desktop/api/Endpointvolume/nf-endpointvolume-iaudioendpointvolume-getchannelvolumelevel)
-   [<span data-ttu-id="32598-140">**IAudioEndpointVolume::GetMasterVolumeLevel**</span><span class="sxs-lookup"><span data-stu-id="32598-140">**IAudioEndpointVolume::GetMasterVolumeLevel**</span></span>](/windows/desktop/api/Endpointvolume/nf-endpointvolume-iaudioendpointvolume-getmastervolumelevel)
-   [<span data-ttu-id="32598-141">**IAudioEndpointVolume::SetChannelVolumeLevel**</span><span class="sxs-lookup"><span data-stu-id="32598-141">**IAudioEndpointVolume::SetChannelVolumeLevel**</span></span>](/windows/desktop/api/Endpointvolume/nf-endpointvolume-iaudioendpointvolume-setchannelvolumelevel)
-   [<span data-ttu-id="32598-142">**IAudioEndpointVolume::SetMasterVolumeLevel**</span><span class="sxs-lookup"><span data-stu-id="32598-142">**IAudioEndpointVolume::SetMasterVolumeLevel**</span></span>](/windows/desktop/api/Endpointvolume/nf-endpointvolume-iaudioendpointvolume-setmastervolumelevel)

<span data-ttu-id="32598-143">這些方法會產生大量設定和認知音量之間的大約線性關聯性。</span><span class="sxs-lookup"><span data-stu-id="32598-143">These methods produce an approximately linear relationship between volume setting and perceived loudness.</span></span> <span data-ttu-id="32598-144">這些方法所管理之磁片區控制項的磁片區範圍以分貝為單位，視音訊端點裝置而定。</span><span class="sxs-lookup"><span data-stu-id="32598-144">The volume range in decibels of the volume controls that are managed by these methods depends on the audio endpoint device.</span></span> <span data-ttu-id="32598-145">若要判斷特定裝置的磁片區範圍，請呼叫 [**IAudioEndpointVolume：： GetVolumeRange**](/windows/desktop/api/Endpointvolume/nf-endpointvolume-iaudioendpointvolume-getvolumerange) 方法。</span><span class="sxs-lookup"><span data-stu-id="32598-145">To determine the volume range for a particular device, call the [**IAudioEndpointVolume::GetVolumeRange**](/windows/desktop/api/Endpointvolume/nf-endpointvolume-iaudioendpointvolume-getvolumerange) method.</span></span>

<span data-ttu-id="32598-146">相較之下， **IAudioEndpointVolume** 介面中下列方法的磁片區設定，會在磁片區範圍上以更輕輕的錐形曲線為：</span><span class="sxs-lookup"><span data-stu-id="32598-146">In contrast, the volume settings for the following methods in the **IAudioEndpointVolume** interface follow a more gently tapered curve over the volume range:</span></span>

-   [<span data-ttu-id="32598-147">**IAudioEndpointVolume::GetChannelVolumeLevelScalar**</span><span class="sxs-lookup"><span data-stu-id="32598-147">**IAudioEndpointVolume::GetChannelVolumeLevelScalar**</span></span>](/windows/desktop/api/Endpointvolume/nf-endpointvolume-iaudioendpointvolume-getchannelvolumelevelscalar)
-   [<span data-ttu-id="32598-148">**IAudioEndpointVolume::GetMasterVolumeLevelScalar**</span><span class="sxs-lookup"><span data-stu-id="32598-148">**IAudioEndpointVolume::GetMasterVolumeLevelScalar**</span></span>](/windows/desktop/api/Endpointvolume/nf-endpointvolume-iaudioendpointvolume-getmastervolumelevelscalar)
-   [<span data-ttu-id="32598-149">**IAudioEndpointVolume::SetChannelVolumeLevelScalar**</span><span class="sxs-lookup"><span data-stu-id="32598-149">**IAudioEndpointVolume::SetChannelVolumeLevelScalar**</span></span>](/windows/desktop/api/Endpointvolume/nf-endpointvolume-iaudioendpointvolume-setchannelvolumelevelscalar)
-   [<span data-ttu-id="32598-150">**IAudioEndpointVolume::SetMasterVolumeLevelScalar**</span><span class="sxs-lookup"><span data-stu-id="32598-150">**IAudioEndpointVolume::SetMasterVolumeLevelScalar**</span></span>](/windows/desktop/api/Endpointvolume/nf-endpointvolume-iaudioendpointvolume-setmastervolumelevelscalar)
-   [<span data-ttu-id="32598-151">**IAudioEndpointVolume::VolumeStepDown**</span><span class="sxs-lookup"><span data-stu-id="32598-151">**IAudioEndpointVolume::VolumeStepDown**</span></span>](/windows/desktop/api/Endpointvolume/nf-endpointvolume-iaudioendpointvolume-volumestepdown)
-   [<span data-ttu-id="32598-152">**IAudioEndpointVolume::VolumeStepUp**</span><span class="sxs-lookup"><span data-stu-id="32598-152">**IAudioEndpointVolume::VolumeStepUp**</span></span>](/windows/desktop/api/Endpointvolume/nf-endpointvolume-iaudioendpointvolume-volumestepup)

<span data-ttu-id="32598-153">在 Windows Vista 中，這些方法會使用在上圖中顯示的音訊-錐形曲線與線性錐形曲線之間的中間曲線。</span><span class="sxs-lookup"><span data-stu-id="32598-153">In Windows Vista, these methods use a curve that is intermediate between the audio-tapered curve shown in the preceding diagram and a linear-tapered curve.</span></span> <span data-ttu-id="32598-154">請注意，在未來的 Windows 版本中，曲線的形狀可能會變更。</span><span class="sxs-lookup"><span data-stu-id="32598-154">Note that the shape of the curve might change in future versions of Windows.</span></span> <span data-ttu-id="32598-155">上述清單中的前四個方法是以正規化值的形式從 0.0 (最小磁片區) 到 1.0 (最大磁片區) 。</span><span class="sxs-lookup"><span data-stu-id="32598-155">The first four methods in the preceding list express volume levels as normalized values in the range from 0.0 (minimum volume) to 1.0 (maximum volume).</span></span> <span data-ttu-id="32598-156">針對清單中的最後兩個方法，呼叫 [**IAudioEndpointVolume：： GetVolumeStepInfo**](/windows/desktop/api/Endpointvolume/nf-endpointvolume-iaudioendpointvolume-getvolumestepinfo) 方法，以取得磁片區範圍中的步驟數目。</span><span class="sxs-lookup"><span data-stu-id="32598-156">For the last two methods in the list, call the [**IAudioEndpointVolume::GetVolumeStepInfo**](/windows/desktop/api/Endpointvolume/nf-endpointvolume-iaudioendpointvolume-getvolumestepinfo) method to obtain the number of steps in the volume range.</span></span>

<span data-ttu-id="32598-157">下列介面會針對其音量設定使用線性錐形曲線：</span><span class="sxs-lookup"><span data-stu-id="32598-157">The following interfaces use linear-tapered curves for their volume settings:</span></span>

-   [<span data-ttu-id="32598-158">**ISimpleAudioVolume**</span><span class="sxs-lookup"><span data-stu-id="32598-158">**ISimpleAudioVolume**</span></span>](/windows/desktop/api/Audioclient/nn-audioclient-isimpleaudiovolume)
-   [<span data-ttu-id="32598-159">**IChannelAudioVolume**</span><span class="sxs-lookup"><span data-stu-id="32598-159">**IChannelAudioVolume**</span></span>](/windows/desktop/api/Audioclient/nn-audioclient-ichannelaudiovolume)
-   [<span data-ttu-id="32598-160">**IAudioStreamVolume**</span><span class="sxs-lookup"><span data-stu-id="32598-160">**IAudioStreamVolume**</span></span>](/windows/desktop/api/Audioclient/nn-audioclient-iaudiostreamvolume)

<span data-ttu-id="32598-161">如需這些介面的詳細資訊，請參閱 [會話磁片區控制項](session-volume-controls.md)。</span><span class="sxs-lookup"><span data-stu-id="32598-161">For more information about these interfaces, see [Session Volume Controls](session-volume-controls.md).</span></span> <span data-ttu-id="32598-162">如需磁片區範圍和各種 Windows 版本中預設磁片區層級的相關資訊，請參閱 [預設音訊磁片區設定](/windows-hardware/drivers/audio/default-audio-volume-settings)。</span><span class="sxs-lookup"><span data-stu-id="32598-162">And for information about the volume ranges and the default volume levels in the various versions of Windows, see [Default Audio Volume Settings](/windows-hardware/drivers/audio/default-audio-volume-settings).</span></span>

## <a name="related-topics"></a><span data-ttu-id="32598-163">相關主題</span><span class="sxs-lookup"><span data-stu-id="32598-163">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="32598-164">音量控制項</span><span class="sxs-lookup"><span data-stu-id="32598-164">Volume Controls</span></span>](volume-controls.md)
</dt> </dl>

 

 
