---
description: DeviceTopology API
ms.assetid: 051311ef-dd29-4014-bb9c-4cdccf7ce7de
title: DeviceTopology API
ms.topic: article
ms.date: 05/31/2018
ms.custom: project-verbatim
ms.openlocfilehash: 472c02cd59ca0cadd922cbe398a768c97cfab73a
ms.sourcegitcommit: af120ad5c30da2fc5eb717ca2a1c4c45878efd71
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 03/20/2021
ms.locfileid: "106988633"
---
# <a name="devicetopology-api"></a><span data-ttu-id="6a917-103">DeviceTopology API</span><span class="sxs-lookup"><span data-stu-id="6a917-103">DeviceTopology API</span></span>

<span data-ttu-id="6a917-104">請參閱 [Microsoft high quality voice capture 範例](https://github.com/microsoft/Windows-classic-samples/tree/master/Samples/Win7Samples/multimedia/audio/aecmicarray)。</span><span class="sxs-lookup"><span data-stu-id="6a917-104">See the [Microsoft high quality voice capture DMO sample](https://github.com/microsoft/Windows-classic-samples/tree/master/Samples/Win7Samples/multimedia/audio/aecmicarray).</span></span>

<span data-ttu-id="6a917-105">DeviceTopology API 可讓用戶端應用程式能夠跨越音訊轉譯和捕獲裝置的功能性硬體拓撲。</span><span class="sxs-lookup"><span data-stu-id="6a917-105">The DeviceTopology API provides client applications with the ability to traverse the functional hardware topologies of audio rendering and capture devices.</span></span> <span data-ttu-id="6a917-106">透過 DeviceTopology API 中的介面和方法，用戶端可以探索功能次單元連接 (例如，沿著 [音訊端點裝置](audio-endpoint-devices.md)的資料路徑中的音量控制) 。</span><span class="sxs-lookup"><span data-stu-id="6a917-106">Through the interfaces and methods in the DeviceTopology API, clients can discover the functional subunits (for example, volume control) that lie along the data paths that lead to and from [audio endpoint devices](audio-endpoint-devices.md).</span></span> <span data-ttu-id="6a917-107">用戶端可以跨越兩個音訊介面卡裝置和音訊端點裝置的內部拓撲，以及跨連線將一部裝置連結至另一個裝置的步驟。</span><span class="sxs-lookup"><span data-stu-id="6a917-107">Clients can traverse the internal topologies of both audio adapter devices and audio endpoint devices and step across the connections that link one device to another.</span></span> <span data-ttu-id="6a917-108">如需詳細資訊，請參閱 [裝置拓撲](device-topologies.md)。</span><span class="sxs-lookup"><span data-stu-id="6a917-108">For more information, see [Device Topologies](device-topologies.md).</span></span>

<span data-ttu-id="6a917-109">標頭檔 Devicetopology 會定義 DeviceTopology API 中的介面。</span><span class="sxs-lookup"><span data-stu-id="6a917-109">Header file Devicetopology.h defines the interfaces in the DeviceTopology API.</span></span>

<span data-ttu-id="6a917-110">若要存取 DeviceTopology API 介面，用戶端會先依照下列步驟取得音訊端點裝置的 [**IDeviceTopology**](/windows/desktop/api/Devicetopology/nn-devicetopology-idevicetopology) 介面參考：</span><span class="sxs-lookup"><span data-stu-id="6a917-110">To access the DeviceTopology API interfaces, a client first obtains a reference to the [**IDeviceTopology**](/windows/desktop/api/Devicetopology/nn-devicetopology-idevicetopology) interface for an audio endpoint device by following these steps:</span></span>

1.  <span data-ttu-id="6a917-111">使用 [**IMMDevice 介面**](/windows/desktop/api/Mmdeviceapi/nn-mmdeviceapi-immdevice)中所述的其中一種技術，取得音訊端點裝置的 **IMMDevice** 介面參考。</span><span class="sxs-lookup"><span data-stu-id="6a917-111">By using one of the techniques described in [**IMMDevice Interface**](/windows/desktop/api/Mmdeviceapi/nn-mmdeviceapi-immdevice), obtain a reference to the **IMMDevice** interface for an audio endpoint device.</span></span>
2.  <span data-ttu-id="6a917-112">呼叫 [**IMMDevice：： Activate**](/windows/desktop/api/Mmdeviceapi/nf-mmdeviceapi-immdevice-activate) 方法，並將參數 *Iid* 設定為 **REFIID** iid \_ IDeviceTopology。</span><span class="sxs-lookup"><span data-stu-id="6a917-112">Call the [**IMMDevice::Activate**](/windows/desktop/api/Mmdeviceapi/nf-mmdeviceapi-immdevice-activate) method with parameter *iid* set to **REFIID** IID\_IDeviceTopology.</span></span>

<span data-ttu-id="6a917-113">用戶端可以藉由呼叫 [**IDeviceTopology**](/windows/desktop/api/Devicetopology/nn-devicetopology-idevicetopology) 介面中的方法，取得 DeviceTopology API 中其他介面的參考。</span><span class="sxs-lookup"><span data-stu-id="6a917-113">The client can obtain references to the other interfaces in the DeviceTopology API by calling the methods in the [**IDeviceTopology**](/windows/desktop/api/Devicetopology/nn-devicetopology-idevicetopology) interface.</span></span>

<span data-ttu-id="6a917-114">DeviceTopology API 會執行下列介面。</span><span class="sxs-lookup"><span data-stu-id="6a917-114">The DeviceTopology API implements the following interfaces.</span></span>



| <span data-ttu-id="6a917-115">介面</span><span class="sxs-lookup"><span data-stu-id="6a917-115">Interface</span></span>                                                  | <span data-ttu-id="6a917-116">描述</span><span class="sxs-lookup"><span data-stu-id="6a917-116">Description</span></span>                                                                                                                                                                                                               |
|------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="6a917-117">**IAudioAutoGainControl**</span><span class="sxs-lookup"><span data-stu-id="6a917-117">**IAudioAutoGainControl**</span></span>](/windows/desktop/api/Devicetopology/nn-devicetopology-iaudioautogaincontrol)     | <span data-ttu-id="6a917-118">提供硬體自動增益控制 (AGC) 的存取權。</span><span class="sxs-lookup"><span data-stu-id="6a917-118">Provides access to a hardware automatic gain control (AGC).</span></span>                                                                                                                                                               |
| [<span data-ttu-id="6a917-119">**IAudioBass**</span><span class="sxs-lookup"><span data-stu-id="6a917-119">**IAudioBass**</span></span>](/windows/win32/api/devicetopology/nn-devicetopology-iaudiobass)                           | <span data-ttu-id="6a917-120">提供硬體低音等級控制項的存取權。</span><span class="sxs-lookup"><span data-stu-id="6a917-120">Provides access to a hardware bass-level control.</span></span>                                                                                                                                                                         |
| [<span data-ttu-id="6a917-121">**IAudioChannelConfig**</span><span class="sxs-lookup"><span data-stu-id="6a917-121">**IAudioChannelConfig**</span></span>](/windows/desktop/api/Devicetopology/nn-devicetopology-iaudiochannelconfig)         | <span data-ttu-id="6a917-122">提供硬體通道配置控制項的存取權。</span><span class="sxs-lookup"><span data-stu-id="6a917-122">Provides access to a hardware channel-configuration control.</span></span>                                                                                                                                                              |
| [<span data-ttu-id="6a917-123">**IAudioInputSelector**</span><span class="sxs-lookup"><span data-stu-id="6a917-123">**IAudioInputSelector**</span></span>](/windows/desktop/api/Devicetopology/nn-devicetopology-iaudioinputselector)         | <span data-ttu-id="6a917-124">提供硬體多工器控制項 (輸入選取器) 的存取權。</span><span class="sxs-lookup"><span data-stu-id="6a917-124">Provides access to a hardware multiplexer control (input selector).</span></span>                                                                                                                                                       |
| [<span data-ttu-id="6a917-125">**IAudioLoudness**</span><span class="sxs-lookup"><span data-stu-id="6a917-125">**IAudioLoudness**</span></span>](/windows/desktop/api/Devicetopology/nn-devicetopology-iaudioloudness)                   | <span data-ttu-id="6a917-126">提供對 "音量" 補償控制項的存取。</span><span class="sxs-lookup"><span data-stu-id="6a917-126">Provides access to a "loudness" compensation control.</span></span>                                                                                                                                                                     |
| [<span data-ttu-id="6a917-127">**IAudioMidrange**</span><span class="sxs-lookup"><span data-stu-id="6a917-127">**IAudioMidrange**</span></span>](/windows/win32/api/devicetopology/nn-devicetopology-iaudiomidrange)                   | <span data-ttu-id="6a917-128">提供硬體中型層級控制項的存取權。</span><span class="sxs-lookup"><span data-stu-id="6a917-128">Provides access to a hardware midrange-level control.</span></span>                                                                                                                                                                     |
| [<span data-ttu-id="6a917-129">**IAudioMute**</span><span class="sxs-lookup"><span data-stu-id="6a917-129">**IAudioMute**</span></span>](/windows/desktop/api/Devicetopology/nn-devicetopology-iaudiomute)                           | <span data-ttu-id="6a917-130">提供硬體靜音控制項的存取。</span><span class="sxs-lookup"><span data-stu-id="6a917-130">Provides access to a hardware mute control.</span></span>                                                                                                                                                                               |
| [<span data-ttu-id="6a917-131">**IAudioOutputSelector**</span><span class="sxs-lookup"><span data-stu-id="6a917-131">**IAudioOutputSelector**</span></span>](/windows/desktop/api/Devicetopology/nn-devicetopology-iaudiooutputselector)       | <span data-ttu-id="6a917-132">提供硬體信號信號控制 (輸出選取器) 的存取權。</span><span class="sxs-lookup"><span data-stu-id="6a917-132">Provides access to a hardware demultiplexer control (output selector).</span></span>                                                                                                                                                    |
| [<span data-ttu-id="6a917-133">**IAudioPeakMeter**</span><span class="sxs-lookup"><span data-stu-id="6a917-133">**IAudioPeakMeter**</span></span>](/windows/desktop/api/Devicetopology/nn-devicetopology-iaudiopeakmeter)                 | <span data-ttu-id="6a917-134">提供硬體尖峰計量控制項的存取權。</span><span class="sxs-lookup"><span data-stu-id="6a917-134">Provides access to a hardware peak-meter control.</span></span>                                                                                                                                                                         |
| [<span data-ttu-id="6a917-135">**IAudioTreble**</span><span class="sxs-lookup"><span data-stu-id="6a917-135">**IAudioTreble**</span></span>](/windows/win32/api/devicetopology/nn-devicetopology-iaudiotreble)                       | <span data-ttu-id="6a917-136">提供硬體高音層級控制項的存取。</span><span class="sxs-lookup"><span data-stu-id="6a917-136">Provides access to a hardware treble-level control.</span></span>                                                                                                                                                                       |
| [<span data-ttu-id="6a917-137">**IAudioVolumeLevel**</span><span class="sxs-lookup"><span data-stu-id="6a917-137">**IAudioVolumeLevel**</span></span>](/windows/win32/api/devicetopology/nn-devicetopology-iaudiovolumelevel)             | <span data-ttu-id="6a917-138">提供硬體磁片區控制項的存取權。</span><span class="sxs-lookup"><span data-stu-id="6a917-138">Provides access to a hardware volume control.</span></span>                                                                                                                                                                             |
| [<span data-ttu-id="6a917-139">**IConnector**</span><span class="sxs-lookup"><span data-stu-id="6a917-139">**IConnector**</span></span>](/windows/desktop/api/Devicetopology/nn-devicetopology-iconnector)                           | <span data-ttu-id="6a917-140">表示元件之間的連接點。</span><span class="sxs-lookup"><span data-stu-id="6a917-140">Represents a point of connection between components.</span></span>                                                                                                                                                                      |
| [<span data-ttu-id="6a917-141">**IControlInterface**</span><span class="sxs-lookup"><span data-stu-id="6a917-141">**IControlInterface**</span></span>](/windows/desktop/api/Devicetopology/nn-devicetopology-icontrolinterface)             | <span data-ttu-id="6a917-142">代表元件上的控制項介面， (子或連接器) 。</span><span class="sxs-lookup"><span data-stu-id="6a917-142">Represents a control interface on a part (subunit or connector).</span></span>                                                                                                                                                          |
| [<span data-ttu-id="6a917-143">**IDeviceSpecificProperty**</span><span class="sxs-lookup"><span data-stu-id="6a917-143">**IDeviceSpecificProperty**</span></span>](/windows/desktop/api/Devicetopology/nn-devicetopology-idevicespecificproperty) | <span data-ttu-id="6a917-144">代表連接器或子單位的裝置特定屬性。</span><span class="sxs-lookup"><span data-stu-id="6a917-144">Represents a device-specific property of a connector or subunit.</span></span>                                                                                                                                                          |
| [<span data-ttu-id="6a917-145">**IDeviceTopology**</span><span class="sxs-lookup"><span data-stu-id="6a917-145">**IDeviceTopology**</span></span>](/windows/desktop/api/Devicetopology/nn-devicetopology-idevicetopology)                 | <span data-ttu-id="6a917-146">提供對音訊裝置拓撲的存取。</span><span class="sxs-lookup"><span data-stu-id="6a917-146">Provides access to the topology of an audio device.</span></span>                                                                                                                                                                       |
| [<span data-ttu-id="6a917-147">**IKsFormatSupport**</span><span class="sxs-lookup"><span data-stu-id="6a917-147">**IKsFormatSupport**</span></span>](/windows/desktop/api/Devicetopology/nn-devicetopology-iksformatsupport)               | <span data-ttu-id="6a917-148">提供有關軟體設定的 i/o 連線所支援之音訊資料格式的資訊 (通常是音訊裝置和系統記憶體之間) DMA 通道。</span><span class="sxs-lookup"><span data-stu-id="6a917-148">Provides information about the audio data formats that are supported by a software-configured I/O connection (typically a DMA channel) between the audio device and system memory.</span></span>                                        |
| [<span data-ttu-id="6a917-149">**IKsJackDescription**</span><span class="sxs-lookup"><span data-stu-id="6a917-149">**IKsJackDescription**</span></span>](/windows/desktop/api/Devicetopology/nn-devicetopology-iksjackdescription)           | <span data-ttu-id="6a917-150">提供有關插座或內部連接器的資訊，這些連接器會提供音訊介面卡上裝置與外部或內部端點裝置之間的實體連線 (例如麥克風或 CD 播放機) 。</span><span class="sxs-lookup"><span data-stu-id="6a917-150">Provides information about the jacks or internal connectors that provide a physical connection between a device on an audio adapter and an external or internal endpoint device (for example, a microphone or CD player).</span></span> |
| [<span data-ttu-id="6a917-151">**IPart**</span><span class="sxs-lookup"><span data-stu-id="6a917-151">**IPart**</span></span>](/windows/desktop/api/Devicetopology/nn-devicetopology-ipart)                                     | <span data-ttu-id="6a917-152">代表裝置拓撲的部分 (連接器或次級) 。</span><span class="sxs-lookup"><span data-stu-id="6a917-152">Represents a part (connector or subunit) of a device topology.</span></span>                                                                                                                                                            |
| [<span data-ttu-id="6a917-153">**IPartsList**</span><span class="sxs-lookup"><span data-stu-id="6a917-153">**IPartsList**</span></span>](/windows/desktop/api/Devicetopology/nn-devicetopology-ipartslist)                           | <span data-ttu-id="6a917-154">代表 (連接器和次單元連接) 的部分清單。</span><span class="sxs-lookup"><span data-stu-id="6a917-154">Represents a list of parts (connectors and subunits).</span></span>                                                                                                                                                                     |
| [<span data-ttu-id="6a917-155">**IPerChannelDbLevel**</span><span class="sxs-lookup"><span data-stu-id="6a917-155">**IPerChannelDbLevel**</span></span>](/windows/desktop/api/Devicetopology/nn-devicetopology-iperchanneldblevel)           | <span data-ttu-id="6a917-156">代表泛型次級控制項介面，可針對音訊串流的音量層級或音訊串流中的頻率寬線，提供每個通道的控制。</span><span class="sxs-lookup"><span data-stu-id="6a917-156">Represents a generic subunit control interface that provides per-channel control over the volume level, in decibels, of an audio stream or of a frequency band in an audio stream.</span></span>                                        |
| [<span data-ttu-id="6a917-157">**ISubunit**</span><span class="sxs-lookup"><span data-stu-id="6a917-157">**ISubunit**</span></span>](/windows/win32/api/devicetopology/nn-devicetopology-isubunit)                               | <span data-ttu-id="6a917-158">代表硬體子單位 (例如，位於用戶端和音訊端點裝置之間的資料路徑中的磁片區層級控制) 。</span><span class="sxs-lookup"><span data-stu-id="6a917-158">Represents a hardware subunit (for example, a volume-level control) that lies in the data path between a client and an audio endpoint device.</span></span>                                                                             |



 

<span data-ttu-id="6a917-159">在連接器和次單元連接中需要控制項變更事件通知的 DeviceTopology API 用戶端應該執行下列介面。</span><span class="sxs-lookup"><span data-stu-id="6a917-159">DeviceTopology API clients that require notification of control-change events in connectors and subunits should implement the following interface.</span></span>



| <span data-ttu-id="6a917-160">介面</span><span class="sxs-lookup"><span data-stu-id="6a917-160">Interface</span></span>                                            | <span data-ttu-id="6a917-161">描述</span><span class="sxs-lookup"><span data-stu-id="6a917-161">Description</span></span>                                                                      |
|------------------------------------------------------|----------------------------------------------------------------------------------|
| [<span data-ttu-id="6a917-162">**IControlChangeNotify**</span><span class="sxs-lookup"><span data-stu-id="6a917-162">**IControlChangeNotify**</span></span>](/windows/desktop/api/Devicetopology/nn-devicetopology-icontrolchangenotify) | <span data-ttu-id="6a917-163">當元件 (連接器或子) 的狀態變更時，會提供通知。</span><span class="sxs-lookup"><span data-stu-id="6a917-163">Provides notifications when the status of a part (connector or subunit) changes.</span></span> |



 

## <a name="related-topics"></a><span data-ttu-id="6a917-164">相關主題</span><span class="sxs-lookup"><span data-stu-id="6a917-164">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="6a917-165">裝置拓撲</span><span class="sxs-lookup"><span data-stu-id="6a917-165">Device Topologies</span></span>](device-topologies.md)
</dt> <dt>

[<span data-ttu-id="6a917-166">**程式設計參考**</span><span class="sxs-lookup"><span data-stu-id="6a917-166">**Programming Reference**</span></span>](programming-reference.md)
</dt> </dl>

 

 
