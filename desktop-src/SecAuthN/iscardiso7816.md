---
description: ISCardISO7816 介面提供執行 ISO 7816-4 功能的方法。
ms.assetid: c940c44f-0556-48ef-91f4-502f4c0dfc02
title: 'ISCardISO7816 介面 (Scardssp .h) '
ms.topic: reference
ms.date: 05/31/2018
topic_type:
- APIRef
- kbSyntax
api_name:
- ISCardISO7816
api_type:
- COM
api_location:
- Scardssp.dll
ms.openlocfilehash: 09e5dc9e84a36148e240e4ba2d31f04216454994
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/07/2021
ms.locfileid: "103692936"
---
# <a name="iscardiso7816-interface"></a><span data-ttu-id="9cdf9-103">ISCardISO7816 介面</span><span class="sxs-lookup"><span data-stu-id="9cdf9-103">ISCardISO7816 interface</span></span>

<span data-ttu-id="9cdf9-104">\[**ISCardISO7816** 介面可用於 [需求] 區段中指定的作業系統。</span><span class="sxs-lookup"><span data-stu-id="9cdf9-104">\[The **ISCardISO7816** interface is available for use in the operating systems specified in the Requirements section.</span></span> <span data-ttu-id="9cdf9-105">它無法在 Windows Server 2003 （含 Service Pack 1） (SP1) 和更新版本、Windows Vista、Windows Server 2008 和後續版本的作業系統中使用。</span><span class="sxs-lookup"><span data-stu-id="9cdf9-105">It is not available for use in Windows Server 2003 with Service Pack 1 (SP1) and later, Windows Vista, Windows Server 2008, and subsequent versions of the operating system.</span></span> <span data-ttu-id="9cdf9-106">[智慧卡模組](/previous-versions/windows/desktop/secsmart/smart-card-modules)提供類似的功能。\]</span><span class="sxs-lookup"><span data-stu-id="9cdf9-106">The [Smart Card Modules](/previous-versions/windows/desktop/secsmart/smart-card-modules) provide similar functionality.\]</span></span>

<span data-ttu-id="9cdf9-107">**ISCardISO7816** 介面提供執行 ISO 7816-4 功能的方法。</span><span class="sxs-lookup"><span data-stu-id="9cdf9-107">The **ISCardISO7816** interface provides methods for implementing ISO 7816-4 functionality.</span></span> <span data-ttu-id="9cdf9-108">除了 [**SetDefaultClassId**](iscardiso7816-setdefaultclassid.md)之外，這些方法會建立封裝于 [**ISCardCmd**](iscardcmd.md)物件中的 [*應用程式協定資料單位*](../secgloss/a-gly.md) (APDU) 命令。</span><span class="sxs-lookup"><span data-stu-id="9cdf9-108">With the exception of [**SetDefaultClassId**](iscardiso7816-setdefaultclassid.md), these methods create an [*application protocol data unit*](../secgloss/a-gly.md) (APDU) command that is encapsulated in a [**ISCardCmd**](iscardcmd.md) object.</span></span>

<span data-ttu-id="9cdf9-109">ISO 7816-4 規格定義了 [*智慧卡*](../secgloss/s-gly.md)上可用的標準命令。</span><span class="sxs-lookup"><span data-stu-id="9cdf9-109">The ISO 7816-4 specification defines standard commands available on [*smart cards*](../secgloss/s-gly.md).</span></span> <span data-ttu-id="9cdf9-110">此規格也定義了智慧卡 APDU 命令的建立方式，以及如何將它傳送至智慧卡以執行。</span><span class="sxs-lookup"><span data-stu-id="9cdf9-110">The specification also defines how a smart card APDU command should be constructed and sent to the smart card for execution.</span></span> <span data-ttu-id="9cdf9-111">此介面會將建立程式自動化。</span><span class="sxs-lookup"><span data-stu-id="9cdf9-111">This interface automates the building process.</span></span>

<span data-ttu-id="9cdf9-112">下列範例顯示 **ISCardISO7816** 介面的一般用法。</span><span class="sxs-lookup"><span data-stu-id="9cdf9-112">The following example shows a typical use of the **ISCardISO7816** interface.</span></span> <span data-ttu-id="9cdf9-113">在此情況下， **ISCardISO7816** 介面會用來建立 APDU 命令。</span><span class="sxs-lookup"><span data-stu-id="9cdf9-113">In this case, the **ISCardISO7816** interface is used to build an APDU command.</span></span>

<span data-ttu-id="9cdf9-114">**將交易提交至特定卡片**</span><span class="sxs-lookup"><span data-stu-id="9cdf9-114">**To submit a transaction to a specific card**</span></span>

1.  <span data-ttu-id="9cdf9-115">建立 **ISCardISO7816** 和 [**ISCardCmd**](iscardcmd.md) 介面。</span><span class="sxs-lookup"><span data-stu-id="9cdf9-115">Create an **ISCardISO7816** and [**ISCardCmd**](iscardcmd.md) interface.</span></span>

    <span data-ttu-id="9cdf9-116">[**ISCardCmd**](iscardcmd.md)介面是用來封裝 APDU。</span><span class="sxs-lookup"><span data-stu-id="9cdf9-116">The [**ISCardCmd**](iscardcmd.md) interface is used to encapsulate the APDU.</span></span>

2.  <span data-ttu-id="9cdf9-117">呼叫 **ISCardISO7816** 介面的適當方法，並傳遞必要的參數和 [**ISCardCmd**](iscardcmd.md) 介面指標。</span><span class="sxs-lookup"><span data-stu-id="9cdf9-117">Call the appropriate method of the **ISCardISO7816** interface, passing the required parameters and the [**ISCardCmd**](iscardcmd.md) interface pointer.</span></span>

    <span data-ttu-id="9cdf9-118">ISO 7816-4 APDU 命令將會建立並封裝在 [**ISCardCmd**](iscardcmd.md) 介面中。</span><span class="sxs-lookup"><span data-stu-id="9cdf9-118">The ISO 7816-4 APDU command will be built and encapsulated in the [**ISCardCmd**](iscardcmd.md) interface.</span></span>

3.  <span data-ttu-id="9cdf9-119">釋放 **ISCardISO7816** 和 [**ISCardCmd**](iscardcmd.md) 介面。</span><span class="sxs-lookup"><span data-stu-id="9cdf9-119">Release the **ISCardISO7816** and [**ISCardCmd**](iscardcmd.md) interfaces.</span></span>

> [!Note]  
> <span data-ttu-id="9cdf9-120">在 [方法參考] 頁面中，如果未定義資料表中的位序列，則會假設該位序列已保留供日後使用或專屬給特定的供應商使用。</span><span class="sxs-lookup"><span data-stu-id="9cdf9-120">In the method reference pages, if a bit sequence in a table is not defined, assume that bit sequence is reserved for future use or proprietary to a specific vendor.</span></span>

 

## <a name="members"></a><span data-ttu-id="9cdf9-121">成員</span><span class="sxs-lookup"><span data-stu-id="9cdf9-121">Members</span></span>

<span data-ttu-id="9cdf9-122">**ISCardISO7816** 介面繼承自 [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch)介面。</span><span class="sxs-lookup"><span data-stu-id="9cdf9-122">The **ISCardISO7816** interface inherits from the [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) interface.</span></span> <span data-ttu-id="9cdf9-123">**ISCardISO7816** 也有下列類型的成員：</span><span class="sxs-lookup"><span data-stu-id="9cdf9-123">**ISCardISO7816** also has these types of members:</span></span>

-   [<span data-ttu-id="9cdf9-124">方法</span><span class="sxs-lookup"><span data-stu-id="9cdf9-124">Methods</span></span>](#methods)

### <a name="methods"></a><span data-ttu-id="9cdf9-125">方法</span><span class="sxs-lookup"><span data-stu-id="9cdf9-125">Methods</span></span>

<span data-ttu-id="9cdf9-126">**ISCardISO7816** 介面具有這些方法。</span><span class="sxs-lookup"><span data-stu-id="9cdf9-126">The **ISCardISO7816** interface has these methods.</span></span>



| <span data-ttu-id="9cdf9-127">方法</span><span class="sxs-lookup"><span data-stu-id="9cdf9-127">Method</span></span>                                                             | <span data-ttu-id="9cdf9-128">描述</span><span class="sxs-lookup"><span data-stu-id="9cdf9-128">Description</span></span>                                                                                                                                                                                                                                                                                                        |
|:-------------------------------------------------------------------|:-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="9cdf9-129">**AppendRecord**</span><span class="sxs-lookup"><span data-stu-id="9cdf9-129">**AppendRecord**</span></span>](iscardiso7816-appendrecord.md)                 | <span data-ttu-id="9cdf9-130">建立命令，以將記錄附加到基本檔 (EF) 的結尾。</span><span class="sxs-lookup"><span data-stu-id="9cdf9-130">Constructs a command that appends a record to the end of an elementary file (EF).</span></span><br/>                                                                                                                                                                                                                       |
| [<span data-ttu-id="9cdf9-131">**EraseBinary**</span><span class="sxs-lookup"><span data-stu-id="9cdf9-131">**EraseBinary**</span></span>](iscardiso7816-erasebinary.md)                   | <span data-ttu-id="9cdf9-132">從指定的位移開始，依序將 EF 的部分內容設定為其邏輯清除狀態。</span><span class="sxs-lookup"><span data-stu-id="9cdf9-132">Sets part of the content of an EF to its logical erased state, sequentially, starting from a given offset.</span></span><br/>                                                                                                                                                                                              |
| [<span data-ttu-id="9cdf9-133">**ExternalAuthenticate**</span><span class="sxs-lookup"><span data-stu-id="9cdf9-133">**ExternalAuthenticate**</span></span>](iscardiso7816-externalauthenticate.md) | <span data-ttu-id="9cdf9-134">根據卡片先前發出的挑戰，有條件地使用卡片計算的結果來更新安全性狀態 (例如，這些 INS 會 \_ 取得 \_ 挑戰命令) 、可能儲存在卡片中的秘密金鑰，以及介面裝置所傳送的驗證資料。</span><span class="sxs-lookup"><span data-stu-id="9cdf9-134">Conditionally updates the security status using the result of the computation by the card, based on a challenge previously issued by the card (for example, by the INS\_GET\_CHALLENGE command), a possibly secret key stored in the card, and authentication data transmitted by the interface device.</span></span><br/> |
| [<span data-ttu-id="9cdf9-135">**GetChallenge**</span><span class="sxs-lookup"><span data-stu-id="9cdf9-135">**GetChallenge**</span></span>](iscardiso7816-getchallenge.md)                 | <span data-ttu-id="9cdf9-136">需要發出在安全性相關程式中使用的挑戰。</span><span class="sxs-lookup"><span data-stu-id="9cdf9-136">Requires the issuing of a challenge for use in a security-related procedure.</span></span><br/>                                                                                                                                                                                                                            |
| [<span data-ttu-id="9cdf9-137">**GetData**</span><span class="sxs-lookup"><span data-stu-id="9cdf9-137">**GetData**</span></span>](iscardiso7816-getdata.md)                           | <span data-ttu-id="9cdf9-138">根據指定的檔案類型，抓取一個基本資料物件或一組包含在結構化資料物件中的資料物件。</span><span class="sxs-lookup"><span data-stu-id="9cdf9-138">Retrieves a single primitive data object or a set of data objects contained in a constructed data object, based on the type of file specified.</span></span><br/>                                                                                                                                                          |
| [<span data-ttu-id="9cdf9-139">**GetResponse**</span><span class="sxs-lookup"><span data-stu-id="9cdf9-139">**GetResponse**</span></span>](iscardiso7816-getresponse.md)                   | <span data-ttu-id="9cdf9-140">從卡片傳輸至介面裝置 Apdu，否則無法由可用的通訊協定傳輸。</span><span class="sxs-lookup"><span data-stu-id="9cdf9-140">Transmits from the card to the interface device APDUs that otherwise could not be transmitted by the available protocols.</span></span><br/>                                                                                                                                                                               |
| [<span data-ttu-id="9cdf9-141">**InternalAuthenticate**</span><span class="sxs-lookup"><span data-stu-id="9cdf9-141">**InternalAuthenticate**</span></span>](iscardiso7816-internalauthenticate.md) | <span data-ttu-id="9cdf9-142">使用從介面裝置傳送的挑戰資料和儲存在卡片中的相關密碼，來起始卡片的驗證資料的計算。</span><span class="sxs-lookup"><span data-stu-id="9cdf9-142">Initiates the computation of the authentication data by the card using the challenge data sent from the interface device and a relevant secret stored in the card.</span></span><br/>                                                                                                                                      |
| [<span data-ttu-id="9cdf9-143">**ManageChannel**</span><span class="sxs-lookup"><span data-stu-id="9cdf9-143">**ManageChannel**</span></span>](iscardiso7816-managechannel.md)               | <span data-ttu-id="9cdf9-144">開啟並關閉邏輯通道。</span><span class="sxs-lookup"><span data-stu-id="9cdf9-144">Opens and closes logical channels.</span></span><br/>                                                                                                                                                                                                                                                                      |
| [<span data-ttu-id="9cdf9-145">**PutData**</span><span class="sxs-lookup"><span data-stu-id="9cdf9-145">**PutData**</span></span>](iscardiso7816-putdata.md)                           | <span data-ttu-id="9cdf9-146">在目前的 [*資源管理員內容*](../secgloss/r-gly.md)中，儲存一個基本資料物件，或一個或多個包含在結構化資料物件中的資料物件。</span><span class="sxs-lookup"><span data-stu-id="9cdf9-146">Stores one primitive data object, or one or more data objects contained in a constructed data object, within the current [*resource manager context*](../secgloss/r-gly.md).</span></span><br/>                                                    |
| [<span data-ttu-id="9cdf9-147">**ReadBinary**</span><span class="sxs-lookup"><span data-stu-id="9cdf9-147">**ReadBinary**</span></span>](iscardiso7816-readbinary.md)                     | <span data-ttu-id="9cdf9-148">建立命令，此命令會取得回應訊息，以提供具有透明結構之 EF 內容的一部分。</span><span class="sxs-lookup"><span data-stu-id="9cdf9-148">Constructs a command that acquires a response message that gives that part of the contents of an EF with transparent structure.</span></span><br/>                                                                                                                                                                         |
| [<span data-ttu-id="9cdf9-149">**ReadRecord**</span><span class="sxs-lookup"><span data-stu-id="9cdf9-149">**ReadRecord**</span></span>](iscardiso7816-readrecord.md)                     | <span data-ttu-id="9cdf9-150">會建立一個命令，以讀取基本檔案的指定記錄內容。</span><span class="sxs-lookup"><span data-stu-id="9cdf9-150">Constructs a command that reads the contents of the specified records of an elementary file.</span></span><br/>                                                                                                                                                                                                            |
| [<span data-ttu-id="9cdf9-151">**SelectFile**</span><span class="sxs-lookup"><span data-stu-id="9cdf9-151">**SelectFile**</span></span>](iscardiso7816-selectfile.md)                     | <span data-ttu-id="9cdf9-152">在邏輯通道中設定目前的檔案。</span><span class="sxs-lookup"><span data-stu-id="9cdf9-152">Sets a current file within a logical channel.</span></span><br/>                                                                                                                                                                                                                                                           |
| [<span data-ttu-id="9cdf9-153">**SetDefaultClassId**</span><span class="sxs-lookup"><span data-stu-id="9cdf9-153">**SetDefaultClassId**</span></span>](iscardiso7816-setdefaultclassid.md)       | <span data-ttu-id="9cdf9-154">指派標準類別識別碼位元組，此位元組將在建立 ISO 7816-4 命令 APDU 時用於所有作業中。</span><span class="sxs-lookup"><span data-stu-id="9cdf9-154">Assigns a standard class ID byte that will be used in all operations when constructing an ISO 7816-4 command APDU.</span></span><br/>                                                                                                                                                                                      |
| [<span data-ttu-id="9cdf9-155">**UpdateBinary**</span><span class="sxs-lookup"><span data-stu-id="9cdf9-155">**UpdateBinary**</span></span>](iscardiso7816-updatebinary.md)                 | <span data-ttu-id="9cdf9-156">使用命令 APDU 中提供的位，起始 EF 中已經存在的位更新。</span><span class="sxs-lookup"><span data-stu-id="9cdf9-156">Initiates the update of the bits already present in an EF with the bits given in the command APDU.</span></span><br/>                                                                                                                                                                                                      |
| [<span data-ttu-id="9cdf9-157">**UpdateRecord**</span><span class="sxs-lookup"><span data-stu-id="9cdf9-157">**UpdateRecord**</span></span>](iscardiso7816-updaterecord.md)                 | <span data-ttu-id="9cdf9-158">建立命令，此命令會起始特定記錄的更新。</span><span class="sxs-lookup"><span data-stu-id="9cdf9-158">Constructs a command that initiates the updating of a specific record.</span></span><br/>                                                                                                                                                                                                                                  |
| [<span data-ttu-id="9cdf9-159">**驗證**</span><span class="sxs-lookup"><span data-stu-id="9cdf9-159">**Verify**</span></span>](iscardiso7816-verify.md)                             | <span data-ttu-id="9cdf9-160">使用卡片中儲存的參考資料，在從介面裝置傳送的驗證數據卡中起始比較。</span><span class="sxs-lookup"><span data-stu-id="9cdf9-160">Initiates the comparison in the card of the verification data sent from the interface device with the reference data stored in the card.</span></span><br/>                                                                                                                                                                |
| [<span data-ttu-id="9cdf9-161">**WriteBinary**</span><span class="sxs-lookup"><span data-stu-id="9cdf9-161">**WriteBinary**</span></span>](iscardiso7816-writebinary.md)                   | <span data-ttu-id="9cdf9-162">起始將二進位值寫入至 EF 的程式。</span><span class="sxs-lookup"><span data-stu-id="9cdf9-162">Initiates the writing of binary values into an EF.</span></span><br/>                                                                                                                                                                                                                                                      |
| [<span data-ttu-id="9cdf9-163">**WriteRecord**</span><span class="sxs-lookup"><span data-stu-id="9cdf9-163">**WriteRecord**</span></span>](iscardiso7816-writerecord.md)                   | <span data-ttu-id="9cdf9-164">建立可寫入記錄的命令。</span><span class="sxs-lookup"><span data-stu-id="9cdf9-164">Constructs a command that writes a record.</span></span><br/>                                                                                                                                                                                                                                                              |



 

## <a name="requirements"></a><span data-ttu-id="9cdf9-165">規格需求</span><span class="sxs-lookup"><span data-stu-id="9cdf9-165">Requirements</span></span>



| <span data-ttu-id="9cdf9-166">需求</span><span class="sxs-lookup"><span data-stu-id="9cdf9-166">Requirement</span></span> | <span data-ttu-id="9cdf9-167">值</span><span class="sxs-lookup"><span data-stu-id="9cdf9-167">Value</span></span> |
|-------------------------------------|-----------------------------------------------------------------------------------------|
| <span data-ttu-id="9cdf9-168">最低支援的用戶端</span><span class="sxs-lookup"><span data-stu-id="9cdf9-168">Minimum supported client</span></span><br/> | <span data-ttu-id="9cdf9-169">\[僅限 WINDOWS XP desktop 應用程式\]</span><span class="sxs-lookup"><span data-stu-id="9cdf9-169">Windows XP \[desktop apps only\]</span></span><br/>                                             |
| <span data-ttu-id="9cdf9-170">最低支援的伺服器</span><span class="sxs-lookup"><span data-stu-id="9cdf9-170">Minimum supported server</span></span><br/> | <span data-ttu-id="9cdf9-171">僅限 Windows Server 2003 \[ desktop 應用程式\]</span><span class="sxs-lookup"><span data-stu-id="9cdf9-171">Windows Server 2003 \[desktop apps only\]</span></span><br/>                                    |
| <span data-ttu-id="9cdf9-172">用戶端支援結束</span><span class="sxs-lookup"><span data-stu-id="9cdf9-172">End of client support</span></span><br/>    | <span data-ttu-id="9cdf9-173">Windows XP</span><span class="sxs-lookup"><span data-stu-id="9cdf9-173">Windows XP</span></span><br/>                                                                   |
| <span data-ttu-id="9cdf9-174">伺服器支援結束</span><span class="sxs-lookup"><span data-stu-id="9cdf9-174">End of server support</span></span><br/>    | <span data-ttu-id="9cdf9-175">Windows Server 2003</span><span class="sxs-lookup"><span data-stu-id="9cdf9-175">Windows Server 2003</span></span><br/>                                                          |
| <span data-ttu-id="9cdf9-176">標頭</span><span class="sxs-lookup"><span data-stu-id="9cdf9-176">Header</span></span><br/>                   | <dl> <span data-ttu-id="9cdf9-177"><dt>Scardssp。h</dt></span><span class="sxs-lookup"><span data-stu-id="9cdf9-177"><dt>Scardssp.h</dt></span></span> </dl>   |
| <span data-ttu-id="9cdf9-178">類型程式庫</span><span class="sxs-lookup"><span data-stu-id="9cdf9-178">Type library</span></span><br/>             | <dl> <span data-ttu-id="9cdf9-179"><dt>Scardsrv .tlb</dt></span><span class="sxs-lookup"><span data-stu-id="9cdf9-179"><dt>Scardsrv.tlb</dt></span></span> </dl> |
| <span data-ttu-id="9cdf9-180">DLL</span><span class="sxs-lookup"><span data-stu-id="9cdf9-180">DLL</span></span><br/>                      | <dl> <span data-ttu-id="9cdf9-181"><dt>Scardssp.dll</dt></span><span class="sxs-lookup"><span data-stu-id="9cdf9-181"><dt>Scardssp.dll</dt></span></span> </dl> |
| <span data-ttu-id="9cdf9-182">IID</span><span class="sxs-lookup"><span data-stu-id="9cdf9-182">IID</span></span><br/>                      | <span data-ttu-id="9cdf9-183">IID \_ ISCardISO7816 定義為53B6AA68-3F56-11D0-916B-00AA00C18068</span><span class="sxs-lookup"><span data-stu-id="9cdf9-183">IID\_ISCardISO7816 is defined as 53B6AA68-3F56-11D0-916B-00AA00C18068</span></span><br/>        |



 

 
