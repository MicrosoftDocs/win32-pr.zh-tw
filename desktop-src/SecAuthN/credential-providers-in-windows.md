---
description: Windows 10 中的認證提供者
ms.assetid: BCF69196-D4E4-41D0-B372-5000FD50164B
title: Windows 10 中的認證提供者
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 12a7947000e5d5a989f71dcdddd808a8e1d5ab3f
ms.sourcegitcommit: cd9672511263d04c0e4bc41758dd1d9e89ea92b4
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/29/2021
ms.locfileid: "104321307"
---
# <a name="credential-providers-in-windows-10"></a><span data-ttu-id="3b464-103">Windows 10 中的認證提供者</span><span class="sxs-lookup"><span data-stu-id="3b464-103">Credential Providers in Windows 10</span></span>

<span data-ttu-id="3b464-104">認證提供者是使用者驗證的主要機制，它們目前是唯一的方法，可讓使用者證明登入和其他系統驗證案例所需的身分識別。</span><span class="sxs-lookup"><span data-stu-id="3b464-104">Credential providers are the primary mechanism for user authentication—they currently are the only method for users to prove their identity which is required for logon and other system authentication scenarios.</span></span> <span data-ttu-id="3b464-105">使用 Windows 10 和引入 Microsoft Passport，認證提供者比以往更重要;這些應用程式會用來驗證應用程式、網站等等。</span><span class="sxs-lookup"><span data-stu-id="3b464-105">With Windows 10 and the introduction of Microsoft Passport, credential providers are more important than ever; they will be used for authentication into apps, websites, and more.</span></span>

<span data-ttu-id="3b464-106">Microsoft 提供各種不同的認證提供者作為 Windows 的一部分，例如密碼、PIN、智慧卡和 Windows Hello (指紋、臉部和鳶尾花辨識) 。</span><span class="sxs-lookup"><span data-stu-id="3b464-106">Microsoft provides a variety of credential providers as part of Windows, such as password, PIN, smartcard, and Windows Hello (Fingerprint, Face, and Iris recognition).</span></span> <span data-ttu-id="3b464-107">在本文中，這些稱為「系統認證提供者」。</span><span class="sxs-lookup"><span data-stu-id="3b464-107">These are referred to as "system credential providers" in this article.</span></span> <span data-ttu-id="3b464-108">Oem、企業和其他實體可以撰寫自己的認證提供者，並輕鬆地將其整合到 Windows 中。</span><span class="sxs-lookup"><span data-stu-id="3b464-108">OEMs, Enterprises, and other entities can write their own credential providers and integrate them easily into Windows.</span></span> <span data-ttu-id="3b464-109">在本文中，這些稱為「協力廠商認證提供者」。</span><span class="sxs-lookup"><span data-stu-id="3b464-109">These are referred to as "third-party credential providers" in this article.</span></span> <span data-ttu-id="3b464-110">請注意，Windows 10 中支援 V1 和 V2 認證提供者。</span><span class="sxs-lookup"><span data-stu-id="3b464-110">Note that both V1 and V2 credential providers are supported in Windows 10.</span></span> <span data-ttu-id="3b464-111">協力廠商認證提供者的建立者和管理員必須瞭解這些建議。</span><span class="sxs-lookup"><span data-stu-id="3b464-111">It is important for creators and managers of third-party credential providers to understand these recommendations.</span></span>

## <a name="system-credential-providers"></a><span data-ttu-id="3b464-112">系統認證提供者</span><span class="sxs-lookup"><span data-stu-id="3b464-112">System credential providers</span></span>

<span data-ttu-id="3b464-113">強烈建議裝置上的每個使用者，除了任何協力廠商認證提供者之外，一律至少有一個可用的系統認證提供者。</span><span class="sxs-lookup"><span data-stu-id="3b464-113">We strongly recommend that there always be at least one system credential provider available for every user on the device in addition to any third-party credential providers.</span></span> <span data-ttu-id="3b464-114">此外，在協力廠商認證提供者的設定期間，如果沒有其他可用的修復選項，則裝置上的每個使用者都應該會提示至少設定一個系統認證提供者 (;請參閱以下) 的案例 A。</span><span class="sxs-lookup"><span data-stu-id="3b464-114">Additionally, during the set-up of the third-party credential provider, each user on the device should be prompted to set up at least one system credential provider (if no other recovery options are available; see Scenario A, below).</span></span>

### <a name="scenario-a"></a><span data-ttu-id="3b464-115">案例 A</span><span class="sxs-lookup"><span data-stu-id="3b464-115">Scenario A</span></span>

<span data-ttu-id="3b464-116">本機帳戶使用者已設定協力廠商認證提供者，並會定期使用它來登入裝置。</span><span class="sxs-lookup"><span data-stu-id="3b464-116">A local account user has set up a third-party credential provider and regularly uses it to log into the device.</span></span> <span data-ttu-id="3b464-117">一天，使用者會將某些更新安裝到中斷協力廠商認證提供者的裝置，而且使用者在重新開機電腦之前不會察覺到這項變更。</span><span class="sxs-lookup"><span data-stu-id="3b464-117">One day, the user installs some update to the device that breaks the third-party credential provider, and the user is unaware of this change before restarting the machine.</span></span>

<span data-ttu-id="3b464-118">在下次重新開機時，使用者會在登入畫面上，而且無法使用預期的協力廠商認證提供者。</span><span class="sxs-lookup"><span data-stu-id="3b464-118">On the next restart, the user is on the logon screen and is unable to use the expected third-party credential provider.</span></span> <span data-ttu-id="3b464-119">如果使用者已設定系統認證提供者，使用者將能夠使用它登入電腦。</span><span class="sxs-lookup"><span data-stu-id="3b464-119">If the user has set up a system credential provider, the user will be able to log into the machine using it.</span></span> <span data-ttu-id="3b464-120">如果沒有，使用者就無法復原電腦上的帳戶。</span><span class="sxs-lookup"><span data-stu-id="3b464-120">If not, the user has no way to recover the account on the machine.</span></span>

### <a name="scenario-b"></a><span data-ttu-id="3b464-121">案例 B</span><span class="sxs-lookup"><span data-stu-id="3b464-121">Scenario B</span></span>

<span data-ttu-id="3b464-122">MSA/AD/AAD 帳戶使用者已設定協力廠商認證提供者，並會定期使用它來登入裝置。</span><span class="sxs-lookup"><span data-stu-id="3b464-122">An MSA/AD/AAD account user has set up a third-party credential provider and regularly uses it to log into the device.</span></span> <span data-ttu-id="3b464-123">一天，使用者會將某些更新安裝到中斷協力廠商認證提供者的裝置，而且使用者在重新開機電腦之前不會察覺到這項變更。</span><span class="sxs-lookup"><span data-stu-id="3b464-123">One day, the user installs some update to the device that breaks the third -party credential provider, and the user is unaware of this change before restarting the machine.</span></span>

<span data-ttu-id="3b464-124">在下次重新開機時，使用者會在登入畫面上，而且無法使用預期的協力廠商認證提供者。</span><span class="sxs-lookup"><span data-stu-id="3b464-124">On the next restart, the user is on the logon screen and is unable to use the expected third-party credential provider.</span></span> <span data-ttu-id="3b464-125">如果使用者已設定系統認證提供者，使用者將能夠使用它登入電腦。</span><span class="sxs-lookup"><span data-stu-id="3b464-125">If the user has set up a system credential provider, the user will be able to log into the machine using it.</span></span> <span data-ttu-id="3b464-126">或者，如果系統的密碼認證提供者可供使用，則使用者可以從遠端要求/重設密碼，並使用它來登入電腦。</span><span class="sxs-lookup"><span data-stu-id="3b464-126">Alternatively, if the system's password credential provider is available, the user can remotely request/reset the password and use that to log into the machine.</span></span> <span data-ttu-id="3b464-127">如果沒有可用的選項，使用者就無法復原電腦上的帳戶。</span><span class="sxs-lookup"><span data-stu-id="3b464-127">If neither option is available, the user has no way to recover the account on the machine.</span></span>

### <a name="conclusion"></a><span data-ttu-id="3b464-128">結論</span><span class="sxs-lookup"><span data-stu-id="3b464-128">Conclusion</span></span>

<span data-ttu-id="3b464-129">總而言之，我們想要防止停用裝置上的所有系統認證提供者。</span><span class="sxs-lookup"><span data-stu-id="3b464-129">In summary, we want to discourage the disabling of all system credential providers on a device.</span></span> <span data-ttu-id="3b464-130">雖然協力廠商認證提供者可以滿足特定使用者群組的其他驗證需求，但請務必確保使用者隨時都能在發生重大變更時重新取得電腦的存取權。</span><span class="sxs-lookup"><span data-stu-id="3b464-130">While third-party credential providers may fulfill additional authentication requirements for particular groups of users, it is very important to ensure that the user can always regain access to their machine when a breaking change occurs.</span></span> <span data-ttu-id="3b464-131">系統認證提供者會提供此保證。</span><span class="sxs-lookup"><span data-stu-id="3b464-131">System credential providers provide this guarantee.</span></span>

## <a name="custom-credential-providers"></a><span data-ttu-id="3b464-132">自訂認證提供者</span><span class="sxs-lookup"><span data-stu-id="3b464-132">Custom credential providers</span></span>

<span data-ttu-id="3b464-133">Windows 認證提供者架構可讓開發人員建立自訂認證提供者。</span><span class="sxs-lookup"><span data-stu-id="3b464-133">The Windows credential provider framework enables developers to create custom credential providers.</span></span> <span data-ttu-id="3b464-134">當 [Winlogon](winlogon.md) 想要收集認證時，登入 UI 會查詢每個認證提供者，以瞭解其想要列舉的認證數目。</span><span class="sxs-lookup"><span data-stu-id="3b464-134">When [Winlogon](winlogon.md) wants to collect credentials, the Logon UI queries each credential provider for the number of credentials that it wishes to enumerate.</span></span> <span data-ttu-id="3b464-135">當所有提供者都列舉其磚之後，登入 UI 就會向使用者顯示。</span><span class="sxs-lookup"><span data-stu-id="3b464-135">After all providers have enumerated their tiles, the Logon UI displays them to the user.</span></span> <span data-ttu-id="3b464-136">然後，使用者會與磚互動以提供必要的認證。</span><span class="sxs-lookup"><span data-stu-id="3b464-136">The user then interacts with a tile to supply the necessary credentials.</span></span> <span data-ttu-id="3b464-137">登入 UI 會提交這些認證以進行驗證。</span><span class="sxs-lookup"><span data-stu-id="3b464-137">The Logon UI submits these credentials for authentication.</span></span> <span data-ttu-id="3b464-138">認證提供者也可以在需要認證時由認證 UI 使用。</span><span class="sxs-lookup"><span data-stu-id="3b464-138">Credential providers can also be used by the Credential UI when credentials are necessary.</span></span> <span data-ttu-id="3b464-139">請參閱 [**認證 \_ 提供者 \_ 使用 \_ 案例**](/windows/desktop/api/credentialprovider/ne-credentialprovider-credential_provider_usage_scenario) ，以取得可支援認證提供者的案例清單。</span><span class="sxs-lookup"><span data-stu-id="3b464-139">See [**CREDENTIAL\_PROVIDER\_USAGE\_SCENARIO**](/windows/desktop/api/credentialprovider/ne-credentialprovider-credential_provider_usage_scenario) for a list of scenarios where a credential provider can be supported.</span></span>

<span data-ttu-id="3b464-140">感謝這個系統，建立比以往更容易的認證提供者。</span><span class="sxs-lookup"><span data-stu-id="3b464-140">Thanks to this system, it is much easier to create a credential provider than it was historically.</span></span> <span data-ttu-id="3b464-141">大部分的工作都是由 [Winlogon](winlogon.md)、登入 UI 和認證 ui 的組合來處理。</span><span class="sxs-lookup"><span data-stu-id="3b464-141">Much of the work is handled by the combination of [Winlogon](winlogon.md), the Logon UI and the Credential UI.</span></span> <span data-ttu-id="3b464-142">若要這樣做，您必須建立自己的 [**ICredentialProvider**](/windows/desktop/api/credentialprovider/nn-credentialprovider-icredentialprovider) 和 [**ICredentialProviderCredential**](/windows/desktop/api/credentialprovider/nn-credentialprovider-icredentialprovidercredential)執行。</span><span class="sxs-lookup"><span data-stu-id="3b464-142">In order to do so, you will need to create your own implementation of [**ICredentialProvider**](/windows/desktop/api/credentialprovider/nn-credentialprovider-icredentialprovider) and [**ICredentialProviderCredential**](/windows/desktop/api/credentialprovider/nn-credentialprovider-icredentialprovidercredential).</span></span> <span data-ttu-id="3b464-143">如果您正在執行 V2 認證提供者，建議您也需要執行 [**ICredentialProviderCredential2**](/windows/desktop/api/credentialprovider/nn-credentialprovider-icredentialprovidercredential2)。</span><span class="sxs-lookup"><span data-stu-id="3b464-143">If you are implementing a V2 credential provider, which is recommended, you will also need to implement [**ICredentialProviderCredential2**](/windows/desktop/api/credentialprovider/nn-credentialprovider-icredentialprovidercredential2).</span></span>

<span data-ttu-id="3b464-144">請務必注意，認證提供者不是強制性機制。</span><span class="sxs-lookup"><span data-stu-id="3b464-144">It is important to note that credential providers are not enforcement mechanisms.</span></span> <span data-ttu-id="3b464-145">它們只是用來收集和序列化認證，並提交認證以供授權之用。</span><span class="sxs-lookup"><span data-stu-id="3b464-145">They are simply used to gather and serialize credentials, submitting them for authorization.</span></span> <span data-ttu-id="3b464-146">本機授權單位和驗證套件將會處理，以及任何必要的安全性強制。</span><span class="sxs-lookup"><span data-stu-id="3b464-146">The local authority and authentication packages will handle and any necessary security enforcement.</span></span>

<span data-ttu-id="3b464-147">結合認證提供者與支援的硬體，您可以擴充 Windows 以支援使用生物識別資訊、密碼、Pin、智慧卡憑證或您選擇建立的任何自訂驗證套件來進行登入。</span><span class="sxs-lookup"><span data-stu-id="3b464-147">Combining credential providers with supported hardware, you can extend Windows to support logging on with biometric information, passwords, PINs, Smart Card certificates, or any custom authentication package you choose to create.</span></span> <span data-ttu-id="3b464-148">您也可以透過各種方式自訂使用者的登入體驗。</span><span class="sxs-lookup"><span data-stu-id="3b464-148">You can customize the logon experience for the user in a variety of ways as well.</span></span> <span data-ttu-id="3b464-149">例如，當登入 UI 查詢認證提供者的認證提供者時，您可以指定預設磚來為使用者提供自訂的體驗。</span><span class="sxs-lookup"><span data-stu-id="3b464-149">For example, when the Logon UI queries your credential provider for the credential tiles, you can specify a default tile to provide a customized experience for a user.</span></span> <span data-ttu-id="3b464-150">認證提供者甚至可以設計成支援單一登入 (SSO) 、驗證使用者對安全存取點以及電腦登入。</span><span class="sxs-lookup"><span data-stu-id="3b464-150">Credential providers can even be designed to support single sign on (SSO), authenticating users to a secure access point as well as machine logon.</span></span>

<span data-ttu-id="3b464-151">認證提供者會在 Windows 電腦上註冊，並負責下列各項。</span><span class="sxs-lookup"><span data-stu-id="3b464-151">Credential providers are registered on a Windows machine and are responsible for the following.</span></span>

-   <span data-ttu-id="3b464-152">描述驗證所需的認證資訊。</span><span class="sxs-lookup"><span data-stu-id="3b464-152">Describing the credential information required for authentication.</span></span>
-   <span data-ttu-id="3b464-153">使用任何外部驗證授權單位處理通訊和邏輯。</span><span class="sxs-lookup"><span data-stu-id="3b464-153">Handling the communication and logic with any external authentication authorities.</span></span>
-   <span data-ttu-id="3b464-154">封裝互動式和網路登入的認證。</span><span class="sxs-lookup"><span data-stu-id="3b464-154">Packaging the credentials for interactive and network logon.</span></span>

> [!TIP]
>
> <span data-ttu-id="3b464-155">請記住，您可以在單一電腦上安裝多個認證提供者。</span><span class="sxs-lookup"><span data-stu-id="3b464-155">Keep in mind that multiple credential providers can be installed on a single machine.</span></span>

## <a name="wrapping-credential-providers"></a><span data-ttu-id="3b464-156">包裝認證提供者</span><span class="sxs-lookup"><span data-stu-id="3b464-156">Wrapping credential providers</span></span>

<span data-ttu-id="3b464-157">若要將功能加入至非原生支援的認證提供者，可以完成包裝系統認證提供者。</span><span class="sxs-lookup"><span data-stu-id="3b464-157">Wrapping a system credential provider can be done to add functionality to that credential provider that is not natively supported.</span></span> <span data-ttu-id="3b464-158">不建議這麼做，因為它可能會導致有問題的行為。</span><span class="sxs-lookup"><span data-stu-id="3b464-158">This is not recommended because it can lead to problematic behavior.</span></span> <span data-ttu-id="3b464-159">您可以對認證提供者進行變更，這可能會與包裝函式發生衝突，而導致使用者體驗不佳，甚至讓使用者無法進入其裝置。</span><span class="sxs-lookup"><span data-stu-id="3b464-159">Changes can be made to the credential provider which may conflict with the wrapper causing a poor user experience or even preventing the user from getting into their device.</span></span> <span data-ttu-id="3b464-160">這特別適用于 Windows 10 頻繁的更新步調。</span><span class="sxs-lookup"><span data-stu-id="3b464-160">This is especially true with the frequent update cadence of Windows 10.</span></span>

<span data-ttu-id="3b464-161">如果需要認證提供者中未以原生方式包含的功能，建議的路徑是建立自訂認證提供者。</span><span class="sxs-lookup"><span data-stu-id="3b464-161">If functionality in a credential provider is needed that is not included natively, the recommended path is to create a custom credential provider.</span></span> <span data-ttu-id="3b464-162">這是更穩定的方法，不會依賴系統提供者。</span><span class="sxs-lookup"><span data-stu-id="3b464-162">This is a more stable approach that does not take dependencies on the system providers.</span></span>

## <a name="related-topics"></a><span data-ttu-id="3b464-163">相關主題</span><span class="sxs-lookup"><span data-stu-id="3b464-163">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="3b464-164">認證提供者驅動的 Windows 登入體驗</span><span class="sxs-lookup"><span data-stu-id="3b464-164">Credential Provider driven Windows Logon Experience</span></span>](https://go.microsoft.com/fwlink/?LinkId=717287)
</dt> <dt>

[<span data-ttu-id="3b464-165">ICredentialProvider</span><span class="sxs-lookup"><span data-stu-id="3b464-165">ICredentialProvider</span></span>](/windows/desktop/api/credentialprovider/nn-credentialprovider-icredentialprovider)
</dt> <dt>

[<span data-ttu-id="3b464-166">認證 \_ 提供者 \_ 認證 \_ 序列化</span><span class="sxs-lookup"><span data-stu-id="3b464-166">CREDENTIAL\_PROVIDER\_CREDENTIAL\_SERIALIZATION</span></span>](/windows/desktop/api/credentialprovider/ns-credentialprovider-credential_provider_credential_serialization)
</dt> <dt>

[<span data-ttu-id="3b464-167">認證 \_ 提供者 \_ 使用 \_ 案例</span><span class="sxs-lookup"><span data-stu-id="3b464-167">CREDENTIAL\_PROVIDER\_USAGE\_SCENARIO</span></span>](/windows/desktop/api/credentialprovider/ne-credentialprovider-credential_provider_usage_scenario)
</dt> </dl>

 

 
