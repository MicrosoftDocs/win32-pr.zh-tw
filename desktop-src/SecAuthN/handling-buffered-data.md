---
description: 有幾個網路提供者函式會採用緩衝區的位址和大小，而函式會將變數大小的資料結構放在其中。
ms.assetid: 0029a04d-6cf2-40e1-ae1d-4c349a379ad7
title: 處理緩衝的資料
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 63e123fc1ccccae6120b6db1c9ada554acc5b02a
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/08/2021
ms.locfileid: "104194079"
---
# <a name="handling-buffered-data"></a>處理緩衝的資料

有幾個網路提供者函式會採用緩衝區的位址和大小，而函式會將變數大小的資料結構放在其中。

在每個案例中，使用的機制都相同。 呼叫端會配置緩衝區，並將其位址傳遞至函式。 它也會傳遞指定緩衝區大小的 **DWORD** 位址（以位元組為單位）。

然後，此函式會將所要求的資料結構盡可能複製到緩衝區中。 如果所有資料都符合緩衝區，此函式會傳回 WN \_ SUCCESS。 如果資料不符合緩衝區，資料可能會保持不完整，且函式會設定 WN \_ 更多的 \_ 資料錯誤。 在任一種情況下，表示緩衝區大小的 **DWORD** 會設定為資料結構實際需要的位元組數目。 如此一來，如果傳入的緩衝區太小，且函式失敗，則呼叫端可能會配置所需大小的新緩衝區，並再次呼叫函式。

當傳回的資料結構包含可變長度的字串時，個別的資料結構通常會包含這些字串的指標。 字串本身也應放置在緩衝區內。 不過，請務必將它們放在緩衝區的結尾。 否則，它們會讓第 n 個結構的索引不可能發生。 換句話說，所有結構都是在緩衝區的開頭連續找出。 字串或變數長度資料的指標必須是實際指標，而不是緩衝區的位移。

當緩衝區用來傳入並傳回只包含字串的資料時，指定緩衝區大小的 **DWORD** 應該設定為這些字串中的總字元數，而不是位元組數。

 

 



