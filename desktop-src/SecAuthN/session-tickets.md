---
description: KDC 不會將加密的工作階段金鑰傳送給這兩個主體，而是會將用戶端和伺服器的工作階段金鑰複本傳送給用戶端。
ms.assetid: 6b20ab30-2cd9-4f2e-a26b-316980c4bc78
title: 會話票證
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 762223311dd71f8bded5e021372d3a281f711eda
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/07/2021
ms.locfileid: "106980831"
---
# <a name="session-tickets"></a>會話票證

[KDC](key-distribution-center.md)不會將加密的工作階段金鑰傳送給這兩個主體，而是會將用戶端和伺服器的 [*工作階段金鑰*](../secgloss/s-gly.md)複本傳送給用戶端。 用戶端的工作階段金鑰複本會使用用戶端的 [*主要金鑰*](../secgloss/m-gly.md) 進行加密，因此無法由任何其他實體解密。 在名為票證的資料結構中，會內嵌伺服器的工作階段金鑰複本，以及用戶端的授權資料。 票證已完全以伺服器的主要金鑰加密，因此無法由用戶端或沒有伺服器主要金鑰存取權的任何其他實體讀取或變更。 用戶端必須負責安全地儲存票證，直到與伺服器聯繫為止。

> [!Note]  
> KDC 只提供票證授與服務。 用戶端和伺服器會負責維護各自的主要金鑰安全。

 

當用戶端收到 KDC 的回應時，它會將票證和自己的工作階段金鑰複本解壓縮，並放在安全的快取中。 若要建立與伺服器的安全會話，它會傳送包含票證的訊息，並以伺服器的主要金鑰加密，以及使用工作階段金鑰加密的 [驗證器訊息](authenticator-messages.md) 。 票證和驗證器訊息會一起是用戶端對伺服器的 [*認證*](../secgloss/c-gly.md) 。

當伺服器接收來自用戶端的認證時，它會使用其 [*主要金鑰*](../secgloss/m-gly.md)來解密票證、將 [*工作階段金鑰*](../secgloss/s-gly.md)解壓縮，並使用工作階段金鑰來解密用戶端的驗證器訊息。 如果所有專案都已簽出，伺服器會知道用戶端的認證是由 KDC （受信任的授權單位）發出。 針對相互驗證，伺服器會使用工作階段金鑰，從用戶端的驗證器訊息加密時間戳記，以進行回應。 此加密訊息會傳送至用戶端。 然後，用戶端會解密訊息。 如果傳回的訊息與原始驗證者訊息中的時間戳記相同，則會驗證服務器。

除了額外的優點之外，伺服器還不需要儲存與其用戶端搭配使用的工作階段金鑰。 每個用戶端都必須負責管理其票證快取中的伺服器票證，並在每次存取伺服器時呈現該票證。 只要伺服器收到來自用戶端的票證，它就會使用其主要金鑰來解密票證，並將工作階段金鑰解壓縮。 當伺服器不再需要工作階段金鑰時，就會刪除該金鑰。

用戶端不需要在每次需要存取此特定伺服器的情況下存取 KDC。 您可以重複使用票證。 為了預防票證遭竊的可能性，票證的到期時間是由票證結構中的 KDC 指定。 票證的有效時間長短取決於領域的 Kerberos 原則。 一般來說，票證的良好時間不超過八小時，而是一般 [*登入會話*](../secgloss/l-gly.md)的長度。 當用戶端工作站上的使用者登出時，會清除用戶端票證快取，並終結所有票證和用戶端工作階段金鑰。

 

 
