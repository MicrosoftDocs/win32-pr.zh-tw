---
description: 內容需求是以傳遞給 InitializeSecurityCoNtext (一般) 或 AcceptSecurityCoNtext (一般) 函式的位旗標組合來表示。
ms.assetid: 4a44b829-4202-46c0-b17e-04943fa067ab
title: 內容需求
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 86af5f71557bdd53229b5c8ed6afc14dc24edb46
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/08/2021
ms.locfileid: "104193281"
---
# <a name="context-requirements"></a><span data-ttu-id="4f115-103">內容需求</span><span class="sxs-lookup"><span data-stu-id="4f115-103">Context Requirements</span></span>

<span data-ttu-id="4f115-104">內容需求是以傳遞給 [**InitializeSecurityCoNtext (一般)**](/windows/win32/api/sspi/nf-sspi-initializesecuritycontexta) 或 [**AcceptSecurityCoNtext (一般)**](/windows/win32/api/sspi/nf-sspi-acceptsecuritycontext) 函式的位旗標組合來表示。</span><span class="sxs-lookup"><span data-stu-id="4f115-104">Context requirements are expressed as a combination of bit flags passed to either the [**InitializeSecurityContext (General)**](/windows/win32/api/sspi/nf-sspi-initializesecuritycontexta) or [**AcceptSecurityContext (General)**](/windows/win32/api/sspi/nf-sspi-acceptsecuritycontext) function.</span></span> <span data-ttu-id="4f115-105">這些旗標會以數種方式影響 [*內容*](/windows/desktop/SecGloss/c-gly) 。</span><span class="sxs-lookup"><span data-stu-id="4f115-105">These flags affect the [*context*](/windows/desktop/SecGloss/c-gly) in a number of ways.</span></span> <span data-ttu-id="4f115-106">並非所有旗標都適用于所有內容。</span><span class="sxs-lookup"><span data-stu-id="4f115-106">Not all flags apply to all contexts.</span></span> <span data-ttu-id="4f115-107">有些只適用于伺服器，其他只適用于用戶端。</span><span class="sxs-lookup"><span data-stu-id="4f115-107">Some are valid only for the server, others only for the client.</span></span>

<span data-ttu-id="4f115-108">呼叫端會使用 [**InitializeSecurityCoNtext (一般)**](/windows/win32/api/sspi/nf-sspi-initializesecuritycontexta)的 *FCoNtextReq* 參數或 [**AcceptSecurityCoNtext (一般)**](/windows/win32/api/sspi/nf-sspi-acceptsecuritycontext)呼叫來指定一組表示所需功能的旗標。</span><span class="sxs-lookup"><span data-stu-id="4f115-108">The caller uses the *fContextReq* parameter of the [**InitializeSecurityContext (General)**](/windows/win32/api/sspi/nf-sspi-initializesecuritycontexta) or [**AcceptSecurityContext (General)**](/windows/win32/api/sspi/nf-sspi-acceptsecuritycontext) call to specify a set of flags that indicate the required capabilities.</span></span> <span data-ttu-id="4f115-109">當函式傳回時， *pfCoNtextAttr* 參數會指出已建立之內容的屬性。</span><span class="sxs-lookup"><span data-stu-id="4f115-109">When the function returns, the *pfContextAttr* parameter indicates the attributes of the established context.</span></span> <span data-ttu-id="4f115-110">呼叫端會判斷是否可接受最終的內容屬性。</span><span class="sxs-lookup"><span data-stu-id="4f115-110">The caller determines whether the final context attributes are acceptable.</span></span>

<span data-ttu-id="4f115-111">[**InitializeSecurityCoNtext (一般)**](/windows/win32/api/sspi/nf-sspi-initializesecuritycontexta)所要求或傳回的旗標會以 ISC 作為前置詞。</span><span class="sxs-lookup"><span data-stu-id="4f115-111">Flags requested from or returned by [**InitializeSecurityContext (General)**](/windows/win32/api/sspi/nf-sspi-initializesecuritycontexta) are prefixed by ISC.</span></span> <span data-ttu-id="4f115-112">[**AcceptSecurityCoNtext (一般)**](/windows/win32/api/sspi/nf-sspi-acceptsecuritycontext)所要求或傳回的要求，會前面加上 ASC。</span><span class="sxs-lookup"><span data-stu-id="4f115-112">Those requested from or returned by [**AcceptSecurityContext (General)**](/windows/win32/api/sspi/nf-sspi-acceptsecuritycontext) are prefixed by ASC.</span></span> <span data-ttu-id="4f115-113">傳遞至函式的旗標包含需求，而傳回的旗標則包含 RET。</span><span class="sxs-lookup"><span data-stu-id="4f115-113">Flags passed into a function include REQ, while returned flags include RET.</span></span> <span data-ttu-id="4f115-114">例如，傳遞給 **InitializeSecurityCoNtext (一般)** 的雙向驗證要求旗標是 ISC 要求 \_ 的 \_ 相互 \_ 驗證。</span><span class="sxs-lookup"><span data-stu-id="4f115-114">For example, a request flag for mutual authentication passed to **InitializeSecurityContext (General)** is ISC\_REQ\_MUTUAL\_AUTH.</span></span> <span data-ttu-id="4f115-115">要求相互驗證的伺服器會將 ASC 要求 \_ \_ 相互 \_ 驗證傳遞給 **AcceptSecurityCoNtext (一般)**。</span><span class="sxs-lookup"><span data-stu-id="4f115-115">A server requesting mutual authentication passes ASC\_REQ\_MUTUAL\_AUTH to **AcceptSecurityContext (General)**.</span></span> <span data-ttu-id="4f115-116">如果達到相互驗證， **InitializeSecurityCoNtext (一般)** 會傳回 ISC \_ ret \_ 相互驗證 \_ 和 **ACCEPTSECURITYCONTEXT (一般)** 會傳回 ASC \_ ret \_ 相互 \_ 驗證。</span><span class="sxs-lookup"><span data-stu-id="4f115-116">If mutual authentication is achieved, **InitializeSecurityContext (General)** returns ISC\_RET\_MUTUAL\_AUTH and **AcceptSecurityContext (General)** returns ASC\_RET\_MUTUAL\_AUTH.</span></span> <span data-ttu-id="4f115-117">如果呼叫端要求相互驗證，但 [*安全性封裝*](/windows/desktop/SecGloss/s-gly) 指出無法執行，則呼叫端必須決定是否要取消內容或繼續。</span><span class="sxs-lookup"><span data-stu-id="4f115-117">If the caller requests mutual authentication, but the [*security package*](/windows/desktop/SecGloss/s-gly) indicates that it cannot be performed, the caller must decide whether to cancel the context or continue.</span></span>

<span data-ttu-id="4f115-118">下表說明各種內容需求旗標。</span><span class="sxs-lookup"><span data-stu-id="4f115-118">The following table describes the various context requirement flags.</span></span>



| <span data-ttu-id="4f115-119">旗標</span><span class="sxs-lookup"><span data-stu-id="4f115-119">Flag</span></span>                             | <span data-ttu-id="4f115-120">描述</span><span class="sxs-lookup"><span data-stu-id="4f115-120">Description</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
|----------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="4f115-121">委託</span><span class="sxs-lookup"><span data-stu-id="4f115-121">DELEGATE</span></span><br/>              | <span data-ttu-id="4f115-122">傳輸應用程式中的伺服器可以建立新的安全性內容，模擬用戶端將被其他伺服器接受的用戶端內容。</span><span class="sxs-lookup"><span data-stu-id="4f115-122">The server in the transport application can build new security contexts impersonating the client that will be accepted by other servers as the client's contexts.</span></span> <span data-ttu-id="4f115-123">只有在 \_ 設定了相互驗證時，委派才能運作。</span><span class="sxs-lookup"><span data-stu-id="4f115-123">Delegate works only if MUTUAL\_AUTH is set.</span></span> <span data-ttu-id="4f115-124">目前只有 [*Kerberos*](/windows/desktop/SecGloss/k-gly)才支援委派。</span><span class="sxs-lookup"><span data-stu-id="4f115-124">DELEGATE is currently supported only by [*Kerberos*](/windows/desktop/SecGloss/k-gly).</span></span> <span data-ttu-id="4f115-125">此外，Kerberos 只會委派給有旗標受信任委派的 \_ 伺服器 \_ 。</span><span class="sxs-lookup"><span data-stu-id="4f115-125">Further, Kerberos will delegate only to a server that has the flag TRUSTED\_FOR\_DELEGATION.</span></span> <span data-ttu-id="4f115-126">請勿將此旗標用於 [*限制委派*](/windows/desktop/SecGloss/c-gly)。</span><span class="sxs-lookup"><span data-stu-id="4f115-126">Do not use this flag for [*constrained delegation*](/windows/desktop/SecGloss/c-gly).</span></span><br/> |
| <span data-ttu-id="4f115-127">相互 \_ 驗證</span><span class="sxs-lookup"><span data-stu-id="4f115-127">MUTUAL\_AUTH</span></span><br/>          | <span data-ttu-id="4f115-128">通訊方必須彼此驗證其身分識別。</span><span class="sxs-lookup"><span data-stu-id="4f115-128">The communicating parties must authenticate their identities to each other.</span></span> <span data-ttu-id="4f115-129">如果沒有相互 \_ 驗證，用戶端會向伺服器驗證其身分識別。</span><span class="sxs-lookup"><span data-stu-id="4f115-129">Without MUTUAL\_AUTH, the client authenticates its identity to the server.</span></span> <span data-ttu-id="4f115-130">透過相互 \_ 驗證，伺服器也必須向用戶端驗證其身分識別。</span><span class="sxs-lookup"><span data-stu-id="4f115-130">With MUTUAL\_AUTH, the server also must authenticate its identity to the client.</span></span><br/> <span data-ttu-id="4f115-131">使用 [*安全通道*](/windows/desktop/SecGloss/s-gly)安全性套件時，伺服器只會在 [**AcceptSecurityCoNtext (協商)**](/windows/win32/api/sspi/nf-sspi-acceptsecuritycontext)的最後一個呼叫中，設定 **ASC \_ RET \_ 相互 \_ 驗證** 常數，之後才能順利完成憑證對應。</span><span class="sxs-lookup"><span data-stu-id="4f115-131">When using the [*Schannel*](/windows/desktop/SecGloss/s-gly) security package, the server sets the **ASC\_RET\_MUTUAL\_AUTH** constant only in the last call to [**AcceptSecurityContext (Negotiate)**](/windows/win32/api/sspi/nf-sspi-acceptsecuritycontext), after certificate mapping has successfully completed.</span></span><br/>           |
| <span data-ttu-id="4f115-132">重新執行偵測 \_</span><span class="sxs-lookup"><span data-stu-id="4f115-132">REPLAY\_DETECT</span></span><br/>        | <span data-ttu-id="4f115-133">[*安全性封裝*](/windows/desktop/SecGloss/s-gly)會偵測重新執行的封包，並在重新執行封包時通知呼叫者。</span><span class="sxs-lookup"><span data-stu-id="4f115-133">The [*security package*](/windows/desktop/SecGloss/s-gly) detects replayed packets and notifies the caller if a packet has been replayed.</span></span> <span data-ttu-id="4f115-134">使用此旗標表示完整性旗標所指定的所有條件。</span><span class="sxs-lookup"><span data-stu-id="4f115-134">The use of this flag implies all of the conditions specified by the INTEGRITY flag.</span></span><br/>                                                                                                                                                                                                                                                                                                                      |
| <span data-ttu-id="4f115-135">順序 \_ 偵測</span><span class="sxs-lookup"><span data-stu-id="4f115-135">SEQUENCE\_DETECT</span></span><br/>      | <span data-ttu-id="4f115-136">您稍後必須透過訊息支援函式，允許內容偵測封包的順序傳遞。</span><span class="sxs-lookup"><span data-stu-id="4f115-136">The context must be allowed to detect out-of-order delivery of packets later through the message support functions.</span></span> <span data-ttu-id="4f115-137">使用此旗標表示完整性旗標所指定的所有條件。</span><span class="sxs-lookup"><span data-stu-id="4f115-137">Use of this flag implies all of the conditions specified by the INTEGRITY flag.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                             |
| <span data-ttu-id="4f115-138">保密</span><span class="sxs-lookup"><span data-stu-id="4f115-138">CONFIDENTIALITY</span></span><br/>       | <span data-ttu-id="4f115-139">內容可以使用 [**EncryptMessage (一般)**](/windows/win32/api/sspi/nf-sspi-encryptmessage) 和 [**DecryptMessage (一般)**](/windows/win32/api/sspi/nf-sspi-decryptmessage) 函式，來保護傳輸中的資料。</span><span class="sxs-lookup"><span data-stu-id="4f115-139">The context can protect data while in transit using the [**EncryptMessage (General)**](/windows/win32/api/sspi/nf-sspi-encryptmessage) and [**DecryptMessage (General)**](/windows/win32/api/sspi/nf-sspi-decryptmessage) functions.</span></span> <span data-ttu-id="4f115-140">如果為來賓帳戶產生的內容，則機密性旗標無法運作。</span><span class="sxs-lookup"><span data-stu-id="4f115-140">The CONFIDENTIALITY flag does not work if the generated context is for the Guest account.</span></span><br/>                                                                                                                                                                                                                                                                                                      |
| <span data-ttu-id="4f115-141">使用 \_ 會話 \_ 金鑰</span><span class="sxs-lookup"><span data-stu-id="4f115-141">USE\_SESSION\_KEY</span></span><br/>     | <span data-ttu-id="4f115-142">必須協商新的 [*工作階段金鑰*](/windows/desktop/SecGloss/s-gly) 。</span><span class="sxs-lookup"><span data-stu-id="4f115-142">A new [*session key*](/windows/desktop/SecGloss/s-gly) must be negotiated.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| <span data-ttu-id="4f115-143">提示 \_ 輸入 \_ 認證</span><span class="sxs-lookup"><span data-stu-id="4f115-143">PROMPT\_FOR\_CREDS</span></span><br/>    | <span data-ttu-id="4f115-144">如果用戶端是互動式使用者，則安全性套件必須盡可能提示使用者提供適當的 [*認證*](/windows/desktop/SecGloss/c-gly)。</span><span class="sxs-lookup"><span data-stu-id="4f115-144">If the client is an interactive user, the security package must, if possible, prompt the user for the appropriate [*credentials*](/windows/desktop/SecGloss/c-gly).</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                          |
| <span data-ttu-id="4f115-145">使用 \_ 提供的認證 \_</span><span class="sxs-lookup"><span data-stu-id="4f115-145">USE\_SUPPLIED\_CREDS</span></span><br/>  | <span data-ttu-id="4f115-146">封裝特定的認證資訊可在輸入緩衝區中取得。</span><span class="sxs-lookup"><span data-stu-id="4f115-146">Package-specific credential information is available in the input buffer.</span></span> <span data-ttu-id="4f115-147">安全性封裝可以使用這些 [*認證*](/windows/desktop/SecGloss/c-gly) 來驗證連接。</span><span class="sxs-lookup"><span data-stu-id="4f115-147">The security package can use these [*credentials*](/windows/desktop/SecGloss/c-gly) to authenticate the connection.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                |
| <span data-ttu-id="4f115-148">儲存 \_ 提供的認證 \_</span><span class="sxs-lookup"><span data-stu-id="4f115-148">SAVE\_SUPPLIED\_CREDS</span></span><br/> | <span data-ttu-id="4f115-149">提供的認證應使用補充認證進行快取。</span><span class="sxs-lookup"><span data-stu-id="4f115-149">The supplied credentials should be cached with the supplemental credentials.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| <span data-ttu-id="4f115-150">配置 \_ 記憶體</span><span class="sxs-lookup"><span data-stu-id="4f115-150">ALLOCATE\_MEMORY</span></span><br/>      | <span data-ttu-id="4f115-151">[*安全性封裝*](/windows/desktop/SecGloss/s-gly)必須配置記憶體。</span><span class="sxs-lookup"><span data-stu-id="4f115-151">The [*security package*](/windows/desktop/SecGloss/s-gly) must allocate memory.</span></span> <span data-ttu-id="4f115-152">呼叫端最後必須呼叫 [**FreeCoNtextBuffer**](/windows/desktop/api/Sspi/nf-sspi-freecontextbuffer) 函式，以釋放安全性封裝所配置的記憶體。</span><span class="sxs-lookup"><span data-stu-id="4f115-152">The caller must eventually call the [**FreeContextBuffer**](/windows/desktop/api/Sspi/nf-sspi-freecontextbuffer) function to free memory allocated by the security package.</span></span><br/>                                                                                                                                                                                                                                                                                                                      |
| <span data-ttu-id="4f115-153">使用 \_ DCE \_ 樣式</span><span class="sxs-lookup"><span data-stu-id="4f115-153">USE\_DCE\_STYLE</span></span><br/>       | <span data-ttu-id="4f115-154">呼叫端需要三階段驗證 [*交易*](/windows/desktop/SecGloss/t-gly)。</span><span class="sxs-lookup"><span data-stu-id="4f115-154">The caller expects a three-leg authentication [*transaction*](/windows/desktop/SecGloss/t-gly).</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| <span data-ttu-id="4f115-155">傳送</span><span class="sxs-lookup"><span data-stu-id="4f115-155">DATAGRAM</span></span><br/>              | <span data-ttu-id="4f115-156">必須使用 [*資料包*](/windows/desktop/SecGloss/d-gly)語義。</span><span class="sxs-lookup"><span data-stu-id="4f115-156">[*Datagram*](/windows/desktop/SecGloss/d-gly) semantics must be used.</span></span> <span data-ttu-id="4f115-157">如需詳細資訊，請參閱 [資料包環境](datagram-contexts.md)。</span><span class="sxs-lookup"><span data-stu-id="4f115-157">For more information, see [Datagram Contexts](datagram-contexts.md).</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                        |
| <span data-ttu-id="4f115-158">CONNECTION</span><span class="sxs-lookup"><span data-stu-id="4f115-158">CONNECTION</span></span><br/>            | <span data-ttu-id="4f115-159">必須使用連接語義。</span><span class="sxs-lookup"><span data-stu-id="4f115-159">Connection semantics must be used.</span></span> <span data-ttu-id="4f115-160">如需詳細資訊，請參閱 [連線導向的](connection-oriented-contexts.md)內容。</span><span class="sxs-lookup"><span data-stu-id="4f115-160">For more information, see [Connection-Oriented Contexts](connection-oriented-contexts.md).</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| <span data-ttu-id="4f115-161">資料流</span><span class="sxs-lookup"><span data-stu-id="4f115-161">STREAM</span></span><br/>                | <span data-ttu-id="4f115-162">必須使用資料流程語義。</span><span class="sxs-lookup"><span data-stu-id="4f115-162">Stream semantics must be used.</span></span> <span data-ttu-id="4f115-163">如需詳細資訊，請參閱 [資料流程](stream-contexts.md)內容。</span><span class="sxs-lookup"><span data-stu-id="4f115-163">For more information, see [Stream Contexts](stream-contexts.md).</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| <span data-ttu-id="4f115-164">擴充 \_ 錯誤</span><span class="sxs-lookup"><span data-stu-id="4f115-164">EXTENDED\_ERROR</span></span><br/>       | <span data-ttu-id="4f115-165">如果內容失敗，就必須產生對等的錯誤回復訊息。</span><span class="sxs-lookup"><span data-stu-id="4f115-165">Error reply messages for the peer must be generated if the context fails.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| <span data-ttu-id="4f115-166">誠信</span><span class="sxs-lookup"><span data-stu-id="4f115-166">INTEGRITY</span></span><br/>             | <span data-ttu-id="4f115-167">緩衝區完整性可進行驗證，但不會啟用排序或回復偵測。</span><span class="sxs-lookup"><span data-stu-id="4f115-167">Buffer integrity can be verified but no sequencing or reply detection is enabled.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| <span data-ttu-id="4f115-168">無 \_ 完整性</span><span class="sxs-lookup"><span data-stu-id="4f115-168">NO\_INTEGRITY</span></span><br/>         | <span data-ttu-id="4f115-169">已忽略 **完整性** 需求。</span><span class="sxs-lookup"><span data-stu-id="4f115-169">The **INTEGRITY** requirement is ignored.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| <span data-ttu-id="4f115-170">識別</span><span class="sxs-lookup"><span data-stu-id="4f115-170">IDENTIFY</span></span><br/>              | <span data-ttu-id="4f115-171">當伺服器模擬已設定此旗標的內容時，該模擬會產生極有限的存取權。</span><span class="sxs-lookup"><span data-stu-id="4f115-171">When a server impersonates a context that has this flag set, that impersonation yields extremely limited access.</span></span> <span data-ttu-id="4f115-172">使用識別集的模擬是用來驗證用戶端的身分識別。</span><span class="sxs-lookup"><span data-stu-id="4f115-172">Impersonation with IDENTIFY set is used to verify the client's identity.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                       |



 

 

