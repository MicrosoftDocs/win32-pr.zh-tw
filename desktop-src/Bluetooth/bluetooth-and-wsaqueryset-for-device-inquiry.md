---
title: 適用于裝置查詢的藍牙和 WSAQUERYSET
description: 用來協助探索藍牙命名空間（NS BTH）中的裝置和服務 \_ 。
ms.assetid: 0c0d26f7-b6c3-42a9-8c01-118278c381cc
keywords:
- 適用于裝置的藍牙與 WSAQUERYSET 查詢藍牙
- WSAQUERYSET 藍牙，適用于裝置查詢
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 7de7adf8c15907fe539ddac5133df08d68ee7c4f
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/20/2020
ms.locfileid: "103682443"
---
# <a name="bluetooth-and-wsaqueryset-for-device-inquiry"></a><span data-ttu-id="b7c1b-105">適用于裝置查詢的藍牙和 WSAQUERYSET</span><span class="sxs-lookup"><span data-stu-id="b7c1b-105">Bluetooth and WSAQUERYSET for Device Inquiry</span></span>

<span data-ttu-id="b7c1b-106">在 Bluetooth 中， [**WSAQUERYSET**](/windows/desktop/api/winsock2/ns-winsock2-wsaquerysetw) 結構是用來協助探索藍牙命名空間 NS BTH 中的裝置和服務 \_ 。</span><span class="sxs-lookup"><span data-stu-id="b7c1b-106">In Bluetooth, the [**WSAQUERYSET**](/windows/desktop/api/winsock2/ns-winsock2-wsaquerysetw) structure, is used to facilitate the discovery of devices and services in the Bluetooth namespace, NS\_BTH.</span></span>

<span data-ttu-id="b7c1b-107">[**WSALookupServiceBegin**](/windows/desktop/api/winsock2/nf-winsock2-wsalookupservicebegina)和 [**WSALookupServiceNext**](/windows/desktop/api/winsock2/nf-winsock2-wsalookupservicenexta)函數會使用 [**WSAQUERYSET**](/windows/desktop/api/winsock2/ns-winsock2-wsaquerysetw)結構來取得裝置查詢程式的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="b7c1b-107">The [**WSALookupServiceBegin**](/windows/desktop/api/winsock2/nf-winsock2-wsalookupservicebegina) and [**WSALookupServiceNext**](/windows/desktop/api/winsock2/nf-winsock2-wsalookupservicenexta) functions use the [**WSAQUERYSET**](/windows/desktop/api/winsock2/ns-winsock2-wsaquerysetw) structure to obtain information about the device inquiry process.</span></span> <span data-ttu-id="b7c1b-108">下表列出並描述 **WSAQUERYSET** 結構中的成員值。</span><span class="sxs-lookup"><span data-stu-id="b7c1b-108">The following table lists and describes member values in the **WSAQUERYSET** structure.</span></span>

| <span data-ttu-id="b7c1b-109">成員</span><span class="sxs-lookup"><span data-stu-id="b7c1b-109">Member</span></span>                      | <span data-ttu-id="b7c1b-110">使用指定的 LUP 容器輸入至 WSALookupServiceBegin \_</span><span class="sxs-lookup"><span data-stu-id="b7c1b-110">Input to WSALookupServiceBegin with LUP\_CONTAINERS specified</span></span>                                                                                                                                              | <span data-ttu-id="b7c1b-111">從 WSALookupServiceNext 傳回的值</span><span class="sxs-lookup"><span data-stu-id="b7c1b-111">Returned value from WSALookupServiceNext</span></span>                                                                                                                                                                                                                                                                                                                                                                                        |
|-----------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="b7c1b-112">**dwSize**</span><span class="sxs-lookup"><span data-stu-id="b7c1b-112">**dwSize**</span></span>                  | <span data-ttu-id="b7c1b-113">必須設定為 **sizeof** ([**WSAQUERYSET**](/windows/desktop/api/winsock2/ns-winsock2-wsaquerysetw)) 。</span><span class="sxs-lookup"><span data-stu-id="b7c1b-113">Must be set to **sizeof**([**WSAQUERYSET**](/windows/desktop/api/winsock2/ns-winsock2-wsaquerysetw)).</span></span>                                                                                                                                       | <span data-ttu-id="b7c1b-114">**sizeof** (系統傳回的 [**WSAQUERYSET**](/windows/desktop/api/winsock2/ns-winsock2-wsaquerysetw)) 。</span><span class="sxs-lookup"><span data-stu-id="b7c1b-114">**sizeof**([**WSAQUERYSET**](/windows/desktop/api/winsock2/ns-winsock2-wsaquerysetw)) returned by system.</span></span>                                                                                                                                                                                                                                                                                                                                                        |
| <span data-ttu-id="b7c1b-115">**dwOutputFlags**</span><span class="sxs-lookup"><span data-stu-id="b7c1b-115">**dwOutputFlags**</span></span>           | <span data-ttu-id="b7c1b-116">未使用。</span><span class="sxs-lookup"><span data-stu-id="b7c1b-116">Not used.</span></span>                                                                                                                                                                                                  | <span data-ttu-id="b7c1b-117">可能有一或多個旗標設定： **BTHNS \_ 結果 \_ 裝置 \_ 已連線** 指定裝置已連線。</span><span class="sxs-lookup"><span data-stu-id="b7c1b-117">May have one or more of these flags set: **BTHNS\_RESULT\_DEVICE\_CONNECTED** Specifies the device is connected.</span></span><br/> <span data-ttu-id="b7c1b-118">**BTHNS \_\_ \_ 記住的結果裝置** 會指定裝置是已記住的裝置。</span><span class="sxs-lookup"><span data-stu-id="b7c1b-118">**BTHNS\_RESULT\_DEVICE\_REMEMBERED** Specifies the device is a remembered device.</span></span> <span data-ttu-id="b7c1b-119">並非所有記住的裝置都會經過驗證。</span><span class="sxs-lookup"><span data-stu-id="b7c1b-119">Not all remembered devices are authenticated.</span></span><br/> <span data-ttu-id="b7c1b-120">**BTHNS \_\_ \_ 經過驗證的結果裝置** 會指定裝置已通過驗證、配對或進行。</span><span class="sxs-lookup"><span data-stu-id="b7c1b-120">**BTHNS\_RESULT\_DEVICE\_AUTHENTICATED** Specifies the device is authenticated, paired, or bonded.</span></span> <span data-ttu-id="b7c1b-121">系統會記住所有已驗證的裝置。</span><span class="sxs-lookup"><span data-stu-id="b7c1b-121">All authenticated devices are remembered.</span></span><br/> |
| <span data-ttu-id="b7c1b-122">**lpszServiceInstanceName**</span><span class="sxs-lookup"><span data-stu-id="b7c1b-122">**lpszServiceInstanceName**</span></span> | <span data-ttu-id="b7c1b-123">未使用。</span><span class="sxs-lookup"><span data-stu-id="b7c1b-123">Not used.</span></span>                                                                                                                                                                                                  | <span data-ttu-id="b7c1b-124">裝置的顯示名稱，原先從藍牙遠端名稱要求操作傳回，而且可能由本機使用者更新。</span><span class="sxs-lookup"><span data-stu-id="b7c1b-124">Display name of the device, originally returned from a Bluetooth Remote Name Request operation, and possibly updated by the local user.</span></span> <span data-ttu-id="b7c1b-125">如果指定了 **LUP 傳回 \_ \_ 名稱** ，則會傳回。</span><span class="sxs-lookup"><span data-stu-id="b7c1b-125">Returned if **LUP\_RETURN\_NAME** is specified.</span></span>                                                                                                                                                                                                                                         |
| <span data-ttu-id="b7c1b-126">**lpServiceClassId**</span><span class="sxs-lookup"><span data-stu-id="b7c1b-126">**lpServiceClassId**</span></span>        | <span data-ttu-id="b7c1b-127">未使用。</span><span class="sxs-lookup"><span data-stu-id="b7c1b-127">Not used.</span></span>                                                                                                                                                                                                  | <span data-ttu-id="b7c1b-128">裝置的32位藍牙類別 (出貨) 欄位，對應至 GUID 的 **Data1** 成員。</span><span class="sxs-lookup"><span data-stu-id="b7c1b-128">The 32-bit Bluetooth class of device (COD) field mapped to the **Data1** member of the GUID.</span></span> <span data-ttu-id="b7c1b-129">如果指定了 **LUP 傳回 \_ \_ 類型** ，則傳回。</span><span class="sxs-lookup"><span data-stu-id="b7c1b-129">Returned if **LUP\_RETURN\_TYPE** is specified.</span></span>                                                                                                                                                                                                                                                                                    |
| <span data-ttu-id="b7c1b-130">**lpVersion**</span><span class="sxs-lookup"><span data-stu-id="b7c1b-130">**lpVersion**</span></span>               | <span data-ttu-id="b7c1b-131">未使用。</span><span class="sxs-lookup"><span data-stu-id="b7c1b-131">Not used.</span></span>                                                                                                                                                                                                  | <span data-ttu-id="b7c1b-132">未使用。</span><span class="sxs-lookup"><span data-stu-id="b7c1b-132">Not used.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                       |
| <span data-ttu-id="b7c1b-133">**lpszComment**</span><span class="sxs-lookup"><span data-stu-id="b7c1b-133">**lpszComment**</span></span>             | <span data-ttu-id="b7c1b-134">未使用。</span><span class="sxs-lookup"><span data-stu-id="b7c1b-134">Not used.</span></span>                                                                                                                                                                                                  | <span data-ttu-id="b7c1b-135">未使用。</span><span class="sxs-lookup"><span data-stu-id="b7c1b-135">Not used.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                       |
| <span data-ttu-id="b7c1b-136">**dwNameSpace**</span><span class="sxs-lookup"><span data-stu-id="b7c1b-136">**dwNameSpace**</span></span>             | <span data-ttu-id="b7c1b-137">必須是 NS \_ BTH。</span><span class="sxs-lookup"><span data-stu-id="b7c1b-137">Must be NS\_BTH.</span></span>                                                                                                                                                                                           | <span data-ttu-id="b7c1b-138">傳回 **NS \_ BTH**。</span><span class="sxs-lookup"><span data-stu-id="b7c1b-138">Returns **NS\_BTH**.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                            |
| <span data-ttu-id="b7c1b-139">**lpNSProviderId**</span><span class="sxs-lookup"><span data-stu-id="b7c1b-139">**lpNSProviderId**</span></span>          | <span data-ttu-id="b7c1b-140">未使用。</span><span class="sxs-lookup"><span data-stu-id="b7c1b-140">Not used.</span></span>                                                                                                                                                                                                  | <span data-ttu-id="b7c1b-141">未使用。</span><span class="sxs-lookup"><span data-stu-id="b7c1b-141">Not used.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                       |
| <span data-ttu-id="b7c1b-142">**lpszCoNtext**</span><span class="sxs-lookup"><span data-stu-id="b7c1b-142">**lpszContext**</span></span>             | <span data-ttu-id="b7c1b-143">未使用。</span><span class="sxs-lookup"><span data-stu-id="b7c1b-143">Not used.</span></span>                                                                                                                                                                                                  | <span data-ttu-id="b7c1b-144">未使用。</span><span class="sxs-lookup"><span data-stu-id="b7c1b-144">Not used.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                       |
| <span data-ttu-id="b7c1b-145">**dwNumberOfProtocols**</span><span class="sxs-lookup"><span data-stu-id="b7c1b-145">**dwNumberOfProtocols**</span></span>     | <span data-ttu-id="b7c1b-146">未使用。</span><span class="sxs-lookup"><span data-stu-id="b7c1b-146">Not used.</span></span>                                                                                                                                                                                                  | <span data-ttu-id="b7c1b-147">未使用。</span><span class="sxs-lookup"><span data-stu-id="b7c1b-147">Not used.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                       |
| <span data-ttu-id="b7c1b-148">**lpafpProtocols**</span><span class="sxs-lookup"><span data-stu-id="b7c1b-148">**lpafpProtocols**</span></span>          | <span data-ttu-id="b7c1b-149">未使用。</span><span class="sxs-lookup"><span data-stu-id="b7c1b-149">Not used.</span></span>                                                                                                                                                                                                  | <span data-ttu-id="b7c1b-150">未使用。</span><span class="sxs-lookup"><span data-stu-id="b7c1b-150">Not used.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                       |
| <span data-ttu-id="b7c1b-151">**lpszQueryString**</span><span class="sxs-lookup"><span data-stu-id="b7c1b-151">**lpszQueryString**</span></span>         | <span data-ttu-id="b7c1b-152">未使用。</span><span class="sxs-lookup"><span data-stu-id="b7c1b-152">Not used.</span></span>                                                                                                                                                                                                  | <span data-ttu-id="b7c1b-153">未使用。</span><span class="sxs-lookup"><span data-stu-id="b7c1b-153">Not used.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                       |
| <span data-ttu-id="b7c1b-154">**dwNumberOfCsAddrs**</span><span class="sxs-lookup"><span data-stu-id="b7c1b-154">**dwNumberOfCsAddrs**</span></span>       | <span data-ttu-id="b7c1b-155">未使用。</span><span class="sxs-lookup"><span data-stu-id="b7c1b-155">Not used.</span></span>                                                                                                                                                                                                  | <span data-ttu-id="b7c1b-156">指出 [**CSADDR \_ 資訊**](/windows/desktop/api/nspapi/ns-nspapi-csaddr_info) 結構陣列中的元素數目。</span><span class="sxs-lookup"><span data-stu-id="b7c1b-156">Indicates the number of elements in the array of [**CSADDR\_INFO**](/windows/desktop/api/nspapi/ns-nspapi-csaddr_info) structures.</span></span>                                                                                                                                                                                                                                                                                                                          |
| <span data-ttu-id="b7c1b-157">**lpcsaBuffer**</span><span class="sxs-lookup"><span data-stu-id="b7c1b-157">**lpcsaBuffer**</span></span>             | <span data-ttu-id="b7c1b-158">未使用。</span><span class="sxs-lookup"><span data-stu-id="b7c1b-158">Not used.</span></span>                                                                                                                                                                                                  | <span data-ttu-id="b7c1b-159">[**CSADDR \_ 資訊**](/windows/desktop/api/nspapi/ns-nspapi-csaddr_info)結構的指標，其 **LocalAddr. lpSockaddr** 成員指向具有遠端裝置位址的 [**SOCKADDR \_ BTH**](/windows/desktop/api/Ws2bth/ns-ws2bth-sockaddr_bth)結構。</span><span class="sxs-lookup"><span data-stu-id="b7c1b-159">Pointer to a [**CSADDR\_INFO**](/windows/desktop/api/nspapi/ns-nspapi-csaddr_info) structure with its **LocalAddr.lpSockaddr** member pointing to a [**SOCKADDR\_BTH**](/windows/desktop/api/Ws2bth/ns-ws2bth-sockaddr_bth) structure with the address of the remote device.</span></span> <span data-ttu-id="b7c1b-160">如果指定了 **LUP 傳回 \_ \_ ADDR** ，則會傳回。</span><span class="sxs-lookup"><span data-stu-id="b7c1b-160">Returned if **LUP\_RETURN\_ADDR** is specified.</span></span>                                                                                                                                                                  |
| <span data-ttu-id="b7c1b-161">**lpBlob**</span><span class="sxs-lookup"><span data-stu-id="b7c1b-161">**lpBlob**</span></span>                  | <span data-ttu-id="b7c1b-162">選擇性。</span><span class="sxs-lookup"><span data-stu-id="b7c1b-162">Optional.</span></span> <span data-ttu-id="b7c1b-163">可能指向指向 [**BTH \_ 查詢 \_ 裝置**](/windows/desktop/api/Ws2bth/ns-ws2bth-bth_query_device)結構的 [**BLOB**](/windows/desktop/api/nspapi/ns-nspapi-blob)結構，此結構可能會限制非快取裝置查詢作業的長度。</span><span class="sxs-lookup"><span data-stu-id="b7c1b-163">May point to a [**BLOB**](/windows/desktop/api/nspapi/ns-nspapi-blob) structure that points to a [**BTH\_QUERY\_DEVICE**](/windows/desktop/api/Ws2bth/ns-ws2bth-bth_query_device) structure that may limit the length of non-cached device inquiry operations.</span></span> | <span data-ttu-id="b7c1b-164">指向 [**BTH \_ 裝置 \_ 資訊**](/windows/desktop/api/Bthdef/ns-bthdef-bth_device_info)結構之 [**BLOB**](/windows/desktop/api/nspapi/ns-nspapi-blob)結構的指標。</span><span class="sxs-lookup"><span data-stu-id="b7c1b-164">Pointer to a [**BLOB**](/windows/desktop/api/nspapi/ns-nspapi-blob) structure that points to a [**BTH\_DEVICE\_INFO**](/windows/desktop/api/Bthdef/ns-bthdef-bth_device_info) structure.</span></span> <span data-ttu-id="b7c1b-165">如果指定 **LUP \_ RETURN \_ BLOB** ，則會傳回 **lpBlob** 。</span><span class="sxs-lookup"><span data-stu-id="b7c1b-165">**lpBlob** is returned if **LUP\_RETURN\_BLOB** is specified.</span></span> <span data-ttu-id="b7c1b-166">指定 **LUP \_ 傳回 \_ 名稱** ，以取得 **BTH \_ 裝置 \_ 資訊** 的名稱欄位。</span><span class="sxs-lookup"><span data-stu-id="b7c1b-166">Specify **LUP\_RETURN\_NAME** to retrieve the name field of **BTH\_DEVICE\_INFO**.</span></span>                                                                                                                                                     |



 

## <a name="related-topics"></a><span data-ttu-id="b7c1b-167">相關主題</span><span class="sxs-lookup"><span data-stu-id="b7c1b-167">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="b7c1b-168">適用于設定服務的藍牙和 WSAQUERYSET</span><span class="sxs-lookup"><span data-stu-id="b7c1b-168">Bluetooth and WSAQUERYSET for Set Service</span></span>](bluetooth-and-wsaqueryset-for-set-service.md)
</dt> <dt>

[<span data-ttu-id="b7c1b-169">用於服務查詢的藍牙和 WSAQUERYSET</span><span class="sxs-lookup"><span data-stu-id="b7c1b-169">Bluetooth and WSAQUERYSET for Service Inquiry</span></span>](bluetooth-and-wsaqueryset-for-service-inquiry.md)
</dt> <dt>

[<span data-ttu-id="b7c1b-170">藍牙和 BLOB</span><span class="sxs-lookup"><span data-stu-id="b7c1b-170">Bluetooth and BLOB</span></span>](bluetooth-and-blob.md)
</dt> <dt>

[<span data-ttu-id="b7c1b-171">藍牙和 WSALookupServiceBegin</span><span class="sxs-lookup"><span data-stu-id="b7c1b-171">Bluetooth and WSALookupServiceBegin</span></span>](bluetooth-and-wsasetservice.md)
</dt> <dt>

[<span data-ttu-id="b7c1b-172">藍牙和 WSALookupServiceNext</span><span class="sxs-lookup"><span data-stu-id="b7c1b-172">Bluetooth and WSALookupServiceNext</span></span>](bluetooth-and-wsasetservice.md)
</dt> <dt>

[<span data-ttu-id="b7c1b-173">**Blob**</span><span class="sxs-lookup"><span data-stu-id="b7c1b-173">**BLOB**</span></span>](/windows/desktop/api/nspapi/ns-nspapi-blob)
</dt> <dt>

[<span data-ttu-id="b7c1b-174">**BTH \_ 裝置 \_ 資訊**</span><span class="sxs-lookup"><span data-stu-id="b7c1b-174">**BTH\_DEVICE\_INFO**</span></span>](/windows/desktop/api/Bthdef/ns-bthdef-bth_device_info)
</dt> <dt>

[<span data-ttu-id="b7c1b-175">**BTH \_ 查詢 \_ 裝置**</span><span class="sxs-lookup"><span data-stu-id="b7c1b-175">**BTH\_QUERY\_DEVICE**</span></span>](/windows/desktop/api/Ws2bth/ns-ws2bth-bth_query_device)
</dt> <dt>

[<span data-ttu-id="b7c1b-176">**CSADDR \_ 資訊**</span><span class="sxs-lookup"><span data-stu-id="b7c1b-176">**CSADDR\_INFO**</span></span>](/windows/desktop/api/nspapi/ns-nspapi-csaddr_info)
</dt> <dt>

[<span data-ttu-id="b7c1b-177">**SOCKADDR \_ BTH**</span><span class="sxs-lookup"><span data-stu-id="b7c1b-177">**SOCKADDR\_BTH**</span></span>](/windows/desktop/api/Ws2bth/ns-ws2bth-sockaddr_bth)
</dt> <dt>

[<span data-ttu-id="b7c1b-178">**WSAQUERYSET**</span><span class="sxs-lookup"><span data-stu-id="b7c1b-178">**WSAQUERYSET**</span></span>](/windows/desktop/api/winsock2/ns-winsock2-wsaquerysetw)
</dt> <dt>

[<span data-ttu-id="b7c1b-179">Windows Sockets</span><span class="sxs-lookup"><span data-stu-id="b7c1b-179">Windows Sockets</span></span>](/windows/desktop/WinSock/windows-sockets-start-page-2)
</dt> </dl>

 

