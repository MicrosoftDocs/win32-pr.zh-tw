---
title: 使用 Windows 通訊端進行藍牙程式設計
description: 本節說明如何使用 Windows 通訊端函式和結構來為藍牙應用程式進行程式設計。
ms.assetid: 0f15cb84-1d7a-4b64-86e8-b1b23c956c64
keywords:
- 藍牙，工作
- Windows Sockets
- 程式設計
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: ca797121696af8eb36549bf596ad51ee8189c3cd
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/20/2020
ms.locfileid: "106968094"
---
# <a name="bluetooth-programming-with-windows-sockets"></a><span data-ttu-id="d7503-106">使用 Windows 通訊端進行藍牙程式設計</span><span class="sxs-lookup"><span data-stu-id="d7503-106">Bluetooth Programming with Windows Sockets</span></span>

<span data-ttu-id="d7503-107">本節說明如何使用 Windows 通訊端函式和結構來為藍牙應用程式進行程式設計。</span><span class="sxs-lookup"><span data-stu-id="d7503-107">This section describes how to use Windows Sockets functions and structures to program a Bluetooth application.</span></span> <span data-ttu-id="d7503-108">Windows 通訊端 API 元素的完整參考資訊可在 [Windows 通訊端](/windows/desktop/WinSock/windows-sockets-start-page-2)中找到;本節只提供每個 Windows 通訊端程式設計項目的藍牙特定資訊。</span><span class="sxs-lookup"><span data-stu-id="d7503-108">Complete reference information for the Windows Sockets API elements can be found in [Windows Sockets](/windows/desktop/WinSock/windows-sockets-start-page-2); this section provides only Bluetooth-specific information for each Windows Sockets programming element.</span></span>

<span data-ttu-id="d7503-109">您也可以下載 [藍牙連線範例](https://github.com/microsoftarchive/msdn-code-gallery-microsoft/tree/master/Official%20Windows%20Platform%20Sample/Bluetooth%20connection%20sample) ，以取得完整的範例。</span><span class="sxs-lookup"><span data-stu-id="d7503-109">You can also download the [Bluetooth connection sample](https://github.com/microsoftarchive/msdn-code-gallery-microsoft/tree/master/Official%20Windows%20Platform%20Sample/Bluetooth%20connection%20sample) for a complete example.</span></span>

<span data-ttu-id="d7503-110">就像所有的 Windows 通訊端應用程式程式設計一樣，必須呼叫 [**WSAStartup**](/windows/desktop/api/winsock/nf-winsock-wsastartup) 函式來起始 Windows 通訊端功能並啟用藍牙。</span><span class="sxs-lookup"><span data-stu-id="d7503-110">As with all Windows Sockets application programming, the [**WSAStartup**](/windows/desktop/api/winsock/nf-winsock-wsastartup) function must be called to initiate Windows Sockets functionality and enable Bluetooth.</span></span>

<span data-ttu-id="d7503-111">下列主題提供使用 Windows 通訊端功能和結構搭配 Microsoft 藍牙 API 的指引：</span><span class="sxs-lookup"><span data-stu-id="d7503-111">The following topics provide guidance in the use of Windows Sockets functions and structures with the Microsoft Bluetooth API:</span></span>



| <span data-ttu-id="d7503-112">主題</span><span class="sxs-lookup"><span data-stu-id="d7503-112">Topic</span></span>                                                                                            | <span data-ttu-id="d7503-113">描述</span><span class="sxs-lookup"><span data-stu-id="d7503-113">Description</span></span>                                                                                                                                                                                                                                                                                                                |
|--------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="d7503-114">藍牙和接受</span><span class="sxs-lookup"><span data-stu-id="d7503-114">Bluetooth and accept</span></span>](bluetooth-and-accept.md)                                                 | <span data-ttu-id="d7503-115">藍牙使用 [**accept**](/windows/desktop/api/winsock2/nf-winsock2-accept) 函式來啟用通訊端上的連入連線嘗試。</span><span class="sxs-lookup"><span data-stu-id="d7503-115">Bluetooth uses the [**accept**](/windows/desktop/api/winsock2/nf-winsock2-accept) function to enable incoming connection attempts on a socket.</span></span><br/>                                                                                                                                                                                                  |
| [<span data-ttu-id="d7503-116">藍牙與系結</span><span class="sxs-lookup"><span data-stu-id="d7503-116">Bluetooth and bind</span></span>](bluetooth-and-bind.md)                                                     | <span data-ttu-id="d7503-117">藍牙使用系[](/windows/desktop/api/winsock/nf-winsock-bind)結函式來系結至通訊端。</span><span class="sxs-lookup"><span data-stu-id="d7503-117">Bluetooth uses the [**bind**](/windows/desktop/api/winsock/nf-winsock-bind) function to bind to a socket.</span></span><br/>                                                                                                                                                                                                                                     |
| [<span data-ttu-id="d7503-118">藍牙和 BLOB</span><span class="sxs-lookup"><span data-stu-id="d7503-118">Bluetooth and BLOB</span></span>](bluetooth-and-blob.md)                                                     | <span data-ttu-id="d7503-119">藍牙在呼叫 [**WSASetService**](bluetooth-and-wsasetservice.md)或 **WSALookupService** 函式時，會使用 [**BLOB**](/windows/desktop/api/nspapi/ns-nspapi-blob)結構，在 [**WSAQUERYSET**](bluetooth-and-wsaqueryset-for-set-service.md)結構中傳遞或接收傳輸特定資料 \* 。</span><span class="sxs-lookup"><span data-stu-id="d7503-119">Bluetooth uses the [**BLOB**](/windows/desktop/api/nspapi/ns-nspapi-blob) structure to pass or receive transport-specific data to the [**WSAQUERYSET**](bluetooth-and-wsaqueryset-for-set-service.md) structure during calls to the [**WSASetService**](bluetooth-and-wsasetservice.md) or **WSALookupService**\* functions.</span></span> <br/>             |
| [<span data-ttu-id="d7503-120">藍牙和 connect</span><span class="sxs-lookup"><span data-stu-id="d7503-120">Bluetooth and connect</span></span>](bluetooth-and-connect.md)                                               | <span data-ttu-id="d7503-121">藍牙使用 [**connect**](/windows/desktop/api/winsock2/nf-winsock2-connect) 函式連接到目標藍牙裝置，並使用先前建立的藍牙通訊端。</span><span class="sxs-lookup"><span data-stu-id="d7503-121">Bluetooth uses the [**connect**](/windows/desktop/api/winsock2/nf-winsock2-connect) function to connect to a target Bluetooth device, using a previously created Bluetooth socket.</span></span><br/>                                                                                                                                                              |
| [<span data-ttu-id="d7503-122">藍牙和 getaddrinfo</span><span class="sxs-lookup"><span data-stu-id="d7503-122">Bluetooth and getaddrinfo</span></span>](bluetooth-and-getaddrinfo.md)                                       | <span data-ttu-id="d7503-123">[**Getaddrinfo**](/windows/desktop/api/ws2tcpip/nf-ws2tcpip-getaddrinfo)函式會提供從主機名稱到位址的轉換，以供以 IP 為基礎的傳輸。</span><span class="sxs-lookup"><span data-stu-id="d7503-123">The [**getaddrinfo**](/windows/desktop/api/ws2tcpip/nf-ws2tcpip-getaddrinfo) function provides translation from host name to address for IP-based transports.</span></span><br/>                                                                                                                                                                                   |
| [<span data-ttu-id="d7503-124">藍牙和 getpeername</span><span class="sxs-lookup"><span data-stu-id="d7503-124">Bluetooth and getpeername</span></span>](bluetooth-and-getpeername.md)                                       | <span data-ttu-id="d7503-125">用來取得對等藍牙裝置的藍牙位址。</span><span class="sxs-lookup"><span data-stu-id="d7503-125">Used to retrieve the Bluetooth address of the peer Bluetooth device.</span></span><br/>                                                                                                                                                                                                                                            |
| [<span data-ttu-id="d7503-126">藍牙和 getsockname</span><span class="sxs-lookup"><span data-stu-id="d7503-126">Bluetooth and getsockname</span></span>](bluetooth-and-getsockname.md)                                       | <span data-ttu-id="d7503-127">藍牙使用 [**getsockname**](/windows/desktop/api/winsock/nf-winsock-getsockname) 函式，透過 [**先前的系**](/windows/desktop/api/winsock/nf-winsock-bind) 結函式呼叫，來取得配置給通訊端的伺服器裝置位址和埠號碼。</span><span class="sxs-lookup"><span data-stu-id="d7503-127">Bluetooth uses the [**getsockname**](/windows/desktop/api/winsock/nf-winsock-getsockname) function to retrieve the server device address and port number allocated to a socket through a previous call to the [**bind**](/windows/desktop/api/winsock/nf-winsock-bind) function.</span></span><br/>                                                                                            |
| [<span data-ttu-id="d7503-128">藍牙和 getsockopt</span><span class="sxs-lookup"><span data-stu-id="d7503-128">Bluetooth and getsockopt</span></span>](bluetooth-and-getsockopt.md)                                         | <span data-ttu-id="d7503-129">藍牙會使用 [**getsockopt**](/windows/desktop/api/winsock/nf-winsock-getsockopt) 函數來查詢與伺服器通道或連接相關聯的各種參數。</span><span class="sxs-lookup"><span data-stu-id="d7503-129">Bluetooth uses the [**getsockopt**](/windows/desktop/api/winsock/nf-winsock-getsockopt) function to query various parameters associated with the server channel or the connection.</span></span> <br/>                                                                                                                                                           |
| [<span data-ttu-id="d7503-130">藍牙和接聽、選取和導致 closesocket</span><span class="sxs-lookup"><span data-stu-id="d7503-130">Bluetooth and listen, select, and closesocket</span></span>](bluetooth-and-listen-select-and-closesocket.md) | <span data-ttu-id="d7503-131">藍牙使用 [**接聽**](/windows/desktop/api/winsock2/nf-winsock2-listen)、 [**選取**](/windows/desktop/api/winsock2/nf-winsock2-select)和 [**導致 closesocket**](/windows/desktop/api/winsock/nf-winsock-closesocket) 函式，而不需修改標準的 Windows 通訊端程式設計。</span><span class="sxs-lookup"><span data-stu-id="d7503-131">Bluetooth uses the [**listen**](/windows/desktop/api/winsock2/nf-winsock2-listen), [**select**](/windows/desktop/api/winsock2/nf-winsock2-select), and [**closesocket**](/windows/desktop/api/winsock/nf-winsock-closesocket) functions without any modification from standard Windows Sockets programming.</span></span><br/>                                                                                                   |
| [<span data-ttu-id="d7503-132">藍牙和讀取或寫入作業</span><span class="sxs-lookup"><span data-stu-id="d7503-132">Bluetooth and read or write operations</span></span>](bluetooth-and-read-or-write-operations.md)             | <span data-ttu-id="d7503-133">詳述支援的 Winsock 讀取和寫入作業。</span><span class="sxs-lookup"><span data-stu-id="d7503-133">Details the supported Winsock read and write operations.</span></span><br/>                                                                                                                                                                                                                                                        |
| [<span data-ttu-id="d7503-134">藍牙和 setsockopt</span><span class="sxs-lookup"><span data-stu-id="d7503-134">Bluetooth and setsockopt</span></span>](bluetooth-and-setsockopt.md)                                         | <span data-ttu-id="d7503-135">藍牙使用 [**setsockopt**](/windows/desktop/api/winsock/nf-winsock-setsockopt) 函式來設定與伺服器通道或連接相關聯的各種參數。</span><span class="sxs-lookup"><span data-stu-id="d7503-135">Bluetooth uses the [**setsockopt**](/windows/desktop/api/winsock/nf-winsock-setsockopt) function to set various parameters associated with the server channel or the connection.</span></span><br/>                                                                                                                                                              |
| [<span data-ttu-id="d7503-136">藍牙和關機</span><span class="sxs-lookup"><span data-stu-id="d7503-136">Bluetooth and shutdown</span></span>](bluetooth-and-shutdown.md)                                             | <span data-ttu-id="d7503-137">藍牙使用 [**shutdown**](/windows/desktop/api/winsock/nf-winsock-shutdown) 功能來中斷與遠端無線電的連線。</span><span class="sxs-lookup"><span data-stu-id="d7503-137">Bluetooth uses the [**shutdown**](/windows/desktop/api/winsock/nf-winsock-shutdown) function to disconnect from the remote radio.</span></span><br/>                                                                                                                                                                                                             |
| [<span data-ttu-id="d7503-138">藍牙和通訊端</span><span class="sxs-lookup"><span data-stu-id="d7503-138">Bluetooth and socket</span></span>](bluetooth-and-socket.md)                                                 | <span data-ttu-id="d7503-139">藍牙使用 [**通訊端**](/windows/desktop/api/winsock2/nf-winsock2-socket) 函式來建立傳入或傳出連線的通訊端。</span><span class="sxs-lookup"><span data-stu-id="d7503-139">Bluetooth uses the [**socket**](/windows/desktop/api/winsock2/nf-winsock2-socket) function creates a socket for incoming or outgoing connections.</span></span><br/>                                                                                                                                                                                               |
| [<span data-ttu-id="d7503-140">藍牙和通訊端選項</span><span class="sxs-lookup"><span data-stu-id="d7503-140">Bluetooth and Socket Options</span></span>](bluetooth-and-socket-options.md)                                 | <span data-ttu-id="d7503-141">詳細說明 Microsoft 藍牙支援的通訊端選項。</span><span class="sxs-lookup"><span data-stu-id="d7503-141">Details the socket options supported by Microsoft Bluetooth.</span></span><br/>                                                                                                                                                                                                                                                    |
| [<span data-ttu-id="d7503-142">藍牙和 WSAAddressToString</span><span class="sxs-lookup"><span data-stu-id="d7503-142">Bluetooth and WSAAddressToString</span></span>](bluetooth-and-wsaaddresstostring.md)                         | <span data-ttu-id="d7503-143">用來將 Bluetooth 裝置位址轉換成字串，然後在抓取裝置服務資訊時，透過 [**WSAQUERYSET**](/windows/desktop/api/winsock2/ns-winsock2-wsaquerysetw)結構提供給 [**WSALookupServiceBegin**](/windows/desktop/api/winsock2/nf-winsock2-wsalookupservicebegina)函式。</span><span class="sxs-lookup"><span data-stu-id="d7503-143">Used to convert a Bluetooth Device Address to a string, which is in turn provided to the [**WSALookupServiceBegin**](/windows/desktop/api/winsock2/nf-winsock2-wsalookupservicebegina) function via the [**WSAQUERYSET**](/windows/desktop/api/winsock2/ns-winsock2-wsaquerysetw) structure when retrieving device service information.</span></span><br/>                                           |
| [<span data-ttu-id="d7503-144">藍牙和 WSALookupServiceBegin</span><span class="sxs-lookup"><span data-stu-id="d7503-144">Bluetooth and WSALookupServiceBegin</span></span>](bluetooth-and-wsalookupservicebegin.md)                   | <span data-ttu-id="d7503-145">藍牙使用 [**WSALookupServiceBegin**](/windows/desktop/api/winsock2/nf-winsock2-wsalookupservicebegina) 函式來查詢裝置及探索服務。</span><span class="sxs-lookup"><span data-stu-id="d7503-145">Bluetooth uses the [**WSALookupServiceBegin**](/windows/desktop/api/winsock2/nf-winsock2-wsalookupservicebegina) function to query for devices and to discover services.</span></span><br/>                                                                                                                                                                         |
| [<span data-ttu-id="d7503-146">藍牙和 WSALookupServiceNext</span><span class="sxs-lookup"><span data-stu-id="d7503-146">Bluetooth and WSALookupServiceNext</span></span>](bluetooth-and-wsalookupservicenext.md)                     | <span data-ttu-id="d7503-147">藍牙使用 [**WSALookupServiceNext**](/windows/desktop/api/winsock2/nf-winsock2-wsalookupservicenexta) 函式來比對 [**WSALookupServiceBegin**](/windows/desktop/api/winsock2/nf-winsock2-wsalookupservicebegina)先前呼叫中所指定的查詢。</span><span class="sxs-lookup"><span data-stu-id="d7503-147">Bluetooth uses the [**WSALookupServiceNext**](/windows/desktop/api/winsock2/nf-winsock2-wsalookupservicenexta) function to match queries specified in a previous call to [**WSALookupServiceBegin**](/windows/desktop/api/winsock2/nf-winsock2-wsalookupservicebegina).</span></span><br/>                                                                                                           |
| [<span data-ttu-id="d7503-148">藍牙和 WSALookupServiceEnd</span><span class="sxs-lookup"><span data-stu-id="d7503-148">Bluetooth and WSALookupServiceEnd</span></span>](bluetooth-and-wsalookupserviceend.md)                       | <span data-ttu-id="d7503-149">藍牙使用 [**WSALookupServiceEnd**](/windows/desktop/api/winsock2/nf-winsock2-wsalookupserviceend) 函式來終止先前呼叫 [**WSALookupServiceBegin**](/windows/desktop/api/winsock2/nf-winsock2-wsalookupservicebegina)時起始的查詢，而且可能會在後續的 [**WSALookupServiceNext**](/windows/desktop/api/winsock2/nf-winsock2-wsalookupservicenexta)呼叫中延伸。</span><span class="sxs-lookup"><span data-stu-id="d7503-149">Bluetooth uses the [**WSALookupServiceEnd**](/windows/desktop/api/winsock2/nf-winsock2-wsalookupserviceend) function to terminate a query initiated in a previous call to [**WSALookupServiceBegin**](/windows/desktop/api/winsock2/nf-winsock2-wsalookupservicebegina), and perhaps extended in subsequent calls to [**WSALookupServiceNext**](/windows/desktop/api/winsock2/nf-winsock2-wsalookupservicenexta).</span></span><br/> |
| [<span data-ttu-id="d7503-150">藍牙和 WSAQUERYSET</span><span class="sxs-lookup"><span data-stu-id="d7503-150">Bluetooth and WSAQUERYSET</span></span>](bluetooth-and-wsaqueryset.md)                                       | <span data-ttu-id="d7503-151">[**WSAQUERYSET**](/windows/desktop/api/winsock2/ns-winsock2-wsaquerysetw)結構用於作業中，包括裝置查詢、服務查詢和設定服務。</span><span class="sxs-lookup"><span data-stu-id="d7503-151">The [**WSAQUERYSET**](/windows/desktop/api/winsock2/ns-winsock2-wsaquerysetw) structure is used in operations including device inquiry, service inquiry, and setting the service.</span></span><br/>                                                                                                                                                                |
| [<span data-ttu-id="d7503-152">藍牙和 WSASetService</span><span class="sxs-lookup"><span data-stu-id="d7503-152">Bluetooth and WSASetService</span></span>](bluetooth-and-wsasetservice.md)                                   | <span data-ttu-id="d7503-153">藍牙使用 [**WSASetService**](/windows/desktop/api/winsock2/nf-winsock2-wsasetservicea) 函式來註冊或移除藍牙命名空間內的服務實例， (NS \_ BTH) 從登錄。</span><span class="sxs-lookup"><span data-stu-id="d7503-153">Bluetooth uses the [**WSASetService**](/windows/desktop/api/winsock2/nf-winsock2-wsasetservicea) function to register or remove a service instance within the Bluetooth namespace (NS\_BTH) from the registry.</span></span><br/>                                                                                                                                   |



 

## <a name="related-topics"></a><span data-ttu-id="d7503-154">相關主題</span><span class="sxs-lookup"><span data-stu-id="d7503-154">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="d7503-155">Windows Sockets</span><span class="sxs-lookup"><span data-stu-id="d7503-155">Windows Sockets</span></span>](/windows/desktop/WinSock/windows-sockets-start-page-2)
</dt> </dl>

 

