---
title: 適用于服務探索的藍牙和 WSALookupServiceBegin
description: 用戶端會使用 WSALookupServiceBegin、WSALookupServiceNext 和 WSALookupServiceEnd 功能，來探索藍牙伺服器上的特定服務是否存在。
ms.assetid: d9961600-cdca-42ec-92eb-118b8186ed2e
keywords:
- 藍牙與 WSALookupServiceBegin for Service Discovery 藍牙
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 274b3beb3de7683bd43a0f99350db6e1a347f51e
ms.sourcegitcommit: ae73f4dd3cf5a3c6a1ea7d191ca32a5b01f6686b
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 09/08/2020
ms.locfileid: "103842835"
---
# <a name="bluetooth-and-wsalookupservicebegin-for-service-discovery"></a><span data-ttu-id="2a38d-104">適用于服務探索的藍牙和 WSALookupServiceBegin</span><span class="sxs-lookup"><span data-stu-id="2a38d-104">Bluetooth and WSALookupServiceBegin for Service Discovery</span></span>

<span data-ttu-id="2a38d-105">用戶端會使用 [**WSALookupServiceBegin**](/windows/desktop/api/winsock2/nf-winsock2-wsalookupservicebegina)、 [**WSALookupServiceNext**](/windows/desktop/api/winsock2/nf-winsock2-wsalookupservicenexta)和 [**WSALookupServiceEnd**](/windows/desktop/api/winsock2/nf-winsock2-wsalookupserviceend) 功能，來探索藍牙伺服器上的特定服務是否存在。</span><span class="sxs-lookup"><span data-stu-id="2a38d-105">To discover the existence of a particular service on a Bluetooth server, clients use the [**WSALookupServiceBegin**](/windows/desktop/api/winsock2/nf-winsock2-wsalookupservicebegina), [**WSALookupServiceNext**](/windows/desktop/api/winsock2/nf-winsock2-wsalookupservicenexta), and [**WSALookupServiceEnd**](/windows/desktop/api/winsock2/nf-winsock2-wsalookupserviceend) functions.</span></span> <span data-ttu-id="2a38d-106">您可以針對本機和遠端位址執行查詢，但只能與遠端位址建立連接。</span><span class="sxs-lookup"><span data-stu-id="2a38d-106">Queries can be performed for local and remote addresses, but connections can only be established with remote addresses.</span></span> <span data-ttu-id="2a38d-107">在此作業期間探索到的服務控制碼，無法透過 [**WSASetService**](/windows/desktop/api/winsock2/nf-winsock2-wsasetservicea)來刪除服務。</span><span class="sxs-lookup"><span data-stu-id="2a38d-107">Service handles discovered during this operation cannot be used to delete the service via [**WSASetService**](/windows/desktop/api/winsock2/nf-winsock2-wsasetservicea).</span></span> <span data-ttu-id="2a38d-108">RFCOMM 不支援回送。</span><span class="sxs-lookup"><span data-stu-id="2a38d-108">Loopback is not supported by RFCOMM.</span></span>

<span data-ttu-id="2a38d-109">您可以執行兩種基本類型的服務探索查詢：</span><span class="sxs-lookup"><span data-stu-id="2a38d-109">Two basic types of service discovery queries can be performed:</span></span>

-   <span data-ttu-id="2a38d-110">查詢本機裝置上的一或多個服務</span><span class="sxs-lookup"><span data-stu-id="2a38d-110">Queries for one or more services on the local device</span></span>
-   <span data-ttu-id="2a38d-111">查詢指定的對等裝置上的一或多個服務</span><span class="sxs-lookup"><span data-stu-id="2a38d-111">Queries for one or more services on a specified peer device</span></span>

<span data-ttu-id="2a38d-112">[**WSALookupServiceBegin**](/windows/desktop/api/winsock2/nf-winsock2-wsalookupservicebegina)函數會在其 *lpqsRestrictions* 參數中收到 [**WSAQUERYSET**](/windows/desktop/api/winsock2/ns-winsock2-wsaquerysetw)結構。</span><span class="sxs-lookup"><span data-stu-id="2a38d-112">The [**WSALookupServiceBegin**](/windows/desktop/api/winsock2/nf-winsock2-wsalookupservicebegina) function receives a [**WSAQUERYSET**](/windows/desktop/api/winsock2/ns-winsock2-wsaquerysetw) structure in its *lpqsRestrictions* parameter.</span></span> <span data-ttu-id="2a38d-113">**WSALookupServiceBegin** 會根據 **WSAQUERYSET** 包含的一組搜尋限制來執行用戶端查詢。</span><span class="sxs-lookup"><span data-stu-id="2a38d-113">**WSALookupServiceBegin** performs a client query based on the set of search restrictions that the **WSAQUERYSET** contains.</span></span> <span data-ttu-id="2a38d-114">當使用 **WSALookupServiceBegin** 函數來查詢服務時，藍牙用戶端必須在 **WSAQUERYSET** 結構中指定下表所列的限制。</span><span class="sxs-lookup"><span data-stu-id="2a38d-114">Bluetooth clients must specify the restrictions, listed in the following table, in the **WSAQUERYSET** structure when using the **WSALookupServiceBegin** function to query for services.</span></span>



| <span data-ttu-id="2a38d-115">WSAQUERYSET 成員</span><span class="sxs-lookup"><span data-stu-id="2a38d-115">WSAQUERYSET member</span></span>    | <span data-ttu-id="2a38d-116">限制</span><span class="sxs-lookup"><span data-stu-id="2a38d-116">Restriction</span></span>                                                                                                                                                                                                                                                                                                                                                                     |
|-----------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="2a38d-117">**dwSize**</span><span class="sxs-lookup"><span data-stu-id="2a38d-117">**dwSize**</span></span>            | <span data-ttu-id="2a38d-118">設定為 **sizeof** ([**WSAQUERYSET**](/windows/desktop/api/winsock2/ns-winsock2-wsaquerysetw)) 。</span><span class="sxs-lookup"><span data-stu-id="2a38d-118">Set to **sizeof**([**WSAQUERYSET**](/windows/desktop/api/winsock2/ns-winsock2-wsaquerysetw)).</span></span>                                                                                                                                                                                                                                                                                                                    |
| <span data-ttu-id="2a38d-119">**lpServiceClassId**</span><span class="sxs-lookup"><span data-stu-id="2a38d-119">**lpServiceClassId**</span></span>  | <span data-ttu-id="2a38d-120">設定為可用於判斷查詢範圍的最特定藍牙 UUID。</span><span class="sxs-lookup"><span data-stu-id="2a38d-120">Set to the most specific Bluetooth UUID that can be used to determine the scope of the query.</span></span> <span data-ttu-id="2a38d-121">例如，將 **lpServiceClassId** 設定為 L2CAP 通訊協定的 UUID 會導致所有傳回的 L2CAP 服務，基本上會列舉目標上的所有 SD 記錄。</span><span class="sxs-lookup"><span data-stu-id="2a38d-121">For example, setting **lpServiceClassId** to the UUID of the L2CAP protocol results in all L2CAP services returned, essentially enumerating all SD records on the target.</span></span> <span data-ttu-id="2a38d-122">但是，將 UUID 設定為特定服務，只會傳回該服務的實例。</span><span class="sxs-lookup"><span data-stu-id="2a38d-122">Setting the UUID to a specific service, however, returns only the instances of that service.</span></span><br/> |
| <span data-ttu-id="2a38d-123">**dwNameSpace**</span><span class="sxs-lookup"><span data-stu-id="2a38d-123">**dwNameSpace**</span></span>       | <span data-ttu-id="2a38d-124">設定為 **NS \_ BTH**。</span><span class="sxs-lookup"><span data-stu-id="2a38d-124">Set to **NS\_BTH**.</span></span>                                                                                                                                                                                                                                                                                                                                                             |
| <span data-ttu-id="2a38d-125">**dwNumberOfCsAddrs**</span><span class="sxs-lookup"><span data-stu-id="2a38d-125">**dwNumberOfCsAddrs**</span></span> | <span data-ttu-id="2a38d-126">設定為0。</span><span class="sxs-lookup"><span data-stu-id="2a38d-126">Set to 0.</span></span>                                                                                                                                                                                                                                                                                                                                                                       |
| <span data-ttu-id="2a38d-127">**lpszCoNtext**</span><span class="sxs-lookup"><span data-stu-id="2a38d-127">**lpszContext**</span></span>       | <span data-ttu-id="2a38d-128">設定為要用來建立用來執行服務查詢之 SDP 連接的藍牙裝置位址。</span><span class="sxs-lookup"><span data-stu-id="2a38d-128">Set to the Bluetooth Device Address with which to establish an SDP connection to perform the query of services.</span></span> <span data-ttu-id="2a38d-129">此成員必須是使用 [**WSAAddressToString**](/windows/desktop/api/winsock2/nf-winsock2-wsaaddresstostringa) 函數進行轉換的字串。</span><span class="sxs-lookup"><span data-stu-id="2a38d-129">This member must be a string that is converted by using the [**WSAAddressToString**](/windows/desktop/api/winsock2/nf-winsock2-wsaaddresstostringa) function.</span></span> <span data-ttu-id="2a38d-130">如果提供了本機無線電位址，則會搜尋本機的 SDP 記錄。</span><span class="sxs-lookup"><span data-stu-id="2a38d-130">If the local radio address is supplied, the local SDP records are searched.</span></span><br/>                                             |
| <span data-ttu-id="2a38d-131">其他成員</span><span class="sxs-lookup"><span data-stu-id="2a38d-131">Other members</span></span>         | <span data-ttu-id="2a38d-132">[**WSAQUERYSET**](/windows/desktop/api/winsock2/ns-winsock2-wsaquerysetw)結構的所有其他成員都會被忽略。</span><span class="sxs-lookup"><span data-stu-id="2a38d-132">All other members of the [**WSAQUERYSET**](/windows/desktop/api/winsock2/ns-winsock2-wsaquerysetw) structure are ignored.</span></span>                                                                                                                                                                                                                                                                                        |



 

<span data-ttu-id="2a38d-133">[**WSALookupServiceBegin**](/windows/desktop/api/winsock2/nf-winsock2-wsalookupservicebegina)函式完成服務查詢之後，與遠端裝置的 SDP 連接不會保持作用中狀態;連接會在 **WSALookupServiceBegin** 傳回之前終止。</span><span class="sxs-lookup"><span data-stu-id="2a38d-133">The SDP connection to the remote device does not remain active after the [**WSALookupServiceBegin**](/windows/desktop/api/winsock2/nf-winsock2-wsalookupservicebegina) function completes a service query; the connection is terminated before **WSALookupServiceBegin** returns.</span></span> <span data-ttu-id="2a38d-134">在服務查詢完成之後，需要 SDP 連線才能保持使用中的應用程式，應該在發出 Windows Socket [**connect**](/windows/desktop/api/winsock2/nf-winsock2-connect)函數呼叫時，使用 [**SOCKADDR \_ BTH**](/windows/desktop/api/Ws2bth/ns-ws2bth-sockaddr_bth)結構的 **serviceClassId** 成員來指定要連接的服務類別 UUID。</span><span class="sxs-lookup"><span data-stu-id="2a38d-134">Applications that require the SDP connection to remain active after a service query completes should specify the service class UUID to which to connect by using the **serviceClassId** member of the [**SOCKADDR\_BTH**](/windows/desktop/api/Ws2bth/ns-ws2bth-sockaddr_bth) structure when issuing the Windows Sockets [**connect**](/windows/desktop/api/winsock2/nf-winsock2-connect) function call.</span></span>

<span data-ttu-id="2a38d-135">下表所列的旗標，用於 [**WSALookupServiceBegin**](/windows/desktop/api/winsock2/nf-winsock2-wsalookupservicebegina)和 [**WSALookupServiceNext**](/windows/desktop/api/winsock2/nf-winsock2-wsalookupservicenexta)函數的 *dwControlFlags* 參數，以控制查詢結果。</span><span class="sxs-lookup"><span data-stu-id="2a38d-135">The flags, listed in the following table, are used in the *dwControlFlags* parameter of the [**WSALookupServiceBegin**](/windows/desktop/api/winsock2/nf-winsock2-wsalookupservicebegina) and [**WSALookupServiceNext**](/windows/desktop/api/winsock2/nf-winsock2-wsalookupservicenexta) functions to control the query results.</span></span> <span data-ttu-id="2a38d-136">**WSALookupServiceBegin** 函式會使用 **LUP \_ 容器** 和 **LUP \_ FLUSHCACHE** 旗標; 其餘的旗標會用於 **WSALookupServiceNext** 函數的呼叫中。</span><span class="sxs-lookup"><span data-stu-id="2a38d-136">The **LUP\_CONTAINERS** and **LUP\_FLUSHCACHE** flags are used by the **WSALookupServiceBegin** function; the rest of the flags are used in calls to the **WSALookupServiceNext** function.</span></span>

<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th><span data-ttu-id="2a38d-137">旗標</span><span class="sxs-lookup"><span data-stu-id="2a38d-137">Flag</span></span></th>
<th><span data-ttu-id="2a38d-138">結果</span><span class="sxs-lookup"><span data-stu-id="2a38d-138">Result</span></span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span data-ttu-id="2a38d-139"><strong>LUP_CONTAINERS</strong></span><span class="sxs-lookup"><span data-stu-id="2a38d-139"><strong>LUP_CONTAINERS</strong></span></span></td>
<td><span data-ttu-id="2a38d-140">不得設定。</span><span class="sxs-lookup"><span data-stu-id="2a38d-140">Must not be set.</span></span></td>
</tr>
<tr class="even">
<td><span data-ttu-id="2a38d-141"><strong>LUP_FLUSHCACHE</strong></span><span class="sxs-lookup"><span data-stu-id="2a38d-141"><strong>LUP_FLUSHCACHE</strong></span></span></td>
<td><span data-ttu-id="2a38d-142">應用程式通常應該指定 <strong>LUP_FLUSHCACHE</strong>。</span><span class="sxs-lookup"><span data-stu-id="2a38d-142">Applications should generally specify <strong>LUP_FLUSHCACHE</strong>.</span></span> <span data-ttu-id="2a38d-143">此旗標會指示系統忽略任何快取的資訊，並建立與指定裝置的無線 SDP 連線，以執行 SDP 搜尋。</span><span class="sxs-lookup"><span data-stu-id="2a38d-143">This flag instructs the system to ignore any cached information and establish an over-the-air SDP connection to the specified device to perform the SDP search.</span></span> <span data-ttu-id="2a38d-144">這種非快取的作業可能需要幾秒鐘的時間 (而快取的搜尋會迅速傳回) 。</span><span class="sxs-lookup"><span data-stu-id="2a38d-144">This non-cached operation may take several seconds (whereas a cached search returns quickly).</span></span> <span data-ttu-id="2a38d-145">藍牙目前不會主動快取來自鄰近裝置的 SDP 記錄，也不會主動快取先前的查詢。</span><span class="sxs-lookup"><span data-stu-id="2a38d-145">Bluetooth currently does not proactively cache SDP records from nearby devices, nor does it currently aggressively cache previous queries.</span></span> <span data-ttu-id="2a38d-146">因此，如果未指定<strong>LUP_FLUSHCACHE</strong> ，應用程式應該預期查詢可能不會傳回任何結果 (錯誤碼為<strong>WSASERVICE_NOT_FOUND</strong>) 。</span><span class="sxs-lookup"><span data-stu-id="2a38d-146">Therefore, applications should anticipate that queries may return no results (with an error code of <strong>WSASERVICE_NOT_FOUND</strong>) if <strong>LUP_FLUSHCACHE</strong> is not specified.</span></span> <span data-ttu-id="2a38d-147">使用 Windows 通訊端介面所提供的快取資料可能會在未來增強。</span><span class="sxs-lookup"><span data-stu-id="2a38d-147">The cached data that is available by using the Windows Sockets interface may be enhanced in the future.</span></span></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="2a38d-148"><strong>LUP_RES_SERVICE</strong></span><span class="sxs-lookup"><span data-stu-id="2a38d-148"><strong>LUP_RES_SERVICE</strong></span></span></td>
<td><span data-ttu-id="2a38d-149">傳回本機藍牙位址的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="2a38d-149">Return information about the local Bluetooth address.</span></span> <span data-ttu-id="2a38d-150">只有在同時指定 <strong>LUP_RETURN_ADDR</strong> 時，此旗標才會有作用。</span><span class="sxs-lookup"><span data-stu-id="2a38d-150">This flag has an effect only if <strong>LUP_RETURN_ADDR</strong> is also specified.</span></span></td>
</tr>
<tr class="even">
<td><span data-ttu-id="2a38d-151"><strong>LUP_RETURN_NAME</strong></span><span class="sxs-lookup"><span data-stu-id="2a38d-151"><strong>LUP_RETURN_NAME</strong></span></span></td>
<td><span data-ttu-id="2a38d-152">針對每個<a href="/windows/desktop/api/winsock2/nf-winsock2-wsalookupservicenexta"><strong>WSALookupServiceNext</strong></a>函數的呼叫，傳回<a href="/windows/desktop/api/winsock2/ns-winsock2-wsaquerysetw"><strong>WSAQUERYSET</strong></a>結構之<strong>lpszServiceInstanceName</strong>成員中的服務顯示名稱。</span><span class="sxs-lookup"><span data-stu-id="2a38d-152">Return the display name of the service in the <strong>lpszServiceInstanceName</strong> member of the <a href="/windows/desktop/api/winsock2/ns-winsock2-wsaquerysetw"><strong>WSAQUERYSET</strong></a> structure for each call to the <a href="/windows/desktop/api/winsock2/nf-winsock2-wsalookupservicenexta"><strong>WSALookupServiceNext</strong></a> function.</span></span></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="2a38d-153"><strong>LUP_RETURN_TYPE</strong></span><span class="sxs-lookup"><span data-stu-id="2a38d-153"><strong>LUP_RETURN_TYPE</strong></span></span></td>
<td><span data-ttu-id="2a38d-154">傳回<a href="/windows/desktop/api/winsock2/ns-winsock2-wsaquerysetw"><strong>WSAQUERYSET</strong></a>結構之<strong>lpServiceClassId</strong>成員中的服務類別識別碼。</span><span class="sxs-lookup"><span data-stu-id="2a38d-154">Return the service class ID in the <strong>lpServiceClassId</strong> member of the <a href="/windows/desktop/api/winsock2/ns-winsock2-wsaquerysetw"><strong>WSAQUERYSET</strong></a> structure.</span></span>
<blockquote>
[!Note]<br />
<span data-ttu-id="2a38d-155">此旗標的使用只適用于 <a href="/windows/desktop/api/winsock2/nf-winsock2-wsalookupservicebegina"><strong>WSALookupServiceBegin</strong></a> 函數。</span><span class="sxs-lookup"><span data-stu-id="2a38d-155">Use of this flag is only applicable to the <a href="/windows/desktop/api/winsock2/nf-winsock2-wsalookupservicebegina"><strong>WSALookupServiceBegin</strong></a> function.</span></span> <span data-ttu-id="2a38d-156"><a href="/windows/desktop/api/winsock2/nf-winsock2-wsalookupservicenexta"><strong>WSALookupServiceNext</strong></a>的這個值一律為零。</span><span class="sxs-lookup"><span data-stu-id="2a38d-156">This value is always zero for <a href="/windows/desktop/api/winsock2/nf-winsock2-wsalookupservicenexta"><strong>WSALookupServiceNext</strong></a>.</span></span>
</blockquote>
<br/></td>
</tr>
<tr class="even">
<td><span data-ttu-id="2a38d-157"><strong>LUP_RETURN_ADDR</strong></span><span class="sxs-lookup"><span data-stu-id="2a38d-157"><strong>LUP_RETURN_ADDR</strong></span></span></td>
<td><span data-ttu-id="2a38d-158">傳回 <strong>lpcsaBuffer</strong> 成員中要搭配 <a href="/windows/desktop/api/winsock2/nf-winsock2-connect"><strong>連接</strong></a> 函式呼叫使用的位址。</span><span class="sxs-lookup"><span data-stu-id="2a38d-158">Return an address in the <strong>lpcsaBuffer</strong> member to be used with <a href="/windows/desktop/api/winsock2/nf-winsock2-connect"><strong>connect</strong></a> function calls.</span></span> <span data-ttu-id="2a38d-159">傳回的位址包含埠號碼。</span><span class="sxs-lookup"><span data-stu-id="2a38d-159">The returned address contains the port number.</span></span></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="2a38d-160"><strong>LUP_RETURN_BLOB</strong></span><span class="sxs-lookup"><span data-stu-id="2a38d-160"><strong>LUP_RETURN_BLOB</strong></span></span></td>
<td><span data-ttu-id="2a38d-161">傳回 <strong>lpBlob</strong> 成員中相符的 SD 記錄，並根據藍牙 SDP 記錄規格進行格式化。</span><span class="sxs-lookup"><span data-stu-id="2a38d-161">Return the matching SD records in the <strong>lpBlob</strong> member, formatted according to the Bluetooth SDP record specification.</span></span></td>
</tr>
<tr class="even">
<td><span data-ttu-id="2a38d-162"><strong>LUP_RETURN_ALL</strong></span><span class="sxs-lookup"><span data-stu-id="2a38d-162"><strong>LUP_RETURN_ALL</strong></span></span></td>
<td><span data-ttu-id="2a38d-163">傳回上述所有旗標的資訊。</span><span class="sxs-lookup"><span data-stu-id="2a38d-163">Return all of the above flags' information.</span></span></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="2a38d-164"><strong>LUP_RETURN_COMMENT</strong></span><span class="sxs-lookup"><span data-stu-id="2a38d-164"><strong>LUP_RETURN_COMMENT</strong></span></span></td>
<td><span data-ttu-id="2a38d-165">針對每個<a href="/windows/desktop/api/winsock2/nf-winsock2-wsalookupservicenexta"><strong>WSALookupServiceNext</strong></a>函式呼叫，傳回<a href="/windows/desktop/api/winsock2/ns-winsock2-wsaquerysetw"><strong>WSAQUERYSET</strong></a>結構之<strong>lpszComment</strong>成員中的服務描述。</span><span class="sxs-lookup"><span data-stu-id="2a38d-165">Return the service description in the <strong>lpszComment</strong> member of the <a href="/windows/desktop/api/winsock2/ns-winsock2-wsaquerysetw"><strong>WSAQUERYSET</strong></a> structure for each call to the <a href="/windows/desktop/api/winsock2/nf-winsock2-wsalookupservicenexta"><strong>WSALookupServiceNext</strong></a> function.</span></span></td>
</tr>
<tr class="even">
<td><span data-ttu-id="2a38d-166"><strong>LUP_FLUSHPREVIOUS</strong></span><span class="sxs-lookup"><span data-stu-id="2a38d-166"><strong>LUP_FLUSHPREVIOUS</strong></span></span></td>
<td><span data-ttu-id="2a38d-167">略過下一個可用的記錄，然後傳回其後的記錄。</span><span class="sxs-lookup"><span data-stu-id="2a38d-167">Skip the next available record, and return the record that follows it.</span></span></td>
</tr>
</tbody>
</table>



 

## <a name="advanced-service-queries"></a><span data-ttu-id="2a38d-168">Advanced Services 查詢</span><span class="sxs-lookup"><span data-stu-id="2a38d-168">Advanced Service Queries</span></span>

<span data-ttu-id="2a38d-169">上一節所描述的查詢作業可以用來傳回單一 GUID 的所有結果，這對大部分的應用程式而言都是足夠的。</span><span class="sxs-lookup"><span data-stu-id="2a38d-169">The query operations that are described in the previous section can be used to return all results from a single GUID, which should be sufficient for most applications.</span></span> <span data-ttu-id="2a38d-170">Advanced query 可讓應用程式建立更明確的查詢;它提供在傳回的資訊中比對 Uuid 和屬性的功能。</span><span class="sxs-lookup"><span data-stu-id="2a38d-170">An advanced query enables an application to create a more specific query; it provides the capability to match UUIDs and attributes in returned information.</span></span>

<span data-ttu-id="2a38d-171">若要執行服務的 advanced query，藍牙用戶端必須在傳遞至 *lpqsRestrictions* 參數的 [**WSAQUERYSET**](/windows/desktop/api/winsock2/ns-winsock2-wsaquerysetw)結構中指定下列限制。</span><span class="sxs-lookup"><span data-stu-id="2a38d-171">To perform an advanced query for services, Bluetooth clients must specify the following restrictions in the [**WSAQUERYSET**](/windows/desktop/api/winsock2/ns-winsock2-wsaquerysetw) structure that is passed into the *lpqsRestrictions* parameter.</span></span>



| <span data-ttu-id="2a38d-172">WSAQUERYSET 成員</span><span class="sxs-lookup"><span data-stu-id="2a38d-172">WSAQUERYSET member</span></span>   | <span data-ttu-id="2a38d-173">限制</span><span class="sxs-lookup"><span data-stu-id="2a38d-173">Restriction</span></span>                                                                                                                                                                                                                                                                                                                         |
|----------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="2a38d-174">**dwSize**</span><span class="sxs-lookup"><span data-stu-id="2a38d-174">**dwSize**</span></span>           | <span data-ttu-id="2a38d-175">設定為 **sizeof** ([**WSAQUERYSET**](/windows/desktop/api/winsock2/ns-winsock2-wsaquerysetw)) 。</span><span class="sxs-lookup"><span data-stu-id="2a38d-175">Set to **sizeof**([**WSAQUERYSET**](/windows/desktop/api/winsock2/ns-winsock2-wsaquerysetw)).</span></span>                                                                                                                                                                                                                                                                        |
| <span data-ttu-id="2a38d-176">**lpszCoNtext**</span><span class="sxs-lookup"><span data-stu-id="2a38d-176">**lpszContext**</span></span>      | <span data-ttu-id="2a38d-177">設定為要用來建立用來執行服務查詢之 SDP 連接的藍牙裝置位址。</span><span class="sxs-lookup"><span data-stu-id="2a38d-177">Set to the Bluetooth Device Address with which to establish an SDP connection to perform the query of services.</span></span> <span data-ttu-id="2a38d-178">此成員必須是使用 [**WSAAddressToString**](/windows/desktop/api/winsock2/nf-winsock2-wsaaddresstostringa) 函數進行轉換的字串。</span><span class="sxs-lookup"><span data-stu-id="2a38d-178">This member must be a string that is converted by using the [**WSAAddressToString**](/windows/desktop/api/winsock2/nf-winsock2-wsaaddresstostringa) function.</span></span> <span data-ttu-id="2a38d-179">如果提供了本機無線電位址，則會搜尋本機的 SDP 記錄。</span><span class="sxs-lookup"><span data-stu-id="2a38d-179">If the local radio address is supplied, the local SDP records are searched.</span></span><br/> |
| <span data-ttu-id="2a38d-180">**lpBlob.pBlobData**</span><span class="sxs-lookup"><span data-stu-id="2a38d-180">**lpBlob.pBlobData**</span></span> | <span data-ttu-id="2a38d-181">[**BTH \_ 查詢 \_ 服務**](/windows/desktop/api/Ws2bth/ns-ws2bth-bth_query_service)結構的指標，其中包含所有限制查詢結果的參數。</span><span class="sxs-lookup"><span data-stu-id="2a38d-181">Pointer to a [**BTH\_QUERY\_SERVICE**](/windows/desktop/api/Ws2bth/ns-ws2bth-bth_query_service) structure that contains all parameters that limit the results of the query.</span></span>                                                                                                                                                                                           |
| <span data-ttu-id="2a38d-182">**dwNameSpace**</span><span class="sxs-lookup"><span data-stu-id="2a38d-182">**dwNameSpace**</span></span>      | <span data-ttu-id="2a38d-183">設定為 **NS \_ BTH**。</span><span class="sxs-lookup"><span data-stu-id="2a38d-183">Set to **NS\_BTH**.</span></span>                                                                                                                                                                                                                                                                                                                 |
| <span data-ttu-id="2a38d-184">其他成員</span><span class="sxs-lookup"><span data-stu-id="2a38d-184">Other members</span></span>        | <span data-ttu-id="2a38d-185">[**WSAQUERYSET**](/windows/desktop/api/winsock2/ns-winsock2-wsaquerysetw)結構的所有其他成員都會被忽略。</span><span class="sxs-lookup"><span data-stu-id="2a38d-185">All other members of the [**WSAQUERYSET**](/windows/desktop/api/winsock2/ns-winsock2-wsaquerysetw) structure are ignored.</span></span>                                                                                                                                                                                                                                            |



 

<span data-ttu-id="2a38d-186">下列旗標會在 [**WSALookupServiceBegin**](/windows/desktop/api/winsock2/nf-winsock2-wsalookupservicebegina)的 *dwControlFlags* 參數中傳遞，以控制 advanced 查詢的結果。</span><span class="sxs-lookup"><span data-stu-id="2a38d-186">The following flags are passed in the *dwControlFlags* parameter of [**WSALookupServiceBegin**](/windows/desktop/api/winsock2/nf-winsock2-wsalookupservicebegina) to control the results of an advanced query.</span></span>

| <span data-ttu-id="2a38d-187">旗標</span><span class="sxs-lookup"><span data-stu-id="2a38d-187">Flag</span></span>                     | <span data-ttu-id="2a38d-188">結果</span><span class="sxs-lookup"><span data-stu-id="2a38d-188">Result</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|--------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="2a38d-189">**LUP \_ 容器**</span><span class="sxs-lookup"><span data-stu-id="2a38d-189">**LUP\_CONTAINERS**</span></span>      | <span data-ttu-id="2a38d-190">不得設定。</span><span class="sxs-lookup"><span data-stu-id="2a38d-190">Must not be set.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| <span data-ttu-id="2a38d-191">**LUP \_ FLUSHCACHE**</span><span class="sxs-lookup"><span data-stu-id="2a38d-191">**LUP\_FLUSHCACHE**</span></span>      | <span data-ttu-id="2a38d-192">應用程式通常應該會指定 **LUP \_ FLUSHCACHE**。</span><span class="sxs-lookup"><span data-stu-id="2a38d-192">Applications should generally specify **LUP\_FLUSHCACHE**.</span></span> <span data-ttu-id="2a38d-193">此旗標會指示系統忽略任何快取的資訊，並建立與指定裝置的無線 SDP 連線，以執行 SDP 搜尋。</span><span class="sxs-lookup"><span data-stu-id="2a38d-193">This flag instructs the system to ignore any cached information and establish an over-the-air SDP connection to the specified device to perform the SDP search.</span></span> <span data-ttu-id="2a38d-194">這種非快取的作業可能需要幾秒鐘的時間 (而快取的搜尋會迅速傳回) 。</span><span class="sxs-lookup"><span data-stu-id="2a38d-194">This non-cached operation may take several seconds (whereas a cached search returns quickly).</span></span> <span data-ttu-id="2a38d-195">藍牙不會主動快取鄰近裝置的 SDP 記錄，也不會積極快取先前的查詢。</span><span class="sxs-lookup"><span data-stu-id="2a38d-195">Bluetooth does not proactively cache SDP records from nearby devices, nor does it aggressively cache previous queries.</span></span> <span data-ttu-id="2a38d-196">因此，如果未指定 **LUP \_ FLUSHCACHE** ，應用程式應該會預期查詢可能會頻繁地傳回結果， (找 **\_ 不 \_ 到 WSASERVICE**) 。</span><span class="sxs-lookup"><span data-stu-id="2a38d-196">Therefore applications should expect that queries may frequently return no results (**WSASERVICE\_NOT\_FOUND**) if **LUP\_FLUSHCACHE** is not specified.</span></span> <span data-ttu-id="2a38d-197">使用 Windows 通訊端介面所提供的快取資料可能會在未來增強。</span><span class="sxs-lookup"><span data-stu-id="2a38d-197">The cached data that is available by using the Windows Sockets interface may be enhanced in the future.</span></span> |
| <span data-ttu-id="2a38d-198">**LUP \_ RES \_ 服務**</span><span class="sxs-lookup"><span data-stu-id="2a38d-198">**LUP\_RES\_SERVICE**</span></span>    | <span data-ttu-id="2a38d-199">傳回本機藍牙位址的資訊。</span><span class="sxs-lookup"><span data-stu-id="2a38d-199">Return information for the local Bluetooth Address.</span></span> <span data-ttu-id="2a38d-200">只有在同時指定 **LUP 傳回 \_ \_ ADDRR** 時，才會設定這個旗標的效果。</span><span class="sxs-lookup"><span data-stu-id="2a38d-200">Setting this flag has an effect only if **LUP\_RETURN\_ADDRR** is also specified.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| <span data-ttu-id="2a38d-201">**LUP \_ 傳回 \_ 名稱**</span><span class="sxs-lookup"><span data-stu-id="2a38d-201">**LUP\_RETURN\_NAME**</span></span>    | <span data-ttu-id="2a38d-202">傳回服務的顯示名稱。</span><span class="sxs-lookup"><span data-stu-id="2a38d-202">Return the display name of the service.</span></span> <span data-ttu-id="2a38d-203">針對 **SDP \_ 服務 \_ 搜尋 \_ 要求**，會忽略此旗標。</span><span class="sxs-lookup"><span data-stu-id="2a38d-203">This flag is ignored for **SDP\_SERVICE\_SEARCH\_REQUEST**.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| <span data-ttu-id="2a38d-204">**LUP \_ 傳回 \_ 類型**</span><span class="sxs-lookup"><span data-stu-id="2a38d-204">**LUP\_RETURN\_TYPE**</span></span>    | <span data-ttu-id="2a38d-205">傳回服務類別識別碼。</span><span class="sxs-lookup"><span data-stu-id="2a38d-205">Return the service class ID.</span></span> <span data-ttu-id="2a38d-206">針對 **SDP \_ 服務 \_ 搜尋 \_ 要求**，會忽略此旗標。</span><span class="sxs-lookup"><span data-stu-id="2a38d-206">This flag is ignored for **SDP\_SERVICE\_SEARCH\_REQUEST**.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| <span data-ttu-id="2a38d-207">**LUP \_ 傳回 \_ 位址**</span><span class="sxs-lookup"><span data-stu-id="2a38d-207">**LUP\_RETURN\_ADDR**</span></span>    | <span data-ttu-id="2a38d-208">傳回 **lpcsaBuffer** 成員中要搭配 [**連接**](/windows/desktop/api/winsock2/nf-winsock2-connect) 函式呼叫使用的位址。</span><span class="sxs-lookup"><span data-stu-id="2a38d-208">Return an address in the **lpcsaBuffer** member to be used with [**connect**](/windows/desktop/api/winsock2/nf-winsock2-connect) function calls.</span></span> <span data-ttu-id="2a38d-209">傳回的位址包含埠號碼。</span><span class="sxs-lookup"><span data-stu-id="2a38d-209">The returned address contains the port number.</span></span> <span data-ttu-id="2a38d-210">針對 **SDP \_ 服務 \_ 搜尋 \_ 要求**，會忽略此旗標。</span><span class="sxs-lookup"><span data-stu-id="2a38d-210">This flag is ignored for **SDP\_SERVICE\_SEARCH\_REQUEST**.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| <span data-ttu-id="2a38d-211">**LUP \_ 傳回 \_ BLOB**</span><span class="sxs-lookup"><span data-stu-id="2a38d-211">**LUP\_RETURN\_BLOB**</span></span>    | <span data-ttu-id="2a38d-212">以符合藍牙 SDP 記錄規格的格式傳回相符的 SD 記錄。</span><span class="sxs-lookup"><span data-stu-id="2a38d-212">Return the matching SD records in a format that conforms to the Bluetooth SDP record specification.</span></span> <span data-ttu-id="2a38d-213">針對 **SDP \_ 服務 \_ 搜尋 \_ 要求**，後續呼叫 [**WSALOOKUPSERVICENEXT**](/windows/desktop/api/winsock2/nf-winsock2-wsalookupservicenexta)的 **lpBlob** 結果是藍牙 SDP 控點的陣列。</span><span class="sxs-lookup"><span data-stu-id="2a38d-213">For **SDP\_SERVICE\_SEARCH\_REQUEST**, the result in **lpBlob** for the subsequent call to [**WSALookupServiceNext**](/windows/desktop/api/winsock2/nf-winsock2-wsalookupservicenexta) is an array of Bluetooth SDP handles.</span></span> <span data-ttu-id="2a38d-214">針對 **sdp \_ 服務 \_ 屬性 \_ 要求** 和 **sdp \_ 服務 \_ 搜尋 \_ 屬性 \_ 要求**，每個後續呼叫 **WSALookupServiceNext** 的結果都是二進位 Bluetooth SDP 記錄，其屬性會限制為查詢的 **pRange** 成員所指定的屬性。</span><span class="sxs-lookup"><span data-stu-id="2a38d-214">For **SDP\_SERVICE\_ATTRIBUTE\_REQUEST** and **SDP\_SERVICE\_SEARCH\_ATTRIBUTE\_REQUEST**, the result for each subsequent call to **WSALookupServiceNext** is a binary Bluetooth SDP record whose attributes are restricted to those specified by the **pRange** member of the query.</span></span> <span data-ttu-id="2a38d-215">此旗標是 **SDP \_ 服務 \_ 搜尋 \_ 要求** 的必要項。</span><span class="sxs-lookup"><span data-stu-id="2a38d-215">This flag is required for **SDP\_SERVICE\_SEARCH\_REQUEST**.</span></span>                                                               |
| <span data-ttu-id="2a38d-216">**LUP \_ 傳回 \_ 批註**</span><span class="sxs-lookup"><span data-stu-id="2a38d-216">**LUP\_RETURN\_COMMENT**</span></span> | <span data-ttu-id="2a38d-217">針對每個 [**WSALookupServiceNext**](/windows/desktop/api/winsock2/nf-winsock2-wsalookupservicenexta)函式呼叫，傳回 [**WSAQUERYSET**](/windows/desktop/api/winsock2/ns-winsock2-wsaquerysetw)結構之 **lpszComment** 成員中的服務描述。</span><span class="sxs-lookup"><span data-stu-id="2a38d-217">Return the service description in the **lpszComment** member of the [**WSAQUERYSET**](/windows/desktop/api/winsock2/ns-winsock2-wsaquerysetw) structure for each call to the [**WSALookupServiceNext**](/windows/desktop/api/winsock2/nf-winsock2-wsalookupservicenexta) function.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| <span data-ttu-id="2a38d-218">**LUP \_ FLUSHPREVIOUS**</span><span class="sxs-lookup"><span data-stu-id="2a38d-218">**LUP\_FLUSHPREVIOUS**</span></span>   | <span data-ttu-id="2a38d-219">略過下一個可用的記錄，然後傳回其後的記錄。</span><span class="sxs-lookup"><span data-stu-id="2a38d-219">Skip the next available record, and return the record that follows it.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |



 

<span data-ttu-id="2a38d-220">在輸入時， **lpBlob** -> **pBlobData** 會指向 [**BTH \_ 查詢 \_ 服務**](/windows/desktop/api/Ws2bth/ns-ws2bth-bth_query_service)結構，其中包含下表所列的值。</span><span class="sxs-lookup"><span data-stu-id="2a38d-220">On input, **lpBlob**->**pBlobData** points to a [**BTH\_QUERY\_SERVICE**](/windows/desktop/api/Ws2bth/ns-ws2bth-bth_query_service) structure that contains the values listed in the following table.</span></span>

> [!Note]  
> <span data-ttu-id="2a38d-221">初始搜尋要求必須能夠符合一個 L2CAP 封包。</span><span class="sxs-lookup"><span data-stu-id="2a38d-221">The initial search request must be able to fit into one L2CAP packet.</span></span> <span data-ttu-id="2a38d-222">不過，回應可能會分成許多 L2CAP 封包。</span><span class="sxs-lookup"><span data-stu-id="2a38d-222">The response, however, may be broken into many L2CAP packets.</span></span>

 



| <span data-ttu-id="2a38d-223">成員</span><span class="sxs-lookup"><span data-stu-id="2a38d-223">Member</span></span>            | <span data-ttu-id="2a38d-224">值</span><span class="sxs-lookup"><span data-stu-id="2a38d-224">Value</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|-------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="2a38d-225">**type**</span><span class="sxs-lookup"><span data-stu-id="2a38d-225">**type**</span></span>          | <span data-ttu-id="2a38d-226">要執行的搜尋類型。</span><span class="sxs-lookup"><span data-stu-id="2a38d-226">Type of search to perform.</span></span> <span data-ttu-id="2a38d-227">此值可以是 **sdp \_ 服務 \_ 搜尋 \_ 要求**、 **sdp \_ 服務 \_ 屬性 \_ 要求** 或 **sdp \_ 服務 \_ 搜尋 \_ 屬性 \_ 要求** 的其中一個。</span><span class="sxs-lookup"><span data-stu-id="2a38d-227">This value can be one of **SDP\_SERVICE\_SEARCH\_REQUEST**, **SDP\_SERVICE\_ATTRIBUTE\_REQUEST**, or **SDP\_SERVICE\_SEARCH\_ATTRIBUTE\_REQUEST**.</span></span> <span data-ttu-id="2a38d-228">每種搜尋類型都與藍牙 SDP 規格所定義的基礎搜尋機制相關聯。</span><span class="sxs-lookup"><span data-stu-id="2a38d-228">Each search type is associated with an underlying search mechanism that is defined by the Bluetooth SDP specification.</span></span> <span data-ttu-id="2a38d-229">每個傳回的結果都是 [**WSAQUERYSET**](/windows/desktop/api/winsock2/ns-winsock2-wsaquerysetw) 結構所描述的表單，這是稍早在此 (Advanced services 查詢) 一節中所定義。</span><span class="sxs-lookup"><span data-stu-id="2a38d-229">Each return results in the form described by the [**WSAQUERYSET**](/windows/desktop/api/winsock2/ns-winsock2-wsaquerysetw) structure that is defined earlier in this (Advanced Service Queries) section.</span></span> |
| <span data-ttu-id="2a38d-230">**serviceHandle**</span><span class="sxs-lookup"><span data-stu-id="2a38d-230">**serviceHandle**</span></span> | <span data-ttu-id="2a38d-231">用於屬性搜尋。</span><span class="sxs-lookup"><span data-stu-id="2a38d-231">Used for attribute searches.</span></span> <span data-ttu-id="2a38d-232">這個值會指定用來查詢 **pRange** 成員中屬性的服務控制碼。</span><span class="sxs-lookup"><span data-stu-id="2a38d-232">This value specifies the service handle with which to query the attributes in the **pRange** member.</span></span>                                                                                                                                                                                                                                                                                                                                            |
| <span data-ttu-id="2a38d-233">**uuid**</span><span class="sxs-lookup"><span data-stu-id="2a38d-233">**uuids**</span></span>         | <span data-ttu-id="2a38d-234">用於服務和 **serviceAttribute** 搜尋。</span><span class="sxs-lookup"><span data-stu-id="2a38d-234">Used for service and **serviceAttribute** searches.</span></span> <span data-ttu-id="2a38d-235">此值指定記錄必須包含以符合搜尋的 Uuid。</span><span class="sxs-lookup"><span data-stu-id="2a38d-235">This value specifies the UUIDs that a record must contain to match the search.</span></span> <span data-ttu-id="2a38d-236">如果要查詢 **\_ 查詢 uuid \_ 中 \_ 的最大 uuid** ，此值會將緊接在最後一個有效 UUID 之後的 SdpQueryUuid 元素設定為全部零。</span><span class="sxs-lookup"><span data-stu-id="2a38d-236">If less than **MAX\_UUIDS\_IN\_QUERY** UUIDs are to be queried, this value sets the SdpQueryUuid element that immediately follows the last valid UUID to all zeros.</span></span>                                                                                                                                                                       |
| <span data-ttu-id="2a38d-237">**numRange**</span><span class="sxs-lookup"><span data-stu-id="2a38d-237">**numRange**</span></span>      | <span data-ttu-id="2a38d-238">用於屬性和 **serviceAttribute** 搜尋。</span><span class="sxs-lookup"><span data-stu-id="2a38d-238">Used for attribute and **serviceAttribute** searches.</span></span> <span data-ttu-id="2a38d-239">這個值會指定 **pRange** 中的元素數目。</span><span class="sxs-lookup"><span data-stu-id="2a38d-239">This value specifies the number of elements in **pRange**.</span></span>                                                                                                                                                                                                                                                                                                                                                             |
| <span data-ttu-id="2a38d-240">**pRange**</span><span class="sxs-lookup"><span data-stu-id="2a38d-240">**pRange**</span></span>        | <span data-ttu-id="2a38d-241">用於屬性和 **serviceAttribute** 搜尋。</span><span class="sxs-lookup"><span data-stu-id="2a38d-241">Used for attribute and **serviceAttribute** searches.</span></span> <span data-ttu-id="2a38d-242">此值會指定要針對任何相符記錄取得的屬性值。</span><span class="sxs-lookup"><span data-stu-id="2a38d-242">This value specifies the attribute values to retrieve for any matching records.</span></span>                                                                                                                                                                                                                                                                                                                                        |



 

<span data-ttu-id="2a38d-243">在每次成功呼叫 [**WSALookupServiceNext**](/windows/desktop/api/winsock2/nf-winsock2-wsalookupservicenexta)函數之後， **lpBlob** -> **pBlobData** 會指向包含下表所列值的資料區塊。</span><span class="sxs-lookup"><span data-stu-id="2a38d-243">After each successful call to the [**WSALookupServiceNext**](/windows/desktop/api/winsock2/nf-winsock2-wsalookupservicenexta) function, **lpBlob**->**pBlobData** points to a block of data that contains the values listed in the following table.</span></span>

| <span data-ttu-id="2a38d-244">值</span><span class="sxs-lookup"><span data-stu-id="2a38d-244">Value</span></span>                                                                                | <span data-ttu-id="2a38d-245">描述</span><span class="sxs-lookup"><span data-stu-id="2a38d-245">Description</span></span>                                                                                                                                                                                                                                                                                                                                          |
|--------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="2a38d-246">**SDP \_ 服務 \_ 搜尋 \_ 要求**</span><span class="sxs-lookup"><span data-stu-id="2a38d-246">**SDP\_SERVICE\_SEARCH\_REQUEST**</span></span>                                                    | <span data-ttu-id="2a38d-247">SDP 記錄控制碼的陣列，與藍牙 1.1 SDP 4.5.2 所定義的 **ServiceRecordHandleList** 相同。</span><span class="sxs-lookup"><span data-stu-id="2a38d-247">An array of SDP record handles that is identical to the **ServiceRecordHandleList** defined by Bluetooth 1.1 SDP 4.5.2.</span></span> <span data-ttu-id="2a38d-248">傳回的 SDP 控制碼數目是由 (**lpBlob**->cbSize) /**sizeof** (ULONG) 所計算。</span><span class="sxs-lookup"><span data-stu-id="2a38d-248">The number of SDP handles that is returned is calculated by (**lpBlob**->cbSize)/**sizeof**(ULONG).</span></span> <span data-ttu-id="2a38d-249">[**WSALookupServiceNext**](/windows/desktop/api/winsock2/nf-winsock2-wsalookupservicenexta)函式的單一呼叫會傳回所有結果。</span><span class="sxs-lookup"><span data-stu-id="2a38d-249">All results are returned in a single call to the [**WSALookupServiceNext**](/windows/desktop/api/winsock2/nf-winsock2-wsalookupservicenexta) function.</span></span> |
| <span data-ttu-id="2a38d-250">**SDP \_服務 \_ 屬性 \_ 要求** 或 **SDP \_ 服務 \_ 搜尋 \_ 屬性 \_ 要求**</span><span class="sxs-lookup"><span data-stu-id="2a38d-250">**SDP\_SERVICE\_ATTRIBUTE\_REQUEST** or **SDP\_SERVICE\_SEARCH\_ATTRIBUTE\_REQUEST**</span></span> | <span data-ttu-id="2a38d-251">二進位 Bluetooth SDP 記錄。</span><span class="sxs-lookup"><span data-stu-id="2a38d-251">A binary Bluetooth SDP record.</span></span> <span data-ttu-id="2a38d-252">針對 **SDP \_ 服務 \_ 屬性 \_ 要求**， [**WSALookupServiceNext**](/windows/desktop/api/winsock2/nf-winsock2-wsalookupservicenexta) 函式的單一呼叫會傳回所有結果。</span><span class="sxs-lookup"><span data-stu-id="2a38d-252">For **SDP\_SERVICE\_ATTRIBUTE\_REQUEST**, all results are returned in a single call to the [**WSALookupServiceNext**](/windows/desktop/api/winsock2/nf-winsock2-wsalookupservicenexta) function.</span></span>                                                                                                                                                       |



 

> [!Note]  
> <span data-ttu-id="2a38d-253">如果未在服務查詢的輸入期間指定 **lpBlob** 成員，就會針對 **lpServiceClassId** 成員中指定的服務，執行從0到0xffff 的屬性的服務和屬性搜尋。</span><span class="sxs-lookup"><span data-stu-id="2a38d-253">If the **lpBlob** member is not specified during input for a service query, a service and attribute search is performed for the service specified in the **lpServiceClassId** member on attributes from 0 through 0xFFFF.</span></span>

 

## <a name="related-topics"></a><span data-ttu-id="2a38d-254">相關主題</span><span class="sxs-lookup"><span data-stu-id="2a38d-254">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="2a38d-255">用於服務查詢的藍牙和 WSAQUERYSET</span><span class="sxs-lookup"><span data-stu-id="2a38d-255">Bluetooth and WSAQUERYSET for Service Inquiry</span></span>](bluetooth-and-wsaqueryset-for-service-inquiry.md)
</dt> <dt>

[<span data-ttu-id="2a38d-256">探索藍牙裝置和服務</span><span class="sxs-lookup"><span data-stu-id="2a38d-256">Discovering Bluetooth Devices and Services</span></span>](discovering-bluetooth-devices-and-services.md)
</dt> <dt>

[<span data-ttu-id="2a38d-257">藍牙和 WSALookupServiceNext</span><span class="sxs-lookup"><span data-stu-id="2a38d-257">Bluetooth and WSALookupServiceNext</span></span>](bluetooth-and-wsalookupservicenext.md)
</dt> <dt>

[<span data-ttu-id="2a38d-258">適用于裝置查詢的藍牙和 WSALookupServiceBegin</span><span class="sxs-lookup"><span data-stu-id="2a38d-258">Bluetooth and WSALookupServiceBegin for Device Inquiry</span></span>](bluetooth-and-wsalookupservicebegin-for-device-inquiry.md)
</dt> <dt>

[<span data-ttu-id="2a38d-259">**BTH \_ 查詢 \_ 服務**</span><span class="sxs-lookup"><span data-stu-id="2a38d-259">**BTH\_QUERY\_SERVICE**</span></span>](/windows/desktop/api/Ws2bth/ns-ws2bth-bth_query_service)
</dt> <dt>

[<span data-ttu-id="2a38d-260">**連線**</span><span class="sxs-lookup"><span data-stu-id="2a38d-260">**connect**</span></span>](/windows/desktop/api/winsock2/nf-winsock2-connect)
</dt> <dt>

[<span data-ttu-id="2a38d-261">**SOCKADDR \_ BTH**</span><span class="sxs-lookup"><span data-stu-id="2a38d-261">**SOCKADDR\_BTH**</span></span>](/windows/desktop/api/Ws2bth/ns-ws2bth-sockaddr_bth)
</dt> <dt>

[<span data-ttu-id="2a38d-262">**WSAAddressToString**</span><span class="sxs-lookup"><span data-stu-id="2a38d-262">**WSAAddressToString**</span></span>](/windows/desktop/api/winsock2/nf-winsock2-wsaaddresstostringa)
</dt> <dt>

[<span data-ttu-id="2a38d-263">**WSALookupServiceBegin**</span><span class="sxs-lookup"><span data-stu-id="2a38d-263">**WSALookupServiceBegin**</span></span>](/windows/desktop/api/winsock2/nf-winsock2-wsalookupservicebegina)
</dt> <dt>

[<span data-ttu-id="2a38d-264">**WSALookupServiceEnd**</span><span class="sxs-lookup"><span data-stu-id="2a38d-264">**WSALookupServiceEnd**</span></span>](/windows/desktop/api/winsock2/nf-winsock2-wsalookupserviceend)
</dt> <dt>

[<span data-ttu-id="2a38d-265">**WSALookupServiceNext**</span><span class="sxs-lookup"><span data-stu-id="2a38d-265">**WSALookupServiceNext**</span></span>](/windows/desktop/api/winsock2/nf-winsock2-wsalookupservicenexta)
</dt> <dt>

[<span data-ttu-id="2a38d-266">**WSAQUERYSET**</span><span class="sxs-lookup"><span data-stu-id="2a38d-266">**WSAQUERYSET**</span></span>](/windows/desktop/api/winsock2/ns-winsock2-wsaquerysetw)
</dt> <dt>

[<span data-ttu-id="2a38d-267">Windows Sockets</span><span class="sxs-lookup"><span data-stu-id="2a38d-267">Windows Sockets</span></span>](/windows/desktop/WinSock/windows-sockets-start-page-2)
</dt> </dl>

