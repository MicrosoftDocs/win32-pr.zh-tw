---
description: CMediaSample 類別會定義支援 IMediaSample2 介面的媒體範例。 媒體範例包含記憶體緩衝區的指標，以及儲存為受保護成員變數的各種屬性。
ms.assetid: 1e609c7c-3200-4540-904e-7659976df0da
title: 'CMediaSample 類別 (Amfilter) '
ms.topic: reference
ms.date: 05/31/2018
topic_type:
- APIRef
- kbSyntax
api_name:
- CMediaSample
api_type:
- COM
api_location:
- Strmbase.lib
- Strmbase.dll
- Strmbasd.lib
- Strmbasd.dll
ms.openlocfilehash: 72cfe0f86ff6b6643f2f7793822899136a5c6454
ms.sourcegitcommit: c8ec1ded1ffffc364d3c4f560bb2171da0dc5040
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 03/22/2021
ms.locfileid: "106995908"
---
# <a name="cmediasample-class"></a><span data-ttu-id="1abe5-104">CMediaSample 類別</span><span class="sxs-lookup"><span data-stu-id="1abe5-104">CMediaSample class</span></span>

![cmediasample 類別階層](images/wutil03.png)

<span data-ttu-id="1abe5-106">`CMediaSample`類別會定義支援 [**IMediaSample2**](/windows/desktop/api/Strmif/nn-strmif-imediasample2)介面的媒體範例。</span><span class="sxs-lookup"><span data-stu-id="1abe5-106">The `CMediaSample` class defines a media sample that supports the [**IMediaSample2**](/windows/desktop/api/Strmif/nn-strmif-imediasample2) interface.</span></span> <span data-ttu-id="1abe5-107">媒體範例包含記憶體緩衝區的指標，以及儲存為受保護成員變數的各種屬性。</span><span class="sxs-lookup"><span data-stu-id="1abe5-107">The media sample contains a pointer to a memory buffer, and various properties stored as protected member variables.</span></span>

<span data-ttu-id="1abe5-108">媒體範例是由配置器所建立，其衍生自 [**CBaseAllocator**](cbaseallocator.md) 類別。</span><span class="sxs-lookup"><span data-stu-id="1abe5-108">Media samples are created by allocators, which are derived from the [**CBaseAllocator**](cbaseallocator.md) class.</span></span> <span data-ttu-id="1abe5-109">此函式會接收所配置 `CMediaSample` 緩衝區的指標，以及緩衝區的大小。</span><span class="sxs-lookup"><span data-stu-id="1abe5-109">The `CMediaSample` constructor receives a pointer to an allocated buffer, along with the size of the buffer.</span></span> <span data-ttu-id="1abe5-110">其他屬性通常是透過 [**IMediaSample**](/windows/desktop/api/Strmif/nn-strmif-imediasample) 介面方法來設定和取出。</span><span class="sxs-lookup"><span data-stu-id="1abe5-110">Other properties are typically set and retrieved through [**IMediaSample**](/windows/desktop/api/Strmif/nn-strmif-imediasample) interface methods.</span></span>

<span data-ttu-id="1abe5-111">媒體範例的生命週期與大部分 COM 物件的生命週期不同：</span><span class="sxs-lookup"><span data-stu-id="1abe5-111">The life cycle of a media sample differs from that of most COM objects:</span></span>

-   <span data-ttu-id="1abe5-112">配置器會保留免費範例的清單。</span><span class="sxs-lookup"><span data-stu-id="1abe5-112">The allocator holds a list of free samples.</span></span> <span data-ttu-id="1abe5-113">當篩選準則需要新的範例時，它會呼叫配置器的 [**IMemAllocator：： GetBuffer**](/windows/desktop/api/Strmif/nf-strmif-imemallocator-getbuffer) 方法。</span><span class="sxs-lookup"><span data-stu-id="1abe5-113">When a filter needs a new sample, it calls the allocator's [**IMemAllocator::GetBuffer**](/windows/desktop/api/Strmif/nf-strmif-imemallocator-getbuffer) method.</span></span> <span data-ttu-id="1abe5-114">配置器會從它的可用清單中抓取範例、遞增樣本的參考計數，然後將指標傳回範例。</span><span class="sxs-lookup"><span data-stu-id="1abe5-114">The allocator retrieves a sample from its free list, increments the sample's reference count, and returns a pointer to the sample.</span></span>
-   <span data-ttu-id="1abe5-115">使用範例完成篩選之後，它會在範例上呼叫 **IUnknown：： Release** 方法。</span><span class="sxs-lookup"><span data-stu-id="1abe5-115">After the filter is done with the sample, it calls the **IUnknown::Release** method on the sample.</span></span> <span data-ttu-id="1abe5-116">與大部分的物件不同的是，此範例不會在其參考計數到達零時刪除本身。</span><span class="sxs-lookup"><span data-stu-id="1abe5-116">Unlike most objects, the sample does not delete itself when its reference count reaches zero.</span></span> <span data-ttu-id="1abe5-117">相反地，它會在配置器上呼叫 [**IMemAllocator：： ReleaseBuffer**](/windows/desktop/api/Strmif/nf-strmif-imemallocator-releasebuffer) 方法，而配置器會將範例傳回到可用清單。</span><span class="sxs-lookup"><span data-stu-id="1abe5-117">Instead, it calls the [**IMemAllocator::ReleaseBuffer**](/windows/desktop/api/Strmif/nf-strmif-imemallocator-releasebuffer) method on the allocator, and the allocator returns the sample to its free list.</span></span>
-   <span data-ttu-id="1abe5-118">配置器在呼叫 [**IMemAllocator：:D ecommit**](/windows/desktop/api/Strmif/nf-strmif-imemallocator-decommit) 方法之前，不會終結樣本。</span><span class="sxs-lookup"><span data-stu-id="1abe5-118">The allocator does not destroy samples until the [**IMemAllocator::Decommit**](/windows/desktop/api/Strmif/nf-strmif-imemallocator-decommit) method is called.</span></span>



| <span data-ttu-id="1abe5-119">受保護的成員變數</span><span class="sxs-lookup"><span data-stu-id="1abe5-119">Protected Member Variables</span></span>                                           | <span data-ttu-id="1abe5-120">Description</span><span class="sxs-lookup"><span data-stu-id="1abe5-120">Description</span></span>                                                                                     |
|----------------------------------------------------------------------|-------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="1abe5-121">**m \_ dwFlags**</span><span class="sxs-lookup"><span data-stu-id="1abe5-121">**m\_dwFlags**</span></span>](cmediasample-m-dwflags.md)                         | <span data-ttu-id="1abe5-122">範例屬性旗標。</span><span class="sxs-lookup"><span data-stu-id="1abe5-122">Sample property flags.</span></span>                                                                          |
| [<span data-ttu-id="1abe5-123">**m \_ dwTypeSpecificFlags**</span><span class="sxs-lookup"><span data-stu-id="1abe5-123">**m\_dwTypeSpecificFlags**</span></span>](cmediasample-m-dwtypespecificflags.md) | <span data-ttu-id="1abe5-124">特定類型的旗標。</span><span class="sxs-lookup"><span data-stu-id="1abe5-124">Type-specific flags.</span></span>                                                                            |
| [<span data-ttu-id="1abe5-125">**m \_ pBuffer**</span><span class="sxs-lookup"><span data-stu-id="1abe5-125">**m\_pBuffer**</span></span>](cmediasample-m-pbuffer.md)                         | <span data-ttu-id="1abe5-126">包含媒體資料之記憶體緩衝區的指標。</span><span class="sxs-lookup"><span data-stu-id="1abe5-126">Pointer to the memory buffer that contains the media data.</span></span>                                      |
| [<span data-ttu-id="1abe5-127">**m \_ lActual**</span><span class="sxs-lookup"><span data-stu-id="1abe5-127">**m\_lActual**</span></span>](cmediasample-m-lactual.md)                         | <span data-ttu-id="1abe5-128">緩衝區中有效資料的長度（以位元組為單位）。</span><span class="sxs-lookup"><span data-stu-id="1abe5-128">Length of the valid data in the buffer, in bytes.</span></span>                                               |
| [<span data-ttu-id="1abe5-129">**m \_ cbBuffer**</span><span class="sxs-lookup"><span data-stu-id="1abe5-129">**m\_cbBuffer**</span></span>](cmediasample-m-cbbuffer.md)                       | <span data-ttu-id="1abe5-130">緩衝區的大小（以位元組為單位）。</span><span class="sxs-lookup"><span data-stu-id="1abe5-130">Size of the buffer, in bytes.</span></span>                                                                   |
| [<span data-ttu-id="1abe5-131">**m \_ pAllocator**</span><span class="sxs-lookup"><span data-stu-id="1abe5-131">**m\_pAllocator**</span></span>](cmediasample-m-pallocator.md)                   | <span data-ttu-id="1abe5-132">建立此範例的配置器指標。</span><span class="sxs-lookup"><span data-stu-id="1abe5-132">Pointer to the allocator that created this sample.</span></span>                                              |
| [<span data-ttu-id="1abe5-133">**m \_ pNext**</span><span class="sxs-lookup"><span data-stu-id="1abe5-133">**m\_pNext**</span></span>](cmediasample-m-pnext.md)                             | <span data-ttu-id="1abe5-134">配置器的範例清單中，下一個範例的指標。</span><span class="sxs-lookup"><span data-stu-id="1abe5-134">Pointer to the next sample in the allocator's list of samples.</span></span>                                  |
| [<span data-ttu-id="1abe5-135">**m \_ 開始**</span><span class="sxs-lookup"><span data-stu-id="1abe5-135">**m\_Start**</span></span>](cmediasample-m-start.md)                             | <span data-ttu-id="1abe5-136">範例開始時間。</span><span class="sxs-lookup"><span data-stu-id="1abe5-136">Sample start time.</span></span>                                                                              |
| [<span data-ttu-id="1abe5-137">**m \_ 結束**</span><span class="sxs-lookup"><span data-stu-id="1abe5-137">**m\_End**</span></span>](cmediasample-m-end.md)                                 | <span data-ttu-id="1abe5-138">範例結束時間。</span><span class="sxs-lookup"><span data-stu-id="1abe5-138">Sample end time.</span></span>                                                                                |
| [<span data-ttu-id="1abe5-139">**m \_ MediaStart**</span><span class="sxs-lookup"><span data-stu-id="1abe5-139">**m\_MediaStart**</span></span>](cmediasample-m-mediastart.md)                   | <span data-ttu-id="1abe5-140">媒體開始時間。</span><span class="sxs-lookup"><span data-stu-id="1abe5-140">Media start time.</span></span>                                                                               |
| [<span data-ttu-id="1abe5-141">**m \_ MediaEnd**</span><span class="sxs-lookup"><span data-stu-id="1abe5-141">**m\_MediaEnd**</span></span>](cmediasample-m-mediaend.md)                       | <span data-ttu-id="1abe5-142">媒體停止時間。</span><span class="sxs-lookup"><span data-stu-id="1abe5-142">Media stop time.</span></span>                                                                                |
| [<span data-ttu-id="1abe5-143">**m \_ pMediaType**</span><span class="sxs-lookup"><span data-stu-id="1abe5-143">**m\_pMediaType**</span></span>](cmediasample-m-pmediatype.md)                   | <span data-ttu-id="1abe5-144">媒體類型的指標，如果類型已在資料流程中的前一個範例變更。</span><span class="sxs-lookup"><span data-stu-id="1abe5-144">Pointer to the media type, if the type has changed from the previous sample in the data stream.</span></span> |
| [<span data-ttu-id="1abe5-145">**m \_ dwStreamId**</span><span class="sxs-lookup"><span data-stu-id="1abe5-145">**m\_dwStreamId**</span></span>](cmediasample-m-dwstreamid.md)                   | <span data-ttu-id="1abe5-146">資料流程識別碼。</span><span class="sxs-lookup"><span data-stu-id="1abe5-146">Stream identifier.</span></span>                                                                              |
| <span data-ttu-id="1abe5-147">Public 成員變數</span><span class="sxs-lookup"><span data-stu-id="1abe5-147">Public Member Variables</span></span>                                              | <span data-ttu-id="1abe5-148">Description</span><span class="sxs-lookup"><span data-stu-id="1abe5-148">Description</span></span>                                                                                     |
| [<span data-ttu-id="1abe5-149">**m \_ cRef**</span><span class="sxs-lookup"><span data-stu-id="1abe5-149">**m\_cRef**</span></span>](cmediasample-m-cref.md)                               | <span data-ttu-id="1abe5-150">參考計數。</span><span class="sxs-lookup"><span data-stu-id="1abe5-150">Reference count.</span></span>                                                                                |
| <span data-ttu-id="1abe5-151">公用方法</span><span class="sxs-lookup"><span data-stu-id="1abe5-151">Public Methods</span></span>                                                       | <span data-ttu-id="1abe5-152">Description</span><span class="sxs-lookup"><span data-stu-id="1abe5-152">Description</span></span>                                                                                     |
| [<span data-ttu-id="1abe5-153">**CMediaSample**</span><span class="sxs-lookup"><span data-stu-id="1abe5-153">**CMediaSample**</span></span>](cmediasample-cmediasample.md)                    | <span data-ttu-id="1abe5-154">函式方法。</span><span class="sxs-lookup"><span data-stu-id="1abe5-154">Constructor method.</span></span>                                                                             |
| [<span data-ttu-id="1abe5-155">**~ CMediaSample**</span><span class="sxs-lookup"><span data-stu-id="1abe5-155">**~ CMediaSample**</span></span>](cmediasample--cmediasample.md)                 | <span data-ttu-id="1abe5-156">函式方法。</span><span class="sxs-lookup"><span data-stu-id="1abe5-156">Destructor method.</span></span> <span data-ttu-id="1abe5-157">虛擬。</span><span class="sxs-lookup"><span data-stu-id="1abe5-157">Virtual.</span></span>                                                                     |
| [<span data-ttu-id="1abe5-158">**SetPointer**</span><span class="sxs-lookup"><span data-stu-id="1abe5-158">**SetPointer**</span></span>](cmediasample-setpointer.md)                        | <span data-ttu-id="1abe5-159">設定記憶體緩衝區的指標。</span><span class="sxs-lookup"><span data-stu-id="1abe5-159">Sets the pointer to the memory buffer.</span></span>                                                          |
| <span data-ttu-id="1abe5-160">IMediaSample 方法</span><span class="sxs-lookup"><span data-stu-id="1abe5-160">IMediaSample Methods</span></span>                                                 | <span data-ttu-id="1abe5-161">Description</span><span class="sxs-lookup"><span data-stu-id="1abe5-161">Description</span></span>                                                                                     |
| [<span data-ttu-id="1abe5-162">**GetPointer**</span><span class="sxs-lookup"><span data-stu-id="1abe5-162">**GetPointer**</span></span>](cmediasample-getpointer.md)                        | <span data-ttu-id="1abe5-163">擷取緩衝區的讀取/寫入指標。</span><span class="sxs-lookup"><span data-stu-id="1abe5-163">Retrieves a read/write pointer to the buffer.</span></span>                                                   |
| [<span data-ttu-id="1abe5-164">**GetSize**</span><span class="sxs-lookup"><span data-stu-id="1abe5-164">**GetSize**</span></span>](cmediasample-getsize.md)                              | <span data-ttu-id="1abe5-165">擷取緩衝區的大小。</span><span class="sxs-lookup"><span data-stu-id="1abe5-165">Retrieves the size of the buffer.</span></span>                                                               |
| [<span data-ttu-id="1abe5-166">**GetTime**</span><span class="sxs-lookup"><span data-stu-id="1abe5-166">**GetTime**</span></span>](cmediasample-gettime.md)                              | <span data-ttu-id="1abe5-167">抓取此範例應開始及完成的資料流程時間。</span><span class="sxs-lookup"><span data-stu-id="1abe5-167">Retrieves the stream times at which this sample should begin and finish.</span></span>                        |
| [<span data-ttu-id="1abe5-168">**SetTime**</span><span class="sxs-lookup"><span data-stu-id="1abe5-168">**SetTime**</span></span>](cmediasample-settime.md)                              | <span data-ttu-id="1abe5-169">設定此範例應開始及完成的資料流程時間。</span><span class="sxs-lookup"><span data-stu-id="1abe5-169">Sets the stream times at which this sample should start and finish.</span></span>                             |
| [<span data-ttu-id="1abe5-170">**IsSyncPoint**</span><span class="sxs-lookup"><span data-stu-id="1abe5-170">**IsSyncPoint**</span></span>](cmediasample-issyncpoint.md)                      | <span data-ttu-id="1abe5-171">判斷範例的開頭是否為同步處理點。</span><span class="sxs-lookup"><span data-stu-id="1abe5-171">Determines if the beginning of the sample is a synchronization point.</span></span>                           |
| [<span data-ttu-id="1abe5-172">**SetSyncPoint**</span><span class="sxs-lookup"><span data-stu-id="1abe5-172">**SetSyncPoint**</span></span>](cmediasample-setsyncpoint.md)                    | <span data-ttu-id="1abe5-173">指定此範例的開頭是否為同步處理點。</span><span class="sxs-lookup"><span data-stu-id="1abe5-173">Specifies whether the beginning of this sample is a synchronization point.</span></span>                      |
| [<span data-ttu-id="1abe5-174">**IsPreroll**</span><span class="sxs-lookup"><span data-stu-id="1abe5-174">**IsPreroll**</span></span>](cmediasample-ispreroll.md)                          | <span data-ttu-id="1abe5-175">判斷此範例是否為可提前取樣。</span><span class="sxs-lookup"><span data-stu-id="1abe5-175">Determines if this sample is a preroll sample.</span></span>                                                  |
| [<span data-ttu-id="1abe5-176">**SetPreroll**</span><span class="sxs-lookup"><span data-stu-id="1abe5-176">**SetPreroll**</span></span>](cmediasample-setpreroll.md)                        | <span data-ttu-id="1abe5-177">指定此範例是否為可提前取樣。</span><span class="sxs-lookup"><span data-stu-id="1abe5-177">Specifies whether this sample is a preroll sample.</span></span>                                              |
| [<span data-ttu-id="1abe5-178">**GetActualDataLength**</span><span class="sxs-lookup"><span data-stu-id="1abe5-178">**GetActualDataLength**</span></span>](cmediasample-getactualdatalength.md)      | <span data-ttu-id="1abe5-179">擷取緩衝區中有效資料的長度。</span><span class="sxs-lookup"><span data-stu-id="1abe5-179">Retrieves the length of the valid data in the buffer.</span></span>                                           |
| [<span data-ttu-id="1abe5-180">**SetActualDataLength**</span><span class="sxs-lookup"><span data-stu-id="1abe5-180">**SetActualDataLength**</span></span>](cmediasample-setactualdatalength.md)      | <span data-ttu-id="1abe5-181">設定緩衝區中有效資料的長度。</span><span class="sxs-lookup"><span data-stu-id="1abe5-181">Sets the length of the valid data in the buffer.</span></span>                                                |
| [<span data-ttu-id="1abe5-182">**GetMediaType**</span><span class="sxs-lookup"><span data-stu-id="1abe5-182">**GetMediaType**</span></span>](cmediasample-getmediatype.md)                    | <span data-ttu-id="1abe5-183">如果媒體類型與先前的範例不同，則抓取媒體類型。</span><span class="sxs-lookup"><span data-stu-id="1abe5-183">Retrieves the media type, if the media type differs from the previous sample.</span></span>                   |
| [<span data-ttu-id="1abe5-184">**SetMediaType**</span><span class="sxs-lookup"><span data-stu-id="1abe5-184">**SetMediaType**</span></span>](cmediasample-setmediatype.md)                    | <span data-ttu-id="1abe5-185">設定範例的媒體類型。</span><span class="sxs-lookup"><span data-stu-id="1abe5-185">Sets the media type for the sample.</span></span>                                                             |
| [<span data-ttu-id="1abe5-186">**IsDiscontinuity**</span><span class="sxs-lookup"><span data-stu-id="1abe5-186">**IsDiscontinuity**</span></span>](cmediasample-isdiscontinuity.md)              | <span data-ttu-id="1abe5-187">判斷此範例是否表示資料流程中的中斷。</span><span class="sxs-lookup"><span data-stu-id="1abe5-187">Determines if this sample represents a break in the data stream.</span></span>                                |
| [<span data-ttu-id="1abe5-188">**SetDiscontinuity**</span><span class="sxs-lookup"><span data-stu-id="1abe5-188">**SetDiscontinuity**</span></span>](cmediasample-setdiscontinuity.md)            | <span data-ttu-id="1abe5-189">指定此範例是否表示資料流程中的中斷。</span><span class="sxs-lookup"><span data-stu-id="1abe5-189">Specifies whether this sample represents a break in the data stream.</span></span>                            |
| [<span data-ttu-id="1abe5-190">**GetMediaTime**</span><span class="sxs-lookup"><span data-stu-id="1abe5-190">**GetMediaTime**</span></span>](cmediasample-getmediatime.md)                    | <span data-ttu-id="1abe5-191">捕獲此範例的媒體時間。</span><span class="sxs-lookup"><span data-stu-id="1abe5-191">Retrieves the media times for this sample.</span></span>                                                      |
| [<span data-ttu-id="1abe5-192">**SetMediaTime**</span><span class="sxs-lookup"><span data-stu-id="1abe5-192">**SetMediaTime**</span></span>](cmediasample-setmediatime.md)                    | <span data-ttu-id="1abe5-193">設定此範例的媒體時間。</span><span class="sxs-lookup"><span data-stu-id="1abe5-193">Sets the media times for this sample.</span></span>                                                           |
| <span data-ttu-id="1abe5-194">IMediaSample2 方法</span><span class="sxs-lookup"><span data-stu-id="1abe5-194">IMediaSample2 Methods</span></span>                                                | <span data-ttu-id="1abe5-195">Description</span><span class="sxs-lookup"><span data-stu-id="1abe5-195">Description</span></span>                                                                                     |
| [<span data-ttu-id="1abe5-196">**GetProperties**</span><span class="sxs-lookup"><span data-stu-id="1abe5-196">**GetProperties**</span></span>](cmediasample-getproperties.md)                  | <span data-ttu-id="1abe5-197">抓取範例的屬性。</span><span class="sxs-lookup"><span data-stu-id="1abe5-197">Retrieves the properties of the sample.</span></span>                                                         |
| [<span data-ttu-id="1abe5-198">**SetProperties**</span><span class="sxs-lookup"><span data-stu-id="1abe5-198">**SetProperties**</span></span>](cmediasample-setproperties.md)                  | <span data-ttu-id="1abe5-199">設定範例的屬性。</span><span class="sxs-lookup"><span data-stu-id="1abe5-199">Sets the properties of the sample.</span></span>                                                              |



 

## <a name="requirements"></a><span data-ttu-id="1abe5-200">規格需求</span><span class="sxs-lookup"><span data-stu-id="1abe5-200">Requirements</span></span>



| <span data-ttu-id="1abe5-201">需求</span><span class="sxs-lookup"><span data-stu-id="1abe5-201">Requirement</span></span> | <span data-ttu-id="1abe5-202">值</span><span class="sxs-lookup"><span data-stu-id="1abe5-202">Value</span></span> |
|--------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="1abe5-203">標頭</span><span class="sxs-lookup"><span data-stu-id="1abe5-203">Header</span></span><br/>  | <dl> <span data-ttu-id="1abe5-204"><dt>Amfilter (包含： .h) </dt></span><span class="sxs-lookup"><span data-stu-id="1abe5-204"><dt>Amfilter.h (include Streams.h)</dt></span></span> </dl>                                                                                  |
| <span data-ttu-id="1abe5-205">程式庫</span><span class="sxs-lookup"><span data-stu-id="1abe5-205">Library</span></span><br/> | <dl> <span data-ttu-id="1abe5-206"><dt> (零售組建的 Strmbase .lib) ;</dt><dt>Strmbasd (debug 組建) </dt></span><span class="sxs-lookup"><span data-stu-id="1abe5-206"><dt>Strmbase.lib (retail builds); </dt> <dt>Strmbasd.lib (debug builds)</dt></span></span> </dl> |



 

 




