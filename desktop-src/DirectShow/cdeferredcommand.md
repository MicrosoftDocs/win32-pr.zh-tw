---
description: 延後的命令會藉由呼叫 IQueueCommand 介面上的方法來排入佇列，並由篩選圖形管理員和某些篩選器公開。
ms.assetid: b2b177c6-af2b-4585-914f-001a6355a298
title: CDeferredCommand 類別
ms.topic: reference
ms.date: 05/31/2018
topic_type:
- APIRef
- kbSyntax
api_name:
- CDeferredCommand
api_type:
- COM
api_location: ''
ms.openlocfilehash: 8d3db3f35b5589a6cd17791d72aa9931124ccfbb
ms.sourcegitcommit: a47bd86f517de76374e4fff33cfeb613eb259a7e
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/06/2021
ms.locfileid: "104109701"
---
# <a name="cdeferredcommand-class"></a><span data-ttu-id="04045-103">CDeferredCommand 類別</span><span class="sxs-lookup"><span data-stu-id="04045-103">CDeferredCommand class</span></span>

![cdeferredcommand 類別階層](images/cutil13.png)

<span data-ttu-id="04045-105">延後的命令會藉由呼叫 [**IQueueCommand**](/windows/desktop/api/Control/nn-control-iqueuecommand) 介面上的方法來排入佇列，並由篩選圖形管理員和某些篩選器公開。</span><span class="sxs-lookup"><span data-stu-id="04045-105">Deferred commands are queued by calls to methods on the [**IQueueCommand**](/windows/desktop/api/Control/nn-control-iqueuecommand) interface and are exposed by the filter graph manager and by some filters.</span></span> <span data-ttu-id="04045-106">成功呼叫其中一個方法會傳回 [**IDeferredCommand**](/windows/desktop/api/Control/nn-control-ideferredcommand) 介面，代表已排入佇列的命令。</span><span class="sxs-lookup"><span data-stu-id="04045-106">A successful call to one of these methods returns an [**IDeferredCommand**](/windows/desktop/api/Control/nn-control-ideferredcommand) interface representing the queued command.</span></span>

<span data-ttu-id="04045-107">`CDeferredCommand`物件代表單一延後命令，並公開 [**IDeferredCommand**](/windows/desktop/api/Control/nn-control-ideferredcommand)介面，以及允許時間檢查和實際執行的其他方法。</span><span class="sxs-lookup"><span data-stu-id="04045-107">A `CDeferredCommand` object represents a single deferred command and exposes the [**IDeferredCommand**](/windows/desktop/api/Control/nn-control-ideferredcommand) interface as well as other methods that permit time checks and actual execution.</span></span> <span data-ttu-id="04045-108">`CDeferredCommand`物件包含其排入佇列之 [**CCmdQueue**](ccmdqueue.md)物件的參考。</span><span class="sxs-lookup"><span data-stu-id="04045-108">A `CDeferredCommand` object contains a reference to the [**CCmdQueue**](ccmdqueue.md) object on which it is queued.</span></span>

<span data-ttu-id="04045-109">參考計數控制類別的存留期 `CDeferredCommand` 。</span><span class="sxs-lookup"><span data-stu-id="04045-109">Reference counts control the lifetime of the `CDeferredCommand` class.</span></span> <span data-ttu-id="04045-110">呼叫 [**CDeferredCommand：： Invoke**](cdeferredcommand-invoke.md) 成員函式時，呼叫端應用程式會取得參考計數的介面指標，而 [**CCmdQueue**](ccmdqueue.md) 物件也會在延後的命令上保存參考計數。</span><span class="sxs-lookup"><span data-stu-id="04045-110">When calling the [**CDeferredCommand::Invoke**](cdeferredcommand-invoke.md) member function, the calling application gets an interface pointer that is reference-counted, and the [**CCmdQueue**](ccmdqueue.md) object also holds a reference count on the deferred command.</span></span> <span data-ttu-id="04045-111">呼叫 [**IDeferredCommand：： Cancel**](/windows/desktop/api/Control/nf-control-ideferredcommand-cancel) 成員函式會從命令佇列中取出延後的命令，因此會將參考計數減少一。</span><span class="sxs-lookup"><span data-stu-id="04045-111">Calling the [**IDeferredCommand::Cancel**](/windows/desktop/api/Control/nf-control-ideferredcommand-cancel) member function takes the deferred command off the command queue and thus reduces the reference count by one.</span></span> <span data-ttu-id="04045-112">從佇列中移除之後，就無法將命令放回佇列中。</span><span class="sxs-lookup"><span data-stu-id="04045-112">Once taken off the queue, the command cannot be put back on the queue.</span></span>



| <span data-ttu-id="04045-113">受保護的資料成員</span><span class="sxs-lookup"><span data-stu-id="04045-113">Protected Data Members</span></span>                                        | <span data-ttu-id="04045-114">Description</span><span class="sxs-lookup"><span data-stu-id="04045-114">Description</span></span>                                                                                                             |
|---------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="04045-115">m \_ bStream</span><span class="sxs-lookup"><span data-stu-id="04045-115">m\_bStream</span></span>                                                    | <span data-ttu-id="04045-116">[**資料流程時間**](stream-time.md)或呈現時間的旗標。</span><span class="sxs-lookup"><span data-stu-id="04045-116">Flag for [**stream time**](stream-time.md) or presentation time.</span></span> <span data-ttu-id="04045-117">傳遞給叫用的方法。</span><span class="sxs-lookup"><span data-stu-id="04045-117">to be passed to the invoked method.</span></span>                   |
| <span data-ttu-id="04045-118">m \_ 分派</span><span class="sxs-lookup"><span data-stu-id="04045-118">m\_Dispatch</span></span>                                                   | <span data-ttu-id="04045-119">存取 **ITypeInfo** 介面。</span><span class="sxs-lookup"><span data-stu-id="04045-119">Accesses the **ITypeInfo** interface.</span></span>                                                                                   |
| <span data-ttu-id="04045-120">m \_ dispidMethod</span><span class="sxs-lookup"><span data-stu-id="04045-120">m\_dispidMethod</span></span>                                               | <span data-ttu-id="04045-121">要執行之介面上的方法。</span><span class="sxs-lookup"><span data-stu-id="04045-121">Method on the interface to run.</span></span>                                                                                         |
| <span data-ttu-id="04045-122">m \_ DispParams</span><span class="sxs-lookup"><span data-stu-id="04045-122">m\_DispParams</span></span>                                                 | <span data-ttu-id="04045-123">包含 **DISPPARAMS** 參數清單的 [**CDispParams**](cdispparams.md)物件</span><span class="sxs-lookup"><span data-stu-id="04045-123">[**CDispParams**](cdispparams.md) object containing the **DISPPARAMS** parameter list</span></span>                                  |
| <span data-ttu-id="04045-124">m \_ hrResult</span><span class="sxs-lookup"><span data-stu-id="04045-124">m\_hrResult</span></span>                                                   | <span data-ttu-id="04045-125">儲存傳回的 **HRESULT** 值。</span><span class="sxs-lookup"><span data-stu-id="04045-125">Stores the returned **HRESULT** value.</span></span>                                                                                  |
| <span data-ttu-id="04045-126">m \_ iid</span><span class="sxs-lookup"><span data-stu-id="04045-126">m\_iid</span></span>                                                        | <span data-ttu-id="04045-127">介面 (**GUID**) 的全域唯一識別碼。</span><span class="sxs-lookup"><span data-stu-id="04045-127">Globally unique identifier (**GUID**) of the interface.</span></span>                                                                 |
| <span data-ttu-id="04045-128">m \_ pQueue</span><span class="sxs-lookup"><span data-stu-id="04045-128">m\_pQueue</span></span>                                                     | <span data-ttu-id="04045-129">公開 [**IQueueCommand**](/windows/desktop/api/Control/nn-control-iqueuecommand)介面之 [**CCmdQueue**](ccmdqueue.md)物件的指標。</span><span class="sxs-lookup"><span data-stu-id="04045-129">Pointer to the [**CCmdQueue**](ccmdqueue.md) object that exposes the [**IQueueCommand**](/windows/desktop/api/Control/nn-control-iqueuecommand) interface.</span></span> |
| <span data-ttu-id="04045-130">m \_ pUnk</span><span class="sxs-lookup"><span data-stu-id="04045-130">m\_pUnk</span></span>                                                       | <span data-ttu-id="04045-131">將在其上執行命令之介面的 **IUnknown** 指標。</span><span class="sxs-lookup"><span data-stu-id="04045-131">**IUnknown** pointer to the interface on which the command will be run.</span></span>                                                 |
| <span data-ttu-id="04045-132">m \_ pvarResult</span><span class="sxs-lookup"><span data-stu-id="04045-132">m\_pvarResult</span></span>                                                 | <span data-ttu-id="04045-133">來自已叫用方法的結果資訊（如果有的話）。</span><span class="sxs-lookup"><span data-stu-id="04045-133">Resulting information, if any, from the invoked method.</span></span>                                                                 |
| <span data-ttu-id="04045-134">m \_ 時間</span><span class="sxs-lookup"><span data-stu-id="04045-134">m\_time</span></span>                                                       | <span data-ttu-id="04045-135">執行命令的時間。</span><span class="sxs-lookup"><span data-stu-id="04045-135">Time at which the command will be run.</span></span>                                                                                  |
| <span data-ttu-id="04045-136">m \_ wFlags</span><span class="sxs-lookup"><span data-stu-id="04045-136">m\_wFlags</span></span>                                                     | <span data-ttu-id="04045-137">指定調用內容的旗標。</span><span class="sxs-lookup"><span data-stu-id="04045-137">Flags specifying the context of the invocation.</span></span>                                                                         |
| <span data-ttu-id="04045-138">成員函數</span><span class="sxs-lookup"><span data-stu-id="04045-138">Member Functions</span></span>                                              | <span data-ttu-id="04045-139">Description</span><span class="sxs-lookup"><span data-stu-id="04045-139">Description</span></span>                                                                                                             |
| [<span data-ttu-id="04045-140">**CDeferredCommand**</span><span class="sxs-lookup"><span data-stu-id="04045-140">**CDeferredCommand**</span></span>](cdeferredcommand-cdeferredcommand.md) | <span data-ttu-id="04045-141">結構 **CDeferredCommand** 物件。</span><span class="sxs-lookup"><span data-stu-id="04045-141">Constructs a **CDeferredCommand** object.</span></span>                                                                               |
| [<span data-ttu-id="04045-142">**GetFlags**</span><span class="sxs-lookup"><span data-stu-id="04045-142">**GetFlags**</span></span>](cdeferredcommand-getflags.md)                 | <span data-ttu-id="04045-143">抓取與延後命令相關聯的內容旗標。</span><span class="sxs-lookup"><span data-stu-id="04045-143">Retrieves the context flags associated with the deferred command.</span></span>                                                       |
| [<span data-ttu-id="04045-144">**GetIID**</span><span class="sxs-lookup"><span data-stu-id="04045-144">**GetIID**</span></span>](cdeferredcommand-getiid.md)                     | <span data-ttu-id="04045-145">抓取將在其上執行方法之介面 (IID) 的介面識別碼。</span><span class="sxs-lookup"><span data-stu-id="04045-145">Retrieves the interface identifier (IID) of the interface on which the method will be run.</span></span>                              |
| [<span data-ttu-id="04045-146">**GetMethod**</span><span class="sxs-lookup"><span data-stu-id="04045-146">**GetMethod**</span></span>](cdeferredcommand-getmethod.md)               | <span data-ttu-id="04045-147">捕獲要執行之方法的分派識別碼。</span><span class="sxs-lookup"><span data-stu-id="04045-147">Retrieves the dispatch identifier of the method to be run.</span></span>                                                              |
| [<span data-ttu-id="04045-148">**GetParams**</span><span class="sxs-lookup"><span data-stu-id="04045-148">**GetParams**</span></span>](cdeferredcommand-getparams.md)               | <span data-ttu-id="04045-149">抓取方法的 **DISPPARAMS** 引數清單。</span><span class="sxs-lookup"><span data-stu-id="04045-149">Retrieves the **DISPPARAMS** argument list to the method.</span></span>                                                               |
| [<span data-ttu-id="04045-150">**GetResult**</span><span class="sxs-lookup"><span data-stu-id="04045-150">**GetResult**</span></span>](cdeferredcommand-getresult.md)               | <span data-ttu-id="04045-151">抓取產生的引數清單（如果有的話）。</span><span class="sxs-lookup"><span data-stu-id="04045-151">Retrieves the resulting argument list, if one exists.</span></span>                                                                   |
| [<span data-ttu-id="04045-152">**GetTime**</span><span class="sxs-lookup"><span data-stu-id="04045-152">**GetTime**</span></span>](cdeferredcommand-gettime.md)                   | <span data-ttu-id="04045-153">抓取方法將執行的時間。</span><span class="sxs-lookup"><span data-stu-id="04045-153">Retrieves the time when the method will be run.</span></span>                                                                         |
| [<span data-ttu-id="04045-154">**調用**</span><span class="sxs-lookup"><span data-stu-id="04045-154">**Invoke**</span></span>](cdeferredcommand-invoke.md)                     | <span data-ttu-id="04045-155">提供物件所公開之方法和屬性的存取權。</span><span class="sxs-lookup"><span data-stu-id="04045-155">Provides access to methods and properties exposed by an object.</span></span>                                                         |
| [<span data-ttu-id="04045-156">**IsStreamTime**</span><span class="sxs-lookup"><span data-stu-id="04045-156">**IsStreamTime**</span></span>](cdeferredcommand-isstreamtime.md)         | <span data-ttu-id="04045-157">指定是否要在資料流程時間或呈現時間執行命令。</span><span class="sxs-lookup"><span data-stu-id="04045-157">Specifies whether the command is to be run at stream time or presentation time.</span></span>                                         |
| <span data-ttu-id="04045-158">IDeferredCommand 方法</span><span class="sxs-lookup"><span data-stu-id="04045-158">IDeferredCommand Methods</span></span>                                      | <span data-ttu-id="04045-159">Description</span><span class="sxs-lookup"><span data-stu-id="04045-159">Description</span></span>                                                                                                             |
| [<span data-ttu-id="04045-160">**取消**</span><span class="sxs-lookup"><span data-stu-id="04045-160">**Cancel**</span></span>](cdeferredcommand-cancel.md)                     | <span data-ttu-id="04045-161">取消先前已排入佇列的 [**CDeferredCommand：： Invoke**](cdeferredcommand-invoke.md) 要求。</span><span class="sxs-lookup"><span data-stu-id="04045-161">Cancels a previously queued [**CDeferredCommand::Invoke**](cdeferredcommand-invoke.md) request.</span></span>                        |
| [<span data-ttu-id="04045-162">**信賴度**</span><span class="sxs-lookup"><span data-stu-id="04045-162">**Confidence**</span></span>](cdeferredcommand-confidence.md)             | <span data-ttu-id="04045-163">目前未實作。</span><span class="sxs-lookup"><span data-stu-id="04045-163">Not currently implemented.</span></span>                                                                                              |
| [<span data-ttu-id="04045-164">**延期**</span><span class="sxs-lookup"><span data-stu-id="04045-164">**Postpone**</span></span>](cdeferredcommand-postpone.md)                 | <span data-ttu-id="04045-165">為先前佇列的命令指定新的呈現時間。</span><span class="sxs-lookup"><span data-stu-id="04045-165">Specifies a new presentation time for a previously queued command.</span></span>                                                      |
| [<span data-ttu-id="04045-166">**GetHResult**</span><span class="sxs-lookup"><span data-stu-id="04045-166">**GetHResult**</span></span>](cdeferredcommand-gethresult.md)             | <span data-ttu-id="04045-167">抓取已叫用方法的 **HRESULT** 值。</span><span class="sxs-lookup"><span data-stu-id="04045-167">Retrieves the **HRESULT** value of the invoked method.</span></span>                                                                  |



 

 

 



