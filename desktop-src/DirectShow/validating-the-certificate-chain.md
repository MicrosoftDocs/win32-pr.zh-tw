---
description: 驗證憑證鏈
ms.assetid: e0c36f04-1694-40d8-94a1-06ee7de08777
title: 驗證憑證鏈
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 13436513ae9199feb7ba5fcba399537da198ba85
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/08/2021
ms.locfileid: "104193524"
---
# <a name="validating-the-certificate-chain"></a><span data-ttu-id="7ba7c-103">驗證憑證鏈</span><span class="sxs-lookup"><span data-stu-id="7ba7c-103">Validating the Certificate Chain</span></span>

<span data-ttu-id="7ba7c-104">本主題說明使用認證輸出保護通訊協定 (COPP) 時，如何驗證驅動程式的憑證鏈。</span><span class="sxs-lookup"><span data-stu-id="7ba7c-104">This topic describes how to validate the driver's certificate chain when using Certified Output Protection Protocol (COPP).</span></span>

<span data-ttu-id="7ba7c-105">圖形驅動程式的憑證鏈是一份 XML 檔。</span><span class="sxs-lookup"><span data-stu-id="7ba7c-105">The graphic driver's certificate chain is an XML document.</span></span> <span data-ttu-id="7ba7c-106">憑證鏈包含三個憑證。</span><span class="sxs-lookup"><span data-stu-id="7ba7c-106">The certificate chain contains three certificates.</span></span> <span data-ttu-id="7ba7c-107">第一個憑證稱為分 *葉憑證*，而是驅動程式的 COPP 憑證。</span><span class="sxs-lookup"><span data-stu-id="7ba7c-107">The first certificate is called the *leaf certificate*, and is the driver's COPP certificate.</span></span> <span data-ttu-id="7ba7c-108">下一個憑證是獨立硬體廠商 (IHV) 的簽署憑證。</span><span class="sxs-lookup"><span data-stu-id="7ba7c-108">The next certificate is the signing certificate of the Independent Hardware Vendor (IHV).</span></span> <span data-ttu-id="7ba7c-109">最後一個憑證是 Microsoft 的簽署憑證。</span><span class="sxs-lookup"><span data-stu-id="7ba7c-109">The last certificate is Microsoft's signing certificate.</span></span> <span data-ttu-id="7ba7c-110">若要確定圖形驅動程式是合法的 COPP 裝置，應用程式必須驗證上述三個憑證。</span><span class="sxs-lookup"><span data-stu-id="7ba7c-110">To ensure that the graphics driver is a legitimate COPP device, the application must validate all three of these certificates.</span></span> <span data-ttu-id="7ba7c-111">如果應用程式未正確驗證鏈中的憑證，惡意程式可能會導致 COPP 無法運作。</span><span class="sxs-lookup"><span data-stu-id="7ba7c-111">A malicious program can prevent COPP from working if an application does not correctly validate the certificates in the chain.</span></span>

<span data-ttu-id="7ba7c-112">COPP 憑證連結使用 UTF-8 字元集。</span><span class="sxs-lookup"><span data-stu-id="7ba7c-112">COPP certificate chains use the UTF-8 character set.</span></span> <span data-ttu-id="7ba7c-113">憑證中的二進位資料，例如 RSA 公開金鑰，會以位元組由大到小的順序，以 base64 編碼和儲存。</span><span class="sxs-lookup"><span data-stu-id="7ba7c-113">Binary data in the certificates, such as the RSA public key, are base64-encoded and stored in big-endian order.</span></span> <span data-ttu-id="7ba7c-114"> (位元組由 *大* 到小表示最重要的位元組會儲存在最低位址的記憶體位置。 ) </span><span class="sxs-lookup"><span data-stu-id="7ba7c-114">(*Big-endian* means that the most significant byte is stored in the memory location with the lowest address.)</span></span>

<span data-ttu-id="7ba7c-115">憑證內的某些元素包含布林值，表示憑證的功能存在。</span><span class="sxs-lookup"><span data-stu-id="7ba7c-115">Some elements within a certificate contain Boolean values to denote that a feature of the certificate exists.</span></span> <span data-ttu-id="7ba7c-116">如果功能存在，對應的子項目值會設定為1。</span><span class="sxs-lookup"><span data-stu-id="7ba7c-116">If the feature exists, the corresponding child element value is set to 1.</span></span> <span data-ttu-id="7ba7c-117">如果功能不存在，憑證中就不會出現該子項目。</span><span class="sxs-lookup"><span data-stu-id="7ba7c-117">If a feature is not present, that child element is not present in the certificate.</span></span>

### <a name="xml-element-definitions"></a><span data-ttu-id="7ba7c-118">XML 元素定義</span><span class="sxs-lookup"><span data-stu-id="7ba7c-118">XML Element Definitions</span></span>

<span data-ttu-id="7ba7c-119">以下是憑證架構中的元素定義：</span><span class="sxs-lookup"><span data-stu-id="7ba7c-119">The following are definitions for elements in the certificate schema:</span></span>

-   <span data-ttu-id="7ba7c-120">**CertificateCollection**。</span><span class="sxs-lookup"><span data-stu-id="7ba7c-120">**CertificateCollection**.</span></span> <span data-ttu-id="7ba7c-121">XML 檔的根項目。</span><span class="sxs-lookup"><span data-stu-id="7ba7c-121">The root element of the XML document.</span></span> <span data-ttu-id="7ba7c-122">它包含憑證元素，鏈中的每個憑證各一個。</span><span class="sxs-lookup"><span data-stu-id="7ba7c-122">It contains Certificate elements, one for each certificate in the chain.</span></span>
-   <span data-ttu-id="7ba7c-123">**憑證**。</span><span class="sxs-lookup"><span data-stu-id="7ba7c-123">**Certificate**.</span></span> <span data-ttu-id="7ba7c-124">包含一個憑證。</span><span class="sxs-lookup"><span data-stu-id="7ba7c-124">Contains one certificate.</span></span> <span data-ttu-id="7ba7c-125">這個元素包含資料和簽章元素。</span><span class="sxs-lookup"><span data-stu-id="7ba7c-125">This element contains Data and Signature elements.</span></span>
-   <span data-ttu-id="7ba7c-126">**資料**。</span><span class="sxs-lookup"><span data-stu-id="7ba7c-126">**Data**.</span></span> <span data-ttu-id="7ba7c-127">包含憑證的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="7ba7c-127">Contains information about the certificate.</span></span> <span data-ttu-id="7ba7c-128">尤其是，它包含憑證的公開金鑰和類型。</span><span class="sxs-lookup"><span data-stu-id="7ba7c-128">In particular, it contains the certificate's public key and type.</span></span> <span data-ttu-id="7ba7c-129">資料元素包含下列子項目：</span><span class="sxs-lookup"><span data-stu-id="7ba7c-129">The Data element contains the following child elements:</span></span>
    -   <span data-ttu-id="7ba7c-130">**PublicKey**。</span><span class="sxs-lookup"><span data-stu-id="7ba7c-130">**PublicKey**.</span></span> <span data-ttu-id="7ba7c-131">包含憑證的 RSA 公開金鑰。</span><span class="sxs-lookup"><span data-stu-id="7ba7c-131">Contains the certificate's RSA public key.</span></span> <span data-ttu-id="7ba7c-132">PublicKey 元素包含 KeyValue 元素，其中包含 Rsakeyvalue> 元素。</span><span class="sxs-lookup"><span data-stu-id="7ba7c-132">The PublicKey element contains a KeyValue element, which contains an RSAKeyValue element.</span></span> <span data-ttu-id="7ba7c-133">Rsakeyvalue> 專案有兩個子項目：模數和指數，而這些專案定義了公開金鑰。</span><span class="sxs-lookup"><span data-stu-id="7ba7c-133">The RSAKeyValue element has two child elements, Modulus and Exponent, and these define the public key.</span></span> <span data-ttu-id="7ba7c-134">模數和指數元素是以 base64 編碼，並以位元組由大到小的順序儲存。</span><span class="sxs-lookup"><span data-stu-id="7ba7c-134">The Modulus and Exponent elements are base64-encoded and stored in big-endian order.</span></span>
    -   <span data-ttu-id="7ba7c-135">**KeyUsage**。</span><span class="sxs-lookup"><span data-stu-id="7ba7c-135">**KeyUsage**.</span></span> <span data-ttu-id="7ba7c-136">如果憑證是驅動程式的 COPP 憑證，此元素應該會包含名為 EncryptKey 的子項目。</span><span class="sxs-lookup"><span data-stu-id="7ba7c-136">If the certificate is the driver's COPP certificate, this element should contain a child element called EncryptKey.</span></span> <span data-ttu-id="7ba7c-137">如果憑證是 IHV 的簽署憑證或 Microsoft 的簽署憑證，它應該會包含名為 SignCertificate 的子項目。</span><span class="sxs-lookup"><span data-stu-id="7ba7c-137">If the certificate is the IHV's signing certificate or Microsoft's signing certificate, it should contain a child element called SignCertificate.</span></span> <span data-ttu-id="7ba7c-138">這兩個子項目都包含布林值。</span><span class="sxs-lookup"><span data-stu-id="7ba7c-138">Both of these child elements contain Boolean values.</span></span>
    -   <span data-ttu-id="7ba7c-139">**SecurityLevel**。</span><span class="sxs-lookup"><span data-stu-id="7ba7c-139">**SecurityLevel**.</span></span> <span data-ttu-id="7ba7c-140">應忽略這個元素。</span><span class="sxs-lookup"><span data-stu-id="7ba7c-140">This element should be ignored.</span></span>
    -   <span data-ttu-id="7ba7c-141">**ManufacturerData**。</span><span class="sxs-lookup"><span data-stu-id="7ba7c-141">**ManufacturerData**.</span></span> <span data-ttu-id="7ba7c-142">指定圖形裝置的製造商和型號。</span><span class="sxs-lookup"><span data-stu-id="7ba7c-142">Specifies the manufacturer and model of the graphics device.</span></span> <span data-ttu-id="7ba7c-143">此元素僅供參考。</span><span class="sxs-lookup"><span data-stu-id="7ba7c-143">This element is informational only.</span></span>
    -   <span data-ttu-id="7ba7c-144">**Features**。</span><span class="sxs-lookup"><span data-stu-id="7ba7c-144">**Features**.</span></span> <span data-ttu-id="7ba7c-145">包含指定憑證使用方式的子項目。</span><span class="sxs-lookup"><span data-stu-id="7ba7c-145">Contains child elements that specify the usage of the certificate.</span></span> <span data-ttu-id="7ba7c-146">與 COPP 相關的唯一一個是 COPPCertificate 元素。</span><span class="sxs-lookup"><span data-stu-id="7ba7c-146">The only one relevant to COPP is the COPPCertificate element.</span></span> <span data-ttu-id="7ba7c-147">可能存在其他子項目;如果是，則應該予以忽略。</span><span class="sxs-lookup"><span data-stu-id="7ba7c-147">Other child elements might be present; if so, they should be ignored.</span></span> <span data-ttu-id="7ba7c-148">如果 COPPCertificate 元素存在，則憑證是 COPP 憑證。</span><span class="sxs-lookup"><span data-stu-id="7ba7c-148">If the COPPCertificate element exists, the certificate is a COPP certificate.</span></span> <span data-ttu-id="7ba7c-149">此元素必須存在於有效 COPP 憑證的分葉節點中。</span><span class="sxs-lookup"><span data-stu-id="7ba7c-149">This element must be present in the leaf node of a valid COPP certificate.</span></span> <span data-ttu-id="7ba7c-150">這個元素包含布林值。</span><span class="sxs-lookup"><span data-stu-id="7ba7c-150">This element contains a Boolean value.</span></span>
-   <span data-ttu-id="7ba7c-151">簽 **章。**</span><span class="sxs-lookup"><span data-stu-id="7ba7c-151">**Signature**.</span></span> <span data-ttu-id="7ba7c-152">包含此憑證的簽章。</span><span class="sxs-lookup"><span data-stu-id="7ba7c-152">Contains the signature for this certificate.</span></span> <span data-ttu-id="7ba7c-153">它包含下列子項目：</span><span class="sxs-lookup"><span data-stu-id="7ba7c-153">It contains the following child elements:</span></span>
    -   <span data-ttu-id="7ba7c-154">**SignedInfo**。</span><span class="sxs-lookup"><span data-stu-id="7ba7c-154">**SignedInfo**.</span></span> <span data-ttu-id="7ba7c-155">包含簽章的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="7ba7c-155">Contains information about the signature.</span></span> <span data-ttu-id="7ba7c-156">這個元素的重要子項目是 DigestValue 元素，其中包含資料元素上的 SHA-1 雜湊的 base64 編碼值。</span><span class="sxs-lookup"><span data-stu-id="7ba7c-156">The important child element of this element is the DigestValue element, which contains the base64-encoded value of the SHA-1 hash over the Data element.</span></span> <span data-ttu-id="7ba7c-157">針對 (CRL) 的憑證撤銷清單檢查憑證時，會使用摘要值。</span><span class="sxs-lookup"><span data-stu-id="7ba7c-157">The digest value is used when checking the certificate against the certificate revocation list (CRL).</span></span>
    -   <span data-ttu-id="7ba7c-158">**SignatureValue**。</span><span class="sxs-lookup"><span data-stu-id="7ba7c-158">**SignatureValue**.</span></span> <span data-ttu-id="7ba7c-159">此值是透過資料元素計算，並根據 Public-Key 加密標準中定義的 RSASSA-PKCS-PSS 數位簽章配置 (PKCS) \# 1 (2.1 版) 來計算。</span><span class="sxs-lookup"><span data-stu-id="7ba7c-159">This value is computed over the Data element and is computed according to the RSASSA-PSS digital signature scheme defined in Public-Key Cryptography Standards (PKCS) \#1 (version 2.1).</span></span> <span data-ttu-id="7ba7c-160">如需 PKCS 1 的相關資訊 \# ，請造訪 [https://www.rsa.com/](https://www.rsa.com/) 。</span><span class="sxs-lookup"><span data-stu-id="7ba7c-160">For information about PKCS \#1, visit [https://www.rsa.com/](https://www.rsa.com/).</span></span>
    -   <span data-ttu-id="7ba7c-161">**KeyInfo**。</span><span class="sxs-lookup"><span data-stu-id="7ba7c-161">**KeyInfo**.</span></span> <span data-ttu-id="7ba7c-162">包含鏈中下一個憑證的 RSA 公開金鑰。</span><span class="sxs-lookup"><span data-stu-id="7ba7c-162">Contains the RSA public key of the next certificate in the chain.</span></span> <span data-ttu-id="7ba7c-163">此元素用來驗證資料元素中的資料是否未遭篡改。</span><span class="sxs-lookup"><span data-stu-id="7ba7c-163">This element is used to verify that the data in the Data element has not been tampered with.</span></span> <span data-ttu-id="7ba7c-164">這個元素的格式與 PublicKey 元素相同。</span><span class="sxs-lookup"><span data-stu-id="7ba7c-164">This element has the same format as the PublicKey element.</span></span>

### <a name="certificate-validation"></a><span data-ttu-id="7ba7c-165">憑證驗證</span><span class="sxs-lookup"><span data-stu-id="7ba7c-165">Certificate Validation</span></span>

<span data-ttu-id="7ba7c-166">應用程式必須執行下列步驟，才能正確地驗證憑證鏈。</span><span class="sxs-lookup"><span data-stu-id="7ba7c-166">The application must perform the following steps to correctly validate the certificate chain.</span></span> <span data-ttu-id="7ba7c-167">如果任何步驟失敗，或這些程式中參考的任何專案不存在，驗證就會失敗。</span><span class="sxs-lookup"><span data-stu-id="7ba7c-167">If any step fails, or if any element referred to in these procedures does not exist, the validation fails.</span></span>

### <a name="validate-certificate-collection-procedure"></a><span data-ttu-id="7ba7c-168">驗證憑證收集程式</span><span class="sxs-lookup"><span data-stu-id="7ba7c-168">Validate Certificate Collection Procedure</span></span>

<span data-ttu-id="7ba7c-169">若要驗證憑證鏈，請執行下列步驟：</span><span class="sxs-lookup"><span data-stu-id="7ba7c-169">To validate the certificate chain, perform the following steps:</span></span>

1.  <span data-ttu-id="7ba7c-170">確認 CertificateCollection 是格式正確的 XML。</span><span class="sxs-lookup"><span data-stu-id="7ba7c-170">Verify that the CertificateCollection is well-formed XML.</span></span>
2.  <span data-ttu-id="7ba7c-171">確認 CertificateCollection 是以 UTF-8 格式編碼。</span><span class="sxs-lookup"><span data-stu-id="7ba7c-171">Verify that the CertificateCollection is encoded in UTF-8 format.</span></span>
3.  <span data-ttu-id="7ba7c-172">檢查 CertificateCollection 元素中的 Version 屬性是2.0 或更新版本。</span><span class="sxs-lookup"><span data-stu-id="7ba7c-172">Check that the Version attribute in the CertificateCollection element is 2.0 or later.</span></span>
4.  <span data-ttu-id="7ba7c-173">確認憑證鏈只包含三個憑證元素。</span><span class="sxs-lookup"><span data-stu-id="7ba7c-173">Verify that the certificate chain contains exactly three Certificate elements.</span></span>
5.  <span data-ttu-id="7ba7c-174">迴圈執行憑證鏈中的每個憑證元素，並在每個專案上執行驗證憑證程式（如下所述）。</span><span class="sxs-lookup"><span data-stu-id="7ba7c-174">Loop through each Certificate element in the certificate chain and perform the Validate Certificate procedure, described below, on each.</span></span>

### <a name="validate-certificate-procedure"></a><span data-ttu-id="7ba7c-175">驗證憑證程式</span><span class="sxs-lookup"><span data-stu-id="7ba7c-175">Validate Certificate Procedure</span></span>

<span data-ttu-id="7ba7c-176">若要驗證鏈中的憑證，請執行下列步驟：</span><span class="sxs-lookup"><span data-stu-id="7ba7c-176">To validate a certificate in the chain, perform the following steps:</span></span>

1.  <span data-ttu-id="7ba7c-177">確認資料元素中的子項目都不會重複。</span><span class="sxs-lookup"><span data-stu-id="7ba7c-177">Verify that none of the child elements in the Data element is duplicated.</span></span> <span data-ttu-id="7ba7c-178">例如，應該只有一個 PublicKey 元素。</span><span class="sxs-lookup"><span data-stu-id="7ba7c-178">For example, there should be only one PublicKey element.</span></span>
2.  <span data-ttu-id="7ba7c-179">請確定 Data/PublicKey/KeyValue/Rsakeyvalue>/模數元素存在。</span><span class="sxs-lookup"><span data-stu-id="7ba7c-179">Ensure that the Data/PublicKey/KeyValue/RSAKeyValue/Modulus element exists.</span></span> <span data-ttu-id="7ba7c-180">Base64 解碼值的長度必須為256個位元組（除了根目錄以外的所有憑證）。</span><span class="sxs-lookup"><span data-stu-id="7ba7c-180">The base64-decoded value must be 256 bytes long for all certificates except the root.</span></span> <span data-ttu-id="7ba7c-181">在根憑證中，此元素的長度必須是128個位元組。</span><span class="sxs-lookup"><span data-stu-id="7ba7c-181">In the root certificate, this element must be 128 bytes long.</span></span>
3.  <span data-ttu-id="7ba7c-182">請確定 Data/PublicKey/KeyValue/Rsakeyvalue>/指數元素存在。</span><span class="sxs-lookup"><span data-stu-id="7ba7c-182">Ensure that the Data/PublicKey/KeyValue/RSAKeyValue/Exponent element exists.</span></span> <span data-ttu-id="7ba7c-183">Base64 解碼的值不得超過4個位元組。</span><span class="sxs-lookup"><span data-stu-id="7ba7c-183">The base64-decoded value must not be larger than 4 bytes.</span></span>
4.  <span data-ttu-id="7ba7c-184">如果此憑證是分葉憑證，請確認下列事項：</span><span class="sxs-lookup"><span data-stu-id="7ba7c-184">If this certificate is the leaf certificate, verify the following:</span></span>
    -   <span data-ttu-id="7ba7c-185">KeyUsage 元素包含值為1的 EncryptKey 元素。</span><span class="sxs-lookup"><span data-stu-id="7ba7c-185">The KeyUsage element contains an EncryptKey element with the value 1.</span></span>
    -   <span data-ttu-id="7ba7c-186">Features 元素包含值為1的 COPPCertificate 元素。</span><span class="sxs-lookup"><span data-stu-id="7ba7c-186">The Features element contains a COPPCertificate element with the value 1.</span></span>
5.  <span data-ttu-id="7ba7c-187">如果此憑證不是分葉憑證，請確認下列事項：</span><span class="sxs-lookup"><span data-stu-id="7ba7c-187">If this certificate is not the leaf certificate, verify the following:</span></span>
    -   <span data-ttu-id="7ba7c-188">Data/PublicKey 元素的模數和指數完全符合先前憑證之 Signature/KeyInfo 元素中的模數和指數。</span><span class="sxs-lookup"><span data-stu-id="7ba7c-188">The modulus and exponent from the Data/PublicKey element exactly match the modulus and exponent from the Signature/KeyInfo element of the previous certificate.</span></span>
    -   <span data-ttu-id="7ba7c-189">KeyUsage 元素包含 SignCertificate 元素，其值為1。</span><span class="sxs-lookup"><span data-stu-id="7ba7c-189">The KeyUsage element contains a SignCertificate element, with the value 1.</span></span>
6.  <span data-ttu-id="7ba7c-190">使用 SHA-1 雜湊演算法來雜湊憑證的資料元素中的每個位元組。</span><span class="sxs-lookup"><span data-stu-id="7ba7c-190">Use the SHA-1 hash algorithm to hash every byte in the certificate's Data element.</span></span> <span data-ttu-id="7ba7c-191">從標記中第一個字元 <Data> 到結尾 </Data> 標記之最後一個字元的每個位元組都應進行雜湊處理。</span><span class="sxs-lookup"><span data-stu-id="7ba7c-191">Every byte from the first character in the <Data> tag to the last character in the closing </Data> tag should be hashed.</span></span> <span data-ttu-id="7ba7c-192">雜湊值是用來根據憑證撤銷清單來檢查憑證 (CRL) ，如[憑證撤銷清單](certificate-revocation-lists.md)中所述</span><span class="sxs-lookup"><span data-stu-id="7ba7c-192">The hash value is used to check the certificate against the certificate revocation list (CRL), as described in [Certificate Revocation Lists](certificate-revocation-lists.md)</span></span>
7.  <span data-ttu-id="7ba7c-193">將步驟6中的雜湊值與 Signature/SignedInfo/Reference/DigestValue 元素的 base64 解碼值進行比較。</span><span class="sxs-lookup"><span data-stu-id="7ba7c-193">Compare the hash value from step 6 with the base64-decoded value of the Signature/SignedInfo/Reference/DigestValue element.</span></span> <span data-ttu-id="7ba7c-194">這些值必須相符。</span><span class="sxs-lookup"><span data-stu-id="7ba7c-194">These values must match.</span></span>
8.  <span data-ttu-id="7ba7c-195">執行驗證簽章程式，如下所述。</span><span class="sxs-lookup"><span data-stu-id="7ba7c-195">Perform the Verify Signature procedure, described below.</span></span>
9.  <span data-ttu-id="7ba7c-196">如果此憑證不是鏈中的最終憑證，請在迴圈的下一個反覆運算中儲存 Signature/KeyInfo/KeyValue/Rsakeyvalue> 值。</span><span class="sxs-lookup"><span data-stu-id="7ba7c-196">If this certificate is not the final certificate in the chain, save the Signature/KeyInfo/KeyValue/RSAKeyValue value for the next iteration of the loop.</span></span>
10. <span data-ttu-id="7ba7c-197">如果此憑證是鏈中的最終憑證，請確定 Signature/KeyInfo/KeyValue/Rsakeyvalue> 的值符合 Microsoft 的公開金鑰。</span><span class="sxs-lookup"><span data-stu-id="7ba7c-197">If this certificate is the final certificate in the chain, ensure that the value of Signature/KeyInfo/KeyValue/RSAKeyValue matches Microsoft's public key.</span></span> <span data-ttu-id="7ba7c-198">Microsoft 公開金鑰具有下列 base64 編碼值：</span><span class="sxs-lookup"><span data-stu-id="7ba7c-198">The Microsoft public key has the following base64-encoded values:</span></span>
    -   <span data-ttu-id="7ba7c-199">模：</span><span class="sxs-lookup"><span data-stu-id="7ba7c-199">Modulus:</span></span>

        `pjoeWLSTLDonQG8She6QhkYbYott9fPZ8tHdB128ZETcghn5KHoyin7HkJEcPJ0Eg4UdSv a0KDIYDjA3EXd69R3CN2Wp/QyOo0ZPYWYp3NXpJ700tKPgIplzo5wVd/69g7j+j8M66W7V NmDwaNs9mDc1p2+VVMsDhOsV/Au6E+E=`

    -   <span data-ttu-id="7ba7c-200">指數： `AQAB`</span><span class="sxs-lookup"><span data-stu-id="7ba7c-200">Exponent: `AQAB`</span></span>

### <a name="verify-signature-procedure"></a><span data-ttu-id="7ba7c-201">驗證簽章程式</span><span class="sxs-lookup"><span data-stu-id="7ba7c-201">Verify Signature Procedure</span></span>

<span data-ttu-id="7ba7c-202">SignatureValue 元素的值會根據 PKCS 1 2.1 版中定義的 RSASSA-PKCS-PSS 數位簽章配置來計算， \# (以下稱為 pkcs) 。</span><span class="sxs-lookup"><span data-stu-id="7ba7c-202">The value of the SignatureValue element is computed over the Data element according to the RSASSA-PSS digital signature scheme defined in PKCS \#1 version 2.1 (hereinafter referred to as PKCS).</span></span> <span data-ttu-id="7ba7c-203">若要驗證此簽章，請執行下列步驟：</span><span class="sxs-lookup"><span data-stu-id="7ba7c-203">To verify this signature, perform the following steps:</span></span>

1.  <span data-ttu-id="7ba7c-204">解碼 Signature/KeyInfo/KeyValue/Rsakeyvalue> 元素中的模數和指數值。</span><span class="sxs-lookup"><span data-stu-id="7ba7c-204">Decode the Modulus and Exponent values in the Signature/KeyInfo/KeyValue/RSAKeyValue element.</span></span> <span data-ttu-id="7ba7c-205">這些值會定義簽署憑證的 RSA 公開金鑰。</span><span class="sxs-lookup"><span data-stu-id="7ba7c-205">These values define the RSA public key of the signing certificate.</span></span>
2.  <span data-ttu-id="7ba7c-206">解碼 Signature/SignatureValue 元素。</span><span class="sxs-lookup"><span data-stu-id="7ba7c-206">Decode the Signature/SignatureValue element.</span></span>
3.  <span data-ttu-id="7ba7c-207">計算 RSASSA-PKCS-PSS-驗證作業，定義于 PKCS 的區段8.1.2 中。</span><span class="sxs-lookup"><span data-stu-id="7ba7c-207">Compute the RSASSA-PSS-Verify operation, defined in section 8.1.2 of PKCS.</span></span>

<span data-ttu-id="7ba7c-208">針對 RSASSA-PKCS-PSS-驗證作業，請使用下列輸入：</span><span class="sxs-lookup"><span data-stu-id="7ba7c-208">For the RSASSA-PSS-Verify operation, use the following inputs:</span></span>

-   <span data-ttu-id="7ba7c-209"> (*n*，*e*) 是步驟1中的公開金鑰。</span><span class="sxs-lookup"><span data-stu-id="7ba7c-209">(*n*,*e*) is the public key from step 1.</span></span>
-   <span data-ttu-id="7ba7c-210">*M* 是資料元素中的所有位元組，包括用來括住元素的 <Data> 和</Data> 標記。</span><span class="sxs-lookup"><span data-stu-id="7ba7c-210">*M* is all of the bytes in the Data element, including the <Data> and </Data> tags that enclose the element.</span></span>
-   <span data-ttu-id="7ba7c-211">*S* 是步驟2中已解碼的簽章值。</span><span class="sxs-lookup"><span data-stu-id="7ba7c-211">*S* is the decoded signature value from step 2.</span></span>

<span data-ttu-id="7ba7c-212">RSASSA-PKCS-PSS-驗證作業會使用 EMSA-PSS 編碼作業，定義于區段9.1.1 中。</span><span class="sxs-lookup"><span data-stu-id="7ba7c-212">The RSASSA-PSS-Verify operation uses the EMSA-PSS-ENCODE operation, defined in section 9.1.1.</span></span> <span data-ttu-id="7ba7c-213">的 PKCS。</span><span class="sxs-lookup"><span data-stu-id="7ba7c-213">of PKCS.</span></span> <span data-ttu-id="7ba7c-214">針對這項作業，COPP 會使用下列選項：</span><span class="sxs-lookup"><span data-stu-id="7ba7c-214">For this operation, COPP uses the following options:</span></span>

-   <span data-ttu-id="7ba7c-215">Hash = SHA-1</span><span class="sxs-lookup"><span data-stu-id="7ba7c-215">Hash = SHA-1</span></span>
-   <span data-ttu-id="7ba7c-216">*hLen* = 20</span><span class="sxs-lookup"><span data-stu-id="7ba7c-216">*hLen* = 20</span></span>
-   <span data-ttu-id="7ba7c-217">MGF (mask 產生函數) = 及 MGF1</span><span class="sxs-lookup"><span data-stu-id="7ba7c-217">MGF (mask generation function) = MGF1</span></span>
-   <span data-ttu-id="7ba7c-218">*sLen* = 0</span><span class="sxs-lookup"><span data-stu-id="7ba7c-218">*sLen* = 0</span></span>

<span data-ttu-id="7ba7c-219">遮罩產生函式及 MGF1 是定義在 PKCS 的附錄 B. 2 中。</span><span class="sxs-lookup"><span data-stu-id="7ba7c-219">The mask generation function MGF1 is defined in Appendix B.2 of PKCS.</span></span> <span data-ttu-id="7ba7c-220">針對此功能，COPP 會使用下列選項：</span><span class="sxs-lookup"><span data-stu-id="7ba7c-220">For this function, COPP uses the following options:</span></span>

-   <span data-ttu-id="7ba7c-221">Hash = SHA-1</span><span class="sxs-lookup"><span data-stu-id="7ba7c-221">Hash = SHA-1</span></span>
-   <span data-ttu-id="7ba7c-222">*hLen* = 20</span><span class="sxs-lookup"><span data-stu-id="7ba7c-222">*hLen* = 20</span></span>

<span data-ttu-id="7ba7c-223">RSASSA-PKCS-PSS-驗證作業的輸出會指出簽章是否有效或無效。</span><span class="sxs-lookup"><span data-stu-id="7ba7c-223">The output of the RSASSA-PSS-Verify operation indicates whether the signature is valid or invalid.</span></span>

## <a name="related-topics"></a><span data-ttu-id="7ba7c-224">相關主題</span><span class="sxs-lookup"><span data-stu-id="7ba7c-224">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="7ba7c-225">使用認證輸出保護通訊協定 (COPP) </span><span class="sxs-lookup"><span data-stu-id="7ba7c-225">Using Certified Output Protection Protocol (COPP)</span></span>](using-certified-output-protection-protocol--copp.md)
</dt> </dl>

 

 



