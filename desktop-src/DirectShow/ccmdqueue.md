---
description: CCmdQueue 類別是一個基類，可提供 CDeferredCommand 物件和成員函式的佇列，以新增、移除、檢查狀態，以及叫用已排入佇列的命令。
ms.assetid: 6bd0f0f3-3c56-47d2-9fd8-e2863a2afa33
title: CCmdQueue 類別
ms.topic: reference
ms.date: 05/31/2018
topic_type:
- APIRef
- kbSyntax
api_name:
- CCmdQueue
api_type:
- COM
api_location: ''
ms.openlocfilehash: 78af7a975d54ba832bbdf1fb7f8027f87b747660
ms.sourcegitcommit: a47bd86f517de76374e4fff33cfeb613eb259a7e
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/06/2021
ms.locfileid: "104108677"
---
# <a name="ccmdqueue-class"></a><span data-ttu-id="c17a7-103">CCmdQueue 類別</span><span class="sxs-lookup"><span data-stu-id="c17a7-103">CCmdQueue class</span></span>

<span data-ttu-id="c17a7-104">`CCmdQueue`類別是基類，提供 [**CDeferredCommand**](cdeferredcommand.md)物件和成員函式的佇列，以新增、移除、檢查狀態，以及叫用已排入佇列的命令。</span><span class="sxs-lookup"><span data-stu-id="c17a7-104">The `CCmdQueue` class is a base class that provides a queue of [**CDeferredCommand**](cdeferredcommand.md) objects and member functions to add, remove, check status, and invoke the queued commands.</span></span> <span data-ttu-id="c17a7-105">`CCmdQueue`物件是物件的一部分，它會執行 [**IQueueCommand**](/windows/desktop/api/Control/nn-control-iqueuecommand)方法。</span><span class="sxs-lookup"><span data-stu-id="c17a7-105">A `CCmdQueue` object is a part of an object that implements [**IQueueCommand**](/windows/desktop/api/Control/nn-control-iqueuecommand) methods.</span></span> <span data-ttu-id="c17a7-106">篩選圖形管理員會實 **IQueueCommand** 方法，讓應用程式可以將命令排入篩選圖形。</span><span class="sxs-lookup"><span data-stu-id="c17a7-106">The filter graph manager implements **IQueueCommand** methods so that applications can queue commands to the filter graph.</span></span> <span data-ttu-id="c17a7-107">執行 **IQueueCommand** 介面的篩選器會直接使用這個類別。</span><span class="sxs-lookup"><span data-stu-id="c17a7-107">Filters that implement the **IQueueCommand** interface directly use this class.</span></span> <span data-ttu-id="c17a7-108">如果您想要使用 **CDeferredCommand** 物件，則必須從這個類別衍生您的佇列。</span><span class="sxs-lookup"><span data-stu-id="c17a7-108">If you want to use **CDeferredCommand** objects, your queue must be derived from this class.</span></span>

<span data-ttu-id="c17a7-109">同步處理的模式有兩種：粗略且精確。</span><span class="sxs-lookup"><span data-stu-id="c17a7-109">There are two modes of synchronization: coarse and accurate.</span></span> <span data-ttu-id="c17a7-110">在粗略模式中，應用程式會等到指定的時間抵達，然後執行命令。</span><span class="sxs-lookup"><span data-stu-id="c17a7-110">In coarse mode, the application waits until a specified time arrives and then executes the command.</span></span> <span data-ttu-id="c17a7-111">在精確的模式中，應用程式會等到處理開始于當時出現的範例上執行，然後執行命令。</span><span class="sxs-lookup"><span data-stu-id="c17a7-111">In accurate mode, the application waits until processing begins on the sample that appears at the time, and then executes the command.</span></span> <span data-ttu-id="c17a7-112">篩選準則會決定要執行哪一個。</span><span class="sxs-lookup"><span data-stu-id="c17a7-112">The filter determines which one it will implement.</span></span> <span data-ttu-id="c17a7-113">篩選圖形管理員一律會針對在篩選圖形管理員中排入佇列的命令，實施粗略模式。</span><span class="sxs-lookup"><span data-stu-id="c17a7-113">The filter graph manager always implements coarse mode for commands that are queued at the filter graph manager.</span></span>

<span data-ttu-id="c17a7-114">如果您想要進行粗略的同步處理，您可能會想要等到有命令到期，然後執行它。</span><span class="sxs-lookup"><span data-stu-id="c17a7-114">If you want coarse synchronization, you probably want to wait until there is a command due, and then execute it.</span></span> <span data-ttu-id="c17a7-115">您可以藉由呼叫 [**CCmdQueue：： GetDueCommand**](ccmdqueue-getduecommand.md)來執行這項作業。</span><span class="sxs-lookup"><span data-stu-id="c17a7-115">You can do this by calling [**CCmdQueue::GetDueCommand**](ccmdqueue-getduecommand.md).</span></span> <span data-ttu-id="c17a7-116">如果您有幾件事要等候，請從 [**CCmdQueue：： GetDueHandle**](ccmdqueue-getduehandle.md) 取得事件控制碼，然後在收到通知時呼叫 **CCmdQueue：： GetDueCommand** 。</span><span class="sxs-lookup"><span data-stu-id="c17a7-116">If you have several things to wait for, get the event handle from [**CCmdQueue::GetDueHandle**](ccmdqueue-getduehandle.md) and then call **CCmdQueue::GetDueCommand** when this is signaled.</span></span> <span data-ttu-id="c17a7-117">[**stream time**](stream-time.md) 只會在 [**CCmdQueue：： Run**](ccmdqueue-run.md) 和 [**CCmdQueue：： EndRun**](ccmdqueue-endrun.md) 成員函式的呼叫之間前進。</span><span class="sxs-lookup"><span data-stu-id="c17a7-117">[**stream time**](stream-time.md) will advance only between calls to the [**CCmdQueue::Run**](ccmdqueue-run.md) and [**CCmdQueue::EndRun**](ccmdqueue-endrun.md) member functions.</span></span> <span data-ttu-id="c17a7-118">如果已設定控制碼，就無法保證會有命令可供使用。</span><span class="sxs-lookup"><span data-stu-id="c17a7-118">There is no guarantee that if the handle is set, there will be a command ready.</span></span> <span data-ttu-id="c17a7-119">每次通知事件時，呼叫 **GetDueCommand** 成員函式 (可能有零) 的超時;如果沒有任何命令就緒，這可能會傳回 E \_ ABORT。</span><span class="sxs-lookup"><span data-stu-id="c17a7-119">Each time the event is signaled, call the **GetDueCommand** member function (probably with a time-out of zero); this can return E\_ABORT if no command is ready.</span></span>

<span data-ttu-id="c17a7-120">如果您想要精確的同步處理，請呼叫 [**CCmdQueue：： GetCommandDueFor**](ccmdqueue-getcommandduefor.md) 成員函式，並將您即將處理的範例傳遞為參數。</span><span class="sxs-lookup"><span data-stu-id="c17a7-120">If you want accurate synchronization, call the [**CCmdQueue::GetCommandDueFor**](ccmdqueue-getcommandduefor.md) member function and pass the samples you are about to process as a parameter.</span></span> <span data-ttu-id="c17a7-121">這會傳回下列內容：</span><span class="sxs-lookup"><span data-stu-id="c17a7-121">This returns the following:</span></span>

-   <span data-ttu-id="c17a7-122">資料流程時間或該資料流程時間之前或之前的資料流程時間命令。</span><span class="sxs-lookup"><span data-stu-id="c17a7-122">A stream-time command due at or before that stream time.</span></span>
-   <span data-ttu-id="c17a7-123">在呈現資料流程時間之前或之前的呈現時間命令。</span><span class="sxs-lookup"><span data-stu-id="c17a7-123">A presentation-time command due at or before the presentation of the stream time.</span></span> <span data-ttu-id="c17a7-124">請只在 [**CCmdQueue：： Run**](ccmdqueue-run.md) 和 [**CCmdQueue：： EndRun**](ccmdqueue-endrun.md) 成員函式之間執行此動作，因為在此之外，從資料流程時間到呈現時間的對應不是已知的。</span><span class="sxs-lookup"><span data-stu-id="c17a7-124">Do this only between the [**CCmdQueue::Run**](ccmdqueue-run.md) and [**CCmdQueue::EndRun**](ccmdqueue-endrun.md) member functions, because outside of this, the mapping from stream time to presentation time is not known.</span></span>
-   <span data-ttu-id="c17a7-125">立即到期的任何展示時間命令。</span><span class="sxs-lookup"><span data-stu-id="c17a7-125">Any presentation-time command due now.</span></span>

<span data-ttu-id="c17a7-126">如果您想要對可能在暫停模式期間處理的樣本進行精確的同步處理，則必須使用資料流程時間命令。</span><span class="sxs-lookup"><span data-stu-id="c17a7-126">If you want accurate synchronization for samples that might be processed during paused mode, you must use stream-time commands.</span></span>

<span data-ttu-id="c17a7-127">在所有情況下，命令都會保持佇列，直到呼叫或取消為止。</span><span class="sxs-lookup"><span data-stu-id="c17a7-127">In all cases, commands remain queued until called or canceled.</span></span> <span data-ttu-id="c17a7-128">事件控制碼的設定和重設完全由此佇列物件管理。</span><span class="sxs-lookup"><span data-stu-id="c17a7-128">The setting and resetting of the event handle is managed entirely by this queue object.</span></span>



| <span data-ttu-id="c17a7-129">受保護的資料成員</span><span class="sxs-lookup"><span data-stu-id="c17a7-129">Protected Data Members</span></span>                                 | <span data-ttu-id="c17a7-130">Description</span><span class="sxs-lookup"><span data-stu-id="c17a7-130">Description</span></span>                                                                                            |
|--------------------------------------------------------|--------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="c17a7-131">m \_ bRunning</span><span class="sxs-lookup"><span data-stu-id="c17a7-131">m\_bRunning</span></span>                                            | <span data-ttu-id="c17a7-132">執行狀態的旗標;執行時，請設定 **TRUE** 。</span><span class="sxs-lookup"><span data-stu-id="c17a7-132">Flag for running state; set **TRUE** when running.</span></span>                                                     |
| <span data-ttu-id="c17a7-133">m \_ dwAdvise</span><span class="sxs-lookup"><span data-stu-id="c17a7-133">m\_dwAdvise</span></span>                                            | <span data-ttu-id="c17a7-134">如果沒有未完成的建議) ，則建議參考時鐘中的識別碼 (零。</span><span class="sxs-lookup"><span data-stu-id="c17a7-134">Advise identifier from the reference clock (zero if no outstanding advise).</span></span>                            |
| <span data-ttu-id="c17a7-135">m \_ evDue</span><span class="sxs-lookup"><span data-stu-id="c17a7-135">m\_evDue</span></span>                                               | <span data-ttu-id="c17a7-136">設定任何命令即將到期的時間。</span><span class="sxs-lookup"><span data-stu-id="c17a7-136">Sets the time when any commands are due.</span></span>                                                               |
| <span data-ttu-id="c17a7-137">m \_ listPresentation</span><span class="sxs-lookup"><span data-stu-id="c17a7-137">m\_listPresentation</span></span>                                    | <span data-ttu-id="c17a7-138">將命令儲存在展示時間佇列中。</span><span class="sxs-lookup"><span data-stu-id="c17a7-138">Stores commands queued in presentation time.</span></span>                                                           |
| <span data-ttu-id="c17a7-139">m \_ listStream</span><span class="sxs-lookup"><span data-stu-id="c17a7-139">m\_listStream</span></span>                                          | <span data-ttu-id="c17a7-140">儲存以資料流程時間佇列的命令。</span><span class="sxs-lookup"><span data-stu-id="c17a7-140">Stores commands queued in stream time.</span></span>                                                                 |
| <span data-ttu-id="c17a7-141">m \_ 鎖定</span><span class="sxs-lookup"><span data-stu-id="c17a7-141">m\_Lock</span></span>                                                | <span data-ttu-id="c17a7-142">保護對清單的存取。</span><span class="sxs-lookup"><span data-stu-id="c17a7-142">Protects access to lists.</span></span>                                                                              |
| <span data-ttu-id="c17a7-143">m \_ pClock</span><span class="sxs-lookup"><span data-stu-id="c17a7-143">m\_pClock</span></span>                                              | <span data-ttu-id="c17a7-144">目前的參考時鐘。</span><span class="sxs-lookup"><span data-stu-id="c17a7-144">Current reference clock.</span></span>                                                                               |
| <span data-ttu-id="c17a7-145">m \_ StreamTimeOffset</span><span class="sxs-lookup"><span data-stu-id="c17a7-145">m\_StreamTimeOffset</span></span>                                    | <span data-ttu-id="c17a7-146">當 **m \_ BRunning** 為 **TRUE** 時，包含資料流程時間位移。</span><span class="sxs-lookup"><span data-stu-id="c17a7-146">Contains the stream time offset when **m\_bRunning** is **TRUE**.</span></span>                                      |
| <span data-ttu-id="c17a7-147">m \_ StreamTimeOffset</span><span class="sxs-lookup"><span data-stu-id="c17a7-147">m\_StreamTimeOffset</span></span>                                    | <span data-ttu-id="c17a7-148">當 **m \_ BRunning** 為 **TRUE** 時，包含資料流程時間位移。</span><span class="sxs-lookup"><span data-stu-id="c17a7-148">Contains the stream time offset when **m\_bRunning** is **TRUE**.</span></span>                                      |
| <span data-ttu-id="c17a7-149">成員函數</span><span class="sxs-lookup"><span data-stu-id="c17a7-149">Member Functions</span></span>                                       | <span data-ttu-id="c17a7-150">Description</span><span class="sxs-lookup"><span data-stu-id="c17a7-150">Description</span></span>                                                                                            |
| [<span data-ttu-id="c17a7-151">**CCmdQueue**</span><span class="sxs-lookup"><span data-stu-id="c17a7-151">**CCmdQueue**</span></span>](ccmdqueue-ccmdqueue.md)               | <span data-ttu-id="c17a7-152">結構 **CCmdQueue** 物件。</span><span class="sxs-lookup"><span data-stu-id="c17a7-152">Constructs a **CCmdQueue** object.</span></span>                                                                     |
| [<span data-ttu-id="c17a7-153">**CheckTime**</span><span class="sxs-lookup"><span data-stu-id="c17a7-153">**CheckTime**</span></span>](ccmdqueue-checktime.md)               | <span data-ttu-id="c17a7-154">判斷指定的時間是否為逾期。</span><span class="sxs-lookup"><span data-stu-id="c17a7-154">Determines if a given time is due.</span></span>                                                                     |
| [<span data-ttu-id="c17a7-155">**GetDueHandle**</span><span class="sxs-lookup"><span data-stu-id="c17a7-155">**GetDueHandle**</span></span>](ccmdqueue-getduehandle.md)         | <span data-ttu-id="c17a7-156">抓取將發出信號的事件控制碼。</span><span class="sxs-lookup"><span data-stu-id="c17a7-156">Retrieves the event handle that will be signaled.</span></span>                                                      |
| <span data-ttu-id="c17a7-157">可覆寫的成員函式</span><span class="sxs-lookup"><span data-stu-id="c17a7-157">Overridable Member Functions</span></span>                           | <span data-ttu-id="c17a7-158">Description</span><span class="sxs-lookup"><span data-stu-id="c17a7-158">Description</span></span>                                                                                            |
| [<span data-ttu-id="c17a7-159">**EndRun**</span><span class="sxs-lookup"><span data-stu-id="c17a7-159">**EndRun**</span></span>](ccmdqueue-endrun.md)                     | <span data-ttu-id="c17a7-160">切換為 [已停止] 或 [已暫停] 模式。</span><span class="sxs-lookup"><span data-stu-id="c17a7-160">Switches to stopped or paused mode.</span></span>                                                                    |
| [<span data-ttu-id="c17a7-161">**GetCommandDueFor**</span><span class="sxs-lookup"><span data-stu-id="c17a7-161">**GetCommandDueFor**</span></span>](ccmdqueue-getcommandduefor.md) | <span data-ttu-id="c17a7-162">抓取在指定時間排程的延後命令。</span><span class="sxs-lookup"><span data-stu-id="c17a7-162">Retrieves a deferred command that is scheduled at a specified time.</span></span>                                    |
| [<span data-ttu-id="c17a7-163">**GetDueCommand**</span><span class="sxs-lookup"><span data-stu-id="c17a7-163">**GetDueCommand**</span></span>](ccmdqueue-getduecommand.md)       | <span data-ttu-id="c17a7-164">抓取下一個已到期命令的指標。</span><span class="sxs-lookup"><span data-stu-id="c17a7-164">Retrieves a pointer to the next command that is due.</span></span>                                                   |
| [<span data-ttu-id="c17a7-165">**插入**</span><span class="sxs-lookup"><span data-stu-id="c17a7-165">**Insert**</span></span>](ccmdqueue-insert.md)                     | <span data-ttu-id="c17a7-166">將 [**CDeferredCommand**](cdeferredcommand.md) 物件新增至佇列。</span><span class="sxs-lookup"><span data-stu-id="c17a7-166">Adds the [**CDeferredCommand**](cdeferredcommand.md) object to the queue.</span></span>                             |
| [<span data-ttu-id="c17a7-167">**新增**</span><span class="sxs-lookup"><span data-stu-id="c17a7-167">**New**</span></span>](ccmdqueue-new.md)                           | <span data-ttu-id="c17a7-168">初始化要執行的命令，並傳回新的 [**CDeferredCommand**](cdeferredcommand.md) 物件。</span><span class="sxs-lookup"><span data-stu-id="c17a7-168">Initializes a command to be run and returns a new [**CDeferredCommand**](cdeferredcommand.md) object.</span></span> |
| [<span data-ttu-id="c17a7-169">**移除**</span><span class="sxs-lookup"><span data-stu-id="c17a7-169">**Remove**</span></span>](ccmdqueue-remove.md)                     | <span data-ttu-id="c17a7-170">從佇列中移除 [**CDeferredCommand**](cdeferredcommand.md) 物件。</span><span class="sxs-lookup"><span data-stu-id="c17a7-170">Removes the [**CDeferredCommand**](cdeferredcommand.md) object from the queue.</span></span>                        |
| [<span data-ttu-id="c17a7-171">**執行**</span><span class="sxs-lookup"><span data-stu-id="c17a7-171">**Run**</span></span>](ccmdqueue-run.md)                           | <span data-ttu-id="c17a7-172">切換至執行模式。</span><span class="sxs-lookup"><span data-stu-id="c17a7-172">Switches to running mode.</span></span>                                                                              |
| [<span data-ttu-id="c17a7-173">**SetSyncSource**</span><span class="sxs-lookup"><span data-stu-id="c17a7-173">**SetSyncSource**</span></span>](ccmdqueue-setsyncsource.md)       | <span data-ttu-id="c17a7-174">設定用於時間的時鐘。</span><span class="sxs-lookup"><span data-stu-id="c17a7-174">Sets the clock used for timing.</span></span>                                                                        |
| [<span data-ttu-id="c17a7-175">**SetTimeAdvise**</span><span class="sxs-lookup"><span data-stu-id="c17a7-175">**SetTimeAdvise**</span></span>](ccmdqueue-settimeadvise.md)       | <span data-ttu-id="c17a7-176">使用參考時鐘來設定計時器事件。</span><span class="sxs-lookup"><span data-stu-id="c17a7-176">Sets up a timer event with the reference clock.</span></span>                                                        |



 

 

 



