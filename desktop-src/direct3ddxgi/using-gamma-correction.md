---
description: Gamma 更正（簡稱為 gamma）是指系統用來編碼和解碼影像中圖元值的非線性運算名稱。
ms.assetid: 97ACDAE3-514E-4AAF-A27D-E5FFC162DB2A
title: 使用 gamma 更正
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 1c940db1a94fb41e9babecbeb3075aa9e01b3732
ms.sourcegitcommit: a47bd86f517de76374e4fff33cfeb613eb259a7e
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/06/2021
ms.locfileid: "104561060"
---
# <a name="using-gamma-correction"></a><span data-ttu-id="13843-103">使用 gamma 更正</span><span class="sxs-lookup"><span data-stu-id="13843-103">Using gamma correction</span></span>

<span data-ttu-id="13843-104">Gamma 更正（簡稱為 gamma）是指系統用來編碼和解碼影像中圖元值的非線性運算名稱。</span><span class="sxs-lookup"><span data-stu-id="13843-104">Gamma correction, or gamma for short, is the name of a nonlinear operation that systems use to code and decode pixel values in images.</span></span>

-   [<span data-ttu-id="13843-105">什麼是 gamma？是什麼？</span><span class="sxs-lookup"><span data-stu-id="13843-105">What is gamma and what is it for?</span></span>](#what-is-gamma-and-what-is-it-for)
-   [<span data-ttu-id="13843-106">Windows 上的 gamma 背景</span><span class="sxs-lookup"><span data-stu-id="13843-106">Background of gamma on Windows</span></span>](#background-of-gamma-on-windows)
-   [<span data-ttu-id="13843-107">顯示器硬體的演進</span><span class="sxs-lookup"><span data-stu-id="13843-107">Evolution of display hardware</span></span>](#evolution-of-display-hardware)
-   [<span data-ttu-id="13843-108">DXGI 中的 Gamma 控制項功能</span><span class="sxs-lookup"><span data-stu-id="13843-108">Gamma control capabilities in DXGI</span></span>](#gamma-control-capabilities-in-dxgi)
-   [<span data-ttu-id="13843-109">使用 DXGI 設定 gamma 控制項</span><span class="sxs-lookup"><span data-stu-id="13843-109">Setting gamma control with DXGI</span></span>](#setting-gamma-control-with-dxgi)
-   [<span data-ttu-id="13843-110">Gamma 控制項 practicalities</span><span class="sxs-lookup"><span data-stu-id="13843-110">Gamma control practicalities</span></span>](#gamma-control-practicalities)
-   [<span data-ttu-id="13843-111">相關主題</span><span class="sxs-lookup"><span data-stu-id="13843-111">Related topics</span></span>](#related-topics)

## <a name="what-is-gamma-and-what-is-it-for"></a><span data-ttu-id="13843-112">什麼是 gamma？是什麼？</span><span class="sxs-lookup"><span data-stu-id="13843-112">What is gamma and what is it for?</span></span>

<span data-ttu-id="13843-113">在圖形管線的結尾，只要影像離開電腦，讓它沿著監視器纜線進行，就有一小部分的硬體可以即時轉換圖元值。</span><span class="sxs-lookup"><span data-stu-id="13843-113">At the end of the graphics pipeline, just where the image leaves the computer to make its journey along the monitor cable, there is a small piece of hardware that can transform pixel values on the fly.</span></span> <span data-ttu-id="13843-114">此硬體通常會使用查閱資料表來轉換圖元。</span><span class="sxs-lookup"><span data-stu-id="13843-114">This hardware typically uses a lookup table to transform the pixels.</span></span> <span data-ttu-id="13843-115">此硬體使用來自表面的紅色、綠色和藍色值來查閱資料表中的 gamma 修正值，然後將更正的值傳送至監視器，而不是實際的介面值。</span><span class="sxs-lookup"><span data-stu-id="13843-115">This hardware uses the red, green and blue values that come from the surface to be displayed to look up gamma-corrected values in the table and then sends the corrected values to the monitor instead of the actual surface values.</span></span> <span data-ttu-id="13843-116">因此，這個查閱資料表是以任何其他色彩取代任何色彩的機會。</span><span class="sxs-lookup"><span data-stu-id="13843-116">So, this lookup table is an opportunity to replace any color with any other color.</span></span> <span data-ttu-id="13843-117">雖然資料表具有這一層級的電源，但一般使用方式是稍微調整影像，以補償監視器回應的差異。</span><span class="sxs-lookup"><span data-stu-id="13843-117">While the table has that level of power, the typical usage is to tweak images subtly to compensate for differences in the monitor’s response.</span></span> <span data-ttu-id="13843-118">監視器的回應是一種函式，它會將圖元的紅色、綠色和藍色元件的數值與圖元顯示的亮度建立關聯。</span><span class="sxs-lookup"><span data-stu-id="13843-118">The monitor’s response is the function that relates the numerical value of the red, green and blue components of a pixel with that pixel’s displayed brightness.</span></span>

<span data-ttu-id="13843-119">這就是這個資料表的目的，但是遊戲開發人員發現它有創意的用途，例如將整個螢幕的螢幕閃爍為紅色以心理效果。</span><span class="sxs-lookup"><span data-stu-id="13843-119">That’s what this table was intended for, but game developers found creative uses for it, such as flashing the whole screen red for psychological effect.</span></span> <span data-ttu-id="13843-120">在新式遊戲應用程式中，在每個畫面格的後續處理過程中，我們通常會提供其他方法來進行這類作業。</span><span class="sxs-lookup"><span data-stu-id="13843-120">In modern game apps, as part of the post-processing of each frame, we typically provide other ways to do such things.</span></span> <span data-ttu-id="13843-121">事實上，我們建議您只保留 gamma 資料表，因為它可能會用來校正監視器的回應，而對 gamma 的變化，對 gamma 的變化會損毀這項仔細的校正。</span><span class="sxs-lookup"><span data-stu-id="13843-121">In fact, we recommend that you leave the gamma table alone because it might be in use to calibrate the monitor’s response, and wholesale changes to the gamma ramp will destroy this careful calibration.</span></span>

<span data-ttu-id="13843-122">判斷 gamma 校正的科學是很複雜的，在這裡並不會顯示，而是除了用來照亮名稱 "gamma" 的位置。</span><span class="sxs-lookup"><span data-stu-id="13843-122">The science of determining gamma correction is complex, and is not presented here, other than to illuminate where the name “gamma” came from.</span></span> <span data-ttu-id="13843-123">CRT (也就是舊的半透明玻璃) 監視器的回應是一個複雜的函式，但這些監視器的物理意思表示這些監視器所呈現的回應可以初步由這個 power 函數表示：</span><span class="sxs-lookup"><span data-stu-id="13843-123">A CRT (that is, an old-fashioned glass) monitor’s response is a complex function, but the physics of these monitors mean that they exhibit a response that can be crudely represented by this power function:</span></span>

<span data-ttu-id="13843-124">亮度 ( 輸入 ) = 輸入<sup>gamma</sup></span><span class="sxs-lookup"><span data-stu-id="13843-124">brightness( input ) = input<sup>gamma</sup></span></span>

<span data-ttu-id="13843-125">Gamma 值通常接近2.0 的值。</span><span class="sxs-lookup"><span data-stu-id="13843-125">The gamma value is typically close to a value of 2.0.</span></span> <span data-ttu-id="13843-126">LCD 監視器和其他所有較新的技術都是特別設計來呈現類似的回應，因此我們不需要為這些新技術 recalibrated 所有的軟體和映射。</span><span class="sxs-lookup"><span data-stu-id="13843-126">LCD monitors and all other newer technologies are specifically engineered to exhibit a similar response so all our software and images don’t have to be recalibrated for those new technologies.</span></span> <span data-ttu-id="13843-127">SRGB 標準宣告此 gamma 值正好是2.2，而此值已成為廣泛實行的標準。</span><span class="sxs-lookup"><span data-stu-id="13843-127">The sRGB standard declares that this gamma value is exactly 2.2, and this value has become a widely implemented standard.</span></span>

<span data-ttu-id="13843-128">人類眼也有一個回應函式，其大約會反轉 CRT 電源函式。</span><span class="sxs-lookup"><span data-stu-id="13843-128">The human eye also has a response function which approximately inverts the CRT power function.</span></span> <span data-ttu-id="13843-129">這表示，圖元的感覺亮度在該圖元的 RGB 值上大致上會呈線性。</span><span class="sxs-lookup"><span data-stu-id="13843-129">This means that the perceived brightness of a pixel goes up very roughly linearly with the RGB values in that pixel.</span></span>

<span data-ttu-id="13843-130">由於 gamma 值2.2 已經成為一種被忽略的標準，因此我們通常不需要擔心此資料表中編碼的 gamma 曲線太多，而且可以將它保留為線性、一對一的對應。</span><span class="sxs-lookup"><span data-stu-id="13843-130">Because a gamma value of 2.2 has become a de-facto standard, we typically don’t need to worry too much about the gamma curve encoded in this table, and can leave it as a linear, one-to-one mapping.</span></span> <span data-ttu-id="13843-131">當然，適當的色彩比對需要 exquisite 此功能，但該討論已超出本主題的範圍。</span><span class="sxs-lookup"><span data-stu-id="13843-131">Proper color matching does of course require exquisite care with this function, but that discussion is beyond the scope of this topic.</span></span> <span data-ttu-id="13843-132">Windows 包含一種工具，可讓使用者將其顯示內容調整為 gamma 2.2，而此工具會使用查閱資料表硬體，為其電腦衍生出審慎選擇的微妙調整。</span><span class="sxs-lookup"><span data-stu-id="13843-132">Windows includes a tool that lets users calibrate their displays to gamma 2.2, and this tool uses the lookup table hardware to derive a carefully-chosen subtle tweak for their computers.</span></span> <span data-ttu-id="13843-133">使用者可以藉由搜尋「校正色彩」來執行此工具。</span><span class="sxs-lookup"><span data-stu-id="13843-133">Users can run this tool by searching for "calibrate color".</span></span> <span data-ttu-id="13843-134">針對將此程式自動化的特定監視器，也有妥善定義的色彩設定檔。</span><span class="sxs-lookup"><span data-stu-id="13843-134">There are also well-defined color profiles for particular monitors that automate this process.</span></span> <span data-ttu-id="13843-135">「校正色彩」工具可以偵測這些較新的監視器，並通知使用者已在進行校正。</span><span class="sxs-lookup"><span data-stu-id="13843-135">The "calibrate color" tool can detect these newer monitors, and inform users that calibration is already in place.</span></span>

<span data-ttu-id="13843-136">這種將 power 定律編碼成色彩值的概念，在圖形管線中的其他地方很有用，尤其是在材質中。</span><span class="sxs-lookup"><span data-stu-id="13843-136">This notion of encoding a power law into color values is useful elsewhere in the graphics pipeline too, especially in textures.</span></span> <span data-ttu-id="13843-137">針對材質，您希望較深的色彩有更高的精確度，因為我們剛剛提到的是對數人類眼的回應。</span><span class="sxs-lookup"><span data-stu-id="13843-137">For textures, you want more precision on darker colors because of the logarithmic human eye response we just talked about.</span></span> <span data-ttu-id="13843-138">在管線的這個部分中小心處理 gamma 是很重要的。</span><span class="sxs-lookup"><span data-stu-id="13843-138">Careful handling of gamma in this part of the pipeline is important.</span></span> <span data-ttu-id="13843-139">如需詳細資訊，請參閱 [轉換色彩空間的資料](converting-data-color-space.md)。</span><span class="sxs-lookup"><span data-stu-id="13843-139">For more info, see [Converting data for the color space](converting-data-color-space.md).</span></span>

<span data-ttu-id="13843-140">本主題的其餘部分只著重于管線最後一部分（框架緩衝區資料和監視器）之間的 gamma 修正。</span><span class="sxs-lookup"><span data-stu-id="13843-140">The remainder of this topic focuses only on gamma correction in this last part of the pipeline, between the frame buffer data and the monitor.</span></span> <span data-ttu-id="13843-141">如果您想要撰寫校正 wizard 或在全螢幕應用程式中建立特殊效果，其中的後置處理步驟並不實用，以下是您需要的資訊。</span><span class="sxs-lookup"><span data-stu-id="13843-141">If you want to write a calibration wizard or to create special effects in a full-screen app where a post-processing step is not practical, here is the info you need.</span></span>

## <a name="background-of-gamma-on-windows"></a><span data-ttu-id="13843-142">Windows 上的 gamma 背景</span><span class="sxs-lookup"><span data-stu-id="13843-142">Background of gamma on Windows</span></span>

<span data-ttu-id="13843-143">Windows 電腦通常會有一個 gamma 資料表，此資料表是採用三個位元組並輸出三位元組位元組的查閱資料表。</span><span class="sxs-lookup"><span data-stu-id="13843-143">Windows computers typically have a gamma table that is a lookup table that takes a triplet of bytes and outputs a triplet of bytes.</span></span> <span data-ttu-id="13843-144">這些 triplet 是 768 (256 x 3) 個位元組的 RAM。</span><span class="sxs-lookup"><span data-stu-id="13843-144">These triplets are 768 (256 x 3) bytes of RAM.</span></span> <span data-ttu-id="13843-145">當您的顯示格式包含三個 RGB 位元組值，但無法描述當顯示格式的範圍大於 \[ 0、1 \] （例如浮點值）時，您可能想要的轉換，這是不錯的選擇。</span><span class="sxs-lookup"><span data-stu-id="13843-145">This is fine when your display format contains a triplet of RGB BYTE values but isn't expressive enough to describe the transformations that you might want when the display format has a greater range than \[0,1\], such as floating point values.</span></span> <span data-ttu-id="13843-146">Windows 中控制 gamma 的 Api，因為顯示格式變得更複雜。</span><span class="sxs-lookup"><span data-stu-id="13843-146">The APIs in Windows that control gamma have followed an evolution as display formats have become more complex.</span></span>

<span data-ttu-id="13843-147">提供 gamma 控制項的第一個 Windows Api 是 Windows 圖形裝置介面 (GDI) 的 [**SetDeviceGammaRamp**](/windows/win32/api/wingdi/nf-wingdi-setdevicegammaramp) 和 [**GetDeviceGammaRamp**](/windows/win32/api/wingdi/nf-wingdi-getdevicegammaramp)。</span><span class="sxs-lookup"><span data-stu-id="13843-147">The first Windows APIs to offer gamma control are Windows Graphics Device Interface (GDI)’s [**SetDeviceGammaRamp**](/windows/win32/api/wingdi/nf-wingdi-setdevicegammaramp) and [**GetDeviceGammaRamp**](/windows/win32/api/wingdi/nf-wingdi-getdevicegammaramp).</span></span> <span data-ttu-id="13843-148">這些 Api 會使用 3 256-entry 陣列，其中每個單字編碼為零，並以單字值0和65535表示。</span><span class="sxs-lookup"><span data-stu-id="13843-148">These APIs work with three 256-entry arrays of WORDs, with each WORD encoding zero up to one, represented by WORD values 0 and 65535.</span></span> <span data-ttu-id="13843-149">單字的額外精確度通常不適用於實際的硬體查閱資料表，但是這些 Api 的目的是要有彈性。</span><span class="sxs-lookup"><span data-stu-id="13843-149">The extra precision of a WORD typically isn’t available in actual hardware lookup tables, but these APIs were intended to be flexible.</span></span> <span data-ttu-id="13843-150">這些 Api 相對於本節稍後所述的其他 Api，只允許來自身分識別函式的小偏差。</span><span class="sxs-lookup"><span data-stu-id="13843-150">These APIs, in contrast to the others described later in this section, allow only a small deviation from an identity function.</span></span> <span data-ttu-id="13843-151">事實上，這一條的任何專案都必須在識別值的32768內。</span><span class="sxs-lookup"><span data-stu-id="13843-151">In fact, any entry in the ramp must be within 32768 of the identity value.</span></span> <span data-ttu-id="13843-152">這種限制表示沒有任何應用程式可以將顯示器完全變為黑色或其他無法閱讀的色彩。</span><span class="sxs-lookup"><span data-stu-id="13843-152">This restriction means that no app can turn the display completely black or to some other unreadable color.</span></span>

<span data-ttu-id="13843-153">下一個 API 是 Microsoft Direct3D 9 的 [**SetGammaRamp**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-setgammaramp)，其遵循與 [**SetDeviceGammaRamp**](/windows/win32/api/wingdi/nf-wingdi-setdevicegammaramp)相同的模式和資料格式。</span><span class="sxs-lookup"><span data-stu-id="13843-153">The next API is Microsoft Direct3D 9’s [**SetGammaRamp**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-setgammaramp), which follows the same pattern and data format as [**SetDeviceGammaRamp**](/windows/win32/api/wingdi/nf-wingdi-setdevicegammaramp).</span></span> <span data-ttu-id="13843-154">Direct3D 9 gamma 曲線的預設值並不特別有用;雖然 API 是以0-65535 來定義的，但它是一種初始化為0-255 而非0-65535 的單字。</span><span class="sxs-lookup"><span data-stu-id="13843-154">The default value of the Direct3D 9 gamma ramp is not particularly useful; it is a ramp of WORDs initialized to 0-255, not 0-65535, even though the API is defined in terms of 0-65535.</span></span>

<span data-ttu-id="13843-155">最新的 API 是 [**IDXGIOutput：： SetGammaControl**](/windows/desktop/api/DXGI/nf-dxgi-idxgioutput-setgammacontrol)。</span><span class="sxs-lookup"><span data-stu-id="13843-155">The latest API is [**IDXGIOutput::SetGammaControl**](/windows/desktop/api/DXGI/nf-dxgi-idxgioutput-setgammacontrol).</span></span> <span data-ttu-id="13843-156">此 API 有更具彈性的配置，可表示 gamma 控制項，因為適用 DXGI 增加了一組顯示格式，包括每個通道10個整數位、16位浮點數格式，以及 XR \_ 偏差延伸範圍格式。</span><span class="sxs-lookup"><span data-stu-id="13843-156">This API has a more flexible scheme to express gamma control, as befits DXGI’s increased set of display formats, including ten integer bits-per-channel, 16-bit float formats and the XR\_BIAS extended range format.</span></span>

<span data-ttu-id="13843-157">這些 Api 全都在相同的硬體上運作，並且變更相同的值。</span><span class="sxs-lookup"><span data-stu-id="13843-157">All of these APIs operate on the same hardware, and change the same values.</span></span> <span data-ttu-id="13843-158">Direct3D 9 和 DXGI Api 都是「僅限寫入」。</span><span class="sxs-lookup"><span data-stu-id="13843-158">The Direct3D 9 and DXGI APIs are “write only”.</span></span> <span data-ttu-id="13843-159">您無法讀取硬體的值、加以修改，然後設定它。</span><span class="sxs-lookup"><span data-stu-id="13843-159">You can't read the value of the hardware, modify it, and then set it.</span></span> <span data-ttu-id="13843-160">您只能設定滑軌。</span><span class="sxs-lookup"><span data-stu-id="13843-160">You can only set the ramp.</span></span> <span data-ttu-id="13843-161">此外，您只能在應用程式全螢幕時，設定 gamma。</span><span class="sxs-lookup"><span data-stu-id="13843-161">Furthermore, you can only set gamma when the app is full screen.</span></span> <span data-ttu-id="13843-162">這項限制是保證桌面永遠可讀取的另一種方式。</span><span class="sxs-lookup"><span data-stu-id="13843-162">This restriction is another way to guarantee that the desktop is always readable.</span></span> <span data-ttu-id="13843-163">也就是說，應用程式可以擾亂自己的顯示器，但是當應用程式失去全螢幕時，Windows 會還原先前的 gamma 曲線 (例如，透過 alt-tab 或 ctrl-alt-del) 。</span><span class="sxs-lookup"><span data-stu-id="13843-163">That is, the app can disturb its own display, but Windows will restore the previous gamma ramp when the app loses full screen (for example, via alt-tab or ctrl-alt-del).</span></span>

## <a name="evolution-of-display-hardware"></a><span data-ttu-id="13843-164">顯示器硬體的演進</span><span class="sxs-lookup"><span data-stu-id="13843-164">Evolution of display hardware</span></span>

<span data-ttu-id="13843-165">有些較新的監視器可能會顯示各種濃度。</span><span class="sxs-lookup"><span data-stu-id="13843-165">Some newer monitors can display a wide range of intensities.</span></span> <span data-ttu-id="13843-166">但是，當顯示格式只能代表0和1之間的值時，顯示器必須將零對應至其最深的值，並將其對應至其最亮的值。</span><span class="sxs-lookup"><span data-stu-id="13843-166">But, when the display format can represent only values between zero and one, the display must map zero to its darkest value and one to its brightest value.</span></span> <span data-ttu-id="13843-167">這個最亮的值可能太亮，可方便您在白色背景上以黑色文字來觀賞網頁，但很適合用於明亮的特殊效果，例如，從 lake 觀看陽光 glittering，或從天空中的閃電。</span><span class="sxs-lookup"><span data-stu-id="13843-167">This brightest value might be far too bright for comfortable viewing of Web pages with black text on a white background but is wonderful for over-bright special effects, such as viewing sunlight glittering off of a lake or lightning forking the sky.</span></span> <span data-ttu-id="13843-168">因此，我們需要一種方式來表達這些更廣泛的範圍。</span><span class="sxs-lookup"><span data-stu-id="13843-168">So, we need a way to express these wider ranges.</span></span> <span data-ttu-id="13843-169">DXGI 1.1 和更新版本包含顯示格式值，可讓1.0 代表舒適的白色值，並保留更寬的顯示格式值以獲得過度的特殊效果。</span><span class="sxs-lookup"><span data-stu-id="13843-169">DXGI 1.1 and later contains display format values that let 1.0 represent a comfortable white value and reserves wider display format values for over-bright special effects.</span></span> <span data-ttu-id="13843-170">DXGI 1.1 支援兩種顯示格式，可表達這些較大的值： DXGI \_ 格式 \_ R10G10B10 \_ XR \_ 偏差 \_ A2 \_ UNORM 和16位浮點數。</span><span class="sxs-lookup"><span data-stu-id="13843-170">DXGI 1.1 supports two display formats that can express these wider values: DXGI\_FORMAT\_R10G10B10\_XR\_BIAS\_A2\_UNORM and 16-bit floating point.</span></span> <span data-ttu-id="13843-171">如需這些格式的完整討論，請參閱 [延伸格式的詳細資料](/windows-hardware/drivers/display/details-of-the-extended-format)。</span><span class="sxs-lookup"><span data-stu-id="13843-171">For a full discussion of these formats, see [Details of the Extended Format](/windows-hardware/drivers/display/details-of-the-extended-format).</span></span> <span data-ttu-id="13843-172">接下來，我們將探討為什麼 DXGI 的 [**IDXGIOutput：： SetGammaControl**](/windows/desktop/api/DXGI/nf-dxgi-idxgioutput-setgammacontrol) gamma API 需要大於1.0 的圖元值。</span><span class="sxs-lookup"><span data-stu-id="13843-172">Next, we look at why DXGI’s [**IDXGIOutput::SetGammaControl**](/windows/desktop/api/DXGI/nf-dxgi-idxgioutput-setgammacontrol) gamma API needs pixel values greater than 1.0.</span></span>

## <a name="gamma-control-capabilities-in-dxgi"></a><span data-ttu-id="13843-173">DXGI 中的 Gamma 控制項功能</span><span class="sxs-lookup"><span data-stu-id="13843-173">Gamma control capabilities in DXGI</span></span>

<span data-ttu-id="13843-174">DXGI 可讓顯示器驅動程式將其 gamma 控制項表示為逐步線性功能。</span><span class="sxs-lookup"><span data-stu-id="13843-174">DXGI lets the display driver express its gamma controls as a step-wise linear function.</span></span> <span data-ttu-id="13843-175">這個逐步線性函式是由這個函式的控制點、函式可以轉換成的值範圍，以及可在轉換後套用的額外選擇性縮放和位移運算來定義。</span><span class="sxs-lookup"><span data-stu-id="13843-175">This step-wise linear function is defined by the control points of this function, the range of values the function can convert to, and an additional optional scale-and-offset operation that can be applied after conversion.</span></span> <span data-ttu-id="13843-176">應用程式可以呼叫 [**IDXGIOutput：： GetGammaControlCapabilities**](/windows/desktop/api/DXGI/nf-dxgi-idxgioutput-getgammacontrolcapabilities) 方法，以在 [**DXGI \_ GAMMA \_ 控制項 \_ 功能**](/previous-versions/windows/desktop/legacy/bb173062(v=vs.85)) 結構中取得所有這些控制項功能。</span><span class="sxs-lookup"><span data-stu-id="13843-176">An app can call the [**IDXGIOutput::GetGammaControlCapabilities**](/windows/desktop/api/DXGI/nf-dxgi-idxgioutput-getgammacontrolcapabilities) method to retrieve all of these control capabilities in the [**DXGI\_GAMMA\_CONTROL\_CAPABILITIES**](/previous-versions/windows/desktop/legacy/bb173062(v=vs.85)) structure.</span></span>

<span data-ttu-id="13843-177">此圖表顯示僅有四個控制點的線性函數。</span><span class="sxs-lookup"><span data-stu-id="13843-177">This graph shows a linear function with just four control points.</span></span>

![gamma 更正線性函數](images/gamma-linear-function.png)

<span data-ttu-id="13843-179">DXGI 會依據介面色軸的位置來定義控制點。</span><span class="sxs-lookup"><span data-stu-id="13843-179">DXGI defines control points by their location along the surface color axis.</span></span> <span data-ttu-id="13843-180">在上圖中，控制點的位置是0、0.5、0.75 和1.0。</span><span class="sxs-lookup"><span data-stu-id="13843-180">In the preceding graph, the locations of the control points are 0, 0.5, 0.75 and 1.0.</span></span> <span data-ttu-id="13843-181">這些控制點表示硬體可以轉換範圍0到1.0 之間的值。</span><span class="sxs-lookup"><span data-stu-id="13843-181">These control points indicate that the hardware can convert values in the range 0 through 1.0.</span></span> <span data-ttu-id="13843-182">DXGI 會在 [**DXGI \_ GAMMA \_ 控制項 \_ 功能**](/previous-versions/windows/desktop/legacy/bb173062(v=vs.85))的 **ControlPointPositions** 陣列成員中列出這些控制點，並一律以遞增順序宣告它們。</span><span class="sxs-lookup"><span data-stu-id="13843-182">DXGI lists these control points in the **ControlPointPositions** array member of [**DXGI\_GAMMA\_CONTROL\_CAPABILITIES**](/previous-versions/windows/desktop/legacy/bb173062(v=vs.85)) and always declares them in increasing order.</span></span> <span data-ttu-id="13843-183">DXGI 只會填滿 **ControlPointPositions** 陣列的第一個元素，並指出具有 **DXGI \_ GAMMA \_ 控制項 \_ 功能** 之 **NumGammaControlPoints** 成員的元素數目。</span><span class="sxs-lookup"><span data-stu-id="13843-183">DXGI fills only the first elements of the **ControlPointPositions** array and indicates the number of elements with the **NumGammaControlPoints** member of **DXGI\_GAMMA\_CONTROL\_CAPABILITIES**.</span></span> <span data-ttu-id="13843-184">如果 **NumGammaControlPoints** 小於1025，DXGI 會讓其餘的 **ControlPointPositions** 元素保持未定義狀態。</span><span class="sxs-lookup"><span data-stu-id="13843-184">If **NumGammaControlPoints** is less than 1025, DXGI leaves the rest of the **ControlPointPositions** elements undefined.</span></span>

<span data-ttu-id="13843-185">此圖表所代表的硬體可以將值轉換為0到1.25 的範圍。</span><span class="sxs-lookup"><span data-stu-id="13843-185">The hardware represented by this graph can convert values to a range of 0 through 1.25.</span></span> <span data-ttu-id="13843-186">因此，DXGI 會分別將 **MinConvertedValue** 和 **MaxConvertedValue** 成員設定為 0.0 f 和 1.25 f。</span><span class="sxs-lookup"><span data-stu-id="13843-186">So, DXGI sets the **MinConvertedValue** and **MaxConvertedValue** members to 0.0f and 1.25f respectively.</span></span>

<span data-ttu-id="13843-187">DXGI 會設定 [**dxgi \_ GAMMA \_ 控制項 \_ 功能**](/previous-versions/windows/desktop/legacy/bb173062(v=vs.85))的 **ScaleAndOffsetSupported** 成員，以指出硬體是否支援縮放和位移功能。</span><span class="sxs-lookup"><span data-stu-id="13843-187">DXGI sets the **ScaleAndOffsetSupported** member of [**DXGI\_GAMMA\_CONTROL\_CAPABILITIES**](/previous-versions/windows/desktop/legacy/bb173062(v=vs.85)) to indicate whether the hardware supports the scale-and-offset capability.</span></span> <span data-ttu-id="13843-188">如果硬體支援縮放和位移，則會保留簡單的一對一查閱資料表，但接著會調整資料表的輸出，以將輸出延展到大於 \[ 0，1的範圍 \] 。</span><span class="sxs-lookup"><span data-stu-id="13843-188">If hardware supports scale-and-offset, it keeps a simple one-to-one lookup table but then adjusts the output of the table to stretch the output to a range greater than \[0,1\].</span></span> <span data-ttu-id="13843-189">硬體會先調整取自查閱資料表的值，然後將它們位移。</span><span class="sxs-lookup"><span data-stu-id="13843-189">The hardware first scales the values that come out of the lookup table and then offsets them.</span></span>

> [!Note]  
> <span data-ttu-id="13843-190">連接到同一部電腦的不同監視器可能會有不同的 gamma 控制項功能。</span><span class="sxs-lookup"><span data-stu-id="13843-190">Different monitors connected to the same computer might have different gamma control capabilities.</span></span> <span data-ttu-id="13843-191">此外，gamma 控制項功能實際上也會隨著輸出的顯示模式而變更。</span><span class="sxs-lookup"><span data-stu-id="13843-191">Moreover, the gamma control capabilities can in fact change depending on the display mode of the output.</span></span> <span data-ttu-id="13843-192">因此，建議您一律在應用程式進入全螢幕模式之後，呼叫 [**IDXGIOutput：： GetGammaControlCapabilities**](/windows/desktop/api/DXGI/nf-dxgi-idxgioutput-getgammacontrolcapabilities) 來查詢 gamma 控制項功能。</span><span class="sxs-lookup"><span data-stu-id="13843-192">Consequently, we recommend that you always call [**IDXGIOutput::GetGammaControlCapabilities**](/windows/desktop/api/DXGI/nf-dxgi-idxgioutput-getgammacontrolcapabilities) to query gamma control capabilities after your app enters full-screen mode.</span></span>

 

<span data-ttu-id="13843-193">您可以使用這些 gamma 控制項功能值來衍生控制項值，然後您可以使用 [**IDXGIOutput：： SetGammaControl**](/windows/desktop/api/DXGI/nf-dxgi-idxgioutput-setgammacontrol) API 來設定這些值。</span><span class="sxs-lookup"><span data-stu-id="13843-193">You can use these gamma control capability values to derive control values that you can then set by using the [**IDXGIOutput::SetGammaControl**](/windows/desktop/api/DXGI/nf-dxgi-idxgioutput-setgammacontrol) API.</span></span>

## <a name="setting-gamma-control-with-dxgi"></a><span data-ttu-id="13843-194">使用 DXGI 設定 gamma 控制項</span><span class="sxs-lookup"><span data-stu-id="13843-194">Setting gamma control with DXGI</span></span>

<span data-ttu-id="13843-195">若要設定 gamma 控制項，當您呼叫 [**IDXGIOutput：： SetGammaControl**](/windows/desktop/api/DXGI/nf-dxgi-idxgioutput-setgammacontrol) API 時，您會將指標傳遞至 [**DXGI \_ gamma \_ 控制項**](/previous-versions/windows/desktop/legacy/bb173061(v=vs.85))結構。</span><span class="sxs-lookup"><span data-stu-id="13843-195">To set gamma controls, you pass a pointer to a [**DXGI\_GAMMA\_CONTROL**](/previous-versions/windows/desktop/legacy/bb173061(v=vs.85)) structure when you call the [**IDXGIOutput::SetGammaControl**](/windows/desktop/api/DXGI/nf-dxgi-idxgioutput-setgammacontrol) API.</span></span>

<span data-ttu-id="13843-196">您可以設定 [**DXGI \_ GAMMA \_ 控制項**](/previous-versions/windows/desktop/legacy/bb173061(v=vs.85))的 **小** 數位數和 **位移** 成員，以指定要將硬體套用至您從查閱資料表取得之值的小數位數和位移值。</span><span class="sxs-lookup"><span data-stu-id="13843-196">You set the **Scale** and **Offset** members of [**DXGI\_GAMMA\_CONTROL**](/previous-versions/windows/desktop/legacy/bb173061(v=vs.85)) to specify the scale and offset values that you want the hardware to apply to the values that you get from the lookup table.</span></span> <span data-ttu-id="13843-197">您可以安全地將 [ **刻度** ] 設定為1，並將 [ **位移** ] 設為零 (也就是，一個小數位數沒有任何作用，而且如果您不想要使用 [調整] 和 [位移] 功能，或如果硬體沒有該功能，就不會有零的) 影響。</span><span class="sxs-lookup"><span data-stu-id="13843-197">You can safely set **Scale** to 1 and **Offset** to zero (that is, a scale by one has no effect and an offset of zero has no effect) if you don't want to use the scale-and-offset capability or if the hardware doesn't have that capability.</span></span>

<span data-ttu-id="13843-198">您將 [**dxgi \_ gamma \_ 控制項**](/previous-versions/windows/desktop/legacy/bb173061(v=vs.85))的 **GammaCurve** 陣列成員設定為 GAMMA 曲線上點的 [**dxgi \_ RGB**](/previous-versions/windows/desktop/legacy/bb173071(v=vs.85))結構清單。</span><span class="sxs-lookup"><span data-stu-id="13843-198">You set the **GammaCurve** array member of [**DXGI\_GAMMA\_CONTROL**](/previous-versions/windows/desktop/legacy/bb173061(v=vs.85)) to a list of [**DXGI\_RGB**](/previous-versions/windows/desktop/legacy/bb173071(v=vs.85)) structures for the points on the gamma curve.</span></span> <span data-ttu-id="13843-199">每個 **DXGI \_ RGB** 元素都會指定代表該點之紅色、綠色和藍色元件的浮點值。</span><span class="sxs-lookup"><span data-stu-id="13843-199">Each **DXGI\_RGB** element specifies the float values that represent the red, green, and blue components for that point.</span></span> <span data-ttu-id="13843-200">Gamma 曲線不會使用 Alpha 值。</span><span class="sxs-lookup"><span data-stu-id="13843-200">The gamma curve doesn't use alpha values.</span></span> <span data-ttu-id="13843-201">您可以使用從 **NumGammaControlPoints** 的 [**DXGI \_ GAMMA \_ 控制項 \_ 功能**](/previous-versions/windows/desktop/legacy/bb173062(v=vs.85)) 取得的數位，來填入 **GammaCurve** 陣列中的元素數目。</span><span class="sxs-lookup"><span data-stu-id="13843-201">You use the number that you obtained from **NumGammaControlPoints** of [**DXGI\_GAMMA\_CONTROL\_CAPABILITIES**](/previous-versions/windows/desktop/legacy/bb173062(v=vs.85)) to fill that number of elements in the **GammaCurve** array.</span></span> <span data-ttu-id="13843-202">您放在 **GammaCurve** 陣列中的每個元素都是每個控制點的高度。</span><span class="sxs-lookup"><span data-stu-id="13843-202">Each element that you place in the **GammaCurve** array is the height for each control point.</span></span>

<span data-ttu-id="13843-203">請注意，在上圖中，您現在可以控制每個控制點的垂直位置，而且您有紅色、綠色和藍色的個別控制項。</span><span class="sxs-lookup"><span data-stu-id="13843-203">Notice in the preceding graph that you now have control over the vertical placement of each control point, and you have separate control for red, green and blue.</span></span> <span data-ttu-id="13843-204">例如，您可以將所有綠色和藍色值設定為零，並將紅色值設定為從零到一的遞增樓梯。</span><span class="sxs-lookup"><span data-stu-id="13843-204">For example, you can set all of the green and blue values to zero and set the red values to an ascending staircase from zero to one.</span></span> <span data-ttu-id="13843-205">在此案例中，顯示的影像只會顯示其紅色部分，藍色和綠色會顯示為黑色。</span><span class="sxs-lookup"><span data-stu-id="13843-205">In this scenario, the displayed image shows only its red parts, with the blue and green appearing as black.</span></span> <span data-ttu-id="13843-206">您也可以為所有色彩設定遞減的樓梯，以產生反向顯示。</span><span class="sxs-lookup"><span data-stu-id="13843-206">You can also set a descending staircase for all colors, which results in an inverted display.</span></span> <span data-ttu-id="13843-207">您放在 **GammaCurve** 陣列中的任何值，都必須在您從 **MinConvertedValue** 和 **MaxConvertedValue** 的 [**DXGI \_ GAMMA \_ 控制項 \_ 功能**](/previous-versions/windows/desktop/legacy/bb173062(v=vs.85))的成員中取得的值內。</span><span class="sxs-lookup"><span data-stu-id="13843-207">Any value you place in the **GammaCurve** array must be inclusively within the values you obtained from the **MinConvertedValue** and **MaxConvertedValue** members of [**DXGI\_GAMMA\_CONTROL\_CAPABILITIES**](/previous-versions/windows/desktop/legacy/bb173062(v=vs.85)).</span></span>

## <a name="gamma-control-practicalities"></a><span data-ttu-id="13843-208">Gamma 控制項 practicalities</span><span class="sxs-lookup"><span data-stu-id="13843-208">Gamma control practicalities</span></span>

<span data-ttu-id="13843-209">只有當應用程式是全螢幕時，才適用 DXGI 的 gamma 控制項。</span><span class="sxs-lookup"><span data-stu-id="13843-209">DXGI’s gamma controls apply only as long as the app is full screen.</span></span> <span data-ttu-id="13843-210">當應用程式結束或返回視窗模式時，Windows 會還原顯示的先前狀態。</span><span class="sxs-lookup"><span data-stu-id="13843-210">Windows restores the previous state of the display when the app exits or returns to windowed mode.</span></span> <span data-ttu-id="13843-211">但是，如果應用程式重新進入全螢幕模式，則 Windows 不會還原您的應用程式 gamma 狀態。</span><span class="sxs-lookup"><span data-stu-id="13843-211">But Windows doesn’t restore your app’s gamma state if the app re-enters full-screen mode.</span></span> <span data-ttu-id="13843-212">當您的應用程式重新進入全螢幕模式時，必須明確地還原其 gamma 狀態。</span><span class="sxs-lookup"><span data-stu-id="13843-212">Your app must explicitly restore its gamma state when it re-enters full-screen mode.</span></span>

<span data-ttu-id="13843-213">並非所有的介面卡都支援 gamma 控制項。</span><span class="sxs-lookup"><span data-stu-id="13843-213">Not all adapters support gamma control.</span></span> <span data-ttu-id="13843-214">如果介面卡不支援 gamma 控制項，則會忽略呼叫來設定 gamma 的斜坡。</span><span class="sxs-lookup"><span data-stu-id="13843-214">If an adapter doesn't support gamma control, it ignores calls to set a gamma ramp.</span></span>

<span data-ttu-id="13843-215">在遠端桌面執行的應用程式無法完全控制 gamma。</span><span class="sxs-lookup"><span data-stu-id="13843-215">Apps that run under remote desktop can't control gamma at all.</span></span>

<span data-ttu-id="13843-216">如果滑鼠游標在硬體 (中實作為大部分的) ，則通常不會回應 gamma 設定。</span><span class="sxs-lookup"><span data-stu-id="13843-216">The mouse cursor, if it is implemented in hardware (as most are), typically doesn't respond to the gamma setting.</span></span>

## <a name="related-topics"></a><span data-ttu-id="13843-217">相關主題</span><span class="sxs-lookup"><span data-stu-id="13843-217">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="13843-218">DXGI 的程式設計指南</span><span class="sxs-lookup"><span data-stu-id="13843-218">Programming Guide for DXGI</span></span>](dx-graphics-dxgi-overviews.md)
</dt> </dl>

 

 
