---
title: DirectWrite 程式設計指南
description: 下列主題提供 DirectWrite API 的總覽。
ms.assetid: ca80d130-0579-409f-9054-6e63af14ebe3
keywords:
- DirectWrite，關於
- DirectWrite，程式設計手冊
- DirectWrite 程式設計指南
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 3d1003b18dda9bf91c254f3463cb424b9c05764c
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/20/2020
ms.locfileid: "104024018"
---
# <a name="directwrite-programming-guide"></a><span data-ttu-id="00c1b-106">DirectWrite 程式設計指南</span><span class="sxs-lookup"><span data-stu-id="00c1b-106">DirectWrite programming guide</span></span>

<span data-ttu-id="00c1b-107">下列主題提供 [DirectWrite](direct-write-portal.md) API 的總覽。</span><span class="sxs-lookup"><span data-stu-id="00c1b-107">The following topics provide an overview of the [DirectWrite](direct-write-portal.md) API.</span></span>

## <a name="in-this-section"></a><span data-ttu-id="00c1b-108">本節內容</span><span class="sxs-lookup"><span data-stu-id="00c1b-108">In this section</span></span>



| <span data-ttu-id="00c1b-109">主題</span><span class="sxs-lookup"><span data-stu-id="00c1b-109">Topic</span></span>                                                                                         | <span data-ttu-id="00c1b-110">描述</span><span class="sxs-lookup"><span data-stu-id="00c1b-110">Description</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|-----------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="00c1b-111">DirectWrite 簡介</span><span class="sxs-lookup"><span data-stu-id="00c1b-111">Introducing DirectWrite</span></span>](introducing-directwrite.md)<br/>                             |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| [<span data-ttu-id="00c1b-112">教學課程：使用 DirectWrite 開始使用</span><span class="sxs-lookup"><span data-stu-id="00c1b-112">Tutorial: Getting Started with DirectWrite</span></span>](getting-started-with-directwrite.md)<br/> | <span data-ttu-id="00c1b-113">本檔將說明如何使用 [DirectWrite](direct-write-portal.md) 和 [Direct2D](rendering-by-using-direct2d.md) 來建立包含單一格式的簡單文字，以及包含多個格式的文字。</span><span class="sxs-lookup"><span data-stu-id="00c1b-113">This document shows you how to use [DirectWrite](direct-write-portal.md) and [Direct2D](rendering-by-using-direct2d.md) to create simple text that contains a single format, and then text that contains multiple formats.</span></span> <br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| [<span data-ttu-id="00c1b-114">文字格式設定和版面配置</span><span class="sxs-lookup"><span data-stu-id="00c1b-114">Text Formatting and Layout</span></span>](text-formatting-and-layout.md)<br/>                       | <span data-ttu-id="00c1b-115">[DirectWrite](direct-write-portal.md) 提供兩種用於格式化文字的介面： [**IDWriteTextFormat**](/windows/win32/api/dwrite/nn-dwrite-idwritetextformat) 和 [**IDWriteTextLayout**](/windows/win32/api/dwrite/nn-dwrite-idwritetextlayout)。</span><span class="sxs-lookup"><span data-stu-id="00c1b-115">[DirectWrite](direct-write-portal.md) provides two interfaces for formatting text: [**IDWriteTextFormat**](/windows/win32/api/dwrite/nn-dwrite-idwritetextformat) and [**IDWriteTextLayout**](/windows/win32/api/dwrite/nn-dwrite-idwritetextlayout).</span></span> <span data-ttu-id="00c1b-116">**IDWriteTextFormat** 只會解說文字的格式，而且在整個字串是相同的字型大小、樣式、粗細等情況下使用。</span><span class="sxs-lookup"><span data-stu-id="00c1b-116">**IDWriteTextFormat** describes only the format for text and is used in cases when an entire string is to be the same font size, style, weight and so on.</span></span> <span data-ttu-id="00c1b-117">另一方面， **IDWriteTextLayout** 會同時封裝文字字串和指定範圍的字串格式。</span><span class="sxs-lookup"><span data-stu-id="00c1b-117">On the other hand, **IDWriteTextLayout** encapsulates both a text string and the formatting for specified ranges of the string.</span></span> <span data-ttu-id="00c1b-118">本檔將說明每個介面及其用途。</span><span class="sxs-lookup"><span data-stu-id="00c1b-118">This document describes each interface and their uses.</span></span> <span data-ttu-id="00c1b-119">如需這些介面的建立和方法的詳細資訊，請參閱 [**IDWriteTextFormat**](/windows/win32/api/dwrite/nn-dwrite-idwritetextformat) 和 [**IDWriteTextLayout**](/windows/win32/api/dwrite/nn-dwrite-idwritetextlayout) 參考頁面。</span><span class="sxs-lookup"><span data-stu-id="00c1b-119">For more information about the creation and methods of these interfaces, see the [**IDWriteTextFormat**](/windows/win32/api/dwrite/nn-dwrite-idwritetextformat) and [**IDWriteTextLayout**](/windows/win32/api/dwrite/nn-dwrite-idwritetextlayout) reference pages.</span></span><br/> |
| [<span data-ttu-id="00c1b-120">理由、字偶間距和間距</span><span class="sxs-lookup"><span data-stu-id="00c1b-120">Justification, Kerning, and Spacing</span></span>](justification--kerning--and-spacing.md)<br/>     | <span data-ttu-id="00c1b-121">從 Windows 8 開始， [DirectWrite](direct-write-portal.md) 提供了一些功能，可讓您控制基本的印刷樣式、配置和間距功能，例如字元間距、配對的間距和對齊方式。</span><span class="sxs-lookup"><span data-stu-id="00c1b-121">Starting with Windows 8, [DirectWrite](direct-write-portal.md) provides a number of features that allow you to control basic typographic, layout, and spacing features, such as character spacing, pair kerning, and justification.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| [<span data-ttu-id="00c1b-122">垂直文字</span><span class="sxs-lookup"><span data-stu-id="00c1b-122">Vertical Text</span></span>](vertical-text.md)<br/>                                                 | <span data-ttu-id="00c1b-123">從 Windows 8 開始， [DirectWrite](direct-write-portal.md) 有一些新的 api，可讓您在應用程式中使用垂直文字。</span><span class="sxs-lookup"><span data-stu-id="00c1b-123">Starting with the Windows 8, [DirectWrite](direct-write-portal.md) has a number of new APIs that allow you to use vertical text in your apps.</span></span> <br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| [<span data-ttu-id="00c1b-124">效能</span><span class="sxs-lookup"><span data-stu-id="00c1b-124">Performance</span></span>](performance.md)<br/>                                                     | <span data-ttu-id="00c1b-125">[DirectWrite](direct-write-portal.md)的效能主要取決於您呈現它的方式。</span><span class="sxs-lookup"><span data-stu-id="00c1b-125">Performance for [DirectWrite](direct-write-portal.md) depends largely on how you render it.</span></span> <span data-ttu-id="00c1b-126">See the [Improving the performance of Direct2D apps](../direct2d/improving-direct2d-performance.md) topic for info on rendering performance with [Direct2D](rendering-by-using-direct2d.md).</span><span class="sxs-lookup"><span data-stu-id="00c1b-126">See the [Improving the performance of Direct2D apps](../direct2d/improving-direct2d-performance.md) topic for info on rendering performance with [Direct2D](rendering-by-using-direct2d.md).</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| [<span data-ttu-id="00c1b-127">文字度量</span><span class="sxs-lookup"><span data-stu-id="00c1b-127">Text Metrics</span></span>](text-metrics.md)<br/>                                                   | <span data-ttu-id="00c1b-128">為了協助您的版面配置、自訂字型選取，以及其他需要大量計量的作業，從 Windows 8 開始， [DirectWrite](direct-write-portal.md) 有許多新的 api，可表達您開發 rich text 應用程式時可能需要的字型相關資訊。</span><span class="sxs-lookup"><span data-stu-id="00c1b-128">In order to assist your layout, custom font selection, and other metric intensive operations, starting in Windows 8, [DirectWrite](direct-write-portal.md) has a number of new APIs to express all the info about fonts that you might require to develop rich text apps.</span></span> <br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| [<span data-ttu-id="00c1b-129">色彩字型</span><span class="sxs-lookup"><span data-stu-id="00c1b-129">Color Fonts</span></span>](color-fonts.md)<br/>                                                     | <span data-ttu-id="00c1b-130">本主題說明色彩字型、其在 DirectWrite 和 Direct2D 方面的支援，以及如何在您的應用程式中使用它們。</span><span class="sxs-lookup"><span data-stu-id="00c1b-130">This topic describes color fonts, their support in DirectWrite and Direct2D, and how to use them in your app.</span></span> <br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| [<span data-ttu-id="00c1b-131">轉譯 DirectWrite</span><span class="sxs-lookup"><span data-stu-id="00c1b-131">Rendering DirectWrite</span></span>](rendering-directwrite.md)<br/>                                 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| [<span data-ttu-id="00c1b-132">操作說明主題</span><span class="sxs-lookup"><span data-stu-id="00c1b-132">How-to Topics</span></span>](how-to-topics.md)<br/>                                                 | <span data-ttu-id="00c1b-133">下列主題提供 [DirectWrite](direct-write-portal.md) API 的總覽。</span><span class="sxs-lookup"><span data-stu-id="00c1b-133">The following topics provide an overview of the [DirectWrite](direct-write-portal.md) API.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| [<span data-ttu-id="00c1b-134">字元和圖像執行</span><span class="sxs-lookup"><span data-stu-id="00c1b-134">Glyphs and Glyph Runs</span></span>](glyphs-and-glyph-runs.md)<br/>                                 | <span data-ttu-id="00c1b-135">圖像和圖像執行可在 [DirectWrite](direct-write-portal.md) API 的最底層功能（圖像呈現層）上取得。</span><span class="sxs-lookup"><span data-stu-id="00c1b-135">Glyphs and glyph runs are available at the lowest layer of functionality of the [DirectWrite](direct-write-portal.md) API, the glyph-rendering layer.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| [<span data-ttu-id="00c1b-136">自訂字型集</span><span class="sxs-lookup"><span data-stu-id="00c1b-136">Custom Font Sets</span></span>](custom-font-sets-win10.md)<br/>                                     | <span data-ttu-id="00c1b-137">本主題說明您可以在應用程式中使用自訂字型的各種方式。</span><span class="sxs-lookup"><span data-stu-id="00c1b-137">This topic describes various ways in which you can use custom fonts in your app.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| [<span data-ttu-id="00c1b-138"> (Windows 7/8) 的自訂字型集合 </span><span class="sxs-lookup"><span data-stu-id="00c1b-138">Custom Font Collections (Windows 7/8)</span></span>](custom-font-collections.md)<br/>               | <span data-ttu-id="00c1b-139">[DirectWrite](direct-write-portal.md) 會使用 [**IDWriteFactory：： GetSystemFontCollection**](/windows/win32/api/dwrite/nf-dwrite-idwritefactory-getsystemfontcollection) 方法，提供系統字型集合的存取權。</span><span class="sxs-lookup"><span data-stu-id="00c1b-139">[DirectWrite](direct-write-portal.md) provides access to the system font collection by using the [**IDWriteFactory::GetSystemFontCollection**](/windows/win32/api/dwrite/nf-dwrite-idwritefactory-getsystemfontcollection) method.</span></span> <span data-ttu-id="00c1b-140">這是最常使用的字型集合。</span><span class="sxs-lookup"><span data-stu-id="00c1b-140">This is the font collection that is most frequently used.</span></span> <span data-ttu-id="00c1b-141">不過，有些應用程式必須使用系統上未安裝的字型，例如從包含的字型檔案或內嵌于應用程式中的字型檔案。</span><span class="sxs-lookup"><span data-stu-id="00c1b-141">However some applications have to use fonts that are not installed on the system, such as from included font files or font files embedded in the application.</span></span> <br/> <span data-ttu-id="00c1b-142">如果您想要的字型不在系統字型集合中，您可以建立衍生自 [**IDWriteFontCollection**](/windows/win32/api/dwrite/nn-dwrite-idwritefontcollection)的自訂字型集合。</span><span class="sxs-lookup"><span data-stu-id="00c1b-142">If the fonts that you want are not in the system font collection, you can create a custom font collection derived from [**IDWriteFontCollection**](/windows/win32/api/dwrite/nn-dwrite-idwritefontcollection).</span></span> <br/>                                                                                                                     |
| [<span data-ttu-id="00c1b-143">OpenType 變數字型</span><span class="sxs-lookup"><span data-stu-id="00c1b-143">OpenType Variable Fonts</span></span>](opentype-variable-fonts.md)<br/>                             | <span data-ttu-id="00c1b-144">本主題說明 OpenType 變數字型、其在 DirectWrite 和 Direct2D 中的支援，以及如何在您的應用程式中使用它們。</span><span class="sxs-lookup"><span data-stu-id="00c1b-144">This topic describes OpenType variable fonts, their support in DirectWrite and Direct2D, and how to use them in your app.</span></span> <br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| [<span data-ttu-id="00c1b-145">Win32 文字 API 比較</span><span class="sxs-lookup"><span data-stu-id="00c1b-145">Win32 Text API Comparison</span></span>](appendix--win32-migration.md)<br/>                         | <span data-ttu-id="00c1b-146">針對正在遷移其 Win32 應用程式程式碼的開發人員，下表列出 DirectWrite 中的 Win32 文字 Api 和近似的相等專案。</span><span class="sxs-lookup"><span data-stu-id="00c1b-146">For those developers that are migrating their Win32 application code, the following table lists the Win32 Text APIs and the approximate equivalent in DirectWrite.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| [<span data-ttu-id="00c1b-147">與 GDI 交互操作</span><span class="sxs-lookup"><span data-stu-id="00c1b-147">Interoperating with GDI</span></span>](interoperating-with-gdi.md)<br/>                             | <span data-ttu-id="00c1b-148">[DirectWrite](direct-write-portal.md) 會提供的遷移路徑，以及與 GDI 的字型模型之間的互通性，以及將文字轉譯成可在視窗上繪製之點陣圖的介面。</span><span class="sxs-lookup"><span data-stu-id="00c1b-148">[DirectWrite](direct-write-portal.md) provides a migration path from, and some interoperability with, GDI's font model, as well as interfaces for rendering text to a bitmap that can then be drawn on a window.</span></span> <br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| [<span data-ttu-id="00c1b-149">DirectWrite 詞彙</span><span class="sxs-lookup"><span data-stu-id="00c1b-149">DirectWrite Glossary</span></span>](directwrite-glossary.md)<br/>                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |



 

 

