---
title: Win32 文字 API 比較
description: 針對正在遷移其 Win32 應用程式程式碼的開發人員，下表列出 DirectWrite 中的 Win32 文字 Api 和近似的相等專案。
ms.assetid: c679e31a-3825-4f59-9c5e-9cf770e1f237
keywords:
- DirectWrite，Win32 文字 Api
- Win32 文字 Api
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 1da7f95e0de6edef50f93c4a36a9b069d3b2abae
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/20/2020
ms.locfileid: "104375936"
---
# <a name="win32-text-api-comparison"></a>Win32 文字 API 比較

針對正在遷移其 Win32 應用程式程式碼的開發人員，下表列出 DirectWrite 中的 Win32 文字 Api 和近似的相等專案。



| GDI 文字呼叫                                             | Description                                                                                                           | DirectWrite 對等專案                                                                                                                                                                                                                                                                                                                                              |
|------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [**AddFontMemResourceEx**](/windows/win32/api/wingdi/nf-wingdi-addfontmemresourceex)       | 將內嵌字型加入至系統字型表格。                                                                       | [**CreateCustomFontFileReference**](/windows/win32/api/dwrite/nf-dwrite-idwritefactory-createcustomfontfilereference)  + [ **CreateCustomFontCollection**](/windows/win32/api/dwrite/nf-dwrite-idwritefactory-createcustomfontcollection)                                                                                                                                                                                             |
| [**AddFontResource**](/windows/win32/api/wingdi/nf-wingdi-addfontresourcea)                 | 將字型資源新增至系統字型表格。                                                                        | 沒有對等專案。 [**AddFontResource**](/windows/win32/api/wingdi/nf-wingdi-addfontresourcea) 會將新增至系統字型集合，做為 GDI 字型安裝步驟的一部分。 DirectWrite 會預先填入系統字型集合，並自動監視其更新，因此不需要安裝。                                                                              |
| [**AddFontResourceEx**](/windows/win32/api/wingdi/nf-wingdi-addfontresourceexa)             | 將私用或不可列舉的字型新增至系統字型表格。                                                       | 同上                                                                                                                                                                                                                                                                                                                                                       |
| [**CreateFont**](/windows/win32/api/wingdi/nf-wingdi-createfonta)                           | 建立邏輯字型。                                                                                               | 應用程式不會使用邏輯字型來指定一組字型屬性 (例如，系列名稱、權數、樣式、延展和大小) 來建立 [**IDWriteTextFormat**](/windows/win32/api/dwrite/nn-dwrite-idwritetextformat)。 只有要求字型列舉的應用程式會透過 [**IDWriteFontCollection**](/windows/win32/api/dwrite/nn-dwrite-idwritefontcollection)存取 [**IDWriteFont**](/windows/win32/api/dwrite/nn-dwrite-idwritefont) 。 |
| [**CreateFontIndirect**](/windows/win32/api/wingdi/nf-wingdi-createfontindirecta)           | 從結構建立邏輯字型。                                                                              | 同上                                                                                                                                                                                                                                                                                                                                                       |
| [**CreateFontIndirectEx**](/windows/win32/api/wingdi/nf-wingdi-createfontindirectexa)       | 從結構建立邏輯字型。                                                                              | 同上                                                                                                                                                                                                                                                                                                                                                       |
| [**DrawText**](/windows/win32/api/winuser/nf-winuser-drawtext)                               | 在矩形中繪製格式化的文字。                                                                                  | [**IDWriteTextLayout：:D 原始**](/windows/win32/api/dwrite/nf-dwrite-idwritetextlayout-draw)                                                                                                                                                                                                                                                                                                           |
| [**DrawTextEx**](/windows/win32/api/winuser/nf-winuser-drawtextexa)                           | 在矩形中繪製格式化的文字。                                                                                  | [**IDWriteTextLayout：:D 原始**](/windows/win32/api/dwrite/nf-dwrite-idwritetextlayout-draw)                                                                                                                                                                                                                                                                                                           |
| [**EnumFontFamExProc**](/previous-versions//dd162618(v=vs.85))             | 應用程式定義的回呼函式，與 [**EnumFontFamiliesEx**](/windows/win32/api/wingdi/nf-wingdi-enumfontfamiliesexa) 搭配使用以處理字型。 | [**IDWriteFontCollection**](/windows/win32/api/dwrite/nn-dwrite-idwritefontcollection)介面，透過 [ **IDWriteFactory：： GetSystemFontCollection**](/windows/win32/api/dwrite/nf-dwrite-idwritefactory-getsystemfontcollection)                                                                                                                                                                                                 |
| [**EnumFontFamiliesEx**](/windows/win32/api/wingdi/nf-wingdi-enumfontfamiliesexa)           | 使用特定特性列舉系統中的所有字型。                                                      | [**IDWriteFontCollection**](/windows/win32/api/dwrite/nn-dwrite-idwritefontcollection)介面，透過 [ **IDWriteFactory：： GetSystemFontCollection**](/windows/win32/api/dwrite/nf-dwrite-idwritefactory-getsystemfontcollection)                                                                                                                                                                                                 |
| [**ExtTextOut**](/windows/win32/api/wingdi/nf-wingdi-exttextouta)                           | 繪製字元字串。                                                                                             | [**IDWriteTextLayout：:D raw**](/windows/win32/api/dwrite/nf-dwrite-idwritetextlayout-draw)或 [ **IDWriteRenderBitmapTarget：:D rawglyphrun**](/windows/win32/api/dwrite/nf-dwrite-idwritebitmaprendertarget-drawglyphrun)                                                                                                                                                                                                              |
| [**GetAspectRatioFilterEx**](/windows/win32/api/wingdi/nf-wingdi-getaspectratiofilterex)   | 取得外觀比例篩選的設定。                                                                         | N/A                                                                                                                                                                                                                                                                                                                                                                 |
| [**GetCharABCWidths**](/windows/win32/api/wingdi/nf-wingdi-getcharabcwidthsa)               | 取得 TrueType 字型中連續字元的寬度。                                                     | [**IDWriteFontFace::GetDesignGlyphMetrics**](/windows/win32/api/dwrite/nf-dwrite-idwritefontface-getdesignglyphmetrics)                                                                                                                                                                                                                                                                             |
| [**GetCharABCWidthsFloat**](/windows/win32/api/wingdi/nf-wingdi-getcharabcwidthsfloata)     | 從目前的字型取得連續字元的寬度。                                                      | [**IDWriteFontFace::GetDesignGlyphMetrics**](/windows/win32/api/dwrite/nf-dwrite-idwritefontface-getdesignglyphmetrics)                                                                                                                                                                                                                                                                             |
| [**GetCharABCWidthsI**](/windows/win32/api/wingdi/nf-wingdi-getcharabcwidthsi)             | 從 TrueType 字型取得連續圖像索引或圖像索引陣列的寬度。                     | [**IDWriteFontFace::GetDesignGlyphMetrics**](/windows/win32/api/dwrite/nf-dwrite-idwritefontface-getdesignglyphmetrics)                                                                                                                                                                                                                                                                             |
| [**GetCharacterPlacement**](/windows/win32/api/wingdi/nf-wingdi-getcharacterplacementa)     | 取得字元字串的相關資訊。                                                                            | [**IDWriteTextAnalyzer**](/windows/win32/api/dwrite/nn-dwrite-idwritetextanalyzer)                                                                                                                                                                                                                                                                                                                  |
| [**GetCharWidth32**](/windows/win32/api/wingdi/nf-wingdi-getcharwidth32a)                   | 從目前的字型取得連續字元的寬度。                                                      | [**IDWriteFontFace：： GetDesignGlyphMetrics**](/windows/win32/api/dwrite/nf-dwrite-idwritefontface-getdesignglyphmetrics)或 [ **IDWriteTextLayout：： GetMetrics**](/windows/win32/api/dwrite/nf-dwrite-idwritetextlayout-getmetrics)                                                                                                                                                                                                    |
| [**GetCharWidthFloat**](/windows/win32/api/wingdi/nf-wingdi-getcharwidthfloata)             | 從目前的字型取得連續字元的小數寬度。                                           | [**IDWriteFontFace：： GetDesignGlyphMetrics**](/windows/win32/api/dwrite/nf-dwrite-idwritefontface-getdesignglyphmetrics)或 [ **IDWriteTextLayout：： GetMetrics**](/windows/win32/api/dwrite/nf-dwrite-idwritetextlayout-getmetrics)                                                                                                                                                                                                    |
| [**GetCharWidthI**](/windows/win32/api/wingdi/nf-wingdi-getcharwidthi)                     | 從目前的字型取得連續圖像索引或圖像索引陣列的寬度。                      | [**IDWriteFontFace：： GetDesignGlyphMetrics**](/windows/win32/api/dwrite/nf-dwrite-idwritefontface-getdesignglyphmetrics)或 [ **IDWriteTextLayout：： GetMetrics**](/windows/win32/api/dwrite/nf-dwrite-idwritetextlayout-getmetrics)                                                                                                                                                                                                    |
| [**GetFontData**](/windows/win32/api/wingdi/nf-wingdi-getfontdata)                         | 取得 TrueType 字型的度量資料。                                                                                 | [**IDWriteFontFace::TryGetFontTable**](/windows/win32/api/dwrite/nf-dwrite-idwritefontface-trygetfonttable)                                                                                                                                                                                                                                                                                         |
| [**GetFontLanguageInfo**](/windows/win32/api/wingdi/nf-wingdi-getfontlanguageinfo)         | 傳回所選字型的顯示內容相關資訊。                                                    | N/A                                                                                                                                                                                                                                                                                                                                                                 |
| [**GetFontUnicodeRanges**](/windows/win32/api/wingdi/nf-wingdi-getfontunicoderanges)       | 告知字型支援哪些 Unicode 字元。                                                               | [ **IDWriteFont：： HasCharacter** 的迴圈](/windows/win32/api/dwrite/nf-dwrite-idwritefont-hascharacter)                                                                                                                                                                                                                                                                                               |
| [**GetGlyphIndices**](/windows/win32/api/wingdi/nf-wingdi-getglyphindicesa)                 | 將字串轉譯成圖像索引的陣列。                                                                   | [**IDWriteFontFace::GetGlyphIndices**](/windows/win32/api/dwrite/nf-dwrite-idwritefontface-getglyphindices)                                                                                                                                                                                                                                                                                         |
| [**GetGlyphOutline**](/windows/win32/api/wingdi/nf-wingdi-getglyphoutlinea)                 | 取得 TrueType 字型中字元的大綱或點陣圖。                                                      | 字元度量-- [**IDWriteFontFace：： GetDesignGlyphMetrics**](/windows/win32/api/dwrite/nf-dwrite-idwritefontface-getdesignglyphmetrics)，實際大綱資訊--[**IDWriteFontFace：： GetGlyphRunOutline**](/windows/win32/api/dwrite/nf-dwrite-idwritefontface-getglyphrunoutline)，如果您想要字元點陣圖， [**IDWriteRenderBitmapRenderTarget：:D rawglyphrun**](/windows/win32/api/dwrite/nf-dwrite-idwritebitmaprendertarget-drawglyphrun)                |
| [**GetKerningPairs**](/windows/win32/api/wingdi/nf-wingdi-getkerningpairsa)                 | 取得字型的字元間距配對。                                                                          | 透過配置 (DirectWrite 的印刷樣式屬性允許的字偶間距調整本身會自動調整，因此沒有方法可將這項資訊) 。                                                                                                                                                                                                                       |
| [**GetOutlineTextMetrics**](/windows/win32/api/wingdi/nf-wingdi-getoutlinetextmetricsa)     | 取得 TrueType 字型的文字度量。                                                                                 | [**IDWriteFontFace::GetMetrics**](/windows/win32/api/dwrite/nf-dwrite-idwritefont-getmetrics)                                                                                                                                                                                                                                                                                                       |
| [**GetRasterizerCaps**](/windows/win32/api/wingdi/nf-wingdi-getrasterizercaps)             | 指出是否已安裝 TrueType 字型。                                                                           | 預設會在 Windows Vista 和 Windows 7 上安裝 (TrueType 字型。 )                                                                                                                                                                                                                                                                                            |
| [**GetTabbedTextExtent**](/windows/win32/api/winuser/nf-winuser-gettabbedtextextenta)         | 計算字元字串的寬度和高度，包括索引標籤。                                                  | [**IDWriteTextLayout::GetMetrics**](/windows/win32/api/dwrite/nf-dwrite-idwritetextlayout-getmetrics)                                                                                                                                                                                                                                                                                               |
| [**GetTextAlign**](/windows/win32/api/wingdi/nf-wingdi-gettextalign)                       | 取得裝置內容的文字對齊設定。                                                                 | [**IDWriteTextFormat::GetTextAlignment**](/windows/win32/api/dwrite/nf-dwrite-idwritetextformat-gettextalignment)                                                                                                                                                                                                                                                                                   |
| [**GetTextCharacterExtra**](/windows/win32/api/wingdi/nf-wingdi-gettextcharacterextra)     | 取得裝置內容的目前字元間距。                                                        | N/A                                                                                                                                                                                                                                                                                                                                                                 |
| [**GetTextColor**](/windows/win32/api/wingdi/nf-wingdi-gettextcolor)                       | 取得裝置內容的文字色彩。                                                                             | N/A。  (DirectWrite 與轉譯無關，因此不知道色彩。 應用程式需要追蹤本身。 )                                                                                                                                                                                                                                  |
| [**GetTextExtentExPoint**](/windows/win32/api/wingdi/nf-wingdi-gettextextentexpointa)       | 取得字串中將符合空格的字元數。                                               | [**IDWriteTextLayout::GetMetrics**](/windows/win32/api/dwrite/nf-dwrite-idwritetextlayout-getmetrics)                                                                                                                                                                                                                                                                                               |
| [**GetTextExtentExPointI**](/windows/win32/api/wingdi/nf-wingdi-gettextextentexpointi)     | 取得可容納在空間內的圖像索引數目。                                                        | [**IDWriteTextLayout::GetMetrics**](/windows/win32/api/dwrite/nf-dwrite-idwritetextlayout-getmetrics)                                                                                                                                                                                                                                                                                               |
| [**GetTextExtentPoint32**](/windows/win32/api/wingdi/nf-wingdi-gettextextentpoint32a)       | 計算文字字串的寬度和高度。                                                                    | [**IDWriteTextLayout::GetMetrics**](/windows/win32/api/dwrite/nf-dwrite-idwritetextlayout-getmetrics)                                                                                                                                                                                                                                                                                               |
| [**GetTextExtentPointI**](/windows/win32/api/wingdi/nf-wingdi-gettextextentpointi)         | 計算圖像索引陣列的寬度和高度。                                                           | [**IDWriteTextLayout::GetMetrics**](/windows/win32/api/dwrite/nf-dwrite-idwritetextlayout-getmetrics)                                                                                                                                                                                                                                                                                               |
| [**GetTextFace**](/windows/win32/api/wingdi/nf-wingdi-gettextfacea)                         | 取得在裝置內容中選取之字型的名稱。                                                     | [**IDWriteFont：： GetFaceNames**](/windows/win32/api/dwrite/nf-dwrite-idwritefont-getfacenames) (會傳回所有名稱)                                                                                                                                                                                                                                                                             |
| [**GetTextMetrics**](/windows/win32/api/wingdi/nf-wingdi-gettextmetrics)                   | 使用字型的度量來填滿緩衝區。                                                                           | [**IDWriteFontFace::GetMetrics**](/windows/win32/api/dwrite/nf-dwrite-idwritefontface-getmetrics)                                                                                                                                                                                                                                                                                                   |
| [**PolyTextOut**](/windows/win32/api/wingdi/nf-wingdi-polytextouta)                         | 使用裝置內容中的字型和文字色彩來繪製數個字串。                                             | N/A;建立數個版面設定物件                                                                                                                                                                                                                                                                                                                                  |
| [**RemoveFontMemResourceEx**](/windows/win32/api/wingdi/nf-wingdi-removefontmemresourceex) | 移除從系統字型資料表內嵌于檔中的字型。                                    | 關聯物件上的 [**IUnknown：： Release**](/windows/win32/api/unknwn/nf-unknwn-iunknown-release)                                                                                                                                                                                                                                                                              |
| [**RemoveFontResource**](/windows/win32/api/wingdi/nf-wingdi-removefontresourcea)           | 從系統字型表移除檔案中的字型                                                                | N/A                                                                                                                                                                                                                                                                                                                                                                 |
| [**RemoveFontResourceEx**](/windows/win32/api/wingdi/nf-wingdi-removefontresourceexa)       | 從系統字型表移除私用或不可列舉的字型。                                                  | N/A                                                                                                                                                                                                                                                                                                                                                                 |
| [**SetMapperFlags**](/windows/win32/api/wingdi/nf-wingdi-setmapperflags)                   | 改變用來將邏輯字型對應到實體字型的演算法。                                                     | N/A                                                                                                                                                                                                                                                                                                                                                                 |
| [**SetTextAlign**](/windows/win32/api/wingdi/nf-wingdi-settextalign)                       | 設定裝置內容的文字對齊旗標。                                                                   | [**IDWriteTextFormat::SetTextAlignment**](/windows/win32/api/dwrite/nf-dwrite-idwritetextformat-settextalignment)                                                                                                                                                                                                                                                                                   |
| [**SetTextCharacterExtra**](/windows/win32/api/wingdi/nf-wingdi-settextcharacterextra)     | 設定字元間距。                                                                                     | N/A                                                                                                                                                                                                                                                                                                                                                                 |
| [**SetTextColor**](/windows/win32/api/wingdi/nf-wingdi-settextcolor)                       | 設定裝置內容的文字色彩。                                                                             | 應用程式必須負責指定其中一個 [**繪製**](/windows/win32/api/dwrite/nf-dwrite-idwriteinlineobject-draw) 呼叫中的色彩。                                                                                                                                                                                                                                       |
| [**SetTextJustification**](/windows/win32/api/wingdi/nf-wingdi-settextjustification)       | 指定系統應新增至字串中之 break 字元的空間量。                              | N/A。 此版本不支援理由和字元間距。                                                                                                                                                                                                                                                                                         |
| [**TabbedTextOut**](/windows/win32/api/winuser/nf-winuser-tabbedtextouta)                     | 寫入位置的字元字串，將索引標籤展開為指定的值。                                          | [**IDWriteTextLayout：:D 原始**](/windows/win32/api/dwrite/nf-dwrite-idwritetextlayout-draw)                                                                                                                                                                                                                                                                                                           |
| [**TextOut**](/windows/win32/api/wingdi/nf-wingdi-textouta)                                 | 在位置寫入字元字串                                                                               | [**IDWriteTextLayout：:D 原始**](/windows/win32/api/dwrite/nf-dwrite-idwritetextlayout-draw)                                                                                                                                                                                                                                                                                                           |



 

 

 