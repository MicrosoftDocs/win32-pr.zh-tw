---
title: 理由、字偶間距和間距
description: 從 Windows 8 開始，DirectWrite 提供了一些功能，可讓您控制基本的印刷樣式、配置和間距功能，例如字元間距、配對的間距和對齊方式。
ms.assetid: A5397132-0806-4842-8B82-E17925FBBBA9
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 17cc915922d0dbadb45bf47f223df83a25414daf
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/20/2020
ms.locfileid: "103682990"
---
# <a name="justification-kerning-and-spacing"></a><span data-ttu-id="d5e26-103">理由、字偶間距和間距</span><span class="sxs-lookup"><span data-stu-id="d5e26-103">Justification, Kerning, and Spacing</span></span>

<span data-ttu-id="d5e26-104">從 Windows 8 開始， [DirectWrite](direct-write-portal.md) 提供了一些功能，可讓您控制基本的印刷樣式、配置和間距功能，例如字元間距、配對的間距和對齊方式。</span><span class="sxs-lookup"><span data-stu-id="d5e26-104">Starting with Windows 8, [DirectWrite](direct-write-portal.md) provides a number of features that allow you to control basic typographic, layout, and spacing features, such as character spacing, pair kerning, and justification.</span></span>

## <a name="character-spacing"></a><span data-ttu-id="d5e26-105">字元間距</span><span class="sxs-lookup"><span data-stu-id="d5e26-105">Character spacing</span></span>

<span data-ttu-id="d5e26-106">字元間距也稱為「追蹤」，這是執行文字中的字元之間的間距。</span><span class="sxs-lookup"><span data-stu-id="d5e26-106">Character spacing, also known as "tracking", is the spacing between characters in a run of text.</span></span>

<span data-ttu-id="d5e26-107">以下是追蹤的範例。</span><span class="sxs-lookup"><span data-stu-id="d5e26-107">Here is an example of tracking.</span></span> <span data-ttu-id="d5e26-108">第一行不會對文字套用任何追蹤。</span><span class="sxs-lookup"><span data-stu-id="d5e26-108">The first line applies no tracking to the text.</span></span> <span data-ttu-id="d5e26-109">第二行會增加字元間距，而第三行則會減少字元間距。</span><span class="sxs-lookup"><span data-stu-id="d5e26-109">The second line increases character spacing, and the third line decreases the character spacing.</span></span>

![相同文字的三個範例，沒有追蹤、更多間距及間距較少。](images/spacing.png)

<span data-ttu-id="d5e26-111">從 Windows 8 開始， [DirectWrite](direct-write-portal.md) 會在這裡新增這些方法，以控制文字中的字元間距。</span><span class="sxs-lookup"><span data-stu-id="d5e26-111">Starting with Windows 8, [DirectWrite](direct-write-portal.md) adds these methods here to control the spacing of characters in your text.</span></span>

<span data-ttu-id="d5e26-112">如果您使用 [DirectWrite](direct-write-portal.md) 版面配置，您可以針對此用途使用 [**IDWriteTextLayout1：： GetCharacterSpacing**](/windows/win32/api/dwrite_1/nf-dwrite_1-idwritetextlayout1-getcharacterspacing) 和 [**IDWriteTextLayout1：： SetCharacterSpacing**](/windows/win32/api/dwrite_1/nf-dwrite_1-idwritetextlayout1-setcharacterspacing) 方法。</span><span class="sxs-lookup"><span data-stu-id="d5e26-112">If you are using the [DirectWrite](direct-write-portal.md) layout, you can use the [**IDWriteTextLayout1::GetCharacterSpacing**](/windows/win32/api/dwrite_1/nf-dwrite_1-idwritetextlayout1-getcharacterspacing) and [**IDWriteTextLayout1::SetCharacterSpacing**](/windows/win32/api/dwrite_1/nf-dwrite_1-idwritetextlayout1-setcharacterspacing) methods for this purpose.</span></span>

<span data-ttu-id="d5e26-113">您可以使用 [**GetCharacterSpacing**](/windows/win32/api/dwrite_1/nf-dwrite_1-idwritetextlayout1-getcharacterspacing) 方法來判斷目前的字元間距，並傳回目前的字元、字元之前和之後的間距、最小的前進寬度，以及包含剩餘文字之開始位置與長度相關資訊的 [**DWRITE \_ 文字 \_ 範圍**](/windows/win32/api/dwrite/ns-dwrite-dwrite_text_range) 結構。</span><span class="sxs-lookup"><span data-stu-id="d5e26-113">Use the [**GetCharacterSpacing**](/windows/win32/api/dwrite_1/nf-dwrite_1-idwritetextlayout1-getcharacterspacing) method to determine the current character spacing and it returns the current character, the spacing before and after the character, the minimum advance width, and a [**DWRITE\_TEXT\_RANGE**](/windows/win32/api/dwrite/ns-dwrite-dwrite_text_range) structure that contains information about the starting position and length of the remaining text.</span></span>

<span data-ttu-id="d5e26-114">使用 [**DWriteTextLayout1**](/windows/win32/api/dwrite_1/nn-dwrite_1-idwritetextlayout1)介面上的 [**SetCharacterSpacing**](/windows/win32/api/dwrite_1/nf-dwrite_1-idwritetextlayout1-setcharacterspacing) ，將您自己的字元間距套用至版面配置中的文字。</span><span class="sxs-lookup"><span data-stu-id="d5e26-114">Use the [**SetCharacterSpacing**](/windows/win32/api/dwrite_1/nf-dwrite_1-idwritetextlayout1-setcharacterspacing) on a [**DWriteTextLayout1**](/windows/win32/api/dwrite_1/nn-dwrite_1-idwritetextlayout1) interface to apply your own character spacing to the text in the layout.</span></span> <span data-ttu-id="d5e26-115">**SetCharacterSpacing** 方法會採用您要在字元之前和之後的空間量、允許的最小預付，以及定義要套用間距之範圍的 [**DWRITE \_ 文字 \_ 範圍**](/windows/win32/api/dwrite/ns-dwrite-dwrite_text_range)。</span><span class="sxs-lookup"><span data-stu-id="d5e26-115">The **SetCharacterSpacing** method takes in the amount of space you want before and after the character, the minimum advance allowed, and a [**DWRITE\_TEXT\_RANGE**](/windows/win32/api/dwrite/ns-dwrite-dwrite_text_range) that defines the range to apply the spacing.</span></span>

<span data-ttu-id="d5e26-116">如果您使用自訂版面配置， [DirectWrite](direct-write-portal.md) 支援使用 [**IDWriteTextAnalyzer1：： ApplyCharacterSpacing**](/windows/win32/api/dwrite_1/nf-dwrite_1-idwritetextanalyzer1-applycharacterspacing)設定字元間距。</span><span class="sxs-lookup"><span data-stu-id="d5e26-116">If you are using a custom layout, [DirectWrite](direct-write-portal.md) has support for setting character spacing with [**IDWriteTextAnalyzer1::ApplyCharacterSpacing**](/windows/win32/api/dwrite_1/nf-dwrite_1-idwritetextanalyzer1-applycharacterspacing).</span></span> <span data-ttu-id="d5e26-117">如果您需要自訂文字版面配置，才能對版面配置進行先進的控制，請使用這個方法。</span><span class="sxs-lookup"><span data-stu-id="d5e26-117">Use this method if you require a custom text layout in order to have advanced control over your layout.</span></span> <span data-ttu-id="d5e26-118">這種方法可讓您提供 **ApplyCharacterSpacing** 的開頭和尾端間距、最小的前進寬度、叢集對應的長度、圖像數目、從字元範圍到字元的對應，以及在使用自訂版面配置時，每個圖像的前進寬度。</span><span class="sxs-lookup"><span data-stu-id="d5e26-118">This method allows you to provide **ApplyCharacterSpacing** with the leading and trailing spacing, minimum advance width, length of the cluster map, number of glyphs, mapping from character ranges to glyphs, and advance width of each glyph if you use a custom layout.</span></span> <span data-ttu-id="d5e26-119">方法會傳回修改過的圖像前進和 [**DWRITE 的圖像 \_ \_ 位移**](/windows/win32/api/dwrite/ns-dwrite-dwrite_glyph_offset) 列舉，以及每個字元原點的新位移。</span><span class="sxs-lookup"><span data-stu-id="d5e26-119">The method returns the modified glyph advances and a [**DWRITE\_GLYPH\_OFFSET**](/windows/win32/api/dwrite/ns-dwrite-dwrite_glyph_offset) enumeration with the new offsets to the origin of each glyph.</span></span>

## <a name="kerning"></a><span data-ttu-id="d5e26-120">字元</span><span class="sxs-lookup"><span data-stu-id="d5e26-120">Kerning</span></span>

<span data-ttu-id="d5e26-121">字偶間距調整是一組字母的配對或 triplet 之間的內容間距調整。</span><span class="sxs-lookup"><span data-stu-id="d5e26-121">Kerning is the contextual spacing adjustment between pairs or triplets of letters.</span></span> <span data-ttu-id="d5e26-122">字元集之間的特定間距可提高可讀性，讓文字外觀更好。</span><span class="sxs-lookup"><span data-stu-id="d5e26-122">Specific spacing between sets of characters can increase readability and make text look better.</span></span> <span data-ttu-id="d5e26-123">字偶間距和字元間距之間的重要差異，在於字母間距與文字的空格無關，而在某些情況下，會在字型中定義的特定字元集間使用字偶間距調整。</span><span class="sxs-lookup"><span data-stu-id="d5e26-123">The important difference between kerning and character spacing is the fact that letter spacing is agnostic to the text it spaces, while kerning is used in certain situations between certain pairs of characters as defined in the font.</span></span>

<span data-ttu-id="d5e26-124">影像的影像是字偶間距的範例。</span><span class="sxs-lookup"><span data-stu-id="d5e26-124">The image her is an example of kerning.</span></span> <span data-ttu-id="d5e26-125">在最上方的文字文字會進行間距調整，讓文字看起來更自然。</span><span class="sxs-lookup"><span data-stu-id="d5e26-125">The word AVATAR on the top line is kerned in order to make the word look more natural.</span></span> <span data-ttu-id="d5e26-126">您可以從字元周圍的紅色方塊中看出，前四個字母之間會有更多間距，而結尾的 R 有更多空間。</span><span class="sxs-lookup"><span data-stu-id="d5e26-126">As you can see from the red boxes around the characters, there is more spacing applied between the first four letters, while the R on the end has more space before it.</span></span> <span data-ttu-id="d5e26-127">沒有間距的原始文字會在第二行上。</span><span class="sxs-lookup"><span data-stu-id="d5e26-127">The original text without kerning is on the second line.</span></span> <span data-ttu-id="d5e26-128">此範例中的字偶間距讓文字更容易閱讀且更自然。</span><span class="sxs-lookup"><span data-stu-id="d5e26-128">The kerning in this example makes the word more readable and more natural.</span></span>

![已套用或不套用間距的相同單字範例。](images/kerning.png)

<span data-ttu-id="d5e26-130">字元會在字型 kerns 儲存于字偶間距表中的字元配對之間前進， [DirectWrite](direct-write-portal.md) 會剖析該資料表，並透過字偶間距調整 api 將資訊傳回給您。</span><span class="sxs-lookup"><span data-stu-id="d5e26-130">The character advances between pairs of characters that the font kerns are stored in the kern table and [DirectWrite](direct-write-portal.md) parses that table and returns the information to you through the kerning APIs.</span></span>

<span data-ttu-id="d5e26-131">如果您想要知道字型是否支援配對的字偶間距調整，您可以使用 [**IDWriteFontFace1：： HasKerningPairs**](/windows/win32/api/dwrite_1/nf-dwrite_1-idwritefontface1-haskerningpairs) 方法。</span><span class="sxs-lookup"><span data-stu-id="d5e26-131">If you want to know whether or not a font supports pair kerning, you can use the [**IDWriteFontFace1::HasKerningPairs**](/windows/win32/api/dwrite_1/nf-dwrite_1-idwritefontface1-haskerningpairs) method.</span></span> <span data-ttu-id="d5e26-132">如果字型支援字偶間距配對，則這個方法會傳回布林值1。</span><span class="sxs-lookup"><span data-stu-id="d5e26-132">This method returns a bool value of 1 if the font supports kerning pairs.</span></span>

<span data-ttu-id="d5e26-133">[**IDWriteFontFace1**](/windows/win32/api/dwrite_1/nn-dwrite_1-idwritefontface1)也有一種方法，可讓您存取圖像索引的字偶間距配對調整。</span><span class="sxs-lookup"><span data-stu-id="d5e26-133">The [**IDWriteFontFace1**](/windows/win32/api/dwrite_1/nn-dwrite_1-idwritefontface1) also has a method that allows you to get access to the kerning pair adjustments for glyph indices.</span></span> <span data-ttu-id="d5e26-134">[**GetKerningPairAdjustments**](/windows/win32/api/dwrite_1/nf-dwrite_1-idwritefontface1-getkerningpairadjustments) 可讓您輸入圖像索引的陣列，而 [DirectWrite](direct-write-portal.md) 會傳回圖像向前調整的陣列。</span><span class="sxs-lookup"><span data-stu-id="d5e26-134">[**GetKerningPairAdjustments**](/windows/win32/api/dwrite_1/nf-dwrite_1-idwritefontface1-getkerningpairadjustments) allows you to input an array of glyph indices and [DirectWrite](direct-write-portal.md) returns an array of glyph advance adjustments.</span></span> <span data-ttu-id="d5e26-135">如果字型不支援字偶間距調整表格，則此方法會傳回零，以供圖像預先調整之用。</span><span class="sxs-lookup"><span data-stu-id="d5e26-135">If a font doesn't support the kern table, the method returns zeroes for the glyph advance adjustments.</span></span>

<span data-ttu-id="d5e26-136">如果您使用的是 [DirectWrite](direct-write-portal.md) 配置， [**IDWriteTextLayout1**](/windows/win32/api/dwrite_1/nn-dwrite_1-idwritetextlayout1) 介面上有兩種方法可讓您設定配對的字偶間距調整，並深入瞭解版面配置中的配對間距。</span><span class="sxs-lookup"><span data-stu-id="d5e26-136">If you are using the [DirectWrite](direct-write-portal.md) layout, there are two methods on the [**IDWriteTextLayout1**](/windows/win32/api/dwrite_1/nn-dwrite_1-idwritetextlayout1) interface that allow you to set pair kerning and learn more about pair kerning in the layout.</span></span> <span data-ttu-id="d5e26-137">如果您想要啟用配對字偶間距調整， [**SetPairKerning**](/windows/win32/api/dwrite_1/nf-dwrite_1-idwritetextlayout1-setpairkerning) 方法會採用布林標記法，並使用 [**DWRITE \_ 文字 \_ 範圍**](/windows/win32/api/dwrite/ns-dwrite-dwrite_text_range) 來定義要套用的文字範圍。</span><span class="sxs-lookup"><span data-stu-id="d5e26-137">The [**SetPairKerning**](/windows/win32/api/dwrite_1/nf-dwrite_1-idwritetextlayout1-setpairkerning) method takes in a Boolean representation of whether or not you want pair kerning enabled and a [**DWRITE\_TEXT\_RANGE**](/windows/win32/api/dwrite/ns-dwrite-dwrite_text_range) that defines the range of text to apply it to.</span></span> <span data-ttu-id="d5e26-138">如果您想要瞭解是否在文字範圍上啟用成對的字偶間距調整，您可以使用 [**GetPairKerning**](/windows/win32/api/dwrite_1/nf-dwrite_1-idwritetextlayout1-getpairkerning) 方法，它會接受目前的位置並傳回布林值，對應於是否啟用配對的字偶間距調整，以及要套用字偶間距設定的文字範圍。</span><span class="sxs-lookup"><span data-stu-id="d5e26-138">If you want to learn whether or not pair kerning is enabled on a text range you can use the [**GetPairKerning**](/windows/win32/api/dwrite_1/nf-dwrite_1-idwritetextlayout1-getpairkerning) method, which takes in the current position and returns a bool corresponding to whether or not pair kerning is enabled, and the text range that the kerning setting applies to.</span></span>

## <a name="justification"></a><span data-ttu-id="d5e26-139">理由</span><span class="sxs-lookup"><span data-stu-id="d5e26-139">Justification</span></span>

<span data-ttu-id="d5e26-140">理由是對齊文字以填滿資料行內所有空間的程式，其方式是增加字元或字元叢集之間的前進量，或加入對齊字元以達成相同的效果。</span><span class="sxs-lookup"><span data-stu-id="d5e26-140">Justification is the process of aligning text so that it fills all the space within a column by increasing the advances between characters or glyph clusters or adding justification characters to achieve the same effect.</span></span> <span data-ttu-id="d5e26-141">一般而言，這是藉由判斷需要將空間加入至文字的位置，以及在這些中斷的機會中插入間距字元來達成。</span><span class="sxs-lookup"><span data-stu-id="d5e26-141">In general, this is accomplished by determining where space needs to be added to a line of text, and inserting spacing characters in those breaking opportunities.</span></span> <span data-ttu-id="d5e26-142">這些間距專案也可以不同，在拉丁的腳本中，文字會藉由增加元素之間的前進寬度來對齊，而在阿拉伯文中，文字會與 kashida 對齊。</span><span class="sxs-lookup"><span data-stu-id="d5e26-142">These spacing elements can differ as well, in Latin scripts, text is justified by increasing the advance widths between elements, while in Arabic, text is justified with a kashida.</span></span> <span data-ttu-id="d5e26-143">以下是對齊和不對齊的阿拉伯文和拉丁腳本範例。</span><span class="sxs-lookup"><span data-stu-id="d5e26-143">Here is an example of Arabic and Latin script both justified and not justified.</span></span>

![對齊和不對齊的阿拉伯文和拉丁腳本範例。](images/justification.png)

<span data-ttu-id="d5e26-145">從 Windows 8 開始， [DirectWrite](direct-write-portal.md) 有一些方法可讓您在應用程式中對齊文字。</span><span class="sxs-lookup"><span data-stu-id="d5e26-145">Starting with Windows 8, [DirectWrite](direct-write-portal.md) has a number of methods that allow you to justify text in your apps.</span></span>

<span data-ttu-id="d5e26-146">[**DWRITE \_ 文字 \_ 對齊**](/windows/win32/api/dwrite/ne-dwrite-dwrite_text_alignment)列舉中有額外的值。</span><span class="sxs-lookup"><span data-stu-id="d5e26-146">There is an additional value in the [**DWRITE\_TEXT\_ALIGNMENT**](/windows/win32/api/dwrite/ne-dwrite-dwrite_text_alignment) enumeration.</span></span> <span data-ttu-id="d5e26-147">您可以使用 [**SetTextAlignment**](/windows/win32/api/dwrite/nf-dwrite-idwritetextformat-settextalignment) 方法，並傳入 DWRITE 的 **\_ 文字 \_ 對齊對齊 \_** 常數， [DirectWrite](direct-write-portal.md) 會對齊文字並為腳本插入適當的對齊字元。</span><span class="sxs-lookup"><span data-stu-id="d5e26-147">You can use the [**SetTextAlignment**](/windows/win32/api/dwrite/nf-dwrite-idwritetextformat-settextalignment) method and pass in the **DWRITE\_TEXT\_ALIGNMENT\_JUSTIFIED** constant and [DirectWrite](direct-write-portal.md) justifies the text and inserts the appropriate justification character for the script.</span></span>

<span data-ttu-id="d5e26-148">如果您使用自訂版面配置，有許多方法可供使用，因此您可以利用理由。</span><span class="sxs-lookup"><span data-stu-id="d5e26-148">If you are using a custom layout have a number of methods available so you can take advantage of justification.</span></span> <span data-ttu-id="d5e26-149">[DirectWrite](direct-write-portal.md) 在 [**IDWriteTextAnalyzer1**](/windows/win32/api/dwrite_1/nn-dwrite_1-idwritetextanalyzer1) 介面上有三個方法，可讓您用來將理由新增至自訂版面配置。</span><span class="sxs-lookup"><span data-stu-id="d5e26-149">[DirectWrite](direct-write-portal.md) has three methods on the [**IDWriteTextAnalyzer1**](/windows/win32/api/dwrite_1/nn-dwrite_1-idwritetextanalyzer1) interface that you can use to add justification to a custom layout.</span></span>

<span data-ttu-id="d5e26-150">第一個方法是 [**GetJustificationOpportunities**](/windows/win32/api/dwrite_1/nf-dwrite_1-idwritetextanalyzer1-getjustificationopportunities)，它接受您想要對齊的文字，並傳回 DWRITE 的 [**\_ 理由 \_ 機會**](/windows/win32/api/Dwrite_1/ns-dwrite_1-dwrite_justification_opportunity) 結構，以概述可加入對齊字元以調整文字的位置。</span><span class="sxs-lookup"><span data-stu-id="d5e26-150">The first method is [**GetJustificationOpportunities**](/windows/win32/api/dwrite_1/nf-dwrite_1-idwritetextanalyzer1-getjustificationopportunities), which takes in the text that you want to justify and returns a [**DWRITE\_JUSTIFICATION\_OPPORTUNITY**](/windows/win32/api/Dwrite_1/ns-dwrite_1-dwrite_justification_opportunity) structure that outlines where justification characters can be added to justify the text.</span></span>

<span data-ttu-id="d5e26-151">第二個函式是 [**JustifyGlyphAdvances**](/windows/win32/api/dwrite_1/nf-dwrite_1-idwritetextanalyzer1-justifyglyphadvances)，它會對齊字元前進的陣列，使其符合線條寬度。</span><span class="sxs-lookup"><span data-stu-id="d5e26-151">The second function is [**JustifyGlyphAdvances**](/windows/win32/api/dwrite_1/nf-dwrite_1-idwritetextanalyzer1-justifyglyphadvances), which justifies an array of glyph advances so that they fit the line width.</span></span> <span data-ttu-id="d5e26-152">這個方法會採用 [**GetJustificationOpportunities**](/windows/win32/api/dwrite_1/nf-dwrite_1-idwritetextanalyzer1-getjustificationopportunities)所產生的 [**DWRITE \_ 對齊 \_ 商機**](/windows/win32/api/Dwrite_1/ns-dwrite_1-dwrite_justification_opportunity)結構、圖像前進和字元位移。</span><span class="sxs-lookup"><span data-stu-id="d5e26-152">This method takes in the [**DWRITE\_JUSTIFICATION\_OPPORTUNITY**](/windows/win32/api/Dwrite_1/ns-dwrite_1-dwrite_justification_opportunity) structure that [**GetJustificationOpportunities**](/windows/win32/api/dwrite_1/nf-dwrite_1-idwritetextanalyzer1-getjustificationopportunities) generates, the glyph advances, and the glyph offsets.</span></span> <span data-ttu-id="d5e26-153">然後，它會產生對齊的圖像前進，以及包含對齊的圖像 [**位移的 DWRITE 圖像 \_ \_ 位移**](/windows/win32/api/dwrite/ns-dwrite-dwrite_glyph_offset) 列舉。</span><span class="sxs-lookup"><span data-stu-id="d5e26-153">It then generates the justified glyph advances and a [**DWRITE\_GLYPH\_OFFSET**](/windows/win32/api/dwrite/ns-dwrite-dwrite_glyph_offset) enumeration that contains the justified glyph offsets.</span></span>

<span data-ttu-id="d5e26-154">第三個函式是 [**GetJustifiedGlyphs**](/windows/win32/api/dwrite_1/nf-dwrite_1-idwritetextanalyzer1-getjustifiedglyphs)，它會填入複雜字集的新字元，其中的理由已增加字元的前進量。</span><span class="sxs-lookup"><span data-stu-id="d5e26-154">The third function is [**GetJustifiedGlyphs**](/windows/win32/api/dwrite_1/nf-dwrite_1-idwritetextanalyzer1-getjustifiedglyphs), which fills in the new glyphs for complex scripts where justification has increased the advances for glyphs.</span></span> <span data-ttu-id="d5e26-155">只有當腳本有 [**GetScriptProperties**](/windows/win32/api/dwrite_1/nf-dwrite_1-idwritetextanalyzer1-getscriptproperties)所傳回的特定對齊字元時，才需要呼叫 **GetJustifiedGlyphs** 。</span><span class="sxs-lookup"><span data-stu-id="d5e26-155">**GetJustifiedGlyphs** only needs to be called if the script has a specific justification character as returned by [**GetScriptProperties**](/windows/win32/api/dwrite_1/nf-dwrite_1-idwritetextanalyzer1-getscriptproperties).</span></span> <span data-ttu-id="d5e26-156">這個方法會取得有關字型、文字長度、圖像的 em 大小、文字腳本、字元數、叢集對應、原始字元前進/位移、對齊圖像前進/位移和圖像屬性的資訊。</span><span class="sxs-lookup"><span data-stu-id="d5e26-156">This method takes in information about the font, length of the text, em size of the glyphs, script of the text, number of glyphs, cluster map, original glyph advances/offsets, justified glyph advances/offsets, and glyph properties.</span></span> <span data-ttu-id="d5e26-157">方法會傳回實際的圖像計數、更新的叢集對應、已更新的圖像索引（具有插入的對齊圖像、更新的圖像位移，以及更新的字元前進）。</span><span class="sxs-lookup"><span data-stu-id="d5e26-157">The method returns the actual glyph count, updated cluster map, updated glyph indices with inserted justification glyphs, updated glyph offsets, and updated glyph advances.</span></span>

 

 