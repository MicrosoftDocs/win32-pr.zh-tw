---
title: 文字度量
description: 為了協助您的版面配置、自訂字型選取，以及其他需要大量計量的作業，從 Windows 8 開始，DirectWrite 有許多新的 Api，可表達您開發 rich text 應用程式時可能需要的字型相關資訊。
ms.assetid: 9df8c675-6f4d-4de7-916e-7dc51f5f04aa
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 73647ae4521b23afb399a4c66c8b25cdc46ba1b5
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/20/2020
ms.locfileid: "106996566"
---
# <a name="text-metrics"></a><span data-ttu-id="68672-103">文字度量</span><span class="sxs-lookup"><span data-stu-id="68672-103">Text Metrics</span></span>

<span data-ttu-id="68672-104">為了協助您的版面配置、自訂字型選取，以及其他需要大量計量的作業，從 Windows 8 開始， [DirectWrite](direct-write-portal.md) 有許多新的 api，可表達您開發 rich text 應用程式時可能需要的字型相關資訊。</span><span class="sxs-lookup"><span data-stu-id="68672-104">In order to assist your layout, custom font selection, and other metric intensive operations, starting in Windows 8, [DirectWrite](direct-write-portal.md) has a number of new APIs to express all the info about fonts that you might require to develop rich text apps.</span></span>

## <a name="panose"></a><span data-ttu-id="68672-105">PANOSE</span><span class="sxs-lookup"><span data-stu-id="68672-105">PANOSE</span></span>

<span data-ttu-id="68672-106">PANOSE 是用來識別字體的視覺化分類系統。</span><span class="sxs-lookup"><span data-stu-id="68672-106">PANOSE is a visual classification system for identifying typefaces.</span></span> <span data-ttu-id="68672-107">PANOSE 分類包含系列、serif 樣式、權數、比例、對比、筆劃、arm 樣式、X 高度等等的資訊。此資訊描述字型的視覺化樣式。</span><span class="sxs-lookup"><span data-stu-id="68672-107">The PANOSE classification contains info on the family, serif style, weight, proportion, contrast, stroke, arm style, X-height, etc. This info describes the visual style of the font.</span></span> <span data-ttu-id="68672-108">這項資訊很重要，因為具有類似 PANOSE 值的字型看起來類似。</span><span class="sxs-lookup"><span data-stu-id="68672-108">This info is important because fonts with similar PANOSE values look similar.</span></span> <span data-ttu-id="68672-109">當字型無法使用，而且應用程式必須切換回可用的字型時，這非常有用。</span><span class="sxs-lookup"><span data-stu-id="68672-109">This is very useful in situations where a font isn’t available and the app needs to fall back to a font that’s available.</span></span> <span data-ttu-id="68672-110">比較字型的 PANOSE 值，可讓您選擇視覺效果與原始字型類似的字型。</span><span class="sxs-lookup"><span data-stu-id="68672-110">Comparing PANOSE values for fonts allows you to choose a font that’s similar visually to the original font.</span></span>

<span data-ttu-id="68672-111">為了存取字型的 PANOSE 資訊，請在 [**IDWriteFont1**](/windows/win32/api/dwrite_1/nn-dwrite_1-idwritefont1)和 [**IDWriteFontFace1**](/windows/win32/api/dwrite_1/nn-dwrite_1-idwritefontface1)介面上使用 [**GetPanose**](/windows/win32/api/dwrite_1/nf-dwrite_1-idwritefont1-getpanose)方法。</span><span class="sxs-lookup"><span data-stu-id="68672-111">In order to access the PANOSE info for a font, use the [**GetPanose**](/windows/win32/api/dwrite_1/nf-dwrite_1-idwritefont1-getpanose) method on the [**IDWriteFont1**](/windows/win32/api/dwrite_1/nn-dwrite_1-idwritefont1) and [**IDWriteFontFace1**](/windows/win32/api/dwrite_1/nn-dwrite_1-idwritefontface1) interfaces.</span></span> <span data-ttu-id="68672-112">這個方法會傳回 [**DWRITE \_ PANOSE**](/windows/win32/api/Dwrite_1/ns-dwrite_1-dwrite_panose) 列舉，其中包含該字型的所有 PANOSE 資訊。</span><span class="sxs-lookup"><span data-stu-id="68672-112">This method returns a [**DWRITE\_PANOSE**](/windows/win32/api/Dwrite_1/ns-dwrite_1-dwrite_panose) enumeration that contains all of the PANOSE info for that font.</span></span>

## <a name="additional-metrics"></a><span data-ttu-id="68672-113">其他計量</span><span class="sxs-lookup"><span data-stu-id="68672-113">Additional Metrics</span></span>

<span data-ttu-id="68672-114">從 Windows 8 開始， [DirectWrite](direct-write-portal.md) API 也支援一些新的計量，以向您的應用程式表達字型的有用資訊。</span><span class="sxs-lookup"><span data-stu-id="68672-114">Starting in Windows 8, the [DirectWrite](direct-write-portal.md) API also supports a number of new metrics in order to express useful info about the fonts to your app.</span></span> <span data-ttu-id="68672-115">這些新計量包含這項資訊。</span><span class="sxs-lookup"><span data-stu-id="68672-115">These new metrics include this info.</span></span>

-   <span data-ttu-id="68672-116">左、右、頂端和底部的字元周框方塊度量。</span><span class="sxs-lookup"><span data-stu-id="68672-116">Left, Right, Top, and Bottom glyph bounding box metrics.</span></span>
-   <span data-ttu-id="68672-117">上標和下標元素的 X 和 Y 位置。</span><span class="sxs-lookup"><span data-stu-id="68672-117">X and Y positioning for superscript and subscript elements.</span></span>
-   <span data-ttu-id="68672-118">上標和下標元素的 X 和 Y 縮放比例資訊。</span><span class="sxs-lookup"><span data-stu-id="68672-118">X and Y scaling info for superscript and subscript elements.</span></span>
-   <span data-ttu-id="68672-119">字型是否有印刷樣式計量。</span><span class="sxs-lookup"><span data-stu-id="68672-119">Whether or not the font has typographic metrics.</span></span>

<span data-ttu-id="68672-120">您可以透過 [**IDWriteFontFace1**](/windows/win32/api/dwrite_1/nn-dwrite_1-idwritefontface1)和 [**IDWriteFont1**](/windows/win32/api/dwrite_1/nn-dwrite_1-idwritefont1)介面上的新 [**GetMetrics**](/windows/win32/api/dwrite_1/nf-dwrite_1-idwritefont1-getmetrics)方法，取得這項資訊。</span><span class="sxs-lookup"><span data-stu-id="68672-120">This info is all available through the new [**GetMetrics**](/windows/win32/api/dwrite_1/nf-dwrite_1-idwritefont1-getmetrics) method on the [**IDWriteFontFace1**](/windows/win32/api/dwrite_1/nn-dwrite_1-idwritefontface1) and [**IDWriteFont1**](/windows/win32/api/dwrite_1/nn-dwrite_1-idwritefont1) interfaces.</span></span> <span data-ttu-id="68672-121">這個方法會傳回包含所有資訊的 [**DWRITE \_ font-family \_ METRICS1**](/windows/win32/api/Dwrite_1/ns-dwrite_1-dwrite_font_metrics1) 結構。</span><span class="sxs-lookup"><span data-stu-id="68672-121">This method returns a [**DWRITE\_FONT\_METRICS1**](/windows/win32/api/Dwrite_1/ns-dwrite_1-dwrite_font_metrics1) structure that contains all this info.</span></span>

## <a name="caret-metrics"></a><span data-ttu-id="68672-122">插入號計量</span><span class="sxs-lookup"><span data-stu-id="68672-122">Caret Metrics</span></span>

<span data-ttu-id="68672-123">若要建立文字編輯應用程式，您需要存取有關如何繪製可流覽文字之插入點的資訊。</span><span class="sxs-lookup"><span data-stu-id="68672-123">To create text editing apps you need access to info about how to draw the caret that navigates through the text.</span></span> <span data-ttu-id="68672-124">從 Windows 8 開始， [DirectWrite](direct-write-portal.md)會在此案例的 [**IDWriteFontFace1**](/windows/win32/api/dwrite_1/nn-dwrite_1-idwritefontface1)和 [**IDWriteFont1**](/windows/win32/api/dwrite_1/nn-dwrite_1-idwritefont1)介面上提供 [**GetCaretMetrics**](/windows/win32/api/dwrite_1/nf-dwrite_1-idwritefontface1-getcaretmetrics)方法。</span><span class="sxs-lookup"><span data-stu-id="68672-124">Starting in Windows 8, [DirectWrite](direct-write-portal.md) provides the [**GetCaretMetrics**](/windows/win32/api/dwrite_1/nf-dwrite_1-idwritefontface1-getcaretmetrics) method on the [**IDWriteFontFace1**](/windows/win32/api/dwrite_1/nn-dwrite_1-idwritefontface1) and [**IDWriteFont1**](/windows/win32/api/dwrite_1/nn-dwrite_1-idwritefont1) interfaces for this scenario.</span></span> <span data-ttu-id="68672-125">**GetCaretMetrics** 會傳回 [**DWRITE \_ 插入號 \_ 計量**](/windows/win32/api/Dwrite_1/ns-dwrite_1-dwrite_caret_metrics) 列舉，其中包含有關基準上插入號的斜率和位移的資訊。</span><span class="sxs-lookup"><span data-stu-id="68672-125">**GetCaretMetrics** returns a [**DWRITE\_CARET\_METRICS**](/windows/win32/api/Dwrite_1/ns-dwrite_1-dwrite_caret_metrics) enumeration which contains info about the slope and offset for the caret along the baseline.</span></span>

<span data-ttu-id="68672-126">如果您想要能夠以斜體文字適當地使用其插入號斜率，此資訊特別有用。</span><span class="sxs-lookup"><span data-stu-id="68672-126">This info is specifically helpful if you want to be able to have their caret slope appropriately with italic text.</span></span>

## <a name="monospaced-discoverability"></a><span data-ttu-id="68672-127">等寬字型可探索性</span><span class="sxs-lookup"><span data-stu-id="68672-127">Monospaced Discoverability</span></span>

<span data-ttu-id="68672-128">讓使用者撰寫電腦程式代碼的應用程式，通常會使用等寬字型字型來取代更傳統的字型。</span><span class="sxs-lookup"><span data-stu-id="68672-128">Apps that allow your users to write computer code often use monospaced fonts in place of more traditional fonts.</span></span> <span data-ttu-id="68672-129">因此，您可以對開發相關應用程式中的字型選取進行更多的控制， [DirectWrite](direct-write-portal.md) 表示是否透過 API 等寬字型字型。</span><span class="sxs-lookup"><span data-stu-id="68672-129">So you can have more control over font selection in apps related to development, [DirectWrite](direct-write-portal.md) expresses whether or not a font is monospaced through the API.</span></span> <span data-ttu-id="68672-130">[**IDWriteFontFace1**](/windows/win32/api/dwrite_1/nn-dwrite_1-idwritefontface1)介面上的 [**IsMonospacedFont**](/windows/win32/api/dwrite_1/nf-dwrite_1-idwritefont1-ismonospacedfont)方法會傳回布林值，指出字型是否為等寬字型。</span><span class="sxs-lookup"><span data-stu-id="68672-130">The [**IsMonospacedFont**](/windows/win32/api/dwrite_1/nf-dwrite_1-idwritefont1-ismonospacedfont) method on the [**IDWriteFontFace1**](/windows/win32/api/dwrite_1/nn-dwrite_1-idwritefontface1) interface returns a Boolean that indicates whether or not the font is monospaced.</span></span>

## <a name="font-name-matching"></a><span data-ttu-id="68672-131">符合的字型名稱</span><span class="sxs-lookup"><span data-stu-id="68672-131">Font Name Matching</span></span>

<span data-ttu-id="68672-132">PDF 讀取器等 Rich text 應用程式必須能夠將其內容中的字型與系統上的字型進行比對，因此需要存取多種格式的字型完整名稱。</span><span class="sxs-lookup"><span data-stu-id="68672-132">Rich text apps like PDF readers need to be able to match fonts in their content to fonts on the system, need access to the full names of fonts in multiple formats.</span></span> <span data-ttu-id="68672-133">因此，您可以更有效地比對字型， [DirectWrite](direct-write-portal.md) 包含的列舉會以許多格式表達字型的完整命名資訊。</span><span class="sxs-lookup"><span data-stu-id="68672-133">So you can better match fonts, [DirectWrite](direct-write-portal.md) contains an enumeration that expresses full naming info about a font in many formats.</span></span>

<span data-ttu-id="68672-134">您可以使用 [**DWRITE \_ 資訊 \_ 字串 \_ 識別碼**](/windows/win32/api/dwrite/ne-dwrite-dwrite_informational_string_id) 列舉來取得系統上任何字型的完整名稱、postscript 名稱和 postscript CID 名稱。</span><span class="sxs-lookup"><span data-stu-id="68672-134">you use the [**DWRITE\_INFORMATIONAL\_STRING\_ID**](/windows/win32/api/dwrite/ne-dwrite-dwrite_informational_string_id) enumeration to get the full name, PostScript name, and PostScript CID name of any font on the system.</span></span> <span data-ttu-id="68672-135">當您需要將應用程式中的字型與本機系統上的適當字型進行比對時，此資訊非常重要。</span><span class="sxs-lookup"><span data-stu-id="68672-135">This info is valuable when you need to match fonts in your app to appropriate fonts on the local system.</span></span>

## <a name="glyph-advances"></a><span data-ttu-id="68672-136">字元前進</span><span class="sxs-lookup"><span data-stu-id="68672-136">Glyph Advances</span></span>

<span data-ttu-id="68672-137">[**IDWriteFontFace1**](/windows/win32/api/dwrite_1/nn-dwrite_1-idwritefontface1)和 [**IDWriteFont1**](/windows/win32/api/dwrite_1/nn-dwrite_1-idwritefont1)介面上的 **GetGlyphAdvances** 方法會接受您需要前進資訊的圖像計數和索引，然後傳回有問題之圖像的前進。</span><span class="sxs-lookup"><span data-stu-id="68672-137">The **GetGlyphAdvances** method on the [**IDWriteFontFace1**](/windows/win32/api/dwrite_1/nn-dwrite_1-idwritefontface1) and [**IDWriteFont1**](/windows/win32/api/dwrite_1/nn-dwrite_1-idwritefont1) interfaces takes in the glyph count and indices that you need advances info about and then returns the advances for the glyphs in question.</span></span>

## <a name="unicode-ranges"></a><span data-ttu-id="68672-138">Unicode 範圍</span><span class="sxs-lookup"><span data-stu-id="68672-138">Unicode Ranges</span></span>

<span data-ttu-id="68672-139">想要處理自己字型選取的應用程式，需要存取字型支援的 Unicode 範圍。</span><span class="sxs-lookup"><span data-stu-id="68672-139">Apps that want to handle their own font selection need access to the Unicode ranges that are supported by the font.</span></span> <span data-ttu-id="68672-140">如此一來，如果字型不支援 Unicode 表示點，應用程式可以選擇包含該圖像的適當字型。</span><span class="sxs-lookup"><span data-stu-id="68672-140">This way, if a Unicode codepoint isn’t supported by the font, the app can choose an appropriate font that contains that glyph.</span></span> <span data-ttu-id="68672-141">如果沒有此資訊，應用程式可能會使用不包含顯示資訊所需之所有字元的字型。</span><span class="sxs-lookup"><span data-stu-id="68672-141">Without this info, the app may use a font that doesn’t contain all the glyphs that are necessary to display the info present.</span></span>

<span data-ttu-id="68672-142">[**IDWriteFontFace1**](/windows/win32/api/dwrite_1/nn-dwrite_1-idwritefontface1)和 [**IDWriteFont1**](/windows/win32/api/dwrite_1/nn-dwrite_1-idwritefont1)介面上的 [**GetUnicodeRanges**](/windows/win32/api/dwrite_1/nf-dwrite_1-idwritefont1-getunicoderanges)方法會接受從用戶端傳入的最大範圍數目，並傳回字型所支援的實際範圍。</span><span class="sxs-lookup"><span data-stu-id="68672-142">The [**GetUnicodeRanges**](/windows/win32/api/dwrite_1/nf-dwrite_1-idwritefont1-getunicoderanges) method on the [**IDWriteFontFace1**](/windows/win32/api/dwrite_1/nn-dwrite_1-idwritefontface1) and [**IDWriteFont1**](/windows/win32/api/dwrite_1/nn-dwrite_1-idwritefont1) interfaces takes in the maximum number of ranges passed in from the client, and returns the actual ranges supported by the font.</span></span>

## <a name="eudc-font-collection"></a><span data-ttu-id="68672-143">EUDC 字型集合</span><span class="sxs-lookup"><span data-stu-id="68672-143">EUDC Font Collection</span></span>

<span data-ttu-id="68672-144">在 [**IDWriteFactory1**](/windows/win32/api/dwrite_1/nn-dwrite_1-idwritefactory1)介面上使用 [**GetEudcFontCollection**](/windows/win32/api/dwrite_1/nf-dwrite_1-idwritefactory1-geteudcfontcollection)方法，存取 EUDC 字型集合。</span><span class="sxs-lookup"><span data-stu-id="68672-144">Use the [**GetEudcFontCollection**](/windows/win32/api/dwrite_1/nf-dwrite_1-idwritefactory1-geteudcfontcollection) method on the [**IDWriteFactory1**](/windows/win32/api/dwrite_1/nn-dwrite_1-idwritefactory1) interface access the EUDC font collection.</span></span> <span data-ttu-id="68672-145">這個方法的運作方式與 [**GetSystemFontCollection**](/windows/win32/api/dwrite/nf-dwrite-idwritefactory-getsystemfontcollection)相同，但會傳回 EUDC 字型集合的指標。</span><span class="sxs-lookup"><span data-stu-id="68672-145">This method works in the same way as [**GetSystemFontCollection**](/windows/win32/api/dwrite/nf-dwrite-idwritefactory-getsystemfontcollection), but instead returns a pointer to an EUDC font collection.</span></span>

 

 