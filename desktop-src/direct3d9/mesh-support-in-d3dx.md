---
description: 深入瞭解 D3DX 中的網狀支援。 D3DX 是提供 helper 服務的公用程式庫。 它是 Direct3D 元件之上的一層。
ms.assetid: 7892370f-0807-4ab7-b7cd-a7e1182e3f9c
title: 'D3DX 中的網格支援 (Direct3D 9) '
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: a1600b372432d59357a7431c70ce70ce2958002c
ms.sourcegitcommit: 5d4e99f4c8f42f5f543e52cb9beb9fb13ec56c5f
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 06/19/2021
ms.locfileid: "112408131"
---
# <a name="mesh-support-in-d3dx-direct3d-9"></a>D3DX 中的網格支援 (Direct3D 9) 

D3DX 是提供 helper 服務的公用程式庫。 它是 Direct3D 元件之上的一層。

## <a name="meshes"></a>網狀

D3DX 會執行網格結構來載入、操作和轉譯. x 檔案內容。 網格基本上是定義某些幾何的頂點集合，以及定義臉部的一組索引。 有數種網格類型。

[**ID3DXBaseMesh**](id3dxbasemesh.md) 提供基本概念。 [**ID3DXMesh**](id3dxmesh.md) 繼承自 ID3DXBaseMesh，並使用每個晶片頂點快取來新增網格優化。 [**ID3DXSkinInfo**](id3dxskininfo.md) 提供 skinned 網格支援。

[**ID3DXBaseMesh**](id3dxbasemesh.md) 提供的方法可操作和查詢從基底網格繼承的 [**ID3DXMesh**](id3dxmesh.md) 網格物件。 這包括相鄰作業、幾何緩衝區抓取、鎖定/解除鎖定作業 (頂點和索引) ，以及複製、轉譯、臉部和頂點資訊。

> [!Note]  
> ID3DXPMesh 和 ID3DXSPMesh 介面 (，以支援漸進式和簡化的網格，並已卸載舊版 Direct3D 9 中可用的) 。

 

## <a name="mesh-architecture"></a>網狀架構

網格包含複雜模型的資料。 它是一個抽象資料容器，其中包含紋理和材質等資源，以及位置資料和相鄰資料等屬性。 有數種網格運算可改善繪圖效能以及表面的外觀。 此外，還有一些其他網格概念會影響網格作業的功能。 瞭解這些網格概念，讓您可以加以套用可改善網格效能。

## <a name="mesh-object-data"></a>網格物件資料

網格包含頂點緩衝區、索引緩衝區和屬性緩衝區。

-   頂點緩衝區包含頂點資料，也就是網格頂點。
-   索引緩衝區包含用來存取頂點緩衝區的頂點索引。 這可以減少重複的頂點來減少頂點緩衝區大小。 只有索引網格會使用索引緩衝區。 例如，如果網格是由三角形清單所組成，就不會使用索引緩衝區。
-   屬性緩衝區包含屬性資料。 屬性是網格頂點的屬性，不是特定的順序。 D3DX 網格會針對每個臉部，將屬性儲存在 DWORD 群組中。

### <a name="attribute-tables"></a>屬性資料表

屬性資料表是屬性緩衝區內容的精確標記法。 您可以藉由使用 D3DXMESHOPT ATTRSORT 來呼叫其中一個 Optimize 方法 \_ 、鎖定屬性緩衝區，並將資料填入資料，或是藉由呼叫 SetAttributeTable 來建立屬性資料表。 當網格重新排列成群組時，網格包含屬性工作表。 如果在呼叫 Optimize 時，會發生這種情況，假設已 \_ 提供 (D3DXMESHOPT ATTRSORT 或更高) 的屬性排序選項。 D3DX 網格使用已編制索引的三角形清單，因此會以 [**IDirect3DDevice9：:D rawindexedprimitive**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-drawindexedprimitive)來繪製。

由於呼叫 Optimize 的結果，因此會建立屬性資料表。 臉部不一定要相鄰，因為 Optimize 會將它們重新排列為相鄰。 例如，人類網格的手可以使用相同的屬性。 此識別碼有助於將臉部排序成群組。 來自. x 檔案的網格已自動產生材質和材質屬性的屬性。 您必須呼叫 Optimize (ATTRSORT) 或更有效的優化 (VERTEXCACHE) ，以取得良好的效能。 Load 函式會嘗試以其儲存所在的確切形式來呈現資料。 如果您使用頂點緩衝區/索引緩衝區型網格，則網狀架構會提供優化函式，並在極少額外負荷的情況下進行外觀轉換。

優化類型是累計的，從最不理想的 (D3DXMESHOPT \_ COMPACT) 到最理想的 (D3DXMESHOPT \_ IGNOREVERTS) 。 D3DXMESHOPT \_ STRIPREORDER 會執行壓縮和屬性排序。 \_即使在沒有真正頂點快取的裝置上，一律建議使用 D3DXMESHOPT VERTEXCACHE。

## <a name="application-data"></a>應用程式資料

應用程式資料是應用程式所管理的網格資料。 網格頂點資料與這些緩衝區所管理的資料之間有緊密的結合。

材質緩衝區包含 n 個材質。 載入. x 檔案時，Load 函數會傳回材質。 每個子集都可以有自己的材質和材質。 材質緩衝區是靜態的。

鄰接緩衝區包含邊緣、臉部和相鄰臉部的相關資訊。 某些網格操作取決於知道哪些臉部彼此相鄰。 這項資訊（稱為相鄰資料）會保留在連續的緩衝區中。 它不是網格的一部分，而是由應用程式維護，而且必須在必要時提供給網格方法。

效果實例緩衝區包含效果實例的清單。 效果實例會儲存狀態。 這是用來初始化管線的狀態資訊。 效果實例包含效果中的名稱/值配對。

## <a name="advanced-mesh-topics"></a>Advanced 網格主題

優化網格是以基底網格功能為基礎，並使用兩種方法新增頂點快取優化功能： Optimize （建立新的網格）和 OptimizeInPlace （可修改原始網格）。

D3DXGeneratePMesh 使用 D3DX 簡化演算法從輸入網格產生漸進式網格。 D3DXSimplifyMesh 會使用相同的簡化演算法，從輸入網格產生給定詳細資料層級的標準網格。 使用者可以控制透過每個頂點指定的權數，以及針對每個頂點指定的加權所使用的錯誤度量。 每個元件的加權會乘以每個邊緣折迭所計算之錯誤的元件部分。 每個頂點加權會乘以決定要移除該頂點的錯誤度量值。 例如，如果您不想要移除頂點，請將該特定頂點的權數設定為大數值。 相反地，如果您想要先移除它，請將它設定為小於 1)  (的小數值。

[**ID3DXSkinInfo**](id3dxskininfo.md) 支援 skinned 的字元。 Skinned 字元是由一組網格所定義，而一組會影響網格頂點的一組骨骼。 這些骨骼會以轉換階層表示。 每個網格都有一個會影響它的每個骨骼的矩陣，這會將網格轉換成骨骼的區域座標空間。 此矩陣是網格之骨骼的骨骼空間轉換。 這是在撰寫程式中與網格相關聯的時候定義。

### <a name="skinning"></a>皮膚形變

「外觀」是使用骨骼來轉換網格頂點的技巧。 通常會在階層式基本架構中排列骨骼，與人類主體中的骨骼非常類似。 物件頂點接著會與骨骼相關聯，例如將面板附加至骨骼。 當骨骼轉換時，面板也會轉換。

Skinned 網格使用骨骼來影響一些頂點。 骨骼轉換資料是由使用者提供，以影響如何 SRT 的骨骼。 網格會使用轉換的骨骼來影響與骨骼相關聯的頂點。 調色板是 SRT 轉換的陣列。 調色板通常會實作為矩陣，但它們可以包含 SRT 值。

### <a name="progressive-mesh-trimming"></a>漸進式網格修剪

低詳細資料區域可承受遺失不會變更表面呈現外觀的頂點。 尤其是當物件從相機移到更遠的情況時。 這稱為詳細層級。 使用者擁有 API 層級的轉譯控制項，可設定詳細資料層級以最大化呈現效率。

漸進式網格物件以大量臉部開頭，並使用簡化來減少臉部數目。 與 view 無關的漸進式網格稱為「視圖獨立的漸進式網格」 (VIPM) 。

減少臉部數目的另一種方式是藉由修剪。 這實際上會從網格中移除頂點和臉部。 您可以在高階 (上進行修剪，以限制臉部的最大數量) 或在低端 (以限制臉部的最小數目。 ) 修剪可改善繪圖的效能，不過，請小心使用來維持視覺品質。 漸進式網格 SDK 範例會示範修剪。

針對高可見度區域，可以使用漸進式詳細資料層級 (PLOD) 來增加解析度。 這是將單一臉部分成兩面的技巧。

### <a name="patch-meshes"></a>修補程式網格

也支援兩種特製化的修補程式網格類型：矩形和三角形的修補程式。 矩形修補程式網格是一個修補程式網格，其控制點是以纏繞、矩形的序列來配置。 矩形和三角形修補程式用來建立高序位的表面。 它們並不像是三角形網格一般。

## <a name="related-topics"></a>相關主題

<dl> <dt>

[D3DX](d3dx.md)
</dt> </dl>

 

 
