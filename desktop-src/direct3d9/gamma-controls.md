---
description: Gamma 控制項可讓您變更系統顯示介面內容的方式，而不會影響介面本身的內容。
ms.assetid: 74f106be-8f47-4875-9908-32ff35912968
title: " (Direct3D 9) 的 Gamma 控制項"
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 6484bcf7e8fa5e07a3bf4bb718cd361330560f8c
ms.sourcegitcommit: a47bd86f517de76374e4fff33cfeb613eb259a7e
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/06/2021
ms.locfileid: "104556500"
---
# <a name="gamma-controls-direct3d-9"></a><span data-ttu-id="2b806-103"> (Direct3D 9) 的 Gamma 控制項</span><span class="sxs-lookup"><span data-stu-id="2b806-103">Gamma Controls (Direct3D 9)</span></span>

<span data-ttu-id="2b806-104">Gamma 控制項可讓您變更系統顯示介面內容的方式，而不會影響介面本身的內容。</span><span class="sxs-lookup"><span data-stu-id="2b806-104">Gamma controls allow you to change how the system displays the contents of the surface, without affecting the contents of the surface itself.</span></span> <span data-ttu-id="2b806-105">將這些控制項視為非常簡單的篩選器，讓 Direct3D 套用至資料，因為它會離開介面，然後在畫面上呈現。</span><span class="sxs-lookup"><span data-stu-id="2b806-105">Think of these controls as very simple filters that Direct3D applies to data as it leaves a surface and before it is rendered on the screen.</span></span>

<span data-ttu-id="2b806-106">Gamma 控制項是交換鏈的一個屬性。</span><span class="sxs-lookup"><span data-stu-id="2b806-106">Gamma controls are a property of a swap chain.</span></span> <span data-ttu-id="2b806-107">Gamma 控制項可以動態地變更表面的紅色、綠色和藍色層級如何對應至系統顯示的實際層級。</span><span class="sxs-lookup"><span data-stu-id="2b806-107">Gamma controls make it possible to dynamically change how a surface's red, green, and blue levels map to the actual levels that the system displays.</span></span> <span data-ttu-id="2b806-108">藉由設定 gamma 層級，您可以在使用者的字元為快照時，讓使用者的螢幕閃爍色彩-紅色，當字元挑選新專案時為綠色，而不會將新的影像複製到框架緩衝區以達成效果。</span><span class="sxs-lookup"><span data-stu-id="2b806-108">By setting gamma levels, you can cause the user's screen to flash colors - red when the user's character is shot, green when the character picks up a new item, and so on - without copying new images to the frame buffer to achieve the effect.</span></span> <span data-ttu-id="2b806-109">或者，您也可以調整色彩層級，將色彩偏差套用至背景緩衝區中的影像。</span><span class="sxs-lookup"><span data-stu-id="2b806-109">Or, you might adjust color levels to apply a color bias to the images in the back buffer.</span></span>

<span data-ttu-id="2b806-110">由於 Direct3D 9 有一個交換鏈作為裝置的屬性，因此每個裝置一律至少有一個交換鏈 (隱含交換鏈) 。</span><span class="sxs-lookup"><span data-stu-id="2b806-110">There is always at least one swap chain (the implicit swap chain) for each device because Direct3D 9 has one swap chain as a property of the device.</span></span> <span data-ttu-id="2b806-111">由於 gamma 曲線是交換鏈的屬性，因此當交換鏈為視窗視窗時，可以套用 gamma 曲線。</span><span class="sxs-lookup"><span data-stu-id="2b806-111">Because the gamma ramp is a property of the swap chain, the gamma ramp can be applied when the swap chain is windowed.</span></span> <span data-ttu-id="2b806-112">Gamma 曲線會立即生效。</span><span class="sxs-lookup"><span data-stu-id="2b806-112">The gamma ramp takes effect immediately.</span></span> <span data-ttu-id="2b806-113">沒有等待垂直同步作業。</span><span class="sxs-lookup"><span data-stu-id="2b806-113">There is no waiting for a vertical sync operation.</span></span>

<span data-ttu-id="2b806-114">[**SetGammaRamp**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-setgammaramp)和 [**GetGammaRamp**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-getgammaramp)方法可讓您操作從介面傳送至 (DAC) 的紅色、綠色和藍色色彩元件，再將其傳送至類比轉換器的遞增層級，以供顯示。</span><span class="sxs-lookup"><span data-stu-id="2b806-114">The [**SetGammaRamp**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-setgammaramp) and [**GetGammaRamp**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-getgammaramp) methods allow you to manipulate ramp levels that affect the red, green, and blue color components of pixels from the surface before they are sent to the digital-to-analog converter (DAC) for display.</span></span>

## <a name="gamma-ramp-levels"></a><span data-ttu-id="2b806-115">Gamma 斜坡層級</span><span class="sxs-lookup"><span data-stu-id="2b806-115">Gamma Ramp Levels</span></span>

<span data-ttu-id="2b806-116">在 Direct3D 中，「gamma」一詞是指一組值，這些值會將框架緩衝區中所有圖元的層級，對應至 DAC 所接收的新層級，以供顯示之用。</span><span class="sxs-lookup"><span data-stu-id="2b806-116">In Direct3D, the term gamma ramp describes a set of values that map the level of a particular color component - red, green, blue - for all pixels in the frame buffer to new levels that are received by the DAC for display.</span></span> <span data-ttu-id="2b806-117">重新對應是透過三個查閱資料表（每個色彩元件各一個）來執行。</span><span class="sxs-lookup"><span data-stu-id="2b806-117">The remapping is performed by way of three look-up tables, one for each color component.</span></span>

<span data-ttu-id="2b806-118">其運作方式如下： Direct3D 接受框架緩衝區的圖元，並評估其個別的紅色、綠色和藍色色彩元件。</span><span class="sxs-lookup"><span data-stu-id="2b806-118">Here's how it works: Direct3D takes a pixel from the frame buffer and evaluates its individual red, green, and blue color components.</span></span> <span data-ttu-id="2b806-119">每個元件都是以0到65535的值來表示。</span><span class="sxs-lookup"><span data-stu-id="2b806-119">Each component is represented by a value from 0 to 65535.</span></span> <span data-ttu-id="2b806-120">Direct3D 會採用原始值，並使用它來編制256元素陣列 () 的索引，其中每個元素都包含一個值來取代原始值。</span><span class="sxs-lookup"><span data-stu-id="2b806-120">Direct3D takes the original value and uses it to index a 256-element array (the ramp), where each element contains a value that replaces the original one.</span></span> <span data-ttu-id="2b806-121">Direct3D 會針對框架緩衝區中每個圖元的每個色彩元件執行此查閱和取代程式，藉此變更所有螢幕圖元的最終色彩。</span><span class="sxs-lookup"><span data-stu-id="2b806-121">Direct3D performs this look-up and replace process for each color component of each pixel in the frame buffer, thereby changing the final colors for all the on-screen pixels.</span></span>

<span data-ttu-id="2b806-122">藉由繪製遞增的值來視覺化，是很方便的，如下列兩個圖所示。</span><span class="sxs-lookup"><span data-stu-id="2b806-122">It's handy to visualize the ramp values by graphing them, as shown in the following two graphs.</span></span> <span data-ttu-id="2b806-123">左邊的圖形顯示的是不會修改色彩的斜坡。</span><span class="sxs-lookup"><span data-stu-id="2b806-123">The left graph shows a ramp that doesn't modify colors at all.</span></span> <span data-ttu-id="2b806-124">右邊的圖表會顯示會對套用它的色彩元件施加負偏差的斜坡。</span><span class="sxs-lookup"><span data-stu-id="2b806-124">The right graph shows a ramp that imposes a negative bias to the color component to which it is applied.</span></span>

![gamma 遞增值的圖表](images/gammalv.png)

<span data-ttu-id="2b806-126">左邊圖形的陣列元素包含的值，與索引0（位於索引0的元素中的索引0）和索引255的65535相同。</span><span class="sxs-lookup"><span data-stu-id="2b806-126">The array elements for the graph on the left contain values identical to their index - 0 in the element at index 0, and 65535 at index 255.</span></span> <span data-ttu-id="2b806-127">這種類型的型別是預設值，因為它不會在顯示之前變更輸入值。</span><span class="sxs-lookup"><span data-stu-id="2b806-127">This type of ramp is the default, as it doesn't change the input values before they're displayed.</span></span> <span data-ttu-id="2b806-128">右側圖形提供更多變化;它的第一個元素中包含的值範圍從0到最後一個專案的32768，值的範圍則是一致的。</span><span class="sxs-lookup"><span data-stu-id="2b806-128">The right graph provides more variation; its ramp contains values that range from 0 in the first element to 32768 in the last element, with values ranging uniformly in between.</span></span> <span data-ttu-id="2b806-129">其效果是使用此曲線的色彩元件會在顯示時顯示為靜音。</span><span class="sxs-lookup"><span data-stu-id="2b806-129">The effect is that the color component that uses this ramp appears muted on the display.</span></span> <span data-ttu-id="2b806-130">您不一定要使用線性圖形;如果您的應用程式可以視需要指派任意對應。</span><span class="sxs-lookup"><span data-stu-id="2b806-130">You are not limited to using linear graphs; if your application can assign arbitrary mapping if needed.</span></span> <span data-ttu-id="2b806-131">您甚至可以將專案設定為全零，以從顯示中完全移除色彩元件。</span><span class="sxs-lookup"><span data-stu-id="2b806-131">You can even set the entries to all zeroes to remove a color component completely from the display.</span></span>

## <a name="setting-and-retrieving-gamma-ramp-levels"></a><span data-ttu-id="2b806-132">設定和抓取 Gamma 遞增層級</span><span class="sxs-lookup"><span data-stu-id="2b806-132">Setting and Retrieving Gamma Ramp Levels</span></span>

<span data-ttu-id="2b806-133">Gamma 進階層是一種有效的查詢資料表，Direct3D 用來將框架緩衝區色彩元件對應至將顯示的新層級。</span><span class="sxs-lookup"><span data-stu-id="2b806-133">Gamma ramp levels are effectively look-up tables that Direct3D uses to map the frame buffer color components to new levels that will be displayed.</span></span> <span data-ttu-id="2b806-134">您可以藉由呼叫 [**SetGammaRamp**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-setgammaramp) 和 [**GetGammaRamp**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-getgammaramp) 方法，來設定和取出主要表面的遞增層級。</span><span class="sxs-lookup"><span data-stu-id="2b806-134">You can set and retrieve ramp levels for the primary surface by calling the [**SetGammaRamp**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-setgammaramp) and [**GetGammaRamp**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-getgammaramp) methods.</span></span> <span data-ttu-id="2b806-135">**SetGammaRamp** 接受兩個參數，而 **GetGammaRamp** 接受一個參數。</span><span class="sxs-lookup"><span data-stu-id="2b806-135">**SetGammaRamp** accepts two parameters and **GetGammaRamp** accepts one parameter.</span></span> <span data-ttu-id="2b806-136">針對 **SetGammaRamp**，第一個參數是 D3DSGR \_ 校準或 D3DSGR \_ 無 \_ 校正。</span><span class="sxs-lookup"><span data-stu-id="2b806-136">For **SetGammaRamp**, the first parameter is either D3DSGR\_CALIBRATE or D3DSGR\_NO\_CALIBRATION.</span></span> <span data-ttu-id="2b806-137">第二個參數 pRamp 是 [**D3DGAMMARAMP**](d3dgammaramp.md) 結構的指標。</span><span class="sxs-lookup"><span data-stu-id="2b806-137">The second parameter, pRamp, is a pointer to a [**D3DGAMMARAMP**](d3dgammaramp.md) structure.</span></span> <span data-ttu-id="2b806-138">**D3DGAMMARAMP** 結構包含單字的 3 256 元素陣列，每一個陣列都包含紅色、綠色和藍色的 gamma 斜坡。</span><span class="sxs-lookup"><span data-stu-id="2b806-138">The **D3DGAMMARAMP** structure contains three 256-element arrays of WORDs, one array each to contain the red, green, and blue gamma ramps.</span></span> <span data-ttu-id="2b806-139">**GetGammaRamp** 有一個參數，接受 **D3DGAMMARAMP** 類型的指標，而該指標將會填滿目前的 gamma 滑軌。</span><span class="sxs-lookup"><span data-stu-id="2b806-139">**GetGammaRamp** has one parameter that takes a pointer to a **D3DGAMMARAMP** type that will be filled with the current gamma ramp.</span></span>

<span data-ttu-id="2b806-140">您可以 \_ 針對 [**SetGammaRamp**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-setgammaramp) 的第一個參數加入 D3DSGR 校正值，以在設定新的 gamma 層級時叫用校正器。</span><span class="sxs-lookup"><span data-stu-id="2b806-140">You can include the D3DSGR\_CALIBRATE value for the first parameter of [**SetGammaRamp**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-setgammaramp) to invoke the calibrator when setting new gamma levels.</span></span> <span data-ttu-id="2b806-141">校準 gamma 的斜坡會產生一些處理額外負荷，不應經常使用。</span><span class="sxs-lookup"><span data-stu-id="2b806-141">Calibrating gamma ramps incurs some processing overhead, and should not be used frequently.</span></span> <span data-ttu-id="2b806-142">設定校準的 gamma 曲線可為使用者提供一致且絕對的 gamma 值，而不論顯示器介面卡和監視為何。</span><span class="sxs-lookup"><span data-stu-id="2b806-142">Setting a calibrated gamma ramp provides a consistent and absolute gamma value for the user, regardless of the display adapter and monitor.</span></span>

<span data-ttu-id="2b806-143">並非所有系統都支援 gamma 校正。</span><span class="sxs-lookup"><span data-stu-id="2b806-143">Not all systems support gamma calibration.</span></span> <span data-ttu-id="2b806-144">若要判斷是否支援 gamma 校正，請在方法傳回之後，呼叫 [**GetDeviceCaps**](/windows/desktop/api)，然後檢查相關聯 [**D3DCAPS9**](/windows/desktop/api/D3D9Caps/ns-d3d9caps-d3dcaps9) 結構的 Caps2 成員。</span><span class="sxs-lookup"><span data-stu-id="2b806-144">To determine if gamma calibration is supported, call [**GetDeviceCaps**](/windows/desktop/api), and examine the Caps2 member of the associated [**D3DCAPS9**](/windows/desktop/api/D3D9Caps/ns-d3d9caps-d3dcaps9) structure after the method returns.</span></span> <span data-ttu-id="2b806-145">如果有 D3DCAPS2 \_ CANCALIBRATEGAMMA 功能旗標，則支援 gamma 校正。</span><span class="sxs-lookup"><span data-stu-id="2b806-145">If the D3DCAPS2\_CANCALIBRATEGAMMA capability flag is present, then gamma calibration is supported.</span></span>

<span data-ttu-id="2b806-146">設定新的遞增層級時，請記住，只有當您的應用程式處於全螢幕專用模式時，才會使用您在陣列中設定的層級。</span><span class="sxs-lookup"><span data-stu-id="2b806-146">When setting new ramp levels, keep in mind that the levels you set in the arrays are only used when your application is in full-screen, exclusive mode.</span></span> <span data-ttu-id="2b806-147">當您的應用程式變更為一般模式時，會將遞增層級設定為在應用程式掉全螢幕模式時再次生效。</span><span class="sxs-lookup"><span data-stu-id="2b806-147">Whenever your application changes to normal mode, the ramp levels are set aside, taking effect again when the application reinstates full-screen mode.</span></span>

<span data-ttu-id="2b806-148">如果裝置在交換鏈目前的簡報模式中不支援 gamma 斜坡 (全螢幕或視窗型) ，則不會傳回錯誤值。</span><span class="sxs-lookup"><span data-stu-id="2b806-148">If the device does not support gamma ramps in the swap chain's current presentation mode (full-screen or windowed), no error value is returned.</span></span> <span data-ttu-id="2b806-149">應用程式可以 \_ \_ 在 Caps2 類型的 D3DCAPS9 成員中檢查 D3DCAPS2 FULLSCREENGAMMA 和 D3DCAPS2 CANCALIBRATEGAMMA 功能位，以判斷裝置的功能以及是否已安裝校正器。</span><span class="sxs-lookup"><span data-stu-id="2b806-149">Applications can check the D3DCAPS2\_FULLSCREENGAMMA and D3DCAPS2\_CANCALIBRATEGAMMA capability bits in the Caps2 member of the D3DCAPS9 type to determine the capabilities of the device and whether a calibrator is installed.</span></span>

## <a name="related-topics"></a><span data-ttu-id="2b806-150">相關主題</span><span class="sxs-lookup"><span data-stu-id="2b806-150">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="2b806-151">Direct3D 表面</span><span class="sxs-lookup"><span data-stu-id="2b806-151">Direct3D Surfaces</span></span>](direct3d-surfaces.md)
</dt> </dl>

 

 
