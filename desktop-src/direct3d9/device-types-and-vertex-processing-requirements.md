---
description: 頂點處理作業的效能，包括轉換和光源，主要取決於頂點緩衝區存在於記憶體中的位置，以及正在使用的轉譯裝置類型。
ms.assetid: 4f9ca83d-c9d6-4749-944d-78f831b0f44e
title: " (Direct3D 9) 的裝置類型和頂點處理需求"
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 590cf2f5423d9c3bdf3e19c91f30b3e8c0586687
ms.sourcegitcommit: a47bd86f517de76374e4fff33cfeb613eb259a7e
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/06/2021
ms.locfileid: "104510022"
---
# <a name="device-types-and-vertex-processing-requirements-direct3d-9"></a><span data-ttu-id="54d7a-103"> (Direct3D 9) 的裝置類型和頂點處理需求</span><span class="sxs-lookup"><span data-stu-id="54d7a-103">Device Types and Vertex Processing Requirements (Direct3D 9)</span></span>

<span data-ttu-id="54d7a-104">頂點處理作業的效能，包括轉換和光源，主要取決於頂點緩衝區存在於記憶體中的位置，以及正在使用的轉譯裝置類型。</span><span class="sxs-lookup"><span data-stu-id="54d7a-104">The performance of vertex processing operations, including transformation and lighting, depends heavily on where the vertex buffer exists in memory and what type of rendering device is being used.</span></span> <span data-ttu-id="54d7a-105">應用程式在建立時，會控制頂點緩衝區的記憶體配置。</span><span class="sxs-lookup"><span data-stu-id="54d7a-105">Applications control the memory allocation for vertex buffers when they are created.</span></span> <span data-ttu-id="54d7a-106">\_設定 D3DPOOL SYSTEMMEM memory 旗標時，會在系統記憶體中建立頂點緩衝區。</span><span class="sxs-lookup"><span data-stu-id="54d7a-106">When the D3DPOOL\_SYSTEMMEM memory flag is set, the vertex buffer is created in system memory.</span></span> <span data-ttu-id="54d7a-107">\_使用 D3DPOOL 預設記憶體旗標時，設備磁碟機會判斷頂點緩衝區的記憶體最適合配置的位置，通常稱為驅動程式優化的記憶體。</span><span class="sxs-lookup"><span data-stu-id="54d7a-107">When the D3DPOOL\_DEFAULT memory flag is used, the device driver determines where the memory for the vertex buffer is best allocated, often referred to as driver-optimal memory.</span></span> <span data-ttu-id="54d7a-108">驅動程式-最佳的記憶體可以是本機視訊記憶體、非本機視訊記憶體或系統記憶體。</span><span class="sxs-lookup"><span data-stu-id="54d7a-108">Driver-optimal memory can be local video memory, nonlocal video memory, or system memory.</span></span>

<span data-ttu-id="54d7a-109">\_使用 [**IDirect3DDevice9：： CREATEVERTEXBUFFER**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-createvertexbuffer)設定 D3DUSAGE SOFTWAREPROCESSING 常數可啟用頂點緩衝區資料的軟體頂點處理。</span><span class="sxs-lookup"><span data-stu-id="54d7a-109">Setting the D3DUSAGE\_SOFTWAREPROCESSING constant with [**IDirect3DDevice9::CreateVertexBuffer**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-createvertexbuffer) enables software vertex processing on the vertex buffer data.</span></span> <span data-ttu-id="54d7a-110">在混合模式中，軟體頂點處理需要此旗標。</span><span class="sxs-lookup"><span data-stu-id="54d7a-110">This flag is required for software vertex processing while in mixed mode.</span></span> <span data-ttu-id="54d7a-111">旗標不可以用於硬體頂點處理模式。</span><span class="sxs-lookup"><span data-stu-id="54d7a-111">The flag may not be used for hardware vertex processing mode.</span></span> <span data-ttu-id="54d7a-112">與軟體頂點處理搭配使用的頂點緩衝區包括下列各項：</span><span class="sxs-lookup"><span data-stu-id="54d7a-112">Vertex buffers used with software vertex processing include the following:</span></span>

-   <span data-ttu-id="54d7a-113">IDirect3DDevice9 的所有輸入資料流程 [**：:P rocessvertices**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-processvertices)。</span><span class="sxs-lookup"><span data-stu-id="54d7a-113">All input streams for [**IDirect3DDevice9::ProcessVertices**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-processvertices).</span></span>
-   <span data-ttu-id="54d7a-114">IDirect3DDevice9 的所有輸入資料流程 [**：:D rawprimitive**](/windows/desktop/api) 和 [**IDirect3DDevice9：:D rawindexedprimitive**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-drawindexedprimitive)。</span><span class="sxs-lookup"><span data-stu-id="54d7a-114">All input streams for [**IDirect3DDevice9::DrawPrimitive**](/windows/desktop/api) and [**IDirect3DDevice9::DrawIndexedPrimitive**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-drawindexedprimitive).</span></span>

<span data-ttu-id="54d7a-115">您用來判斷記憶體位置（系統或驅動程式最佳）的原因，與紋理相同。</span><span class="sxs-lookup"><span data-stu-id="54d7a-115">The reasoning you use to determine the memory location - system or driver optimal - for vertex buffers is the same as that for textures.</span></span> <span data-ttu-id="54d7a-116">當頂點緩衝區配置在驅動程式優化的記憶體中，且軟體頂點處理最適合與系統記憶體中配置的頂點緩衝區搭配使用時，硬體中的頂點處理（包括轉換和光源）效果最好。</span><span class="sxs-lookup"><span data-stu-id="54d7a-116">Vertex processing, including transformation and lighting, in hardware works best when the vertex buffers are allocated in driver-optimal memory, while software vertex processing works best with vertex buffers allocated in system memory.</span></span> <span data-ttu-id="54d7a-117">針對材質，當材質在驅動程式優化記憶體中配置時，硬體點陣化效果最好，而軟體點陣化與系統記憶體材質的效果最佳。</span><span class="sxs-lookup"><span data-stu-id="54d7a-117">For textures, hardware rasterization works best when textures are allocated in driver-optimal memory, while software rasterization works best with system-memory textures.</span></span>

<span data-ttu-id="54d7a-118">Microsoft Direct3D 9 支援對頂點的獨立處理，而不需要使用 [**IDirect3DDevice9：:P rocessvertices**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-processvertices) 方法來轉譯任何基本物件。</span><span class="sxs-lookup"><span data-stu-id="54d7a-118">Microsoft Direct3D 9 supports standalone processing of vertices, without rendering any primitive with the [**IDirect3DDevice9::ProcessVertices**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-processvertices) method.</span></span> <span data-ttu-id="54d7a-119">此獨立頂點處理一律會在主機處理器上的軟體中執行。</span><span class="sxs-lookup"><span data-stu-id="54d7a-119">This standalone vertex processing is always performed in software on the host processor.</span></span> <span data-ttu-id="54d7a-120">因此，使用 [**IDirect3DDevice9：： SetStreamSource**](/windows/desktop/api) 來設定來源的頂點緩衝區必須使用 D3DUSAGE SOFTWAREPROCESSING 旗標來建立 \_ 。</span><span class="sxs-lookup"><span data-stu-id="54d7a-120">Because of this, vertex buffers used as sources set with [**IDirect3DDevice9::SetStreamSource**](/windows/desktop/api) must be created with the D3DUSAGE\_SOFTWAREPROCESSING flag.</span></span> <span data-ttu-id="54d7a-121">**IDirect3DDevice9：:P rocessvertices** 提供的功能與 [**IDirect3DDevice9：:D rawprimitive**](/windows/desktop/api)和 IDirect3DDevice9：在使用軟體頂點處理時 [**:D rawindexedprimitive**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-drawindexedprimitive)方法相同。</span><span class="sxs-lookup"><span data-stu-id="54d7a-121">The functionality provided by **IDirect3DDevice9::ProcessVertices** is identical to that of the [**IDirect3DDevice9::DrawPrimitive**](/windows/desktop/api) and [**IDirect3DDevice9::DrawIndexedPrimitive**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-drawindexedprimitive) methods while using software vertex processing.</span></span>

<span data-ttu-id="54d7a-122">如果您的應用程式會執行自己的頂點處理，並將轉換、發亮和裁剪的頂點傳遞給轉譯方法，則應用程式可以直接將頂點寫入至驅動程式優化記憶體中所配置的頂點緩衝區。</span><span class="sxs-lookup"><span data-stu-id="54d7a-122">If your application performs its own vertex processing and passes transformed, lit, and clipped vertices to rendering methods, then the application can directly write vertices to a vertex buffer allocated in driver-optimal memory.</span></span> <span data-ttu-id="54d7a-123">這項技術會防止稍後的冗餘複製作業。</span><span class="sxs-lookup"><span data-stu-id="54d7a-123">This technique prevents a redundant copy operation later.</span></span> <span data-ttu-id="54d7a-124">請注意，如果您的應用程式從頂點緩衝區讀取資料，這項技術將無法正常運作，因為主機從驅動程式優化記憶體完成的讀取作業可能會非常緩慢。</span><span class="sxs-lookup"><span data-stu-id="54d7a-124">Note that this technique will not work well if your application reads data back from a vertex buffer, because read operations done by the host from driver-optimal memory can be very slow.</span></span> <span data-ttu-id="54d7a-125">因此，如果您的應用程式在處理過程中需要讀取，或將資料寫入緩衝區時，系統記憶體的頂點緩衝區是較佳的選擇。</span><span class="sxs-lookup"><span data-stu-id="54d7a-125">Therefore, if your application needs to read during processing or writes data to the buffer erratically, a system-memory vertex buffer is a better choice.</span></span>

<span data-ttu-id="54d7a-126">使用 Direct3D 頂點處理功能 (藉由將未轉換頂點傳遞給頂點緩衝區轉譯方法) ，視裝置類型和裝置建立旗標而定，可能會在硬體或軟體中進行處理。</span><span class="sxs-lookup"><span data-stu-id="54d7a-126">When using the Direct3D vertex processing features (by passing untransformed vertices to vertex-buffer rendering methods), processing can occur in either hardware or software depending on the device type and device creation flags.</span></span> <span data-ttu-id="54d7a-127">建議將頂點緩衝區配置在集區 D3DPOOL \_ 預設值，以在幾乎所有情況下獲得最佳效能。</span><span class="sxs-lookup"><span data-stu-id="54d7a-127">It is recommended that vertex buffers be allocated in pool D3DPOOL\_DEFAULT for best performance in virtually all cases.</span></span> <span data-ttu-id="54d7a-128">當裝置使用硬體頂點處理時，有一些額外的優化可能會根據旗標 D3DUSAGE \_ DYNAMIC 和 D3DUSAGE WRITEONLY 來完成 \_ 。</span><span class="sxs-lookup"><span data-stu-id="54d7a-128">When a device is using hardware vertex processing, there are a number of additional optimizations that may be done based on the flags D3DUSAGE\_DYNAMIC and D3DUSAGE\_WRITEONLY.</span></span> <span data-ttu-id="54d7a-129">如需有關使用這些旗標的詳細資訊，請參閱 IDirect3DDevice9：： CreateVertexBuffer。</span><span class="sxs-lookup"><span data-stu-id="54d7a-129">See IDirect3DDevice9::CreateVertexBuffer for more information about using these flags.</span></span>

## <a name="related-topics"></a><span data-ttu-id="54d7a-130">相關主題</span><span class="sxs-lookup"><span data-stu-id="54d7a-130">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="54d7a-131">頂點緩衝區</span><span class="sxs-lookup"><span data-stu-id="54d7a-131">Vertex Buffers</span></span>](vertex-buffers.md)
</dt> </dl>

 

 
