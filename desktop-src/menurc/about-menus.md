---
title: 關於功能表
description: 本主題討論功能表。
ms.assetid: fd0b26f1-93cd-421b-9097-8502ab7681e9
keywords:
- 資源、功能表
- 功能表，關於
- 分
- 功能表列
- 最上層功能表
- 快顯功能表
- 下拉式功能表
- 功能表、最上層
- 功能表、快顯視窗
- 功能表、下拉式清單
- 功能表名稱
- 功能表、快捷方式
- 功能表、視窗
- 功能表、系統
- 功能表、控制項
- 捷徑功能表
- 視窗功能表
- 系統功能表
- 控制功能表
- 說明識別碼
- 功能表控點
- 功能表項目
- 命令專案
- 功能表項目識別碼
- 功能表項目位置
- 選取功能表項目
- 清除功能表項目
- 擁有者繪製功能表
- 功能表，已繪製的擁有者
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: ed5d42eb42aaaaa16eef0b5b118adcfe0f91156e
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/19/2020
ms.locfileid: "104375108"
---
# <a name="about-menus"></a><span data-ttu-id="9e5bc-132">關於功能表</span><span class="sxs-lookup"><span data-stu-id="9e5bc-132">About Menus</span></span>

<span data-ttu-id="9e5bc-133">*功能表* 是指定選項或選項群組的專案清單， (應用程式的子功能表) 。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-133">A *menu* is a list of items that specify options or groups of options (a submenu) for an application.</span></span> <span data-ttu-id="9e5bc-134">按一下功能表項目會開啟子功能表，或讓應用程式執行命令。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-134">Clicking a menu item opens a submenu or causes the application to carry out a command.</span></span> <span data-ttu-id="9e5bc-135">本節提供下列主題的相關資訊：</span><span class="sxs-lookup"><span data-stu-id="9e5bc-135">This section provides information on the following topics:</span></span>

-   [<span data-ttu-id="9e5bc-136">功能表列和功能表</span><span class="sxs-lookup"><span data-stu-id="9e5bc-136">Menu Bars and Menus</span></span>](#menu-bars-and-menus)
    -   [<span data-ttu-id="9e5bc-137">快速鍵功能表</span><span class="sxs-lookup"><span data-stu-id="9e5bc-137">Shortcut Menus</span></span>](#shortcut-menus)
    -   [<span data-ttu-id="9e5bc-138">視窗功能表</span><span class="sxs-lookup"><span data-stu-id="9e5bc-138">The Window Menu</span></span>](#the-window-menu)
    -   [<span data-ttu-id="9e5bc-139">說明識別碼</span><span class="sxs-lookup"><span data-stu-id="9e5bc-139">Help Identifier</span></span>](#help-identifier)
-   [<span data-ttu-id="9e5bc-140">鍵盤存取功能表</span><span class="sxs-lookup"><span data-stu-id="9e5bc-140">Keyboard Access to Menus</span></span>](#keyboard-access-to-menus)
    -   [<span data-ttu-id="9e5bc-141">標準鍵盤介面</span><span class="sxs-lookup"><span data-stu-id="9e5bc-141">Standard Keyboard Interface</span></span>](#standard-keyboard-interface)
    -   [<span data-ttu-id="9e5bc-142">功能表存取金鑰</span><span class="sxs-lookup"><span data-stu-id="9e5bc-142">Menu Access Keys</span></span>](#menu-access-keys)
    -   [<span data-ttu-id="9e5bc-143">功能表快速鍵</span><span class="sxs-lookup"><span data-stu-id="9e5bc-143">Menu Shortcut Keys</span></span>](#menu-shortcut-keys)
-   [<span data-ttu-id="9e5bc-144">功能表建立</span><span class="sxs-lookup"><span data-stu-id="9e5bc-144">Menu Creation</span></span>](#menu-creation)
    -   [<span data-ttu-id="9e5bc-145">功能表範本資源</span><span class="sxs-lookup"><span data-stu-id="9e5bc-145">Menu Template Resources</span></span>](#menu-template-resources)
    -   [<span data-ttu-id="9e5bc-146">記憶體中的功能表範本</span><span class="sxs-lookup"><span data-stu-id="9e5bc-146">Menu Template in Memory</span></span>](#menu-template-in-memory)
    -   [<span data-ttu-id="9e5bc-147">功能表控點</span><span class="sxs-lookup"><span data-stu-id="9e5bc-147">Menu Handles</span></span>](#menu-handles)
    -   [<span data-ttu-id="9e5bc-148">功能表建立功能</span><span class="sxs-lookup"><span data-stu-id="9e5bc-148">Menu Creation Functions</span></span>](#menu-creation-functions)
    -   [<span data-ttu-id="9e5bc-149">功能表顯示</span><span class="sxs-lookup"><span data-stu-id="9e5bc-149">Menu Display</span></span>](#menu-display)
    -   [<span data-ttu-id="9e5bc-150">視窗類別功能表</span><span class="sxs-lookup"><span data-stu-id="9e5bc-150">Window Class Menus</span></span>](#window-class-menus)
-   [<span data-ttu-id="9e5bc-151">功能表項目</span><span class="sxs-lookup"><span data-stu-id="9e5bc-151">Menu Items</span></span>](#menu-items)
    -   [<span data-ttu-id="9e5bc-152">開啟子功能表的命令專案和專案</span><span class="sxs-lookup"><span data-stu-id="9e5bc-152">Command Items and Items that Open Submenus</span></span>](#command-items-and-items-that-open-submenus)
    -   [<span data-ttu-id="9e5bc-153">功能表項目識別碼</span><span class="sxs-lookup"><span data-stu-id="9e5bc-153">Menu-Item Identifier</span></span>](#menu-item-identifier)
    -   [<span data-ttu-id="9e5bc-154">功能表項目位置</span><span class="sxs-lookup"><span data-stu-id="9e5bc-154">Menu-Item Position</span></span>](#menu-item-position)
    -   [<span data-ttu-id="9e5bc-155">以程式設計方式存取功能表項目</span><span class="sxs-lookup"><span data-stu-id="9e5bc-155">Accessing Menu Items Programmatically</span></span>](#accessing-menu-items-programmatically)
    -   [<span data-ttu-id="9e5bc-156">預設功能表項目</span><span class="sxs-lookup"><span data-stu-id="9e5bc-156">Default Menu Items</span></span>](#default-menu-items)
    -   [<span data-ttu-id="9e5bc-157">選取和清除功能表項目</span><span class="sxs-lookup"><span data-stu-id="9e5bc-157">Selected and Clear Menu Items</span></span>](#selected-and-clear-menu-items)
    -   [<span data-ttu-id="9e5bc-158">啟用、灰色和停用的功能表項目</span><span class="sxs-lookup"><span data-stu-id="9e5bc-158">Enabled, Grayed, and Disabled Menu Items</span></span>](#enabled-grayed-and-disabled-menu-items)
    -   [<span data-ttu-id="9e5bc-159">反白顯示的功能表項目</span><span class="sxs-lookup"><span data-stu-id="9e5bc-159">Highlighted Menu Items</span></span>](#highlighted-menu-items)
    -   [<span data-ttu-id="9e5bc-160">擁有者繪製的功能表項目</span><span class="sxs-lookup"><span data-stu-id="9e5bc-160">Owner-Drawn Menu Items</span></span>](#owner-drawn-menu-items)
    -   [<span data-ttu-id="9e5bc-161">功能表項目分隔符號和分行符號號</span><span class="sxs-lookup"><span data-stu-id="9e5bc-161">Menu Item Separators and Line Breaks</span></span>](#menu-item-separators-and-line-breaks)
-   [<span data-ttu-id="9e5bc-162">搭配功能表使用的訊息</span><span class="sxs-lookup"><span data-stu-id="9e5bc-162">Messages Used with Menus</span></span>](#messages-used-with-menus)
-   [<span data-ttu-id="9e5bc-163">功能表損毀</span><span class="sxs-lookup"><span data-stu-id="9e5bc-163">Menu Destruction</span></span>](#menu-destruction)

## <a name="menu-bars-and-menus"></a><span data-ttu-id="9e5bc-164">功能表列和功能表</span><span class="sxs-lookup"><span data-stu-id="9e5bc-164">Menu Bars and Menus</span></span>

<span data-ttu-id="9e5bc-165">功能表會排列在階層中。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-165">A menu is arranged in a hierarchy.</span></span> <span data-ttu-id="9e5bc-166">階層的最上層是 *功能表列*;其中包含功能表的清單，這些 *功能表* 中也可以包含 *子* 功能表。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-166">At the top level of the hierarchy is the *menu bar*; which contains a list of *menus*, which in turn can contain *submenus*.</span></span> <span data-ttu-id="9e5bc-167">功能表列有時候稱為 *最上層功能表*，功能表和子功能表也稱為 *快捷* 功能表。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-167">A menu bar is sometimes called a *top-level menu*, and the menus and submenus are also known as *pop-up menus*.</span></span>

<span data-ttu-id="9e5bc-168">功能表項目可以執行命令或開啟子功能表。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-168">A menu item can either carry out a command or open a submenu.</span></span> <span data-ttu-id="9e5bc-169">執行命令的專案稱為 *命令專案* 或 *命令*。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-169">An item that carries out a command is called a *command item* or a *command*.</span></span>

<span data-ttu-id="9e5bc-170">功能表列上的專案幾乎一律會開啟功能表。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-170">An item on the menu bar almost always opens a menu.</span></span> <span data-ttu-id="9e5bc-171">功能表列很少包含命令專案。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-171">Menu bars rarely contain command items.</span></span> <span data-ttu-id="9e5bc-172">從功能表列開啟的功能表會從功能表列下拉，有時也稱為 *下拉式功能表*。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-172">A menu opened from the menu bar drops down from the menu bar and is sometimes called a *drop-down menu*.</span></span> <span data-ttu-id="9e5bc-173">出現下拉式功能表時，它會附加至功能表列。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-173">When a drop-down menu is displayed, it is attached to the menu bar.</span></span> <span data-ttu-id="9e5bc-174">功能表列上開啟下拉式功能表的功能表項目也稱為 *功能表名稱*。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-174">A menu item on the menu bar that opens a drop-down menu is also called a *menu name*.</span></span>

<span data-ttu-id="9e5bc-175">功能表列上的功能表名稱代表應用程式所提供的主要命令類別。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-175">The menu names on a menu bar represent the main categories of commands that an application provides.</span></span> <span data-ttu-id="9e5bc-176">從功能表列選取功能表名稱通常會開啟功能表，其功能表項目對應至類別中的命令。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-176">Selecting a menu name from the menu bar typically opens a menu whose menu items correspond to the commands in a category.</span></span> <span data-ttu-id="9e5bc-177">例如，當使用者按下功能表列時，可能會包含 [檔案 **] 功能表名稱** ，並以功能表項目（例如 [ **新增**]、[ **開啟**] 和 [ **儲存**]）來啟用功能表。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-177">For example, a menu bar might contain a **File** menu name that, when clicked by the user, activates a menu with menu items such as **New**, **Open**, and **Save**.</span></span> <span data-ttu-id="9e5bc-178">若要取得功能表列的相關資訊，請呼叫 [**GetMenuBarInfo**](/windows/desktop/api/Winuser/nf-winuser-getmenubarinfo)。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-178">To get information about a menu bar, call [**GetMenuBarInfo**](/windows/desktop/api/Winuser/nf-winuser-getmenubarinfo).</span></span>

<span data-ttu-id="9e5bc-179">只有重迭或快顯視窗可以包含功能表列;子視窗不可包含一個。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-179">Only an overlapped or pop-up window can contain a menu bar; a child window cannot contain one.</span></span> <span data-ttu-id="9e5bc-180">如果視窗有標題列，系統就會將功能表列放在其下方。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-180">If the window has a title bar, the system positions the menu bar just below it.</span></span> <span data-ttu-id="9e5bc-181">功能表列一律可見。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-181">A menu bar is always visible.</span></span> <span data-ttu-id="9e5bc-182">不過，在使用者選取啟動它的功能表項目之前，並不會顯示子功能表。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-182">A submenu is not visible, however, until the user selects a menu item that activates it.</span></span> <span data-ttu-id="9e5bc-183">如需重迭和快顯視窗的詳細資訊，請參閱 [視窗類型](/windows/desktop/winmsg/window-features)。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-183">For more information about overlapped and pop-up windows, see [Window Types](/windows/desktop/winmsg/window-features).</span></span>

<span data-ttu-id="9e5bc-184">每個功能表都必須有擁有者視窗。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-184">Each menu must have an owner window.</span></span> <span data-ttu-id="9e5bc-185">當使用者選取功能表或從功能表中選擇專案時，系統會將訊息傳送至功能表的擁有者視窗。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-185">The system sends messages to a menu's owner window when the user selects the menu or chooses an item from the menu.</span></span>

<span data-ttu-id="9e5bc-186">本節將討論下列主題。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-186">This section discusses the following topics.</span></span>

-   [<span data-ttu-id="9e5bc-187">快速鍵功能表</span><span class="sxs-lookup"><span data-stu-id="9e5bc-187">Shortcut Menus</span></span>](#shortcut-menus)
-   [<span data-ttu-id="9e5bc-188">視窗功能表</span><span class="sxs-lookup"><span data-stu-id="9e5bc-188">The Window Menu</span></span>](#the-window-menu)
-   [<span data-ttu-id="9e5bc-189">說明識別碼</span><span class="sxs-lookup"><span data-stu-id="9e5bc-189">Help Identifier</span></span>](#help-identifier)

### <a name="shortcut-menus"></a><span data-ttu-id="9e5bc-190">快顯功能表</span><span class="sxs-lookup"><span data-stu-id="9e5bc-190">Shortcut Menus</span></span>

<span data-ttu-id="9e5bc-191">系統也會提供 *快捷方式功能表*。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-191">The system also provides *shortcut menus*.</span></span> <span data-ttu-id="9e5bc-192">快捷方式功能表未附加至功能表列;它可以出現在螢幕上的任何位置。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-192">A shortcut menu is not attached to the menu bar; it can appear anywhere on the screen.</span></span> <span data-ttu-id="9e5bc-193">應用程式通常會建立快捷方式功能表與視窗的一部分（例如，工作區）或特定物件（例如圖示）的關聯。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-193">An application typically associates a shortcut menu with a portion of a window, such as the client area, or with a specific object, such as an icon.</span></span> <span data-ttu-id="9e5bc-194">基於這個理由，這些功能表也稱為 *快顯功能表*。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-194">For this reason, these menus are also called *context menus*.</span></span>

<span data-ttu-id="9e5bc-195">在使用者啟動之前，快捷方式功能表會保持隱藏狀態，通常是以滑鼠右鍵按一下選取範圍、工具列或工作列按鈕。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-195">A shortcut menu remains hidden until the user activates it, typically by right-clicking a selection, a toolbar, or a taskbar button.</span></span> <span data-ttu-id="9e5bc-196">功能表通常會顯示在插入號或滑鼠游標的位置。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-196">The menu is usually displayed at the position of the caret or mouse cursor.</span></span>

### <a name="the-window-menu"></a><span data-ttu-id="9e5bc-197">視窗功能表</span><span class="sxs-lookup"><span data-stu-id="9e5bc-197">The Window Menu</span></span>

<span data-ttu-id="9e5bc-198">[ **視窗]** 功能表 (也稱為 [ **系統** ] 功能表或 [ **控制** ] 功能表) 是由作業系統所定義和管理的快顯功能表。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-198">The **Window** menu (also known as the **System** menu or **Control** menu) is a pop-up menu defined and managed almost exclusively by the operating system.</span></span> <span data-ttu-id="9e5bc-199">使用者可以按一下標題列上的 [應用程式] 圖示，或是以滑鼠右鍵按一下標題列上的任何位置，來開啟 [視窗] 功能表。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-199">The user can open the window menu by clicking the application icon on the title bar or by right-clicking anywhere on the title bar.</span></span>

<span data-ttu-id="9e5bc-200">[ **視窗]** 功能表提供一組標準的功能表項目，讓使用者可以選擇變更視窗的大小或位置，或關閉應用程式。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-200">The **Window** menu provides a standard set of menu items that the user can choose to change a window's size or position, or close the application.</span></span> <span data-ttu-id="9e5bc-201">您可以新增、刪除及修改 [視窗] 功能表上的專案，但大部分的應用程式只會使用一組標準的功能表項目。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-201">Items on the window menu can be added, deleted, and modified, but most applications just use the standard set of menu items.</span></span> <span data-ttu-id="9e5bc-202">重迭、快顯視窗或子視窗可以有視窗功能表。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-202">An overlapped, pop-up, or child window can have a window menu.</span></span> <span data-ttu-id="9e5bc-203">重迭或快顯視窗不會包含視窗功能表的情況很常見。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-203">It is uncommon for an overlapped or pop-up window not to include a window menu.</span></span>

<span data-ttu-id="9e5bc-204">當使用者從 [ **視窗]** 功能表選擇命令時，系統會將 [**WM \_ SYSCOMMAND**](wm-syscommand.md) 訊息傳送至功能表的擁有者視窗。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-204">When the user chooses a command from the **Window** menu, the system sends a [**WM\_SYSCOMMAND**](wm-syscommand.md) message to the menu's owner window.</span></span> <span data-ttu-id="9e5bc-205">在大部分的應用程式中，視窗程式都不會處理來自 [視窗] 功能表的訊息。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-205">In most applications, the window procedure does not process messages from the window menu.</span></span> <span data-ttu-id="9e5bc-206">相反地，它只會將訊息傳遞至 [**DefWindowProc**](/windows/desktop/api/winuser/nf-winuser-defwindowproca) 函式，以進行訊息的系統預設處理。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-206">Instead, it simply passes the messages to the [**DefWindowProc**](/windows/desktop/api/winuser/nf-winuser-defwindowproca) function for system-default processing of the message.</span></span> <span data-ttu-id="9e5bc-207">如果應用程式將命令新增至 [視窗] 功能表，則視窗程式必須處理命令。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-207">If an application adds a command to the window menu, the window procedure must process the command.</span></span>

<span data-ttu-id="9e5bc-208">應用程式可以使用 [**GetSystemMenu**](/windows/desktop/api/Winuser/nf-winuser-getsystemmenu) 函式來建立要修改之預設視窗功能表的複本。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-208">An application can use the [**GetSystemMenu**](/windows/desktop/api/Winuser/nf-winuser-getsystemmenu) function to create a copy of the default window menu to modify.</span></span> <span data-ttu-id="9e5bc-209">任何未使用 **GetSystemMenu** 函式來建立它自己的視窗功能表複本的視窗，都會收到標準的視窗功能表。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-209">Any window that does not use the **GetSystemMenu** function to make its own copy of the window menu receives the standard window menu.</span></span>

### <a name="help-identifier"></a><span data-ttu-id="9e5bc-210">說明識別碼</span><span class="sxs-lookup"><span data-stu-id="9e5bc-210">Help Identifier</span></span>

<span data-ttu-id="9e5bc-211">與每個功能表列、功能表、子功能表和快捷方式功能表相關聯的是說明識別碼。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-211">Associated with each menu bar, menu, submenu, and shortcut menu is a help identifier.</span></span> <span data-ttu-id="9e5bc-212">如果使用者在功能表為使用中時按 F1 鍵，則會將此值傳送至擁有者視窗作為 WM 說明 [**訊息 \_**](../shell/wm-help.md) 的一部分。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-212">If the user presses the F1 key while the menu is active, this value is sent to the owner window as part of a [**WM\_HELP**](../shell/wm-help.md) message.</span></span>

## <a name="keyboard-access-to-menus"></a><span data-ttu-id="9e5bc-213">鍵盤存取功能表</span><span class="sxs-lookup"><span data-stu-id="9e5bc-213">Keyboard Access to Menus</span></span>

<span data-ttu-id="9e5bc-214">系統會提供功能表的標準鍵盤介面。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-214">The system provides a standard keyboard interface for menus.</span></span> <span data-ttu-id="9e5bc-215">您可以針對功能表項目，提供助憶鍵存取金鑰和快捷方式 (加速器) 機碼，以增強這個介面。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-215">You can enhance this interface by providing mnemonic access keys and shortcut (accelerator) keys for your menu items.</span></span>

<span data-ttu-id="9e5bc-216">下列主題描述標準鍵盤介面、存取金鑰和快速鍵：</span><span class="sxs-lookup"><span data-stu-id="9e5bc-216">The following topics describe the standard keyboard interface, access keys, and shortcut keys:</span></span>

-   [<span data-ttu-id="9e5bc-217">標準鍵盤介面</span><span class="sxs-lookup"><span data-stu-id="9e5bc-217">Standard Keyboard Interface</span></span>](#standard-keyboard-interface)
-   [<span data-ttu-id="9e5bc-218">功能表存取金鑰</span><span class="sxs-lookup"><span data-stu-id="9e5bc-218">Menu Access Keys</span></span>](#menu-access-keys)
-   [<span data-ttu-id="9e5bc-219">功能表快速鍵</span><span class="sxs-lookup"><span data-stu-id="9e5bc-219">Menu Shortcut Keys</span></span>](#menu-shortcut-keys)

### <a name="standard-keyboard-interface"></a><span data-ttu-id="9e5bc-220">標準鍵盤介面</span><span class="sxs-lookup"><span data-stu-id="9e5bc-220">Standard Keyboard Interface</span></span>

<span data-ttu-id="9e5bc-221">系統是設計來使用或不使用滑鼠或其他指標裝置。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-221">The system is designed to work with or without a mouse or other pointing device.</span></span> <span data-ttu-id="9e5bc-222">由於系統提供標準鍵盤介面，因此使用者可以使用鍵盤來選取功能表項目。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-222">Because the system provides a standard keyboard interface, the user can use the keyboard to select menu items.</span></span> <span data-ttu-id="9e5bc-223">這個鍵盤介面不需要特殊的程式碼。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-223">This keyboard interface does not need special code.</span></span> <span data-ttu-id="9e5bc-224">應用程式會收到命令訊息，指出使用者是透過鍵盤或使用滑鼠選取功能表項目。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-224">An application receives a command message whether the user selects a menu item through the keyboard or by using a mouse.</span></span> <span data-ttu-id="9e5bc-225">標準鍵盤介面會處理下列按鍵。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-225">The standard keyboard interface processes the following keystrokes.</span></span>



| <span data-ttu-id="9e5bc-226">按鍵</span><span class="sxs-lookup"><span data-stu-id="9e5bc-226">Keystroke</span></span>              | <span data-ttu-id="9e5bc-227">動作</span><span class="sxs-lookup"><span data-stu-id="9e5bc-227">Action</span></span>                                                                                                                                                                                                                                   |
|------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="9e5bc-228">字母字元</span><span class="sxs-lookup"><span data-stu-id="9e5bc-228">Alphabetical character</span></span> | <span data-ttu-id="9e5bc-229">選取具有指定字元作為其存取金鑰的第一個功能表項目。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-229">Selects the first menu item with the specified character as its access key.</span></span> <span data-ttu-id="9e5bc-230">如果選取的專案叫用功能表，就會顯示功能表，並反白顯示第一個專案。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-230">If the selected item invokes a menu, the menu is displayed and the first item is highlighted.</span></span> <span data-ttu-id="9e5bc-231">否則，就會選擇功能表項目。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-231">Otherwise, the menu item is chosen.</span></span>                            |
| <span data-ttu-id="9e5bc-232">ALT</span><span class="sxs-lookup"><span data-stu-id="9e5bc-232">ALT</span></span>                    | <span data-ttu-id="9e5bc-233">切換開啟和離開功能表列模式。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-233">Toggles in and out of menu bar mode.</span></span>                                                                                                                                                                                                     |
| <span data-ttu-id="9e5bc-234">ALT 鍵 + 空格鍵</span><span class="sxs-lookup"><span data-stu-id="9e5bc-234">ALT+SPACEBAR</span></span>           | <span data-ttu-id="9e5bc-235">顯示視窗功能表。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-235">Displays the window menu.</span></span>                                                                                                                                                                                                                |
| <span data-ttu-id="9e5bc-236">ENTER</span><span class="sxs-lookup"><span data-stu-id="9e5bc-236">ENTER</span></span>                  | <span data-ttu-id="9e5bc-237">啟用功能表，並選取第一個功能表項目（如果專案有相關聯的功能表項目）。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-237">Activates a menu and selects the first menu item if an item has a menu associated with it.</span></span> <span data-ttu-id="9e5bc-238">否則，此按鍵會選擇專案，就像在選取專案時，使用者放開滑鼠按鍵一樣。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-238">Otherwise, this keystroke chooses the item as if the user released the mouse button while the item was selected.</span></span>                              |
| <span data-ttu-id="9e5bc-239">ESC</span><span class="sxs-lookup"><span data-stu-id="9e5bc-239">ESC</span></span>                    | <span data-ttu-id="9e5bc-240">離開功能表模式。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-240">Exits menu mode.</span></span>                                                                                                                                                                                                                         |
| <span data-ttu-id="9e5bc-241">向左鍵</span><span class="sxs-lookup"><span data-stu-id="9e5bc-241">LEFT ARROW</span></span>             | <span data-ttu-id="9e5bc-242">迴圈至先前的最上層功能表項目。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-242">Cycles to the previous top-level menu item.</span></span> <span data-ttu-id="9e5bc-243">最上層功能表項目包括功能表名稱和 [視窗] 功能表。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-243">Top-level menu items include menu names and the window menu.</span></span> <span data-ttu-id="9e5bc-244">如果選取的專案位於功能表中，則會選取功能表中的上一個資料行，或選取先前的最上層功能表項目。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-244">If the selected item is in a menu, the previous column in the menu is selected or the previous top-level menu item is selected.</span></span> |
| <span data-ttu-id="9e5bc-245">向右鍵</span><span class="sxs-lookup"><span data-stu-id="9e5bc-245">RIGHT ARROW</span></span>            | <span data-ttu-id="9e5bc-246">的運作方式與向左箭號不同，但方向相反。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-246">Works like the LEFT ARROW key, except in the opposite direction.</span></span> <span data-ttu-id="9e5bc-247">在功能表中，此按鍵會向前移動一個資料行;當目前選取的專案位於最右側的資料行時，就會選取下一個功能表。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-247">In menus, this keystroke moves forward one column; when the currently selected item is in the far-right column, the next menu is selected.</span></span>                              |
| <span data-ttu-id="9e5bc-248">向上鍵或向下鍵</span><span class="sxs-lookup"><span data-stu-id="9e5bc-248">UP or DOWN ARROWS</span></span>      | <span data-ttu-id="9e5bc-249">當您按下功能表名稱時，會啟用功能表。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-249">Activates a menu when pressed in a menu name.</span></span> <span data-ttu-id="9e5bc-250">在功能表中按下時，向上箭號鍵會選取前一個專案;向下鍵會選取下一個專案。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-250">When pressed in a menu, the UP ARROW keystroke selects the previous item; the DOWN ARROW keystroke selects the next item.</span></span>                                                                  |



 

### <a name="menu-access-keys"></a><span data-ttu-id="9e5bc-251">功能表存取金鑰</span><span class="sxs-lookup"><span data-stu-id="9e5bc-251">Menu Access Keys</span></span>

<span data-ttu-id="9e5bc-252">您可以將存取金鑰 (助憶鍵) 至功能表項目，以增強功能表的標準鍵盤介面。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-252">The standard keyboard interface for menus can be enhanced by adding access keys (mnemonics) to menu items.</span></span> <span data-ttu-id="9e5bc-253">存取金鑰是功能表項目文字中的加底線字母。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-253">An access key is an underlined letter in the text of a menu item.</span></span> <span data-ttu-id="9e5bc-254">當功能表為使用中時，使用者可以按下對應至專案加底線字母的按鍵來選取功能表項目。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-254">When a menu is active, the user can select a menu item by pressing the key that corresponds to the item's underlined letter.</span></span> <span data-ttu-id="9e5bc-255">使用者會按下 ALT 鍵來反白顯示功能表列上的第一個專案，讓功能表列成為使用中狀態。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-255">The user makes the menu bar active by pressing the ALT key to highlight the first item on the menu bar.</span></span> <span data-ttu-id="9e5bc-256">功能表在顯示時為使用中狀態。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-256">A menu is active when it is displayed.</span></span>

<span data-ttu-id="9e5bc-257">若要建立功能表項目的存取金鑰，請在專案文字字串中的任何字元前面加上連字號。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-257">To create an access key for a menu item, precede any character in the item's text string with an ampersand.</span></span> <span data-ttu-id="9e5bc-258">例如，文字字串 "&Move" 會導致系統將字母 "M" 加上底線。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-258">For example, the text string "&Move" causes the system to underline the letter "M".</span></span>

### <a name="menu-shortcut-keys"></a><span data-ttu-id="9e5bc-259">功能表快速鍵</span><span class="sxs-lookup"><span data-stu-id="9e5bc-259">Menu Shortcut Keys</span></span>

<span data-ttu-id="9e5bc-260">除了具有便捷鍵之外，功能表項目也可以有相關聯的快速鍵。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-260">In addition to having an access key, a menu item can have a shortcut key associated with it.</span></span> <span data-ttu-id="9e5bc-261">快速鍵與存取金鑰不同，因為功能表不需要使用中，快速鍵才能運作。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-261">A shortcut key is different from an access key, because the menu does not have to be active for the shortcut key to work.</span></span> <span data-ttu-id="9e5bc-262">此外，便捷鍵 *一律* 會與功能表項目相關聯，而快速鍵 *通常* 是 (，但不需要) 與功能表項目相關聯。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-262">Also, an access key is *always* associated with a menu item, while an shortcut key is *usually* (but does not have to be) associated with a menu item.</span></span>

<span data-ttu-id="9e5bc-263">識別快速鍵的文字會加入至功能表項目文字字串。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-263">Text that identifies the shortcut key is added to the menu-item text string.</span></span> <span data-ttu-id="9e5bc-264">快速鍵文字會出現在功能表項目名稱右邊，反斜線和定位字元 (\\ t) 。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-264">The shortcut text appears to the right of the menu item name, after a backslash and tab character (\\t).</span></span> <span data-ttu-id="9e5bc-265">例如，"&Close \\ tAlt + f4" 代表 Close 命令，其中 ALT + F4 按鍵組合作為其快速鍵，並以字母 "C" 作為其存取金鑰。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-265">For example, "&Close\\tAlt+F4" represents a Close command with the ALT+F4 key combination as its shortcut key and with the letter "C" as its access key.</span></span> <span data-ttu-id="9e5bc-266">如需詳細資訊，請參閱 [鍵盤快捷](keyboard-accelerators.md)。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-266">For more information, see [Keyboard Accelerators](keyboard-accelerators.md).</span></span>

## <a name="menu-creation"></a><span data-ttu-id="9e5bc-267">功能表建立</span><span class="sxs-lookup"><span data-stu-id="9e5bc-267">Menu Creation</span></span>

<span data-ttu-id="9e5bc-268">您可以使用功能表範本或功能表建立功能來建立功能表。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-268">You can create a menu using either a menu template or menu creation functions.</span></span> <span data-ttu-id="9e5bc-269">功能表範本通常定義為資源。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-269">Menu templates are typically defined as resources.</span></span> <span data-ttu-id="9e5bc-270">功能表-範本資源可以明確地載入，或指派為視窗類別的預設功能表。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-270">Menu-template resources can be loaded explicitly or assigned as the default menu for a window class.</span></span> <span data-ttu-id="9e5bc-271">您也可以在記憶體中動態建立功能表範本資源。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-271">You can also create menu-template resources dynamically in memory.</span></span>

<span data-ttu-id="9e5bc-272">下列主題將詳細說明功能表建立：</span><span class="sxs-lookup"><span data-stu-id="9e5bc-272">The following topics describe menu creation in detail:</span></span>

-   [<span data-ttu-id="9e5bc-273">功能表範本資源</span><span class="sxs-lookup"><span data-stu-id="9e5bc-273">Menu Template Resources</span></span>](#menu-template-resources)
-   [<span data-ttu-id="9e5bc-274">記憶體中的功能表範本</span><span class="sxs-lookup"><span data-stu-id="9e5bc-274">Menu Template in Memory</span></span>](#menu-template-in-memory)
-   [<span data-ttu-id="9e5bc-275">功能表控點</span><span class="sxs-lookup"><span data-stu-id="9e5bc-275">Menu Handles</span></span>](#menu-handles)
-   [<span data-ttu-id="9e5bc-276">功能表建立功能</span><span class="sxs-lookup"><span data-stu-id="9e5bc-276">Menu Creation Functions</span></span>](#menu-creation-functions)
-   [<span data-ttu-id="9e5bc-277">功能表顯示</span><span class="sxs-lookup"><span data-stu-id="9e5bc-277">Menu Display</span></span>](#menu-display)
-   [<span data-ttu-id="9e5bc-278">視窗類別功能表</span><span class="sxs-lookup"><span data-stu-id="9e5bc-278">Window Class Menus</span></span>](#window-class-menus)

### <a name="menu-template-resources"></a><span data-ttu-id="9e5bc-279">功能表範本資源</span><span class="sxs-lookup"><span data-stu-id="9e5bc-279">Menu Template Resources</span></span>

<span data-ttu-id="9e5bc-280">大部分的應用程式會使用功能表範本資源建立功能表。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-280">Most applications create menus using menu-template resources.</span></span> <span data-ttu-id="9e5bc-281">*功能表範本* 會定義功能表，包括功能表列中的專案和所有功能表。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-281">A *menu template* defines a menu, including the items in the menu bar and all menus.</span></span> <span data-ttu-id="9e5bc-282">如需建立功能表範本資源的詳細資訊，請參閱您的開發工具隨附的檔。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-282">For information about creating a menu-template resource, see the documentation included with your development tools.</span></span>

<span data-ttu-id="9e5bc-283">建立功能表範本資源並將它加入至應用程式的可執行檔 ( .exe) 檔案之後，您可以使用 [**LoadMenu**](/windows/desktop/api/Winuser/nf-winuser-loadmenua) 函式將資源載入記憶體中。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-283">After you create a menu-template resource and add it to your application's executable (.exe) file, you can use the [**LoadMenu**](/windows/desktop/api/Winuser/nf-winuser-loadmenua) function to load the resource into memory.</span></span> <span data-ttu-id="9e5bc-284">此函式會傳回功能表的控制碼，然後您可以使用 [**SetMenu**](/windows/desktop/api/Winuser/nf-winuser-setmenu) 函式將其指派給視窗。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-284">This function returns a handle to the menu, which you can then assign to a window by using the [**SetMenu**](/windows/desktop/api/Winuser/nf-winuser-setmenu) function.</span></span> <span data-ttu-id="9e5bc-285">您可以將功能表指派給不是子視窗的任何視窗。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-285">You can assign a menu to any window that is not a child window.</span></span>

<span data-ttu-id="9e5bc-286">將功能表實作為資源，可讓您更輕鬆地將應用程式當地語系化，以在多個國家/地區中使用。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-286">Implementing menus as resources makes an application easier to localize for use in multiple countries/regions.</span></span> <span data-ttu-id="9e5bc-287">只有資源定義檔需要針對每種語言進行當地語系化，而不是應用程式的原始程式碼。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-287">Only the resource-definition file needs to be localized for each language, not the application's source code.</span></span>

### <a name="menu-template-in-memory"></a><span data-ttu-id="9e5bc-288">記憶體中的功能表範本</span><span class="sxs-lookup"><span data-stu-id="9e5bc-288">Menu Template in Memory</span></span>

<span data-ttu-id="9e5bc-289">您可以從在執行時間內建于記憶體中的功能表範本建立功能表。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-289">A menu can be created from a menu template that is built in memory at run time.</span></span> <span data-ttu-id="9e5bc-290">例如，允許使用者自訂其功能表的應用程式可能會根據使用者的喜好設定，在記憶體中建立功能表範本。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-290">For example, an application that allows a user to customize its menu might create a menu template in memory based on the user's preferences.</span></span> <span data-ttu-id="9e5bc-291">然後，應用程式可以將範本儲存在檔案或登錄中，以供日後使用。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-291">The application could then save the template in a file or in the registry for future use.</span></span> <span data-ttu-id="9e5bc-292">若要從記憶體中的範本建立功能表，請使用 [**LoadMenuIndirect**](/windows/desktop/api/Winuser/nf-winuser-loadmenuindirecta) 函數。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-292">To create a menu from a template in memory, use the [**LoadMenuIndirect**](/windows/desktop/api/Winuser/nf-winuser-loadmenuindirecta) function.</span></span> <span data-ttu-id="9e5bc-293">如需功能表範本格式的說明，請參閱 [功能表範本資源](#menu-template-resources)。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-293">For descriptions of menu-template formats, see [Menu Template Resources](#menu-template-resources).</span></span>

<span data-ttu-id="9e5bc-294">標準功能表範本包含 [**MENUITEMTEMPLATEHEADER**](/windows/desktop/api/Winuser/ns-winuser-menuitemtemplateheader) 結構，後面接著一或多個 [**MENUITEMTEMPLATE**](/windows/desktop/api/Winuser/ns-winuser-menuitemtemplate) 結構。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-294">A standard menu template consists of a [**MENUITEMTEMPLATEHEADER**](/windows/desktop/api/Winuser/ns-winuser-menuitemtemplateheader) structure followed by one or more [**MENUITEMTEMPLATE**](/windows/desktop/api/Winuser/ns-winuser-menuitemtemplate) structures.</span></span>

<span data-ttu-id="9e5bc-295">擴充功能表範本包含 [**MENUEX \_ 範本 \_ 標頭**](menuex-template-header.md) 結構，後面接著一或多個 [**MENUEX \_ 範本 \_ 專案**](menuex-template-item.md) 結構。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-295">An extended menu template consists of a [**MENUEX\_TEMPLATE\_HEADER**](menuex-template-header.md) structure followed by one or more [**MENUEX\_TEMPLATE\_ITEM**](menuex-template-item.md) structures.</span></span>

### <a name="menu-handles"></a><span data-ttu-id="9e5bc-296">功能表控點</span><span class="sxs-lookup"><span data-stu-id="9e5bc-296">Menu Handles</span></span>

<span data-ttu-id="9e5bc-297">系統會為每個功能表產生唯一的控制碼。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-297">The system generates a unique handle to each menu.</span></span> <span data-ttu-id="9e5bc-298">*功能表控制碼* 是 **HMENU** 類型的值。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-298">A *menu handle* is a value of the **HMENU** type.</span></span> <span data-ttu-id="9e5bc-299">應用程式必須在許多功能表函數中指定功能表控制碼。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-299">An application must specify a menu handle in many of the menu functions.</span></span> <span data-ttu-id="9e5bc-300">當您建立功能表或載入功能表資源時，會收到功能表列的控制碼。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-300">You receive a handle to a menu bar when you create the menu or load a menu resource.</span></span>

<span data-ttu-id="9e5bc-301">若要取得已建立或載入之功能表的功能表列控制碼，請使用 [**GetMenu**](/windows/desktop/api/Winuser/nf-winuser-getmenu) 函式。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-301">To retrieve a handle to the menu bar for a menu that has been created or loaded, use the [**GetMenu**](/windows/desktop/api/Winuser/nf-winuser-getmenu) function.</span></span> <span data-ttu-id="9e5bc-302">若要取得與功能表項目相關聯之子功能表的控制碼，請使用 [**GetSubMenu**](/windows/desktop/api/Winuser/nf-winuser-getsubmenu) 或 [**GetMenuItemInfo**](/windows/desktop/api/Winuser/nf-winuser-getmenuiteminfoa) 函數。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-302">To retrieve a handle to the submenu associated with a menu item, use the [**GetSubMenu**](/windows/desktop/api/Winuser/nf-winuser-getsubmenu) or [**GetMenuItemInfo**](/windows/desktop/api/Winuser/nf-winuser-getmenuiteminfoa) function.</span></span> <span data-ttu-id="9e5bc-303">若要取得視窗功能表的控制碼，請使用 [**GetSystemMenu**](/windows/desktop/api/Winuser/nf-winuser-getsystemmenu) 函數。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-303">To retrieve a handle to a window menu, use the [**GetSystemMenu**](/windows/desktop/api/Winuser/nf-winuser-getsystemmenu) function.</span></span>

### <a name="menu-creation-functions"></a><span data-ttu-id="9e5bc-304">功能表建立功能</span><span class="sxs-lookup"><span data-stu-id="9e5bc-304">Menu Creation Functions</span></span>

<span data-ttu-id="9e5bc-305">使用功能表建立功能時，您可以在執行時間建立功能表，或將功能表項目加入至現有的功能表。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-305">Using menu creation functions, you can create menus at run time or add menu items to existing menus.</span></span> <span data-ttu-id="9e5bc-306">您可以使用 [**CreateMenu**](/windows/desktop/api/Winuser/nf-winuser-createmenu) 函式來建立空白的功能表列，並使用 [**CreatePopupMenu**](/windows/desktop/api/Winuser/nf-winuser-createpopupmenu) 函式來建立空白的功能表。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-306">You can use the [**CreateMenu**](/windows/desktop/api/Winuser/nf-winuser-createmenu) function to create an empty menu bar and the [**CreatePopupMenu**](/windows/desktop/api/Winuser/nf-winuser-createpopupmenu) function to create an empty menu.</span></span> <span data-ttu-id="9e5bc-307">您可以使用 [**MENUINFO**](/windows/win32/api/winuser/ns-winuser-menuinfo) 結構來儲存功能表的特定設定資訊。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-307">You can save certain settings information for a menu by using the [**MENUINFO**](/windows/win32/api/winuser/ns-winuser-menuinfo) structure.</span></span> <span data-ttu-id="9e5bc-308">若要取得或取得功能表的設定，請使用 [**GetMenuInfo**](/windows/desktop/api/Winuser/nf-winuser-getmenuinfo) 或 [**SetMenuInfo**](/windows/desktop/api/Winuser/nf-winuser-setmenuinfo)。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-308">To get or retrieve the settings of a menu, use [**GetMenuInfo**](/windows/desktop/api/Winuser/nf-winuser-getmenuinfo) or [**SetMenuInfo**](/windows/desktop/api/Winuser/nf-winuser-setmenuinfo).</span></span> <span data-ttu-id="9e5bc-309">若要將專案加入至功能表，請使用 [**InsertMenuItem**](/windows/desktop/api/Winuser/nf-winuser-insertmenuitema) 函數。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-309">To add items to a menu, use the [**InsertMenuItem**](/windows/desktop/api/Winuser/nf-winuser-insertmenuitema) function.</span></span> <span data-ttu-id="9e5bc-310">仍然支援較舊的 [**AppendMenu**](/windows/desktop/api/Winuser/nf-winuser-appendmenua) 和 [**InsertMenu**](/windows/desktop/api/Winuser/nf-winuser-insertmenua) 函式，但 **InsertMenuItem** 應該用於新的應用程式。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-310">The older [**AppendMenu**](/windows/desktop/api/Winuser/nf-winuser-appendmenua) and [**InsertMenu**](/windows/desktop/api/Winuser/nf-winuser-insertmenua) functions are still supported, but **InsertMenuItem** should be used for new applications.</span></span>

### <a name="menu-display"></a><span data-ttu-id="9e5bc-311">功能表顯示</span><span class="sxs-lookup"><span data-stu-id="9e5bc-311">Menu Display</span></span>

<span data-ttu-id="9e5bc-312">載入或建立功能表之後，必須先將它指派給視窗，系統才能顯示該功能表。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-312">After a menu has been loaded or created, it must be assigned to a window before the system can display it.</span></span> <span data-ttu-id="9e5bc-313">您可以藉由定義類別功能表來指派功能表。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-313">You can assign a menu by defining a class menu.</span></span> <span data-ttu-id="9e5bc-314">如需詳細資訊，請參閱 [視窗類別功能表](#window-class-menus)。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-314">For more information, see [Window Class Menus](#window-class-menus).</span></span> <span data-ttu-id="9e5bc-315">您也可以藉由將功能表的控制碼指定為 [**CreateWindow**](/windows/desktop/api/winuser/nf-winuser-createwindowa)或 [**CreateWindowEx**](/windows/desktop/api/winuser/nf-winuser-createwindowexa)函數的 *hMenu* 參數，或藉由呼叫 [**SetMenu**](/windows/desktop/api/Winuser/nf-winuser-setmenu)函式，將功能表指派給視窗。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-315">You can also assign a menu to a window by specifying a handle to the menu as the *hMenu* parameter of the [**CreateWindow**](/windows/desktop/api/winuser/nf-winuser-createwindowa) or [**CreateWindowEx**](/windows/desktop/api/winuser/nf-winuser-createwindowexa) function, or by calling the [**SetMenu**](/windows/desktop/api/Winuser/nf-winuser-setmenu) function.</span></span>

<span data-ttu-id="9e5bc-316">若要顯示快捷方式功能表，請使用 [**TrackPopupMenuEx**](/windows/desktop/api/Winuser/nf-winuser-trackpopupmenuex) 函數。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-316">To display a shortcut menu use the [**TrackPopupMenuEx**](/windows/desktop/api/Winuser/nf-winuser-trackpopupmenuex) function.</span></span> <span data-ttu-id="9e5bc-317">處理 [**WM \_ CONTEXTMENU**](wm-contextmenu.md) 訊息時，通常會顯示快捷方式功能表（也稱為浮動快顯功能表或快顯功能表）。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-317">Shortcut menus, also called floating pop-up menus or context menus, are typically displayed when the [**WM\_CONTEXTMENU**](wm-contextmenu.md) message is processed.</span></span>

<span data-ttu-id="9e5bc-318">您可以將功能表指派給不是子視窗的任何視窗。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-318">You can assign a menu to any window that is not a child window.</span></span>

<span data-ttu-id="9e5bc-319">仍然支援較舊的 [**trackpopupmenu 讓**](/windows/desktop/api/Winuser/nf-winuser-trackpopupmenu) 函式，但新的應用程式應該使用 [**TrackPopupMenuEx**](/windows/desktop/api/Winuser/nf-winuser-trackpopupmenuex) 函數。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-319">The older [**TrackPopupMenu**](/windows/desktop/api/Winuser/nf-winuser-trackpopupmenu) function is still supported, but new applications should use the [**TrackPopupMenuEx**](/windows/desktop/api/Winuser/nf-winuser-trackpopupmenuex) function.</span></span>

### <a name="window-class-menus"></a><span data-ttu-id="9e5bc-320">視窗類別功能表</span><span class="sxs-lookup"><span data-stu-id="9e5bc-320">Window Class Menus</span></span>

<span data-ttu-id="9e5bc-321">當您註冊視窗類別時，可以指定預設功能表，稱為 *類別功能表* 。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-321">You can specify a default menu, called a *class menu,* when you register a window class.</span></span> <span data-ttu-id="9e5bc-322">若要這樣做，請將功能表範本資源的名稱指派給用來註冊類別的 [**WNDCLASS**](/windows/win32/api/winuser/ns-winuser-wndclassa)結構的 **lpszMenuName** 成員。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-322">To do so, you assign the name of the menu-template resource to the **lpszMenuName** member of the [**WNDCLASS**](/windows/win32/api/winuser/ns-winuser-wndclassa) structure used to register the class.</span></span>

<span data-ttu-id="9e5bc-323">預設會為每個視窗指派其視窗類別的 [類別] 功能表，因此您不需要明確地載入功能表並將它指派給每個視窗。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-323">By default, every window is assigned the class menu for its window class so you do not need to explicitly load the menu and assign it to each window.</span></span> <span data-ttu-id="9e5bc-324">您可以藉由在 [**CreateWindowEx**](/windows/desktop/api/winuser/nf-winuser-createwindowexa) 函式的呼叫中指定不同的功能表控制碼，來覆寫 [類別] 功能表。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-324">You can override the class menu by specifying a different menu handle in a call to the [**CreateWindowEx**](/windows/desktop/api/winuser/nf-winuser-createwindowexa) function.</span></span> <span data-ttu-id="9e5bc-325">您也可以在使用 [**SetMenu**](/windows/desktop/api/Winuser/nf-winuser-setmenu) 函式建立之後，變更視窗的功能表。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-325">You can also change a window's menu after it is created by using the [**SetMenu**](/windows/desktop/api/Winuser/nf-winuser-setmenu) function.</span></span> <span data-ttu-id="9e5bc-326">如需詳細資訊，請參閱 [視窗類別](/windows/desktop/winmsg/window-classes)。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-326">For more information, see [Window Classes](/windows/desktop/winmsg/window-classes).</span></span>

## <a name="menu-items"></a><span data-ttu-id="9e5bc-327">功能表項目</span><span class="sxs-lookup"><span data-stu-id="9e5bc-327">Menu Items</span></span>

<span data-ttu-id="9e5bc-328">下列主題討論當使用者選擇功能表項目時，系統執行的動作，以及應用程式可以控制專案外觀和功能的方式：</span><span class="sxs-lookup"><span data-stu-id="9e5bc-328">The following topics discuss what the system does when the user chooses a menu item, and the ways an application can control an item's appearance and functionality:</span></span>

-   [<span data-ttu-id="9e5bc-329">開啟子功能表的命令專案和專案</span><span class="sxs-lookup"><span data-stu-id="9e5bc-329">Command Items and Items that Open Submenus</span></span>](#command-items-and-items-that-open-submenus)
-   [<span data-ttu-id="9e5bc-330">功能表項目識別碼</span><span class="sxs-lookup"><span data-stu-id="9e5bc-330">Menu-Item Identifier</span></span>](#menu-item-identifier)
-   [<span data-ttu-id="9e5bc-331">功能表項目位置</span><span class="sxs-lookup"><span data-stu-id="9e5bc-331">Menu-Item Position</span></span>](#menu-item-position)
-   [<span data-ttu-id="9e5bc-332">以程式設計方式存取功能表項目</span><span class="sxs-lookup"><span data-stu-id="9e5bc-332">Accessing Menu Items Programmatically</span></span>](#accessing-menu-items-programmatically)
-   [<span data-ttu-id="9e5bc-333">預設功能表項目</span><span class="sxs-lookup"><span data-stu-id="9e5bc-333">Default Menu Items</span></span>](#default-menu-items)
-   [<span data-ttu-id="9e5bc-334">選取和清除功能表項目</span><span class="sxs-lookup"><span data-stu-id="9e5bc-334">Selected and Clear Menu Items</span></span>](#selected-and-clear-menu-items)
-   [<span data-ttu-id="9e5bc-335">啟用、灰色和停用的功能表項目</span><span class="sxs-lookup"><span data-stu-id="9e5bc-335">Enabled, Grayed, and Disabled Menu Items</span></span>](#enabled-grayed-and-disabled-menu-items)
-   [<span data-ttu-id="9e5bc-336">反白顯示的功能表項目</span><span class="sxs-lookup"><span data-stu-id="9e5bc-336">Highlighted Menu Items</span></span>](#highlighted-menu-items)
-   [<span data-ttu-id="9e5bc-337">擁有者繪製的功能表項目</span><span class="sxs-lookup"><span data-stu-id="9e5bc-337">Owner-Drawn Menu Items</span></span>](#owner-drawn-menu-items)
-   [<span data-ttu-id="9e5bc-338">功能表項目分隔符號和分行符號號</span><span class="sxs-lookup"><span data-stu-id="9e5bc-338">Menu Item Separators and Line Breaks</span></span>](#menu-item-separators-and-line-breaks)

### <a name="command-items-and-items-that-open-submenus"></a><span data-ttu-id="9e5bc-339">開啟子功能表的命令專案和專案</span><span class="sxs-lookup"><span data-stu-id="9e5bc-339">Command Items and Items that Open Submenus</span></span>

<span data-ttu-id="9e5bc-340">當使用者選擇命令專案時，系統會將命令訊息傳送至擁有功能表的視窗。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-340">When the user chooses a command item, the system sends a command message to the window that owns the menu.</span></span> <span data-ttu-id="9e5bc-341">如果命令專案位於 [視窗] 功能表上，系統會傳送 [**WM \_ SYSCOMMAND**](wm-syscommand.md) 訊息。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-341">If the command item is on the window menu, the system sends the [**WM\_SYSCOMMAND**](wm-syscommand.md) message.</span></span> <span data-ttu-id="9e5bc-342">否則，它會傳送 [**WM \_ 命令**](wm-command.md) 訊息。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-342">Otherwise, it sends the [**WM\_COMMAND**](wm-command.md) message.</span></span>

<span data-ttu-id="9e5bc-343">與開啟子功能表的每個功能表項目相關聯，是對應子功能表的控制碼。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-343">Associated with each menu item that opens a submenu is a handle to the corresponding submenu.</span></span> <span data-ttu-id="9e5bc-344">當使用者指向這類專案時，系統會開啟子功能表。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-344">When the user points to such an item, the system opens the submenu.</span></span> <span data-ttu-id="9e5bc-345">沒有任何命令訊息會傳送至主控視窗。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-345">No command message is sent to the owner window.</span></span> <span data-ttu-id="9e5bc-346">不過，系統會先將 [**WM \_ INITMENUPOPUP**](wm-initmenupopup.md) 訊息傳送給擁有者視窗，然後才顯示子功能表。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-346">However, the system sends a [**WM\_INITMENUPOPUP**](wm-initmenupopup.md) message to the owner window before displaying the submenu.</span></span> <span data-ttu-id="9e5bc-347">您可以使用 [**GetSubMenu**](/windows/desktop/api/Winuser/nf-winuser-getsubmenu) 或 [**GetMenuItemInfo**](/windows/desktop/api/Winuser/nf-winuser-getmenuiteminfoa) 函數，取得與專案相關聯的子功能表控制碼。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-347">You can get a handle to the submenu associated with an item by using the [**GetSubMenu**](/windows/desktop/api/Winuser/nf-winuser-getsubmenu) or [**GetMenuItemInfo**](/windows/desktop/api/Winuser/nf-winuser-getmenuiteminfoa) function.</span></span>

<span data-ttu-id="9e5bc-348">功能表列通常包含功能表名稱，但也可以包含命令專案。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-348">A menu bar typically contains menu names, but it can also contain command items.</span></span> <span data-ttu-id="9e5bc-349">子功能表通常包含命令專案，但也可以包含開啟嵌套子功能表的專案。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-349">A submenu typically contains command items, but it can also contain items that open nested submenus.</span></span> <span data-ttu-id="9e5bc-350">藉由將這類專案加入至子功能表，您可以將功能表嵌套到任何深度。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-350">By adding such items to submenus, you can nest menus to any depth.</span></span> <span data-ttu-id="9e5bc-351">為了提供視覺提示給使用者，系統會自動在開啟子功能表的功能表項目文字右邊顯示一個小箭號。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-351">To provide a visual cue for the user, the system automatically displays a small arrow to the right of the text of a menu item that opens a submenu.</span></span>

### <a name="menu-item-identifier"></a><span data-ttu-id="9e5bc-352">Menu-Item 識別碼</span><span class="sxs-lookup"><span data-stu-id="9e5bc-352">Menu-Item Identifier</span></span>

<span data-ttu-id="9e5bc-353">與每個功能表項目相關聯的是一個唯一的應用程式定義整數，稱為 *功能表項目識別碼*。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-353">Associated with each menu item is a unique, application-defined integer, called a *menu-item identifier*.</span></span> <span data-ttu-id="9e5bc-354">當使用者從功能表中選擇命令專案時，系統會將專案的識別碼傳送至擁有者視窗，作為 [**WM \_ 命令**](wm-command.md) 訊息的一部分。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-354">When the user chooses a command item from a menu, the system sends the item's identifier to the owner window as part of a [**WM\_COMMAND**](wm-command.md) message.</span></span> <span data-ttu-id="9e5bc-355">視窗程式會檢查識別碼，以判斷訊息的來源，並據以處理訊息。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-355">The window procedure examines the identifier to determine the source of the message, and processes the message accordingly.</span></span> <span data-ttu-id="9e5bc-356">此外，您可以在呼叫功能表函式時，使用其識別碼指定功能表項目;例如，啟用或停用功能表項目。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-356">In addition, you can specify a menu item using its identifier when you call menu functions; for example, to enable or disable a menu item.</span></span>

<span data-ttu-id="9e5bc-357">開啟子功能表的功能表項目具有識別碼，就像命令專案一樣。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-357">Menu items that open submenus have identifiers just as command items do.</span></span> <span data-ttu-id="9e5bc-358">不過，從功能表中選取這類專案時，系統不會傳送命令訊息。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-358">However, the system does not send a command message when such an item is selected from a menu.</span></span> <span data-ttu-id="9e5bc-359">相反地，系統會開啟與功能表項目相關聯的子功能表。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-359">Instead, the system opens the submenu associated with the menu item.</span></span>

<span data-ttu-id="9e5bc-360">若要在指定位置取出功能表項目的識別碼，請使用 [**GetMenuItemID**](/windows/desktop/api/Winuser/nf-winuser-getmenuitemid) 或 [**GetMenuItemInfo**](/windows/desktop/api/Winuser/nf-winuser-getmenuiteminfoa) 函數。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-360">To retrieve the identifier of the menu item at a specified position, use the [**GetMenuItemID**](/windows/desktop/api/Winuser/nf-winuser-getmenuitemid) or [**GetMenuItemInfo**](/windows/desktop/api/Winuser/nf-winuser-getmenuiteminfoa) function.</span></span>

### <a name="menu-item-position"></a><span data-ttu-id="9e5bc-361">Menu-Item 位置</span><span class="sxs-lookup"><span data-stu-id="9e5bc-361">Menu-Item Position</span></span>

<span data-ttu-id="9e5bc-362">除了具有唯一識別碼之外，功能表列或功能表中的每個功能表項目都具有唯一的位置值。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-362">In addition to having a unique identifier, each menu item in a menu bar or menu has a unique position value.</span></span> <span data-ttu-id="9e5bc-363">功能表列中最左邊的專案或功能表中的最上層專案，都有位置零。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-363">The leftmost item in a menu bar, or the top item in a menu, has position zero.</span></span> <span data-ttu-id="9e5bc-364">後續功能表項目的位置值會遞增。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-364">The position value is incremented for subsequent menu items.</span></span> <span data-ttu-id="9e5bc-365">系統會將位置值指派給功能表中的所有專案，包括分隔符號。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-365">The system assigns a position value to all items in a menu, including separators.</span></span> <span data-ttu-id="9e5bc-366">下圖顯示功能表列和功能表中專案的位置值。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-366">The following illustration shows the position values of items in a menu bar and in a menu.</span></span>

![功能表列和功能表](images/csemn-01.png)

<span data-ttu-id="9e5bc-368">當呼叫修改或抓取特定功能表項目相關資訊的功能表函式時，您可以使用它的識別碼或其位置來指定專案。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-368">When calling a menu function that modifies or retrieves information about a specific menu item, you can specify the item using either its identifier or its position.</span></span> <span data-ttu-id="9e5bc-369">如需詳細資訊，請參閱下一節。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-369">For more information, see the next section.</span></span>

### <a name="accessing-menu-items-programmatically"></a><span data-ttu-id="9e5bc-370">以程式設計方式存取功能表項目</span><span class="sxs-lookup"><span data-stu-id="9e5bc-370">Accessing Menu Items Programmatically</span></span>

<span data-ttu-id="9e5bc-371">大部分的功能表功能都可讓您依位置或命令指定功能表項目。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-371">Most menu functions allow you to specify a menu item either by position or by command.</span></span> <span data-ttu-id="9e5bc-372">有些函式會使用 **mf \_ BYPOSITION** 和 **mf \_ BYCOMMAND** 旗標來表示搜尋演算法，有些則具有明確的 *fByPosition* 參數。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-372">Some functions use the **MF\_BYPOSITION** and **MF\_BYCOMMAND** flags to indicate the search algorithm; others have an explicit *fByPosition* parameter.</span></span> <span data-ttu-id="9e5bc-373">如果您依位置指定功能表項目，則專案編號是以零為基底的索引，在功能表中。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-373">If you specify the menu item by position, the item number is a zero-based index into the menu.</span></span> <span data-ttu-id="9e5bc-374">如果您依命令指定功能表項目，則會在功能表識別碼等於所提供專案編號的專案中搜尋功能表和其子功能表。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-374">If you specify the menu item by command, the menu and its submenus are searched for an item whose menu identifier equals the item number provided.</span></span> <span data-ttu-id="9e5bc-375">如果功能表階層中有多個專案符合專案編號，則不會指定使用哪一個專案。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-375">If more than one item in the menu hierarchy matches the item number, it is unspecified which one is used.</span></span> <span data-ttu-id="9e5bc-376">如果您的功能表包含重複的功能表識別碼，您應該使用以位置為基礎的功能表作業來避免這種混淆。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-376">If your menus contain duplicate menu identifiers, you should use position-based menu operations to avoid this ambiguity.</span></span>

### <a name="default-menu-items"></a><span data-ttu-id="9e5bc-377">預設功能表項目</span><span class="sxs-lookup"><span data-stu-id="9e5bc-377">Default Menu Items</span></span>

<span data-ttu-id="9e5bc-378">子功能表可以包含一個預設功能表項目。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-378">A submenu can contain one default menu item.</span></span> <span data-ttu-id="9e5bc-379">當使用者按兩下來開啟子功能表時，系統會將命令訊息傳送至功能表的擁有者視窗，並關閉功能表，如同已選擇預設的命令專案一樣。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-379">When the user opens a submenu by double-clicking, the system sends a command message to the menu's owner window and closes the menu as if the default command item had been chosen.</span></span> <span data-ttu-id="9e5bc-380">如果沒有預設的命令專案，子功能表會保持開啟。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-380">If there is no default command item, the submenu remains open.</span></span> <span data-ttu-id="9e5bc-381">若要抓取並設定子功能表的預設專案，請使用 [**GetMenuDefaultItem**](/windows/desktop/api/Winuser/nf-winuser-getmenudefaultitem) 和 [**SetMenuDefaultItem**](/windows/desktop/api/Winuser/nf-winuser-setmenudefaultitem) 函數。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-381">To retrieve and set the default item for a submenu, use the [**GetMenuDefaultItem**](/windows/desktop/api/Winuser/nf-winuser-getmenudefaultitem) and [**SetMenuDefaultItem**](/windows/desktop/api/Winuser/nf-winuser-setmenudefaultitem) functions.</span></span>

### <a name="selected-and-clear-menu-items"></a><span data-ttu-id="9e5bc-382">選取和清除功能表項目</span><span class="sxs-lookup"><span data-stu-id="9e5bc-382">Selected and Clear Menu Items</span></span>

<span data-ttu-id="9e5bc-383">功能表項目可以是 [已選取] 或 [清除]。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-383">A menu item can be either selected or clear.</span></span> <span data-ttu-id="9e5bc-384">系統會在選取的功能表項目旁邊顯示點陣圖，以指出其選取的狀態。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-384">The system displays a bitmap next to selected menu items to indicate their selected state.</span></span> <span data-ttu-id="9e5bc-385">除非指定了應用程式定義的「清除」點陣圖，否則系統不會在清除專案旁顯示點陣圖。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-385">The system does not display a bitmap next to clear items, unless an application-defined "clear" bitmap is specified.</span></span> <span data-ttu-id="9e5bc-386">您只能選取功能表中的功能表項目;無法選取功能表列中的專案。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-386">Only menu items in a menu can be selected; items in a menu bar cannot be selected.</span></span>

<span data-ttu-id="9e5bc-387">應用程式通常會檢查或清除功能表項目，以指出選項是否作用中。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-387">Applications typically check or clear a menu item to indicate whether an option is in effect.</span></span> <span data-ttu-id="9e5bc-388">例如，假設應用程式有一個工具列，可讓使用者使用功能表上的 **工具列** 命令來顯示或隱藏。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-388">For example, suppose an application has a toolbar that the user can show or hide by using a **Toolbar** command on a menu.</span></span> <span data-ttu-id="9e5bc-389">隱藏工具列時， **工具列** 功能表項目會很清楚。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-389">When the toolbar is hidden, the **Toolbar** menu item is clear.</span></span> <span data-ttu-id="9e5bc-390">當使用者選擇此命令時，應用程式會檢查功能表項目，並顯示工具列。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-390">When the user chooses the command, the application checks the menu item and shows the toolbar.</span></span>

<span data-ttu-id="9e5bc-391">核取記號屬性會控制是否已選取功能表項目。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-391">A check mark attribute controls whether a menu item is selected.</span></span> <span data-ttu-id="9e5bc-392">您可以使用 [**CheckMenuItem**](/windows/desktop/api/Winuser/nf-winuser-checkmenuitem) 函數來設定功能表項目的核取記號屬性。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-392">You can set a menu item's check mark attribute by using the [**CheckMenuItem**](/windows/desktop/api/Winuser/nf-winuser-checkmenuitem) function.</span></span> <span data-ttu-id="9e5bc-393">您可以使用 [**GetMenuState**](/windows/desktop/api/Winuser/nf-winuser-getmenustate) 函式來判斷是否目前已選取或清除功能表項目。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-393">You can use the [**GetMenuState**](/windows/desktop/api/Winuser/nf-winuser-getmenustate) function to determine whether a menu item is currently selected or cleared.</span></span>

<span data-ttu-id="9e5bc-394">您可以使用 [**GetMenuItemInfo**](/windows/desktop/api/Winuser/nf-winuser-getmenuiteminfoa)和 [**SetMenuItemInfo**](/windows/desktop/api/Winuser/nf-winuser-setmenuiteminfoa)函式來取得和設定功能表項目的檢查狀態，而不是 [**CheckMenuItem**](/windows/desktop/api/Winuser/nf-winuser-checkmenuitem)和 [**GetMenuState**](/windows/desktop/api/Winuser/nf-winuser-getmenustate)。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-394">Instead of [**CheckMenuItem**](/windows/desktop/api/Winuser/nf-winuser-checkmenuitem) and [**GetMenuState**](/windows/desktop/api/Winuser/nf-winuser-getmenustate), you can use the [**GetMenuItemInfo**](/windows/desktop/api/Winuser/nf-winuser-getmenuiteminfoa) and [**SetMenuItemInfo**](/windows/desktop/api/Winuser/nf-winuser-setmenuiteminfoa) functions to retrieve and set the check state of a menu item.</span></span>

<span data-ttu-id="9e5bc-395">有時候，一組功能表項目會對應到一組互斥的選項。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-395">Sometimes, a group of menu items corresponds to a set of mutually exclusive options.</span></span> <span data-ttu-id="9e5bc-396">在這種情況下，您可以使用選取的 [選項按鈕] 功能表項目， (類似選項按鈕控制項) 來指出選取的選項。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-396">In this case, you can indicate the selected option by using a selected radio menu item (analogous to a radio button control).</span></span> <span data-ttu-id="9e5bc-397">選取的選項按鈕會以專案符號點陣圖而非核取記號點陣圖顯示。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-397">Selected radio items are displayed with a bullet bitmap instead of a check mark bitmap.</span></span> <span data-ttu-id="9e5bc-398">若要檢查功能表項目並將其設為選項按鈕，請使用 [**CheckMenuRadioItem**](/windows/desktop/api/Winuser/nf-winuser-checkmenuradioitem) 函數。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-398">To check a menu item and make it a radio item, use the [**CheckMenuRadioItem**](/windows/desktop/api/Winuser/nf-winuser-checkmenuradioitem) function.</span></span>

<span data-ttu-id="9e5bc-399">根據預設，系統會在選取的功能表項目旁邊顯示核取記號或專案符號點陣圖，並在清除的功能表項目旁邊顯示任何點陣圖。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-399">By default, the system displays a check mark or bullet bitmap next to selected menu items and no bitmap next to cleared menu items.</span></span> <span data-ttu-id="9e5bc-400">不過，您可以使用 [**SetMenuItemBitmaps**](/windows/desktop/api/Winuser/nf-winuser-setmenuitembitmaps) 函式，將應用程式定義的選取和清除點陣圖與功能表項目產生關聯。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-400">However, you can use the [**SetMenuItemBitmaps**](/windows/desktop/api/Winuser/nf-winuser-setmenuitembitmaps) function to associate application-defined selected and cleared bitmaps with a menu item.</span></span> <span data-ttu-id="9e5bc-401">系統接著會使用指定的點陣圖來指出功能表項目的選取或清除狀態。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-401">The system then uses the specified bitmaps to indicate the menu item's selected or cleared state.</span></span>

<span data-ttu-id="9e5bc-402">與功能表項目相關聯的應用程式定義點陣圖必須與預設的核取記號點陣圖大小相同，其尺寸可能會依螢幕解析度而有所不同。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-402">Application-defined bitmaps associated with a menu item must be the same size as the default check mark bitmap, the dimensions of which may vary depending on screen resolution.</span></span> <span data-ttu-id="9e5bc-403">若要取得正確的維度，請使用 [**GetSystemMetrics**](/windows/desktop/api/winuser/nf-winuser-getsystemmetrics) 函數。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-403">To retrieve the correct dimensions, use the [**GetSystemMetrics**](/windows/desktop/api/winuser/nf-winuser-getsystemmetrics) function.</span></span> <span data-ttu-id="9e5bc-404">您可以針對不同的螢幕解析度建立多個點陣圖資源;如有必要，請建立一個點陣圖資源並調整其大小。或在執行時間建立點陣圖，並在其中繪製影像。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-404">You can create multiple bitmap resources for different screen resolutions; create one bitmap resource and scale it, if necessary; or create a bitmap at run time and draw an image in it.</span></span> <span data-ttu-id="9e5bc-405">點陣圖可能是單色或彩色。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-405">The bitmaps may be either monochrome or color.</span></span> <span data-ttu-id="9e5bc-406">不過，由於功能表項目會在反白顯示時反轉，因此可能不需要某些反轉色彩點陣圖的外觀。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-406">However, because menu items are inverted when highlighted, the appearance of certain inverted color bitmaps may be undesirable.</span></span> <span data-ttu-id="9e5bc-407">如需詳細資訊，請參閱 [點陣圖](/windows/desktop/gdi/bitmaps)。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-407">For more information, see [Bitmaps](/windows/desktop/gdi/bitmaps).</span></span>

### <a name="enabled-grayed-and-disabled-menu-items"></a><span data-ttu-id="9e5bc-408">啟用、灰色和停用的功能表項目</span><span class="sxs-lookup"><span data-stu-id="9e5bc-408">Enabled, Grayed, and Disabled Menu Items</span></span>

<span data-ttu-id="9e5bc-409">您可以啟用、呈現灰色或停用功能表項目。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-409">A menu item can be enabled, grayed, or disabled.</span></span> <span data-ttu-id="9e5bc-410">依預設，會啟用功能表項目。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-410">By default, a menu item is enabled.</span></span> <span data-ttu-id="9e5bc-411">當使用者選擇 [已啟用] 功能表項目時，系統會將命令訊息傳送至主控視窗，或根據功能表項目的類型，顯示對應的子功能表。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-411">When the user chooses an enabled menu item, the system sends a command message to the owner window or displays the corresponding submenu, depending on what kind of menu item it is.</span></span>

<span data-ttu-id="9e5bc-412">當使用者無法使用功能表項目時，這些專案應該呈現灰色或停用。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-412">When menu items are not available to the user, they should be grayed or disabled.</span></span> <span data-ttu-id="9e5bc-413">無法選擇灰色和停用的功能表項目。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-413">Grayed and disabled menu items cannot be chosen.</span></span> <span data-ttu-id="9e5bc-414">已停用的專案看起來就像已啟用的專案一樣。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-414">A disabled item looks just like an enabled item.</span></span> <span data-ttu-id="9e5bc-415">當使用者按一下已停用的專案時，就不會選取該專案，也不會發生任何事。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-415">When the user clicks on a disabled item, the item is not selected, and nothing happens.</span></span> <span data-ttu-id="9e5bc-416">例如，已停用的專案可能會在顯示顯示為使用中但未顯示之功能表的教學課程中有用。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-416">Disabled items can be useful in, for example, a tutorial that presents a menu that looks active but isn't.</span></span>

<span data-ttu-id="9e5bc-417">應用程式會將無法使用的功能表項目設為灰色，以提供不提供命令給使用者的視覺提示。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-417">An application grays an unavailable menu item to provide a visual cue to the user that a command is not available.</span></span> <span data-ttu-id="9e5bc-418">當動作不適用時，您可以使用灰色的專案 (例如，當系統沒有安裝印表機) 時，[檔案 **] 功能表中的 [** **列印**] 命令會變成灰色。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-418">You can use a grayed item when an action is not appropriate (for example, you can gray the **Print** command in the **File** menu when the system does not have a printer installed).</span></span>

<span data-ttu-id="9e5bc-419">[**EnableMenuItem**](/windows/desktop/api/Winuser/nf-winuser-enablemenuitem)函式會啟用、停用或停用功能表項目。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-419">The [**EnableMenuItem**](/windows/desktop/api/Winuser/nf-winuser-enablemenuitem) function enables, grays, or disables a menu item.</span></span> <span data-ttu-id="9e5bc-420">若要判斷是否已啟用、灰色或停用功能表項目，請使用 [**GetMenuItemInfo**](/windows/desktop/api/Winuser/nf-winuser-getmenuiteminfoa) 函數。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-420">To determine whether a menu item is enabled, grayed, or disabled, use the [**GetMenuItemInfo**](/windows/desktop/api/Winuser/nf-winuser-getmenuiteminfoa) function.</span></span>

<span data-ttu-id="9e5bc-421">除了 [**GetMenuItemInfo**](/windows/desktop/api/Winuser/nf-winuser-getmenuiteminfoa)之外，您也可以使用 [**GetMenuState**](/windows/desktop/api/Winuser/nf-winuser-getmenustate) 函式來判斷功能表項目是已啟用、灰色還是停用。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-421">Instead of [**GetMenuItemInfo**](/windows/desktop/api/Winuser/nf-winuser-getmenuiteminfoa), you can also use the [**GetMenuState**](/windows/desktop/api/Winuser/nf-winuser-getmenustate) function to determine whether a menu item is enabled, grayed, or disabled.</span></span>

### <a name="highlighted-menu-items"></a><span data-ttu-id="9e5bc-422">反白顯示的功能表項目</span><span class="sxs-lookup"><span data-stu-id="9e5bc-422">Highlighted Menu Items</span></span>

<span data-ttu-id="9e5bc-423">當使用者選取功能表項目時，系統會自動反白顯示功能表上的功能表項目。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-423">The system automatically highlights menu items on menus as the user selects them.</span></span> <span data-ttu-id="9e5bc-424">不過，您可以使用 [**HiliteMenuItem**](/windows/desktop/api/Winuser/nf-winuser-hilitemenuitem) 函式，在功能表列上的功能表名稱中明確地加入或移除反白顯示。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-424">However, highlighting can be explicitly added or removed from a menu name on the menu bar by using the [**HiliteMenuItem**](/windows/desktop/api/Winuser/nf-winuser-hilitemenuitem) function.</span></span> <span data-ttu-id="9e5bc-425">此函式不會影響功能表上的功能表項目。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-425">This function has no effect on menu items on menus.</span></span> <span data-ttu-id="9e5bc-426">不過，當 **HiliteMenuItem** 用來反白顯示功能表名稱時，此名稱只會顯示為已選取。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-426">When **HiliteMenuItem** is used to highlight a menu name, though, the name only appears to be selected.</span></span> <span data-ttu-id="9e5bc-427">如果使用者按下 ENTER 鍵，則不會選擇反白顯示的專案。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-427">If the user presses the ENTER key, the highlighted item is not chosen.</span></span> <span data-ttu-id="9e5bc-428">例如，這項功能在示範功能表使用方式的訓練應用程式中可能很有用。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-428">This feature might be useful in, for example, a training application that demonstrates the use of menus.</span></span>

### <a name="owner-drawn-menu-items"></a><span data-ttu-id="9e5bc-429">Owner-Drawn 功能表項目</span><span class="sxs-lookup"><span data-stu-id="9e5bc-429">Owner-Drawn Menu Items</span></span>

<span data-ttu-id="9e5bc-430">應用程式可以使用主控描繪 *專案* 來完全控制功能表項目的外觀。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-430">An application can completely control the appearance of a menu item by using an *owner-drawn item*.</span></span> <span data-ttu-id="9e5bc-431">擁有者繪製的專案需要應用程式，才能將選取的 (醒目提示) 、選取和清除的狀態。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-431">Owner-drawn items require an application to take total responsibility for drawing selected (highlighted), selected, and cleared states.</span></span> <span data-ttu-id="9e5bc-432">例如，如果應用程式提供了字型功能表，則可以使用對應的字型繪製每個功能表項目;羅馬字的專案會以羅馬繪製，斜體的專案會以斜體繪製，依此類推。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-432">For example, if an application provided a font menu, it could draw each menu item by using the corresponding font; the item for Roman would be drawn with roman, the item for Italic would be drawn in italic, and so on.</span></span> <span data-ttu-id="9e5bc-433">如需詳細資訊，請參閱 [建立 Owner-Drawn 功能表項目](using-menus.md)。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-433">For more information, see [Creating Owner-Drawn Menu Items](using-menus.md).</span></span>

### <a name="menu-item-separators-and-line-breaks"></a><span data-ttu-id="9e5bc-434">功能表項目分隔符號和分行符號號</span><span class="sxs-lookup"><span data-stu-id="9e5bc-434">Menu Item Separators and Line Breaks</span></span>

<span data-ttu-id="9e5bc-435">系統會提供一種特殊類型的功能表項目（稱為 *分隔符號*），以水平線顯示。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-435">The system provides a special type of menu item, called a *separator*, that appears as a horizontal line.</span></span> <span data-ttu-id="9e5bc-436">您可以使用分隔符號將功能表分割成相關專案的群組。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-436">You can use a separator to divide a menu into groups of related items.</span></span> <span data-ttu-id="9e5bc-437">無法在功能表列中使用分隔符號，使用者也無法選取分隔符號。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-437">A separator cannot be used in a menu bar, and the user cannot select a separator.</span></span>

<span data-ttu-id="9e5bc-438">當功能表列包含的功能表名稱超過一行所容納的數目時，系統會自動將它分成兩行或多行，以包裝功能表列。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-438">When a menu bar contains more menu names than will fit on one line, the system wraps the menu bar by automatically breaking it into two or more lines.</span></span> <span data-ttu-id="9e5bc-439">您可以藉由將 [ **MFT \_ MENUBREAK** 類型] 旗標指派給專案，在功能表列上的特定專案上產生分行符號。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-439">You can cause a line break to occur at a specific item on a menu bar by assigning the **MFT\_MENUBREAK** type flag to the item.</span></span> <span data-ttu-id="9e5bc-440">系統會將該專案和所有後續專案放在新行上。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-440">The system places that item and all subsequent items on a new line.</span></span>

<span data-ttu-id="9e5bc-441">當功能表所包含的專案數目超過一個資料行時，功能表將會被截斷。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-441">When a menu contains more items than will fit in one column, the menu will be truncated.</span></span> <span data-ttu-id="9e5bc-442">您可以藉由將 **MFT \_ MENUBREAK** 類型旗標指派給專案，或使用 [MENUITEM](/windows/desktop/menurc/menuitem-statement) 語句中的 MENUBREAK 選項，讓資料行出現在功能表中的特定專案上。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-442">You can cause a column break to occur at a specific item in a menu by assigning the **MFT\_MENUBREAK** type flag to the item or using the MENUBREAK option in the [MENUITEM](/windows/desktop/menurc/menuitem-statement) statement.</span></span> <span data-ttu-id="9e5bc-443">系統會將該專案和所有後續專案放在新的資料行中。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-443">The system places that item and all subsequent items in a new column.</span></span> <span data-ttu-id="9e5bc-444">[ **MFT \_ MENUBARBREAK** 類型] 旗標具有相同的效果，不同之處在于新的資料行與舊的資料行之間會出現垂直線。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-444">The **MFT\_MENUBARBREAK** type flag has the same effect, except that a vertical line appears between the new column and the old.</span></span>

<span data-ttu-id="9e5bc-445">如果您使用 [**AppendMenu**](/windows/desktop/api/Winuser/nf-winuser-appendmenua)、 [**InsertMenu**](/windows/desktop/api/Winuser/nf-winuser-insertmenua)或 [**ModifyMenu**](/windows/desktop/api/Winuser/nf-winuser-modifymenua) 函式來指派分行符號，則應指派類型旗標 **mf \_ MENUBREAK** 或 **mf \_ MENUBARBREAK**。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-445">If you use the [**AppendMenu**](/windows/desktop/api/Winuser/nf-winuser-appendmenua), [**InsertMenu**](/windows/desktop/api/Winuser/nf-winuser-insertmenua), or [**ModifyMenu**](/windows/desktop/api/Winuser/nf-winuser-modifymenua) functions to assign line breaks, you should assign the type flags **MF\_MENUBREAK** or **MF\_MENUBARBREAK**.</span></span>

## <a name="messages-used-with-menus"></a><span data-ttu-id="9e5bc-446">搭配功能表使用的訊息</span><span class="sxs-lookup"><span data-stu-id="9e5bc-446">Messages Used with Menus</span></span>

<span data-ttu-id="9e5bc-447">系統會將訊息傳送至擁有功能表之視窗的視窗程式，以報告功能表相關活動。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-447">The system reports menu-related activity by sending messages to the window procedure of the window that owns the menu.</span></span> <span data-ttu-id="9e5bc-448">當使用者在功能表列上選取專案或按一下滑鼠右鍵以顯示快捷方式功能表時，系統會傳送一連串的訊息。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-448">The system sends a series of messages when the user selects items on the menu bar or clicks the right mouse button to display a shortcut menu.</span></span>

<span data-ttu-id="9e5bc-449">當使用者在功能表列上啟動專案時，擁有者視窗會先收到 [**WM \_ SYSCOMMAND**](wm-syscommand.md) 訊息。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-449">When the user activates an item on the menu bar, the owner window first receives a [**WM\_SYSCOMMAND**](wm-syscommand.md) message.</span></span> <span data-ttu-id="9e5bc-450">此訊息包含一個旗標，指出使用者是否使用鍵盤 (SC \_ KEYMENU) 或滑鼠 (SC MOUSEMENU) 來啟用功能表 \_ 。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-450">This message includes a flag that indicates whether the user activated the menu by using the keyboard (SC\_KEYMENU) or the mouse (SC\_MOUSEMENU).</span></span> <span data-ttu-id="9e5bc-451">如需詳細資訊，請參閱 [鍵盤存取功能表](#keyboard-access-to-menus)。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-451">For more information, see [Keyboard Access to Menus](#keyboard-access-to-menus).</span></span>

<span data-ttu-id="9e5bc-452">接下來，在顯示任何功能表之前，系統會將 [**WM \_ INITMENU**](wm-initmenu.md) 訊息傳送至視窗程式，讓應用程式可以在使用者看到功能表之前修改功能表。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-452">Next, before displaying any menus, the system sends the [**WM\_INITMENU**](wm-initmenu.md) message to the window procedure so that an application can modify the menus before the user sees them.</span></span> <span data-ttu-id="9e5bc-453">系統只會針對每個功能表啟用傳送一次 **WM 的 \_ INITMENU** 訊息。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-453">The system sends the **WM\_INITMENU** message only once per menu activation.</span></span>

<span data-ttu-id="9e5bc-454">當使用者指向開啟子功能表的功能表項目時，系統會在顯示子功能表之前，先將 [**WM \_ INITMENUPOPUP**](wm-initmenupopup.md) 訊息傳送給擁有者視窗。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-454">When the user points to a menu item that opens a submenu, the system sends the owner window the [**WM\_INITMENUPOPUP**](wm-initmenupopup.md) message before displaying the submenu.</span></span> <span data-ttu-id="9e5bc-455">這則訊息會讓應用程式有機會在子功能表顯示前加以修改。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-455">This message gives the application an opportunity to modify the submenu before it is displayed.</span></span>

<span data-ttu-id="9e5bc-456">每次使用者將醒目提示從某個專案移到另一個專案時，系統就會將 [**WM \_ MENUSELECT**](wm-menuselect.md) 訊息傳送至功能表的擁有者視窗的視窗程式。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-456">Each time the user moves the highlighting from one item to another, the system sends a [**WM\_MENUSELECT**](wm-menuselect.md) message to the window procedure of the menu's owner window.</span></span> <span data-ttu-id="9e5bc-457">此訊息會識別目前選取的功能表項目。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-457">This message identifies the currently selected menu item.</span></span> <span data-ttu-id="9e5bc-458">許多應用程式會在其主視窗的底部提供資訊區域，並使用此訊息來顯示有關選取之功能表項目的其他資訊。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-458">Many applications provide an information area at the bottom of their main windows and use this message to display additional information about the selected menu item.</span></span>

<span data-ttu-id="9e5bc-459">當使用者從功能表中選擇命令專案時，系統會將 [**WM \_ 命令**](wm-command.md) 訊息傳送至視窗程式。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-459">When the user chooses a command item from a menu, the system sends a [**WM\_COMMAND**](wm-command.md) message to the window procedure.</span></span> <span data-ttu-id="9e5bc-460">**WM \_ 命令** 訊息的 *wParam* 參數的低序位文字包含所選項目的識別碼。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-460">The low-order word of the **WM\_COMMAND** message's *wParam* parameter contains the identifier of the chosen item.</span></span> <span data-ttu-id="9e5bc-461">視窗程式應檢查識別碼，並據以處理訊息。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-461">The window procedure should examine the identifier and process the message accordingly.</span></span>

<span data-ttu-id="9e5bc-462">您可以使用 [**MENUINFO**](/windows/win32/api/winuser/ns-winuser-menuinfo) 結構來儲存功能表的資訊。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-462">You can save information for a menu using the [**MENUINFO**](/windows/win32/api/winuser/ns-winuser-menuinfo) structure.</span></span> <span data-ttu-id="9e5bc-463">如果功能表是以 **MENUINFO** 定義。**dwStyle** 的 MNS \_ NOTIFYBYPOS 值，當選取專案時，系統會傳送 [**Wm \_ MENUCOMMAND**](wm-menucommand.md) 而非 [**wm \_ 命令**](wm-command.md) 。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-463">If the menu is defined with a **MENUINFO**.**dwStyle** value of MNS\_NOTIFYBYPOS, the system sends [**WM\_MENUCOMMAND**](wm-menucommand.md) instead of the [**WM\_COMMAND**](wm-command.md) when an item is selected.</span></span> <span data-ttu-id="9e5bc-464">這可讓您存取 **MENUINFO** 結構中的資訊，也可直接提供所選取專案的索引。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-464">This allows you to access the information in the **MENUINFO** structure and also provides the index of the selected item directly.</span></span>

<span data-ttu-id="9e5bc-465">並非所有功能表都可透過視窗的功能表列來存取。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-465">Not all menus are accessible through a window's menu bar.</span></span> <span data-ttu-id="9e5bc-466">當使用者按一下特定位置的滑鼠右鍵時，許多應用程式會顯示快捷方式功能表。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-466">Many applications display shortcut menus when the user clicks the right mouse button at a specific location.</span></span> <span data-ttu-id="9e5bc-467">這類應用程式應該處理 [**WM \_ CONTEXTMENU**](wm-contextmenu.md) 訊息，並在適當的情況下顯示快捷方式功能表。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-467">Such applications should process the [**WM\_CONTEXTMENU**](wm-contextmenu.md) message and display a shortcut menu, if appropriate.</span></span> <span data-ttu-id="9e5bc-468">如果應用程式未顯示快捷方式功能表，則應該將 **WM \_ CONTEXTMENU** 訊息傳遞至 [**DefWindowProc**](/windows/desktop/api/winuser/nf-winuser-defwindowproca) 函式，以進行預設處理。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-468">If an application does not display a shortcut menu, it should pass the **WM\_CONTEXTMENU** message to the [**DefWindowProc**](/windows/desktop/api/winuser/nf-winuser-defwindowproca) function for default processing.</span></span>

<span data-ttu-id="9e5bc-469">當使用者放開滑鼠右鍵，而游標位於功能表項目上時，就會傳送 [**WM \_ MENURBUTTONUP**](wm-menurbuttonup.md) 訊息。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-469">The [**WM\_MENURBUTTONUP**](wm-menurbuttonup.md) message is sent when the user releases the right mouse button while the cursor is on a menu item.</span></span> <span data-ttu-id="9e5bc-470">提供此訊息，讓應用程式可以顯示功能表項目的內容相關或快捷方式功能表。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-470">This message is provided so that applications can display a context-sensitive or shortcut menu for a menu item.</span></span>

<span data-ttu-id="9e5bc-471">有幾個訊息只牽涉到拖放功能表。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-471">There are a few messages that only involve drag-and-drop menus.</span></span> <span data-ttu-id="9e5bc-472">當滑鼠游標進入功能表項目，或從專案的中央移動至專案的頂端或底部時，會將 [**WM \_ MENUGETOBJECT**](wm-menugetobject.md) 傳送至拖放功能表的擁有者。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-472">The [**WM\_MENUGETOBJECT**](wm-menugetobject.md) is sent to the owner of a drag-and-drop menu when the mouse cursor enters a menu item or moves from the center of an item to the top or the bottom of an item.</span></span> <span data-ttu-id="9e5bc-473">當使用者實際拖曳功能表項目時，會傳送 [**WM \_ MENUDRAG**](wm-menudrag.md) 訊息。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-473">The [**WM\_MENUDRAG**](wm-menudrag.md) message is sent when the user actually drags a menu item.</span></span>

<span data-ttu-id="9e5bc-474">當下拉功能表或子功能表損毀時，系統會傳送 [**WM \_ UNINITMENUPOPUP**](wm-uninitmenupopup.md) 訊息。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-474">When a drop-down menu or a submenu has been destroyed, the system sends a [**WM\_UNINITMENUPOPUP**](wm-uninitmenupopup.md) message.</span></span>

## <a name="menu-destruction"></a><span data-ttu-id="9e5bc-475">功能表損毀</span><span class="sxs-lookup"><span data-stu-id="9e5bc-475">Menu Destruction</span></span>

<span data-ttu-id="9e5bc-476">如果已將功能表指派給視窗，且該視窗已終結，系統會自動終結功能表及其子功能表，釋出功能表的控制碼和功能表所佔用的記憶體。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-476">If a menu is assigned to a window and that window is destroyed, the system automatically destroys the menu and its submenus, freeing the menu's handle and the memory occupied by the menu.</span></span> <span data-ttu-id="9e5bc-477">系統不會自動摧毀未指派給視窗的功能表。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-477">The system does not automatically destroy a menu that is not assigned to a window.</span></span> <span data-ttu-id="9e5bc-478">應用程式必須藉由呼叫 [**DestroyMenu**](/windows/desktop/api/Winuser/nf-winuser-destroymenu) 函數來終結未指派的功能表。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-478">An application must destroy the unassigned menu by calling the [**DestroyMenu**](/windows/desktop/api/Winuser/nf-winuser-destroymenu) function.</span></span> <span data-ttu-id="9e5bc-479">否則，即使應用程式關閉，功能表仍會繼續存在於記憶體中。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-479">Otherwise, the menu continues to exist in memory even after the application closes.</span></span> <span data-ttu-id="9e5bc-480">若要結束呼叫執行緒的現用功能表，請使用 [**EndMenu**](/windows/desktop/api/Winuser/nf-winuser-endmenu)。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-480">To end the calling thread's active menu, use [**EndMenu**](/windows/desktop/api/Winuser/nf-winuser-endmenu).</span></span> <span data-ttu-id="9e5bc-481">如果平臺不支援 **EndMenu**，請將動態功能表的擁有者傳送至 [**WM \_ CANCELMODE**](/windows/desktop/winmsg/wm-cancelmode) 訊息。</span><span class="sxs-lookup"><span data-stu-id="9e5bc-481">If a platform does not support **EndMenu**, send the owner of the active menu a [**WM\_CANCELMODE**](/windows/desktop/winmsg/wm-cancelmode) message.</span></span>

 

 