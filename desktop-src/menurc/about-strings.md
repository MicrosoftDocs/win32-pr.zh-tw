---
title: 關於字串
description: 本主題討論字串函數。
ms.assetid: f1799fbf-4619-4b19-998e-b1d2f4c19a35
keywords:
- 資源，字串
- 字串
- 字串函數 (string functions)
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 9ff9fa6c9d93ba2f5c089b52b56816cad74bb61c
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/19/2020
ms.locfileid: "106966851"
---
# <a name="about-strings"></a><span data-ttu-id="b78fc-106">關於字串</span><span class="sxs-lookup"><span data-stu-id="b78fc-106">About Strings</span></span>

<span data-ttu-id="b78fc-107">字串函式提供應用程式複製、比較、排序、格式化和轉換字元字串的方法，以及用來判斷字串中每個字元之字元類型的方法。</span><span class="sxs-lookup"><span data-stu-id="b78fc-107">The string functions give applications the means to copy, compare, sort, format, and convert character strings as well as the means to determine the character type of each character in a string.</span></span> <span data-ttu-id="b78fc-108">如果執行應用程式的作業系統支援這些字元集，則所有字串函數都支援單位元組、雙位元組和 Unicode 字元集。</span><span class="sxs-lookup"><span data-stu-id="b78fc-108">All the string functions support the single-byte, double-byte, and Unicode character sets if these character sets are supported by the operating system on which the application is run.</span></span>

<span data-ttu-id="b78fc-109">**安全性警告：** 不當使用字串函式可能會導致您的應用程式發生安全性問題。</span><span class="sxs-lookup"><span data-stu-id="b78fc-109">**Security Warning:** The incorrect use of string functions can cause security problems for your application.</span></span> <span data-ttu-id="b78fc-110">這通常牽涉到緩衝區溢位，這可能會對您的應用程式造成阻絕服務攻擊，或從攻擊者插入可執行程式碼。</span><span class="sxs-lookup"><span data-stu-id="b78fc-110">Typically this involves a buffer overrun which can allow a denial of service attack against your application or the injection of executable code from an attacker.</span></span> <span data-ttu-id="b78fc-111">>strsafe.h 函式可讓您更安全地處理字串，建議您為應用程式提供更好的安全性。</span><span class="sxs-lookup"><span data-stu-id="b78fc-111">The Strsafe functions enable the safer handling of strings and are recommended for better security for your application.</span></span> <span data-ttu-id="b78fc-112">如需這些函式的詳細資訊，請參閱 [使用 >strsafe.h .H 函數](strsafe-ovw.md)。</span><span class="sxs-lookup"><span data-stu-id="b78fc-112">For more information on these functions, see [Using the Strsafe.h Functions](strsafe-ovw.md).</span></span>

<span data-ttu-id="b78fc-113">本節將討論下列主題。</span><span class="sxs-lookup"><span data-stu-id="b78fc-113">This section discusses the following topics.</span></span>

-   [<span data-ttu-id="b78fc-114">與 C Run-Time 字串函數的比較</span><span class="sxs-lookup"><span data-stu-id="b78fc-114">Comparison with C Run-Time String Functions</span></span>](#comparison-with-c-run-time-string-functions)
-   [<span data-ttu-id="b78fc-115">字串資源</span><span class="sxs-lookup"><span data-stu-id="b78fc-115">String Resources</span></span>](#string-resources)

## <a name="comparison-with-c-run-time-string-functions"></a><span data-ttu-id="b78fc-116">與 C Run-Time 字串函數的比較</span><span class="sxs-lookup"><span data-stu-id="b78fc-116">Comparison with C Run-Time String Functions</span></span>

<span data-ttu-id="b78fc-117">許多字串函式會從標準 C 執行時間 (CRT) 程式庫複製或增強熟悉的字串函式。</span><span class="sxs-lookup"><span data-stu-id="b78fc-117">Many string functions duplicate or enhance familiar string functions from the standard C run-time (CRT) library.</span></span> <span data-ttu-id="b78fc-118">許多增強功能可讓字串函數使用 Unicode 或擴充字元集。</span><span class="sxs-lookup"><span data-stu-id="b78fc-118">Many of the enhancements enable the string functions to work with Unicode or extended character sets.</span></span> <span data-ttu-id="b78fc-119">下表顯示 CRT 函式、支援 Unicode 的 Windows 函式 (，與 CRT 函數) 和 >strsafe.h 函式不同。</span><span class="sxs-lookup"><span data-stu-id="b78fc-119">The following table shows the CRT functions, the Windows functions (that support Unicode, unlike the CRT functions), and the StrSafe functions.</span></span>



| <span data-ttu-id="b78fc-120">CRT 字串函數</span><span class="sxs-lookup"><span data-stu-id="b78fc-120">CRT String Function</span></span>                                       | <span data-ttu-id="b78fc-121">Windows String 函數</span><span class="sxs-lookup"><span data-stu-id="b78fc-121">Windows String Function</span></span>    | <span data-ttu-id="b78fc-122">>strsafe.h 函式</span><span class="sxs-lookup"><span data-stu-id="b78fc-122">StrSafe Function</span></span>                                                                                                                                                                                                                                                                                                                                                                                          |
|-----------------------------------------------------------|----------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="b78fc-123">strcat</span><span class="sxs-lookup"><span data-stu-id="b78fc-123">strcat</span></span>](/cpp/c-runtime-library/reference/strcat-wcscat-mbscat?view=vs-2019) | [<span data-ttu-id="b78fc-124">**lstrcat**</span><span class="sxs-lookup"><span data-stu-id="b78fc-124">**lstrcat**</span></span>](/windows/desktop/api/Winbase/nf-winbase-lstrcata) | <dl> <span data-ttu-id="b78fc-125"><dt>[**StringCchCat**](/windows/desktop/api/Strsafe/nf-strsafe-stringcchcata)</dt> <dt>[**StringCchCatEx**](/windows/desktop/api/Strsafe/nf-strsafe-stringcchcatexa)</dt> <dt>[**StringCbCat**](/windows/desktop/api/Strsafe/nf-strsafe-stringcbcata)</dt> <dt>[**StringCbCatEx**](/windows/desktop/api/Strsafe/nf-strsafe-stringcbcatexa)</dt></span><span class="sxs-lookup"><span data-stu-id="b78fc-125"><dt>[**StringCchCat**](/windows/desktop/api/Strsafe/nf-strsafe-stringcchcata)</dt> <dt>[**StringCchCatEx**](/windows/desktop/api/Strsafe/nf-strsafe-stringcchcatexa)</dt> <dt>[**StringCbCat**](/windows/desktop/api/Strsafe/nf-strsafe-stringcbcata)</dt> <dt>[**StringCbCatEx**](/windows/desktop/api/Strsafe/nf-strsafe-stringcbcatexa)</dt></span></span> </dl>         |
| [<span data-ttu-id="b78fc-126">strcmp</span><span class="sxs-lookup"><span data-stu-id="b78fc-126">strcmp</span></span>](/cpp/c-runtime-library/reference/strcmp-wcscmp-mbscmp?view=vs-2019) | [<span data-ttu-id="b78fc-127">**lstrcmp**</span><span class="sxs-lookup"><span data-stu-id="b78fc-127">**lstrcmp**</span></span>](/windows/desktop/api/Winbase/nf-winbase-lstrcmpa) | <span data-ttu-id="b78fc-128">沒有對等的函式 () </span><span class="sxs-lookup"><span data-stu-id="b78fc-128">(no equivalent function)</span></span>                                                                                                                                                                                                                                                                                                                                                                                  |
| [<span data-ttu-id="b78fc-129">strcpy</span><span class="sxs-lookup"><span data-stu-id="b78fc-129">strcpy</span></span>](/cpp/c-runtime-library/reference/strcpy-wcscpy-mbscpy?view=vs-2019) | [<span data-ttu-id="b78fc-130">**lstrcpy**</span><span class="sxs-lookup"><span data-stu-id="b78fc-130">**lstrcpy**</span></span>](/windows/desktop/api/Winbase/nf-winbase-lstrcpya) | <dl> <span data-ttu-id="b78fc-131"><dt>[**StringCchCopy**](/windows/desktop/api/Strsafe/nf-strsafe-stringcchcopya)</dt> <dt>[**StringCchCopyEx**](/windows/desktop/api/Strsafe/nf-strsafe-stringcchcopyexa)</dt> <dt>[**StringCbCopy**](/windows/desktop/api/Strsafe/nf-strsafe-stringcbcopya)</dt> <dt>[**StringCbCopyEx**](/windows/desktop/api/Strsafe/nf-strsafe-stringcbcopyexa)</dt></span><span class="sxs-lookup"><span data-stu-id="b78fc-131"><dt>[**StringCchCopy**](/windows/desktop/api/Strsafe/nf-strsafe-stringcchcopya)</dt> <dt>[**StringCchCopyEx**](/windows/desktop/api/Strsafe/nf-strsafe-stringcchcopyexa)</dt> <dt>[**StringCbCopy**](/windows/desktop/api/Strsafe/nf-strsafe-stringcbcopya)</dt> <dt>[**StringCbCopyEx**](/windows/desktop/api/Strsafe/nf-strsafe-stringcbcopyexa)</dt></span></span> </dl> |
| [<span data-ttu-id="b78fc-132">strlen</span><span class="sxs-lookup"><span data-stu-id="b78fc-132">strlen</span></span>](/cpp/c-runtime-library/reference/strlen-wcslen-mbslen-mbslen-l-mbstrlen-mbstrlen-l?view=vs-2019) | [<span data-ttu-id="b78fc-133">**lstrlen**</span><span class="sxs-lookup"><span data-stu-id="b78fc-133">**lstrlen**</span></span>](/windows/desktop/api/Winbase/nf-winbase-lstrlena) | <dl> <span data-ttu-id="b78fc-134"><dt>[**StringCchLength**](/windows/desktop/api/Strsafe/nf-strsafe-stringcchlengtha)</dt> <dt> [ **StringCbLength**](/windows/desktop/api/Strsafe/nf-strsafe-stringcblengtha)</dt></span><span class="sxs-lookup"><span data-stu-id="b78fc-134"><dt>[**StringCchLength**](/windows/desktop/api/Strsafe/nf-strsafe-stringcchlengtha)</dt> <dt>[**StringCbLength**](/windows/desktop/api/Strsafe/nf-strsafe-stringcblengtha)</dt></span></span> </dl>                                                                                                                                                                                       |



 

<span data-ttu-id="b78fc-135">例如， **strlen** 函式一律會傳回字串中的位元組數目，但 [**lstrlen**](/windows/desktop/api/Winbase/nf-winbase-lstrlena) 函數會傳回 **TCHAR** 值的數目，這是指 ANSI 版本的函數或 Unicode 版本的 **WCHAR** 值的位元組數。</span><span class="sxs-lookup"><span data-stu-id="b78fc-135">The **strlen** function, for example, always returns the number of bytes in a string, but the [**lstrlen**](/windows/desktop/api/Winbase/nf-winbase-lstrlena) function returns the number of **TCHAR** values, which refers to bytes for ANSI versions of the function or **WCHAR** values for Unicode versions.</span></span>

<span data-ttu-id="b78fc-136">下列字串函數與標準 C 函式（例如 **tolower** 和 **toupper** ）不同，因為它們會在字元集中的任何字元上運作。</span><span class="sxs-lookup"><span data-stu-id="b78fc-136">The following string functions differ from standard C functions such as **tolower** and **toupper** in that they operate on any character in a character set.</span></span> <span data-ttu-id="b78fc-137">例如，藉由使用 [**CharLower**](/windows/desktop/api/Winuser/nf-winuser-charlowera) 函式，應用程式可以將大寫 U 轉換成變音符 (Ü) 為小寫 (Ü) 。</span><span class="sxs-lookup"><span data-stu-id="b78fc-137">By using the [**CharLower**](/windows/desktop/api/Winuser/nf-winuser-charlowera) function, for example, an application can convert an uppercase U with an umlaut (Ü) to lowercase (ü).</span></span> <span data-ttu-id="b78fc-138">如需字元集的詳細資訊，請參閱 [單一位元組字元集](/windows/desktop/Intl/single-byte-character-sets)。</span><span class="sxs-lookup"><span data-stu-id="b78fc-138">For more information about character sets, see [Single-byte Character Sets](/windows/desktop/Intl/single-byte-character-sets).</span></span>



| <span data-ttu-id="b78fc-139">函式</span><span class="sxs-lookup"><span data-stu-id="b78fc-139">Function</span></span>                               | <span data-ttu-id="b78fc-140">描述</span><span class="sxs-lookup"><span data-stu-id="b78fc-140">Description</span></span>                                   |
|----------------------------------------|-----------------------------------------------|
| [<span data-ttu-id="b78fc-141">**CharLower**</span><span class="sxs-lookup"><span data-stu-id="b78fc-141">**CharLower**</span></span>](/windows/desktop/api/Winuser/nf-winuser-charlowera)         | <span data-ttu-id="b78fc-142">將字元或字串轉換為小寫。</span><span class="sxs-lookup"><span data-stu-id="b78fc-142">Converts a character or string to lowercase.</span></span>  |
| [<span data-ttu-id="b78fc-143">**CharLowerBuff**</span><span class="sxs-lookup"><span data-stu-id="b78fc-143">**CharLowerBuff**</span></span>](/windows/desktop/api/Winuser/nf-winuser-charlowerbuffa) | <span data-ttu-id="b78fc-144">將字元字串轉換成小寫。</span><span class="sxs-lookup"><span data-stu-id="b78fc-144">Converts a character string to lowercase.</span></span>     |
| [<span data-ttu-id="b78fc-145">**CharNext**</span><span class="sxs-lookup"><span data-stu-id="b78fc-145">**CharNext**</span></span>](/windows/desktop/api/Winuser/nf-winuser-charnexta)           | <span data-ttu-id="b78fc-146">移至字串中的下一個字元。</span><span class="sxs-lookup"><span data-stu-id="b78fc-146">Moves to the next character in a string.</span></span>      |
| [<span data-ttu-id="b78fc-147">**CharPrev**</span><span class="sxs-lookup"><span data-stu-id="b78fc-147">**CharPrev**</span></span>](/windows/desktop/api/Winuser/nf-winuser-charpreva)           | <span data-ttu-id="b78fc-148">移至字串中的前一個字元。</span><span class="sxs-lookup"><span data-stu-id="b78fc-148">Moves to the preceding character in a string.</span></span> |
| [<span data-ttu-id="b78fc-149">**CharUpper**</span><span class="sxs-lookup"><span data-stu-id="b78fc-149">**CharUpper**</span></span>](/windows/desktop/api/Winuser/nf-winuser-charuppera)         | <span data-ttu-id="b78fc-150">將字元或字串轉換為大寫。</span><span class="sxs-lookup"><span data-stu-id="b78fc-150">Converts a character or string to uppercase.</span></span>  |
| [<span data-ttu-id="b78fc-151">**CharUpperBuff**</span><span class="sxs-lookup"><span data-stu-id="b78fc-151">**CharUpperBuff**</span></span>](/windows/desktop/api/Winuser/nf-winuser-charupperbuffa) | <span data-ttu-id="b78fc-152">將字串轉換為大寫。</span><span class="sxs-lookup"><span data-stu-id="b78fc-152">Converts a string to uppercase.</span></span>               |



 

<span data-ttu-id="b78fc-153">下列字串函式會根據使用者所選取之語言的語義來決定字元。</span><span class="sxs-lookup"><span data-stu-id="b78fc-153">The following string functions make determinations about a character based on the semantics of the language selected by the user.</span></span> <span data-ttu-id="b78fc-154">這些函式是 Unicode 啟用的功能。</span><span class="sxs-lookup"><span data-stu-id="b78fc-154">These functions are Unicode enabled.</span></span>



| <span data-ttu-id="b78fc-155">函式</span><span class="sxs-lookup"><span data-stu-id="b78fc-155">Function</span></span>                                         | <span data-ttu-id="b78fc-156">描述</span><span class="sxs-lookup"><span data-stu-id="b78fc-156">Description</span></span>                                     |
|--------------------------------------------------|-------------------------------------------------|
| [<span data-ttu-id="b78fc-157">**IsCharAlpha**</span><span class="sxs-lookup"><span data-stu-id="b78fc-157">**IsCharAlpha**</span></span>](/windows/desktop/api/Winuser/nf-winuser-ischaralphaa)               | <span data-ttu-id="b78fc-158">判斷字元是否為字母。</span><span class="sxs-lookup"><span data-stu-id="b78fc-158">Determines whether a character is alphabetic.</span></span>   |
| [<span data-ttu-id="b78fc-159">**IsCharAlphaNumeric**</span><span class="sxs-lookup"><span data-stu-id="b78fc-159">**IsCharAlphaNumeric**</span></span>](/windows/desktop/api/Winuser/nf-winuser-ischaralphanumerica) | <span data-ttu-id="b78fc-160">判斷字元是否為英數位元。</span><span class="sxs-lookup"><span data-stu-id="b78fc-160">Determines whether a character is alphanumeric.</span></span> |
| [<span data-ttu-id="b78fc-161">**IsCharLower**</span><span class="sxs-lookup"><span data-stu-id="b78fc-161">**IsCharLower**</span></span>](/windows/desktop/api/Winuser/nf-winuser-ischarlowera)               | <span data-ttu-id="b78fc-162">判斷字元是否為小寫。</span><span class="sxs-lookup"><span data-stu-id="b78fc-162">Determines whether a character is lowercase.</span></span>    |
| [<span data-ttu-id="b78fc-163">**IsCharUpper**</span><span class="sxs-lookup"><span data-stu-id="b78fc-163">**IsCharUpper**</span></span>](/windows/desktop/api/Winuser/nf-winuser-ischaruppera)               | <span data-ttu-id="b78fc-164">判斷字元是否為大寫。</span><span class="sxs-lookup"><span data-stu-id="b78fc-164">Determines whether a character is uppercase.</span></span>    |



 

<span data-ttu-id="b78fc-165">下表顯示 standard C 執行時間 (CRT) 函數的 Unicode 擴充功能。</span><span class="sxs-lookup"><span data-stu-id="b78fc-165">The following table shows the Unicode extensions to the standard C run-time (CRT) functions.</span></span> <span data-ttu-id="b78fc-166">如先前所述，>strsafe.h 函式可讓您更安全地處理字串，因此建議您為應用程式提供更好的安全性。</span><span class="sxs-lookup"><span data-stu-id="b78fc-166">As mentioned previously, the StrSafe functions enable safer handling of strings and are recommended for better security for your application.</span></span>



| <span data-ttu-id="b78fc-167">標準 CRT 函數</span><span class="sxs-lookup"><span data-stu-id="b78fc-167">Standard CRT function</span></span>                                       | <span data-ttu-id="b78fc-168">String 函數</span><span class="sxs-lookup"><span data-stu-id="b78fc-168">String Function</span></span>                | <span data-ttu-id="b78fc-169">>strsafe.h 函式</span><span class="sxs-lookup"><span data-stu-id="b78fc-169">StrSafe Function</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                  |
|-------------------------------------------------------------|--------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="b78fc-170">sprintf</span><span class="sxs-lookup"><span data-stu-id="b78fc-170">sprintf</span></span>](/cpp/c-runtime-library/reference/sprintf-sprintf-l-swprintf-swprintf-l-swprintf-l?view=vs-2019)  | [<span data-ttu-id="b78fc-171">**wsprintf**</span><span class="sxs-lookup"><span data-stu-id="b78fc-171">**wsprintf**</span></span>](/windows/desktop/api/Winuser/nf-winuser-wsprintfa)   | <dl> <span data-ttu-id="b78fc-172"><dt>[**StringCchPrintf**](/windows/desktop/api/Strsafe/nf-strsafe-stringcchprintfa)</dt> <dt>[**StringCchPrintfEx**](/windows/desktop/api/Strsafe/nf-strsafe-stringcchprintfexa)</dt> <dt>[**StringCbPrintf**](/windows/desktop/api/Strsafe/nf-strsafe-stringcbprintfa)</dt> <dt>[**StringCbPrintfEx**](/windows/desktop/api/Strsafe/nf-strsafe-stringcbprintfexa)</dt></span><span class="sxs-lookup"><span data-stu-id="b78fc-172"><dt>[**StringCchPrintf**](/windows/desktop/api/Strsafe/nf-strsafe-stringcchprintfa)</dt> <dt>[**StringCchPrintfEx**](/windows/desktop/api/Strsafe/nf-strsafe-stringcchprintfexa)</dt> <dt>[**StringCbPrintf**](/windows/desktop/api/Strsafe/nf-strsafe-stringcbprintfa)</dt> <dt>[**StringCbPrintfEx**](/windows/desktop/api/Strsafe/nf-strsafe-stringcbprintfexa)</dt></span></span> </dl>         |
| [<span data-ttu-id="b78fc-173">vsprintf</span><span class="sxs-lookup"><span data-stu-id="b78fc-173">vsprintf</span></span>](/cpp/c-runtime-library/reference/vsprintf-vsprintf-l-vswprintf-vswprintf-l-vswprintf-l?view=vs-2019) | [<span data-ttu-id="b78fc-174">**wvsprintf**</span><span class="sxs-lookup"><span data-stu-id="b78fc-174">**wvsprintf**</span></span>](/windows/desktop/api/Winuser/nf-winuser-wvsprintfa) | <dl> <span data-ttu-id="b78fc-175"><dt>[**StringCchVPrintf**](/windows/desktop/api/Strsafe/nf-strsafe-stringcchvprintfa)</dt> <dt>[**StringCchVPrintfEx**](/windows/desktop/api/Strsafe/nf-strsafe-stringcchvprintfexa)</dt> <dt>[**StringCbVPrintf**](/windows/desktop/api/Strsafe/nf-strsafe-stringcbvprintfa)</dt> <dt>[**StringCbVPrintfEx**](/windows/desktop/api/Strsafe/nf-strsafe-stringcbvprintfexa)</dt></span><span class="sxs-lookup"><span data-stu-id="b78fc-175"><dt>[**StringCchVPrintf**](/windows/desktop/api/Strsafe/nf-strsafe-stringcchvprintfa)</dt> <dt>[**StringCchVPrintfEx**](/windows/desktop/api/Strsafe/nf-strsafe-stringcchvprintfexa)</dt> <dt>[**StringCbVPrintf**](/windows/desktop/api/Strsafe/nf-strsafe-stringcbvprintfa)</dt> <dt>[**StringCbVPrintfEx**](/windows/desktop/api/Strsafe/nf-strsafe-stringcbvprintfexa)</dt></span></span> </dl> |



 

## <a name="string-resources"></a><span data-ttu-id="b78fc-176">字串資源</span><span class="sxs-lookup"><span data-stu-id="b78fc-176">String Resources</span></span>

<span data-ttu-id="b78fc-177">在資源中維護字元字串的應用程式可以最少的努力轉譯成新的語言。</span><span class="sxs-lookup"><span data-stu-id="b78fc-177">An application that maintains character strings in resources can be translated into new languages with minimum effort.</span></span> <span data-ttu-id="b78fc-178">您可以直接轉譯資源檔中的字串並重新連結應用程式，而不是搜尋來源模組中的字串。</span><span class="sxs-lookup"><span data-stu-id="b78fc-178">Instead of searching for strings in the source modules, you can simply translate the strings in the resource file and relink the application.</span></span> <span data-ttu-id="b78fc-179">此外，使用字串資源可簡化從相同原始程式檔建立 Unicode 和非 Unicode 版應用程式的程式。</span><span class="sxs-lookup"><span data-stu-id="b78fc-179">In addition, using string resources simplifies creation of Unicode and non-Unicode versions of the application from the same source files.</span></span>

<span data-ttu-id="b78fc-180">[**Loadstring 時**](/windows/desktop/api/Winuser/nf-winuser-loadstringa)函式會從應用程式的可執行檔載入字串資源。</span><span class="sxs-lookup"><span data-stu-id="b78fc-180">The [**LoadString**](/windows/desktop/api/Winuser/nf-winuser-loadstringa) function loads a string resource from an application's executable file.</span></span> <span data-ttu-id="b78fc-181">[**FormatMessage**](/windows/desktop/api/winbase/nf-winbase-formatmessage)函式會載入字串資源，並解釋可能內嵌在字串中的格式化選項。</span><span class="sxs-lookup"><span data-stu-id="b78fc-181">The [**FormatMessage**](/windows/desktop/api/winbase/nf-winbase-formatmessage) function loads a string resource and interprets formatting options that may be embedded in the string.</span></span>

<span data-ttu-id="b78fc-182">二進位格式的資源會以 Unicode 格式儲存。</span><span class="sxs-lookup"><span data-stu-id="b78fc-182">Resources in binary form are stored in Unicode format.</span></span> <span data-ttu-id="b78fc-183">載入資源時，應用程式可以使用 Unicode 版本的資源函式 ([**LoadStringW**](/windows/desktop/api/Winuser/nf-winuser-loadstringa)，例如) ，以 unicode 資料的形式取得資源。</span><span class="sxs-lookup"><span data-stu-id="b78fc-183">When loading resources, applications can use the Unicode version of the resource functions ([**LoadStringW**](/windows/desktop/api/Winuser/nf-winuser-loadstringa), for example) to obtain resources as Unicode data.</span></span>

<span data-ttu-id="b78fc-184">16位字串資源的長度上限為255個字元。</span><span class="sxs-lookup"><span data-stu-id="b78fc-184">For 16-bit string resources, 255 characters is the maximum length.</span></span> <span data-ttu-id="b78fc-185">若為32位字串資源，65535個字元是最大長度。</span><span class="sxs-lookup"><span data-stu-id="b78fc-185">For 32-bit string resources, 65535 characters is the maximum length.</span></span>

 

 