---
title: '功能表 (功能表和其他資源) '
description: 本節討論功能表。
ms.assetid: vs|winui|~\winui\windowsuserinterface\resources\menus.htm
keywords:
- 資源、功能表
- 功能表，關於
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c376aa1d2f55fa482ca7a2f98f57ae15236bf26b
ms.sourcegitcommit: 8fa6614b715bddf14648cce36d2df22e5232801a
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 12/10/2020
ms.locfileid: "104383522"
---
# <a name="menus-menus-and-other-resources"></a><span data-ttu-id="5666e-105">功能表 (功能表和其他資源) </span><span class="sxs-lookup"><span data-stu-id="5666e-105">Menus (Menus and Other Resources)</span></span>

<span data-ttu-id="5666e-106">本節說明功能表並說明其使用方式。</span><span class="sxs-lookup"><span data-stu-id="5666e-106">This section describes menus and explains how to use them.</span></span>

### <a name="in-this-section"></a><span data-ttu-id="5666e-107">本節內容</span><span class="sxs-lookup"><span data-stu-id="5666e-107">In This Section</span></span>



| <span data-ttu-id="5666e-108">Name</span><span class="sxs-lookup"><span data-stu-id="5666e-108">Name</span></span>                                 | <span data-ttu-id="5666e-109">描述</span><span class="sxs-lookup"><span data-stu-id="5666e-109">Description</span></span>                                                  |
|--------------------------------------|--------------------------------------------------------------|
| [<span data-ttu-id="5666e-110">關於功能表</span><span class="sxs-lookup"><span data-stu-id="5666e-110">About Menus</span></span>](about-menus.md)       | <span data-ttu-id="5666e-111">討論功能表。</span><span class="sxs-lookup"><span data-stu-id="5666e-111">Discusses menus.</span></span><br/>                                  |
| [<span data-ttu-id="5666e-112">使用功能表</span><span class="sxs-lookup"><span data-stu-id="5666e-112">Using Menus</span></span>](using-menus.md)       | <span data-ttu-id="5666e-113">提供與功能表相關之工作的程式碼範例。</span><span class="sxs-lookup"><span data-stu-id="5666e-113">Provides code examples of tasks related to menus.</span></span><br/> |
| [<span data-ttu-id="5666e-114">功能表參考</span><span class="sxs-lookup"><span data-stu-id="5666e-114">Menu Reference</span></span>](menu-reference.md) | <span data-ttu-id="5666e-115">包含 API 參考。</span><span class="sxs-lookup"><span data-stu-id="5666e-115">Contains the API reference.</span></span><br/>                       |



 

### <a name="menu-functions"></a><span data-ttu-id="5666e-116">功能表函數</span><span class="sxs-lookup"><span data-stu-id="5666e-116">Menu Functions</span></span>



| <span data-ttu-id="5666e-117">Name</span><span class="sxs-lookup"><span data-stu-id="5666e-117">Name</span></span>                                                             | <span data-ttu-id="5666e-118">描述</span><span class="sxs-lookup"><span data-stu-id="5666e-118">Description</span></span>                                                                                                                                                                                                                                                                                                                                                                                                   |
|------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="5666e-119">**AppendMenu**</span><span class="sxs-lookup"><span data-stu-id="5666e-119">**AppendMenu**</span></span>](/windows/desktop/api/Winuser/nf-winuser-appendmenua)                                 | <span data-ttu-id="5666e-120">將新專案附加至指定功能表列、下拉式功能表、子功能表或快捷方式功能表的結尾。</span><span class="sxs-lookup"><span data-stu-id="5666e-120">Appends a new item to the end of the specified menu bar, drop-down menu, submenu, or shortcut menu.</span></span> <span data-ttu-id="5666e-121">您可以使用這個函數來指定功能表項目的內容、外觀和行為。</span><span class="sxs-lookup"><span data-stu-id="5666e-121">You can use this function to specify the content, appearance, and behavior of the menu item.</span></span> <br/>                                                                                                                                                                                                  |
| [<span data-ttu-id="5666e-122">**CheckMenuItem**</span><span class="sxs-lookup"><span data-stu-id="5666e-122">**CheckMenuItem**</span></span>](/windows/desktop/api/Winuser/nf-winuser-checkmenuitem)                           | <span data-ttu-id="5666e-123">將指定之功能表項目的核取記號屬性狀態設定為 [已選取] 或 [清除]。</span><span class="sxs-lookup"><span data-stu-id="5666e-123">Sets the state of the specified menu item's check-mark attribute to either selected or clear.</span></span><br/>                                                                                                                                                                                                                                                                                                      |
| [<span data-ttu-id="5666e-124">**CheckMenuRadioItem**</span><span class="sxs-lookup"><span data-stu-id="5666e-124">**CheckMenuRadioItem**</span></span>](/windows/desktop/api/Winuser/nf-winuser-checkmenuradioitem)                 | <span data-ttu-id="5666e-125">檢查指定的功能表項目，並使其成為單選項目。</span><span class="sxs-lookup"><span data-stu-id="5666e-125">Checks a specified menu item and makes it a radio item.</span></span> <span data-ttu-id="5666e-126">同時，此函式會清除相關聯群組中的所有其他功能表項目，並清除這些專案的選項按鈕類型旗標。</span><span class="sxs-lookup"><span data-stu-id="5666e-126">At the same time, the function clears all other menu items in the associated group and clears the radio-item type flag for those items.</span></span><br/>                                                                                                                                                                                                    |
| [<span data-ttu-id="5666e-127">**CreateMenu**</span><span class="sxs-lookup"><span data-stu-id="5666e-127">**CreateMenu**</span></span>](/windows/desktop/api/Winuser/nf-winuser-createmenu)                                 | <span data-ttu-id="5666e-128">建立功能表。</span><span class="sxs-lookup"><span data-stu-id="5666e-128">Creates a menu.</span></span> <span data-ttu-id="5666e-129">此功能表一開始是空的，但您可以使用 [**InsertMenuItem**](/windows/desktop/api/Winuser/nf-winuser-insertmenuitema)、 [**AppendMenu**](/windows/desktop/api/Winuser/nf-winuser-appendmenua)和 [**InsertMenu**](/windows/desktop/api/Winuser/nf-winuser-insertmenua) 函數來填入功能表項目。</span><span class="sxs-lookup"><span data-stu-id="5666e-129">The menu is initially empty, but it can be filled with menu items by using the [**InsertMenuItem**](/windows/desktop/api/Winuser/nf-winuser-insertmenuitema), [**AppendMenu**](/windows/desktop/api/Winuser/nf-winuser-appendmenua), and [**InsertMenu**](/windows/desktop/api/Winuser/nf-winuser-insertmenua) functions.</span></span> <br/>                                                                                                                                                                        |
| [<span data-ttu-id="5666e-130">**CreatePopupMenu**</span><span class="sxs-lookup"><span data-stu-id="5666e-130">**CreatePopupMenu**</span></span>](/windows/desktop/api/Winuser/nf-winuser-createpopupmenu)                       | <span data-ttu-id="5666e-131">建立下拉式選單、子功能表或快捷方式功能表。</span><span class="sxs-lookup"><span data-stu-id="5666e-131">Creates a drop-down menu, submenu, or shortcut menu.</span></span> <span data-ttu-id="5666e-132">此功能表一開始是空的。</span><span class="sxs-lookup"><span data-stu-id="5666e-132">The menu is initially empty.</span></span> <span data-ttu-id="5666e-133">您可以使用 [**InsertMenuItem**](/windows/desktop/api/Winuser/nf-winuser-insertmenuitema) 函數來插入或附加功能表項目。</span><span class="sxs-lookup"><span data-stu-id="5666e-133">You can insert or append menu items by using the [**InsertMenuItem**](/windows/desktop/api/Winuser/nf-winuser-insertmenuitema) function.</span></span> <span data-ttu-id="5666e-134">您也可以使用 [**InsertMenu**](/windows/desktop/api/Winuser/nf-winuser-insertmenua) 函式來插入功能表項目，並使用 [**AppendMenu**](/windows/desktop/api/Winuser/nf-winuser-appendmenua) 函數來附加功能表項目。</span><span class="sxs-lookup"><span data-stu-id="5666e-134">You can also use the [**InsertMenu**](/windows/desktop/api/Winuser/nf-winuser-insertmenua) function to insert menu items and the [**AppendMenu**](/windows/desktop/api/Winuser/nf-winuser-appendmenua) function to append menu items.</span></span><br/>                                                  |
| [<span data-ttu-id="5666e-135">**DeleteMenu**</span><span class="sxs-lookup"><span data-stu-id="5666e-135">**DeleteMenu**</span></span>](/windows/desktop/api/Winuser/nf-winuser-deletemenu)                                 | <span data-ttu-id="5666e-136">從指定的功能表中刪除專案。</span><span class="sxs-lookup"><span data-stu-id="5666e-136">Deletes an item from the specified menu.</span></span> <span data-ttu-id="5666e-137">如果功能表項目開啟功能表或子功能表，此函式會終結功能表或子功能表的控制碼，並釋出功能表或子功能表所使用的記憶體。</span><span class="sxs-lookup"><span data-stu-id="5666e-137">If the menu item opens a menu or submenu, this function destroys the handle to the menu or submenu and frees the memory used by the menu or submenu.</span></span> <br/>                                                                                                                                                                                                     |
| [<span data-ttu-id="5666e-138">**DestroyMenu**</span><span class="sxs-lookup"><span data-stu-id="5666e-138">**DestroyMenu**</span></span>](/windows/desktop/api/Winuser/nf-winuser-destroymenu)                               | <span data-ttu-id="5666e-139">終結指定的功能表，並釋出功能表所佔用的任何記憶體。</span><span class="sxs-lookup"><span data-stu-id="5666e-139">Destroys the specified menu and frees any memory that the menu occupies.</span></span> <br/>                                                                                                                                                                                                                                                                                                                          |
| [<span data-ttu-id="5666e-140">**DrawMenuBar**</span><span class="sxs-lookup"><span data-stu-id="5666e-140">**DrawMenuBar**</span></span>](/windows/desktop/api/Winuser/nf-winuser-drawmenubar)                               | <span data-ttu-id="5666e-141">重新繪製指定之視窗的功能表列。</span><span class="sxs-lookup"><span data-stu-id="5666e-141">Redraws the menu bar of the specified window.</span></span> <span data-ttu-id="5666e-142">如果功能表列在系統建立視窗之後變更，則必須呼叫此函式來繪製已變更的功能表列。</span><span class="sxs-lookup"><span data-stu-id="5666e-142">If the menu bar changes after the system has created the window, this function must be called to draw the changed menu bar.</span></span> <br/>                                                                                                                                                                                                                         |
| [<span data-ttu-id="5666e-143">**EnableMenuItem**</span><span class="sxs-lookup"><span data-stu-id="5666e-143">**EnableMenuItem**</span></span>](/windows/desktop/api/Winuser/nf-winuser-enablemenuitem)                         | <span data-ttu-id="5666e-144">啟用、停用或停用指定功能表項目的灰色。</span><span class="sxs-lookup"><span data-stu-id="5666e-144">Enables, disables, or grays the specified menu item.</span></span> <br/>                                                                                                                                                                                                                                                                                                                                              |
| [<span data-ttu-id="5666e-145">**EndMenu**</span><span class="sxs-lookup"><span data-stu-id="5666e-145">**EndMenu**</span></span>](/windows/desktop/api/Winuser/nf-winuser-endmenu)                                       | <span data-ttu-id="5666e-146">結束呼叫執行緒的現用功能表。</span><span class="sxs-lookup"><span data-stu-id="5666e-146">Ends the calling thread's active menu.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                             |
| [<span data-ttu-id="5666e-147">**GetMenu**</span><span class="sxs-lookup"><span data-stu-id="5666e-147">**GetMenu**</span></span>](/windows/desktop/api/Winuser/nf-winuser-getmenu)                                       | <span data-ttu-id="5666e-148">抓取指派給指定視窗之功能表的控制碼。</span><span class="sxs-lookup"><span data-stu-id="5666e-148">Retrieves a handle to the menu assigned to the specified window.</span></span> <br/>                                                                                                                                                                                                                                                                                                                                  |
| [<span data-ttu-id="5666e-149">**GetMenuBarInfo**</span><span class="sxs-lookup"><span data-stu-id="5666e-149">**GetMenuBarInfo**</span></span>](/windows/desktop/api/Winuser/nf-winuser-getmenubarinfo)                         | <span data-ttu-id="5666e-150">抓取指定功能表列的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="5666e-150">Retrieves information about the specified menu bar.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                |
| [<span data-ttu-id="5666e-151">**GetMenuCheckMarkDimensions**</span><span class="sxs-lookup"><span data-stu-id="5666e-151">**GetMenuCheckMarkDimensions**</span></span>](/windows/desktop/api/Winuser/nf-winuser-getmenucheckmarkdimensions) | <span data-ttu-id="5666e-152">抓取預設核取記號點陣圖的維度。</span><span class="sxs-lookup"><span data-stu-id="5666e-152">Retrieves the dimensions of the default check-mark bitmap.</span></span> <span data-ttu-id="5666e-153">系統會在選取的功能表項目旁邊顯示此點陣圖。</span><span class="sxs-lookup"><span data-stu-id="5666e-153">The system displays this bitmap next to selected menu items.</span></span> <span data-ttu-id="5666e-154">在呼叫 [**SetMenuItemBitmaps**](/windows/desktop/api/Winuser/nf-winuser-setmenuitembitmaps) 函式來取代功能表項目的預設核取記號點陣圖之前，應用程式必須藉由呼叫 [**GetMenuCheckMarkDimensions**](/windows/desktop/api/Winuser/nf-winuser-getmenucheckmarkdimensions)來判斷正確的點陣圖大小。</span><span class="sxs-lookup"><span data-stu-id="5666e-154">Before calling the [**SetMenuItemBitmaps**](/windows/desktop/api/Winuser/nf-winuser-setmenuitembitmaps) function to replace the default check-mark bitmap for a menu item, an application must determine the correct bitmap size by calling [**GetMenuCheckMarkDimensions**](/windows/desktop/api/Winuser/nf-winuser-getmenucheckmarkdimensions).</span></span> <br/> |
| [<span data-ttu-id="5666e-155">**GetMenuDefaultItem**</span><span class="sxs-lookup"><span data-stu-id="5666e-155">**GetMenuDefaultItem**</span></span>](/windows/desktop/api/Winuser/nf-winuser-getmenudefaultitem)                 | <span data-ttu-id="5666e-156">決定指定功能表上的預設功能表項目。</span><span class="sxs-lookup"><span data-stu-id="5666e-156">Determines the default menu item on the specified menu.</span></span><br/>                                                                                                                                                                                                                                                                                                                                            |
| [<span data-ttu-id="5666e-157">**GetMenuInfo**</span><span class="sxs-lookup"><span data-stu-id="5666e-157">**GetMenuInfo**</span></span>](/windows/desktop/api/Winuser/nf-winuser-getmenuinfo)                               | <span data-ttu-id="5666e-158">抓取指定功能表的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="5666e-158">Retrieves information about a specified menu.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                      |
| [<span data-ttu-id="5666e-159">**GetMenuItemCount**</span><span class="sxs-lookup"><span data-stu-id="5666e-159">**GetMenuItemCount**</span></span>](/windows/desktop/api/Winuser/nf-winuser-getmenuitemcount)                     | <span data-ttu-id="5666e-160">抓取指定功能表中的專案數。</span><span class="sxs-lookup"><span data-stu-id="5666e-160">Retrieves the number of items in the specified menu.</span></span> <br/>                                                                                                                                                                                                                                                                                                                                              |
| [<span data-ttu-id="5666e-161">**GetMenuItemID**</span><span class="sxs-lookup"><span data-stu-id="5666e-161">**GetMenuItemID**</span></span>](/windows/desktop/api/Winuser/nf-winuser-getmenuitemid)                           | <span data-ttu-id="5666e-162">抓取功能表中位於指定位置之功能表項目的功能表項目識別碼。</span><span class="sxs-lookup"><span data-stu-id="5666e-162">Retrieves the menu item identifier of a menu item located at the specified position in a menu.</span></span> <br/>                                                                                                                                                                                                                                                                                                    |
| [<span data-ttu-id="5666e-163">**GetMenuItemInfo**</span><span class="sxs-lookup"><span data-stu-id="5666e-163">**GetMenuItemInfo**</span></span>](/windows/desktop/api/Winuser/nf-winuser-getmenuiteminfoa)                       | <span data-ttu-id="5666e-164">抓取功能表項目的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="5666e-164">Retrieves information about a menu item.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                           |
| [<span data-ttu-id="5666e-165">**GetMenuItemRect**</span><span class="sxs-lookup"><span data-stu-id="5666e-165">**GetMenuItemRect**</span></span>](/windows/desktop/api/Winuser/nf-winuser-getmenuitemrect)                       | <span data-ttu-id="5666e-166">抓取指定功能表項目的周框。</span><span class="sxs-lookup"><span data-stu-id="5666e-166">Retrieves the bounding rectangle for the specified menu item.</span></span><br/>                                                                                                                                                                                                                                                                                                                                      |
| [<span data-ttu-id="5666e-167">**GetMenuState**</span><span class="sxs-lookup"><span data-stu-id="5666e-167">**GetMenuState**</span></span>](/windows/desktop/api/Winuser/nf-winuser-getmenustate)                             | <span data-ttu-id="5666e-168">抓取與指定的功能表項目相關聯的功能表旗標。</span><span class="sxs-lookup"><span data-stu-id="5666e-168">Retrieves the menu flags associated with the specified menu item.</span></span> <span data-ttu-id="5666e-169">如果功能表項目開啟子功能表，此函數也會傳回子功能表中的專案數。</span><span class="sxs-lookup"><span data-stu-id="5666e-169">If the menu item opens a submenu, this function also returns the number of items in the submenu.</span></span> <br/>                                                                                                                                                                                                                                |
| [<span data-ttu-id="5666e-170">**GetMenuString**</span><span class="sxs-lookup"><span data-stu-id="5666e-170">**GetMenuString**</span></span>](/windows/desktop/api/Winuser/nf-winuser-getmenustringa)                           | <span data-ttu-id="5666e-171">將指定之功能表項目的文字字串複製到指定的緩衝區。</span><span class="sxs-lookup"><span data-stu-id="5666e-171">Copies the text string of the specified menu item into the specified buffer.</span></span> <br/>                                                                                                                                                                                                                                                                                                                      |
| [<span data-ttu-id="5666e-172">**GetSubMenu**</span><span class="sxs-lookup"><span data-stu-id="5666e-172">**GetSubMenu**</span></span>](/windows/desktop/api/Winuser/nf-winuser-getsubmenu)                                 | <span data-ttu-id="5666e-173">抓取由指定功能表項目啟動的下拉式功能表或子功能表的控制碼。</span><span class="sxs-lookup"><span data-stu-id="5666e-173">Retrieves a handle to the drop-down menu or submenu activated by the specified menu item.</span></span> <br/>                                                                                                                                                                                                                                                                                                         |
| [<span data-ttu-id="5666e-174">**GetSystemMenu**</span><span class="sxs-lookup"><span data-stu-id="5666e-174">**GetSystemMenu**</span></span>](/windows/desktop/api/Winuser/nf-winuser-getsystemmenu)                           | <span data-ttu-id="5666e-175">讓應用程式存取視窗功能表 (也稱為 [系統] 功能表或 [控制] 功能表) 進行複製和修改。</span><span class="sxs-lookup"><span data-stu-id="5666e-175">Enables the application to access the window menu (also known as the system menu or the control menu) for copying and modifying.</span></span> <br/>                                                                                                                                                                                                                                                                  |
| [<span data-ttu-id="5666e-176">**HiliteMenuItem**</span><span class="sxs-lookup"><span data-stu-id="5666e-176">**HiliteMenuItem**</span></span>](/windows/desktop/api/Winuser/nf-winuser-hilitemenuitem)                         | <span data-ttu-id="5666e-177">從功能表列中的專案反白顯示或移除反白顯示。</span><span class="sxs-lookup"><span data-stu-id="5666e-177">Highlights or removes the highlighting from an item in a menu bar.</span></span> <br/>                                                                                                                                                                                                                                                                                                                                |
| [<span data-ttu-id="5666e-178">**InsertMenuItem**</span><span class="sxs-lookup"><span data-stu-id="5666e-178">**InsertMenuItem**</span></span>](/windows/desktop/api/Winuser/nf-winuser-insertmenuitema)                         | <span data-ttu-id="5666e-179">在功能表中的指定位置插入新的功能表項目。</span><span class="sxs-lookup"><span data-stu-id="5666e-179">Inserts a new menu item at the specified position in a menu.</span></span><br/>                                                                                                                                                                                                                                                                                                                                       |
| [<span data-ttu-id="5666e-180">**IsMenu**</span><span class="sxs-lookup"><span data-stu-id="5666e-180">**IsMenu**</span></span>](/windows/desktop/api/Winuser/nf-winuser-ismenu)                                         | <span data-ttu-id="5666e-181">判斷控制碼是否為功能表控制碼。</span><span class="sxs-lookup"><span data-stu-id="5666e-181">Determines whether a handle is a menu handle.</span></span> <br/>                                                                                                                                                                                                                                                                                                                                                     |
| [<span data-ttu-id="5666e-182">**LoadMenu**</span><span class="sxs-lookup"><span data-stu-id="5666e-182">**LoadMenu**</span></span>](/windows/desktop/api/Winuser/nf-winuser-loadmenua)                                     | <span data-ttu-id="5666e-183">從與應用程式實例相關聯的可執行檔 ( .exe) 檔案載入指定的功能表資源。</span><span class="sxs-lookup"><span data-stu-id="5666e-183">Loads the specified menu resource from the executable (.exe) file associated with an application instance.</span></span> <br/>                                                                                                                                                                                                                                                                                        |
| [<span data-ttu-id="5666e-184">**LoadMenuIndirect**</span><span class="sxs-lookup"><span data-stu-id="5666e-184">**LoadMenuIndirect**</span></span>](/windows/desktop/api/Winuser/nf-winuser-loadmenuindirecta)                     | <span data-ttu-id="5666e-185">將指定的功能表範本載入記憶體中。</span><span class="sxs-lookup"><span data-stu-id="5666e-185">Loads the specified menu template in memory.</span></span> <br/>                                                                                                                                                                                                                                                                                                                                                      |
| [<span data-ttu-id="5666e-186">**MenuItemFromPoint**</span><span class="sxs-lookup"><span data-stu-id="5666e-186">**MenuItemFromPoint**</span></span>](/windows/desktop/api/Winuser/nf-winuser-menuitemfrompoint)                   | <span data-ttu-id="5666e-187">判斷哪個功能表項目（如果有的話）位於指定的位置。</span><span class="sxs-lookup"><span data-stu-id="5666e-187">Determines which menu item, if any, is at the specified location.</span></span><br/>                                                                                                                                                                                                                                                                                                                                  |
| [<span data-ttu-id="5666e-188">**ModifyMenu**</span><span class="sxs-lookup"><span data-stu-id="5666e-188">**ModifyMenu**</span></span>](/windows/desktop/api/Winuser/nf-winuser-modifymenua)                                 | <span data-ttu-id="5666e-189">變更現有的功能表項目。</span><span class="sxs-lookup"><span data-stu-id="5666e-189">Changes an existing menu item.</span></span> <span data-ttu-id="5666e-190">這個函式是用來指定功能表項目的內容、外觀和行為。</span><span class="sxs-lookup"><span data-stu-id="5666e-190">This function is used to specify the content, appearance, and behavior of the menu item.</span></span> <br/>                                                                                                                                                                                                                                                                           |
| [<span data-ttu-id="5666e-191">**RemoveMenu**</span><span class="sxs-lookup"><span data-stu-id="5666e-191">**RemoveMenu**</span></span>](/windows/desktop/api/Winuser/nf-winuser-removemenu)                                 | <span data-ttu-id="5666e-192">從指定的功能表刪除功能表項目或卸離子功能表。</span><span class="sxs-lookup"><span data-stu-id="5666e-192">Deletes a menu item or detaches a submenu from the specified menu.</span></span> <span data-ttu-id="5666e-193">如果功能表項目開啟下拉式功能表或子功能表， [**RemoveMenu**](/windows/desktop/api/Winuser/nf-winuser-removemenu) 就不會摧毀功能表或其控點，讓功能表可以重複使用。</span><span class="sxs-lookup"><span data-stu-id="5666e-193">If the menu item opens a drop-down menu or submenu, [**RemoveMenu**](/windows/desktop/api/Winuser/nf-winuser-removemenu) does not destroy the menu or its handle, allowing the menu to be reused.</span></span> <span data-ttu-id="5666e-194">在呼叫此函式之前， [**GetSubMenu**](/windows/desktop/api/Winuser/nf-winuser-getsubmenu) 函式應該取得下拉式功能表或子功能表的控制碼。</span><span class="sxs-lookup"><span data-stu-id="5666e-194">Before this function is called, the [**GetSubMenu**](/windows/desktop/api/Winuser/nf-winuser-getsubmenu) function should retrieve a handle to the drop-down menu or submenu.</span></span> <br/>                         |
| [<span data-ttu-id="5666e-195">**SetMenu**</span><span class="sxs-lookup"><span data-stu-id="5666e-195">**SetMenu**</span></span>](/windows/desktop/api/Winuser/nf-winuser-setmenu)                                       | <span data-ttu-id="5666e-196">將新的功能表指派給指定的視窗。</span><span class="sxs-lookup"><span data-stu-id="5666e-196">Assigns a new menu to the specified window.</span></span> <br/>                                                                                                                                                                                                                                                                                                                                                       |
| [<span data-ttu-id="5666e-197">**SetMenuDefaultItem**</span><span class="sxs-lookup"><span data-stu-id="5666e-197">**SetMenuDefaultItem**</span></span>](/windows/desktop/api/Winuser/nf-winuser-setmenudefaultitem)                 | <span data-ttu-id="5666e-198">設定指定功能表的預設功能表項目。</span><span class="sxs-lookup"><span data-stu-id="5666e-198">Sets the default menu item for the specified menu.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                 |
| [<span data-ttu-id="5666e-199">**SetMenuInfo**</span><span class="sxs-lookup"><span data-stu-id="5666e-199">**SetMenuInfo**</span></span>](/windows/desktop/api/Winuser/nf-winuser-setmenuinfo)                               | <span data-ttu-id="5666e-200">設定指定之功能表的資訊。</span><span class="sxs-lookup"><span data-stu-id="5666e-200">Sets information for a specified menu.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                             |
| [<span data-ttu-id="5666e-201">**SetMenuItemBitmaps**</span><span class="sxs-lookup"><span data-stu-id="5666e-201">**SetMenuItemBitmaps**</span></span>](/windows/desktop/api/Winuser/nf-winuser-setmenuitembitmaps)                 | <span data-ttu-id="5666e-202">將指定的點陣圖與功能表項目產生關聯。</span><span class="sxs-lookup"><span data-stu-id="5666e-202">Associates the specified bitmap with a menu item.</span></span> <span data-ttu-id="5666e-203">無論是選取或清除功能表項目，系統都會在功能表項目旁邊顯示適當的點陣圖。</span><span class="sxs-lookup"><span data-stu-id="5666e-203">Whether the menu item is selected or clear, the system displays the appropriate bitmap next to the menu item.</span></span> <br/>                                                                                                                                                                                                                                   |
| [<span data-ttu-id="5666e-204">**SetMenuItemInfo**</span><span class="sxs-lookup"><span data-stu-id="5666e-204">**SetMenuItemInfo**</span></span>](/windows/desktop/api/Winuser/nf-winuser-setmenuiteminfoa)                       | <span data-ttu-id="5666e-205">變更功能表項目的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="5666e-205">Changes information about a menu item.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                             |
| [<span data-ttu-id="5666e-206">**Trackpopupmenu 讓**</span><span class="sxs-lookup"><span data-stu-id="5666e-206">**TrackPopupMenu**</span></span>](/windows/desktop/api/Winuser/nf-winuser-trackpopupmenu)                         | <span data-ttu-id="5666e-207">在指定的位置顯示快捷方式功能表，並追蹤功能表上的專案選取專案。</span><span class="sxs-lookup"><span data-stu-id="5666e-207">Displays a shortcut menu at the specified location and tracks the selection of items on the menu.</span></span> <span data-ttu-id="5666e-208">快捷方式功能表可以出現在螢幕上的任何位置。</span><span class="sxs-lookup"><span data-stu-id="5666e-208">The shortcut menu can appear anywhere on the screen.</span></span><br/>                                                                                                                                                                                                                                             |
| [<span data-ttu-id="5666e-209">**TrackPopupMenuEx**</span><span class="sxs-lookup"><span data-stu-id="5666e-209">**TrackPopupMenuEx**</span></span>](/windows/desktop/api/Winuser/nf-winuser-trackpopupmenuex)                     | <span data-ttu-id="5666e-210">在指定的位置顯示快捷方式功能表，並在快捷方式功能表上追蹤選取的專案。</span><span class="sxs-lookup"><span data-stu-id="5666e-210">Displays a shortcut menu at the specified location and tracks the selection of items on the shortcut menu.</span></span> <span data-ttu-id="5666e-211">快捷方式功能表可以出現在螢幕上的任何位置。</span><span class="sxs-lookup"><span data-stu-id="5666e-211">The shortcut menu can appear anywhere on the screen.</span></span><br/>                                                                                                                                                                                                                                    |



 

<span data-ttu-id="5666e-212">下列函式已過時。</span><span class="sxs-lookup"><span data-stu-id="5666e-212">The following function is obsolete.</span></span>



<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th><span data-ttu-id="5666e-213">Name</span><span class="sxs-lookup"><span data-stu-id="5666e-213">Name</span></span></th>
<th><span data-ttu-id="5666e-214">描述</span><span class="sxs-lookup"><span data-stu-id="5666e-214">Description</span></span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span data-ttu-id="5666e-215"><a href="/windows/desktop/api/Winuser/nf-winuser-insertmenua"><strong>InsertMenu</strong></a></span><span class="sxs-lookup"><span data-stu-id="5666e-215"><a href="/windows/desktop/api/Winuser/nf-winuser-insertmenua"><strong>InsertMenu</strong></a></span></span></td>
<td><span data-ttu-id="5666e-216">在功能表中插入新的功能表項目，然後在功能表中移動其他專案。</span><span class="sxs-lookup"><span data-stu-id="5666e-216">Inserts a new menu item into a menu, moving other items down the menu.</span></span>
<blockquote>
[!Note]<br />
<span data-ttu-id="5666e-217"><a href="/windows/desktop/api/Winuser/nf-winuser-insertmenua"><strong>InsertMenu</strong></a>函式已被<a href="/windows/desktop/api/Winuser/nf-winuser-insertmenuitema"><strong>InsertMenuItem</strong></a>函數取代。</span><span class="sxs-lookup"><span data-stu-id="5666e-217">The <a href="/windows/desktop/api/Winuser/nf-winuser-insertmenua"><strong>InsertMenu</strong></a> function has been superseded by the <a href="/windows/desktop/api/Winuser/nf-winuser-insertmenuitema"><strong>InsertMenuItem</strong></a> function.</span></span> <span data-ttu-id="5666e-218">但是，如果您不需要<strong>InsertMenuItem</strong>的任何擴充功能，仍然可以使用<strong>InsertMenu</strong>。</span><span class="sxs-lookup"><span data-stu-id="5666e-218">You can still use <strong>InsertMenu</strong>, however, if you do not need any of the extended features of <strong>InsertMenuItem</strong>.</span></span>
</blockquote>
<br/> <br/></td>
</tr>
</tbody>
</table>



 

### <a name="menu-notifications"></a><span data-ttu-id="5666e-219">功能表通知</span><span class="sxs-lookup"><span data-stu-id="5666e-219">Menu Notifications</span></span>



| <span data-ttu-id="5666e-220">Name</span><span class="sxs-lookup"><span data-stu-id="5666e-220">Name</span></span>                                                  | <span data-ttu-id="5666e-221">描述</span><span class="sxs-lookup"><span data-stu-id="5666e-221">Description</span></span>                                                                                                                                                                          |
|-------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="5666e-222">**WM \_ 命令**</span><span class="sxs-lookup"><span data-stu-id="5666e-222">**WM\_COMMAND**</span></span>](wm-command.md)                     | <span data-ttu-id="5666e-223">當使用者從功能表中選取命令專案時、控制項將通知訊息傳送至其父視窗，或翻譯快速鍵按鍵時傳送。</span><span class="sxs-lookup"><span data-stu-id="5666e-223">Sent when the user selects a command item from a menu, when a control sends a notification message to its parent window, or when an accelerator keystroke is translated.</span></span> <br/> |
| [<span data-ttu-id="5666e-224">**WM \_ CONTEXTMENU**</span><span class="sxs-lookup"><span data-stu-id="5666e-224">**WM\_CONTEXTMENU**</span></span>](wm-contextmenu.md)             | <span data-ttu-id="5666e-225">通知視窗，使用者按一下滑鼠右鍵， (在視窗中以 *滑鼠右鍵按一下*) 。</span><span class="sxs-lookup"><span data-stu-id="5666e-225">Informs a window that the user clicked the right mouse button (*right-clicked*) in the window.</span></span><br/>                                                                            |
| [<span data-ttu-id="5666e-226">**WM \_ ENTERMENULOOP**</span><span class="sxs-lookup"><span data-stu-id="5666e-226">**WM\_ENTERMENULOOP**</span></span>](wm-entermenuloop.md)         | <span data-ttu-id="5666e-227">通知應用程式的主視窗程式，表示已輸入功能表強制回應迴圈。</span><span class="sxs-lookup"><span data-stu-id="5666e-227">Informs an application's main window procedure that a menu modal loop has been entered.</span></span> <br/>                                                                                  |
| [<span data-ttu-id="5666e-228">**WM \_ EXITMENULOOP**</span><span class="sxs-lookup"><span data-stu-id="5666e-228">**WM\_EXITMENULOOP**</span></span>](wm-exitmenuloop.md)           | <span data-ttu-id="5666e-229">通知應用程式的主視窗程式，表示已結束功能表強制回應迴圈。</span><span class="sxs-lookup"><span data-stu-id="5666e-229">Informs an application's main window procedure that a menu modal loop has been exited.</span></span> <br/>                                                                                   |
| [<span data-ttu-id="5666e-230">**WM \_ GETTITLEBARINFOEX**</span><span class="sxs-lookup"><span data-stu-id="5666e-230">**WM\_GETTITLEBARINFOEX**</span></span>](wm-gettitlebarinfoex.md) | <span data-ttu-id="5666e-231">傳送至要求延伸的標題列資訊。</span><span class="sxs-lookup"><span data-stu-id="5666e-231">Sent to request extended title bar information.</span></span> <span data-ttu-id="5666e-232">視窗會透過其 [**WindowProc**](/previous-versions/windows/desktop/legacy/ms633573(v=vs.85)) 函數接收此訊息。</span><span class="sxs-lookup"><span data-stu-id="5666e-232">A window receives this message through its [**WindowProc**](/previous-versions/windows/desktop/legacy/ms633573(v=vs.85)) function.</span></span><br/>                                  |
| [<span data-ttu-id="5666e-233">**WM \_ MENUCOMMAND**</span><span class="sxs-lookup"><span data-stu-id="5666e-233">**WM\_MENUCOMMAND**</span></span>](wm-menucommand.md)             | <span data-ttu-id="5666e-234">當使用者從功能表進行選取時傳送。</span><span class="sxs-lookup"><span data-stu-id="5666e-234">Sent when the user makes a selection from a menu.</span></span> <br/>                                                                                                                        |
| [<span data-ttu-id="5666e-235">**WM \_ MENUDRAG**</span><span class="sxs-lookup"><span data-stu-id="5666e-235">**WM\_MENUDRAG**</span></span>](wm-menudrag.md)                   | <span data-ttu-id="5666e-236">當使用者拖曳功能表項目時，傳送至拖放功能表的擁有者。</span><span class="sxs-lookup"><span data-stu-id="5666e-236">Sent to the owner of a drag-and-drop menu when the user drags a menu item.</span></span> <br/>                                                                                               |
| [<span data-ttu-id="5666e-237">**WM \_ MENUGETOBJECT**</span><span class="sxs-lookup"><span data-stu-id="5666e-237">**WM\_MENUGETOBJECT**</span></span>](wm-menugetobject.md)         | <span data-ttu-id="5666e-238">當滑鼠游標進入功能表項目，或從專案的中央移至專案的頂端或底部時，傳送至拖放功能表的擁有者。</span><span class="sxs-lookup"><span data-stu-id="5666e-238">Sent to the owner of a drag-and-drop menu when the mouse cursor enters a menu item or moves from the center of the item to the top or bottom of the item.</span></span> <br/>                |
| [<span data-ttu-id="5666e-239">**WM \_ MENURBUTTONUP**</span><span class="sxs-lookup"><span data-stu-id="5666e-239">**WM\_MENURBUTTONUP**</span></span>](wm-menurbuttonup.md)         | <span data-ttu-id="5666e-240">當使用者放開滑鼠右鍵，而游標位於功能表項目上時傳送。</span><span class="sxs-lookup"><span data-stu-id="5666e-240">Sent when the user releases the right mouse button while the cursor is on a menu item.</span></span> <br/>                                                                                   |
| [<span data-ttu-id="5666e-241">**WM \_ NEXTMENU**</span><span class="sxs-lookup"><span data-stu-id="5666e-241">**WM\_NEXTMENU**</span></span>](wm-nextmenu.md)                   | <span data-ttu-id="5666e-242">當使用向右鍵或向左鍵切換至功能表列和系統功能表時，傳送至應用程式。</span><span class="sxs-lookup"><span data-stu-id="5666e-242">Sent to an application when the right or left arrow key is used to switch between the menu bar and the system menu.</span></span> <br/>                                                      |
| [<span data-ttu-id="5666e-243">**WM \_ UNINITMENUPOPUP**</span><span class="sxs-lookup"><span data-stu-id="5666e-243">**WM\_UNINITMENUPOPUP**</span></span>](wm-uninitmenupopup.md)     | <span data-ttu-id="5666e-244">當下拉式選單或子功能表已終結時傳送。</span><span class="sxs-lookup"><span data-stu-id="5666e-244">Sent when a drop-down menu or submenu has been destroyed.</span></span> <br/>                                                                                                                |



 

### <a name="menu-structures"></a><span data-ttu-id="5666e-245">功能表結構</span><span class="sxs-lookup"><span data-stu-id="5666e-245">Menu Structures</span></span>



| <span data-ttu-id="5666e-246">Name</span><span class="sxs-lookup"><span data-stu-id="5666e-246">Name</span></span>                                                       | <span data-ttu-id="5666e-247">描述</span><span class="sxs-lookup"><span data-stu-id="5666e-247">Description</span></span>                                                                                                                                                     |
|------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="5666e-248">**MDINEXTMENU**</span><span class="sxs-lookup"><span data-stu-id="5666e-248">**MDINEXTMENU**</span></span>](/windows/win32/api/winuser/ns-winuser-mdinextmenu)                         | <span data-ttu-id="5666e-249">包含要啟用之功能表的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="5666e-249">Contains information about the menu to be activated.</span></span> <br/>                                                                                                |
| [<span data-ttu-id="5666e-250">**MENUBARINFO**</span><span class="sxs-lookup"><span data-stu-id="5666e-250">**MENUBARINFO**</span></span>](/windows/win32/api/winuser/ns-winuser-menubarinfo)                         | <span data-ttu-id="5666e-251">包含功能表列資訊。</span><span class="sxs-lookup"><span data-stu-id="5666e-251">Contains menu bar information.</span></span><br/>                                                                                                                       |
| [<span data-ttu-id="5666e-252">**MENUEX \_ 範本 \_ 標頭**</span><span class="sxs-lookup"><span data-stu-id="5666e-252">**MENUEX\_TEMPLATE\_HEADER**</span></span>](menuex-template-header.md) | <span data-ttu-id="5666e-253">定義擴充功能表範本的標頭。</span><span class="sxs-lookup"><span data-stu-id="5666e-253">Defines the header for an extended menu template.</span></span> <span data-ttu-id="5666e-254">此結構定義僅供說明之用;它不會出現在任何標準標頭檔中。</span><span class="sxs-lookup"><span data-stu-id="5666e-254">This structure definition is for explanation only; it is not present in any standard header file.</span></span> <br/> |
| [<span data-ttu-id="5666e-255">**MENUEX \_ 範本 \_ 專案**</span><span class="sxs-lookup"><span data-stu-id="5666e-255">**MENUEX\_TEMPLATE\_ITEM**</span></span>](menuex-template-item.md)     | <span data-ttu-id="5666e-256">定義擴充功能表範本中的功能表項目。</span><span class="sxs-lookup"><span data-stu-id="5666e-256">Defines a menu item in an extended menu template.</span></span> <span data-ttu-id="5666e-257">此結構定義僅供說明之用;它不會出現在任何標準標頭檔中。</span><span class="sxs-lookup"><span data-stu-id="5666e-257">This structure definition is for explanation only; it is not present in any standard header file.</span></span><br/>  |
| [<span data-ttu-id="5666e-258">**MENUGETOBJECTINFO**</span><span class="sxs-lookup"><span data-stu-id="5666e-258">**MENUGETOBJECTINFO**</span></span>](/windows/win32/api/winuser/ns-winuser-menugetobjectinfo)             | <span data-ttu-id="5666e-259">包含滑鼠游標所在功能表的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="5666e-259">Contains information about the menu that the mouse cursor is on.</span></span><br/>                                                                                     |
| [<span data-ttu-id="5666e-260">**MENUINFO**</span><span class="sxs-lookup"><span data-stu-id="5666e-260">**MENUINFO**</span></span>](/windows/win32/api/winuser/ns-winuser-menuinfo)                               | <span data-ttu-id="5666e-261">包含功能表的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="5666e-261">Contains information about a menu.</span></span><br/>                                                                                                                   |
| [<span data-ttu-id="5666e-262">**MENUITEMINFO**</span><span class="sxs-lookup"><span data-stu-id="5666e-262">**MENUITEMINFO**</span></span>](/windows/win32/api/winuser/ns-winuser-menuiteminfoa)                       | <span data-ttu-id="5666e-263">包含功能表項目的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="5666e-263">Contains information about a menu item.</span></span> <br/>                                                                                                             |
| [<span data-ttu-id="5666e-264">**MENUITEMTEMPLATE**</span><span class="sxs-lookup"><span data-stu-id="5666e-264">**MENUITEMTEMPLATE**</span></span>](/windows/desktop/api/Winuser/ns-winuser-menuitemtemplate)               | <span data-ttu-id="5666e-265">在功能表範本中定義功能表項目。</span><span class="sxs-lookup"><span data-stu-id="5666e-265">Defines a menu item in a menu template.</span></span> <br/>                                                                                                             |
| [<span data-ttu-id="5666e-266">**MENUITEMTEMPLATEHEADER**</span><span class="sxs-lookup"><span data-stu-id="5666e-266">**MENUITEMTEMPLATEHEADER**</span></span>](/windows/desktop/api/Winuser/ns-winuser-menuitemtemplateheader)   | <span data-ttu-id="5666e-267">定義功能表範本的標頭。</span><span class="sxs-lookup"><span data-stu-id="5666e-267">Defines the header for a menu template.</span></span> <span data-ttu-id="5666e-268">完整的功能表範本是由標頭和一或多個功能表項目清單所組成。</span><span class="sxs-lookup"><span data-stu-id="5666e-268">A complete menu template consists of a header and one or more menu item lists.</span></span> <br/>                              |
| [<span data-ttu-id="5666e-269">**TPMPARAMS**</span><span class="sxs-lookup"><span data-stu-id="5666e-269">**TPMPARAMS**</span></span>](/windows/win32/api/winuser/ns-winuser-tpmparams)                             | <span data-ttu-id="5666e-270">包含 [**TrackPopupMenuEx**](/windows/desktop/api/Winuser/nf-winuser-trackpopupmenuex) 函數的擴充參數。</span><span class="sxs-lookup"><span data-stu-id="5666e-270">Contains extended parameters for the [**TrackPopupMenuEx**](/windows/desktop/api/Winuser/nf-winuser-trackpopupmenuex) function.</span></span><br/>                                                          |



 

 

