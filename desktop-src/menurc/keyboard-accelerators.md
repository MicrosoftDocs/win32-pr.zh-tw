---
title: 鍵盤快速操作
description: 本節討論鍵盤加速器。 鍵盤對應鍵是為應用程式產生命令訊息的按鍵或按鍵組合。
ms.assetid: vs|winui|~\winui\windowsuserinterface\userinput\keyboardaccelerators.htm
keywords:
- 使用者輸入，鍵盤快速鍵
- 捕獲使用者輸入，鍵盤快捷
- 鍵盤加速器
- 加速器
- WM_COMMAND 訊息
- WM_SYS 命令訊息
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 1cd8cecd2fc1273750c75b8e5f33106d22343a14
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/19/2020
ms.locfileid: "104375248"
---
# <a name="keyboard-accelerators"></a><span data-ttu-id="63402-110">鍵盤快速操作</span><span class="sxs-lookup"><span data-stu-id="63402-110">Keyboard Accelerators</span></span>

<span data-ttu-id="63402-111">*鍵盤快捷* (或快速鍵) ，是為應用程式產生 [**WM \_ 命令**](wm-command.md)或 [**WM \_ SYSCOMMAND**](wm-syscommand.md)訊息的按鍵或按鍵組合。</span><span class="sxs-lookup"><span data-stu-id="63402-111">A *keyboard accelerator* (or, simply, accelerator) is a keystroke or combination of keystrokes that generates a [**WM\_COMMAND**](wm-command.md) or [**WM\_SYSCOMMAND**](wm-syscommand.md) message for an application.</span></span>

### <a name="in-this-section"></a><span data-ttu-id="63402-112">本節內容</span><span class="sxs-lookup"><span data-stu-id="63402-112">In This Section</span></span>



| <span data-ttu-id="63402-113">Name</span><span class="sxs-lookup"><span data-stu-id="63402-113">Name</span></span>                                                                 | <span data-ttu-id="63402-114">描述</span><span class="sxs-lookup"><span data-stu-id="63402-114">Description</span></span>                                                                |
|----------------------------------------------------------------------|----------------------------------------------------------------------------|
| [<span data-ttu-id="63402-115">關於鍵盤加速器</span><span class="sxs-lookup"><span data-stu-id="63402-115">About Keyboard Accelerators</span></span>](about-keyboard-accelerators.md)       | <span data-ttu-id="63402-116">討論鍵盤加速器。</span><span class="sxs-lookup"><span data-stu-id="63402-116">Discusses keyboard accelerators.</span></span><br/>                                |
| [<span data-ttu-id="63402-117">使用鍵盤加速器</span><span class="sxs-lookup"><span data-stu-id="63402-117">Using Keyboard Accelerators</span></span>](using-keyboard-accelerators.md)       | <span data-ttu-id="63402-118">討論與鍵盤快速鍵相關聯的工作。</span><span class="sxs-lookup"><span data-stu-id="63402-118">Discusses tasks that are associated with keyboard accelerators.</span></span><br/> |
| [<span data-ttu-id="63402-119">鍵盤快速鍵參考</span><span class="sxs-lookup"><span data-stu-id="63402-119">Keyboard Accelerator Reference</span></span>](keyboard-accelerator-reference.md) | <span data-ttu-id="63402-120">包含 API 參考。</span><span class="sxs-lookup"><span data-stu-id="63402-120">Contains the API reference.</span></span><br/>                                     |



 

### <a name="keyboard-accelerator-functions"></a><span data-ttu-id="63402-121">鍵盤對應函式</span><span class="sxs-lookup"><span data-stu-id="63402-121">Keyboard Accelerator Functions</span></span>



| <span data-ttu-id="63402-122">Name</span><span class="sxs-lookup"><span data-stu-id="63402-122">Name</span></span>                                                       | <span data-ttu-id="63402-123">描述</span><span class="sxs-lookup"><span data-stu-id="63402-123">Description</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
|------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="63402-124">**CopyAcceleratorTable**</span><span class="sxs-lookup"><span data-stu-id="63402-124">**CopyAcceleratorTable**</span></span>](/windows/desktop/api/Winuser/nf-winuser-copyacceleratortablea)       | <span data-ttu-id="63402-125">複製指定的快速鍵對應表。</span><span class="sxs-lookup"><span data-stu-id="63402-125">Copies the specified accelerator table.</span></span> <span data-ttu-id="63402-126">此函數是用來取得對應于快速鍵表控制碼的快速鍵對應表資料，或用來決定快速鍵資料表資料的大小。</span><span class="sxs-lookup"><span data-stu-id="63402-126">This function is used to obtain the accelerator-table data that corresponds to an accelerator-table handle, or to determine the size of the accelerator-table data.</span></span> <br/>                                                                                                                                                                                                                                                                                                                                                                    |
| [<span data-ttu-id="63402-127">**CreateAcceleratorTable**</span><span class="sxs-lookup"><span data-stu-id="63402-127">**CreateAcceleratorTable**</span></span>](/windows/desktop/api/Winuser/nf-winuser-createacceleratortablea)   | <span data-ttu-id="63402-128">建立快速鍵對應表。</span><span class="sxs-lookup"><span data-stu-id="63402-128">Creates an accelerator table.</span></span> <br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| [<span data-ttu-id="63402-129">**DestroyAcceleratorTable**</span><span class="sxs-lookup"><span data-stu-id="63402-129">**DestroyAcceleratorTable**</span></span>](/windows/desktop/api/Winuser/nf-winuser-destroyacceleratortable) | <span data-ttu-id="63402-130">終結快速鍵對應表。</span><span class="sxs-lookup"><span data-stu-id="63402-130">Destroys an accelerator table.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| [<span data-ttu-id="63402-131">**LoadAccelerators**</span><span class="sxs-lookup"><span data-stu-id="63402-131">**LoadAccelerators**</span></span>](/windows/desktop/api/Winuser/nf-winuser-loadacceleratorsa)               | <span data-ttu-id="63402-132">載入指定的快速鍵對應表。</span><span class="sxs-lookup"><span data-stu-id="63402-132">Loads the specified accelerator table.</span></span> <br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| [<span data-ttu-id="63402-133">**TranslateAccelerator**</span><span class="sxs-lookup"><span data-stu-id="63402-133">**TranslateAccelerator**</span></span>](/windows/desktop/api/Winuser/nf-winuser-translateacceleratora)       | <span data-ttu-id="63402-134">處理功能表命令的快速鍵。</span><span class="sxs-lookup"><span data-stu-id="63402-134">Processes accelerator keys for menu commands.</span></span> <span data-ttu-id="63402-135">如果指定的快速鍵對應) 表中有索引鍵的專案，則函式會將 [**wm 的 \_ KEYDOWN**](/windows/desktop/inputdev/wm-keydown) 或 [**wm \_ SYSKEYDOWN**](/windows/desktop/inputdev/wm-syskeydown) 訊息轉譯為 [**wm \_ 命令**](wm-command.md) 或 [**wm \_ SYSCOMMAND**](wm-syscommand.md) 訊息 (，然後直接將 **wm \_ 命令** 或 **wm \_ SYSCOMMAND** 訊息傳送至指定的視窗程式。</span><span class="sxs-lookup"><span data-stu-id="63402-135">The function translates a [**WM\_KEYDOWN**](/windows/desktop/inputdev/wm-keydown) or [**WM\_SYSKEYDOWN**](/windows/desktop/inputdev/wm-syskeydown) message to a [**WM\_COMMAND**](wm-command.md) or [**WM\_SYSCOMMAND**](wm-syscommand.md) message (if there is an entry for the key in the specified accelerator table) and then sends the **WM\_COMMAND** or **WM\_SYSCOMMAND** message directly to the specified window procedure.</span></span> <span data-ttu-id="63402-136">在視窗程式處理訊息之前， [**TranslateAccelerator**](/windows/desktop/api/Winuser/nf-winuser-translateacceleratora)不會傳回。</span><span class="sxs-lookup"><span data-stu-id="63402-136">[**TranslateAccelerator**](/windows/desktop/api/Winuser/nf-winuser-translateacceleratora) does not return until the window procedure has processed the message.</span></span> <br/> |



 

### <a name="keyboard-accelerator-messages"></a><span data-ttu-id="63402-137">鍵盤快捷按鍵訊息</span><span class="sxs-lookup"><span data-stu-id="63402-137">Keyboard Accelerator Messages</span></span>



| <span data-ttu-id="63402-138">Name</span><span class="sxs-lookup"><span data-stu-id="63402-138">Name</span></span>                                          | <span data-ttu-id="63402-139">描述</span><span class="sxs-lookup"><span data-stu-id="63402-139">Description</span></span>                                                                                                                                                                                                                                                                                                       |
|-----------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="63402-140">**WM \_ CHANGEUISTATE**</span><span class="sxs-lookup"><span data-stu-id="63402-140">**WM\_CHANGEUISTATE**</span></span>](wm-changeuistate.md) | <span data-ttu-id="63402-141">傳送以表示 UI 狀態應變更。</span><span class="sxs-lookup"><span data-stu-id="63402-141">Sent to indicate that the UI state should be changed.</span></span><br/>                                                                                                                                                                                                                                                  |
| [<span data-ttu-id="63402-142">**WM \_ INITMENU**</span><span class="sxs-lookup"><span data-stu-id="63402-142">**WM\_INITMENU**</span></span>](wm-initmenu.md)           | <span data-ttu-id="63402-143">當功能表即將變成作用中時傳送。</span><span class="sxs-lookup"><span data-stu-id="63402-143">Sent when a menu is about to become active.</span></span> <span data-ttu-id="63402-144">當使用者按一下功能表列上的專案，或按下功能表鍵時，就會發生此問題。</span><span class="sxs-lookup"><span data-stu-id="63402-144">It occurs when the user clicks an item on the menu bar or presses a menu key.</span></span> <span data-ttu-id="63402-145">這可讓應用程式在功能表顯示前修改功能表。</span><span class="sxs-lookup"><span data-stu-id="63402-145">This allows the application to modify the menu before it is displayed.</span></span> <br/> <span data-ttu-id="63402-146">視窗會透過其 [**WindowProc**](/previous-versions/windows/desktop/legacy/ms633573(v=vs.85)) 函數接收此訊息。</span><span class="sxs-lookup"><span data-stu-id="63402-146">A window receives this message through its [**WindowProc**](/previous-versions/windows/desktop/legacy/ms633573(v=vs.85)) function.</span></span> <br/> |
| [<span data-ttu-id="63402-147">**WM \_ QUERYUISTATE**</span><span class="sxs-lookup"><span data-stu-id="63402-147">**WM\_QUERYUISTATE**</span></span>](wm-queryuistate.md)   | <span data-ttu-id="63402-148">傳送以取得視窗的 UI 狀態。</span><span class="sxs-lookup"><span data-stu-id="63402-148">Sent to retrieve the UI state for a window.</span></span><br/>                                                                                                                                                                                                                                                            |
| [<span data-ttu-id="63402-149">**WM \_ UPDATEUISTATE**</span><span class="sxs-lookup"><span data-stu-id="63402-149">**WM\_UPDATEUISTATE**</span></span>](wm-updateuistate.md) | <span data-ttu-id="63402-150">傳送以變更指定視窗及其所有子視窗的 UI 狀態。</span><span class="sxs-lookup"><span data-stu-id="63402-150">Sent to change the UI state for the specified window and all its child windows.</span></span><br/>                                                                                                                                                                                                                        |



 

### <a name="keyboard-accelerator-notifications"></a><span data-ttu-id="63402-151">鍵盤快速鍵通知</span><span class="sxs-lookup"><span data-stu-id="63402-151">Keyboard Accelerator Notifications</span></span>



| <span data-ttu-id="63402-152">Name</span><span class="sxs-lookup"><span data-stu-id="63402-152">Name</span></span>                                          | <span data-ttu-id="63402-153">描述</span><span class="sxs-lookup"><span data-stu-id="63402-153">Description</span></span>                                                                                                                                                                                                                                                                                                                       |
|-----------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="63402-154">**WM \_ INITMENUPOPUP**</span><span class="sxs-lookup"><span data-stu-id="63402-154">**WM\_INITMENUPOPUP**</span></span>](wm-initmenupopup.md) | <span data-ttu-id="63402-155">當下拉功能表或子功能表即將變成作用中時傳送。</span><span class="sxs-lookup"><span data-stu-id="63402-155">Sent when a drop-down menu or submenu is about to become active.</span></span> <span data-ttu-id="63402-156">這可讓應用程式在功能表顯示前修改功能表，而不需要變更整個功能表。</span><span class="sxs-lookup"><span data-stu-id="63402-156">This allows an application to modify the menu before it is displayed, without changing the entire menu.</span></span> <br/>                                                                                                                                              |
| [<span data-ttu-id="63402-157">**WM \_ MENUCHAR**</span><span class="sxs-lookup"><span data-stu-id="63402-157">**WM\_MENUCHAR**</span></span>](wm-menuchar.md)           | <span data-ttu-id="63402-158">當功能表在使用中，且使用者按下未對應至任何助憶鍵或快速鍵的按鍵時傳送。</span><span class="sxs-lookup"><span data-stu-id="63402-158">Sent when a menu is active and the user presses a key that does not correspond to any mnemonic or accelerator key.</span></span> <span data-ttu-id="63402-159">這則訊息會傳送至擁有功能表的視窗。</span><span class="sxs-lookup"><span data-stu-id="63402-159">This message is sent to the window that owns the menu.</span></span> <br/>                                                                                                                                             |
| [<span data-ttu-id="63402-160">**WM \_ MENUSELECT**</span><span class="sxs-lookup"><span data-stu-id="63402-160">**WM\_MENUSELECT**</span></span>](wm-menuselect.md)       | <span data-ttu-id="63402-161">當使用者選取功能表項目時，傳送至功能表的擁有者視窗。</span><span class="sxs-lookup"><span data-stu-id="63402-161">Sent to a menu's owner window when the user selects a menu item.</span></span> <br/>                                                                                                                                                                                                                                                      |
| [<span data-ttu-id="63402-162">**WM \_ SYSCHAR**</span><span class="sxs-lookup"><span data-stu-id="63402-162">**WM\_SYSCHAR**</span></span>](wm-syschar.md)             | <span data-ttu-id="63402-163">當 [**TranslateMessage**](/windows/desktop/api/winuser/nf-winuser-translatemessage)函數轉譯了 [**WM \_ SYSKEYDOWN**](/windows/desktop/inputdev/wm-syskeydown)訊息時，以鍵盤焦點張貼至視窗。</span><span class="sxs-lookup"><span data-stu-id="63402-163">Posted to the window with the keyboard focus when a [**WM\_SYSKEYDOWN**](/windows/desktop/inputdev/wm-syskeydown) message is translated by the [**TranslateMessage**](/windows/desktop/api/winuser/nf-winuser-translatemessage) function.</span></span> <span data-ttu-id="63402-164">它會指定系統字元索引鍵的字元碼，也就是在 ALT 鍵關閉時按下的字元按鍵。</span><span class="sxs-lookup"><span data-stu-id="63402-164">It specifies the character code of a system character key that is, a character key that is pressed while the ALT key is down.</span></span> <br/> |
| [<span data-ttu-id="63402-165">**WM \_ SYSCOMMAND**</span><span class="sxs-lookup"><span data-stu-id="63402-165">**WM\_SYSCOMMAND**</span></span>](wm-syscommand.md)       | <span data-ttu-id="63402-166">當使用者選擇 [ **視窗]** 功能表中的命令，或當使用者選擇 [最大化] 按鈕、最小化按鈕、還原按鈕或 [關閉] 按鈕時，視窗就會收到此訊息。</span><span class="sxs-lookup"><span data-stu-id="63402-166">A window receives this message when the user chooses a command from the **Window** menu or when the user chooses the maximize button, minimize button, restore button, or close button.</span></span><br/>                                                                                                                                |



 

### <a name="keyboard-accelerator-structures"></a><span data-ttu-id="63402-167">鍵盤加速器結構</span><span class="sxs-lookup"><span data-stu-id="63402-167">Keyboard Accelerator Structures</span></span>



| <span data-ttu-id="63402-168">Name</span><span class="sxs-lookup"><span data-stu-id="63402-168">Name</span></span>                   | <span data-ttu-id="63402-169">描述</span><span class="sxs-lookup"><span data-stu-id="63402-169">Description</span></span>                                                          |
|------------------------|----------------------------------------------------------------------|
| [<span data-ttu-id="63402-170">**ACCEL**</span><span class="sxs-lookup"><span data-stu-id="63402-170">**ACCEL**</span></span>](/windows/win32/api/winuser/ns-winuser-accel) | <span data-ttu-id="63402-171">定義快速鍵對應表中使用的快速鍵。</span><span class="sxs-lookup"><span data-stu-id="63402-171">Defines an accelerator key used in an accelerator table.</span></span> <br/> |



 

 

