---
title: 關於鍵盤加速器
description: 本主題討論鍵盤加速器。
ms.assetid: cbf7619d-289d-40c9-9a06-6ce47026d43f
keywords:
- Windows 消費者介面，使用者輸入
- Windows 消費者介面，鍵盤快速鍵
- 使用者輸入，鍵盤快速鍵
- 捕獲使用者輸入，鍵盤快捷
- 鍵盤加速器
- 加速器
- WM_COMMAND 訊息
- WM_SYS 命令訊息
- 快速鍵對應表
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: be9c89301f58d7d76b5d9b28dd6835850c0674db
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/19/2020
ms.locfileid: "103933121"
---
# <a name="about-keyboard-accelerators"></a><span data-ttu-id="66378-112">關於鍵盤加速器</span><span class="sxs-lookup"><span data-stu-id="66378-112">About Keyboard Accelerators</span></span>

<span data-ttu-id="66378-113">快速鍵與功能表緊密相關，可讓使用者存取應用程式的命令集。</span><span class="sxs-lookup"><span data-stu-id="66378-113">Accelerators are closely related to menus — both provide the user with access to an application's command set.</span></span> <span data-ttu-id="66378-114">一般而言，使用者會依賴應用程式的功能表來學習命令集，然後切換到使用加速器，因為它們對應用程式更熟練。</span><span class="sxs-lookup"><span data-stu-id="66378-114">Typically, users rely on an application's menus to learn the command set and then switch over to using accelerators as they become more proficient with the application.</span></span> <span data-ttu-id="66378-115">加速器可提供比功能表更快、更直接的命令存取。</span><span class="sxs-lookup"><span data-stu-id="66378-115">Accelerators provide faster, more direct access to commands than menus do.</span></span> <span data-ttu-id="66378-116">應用程式至少應該提供更常用命令的快速鍵。</span><span class="sxs-lookup"><span data-stu-id="66378-116">At a minimum, an application should provide accelerators for the more commonly used commands.</span></span> <span data-ttu-id="66378-117">雖然加速器通常會產生以功能表項目形式存在的命令，但是它們也可以產生沒有對等功能表項目的命令。</span><span class="sxs-lookup"><span data-stu-id="66378-117">Although accelerators typically generate commands that exist as menu items, they can also generate commands that have no equivalent menu items.</span></span>

<span data-ttu-id="66378-118">本節涵蓋下列主題。</span><span class="sxs-lookup"><span data-stu-id="66378-118">This section covers the following topics.</span></span>

-   [<span data-ttu-id="66378-119">快速鍵對應表</span><span class="sxs-lookup"><span data-stu-id="66378-119">Accelerator Tables</span></span>](#accelerator-tables)
-   [<span data-ttu-id="66378-120">快速鍵-資料表建立</span><span class="sxs-lookup"><span data-stu-id="66378-120">Accelerator-Table Creation</span></span>](#accelerator-table-creation)
-   [<span data-ttu-id="66378-121">快速鍵按鍵指派</span><span class="sxs-lookup"><span data-stu-id="66378-121">Accelerator Keystroke Assignments</span></span>](#accelerator-keystroke-assignments)
-   [<span data-ttu-id="66378-122">加速器和功能表</span><span class="sxs-lookup"><span data-stu-id="66378-122">Accelerators and Menus</span></span>](#accelerators-and-menus)
-   [<span data-ttu-id="66378-123">UI 狀態</span><span class="sxs-lookup"><span data-stu-id="66378-123">UI State</span></span>](#ui-state)

## <a name="accelerator-tables"></a><span data-ttu-id="66378-124">快速鍵對應表</span><span class="sxs-lookup"><span data-stu-id="66378-124">Accelerator Tables</span></span>

<span data-ttu-id="66378-125">快速鍵對應表包含 [**ACCEL**](/windows/win32/api/winuser/ns-winuser-accel) 結構的陣列，每一個都定義個別的快速鍵。</span><span class="sxs-lookup"><span data-stu-id="66378-125">An accelerator table consists of an array of [**ACCEL**](/windows/win32/api/winuser/ns-winuser-accel) structures, each defining an individual accelerator.</span></span> <span data-ttu-id="66378-126">每個 **ACCEL** 結構都包含下列資訊：</span><span class="sxs-lookup"><span data-stu-id="66378-126">Each **ACCEL** structure includes the following information:</span></span>

-   <span data-ttu-id="66378-127">快速鍵的按鍵組合。</span><span class="sxs-lookup"><span data-stu-id="66378-127">The accelerator's keystroke combination.</span></span>
-   <span data-ttu-id="66378-128">快速鍵的識別碼。</span><span class="sxs-lookup"><span data-stu-id="66378-128">The accelerator's identifier.</span></span>
-   <span data-ttu-id="66378-129">各種旗標。</span><span class="sxs-lookup"><span data-stu-id="66378-129">Various flags.</span></span> <span data-ttu-id="66378-130">這包括一個指定系統是否要在使用快速鍵時，反白顯示對應的功能表項目（如果有的話），以提供視覺效果的意見反應</span><span class="sxs-lookup"><span data-stu-id="66378-130">This includes one that specifies whether the system is to provide visual feedback by highlighting the corresponding menu item, if any, when the accelerator is used</span></span>

<span data-ttu-id="66378-131">若要處理指定之執行緒的快速鍵按鍵，開發人員必須在與執行緒訊息佇列相關聯的訊息迴圈中呼叫 [**TranslateAccelerator**](/windows/desktop/api/Winuser/nf-winuser-translateacceleratora) 函數。</span><span class="sxs-lookup"><span data-stu-id="66378-131">To process accelerator keystrokes for a specified thread, the developer must call the [**TranslateAccelerator**](/windows/desktop/api/Winuser/nf-winuser-translateacceleratora) function in the message loop associated with the thread's message queue.</span></span> <span data-ttu-id="66378-132">**TranslateAccelerator** 函式會監視對訊息佇列的鍵盤輸入，檢查是否有符合快速鍵對應表中專案的按鍵組合。</span><span class="sxs-lookup"><span data-stu-id="66378-132">The **TranslateAccelerator** function monitors keyboard input to the message queue, checking for key combinations that match an entry in the accelerator table.</span></span> <span data-ttu-id="66378-133">當 **TranslateAccelerator** 找到符合的結果時，它會將鍵盤輸入轉譯 (也就是， [**Wm \_ KEYUP**](/windows/desktop/inputdev/wm-keyup) 和 [**wm \_ KEYDOWN**](/windows/desktop/inputdev/wm-keydown) 訊息) 至 [**WM \_ 命令**](wm-command.md) 或 [**wm \_ SYSCOMMAND**](wm-syscommand.md) 訊息，然後將訊息傳送至指定視窗的視窗程式。</span><span class="sxs-lookup"><span data-stu-id="66378-133">When **TranslateAccelerator** finds a match, it translates the keyboard input (that is, the [**WM\_KEYUP**](/windows/desktop/inputdev/wm-keyup) and [**WM\_KEYDOWN**](/windows/desktop/inputdev/wm-keydown) messages) into a [**WM\_COMMAND**](wm-command.md) or [**WM\_SYSCOMMAND**](wm-syscommand.md) message and then sends the message to the window procedure of the specified window.</span></span> <span data-ttu-id="66378-134">下圖顯示加速器的處理方式。</span><span class="sxs-lookup"><span data-stu-id="66378-134">The following illustration shows how accelerators are processed.</span></span>

![鍵盤加速器處理模型](images/cskac-01.png)

<span data-ttu-id="66378-136">[**WM \_ 命令**](wm-command.md)訊息包含造成 [**TranslateAccelerator**](/windows/desktop/api/Winuser/nf-winuser-translateacceleratora)產生訊息之快速鍵的識別碼。</span><span class="sxs-lookup"><span data-stu-id="66378-136">The [**WM\_COMMAND**](wm-command.md) message includes the identifier of the accelerator that caused [**TranslateAccelerator**](/windows/desktop/api/Winuser/nf-winuser-translateacceleratora) to generate the message.</span></span> <span data-ttu-id="66378-137">視窗程式會檢查識別碼，以判斷訊息的來源，然後據以處理訊息。</span><span class="sxs-lookup"><span data-stu-id="66378-137">The window procedure examines the identifier to determine the source of the message and then processes the message accordingly.</span></span>

<span data-ttu-id="66378-138">快速鍵對應表存在於兩個不同的層級。</span><span class="sxs-lookup"><span data-stu-id="66378-138">Accelerator tables exist at two different levels.</span></span> <span data-ttu-id="66378-139">系統會維護適用于所有應用程式的單一全系統快速鍵對應表。</span><span class="sxs-lookup"><span data-stu-id="66378-139">The system maintains a single, system-wide accelerator table that applies to all applications.</span></span> <span data-ttu-id="66378-140">應用程式無法修改系統加速器表格。</span><span class="sxs-lookup"><span data-stu-id="66378-140">An application cannot modify the system accelerator table.</span></span> <span data-ttu-id="66378-141">如需系統加速器資料表所提供之快速鍵的描述，請參閱 [快速鍵按鍵指派](#accelerator-keystroke-assignments)。</span><span class="sxs-lookup"><span data-stu-id="66378-141">For a description of the accelerators provided by the system accelerator table, see [Accelerator Keystroke Assignments](#accelerator-keystroke-assignments).</span></span>

<span data-ttu-id="66378-142">系統也會維護每個應用程式的快速鍵對應表。</span><span class="sxs-lookup"><span data-stu-id="66378-142">The system also maintains accelerator tables for each application.</span></span> <span data-ttu-id="66378-143">應用程式可以定義任何數目的快速鍵對應表，以搭配自己的視窗使用。</span><span class="sxs-lookup"><span data-stu-id="66378-143">An application can define any number of accelerator tables for use with its own windows.</span></span> <span data-ttu-id="66378-144">唯一的32位控制碼 (**HACCEL**) 識別每個資料表。</span><span class="sxs-lookup"><span data-stu-id="66378-144">A unique 32-bit handle (**HACCEL**) identifies each table.</span></span> <span data-ttu-id="66378-145">不過，指定的執行緒一次只能有一個使用中的快速鍵對應表。</span><span class="sxs-lookup"><span data-stu-id="66378-145">However, only one accelerator table can be active at a time for a specified thread.</span></span> <span data-ttu-id="66378-146">傳遞至 [**TranslateAccelerator**](/windows/desktop/api/Winuser/nf-winuser-translateacceleratora) 函式之快速鍵對應表的控制碼，會決定執行緒使用中的快速鍵對應表。</span><span class="sxs-lookup"><span data-stu-id="66378-146">The handle to the accelerator table passed to the [**TranslateAccelerator**](/windows/desktop/api/Winuser/nf-winuser-translateacceleratora) function determines which accelerator table is active for a thread.</span></span> <span data-ttu-id="66378-147">您可以隨時將不同的快速鍵表格控制碼傳遞至 **TranslateAccelerator**，以變更使用中的快速鍵對應表。</span><span class="sxs-lookup"><span data-stu-id="66378-147">The active accelerator table can be changed at any time by passing a different accelerator-table handle to **TranslateAccelerator**.</span></span>

## <a name="accelerator-table-creation"></a><span data-ttu-id="66378-148">Accelerator-Table 建立</span><span class="sxs-lookup"><span data-stu-id="66378-148">Accelerator-Table Creation</span></span>

<span data-ttu-id="66378-149">若要建立應用程式的快速鍵對應表，必須執行幾個步驟。</span><span class="sxs-lookup"><span data-stu-id="66378-149">Several steps are required to create an accelerator table for an application.</span></span> <span data-ttu-id="66378-150">首先，資源編譯器會用來建立快速鍵對應表資源，並將它們加入至應用程式的可執行檔。</span><span class="sxs-lookup"><span data-stu-id="66378-150">First, a resource compiler is used to create accelerator-table resources and to add them to the application's executable file.</span></span> <span data-ttu-id="66378-151">在執行時間， [**LoadAccelerators**](/windows/desktop/api/Winuser/nf-winuser-loadacceleratorsa) 函數是用來將快速鍵對應表載入至記憶體，並取得快速鍵對應表的控制碼。</span><span class="sxs-lookup"><span data-stu-id="66378-151">At run time, the [**LoadAccelerators**](/windows/desktop/api/Winuser/nf-winuser-loadacceleratorsa) function is used to load the accelerator table into memory and retrieve the handle to the accelerator table.</span></span> <span data-ttu-id="66378-152">這個控制碼會傳遞至 [**TranslateAccelerator**](/windows/desktop/api/Winuser/nf-winuser-translateacceleratora) 函式，以啟動快速鍵對應表。</span><span class="sxs-lookup"><span data-stu-id="66378-152">This handle is passed to the [**TranslateAccelerator**](/windows/desktop/api/Winuser/nf-winuser-translateacceleratora) function to activate the accelerator table.</span></span>

<span data-ttu-id="66378-153">您也可以在執行時間為應用程式建立快速鍵對應表，方法是將 [**ACCEL**](/windows/win32/api/winuser/ns-winuser-accel) 結構的陣列傳遞至 [**CreateAcceleratorTable**](/windows/desktop/api/Winuser/nf-winuser-createacceleratortablea) 函數。</span><span class="sxs-lookup"><span data-stu-id="66378-153">An accelerator table can also be created for an application at run time by passing an array of [**ACCEL**](/windows/win32/api/winuser/ns-winuser-accel) structures to the [**CreateAcceleratorTable**](/windows/desktop/api/Winuser/nf-winuser-createacceleratortablea) function.</span></span> <span data-ttu-id="66378-154">這個方法支援應用程式中的使用者定義加速器。</span><span class="sxs-lookup"><span data-stu-id="66378-154">This method supports user-defined accelerators in the application.</span></span> <span data-ttu-id="66378-155">如同 [**LoadAccelerators**](/windows/desktop/api/Winuser/nf-winuser-loadacceleratorsa) 函式， **CreateAcceleratorTable** 會傳回可傳遞至 [**TranslateAccelerator**](/windows/desktop/api/Winuser/nf-winuser-translateacceleratora) 以啟動快速鍵對應表的快速鍵對應表控制碼。</span><span class="sxs-lookup"><span data-stu-id="66378-155">Like the [**LoadAccelerators**](/windows/desktop/api/Winuser/nf-winuser-loadacceleratorsa) function, **CreateAcceleratorTable** returns an accelerator-table handle that can be passed to [**TranslateAccelerator**](/windows/desktop/api/Winuser/nf-winuser-translateacceleratora) to activate the accelerator table.</span></span>

<span data-ttu-id="66378-156">系統會自動終結 [**LoadAccelerators**](/windows/desktop/api/Winuser/nf-winuser-loadacceleratorsa) 所載入或由 [**CreateAcceleratorTable**](/windows/desktop/api/Winuser/nf-winuser-createacceleratortablea)所建立的快速鍵對應表。</span><span class="sxs-lookup"><span data-stu-id="66378-156">The system automatically destroys accelerator tables loaded by [**LoadAccelerators**](/windows/desktop/api/Winuser/nf-winuser-loadacceleratorsa) or created by [**CreateAcceleratorTable**](/windows/desktop/api/Winuser/nf-winuser-createacceleratortablea).</span></span> <span data-ttu-id="66378-157">不過，應用程式可以藉由呼叫 [**DestroyAcceleratorTable**](/windows/desktop/api/Winuser/nf-winuser-destroyacceleratortable) 函式終結快速鍵對應表來釋出正在執行的資源。</span><span class="sxs-lookup"><span data-stu-id="66378-157">However, an application can free resources while it is running by destroying accelerator tables no longer needed by calling the [**DestroyAcceleratorTable**](/windows/desktop/api/Winuser/nf-winuser-destroyacceleratortable) function.</span></span>

<span data-ttu-id="66378-158">您可以複製和修改現有的快速鍵對應表。</span><span class="sxs-lookup"><span data-stu-id="66378-158">An existing accelerator table can be copied and modified.</span></span> <span data-ttu-id="66378-159">您可以使用 [**CopyAcceleratorTable**](/windows/desktop/api/Winuser/nf-winuser-copyacceleratortablea) 函數來複製現有的快速鍵對應表。</span><span class="sxs-lookup"><span data-stu-id="66378-159">The existing accelerator table is copied by using the [**CopyAcceleratorTable**](/windows/desktop/api/Winuser/nf-winuser-copyacceleratortablea) function.</span></span> <span data-ttu-id="66378-160">在修改複製之後，藉由呼叫 [**CreateAcceleratorTable**](/windows/desktop/api/Winuser/nf-winuser-createacceleratortablea)來取出新快速鍵對應表的控制碼。</span><span class="sxs-lookup"><span data-stu-id="66378-160">After the copy is modified, a handle to the new accelerator table is retrieved by calling [**CreateAcceleratorTable**](/windows/desktop/api/Winuser/nf-winuser-createacceleratortablea).</span></span> <span data-ttu-id="66378-161">最後，會將控制碼傳遞至 [**TranslateAccelerator**](/windows/desktop/api/Winuser/nf-winuser-translateacceleratora) ，以啟動新的資料表。</span><span class="sxs-lookup"><span data-stu-id="66378-161">Finally, the handle is passed to [**TranslateAccelerator**](/windows/desktop/api/Winuser/nf-winuser-translateacceleratora) to activate the new table.</span></span>

## <a name="accelerator-keystroke-assignments"></a><span data-ttu-id="66378-162">快速鍵按鍵指派</span><span class="sxs-lookup"><span data-stu-id="66378-162">Accelerator Keystroke Assignments</span></span>

<span data-ttu-id="66378-163">您可以使用 ASCII 字元碼或虛擬金鑰程式碼來定義加速器。</span><span class="sxs-lookup"><span data-stu-id="66378-163">An ASCII character code or a virtual-key code can be used to define the accelerator.</span></span> <span data-ttu-id="66378-164">ASCII 字元碼可讓加速器區分大小寫。</span><span class="sxs-lookup"><span data-stu-id="66378-164">An ASCII character code makes the accelerator case sensitive.</span></span> <span data-ttu-id="66378-165">因此，使用 ASCII "C" 字元將加速器定義為 ALT + C 而不是 ALT + c。</span><span class="sxs-lookup"><span data-stu-id="66378-165">Thus, using the ASCII "C" character defines the accelerator as ALT+C rather than ALT+c.</span></span> <span data-ttu-id="66378-166">不過，區分大小寫的加速器可能會令人困惑。</span><span class="sxs-lookup"><span data-stu-id="66378-166">However, case-sensitive accelerators can be confusing to use.</span></span> <span data-ttu-id="66378-167">例如，如果 CAPS LOCK 機碼關閉或 SHIFT 鍵已關閉，則會產生 ALT + C 加速器，但如果兩者都關閉，則不會產生。</span><span class="sxs-lookup"><span data-stu-id="66378-167">For example, the ALT+C accelerator will be generated if the CAPS LOCK key is down or if the SHIFT key is down, but not if both are down.</span></span>

<span data-ttu-id="66378-168">一般而言，加速器不需要區分大小寫，因此大部分的應用程式會使用加速器的虛擬金鑰程式碼，而不是 ASCII 字元碼。</span><span class="sxs-lookup"><span data-stu-id="66378-168">Typically, accelerators don't need to be case sensitive, so most applications use virtual-key codes for accelerators rather than ASCII character codes.</span></span>

<span data-ttu-id="66378-169">請避免與應用程式功能表助憶鍵衝突的加速器，因為加速器會覆寫助憶鍵，而這可能會讓使用者混淆。</span><span class="sxs-lookup"><span data-stu-id="66378-169">Avoid accelerators that conflict with an application's menu mnemonics, because the accelerator overrides the mnemonic, which can confuse the user.</span></span> <span data-ttu-id="66378-170">如需功能表助憶鍵的詳細資訊，請參閱 [功能表](menus.md)。</span><span class="sxs-lookup"><span data-stu-id="66378-170">For more information about menu mnemonics, see [Menus](menus.md).</span></span>

<span data-ttu-id="66378-171">如果應用程式定義的加速器也定義于系統加速器資料表中，則應用程式定義的加速器會覆寫系統加速器，但只會在應用程式的內容中。</span><span class="sxs-lookup"><span data-stu-id="66378-171">If an application defines an accelerator that is also defined in the system accelerator table, the application-defined accelerator overrides the system accelerator, but only within the context of the application.</span></span> <span data-ttu-id="66378-172">不過，請避免這種作法，因為它會防止系統加速器在使用者介面中執行其標準角色。</span><span class="sxs-lookup"><span data-stu-id="66378-172">Avoid this practice, however, because it prevents the system accelerator from performing its standard role in the user interface.</span></span> <span data-ttu-id="66378-173">下列清單描述整個系統的加速器：</span><span class="sxs-lookup"><span data-stu-id="66378-173">The system-wide accelerators are described in the following list:</span></span>



|                  |                                                                                                       |
|------------------|-------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="66378-174">ALT+ESC</span><span class="sxs-lookup"><span data-stu-id="66378-174">ALT+ESC</span></span>          | <span data-ttu-id="66378-175">切換至下一個應用程式。</span><span class="sxs-lookup"><span data-stu-id="66378-175">Switches to the next application.</span></span>                                                                     |
| <span data-ttu-id="66378-176">ALT+F4</span><span class="sxs-lookup"><span data-stu-id="66378-176">ALT+F4</span></span>           | <span data-ttu-id="66378-177">關閉應用程式或視窗。</span><span class="sxs-lookup"><span data-stu-id="66378-177">Closes an application or a window.</span></span>                                                                    |
| <span data-ttu-id="66378-178">ALT+連字號</span><span class="sxs-lookup"><span data-stu-id="66378-178">ALT+HYPHEN</span></span>       | <span data-ttu-id="66378-179">開啟文件視窗的 [ **視窗]** 功能表。</span><span class="sxs-lookup"><span data-stu-id="66378-179">Opens the **Window** menu for a document window.</span></span>                                                      |
| <span data-ttu-id="66378-180">ALT + PRINT SCREEN</span><span class="sxs-lookup"><span data-stu-id="66378-180">ALT+PRINT SCREEN</span></span> | <span data-ttu-id="66378-181">將使用中視窗中的影像複製到剪貼簿。</span><span class="sxs-lookup"><span data-stu-id="66378-181">Copies an image in the active window onto the clipboard.</span></span>                                              |
| <span data-ttu-id="66378-182">ALT 鍵 + 空格鍵</span><span class="sxs-lookup"><span data-stu-id="66378-182">ALT+SPACEBAR</span></span>     | <span data-ttu-id="66378-183">開啟應用程式主視窗的 [ **視窗]** 功能表。</span><span class="sxs-lookup"><span data-stu-id="66378-183">Opens the **Window** menu for the application's main window.</span></span>                                          |
| <span data-ttu-id="66378-184">ALT+TAB</span><span class="sxs-lookup"><span data-stu-id="66378-184">ALT+TAB</span></span>          | <span data-ttu-id="66378-185">切換至下一個應用程式。</span><span class="sxs-lookup"><span data-stu-id="66378-185">Switches to the next application.</span></span>                                                                     |
| <span data-ttu-id="66378-186">Ctrl+Esc</span><span class="sxs-lookup"><span data-stu-id="66378-186">CTRL+ESC</span></span>         | <span data-ttu-id="66378-187">切換至 [ **開始** ] 功能表。</span><span class="sxs-lookup"><span data-stu-id="66378-187">Switches to the **Start** menu.</span></span>                                                                       |
| <span data-ttu-id="66378-188">CTRL+F4</span><span class="sxs-lookup"><span data-stu-id="66378-188">CTRL+F4</span></span>          | <span data-ttu-id="66378-189">關閉使用中的群組或文件視窗。</span><span class="sxs-lookup"><span data-stu-id="66378-189">Closes the active group or document window.</span></span>                                                           |
| <span data-ttu-id="66378-190">F1</span><span class="sxs-lookup"><span data-stu-id="66378-190">F1</span></span>               | <span data-ttu-id="66378-191">啟動應用程式的說明檔（如果有的話）。</span><span class="sxs-lookup"><span data-stu-id="66378-191">Starts the application's help file, if one exists.</span></span>                                                    |
| <span data-ttu-id="66378-192">列印畫面</span><span class="sxs-lookup"><span data-stu-id="66378-192">PRINT SCREEN</span></span>     | <span data-ttu-id="66378-193">將畫面上的影像複製到剪貼簿。</span><span class="sxs-lookup"><span data-stu-id="66378-193">Copies an image on the screen onto the clipboard.</span></span>                                                     |
| <span data-ttu-id="66378-194">SHIFT + ALT + TAB</span><span class="sxs-lookup"><span data-stu-id="66378-194">SHIFT+ALT+TAB</span></span>    | <span data-ttu-id="66378-195">切換至先前的應用程式。</span><span class="sxs-lookup"><span data-stu-id="66378-195">Switches to the previous application.</span></span> <span data-ttu-id="66378-196">使用者必須在按下 TAB 鍵時按住 ALT + SHIFT。</span><span class="sxs-lookup"><span data-stu-id="66378-196">The user must press and hold down ALT+SHIFT while pressing TAB.</span></span> |



 

## <a name="accelerators-and-menus"></a><span data-ttu-id="66378-197">加速器和功能表</span><span class="sxs-lookup"><span data-stu-id="66378-197">Accelerators and Menus</span></span>

<span data-ttu-id="66378-198">使用快速鍵與選擇功能表項目相同：兩個動作都會導致系統將 [**wm \_ 命令**](wm-command.md) 或 [**wm \_ SYSCOMMAND**](wm-syscommand.md) 訊息傳送至對應的視窗程式。</span><span class="sxs-lookup"><span data-stu-id="66378-198">Using an accelerator is the same as choosing a menu item: Both actions cause the system to send a [**WM\_COMMAND**](wm-command.md) or [**WM\_SYSCOMMAND**](wm-syscommand.md) message to the corresponding window procedure.</span></span> <span data-ttu-id="66378-199">**WM \_ 命令** 訊息包含一個識別碼，可讓視窗程式檢查以判斷訊息的來源。</span><span class="sxs-lookup"><span data-stu-id="66378-199">The **WM\_COMMAND** message includes an identifier that the window procedure examines to determine the source of the message.</span></span> <span data-ttu-id="66378-200">如果加速器產生了 **WM \_ 命令** 訊息，則識別碼是快速鍵的識別碼。</span><span class="sxs-lookup"><span data-stu-id="66378-200">If an accelerator generated the **WM\_COMMAND** message, the identifier is that of the accelerator.</span></span> <span data-ttu-id="66378-201">同樣地，如果功能表項目產生了 **WM \_ 命令** 訊息，則識別碼會是功能表項目的識別碼。</span><span class="sxs-lookup"><span data-stu-id="66378-201">Similarly, if a menu item generated the **WM\_COMMAND** message, the identifier is that of the menu item.</span></span> <span data-ttu-id="66378-202">因為加速器提供從功能表中選擇命令的快捷方式，所以應用程式通常會將相同的識別碼指派給快速鍵和對應的功能表項目。</span><span class="sxs-lookup"><span data-stu-id="66378-202">Because an accelerator provides a shortcut for choosing a command from a menu, an application usually assigns the same identifier to the accelerator and the corresponding menu item.</span></span>

<span data-ttu-id="66378-203">應用程式會以與對應的功能表項目 **wm \_ 命令** 訊息完全相同的方式來處理加速器 [**WM \_ 命令**](wm-command.md)訊息。</span><span class="sxs-lookup"><span data-stu-id="66378-203">An application processes an accelerator [**WM\_COMMAND**](wm-command.md) message in exactly the same way as the corresponding menu item **WM\_COMMAND** message.</span></span> <span data-ttu-id="66378-204">不過， **WM \_ 命令** 訊息包含旗標，可指定訊息是否源自于快速鍵或功能表項目，以因應快速鍵的處理方式與對應的功能表項目不同。</span><span class="sxs-lookup"><span data-stu-id="66378-204">However, the **WM\_COMMAND** message contains a flag that specifies whether the message originated from an accelerator or a menu item, in case accelerators must be processed differently from their corresponding menu items.</span></span> <span data-ttu-id="66378-205">[**WM \_ SYSCOMMAND**](wm-syscommand.md)訊息未包含此旗標。</span><span class="sxs-lookup"><span data-stu-id="66378-205">The [**WM\_SYSCOMMAND**](wm-syscommand.md) message does not contain this flag.</span></span>

<span data-ttu-id="66378-206">此識別碼會判斷加速器是否會產生 [**wm \_ 命令**](wm-command.md) 或 [**wm \_ SYSCOMMAND**](wm-syscommand.md) 訊息。</span><span class="sxs-lookup"><span data-stu-id="66378-206">The identifier determines whether an accelerator generates a [**WM\_COMMAND**](wm-command.md) or [**WM\_SYSCOMMAND**](wm-syscommand.md) message.</span></span> <span data-ttu-id="66378-207">如果識別碼的值與 [系統] 功能表中的功能表項目相同，則加速器會產生 **WM \_ SYSCOMMAND** 訊息。</span><span class="sxs-lookup"><span data-stu-id="66378-207">If the identifier has the same value as a menu item in the System menu, the accelerator generates a **WM\_SYSCOMMAND** message.</span></span> <span data-ttu-id="66378-208">否則，加速器會產生 **WM \_ 命令** 訊息。</span><span class="sxs-lookup"><span data-stu-id="66378-208">Otherwise, the accelerator generates a **WM\_COMMAND** message.</span></span>

<span data-ttu-id="66378-209">如果快速鍵具有與功能表項目相同的識別碼，且功能表項目為灰色或停用，則會停用加速器，而且不會產生 [**wm \_ 命令**](wm-command.md) 或 [**wm \_ SYSCOMMAND**](wm-syscommand.md) 訊息。</span><span class="sxs-lookup"><span data-stu-id="66378-209">If an accelerator has the same identifier as a menu item and the menu item is grayed or disabled, the accelerator is disabled and does not generate a [**WM\_COMMAND**](wm-command.md) or [**WM\_SYSCOMMAND**](wm-syscommand.md) message.</span></span> <span data-ttu-id="66378-210">此外，如果對應的視窗最小化，則加速器不會產生命令訊息。</span><span class="sxs-lookup"><span data-stu-id="66378-210">Also, an accelerator does not generate a command message if the corresponding window is minimized.</span></span>

<span data-ttu-id="66378-211">當使用者使用對應至功能表項目的快速鍵時，視窗程式會收到 [**wm \_ INITMENU**](wm-initmenu.md) 和 [**wm \_ INITMENUPOPUP**](wm-initmenupopup.md) 訊息，如同使用者選取功能表項目一樣。</span><span class="sxs-lookup"><span data-stu-id="66378-211">When the user uses an accelerator that corresponds to a menu item, the window procedure receives the [**WM\_INITMENU**](wm-initmenu.md) and [**WM\_INITMENUPOPUP**](wm-initmenupopup.md) messages as though the user had selected the menu item.</span></span> <span data-ttu-id="66378-212">如需如何處理這些訊息的詳細資訊，請參閱 [功能表](menus.md)。</span><span class="sxs-lookup"><span data-stu-id="66378-212">For information about how to process these messages, see [Menus](menus.md).</span></span>

<span data-ttu-id="66378-213">對應至功能表項目的快速鍵應該包含在功能表項目的文字中。</span><span class="sxs-lookup"><span data-stu-id="66378-213">An accelerator that corresponds to a menu item should be included in the text of the menu item.</span></span>

## <a name="ui-state"></a><span data-ttu-id="66378-214">UI 狀態</span><span class="sxs-lookup"><span data-stu-id="66378-214">UI State</span></span>

<span data-ttu-id="66378-215">Windows 可讓應用程式隱藏或顯示其 UI 中的各種功能。</span><span class="sxs-lookup"><span data-stu-id="66378-215">Windows enables applications to hide or show various features in its UI.</span></span> <span data-ttu-id="66378-216">這些設定稱為 UI 狀態。</span><span class="sxs-lookup"><span data-stu-id="66378-216">These settings are known as the UI state.</span></span> <span data-ttu-id="66378-217">UI 狀態包含下列設定：</span><span class="sxs-lookup"><span data-stu-id="66378-217">The UI state includes the following settings:</span></span>

-   <span data-ttu-id="66378-218">焦點指標 (例如按鈕上的焦點矩形) </span><span class="sxs-lookup"><span data-stu-id="66378-218">focus indicators (such as focus rectangles on buttons)</span></span>
-   <span data-ttu-id="66378-219">鍵盤快速鍵 (以控制項標籤中的底線來表示) </span><span class="sxs-lookup"><span data-stu-id="66378-219">keyboard accelerators (indicated by underlines in control labels)</span></span>

<span data-ttu-id="66378-220">視窗可以傳送訊息來要求 UI 狀態的變更、可以查詢 UI 狀態，或強制執行其子視窗的特定狀態。</span><span class="sxs-lookup"><span data-stu-id="66378-220">A window can send messages to request a change in the UI state, can query the UI state, or enforce a certain state for its child windows.</span></span> <span data-ttu-id="66378-221">這些訊息如下所示。</span><span class="sxs-lookup"><span data-stu-id="66378-221">These messages are as follows.</span></span>



| <span data-ttu-id="66378-222">訊息</span><span class="sxs-lookup"><span data-stu-id="66378-222">Message</span></span>                                       | <span data-ttu-id="66378-223">描述</span><span class="sxs-lookup"><span data-stu-id="66378-223">Description</span></span>                                |
|-----------------------------------------------|--------------------------------------------|
| [<span data-ttu-id="66378-224">**WM \_ CHANGEUISTATE**</span><span class="sxs-lookup"><span data-stu-id="66378-224">**WM\_CHANGEUISTATE**</span></span>](wm-changeuistate.md) | <span data-ttu-id="66378-225">指出 UI 狀態應變更。</span><span class="sxs-lookup"><span data-stu-id="66378-225">Indicates that the UI state should change.</span></span> |
| [<span data-ttu-id="66378-226">**WM \_ QUERYUISTATE**</span><span class="sxs-lookup"><span data-stu-id="66378-226">**WM\_QUERYUISTATE**</span></span>](wm-queryuistate.md)   | <span data-ttu-id="66378-227">抓取視窗的 UI 狀態。</span><span class="sxs-lookup"><span data-stu-id="66378-227">Retrieves the UI state for a window.</span></span>       |
| [<span data-ttu-id="66378-228">**WM \_ UPDATEUISTATE**</span><span class="sxs-lookup"><span data-stu-id="66378-228">**WM\_UPDATEUISTATE**</span></span>](wm-updateuistate.md) | <span data-ttu-id="66378-229">變更 UI 狀態。</span><span class="sxs-lookup"><span data-stu-id="66378-229">Changes the UI state.</span></span>                      |



 

<span data-ttu-id="66378-230">依預設，最上層視窗的所有子視窗都會以與其父系相同的 UI 狀態來建立。</span><span class="sxs-lookup"><span data-stu-id="66378-230">By default, all child windows of a top-level window are created with the same UI state as their parent.</span></span>

<span data-ttu-id="66378-231">系統會處理對話方塊中控制項的 UI 狀態。</span><span class="sxs-lookup"><span data-stu-id="66378-231">The system handles the UI state for controls in dialog boxes.</span></span> <span data-ttu-id="66378-232">在建立對話方塊時，系統會據以初始化 UI 狀態。</span><span class="sxs-lookup"><span data-stu-id="66378-232">At dialog box creation, the system initializes the UI state accordingly.</span></span> <span data-ttu-id="66378-233">所有子控制項都會繼承此狀態。</span><span class="sxs-lookup"><span data-stu-id="66378-233">All child controls inherit this state.</span></span> <span data-ttu-id="66378-234">建立對話方塊之後，系統會監視使用者的擊鍵。</span><span class="sxs-lookup"><span data-stu-id="66378-234">After the dialog box is created, the system monitors the user's keystrokes.</span></span> <span data-ttu-id="66378-235">如果 UI 狀態設定是隱藏的，且使用者使用鍵盤流覽，系統會更新 UI 狀態。</span><span class="sxs-lookup"><span data-stu-id="66378-235">If the UI state settings are hidden and the user navigates using the keyboard, the system updates the UI state.</span></span> <span data-ttu-id="66378-236">例如，如果使用者按下 Tab 鍵將焦點移至下一個控制項，系統就會呼叫 [**WM \_ CHANGEUISTATE**](wm-changeuistate.md) ，讓焦點指標變成可見。</span><span class="sxs-lookup"><span data-stu-id="66378-236">For example, if the user presses the Tab key to move the focus to the next control, the system calls [**WM\_CHANGEUISTATE**](wm-changeuistate.md) to make the focus indicators visible.</span></span> <span data-ttu-id="66378-237">如果使用者按下 ALT 鍵，系統就會呼叫 **WM \_ CHANGEUISTATE** 來顯示鍵盤快捷視窗。</span><span class="sxs-lookup"><span data-stu-id="66378-237">If the user presses the Alt key, the system calls **WM\_CHANGEUISTATE** to make the keyboard accelerators visible.</span></span>

<span data-ttu-id="66378-238">如果控制項支援在其所包含的 UI 元素之間進行導覽，則可以更新它自己的 UI 狀態。</span><span class="sxs-lookup"><span data-stu-id="66378-238">If a control supports navigation between the UI elements it contains, it can update its own UI state.</span></span> <span data-ttu-id="66378-239">控制項可以呼叫 [**WM \_ QUERYUISTATE**](wm-queryuistate.md) 來取出和快取初始的 UI 狀態。</span><span class="sxs-lookup"><span data-stu-id="66378-239">The control can call [**WM\_QUERYUISTATE**](wm-queryuistate.md) to retrieve and cache the initial UI state.</span></span> <span data-ttu-id="66378-240">每當控制項收到 [**wm \_ UPDATEUISTATE**](wm-updateuistate.md) 訊息時，它就可以更新其 UI 狀態，並將 [**WM \_ CHANGEUISTATE**](wm-changeuistate.md) 訊息傳送到其父系。</span><span class="sxs-lookup"><span data-stu-id="66378-240">Whenever the control receives an [**WM\_UPDATEUISTATE**](wm-updateuistate.md) message, it can update its UI state and send a [**WM\_CHANGEUISTATE**](wm-changeuistate.md) message to its parent.</span></span> <span data-ttu-id="66378-241">每個視窗會繼續將訊息傳送到其父系，直到到達最上層視窗為止。</span><span class="sxs-lookup"><span data-stu-id="66378-241">Each window will continue to send the message to its parent until it reaches the top-level window.</span></span> <span data-ttu-id="66378-242">最上層視窗會將 **WM \_ UPDATEUISTATE** 訊息傳送至視窗樹狀結構中的視窗。</span><span class="sxs-lookup"><span data-stu-id="66378-242">The top-level window sends the **WM\_UPDATEUISTATE** message to the windows in the window tree.</span></span> <span data-ttu-id="66378-243">如果視窗未通過 **WM \_ CHANGEUISTATE** 訊息，它就不會到達最上層視窗，也不會更新 UI 狀態。</span><span class="sxs-lookup"><span data-stu-id="66378-243">If a window does not pass on the **WM\_CHANGEUISTATE** message, it will not reach the top-level window and the UI state will not be updated.</span></span>

 

 