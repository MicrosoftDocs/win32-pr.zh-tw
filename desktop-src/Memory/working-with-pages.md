---
description: 若要判斷目前電腦上的頁面大小，請使用 GetSystemInfo 函數。
ms.assetid: 953ddfc4-6126-41fb-81a3-0ce1f0fb223f
title: 使用頁面
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 66c12c99ada03dca1e17c72c2a5f0d5360b6a98d
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/07/2021
ms.locfileid: "104512169"
---
# <a name="working-with-pages"></a><span data-ttu-id="9062d-103">使用頁面</span><span class="sxs-lookup"><span data-stu-id="9062d-103">Working with Pages</span></span>

<span data-ttu-id="9062d-104">若要判斷目前電腦上的頁面大小，請使用 [**GetSystemInfo**](/windows/win32/api/sysinfoapi/nf-sysinfoapi-getsysteminfo) 函數。</span><span class="sxs-lookup"><span data-stu-id="9062d-104">To determine the size of a page on the current computer, use the [**GetSystemInfo**](/windows/win32/api/sysinfoapi/nf-sysinfoapi-getsysteminfo) function.</span></span>

<span data-ttu-id="9062d-105">[**VirtualQuery**](/windows/win32/api/memoryapi/nf-memoryapi-virtualquery)和 [**VirtualQueryEx**](/windows/win32/api/memoryapi/nf-memoryapi-virtualqueryex)函式會從進程位址空間中的指定位址開始，傳回連續頁面區域的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="9062d-105">The [**VirtualQuery**](/windows/win32/api/memoryapi/nf-memoryapi-virtualquery) and [**VirtualQueryEx**](/windows/win32/api/memoryapi/nf-memoryapi-virtualqueryex) functions return information about a region of consecutive pages beginning at a specified address in the address space of a process.</span></span> <span data-ttu-id="9062d-106">**VirtualQuery** 會傳回呼叫進程中記憶體的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="9062d-106">**VirtualQuery** returns information about memory in the calling process.</span></span> <span data-ttu-id="9062d-107">**VirtualQueryEx** 會傳回指定進程中的記憶體相關資訊，並且用來支援需要所進行之進程相關資訊的偵錯工具。</span><span class="sxs-lookup"><span data-stu-id="9062d-107">**VirtualQueryEx** returns information about memory in a specified process and is used to support debuggers that need information about a process being debugged.</span></span> <span data-ttu-id="9062d-108">頁面區域會依指定的位址（四捨五入至最接近的頁面界限）來限定。</span><span class="sxs-lookup"><span data-stu-id="9062d-108">The region of pages is bounded by the specified address rounded down to the nearest page boundary.</span></span> <span data-ttu-id="9062d-109">它會透過下列常見的屬性，延伸至所有後續頁面：</span><span class="sxs-lookup"><span data-stu-id="9062d-109">It extends through all subsequent pages with the following attributes in common:</span></span>

-   <span data-ttu-id="9062d-110">所有頁面的狀態都相同：「已認可」、「保留」或「免費」。</span><span class="sxs-lookup"><span data-stu-id="9062d-110">The state of all pages is the same: either committed, reserved, or free.</span></span>
-   <span data-ttu-id="9062d-111">如果初始頁面不是可用的，則該區域中的所有頁面都屬於相同初始配置頁面的一部分，這些頁面是由呼叫 [**VirtualAlloc**](/windows/win32/api/memoryapi/nf-memoryapi-virtualalloc)所保留的頁面。</span><span class="sxs-lookup"><span data-stu-id="9062d-111">If the initial page is not free, all pages in the region are part of the same initial allocation of pages that were reserved by a call to [**VirtualAlloc**](/windows/win32/api/memoryapi/nf-memoryapi-virtualalloc).</span></span>
-   <span data-ttu-id="9062d-112">所有頁面的存取保護都相同 (也就是， **page \_ READONLY**、 **page \_ READWRITE** 或 **page \_ NOACCESS**) 。</span><span class="sxs-lookup"><span data-stu-id="9062d-112">The access protection of all pages is the same (that is, **PAGE\_READONLY**, **PAGE\_READWRITE**, or **PAGE\_NOACCESS**).</span></span>

<span data-ttu-id="9062d-113">[**VirtualLock**](/windows/win32/api/memoryapi/nf-memoryapi-virtuallock)函式可讓進程將一或多個已認可記憶體頁面鎖定 (RAM) 的實體記憶體中，以防止系統將頁面交換到分頁檔案。</span><span class="sxs-lookup"><span data-stu-id="9062d-113">The [**VirtualLock**](/windows/win32/api/memoryapi/nf-memoryapi-virtuallock) function enables a process to lock one or more pages of committed memory into physical memory (RAM), preventing the system from swapping the pages out to the paging file.</span></span> <span data-ttu-id="9062d-114">可以用來確保在沒有磁片存取的情況下可存取重要資料。</span><span class="sxs-lookup"><span data-stu-id="9062d-114">It can be used to ensure that critical data is accessible without disk access.</span></span> <span data-ttu-id="9062d-115">將分頁鎖在記憶體中是危險的，因為它會限制系統管理記憶體的能力。</span><span class="sxs-lookup"><span data-stu-id="9062d-115">Locking pages into memory is dangerous because it restricts the system's ability to manage memory.</span></span> <span data-ttu-id="9062d-116">過度使用 **VirtualLock** 可能會導致可執行程式碼交換到分頁檔案，進而降低系統效能。</span><span class="sxs-lookup"><span data-stu-id="9062d-116">Excessive use of **VirtualLock** can degrade system performance by causing executable code to be swapped out to the paging file.</span></span> <span data-ttu-id="9062d-117">[**VirtualUnlock**](/windows/win32/api/memoryapi/nf-memoryapi-virtualunlock)函數會解除鎖定由 **VirtualLock** 鎖定的記憶體。</span><span class="sxs-lookup"><span data-stu-id="9062d-117">The [**VirtualUnlock**](/windows/win32/api/memoryapi/nf-memoryapi-virtualunlock) function unlocks memory locked by **VirtualLock**.</span></span>

<span data-ttu-id="9062d-118">[**VirtualProtect**](/windows/win32/api/memoryapi/nf-memoryapi-virtualprotect)函式可讓進程修改進程位址空間中任何已認可頁面的存取保護。</span><span class="sxs-lookup"><span data-stu-id="9062d-118">The [**VirtualProtect**](/windows/win32/api/memoryapi/nf-memoryapi-virtualprotect) function enables a process to modify the access protection of any committed page in the address space of a process.</span></span> <span data-ttu-id="9062d-119">例如，處理常式可以配置讀取/寫入頁面來儲存敏感性資料，然後將存取權變更為唯讀或無存取，以防止意外覆寫。</span><span class="sxs-lookup"><span data-stu-id="9062d-119">For example, a process can allocate read/write pages to store sensitive data, and then it can change the access to read only or no access to protect against accidental overwriting.</span></span> <span data-ttu-id="9062d-120">**VirtualProtect** 通常用於 [**VirtualAlloc**](/windows/win32/api/memoryapi/nf-memoryapi-virtualalloc)所配置的頁面，但也適用于任何其他配置函數所認可的頁面。</span><span class="sxs-lookup"><span data-stu-id="9062d-120">**VirtualProtect** is typically used with pages allocated by [**VirtualAlloc**](/windows/win32/api/memoryapi/nf-memoryapi-virtualalloc), but it also works with pages committed by any of the other allocation functions.</span></span> <span data-ttu-id="9062d-121">不過， **VirtualProtect** 會變更整個頁面的保護，而且其他函式所傳回的指標不一定會在頁面界限上對齊。</span><span class="sxs-lookup"><span data-stu-id="9062d-121">However, **VirtualProtect** changes the protection of entire pages, and pointers returned by the other functions are not necessarily aligned on page boundaries.</span></span> <span data-ttu-id="9062d-122">[**VirtualProtectEx**](/windows/win32/api/memoryapi/nf-memoryapi-virtualprotectex)函式類似于 **VirtualProtect**，但它會變更指定進程中的記憶體保護。</span><span class="sxs-lookup"><span data-stu-id="9062d-122">The [**VirtualProtectEx**](/windows/win32/api/memoryapi/nf-memoryapi-virtualprotectex) function is similar to **VirtualProtect**, except it changes the protection of memory in a specified process.</span></span> <span data-ttu-id="9062d-123">變更保護對於存取正在進行的進程之記憶體中的偵錯工具很有用。</span><span class="sxs-lookup"><span data-stu-id="9062d-123">Changing the protection is useful to debuggers in accessing the memory of a process being debugged.</span></span>

 

 
