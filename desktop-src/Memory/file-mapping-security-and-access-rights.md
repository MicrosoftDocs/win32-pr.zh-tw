---
description: Windows 安全性模型可讓您控制對檔案對應物件的存取。 如需詳細資訊，請參閱 Access-Control 模型。
ms.assetid: 8bbf7c98-ff83-4ed9-8b82-f08dcd31295c
title: 檔案對應安全性和存取權限
ms.topic: article
ms.date: 10/06/2018
ms.openlocfilehash: 65d520e12d1b555e7c633f0d1e0ba5142c330ce8
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/07/2021
ms.locfileid: "106971383"
---
# <a name="file-mapping-security-and-access-rights"></a><span data-ttu-id="2b732-104">檔案對應安全性和存取權限</span><span class="sxs-lookup"><span data-stu-id="2b732-104">File-mapping security and access rights</span></span>

<span data-ttu-id="2b732-105">Windows 安全性模型可讓您控制對檔案對應物件的存取。</span><span class="sxs-lookup"><span data-stu-id="2b732-105">The Windows security model lets you control access to file-mapping objects.</span></span> <span data-ttu-id="2b732-106">如需詳細資訊，請參閱 [存取控制模型](../secauthz/access-control-model.md)。</span><span class="sxs-lookup"><span data-stu-id="2b732-106">For more information, see [Access-Control Model](../secauthz/access-control-model.md).</span></span>

<span data-ttu-id="2b732-107">當您呼叫 [**CreateFileMapping**](/windows/desktop/api/WinBase/nf-winbase-createfilemappinga)函數時，可以指定檔案對應物件的 [安全描述項](../secauthz/security-descriptors.md)。</span><span class="sxs-lookup"><span data-stu-id="2b732-107">You can specify a [security descriptor](../secauthz/security-descriptors.md) for a file-mapping object when you call the [**CreateFileMapping**](/windows/desktop/api/WinBase/nf-winbase-createfilemappinga) function.</span></span> <span data-ttu-id="2b732-108">如果您指定 **Null**，則物件會取得預設安全描述項。</span><span class="sxs-lookup"><span data-stu-id="2b732-108">If you specify **NULL**, the object gets a default security descriptor.</span></span> <span data-ttu-id="2b732-109">檔案對應物件之預設安全描述項中的 Acl 來自于建立者的主要或模擬權杖。</span><span class="sxs-lookup"><span data-stu-id="2b732-109">The ACLs in the default security descriptor for a file-mapping object come from the primary or impersonation token of the creator.</span></span>

<span data-ttu-id="2b732-110">若要取出檔案對應物件的安全描述項，請呼叫 [**GetNamedSecurityInfo**](/windows/win32/api/aclapi/nf-aclapi-getnamedsecurityinfoa) 或 [**GetSecurityInfo**](/windows/win32/api/aclapi/nf-aclapi-getsecurityinfo) 函數。</span><span class="sxs-lookup"><span data-stu-id="2b732-110">To retrieve the security descriptor of a file-mapping object, call the [**GetNamedSecurityInfo**](/windows/win32/api/aclapi/nf-aclapi-getnamedsecurityinfoa) or [**GetSecurityInfo**](/windows/win32/api/aclapi/nf-aclapi-getsecurityinfo) function.</span></span> <span data-ttu-id="2b732-111">若要設定檔案對應物件的安全描述項，請呼叫 [**SetNamedSecurityInfo**](/windows/win32/api/aclapi/nf-aclapi-setnamedsecurityinfoa) 或 [**SetSecurityInfo**](/windows/win32/api/aclapi/nf-aclapi-setsecurityinfo) 函數。</span><span class="sxs-lookup"><span data-stu-id="2b732-111">To set the security descriptor of a file-mapping object, call the [**SetNamedSecurityInfo**](/windows/win32/api/aclapi/nf-aclapi-setnamedsecurityinfoa) or [**SetSecurityInfo**](/windows/win32/api/aclapi/nf-aclapi-setsecurityinfo) function.</span></span>

<span data-ttu-id="2b732-112">檔案對應物件的有效存取權限包括 **刪除**、 **讀取 \_ 控制**、 **寫入 \_ DAC**，以及 **寫入 \_ 擁有** 者 [標準存取權限](../secauthz/standard-access-rights.md)。</span><span class="sxs-lookup"><span data-stu-id="2b732-112">The valid access rights for file-mapping objects include the **DELETE**, **READ\_CONTROL**, **WRITE\_DAC**, and **WRITE\_OWNER** [standard access rights](../secauthz/standard-access-rights.md).</span></span> <span data-ttu-id="2b732-113">檔案對應物件不支援 [ **同步處理** 標準] 存取權限。</span><span class="sxs-lookup"><span data-stu-id="2b732-113">File mapping objects do not support the **SYNCHRONIZE** standard access right.</span></span> <span data-ttu-id="2b732-114">下表列出檔案對應物件特定的存取權限。</span><span class="sxs-lookup"><span data-stu-id="2b732-114">The following table lists the access rights that are specific to file-mapping objects.</span></span>

| <span data-ttu-id="2b732-115">存取權限</span><span class="sxs-lookup"><span data-stu-id="2b732-115">Access right</span></span> | <span data-ttu-id="2b732-116">意義</span><span class="sxs-lookup"><span data-stu-id="2b732-116">Meaning</span></span> |
|-|-|
| <span data-ttu-id="2b732-117">**檔案 \_ 對應的 \_ 所有 \_ 存取**</span><span class="sxs-lookup"><span data-stu-id="2b732-117">**FILE\_MAP\_ALL\_ACCESS**</span></span> | <span data-ttu-id="2b732-118">包含檔案對應物件的所有存取權限，但不包括檔案 **\_ 對應 \_ 執行**。</span><span class="sxs-lookup"><span data-stu-id="2b732-118">Includes all access rights to a file-mapping object except **FILE\_MAP\_EXECUTE**.</span></span> <span data-ttu-id="2b732-119">[**MapViewOfFile**](/windows/win32/api/memoryapi/nf-memoryapi-mapviewoffile)和 [**MapViewOfFileEx**](/windows/win32/api/memoryapi/nf-memoryapi-mapviewoffileex)函式會將此視為與指定 **檔案 \_ 對應 \_ 寫入** 相同。</span><span class="sxs-lookup"><span data-stu-id="2b732-119">The [**MapViewOfFile**](/windows/win32/api/memoryapi/nf-memoryapi-mapviewoffile) and [**MapViewOfFileEx**](/windows/win32/api/memoryapi/nf-memoryapi-mapviewoffileex) functions treat this the same as specifying **FILE\_MAP\_WRITE**.</span></span> |
| <span data-ttu-id="2b732-120">**檔案 \_ 對應 \_ 執行**</span><span class="sxs-lookup"><span data-stu-id="2b732-120">**FILE\_MAP\_EXECUTE**</span></span> | <span data-ttu-id="2b732-121">允許對應檔案對應物件的可執行檔。</span><span class="sxs-lookup"><span data-stu-id="2b732-121">Allows mapping of executable views of the file-mapping object.</span></span> <span data-ttu-id="2b732-122">物件必須使用頁面保護建立，以允許執行存取，例如 **page \_ execute \_ READ**、 **page \_ execute \_ WRITECOPY** 或 **page \_ execute \_ READWRITE** 保護。</span><span class="sxs-lookup"><span data-stu-id="2b732-122">The object must have been created with page protection that allows execute access, such as **PAGE\_EXECUTE\_READ**, **PAGE\_EXECUTE\_WRITECOPY**, or **PAGE\_EXECUTE\_READWRITE** protection.</span></span>  |
| <span data-ttu-id="2b732-123">**檔案 \_ 對應 \_ 讀取**</span><span class="sxs-lookup"><span data-stu-id="2b732-123">**FILE\_MAP\_READ**</span></span> | <span data-ttu-id="2b732-124">允許對應檔對應物件的唯讀或可寫入寫入視圖。</span><span class="sxs-lookup"><span data-stu-id="2b732-124">Allows mapping of read-only or copy-on-write views of the file-mapping object.</span></span>  |
| <span data-ttu-id="2b732-125">**檔案 \_ 對應 \_ 寫入**</span><span class="sxs-lookup"><span data-stu-id="2b732-125">**FILE\_MAP\_WRITE**</span></span> | <span data-ttu-id="2b732-126">允許對應檔對應物件的唯讀、寫入寫入或讀取/寫入視圖。</span><span class="sxs-lookup"><span data-stu-id="2b732-126">Allows mapping of read-only, copy-on-write, or read/write views of a file-mapping object.</span></span> <span data-ttu-id="2b732-127">物件必須以允許寫入存取權的頁面保護建立，例如 **page \_ READWRITE** 或 **page \_ EXECUTE \_ READWRITE** 保護。</span><span class="sxs-lookup"><span data-stu-id="2b732-127">The object must have been created with page protection that allows write access, such as **PAGE\_READWRITE** or **PAGE\_EXECUTE\_READWRITE** protection.</span></span> |

<span data-ttu-id="2b732-128">對應檔案對應物件的「寫入時複製」視圖，需要與對應唯讀視圖相同的存取權。</span><span class="sxs-lookup"><span data-stu-id="2b732-128">Mapping a copy-on-write view of a file-mapping object requires the same access as mapping a read-only view.</span></span> <span data-ttu-id="2b732-129">**FILE \_ MAP \_ COPY** 旗標不是存取權限，而且不應該在安全描述項中指定為 DACL 的一部分。</span><span class="sxs-lookup"><span data-stu-id="2b732-129">The **FILE\_MAP\_COPY** flag is not an access right, and it should not be specified as part of a DACL in a security descriptor.</span></span> <span data-ttu-id="2b732-130">這個值只能與對應檔案對應物件（例如 [**MapViewOfFile**](/windows/win32/api/memoryapi/nf-memoryapi-mapviewoffile) 和 [**MapViewOfFileEx**](/windows/win32/api/memoryapi/nf-memoryapi-mapviewoffileex) 函式）的函式搭配使用，或與 [**OpenFileMapping**](/windows/desktop/api/WinBase/nf-winbase-openfilemappinga) 函式搭配使用，它會將檔案 **\_ 對應 \_ 複製** 視為 **\_ \_ 讀取檔案對應** 的相同方式。</span><span class="sxs-lookup"><span data-stu-id="2b732-130">This value can be used only with functions that map a view of a file-mapping object, such as the [**MapViewOfFile**](/windows/win32/api/memoryapi/nf-memoryapi-mapviewoffile) and [**MapViewOfFileEx**](/windows/win32/api/memoryapi/nf-memoryapi-mapviewoffileex) functions, or with the [**OpenFileMapping**](/windows/desktop/api/WinBase/nf-winbase-openfilemappinga) function, which treats **FILE\_MAP\_COPY** the same way it treats **FILE\_MAP\_READ**.</span></span>

<span data-ttu-id="2b732-131">如果您想要讀取或寫入物件的 SACL，可以向檔案對應物件要求 **存取 \_ 系統 \_ 安全性** 存取權。</span><span class="sxs-lookup"><span data-stu-id="2b732-131">You can request the **ACCESS\_SYSTEM\_SECURITY** access right to a file-mapping object if you want to read or write the object's SACL.</span></span> <span data-ttu-id="2b732-132">如需詳細資訊，請參閱 (Acl) 和[SACL 訪問](../secauthz/sacl-access-right.md)許可權[的存取控制清單](../secauthz/access-control-lists.md)。</span><span class="sxs-lookup"><span data-stu-id="2b732-132">For more information, see [Access-Control Lists (ACLs)](../secauthz/access-control-lists.md) and [SACL Access Right](../secauthz/sacl-access-right.md).</span></span>
