---
description: 使用 Windows Update Agent (WUA) 的程式設計人員一開始會先將 Wuapi.dll 的參考加入至 (、Microsoft Visual C++ 或 C Visual Basic 中的目前專案) ， \# 或在 c 或 c + + 專案中參考 Wuapi 和 Wuguid。
ms.assetid: ec9cbb0b-b5d4-41f2-8a25-143130d08a3b
title: Windows Update 代理程式物件模型
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 5060a76c850ea9ad97e9132f661d4b64f4f4fd03
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/07/2021
ms.locfileid: "104558756"
---
# <a name="windows-update-agent-object-model"></a><span data-ttu-id="57b4e-103">Windows Update 代理程式物件模型</span><span class="sxs-lookup"><span data-stu-id="57b4e-103">Windows Update Agent Object Model</span></span>

<span data-ttu-id="57b4e-104">使用 Windows Update Agent (WUA) 的程式設計人員一開始會先將 Wuapi.dll 的參考加入至 (、Microsoft Visual C++ 或 C Visual Basic 中的目前專案) ， \# 或在 c 或 c + + 專案中參考 Wuapi 和 Wuguid。</span><span class="sxs-lookup"><span data-stu-id="57b4e-104">Programmers using Windows Update Agent (WUA) begin by adding a reference to Wuapi.dll to their current project (in Visual C++, Microsoft Visual Basic, or C\#) or by referencing Wuapi.h and Wuguid.lib in a C or C++ project.</span></span> <span data-ttu-id="57b4e-105">使用 WUA API 的第一個步驟，是從適當的 coclass 建立物件，以建立其中一個介面的實例。</span><span class="sxs-lookup"><span data-stu-id="57b4e-105">The first step in using the WUA API is to create an instance of one of the interfaces by creating an object from the appropriate coclass.</span></span>

<span data-ttu-id="57b4e-106">下圖描述 WUA 物件模型。</span><span class="sxs-lookup"><span data-stu-id="57b4e-106">The following illustration describes the WUA object model.</span></span> <span data-ttu-id="57b4e-107">如需詳細資訊，請參閱「[WUA 物件和相關聯](#wua-objects-and-associated-tasks)的工作」一節。</span><span class="sxs-lookup"><span data-stu-id="57b4e-107">For more information, see the "[WUA Objects and Associated Tasks](#wua-objects-and-associated-tasks)" section.</span></span> <span data-ttu-id="57b4e-108">如需所有 WUA 介面的完整清單，請參閱 [介面](interfaces.md)。</span><span class="sxs-lookup"><span data-stu-id="57b4e-108">For a complete list of all the WUA interfaces, see [Interfaces](interfaces.md).</span></span>

![windows update 代理程式物件模型](images/wua-object-model.png)

## <a name="wua-objects-and-associated-tasks"></a><span data-ttu-id="57b4e-110">WUA 物件和相關聯的工作</span><span class="sxs-lookup"><span data-stu-id="57b4e-110">WUA Objects and Associated Tasks</span></span>

<span data-ttu-id="57b4e-111">下表列出 WUA 物件和與 WUA 物件相關聯的一般工作。</span><span class="sxs-lookup"><span data-stu-id="57b4e-111">The following table lists the WUA objects and the typical tasks that are associated with the WUA objects.</span></span>



| <span data-ttu-id="57b4e-112">Object</span><span class="sxs-lookup"><span data-stu-id="57b4e-112">Object</span></span>                                                                | <span data-ttu-id="57b4e-113">描述</span><span class="sxs-lookup"><span data-stu-id="57b4e-113">Description</span></span>                                                                                                                                                                                                                                 |
|-----------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="57b4e-114">**AutomaticUpdates**</span><span class="sxs-lookup"><span data-stu-id="57b4e-114">**AutomaticUpdates**</span></span>](/windows/desktop/api/Wuapi/nn-wuapi-iautomaticupdates)                         | <span data-ttu-id="57b4e-115">開始、暫停或繼續自動更新。</span><span class="sxs-lookup"><span data-stu-id="57b4e-115">Begin, pause, or resume Automatic Updates.</span></span>                                                                                                                                                                                                  |
| [<span data-ttu-id="57b4e-116">**AutomaticUpdatesSettings**</span><span class="sxs-lookup"><span data-stu-id="57b4e-116">**AutomaticUpdatesSettings**</span></span>](/windows/desktop/api/Wuapi/nn-wuapi-iautomaticupdatessettings)         | <span data-ttu-id="57b4e-117">取得或設定安裝更新的日期和時間。</span><span class="sxs-lookup"><span data-stu-id="57b4e-117">Retrieve or set the day and time to install updates.</span></span> <span data-ttu-id="57b4e-118">指定使用者如何收到自動更新事件的通知。</span><span class="sxs-lookup"><span data-stu-id="57b4e-118">Specify how users are notified of an Automatic Updates event.</span></span>                                                                                                                          |
| [<span data-ttu-id="57b4e-119">**類別**</span><span class="sxs-lookup"><span data-stu-id="57b4e-119">**Category**</span></span>](/windows/desktop/api/Wuapi/nn-wuapi-icategory)                                         | <span data-ttu-id="57b4e-120">取得更新類別的相關資訊，包括名稱、識別碼、描述、擁有者和預定產品。</span><span class="sxs-lookup"><span data-stu-id="57b4e-120">Retrieve information about the update's category, including the name, ID, description, owner, and intended product.</span></span> <span data-ttu-id="57b4e-121">取得屬於此分類的更新集合。</span><span class="sxs-lookup"><span data-stu-id="57b4e-121">Retrieve a collection of updates that belong to this category.</span></span> <span data-ttu-id="57b4e-122">取出父系或子類別的集合。</span><span class="sxs-lookup"><span data-stu-id="57b4e-122">Retrieve a collection of the parent or child categories.</span></span> |
| [<span data-ttu-id="57b4e-123">**CategoryCollection**</span><span class="sxs-lookup"><span data-stu-id="57b4e-123">**CategoryCollection**</span></span>](/windows/desktop/api/Wuapi/nn-wuapi-icategorycollection)                     | <span data-ttu-id="57b4e-124">存取 Category 物件的集合。</span><span class="sxs-lookup"><span data-stu-id="57b4e-124">Access a collection of Category objects.</span></span>                                                                                                                                                                                                    |
| [<span data-ttu-id="57b4e-125">**DownloadResult**</span><span class="sxs-lookup"><span data-stu-id="57b4e-125">**DownloadResult**</span></span>](/windows/desktop/api/Wuapi/nn-wuapi-idownloadresult)                             | <span data-ttu-id="57b4e-126">取得下載結果的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="57b4e-126">Retrieve information about the result of a download.</span></span>                                                                                                                                                                                        |
| [<span data-ttu-id="57b4e-127">**InstallationResult**</span><span class="sxs-lookup"><span data-stu-id="57b4e-127">**InstallationResult**</span></span>](/windows/desktop/api/Wuapi/nn-wuapi-iinstallationresult)                     | <span data-ttu-id="57b4e-128">取得安裝或卸載結果的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="57b4e-128">Retrieve information about the result of an installation or uninstallation.</span></span> <span data-ttu-id="57b4e-129">判斷是否需要重新開機系統才能完成安裝或卸載。</span><span class="sxs-lookup"><span data-stu-id="57b4e-129">Determine whether a system restart is required to complete the installation or uninstallation.</span></span>                                                                  |
| [<span data-ttu-id="57b4e-130">**>.searchresult**</span><span class="sxs-lookup"><span data-stu-id="57b4e-130">**SearchResult**</span></span>](/windows/desktop/api/Wuapi/nn-wuapi-isearchresult)                                 | <span data-ttu-id="57b4e-131">取得搜尋類別或更新結果的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="57b4e-131">Retrieve information about the result of a search for categories or updates.</span></span> <span data-ttu-id="57b4e-132">透過搜尋來抓取目的地電腦上找到的分類集合。</span><span class="sxs-lookup"><span data-stu-id="57b4e-132">Retrieve a collection of categories found on the destination computer by the search.</span></span> <span data-ttu-id="57b4e-133">取出搜尋所找到的更新集合。</span><span class="sxs-lookup"><span data-stu-id="57b4e-133">Retrieve a collection of updates found by the search.</span></span>                     |
| [<span data-ttu-id="57b4e-134">**SystemInformation**</span><span class="sxs-lookup"><span data-stu-id="57b4e-134">**SystemInformation**</span></span>](/windows/desktop/api/Wuapi/nn-wuapi-isysteminformation)                       | <span data-ttu-id="57b4e-135">取得目的地電腦上 OEM 硬體和系統重新開機需求的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="57b4e-135">Retrieve information about OEM hardware and system restart requirements on the destination computer.</span></span>                                                                                                                                        |
| [<span data-ttu-id="57b4e-136">**更新**</span><span class="sxs-lookup"><span data-stu-id="57b4e-136">**Update**</span></span>](/windows/desktop/api/Wuapi/nn-wuapi-iupdate)                                             | <span data-ttu-id="57b4e-137">取得更新的大部分資訊，包括配套更新、來源需求、身分識別、描述、卸載選項、下載優先順序、大小和期限。</span><span class="sxs-lookup"><span data-stu-id="57b4e-137">Retrieve most information about the update, including bundled updates, source requirements, identity, description, uninstall options, download priority, size, and deadline.</span></span>                                                                |
| [<span data-ttu-id="57b4e-138">**UpdateCollection**</span><span class="sxs-lookup"><span data-stu-id="57b4e-138">**UpdateCollection**</span></span>](/windows/desktop/api/Wuapi/nn-wuapi-iupdatecollection)                         | <span data-ttu-id="57b4e-139">存取更新物件的集合。</span><span class="sxs-lookup"><span data-stu-id="57b4e-139">Access a collection of Update objects.</span></span>                                                                                                                                                                                                      |
| [<span data-ttu-id="57b4e-140">**UpdateDownloader**</span><span class="sxs-lookup"><span data-stu-id="57b4e-140">**UpdateDownloader**</span></span>](/windows/desktop/api/Wuapi/nn-wuapi-iupdatedownloader)                         | <span data-ttu-id="57b4e-141">開始非同步或同步下載與更新相關聯的檔案。</span><span class="sxs-lookup"><span data-stu-id="57b4e-141">Start an asynchronous or synchronous download of the files that are associated with the updates.</span></span>                                                                                                                                            |
| [<span data-ttu-id="57b4e-142">**UpdateDownloadResult**</span><span class="sxs-lookup"><span data-stu-id="57b4e-142">**UpdateDownloadResult**</span></span>](/windows/desktop/api/Wuapi/nn-wuapi-iupdatedownloadresult)                 | <span data-ttu-id="57b4e-143">取得一項更新下載結果的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="57b4e-143">Retrieve information about the result of the download for one update.</span></span>                                                                                                                                                                       |
| [<span data-ttu-id="57b4e-144">**UpdateException**</span><span class="sxs-lookup"><span data-stu-id="57b4e-144">**UpdateException**</span></span>](/windows/desktop/api/Wuapi/nn-wuapi-iupdateexception)                           | <span data-ttu-id="57b4e-145">取得發生更新錯誤時所擲回之例外狀況的描述和內容。</span><span class="sxs-lookup"><span data-stu-id="57b4e-145">Retrieve the description and context of an exception that is thrown when an update error occurs.</span></span>                                                                                                                                            |
| [<span data-ttu-id="57b4e-146">**UpdateExceptionCollection**</span><span class="sxs-lookup"><span data-stu-id="57b4e-146">**UpdateExceptionCollection**</span></span>](/windows/desktop/api/Wuapi/nn-wuapi-iupdateexceptioncollection)       | <span data-ttu-id="57b4e-147">存取 UpdateException 物件的集合。</span><span class="sxs-lookup"><span data-stu-id="57b4e-147">Access a collection of UpdateException objects.</span></span>                                                                                                                                                                                             |
| [<span data-ttu-id="57b4e-148">**UpdateHistoryEntry**</span><span class="sxs-lookup"><span data-stu-id="57b4e-148">**UpdateHistoryEntry**</span></span>](/windows/desktop/api/Wuapi/nn-wuapi-iupdatehistoryentry)                     | <span data-ttu-id="57b4e-149">取得已安裝或卸載之更新的相關資訊，包括已處理的應用程式、日期和描述。</span><span class="sxs-lookup"><span data-stu-id="57b4e-149">Retrieve information about an update that has been installed or uninstalled, including the processed application, date, and description.</span></span>                                                                                                    |
| [<span data-ttu-id="57b4e-150">**UpdateHistoryEntryCollection**</span><span class="sxs-lookup"><span data-stu-id="57b4e-150">**UpdateHistoryEntryCollection**</span></span>](/windows/desktop/api/Wuapi/nn-wuapi-iupdatehistoryentrycollection) | <span data-ttu-id="57b4e-151">存取 UpdateHistoryEntry 物件的集合。</span><span class="sxs-lookup"><span data-stu-id="57b4e-151">Access a collection of UpdateHistoryEntry objects.</span></span>                                                                                                                                                                                          |
| [<span data-ttu-id="57b4e-152">**UpdateInstallationResult**</span><span class="sxs-lookup"><span data-stu-id="57b4e-152">**UpdateInstallationResult**</span></span>](/windows/desktop/api/Wuapi/nn-wuapi-iupdateinstallationresult)         | <span data-ttu-id="57b4e-153">取得有關安裝或卸載更新結果的資訊。</span><span class="sxs-lookup"><span data-stu-id="57b4e-153">Retrieve information about the result of the installation or uninstallation for an update.</span></span>                                                                                                                                                  |
| [<span data-ttu-id="57b4e-154">**UpdateInstaller**</span><span class="sxs-lookup"><span data-stu-id="57b4e-154">**UpdateInstaller**</span></span>](/windows/desktop/api/Wuapi/nn-wuapi-iupdateinstaller)                           | <span data-ttu-id="57b4e-155">啟動非同步或同步安裝或卸載更新。</span><span class="sxs-lookup"><span data-stu-id="57b4e-155">Start an asynchronous or synchronous installation or uninstallation of an update.</span></span> <span data-ttu-id="57b4e-156">啟動互動式對話順序，引導使用者完成安裝更新的步驟。</span><span class="sxs-lookup"><span data-stu-id="57b4e-156">Start an interactive dialog sequence to guide the user through the steps to install updates.</span></span>                                                              |
| [<span data-ttu-id="57b4e-157">**UpdateSearcher**</span><span class="sxs-lookup"><span data-stu-id="57b4e-157">**UpdateSearcher**</span></span>](/windows/desktop/api/Wuapi/nn-wuapi-iupdatesearcher)                             | <span data-ttu-id="57b4e-158">依準則搜尋伺服器上的更新，例如更新類型、識別碼或類別目錄。</span><span class="sxs-lookup"><span data-stu-id="57b4e-158">Searches for updates on the server by criteria such as the update type, the ID, or the category.</span></span>                                                                                                                                            |
| [<span data-ttu-id="57b4e-159">**UpdateSession**</span><span class="sxs-lookup"><span data-stu-id="57b4e-159">**UpdateSession**</span></span>](/windows/desktop/api/Wuapi/nn-wuapi-iupdatesession)                               | <span data-ttu-id="57b4e-160">啟動會話以搜尋、下載、安裝或卸載應用程式的更新。</span><span class="sxs-lookup"><span data-stu-id="57b4e-160">Start a session to search, download, install, or uninstall the updates for an application.</span></span>                                                                                                                                                  |
| [<span data-ttu-id="57b4e-161">**WebProxy**</span><span class="sxs-lookup"><span data-stu-id="57b4e-161">**WebProxy**</span></span>](/windows/desktop/api/Wuapi/nn-wuapi-iwebproxy)                                         | <span data-ttu-id="57b4e-162">取得並設定 HTTP proxy 設定。</span><span class="sxs-lookup"><span data-stu-id="57b4e-162">Retrieve and set HTTP proxy settings.</span></span>                                                                                                                                                                                                       |



 

 

 



