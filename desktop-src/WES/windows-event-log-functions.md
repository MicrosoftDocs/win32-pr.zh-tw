---
title: Windows 事件記錄檔函數
description: Windows 事件記錄檔會定義下列函式，讓您可以用來從通道或事件記錄檔中取得事件，以及取得提供者的中繼資料及其產生的事件。
ms.assetid: 0bc008e4-c01c-482b-b910-49de3de22fab
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 893130b2881f2064151f56b6806cebdb9bf225d8
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/20/2020
ms.locfileid: "106968928"
---
# <a name="windows-event-log-functions"></a><span data-ttu-id="b7fb6-103">Windows 事件記錄檔函數</span><span class="sxs-lookup"><span data-stu-id="b7fb6-103">Windows Event Log Functions</span></span>

<span data-ttu-id="b7fb6-104">Windows 事件記錄檔會定義下列函式，讓您可以用來從通道或事件記錄檔中取得事件，以及取得提供者的中繼資料及其產生的事件。</span><span class="sxs-lookup"><span data-stu-id="b7fb6-104">Windows Event Log defines the following functions that you can use to get events from a channel or event log and to get the metadata for a provider and the events that it generates.</span></span>



| <span data-ttu-id="b7fb6-105">函式</span><span class="sxs-lookup"><span data-stu-id="b7fb6-105">Function</span></span>                                                                   | <span data-ttu-id="b7fb6-106">描述</span><span class="sxs-lookup"><span data-stu-id="b7fb6-106">Description</span></span>                                                                                                                                                                                                       |
|----------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="b7fb6-107">**.EVT \_ 訂閱 \_ 回呼**</span><span class="sxs-lookup"><span data-stu-id="b7fb6-107">**EVT\_SUBSCRIBE\_CALLBACK**</span></span>](/windows/win32/api/winevt/nc-winevt-evt_subscribe_callback)                 | <span data-ttu-id="b7fb6-108">如果您呼叫 [**EvtSubscribe**](/windows/desktop/api/WinEvt/nf-winevt-evtsubscribe) 函式來接收符合查詢的事件，請執行此回呼。</span><span class="sxs-lookup"><span data-stu-id="b7fb6-108">Implement this callback if you call the [**EvtSubscribe**](/windows/desktop/api/WinEvt/nf-winevt-evtsubscribe) function to receive events that match your query.</span></span>                                                                                    |
| [<span data-ttu-id="b7fb6-109">**EvtArchiveExportedLog**</span><span class="sxs-lookup"><span data-stu-id="b7fb6-109">**EvtArchiveExportedLog**</span></span>](/windows/desktop/api/WinEvt/nf-winevt-evtarchiveexportedlog)                     | <span data-ttu-id="b7fb6-110">將當地語系化字串加入至指定之記錄檔中的事件。</span><span class="sxs-lookup"><span data-stu-id="b7fb6-110">Adds localized strings to the events in the specified log file.</span></span>                                                                                                                                                   |
| [<span data-ttu-id="b7fb6-111">**EvtCancel**</span><span class="sxs-lookup"><span data-stu-id="b7fb6-111">**EvtCancel**</span></span>](/windows/desktop/api/WinEvt/nf-winevt-evtcancel)                                             | <span data-ttu-id="b7fb6-112">取消控制碼上的所有暫止作業。</span><span class="sxs-lookup"><span data-stu-id="b7fb6-112">Cancels all pending operations on a handle.</span></span>                                                                                                                                                                       |
| [<span data-ttu-id="b7fb6-113">**EvtClearLog**</span><span class="sxs-lookup"><span data-stu-id="b7fb6-113">**EvtClearLog**</span></span>](/windows/desktop/api/WinEvt/nf-winevt-evtclearlog)                                         | <span data-ttu-id="b7fb6-114">移除指定通道中的所有事件，並將其寫入目標記錄檔。</span><span class="sxs-lookup"><span data-stu-id="b7fb6-114">Removes all events from the specified channel and writes them to the target log file.</span></span>                                                                                                                             |
| [<span data-ttu-id="b7fb6-115">**EvtClose**</span><span class="sxs-lookup"><span data-stu-id="b7fb6-115">**EvtClose**</span></span>](/windows/desktop/api/WinEvt/nf-winevt-evtclose)                                               | <span data-ttu-id="b7fb6-116">關閉開啟的控制碼。</span><span class="sxs-lookup"><span data-stu-id="b7fb6-116">Closes an open handle.</span></span>                                                                                                                                                                                            |
| [<span data-ttu-id="b7fb6-117">**EvtCreateBookmark**</span><span class="sxs-lookup"><span data-stu-id="b7fb6-117">**EvtCreateBookmark**</span></span>](/windows/desktop/api/WinEvt/nf-winevt-evtcreatebookmark)                             | <span data-ttu-id="b7fb6-118">建立可在通道中識別事件的書簽。</span><span class="sxs-lookup"><span data-stu-id="b7fb6-118">Creates a bookmark that identifies an event in a channel.</span></span>                                                                                                                                                         |
| [<span data-ttu-id="b7fb6-119">**EvtCreateRenderCoNtext**</span><span class="sxs-lookup"><span data-stu-id="b7fb6-119">**EvtCreateRenderContext**</span></span>](/windows/desktop/api/WinEvt/nf-winevt-evtcreaterendercontext)                   | <span data-ttu-id="b7fb6-120">建立內容，以指定您想要呈現之事件中的資訊。</span><span class="sxs-lookup"><span data-stu-id="b7fb6-120">Creates a context that specifies the information in the event that you want to render.</span></span>                                                                                                                            |
| [<span data-ttu-id="b7fb6-121">**EvtExportLog**</span><span class="sxs-lookup"><span data-stu-id="b7fb6-121">**EvtExportLog**</span></span>](/windows/desktop/api/WinEvt/nf-winevt-evtexportlog)                                       | <span data-ttu-id="b7fb6-122">從指定的通道或記錄檔複製事件，並將它們寫入目標記錄檔。</span><span class="sxs-lookup"><span data-stu-id="b7fb6-122">Copies events from the specified channel or log file and writes them to the target log file.</span></span>                                                                                                                      |
| [<span data-ttu-id="b7fb6-123">**EvtFormatMessage**</span><span class="sxs-lookup"><span data-stu-id="b7fb6-123">**EvtFormatMessage**</span></span>](/windows/desktop/api/WinEvt/nf-winevt-evtformatmessage)                               | <span data-ttu-id="b7fb6-124">格式化訊息字串。</span><span class="sxs-lookup"><span data-stu-id="b7fb6-124">Formats a message string.</span></span>                                                                                                                                                                                         |
| [<span data-ttu-id="b7fb6-125">**EvtGetChannelConfigProperty**</span><span class="sxs-lookup"><span data-stu-id="b7fb6-125">**EvtGetChannelConfigProperty**</span></span>](/windows/desktop/api/WinEvt/nf-winevt-evtgetchannelconfigproperty)         | <span data-ttu-id="b7fb6-126">取得指定的通道設定屬性。</span><span class="sxs-lookup"><span data-stu-id="b7fb6-126">Gets the specified channel configuration property.</span></span>                                                                                                                                                                |
| [<span data-ttu-id="b7fb6-127">**EvtGetEventInfo**</span><span class="sxs-lookup"><span data-stu-id="b7fb6-127">**EvtGetEventInfo**</span></span>](/windows/desktop/api/WinEvt/nf-winevt-evtgeteventinfo)                                 | <span data-ttu-id="b7fb6-128">取得資訊，此資訊會識別已選取事件的結構化 XML 查詢，以及其所來自的通道或記錄檔。</span><span class="sxs-lookup"><span data-stu-id="b7fb6-128">Gets information that identifies the structured XML query that selected the event and the channel or log file from which it came.</span></span>                                                                                 |
| [<span data-ttu-id="b7fb6-129">**EvtGetEventMetadataProperty**</span><span class="sxs-lookup"><span data-stu-id="b7fb6-129">**EvtGetEventMetadataProperty**</span></span>](/windows/desktop/api/WinEvt/nf-winevt-evtgeteventmetadataproperty)         | <span data-ttu-id="b7fb6-130">取得指定的事件中繼資料屬性。</span><span class="sxs-lookup"><span data-stu-id="b7fb6-130">Gets the specified event metadata property.</span></span>                                                                                                                                                                       |
| [<span data-ttu-id="b7fb6-131">**EvtGetExtendedStatus**</span><span class="sxs-lookup"><span data-stu-id="b7fb6-131">**EvtGetExtendedStatus**</span></span>](/windows/desktop/api/WinEvt/nf-winevt-evtgetextendedstatus)                       | <span data-ttu-id="b7fb6-132">取得文字訊息，其中包含目前錯誤的延伸錯誤資訊。</span><span class="sxs-lookup"><span data-stu-id="b7fb6-132">Gets a text message that contains the extended error information for the current error.</span></span>                                                                                                                           |
| [<span data-ttu-id="b7fb6-133">**EvtGetLogInfo**</span><span class="sxs-lookup"><span data-stu-id="b7fb6-133">**EvtGetLogInfo**</span></span>](/windows/desktop/api/WinEvt/nf-winevt-evtgetloginfo)                                     | <span data-ttu-id="b7fb6-134">取得通道或記錄檔的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="b7fb6-134">Gets information about a channel or log file.</span></span>                                                                                                                                                                     |
| [<span data-ttu-id="b7fb6-135">**EvtGetObjectArrayProperty**</span><span class="sxs-lookup"><span data-stu-id="b7fb6-135">**EvtGetObjectArrayProperty**</span></span>](/windows/desktop/api/WinEvt/nf-winevt-evtgetobjectarrayproperty)             | <span data-ttu-id="b7fb6-136">從陣列中指定的物件取得提供者中繼資料屬性。</span><span class="sxs-lookup"><span data-stu-id="b7fb6-136">Gets a provider metadata property from the specified object in the array.</span></span>                                                                                                                                         |
| [<span data-ttu-id="b7fb6-137">**EvtGetObjectArraySize**</span><span class="sxs-lookup"><span data-stu-id="b7fb6-137">**EvtGetObjectArraySize**</span></span>](/windows/desktop/api/WinEvt/nf-winevt-evtgetobjectarraysize)                     | <span data-ttu-id="b7fb6-138">取得物件陣列中的元素數目。</span><span class="sxs-lookup"><span data-stu-id="b7fb6-138">Gets the number of elements in the array of objects.</span></span>                                                                                                                                                              |
| [<span data-ttu-id="b7fb6-139">**EvtGetPublisherMetadataProperty**</span><span class="sxs-lookup"><span data-stu-id="b7fb6-139">**EvtGetPublisherMetadataProperty**</span></span>](/windows/desktop/api/WinEvt/nf-winevt-evtgetpublishermetadataproperty) | <span data-ttu-id="b7fb6-140">取得指定的提供者中繼資料屬性。</span><span class="sxs-lookup"><span data-stu-id="b7fb6-140">Gets the specified provider metadata property.</span></span>                                                                                                                                                                    |
| [<span data-ttu-id="b7fb6-141">**EvtGetQueryInfo**</span><span class="sxs-lookup"><span data-stu-id="b7fb6-141">**EvtGetQueryInfo**</span></span>](/windows/desktop/api/WinEvt/nf-winevt-evtgetqueryinfo)                                 | <span data-ttu-id="b7fb6-142">取得您所執行之查詢的相關資訊，該查詢會識別查詢嘗試存取的通道或記錄檔清單，以及表示每個存取成功或失敗的傳回碼清單。</span><span class="sxs-lookup"><span data-stu-id="b7fb6-142">Gets information about a query that you ran that identifies the list of channels or log files that the query attempted to access and a list of return codes that indicates the success or failure of each access.</span></span> |
| [<span data-ttu-id="b7fb6-143">**EvtNext**</span><span class="sxs-lookup"><span data-stu-id="b7fb6-143">**EvtNext**</span></span>](/windows/desktop/api/WinEvt/nf-winevt-evtnext)                                                 | <span data-ttu-id="b7fb6-144">從查詢或訂閱結果中取得下一個事件。</span><span class="sxs-lookup"><span data-stu-id="b7fb6-144">Gets the next event from the query or subscription results.</span></span>                                                                                                                                                       |
| [<span data-ttu-id="b7fb6-145">**EvtNextChannelPath**</span><span class="sxs-lookup"><span data-stu-id="b7fb6-145">**EvtNextChannelPath**</span></span>](/windows/desktop/api/WinEvt/nf-winevt-evtnextchannelpath)                           | <span data-ttu-id="b7fb6-146">從列舉值取得通道名稱。</span><span class="sxs-lookup"><span data-stu-id="b7fb6-146">Gets a channel name from the enumerator.</span></span>                                                                                                                                                                          |
| [<span data-ttu-id="b7fb6-147">**EvtNextEventMetadata**</span><span class="sxs-lookup"><span data-stu-id="b7fb6-147">**EvtNextEventMetadata**</span></span>](/windows/desktop/api/WinEvt/nf-winevt-evtnexteventmetadata)                       | <span data-ttu-id="b7fb6-148">從列舉值取得事件定義。</span><span class="sxs-lookup"><span data-stu-id="b7fb6-148">Gets an event definition from the enumerator.</span></span>                                                                                                                                                                     |
| [<span data-ttu-id="b7fb6-149">**EvtNextPublisherId**</span><span class="sxs-lookup"><span data-stu-id="b7fb6-149">**EvtNextPublisherId**</span></span>](/windows/desktop/api/WinEvt/nf-winevt-evtnextpublisherid)                           | <span data-ttu-id="b7fb6-150">從列舉值取得提供者的識別碼。</span><span class="sxs-lookup"><span data-stu-id="b7fb6-150">Gets the identifier of a provider from the enumerator.</span></span>                                                                                                                                                            |
| [<span data-ttu-id="b7fb6-151">**EvtOpenChannelConfig**</span><span class="sxs-lookup"><span data-stu-id="b7fb6-151">**EvtOpenChannelConfig**</span></span>](/windows/desktop/api/WinEvt/nf-winevt-evtopenchannelconfig)                       | <span data-ttu-id="b7fb6-152">取得用來讀取或修改通道設定屬性的控制碼。</span><span class="sxs-lookup"><span data-stu-id="b7fb6-152">Gets a handle that you use to read or modify a channel's configuration property.</span></span>                                                                                                                                  |
| [<span data-ttu-id="b7fb6-153">**EvtOpenChannelEnum**</span><span class="sxs-lookup"><span data-stu-id="b7fb6-153">**EvtOpenChannelEnum**</span></span>](/windows/desktop/api/WinEvt/nf-winevt-evtopenchannelenum)                           | <span data-ttu-id="b7fb6-154">取得控制碼，您可以用來列舉電腦上已註冊的通道清單。</span><span class="sxs-lookup"><span data-stu-id="b7fb6-154">Gets a handle that you use to enumerate the list of channels that are registered on the computer.</span></span>                                                                                                                 |
| [<span data-ttu-id="b7fb6-155">**EvtOpenEventMetadataEnum**</span><span class="sxs-lookup"><span data-stu-id="b7fb6-155">**EvtOpenEventMetadataEnum**</span></span>](/windows/desktop/api/WinEvt/nf-winevt-evtopeneventmetadataenum)               | <span data-ttu-id="b7fb6-156">取得控制碼，您可以使用此控制碼來列舉提供者所定義的事件清單。</span><span class="sxs-lookup"><span data-stu-id="b7fb6-156">Gets a handle that you use to enumerate the list of events that the provider defines.</span></span>                                                                                                                             |
| [<span data-ttu-id="b7fb6-157">**EvtOpenLog**</span><span class="sxs-lookup"><span data-stu-id="b7fb6-157">**EvtOpenLog**</span></span>](/windows/desktop/api/WinEvt/nf-winevt-evtopenlog)                                           | <span data-ttu-id="b7fb6-158">取得通道或記錄檔的控制碼，您可以用來取得通道或記錄檔的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="b7fb6-158">Gets a handle to a channel or log file that you can then use to get information about the channel or log file.</span></span>                                                                                                    |
| [<span data-ttu-id="b7fb6-159">**EvtOpenPublisherEnum**</span><span class="sxs-lookup"><span data-stu-id="b7fb6-159">**EvtOpenPublisherEnum**</span></span>](/windows/desktop/api/WinEvt/nf-winevt-evtopenpublisherenum)                       | <span data-ttu-id="b7fb6-160">取得控制碼，您可以用來列舉電腦上已註冊之提供者的清單。</span><span class="sxs-lookup"><span data-stu-id="b7fb6-160">Gets a handle that you use to enumerate the list of registered providers on the computer.</span></span>                                                                                                                         |
| [<span data-ttu-id="b7fb6-161">**EvtOpenPublisherMetadata**</span><span class="sxs-lookup"><span data-stu-id="b7fb6-161">**EvtOpenPublisherMetadata**</span></span>](/windows/desktop/api/WinEvt/nf-winevt-evtopenpublishermetadata)               | <span data-ttu-id="b7fb6-162">取得用來讀取指定提供者之中繼資料的控制碼。</span><span class="sxs-lookup"><span data-stu-id="b7fb6-162">Gets a handle that you use to read the specified provider's metadata.</span></span>                                                                                                                                             |
| [<span data-ttu-id="b7fb6-163">**EvtOpenSession**</span><span class="sxs-lookup"><span data-stu-id="b7fb6-163">**EvtOpenSession**</span></span>](/windows/desktop/api/WinEvt/nf-winevt-evtopensession)                                   | <span data-ttu-id="b7fb6-164">建立遠端電腦的連線，您可以在呼叫其他 Windows 事件記錄檔時使用該連接。</span><span class="sxs-lookup"><span data-stu-id="b7fb6-164">Establishes a connection to a remote computer that you can use when calling the other Windows Event Log functions.</span></span>                                                                                                |
| [<span data-ttu-id="b7fb6-165">**EvtQuery**</span><span class="sxs-lookup"><span data-stu-id="b7fb6-165">**EvtQuery**</span></span>](/windows/desktop/api/WinEvt/nf-winevt-evtquery)                                               | <span data-ttu-id="b7fb6-166">執行查詢，以從符合指定查詢準則的通道或記錄檔中取出事件。</span><span class="sxs-lookup"><span data-stu-id="b7fb6-166">Runs a query to retrieve events from a channel or log file that match the specified query criteria.</span></span>                                                                                                               |
| [<span data-ttu-id="b7fb6-167">**EvtRender**</span><span class="sxs-lookup"><span data-stu-id="b7fb6-167">**EvtRender**</span></span>](/windows/desktop/api/WinEvt/nf-winevt-evtrender)                                             | <span data-ttu-id="b7fb6-168">根據您指定的轉譯內容呈現 XML 片段。</span><span class="sxs-lookup"><span data-stu-id="b7fb6-168">Renders an XML fragment based on the rendering context that you specify.</span></span>                                                                                                                                          |
| [<span data-ttu-id="b7fb6-169">**EvtSaveChannelConfig**</span><span class="sxs-lookup"><span data-stu-id="b7fb6-169">**EvtSaveChannelConfig**</span></span>](/windows/desktop/api/WinEvt/nf-winevt-evtsavechannelconfig)                       | <span data-ttu-id="b7fb6-170">儲存對通道設定所做的變更。</span><span class="sxs-lookup"><span data-stu-id="b7fb6-170">Saves the changes made to a channel's configuration.</span></span>                                                                                                                                                              |
| [<span data-ttu-id="b7fb6-171">**EvtSeek**</span><span class="sxs-lookup"><span data-stu-id="b7fb6-171">**EvtSeek**</span></span>](/windows/desktop/api/WinEvt/nf-winevt-evtseek)                                                 | <span data-ttu-id="b7fb6-172">搜尋查詢結果集中的特定事件。</span><span class="sxs-lookup"><span data-stu-id="b7fb6-172">Seeks to a specific event in a query result set.</span></span>                                                                                                                                                                  |
| [<span data-ttu-id="b7fb6-173">**EvtSetChannelConfigProperty**</span><span class="sxs-lookup"><span data-stu-id="b7fb6-173">**EvtSetChannelConfigProperty**</span></span>](/windows/desktop/api/WinEvt/nf-winevt-evtsetchannelconfigproperty)         | <span data-ttu-id="b7fb6-174">設定通道的指定設定屬性。</span><span class="sxs-lookup"><span data-stu-id="b7fb6-174">Sets the specified configuration property of a channel.</span></span>                                                                                                                                                           |
| [<span data-ttu-id="b7fb6-175">**EvtSubscribe**</span><span class="sxs-lookup"><span data-stu-id="b7fb6-175">**EvtSubscribe**</span></span>](/windows/desktop/api/WinEvt/nf-winevt-evtsubscribe)                                       | <span data-ttu-id="b7fb6-176">建立訂用帳戶，該訂閱將會從符合指定查詢準則的通道或記錄檔接收目前和未來的事件。</span><span class="sxs-lookup"><span data-stu-id="b7fb6-176">Creates a subscription that will receive current and future events from a channel or log file that match the specified query criteria.</span></span>                                                                            |
| [<span data-ttu-id="b7fb6-177">**EvtUpdateBookmark**</span><span class="sxs-lookup"><span data-stu-id="b7fb6-177">**EvtUpdateBookmark**</span></span>](/windows/desktop/api/WinEvt/nf-winevt-evtupdatebookmark)                             | <span data-ttu-id="b7fb6-178">使用可識別指定事件的資訊來更新書簽。</span><span class="sxs-lookup"><span data-stu-id="b7fb6-178">Updates the bookmark with information that identifies the specified event.</span></span>                                                                                                                                        |



 

 

 